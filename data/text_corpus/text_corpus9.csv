index,text
45,many algorithms have been proposed to cope with groundwater numerical simulation associated with local grid refinements typically for subsurface flow driven by sources acting on diverse scales in this context we focus on establishing an efficient local grid refinement method with nonmatching grids for groundwater flow modelling the new model is based on the vertex centred finite volume method vcfvm the core idea of the algorithm resting on set all unknowns on vertices and the flux between two vertices the numerical flux is expressed as a function of the hydraulic heads at the vertices of the element containing the lateral surface the total outflow of the control volume of a given vertex is expressed as the sum of numerical fluxes since the algorithm sets all unknowns on vertices and a control volume can be defined for each vertex our scheme readily embeds treatment of arbitrary polygonal grids including nonmatching grids in the presence of local grid refinement without additional treatment at the nonmatching nodes six test cases including five assumed ones and a real world case were adopted to evaluate the accuracy and efficiency of the new algorithm the hydraulic heads calculated by the new algorithm were compared with those by a widely used and tested numerical groundwater model called modflow and the analytic solutions the mass balance error and the cpu time were compared with those of the modflow 6 model which owns ability to cope with nonmatching grids the results show that the new algorithm yields high accuracy and efficiency in simulating groundwater flows with local grid refinements keywords vertex centred finite volume method local grid refinement nonmatching grids groundwater simulation data availability data will be made available on request 1 introduction regional groundwater simulation is important for groundwater resource management and protection an important issue in regional groundwater simulation is local grid refinement with nonmatching grids wen and gómez hernández 1996 which refers to those meshes containing hanging nodes on certain edges is required in those simulation domains with heterogeneity of subsurface formations with hydraulic conductivities spanning many scales he and ren 2006 krcmar and sracek 2014 or with significant hydraulic gradient variations near wells rivers streams channels or ditches mehl and hill 2002 it is thus necessary to develop algorithms with ability to solve groundwater flow equation with local refined grids so that the reginal groundwater simulation which is originally time consuming can be done with high efficiency various spatial discretization methods have been used for numerical groundwater simulations and the three popular methods are the finite difference method fdm used in modflow harbaugh et al 2000 the finite element method fem in feflow diersch 1998 trefry and muffels 2007 and the finite volume method fvm in hydrogeosphere brunner and simmons 2012 however conventional numerical groundwater models are unideal for dealing with nonmatching grid for example one solution for local grid refinement in the fdm is to use variably spaced meshes and to set the widths of rows and columns to small values in the area of interest this approach can lead to cells with large aspect ratios and unnecessary refinement in areas where such a fine resolution is not needed mehl and hill 2002 significant efforts have been made to overcome the limitations of conventional numerical methods in handling nonmatching grids one method is to divide the simulation region into a parent model with coarse grids and several child models with finer grids the parent model provides the flux boundary or the specified head boundary for the child model ward et al 1987 remero et al 2006 this method can lead to a significant discrepancy in the interfaces between the parent and child models since there is no feedback from the child models to the parent model langevin et al 2017 then an iterative coupling method between the parent and child models was developed székely 1998 built a groundwater model based on a point centred finite difference framework with the parent and child grids iteratively coupled mehl and hill 2002 further modified the method and applied it to modflow to develop a local grid refinement model called modflow lgr the darcy weighted interpolation was used to define the head boundary conditions along the interface of the child model the accuracy of modflow lgr was proven to be better than those of one direction coupled models and models that rely on linear interpolation along the interface the modflow lgr model has been widely used in groundwater simulations when local grid refinement is needed borsi et al 2013 vilhelmsen et al 2011 dickinson et al 2007 and panday and langevin 2012 further optimized the coupling method of the parent and child models to make the model suitable for refinements with nonmatching vertices in general the models mentioned above address the nonmatching grids by iteratively coupling the parent and child models in addition to these iterative coupling methods some models use additional treatments to obtain the hydraulic head or the flux in nonmatching grids and then solve the matrix equations among them modflow unstructured grid modflow usg panday et al 2013 which has been widely used in simulations with multiscale problems feinstein et al 2016 herckenrath et al 2015 krcmar and sracek 2014 is based on an underlying control volume finite difference cvfd formulation and the flux between coarse and fine cells is calculated based on the hydraulic heads at ghost nodes and fine cell nodes the general unstructured grid based on concepts developed for modflow usg has also been adopted in the new version of modflow called modflow 6 langevin et al 2017 the hydrogeosphere model which originated from the code of frac3dvs therrien and sudicky 1996 guvanasen et al 2007 substitutes the hydraulic head at the fine nodes with the interpolation head at coarse nodes to generate a global matrix although the models mentioned above can be effectively implemented for nonmatching grids by solving the unified matrix equations additional steps are required at the interface of coarse and fine grids e g interpolating the hydraulic head and flux distribution at the interface numerical algorithms have also been developed to address the issue of local refinement among them the most widely used numerical algorithm is the multiscale method matouš et al 2017 the multiscale method targets the full problem at the original resolution and attempts to directly capture the fine scale behaviour of the solution in coarser grids he and ren 2005 the multiscale method proposed by hou and wu 1997 was based on the fem and called the multiscale finite element method mfem and it was demonstrated to be efficient in solving scale disparity problems ye et al 2004 xie et al 2016 improved the construction method of the basis function of the mfem and then extended the method from 2d to 3d simulations xie et al 2017 many other multiscale models have been developed based on different spatial discretization methods such as the fdm abdulle and e 2003 chen and ren 2014 langevin et al 2017 fvm jenny et al 2003 durlofsky et al 2007 hajibeygi et al 2008 lunati et al 2011 domelevo and omnes 2005 and mixed fvm he and ren 2005 xie et al 2019 chung et al 2015 chen and hou 2003 ye et al 2004 fu and chung et al 2019 zhang et al 2017 among these models those based on the fdm fvm and some mixed fem preserve the local conservation of the velocity flux the multiscale method was originally designed for solving heterogeneity problems and has limitations in solving problems with wells the basic functions in multiscale models were further adjusted to consider the influence caused by wells he and ren 2006 jenny and lunati 2009 wolfsteiner et al 2006 kramarenko et al 2017 additionally multiscale models for nonmatching grids were developed and these models are more suitable for simulating groundwater flow near wells gao and li 2017 arbogast et al 2000 ganis et al 2015 these multiscale models for nonmatching grids still have limitations regarding the shape of the grid for example these models are limited to nested grids ewing and wang 1992 triangular grids gao and li 2017 square grids wheeler et al 2002 thomas and wheeler 2011 and hexahedral grids ganis et al 2015 although some grid shapes such as triangular grids and hexahedral grids can flexibly deal with problems requiring local grid refinements a numerical model without limitation on grid shape would be more general and flexible additionally many of the models mentioned above were designed to simulate groundwater flow in a confined aquifer xie et al 2019 chen and ren 2014 gao and li 2017 kramarenko et al 2017 zhang et al 2017 but their applicability in unconfined aquifer problems which are often nonlinear has not been assessed in this paper a new algorithm for solving groundwater flow equation with nonmatching grid based on the vertex centred finite volume method is developed the algorithm is designed for anisotropic diffusion problems based on arbitrary polygonal grids there are three kinds of unknowns involved including vertex centred edge midpoint and cell centred unknowns the vertex centred unknowns are primary and associated with finite volume equations the edge midpoint and cell centred unknowns are treated as auxiliary unknowns and are interpolated based on the primary unknowns therefore the final scheme is a pure vertex centred scheme the main novelty of the presented algorithm is that it is applicable for not only arbitrary polygonal grids but also nonmatching grids which makes local refinements more flexible when compared to standard methods or those hybrid fe methods matthai et al 2005 matthai et al 2007 the new groundwater model hereinafter referred to as the vcfvm is constructed based on the above algorithm since the groundwater problem is a special case type of diffusion problem six test cases including a heterogeneous anisotropic aquifer a single pumping well in confined and unconfined aquifers multiple pumping wells in a confined aquifer two parallel canals in an unconfined aquifer with nonpoint sink source items and a real world test case with multiple pumping wells at field scale were designed to evaluate the accuracy and efficiency of the new algorithm the major contribution of this work is that it provides a new alternative to solve the confined and unconfined groundwater flow equations with arbitrary polygonal grids including nonmatching grids using a unified approach regardless to the shape or form of the grids and the method strictly conserves the local mass balance the paper is organized as follows the numerical algorithm of the vcfvm is introduced in section 2 five virtual test cases and a real world test case used to verify the accuracy and efficiency of the vcfvm are shown in section 3 the results of the test cases are shown in section 4 and the simulation results are compared with those of widely used models modflow or modflow 6 and the analytical solution to demonstrate the accuracy and efficiency of the vcfvm conclusions are given in section 5 2 vcfvm numerical algorithm 2 1 vcfvm for confined aquifers let ω r 2 be the two dimensional solution domain and use ω t ω 0 t to denote the spatiotemporal region of interest ω0 ω 0 denotes the initial region γ d t γ d 0 t denotes a first type boundary dirichlet boundary and γ n t γ n 0 t denotes a second type boundary neumann boundary moreover let x x y be a spatial point in ω and x t be a spatiotemporal point in ω t in this case a groundwater problem involving a confined aquifer can be mathematically described as 1a k h μ e h t f x t x t ω t 1b h x t g 0 x x t ω 0 1c h x t g 1 x t x t γ d t 1d k h x t n x g 2 x t x t γ n t where h is the hydraulic head l μe μsm is the elastic release coefficient of the confined aquifer based on specific storativity μs l 1 and the thickness of aquifer m l is the gradient operator which is defined by h h x h y t g 0 g 1 and g 2 are the specified initial value dirichlet value and neumann value of the problem respectively and n x denotes the unit normal vector outward to ω at the neumann boundary moreover k k sm is the transmissivity of the confined aquifer and 2 k s k x x k x y k y x k y y denotes the saturated hydraulic conductivity tensor kxx and kyy are the saturated hydraulic conductivities in the x and y directions respectively lt 1 and kxy and kyx are the cross conductivity terms lt 1 thus 3 k h x m k x x h x m k x y h y y m k y x h x m k y y h y and f is the source sink term defined by 4 f p e i 1 n w q i δ x x i where p p x t denotes the amount of precipitation infiltration that leads to groundwater recharge lt 1 e e x t is the evapotranspiration of groundwater lt 1 qi represents the pumping capacity of a pumping well located at xi yi nw is the number of pumping wells and δ is the dirac delta function which satisfies the following conditions 5 δ x 0 x 0 x 0 and r 2 δ x d x 1 the physical meaning of eq 1a reflects the mass conservation relation of groundwater flow in an aquifer and represents a water balance relation per unit volume and unit time in the aquifer under the darcy flow conditions that is the difference between a mass of water flowing into and out of a unit volume aquifer per unit time the left side of eq 1a is equal to the amount of water released or stored elastically in the unit volume aquifer at the same time the right side of eq 1a 2 2 spatial discretization the space domain ω is partitioned into several nonoverlapping polygonal cells that form so called primary meshes for spatial discretization shown as the meshes with solid line segments in fig 1 a γd is the boundary of ω and x v is a vertex of ω the cell centre is defined as the geometric centre and the corresponding coordinates are a simple average of the cell vertices each primary cell is further partitioned into several quadrilateral sub cells by connecting the cell centre with the midpoint of edges as shown by the dashed line segments in fig 1 a all sub cells sharing the same vertex in the primary mesh form a polygonal cell in the dual mesh as shown in the highlighted part of fig 1 a denoted as c v which is the control volume of the corresponding vertex e g vertex x v in regards to those vertices lie on the nonmatching edge denoted as nonmatching vertex here in and after their control volumes are formed by connecting the centre of the neighbour cells with the midpoint of edges that sharing the vertex which is similar to those normal vertices shown as the vertex x v and the corresponding control volume c v in fig 1 c since the control volumes of all vertices including nonmatching vertices can be formed using a unified approach there is no difference in the spatial and temporal discretization schemes among normal and nonmatching vertices and the spatial and temporal discretization schemes for the nonmatching vertices will not be illustrated separately in the following sections for the primary and dual meshes we introduce two types of unknowns the primary unknowns and the auxiliary unknowns the primary unknowns are defined at the vertices of the primary mesh in ω or on ω γd and are shown as black solid circles in fig 1 a each primary unknown is associated with a finite volume fv equation the auxiliary unknowns are defined at the cell centres and edge midpoints of the primary mesh and are denoted by red solid squares and blue solid circles in fig 1 a respectively these auxiliary unknowns do not have corresponding fv equations and they are evaluated based on the primary unknowns or if necessary dirichlet boundary data which will be discussed in detail later in the paper after forming the control volume of each vertex including the nonmatching vertices the numerical flux outwards a specified control volume via a specified dual edge is constructed let x v and x v be two interior vertices of the primary mesh sharing edge σ for primary cell c as shown in fig 1 b let x σ x c εc and k c denote the midpoint of the edge σ the centre of c the set of edges of c and the constant restriction of k on c respectively n c σ v resp n c σ v refers to the unit vector normal to the dual edge x σ x c outward to the dual cell associated with the vertex x v resp x v obviously n c σ v n c σ v in addition let εv resp mv be the set of primary edges resp primary cells sharing x v according to darcy s law the flow velocity v in the primary cell c can be defined by 6 v k c h since only the component of velocity normal to the dual edge contributes to the outflow the outflow of the control volume crossing the dual edge x σ x c can be defined by 7 f c σ v x σ x c v n c σ v h x σ x c k c t n c σ v where x σ x c denotes the length of the edge x σ x c the vector x σ x c k c t n c σ v can be decomposed as a linear combination of two vectors x v x c and x v x σ 8 x σ x c k c t n c σ v α c σ v x c x v β c σ v x σ x v where αc σ v and βc σ v are the two combination coefficients these coefficients are expressed as 9a α c σ v x σ x c n c σ v t k c t r x σ x v x c x v t r x σ x v 9b β c σ v x σ x c n c σ v t k c t r x c x v x σ x v t r x c x v where r is a rotation matrix that makes a vector rotate 90 degrees counterclockwise i e 10 r 0 1 1 0 substituting eq 8 into eq 7 leads to 11 f c σ v h α c σ v x c x v β c σ v x σ x v α c σ v h v h c β c σ v h v h σ similarly based on the following vector splitting 12 x σ x c k c t n c σ v α c σ v x c x v β c σ v x σ x v the following equation is obtained 13 f c σ v α c σ v h v h c β c σ v h v h σ where 14a α c σ v x σ x c n c σ v t k c t r x σ x v x c x v t r x σ x v 14b β c σ v x σ x c n c σ v t k c t r x c x v x σ x v t r x c x v for the control volume c v associated with the specified vertex x v the total outflow fv is the sum of the outflows crossing the dual edges of c v then the left hand side of eq 1a can be approximated by 15 f v c m v σ ε c ε v f c σ v and therefore the finite volume equation associated with a specific vertex x v of ω γd can be constructed as follows 16 f v c v μ e h t d x c v f d x μ e c v h v t c v f x v where c v denotes the area of the dual cell c v the matrix form of eq 16 is 17 a h μ e λ h t λ f where a is a coefficient matrix the value of element in the m th row and n th column of a denoted as a m n is given in section 2 4 after introducing the interpolation approach of auxiliary unknowns h is a vector related to hv f is a vector related to f x v and λ is a diagonal matrix with c v diagonal elements in regards of the accuracy order of the proposed spatial discretization it was investigated by simulating scenarios using different kinds of challenging meshes with different resolutions as shown in section 3 1 and the simulation results indicate that the vcfvm has a second order spatial accuracy the details can be found in section 3 1 and section 4 1 2 3 interpolation of auxiliary unknowns and analysis of local conservation in order to obtain a fully vertex centred finite volume scheme the auxiliary unknowns need to be interpolated based on the primary unknowns in the proposed scheme since the auxiliary unknowns are defined at the centres and edge midpoints of the primary cells they can be easily interpolated based on the vertex unknowns let x σ be the midpoint of σ with endpoints x v and x v x c is the geometric centre of primary cell c then for the auxiliary unknowns defined at x σ and x c elimination can be performed based on the following interpolation strategies 18 h σ h v h v 2 and 19 h c 1 n c x v v c h v where vc denotes the set of vertices in cell c nc denotes the number of vertices in cell c it should be noted that in eq 18 the influence of other vertices is ignored e g in fig 1 b h σis assumed to be only related to hv and h v which are the two endpoints of the corresponding edge σ while the influences of other vertices in the cell c are ignored in other words eq 18 and eq 19 assume the unknown changes linearly in a given cell and this may introduce nonnegligible error in cases that the size of the given cell is too large to ignore the nonlinearity of unknown within the cell however since the interpolation approach is not the focus of this research and linear interpolation methods are widely used in numerical models such as the method used in modflow usg to obtain the hydraulic head at a ghost node panday et al 2013 a linear approach is also adopted here to obtain the pressure head at the midpoint it should be noted that fine grids are needed in those regions where unknown changes highly nonlinearly to avoid unacceptable errors introduced by the linear interpolation scheme adopted as what we do in the test cases shown in section 3 at the end of this subsection we investigate the local conservation of numerical flux which is the basis of the finite volume method the medium properties e g k are defined over the elements in the proposed method thus the k c t of eq 9 is equal to that of eq 14 and for the meshes used in those scenarios involving heterogeneous layers faults pinchouts and fractures the edges of the primary cells should be aligned with the interface to have exact definition of the medium properties in the spatial domain manzoor et al 2021 and for the scenarios involving pumping wells or other point sources vertices are required to be aligned with those points consequently we have following lemma lemma 1 if primary c is a star shaped cell whose cell centre is x c then for the coefficients in the numerical flux equation defined in eq 9 and eq 14 we have 20 α c σ v β c σ v α c σ v β c σ v 21 α c σ v α c σ v 0 proof since c is a star shaped cell with respect to x c we have x c x v t r x σ x v x σ x v t r x c x v x σ x c d c σ v where d c σ v denotes the distance form vertex x v to the dual edge x σ x c then we deduce from eq 9 and eq 14 that α c σ v β c σ v x σ x c n c σ v t k c t r x σ x c x c x v t r x σ x v x σ x c n c σ v t k c t n c σ v d c σ v where we have used the identity r x σ x c x σ x c n c σ v and similarly we have α c σ v β c σ v x σ x c n c σ v t k c t n c σ v d c σ v where d c σ v denotes the distance form vertex x v to the dual edge x σ x c since x σ is the midpoint of primary edge we have d c σ v d c σ v recalling that n c σ v n c σ v and k c is positive definite we obtain eq 20 as for 21 we have x c x v t r x σ x v x c x v t r x σ x v and consequently we have α c σ v α c σ v x σ x c n c σ v t k c t r x σ x v x c x v t r x σ x v x σ x c n c σ v t k c t r x σ x v x c x v t r x σ x v x σ x c n c σ v t k c t r 2 x σ x v x v x c x v t r x σ x v 0 the properties shown in eq 20 and eq 21 are crucial for the derivation of the local conservation of numerical flux and deducing from them we have the following lemma lemma 2 if primary c is a star shaped cell whose cell centre is x c then for the numerical fluxes defined in eq 11 and eq 13 we have 22 f c σ v f c σ v 0 proof according to the definitions of f c σ v and f c σ v in eq 11 and eq 13 we have f c σ v f c σ v α c σ v β c σ v h v h σ α c σ v β c σ v h v h σ recalling eq 20 and eq 21 we have f c σ v f c σ v α c σ v β c σ v h v h v β c σ v β c σ v h σ 2 α c σ v β c σ v β c σ v h σ 0 where we have used the identity h σ h v h v 2 lemma 2 demonstrated that the numerical fluxes are continuous crossing the dual edge of control volume for both normal grids and nonmatching grids it should be pointed out that the flux continuity across the grid cell s face is not considered in the vcfvm however in many practical problems especially in the cases that there are jumps in medium properties the flux continuity across interfaces that separate changes in medium properties is a concerned issue and its importance has been verified by comparison for two phase flow between standard control volume finite element cvfe and control volume distributed multipoint flux approximation cvd mpfa in the literatures edwards 2006a edwards 2006b in which it has been proved that the cvd mpfa method with flux continuity across crucial interfaces where the medium properties jump yields highly resolved solutions it is worth mentioning that the reference of wu 2017 proposed a post processing technique to make a vertex centred finite volume scheme satisfy the flux continuity across the grid cell s faces which can also be applicable to our approach it is an interesting topic to further discuss how to make the vertex centred scheme assure the flux continuity across the grid cell s faces which will also be studied in the future 2 4 extending the vcfvm to unconfined aquifers for an unconfined aquifer the groundwater problem can be expressed by eq 1 except eq 1a must be slightly modified in this case the transmissivity k has the form 23 k h k s h and k s is the saturated hydraulic conductivity tensor defined by eq 2 notably the transmissivity tensor is dependent on the hydraulic head h which makes eq 1a a nonlinear partial differential equation 24 x k x x h h x k x y h h y y k y x h h x k y y h h y μ d h t f or in a more compact form 25 k h h μ d h t f where μd is the specified yield of the unconfined aquifer unitless the difference of vcfvm between unconfined aquifer and confined aquifer mainly exists in the construction of numerical flux to be specific since the transmissivity k h depends on h in an unconfined aquifer the corresponding combination coefficients defined in eq 9a and eq 9b should be modified to 26a α c σ v h x σ x c n c σ v t k c t h r x σ x v x c x v t r x σ x v 26b β c σ v h x σ x c n c σ v t k c t h r x c x v x σ x v t r x c x v and similar modifications are made for αc σ v h and βc σ v h obviously lemma 1 and 2 for the confined aquifer still stand up for the unconfined aquifer and the matrix equation after spatial discretization has the same form of eq 17 2 5 temporal discretization and the discrete equations considering the interpolation approach introduced in section 2 3 the value of the element in the m th row and n th column of matrix a denoted as a m n could be expressed as eq 27 and an illustrative example is given in appendix a to show the value of each element in the discrete equation associated to a given mesh which contains nonmatching vertices 27 a m n c m m σ ε c ε m α c σ m β c σ m 2 α c σ m n a m n c m m m n σ ε m ε n β c σ m 2 c m m m n σ ε c ε m α c σ m n a m n to develop the final numerical scheme to solve eq 1 temporal discretization is needed based on eq 27 we partition the time interval 0 t as 0 t 0 t 1 t n t and both back euler method and crank nicolson method are provided here for temporal discretization therefore the corresponding accuracy orders in temporal domain are first order and second order respectively for back euler method eq 17 is discretized as 28 a h n 1 μ e λ h n 1 h n τ λ f n 0 n 1 where the superscript n denotes the n th time point and τ denotes the corresponding time step size equivalently this relation can also be expressed as follows 29 a h n 1 b n 0 n 1 where 30 a τ 1 μ e λ a b τ 1 μ e λ h n λ f and the element in the m th row and n th column of a denoted as a m n could be obtained according to the following equation 31 a m n c m μ e τ c m m σ ε c ε m α c σ m β c σ m 2 α c σ m n a m n c m m m n σ ε m ε n β c σ m 2 c m m m n σ ε c ε m α c σ m n a m n for crank nicolson method eq 17 is discretized as 32 a h n 1 h n 2 μ e λ h n 1 h n τ λ f n 0 n 1 equivalently it can be expressed as eq 29 where 33 a τ 1 μ d λ 1 2 a b τ 1 μ d λ h n λ f 1 2 a h n and the value of a m n could be obtained according to the following equation 34 a m n c m μ e τ 1 2 c m m σ ε c ε m α c σ m β c σ m 2 α c σ m n a m n c m m m n σ ε m ε n β c σ m 2 c m m m n σ ε c ε m α c σ m n a m n to solve the equation defined in eq 29 krylov subspace methods saad 2003 including generalized minimum residual gmres and bi conjugate gradient stabilized bicgstab are adopted in the vcfvm 3 test cases and model evaluation indices to evaluate the accuracy and efficiency of the vcfvm six test cases were implemented and the simulation results were compared with the numerical results of modflow or modflow 6 and the analytical solution the vcfvm was run in ubuntu 18 04 with gcc 7 3 0 the details of each case are introduced below 3 1 case 0 piecewise bilinear field we adopt this case edwards and zheng 2010 to evaluate the actual performance of the vcfvm in simulating cases involving highly heterogeneous aquifer with full tensor transmissivity and also to investigate the spatial accuracy order of the vcfvm a piecewise bilinear field is defined over the unitless spatial domain ω 0 1 0 1 and involves a permeability field with a discontinuity at x 0 5 the left transmissivity k l and the right one k r are defined as 35 k l 1 0 5 0 5 1 k r 10 2 2 100 the exact pressure field is defined by 36 h 10 20 x y x 1 2 10 75 1 5 x 9 y 2 x y x 1 2 all boundaries of the spatial domain ω are defined as dirichlet boundary conditions with g 1 x t equal to the defined exact pressure on boundaries all these test settings are shown in fig 2 a we employ six kinds of meshes denoted as m0 1 to m0 6 including quadrangle trapezoidal triangle classic quadrangle random quadrangle shashkov quadrangle kershaw and triangle kershaw meshes to simulate this case the sketch map of each mesh is shown in fig 3 moreover each kind of mesh is simulated with 5 resolution levels in order to investigate the spatial accuracy order of the vcfvm besides case 0 a more challenging test case denoted as case a0 involving medium coefficients with large anisotropy ratio at different orientation is provided in appendix b to show the robustness of vcfvm in those scenarios 3 2 case 1 single pumping well in a confined aquifer this case is designed to evaluate the performance of the vcfvm for problems involving confined aquifers the performance of the vcfvm in dealing with lgr meshes and the adaptability of the vcfvm to different local mesh refinement ratios the study domain has a size of 1 0002 m i e ω 0 1000 0 1000 and the confined aquifer is homogeneous and isotropic the thickness m of the aquifer is 3 m the elastic release coefficient µe is 0 001 and the saturated hydraulic conductivity kxx kyy is 33 33 m d 1 while the cross conductivity terms kxy and kyx are not considered the left and right boundaries are non flux boundaries i e g 2 x y t 0 m and the top and bottom boundaries are constant head boundaries with a value of 100 m i e g 1 x y t 100 m the initial hydraulic head is assumed to be constant i e g 0 x y 100 m a pumping well is located at the centre of ω with a pumping rate of 104 m3 d i e nw 1 x 1 500 500 and q 1 104 m3 d 1 additionally the effects of precipitation infiltration and evapotranspiration are not considered i e p e 0 m d 1 in eq 4 the well pumps water from the first day to the 20th day i e t 20 days the backwards euler method defined in eq 28 is used for temporal discretization all these test settings are shown in fig 2 b the mesh used by modflow is a variable grid as shown in fig 4 a however considering the influence of the pumping wells it is preferable to use a lgr mesh which is fine near the well and coarse away from the well to reduce the computational cost and improve the computational speed without sacrificing accuracy the proposed vcfvm is suitable for arbitrary polygonal meshes which makes the local refinement of the mesh flexible to demonstrate the performance of the vcfvm in dealing with lgr meshes three lgr mesh schemes are used in this case as shown in fig 4 b d and denoted as m1 1 m1 2 and m1 3 it should be noted that the mesh schemes shown in fig 4 c and fig 4 d involve nonmatching vertices the basic information for each mesh scheme mentioned above is given in table 1 to test the adaptability of the vcfvm to different local grid refinement ratios four lgr meshes with different refinement ratios were considered as shown in fig 4 and denoted as m1 2 m1 4 m1 5 and m1 6 the results were compared to those of modflow 6 which is also skilled in dealing with nonmatching grids using the same meshes it should be noted that although the refinement ratio of m1 4 equals that of m1 5 the corresponding coarse grid sizes are different moreover convex angles exist in the control volume formed by the vertices at the interface of coarse and fine cells in the lgr meshes discussed above which may not be allowed in some models the basic information for each mesh scheme mentioned above is given in table 1 3 3 case 2 single pumping well in an unconfined aquifer this case is designed to test the accuracy of the vcfvm in an unconfined aquifer a square homogeneous isotropic unconfined aquifer with a side length of 1000 m and aquifer thickness m equal to 100 m was established the specific yield of the unconfined aquifer μd was 0 1 and the saturated hydraulic conductivities kx and ky were 33 33 m d 1 the left and right boundaries were specified as non flux boundaries i e g 2 0 m3 d 1 and the top and bottom boundaries were constant head boundaries with g 1 90 m the initial hydraulic head was constant at g 0 90 m a pumping well was located in the centre of the region and the pumping rate was q 1 4000 m3 d 1 the pumping lasted for 20 days the crank nicolson method defined in eq 32 was adopted for temporal discretization the problem settings are illustrated in fig 2 c this case was also explored with modflow with the meshes shown in fig 3 a and the vcfvm with the three mesh schemes shown in fig 4 b d and denoted as m2 1 m2 2 and m2 3 for case 2 respectively 3 4 case 3 multiple pumping wells in a confined aquifer this case is designed to demonstrate the accuracy of the vcfvm in a case with multiple wells the mesh geometry aquifer properties and initial and boundary conditions of the aquifer in this case are the same as those in case 1 in this case there are four nw 4 pumping wells located at the following locations x 1 250 250 x 2 750 250 x 3 750 750 and x 4 250 750 the pumping rate of each well is qi 2500 m3 d 1 where i 1 4 and pumping lasts for 20 days i e t 20 days the backwards euler method defined in eq 28 is used for temporal discretization these test settings are shown in fig 2 d this case was explored using modflow with the mesh shown in fig 5 a and using the vcfvm with the three mesh schemes shown in fig 5 b d which are a normal triangular mesh a triangular mesh with local refined grids and a quadrilateral mesh with local refined grids denoted as m3 1 m3 2 and m3 3 respectively the basic information for each mesh scheme is given in table 1 3 5 case 4 two parallel canals this case is designed to test the accuracy of the vcfvm in simulating groundwater movement with a nonpoint source sink term as defined in eq 4 the unconfined aquifer is homogeneous isotropic and bounded by two parallel canals at a distance of 40 m on each side the saturated hydraulic conductivity and the specific yield are kxx 0 5 m d 1 and µ d 0 1 respectively the uniform precipitation rate p 0 002 m d 1 is considered without evapotranspiration or pumping the water surface height in the two canals is 2 m based on the bottom boundary the change in the groundwater level in the unconfined aquifer within 100 days is calculated a cross sectional view of the unconfined aquifer is shown in fig 6 a the top and bottom sides are set as nonflux boundaries i e g 2 0 m3 d 1 and the left and right sides are set as constant head boundaries i e g 1 2 m a uniform rectangular mesh is used by both modflow and vcfvm in this case as shown in fig 6 b 3 6 case 5 application of vcfvm to a real world groundwater simulation to assess the accuracy and efficiency of the vcfvm in scenarios with complex conditions the model was applied to simulate the groundwater flow in longsheng irrigation district 107 26 46 107 29 20 e 40 50 13 40 52 19 n a well irrigation district of hetao irrigation district located in inner mongolia china as shown in fig 7 the area of longsheng irrigation district is 9 06 km2 including 5 29 km2 of farmland there are 54 pumping wells in the district and the irrigation water in the plant growth period from may to september and the leaching water in the nongrowth period november come from these pumping wells there are seven observation wells established in the district indicated as o1 to o7 to observe the groundwater level the locations of pumping wells and observation wells are shown in fig 7 in this district the irrigation quota in the plant growth period is 294 mm and quota for autumn leaching is 180 mm the shallow aquifer in this area is dominated by clayey sand silty sand and clay and the lower part is dominated by silty fine sand and medium fine sand the average aquifer thickness is 136 m for numerical simulation the aquifer was divided into one unconfined layer in the vertical direction with a thickness of 136 m the specific yield of the aquifer was set as 0 04 and the horizontal hydraulic conductivity was set as 9 26 m d according to previous references yang et al 2021 there are lateral recharges from the surrounding areas and the recharge fluxes rb in each stress period were validated based on observed values as given in table 2 the simulation temporal domain lasted from may to november 2018 the stress period was 30 d and the time step was 1 d the point sources and sinks in the district mainly come from pumping wells the corresponding total pumping flux in each stress period was obtained according to the irrigation quota or leaching quota and the total flux was averaged over 54 wells the calculated pumping flux of each well was 261 m3 d from may to september and 622 m3 d in november the nonpoint sources and sinks in the district included precipitation irrigation and phreatic evaporation the precipitation rate p and pan evaporation rate in 2018 were from the data recorded by the linhe weather station as given in table 2 the precipitation recharge coefficient was set as 0 1 and the phreatic evaporation was calculated by eq 37 37 e k t e where e and e are the phreatic evaporation rate and pan evaporation rate respectively mm k is a conversion coefficient and is the ratio of natural water evaporation to pan evaporation which varies in different months t is the phreatic evaporation coefficient which is the ratio of phreatic evaporation at different groundwater table depths to the natural water evaporation the values of k and t were set according to the results of experiments at the bayan gaole test station and jiefangzha shahao canal yang et al 2021 respectively as given in table 2 and table 3 the critical groundwater table depth of phreatic evaporation was 4 m irrigation water was applied only on farmland the calculated irrigation recharge rate was 8 63 10 5 m d from may to september and 3 73 10 4 m d in november modflow 6 was also used here for comparison with the vcfvm the mesh in this case for modflow 6 was generated by gridgen exe lien et al 2015 which was provided on the website of modflow 6 the simulation region was divided into unified rectangular cells with a length of 35 5 m and a width of 39 6 m then the cells near the pumping wells were locally refined with a refinement ratio of 2 and the smoothing function provided by gridgen exe was run the mesh in this case for the vcfvm was generated based on a self written program to transfer the mesh generated by gridgen exe into the format required by the vcfvm the basic information for the meshes used in modflow 6 and the vcfvm is given in table 1 it should be noted that the numbers of vertices and cells were the same for modflow 6 and the vcfvm since the vcfvm mesh was generated based on the modflow 6 mesh 3 7 model evaluation indices to quantify the errors of vcfvm compared to the exact solutions in case 0 the relative error e2 zhang et al 2017 is used which is defined as 38 e 2 i 1 n c i f i y i 2 i 1 n c i y i 2 where fi is the simulated values of the vcfvm yi is the values of benchmark and n is the sample size the rate of convergence r α zhang et al 2017 is used to judge the accuracy of algorithm which is obtained by the following formula 39 r α log e 2 s 2 e 2 s 1 log s 2 s 1 where s 1 and s 2 are the element sizes of two meshes with successive resolutions for other cases to quantify the discrepancies between the simulated results of the vcfvm and modflow modflow 6 or the analytic solution two evaluation indices including the mean absolute error mae and the relative root mean square error rrmse are used as follows 40 m a e 1 n i 1 n f i y i 41 r r m s e i 1 n f i y i 2 n 1 n i 1 n y i 2 for case 0 the evaluation indices were calculated based on the values of all the vertices while for other cases the evaluation indices were calculated based on the values at several selected observation points which were distributed around the whole area but not close to wells or boundaries the coordinates of the observation points for different cases are given in table 4 in addition to the evaluation indices mentioned above the total cpu time and the water balance error eb are used as evaluation indices to evaluate the efficiency of the vcfvm in problems involving lgr meshes eb is defined as follows 42 e b i 0 n v μ c i h i t f h i 0 j 0 n b q j max i 0 n v μ c i h i t f h i 0 j 0 n b q j 100 where nv and nb are the numbers of vertices and boundaries respectively μ refers to μd for a confined aquifer or μe for an unconfined aquifer q is the total flux at the boundary outflow is positive and inflow is negative the subscripts i and j refer to the codes of vertices and boundaries respectively and the superscripts 0 and tf refer to the initial and final time levels respectively 4 results and discussion 4 1 accuracy of the vcfvm in conventional groundwater simulations the accuracy of the vcfvm for problems involving highly heterogeneous aquifer with full tensor transmissivity is demonstrated based on the case 0 and the accuracy of the vcfvm for problems with confined aquifers is demonstrated based on cases 1 and 3 by using different kinds of meshes and the accuracy of the vcfvm for problems with unconfined aquifers and nonpoint source sink terms is demonstrated based on test cases 2 and 4 respectively the relative errors e 2 of the vcfvm in case 0 on each mesh and refined level compared to the exact value are calculated and given in table 5 it can be found that the vcfvm yields the exact solution within 12 decimal places on m0 1 for all refined levels and for other more challenging meshes e g m0 2 to m0 6 the accuracy of the vcfvm increase with the increasement of the refined level and can yield the exact solution within 4 decimal places when the refined levels reach 5 the high accuracy of the vcfvm in case 0 demonstrates the accuracy of the vcfvm in simulating cases involving highly heterogeneous aquifer with full tensor transmissivity moreover the rates of convergence r α are calculated for all families of meshes used in case 0 except for m0 1 the r α for m0 1 is not calculated since the accuracy of the vcfvm on m0 1 is already close to the machine precision so that r α is meaningless for this mesh the r α given in table 5 indicate the vcfvm has a second order spatial accuracy as introduced in section 2 2 the hydraulic heads at 20 d in the simulation domain and in the observation profile located at x 500 m calculated by modflow and the vcfvm using the different mesh schemes illustrated in fig 4 b d for case 1 are shown in fig 8 and the results for case 3 using the mesh schemes illustrated in fig 5 b d are shown in fig 9 the observation profile used in case 3 located at x 250 m the corresponding values of the evaluation indices are given in table 5 for case 1 fig 8 shows that the hydraulic heads in the simulation domain and observation profile obtained by the vcfvm using the meshes of different shapes are consistent with those produced by modflow as shown in table 6 the maes for the different mesh schemes in case 1 are 0 34 m 0 33 m and 0 41 m and the corresponding rrmses are 0 48 0 43 and 0 61 the discrepancies between the results obtained by modflow and the vcfvm using meshes with different kinds of shapes are within acceptable range for case 3 fig 9 shows that the hydraulic heads in the simulation domain and observation profile obtained by the vcfvm using the meshes of different shapes are consistent with those produced by modflow as shown in table 6 the maes for different kinds of meshes in case 3 are smaller than 0 23 m and the corresponding rrmses are smaller than 0 28 the results of case 1 and case 3 demonstrate the accuracy of the vcfvm in confined aquifer problems using meshes with different shapes the hydraulic heads at 20 d in the simulation domain and in the observation profile located at x 500 m calculated by modflow and the vcfvm using different mesh schemes illustrated in fig 4 b d for case 2 are shown in fig 10 the corresponding hydraulic heads at the eight observation points and the values of the evaluation indices are given in table 6 the maes for different mesh schemes in case 2 are 0 07 m 0 05 m and 0 07 m and the corresponding rrmses are 0 11 0 07 and 0 11 which demonstrate the accuracy of the vcfvm in unconfined aquifer cases to assess the accuracy of the vcfvm in dealing with the nonpoint source sink terms an analytical solution is obtained for case 4 when the groundwater reaches a steady state the relationship between the groundwater level and the distance to the left canal can be expressed as follows 43 h x 2 h 1 2 h 2 2 h 1 2 l x p k l x x 2 where l is the distance between the two canals l and h 1 and h 2 are the water levels in the left and right canals respectively l the groundwater level at steady state obtained by the vcfvm is compared to the analytical solution and the results of modflow as shown in fig 11 notably the vcfvm simulated values are slightly lower than those based on the analytical solution and higher than those of modflow but all values are close to each other the mae values between the vcfvm result and the analytical solution the vcfvm result and modflow result are both 0 01 m indicating that the vcfvm can effectively deal with nonpoint source sink terms according to the results above the vcfvm has a second order spatial accuracy and can be accurately applied to problems involving confined aquifers unconfined aquifers heterogeneous and anisotropic aquifers and nonpoint source sink terms which account for the majority of problems considered in conventional groundwater simulation 4 2 ability of the vcfvm in dealing with nonmatching grids with different refinement ratios the ability to deal with nonmatching grids especially those with high refinement ratios is one of the main advantages of the vcfvm to demonstrate this the accuracy of the vcfvm for scenarios involving nonmatching grids with different refinement ratios is demonstrated by simulating case 1 using meshes m1 2 m1 4 m1 5 and m1 6 the results obtained by modflow using refined grids are used as benchmark the results of the vcfvm and modflow 6 using the same meshes are compared with those from modflow the comparison results of hydraulic heads at 20 d in observation profile located at x 500 m simulated by modflow the vcfvm and modflow 6 and also the discrepancies between results obtained by vcfvm or modflow 6 and modflow in the domain are shown in fig 12 the corresponding hydraulic heads at the eight observation points and the values of the evaluation indices are given in table 6 it can be found that the deviations between the results of vcfvm or modflow 6 and modflow increase with the larger refinement ratio as shown in fig 12 a d the discrepancies between the vcfvm and modflow are always lower than those between modflow 6 and modflow as shown in the fig 12 e l in particular the hydraulic heads obtained by modflow 6 using the m1 6 mesh exhibit a large difference compared to those of modflow as shown in fig 12 l table 6 shows that the maes of the vcfvm range from 0 33 to 0 66 m and the maes of modflow 6 range from 0 76 to 2 10 m additionally the rrmses of vcfvm range from 0 43 to 0 89 and those for modflow 6 range from 1 19 to 2 79 when the mesh with a refinement ratio of 1 6 m1 6 is used the error of modflow 6 is nearly twice that of other meshes and is three times greater than the error of the vcfvm it can be concluded that the vcfvm yields higher accuracy in cases with nonmatching grids especially when the refinement ratio is high in other words the vcfvm exhibits very high accuracy for those control volumes with convex angles 4 3 performance of the vcfvm in a real world case the accuracy of the vcfvm in a real world case with multiple pumping wells is demonstrated by test case 5 the simulated groundwater levels of the vcfvm and modflow 6 in simulation domain on june 1st september 1st and december 1st are shown in fig 13 and the simulated and observed groundwater levels along time at each observation well as well as the averaged groundwater level among all observation wells are shown in fig 14 the corresponding evaluation indices are given in table 7 it should be noted that the groundwater table depth instead of the groundwater level is used here to obtain the rrmses of the vcfvm and modflow 6 as shown in fig 13 as expected the groundwater level in the simulated domain gets deeper from june to september due to the water pumping for irrigation and get recovered from september to december due to lateral recharge from adjacent areas with autumn irrigation moreover the simulated groundwater levels in the domain obtained by the vcfvm are consistent with those of modflow 6 at corresponding time according to fig 14 slight differences between the results from the vcfvm and modflow 6 are observed in single well observations as shown in fig 14 a g while the average values of the vcfvm are close to those of modflow 6 as shown in fig 14 h and both sets of results from the vcfvm and modflow 6 are similar to the observed values as shown in table 7 the maes of the vcfvm range from 0 25 to 0 51 m at different observation wells and the values of modflow 6 range from 0 25 to 0 47 m the average values of mae for both the vcfvm and modflow 6 are 0 35 m the rrmses of the vcfvm at different observation wells range from 8 32 to 19 90 with an average value of 12 38 and those of modflow 6 range from 8 23 to 16 86 with an average value of 12 69 it can be concluded from this case that the vcfvm has good performance under complex practical conditions as indicated by comparing the simulation results to results from modflow 6 and the observed data 4 4 efficiency of the vcfvm in dealing with lgr meshes the computational efficiency of the vcfvm was compared with the efficiency of modflow modflow 6 using the results from case 1 and case 5 the cpu time and eb for case 1 and case 5 using different mesh schemes are given in table 8 for case 1 the total cpu time for modflow is 7 02 s and it takes 2 04 s 1 91 s 1 55 s and 1 76 s for the vcfvm to run in the four mesh schemes m1 2 m1 4 m1 5 and m1 6 respectively and 2 71 s 2 25 s 2 17 s and 1 91 s for modflow 6 with the corresponding schemes the eb of modflow is 0 021 and it is nearly 0 000 for both the vcfvm and modflow 6 for all mesh schemes for test case 5 the total cpu time of the vcfvm and modflow 6 are 1563 s and 1550 s for the same mesh scheme respectively the eb of the vcfvm is 0 03 and that of modflow 6 is 0 02 it can be concluded that both the vcfvm and modflow 6 have advantages in saving computational time and conserving the mass balance the cpu time of modflow 6 is slightly shorter than that of the vcfvm in test case 5 mainly because the advanced linearization scheme specifically the newton raphson method langevin et al 2017 is adopted to deal with unconfined aquifer conditions which can be further improved in our developed model 5 conclusions in this paper a numerical groundwater model based on the vcfvm is proposed all unknowns to be solved are associated with vertices and the control volume could be defined for each vertex including the nonmatching vertices then the hydraulic head in the whole simulation area can be obtained by solving the matrix equations without additional treatment at the nonmatching vertices the accuracy and performance of the algorithm were tested based on several cases and the major conclusions can be made as follows 1 the vcfvm can obtain accurate hydraulic heads with negligible mass balance errors using different arbitrary polygonal grids in confined and unconfined aquifers involving heterogeneous anisotropic transmissivities and nonpoint source sink terms 2 the vcfvm can simulate groundwater problems using meshes with high refinement ratios with high accuracy 3 the vcfvm exhibits high efficiency in dealing with nonmatching grids with high refinement ratios and performs well in mass balance due to local conservation of the numerical flux 4 the current version of vcfvm is a 2 d model and the extension of the model to 3 d must be further studied since a simple linearization scheme is used by the vcfvm to solve unconfined aquifer problems the adoption of more efficient methods such as the newton raphson method remains to be further explored credit authorship contribution statement yingzhi qian validation writing original draft yan zhu conceptualization methodology writing review editing xiaoping zhang conceptualization methodology writing review editing jiming wu methodology ming ye writing review editing wei mao writing review editing jingwei wu funding acquisition jiesheng huang funding acquisition supervision jinzhong yang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the study was partially supported by the national key research and development program of china 2021yfd1900805 02 and national natural science foundation of china through grants 51790533 52179041 yingzhi qian was sponsored the china scholarship council no 202106270106 supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2023 104392 appendix supplementary materials image application 1 
45,many algorithms have been proposed to cope with groundwater numerical simulation associated with local grid refinements typically for subsurface flow driven by sources acting on diverse scales in this context we focus on establishing an efficient local grid refinement method with nonmatching grids for groundwater flow modelling the new model is based on the vertex centred finite volume method vcfvm the core idea of the algorithm resting on set all unknowns on vertices and the flux between two vertices the numerical flux is expressed as a function of the hydraulic heads at the vertices of the element containing the lateral surface the total outflow of the control volume of a given vertex is expressed as the sum of numerical fluxes since the algorithm sets all unknowns on vertices and a control volume can be defined for each vertex our scheme readily embeds treatment of arbitrary polygonal grids including nonmatching grids in the presence of local grid refinement without additional treatment at the nonmatching nodes six test cases including five assumed ones and a real world case were adopted to evaluate the accuracy and efficiency of the new algorithm the hydraulic heads calculated by the new algorithm were compared with those by a widely used and tested numerical groundwater model called modflow and the analytic solutions the mass balance error and the cpu time were compared with those of the modflow 6 model which owns ability to cope with nonmatching grids the results show that the new algorithm yields high accuracy and efficiency in simulating groundwater flows with local grid refinements keywords vertex centred finite volume method local grid refinement nonmatching grids groundwater simulation data availability data will be made available on request 1 introduction regional groundwater simulation is important for groundwater resource management and protection an important issue in regional groundwater simulation is local grid refinement with nonmatching grids wen and gómez hernández 1996 which refers to those meshes containing hanging nodes on certain edges is required in those simulation domains with heterogeneity of subsurface formations with hydraulic conductivities spanning many scales he and ren 2006 krcmar and sracek 2014 or with significant hydraulic gradient variations near wells rivers streams channels or ditches mehl and hill 2002 it is thus necessary to develop algorithms with ability to solve groundwater flow equation with local refined grids so that the reginal groundwater simulation which is originally time consuming can be done with high efficiency various spatial discretization methods have been used for numerical groundwater simulations and the three popular methods are the finite difference method fdm used in modflow harbaugh et al 2000 the finite element method fem in feflow diersch 1998 trefry and muffels 2007 and the finite volume method fvm in hydrogeosphere brunner and simmons 2012 however conventional numerical groundwater models are unideal for dealing with nonmatching grid for example one solution for local grid refinement in the fdm is to use variably spaced meshes and to set the widths of rows and columns to small values in the area of interest this approach can lead to cells with large aspect ratios and unnecessary refinement in areas where such a fine resolution is not needed mehl and hill 2002 significant efforts have been made to overcome the limitations of conventional numerical methods in handling nonmatching grids one method is to divide the simulation region into a parent model with coarse grids and several child models with finer grids the parent model provides the flux boundary or the specified head boundary for the child model ward et al 1987 remero et al 2006 this method can lead to a significant discrepancy in the interfaces between the parent and child models since there is no feedback from the child models to the parent model langevin et al 2017 then an iterative coupling method between the parent and child models was developed székely 1998 built a groundwater model based on a point centred finite difference framework with the parent and child grids iteratively coupled mehl and hill 2002 further modified the method and applied it to modflow to develop a local grid refinement model called modflow lgr the darcy weighted interpolation was used to define the head boundary conditions along the interface of the child model the accuracy of modflow lgr was proven to be better than those of one direction coupled models and models that rely on linear interpolation along the interface the modflow lgr model has been widely used in groundwater simulations when local grid refinement is needed borsi et al 2013 vilhelmsen et al 2011 dickinson et al 2007 and panday and langevin 2012 further optimized the coupling method of the parent and child models to make the model suitable for refinements with nonmatching vertices in general the models mentioned above address the nonmatching grids by iteratively coupling the parent and child models in addition to these iterative coupling methods some models use additional treatments to obtain the hydraulic head or the flux in nonmatching grids and then solve the matrix equations among them modflow unstructured grid modflow usg panday et al 2013 which has been widely used in simulations with multiscale problems feinstein et al 2016 herckenrath et al 2015 krcmar and sracek 2014 is based on an underlying control volume finite difference cvfd formulation and the flux between coarse and fine cells is calculated based on the hydraulic heads at ghost nodes and fine cell nodes the general unstructured grid based on concepts developed for modflow usg has also been adopted in the new version of modflow called modflow 6 langevin et al 2017 the hydrogeosphere model which originated from the code of frac3dvs therrien and sudicky 1996 guvanasen et al 2007 substitutes the hydraulic head at the fine nodes with the interpolation head at coarse nodes to generate a global matrix although the models mentioned above can be effectively implemented for nonmatching grids by solving the unified matrix equations additional steps are required at the interface of coarse and fine grids e g interpolating the hydraulic head and flux distribution at the interface numerical algorithms have also been developed to address the issue of local refinement among them the most widely used numerical algorithm is the multiscale method matouš et al 2017 the multiscale method targets the full problem at the original resolution and attempts to directly capture the fine scale behaviour of the solution in coarser grids he and ren 2005 the multiscale method proposed by hou and wu 1997 was based on the fem and called the multiscale finite element method mfem and it was demonstrated to be efficient in solving scale disparity problems ye et al 2004 xie et al 2016 improved the construction method of the basis function of the mfem and then extended the method from 2d to 3d simulations xie et al 2017 many other multiscale models have been developed based on different spatial discretization methods such as the fdm abdulle and e 2003 chen and ren 2014 langevin et al 2017 fvm jenny et al 2003 durlofsky et al 2007 hajibeygi et al 2008 lunati et al 2011 domelevo and omnes 2005 and mixed fvm he and ren 2005 xie et al 2019 chung et al 2015 chen and hou 2003 ye et al 2004 fu and chung et al 2019 zhang et al 2017 among these models those based on the fdm fvm and some mixed fem preserve the local conservation of the velocity flux the multiscale method was originally designed for solving heterogeneity problems and has limitations in solving problems with wells the basic functions in multiscale models were further adjusted to consider the influence caused by wells he and ren 2006 jenny and lunati 2009 wolfsteiner et al 2006 kramarenko et al 2017 additionally multiscale models for nonmatching grids were developed and these models are more suitable for simulating groundwater flow near wells gao and li 2017 arbogast et al 2000 ganis et al 2015 these multiscale models for nonmatching grids still have limitations regarding the shape of the grid for example these models are limited to nested grids ewing and wang 1992 triangular grids gao and li 2017 square grids wheeler et al 2002 thomas and wheeler 2011 and hexahedral grids ganis et al 2015 although some grid shapes such as triangular grids and hexahedral grids can flexibly deal with problems requiring local grid refinements a numerical model without limitation on grid shape would be more general and flexible additionally many of the models mentioned above were designed to simulate groundwater flow in a confined aquifer xie et al 2019 chen and ren 2014 gao and li 2017 kramarenko et al 2017 zhang et al 2017 but their applicability in unconfined aquifer problems which are often nonlinear has not been assessed in this paper a new algorithm for solving groundwater flow equation with nonmatching grid based on the vertex centred finite volume method is developed the algorithm is designed for anisotropic diffusion problems based on arbitrary polygonal grids there are three kinds of unknowns involved including vertex centred edge midpoint and cell centred unknowns the vertex centred unknowns are primary and associated with finite volume equations the edge midpoint and cell centred unknowns are treated as auxiliary unknowns and are interpolated based on the primary unknowns therefore the final scheme is a pure vertex centred scheme the main novelty of the presented algorithm is that it is applicable for not only arbitrary polygonal grids but also nonmatching grids which makes local refinements more flexible when compared to standard methods or those hybrid fe methods matthai et al 2005 matthai et al 2007 the new groundwater model hereinafter referred to as the vcfvm is constructed based on the above algorithm since the groundwater problem is a special case type of diffusion problem six test cases including a heterogeneous anisotropic aquifer a single pumping well in confined and unconfined aquifers multiple pumping wells in a confined aquifer two parallel canals in an unconfined aquifer with nonpoint sink source items and a real world test case with multiple pumping wells at field scale were designed to evaluate the accuracy and efficiency of the new algorithm the major contribution of this work is that it provides a new alternative to solve the confined and unconfined groundwater flow equations with arbitrary polygonal grids including nonmatching grids using a unified approach regardless to the shape or form of the grids and the method strictly conserves the local mass balance the paper is organized as follows the numerical algorithm of the vcfvm is introduced in section 2 five virtual test cases and a real world test case used to verify the accuracy and efficiency of the vcfvm are shown in section 3 the results of the test cases are shown in section 4 and the simulation results are compared with those of widely used models modflow or modflow 6 and the analytical solution to demonstrate the accuracy and efficiency of the vcfvm conclusions are given in section 5 2 vcfvm numerical algorithm 2 1 vcfvm for confined aquifers let ω r 2 be the two dimensional solution domain and use ω t ω 0 t to denote the spatiotemporal region of interest ω0 ω 0 denotes the initial region γ d t γ d 0 t denotes a first type boundary dirichlet boundary and γ n t γ n 0 t denotes a second type boundary neumann boundary moreover let x x y be a spatial point in ω and x t be a spatiotemporal point in ω t in this case a groundwater problem involving a confined aquifer can be mathematically described as 1a k h μ e h t f x t x t ω t 1b h x t g 0 x x t ω 0 1c h x t g 1 x t x t γ d t 1d k h x t n x g 2 x t x t γ n t where h is the hydraulic head l μe μsm is the elastic release coefficient of the confined aquifer based on specific storativity μs l 1 and the thickness of aquifer m l is the gradient operator which is defined by h h x h y t g 0 g 1 and g 2 are the specified initial value dirichlet value and neumann value of the problem respectively and n x denotes the unit normal vector outward to ω at the neumann boundary moreover k k sm is the transmissivity of the confined aquifer and 2 k s k x x k x y k y x k y y denotes the saturated hydraulic conductivity tensor kxx and kyy are the saturated hydraulic conductivities in the x and y directions respectively lt 1 and kxy and kyx are the cross conductivity terms lt 1 thus 3 k h x m k x x h x m k x y h y y m k y x h x m k y y h y and f is the source sink term defined by 4 f p e i 1 n w q i δ x x i where p p x t denotes the amount of precipitation infiltration that leads to groundwater recharge lt 1 e e x t is the evapotranspiration of groundwater lt 1 qi represents the pumping capacity of a pumping well located at xi yi nw is the number of pumping wells and δ is the dirac delta function which satisfies the following conditions 5 δ x 0 x 0 x 0 and r 2 δ x d x 1 the physical meaning of eq 1a reflects the mass conservation relation of groundwater flow in an aquifer and represents a water balance relation per unit volume and unit time in the aquifer under the darcy flow conditions that is the difference between a mass of water flowing into and out of a unit volume aquifer per unit time the left side of eq 1a is equal to the amount of water released or stored elastically in the unit volume aquifer at the same time the right side of eq 1a 2 2 spatial discretization the space domain ω is partitioned into several nonoverlapping polygonal cells that form so called primary meshes for spatial discretization shown as the meshes with solid line segments in fig 1 a γd is the boundary of ω and x v is a vertex of ω the cell centre is defined as the geometric centre and the corresponding coordinates are a simple average of the cell vertices each primary cell is further partitioned into several quadrilateral sub cells by connecting the cell centre with the midpoint of edges as shown by the dashed line segments in fig 1 a all sub cells sharing the same vertex in the primary mesh form a polygonal cell in the dual mesh as shown in the highlighted part of fig 1 a denoted as c v which is the control volume of the corresponding vertex e g vertex x v in regards to those vertices lie on the nonmatching edge denoted as nonmatching vertex here in and after their control volumes are formed by connecting the centre of the neighbour cells with the midpoint of edges that sharing the vertex which is similar to those normal vertices shown as the vertex x v and the corresponding control volume c v in fig 1 c since the control volumes of all vertices including nonmatching vertices can be formed using a unified approach there is no difference in the spatial and temporal discretization schemes among normal and nonmatching vertices and the spatial and temporal discretization schemes for the nonmatching vertices will not be illustrated separately in the following sections for the primary and dual meshes we introduce two types of unknowns the primary unknowns and the auxiliary unknowns the primary unknowns are defined at the vertices of the primary mesh in ω or on ω γd and are shown as black solid circles in fig 1 a each primary unknown is associated with a finite volume fv equation the auxiliary unknowns are defined at the cell centres and edge midpoints of the primary mesh and are denoted by red solid squares and blue solid circles in fig 1 a respectively these auxiliary unknowns do not have corresponding fv equations and they are evaluated based on the primary unknowns or if necessary dirichlet boundary data which will be discussed in detail later in the paper after forming the control volume of each vertex including the nonmatching vertices the numerical flux outwards a specified control volume via a specified dual edge is constructed let x v and x v be two interior vertices of the primary mesh sharing edge σ for primary cell c as shown in fig 1 b let x σ x c εc and k c denote the midpoint of the edge σ the centre of c the set of edges of c and the constant restriction of k on c respectively n c σ v resp n c σ v refers to the unit vector normal to the dual edge x σ x c outward to the dual cell associated with the vertex x v resp x v obviously n c σ v n c σ v in addition let εv resp mv be the set of primary edges resp primary cells sharing x v according to darcy s law the flow velocity v in the primary cell c can be defined by 6 v k c h since only the component of velocity normal to the dual edge contributes to the outflow the outflow of the control volume crossing the dual edge x σ x c can be defined by 7 f c σ v x σ x c v n c σ v h x σ x c k c t n c σ v where x σ x c denotes the length of the edge x σ x c the vector x σ x c k c t n c σ v can be decomposed as a linear combination of two vectors x v x c and x v x σ 8 x σ x c k c t n c σ v α c σ v x c x v β c σ v x σ x v where αc σ v and βc σ v are the two combination coefficients these coefficients are expressed as 9a α c σ v x σ x c n c σ v t k c t r x σ x v x c x v t r x σ x v 9b β c σ v x σ x c n c σ v t k c t r x c x v x σ x v t r x c x v where r is a rotation matrix that makes a vector rotate 90 degrees counterclockwise i e 10 r 0 1 1 0 substituting eq 8 into eq 7 leads to 11 f c σ v h α c σ v x c x v β c σ v x σ x v α c σ v h v h c β c σ v h v h σ similarly based on the following vector splitting 12 x σ x c k c t n c σ v α c σ v x c x v β c σ v x σ x v the following equation is obtained 13 f c σ v α c σ v h v h c β c σ v h v h σ where 14a α c σ v x σ x c n c σ v t k c t r x σ x v x c x v t r x σ x v 14b β c σ v x σ x c n c σ v t k c t r x c x v x σ x v t r x c x v for the control volume c v associated with the specified vertex x v the total outflow fv is the sum of the outflows crossing the dual edges of c v then the left hand side of eq 1a can be approximated by 15 f v c m v σ ε c ε v f c σ v and therefore the finite volume equation associated with a specific vertex x v of ω γd can be constructed as follows 16 f v c v μ e h t d x c v f d x μ e c v h v t c v f x v where c v denotes the area of the dual cell c v the matrix form of eq 16 is 17 a h μ e λ h t λ f where a is a coefficient matrix the value of element in the m th row and n th column of a denoted as a m n is given in section 2 4 after introducing the interpolation approach of auxiliary unknowns h is a vector related to hv f is a vector related to f x v and λ is a diagonal matrix with c v diagonal elements in regards of the accuracy order of the proposed spatial discretization it was investigated by simulating scenarios using different kinds of challenging meshes with different resolutions as shown in section 3 1 and the simulation results indicate that the vcfvm has a second order spatial accuracy the details can be found in section 3 1 and section 4 1 2 3 interpolation of auxiliary unknowns and analysis of local conservation in order to obtain a fully vertex centred finite volume scheme the auxiliary unknowns need to be interpolated based on the primary unknowns in the proposed scheme since the auxiliary unknowns are defined at the centres and edge midpoints of the primary cells they can be easily interpolated based on the vertex unknowns let x σ be the midpoint of σ with endpoints x v and x v x c is the geometric centre of primary cell c then for the auxiliary unknowns defined at x σ and x c elimination can be performed based on the following interpolation strategies 18 h σ h v h v 2 and 19 h c 1 n c x v v c h v where vc denotes the set of vertices in cell c nc denotes the number of vertices in cell c it should be noted that in eq 18 the influence of other vertices is ignored e g in fig 1 b h σis assumed to be only related to hv and h v which are the two endpoints of the corresponding edge σ while the influences of other vertices in the cell c are ignored in other words eq 18 and eq 19 assume the unknown changes linearly in a given cell and this may introduce nonnegligible error in cases that the size of the given cell is too large to ignore the nonlinearity of unknown within the cell however since the interpolation approach is not the focus of this research and linear interpolation methods are widely used in numerical models such as the method used in modflow usg to obtain the hydraulic head at a ghost node panday et al 2013 a linear approach is also adopted here to obtain the pressure head at the midpoint it should be noted that fine grids are needed in those regions where unknown changes highly nonlinearly to avoid unacceptable errors introduced by the linear interpolation scheme adopted as what we do in the test cases shown in section 3 at the end of this subsection we investigate the local conservation of numerical flux which is the basis of the finite volume method the medium properties e g k are defined over the elements in the proposed method thus the k c t of eq 9 is equal to that of eq 14 and for the meshes used in those scenarios involving heterogeneous layers faults pinchouts and fractures the edges of the primary cells should be aligned with the interface to have exact definition of the medium properties in the spatial domain manzoor et al 2021 and for the scenarios involving pumping wells or other point sources vertices are required to be aligned with those points consequently we have following lemma lemma 1 if primary c is a star shaped cell whose cell centre is x c then for the coefficients in the numerical flux equation defined in eq 9 and eq 14 we have 20 α c σ v β c σ v α c σ v β c σ v 21 α c σ v α c σ v 0 proof since c is a star shaped cell with respect to x c we have x c x v t r x σ x v x σ x v t r x c x v x σ x c d c σ v where d c σ v denotes the distance form vertex x v to the dual edge x σ x c then we deduce from eq 9 and eq 14 that α c σ v β c σ v x σ x c n c σ v t k c t r x σ x c x c x v t r x σ x v x σ x c n c σ v t k c t n c σ v d c σ v where we have used the identity r x σ x c x σ x c n c σ v and similarly we have α c σ v β c σ v x σ x c n c σ v t k c t n c σ v d c σ v where d c σ v denotes the distance form vertex x v to the dual edge x σ x c since x σ is the midpoint of primary edge we have d c σ v d c σ v recalling that n c σ v n c σ v and k c is positive definite we obtain eq 20 as for 21 we have x c x v t r x σ x v x c x v t r x σ x v and consequently we have α c σ v α c σ v x σ x c n c σ v t k c t r x σ x v x c x v t r x σ x v x σ x c n c σ v t k c t r x σ x v x c x v t r x σ x v x σ x c n c σ v t k c t r 2 x σ x v x v x c x v t r x σ x v 0 the properties shown in eq 20 and eq 21 are crucial for the derivation of the local conservation of numerical flux and deducing from them we have the following lemma lemma 2 if primary c is a star shaped cell whose cell centre is x c then for the numerical fluxes defined in eq 11 and eq 13 we have 22 f c σ v f c σ v 0 proof according to the definitions of f c σ v and f c σ v in eq 11 and eq 13 we have f c σ v f c σ v α c σ v β c σ v h v h σ α c σ v β c σ v h v h σ recalling eq 20 and eq 21 we have f c σ v f c σ v α c σ v β c σ v h v h v β c σ v β c σ v h σ 2 α c σ v β c σ v β c σ v h σ 0 where we have used the identity h σ h v h v 2 lemma 2 demonstrated that the numerical fluxes are continuous crossing the dual edge of control volume for both normal grids and nonmatching grids it should be pointed out that the flux continuity across the grid cell s face is not considered in the vcfvm however in many practical problems especially in the cases that there are jumps in medium properties the flux continuity across interfaces that separate changes in medium properties is a concerned issue and its importance has been verified by comparison for two phase flow between standard control volume finite element cvfe and control volume distributed multipoint flux approximation cvd mpfa in the literatures edwards 2006a edwards 2006b in which it has been proved that the cvd mpfa method with flux continuity across crucial interfaces where the medium properties jump yields highly resolved solutions it is worth mentioning that the reference of wu 2017 proposed a post processing technique to make a vertex centred finite volume scheme satisfy the flux continuity across the grid cell s faces which can also be applicable to our approach it is an interesting topic to further discuss how to make the vertex centred scheme assure the flux continuity across the grid cell s faces which will also be studied in the future 2 4 extending the vcfvm to unconfined aquifers for an unconfined aquifer the groundwater problem can be expressed by eq 1 except eq 1a must be slightly modified in this case the transmissivity k has the form 23 k h k s h and k s is the saturated hydraulic conductivity tensor defined by eq 2 notably the transmissivity tensor is dependent on the hydraulic head h which makes eq 1a a nonlinear partial differential equation 24 x k x x h h x k x y h h y y k y x h h x k y y h h y μ d h t f or in a more compact form 25 k h h μ d h t f where μd is the specified yield of the unconfined aquifer unitless the difference of vcfvm between unconfined aquifer and confined aquifer mainly exists in the construction of numerical flux to be specific since the transmissivity k h depends on h in an unconfined aquifer the corresponding combination coefficients defined in eq 9a and eq 9b should be modified to 26a α c σ v h x σ x c n c σ v t k c t h r x σ x v x c x v t r x σ x v 26b β c σ v h x σ x c n c σ v t k c t h r x c x v x σ x v t r x c x v and similar modifications are made for αc σ v h and βc σ v h obviously lemma 1 and 2 for the confined aquifer still stand up for the unconfined aquifer and the matrix equation after spatial discretization has the same form of eq 17 2 5 temporal discretization and the discrete equations considering the interpolation approach introduced in section 2 3 the value of the element in the m th row and n th column of matrix a denoted as a m n could be expressed as eq 27 and an illustrative example is given in appendix a to show the value of each element in the discrete equation associated to a given mesh which contains nonmatching vertices 27 a m n c m m σ ε c ε m α c σ m β c σ m 2 α c σ m n a m n c m m m n σ ε m ε n β c σ m 2 c m m m n σ ε c ε m α c σ m n a m n to develop the final numerical scheme to solve eq 1 temporal discretization is needed based on eq 27 we partition the time interval 0 t as 0 t 0 t 1 t n t and both back euler method and crank nicolson method are provided here for temporal discretization therefore the corresponding accuracy orders in temporal domain are first order and second order respectively for back euler method eq 17 is discretized as 28 a h n 1 μ e λ h n 1 h n τ λ f n 0 n 1 where the superscript n denotes the n th time point and τ denotes the corresponding time step size equivalently this relation can also be expressed as follows 29 a h n 1 b n 0 n 1 where 30 a τ 1 μ e λ a b τ 1 μ e λ h n λ f and the element in the m th row and n th column of a denoted as a m n could be obtained according to the following equation 31 a m n c m μ e τ c m m σ ε c ε m α c σ m β c σ m 2 α c σ m n a m n c m m m n σ ε m ε n β c σ m 2 c m m m n σ ε c ε m α c σ m n a m n for crank nicolson method eq 17 is discretized as 32 a h n 1 h n 2 μ e λ h n 1 h n τ λ f n 0 n 1 equivalently it can be expressed as eq 29 where 33 a τ 1 μ d λ 1 2 a b τ 1 μ d λ h n λ f 1 2 a h n and the value of a m n could be obtained according to the following equation 34 a m n c m μ e τ 1 2 c m m σ ε c ε m α c σ m β c σ m 2 α c σ m n a m n c m m m n σ ε m ε n β c σ m 2 c m m m n σ ε c ε m α c σ m n a m n to solve the equation defined in eq 29 krylov subspace methods saad 2003 including generalized minimum residual gmres and bi conjugate gradient stabilized bicgstab are adopted in the vcfvm 3 test cases and model evaluation indices to evaluate the accuracy and efficiency of the vcfvm six test cases were implemented and the simulation results were compared with the numerical results of modflow or modflow 6 and the analytical solution the vcfvm was run in ubuntu 18 04 with gcc 7 3 0 the details of each case are introduced below 3 1 case 0 piecewise bilinear field we adopt this case edwards and zheng 2010 to evaluate the actual performance of the vcfvm in simulating cases involving highly heterogeneous aquifer with full tensor transmissivity and also to investigate the spatial accuracy order of the vcfvm a piecewise bilinear field is defined over the unitless spatial domain ω 0 1 0 1 and involves a permeability field with a discontinuity at x 0 5 the left transmissivity k l and the right one k r are defined as 35 k l 1 0 5 0 5 1 k r 10 2 2 100 the exact pressure field is defined by 36 h 10 20 x y x 1 2 10 75 1 5 x 9 y 2 x y x 1 2 all boundaries of the spatial domain ω are defined as dirichlet boundary conditions with g 1 x t equal to the defined exact pressure on boundaries all these test settings are shown in fig 2 a we employ six kinds of meshes denoted as m0 1 to m0 6 including quadrangle trapezoidal triangle classic quadrangle random quadrangle shashkov quadrangle kershaw and triangle kershaw meshes to simulate this case the sketch map of each mesh is shown in fig 3 moreover each kind of mesh is simulated with 5 resolution levels in order to investigate the spatial accuracy order of the vcfvm besides case 0 a more challenging test case denoted as case a0 involving medium coefficients with large anisotropy ratio at different orientation is provided in appendix b to show the robustness of vcfvm in those scenarios 3 2 case 1 single pumping well in a confined aquifer this case is designed to evaluate the performance of the vcfvm for problems involving confined aquifers the performance of the vcfvm in dealing with lgr meshes and the adaptability of the vcfvm to different local mesh refinement ratios the study domain has a size of 1 0002 m i e ω 0 1000 0 1000 and the confined aquifer is homogeneous and isotropic the thickness m of the aquifer is 3 m the elastic release coefficient µe is 0 001 and the saturated hydraulic conductivity kxx kyy is 33 33 m d 1 while the cross conductivity terms kxy and kyx are not considered the left and right boundaries are non flux boundaries i e g 2 x y t 0 m and the top and bottom boundaries are constant head boundaries with a value of 100 m i e g 1 x y t 100 m the initial hydraulic head is assumed to be constant i e g 0 x y 100 m a pumping well is located at the centre of ω with a pumping rate of 104 m3 d i e nw 1 x 1 500 500 and q 1 104 m3 d 1 additionally the effects of precipitation infiltration and evapotranspiration are not considered i e p e 0 m d 1 in eq 4 the well pumps water from the first day to the 20th day i e t 20 days the backwards euler method defined in eq 28 is used for temporal discretization all these test settings are shown in fig 2 b the mesh used by modflow is a variable grid as shown in fig 4 a however considering the influence of the pumping wells it is preferable to use a lgr mesh which is fine near the well and coarse away from the well to reduce the computational cost and improve the computational speed without sacrificing accuracy the proposed vcfvm is suitable for arbitrary polygonal meshes which makes the local refinement of the mesh flexible to demonstrate the performance of the vcfvm in dealing with lgr meshes three lgr mesh schemes are used in this case as shown in fig 4 b d and denoted as m1 1 m1 2 and m1 3 it should be noted that the mesh schemes shown in fig 4 c and fig 4 d involve nonmatching vertices the basic information for each mesh scheme mentioned above is given in table 1 to test the adaptability of the vcfvm to different local grid refinement ratios four lgr meshes with different refinement ratios were considered as shown in fig 4 and denoted as m1 2 m1 4 m1 5 and m1 6 the results were compared to those of modflow 6 which is also skilled in dealing with nonmatching grids using the same meshes it should be noted that although the refinement ratio of m1 4 equals that of m1 5 the corresponding coarse grid sizes are different moreover convex angles exist in the control volume formed by the vertices at the interface of coarse and fine cells in the lgr meshes discussed above which may not be allowed in some models the basic information for each mesh scheme mentioned above is given in table 1 3 3 case 2 single pumping well in an unconfined aquifer this case is designed to test the accuracy of the vcfvm in an unconfined aquifer a square homogeneous isotropic unconfined aquifer with a side length of 1000 m and aquifer thickness m equal to 100 m was established the specific yield of the unconfined aquifer μd was 0 1 and the saturated hydraulic conductivities kx and ky were 33 33 m d 1 the left and right boundaries were specified as non flux boundaries i e g 2 0 m3 d 1 and the top and bottom boundaries were constant head boundaries with g 1 90 m the initial hydraulic head was constant at g 0 90 m a pumping well was located in the centre of the region and the pumping rate was q 1 4000 m3 d 1 the pumping lasted for 20 days the crank nicolson method defined in eq 32 was adopted for temporal discretization the problem settings are illustrated in fig 2 c this case was also explored with modflow with the meshes shown in fig 3 a and the vcfvm with the three mesh schemes shown in fig 4 b d and denoted as m2 1 m2 2 and m2 3 for case 2 respectively 3 4 case 3 multiple pumping wells in a confined aquifer this case is designed to demonstrate the accuracy of the vcfvm in a case with multiple wells the mesh geometry aquifer properties and initial and boundary conditions of the aquifer in this case are the same as those in case 1 in this case there are four nw 4 pumping wells located at the following locations x 1 250 250 x 2 750 250 x 3 750 750 and x 4 250 750 the pumping rate of each well is qi 2500 m3 d 1 where i 1 4 and pumping lasts for 20 days i e t 20 days the backwards euler method defined in eq 28 is used for temporal discretization these test settings are shown in fig 2 d this case was explored using modflow with the mesh shown in fig 5 a and using the vcfvm with the three mesh schemes shown in fig 5 b d which are a normal triangular mesh a triangular mesh with local refined grids and a quadrilateral mesh with local refined grids denoted as m3 1 m3 2 and m3 3 respectively the basic information for each mesh scheme is given in table 1 3 5 case 4 two parallel canals this case is designed to test the accuracy of the vcfvm in simulating groundwater movement with a nonpoint source sink term as defined in eq 4 the unconfined aquifer is homogeneous isotropic and bounded by two parallel canals at a distance of 40 m on each side the saturated hydraulic conductivity and the specific yield are kxx 0 5 m d 1 and µ d 0 1 respectively the uniform precipitation rate p 0 002 m d 1 is considered without evapotranspiration or pumping the water surface height in the two canals is 2 m based on the bottom boundary the change in the groundwater level in the unconfined aquifer within 100 days is calculated a cross sectional view of the unconfined aquifer is shown in fig 6 a the top and bottom sides are set as nonflux boundaries i e g 2 0 m3 d 1 and the left and right sides are set as constant head boundaries i e g 1 2 m a uniform rectangular mesh is used by both modflow and vcfvm in this case as shown in fig 6 b 3 6 case 5 application of vcfvm to a real world groundwater simulation to assess the accuracy and efficiency of the vcfvm in scenarios with complex conditions the model was applied to simulate the groundwater flow in longsheng irrigation district 107 26 46 107 29 20 e 40 50 13 40 52 19 n a well irrigation district of hetao irrigation district located in inner mongolia china as shown in fig 7 the area of longsheng irrigation district is 9 06 km2 including 5 29 km2 of farmland there are 54 pumping wells in the district and the irrigation water in the plant growth period from may to september and the leaching water in the nongrowth period november come from these pumping wells there are seven observation wells established in the district indicated as o1 to o7 to observe the groundwater level the locations of pumping wells and observation wells are shown in fig 7 in this district the irrigation quota in the plant growth period is 294 mm and quota for autumn leaching is 180 mm the shallow aquifer in this area is dominated by clayey sand silty sand and clay and the lower part is dominated by silty fine sand and medium fine sand the average aquifer thickness is 136 m for numerical simulation the aquifer was divided into one unconfined layer in the vertical direction with a thickness of 136 m the specific yield of the aquifer was set as 0 04 and the horizontal hydraulic conductivity was set as 9 26 m d according to previous references yang et al 2021 there are lateral recharges from the surrounding areas and the recharge fluxes rb in each stress period were validated based on observed values as given in table 2 the simulation temporal domain lasted from may to november 2018 the stress period was 30 d and the time step was 1 d the point sources and sinks in the district mainly come from pumping wells the corresponding total pumping flux in each stress period was obtained according to the irrigation quota or leaching quota and the total flux was averaged over 54 wells the calculated pumping flux of each well was 261 m3 d from may to september and 622 m3 d in november the nonpoint sources and sinks in the district included precipitation irrigation and phreatic evaporation the precipitation rate p and pan evaporation rate in 2018 were from the data recorded by the linhe weather station as given in table 2 the precipitation recharge coefficient was set as 0 1 and the phreatic evaporation was calculated by eq 37 37 e k t e where e and e are the phreatic evaporation rate and pan evaporation rate respectively mm k is a conversion coefficient and is the ratio of natural water evaporation to pan evaporation which varies in different months t is the phreatic evaporation coefficient which is the ratio of phreatic evaporation at different groundwater table depths to the natural water evaporation the values of k and t were set according to the results of experiments at the bayan gaole test station and jiefangzha shahao canal yang et al 2021 respectively as given in table 2 and table 3 the critical groundwater table depth of phreatic evaporation was 4 m irrigation water was applied only on farmland the calculated irrigation recharge rate was 8 63 10 5 m d from may to september and 3 73 10 4 m d in november modflow 6 was also used here for comparison with the vcfvm the mesh in this case for modflow 6 was generated by gridgen exe lien et al 2015 which was provided on the website of modflow 6 the simulation region was divided into unified rectangular cells with a length of 35 5 m and a width of 39 6 m then the cells near the pumping wells were locally refined with a refinement ratio of 2 and the smoothing function provided by gridgen exe was run the mesh in this case for the vcfvm was generated based on a self written program to transfer the mesh generated by gridgen exe into the format required by the vcfvm the basic information for the meshes used in modflow 6 and the vcfvm is given in table 1 it should be noted that the numbers of vertices and cells were the same for modflow 6 and the vcfvm since the vcfvm mesh was generated based on the modflow 6 mesh 3 7 model evaluation indices to quantify the errors of vcfvm compared to the exact solutions in case 0 the relative error e2 zhang et al 2017 is used which is defined as 38 e 2 i 1 n c i f i y i 2 i 1 n c i y i 2 where fi is the simulated values of the vcfvm yi is the values of benchmark and n is the sample size the rate of convergence r α zhang et al 2017 is used to judge the accuracy of algorithm which is obtained by the following formula 39 r α log e 2 s 2 e 2 s 1 log s 2 s 1 where s 1 and s 2 are the element sizes of two meshes with successive resolutions for other cases to quantify the discrepancies between the simulated results of the vcfvm and modflow modflow 6 or the analytic solution two evaluation indices including the mean absolute error mae and the relative root mean square error rrmse are used as follows 40 m a e 1 n i 1 n f i y i 41 r r m s e i 1 n f i y i 2 n 1 n i 1 n y i 2 for case 0 the evaluation indices were calculated based on the values of all the vertices while for other cases the evaluation indices were calculated based on the values at several selected observation points which were distributed around the whole area but not close to wells or boundaries the coordinates of the observation points for different cases are given in table 4 in addition to the evaluation indices mentioned above the total cpu time and the water balance error eb are used as evaluation indices to evaluate the efficiency of the vcfvm in problems involving lgr meshes eb is defined as follows 42 e b i 0 n v μ c i h i t f h i 0 j 0 n b q j max i 0 n v μ c i h i t f h i 0 j 0 n b q j 100 where nv and nb are the numbers of vertices and boundaries respectively μ refers to μd for a confined aquifer or μe for an unconfined aquifer q is the total flux at the boundary outflow is positive and inflow is negative the subscripts i and j refer to the codes of vertices and boundaries respectively and the superscripts 0 and tf refer to the initial and final time levels respectively 4 results and discussion 4 1 accuracy of the vcfvm in conventional groundwater simulations the accuracy of the vcfvm for problems involving highly heterogeneous aquifer with full tensor transmissivity is demonstrated based on the case 0 and the accuracy of the vcfvm for problems with confined aquifers is demonstrated based on cases 1 and 3 by using different kinds of meshes and the accuracy of the vcfvm for problems with unconfined aquifers and nonpoint source sink terms is demonstrated based on test cases 2 and 4 respectively the relative errors e 2 of the vcfvm in case 0 on each mesh and refined level compared to the exact value are calculated and given in table 5 it can be found that the vcfvm yields the exact solution within 12 decimal places on m0 1 for all refined levels and for other more challenging meshes e g m0 2 to m0 6 the accuracy of the vcfvm increase with the increasement of the refined level and can yield the exact solution within 4 decimal places when the refined levels reach 5 the high accuracy of the vcfvm in case 0 demonstrates the accuracy of the vcfvm in simulating cases involving highly heterogeneous aquifer with full tensor transmissivity moreover the rates of convergence r α are calculated for all families of meshes used in case 0 except for m0 1 the r α for m0 1 is not calculated since the accuracy of the vcfvm on m0 1 is already close to the machine precision so that r α is meaningless for this mesh the r α given in table 5 indicate the vcfvm has a second order spatial accuracy as introduced in section 2 2 the hydraulic heads at 20 d in the simulation domain and in the observation profile located at x 500 m calculated by modflow and the vcfvm using the different mesh schemes illustrated in fig 4 b d for case 1 are shown in fig 8 and the results for case 3 using the mesh schemes illustrated in fig 5 b d are shown in fig 9 the observation profile used in case 3 located at x 250 m the corresponding values of the evaluation indices are given in table 5 for case 1 fig 8 shows that the hydraulic heads in the simulation domain and observation profile obtained by the vcfvm using the meshes of different shapes are consistent with those produced by modflow as shown in table 6 the maes for the different mesh schemes in case 1 are 0 34 m 0 33 m and 0 41 m and the corresponding rrmses are 0 48 0 43 and 0 61 the discrepancies between the results obtained by modflow and the vcfvm using meshes with different kinds of shapes are within acceptable range for case 3 fig 9 shows that the hydraulic heads in the simulation domain and observation profile obtained by the vcfvm using the meshes of different shapes are consistent with those produced by modflow as shown in table 6 the maes for different kinds of meshes in case 3 are smaller than 0 23 m and the corresponding rrmses are smaller than 0 28 the results of case 1 and case 3 demonstrate the accuracy of the vcfvm in confined aquifer problems using meshes with different shapes the hydraulic heads at 20 d in the simulation domain and in the observation profile located at x 500 m calculated by modflow and the vcfvm using different mesh schemes illustrated in fig 4 b d for case 2 are shown in fig 10 the corresponding hydraulic heads at the eight observation points and the values of the evaluation indices are given in table 6 the maes for different mesh schemes in case 2 are 0 07 m 0 05 m and 0 07 m and the corresponding rrmses are 0 11 0 07 and 0 11 which demonstrate the accuracy of the vcfvm in unconfined aquifer cases to assess the accuracy of the vcfvm in dealing with the nonpoint source sink terms an analytical solution is obtained for case 4 when the groundwater reaches a steady state the relationship between the groundwater level and the distance to the left canal can be expressed as follows 43 h x 2 h 1 2 h 2 2 h 1 2 l x p k l x x 2 where l is the distance between the two canals l and h 1 and h 2 are the water levels in the left and right canals respectively l the groundwater level at steady state obtained by the vcfvm is compared to the analytical solution and the results of modflow as shown in fig 11 notably the vcfvm simulated values are slightly lower than those based on the analytical solution and higher than those of modflow but all values are close to each other the mae values between the vcfvm result and the analytical solution the vcfvm result and modflow result are both 0 01 m indicating that the vcfvm can effectively deal with nonpoint source sink terms according to the results above the vcfvm has a second order spatial accuracy and can be accurately applied to problems involving confined aquifers unconfined aquifers heterogeneous and anisotropic aquifers and nonpoint source sink terms which account for the majority of problems considered in conventional groundwater simulation 4 2 ability of the vcfvm in dealing with nonmatching grids with different refinement ratios the ability to deal with nonmatching grids especially those with high refinement ratios is one of the main advantages of the vcfvm to demonstrate this the accuracy of the vcfvm for scenarios involving nonmatching grids with different refinement ratios is demonstrated by simulating case 1 using meshes m1 2 m1 4 m1 5 and m1 6 the results obtained by modflow using refined grids are used as benchmark the results of the vcfvm and modflow 6 using the same meshes are compared with those from modflow the comparison results of hydraulic heads at 20 d in observation profile located at x 500 m simulated by modflow the vcfvm and modflow 6 and also the discrepancies between results obtained by vcfvm or modflow 6 and modflow in the domain are shown in fig 12 the corresponding hydraulic heads at the eight observation points and the values of the evaluation indices are given in table 6 it can be found that the deviations between the results of vcfvm or modflow 6 and modflow increase with the larger refinement ratio as shown in fig 12 a d the discrepancies between the vcfvm and modflow are always lower than those between modflow 6 and modflow as shown in the fig 12 e l in particular the hydraulic heads obtained by modflow 6 using the m1 6 mesh exhibit a large difference compared to those of modflow as shown in fig 12 l table 6 shows that the maes of the vcfvm range from 0 33 to 0 66 m and the maes of modflow 6 range from 0 76 to 2 10 m additionally the rrmses of vcfvm range from 0 43 to 0 89 and those for modflow 6 range from 1 19 to 2 79 when the mesh with a refinement ratio of 1 6 m1 6 is used the error of modflow 6 is nearly twice that of other meshes and is three times greater than the error of the vcfvm it can be concluded that the vcfvm yields higher accuracy in cases with nonmatching grids especially when the refinement ratio is high in other words the vcfvm exhibits very high accuracy for those control volumes with convex angles 4 3 performance of the vcfvm in a real world case the accuracy of the vcfvm in a real world case with multiple pumping wells is demonstrated by test case 5 the simulated groundwater levels of the vcfvm and modflow 6 in simulation domain on june 1st september 1st and december 1st are shown in fig 13 and the simulated and observed groundwater levels along time at each observation well as well as the averaged groundwater level among all observation wells are shown in fig 14 the corresponding evaluation indices are given in table 7 it should be noted that the groundwater table depth instead of the groundwater level is used here to obtain the rrmses of the vcfvm and modflow 6 as shown in fig 13 as expected the groundwater level in the simulated domain gets deeper from june to september due to the water pumping for irrigation and get recovered from september to december due to lateral recharge from adjacent areas with autumn irrigation moreover the simulated groundwater levels in the domain obtained by the vcfvm are consistent with those of modflow 6 at corresponding time according to fig 14 slight differences between the results from the vcfvm and modflow 6 are observed in single well observations as shown in fig 14 a g while the average values of the vcfvm are close to those of modflow 6 as shown in fig 14 h and both sets of results from the vcfvm and modflow 6 are similar to the observed values as shown in table 7 the maes of the vcfvm range from 0 25 to 0 51 m at different observation wells and the values of modflow 6 range from 0 25 to 0 47 m the average values of mae for both the vcfvm and modflow 6 are 0 35 m the rrmses of the vcfvm at different observation wells range from 8 32 to 19 90 with an average value of 12 38 and those of modflow 6 range from 8 23 to 16 86 with an average value of 12 69 it can be concluded from this case that the vcfvm has good performance under complex practical conditions as indicated by comparing the simulation results to results from modflow 6 and the observed data 4 4 efficiency of the vcfvm in dealing with lgr meshes the computational efficiency of the vcfvm was compared with the efficiency of modflow modflow 6 using the results from case 1 and case 5 the cpu time and eb for case 1 and case 5 using different mesh schemes are given in table 8 for case 1 the total cpu time for modflow is 7 02 s and it takes 2 04 s 1 91 s 1 55 s and 1 76 s for the vcfvm to run in the four mesh schemes m1 2 m1 4 m1 5 and m1 6 respectively and 2 71 s 2 25 s 2 17 s and 1 91 s for modflow 6 with the corresponding schemes the eb of modflow is 0 021 and it is nearly 0 000 for both the vcfvm and modflow 6 for all mesh schemes for test case 5 the total cpu time of the vcfvm and modflow 6 are 1563 s and 1550 s for the same mesh scheme respectively the eb of the vcfvm is 0 03 and that of modflow 6 is 0 02 it can be concluded that both the vcfvm and modflow 6 have advantages in saving computational time and conserving the mass balance the cpu time of modflow 6 is slightly shorter than that of the vcfvm in test case 5 mainly because the advanced linearization scheme specifically the newton raphson method langevin et al 2017 is adopted to deal with unconfined aquifer conditions which can be further improved in our developed model 5 conclusions in this paper a numerical groundwater model based on the vcfvm is proposed all unknowns to be solved are associated with vertices and the control volume could be defined for each vertex including the nonmatching vertices then the hydraulic head in the whole simulation area can be obtained by solving the matrix equations without additional treatment at the nonmatching vertices the accuracy and performance of the algorithm were tested based on several cases and the major conclusions can be made as follows 1 the vcfvm can obtain accurate hydraulic heads with negligible mass balance errors using different arbitrary polygonal grids in confined and unconfined aquifers involving heterogeneous anisotropic transmissivities and nonpoint source sink terms 2 the vcfvm can simulate groundwater problems using meshes with high refinement ratios with high accuracy 3 the vcfvm exhibits high efficiency in dealing with nonmatching grids with high refinement ratios and performs well in mass balance due to local conservation of the numerical flux 4 the current version of vcfvm is a 2 d model and the extension of the model to 3 d must be further studied since a simple linearization scheme is used by the vcfvm to solve unconfined aquifer problems the adoption of more efficient methods such as the newton raphson method remains to be further explored credit authorship contribution statement yingzhi qian validation writing original draft yan zhu conceptualization methodology writing review editing xiaoping zhang conceptualization methodology writing review editing jiming wu methodology ming ye writing review editing wei mao writing review editing jingwei wu funding acquisition jiesheng huang funding acquisition supervision jinzhong yang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the study was partially supported by the national key research and development program of china 2021yfd1900805 02 and national natural science foundation of china through grants 51790533 52179041 yingzhi qian was sponsored the china scholarship council no 202106270106 supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2023 104392 appendix supplementary materials image application 1 
46,characterizing and modeling the pore structure is the key to simulating single and multiphase flow through granular soils modeling the grain based packing and predicting the multiphase flow properties of granular soils with a wide grain size distribution gsd spanning over several orders of magnitude is still a challenging task this work presents a novel numerical framework for constructing the pore network of granular soils with a wide grain size variation the present work focuses on using basic properties of granular soils like gsd and porosity to generate pore network properties that are further utilized to simulate the water retention properties of granular soils along drying and wetting paths a topologically equivalent network of pores and throats is extracted from modeled soil packing at different length scales by integrating the pore networks extracted from individual length scales in the main simulating domain a multiscale pore network that represents the pore structure of the soil to be modeled is obtained the pore scale phenomena like piston like advance corner flow wetting layers pore body filling and snap off are used to model fluid displacements at the pore scale the estimated soil water retention curves for various granular soils are in good agreement with experimental data from the literature and the hysteretic wetting drying response is also accurately predicted keywords soil water retention curve discrete element method unsaturated soils pore network modeling grain size distribution data availability no data was used for the research described in the article 1 introduction a deep understanding of multiphase flow in porous media and determination of macroscopic properties like capillary pressure saturation curves and relative permeability functions play an essential role in many fields such as hydrogeology reservoir engineering radioactive waste disposal and implementing unsaturated soil mechanics into engineering practice joekar niasar and hassanizadeh 2012 xiong et al 2016 there has been a continued emphasis on developing indirect methods for predicting these macroscopic properties from more readily measurable material characteristics due to the high cost and time consuming nature of the experiments lu and likos 2004 pore scale modeling methods are a powerful tool to predict these quantities and improve our descriptions of multiphase flow and transport processes the governing equations are formulated at the scale of the individual solid particles and hence require a detailed understanding of the physical processes that occur at the pore scale and a thorough description of the morphology of the pore space pore scale methods involve either direct numerical approximation of the navier stokes equations or pore network modeling pnm sheng and thompson 2016 direct numerical simulation approaches simulate multiphase flows inside pores with great precision but they are often computationally costly and can only address limited pore volumes shi et al 2021 li et al 2018 pore network idealization on the other hand is computationally efficient enabling larger domains to be simulated the pore network is composed of geometrically idealized elements pores and throats that approximate the 3 d pore space while preserving its topology wide void spaces are represented by pores connected by narrower regions called throats multiphase flow is then simulated in the network and macroscopic characteristics are estimated using criteria for identifying fluid configurations and suitable flow and transport equations fatt 1956 introduced pnm and since then two phase flow using pnm has been investigated by several researchers fatt 1956 drew an analogy between a random resistor network and flow in porous media to produce the capillary pressure saturation curves of primary drainage and relative permeability curves subsequently the pore network models have evolved enormously and are now frequently used to simulate a wide range of physical and chemical processes balhoff and wheeler 2009 blunt et al 2002 lopez et al 2003 ryazanov et al 2009 wang et al 2021 the reliability of pnm is heavily dependent on how well the pore space of a given porous media corresponds to the constructed pore network as its representation several studies have shown that an accurate description of the morphology of porous media in terms of geometric properties such as the distributions of sizes and shapes of pores and throats pore throat correlations and network topology parameters such as connectivity or coordination number and coordination number distribution are critical for realistic predictions xiong et al 2016 several approaches have been developed to construct a pore network representation of porous media high resolution microtomography images of a porous material are used for its 3 d reconstruction network extraction algorithms like maximal ball algorithms al kharusi and blunt 2007 and the medial axis algorithms lindquist et al 2000 are then availed to generate the pore network mapping the actual pore space statistical methods can also be utilized to construct the 3 d representations of the pore space using a high resolution 2 d image obtained from scanning electron microscopy okabe and blunt 2004 however the imaging approach for obtaining the pore network is expensive computationally difficult and not widely available daneshian et al 2021 as a result advanced techniques like micro computed tomography imaging to obtain a pore network are neither practical nor viable for forecasting capillary pressure saturation curves and relative permeability functions of granular soils for diverse field applications another alternate method is to numerically represent the porous material by generating the grain packing then extracting the pore network from it bryant and blunt 1992 pioneered the use of grain based models equal sized spheres are used to generate sandstone models by numerically modeling the geological process involved in its formation the pore network is extracted using image analysis techniques on the packing of spheres to obtain capillary pressure saturation and relative permeability curves mehlhorn et al 2008 modeled granular soils using an idealized grain structure consisting of spheres for a given grain size distribution gsd and porosity using geometric gravity based criteria where the spheres used to model the grain structure had to be mechanically stable and must not overlap each other and the bounding box of the modeled volume an algorithm is developed to create a grain structure model tong et al 2012 used the discrete element method dem to model granular materials as an assembly of spherical particles and proposed a procedure to generate numerical samples matching experimental particle size distribution and porosity for glass beads the pore network is extracted using the regular triangulation method from the assembly created continuing the same line of investigation mahmoodlu et al 2016 coupled discrete element and pore network modeling to study the effects of compaction and particle mixing processes on pore structure intrinsic permeability and soil water retention capacity of sand sweijen et al 2017 matched the gsd and porosity values of the granular soils to generate packings of spheres and then simulated capillary pressure saturation curves for drainage mufti and das 2022 have shown that coupled dem and pnm approach can successfully model the unsaturated hydraulic conductivity of granular soils which is an indispensable input data for many engineering problems involving water flow through unsaturated soils seminal work using this approach has been carried out by yuan et al 2016 nikooee et al 2017 sweijen et al 2016 and mahmoodlu et al 2018 thus the numerical framework of simulating soil water retention curves swrc and unsaturated hydraulic conductivity of granular soils by modeling the grain and pore structure is a promising approach given the simplicity of the model in terms of experimental data needed however this approach has been limited to uniformly graded granular soils with the gsd that spans less than one order of magnitude recent works to obtain swrc using dem and pnm are limited to narrow gsd with a size ratio ratio of the largest size of the particle to smallest size less than 10 tong et al 2012 mahmoodlu et al 2016 yuan et al 2016 nikooee et al 2017 sweijen et al 2016 2017 mahmoodlu et al 2018 these limitations arise from a combination of inherent and computational restrictions in the most critical step involved in this approach namely the creation of packings to represent granular soils however granular soils can span orders of magnitude in size with a size ratio as high as 1 0 3 coarse sand to silt size fig 1 generation of synthetic samples with particle size distribution ranging over several orders of magnitude is a long standing issue berger and hrenya 2014 this work presents a novel methodology for the numerical construction of the pore network of granular soils with a wide gsd multiscale pore spaces characterize systems with a broad gsd and considering only a single length of pore sizes and spatial connectivity is not sufficient for the realistic representation of the pore structure therefore multiscale pore network models containing information from each length scale must be constructed for soils with the gsd of several orders in this approach soil packing at different length scales is first constructed and a topologically equivalent network of pores and throats is extracted from the modeled soil packing corresponding to each length scale the multiscale pore network which represents the pore structure of the soil to be modeled is then obtained by integrating extracted pore networks from each length scale in the main simulating domain this multiscale network construction aims to derive accurate predictions of multiphase flow properties for soils with gsd varying over several orders of magnitude the paper is organized into five sections including this introductory note section 2 details the limitations involved in the generation of packings to represent granular soils and network extraction techniques a detailed description of the proposed methodology for the construction of multiscale pore networks for soils with wide gsd is presented in section 3 the constructed pore network models are used to simulate swrcs for various granular soils and the simulated swrcs are compared with the experimental values from the literature in section 4 the conclusions arrived at have been presented in section 5 2 theoretical background in a broad sense random sphere packings to model granular materials are constructed via dynamic or geometric approaches major geometric algorithms are sequential addition models and collective rearrangement models al raoush and alsaleh 2007 in sequential addition models one sphere is added at a time to an existing cluster of spheres at a stable position whereby it is in contact with two additional spheres this algorithm cannot control the packing density and the final packings may not be homogeneous matheson 1974 al raoush and alsaleh 2007 in collective arrangement models spheres are randomly placed in a domain and iterative relaxation techniques molecular dynamics and monte carlo simulations are used to separate the overlapping spheres until a stable configuration with a certain overlap tolerance is achieved this technique however may produce a packing in which the particles are not in perfect touch resulting in an unrealistic contact network and coordination number distribution jodrey and tory 1985 the dynamic approach is dem based method and is more commonly used for preparing numerical samples for granular materials like cohesionless soils cundall and strack 1979 it is a lagrangian technique where each particle of the material is represented by a sphere characterized by its mass radius and moment of inertia and then tracked via a force balance despite the fact that dem can generate any desired randomly packed structure in any density range it is not able to simulate realistically wide size distributions berger and hrenya 2014 roozbahani et al 2017 as the polydispersity of the particle size distribution increases the number of particles to achieve that packing increases with a decrease in the time step required for accurate resolution of particle contact it results in increased computational cost along with the increase in the parallelization cost rendering wide particle size distributions impractical to simulate berger and hrenya 2014 compared the number of particles required to simulate a polydisperse particle size distributions to a representative monodisperse system and found that for continuous distribution number of particles increases substantially with the width of the distribution ratio of the standard deviation of the particle sizes to their arithmetic mean there is a 100 fold increase in the number of particles for log normal distributions with a 200 width compared to monodisperse systems the gsd of soils is generally fitted using log normal distribution fredlund et al 2000 thus for the gsd in fig 1 with a width ranging from 115 to 215 the number of particles required will be extensive in comparison with their monodisperse counterpart additionally the time step which is set by the size of the smallest particle decreases as the width of a continuous distribution increases based on the findings of berger and hrenya 2014 for a log normal distribution with a moderate width of 50 the time step drops at least an order of magnitude compared to its corresponding monodisperse systems the increase in the number of particles and decrease in the time step directly influence the simulation time further the increase in distribution width is associated with an increase in parallelization cost domain decomposition is the most common method for parallelizing dem algorithms pöschel and schwager 2005 this method decomposes the region into sub regions and each processor is responsible for one or more of the sub regions a shared volume is defined which is the region immediately outside the boundaries of the sub region fig 2 shows 9 sub regions and the associated shared volume with the central sub region the computational and communication costs associated with the particles in shared volume encompass the parallelization cost a wider distribution width increases the cost of parallelization by increasing the number of particles in the shared volume as well as increasing the number of particles within a sub region therefore generating a synthetic sample for granular soils with a wide gsd as illustrated in fig 1 is not feasible with dem upon modeling the grain packing of the soils the next step involves extracting the geometry of the pore structure followed by simulating two phase flow in the pore network an essential mechanism of corner flow wetting layer is either neglected in flow simulations for obtaining swrc yuan et al 2016 sweijen et al 2017 or the geometry of the pore space is oversimplified to be represented by spheres and cylinders circular cross sections that fail to model the wetting layers rostami et al 2015 daneshian et al 2021 during drainage when the non wetting phase invades the pore space of a porous medium the wetting phase is retained in the corners and crevices called the wetting layer micromodel tests have demonstrated this phenomenon lenormand et al 1983 despite only a few microns in thickness wetting layers are of crucial importance since they ensure low residual wetting phase saturation by preventing the wetting phase from being trapped blunt et al 2002 valvatne and blunt 2004 a study by dullien et al 1989 demonstrated that residual saturation of the wetting phase in rough glass beads micron scale roughness as observed from sem images drops to as low as 1 of void space due to wetting layers while residual saturation in smooth glass beads is 10 the simplification of not modeling the wetting layers and thus ignoring the double occupancy of a pore or throat by both water and air in granular soils results in overestimating residual saturation sweijen et al 2017 and deviation of predicted unsaturated hydraulic conductivities at high suction values mufti and das 2022 these concerns are circumvented through a novel methodology presented in this work for the construction of pore network models for soils with a gsd of several orders 3 methodology the outline of the methodology for the numerical construction of the multiscale pore network model for granular soils using only gsd and porosity information is as follows first soil packing at different length scales is constructed and the pore network is extracted from the modeled soil packing then the extracted pore networks are integrated into the same domain such that the packing porosity and grain size distribution of the original soil sample to be modeled is retained multiscale pore network models are obtained by repetition of this method finally two phase flow simulations are carried out to simulate swrcs fig 3 3 1 generating synthetic soil samples the macro behavior of granular soils is highly influenced by their particle arrangement and thus the geometrical modeling of granular structures represents a crucial step in the pore scale simulations usually a sample of a granular structure is represented by a regular geometric domain parallelepiped containing soil grains modeled by spherical particles in this study dem is used to generate granular soil samples a discrete element approach is a numerical method that simulates the response of granular materials by considering the individual particles and their interactions cundall and strack 1979 modeling of non cohesive granular soils have been carried out by dem extensively and the procedure can be divided into two stages initially the geometry of the system to be analyzed including the boundary conditions loading conditions and the material properties stiffness and friction coefficient are specified the contacting particles are identified at each time step and the magnitude of the inter particle forces proportional to the distance between them is calculated in the second stage particle positions and orientations are updated newton s second law is used to determine the resulting acceleration which is then time integrated to find the new positions for each particle while dem may create any randomly packed structure in a predetermined density range it is still challenging to simulate wide grain size ranges thus for the numerical construction of the multiscale pore network models for soils following wide gsd synthetic soil samples corresponding to different length scales are first obtained the gsd and porosity representing the packing of the soil samples to be modeled are referred to as target grain size distribution g s d t and target porosity n t respectively the framework to model synthetic soil samples is as follows 1 the g s d t is divided into m intervals such that each successive interval approximately differs from the preceding interval by an order of one in the grain sizes dem can successfully simulate spherical packing with particle sizes spanning an order of magnitude berger and hrenya 2014 sweijen et al 2016 2 for each interval i i 1 m representing a different length scale an assembly of spheres packed to attain a predefined grain size distribution and porosity needs to be generated the coarsest grains are present in the first interval followed by fine grains in the succeeding intervals and finally the finest in the last interval 3 the synthetic soil sample obtained from the interval 1 coarsest grains represents the nesting or integrating domain ω 1 the assemblies of spheres corresponding to fine grains are of smaller size compared to the size of ω 1 and are eventually integrated in ω 1 4 for an interval i i 1 m the weight fraction of different sized particles is obtained from the g s d t and gsd corresponding to the interval i is acquired which is then used to model synthetic soil samples ω i i 1 m if w p is the weight of the particular soil size in interval i then while determining the gsd of this interval the corresponding weight fraction is given as a ratio of w p and w i w i is the total weight of soil in interval i for sample 1 fig 1 the gsd roughly spans over three orders of magnitude thus the gsd is divided into 3 intervals the interval 1 corresponds to grain size diameter greater than 0 1mm interval 2 has a grain size in the range of 0 01mm to 0 1mm similarly grains with a diameter less than 0 01mm are in interval 3 the gsd of each interval is shown in fig 4 a 5 the packing density is equally required for geometric modeling of granular soils along with particle size distribution packing density is given by the ratio of void volume in a domain to the total volume of the domain also known as porosity hence porosity is the second parameter required to acquire an assembly of spheres in each domain for fine domain ω i i 2 m the value of porosity used to attain the packing of spheres is the same as the target porosity n t in the integrating domain ω 1 the addition of fine domains ω i i 2 m will reduce the porosity value of ω 1 thus to attain a final domain that is representative of the granular soils to be modeled the packing of coarse spheres in ω 1 is achieved at a porosity value n 1 greater than n t let w i and v i be the weight and volume of soil grains in any interval i then 1 w 1 w i v 1 v i k i i 2 m i 2 m v i will lead to a decrease in the porosity of ω 1 correspondingly the value of porosity n 1 can be calculated using 2 n t n 1 1 n 1 i 2 m 1 k i where n t is the target porosity given and k i can be determined from g s d t the synthetic soil samples for each interval are constructed after obtaining the particle size distribution and packing density in this study the dem implementations are carried out in p f c 3 d itasca 2019 many open source dem software packages can also be availed for modeling synthetic soil samples šmilauer et al 2010 particle interactions are modeled using a soft contact approach allowing for overlaps at the point of contact at a given contact point the constitutive model consists of a stiffness model which establishes an elastic relation between the contact force and relative displacement and a slip model which involves a relationship between normal and shear contact forces allowing the two contacting balls to slip relative to one another following the detection of these contacts the normal f n and tangential f t contact forces are calculated at each incremental time step and granular packings are simulated using the hertz mindlin model 3 f n k n δ n 4 f t k t δ t where k n is the contact normal secant stiffness k t is contact shear stiffness δ n and δ t are the normal and tangential cumulative shear displacements the stiffness coefficients are be expressed as 5 k n 2 g 2 r 3 1 ν δ n 6 k t 6 g 2 1 ν r 1 3 2 ν f n 1 3 where g is the elastic shear modulus ν is the poisson s ratio and r is the harmonic mean of the radius of two spheres in contact in order to detect slip the contact is checked for tangential forces exceeding the maximum allowable shear contact forces f m a x s determined by mohr coulomb criteria for static friction 7 f m a x s f n tan ϕ where ϕ is the coefficient of static friction the synthetic soil sample for each interval is created within a cubic domain the size of which is determined by the gsd of that interval initially the spherical particles are generated in a cube 10 20 times the maximum particle diameter to remove possible inhomogeneity in particle packings li et al 2021 the container walls force the spherical particles to arrange themselves in an orderly form near the boundary the ordered particles close to walls affect the immediately adjacent particles and the effect abates by moving away from the container wall koval et al 2015 this ordered packed structure creates high porous regions and to mitigate these boundary effects a representative element volume r e v is extracted from the sample s interior the rev calculation for soil sample 1 having gsd given in fig 1 and porosity 0 44 table 1 is shown in fig 5 the variation in porosity with packings of various sizes for each domain is shown in fig 5 where l d m refers to the ratio of the size of the cube l to mean particle diameter d m after an initial fluctuation porosity settles down to a constant value when size of the cubic domain is greater than 15 times the mean particle diameter which lies within the range determined in previous studies wiacek and molenda 2016 thus rev obtained from the interior of the sample is generally 15 20 times the mean particle diameter when creating a representative assembly of spheres particles overlap and large contact forces are encountered as a result the algorithm is permitted to continue until the imbalanced force ratio falls within the given tolerance level of 0 001 in order to achieve static equilibrium li et al 2021 table 2 lists the dem model parameters synthetic soil samples corresponding to various intervals for sample 1 are shown in fig 6 and the gsds are compared in fig 4 b 3 2 multiscale network construction the generation of synthetic samples corresponding to different intervals is followed by the pore network extraction fig 6 pore network extraction deals with the discretization of the void space of the porous media into pores representing wider regions connected via narrower restrictions called throats several attempts have been made to develop algorithms for extracting pore networks from generic and arbitrary 3 d images of porous media the most notable of which are the medial axis based and the maximum ball techniques the network extraction approach proposed by raeini et al 2017 is used in this study to extract a topologically analogous network of pores and throats from images of synthetic soil specimens in this algorithm the topology of the underlying image is retained by maintaining the topology of the medial surface during the pore network extraction this algorithm extracts pore network from 3 d binary images of porous media a binarized 3 d image of a 3 d synthetic soil specimen modeled in pfc is thus generated by assigning a value of one to each voxel representing soil grains and a value of zero to those representing void space the 3 d images have 1000 1000 1000 voxels with voxel sizes ranging from 0 07µm to 10µm in different intervals for different reference materials used for validation apart from an unstructured and irregular pore network which is a more realistic representation of porous materials like soils an essential feature of the network extraction approach used is that the irregularities in the pore space are captured by assigning different geometrical shapes to pores and throats an element s geometric shape is governed by its shape factor defined as the ratio of its cross sectional area to the perimeter square an element is modeled as a circular square or scalene triangular cross section such that the shape of the cross section of the element has the same shape factor as the actual cross section of the pore space the shape factor of a circle is 1 4 π while that of a square is 1 16 the shape factor of triangles varies from zero for a slit shaped triangle to 3 36 for an equilateral triangle modeling wetting layers is not possible in pore networks with circular cross sectional elements as they cannot retain wetting layers contrary to this the network model used in this study can incorporate wetting layers due to the presence of angular pores and throats triangular or square cross section the network extraction algorithm provides the values of the geometric properties such as radius shape factor volume and length of individual network elements once the pore networks n e t ω i i 1 m corresponding to each interval is extracted the next step that follows is the multiscale pore network construction the multiscale pore network n e t f i n a l is assumed to be representative of the pore space of the actual soil to be modeled and two phase flow simulations are carried out in this pore network fig 7 for the construction of a multi scale pore network the networks extracted from fine domains n e t f n e t ω i i 2 m are placed in the nesting network n e t ω 1 three aspects of the multiscale pore network formulation come into play the number of fine networks x i that should be added from each interval their positioning in the nesting network and finally the inter network connections 8 n e t ω 1 x i n e t ω i i 2 m n e t f i n a l the underlying principle followed by all authors while constructing a pore network for uniformly graded soils is that the grain based assembly used for geometric modeling of soil samples has the same gsd and packing porosity as that of the soil sample the same principle is used for multiscale pore network construction consequently the number of fine pore networks placed in the nesting pore network which is equivalent to the number of fine domains added in the nesting domain should be such that the particle size distribution of the final domain matches that of the modeled soil sample the number of fine networks from each interval x i is calculated using the following equation 9 w 1 w i w ω 1 x i w ω i i 2 m where w ω i is the weight of solids in any domain i following the determination of the number of fine networks from each interval the next step is to integrate the networks into the nesting network n e t ω 1 the integration process starts by placing x 2 number of n e t ω 2 in the pores of n e t ω 1 the networks are placed randomly in the pores of the n e t ω 1 without any spatial correlation a pore in n e t ω 1 is randomly selected and the number of fine networks placed is such that the pore is completely replaced with the fine networks once x 2 number of n e t ω 2 are placed in the nesting domain the n e t ω 1 is updated and the updated n e t ω 1 has pores and throats from ω 1 as well as ω 2 then the pores of the updated n e t ω 1 are similarly filled with x 3 number of n e t ω 3 the process continues until all the fine networks are integrated into the nesting network it is discussed in more detail in section 3 3 the final step in multiscale network construction is to provide connectivity between networks corresponding to different intervals for original fine networks the inter pore distance distribution and maximum inter pore distance is calculated the inter pore distance for two pores p 1 and p 2 approximated as spheres with respective inscribed radii r 1 and r 2 connected by a throat is defined as 10 d p 1 p 2 d e p 1 p 2 r 1 r 2 where d p 1 p 2 is the inter pore distance and d e p 1 p 2 is the euclidean distance between the two pore centers once a fine network n e t f is placed in the pore of a coarser network all the boundary pores of the fine network are identified and linked with the neighboring pores of n e t ω 1 and pores of other fine networks the procedure followed to connect pores from different networks and establish inter network connectivity is as follows for a given boundary pore p f of the fine network the set s n of all neighboring pores p n of other networks is identified such that the inter pore distance d p f p n between them is less than the maximum inter pore distance of n e t f the length of the throats in n e t f is already provided by the network extraction algorithm this information is used to find the average throat length l t a v g of the throats already linked to the boundary pore p f the neighboring pore p n from s n for which the inter pore distance d p f p n matches the average throat length l t a v g most closely is selected the pores p f and p n are then linked together with a throat the schematic representation of the procedure is shown in fig 8 a throat is described by its properties like radius volume shape factor and length while the length of the throat connecting p f and p n is the inter pore distance between them the other properties are obtained from the statistical information of the already connected throats to p f 11 t t h r o a t 1 j j 1 j t j where t t h r o a t is the property radius volume shape factor assigned to the new throat t j is the value of that property for the already connected throats and j represents the total number of throats linked to the pore p f in the original fine network the adopted network integration scheme considers connections between fine networks and the coarsest network as well as between fine networks from different intervals 3 3 computational aspects the difference between the length scales of the integrating domain and other fine domains is such that a very large number of fine domains are needed to obtain a final domain with gsd same as g s d t taking as an example sample 1 properties given in table 1 table 3 lists the major properties of the extracted networks corresponding to different intervals for one realization clearly the final network will contain a huge number of pores and throats for simulating the quasi static two phase flow in the pore network the algorithm discussed in section 3 4 has a time complexity of o n n 1 n represents the number of capillary pressure increments discussed in section 3 4 and n 1 the number of elements of a pore network consequently flow simulations become computationally very intensive due to the large number of elements in the pore network to circumvent this issue following procedure has been adopted as part of the construction of a multiscale pore network the fine networks are inserted in the pores of the coarser networks the selection of the pore is made randomly and it is entirely filled with m number of networks from an interval i i 2 m where m is the ratio of the volume of the pore to be filled and volume of the fine network that has to be placed in order to facilitate computation for a pore to be replaced with m number of fine networks only one fine network is placed in it and its volume contribution is assigned as m times further to get realistic lengths of the inter network throats the boundary pores of the fine network are placed on the periphery of the pore to be replaced the number of elements of a pore network can further be reduced without significantly jeopardizing the pore structure and two phase flow properties by diluting the individual networks n e t ω i i 1 m of different domains before integrating them into the final domain dilution of a network here refers to the random deletion of some pores and their connected throats the volume of the deleted pores and throats is equally added to the remaining network elements without altering their radii fig 9 shows the effect of dilution on the simulated swrc for one pore network corresponding to ω 1 of sample 1 for deletion of up to 20 20 of the pores and the connected throats are removed no significant variation in the simulated swrcs is seen the root mean square error of 0 01 is observed in the degree of saturation when the 20 deleted network is compared with the original network the same results were observed for other networks hence the individual networks are diluted up to 20 of pores are deleted before the construction of a multiscale network however the deletion strategy must be evaluated for other network extraction techniques before applying it to the network the impact of deletion on the simulations must also be examined before considering other multiphase flow processes these simplifications highly reduce the number of elements in the final network without any change in the porosity of the final domain thus decreasing the simulation time 3 4 modeling drying and wetting swrc for modeling the swrc the inlet boundary of the simulated domain is connected to an air reservoir and has a pressure p a i r the outlet boundary is connected to a water reservoir with a pressure p w a t e r under quasi static conditions the capillary pressure ψ is equal to the pressure difference between the two reservoirs 12 ψ p a i r p w a t e r for drainage drying simulations the network is initially completely saturated with water by increasing the air pressure while keeping the water pressure constant the capillary pressure of the network is gradually increased if the capillary pressure exceeds the entry pressure threshold capillary pressure of an element pores and throats and water is in pressure communication with the outlet air invades that element the threshold capillary pressure ψ t h of an element is determined from øren et al 1998 generalization of mayer and stowe princen method mayer and stowe 1965 princen 1969 13 ψ t h γ 1 2 π g f d cos θ r r 14 f d 1 1 4 g c cos 2 θ r 1 2 π g 15 c i 1 c cos θ r cos θ r β i sin β i π 2 θ r β i where γ is the surface tension of air water interface g is the shape factor of an element θ r is the receding drying contact angle and r is the inscribed radius of an element f d is a dimensionless correction factor that depends on contact angle and shape factor and is equal to 1 for circular cross sectional elements c is a function of corner half angles c is the number of corners of an element containing water in the form of wetting layers and β is the corner half angle of an element s cross section for triangular angles the corner half angles are computed using the approach suggested by patzek 2001 during displacement of one fluid phase by another if non invading fluid water in case of drying in any element or cluster of elements loses its connectivity with the outlet then it is trapped the capillary pressure of trapped water saturated elements does not change and they cannot be drained however wetting layers contribute to water connectivity and prevent water trapping during drainage since the network extraction technique used in this study yields elements with angular cross sections and circular ones the contribution of the wetting layer is not neglected as a result water filled elements can be trapped in drainage if they are surrounded only by circular elements filled with air as capillary pressure increments are made equilibrium air water interface positions within the network are determined trapping is checked and average saturation of the entire network s w n e t is calculated 16 s w n e t j s w j v j j v j where the sum runs over all the elements pores and throats in the final pore network s w j a w j a j s w j is water saturation of an element with area a j and volume v j a w j is the area of water present as arc menisci in the corners of a pore body or throat and is given by øren et al 1998 17 a w j r 2 i 1 n cos θ r cos θ r β i sin β i π 2 θ r β i where r γ ψ and ψ is the current capillary pressure of the network the modeling of drying swrc is followed by simulating wetting swrc wetting swrc which is of practical importance in many field problems like landslides due to precipitation the performance of hydraulic barriers irrigation norms etc is generally not measured in the laboratory due to the inherent long time involved in its measurement for imbibition wetting simulations the maximum capillary pressure achieved at the end of drainage is gradually reduced by increasing the water pressure and the processes with the highest capillary pressure are preferred the displacements in the imbibition process are controlled by piston like advance pore body filling and snap off lenormand et al 1983 øren et al 1998 patzek 2001 valvatne and blunt 2004 in the piston like filling of throats water entirely displaces air and this displacement process is exactly the opposite of drainage due to contact angle hysteresis the threshold capillary pressure is different from drainage threshold capillary pressure for the piston like advance is given by 18 ψ t h γ r a where r a is the radius of curvature of arc meniscus and patzek 2001 is followed to calculate r a in pore cooperative filling i n mechanisms the threshold capillary pressure depends on multiple factors including the pore shape and neighboring pinned interfaces the threshold capillary pressure for pore filling is expressed as blunt 1998 19 ψ t h 2 γ cos θ a r p γ i 1 c ω i x i where θ a is the advancing wetting contact angle r p is the radius of a pore x i is a random number between 0 and 1 and ω i is the coefficient approximately equal to the inverse of the average throat radius connected to pore r p snap off occurs when water layers in corners swell and when they meet the air water interface becomes unstable and the entire element gets spontaneously filled with water the threshold capillary pressure for snap off under various conditions is calculated following the work of valvatne and blunt 2004 snap off is an important mechanism responsible for air trapping during the wetting process modeling the phenomenon of air trapping is relevant to various applications like modeling precipitation propagation into the ground with subsequent effects on the groundwater table interpretation and modeling laboratory wetting tests and induced partial saturation technique to mitigate liquefaction risks scarfone and wheeler 2022 most pore network models describe pore space as cylinders and spheres omitting the role of wetting layers and the snap off process and thus failing to model air entrapment therefore for modeling air entrapment in the soils it is imperative to account for the angularity in the void spaces a depth first search dfs backtracking algorithm is used to find all the trapped elements each increment in water pressure therefore determines which elements can be infiltrated by water through the above discussed mechanisms and the network saturation is updated accordingly also in each step the algorithm checks the connectivity of fluid phases to respective reservoirs to account for trapping 4 results the proposed model is evaluated and assessed by selecting different granular soils from the literature the gsd for the chosen materials is shown in fig 1 and table 1 lists their main properties in order to study the model s suitability on different granular soils the soils samples chosen have different gsds from well graded to gap graded soils with the coefficient of uniformity varying from 17 to 227 the porosities range from 35 to 47 the granular soils chosen have not undergone volume change during drying or wetting the proposed methodology does not account for such volume changes and pore networks designed to address pore structure evolution with suction are required instead in addition to capillary forces adsorptive forces also contribute toward matric potential especially at residual suction tuller et al 1999 in granular soils it is largely the capillary effect that dominates and adsorption is relatively insignificant tuller et al 2004 thus the granular soils with non plastic fines except sample 4 are selected from the literature for air water flow simulations in the pore network the geometric characteristics of the network shape factor radius volume of elements and fluid flow properties surface tension receding and advancing contact angles are required the network extraction algorithm provides geometric characteristics of pores and throats on the other hand the fluid flow properties are well established for the air water system the surface tension value of the air water interface is taken as 0 073 n m contact angle the angle formed by two fluids on a solid surface at their interfaces is a significant determinant of the pore scale liquid distribution granular soils being a water wet system have near zero values of receding contact angle lu and likos 2004 rostami et al 2015 the value of the receding contact angle used in the simulation is 0 the advancing contact angle is known to be larger than the receding contact angle it can reach 60 to 80 for fine grain soils based on capillary rise and horizontal infiltration experiments kumar and malik 1990 found that the advancing contact angles differed for different soils ranging from 57 3 for soils with 11 fine content clays to 84 8 for soils with 85 fine content a study by laroussi and de backer 1979 found that glass beads have an advancing contact angle that is 20 to 30 degrees larger than the receding contact angle smaller values of advancing contact angles are used since the soil samples modeled in the current investigation are granular soils this study uses a uniform random distribution of advancing contact angles between 20 and 40 to forecast wetting swrc 4 1 model validation using granular soil with narrow gsd as stated in the introduction the numerical framework of using grain based modeling by integrating dem and pnm for simulating multiphase flow properties like swrc has been employed extensively for granular soils with narrow gsd size ratio less than 10 the proposed approach for constructing a multiscale pore network is applied to a narrow gsd and contrasted with the conventional method of obtaining pore networks in the conventional method a single synthetic sample with the same gsd and packing porosity as the soil to be modeled is used to extract the representative pore network the g s d t of the soil to be modeled is shown in fig 10 a and has a porosity of 47 1 for constructing the pore network in accordance with the suggested approach the g s d t is divided into two intervals and the pore networks extracted from each interval are then integrated to obtain the representative pore network n e t f i n a l when the entire g s d t is modeled as a single packing m 1 and when the g s d t is divided into two intervals m 2 the simulated swrc fig 10 b compares favorably with each other and the experimental data the range of radii of pores and throats in the representative pore networks is also the same in both approaches fig 10 c d the coefficient of determination r 2 and root mean squared error rmse is calculated to quantify the goodness of fit both simulated swrcs have an r 2 of 0 99 and the rmse is 0 04 for m 1 and 0 02 for m 2 consequently the n e t f i n a l produced using the suggested methodology successfully represents the geometric and topological characteristics of the void structure of granular soils before analyzing the prediction of swrc using the multiscale pore network construction approach for granular soils with a broad grain size distribution the effect of the number of intervals m in which the gsd of the soil to be modeled g s d t is divided is first investigated the g s d t for sample 1 is divided into varying intervals m 2 3 and 4 and a multiscale pore network is constructed for each case fig 11 displays the modeled gsd simulated swrc and size range of pores and throats from various domains in the final network when g s d t is partitioned into varying intervals using the conventional approach m 1 the gsd could not be generated in a single synthetic packing resulting in simulated swrc that differ markedly from experimental data for m 2 the g s d t is divided into two intervals at a grain size of 0 08mm but the algorithm fails to converge when modeling the synthetic packing corresponding to ω 2 i e grain sizes from 0 001mm to 0 08mm with a size ratio of 80 the synthetic packing for ω 2 is then generated by removing some fine grains in the second interval thus by dividing the g s d t of sample 1 spanning over three length scales into two intervals the final domain could not generate particle distribution consistent with g s d t the final domain also failed to achieve the target porosity as shown in fig 11 d the n e t f i n a l for m 2 lacks fine pores and throats while the size range of pores and throats is nearly the same when the g s d t is divided into 3 or 4 intervals the modeled gsd and simulated swrc replicate the experimental trend with good accuracy for m 3 and 4 however for m 2 the simulated swrc diverges from the experimental data and thus the resulting pore network does not accurately represent the void structure of sample 1 given that dem can effectively construct spherical packings with a size ratio of 10 g s d t is thus divided into intervals with a size ratio not greater than 10 to ensure that the modeled gsd of the final domain is consistent with g s d t since the gsd of the reference materials covers about three orders of magnitude they are divided into three intervals to obtain n e t f i n a l and the predicted swrcs are discussed in subsequent sections 4 2 well graded granular soils pore network simulations for every reference material are carried out on several realizations for sample 1 the predicted swrcs from different realizations are shown in fig 12 the results are reported as the average of various realizations sample 1 and sample 2 are well graded soils the network elements in the multiscale pore network for both the samples have radii ranging over four orders of magnitude the frequency distribution of the radius of pore network elements from each interval for sample 1 is shown in fig 11 e the final gsd after integrating fine domains in the nesting domain is shown in figs 13 a and 14 a the simulated swrc along the drying path from the proposed methodology is shown in figs 13 b and 14 b respectively for samples 1 and 2 r 2 of 0 99 is obtained with rmse of 0 028 and 0 025 respectively for swrc along the drying path illustrating the reasonable accuracy of the proposed mechanism and approach it is well established that swrc is hysteretic in nature i e wetting and drying swrc are different from each other hence for oppositely directed drying and wetting processes two different soil moisture content would correspond to the same suction value causing a hysteresis loop several potential causes of hysteresis in coarse grained soils include geometrical effects due to non uniformity in pore size distributions or the ink bottle effect contact angle hysteresis and entrapment of air lu and likos 2004 fredlund and rahardjo 1993 gan et al 2013 while the current paradigm of modeling soil pore space as a network of pores connected by throats takes into consideration the ink bottle effect the contact angle hysteresis and air entrapment are also considered while simulating wetting swrc prediction of wetting swrc has been accomplished by modeling the pore scale displacement processes during the displacement of air by water the predicted wetting swrc for sample 1 is shown in fig 15 with an r 2 value of 0 97 and rmse obtained is 0 04 fig 15 shows that the granular soil did not achieve full saturation during the wetting imbibition process because of air entrapment during a wetting process water enters the smaller void spaces of the soil first and subsequently the larger ones and the air is consequently expelled when high values of degree of saturation are attained larger pore spaces filled with air may be entirely surrounded by narrowers pore passages filled with water causing air discontinuity which results in trapping the proposed numerical framework which incorporates the angularity in the void spaces and simulates snap off predicts air entrapment with reasonable accuracy 4 3 gap graded granular soils grain size distribution with bimodal characteristics also known as gap graded soils is commonly observed in residual and colluvial soils rahardjo et al 2004 zhang and chen 2005 such soils can be associated with unimodal or bimodal swrcs the bimodal distribution of swrc is usually linked to a bimodal pore size distribution and this phenomenon generally occurs because fine grains do not entirely fill the pores formed by coarse grains zhang and chen 2005 thus two major pore series i e macro pores and micro pores comprise the pore structure of soils with bimodal swrc the macro pores are formed between the coarser soil grains and micro pores are formed between the coarser soil grains and fine contents or within the fine contents in such soils as the suction increases the bulk water in macro pores first drains generating a steep slope followed by the drainage of residual water in macropores resulting in a flat slope when the suction is increased further a suction sufficient to drain bulk water in micropores is reached then the bulk water in the micropores drain resulting in a steep slope finally the residual water in the micro pores drain li 2009 for gap graded soils figs 16 and 17 illustrate the simulated swrc with sample 3 showing a unimodal swrc and sample 4 having a bimodal swrc the predicted swrc shows a good resemblance with the experimental trend with r 2 and rmse values of 0 88 0 91 and 0 09 0 05 for samples 3 and 4 respectively the gsd of both samples is divided into three intervals and the frequency distribution of the radius of pore network elements from each interval is shown in fig 18 in the multiscale pore network for both samples network elements have radii ranging from three to four orders of magnitude however unlike uniformly graded soils the overlap between the radius of network elements from different intervals is less prominent for samples 3 and 4 indicative of their gap graded nature the average volume contribution of network elements corresponding to n e t ω 1 in the final network for sample 3 and sample 4 is 1 and 57 respectively n e t ω 1 for both the samples can be envisioned to be representative of the coarse fraction or macro pores hence for sample 3 the large pores between the gravel particles are almost entirely occupied with the fine particles and there is no discernible large and small pore size distribution the behavior of the soil mixture is thus governed by the fine content resulting in a unimodal swrc on the other hand the coarsest fraction comprises the major pore skeleton for sample 4 and hence the resulting swrc for the soil is bimodal consequently apart from a reasonable prediction of swrc the proposed methodology of network generation can provide insights into the pore structure of a soil mixture thus using the proposed multiscale pore network construction approach the final domain attains the target gsd the target porosity has pore network elements corresponding to all sizes and simulated swrc follows the experimental trend indicating that the final network captures the geometric and topological features of void structures of granular soils 4 4 fitting of simulated results using experimental techniques for direct measurement of swrc a series of discrete data points is obtained indicating the relationship between soil suction and water content however a future application of these measurements to predict flow stress and deformation phenomena usually necessitates the description of measured retention curves in mathematical form lu and likos 2004 the simulated soil water retention curves are similarly fitted to obtain the relevant closed form equation for each sample for swrcs with unimodal characteristics the fredlund and xing 1994 fx model is used and for bimodal swrcs gilson and fredlund 2004 model gf model has been availed fx model is of the form 20 s 1 ln 1 ψ ψ r ln 1 1 0 6 ψ r 1 l n e ψ a n m where s is the degree of saturation ψ is soil suction kpa ψ r is residual suction kpa e is a natural number 2 71828 and a m n are fitting parameters parameter a has the unit of pressure kpa for bimodal swrcs two distinct air entry values and two distinct residual points can be defined gf model effectively captures the bimodal characteristics of swrc and is an eight parameter model ψ b 1 ψ r e s 1 s r e s 1 ψ b 2 s b ψ r e s 2 s r e s 2 and a the model is based on the general hyperbole equation given by 21 s s 1 s 2 1 ψ ψ b 1 ψ r e s 1 d 1 s 2 s 3 1 ψ ψ b 2 ψ r e s 1 d 2 s 3 s 4 1 ψ ψ b 2 ψ r e s 2 d 3 s 4 22 s i tan θ i 1 r i 2 ln ψ ψ i a 1 r i 2 tan 2 θ i 1 i 1 tan 2 θ i 1 r i 2 tan 2 θ i r i 2 ln 2 ψ ψ i a a 2 1 r i 2 tan 2 θ i 1 tan 2 θ i s i a where i 1 2 3 4 θ i λ i 1 λ i 2 hyperbolas rotation angles r i tan λ i 1 λ i 2 aperture angle tangents λ 0 0 and λ i arctan s i a s i 1 a ln ψ i 1 a ψ a i desaturation slopes s 1 a 1 s 2 a s r e s 1 s 3 a s b s 4 a s r e s 2 s 5 a 0 ψ 1 a ψ b 1 ψ 2 a ψ r e s 1 ψ 3 a ψ b 2 ψ 4 a ψ r e s 2 ψ 5 a 1 0 6 d j 2 exp 1 l n ψ j 1 a ψ j a weight factors j 1 2 3 and ψ has units of kpa the fitted swrcs using simulated results for a hysteretic unimodal swrc and a bimodal swrc are shown in fig 19 the values of the fitting parameters are also given in the corresponding plots the fitted results are consistent with the experimental trend high r 2 values are attained showing the accuracy of the proposed methodology the modeled hysteresis in swrc is also predicted with a reasonable precision 5 conclusions this work presents a novel numerical procedure for generating a pore network of granular soils with a wide grain size distribution the conventional approach of modeling packing of granular soils using dem is limited to uniformly graded soils in contrast the proposed methodology applies to granular soils with any grain size distribution regardless of whether the distribution varies over several orders of magnitude or is gap graded pore networks extracted from soil packing at different length scales are combined to construct a single multiscale pore network typically these generated multiscale pore networks include information from all resolution scales and contain pore elements with a length scale of over four orders of magnitude having constructed the multiscale integrated pore networks air water flow in the network is simulated by including the relevant pore scale mechanisms to model drying and wetting swrc the micro mechanics of corner flow during drainage and the trapped air phase encountered during wetting are also modeled resulting in a more robust numerical model despite the simplicity of the model regarding the experimental data needed i e only grain size distribution and porosity value the simulated swrcs are in good agreement with the experimental results nevertheless the proposed numerical scheme can be used for non deformable granular media under the premise of negligible volume change with suction the present pore scale model can also be extended to fine grained soils where the water retention capacity of soils is also affected by the adsorptive forces the main advantage of the presented framework is that by implementing appropriate mechanisms at the pore scale it can be used to simulate physical and chemical processes such as reactive transport processes diffusion dispersion dissolution and precipitation biomass growth adsorption and absorption radioactive waste management for example applications of bentonite adsorption in radioactive waste deposition geological storage of carbon dioxide storage and various other flow and transport phenomena in unsaturated soils credit authorship contribution statement suaiba mufti writing original draft conceptualization methodology software investigation formal analysis arghya das conceptualization writing review editing supervision declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests arghya das reports financial support and travel were provided by science and engineering research board arghya das reports a relationship with oil and natural gas corp centre for excellence in well logging technology that includes funding grants no conflict of interest acknowledgments the authors appreciate the enlightening review comments from the reviewers the second author ad acknowledges the support from the science and engineering research board govt of india through the core research grant crg 2022 005181 and oil and natural gas corp cewll through the pan iit collaborative research grant ongc me 2017404 
46,characterizing and modeling the pore structure is the key to simulating single and multiphase flow through granular soils modeling the grain based packing and predicting the multiphase flow properties of granular soils with a wide grain size distribution gsd spanning over several orders of magnitude is still a challenging task this work presents a novel numerical framework for constructing the pore network of granular soils with a wide grain size variation the present work focuses on using basic properties of granular soils like gsd and porosity to generate pore network properties that are further utilized to simulate the water retention properties of granular soils along drying and wetting paths a topologically equivalent network of pores and throats is extracted from modeled soil packing at different length scales by integrating the pore networks extracted from individual length scales in the main simulating domain a multiscale pore network that represents the pore structure of the soil to be modeled is obtained the pore scale phenomena like piston like advance corner flow wetting layers pore body filling and snap off are used to model fluid displacements at the pore scale the estimated soil water retention curves for various granular soils are in good agreement with experimental data from the literature and the hysteretic wetting drying response is also accurately predicted keywords soil water retention curve discrete element method unsaturated soils pore network modeling grain size distribution data availability no data was used for the research described in the article 1 introduction a deep understanding of multiphase flow in porous media and determination of macroscopic properties like capillary pressure saturation curves and relative permeability functions play an essential role in many fields such as hydrogeology reservoir engineering radioactive waste disposal and implementing unsaturated soil mechanics into engineering practice joekar niasar and hassanizadeh 2012 xiong et al 2016 there has been a continued emphasis on developing indirect methods for predicting these macroscopic properties from more readily measurable material characteristics due to the high cost and time consuming nature of the experiments lu and likos 2004 pore scale modeling methods are a powerful tool to predict these quantities and improve our descriptions of multiphase flow and transport processes the governing equations are formulated at the scale of the individual solid particles and hence require a detailed understanding of the physical processes that occur at the pore scale and a thorough description of the morphology of the pore space pore scale methods involve either direct numerical approximation of the navier stokes equations or pore network modeling pnm sheng and thompson 2016 direct numerical simulation approaches simulate multiphase flows inside pores with great precision but they are often computationally costly and can only address limited pore volumes shi et al 2021 li et al 2018 pore network idealization on the other hand is computationally efficient enabling larger domains to be simulated the pore network is composed of geometrically idealized elements pores and throats that approximate the 3 d pore space while preserving its topology wide void spaces are represented by pores connected by narrower regions called throats multiphase flow is then simulated in the network and macroscopic characteristics are estimated using criteria for identifying fluid configurations and suitable flow and transport equations fatt 1956 introduced pnm and since then two phase flow using pnm has been investigated by several researchers fatt 1956 drew an analogy between a random resistor network and flow in porous media to produce the capillary pressure saturation curves of primary drainage and relative permeability curves subsequently the pore network models have evolved enormously and are now frequently used to simulate a wide range of physical and chemical processes balhoff and wheeler 2009 blunt et al 2002 lopez et al 2003 ryazanov et al 2009 wang et al 2021 the reliability of pnm is heavily dependent on how well the pore space of a given porous media corresponds to the constructed pore network as its representation several studies have shown that an accurate description of the morphology of porous media in terms of geometric properties such as the distributions of sizes and shapes of pores and throats pore throat correlations and network topology parameters such as connectivity or coordination number and coordination number distribution are critical for realistic predictions xiong et al 2016 several approaches have been developed to construct a pore network representation of porous media high resolution microtomography images of a porous material are used for its 3 d reconstruction network extraction algorithms like maximal ball algorithms al kharusi and blunt 2007 and the medial axis algorithms lindquist et al 2000 are then availed to generate the pore network mapping the actual pore space statistical methods can also be utilized to construct the 3 d representations of the pore space using a high resolution 2 d image obtained from scanning electron microscopy okabe and blunt 2004 however the imaging approach for obtaining the pore network is expensive computationally difficult and not widely available daneshian et al 2021 as a result advanced techniques like micro computed tomography imaging to obtain a pore network are neither practical nor viable for forecasting capillary pressure saturation curves and relative permeability functions of granular soils for diverse field applications another alternate method is to numerically represent the porous material by generating the grain packing then extracting the pore network from it bryant and blunt 1992 pioneered the use of grain based models equal sized spheres are used to generate sandstone models by numerically modeling the geological process involved in its formation the pore network is extracted using image analysis techniques on the packing of spheres to obtain capillary pressure saturation and relative permeability curves mehlhorn et al 2008 modeled granular soils using an idealized grain structure consisting of spheres for a given grain size distribution gsd and porosity using geometric gravity based criteria where the spheres used to model the grain structure had to be mechanically stable and must not overlap each other and the bounding box of the modeled volume an algorithm is developed to create a grain structure model tong et al 2012 used the discrete element method dem to model granular materials as an assembly of spherical particles and proposed a procedure to generate numerical samples matching experimental particle size distribution and porosity for glass beads the pore network is extracted using the regular triangulation method from the assembly created continuing the same line of investigation mahmoodlu et al 2016 coupled discrete element and pore network modeling to study the effects of compaction and particle mixing processes on pore structure intrinsic permeability and soil water retention capacity of sand sweijen et al 2017 matched the gsd and porosity values of the granular soils to generate packings of spheres and then simulated capillary pressure saturation curves for drainage mufti and das 2022 have shown that coupled dem and pnm approach can successfully model the unsaturated hydraulic conductivity of granular soils which is an indispensable input data for many engineering problems involving water flow through unsaturated soils seminal work using this approach has been carried out by yuan et al 2016 nikooee et al 2017 sweijen et al 2016 and mahmoodlu et al 2018 thus the numerical framework of simulating soil water retention curves swrc and unsaturated hydraulic conductivity of granular soils by modeling the grain and pore structure is a promising approach given the simplicity of the model in terms of experimental data needed however this approach has been limited to uniformly graded granular soils with the gsd that spans less than one order of magnitude recent works to obtain swrc using dem and pnm are limited to narrow gsd with a size ratio ratio of the largest size of the particle to smallest size less than 10 tong et al 2012 mahmoodlu et al 2016 yuan et al 2016 nikooee et al 2017 sweijen et al 2016 2017 mahmoodlu et al 2018 these limitations arise from a combination of inherent and computational restrictions in the most critical step involved in this approach namely the creation of packings to represent granular soils however granular soils can span orders of magnitude in size with a size ratio as high as 1 0 3 coarse sand to silt size fig 1 generation of synthetic samples with particle size distribution ranging over several orders of magnitude is a long standing issue berger and hrenya 2014 this work presents a novel methodology for the numerical construction of the pore network of granular soils with a wide gsd multiscale pore spaces characterize systems with a broad gsd and considering only a single length of pore sizes and spatial connectivity is not sufficient for the realistic representation of the pore structure therefore multiscale pore network models containing information from each length scale must be constructed for soils with the gsd of several orders in this approach soil packing at different length scales is first constructed and a topologically equivalent network of pores and throats is extracted from the modeled soil packing corresponding to each length scale the multiscale pore network which represents the pore structure of the soil to be modeled is then obtained by integrating extracted pore networks from each length scale in the main simulating domain this multiscale network construction aims to derive accurate predictions of multiphase flow properties for soils with gsd varying over several orders of magnitude the paper is organized into five sections including this introductory note section 2 details the limitations involved in the generation of packings to represent granular soils and network extraction techniques a detailed description of the proposed methodology for the construction of multiscale pore networks for soils with wide gsd is presented in section 3 the constructed pore network models are used to simulate swrcs for various granular soils and the simulated swrcs are compared with the experimental values from the literature in section 4 the conclusions arrived at have been presented in section 5 2 theoretical background in a broad sense random sphere packings to model granular materials are constructed via dynamic or geometric approaches major geometric algorithms are sequential addition models and collective rearrangement models al raoush and alsaleh 2007 in sequential addition models one sphere is added at a time to an existing cluster of spheres at a stable position whereby it is in contact with two additional spheres this algorithm cannot control the packing density and the final packings may not be homogeneous matheson 1974 al raoush and alsaleh 2007 in collective arrangement models spheres are randomly placed in a domain and iterative relaxation techniques molecular dynamics and monte carlo simulations are used to separate the overlapping spheres until a stable configuration with a certain overlap tolerance is achieved this technique however may produce a packing in which the particles are not in perfect touch resulting in an unrealistic contact network and coordination number distribution jodrey and tory 1985 the dynamic approach is dem based method and is more commonly used for preparing numerical samples for granular materials like cohesionless soils cundall and strack 1979 it is a lagrangian technique where each particle of the material is represented by a sphere characterized by its mass radius and moment of inertia and then tracked via a force balance despite the fact that dem can generate any desired randomly packed structure in any density range it is not able to simulate realistically wide size distributions berger and hrenya 2014 roozbahani et al 2017 as the polydispersity of the particle size distribution increases the number of particles to achieve that packing increases with a decrease in the time step required for accurate resolution of particle contact it results in increased computational cost along with the increase in the parallelization cost rendering wide particle size distributions impractical to simulate berger and hrenya 2014 compared the number of particles required to simulate a polydisperse particle size distributions to a representative monodisperse system and found that for continuous distribution number of particles increases substantially with the width of the distribution ratio of the standard deviation of the particle sizes to their arithmetic mean there is a 100 fold increase in the number of particles for log normal distributions with a 200 width compared to monodisperse systems the gsd of soils is generally fitted using log normal distribution fredlund et al 2000 thus for the gsd in fig 1 with a width ranging from 115 to 215 the number of particles required will be extensive in comparison with their monodisperse counterpart additionally the time step which is set by the size of the smallest particle decreases as the width of a continuous distribution increases based on the findings of berger and hrenya 2014 for a log normal distribution with a moderate width of 50 the time step drops at least an order of magnitude compared to its corresponding monodisperse systems the increase in the number of particles and decrease in the time step directly influence the simulation time further the increase in distribution width is associated with an increase in parallelization cost domain decomposition is the most common method for parallelizing dem algorithms pöschel and schwager 2005 this method decomposes the region into sub regions and each processor is responsible for one or more of the sub regions a shared volume is defined which is the region immediately outside the boundaries of the sub region fig 2 shows 9 sub regions and the associated shared volume with the central sub region the computational and communication costs associated with the particles in shared volume encompass the parallelization cost a wider distribution width increases the cost of parallelization by increasing the number of particles in the shared volume as well as increasing the number of particles within a sub region therefore generating a synthetic sample for granular soils with a wide gsd as illustrated in fig 1 is not feasible with dem upon modeling the grain packing of the soils the next step involves extracting the geometry of the pore structure followed by simulating two phase flow in the pore network an essential mechanism of corner flow wetting layer is either neglected in flow simulations for obtaining swrc yuan et al 2016 sweijen et al 2017 or the geometry of the pore space is oversimplified to be represented by spheres and cylinders circular cross sections that fail to model the wetting layers rostami et al 2015 daneshian et al 2021 during drainage when the non wetting phase invades the pore space of a porous medium the wetting phase is retained in the corners and crevices called the wetting layer micromodel tests have demonstrated this phenomenon lenormand et al 1983 despite only a few microns in thickness wetting layers are of crucial importance since they ensure low residual wetting phase saturation by preventing the wetting phase from being trapped blunt et al 2002 valvatne and blunt 2004 a study by dullien et al 1989 demonstrated that residual saturation of the wetting phase in rough glass beads micron scale roughness as observed from sem images drops to as low as 1 of void space due to wetting layers while residual saturation in smooth glass beads is 10 the simplification of not modeling the wetting layers and thus ignoring the double occupancy of a pore or throat by both water and air in granular soils results in overestimating residual saturation sweijen et al 2017 and deviation of predicted unsaturated hydraulic conductivities at high suction values mufti and das 2022 these concerns are circumvented through a novel methodology presented in this work for the construction of pore network models for soils with a gsd of several orders 3 methodology the outline of the methodology for the numerical construction of the multiscale pore network model for granular soils using only gsd and porosity information is as follows first soil packing at different length scales is constructed and the pore network is extracted from the modeled soil packing then the extracted pore networks are integrated into the same domain such that the packing porosity and grain size distribution of the original soil sample to be modeled is retained multiscale pore network models are obtained by repetition of this method finally two phase flow simulations are carried out to simulate swrcs fig 3 3 1 generating synthetic soil samples the macro behavior of granular soils is highly influenced by their particle arrangement and thus the geometrical modeling of granular structures represents a crucial step in the pore scale simulations usually a sample of a granular structure is represented by a regular geometric domain parallelepiped containing soil grains modeled by spherical particles in this study dem is used to generate granular soil samples a discrete element approach is a numerical method that simulates the response of granular materials by considering the individual particles and their interactions cundall and strack 1979 modeling of non cohesive granular soils have been carried out by dem extensively and the procedure can be divided into two stages initially the geometry of the system to be analyzed including the boundary conditions loading conditions and the material properties stiffness and friction coefficient are specified the contacting particles are identified at each time step and the magnitude of the inter particle forces proportional to the distance between them is calculated in the second stage particle positions and orientations are updated newton s second law is used to determine the resulting acceleration which is then time integrated to find the new positions for each particle while dem may create any randomly packed structure in a predetermined density range it is still challenging to simulate wide grain size ranges thus for the numerical construction of the multiscale pore network models for soils following wide gsd synthetic soil samples corresponding to different length scales are first obtained the gsd and porosity representing the packing of the soil samples to be modeled are referred to as target grain size distribution g s d t and target porosity n t respectively the framework to model synthetic soil samples is as follows 1 the g s d t is divided into m intervals such that each successive interval approximately differs from the preceding interval by an order of one in the grain sizes dem can successfully simulate spherical packing with particle sizes spanning an order of magnitude berger and hrenya 2014 sweijen et al 2016 2 for each interval i i 1 m representing a different length scale an assembly of spheres packed to attain a predefined grain size distribution and porosity needs to be generated the coarsest grains are present in the first interval followed by fine grains in the succeeding intervals and finally the finest in the last interval 3 the synthetic soil sample obtained from the interval 1 coarsest grains represents the nesting or integrating domain ω 1 the assemblies of spheres corresponding to fine grains are of smaller size compared to the size of ω 1 and are eventually integrated in ω 1 4 for an interval i i 1 m the weight fraction of different sized particles is obtained from the g s d t and gsd corresponding to the interval i is acquired which is then used to model synthetic soil samples ω i i 1 m if w p is the weight of the particular soil size in interval i then while determining the gsd of this interval the corresponding weight fraction is given as a ratio of w p and w i w i is the total weight of soil in interval i for sample 1 fig 1 the gsd roughly spans over three orders of magnitude thus the gsd is divided into 3 intervals the interval 1 corresponds to grain size diameter greater than 0 1mm interval 2 has a grain size in the range of 0 01mm to 0 1mm similarly grains with a diameter less than 0 01mm are in interval 3 the gsd of each interval is shown in fig 4 a 5 the packing density is equally required for geometric modeling of granular soils along with particle size distribution packing density is given by the ratio of void volume in a domain to the total volume of the domain also known as porosity hence porosity is the second parameter required to acquire an assembly of spheres in each domain for fine domain ω i i 2 m the value of porosity used to attain the packing of spheres is the same as the target porosity n t in the integrating domain ω 1 the addition of fine domains ω i i 2 m will reduce the porosity value of ω 1 thus to attain a final domain that is representative of the granular soils to be modeled the packing of coarse spheres in ω 1 is achieved at a porosity value n 1 greater than n t let w i and v i be the weight and volume of soil grains in any interval i then 1 w 1 w i v 1 v i k i i 2 m i 2 m v i will lead to a decrease in the porosity of ω 1 correspondingly the value of porosity n 1 can be calculated using 2 n t n 1 1 n 1 i 2 m 1 k i where n t is the target porosity given and k i can be determined from g s d t the synthetic soil samples for each interval are constructed after obtaining the particle size distribution and packing density in this study the dem implementations are carried out in p f c 3 d itasca 2019 many open source dem software packages can also be availed for modeling synthetic soil samples šmilauer et al 2010 particle interactions are modeled using a soft contact approach allowing for overlaps at the point of contact at a given contact point the constitutive model consists of a stiffness model which establishes an elastic relation between the contact force and relative displacement and a slip model which involves a relationship between normal and shear contact forces allowing the two contacting balls to slip relative to one another following the detection of these contacts the normal f n and tangential f t contact forces are calculated at each incremental time step and granular packings are simulated using the hertz mindlin model 3 f n k n δ n 4 f t k t δ t where k n is the contact normal secant stiffness k t is contact shear stiffness δ n and δ t are the normal and tangential cumulative shear displacements the stiffness coefficients are be expressed as 5 k n 2 g 2 r 3 1 ν δ n 6 k t 6 g 2 1 ν r 1 3 2 ν f n 1 3 where g is the elastic shear modulus ν is the poisson s ratio and r is the harmonic mean of the radius of two spheres in contact in order to detect slip the contact is checked for tangential forces exceeding the maximum allowable shear contact forces f m a x s determined by mohr coulomb criteria for static friction 7 f m a x s f n tan ϕ where ϕ is the coefficient of static friction the synthetic soil sample for each interval is created within a cubic domain the size of which is determined by the gsd of that interval initially the spherical particles are generated in a cube 10 20 times the maximum particle diameter to remove possible inhomogeneity in particle packings li et al 2021 the container walls force the spherical particles to arrange themselves in an orderly form near the boundary the ordered particles close to walls affect the immediately adjacent particles and the effect abates by moving away from the container wall koval et al 2015 this ordered packed structure creates high porous regions and to mitigate these boundary effects a representative element volume r e v is extracted from the sample s interior the rev calculation for soil sample 1 having gsd given in fig 1 and porosity 0 44 table 1 is shown in fig 5 the variation in porosity with packings of various sizes for each domain is shown in fig 5 where l d m refers to the ratio of the size of the cube l to mean particle diameter d m after an initial fluctuation porosity settles down to a constant value when size of the cubic domain is greater than 15 times the mean particle diameter which lies within the range determined in previous studies wiacek and molenda 2016 thus rev obtained from the interior of the sample is generally 15 20 times the mean particle diameter when creating a representative assembly of spheres particles overlap and large contact forces are encountered as a result the algorithm is permitted to continue until the imbalanced force ratio falls within the given tolerance level of 0 001 in order to achieve static equilibrium li et al 2021 table 2 lists the dem model parameters synthetic soil samples corresponding to various intervals for sample 1 are shown in fig 6 and the gsds are compared in fig 4 b 3 2 multiscale network construction the generation of synthetic samples corresponding to different intervals is followed by the pore network extraction fig 6 pore network extraction deals with the discretization of the void space of the porous media into pores representing wider regions connected via narrower restrictions called throats several attempts have been made to develop algorithms for extracting pore networks from generic and arbitrary 3 d images of porous media the most notable of which are the medial axis based and the maximum ball techniques the network extraction approach proposed by raeini et al 2017 is used in this study to extract a topologically analogous network of pores and throats from images of synthetic soil specimens in this algorithm the topology of the underlying image is retained by maintaining the topology of the medial surface during the pore network extraction this algorithm extracts pore network from 3 d binary images of porous media a binarized 3 d image of a 3 d synthetic soil specimen modeled in pfc is thus generated by assigning a value of one to each voxel representing soil grains and a value of zero to those representing void space the 3 d images have 1000 1000 1000 voxels with voxel sizes ranging from 0 07µm to 10µm in different intervals for different reference materials used for validation apart from an unstructured and irregular pore network which is a more realistic representation of porous materials like soils an essential feature of the network extraction approach used is that the irregularities in the pore space are captured by assigning different geometrical shapes to pores and throats an element s geometric shape is governed by its shape factor defined as the ratio of its cross sectional area to the perimeter square an element is modeled as a circular square or scalene triangular cross section such that the shape of the cross section of the element has the same shape factor as the actual cross section of the pore space the shape factor of a circle is 1 4 π while that of a square is 1 16 the shape factor of triangles varies from zero for a slit shaped triangle to 3 36 for an equilateral triangle modeling wetting layers is not possible in pore networks with circular cross sectional elements as they cannot retain wetting layers contrary to this the network model used in this study can incorporate wetting layers due to the presence of angular pores and throats triangular or square cross section the network extraction algorithm provides the values of the geometric properties such as radius shape factor volume and length of individual network elements once the pore networks n e t ω i i 1 m corresponding to each interval is extracted the next step that follows is the multiscale pore network construction the multiscale pore network n e t f i n a l is assumed to be representative of the pore space of the actual soil to be modeled and two phase flow simulations are carried out in this pore network fig 7 for the construction of a multi scale pore network the networks extracted from fine domains n e t f n e t ω i i 2 m are placed in the nesting network n e t ω 1 three aspects of the multiscale pore network formulation come into play the number of fine networks x i that should be added from each interval their positioning in the nesting network and finally the inter network connections 8 n e t ω 1 x i n e t ω i i 2 m n e t f i n a l the underlying principle followed by all authors while constructing a pore network for uniformly graded soils is that the grain based assembly used for geometric modeling of soil samples has the same gsd and packing porosity as that of the soil sample the same principle is used for multiscale pore network construction consequently the number of fine pore networks placed in the nesting pore network which is equivalent to the number of fine domains added in the nesting domain should be such that the particle size distribution of the final domain matches that of the modeled soil sample the number of fine networks from each interval x i is calculated using the following equation 9 w 1 w i w ω 1 x i w ω i i 2 m where w ω i is the weight of solids in any domain i following the determination of the number of fine networks from each interval the next step is to integrate the networks into the nesting network n e t ω 1 the integration process starts by placing x 2 number of n e t ω 2 in the pores of n e t ω 1 the networks are placed randomly in the pores of the n e t ω 1 without any spatial correlation a pore in n e t ω 1 is randomly selected and the number of fine networks placed is such that the pore is completely replaced with the fine networks once x 2 number of n e t ω 2 are placed in the nesting domain the n e t ω 1 is updated and the updated n e t ω 1 has pores and throats from ω 1 as well as ω 2 then the pores of the updated n e t ω 1 are similarly filled with x 3 number of n e t ω 3 the process continues until all the fine networks are integrated into the nesting network it is discussed in more detail in section 3 3 the final step in multiscale network construction is to provide connectivity between networks corresponding to different intervals for original fine networks the inter pore distance distribution and maximum inter pore distance is calculated the inter pore distance for two pores p 1 and p 2 approximated as spheres with respective inscribed radii r 1 and r 2 connected by a throat is defined as 10 d p 1 p 2 d e p 1 p 2 r 1 r 2 where d p 1 p 2 is the inter pore distance and d e p 1 p 2 is the euclidean distance between the two pore centers once a fine network n e t f is placed in the pore of a coarser network all the boundary pores of the fine network are identified and linked with the neighboring pores of n e t ω 1 and pores of other fine networks the procedure followed to connect pores from different networks and establish inter network connectivity is as follows for a given boundary pore p f of the fine network the set s n of all neighboring pores p n of other networks is identified such that the inter pore distance d p f p n between them is less than the maximum inter pore distance of n e t f the length of the throats in n e t f is already provided by the network extraction algorithm this information is used to find the average throat length l t a v g of the throats already linked to the boundary pore p f the neighboring pore p n from s n for which the inter pore distance d p f p n matches the average throat length l t a v g most closely is selected the pores p f and p n are then linked together with a throat the schematic representation of the procedure is shown in fig 8 a throat is described by its properties like radius volume shape factor and length while the length of the throat connecting p f and p n is the inter pore distance between them the other properties are obtained from the statistical information of the already connected throats to p f 11 t t h r o a t 1 j j 1 j t j where t t h r o a t is the property radius volume shape factor assigned to the new throat t j is the value of that property for the already connected throats and j represents the total number of throats linked to the pore p f in the original fine network the adopted network integration scheme considers connections between fine networks and the coarsest network as well as between fine networks from different intervals 3 3 computational aspects the difference between the length scales of the integrating domain and other fine domains is such that a very large number of fine domains are needed to obtain a final domain with gsd same as g s d t taking as an example sample 1 properties given in table 1 table 3 lists the major properties of the extracted networks corresponding to different intervals for one realization clearly the final network will contain a huge number of pores and throats for simulating the quasi static two phase flow in the pore network the algorithm discussed in section 3 4 has a time complexity of o n n 1 n represents the number of capillary pressure increments discussed in section 3 4 and n 1 the number of elements of a pore network consequently flow simulations become computationally very intensive due to the large number of elements in the pore network to circumvent this issue following procedure has been adopted as part of the construction of a multiscale pore network the fine networks are inserted in the pores of the coarser networks the selection of the pore is made randomly and it is entirely filled with m number of networks from an interval i i 2 m where m is the ratio of the volume of the pore to be filled and volume of the fine network that has to be placed in order to facilitate computation for a pore to be replaced with m number of fine networks only one fine network is placed in it and its volume contribution is assigned as m times further to get realistic lengths of the inter network throats the boundary pores of the fine network are placed on the periphery of the pore to be replaced the number of elements of a pore network can further be reduced without significantly jeopardizing the pore structure and two phase flow properties by diluting the individual networks n e t ω i i 1 m of different domains before integrating them into the final domain dilution of a network here refers to the random deletion of some pores and their connected throats the volume of the deleted pores and throats is equally added to the remaining network elements without altering their radii fig 9 shows the effect of dilution on the simulated swrc for one pore network corresponding to ω 1 of sample 1 for deletion of up to 20 20 of the pores and the connected throats are removed no significant variation in the simulated swrcs is seen the root mean square error of 0 01 is observed in the degree of saturation when the 20 deleted network is compared with the original network the same results were observed for other networks hence the individual networks are diluted up to 20 of pores are deleted before the construction of a multiscale network however the deletion strategy must be evaluated for other network extraction techniques before applying it to the network the impact of deletion on the simulations must also be examined before considering other multiphase flow processes these simplifications highly reduce the number of elements in the final network without any change in the porosity of the final domain thus decreasing the simulation time 3 4 modeling drying and wetting swrc for modeling the swrc the inlet boundary of the simulated domain is connected to an air reservoir and has a pressure p a i r the outlet boundary is connected to a water reservoir with a pressure p w a t e r under quasi static conditions the capillary pressure ψ is equal to the pressure difference between the two reservoirs 12 ψ p a i r p w a t e r for drainage drying simulations the network is initially completely saturated with water by increasing the air pressure while keeping the water pressure constant the capillary pressure of the network is gradually increased if the capillary pressure exceeds the entry pressure threshold capillary pressure of an element pores and throats and water is in pressure communication with the outlet air invades that element the threshold capillary pressure ψ t h of an element is determined from øren et al 1998 generalization of mayer and stowe princen method mayer and stowe 1965 princen 1969 13 ψ t h γ 1 2 π g f d cos θ r r 14 f d 1 1 4 g c cos 2 θ r 1 2 π g 15 c i 1 c cos θ r cos θ r β i sin β i π 2 θ r β i where γ is the surface tension of air water interface g is the shape factor of an element θ r is the receding drying contact angle and r is the inscribed radius of an element f d is a dimensionless correction factor that depends on contact angle and shape factor and is equal to 1 for circular cross sectional elements c is a function of corner half angles c is the number of corners of an element containing water in the form of wetting layers and β is the corner half angle of an element s cross section for triangular angles the corner half angles are computed using the approach suggested by patzek 2001 during displacement of one fluid phase by another if non invading fluid water in case of drying in any element or cluster of elements loses its connectivity with the outlet then it is trapped the capillary pressure of trapped water saturated elements does not change and they cannot be drained however wetting layers contribute to water connectivity and prevent water trapping during drainage since the network extraction technique used in this study yields elements with angular cross sections and circular ones the contribution of the wetting layer is not neglected as a result water filled elements can be trapped in drainage if they are surrounded only by circular elements filled with air as capillary pressure increments are made equilibrium air water interface positions within the network are determined trapping is checked and average saturation of the entire network s w n e t is calculated 16 s w n e t j s w j v j j v j where the sum runs over all the elements pores and throats in the final pore network s w j a w j a j s w j is water saturation of an element with area a j and volume v j a w j is the area of water present as arc menisci in the corners of a pore body or throat and is given by øren et al 1998 17 a w j r 2 i 1 n cos θ r cos θ r β i sin β i π 2 θ r β i where r γ ψ and ψ is the current capillary pressure of the network the modeling of drying swrc is followed by simulating wetting swrc wetting swrc which is of practical importance in many field problems like landslides due to precipitation the performance of hydraulic barriers irrigation norms etc is generally not measured in the laboratory due to the inherent long time involved in its measurement for imbibition wetting simulations the maximum capillary pressure achieved at the end of drainage is gradually reduced by increasing the water pressure and the processes with the highest capillary pressure are preferred the displacements in the imbibition process are controlled by piston like advance pore body filling and snap off lenormand et al 1983 øren et al 1998 patzek 2001 valvatne and blunt 2004 in the piston like filling of throats water entirely displaces air and this displacement process is exactly the opposite of drainage due to contact angle hysteresis the threshold capillary pressure is different from drainage threshold capillary pressure for the piston like advance is given by 18 ψ t h γ r a where r a is the radius of curvature of arc meniscus and patzek 2001 is followed to calculate r a in pore cooperative filling i n mechanisms the threshold capillary pressure depends on multiple factors including the pore shape and neighboring pinned interfaces the threshold capillary pressure for pore filling is expressed as blunt 1998 19 ψ t h 2 γ cos θ a r p γ i 1 c ω i x i where θ a is the advancing wetting contact angle r p is the radius of a pore x i is a random number between 0 and 1 and ω i is the coefficient approximately equal to the inverse of the average throat radius connected to pore r p snap off occurs when water layers in corners swell and when they meet the air water interface becomes unstable and the entire element gets spontaneously filled with water the threshold capillary pressure for snap off under various conditions is calculated following the work of valvatne and blunt 2004 snap off is an important mechanism responsible for air trapping during the wetting process modeling the phenomenon of air trapping is relevant to various applications like modeling precipitation propagation into the ground with subsequent effects on the groundwater table interpretation and modeling laboratory wetting tests and induced partial saturation technique to mitigate liquefaction risks scarfone and wheeler 2022 most pore network models describe pore space as cylinders and spheres omitting the role of wetting layers and the snap off process and thus failing to model air entrapment therefore for modeling air entrapment in the soils it is imperative to account for the angularity in the void spaces a depth first search dfs backtracking algorithm is used to find all the trapped elements each increment in water pressure therefore determines which elements can be infiltrated by water through the above discussed mechanisms and the network saturation is updated accordingly also in each step the algorithm checks the connectivity of fluid phases to respective reservoirs to account for trapping 4 results the proposed model is evaluated and assessed by selecting different granular soils from the literature the gsd for the chosen materials is shown in fig 1 and table 1 lists their main properties in order to study the model s suitability on different granular soils the soils samples chosen have different gsds from well graded to gap graded soils with the coefficient of uniformity varying from 17 to 227 the porosities range from 35 to 47 the granular soils chosen have not undergone volume change during drying or wetting the proposed methodology does not account for such volume changes and pore networks designed to address pore structure evolution with suction are required instead in addition to capillary forces adsorptive forces also contribute toward matric potential especially at residual suction tuller et al 1999 in granular soils it is largely the capillary effect that dominates and adsorption is relatively insignificant tuller et al 2004 thus the granular soils with non plastic fines except sample 4 are selected from the literature for air water flow simulations in the pore network the geometric characteristics of the network shape factor radius volume of elements and fluid flow properties surface tension receding and advancing contact angles are required the network extraction algorithm provides geometric characteristics of pores and throats on the other hand the fluid flow properties are well established for the air water system the surface tension value of the air water interface is taken as 0 073 n m contact angle the angle formed by two fluids on a solid surface at their interfaces is a significant determinant of the pore scale liquid distribution granular soils being a water wet system have near zero values of receding contact angle lu and likos 2004 rostami et al 2015 the value of the receding contact angle used in the simulation is 0 the advancing contact angle is known to be larger than the receding contact angle it can reach 60 to 80 for fine grain soils based on capillary rise and horizontal infiltration experiments kumar and malik 1990 found that the advancing contact angles differed for different soils ranging from 57 3 for soils with 11 fine content clays to 84 8 for soils with 85 fine content a study by laroussi and de backer 1979 found that glass beads have an advancing contact angle that is 20 to 30 degrees larger than the receding contact angle smaller values of advancing contact angles are used since the soil samples modeled in the current investigation are granular soils this study uses a uniform random distribution of advancing contact angles between 20 and 40 to forecast wetting swrc 4 1 model validation using granular soil with narrow gsd as stated in the introduction the numerical framework of using grain based modeling by integrating dem and pnm for simulating multiphase flow properties like swrc has been employed extensively for granular soils with narrow gsd size ratio less than 10 the proposed approach for constructing a multiscale pore network is applied to a narrow gsd and contrasted with the conventional method of obtaining pore networks in the conventional method a single synthetic sample with the same gsd and packing porosity as the soil to be modeled is used to extract the representative pore network the g s d t of the soil to be modeled is shown in fig 10 a and has a porosity of 47 1 for constructing the pore network in accordance with the suggested approach the g s d t is divided into two intervals and the pore networks extracted from each interval are then integrated to obtain the representative pore network n e t f i n a l when the entire g s d t is modeled as a single packing m 1 and when the g s d t is divided into two intervals m 2 the simulated swrc fig 10 b compares favorably with each other and the experimental data the range of radii of pores and throats in the representative pore networks is also the same in both approaches fig 10 c d the coefficient of determination r 2 and root mean squared error rmse is calculated to quantify the goodness of fit both simulated swrcs have an r 2 of 0 99 and the rmse is 0 04 for m 1 and 0 02 for m 2 consequently the n e t f i n a l produced using the suggested methodology successfully represents the geometric and topological characteristics of the void structure of granular soils before analyzing the prediction of swrc using the multiscale pore network construction approach for granular soils with a broad grain size distribution the effect of the number of intervals m in which the gsd of the soil to be modeled g s d t is divided is first investigated the g s d t for sample 1 is divided into varying intervals m 2 3 and 4 and a multiscale pore network is constructed for each case fig 11 displays the modeled gsd simulated swrc and size range of pores and throats from various domains in the final network when g s d t is partitioned into varying intervals using the conventional approach m 1 the gsd could not be generated in a single synthetic packing resulting in simulated swrc that differ markedly from experimental data for m 2 the g s d t is divided into two intervals at a grain size of 0 08mm but the algorithm fails to converge when modeling the synthetic packing corresponding to ω 2 i e grain sizes from 0 001mm to 0 08mm with a size ratio of 80 the synthetic packing for ω 2 is then generated by removing some fine grains in the second interval thus by dividing the g s d t of sample 1 spanning over three length scales into two intervals the final domain could not generate particle distribution consistent with g s d t the final domain also failed to achieve the target porosity as shown in fig 11 d the n e t f i n a l for m 2 lacks fine pores and throats while the size range of pores and throats is nearly the same when the g s d t is divided into 3 or 4 intervals the modeled gsd and simulated swrc replicate the experimental trend with good accuracy for m 3 and 4 however for m 2 the simulated swrc diverges from the experimental data and thus the resulting pore network does not accurately represent the void structure of sample 1 given that dem can effectively construct spherical packings with a size ratio of 10 g s d t is thus divided into intervals with a size ratio not greater than 10 to ensure that the modeled gsd of the final domain is consistent with g s d t since the gsd of the reference materials covers about three orders of magnitude they are divided into three intervals to obtain n e t f i n a l and the predicted swrcs are discussed in subsequent sections 4 2 well graded granular soils pore network simulations for every reference material are carried out on several realizations for sample 1 the predicted swrcs from different realizations are shown in fig 12 the results are reported as the average of various realizations sample 1 and sample 2 are well graded soils the network elements in the multiscale pore network for both the samples have radii ranging over four orders of magnitude the frequency distribution of the radius of pore network elements from each interval for sample 1 is shown in fig 11 e the final gsd after integrating fine domains in the nesting domain is shown in figs 13 a and 14 a the simulated swrc along the drying path from the proposed methodology is shown in figs 13 b and 14 b respectively for samples 1 and 2 r 2 of 0 99 is obtained with rmse of 0 028 and 0 025 respectively for swrc along the drying path illustrating the reasonable accuracy of the proposed mechanism and approach it is well established that swrc is hysteretic in nature i e wetting and drying swrc are different from each other hence for oppositely directed drying and wetting processes two different soil moisture content would correspond to the same suction value causing a hysteresis loop several potential causes of hysteresis in coarse grained soils include geometrical effects due to non uniformity in pore size distributions or the ink bottle effect contact angle hysteresis and entrapment of air lu and likos 2004 fredlund and rahardjo 1993 gan et al 2013 while the current paradigm of modeling soil pore space as a network of pores connected by throats takes into consideration the ink bottle effect the contact angle hysteresis and air entrapment are also considered while simulating wetting swrc prediction of wetting swrc has been accomplished by modeling the pore scale displacement processes during the displacement of air by water the predicted wetting swrc for sample 1 is shown in fig 15 with an r 2 value of 0 97 and rmse obtained is 0 04 fig 15 shows that the granular soil did not achieve full saturation during the wetting imbibition process because of air entrapment during a wetting process water enters the smaller void spaces of the soil first and subsequently the larger ones and the air is consequently expelled when high values of degree of saturation are attained larger pore spaces filled with air may be entirely surrounded by narrowers pore passages filled with water causing air discontinuity which results in trapping the proposed numerical framework which incorporates the angularity in the void spaces and simulates snap off predicts air entrapment with reasonable accuracy 4 3 gap graded granular soils grain size distribution with bimodal characteristics also known as gap graded soils is commonly observed in residual and colluvial soils rahardjo et al 2004 zhang and chen 2005 such soils can be associated with unimodal or bimodal swrcs the bimodal distribution of swrc is usually linked to a bimodal pore size distribution and this phenomenon generally occurs because fine grains do not entirely fill the pores formed by coarse grains zhang and chen 2005 thus two major pore series i e macro pores and micro pores comprise the pore structure of soils with bimodal swrc the macro pores are formed between the coarser soil grains and micro pores are formed between the coarser soil grains and fine contents or within the fine contents in such soils as the suction increases the bulk water in macro pores first drains generating a steep slope followed by the drainage of residual water in macropores resulting in a flat slope when the suction is increased further a suction sufficient to drain bulk water in micropores is reached then the bulk water in the micropores drain resulting in a steep slope finally the residual water in the micro pores drain li 2009 for gap graded soils figs 16 and 17 illustrate the simulated swrc with sample 3 showing a unimodal swrc and sample 4 having a bimodal swrc the predicted swrc shows a good resemblance with the experimental trend with r 2 and rmse values of 0 88 0 91 and 0 09 0 05 for samples 3 and 4 respectively the gsd of both samples is divided into three intervals and the frequency distribution of the radius of pore network elements from each interval is shown in fig 18 in the multiscale pore network for both samples network elements have radii ranging from three to four orders of magnitude however unlike uniformly graded soils the overlap between the radius of network elements from different intervals is less prominent for samples 3 and 4 indicative of their gap graded nature the average volume contribution of network elements corresponding to n e t ω 1 in the final network for sample 3 and sample 4 is 1 and 57 respectively n e t ω 1 for both the samples can be envisioned to be representative of the coarse fraction or macro pores hence for sample 3 the large pores between the gravel particles are almost entirely occupied with the fine particles and there is no discernible large and small pore size distribution the behavior of the soil mixture is thus governed by the fine content resulting in a unimodal swrc on the other hand the coarsest fraction comprises the major pore skeleton for sample 4 and hence the resulting swrc for the soil is bimodal consequently apart from a reasonable prediction of swrc the proposed methodology of network generation can provide insights into the pore structure of a soil mixture thus using the proposed multiscale pore network construction approach the final domain attains the target gsd the target porosity has pore network elements corresponding to all sizes and simulated swrc follows the experimental trend indicating that the final network captures the geometric and topological features of void structures of granular soils 4 4 fitting of simulated results using experimental techniques for direct measurement of swrc a series of discrete data points is obtained indicating the relationship between soil suction and water content however a future application of these measurements to predict flow stress and deformation phenomena usually necessitates the description of measured retention curves in mathematical form lu and likos 2004 the simulated soil water retention curves are similarly fitted to obtain the relevant closed form equation for each sample for swrcs with unimodal characteristics the fredlund and xing 1994 fx model is used and for bimodal swrcs gilson and fredlund 2004 model gf model has been availed fx model is of the form 20 s 1 ln 1 ψ ψ r ln 1 1 0 6 ψ r 1 l n e ψ a n m where s is the degree of saturation ψ is soil suction kpa ψ r is residual suction kpa e is a natural number 2 71828 and a m n are fitting parameters parameter a has the unit of pressure kpa for bimodal swrcs two distinct air entry values and two distinct residual points can be defined gf model effectively captures the bimodal characteristics of swrc and is an eight parameter model ψ b 1 ψ r e s 1 s r e s 1 ψ b 2 s b ψ r e s 2 s r e s 2 and a the model is based on the general hyperbole equation given by 21 s s 1 s 2 1 ψ ψ b 1 ψ r e s 1 d 1 s 2 s 3 1 ψ ψ b 2 ψ r e s 1 d 2 s 3 s 4 1 ψ ψ b 2 ψ r e s 2 d 3 s 4 22 s i tan θ i 1 r i 2 ln ψ ψ i a 1 r i 2 tan 2 θ i 1 i 1 tan 2 θ i 1 r i 2 tan 2 θ i r i 2 ln 2 ψ ψ i a a 2 1 r i 2 tan 2 θ i 1 tan 2 θ i s i a where i 1 2 3 4 θ i λ i 1 λ i 2 hyperbolas rotation angles r i tan λ i 1 λ i 2 aperture angle tangents λ 0 0 and λ i arctan s i a s i 1 a ln ψ i 1 a ψ a i desaturation slopes s 1 a 1 s 2 a s r e s 1 s 3 a s b s 4 a s r e s 2 s 5 a 0 ψ 1 a ψ b 1 ψ 2 a ψ r e s 1 ψ 3 a ψ b 2 ψ 4 a ψ r e s 2 ψ 5 a 1 0 6 d j 2 exp 1 l n ψ j 1 a ψ j a weight factors j 1 2 3 and ψ has units of kpa the fitted swrcs using simulated results for a hysteretic unimodal swrc and a bimodal swrc are shown in fig 19 the values of the fitting parameters are also given in the corresponding plots the fitted results are consistent with the experimental trend high r 2 values are attained showing the accuracy of the proposed methodology the modeled hysteresis in swrc is also predicted with a reasonable precision 5 conclusions this work presents a novel numerical procedure for generating a pore network of granular soils with a wide grain size distribution the conventional approach of modeling packing of granular soils using dem is limited to uniformly graded soils in contrast the proposed methodology applies to granular soils with any grain size distribution regardless of whether the distribution varies over several orders of magnitude or is gap graded pore networks extracted from soil packing at different length scales are combined to construct a single multiscale pore network typically these generated multiscale pore networks include information from all resolution scales and contain pore elements with a length scale of over four orders of magnitude having constructed the multiscale integrated pore networks air water flow in the network is simulated by including the relevant pore scale mechanisms to model drying and wetting swrc the micro mechanics of corner flow during drainage and the trapped air phase encountered during wetting are also modeled resulting in a more robust numerical model despite the simplicity of the model regarding the experimental data needed i e only grain size distribution and porosity value the simulated swrcs are in good agreement with the experimental results nevertheless the proposed numerical scheme can be used for non deformable granular media under the premise of negligible volume change with suction the present pore scale model can also be extended to fine grained soils where the water retention capacity of soils is also affected by the adsorptive forces the main advantage of the presented framework is that by implementing appropriate mechanisms at the pore scale it can be used to simulate physical and chemical processes such as reactive transport processes diffusion dispersion dissolution and precipitation biomass growth adsorption and absorption radioactive waste management for example applications of bentonite adsorption in radioactive waste deposition geological storage of carbon dioxide storage and various other flow and transport phenomena in unsaturated soils credit authorship contribution statement suaiba mufti writing original draft conceptualization methodology software investigation formal analysis arghya das conceptualization writing review editing supervision declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests arghya das reports financial support and travel were provided by science and engineering research board arghya das reports a relationship with oil and natural gas corp centre for excellence in well logging technology that includes funding grants no conflict of interest acknowledgments the authors appreciate the enlightening review comments from the reviewers the second author ad acknowledges the support from the science and engineering research board govt of india through the core research grant crg 2022 005181 and oil and natural gas corp cewll through the pan iit collaborative research grant ongc me 2017404 
47,the problem of steady 2 d potential darcian flow from a flat bottomed reservoir of a coffer or other type of dam separated from an empty tailwater by an impermeable vertical sheet piling is one of the pillars in groundwater hydrology and soil mechanics analytical solutions to this problem are presented in the books by forchheimer zhukovsky vedernikov polubarinova kochina harr among others for the case of seepage with a phreatic line descending from the downstream face of the cutoff the formulae presented in classical textbooks despite the simplicity of conformal mappings of the complex potential quarter plane onto the zhukovsky half strip have lacunae and flaws we discuss and clean the mismatch in the abovementioned formulae the classical analytical solutions in the textbooks deal with the regime of no backwater for which the magnitude of the specific discharge vector at infinity coincides with hydraulic conductivity of the soil we obtain a general solution for most general flows with backwater for which the specific discharge at infinity is zero and the free surface has an inflection point in the physical plane the capillary fringe in the hodograph domain is imaged by a circular cut the pressure head infinitely deep under the cutoff wall is infinite a circular tetragon in the hodograph domain is conformally mapped onto the quadrant in the complex potential plane via a reference plane in the case with backwater one extra condition is needed to fix a mathematical solution for this purpose the location of a point on the free surface is fixed mathematically two affixes in the reference plane are found by solving a system of two nonlinear equations in the no backwater case only one affix is found and one equation is solved we also examine flow with a phreatic line in a low permeable layer e g concrete apron of a dam with an λ shaped topology of streamlines bounded from the left by a cutoff seepage from a dam reservoir through a subjacent highly permeable alluvium induces the pore water motion in the upper layer a hilbert boundary value problem is solved for the complex potential in this cell in the kirkham brock type boundary condition along the interface between the two layers the horizontal component of the specific discharge is constant phreatic surfaces rising on the downstream face of the cutoff caps λ shaped streamlines which turn around a hinge point on the interface between two layers of contrasting permeability keywords cutoff wall phreatic surface 2 d seepage analytical solution by complex potential hodograph method hilbert s boundary value problem data availability no data was used for the research described in the article 1 introduction in 1920 and 1923 nikolay zhukovsky reported one of the first analytical solutions obtained by the theory of holomorphic functions applied to steady phreatic seepage around a vertical cutoff wall in a homogeneous soil of a hydraulic conductivity k m day vedernikov 1939 and polubarinova kochina 1962 1977 hereafter abbreviated as pk 62 or pk 77 corrected and extended the zhukovsky solution in geotechnical engineering of dams protected by cutoffs the analysis is commonly limited to a relatively small scale of the vicinity of the wall in particular the hydraulic gradients which may cause seepage induced erosion see e g forchheimer 1930 his figs 78 79 ilyinsky and kacimov 1991 terzaghi and peck 1948 the tailwater is usually assumed to be ponded armanuos et al 2022 analyzed various types of cutoffs with the boundary condition of a constant piezometric head along the tailwater if the tailwater is empty and the reservoir water level h is not too high then a phreatic surface and capillary fringe above it form behind the cutoff in this case a large scale analysis is needed because waterlogging of the area adjacent to dams by the capillary fringe and the position of the water table are of concern kacimov et al a b indeed if the distance ybu in fig 1 is small then the foundation of the building is under threat fig 1 depicts a vertical cross section in which a cartesian coordinate system oxy has an abscissa and ordinate axes coinciding with a horizontal bed of the dam reservoir headwater and cutoff correspondingly we introduce a complex physical coordinate z x i y the darcian velocity specific discharge in terms of strack 1989 v x y obeys the relation v x y k h x y the piezometric head h x y is a harmonic function in the flow domain gz which is capped by abcdi d a the pressure head is introduced as p x y h y and therefore is also a harmonic function the tailwater bed o 1 o 2 is not ponded and there is no exfiltration upward through it i e all water seeped through ab percolates downward the free water level h in the reservoir is constant the cutoff is thin and impermeable pore water seeps in a steady state 2 d manner from a horizontal ray ab around a cut bco in gz soil is isotropic and homogeneous its hydraulic conductivity is k a free surface d di a is a capillary fringe boundary kacimov 2004 youngs 2012 the cutoff length s m is assumed to be high enough for the free surface d di a to have its apex d di positioned below point o 1 in fig 1a following vedernikov 1939 we assume that below the streamline d di a but above the water table dashed curve dia in fig 1 the pore water is under negative gage pressure i e hc p 0 where hc is a positive soil characteristic the height of capillary rise see also kacimov et al 2019 pk 62 77 vedernikov 1939 assumed that in the capillary fringe this zone is also called tension saturated all pores are occupied by water and hydraulic conductivity is still k above the capillary fringe pore water does not move see also silliman et al 2002 the hydrogeological condition under the reservoir point a at infinity in fig 1 determine two regimes of seepage without backwater v a k and with backwater v a 0 in this paper we start with an explicit solution to the case without backwater we complete the analysis by zhukovsky vedernikov and pk hereafter abbreviated as zh v pk of this fundamental problem in groundwater hydrology and geotechnical engineering section 2 1 in section 2 2 we present a new analytical solution for seepage with backwater for which the hodograph domain has an inflection point on the circle which images the free surface this solution has a free mathematical parameter a complex number which is practically fixed by detection of the position of the free surface in a piezometer located downstream of the cutoff we also examine a new seepage regime viz we discover an inverted tothian flow with a hinge point around which a saturated pore water circulates 2 analytical solutions in infinite physical domains we introduce a complex potential w φ iψ which is a holomorphic function of z where φ kh is the velocity potential and ψ is a stream function a complex darcian velocity is v u i v where u x y and v x y are the horizontal and vertical components of v such that the function u i v is holomorphic see pk 62 the zhukovsky function is defined as 2 0 θ θ 1 i θ 2 w i k z the function 2 0 is also holomorphic θ 1 re θ φ k y θ 2 im θ ψ k x obviously θ1 p 2 1 homage to vedernikov solution for seepage without backwater in this subsection we briefly present the vedernikov solution the boundary value problem bvp is formulated as following see pk 62 and mishra 2022 for more details 2 1 a b y 0 x 0 φ k h ψ 0 u 0 θ 1 k h θ 2 0 b c x 0 s y 0 ψ 0 u 0 v 0 θ 2 0 c x 0 y s v c d x 0 s y y d ψ 0 u 0 v 0 θ 2 0 d x 0 y y d v 0 d a y y d 0 x k h φ ψ 0 u 2 v 2 k v 0 θ 1 k h c θ 2 0 a z v k u 0 the upper boundary of the capillary fringe is a free surface i e the isobar and streamline ad its ordinate yd is to be found from eq 2 1 the complex potential domain is a quadrant gw depicted in fig 2 a the hodograph domain is shown in fig 2b and the zhukovsky function domain is a half strip g θ depicted in fig 2c gw and g θ are mapped onto each other via a lower half plane gζ i e ζ 0 in fig 2d of a reference variable ζ ξ iη with the correspondence of points a b 1 d 1 c c where the affix c is to be found the corresponding mapping functions are 2 2 w k h k h c y d h 2 ζ 1 2 3 θ k h h c π arcsin ζ k h h c 2 where the branch of the radical ζ 1 is positive at ζ 1 from eqns 2 2 and 2 3 z ζ is found directly the imaginary part of z ζ along bcd is 2 4 y ξ h h c π arcsin ξ h h c 2 h c y d h 2 ξ 1 1 ξ 1 that upon differentiation with respect to ξ yields 2 5 d y d ξ h h c π 1 ξ 2 h c y d h 2 2 ξ 1 1 ξ 1 at point c ξ c and the derivative 2 5 is zero therefore from eq 2 5 we get the affix c 2 6 c 1 8 h h c 2 π 2 h h c y d 2 we substitute ξ c into eq 2 4 and using the condition y c s with c defined in eq 2 6 we arrive at the following non linear equation 2 7 s 1 π arcsin 1 8 π 2 1 y d 2 1 2 1 2 2 1 y d 2 8 π 2 with respect to y d the starred variables are dimensionless all geometrical quantities in eq 2 7 are normalized to h hc vedernikov 1939 p 111 wrote in papers 70 71 i indicated how to find the position of the end of the tip unfortunately in my eq 15 in 70 71 i made an annoying typo in my paper 72 the typo is fixed we used the findroot routine of wolfram s 1991 mathematica to solve eq 2 7 1 1 here and below we used mathematica although matlab python or any other computer algebra software can be used all our mathematica codes are open and can be shared with interested readers the results are shown as y d s in fig 3 a the six discrete values y d evaluated by vedernikov 1939 his table 3 p 113 and replicated by pk 62 p 123 her table 6 fit our curve in fig 3a in particular y d 0 0 363 y d 0 211 0 these special values are shown in fig 3 as black points realized by the epilogue option of mathematica obviously y d is positive at 0 s 0 211 in fig 3b we use the mathematica routine of parametricplot and show the flow net for the case of dimensionless reservoir water level h 0 5 and cutoff s 0 4 from eq 2 7 y d 0 2314 then from eqs 2 2 2 3 we get z w where we separate the real and imaginary parts the complex potential starred quantities is normalized to k h hc solid lines in fig 3b are streamlines ψ 0 2 0 15 0 1 0 05 and 0 01 labeled p1 p5 correspondingly the streamline p5 almost coincides with the free surface the streamline p4 is pretty sigmoidal dashed curves e1 e7 in fig 3b are equipotential lines φ 0 05 0 2 0 35 0 5 0 65 0 8 and 0 95 correspondingly the contour e5 exemplifies the situation for which a nested piezometer drilled close to the cutoff on its downstream face would discover the same piezometric head at two different depths that may be erroneously interpreted as a quasi horizontal flow in fig 3c we plot a dimensionless normalized to k magnitude of the darcian velocity hydraulic gradient v as a function of the dimensionless potential piezometric head in the range 0 5 φ 2 along a streamline ψ 0 05 for the same h 0 5 and s as in fig 3b the maximum of the gradient v 8 06 attained at φ 0 544 is far above the save limit of 1 considered by pk 77 as an ultimate value of no erosion of a porous medium the minimum of the gradient is v 0 69 attained at φ 0 77 obviously the curve in fig 3c has a horizontal asymptote v 1 at φ that is consistent with the no backwater condition at point a in bvp 2 1 for example v 0 967 at φ 2 vedernikov 1939 pointed out that the found free surface da is a catenary kacimov and nicolaev 1992 found that catenary is a critical cavity boundary also simultaneously a stream line and isobar in seepage from a ponded soil surface 2 2 new solution for seepage with backwater in this subsection we investigate seepage with backwater into soil unbounded from below the bvp 2 1 holds except the conditions for the zhukovsky function and the condition at infinity the latter is transformed to a z v 0 u 0 instead of using the zhukovsky function below we engage the hodograph method pk 62 77 for the regime without backwater the hodograph domain gv was presented in fig 2b for seepage with backwater gv is shown in fig 4 a a circular cut diaf is the image of the free surface dia we recall it is a capillary fringe boundary which is both an isobar and streamline the position of cut s tip f in gv is unknown analogously pk 77 pp 182 186 reported solution to a problem of seepage from infinity towards a left bank of a rectangular channel with a partial cutoff lining of the channel bank in her solution the free surface phreatic line also had an inflection point inversion of the circular tetragon gv in fig 4a gives a standard polygon gλ a half plane with a horizontal cut difa in fig 4b where λ dz dw λ 1 i λ 2 the function λ z is also holomorphic the position of the inflection point f in gz as well as of the tip of the cut in gλ are unknown therefore the problem has a free parameter complex number in order to fix solution in seepage with backwater a point on the free boundary has to be fixed see pk 62 77 for details in other words at a certain horizontal distance xt from the cutoff a piezometer reads the position of the water table at point t viz yt fig 1 the affixes of points f and t in the reference half plane of fig 2d are f and t respectively we use the schwarz christoffel formula to map gλ onto gζ as 2 8 λ ς m 0 ς c ω f d ω ω 1 3 2 2 i m 0 ζ 2 f 1 ζ c 2 f 1 c where ω is a dummy variable of integration m 0 is a real mapping constant c is the affix of point c in fig 2d in eq 2 8 we selected the branch of the radical 1 ζ which is positive at ζ 1 consequently the radical is purely imaginary at ζ 1 2 2 one has to be cautious with selection of branches in a particular computer algebra package the parameters m 0 c f in eq 2 8 are to be found the mapping function of gw onto gζ is obviously the same as in subsection 2 1 i e is given by eq 2 2 integrating the differential d z λ ς d w d ζ d ζ we use eqs 2 2 and 2 8 and obtain 2 9 z ζ k h c y di h 2 2 ς 1 λ ω d ω ω 1 i k m 0 h c y di h 2 1 ζ 2 2 c 2 f 1 c ζ 1 2 f arccos ζ π we have five unknown constants ydi m 0 c f and t 1 c 1 1 f t they are found from the conditions z 1 i y di z c is z t x t iy t and imλ f l k which give the following system of non linear equations 2 10 k m 0 h c y di h 2 2 2 c 2 f 1 c 2 f π y di k m 0 h c y di h 2 1 c 2 2 c 2 f 1 c 1 c 2 f arccos c π s k m 0 h c y di h 2 t 2 1 2 f arccosh t x t k m 0 h c y di h 2 2 f π 2 c 2 f 1 c t 1 y t 2 m 0 c 2 f 1 c k we substitute m 0 found from the last equation of system 2 10 into the first four equations of this system next from the ratio of the third and fourth eqs 2 10 we express 2 f as function of c and t from the ratio of the first and fourth eqs 2 10 we define y di as function of c and t eventually we get a system of two non linear equations with respect to the two affixes c and t 2 11 y t 1 c 2 2 c r 1 c 1 c r arccos c π s r π 2 c r 1 c t 1 1 c h c y di h 2 2 c r r π 2 c r 1 c t 1 y t where r 2 f y t t 2 1 2 c x t 1 c t 1 π x t y t arccosh t 2 x t t 1 1 c y di y t r π 2 2 c r 1 c r π 2 c r 1 c t 1 system 2 11 is solved using the findroot routine of wolfram s 1991 mathematica fig 5 a shows the dimensionless phreatic lines y x plotted by the parametricplot of mathematica with the aspectratio of 1 5 as dimensional parameters we selected h 1 m hc 0 2 m k 10 2 m s s 5 m x t 5 m and y t 1 4 1 and 0 6 m curves 1 3 correspondingly for example for the third curve in fig 5a the roots of the system 2 10 are equal c 0 03782 t 1 44728 f 2 0854 ydi 0 389191 m km0 3 98039 the presence of an inflection point on each capillary fringe boundary in fig 5a is evident similarly to pk 77 her fig 102 p 154 the family of the found free surfaces is determined by backwater conditions at infinity in fig 5b the flow net is plotted for the case yt 0 6 m solid lines in fig 5b are dimensionless streamlines ψ 0 2 0 15 0 1 0 05 and 0 001 labeled p1 p5 correspondingly dashed curves e1 e9 in fig 5b are equipotential lines φ h h hc 0 01 h h hc 0 3 h h hc 0 6 0 05 0 2 0 35 0 5 0 65 and 0 8 correspondingly obviously the free surface in the regime with backwater is always higher than that for the case of no backwater i e da in fig 1 is always below dia in this subsection we have not used the zhukovsky plane as vedernikov 1939 and pk 52 62 77 have for the no backwater case the image of gz as a tetragon g θ is however sketched in fig 4c this polygon has a horizontal cut bpdi and can be mapped onto gζ by the schwarz christoffel formula similarly to what vedernikov 1939 did for the no backwater case it is evident from figs 1 and 4c that for seepage with backwater along any vertical ray r 1 r 2 with the origin at any point r 1 along the reservoir bed ab going down to infinity where groundwater is static the pressure head p increases from h to infinity we recall that in subsection 2 1 the pressure head in gz was everywhere bounded by the inequality hc p h that is evident from fig 2c 3 analytical solution for an anti hyporheic cell streamlines in the vicinity of the cutoff in section 2 see e g fig 3b have a sigmoidal shape see also vedernikov 1939 his fig 14a in this section we obtain an analytical solution to the problem of 2d seepage in the vertical plane of fig 6 a on the downstream side of the cutoff wall in fig 6 λ shaped streamlines turn around from above the so called hinge point m in regional groundwater hydrology toth 2009 found such points but with seepage flow paths making v shaped streamlines under m fig 6b sketches a segment m s mmc of the tothian soil surface conceptualized by him as an isobar p 0 along mmc water infiltrates into the soil and along mms pore water seeps out into the air point m separates a saturated ground surface into a commanding segment which is at a topographically higher elevation from a topographically lower subdued segment strack 1978 solved a flow problem for seepage through a phreatic line which also had commanding recharged and subdued discharged segments separated by hinge points like m in applications to geotechnical engineering we consider seepage in what we call an anti hyporheic cell gz u to be defined later in fig 6a standard seepage in hyporheic porous zones was studied by allan et al 2021 boano et al 2014 lautz and siegel 2006 packman et al 2004 sophocleous 2002 among others from the view points of ecohydrology sedimentology conjugation of groundwater vadose zone fluxes with ones in rivers etc what induces a relatively slow seepage in a standard hyporheic cell as compared with a relatively rapid flow of water in an open channel above this cell surface water flow in the channel with a permeable bed causes a drop of the piezometric head along the channel axis that generates a darcian flow in a subjacent porous medium in the anti hyporheic flow fig 6a we consider the flow pattern symmetric to one in kacimov 2006 who examined a low permeable porous depression where a darcian flow was induced by another darcian flow in a superjacent highly permeable aquifer in fig 6a a superjacent porous medium gz u is low permeable and seepage there is created by an intensive darcian flow in a subjacent highly permeable soil gz b a ray cx in fig 6a separates two porous zones geotechnically gz u can be considered as a concrete made apron of a dam under which water seeps from headwater to tailwater in application to the above mentioned al jifnain dam one of potential measures considered for forestalling mitigation of exfiltration of reservoir water downstream of the cutoff wall was compaction of the highly permeable alluvium that would cause formation of gz u above a coarse alluvium gz b beneath a compacted layer in fig 6a cartesian coordinates xcy are introduced in a vertical plane a complex physical coordinate z x i y is introduced in this section we ignore capillarity in both porous media having conductivities ku and kb kb ku the darcian velocities v u b x y obey the relation v u b x y k u b h u b the hydraulic heads hu b x y are harmonic functions in the dyad of flow domains gz u gz b we focus on flow in the upper domain gz u which is bounded from the left by an impermeable vertical wall cd in notations of section 2 below we consider a cutoff having s 0 that also corresponds to the case of a rectangular channel having lined banks and an infinite width b in notations of vedernikov 1935 see his fig 3 and vedernikov 1936 his fig 1 from below gz u is bounded by a horizontal segment cmn which is an interface between gz u and gz b from above our antihyporheic cell is bounded by a free phreatic surface dn position of points d and n are to be found a complex potential a holomorphic function of z w φ iψ is introduced in gz u similarly to section 2 we define the hydraulic head hu x y and the velocity potential φ kuhu a stream function ψ is again related to φ via the cauchy riemann conditions a complex darcian velocity is vu u iv where u x y and v x y are the horizontal and vertical components of v u point n in fig 6a is fiducial i e the piezometric head there is set to be hu 0 along dn φ kuy 0 i e p 0 the complex potential domain gw is sketched in fig 7 a the cutoff boundary and free surface make a streamline cdn along which we set ψ 0 along cm pore water ascends into gz u from gz b while along mn seepage descends to a coarser substratum the shape of cmn in gw is not known similarly to the case of gw shown in the lower panel of fig 219 in pk 62 at point m seepage in gz u makes an λ turn compare with u turns around tothian hinge points in fig 6b while in gw the stream function attains its minimum at m fig 7b the rate of in out flow in gz u is qah a part of solution along cmn u ui where ui ku 2 is a given constant this condition is mathematically similar to one in khan et al 1976 brock 1982 kacimov and obnosov 2015 obnosov and kacimov 2018 the hodograph domain gv is shown in fig 7b the image of dn is obviously an arc of a circle of a radius ku 2 centered at the point i ku 2 see pk 52 62 77 therefore gv in fig 7b is a circular triangle see vedernikov his fig 10 p 50 which pk 62 see her pp 286 237 and the upper panel of her fig 219 calls a modular one its angles at the vertices d and c infinity are π 2 and zero respectively exactly as in the triangle of pk 62 for her vertical dam problem the angle at point n is not zero the pk 62 special case in her fig 219 but is determined by intersection of the circle in gv with a straight line u ui fig 7b a standard conformal mapping of gw onto gv via a reference plane does not work because gw is not a standard or circular polygon similarly to khan et al 1976 and brock 1982 we formulate the bvp for two harmonic functions 3 1 δ φ x y 0 δ ψ x y 0 in the flow domain gz u at the boundaries of gz u 3 2 c m n φ u i x k u h c y 0 0 x x n n d ψ 0 φ k u y 0 d c ψ 0 x 0 0 y y d the first line in eq 3 2 is obtained by integration of the condition u ui along cmn a given constant hc is retrieved from an analytical or numerical solution for seepage problem in gz b in vedernikov s 1936 problem hc is a given depth of water in a lined channel in application to the al jifnain dam hc is the sum of the water level in the reservoir and the thickness of the upper alluvium layer across which the cutoff grouting is constructed the reservoir water level of this dam will when operated vary from 0 to about 10 m while the alluvium thickness varies from 0 to about 20 m below as an example we assume hc 6 m in our computations bvp 3 1 3 2 belongs to the class of hilbert problems for holomorphic functions gakhov 1966 henrici 1993 we recall that solution to hilbert s problem involves determination of two functions in a canonic reference domain usually half plane or circle the boundary conditions of alternating linear relations between the real and imaginary parts of these functions at various segments of the domain boundary are specified the behavior at transition points and at infinity stipulates the class in which we seek solution to problem 3 1 3 2 to solve bvp 3 1 3 2 the upper half of an auxiliary ς plane g ζ in fig 7c is conformally mapped onto the circular triangle g ω fig 8 a which is obtained by mirroring gv fig 4c with respect to the du axis in the plane ω u iv the function dw dz is holomorphic the correspondence of points in the reference plane g ζ is c m μ n 0 d 1 where the affix μ is to be found the upper half of an auxiliary ς plane g ζ in fig 7c is conformally mapped onto the circular triangle g ω in the plane ω u iv g ω and gv are symmetric with respect to the real axis in fig 8a first the triangle g ω fig 8a is mapped onto the triangle g ω fig 8b by the mőbius transformation 3 3 ω ω e i π 1 2 2 θ cot π θ ω n ω n i k u n u i cos π θ e i π θ θ 1 2 π arcsin 2 u i k u here n and n i k u are the complex coordinates of the points n and n respectively and π 1 2 2θ is the angle at the vertex n of the triangle g ω fig 8a in the ω plane we have a circular triangle with vertexes n d c 0 1 cotπθ e iπ 1 2 2θ and angles π δ0 π 1 2 2θ π δ1 π 2 π δ 0 respectively this triangle is mapped onto the upper half of the ζ plane by the function given by formulae 3 3 3 3 3 4 from koppenfels and stallman 1959 p 229 in the latter formula we changed the factor ς 1 2 2θ with the appropriate branch of the function ς1 2 2θ 3 4 ω ς r ς 1 2 2 θ f ς 1 2 θ f ς θ f ς θ f θ θ 1 2 2 θ ς where the branch of the function ς1 2 2θ is fixed in the upper half plane by the condition 0 arg ς π in eq 3 4 f stands for the hypergeometric function and r is a real constant to be found from the condition ω 1 1 the last condition follows from the requirement that in the reference plane the vertexes of g ω are imaged as following n d c 0 1 respectively the hypergeometric series in eq 3 4 are defined in the unit circle ς 1 these series can be continued into the vicinities of the points ς 1 and ς using formulas 15 3 6 and 15 3 13 from abramowitz and stegun 1970 namely we get 3 5 f ς θ γ 1 2 γ 1 2 2 θ γ 1 2 θ 2 f θ θ 1 2 1 ς γ 1 2 γ 1 2 2 θ γ θ 2 1 ς 1 2 f 1 2 θ 1 2 θ 3 2 1 ς 3 6 f ς θ γ 1 2 2 θ γ θ γ 1 2 θ ς θ n 0 θ n 1 2 θ n n 2 ς n ln ς 2 ψ n 1 ψ n θ ψ 1 2 θ n for ς 1 1 and ς 1 respectively here γ is the gamma function and ψ is the psi function abramowitz and stegun 1970 3 3 do not confuse it with the stream function ψ the branches of the functions 1 ς 1 2 and ς θ are fixed by the conditions arg 1 ς π and arg ς π respectively from the condition ω 1 1 and eqn 3 5 the constant r is 3 7 r f 1 θ f 1 1 2 θ γ 1 2 2 θ γ 1 θ 2 γ 3 2 2 θ γ 1 2 θ 2 the function 3 4 and its analytical continuations 3 5 3 6 with the parameter r determined by eqn 3 7 give the following correspondence of the angular points 0 1 n d c see figs 7c now the required conformal mapping of the upper half of the ς plane onto the triangle g ω is obtained as a superposition of the function ω ς and the inversion of function 3 3 3 8 ω ς n i k u ω ς c n ω ς c c n r ς 1 2 θ f ς 1 2 θ ς θ f ς θ r ς 1 2 θ f ς 1 2 θ c ς θ f ς θ here c e i π 1 2 θ cot π θ is the complex coordinate of the vertex c of the triangle g ω fig 8b and the equality n i k u c n u i e i π 1 2 θ sin π θ was taken into account next the following functions are introduced and analyzed 3 9 f ς d w d ς z ς d z d ς from the bvp 3 2 and representations 3 9 we have the following bvp for f ς and z ς 3 10 re f ξ u i z ξ 0 im z ξ 0 ξ 0 re f ξ i k u z ξ 0 im f ξ 0 0 ξ 1 re z ξ 0 im f ξ 0 1 ξ we used the relation ω ς f ς z ς and the properties of the function ω ς to show that if one of the two conditions 3 10 is satisfied then the other is also satisfied on each of the three intervals c n n d and d c in the reference plane thus bvp 3 10 is reduced to the following simpler one 3 11 im z 1 ξ 0 ξ 0 im ω ξ z 1 ξ 0 0 ξ 1 im z 1 ξ 0 1 ξ where 3 12 z 1 ς z ς 1 ς the radical 1 ς in eqn 3 12 is fixed in the upper half of the ς plane in the same manner as in eq 3 5 consider the following function 3 13 z 10 ς 1 c n r ς 1 2 θ f ς 1 2 θ c ς θ f ς θ both numerically and analytically we showed that function 3 13 satisfies the first and second conditions 3 11 for 1 ξ 0 and 0 ξ 1 respectively as for conditions 3 11 along the rays ξ 1 and ξ 1 it is an arduous task to check them analytically a numerical check however showed that both conditions are exactly met there let us now consider the ratio g ς z 1 ς z 10 ς of the required solution of problem 3 11 to the function 3 13 it is clear that g ς satisfies the homogeneous condition im g ξ 0 for ξ and therefore in congruity with the riemann schwartz symmetry principle can be analytically extended to the full plane it follows from the character of the conformal mapping see also fig 4 a d that z 1 ς in eqn 3 12 has integrable singularities at the points ς 0 and ς 1 at infinity the function z 1 ς has a simple zero also function 3 13 has a zero of order θ at the point ς 0 according to eqns 3 3 3 5 3 7 we have z 10 1 1 c n f 1 θ f 1 1 2 θ f 1 1 2 θ c f 1 θ f 1 θ 1 c n 1 n γ 1 2 γ 1 2 2 θ γ 1 2 θ 2 u i i sin π θ e i π θ cos π θ e i π θ γ 1 2 γ 1 2 2 θ γ 1 2 θ 2 u i cos 2 π θ 0 at infinity z 10 ς is bounded and is not zero indeed due to eqns 3 3 3 6 3 7 3 8 3 13 and the properties of the gamma and psi functions abramowitz and stegun 1970 eqns 6 1 17 and 6 3 7 the following asymptotics holds lim ς 1 n ς θ f ς θ lim ς cos π θ u i γ 1 2 2 θ γ θ γ 1 2 θ log ς 2 ψ 1 ψ θ ψ 1 2 θ lim ς r c n ς 1 2 θ f ς 1 2 θ lim ς sin π θ u i γ 1 2 2 θ γ 1 θ γ 1 2 θ γ 2 1 2 θ log ς 2 ψ 1 ψ θ ψ 1 2 θ π tan π θ cot π θ wherefrom lim ς z 10 ς γ 1 2 2 θ γ θ γ 1 2 θ cos 2 π θ u i sin π θ 0 thus the ratio g ς z 1 ς z 10 ς has utmost a first order pole at the point ς 0 and a removable singularity at the point ς 1 and g 0 in comport with the boundary condition im g ξ 0 and the generalized liouville theorem we have g ς a ς where a is a real parameter which will be defined later now the required solution of bvp 3 10 is written using eqns 3 12 3 13 the relation ω ς f ς z ς and eqn 6 3 14 f ς a 1 ς r ς 1 2 θ f ς 1 2 θ ς θ 1 f ς θ z ς a c n 1 ς r ς 1 2 θ f ς 1 2 θ c ς θ 1 f ς θ in accordance with eqns 3 9 and 3 14 and consistent with figs 7 a b it follows 3 15 w ς a ς 0 r τ 1 2 θ f τ 1 2 θ τ θ 1 f τ θ d τ 1 τ z ς a c n ς 1 r τ 1 2 θ f τ 1 2 θ c τ θ 1 f τ θ d τ 1 τ i y d the real constant a should be found from the complex potential domain gw in fig 7a i e using the condition w k u h c this condition leads to the following equation with respect to a 3 16 a 0 r τ 1 2 θ f τ 1 2 θ τ θ 1 f τ θ d τ 1 τ k u h c next we find the abscissa μ of the hinge point m from the condition im w μ 0 or remembering that w d w d z d w d ς d z d ς f z ω ς from an equivalent condition im ω μ 0 we use eqns 3 8 3 13 3 11 and take into account that both functions f ξ θ and f ξ 1 2 θ are real at ξ 0 see eqns 3 4 3 6 then the equation im ω μ 0 reduces to the following 3 17 r cos π θ μ 1 2 θ f μ 1 2 θ sin π θ μ θ f μ θ 0 the findroot routine of mathemaitca wolfram 1991 4 4 the programs in wolfram s mathematica in this section and in section 3 are open codes we can share them with the readers is used to determine the affix μ from eqn 3 17 next we find a from eqn 3 16 after that from the equality im w μ q ah we determine q ah i e the λ circulation flow rate through our cell 3 18 q ah k u h c 0 μ r cos π θ τ 1 2 θ f τ 1 2 θ sin π θ τ θ 1 f τ θ d τ 1 τ 0 r τ 1 2 θ f τ 1 2 θ τ θ 1 f τ θ d τ 1 τ from the condition z 0 xn and the second eqn 3 15 we find the ordinate and abscissa of the highest and the farthest points d and n on the phreatic surface fig 6a viz yd and xn 3 19 y d im a c n 0 1 r τ 1 2 θ f τ 1 2 θ c τ θ 1 f τ θ d τ τ 1 τ x n re a c n 0 1 r τ 1 2 θ f τ 1 2 θ c τ θ 1 f τ θ d τ 1 τ at 0 ξ 1 we separate the real and imaginary parts in the second eqn 3 15 and get a parametric equation of the whole phreatic surface dn 3 20 x ξ a u i ξ 1 r τ 1 2 θ sin 2 π θ f τ 1 2 θ τ θ 1 cos 2 π θ f τ θ 1 τ d τ y ξ y d a sin 2 π θ 2 u i ξ 1 r τ 1 2 θ f τ 1 2 θ τ θ 1 f τ θ 1 τ d τ fig 9 a shows the free surfaces for k u 0 048 m day and u i 0 016 0 012 0 008 m day curves 1 3 as this figure illustrates the increase of ui intensifies seepage in the anti hyporheic cell and makes it taller and wider similarly in standard hyporheic cells in porous river beds the u shaped circulation of darcian flows becomes stronger if the current in the river and its shearing action on the subjacent pore water gets stronger 5 5 we notice that ripples transversal minidunes and other bedforms are not necessary for existence of hyporheic cells which can emerge under a perfectly flat but tilted interface between surface and pore water solid lines in fig 9b are streamlines ψ 0 03 0 025 0 2 0 15 0 1 labeled p1 p5 correspondingly dashed curves e1 e6 in fig 9b are equipotential lines φ 0 1 0 12 0 14 0 16 0 18 and 0 19 correspondingly the anti hyporheic cell studied in section 3 can be added to the taxonomy of backwater formulated by vedernikov 1934 pp 51 52 pp 51 52 viz the very existence of gz u is determined by a strong horizontal seepage in a highly permeable substratum gz b fig 6a it is noteworthy that vedernikov 1939 p 54 his fig 14b sketched flow topology for seepage the mathematical description of which involves inertial terms these terms are commonly dropped in the darcian model that makes possible applying the concepts of ideall fluid flows see pk 62 77 an unusual flow topology is presented in our fig 6c where we zoomed vedernikov s fig 14b in an attached eddy on the downstream face of the cutoff the pore water keeps circulating along closed loops only one is shown in fig 6c the separatrix d 2 d 1 dd 2 has a triad of stagnation points d d 1 d 2 one internal stagnation point de is within the eddy demarcated by this separatrix 4 concluding remarks cutoff walls constructed by grouting or driven into soil as sheet pilings eliminate exfiltration of pore water from reservoirs of dams in particular cofferdams and by this reduce waterlogging of land adjacent to hydraulic structures with standing free water a free surface phreatic line or capillary fringe as the upper boundary of a saturated tension saturated zone should not outcrop at the tailwater of the dam we note that the backwater conditions deep under the cutoff and reservoir determine the regime of seepage only in a special case of no backwater was studied by zh v pk vedernikov s classification 1934 1939 of backwater regimes exemplifies exfiltration of seepage from a reservoir or channel into drains modeled by vedernikov as isobaric rays which are located below and away from the reservoir channel beds our new solution to the cutoff problem with backwater are obtained by the hodograph method in which the image of the capillary fringe boundary is a circular cut i e in the physical plane in the found family of these free surfaces they possess an inflection point hilbert s bvp 3 10 is solved in a reference half plane with the help of two holomorphic functions the derivatives of the complex physical coordinate and complex potential with respect to a reference variable along the bottom of the flow domain anti hyporheic cell the horizontal component of velocity is a given constant that is physically determined by the darcian flow in a subjacent highly permeable porous layer where a strong seepage flow is induced by a constant piezometric head in the dam reservoir upstream of the cutoff the riezenkmapf seepage force function can be easily reconstructed by computer algebra routines also hydrus2d modeling of this cell as well as numerical vedernikov s capillary fringes rather than phreatic lines can be easily found by solving the richards richardson pde rather the laplace equation in analytical modeling abbreviations 1 bvp boundary value problem 2 pk polubarinova kochina reference to one of the editions or translation of the book polubarinova kochina 1952 1962 or 1977 theory of ground water movement credit authorship contribution statement anvar kacimov conceptualization methodology software formal analysis investigation resources writing original draft writing review editing visualization project administration yurii obnosov conceptualization methodology software formal analysis investigation resources writing original draft writing review editing visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was funded by squ grants dr rg 17 ig vc wrc 21 01 ig agr swae 22 02 and supported by the kazan federal university strategic academic leadership program priority 2030 helpful comments and critique by two referees are appreciated appendix in this appendix we give a historical perspective of the problem of seepage around a cutoff 6 6 this appendix can be entitled exegesis to vedernikov s legacy the tailwater of many dams e g all dams in oman is empty and one of the main criteria in designing a cutoff bco in fig 1 is that water seeping from the headwater reservoir into tailwater does not exfiltrate upward but percolates downward for example the al jifnain dam in muscat oman was designed and is currently under construction in such a manner that s is high enough for the free surface to have its apex di positioned below the tailwater bottom line excessive values of s significantly increase the cost of the geotechnical structure albeit at insufficient s water exfiltrates and causes waterlogging of the area downstream of the cutoff wall also for too small s seepage induced erosion e g piping heaving etc see e g istomina 1957 of the soil in the vicinity of point o in fig 1a takes place therefore the dam may virtually collapse in his solution for seepage without backwater zhukovsky used two holomorophic functions viz the complex potential and a new function the real part of which is modulo a given constant pore pressure the second function since zhukovsky s work bears his name and is used along with the hamel riesenkampf verigin and strack asgian holomorphic functions for solving boundary value problems bvps for 2 d potential flows unfortunately in his solution zhukovsky erred in the scheme of seepage which he postulated vedernikov 1939 in his book chapter vii of the book is entitled about one work by prof n e zhukovsky acknowledged the value of the zhukovsky function for analytical studies of phreatic flows on zhukovsky s erroneous solution vedernikov 1939 p 110 wrote zhukovsky is wrong in assuming that the point of zero darcian velocity d in our fig 1 and vedernikov s notations coincides with the tip of the cutoff wall c in our and vedernikov s notations point d can not belong simultaneously to the free surface and to the tip of the cutoff wall and therefore there should be groundwater rise behind the cutoff wall we showed this in our papers 70 71 72 vedernikov 1935 wedernikov 1935 and vedernikov 1936 in our list of references and in fig 14a of this book it is noteworthy that zhukovsky s solution does not correspond to the flow scheme which he showed in his own fig 16 below i will revisit and correct zhukovsky s solution vedernikov 1939 emphasized the importance of reconstructing the flow nets mutually orthogonal streamlines and constant piezometric head contours which validate the analytical formulae obtained with the help of various holomorphic functions strack 1989 vedernikov 1939 pointed out that zhukovsky s results and physical model of capillarity of soils are also wrong specifically vedernikov developed a new model of a free surface groundwater flow with a capillary fringe boundary along which he assumed the gage pressure head to be a negative constant which charactrerizes capillary properties of the soil also he assumed that this boundary is a streamline i e no recharge or evaporation takes place from it later generalizations to the case of recharge evaporation along the free surface with rates which are constant in the x direction are analyzed in pk 77 and kacimov 2004 the vedernikov 1939 model was extended by bouwer and is widely used for obtaining analytical solutions to problems of saturated and tension saturated flows see e g youngs 2012 in most dams of a relatively small size the headwater and tailwater beds are at the same horizon the shape of an empty tailwater is not necessarily a horizontal ray o 1 o 2 our solution in section 2 is valid for an arbitrary dashed curve o 3 o 4 ground surface in fig 1 provided the free surface capillary fringe boundary does not intersect it vedernikov 1939 along with his analytical solution conducted sand box experiments see his fig 46 p 114 which evidenced that zhukovsky s schematization of seepage was incorrect after wwii polubarinova kochina prepared the original zhukovsky s papers published in 1890 1920 and 1923 to be included into the volumes iii and vii of collected works published in 1949 and 1950 she added vedernikov s correct solution to the original zhukovsky s writing with her special comments explaining zhukovsky s errors in her own book published in 1952 pp 120 123 see also the english 1962 translation of the original russian text polubarinova kochina presented the vedernikov 1939 solution indicating that the free surface capillary fringe boundary is a catenary pk 62 her eq 2 10 later in the second 1977 edition of her book polubarinova kochina presented the vedernikov solution in slightly different notations with annoying typos in the final formulae what is a limitation in the above mentioned zh v pk solutions all of them postulated seepage in soils with the bedrock conditions at infinity this term was used by de wiest in his translation of pk 62 see pp 139 140 vedernikov 1939 and pk in her books called such regime фильтрация без подпора that would be better translated as seepage without backwater for seepage from soil channels in this regime the free surfaces demarcating the saturated tension saturated zone have vertical asymptotes seepage with backwater is analysed in a special section of vedernikov s book 1939 pp 61 64 pp 61 64 with illustrations in his figs 20 23 vedernikov and pk called such regime фильтрация c подпором vedernikov 1934 p 51 p 51 wrote the most difficult regime of seepage is one with backwater along with the complexity of each particular case of such seepage a detailed study of flow in this regime involves considerably more basic schemes than the case of seepage without backwater seepage from reservoirs is most often with backwater later vedernikov 1939 p 111 wrote the condition at infinity assumed by prof zhukovsky was the same as along the phreatic surface that corresponds to a constant velocity v k in the vertical direction this condition is however valid for seepage without backwater фильтрация без подпора this seepage scheme for reservoirs is generally rare the sizes of reservoirs are commonly so large that seepage from them draws up high the water table if soil is unbounded the free surfaces spread to infinity in the horizontal direction for instance vedernikov 1935 illustrated that the capillary fringe boundaries for flow from soil channels into two layered soils have horizontal asymptotes provided the bottom layer is much coarser than the upper one the backwater is then caused by the capillarity of the upper layer similarly the backwater can be caused by static groundwater in the lower highly permeable substratum ilyinsky and kacimov 1992 kacimov and youngs 2005 or by a draining stratum pk 62 p 139 for a horizontal bedrock at a finite depth under a soil channel or dam reservoir fig 1 steady state seepage is obviously impossible unless draining entities see vedernikov 1934 1936 are introduced vedernikov s 1939 p 114 in his sandbox experiments drained the pore water seeped from a modeled reservoir into a downstream compartment of the box he wrote 1939 p 114 as an illustration in our fig 46c we present the results of only one sandbox experiments in our 1933 series the height of rise behind the cutoff is significant that corresponds to the experimental setup i e seepage with backwater vedernikov s fig 46 indicates the sizes of his sandbox and cutoff the locus of phreatic line and of a horizontal impervious bed of the sandbox for most real dams in particular the al jifnain one see e g https www strabag international com databases internet public content30 nsf web30 openagent id d0a8f77d11ca9445c125866f003c61f8 the low permeable layer caliche which creates backwater is at a finite depth of 3 8 m 
47,the problem of steady 2 d potential darcian flow from a flat bottomed reservoir of a coffer or other type of dam separated from an empty tailwater by an impermeable vertical sheet piling is one of the pillars in groundwater hydrology and soil mechanics analytical solutions to this problem are presented in the books by forchheimer zhukovsky vedernikov polubarinova kochina harr among others for the case of seepage with a phreatic line descending from the downstream face of the cutoff the formulae presented in classical textbooks despite the simplicity of conformal mappings of the complex potential quarter plane onto the zhukovsky half strip have lacunae and flaws we discuss and clean the mismatch in the abovementioned formulae the classical analytical solutions in the textbooks deal with the regime of no backwater for which the magnitude of the specific discharge vector at infinity coincides with hydraulic conductivity of the soil we obtain a general solution for most general flows with backwater for which the specific discharge at infinity is zero and the free surface has an inflection point in the physical plane the capillary fringe in the hodograph domain is imaged by a circular cut the pressure head infinitely deep under the cutoff wall is infinite a circular tetragon in the hodograph domain is conformally mapped onto the quadrant in the complex potential plane via a reference plane in the case with backwater one extra condition is needed to fix a mathematical solution for this purpose the location of a point on the free surface is fixed mathematically two affixes in the reference plane are found by solving a system of two nonlinear equations in the no backwater case only one affix is found and one equation is solved we also examine flow with a phreatic line in a low permeable layer e g concrete apron of a dam with an λ shaped topology of streamlines bounded from the left by a cutoff seepage from a dam reservoir through a subjacent highly permeable alluvium induces the pore water motion in the upper layer a hilbert boundary value problem is solved for the complex potential in this cell in the kirkham brock type boundary condition along the interface between the two layers the horizontal component of the specific discharge is constant phreatic surfaces rising on the downstream face of the cutoff caps λ shaped streamlines which turn around a hinge point on the interface between two layers of contrasting permeability keywords cutoff wall phreatic surface 2 d seepage analytical solution by complex potential hodograph method hilbert s boundary value problem data availability no data was used for the research described in the article 1 introduction in 1920 and 1923 nikolay zhukovsky reported one of the first analytical solutions obtained by the theory of holomorphic functions applied to steady phreatic seepage around a vertical cutoff wall in a homogeneous soil of a hydraulic conductivity k m day vedernikov 1939 and polubarinova kochina 1962 1977 hereafter abbreviated as pk 62 or pk 77 corrected and extended the zhukovsky solution in geotechnical engineering of dams protected by cutoffs the analysis is commonly limited to a relatively small scale of the vicinity of the wall in particular the hydraulic gradients which may cause seepage induced erosion see e g forchheimer 1930 his figs 78 79 ilyinsky and kacimov 1991 terzaghi and peck 1948 the tailwater is usually assumed to be ponded armanuos et al 2022 analyzed various types of cutoffs with the boundary condition of a constant piezometric head along the tailwater if the tailwater is empty and the reservoir water level h is not too high then a phreatic surface and capillary fringe above it form behind the cutoff in this case a large scale analysis is needed because waterlogging of the area adjacent to dams by the capillary fringe and the position of the water table are of concern kacimov et al a b indeed if the distance ybu in fig 1 is small then the foundation of the building is under threat fig 1 depicts a vertical cross section in which a cartesian coordinate system oxy has an abscissa and ordinate axes coinciding with a horizontal bed of the dam reservoir headwater and cutoff correspondingly we introduce a complex physical coordinate z x i y the darcian velocity specific discharge in terms of strack 1989 v x y obeys the relation v x y k h x y the piezometric head h x y is a harmonic function in the flow domain gz which is capped by abcdi d a the pressure head is introduced as p x y h y and therefore is also a harmonic function the tailwater bed o 1 o 2 is not ponded and there is no exfiltration upward through it i e all water seeped through ab percolates downward the free water level h in the reservoir is constant the cutoff is thin and impermeable pore water seeps in a steady state 2 d manner from a horizontal ray ab around a cut bco in gz soil is isotropic and homogeneous its hydraulic conductivity is k a free surface d di a is a capillary fringe boundary kacimov 2004 youngs 2012 the cutoff length s m is assumed to be high enough for the free surface d di a to have its apex d di positioned below point o 1 in fig 1a following vedernikov 1939 we assume that below the streamline d di a but above the water table dashed curve dia in fig 1 the pore water is under negative gage pressure i e hc p 0 where hc is a positive soil characteristic the height of capillary rise see also kacimov et al 2019 pk 62 77 vedernikov 1939 assumed that in the capillary fringe this zone is also called tension saturated all pores are occupied by water and hydraulic conductivity is still k above the capillary fringe pore water does not move see also silliman et al 2002 the hydrogeological condition under the reservoir point a at infinity in fig 1 determine two regimes of seepage without backwater v a k and with backwater v a 0 in this paper we start with an explicit solution to the case without backwater we complete the analysis by zhukovsky vedernikov and pk hereafter abbreviated as zh v pk of this fundamental problem in groundwater hydrology and geotechnical engineering section 2 1 in section 2 2 we present a new analytical solution for seepage with backwater for which the hodograph domain has an inflection point on the circle which images the free surface this solution has a free mathematical parameter a complex number which is practically fixed by detection of the position of the free surface in a piezometer located downstream of the cutoff we also examine a new seepage regime viz we discover an inverted tothian flow with a hinge point around which a saturated pore water circulates 2 analytical solutions in infinite physical domains we introduce a complex potential w φ iψ which is a holomorphic function of z where φ kh is the velocity potential and ψ is a stream function a complex darcian velocity is v u i v where u x y and v x y are the horizontal and vertical components of v such that the function u i v is holomorphic see pk 62 the zhukovsky function is defined as 2 0 θ θ 1 i θ 2 w i k z the function 2 0 is also holomorphic θ 1 re θ φ k y θ 2 im θ ψ k x obviously θ1 p 2 1 homage to vedernikov solution for seepage without backwater in this subsection we briefly present the vedernikov solution the boundary value problem bvp is formulated as following see pk 62 and mishra 2022 for more details 2 1 a b y 0 x 0 φ k h ψ 0 u 0 θ 1 k h θ 2 0 b c x 0 s y 0 ψ 0 u 0 v 0 θ 2 0 c x 0 y s v c d x 0 s y y d ψ 0 u 0 v 0 θ 2 0 d x 0 y y d v 0 d a y y d 0 x k h φ ψ 0 u 2 v 2 k v 0 θ 1 k h c θ 2 0 a z v k u 0 the upper boundary of the capillary fringe is a free surface i e the isobar and streamline ad its ordinate yd is to be found from eq 2 1 the complex potential domain is a quadrant gw depicted in fig 2 a the hodograph domain is shown in fig 2b and the zhukovsky function domain is a half strip g θ depicted in fig 2c gw and g θ are mapped onto each other via a lower half plane gζ i e ζ 0 in fig 2d of a reference variable ζ ξ iη with the correspondence of points a b 1 d 1 c c where the affix c is to be found the corresponding mapping functions are 2 2 w k h k h c y d h 2 ζ 1 2 3 θ k h h c π arcsin ζ k h h c 2 where the branch of the radical ζ 1 is positive at ζ 1 from eqns 2 2 and 2 3 z ζ is found directly the imaginary part of z ζ along bcd is 2 4 y ξ h h c π arcsin ξ h h c 2 h c y d h 2 ξ 1 1 ξ 1 that upon differentiation with respect to ξ yields 2 5 d y d ξ h h c π 1 ξ 2 h c y d h 2 2 ξ 1 1 ξ 1 at point c ξ c and the derivative 2 5 is zero therefore from eq 2 5 we get the affix c 2 6 c 1 8 h h c 2 π 2 h h c y d 2 we substitute ξ c into eq 2 4 and using the condition y c s with c defined in eq 2 6 we arrive at the following non linear equation 2 7 s 1 π arcsin 1 8 π 2 1 y d 2 1 2 1 2 2 1 y d 2 8 π 2 with respect to y d the starred variables are dimensionless all geometrical quantities in eq 2 7 are normalized to h hc vedernikov 1939 p 111 wrote in papers 70 71 i indicated how to find the position of the end of the tip unfortunately in my eq 15 in 70 71 i made an annoying typo in my paper 72 the typo is fixed we used the findroot routine of wolfram s 1991 mathematica to solve eq 2 7 1 1 here and below we used mathematica although matlab python or any other computer algebra software can be used all our mathematica codes are open and can be shared with interested readers the results are shown as y d s in fig 3 a the six discrete values y d evaluated by vedernikov 1939 his table 3 p 113 and replicated by pk 62 p 123 her table 6 fit our curve in fig 3a in particular y d 0 0 363 y d 0 211 0 these special values are shown in fig 3 as black points realized by the epilogue option of mathematica obviously y d is positive at 0 s 0 211 in fig 3b we use the mathematica routine of parametricplot and show the flow net for the case of dimensionless reservoir water level h 0 5 and cutoff s 0 4 from eq 2 7 y d 0 2314 then from eqs 2 2 2 3 we get z w where we separate the real and imaginary parts the complex potential starred quantities is normalized to k h hc solid lines in fig 3b are streamlines ψ 0 2 0 15 0 1 0 05 and 0 01 labeled p1 p5 correspondingly the streamline p5 almost coincides with the free surface the streamline p4 is pretty sigmoidal dashed curves e1 e7 in fig 3b are equipotential lines φ 0 05 0 2 0 35 0 5 0 65 0 8 and 0 95 correspondingly the contour e5 exemplifies the situation for which a nested piezometer drilled close to the cutoff on its downstream face would discover the same piezometric head at two different depths that may be erroneously interpreted as a quasi horizontal flow in fig 3c we plot a dimensionless normalized to k magnitude of the darcian velocity hydraulic gradient v as a function of the dimensionless potential piezometric head in the range 0 5 φ 2 along a streamline ψ 0 05 for the same h 0 5 and s as in fig 3b the maximum of the gradient v 8 06 attained at φ 0 544 is far above the save limit of 1 considered by pk 77 as an ultimate value of no erosion of a porous medium the minimum of the gradient is v 0 69 attained at φ 0 77 obviously the curve in fig 3c has a horizontal asymptote v 1 at φ that is consistent with the no backwater condition at point a in bvp 2 1 for example v 0 967 at φ 2 vedernikov 1939 pointed out that the found free surface da is a catenary kacimov and nicolaev 1992 found that catenary is a critical cavity boundary also simultaneously a stream line and isobar in seepage from a ponded soil surface 2 2 new solution for seepage with backwater in this subsection we investigate seepage with backwater into soil unbounded from below the bvp 2 1 holds except the conditions for the zhukovsky function and the condition at infinity the latter is transformed to a z v 0 u 0 instead of using the zhukovsky function below we engage the hodograph method pk 62 77 for the regime without backwater the hodograph domain gv was presented in fig 2b for seepage with backwater gv is shown in fig 4 a a circular cut diaf is the image of the free surface dia we recall it is a capillary fringe boundary which is both an isobar and streamline the position of cut s tip f in gv is unknown analogously pk 77 pp 182 186 reported solution to a problem of seepage from infinity towards a left bank of a rectangular channel with a partial cutoff lining of the channel bank in her solution the free surface phreatic line also had an inflection point inversion of the circular tetragon gv in fig 4a gives a standard polygon gλ a half plane with a horizontal cut difa in fig 4b where λ dz dw λ 1 i λ 2 the function λ z is also holomorphic the position of the inflection point f in gz as well as of the tip of the cut in gλ are unknown therefore the problem has a free parameter complex number in order to fix solution in seepage with backwater a point on the free boundary has to be fixed see pk 62 77 for details in other words at a certain horizontal distance xt from the cutoff a piezometer reads the position of the water table at point t viz yt fig 1 the affixes of points f and t in the reference half plane of fig 2d are f and t respectively we use the schwarz christoffel formula to map gλ onto gζ as 2 8 λ ς m 0 ς c ω f d ω ω 1 3 2 2 i m 0 ζ 2 f 1 ζ c 2 f 1 c where ω is a dummy variable of integration m 0 is a real mapping constant c is the affix of point c in fig 2d in eq 2 8 we selected the branch of the radical 1 ζ which is positive at ζ 1 consequently the radical is purely imaginary at ζ 1 2 2 one has to be cautious with selection of branches in a particular computer algebra package the parameters m 0 c f in eq 2 8 are to be found the mapping function of gw onto gζ is obviously the same as in subsection 2 1 i e is given by eq 2 2 integrating the differential d z λ ς d w d ζ d ζ we use eqs 2 2 and 2 8 and obtain 2 9 z ζ k h c y di h 2 2 ς 1 λ ω d ω ω 1 i k m 0 h c y di h 2 1 ζ 2 2 c 2 f 1 c ζ 1 2 f arccos ζ π we have five unknown constants ydi m 0 c f and t 1 c 1 1 f t they are found from the conditions z 1 i y di z c is z t x t iy t and imλ f l k which give the following system of non linear equations 2 10 k m 0 h c y di h 2 2 2 c 2 f 1 c 2 f π y di k m 0 h c y di h 2 1 c 2 2 c 2 f 1 c 1 c 2 f arccos c π s k m 0 h c y di h 2 t 2 1 2 f arccosh t x t k m 0 h c y di h 2 2 f π 2 c 2 f 1 c t 1 y t 2 m 0 c 2 f 1 c k we substitute m 0 found from the last equation of system 2 10 into the first four equations of this system next from the ratio of the third and fourth eqs 2 10 we express 2 f as function of c and t from the ratio of the first and fourth eqs 2 10 we define y di as function of c and t eventually we get a system of two non linear equations with respect to the two affixes c and t 2 11 y t 1 c 2 2 c r 1 c 1 c r arccos c π s r π 2 c r 1 c t 1 1 c h c y di h 2 2 c r r π 2 c r 1 c t 1 y t where r 2 f y t t 2 1 2 c x t 1 c t 1 π x t y t arccosh t 2 x t t 1 1 c y di y t r π 2 2 c r 1 c r π 2 c r 1 c t 1 system 2 11 is solved using the findroot routine of wolfram s 1991 mathematica fig 5 a shows the dimensionless phreatic lines y x plotted by the parametricplot of mathematica with the aspectratio of 1 5 as dimensional parameters we selected h 1 m hc 0 2 m k 10 2 m s s 5 m x t 5 m and y t 1 4 1 and 0 6 m curves 1 3 correspondingly for example for the third curve in fig 5a the roots of the system 2 10 are equal c 0 03782 t 1 44728 f 2 0854 ydi 0 389191 m km0 3 98039 the presence of an inflection point on each capillary fringe boundary in fig 5a is evident similarly to pk 77 her fig 102 p 154 the family of the found free surfaces is determined by backwater conditions at infinity in fig 5b the flow net is plotted for the case yt 0 6 m solid lines in fig 5b are dimensionless streamlines ψ 0 2 0 15 0 1 0 05 and 0 001 labeled p1 p5 correspondingly dashed curves e1 e9 in fig 5b are equipotential lines φ h h hc 0 01 h h hc 0 3 h h hc 0 6 0 05 0 2 0 35 0 5 0 65 and 0 8 correspondingly obviously the free surface in the regime with backwater is always higher than that for the case of no backwater i e da in fig 1 is always below dia in this subsection we have not used the zhukovsky plane as vedernikov 1939 and pk 52 62 77 have for the no backwater case the image of gz as a tetragon g θ is however sketched in fig 4c this polygon has a horizontal cut bpdi and can be mapped onto gζ by the schwarz christoffel formula similarly to what vedernikov 1939 did for the no backwater case it is evident from figs 1 and 4c that for seepage with backwater along any vertical ray r 1 r 2 with the origin at any point r 1 along the reservoir bed ab going down to infinity where groundwater is static the pressure head p increases from h to infinity we recall that in subsection 2 1 the pressure head in gz was everywhere bounded by the inequality hc p h that is evident from fig 2c 3 analytical solution for an anti hyporheic cell streamlines in the vicinity of the cutoff in section 2 see e g fig 3b have a sigmoidal shape see also vedernikov 1939 his fig 14a in this section we obtain an analytical solution to the problem of 2d seepage in the vertical plane of fig 6 a on the downstream side of the cutoff wall in fig 6 λ shaped streamlines turn around from above the so called hinge point m in regional groundwater hydrology toth 2009 found such points but with seepage flow paths making v shaped streamlines under m fig 6b sketches a segment m s mmc of the tothian soil surface conceptualized by him as an isobar p 0 along mmc water infiltrates into the soil and along mms pore water seeps out into the air point m separates a saturated ground surface into a commanding segment which is at a topographically higher elevation from a topographically lower subdued segment strack 1978 solved a flow problem for seepage through a phreatic line which also had commanding recharged and subdued discharged segments separated by hinge points like m in applications to geotechnical engineering we consider seepage in what we call an anti hyporheic cell gz u to be defined later in fig 6a standard seepage in hyporheic porous zones was studied by allan et al 2021 boano et al 2014 lautz and siegel 2006 packman et al 2004 sophocleous 2002 among others from the view points of ecohydrology sedimentology conjugation of groundwater vadose zone fluxes with ones in rivers etc what induces a relatively slow seepage in a standard hyporheic cell as compared with a relatively rapid flow of water in an open channel above this cell surface water flow in the channel with a permeable bed causes a drop of the piezometric head along the channel axis that generates a darcian flow in a subjacent porous medium in the anti hyporheic flow fig 6a we consider the flow pattern symmetric to one in kacimov 2006 who examined a low permeable porous depression where a darcian flow was induced by another darcian flow in a superjacent highly permeable aquifer in fig 6a a superjacent porous medium gz u is low permeable and seepage there is created by an intensive darcian flow in a subjacent highly permeable soil gz b a ray cx in fig 6a separates two porous zones geotechnically gz u can be considered as a concrete made apron of a dam under which water seeps from headwater to tailwater in application to the above mentioned al jifnain dam one of potential measures considered for forestalling mitigation of exfiltration of reservoir water downstream of the cutoff wall was compaction of the highly permeable alluvium that would cause formation of gz u above a coarse alluvium gz b beneath a compacted layer in fig 6a cartesian coordinates xcy are introduced in a vertical plane a complex physical coordinate z x i y is introduced in this section we ignore capillarity in both porous media having conductivities ku and kb kb ku the darcian velocities v u b x y obey the relation v u b x y k u b h u b the hydraulic heads hu b x y are harmonic functions in the dyad of flow domains gz u gz b we focus on flow in the upper domain gz u which is bounded from the left by an impermeable vertical wall cd in notations of section 2 below we consider a cutoff having s 0 that also corresponds to the case of a rectangular channel having lined banks and an infinite width b in notations of vedernikov 1935 see his fig 3 and vedernikov 1936 his fig 1 from below gz u is bounded by a horizontal segment cmn which is an interface between gz u and gz b from above our antihyporheic cell is bounded by a free phreatic surface dn position of points d and n are to be found a complex potential a holomorphic function of z w φ iψ is introduced in gz u similarly to section 2 we define the hydraulic head hu x y and the velocity potential φ kuhu a stream function ψ is again related to φ via the cauchy riemann conditions a complex darcian velocity is vu u iv where u x y and v x y are the horizontal and vertical components of v u point n in fig 6a is fiducial i e the piezometric head there is set to be hu 0 along dn φ kuy 0 i e p 0 the complex potential domain gw is sketched in fig 7 a the cutoff boundary and free surface make a streamline cdn along which we set ψ 0 along cm pore water ascends into gz u from gz b while along mn seepage descends to a coarser substratum the shape of cmn in gw is not known similarly to the case of gw shown in the lower panel of fig 219 in pk 62 at point m seepage in gz u makes an λ turn compare with u turns around tothian hinge points in fig 6b while in gw the stream function attains its minimum at m fig 7b the rate of in out flow in gz u is qah a part of solution along cmn u ui where ui ku 2 is a given constant this condition is mathematically similar to one in khan et al 1976 brock 1982 kacimov and obnosov 2015 obnosov and kacimov 2018 the hodograph domain gv is shown in fig 7b the image of dn is obviously an arc of a circle of a radius ku 2 centered at the point i ku 2 see pk 52 62 77 therefore gv in fig 7b is a circular triangle see vedernikov his fig 10 p 50 which pk 62 see her pp 286 237 and the upper panel of her fig 219 calls a modular one its angles at the vertices d and c infinity are π 2 and zero respectively exactly as in the triangle of pk 62 for her vertical dam problem the angle at point n is not zero the pk 62 special case in her fig 219 but is determined by intersection of the circle in gv with a straight line u ui fig 7b a standard conformal mapping of gw onto gv via a reference plane does not work because gw is not a standard or circular polygon similarly to khan et al 1976 and brock 1982 we formulate the bvp for two harmonic functions 3 1 δ φ x y 0 δ ψ x y 0 in the flow domain gz u at the boundaries of gz u 3 2 c m n φ u i x k u h c y 0 0 x x n n d ψ 0 φ k u y 0 d c ψ 0 x 0 0 y y d the first line in eq 3 2 is obtained by integration of the condition u ui along cmn a given constant hc is retrieved from an analytical or numerical solution for seepage problem in gz b in vedernikov s 1936 problem hc is a given depth of water in a lined channel in application to the al jifnain dam hc is the sum of the water level in the reservoir and the thickness of the upper alluvium layer across which the cutoff grouting is constructed the reservoir water level of this dam will when operated vary from 0 to about 10 m while the alluvium thickness varies from 0 to about 20 m below as an example we assume hc 6 m in our computations bvp 3 1 3 2 belongs to the class of hilbert problems for holomorphic functions gakhov 1966 henrici 1993 we recall that solution to hilbert s problem involves determination of two functions in a canonic reference domain usually half plane or circle the boundary conditions of alternating linear relations between the real and imaginary parts of these functions at various segments of the domain boundary are specified the behavior at transition points and at infinity stipulates the class in which we seek solution to problem 3 1 3 2 to solve bvp 3 1 3 2 the upper half of an auxiliary ς plane g ζ in fig 7c is conformally mapped onto the circular triangle g ω fig 8 a which is obtained by mirroring gv fig 4c with respect to the du axis in the plane ω u iv the function dw dz is holomorphic the correspondence of points in the reference plane g ζ is c m μ n 0 d 1 where the affix μ is to be found the upper half of an auxiliary ς plane g ζ in fig 7c is conformally mapped onto the circular triangle g ω in the plane ω u iv g ω and gv are symmetric with respect to the real axis in fig 8a first the triangle g ω fig 8a is mapped onto the triangle g ω fig 8b by the mőbius transformation 3 3 ω ω e i π 1 2 2 θ cot π θ ω n ω n i k u n u i cos π θ e i π θ θ 1 2 π arcsin 2 u i k u here n and n i k u are the complex coordinates of the points n and n respectively and π 1 2 2θ is the angle at the vertex n of the triangle g ω fig 8a in the ω plane we have a circular triangle with vertexes n d c 0 1 cotπθ e iπ 1 2 2θ and angles π δ0 π 1 2 2θ π δ1 π 2 π δ 0 respectively this triangle is mapped onto the upper half of the ζ plane by the function given by formulae 3 3 3 3 3 4 from koppenfels and stallman 1959 p 229 in the latter formula we changed the factor ς 1 2 2θ with the appropriate branch of the function ς1 2 2θ 3 4 ω ς r ς 1 2 2 θ f ς 1 2 θ f ς θ f ς θ f θ θ 1 2 2 θ ς where the branch of the function ς1 2 2θ is fixed in the upper half plane by the condition 0 arg ς π in eq 3 4 f stands for the hypergeometric function and r is a real constant to be found from the condition ω 1 1 the last condition follows from the requirement that in the reference plane the vertexes of g ω are imaged as following n d c 0 1 respectively the hypergeometric series in eq 3 4 are defined in the unit circle ς 1 these series can be continued into the vicinities of the points ς 1 and ς using formulas 15 3 6 and 15 3 13 from abramowitz and stegun 1970 namely we get 3 5 f ς θ γ 1 2 γ 1 2 2 θ γ 1 2 θ 2 f θ θ 1 2 1 ς γ 1 2 γ 1 2 2 θ γ θ 2 1 ς 1 2 f 1 2 θ 1 2 θ 3 2 1 ς 3 6 f ς θ γ 1 2 2 θ γ θ γ 1 2 θ ς θ n 0 θ n 1 2 θ n n 2 ς n ln ς 2 ψ n 1 ψ n θ ψ 1 2 θ n for ς 1 1 and ς 1 respectively here γ is the gamma function and ψ is the psi function abramowitz and stegun 1970 3 3 do not confuse it with the stream function ψ the branches of the functions 1 ς 1 2 and ς θ are fixed by the conditions arg 1 ς π and arg ς π respectively from the condition ω 1 1 and eqn 3 5 the constant r is 3 7 r f 1 θ f 1 1 2 θ γ 1 2 2 θ γ 1 θ 2 γ 3 2 2 θ γ 1 2 θ 2 the function 3 4 and its analytical continuations 3 5 3 6 with the parameter r determined by eqn 3 7 give the following correspondence of the angular points 0 1 n d c see figs 7c now the required conformal mapping of the upper half of the ς plane onto the triangle g ω is obtained as a superposition of the function ω ς and the inversion of function 3 3 3 8 ω ς n i k u ω ς c n ω ς c c n r ς 1 2 θ f ς 1 2 θ ς θ f ς θ r ς 1 2 θ f ς 1 2 θ c ς θ f ς θ here c e i π 1 2 θ cot π θ is the complex coordinate of the vertex c of the triangle g ω fig 8b and the equality n i k u c n u i e i π 1 2 θ sin π θ was taken into account next the following functions are introduced and analyzed 3 9 f ς d w d ς z ς d z d ς from the bvp 3 2 and representations 3 9 we have the following bvp for f ς and z ς 3 10 re f ξ u i z ξ 0 im z ξ 0 ξ 0 re f ξ i k u z ξ 0 im f ξ 0 0 ξ 1 re z ξ 0 im f ξ 0 1 ξ we used the relation ω ς f ς z ς and the properties of the function ω ς to show that if one of the two conditions 3 10 is satisfied then the other is also satisfied on each of the three intervals c n n d and d c in the reference plane thus bvp 3 10 is reduced to the following simpler one 3 11 im z 1 ξ 0 ξ 0 im ω ξ z 1 ξ 0 0 ξ 1 im z 1 ξ 0 1 ξ where 3 12 z 1 ς z ς 1 ς the radical 1 ς in eqn 3 12 is fixed in the upper half of the ς plane in the same manner as in eq 3 5 consider the following function 3 13 z 10 ς 1 c n r ς 1 2 θ f ς 1 2 θ c ς θ f ς θ both numerically and analytically we showed that function 3 13 satisfies the first and second conditions 3 11 for 1 ξ 0 and 0 ξ 1 respectively as for conditions 3 11 along the rays ξ 1 and ξ 1 it is an arduous task to check them analytically a numerical check however showed that both conditions are exactly met there let us now consider the ratio g ς z 1 ς z 10 ς of the required solution of problem 3 11 to the function 3 13 it is clear that g ς satisfies the homogeneous condition im g ξ 0 for ξ and therefore in congruity with the riemann schwartz symmetry principle can be analytically extended to the full plane it follows from the character of the conformal mapping see also fig 4 a d that z 1 ς in eqn 3 12 has integrable singularities at the points ς 0 and ς 1 at infinity the function z 1 ς has a simple zero also function 3 13 has a zero of order θ at the point ς 0 according to eqns 3 3 3 5 3 7 we have z 10 1 1 c n f 1 θ f 1 1 2 θ f 1 1 2 θ c f 1 θ f 1 θ 1 c n 1 n γ 1 2 γ 1 2 2 θ γ 1 2 θ 2 u i i sin π θ e i π θ cos π θ e i π θ γ 1 2 γ 1 2 2 θ γ 1 2 θ 2 u i cos 2 π θ 0 at infinity z 10 ς is bounded and is not zero indeed due to eqns 3 3 3 6 3 7 3 8 3 13 and the properties of the gamma and psi functions abramowitz and stegun 1970 eqns 6 1 17 and 6 3 7 the following asymptotics holds lim ς 1 n ς θ f ς θ lim ς cos π θ u i γ 1 2 2 θ γ θ γ 1 2 θ log ς 2 ψ 1 ψ θ ψ 1 2 θ lim ς r c n ς 1 2 θ f ς 1 2 θ lim ς sin π θ u i γ 1 2 2 θ γ 1 θ γ 1 2 θ γ 2 1 2 θ log ς 2 ψ 1 ψ θ ψ 1 2 θ π tan π θ cot π θ wherefrom lim ς z 10 ς γ 1 2 2 θ γ θ γ 1 2 θ cos 2 π θ u i sin π θ 0 thus the ratio g ς z 1 ς z 10 ς has utmost a first order pole at the point ς 0 and a removable singularity at the point ς 1 and g 0 in comport with the boundary condition im g ξ 0 and the generalized liouville theorem we have g ς a ς where a is a real parameter which will be defined later now the required solution of bvp 3 10 is written using eqns 3 12 3 13 the relation ω ς f ς z ς and eqn 6 3 14 f ς a 1 ς r ς 1 2 θ f ς 1 2 θ ς θ 1 f ς θ z ς a c n 1 ς r ς 1 2 θ f ς 1 2 θ c ς θ 1 f ς θ in accordance with eqns 3 9 and 3 14 and consistent with figs 7 a b it follows 3 15 w ς a ς 0 r τ 1 2 θ f τ 1 2 θ τ θ 1 f τ θ d τ 1 τ z ς a c n ς 1 r τ 1 2 θ f τ 1 2 θ c τ θ 1 f τ θ d τ 1 τ i y d the real constant a should be found from the complex potential domain gw in fig 7a i e using the condition w k u h c this condition leads to the following equation with respect to a 3 16 a 0 r τ 1 2 θ f τ 1 2 θ τ θ 1 f τ θ d τ 1 τ k u h c next we find the abscissa μ of the hinge point m from the condition im w μ 0 or remembering that w d w d z d w d ς d z d ς f z ω ς from an equivalent condition im ω μ 0 we use eqns 3 8 3 13 3 11 and take into account that both functions f ξ θ and f ξ 1 2 θ are real at ξ 0 see eqns 3 4 3 6 then the equation im ω μ 0 reduces to the following 3 17 r cos π θ μ 1 2 θ f μ 1 2 θ sin π θ μ θ f μ θ 0 the findroot routine of mathemaitca wolfram 1991 4 4 the programs in wolfram s mathematica in this section and in section 3 are open codes we can share them with the readers is used to determine the affix μ from eqn 3 17 next we find a from eqn 3 16 after that from the equality im w μ q ah we determine q ah i e the λ circulation flow rate through our cell 3 18 q ah k u h c 0 μ r cos π θ τ 1 2 θ f τ 1 2 θ sin π θ τ θ 1 f τ θ d τ 1 τ 0 r τ 1 2 θ f τ 1 2 θ τ θ 1 f τ θ d τ 1 τ from the condition z 0 xn and the second eqn 3 15 we find the ordinate and abscissa of the highest and the farthest points d and n on the phreatic surface fig 6a viz yd and xn 3 19 y d im a c n 0 1 r τ 1 2 θ f τ 1 2 θ c τ θ 1 f τ θ d τ τ 1 τ x n re a c n 0 1 r τ 1 2 θ f τ 1 2 θ c τ θ 1 f τ θ d τ 1 τ at 0 ξ 1 we separate the real and imaginary parts in the second eqn 3 15 and get a parametric equation of the whole phreatic surface dn 3 20 x ξ a u i ξ 1 r τ 1 2 θ sin 2 π θ f τ 1 2 θ τ θ 1 cos 2 π θ f τ θ 1 τ d τ y ξ y d a sin 2 π θ 2 u i ξ 1 r τ 1 2 θ f τ 1 2 θ τ θ 1 f τ θ 1 τ d τ fig 9 a shows the free surfaces for k u 0 048 m day and u i 0 016 0 012 0 008 m day curves 1 3 as this figure illustrates the increase of ui intensifies seepage in the anti hyporheic cell and makes it taller and wider similarly in standard hyporheic cells in porous river beds the u shaped circulation of darcian flows becomes stronger if the current in the river and its shearing action on the subjacent pore water gets stronger 5 5 we notice that ripples transversal minidunes and other bedforms are not necessary for existence of hyporheic cells which can emerge under a perfectly flat but tilted interface between surface and pore water solid lines in fig 9b are streamlines ψ 0 03 0 025 0 2 0 15 0 1 labeled p1 p5 correspondingly dashed curves e1 e6 in fig 9b are equipotential lines φ 0 1 0 12 0 14 0 16 0 18 and 0 19 correspondingly the anti hyporheic cell studied in section 3 can be added to the taxonomy of backwater formulated by vedernikov 1934 pp 51 52 pp 51 52 viz the very existence of gz u is determined by a strong horizontal seepage in a highly permeable substratum gz b fig 6a it is noteworthy that vedernikov 1939 p 54 his fig 14b sketched flow topology for seepage the mathematical description of which involves inertial terms these terms are commonly dropped in the darcian model that makes possible applying the concepts of ideall fluid flows see pk 62 77 an unusual flow topology is presented in our fig 6c where we zoomed vedernikov s fig 14b in an attached eddy on the downstream face of the cutoff the pore water keeps circulating along closed loops only one is shown in fig 6c the separatrix d 2 d 1 dd 2 has a triad of stagnation points d d 1 d 2 one internal stagnation point de is within the eddy demarcated by this separatrix 4 concluding remarks cutoff walls constructed by grouting or driven into soil as sheet pilings eliminate exfiltration of pore water from reservoirs of dams in particular cofferdams and by this reduce waterlogging of land adjacent to hydraulic structures with standing free water a free surface phreatic line or capillary fringe as the upper boundary of a saturated tension saturated zone should not outcrop at the tailwater of the dam we note that the backwater conditions deep under the cutoff and reservoir determine the regime of seepage only in a special case of no backwater was studied by zh v pk vedernikov s classification 1934 1939 of backwater regimes exemplifies exfiltration of seepage from a reservoir or channel into drains modeled by vedernikov as isobaric rays which are located below and away from the reservoir channel beds our new solution to the cutoff problem with backwater are obtained by the hodograph method in which the image of the capillary fringe boundary is a circular cut i e in the physical plane in the found family of these free surfaces they possess an inflection point hilbert s bvp 3 10 is solved in a reference half plane with the help of two holomorphic functions the derivatives of the complex physical coordinate and complex potential with respect to a reference variable along the bottom of the flow domain anti hyporheic cell the horizontal component of velocity is a given constant that is physically determined by the darcian flow in a subjacent highly permeable porous layer where a strong seepage flow is induced by a constant piezometric head in the dam reservoir upstream of the cutoff the riezenkmapf seepage force function can be easily reconstructed by computer algebra routines also hydrus2d modeling of this cell as well as numerical vedernikov s capillary fringes rather than phreatic lines can be easily found by solving the richards richardson pde rather the laplace equation in analytical modeling abbreviations 1 bvp boundary value problem 2 pk polubarinova kochina reference to one of the editions or translation of the book polubarinova kochina 1952 1962 or 1977 theory of ground water movement credit authorship contribution statement anvar kacimov conceptualization methodology software formal analysis investigation resources writing original draft writing review editing visualization project administration yurii obnosov conceptualization methodology software formal analysis investigation resources writing original draft writing review editing visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was funded by squ grants dr rg 17 ig vc wrc 21 01 ig agr swae 22 02 and supported by the kazan federal university strategic academic leadership program priority 2030 helpful comments and critique by two referees are appreciated appendix in this appendix we give a historical perspective of the problem of seepage around a cutoff 6 6 this appendix can be entitled exegesis to vedernikov s legacy the tailwater of many dams e g all dams in oman is empty and one of the main criteria in designing a cutoff bco in fig 1 is that water seeping from the headwater reservoir into tailwater does not exfiltrate upward but percolates downward for example the al jifnain dam in muscat oman was designed and is currently under construction in such a manner that s is high enough for the free surface to have its apex di positioned below the tailwater bottom line excessive values of s significantly increase the cost of the geotechnical structure albeit at insufficient s water exfiltrates and causes waterlogging of the area downstream of the cutoff wall also for too small s seepage induced erosion e g piping heaving etc see e g istomina 1957 of the soil in the vicinity of point o in fig 1a takes place therefore the dam may virtually collapse in his solution for seepage without backwater zhukovsky used two holomorophic functions viz the complex potential and a new function the real part of which is modulo a given constant pore pressure the second function since zhukovsky s work bears his name and is used along with the hamel riesenkampf verigin and strack asgian holomorphic functions for solving boundary value problems bvps for 2 d potential flows unfortunately in his solution zhukovsky erred in the scheme of seepage which he postulated vedernikov 1939 in his book chapter vii of the book is entitled about one work by prof n e zhukovsky acknowledged the value of the zhukovsky function for analytical studies of phreatic flows on zhukovsky s erroneous solution vedernikov 1939 p 110 wrote zhukovsky is wrong in assuming that the point of zero darcian velocity d in our fig 1 and vedernikov s notations coincides with the tip of the cutoff wall c in our and vedernikov s notations point d can not belong simultaneously to the free surface and to the tip of the cutoff wall and therefore there should be groundwater rise behind the cutoff wall we showed this in our papers 70 71 72 vedernikov 1935 wedernikov 1935 and vedernikov 1936 in our list of references and in fig 14a of this book it is noteworthy that zhukovsky s solution does not correspond to the flow scheme which he showed in his own fig 16 below i will revisit and correct zhukovsky s solution vedernikov 1939 emphasized the importance of reconstructing the flow nets mutually orthogonal streamlines and constant piezometric head contours which validate the analytical formulae obtained with the help of various holomorphic functions strack 1989 vedernikov 1939 pointed out that zhukovsky s results and physical model of capillarity of soils are also wrong specifically vedernikov developed a new model of a free surface groundwater flow with a capillary fringe boundary along which he assumed the gage pressure head to be a negative constant which charactrerizes capillary properties of the soil also he assumed that this boundary is a streamline i e no recharge or evaporation takes place from it later generalizations to the case of recharge evaporation along the free surface with rates which are constant in the x direction are analyzed in pk 77 and kacimov 2004 the vedernikov 1939 model was extended by bouwer and is widely used for obtaining analytical solutions to problems of saturated and tension saturated flows see e g youngs 2012 in most dams of a relatively small size the headwater and tailwater beds are at the same horizon the shape of an empty tailwater is not necessarily a horizontal ray o 1 o 2 our solution in section 2 is valid for an arbitrary dashed curve o 3 o 4 ground surface in fig 1 provided the free surface capillary fringe boundary does not intersect it vedernikov 1939 along with his analytical solution conducted sand box experiments see his fig 46 p 114 which evidenced that zhukovsky s schematization of seepage was incorrect after wwii polubarinova kochina prepared the original zhukovsky s papers published in 1890 1920 and 1923 to be included into the volumes iii and vii of collected works published in 1949 and 1950 she added vedernikov s correct solution to the original zhukovsky s writing with her special comments explaining zhukovsky s errors in her own book published in 1952 pp 120 123 see also the english 1962 translation of the original russian text polubarinova kochina presented the vedernikov 1939 solution indicating that the free surface capillary fringe boundary is a catenary pk 62 her eq 2 10 later in the second 1977 edition of her book polubarinova kochina presented the vedernikov solution in slightly different notations with annoying typos in the final formulae what is a limitation in the above mentioned zh v pk solutions all of them postulated seepage in soils with the bedrock conditions at infinity this term was used by de wiest in his translation of pk 62 see pp 139 140 vedernikov 1939 and pk in her books called such regime фильтрация без подпора that would be better translated as seepage without backwater for seepage from soil channels in this regime the free surfaces demarcating the saturated tension saturated zone have vertical asymptotes seepage with backwater is analysed in a special section of vedernikov s book 1939 pp 61 64 pp 61 64 with illustrations in his figs 20 23 vedernikov and pk called such regime фильтрация c подпором vedernikov 1934 p 51 p 51 wrote the most difficult regime of seepage is one with backwater along with the complexity of each particular case of such seepage a detailed study of flow in this regime involves considerably more basic schemes than the case of seepage without backwater seepage from reservoirs is most often with backwater later vedernikov 1939 p 111 wrote the condition at infinity assumed by prof zhukovsky was the same as along the phreatic surface that corresponds to a constant velocity v k in the vertical direction this condition is however valid for seepage without backwater фильтрация без подпора this seepage scheme for reservoirs is generally rare the sizes of reservoirs are commonly so large that seepage from them draws up high the water table if soil is unbounded the free surfaces spread to infinity in the horizontal direction for instance vedernikov 1935 illustrated that the capillary fringe boundaries for flow from soil channels into two layered soils have horizontal asymptotes provided the bottom layer is much coarser than the upper one the backwater is then caused by the capillarity of the upper layer similarly the backwater can be caused by static groundwater in the lower highly permeable substratum ilyinsky and kacimov 1992 kacimov and youngs 2005 or by a draining stratum pk 62 p 139 for a horizontal bedrock at a finite depth under a soil channel or dam reservoir fig 1 steady state seepage is obviously impossible unless draining entities see vedernikov 1934 1936 are introduced vedernikov s 1939 p 114 in his sandbox experiments drained the pore water seeped from a modeled reservoir into a downstream compartment of the box he wrote 1939 p 114 as an illustration in our fig 46c we present the results of only one sandbox experiments in our 1933 series the height of rise behind the cutoff is significant that corresponds to the experimental setup i e seepage with backwater vedernikov s fig 46 indicates the sizes of his sandbox and cutoff the locus of phreatic line and of a horizontal impervious bed of the sandbox for most real dams in particular the al jifnain one see e g https www strabag international com databases internet public content30 nsf web30 openagent id d0a8f77d11ca9445c125866f003c61f8 the low permeable layer caliche which creates backwater is at a finite depth of 3 8 m 
48,density driven flow and transport is one of the dominant physical processes in coastal aquifer systems to better manage water resources in coastal areas the interactions need to be understood between freshwater and denser seawater numerical models often suffer from excessive computational cost to simulate the equilibrium steady state due to the nonlinear nature of the governing equations to describe density driven flow this study suggests a pseudo transient parameter continuation ptpc approach which combines two general solution strategies for nonlinear steady state equations the pseudo transient continuation ptc and parameter continuation pc methods the new method gradually adjusts the maximum density or parameter continuation in the transient simulation framework or pseudo transient the ptpc method is generally supposed to converge as in ptc and as efficiently as pc when the scheduling for parameter adjustment is set to be optimal through a proof of concept example it is illustrated that the solution path to the steady state in ptpc is in between the paths from the ptc and pc approaches depending on the level of aggressiveness of the parameter adjustment scheduling as yet being empirical the ptpc approach is promising and can be applicable to efficiently solve other steady state nonlinear equations the method was successfully applied to characterize and better understand the groundwater flow system in the suruga bay area japan data availability data will be made available on request 1 introduction interactions between freshwater and denser seawater are an important characteristic of coastal aquifer systems in coastal areas fresh groundwater generally flows toward the sea over a saline water body but seawater could move into freshwater aquifers due to natural processes or anthropogenic activities which is known as seawater intrusion this phenomenon is a serious concern in coastal areas because of deteriorating the sustainability of groundwater resources in coastal aquifers jasechko et al 2020 jeen et al 2021 seawater intrusion generates landward hydraulic gradients and in many cases the gradients are accelerated by natural and anthropogenic factors such as sea level rise caused by climate change and coastal water table decline which is relevant to excessive groundwater pumping induced watertable decline werner and simmons 2009 jasechko et al 2020 jeen et al 2021 for quantifying the effect of seawater intrusion the freshwater seawater interface is an important indicator that can provide insights on the vulnerability of coastal groundwater resources ferguson and gleeson 2012 kazakis et al 2018 jasechko et al 2020 and construction of underground structures in coastal areas walker et al 2001 graf and therrien 2005 kim et al 2018 kwon et al 2020 because the effects of seawater intrusion on groundwater system are significant and quasi irreversible foster and chilton 2003 there are various methods to identify the seawater and freshwater interface field observations jeen et al 2001 lee et al 2016 kim et al 2018 jasechko et al 2020 geophysical surveys hwang et al 2004 song et al 2007 abdalla et al 2010 gurunadha rao et al 2011 and analytical numerical and surrogate approaches strack 1976 frind 1982 dhar and datta 2009 sreekanth and datta 2010 pool and carrera 2011 yoon et al 2011 christelis and mantoglou 2019 mahmoodzadeh and karamouz 2019 zhang et al 2020 as mentioned in werner et al 2013 analytical and numerical approaches are mainly for quantifying and predicting seawater intrusion conditions although there are still various limitations including high computational demands and numerical dispersion numerical approaches using density driven flow and transport models have been utilized for better seawater intrusion management because of being capable of simulating complex hydrologic hydrogeologic and anthropogenic conditions such as sea level changes aquifer geometry and heterogeneity and groundwater pumping and land use changes werner et al 2013 regarding the numerical approaches as reviewed by werner et al 2013 there are various numerical codes that can solve seawater intrusion problems but most of them use linearized equations that are coupled between density driven flow and solute transport models as suggested by frind 1982 an integrated surface subsurface hydrogeosphere model aquanty inc 2019 hwang et al 2014 solves the coupled linear equations using the picard linearization method which has been widely applied for density driven flow and transport problems graf and therrien 2008 graf and degener 2011 xiao et al 2019 isa abadi et al 2020 qu et al 2020 although the picard method has been successfully applied to nonlinear problems issues related to its convergence can arise for problems with high density ratios and large and highly nonlinear systems putti and paniconi 1995 diersch and kolditz 2002 for analyzing the performance of a radioactive waste repository in a coastal region it is important to evaluate long term stability of the groundwater system at an underground repository site in many cases a steady state density driven flow and transport model is required because groundwater is affected by geographic and geologic conditions kröhn and schelkes 1996 normani and sykes 2010 sykes et al 2011 khader and novakowski 2014 since the steady state problem is highly nonlinear due to changes in fluid density farthing et al 2003 there are two numerical approaches for achieving its solutions pseudo transient continuation ptc and parameter continuation pc the ptc scheme is an attempt to efficiently solve the transient governing equations over a long period of time by applying an optimal timestep size the method uses switched evolution relaxation and temporal truncation error based on a backward euler approximation to derive an optimal timestep size for the next timestep kelley and keyes 1998 farthing et al 2003 the method is robust as it solves the transient governing equation and it is efficient because it utilizes such steady state system condition indicators as steady state residual and state variable change for determining an optimal timestep size the pc approach is an attempt to directly solve the steady state governing equations by gradually adjusting the parameters i e maximum density in this case from linear to nonlinear regimes based on the convergence condition of a nonlinear problem salinger et al 2005 for a density driven flow problem the pc method can be applied by increasing the maximum fluid density from freshwater to seawater which is a target density of the problem the pc approach can be extremely efficient as it solves the steady state equation directly as long as convergence is guaranteed in order to solve complex density driven problems in more robust and efficient ways this study suggests a pseudo transient parameter continuation ptpc approach that is based on ptc and pc schemes using hydrogeosphere we performed a proof of concept demonstration to show the computational efficiency of the suggested method and applied the ptpc method to a real world problem to evaluate the long term safety design of a hypothetical radioactive waste repository located in a coastal area 2 method 2 1 problem statement density driven flow and transport in subsurface is described by the following two coupled linear equations as frind 1982 1a s s h t k h ρ c ρ 0 1 g 1b c t d c v c where h is the equivalent freshwater head l ρ is the density of water m l 3 which is assumed to be a function of the concentration c m l 3 ρ0 is the density of freshwater m l 3 g is the gravitational acceleration l t 2 t is the time t v represents the linear velocity l t 1 and k d and ss are the hydraulic conductivity tensor l t 1 hydrodynamic dispersion tensor l2 t 1 and specific storage of the medium l 1 respectively a simplistic linear relationship is often assumed between the density and concentration as frind 1982 2 ρ c ρ 0 ρ m a x ρ 0 c c m a x where ρ max is the maximum density of water m l 3 when c cmax the flow eq 1a is dependent on the solution of the transport equation concentration and the flow solutions are included in the transport eq 1b in terms of the velocity if the density of water is assumed to be constant or ρ c ρ0 the flow equation is no longer dependent on the transport solution and becomes solvable independently the transport equation can then be solved for given velocities from flow solutions if a steady state is assumed h t 0 and c t 0 the governing equations can be simplified as 3 k h ρ c ρ 0 1 g 0 and d c vc 0 a fixed point iterative method i e picard method is widely used to solve the two governing equations together the convergence of the iterative method is generally achieved when the initial guess is close enough to the final solution and the governing equations can be re arranged to have a contraction property for the derivative to be bounded such that f x 0 ρ m a x x 1 4 when x 1 x 0 0 and df x ρ max dx κ 1 for x x 0 x 1 where f is the solution method if x n 1 f xn then lim n x n x 1 x is the state of the system or x h c x 0 is the initial state x 1 is the solution state and κ is a real positive number less than unity the transient density driven flow and transport equations can always become solvable as the change in state head and concentration can be made small enough by applying a timestep size that is small enough 5 since lim δ t 0 x 1 x 0 0 f t x 0 t 0 ρ max x 1 t 0 δ t where ft represents the solution of the transient nonlinear equations likewise the steady state equations may also be solvable when there is a general means to obtain an initial guess that is close enough to the final steady state solutions the pseudo transient continuation and parameter continuation methods are two different general strategies to accommodate a reasonable x 0 for nonlinear steady state solutions 2 2 pseudo transient continuation ptc since the transient governing equations for density driven flow and transport are solvable generally by applying a small timestep size repeating the time integration of the transient equations over a long period of time leads to steady state solutions when a steady state is assumed after a large time or x t t t s 0 the time period 0 ts can be divided into a n number of sub periods 0 t 1 t 2 tn ts where the following holds for any k as 6 f t x k t k ρ max x k 1 t k δ t k for small δ t k the ptc method is thus an attempt to efficiently integrate the transient equations by optimally selecting the timestep sizes δtk over the course of time integration the optimal timestep size may be determined based on the steady state residual e g ser or the switched evolution relaxation strategy or the rate of change in state e g the tte or temporal truncation error approach farthing et al 2003 the choice of the optimal timestep size nonetheless is heuristic by nature for the ser and tte farthing et al 2003 suggests that δtk can be determined as follows δ t k δ t k 1 r x k 1 r x k 7a r x k r h h k c k r c h k c k t k h k ρ c k ρ 0 1 g d c k v k c k 7b δ t k 2 2 1 x k 1 2 x k 1 t 2 t k τ where r represents the steady state residual and τ is an empirical constant 2 3 parameter continuation pc when the residual for the steady state governing equations is defined as in equation 7a the problem can be restated as the minimization of the residual for a given maximum density of water ρ max if the change of the state becomes smaller with a smaller increment of the maximum density the following relation holds as 8 lim δ ρ max 0 x ρ max δ ρ max x ρ max 0 when r ρ max x ρ max ρ max 0 for given x ρ max which states that the solution x ρ m a x δ ρ m a x becomes closer to the initial guess x ρ m a x as δρ max becomes smaller since the solution x ρ 0 is trivial when ρ max ρ0 and the parameter space ρ0 ρ m can be subdivided into ρ0 ρ1 ρ2 ρ n ρ m the pc method is an attempt to apply an increment of the parameter ρ max from ρ0 to a target density ρ m for steady state solutions salinger et al 2005 suggested the increment of the maximum density δρ k ρ k ρ k 1 to be based on the convergence requirement such that 9 δ ρ k δ ρ k 1 1 κ n m a x n k 1 2 where the n k 1 is the number of iterations required for the convergence in the previous solution step nmax is the pre specified maximum number of iterations and κ is an empirical constant for aggressiveness to allow the decrease of the increment eq 9 can be modified as 10 δ ρ k δ ρ k 1 n r e f n k 1 β where for an aggressive condition the maximum density increases greater for larger nref and β it is noted that the multiplication factor can be larger than or less than unity in eq 10 while it is forced to be larger than unity in eq 9 2 4 pseudo transient parameter continuation ptpc since the ptc method attempts to efficiently integrate the transient equations by selecting the timestep sizes based on the steady state residual or the rate of change in state it is straightforward to implement into existing numerical solvers it can be considered as an improved transient solver and thus this approach may carry the same strength and weakness of the simpler transient solver it is generally supposed to reach a steady state but requires a comparable amount of computing cost as the transient solvers with self adjustable variable timestep sizes advanced numerical models are often equipped with multiple options to choose a timestep size to minimize the chance of convergence failure e g a predictor corrector approach it is noted that the additional utilization of the steady state residual or the temporal derivatives of head and concentration can improve the transient solver the equations to describe the parameter continuation approach are intuitively clear and their implementation is also straightforward for existing steady state solvers or transient solvers if a large timestep size is applied the approach directly solves the steady state equations and thus can be more efficient compared to the ptc approach the weakness of the approach originates from the fact that it may not be guaranteed to solve such problems as density driven flow and transport when the solution becomes unstable for given parameter values a small change in the parameter value can lead to an oscillatory behavior to develop an efficient and stable steady state solver for density driven flow and transport it is thus necessary to combine the ptc and pc approaches to overcome the weakness of each of the ptc and pc approaches a hybrid ptpc approach is considered the ptc and pc approaches can be combined to improve the convergence property of the solution at a steady state as in the ptc approach and to be as efficient as the pc approach the combined approach thus solves the transient equations with an optimized timestep size because it is required for convergence and also gradually increases the maximum density as defined below as 11 the increase of the maximum density can follow a pre specified schedule or static scheduling or it can be adaptive according to the convergence behavior of the nonlinear solution procedure during the previous solution step or dynamic scheduling for static scheduling maximum density can be assumed to linearly increase with time from 0 to tm as 11 ρ m a x t m i n ρ 0 ρ m ρ 0 t m t ρ m for dynamic scheduling both timestep size and parameter value can be adjusted based on the convergence behavior during the previous solution step as 12 δ t k δ t k 1 n ref n k 1 β 1 and δ ρ k δ ρ k 1 n ref n k 1 β 2 3 proof of concept 3 1 comparison between ptc and pc a conceptual 2d example was used here to characterize the performance of the ptc pc and ptpc approaches for a density driven flow and transport problem in a 100 km long and about 5 km deep domain ground surface elevation changes linearly from 1 km above sea level and 1 km below sea level fig 1a hydraulic conductivity is assumed to be uniform and 10 7 m s for the entire domain at the land surface a specified head boundary condition is applied to be the same as the elevation with the concentration being zero freshwater while at the sea floor equivalent freshwater head is given as h z γz where γ ρ m ρ 0 1 0 025 and the concentration is specified to be unity pure seawater the domain was discretized using 100 m 2 quadrilateral elements and an initial condition is set from a steady state when ρ max ρ0 fig 1a density driven flow and transport solutions shown in figs 1b and 1c indicate that heavier water ρ max 1 025ρ0 is more difficult to be flushed by freshwater originating from land thus freshwater flows over the freshwater seawater interface sloping toward the land park et al 2009 a transient simulation was first performed for density driven flow and transport with a simple adaptive time stepping strategy as 13 δ t k δ t k 1 n r e f n k 1 where n k 1 is the number of nonlinear iterations required for the convergence in the previous timestep and nref is the pre specified reference number of iterations note that the choice of timestep size is based on the expectation that the number of iterations required for the convergence is linearly proportional to timestep size for this specific illustrative example nref 50 and the convergence was declared when δhmax 10 4 and δcmax 10 4 the change in salt distribution with time shown in fig 2a indicates that the salt water front propagates from the seafloor to inside the domain with time this is also confirmed from the maximum rates of change in head dh dt and concentration dc dt l norm of steady state residuals over time shown in fig 2b the simulation result of the density driven flow and transport was obtained with 190 timesteps with 2809 picard iterations over 1 5 million years when the initial timestep was set to be 1000 years the ptc approach with a modified ser strategy was also applied for the example problem with the same initial and boundary conditions the ptc with the ser strategy was modified for the density driven flow to utilize the weighted l norm as 14a r x k r h h k c k r c h k c k t k h k ρ c k ρ 0 1 g d c k v k c k s s h t c t 14b r x k ω 1 r h h k c k ω 2 r c h k c k ω 1 s s h t ω 2 c t 14c δ t k δ t k 1 r x k 1 r x k β relax where the weighting factors ω1 and ω2 are chosen to ensure the balance of flow and transport residuals ω 1 c t s s h t c t ω 2 s s h t s s h t c t and β relax is the aggressiveness factor to adjust the rates of change in steady state residuals h t and c t are about 0 3 and 2 0 in log log plot before and after about 105 years respectively fig 2b as 15a r t r 1000 t 0 3 when t 10 5 15b r t r 10 5 t 2 when t 10 5 where rt is the residual with respect to simulation time in the ptc the timestep is increased by equation 14c thus the following relations hold at time t from 15a and 15b as 16a δ t k δ t k 1 1 δ t k 1 t 0 3 β relax when t 10 5 16b δ t k δ t k 1 1 δ t k 1 t 2 β relax when t 10 5 where the rate of increase in the timestep size δt thus remains small when δt t is small fig 3 shows the ptc simulation characteristics when the weighting factors ω1 and ω2 are given as 0 9 and 0 1 and β relax is given as 1 0 and 0 2 the results in fig 3 show that the choice of the smaller β relax results in a smaller risk of failure in the nonlinear solution procedure by increasing the timestep size less aggressively for a similar reason when the solver fails to converge in one timestep the timestep size in the next solution step can be reduced significantly 1000 years to avoid the risk of multiple failures for the ptc the number of timesteps and the total number of nonlinear iterations are 456 and 3232 for β relax 1 and 299 and 3098 for β relax 0 2 comparison of the transient and ptc simulation performance shows that the transient simulation with adaptive time stepping outperforms the ptc for this specific example problem fig 4a shows the change of the state in the pc approach or the solutions of eq 3 with increasing ρ max and fig 4b illustrates the number of nonlinear iterations with increasing density when nref is 20 and β is 0 5 in the application of the pc approach the convergence is not achieved when ρ max is about 1018 kg m3 even with a very small δρ max the rates of change for head and concentration with increasing density h ρ max and c ρ max in fig 4b indicate that there is no significant decreasing trend with increasing ρ max and they steeply increase when the maximum density is at around 1018 kg m3 the test results however demonstrate that the pc approach can be efficient in solving this density driven flow problem when the target density is less than 1018 kg m3 3 2 pseudo transient parameter continuation ptpc consider a case where the maximum density increases linearly with time fig 5a as 17a ρ m a x m i n 1025 1000 γ t where γ is the density ratio with respect to timestep m l 3 t 1 which can be different from modeling cases in this study γ and timestep size are determined as follows 17b ρ m a x m i n 1025 1000 25 2 7 10 6 t 17c δ t k δ t k 1 n ref n k 1 β n ref 20 β 0 5 and δ t 1 10 4 years where the units of ρ max and γ are kg m 3 and kg m 3 y 1 respectively fig 5b shows the change of the state over the course of the simulation indicating that the change of the state follows the path between the cases of the ptc and pc approaches figs 2a and 4a in this ptpc approach the number of timesteps is 84 including one failed timestep with the total 1635 number of nonlinear iterations which is about 50 to 60 of the total number of nonlinear iterations in the transient 2809 and ptc 3232 and 3098 simulations if the maximum density increases linearly with time the change in the maximum density is directly related to the change in timestep as 18a δ ρ m a x 25 2 7 10 6 k g m 3 y 1 δ t 18b δ ρ k δ ρ k 1 n r e f n k 1 β 18c δ ρ 1 9 26 10 3 k g m 3 this scheduling scheme represents that the same rate of change is applied to the timestep size and the increment of the maximum density the ptpc performance was evaluated with different values for nref and β fig 6 shows the number of timesteps and the total number of nonlinear iterations when nref is given as 15 20 and 25 and β is 0 05 0 1 0 25 and 0 5 as nref and β both increase the ptpc method becomes more aggressive and its timestep size becomes larger quickly at the early stage of the simulation however as the number of nonlinear iterations increases with a larger timestep size the total number of nonlinear iterations can also increase in this evaluation the performance is optimal when nref is 20 and β is 0 1 with the total number of nonlinear iterations being 1344 for variable changes in the maximum density and timestep the increment of the maximum density and the timestep size can be determined as 19 δ t k δ t k 1 n ref n k 1 β 1 and δ ρ k δ ρ k 1 n ref n k 1 β 2 if all the parameters are similar to the previous section nref 20 β1 0 1 δt 1 104 and δρ1 0 01 three cases are considered when β2 is 0 05 0 1 and 0 25 for a case where β2 is greater than β1 the rate of change in maximum density increment is larger than that of the timestep size thus reaching the target maximum density quicker than the case for β2 β1 on the other hand if β1 is greater than β2 the maximum density increases more gradually over longer time fig 7 compares the temporal change of the maximum density and timestep size for β2 0 05 0 1 and 0 25 for each of these cases the target maximum density 1025 kg m3 is reached after 8 31 2 48 and 0 37 million years while the final steady state is achieved at 8 42 2 78 and 1 40 million years fig 7 it is clear in fig 7 that a larger timestep size is applied as β2becomes smaller and the average timestep size is 100 103 4 3 103 and 1 7 103 years for those three cases examined it is also noted that the simulation period after the target maximum density is reached is 1 3 10 8 and 73 6 of the total simulation period when β2 0 05 the ptpc approach behaves more similarly to the pc approach while if β2 0 25 it is closer to the ptc approach fig 8 shows the change in salt distributions with increasing maximum density for three β2 values used the results in fig 8 clearly illustrate that the solution of the ptpc scheme is comparable to that of the pc fig 4a for β2 0 05 fig 8a while it becomes more comparable to the ptc solution fig 2a for β2 0 25 the total numbers of nonlinear iterations required for the steady state solutions are 1757 1300 and 1158 when β2 is 0 05 0 1 and 0 25 respectively for this specific example a ptc like simulation is the most efficient where the introduction of a shock is avoided by increasing the maximum density gradually at the early stage 4 application to a suruga bay coastal aquifer system in japan recently coastal areas have attracted great attention as a candidate site for waste disposal in japan as it is considered to be highly feasible from the transportation point of view meti 2017 it is generally understood that the interaction between freshwater and saline water from the sea is one of the key factors that can precisely describe groundwater flow in coastal aquifer systems in addition geological records in japan show that the sea level can fluctuate significantly over the time frame for the safety analysis of those facilities over a hundred thousand years thus understanding the long term evolution of regional coastal groundwater flow systems is essential for reducing the uncertainty associated with the safety assessment of geologic repositories in japan numerical models are expected to reasonably reproduce the current groundwater flow system and to predict the long term evolution of the coastal aquifer systems difficulties were identified in simulating long term density driven flow and transport due mainly to the nonlinear nature of the coupled flow and transport equations specifically numerical models typically cannot solve a steady state directly for nonlinear governing equations and require transient simulations for a long time until the rate of change in state variables becomes small which causes excessive computational cost this study demonstrates that a steady state density driven flow and transport solution for a coastal aquifer system can be obtained with a reasonable amount of computational effort using the ptpc method it is noted that the model presented in this study was used only for the illustrative purpose among the multiple geological and hydrogeological conceptual models developed for the northern suruga bay area 4 1 conceptual and numerical models the suruga bay area is located on the pacific coast of honshu the main island of japan and is about 150 km southwest from tokyo suruga bay is surrounded by the izu peninsula to the east and opens to the philippine sea and pacific ocean to the south the area includes mount fuji the highest peak in japan 3776 m above sea level and the suruga trough 2500 m below sea level running up the middle of the bay to the pacific the geology of the study area is generally comprised of the tertiary complex of the mid miocene tertiary igneous rocks tertiary sedimentary rocks late miocene to pliocene quaternary igneous and sedimentary rocks pleistocene and multiple intrusives in the area there is a significant level of uncertainty associated with the distribution of high permeability fracture zones and the tectono physical sequences the modeled area was about 2000 km2 of which about 68 is land about 1300 km2 fig 9a the domain includes portions of the mount fuji and suruga trough with the surface elevation ranging from 3700 m to 1600 m from the sea level fig 9b shows a hydrogeological conceptual model of the study area the hydrogeological properties of the geological materials are summarized in table 1 the model domain was extended down to 2000 m below sea level and discretized with 60 numerical layers consisting of approximately 3 million nodes and 6 million triangular prism elements which corresponds to an average areal dimension of an element 0 02 km2 it is noted that the salinity profile in the coastal zone is highly affected by hydrogeologic structures zamrsky et al 2018 however this study focuses mainly on the methodological improvement and robustness of the pseudo transient parameter continuation approach therefore we used simplified hydrogeologic conditions of the model which include unconfined and isotropic conditions for the numerical scheme evaluation in order to simulate groundwater water and seawater interactions a combined recharge and seepage boundary condition was applied on the land surface with an assumption that head is the same as the elevation if groundwater discharges to the ground surface and 2000 mm of annual recharge of freshwater was applied throughout the domain in the sea area a hydrostatic condition was assumed by considering the density of saline seawater or h γz where γ 0 025 relative salinity was assigned as the unity on the sea surface while it was set to be zero in the land surface area no flow and no mass flux conditions were applied to the side and bottom boundaries 4 2 results and computational performance a steady state condition was first achieved when flow and transport equations were de coupled without considering the density difference between freshwater and seawater it is noted that these linear equations can be solved sequentially and directly the calculated head and salinity distributions show that the freshwater recharged at the land surface displaces the near shore seawater and thus the isosurface for c c 0 0 01 is inclined toward the sea fig 10a this steady state head and salinity distribution was then used as an initial condition for the density driven flow and transport simulation by applying the ptpc method fig 10b shows the head and salinity distributions when seawater was assumed to be 2 5 denser than freshwater γ 0 025 in fig 10b it is clear that the freshwater seawater interface is moved and inclined toward the land due to the density effect from the steady state density driven simulation the discharge area in the land and sea is identified as shown in fig 11a most of freshwater discharges to the low elevation areas in the land notably concentrated at the foot of the mount fuji and also near shore sea surface as submarine groundwater discharge fig 11b shows the vertical profiles of salinity and groundwater velocity at a pair of observation points located at the inland and sea about 200 m from the shoreline fig 11a these profiles illustrate the near shore flushing of salinity at depth as there exists a freshwater body at depth in both land and sea areas near zero concentration at around 1000 masl in fig 11b and freshwater is mixed with saline water as it becomes shallower under the seafloor dashed red line in fig 11b while salinity is increased at the land area indicating sea water intrusion 400 to 200 masl for solid red line in fig 1b it is also clearly shown that groundwater velocity decreases with depth in general and geology is a single major determining factor to identify the static zone to host the repository it is first noted that the computational cost for the transient density driven flow and transport simulations was truly excessive to obtain the steady state solution however the ptpc method requires less than 100 computing steps and less than a day of computing to obtain the solution under the same computing environment multicore processor computers additionally it is still challenging to apply the model for inverse simulations requiring 100 s to 1000s forward simulations but the ptpc application is a significant move forward to overcome the challenges associated with the solution of steady state nonlinear equations 5 summary and conclusions the ptc and pc approaches have been widely applied in solving steady state nonlinear equations the ptc approach is an attempt to perform time integration more efficiently based on the steady state residual as an objective function to minimize while the pc approach re states that the steady state residual is a function of a set of parameters or a parameter i e maximum density the ptc method is more straightforward to converge but carries the weakness of transient simulations high computational cost and the pc approach is relatively efficient by solving the steady state equations but often convergence is not guaranteed this study suggested a hybrid ptpc approach for density driven flow and transport simulations where the maximum density is gradually adjusted to the target value in the pseudo transient framework based on the demonstration result for a proof of concept example this hybrid approach converges as easily as in ptc and sacrifices the minimal computational efficiency of a pc it was also shown that there was an optimal level of aggressiveness in adjusting the maximum density for the ptpc approach the ptpc method was then applied to solve the density driven flow problem for the suruga bay area in japan where the computational cost was extremely large for transient density driven flow and transport simulations the hybrid ptpc scheme can be easily implemented in existing models and it can be extended further to solve other types of steady state nonlinear equations e g saint venant equation for overland flow richards equation for variably saturated flow etc in this study the optimal scheduling in ptpc was estimated based on the test cases with similar yet simpler proof of concept problems but it can be further improved when the level of aggressiveness can be adjusted during simulations author statement young jin park conceptualization software formal analysis methodology investigation writing original draft writing review editing hyoun tae hwang software formal analysis methodology resources investigation writing original draft writing review editing takuma hasegawa resources formal analysis application writing review editing shunichi okamoto resources formal analysis application writing review editing takenori ozutsumi resources formal analysis application writing review editing tatsuya tanaka resources formal analysis application writing review editing yutaka morita resources formal analysis application writing review editing walter a illman resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study uses the groundwater model developed by the project for validating assessment methodology of geological disposal system in coastal region fy2019 and fy2020 grant number jpj007597 which is supported by the japanese ministry of economy trade and industry meti and is a joint research with radioactive waste management funding and research center rwmc and national institute of advanced industrial science and technology aist we thank professors y e yoshida nagoya university s takeuchi nihon univ t sato hokkaido university h sato okayama univ s uchida national institutes of quantum science and technology and colleagues for their advice 
48,density driven flow and transport is one of the dominant physical processes in coastal aquifer systems to better manage water resources in coastal areas the interactions need to be understood between freshwater and denser seawater numerical models often suffer from excessive computational cost to simulate the equilibrium steady state due to the nonlinear nature of the governing equations to describe density driven flow this study suggests a pseudo transient parameter continuation ptpc approach which combines two general solution strategies for nonlinear steady state equations the pseudo transient continuation ptc and parameter continuation pc methods the new method gradually adjusts the maximum density or parameter continuation in the transient simulation framework or pseudo transient the ptpc method is generally supposed to converge as in ptc and as efficiently as pc when the scheduling for parameter adjustment is set to be optimal through a proof of concept example it is illustrated that the solution path to the steady state in ptpc is in between the paths from the ptc and pc approaches depending on the level of aggressiveness of the parameter adjustment scheduling as yet being empirical the ptpc approach is promising and can be applicable to efficiently solve other steady state nonlinear equations the method was successfully applied to characterize and better understand the groundwater flow system in the suruga bay area japan data availability data will be made available on request 1 introduction interactions between freshwater and denser seawater are an important characteristic of coastal aquifer systems in coastal areas fresh groundwater generally flows toward the sea over a saline water body but seawater could move into freshwater aquifers due to natural processes or anthropogenic activities which is known as seawater intrusion this phenomenon is a serious concern in coastal areas because of deteriorating the sustainability of groundwater resources in coastal aquifers jasechko et al 2020 jeen et al 2021 seawater intrusion generates landward hydraulic gradients and in many cases the gradients are accelerated by natural and anthropogenic factors such as sea level rise caused by climate change and coastal water table decline which is relevant to excessive groundwater pumping induced watertable decline werner and simmons 2009 jasechko et al 2020 jeen et al 2021 for quantifying the effect of seawater intrusion the freshwater seawater interface is an important indicator that can provide insights on the vulnerability of coastal groundwater resources ferguson and gleeson 2012 kazakis et al 2018 jasechko et al 2020 and construction of underground structures in coastal areas walker et al 2001 graf and therrien 2005 kim et al 2018 kwon et al 2020 because the effects of seawater intrusion on groundwater system are significant and quasi irreversible foster and chilton 2003 there are various methods to identify the seawater and freshwater interface field observations jeen et al 2001 lee et al 2016 kim et al 2018 jasechko et al 2020 geophysical surveys hwang et al 2004 song et al 2007 abdalla et al 2010 gurunadha rao et al 2011 and analytical numerical and surrogate approaches strack 1976 frind 1982 dhar and datta 2009 sreekanth and datta 2010 pool and carrera 2011 yoon et al 2011 christelis and mantoglou 2019 mahmoodzadeh and karamouz 2019 zhang et al 2020 as mentioned in werner et al 2013 analytical and numerical approaches are mainly for quantifying and predicting seawater intrusion conditions although there are still various limitations including high computational demands and numerical dispersion numerical approaches using density driven flow and transport models have been utilized for better seawater intrusion management because of being capable of simulating complex hydrologic hydrogeologic and anthropogenic conditions such as sea level changes aquifer geometry and heterogeneity and groundwater pumping and land use changes werner et al 2013 regarding the numerical approaches as reviewed by werner et al 2013 there are various numerical codes that can solve seawater intrusion problems but most of them use linearized equations that are coupled between density driven flow and solute transport models as suggested by frind 1982 an integrated surface subsurface hydrogeosphere model aquanty inc 2019 hwang et al 2014 solves the coupled linear equations using the picard linearization method which has been widely applied for density driven flow and transport problems graf and therrien 2008 graf and degener 2011 xiao et al 2019 isa abadi et al 2020 qu et al 2020 although the picard method has been successfully applied to nonlinear problems issues related to its convergence can arise for problems with high density ratios and large and highly nonlinear systems putti and paniconi 1995 diersch and kolditz 2002 for analyzing the performance of a radioactive waste repository in a coastal region it is important to evaluate long term stability of the groundwater system at an underground repository site in many cases a steady state density driven flow and transport model is required because groundwater is affected by geographic and geologic conditions kröhn and schelkes 1996 normani and sykes 2010 sykes et al 2011 khader and novakowski 2014 since the steady state problem is highly nonlinear due to changes in fluid density farthing et al 2003 there are two numerical approaches for achieving its solutions pseudo transient continuation ptc and parameter continuation pc the ptc scheme is an attempt to efficiently solve the transient governing equations over a long period of time by applying an optimal timestep size the method uses switched evolution relaxation and temporal truncation error based on a backward euler approximation to derive an optimal timestep size for the next timestep kelley and keyes 1998 farthing et al 2003 the method is robust as it solves the transient governing equation and it is efficient because it utilizes such steady state system condition indicators as steady state residual and state variable change for determining an optimal timestep size the pc approach is an attempt to directly solve the steady state governing equations by gradually adjusting the parameters i e maximum density in this case from linear to nonlinear regimes based on the convergence condition of a nonlinear problem salinger et al 2005 for a density driven flow problem the pc method can be applied by increasing the maximum fluid density from freshwater to seawater which is a target density of the problem the pc approach can be extremely efficient as it solves the steady state equation directly as long as convergence is guaranteed in order to solve complex density driven problems in more robust and efficient ways this study suggests a pseudo transient parameter continuation ptpc approach that is based on ptc and pc schemes using hydrogeosphere we performed a proof of concept demonstration to show the computational efficiency of the suggested method and applied the ptpc method to a real world problem to evaluate the long term safety design of a hypothetical radioactive waste repository located in a coastal area 2 method 2 1 problem statement density driven flow and transport in subsurface is described by the following two coupled linear equations as frind 1982 1a s s h t k h ρ c ρ 0 1 g 1b c t d c v c where h is the equivalent freshwater head l ρ is the density of water m l 3 which is assumed to be a function of the concentration c m l 3 ρ0 is the density of freshwater m l 3 g is the gravitational acceleration l t 2 t is the time t v represents the linear velocity l t 1 and k d and ss are the hydraulic conductivity tensor l t 1 hydrodynamic dispersion tensor l2 t 1 and specific storage of the medium l 1 respectively a simplistic linear relationship is often assumed between the density and concentration as frind 1982 2 ρ c ρ 0 ρ m a x ρ 0 c c m a x where ρ max is the maximum density of water m l 3 when c cmax the flow eq 1a is dependent on the solution of the transport equation concentration and the flow solutions are included in the transport eq 1b in terms of the velocity if the density of water is assumed to be constant or ρ c ρ0 the flow equation is no longer dependent on the transport solution and becomes solvable independently the transport equation can then be solved for given velocities from flow solutions if a steady state is assumed h t 0 and c t 0 the governing equations can be simplified as 3 k h ρ c ρ 0 1 g 0 and d c vc 0 a fixed point iterative method i e picard method is widely used to solve the two governing equations together the convergence of the iterative method is generally achieved when the initial guess is close enough to the final solution and the governing equations can be re arranged to have a contraction property for the derivative to be bounded such that f x 0 ρ m a x x 1 4 when x 1 x 0 0 and df x ρ max dx κ 1 for x x 0 x 1 where f is the solution method if x n 1 f xn then lim n x n x 1 x is the state of the system or x h c x 0 is the initial state x 1 is the solution state and κ is a real positive number less than unity the transient density driven flow and transport equations can always become solvable as the change in state head and concentration can be made small enough by applying a timestep size that is small enough 5 since lim δ t 0 x 1 x 0 0 f t x 0 t 0 ρ max x 1 t 0 δ t where ft represents the solution of the transient nonlinear equations likewise the steady state equations may also be solvable when there is a general means to obtain an initial guess that is close enough to the final steady state solutions the pseudo transient continuation and parameter continuation methods are two different general strategies to accommodate a reasonable x 0 for nonlinear steady state solutions 2 2 pseudo transient continuation ptc since the transient governing equations for density driven flow and transport are solvable generally by applying a small timestep size repeating the time integration of the transient equations over a long period of time leads to steady state solutions when a steady state is assumed after a large time or x t t t s 0 the time period 0 ts can be divided into a n number of sub periods 0 t 1 t 2 tn ts where the following holds for any k as 6 f t x k t k ρ max x k 1 t k δ t k for small δ t k the ptc method is thus an attempt to efficiently integrate the transient equations by optimally selecting the timestep sizes δtk over the course of time integration the optimal timestep size may be determined based on the steady state residual e g ser or the switched evolution relaxation strategy or the rate of change in state e g the tte or temporal truncation error approach farthing et al 2003 the choice of the optimal timestep size nonetheless is heuristic by nature for the ser and tte farthing et al 2003 suggests that δtk can be determined as follows δ t k δ t k 1 r x k 1 r x k 7a r x k r h h k c k r c h k c k t k h k ρ c k ρ 0 1 g d c k v k c k 7b δ t k 2 2 1 x k 1 2 x k 1 t 2 t k τ where r represents the steady state residual and τ is an empirical constant 2 3 parameter continuation pc when the residual for the steady state governing equations is defined as in equation 7a the problem can be restated as the minimization of the residual for a given maximum density of water ρ max if the change of the state becomes smaller with a smaller increment of the maximum density the following relation holds as 8 lim δ ρ max 0 x ρ max δ ρ max x ρ max 0 when r ρ max x ρ max ρ max 0 for given x ρ max which states that the solution x ρ m a x δ ρ m a x becomes closer to the initial guess x ρ m a x as δρ max becomes smaller since the solution x ρ 0 is trivial when ρ max ρ0 and the parameter space ρ0 ρ m can be subdivided into ρ0 ρ1 ρ2 ρ n ρ m the pc method is an attempt to apply an increment of the parameter ρ max from ρ0 to a target density ρ m for steady state solutions salinger et al 2005 suggested the increment of the maximum density δρ k ρ k ρ k 1 to be based on the convergence requirement such that 9 δ ρ k δ ρ k 1 1 κ n m a x n k 1 2 where the n k 1 is the number of iterations required for the convergence in the previous solution step nmax is the pre specified maximum number of iterations and κ is an empirical constant for aggressiveness to allow the decrease of the increment eq 9 can be modified as 10 δ ρ k δ ρ k 1 n r e f n k 1 β where for an aggressive condition the maximum density increases greater for larger nref and β it is noted that the multiplication factor can be larger than or less than unity in eq 10 while it is forced to be larger than unity in eq 9 2 4 pseudo transient parameter continuation ptpc since the ptc method attempts to efficiently integrate the transient equations by selecting the timestep sizes based on the steady state residual or the rate of change in state it is straightforward to implement into existing numerical solvers it can be considered as an improved transient solver and thus this approach may carry the same strength and weakness of the simpler transient solver it is generally supposed to reach a steady state but requires a comparable amount of computing cost as the transient solvers with self adjustable variable timestep sizes advanced numerical models are often equipped with multiple options to choose a timestep size to minimize the chance of convergence failure e g a predictor corrector approach it is noted that the additional utilization of the steady state residual or the temporal derivatives of head and concentration can improve the transient solver the equations to describe the parameter continuation approach are intuitively clear and their implementation is also straightforward for existing steady state solvers or transient solvers if a large timestep size is applied the approach directly solves the steady state equations and thus can be more efficient compared to the ptc approach the weakness of the approach originates from the fact that it may not be guaranteed to solve such problems as density driven flow and transport when the solution becomes unstable for given parameter values a small change in the parameter value can lead to an oscillatory behavior to develop an efficient and stable steady state solver for density driven flow and transport it is thus necessary to combine the ptc and pc approaches to overcome the weakness of each of the ptc and pc approaches a hybrid ptpc approach is considered the ptc and pc approaches can be combined to improve the convergence property of the solution at a steady state as in the ptc approach and to be as efficient as the pc approach the combined approach thus solves the transient equations with an optimized timestep size because it is required for convergence and also gradually increases the maximum density as defined below as 11 the increase of the maximum density can follow a pre specified schedule or static scheduling or it can be adaptive according to the convergence behavior of the nonlinear solution procedure during the previous solution step or dynamic scheduling for static scheduling maximum density can be assumed to linearly increase with time from 0 to tm as 11 ρ m a x t m i n ρ 0 ρ m ρ 0 t m t ρ m for dynamic scheduling both timestep size and parameter value can be adjusted based on the convergence behavior during the previous solution step as 12 δ t k δ t k 1 n ref n k 1 β 1 and δ ρ k δ ρ k 1 n ref n k 1 β 2 3 proof of concept 3 1 comparison between ptc and pc a conceptual 2d example was used here to characterize the performance of the ptc pc and ptpc approaches for a density driven flow and transport problem in a 100 km long and about 5 km deep domain ground surface elevation changes linearly from 1 km above sea level and 1 km below sea level fig 1a hydraulic conductivity is assumed to be uniform and 10 7 m s for the entire domain at the land surface a specified head boundary condition is applied to be the same as the elevation with the concentration being zero freshwater while at the sea floor equivalent freshwater head is given as h z γz where γ ρ m ρ 0 1 0 025 and the concentration is specified to be unity pure seawater the domain was discretized using 100 m 2 quadrilateral elements and an initial condition is set from a steady state when ρ max ρ0 fig 1a density driven flow and transport solutions shown in figs 1b and 1c indicate that heavier water ρ max 1 025ρ0 is more difficult to be flushed by freshwater originating from land thus freshwater flows over the freshwater seawater interface sloping toward the land park et al 2009 a transient simulation was first performed for density driven flow and transport with a simple adaptive time stepping strategy as 13 δ t k δ t k 1 n r e f n k 1 where n k 1 is the number of nonlinear iterations required for the convergence in the previous timestep and nref is the pre specified reference number of iterations note that the choice of timestep size is based on the expectation that the number of iterations required for the convergence is linearly proportional to timestep size for this specific illustrative example nref 50 and the convergence was declared when δhmax 10 4 and δcmax 10 4 the change in salt distribution with time shown in fig 2a indicates that the salt water front propagates from the seafloor to inside the domain with time this is also confirmed from the maximum rates of change in head dh dt and concentration dc dt l norm of steady state residuals over time shown in fig 2b the simulation result of the density driven flow and transport was obtained with 190 timesteps with 2809 picard iterations over 1 5 million years when the initial timestep was set to be 1000 years the ptc approach with a modified ser strategy was also applied for the example problem with the same initial and boundary conditions the ptc with the ser strategy was modified for the density driven flow to utilize the weighted l norm as 14a r x k r h h k c k r c h k c k t k h k ρ c k ρ 0 1 g d c k v k c k s s h t c t 14b r x k ω 1 r h h k c k ω 2 r c h k c k ω 1 s s h t ω 2 c t 14c δ t k δ t k 1 r x k 1 r x k β relax where the weighting factors ω1 and ω2 are chosen to ensure the balance of flow and transport residuals ω 1 c t s s h t c t ω 2 s s h t s s h t c t and β relax is the aggressiveness factor to adjust the rates of change in steady state residuals h t and c t are about 0 3 and 2 0 in log log plot before and after about 105 years respectively fig 2b as 15a r t r 1000 t 0 3 when t 10 5 15b r t r 10 5 t 2 when t 10 5 where rt is the residual with respect to simulation time in the ptc the timestep is increased by equation 14c thus the following relations hold at time t from 15a and 15b as 16a δ t k δ t k 1 1 δ t k 1 t 0 3 β relax when t 10 5 16b δ t k δ t k 1 1 δ t k 1 t 2 β relax when t 10 5 where the rate of increase in the timestep size δt thus remains small when δt t is small fig 3 shows the ptc simulation characteristics when the weighting factors ω1 and ω2 are given as 0 9 and 0 1 and β relax is given as 1 0 and 0 2 the results in fig 3 show that the choice of the smaller β relax results in a smaller risk of failure in the nonlinear solution procedure by increasing the timestep size less aggressively for a similar reason when the solver fails to converge in one timestep the timestep size in the next solution step can be reduced significantly 1000 years to avoid the risk of multiple failures for the ptc the number of timesteps and the total number of nonlinear iterations are 456 and 3232 for β relax 1 and 299 and 3098 for β relax 0 2 comparison of the transient and ptc simulation performance shows that the transient simulation with adaptive time stepping outperforms the ptc for this specific example problem fig 4a shows the change of the state in the pc approach or the solutions of eq 3 with increasing ρ max and fig 4b illustrates the number of nonlinear iterations with increasing density when nref is 20 and β is 0 5 in the application of the pc approach the convergence is not achieved when ρ max is about 1018 kg m3 even with a very small δρ max the rates of change for head and concentration with increasing density h ρ max and c ρ max in fig 4b indicate that there is no significant decreasing trend with increasing ρ max and they steeply increase when the maximum density is at around 1018 kg m3 the test results however demonstrate that the pc approach can be efficient in solving this density driven flow problem when the target density is less than 1018 kg m3 3 2 pseudo transient parameter continuation ptpc consider a case where the maximum density increases linearly with time fig 5a as 17a ρ m a x m i n 1025 1000 γ t where γ is the density ratio with respect to timestep m l 3 t 1 which can be different from modeling cases in this study γ and timestep size are determined as follows 17b ρ m a x m i n 1025 1000 25 2 7 10 6 t 17c δ t k δ t k 1 n ref n k 1 β n ref 20 β 0 5 and δ t 1 10 4 years where the units of ρ max and γ are kg m 3 and kg m 3 y 1 respectively fig 5b shows the change of the state over the course of the simulation indicating that the change of the state follows the path between the cases of the ptc and pc approaches figs 2a and 4a in this ptpc approach the number of timesteps is 84 including one failed timestep with the total 1635 number of nonlinear iterations which is about 50 to 60 of the total number of nonlinear iterations in the transient 2809 and ptc 3232 and 3098 simulations if the maximum density increases linearly with time the change in the maximum density is directly related to the change in timestep as 18a δ ρ m a x 25 2 7 10 6 k g m 3 y 1 δ t 18b δ ρ k δ ρ k 1 n r e f n k 1 β 18c δ ρ 1 9 26 10 3 k g m 3 this scheduling scheme represents that the same rate of change is applied to the timestep size and the increment of the maximum density the ptpc performance was evaluated with different values for nref and β fig 6 shows the number of timesteps and the total number of nonlinear iterations when nref is given as 15 20 and 25 and β is 0 05 0 1 0 25 and 0 5 as nref and β both increase the ptpc method becomes more aggressive and its timestep size becomes larger quickly at the early stage of the simulation however as the number of nonlinear iterations increases with a larger timestep size the total number of nonlinear iterations can also increase in this evaluation the performance is optimal when nref is 20 and β is 0 1 with the total number of nonlinear iterations being 1344 for variable changes in the maximum density and timestep the increment of the maximum density and the timestep size can be determined as 19 δ t k δ t k 1 n ref n k 1 β 1 and δ ρ k δ ρ k 1 n ref n k 1 β 2 if all the parameters are similar to the previous section nref 20 β1 0 1 δt 1 104 and δρ1 0 01 three cases are considered when β2 is 0 05 0 1 and 0 25 for a case where β2 is greater than β1 the rate of change in maximum density increment is larger than that of the timestep size thus reaching the target maximum density quicker than the case for β2 β1 on the other hand if β1 is greater than β2 the maximum density increases more gradually over longer time fig 7 compares the temporal change of the maximum density and timestep size for β2 0 05 0 1 and 0 25 for each of these cases the target maximum density 1025 kg m3 is reached after 8 31 2 48 and 0 37 million years while the final steady state is achieved at 8 42 2 78 and 1 40 million years fig 7 it is clear in fig 7 that a larger timestep size is applied as β2becomes smaller and the average timestep size is 100 103 4 3 103 and 1 7 103 years for those three cases examined it is also noted that the simulation period after the target maximum density is reached is 1 3 10 8 and 73 6 of the total simulation period when β2 0 05 the ptpc approach behaves more similarly to the pc approach while if β2 0 25 it is closer to the ptc approach fig 8 shows the change in salt distributions with increasing maximum density for three β2 values used the results in fig 8 clearly illustrate that the solution of the ptpc scheme is comparable to that of the pc fig 4a for β2 0 05 fig 8a while it becomes more comparable to the ptc solution fig 2a for β2 0 25 the total numbers of nonlinear iterations required for the steady state solutions are 1757 1300 and 1158 when β2 is 0 05 0 1 and 0 25 respectively for this specific example a ptc like simulation is the most efficient where the introduction of a shock is avoided by increasing the maximum density gradually at the early stage 4 application to a suruga bay coastal aquifer system in japan recently coastal areas have attracted great attention as a candidate site for waste disposal in japan as it is considered to be highly feasible from the transportation point of view meti 2017 it is generally understood that the interaction between freshwater and saline water from the sea is one of the key factors that can precisely describe groundwater flow in coastal aquifer systems in addition geological records in japan show that the sea level can fluctuate significantly over the time frame for the safety analysis of those facilities over a hundred thousand years thus understanding the long term evolution of regional coastal groundwater flow systems is essential for reducing the uncertainty associated with the safety assessment of geologic repositories in japan numerical models are expected to reasonably reproduce the current groundwater flow system and to predict the long term evolution of the coastal aquifer systems difficulties were identified in simulating long term density driven flow and transport due mainly to the nonlinear nature of the coupled flow and transport equations specifically numerical models typically cannot solve a steady state directly for nonlinear governing equations and require transient simulations for a long time until the rate of change in state variables becomes small which causes excessive computational cost this study demonstrates that a steady state density driven flow and transport solution for a coastal aquifer system can be obtained with a reasonable amount of computational effort using the ptpc method it is noted that the model presented in this study was used only for the illustrative purpose among the multiple geological and hydrogeological conceptual models developed for the northern suruga bay area 4 1 conceptual and numerical models the suruga bay area is located on the pacific coast of honshu the main island of japan and is about 150 km southwest from tokyo suruga bay is surrounded by the izu peninsula to the east and opens to the philippine sea and pacific ocean to the south the area includes mount fuji the highest peak in japan 3776 m above sea level and the suruga trough 2500 m below sea level running up the middle of the bay to the pacific the geology of the study area is generally comprised of the tertiary complex of the mid miocene tertiary igneous rocks tertiary sedimentary rocks late miocene to pliocene quaternary igneous and sedimentary rocks pleistocene and multiple intrusives in the area there is a significant level of uncertainty associated with the distribution of high permeability fracture zones and the tectono physical sequences the modeled area was about 2000 km2 of which about 68 is land about 1300 km2 fig 9a the domain includes portions of the mount fuji and suruga trough with the surface elevation ranging from 3700 m to 1600 m from the sea level fig 9b shows a hydrogeological conceptual model of the study area the hydrogeological properties of the geological materials are summarized in table 1 the model domain was extended down to 2000 m below sea level and discretized with 60 numerical layers consisting of approximately 3 million nodes and 6 million triangular prism elements which corresponds to an average areal dimension of an element 0 02 km2 it is noted that the salinity profile in the coastal zone is highly affected by hydrogeologic structures zamrsky et al 2018 however this study focuses mainly on the methodological improvement and robustness of the pseudo transient parameter continuation approach therefore we used simplified hydrogeologic conditions of the model which include unconfined and isotropic conditions for the numerical scheme evaluation in order to simulate groundwater water and seawater interactions a combined recharge and seepage boundary condition was applied on the land surface with an assumption that head is the same as the elevation if groundwater discharges to the ground surface and 2000 mm of annual recharge of freshwater was applied throughout the domain in the sea area a hydrostatic condition was assumed by considering the density of saline seawater or h γz where γ 0 025 relative salinity was assigned as the unity on the sea surface while it was set to be zero in the land surface area no flow and no mass flux conditions were applied to the side and bottom boundaries 4 2 results and computational performance a steady state condition was first achieved when flow and transport equations were de coupled without considering the density difference between freshwater and seawater it is noted that these linear equations can be solved sequentially and directly the calculated head and salinity distributions show that the freshwater recharged at the land surface displaces the near shore seawater and thus the isosurface for c c 0 0 01 is inclined toward the sea fig 10a this steady state head and salinity distribution was then used as an initial condition for the density driven flow and transport simulation by applying the ptpc method fig 10b shows the head and salinity distributions when seawater was assumed to be 2 5 denser than freshwater γ 0 025 in fig 10b it is clear that the freshwater seawater interface is moved and inclined toward the land due to the density effect from the steady state density driven simulation the discharge area in the land and sea is identified as shown in fig 11a most of freshwater discharges to the low elevation areas in the land notably concentrated at the foot of the mount fuji and also near shore sea surface as submarine groundwater discharge fig 11b shows the vertical profiles of salinity and groundwater velocity at a pair of observation points located at the inland and sea about 200 m from the shoreline fig 11a these profiles illustrate the near shore flushing of salinity at depth as there exists a freshwater body at depth in both land and sea areas near zero concentration at around 1000 masl in fig 11b and freshwater is mixed with saline water as it becomes shallower under the seafloor dashed red line in fig 11b while salinity is increased at the land area indicating sea water intrusion 400 to 200 masl for solid red line in fig 1b it is also clearly shown that groundwater velocity decreases with depth in general and geology is a single major determining factor to identify the static zone to host the repository it is first noted that the computational cost for the transient density driven flow and transport simulations was truly excessive to obtain the steady state solution however the ptpc method requires less than 100 computing steps and less than a day of computing to obtain the solution under the same computing environment multicore processor computers additionally it is still challenging to apply the model for inverse simulations requiring 100 s to 1000s forward simulations but the ptpc application is a significant move forward to overcome the challenges associated with the solution of steady state nonlinear equations 5 summary and conclusions the ptc and pc approaches have been widely applied in solving steady state nonlinear equations the ptc approach is an attempt to perform time integration more efficiently based on the steady state residual as an objective function to minimize while the pc approach re states that the steady state residual is a function of a set of parameters or a parameter i e maximum density the ptc method is more straightforward to converge but carries the weakness of transient simulations high computational cost and the pc approach is relatively efficient by solving the steady state equations but often convergence is not guaranteed this study suggested a hybrid ptpc approach for density driven flow and transport simulations where the maximum density is gradually adjusted to the target value in the pseudo transient framework based on the demonstration result for a proof of concept example this hybrid approach converges as easily as in ptc and sacrifices the minimal computational efficiency of a pc it was also shown that there was an optimal level of aggressiveness in adjusting the maximum density for the ptpc approach the ptpc method was then applied to solve the density driven flow problem for the suruga bay area in japan where the computational cost was extremely large for transient density driven flow and transport simulations the hybrid ptpc scheme can be easily implemented in existing models and it can be extended further to solve other types of steady state nonlinear equations e g saint venant equation for overland flow richards equation for variably saturated flow etc in this study the optimal scheduling in ptpc was estimated based on the test cases with similar yet simpler proof of concept problems but it can be further improved when the level of aggressiveness can be adjusted during simulations author statement young jin park conceptualization software formal analysis methodology investigation writing original draft writing review editing hyoun tae hwang software formal analysis methodology resources investigation writing original draft writing review editing takuma hasegawa resources formal analysis application writing review editing shunichi okamoto resources formal analysis application writing review editing takenori ozutsumi resources formal analysis application writing review editing tatsuya tanaka resources formal analysis application writing review editing yutaka morita resources formal analysis application writing review editing walter a illman resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study uses the groundwater model developed by the project for validating assessment methodology of geological disposal system in coastal region fy2019 and fy2020 grant number jpj007597 which is supported by the japanese ministry of economy trade and industry meti and is a joint research with radioactive waste management funding and research center rwmc and national institute of advanced industrial science and technology aist we thank professors y e yoshida nagoya university s takeuchi nihon univ t sato hokkaido university h sato okayama univ s uchida national institutes of quantum science and technology and colleagues for their advice 
49,while induced bank filtration is a proven method for facilitating sustainable drinking water production it is at risk from surface water contaminations e g pathogens induced bank filtration and pathogen transport in groundwater have been studied extensively however long term studies that consider real world conditions are missing these conditions include seasonal changes to environmental conditions and waterworks operations therefore to analyze the effect of seasonal changes on the transport of human pathogenic viruses and their indicators in induced bank filtration concentrations of adenoviruses and pathogen indicators were monitored over 16 months at an active bank filtration plant at the rhine river in düsseldorf germany based on this data a 2d groundwater model was created in pflotran that simulated flow heat transport conservative transport of chloride and the resulting electrical conductivity reactive transport of oxygen and nitrate and colloid based transport of coliforms somatic coliphages and adenoviruses the results show that reduced travel time was the key factor determining periods with a low removal of coliforms and somatic coliphages in the aquifer travel time was controlled by river level variations during rainy seasons and the waterworks extraction rates during dry seasons for adenovirus transport travel distance in the subsurface appeared to be the key factor while travel time had no significant impact coliform removal increased when the colmation layer permeability decreased while coliphage and adenovirus removal was unaffected by the colmation layer permeability seasonal changes in temperature and oxygen content did not significantly impact the removal of coliphages and adenoviruses in groundwater denitrifying conditions correlated with a lowered coliform removal but the modelling could not establish a connection between denitrifying conditions and coliform removal our study showed that removal of pathogens and pathogen indicators at induced bank filtration plants varies greatly in time and space e g for coliforms from 1 to 4 log levels at 20 m travel distance and that adenovirus transport differs considerably from transport of coliforms and somatic coliphages keywords bank filtration transport modelling virus bacteria pathogen pflotran data availability data will be made available on request 1 introduction induced bank filtration ibf a type of managed aquifer recharge mar is a proven method for facilitating sustainable drinking water production especially in regions with limited groundwater resources but with large surface water bodies dillon et al 2019 ibf is employed worldwide often in urbanized regions e g the city of berlin and cities along the danube and rhine rivers in europe dillon et al 2019 gillefalk et al 2018 sprenger et al 2017 for ibf extraction wells are placed close to river or lake banks most of the extracted water originates from the surface water body but has undergone a subsurface passage during which natural physical chemical and biological processes can reduce contaminant concentrations however in surface waters at riverbank filtration sites various contaminants with different degradation behavior can be present e g organic compounds pharmaceuticals metals and human pathogens such as viruses and bacteria engelhardt et al 2014 farnsworth and hering 2011 hu et al 2016 maeng et al 2011 sprenger et al 2014 additionally the efficacy of ibf in reducing contaminant concentrations is subject to environmental and climatic conditions for example floods are typically assessed as impairing ibf performance because they shorten the travel times of contaminants sprenger et al 2011 human pathogens are typically released into surface water with treated wastewater montazeri et al 2015 typical human pathogens in surface waters are adenovirus rotavirus enterococcus and giardia intestinalis which cause a variety of enteric diseases who 2017 modern drinking water guidelines and regulations such as those from the who 2017 and the european union 2020 use bacterial and viral indicators e g e coli and bacteriophages to assess the potential contamination by pathogens however studies have shown that bacterial and bacteriophage indicators as well as model viruses such as ms2 often employed in laboratory studies owing to safety restrictions when using human pathogenic viruses cannot adequately represent the characteristic transport behavior and fate of pathogenic viruses boehm et al 2019 pang et al 2021 this highlights the need to study the transport of real pathogens in the environment viruses and bacteria are transported in groundwater as bio colloids due to their size nm to low µm transport of bio colloids in the subsurface is affected by various processes such as advection dispersion inactivation loss of infectivity decay destruction of the particle attachment to and detachment from solid surfaces and straining physical filtration at small pore throats hunt and johnson 2017 numerous studies have shown that a large number of factors can influence the transport of bio colloids in groundwater these factors include porosity colloid size water flow velocity temperature ph surface charge of colloids and sediments ionic strength concentration of multivalent ions and micro and nanoscale roughness heterogeneity of grain surfaces johnson et al 2018 messina et al 2015 sadeghi et al 2013 sasidharan et al 2017 torkzaban and bradford 2016 tufenkji and elimelech 2004 however comparisons between field observations and laboratory experiments conducted under similar conditions show that laboratory studies typically overestimate the removal of viruses and bacteria during underground passage see oudega et al 2021 and references therein in contrast to the large number of laboratory studies detailed studies at the field scale that investigate pathogenic viruses and bacteria transport are less frequent furthermore many studies have focused on indicators rather than on pathogens directly and on artificial injection experiments such experiments were performed for example by oudega et al 2021 with bacterial endospores and coliphages by hornstra et al 2018 with bacteriophages under anoxic conditions and by kvitsand et al 2015 with bacteriophages in an aquifer located in a cold climate 6 c induced or natural bank filtration was studied for example by betancourt et al 2014 sprenger et al 2014 and weiss et al 2005 removal of naturally occurring viruses at a vertical infiltration site was studied by morrison et al 2020 however detailed and long term multi month field studies on pathogen transport are rare thus bradford and harvey 2017 concluded in their review publication that field research is needed to improve our understanding of virus and bacteria transport in groundwater while laboratory scale models can account for a huge number of complex processes including the effects of nanoscale heterogeneity as in johnson et al 2018 models that investigate field scale processes are typically constrained to simple first order kinetics due to numerical limitations and uncertainty about subsurface properties therefore currently available field scale models only include inactivation attachment and detachment using colloid filtration theory for the attachment coefficient e g oudega et al 2021 some researchers have used two site models considering favorable and unfavorable attachment sites sasidharan et al 2021 kvitsand et al 2015 hornstra et al 2018 also considered blocking limitation of attachment sites and knabe et al 2021 included straining however employing a more detailed process based numerical modelling approach is less common in general at field scale currently published models are still insufficient because many processes are neglected and the impact of heterogeneity bradford and harvey 2017 and transient boundary conditions wang et al 2020 is disregarded therefore a 16 month monitoring campaign was performed to improve our understanding of virus and bacteria transport in groundwater at field scale and under natural uncontrolled transient hydraulic and geochemical conditions the campaign included high resolution measurements of selected pathogens and their indicators along a transect of an ibf waterworks facility in düsseldorf germany wang et al 2022 this study investigated environmental factors that vary greatly between seasons river level oxygen content temperature and riverbed permeability a model based analysis was conducted to investigate the impact of these parameters on transport of coliforms somatic coliphages and adenovirus during ibf the numerical code pflotran a subsurface flow and reactive transport code was used for this goal pflotran has been used by many researchers including avasarala et al 2017 dwivedi et al 2018b hammond et al 2011 knabe et al 2021 and navarre sitchler et al 2013 pflotran was selected as modelling code because of its scalability on high performance computing clusters pflotran allows for faster calculation times and its open source code enables flexibility in the definition of rate equations making it a good choice for modelling complex reactive transport systems this study aimed to identify key parameters and processes for virus and bacteria transport in induced bank filtration this study also investigated the differences between viruses and bacteria transport using an active ibf facility as a research site allows for the study of transport processes under real world conditions which increases the practical relevance and the transferability of the results to other ibf sites 2 methods 2 1 investigated field site and sample collection this study was conducted at an ibf site at the rhine river in düsseldorf germany waterworks flehe this site has been investigated in several previous studies knabe et al 2021 sharma et al 2012 schubert 2002 to investigate the transport of viruses and bacteria during ibf a 16 month sampling campaign was conducted from the end of 01 2018 to 05 2019 water samples were collected every two to four weeks in the rhine river and in observations wells built along a transect perpendicular to the river fig 1 samples were analyzed onsite for standard physical chemical parameters o2 ph electrical conductivity ec and in the laboratory for major anions cations and selected microbiological parameters total coliforms escherichia coli somatic coliphages f coliphages and adenovirus for the production well pw only mixed samples were available that contained water from multiple production wells additionally piezometric pressure heads and temperature were measured continuously every 5 min in selected observation wells using data loggers pressure temperature pt logger solinst levelogger edge temperature t logger onset tidbit v2 for the wells equipped with a pt and a t logger the t logger was placed 0 5 m above the pt logger with both being inside the screened well section 1 m river water samples were collected about 700 m downstream of the transect at a sampling point for river water used by local water authorities which gathers water from above the riverbed by using a pumping system river level and temperature were measured continuously by the local water authorities at a gauging station 12 7 km downstream the sampling procedure and the analytical methods are described in detail in wang et al 2022 in brief to quantify e coli and coliforms the colilert 18 assay iso 9308 2 1990 was used while coliphage numbers were assessed according to binder 2013 adenovirus was quantified by digital droplet pcr following the guidelines of huggett 2020 2 2 numerical model setup flow transport discretization boundary conditions to simulate groundwater flow and transport of heat and solutes as well as colloid based transport of viruses and bacteria the open source modelling code pflotran was used hammond et al 2014 www pflotran org the th thermo hydraulic mode was employed for flow and heat transport the girt global implicit reactive transport mode was employed for advective dispersive and reactive transport the rate equations described below were implemented via the reaction sandbox feature the geometry and design of the production well gallery is such that the flow is perpendicular to the river and along the transect knabe et al 2021 schubert 2002 fig 1 left a numerical 2d model of the bank filtration transect fig 1 right was set up using cells with dz 0 25 m and a variable dx with finer discretization square shaped cells in the riverbank to reduce numerical dispersion where flow is less horizontal d x 5 0 m x 170 165 2 0 m x 165 151 1 0 m x 151 80 v x 46 33 0 5 m x 80 77 v x 50 46 0 25 m x 77 50 time variant dirichlet boundary conditions were set based on the measured data at the river and for the regional groundwater at well row e fig 1 right the boundary conditions were set for piezometric pressure head groundwater temperature and concentrations of solutes bacteria and viruses at two locations i at the top of the cells adjacent to the river green and orange in fig 1 right and ii at the right side boundary of the model domain to account for the river level difference between the measuring point and transect location 12 7 km distance the measured river level was corrected by using the known local average river level gradient of 0 2 m river level per 1000 m distance along the river no flow boundaries were set at the bottom aquitard and left side flow to from opposite riverbank was irrelevant the production well pw was implemented as a sink located along the screened section the model simulates 500 days starting at 01 01 2018 day 0 with a prior spin up period of 50 days with all boundary condition values set to those observed at day 0 except for all virus and bacteria species whose concentrations were set to zero this spin up period provides the initial conditions for the piezometric pressure heads temperature and solute concentrations as quasi steady state with the initial boundary condition values pflotran s adaptive time stepping was used with at most 0 1 day time steps 2 3 subsurface heterogeneity subsurface heterogeneity fig 1 right was based on grain size analyses of the borehole profiles of the wells the aquifer was divided into two zones a highly permeable hk mostly coarse sand and gravel zone and a lower permeable lk higher medium sand content with some coarse sand and fine gravel zone with two permeabilities khk and klk and two porosities nhk and nlk respectively permeability and porosity of the aquitard silty fine sand and the soil zone silty clayey sand were set to 10 11 m² and 0 2 respectively the colmation layer or clogging layer directly at the interface between surface water and subsurface was discretized into an additional layer with a thickness of one cell dz 0 25 m as a result of to numerical restrictions forced by the computational time the previously published colmation layer thickness of 10 cm by schubert 2002 had to be increased the hydraulic properties of the colmation layer can change over time due to i biogeochemical activity bio clogging unclogging by grazing of benthic lifeforms ii physical clogging by forced inflow of river water due to the constant pumping in the production wells and iii changes in river discharge and sediment transport doppler et al 2007 engeler et al 2011 newcomer et al 2016 the colmation layer was also divided into two zones one located within the riverbed and the other zone located at higher elevation along the riverbank fig 1 right the second zone was assumed to be strongly clogged because of the lower erosive potential of the river at this elevation and the presence of an armor layer to protect the riverbank this study compares two model concepts to consider the impact of the colmation layer a time invariant ti and a time variant tv model the tv model uses discrete time periods to account for changes in river level extraction rates and a period when the waterworks pumps were shut down for 43 days for maintenance the periods in the tv model were i winter 2017 18 with a flood days 0 40 ii spring days 40 100 iii spring with maintenance period of the waterworks and including a 14 day recovery period after pumps were restarted days 100 157 iv summer and autumn 2018 with falling river level days 157 335 v winter 2018 19 with rising river level days 335 425 vi end of winter 2018 and spring 2019 days 425 500 the 14 day recovery in period iii is based on an older experiment mentioned in schubert 2002 which indicated that reclogging took about 14 days permeabilities of the riverbed were calibrated for each period the permeability of the riverbank was fixed at k bank clog 10 13 m 2 except during period iii where flow direction was reversed and unclogging is assumed to have occurred k bank unclog 10 11 m 2 k bed iii 10 11 m 2 for the ti model both kbed and kbank were calibrated a single longitudinal dispersivity was set as a calibration parameter for all subsurface zones excluding the colmation layer δ l aq transversal dispersivity δ t aq was fixed at δ t aq 0 1 δ l aq similar to the approach by hester et al 2013 dispersivity of the colmation layer and aquifer are unlikely to be similar owing to different sediment structure and thus different heterogeneity initial model tests showed that dispersivity and porosity parameters for the colmation layer were highly uncertain after calibration with the conservative transport data however it was observed that a low dispersivity is needed for the colmation layer to potentially influence virus and bacteria transport because heterogeneity is reduced in the colmation layer a low dispersivity is reasonable therefore longitudinal dispersivity and porosity for the colmation layer were fixed with δ l colm 0 5 m and ncolm 0 2 the thermal conductivity under saturated conditions for all layers was set to κ 3 3 w m k while heat capacity of the aquifer layers was set to c a q f 869 j k g k since most of the sediments consist of sand and gravel for the aquitard it was set to c n a q f 1500 j k g k to account for an increased fraction of fine clay and silt particles stauffer et al 2013 2 4 mean travel time mean travel times were calculated with pflotran s tracer mean age capability which follows the method of goode 1996 with the following equations gardner et al 2015 1 a n ρ t n ρ a ρ q w n ρ d a q a 2 a 0 t c d t 0 c d t where a is the mean age for a mixture of groundwater s n is the porosity ρ is the water density kg m 3 t is the time s c is the concentration of groundwater with a given age mol l 1 qw is the groundwater flux m³ s 1 d is the dispersion coefficient m² s 1 and qa is a generic source sink for age kg m 3 the calculated water age was set to start at 0 days upon entering the model on either side river or regional groundwater and can therefore be interpreted as mean travel time from the model boundary at any observation point in the model domain 2 5 simulation of aerobic respiration and denitrification consumption of oxygen by degradation of dissolved organic carbon doc for simplicity assumed as acetate ch 3 coo was simulated according to previously published research knabe et al 2021 sharma et al 2012 however the equations were modified to allow a heterogeneous distribution of bacteria facilitating the reaction 3 o 2 1 2 c h 3 c o o h c o 3 1 2 h 4 r o 2 f t o 2 c b o 2 j k o 2 c o 2 k o 2 c o 2 c d o c k d o c o 2 c d o c 5 f t o 2 exp β o 2 t 1 0 5 t t o p t exp β o 2 20 c 1 0 5 20 c t o p t where r o 2 is the reduction rate for o 2 mol l 1s 1 c o2 doc are the concentrations of o 2 and doc respectively mol l 1 k o 2 is the rate constant mol l 1 s 1 k o 2 and k d o c o 2 are monod half saturation constants mol l 1 ft is a factor including temperature effects on the reaction rate normalized to 20 c t is temperature c β o 2 is a calibration parameter influencing the rate of change for ft with temperature c 1 topt is the temperature at which the reaction rate is the fastest c and c b o 2 j is the normalized concentration of aerobic bacteria facilitating the reaction in zone j aerobic bacteria were assumed to be immobile with a constant concentration the subsurface was divided into two zones the zone close to the river where more nutrients are available resulting in higher aerobic bacteria concentrations c b o 2 h 1 and the zone in the bulk aquifer with lower aerobic bacteria concentrations c b o 2 l 1 a calibration parameter the extension of the zone with higher aerobic bacteria concentrations was adjusted during model calibration xaerobic as horizontal and vertical distance from the river aerobic bacteria concentrations in model cells where the zone border was located were calculated as a weighted average between concentrations of both zones the weights result from the proportion of the zones in the cell denitrification was modelled similar to aerobic respiration but includes an inhibition factor for dissolved oxygen e g arora et al 2016 dwivedi et al 2018 rodríguez escales et al 2014 6 n o 3 5 8 c h 3 c o o 7 2 h 1 2 n 2 5 8 h c o 3 19 8 h 2 o 7 r n o 3 f t n o 3 c b n o 3 j k n o 3 c n o 3 k n o 3 c n o 3 c d o c k d o c n c d o c i o 2 i o 2 c o 2 8 f t n o 3 exp β n o 3 t 1 0 5 t t o p t exp β n o 3 20 c 1 0 5 20 c t o p t where r n o 3 is the reduction rate for n o 3 mol l 1 s 1 c n o 3 o 2 d o c is the concentration of n o 3 o 2 and doc respectively mol l 1 k n o 3 is the rate constant mol l 1 s 1 k n o 3 and k doc n are monod half saturation constants mol l 1 i o 2 is the inhibition constant for o 2 on denitrification mol l 1 f t n o 3 is a factor including temperature effects on the reaction rate normalized to 20 c t is temperature c β n o 3 is a calibration parameter influencing the rate of change for f t n o 3 with temperature c 1 topt is the temperature at which the reaction rate is the fastest c and c b n o 3 j is the normalized concentration of denitrifying bacteria in subsurface zone j the measurements showed that denitrification was mostly limited to the lower permeable aquifer zone around wells b3 2 and d3 2 see section 3 2 therefore c b l n o 3 b d was set to 1 in the lk zone with x 30 m i e starting between well rows a and b for the remaining subsurface zones c b n o 3 r e s t 1 was a calibration parameter for simplification doc concentrations were assumed to have limited influence on the reaction rates k d o c o 2 and k doc n set to 10 6 mol l additionally topt was set to 35 c as in previous studies knabe et al 2021 sharma et al 2012 2 6 simulation of colloid based virus and bacteria transport the reactive transport model for viruses somatic coliphages and adenovirus and bacteria coliforms accounts for kinetic sorption and desorption attachment and detachment inactivation and straining a one site model was employed for coliforms somatic coliphages and adenoviruses additionally a two site model was tested for coliforms for which more data were available using the first order rate equations typical for field scale transport models for viruses and bacteria leads to hornstra et al 2018 torkzaban et al 2019 9 d c i d t r c i k a t t 1 i c i k d e t 1 i s 1 i k a t t 2 i c i k d e t 2 i s 2 i k i n i m c i k s t r i j c i 10 d s 1 i d t r s i k a t t 1 i c i k d e t 1 i s 1 i z i n i i m k i n i m s 1 i 11 d s 2 i d t r s i k a t t 2 i c i k d e t 2 i s 2 i z i n i i m k i n i m s 2 i where ci is the concentration of species i in the water phase viruses l 1 or bacteria l 1 s 1 2 i is the concentration of species i attached to the sediment at sites 1 or 2 respectively expressed with respect to the solute volume viruses l 1 or bacteria l 1 k att 1 2 i and k det 1 2 i are the attachment and detachment coefficients of species i at sites 1 or 2 respectively s 1 k in i m is the inactivation coefficient of species i in the water phase m s 1 z in i m is the ratio of the inactivation coefficient in the immobile phase to the mobile phase for species i and k str i j is the straining coefficient for species i in zone j s 1 adenovirus concentrations were measured via ddpcr see section 2 1 and therefore include active and inactive viruses thus k in i m represents decay rather than inactivation for adenoviruses the attachment coefficient was calculated using colloid filtration theory tufenkji and elimelech 2004 12 k a t t k i 3 2 1 θ d g j η α k i v where θ is the volumetric water content d g j is the effective grain diameter in subsurface zone j m η is the collision efficiency α k i is the attachment efficiency of species i at attachment site k and v is the mean particle velocity m s 1 η was calculated for every time step and cell using the equation proposed by messina et al 2015 α k i was a calibration parameter for each species to use the mean particle velocity in pflotran s reaction sandbox calculations a source code addition was necessary which can be found at https bitbucket org dknabe pflotran darcy velocity in reaction sandbox branch dustin darcy velocity in reaction sandbox for the two site model applied solely to the coliforms the first site was assumed to be a high turnover site higher α and higher detachment coefficient while the second site was assumed to be a low turnover site lower α and lower detachment coefficient straining was assumed to occur only at the colmation layer due to the lower grain size similarly straining was assumed to be only significant for bacteria due to the smaller size of viruses straining was calculated following bradford et al 2003 but without the depth dependency as this does not fit to field scale observations however the mean particle velocity was added because straining like attachment eq 12 depends on the amount of pore space passed and not on the travel time this leads to 13 k s t r i j p s t r v d p i d g j 1 42 where pstr is the straining constant m 1 v is the mean particle velocity m s 1 d p i is the diameter of species i m and d g j is the effective grain diameter in subsurface zone j m the species specific particle diameter and density were set based on the literature with 1 µm and 1 12 g cm³ for coliforms lewis et al 2014 ouzounov et al 2016 60 nm and 1 36 g cm³ for somatic coliphages burbano rosero et al 2011 hafenstein and fane 2002 and 95 nm and 1 33 g cm³ for adenovirus rafie et al 2021 sprinzl et al 2001 to reduce the number of calibration parameters the effective grain diameter of each subsurface zone was defined based on their grain size classification for the aquitard and the soil zone both composed of silty fine sand the effective diameter was set to 0 1 mm for the sand gravel aquifer the effective diameter for the high permeable zone coarse sand and gravel was set to 1 12 mm log average size of coarse sand for the low permeable zone higher medium sand fraction the effective diameter was set to 0 355 mm log average size of medium sand for the colmation layer the effective diameter was related to the permeability schubert 2002 reported that the clogged areas at the site are mainly silt therefore the effective diameter for a stronger clogged colmation layer assumed for permeability below 10 12 m2 was set to 0 006 mm and for a fully unclogged colmation layer similar to the aquifer assumed for permeability of 10 10 m2 the effective diameter was set to 1 mm with a double log linear interpolation for permeability values in between studies have shown that under anoxic conditions inactivation of viruses and bacteria can be lower frohnert et al 2014 gordon and toze 2003 this effect was considered for the model termed tv o applied only for coliforms the inactivation coefficient in the mobile phase was calculated for the tv o model with a step function 14 k i n i m c o 2 k i n i m 0 1 c o 2 c o 2 t h r f a n o x i c c o 2 c o 2 t h r where k in i m 0 is the inactivation coefficient of species i in the mobile phase under oxic conditions s 1 c o 2 is the concentration of dissolved oxygen mol l 1 c o 2 t h r is the threshold concentration of dissolved oxygen for the inactivation coefficient mol l 1 and fanoxic is the ratio of the inactivation coefficient between oxic and anoxic conditions coliform bacteria include species that can not only survive but also grow in the environment reitter et al 2021 for the model termed tv n the hypothesis of coliform growth via denitrification bueno et al 2018 was tested where eq 10 was expanded to 15 d s 1 i d t r s i k a t t 1 i c i k d e t 1 i s 1 i z i n i i m k i n i m s 1 i r n o 3 y where r n o 3 is the denitrification rate eq 7 mol l 1 s 1 and y is the coliform yield per mol n o 3 reduced bacteria mol 1 the grown coliforms were assumed to be at first immobile because the bacteria facilitating the denitrification were also immobile it was also assumed that coliform growth has no impact on the denitrification rate because coliform concentrations are too low 2 7 model calibration strategy model parameters were calibrated using particle swarm optimization pso robinson and rahmat samii 2004 a stochastic evolutionary algorithm that has been shown to yield robust results for environmental models with high numbers of parameters majone et al 2012 russian et al 2019 the algorithm was employed as previously in knabe et al 2021 which followed robinson and rahmat samii 2004 a short description of the algorithm is provided in supporting information s1 for each pso calibration 24 particles and 30 displacements iterations were employed numerical tests showed that this was a good compromise between final objective function value result quality and computational time fig 2 shows the multi stepped calibration strategy as well as calibrated and fixed parameters the parameters of the solution with the lowest objective function were retained for the next calibration step first the hydraulic and conservative transport parameters were calibrated using the observations of piezometric pressure head temperature chloride and electrical conductivity ec afterwards the reactive transport parameters for oxygen and nitrate consumption were calibrated followed by the virus and bacteria transport parameters for each species independently three pso calibrations were performed for each step and model which allows to identify highly uncertain parameters the objective function to be minimized in the calibration was defined with 16 ϕ k w k ϕ k where ϕ k is the partial objective function from target output variable k for example temperature or concentration of coliforms and wk is the weight associated with target output variable k the partial objective function was defined with 17 ϕ k 1 n k x t f m k x t f o k x t max x t f o k min x t f o k 2 where f m k x t is the model output and f o k x t is the observed value of target output variable k at location x and time t max x t f o k and min x t f o k are the maximum and minimum observed values of target variable k and nk is the total number of observations for target output variable k ϕ k can be interpreted as squared normalized residual averaged over all observation locations x and times t for microbiological measurements with no detection i e concentration below detection limit lod f o k x t was set to the lod and negative residuals i e when f m k x t lod were set to zero thus for a measured observation below lod all model output values below lod are equally valid weighting was only necessary in the multi variable calibration at the beginning using piezometric pressure head w 30 temperature w 10 chloride w 1 and ec w 1 weights were set so that each variable provided a significant contribution to the objective function because of the normalization eq 17 higher weights indicate variables that fit observations better relative to their overall variability in the data 3 results and discussion 3 1 impact of hydrological events on hydraulics and conservative transport 3 1 1 groundwater flow and heat transport the simulation of water flow and heat transport was based on the measured data of hydraulic pressure heads and groundwater temperature fig 3 a both of which have a distinctive seasonality the river level varied between 27 3 and 35 3 m a s l meter above sea level and the groundwater level varied for example between 26 8 and 33 7 m a s l at observation well c2 during winter and spring periods periods i ii v vi the river level was fluctuating substantially due to strong precipitation and snow melting events the strongest leading to a river level increase of about 3 m in 7 days in summer and fall 2018 period iv the river level slowly decreased by about 2 5 m over 180 days because of increased air temperature and extended dry periods the groundwater level followed the river level changes and fluctuations slightly dampened for example at observation well a3 the largest difference between groundwater level and river level was 1 m during the heavy rain event in period v while in period iv the difference was only a few centimeters the heat transport from the river towards the production well is clearly visible all riverside observation wells rows a and b show the river temperature trend only delayed and dampened fig 3a river water temperature varied between 2 4 and 28 1 c while at observation well a3 groundwater temperature varied between 5 3 and 25 3 c with the summer temperature peak occurring 18 days later than in the river in the landside observation wells row c groundwater temperature remained mostly constant varying between 12 9 and 14 0 c with two events where temperature dropped to about 8 c at period i ii and period vi those periods correlate with strong precipitation events and increasing river level the observed temperature seasonality including the high groundwater temperature differences between summer and winter 20 c is comparable to published literature investigating similar environmental and geometric settings massmann et al 2008a sheets et al 2002 the differing trends in the landside and riverside observation wells indicate the different water sources bank filtrate in the riverside and regional groundwater in the landside observation wells the two low temperature events at well row c show that at strongly increasing river levels bank filtrate can reach the landside observation wells water temperature at the production well was as expected a mixture between landside and riverside water temperatures both models the ti and tv model were able to simulate the measured piezometric pressure heads and temperature data very well however while the overall trend is captured stronger temperature differences between model and measured data at the production well indicate that water mixing between bank filtrate and regional groundwater is not perfectly represented in the model for the observation wells containing both a pt and a t logger 0 5 m apart the observed temperature differences between the loggers was mostly negligible 0 4 c however in observation wells a1 and b1 during july august 2018 the temperature difference reached up to 1 5 c this difference likely results from the presence of colder water in the aquitard directly below a1 and b1 during winter and spring periods the river level pattern was the primary driver for groundwater flow velocity changes the calculated darcy velocities reached up to 6 m day with travel times as short as 7 days at b1 during a rapid river level incline fig 3a and b the highest groundwater flow velocity and corresponding shortest travel time in winter 2017 18 period i were not significantly different from those in winter 2018 19 period v vi despite the highest river level being 2 m higher in winter 2017 18 the pumping rate ranged between 400 and 1000 m³ day for a single production well and was the primary driver for groundwater flow velocity changes in summer and fall period iv during period iv calculated darcy velocities mostly remained around 2 3 m day and the travel time from the river to observation well b1 was never below 11 days between 10 04 2018 and 24 05 2018 days 100 143 period iii pumps were shut down for maintenance and natural effluent conditions returned effluent conditions also occurred in short time period when the flood water receded in february 2018 days 39 46 compared to other results obtained for induced bank filtration sites travel times at our site mostly 7 20 days range within medium to low values reported travel times at other induced bank filtration sites range from 2 3 days to several months kvitsand et al 2017 massmann et al 2008b nagy kovács et al 2019 sheets et al 2002 3 1 2 conservative transport both the ti and tv model showed a good match for the measurements of chloride and electrical conductivity ec fig 4 in general chloride concentrations were similar in riverside 1 0 2 5 mmol l and landside observation wells 1 5 2 0 mmol l with some outliers at c1 although the trends showed differences in contrast stronger differences were observed for ec ranging between 450 720 µs cm for the riverside observation wells and 500 900 µs cm with a distinct maximum in period iv for the landside observation wells model results and measured data show that chloride and ec of the river water are found in the riverside observation wells with a lag time of 1 2 weeks e g mostly between 7 20 days for b1 fig 4 which is in good agreement with the travel time calculations fig 3b the mismatch between the conservative transport and measured data for ec at the production well similarly observed for temperature indicates that mixing between bank filtrate and regional groundwater is not perfectly captured in the model model results and measured data for ec show the short effluent period during the waterworks maintenance at days 134 and 148 the ec increased in observation well row b such an increase cannot be observed in well row a and the river indicating that during the waterworks maintenance regional groundwater with higher ec has reached well row b but not well row a 3 1 3 derived flow and conservative transport parameter model parameters were derived for the time variant tv and time invariant ti colmation layer models table 1 results show that estimated permeabilities for both aquifer zones are similar in both models tv 8 3 10 11 and 7 5 10 10 m² ti 1 3 10 10 and 6 2 10 10 m² and with little uncertainty in the three pso solutions the obtained permeabilities are reasonable for alluvial gravel and sand mixtures miller et al 2014 for the colmation layer in the tv model the calibrated permeability obtained for period i is relatively high 1 2 10 11 m² for period ii the calibrated permeability is very low 1 1 10 13 m² for period iii the permeability was fixed to simulate unclogged conditions 5 0 10 11 m² due to the natural effluent conditions and for period iv v and vi calibrated permeabilities range between 1 5 10 12 and 3 9 10 12 m² in contrast the ti model results in a calibrated permeability for the riverbed of 1 7 10 12 m² roughly an average of the tv model calibrated permeabilities and for the riverbank of 3 1 10 13 m² similar to the fixed value of 10 13 m² in the tv model for period i and part of period vi higher permeabilities derived with the tv model might have resulted from flooding events associated with higher flow velocity in the river for period vi the flooding event immediately precedes it these flooding events caused erosion scouring of the colmation layer a process that was also observed by zhang et al 2011 ulrich et al 2015 found that clogging mostly results from biological processes biomass build up in our case lower permeabilities occurred during warmer periods iv when biomass is more active however in periods ii and v estimated permeability was even lower in general the limited temporal resolution in our study of the colmation layer permeability 6 discrete time steps in 550 days provides only an approximation of the dynamic changes to the colmation layer because controlling processes physical clogging bio clogging and erosion from the river are varying at smaller time scales calibrated porosities range between 0 2 high permeability zone and 0 3 0 4 low permeability zone longitudinal dispersivity of the best fits for the tv and ti model differ 2 8 m and 6 1 m respectively however the uncertainty range for both is quite similar overall the change in concentration of chloride and ec in the river over time was often small compared to the short travel times often below 20 days for b fig 3b an exception was the lower chloride concentration during period v the limited changes in chloride concentrations linked with measurement errors and parameter correlations led to the comparably higher uncertainty in conservative transport parameters 3 2 reactive transport of dissolved oxygen nitrate and doc the reactive transport model fits the measured data for dissolved oxygen nitrate and doc reasonably well however in summer when oxygen consumption was highest the model underestimates doc concentrations aerobic respiration was assumed to be the primary process for doc removal but the doc misfit indicates that the stoichiometric assumption with doc as acetate is not fully correct and or doc was being affected by other processes dissolved oxygen concentrations in river water and groundwater show a clear seasonal fluctuation with lower concentrations prevailing in summer period iv fig 5 a similar to the observations of farnsworth and hering 2011 and massmann et al 2008a in groundwater hypoxic conditions with oxygen concentrations near zero existed between july and september 2018 the mean difference between river water and groundwater was 0 15 mmol l in winter and up to 0 25 mmol l in summer the larger difference between river water and groundwater in summer results from increased doc degradation rates enabled by higher groundwater temperatures the impact of temperature on the potential degradation rates is displayed by the 14 fold increase in f t o 2 eq 4 between winter 5 c and summer 25 c oxygen concentrations decreased between river water and groundwater in the observation wells near the riverbank row a 40 m distance however further along the flow path oxygen concentrations remain mostly constant between observation wells a and b 20 m distance the rapid oxygen decrease near the riverbank can be explained by higher microbiological activity closer to the river owing to increased nutrient concentrations or biofilm development within the colmation layer farnsworth and hering 2011 mindl et al 2015 newcomer et al 2016 the calibration of the reactive transport model estimated the extent of this high reactive zone hrz as 6 8 m and the reactivity ratio between the hrz and the bulk aquifer as cb o2 low 0 02 for all three pso solutions the results show that the hrz is significantly larger than the colmation layer itself and that downgradient of the hrz no significant reactions occurred in contrast to oxygen consumption denitrification occurred only further along the flow path and was restricted to the late summer when oxygen concentrations were very low denitrification was limited observed only between days 230 and 250 in the lower permeable aquifer zone observation wells b3 b2 d3 and d2 fig 5b and supporting information s4 the spatial limitation of denitrification could be explained by a higher concentration of denitrifying bacteria in the zone around wells b3 2 and d3 2 which was potentially caused by the lower grain size and the slower flow velocity possibly related to local heterogeneities as in briggs et al 2018 the ratio between the denitrifying bacteria concentration in the bulk aquifer and the zone around b3 2 and d3 2 was calibrated with c b n o 3 r e s t 0 1 for all solutions however the estimated values for β n o 3 between 2 5 3 would yield a rate increase by factor 100 for a temperature increase from 20 to 25 c this increase appears unrealistic and indicates that β n o 3 was overfitted stretched to unrealistic values and that relevant processes such as growth or acclimation time of the denitrifying bacteria rivett et al 2008 are missing in the model however since the nitrate concentration showed a good match with the experimental data and since this paper focuses on virus and bacteria transport this potential overfit for β n o 3 was deemed acceptable 3 3 reactive transport of adenovirus somatic coliphages and coliforms 3 3 1 detections in surface and groundwater multiple models were compared for the transport of coliforms cf somatic coliphages cp and adenovirus ad to determine key transport processes at field scale in bank filtration fig 6 displays an overview of the calibrated model results and the experimental data coliforms somatic coliphages and adenovirus were always found in the river varying between 2 and 3 orders of magnitude over the monitoring period cf 99 24 132 mpn 100 ml cp 0 8 115 pfu 100 ml ad 70 114 805 copies l these concentrations are the result of the continuous influx of treated wastewater into the river the ad concentrations are comparable to those reported by betancourt et al 2014 however they are still below concentrations observed in rivers that are more intensely affected by urban activities for example sprenger et al 2014 measured about 300 000 copies l ad and up to 189 000 pfu 100 ml cp in a highly polluted river in delhi india at our study site no clear seasonal trends were observable for coliform and adenovirus concentrations in the river however somatic coliphage concentrations appeared to be lowest in late spring and early summer 2018 and highest in winter 2018 19 in groundwater coliforms were detected intermittently throughout the year with higher concentrations in periods i and iii up to 419 mpn 100 ml at well row a detection limit 1 mpn 100 ml somatic coliphages were detected only at three times for both a2 and b1 all in winter in periods i v and vi with up to 1 5 pfu 100 ml at a2 detection limit 0 1 pfu 100 ml in contrast adenovirus showed a relatively constant concentration at a2 ranging between 12 and 150 copies l some samples below detection limit while not being detected at b1 detection limit 10 copies l these different detection patterns for coliforms somatic coliphages and adenovirus in groundwater indicate different transport behaviors during induced bank filtration however the measured detections for coliforms somatic coliphages and adenovirus are influenced by changes to their concentrations in the river to account for the changing concentrations in the river and to focus on the transport processes results are mainly shown as log removals fig 6 log difference between the concentration in observation well and the corresponding concentration in the river accounting for the conservative travel time the full set of results in terms of concentrations are shown in supporting information s5 3 3 2 influence of travel time as shown in section 3 1 excluding times of effluent conditions calculated travel times vary between 4 and 29 days in the riverside wells with the shortest times in the winter periods i v and vi it is known that shorter travel times favor lower removal as inactivation occurs over time e g de roda husman et al 2009 in fact for somatic coliphages the only three dates with detections in groundwater at days 30 344 and 492 are all associated with short travel times the calculated removal from the better fitting cp tv model follows the pattern of the travel times according to the model additional breakthroughs at low removal periods occurred during the winter 2018 19 periods v and vi basically during each heavy precipitation event further simulated breakthroughs with concentrations above the detection limit days 363 and 385 were missed due to the sampling interval however at day 407 the model estimates a breakthrough and measurements exist at a2 and b1 but both were below detection limit model overestimating by about 1 order of magnitude this might result from a missing process in the model or analytical errors in the measurements at the well and or the river boundary condition nevertheless the correlation is clear between detectable somatic coliphage concentrations in groundwater and periods with short travel times for coliforms a better match for the cf tv 2 model can be observed as it better replicates low removals down to ca 1 log level for row a ca 2 log level for b1 and the measured breakthroughs at day 30 flood winter 2017 18 period i and day 163 early summer 2018 period iii short travel times occurred at both day 30 and day 163 however in winter 2018 19 periods v and vi removal remained high at least between 3 4 log levels even when short travel times occurred as around day 30 period i therefore another process had become significant for coliform removal from winter 2017 18 to winter 2018 19 in contrast to both coliforms and somatic coliphages measured and simulated adenovirus were unaffected by travel time changes in fact model and experimental data show over most of the simulated period a relatively constant residual adenovirus concentration the only minor exception to this is the initial flood winter 2017 18 period i the influence of very short travel times in winter 2018 19 periods v and vi on the adenovirus concentration is indicated by the model results but is much smaller compared to the measured and simulated somatic coliphage concentrations this result indicates that safety distances for induced bank filtration sites distance between river and well calculated only from travel time and inactivation as for example in blaschke et al 2016 can lead to erroneous removal predictions for species whose removal is less influenced or not influenced by travel time such as adenoviruses in our case 3 3 3 influence of a changing colmation layer it was hypothesized that during the 16 month observation period the colmation layer properties change as a result of different hydrological or other environmental conditions temperature bio clogging the impact of the changing colmation layer can be analyzed by comparing the results of the ti and tv models overall the ti model performed worse than the tv model but this was stronger for coliforms 103 increased objective function compared to tv model than for somatic coliphages 70 and adenovirus 13 the removal of coliforms during periods v and vi between 3 4 log level at well row a and b is high compared to the removal in period i about 1 2 log level at row a 2 3 at row b where groundwater flow velocity temperature oxygen content and even the coliforms concentration in the river were similar the ti model fails to match this behavior while the tv model fits the data well fig 6 therefore the stronger clogged colmation layer resulting in increased attachment and straining can explain the increased removal of coliforms between period i and periods v vi for somatic coliphages and especially adenovirus the effect of the colmation layer appears minor since coliforms are more than 10 times larger than somatic coliphages and adenovirus it appears reasonable that they might be more affected by a lower effective grain size of the colmation layer especially when considering straining as a removal process in period iii natural effluent conditions occurred that were assumed to be leading to unclogging of the riverbank in the tv models after the restart of the waterworks pumps very high concentrations of coliforms were found in all riverside wells day 163 which afterwards quickly decreased for most wells below the detection limit day 177 removal for coliforms during this period was limited to 0 5 log level at a3 even lower according to the model again the cf tv 2 model showed a good match with the data while the cf ti model failed this shows that considering a changing colmation layer allowed for a better estimation of low removal for coliforms as before for somatic coliphages and adenovirus no concentration increase was observed at or around day 163 the cp tv model reveals that removal was low around day 163 however the somatic coliphage concentration in the river was low during this time resulting in concentrations below detection limit and therefore a potential increase at day 163 could not be detected by the sampling to summarize the colmation layer changes had a strong impact on coliform transport and a lower impact on somatic coliphages but no significant impact on adenovirus gupta et al 2009 derived from column experiments that scouring of the colmation layer during a flood event does not significantly reduce bacteria removal while ramazanpour esfahani et al 2020 derived also from column experiments that progressive clogging increased ms2 bacteriophage removal our results agree with ramazanpour esfahani et al 2020 however direct observations of the time dependent changes in the permeability of the colmation layer are missing in our study future research at field scale should include direct observation to better identify the impact of the changing colmation layer on pathogen transport 3 3 4 influence of temperature oxygen and nitrate the increased temperature in summer in combination with increased biological activities resulted in low oxygen concentrations to fully anoxic conditions potentially affecting virus and bacteria transport the reactive transport model was used to analyze the impact of these conditions on coliform removal but not on removal of somatic coliphages and adenovirus because their concentrations remained below detection limit during summer or remained relatively constant throughout the observation period furthermore for somatic coliphages and adenoviruses the calibrated models were able to match the data without an additional effect based on temperature or oxygen content during late summer and early autumn days 230 270 there were several detections of coliforms with little removal between a3 2 and b3 2 5 10 mpn 100 ml once at b3 43 mpn 100 ml when concentrations increased in the river during late summer reaching a high value of 15 000 24 000 mpn 100 ml between days 220 250 the tv 2 and ti 2 models showed increased concentrations at well row a but not at well row b the tv 2 o and tv 2 n models test the hypotheses that inactivation might have been reduced under low oxygen concentrations tv 2 o and that denitrification might have allowed growth of coliforms tv 2 n the results show that neither model concepts tv 2 o or tv 2 n resulted in a significantly better match of the observed data than the standard tv 2 model the objective function for tv 2 o and tv 2 n only decreased by less than 2 laboratory studies for bacteria and viruses have shown that higher temperatures typically lead to higher inactivation anders and chrysikopoulos 2006 de roda husman et al 2009 and that absence of oxygen leads to lower inactivation frohnert et al 2014 however the impact of both temperature and oxygen content on inactivation can be linked to the bioactivity gordon and toze 2003 in our study coliforms had locally higher concentrations lower removal during the late summer period high temperatures low oxygen content occasional denitrification but the standard models tv 2 and ti 2 underestimated the concentrations this would indicate the effect of variable oxygen concentration or denitrification however neither the tv 2 o nor the tv 2 n model were able to provide an improved fit given that coliform concentrations were high at both b3 and b2 around day 250 measurement or analytical errors are unlikely to be the cause therefore the model is likely missing an additional process or the relationship between coliform inactivation and oxygen concentration or denitrification is more complex than the implemented equations 3 3 5 comparison between cf cp and ad previous studies e g knabe et al 2021 kvitsand et al 2017 weiss et al 2005 as well the results of this study show that the removal of viruses and bacteria during induced bank filtration can vary considerably over time and space in our case close to the riverbank until well a2 removal varied for coliforms between 1 4 log levels for somatic coliphages between 1 3 and for adenovirus between 0 5 3 5 in log level m cf 0 025 0 1 cp 0 025 0 075 ad 0 013 0 087 in general the removal rates in terms of log level m fit into those collected by pang 2009 from the literature for aquifers of sand and gravel mixtures and different viruses and bacteria where most removal rates range between 0 005 to 0 1 log level m however while the overall variation range for removal was similar for coliforms somatic coliphages and adenovirus the trends for removal over time were different somatic coliphage removal was shown to be primarily affected by travel time which in turn was governed by the waterworks pumping rate and river level variations for coliforms the removal trend was similar in the beginning of the observation period winter 2017 18 to summer 2018 lower removal occurred at shorter travel times however especially in winter 2018 19 coliform removal was increased despite short travel times owing to an increased clogging of the colmation layer leading to higher removal in contrast transport of adenovirus appeared always heavily buffered by the colmation layer leading to a relatively constant adenovirus concentration close to the riverbank that decreased below the detection limit at some distance from the river thus even high adenovirus concentrations in the river were not transported far into the riverbank the calculated removal for adenovirus mainly reflects changes in the virus concentration in the river adenovirus removal was not affected by travel time but increased with travel distance assuming adenovirus concentration in the groundwater close to the river log average 50 copies l at a2 10 copies l at b1 is driven by the average concentration in the river log average 1000 copies l this leads to an average removal for adenovirus of 1 3 log level river to a2 and 1 7 river to b1 this average removal of adenovirus is only about half the size of the transient removal of cf and cp mostly between 2 4 log level but down to 0 5 1 at short travel times however since the transport behavior clearly differs among the pathogens removal rates cannot be transferred from coliforms and somatic coliphages to adenoviruses the different transport behavior of coliforms somatic coliphages and adenovirus is the result of different key transport processes the calibrated parameters table 3 show that transport of somatic coliphages which was strongly affected by travel time was dominated by inactivation very high k in cp m with up to 1e 5 1 s in contrast coliforms were less affected by travel time and adenovirus were unaffected by travel time and both show lower inactivation coefficients k in ad m 4e 7 and k in cf m around 2 4e 6 1 s for the better fitting tv 2 model these inactivation coefficients are comparable to values found in the literature for similar species de roda husman et al 2009 gordon and toze 2003 hornstra et al 2018 schijven et al 2013 attachment and detachment are similar for adenovirus and somatic coliphages with slightly higher attachment for adenovirus table 3 the attachment efficiency α for adenovirus was around 8e 3 with kdet ca 1e 8 1 s while α for somatic coliphages was around 1 5e 3 and kdet around 1e 8 1 s except for the best fit where α was 0 05 but kdet was significantly higher with 4e 4 1 s for coliforms the one site model cf tv 1 resulted in similarly low α values around 1 2e 3 and kdet around 1 5e 8 1 s while the two site model cf tv 2 resulted in an additional site with fast attachment and detachment α at 0 1 0 7 and kdet at 0 7 7e 5 1 s these values agree with those in hornstra et al 2018 and kvitsand et al 2015 where at some observation locations an additional fast attachment detachment site was necessary to match the measured data coliforms were considered to be additionally affected by straining in the colmation layer due to their larger size the straining coefficients p str cf for all coliform models were similar mostly around 1e5 1 m which appears relatively high leading to first order straining coefficients comparable to the higher values in bradford and bettahar 2005 in oudega et al 2021 bacteriophage phix174 showed increased removal compared to bacterium bacillus subtilis in our data removal of coliforms and somatic coliphages was quite similar in the first half of the observation period but in the second half removal of coliforms was higher than removal of somatic coliphages during the second half of our observation period removal of coliforms was increased because the colmation layer was more clogged increasing the effect of straining this had no effect on the removal of somatic coliphages because of their smaller size the increased removal of bacteriophages compared to bacteria in oudega et al 2021 is possibly related to weaker straining since oudega et al 2021 conducted an injection experiment in a sand gravel aquifer i e without the presence of a colmation layer the difference between somatic coliphages and adenovirus transport was mainly a result of their different inactivation however adenovirus concentrations were measured via ddpcr and thus include active and inactive viruses in contrast measurements of coliforms and somatic coliphages identified only active bacteria viruses for adenoviruses decay is observed rather than inactivation note that our model showed that inactivation was a primary removal mechanism for both coliforms and somatic coliphages boehm et al 2019 compared the decay and inactivation rates of multiple viruses across the literature for surface waters their results show that for those virus groups where data were available inactivation rates measured via cultivation tended to be higher up to an order of magnitude than decay rates measured via pcr de roda husman et al 2009 arrived at similar results studying poliovirus and coxsackievirus in artificial surface water and groundwater this indicates that the different analysis techniques in our study for adenoviruses via pcr and for somatic coliphages via cultivation can be a factor in the observed differences in transport behavior however active adenovirus concentrations relevant for infection risk would be even lower than those measured by pcr which were consistently always below the detection limit further into the riverbank well b1 in summary the transport of somatic coliphages was dominated by inactivation the transport of adenovirus by attachment to and detachment from the sediment and the transport of coliforms by straining and inactivation as well as attachment to and detachment from the sediment 4 conclusion the numerical code pflotran was used to analyze data from a 16 month monitoring to identify key transport processes and seasonal patterns of adenovirus somatic coliphages and coliforms at induced riverbank filtration sites our main findings are travel time changes resulted during rainy seasons from rapidly rising river levels after strong precipitation or snow melt events and during the dry season from changes in pumping rates shorter travel times reduced the removal efficiency for somatic coliphages and coliforms however adenovirus removal was independent of travel time but dependent on travel distance numerical analysis indicates that changes in the colmation clogging layer permeability are coupled to the river stage but are also affected by waterworks maintenance periods no pumping removal of coliforms was lower at higher colmation layer permeabilities after a flood and after a maintenance period however removal of viruses somatic coliphages and adenovirus was independent of the colmation layer permeability high groundwater temperatures and low oxygen concentrations associated with denitrification in late summer had no visible impact on removal of somatic coliphages and adenovirus for coliforms these conditions correlated with lower removal efficiencies however the numerical results did not support a correlation between lower oxygen concentrations and or denitrification with lower coliform removal the limited number of detections of somatic coliphages in groundwater made it difficult to identify key removal processes and parameters additionally uncertainty remains with respect to the concentration of active adenoviruses which are relevant in estimating the risk for drinking water production since our data contains information about total active and inactive i e infectious and non infectious adenovirus particles exclusively but even the total adenovirus concentration remained below the detection limit at 40 m distance from the riverbank and therefore the removal of active adenoviruses appears sufficient table 2 nevertheless developing methods to analyze active human pathogenic viruses at low concentrations would greatly improve the data basis for modelling and risk analysis studies given that drinking water target concentrations for active viruses can be as low as 10 5 viruses per liter who 2017 methods to detect low concentrations of pathogenic viruses could be a key target for future research declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we would like to thank the deutsche bundesstiftung umwelt dbu for financially supporting this study we greatly appreciate the support of the stadtwerke düsseldorf for sample collection and non virus related sample analysis the logged river data was thankfully provided by the german bundesanstalt für gewässerkunde additionally we would like to thank the north german supercomputing alliance hlrn for granting high performance computing resources dustin knabe acknowledges the geo x network and the watershed function science focus area project funded by the u s department of energy office of science and biological and environmental research under contract no de ac02 05ch11231 for supporting this study by providing funds for a research visit at lawrence berkeley national laboratory we thank daniel hawkes from lawrence berkeley national laboratory for technical editing supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2023 104389 appendix supplementary materials image application 1 image application 2 
49,while induced bank filtration is a proven method for facilitating sustainable drinking water production it is at risk from surface water contaminations e g pathogens induced bank filtration and pathogen transport in groundwater have been studied extensively however long term studies that consider real world conditions are missing these conditions include seasonal changes to environmental conditions and waterworks operations therefore to analyze the effect of seasonal changes on the transport of human pathogenic viruses and their indicators in induced bank filtration concentrations of adenoviruses and pathogen indicators were monitored over 16 months at an active bank filtration plant at the rhine river in düsseldorf germany based on this data a 2d groundwater model was created in pflotran that simulated flow heat transport conservative transport of chloride and the resulting electrical conductivity reactive transport of oxygen and nitrate and colloid based transport of coliforms somatic coliphages and adenoviruses the results show that reduced travel time was the key factor determining periods with a low removal of coliforms and somatic coliphages in the aquifer travel time was controlled by river level variations during rainy seasons and the waterworks extraction rates during dry seasons for adenovirus transport travel distance in the subsurface appeared to be the key factor while travel time had no significant impact coliform removal increased when the colmation layer permeability decreased while coliphage and adenovirus removal was unaffected by the colmation layer permeability seasonal changes in temperature and oxygen content did not significantly impact the removal of coliphages and adenoviruses in groundwater denitrifying conditions correlated with a lowered coliform removal but the modelling could not establish a connection between denitrifying conditions and coliform removal our study showed that removal of pathogens and pathogen indicators at induced bank filtration plants varies greatly in time and space e g for coliforms from 1 to 4 log levels at 20 m travel distance and that adenovirus transport differs considerably from transport of coliforms and somatic coliphages keywords bank filtration transport modelling virus bacteria pathogen pflotran data availability data will be made available on request 1 introduction induced bank filtration ibf a type of managed aquifer recharge mar is a proven method for facilitating sustainable drinking water production especially in regions with limited groundwater resources but with large surface water bodies dillon et al 2019 ibf is employed worldwide often in urbanized regions e g the city of berlin and cities along the danube and rhine rivers in europe dillon et al 2019 gillefalk et al 2018 sprenger et al 2017 for ibf extraction wells are placed close to river or lake banks most of the extracted water originates from the surface water body but has undergone a subsurface passage during which natural physical chemical and biological processes can reduce contaminant concentrations however in surface waters at riverbank filtration sites various contaminants with different degradation behavior can be present e g organic compounds pharmaceuticals metals and human pathogens such as viruses and bacteria engelhardt et al 2014 farnsworth and hering 2011 hu et al 2016 maeng et al 2011 sprenger et al 2014 additionally the efficacy of ibf in reducing contaminant concentrations is subject to environmental and climatic conditions for example floods are typically assessed as impairing ibf performance because they shorten the travel times of contaminants sprenger et al 2011 human pathogens are typically released into surface water with treated wastewater montazeri et al 2015 typical human pathogens in surface waters are adenovirus rotavirus enterococcus and giardia intestinalis which cause a variety of enteric diseases who 2017 modern drinking water guidelines and regulations such as those from the who 2017 and the european union 2020 use bacterial and viral indicators e g e coli and bacteriophages to assess the potential contamination by pathogens however studies have shown that bacterial and bacteriophage indicators as well as model viruses such as ms2 often employed in laboratory studies owing to safety restrictions when using human pathogenic viruses cannot adequately represent the characteristic transport behavior and fate of pathogenic viruses boehm et al 2019 pang et al 2021 this highlights the need to study the transport of real pathogens in the environment viruses and bacteria are transported in groundwater as bio colloids due to their size nm to low µm transport of bio colloids in the subsurface is affected by various processes such as advection dispersion inactivation loss of infectivity decay destruction of the particle attachment to and detachment from solid surfaces and straining physical filtration at small pore throats hunt and johnson 2017 numerous studies have shown that a large number of factors can influence the transport of bio colloids in groundwater these factors include porosity colloid size water flow velocity temperature ph surface charge of colloids and sediments ionic strength concentration of multivalent ions and micro and nanoscale roughness heterogeneity of grain surfaces johnson et al 2018 messina et al 2015 sadeghi et al 2013 sasidharan et al 2017 torkzaban and bradford 2016 tufenkji and elimelech 2004 however comparisons between field observations and laboratory experiments conducted under similar conditions show that laboratory studies typically overestimate the removal of viruses and bacteria during underground passage see oudega et al 2021 and references therein in contrast to the large number of laboratory studies detailed studies at the field scale that investigate pathogenic viruses and bacteria transport are less frequent furthermore many studies have focused on indicators rather than on pathogens directly and on artificial injection experiments such experiments were performed for example by oudega et al 2021 with bacterial endospores and coliphages by hornstra et al 2018 with bacteriophages under anoxic conditions and by kvitsand et al 2015 with bacteriophages in an aquifer located in a cold climate 6 c induced or natural bank filtration was studied for example by betancourt et al 2014 sprenger et al 2014 and weiss et al 2005 removal of naturally occurring viruses at a vertical infiltration site was studied by morrison et al 2020 however detailed and long term multi month field studies on pathogen transport are rare thus bradford and harvey 2017 concluded in their review publication that field research is needed to improve our understanding of virus and bacteria transport in groundwater while laboratory scale models can account for a huge number of complex processes including the effects of nanoscale heterogeneity as in johnson et al 2018 models that investigate field scale processes are typically constrained to simple first order kinetics due to numerical limitations and uncertainty about subsurface properties therefore currently available field scale models only include inactivation attachment and detachment using colloid filtration theory for the attachment coefficient e g oudega et al 2021 some researchers have used two site models considering favorable and unfavorable attachment sites sasidharan et al 2021 kvitsand et al 2015 hornstra et al 2018 also considered blocking limitation of attachment sites and knabe et al 2021 included straining however employing a more detailed process based numerical modelling approach is less common in general at field scale currently published models are still insufficient because many processes are neglected and the impact of heterogeneity bradford and harvey 2017 and transient boundary conditions wang et al 2020 is disregarded therefore a 16 month monitoring campaign was performed to improve our understanding of virus and bacteria transport in groundwater at field scale and under natural uncontrolled transient hydraulic and geochemical conditions the campaign included high resolution measurements of selected pathogens and their indicators along a transect of an ibf waterworks facility in düsseldorf germany wang et al 2022 this study investigated environmental factors that vary greatly between seasons river level oxygen content temperature and riverbed permeability a model based analysis was conducted to investigate the impact of these parameters on transport of coliforms somatic coliphages and adenovirus during ibf the numerical code pflotran a subsurface flow and reactive transport code was used for this goal pflotran has been used by many researchers including avasarala et al 2017 dwivedi et al 2018b hammond et al 2011 knabe et al 2021 and navarre sitchler et al 2013 pflotran was selected as modelling code because of its scalability on high performance computing clusters pflotran allows for faster calculation times and its open source code enables flexibility in the definition of rate equations making it a good choice for modelling complex reactive transport systems this study aimed to identify key parameters and processes for virus and bacteria transport in induced bank filtration this study also investigated the differences between viruses and bacteria transport using an active ibf facility as a research site allows for the study of transport processes under real world conditions which increases the practical relevance and the transferability of the results to other ibf sites 2 methods 2 1 investigated field site and sample collection this study was conducted at an ibf site at the rhine river in düsseldorf germany waterworks flehe this site has been investigated in several previous studies knabe et al 2021 sharma et al 2012 schubert 2002 to investigate the transport of viruses and bacteria during ibf a 16 month sampling campaign was conducted from the end of 01 2018 to 05 2019 water samples were collected every two to four weeks in the rhine river and in observations wells built along a transect perpendicular to the river fig 1 samples were analyzed onsite for standard physical chemical parameters o2 ph electrical conductivity ec and in the laboratory for major anions cations and selected microbiological parameters total coliforms escherichia coli somatic coliphages f coliphages and adenovirus for the production well pw only mixed samples were available that contained water from multiple production wells additionally piezometric pressure heads and temperature were measured continuously every 5 min in selected observation wells using data loggers pressure temperature pt logger solinst levelogger edge temperature t logger onset tidbit v2 for the wells equipped with a pt and a t logger the t logger was placed 0 5 m above the pt logger with both being inside the screened well section 1 m river water samples were collected about 700 m downstream of the transect at a sampling point for river water used by local water authorities which gathers water from above the riverbed by using a pumping system river level and temperature were measured continuously by the local water authorities at a gauging station 12 7 km downstream the sampling procedure and the analytical methods are described in detail in wang et al 2022 in brief to quantify e coli and coliforms the colilert 18 assay iso 9308 2 1990 was used while coliphage numbers were assessed according to binder 2013 adenovirus was quantified by digital droplet pcr following the guidelines of huggett 2020 2 2 numerical model setup flow transport discretization boundary conditions to simulate groundwater flow and transport of heat and solutes as well as colloid based transport of viruses and bacteria the open source modelling code pflotran was used hammond et al 2014 www pflotran org the th thermo hydraulic mode was employed for flow and heat transport the girt global implicit reactive transport mode was employed for advective dispersive and reactive transport the rate equations described below were implemented via the reaction sandbox feature the geometry and design of the production well gallery is such that the flow is perpendicular to the river and along the transect knabe et al 2021 schubert 2002 fig 1 left a numerical 2d model of the bank filtration transect fig 1 right was set up using cells with dz 0 25 m and a variable dx with finer discretization square shaped cells in the riverbank to reduce numerical dispersion where flow is less horizontal d x 5 0 m x 170 165 2 0 m x 165 151 1 0 m x 151 80 v x 46 33 0 5 m x 80 77 v x 50 46 0 25 m x 77 50 time variant dirichlet boundary conditions were set based on the measured data at the river and for the regional groundwater at well row e fig 1 right the boundary conditions were set for piezometric pressure head groundwater temperature and concentrations of solutes bacteria and viruses at two locations i at the top of the cells adjacent to the river green and orange in fig 1 right and ii at the right side boundary of the model domain to account for the river level difference between the measuring point and transect location 12 7 km distance the measured river level was corrected by using the known local average river level gradient of 0 2 m river level per 1000 m distance along the river no flow boundaries were set at the bottom aquitard and left side flow to from opposite riverbank was irrelevant the production well pw was implemented as a sink located along the screened section the model simulates 500 days starting at 01 01 2018 day 0 with a prior spin up period of 50 days with all boundary condition values set to those observed at day 0 except for all virus and bacteria species whose concentrations were set to zero this spin up period provides the initial conditions for the piezometric pressure heads temperature and solute concentrations as quasi steady state with the initial boundary condition values pflotran s adaptive time stepping was used with at most 0 1 day time steps 2 3 subsurface heterogeneity subsurface heterogeneity fig 1 right was based on grain size analyses of the borehole profiles of the wells the aquifer was divided into two zones a highly permeable hk mostly coarse sand and gravel zone and a lower permeable lk higher medium sand content with some coarse sand and fine gravel zone with two permeabilities khk and klk and two porosities nhk and nlk respectively permeability and porosity of the aquitard silty fine sand and the soil zone silty clayey sand were set to 10 11 m² and 0 2 respectively the colmation layer or clogging layer directly at the interface between surface water and subsurface was discretized into an additional layer with a thickness of one cell dz 0 25 m as a result of to numerical restrictions forced by the computational time the previously published colmation layer thickness of 10 cm by schubert 2002 had to be increased the hydraulic properties of the colmation layer can change over time due to i biogeochemical activity bio clogging unclogging by grazing of benthic lifeforms ii physical clogging by forced inflow of river water due to the constant pumping in the production wells and iii changes in river discharge and sediment transport doppler et al 2007 engeler et al 2011 newcomer et al 2016 the colmation layer was also divided into two zones one located within the riverbed and the other zone located at higher elevation along the riverbank fig 1 right the second zone was assumed to be strongly clogged because of the lower erosive potential of the river at this elevation and the presence of an armor layer to protect the riverbank this study compares two model concepts to consider the impact of the colmation layer a time invariant ti and a time variant tv model the tv model uses discrete time periods to account for changes in river level extraction rates and a period when the waterworks pumps were shut down for 43 days for maintenance the periods in the tv model were i winter 2017 18 with a flood days 0 40 ii spring days 40 100 iii spring with maintenance period of the waterworks and including a 14 day recovery period after pumps were restarted days 100 157 iv summer and autumn 2018 with falling river level days 157 335 v winter 2018 19 with rising river level days 335 425 vi end of winter 2018 and spring 2019 days 425 500 the 14 day recovery in period iii is based on an older experiment mentioned in schubert 2002 which indicated that reclogging took about 14 days permeabilities of the riverbed were calibrated for each period the permeability of the riverbank was fixed at k bank clog 10 13 m 2 except during period iii where flow direction was reversed and unclogging is assumed to have occurred k bank unclog 10 11 m 2 k bed iii 10 11 m 2 for the ti model both kbed and kbank were calibrated a single longitudinal dispersivity was set as a calibration parameter for all subsurface zones excluding the colmation layer δ l aq transversal dispersivity δ t aq was fixed at δ t aq 0 1 δ l aq similar to the approach by hester et al 2013 dispersivity of the colmation layer and aquifer are unlikely to be similar owing to different sediment structure and thus different heterogeneity initial model tests showed that dispersivity and porosity parameters for the colmation layer were highly uncertain after calibration with the conservative transport data however it was observed that a low dispersivity is needed for the colmation layer to potentially influence virus and bacteria transport because heterogeneity is reduced in the colmation layer a low dispersivity is reasonable therefore longitudinal dispersivity and porosity for the colmation layer were fixed with δ l colm 0 5 m and ncolm 0 2 the thermal conductivity under saturated conditions for all layers was set to κ 3 3 w m k while heat capacity of the aquifer layers was set to c a q f 869 j k g k since most of the sediments consist of sand and gravel for the aquitard it was set to c n a q f 1500 j k g k to account for an increased fraction of fine clay and silt particles stauffer et al 2013 2 4 mean travel time mean travel times were calculated with pflotran s tracer mean age capability which follows the method of goode 1996 with the following equations gardner et al 2015 1 a n ρ t n ρ a ρ q w n ρ d a q a 2 a 0 t c d t 0 c d t where a is the mean age for a mixture of groundwater s n is the porosity ρ is the water density kg m 3 t is the time s c is the concentration of groundwater with a given age mol l 1 qw is the groundwater flux m³ s 1 d is the dispersion coefficient m² s 1 and qa is a generic source sink for age kg m 3 the calculated water age was set to start at 0 days upon entering the model on either side river or regional groundwater and can therefore be interpreted as mean travel time from the model boundary at any observation point in the model domain 2 5 simulation of aerobic respiration and denitrification consumption of oxygen by degradation of dissolved organic carbon doc for simplicity assumed as acetate ch 3 coo was simulated according to previously published research knabe et al 2021 sharma et al 2012 however the equations were modified to allow a heterogeneous distribution of bacteria facilitating the reaction 3 o 2 1 2 c h 3 c o o h c o 3 1 2 h 4 r o 2 f t o 2 c b o 2 j k o 2 c o 2 k o 2 c o 2 c d o c k d o c o 2 c d o c 5 f t o 2 exp β o 2 t 1 0 5 t t o p t exp β o 2 20 c 1 0 5 20 c t o p t where r o 2 is the reduction rate for o 2 mol l 1s 1 c o2 doc are the concentrations of o 2 and doc respectively mol l 1 k o 2 is the rate constant mol l 1 s 1 k o 2 and k d o c o 2 are monod half saturation constants mol l 1 ft is a factor including temperature effects on the reaction rate normalized to 20 c t is temperature c β o 2 is a calibration parameter influencing the rate of change for ft with temperature c 1 topt is the temperature at which the reaction rate is the fastest c and c b o 2 j is the normalized concentration of aerobic bacteria facilitating the reaction in zone j aerobic bacteria were assumed to be immobile with a constant concentration the subsurface was divided into two zones the zone close to the river where more nutrients are available resulting in higher aerobic bacteria concentrations c b o 2 h 1 and the zone in the bulk aquifer with lower aerobic bacteria concentrations c b o 2 l 1 a calibration parameter the extension of the zone with higher aerobic bacteria concentrations was adjusted during model calibration xaerobic as horizontal and vertical distance from the river aerobic bacteria concentrations in model cells where the zone border was located were calculated as a weighted average between concentrations of both zones the weights result from the proportion of the zones in the cell denitrification was modelled similar to aerobic respiration but includes an inhibition factor for dissolved oxygen e g arora et al 2016 dwivedi et al 2018 rodríguez escales et al 2014 6 n o 3 5 8 c h 3 c o o 7 2 h 1 2 n 2 5 8 h c o 3 19 8 h 2 o 7 r n o 3 f t n o 3 c b n o 3 j k n o 3 c n o 3 k n o 3 c n o 3 c d o c k d o c n c d o c i o 2 i o 2 c o 2 8 f t n o 3 exp β n o 3 t 1 0 5 t t o p t exp β n o 3 20 c 1 0 5 20 c t o p t where r n o 3 is the reduction rate for n o 3 mol l 1 s 1 c n o 3 o 2 d o c is the concentration of n o 3 o 2 and doc respectively mol l 1 k n o 3 is the rate constant mol l 1 s 1 k n o 3 and k doc n are monod half saturation constants mol l 1 i o 2 is the inhibition constant for o 2 on denitrification mol l 1 f t n o 3 is a factor including temperature effects on the reaction rate normalized to 20 c t is temperature c β n o 3 is a calibration parameter influencing the rate of change for f t n o 3 with temperature c 1 topt is the temperature at which the reaction rate is the fastest c and c b n o 3 j is the normalized concentration of denitrifying bacteria in subsurface zone j the measurements showed that denitrification was mostly limited to the lower permeable aquifer zone around wells b3 2 and d3 2 see section 3 2 therefore c b l n o 3 b d was set to 1 in the lk zone with x 30 m i e starting between well rows a and b for the remaining subsurface zones c b n o 3 r e s t 1 was a calibration parameter for simplification doc concentrations were assumed to have limited influence on the reaction rates k d o c o 2 and k doc n set to 10 6 mol l additionally topt was set to 35 c as in previous studies knabe et al 2021 sharma et al 2012 2 6 simulation of colloid based virus and bacteria transport the reactive transport model for viruses somatic coliphages and adenovirus and bacteria coliforms accounts for kinetic sorption and desorption attachment and detachment inactivation and straining a one site model was employed for coliforms somatic coliphages and adenoviruses additionally a two site model was tested for coliforms for which more data were available using the first order rate equations typical for field scale transport models for viruses and bacteria leads to hornstra et al 2018 torkzaban et al 2019 9 d c i d t r c i k a t t 1 i c i k d e t 1 i s 1 i k a t t 2 i c i k d e t 2 i s 2 i k i n i m c i k s t r i j c i 10 d s 1 i d t r s i k a t t 1 i c i k d e t 1 i s 1 i z i n i i m k i n i m s 1 i 11 d s 2 i d t r s i k a t t 2 i c i k d e t 2 i s 2 i z i n i i m k i n i m s 2 i where ci is the concentration of species i in the water phase viruses l 1 or bacteria l 1 s 1 2 i is the concentration of species i attached to the sediment at sites 1 or 2 respectively expressed with respect to the solute volume viruses l 1 or bacteria l 1 k att 1 2 i and k det 1 2 i are the attachment and detachment coefficients of species i at sites 1 or 2 respectively s 1 k in i m is the inactivation coefficient of species i in the water phase m s 1 z in i m is the ratio of the inactivation coefficient in the immobile phase to the mobile phase for species i and k str i j is the straining coefficient for species i in zone j s 1 adenovirus concentrations were measured via ddpcr see section 2 1 and therefore include active and inactive viruses thus k in i m represents decay rather than inactivation for adenoviruses the attachment coefficient was calculated using colloid filtration theory tufenkji and elimelech 2004 12 k a t t k i 3 2 1 θ d g j η α k i v where θ is the volumetric water content d g j is the effective grain diameter in subsurface zone j m η is the collision efficiency α k i is the attachment efficiency of species i at attachment site k and v is the mean particle velocity m s 1 η was calculated for every time step and cell using the equation proposed by messina et al 2015 α k i was a calibration parameter for each species to use the mean particle velocity in pflotran s reaction sandbox calculations a source code addition was necessary which can be found at https bitbucket org dknabe pflotran darcy velocity in reaction sandbox branch dustin darcy velocity in reaction sandbox for the two site model applied solely to the coliforms the first site was assumed to be a high turnover site higher α and higher detachment coefficient while the second site was assumed to be a low turnover site lower α and lower detachment coefficient straining was assumed to occur only at the colmation layer due to the lower grain size similarly straining was assumed to be only significant for bacteria due to the smaller size of viruses straining was calculated following bradford et al 2003 but without the depth dependency as this does not fit to field scale observations however the mean particle velocity was added because straining like attachment eq 12 depends on the amount of pore space passed and not on the travel time this leads to 13 k s t r i j p s t r v d p i d g j 1 42 where pstr is the straining constant m 1 v is the mean particle velocity m s 1 d p i is the diameter of species i m and d g j is the effective grain diameter in subsurface zone j m the species specific particle diameter and density were set based on the literature with 1 µm and 1 12 g cm³ for coliforms lewis et al 2014 ouzounov et al 2016 60 nm and 1 36 g cm³ for somatic coliphages burbano rosero et al 2011 hafenstein and fane 2002 and 95 nm and 1 33 g cm³ for adenovirus rafie et al 2021 sprinzl et al 2001 to reduce the number of calibration parameters the effective grain diameter of each subsurface zone was defined based on their grain size classification for the aquitard and the soil zone both composed of silty fine sand the effective diameter was set to 0 1 mm for the sand gravel aquifer the effective diameter for the high permeable zone coarse sand and gravel was set to 1 12 mm log average size of coarse sand for the low permeable zone higher medium sand fraction the effective diameter was set to 0 355 mm log average size of medium sand for the colmation layer the effective diameter was related to the permeability schubert 2002 reported that the clogged areas at the site are mainly silt therefore the effective diameter for a stronger clogged colmation layer assumed for permeability below 10 12 m2 was set to 0 006 mm and for a fully unclogged colmation layer similar to the aquifer assumed for permeability of 10 10 m2 the effective diameter was set to 1 mm with a double log linear interpolation for permeability values in between studies have shown that under anoxic conditions inactivation of viruses and bacteria can be lower frohnert et al 2014 gordon and toze 2003 this effect was considered for the model termed tv o applied only for coliforms the inactivation coefficient in the mobile phase was calculated for the tv o model with a step function 14 k i n i m c o 2 k i n i m 0 1 c o 2 c o 2 t h r f a n o x i c c o 2 c o 2 t h r where k in i m 0 is the inactivation coefficient of species i in the mobile phase under oxic conditions s 1 c o 2 is the concentration of dissolved oxygen mol l 1 c o 2 t h r is the threshold concentration of dissolved oxygen for the inactivation coefficient mol l 1 and fanoxic is the ratio of the inactivation coefficient between oxic and anoxic conditions coliform bacteria include species that can not only survive but also grow in the environment reitter et al 2021 for the model termed tv n the hypothesis of coliform growth via denitrification bueno et al 2018 was tested where eq 10 was expanded to 15 d s 1 i d t r s i k a t t 1 i c i k d e t 1 i s 1 i z i n i i m k i n i m s 1 i r n o 3 y where r n o 3 is the denitrification rate eq 7 mol l 1 s 1 and y is the coliform yield per mol n o 3 reduced bacteria mol 1 the grown coliforms were assumed to be at first immobile because the bacteria facilitating the denitrification were also immobile it was also assumed that coliform growth has no impact on the denitrification rate because coliform concentrations are too low 2 7 model calibration strategy model parameters were calibrated using particle swarm optimization pso robinson and rahmat samii 2004 a stochastic evolutionary algorithm that has been shown to yield robust results for environmental models with high numbers of parameters majone et al 2012 russian et al 2019 the algorithm was employed as previously in knabe et al 2021 which followed robinson and rahmat samii 2004 a short description of the algorithm is provided in supporting information s1 for each pso calibration 24 particles and 30 displacements iterations were employed numerical tests showed that this was a good compromise between final objective function value result quality and computational time fig 2 shows the multi stepped calibration strategy as well as calibrated and fixed parameters the parameters of the solution with the lowest objective function were retained for the next calibration step first the hydraulic and conservative transport parameters were calibrated using the observations of piezometric pressure head temperature chloride and electrical conductivity ec afterwards the reactive transport parameters for oxygen and nitrate consumption were calibrated followed by the virus and bacteria transport parameters for each species independently three pso calibrations were performed for each step and model which allows to identify highly uncertain parameters the objective function to be minimized in the calibration was defined with 16 ϕ k w k ϕ k where ϕ k is the partial objective function from target output variable k for example temperature or concentration of coliforms and wk is the weight associated with target output variable k the partial objective function was defined with 17 ϕ k 1 n k x t f m k x t f o k x t max x t f o k min x t f o k 2 where f m k x t is the model output and f o k x t is the observed value of target output variable k at location x and time t max x t f o k and min x t f o k are the maximum and minimum observed values of target variable k and nk is the total number of observations for target output variable k ϕ k can be interpreted as squared normalized residual averaged over all observation locations x and times t for microbiological measurements with no detection i e concentration below detection limit lod f o k x t was set to the lod and negative residuals i e when f m k x t lod were set to zero thus for a measured observation below lod all model output values below lod are equally valid weighting was only necessary in the multi variable calibration at the beginning using piezometric pressure head w 30 temperature w 10 chloride w 1 and ec w 1 weights were set so that each variable provided a significant contribution to the objective function because of the normalization eq 17 higher weights indicate variables that fit observations better relative to their overall variability in the data 3 results and discussion 3 1 impact of hydrological events on hydraulics and conservative transport 3 1 1 groundwater flow and heat transport the simulation of water flow and heat transport was based on the measured data of hydraulic pressure heads and groundwater temperature fig 3 a both of which have a distinctive seasonality the river level varied between 27 3 and 35 3 m a s l meter above sea level and the groundwater level varied for example between 26 8 and 33 7 m a s l at observation well c2 during winter and spring periods periods i ii v vi the river level was fluctuating substantially due to strong precipitation and snow melting events the strongest leading to a river level increase of about 3 m in 7 days in summer and fall 2018 period iv the river level slowly decreased by about 2 5 m over 180 days because of increased air temperature and extended dry periods the groundwater level followed the river level changes and fluctuations slightly dampened for example at observation well a3 the largest difference between groundwater level and river level was 1 m during the heavy rain event in period v while in period iv the difference was only a few centimeters the heat transport from the river towards the production well is clearly visible all riverside observation wells rows a and b show the river temperature trend only delayed and dampened fig 3a river water temperature varied between 2 4 and 28 1 c while at observation well a3 groundwater temperature varied between 5 3 and 25 3 c with the summer temperature peak occurring 18 days later than in the river in the landside observation wells row c groundwater temperature remained mostly constant varying between 12 9 and 14 0 c with two events where temperature dropped to about 8 c at period i ii and period vi those periods correlate with strong precipitation events and increasing river level the observed temperature seasonality including the high groundwater temperature differences between summer and winter 20 c is comparable to published literature investigating similar environmental and geometric settings massmann et al 2008a sheets et al 2002 the differing trends in the landside and riverside observation wells indicate the different water sources bank filtrate in the riverside and regional groundwater in the landside observation wells the two low temperature events at well row c show that at strongly increasing river levels bank filtrate can reach the landside observation wells water temperature at the production well was as expected a mixture between landside and riverside water temperatures both models the ti and tv model were able to simulate the measured piezometric pressure heads and temperature data very well however while the overall trend is captured stronger temperature differences between model and measured data at the production well indicate that water mixing between bank filtrate and regional groundwater is not perfectly represented in the model for the observation wells containing both a pt and a t logger 0 5 m apart the observed temperature differences between the loggers was mostly negligible 0 4 c however in observation wells a1 and b1 during july august 2018 the temperature difference reached up to 1 5 c this difference likely results from the presence of colder water in the aquitard directly below a1 and b1 during winter and spring periods the river level pattern was the primary driver for groundwater flow velocity changes the calculated darcy velocities reached up to 6 m day with travel times as short as 7 days at b1 during a rapid river level incline fig 3a and b the highest groundwater flow velocity and corresponding shortest travel time in winter 2017 18 period i were not significantly different from those in winter 2018 19 period v vi despite the highest river level being 2 m higher in winter 2017 18 the pumping rate ranged between 400 and 1000 m³ day for a single production well and was the primary driver for groundwater flow velocity changes in summer and fall period iv during period iv calculated darcy velocities mostly remained around 2 3 m day and the travel time from the river to observation well b1 was never below 11 days between 10 04 2018 and 24 05 2018 days 100 143 period iii pumps were shut down for maintenance and natural effluent conditions returned effluent conditions also occurred in short time period when the flood water receded in february 2018 days 39 46 compared to other results obtained for induced bank filtration sites travel times at our site mostly 7 20 days range within medium to low values reported travel times at other induced bank filtration sites range from 2 3 days to several months kvitsand et al 2017 massmann et al 2008b nagy kovács et al 2019 sheets et al 2002 3 1 2 conservative transport both the ti and tv model showed a good match for the measurements of chloride and electrical conductivity ec fig 4 in general chloride concentrations were similar in riverside 1 0 2 5 mmol l and landside observation wells 1 5 2 0 mmol l with some outliers at c1 although the trends showed differences in contrast stronger differences were observed for ec ranging between 450 720 µs cm for the riverside observation wells and 500 900 µs cm with a distinct maximum in period iv for the landside observation wells model results and measured data show that chloride and ec of the river water are found in the riverside observation wells with a lag time of 1 2 weeks e g mostly between 7 20 days for b1 fig 4 which is in good agreement with the travel time calculations fig 3b the mismatch between the conservative transport and measured data for ec at the production well similarly observed for temperature indicates that mixing between bank filtrate and regional groundwater is not perfectly captured in the model model results and measured data for ec show the short effluent period during the waterworks maintenance at days 134 and 148 the ec increased in observation well row b such an increase cannot be observed in well row a and the river indicating that during the waterworks maintenance regional groundwater with higher ec has reached well row b but not well row a 3 1 3 derived flow and conservative transport parameter model parameters were derived for the time variant tv and time invariant ti colmation layer models table 1 results show that estimated permeabilities for both aquifer zones are similar in both models tv 8 3 10 11 and 7 5 10 10 m² ti 1 3 10 10 and 6 2 10 10 m² and with little uncertainty in the three pso solutions the obtained permeabilities are reasonable for alluvial gravel and sand mixtures miller et al 2014 for the colmation layer in the tv model the calibrated permeability obtained for period i is relatively high 1 2 10 11 m² for period ii the calibrated permeability is very low 1 1 10 13 m² for period iii the permeability was fixed to simulate unclogged conditions 5 0 10 11 m² due to the natural effluent conditions and for period iv v and vi calibrated permeabilities range between 1 5 10 12 and 3 9 10 12 m² in contrast the ti model results in a calibrated permeability for the riverbed of 1 7 10 12 m² roughly an average of the tv model calibrated permeabilities and for the riverbank of 3 1 10 13 m² similar to the fixed value of 10 13 m² in the tv model for period i and part of period vi higher permeabilities derived with the tv model might have resulted from flooding events associated with higher flow velocity in the river for period vi the flooding event immediately precedes it these flooding events caused erosion scouring of the colmation layer a process that was also observed by zhang et al 2011 ulrich et al 2015 found that clogging mostly results from biological processes biomass build up in our case lower permeabilities occurred during warmer periods iv when biomass is more active however in periods ii and v estimated permeability was even lower in general the limited temporal resolution in our study of the colmation layer permeability 6 discrete time steps in 550 days provides only an approximation of the dynamic changes to the colmation layer because controlling processes physical clogging bio clogging and erosion from the river are varying at smaller time scales calibrated porosities range between 0 2 high permeability zone and 0 3 0 4 low permeability zone longitudinal dispersivity of the best fits for the tv and ti model differ 2 8 m and 6 1 m respectively however the uncertainty range for both is quite similar overall the change in concentration of chloride and ec in the river over time was often small compared to the short travel times often below 20 days for b fig 3b an exception was the lower chloride concentration during period v the limited changes in chloride concentrations linked with measurement errors and parameter correlations led to the comparably higher uncertainty in conservative transport parameters 3 2 reactive transport of dissolved oxygen nitrate and doc the reactive transport model fits the measured data for dissolved oxygen nitrate and doc reasonably well however in summer when oxygen consumption was highest the model underestimates doc concentrations aerobic respiration was assumed to be the primary process for doc removal but the doc misfit indicates that the stoichiometric assumption with doc as acetate is not fully correct and or doc was being affected by other processes dissolved oxygen concentrations in river water and groundwater show a clear seasonal fluctuation with lower concentrations prevailing in summer period iv fig 5 a similar to the observations of farnsworth and hering 2011 and massmann et al 2008a in groundwater hypoxic conditions with oxygen concentrations near zero existed between july and september 2018 the mean difference between river water and groundwater was 0 15 mmol l in winter and up to 0 25 mmol l in summer the larger difference between river water and groundwater in summer results from increased doc degradation rates enabled by higher groundwater temperatures the impact of temperature on the potential degradation rates is displayed by the 14 fold increase in f t o 2 eq 4 between winter 5 c and summer 25 c oxygen concentrations decreased between river water and groundwater in the observation wells near the riverbank row a 40 m distance however further along the flow path oxygen concentrations remain mostly constant between observation wells a and b 20 m distance the rapid oxygen decrease near the riverbank can be explained by higher microbiological activity closer to the river owing to increased nutrient concentrations or biofilm development within the colmation layer farnsworth and hering 2011 mindl et al 2015 newcomer et al 2016 the calibration of the reactive transport model estimated the extent of this high reactive zone hrz as 6 8 m and the reactivity ratio between the hrz and the bulk aquifer as cb o2 low 0 02 for all three pso solutions the results show that the hrz is significantly larger than the colmation layer itself and that downgradient of the hrz no significant reactions occurred in contrast to oxygen consumption denitrification occurred only further along the flow path and was restricted to the late summer when oxygen concentrations were very low denitrification was limited observed only between days 230 and 250 in the lower permeable aquifer zone observation wells b3 b2 d3 and d2 fig 5b and supporting information s4 the spatial limitation of denitrification could be explained by a higher concentration of denitrifying bacteria in the zone around wells b3 2 and d3 2 which was potentially caused by the lower grain size and the slower flow velocity possibly related to local heterogeneities as in briggs et al 2018 the ratio between the denitrifying bacteria concentration in the bulk aquifer and the zone around b3 2 and d3 2 was calibrated with c b n o 3 r e s t 0 1 for all solutions however the estimated values for β n o 3 between 2 5 3 would yield a rate increase by factor 100 for a temperature increase from 20 to 25 c this increase appears unrealistic and indicates that β n o 3 was overfitted stretched to unrealistic values and that relevant processes such as growth or acclimation time of the denitrifying bacteria rivett et al 2008 are missing in the model however since the nitrate concentration showed a good match with the experimental data and since this paper focuses on virus and bacteria transport this potential overfit for β n o 3 was deemed acceptable 3 3 reactive transport of adenovirus somatic coliphages and coliforms 3 3 1 detections in surface and groundwater multiple models were compared for the transport of coliforms cf somatic coliphages cp and adenovirus ad to determine key transport processes at field scale in bank filtration fig 6 displays an overview of the calibrated model results and the experimental data coliforms somatic coliphages and adenovirus were always found in the river varying between 2 and 3 orders of magnitude over the monitoring period cf 99 24 132 mpn 100 ml cp 0 8 115 pfu 100 ml ad 70 114 805 copies l these concentrations are the result of the continuous influx of treated wastewater into the river the ad concentrations are comparable to those reported by betancourt et al 2014 however they are still below concentrations observed in rivers that are more intensely affected by urban activities for example sprenger et al 2014 measured about 300 000 copies l ad and up to 189 000 pfu 100 ml cp in a highly polluted river in delhi india at our study site no clear seasonal trends were observable for coliform and adenovirus concentrations in the river however somatic coliphage concentrations appeared to be lowest in late spring and early summer 2018 and highest in winter 2018 19 in groundwater coliforms were detected intermittently throughout the year with higher concentrations in periods i and iii up to 419 mpn 100 ml at well row a detection limit 1 mpn 100 ml somatic coliphages were detected only at three times for both a2 and b1 all in winter in periods i v and vi with up to 1 5 pfu 100 ml at a2 detection limit 0 1 pfu 100 ml in contrast adenovirus showed a relatively constant concentration at a2 ranging between 12 and 150 copies l some samples below detection limit while not being detected at b1 detection limit 10 copies l these different detection patterns for coliforms somatic coliphages and adenovirus in groundwater indicate different transport behaviors during induced bank filtration however the measured detections for coliforms somatic coliphages and adenovirus are influenced by changes to their concentrations in the river to account for the changing concentrations in the river and to focus on the transport processes results are mainly shown as log removals fig 6 log difference between the concentration in observation well and the corresponding concentration in the river accounting for the conservative travel time the full set of results in terms of concentrations are shown in supporting information s5 3 3 2 influence of travel time as shown in section 3 1 excluding times of effluent conditions calculated travel times vary between 4 and 29 days in the riverside wells with the shortest times in the winter periods i v and vi it is known that shorter travel times favor lower removal as inactivation occurs over time e g de roda husman et al 2009 in fact for somatic coliphages the only three dates with detections in groundwater at days 30 344 and 492 are all associated with short travel times the calculated removal from the better fitting cp tv model follows the pattern of the travel times according to the model additional breakthroughs at low removal periods occurred during the winter 2018 19 periods v and vi basically during each heavy precipitation event further simulated breakthroughs with concentrations above the detection limit days 363 and 385 were missed due to the sampling interval however at day 407 the model estimates a breakthrough and measurements exist at a2 and b1 but both were below detection limit model overestimating by about 1 order of magnitude this might result from a missing process in the model or analytical errors in the measurements at the well and or the river boundary condition nevertheless the correlation is clear between detectable somatic coliphage concentrations in groundwater and periods with short travel times for coliforms a better match for the cf tv 2 model can be observed as it better replicates low removals down to ca 1 log level for row a ca 2 log level for b1 and the measured breakthroughs at day 30 flood winter 2017 18 period i and day 163 early summer 2018 period iii short travel times occurred at both day 30 and day 163 however in winter 2018 19 periods v and vi removal remained high at least between 3 4 log levels even when short travel times occurred as around day 30 period i therefore another process had become significant for coliform removal from winter 2017 18 to winter 2018 19 in contrast to both coliforms and somatic coliphages measured and simulated adenovirus were unaffected by travel time changes in fact model and experimental data show over most of the simulated period a relatively constant residual adenovirus concentration the only minor exception to this is the initial flood winter 2017 18 period i the influence of very short travel times in winter 2018 19 periods v and vi on the adenovirus concentration is indicated by the model results but is much smaller compared to the measured and simulated somatic coliphage concentrations this result indicates that safety distances for induced bank filtration sites distance between river and well calculated only from travel time and inactivation as for example in blaschke et al 2016 can lead to erroneous removal predictions for species whose removal is less influenced or not influenced by travel time such as adenoviruses in our case 3 3 3 influence of a changing colmation layer it was hypothesized that during the 16 month observation period the colmation layer properties change as a result of different hydrological or other environmental conditions temperature bio clogging the impact of the changing colmation layer can be analyzed by comparing the results of the ti and tv models overall the ti model performed worse than the tv model but this was stronger for coliforms 103 increased objective function compared to tv model than for somatic coliphages 70 and adenovirus 13 the removal of coliforms during periods v and vi between 3 4 log level at well row a and b is high compared to the removal in period i about 1 2 log level at row a 2 3 at row b where groundwater flow velocity temperature oxygen content and even the coliforms concentration in the river were similar the ti model fails to match this behavior while the tv model fits the data well fig 6 therefore the stronger clogged colmation layer resulting in increased attachment and straining can explain the increased removal of coliforms between period i and periods v vi for somatic coliphages and especially adenovirus the effect of the colmation layer appears minor since coliforms are more than 10 times larger than somatic coliphages and adenovirus it appears reasonable that they might be more affected by a lower effective grain size of the colmation layer especially when considering straining as a removal process in period iii natural effluent conditions occurred that were assumed to be leading to unclogging of the riverbank in the tv models after the restart of the waterworks pumps very high concentrations of coliforms were found in all riverside wells day 163 which afterwards quickly decreased for most wells below the detection limit day 177 removal for coliforms during this period was limited to 0 5 log level at a3 even lower according to the model again the cf tv 2 model showed a good match with the data while the cf ti model failed this shows that considering a changing colmation layer allowed for a better estimation of low removal for coliforms as before for somatic coliphages and adenovirus no concentration increase was observed at or around day 163 the cp tv model reveals that removal was low around day 163 however the somatic coliphage concentration in the river was low during this time resulting in concentrations below detection limit and therefore a potential increase at day 163 could not be detected by the sampling to summarize the colmation layer changes had a strong impact on coliform transport and a lower impact on somatic coliphages but no significant impact on adenovirus gupta et al 2009 derived from column experiments that scouring of the colmation layer during a flood event does not significantly reduce bacteria removal while ramazanpour esfahani et al 2020 derived also from column experiments that progressive clogging increased ms2 bacteriophage removal our results agree with ramazanpour esfahani et al 2020 however direct observations of the time dependent changes in the permeability of the colmation layer are missing in our study future research at field scale should include direct observation to better identify the impact of the changing colmation layer on pathogen transport 3 3 4 influence of temperature oxygen and nitrate the increased temperature in summer in combination with increased biological activities resulted in low oxygen concentrations to fully anoxic conditions potentially affecting virus and bacteria transport the reactive transport model was used to analyze the impact of these conditions on coliform removal but not on removal of somatic coliphages and adenovirus because their concentrations remained below detection limit during summer or remained relatively constant throughout the observation period furthermore for somatic coliphages and adenoviruses the calibrated models were able to match the data without an additional effect based on temperature or oxygen content during late summer and early autumn days 230 270 there were several detections of coliforms with little removal between a3 2 and b3 2 5 10 mpn 100 ml once at b3 43 mpn 100 ml when concentrations increased in the river during late summer reaching a high value of 15 000 24 000 mpn 100 ml between days 220 250 the tv 2 and ti 2 models showed increased concentrations at well row a but not at well row b the tv 2 o and tv 2 n models test the hypotheses that inactivation might have been reduced under low oxygen concentrations tv 2 o and that denitrification might have allowed growth of coliforms tv 2 n the results show that neither model concepts tv 2 o or tv 2 n resulted in a significantly better match of the observed data than the standard tv 2 model the objective function for tv 2 o and tv 2 n only decreased by less than 2 laboratory studies for bacteria and viruses have shown that higher temperatures typically lead to higher inactivation anders and chrysikopoulos 2006 de roda husman et al 2009 and that absence of oxygen leads to lower inactivation frohnert et al 2014 however the impact of both temperature and oxygen content on inactivation can be linked to the bioactivity gordon and toze 2003 in our study coliforms had locally higher concentrations lower removal during the late summer period high temperatures low oxygen content occasional denitrification but the standard models tv 2 and ti 2 underestimated the concentrations this would indicate the effect of variable oxygen concentration or denitrification however neither the tv 2 o nor the tv 2 n model were able to provide an improved fit given that coliform concentrations were high at both b3 and b2 around day 250 measurement or analytical errors are unlikely to be the cause therefore the model is likely missing an additional process or the relationship between coliform inactivation and oxygen concentration or denitrification is more complex than the implemented equations 3 3 5 comparison between cf cp and ad previous studies e g knabe et al 2021 kvitsand et al 2017 weiss et al 2005 as well the results of this study show that the removal of viruses and bacteria during induced bank filtration can vary considerably over time and space in our case close to the riverbank until well a2 removal varied for coliforms between 1 4 log levels for somatic coliphages between 1 3 and for adenovirus between 0 5 3 5 in log level m cf 0 025 0 1 cp 0 025 0 075 ad 0 013 0 087 in general the removal rates in terms of log level m fit into those collected by pang 2009 from the literature for aquifers of sand and gravel mixtures and different viruses and bacteria where most removal rates range between 0 005 to 0 1 log level m however while the overall variation range for removal was similar for coliforms somatic coliphages and adenovirus the trends for removal over time were different somatic coliphage removal was shown to be primarily affected by travel time which in turn was governed by the waterworks pumping rate and river level variations for coliforms the removal trend was similar in the beginning of the observation period winter 2017 18 to summer 2018 lower removal occurred at shorter travel times however especially in winter 2018 19 coliform removal was increased despite short travel times owing to an increased clogging of the colmation layer leading to higher removal in contrast transport of adenovirus appeared always heavily buffered by the colmation layer leading to a relatively constant adenovirus concentration close to the riverbank that decreased below the detection limit at some distance from the river thus even high adenovirus concentrations in the river were not transported far into the riverbank the calculated removal for adenovirus mainly reflects changes in the virus concentration in the river adenovirus removal was not affected by travel time but increased with travel distance assuming adenovirus concentration in the groundwater close to the river log average 50 copies l at a2 10 copies l at b1 is driven by the average concentration in the river log average 1000 copies l this leads to an average removal for adenovirus of 1 3 log level river to a2 and 1 7 river to b1 this average removal of adenovirus is only about half the size of the transient removal of cf and cp mostly between 2 4 log level but down to 0 5 1 at short travel times however since the transport behavior clearly differs among the pathogens removal rates cannot be transferred from coliforms and somatic coliphages to adenoviruses the different transport behavior of coliforms somatic coliphages and adenovirus is the result of different key transport processes the calibrated parameters table 3 show that transport of somatic coliphages which was strongly affected by travel time was dominated by inactivation very high k in cp m with up to 1e 5 1 s in contrast coliforms were less affected by travel time and adenovirus were unaffected by travel time and both show lower inactivation coefficients k in ad m 4e 7 and k in cf m around 2 4e 6 1 s for the better fitting tv 2 model these inactivation coefficients are comparable to values found in the literature for similar species de roda husman et al 2009 gordon and toze 2003 hornstra et al 2018 schijven et al 2013 attachment and detachment are similar for adenovirus and somatic coliphages with slightly higher attachment for adenovirus table 3 the attachment efficiency α for adenovirus was around 8e 3 with kdet ca 1e 8 1 s while α for somatic coliphages was around 1 5e 3 and kdet around 1e 8 1 s except for the best fit where α was 0 05 but kdet was significantly higher with 4e 4 1 s for coliforms the one site model cf tv 1 resulted in similarly low α values around 1 2e 3 and kdet around 1 5e 8 1 s while the two site model cf tv 2 resulted in an additional site with fast attachment and detachment α at 0 1 0 7 and kdet at 0 7 7e 5 1 s these values agree with those in hornstra et al 2018 and kvitsand et al 2015 where at some observation locations an additional fast attachment detachment site was necessary to match the measured data coliforms were considered to be additionally affected by straining in the colmation layer due to their larger size the straining coefficients p str cf for all coliform models were similar mostly around 1e5 1 m which appears relatively high leading to first order straining coefficients comparable to the higher values in bradford and bettahar 2005 in oudega et al 2021 bacteriophage phix174 showed increased removal compared to bacterium bacillus subtilis in our data removal of coliforms and somatic coliphages was quite similar in the first half of the observation period but in the second half removal of coliforms was higher than removal of somatic coliphages during the second half of our observation period removal of coliforms was increased because the colmation layer was more clogged increasing the effect of straining this had no effect on the removal of somatic coliphages because of their smaller size the increased removal of bacteriophages compared to bacteria in oudega et al 2021 is possibly related to weaker straining since oudega et al 2021 conducted an injection experiment in a sand gravel aquifer i e without the presence of a colmation layer the difference between somatic coliphages and adenovirus transport was mainly a result of their different inactivation however adenovirus concentrations were measured via ddpcr and thus include active and inactive viruses in contrast measurements of coliforms and somatic coliphages identified only active bacteria viruses for adenoviruses decay is observed rather than inactivation note that our model showed that inactivation was a primary removal mechanism for both coliforms and somatic coliphages boehm et al 2019 compared the decay and inactivation rates of multiple viruses across the literature for surface waters their results show that for those virus groups where data were available inactivation rates measured via cultivation tended to be higher up to an order of magnitude than decay rates measured via pcr de roda husman et al 2009 arrived at similar results studying poliovirus and coxsackievirus in artificial surface water and groundwater this indicates that the different analysis techniques in our study for adenoviruses via pcr and for somatic coliphages via cultivation can be a factor in the observed differences in transport behavior however active adenovirus concentrations relevant for infection risk would be even lower than those measured by pcr which were consistently always below the detection limit further into the riverbank well b1 in summary the transport of somatic coliphages was dominated by inactivation the transport of adenovirus by attachment to and detachment from the sediment and the transport of coliforms by straining and inactivation as well as attachment to and detachment from the sediment 4 conclusion the numerical code pflotran was used to analyze data from a 16 month monitoring to identify key transport processes and seasonal patterns of adenovirus somatic coliphages and coliforms at induced riverbank filtration sites our main findings are travel time changes resulted during rainy seasons from rapidly rising river levels after strong precipitation or snow melt events and during the dry season from changes in pumping rates shorter travel times reduced the removal efficiency for somatic coliphages and coliforms however adenovirus removal was independent of travel time but dependent on travel distance numerical analysis indicates that changes in the colmation clogging layer permeability are coupled to the river stage but are also affected by waterworks maintenance periods no pumping removal of coliforms was lower at higher colmation layer permeabilities after a flood and after a maintenance period however removal of viruses somatic coliphages and adenovirus was independent of the colmation layer permeability high groundwater temperatures and low oxygen concentrations associated with denitrification in late summer had no visible impact on removal of somatic coliphages and adenovirus for coliforms these conditions correlated with lower removal efficiencies however the numerical results did not support a correlation between lower oxygen concentrations and or denitrification with lower coliform removal the limited number of detections of somatic coliphages in groundwater made it difficult to identify key removal processes and parameters additionally uncertainty remains with respect to the concentration of active adenoviruses which are relevant in estimating the risk for drinking water production since our data contains information about total active and inactive i e infectious and non infectious adenovirus particles exclusively but even the total adenovirus concentration remained below the detection limit at 40 m distance from the riverbank and therefore the removal of active adenoviruses appears sufficient table 2 nevertheless developing methods to analyze active human pathogenic viruses at low concentrations would greatly improve the data basis for modelling and risk analysis studies given that drinking water target concentrations for active viruses can be as low as 10 5 viruses per liter who 2017 methods to detect low concentrations of pathogenic viruses could be a key target for future research declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we would like to thank the deutsche bundesstiftung umwelt dbu for financially supporting this study we greatly appreciate the support of the stadtwerke düsseldorf for sample collection and non virus related sample analysis the logged river data was thankfully provided by the german bundesanstalt für gewässerkunde additionally we would like to thank the north german supercomputing alliance hlrn for granting high performance computing resources dustin knabe acknowledges the geo x network and the watershed function science focus area project funded by the u s department of energy office of science and biological and environmental research under contract no de ac02 05ch11231 for supporting this study by providing funds for a research visit at lawrence berkeley national laboratory we thank daniel hawkes from lawrence berkeley national laboratory for technical editing supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2023 104389 appendix supplementary materials image application 1 image application 2 
