index,text
22360,the drag thrust transition of a symmetric foil undergoing pitching oscillation in a uniform flow is numerically studied in the present work under a certain thickness based reynolds number r e d 255 the fluid dynamics around the oscillated foil at a series of values for the chord based reynolds number r e c are investigated the various values of r e c are obtained by keeping the maximum thickness of the foil fixed while rhythmically changing the chord length of the foil depending on the numerical results we uncover a scaling relation that links the amplitude based strouhal number s r a to the r e c at the drag thrust transition boundary which is briefly expressed as s r a r e c 1 through analysing the velocity field of the foil it is found that the drag thrust transition of the pitching foil is closely associated with the critical velocity of the latest vortex produced by the foil these findings helps in understanding the kinematic behaviour of aquatic animals and designing bio inspired underwater robots keywords pitching foil drag thrust transition scaling law bio inspired underwater robots 1 introduction birds flap their wings to conquer the sky and fish oscillate their fins to cruise the ocean it is widespread to see living beings keep moving around the world native swimmers must resist the drag from the water to maintain movement hence the evolutionary direction of aquatic animals may strongly depend on how they effectively move forward support for this standpoint is the finding that aquatic animals usually swim at a narrow range of the amplitude based strouhal number s r a regardless of the sizes and species of the swimmers taylor et al 2003 eloy 2012 where s r a is defined as the product of the pitching frequency f and peak to peak amplitude 2 a divided by the swimming speed u i e s r a 2 f a u on the other hand the optimal propulsive performance incurred by a flapping foil is also obtained in this range of s r a as 0 2 s r a 0 4 anderson et al 1998 read et al 2003 triantafyllou et al 2004 therefore it can be concluded that aquatic animals already swim using at an optimal strategy to minimize the energy cost during natural selection when a foil oscillates with a prescribed motion in a uniform flow it generates drag or thrust depending on the framework of the vortices shedding from the foil in the classical inviscid theory a flapping foil experiences a drag force when it produces the bénard von kármán bvk vortex street and the reverse bénard von kármán rbvk wake is related to the thrust on the foil moreover the boundary between the bvk wake and the rbvk wake is also treated as the transition boundary from drag to thrust von kármán and buegers 1935 for viscous flows however godoy diana et al 2008 experimentally showed that the bvk rbvk transition precedes the drag thrust transition of a pitching foil and indicated that the rbvk vortex street can also generate drag such inconsistent boundary between the drag thrust transition and the bvk rbvk transition of a pitching foil has also been found in many studies schnipper et al 2009 he et al 2012 andersen et al 2017 including studies involving plunging foils liang et al 2011 zheng and wei 2012 calderon et al 2014 with continuously increasing pitching frequency and amplitude symmetry breaking of the rbvk wake can be observed godoy diana et al 2008 godoy diana et al 2009 theoretically established a model to estimate the symmetry breaking threshold of the rbvk wake which allowed jallas and marquet 2017 to conduct the linear and non linear perturbation analyses of the symmetry breaking of a rbvk wake maris et al 2012 and zhu et al 2014 considered the effects of the flexibility on this symmetry breaking deng and caulfield 2015 and deng et al 2015 found that a shift from a two dimensional 2d wake to a three dimensional 3d wake occurs after the transition between the rbvk wake and the asymmetric wake deng et al 2016 revealed that the optimal efficiency of the flapping foil exhibits a good coincidence with the 2d 3d wake transition boundary in the aforementioned works the researchers performed systemic studies regarding the force generation and wake structures of a flapping foil in order to analyse the fluid dynamics of the flow over an oscillating slender body and elucidate the swimming behaviour of aquatic animals however previous studies performed using a pitching foil with a fixed geometry may have missed some key information about real swimmers since the size of aquatic animals plays a vital role in determining their propulsive performance webb et al 1984 saadat et al 2017 gazzola et al 2014 according to the published literature ashraf et al 2011 yu et al 2013 a thinner foil produces a greater propulsive force than a thicker one however the influence of the foil s thickness on the drag thrust transition is not well understood in the present numerical simulations based on previous studies we focus on the drag thrust transition of a pitching foil with various chord lengths to expand the literature and provide a new perspective to understand the hydrodynamic behaviour of swimming animals in particular we consider the various chord lengths of the foil as the different values of the chord based reynolds number to reveal the inherent relationship between the fluid characteristics and the kinematics of the foil at the drag thrust transition boundary the rest of this paper is organized as follows first we describe the present problem and the numerical method in section 2 we then describe the computational approach and present and discuss all results of the numerical simulations in section 3 the final section is the conclusion of the work in which we summarize the critical observations made in our study 2 computational method 2 1 problem formulation the problem formulation is depicted in fig 1 a rigid symmetric foil is placed in a uniform flow with constant speed u in the x direction the foil itself has a semicircular leading edge with chord length c and maximum thickness d the prescribed oscillation of the pitching foil is 1 ϕ t ϕ 0 s i n 2 π f t where f denotes the frequency of foil oscillation and ϕ 0 is maximum pitching amplitude the centre of the pitching motion is located at the point o and the distance from the point o to the leading edge of the foil is d 2 thus ϕ 0 can be calculated through the peak to peak amplitude 2 a as sin ϕ 0 a c d 2 four dimensionless parameters are introduced to characterize the foil oscillating in the two dimensional incompressible newtonian flow i e the non dimensional pitching amplitude 2 a d 2 a d the thickness based strouhal number 3 s r f d u the thickness based reynolds number 4 r e d d u ν and the chord based reynolds number r e c c u ν where ν is the kinematic viscosity of the fluid depending on the definition of s r a it is possible to derive s r a s r a d moreover a dimensionless thickness parameter t d is defined as 5 t d d c which also equals r e d r e c in addition we define the dimensionless swimming parameter s w as 6 s w s r a r e c which allows us to seamlessly link the input kinematics f a to the fluid environment s influences on the foil depending on those conditions the pitching foil is subjected to time varying forces f x t f y t in the x and y directions respectively here we only consider the force generation in the x direction using t denotes the oscillated period the time averaged horizontal force on the foil is defined as 7 f x 1 t 0 t f x t d t moreover the f x is non dimensionalized in coefficient form using the following equation 8 c t f x 1 2 ρ u 2 c where ρ is the density of the fluid under such definitions it is easier to find that the foil experiences thrust when c t 0 and drag when c t is less than zero 2 2 numerical approach the commercially available computational fluid dynamics cfd package fluent 14 0 with an unsteady incompressible and viscous flow solver is applied to model the flow around a pitching foil the governing equations for the unsteady incompressible laminar flow are the following 9 u 0 10 d u d t 1 ρ f 1 ρ p ν 2 u where u denotes the velocity vector f is the body force acting on the fluid and p refers to the pressure the governing eqs 9 and 10 are discretized using a finite volume method with an implicit first order time marching scheme for the unsteady term to allow a time step to be maintained a reasonable level the convection terms are discretized through a second order upwind scheme and the diffusion term discretization is applied with the second order central differencing scheme a pointwise gauss seidel linear equation solver is employed to solve those discretized equations the semi implicit method for pressure linked equations simple algorithm is used to achieve the pressure velocity coupling of the continuity equation this numerical method implemented in the available commercial software fluent has been extensively employed by the researchers to study the flow over a flapping foil ashraf et al 2011 xiao et al 2012 kinesy and dumas 2008 the computational domain is defined as a regular area in which the far field boundary is placed at least 20 c from the foil such that there is no discernible interaction between the pitching foil and the boundaries of the computational domain bos et al 2008 as shown in fig 1 the inlet velocity boundary is set to be 20 c from the leading edge of the foil i e u u 0 and p x 0 u 0 0 and p 0 are employed as the outflow boundary condition and the downstream pressure outlet is located at 35 c from the trailing edge of the foil the slip wall condition is used for the upper and lower flow boundaries situated at 20 c d 2 from the certain line of the foil along the foil surface the no slip boundary condition is applied in addition the prescribed motion eq 1 of the pitching foil is treated via the user defined function udf in the present problem the mesh motion is necessary only for the pitching oscillation of the foil thus two zones of grids with a circular nonconformal sliding grid interface are used this interface is located at 4 c around the foil and the grid inside is pitched in rigid body motion with the foil in this inner zone an o topology mesh is employed to reduce the computational cost yang et al 2006 while a structured mesh is used at the outside of the interface the adjacent grid of the body has a higher resolution to precisely capture the hydrodynamic forces and the wake structures of the pitching foil there are approximately 18 grid points in the boundary layer and the first cell is located from the foil surface at a normal distance of 1 0 4 c moreover a formula presented by kinesy and dumas 2008 is used to determine the computational time steps of the simulations this formula is expressed as t min t 2000 c v 100 where t is the oscillation period and v is the maximum instantaneous convective flux velocity in the computational domain under these conditions we set a finer time step of 0 0001 c u 2500 per period to ensure the computational accuracy the applicability of this formula to be present problem using different time steps is also validated as shown in fig 2 a a grid dependence study is conducted at r e c 2640 s r 0 12 a d 1 14 and t d 1 6 andersen et al 2017 to estimate the dependence of the numerical solution on the grid refinement the computational results illustrated in fig 2 b indicate that a medium grid captures the flow field with sufficient accuracy therefore we use the medium grid to reduce the computational time in the detailed computation 2 3 definition of the 2d 3d wake transition in addition to fluent calculations for the base flow we perform linear floquet stability analysis to identify the boundary of 2d 3d wake transition floquet stability analysis is typically used to analyse the stability of 2d periodic symmetric base flow to 3d perturbations williamson 1988 barkley and henderson 1996 blackburn and lopez 2003 as reported by deng and caulfield 2015 deng et al 2015 the base flow u x y t p x y t in eq 8 and 9 is modified to u x y t u x y z t p x y t p x y z t where u x y z t p x y z t is the 3d perturbation in particular the spanwise periodic perturbations can be expressed as u p t x y z t u ˆ p ˆ t x y β t e i β z where β 2 π d λ λ is spanwise wavelength denotes the spanwise wave number of 3d perturbations based on the floquet theorem we have d u ˆ d t a t u ˆ where the velocity vector u ˆ can be extracted from the grid points and a t is an n n t periodic matrix the initial value of u ˆ is set to u ˆ t 0 from integration of the d u ˆ d t a t u ˆ over one period we have φ t t φ t c where the eigenvalues μ s of matrix c are the floquet multipliers if μ 1 the base flow u x y t p x y t is linearly unstable to perturbations u x y z t p x y z t conversely the base flow is stable when μ 1 specifically the 2d 3d wake transition boundary is obtained at μ 1 the floquet linear stability analysis is conducted using the open source software nektar https www nektar info 0000 nektar is designed to support the development of high performance scalable solvers for partial differential equations using the spectral hp element method cantwell et al 2015 when conducting the stability analysis the computational domain and boundary conditions employed by nektar are same as those used by fluent more technical details about nektar and its applications are presented in refs https www nektar info 0000 ma et al 2017 he et al 2017 chao et al 2019 3 results in the present study the work of godoy diana et al 2008 is considered as the benchmark in that work the dimensionless thickness of the foil is t d 5 23 the thickness based and the chord based reynolds number corresponding to this t d are r e d 255 and r e c 1173 respectively under a certain thickness based reynolds number of r e d 255 we obtain the various values of chord based reynolds number r e c through keeping the maximum thickness of the foil fixed and varying the chord length of the foil the numerical cases in the present simulations are listed in table 1 3 1 benchmark before varying the t d we first consider the computational results of the benchmark t d 5 23 to compare our numerical approach with the work of godoy diana et al 2008 and add the data into the computational data sets fig 3 shows that the results of the present numerical approach are in agreement with the experimental results obtained by godoy diana et al 2008 with increasing of the s r and a d the horizontal force acting on the pitching foil is changed from drag to thrust moreover the wake structures behind the foil evolve from a bvk wake to a rbvk wake and to an asymmetrical wake we plot some typical wake structures in fig 4 from the perspective of a vorticity map a bvk wake is related to the clockwise vortices located at the upper of the symmetrical line and the counter clockwise vortices located at the bottom while the wake topology of a rbvk wake is opposite the bvk wake for an asymmetric wake there exists an obvious deflection between the symmetrical line of the foil and the wake in particular the deflected direction of an asymmetric wake is opposite to the initial direction of pitching motion zheng and wei 2012 in addition the wake structures is a bvk wake when the velocity of flow behind the foil is less than the velocity of the oncoming foil when the velocity of flow behind the foil is greater than the velocity of the oncoming foil the corresponding wake structure is a rbvk wake for an asymmetry wake the maximum flow velocity is obtained at the lower side of the symmetrical line in our work 3 2 observations with different symbols and lines plotted in the s r a d plane two examples of numerical results are illustrated in fig 5 in general the changing trends of the horizontal force and wake structures of the present study are in agreement with those of previous works godoy diana et al 2008 2009 deng and caulfield 2015 deng et al 2015 andersen et al 2017 with increasing of s r and a d a bvk type wake symbols is observed in the lower left region of the s r a d map and then the vortices align on the symmetry axis of the wake 2s wake symbols the rbvk wake symbols is marked when the positions of vortices cross this symmetric axis and the bvk rbvk transition is finished a symmetry breaking of the rbvk wake appears in the upper right region of the s r a d map where the asymmetric wake symbols can be observed behind the foil similar to the previous studies the drag thrust transition boundary black dash line occurs after the bvk rbvk wake transition boundary red dot line but before the transition boundary between the rbvk wake and asymmetric wake green dash dot dot line for different values of r e c moreover other types of wakes are added to the s r a d map as an example in fig 5 a the periodic vortex wakes with blurry vortices region symbols are observed at lower values of s r and a d which is similar to the previous work of andersen et al 2017 but not discovered at r e c 2346 on the other hand a wake with 3d feature symbols is found it lies to the top right of the asymmetric wake in fig 5 b the linear floquet stability analysis revealed that the 2d 3d wake transition occurs at r e c 1525 the strong dependence of the 2d 3d wake transition boundary blue short dot line on the r e c is also consistent with previous works where a 2d 3d wake transition was observed by deng and caulfield 2015 deng et al 2015 2016 at r e c 1700 rather than by godoy diana et al 2008 at r e c 1173 from the perspective of the force generation it is easier to observe that the drag thrust transition boundary shifts towards the left bottom of the s r a d map with a decrease in the t d as is evident in fig 5 this result indicates that the thinner foil yields a greater ability to generate propulsive force this superiority is not just the increasing of the thrust ashraf et al 2011 yu et al 2013 but also the advancing of the drag thrust transition by normalizing the t d as r e c figs 5 a and 5 b show s r a a r e c a s r a b r e c b at the drag thrust transition boundary this scaling law linked the amplitude based strouhal number and chord based reynolds number and always existed in the present simulations as illustrated in fig 6 this scaling relationship in the form of s r a r e c 1 reveals that the drag thrust transition of foil pitching at a prescribed oscillation would be advanced through increasing the r e c with the definition of r e c we argue that the drag thrust transition is significantly affected by the size and swimming speed of the foil and a relationship describing the present law on the foil s drag thrust transition may exist in addition we also consider the drag thrust transition boundary related to some other value of r e d as shown in fig 6 the numerical results indicate that the relationship between s r a and r e c 1 on the drag thrust transition boundary is also valid for the adding tests of r e d 3 3 the velocity field near the foil on the basis of the previous work ramesh et al 2014 the force on the pitching foil is associated with the calculation of the latest vortex shedding from the foil at the drag thrust transition boundary c t 0 the velocity of the latest shed vortex u v would have the same value regardless of the values of s r and a d the present numerical results reveal good agreement with this assumption at r e c 586 5 fig 7 a the u v is approximately equal in two middle sub figure as 0 14 m s while u v is 0 08 m s at r e c 2346 fig 7 b moreover the difference in u v obtained from r e c 586 5 and r e c 2346 also indicates that the drag thrust transition boundary would be advanced with increasing r e c as shown in fig 7 when we consider a fixed r e c such as r e c 586 5 it is found that the velocity of the latest shed vortex is elevated with increasing s r a the reason for this condition is that there exists a critical velocity of the latest shed vortex u v during the force generation of a pitching foil and the foil experiences drag at u v u v and thrust at u v u v fig 7 clearly illustrates that the u v significantly depended on the s r a and r e c at a constant u therefore the fluid mechanism behind the scaling law of drag thrust transition is that the u v is equalled to u v moreover godoy diana et al 2009 provided a theoretical model to predict the symmetry breaking of the rbvk wake in this model the appearance of the asymmetric wake is also related to the u v as the drag thrust transition always occurs in the region of the rbvk wake the u v in the present work is less than the critical u v corresponding to the symmetry breaking threshold therefore the u v value exhibits two threshold as s r a increase which lead to the drag thrust transition and the symmetric asymmetric wake transition respectively in that order 4 discussions considering the above studies regarding flapping foils triantafyllou et al 2004 platzer et al 2008 chao et al 2017 liu and curet 2018 mwaffo et al 2018 costa et al 2017 researchers customarily use the s r a to characterize the hydrodynamic performance of an oscillating slender body although the amplitude based strouhal number captures the effect of input locomotion on the flow it loses sight of the influence of the fluid environment i e the kinematic viscosity ν from the perspective of the drag thrust transition the present numerical results show that the fluid dynamics around a pitching foil strongly depend on the chord based reynolds number this direct consequence provides a physical basis for the finding that a pitching foil experiences the drag thrust transition in a narrow range of s w as shown in fig 4 in previous studies webb et al 1984 saadat et al 2017 gazzola et al 2014 the authors indicated that the size and swimming speed would directly affect the hydrodynamic performance of aquatic animals in addition aquatic animals produce zero net thrust and propel themselves with a time dependent speed in our numerical works the time dependent thrust generated by the pitching foil is simulated through setting the moving forward speed of the foil to a constant value indicating that the foil pitching at the drag thrust transition boundary in the present study can be considered as an aquatic animal swimming at a constant speed compared with artificial propeller propulsion native aquatic animals swim with many excellent characteristics such as high propulsive efficiency high mobility high stability low noise and low environmental disturbances inspired by the hydrodynamic performance of aquatic animals researchers have designed a variety of underwater robots scaradozzi et al 2017 however previous studies regarding underwater robots tends to focus on the propulsive efficiency while the critical point for generating effective thrust has not been well studied in the present work we show that the bio inspired pitching foil generates thrust when the kinematics of the pitching motion exceed the drag thrust transition boundary which provides helpful findings for designing the bio inspired underwater robots 5 conclusions a numerical study is performed to investigate the force generation of a foil pitching in a uniform flow by varying the chord length of the foil and keeping the maximum thickness fixed the results indicate that the drag thrust transition of the pitching foil conforms to a scaling relation at a thickness based reynolds number r e d 255 this scaling relation can be described as a power law between the chord base reynolds number r e c and the amplitude based strouhal number s r a as s r a r e c 1 we understand this scaling law via the velocity of the latest vortex shedding from the foil and the numerical conclusions reveal that this velocity significantly depends on the s r a and that r e c would equal a threshold at the drag thrust transition boundary the present work provides a new perspective to understand the swimming behaviour of aquatic animals and it is also helpful for guiding the design of bio inspired underwater robots acknowledgements this work is supported by national natural science foundation of china grant no 11502210 51709229 51879220 51479170 and 61803306 national key research and development program of china grant no 2016yfc0301300 natural science basic research plan in shaanxi province of china grant no 2018jq5092 
22360,the drag thrust transition of a symmetric foil undergoing pitching oscillation in a uniform flow is numerically studied in the present work under a certain thickness based reynolds number r e d 255 the fluid dynamics around the oscillated foil at a series of values for the chord based reynolds number r e c are investigated the various values of r e c are obtained by keeping the maximum thickness of the foil fixed while rhythmically changing the chord length of the foil depending on the numerical results we uncover a scaling relation that links the amplitude based strouhal number s r a to the r e c at the drag thrust transition boundary which is briefly expressed as s r a r e c 1 through analysing the velocity field of the foil it is found that the drag thrust transition of the pitching foil is closely associated with the critical velocity of the latest vortex produced by the foil these findings helps in understanding the kinematic behaviour of aquatic animals and designing bio inspired underwater robots keywords pitching foil drag thrust transition scaling law bio inspired underwater robots 1 introduction birds flap their wings to conquer the sky and fish oscillate their fins to cruise the ocean it is widespread to see living beings keep moving around the world native swimmers must resist the drag from the water to maintain movement hence the evolutionary direction of aquatic animals may strongly depend on how they effectively move forward support for this standpoint is the finding that aquatic animals usually swim at a narrow range of the amplitude based strouhal number s r a regardless of the sizes and species of the swimmers taylor et al 2003 eloy 2012 where s r a is defined as the product of the pitching frequency f and peak to peak amplitude 2 a divided by the swimming speed u i e s r a 2 f a u on the other hand the optimal propulsive performance incurred by a flapping foil is also obtained in this range of s r a as 0 2 s r a 0 4 anderson et al 1998 read et al 2003 triantafyllou et al 2004 therefore it can be concluded that aquatic animals already swim using at an optimal strategy to minimize the energy cost during natural selection when a foil oscillates with a prescribed motion in a uniform flow it generates drag or thrust depending on the framework of the vortices shedding from the foil in the classical inviscid theory a flapping foil experiences a drag force when it produces the bénard von kármán bvk vortex street and the reverse bénard von kármán rbvk wake is related to the thrust on the foil moreover the boundary between the bvk wake and the rbvk wake is also treated as the transition boundary from drag to thrust von kármán and buegers 1935 for viscous flows however godoy diana et al 2008 experimentally showed that the bvk rbvk transition precedes the drag thrust transition of a pitching foil and indicated that the rbvk vortex street can also generate drag such inconsistent boundary between the drag thrust transition and the bvk rbvk transition of a pitching foil has also been found in many studies schnipper et al 2009 he et al 2012 andersen et al 2017 including studies involving plunging foils liang et al 2011 zheng and wei 2012 calderon et al 2014 with continuously increasing pitching frequency and amplitude symmetry breaking of the rbvk wake can be observed godoy diana et al 2008 godoy diana et al 2009 theoretically established a model to estimate the symmetry breaking threshold of the rbvk wake which allowed jallas and marquet 2017 to conduct the linear and non linear perturbation analyses of the symmetry breaking of a rbvk wake maris et al 2012 and zhu et al 2014 considered the effects of the flexibility on this symmetry breaking deng and caulfield 2015 and deng et al 2015 found that a shift from a two dimensional 2d wake to a three dimensional 3d wake occurs after the transition between the rbvk wake and the asymmetric wake deng et al 2016 revealed that the optimal efficiency of the flapping foil exhibits a good coincidence with the 2d 3d wake transition boundary in the aforementioned works the researchers performed systemic studies regarding the force generation and wake structures of a flapping foil in order to analyse the fluid dynamics of the flow over an oscillating slender body and elucidate the swimming behaviour of aquatic animals however previous studies performed using a pitching foil with a fixed geometry may have missed some key information about real swimmers since the size of aquatic animals plays a vital role in determining their propulsive performance webb et al 1984 saadat et al 2017 gazzola et al 2014 according to the published literature ashraf et al 2011 yu et al 2013 a thinner foil produces a greater propulsive force than a thicker one however the influence of the foil s thickness on the drag thrust transition is not well understood in the present numerical simulations based on previous studies we focus on the drag thrust transition of a pitching foil with various chord lengths to expand the literature and provide a new perspective to understand the hydrodynamic behaviour of swimming animals in particular we consider the various chord lengths of the foil as the different values of the chord based reynolds number to reveal the inherent relationship between the fluid characteristics and the kinematics of the foil at the drag thrust transition boundary the rest of this paper is organized as follows first we describe the present problem and the numerical method in section 2 we then describe the computational approach and present and discuss all results of the numerical simulations in section 3 the final section is the conclusion of the work in which we summarize the critical observations made in our study 2 computational method 2 1 problem formulation the problem formulation is depicted in fig 1 a rigid symmetric foil is placed in a uniform flow with constant speed u in the x direction the foil itself has a semicircular leading edge with chord length c and maximum thickness d the prescribed oscillation of the pitching foil is 1 ϕ t ϕ 0 s i n 2 π f t where f denotes the frequency of foil oscillation and ϕ 0 is maximum pitching amplitude the centre of the pitching motion is located at the point o and the distance from the point o to the leading edge of the foil is d 2 thus ϕ 0 can be calculated through the peak to peak amplitude 2 a as sin ϕ 0 a c d 2 four dimensionless parameters are introduced to characterize the foil oscillating in the two dimensional incompressible newtonian flow i e the non dimensional pitching amplitude 2 a d 2 a d the thickness based strouhal number 3 s r f d u the thickness based reynolds number 4 r e d d u ν and the chord based reynolds number r e c c u ν where ν is the kinematic viscosity of the fluid depending on the definition of s r a it is possible to derive s r a s r a d moreover a dimensionless thickness parameter t d is defined as 5 t d d c which also equals r e d r e c in addition we define the dimensionless swimming parameter s w as 6 s w s r a r e c which allows us to seamlessly link the input kinematics f a to the fluid environment s influences on the foil depending on those conditions the pitching foil is subjected to time varying forces f x t f y t in the x and y directions respectively here we only consider the force generation in the x direction using t denotes the oscillated period the time averaged horizontal force on the foil is defined as 7 f x 1 t 0 t f x t d t moreover the f x is non dimensionalized in coefficient form using the following equation 8 c t f x 1 2 ρ u 2 c where ρ is the density of the fluid under such definitions it is easier to find that the foil experiences thrust when c t 0 and drag when c t is less than zero 2 2 numerical approach the commercially available computational fluid dynamics cfd package fluent 14 0 with an unsteady incompressible and viscous flow solver is applied to model the flow around a pitching foil the governing equations for the unsteady incompressible laminar flow are the following 9 u 0 10 d u d t 1 ρ f 1 ρ p ν 2 u where u denotes the velocity vector f is the body force acting on the fluid and p refers to the pressure the governing eqs 9 and 10 are discretized using a finite volume method with an implicit first order time marching scheme for the unsteady term to allow a time step to be maintained a reasonable level the convection terms are discretized through a second order upwind scheme and the diffusion term discretization is applied with the second order central differencing scheme a pointwise gauss seidel linear equation solver is employed to solve those discretized equations the semi implicit method for pressure linked equations simple algorithm is used to achieve the pressure velocity coupling of the continuity equation this numerical method implemented in the available commercial software fluent has been extensively employed by the researchers to study the flow over a flapping foil ashraf et al 2011 xiao et al 2012 kinesy and dumas 2008 the computational domain is defined as a regular area in which the far field boundary is placed at least 20 c from the foil such that there is no discernible interaction between the pitching foil and the boundaries of the computational domain bos et al 2008 as shown in fig 1 the inlet velocity boundary is set to be 20 c from the leading edge of the foil i e u u 0 and p x 0 u 0 0 and p 0 are employed as the outflow boundary condition and the downstream pressure outlet is located at 35 c from the trailing edge of the foil the slip wall condition is used for the upper and lower flow boundaries situated at 20 c d 2 from the certain line of the foil along the foil surface the no slip boundary condition is applied in addition the prescribed motion eq 1 of the pitching foil is treated via the user defined function udf in the present problem the mesh motion is necessary only for the pitching oscillation of the foil thus two zones of grids with a circular nonconformal sliding grid interface are used this interface is located at 4 c around the foil and the grid inside is pitched in rigid body motion with the foil in this inner zone an o topology mesh is employed to reduce the computational cost yang et al 2006 while a structured mesh is used at the outside of the interface the adjacent grid of the body has a higher resolution to precisely capture the hydrodynamic forces and the wake structures of the pitching foil there are approximately 18 grid points in the boundary layer and the first cell is located from the foil surface at a normal distance of 1 0 4 c moreover a formula presented by kinesy and dumas 2008 is used to determine the computational time steps of the simulations this formula is expressed as t min t 2000 c v 100 where t is the oscillation period and v is the maximum instantaneous convective flux velocity in the computational domain under these conditions we set a finer time step of 0 0001 c u 2500 per period to ensure the computational accuracy the applicability of this formula to be present problem using different time steps is also validated as shown in fig 2 a a grid dependence study is conducted at r e c 2640 s r 0 12 a d 1 14 and t d 1 6 andersen et al 2017 to estimate the dependence of the numerical solution on the grid refinement the computational results illustrated in fig 2 b indicate that a medium grid captures the flow field with sufficient accuracy therefore we use the medium grid to reduce the computational time in the detailed computation 2 3 definition of the 2d 3d wake transition in addition to fluent calculations for the base flow we perform linear floquet stability analysis to identify the boundary of 2d 3d wake transition floquet stability analysis is typically used to analyse the stability of 2d periodic symmetric base flow to 3d perturbations williamson 1988 barkley and henderson 1996 blackburn and lopez 2003 as reported by deng and caulfield 2015 deng et al 2015 the base flow u x y t p x y t in eq 8 and 9 is modified to u x y t u x y z t p x y t p x y z t where u x y z t p x y z t is the 3d perturbation in particular the spanwise periodic perturbations can be expressed as u p t x y z t u ˆ p ˆ t x y β t e i β z where β 2 π d λ λ is spanwise wavelength denotes the spanwise wave number of 3d perturbations based on the floquet theorem we have d u ˆ d t a t u ˆ where the velocity vector u ˆ can be extracted from the grid points and a t is an n n t periodic matrix the initial value of u ˆ is set to u ˆ t 0 from integration of the d u ˆ d t a t u ˆ over one period we have φ t t φ t c where the eigenvalues μ s of matrix c are the floquet multipliers if μ 1 the base flow u x y t p x y t is linearly unstable to perturbations u x y z t p x y z t conversely the base flow is stable when μ 1 specifically the 2d 3d wake transition boundary is obtained at μ 1 the floquet linear stability analysis is conducted using the open source software nektar https www nektar info 0000 nektar is designed to support the development of high performance scalable solvers for partial differential equations using the spectral hp element method cantwell et al 2015 when conducting the stability analysis the computational domain and boundary conditions employed by nektar are same as those used by fluent more technical details about nektar and its applications are presented in refs https www nektar info 0000 ma et al 2017 he et al 2017 chao et al 2019 3 results in the present study the work of godoy diana et al 2008 is considered as the benchmark in that work the dimensionless thickness of the foil is t d 5 23 the thickness based and the chord based reynolds number corresponding to this t d are r e d 255 and r e c 1173 respectively under a certain thickness based reynolds number of r e d 255 we obtain the various values of chord based reynolds number r e c through keeping the maximum thickness of the foil fixed and varying the chord length of the foil the numerical cases in the present simulations are listed in table 1 3 1 benchmark before varying the t d we first consider the computational results of the benchmark t d 5 23 to compare our numerical approach with the work of godoy diana et al 2008 and add the data into the computational data sets fig 3 shows that the results of the present numerical approach are in agreement with the experimental results obtained by godoy diana et al 2008 with increasing of the s r and a d the horizontal force acting on the pitching foil is changed from drag to thrust moreover the wake structures behind the foil evolve from a bvk wake to a rbvk wake and to an asymmetrical wake we plot some typical wake structures in fig 4 from the perspective of a vorticity map a bvk wake is related to the clockwise vortices located at the upper of the symmetrical line and the counter clockwise vortices located at the bottom while the wake topology of a rbvk wake is opposite the bvk wake for an asymmetric wake there exists an obvious deflection between the symmetrical line of the foil and the wake in particular the deflected direction of an asymmetric wake is opposite to the initial direction of pitching motion zheng and wei 2012 in addition the wake structures is a bvk wake when the velocity of flow behind the foil is less than the velocity of the oncoming foil when the velocity of flow behind the foil is greater than the velocity of the oncoming foil the corresponding wake structure is a rbvk wake for an asymmetry wake the maximum flow velocity is obtained at the lower side of the symmetrical line in our work 3 2 observations with different symbols and lines plotted in the s r a d plane two examples of numerical results are illustrated in fig 5 in general the changing trends of the horizontal force and wake structures of the present study are in agreement with those of previous works godoy diana et al 2008 2009 deng and caulfield 2015 deng et al 2015 andersen et al 2017 with increasing of s r and a d a bvk type wake symbols is observed in the lower left region of the s r a d map and then the vortices align on the symmetry axis of the wake 2s wake symbols the rbvk wake symbols is marked when the positions of vortices cross this symmetric axis and the bvk rbvk transition is finished a symmetry breaking of the rbvk wake appears in the upper right region of the s r a d map where the asymmetric wake symbols can be observed behind the foil similar to the previous studies the drag thrust transition boundary black dash line occurs after the bvk rbvk wake transition boundary red dot line but before the transition boundary between the rbvk wake and asymmetric wake green dash dot dot line for different values of r e c moreover other types of wakes are added to the s r a d map as an example in fig 5 a the periodic vortex wakes with blurry vortices region symbols are observed at lower values of s r and a d which is similar to the previous work of andersen et al 2017 but not discovered at r e c 2346 on the other hand a wake with 3d feature symbols is found it lies to the top right of the asymmetric wake in fig 5 b the linear floquet stability analysis revealed that the 2d 3d wake transition occurs at r e c 1525 the strong dependence of the 2d 3d wake transition boundary blue short dot line on the r e c is also consistent with previous works where a 2d 3d wake transition was observed by deng and caulfield 2015 deng et al 2015 2016 at r e c 1700 rather than by godoy diana et al 2008 at r e c 1173 from the perspective of the force generation it is easier to observe that the drag thrust transition boundary shifts towards the left bottom of the s r a d map with a decrease in the t d as is evident in fig 5 this result indicates that the thinner foil yields a greater ability to generate propulsive force this superiority is not just the increasing of the thrust ashraf et al 2011 yu et al 2013 but also the advancing of the drag thrust transition by normalizing the t d as r e c figs 5 a and 5 b show s r a a r e c a s r a b r e c b at the drag thrust transition boundary this scaling law linked the amplitude based strouhal number and chord based reynolds number and always existed in the present simulations as illustrated in fig 6 this scaling relationship in the form of s r a r e c 1 reveals that the drag thrust transition of foil pitching at a prescribed oscillation would be advanced through increasing the r e c with the definition of r e c we argue that the drag thrust transition is significantly affected by the size and swimming speed of the foil and a relationship describing the present law on the foil s drag thrust transition may exist in addition we also consider the drag thrust transition boundary related to some other value of r e d as shown in fig 6 the numerical results indicate that the relationship between s r a and r e c 1 on the drag thrust transition boundary is also valid for the adding tests of r e d 3 3 the velocity field near the foil on the basis of the previous work ramesh et al 2014 the force on the pitching foil is associated with the calculation of the latest vortex shedding from the foil at the drag thrust transition boundary c t 0 the velocity of the latest shed vortex u v would have the same value regardless of the values of s r and a d the present numerical results reveal good agreement with this assumption at r e c 586 5 fig 7 a the u v is approximately equal in two middle sub figure as 0 14 m s while u v is 0 08 m s at r e c 2346 fig 7 b moreover the difference in u v obtained from r e c 586 5 and r e c 2346 also indicates that the drag thrust transition boundary would be advanced with increasing r e c as shown in fig 7 when we consider a fixed r e c such as r e c 586 5 it is found that the velocity of the latest shed vortex is elevated with increasing s r a the reason for this condition is that there exists a critical velocity of the latest shed vortex u v during the force generation of a pitching foil and the foil experiences drag at u v u v and thrust at u v u v fig 7 clearly illustrates that the u v significantly depended on the s r a and r e c at a constant u therefore the fluid mechanism behind the scaling law of drag thrust transition is that the u v is equalled to u v moreover godoy diana et al 2009 provided a theoretical model to predict the symmetry breaking of the rbvk wake in this model the appearance of the asymmetric wake is also related to the u v as the drag thrust transition always occurs in the region of the rbvk wake the u v in the present work is less than the critical u v corresponding to the symmetry breaking threshold therefore the u v value exhibits two threshold as s r a increase which lead to the drag thrust transition and the symmetric asymmetric wake transition respectively in that order 4 discussions considering the above studies regarding flapping foils triantafyllou et al 2004 platzer et al 2008 chao et al 2017 liu and curet 2018 mwaffo et al 2018 costa et al 2017 researchers customarily use the s r a to characterize the hydrodynamic performance of an oscillating slender body although the amplitude based strouhal number captures the effect of input locomotion on the flow it loses sight of the influence of the fluid environment i e the kinematic viscosity ν from the perspective of the drag thrust transition the present numerical results show that the fluid dynamics around a pitching foil strongly depend on the chord based reynolds number this direct consequence provides a physical basis for the finding that a pitching foil experiences the drag thrust transition in a narrow range of s w as shown in fig 4 in previous studies webb et al 1984 saadat et al 2017 gazzola et al 2014 the authors indicated that the size and swimming speed would directly affect the hydrodynamic performance of aquatic animals in addition aquatic animals produce zero net thrust and propel themselves with a time dependent speed in our numerical works the time dependent thrust generated by the pitching foil is simulated through setting the moving forward speed of the foil to a constant value indicating that the foil pitching at the drag thrust transition boundary in the present study can be considered as an aquatic animal swimming at a constant speed compared with artificial propeller propulsion native aquatic animals swim with many excellent characteristics such as high propulsive efficiency high mobility high stability low noise and low environmental disturbances inspired by the hydrodynamic performance of aquatic animals researchers have designed a variety of underwater robots scaradozzi et al 2017 however previous studies regarding underwater robots tends to focus on the propulsive efficiency while the critical point for generating effective thrust has not been well studied in the present work we show that the bio inspired pitching foil generates thrust when the kinematics of the pitching motion exceed the drag thrust transition boundary which provides helpful findings for designing the bio inspired underwater robots 5 conclusions a numerical study is performed to investigate the force generation of a foil pitching in a uniform flow by varying the chord length of the foil and keeping the maximum thickness fixed the results indicate that the drag thrust transition of the pitching foil conforms to a scaling relation at a thickness based reynolds number r e d 255 this scaling relation can be described as a power law between the chord base reynolds number r e c and the amplitude based strouhal number s r a as s r a r e c 1 we understand this scaling law via the velocity of the latest vortex shedding from the foil and the numerical conclusions reveal that this velocity significantly depends on the s r a and that r e c would equal a threshold at the drag thrust transition boundary the present work provides a new perspective to understand the swimming behaviour of aquatic animals and it is also helpful for guiding the design of bio inspired underwater robots acknowledgements this work is supported by national natural science foundation of china grant no 11502210 51709229 51879220 51479170 and 61803306 national key research and development program of china grant no 2016yfc0301300 natural science basic research plan in shaanxi province of china grant no 2018jq5092 
22361,vibro acoustic behaviour of submerged double walled cylindrical shells with general boundary conditions is analyzed by a precise transfer matrix method ptmm which is proposed by combining traditional transfer matrix method with precise integration method field transfer matrixes of both inner shell and outer shell are obtained accurately by ptmm respectively the annular plates are simulated by two methods and exist in the form of point transfer matrixes the dynamic models of double walled cylindrical shells are established by assembling whole transfer matrixes based on the helmholtz equation the interlayer and external fluid loads are described to solve the neumann boundary the vibro acoustic response of the double walled cylindrical shell can be obtained by determining sound pressure coefficients the free vibration and sound radiation of analytical models are comparing with numerical results and experimental results to verify the present method the effects of the general boundary constraint stiffnesses on the free vibration and sound radiation of double walled cylindrical shells are also discussed keywords transfer matrix method double walled cylindrical shells annular plates free vibration sound radiation 1 introduction the vibro acoustic response problem is always a hot topic in marine aerospace and automotive engineering design and manufacturing due to their superior mechanical acoustical and thermal properties double walled cylindrical shells are widely used in submarine aircraft evaporators pipelines and so forth the most common of which are steel taking the advantage of lightweight high strength isotropism simple fabrication and good sealing the steel double walled cylindrical shells are often selected as analyzed models to realize the insulation of vibration and sound radiation the excessive vibration and radiated noise of double walled cylindrical shells subjected to exterior loads certainly affect the safety and comfort an accurate understanding of the vibration and acoustic radiation characteristics of the double walled cylindrical shells is crucial in practical applications especially for the noise reduction of vibration structure up to now a huge number of analytical and numerical methods have been proposed to analyze the dynamic behaviours of various shell structures the application of the single walled cylindrical shell has many limitations due to its simple structural property in practical engineering therefore analytical methods are already applicable to the vibration analysis of a few combined cylindrical shell structures such as cylindrical shells tottenham and shimizu 1972 liang et al 2019 chen et al 2013 elliptic cylindrical shells zhang et al 2017a b ring stiffened cylindrical shells jafari and bagheri 2006 wang et al 2018 caresta and kessissoglou 2009 some researchers investigate other kinds of shell structures like conical cylindrical shells wang and guo 2016 qu et al 2013 chen et al 2015 and cylinder plate combination tso and hansen 1995 filippov and haseganu 2003 ma et al 2017 tso and hansen 1995 adopted the wave propagation approach to study the transmission of vibration waves through the junctions of an annular plate and an infinite cylindrical shell filippov and haseganu 2003 analyzed low frequencies and vibration modes of a thin cylindrical shell joined with an annular plate utilizing the asymptotic and numerical methods ma et al 2017 presented a modified fourier ritz method for coupled cylindrical shell and annular plate systems with a general boundary each displacement for the cylindrical shell and the annular plate is invariantly expressed as the modified fourier series composed of the standard fourier series and auxiliary functions the dynamic response of these shell structures can be solved by many numerical methods including finite element method fem everstine 1997 de faria 2004 boundary element method bem ventsel et al 2010 and coupled fem and bem everstine and henderson 1990 liu and chen 2009 the acoustic structure interaction problem of these complex shells can be solved by the discretization of the domain model and constructing the low order shape functions which limit the calculated frequency and computational efficiency by combining exact wave based method wbm and fem chen et al 2018 presented a hybrid approach to investigate vibration characteristics of a cylindrical shell coupled with interior structures however double walled shells are widely used in engineering applications due to their good mechanical properties and low vibration and noise features yamada et al 1986 presented the transfer matrix method to study the free vibration of a concentric double walled cylindrical shell closed by annular plates at two ends bai 2012 adopted the modal superposition method to analyze the sound and vibration transmission characteristics of simply supported double walled cylindrical shells with continuous or discontinuous annular plates combining measured partial vibration data of the inner shell zhang et al 2013 presented a modal superposition method to predict the sound radiated power of submerged double cylindrical shells zhou et al 2015 investigated sound transmission through a double walled cylindrical shell lined with poroelastic material in the core excited by pressure fluctuations due to the exterior turbulent boundary layer tbl based on hamilton s principle zhang and jin 2016 developed a modified fourier series solution to analyze the vibration of circular cylindrical double shell structures with arbitrary boundary conditions each displacement components of the cylindrical shells and annular plates are invariantly expanded as the superposition of a standard fourier series with several supplementary functions zhang et al 2017a b studied the sound transmission loss through a general double walled cylindrical shell system with one or two walls perforated which is excited by a plane wave in the presence of external mean flow after dividing the double walled cylindrical shell into several cylindrical shell segments xie and chen 2018 utilized a wave based method to calculate the vibration of double walled cylindrical shells coupled with annular plates both flügge shell theory and thin plate theory are employed to describe the motion of cylindrical segments and annular plates displacements of which are expanded as wave functions from the literature review only few articles discussed the acoustic radiation of the double walled cylindrical shell coupled with annular plates due to the geometrical and mathematical complexity in constructing the analytical model and these analytic models barely touch the submerged double walled cylindrical shell and the existence of interlayer water also it is not difficult to find that boundary conditions of double walled shells in the literature are mostly presupposed and many methods are limited to classical boundary conditions considering the limitations of numerical methods including fem bem and coupled fem bem it is of great significance to develop an analytical approximation method to obtain the vibration and acoustic response of submerged double walled cylindrical shells with arbitrary boundary conditions in this paper the traditional transfer matrix method is modified by borrowing the idea of precise integration method pim to improve the calculation accuracy of transfer matrixes then a precise transfer matrix method ptmm is proposed to solve structural vibration and sound radiation of submerged double walled cylindrical shell with arbitrary boundary conditions the present method can also be well applied to the acoustic performance analysis of other structures including fgm shells and composites shells firstly the paper proposes an efficient and accurate analysis method to investigate free vibration and forced vibrations and acoustic radiation of the double walled cylindrical shells secondly this method is particularly suitable for evaluating the vibration response of distributive systems regardless of the frequency and structural dimension finally it is applicable to deal with any classical and elastic boundary conditions 2 the double walled cylindrical shells the schematic diagram of a double walled cylindrical shell with uniformly distributed n ap 1 annular plates is shown in fig 1 the double walled cylindrical shell is described with the coordinates x θ r in which x is measured along the meridian r is the radial coordinate and θ is the circumferential coordinate mean radii of inner and outer shells are r 1 and r 2 and corresponding thicknesses are h 1 and h 2 it is assumed that all the shells and annular plates are made of homogeneous and isotropic materials ρ e ν and η are density young s modulus poisson s ratio and damping loss factor of the analytical model respectively the time dependent harmonic term e j ω t is suppressed in the formulation for simplicity 2 1 the cylindrical shell based on flügge shell theory flügge 1973 the equation of cylindrical shells can be written in a matrix differential equation as follows 1 d z ξ i d ξ i u ξ i z ξ i f ξ i p ξ i where superscripts i 1 2 represent the inner and outer shell and are applied below z ξ i u i v i w i φ i m x i v x i s x θ i n x i t is state vector the quantities u i v i w i marked with an overscore are the respective dimensionless variables u v and w are the displacement components in the axial circumferential and radial directions respectively n x s x θ v x and m x are normal force shear force transverse force and moment respectively ξ i satisfies x i r i r i are the thicknesses and the radii of the inner outer shell f ξ i and p ξ i denote the external forces and fluid loads respectively the coefficient matrix u ξ i is related to ξ i wang and guo 2016 after dividing the shell into n sections the coordinate positions of these discrete points along the meridian can be expressed as ξ 1 i ξ 2 i ξ 3 i ξ n i ξ n 1 i and ξ j 1 i ξ j i δ ξ i by assuming f ξ i equals f ξ i p ξ i the general solution of the linear non homogeneous dynamic equation can be expressed as 2 z ξ j 1 i t j i z ξ j i p j i 1 j n 1 i 1 2 where t j i exp ξ j i ξ j 1 i u τ i d τ e u i δ ξ i is the field transfer matrixes of the inner outer shell p j i ξ j i ξ j 1 i exp τ i ξ j 1 i u τ i d τ f τ i d τ is the duhamel integral term of the external force vector of the inner outer shell the transfer matrixes t j i of the inner outer shell can be solved by borrowing the idea of the precise integration method zhong 2004 the specific solution procedure is represented as 3 e u δ ξ exp h 2 s h u δ ξ 2 s where exp h can be solved by using a power series solution i 8 k 1 h k k i 8 is the identity matrix of eight order because the nonzero element of t a k 1 h k k is small there will be a mantissa precision failure resulted from rounding errors when i 8 is added to t a directly thus firstly t a is calculated according to addition theorem 4 e u δ ξ i 8 2 t a t a 2 2 s 1 the following statement can be executed 5 for iter 0 iter n iter t a 2 t a t a 2 after s times of circulation of its assignment one can obtain 6 e u δ ξ i 8 t a by mixing general solutions of the inner outer shell the general solution of the double walled cylindrical shells can be expressed as 7 t j z ξ j z ξ j 1 p j where t j t j 1 t j 2 is a 16 16 order field transfer matrix of the double walled cylindrical shells nonzero elements of which can be obtained from eq 6 z ξ j represents the state vectors z ξ j 1 z ξ j 2 t at ξ ξ j likewise z ξ j 1 equals z ξ j 1 1 z ξ j 1 2 t p j represents the external force vectors p ξ j 1 p ξ j 2 t 2 2 the annular plate two methods are employed to calculate the relationship between the state vector of the annular plate and the state vector of the inner outer shell method ⅰ is to employ the annular plate vibration equation chen et al 2002 to obtain the relationship and method ⅱ is to accomplish the aim by borrowing the truncated conical shell wang et al 2015 the circumferential displacement v r and the radial displacement w r in in plane vibration can be expressed as 8a v r n n r a n j n k a r n r b n y n k a r c n k b j n k b r d n k b y n k b r cos n θ 8b w r n a n k a j n k a r b n k a y n k a r n r c n j n k b r n r d n y n k b r sin n θ where j n and y n are n order bessel function and neumann function a n b n c n and d n are undetermined coefficient the relationships between the in plane forces and displacements of the annular plate are defined as 9 f r θ g r v r r v r r w r r θ f r r d r w r r μ w r r μ w r r θ where f r θ and f r r are the circumferential and radial forces g r e r h r 2 1 μ r d r e r h r 1 μ r 2 e r h r and μ r are young s modulus thickness and poisson s ratio of the annular plate respectively according to the displacement continuity conditions v i v r r r i and w i w r r r i i 1 2 then the displacement compatibility conditions at the junction can be derived as 10 v 1 w 1 v 2 w 2 t a a p a n b n c n d n t substituting the eq 8 into the eq 9 the force compatibility condition at the junction can be derived as 11 f r θ 1 f rr 1 f r θ 2 f rr 2 t b a p a n b n c n d n t where f r θ 1 f rr 1 are the circumferential and radial forces of the inner shell and f r θ 2 f rr 2 are the circumferential and the radial forces of the outer shell as the bending vibration the axial displacement u r of the annular plate can be expressed as 12 u r n e n j n k c r f n i n k c r g n y n k c r h n k n k c r cos n θ where i n and k n are n order bessel function and neumann function k c ω k c ρ r h r is the wavenumber e n f n g n and h n are undetermined coefficient the relationships between axial force f r x and bending moment m r and axial displacement and rotation angle of the annular plate are defined as 13a f r x k r 3 u r r 3 2 u r r r 2 2 μ r 3 u r r 2 r θ 2 u r r 2 r 3 μ r 2 u r r 3 θ 2 13b m r k r 2 u r r 2 μ r u r r r μ r 2 u r r 2 r θ according to displacement continuity condition u i u r r r i and φ i u r r r r i i 1 2 then the displacement compatibility conditions at the junction can be derived as 14 u 1 φ 1 u 2 φ 2 t c a p e n f n g n h n t substituting the eq 12 into the eq 13 the force compatibility condition at the junction can be derived as 15 f r x 1 m r 1 f r x 2 m r 2 t d a p e n f n g n h n t where f r x 1 m r 1 are the axial force and bending moment of the inner shell and f r x 2 m r 2 are the axial force and bending moment of the outer shell the relationship between the forces and displacements of the inner outer shell can be derived as 16a f r θ 1 f rr 1 f r θ 2 f rr 2 t b a p a a p 1 v 1 w 1 v 2 w 2 t 16b f r x 1 m r 1 f r x 2 m r 2 t d a p c a p 1 u 1 φ 1 u 2 φ 2 t method ⅱ to obtain the relationship is to simplify the conical shell to be the annular plate when the cone apex angle α 90 the vector transfer equation for the left and right ends of the conical shell segment is 17 z ξ 2 e ξ 1 ξ 2 u c d τ z ξ 1 t 12 z ξ 1 where ξ 1 ξ 2 represent the dimensionless inside radius and outside radius of the annular plate u c is the coefficient matrix for the conical shell wang et al 2015 t 12 is the transfer matrix of the annular plate according to the relationship of the force and displacement of the annular plate the state vectors of the double walled cylindrical shell satisfy 18 t k t r k z ξ k l z ξ k 1 r p k where z ξ k l and z ξ k r represent state vectors of the left section and the right section of the inner outer cylindrical shell at ξ ξ k respectively t r k is the point transfer matrix with the existence of the annular plate 2 3 the external load the external excitations acting on the shell can be simplified as concentrated forces f i i 1 2 n then the ith concentrated force can be expressed as 19 f x i θ i f 0 i δ s s 0 i δ θ θ 0 i r where f 0 i denotes the amplitude of the force s 0 i denotes the position of the force in the meridian θ 0 i denotes the position of the force in the circumferential angle for a given circumferential wave number n the external force can be expressed as 20 f r k 1 0 0 0 0 0 f n r f n c f n a t where f n r f n c and f n a represent the radial force circumferential force and axial force respectively 2 4 the fluid loads in the fluid media the acoustic pressure p must satisfy the helmholtz equation 21 2 p 2 r 1 r p r 1 r 2 2 p 2 θ 2 p 2 x k 0 2 p 0 where k 0 ω c 0 is the wavenumber ω is the angular frequency and c 0 is the speed of sound in the fluid the acoustic pressure of the outer flow field should also satisfy the sommerfeld boundary condition the sound pressure p 1 in the interlayer fluid is different from the sound pressure p 2 in the external flow field the acoustic pressure of both interlayer and external fluid field can be written as 22a p 1 n 0 m 0 a m n f n k r r b m n g n k r r cos k m x cos n θ 22b p 2 n 0 m 0 c m n e n k r r cos k m x cos n θ where a m n b m n c m n are sound pressure coefficients k m m π l are the wavenumbers in the meridian direction and k r k 0 2 k m 2 e n f n g n are related to k r when k r is a real number e n is hankel function of the second kind f n is a bessel function and g n is a neumann function when the generalized sound pressure f τ 2 e n k r r cos k m x is only external force the response term p j 2 of the outer shell can be expressed as 23 p j 2 ξ j 2 ξ j 1 2 exp τ 2 ξ j 1 2 u τ 2 d τ f τ 2 d τ 0 δ ξ 2 e u 2 τ 2 cos k m l ξ j 1 2 τ 2 g d τ where g r 2 3 k 2 0 0 0 0 0 e n k r r 2 0 0 t the duhamel integral term can be calculated by the precise integration method wang et al 2015 similarly the solution process of the duhamel integral term p j 1 under generalized sound pressure f n k r r cos k m x and g n k r r cos k m x are consistent with the above process 2 5 general boundary to simulate general boundary conditions spring constraint is employed to restrain displacements at both ends of the cylindrical shell k u k v k w and k θ are the constrained stiffness constants in the axial tangential radial and rotational directions respectively the dimensionless internal forces and displacements at both ends satisfy the relationship 24 m x k θ φ s x θ k w w v x k v v n x k u u where k α k α r 2 h k α u v w θ are dimensionless stiffness coefficients classic boundary conditions include s simply support c clamped and f free which are special cases of e elastic restrain boundary conditions when the dimensionless stiffness coefficients are generally taken as 106 the displacement result of the end tends to be zero which is approximately equivalent to rigid fixing similarly the corresponding displacement is not restrained if the dimensionless stiffness coefficient is set as 0 2 6 the vibro acoustic responses after assembling eq 7 eq 18 eq 19 and eq 22 the equations of the whole double walled cylindrical shell can be obtained as 25 t 1 i 0 0 0 0 0 t 2 i 0 0 0 0 0 t 3 i 0 0 0 0 0 i 0 0 0 0 0 t n i z ξ 1 z ξ 2 z ξ 3 z ξ n p 1 p 2 p n considering the boundaries conditions at both ends of the double walled cylindrical shell and introducing the eq 24 into the eq 25 the state vectors z ξ under the external load f ξ or generalized sound pressure can be obtained expansion of the determinant of the amplitude coefficient in eq 25 provides the dispersion equation of the double walled cylindrical shell corresponding to a given circumferential wavenumber n radial displacements satisfy the principle of linear superposition 26 w i x w f i x m 1 a m n w f i x b m n w g i x c m n w e i x i 1 2 where w f i x w e i x w f i x and w g i x represent the radial displacements under external excitation f x i θ i the generalized sound pressure e n k r r cos k m x f n k r r cos k m x g n k r r cos k m x respectively at the interface between the structure and the fluid the radial velocity of the fluid should be equal to the radial velocity of the cylindrical shell 27a 1 i ω ρ 1 p 1 r r r 1 w 1 t r r 1 27b 1 i ω ρ 1 p 1 r r r 2 w 2 t r r 2 27c 1 i ω ρ 2 p 2 r r r 2 w 2 t r r 2 selecting m m 2 π λ 1 and m m collocation points on the inner and outer shell surface and substituting eq 22 and eq 26 into eq 27 one obtains a set of linear algebraic equations as follows 28a m 0 a m n a 1 b m n b 1 c m n c 1 ρ 1 ω 2 w f 1 x m 28b m 0 a m n a 2 b m n b 2 c m n c 2 ρ 1 ω 2 w f 2 x m 28c m 0 a m n a 3 b m n b 3 c m n c 3 ρ 2 ω 2 w f 2 x m the sound pressure coefficients a m n b m n and c m n can be solved by the moore penrose pseudoinverse method then the sound pressure can be easily obtained from eq 22 coefficients a b and c are given in appendix a 3 results and discussion 3 1 numerical verification to verify the feasibility of the two methods for the annular plate model in section 2 2 the calculated results are compared with the results from the coupled fem bem the parameters of the double walled cylindrical shell are given as follow l 0 8 m r 1 0 25 m r 2 0 3 m h 1 h 2 2 mm the thickness of the annular plate is h r 10 mm δ l 0 16 all the shell components are made of steel with young s modulus e 2 1e11pa poisson s ratio μ 0 3 density ρ 7850 kg m3 based on the finite element software abaqus and the acoustic modules of lms virtual lab the numerical model was established to solve the vibration and acoustic radiation of the double walled cylindrical shell the mesh size ensures a minimum of 6 grids in a bending wavelength of the calculated frequency the shell element sc8r was employed to simulate the cylindrical shell and end cover the grid size of the finite element model is set to 10 mm the grid size of the end cover is 20 mm and the total mesh counts is 32549 after defining boundary conditions of both the inner and outer shell are c c clamped clamped the comparison of natural frequencies of the double walled cylindrical shell in vacuo is given to illustrate the effectiveness of both methods as shown in table 1 it can be found that the results from both methods appear to overlap and the maximum margin of error between the present method and the fem results is 1 it indicates that both method ⅰ and method ⅱ have higher accuracy for the vibration prediction of the double walled cylindrical shell see table 3 the structural damping loss factor η of the double walled cylindrical shells is 0 01 both the external fluid and interlayer fluid are water the other parameters of the double walled cylindrical shell are the same as the above model the point excitation is the radial unit sinusoidal force with the position of 0 4 0 0 25 the results of the radiated sound pressure at the position 0 4 0 1 3 calculated by the present method are compared with the results from the coupled fem bem as shown in fig 2 and table 4 it can be seen from fig 2 that the sound pressure level curves obtained by both methods line up over each other exactly which verify the consistency of the two ideas to simulate the annular plate the overall trend of both curves is consistent with the response curve from the coupled fem bem which proves the effectiveness of ptmm in the 10 hz 1000 hz band sound pressure level results predicted by ptmm agreed very well with numerical results although the peak numbers of the results from coupled fem bem are more than that of the results from ptmm in the 1000 hz 2000 hz band the radiated noise results are slightly different at the resonance peak value between ptmm and coupled fem bem 3 2 experimental verification the focus of this section is to validate the accuracy of the present method for natural frequencies of cylindrical shells the geometric and physical parameters for the test model of single walled cylindrical shell wang et al 2018 are length l 0 8 m radius r 0 3 m thickness t 4 mm sectional dimensions of the stiffener are h s 40 mm t s 4 mm the stiffeners spacing δl 0 16 m the density of the material ρ 7850 k g m 3 young s modulus e 203 gpa and poisson s ratio ν 0 3 15 mm thick caps are screwed at the ends of the cylinder experimental results of natural frequencies of the one walled cylindrical shell are employed to compare with those from the ptmm as shown in table 2 table 2 shows that the natural frequencies from ptmm are in good agreement with experimental results the clamped double walled cylindrical shell model is designed and made of q235 steel the double walled cylindrical shell has the following material properties length l 0 8 m radius of inner shell r 1 0 25 m radius of outer shell r 2 0 3 m inner outer shell and the annular plates thickness h 1 h 2 h r 4 mm the annular plates spacing δ l 0 15 m the density of the material ρ 7850 kg m 3 the elastic modulus of the material e 2 06 10 11 pa the poisson s ratio μ 0 3 and damping loss factor η 0 01 15 mm thick caps are screwed at the ends of the cylinder the external fluid is water with density ρ e 1000 kg m 3 and sound velocity c e 1500 m s the interlayer fluid is air with density ρ i 1 29 kg m 3 sound velocity c i 340 m s the natural frequencies for each order can be obtained by ptmm which are compared with the experiment results as illustrated in table 2 table 2 shows that the natural frequencies from ptmm are in good agreement with experiment results in air case the relative difference is less than 4 which proves the present method is correct the experimental model is also employed to verify acoustic responses calculated by ptmm as shown in fig 3 c and table 5 the boundary conditions of both ends of the cylindrical shell model are supposed to be clamped the sound pressure values in position 0 4 0 1 3 are disposed of with the exciting force acting in position 0 4 0 0 25 in the 5 hz 1500 hz band it can be observed that the acoustic response curves predicted by ptmm coincided very well with experimental curves except some loss of resonance peaks in low frequency this is because the peak frequency around 300 hz is corresponding to the natural frequency of the end cap because of the local vibration of both thick end caps and seal flange the acoustic response curves are slightly different at the resonance peak value as a group the results from the present method are consistent with the experimental results it shows that the present method is reliable to analyze the vibro acoustic characteristics of double walled cylindrical shells it is due to the assumption of artificial rigid cylinders attached to both ends of the cylindrical shell in theoretical analysis then the fluid structure interaction constrains the fluid motion which results in an increase in the kinetic energy of the fluid there is an obvious gap between the radiation impedances in the theoretical model and the experimental model 3 3 convergence analysis to check the convergence of the present method convergence analysis of wave numbers m and n for the acoustic response of the submerged double layer cylindrical shell with f f free free boundary condition is presented as shown in fig 4 the results indicate that only a few modes are needed to ensure the convergence at low frequency at higher frequencies more modalities are needed to ensure accuracy which also leads to an increase in the amount of calculation it can be seen from fig 4 that the proper circumferential wave number n 0 5 and axial half wave number m 1 35 can guarantee the calculation accuracy 3 4 parametric studies and discussions the main task of this paper is to provide the impact analysis of boundary constraints on the vibration and acoustic radiation of the double walled cylindrical shells in figs 5 9 the geometrical dimensions and material properties follow the same configurations of the model defined in section 3 1 the four types of elastic boundary conditions are considered in fig 5 which are defined as a inner shell with e f elastic restrain free outer shell with f f m 1 n 2 b inner shell with f f outer shell with e f m 1 n 2 c inner shell with e f outer shell with f f m 3 n 1 d inner shell with f f outer shell with e f m 3 n 1 fig 5 shows the relationship of natural frequency and the boundary constrained stiffness for the two modes of low frequency m 1 n 2 and high frequency m 3 n 1 respectively the natural frequency increases with the constraint stiffness lg k increasing and appear as an s shaped growth curve when the constraint stiffness is small enough or large enough the natural frequencies converge to a certain value the effect of the rotational stiffness k θ on the natural frequency can be ignored to study the effect of boundary conditions on the acoustic radiation of the double walled cylindrical shell the sound pressure levels under various axial boundary constrain stiffnesses are analyzed as shown in fig 6 the sound pressure curves are almost overlapped in 10hz 460 hz the peak frequency and amplitude have an obvious difference in 460 hz 1200 hz the third and fourth peaks gradually shift to the right as the axial stiffness increasing the sound pressure level curves are slightly separated but the trend is consistent in 1200 hz 3000 hz the sound pressure levels under various tangential boundary constrain stiffnesses are analyzed as shown in fig 7 whether the inner shell with e e elastic restrain elastic restrain or the outer shell with e e the sound pressure level curves under different tangential stiffnesses have a dramatic difference in 10 hz 1200 hz the sound pressure results under the outer shell with e e have almost no significant difference in 1200 hz 3000 hz the influence of the restraint position on the sound pressure becomes large as the tangential stiffness increasing the sound pressure levels under various radial boundary constrain stiffnesses are analyzed as shown in fig 8 the radial stiffness has a significant effect on the peak values of the sound pressure curve in 10hz 600 hz nevertheless the radial stiffness has relatively few effects on the sound pressure curves in 600 hz 3khz the trend of which is basically the same the influence of the radial constraint position on the first few peak values of the sound pressure level curve also becomes larger as the radial stiffness increasing it can be seen from fig 9 that the sound pressure curves of the three rotational stiffness substantially coincide which indicate that the effect of k θ on the sound pressure is very small negligible and the restraint position has almost no influence on the sound pressure under different rotational direction stiffness 4 conclusions in this paper the extensive double walled cylindrical shells are employed to investigate the reliability and scope of application of ptmm field transfer matrixes of both inner and outer shells are constructed respectively and point transfer matrixes of the annular plate are derived from both plate theory and conical shell theory after considering the fluid loads of both interlayer and external flow fields the vibration and sound radiation of submerged double walled cylindrical shells can be determined by satisfying neumann boundary conditions then nature frequencies and acoustic responses of the double walled cylindrical shells are calculated by ptmm and compared with the fem results and experimental results the comparison exhibits the present method is of high accuracy and efficiency and the effects of the general boundary constraint stiffness on the free vibration and radiated noise are analyzed and some vital and useful conclusions applicable to the arbitrary boundary are obtained further following concluding remarks can be given 1 extended ptmm is proposed to study the vibro acoustic responses of submerged double walled cylindrical shells which exhibits reliability and effectiveness the convergence of the acoustic radiation exhibits stable and rapid convergence characteristics the method can be extended to the vibro acoustic analysis of other complex structures including fgm cylindrical shells and composite cylindrical shells 2 the effect of the rotational stiffness on the natural frequency can be ignored the natural frequency increases with the other constraint stiffness increasing and appear as an s shaped growth curve 3 the effect of the rotational stiffness on the sound radiation can be negligible the peaks frequencies gradually shift to the right as the axial stiffness increasing the effect of the restraint position on the sound pressure becomes large as the tangential stiffness increasing acknowledgements the authors would like to thank the anonymous reviewers for their very valuable comments this paper was financially supported by the national natural science foundation of china 51779201 51609190 china scholarship council 201806955052 and nature science foundation of hubei province 2018cfb607 appendix b supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix b supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 106529 appendix a a1 a 1 d f n r d r r r 1 cos k m x ρ 1 ω 2 w f 1 x a2 b 1 d g n r d r r r 1 cos k m x ρ 1 ω 2 w g 1 x a3 c 1 ρ 1 ω 2 w e 1 x a4 a 2 d f n r d r r r 2 cos k m x ρ 1 ω 2 w f 2 x a5 b 2 d g n r d r r r 2 cos k m x ρ 1 ω 2 w g 2 x a6 c 2 ρ 1 ω 2 w e 2 x a7 a 3 ρ 2 ω 2 w f 2 x a8 b 3 ρ 2 ω 2 w g 2 x a9 c 3 d e n r d r r r 2 cos k m x ρ 2 ω 2 w e 2 x 
22361,vibro acoustic behaviour of submerged double walled cylindrical shells with general boundary conditions is analyzed by a precise transfer matrix method ptmm which is proposed by combining traditional transfer matrix method with precise integration method field transfer matrixes of both inner shell and outer shell are obtained accurately by ptmm respectively the annular plates are simulated by two methods and exist in the form of point transfer matrixes the dynamic models of double walled cylindrical shells are established by assembling whole transfer matrixes based on the helmholtz equation the interlayer and external fluid loads are described to solve the neumann boundary the vibro acoustic response of the double walled cylindrical shell can be obtained by determining sound pressure coefficients the free vibration and sound radiation of analytical models are comparing with numerical results and experimental results to verify the present method the effects of the general boundary constraint stiffnesses on the free vibration and sound radiation of double walled cylindrical shells are also discussed keywords transfer matrix method double walled cylindrical shells annular plates free vibration sound radiation 1 introduction the vibro acoustic response problem is always a hot topic in marine aerospace and automotive engineering design and manufacturing due to their superior mechanical acoustical and thermal properties double walled cylindrical shells are widely used in submarine aircraft evaporators pipelines and so forth the most common of which are steel taking the advantage of lightweight high strength isotropism simple fabrication and good sealing the steel double walled cylindrical shells are often selected as analyzed models to realize the insulation of vibration and sound radiation the excessive vibration and radiated noise of double walled cylindrical shells subjected to exterior loads certainly affect the safety and comfort an accurate understanding of the vibration and acoustic radiation characteristics of the double walled cylindrical shells is crucial in practical applications especially for the noise reduction of vibration structure up to now a huge number of analytical and numerical methods have been proposed to analyze the dynamic behaviours of various shell structures the application of the single walled cylindrical shell has many limitations due to its simple structural property in practical engineering therefore analytical methods are already applicable to the vibration analysis of a few combined cylindrical shell structures such as cylindrical shells tottenham and shimizu 1972 liang et al 2019 chen et al 2013 elliptic cylindrical shells zhang et al 2017a b ring stiffened cylindrical shells jafari and bagheri 2006 wang et al 2018 caresta and kessissoglou 2009 some researchers investigate other kinds of shell structures like conical cylindrical shells wang and guo 2016 qu et al 2013 chen et al 2015 and cylinder plate combination tso and hansen 1995 filippov and haseganu 2003 ma et al 2017 tso and hansen 1995 adopted the wave propagation approach to study the transmission of vibration waves through the junctions of an annular plate and an infinite cylindrical shell filippov and haseganu 2003 analyzed low frequencies and vibration modes of a thin cylindrical shell joined with an annular plate utilizing the asymptotic and numerical methods ma et al 2017 presented a modified fourier ritz method for coupled cylindrical shell and annular plate systems with a general boundary each displacement for the cylindrical shell and the annular plate is invariantly expressed as the modified fourier series composed of the standard fourier series and auxiliary functions the dynamic response of these shell structures can be solved by many numerical methods including finite element method fem everstine 1997 de faria 2004 boundary element method bem ventsel et al 2010 and coupled fem and bem everstine and henderson 1990 liu and chen 2009 the acoustic structure interaction problem of these complex shells can be solved by the discretization of the domain model and constructing the low order shape functions which limit the calculated frequency and computational efficiency by combining exact wave based method wbm and fem chen et al 2018 presented a hybrid approach to investigate vibration characteristics of a cylindrical shell coupled with interior structures however double walled shells are widely used in engineering applications due to their good mechanical properties and low vibration and noise features yamada et al 1986 presented the transfer matrix method to study the free vibration of a concentric double walled cylindrical shell closed by annular plates at two ends bai 2012 adopted the modal superposition method to analyze the sound and vibration transmission characteristics of simply supported double walled cylindrical shells with continuous or discontinuous annular plates combining measured partial vibration data of the inner shell zhang et al 2013 presented a modal superposition method to predict the sound radiated power of submerged double cylindrical shells zhou et al 2015 investigated sound transmission through a double walled cylindrical shell lined with poroelastic material in the core excited by pressure fluctuations due to the exterior turbulent boundary layer tbl based on hamilton s principle zhang and jin 2016 developed a modified fourier series solution to analyze the vibration of circular cylindrical double shell structures with arbitrary boundary conditions each displacement components of the cylindrical shells and annular plates are invariantly expanded as the superposition of a standard fourier series with several supplementary functions zhang et al 2017a b studied the sound transmission loss through a general double walled cylindrical shell system with one or two walls perforated which is excited by a plane wave in the presence of external mean flow after dividing the double walled cylindrical shell into several cylindrical shell segments xie and chen 2018 utilized a wave based method to calculate the vibration of double walled cylindrical shells coupled with annular plates both flügge shell theory and thin plate theory are employed to describe the motion of cylindrical segments and annular plates displacements of which are expanded as wave functions from the literature review only few articles discussed the acoustic radiation of the double walled cylindrical shell coupled with annular plates due to the geometrical and mathematical complexity in constructing the analytical model and these analytic models barely touch the submerged double walled cylindrical shell and the existence of interlayer water also it is not difficult to find that boundary conditions of double walled shells in the literature are mostly presupposed and many methods are limited to classical boundary conditions considering the limitations of numerical methods including fem bem and coupled fem bem it is of great significance to develop an analytical approximation method to obtain the vibration and acoustic response of submerged double walled cylindrical shells with arbitrary boundary conditions in this paper the traditional transfer matrix method is modified by borrowing the idea of precise integration method pim to improve the calculation accuracy of transfer matrixes then a precise transfer matrix method ptmm is proposed to solve structural vibration and sound radiation of submerged double walled cylindrical shell with arbitrary boundary conditions the present method can also be well applied to the acoustic performance analysis of other structures including fgm shells and composites shells firstly the paper proposes an efficient and accurate analysis method to investigate free vibration and forced vibrations and acoustic radiation of the double walled cylindrical shells secondly this method is particularly suitable for evaluating the vibration response of distributive systems regardless of the frequency and structural dimension finally it is applicable to deal with any classical and elastic boundary conditions 2 the double walled cylindrical shells the schematic diagram of a double walled cylindrical shell with uniformly distributed n ap 1 annular plates is shown in fig 1 the double walled cylindrical shell is described with the coordinates x θ r in which x is measured along the meridian r is the radial coordinate and θ is the circumferential coordinate mean radii of inner and outer shells are r 1 and r 2 and corresponding thicknesses are h 1 and h 2 it is assumed that all the shells and annular plates are made of homogeneous and isotropic materials ρ e ν and η are density young s modulus poisson s ratio and damping loss factor of the analytical model respectively the time dependent harmonic term e j ω t is suppressed in the formulation for simplicity 2 1 the cylindrical shell based on flügge shell theory flügge 1973 the equation of cylindrical shells can be written in a matrix differential equation as follows 1 d z ξ i d ξ i u ξ i z ξ i f ξ i p ξ i where superscripts i 1 2 represent the inner and outer shell and are applied below z ξ i u i v i w i φ i m x i v x i s x θ i n x i t is state vector the quantities u i v i w i marked with an overscore are the respective dimensionless variables u v and w are the displacement components in the axial circumferential and radial directions respectively n x s x θ v x and m x are normal force shear force transverse force and moment respectively ξ i satisfies x i r i r i are the thicknesses and the radii of the inner outer shell f ξ i and p ξ i denote the external forces and fluid loads respectively the coefficient matrix u ξ i is related to ξ i wang and guo 2016 after dividing the shell into n sections the coordinate positions of these discrete points along the meridian can be expressed as ξ 1 i ξ 2 i ξ 3 i ξ n i ξ n 1 i and ξ j 1 i ξ j i δ ξ i by assuming f ξ i equals f ξ i p ξ i the general solution of the linear non homogeneous dynamic equation can be expressed as 2 z ξ j 1 i t j i z ξ j i p j i 1 j n 1 i 1 2 where t j i exp ξ j i ξ j 1 i u τ i d τ e u i δ ξ i is the field transfer matrixes of the inner outer shell p j i ξ j i ξ j 1 i exp τ i ξ j 1 i u τ i d τ f τ i d τ is the duhamel integral term of the external force vector of the inner outer shell the transfer matrixes t j i of the inner outer shell can be solved by borrowing the idea of the precise integration method zhong 2004 the specific solution procedure is represented as 3 e u δ ξ exp h 2 s h u δ ξ 2 s where exp h can be solved by using a power series solution i 8 k 1 h k k i 8 is the identity matrix of eight order because the nonzero element of t a k 1 h k k is small there will be a mantissa precision failure resulted from rounding errors when i 8 is added to t a directly thus firstly t a is calculated according to addition theorem 4 e u δ ξ i 8 2 t a t a 2 2 s 1 the following statement can be executed 5 for iter 0 iter n iter t a 2 t a t a 2 after s times of circulation of its assignment one can obtain 6 e u δ ξ i 8 t a by mixing general solutions of the inner outer shell the general solution of the double walled cylindrical shells can be expressed as 7 t j z ξ j z ξ j 1 p j where t j t j 1 t j 2 is a 16 16 order field transfer matrix of the double walled cylindrical shells nonzero elements of which can be obtained from eq 6 z ξ j represents the state vectors z ξ j 1 z ξ j 2 t at ξ ξ j likewise z ξ j 1 equals z ξ j 1 1 z ξ j 1 2 t p j represents the external force vectors p ξ j 1 p ξ j 2 t 2 2 the annular plate two methods are employed to calculate the relationship between the state vector of the annular plate and the state vector of the inner outer shell method ⅰ is to employ the annular plate vibration equation chen et al 2002 to obtain the relationship and method ⅱ is to accomplish the aim by borrowing the truncated conical shell wang et al 2015 the circumferential displacement v r and the radial displacement w r in in plane vibration can be expressed as 8a v r n n r a n j n k a r n r b n y n k a r c n k b j n k b r d n k b y n k b r cos n θ 8b w r n a n k a j n k a r b n k a y n k a r n r c n j n k b r n r d n y n k b r sin n θ where j n and y n are n order bessel function and neumann function a n b n c n and d n are undetermined coefficient the relationships between the in plane forces and displacements of the annular plate are defined as 9 f r θ g r v r r v r r w r r θ f r r d r w r r μ w r r μ w r r θ where f r θ and f r r are the circumferential and radial forces g r e r h r 2 1 μ r d r e r h r 1 μ r 2 e r h r and μ r are young s modulus thickness and poisson s ratio of the annular plate respectively according to the displacement continuity conditions v i v r r r i and w i w r r r i i 1 2 then the displacement compatibility conditions at the junction can be derived as 10 v 1 w 1 v 2 w 2 t a a p a n b n c n d n t substituting the eq 8 into the eq 9 the force compatibility condition at the junction can be derived as 11 f r θ 1 f rr 1 f r θ 2 f rr 2 t b a p a n b n c n d n t where f r θ 1 f rr 1 are the circumferential and radial forces of the inner shell and f r θ 2 f rr 2 are the circumferential and the radial forces of the outer shell as the bending vibration the axial displacement u r of the annular plate can be expressed as 12 u r n e n j n k c r f n i n k c r g n y n k c r h n k n k c r cos n θ where i n and k n are n order bessel function and neumann function k c ω k c ρ r h r is the wavenumber e n f n g n and h n are undetermined coefficient the relationships between axial force f r x and bending moment m r and axial displacement and rotation angle of the annular plate are defined as 13a f r x k r 3 u r r 3 2 u r r r 2 2 μ r 3 u r r 2 r θ 2 u r r 2 r 3 μ r 2 u r r 3 θ 2 13b m r k r 2 u r r 2 μ r u r r r μ r 2 u r r 2 r θ according to displacement continuity condition u i u r r r i and φ i u r r r r i i 1 2 then the displacement compatibility conditions at the junction can be derived as 14 u 1 φ 1 u 2 φ 2 t c a p e n f n g n h n t substituting the eq 12 into the eq 13 the force compatibility condition at the junction can be derived as 15 f r x 1 m r 1 f r x 2 m r 2 t d a p e n f n g n h n t where f r x 1 m r 1 are the axial force and bending moment of the inner shell and f r x 2 m r 2 are the axial force and bending moment of the outer shell the relationship between the forces and displacements of the inner outer shell can be derived as 16a f r θ 1 f rr 1 f r θ 2 f rr 2 t b a p a a p 1 v 1 w 1 v 2 w 2 t 16b f r x 1 m r 1 f r x 2 m r 2 t d a p c a p 1 u 1 φ 1 u 2 φ 2 t method ⅱ to obtain the relationship is to simplify the conical shell to be the annular plate when the cone apex angle α 90 the vector transfer equation for the left and right ends of the conical shell segment is 17 z ξ 2 e ξ 1 ξ 2 u c d τ z ξ 1 t 12 z ξ 1 where ξ 1 ξ 2 represent the dimensionless inside radius and outside radius of the annular plate u c is the coefficient matrix for the conical shell wang et al 2015 t 12 is the transfer matrix of the annular plate according to the relationship of the force and displacement of the annular plate the state vectors of the double walled cylindrical shell satisfy 18 t k t r k z ξ k l z ξ k 1 r p k where z ξ k l and z ξ k r represent state vectors of the left section and the right section of the inner outer cylindrical shell at ξ ξ k respectively t r k is the point transfer matrix with the existence of the annular plate 2 3 the external load the external excitations acting on the shell can be simplified as concentrated forces f i i 1 2 n then the ith concentrated force can be expressed as 19 f x i θ i f 0 i δ s s 0 i δ θ θ 0 i r where f 0 i denotes the amplitude of the force s 0 i denotes the position of the force in the meridian θ 0 i denotes the position of the force in the circumferential angle for a given circumferential wave number n the external force can be expressed as 20 f r k 1 0 0 0 0 0 f n r f n c f n a t where f n r f n c and f n a represent the radial force circumferential force and axial force respectively 2 4 the fluid loads in the fluid media the acoustic pressure p must satisfy the helmholtz equation 21 2 p 2 r 1 r p r 1 r 2 2 p 2 θ 2 p 2 x k 0 2 p 0 where k 0 ω c 0 is the wavenumber ω is the angular frequency and c 0 is the speed of sound in the fluid the acoustic pressure of the outer flow field should also satisfy the sommerfeld boundary condition the sound pressure p 1 in the interlayer fluid is different from the sound pressure p 2 in the external flow field the acoustic pressure of both interlayer and external fluid field can be written as 22a p 1 n 0 m 0 a m n f n k r r b m n g n k r r cos k m x cos n θ 22b p 2 n 0 m 0 c m n e n k r r cos k m x cos n θ where a m n b m n c m n are sound pressure coefficients k m m π l are the wavenumbers in the meridian direction and k r k 0 2 k m 2 e n f n g n are related to k r when k r is a real number e n is hankel function of the second kind f n is a bessel function and g n is a neumann function when the generalized sound pressure f τ 2 e n k r r cos k m x is only external force the response term p j 2 of the outer shell can be expressed as 23 p j 2 ξ j 2 ξ j 1 2 exp τ 2 ξ j 1 2 u τ 2 d τ f τ 2 d τ 0 δ ξ 2 e u 2 τ 2 cos k m l ξ j 1 2 τ 2 g d τ where g r 2 3 k 2 0 0 0 0 0 e n k r r 2 0 0 t the duhamel integral term can be calculated by the precise integration method wang et al 2015 similarly the solution process of the duhamel integral term p j 1 under generalized sound pressure f n k r r cos k m x and g n k r r cos k m x are consistent with the above process 2 5 general boundary to simulate general boundary conditions spring constraint is employed to restrain displacements at both ends of the cylindrical shell k u k v k w and k θ are the constrained stiffness constants in the axial tangential radial and rotational directions respectively the dimensionless internal forces and displacements at both ends satisfy the relationship 24 m x k θ φ s x θ k w w v x k v v n x k u u where k α k α r 2 h k α u v w θ are dimensionless stiffness coefficients classic boundary conditions include s simply support c clamped and f free which are special cases of e elastic restrain boundary conditions when the dimensionless stiffness coefficients are generally taken as 106 the displacement result of the end tends to be zero which is approximately equivalent to rigid fixing similarly the corresponding displacement is not restrained if the dimensionless stiffness coefficient is set as 0 2 6 the vibro acoustic responses after assembling eq 7 eq 18 eq 19 and eq 22 the equations of the whole double walled cylindrical shell can be obtained as 25 t 1 i 0 0 0 0 0 t 2 i 0 0 0 0 0 t 3 i 0 0 0 0 0 i 0 0 0 0 0 t n i z ξ 1 z ξ 2 z ξ 3 z ξ n p 1 p 2 p n considering the boundaries conditions at both ends of the double walled cylindrical shell and introducing the eq 24 into the eq 25 the state vectors z ξ under the external load f ξ or generalized sound pressure can be obtained expansion of the determinant of the amplitude coefficient in eq 25 provides the dispersion equation of the double walled cylindrical shell corresponding to a given circumferential wavenumber n radial displacements satisfy the principle of linear superposition 26 w i x w f i x m 1 a m n w f i x b m n w g i x c m n w e i x i 1 2 where w f i x w e i x w f i x and w g i x represent the radial displacements under external excitation f x i θ i the generalized sound pressure e n k r r cos k m x f n k r r cos k m x g n k r r cos k m x respectively at the interface between the structure and the fluid the radial velocity of the fluid should be equal to the radial velocity of the cylindrical shell 27a 1 i ω ρ 1 p 1 r r r 1 w 1 t r r 1 27b 1 i ω ρ 1 p 1 r r r 2 w 2 t r r 2 27c 1 i ω ρ 2 p 2 r r r 2 w 2 t r r 2 selecting m m 2 π λ 1 and m m collocation points on the inner and outer shell surface and substituting eq 22 and eq 26 into eq 27 one obtains a set of linear algebraic equations as follows 28a m 0 a m n a 1 b m n b 1 c m n c 1 ρ 1 ω 2 w f 1 x m 28b m 0 a m n a 2 b m n b 2 c m n c 2 ρ 1 ω 2 w f 2 x m 28c m 0 a m n a 3 b m n b 3 c m n c 3 ρ 2 ω 2 w f 2 x m the sound pressure coefficients a m n b m n and c m n can be solved by the moore penrose pseudoinverse method then the sound pressure can be easily obtained from eq 22 coefficients a b and c are given in appendix a 3 results and discussion 3 1 numerical verification to verify the feasibility of the two methods for the annular plate model in section 2 2 the calculated results are compared with the results from the coupled fem bem the parameters of the double walled cylindrical shell are given as follow l 0 8 m r 1 0 25 m r 2 0 3 m h 1 h 2 2 mm the thickness of the annular plate is h r 10 mm δ l 0 16 all the shell components are made of steel with young s modulus e 2 1e11pa poisson s ratio μ 0 3 density ρ 7850 kg m3 based on the finite element software abaqus and the acoustic modules of lms virtual lab the numerical model was established to solve the vibration and acoustic radiation of the double walled cylindrical shell the mesh size ensures a minimum of 6 grids in a bending wavelength of the calculated frequency the shell element sc8r was employed to simulate the cylindrical shell and end cover the grid size of the finite element model is set to 10 mm the grid size of the end cover is 20 mm and the total mesh counts is 32549 after defining boundary conditions of both the inner and outer shell are c c clamped clamped the comparison of natural frequencies of the double walled cylindrical shell in vacuo is given to illustrate the effectiveness of both methods as shown in table 1 it can be found that the results from both methods appear to overlap and the maximum margin of error between the present method and the fem results is 1 it indicates that both method ⅰ and method ⅱ have higher accuracy for the vibration prediction of the double walled cylindrical shell see table 3 the structural damping loss factor η of the double walled cylindrical shells is 0 01 both the external fluid and interlayer fluid are water the other parameters of the double walled cylindrical shell are the same as the above model the point excitation is the radial unit sinusoidal force with the position of 0 4 0 0 25 the results of the radiated sound pressure at the position 0 4 0 1 3 calculated by the present method are compared with the results from the coupled fem bem as shown in fig 2 and table 4 it can be seen from fig 2 that the sound pressure level curves obtained by both methods line up over each other exactly which verify the consistency of the two ideas to simulate the annular plate the overall trend of both curves is consistent with the response curve from the coupled fem bem which proves the effectiveness of ptmm in the 10 hz 1000 hz band sound pressure level results predicted by ptmm agreed very well with numerical results although the peak numbers of the results from coupled fem bem are more than that of the results from ptmm in the 1000 hz 2000 hz band the radiated noise results are slightly different at the resonance peak value between ptmm and coupled fem bem 3 2 experimental verification the focus of this section is to validate the accuracy of the present method for natural frequencies of cylindrical shells the geometric and physical parameters for the test model of single walled cylindrical shell wang et al 2018 are length l 0 8 m radius r 0 3 m thickness t 4 mm sectional dimensions of the stiffener are h s 40 mm t s 4 mm the stiffeners spacing δl 0 16 m the density of the material ρ 7850 k g m 3 young s modulus e 203 gpa and poisson s ratio ν 0 3 15 mm thick caps are screwed at the ends of the cylinder experimental results of natural frequencies of the one walled cylindrical shell are employed to compare with those from the ptmm as shown in table 2 table 2 shows that the natural frequencies from ptmm are in good agreement with experimental results the clamped double walled cylindrical shell model is designed and made of q235 steel the double walled cylindrical shell has the following material properties length l 0 8 m radius of inner shell r 1 0 25 m radius of outer shell r 2 0 3 m inner outer shell and the annular plates thickness h 1 h 2 h r 4 mm the annular plates spacing δ l 0 15 m the density of the material ρ 7850 kg m 3 the elastic modulus of the material e 2 06 10 11 pa the poisson s ratio μ 0 3 and damping loss factor η 0 01 15 mm thick caps are screwed at the ends of the cylinder the external fluid is water with density ρ e 1000 kg m 3 and sound velocity c e 1500 m s the interlayer fluid is air with density ρ i 1 29 kg m 3 sound velocity c i 340 m s the natural frequencies for each order can be obtained by ptmm which are compared with the experiment results as illustrated in table 2 table 2 shows that the natural frequencies from ptmm are in good agreement with experiment results in air case the relative difference is less than 4 which proves the present method is correct the experimental model is also employed to verify acoustic responses calculated by ptmm as shown in fig 3 c and table 5 the boundary conditions of both ends of the cylindrical shell model are supposed to be clamped the sound pressure values in position 0 4 0 1 3 are disposed of with the exciting force acting in position 0 4 0 0 25 in the 5 hz 1500 hz band it can be observed that the acoustic response curves predicted by ptmm coincided very well with experimental curves except some loss of resonance peaks in low frequency this is because the peak frequency around 300 hz is corresponding to the natural frequency of the end cap because of the local vibration of both thick end caps and seal flange the acoustic response curves are slightly different at the resonance peak value as a group the results from the present method are consistent with the experimental results it shows that the present method is reliable to analyze the vibro acoustic characteristics of double walled cylindrical shells it is due to the assumption of artificial rigid cylinders attached to both ends of the cylindrical shell in theoretical analysis then the fluid structure interaction constrains the fluid motion which results in an increase in the kinetic energy of the fluid there is an obvious gap between the radiation impedances in the theoretical model and the experimental model 3 3 convergence analysis to check the convergence of the present method convergence analysis of wave numbers m and n for the acoustic response of the submerged double layer cylindrical shell with f f free free boundary condition is presented as shown in fig 4 the results indicate that only a few modes are needed to ensure the convergence at low frequency at higher frequencies more modalities are needed to ensure accuracy which also leads to an increase in the amount of calculation it can be seen from fig 4 that the proper circumferential wave number n 0 5 and axial half wave number m 1 35 can guarantee the calculation accuracy 3 4 parametric studies and discussions the main task of this paper is to provide the impact analysis of boundary constraints on the vibration and acoustic radiation of the double walled cylindrical shells in figs 5 9 the geometrical dimensions and material properties follow the same configurations of the model defined in section 3 1 the four types of elastic boundary conditions are considered in fig 5 which are defined as a inner shell with e f elastic restrain free outer shell with f f m 1 n 2 b inner shell with f f outer shell with e f m 1 n 2 c inner shell with e f outer shell with f f m 3 n 1 d inner shell with f f outer shell with e f m 3 n 1 fig 5 shows the relationship of natural frequency and the boundary constrained stiffness for the two modes of low frequency m 1 n 2 and high frequency m 3 n 1 respectively the natural frequency increases with the constraint stiffness lg k increasing and appear as an s shaped growth curve when the constraint stiffness is small enough or large enough the natural frequencies converge to a certain value the effect of the rotational stiffness k θ on the natural frequency can be ignored to study the effect of boundary conditions on the acoustic radiation of the double walled cylindrical shell the sound pressure levels under various axial boundary constrain stiffnesses are analyzed as shown in fig 6 the sound pressure curves are almost overlapped in 10hz 460 hz the peak frequency and amplitude have an obvious difference in 460 hz 1200 hz the third and fourth peaks gradually shift to the right as the axial stiffness increasing the sound pressure level curves are slightly separated but the trend is consistent in 1200 hz 3000 hz the sound pressure levels under various tangential boundary constrain stiffnesses are analyzed as shown in fig 7 whether the inner shell with e e elastic restrain elastic restrain or the outer shell with e e the sound pressure level curves under different tangential stiffnesses have a dramatic difference in 10 hz 1200 hz the sound pressure results under the outer shell with e e have almost no significant difference in 1200 hz 3000 hz the influence of the restraint position on the sound pressure becomes large as the tangential stiffness increasing the sound pressure levels under various radial boundary constrain stiffnesses are analyzed as shown in fig 8 the radial stiffness has a significant effect on the peak values of the sound pressure curve in 10hz 600 hz nevertheless the radial stiffness has relatively few effects on the sound pressure curves in 600 hz 3khz the trend of which is basically the same the influence of the radial constraint position on the first few peak values of the sound pressure level curve also becomes larger as the radial stiffness increasing it can be seen from fig 9 that the sound pressure curves of the three rotational stiffness substantially coincide which indicate that the effect of k θ on the sound pressure is very small negligible and the restraint position has almost no influence on the sound pressure under different rotational direction stiffness 4 conclusions in this paper the extensive double walled cylindrical shells are employed to investigate the reliability and scope of application of ptmm field transfer matrixes of both inner and outer shells are constructed respectively and point transfer matrixes of the annular plate are derived from both plate theory and conical shell theory after considering the fluid loads of both interlayer and external flow fields the vibration and sound radiation of submerged double walled cylindrical shells can be determined by satisfying neumann boundary conditions then nature frequencies and acoustic responses of the double walled cylindrical shells are calculated by ptmm and compared with the fem results and experimental results the comparison exhibits the present method is of high accuracy and efficiency and the effects of the general boundary constraint stiffness on the free vibration and radiated noise are analyzed and some vital and useful conclusions applicable to the arbitrary boundary are obtained further following concluding remarks can be given 1 extended ptmm is proposed to study the vibro acoustic responses of submerged double walled cylindrical shells which exhibits reliability and effectiveness the convergence of the acoustic radiation exhibits stable and rapid convergence characteristics the method can be extended to the vibro acoustic analysis of other complex structures including fgm cylindrical shells and composite cylindrical shells 2 the effect of the rotational stiffness on the natural frequency can be ignored the natural frequency increases with the other constraint stiffness increasing and appear as an s shaped growth curve 3 the effect of the rotational stiffness on the sound radiation can be negligible the peaks frequencies gradually shift to the right as the axial stiffness increasing the effect of the restraint position on the sound pressure becomes large as the tangential stiffness increasing acknowledgements the authors would like to thank the anonymous reviewers for their very valuable comments this paper was financially supported by the national natural science foundation of china 51779201 51609190 china scholarship council 201806955052 and nature science foundation of hubei province 2018cfb607 appendix b supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix b supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 106529 appendix a a1 a 1 d f n r d r r r 1 cos k m x ρ 1 ω 2 w f 1 x a2 b 1 d g n r d r r r 1 cos k m x ρ 1 ω 2 w g 1 x a3 c 1 ρ 1 ω 2 w e 1 x a4 a 2 d f n r d r r r 2 cos k m x ρ 1 ω 2 w f 2 x a5 b 2 d g n r d r r r 2 cos k m x ρ 1 ω 2 w g 2 x a6 c 2 ρ 1 ω 2 w e 2 x a7 a 3 ρ 2 ω 2 w f 2 x a8 b 3 ρ 2 ω 2 w g 2 x a9 c 3 d e n r d r r r 2 cos k m x ρ 2 ω 2 w e 2 x 
22362,this paper explores optimal configuration of wave energy converters wecs arrays allowing both dimensions of individual wecs as well as the array layout to vary cylindrical buoys are assumed in the array where their radii and drafts are optimization parameters genetic algorithms are used for optimization three case studies are investigated of different array sizes 3 5 and 7 devices in the array two types of controls are assumed the first is the standard impedance matching control while the second is a derivative control the numerical test cases demonstrate that a higher q factor is achieved when optimizing the buoys dimensions simultaneously with the array layout in the test cases conducted in this paper it is shown that optimizing the array layout can increase the q factor on average by 39 21 when using an optimal control and increase it on average by a factor of 8 87 when using a derivative control keywords wec array wec optimization wave energy converters arrays nomenclature f c control force vector f e x excitation force vector b v array viscous damping matrix k h array hydro static coefficient matrix m array inertia matrix u c optimal velocity vector ω frequency b r i radiation damping element of the i t h buoy b e m boundary element method d i draft height of each buoy f r i radiation force of the i t h buoy h r i radiation kernel of the i t h buoy k wave number k d coefficient of the derivative control force m a i added mass element of the i t h buoy n w e c number of wec in the array o s w c oscillating wave surge converter p i power absorption from an isolated wec p m a x array power absorption using optimal control p p a s s i v e array power absorption using derivative control r i radius of each buoy v i volume of each buoy w e c wave energy converter x i y i plane coordinates of the i t h buoy z i z displacement of the i t h buoy array displacement vector 1 introduction aside from the growing market and industry of ocean wave energy the total theoretical potential from just wave energy is estimated to be 29 5 pwh yr in 2010 which covers more than the entire u s electricity power consumption in 2008 worldenergycouncil 2016 the need for renewable energy the increasing capacity of energy market and the large potential in ocean waves all calls for the development of more efficient design and control of ocean wave energy devices and farms to serve the large electricity production that can be connected to power grid oscillating body type wave energy converters need to be installed in the form of arrays or farms global layout and size of array shape and dimension of each device along with wave profile including wave direction and sea states all have great impact on the array performance fitzgerald and thomas 2007 göteman et al 2015 giassi and göteman 2018 since the early research of budal 1977 thomas and evans 1981 and falnes 1980 optimal layout of an array has been studied for many cases and remains a popular topic in array design layout optimization has been done for both regular and irregular waves to find optimal layout for an array of given size due to the complex nature of hydrodynamic interaction moarefdoost et al 2017 global optimization is required to find the optimal layout that provides constructive interaction similar to fitzgerald s study fitzgerald and thomas 2007 child and venugopal 2010 modified the layout optimization problem and formulates a local optimization the parabolic intersection method child developed is more efficient but less accurate than traditional ga moarefdoost et al 2017 borrowed the idea and further increased calculation speed by using point absorber approximation from budal 1977 rather than using exact hydrodynamics meanwhile layout optimization is conducted by mcguinness with the constrains of device motion mcguinness and thomas 2017 in 2017 tay and venugopal studied the optimal spacing of an oscillating wave surge converter oswc array using a modified genetic algorithm tay and venugopal 2017 the scatter parameter was found to affect the optimal spacing significantly the optimal layout for an oswc array was found to have to let the wave propagate through the array with little reflection time domain simulations of heaving wec arrays were conducted by bozzi et al 2017 the three phase electric power model was employed to calculate the power take off force different array layouts and wave directions were considered in their work in array optimization problems modeling exact hydrodynamic interaction is well recognized to consume the most computational power in the review of park effect in wec arrays babarit 2013 concludes that bem solvers provide the most accurate hydrodynamics with the least speed on the other hand analytical approximation such as point absorber approximation limits the ability to study more complex configuration of arrays thus most of the array layout studies focus on arrays of identical buoys which holds a high level accuracy even with analytical approximation machine learning methods have also been borrowed to search for an optimal layout of flap type wec array sarkar et al 2016 besides the separation distances the sizes and shapes of wec devices are significant factors in designing arrays an earlier study of the compact array has found that the center buoy always has a higher response compared to the other buoys in the array garnaud and mei 2010 the impact from varying separation distance of each device in the array is studied by ringwood and korde 2016 with arrays containing 2 3 and 4 buoys with four arbitrary geometries of the layout a 40 higher q factor was found when control and separation distance were selected properly recently an expanded multiple scattering method is developed by göteman 2017 which assumes cylindrical device while allowing the size of each device to change this study showed an improved array performance with buoys of different dimensions and great potential in designing large wec arrays further the shape of a single submerged absorber plate was optimized by esmaeilzadeh in 2019 using the genetic algorithm esmaeilzadeh and alam 2019 the contour of the planar was parameterized by fourier decomposition of a plane geometry inspired by the above studies ringwood and korde 2016 göteman 2017 this paper explores the optimal configuration of both dimension and layout of arrays of heaving buoys with full interaction and exact hydrodynamics from the numerical bem solver nemoh the optimal layout found under point absorber approximation is employed as initial set up for the array moarefdoost et al 2017 then the dimension of each buoys is optimized with exact hydrodynamics calculated from nemoh the optimization of both dimension and layout is conducted as a validation against previous optimization in section 2 the dynamic model and controls for the wec array is presented optimization problem formulation is presented in section 3 section 4 shows the results with 2 different controllers the impedance matching control reveals theoretical maximum power from the array and the passive control utilizes a more realistic perspective irregular wave optimization results are discussed in section 5 2 wec array dynamic model 2 1 dynamics of wec array the wave energy converter arrays we considered in this work are assumed to contain only cylindrical heaving wecs linear potential flow theory is employed for developing dynamic equation of motion for the array the total force acting on each wec device is expressed with a combination of hydro static buoyancy force and hydrodynamic force with linearity of velocity potential of fluid the incoming dynamic ocean wave can be expressed as summation of incident wave potential diffracted wave potential and radiated wave potential newman 1935 falnes 2002 where incident wave and diffracted wave contribute to what we call wave excitation force and radiated wave results in radiation force the radiation force can be expressed as summation of a force proportional to acceleration and convolution of radiation kernel and velocity zou et al 2017 this work focuses mostly on frequency domain analysis with regular wave as the input to the system 1 f r i m a i x i 0 h i τ τ x i t τ d τ with fourier transformation the convolution can be solved in frequency domain and we can express the radiation force with frequency dependent coefficients 2 f r i ω 2 m a i ω z i j ω b r i ω z i where i denotes each wec in array thus we can write equation of motion for an wec array in the compact matrix form in eq 3 the array dynamic system expressed by eq 3 considers regular wave as the input when the incoming wave becomes irregular frequency is introduced as an additional dimension to all the arrays and matrices only frequency domain analysis is valid with irregular wave inputs 3 ω 2 m m a ω z j ω b v b r ω z k h z f e x f c in eq 3 m and m a ω are the mass and added mass matrices of the array b v and b r ω are the viscous and radiation damping matrices and k h is the hydro static coefficient matrix of the array m b v and k h are the static force coefficient matrices and contain only diagonal elements in the radiation coefficient matrices m a ω and b r ω the hydrodynamic interaction is shown by off diagonal elements 4 m a a r r a y ω m a 11 ω m a 12 ω m a 1 n ω m a 21 ω m a 22 ω m a 23 ω m a 2 n ω m a n 1 ω m a n n ω b r a r r a y ω b r 11 ω b r 12 ω b r 1 n ω b r 21 ω b r 22 ω b r 23 ω b r 2 n ω b r n 1 ω b r n n ω in this paper we neglect the effect of viscous damping hence the only damping matrix left is b r ω vector x is the displacement vector of array f e x and f c are the excitation force and control force vector respectively all hydrodynamic coefficients can be calculated using the numerical bem solver nemoh 2 2 calculation of control force and power to extract energy from the wec array a control algorithm that can provide the proper control force is necessary to obtain the preliminary results from simulation two different control strategies are employed one unconstrained impedance matching control reveals the theoretical optimum power absorption and one passive derivative control produces a control force proportional to the velocity when designing optimal controller for a given wec array devices can either be able to share information and communicate with each other with global control or can access only information and prediction from sensors mounted on themselves with independent control ringwood and korde 2016 bacelli et al 2013 in this work the optimal control refers to the global optimal control considering an isolated oscillating system with only heave motion the dynamic system takes the form of a mass spring damper system and the optimal control optimizes the power calculated from this system the maximum power from a mass spring damper system is obtained when the reactive terms are canceled and the resistive terms are doubled this is also called complex conjugate control song et al 2016 for an array of oscillators the optimal solution is given byfalnes 2002 in the absence of constraints the optimal velocity is given by matching impedance of the physical system falnes 2002 5 u c 1 2 b r ω 1 f e x the optimum power for array is then found to be falnes 2002 6 p m a x 1 8 f e x b r ω 1 f e x note that in eq 6 f e x is the hydrodynamic excitation force coefficient calculated from the bem solver assuming a unity wave input physically both m a ω and b r ω are symmetric since the radiation impedance between any two bodies are the same with the unit velocity it implies that m a i j ω m a j i ω and b r i j ω b r j i ω where i and j are the index for wecs in the array a power calculated from eq 6 is always real but with the bem solver such as nemoh there is a numerical error between m a i j ω and m a j i ω when wecs in the array are no longer identical see fig 1 in the later simulation only half of the hydrodynamic matrix is carried into calculation as a correction to this problem with the optimal control this power can be considered as theoretical maximum absorbed power from the array the second control implemented in this work is passive control with the control force defined to be proportional to the array velocity eq 7 7 f c j ω k d z the coefficient matrix k d has only the diagonal elements of b r ω and the power from array is written as eq 8 the control force needs only the information from the buoy itself but not from the entire array 8 p p a s s i v e j ω i 1 i n f c i z i ω 2 i 1 i n k d i z i 2 it is useful to study the optimization results using both control strategies since we know that impedance matching control will fail in time domain simulation but provide good guidance in theoretical optimum energy while derivative control is easy to implement but the potential in harvesting energy is limited 3 the wec array optimization problem 3 1 optimization of the dimensions of each buoy in the wec array with genetic algorithm in this section the q factor of the array is optimized with the design parameters selected as the radius of each buoy in the array the layout of the array is optimized separately with the equation of q factor simplified with the point absorber approximation moarefdoost et al 2017 with the wave direction of 0 the optimized layouts for arrays that contain three five and seven wecs are solved in the literature moarefdoost et al 2017 and the result is shown in fig 2 once the optimal layout is obtained it will be used for optimization of the dimension of each buoy in the array the variables that define the dimension of the cylindrical buoys are 1 radius of each buoy r 1 r 2 r n 2 draft height of each buoy d 1 d 2 d n here we constrained the design variables by fixing the mass of each device this leads to a constant submerged volume of each buoy the constraint can be written as 9 v i π r i 2 d i c o n s t a n t with the constraint above the design variables are defined as the radius of each buoy r 1 r 2 r n with the draft height of each buoy defined as d i v i π r i 2 the initial volume of each buoy is selected as 1 m 3 the formulation of the optimization is written as 10 m a x d i m e n s i o n l a y o u t q p a r r a y p i s t d i 1 π r i 2 i 1 2 3 r i 0 5 2 m i 1 2 3 3 2 optimization of both dimension and layout of wec array the mathematical formulation of the novel dimension layout optimization for a wec array is presented in this section similar to the optimization in section 3 1 the objective is to maximize the q factor of an wec array the design parameters are selected as both the layout of the array and the dimension of each wec device since the optimal layout of a wec array is symmetric under the point absorber approximation fitzgerald and thomas 2007 another constraint on the location of each wec needs to be considered in this study only optimal control is applied to calculate the power from the array this optimization is done only on the array of three wecs the design variables are the radius of each buoy r 1 r 2 r 3 and the location of each buoy x 1 y 1 x 2 y 2 x 3 y 3 in cartesian coordinate applying the constraint of symmetric layout the location of the first buoy is fixed at the origin the location of the second buoy is on the upper half plain and the location of the third buoy is on the lower half plain the formulation of this optimization is written as 11 m a x d i m e n s i o n l a y o u t q p a r r a y p i s t d i 1 π r i 2 i 1 2 3 r i 0 5 2 m i 1 2 3 x 1 y 1 0 m x 2 x 3 10 10 m y 2 4 5 k 50 4 5 k 50 m y 3 4 5 k 50 4 5 k 50 m where k is the wave number and 0 4 5 k m is the optimal location for the second and the third buoy solved with point absorber approximation from section 3 1 genetic algorithm built in matlab is employed to solve both optimization problems with the settings shown in table 1 at each generation a random binary vector that has the same length as design variable vector will be created the genes of the crossover child will be taken from the first parent if the corresponding element in the crossover vector is 1 the genes will be taken from the second parent if the corresponding element is 0 a random number selected using zero mean gaussian distribution with respect to each element in the parent vector will be added to the parent vector to create mutation in the children 4 numerical results 4 1 simulation setup all simulations are conducted on michigan tech s shared high performance computing cluster the cluster has 32 cpu cores intel xeon e5 2683 2 10 ghz and 256 gb ram the initial wec array layout is shown in fig 2 the initial dimension for all wecs are selected as r 1 m d 1 m the wave number used for comparison is k 0 2 the wave direction is set to β 0 for all simulation hydrodynamics bem solver nemoh is employed to compute the exact hydrodynamics for all simulation moarefdoost et al 2017 presents a case study of an array of 3 wecs that will be investigated further in this paper moarefdoost et al 2017 uses a point absorber approximation assuming all buoys have identical dimensions and show that the q factor remains unchanged if the product of k r is constant here we first use a numerical boundary element method nemoh to validate this conclusion table 2 shows a comparison between the results presented in moarefdoost et al 2017 and the results obtained using nemoh for the same array assuming identical buoys dimensions the product k r 0 2 was kept the same in all the cases the resulting q factor did not change significantly the following sections will highlight the impact of allowing different buoys in the array to have different dimensions on the q factor 4 2 optimization of dimension of each buoy in the wec array with the layout shown in fig 2 and the mathematical formulation in section 3 optimization of the dimension of each wec in the arrays of three five and seven buoys are done with both the optimal control and the passive control optimization results using the optimal control are shown in fig 3 and results using the derivative are shown in fig 4 for the array of three wecs buoy 1 2 3 refer to the buoy on the center the buoy on the top and the buoy on the bottom for the array of five wecs buoy 1 to 5 are the buoy on the center the upper buoy on the 2nd column the lower buoy on the 2nd column the upper buoy on the 3rd column and the lower buoy on the 3rd column respectively for the array of seven wecs buoy 1 is on the center buoy 2 4 6 are the upper buoys on column 1 2 3 and buoy 3 5 7 are the lower buoys on each column as the results in figs 3 and 4 indicate higher q factors are achieved by optimizing the dimension of buoys the average optimized q factor is 39 21 higher using the optimal control and it is 8 87 higher using the derivative control the q factors increase differently in the two presented categories of tests the first batch of tests are ones that use optimal control complex conjugate control this control method is known for providing the maximum possible energy without considering constraints as a result the resulting q factors shown on fig 3 are significantly higher while the buoys oscillate with unrealistic displacement which can be seen from table 3 in table 3 z 3 z 5 and z 7 exceed 2 meters using optimal control which are higher than the wave amplitude of one meter the harvested mean power is also higher for each of the tests these tests are good for showing the maximum possible potential of the array but are not good for realistic considerations the second batch of tests use damping control which also increase the q factors these tests are good for realistic considerations while there exist room for the improvement of the control design with the initial setup arrays using the derivative control do not perform as well as arrays using the optimal control this is because the selected layout is optimized with the point absorber approximation which assumes the optimal control but with optimization of the dimension the q factors for all three arrays are above one it indicates a constructive coupling effect between each buoy in the array fig 4 on fig 5 the red circles are optimized radius of each buoy and the black circles are the initial radius of each buoy for the tests with the optimal control we can see that the center buoys in all three arrays have the largest possible radius and almost all other buoys have the smallest possible radius for the tests with the derivative control the center buoys have the largest radius and the buoys on the third column have the 2nd largest radius to further understand the results detailed dimensions and hydrodynamics have been examined the buoys initial and optimized dimensions are shown in fig 5 and the excitation force coefficients are shown on fig 6 in the test with optimal control the center buoy in all 3 arrays have larger dimensions than the other buoys in array and all buoys on the side are small and thus only experience small excitation force except for top left buoys on fig 5 on the left part of fig 6 buoy 2 has a larger radius than 3 in both array of 5 and 7 wecs which experiences a higher excitation force as shown as blue triangles based on observation above we can separate buoys in the arrays into different groups by their radius then further investigate the effect of hydrodynamic coefficients for each group buoys in group 1 in all tests have radius of 2 m and buoys in group 3 have radius of 0 5 m buoys in group 2 have radius between 1 m and 1 5 m since radiation impedance is affected by dimension and relative distance between each buoy it is useful to observe the radiation impedance of each group and coupled impedance between each group radiation impedance of each group is defined to be z g i and coupled impedance is defined to be z g i j where i and j denotes group number discussion will be focused on radiation damping b r g i and b r g i j which is the real part of the impedance from optimization results with optimal control on fig 7 it is shown that center buoys are optimized to have larger radiation damping on themselves and buoys around them are all optimized to have small radiation damping on themselves we can see that the radiation damping coefficients are grouped together for buoys of the same dimensions on fig 7 all the optimal arrays using the complex conjugate control have one larger buoy at the center with larger radiation impedance and smaller buoys on the side with smaller radiation impedance when optimized using the passive control buoys in the middle group have the same larger size and buoys in other groups have smaller sizes the groups are shown in table 4 besides the radiation acting on each buoys themselves the coupling terms in radiation damping matrices are also presented in table 5 from results in table 5 optimization with derivative control results in larger radiation damping coefficients for entire radiation impedance matrix while results with optimal control focus most on the center buoy in array and diminishes the effect from other buoys 5 discussion 5 1 optimization of both layout and dimension of wecs in the array point absorber approximation is used to calculate and to optimize the layout of array in literature moarefdoost et al 2017 when optimal control is applied the power calculated with exact hydrodynamics is the same as solution from point absorber approximation then it is possible to optimize of both layout and dimension together and when optimal control is employed the solution of layout and dimension should be the same as the solution from section 4 to optimize both layout of array and dimension of buoys additional constraints need to be considered from the results of previous optimization when optimal control is employed the buoy in the center of array has the most significant contribute to the total power extraction so center buoy will be fixed at origin of the domain then with symmetry of layout considered the side buoys are constrained to move only in half of the domain in y direction the new layout constraint for array of 3 wecs is shown on fig 8 the location constraint shown in fig 8 is set to be 10 m this optimization result is shown in table 6 in table 6 cases 1 to 3 are comparisons against the result from moarefdoost et al 2017 case 4 is a comparison with case 3 to show that the solution is optimal even when a larger search range is given items wec2 and wec3 in table 6 refer to the coordinates for the second and the third wec in the array respectively with different wave numbers the optimal solution remains 0 4 5 k for all the cases from case 1 to case 3 the coordinates for wec2 and wec3 remain symmetric and the values of y coordinates are all equal to 4 5 k for different wave numbers q factor from this optimization is smaller than q factors in table 2 because the search step for ga is set to be 1 meter to reduce computation time when calculating q factors with each of the coordinates set to the exact value of 0 4 5 k the q factors are the same as results in table 2 the last column in table 6 is the constraint on x coordinate of both the second and the third wec case 1 to case 3 are optimized with a small searching range of the x coordinate case 4 is given a larger search range and it serves as a comparison to case 3 to show that the solution is globally optimal 5 2 optimization with irregular waves when the input ocean wave is irregular which contains more than one frequency the optimization with ga is computational expansive if exact hydrodynamics is employed due to this limitation only 7 population is used for optimization under irregular wave irregular wave employed bretschneider spectrum with 1 158 m significant wave height and 8 s as peak period results for array of 3 wecs is shown on fig 9 q factor calculated from this setup is 1 77 this layout is not symmetric but we can see that the center buoy was optimized to be more important over the buoys on the side this is the same behavior that has been observed for tests with regular wave 6 conclusion in the present work optimal dimension for each wec in an array has been studied bem solver was used to solve for exact hydrodynamics which supports the optimization of dimension higher q factors were obtained by optimizing dimension with a given optimal layout the array produced an average of 39 21 higher q factor when optimizing with optimal control and 8 87 higher q factor when optimizing with derivative control during the optimization with given optimal layout under regular wave it is found that control method is a critical factor in designing arrays with optimal dimension when optimal control is employed the center buoy of array has most significant impact in array performance and other buoys on the side have smaller impact optimization solution using derivative control implies larger dimension for certain columns in the array table 5 not only this observation indicates the significance of control algorithm on array design but also show that for this type of control the members in the same column will have similar dimensions this can be of critical importance when designing the array with a significant wave direction optimization in section 5 showed that this formulation of problem is able to produce an optimal solution when optimizing both array layout and dimension of buoys when optimizing array layout and dimension of buoys under irregular wave with optimal control the resulting dimension and layout has similar characteristics with optimization solution from regular wave computation time for irregular wave optimization increases significantly when compared with regular wave optimization this study employed bem solver which supports the computation of exact hydrodynamics but computationally however it is not efficient in addition there are numerical errors when computing radiation impedance for an array contains buoys of different dimensions a more computationally efficient hydrodynamic model needs to be employed for optimization with irregular waves also with extreme dimension of buoy like plane plate or tall columns higher energy may be obtained by using different mode other than heave acknowledgment superior a high performance computing cluster at michigan technological university was used in obtaining results presented in this publication 
22362,this paper explores optimal configuration of wave energy converters wecs arrays allowing both dimensions of individual wecs as well as the array layout to vary cylindrical buoys are assumed in the array where their radii and drafts are optimization parameters genetic algorithms are used for optimization three case studies are investigated of different array sizes 3 5 and 7 devices in the array two types of controls are assumed the first is the standard impedance matching control while the second is a derivative control the numerical test cases demonstrate that a higher q factor is achieved when optimizing the buoys dimensions simultaneously with the array layout in the test cases conducted in this paper it is shown that optimizing the array layout can increase the q factor on average by 39 21 when using an optimal control and increase it on average by a factor of 8 87 when using a derivative control keywords wec array wec optimization wave energy converters arrays nomenclature f c control force vector f e x excitation force vector b v array viscous damping matrix k h array hydro static coefficient matrix m array inertia matrix u c optimal velocity vector ω frequency b r i radiation damping element of the i t h buoy b e m boundary element method d i draft height of each buoy f r i radiation force of the i t h buoy h r i radiation kernel of the i t h buoy k wave number k d coefficient of the derivative control force m a i added mass element of the i t h buoy n w e c number of wec in the array o s w c oscillating wave surge converter p i power absorption from an isolated wec p m a x array power absorption using optimal control p p a s s i v e array power absorption using derivative control r i radius of each buoy v i volume of each buoy w e c wave energy converter x i y i plane coordinates of the i t h buoy z i z displacement of the i t h buoy array displacement vector 1 introduction aside from the growing market and industry of ocean wave energy the total theoretical potential from just wave energy is estimated to be 29 5 pwh yr in 2010 which covers more than the entire u s electricity power consumption in 2008 worldenergycouncil 2016 the need for renewable energy the increasing capacity of energy market and the large potential in ocean waves all calls for the development of more efficient design and control of ocean wave energy devices and farms to serve the large electricity production that can be connected to power grid oscillating body type wave energy converters need to be installed in the form of arrays or farms global layout and size of array shape and dimension of each device along with wave profile including wave direction and sea states all have great impact on the array performance fitzgerald and thomas 2007 göteman et al 2015 giassi and göteman 2018 since the early research of budal 1977 thomas and evans 1981 and falnes 1980 optimal layout of an array has been studied for many cases and remains a popular topic in array design layout optimization has been done for both regular and irregular waves to find optimal layout for an array of given size due to the complex nature of hydrodynamic interaction moarefdoost et al 2017 global optimization is required to find the optimal layout that provides constructive interaction similar to fitzgerald s study fitzgerald and thomas 2007 child and venugopal 2010 modified the layout optimization problem and formulates a local optimization the parabolic intersection method child developed is more efficient but less accurate than traditional ga moarefdoost et al 2017 borrowed the idea and further increased calculation speed by using point absorber approximation from budal 1977 rather than using exact hydrodynamics meanwhile layout optimization is conducted by mcguinness with the constrains of device motion mcguinness and thomas 2017 in 2017 tay and venugopal studied the optimal spacing of an oscillating wave surge converter oswc array using a modified genetic algorithm tay and venugopal 2017 the scatter parameter was found to affect the optimal spacing significantly the optimal layout for an oswc array was found to have to let the wave propagate through the array with little reflection time domain simulations of heaving wec arrays were conducted by bozzi et al 2017 the three phase electric power model was employed to calculate the power take off force different array layouts and wave directions were considered in their work in array optimization problems modeling exact hydrodynamic interaction is well recognized to consume the most computational power in the review of park effect in wec arrays babarit 2013 concludes that bem solvers provide the most accurate hydrodynamics with the least speed on the other hand analytical approximation such as point absorber approximation limits the ability to study more complex configuration of arrays thus most of the array layout studies focus on arrays of identical buoys which holds a high level accuracy even with analytical approximation machine learning methods have also been borrowed to search for an optimal layout of flap type wec array sarkar et al 2016 besides the separation distances the sizes and shapes of wec devices are significant factors in designing arrays an earlier study of the compact array has found that the center buoy always has a higher response compared to the other buoys in the array garnaud and mei 2010 the impact from varying separation distance of each device in the array is studied by ringwood and korde 2016 with arrays containing 2 3 and 4 buoys with four arbitrary geometries of the layout a 40 higher q factor was found when control and separation distance were selected properly recently an expanded multiple scattering method is developed by göteman 2017 which assumes cylindrical device while allowing the size of each device to change this study showed an improved array performance with buoys of different dimensions and great potential in designing large wec arrays further the shape of a single submerged absorber plate was optimized by esmaeilzadeh in 2019 using the genetic algorithm esmaeilzadeh and alam 2019 the contour of the planar was parameterized by fourier decomposition of a plane geometry inspired by the above studies ringwood and korde 2016 göteman 2017 this paper explores the optimal configuration of both dimension and layout of arrays of heaving buoys with full interaction and exact hydrodynamics from the numerical bem solver nemoh the optimal layout found under point absorber approximation is employed as initial set up for the array moarefdoost et al 2017 then the dimension of each buoys is optimized with exact hydrodynamics calculated from nemoh the optimization of both dimension and layout is conducted as a validation against previous optimization in section 2 the dynamic model and controls for the wec array is presented optimization problem formulation is presented in section 3 section 4 shows the results with 2 different controllers the impedance matching control reveals theoretical maximum power from the array and the passive control utilizes a more realistic perspective irregular wave optimization results are discussed in section 5 2 wec array dynamic model 2 1 dynamics of wec array the wave energy converter arrays we considered in this work are assumed to contain only cylindrical heaving wecs linear potential flow theory is employed for developing dynamic equation of motion for the array the total force acting on each wec device is expressed with a combination of hydro static buoyancy force and hydrodynamic force with linearity of velocity potential of fluid the incoming dynamic ocean wave can be expressed as summation of incident wave potential diffracted wave potential and radiated wave potential newman 1935 falnes 2002 where incident wave and diffracted wave contribute to what we call wave excitation force and radiated wave results in radiation force the radiation force can be expressed as summation of a force proportional to acceleration and convolution of radiation kernel and velocity zou et al 2017 this work focuses mostly on frequency domain analysis with regular wave as the input to the system 1 f r i m a i x i 0 h i τ τ x i t τ d τ with fourier transformation the convolution can be solved in frequency domain and we can express the radiation force with frequency dependent coefficients 2 f r i ω 2 m a i ω z i j ω b r i ω z i where i denotes each wec in array thus we can write equation of motion for an wec array in the compact matrix form in eq 3 the array dynamic system expressed by eq 3 considers regular wave as the input when the incoming wave becomes irregular frequency is introduced as an additional dimension to all the arrays and matrices only frequency domain analysis is valid with irregular wave inputs 3 ω 2 m m a ω z j ω b v b r ω z k h z f e x f c in eq 3 m and m a ω are the mass and added mass matrices of the array b v and b r ω are the viscous and radiation damping matrices and k h is the hydro static coefficient matrix of the array m b v and k h are the static force coefficient matrices and contain only diagonal elements in the radiation coefficient matrices m a ω and b r ω the hydrodynamic interaction is shown by off diagonal elements 4 m a a r r a y ω m a 11 ω m a 12 ω m a 1 n ω m a 21 ω m a 22 ω m a 23 ω m a 2 n ω m a n 1 ω m a n n ω b r a r r a y ω b r 11 ω b r 12 ω b r 1 n ω b r 21 ω b r 22 ω b r 23 ω b r 2 n ω b r n 1 ω b r n n ω in this paper we neglect the effect of viscous damping hence the only damping matrix left is b r ω vector x is the displacement vector of array f e x and f c are the excitation force and control force vector respectively all hydrodynamic coefficients can be calculated using the numerical bem solver nemoh 2 2 calculation of control force and power to extract energy from the wec array a control algorithm that can provide the proper control force is necessary to obtain the preliminary results from simulation two different control strategies are employed one unconstrained impedance matching control reveals the theoretical optimum power absorption and one passive derivative control produces a control force proportional to the velocity when designing optimal controller for a given wec array devices can either be able to share information and communicate with each other with global control or can access only information and prediction from sensors mounted on themselves with independent control ringwood and korde 2016 bacelli et al 2013 in this work the optimal control refers to the global optimal control considering an isolated oscillating system with only heave motion the dynamic system takes the form of a mass spring damper system and the optimal control optimizes the power calculated from this system the maximum power from a mass spring damper system is obtained when the reactive terms are canceled and the resistive terms are doubled this is also called complex conjugate control song et al 2016 for an array of oscillators the optimal solution is given byfalnes 2002 in the absence of constraints the optimal velocity is given by matching impedance of the physical system falnes 2002 5 u c 1 2 b r ω 1 f e x the optimum power for array is then found to be falnes 2002 6 p m a x 1 8 f e x b r ω 1 f e x note that in eq 6 f e x is the hydrodynamic excitation force coefficient calculated from the bem solver assuming a unity wave input physically both m a ω and b r ω are symmetric since the radiation impedance between any two bodies are the same with the unit velocity it implies that m a i j ω m a j i ω and b r i j ω b r j i ω where i and j are the index for wecs in the array a power calculated from eq 6 is always real but with the bem solver such as nemoh there is a numerical error between m a i j ω and m a j i ω when wecs in the array are no longer identical see fig 1 in the later simulation only half of the hydrodynamic matrix is carried into calculation as a correction to this problem with the optimal control this power can be considered as theoretical maximum absorbed power from the array the second control implemented in this work is passive control with the control force defined to be proportional to the array velocity eq 7 7 f c j ω k d z the coefficient matrix k d has only the diagonal elements of b r ω and the power from array is written as eq 8 the control force needs only the information from the buoy itself but not from the entire array 8 p p a s s i v e j ω i 1 i n f c i z i ω 2 i 1 i n k d i z i 2 it is useful to study the optimization results using both control strategies since we know that impedance matching control will fail in time domain simulation but provide good guidance in theoretical optimum energy while derivative control is easy to implement but the potential in harvesting energy is limited 3 the wec array optimization problem 3 1 optimization of the dimensions of each buoy in the wec array with genetic algorithm in this section the q factor of the array is optimized with the design parameters selected as the radius of each buoy in the array the layout of the array is optimized separately with the equation of q factor simplified with the point absorber approximation moarefdoost et al 2017 with the wave direction of 0 the optimized layouts for arrays that contain three five and seven wecs are solved in the literature moarefdoost et al 2017 and the result is shown in fig 2 once the optimal layout is obtained it will be used for optimization of the dimension of each buoy in the array the variables that define the dimension of the cylindrical buoys are 1 radius of each buoy r 1 r 2 r n 2 draft height of each buoy d 1 d 2 d n here we constrained the design variables by fixing the mass of each device this leads to a constant submerged volume of each buoy the constraint can be written as 9 v i π r i 2 d i c o n s t a n t with the constraint above the design variables are defined as the radius of each buoy r 1 r 2 r n with the draft height of each buoy defined as d i v i π r i 2 the initial volume of each buoy is selected as 1 m 3 the formulation of the optimization is written as 10 m a x d i m e n s i o n l a y o u t q p a r r a y p i s t d i 1 π r i 2 i 1 2 3 r i 0 5 2 m i 1 2 3 3 2 optimization of both dimension and layout of wec array the mathematical formulation of the novel dimension layout optimization for a wec array is presented in this section similar to the optimization in section 3 1 the objective is to maximize the q factor of an wec array the design parameters are selected as both the layout of the array and the dimension of each wec device since the optimal layout of a wec array is symmetric under the point absorber approximation fitzgerald and thomas 2007 another constraint on the location of each wec needs to be considered in this study only optimal control is applied to calculate the power from the array this optimization is done only on the array of three wecs the design variables are the radius of each buoy r 1 r 2 r 3 and the location of each buoy x 1 y 1 x 2 y 2 x 3 y 3 in cartesian coordinate applying the constraint of symmetric layout the location of the first buoy is fixed at the origin the location of the second buoy is on the upper half plain and the location of the third buoy is on the lower half plain the formulation of this optimization is written as 11 m a x d i m e n s i o n l a y o u t q p a r r a y p i s t d i 1 π r i 2 i 1 2 3 r i 0 5 2 m i 1 2 3 x 1 y 1 0 m x 2 x 3 10 10 m y 2 4 5 k 50 4 5 k 50 m y 3 4 5 k 50 4 5 k 50 m where k is the wave number and 0 4 5 k m is the optimal location for the second and the third buoy solved with point absorber approximation from section 3 1 genetic algorithm built in matlab is employed to solve both optimization problems with the settings shown in table 1 at each generation a random binary vector that has the same length as design variable vector will be created the genes of the crossover child will be taken from the first parent if the corresponding element in the crossover vector is 1 the genes will be taken from the second parent if the corresponding element is 0 a random number selected using zero mean gaussian distribution with respect to each element in the parent vector will be added to the parent vector to create mutation in the children 4 numerical results 4 1 simulation setup all simulations are conducted on michigan tech s shared high performance computing cluster the cluster has 32 cpu cores intel xeon e5 2683 2 10 ghz and 256 gb ram the initial wec array layout is shown in fig 2 the initial dimension for all wecs are selected as r 1 m d 1 m the wave number used for comparison is k 0 2 the wave direction is set to β 0 for all simulation hydrodynamics bem solver nemoh is employed to compute the exact hydrodynamics for all simulation moarefdoost et al 2017 presents a case study of an array of 3 wecs that will be investigated further in this paper moarefdoost et al 2017 uses a point absorber approximation assuming all buoys have identical dimensions and show that the q factor remains unchanged if the product of k r is constant here we first use a numerical boundary element method nemoh to validate this conclusion table 2 shows a comparison between the results presented in moarefdoost et al 2017 and the results obtained using nemoh for the same array assuming identical buoys dimensions the product k r 0 2 was kept the same in all the cases the resulting q factor did not change significantly the following sections will highlight the impact of allowing different buoys in the array to have different dimensions on the q factor 4 2 optimization of dimension of each buoy in the wec array with the layout shown in fig 2 and the mathematical formulation in section 3 optimization of the dimension of each wec in the arrays of three five and seven buoys are done with both the optimal control and the passive control optimization results using the optimal control are shown in fig 3 and results using the derivative are shown in fig 4 for the array of three wecs buoy 1 2 3 refer to the buoy on the center the buoy on the top and the buoy on the bottom for the array of five wecs buoy 1 to 5 are the buoy on the center the upper buoy on the 2nd column the lower buoy on the 2nd column the upper buoy on the 3rd column and the lower buoy on the 3rd column respectively for the array of seven wecs buoy 1 is on the center buoy 2 4 6 are the upper buoys on column 1 2 3 and buoy 3 5 7 are the lower buoys on each column as the results in figs 3 and 4 indicate higher q factors are achieved by optimizing the dimension of buoys the average optimized q factor is 39 21 higher using the optimal control and it is 8 87 higher using the derivative control the q factors increase differently in the two presented categories of tests the first batch of tests are ones that use optimal control complex conjugate control this control method is known for providing the maximum possible energy without considering constraints as a result the resulting q factors shown on fig 3 are significantly higher while the buoys oscillate with unrealistic displacement which can be seen from table 3 in table 3 z 3 z 5 and z 7 exceed 2 meters using optimal control which are higher than the wave amplitude of one meter the harvested mean power is also higher for each of the tests these tests are good for showing the maximum possible potential of the array but are not good for realistic considerations the second batch of tests use damping control which also increase the q factors these tests are good for realistic considerations while there exist room for the improvement of the control design with the initial setup arrays using the derivative control do not perform as well as arrays using the optimal control this is because the selected layout is optimized with the point absorber approximation which assumes the optimal control but with optimization of the dimension the q factors for all three arrays are above one it indicates a constructive coupling effect between each buoy in the array fig 4 on fig 5 the red circles are optimized radius of each buoy and the black circles are the initial radius of each buoy for the tests with the optimal control we can see that the center buoys in all three arrays have the largest possible radius and almost all other buoys have the smallest possible radius for the tests with the derivative control the center buoys have the largest radius and the buoys on the third column have the 2nd largest radius to further understand the results detailed dimensions and hydrodynamics have been examined the buoys initial and optimized dimensions are shown in fig 5 and the excitation force coefficients are shown on fig 6 in the test with optimal control the center buoy in all 3 arrays have larger dimensions than the other buoys in array and all buoys on the side are small and thus only experience small excitation force except for top left buoys on fig 5 on the left part of fig 6 buoy 2 has a larger radius than 3 in both array of 5 and 7 wecs which experiences a higher excitation force as shown as blue triangles based on observation above we can separate buoys in the arrays into different groups by their radius then further investigate the effect of hydrodynamic coefficients for each group buoys in group 1 in all tests have radius of 2 m and buoys in group 3 have radius of 0 5 m buoys in group 2 have radius between 1 m and 1 5 m since radiation impedance is affected by dimension and relative distance between each buoy it is useful to observe the radiation impedance of each group and coupled impedance between each group radiation impedance of each group is defined to be z g i and coupled impedance is defined to be z g i j where i and j denotes group number discussion will be focused on radiation damping b r g i and b r g i j which is the real part of the impedance from optimization results with optimal control on fig 7 it is shown that center buoys are optimized to have larger radiation damping on themselves and buoys around them are all optimized to have small radiation damping on themselves we can see that the radiation damping coefficients are grouped together for buoys of the same dimensions on fig 7 all the optimal arrays using the complex conjugate control have one larger buoy at the center with larger radiation impedance and smaller buoys on the side with smaller radiation impedance when optimized using the passive control buoys in the middle group have the same larger size and buoys in other groups have smaller sizes the groups are shown in table 4 besides the radiation acting on each buoys themselves the coupling terms in radiation damping matrices are also presented in table 5 from results in table 5 optimization with derivative control results in larger radiation damping coefficients for entire radiation impedance matrix while results with optimal control focus most on the center buoy in array and diminishes the effect from other buoys 5 discussion 5 1 optimization of both layout and dimension of wecs in the array point absorber approximation is used to calculate and to optimize the layout of array in literature moarefdoost et al 2017 when optimal control is applied the power calculated with exact hydrodynamics is the same as solution from point absorber approximation then it is possible to optimize of both layout and dimension together and when optimal control is employed the solution of layout and dimension should be the same as the solution from section 4 to optimize both layout of array and dimension of buoys additional constraints need to be considered from the results of previous optimization when optimal control is employed the buoy in the center of array has the most significant contribute to the total power extraction so center buoy will be fixed at origin of the domain then with symmetry of layout considered the side buoys are constrained to move only in half of the domain in y direction the new layout constraint for array of 3 wecs is shown on fig 8 the location constraint shown in fig 8 is set to be 10 m this optimization result is shown in table 6 in table 6 cases 1 to 3 are comparisons against the result from moarefdoost et al 2017 case 4 is a comparison with case 3 to show that the solution is optimal even when a larger search range is given items wec2 and wec3 in table 6 refer to the coordinates for the second and the third wec in the array respectively with different wave numbers the optimal solution remains 0 4 5 k for all the cases from case 1 to case 3 the coordinates for wec2 and wec3 remain symmetric and the values of y coordinates are all equal to 4 5 k for different wave numbers q factor from this optimization is smaller than q factors in table 2 because the search step for ga is set to be 1 meter to reduce computation time when calculating q factors with each of the coordinates set to the exact value of 0 4 5 k the q factors are the same as results in table 2 the last column in table 6 is the constraint on x coordinate of both the second and the third wec case 1 to case 3 are optimized with a small searching range of the x coordinate case 4 is given a larger search range and it serves as a comparison to case 3 to show that the solution is globally optimal 5 2 optimization with irregular waves when the input ocean wave is irregular which contains more than one frequency the optimization with ga is computational expansive if exact hydrodynamics is employed due to this limitation only 7 population is used for optimization under irregular wave irregular wave employed bretschneider spectrum with 1 158 m significant wave height and 8 s as peak period results for array of 3 wecs is shown on fig 9 q factor calculated from this setup is 1 77 this layout is not symmetric but we can see that the center buoy was optimized to be more important over the buoys on the side this is the same behavior that has been observed for tests with regular wave 6 conclusion in the present work optimal dimension for each wec in an array has been studied bem solver was used to solve for exact hydrodynamics which supports the optimization of dimension higher q factors were obtained by optimizing dimension with a given optimal layout the array produced an average of 39 21 higher q factor when optimizing with optimal control and 8 87 higher q factor when optimizing with derivative control during the optimization with given optimal layout under regular wave it is found that control method is a critical factor in designing arrays with optimal dimension when optimal control is employed the center buoy of array has most significant impact in array performance and other buoys on the side have smaller impact optimization solution using derivative control implies larger dimension for certain columns in the array table 5 not only this observation indicates the significance of control algorithm on array design but also show that for this type of control the members in the same column will have similar dimensions this can be of critical importance when designing the array with a significant wave direction optimization in section 5 showed that this formulation of problem is able to produce an optimal solution when optimizing both array layout and dimension of buoys when optimizing array layout and dimension of buoys under irregular wave with optimal control the resulting dimension and layout has similar characteristics with optimization solution from regular wave computation time for irregular wave optimization increases significantly when compared with regular wave optimization this study employed bem solver which supports the computation of exact hydrodynamics but computationally however it is not efficient in addition there are numerical errors when computing radiation impedance for an array contains buoys of different dimensions a more computationally efficient hydrodynamic model needs to be employed for optimization with irregular waves also with extreme dimension of buoy like plane plate or tall columns higher energy may be obtained by using different mode other than heave acknowledgment superior a high performance computing cluster at michigan technological university was used in obtaining results presented in this publication 
22363,the main objective of this paper was to examine the influence of forereef bottom slope and the effects of coral degradation on the transformation of wave shapes over a fringing reef flat based on verification from a physical experiment the numerical model funwave 2 0 based on the fully nonlinear boussinesq equations was employed to simulate irregular waves propagating over fringing reefs of different topographies empirical formulae relating wave skewness and asymmetry to local ursell numbers were extended to three dimensions including the effect of forereef slope and roughness of reef surface results demonstrated that the gentle forereef slope will lead to a larger wave asymmetry on a reef flat otherwise wave asymmetry on a smooth reef bed was slightly larger than that on a rough bed indicating that coral degradation may increase wave asymmetry over the reef flat it was found that the different evolution of wave asymmetry on the reef flat could be primarily attributed to the different infragravity wave motions which were induced by different forereef bottom slopes moreover coral degradation would increase the asymmetry of infragravity waves leading to some differences in wave asymmetry on the reef flat however wave skewness from different types of fringing reefs was almost identical implying that the aforementioned factors have a negligible effect on wave skewness keywords wave shape fringing reefs funwave 2 0 model nonlinear wave interaction parameterization infragravity waves 1 introduction fringing coral reefs are widely distributed across most oceanic tropical island rons sheltering many islands from tsunamis and hurricanes roeber et al 2010 generally a typical fringing reef can be divided into three morphological zones a seaward reef face or reef slope which usually has a steep slope an inshore reef flat which has a shallow and rough bottom extending toward the coastal beach and the reef edge which connects the reef face and reef flat to expand and utilise this island resource various coastal structures such as boat access channels weather stations and harbours have been constructed on reef flats coleman 1991 gourlay 1994 as wave action on a reef flat could play a crucial role in determining the design of coastal structures and the formation and stability of shorelines gourlay 1994 hawkins et al 2010 sheremet et al 2011 an understanding of how waves are transformed as they travel across reef flats is needed when ocean waves are propagated over fringing reefs they first shoal on the forereef slope and initially break near the reef edge then they will continuously dissipate energy as they travel the shallow reef flat due to depth limited breaking and reef induced friction in this process wave dynamics and the nonlinear interaction in breaking are mainly controlled by the morphology of the reef profile especially forereef slopes gourlay 1996 vetter et al 2010 yao et al 2012 junliang et al 2017b and the roughness of the reef flat lugo et al 1998 lowe et al 2005 this transformation of wave dynamics has been extensively studied in field and laboratory experiments field experiments by lee and black 1978 showed significant variations in wave shape when waves were propagated over the reef flat breaking waves on forereef slopes were disrupted on reef flats and showed a larger asymmetry gourlay 1994 used a nonlinear parameter f co to classify rmes of wave transformation over reefs based on a laboratory model experimental data showed that wave nonlinearity will decrease as the forereef bottom slope increases young 1989 discussed ocean wave attenuation on coral reefs using data obtained from a field experiment it was found that the reduction in wave height and the broadening of the spectrum are mainly affected by the coral reefs based on laboratory and field data filipot and cheung 2012 showed that wave energy will transfer from the spectral peak to the sub and super harmonics as the wave propagate across the reef based on laboratory and numerical investigation nwogu and demirbilek 2010 pointed out that infragravity wave energy is at a minimum at reef s edge and increases as the waves propagate over the reef flat yao et al 2012 used a one dimensional boussinesq model to simulate wave transformation over various fringing reef profiles and found that the forereef slope and profile shapes have a clear influence on the distribution of the wave height and mean water lever over the fringing reefs ma et al 2014 used the nhwave model to simulate the degenerative process of coral on a reef flat results showed that the infragravity wave energy over the reef flat may greatly increase with the degradation of coral cheriton et al 2016 directly carried out field observations to investigate wave asymmetries on fringing reef flats across a range of offshore tide levels low frequency waves were also found to have a dominant effect on the evolution of wave asymmetries some results obtained by su et al 2015 2018 were extended to investigations of the effect of tidal water level and some other topography of fringing reefs such as bottom friction and forereef slope on wave actions over reef flats using data obtained by a boussinesq equation model funwave tvd more recently yao et al 2018a 2018b conducted laboratory experiments to examine the dynamics of waves over various profiles of fringing reefs effects of some reef morphology factors such as lagoon width forereef slope and reef surface roughness were found to have a clear influence except for the above mentioned endeavours previous works on interactions between waves and fringing reefs have mainly focused on wave transmission and cross spectrum energy transfer hardy and young 1996 lowe et al 2005 sheremet et al 2011 rosman and hench 2011 roeber and cheung 2012 pomeroy et al 2012 van dongeren et al 2013 flow fields gourlay and colleter 2005 monismith 2014 tiao jian et al 2019 scour bein 1976 callaway et al 2009 and structural stability dexter 1973 nelson and lesleighter 1985 roeber et al 2010 relatively limited attention has been paid to wave shape over fringing reefs which has long been of interest to the coastal engineering community in reality when waves are propagating into shallow fringing reefs the wave shape will undergo significant transformation due to shoaling and nonlinear effects making the wave crest sharper and the trough flatter the asymmetric feature of waves is usually described by two parameters i e skewness and asymmetry skewness is a parameter used to measure the lack of symmetry of a wave profile relative to the horizontal axis while the lack of vertical symmetry is known as wave asymmetry elgar and guza 1985 evolution of wave shapes especially wave skewness and asymmetry is closely related to nearshore nutrient delivery and sediment transport of coral sands which thus have a further influence on the formation of coastal topography monismith 2007 ma et al 2017 influenced by the variety of geometries and roughness of the substrate the nonlinear properties of waves over fringing reefs are different from those of waves over normal coastal beaches yao et al 2012 su et al 2015 however knowledge of how these factors influence variations in skewness and asymmetry for waves on fringing reefs is still lacking specific objectives of the present study were to 1 investigate and quantify the transformation of wave skewness and asymmetry over reef flats 2 understand the influence of forereef slope and reef roughness on variations of these wave shape parameters to implement the goals of the present study the funwave 2 0 model kirby et al 2003 based on a set of fully nonlinear boussinesq equations was employed to simulate irregular waves propagating over fringing reefs with different forereef bottom slopes and reef roughnesses following the introduction analysis methods used in the present study will be presented then the numerical model is calibrated and validated against the laboratory measurements smith et al 2012 which were conducted using different forereef bathymetries with smooth and rough bed surfaces then the model is used to simulate irregular waves over different types of fringing reefs and the influence of forereef bottom slope and reef roughness on wave shapes is discussed finally the conclusions are summarised 2 analysis method due to the presence of fringing reefs the shape of waves will undergo significant evolution making the wave crest sharper and the trough flatter the changes of wave shape will in turn influence the nearshore nutrient delivery and the sediment transport of coral sand consequently affect the formation of the coastal topography to better understand the transformation of wave asymmetries mentioned above the wavelet based bispectrum are applied here to reveal the contribution of triad wave interactions to the wave skewness and asymmetry as done by dong et al 2014 for a time series the wavelet based bispectrum b f 1 f 2 can be defined as milligen et al 1995 1 b f 1 f 2 t w t f 1 τ w t f 2 τ w t f 3 τ d τ where the wt f τ denotes the continuous wavelet transform of a time series torrence and compo 1998 while the asterisk represents the complex conjugate f i i 1 2 3 are the triad wave frequencies conventionally satisfying f 3 f 1 f 2 generally the morlet wavelet is chosen as the mother wavelet in wavelet transform to evaluate the degree of triad phase coupling torrence and compo 1998 dong et al 2008 the real part of bispectrum is related to wave skewness elgar and guza 1985 while the imaginary part of the bispectrum is related to wave asymmetry and could also indicate the energy transfer between wave components herbers et al 2000 hasselman et al 1963 and elgar and guza 1985 indicated that the wave skewness s and asymmetry a can be derived through an integral of the real and imaginary part of the bispectrum respectively 2 s r b f 1 f 2 e η t 2 3 2 3 a i b f 1 f 2 e η t 2 3 2 to directly measure the degree of nonlinear phase coupling the normalized magnitude of the wavelet bispectrum was used to define the wavelet bicoherence b 4 b f 1 f 2 b f 1 f 2 t w t f 1 t w t f 2 t d t t w t f t d t the value of bicoherence is between 1 and 1 and represents the relative degree of phase coupling between triads of waves for example b 1 means a full coupling if b0 the energy is transferred from the f 1 and f 2 components to f 3 while if b 0 the energy transfer reverses the case of b 0 indicates random phase relationships and the energy transfer vanishes 3 numerical model 3 1 brief introduction of the model funwave 2 0 the numerical experiments in this research were performed using the well known numerical model funwave 2 0 which is widely applied for coastal researches as an open software tool it was proposed and developed by the research group at center for applied coastal research of university of delaware kirby et al 2003 the governing equations in this model are based on the fully nonlinear boussinesq equations derived by wei et al 1995 with a continuous improvement both in the dispersion and nonlinearity the model could accurately simulate the wave propagation with strong nonlinear interactions hence the validity of funwave model could extends from shallow water ron to intermediate water depth for more suitable for irregularly shaped bottom shi et al 2001 subsequently discretized the equations on the staggered grid in generalized curvilinear coordinates in the version 2 0 of funwave model to generate random waves corresponding to a given spectrum an internal source mechanism was employed sponge layer are placed at the boundaries of the computational domain to effectively absorb the energy of outgoing waves with various frequencies and directions as the present study focus on the performance of waves on three dimensional topography nearshore currents could be generated therefore the version of the model improved by chen et al 2003 is utilized herein chen et al 2003 added a second order vertical vortex term eq 6 in the reference paper in the momentum equation to improve the performance of funwave in simulation of the interactions of multidirectional waves and the nearshore circulation in this model some additional terms such as the mixing coefficient c m the bed friction coefficient c f and breaking coefficient c br are added in the momentum conservation equation to represent the effects of subgrid lateral turbulent mixing bottom friction and wave breaking the typical value ranges of these coefficients are 0 1 0 3 for c m 0 00001 0 001 for c f and 0 35 0 65 for c br respectively the value of these coefficients adopted in simulations is adjusted based on existing physical experiments the detailed description and validation of the numerical model is available in chen et al 2003 and choi et al 2015 in the present study some numerical wave tanks were constructed using funwave waves propagating unidirectionally were generated inside the computational domain by the internal source generation method wei et al 1999 the source function was positioned 10 m away from the left boundary all the lateral computational boundaries was set as totally reflecting vertical walls sponge layers with sufficient width were placed around the boundaries to eliminate the reflected waves 8 m in the x directional boundaries and 6 m in the y directional boundaries in all the simulations of the present study uniform spatial grid sizes δx δy 0 05 m were set and the temporal step was δt 0 01s the exactly same reef topography as physical experiment with impermeable sloping bottoms were arranged in the end of the simulation domains 3 2 model validation for wave transformation over fringing reefs the capability of the boussinesq type model to predict wave transformation over coral fringing reefs was verified extensively in pioneer studies skotner and apelt 1999 nwogu and demirbilek 2010 roeber et al 2010 yao et al 2012 2018a su et al 2015 however prior to use the capability of this model was further verified by physical experiment for irregular waves over fringing reefs in funwave model the bed friction coefficient c f the breaking coefficient c br and the mixing coefficient c m vary in a wide range subjected to different circumstances kirby et al 2003 therefore it is necessary to calibrate these coefficients before the simulation smith et al 2012 has conducted the physical experiments under the surge and wave island modeling studies program swims to investigate the waves shoaling waves breaking and energy dissipation over fringing reefs both in two and three dimensional condition firstly the swims 2d reef experiments were used here for model calibration and validation the 2d experiment was carried out in a two dimensional wave flume located at university of florida the wave flume is 45 7 m long 0 91 m wide and 0 91 m deep two forereef bottoms with the slope of 1 5 and 1 2 5 consisting of a 7 3 m long sloping reef flat are equipped in the wave basin as an idealized fringing reef model two types of reef surfaces which are equally distributed in y direction perpendicular to x direction were installed on the flat ron the surface covered with acrylic grass is the smooth case and the same surface painted with the roughening agent are regarded as the rough cases the experimental results were recorded at twelve wave gauges the locations of the wave gauges are x 4 82 5 13 5 74 8 77 10 19 10 63 11 02 11 35 11 66 12 83 14 68 and 17 73 m from the wave maker irregular waves with different peak period t p and significant wave height h s were generated by the wavemaker based on jonswap spectrum with an averaged peak enhancement factor γ 3 3 the still water depth over the horizontal bottom was set to 0 439 m the sketch layout of the experiment can be seen in fig 1 in numerical simulations the computational domain is exactly the same as the flume in the experiments the simulation time is 10 min 60000 samples and the last 4 min were collected for analysis the numerical results are recorded by 12 wave gauges at the same locations with physical experiment here we chose six cases from smith et al s experiments see table 1 which include different wave conditions and different reef topographies to calibrate the coefficients and further demonstrate the capability of the funwave model for simulating the transformation of waves on fringing reefs when waves are propagated over a fringing reef reef induced drag force plays a crucial role in wave motions in the reef flat ma et al 2014 su et al 2015 as the two conditions of different roughness degree were employed in physical experiment an adjustment of the numerical model was needed to achieve a better simulation nwogu and demirbilek 2010 calibrated the boussinesq model with a physical experiment and found that an adjustment of the model parameter c f denoting bottom friction could improve model accuracy on the reef flat hence to assess the influence of c f on model results a set of model simulations were carried out with different bottom friction coefficients i e 0 0001 0 0005 and 0 001 at the reef flat as there were no coral reefs in the remaining areas of the wave flume the coefficient c f was set to the small value of 0 00001 for the rest of the computational domain to quantify the performance of the model model skill was calculated as gallagher et al 1998 5 s k i l l 1 1 n i 1 n x m e a s i x p r e d i 2 1 n i 1 n x m e a s i where x meas is the measured value from the physical experiment x pred is the predicted value from the simulations and n is the number of total wave gauges used for the fit for a perfect model result the value of the skill would approach 1 while it would approach 0 for an obvious predictive error sensitivity analyses of the parameter c f were carried out first three different values of c f i e 0 0001 0 0005 and 0 001 were selected with other parameters c br and c m were separately fixed to average values c br 0 5 and c m 0 2 fig 2 presents the model data comparisons of cross shore distributions of significant wave height for both the smooth and rough reef surface significant wave height was calculated based on rayleigh wave height distribution h s 4σ η where σ η is the standard deviation of a free surface as can be seen in the laboratory measurements the evolution of significant wave height over the smooth and rough surfaces showed a distinctly different variation indicating that the transformation of waves in the reef flat was sensitive to reef roughness model skill in predicting significant wave heights on smooth and rough beds with three different bottom friction coefficients c f 0 0001 0 0005 and 0 001 are summarised in table 2 from table 2 it can be seen that agreement between the measurements and simulations for rough bed conditions was better with the friction coefficient c f 0 001 otherwise c f 0 0001 produced better agreement with the measurements in smooth bed conditions therefore c f 0 001 and 0 0001 were separately chosen as the model parameters to simulate rough and smooth reef surfaces respectively in the following simulations sensitivity analyses of c br were then implemented fig 3 three different values of c br i e 0 35 0 5 and 0 65 were selected with constant values of c f 0 0001 for smooth bed conditions and 0 001 for rough bed conditions with c m fixed to an average value of 0 2 clearly small values of c br fail to effectively decrease the wave height in surf zone while a large value could provide a more accurate description through comparison of model skill with each simulation set see table 3 it was clear that c br 0 65 gave the best agreement between predicted and measured data lastly sensitivity analyses of c m were carried out fig 4 three different values of c m i e 0 1 0 2 and 0 3 were selected with constant values of c f 0 0001 and 0 001 for smooth and rough bed conditions respectively meanwhile the parameter c br was fixed to the validated value of 0 65 it can be seen that the three different values of c m produced almost identical simulated results and the model skills for each set of simulations table 4 were nearly the same hence the numerical results were not very sensitive to c m through comparison c m 0 3 was determined as it could yield a relatively larger model skill based on the above analyses simulated results for smooth bed conditions obtained with values of c f 0 0001 c br 0 65 and c m 0 3 could provide a more accurate description while for rough bed condition values of c f 0 001 c br 0 65 and c m 0 3 performed well therefore these two sets of model parameters were chosen for the next set of simulations based on the adjusted parameters determined above performance of the model was further validated to assess its performance in describing the nonlinear characteristics and energy distribution for waves in each area fig 5 compared the simulated and measured skewness and asymmetry of the surface elevations for all irregular cases as expected the absolute values for both skewness and asymmetry gradually increased with wave shoaling on the forereef slope bottom and sharply decreased after breaking near reef s edge increasing trends were then recovered as water depth over the reef flat became shallower simulated variations of the wave shape parameters agreed reasonably well with the measurements for all cases in the laboratory measurements it was interesting to find that the cross shore distributions of wave skewness over the smooth and rough reef surfaces were indistinguishable however measured wave asymmetry on the reef flat was distinct whereas magnitude of asymmetry on the smooth bed was slightly greater than that over the rough bed indicating that roughness of the reef bottom may affect wave asymmetry but has little influence on wave skewness similar to the measurements the predicted wave asymmetry over smooth bed conditions c f 0 0001 at the reef flat were slightly larger than over rough bed conditions c f 0 001 at the reef flat and predicted wave skewness showed a nearly identical evolution a possible explanation of this phenomenon will be discussed in the following section in reality reefs are always unevenly distributed over large rons hence the evolution of waves always shows some directional features therefore to serve more practical conclusions three dimensional topographical effects should be considered here the swims 3d reef experiments of waves spread over fringing reefs conducted by smith et al 2012 were used to further verify the capability of the calibrated funwave model for simulating the transformation of random waves on a three dimensional fringing reef flat the 3d experiments were conducted in a 51 8 m long by 29 0 m wide basin located at university of florida the end of basin contained a 14 8 m long by 22 0 m wide compound slope steel platform on which the reef bathymetry was installed the platform was configured into a compound slope that included a forereef slope of 1 4 0 29 m long a 7 31 m reef flat section and a 1 10 foreshore slope 4 8 m long the reef flat section was constructed of molded acrylic to represent reef bathymetry the still water depth of 0 442 m before the slope is used for the experiment with x positive in the onshore direction and y positive alongshore across the reef width the plan layout of the experimental can be seen in fig 6 and the arrangement of the wave gauges are marked in this figure as to assess the three dimensional topography effect wave gauges on the reef flat were placed parallelly along the shoreline further details of the experiments can be found in smith et al 2012 irregular waves with different peak period t p and wave height h rms were generated by the wavemaker at x 0 location based on jonswap spectrum with an averaged peak enhancement factor γ 3 3 in numerical simulations the exact same reef topography used in the physical experiment was arranged at the ends of the simulation domains simulation time was 15 min for irregular waves corresponding to the experimental period to create steady longshore currents here we chose four cases from the experiments of smith et al 2012 see table 5 to demonstrate the simulated result figs 7 and 8 show the comparisons of the energy spectrum and the surface elevations between the measured and predicted results for case 1 in table 5 on smooth conditions at the offshore location gauge 3 d 0 442 m most energy was concentrated on primary waves fig 7a and wave profiles were almost symmetric with respect to both the vertical and horizontal axes fig 8a however as waves transmitted into the forereef slope ron gauge 9 d 0 108 m the transfer of wave energy between primary wave harmonics started fig 7b inducing the wave crests to sharpen more than the troughs fig 8b water depth became even shallower as waves propagated over the reef flat ron and the wave profiles demonstrated clear asymmetry in both the vertical and horizontal axes fig 8c d e which was caused mainly by the intense phase shifting between the bound harmonics and primary waves as can be seen in fig 7c d and f the primary wave showed a clear decrease accompanied by the increase in higher harmonics and lower frequencies wave energy in the higher harmonics decreased from the reef flat to the beach while energy in the lower frequency gradually grew to the dominant wave component as seen in fig 7h moreover the energy spectra measured along the shoreline on the reef flat were also compared to evaluate the performance of the model in three dimensional simulations fig 7e f g agreements between the measured and predicted results showed that the present model can reasonably reproduce the evolution of the wave surface on three dimensional fringing reefs spatial variations in the energy spectrum and surface elevations for waves over rough bed conditions which had similar patterns as the smooth bed conditions are shown in figs 9 and 10 model results still fit the experimental ones including the increases in harmonics and energy dissipation on the reef flat indicating the accuracy of the model in predicting wave transformation on rough bed conditions it should be noted that the energy spectrum on rough beds is smaller than that on smooth beds especially near the beach as can be seen in figs 7h and 9h a possible reason could be attributed to the energy dissipation induced by the different reef surface roughnesses figs 11 14 show comparisons of the cross shore variations of the wave heights for all the test wave cases both on smooth and rough bed conditions generally the simulated and experimental results were in good agreement wave height increase on the forereef bottom due to nonlinear shoaling and decrease by breaking on the reef flat were well predicted the almost identical trends in the height changes indicated the accuracy of the model for the water surface transformation comparisons of the skewness and asymmetry of the surface elevations for all the cases are shown in figs 15 18 as expected absolute values for both the skewness and asymmetry gradually increased as waves shoaled on the forereef bottom and sharply decreased due to breaking occurring on the reef flat it was interesting to note that the magnitude of the departures of the wave skewness in the along shore direction was much sharper than that for asymmetry indicating that the dimensional effect of wave skewness was more significant than that of wave asymmetry this is because skewness is defined as the degree of asymmetry of the waveform with respect to the horizontal axis hence it is more sensitive to non uniform variations in the reef surface however the definition of wave asymmetry is related to the vertical axis hence it is relatively insensitive to the effects of the reef surface the simulation results also predicted well the variations in the two wave shape parameters even in the along shore direction such as at gauge nos 12 and 16 the above discussion indicates that the numerical model can well simulate the nonlinear transformation of irregular waves on a three dimensional fringing reef flat with respect not only to the wave parameters but also to the transferring of wave energy 4 simulations of irregular waves over fringing reefs 4 1 model setup to implement the goal of the present study a series tests were conducted separately in two dimensional and three dimensional numerical wave tanks the computational domain and the reef topography are shown in fig 19 and fig 20 the computational domain of 2d wave tests is 30 m long and 0 6 m wide while the 3d computational domain is 40 m long and 22 m wide irregular waves were generated and propagating along the longitudinal direction of the tank in these model a set of plane forereef slope bottoms were equipped before the reef flat and the reef topography is exactly the same as that in the laboratory experiments in this study a wide range of forereef bottom slope k 1 20 1 10 1 5 1 2 5 were chosen for examining the influence of forereef slope on the wave performance the changes of the roughness of the reef surface are achieved by altering the model parameter c f in the reef flat ron which has been successfully utilized to examine the effects of coral degradation on waves evolution in the reef flat ma et al 2014 to mitigate wave reflection sponge layers of 8 m length were placed at bnning to damp the energy of reflected waves from beach bottom in the simulations 20 cases of random waves based on the averaged jonswap spectra peak enhancement factor γ 3 3 with different t p and h s were simulated the model outputs of wave surface elevations were recorded with a total simulation time of 250s the last 150s were collected for statistical analysis after 1 min of simulation the waves in the computational domain become stable the detailed information of these irregular waves are listed in table 6 to obtain enough number of waves for statistical analysis for each set of wave parameters 15 wave trains with different initial phases were simulated on the whole about 2400 waves are derived for analysis in each wave case 4 2 variations of wave skewness and asymmetry to display the evolution of wave asymmetries on a reef flat wave surface elevation simulations of the numerical case n8 in table 6 at some locations were chosen as typical examples for displaying the effect of forereef slope and reef roughness surface elevations on a reef flat with different forereef bottoms and reef surfaces were given for convenient comparisons at the offshore location d 0 442 m as can be seen in fig 21 a wave shapes were symmetrical with respect to both the horizontal and vertical axes when waves were propagated into the reef flat d 0 058 m with decreasing water depth similar change trends in the wave profiles were observed the wave profiles gradually became asymmetric with respect to both the horizontal and vertical axes with sharper crests and flat troughs however wave profiles that crossed the milder slope 1 20 exhibited more asymmetry than those that crossed the steeper slope 1 2 5 indicating the important role of the forereef bottom in the variation of wave shape additionally through comparison of surface elevations of the waves on reef flats with different roughnesses it was found that the wave asymmetries were clearly enhanced over smooth conditions versus rough conditions this phenomenon could still be observed at the shallower water depth d 0 038 m further proving that the effect of forereef slope and roughness of reef surface could affect the evolution of wave shape over a reef flat fig 22 shows a snapshot of numerical case n8 in table 6 on 2d and 3d fringing reefs with a smooth reef surface and a forereef bottom slope of 1 2 5 as water depth decreased wave profiles demonstrated clear asymmetry relative to the vertical axis especially in the reef flat ron however when waves were propagated on a 3d surface of fringing reefs due to the dimensional effect the wave field was quite different from that on the 2d reef surface distributions of wave profiles along the y axis were not uniform in contrast with those on the 2d reef surface condition hence comparisons of the asymmetries of the wave profiles between 2d and 3d conditions should be carried out through a further quantification ursell number is an optimal parameter for measuring the intensity of wave nonlinearity hence it is usually recommended to parameterise the wave skewness and asymmetry by several authors doering and bowen 1995 peng et al 2009 zou and peng 2011 dong et al 2014 ma et al 2017 peng et al 2009 pointed out that the wave peak period nearly have no change after breaking however the mean period will change obviously considering that the water depth in the reef flat is very shallow and this will induce frequent wave breaking as to take the change of wave period after breaking into consideration the definition of ursell number using local wave mean period is adopted 6 u r h s l m d 3 where l m is the local mean wavelength the average wavelength of all waves measured in this location and could be derived through the linear dispersion relationship using the local mean period t m the average period of all waves measured in this location h s is the local significant wave height and d is the local water depth the variations of the skewness and asymmetry versus local ursell number for the waves over smooth and rough 3d reef surface are shown in fig 24 the results acquired from each slope of forereef bottom are ploted together for comparative purposes it should be noted here that the conclusions of the variations of the skewness and asymmetry on 2d reef surface fig 23 have been reported in our privious research chen et al 2018 as to make comparisions of the results from 2d and 3d surface condition and also for the integrity of the paper the results of 2d reef topography are provided here it can be seen from figs 23 and 24 that the variations of skewness and asymmetry for waves on 3d reef surface have a similar pattern as that on 2d reef surface the skewness is positive and rapid increases with the growth of ursell number in the ron of u r 80 both in the smooth and rough reef surface then the increase slows down and attains a maxmum value about 1 3 in the range of 250 u r 80 in the next range of u r 250 the skewness decays slowly with increasing ursell number meanwhile the difference between wave skewness from different forereef bottom slope could not be detected from visual observation while wave asymmetry fluctuates around zero in the ron of u r 80 both in the smooth and rough reef surface then becomes negative and decays with increasing ursell number however the effect of forereef bottom slope could be clearly seen with the bottom slope becoming steeper the reduction of the asymmetry is moderated when the local ursell number increases based on the similarity of variation to saturation characteristics the relationship between the skewness s and the ursell number u r could be expressed by an exponential law 7 s k s e u r a s b s 2 and the relationship between the asymmetry a and ursell number can be given by a hyperbolic tangent law 8 a k a tanh u r a a b a where k a and b are coefficients to be determined by fitting the numerical results using the least square method detailed information on the coefficients in eqs 7 and 8 for skewness and asymmetry is listed in table 7 as can be seen the coefficients acquired from 3d topography were almost the same as those from 2d conditions for wave asymmetry a the coefficient b a was constant and the coefficient a a was also nearly constant for different forereef slope bottoms on both the rough and smooth beds therefore b a was set to 0 15 and a a 300 for average considerations however the coefficient k a was obviously related to forereef slope as its absolute value increased as the forereef bottom slope slackened furthermore it is interesting to note that the absolute value of coefficient k a for smooth bed conditions was slightly greater than that for rough bed conditions which implied that the evolution of wave asymmetry becomes more dramatic with increasing degradation of the coral reef although roughness of the reef surface could possibly affect wave asymmetry as the quantification of roughness for a reef bed is difficult it is challenging to parameterise this influence in the final empirical formulae therefore the unique formula describing the relationships between k a and k was identified based on an averaging of the data for smooth and rough bed conditions as listed in table 7 9 k a r 0 99 tanh 5 5 k 1 9 as shown in fig 25 eq 9 and the relationships between k a and k on both 2d and 3d topographical conditions were plotted although the absolute value of coefficient k a on a smooth reef bed was slightly greater than that on a rough reef bed they were all within the margin of error of 10 otherwise the k a obtained from the 3d topographic condition was in very close agreement with that in the 2d condition indicating that the proposed formula can give a reasonably accurate estimation of coefficient k a for both 2d and 3d reef topographic conditions therefore the expression of a including the effects of forereef bottom slope on both rough and smooth reef surface conditions can be summarised as follows 10 a 0 99 tanh 5 5 k 1 9 tanh u r 300 0 15 while for wave skewness s there were almost no departures among coefficients k s a s and b s either for different forereef bottom slopes or for different reef surface conditions this indicated that the variation of the forereef slope bottom or the degradation of coral reef did not affect the evolution of wave skewness as a result the empirical formula of wave skewness s as a function of the local ursell number on a reef flat can be written as a uniform equation 11 s 1 16 e u r 250 250 2 correlations between the empirical formulae and simulated data could be adequately described by correlation coefficients r 2 as can be seen in table 8 all of the correlation coefficients r 2 were almost 0 85 which was sufficient to demonstrate that the proposed formulae could accurately depict the evolution of wave shape over a fringing reef flat 4 3 spectral analysis although the effect of reef roughness adopted in this research was not parameterised into the empirical formula its influence on wave asymmetries should still be analysed as it could help in understanding the evolution of wave shape in the more acute process of coral degradation in this section comparisons of bispectrum over different reef flats were conducted aiming to reveal the effect of forereef slope and reef surface roughness on wave asymmetries fig 26 shows the wavelet based bicoherence for a typical case n8 in table 6 over different type of fringing reefs at the offshore location d 0 442 m only interactions within the primary waves are identified it can be clearly seen that both the degrees of real and imaginary part of bicoherence for waves before reef slope are almost identical when waves propagate into the initial reef flat ron d 0 058 m more wave modes are participated in the triad interactions however the value of the imaginary part of bicoherence b i for the gentle reef slope are clearly larger than that from the steeper reef slope for example the values of a primary wave mode b i 0 7 0 7 for waves from 1 2 5 slope on smooth and rough bed are 0 37 and 0 33 separately while the corresponded value of b i for 1 5 slope are 0 46 and 0 35 for 1 10 slope are 0 56 and 0 39 this indicate that the degree of the imaginary part of bicoherence is weakened as the reef slope get steeper as the imaginary part of bicoherence is related to wave asymmetry hence it could well explain the phenomenon of fig 24 where the increase of wave asymmetry will be moderated over the steeper reef slope as waves propagate into the inner reef flat d 0 038 m more wave modes are involved in this coupling process owing to the release of bound higher harmonics in breaking and the influence of reef slope to imaginary part could still been observed in addition the effect of reef bed roughness should also be noticed when waves are on a smooth bed condition the degree of the imaginary part are slightly serious than that on a rough bed condition for example the value of b i 0 7 0 7 for waves from 1 2 5 reef slope on smooth bed is 0 37 but 0 33 for rough bed similar conclusions could also be derived from other reef flat indicating that the degradation of coral reef will induce the enhancement of wave asymmetry as aforementioned the wave asymmetry is related to the nonlinear energy transfer herbers et al 2000 hence a possible explanation is that as more energy is dissipated on the rough reef surface the extent of energy transfer is weakened leading a small wave asymmetry in this process real part of bicoherences at the same water depth over reef flats were almost identical which implied that wave skewness was insensitive to both the change in forereef bottom slope or degradation of the coral reef this could also explain the phenomenon in fig 24 where the variations in wave skewness from different forereef slopes were almost in agreement 4 4 further discussion fig 27 shows detailed comparisons of the measured and simulated energy densities for some typical wave cases case 1 and case 2 in table 1 h s 7 92 cm t p 0 99s from the laboratory observations the growth of spectral densities in the gravity wave bands f 0 5f p on the forereef bottom could be observed however a dramatic decrease in gravity wave energy occurred when waves were at the initial reef flat accompanied by an increase in spectral energy in the infragravity wave band or the low frequency band f 0 5f p as waves propagated on the inner reef flat it could be observed in the measurements that the wave energy gradually transferred to lower frequency waves while energy density in the lower frequency grew to the maximum and became the dominant wave component at the inner flat the model captured well the generation of infragravity wave energy at reef s edge as can be seen in the above figures when waves propagated into the reef flat the infragravity waves gradually became the dominant wave components the crucial role of infragravity waves on the reef flat has been revealed in many studies nwogu and demirbilek 2010 ma et al 2014 su et al 2015 cheriton et al 2016 junliang et al 2017a 2018 hence it is necessary to conduct a further investigation into its influence on the evolution of wave shape to implement this goal the wave spectrum was divided into two frequency bands infragravity wave bands f 0 5f p and gravity wave bands f 0 5f p skewness of the infragravity wave s ig and gravity wave s g was defined as the wave skewness over the infragravity and gravity frequency bands respectively correspondingly asymmetry of the infragravity and gravity waves were defined as a ig and a g fig 28 compares spatial variations of some typical predicted wave skewnesses s with different forereef slopes on smooth reef beds three typical wave cases including a smallest steepness a medium steepness and a largest steepness wave skewness increased during wave shoaling and reached its maximum value near reef s edge on the reef flat wave skewness continually decreased due to wave breaking and energy dissipation induced by the shallower water depth wave skewnesses on the reef flat were nearly identical although they were distinct on the reef slopes where the s on the gentle slope was larger this implied that the wave skewness could be affected in the reef slope ron and that wave skewness on the reef flat will not be affected which is consistent with the conclusion drawn from fig 24 cross shore distributions of wave asymmetry a showed more complicated features as can be seen in fig 29 a b and c wave asymmetry a influenced by forereef slope showed a distinct evolution the absolute value of a on the gentle slope show a smaller value initially but then become larger on the reef flat here we further compared spatial variations in the a ig fig 29a1 b1 and c1 and a g fig 29a2 b2 and c2 overall cross shore distributions of a ig and a g had similar patterns however it was interesting to note that the magnitude of a ig on the reef flat showed a more distinct trend than it did in the forereef slope ron while a ig on a gentle forereef slope increased more sharply on a reef flat distinguishable from a ig the magnitudes of a g on the reef flat were nearly identical however they were distinct on the forereef slope where the a ig on the steeper slope attained a higher value from the spatial variations of a a ig and a g it can be concluded that the difference between wave asymmetry on the reef flat could be primarily attributed to the different infragravity wave motions which were induced by different forereef bottom slopes cross shore evolutions of wave skewness s and asymmetry a for different frequency bands for the same wave cases in table 6 on a rough reef bed are demonstrated in figs 30 and 31 as can be seen in these figures variations in wave skewness and asymmetry in different frequency bands showed similar evolutions as those over smooth bed conditions however when we put these variables for the same wave cases from rough and smooth reef bed conditions together the effect of reef roughness was more clearly seen figs 32 and 33 show cross shore variations of wave skewness s and asymmetry a in different frequency bands for selected wave case 10 in table 6 on smooth and rough reef bed conditions separately from fig 32 it is seen that the magnitudes of s on both smooth and rough reef beds were almost identical further indicating that the evolution of wave skewness was not influenced by coral degradation however the effect of reef roughness on wave asymmetry seemed more apparent as can be seen in fig 33 a d the magnitudes of a on the smooth reef bed were clearly greater than those on the rough bed condition which was in accordance with the findings in fig 24 as the spatial variations in infragravity wave band a ig and gravity wave band a g were plotted further clarifications were offered in the subplots seen in fig 33 a1 d1 and a2 d2 in the gravity wave band the evolutions of a g for both smooth and rough bed conditions were almost identical however the variation in infragravity wave band a ig on the reef flat was critically dependent upon the roughness of the reef bed magnitudes of a ig on smooth reef beds were greater than those on the rough bed condition similar to those observed in fig 33 a d which shows the variations in asymmetry over all frequency bands on the reef flat therefore it can be concluded that the coral degradation increased the asymmetry of the infragravity waves which led to an occurrence of increase for wave asymmetry on the reef flat 5 conclusions in this paper the fully nonlinear numerical model funwave 2 0 was employed to investigate the evolution of asymmetries of wave surface elevations over fringing reef flats before application the numerical model was calibrated using several sets of laboratory data model sensitivity analysis showed that selection of the proper bottom friction coefficient improved model performance numerical results based on the chosen model parameters showed that the model could well simulate wave transformation wave breaking wave spectrum distribution as well as infragravity waves over coral reefs the model was then utilized to examine the effects of forereef bottom slope and coral degradation on the transformation of waves over fringing reef flat and the following conclusions can be drawn 1 it was found that the forereef slope has a significant influence on the transformation of wave asymmetry on a reef flat and a gentle slope will lead to greater asymmetry however the forereef slope effect on wave skewness is almost negligible with the same slope of forereef bottom wave asymmetry on smooth reef bed conditions is slightly greater than that on rough bed conditions indicating that with degradation of the coral reef the evolution of wave asymmetry becomes more dramatic some empirical formulae regarding these parameters as a function of the local ursell number are derived 2 although the wave field on a 3d surface of fringing reefs seems different from that on a 2d reef surface evolutions of wave asymmetries are almost identical the proposed formula can give a reasonably accurate estimation for both 2d and 3d reef topographical conditions 3 the wavelet based bicoherence spectra revealed that as the forereef slope becomes steeper the degree of the imaginary part of the bicoherence is weakened and the involved wave modes are clearly smaller furthermore degradation of the coral reef will induce a slight enhancement of the degree of the imaginary part leading to a more evident degree of wave asymmetry however the real parts of bicoherence at the same water depth over the reef flat are almost identical which proves again that wave skewness is insensitive to both the change of forereef bottom slope and degradation of the coral reef 4 it was found that the different evolution of wave asymmetry on the reef flat could be primarily attributed to the different infragravity wave motions which is induced by different forereef bottom slopes in addition coral degradation increases the asymmetry of infragravity waves and this will lead to an occurrence of increase for wave asymmetry on a reef flat finally it should be emphasized here that the natural reefs are more complex than physical or numerical model in this study we only focus on the variation of forereef slope and the degradation of coral reef hence these conclusions are only valid for the given type of fringing reefs acknowledgments this work was financially supported by the national natural science foundation of china grant no 51809039 the open fund of state key laboratory of coastal and offshore engineering grant nos lp1702 and lp1718 and the science foundation from the education department of china jilin province grant nos jjkh20180452kj and jjkh20180451kj 
22363,the main objective of this paper was to examine the influence of forereef bottom slope and the effects of coral degradation on the transformation of wave shapes over a fringing reef flat based on verification from a physical experiment the numerical model funwave 2 0 based on the fully nonlinear boussinesq equations was employed to simulate irregular waves propagating over fringing reefs of different topographies empirical formulae relating wave skewness and asymmetry to local ursell numbers were extended to three dimensions including the effect of forereef slope and roughness of reef surface results demonstrated that the gentle forereef slope will lead to a larger wave asymmetry on a reef flat otherwise wave asymmetry on a smooth reef bed was slightly larger than that on a rough bed indicating that coral degradation may increase wave asymmetry over the reef flat it was found that the different evolution of wave asymmetry on the reef flat could be primarily attributed to the different infragravity wave motions which were induced by different forereef bottom slopes moreover coral degradation would increase the asymmetry of infragravity waves leading to some differences in wave asymmetry on the reef flat however wave skewness from different types of fringing reefs was almost identical implying that the aforementioned factors have a negligible effect on wave skewness keywords wave shape fringing reefs funwave 2 0 model nonlinear wave interaction parameterization infragravity waves 1 introduction fringing coral reefs are widely distributed across most oceanic tropical island rons sheltering many islands from tsunamis and hurricanes roeber et al 2010 generally a typical fringing reef can be divided into three morphological zones a seaward reef face or reef slope which usually has a steep slope an inshore reef flat which has a shallow and rough bottom extending toward the coastal beach and the reef edge which connects the reef face and reef flat to expand and utilise this island resource various coastal structures such as boat access channels weather stations and harbours have been constructed on reef flats coleman 1991 gourlay 1994 as wave action on a reef flat could play a crucial role in determining the design of coastal structures and the formation and stability of shorelines gourlay 1994 hawkins et al 2010 sheremet et al 2011 an understanding of how waves are transformed as they travel across reef flats is needed when ocean waves are propagated over fringing reefs they first shoal on the forereef slope and initially break near the reef edge then they will continuously dissipate energy as they travel the shallow reef flat due to depth limited breaking and reef induced friction in this process wave dynamics and the nonlinear interaction in breaking are mainly controlled by the morphology of the reef profile especially forereef slopes gourlay 1996 vetter et al 2010 yao et al 2012 junliang et al 2017b and the roughness of the reef flat lugo et al 1998 lowe et al 2005 this transformation of wave dynamics has been extensively studied in field and laboratory experiments field experiments by lee and black 1978 showed significant variations in wave shape when waves were propagated over the reef flat breaking waves on forereef slopes were disrupted on reef flats and showed a larger asymmetry gourlay 1994 used a nonlinear parameter f co to classify rmes of wave transformation over reefs based on a laboratory model experimental data showed that wave nonlinearity will decrease as the forereef bottom slope increases young 1989 discussed ocean wave attenuation on coral reefs using data obtained from a field experiment it was found that the reduction in wave height and the broadening of the spectrum are mainly affected by the coral reefs based on laboratory and field data filipot and cheung 2012 showed that wave energy will transfer from the spectral peak to the sub and super harmonics as the wave propagate across the reef based on laboratory and numerical investigation nwogu and demirbilek 2010 pointed out that infragravity wave energy is at a minimum at reef s edge and increases as the waves propagate over the reef flat yao et al 2012 used a one dimensional boussinesq model to simulate wave transformation over various fringing reef profiles and found that the forereef slope and profile shapes have a clear influence on the distribution of the wave height and mean water lever over the fringing reefs ma et al 2014 used the nhwave model to simulate the degenerative process of coral on a reef flat results showed that the infragravity wave energy over the reef flat may greatly increase with the degradation of coral cheriton et al 2016 directly carried out field observations to investigate wave asymmetries on fringing reef flats across a range of offshore tide levels low frequency waves were also found to have a dominant effect on the evolution of wave asymmetries some results obtained by su et al 2015 2018 were extended to investigations of the effect of tidal water level and some other topography of fringing reefs such as bottom friction and forereef slope on wave actions over reef flats using data obtained by a boussinesq equation model funwave tvd more recently yao et al 2018a 2018b conducted laboratory experiments to examine the dynamics of waves over various profiles of fringing reefs effects of some reef morphology factors such as lagoon width forereef slope and reef surface roughness were found to have a clear influence except for the above mentioned endeavours previous works on interactions between waves and fringing reefs have mainly focused on wave transmission and cross spectrum energy transfer hardy and young 1996 lowe et al 2005 sheremet et al 2011 rosman and hench 2011 roeber and cheung 2012 pomeroy et al 2012 van dongeren et al 2013 flow fields gourlay and colleter 2005 monismith 2014 tiao jian et al 2019 scour bein 1976 callaway et al 2009 and structural stability dexter 1973 nelson and lesleighter 1985 roeber et al 2010 relatively limited attention has been paid to wave shape over fringing reefs which has long been of interest to the coastal engineering community in reality when waves are propagating into shallow fringing reefs the wave shape will undergo significant transformation due to shoaling and nonlinear effects making the wave crest sharper and the trough flatter the asymmetric feature of waves is usually described by two parameters i e skewness and asymmetry skewness is a parameter used to measure the lack of symmetry of a wave profile relative to the horizontal axis while the lack of vertical symmetry is known as wave asymmetry elgar and guza 1985 evolution of wave shapes especially wave skewness and asymmetry is closely related to nearshore nutrient delivery and sediment transport of coral sands which thus have a further influence on the formation of coastal topography monismith 2007 ma et al 2017 influenced by the variety of geometries and roughness of the substrate the nonlinear properties of waves over fringing reefs are different from those of waves over normal coastal beaches yao et al 2012 su et al 2015 however knowledge of how these factors influence variations in skewness and asymmetry for waves on fringing reefs is still lacking specific objectives of the present study were to 1 investigate and quantify the transformation of wave skewness and asymmetry over reef flats 2 understand the influence of forereef slope and reef roughness on variations of these wave shape parameters to implement the goals of the present study the funwave 2 0 model kirby et al 2003 based on a set of fully nonlinear boussinesq equations was employed to simulate irregular waves propagating over fringing reefs with different forereef bottom slopes and reef roughnesses following the introduction analysis methods used in the present study will be presented then the numerical model is calibrated and validated against the laboratory measurements smith et al 2012 which were conducted using different forereef bathymetries with smooth and rough bed surfaces then the model is used to simulate irregular waves over different types of fringing reefs and the influence of forereef bottom slope and reef roughness on wave shapes is discussed finally the conclusions are summarised 2 analysis method due to the presence of fringing reefs the shape of waves will undergo significant evolution making the wave crest sharper and the trough flatter the changes of wave shape will in turn influence the nearshore nutrient delivery and the sediment transport of coral sand consequently affect the formation of the coastal topography to better understand the transformation of wave asymmetries mentioned above the wavelet based bispectrum are applied here to reveal the contribution of triad wave interactions to the wave skewness and asymmetry as done by dong et al 2014 for a time series the wavelet based bispectrum b f 1 f 2 can be defined as milligen et al 1995 1 b f 1 f 2 t w t f 1 τ w t f 2 τ w t f 3 τ d τ where the wt f τ denotes the continuous wavelet transform of a time series torrence and compo 1998 while the asterisk represents the complex conjugate f i i 1 2 3 are the triad wave frequencies conventionally satisfying f 3 f 1 f 2 generally the morlet wavelet is chosen as the mother wavelet in wavelet transform to evaluate the degree of triad phase coupling torrence and compo 1998 dong et al 2008 the real part of bispectrum is related to wave skewness elgar and guza 1985 while the imaginary part of the bispectrum is related to wave asymmetry and could also indicate the energy transfer between wave components herbers et al 2000 hasselman et al 1963 and elgar and guza 1985 indicated that the wave skewness s and asymmetry a can be derived through an integral of the real and imaginary part of the bispectrum respectively 2 s r b f 1 f 2 e η t 2 3 2 3 a i b f 1 f 2 e η t 2 3 2 to directly measure the degree of nonlinear phase coupling the normalized magnitude of the wavelet bispectrum was used to define the wavelet bicoherence b 4 b f 1 f 2 b f 1 f 2 t w t f 1 t w t f 2 t d t t w t f t d t the value of bicoherence is between 1 and 1 and represents the relative degree of phase coupling between triads of waves for example b 1 means a full coupling if b0 the energy is transferred from the f 1 and f 2 components to f 3 while if b 0 the energy transfer reverses the case of b 0 indicates random phase relationships and the energy transfer vanishes 3 numerical model 3 1 brief introduction of the model funwave 2 0 the numerical experiments in this research were performed using the well known numerical model funwave 2 0 which is widely applied for coastal researches as an open software tool it was proposed and developed by the research group at center for applied coastal research of university of delaware kirby et al 2003 the governing equations in this model are based on the fully nonlinear boussinesq equations derived by wei et al 1995 with a continuous improvement both in the dispersion and nonlinearity the model could accurately simulate the wave propagation with strong nonlinear interactions hence the validity of funwave model could extends from shallow water ron to intermediate water depth for more suitable for irregularly shaped bottom shi et al 2001 subsequently discretized the equations on the staggered grid in generalized curvilinear coordinates in the version 2 0 of funwave model to generate random waves corresponding to a given spectrum an internal source mechanism was employed sponge layer are placed at the boundaries of the computational domain to effectively absorb the energy of outgoing waves with various frequencies and directions as the present study focus on the performance of waves on three dimensional topography nearshore currents could be generated therefore the version of the model improved by chen et al 2003 is utilized herein chen et al 2003 added a second order vertical vortex term eq 6 in the reference paper in the momentum equation to improve the performance of funwave in simulation of the interactions of multidirectional waves and the nearshore circulation in this model some additional terms such as the mixing coefficient c m the bed friction coefficient c f and breaking coefficient c br are added in the momentum conservation equation to represent the effects of subgrid lateral turbulent mixing bottom friction and wave breaking the typical value ranges of these coefficients are 0 1 0 3 for c m 0 00001 0 001 for c f and 0 35 0 65 for c br respectively the value of these coefficients adopted in simulations is adjusted based on existing physical experiments the detailed description and validation of the numerical model is available in chen et al 2003 and choi et al 2015 in the present study some numerical wave tanks were constructed using funwave waves propagating unidirectionally were generated inside the computational domain by the internal source generation method wei et al 1999 the source function was positioned 10 m away from the left boundary all the lateral computational boundaries was set as totally reflecting vertical walls sponge layers with sufficient width were placed around the boundaries to eliminate the reflected waves 8 m in the x directional boundaries and 6 m in the y directional boundaries in all the simulations of the present study uniform spatial grid sizes δx δy 0 05 m were set and the temporal step was δt 0 01s the exactly same reef topography as physical experiment with impermeable sloping bottoms were arranged in the end of the simulation domains 3 2 model validation for wave transformation over fringing reefs the capability of the boussinesq type model to predict wave transformation over coral fringing reefs was verified extensively in pioneer studies skotner and apelt 1999 nwogu and demirbilek 2010 roeber et al 2010 yao et al 2012 2018a su et al 2015 however prior to use the capability of this model was further verified by physical experiment for irregular waves over fringing reefs in funwave model the bed friction coefficient c f the breaking coefficient c br and the mixing coefficient c m vary in a wide range subjected to different circumstances kirby et al 2003 therefore it is necessary to calibrate these coefficients before the simulation smith et al 2012 has conducted the physical experiments under the surge and wave island modeling studies program swims to investigate the waves shoaling waves breaking and energy dissipation over fringing reefs both in two and three dimensional condition firstly the swims 2d reef experiments were used here for model calibration and validation the 2d experiment was carried out in a two dimensional wave flume located at university of florida the wave flume is 45 7 m long 0 91 m wide and 0 91 m deep two forereef bottoms with the slope of 1 5 and 1 2 5 consisting of a 7 3 m long sloping reef flat are equipped in the wave basin as an idealized fringing reef model two types of reef surfaces which are equally distributed in y direction perpendicular to x direction were installed on the flat ron the surface covered with acrylic grass is the smooth case and the same surface painted with the roughening agent are regarded as the rough cases the experimental results were recorded at twelve wave gauges the locations of the wave gauges are x 4 82 5 13 5 74 8 77 10 19 10 63 11 02 11 35 11 66 12 83 14 68 and 17 73 m from the wave maker irregular waves with different peak period t p and significant wave height h s were generated by the wavemaker based on jonswap spectrum with an averaged peak enhancement factor γ 3 3 the still water depth over the horizontal bottom was set to 0 439 m the sketch layout of the experiment can be seen in fig 1 in numerical simulations the computational domain is exactly the same as the flume in the experiments the simulation time is 10 min 60000 samples and the last 4 min were collected for analysis the numerical results are recorded by 12 wave gauges at the same locations with physical experiment here we chose six cases from smith et al s experiments see table 1 which include different wave conditions and different reef topographies to calibrate the coefficients and further demonstrate the capability of the funwave model for simulating the transformation of waves on fringing reefs when waves are propagated over a fringing reef reef induced drag force plays a crucial role in wave motions in the reef flat ma et al 2014 su et al 2015 as the two conditions of different roughness degree were employed in physical experiment an adjustment of the numerical model was needed to achieve a better simulation nwogu and demirbilek 2010 calibrated the boussinesq model with a physical experiment and found that an adjustment of the model parameter c f denoting bottom friction could improve model accuracy on the reef flat hence to assess the influence of c f on model results a set of model simulations were carried out with different bottom friction coefficients i e 0 0001 0 0005 and 0 001 at the reef flat as there were no coral reefs in the remaining areas of the wave flume the coefficient c f was set to the small value of 0 00001 for the rest of the computational domain to quantify the performance of the model model skill was calculated as gallagher et al 1998 5 s k i l l 1 1 n i 1 n x m e a s i x p r e d i 2 1 n i 1 n x m e a s i where x meas is the measured value from the physical experiment x pred is the predicted value from the simulations and n is the number of total wave gauges used for the fit for a perfect model result the value of the skill would approach 1 while it would approach 0 for an obvious predictive error sensitivity analyses of the parameter c f were carried out first three different values of c f i e 0 0001 0 0005 and 0 001 were selected with other parameters c br and c m were separately fixed to average values c br 0 5 and c m 0 2 fig 2 presents the model data comparisons of cross shore distributions of significant wave height for both the smooth and rough reef surface significant wave height was calculated based on rayleigh wave height distribution h s 4σ η where σ η is the standard deviation of a free surface as can be seen in the laboratory measurements the evolution of significant wave height over the smooth and rough surfaces showed a distinctly different variation indicating that the transformation of waves in the reef flat was sensitive to reef roughness model skill in predicting significant wave heights on smooth and rough beds with three different bottom friction coefficients c f 0 0001 0 0005 and 0 001 are summarised in table 2 from table 2 it can be seen that agreement between the measurements and simulations for rough bed conditions was better with the friction coefficient c f 0 001 otherwise c f 0 0001 produced better agreement with the measurements in smooth bed conditions therefore c f 0 001 and 0 0001 were separately chosen as the model parameters to simulate rough and smooth reef surfaces respectively in the following simulations sensitivity analyses of c br were then implemented fig 3 three different values of c br i e 0 35 0 5 and 0 65 were selected with constant values of c f 0 0001 for smooth bed conditions and 0 001 for rough bed conditions with c m fixed to an average value of 0 2 clearly small values of c br fail to effectively decrease the wave height in surf zone while a large value could provide a more accurate description through comparison of model skill with each simulation set see table 3 it was clear that c br 0 65 gave the best agreement between predicted and measured data lastly sensitivity analyses of c m were carried out fig 4 three different values of c m i e 0 1 0 2 and 0 3 were selected with constant values of c f 0 0001 and 0 001 for smooth and rough bed conditions respectively meanwhile the parameter c br was fixed to the validated value of 0 65 it can be seen that the three different values of c m produced almost identical simulated results and the model skills for each set of simulations table 4 were nearly the same hence the numerical results were not very sensitive to c m through comparison c m 0 3 was determined as it could yield a relatively larger model skill based on the above analyses simulated results for smooth bed conditions obtained with values of c f 0 0001 c br 0 65 and c m 0 3 could provide a more accurate description while for rough bed condition values of c f 0 001 c br 0 65 and c m 0 3 performed well therefore these two sets of model parameters were chosen for the next set of simulations based on the adjusted parameters determined above performance of the model was further validated to assess its performance in describing the nonlinear characteristics and energy distribution for waves in each area fig 5 compared the simulated and measured skewness and asymmetry of the surface elevations for all irregular cases as expected the absolute values for both skewness and asymmetry gradually increased with wave shoaling on the forereef slope bottom and sharply decreased after breaking near reef s edge increasing trends were then recovered as water depth over the reef flat became shallower simulated variations of the wave shape parameters agreed reasonably well with the measurements for all cases in the laboratory measurements it was interesting to find that the cross shore distributions of wave skewness over the smooth and rough reef surfaces were indistinguishable however measured wave asymmetry on the reef flat was distinct whereas magnitude of asymmetry on the smooth bed was slightly greater than that over the rough bed indicating that roughness of the reef bottom may affect wave asymmetry but has little influence on wave skewness similar to the measurements the predicted wave asymmetry over smooth bed conditions c f 0 0001 at the reef flat were slightly larger than over rough bed conditions c f 0 001 at the reef flat and predicted wave skewness showed a nearly identical evolution a possible explanation of this phenomenon will be discussed in the following section in reality reefs are always unevenly distributed over large rons hence the evolution of waves always shows some directional features therefore to serve more practical conclusions three dimensional topographical effects should be considered here the swims 3d reef experiments of waves spread over fringing reefs conducted by smith et al 2012 were used to further verify the capability of the calibrated funwave model for simulating the transformation of random waves on a three dimensional fringing reef flat the 3d experiments were conducted in a 51 8 m long by 29 0 m wide basin located at university of florida the end of basin contained a 14 8 m long by 22 0 m wide compound slope steel platform on which the reef bathymetry was installed the platform was configured into a compound slope that included a forereef slope of 1 4 0 29 m long a 7 31 m reef flat section and a 1 10 foreshore slope 4 8 m long the reef flat section was constructed of molded acrylic to represent reef bathymetry the still water depth of 0 442 m before the slope is used for the experiment with x positive in the onshore direction and y positive alongshore across the reef width the plan layout of the experimental can be seen in fig 6 and the arrangement of the wave gauges are marked in this figure as to assess the three dimensional topography effect wave gauges on the reef flat were placed parallelly along the shoreline further details of the experiments can be found in smith et al 2012 irregular waves with different peak period t p and wave height h rms were generated by the wavemaker at x 0 location based on jonswap spectrum with an averaged peak enhancement factor γ 3 3 in numerical simulations the exact same reef topography used in the physical experiment was arranged at the ends of the simulation domains simulation time was 15 min for irregular waves corresponding to the experimental period to create steady longshore currents here we chose four cases from the experiments of smith et al 2012 see table 5 to demonstrate the simulated result figs 7 and 8 show the comparisons of the energy spectrum and the surface elevations between the measured and predicted results for case 1 in table 5 on smooth conditions at the offshore location gauge 3 d 0 442 m most energy was concentrated on primary waves fig 7a and wave profiles were almost symmetric with respect to both the vertical and horizontal axes fig 8a however as waves transmitted into the forereef slope ron gauge 9 d 0 108 m the transfer of wave energy between primary wave harmonics started fig 7b inducing the wave crests to sharpen more than the troughs fig 8b water depth became even shallower as waves propagated over the reef flat ron and the wave profiles demonstrated clear asymmetry in both the vertical and horizontal axes fig 8c d e which was caused mainly by the intense phase shifting between the bound harmonics and primary waves as can be seen in fig 7c d and f the primary wave showed a clear decrease accompanied by the increase in higher harmonics and lower frequencies wave energy in the higher harmonics decreased from the reef flat to the beach while energy in the lower frequency gradually grew to the dominant wave component as seen in fig 7h moreover the energy spectra measured along the shoreline on the reef flat were also compared to evaluate the performance of the model in three dimensional simulations fig 7e f g agreements between the measured and predicted results showed that the present model can reasonably reproduce the evolution of the wave surface on three dimensional fringing reefs spatial variations in the energy spectrum and surface elevations for waves over rough bed conditions which had similar patterns as the smooth bed conditions are shown in figs 9 and 10 model results still fit the experimental ones including the increases in harmonics and energy dissipation on the reef flat indicating the accuracy of the model in predicting wave transformation on rough bed conditions it should be noted that the energy spectrum on rough beds is smaller than that on smooth beds especially near the beach as can be seen in figs 7h and 9h a possible reason could be attributed to the energy dissipation induced by the different reef surface roughnesses figs 11 14 show comparisons of the cross shore variations of the wave heights for all the test wave cases both on smooth and rough bed conditions generally the simulated and experimental results were in good agreement wave height increase on the forereef bottom due to nonlinear shoaling and decrease by breaking on the reef flat were well predicted the almost identical trends in the height changes indicated the accuracy of the model for the water surface transformation comparisons of the skewness and asymmetry of the surface elevations for all the cases are shown in figs 15 18 as expected absolute values for both the skewness and asymmetry gradually increased as waves shoaled on the forereef bottom and sharply decreased due to breaking occurring on the reef flat it was interesting to note that the magnitude of the departures of the wave skewness in the along shore direction was much sharper than that for asymmetry indicating that the dimensional effect of wave skewness was more significant than that of wave asymmetry this is because skewness is defined as the degree of asymmetry of the waveform with respect to the horizontal axis hence it is more sensitive to non uniform variations in the reef surface however the definition of wave asymmetry is related to the vertical axis hence it is relatively insensitive to the effects of the reef surface the simulation results also predicted well the variations in the two wave shape parameters even in the along shore direction such as at gauge nos 12 and 16 the above discussion indicates that the numerical model can well simulate the nonlinear transformation of irregular waves on a three dimensional fringing reef flat with respect not only to the wave parameters but also to the transferring of wave energy 4 simulations of irregular waves over fringing reefs 4 1 model setup to implement the goal of the present study a series tests were conducted separately in two dimensional and three dimensional numerical wave tanks the computational domain and the reef topography are shown in fig 19 and fig 20 the computational domain of 2d wave tests is 30 m long and 0 6 m wide while the 3d computational domain is 40 m long and 22 m wide irregular waves were generated and propagating along the longitudinal direction of the tank in these model a set of plane forereef slope bottoms were equipped before the reef flat and the reef topography is exactly the same as that in the laboratory experiments in this study a wide range of forereef bottom slope k 1 20 1 10 1 5 1 2 5 were chosen for examining the influence of forereef slope on the wave performance the changes of the roughness of the reef surface are achieved by altering the model parameter c f in the reef flat ron which has been successfully utilized to examine the effects of coral degradation on waves evolution in the reef flat ma et al 2014 to mitigate wave reflection sponge layers of 8 m length were placed at bnning to damp the energy of reflected waves from beach bottom in the simulations 20 cases of random waves based on the averaged jonswap spectra peak enhancement factor γ 3 3 with different t p and h s were simulated the model outputs of wave surface elevations were recorded with a total simulation time of 250s the last 150s were collected for statistical analysis after 1 min of simulation the waves in the computational domain become stable the detailed information of these irregular waves are listed in table 6 to obtain enough number of waves for statistical analysis for each set of wave parameters 15 wave trains with different initial phases were simulated on the whole about 2400 waves are derived for analysis in each wave case 4 2 variations of wave skewness and asymmetry to display the evolution of wave asymmetries on a reef flat wave surface elevation simulations of the numerical case n8 in table 6 at some locations were chosen as typical examples for displaying the effect of forereef slope and reef roughness surface elevations on a reef flat with different forereef bottoms and reef surfaces were given for convenient comparisons at the offshore location d 0 442 m as can be seen in fig 21 a wave shapes were symmetrical with respect to both the horizontal and vertical axes when waves were propagated into the reef flat d 0 058 m with decreasing water depth similar change trends in the wave profiles were observed the wave profiles gradually became asymmetric with respect to both the horizontal and vertical axes with sharper crests and flat troughs however wave profiles that crossed the milder slope 1 20 exhibited more asymmetry than those that crossed the steeper slope 1 2 5 indicating the important role of the forereef bottom in the variation of wave shape additionally through comparison of surface elevations of the waves on reef flats with different roughnesses it was found that the wave asymmetries were clearly enhanced over smooth conditions versus rough conditions this phenomenon could still be observed at the shallower water depth d 0 038 m further proving that the effect of forereef slope and roughness of reef surface could affect the evolution of wave shape over a reef flat fig 22 shows a snapshot of numerical case n8 in table 6 on 2d and 3d fringing reefs with a smooth reef surface and a forereef bottom slope of 1 2 5 as water depth decreased wave profiles demonstrated clear asymmetry relative to the vertical axis especially in the reef flat ron however when waves were propagated on a 3d surface of fringing reefs due to the dimensional effect the wave field was quite different from that on the 2d reef surface distributions of wave profiles along the y axis were not uniform in contrast with those on the 2d reef surface condition hence comparisons of the asymmetries of the wave profiles between 2d and 3d conditions should be carried out through a further quantification ursell number is an optimal parameter for measuring the intensity of wave nonlinearity hence it is usually recommended to parameterise the wave skewness and asymmetry by several authors doering and bowen 1995 peng et al 2009 zou and peng 2011 dong et al 2014 ma et al 2017 peng et al 2009 pointed out that the wave peak period nearly have no change after breaking however the mean period will change obviously considering that the water depth in the reef flat is very shallow and this will induce frequent wave breaking as to take the change of wave period after breaking into consideration the definition of ursell number using local wave mean period is adopted 6 u r h s l m d 3 where l m is the local mean wavelength the average wavelength of all waves measured in this location and could be derived through the linear dispersion relationship using the local mean period t m the average period of all waves measured in this location h s is the local significant wave height and d is the local water depth the variations of the skewness and asymmetry versus local ursell number for the waves over smooth and rough 3d reef surface are shown in fig 24 the results acquired from each slope of forereef bottom are ploted together for comparative purposes it should be noted here that the conclusions of the variations of the skewness and asymmetry on 2d reef surface fig 23 have been reported in our privious research chen et al 2018 as to make comparisions of the results from 2d and 3d surface condition and also for the integrity of the paper the results of 2d reef topography are provided here it can be seen from figs 23 and 24 that the variations of skewness and asymmetry for waves on 3d reef surface have a similar pattern as that on 2d reef surface the skewness is positive and rapid increases with the growth of ursell number in the ron of u r 80 both in the smooth and rough reef surface then the increase slows down and attains a maxmum value about 1 3 in the range of 250 u r 80 in the next range of u r 250 the skewness decays slowly with increasing ursell number meanwhile the difference between wave skewness from different forereef bottom slope could not be detected from visual observation while wave asymmetry fluctuates around zero in the ron of u r 80 both in the smooth and rough reef surface then becomes negative and decays with increasing ursell number however the effect of forereef bottom slope could be clearly seen with the bottom slope becoming steeper the reduction of the asymmetry is moderated when the local ursell number increases based on the similarity of variation to saturation characteristics the relationship between the skewness s and the ursell number u r could be expressed by an exponential law 7 s k s e u r a s b s 2 and the relationship between the asymmetry a and ursell number can be given by a hyperbolic tangent law 8 a k a tanh u r a a b a where k a and b are coefficients to be determined by fitting the numerical results using the least square method detailed information on the coefficients in eqs 7 and 8 for skewness and asymmetry is listed in table 7 as can be seen the coefficients acquired from 3d topography were almost the same as those from 2d conditions for wave asymmetry a the coefficient b a was constant and the coefficient a a was also nearly constant for different forereef slope bottoms on both the rough and smooth beds therefore b a was set to 0 15 and a a 300 for average considerations however the coefficient k a was obviously related to forereef slope as its absolute value increased as the forereef bottom slope slackened furthermore it is interesting to note that the absolute value of coefficient k a for smooth bed conditions was slightly greater than that for rough bed conditions which implied that the evolution of wave asymmetry becomes more dramatic with increasing degradation of the coral reef although roughness of the reef surface could possibly affect wave asymmetry as the quantification of roughness for a reef bed is difficult it is challenging to parameterise this influence in the final empirical formulae therefore the unique formula describing the relationships between k a and k was identified based on an averaging of the data for smooth and rough bed conditions as listed in table 7 9 k a r 0 99 tanh 5 5 k 1 9 as shown in fig 25 eq 9 and the relationships between k a and k on both 2d and 3d topographical conditions were plotted although the absolute value of coefficient k a on a smooth reef bed was slightly greater than that on a rough reef bed they were all within the margin of error of 10 otherwise the k a obtained from the 3d topographic condition was in very close agreement with that in the 2d condition indicating that the proposed formula can give a reasonably accurate estimation of coefficient k a for both 2d and 3d reef topographic conditions therefore the expression of a including the effects of forereef bottom slope on both rough and smooth reef surface conditions can be summarised as follows 10 a 0 99 tanh 5 5 k 1 9 tanh u r 300 0 15 while for wave skewness s there were almost no departures among coefficients k s a s and b s either for different forereef bottom slopes or for different reef surface conditions this indicated that the variation of the forereef slope bottom or the degradation of coral reef did not affect the evolution of wave skewness as a result the empirical formula of wave skewness s as a function of the local ursell number on a reef flat can be written as a uniform equation 11 s 1 16 e u r 250 250 2 correlations between the empirical formulae and simulated data could be adequately described by correlation coefficients r 2 as can be seen in table 8 all of the correlation coefficients r 2 were almost 0 85 which was sufficient to demonstrate that the proposed formulae could accurately depict the evolution of wave shape over a fringing reef flat 4 3 spectral analysis although the effect of reef roughness adopted in this research was not parameterised into the empirical formula its influence on wave asymmetries should still be analysed as it could help in understanding the evolution of wave shape in the more acute process of coral degradation in this section comparisons of bispectrum over different reef flats were conducted aiming to reveal the effect of forereef slope and reef surface roughness on wave asymmetries fig 26 shows the wavelet based bicoherence for a typical case n8 in table 6 over different type of fringing reefs at the offshore location d 0 442 m only interactions within the primary waves are identified it can be clearly seen that both the degrees of real and imaginary part of bicoherence for waves before reef slope are almost identical when waves propagate into the initial reef flat ron d 0 058 m more wave modes are participated in the triad interactions however the value of the imaginary part of bicoherence b i for the gentle reef slope are clearly larger than that from the steeper reef slope for example the values of a primary wave mode b i 0 7 0 7 for waves from 1 2 5 slope on smooth and rough bed are 0 37 and 0 33 separately while the corresponded value of b i for 1 5 slope are 0 46 and 0 35 for 1 10 slope are 0 56 and 0 39 this indicate that the degree of the imaginary part of bicoherence is weakened as the reef slope get steeper as the imaginary part of bicoherence is related to wave asymmetry hence it could well explain the phenomenon of fig 24 where the increase of wave asymmetry will be moderated over the steeper reef slope as waves propagate into the inner reef flat d 0 038 m more wave modes are involved in this coupling process owing to the release of bound higher harmonics in breaking and the influence of reef slope to imaginary part could still been observed in addition the effect of reef bed roughness should also be noticed when waves are on a smooth bed condition the degree of the imaginary part are slightly serious than that on a rough bed condition for example the value of b i 0 7 0 7 for waves from 1 2 5 reef slope on smooth bed is 0 37 but 0 33 for rough bed similar conclusions could also be derived from other reef flat indicating that the degradation of coral reef will induce the enhancement of wave asymmetry as aforementioned the wave asymmetry is related to the nonlinear energy transfer herbers et al 2000 hence a possible explanation is that as more energy is dissipated on the rough reef surface the extent of energy transfer is weakened leading a small wave asymmetry in this process real part of bicoherences at the same water depth over reef flats were almost identical which implied that wave skewness was insensitive to both the change in forereef bottom slope or degradation of the coral reef this could also explain the phenomenon in fig 24 where the variations in wave skewness from different forereef slopes were almost in agreement 4 4 further discussion fig 27 shows detailed comparisons of the measured and simulated energy densities for some typical wave cases case 1 and case 2 in table 1 h s 7 92 cm t p 0 99s from the laboratory observations the growth of spectral densities in the gravity wave bands f 0 5f p on the forereef bottom could be observed however a dramatic decrease in gravity wave energy occurred when waves were at the initial reef flat accompanied by an increase in spectral energy in the infragravity wave band or the low frequency band f 0 5f p as waves propagated on the inner reef flat it could be observed in the measurements that the wave energy gradually transferred to lower frequency waves while energy density in the lower frequency grew to the maximum and became the dominant wave component at the inner flat the model captured well the generation of infragravity wave energy at reef s edge as can be seen in the above figures when waves propagated into the reef flat the infragravity waves gradually became the dominant wave components the crucial role of infragravity waves on the reef flat has been revealed in many studies nwogu and demirbilek 2010 ma et al 2014 su et al 2015 cheriton et al 2016 junliang et al 2017a 2018 hence it is necessary to conduct a further investigation into its influence on the evolution of wave shape to implement this goal the wave spectrum was divided into two frequency bands infragravity wave bands f 0 5f p and gravity wave bands f 0 5f p skewness of the infragravity wave s ig and gravity wave s g was defined as the wave skewness over the infragravity and gravity frequency bands respectively correspondingly asymmetry of the infragravity and gravity waves were defined as a ig and a g fig 28 compares spatial variations of some typical predicted wave skewnesses s with different forereef slopes on smooth reef beds three typical wave cases including a smallest steepness a medium steepness and a largest steepness wave skewness increased during wave shoaling and reached its maximum value near reef s edge on the reef flat wave skewness continually decreased due to wave breaking and energy dissipation induced by the shallower water depth wave skewnesses on the reef flat were nearly identical although they were distinct on the reef slopes where the s on the gentle slope was larger this implied that the wave skewness could be affected in the reef slope ron and that wave skewness on the reef flat will not be affected which is consistent with the conclusion drawn from fig 24 cross shore distributions of wave asymmetry a showed more complicated features as can be seen in fig 29 a b and c wave asymmetry a influenced by forereef slope showed a distinct evolution the absolute value of a on the gentle slope show a smaller value initially but then become larger on the reef flat here we further compared spatial variations in the a ig fig 29a1 b1 and c1 and a g fig 29a2 b2 and c2 overall cross shore distributions of a ig and a g had similar patterns however it was interesting to note that the magnitude of a ig on the reef flat showed a more distinct trend than it did in the forereef slope ron while a ig on a gentle forereef slope increased more sharply on a reef flat distinguishable from a ig the magnitudes of a g on the reef flat were nearly identical however they were distinct on the forereef slope where the a ig on the steeper slope attained a higher value from the spatial variations of a a ig and a g it can be concluded that the difference between wave asymmetry on the reef flat could be primarily attributed to the different infragravity wave motions which were induced by different forereef bottom slopes cross shore evolutions of wave skewness s and asymmetry a for different frequency bands for the same wave cases in table 6 on a rough reef bed are demonstrated in figs 30 and 31 as can be seen in these figures variations in wave skewness and asymmetry in different frequency bands showed similar evolutions as those over smooth bed conditions however when we put these variables for the same wave cases from rough and smooth reef bed conditions together the effect of reef roughness was more clearly seen figs 32 and 33 show cross shore variations of wave skewness s and asymmetry a in different frequency bands for selected wave case 10 in table 6 on smooth and rough reef bed conditions separately from fig 32 it is seen that the magnitudes of s on both smooth and rough reef beds were almost identical further indicating that the evolution of wave skewness was not influenced by coral degradation however the effect of reef roughness on wave asymmetry seemed more apparent as can be seen in fig 33 a d the magnitudes of a on the smooth reef bed were clearly greater than those on the rough bed condition which was in accordance with the findings in fig 24 as the spatial variations in infragravity wave band a ig and gravity wave band a g were plotted further clarifications were offered in the subplots seen in fig 33 a1 d1 and a2 d2 in the gravity wave band the evolutions of a g for both smooth and rough bed conditions were almost identical however the variation in infragravity wave band a ig on the reef flat was critically dependent upon the roughness of the reef bed magnitudes of a ig on smooth reef beds were greater than those on the rough bed condition similar to those observed in fig 33 a d which shows the variations in asymmetry over all frequency bands on the reef flat therefore it can be concluded that the coral degradation increased the asymmetry of the infragravity waves which led to an occurrence of increase for wave asymmetry on the reef flat 5 conclusions in this paper the fully nonlinear numerical model funwave 2 0 was employed to investigate the evolution of asymmetries of wave surface elevations over fringing reef flats before application the numerical model was calibrated using several sets of laboratory data model sensitivity analysis showed that selection of the proper bottom friction coefficient improved model performance numerical results based on the chosen model parameters showed that the model could well simulate wave transformation wave breaking wave spectrum distribution as well as infragravity waves over coral reefs the model was then utilized to examine the effects of forereef bottom slope and coral degradation on the transformation of waves over fringing reef flat and the following conclusions can be drawn 1 it was found that the forereef slope has a significant influence on the transformation of wave asymmetry on a reef flat and a gentle slope will lead to greater asymmetry however the forereef slope effect on wave skewness is almost negligible with the same slope of forereef bottom wave asymmetry on smooth reef bed conditions is slightly greater than that on rough bed conditions indicating that with degradation of the coral reef the evolution of wave asymmetry becomes more dramatic some empirical formulae regarding these parameters as a function of the local ursell number are derived 2 although the wave field on a 3d surface of fringing reefs seems different from that on a 2d reef surface evolutions of wave asymmetries are almost identical the proposed formula can give a reasonably accurate estimation for both 2d and 3d reef topographical conditions 3 the wavelet based bicoherence spectra revealed that as the forereef slope becomes steeper the degree of the imaginary part of the bicoherence is weakened and the involved wave modes are clearly smaller furthermore degradation of the coral reef will induce a slight enhancement of the degree of the imaginary part leading to a more evident degree of wave asymmetry however the real parts of bicoherence at the same water depth over the reef flat are almost identical which proves again that wave skewness is insensitive to both the change of forereef bottom slope and degradation of the coral reef 4 it was found that the different evolution of wave asymmetry on the reef flat could be primarily attributed to the different infragravity wave motions which is induced by different forereef bottom slopes in addition coral degradation increases the asymmetry of infragravity waves and this will lead to an occurrence of increase for wave asymmetry on a reef flat finally it should be emphasized here that the natural reefs are more complex than physical or numerical model in this study we only focus on the variation of forereef slope and the degradation of coral reef hence these conclusions are only valid for the given type of fringing reefs acknowledgments this work was financially supported by the national natural science foundation of china grant no 51809039 the open fund of state key laboratory of coastal and offshore engineering grant nos lp1702 and lp1718 and the science foundation from the education department of china jilin province grant nos jjkh20180452kj and jjkh20180451kj 
22364,in present work a meshfree framework for the numerical simulation of elasto plasticity deformation of ship structure is established the reproducing kernel particle method rkpm is adopted to discretize the calculation domain and the meshfree shell formulation is derived based on mindlin shell theory then a general elasto plasticity model is established under the meshfree shell framework and the stress resultants are avoided since the shell formulation is based on degenerated continuum approach by removing the normal stress from the yield function the zero normal stress assumption is implemented several numerical examples are studied and the accuracy of the present elasto plasticity model is verified finally the dynamic response of the ship cabin and real ship structure under impact load are calculated the capability of the present meshfree approach applied in complex engineering structures analysis is demonstrated keywords elasto plasticity meshfree methods ship hull dynamic response large deformation 1 introduction shell structures have been widely applied in many aspects of engineering especially in shipbuilding engineering since the main structure of the ship hull is built by stiffened shell structures therefore the response of the stiffened shell structure under ultimate load is of great concern to the engineers for instance the car crash cheng et al 2001 ship grounding simonsen 1997 and damage of ship hull subjected to the underwater explosion liang and tai 2006 ming et al 2016 all these cases contain large deformation of the shell structures in the numerical simulation of such problems the traditional finite element method fem is facing difficulties such as mesh distortion and dynamic crack propagation however the meshfree methods have an advantage in handling these cases and they do not suffer from mesh distortion since their discretizations do not rely on the finite mesh li and liu 2002 nguyen et al 2008 in recent studies the meshfree methods have been applied in the dynamic fracture simulation of thin shells for instance rabczuk et al 2007 proposed a meshfree thin shell method for the crack propagation in thin shells rabczuk et al 2010 using the meshfree method dealing with dynamic fracture of shells while the fluid structure interaction is considered for the numerical simulation of shell structures there are two main approaches one is the direct three dimensional continuum approach li et al 2000 the other one is the so called degenerated continuum approach wang and chen 2004 rabczuk and belytschko 2004 areias and rabczuk 2013 the numerical implementation of the former approach is simpler than the degenerated continuum approach and allows an implementation of local three dimensional constitutive model without any modifications however the former approach is not popular in practice since it has difficulties to model the complex shell structures and the computational cost is relatively high in contrast the degenerated continuum approach is not limited by these problems and has been widely used in numerical simulation kiendl et al 2009 amiri et al 2014 nguyen thanh et al 2015 2017 moreover the deep neural network dnn is applied in the bending analysis of thin shells recently related work on this reader may refer to guo et al 2019 in previous research the meshfree methods have been applied in the simulation of shell structures caleyron et al 2012 applied the moving least squares particle hydrodynamics mlsph to the simulation of the dynamic fracture of shell structures ren and li 2012 used the reproducing kernel particle method rkpm in the simulation of large scale ductile fracture of plates and shells o grady and foster 2014 developed a peridynamics shell formulation to model the bending deformation however the meshfree methods have seldom been applied to the analysis of complex shell structure for instance the meshfree methods have not been applied to the simulation of a real ship structures focus on the insufficiency of current research in the present work we established a meshfree framework for the numerical simulation of elastoplasticity response of ship structures in present work the rkpm shell formulation based on mindlin shell theory peng et al 2018 are adopted which characterized by the straight fibers remain within the deformation process the elastoplastic constitutive model applied in degenerated shell has been studied by many researchers simo and kennedy 1992 areias and belytschko 2006 klinkel et al 2008 the model proposed by simo and kennedy 1992 is efficient and has been simplified by zeng et al 2001 to further improve the computational efficiency however plastic model based on stress resultants is less hardening than the classical j 2 model in this work we draw on the matrix analysis method which has been adopted by simo and kennedy 1992 but the use of stress resultants is avoided the stress tensor of the integration point is chosen as the input variable of the plastic model instead the yield criterion is derived from the von mises yield criterion and it can easily combine with the damage model further in addition since the stress resultants is not adopted the dimension of the matrix used in the return mapping algorithm has reduced from 8 to 5 thus the complexity of the numerical algorithms is decreased another problem to solve is the implementation of the so called zero normal stress condition which is essential for the simulation of shell structures in the literature at the end of each iteration the thickness is changed to satify the zero normal stress condition in this work by considering this condition in the yield criterion and using the reduced constitutive model the zero normal stress condition is satisfied the shell simulation is based on the rkpm shell formulation proposed by peng et al 2018 which has been used for the dynamic analysis of stiffened shell structures peng et al 2019 the paper is organized as follows a brief introduction of the rkpm shell formulation and the reproducing kernel function is presented in section 2 in section 3 the yield criterion combined with the zero normal stress assumption is present and the return mapping algorithm is derived in section 4 we present several numerical examples to verify the reliability of the present model lastly a summary of this paper is presented in section 5 2 outline of rkpm shell formulation 2 1 shell kinematics based on the degenerated solid element approach developed by hughes and liu 1981 the kinematics of the shell are defined as shown in fig 1 therefore the geometric definition of the shell is reduced specifically a reference surface and the fiber vectors vertical to it are chosen to describe the shell kinematics in numerical practice only one layer of nodes on the reference surface is needed to discretize the shell for the galerkin type weak form the field variable is reproduced by values of nodes in a generally domain ω 0 and the shape function is used to approximate the field variable for instance in the current configuration we can express the position vector of a generic point as follows 1 x ξ η ζ i n i x i h 2 ζ y i where n i denotes the interpolation shape function x ξ is the current coordinate vector of a generic point in the shell x i is the current position vector of node i on the reference surface and y i is the current nodal unit fiber vector which is not required to be normal to the reference surface since the mindlin reissner shell theory is adopted moreover a rotation operator based on the quaternion is used to update the fiber vector thus the velocity of a generic point in the shell can be obtained from the time derivative of the position vector 2 v ξ η ζ i n i v i h 2 n i ω i y i where n i ζ n i v i is the nodal velocity vector ω i is the fiber rotation angular velocity the local corotational coordinate system at each stress point e i l i 1 2 3 is defined by three mutually orthogonal unit vectors 3 e 1 l x ξ x ξ 4 e 3 l e 1 l x η e 1 l x η 5 e 2 l e 3 l e 1 l where e 1 l e 2 l are the unit tangent vector of the reference surface e 3 l is the normal of the reference surface the local coordinate basis vector rotates rigidly while the shell deforms the rotation matrix q that transform quantities from the global coordinate system to the local coordinate system is defined as q e 1 l e 2 l e 3 l t where the superscript t denotes transpose 2 2 rkpm shape function in eq 1 the interpolation shape function n i ξ is introduced in present work the reproducing kernel function is adopted which is constructed by correcting the original sph kernel function besides the shape function only calculated once at the begin of the simulation since the lagrangian kernel is adopted the shape function used in rkpm shell formulation can be written as peng et al 2018 6 n i ξ c ξ ξ i ξ φ a ξ i ξ δ ξ i where ξ i ξ q 0 x i x is the relative position between two neighbor points in the laminar coordinate system where q 0 is the initial rotation matrix φ a ξ i ξ is the so called window function δ ξ i denotes the area of node i on the reference surface and c ξ ξ i ξ is the correction function 7 c ξ ξ i ξ p t ξ i ξ b a ξ where p t denotes the interpolation basis function and the bilinear basis function is adopted b a ξ is a coefficient vector which is determined by the reproducing condition chen et al 1996 we have 8 b a ξ m 1 a ξ p t 0 9 m a ξ γ 0 p ξ ξ p t ξ ξ φ a ξ ξ d ξ where p t 0 1 0 0 0 p t ξ ξ 1 ξ ξ η η ξ ξ η η and ξ dentoes and arbitrary point in the support domain when the shell is discretized into nodes the integration of eq 9 is calculated by the summation and the differential area d ξ is changed to δ ξ i 2 3 governing equation of rkpm shell the linear momentum equation for a continuum in the reference configuration ω 0 is 10 ρ 0 v x t t ρ 0 b x t 0 p 0 where p is the first piola kirchhoff stress ρ 0 denotes the initial density b denotes the body force and v x t denotes the velocity field based on the principle of virtual power the weak form discrete governing equations peng et al 2018 are derived 11 m i j u j f i e x t f i i n t 12 j i j ω j m i e x t m i i n t where m and j is the mass and rotational inertia matrix f m denote the force and moment vector respectively in which the superscript e x t and i n t is used to identify the external or internal variables a lumped mass matrix is obtained based on the row summing technique we have 13 m i j γ 0 ρ 0 h n i δ i j d γ 0 where γ 0 denotes the initial reference surface similarly we can obtain the lumped rotational inertia matrix which can be expressed as 14 j i j h 2 12 γ 0 ρ 0 h n i δ i j d γ 0 h 2 12 m i j the internal force and external force vector in eq 11 are given as 15 f i i n t ω 0 n i x p d ω 0 16 f i e x t ω 0 ρ 0 n i b d ω 0 γ 0 t n i t 0 d γ 0 t where d ω 0 h d γ 0 and t 0 denotes the traction force and the internal and external moment vector in eq 12 are expressed as follows 17 m i i n t ω 0 h 2 n i x p y i d ω 0 18 m i e x t ω 0 ρ 0 h 2 n i y i b d ω 0 γ 0 t h 2 n i y i t 0 d γ 0 t 2 4 time integration scheme and essential boundary conditions to update the displacement and rotations firstly the linear and angular accelerations can be calculated by eqs 11 and 12 then the newmark time integration scheme is adopted to update the displacement and rotations for instance in the linear momentum equation eq 11 the mass matrix has been diagonalized by the row sum lumped technique thus the linear acceleration of node i can be calculated by 19 u i 1 m i f i e x t f i i n t after the acceleration at t is obtained the following formula peng et al 2019 is employed to predict the velocity and displacement at t δ t 20 u t δ t p u t δ t u t δ t 2 2 1 2 β u t 21 u t δ t p u t 1 γ δ t u t where δ t denotes the time increment β and γ are parameters in all simulations β 0 and γ 0 5 are adopted the strain and stress tensor can be calculated by the predicted deform configuration and the internal force at t δ t can be obtained therefore the acceleration at t δ t is got finally the velocity and displacement at t δ t is corrected by 22 u t δ t u t δ t p β δ t 2 u t δ t 23 u t δ t u t δ t p γ δ t u t δ t the same scheme is employed to update the angular displacements and velocities for the enforcement of the essential boundary conditions the d alembert s principle günther and liu 1998 is adopted 2 5 simulation of stiffened shells and fiber update scheme for the simulation of stiffened shells a support domain cutting scheme is developed in this scheme the support domain of a stress point not only influenced by the distance between the two points but also related to which component the two points located for detail reader may refer to peng et al 2019 in present work the shell formulation is based on the mindlin shell theory therefore the fiber direction should be updated explicitly the rotation operator based on the quaternion is adopted which can be expressed as follows 24 p t q θ p 0 q θ 1 where p is a pure quaternion which is related to the fiber vector q θ is related to the rotation angle and is a unit quaternion therefore its inverse q θ 1 can be obtained simply by changing the sign of its imaginary components we have 25 p t 0 y 1 i y 2 j y 3 k 26 q θ cos θ 2 sin θ 2 θ x θ i sin θ 2 θ y θ j sin θ 2 θ z θ k 27 q θ 1 cos θ 2 sin θ 2 θ x θ i sin θ 2 θ y θ j sin θ 2 θ z θ k where y 1 y 2 and y 3 denote the three components of the fiber vector y θ x θ y and θ z denote the rotation angles around three axis and θ θ i j k is the unit basis vector of the global coordinate system it should be noticed that the product of two quaternions in eq 24 is different from both the dot and cross product of two vectors for detail readers may refer to a comprehensive introduction by kuipers 1999 3 elastoplastic model of shell in present work the nonlinear plasticity model for shell developed by simo and kennedy 1992 has been modified the stress tensor of the gauss point in the shell thickness direction instead of the stress resultants is chosen as the input of the constitutive algorithm 3 1 basic equations of the multi surface elastoplastic model consider that a node inital located at x moves to x in the current configuration then the deformation gradient tensor is calculated by 28 f i j x i x j i n i x j x i i h 2 ζ n i x j y i i where i j 1 2 3 the determinant of f is denoted as j det f the almansi strain is calculated by the deformation gradient 29 ε 1 2 i f t f 1 in present work the strain tensor is divided into elastic and plastic parts ε ε e ε p based on an additive decomposition karaoulanis 2013 where ε e and ε p denote the elastic and plastic part of the strain tensor respectively the constitutive model for the so called hyperelastic material is the simplest in which the stress response is governed by a strain energy function w which depending on the elastic deformations therefore the helmholtz free energy potential ψ can be decomposed into the strain energy function w ε e and the hardening energy function which related to the internal variable eberlein and wriggers 1999 30 ψ ε ε p r α w ε e h r α where r and α denote the isotropic and kinematic hardening state variable respectively since the damage of material has not been taken into account we have r p where p denotes the accumulate plastic strain following the constraint of isotropy the local dissipation inequality is obtained based on the second law of thermodynamics in the absence of thermal terms the dissipation function can be expressed d σ ε ψ 0 and which can be expanded as 31 d σ w ε e ε e σ ε p h r r h α α 0 then the constitutive relations for cauchy stress and hardening variable are derived from eq 31 truesdell and noll 2004 32 σ w ε e q h r β h α where q denotes the isotropic hardening stress variable β denotes the uniaxial kinematic back stress tensor then the clausius planck constitutive inequality eq 31 takes the reduced form 33 d σ ε p q r β α 0 by assuming the principle of maximum plastic dissipation we consider a maximization problem with inequality constraints maximize d subject to φ σ q β 0 where φ is the yield function of plastic criterion this maximization problem under constraints can be solved by constructing the following lagrange function 34 l σ q β γ d σ q β γ φ σ q β where γ is the so called plastic multiplier according to the kuhn tucker theorem maximum plastic dissipation can be obtained if γ satisfies 35 γ 0 φ 0 γ φ 0 36 ε p γ φ σ 37 r γ φ q 38 α γ φ β where eq 35 is the loading unloading conditions and eq 36 38 is the evolution equations for the rate of plastic strain isotropic and kinematic hardening variables 3 2 yield function under zero normal stress condition based on the general framework above we now establish the elastoplastic model for shell structure since the degenerated solid approach is adopted the variables in the constitutive equations need to be projected onto the shell reference surface for instance the stress tensor has to be transformed into the local coordinate system σ l q t σ g q in the sequel all the calculations are carried out in the local coordinate system for writing simplicity superscript l is omitted in present work the standard von mises yield criterion is adopted which is suitable for many applications in metal plasticity and the yield function can be expressed as 39 φ 3 j 2 σ y where j 2 is the second deviatoric stress invariant σ y denotes the yield stress and σ y κ r κ 0 q where κ 0 denotes the initial yield stress to eliminate the square root eq 39 is rewritten as φ 3 j 2 κ 2 κ 0 by considering the zero normal stress condition σ 33 0 we have 40 φ 1 κ 0 σ 11 2 σ 22 2 3 σ 12 2 σ 11 σ 22 3 σ 13 2 3 σ 23 2 κ 2 κ 0 the equation above can be expressed into matrix form 41 φ σ t a σ κ 2 κ 0 where σ has been rewritten into a column vector and a is a coefficient matrix we have 42 σ t σ 11 σ 22 σ 12 σ 13 σ 23 43 a 1 κ 0 p 0 0 3 i 2 p 1 1 2 0 1 2 1 0 0 0 3 where i n denotes the rank n identity matrix if the kinematic hardening is taken into account then the back stress should be considered 44 φ σ β t a σ β κ 2 κ 0 to express the stress strain relation into matrix form similar to eq 42 the strain tensor is rewritten into column vectors ε t ε 11 ε 22 ε 12 ε 13 ε 23 then the strain energy function is assumed to have the following form 45 w 1 2 ε ε p t c ε ε p where c 2 w ε e ε e is the elastic tensor since the strain tensor is rewritten into a vector the elastic tensor is reduced from a fourth order tensor to a second order tensor thus we have 46 c c n 0 0 g s i 2 c n e 1 ν 2 1 ν 0 ν 1 0 0 0 1 ν 2 where e is the young s modulus and ν is the poisson s ratio g s g k s in which g and k s are denote the shear modulus and shear correction factor respectively similarly the hardening potential is also assumed to be quadratic 47 h 1 2 e p r 2 1 2 α t d α where e p and d 2 3 h i 5 denote the isotropic and kinematic hardening modulus respectively substituting eqs 45 and 47 into eq 32 then we have 48 σ w ε e c ε e q e p r β d α 3 3 elastoplastic return mapping algorithm the main algorithmic problem to be solved in this section is to update the field ε n ε n p r n α n at t n to ε n 1 ε n 1 p r n 1 α n 1 at t n 1 firstly we assumed that ε n 1 p ε n p and α n 1 α n then the trail stress and trial back stress at the n 1 time step are obtained 49 σ n 1 t r i a l c ε n 1 c ε n p 50 β n 1 t r i a l d α n substituting eq 49 into eq 44 we have 51 φ n 1 t r i a l σ n 1 t r i a l β n 1 t r i a l t a σ n 1 t r i a l β n 1 t r i a l κ 2 r κ 0 0 if φ n 1 t r i a l 0 which indicates that the material is in an elastic loading or unloading state and there is no new plastic deformation occurs then we set n 1 n 1 t r i a l if the φ n 1 t r i a l 0 which indicates that the material is in the plastic loading state thus to make the stress state return to the yield surface the nonlinear system of equations below has to be solved 52 σ n 1 σ n 1 t r i a l c δ ε n 1 p 53 β n 1 β n 1 t r i a l d δ α n 1 54 φ n 1 σ q β 0 where δ ε n 1 p and δ α n 1 denote the increment of plastic strain and hardening variables in the n 1 time step respectively and they can be calculated by substituting eq 44 into eqs 36 and 38 furthermore we can observe that there is only one unknown variable γ n 1 in eq 52 54 all of the following efforts are for solving γ n 1 and the newton iteration scheme is adopted the yield function for the k th iteration step is expressed as follows 55 φ n 1 k σ n 1 k β n 1 k t a σ n 1 k β n 1 k κ 2 r n 1 k κ 0 0 where the stress and back stress in k iteration step and can be expressed as follows 56 σ n 1 k β n 1 k i 5 γ n 1 k 2 ca 4 3 h a 1 σ n 1 t r i a l β n 1 t r i a l where 57 2 ca 4 3 h a 1 κ 0 2 c n p 4 3 h p 0 0 3 g s i 2 the matrix c and p have the same characteristic subspaces simo and kennedy 1992 that is 58 p q λ p q t c n q λ c n q t where q 1 q t is a orthogonal matrix the diagonal matrices λ p and λ c n is 59 q 1 2 1 1 0 1 1 0 0 0 2 λ p 1 2 0 0 0 3 2 0 0 0 3 λ c n e 1 ν 0 0 0 e 1 ν 0 0 0 e 2 1 ν by considering ξ n 1 k q 5 t σ n 1 k β n 1 k where 60 q 5 q t 0 0 i 2 then eq 56 can be diagonalized and have a remarkably simple form 61 ξ n 1 k s ξ n 1 t r i a l where s is a diagonal matrix and can be expressed as follows 62 s ξ 1 0 0 1 3 g s γ n 1 k κ 0 1 i 2 in which 63 ξ i 3 γ n 1 k κ 0 2 λ c n λ p 4 3 h λ p substituting eq 61 into the yield function in k iteration step eq 55 we have 64 φ n 1 k ξ n 1 t r i a l t s t ωs ξ n 1 t r i a l κ 2 r n 1 k κ 0 0 where ω q 5 t a q 5 is a constant matrix the trial stress state is invariable during the iterative algorithm so the yield function φ is a function only related to γ then we can solve the variable γ by the newton iteration 65 γ n 1 k 1 γ n 1 k φ γ φ n 1 k the finial stress state is obtained by substituting the convergence solution of γ into eqs 52 and 53 in the equation above we have 66 γ φ 2 ξ n 1 t r i a l t s t ω γ s ξ n 1 t r i a l 2 κ γ κ κ 0 0 where γ s s γ s 1 s and we have 67 γ s 1 1 κ 0 2 λ c n λ p 4 3 h λ p 0 0 3 g s i 2 considering that κ κ 0 q and q r e p we have 68 γ κ κ r r γ e p 2 κ κ 0 the main numerical algorithm is shown in algorithm 1 algorithm 1 return mapping algorithm image 1 4 numerical examples to verify the reliability and accuracy of the present meshfree model we studied several numerical examples in this section in the rkpm shell formulation the bilinear shape function and one stress point per integration cell are adopted peng et al 2018 the illustration of the integration cell is shown in fig 2 since the order of the integration scheme is less than the order of the shape function it shall be regarded as a reduced integration by which shear locking is eliminated besides for the integration in the shell thickness three gauss points are employed 4 1 a simply supported plate loaded by pressure impulse in this section the elasto plastic dynamic response of a simply supported plate under uniform step pressure is studied the dimension of the plate and the material parameters are shown in fig 2 the initial yield stress is κ 0 2 068 10 8 pa and perfect plasticity without hardening is assumed in calculation uniformly distributed particles are used to discretize the structure the total number of particles are 5 5 9 9 and 27 27 respectively the result calculated by abaqus 64 64 s4r elements are used is adopted as reference the displacement histories of the center point are shown in fig 3 in which the results calculated by the present method is compared with the reference result obtained by abaqus from which we can see that the results calculated by rkpm converge to the reference results very quickly the results obtained by 27 27 particles are almost identical with the fem result which verifies the convergence and accuracy of the present method due to the material plastic the deflection of the center point can not return to its initial state during the vibration as shown in fig 3 in rkpm shell the average number of nodes in the support domain is about 12 while in the s4r shell element in abaqus the stress point is connected with four nodes so the calculation efficiency of rkpm is lower than that of fem the vibration of the plate in 0 2s is simulated by rkpm and fem on one intel i7 7700k processor the comparison of the computational cost of these two methods is shown in fig 4 from which we can see that the time cost by rkpm is about four times than fem 4 2 roof loaded by velocity impulse in this section the present plastic model applied in shell dynamic analysis is considered a 120 cylindrical panel subjected to the velocity impulse is studied an initial velocity distribution is specified the problem dimensions and material parameters are summarized in fig 5 the curved ends of the roof are simply supported and the side boundaries are clamped an initial velocity of 143 51 m s normal to the shell surface is loaded on a region marked in fig 5 two particle spacing are used to solve this problem the total number of particles is 556 and 2242 respectively the displacement histories of the gauging point initially located at x 0 y 0 0762 m and z 0 167 m are shown in fig 6 the results calculated by rkpm are compared with the reference simulations using 224 and 4512 belytschko tsay elements respectively benson et al 2010 as well as experimental data from morino et al 1971 since the bilinear shape function with one stress point per integration cell is applied no locking is observed in the numerical simulation and it was shown that the results obtained by the present model are in good agreement with the reference results fig 7 a gives the residual deformation of the crown line of the roof and fig 7 b gives the residual deformation of a radial cross section in which the experimental data is plotted as reference 4 3 elastoplastic response of a simply supported plate the inflation of a square plate is presented in this section this numerical example is popular to verify the shell formulations within finite elasto plastic strains and has been considered by a number of authors eberlein and wriggers 1999 betsch and stein 1999 klinkel et al 2008 the geometry of the problem and material data are summarized in fig 8 the edges of the plate are simply supported that only the vertical displacements u 3 are restricted to zero and a constant pressure load p 0 10 4 pa is applied here perfect plasticity without hardening is assumed in the simulation the shell is discretized by 49 49 particles the load displacement curve of the center node of the plate is shown in fig 9 and the results obtained by eberlein and wriggers 1999 and betsch and stein 1999 are adopted as references in which the load level denotes p p 0 it was shown that our results are in agreement with the reference results this example verifies the applicability of the present model to the simulation of extreme bending deformations the deformed configuration with a contour plot of the equivalent plastic strain for a pressure load of p 60 p 0 is shown in fig 10 which shows a significant change of the shell surface during the deformation 4 4 pinched hemisphere with isotropic hardening a hemisphere loaded by two inward and two outward forces 90 apart the plastic model with isotropic hardening is adopted the geometry parameters and material properties are shown in fig 11 this example has been studied previously by a number of authors simo and kennedy 1992 eberlein and wriggers 1999 betsch and stein 1999 in the simulation the shell is discretized by 2883 particles the applied loads f versus the radial displacement is plotted in fig 12 and the results presented in previous literatures simo and kennedy 1992 eberlein and wriggers 1999 betsch and stein 1999 are chosen as references from which it shows that the results obtained by the present plastic model are in good agreement with the results presented in eberlein and wriggers 1999 and betsch and stein 1999 since the stress resultants plasticity model leads to less hardening when compared with j 2 model there is a divergence between the present results and the results obtained by simo and kennedy 1992 the deformed configuration of the hemisphere at a load level of f 30 f 0 is shown in fig 13 in which the contours of the equivalent plastic strains are included see fig 14 4 5 elastoplastic deformation of a ship cabin under impact pressure in the previous sections the accuracy and effectiveness of present elastoplastic model applied in simple shell structures are verified in this section the elastoplastic response of a ship cabin under impact pressure load is studied the calculation model comes from the research by zhu et al 2004 the dimensions of the structure are illustrated in fig 15 in which the length unit is millimeter the defensive longitudinal bulkhead and the main deck are made of low alloy steel and the other components are made of plain steel the material parameters of these two steel are summarized in table 1 in the simulation the linear hardening is adopted and the damage response of the material is ignored since the strain rate effect is important in the impact problem it can not be neglected in present study power law expression is adopted therefore the yield stress is obtained 69 κ r 1 ε e q p c 1 p κ 0 e p r where ε e q p denote the equivalent plastic strain rate c and p is the strain rate hardening coefficients in calculation the water resistant longitudinal bulkhead is clamped and the impact pressure is loaded on the broadside shell which is represented in fig 15 by a red line the temporal and spatial distribution of the pressure load are governed by the expression zamyshlyaev and yakovlev 1973 list below 70 p 44 1 10 6 0 2714 x x c 1 51 e t 2 84 10 5 where x is the coordinate of a stress point on the loading surface and x c denotes the center coordinate which is 0 7 0 25 0 75 in practice four different particle spacings has been adopted in these four cases the total number of particles used to discretize the model are 23274 41166 96595 and 145275 respectively the particle view of the ship cabin while particle spacing is 20 mm is shown in fig 16 the fixed time increment is adopted in simulation the models with different particle spacing are calculated and the displacement contour of the ship cabin is shown in fig 17 while the particle spacing on the left is 20 mm and on the right is 10 mm from the figure it can be seen that the displacement of the maximum load point increases rapidly after loading and at the initial moment due to the reinforcement of the stiffener the displacement of the outboard shell near the stiffener is relatively small with the development of deformation the displacement of the outboard shell reaches the peak and because of the influence of plasticity the displacement of the outboard stay at the plateau although the pressure load decreased near to zero the time history of the displacement at the maximum loading point is shown in fig 19 and the result calculated by ls dyna with mesh size equal to 10 mm is adopted as the reference from which we can see that the displacement of the gauging point increases rapidly at the beginning and reaches a peak at 1 5 ms subsequently the displacement declines but due to the plasticity of the material there is relatively large residual displacement exist and the displacement fluctuates near the final equilibrium state by comparing these curves we can see that the displacement of the gauging point increases while the particle spacing decreases the calculation converges because of the displacement of the gauging point almost the same when particle spacing is 10 mm or 8 mm and the result calculated by rkpm are in good agreement with the fem result in fig 18 the comparision of the particle views of the stiffener when the particle spacings are 20 mm and 10 mm is given it can be seen from the figure that there are only three nodes in the width direction of panel and web of the stiffeners when particle spacing is 20 mm but when particle spacing is 10 mm there are at least five nodes in the width direction of panel and web of the stiffeners considering that the displacement converges when the particle spacing is less than 10 mm the rule of particle spacing selection can be obtained that is at least five nodes are required in the smaller scale direction of the stiffeners 4 6 damage response of ship structure under blast shock wave in this section to verify the applicability of the present meshfree approach in the analysis of real engineering structure the dynamic response of the warship under the near field underwater shock wave is studied in calculation the average particle spacing is chosen as 0 4 m in some specialized area the particle spacing may little than 0 4 m and a total of 123990 particles are used to discretize the structure the particle view of the warship is illustrated in fig 20 in the modeling of ship structure only the large stiffener and main bulkheads are considered besides the whole stiffened shell structure is discretized by rkpm shell element since the pre processing capability of the present code is still weak we ignore the small stiffener to simplify the modeling procedure the thickness of the outboard shell is set to 12 mm while the others shell are set to 7 mm the material of the calculation model is low alloy steel whose material parameters is list in table 1 in the previous section in the simulation 100 kg tnt is placed below the amidship considering that the edge length of 100 kg cubic tnt is about 0 4 m which is equal to the average particle spacing if we consider the fluid structure interaction fsi the particle spacing should be shrunk at least 4 times which will result in a tremendous increase in the number of particles since the objective is to verify the effectiveness of the structural algorithm the fsi effect is neglected and only the underwater shock wave is taken into account moreover in the simulation no essential boundary conditions are applied and gravity is not considered the temporal and spatial distribution of the shock wave are calculated using the empirical formula zamyshlyaev and yakovlev 1973 when the distance between the load point and the center of tnt is 2 6 times to the tnt radius the magnitude of shock wave is calculated by the formula developed by ming et al 2016 in calculation a fixed time step of δ t 1 0 10 5 s is adopted the contours of the mises equivalent stress of the warship at several typical time are shown in fig 21 from which it can be seen that a local depression occurred at the bottom of the amidship as soon as the simulation begins after that the deformation of the ship further increases and finally the depression of the ship hull is expanded to the range of four longitudinal compartments which can be observed in fig 22 the comparison of the deformed configuration of the ship at t 200 ms calculated by the present method and ls dyna is shown in fig 23 from which we can see that the results calculated by rkpm are in good agreement with fem to some extent in the simulation the computation took about 304 min on one intel i7 7700k processor while using rkpm as a contrast it took about 3034s while using ls dyna which is about six times less than rkpm the final contour of the equivalent plastic strain of the ship hull is shown in fig 24 from which we can see that there is a 5 0m 2 67 m rectangular damage hole is finally produced 5 conclusions in present work a meshfree approach for the numerical simulation of the elasto plasticity response of the real ship structure is established the rkpm shell formulation based on mindlin shell theory is adopted and a general elasto plasticity constitutive model for shell structures is presented the yield criterion is derived directly through the classic mises yield criterion and the zero normal stress assumption is implemented by removing the normal stress component from the yield function in calculation the yield function is put into matrix format by diagonalizing the matrices and avoid the stress resultants the complexity of the return mapping algorithm is reduced first several numerical examples are presented to verify the reliability of the proposed elastoplasticity model the results obtained by rkpm are in good agreement with the reference results which demonstrates that the present numerical model has good accuracy then the dynamic responese of a ship cabin under impact load is studied the applicability of the present meshfree approach in dynamic analysis of complex shell structure is verified and in the simulation to ensure a reliable result there should be at least 5 particles in the small scale direction of the ribs finally the damage response of a real ship structure subjected to underwater explosion shock wave is studied the capability of the present meshfree approach applied in the engineering problem is verified yet few researches have been done on the application of the meshfree methods in dynamic analysis of complex structure analysis we believe that the present work lays a solid foundation for future application of the meshfree method in complex engineering structures analysis acknowledgements the authors thank the national numerical wind tunnel project of china 2018 zt2b05 and industrial technology development program of china jcky2018604c010 jcky2017604c002 for their support 
22364,in present work a meshfree framework for the numerical simulation of elasto plasticity deformation of ship structure is established the reproducing kernel particle method rkpm is adopted to discretize the calculation domain and the meshfree shell formulation is derived based on mindlin shell theory then a general elasto plasticity model is established under the meshfree shell framework and the stress resultants are avoided since the shell formulation is based on degenerated continuum approach by removing the normal stress from the yield function the zero normal stress assumption is implemented several numerical examples are studied and the accuracy of the present elasto plasticity model is verified finally the dynamic response of the ship cabin and real ship structure under impact load are calculated the capability of the present meshfree approach applied in complex engineering structures analysis is demonstrated keywords elasto plasticity meshfree methods ship hull dynamic response large deformation 1 introduction shell structures have been widely applied in many aspects of engineering especially in shipbuilding engineering since the main structure of the ship hull is built by stiffened shell structures therefore the response of the stiffened shell structure under ultimate load is of great concern to the engineers for instance the car crash cheng et al 2001 ship grounding simonsen 1997 and damage of ship hull subjected to the underwater explosion liang and tai 2006 ming et al 2016 all these cases contain large deformation of the shell structures in the numerical simulation of such problems the traditional finite element method fem is facing difficulties such as mesh distortion and dynamic crack propagation however the meshfree methods have an advantage in handling these cases and they do not suffer from mesh distortion since their discretizations do not rely on the finite mesh li and liu 2002 nguyen et al 2008 in recent studies the meshfree methods have been applied in the dynamic fracture simulation of thin shells for instance rabczuk et al 2007 proposed a meshfree thin shell method for the crack propagation in thin shells rabczuk et al 2010 using the meshfree method dealing with dynamic fracture of shells while the fluid structure interaction is considered for the numerical simulation of shell structures there are two main approaches one is the direct three dimensional continuum approach li et al 2000 the other one is the so called degenerated continuum approach wang and chen 2004 rabczuk and belytschko 2004 areias and rabczuk 2013 the numerical implementation of the former approach is simpler than the degenerated continuum approach and allows an implementation of local three dimensional constitutive model without any modifications however the former approach is not popular in practice since it has difficulties to model the complex shell structures and the computational cost is relatively high in contrast the degenerated continuum approach is not limited by these problems and has been widely used in numerical simulation kiendl et al 2009 amiri et al 2014 nguyen thanh et al 2015 2017 moreover the deep neural network dnn is applied in the bending analysis of thin shells recently related work on this reader may refer to guo et al 2019 in previous research the meshfree methods have been applied in the simulation of shell structures caleyron et al 2012 applied the moving least squares particle hydrodynamics mlsph to the simulation of the dynamic fracture of shell structures ren and li 2012 used the reproducing kernel particle method rkpm in the simulation of large scale ductile fracture of plates and shells o grady and foster 2014 developed a peridynamics shell formulation to model the bending deformation however the meshfree methods have seldom been applied to the analysis of complex shell structure for instance the meshfree methods have not been applied to the simulation of a real ship structures focus on the insufficiency of current research in the present work we established a meshfree framework for the numerical simulation of elastoplasticity response of ship structures in present work the rkpm shell formulation based on mindlin shell theory peng et al 2018 are adopted which characterized by the straight fibers remain within the deformation process the elastoplastic constitutive model applied in degenerated shell has been studied by many researchers simo and kennedy 1992 areias and belytschko 2006 klinkel et al 2008 the model proposed by simo and kennedy 1992 is efficient and has been simplified by zeng et al 2001 to further improve the computational efficiency however plastic model based on stress resultants is less hardening than the classical j 2 model in this work we draw on the matrix analysis method which has been adopted by simo and kennedy 1992 but the use of stress resultants is avoided the stress tensor of the integration point is chosen as the input variable of the plastic model instead the yield criterion is derived from the von mises yield criterion and it can easily combine with the damage model further in addition since the stress resultants is not adopted the dimension of the matrix used in the return mapping algorithm has reduced from 8 to 5 thus the complexity of the numerical algorithms is decreased another problem to solve is the implementation of the so called zero normal stress condition which is essential for the simulation of shell structures in the literature at the end of each iteration the thickness is changed to satify the zero normal stress condition in this work by considering this condition in the yield criterion and using the reduced constitutive model the zero normal stress condition is satisfied the shell simulation is based on the rkpm shell formulation proposed by peng et al 2018 which has been used for the dynamic analysis of stiffened shell structures peng et al 2019 the paper is organized as follows a brief introduction of the rkpm shell formulation and the reproducing kernel function is presented in section 2 in section 3 the yield criterion combined with the zero normal stress assumption is present and the return mapping algorithm is derived in section 4 we present several numerical examples to verify the reliability of the present model lastly a summary of this paper is presented in section 5 2 outline of rkpm shell formulation 2 1 shell kinematics based on the degenerated solid element approach developed by hughes and liu 1981 the kinematics of the shell are defined as shown in fig 1 therefore the geometric definition of the shell is reduced specifically a reference surface and the fiber vectors vertical to it are chosen to describe the shell kinematics in numerical practice only one layer of nodes on the reference surface is needed to discretize the shell for the galerkin type weak form the field variable is reproduced by values of nodes in a generally domain ω 0 and the shape function is used to approximate the field variable for instance in the current configuration we can express the position vector of a generic point as follows 1 x ξ η ζ i n i x i h 2 ζ y i where n i denotes the interpolation shape function x ξ is the current coordinate vector of a generic point in the shell x i is the current position vector of node i on the reference surface and y i is the current nodal unit fiber vector which is not required to be normal to the reference surface since the mindlin reissner shell theory is adopted moreover a rotation operator based on the quaternion is used to update the fiber vector thus the velocity of a generic point in the shell can be obtained from the time derivative of the position vector 2 v ξ η ζ i n i v i h 2 n i ω i y i where n i ζ n i v i is the nodal velocity vector ω i is the fiber rotation angular velocity the local corotational coordinate system at each stress point e i l i 1 2 3 is defined by three mutually orthogonal unit vectors 3 e 1 l x ξ x ξ 4 e 3 l e 1 l x η e 1 l x η 5 e 2 l e 3 l e 1 l where e 1 l e 2 l are the unit tangent vector of the reference surface e 3 l is the normal of the reference surface the local coordinate basis vector rotates rigidly while the shell deforms the rotation matrix q that transform quantities from the global coordinate system to the local coordinate system is defined as q e 1 l e 2 l e 3 l t where the superscript t denotes transpose 2 2 rkpm shape function in eq 1 the interpolation shape function n i ξ is introduced in present work the reproducing kernel function is adopted which is constructed by correcting the original sph kernel function besides the shape function only calculated once at the begin of the simulation since the lagrangian kernel is adopted the shape function used in rkpm shell formulation can be written as peng et al 2018 6 n i ξ c ξ ξ i ξ φ a ξ i ξ δ ξ i where ξ i ξ q 0 x i x is the relative position between two neighbor points in the laminar coordinate system where q 0 is the initial rotation matrix φ a ξ i ξ is the so called window function δ ξ i denotes the area of node i on the reference surface and c ξ ξ i ξ is the correction function 7 c ξ ξ i ξ p t ξ i ξ b a ξ where p t denotes the interpolation basis function and the bilinear basis function is adopted b a ξ is a coefficient vector which is determined by the reproducing condition chen et al 1996 we have 8 b a ξ m 1 a ξ p t 0 9 m a ξ γ 0 p ξ ξ p t ξ ξ φ a ξ ξ d ξ where p t 0 1 0 0 0 p t ξ ξ 1 ξ ξ η η ξ ξ η η and ξ dentoes and arbitrary point in the support domain when the shell is discretized into nodes the integration of eq 9 is calculated by the summation and the differential area d ξ is changed to δ ξ i 2 3 governing equation of rkpm shell the linear momentum equation for a continuum in the reference configuration ω 0 is 10 ρ 0 v x t t ρ 0 b x t 0 p 0 where p is the first piola kirchhoff stress ρ 0 denotes the initial density b denotes the body force and v x t denotes the velocity field based on the principle of virtual power the weak form discrete governing equations peng et al 2018 are derived 11 m i j u j f i e x t f i i n t 12 j i j ω j m i e x t m i i n t where m and j is the mass and rotational inertia matrix f m denote the force and moment vector respectively in which the superscript e x t and i n t is used to identify the external or internal variables a lumped mass matrix is obtained based on the row summing technique we have 13 m i j γ 0 ρ 0 h n i δ i j d γ 0 where γ 0 denotes the initial reference surface similarly we can obtain the lumped rotational inertia matrix which can be expressed as 14 j i j h 2 12 γ 0 ρ 0 h n i δ i j d γ 0 h 2 12 m i j the internal force and external force vector in eq 11 are given as 15 f i i n t ω 0 n i x p d ω 0 16 f i e x t ω 0 ρ 0 n i b d ω 0 γ 0 t n i t 0 d γ 0 t where d ω 0 h d γ 0 and t 0 denotes the traction force and the internal and external moment vector in eq 12 are expressed as follows 17 m i i n t ω 0 h 2 n i x p y i d ω 0 18 m i e x t ω 0 ρ 0 h 2 n i y i b d ω 0 γ 0 t h 2 n i y i t 0 d γ 0 t 2 4 time integration scheme and essential boundary conditions to update the displacement and rotations firstly the linear and angular accelerations can be calculated by eqs 11 and 12 then the newmark time integration scheme is adopted to update the displacement and rotations for instance in the linear momentum equation eq 11 the mass matrix has been diagonalized by the row sum lumped technique thus the linear acceleration of node i can be calculated by 19 u i 1 m i f i e x t f i i n t after the acceleration at t is obtained the following formula peng et al 2019 is employed to predict the velocity and displacement at t δ t 20 u t δ t p u t δ t u t δ t 2 2 1 2 β u t 21 u t δ t p u t 1 γ δ t u t where δ t denotes the time increment β and γ are parameters in all simulations β 0 and γ 0 5 are adopted the strain and stress tensor can be calculated by the predicted deform configuration and the internal force at t δ t can be obtained therefore the acceleration at t δ t is got finally the velocity and displacement at t δ t is corrected by 22 u t δ t u t δ t p β δ t 2 u t δ t 23 u t δ t u t δ t p γ δ t u t δ t the same scheme is employed to update the angular displacements and velocities for the enforcement of the essential boundary conditions the d alembert s principle günther and liu 1998 is adopted 2 5 simulation of stiffened shells and fiber update scheme for the simulation of stiffened shells a support domain cutting scheme is developed in this scheme the support domain of a stress point not only influenced by the distance between the two points but also related to which component the two points located for detail reader may refer to peng et al 2019 in present work the shell formulation is based on the mindlin shell theory therefore the fiber direction should be updated explicitly the rotation operator based on the quaternion is adopted which can be expressed as follows 24 p t q θ p 0 q θ 1 where p is a pure quaternion which is related to the fiber vector q θ is related to the rotation angle and is a unit quaternion therefore its inverse q θ 1 can be obtained simply by changing the sign of its imaginary components we have 25 p t 0 y 1 i y 2 j y 3 k 26 q θ cos θ 2 sin θ 2 θ x θ i sin θ 2 θ y θ j sin θ 2 θ z θ k 27 q θ 1 cos θ 2 sin θ 2 θ x θ i sin θ 2 θ y θ j sin θ 2 θ z θ k where y 1 y 2 and y 3 denote the three components of the fiber vector y θ x θ y and θ z denote the rotation angles around three axis and θ θ i j k is the unit basis vector of the global coordinate system it should be noticed that the product of two quaternions in eq 24 is different from both the dot and cross product of two vectors for detail readers may refer to a comprehensive introduction by kuipers 1999 3 elastoplastic model of shell in present work the nonlinear plasticity model for shell developed by simo and kennedy 1992 has been modified the stress tensor of the gauss point in the shell thickness direction instead of the stress resultants is chosen as the input of the constitutive algorithm 3 1 basic equations of the multi surface elastoplastic model consider that a node inital located at x moves to x in the current configuration then the deformation gradient tensor is calculated by 28 f i j x i x j i n i x j x i i h 2 ζ n i x j y i i where i j 1 2 3 the determinant of f is denoted as j det f the almansi strain is calculated by the deformation gradient 29 ε 1 2 i f t f 1 in present work the strain tensor is divided into elastic and plastic parts ε ε e ε p based on an additive decomposition karaoulanis 2013 where ε e and ε p denote the elastic and plastic part of the strain tensor respectively the constitutive model for the so called hyperelastic material is the simplest in which the stress response is governed by a strain energy function w which depending on the elastic deformations therefore the helmholtz free energy potential ψ can be decomposed into the strain energy function w ε e and the hardening energy function which related to the internal variable eberlein and wriggers 1999 30 ψ ε ε p r α w ε e h r α where r and α denote the isotropic and kinematic hardening state variable respectively since the damage of material has not been taken into account we have r p where p denotes the accumulate plastic strain following the constraint of isotropy the local dissipation inequality is obtained based on the second law of thermodynamics in the absence of thermal terms the dissipation function can be expressed d σ ε ψ 0 and which can be expanded as 31 d σ w ε e ε e σ ε p h r r h α α 0 then the constitutive relations for cauchy stress and hardening variable are derived from eq 31 truesdell and noll 2004 32 σ w ε e q h r β h α where q denotes the isotropic hardening stress variable β denotes the uniaxial kinematic back stress tensor then the clausius planck constitutive inequality eq 31 takes the reduced form 33 d σ ε p q r β α 0 by assuming the principle of maximum plastic dissipation we consider a maximization problem with inequality constraints maximize d subject to φ σ q β 0 where φ is the yield function of plastic criterion this maximization problem under constraints can be solved by constructing the following lagrange function 34 l σ q β γ d σ q β γ φ σ q β where γ is the so called plastic multiplier according to the kuhn tucker theorem maximum plastic dissipation can be obtained if γ satisfies 35 γ 0 φ 0 γ φ 0 36 ε p γ φ σ 37 r γ φ q 38 α γ φ β where eq 35 is the loading unloading conditions and eq 36 38 is the evolution equations for the rate of plastic strain isotropic and kinematic hardening variables 3 2 yield function under zero normal stress condition based on the general framework above we now establish the elastoplastic model for shell structure since the degenerated solid approach is adopted the variables in the constitutive equations need to be projected onto the shell reference surface for instance the stress tensor has to be transformed into the local coordinate system σ l q t σ g q in the sequel all the calculations are carried out in the local coordinate system for writing simplicity superscript l is omitted in present work the standard von mises yield criterion is adopted which is suitable for many applications in metal plasticity and the yield function can be expressed as 39 φ 3 j 2 σ y where j 2 is the second deviatoric stress invariant σ y denotes the yield stress and σ y κ r κ 0 q where κ 0 denotes the initial yield stress to eliminate the square root eq 39 is rewritten as φ 3 j 2 κ 2 κ 0 by considering the zero normal stress condition σ 33 0 we have 40 φ 1 κ 0 σ 11 2 σ 22 2 3 σ 12 2 σ 11 σ 22 3 σ 13 2 3 σ 23 2 κ 2 κ 0 the equation above can be expressed into matrix form 41 φ σ t a σ κ 2 κ 0 where σ has been rewritten into a column vector and a is a coefficient matrix we have 42 σ t σ 11 σ 22 σ 12 σ 13 σ 23 43 a 1 κ 0 p 0 0 3 i 2 p 1 1 2 0 1 2 1 0 0 0 3 where i n denotes the rank n identity matrix if the kinematic hardening is taken into account then the back stress should be considered 44 φ σ β t a σ β κ 2 κ 0 to express the stress strain relation into matrix form similar to eq 42 the strain tensor is rewritten into column vectors ε t ε 11 ε 22 ε 12 ε 13 ε 23 then the strain energy function is assumed to have the following form 45 w 1 2 ε ε p t c ε ε p where c 2 w ε e ε e is the elastic tensor since the strain tensor is rewritten into a vector the elastic tensor is reduced from a fourth order tensor to a second order tensor thus we have 46 c c n 0 0 g s i 2 c n e 1 ν 2 1 ν 0 ν 1 0 0 0 1 ν 2 where e is the young s modulus and ν is the poisson s ratio g s g k s in which g and k s are denote the shear modulus and shear correction factor respectively similarly the hardening potential is also assumed to be quadratic 47 h 1 2 e p r 2 1 2 α t d α where e p and d 2 3 h i 5 denote the isotropic and kinematic hardening modulus respectively substituting eqs 45 and 47 into eq 32 then we have 48 σ w ε e c ε e q e p r β d α 3 3 elastoplastic return mapping algorithm the main algorithmic problem to be solved in this section is to update the field ε n ε n p r n α n at t n to ε n 1 ε n 1 p r n 1 α n 1 at t n 1 firstly we assumed that ε n 1 p ε n p and α n 1 α n then the trail stress and trial back stress at the n 1 time step are obtained 49 σ n 1 t r i a l c ε n 1 c ε n p 50 β n 1 t r i a l d α n substituting eq 49 into eq 44 we have 51 φ n 1 t r i a l σ n 1 t r i a l β n 1 t r i a l t a σ n 1 t r i a l β n 1 t r i a l κ 2 r κ 0 0 if φ n 1 t r i a l 0 which indicates that the material is in an elastic loading or unloading state and there is no new plastic deformation occurs then we set n 1 n 1 t r i a l if the φ n 1 t r i a l 0 which indicates that the material is in the plastic loading state thus to make the stress state return to the yield surface the nonlinear system of equations below has to be solved 52 σ n 1 σ n 1 t r i a l c δ ε n 1 p 53 β n 1 β n 1 t r i a l d δ α n 1 54 φ n 1 σ q β 0 where δ ε n 1 p and δ α n 1 denote the increment of plastic strain and hardening variables in the n 1 time step respectively and they can be calculated by substituting eq 44 into eqs 36 and 38 furthermore we can observe that there is only one unknown variable γ n 1 in eq 52 54 all of the following efforts are for solving γ n 1 and the newton iteration scheme is adopted the yield function for the k th iteration step is expressed as follows 55 φ n 1 k σ n 1 k β n 1 k t a σ n 1 k β n 1 k κ 2 r n 1 k κ 0 0 where the stress and back stress in k iteration step and can be expressed as follows 56 σ n 1 k β n 1 k i 5 γ n 1 k 2 ca 4 3 h a 1 σ n 1 t r i a l β n 1 t r i a l where 57 2 ca 4 3 h a 1 κ 0 2 c n p 4 3 h p 0 0 3 g s i 2 the matrix c and p have the same characteristic subspaces simo and kennedy 1992 that is 58 p q λ p q t c n q λ c n q t where q 1 q t is a orthogonal matrix the diagonal matrices λ p and λ c n is 59 q 1 2 1 1 0 1 1 0 0 0 2 λ p 1 2 0 0 0 3 2 0 0 0 3 λ c n e 1 ν 0 0 0 e 1 ν 0 0 0 e 2 1 ν by considering ξ n 1 k q 5 t σ n 1 k β n 1 k where 60 q 5 q t 0 0 i 2 then eq 56 can be diagonalized and have a remarkably simple form 61 ξ n 1 k s ξ n 1 t r i a l where s is a diagonal matrix and can be expressed as follows 62 s ξ 1 0 0 1 3 g s γ n 1 k κ 0 1 i 2 in which 63 ξ i 3 γ n 1 k κ 0 2 λ c n λ p 4 3 h λ p substituting eq 61 into the yield function in k iteration step eq 55 we have 64 φ n 1 k ξ n 1 t r i a l t s t ωs ξ n 1 t r i a l κ 2 r n 1 k κ 0 0 where ω q 5 t a q 5 is a constant matrix the trial stress state is invariable during the iterative algorithm so the yield function φ is a function only related to γ then we can solve the variable γ by the newton iteration 65 γ n 1 k 1 γ n 1 k φ γ φ n 1 k the finial stress state is obtained by substituting the convergence solution of γ into eqs 52 and 53 in the equation above we have 66 γ φ 2 ξ n 1 t r i a l t s t ω γ s ξ n 1 t r i a l 2 κ γ κ κ 0 0 where γ s s γ s 1 s and we have 67 γ s 1 1 κ 0 2 λ c n λ p 4 3 h λ p 0 0 3 g s i 2 considering that κ κ 0 q and q r e p we have 68 γ κ κ r r γ e p 2 κ κ 0 the main numerical algorithm is shown in algorithm 1 algorithm 1 return mapping algorithm image 1 4 numerical examples to verify the reliability and accuracy of the present meshfree model we studied several numerical examples in this section in the rkpm shell formulation the bilinear shape function and one stress point per integration cell are adopted peng et al 2018 the illustration of the integration cell is shown in fig 2 since the order of the integration scheme is less than the order of the shape function it shall be regarded as a reduced integration by which shear locking is eliminated besides for the integration in the shell thickness three gauss points are employed 4 1 a simply supported plate loaded by pressure impulse in this section the elasto plastic dynamic response of a simply supported plate under uniform step pressure is studied the dimension of the plate and the material parameters are shown in fig 2 the initial yield stress is κ 0 2 068 10 8 pa and perfect plasticity without hardening is assumed in calculation uniformly distributed particles are used to discretize the structure the total number of particles are 5 5 9 9 and 27 27 respectively the result calculated by abaqus 64 64 s4r elements are used is adopted as reference the displacement histories of the center point are shown in fig 3 in which the results calculated by the present method is compared with the reference result obtained by abaqus from which we can see that the results calculated by rkpm converge to the reference results very quickly the results obtained by 27 27 particles are almost identical with the fem result which verifies the convergence and accuracy of the present method due to the material plastic the deflection of the center point can not return to its initial state during the vibration as shown in fig 3 in rkpm shell the average number of nodes in the support domain is about 12 while in the s4r shell element in abaqus the stress point is connected with four nodes so the calculation efficiency of rkpm is lower than that of fem the vibration of the plate in 0 2s is simulated by rkpm and fem on one intel i7 7700k processor the comparison of the computational cost of these two methods is shown in fig 4 from which we can see that the time cost by rkpm is about four times than fem 4 2 roof loaded by velocity impulse in this section the present plastic model applied in shell dynamic analysis is considered a 120 cylindrical panel subjected to the velocity impulse is studied an initial velocity distribution is specified the problem dimensions and material parameters are summarized in fig 5 the curved ends of the roof are simply supported and the side boundaries are clamped an initial velocity of 143 51 m s normal to the shell surface is loaded on a region marked in fig 5 two particle spacing are used to solve this problem the total number of particles is 556 and 2242 respectively the displacement histories of the gauging point initially located at x 0 y 0 0762 m and z 0 167 m are shown in fig 6 the results calculated by rkpm are compared with the reference simulations using 224 and 4512 belytschko tsay elements respectively benson et al 2010 as well as experimental data from morino et al 1971 since the bilinear shape function with one stress point per integration cell is applied no locking is observed in the numerical simulation and it was shown that the results obtained by the present model are in good agreement with the reference results fig 7 a gives the residual deformation of the crown line of the roof and fig 7 b gives the residual deformation of a radial cross section in which the experimental data is plotted as reference 4 3 elastoplastic response of a simply supported plate the inflation of a square plate is presented in this section this numerical example is popular to verify the shell formulations within finite elasto plastic strains and has been considered by a number of authors eberlein and wriggers 1999 betsch and stein 1999 klinkel et al 2008 the geometry of the problem and material data are summarized in fig 8 the edges of the plate are simply supported that only the vertical displacements u 3 are restricted to zero and a constant pressure load p 0 10 4 pa is applied here perfect plasticity without hardening is assumed in the simulation the shell is discretized by 49 49 particles the load displacement curve of the center node of the plate is shown in fig 9 and the results obtained by eberlein and wriggers 1999 and betsch and stein 1999 are adopted as references in which the load level denotes p p 0 it was shown that our results are in agreement with the reference results this example verifies the applicability of the present model to the simulation of extreme bending deformations the deformed configuration with a contour plot of the equivalent plastic strain for a pressure load of p 60 p 0 is shown in fig 10 which shows a significant change of the shell surface during the deformation 4 4 pinched hemisphere with isotropic hardening a hemisphere loaded by two inward and two outward forces 90 apart the plastic model with isotropic hardening is adopted the geometry parameters and material properties are shown in fig 11 this example has been studied previously by a number of authors simo and kennedy 1992 eberlein and wriggers 1999 betsch and stein 1999 in the simulation the shell is discretized by 2883 particles the applied loads f versus the radial displacement is plotted in fig 12 and the results presented in previous literatures simo and kennedy 1992 eberlein and wriggers 1999 betsch and stein 1999 are chosen as references from which it shows that the results obtained by the present plastic model are in good agreement with the results presented in eberlein and wriggers 1999 and betsch and stein 1999 since the stress resultants plasticity model leads to less hardening when compared with j 2 model there is a divergence between the present results and the results obtained by simo and kennedy 1992 the deformed configuration of the hemisphere at a load level of f 30 f 0 is shown in fig 13 in which the contours of the equivalent plastic strains are included see fig 14 4 5 elastoplastic deformation of a ship cabin under impact pressure in the previous sections the accuracy and effectiveness of present elastoplastic model applied in simple shell structures are verified in this section the elastoplastic response of a ship cabin under impact pressure load is studied the calculation model comes from the research by zhu et al 2004 the dimensions of the structure are illustrated in fig 15 in which the length unit is millimeter the defensive longitudinal bulkhead and the main deck are made of low alloy steel and the other components are made of plain steel the material parameters of these two steel are summarized in table 1 in the simulation the linear hardening is adopted and the damage response of the material is ignored since the strain rate effect is important in the impact problem it can not be neglected in present study power law expression is adopted therefore the yield stress is obtained 69 κ r 1 ε e q p c 1 p κ 0 e p r where ε e q p denote the equivalent plastic strain rate c and p is the strain rate hardening coefficients in calculation the water resistant longitudinal bulkhead is clamped and the impact pressure is loaded on the broadside shell which is represented in fig 15 by a red line the temporal and spatial distribution of the pressure load are governed by the expression zamyshlyaev and yakovlev 1973 list below 70 p 44 1 10 6 0 2714 x x c 1 51 e t 2 84 10 5 where x is the coordinate of a stress point on the loading surface and x c denotes the center coordinate which is 0 7 0 25 0 75 in practice four different particle spacings has been adopted in these four cases the total number of particles used to discretize the model are 23274 41166 96595 and 145275 respectively the particle view of the ship cabin while particle spacing is 20 mm is shown in fig 16 the fixed time increment is adopted in simulation the models with different particle spacing are calculated and the displacement contour of the ship cabin is shown in fig 17 while the particle spacing on the left is 20 mm and on the right is 10 mm from the figure it can be seen that the displacement of the maximum load point increases rapidly after loading and at the initial moment due to the reinforcement of the stiffener the displacement of the outboard shell near the stiffener is relatively small with the development of deformation the displacement of the outboard shell reaches the peak and because of the influence of plasticity the displacement of the outboard stay at the plateau although the pressure load decreased near to zero the time history of the displacement at the maximum loading point is shown in fig 19 and the result calculated by ls dyna with mesh size equal to 10 mm is adopted as the reference from which we can see that the displacement of the gauging point increases rapidly at the beginning and reaches a peak at 1 5 ms subsequently the displacement declines but due to the plasticity of the material there is relatively large residual displacement exist and the displacement fluctuates near the final equilibrium state by comparing these curves we can see that the displacement of the gauging point increases while the particle spacing decreases the calculation converges because of the displacement of the gauging point almost the same when particle spacing is 10 mm or 8 mm and the result calculated by rkpm are in good agreement with the fem result in fig 18 the comparision of the particle views of the stiffener when the particle spacings are 20 mm and 10 mm is given it can be seen from the figure that there are only three nodes in the width direction of panel and web of the stiffeners when particle spacing is 20 mm but when particle spacing is 10 mm there are at least five nodes in the width direction of panel and web of the stiffeners considering that the displacement converges when the particle spacing is less than 10 mm the rule of particle spacing selection can be obtained that is at least five nodes are required in the smaller scale direction of the stiffeners 4 6 damage response of ship structure under blast shock wave in this section to verify the applicability of the present meshfree approach in the analysis of real engineering structure the dynamic response of the warship under the near field underwater shock wave is studied in calculation the average particle spacing is chosen as 0 4 m in some specialized area the particle spacing may little than 0 4 m and a total of 123990 particles are used to discretize the structure the particle view of the warship is illustrated in fig 20 in the modeling of ship structure only the large stiffener and main bulkheads are considered besides the whole stiffened shell structure is discretized by rkpm shell element since the pre processing capability of the present code is still weak we ignore the small stiffener to simplify the modeling procedure the thickness of the outboard shell is set to 12 mm while the others shell are set to 7 mm the material of the calculation model is low alloy steel whose material parameters is list in table 1 in the previous section in the simulation 100 kg tnt is placed below the amidship considering that the edge length of 100 kg cubic tnt is about 0 4 m which is equal to the average particle spacing if we consider the fluid structure interaction fsi the particle spacing should be shrunk at least 4 times which will result in a tremendous increase in the number of particles since the objective is to verify the effectiveness of the structural algorithm the fsi effect is neglected and only the underwater shock wave is taken into account moreover in the simulation no essential boundary conditions are applied and gravity is not considered the temporal and spatial distribution of the shock wave are calculated using the empirical formula zamyshlyaev and yakovlev 1973 when the distance between the load point and the center of tnt is 2 6 times to the tnt radius the magnitude of shock wave is calculated by the formula developed by ming et al 2016 in calculation a fixed time step of δ t 1 0 10 5 s is adopted the contours of the mises equivalent stress of the warship at several typical time are shown in fig 21 from which it can be seen that a local depression occurred at the bottom of the amidship as soon as the simulation begins after that the deformation of the ship further increases and finally the depression of the ship hull is expanded to the range of four longitudinal compartments which can be observed in fig 22 the comparison of the deformed configuration of the ship at t 200 ms calculated by the present method and ls dyna is shown in fig 23 from which we can see that the results calculated by rkpm are in good agreement with fem to some extent in the simulation the computation took about 304 min on one intel i7 7700k processor while using rkpm as a contrast it took about 3034s while using ls dyna which is about six times less than rkpm the final contour of the equivalent plastic strain of the ship hull is shown in fig 24 from which we can see that there is a 5 0m 2 67 m rectangular damage hole is finally produced 5 conclusions in present work a meshfree approach for the numerical simulation of the elasto plasticity response of the real ship structure is established the rkpm shell formulation based on mindlin shell theory is adopted and a general elasto plasticity constitutive model for shell structures is presented the yield criterion is derived directly through the classic mises yield criterion and the zero normal stress assumption is implemented by removing the normal stress component from the yield function in calculation the yield function is put into matrix format by diagonalizing the matrices and avoid the stress resultants the complexity of the return mapping algorithm is reduced first several numerical examples are presented to verify the reliability of the proposed elastoplasticity model the results obtained by rkpm are in good agreement with the reference results which demonstrates that the present numerical model has good accuracy then the dynamic responese of a ship cabin under impact load is studied the applicability of the present meshfree approach in dynamic analysis of complex shell structure is verified and in the simulation to ensure a reliable result there should be at least 5 particles in the small scale direction of the ribs finally the damage response of a real ship structure subjected to underwater explosion shock wave is studied the capability of the present meshfree approach applied in the engineering problem is verified yet few researches have been done on the application of the meshfree methods in dynamic analysis of complex structure analysis we believe that the present work lays a solid foundation for future application of the meshfree method in complex engineering structures analysis acknowledgements the authors thank the national numerical wind tunnel project of china 2018 zt2b05 and industrial technology development program of china jcky2018604c010 jcky2017604c002 for their support 
