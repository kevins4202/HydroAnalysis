index,text
3750,forecast uncertainty in real time flood forecasting is the primary source of risk regarding reservoir flood control operation affecting both reliability and safety of the entire system informing reservoir operation for real time flood control coping with forecast uncertainty encourages overall robust control of risk probability vulnerability and resilience of upstream and downstream protection areas current stochastic programming models or chance constrained programming models ccp focuses on reducing either risk loss or vulnerability thereby failing to ensure systematic control this study established a robust multiobjective operation and risk decision making model to inform reservoir operations the proposed model includes three modules first a copula function was applied to capture multidimensional temporal dependences of forecast uncertainties following which stochastic inflow scenarios were generated second a robust multiobjective optimization rmoo model was established with the objectives of minimizing the probability of risk events conditional value at risk of risk loss vulnerability and the maximum sequential duration for both upstream and downstream areas then an adaptive reference multiobjective evolutionary algorithm was used to solve the model and obtain noninferior solutions finally the topsis multicriteria decision making method was introduced to select the compromise solution methodologies were verified by application to xianghongdian reservoir china the main findings were as follows 1 the copula function effectively captured the multidimensional positive temporal dependences of forecast uncertainties 2 rmoo provided more widely distributed noninferior solutions than ccp and performed better in lowering vulnerability of the system 3 rmoo reduced the maximum release by 135 6 m3 s 7 33 by increasing prerelease before the occurrence of flood peak the proposed methodologies provide insights for supporting robust control of real time operations of a reservoir system through simultaneous control of flood risk probability vulnerability and resilience keywords reservoir operation uncertainty multiobjective robust optimization conditional value at risk copula function 1 introduction floods which represent one of the most devastating natural disasters can cause tremendous hazards to sustainable socioeconomic development aerts et al 2018 reservoirs are important engineering structures regarding flood protection and reservoir operation for flood control can be an effective non engineering measure for reducing flood related losses damage real time flood control operation seeks an informed storage release strategy for reservoirs based on the forecast flow process xu 2021 thus the skill and precision of flood forecasting are closely related to the effectiveness of reservoir operations zhu et al 2017 flood control operation requires coordination of multiple competing objectives that include ensuring the safety of upstream and downstream protection areas while attempting floodwater conservation given that a flood process varies temporally decision makers might adopt different operational strategies at different stages therefore real time flood control operation represents a complex multiobjective multistage time sensitive and risk decision making process xu et al 2020 flood control operation via reservoir operation primarily uses reservoir storage to regulate and change the temporal and spatial process of the flood thus reducing the overall potential flood damage in upstream and downstream areas however limited by the timeliness needs of real time flood control operation and current technologies in assessing flood damage accurately surrogate indices of flood damage are commonly employed as the optimized objectives of flood control operation including risk probability vulnerability and resilience influenced by various uncertain factors such as real time forecast uncertainties deviation in the actual operating water level or release from the expected planned results could occur resulting in potential risk flood damage would occur when the actual water level or release exceeds the safe threshold and the expected damage is highly associated with the risk probability the degree vulnerability and the inundation duration resilience of the risky event focusing on lowering these three indicators in the real time flood control operation many studies have successfully applied the deterministic simulation or optimization models combined with sensitive analysis or parameter scenario analysis labadie 2004 to find a feasible or optimal operation strategy under an acceptable risk level nevertheless these methods which do not aim to directly reduce risk indices could be trapped by infeasibility and sub optimality and yield risk vulnerable operation strategies considering the influence of forecasting error it is critical to inform real time flood control operation based on inaccurate forecast information by characterizing forecast uncertainty as random variables or random processes stochastic optimization models which directly optimize risk indices provide superior solutions than deterministic models specifically stochastic programming sp provides an effective solution to reduce vulnerability and chance constrained programming ccp is a powerful model for lowering or controlling the probability of risk events specifically in model formulation sp usually minimizes vulnerability index for hedging or dispersing flood risk loss whereas ccp often sets a flood risk limit as a constraint for exploring operational strategies that could avoid risk events or lower risk probability with budgeted chance xu et al 2017 chen et al 2017 established a multiobjective reservoir operation model to minimize the upstream water level and the maximum release based on deterministic flood forecasts zhu et al 2017 proposed a multiobjective sp model for modeling the entire process of flood control through flood forecasting reservoir operation and a decision making procedure chain considering forecast uncertainties in this chain the flood forecast module used the martingale model to generate stochastic scenarios and the flood control operation module protected the upstream and downstream areas by lowering the probability of flood risk events chen et al 2020a established a multiobjective flood control operation model that considered multiple uncertain factors and analyzed the impact of uncertainties in reservoir natural inflow and lateral flow on flood risk their case study on the middle reaches of the huai river china demonstrated that the proposed model could reduce the overall risk of the reservoir system by balancing competing objectives in comparison with deterministic optimization models sp and ccp enhance the efficiency and improve the reliability of a flood control system when coping with forecast uncertainties watkins and mckinney 1997 owing to the characteristics of timeliness requirement of real time flood control operation incommensurability of flood damage in upstream and downstream areas and complexity of the decision making process decision makers often need to systematically consider the competing relationship tradeoff and incremental changes among risk indicators and finally select the compromise solution through group decision making or preference coordination borgomeo et al 2018 meanwhile when facing flood events at different magnitudes or return periods decision making preference would vary according to the priority of protecting upstream and downstream protection areas for instance when a small scale flood event is predicted to occur the strategy is expected to lower the overall risk probability and avoid the occurrence of the risk event when a medium scale flood event is anticipated flood control operation needs to coordinate the relationship between risk probability and vulnerability hsu et al 2015 and when a large scale or catastrophic flood event is expected reservoir operation needs to lower the vulnerability and resilience indicators for hedging or reducing the total flood damage and restoring the system to the normal state as soon as possible these three risk indicators and the competing relationship of flood control operation in upstream and downstream areas formulate a multiobjective risk assessment regulation and decision making problem there are no perfect solutions obtaining the optimal levels at all indicators simultaneously instead it is only possible to find a noninferior solution set that could comprehensively systematically and objectively reflect the noninferior relationship among upstream and downstream risk indicators although previous literature reports success in the field of multiobjective flood control operation optimization few studies attempt to investigate the entire spectral of risk indices for providing holistic risk management strategies upon decision making existing sp models mainly focus on minimizing or hedging flood risk loss zhao et al 2014 which could be one sided when focusing on risk reduction such that the optimized strategies may lead to the frequent occurrence of risk events ccp models are constructed mostly for lowering the probability of flood risk events consequently high losses could be resulted when operating large scale floods the desire to seek simultaneous controls on risk probability vulnerability and resilience under uncertainty motivates the application of robust optimization control in reservoir operation robust optimization which seeks robust strategies for maintaining overall performance under oscillations watkins and mckinney 1997 provides a modeling approach for synthesized risk management ahmadi et al 2010 ortiz partida et al 2019 pan et al 2015 robust optimization models are divided into two types nonprobabilistic and probabilistic models ben tal et al 2009 nonprobabilistic models optimize the model performance under all possible cases of considered uncertainty resulting in a rather conservative operation strategy that attempts to avoid risk if possible gong et al 2021 nonprobabilistic models are suitable for the prevention of serious flood events which could cause significant economic loss or casualties such as dam failure levee failure but lack flexibility in dealing with common flood events in contrast probabilistic models which optimizes the model performance under budgeted risk indices for allowing the occurrences of acceptable risks offer more flexibility and applicability ke and chung 2016 different from singular objective sp and ccp models that focus on reducing risk probability or vulnerability a robust multiobjective optimization rmoo model which minimizes the risk probability vulnerability and resilience de bruijn 2005 of both upstream and downstream protection areas could provide a variety of noninferior solutions for flood control operation with varying levels of robustness thereafter decision makers could determine suitable compromise by incorporating their preferences through risk decision making to bridge the knowledge gaps the goal of this study was to comprehensively optimize flood risk probability vulnerability and resilience for providing robust compromise strategies of real time reservoir operation for flood control under forecast uncertainty the main contributions were to establish an rmoo model that could simultaneously control the complete set of risk indices of upstream and downstream protection areas and reveal the competing and harmony relationship among these indices through the analysis of the obtained noninferior solutions specifically the model framework includes two modules module i characterizes forecast uncertainty and simulates stochastic inflow scenarios it captures the multidimensional temporal dependence structure of forecast errors and builds a joint distribution using a copula function for refining uncertainty characterization thereafter it generates stochastic inflow scenarios as input for the flood control model via monte carlo simulation module ii establishes the robust multiobjective flood control operation model the conditional value at risk cvar rockafellar and uryasev 2002 was introduced to represent the surrogate extreme loss of flood in the tail of distribution while risk probability and maximum sequential duration of inundation were also incorporated in the objectives solving the established model provides candidate noninferior solutions with varied robustness finally the robust compromise solution which includes risk mitigation measures was obtained by a popular multicriteria risk decision making module technique for order preference via similarity to an ideal solution topsis the proposed model was applied to a large reservoir on the huai river china and multiobjective ccp was applied as a comparative model for verification of the effectiveness of the proposed methodologies 2 methodology a flowchart of the proposed robust multiobjective operation and risk decision making framework is presented in fig 1 section 2 1 describes the identification of risk sources and the method adopted for simulation of stochastic inflow scenarios section 2 2 establishes the rmoo model for flood control operation considering risk probability vulnerability and resilience section 2 3 presents the multicriteria risk decision making model topsis 2 1 identification of risk sources and simulation of stochastic inflow scenarios forecast inflow represents fundamental information for real time flood control operation and forecast uncertainties were considered the primary source of risk in this study in this section the stochastic characteristics and joint probability function of risk sources are captured using a copula function then the forecast uncertainties that match the characteristics of the observed samples are simulated on the basis of the simulated error scenarios discretized inflow scenarios are generated coupled with real time point forecast processes which provide probabilistic inputs for the reservoir flood control operation forecast uncertainties are defined as the differences between the observed flow and the forecast flow derived from historical re forecasts 1 ξ τ i n t i n t τ t where ξ τ is the forecast uncertainty error at lead time τ m3 s in t is the observed flow at time t m3 s and i n t τ τ is the average forecast inflow from time t τ to time t lead time τ m3 s it is assumed that the forecast uncertainties of different lead time are stochastic processes and that their statistical characteristics can be reproduced from past samples thereby providing information for parameter calibration and model simulation chen et al 2016 zhao et al 2013 xu et al 2021b in this study inflow scenarios considering the full order temporal dependences of the forecast uncertainties were generated using a copula function this simulation method introduced in detail by xu et al 2020 2021a can be divided into three steps 1 establishing a marginal distribution by selecting the optimal marginal distribution from samples used commonly in hydrological analysis sharifi et al 2019 chen et al 2020a chen et al 2020b 2 establishing a joint distribution using a t copula function to quantify the multiorder temporal dependences of the forecast uncertainties in comparison with other structures the t copula function produces an elaborate description of multidimensional dependences and meets the requirements regarding time overheads wang et al 2019 tosunoglu et al 2020 breymann et al 2003 3 generating stochastic forecast inflow scenarios based on the established marginal and joint distribution while forecast inflow scenarios insn is the forecast inflow of scenario n are generated via mento carlo simulation xu et al 2019 2 2 robust multiobjective optimization rmoo model for flood control operation owing to uncertainties decision makers must focus on risk probability vulnerability and resilience control of risk events in addition to risk probability it is necessary to adopt another type of index that can represent flood damage in adverse scenarios to lower vulnerability and an appropriate index to denote resilience of the flood control system 2 2 1 risk probability vulnerability and resilience indices i risk probability risk probability is the most applied objective to reduce the potential frequency of flood risk events this study set two kinds of risk probability objectives for upstream and downstream protection areas respectively which are the maximum probability of the water level and reservoir release exceeding the safety threshold ii vulnerability robust control not only reduces the likelihood of undesirable events but also lowers the associated possible loss borrowing from the field of finance value at risk var is the minimum possible loss at the worst α confidence level α 0 1 quantile owing to the inability of var in characterizing the tail distribution of loss beyond α quantile conditional value at risk cvar index which was first proposed by rockafellar and uryasev 2002 defines the expected loss beyond the worst α of all cases the relationship between cvar and var is illustrated in fig 2 and cvar represents the average loss that exceeds var cvar is considered as a more complete risk measure than var because it could provide more information about the loss estimation for different shapes of tails of loss function which is important when assessing the extreme loss of flood events therefore cvar has since been applied to evaluate loss index in water resources allocation piantadosi et al 2008 yamout et al 2007 hu et al 2016 shao et al 2011 for a specific loss function l cvar can be described as in eqs 2 and 3 2 cvar α l e l l var α l 1 α var α l l pdf l d l 3 var α l min cdf l α where l is the loss function α is the confidence level var α l is the minimum risk loss at confidence level α pdf is the probability density function and cdf is the cumulative probability function the model applied cvar to represent the expected surrogate loss of all worst α cases that might occur during flood control operation in conjunction with the risk probability index the model can ensure the reliability and safety requirements of robust control iii resilience furthermore to realize the effective control and enhance the performance of system resilience this study applied a simplified resilience control objective minimizing the maximum sequential duration of inundation in upstream and downstream areas the duration that operating water level or release exceeds the safety threshold as indicated in fig 3 the formulated objectives and constraints are shown in section 2 2 2 2 2 2 model formulation i objective functions flood control operation of a reservoir refers to the utilization of flood control projects to regulate flood processes for ensuring the overall effect of flood protection for upstream and downstream protection areas the proposed model minimizes the maximum risk probability maximum cvar and maximum sequential duration during the operation horizon for both upstream and downstream areas including the following six objectives objective 1 minimize the maximum probability of the water level exceeding the safety threshold minimize upstream risk probability the maximum probability of the water level exceeding the safety threshold at a certain period is minimized regarding the stochastic inflow scenarios this objective which represents control over the probability of adverse events in upstream areas is characterized by eq 4 4 min f 1 min max count n z s n t z sa n t 1 to t where z s n t is the simulated water level of scenarios n m zsa is the water level safety threshold m t is the number of operation periods h n is the total number of scenarios dimensionless and count is the counting function objective 2 minimize the maximum probability of reservoir release exceeding the safety threshold minimize downstream risk probability similar to objective 1 objective 2 represents control over the probability of risk events in which reservoir release exceeds the threshold this objective can be expressed as in eq 5 5 min f 2 min max count n q s n t q sa n t 1 t o t where q s n t is the simulated reservoir release of scenarios n m3 s and qsa is the release safety threshold m3 s objective 3 minimize the maximum cvar of the loss ratio of flood protection storage minimize surrogate loss of upstream risk theoretically studies could apply depth damage functions to determine the vulnerability of protection region when being exposed to flood as depth damage function provides valuable information for damage reduction with damage or damage percentage identified with water depth yet the information terrain spatial distribution of socio economic properties for calibrating adequate functions is usually scarce a feasible alternative is to use the highest water level as a surrogate measure for rationalizing reservoir operation because the inundation loss caused by a flood in the upstream protection area is often positively correlated with the highest reservoir water level or storage meyer et al 2013 gerl et al 2016 therefore the loss ratio percentage of flood protection storage is selected as the approximate risk loss for the upstream area the function of the loss ratio percentage of flood protection storage at scenario n l zs n t is calculated as in eq 6 6 l zs n t f z v z s n t z v pro z s n t z 0 z s n t z where fz v is the water level storage curve z is the flood loss identified water level m and vpro is the flood protection storage of the reservoir m3 the corresponding objective established by cvar can be expressed as in eq 7 7 min f 3 min max cvar α l zs n t t 1 to t objective 4 minimize the maximum cvar of the loss ratio percentage of reservoir release safety threshold minimize surrogate loss of downstream risk similarly the loss ratio of reservoir release to the safety threshold is applied as the approximate risk loss for the downstream area and function at scenario n l qs n t can be expressed as in eq 8 8 l qs n t q s n t q s q s a q s n t q s 0 q s n t q s where qs is the flood loss identified water release m3 s accordingly the objective to minimize the downstream risk loss of scenario n can be expressed as in eq 9 9 min f 4 min max cvar α l qs n t t 1 to t objective 5 minimize the maximum sequential duration of upstream inundation the maximum sequential duration of upstream inundation is minimized in each inflow scenario this objective which aims to enhance the resilience performance of upstream flood control operation is characterized by eq 10 10 min f 5 min n 1 n max t t s n t e n z s n t z sa t e n t s n n where t s n t e n is the starting and ending time of sequential duration of inundation of scenarios n respectively objective 6 minimize the maximum sequential duration of downstream inundation similarly the maximum sequential duration of exceeding safety threshold release is minimized this objective is set to enhance the resilience performance in downstream areas as shown in eq 11 11 min f 6 min n 1 n max t t s n t e n q s n t q sa t e n t s n n ii constraints in the optimization model the following equality and inequality constraints are considered constraint 1 mass balance equation 12 v s n t 1 v s n t in s n t q s n t e s t l s t δ t t 1 to t where in s n t is the simulated inflow at time t of scenario n m3 s v s n t is the simulated reservoir storage at time t of scenario n m3 es t is the evaporation at time t m3 ls t is the leakage of reservoir time t m3 and δt is the time interval h note that in the short term real time flood control operation uncertainties caused by evaporation and reservoir leakage have negligible impact on the mass balance xu et al 2018 thus the evaporation and leakage are set to be zero in this study constraint 2 reservoir storage limits 13 v v s n t v where v and v are the lower and upper limits respectively of reservoir storage during the operation m3 constraint 3 reservoir release limits 14 q q s n t q where q and q are the lower and upper limits respectively of reservoir release m3 s constraint 4 reservoir release fluctuation limits 15 q s n t 1 q s n t δ q where δq is the permissible maximum release fluctuation m3 s fluctuation limits ensure riverbank stability and navigational safety of the downstream river channel zhu et al 2017 constraint 5 initial and boundary conditions 16 v s n 1 f z v z ini v s n t 1 v obj where zini is the initial water level m and vobj is target ending storage m3 s which is set according to the specific situation of real time flood control iii generation of noninferior solutions the model applies a recently developed multiobjective evolutionary algorithm adaptive reference multiobjective evolutionary algorithm ar moea to explore and generate the noninferior solutions of the robust multiobjective flood control operation additional details regarding this algorithm can be found in tian et al 2018 ar moea applies an adaptation method to adjust a set of reference points based on the indicator contributions of candidate solutions and it demonstrates superior searching performance and versatility in both regular and irregular pareto fronts ar moea outperforms several other advanced multiobjective evolutionary algorithms e g moea dd nsga iii and rvea for test problems in relation to the searching range and iterative efficiency tian et al 2018 fu et al 2021 to deal with the possible irregularity of pareto fronts when solving the complex multiobjective flood control operation problem ar moea is applied to improve the diversity and representativeness of the noninferior solutions 2 3 multicriteria risk decision making model after generating the candidate solutions reservoir decision makers must select a compromise solution from noninferior candidates on the basis of their knowledge and preferences topsis is a classical method in multicriteria decision making that has been widely discussed in the field of reservoir operation and it could be adopted to consider abundant information such as criteria weights and ideal solutions zhu et al 2017 the compromise solution is often the one for which the weighted distance is closest to the ideal point and farthest from the nadir point the main steps of topsis are elaborated in the following step 1 establish the decision matrix variables in the decision matrix represent lists of candidate solutions columnized by objectives criteria as shown in eq 17 17 x i j f j i i 1 to i j 1 to j where x i j is the j th variable in the i th candidate solution fj i is the j th objective in the i th candidate solution i is the total number of candidate solutions and j is the total number of objectives step 2 normalize the decision matrix as expressed in eq 18 18 nor x i j max x i j x i j max x i j min x i j for benefit criteria x i j min x i j max x i j min x i j for cost criteria where norx i j is the normalized decision matrix step 3 establish the weighted normalized decision matrix as given in eq 19 19 w x i j w j n o r x i j where wx i j is the weighted variable and wj is the weight of the j th variable step 4 calculate the ideal solution w wx 1 wx 2 wxj and the nadir solution w wx 1 wx 2 wxj according to the following rules 20 w x j max w x i j 1 i i w x j min w x i j 1 i i for benefit criteria w x j min w x i j 1 i i w x j max w x i j 1 i i for cost criteria where wxj and wxj are the ideal and nadir points of the j th variable respectively step 5 calculate the euclidean distance between the candidate solutions and the ideal and nadir solutions as shown in eq 21 21 d i j 1 j w x i j w x j 2 d i j 1 j w x i j w x j 2 where di and di are the euclidean distances between the i th candidate solution and the ideal and nadir solutions respectively step 6 calculate the degree of closeness of each candidate solution as described in eq 22 22 cl o i d i d i d i where cloi is the degree of closeness of the i th candidate solution the candidate solution with the highest degree of closeness is the compromise solution selected by topsis 3 case study 3 1 overview of the study area and data 3 1 1 xianghongdian reservoir xianghongdian reservoir xhd is a large reservoir on the pi river which is a tributary of the huai river china xhd has total storage capacity of 2 613 billion m3 and it controls a basin area of 1400 km2 it is a vital flood control project on the upper reaches of the huai river protecting the safety of the mainstream of the huai river and downstream cities such as lu an the xhd basin is affected by the monsoon climate and regional precipitation is concentrated mainly in the flood season of may october flash flooding frequently occurs in this area owing to the specific climatic and topographic conditions and the effective lead time of the river basin is very limited such that high uncertainties can occur within a real time forecast the location of xhd is illustrated in fig 4 and the main parameters used in this study are listed in table 1 note that flood loss identified water release qs was set to 20 safety threshold for water release qsa in this study which is the threshold of turbine release capacity when reservoir release is greater than qs reservoir opens spillway to discharge the surplus water to downstream and reservoir operation status transits from benefit maximization through water resources utilization to loss minimization by reducing flood hazard lu et al 2021 3 1 2 data description the flood forecast system is supported by real time precipitation monitoring and weather forecast products produced by the china meteorological administration these data serve as inputs that drive the hydrological model to generate the forecast inflow this study applied automatic forecast products with forecast horizons of 45 h and a 3 h time interval and the automatic forecast system conducted a rolling horizon forecast product every 3 h with real time updates detailed information regarding forecast and observed data can be found on the anhui water information website http yc wswj net ahsxx lol public public html to fully describe the characteristics of forecast uncertainties this study collected 129 sets of forecast error samples from 12 historical floods average 10 error samples at a certain forecast lead time for each flood of different scales and selected one flood event no 20150809 with re forecast as the study case this flood event was caused by super typhoon soudelor no 1513 in 2015 the whole flood process including decreasing phase began on august 9th at 16 00 local time and ended on august 12th at 18 00 local time duration 74 h and had a return period of approximately 20 years and the average precipitation of the basin was 194 9 mm during the typhoon period 3 2 identification of forecast uncertainties and flood simulation each of four distributions commonly used in hydrological analysis was applied to establish the marginal distribution for the forecast uncertainties at each lead time and the rmse aic and chi square test were applied to evaluate the goodness of fit performance detailed information referring to the establishment of marginal distribution is shown in appendix a on the basis of the established marginal distribution the t copula function was applied to the joint distribution construction of forecast uncertainties with multiorder temporal dependences the correlation coefficient cor values calibrated from observed forecast uncertainties and calculated from simulated forecast uncertainties are illustrated in fig 5 the cor calibrated from observed forecast uncertainties fig 5 a illustrates that flood forecast uncertainties in xhd have high multidimensional temporal dependences attributable to the strong relationship between inflow forecasting and precipitation the correlation coefficients of forecast uncertainties are generally greater than 0 75 meanwhile fig 5 b demonstrates that the t copula function accurately reproduces the multidimensional dependences among the forecast uncertainties on the basis of the established marginal distribution and joint distribution a monte carlo simulation was applied to generate error samples then the simulated samples were added to the average inflow forecast to form stochastic inflow scenarios as shown in fig 6 3 3 robust multiobjective flood control operation applied to xhd 3 3 1 numerical experiments examining robustness the stochastic inflow scenarios generated as described in section 3 2 served as input conditions for the flood control model to verify the performance of the rmoo model a multiobjective ccp model that optimizes only the risk probability of upstream and downstream areas was also built with the same constraints within the modeling the characteristic curves of the reservoir e g stage storage curve and stage release curve were fitted with a quadratic continuous and differentiable function the specific objectives and constraints of the two models are listed in table 2 3 3 2 solving and analyzing noninferior solutions i solving noninferior solutions the simulation model and ar moea were developed on an open source platform i e platemo https github com bimk platemo the detailed calculation parameters were as follows the confidence level α was 0 1 the number of initial populations was 120 and the maximum number of iterations for each population was 10000 the two simulation models rmoo and ccp and the algorithm were implemented under the same condition including the same calculating workstation with intel i7 10700f cpu and 32 gb ram the same maximum number of iterations and the difference of calculating duration for two models is within 5 the distribution of the objectives of the rmoo and ccp models is shown in fig 7 specifically objective 3 4 5 and 6 of the ccp model were calculated directly from noninferior solutions rather than through optimization the upstream and downstream flood risk probabilities of noninferior solutions from ccp vary in the range of 0 065 0 250 and 0 200 0 390 respectively the calculated upstream and downstream risk losses i e the maximum cvar of the loss ratio of flood protection storage and release safety threshold vary in the range of 0 575 0 586 and 1 190 1 254 respectively and calculated upstream and downstream inundation duration vary in the range of 0 81 2 01 h and 28 20 29 34 h respectively the six corresponding objectives of rmoo fluctuate in the range of 0 070 0 270 0 200 0 415 0 571 0 587 1 147 1 272 0 72 2 04 h and 27 63 29 46 h respectively in comparison with ccp rmoo has a wider search range for most objectives except the upstream risk probability comparing the upstream and downstream risk loss objectives the values of all solutions in rmoo are on average 0 16 and 1 72 lower than those in ccp which means that rmoo has advantages in risk loss reduction of flood events especially in the downstream area the two models perform similarly in minimizing the maximum sequential duration of upstream and downstream inundation i e the rmoo model averagely reduces 0 39 h duration of downstream inundation than the ccp model however the rmoo model increases 0 24 h upstream inundation duration table 3 lists the hypervolume zitzler and thiele 1999 of the two models in the spaces of all objectives for the same reference point the hypervolume represents the volume of the space surrounded by noninferior solutions and the ideal solution a larger hypervolume value means a more comprehensive searching performance and a better pareto front of the multiobjective model it is clear that the optimization performance of rmoo is better than that of ccp passing the hypothesis test at the 5 confidence level 3 4 solving and analyzing the compromise solution the multicriteria risk decision making model based on topsis which was applied to select the compromise solution from the noninferior solutions included the following two steps 1 set weights of preference information and 2 select the compromise solution according to those weights in this section we show the specific solutions under homogeneous weights for each objective on this basis the compromise solutions given by the rmoo and ccp models were provided using topsis and the homogeneous weights plan solution c and solution r were selected as compromise solutions from ccp and rmoo respectively projections of noninferior solutions in risk probability vulnerability and inundation duration objectives are shown in fig 8 and detailed values of the objectives are listed in table 4 it can be seen that solution r performs better in lowering the risk loss and inundation duration of upstream and downstream protection areas enhancing the vulnerability and resilience performance of the flood control system at the cost of increasing downstream risk probability by 1 5 detailed storage and release trajectories in xhd of solution r and solution c are shown in fig 9 the two compromise solutions have differences in storage trajectories the risk probability risk loss and inundation duration of the upstream areas in solution r are better than those in solution c however although downstream risk probability of solution r is higher than that of solution c solution r outperforms solution c substantially in controlling the risk loss of the downstream area in comparison with solution c solution r lowers the downstream risk loss i e maximum cvar of loss ratio of reservoir release safety threshold by 7 33 corresponding to a 135 6 m3 s reduction in maximum reservoir release in the 10 adverse scenarios therefore solution r effectively improves the robustness of reservoir release in adverse scenarios by reducing the maximum loss of risk events in downstream protection areas to further explore the optimization mechanism of rmoo in reducing risk loss in adverse scenarios fig 10 reveals the value of downstream cvar under each specific time period of the two compromise solutions and fig 11 shows the average release trajectories and confidence intervals under the 10 most adverse scenarios solution r tends to homogenize the release trajectories in adverse scenarios to reduce the possible extreme flood risk loss at a specific time in the downstream area in comparison with solution c the maximum downstream cvar of solution r is decreased by 7 33 and it is reduced by 11 60 on average during the operation periods of 30 42 h peak release periods in contrast in the operation periods of 6 27 h rising flood periods the downstream cvar of solution r is higher than that of solution c with an average increase of 15 60 therefore the mechanism of successful reduction in risk loss through risk hedging in solution r involves increasing the time and magnitude of prerelease before the occurrence of the flood peak such that the maximum release is reduced through homogenization of the total release meanwhile this strategy also possibly increases the release before the occurrence of the highest water level such that upstream risks can be reduced simultaneously 4 discussion in case study the rmoo model was applied to a flood with a return period of approximately 20 years a medium scale flood event according to china standard for flood control oriented to a medium scale flood event the rmoo model could optimize all flood control objectives and explore the competing relationship and tradeoff among objectives including the risk probability vulnerability and inundation duration for flood events of different return periods the rmoo model could yield different performances for example if a large scale flood event with a low frequency is forecasted i e a flood event with a return period of 100 years the risk probability is high such the occurrence of the risk event and the long time inundation duration are difficult to be avoided on this condition the rmoo model could be simplified into a multiobjective optimization model that minimizes vulnerability in upstream and downstream areas in contrast if a small scale flood event with a high frequency i e a flood event with a return period of 5 years is anticipated the reservoir has sufficient capability to deal with it and the risk probability could be close to zero so the rmoo model would also achieve robust performance by homogenizing reservoir release in this case fig 12 shows the parallel coordinate plot for objectives of noninferior solutions of rmoo and ccp models applied in forecasted flood events with different scales as indicated in fig 12 a because of the inevitable high probability occurrence and long time inundation duration in upstream and downstream areas the main difference between the solutions from rmoo and ccp models is in vulnerability control the solutions from rmoo are averagely lower in objective 3 and objective 4 vulnerability objectives than those from ccp for a flood event with a high frequency i e a flood event with a period of 5 years shown in fig 12 b since the risk probability is zero the performance of rmoo model roughly equals to that of the ccp model except for lower peak release 5 conclusions forecast uncertainties are the primary sources of risk in real time flood control systems to inform reservoir operations under the perturbation of uncertainties flood risk should be controlled adequately and completely with risk probability risk loss and inundation duration of protection areas fully modeled and optimized to enhance overall robustness in risk management vulnerability and resilience performance during real time flood control operation this study established a robust multiobjective operation and risk decision making model for real time flood control coping with forecast uncertainty first a copula function was applied to capture the full order temporal dependences of the forecast uncertainties and stochastic inflow scenarios were generated as input for the flood control operation model second a robust multiobjective flood control operation model was established based on the cvar and an objective set was constructed which included the risk probability risk loss and inundation duration of upstream and downstream protection areas finally topsis was applied to select the compromise solution from the noninferior solutions set on this basis the mechanism of robust control operation was explored the proposed methodology was applied to a large reservoir xianghongdian in the pi river basin china and the following conclusions were derived through comparison with the results obtained from a ccp model 1 forecast error of a flood forecast presents multiorder positive temporal dependences as stochastic processes the copula function was found effective in characterizing and simulating the multidimensional dependences of the forecast uncertainties 2 owing to the inability of ccp to consider systematic control on vulnerability resilience of the flood control system rmoo provided more widely distributed noninferior solutions and outperformed ccp in terms of system vulnerability 3 rmoo reduced the maximum reservoir release by 135 6 m3 s 7 33 by increasing the prerelease before the occurrence of the flood peak through risk hedging moreover the resilience performance controlling of rmoo was also better than that of ccp averagely lowering 0 73 h inundation duration in upstream and downstream areas the proposed methodology provides a modeling approach that can improve the robustness of a reservoir system for flood control through controlling risk probability loss and inundation duration forecast errors and uncertainties are generally considered and simulated through reproducing their historical statistics in future studies ensemble forecasts could be coupled with this model to provide direct probabilistic forecast information with chains of oscillations considered enabling a different modeling approach for flood operation simulation and risk management credit authorship contribution statement xin huang software writing original draft bin xu supervision methodology ping an zhong conceptualization hongyi yao software hao yue validation feilin zhu modifying qingwen lu validation yu sun data curation ran mo investigation zhen li formal analysis weifeng liu modifying declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we would like to thank the anonymous reviewers for their in depth reviews and constructive suggestions the remarks and summary of reviewer comments provided by the editor and associate editor are also greatly appreciated which have facilitated significant improvements in this paper this study is supported by the fundamental research funds for the central universities grant no b200202028 b200204038 b200202032 the china postdoctoral science foundation funded project grant no 2018t110525 and qing lan project of jiangsu province data will be made available by contacting the first author appendix a establishment of marginal distributions of forecast uncertainties table a1 lists the average performance of the different distributions at different lead time on the basis of the results the normal distribution was selected as the marginal distribution and then the maximum likelihood method was used to estimate the distribution parameters a pp plot of the empirical distribution makkonen 2008 and theoretical distribution normal distribution is presented in fig a1 for brevity only the curves fitting forecast uncertainties at lead time of 3 and 12 h are displayed the results show that the normal distribution can fit the sample forecast uncertainties well 
3750,forecast uncertainty in real time flood forecasting is the primary source of risk regarding reservoir flood control operation affecting both reliability and safety of the entire system informing reservoir operation for real time flood control coping with forecast uncertainty encourages overall robust control of risk probability vulnerability and resilience of upstream and downstream protection areas current stochastic programming models or chance constrained programming models ccp focuses on reducing either risk loss or vulnerability thereby failing to ensure systematic control this study established a robust multiobjective operation and risk decision making model to inform reservoir operations the proposed model includes three modules first a copula function was applied to capture multidimensional temporal dependences of forecast uncertainties following which stochastic inflow scenarios were generated second a robust multiobjective optimization rmoo model was established with the objectives of minimizing the probability of risk events conditional value at risk of risk loss vulnerability and the maximum sequential duration for both upstream and downstream areas then an adaptive reference multiobjective evolutionary algorithm was used to solve the model and obtain noninferior solutions finally the topsis multicriteria decision making method was introduced to select the compromise solution methodologies were verified by application to xianghongdian reservoir china the main findings were as follows 1 the copula function effectively captured the multidimensional positive temporal dependences of forecast uncertainties 2 rmoo provided more widely distributed noninferior solutions than ccp and performed better in lowering vulnerability of the system 3 rmoo reduced the maximum release by 135 6 m3 s 7 33 by increasing prerelease before the occurrence of flood peak the proposed methodologies provide insights for supporting robust control of real time operations of a reservoir system through simultaneous control of flood risk probability vulnerability and resilience keywords reservoir operation uncertainty multiobjective robust optimization conditional value at risk copula function 1 introduction floods which represent one of the most devastating natural disasters can cause tremendous hazards to sustainable socioeconomic development aerts et al 2018 reservoirs are important engineering structures regarding flood protection and reservoir operation for flood control can be an effective non engineering measure for reducing flood related losses damage real time flood control operation seeks an informed storage release strategy for reservoirs based on the forecast flow process xu 2021 thus the skill and precision of flood forecasting are closely related to the effectiveness of reservoir operations zhu et al 2017 flood control operation requires coordination of multiple competing objectives that include ensuring the safety of upstream and downstream protection areas while attempting floodwater conservation given that a flood process varies temporally decision makers might adopt different operational strategies at different stages therefore real time flood control operation represents a complex multiobjective multistage time sensitive and risk decision making process xu et al 2020 flood control operation via reservoir operation primarily uses reservoir storage to regulate and change the temporal and spatial process of the flood thus reducing the overall potential flood damage in upstream and downstream areas however limited by the timeliness needs of real time flood control operation and current technologies in assessing flood damage accurately surrogate indices of flood damage are commonly employed as the optimized objectives of flood control operation including risk probability vulnerability and resilience influenced by various uncertain factors such as real time forecast uncertainties deviation in the actual operating water level or release from the expected planned results could occur resulting in potential risk flood damage would occur when the actual water level or release exceeds the safe threshold and the expected damage is highly associated with the risk probability the degree vulnerability and the inundation duration resilience of the risky event focusing on lowering these three indicators in the real time flood control operation many studies have successfully applied the deterministic simulation or optimization models combined with sensitive analysis or parameter scenario analysis labadie 2004 to find a feasible or optimal operation strategy under an acceptable risk level nevertheless these methods which do not aim to directly reduce risk indices could be trapped by infeasibility and sub optimality and yield risk vulnerable operation strategies considering the influence of forecasting error it is critical to inform real time flood control operation based on inaccurate forecast information by characterizing forecast uncertainty as random variables or random processes stochastic optimization models which directly optimize risk indices provide superior solutions than deterministic models specifically stochastic programming sp provides an effective solution to reduce vulnerability and chance constrained programming ccp is a powerful model for lowering or controlling the probability of risk events specifically in model formulation sp usually minimizes vulnerability index for hedging or dispersing flood risk loss whereas ccp often sets a flood risk limit as a constraint for exploring operational strategies that could avoid risk events or lower risk probability with budgeted chance xu et al 2017 chen et al 2017 established a multiobjective reservoir operation model to minimize the upstream water level and the maximum release based on deterministic flood forecasts zhu et al 2017 proposed a multiobjective sp model for modeling the entire process of flood control through flood forecasting reservoir operation and a decision making procedure chain considering forecast uncertainties in this chain the flood forecast module used the martingale model to generate stochastic scenarios and the flood control operation module protected the upstream and downstream areas by lowering the probability of flood risk events chen et al 2020a established a multiobjective flood control operation model that considered multiple uncertain factors and analyzed the impact of uncertainties in reservoir natural inflow and lateral flow on flood risk their case study on the middle reaches of the huai river china demonstrated that the proposed model could reduce the overall risk of the reservoir system by balancing competing objectives in comparison with deterministic optimization models sp and ccp enhance the efficiency and improve the reliability of a flood control system when coping with forecast uncertainties watkins and mckinney 1997 owing to the characteristics of timeliness requirement of real time flood control operation incommensurability of flood damage in upstream and downstream areas and complexity of the decision making process decision makers often need to systematically consider the competing relationship tradeoff and incremental changes among risk indicators and finally select the compromise solution through group decision making or preference coordination borgomeo et al 2018 meanwhile when facing flood events at different magnitudes or return periods decision making preference would vary according to the priority of protecting upstream and downstream protection areas for instance when a small scale flood event is predicted to occur the strategy is expected to lower the overall risk probability and avoid the occurrence of the risk event when a medium scale flood event is anticipated flood control operation needs to coordinate the relationship between risk probability and vulnerability hsu et al 2015 and when a large scale or catastrophic flood event is expected reservoir operation needs to lower the vulnerability and resilience indicators for hedging or reducing the total flood damage and restoring the system to the normal state as soon as possible these three risk indicators and the competing relationship of flood control operation in upstream and downstream areas formulate a multiobjective risk assessment regulation and decision making problem there are no perfect solutions obtaining the optimal levels at all indicators simultaneously instead it is only possible to find a noninferior solution set that could comprehensively systematically and objectively reflect the noninferior relationship among upstream and downstream risk indicators although previous literature reports success in the field of multiobjective flood control operation optimization few studies attempt to investigate the entire spectral of risk indices for providing holistic risk management strategies upon decision making existing sp models mainly focus on minimizing or hedging flood risk loss zhao et al 2014 which could be one sided when focusing on risk reduction such that the optimized strategies may lead to the frequent occurrence of risk events ccp models are constructed mostly for lowering the probability of flood risk events consequently high losses could be resulted when operating large scale floods the desire to seek simultaneous controls on risk probability vulnerability and resilience under uncertainty motivates the application of robust optimization control in reservoir operation robust optimization which seeks robust strategies for maintaining overall performance under oscillations watkins and mckinney 1997 provides a modeling approach for synthesized risk management ahmadi et al 2010 ortiz partida et al 2019 pan et al 2015 robust optimization models are divided into two types nonprobabilistic and probabilistic models ben tal et al 2009 nonprobabilistic models optimize the model performance under all possible cases of considered uncertainty resulting in a rather conservative operation strategy that attempts to avoid risk if possible gong et al 2021 nonprobabilistic models are suitable for the prevention of serious flood events which could cause significant economic loss or casualties such as dam failure levee failure but lack flexibility in dealing with common flood events in contrast probabilistic models which optimizes the model performance under budgeted risk indices for allowing the occurrences of acceptable risks offer more flexibility and applicability ke and chung 2016 different from singular objective sp and ccp models that focus on reducing risk probability or vulnerability a robust multiobjective optimization rmoo model which minimizes the risk probability vulnerability and resilience de bruijn 2005 of both upstream and downstream protection areas could provide a variety of noninferior solutions for flood control operation with varying levels of robustness thereafter decision makers could determine suitable compromise by incorporating their preferences through risk decision making to bridge the knowledge gaps the goal of this study was to comprehensively optimize flood risk probability vulnerability and resilience for providing robust compromise strategies of real time reservoir operation for flood control under forecast uncertainty the main contributions were to establish an rmoo model that could simultaneously control the complete set of risk indices of upstream and downstream protection areas and reveal the competing and harmony relationship among these indices through the analysis of the obtained noninferior solutions specifically the model framework includes two modules module i characterizes forecast uncertainty and simulates stochastic inflow scenarios it captures the multidimensional temporal dependence structure of forecast errors and builds a joint distribution using a copula function for refining uncertainty characterization thereafter it generates stochastic inflow scenarios as input for the flood control model via monte carlo simulation module ii establishes the robust multiobjective flood control operation model the conditional value at risk cvar rockafellar and uryasev 2002 was introduced to represent the surrogate extreme loss of flood in the tail of distribution while risk probability and maximum sequential duration of inundation were also incorporated in the objectives solving the established model provides candidate noninferior solutions with varied robustness finally the robust compromise solution which includes risk mitigation measures was obtained by a popular multicriteria risk decision making module technique for order preference via similarity to an ideal solution topsis the proposed model was applied to a large reservoir on the huai river china and multiobjective ccp was applied as a comparative model for verification of the effectiveness of the proposed methodologies 2 methodology a flowchart of the proposed robust multiobjective operation and risk decision making framework is presented in fig 1 section 2 1 describes the identification of risk sources and the method adopted for simulation of stochastic inflow scenarios section 2 2 establishes the rmoo model for flood control operation considering risk probability vulnerability and resilience section 2 3 presents the multicriteria risk decision making model topsis 2 1 identification of risk sources and simulation of stochastic inflow scenarios forecast inflow represents fundamental information for real time flood control operation and forecast uncertainties were considered the primary source of risk in this study in this section the stochastic characteristics and joint probability function of risk sources are captured using a copula function then the forecast uncertainties that match the characteristics of the observed samples are simulated on the basis of the simulated error scenarios discretized inflow scenarios are generated coupled with real time point forecast processes which provide probabilistic inputs for the reservoir flood control operation forecast uncertainties are defined as the differences between the observed flow and the forecast flow derived from historical re forecasts 1 ξ τ i n t i n t τ t where ξ τ is the forecast uncertainty error at lead time τ m3 s in t is the observed flow at time t m3 s and i n t τ τ is the average forecast inflow from time t τ to time t lead time τ m3 s it is assumed that the forecast uncertainties of different lead time are stochastic processes and that their statistical characteristics can be reproduced from past samples thereby providing information for parameter calibration and model simulation chen et al 2016 zhao et al 2013 xu et al 2021b in this study inflow scenarios considering the full order temporal dependences of the forecast uncertainties were generated using a copula function this simulation method introduced in detail by xu et al 2020 2021a can be divided into three steps 1 establishing a marginal distribution by selecting the optimal marginal distribution from samples used commonly in hydrological analysis sharifi et al 2019 chen et al 2020a chen et al 2020b 2 establishing a joint distribution using a t copula function to quantify the multiorder temporal dependences of the forecast uncertainties in comparison with other structures the t copula function produces an elaborate description of multidimensional dependences and meets the requirements regarding time overheads wang et al 2019 tosunoglu et al 2020 breymann et al 2003 3 generating stochastic forecast inflow scenarios based on the established marginal and joint distribution while forecast inflow scenarios insn is the forecast inflow of scenario n are generated via mento carlo simulation xu et al 2019 2 2 robust multiobjective optimization rmoo model for flood control operation owing to uncertainties decision makers must focus on risk probability vulnerability and resilience control of risk events in addition to risk probability it is necessary to adopt another type of index that can represent flood damage in adverse scenarios to lower vulnerability and an appropriate index to denote resilience of the flood control system 2 2 1 risk probability vulnerability and resilience indices i risk probability risk probability is the most applied objective to reduce the potential frequency of flood risk events this study set two kinds of risk probability objectives for upstream and downstream protection areas respectively which are the maximum probability of the water level and reservoir release exceeding the safety threshold ii vulnerability robust control not only reduces the likelihood of undesirable events but also lowers the associated possible loss borrowing from the field of finance value at risk var is the minimum possible loss at the worst α confidence level α 0 1 quantile owing to the inability of var in characterizing the tail distribution of loss beyond α quantile conditional value at risk cvar index which was first proposed by rockafellar and uryasev 2002 defines the expected loss beyond the worst α of all cases the relationship between cvar and var is illustrated in fig 2 and cvar represents the average loss that exceeds var cvar is considered as a more complete risk measure than var because it could provide more information about the loss estimation for different shapes of tails of loss function which is important when assessing the extreme loss of flood events therefore cvar has since been applied to evaluate loss index in water resources allocation piantadosi et al 2008 yamout et al 2007 hu et al 2016 shao et al 2011 for a specific loss function l cvar can be described as in eqs 2 and 3 2 cvar α l e l l var α l 1 α var α l l pdf l d l 3 var α l min cdf l α where l is the loss function α is the confidence level var α l is the minimum risk loss at confidence level α pdf is the probability density function and cdf is the cumulative probability function the model applied cvar to represent the expected surrogate loss of all worst α cases that might occur during flood control operation in conjunction with the risk probability index the model can ensure the reliability and safety requirements of robust control iii resilience furthermore to realize the effective control and enhance the performance of system resilience this study applied a simplified resilience control objective minimizing the maximum sequential duration of inundation in upstream and downstream areas the duration that operating water level or release exceeds the safety threshold as indicated in fig 3 the formulated objectives and constraints are shown in section 2 2 2 2 2 2 model formulation i objective functions flood control operation of a reservoir refers to the utilization of flood control projects to regulate flood processes for ensuring the overall effect of flood protection for upstream and downstream protection areas the proposed model minimizes the maximum risk probability maximum cvar and maximum sequential duration during the operation horizon for both upstream and downstream areas including the following six objectives objective 1 minimize the maximum probability of the water level exceeding the safety threshold minimize upstream risk probability the maximum probability of the water level exceeding the safety threshold at a certain period is minimized regarding the stochastic inflow scenarios this objective which represents control over the probability of adverse events in upstream areas is characterized by eq 4 4 min f 1 min max count n z s n t z sa n t 1 to t where z s n t is the simulated water level of scenarios n m zsa is the water level safety threshold m t is the number of operation periods h n is the total number of scenarios dimensionless and count is the counting function objective 2 minimize the maximum probability of reservoir release exceeding the safety threshold minimize downstream risk probability similar to objective 1 objective 2 represents control over the probability of risk events in which reservoir release exceeds the threshold this objective can be expressed as in eq 5 5 min f 2 min max count n q s n t q sa n t 1 t o t where q s n t is the simulated reservoir release of scenarios n m3 s and qsa is the release safety threshold m3 s objective 3 minimize the maximum cvar of the loss ratio of flood protection storage minimize surrogate loss of upstream risk theoretically studies could apply depth damage functions to determine the vulnerability of protection region when being exposed to flood as depth damage function provides valuable information for damage reduction with damage or damage percentage identified with water depth yet the information terrain spatial distribution of socio economic properties for calibrating adequate functions is usually scarce a feasible alternative is to use the highest water level as a surrogate measure for rationalizing reservoir operation because the inundation loss caused by a flood in the upstream protection area is often positively correlated with the highest reservoir water level or storage meyer et al 2013 gerl et al 2016 therefore the loss ratio percentage of flood protection storage is selected as the approximate risk loss for the upstream area the function of the loss ratio percentage of flood protection storage at scenario n l zs n t is calculated as in eq 6 6 l zs n t f z v z s n t z v pro z s n t z 0 z s n t z where fz v is the water level storage curve z is the flood loss identified water level m and vpro is the flood protection storage of the reservoir m3 the corresponding objective established by cvar can be expressed as in eq 7 7 min f 3 min max cvar α l zs n t t 1 to t objective 4 minimize the maximum cvar of the loss ratio percentage of reservoir release safety threshold minimize surrogate loss of downstream risk similarly the loss ratio of reservoir release to the safety threshold is applied as the approximate risk loss for the downstream area and function at scenario n l qs n t can be expressed as in eq 8 8 l qs n t q s n t q s q s a q s n t q s 0 q s n t q s where qs is the flood loss identified water release m3 s accordingly the objective to minimize the downstream risk loss of scenario n can be expressed as in eq 9 9 min f 4 min max cvar α l qs n t t 1 to t objective 5 minimize the maximum sequential duration of upstream inundation the maximum sequential duration of upstream inundation is minimized in each inflow scenario this objective which aims to enhance the resilience performance of upstream flood control operation is characterized by eq 10 10 min f 5 min n 1 n max t t s n t e n z s n t z sa t e n t s n n where t s n t e n is the starting and ending time of sequential duration of inundation of scenarios n respectively objective 6 minimize the maximum sequential duration of downstream inundation similarly the maximum sequential duration of exceeding safety threshold release is minimized this objective is set to enhance the resilience performance in downstream areas as shown in eq 11 11 min f 6 min n 1 n max t t s n t e n q s n t q sa t e n t s n n ii constraints in the optimization model the following equality and inequality constraints are considered constraint 1 mass balance equation 12 v s n t 1 v s n t in s n t q s n t e s t l s t δ t t 1 to t where in s n t is the simulated inflow at time t of scenario n m3 s v s n t is the simulated reservoir storage at time t of scenario n m3 es t is the evaporation at time t m3 ls t is the leakage of reservoir time t m3 and δt is the time interval h note that in the short term real time flood control operation uncertainties caused by evaporation and reservoir leakage have negligible impact on the mass balance xu et al 2018 thus the evaporation and leakage are set to be zero in this study constraint 2 reservoir storage limits 13 v v s n t v where v and v are the lower and upper limits respectively of reservoir storage during the operation m3 constraint 3 reservoir release limits 14 q q s n t q where q and q are the lower and upper limits respectively of reservoir release m3 s constraint 4 reservoir release fluctuation limits 15 q s n t 1 q s n t δ q where δq is the permissible maximum release fluctuation m3 s fluctuation limits ensure riverbank stability and navigational safety of the downstream river channel zhu et al 2017 constraint 5 initial and boundary conditions 16 v s n 1 f z v z ini v s n t 1 v obj where zini is the initial water level m and vobj is target ending storage m3 s which is set according to the specific situation of real time flood control iii generation of noninferior solutions the model applies a recently developed multiobjective evolutionary algorithm adaptive reference multiobjective evolutionary algorithm ar moea to explore and generate the noninferior solutions of the robust multiobjective flood control operation additional details regarding this algorithm can be found in tian et al 2018 ar moea applies an adaptation method to adjust a set of reference points based on the indicator contributions of candidate solutions and it demonstrates superior searching performance and versatility in both regular and irregular pareto fronts ar moea outperforms several other advanced multiobjective evolutionary algorithms e g moea dd nsga iii and rvea for test problems in relation to the searching range and iterative efficiency tian et al 2018 fu et al 2021 to deal with the possible irregularity of pareto fronts when solving the complex multiobjective flood control operation problem ar moea is applied to improve the diversity and representativeness of the noninferior solutions 2 3 multicriteria risk decision making model after generating the candidate solutions reservoir decision makers must select a compromise solution from noninferior candidates on the basis of their knowledge and preferences topsis is a classical method in multicriteria decision making that has been widely discussed in the field of reservoir operation and it could be adopted to consider abundant information such as criteria weights and ideal solutions zhu et al 2017 the compromise solution is often the one for which the weighted distance is closest to the ideal point and farthest from the nadir point the main steps of topsis are elaborated in the following step 1 establish the decision matrix variables in the decision matrix represent lists of candidate solutions columnized by objectives criteria as shown in eq 17 17 x i j f j i i 1 to i j 1 to j where x i j is the j th variable in the i th candidate solution fj i is the j th objective in the i th candidate solution i is the total number of candidate solutions and j is the total number of objectives step 2 normalize the decision matrix as expressed in eq 18 18 nor x i j max x i j x i j max x i j min x i j for benefit criteria x i j min x i j max x i j min x i j for cost criteria where norx i j is the normalized decision matrix step 3 establish the weighted normalized decision matrix as given in eq 19 19 w x i j w j n o r x i j where wx i j is the weighted variable and wj is the weight of the j th variable step 4 calculate the ideal solution w wx 1 wx 2 wxj and the nadir solution w wx 1 wx 2 wxj according to the following rules 20 w x j max w x i j 1 i i w x j min w x i j 1 i i for benefit criteria w x j min w x i j 1 i i w x j max w x i j 1 i i for cost criteria where wxj and wxj are the ideal and nadir points of the j th variable respectively step 5 calculate the euclidean distance between the candidate solutions and the ideal and nadir solutions as shown in eq 21 21 d i j 1 j w x i j w x j 2 d i j 1 j w x i j w x j 2 where di and di are the euclidean distances between the i th candidate solution and the ideal and nadir solutions respectively step 6 calculate the degree of closeness of each candidate solution as described in eq 22 22 cl o i d i d i d i where cloi is the degree of closeness of the i th candidate solution the candidate solution with the highest degree of closeness is the compromise solution selected by topsis 3 case study 3 1 overview of the study area and data 3 1 1 xianghongdian reservoir xianghongdian reservoir xhd is a large reservoir on the pi river which is a tributary of the huai river china xhd has total storage capacity of 2 613 billion m3 and it controls a basin area of 1400 km2 it is a vital flood control project on the upper reaches of the huai river protecting the safety of the mainstream of the huai river and downstream cities such as lu an the xhd basin is affected by the monsoon climate and regional precipitation is concentrated mainly in the flood season of may october flash flooding frequently occurs in this area owing to the specific climatic and topographic conditions and the effective lead time of the river basin is very limited such that high uncertainties can occur within a real time forecast the location of xhd is illustrated in fig 4 and the main parameters used in this study are listed in table 1 note that flood loss identified water release qs was set to 20 safety threshold for water release qsa in this study which is the threshold of turbine release capacity when reservoir release is greater than qs reservoir opens spillway to discharge the surplus water to downstream and reservoir operation status transits from benefit maximization through water resources utilization to loss minimization by reducing flood hazard lu et al 2021 3 1 2 data description the flood forecast system is supported by real time precipitation monitoring and weather forecast products produced by the china meteorological administration these data serve as inputs that drive the hydrological model to generate the forecast inflow this study applied automatic forecast products with forecast horizons of 45 h and a 3 h time interval and the automatic forecast system conducted a rolling horizon forecast product every 3 h with real time updates detailed information regarding forecast and observed data can be found on the anhui water information website http yc wswj net ahsxx lol public public html to fully describe the characteristics of forecast uncertainties this study collected 129 sets of forecast error samples from 12 historical floods average 10 error samples at a certain forecast lead time for each flood of different scales and selected one flood event no 20150809 with re forecast as the study case this flood event was caused by super typhoon soudelor no 1513 in 2015 the whole flood process including decreasing phase began on august 9th at 16 00 local time and ended on august 12th at 18 00 local time duration 74 h and had a return period of approximately 20 years and the average precipitation of the basin was 194 9 mm during the typhoon period 3 2 identification of forecast uncertainties and flood simulation each of four distributions commonly used in hydrological analysis was applied to establish the marginal distribution for the forecast uncertainties at each lead time and the rmse aic and chi square test were applied to evaluate the goodness of fit performance detailed information referring to the establishment of marginal distribution is shown in appendix a on the basis of the established marginal distribution the t copula function was applied to the joint distribution construction of forecast uncertainties with multiorder temporal dependences the correlation coefficient cor values calibrated from observed forecast uncertainties and calculated from simulated forecast uncertainties are illustrated in fig 5 the cor calibrated from observed forecast uncertainties fig 5 a illustrates that flood forecast uncertainties in xhd have high multidimensional temporal dependences attributable to the strong relationship between inflow forecasting and precipitation the correlation coefficients of forecast uncertainties are generally greater than 0 75 meanwhile fig 5 b demonstrates that the t copula function accurately reproduces the multidimensional dependences among the forecast uncertainties on the basis of the established marginal distribution and joint distribution a monte carlo simulation was applied to generate error samples then the simulated samples were added to the average inflow forecast to form stochastic inflow scenarios as shown in fig 6 3 3 robust multiobjective flood control operation applied to xhd 3 3 1 numerical experiments examining robustness the stochastic inflow scenarios generated as described in section 3 2 served as input conditions for the flood control model to verify the performance of the rmoo model a multiobjective ccp model that optimizes only the risk probability of upstream and downstream areas was also built with the same constraints within the modeling the characteristic curves of the reservoir e g stage storage curve and stage release curve were fitted with a quadratic continuous and differentiable function the specific objectives and constraints of the two models are listed in table 2 3 3 2 solving and analyzing noninferior solutions i solving noninferior solutions the simulation model and ar moea were developed on an open source platform i e platemo https github com bimk platemo the detailed calculation parameters were as follows the confidence level α was 0 1 the number of initial populations was 120 and the maximum number of iterations for each population was 10000 the two simulation models rmoo and ccp and the algorithm were implemented under the same condition including the same calculating workstation with intel i7 10700f cpu and 32 gb ram the same maximum number of iterations and the difference of calculating duration for two models is within 5 the distribution of the objectives of the rmoo and ccp models is shown in fig 7 specifically objective 3 4 5 and 6 of the ccp model were calculated directly from noninferior solutions rather than through optimization the upstream and downstream flood risk probabilities of noninferior solutions from ccp vary in the range of 0 065 0 250 and 0 200 0 390 respectively the calculated upstream and downstream risk losses i e the maximum cvar of the loss ratio of flood protection storage and release safety threshold vary in the range of 0 575 0 586 and 1 190 1 254 respectively and calculated upstream and downstream inundation duration vary in the range of 0 81 2 01 h and 28 20 29 34 h respectively the six corresponding objectives of rmoo fluctuate in the range of 0 070 0 270 0 200 0 415 0 571 0 587 1 147 1 272 0 72 2 04 h and 27 63 29 46 h respectively in comparison with ccp rmoo has a wider search range for most objectives except the upstream risk probability comparing the upstream and downstream risk loss objectives the values of all solutions in rmoo are on average 0 16 and 1 72 lower than those in ccp which means that rmoo has advantages in risk loss reduction of flood events especially in the downstream area the two models perform similarly in minimizing the maximum sequential duration of upstream and downstream inundation i e the rmoo model averagely reduces 0 39 h duration of downstream inundation than the ccp model however the rmoo model increases 0 24 h upstream inundation duration table 3 lists the hypervolume zitzler and thiele 1999 of the two models in the spaces of all objectives for the same reference point the hypervolume represents the volume of the space surrounded by noninferior solutions and the ideal solution a larger hypervolume value means a more comprehensive searching performance and a better pareto front of the multiobjective model it is clear that the optimization performance of rmoo is better than that of ccp passing the hypothesis test at the 5 confidence level 3 4 solving and analyzing the compromise solution the multicriteria risk decision making model based on topsis which was applied to select the compromise solution from the noninferior solutions included the following two steps 1 set weights of preference information and 2 select the compromise solution according to those weights in this section we show the specific solutions under homogeneous weights for each objective on this basis the compromise solutions given by the rmoo and ccp models were provided using topsis and the homogeneous weights plan solution c and solution r were selected as compromise solutions from ccp and rmoo respectively projections of noninferior solutions in risk probability vulnerability and inundation duration objectives are shown in fig 8 and detailed values of the objectives are listed in table 4 it can be seen that solution r performs better in lowering the risk loss and inundation duration of upstream and downstream protection areas enhancing the vulnerability and resilience performance of the flood control system at the cost of increasing downstream risk probability by 1 5 detailed storage and release trajectories in xhd of solution r and solution c are shown in fig 9 the two compromise solutions have differences in storage trajectories the risk probability risk loss and inundation duration of the upstream areas in solution r are better than those in solution c however although downstream risk probability of solution r is higher than that of solution c solution r outperforms solution c substantially in controlling the risk loss of the downstream area in comparison with solution c solution r lowers the downstream risk loss i e maximum cvar of loss ratio of reservoir release safety threshold by 7 33 corresponding to a 135 6 m3 s reduction in maximum reservoir release in the 10 adverse scenarios therefore solution r effectively improves the robustness of reservoir release in adverse scenarios by reducing the maximum loss of risk events in downstream protection areas to further explore the optimization mechanism of rmoo in reducing risk loss in adverse scenarios fig 10 reveals the value of downstream cvar under each specific time period of the two compromise solutions and fig 11 shows the average release trajectories and confidence intervals under the 10 most adverse scenarios solution r tends to homogenize the release trajectories in adverse scenarios to reduce the possible extreme flood risk loss at a specific time in the downstream area in comparison with solution c the maximum downstream cvar of solution r is decreased by 7 33 and it is reduced by 11 60 on average during the operation periods of 30 42 h peak release periods in contrast in the operation periods of 6 27 h rising flood periods the downstream cvar of solution r is higher than that of solution c with an average increase of 15 60 therefore the mechanism of successful reduction in risk loss through risk hedging in solution r involves increasing the time and magnitude of prerelease before the occurrence of the flood peak such that the maximum release is reduced through homogenization of the total release meanwhile this strategy also possibly increases the release before the occurrence of the highest water level such that upstream risks can be reduced simultaneously 4 discussion in case study the rmoo model was applied to a flood with a return period of approximately 20 years a medium scale flood event according to china standard for flood control oriented to a medium scale flood event the rmoo model could optimize all flood control objectives and explore the competing relationship and tradeoff among objectives including the risk probability vulnerability and inundation duration for flood events of different return periods the rmoo model could yield different performances for example if a large scale flood event with a low frequency is forecasted i e a flood event with a return period of 100 years the risk probability is high such the occurrence of the risk event and the long time inundation duration are difficult to be avoided on this condition the rmoo model could be simplified into a multiobjective optimization model that minimizes vulnerability in upstream and downstream areas in contrast if a small scale flood event with a high frequency i e a flood event with a return period of 5 years is anticipated the reservoir has sufficient capability to deal with it and the risk probability could be close to zero so the rmoo model would also achieve robust performance by homogenizing reservoir release in this case fig 12 shows the parallel coordinate plot for objectives of noninferior solutions of rmoo and ccp models applied in forecasted flood events with different scales as indicated in fig 12 a because of the inevitable high probability occurrence and long time inundation duration in upstream and downstream areas the main difference between the solutions from rmoo and ccp models is in vulnerability control the solutions from rmoo are averagely lower in objective 3 and objective 4 vulnerability objectives than those from ccp for a flood event with a high frequency i e a flood event with a period of 5 years shown in fig 12 b since the risk probability is zero the performance of rmoo model roughly equals to that of the ccp model except for lower peak release 5 conclusions forecast uncertainties are the primary sources of risk in real time flood control systems to inform reservoir operations under the perturbation of uncertainties flood risk should be controlled adequately and completely with risk probability risk loss and inundation duration of protection areas fully modeled and optimized to enhance overall robustness in risk management vulnerability and resilience performance during real time flood control operation this study established a robust multiobjective operation and risk decision making model for real time flood control coping with forecast uncertainty first a copula function was applied to capture the full order temporal dependences of the forecast uncertainties and stochastic inflow scenarios were generated as input for the flood control operation model second a robust multiobjective flood control operation model was established based on the cvar and an objective set was constructed which included the risk probability risk loss and inundation duration of upstream and downstream protection areas finally topsis was applied to select the compromise solution from the noninferior solutions set on this basis the mechanism of robust control operation was explored the proposed methodology was applied to a large reservoir xianghongdian in the pi river basin china and the following conclusions were derived through comparison with the results obtained from a ccp model 1 forecast error of a flood forecast presents multiorder positive temporal dependences as stochastic processes the copula function was found effective in characterizing and simulating the multidimensional dependences of the forecast uncertainties 2 owing to the inability of ccp to consider systematic control on vulnerability resilience of the flood control system rmoo provided more widely distributed noninferior solutions and outperformed ccp in terms of system vulnerability 3 rmoo reduced the maximum reservoir release by 135 6 m3 s 7 33 by increasing the prerelease before the occurrence of the flood peak through risk hedging moreover the resilience performance controlling of rmoo was also better than that of ccp averagely lowering 0 73 h inundation duration in upstream and downstream areas the proposed methodology provides a modeling approach that can improve the robustness of a reservoir system for flood control through controlling risk probability loss and inundation duration forecast errors and uncertainties are generally considered and simulated through reproducing their historical statistics in future studies ensemble forecasts could be coupled with this model to provide direct probabilistic forecast information with chains of oscillations considered enabling a different modeling approach for flood operation simulation and risk management credit authorship contribution statement xin huang software writing original draft bin xu supervision methodology ping an zhong conceptualization hongyi yao software hao yue validation feilin zhu modifying qingwen lu validation yu sun data curation ran mo investigation zhen li formal analysis weifeng liu modifying declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we would like to thank the anonymous reviewers for their in depth reviews and constructive suggestions the remarks and summary of reviewer comments provided by the editor and associate editor are also greatly appreciated which have facilitated significant improvements in this paper this study is supported by the fundamental research funds for the central universities grant no b200202028 b200204038 b200202032 the china postdoctoral science foundation funded project grant no 2018t110525 and qing lan project of jiangsu province data will be made available by contacting the first author appendix a establishment of marginal distributions of forecast uncertainties table a1 lists the average performance of the different distributions at different lead time on the basis of the results the normal distribution was selected as the marginal distribution and then the maximum likelihood method was used to estimate the distribution parameters a pp plot of the empirical distribution makkonen 2008 and theoretical distribution normal distribution is presented in fig a1 for brevity only the curves fitting forecast uncertainties at lead time of 3 and 12 h are displayed the results show that the normal distribution can fit the sample forecast uncertainties well 
3751,concentration discharge c q relationship analyses allow better understanding catchment water origin and hydrological process variability across time from storm event to pluriannual scale though those approaches mostly include integrative methods that consider catchments as a whole the aim of this article is to assess the potential of a combined approach to investigate the spatio temporal variability of flood processes within catchments across river reaches and seasons focusing on karst areas the methodology consists in combining c q relationship analysis in nested catchments and simulation of lateral exchanges at the reach scale for that we analyze high frequency records of discharge and electrical conductivity ec in karst catchments in which ec informs on water residence time contributions of pre event water pew and event water ew during storm events are investigated through hysteresis loop analysis at each gauging station combined with lateral ec simulation at the reach scale they make it possible to infer runoff processes during storms a unary karst catchment in a temperate mountainous climate loue river and a binary catchment in a mediterranean climate cèze river were selected in france and their conceptual models of water origin and hydrological process variability were drawn in the loue catchment summer and fall storm events are characterized by contributions of pew through piston type flows whereas decreasing ec values in winter and spring storm events indicate the major contribution of ew through surface runoff and fast infiltration within the catchment ew contribution increases downstream due to the canyon river morphology grading into open valleys regarding the cèze catchment contributions of ew are higher indicating that fast infiltration and surface runoff are the dominant processes associated with a pew signature in summer and fall within the catchment pew contribution is found higher in karstified areas these results show that flood process seasonality is mainly related to karst aquifer saturation rate while intra site variability is linked to karst area extension and river morphology results are encouraging to extend this approach to a variety of sites notably those affected by significant surface water groundwater interaction and groundwater flooding such approach by providing a discretized information on flood processes could help refining lumped hydrological models or facilitate the use of semi distributed ones keywords concentration discharge karst storm hysteresis lateral flow 1 introduction runoff at the catchment outlet has different origins depending on the water flow paths in the surface subsurface and underground compartments the joint study of hydrological and hydrochemical signals through concentration discharge c q relationships can help improving our understanding of these origins and associated hydrological processes depending on the context and nature of investigations c q relationship analysis can be applied to different variables the most frequently monitored parameters being major ions or continuous physico chemical variables such as electrical conductivity turbidity alkalinity or ph e g rose 2003 a synthesis by knapp et al 2020 based on results obtained in a swiss mountainous catchment summarizes the main environmental drivers of c q relationships at the storm event and longer time scales the main approaches encountered in the literature for the study of these relationships are end member mixing analysis burns et al 2001 doctor et al 2006 statistical approaches anderson et al 1997 and hysteresis studies evans and davies 1998 evans et al 1999 rose 2003 rose et al 2018 they led to advances in the understanding of aquifer recharge and vulnerability house and warwick 1998 huebsch et al 2014 streamflow contributions ribolzi et al 2000 and storm event spring discharge toran and reisch 2012 most c q analyses are interpreted in terms of a two component system involving pre event water pew and event water ew evans et al 1999 rose 2003 or include a third component defined as soil or rapid infiltration water evans and davies 1998 ribolzi et al 2000 burns et al 2001 toran and reisch 2012 while most c q studies use the concentration values of different streamflow sources to perform the hydrograph separation some use an a priori separation to infer source concentration values neira et al 2020 at the catchment scale hysteresis analyses allow studying c q relationships using c and q data at a given monitoring station hysteresis loops are mainly characterized using classifications of loop shapes such as the widely used 6 type proposed by evans and davies 1998 or more recent 9 type ones butturini et al 2008 heathwaite and bieroza 2021 using hysteresis indices see a synthesis by lloyd et al 2016 these approaches make it possible to investigate streamflow contributions during storm events knowing concentration ranking of supposed end members rose 2003 vaughan et al 2017 when monitoring several gauging stations for q and c along the stream it is possible to assess c q relationship spatial variability at nested catchment scale it is also possible to characterize it using a reach scale approach between two gauging stations in that case water origin and flood hydrological processes can be investigated by analyzing lateral exchanges i e stream water gains or losses from or to groundwater such analyses were performed by covino et al 2011 and mallard et al 2014 using artificial tracing experiments to investigate stream composition changes analytical approaches also exist such as the advection diffusion equation ade widely used to model conservative solute transport runkel 1996 baeumer et al 2001 hauns et al 2001 luhmann et al 2012 this equation is mathematically similar to the diffusive wave equation dwe and both can be resolved using the hayami analytical solution 1951 making it possible to simulate lateral flows q and c cholet et al 2017 karst catchments are located in carbonate areas including limestone and dolomite and cover 20 of europe land surface and 35 in france goldscheider et al 2020 they are known to be complex permeable hydrosystems involving high rainfall infiltration rates through open conduits and promoting fast groundwater flow and significant surface water groundwater interaction bakalowicz 2005 in such areas electrical conductivity ec provides information on groundwater residence time and water origin as it is controlled by bicarbonate calcium and magnesium concentrations resulting from carbonate rock dissolution hess and white 1988 lambán et al 2015 liu et al 2007 because ec can be easily monitored at high frequency time steps it is a useful variable for the characterization of c q relationships particularly in karst catchments indeed the contrast between water end members is notable low mineralization ew from surface runoff or fast groundwater flow and high mineralization pew from groundwater present in the aquifer prior to the storm event the range of ec values is variable depending on groundwater residence time or mixing with fast rainwater infiltration and allow identifying pew and ew occurrence in the particular case of karst catchments an additional challenge is to distinguish ew from direct surface runoff on low permeability areas and ew from fast infiltration in open conduits feeding rivers through springs hartmann et al 2021 moreover unexpected ec variations can occur during high flow periods as groundwater boundaries extend and incorporate areas with different ec values ravbar et al 2011 various methodologies have been used to explore ec q relationships during storm events in karst catchments early studies mainly describe ec variations during storm events an ec drop being interpreted as an increasing ew contribution in streamflow and complex fluctuations corresponding to several simultaneous karst conduit contributions hess and white 1988 statistically based methods exist such as ec frequency distribution analysis massei et al 2007 which makes it possible to investigate the relative contributions of surface water and groundwater to streamflow and how they are influenced by hydrological conditions characterization of ec q hysteresis loops is also used which makes it possible to study delays between discharge and solute concentration variations bringing to light the changing hydrological processes at the scale of a storm event or between different events fournier et al 2007 toran and reisch 2012 hysteresis loops of hydrographs at different locations within a karst catchment were also studied to identify hydrological flows at nested catchment scale zhang et al 2020 analysis of ec and q patterns at the storm event time scale have also highlighted the importance of seasonal variability in the physico chemical response of a karstic spring fournier et al 2007 recently ec q relationships at the reach scale were studied by cholet et al 2017 using lateral exchange modeling to investigate conduit matrix relationship variability during storm events according to seasons each methodology helps better understanding hydrological processes and we identify a strong interest in combining different approaches and to investigate both nested and reach scales to improve the conceptual model of karst catchments the aim of this article is to assess the potential of a combined approach to investigate the spatio temporal variability of flood processes within karst catchments to do that we combine two spatial scales of investigation at the nested catchment scale a classification of c q hysteresis loops adapted to ec measurement in karst context at the reach scale an inverse modeling of lateral flow q and c using this combined approach we will define what can be learned from c q hysteresis loop analysis in karst catchment storm events and what additional information can bring the modeling of lateral flow q and c to answer these questions we apply the two step approach on hourly records of q and ec during storm events at four gauging stations in two karst catchments in france characterized by contrasting climate and karst area extension results are interpreted in terms of water origin using pew and ew contributions during storm events finally conceptual models are proposed that summarize the main information obtained with the combined approach regarding spatio temporal variability of flood processes 2 methodology 2 1 general methodology to propose a conceptual model of flood water origin spatio temporal variability a two part methodology was applied the parts correspond to two spatial scales i the nested catchment scale considering the topographic catchment upstream a gauging station and ii the reach scale considering the catchment delimited by two gauging stations both parts rely on hourly q and c data collection during storm events the difference being that reach scale analysis requires data from both inlet and outlet stations to analyze temporal variability the methodology was applied on storm events grouped by seasons fig 1 presents this general methodology from field measurement network and monitored variables to data processing at the nested catchment scale c q loops are analyzed for each storm event according to the methodology described in section 2 2 this analysis is performed at each monitoring station of the hydrograph network and characterizes flood processes occurring in the whole upstream topographic catchment it is thus a lumped approach at the catchment scale and successive analyses towards the final outlet are interpreted in terms of flood process variability of nested catchments even so a more spatially discrete approach at the reach scale is necessary to refine and spatialize this variability description at the reach scale the hourly lateral flow discharge ql and concentration cl variations are simulated using the dwe inverse model detailed in section 2 3 assuming that exchanges are uniformly distributed along river reaches although this may not be the case in karst systems this approach allows a more spatialized investigation of the location of lateral flows which commonly lacks in c q studies this reach scale approach consists in comparing obtained mean cl values to pew and ew end member c values more details regarding definitions of these end members are given in section 3 3 a season based storm event typology is proposed which allows interpreting hydrological response variability four seasons are defined based on typical hydrological dynamics of the study sites low water table and first storm events in september and october high precipitation volume winter events from november to march lower intensity events from april to may and occasional summer storm events from june to august finally a conceptual model that associates flood processes to different seasons and karst configurations is proposed in addition to a schematic representation of the spatial variability of water origin along river reaches 2 2 nested catchment scale approach c q loop analysis this section presents a c q loop classification that allows characterizing hysteresis loops obtained from the monitoring of various physico chemical parameters concentration turbidity ec evans and davies 1998 proposed a 6 type classification of c q loops based on the loop s general trend and its rotational direction this classification was used in later c q studies rose 2003 vaughan et al 2017 zhang et al 2020 building on evans and davies 1998 we use a modified loop typology enriched by the integration of a hysteresis index quantification and the inclusion of non hysteresis pathways similar 9 type classifications have been proposed and shown to be relevant for c q relationship studies butturini et al 2008 heathwaite and bieroza 2021 we calculated two indicators for loop classification slope s obtained by applying a linear regression to the c q values and hysteresis index hi the hysteresis index proposed by lloyd et al 2016 is used in this work it provides information on both the loop direction and its amplitude moreover it considers the whole range of discharge values and is calculated based on normalized q and ec values which facilitates consistent inter event and inter site comparison for a given storm event q and ec values are normalized between 0 and 1 and at each 5 interval i of normalized q a local hii is calculated following eq 1 1 hi i ec nri ec nfi where ecnri and ecnfi are normalized ec values at discharge interval i taken on the rising limb and falling limb of the loop respectively fig 2 represents local hii values and the slope value for an illustrative storm event the mean of the 19 hii values 5 intervals recommended by lloyd et al 2016 is used as the final hi value as a result hi values range from 1 to 1 absolute values near 0 and 1 corresponding to low and high hysteresis degrees respectively similar versus contrasting rising and falling paths negative hi values indicate anticlockwise loops whereas positive hi values indicate clockwise loops complex 8 shaped loops show an hi value corresponding to their primary shape i e the widest loop part with one rotational direction once threshold values are defined values of slope and hi that delineate the classification types measure slope and hi make it possible to relate any storm event to one of the nine categories of the classification presented in fig 3 using its c q loop the loop typology is built on two character names the first corresponding to hi sign and consequently to rotational direction c for clockwise n for neutral and a for anticlockwise and the second corresponding to the slope sign for negative s 0 for nil s and for positive s this classification based on butturini et al 2008 was adapted to the case of ec q in karst catchments in the case of karst areas event water ew having a lower residence time than pre event water pew its ec value is lower indeed ec is a reliable proxy of bicarbonates concentration which is linked to limestone dissolution and thus residence time peyraube et al 2019 therefore we will use our ec q loop typology to determine patterns of successive contributions to streamflow pew and ew assuming the ec ranking is known each loop type is linked to a specific pattern of successive contributions to streamflow based on the main findings in the literature of c q studies evans and davies 1998 showed that in a two component system when the solute concentration of pew is higher than that of ew anticlockwise c q loops indicate a dominant contribution of ew during the rising limb and a dominant contribution of pew during the falling limb scenario 1 on the other hand clockwise c q loops indicate a dominant pew contribution during the rising limb and a dominant ew contribution during the falling limb scenario 2 this c q loop taxonomic consistency was verified experimentally by chanat et al 2002 and was shown to be reliable when concentration values of end members are distinct enough which is the case here as surface runoff water and groundwater are compared see values at end of section 3 3 regarding the specific case of ec q hysteresis toran and reisch 2012 observed anticlockwise loops during storm events at a karst spring discharge in pennsylvania and verified that they were linked to scenario 1 based on ca2 and mg2 concentration monitoring rose et al 2018 linked scenario 2 to clockwise c q loops thanks to geogenic solute monitoring in a small usa catchment in the case of monitoring of solutes in which ew is enriched such as no3 from the organic horizon evans et al 1999 huebsch et al 2014 the rotational directions are reversed based on previously described findings from the literature and in our case of ec monitoring in a karst catchment where the pew solute concentration is higher our hypothesis is that clockwise ec q loops correspond to pew preceding ew and anticlockwise ec q loops correspond to ew preceding pew this is particularly clear with loops that have slopes equal to zero c0 and a0 loops rising and falling limbs showing ec values exclusively above or below the initial value prior to a storm event in the case of non zero loop slopes one limb may have mixed water origins a mixed water signature in the case of karst systems where fast infiltration can occur may result from low residence time pew recently stored in the karst i e from several days or weeks or from ew infiltrating through preferential pathways and mixing with highly mineralized pew i e several months or years old regarding non hysteretic ec q paths both limbs have a similar water origin this latter being inferred from the slope a negative slope indicating ew contribution whereas a positive slope indicating pew contribution this methodology is applicable only when the initial ec value falls between the two end member ec values this observation was systematically verified in the framework of this study the initial ec value always being higher than the ew end member ec value in karst areas more information on end member ec values is provided in section 3 3 on fig 3 that presents the nine loop types of our classification a framework of interpretation of associated streamflow contribution patterns is also proposed based on residence time which is inferred from ec values mixed water can be linked either to a mix of low and high residence time pew or to a mix of ew and high residence time pew 2 3 reach scale approach lateral flow simulation to investigate the origin of lateral inflows along river reaches i e between two gauging stations we used the modeling approach proposed by cholet et al 2017 based on the diffusive wave equation dwe and extended to the advection diffusion equation ade both equations are resolved using the hayami analytical solution 1951 as proposed by moussa 1996 we provide in this section the key points of the approach more details on this analytical approach are provided in the appendix separate modeling of lateral discharge ql and mass flux ml make it possible to assess lateral solute concentration cl by division as shown in equation 2 2 c l m l q l ql is simulated using the solution of the inverse problem of the dwe and ade assuming that lateral flow is uniformly distributed along the river reach moussa 1996 ml is obtained by applying the dwe to mass flux this latter being calculated as the product of ql and cl equation 2 assuming that total dissolved solids tds consists mainly of conductive ionic compounds ec is proportional to the tds concentration noted c in g m 3 concentration c is therefore calculated from ec using a constant factor of 0 64 in accordance with values found in the literature lloyd and heathcote 1985 3 c e c 0 64 mass flux m is then calculated as the product of concentration c and discharge q 4 m c q finally the simulated lateral conductivity ecl is calculated as the ratio of simulated lateral mass flux ml to simulated lateral discharge ql divided by a factor of 0 64 5 ec l m l q l 1 0 64 as some river reaches can show negative ql values indicating lateral streamflow losses ecl is calculated only for positive ql values indeed negative ql values would lead to negative ecl values which is impossible ecl variations thus make it possible to compare water origin on successive streams within a catchment 3 study areas and data sets 3 1 study areas the previously described methodology was applied to two catchments in france which are partially to strongly karstified and located in different geological and hydrometeorological settings fig 4 they are similar in size 1000 km2 and both include four q and ec measurement stations the loue river basin is located in the jura mountains its outcrops consist primarily of extensively and homogeneously karstified jurassic limestone and locally marl making it a unary karst basin the lison river is the major left bank loue tributary and oth rivers start as a karst spring the loue spring being partly fed by doubs river losses that occur in the southeastern part of the catchment charlier et al 2014 it is not a typically unary karst basin the term of unary karst basin is used here as the allogenic recharge is also from a similar karstified area the loue and lison springs are among the largest karst springs in europe chen et al 2017 with mean discharge of around 10 and 7 m3 s 1 respectively and maximum peak flows of around 80 and 70 m3 s 1 precipitation follows an elevation gradient annual values range from 1600 mm on the upstream catchment at elevations of 900 m a s l to 1450 mm at the outlet at an elevation of around 400 m a s l the cèze catchment is located in the eastern part of the cévennes mountains it can be characterized as a binary karst basin with upstream areas that consist of non karst outcrops i e hard rocks where mean yearly precipitation is 1500 mm and median and downstream areas underlain by karst plateaus that receive precipitation of approximately 1000 mm year the karstified portion is composed of early cretaceous limestone dark green fig 54b that is mainly situated between the tharaux and laroque stations and extends southward more information on exchanges between river streams and karst systems in this area can be found in the work of chapuis 2018 3 2 data sets detailed information on the data time series is available in the supplementary material temporal data used in this paper are hourly streamflow data available from the french public streamflow database banque hydro http www hydro eaufrance fr hourly rainfall data available from the antilope database champeaux et al 2011 a reanalysis produced by the french public meteorological service météo france http www meteofrance fr sub hourly ec measurements for the cèze river recorded by the brgm using schlumberger ctd diver probes from july 2019 to july 2020 similar data recorded using ott ms5 probes within the quarstic network charlier et al 2018 for the loue river from january 2016 to january 2020 as available data time series on the studied catchments are not of identical length and because of contrasted hydro climatic contexts 58 storm events were extracted for the loue catchment against 8 for the cèze catchment in the loue catchment storm events have a median precipitation depth of 58 mm min 10 mm and max 136 mm and a median peak flow value of 78 m3 s 1 min 2 m3 s 1 and max 529 m3 s 1 in the cèze catchment storm events have a median precipitation depth of 65 mm min 30 mm and max 180 mm and a median peak flow value of 128 m3 s 1 min 20 m3 s 1 and max 780 m3 s 1 3 3 ec end member values for the loue catchment the pew end member ec is defined as the signal for water having the longest residence time thus having the highest ec value at 550 μs cm 1 recorded during the acquisition period at the spring monitoring stations ouhans and nans see fig 4a the loue catchment ew end member ec for surface runoff is defined at 250 μs cm 1 based on values recorded on an intermittent stream on marly areas for the cèze catchment the pew end member is defined at 700 μs cm 1 based on highest values recorded at cèze karst springs monitoring stations chapuis 2018 the cèze catchment ew end member ec for surface runoff is defined at 75 μs cm 1 based on minimum values recorded during the acquisition period at the upstream monitoring station tharaux see fig 4b which is only fed by non karst areas 4 results 4 1 ec q relationships at the catchment scale fig 5 compares annual and event based mean ec values for the loue and cèze catchment stations to obtain the mean ec value of all water flowing through stations we calculated the flow weighted average of hourly ec for both annual and event based ec the four loue stations show similar values of around 400 and 350 μs cm 1 respectively this consistency across stations is probably linked to the homogeneous presence of karst areas leading to similar proportions of surface water and groundwater contribution to streamflow event based ec values are generally higher than annual ones indicating a dominant mobilization of pre event highly mineralized water during storms likely groundwater as the two downstream river stations vuillafans and chenecey show similar responses to the two spring stations nans and ouhans the cèze catchment stations show a spatial variability pattern with ec values increasing from upstream to downstream and decreasing again at the most downstream station annual values range from 180 μs cm 1 at tharaux to 280 μs cm 1 at laroque event based ec values follow the same trend in relation to the local karst extension the intermediate karst area located between tharaux and laroque see fig 5b promoting highly mineralized water event based ec values are mostly lower than annual ones showing a dominant stream dilution by low mineralization event water during storms except at the tharaux station fig 6 shows two examples of recorded ec and q variations for each study site loue a b cèze c d along with their corresponding ec q loops see fig 3 for classification these illustrative events were chosen as they are representative of the generally observed ec and q variations at each site regarding the loue catchment fig 6a shows a storm event associated with an ec drop that takes place mostly after peak flow and leads to a c loop type indicating an event water ew contribution that occurs mainly at the end of peak flow and during recession fig 6b shows that other storm events on the loue catchment are associated with an ec increase indicating pre event water pew mobilization on the pictured storm event ec variations are quite similar to q variations leading to a flatter ec q loop nevertheless ec values are slightly higher on the falling limb leading to an identifiable a loop type regarding the cèze catchment fig 6c illustrates a storm event associated with an ec decrease indicating dilution by event water and leading to a c loop type as shown in fig 6a finally fig 6d represents a storm event with strongly anticorrelated ec and q variations during both rising and falling limbs leading to a non hysteretic n loop type fig 7 a and 7b show the seasonal slope value distribution in the loue and cèze catchments respectively all stations in the loue catchment exhibit a similar pattern of seasonal variation with negative or low slopes in winter november to march and spring april to may and positive values in summer june to august and fall september to october this shows that storm events in winter and spring are primarily characterized by an ew dilution while storm events in summer and fall are mainly characterized by a pew mobilization from june to october the variability of slope is higher moreover slope values are generally lower at the nans and chenecey stations than at the others regarding the cèze catchments slope values are mostly negative all year long except for a few winter storm events at the tharaux and bagnols stations indicating the dominant dilution by low mineralization ew fig 7c and 7d show the hi value distribution following seasons for the loue and cèze catchments respectively both catchments are subject to strong seasonal influence even though the patterns are different the loue catchment stations show mostly positive hi values in winter and spring and negative hi values in summer and fall this corresponds to clockwise and anticlockwise ec q loops respectively analyzed in line with slope values see fig 3 these loops show that in winter and spring the dominant contribution is ew with a minor contribution of pew at the beginning of storm events in summer and fall the dominant contribution is pew with a minor contribution of ew or slightly mineralized pew at the beginning of storm events contrary to the loue catchment cèze catchment stations show mostly positive hi values in fall corresponding to clockwise loops during this season slope values are mostly negative showing that the dominant contribution is ew associated with a minor contribution of pew at the beginning of storm events in winter hi values are near zero corresponding to non hysteretic ec q paths similar ec values for a given discharge amount on rising and falling limbs during this season slope values are primarily negative showing that the dominant contribution is ew on both limbs table 1 summarizes the main ec q loop types on the loue and cèze catchments for all seasons in the loue catchment predominantly clockwise ec q hysteresis loops c and c0 occur during winter and spring while anticlockwise loops a0 and a dominate in summer and fall conversely the cèze catchment stations show mostly non hysteretic behavior in winter n loops and show clockwise loops c and c0 in summer and fall as these results provide information for nested catchments their analysis on successive stations can highlight spatial variability in flood water origin towards the final outlet even though ec q loop types are quite homogeneous for the four stations for a given catchment some differences are observed regarding loue catchment the nans and chenecey stations have particularly low slope values indeed except for summer events most of their ec q loops have slopes lower than 1 fig 7a this indicates a greater ew effect at the nans chenecey and vuillafans chenecey downstream reaches see fig 4a this is also the case regarding cèze catchment where lower slopes are characterized for montclus because each nested catchment incorporates the upstream previous one these intra site trends are not totally straightforward and can hardly be quantified 4 2 ec of reach scale lateral flow fig 8 shows examples of observed q and ec at input qin and output qout stations as well as simulated lateral ql and ecl for the loue a b and cèze c d catchments on the loue catchment example left ecl ecin and ecout are similar with values ranging between 350 and 400 µs cm 1 meaning that the mass flux remains quite proportional to discharge rate on the cèze catchment example right as qo is slightly delayed near peak flow simulated ql shows a brief period of loss negative values the corresponding ecl is not calculated for outflows as it would lead to negative values ecl for inflows values are around 250 µs cm 1 slightly higher than measured input and output ec 200 µs cm 1 indicating pew mobilization ecl values decrease at the end of the period indicating the decreased contribution of pew fig 9 shows the distribution of simulated lateral flow ec on the loue and cèze river reaches ecl mean values are calculated around the peak of lateral flow ql 0 75ql max so as to obtain a value that is representative of the major amount of lateral water inflow values of ew and pew ec end members are also plotted on the graphs as the simulation of ecl values is made using the dwe it requires a simple reach with one input and one output for this reason the nans chenecey reach is not represented see the river confluence on fig 4a regarding the loue catchment fig 9a the upstream reach ouhans vuillafans shows ecl values mainly above 400 μs cm 1 except for some winter storm events lateral water inflows are thus of mixed origin on the downstream reach vuillafans chenecey ecl values are lower mostly less than 400 μs cm 1 this reach scale approach provides more precise and discretized information of the streamflow contribution variability within catchment and is consistent with the lower slope values measured at the chenecey station in fig 7 indicating a higher ew signature this can be explained by a higher contribution of either surface runoff downstream the canyon area open valleys in the downstream parts of the catchment or ew from fast infiltration pathways or both it is also noticeable that ecl distribution are more spreaded on the downstream reach probably due to more intense or frequent water mixing on the cèze catchment fig 9b ecl values span from 100 to 300 μs cm 1 on the two median reaches tharaux montclus and montclus laroque whereas most ecl values on the downstream reach laroque bagnols are lower around 100 μs cm 1 this pattern is consistent with its karst outcrop location located between tharaux and laroque fig 4b and the ec river measurement fig 5b 5 discussion 5 1 conceptual model of flood water origin and process variability fig 10 a to 10d show the main hysteresis loop types associated hydrographs and the scheme of flood water origin and processes for the loue unary and cèze binary karst catchments for two contrasted periods in the hydrological cycle fig 10e and 10f represent within each catchment the reach scale variability of streamflow contribution the conceptual model provides key insights into the influence of seasons and karst configuration on flood processes in the loue unary karst catchment mainly c type ec q loops are observed from november to may fig 10a corresponding to a dominant contribution sequence of 1 mix of ew and pew and 2 ew this sequence can be explained by a two step process involving 1 during the rising limb ew infiltrating into karst drains and pushing pew into the stream associated with ew from fast infiltration or surface runoff and 2 during the falling limb ew that infiltrated into karst drains reaching the stream associated with surface runoff from june to october fig 10b mainly a type loops are observed corresponding to a dominant contribution sequence of 1 mixed water and 2 pew this can be explained by a lower degree of saturation in the karst system reducing surface runoff contribution and showing a purely piston type flow leaching the pew initially stored in the aquifer in the cèze binary karst catchment n type loops are the most common between november and may fig 10c corresponding to a dominant contribution of ew during both rising and falling limbs this pattern is explained by the lower storage capacity of smaller karst units compared to the loue catchment the high karst system saturation level leads to a blocked infiltration and promotes increased ew surface runoff from june to october fig 10d c ec q loops are the most common type observed corresponding to a dominant contribution sequence of 1 mixed water and 2 ew at this period of the year the karst system is less saturated which reduces the surface runoff signature associated with blocked infiltration and shows pew reaching streams by piston type flow associated with the ew influence leading to similar processes as described for fig 10a the surface runoff contribution to streamflow is less important in the loue catchment compared to the cèze one as seen in previous sections this fact is explained by the catchment s morphology which is for the unary catchment a typical configuration of plateaus and canyons that promotes higher rainfall infiltration and groundwater contribution to surface flows le mesnil et al 2020 this type of surface water groundwater interaction is promoted in other catchments made up of plateaus and canyons where stream losses and or lateral gains from springs occur according to hydrological conditions bailly comte et al 2009 de waele et al 2010 charlier et al 2019 our results confirm this behavior which results in increased ec values and positive slope values of the hysteresis ec q loops because the saturation level of the karst aquifer also plays an important role on the mobilisation of pew and ew its low or high storage capacity can affect flood process variability to interpret surface runoff contributions in the cèze catchment we need to refer to the two main types of flooding that are documented in the literature for karst areas 1 infiltration excess runoff due to the low infiltration capacity of the karst medium maréchal et al 2008 and 2 backflooding following infiltration with a simultaneous rapid rise of the aquifer water level due to a limited saturation capacity of the conduit network lópez chicano et al 2002 bonacci et al 2006 bailly comte et al 2008 the first process is linked to rainfall intensities that are high under the specific mediterranean climate of the cèze river the second one is more dependent on the storage capacity of the karst aquifer which is small for the cèze compared to high elevation plateaux for the loue superimposed on seasonal influence physiographical factors also control intra site variability of flood processes and catchment s response to storm events indeed the extension of karst areas and topographic relief can both affect the water origin of streamflow in the loue catchment the reach scale lateral flow simulation section 4 2 highlights a water origin spatial variability characterized by an increasing ew contribution to storm events in the downstream direction this increased ew contribution is explained by the typical plateau and canyon morphology of the upstream portion grading into open valleys downstream resulting in higher surface runoff the cèze catchment as shown in fig 4b is characterized by a binary karst that is a delineated karstified area downstream of hard rock headwater zones le mesnil et al 2020 2021 showed that this specific karst location plays a role in the annual water budget as well as in the flood pattern in this study ec monitoring shows that it also controls flood water origin as illustrated by ec values increasing on the karst zone fig 5b this spatial variability within the cèze catchment was detected by our reach scale approach of lateral flow simulation ecl values being increasing in the median reaches where the karst crops out this approach shows that water being mobilized during floods has a higher pew signature in this zone fig 10e and 10f provide a sketch of the main features of streamflow contribution variability within each study site 5 2 pros and cons of the c q relationship analysis approach our approach makes it possible to differentiate storm events in which pew may or may not be mobilized thanks to ec monitoring this approach is a suitable for assessing the role of groundwater in flooding which in many cases is supposed to be mobilized without being quantified e g ascott et al 2017 for example applying this methodology in the context of groundwater induced flooding in chalk regions finch et al 2004 pinault et al 2005 or lowland karst areas jerome morrissey et al 2020 may be of great value as well as for rivers that show complex and variable exchanges with underlying aquifers bailly comte et al 2009 charlier at al 2015 2019 indeed a better understanding of the groundwater role in flooding is essential for efficient management of flood hazards in karst areas several authors develop tools in this purpose gill et al 2013 mayaud et al 2019 a recent study of le mesnil et al 2021 based on 108 gauging stations shows in the one hand that karst promotes generally peak flow attenuation due partly to higher water infiltration from rivers and in the other hand that the hydrological response is highly site specific the development of approaches investigating water origin as proposed in this paper gives interesting perspective to explore such variability and to facilitate their modeling for example using semi distributed models moreover the proposed approach was kept generic enough to be applicable to a variety of contexts this section provides a brief summary of the main features of this two step methodology what can be expected from its application and what it requires the nested catchment scale approach is integrative as it provides information on the topographic catchment from a particular monitoring station to its upstream limit even so analysis of results at successive monitoring stations provides information on water origin and flood process variability along the river loop slope and hysteresis index lloyd et al 2016 of c q paths can be used to classify storm events through the use of a loop typology adapted and enriched from the work of evans and davies 1998 other hysteresis classifications have been proposed previously for karst areas but include less types and do not allow to represent all storm processes e g the 3 type t c curve classification by fournier et al 2007 our classification can be used with a variety of parameters ec concentrations turbidity involving different processes in the framework of this study it allowed determining flood water origin seasonal patterns on the two studied catchments this first approach requires only concentration and discharge datasets at a consistent resolution hourly for storm event analysis possibly wider time steps for other purposes for one outlet station it can thus be easily implemented at little cost especially for ec continuous monitoring this nested catchment scale approach involves some limitations first the concentration ranking of potential contributing end members must be known to make a consistent interpretation of the involved processes then no more than two end members can be differentiated when monitoring one concentration variable finally in the specific case of karst systems the approach cannot always properly differentiate between ew that originates from surface runoff and ew that originates from fast infiltration through underground karst conduits indeed localized infiltration in sinkholes for instance can be quick enough to keep water chemistry unchanged due to residence times of few hours days in this case other techniques such as signal processing or baseflow separation might be necessary to figure out comprehensively which flood processes are involved as well as analysis of alternative physico chemical data such as organic carbon to track infiltration water with short residence time pronk et al 2009 charlier et al 2012 some anomalous ec variations can also be witnessed during high flow periods as groundwater catchments expand and incorporate areas of different typical ec values ravbar et al 2011 the reach scale approach is based on the inverse modeling approach moussa 1996 using the diffusive wave equation it allows simulating q and c variations in lateral exchange flow of a river reach cholet et al 2017 analyzed along with end member ec values this analysis highlighted the increasing contribution of ew towards the downstream end of the loue catchment and the major pew contribution in the karst zone in the median area of the cèze catchment this analytical approach is very convenient as it allows investigating spatial variability of lateral exchanges without conducting extensive field work such as tracing tests e g covino et al 2011 this second part is more data dependent as it requires similar datasets than the first part but recorded at both inlet and outlet stations moreover the approximate ec value of each end member must be known to interpret the results in terms of water origin mixing though this reach scale approach provides more precise and discretized information on spatial variability of streamflow contributions within catchments 6 conclusions we applied a c q relationship analysis approach using hysteresis loop classification at the nested catchment scale combined with lateral flow and concentration simulation at the reach scale in the framework of this study this combined method made it possible to establish a seasonal conceptual model of water origin during storm events for two contrasted karst catchments and to infer its spatial variability at the scale of the monitoring network analysis of ec q hysteresis loops highlighted a flood water origin pattern with successive contributions of pre event water pew and event water ew according to karst type unary vs binary and seasonality low flow periods vs high flow periods simulation of lateral exchange flows led to a more detailed analysis of the water origin spatializing it at the reach scale this analysis highlighted the decreasing contribution of pew in favor of ew as the canyons and plateaus that the loue flows through grade into open valleys the significant pew effect on the karst area of the cèze catchment and the role of the aquifer saturation state in flood response our results show that in karst context the nested catchment scale analysis of c q hysteresis loops provides information on seasonality of flood processes and trends of intra catchment variability we also show that the reach scale lateral flow simulation provides a quantifiable information on intra catchment variability of streamflow contributions the tested approach is innovative and particularly suitable for partly karstified catchments as it is semi distributed and uses ec measurements which are a reliable proxy of water residence time our results are encouraging to apply these complementary methodologies to a variety of sites of differing geology with additional investigational purposes such as water resource management and modeling indeed such approach providing discretized information on flood processes within catchments could help refining lumped model structure or facilitate the use of semi distributed models some perspectives are identified as coupling the monitoring of multiple solutes making it possible to differentiate additional end members author contribution rm and jbc were involved in conceptualization funding acquisition and supervision mlm gathered the data and designed the methodology with the help of jbc rm and yc mlm prepared the manuscript with the help of all co authors declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the work was funded by the french governmental administration for risk prevention dgpr the service central d hydrométéorologie et d appui à la prévision des inondations schapi and the french geological survey brgm hourly streamflow data were gathered from the banque hydro database using a script available at http doi org 10 5281 zenodo 3744183 ec datasets of the loue catchment were monitored within the quarstic network funded by the brgm the doubs department and the rhône mediterranean corsica water agency and the nutri karst project founded by brgm and rhône mediterranean corsica water agency the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a hayami analytical resolution of dwe and ade diffusive wave equation an inverse modelling approach is adopted for simulating lateral flow between two gauging stations this approach simulates the lateral flow ql based on measurements from two gauging stations qi and qo the diffusive wave equation dwe accounting for lateral flow is an approximation of the st venant equation that can be written as a1 q t c q q x q d q 2 q x 2 q x 0 where x l is the length along the channel t t is the time and celerity c q lt 1 and diffusivity d q l2t 1 are functions of the discharge q l3t 1 the term q x t l2t 1 represents the lateral flow distribution the lateral hydrograph ql t is given by a2 q l t 0 l q x t d x with l l the channel length moussa 1996 extended the solution of the dwe under hayami s hypotheses semi infinite channel c q and d q constant to the case where lateral flow is uniformly distributed along the channel let i t and o t be the inlet flow minus baseflow and the outlet flow minus baseflow respectively a3 o t φ t i t φ t k t with k t the hayami kernel function defined as a4 k t l 2 π d 1 2 e cl 4 d 2 l ct ct l t 3 2 and a5 φ t c l 0 t q l θ q l 0 d θ the inverse problem under hayami s conditions and assuming that lateral flow is uniformly distributed along the channel moussa 1996 proposed a solution of the inverse problem this enables evaluation of the temporal distribution of lateral flow ql t over the channel reach by knowing i t and o t knowing c d and l the lateral flow can be calculated using the following procedure a6 l t o t i t k t a7 k i t k k k i t i m e s a8 φ t l t l t i 1 k i t and finally the lateral flow ql c t a9 q l c t q l 0 l c d φ dt the dwe equation has two free parameters namely celerity c m s 1 and diffusivity d m2 s 1 of the flood wave sensitivity analysis of the dwe to the two parameters is largely available in the literature showing that it is more sensitive to parameter c than d moussa and bocquillon 1996 cholet al 2017 charlier et al 2019 therefore c is assumed equal to time delay between peak discharges of qi and qo and d is fixed in accordance with stream characterization proposed by todini 1996 the dwe solution was validated experimentally under controlled conditions moussa and majdalani 2019 and has been implemented on natural karst catchments charlier et al 2015 2019 cholet et al 2017 the lateral mass fluxes ml simulation by the ade is done using the same analytical solution than dwe as under some hypotheses the physical equations of both the dwe and the ade can lead to similar mathematical expressions ml is simulated using mi and mo concentration discharge c q relationship analyses allow better understanding catchment water origin and hydrological process variability across time from storm event to pluriannual scale though those approaches mostly include integrative methods that consider catchments as a whole the aim of this article is to assess the potential of a combined approach to investigate the spatio temporal variability of flood processes within catchments across river reaches and seasons focusing on karst areas the methodology consists in combining c q relationship analysis in nested catchments and simulation of lateral exchanges at the reach scale for that we analyze high frequency records of discharge and electrical conductivity ec in karst catchments in which ec informs on water residence time contributions of pre event water pew and event water ew during storm events are investigated through hysteresis loop analysis at each gauging station combined with lateral ec simulation at the reach scale they make it possible to infer runoff processes during storms a unary karst catchment in a temperate mountainous climate loue river and a binary catchment in a mediterranean climate cèze river were selected in france and their conceptual models of water origin and hydrological process variability were drawn in the loue catchment summer and fall storm events are characterized by contributions of pew through piston type flows whereas decreasing ec values in winter and spring storm events indicate the major contribution of ew through surface runoff and fast infiltration within the catchment ew contribution increases downstream due to the canyon river morphology grading into open valleys regarding the cèze catchment contributions of ew are higher indicating that fast infiltration and surface runoff are the dominant processes associated with a pew signature in summer and fall within the catchment pew contribution is found higher in karstified areas these results show that flood process seasonality is mainly related to karst aquifer saturation rate while intra site variability is linked to karst area extension and river morphology results are encouraging to extend this approach to a variety of sites notably those affected by significant surface water groundwater interaction and groundwater flooding such approach by providing a discretized information on flood processes could help refining lumped hydrological models or facilitate the use of semi distributed ones appendix b supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 127358 appendix b supplementary data the following are the supplementary data to this article supplementary data 1 
3751,concentration discharge c q relationship analyses allow better understanding catchment water origin and hydrological process variability across time from storm event to pluriannual scale though those approaches mostly include integrative methods that consider catchments as a whole the aim of this article is to assess the potential of a combined approach to investigate the spatio temporal variability of flood processes within catchments across river reaches and seasons focusing on karst areas the methodology consists in combining c q relationship analysis in nested catchments and simulation of lateral exchanges at the reach scale for that we analyze high frequency records of discharge and electrical conductivity ec in karst catchments in which ec informs on water residence time contributions of pre event water pew and event water ew during storm events are investigated through hysteresis loop analysis at each gauging station combined with lateral ec simulation at the reach scale they make it possible to infer runoff processes during storms a unary karst catchment in a temperate mountainous climate loue river and a binary catchment in a mediterranean climate cèze river were selected in france and their conceptual models of water origin and hydrological process variability were drawn in the loue catchment summer and fall storm events are characterized by contributions of pew through piston type flows whereas decreasing ec values in winter and spring storm events indicate the major contribution of ew through surface runoff and fast infiltration within the catchment ew contribution increases downstream due to the canyon river morphology grading into open valleys regarding the cèze catchment contributions of ew are higher indicating that fast infiltration and surface runoff are the dominant processes associated with a pew signature in summer and fall within the catchment pew contribution is found higher in karstified areas these results show that flood process seasonality is mainly related to karst aquifer saturation rate while intra site variability is linked to karst area extension and river morphology results are encouraging to extend this approach to a variety of sites notably those affected by significant surface water groundwater interaction and groundwater flooding such approach by providing a discretized information on flood processes could help refining lumped hydrological models or facilitate the use of semi distributed ones keywords concentration discharge karst storm hysteresis lateral flow 1 introduction runoff at the catchment outlet has different origins depending on the water flow paths in the surface subsurface and underground compartments the joint study of hydrological and hydrochemical signals through concentration discharge c q relationships can help improving our understanding of these origins and associated hydrological processes depending on the context and nature of investigations c q relationship analysis can be applied to different variables the most frequently monitored parameters being major ions or continuous physico chemical variables such as electrical conductivity turbidity alkalinity or ph e g rose 2003 a synthesis by knapp et al 2020 based on results obtained in a swiss mountainous catchment summarizes the main environmental drivers of c q relationships at the storm event and longer time scales the main approaches encountered in the literature for the study of these relationships are end member mixing analysis burns et al 2001 doctor et al 2006 statistical approaches anderson et al 1997 and hysteresis studies evans and davies 1998 evans et al 1999 rose 2003 rose et al 2018 they led to advances in the understanding of aquifer recharge and vulnerability house and warwick 1998 huebsch et al 2014 streamflow contributions ribolzi et al 2000 and storm event spring discharge toran and reisch 2012 most c q analyses are interpreted in terms of a two component system involving pre event water pew and event water ew evans et al 1999 rose 2003 or include a third component defined as soil or rapid infiltration water evans and davies 1998 ribolzi et al 2000 burns et al 2001 toran and reisch 2012 while most c q studies use the concentration values of different streamflow sources to perform the hydrograph separation some use an a priori separation to infer source concentration values neira et al 2020 at the catchment scale hysteresis analyses allow studying c q relationships using c and q data at a given monitoring station hysteresis loops are mainly characterized using classifications of loop shapes such as the widely used 6 type proposed by evans and davies 1998 or more recent 9 type ones butturini et al 2008 heathwaite and bieroza 2021 using hysteresis indices see a synthesis by lloyd et al 2016 these approaches make it possible to investigate streamflow contributions during storm events knowing concentration ranking of supposed end members rose 2003 vaughan et al 2017 when monitoring several gauging stations for q and c along the stream it is possible to assess c q relationship spatial variability at nested catchment scale it is also possible to characterize it using a reach scale approach between two gauging stations in that case water origin and flood hydrological processes can be investigated by analyzing lateral exchanges i e stream water gains or losses from or to groundwater such analyses were performed by covino et al 2011 and mallard et al 2014 using artificial tracing experiments to investigate stream composition changes analytical approaches also exist such as the advection diffusion equation ade widely used to model conservative solute transport runkel 1996 baeumer et al 2001 hauns et al 2001 luhmann et al 2012 this equation is mathematically similar to the diffusive wave equation dwe and both can be resolved using the hayami analytical solution 1951 making it possible to simulate lateral flows q and c cholet et al 2017 karst catchments are located in carbonate areas including limestone and dolomite and cover 20 of europe land surface and 35 in france goldscheider et al 2020 they are known to be complex permeable hydrosystems involving high rainfall infiltration rates through open conduits and promoting fast groundwater flow and significant surface water groundwater interaction bakalowicz 2005 in such areas electrical conductivity ec provides information on groundwater residence time and water origin as it is controlled by bicarbonate calcium and magnesium concentrations resulting from carbonate rock dissolution hess and white 1988 lambán et al 2015 liu et al 2007 because ec can be easily monitored at high frequency time steps it is a useful variable for the characterization of c q relationships particularly in karst catchments indeed the contrast between water end members is notable low mineralization ew from surface runoff or fast groundwater flow and high mineralization pew from groundwater present in the aquifer prior to the storm event the range of ec values is variable depending on groundwater residence time or mixing with fast rainwater infiltration and allow identifying pew and ew occurrence in the particular case of karst catchments an additional challenge is to distinguish ew from direct surface runoff on low permeability areas and ew from fast infiltration in open conduits feeding rivers through springs hartmann et al 2021 moreover unexpected ec variations can occur during high flow periods as groundwater boundaries extend and incorporate areas with different ec values ravbar et al 2011 various methodologies have been used to explore ec q relationships during storm events in karst catchments early studies mainly describe ec variations during storm events an ec drop being interpreted as an increasing ew contribution in streamflow and complex fluctuations corresponding to several simultaneous karst conduit contributions hess and white 1988 statistically based methods exist such as ec frequency distribution analysis massei et al 2007 which makes it possible to investigate the relative contributions of surface water and groundwater to streamflow and how they are influenced by hydrological conditions characterization of ec q hysteresis loops is also used which makes it possible to study delays between discharge and solute concentration variations bringing to light the changing hydrological processes at the scale of a storm event or between different events fournier et al 2007 toran and reisch 2012 hysteresis loops of hydrographs at different locations within a karst catchment were also studied to identify hydrological flows at nested catchment scale zhang et al 2020 analysis of ec and q patterns at the storm event time scale have also highlighted the importance of seasonal variability in the physico chemical response of a karstic spring fournier et al 2007 recently ec q relationships at the reach scale were studied by cholet et al 2017 using lateral exchange modeling to investigate conduit matrix relationship variability during storm events according to seasons each methodology helps better understanding hydrological processes and we identify a strong interest in combining different approaches and to investigate both nested and reach scales to improve the conceptual model of karst catchments the aim of this article is to assess the potential of a combined approach to investigate the spatio temporal variability of flood processes within karst catchments to do that we combine two spatial scales of investigation at the nested catchment scale a classification of c q hysteresis loops adapted to ec measurement in karst context at the reach scale an inverse modeling of lateral flow q and c using this combined approach we will define what can be learned from c q hysteresis loop analysis in karst catchment storm events and what additional information can bring the modeling of lateral flow q and c to answer these questions we apply the two step approach on hourly records of q and ec during storm events at four gauging stations in two karst catchments in france characterized by contrasting climate and karst area extension results are interpreted in terms of water origin using pew and ew contributions during storm events finally conceptual models are proposed that summarize the main information obtained with the combined approach regarding spatio temporal variability of flood processes 2 methodology 2 1 general methodology to propose a conceptual model of flood water origin spatio temporal variability a two part methodology was applied the parts correspond to two spatial scales i the nested catchment scale considering the topographic catchment upstream a gauging station and ii the reach scale considering the catchment delimited by two gauging stations both parts rely on hourly q and c data collection during storm events the difference being that reach scale analysis requires data from both inlet and outlet stations to analyze temporal variability the methodology was applied on storm events grouped by seasons fig 1 presents this general methodology from field measurement network and monitored variables to data processing at the nested catchment scale c q loops are analyzed for each storm event according to the methodology described in section 2 2 this analysis is performed at each monitoring station of the hydrograph network and characterizes flood processes occurring in the whole upstream topographic catchment it is thus a lumped approach at the catchment scale and successive analyses towards the final outlet are interpreted in terms of flood process variability of nested catchments even so a more spatially discrete approach at the reach scale is necessary to refine and spatialize this variability description at the reach scale the hourly lateral flow discharge ql and concentration cl variations are simulated using the dwe inverse model detailed in section 2 3 assuming that exchanges are uniformly distributed along river reaches although this may not be the case in karst systems this approach allows a more spatialized investigation of the location of lateral flows which commonly lacks in c q studies this reach scale approach consists in comparing obtained mean cl values to pew and ew end member c values more details regarding definitions of these end members are given in section 3 3 a season based storm event typology is proposed which allows interpreting hydrological response variability four seasons are defined based on typical hydrological dynamics of the study sites low water table and first storm events in september and october high precipitation volume winter events from november to march lower intensity events from april to may and occasional summer storm events from june to august finally a conceptual model that associates flood processes to different seasons and karst configurations is proposed in addition to a schematic representation of the spatial variability of water origin along river reaches 2 2 nested catchment scale approach c q loop analysis this section presents a c q loop classification that allows characterizing hysteresis loops obtained from the monitoring of various physico chemical parameters concentration turbidity ec evans and davies 1998 proposed a 6 type classification of c q loops based on the loop s general trend and its rotational direction this classification was used in later c q studies rose 2003 vaughan et al 2017 zhang et al 2020 building on evans and davies 1998 we use a modified loop typology enriched by the integration of a hysteresis index quantification and the inclusion of non hysteresis pathways similar 9 type classifications have been proposed and shown to be relevant for c q relationship studies butturini et al 2008 heathwaite and bieroza 2021 we calculated two indicators for loop classification slope s obtained by applying a linear regression to the c q values and hysteresis index hi the hysteresis index proposed by lloyd et al 2016 is used in this work it provides information on both the loop direction and its amplitude moreover it considers the whole range of discharge values and is calculated based on normalized q and ec values which facilitates consistent inter event and inter site comparison for a given storm event q and ec values are normalized between 0 and 1 and at each 5 interval i of normalized q a local hii is calculated following eq 1 1 hi i ec nri ec nfi where ecnri and ecnfi are normalized ec values at discharge interval i taken on the rising limb and falling limb of the loop respectively fig 2 represents local hii values and the slope value for an illustrative storm event the mean of the 19 hii values 5 intervals recommended by lloyd et al 2016 is used as the final hi value as a result hi values range from 1 to 1 absolute values near 0 and 1 corresponding to low and high hysteresis degrees respectively similar versus contrasting rising and falling paths negative hi values indicate anticlockwise loops whereas positive hi values indicate clockwise loops complex 8 shaped loops show an hi value corresponding to their primary shape i e the widest loop part with one rotational direction once threshold values are defined values of slope and hi that delineate the classification types measure slope and hi make it possible to relate any storm event to one of the nine categories of the classification presented in fig 3 using its c q loop the loop typology is built on two character names the first corresponding to hi sign and consequently to rotational direction c for clockwise n for neutral and a for anticlockwise and the second corresponding to the slope sign for negative s 0 for nil s and for positive s this classification based on butturini et al 2008 was adapted to the case of ec q in karst catchments in the case of karst areas event water ew having a lower residence time than pre event water pew its ec value is lower indeed ec is a reliable proxy of bicarbonates concentration which is linked to limestone dissolution and thus residence time peyraube et al 2019 therefore we will use our ec q loop typology to determine patterns of successive contributions to streamflow pew and ew assuming the ec ranking is known each loop type is linked to a specific pattern of successive contributions to streamflow based on the main findings in the literature of c q studies evans and davies 1998 showed that in a two component system when the solute concentration of pew is higher than that of ew anticlockwise c q loops indicate a dominant contribution of ew during the rising limb and a dominant contribution of pew during the falling limb scenario 1 on the other hand clockwise c q loops indicate a dominant pew contribution during the rising limb and a dominant ew contribution during the falling limb scenario 2 this c q loop taxonomic consistency was verified experimentally by chanat et al 2002 and was shown to be reliable when concentration values of end members are distinct enough which is the case here as surface runoff water and groundwater are compared see values at end of section 3 3 regarding the specific case of ec q hysteresis toran and reisch 2012 observed anticlockwise loops during storm events at a karst spring discharge in pennsylvania and verified that they were linked to scenario 1 based on ca2 and mg2 concentration monitoring rose et al 2018 linked scenario 2 to clockwise c q loops thanks to geogenic solute monitoring in a small usa catchment in the case of monitoring of solutes in which ew is enriched such as no3 from the organic horizon evans et al 1999 huebsch et al 2014 the rotational directions are reversed based on previously described findings from the literature and in our case of ec monitoring in a karst catchment where the pew solute concentration is higher our hypothesis is that clockwise ec q loops correspond to pew preceding ew and anticlockwise ec q loops correspond to ew preceding pew this is particularly clear with loops that have slopes equal to zero c0 and a0 loops rising and falling limbs showing ec values exclusively above or below the initial value prior to a storm event in the case of non zero loop slopes one limb may have mixed water origins a mixed water signature in the case of karst systems where fast infiltration can occur may result from low residence time pew recently stored in the karst i e from several days or weeks or from ew infiltrating through preferential pathways and mixing with highly mineralized pew i e several months or years old regarding non hysteretic ec q paths both limbs have a similar water origin this latter being inferred from the slope a negative slope indicating ew contribution whereas a positive slope indicating pew contribution this methodology is applicable only when the initial ec value falls between the two end member ec values this observation was systematically verified in the framework of this study the initial ec value always being higher than the ew end member ec value in karst areas more information on end member ec values is provided in section 3 3 on fig 3 that presents the nine loop types of our classification a framework of interpretation of associated streamflow contribution patterns is also proposed based on residence time which is inferred from ec values mixed water can be linked either to a mix of low and high residence time pew or to a mix of ew and high residence time pew 2 3 reach scale approach lateral flow simulation to investigate the origin of lateral inflows along river reaches i e between two gauging stations we used the modeling approach proposed by cholet et al 2017 based on the diffusive wave equation dwe and extended to the advection diffusion equation ade both equations are resolved using the hayami analytical solution 1951 as proposed by moussa 1996 we provide in this section the key points of the approach more details on this analytical approach are provided in the appendix separate modeling of lateral discharge ql and mass flux ml make it possible to assess lateral solute concentration cl by division as shown in equation 2 2 c l m l q l ql is simulated using the solution of the inverse problem of the dwe and ade assuming that lateral flow is uniformly distributed along the river reach moussa 1996 ml is obtained by applying the dwe to mass flux this latter being calculated as the product of ql and cl equation 2 assuming that total dissolved solids tds consists mainly of conductive ionic compounds ec is proportional to the tds concentration noted c in g m 3 concentration c is therefore calculated from ec using a constant factor of 0 64 in accordance with values found in the literature lloyd and heathcote 1985 3 c e c 0 64 mass flux m is then calculated as the product of concentration c and discharge q 4 m c q finally the simulated lateral conductivity ecl is calculated as the ratio of simulated lateral mass flux ml to simulated lateral discharge ql divided by a factor of 0 64 5 ec l m l q l 1 0 64 as some river reaches can show negative ql values indicating lateral streamflow losses ecl is calculated only for positive ql values indeed negative ql values would lead to negative ecl values which is impossible ecl variations thus make it possible to compare water origin on successive streams within a catchment 3 study areas and data sets 3 1 study areas the previously described methodology was applied to two catchments in france which are partially to strongly karstified and located in different geological and hydrometeorological settings fig 4 they are similar in size 1000 km2 and both include four q and ec measurement stations the loue river basin is located in the jura mountains its outcrops consist primarily of extensively and homogeneously karstified jurassic limestone and locally marl making it a unary karst basin the lison river is the major left bank loue tributary and oth rivers start as a karst spring the loue spring being partly fed by doubs river losses that occur in the southeastern part of the catchment charlier et al 2014 it is not a typically unary karst basin the term of unary karst basin is used here as the allogenic recharge is also from a similar karstified area the loue and lison springs are among the largest karst springs in europe chen et al 2017 with mean discharge of around 10 and 7 m3 s 1 respectively and maximum peak flows of around 80 and 70 m3 s 1 precipitation follows an elevation gradient annual values range from 1600 mm on the upstream catchment at elevations of 900 m a s l to 1450 mm at the outlet at an elevation of around 400 m a s l the cèze catchment is located in the eastern part of the cévennes mountains it can be characterized as a binary karst basin with upstream areas that consist of non karst outcrops i e hard rocks where mean yearly precipitation is 1500 mm and median and downstream areas underlain by karst plateaus that receive precipitation of approximately 1000 mm year the karstified portion is composed of early cretaceous limestone dark green fig 54b that is mainly situated between the tharaux and laroque stations and extends southward more information on exchanges between river streams and karst systems in this area can be found in the work of chapuis 2018 3 2 data sets detailed information on the data time series is available in the supplementary material temporal data used in this paper are hourly streamflow data available from the french public streamflow database banque hydro http www hydro eaufrance fr hourly rainfall data available from the antilope database champeaux et al 2011 a reanalysis produced by the french public meteorological service météo france http www meteofrance fr sub hourly ec measurements for the cèze river recorded by the brgm using schlumberger ctd diver probes from july 2019 to july 2020 similar data recorded using ott ms5 probes within the quarstic network charlier et al 2018 for the loue river from january 2016 to january 2020 as available data time series on the studied catchments are not of identical length and because of contrasted hydro climatic contexts 58 storm events were extracted for the loue catchment against 8 for the cèze catchment in the loue catchment storm events have a median precipitation depth of 58 mm min 10 mm and max 136 mm and a median peak flow value of 78 m3 s 1 min 2 m3 s 1 and max 529 m3 s 1 in the cèze catchment storm events have a median precipitation depth of 65 mm min 30 mm and max 180 mm and a median peak flow value of 128 m3 s 1 min 20 m3 s 1 and max 780 m3 s 1 3 3 ec end member values for the loue catchment the pew end member ec is defined as the signal for water having the longest residence time thus having the highest ec value at 550 μs cm 1 recorded during the acquisition period at the spring monitoring stations ouhans and nans see fig 4a the loue catchment ew end member ec for surface runoff is defined at 250 μs cm 1 based on values recorded on an intermittent stream on marly areas for the cèze catchment the pew end member is defined at 700 μs cm 1 based on highest values recorded at cèze karst springs monitoring stations chapuis 2018 the cèze catchment ew end member ec for surface runoff is defined at 75 μs cm 1 based on minimum values recorded during the acquisition period at the upstream monitoring station tharaux see fig 4b which is only fed by non karst areas 4 results 4 1 ec q relationships at the catchment scale fig 5 compares annual and event based mean ec values for the loue and cèze catchment stations to obtain the mean ec value of all water flowing through stations we calculated the flow weighted average of hourly ec for both annual and event based ec the four loue stations show similar values of around 400 and 350 μs cm 1 respectively this consistency across stations is probably linked to the homogeneous presence of karst areas leading to similar proportions of surface water and groundwater contribution to streamflow event based ec values are generally higher than annual ones indicating a dominant mobilization of pre event highly mineralized water during storms likely groundwater as the two downstream river stations vuillafans and chenecey show similar responses to the two spring stations nans and ouhans the cèze catchment stations show a spatial variability pattern with ec values increasing from upstream to downstream and decreasing again at the most downstream station annual values range from 180 μs cm 1 at tharaux to 280 μs cm 1 at laroque event based ec values follow the same trend in relation to the local karst extension the intermediate karst area located between tharaux and laroque see fig 5b promoting highly mineralized water event based ec values are mostly lower than annual ones showing a dominant stream dilution by low mineralization event water during storms except at the tharaux station fig 6 shows two examples of recorded ec and q variations for each study site loue a b cèze c d along with their corresponding ec q loops see fig 3 for classification these illustrative events were chosen as they are representative of the generally observed ec and q variations at each site regarding the loue catchment fig 6a shows a storm event associated with an ec drop that takes place mostly after peak flow and leads to a c loop type indicating an event water ew contribution that occurs mainly at the end of peak flow and during recession fig 6b shows that other storm events on the loue catchment are associated with an ec increase indicating pre event water pew mobilization on the pictured storm event ec variations are quite similar to q variations leading to a flatter ec q loop nevertheless ec values are slightly higher on the falling limb leading to an identifiable a loop type regarding the cèze catchment fig 6c illustrates a storm event associated with an ec decrease indicating dilution by event water and leading to a c loop type as shown in fig 6a finally fig 6d represents a storm event with strongly anticorrelated ec and q variations during both rising and falling limbs leading to a non hysteretic n loop type fig 7 a and 7b show the seasonal slope value distribution in the loue and cèze catchments respectively all stations in the loue catchment exhibit a similar pattern of seasonal variation with negative or low slopes in winter november to march and spring april to may and positive values in summer june to august and fall september to october this shows that storm events in winter and spring are primarily characterized by an ew dilution while storm events in summer and fall are mainly characterized by a pew mobilization from june to october the variability of slope is higher moreover slope values are generally lower at the nans and chenecey stations than at the others regarding the cèze catchments slope values are mostly negative all year long except for a few winter storm events at the tharaux and bagnols stations indicating the dominant dilution by low mineralization ew fig 7c and 7d show the hi value distribution following seasons for the loue and cèze catchments respectively both catchments are subject to strong seasonal influence even though the patterns are different the loue catchment stations show mostly positive hi values in winter and spring and negative hi values in summer and fall this corresponds to clockwise and anticlockwise ec q loops respectively analyzed in line with slope values see fig 3 these loops show that in winter and spring the dominant contribution is ew with a minor contribution of pew at the beginning of storm events in summer and fall the dominant contribution is pew with a minor contribution of ew or slightly mineralized pew at the beginning of storm events contrary to the loue catchment cèze catchment stations show mostly positive hi values in fall corresponding to clockwise loops during this season slope values are mostly negative showing that the dominant contribution is ew associated with a minor contribution of pew at the beginning of storm events in winter hi values are near zero corresponding to non hysteretic ec q paths similar ec values for a given discharge amount on rising and falling limbs during this season slope values are primarily negative showing that the dominant contribution is ew on both limbs table 1 summarizes the main ec q loop types on the loue and cèze catchments for all seasons in the loue catchment predominantly clockwise ec q hysteresis loops c and c0 occur during winter and spring while anticlockwise loops a0 and a dominate in summer and fall conversely the cèze catchment stations show mostly non hysteretic behavior in winter n loops and show clockwise loops c and c0 in summer and fall as these results provide information for nested catchments their analysis on successive stations can highlight spatial variability in flood water origin towards the final outlet even though ec q loop types are quite homogeneous for the four stations for a given catchment some differences are observed regarding loue catchment the nans and chenecey stations have particularly low slope values indeed except for summer events most of their ec q loops have slopes lower than 1 fig 7a this indicates a greater ew effect at the nans chenecey and vuillafans chenecey downstream reaches see fig 4a this is also the case regarding cèze catchment where lower slopes are characterized for montclus because each nested catchment incorporates the upstream previous one these intra site trends are not totally straightforward and can hardly be quantified 4 2 ec of reach scale lateral flow fig 8 shows examples of observed q and ec at input qin and output qout stations as well as simulated lateral ql and ecl for the loue a b and cèze c d catchments on the loue catchment example left ecl ecin and ecout are similar with values ranging between 350 and 400 µs cm 1 meaning that the mass flux remains quite proportional to discharge rate on the cèze catchment example right as qo is slightly delayed near peak flow simulated ql shows a brief period of loss negative values the corresponding ecl is not calculated for outflows as it would lead to negative values ecl for inflows values are around 250 µs cm 1 slightly higher than measured input and output ec 200 µs cm 1 indicating pew mobilization ecl values decrease at the end of the period indicating the decreased contribution of pew fig 9 shows the distribution of simulated lateral flow ec on the loue and cèze river reaches ecl mean values are calculated around the peak of lateral flow ql 0 75ql max so as to obtain a value that is representative of the major amount of lateral water inflow values of ew and pew ec end members are also plotted on the graphs as the simulation of ecl values is made using the dwe it requires a simple reach with one input and one output for this reason the nans chenecey reach is not represented see the river confluence on fig 4a regarding the loue catchment fig 9a the upstream reach ouhans vuillafans shows ecl values mainly above 400 μs cm 1 except for some winter storm events lateral water inflows are thus of mixed origin on the downstream reach vuillafans chenecey ecl values are lower mostly less than 400 μs cm 1 this reach scale approach provides more precise and discretized information of the streamflow contribution variability within catchment and is consistent with the lower slope values measured at the chenecey station in fig 7 indicating a higher ew signature this can be explained by a higher contribution of either surface runoff downstream the canyon area open valleys in the downstream parts of the catchment or ew from fast infiltration pathways or both it is also noticeable that ecl distribution are more spreaded on the downstream reach probably due to more intense or frequent water mixing on the cèze catchment fig 9b ecl values span from 100 to 300 μs cm 1 on the two median reaches tharaux montclus and montclus laroque whereas most ecl values on the downstream reach laroque bagnols are lower around 100 μs cm 1 this pattern is consistent with its karst outcrop location located between tharaux and laroque fig 4b and the ec river measurement fig 5b 5 discussion 5 1 conceptual model of flood water origin and process variability fig 10 a to 10d show the main hysteresis loop types associated hydrographs and the scheme of flood water origin and processes for the loue unary and cèze binary karst catchments for two contrasted periods in the hydrological cycle fig 10e and 10f represent within each catchment the reach scale variability of streamflow contribution the conceptual model provides key insights into the influence of seasons and karst configuration on flood processes in the loue unary karst catchment mainly c type ec q loops are observed from november to may fig 10a corresponding to a dominant contribution sequence of 1 mix of ew and pew and 2 ew this sequence can be explained by a two step process involving 1 during the rising limb ew infiltrating into karst drains and pushing pew into the stream associated with ew from fast infiltration or surface runoff and 2 during the falling limb ew that infiltrated into karst drains reaching the stream associated with surface runoff from june to october fig 10b mainly a type loops are observed corresponding to a dominant contribution sequence of 1 mixed water and 2 pew this can be explained by a lower degree of saturation in the karst system reducing surface runoff contribution and showing a purely piston type flow leaching the pew initially stored in the aquifer in the cèze binary karst catchment n type loops are the most common between november and may fig 10c corresponding to a dominant contribution of ew during both rising and falling limbs this pattern is explained by the lower storage capacity of smaller karst units compared to the loue catchment the high karst system saturation level leads to a blocked infiltration and promotes increased ew surface runoff from june to october fig 10d c ec q loops are the most common type observed corresponding to a dominant contribution sequence of 1 mixed water and 2 ew at this period of the year the karst system is less saturated which reduces the surface runoff signature associated with blocked infiltration and shows pew reaching streams by piston type flow associated with the ew influence leading to similar processes as described for fig 10a the surface runoff contribution to streamflow is less important in the loue catchment compared to the cèze one as seen in previous sections this fact is explained by the catchment s morphology which is for the unary catchment a typical configuration of plateaus and canyons that promotes higher rainfall infiltration and groundwater contribution to surface flows le mesnil et al 2020 this type of surface water groundwater interaction is promoted in other catchments made up of plateaus and canyons where stream losses and or lateral gains from springs occur according to hydrological conditions bailly comte et al 2009 de waele et al 2010 charlier et al 2019 our results confirm this behavior which results in increased ec values and positive slope values of the hysteresis ec q loops because the saturation level of the karst aquifer also plays an important role on the mobilisation of pew and ew its low or high storage capacity can affect flood process variability to interpret surface runoff contributions in the cèze catchment we need to refer to the two main types of flooding that are documented in the literature for karst areas 1 infiltration excess runoff due to the low infiltration capacity of the karst medium maréchal et al 2008 and 2 backflooding following infiltration with a simultaneous rapid rise of the aquifer water level due to a limited saturation capacity of the conduit network lópez chicano et al 2002 bonacci et al 2006 bailly comte et al 2008 the first process is linked to rainfall intensities that are high under the specific mediterranean climate of the cèze river the second one is more dependent on the storage capacity of the karst aquifer which is small for the cèze compared to high elevation plateaux for the loue superimposed on seasonal influence physiographical factors also control intra site variability of flood processes and catchment s response to storm events indeed the extension of karst areas and topographic relief can both affect the water origin of streamflow in the loue catchment the reach scale lateral flow simulation section 4 2 highlights a water origin spatial variability characterized by an increasing ew contribution to storm events in the downstream direction this increased ew contribution is explained by the typical plateau and canyon morphology of the upstream portion grading into open valleys downstream resulting in higher surface runoff the cèze catchment as shown in fig 4b is characterized by a binary karst that is a delineated karstified area downstream of hard rock headwater zones le mesnil et al 2020 2021 showed that this specific karst location plays a role in the annual water budget as well as in the flood pattern in this study ec monitoring shows that it also controls flood water origin as illustrated by ec values increasing on the karst zone fig 5b this spatial variability within the cèze catchment was detected by our reach scale approach of lateral flow simulation ecl values being increasing in the median reaches where the karst crops out this approach shows that water being mobilized during floods has a higher pew signature in this zone fig 10e and 10f provide a sketch of the main features of streamflow contribution variability within each study site 5 2 pros and cons of the c q relationship analysis approach our approach makes it possible to differentiate storm events in which pew may or may not be mobilized thanks to ec monitoring this approach is a suitable for assessing the role of groundwater in flooding which in many cases is supposed to be mobilized without being quantified e g ascott et al 2017 for example applying this methodology in the context of groundwater induced flooding in chalk regions finch et al 2004 pinault et al 2005 or lowland karst areas jerome morrissey et al 2020 may be of great value as well as for rivers that show complex and variable exchanges with underlying aquifers bailly comte et al 2009 charlier at al 2015 2019 indeed a better understanding of the groundwater role in flooding is essential for efficient management of flood hazards in karst areas several authors develop tools in this purpose gill et al 2013 mayaud et al 2019 a recent study of le mesnil et al 2021 based on 108 gauging stations shows in the one hand that karst promotes generally peak flow attenuation due partly to higher water infiltration from rivers and in the other hand that the hydrological response is highly site specific the development of approaches investigating water origin as proposed in this paper gives interesting perspective to explore such variability and to facilitate their modeling for example using semi distributed models moreover the proposed approach was kept generic enough to be applicable to a variety of contexts this section provides a brief summary of the main features of this two step methodology what can be expected from its application and what it requires the nested catchment scale approach is integrative as it provides information on the topographic catchment from a particular monitoring station to its upstream limit even so analysis of results at successive monitoring stations provides information on water origin and flood process variability along the river loop slope and hysteresis index lloyd et al 2016 of c q paths can be used to classify storm events through the use of a loop typology adapted and enriched from the work of evans and davies 1998 other hysteresis classifications have been proposed previously for karst areas but include less types and do not allow to represent all storm processes e g the 3 type t c curve classification by fournier et al 2007 our classification can be used with a variety of parameters ec concentrations turbidity involving different processes in the framework of this study it allowed determining flood water origin seasonal patterns on the two studied catchments this first approach requires only concentration and discharge datasets at a consistent resolution hourly for storm event analysis possibly wider time steps for other purposes for one outlet station it can thus be easily implemented at little cost especially for ec continuous monitoring this nested catchment scale approach involves some limitations first the concentration ranking of potential contributing end members must be known to make a consistent interpretation of the involved processes then no more than two end members can be differentiated when monitoring one concentration variable finally in the specific case of karst systems the approach cannot always properly differentiate between ew that originates from surface runoff and ew that originates from fast infiltration through underground karst conduits indeed localized infiltration in sinkholes for instance can be quick enough to keep water chemistry unchanged due to residence times of few hours days in this case other techniques such as signal processing or baseflow separation might be necessary to figure out comprehensively which flood processes are involved as well as analysis of alternative physico chemical data such as organic carbon to track infiltration water with short residence time pronk et al 2009 charlier et al 2012 some anomalous ec variations can also be witnessed during high flow periods as groundwater catchments expand and incorporate areas of different typical ec values ravbar et al 2011 the reach scale approach is based on the inverse modeling approach moussa 1996 using the diffusive wave equation it allows simulating q and c variations in lateral exchange flow of a river reach cholet et al 2017 analyzed along with end member ec values this analysis highlighted the increasing contribution of ew towards the downstream end of the loue catchment and the major pew contribution in the karst zone in the median area of the cèze catchment this analytical approach is very convenient as it allows investigating spatial variability of lateral exchanges without conducting extensive field work such as tracing tests e g covino et al 2011 this second part is more data dependent as it requires similar datasets than the first part but recorded at both inlet and outlet stations moreover the approximate ec value of each end member must be known to interpret the results in terms of water origin mixing though this reach scale approach provides more precise and discretized information on spatial variability of streamflow contributions within catchments 6 conclusions we applied a c q relationship analysis approach using hysteresis loop classification at the nested catchment scale combined with lateral flow and concentration simulation at the reach scale in the framework of this study this combined method made it possible to establish a seasonal conceptual model of water origin during storm events for two contrasted karst catchments and to infer its spatial variability at the scale of the monitoring network analysis of ec q hysteresis loops highlighted a flood water origin pattern with successive contributions of pre event water pew and event water ew according to karst type unary vs binary and seasonality low flow periods vs high flow periods simulation of lateral exchange flows led to a more detailed analysis of the water origin spatializing it at the reach scale this analysis highlighted the decreasing contribution of pew in favor of ew as the canyons and plateaus that the loue flows through grade into open valleys the significant pew effect on the karst area of the cèze catchment and the role of the aquifer saturation state in flood response our results show that in karst context the nested catchment scale analysis of c q hysteresis loops provides information on seasonality of flood processes and trends of intra catchment variability we also show that the reach scale lateral flow simulation provides a quantifiable information on intra catchment variability of streamflow contributions the tested approach is innovative and particularly suitable for partly karstified catchments as it is semi distributed and uses ec measurements which are a reliable proxy of water residence time our results are encouraging to apply these complementary methodologies to a variety of sites of differing geology with additional investigational purposes such as water resource management and modeling indeed such approach providing discretized information on flood processes within catchments could help refining lumped model structure or facilitate the use of semi distributed models some perspectives are identified as coupling the monitoring of multiple solutes making it possible to differentiate additional end members author contribution rm and jbc were involved in conceptualization funding acquisition and supervision mlm gathered the data and designed the methodology with the help of jbc rm and yc mlm prepared the manuscript with the help of all co authors declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the work was funded by the french governmental administration for risk prevention dgpr the service central d hydrométéorologie et d appui à la prévision des inondations schapi and the french geological survey brgm hourly streamflow data were gathered from the banque hydro database using a script available at http doi org 10 5281 zenodo 3744183 ec datasets of the loue catchment were monitored within the quarstic network funded by the brgm the doubs department and the rhône mediterranean corsica water agency and the nutri karst project founded by brgm and rhône mediterranean corsica water agency the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a hayami analytical resolution of dwe and ade diffusive wave equation an inverse modelling approach is adopted for simulating lateral flow between two gauging stations this approach simulates the lateral flow ql based on measurements from two gauging stations qi and qo the diffusive wave equation dwe accounting for lateral flow is an approximation of the st venant equation that can be written as a1 q t c q q x q d q 2 q x 2 q x 0 where x l is the length along the channel t t is the time and celerity c q lt 1 and diffusivity d q l2t 1 are functions of the discharge q l3t 1 the term q x t l2t 1 represents the lateral flow distribution the lateral hydrograph ql t is given by a2 q l t 0 l q x t d x with l l the channel length moussa 1996 extended the solution of the dwe under hayami s hypotheses semi infinite channel c q and d q constant to the case where lateral flow is uniformly distributed along the channel let i t and o t be the inlet flow minus baseflow and the outlet flow minus baseflow respectively a3 o t φ t i t φ t k t with k t the hayami kernel function defined as a4 k t l 2 π d 1 2 e cl 4 d 2 l ct ct l t 3 2 and a5 φ t c l 0 t q l θ q l 0 d θ the inverse problem under hayami s conditions and assuming that lateral flow is uniformly distributed along the channel moussa 1996 proposed a solution of the inverse problem this enables evaluation of the temporal distribution of lateral flow ql t over the channel reach by knowing i t and o t knowing c d and l the lateral flow can be calculated using the following procedure a6 l t o t i t k t a7 k i t k k k i t i m e s a8 φ t l t l t i 1 k i t and finally the lateral flow ql c t a9 q l c t q l 0 l c d φ dt the dwe equation has two free parameters namely celerity c m s 1 and diffusivity d m2 s 1 of the flood wave sensitivity analysis of the dwe to the two parameters is largely available in the literature showing that it is more sensitive to parameter c than d moussa and bocquillon 1996 cholet al 2017 charlier et al 2019 therefore c is assumed equal to time delay between peak discharges of qi and qo and d is fixed in accordance with stream characterization proposed by todini 1996 the dwe solution was validated experimentally under controlled conditions moussa and majdalani 2019 and has been implemented on natural karst catchments charlier et al 2015 2019 cholet et al 2017 the lateral mass fluxes ml simulation by the ade is done using the same analytical solution than dwe as under some hypotheses the physical equations of both the dwe and the ade can lead to similar mathematical expressions ml is simulated using mi and mo concentration discharge c q relationship analyses allow better understanding catchment water origin and hydrological process variability across time from storm event to pluriannual scale though those approaches mostly include integrative methods that consider catchments as a whole the aim of this article is to assess the potential of a combined approach to investigate the spatio temporal variability of flood processes within catchments across river reaches and seasons focusing on karst areas the methodology consists in combining c q relationship analysis in nested catchments and simulation of lateral exchanges at the reach scale for that we analyze high frequency records of discharge and electrical conductivity ec in karst catchments in which ec informs on water residence time contributions of pre event water pew and event water ew during storm events are investigated through hysteresis loop analysis at each gauging station combined with lateral ec simulation at the reach scale they make it possible to infer runoff processes during storms a unary karst catchment in a temperate mountainous climate loue river and a binary catchment in a mediterranean climate cèze river were selected in france and their conceptual models of water origin and hydrological process variability were drawn in the loue catchment summer and fall storm events are characterized by contributions of pew through piston type flows whereas decreasing ec values in winter and spring storm events indicate the major contribution of ew through surface runoff and fast infiltration within the catchment ew contribution increases downstream due to the canyon river morphology grading into open valleys regarding the cèze catchment contributions of ew are higher indicating that fast infiltration and surface runoff are the dominant processes associated with a pew signature in summer and fall within the catchment pew contribution is found higher in karstified areas these results show that flood process seasonality is mainly related to karst aquifer saturation rate while intra site variability is linked to karst area extension and river morphology results are encouraging to extend this approach to a variety of sites notably those affected by significant surface water groundwater interaction and groundwater flooding such approach by providing a discretized information on flood processes could help refining lumped hydrological models or facilitate the use of semi distributed ones appendix b supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 127358 appendix b supplementary data the following are the supplementary data to this article supplementary data 1 
3752,flood control in the yangtze river basin has always been a thorny issue in chinese history along with the development of water science and technology a large number of reservoirs have been constructed in the yangtze river basin especially the progress of the reservoir operation theory the joint flood control simulation and decision making of reservoir groups has been applied extensively which proved an effective way to reduce the flood risks and losses in the middle and lower reaches of the yangtze river basin however an increase in the constraints of the reservoir operation or a single reservoir becoming a multiple reservoir system results in an exponential increase in the computational dimensions of the joint flood control simulation often referred to as the curse of dimensionality therefore based on the aggregation decomposition agdp method this paper proposes a cascaded reservoir group integrated operation mode namely the reverse order impoundment method of cascade reservoir roimcr mode and adopts the improved artificial bee colony iabc algorithm to solve the optimization problem of the roimcr mode iabc roimcr and establish an optimal operation model for cascade reservoir joint flood control the results show that 1 with the conventional operation co mode the roimcr mode has more advantages the average peak flow reduction rate with 32 89 is higher than that of the co mode 2 91 2 in solving the flood optimization operation problem of the cascade reservoir system the application of the iabc algorithm can effectively reduce the dimensions in the mathematical mode and has evident effects the average peak flow reduction rate in the iabc roimcr mode is 44 87 and 14 89 higher than those of the co mode 3 with the iabc roimcr mode the flood crest standard of cascade reservoirs can be reduced from a 100 year return period to less than a 5 year period and the flood crest standard of the lizhuang hydrological station from more than a 50 year return period to less than 5 year period the flood crest standard of the zhutuo hydrological station can be reduced from a 100 year return period to approximately a 5 year period thereby greatly improving the flood control standard in the upper and middle reaches of the yangtze river basin in addition the peak inflow to the three gorges reservoir is reduced and as a result the flood control pressure in the lower reaches of the yangtze river basin is alleviated to a certain extent abbreviations agdp aggregation decomposition method roimcr reverse order impoundment method of cascade reservoir iabc improved artificial bee colony algorithm iabc roimcr adopt the iabc algorithm to solve the optimization problem of the roimcr mode co conventional operation keywords cascade reservoir system flood control artificial bee colony yangtze river 1 introduction a reservoir flood control operation problem is a multistage sequential decision making process dynamic programming dp theory has conventionally been applied to solve reservoir flood operation problems in the early stages however an increase in the constraints of the reservoir operation or a single reservoir becoming a multiple reservoir system results in an exponential increase in the computational dimensions of the dp often referred to as the curse of dimensionality li et al 2019 therefore researchers have used methods such as improved dp kumar et al 2010 the progressive optimality algorithm poa jiang et al 2018 dp poa afshar 2013 zha et al 2021 zhu et al 2020 and poa successive approximation zhang et al 2016 to optimise operation processes for reservoir flood control the poa and other methods are generally based on a gradual optimization between two or more elements to reduce the dimensions in the mathematical mode however these methods do not consider a multiple reservoir system as a whole for continuous multiple reservoir systems therefore the optimal result for a single reservoir may not be the optimal result for the entire cascade the aggregation decomposition agdp method was proposed by turgeon turgeon 1980 to solve the curse of dimensionality for large reservoir systems since then it has been used to optimise the operation of multiple reservoir systems li et al 2014 pan et al 2020 zhang et al 2019 a notable feature of the agdp method is its aggregation of multiple reservoirs into a virtual reservoir making it possible to simplify multiple reservoir operations into a single reservoir operation in view of this zhu et al 2021 proposed a method of joint flood control for multiple reservoir systems called the stagewise compensation method swcm the results showed that the swcm could decompose a parallel multiple reservoir system into a single reservoir system and could consider the impacts of the joint compensation operations of each reservoir on reducing the peak flow in the downstream area with the successful application of modern intelligent algorithms in the field of hydrology and water resources researchers have used different intelligent algorithms for reservoir scheduling including the genetic algorithm kumphon 2013 seetharam 2021 particle swarm optimization pso he et al 2014 ant colony optimization jalali et al 2007 water cycle algorithm xu and mei 2018 and gravitational search algorithm bozorg haddad et al 2016 for example li and ouyang 2015 presented a generalised multi objective flood control model mofcm for the joint optimal dispatching of cascade reservoirs and a multi objective cultural self adaptive electromagnetism like mechanism algorithm was introduced to solve a river basin flood control problem the results of case studies demonstrated that the mofcm was practicable and efficient for multipurpose multiple reservoir flood control pan et al 2020 proposed an optimal joint flood control operation ojfcor for parallel reservoir groups based on agdp and the simulation optimization method nested annealing accuracy penalty function method adaptive multivariable pso was used to optimise ojfcor the results of ojfcor are better than those of conventional and dp flood control operations and the research shows that ojfcor is reasonable and effective therefore this study proposes a cascaded reservoir group integrated operation mode based on the agdp method namely the reverse order impoundment method of cascade reservoir roimcr mode and adopts the improved artificial bee colony iabc algorithm gao et al 2013 to solve the optimization problem of the roimcr mode and establish an optimal operation model for cascade reservoir joint flood control the model takes the maximum peak flow reduction rate of the cascaded reservoirs as the target and the economic benefits such as flood control safety and power generation are considered as the constraints so as to find the optimal storage and discharge modes of cascaded reservoirs the yangtze river is third largest river by runoff in the world and the largest river in china notably significant flood control pressure occurs frequently in the flood season along the yangtze river zhou et al 2014 yu et al 2020 owing to the massive floods derived from abundant rainfall in the watershed although some world class flood prevention works have been built since the end of the last century e g large reservoirs such as the three gorges project the flood control situation is still not considered as optimistic owing to great hydrological uncertainty under the conditions of climate change and intricate human activities in the upper reaches of the yangtze river also known as the jingshajiang river there are four other world class reservoirs that have been built or are under construction the wudongde reservoir ming and liu 2019 as the 1st reservoir in the cascade reservoir system considered in this study was put into operation in 2020 the 2nd reservoir the baihetan reservoir xiong et al 2019 will be completed in 2021 and the xiluodu reservoir yin et al 2015 and xiangjiaba reservoir peng et al 2014 the 3rd reservoir and the 4th reservoir in the cascade reservoir system have been in service since 2013 several characteristics of the cascade reservoir system will exist once all four reservoirs are complete and put into operation wang et al 2020 as follows it will be the largest cascade reservoir system in the world not only for electricity generation but also for flood control owing to its numerous tributaries inconstant spatial patterns of flooding huang et al 2018a zeng et al 2020 and the complex hydraulic connections between reservoirs and tributaries lai et al 2013 feng et al 2020 it will require a complex decision making process with multiple attributes huang et al 2018b objectives and stages making it difficult to model in view of the complexity of the problem effective optimization methods wang et al 2021 should be developed to achieve rationality accuracy and reliability in simulating real time flood control zhang et al 2017 for the cascade reservoir system 2 methodology 2 1 optimization method 2 1 1 improved artificial bee colony iabc algorithm the abc algorithm karaboga and akay 2009 karaboga and basturk 2007 karaboga and basturk 2008 karaboga 2015 is a relatively new intelligent algorithm based on the foraging behaviours of bee colonies these bees are typically made up of employed bees onlooker bees and scout bees and their basic behaviour is to search for the optimum in this context the employed bees and onlooker bees search for nectar sources when a nectar source is defined as an exhausted nectar source the employed bees abandon the old nectar source and turn to the scout bees to search for new nectar sources the abc algorithm is mathematically described as follows and the flowchart of the iabc algorithm is shown in fig 1 1 sn initial nectar sources feasible solution xi xi 1 xi 2 sn are generated where d is the number of dimensions 1 x i j l j rand 0 1 u j l j in the above i is the honey source label j is the dimension label j 1 2 d and u and l are the upper and lower limits of the problem dimension respectively 2 in the optimization iteration process a poor initial solution may become an optimal solution in a later stage the employed bees explore in the neighbourhood to prevent such poor solutions from being easily eliminated and potential optimal solutions from being eliminated the optimal strategy for the employed bees is as follows 2 v i j x i j φ i j x i j x k j here j 1 2 sn and k i φ 1 1 the standard abc algorithm has poor local exploration ability in the optimization of cascade reservoir flood control operation and easily converges in the form of a mutation thus forming a local optimal solution in view of this situation this study changed the exploration strategy formula for employed bees into the improved exploration formula proposed in gao et al 2013 to strengthen the optimization exploration ability of the employed bees as follows 3 v i j x gbest j φ i j x gbest j x k j in the above gbest is the position of the current optimal nectar source k 1 2 sn and k g b e s t 3 the onlooker bees are mainly developed for the initial superior solution to accelerate the speed of searching for the optimal solution the probability of being selected by the onlooker bees is mainly calculated according to the fitness of each nectar source the probability expression is as follows 4 p i f i j 1 sn f j here fi is the adaptability value of the i th feasible flood control operation for the cascade reservoir peak flood reduction rate of the cascade reservoir the onlooker bees act according to the probability of equation 4 a corresponding nectar source is selected in the roulette manner and then a neighbourhood exploration is conducted in the corresponding field according to equation 2 4 if the position of a nectar source cannot be further improved within a predetermined number of cycles the nectar source is considered as exhausted and the employed bees abandon the nectar source and become scout bees according to equation 1 thereby starting a random search for a new honey source the abandoned nectar source is replaced by a new nectar source found by the scout bees 5 the number of iterations is set and the optimal nectar source position for each iteration is recorded 6 if the position of the optimal nectar source is acceptable or the maximum number of iterations has been reached the calculation is stopped and the optimal nectar source position is returned otherwise step 2 is returned to for recalculation 2 1 2 reverse order impoundment method of cascade reservoir roimcr conventionally a cascaded reservoir joint operation mode can be divided into two modes in a sequential water storage mode of the cascade reservoir the cascade upstream reservoir begins to store water first and the cascade downstream reservoir begins to store water later that is the cascade reservoir is operated optimally one by one in the synchronous water storage mode of a cascade reservoir each reservoir begins to store water simultaneously and the water storage is allocated according to the proportion of the storage capacity for flood control of each reservoir to the total of the cascade reservoir these methods only consider the integrity of the cascade reservoir system and do not consider joint flood control operations in addition the cascaded reservoirs in the lower reaches of the jinshajiang river are close to each other and are not located in the rainstorm centre of the middle and upper reaches of the yangtze river basin therefore the interactions between them are evident in flood control operations therefore the study area can be regarded as a continuous multiple reservoir system with interdependent internal interactions therefore this study comprehensively considers the storage capacities cascade order inflows and other conditions of the cascade reservoirs and proposes the roimcr mode based on the agdp method the roimcr mode can not only represent the globality of the cascade reservoir but also play a better role in joint operation in particular it carries out joint flood control operations such that a downstream reservoir stores water first and an upstream reservoir stores water later in the processes of the upstream reservoirs the downstream reservoir can provide gentle approach to vacating a certain storage capacity e g in response to continuous or larger floods the synchronous water storage mode of the cascade reservoir and a roimcr comparison diagram are shown in figs 2 and 3 as can be seen from figs 2 and 3 although the amount of water stored by the cascade reservoir in the δt1 δt2 period is not consistent between the two operation modes the amount of flooding intercepted is consistent the roimcr mode intercepts that the same flood magnitude and is more flexible moreover after the flood control operations of the reservoir system the discharge of the upstream reservoir is gentle and does not increase the pressure of the downstream flood control thus the downstream reservoir can maintain a certain storage capacity for flood control at the end of the flooding the tasks of peak flow reduction and peak flow postponement can be completed using a relatively small storage capacity for flood control thereby enhancing the water storage and flood discharge capacity of the cascade reservoirs and providing the advantages of cascade reservoir joint operation in the application process of this method the actual situations among the reservoirs in the cascade and actual situation of the river basin should also be considered so as to better manage the situations of the multiple reservoirs e g three four or more in the cascade 2 2 joint flood control operation optimization model of cascade reservoir 2 2 1 objective function the flood control tasks of the cascade reservoirs in the lower reaches of the jinshajiang river are as follows 1 they must ensure flood control safety in the chuanjiang river reach namely yibin city luzhou city the chongqing municipality and other important economic areas during the flood season 2 the cascade reservoir groups in the lower reaches of the jinshajiang river and three gorges reservoir must be jointly operated to relieve the flood pressure along the yangtze river during the flood season therefore the main goal of the cascade reservoirs in the lower reaches of the jinshajiang river is to reduce the flood flow to the reach of the chuanjiang river as much as possible as premised on ensuring their own safety as mentioned above this study considers the peak flow reduction rate of the cascade reservoir joint operation as the objective function as follows 5 max f q im q om q om 100 6 q im max t 1 t q in t q qj t 7 q om max t 1 t q out t in the above f is the total peak flow reduction rate of the cascade q im is the maximum cascade inflow including the interval incoming water q om is the maximum outflow flow of the reservoir at the end of the cascade q in t is the inflow process of the reservoir at the most upstream of the cascade q qj t is the interval inflow process between the cascade reservoirs q om t is the outflow process of the reservoir at the end of the cascade and t is the total duration of the flood 2 2 2 constraints the constraints for the optimal model of the cascade reservoir joint flood control operations are as follows 1 water balance equation 8 qin i t qin i t 1 2 qout i t qout i t 1 2 δ t v i t 1 v i t here qin i t and qin i t 1 represent the inflow of the i th reservoir at times t and t 1 respectively and qout i t and qout i t 1 represent the outflow of the i th reservoir at times t and t 1 respectively t is the time interval of two adjacent periods and v i t and v i t 1 represent the water storage capacity of the i th reservoir at time t and time t 1 respectively 2 reservoir water level limits 9 z i min z i t z i max in the above z i min and z i max represent the minimum and maximum water levels of the i th reservoir respectively z i t is the water level of the i th reservoir at time t 3 boundary constraints 10 z i 1 z i s t a r t z i t 1 z i e n d here z i s t a r t is the starting water level of the i th reservoir and z i e n d is the final water level of the i th reservoir 4 reservoir discharge limits 11 q i min q i t q i max z i t in the above q i min is the minimum discharge of the i th reservoir and q i max z i t is the maximum discharge capacity of the i th reservoir under the reservoir water level at time t 5 discharge fluctuation limit 12 q i t 1 q i t δ q i here qi refers to the limit of the change in the discharge of the i th reservoir in two adjacent periods 6 flood routing using the muskingum method for the same flood there can still be a certain gap between the upstream flood after multiple stages of the muskingum evolution bozorg haddad et al 2019 and the actual downstream flood liu et al 2015 in consideration of this phenomenon the flood in the downstream section was pushed back upstream in the numerical simulation through the theory of flood routing in the muskingum method then it was transferred downstream by the same method after flood dispatching aiming to ensure consistency with the original flood and better reflect the flood control effect of the cascade reservoir system the flood routing process is shown in fig 4 explanation the flood participating in the evolution has been managed in view of the upstream and downstream time differences i e to ensure that the upstream and downstream areas are considering the same flood the equations added on the basis of muskingum method 13 i t n o t 1 n c 0 n i t 1 n c 2 n o t n q t n c 1 n 14 o t n 1 i t n in the above ot n and ot 1 n represent the outflow of the river at segment n at time t and time t 1 respectively it n and it 1 n represent the inflow of the river at segment n at time t and time t 1 respectively qt n 1 represents the outflow of the river at segment n 1 at time t qt n represents the interval inflow of the river at segment n at time t and c0 n c1 n and c2 n are the muskingum flood routing coefficients of the river at segment n respectively 7 non negative constraints all of the above decision variables are non negative 8 reservoir implementation sequence constraints because the roimcr mode is adopted the order of the flood control operations of the cascade reservoir will change with the occupation of water storage capacity for flood control 2 2 3 iabc roimcr in the flood control operations of the cascade reservoir during the flood season owing to the constraints of irrigation power generation storage capacity for flood control etc the water discharge in the previous period can influence the water discharge in the future rather than being independent of each other in the joint flood control operations of a cascade reservoir it is necessary to consider the joint nature of the cascade reservoir along with the allocations of the storage capacity economic benefit and downstream flood control pressure under optimization the computation will be very large thus the iabc algorithm is be introduced for optimization the specific iabc roimcr optimal model is as follows and the iabc algorithm optimization cascade reservoir flood control operation is shown in fig 5 step a according to the roimcr mode the water storage mode of the cascade reservoir is formulated as follows and the scheduling schematic diagram of cascade reservoir system based on the roimcr mode is shown in fig 6 1 as the first reservoir in the cascade the wudongde reservoir 1st reservoir has a relatively small flood control capacity if it encounters continuous floods after being full it will have a greater risk of flooding the water storage capacity for flood control of the baihetan reservoir 2nd reservoir is equal to half of the cascade and it has a better regulating ability in the face of ordinary floods therefore the baihetan reservoir will store water first 2 when the reservoir water level of the baihetan reservoir reaches the normal storage level the wudongde reservoir will begin to impound water its water storage capacity for flood control only accounts for 53 of that of the xiluodu reservoir 3rd reservoir therefore only a small amount of water can be held a small amount of peak flooding can be reduced and the peak flood can be delayed to a certain extent in the wudongde reservoir 3 when the reservoir water level of the baihetan reservoir reaches the normal storage level the xiluodu reservoir simultaneously begins storage to prevent the cascade water discharge from being too large and causing excessive pressure on the downstream flood control targets the main measures of xiluodu reservoir are in peak flood reduction and water discharge control 4 when the outflow controlled by the xiluodu reservoir is large or the inflow of the xiangjiaba reservoir 4th reservoir reaches a certain magnitude easily affecting the downstream flood control targets the xiangjiaba reservoir begins to regulate and store the flow nevertheless it must remain within the limits of its water storage capacity for flood control step b in the flood control of the cascade reservoir the current cascade reservoir storage order is identified if the inflow exceeds the maximum discharge capacity of the current reservoir water level the water may be passively stored the constraint conditions of each reservoir in the cascade are considered the iabc algorithm is used to randomly find a certain number of qualified cascade reservoir water discharge combinations initial nectar sources step c the magnitudes of the peak flow reduction rates fitness function of the cascade reservoir system are ranked and compared according to the results of the comparison employed bees ranked in the lower half and onlooker bees ranked in the upper half are determined the employed bees and onlooker bees conduct global and domain exploration on the cascade reservoir outflow combinations using equations 2 and 4 respectively if the cascade reservoir peak flow reduction rate after exploration is better than the original result the cascade reservoir outflow combination is replaced step d if the peak flow reduction rate of the cascade reservoir system does not change after a certain number of iterations then the iabc algorithm is re used to randomly determine the qualified outflow flow combination of reservoirs in the cascade start scout bees step e a certain number of iterations sufficient to make the iteration curve converge are set so as to obtain a relatively optimal cascade reservoir outflow combination 3 case study 3 1 overview of the study area the jinshajiang river basin is located in the upper reaches of the yangtze river basin spanning 90 105 e and 24 36 n it is 3 481 km long from the headwaters of qinghai province to the main stream in yibin city with a basin area of 502 000 km2 accounting for approximately 26 of the yangtze river basin and 47 of the catchment area above the three gorges dam site the cascade reservoirs in the lower reaches of the jinshajiang river are the wudongde reservoir baihetan reservoir xiluodu reservoir and xiangjiaba reservoir i e the 1st reservoir 2nd reservoir 3rd reservoir and 4th reservoir respectively shown in the fig 7 the total installed capacity is more than 45 million kw and the annual generating capacity is 186 7 billion kw h equivalent to two three gorges power stations the engineering characteristic parameters of cascade reservoirs in the upper reaches of the yangtze river are shown in table 1 the chuanjiang river section of the yangtze river basin is between the lower reaches of the cascade reservoir and the three gorges reservoir with the economically important cities of yibin luzhou and chongqing residing along the banks however there are many tributaries in this reach and the flood flow is large during the flood season leading to great flood control pressure therefore the optimal flood control operation of the cascade reservoir system in the lower reaches of the jinshajiang river has great significance in alleviating the flood control pressure in the chuanjiang river and in cooperating with the joint operation of the three gorges reservoir the regional location of cascade reservoirs in the upper and middle reaches of yangtze river is shown in fig 8 3 2 results analysis as shown in fig 8 the flood control of the reach of the chuanjiang river is mainly undertaken by the cascade reservoir system in the lower reaches of the jinshajiang river therefore this study mainly analyses the flood reduction degree of the chuangjiang river by the cascade reservoir system in the lower reaches of the jinshajiang river through the following steps and analyses the effects of roimcr mode and iabc algorithm optimization on the optimal flood control operation of the cascade reservoir step a four actual floods of the upstream type interval type and tributary type at the zhutuo hydrological station located between luzhou city and chongqing city in the section of the chuanjiang river are considered as examples among them the 20030831 flood is the upstream flood of the zhutuo station the 20080808 flood is the interval flood of the zhutuo station and the 20100717 and 20120716 floods are the tributary floods of zhutuo station the proportion of flood volume of four actual floods in zhutuo hydrological station is shown in table2 step b a hundred year return period amplification of the four actual floods is conducted based on a regional combination of the flood volumes under the same frequency step c through the flood routing process of the muskingum method above the four floods amplified by zhutuo hydrological station are subjected to flood evolution and dispatching treatment step d the three considered flood control operation methods for the cascade reservoirs in the lower reaches of jinshajiang river are as follows the synchronous water storage mode of cascade reservoir i e conventional operation co roimcr and iabc roimcr step e a chart is used to compare and analyse the three dispatching results from the four floods the scheduling results are shown in the fig 9 through the flow routing of muskingum method the flood after the cascade reservoir dispatching proceeds to the lizhuang hydrological station and zhutuo hydrological station to analyse the influences and function of the cascade reservoir in the lower reaches of jinshajiang river on the flood control system of the chuanjiang river the results are shown in the fig 10 the peak flow reduction rates utilisation rates of flood control storage capacity and occupancy rates of the maximum flood control storage capacity under the three scheduling modes are shown in table 3 the average peak flow reduction rate of the roimcr mode is 51 4 at the cascade reservoir 25 83 at lizhuang station and 21 43 at zhutuo station the average peak flow reduction rates of the co mode are 48 8 at the cascade reservoir 21 83 at lizhuang station and 19 30 at zhutuo station thus the reduction rates in roimcr mode are 2 6 4 and 2 13 greater than those of the co mode for these three locations respectively the advantages of the roimcr mode are not evident but the dispatch result for each of the four floods is better than that of the co mode providing that the roimcr mode is feasible and superior to the co method compared with the co method the iabc roimcr method has evident advantages the average peak flow reduction rate is 69 13 at the cascade reservoir 35 18 at lizhuang station and 30 30 at zhutuo station i e 17 72 35 and 8 88 higher than those of the roimcr mode respectively and 20 33 13 35 and 11 higher than those of the co mode respectively therefore it can be seen that the application of the iabc algorithm in cascade flood control optimization is relatively feasible and has evident effects it can be seen from table 3 that the peak flow reduction rate is proportional to the utilisation rate of the flood control storage capacity table 3 also indicates that the iabc roimcr method has a higher utilisation efficiency for the cascade flood control storage capacity therefore the peak flow reduction rate is significantly higher than those of the other two scheduling modes however the iabc roimcr method has a high utilisation rate of the flood control storage capacity this affects the flood control safety of the reservoir itself to some extent nevertheless the maximum occupancy rate of the flood control storage capacity is lower than the utilisation rate of flood control storage capacity indicating that the four reservoirs in the cascade system do not reach the maximum flood control water level simultaneously this is also an advantage of the roimcr mode a buffering time is given to each reservoir in the cascade system to reduce the flood risk to a certain extent the comparison of flood crest before and after three dispatching modes is shown in table 4 and fig 11 the four floods are amplified by the regional combinations of flood volumes under the same frequency method in the downstream zhutuo hydrological station the peak flood exceeds the flood crest standard of the once in 50 year return period the 20100717 and 20120716 floods even reach the flood crest standard of the once in 100 year return period the peak floods of the upstream cascade reservoirs all reach the flood crest standard of the once in 50 year return period 32 000 m3 s of xiangjiaba reservoir and some floods even exceed the flood crest standard of the once in 100 year return period 34 800 m3 s as can be seen from the above chart when the peak flood magnitude reaches a 50 year return period or even a 100 year period the cascade outflow can be controlled below the 5 year return period 21 800 m3 s or even less after cascade reservoir operation the flood crest standard of the lizhuang hydrological station can be reduced from more than a 50 year return period 56 100 m3 s to a 5 year 39 800 m3 s and the iabc roimcr mode can reduce it to less than a 5 year period in addition the flood crest standard of zhutuo hydrological station can be reduced from the flood crest standard of the 50 year return period 62 500 m3 s or even 100 year 67 200 m3 s to the flood crest standard of a 20 year return period 55 900 m3 s the iabc roimcr mode can even reduce the flood crest standard of the zhutuo hydrological station to approximately a 5 year period 44 800 m3 s therefore it can be concluded that the cascade reservoir system in the lower reaches of jinshajiang river can significantly improve the flood control standard in the chuanjiang river basin and the joint operation with the three gorges reservoir can alleviate the flood pressure in the middle and upper reaches of the yangtze river basin during the flood season to a certain extent 4 conclusion this study considers the upper reaches of the yangtze river and the cascade reservoirs in the lower reaches of the jinshajiang river based on the agdp theory a new method for cascade reservoir joint flood control operation namely the roimcr is proposed the iabc algorithm is used to optimise the joint flood control operation of the cascade reservoir system reduce the dimensions of the cascade operation and find the optimal storage and discharge mode of the cascade reservoir system based on the flood control operation results of the cascade reservoirs in the lower reaches of jinshajiang river this study analyses the improvement of flood control standards in the lower reaches of yibin luzhou chongqing and other economically important cities as well as their role in the joint operation of the three gorges reservoir the specific conclusions are as follows 1 the average peak flow reduction rate of the cascade reservoirs in the roimcr mode is 51 4 that of the lizhuang hydrological station is 25 83 and that of the zhutuo hydrological station is 21 43 i e 2 6 4 and 2 13 more than those of the co mode respectively its advantages are not evident but every flood is better than that of the co mode this shows that the roimcr mode is feasible and has several advantages 2 the average peak flow reduction rate of the reservoir in the iabc roimcr mode is 69 13 the average peak flow reduction rate of the lizhuang hydrological station is 35 18 and the average peak flow reduction rate of zhutuo hydrological station is 30 30 these are 17 72 9 35 and 8 88 higher than those with the roimcr mode respectively and 20 33 13 35 and 11 higher than those of the co mode respectively this indicates that the application of the iabc algorithm to the optimal flood control operation of cascade reservoirs is relatively feasible and has evident effects 3 the iabc roimcr mode can reduce the flood crest standard of cascade reservoirs from a 100 year return period to less than a 5 year period and the flood crest standard of the lizhuang hydrological station from more than a 50 year return period to less than 5 year period the flood crest standard of the zhutuo hydrological station can be reduced from a 100 year return period to approximately a 5 year period thereby greatly improving the flood control standard in the chuanjiang river section of the yangtze river basin therefore the peak inflow to the three gorges reservoir is reduced and as a result the flood control pressure in the lower reaches of the yangtze river basin is alleviated to a certain extent roimcr mode and its combination with iabc algorithm on one hand are to reduce the dimension of cascade reservoir flood control operation to some extent on the other hand to explore a new mode of rational utilization of cascade reservoir flood control capacity so that a nonlinear effect of 1 1 greater than 2 can be achieved for the capacity utilization of all reservoirs in the process of flood regulation but at present roimcr mode is only applicable to large scale flood regulation and is limited to the joint flood control operation of cascade reservoir in the future it could be combined with dynamic control water level in stages and flood prediction to obtain more reasonable and effective flood control operation rules declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors acknowledge the financial support granted by the joint fund project of the natural science foundation of shaanxi province no 2021jlm 54 the key research and development project of shaanxi province no 2019sf 237 the fundamental research funds for the central universities chd no 300102291507 300102269201 
3752,flood control in the yangtze river basin has always been a thorny issue in chinese history along with the development of water science and technology a large number of reservoirs have been constructed in the yangtze river basin especially the progress of the reservoir operation theory the joint flood control simulation and decision making of reservoir groups has been applied extensively which proved an effective way to reduce the flood risks and losses in the middle and lower reaches of the yangtze river basin however an increase in the constraints of the reservoir operation or a single reservoir becoming a multiple reservoir system results in an exponential increase in the computational dimensions of the joint flood control simulation often referred to as the curse of dimensionality therefore based on the aggregation decomposition agdp method this paper proposes a cascaded reservoir group integrated operation mode namely the reverse order impoundment method of cascade reservoir roimcr mode and adopts the improved artificial bee colony iabc algorithm to solve the optimization problem of the roimcr mode iabc roimcr and establish an optimal operation model for cascade reservoir joint flood control the results show that 1 with the conventional operation co mode the roimcr mode has more advantages the average peak flow reduction rate with 32 89 is higher than that of the co mode 2 91 2 in solving the flood optimization operation problem of the cascade reservoir system the application of the iabc algorithm can effectively reduce the dimensions in the mathematical mode and has evident effects the average peak flow reduction rate in the iabc roimcr mode is 44 87 and 14 89 higher than those of the co mode 3 with the iabc roimcr mode the flood crest standard of cascade reservoirs can be reduced from a 100 year return period to less than a 5 year period and the flood crest standard of the lizhuang hydrological station from more than a 50 year return period to less than 5 year period the flood crest standard of the zhutuo hydrological station can be reduced from a 100 year return period to approximately a 5 year period thereby greatly improving the flood control standard in the upper and middle reaches of the yangtze river basin in addition the peak inflow to the three gorges reservoir is reduced and as a result the flood control pressure in the lower reaches of the yangtze river basin is alleviated to a certain extent abbreviations agdp aggregation decomposition method roimcr reverse order impoundment method of cascade reservoir iabc improved artificial bee colony algorithm iabc roimcr adopt the iabc algorithm to solve the optimization problem of the roimcr mode co conventional operation keywords cascade reservoir system flood control artificial bee colony yangtze river 1 introduction a reservoir flood control operation problem is a multistage sequential decision making process dynamic programming dp theory has conventionally been applied to solve reservoir flood operation problems in the early stages however an increase in the constraints of the reservoir operation or a single reservoir becoming a multiple reservoir system results in an exponential increase in the computational dimensions of the dp often referred to as the curse of dimensionality li et al 2019 therefore researchers have used methods such as improved dp kumar et al 2010 the progressive optimality algorithm poa jiang et al 2018 dp poa afshar 2013 zha et al 2021 zhu et al 2020 and poa successive approximation zhang et al 2016 to optimise operation processes for reservoir flood control the poa and other methods are generally based on a gradual optimization between two or more elements to reduce the dimensions in the mathematical mode however these methods do not consider a multiple reservoir system as a whole for continuous multiple reservoir systems therefore the optimal result for a single reservoir may not be the optimal result for the entire cascade the aggregation decomposition agdp method was proposed by turgeon turgeon 1980 to solve the curse of dimensionality for large reservoir systems since then it has been used to optimise the operation of multiple reservoir systems li et al 2014 pan et al 2020 zhang et al 2019 a notable feature of the agdp method is its aggregation of multiple reservoirs into a virtual reservoir making it possible to simplify multiple reservoir operations into a single reservoir operation in view of this zhu et al 2021 proposed a method of joint flood control for multiple reservoir systems called the stagewise compensation method swcm the results showed that the swcm could decompose a parallel multiple reservoir system into a single reservoir system and could consider the impacts of the joint compensation operations of each reservoir on reducing the peak flow in the downstream area with the successful application of modern intelligent algorithms in the field of hydrology and water resources researchers have used different intelligent algorithms for reservoir scheduling including the genetic algorithm kumphon 2013 seetharam 2021 particle swarm optimization pso he et al 2014 ant colony optimization jalali et al 2007 water cycle algorithm xu and mei 2018 and gravitational search algorithm bozorg haddad et al 2016 for example li and ouyang 2015 presented a generalised multi objective flood control model mofcm for the joint optimal dispatching of cascade reservoirs and a multi objective cultural self adaptive electromagnetism like mechanism algorithm was introduced to solve a river basin flood control problem the results of case studies demonstrated that the mofcm was practicable and efficient for multipurpose multiple reservoir flood control pan et al 2020 proposed an optimal joint flood control operation ojfcor for parallel reservoir groups based on agdp and the simulation optimization method nested annealing accuracy penalty function method adaptive multivariable pso was used to optimise ojfcor the results of ojfcor are better than those of conventional and dp flood control operations and the research shows that ojfcor is reasonable and effective therefore this study proposes a cascaded reservoir group integrated operation mode based on the agdp method namely the reverse order impoundment method of cascade reservoir roimcr mode and adopts the improved artificial bee colony iabc algorithm gao et al 2013 to solve the optimization problem of the roimcr mode and establish an optimal operation model for cascade reservoir joint flood control the model takes the maximum peak flow reduction rate of the cascaded reservoirs as the target and the economic benefits such as flood control safety and power generation are considered as the constraints so as to find the optimal storage and discharge modes of cascaded reservoirs the yangtze river is third largest river by runoff in the world and the largest river in china notably significant flood control pressure occurs frequently in the flood season along the yangtze river zhou et al 2014 yu et al 2020 owing to the massive floods derived from abundant rainfall in the watershed although some world class flood prevention works have been built since the end of the last century e g large reservoirs such as the three gorges project the flood control situation is still not considered as optimistic owing to great hydrological uncertainty under the conditions of climate change and intricate human activities in the upper reaches of the yangtze river also known as the jingshajiang river there are four other world class reservoirs that have been built or are under construction the wudongde reservoir ming and liu 2019 as the 1st reservoir in the cascade reservoir system considered in this study was put into operation in 2020 the 2nd reservoir the baihetan reservoir xiong et al 2019 will be completed in 2021 and the xiluodu reservoir yin et al 2015 and xiangjiaba reservoir peng et al 2014 the 3rd reservoir and the 4th reservoir in the cascade reservoir system have been in service since 2013 several characteristics of the cascade reservoir system will exist once all four reservoirs are complete and put into operation wang et al 2020 as follows it will be the largest cascade reservoir system in the world not only for electricity generation but also for flood control owing to its numerous tributaries inconstant spatial patterns of flooding huang et al 2018a zeng et al 2020 and the complex hydraulic connections between reservoirs and tributaries lai et al 2013 feng et al 2020 it will require a complex decision making process with multiple attributes huang et al 2018b objectives and stages making it difficult to model in view of the complexity of the problem effective optimization methods wang et al 2021 should be developed to achieve rationality accuracy and reliability in simulating real time flood control zhang et al 2017 for the cascade reservoir system 2 methodology 2 1 optimization method 2 1 1 improved artificial bee colony iabc algorithm the abc algorithm karaboga and akay 2009 karaboga and basturk 2007 karaboga and basturk 2008 karaboga 2015 is a relatively new intelligent algorithm based on the foraging behaviours of bee colonies these bees are typically made up of employed bees onlooker bees and scout bees and their basic behaviour is to search for the optimum in this context the employed bees and onlooker bees search for nectar sources when a nectar source is defined as an exhausted nectar source the employed bees abandon the old nectar source and turn to the scout bees to search for new nectar sources the abc algorithm is mathematically described as follows and the flowchart of the iabc algorithm is shown in fig 1 1 sn initial nectar sources feasible solution xi xi 1 xi 2 sn are generated where d is the number of dimensions 1 x i j l j rand 0 1 u j l j in the above i is the honey source label j is the dimension label j 1 2 d and u and l are the upper and lower limits of the problem dimension respectively 2 in the optimization iteration process a poor initial solution may become an optimal solution in a later stage the employed bees explore in the neighbourhood to prevent such poor solutions from being easily eliminated and potential optimal solutions from being eliminated the optimal strategy for the employed bees is as follows 2 v i j x i j φ i j x i j x k j here j 1 2 sn and k i φ 1 1 the standard abc algorithm has poor local exploration ability in the optimization of cascade reservoir flood control operation and easily converges in the form of a mutation thus forming a local optimal solution in view of this situation this study changed the exploration strategy formula for employed bees into the improved exploration formula proposed in gao et al 2013 to strengthen the optimization exploration ability of the employed bees as follows 3 v i j x gbest j φ i j x gbest j x k j in the above gbest is the position of the current optimal nectar source k 1 2 sn and k g b e s t 3 the onlooker bees are mainly developed for the initial superior solution to accelerate the speed of searching for the optimal solution the probability of being selected by the onlooker bees is mainly calculated according to the fitness of each nectar source the probability expression is as follows 4 p i f i j 1 sn f j here fi is the adaptability value of the i th feasible flood control operation for the cascade reservoir peak flood reduction rate of the cascade reservoir the onlooker bees act according to the probability of equation 4 a corresponding nectar source is selected in the roulette manner and then a neighbourhood exploration is conducted in the corresponding field according to equation 2 4 if the position of a nectar source cannot be further improved within a predetermined number of cycles the nectar source is considered as exhausted and the employed bees abandon the nectar source and become scout bees according to equation 1 thereby starting a random search for a new honey source the abandoned nectar source is replaced by a new nectar source found by the scout bees 5 the number of iterations is set and the optimal nectar source position for each iteration is recorded 6 if the position of the optimal nectar source is acceptable or the maximum number of iterations has been reached the calculation is stopped and the optimal nectar source position is returned otherwise step 2 is returned to for recalculation 2 1 2 reverse order impoundment method of cascade reservoir roimcr conventionally a cascaded reservoir joint operation mode can be divided into two modes in a sequential water storage mode of the cascade reservoir the cascade upstream reservoir begins to store water first and the cascade downstream reservoir begins to store water later that is the cascade reservoir is operated optimally one by one in the synchronous water storage mode of a cascade reservoir each reservoir begins to store water simultaneously and the water storage is allocated according to the proportion of the storage capacity for flood control of each reservoir to the total of the cascade reservoir these methods only consider the integrity of the cascade reservoir system and do not consider joint flood control operations in addition the cascaded reservoirs in the lower reaches of the jinshajiang river are close to each other and are not located in the rainstorm centre of the middle and upper reaches of the yangtze river basin therefore the interactions between them are evident in flood control operations therefore the study area can be regarded as a continuous multiple reservoir system with interdependent internal interactions therefore this study comprehensively considers the storage capacities cascade order inflows and other conditions of the cascade reservoirs and proposes the roimcr mode based on the agdp method the roimcr mode can not only represent the globality of the cascade reservoir but also play a better role in joint operation in particular it carries out joint flood control operations such that a downstream reservoir stores water first and an upstream reservoir stores water later in the processes of the upstream reservoirs the downstream reservoir can provide gentle approach to vacating a certain storage capacity e g in response to continuous or larger floods the synchronous water storage mode of the cascade reservoir and a roimcr comparison diagram are shown in figs 2 and 3 as can be seen from figs 2 and 3 although the amount of water stored by the cascade reservoir in the δt1 δt2 period is not consistent between the two operation modes the amount of flooding intercepted is consistent the roimcr mode intercepts that the same flood magnitude and is more flexible moreover after the flood control operations of the reservoir system the discharge of the upstream reservoir is gentle and does not increase the pressure of the downstream flood control thus the downstream reservoir can maintain a certain storage capacity for flood control at the end of the flooding the tasks of peak flow reduction and peak flow postponement can be completed using a relatively small storage capacity for flood control thereby enhancing the water storage and flood discharge capacity of the cascade reservoirs and providing the advantages of cascade reservoir joint operation in the application process of this method the actual situations among the reservoirs in the cascade and actual situation of the river basin should also be considered so as to better manage the situations of the multiple reservoirs e g three four or more in the cascade 2 2 joint flood control operation optimization model of cascade reservoir 2 2 1 objective function the flood control tasks of the cascade reservoirs in the lower reaches of the jinshajiang river are as follows 1 they must ensure flood control safety in the chuanjiang river reach namely yibin city luzhou city the chongqing municipality and other important economic areas during the flood season 2 the cascade reservoir groups in the lower reaches of the jinshajiang river and three gorges reservoir must be jointly operated to relieve the flood pressure along the yangtze river during the flood season therefore the main goal of the cascade reservoirs in the lower reaches of the jinshajiang river is to reduce the flood flow to the reach of the chuanjiang river as much as possible as premised on ensuring their own safety as mentioned above this study considers the peak flow reduction rate of the cascade reservoir joint operation as the objective function as follows 5 max f q im q om q om 100 6 q im max t 1 t q in t q qj t 7 q om max t 1 t q out t in the above f is the total peak flow reduction rate of the cascade q im is the maximum cascade inflow including the interval incoming water q om is the maximum outflow flow of the reservoir at the end of the cascade q in t is the inflow process of the reservoir at the most upstream of the cascade q qj t is the interval inflow process between the cascade reservoirs q om t is the outflow process of the reservoir at the end of the cascade and t is the total duration of the flood 2 2 2 constraints the constraints for the optimal model of the cascade reservoir joint flood control operations are as follows 1 water balance equation 8 qin i t qin i t 1 2 qout i t qout i t 1 2 δ t v i t 1 v i t here qin i t and qin i t 1 represent the inflow of the i th reservoir at times t and t 1 respectively and qout i t and qout i t 1 represent the outflow of the i th reservoir at times t and t 1 respectively t is the time interval of two adjacent periods and v i t and v i t 1 represent the water storage capacity of the i th reservoir at time t and time t 1 respectively 2 reservoir water level limits 9 z i min z i t z i max in the above z i min and z i max represent the minimum and maximum water levels of the i th reservoir respectively z i t is the water level of the i th reservoir at time t 3 boundary constraints 10 z i 1 z i s t a r t z i t 1 z i e n d here z i s t a r t is the starting water level of the i th reservoir and z i e n d is the final water level of the i th reservoir 4 reservoir discharge limits 11 q i min q i t q i max z i t in the above q i min is the minimum discharge of the i th reservoir and q i max z i t is the maximum discharge capacity of the i th reservoir under the reservoir water level at time t 5 discharge fluctuation limit 12 q i t 1 q i t δ q i here qi refers to the limit of the change in the discharge of the i th reservoir in two adjacent periods 6 flood routing using the muskingum method for the same flood there can still be a certain gap between the upstream flood after multiple stages of the muskingum evolution bozorg haddad et al 2019 and the actual downstream flood liu et al 2015 in consideration of this phenomenon the flood in the downstream section was pushed back upstream in the numerical simulation through the theory of flood routing in the muskingum method then it was transferred downstream by the same method after flood dispatching aiming to ensure consistency with the original flood and better reflect the flood control effect of the cascade reservoir system the flood routing process is shown in fig 4 explanation the flood participating in the evolution has been managed in view of the upstream and downstream time differences i e to ensure that the upstream and downstream areas are considering the same flood the equations added on the basis of muskingum method 13 i t n o t 1 n c 0 n i t 1 n c 2 n o t n q t n c 1 n 14 o t n 1 i t n in the above ot n and ot 1 n represent the outflow of the river at segment n at time t and time t 1 respectively it n and it 1 n represent the inflow of the river at segment n at time t and time t 1 respectively qt n 1 represents the outflow of the river at segment n 1 at time t qt n represents the interval inflow of the river at segment n at time t and c0 n c1 n and c2 n are the muskingum flood routing coefficients of the river at segment n respectively 7 non negative constraints all of the above decision variables are non negative 8 reservoir implementation sequence constraints because the roimcr mode is adopted the order of the flood control operations of the cascade reservoir will change with the occupation of water storage capacity for flood control 2 2 3 iabc roimcr in the flood control operations of the cascade reservoir during the flood season owing to the constraints of irrigation power generation storage capacity for flood control etc the water discharge in the previous period can influence the water discharge in the future rather than being independent of each other in the joint flood control operations of a cascade reservoir it is necessary to consider the joint nature of the cascade reservoir along with the allocations of the storage capacity economic benefit and downstream flood control pressure under optimization the computation will be very large thus the iabc algorithm is be introduced for optimization the specific iabc roimcr optimal model is as follows and the iabc algorithm optimization cascade reservoir flood control operation is shown in fig 5 step a according to the roimcr mode the water storage mode of the cascade reservoir is formulated as follows and the scheduling schematic diagram of cascade reservoir system based on the roimcr mode is shown in fig 6 1 as the first reservoir in the cascade the wudongde reservoir 1st reservoir has a relatively small flood control capacity if it encounters continuous floods after being full it will have a greater risk of flooding the water storage capacity for flood control of the baihetan reservoir 2nd reservoir is equal to half of the cascade and it has a better regulating ability in the face of ordinary floods therefore the baihetan reservoir will store water first 2 when the reservoir water level of the baihetan reservoir reaches the normal storage level the wudongde reservoir will begin to impound water its water storage capacity for flood control only accounts for 53 of that of the xiluodu reservoir 3rd reservoir therefore only a small amount of water can be held a small amount of peak flooding can be reduced and the peak flood can be delayed to a certain extent in the wudongde reservoir 3 when the reservoir water level of the baihetan reservoir reaches the normal storage level the xiluodu reservoir simultaneously begins storage to prevent the cascade water discharge from being too large and causing excessive pressure on the downstream flood control targets the main measures of xiluodu reservoir are in peak flood reduction and water discharge control 4 when the outflow controlled by the xiluodu reservoir is large or the inflow of the xiangjiaba reservoir 4th reservoir reaches a certain magnitude easily affecting the downstream flood control targets the xiangjiaba reservoir begins to regulate and store the flow nevertheless it must remain within the limits of its water storage capacity for flood control step b in the flood control of the cascade reservoir the current cascade reservoir storage order is identified if the inflow exceeds the maximum discharge capacity of the current reservoir water level the water may be passively stored the constraint conditions of each reservoir in the cascade are considered the iabc algorithm is used to randomly find a certain number of qualified cascade reservoir water discharge combinations initial nectar sources step c the magnitudes of the peak flow reduction rates fitness function of the cascade reservoir system are ranked and compared according to the results of the comparison employed bees ranked in the lower half and onlooker bees ranked in the upper half are determined the employed bees and onlooker bees conduct global and domain exploration on the cascade reservoir outflow combinations using equations 2 and 4 respectively if the cascade reservoir peak flow reduction rate after exploration is better than the original result the cascade reservoir outflow combination is replaced step d if the peak flow reduction rate of the cascade reservoir system does not change after a certain number of iterations then the iabc algorithm is re used to randomly determine the qualified outflow flow combination of reservoirs in the cascade start scout bees step e a certain number of iterations sufficient to make the iteration curve converge are set so as to obtain a relatively optimal cascade reservoir outflow combination 3 case study 3 1 overview of the study area the jinshajiang river basin is located in the upper reaches of the yangtze river basin spanning 90 105 e and 24 36 n it is 3 481 km long from the headwaters of qinghai province to the main stream in yibin city with a basin area of 502 000 km2 accounting for approximately 26 of the yangtze river basin and 47 of the catchment area above the three gorges dam site the cascade reservoirs in the lower reaches of the jinshajiang river are the wudongde reservoir baihetan reservoir xiluodu reservoir and xiangjiaba reservoir i e the 1st reservoir 2nd reservoir 3rd reservoir and 4th reservoir respectively shown in the fig 7 the total installed capacity is more than 45 million kw and the annual generating capacity is 186 7 billion kw h equivalent to two three gorges power stations the engineering characteristic parameters of cascade reservoirs in the upper reaches of the yangtze river are shown in table 1 the chuanjiang river section of the yangtze river basin is between the lower reaches of the cascade reservoir and the three gorges reservoir with the economically important cities of yibin luzhou and chongqing residing along the banks however there are many tributaries in this reach and the flood flow is large during the flood season leading to great flood control pressure therefore the optimal flood control operation of the cascade reservoir system in the lower reaches of the jinshajiang river has great significance in alleviating the flood control pressure in the chuanjiang river and in cooperating with the joint operation of the three gorges reservoir the regional location of cascade reservoirs in the upper and middle reaches of yangtze river is shown in fig 8 3 2 results analysis as shown in fig 8 the flood control of the reach of the chuanjiang river is mainly undertaken by the cascade reservoir system in the lower reaches of the jinshajiang river therefore this study mainly analyses the flood reduction degree of the chuangjiang river by the cascade reservoir system in the lower reaches of the jinshajiang river through the following steps and analyses the effects of roimcr mode and iabc algorithm optimization on the optimal flood control operation of the cascade reservoir step a four actual floods of the upstream type interval type and tributary type at the zhutuo hydrological station located between luzhou city and chongqing city in the section of the chuanjiang river are considered as examples among them the 20030831 flood is the upstream flood of the zhutuo station the 20080808 flood is the interval flood of the zhutuo station and the 20100717 and 20120716 floods are the tributary floods of zhutuo station the proportion of flood volume of four actual floods in zhutuo hydrological station is shown in table2 step b a hundred year return period amplification of the four actual floods is conducted based on a regional combination of the flood volumes under the same frequency step c through the flood routing process of the muskingum method above the four floods amplified by zhutuo hydrological station are subjected to flood evolution and dispatching treatment step d the three considered flood control operation methods for the cascade reservoirs in the lower reaches of jinshajiang river are as follows the synchronous water storage mode of cascade reservoir i e conventional operation co roimcr and iabc roimcr step e a chart is used to compare and analyse the three dispatching results from the four floods the scheduling results are shown in the fig 9 through the flow routing of muskingum method the flood after the cascade reservoir dispatching proceeds to the lizhuang hydrological station and zhutuo hydrological station to analyse the influences and function of the cascade reservoir in the lower reaches of jinshajiang river on the flood control system of the chuanjiang river the results are shown in the fig 10 the peak flow reduction rates utilisation rates of flood control storage capacity and occupancy rates of the maximum flood control storage capacity under the three scheduling modes are shown in table 3 the average peak flow reduction rate of the roimcr mode is 51 4 at the cascade reservoir 25 83 at lizhuang station and 21 43 at zhutuo station the average peak flow reduction rates of the co mode are 48 8 at the cascade reservoir 21 83 at lizhuang station and 19 30 at zhutuo station thus the reduction rates in roimcr mode are 2 6 4 and 2 13 greater than those of the co mode for these three locations respectively the advantages of the roimcr mode are not evident but the dispatch result for each of the four floods is better than that of the co mode providing that the roimcr mode is feasible and superior to the co method compared with the co method the iabc roimcr method has evident advantages the average peak flow reduction rate is 69 13 at the cascade reservoir 35 18 at lizhuang station and 30 30 at zhutuo station i e 17 72 35 and 8 88 higher than those of the roimcr mode respectively and 20 33 13 35 and 11 higher than those of the co mode respectively therefore it can be seen that the application of the iabc algorithm in cascade flood control optimization is relatively feasible and has evident effects it can be seen from table 3 that the peak flow reduction rate is proportional to the utilisation rate of the flood control storage capacity table 3 also indicates that the iabc roimcr method has a higher utilisation efficiency for the cascade flood control storage capacity therefore the peak flow reduction rate is significantly higher than those of the other two scheduling modes however the iabc roimcr method has a high utilisation rate of the flood control storage capacity this affects the flood control safety of the reservoir itself to some extent nevertheless the maximum occupancy rate of the flood control storage capacity is lower than the utilisation rate of flood control storage capacity indicating that the four reservoirs in the cascade system do not reach the maximum flood control water level simultaneously this is also an advantage of the roimcr mode a buffering time is given to each reservoir in the cascade system to reduce the flood risk to a certain extent the comparison of flood crest before and after three dispatching modes is shown in table 4 and fig 11 the four floods are amplified by the regional combinations of flood volumes under the same frequency method in the downstream zhutuo hydrological station the peak flood exceeds the flood crest standard of the once in 50 year return period the 20100717 and 20120716 floods even reach the flood crest standard of the once in 100 year return period the peak floods of the upstream cascade reservoirs all reach the flood crest standard of the once in 50 year return period 32 000 m3 s of xiangjiaba reservoir and some floods even exceed the flood crest standard of the once in 100 year return period 34 800 m3 s as can be seen from the above chart when the peak flood magnitude reaches a 50 year return period or even a 100 year period the cascade outflow can be controlled below the 5 year return period 21 800 m3 s or even less after cascade reservoir operation the flood crest standard of the lizhuang hydrological station can be reduced from more than a 50 year return period 56 100 m3 s to a 5 year 39 800 m3 s and the iabc roimcr mode can reduce it to less than a 5 year period in addition the flood crest standard of zhutuo hydrological station can be reduced from the flood crest standard of the 50 year return period 62 500 m3 s or even 100 year 67 200 m3 s to the flood crest standard of a 20 year return period 55 900 m3 s the iabc roimcr mode can even reduce the flood crest standard of the zhutuo hydrological station to approximately a 5 year period 44 800 m3 s therefore it can be concluded that the cascade reservoir system in the lower reaches of jinshajiang river can significantly improve the flood control standard in the chuanjiang river basin and the joint operation with the three gorges reservoir can alleviate the flood pressure in the middle and upper reaches of the yangtze river basin during the flood season to a certain extent 4 conclusion this study considers the upper reaches of the yangtze river and the cascade reservoirs in the lower reaches of the jinshajiang river based on the agdp theory a new method for cascade reservoir joint flood control operation namely the roimcr is proposed the iabc algorithm is used to optimise the joint flood control operation of the cascade reservoir system reduce the dimensions of the cascade operation and find the optimal storage and discharge mode of the cascade reservoir system based on the flood control operation results of the cascade reservoirs in the lower reaches of jinshajiang river this study analyses the improvement of flood control standards in the lower reaches of yibin luzhou chongqing and other economically important cities as well as their role in the joint operation of the three gorges reservoir the specific conclusions are as follows 1 the average peak flow reduction rate of the cascade reservoirs in the roimcr mode is 51 4 that of the lizhuang hydrological station is 25 83 and that of the zhutuo hydrological station is 21 43 i e 2 6 4 and 2 13 more than those of the co mode respectively its advantages are not evident but every flood is better than that of the co mode this shows that the roimcr mode is feasible and has several advantages 2 the average peak flow reduction rate of the reservoir in the iabc roimcr mode is 69 13 the average peak flow reduction rate of the lizhuang hydrological station is 35 18 and the average peak flow reduction rate of zhutuo hydrological station is 30 30 these are 17 72 9 35 and 8 88 higher than those with the roimcr mode respectively and 20 33 13 35 and 11 higher than those of the co mode respectively this indicates that the application of the iabc algorithm to the optimal flood control operation of cascade reservoirs is relatively feasible and has evident effects 3 the iabc roimcr mode can reduce the flood crest standard of cascade reservoirs from a 100 year return period to less than a 5 year period and the flood crest standard of the lizhuang hydrological station from more than a 50 year return period to less than 5 year period the flood crest standard of the zhutuo hydrological station can be reduced from a 100 year return period to approximately a 5 year period thereby greatly improving the flood control standard in the chuanjiang river section of the yangtze river basin therefore the peak inflow to the three gorges reservoir is reduced and as a result the flood control pressure in the lower reaches of the yangtze river basin is alleviated to a certain extent roimcr mode and its combination with iabc algorithm on one hand are to reduce the dimension of cascade reservoir flood control operation to some extent on the other hand to explore a new mode of rational utilization of cascade reservoir flood control capacity so that a nonlinear effect of 1 1 greater than 2 can be achieved for the capacity utilization of all reservoirs in the process of flood regulation but at present roimcr mode is only applicable to large scale flood regulation and is limited to the joint flood control operation of cascade reservoir in the future it could be combined with dynamic control water level in stages and flood prediction to obtain more reasonable and effective flood control operation rules declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors acknowledge the financial support granted by the joint fund project of the natural science foundation of shaanxi province no 2021jlm 54 the key research and development project of shaanxi province no 2019sf 237 the fundamental research funds for the central universities chd no 300102291507 300102269201 
3753,deep groundwater confined groundwater is the major water source in cangzhou situated in the north china plain long term deep groundwater overexploitation has resulted in substantial groundwater storage gws depletion quantifying the influence of long term overexploitation on deep groundwater resources is extremely important to maintain the sustainability of the confined aquifer system in this study we estimate the amount of total exploitable gws and total gws depletion during 1960 2010 in the confined aquifer system across cangzhou by combining use of the insar deformation estimated skeletal storativity hydraulic head observations and hydrogeological data the total exploitable gws in cangzhou was 26 1 21 3 km3 and decreased by 13 0 8 1 km3 13 6 8 5 km3 until 2010 accounting for 49 8 52 2 of the total amount it is worth noting that 87 4 87 9 of the total gws depletion is irreversible leading to a substantial permanent loss of groundwater storage capacity our results suggest that the long term overexploitation has threatened the water supply security in cangzhou it is demonstrated that insar can be an effective tool for assessing the physical state and sustainable development potential of a confined aquifer system keywords insar cangzhou skeletal storativity the deep gws depletion sustainability of the confined aquifer system 1 introduction cangzhou is a highly productive industrial and agricultural area in the north china plain ncp since the beijing hangzhou grand canal cangzhou section dried up in the 1960s zhang et al 2009 groundwater has become the main water source and has experienced long term overexploitation to satisfy the rapidly increasing agricultural industrial and domestic needs groundwater in the semiconfined and unconfined aquifer systems is saline or brackish zhang et al 2009 thus groundwater is majorly exploited from the confined aquifer systems the substantial overexploitation of deep groundwater confined groundwater has led to largely irreversible groundwater storage gws depletion jiang et al 2018 threatening the water supply and food security scientific management of the limited deep groundwater resources and increasing the surface water supply are effective ways to maintain the sustainability of the confined aquifer system chen et al 2017 therefore quantification of the total exploitable gws in the confined aquifer system and the total gws depletion since the beginning of large scale pumping is vital for groundwater management and surface water allocation for cangzhou the total exploitable gws and gws depletion can be addressed by the groundwater flow model cao et al 2013 however the time cost and computational cost of a model are very high smith et al 2017 in addition to accurately estimate the amount of total exploitable gws and gws depletion the model requires detailed aquifer parameters however these data are deficient in cangzhou the total gws depletion can also be estimated based on the cumulative subsidence volume guo et al 1995 zhu et al 2014 unfortunately historical subsidence measurements e g leveling and gps with long temporal intervals and low spatial density cannot characterize the spatiotemporal evolution of ground subsidence across cangzhou caused by groundwater overexploitation interferometric synthetic aperture radar insar a remote sensing method that can map land deformation over large areas with high spatial and temporal resolutions ferretti et al 2001 hooper et al 2012 has been used to monitor land subsidence induced by groundwater overexploitation galloway and hoffmann 2007 othman and abotalib 2019 rateb and abotalib 2020 moreover insar offers an alternative way to estimate the skeletal storativity and gws depletion over areas where detailed hydrogeological data and historical subsidence measurements are scarce jiang et al 2018 previous studies such as chaussard et al 2017 smith et al 2017 and ojha et al 2018 successfully estimated gws depletion during the study period using multi temporal insar results and hydraulic head observations in previous work jiang et al 2018 we presented a method to quantify the recoverable gws rgws depletion and irreversible gws igws depletion by combining use of insar deformation and hydraulic head observations however these studies only focused on the gws depletion over a short time period according to our knowledge no investigations have been published on the quantification of the long term overexploitation influence on deep groundwater resources using insar deformation in this paper we present a new method to calculate the total exploitable gws and the total gws depletion since the 1960s and quantify the influence of long term overexploitation on deep groundwater resources first multi temporal insar analysis is employed with envisat asar data during 2003 2010 and sentinel 1 data during 2016 2019 to characterize the spatial temporal variability in land deformation over cangzhou second the elastic and inelastic skeletal storativity at observation well locations are estimated based on the coupling of insar deformation and hydraulic head changes finally we synergistically use the effective stress dependent skeletal storativity hydrogeological data and head measurements to determine the total exploitable gws the total gws depletion and the remaining exploitable gws in the confined aquifer system across cangzhou during 1960 2010 2 study area and datasets 2 1 study area cangzhou is situated in the eastern ncp and adjacent to bohai bay see fig 1 a the aquifer system containing four aquifer layers in cangzhou is comprised of unconsolidated quaternary sediments whose thickness can reach up to 400 500 m zhang et al 2009 there are 40 300 m thick saline brackish aquifers overlying the freshwater aquifers in the aquifer system fig 1b the groundwater is mainly pumped from the freshwater aquifers above the bottom of aquifer layer iii with a thickness of 10 100 m from west to east fig 1a because heterogeneous aquifers are controlled by the distribution of palaeochannels the thickness might vary sharply within a small area hebei bureau of geology and mineral resources exploration 1977 the aquifer is composed of fine sand in the west but a mixture of silt and fine sand in the coastal area zhang et al 2009 resulting in a decrease in sediment diameter toward bohai bay cangzhou is a typical city in china experiencing water shortage in recent decades surface water resources have decreased by 60 due to low precipitation and drying up of rivers which are caused by frequent and intensified droughts li 2010 to match the rapidly increasing water demand from industry agriculture and the domestic sector cangzhou began to pump groundwater from the confined aquifer system in the 1960 s groundwater offers approximately 80 of the total fresh water supply in cangzhou li 2015 the long term overexploitation led to one of the largest confined groundwater depression cones in the ncp with a maximum head drop of 100 m until 2005 zhang et al 2009 the rapid decline in the hydraulic head resulted in severe land subsidence with a maximum cumulative subsidence of 2 676 m hebei provincial department of land and resources 2013 to deal with the substantial gws depletion and rapid land subsidence a policy restricting the confined groundwater pumping and transferring surface water from the dalangdian reservoir has been implemented by the government since 2005 these measures resulted in a head rise of 13 5 m in the cangzhou urban zone until 2012 pang et al 2014 the recovery of heads led to uplift in the midwestern parts of cangzhou in contrast the subsidence continues in other areas although the heads in some regions are rising jiang et al 2018 2 2 datasets used in this study in this study two sar datasets composed of 123 envisat asar images acquired from 3 adjacent tracks during 2003 2010 and 103 sentinel 1a images during 2016 2019 are used to map the spatiotemporal deformation pattern across cangzhou the coverage of datasets is shown in fig 1 hydraulic head measurements of 64 wells fig 1 during 2002 2015 are used to calculate the aquifer parameters and quantify the total gws depletion since the 1960s the hydraulic head changes are monitored for aquifer layer iii in the west and for aquifer layers iii and iv in the east 3 methods 3 1 multi temporal insar analysis to obtain the spatial temporal variation of land deformation across cangzhou we implement the stamps sb method hooper et al 2007 with envisat asar data during 2003 2010 and sentinel 1 data during 2016 2019 when processing the asar data we use the long strip sar data to avoid the errors caused by aligning the frames within a path when processing the sentinel 1 data due to the limitation of computing power the datasets are divided into two parts 2016 2017 and 2018 2019 and processed separately the details for the multi temporal insar analysis are described in text s1 supplementary material the head in the hh5 observation well fig 1 was relatively stable during 2003 2010 thus we set the reference point in the town close to well hh5 for track 175 and track 447 due to the geocoding error and differences in the radar viewing geometry the geographic coordinates of one target in the overlapping areas of adjacent tracks are usually different therefore we interpolate the insar results in the overlapping areas on a 100 100 m grid and use the interpolated deformation to calculate the constant shift between track 218 and track 447 finally we align the insar results in the adjacent tracks with the estimated constant shift and obtain a seamless deformation map across cangzhou from 2003 to 2010 during 2016 2019 due to lack of the head data and we collect the deformation time series and velocity for the hecx gps station fig 1 provided by the first monitoring and application center china earthquake administration the hecx gps station is set as the reference point of insar analysis the mean insar deformation rate within a 500 m radius around the gps station is set to be equal to the gps deformation rate the horizontal deformation is negligible in the study area jiang et al 2018 thus we convert the insar retrieved los deformation to vertical deformation with the incident angle 3 2 estimation of skeletal storativity the skeletal storativity s k which is the volume of drained water from the unit area of the aquifer system when the hydraulic head declines one unit is given by the following equation hoffmann et al 2001 1 s k δ b δ h where δb is the thickness change compaction which equals the land deformation and δh is the head change of the aquifer system the skeletal storativity varies greatly depending on whether the head is above the preconsolidation head which is the previous lowest head level in aquitards leake 1990 when the head is above the preconsolidation head the compaction is elastic in the aquifers and aquitards and can be restored after the head returns to the initial level chaussard et al 2014 however if the head drops below the preconsolidation head inelastic and irreversible compaction due to grain rearrangement occurs in aquitards the compressibility and thus the skeletal storativity in the elastic range are much smaller than those in the inelastic range hoffmann et al 2003 therefore we use elastic skeletal storativity s ke and inelastic skeletal storativity s kv to describe the water release capacity due to elastic and inelastic compactions in a confined aquifer system respectively we can estimate the elastic skeletal storativity according to the following equation miller et al 2015 jiang et al 2018 2 s ke δ b s δ h s where δ b s is the seasonal deformation and δ h s is the seasonal change in the hydraulic head because the vertical hydraulic conductivity in aquitards is low the head change in aquitards typically lags behind those in adjacent aquifers hoffmann et al 2003 when the head in aquifers drops the head in aquitards will take a period of time to achieve balance during this period of time which is described by the time constant τ 0 head difference between the aquitards and the adjacent aquifers will lead to continuous drainage of water from aquitards to aquifers and consequent inelastic compaction deformation jiang et al 2018 for the confined aquifer system s kv and τ 0 can be estimated by the following relation hoffmann et al 2003 3 δ b inelastic t s kv δ h 1 8 π 2 e π 2 t 4 τ 0 where δ b inelastic is the inelastic deformation in aquitards and t is the time after the change in head 3 3 estimation of the exploitable gws and gws depletion overexploitation leads to rapid head decline when the head drops below the roof of the confined aquifer system thus this confined aquifer system will become unsaturated and unconfined we refer to the total volume of water released from a confined aquifer system when the heads in both aquifers and aquitards drop from the original level to the roof of this confined aquifer system as the total exploitable gws we assume that the original heads in aquifers and aquitards are the same the total exploitable gws v total can be estimated as follows 4 v total s ke s kv d h a where h is the depth of the original head which is the distance from the original head to the surface d is the depth of the roof of the confined aquifer system and a is the area long term groundwater overexploitation since the 1960s has led to rapid compaction and consequent gws depletion in the confined aquifer system across cangzhou the total gws tgws depletion can be divided into recoverable gws rgws depletion due to elastic compaction and irreversible gws igws depletion due to inelastic compaction jiang et al 2018 the rgws depletion δ v r can be calculated as follows 5 δ v r s ke δ h total a where δ h total is the total head change since the 1960s the igws depletion δ v i can be estimated as follows 6 δ v i s kv δ h pre a where δ h pre is the change in preconsolidation head since the 1960s the tgws depletion δ v can be estimated as follows 7 δ v δ v r δ v i the remaining exploitable gws v r can be calculated by subtracting the tgws depletion from the total exploitable gws 8 v r v total δ v when we calculate the total exploitable gws and gws depletion the inverse distance weighted idw interpolation method is applied to the discrete skeletal storativity and hydraulic head measurements the uncertainty estimation methods for the total exploitable gws and gws depletion are similar to those described in our previous work jiang et al 2018 and are briefly described in text s3 4 results and discussion 4 1 spatiotemporal distribution of land deformation in cangzhou fig 2 shows the mean deformation rate maps in cangzhou obtained from the multi temporal insar analysis during 2003 2010 there were five subsidence bowls with the subsidence rate greater than 20 mm yr in cangzhou the most serious subsidence occurs in the subsidence bowl a with a maximum rate of 70 mm yr the subsidence bowls across cangzhou can be divided into 2 kinds depending on the response of the confined aquifer system to a head change in the subsidence bowls c and d the hydraulic head is relatively stable the change is less than 5 m fig 2 but the subsidence continues with a decreasing rate fig s1 in the supplementary material suggesting that the subsidence is mainly due to the delayed water release from the aquitards caused by the head drop before the study period in the subsidence bowls b and e the subsidence distribution is consistent with that of the head drops indicating that the subsidence is mainly due to head declines during the study period although there are no head data available in the subsidence bowl a we can infer that the subsidence is mainly due to the ongoing head drops during the study period since the annual mean deformation rate varies from year to year which is similar to the deformation patterns seen in subsidence bowls b and e fig s1 an obvious uplift pattern can be observed in northwest cangzhou during 2003 2010 which should be attributed to the head rise due to the groundwater exploitation restriction policy an interesting phenomenon is that the uplift in the southern part of the uplift zone f is characterized by a linear distribution pattern in space this pattern is consistent with the distribution of the hutuohe palaeochannel see the red dashed lines in fig 2 which is composed of sand and gravel with high hydraulic conductivity and runoff conditions to avoid drying up of baiyangdian lake the government transferred 5 2 108 m3 of water from the yellow river and yuecheng reservoir through 4 water transfer projects during 2004 and 2010 hu et al 2013 wang et al 2011 these findings suggest that the linear distribution pattern of uplift is most likely due to lateral recharge along the hutuohe palaeochannel from baiyangdian lake the subsidence patterns during 2016 2017 and 2018 2019 are similar to that during 2003 2010 but the subsidence rate increases and the uplift patterns in northwest cangzhou disappear the severe drought occurred in 2014 led to an average drop of 6 m in hydraulic head across cangzhou and the head continued to be low during 2016 2019 the average head dropped by 7 2 m from 2003 to 2010 to 2016 2019 fig s2 this large hydraulic head drop should be responsible for the aggravated subsidence during 2016 2019 compared with the insar result during 2016 2017 the subsidence rate decreases in the eastern part but increases in the western part during 2018 2019 the decreasing subsidence rate in the east is consistent with the pattern of delayed inelastic subsidence caused by head drops in 2014 the increasing subsidence rate in the west is attributed mainly to the rapidly growing confined groundwater depression cone in adjacent areas in hengshui city where the head dropped 10 m from 2018 to 2019 department of water resources of hebei province 2018 2019 to investigate the relationship between the deformation and the land covers the glc fcs30 data a global 30 m land cover product with a fine classification system from 1985 to 2020 zhang et al 2021 are collected the land covers in cangzhou are dominated by impervious surfaces and rainfed croplands fig s3 due to the low coherence caused by the crops few ps pixels are selected in the rainfed cropland since the villages are small and surrounded by rainfed croplands the insar results in villages can characterize the deformation in rainfed croplands caused by groundwater pumping for irrigation we redivide cangzhou into urban areas and agricultural areas and investigate their relationships with deformation rate the extent of the urban areas is collected from zhou et al 2021 and the agricultural areas include rainfed croplands and impervious surfaces except for the urban area the mean deformation rates in urban areas and agricultural areas were 13 9 mm yr and 11 3 mm yr during 2003 2010 and 42 1 mm yr and 39 7 mm yr during 2016 2019 respectively the deformation rate in urban areas is slightly faster than that in agricultural areas but no significant difference exists less than 3 mm yr 4 2 skeletal storativity in this study we collect the head observations from 2002 to 2015 at 64 wells to estimate the skeletal storativity across cangzhou fig 1 thus the elastic skeletal storativity is estimated using the insar results and the head observations during 2003 2010 the estimation method of elastic skeletal storativity was published previously in earlier work jiang et al 2018 but we briefly summarize the processing flowchart here the details for the method are found in text s2 of the supplementary material and our previous work jiang et al 2018 first the seasonal deformation and seasonal head change are isolated from the original time series of deformation and head changes using multichannel singular spectrum analysis m ssa owing to the limited data in track 218 and track 447 before 2007 and in track 175 during 2003 2010 only the deformation results in track 218 and track 447 during 2007 and 2010 are used to isolate the seasonal signals then we apply a correlation analysis to detect the time lags between the seasonal deformation and seasonal head change and calibrate the seasonal deformation with the estimated time lags the calibrated seasonal deformation time series is linearly interpolated in time to coincide with the head observations finally the elastic skeletal storativity are calculated with a least squares inversion at 57 well locations the values of the elastic skeletal storativity range from 2 2 10 4 to 4 4 10 3 validation with the results derived from pumping tests and poroelastic rebound and a comparison between the results in adjacent tracks suggest that the estimated s ke using seasonal deformation is reliable table s1 figures s4 and s5 using an idw algorithm the results of estimated elastic skeletal storativity are interpolated on a map with a cell resolution of 500 m fig 3 we find that the larger values of s ke correlate with areas that have thicker aquifers and finer sediments in the uplift zone g and the eastern part of cangzhou if the head drops below the preconsolidation head inelastic compaction occurs in aquitards to estimate the inelastic skeletal storativity we need to select the wells where the head is below the preconsolidation head before the policy was implemented in 2005 which restricted groundwater exploitation the heads in both aquifers and aquitards continued to drop since the 1960 s zhang et al 2009 because the vertical hydraulic conductivity is low in aquitards the head in aquifers should be below that in aquitards i e the preconsolidation head jiang et al 2018 therefore if the head continues to drop and subsidence continues during the study period the head should be below the preconsolidation head a total of 8 wells are identified squares in fig 3 and used to calculate the inelastic skeletal storativity the elastic deformation can be estimated by s ke and the head change we can obtain the inelastic deformation by subtracting the elastic deformation from the total deformation then s kv and τ 0 can be inverted using equation 3 with the estimated inelastic deformation and head measurements since equation 3 is nonlinear we implement the inversion as a search for parameter space followed by a linear inversion to estimate the optimal solution we set the step length as 1 day and the search range as 50 years for τ 0 for each search s kv is estimated using a least squares inversion the result with the minimum root mean square error is regarded as the optimal solution for the inversion the inelastic skeletal storativity and time constant range from 3 32 10 3 to 3 19 10 2 and 1 02 to 12 75 years respectively at these 8 well locations table 1 well dg3 is located in the overlapping region of track 218 and track 447 the values of s kv at well dg3 in track 218 and track 447 are 9 62 1 08 10 3 and 9 59 0 92 10 3 respectively which shows good consistency s ke at wells hh1 and hh2 used to estimate the elastic deformation are the interpolation results since the s ke at these two wells are not estimated due to the negligible seasonal changes in hydraulic head until 2013 a maximum cumulative subsidence of 2 676 m and a maximum head drop of 91 8 m occurred in the municipal district of cangzhou hebei provincial department of land and resources 2013 the head in the municipal district was above the preconsolidation head and was relatively static during 2008 2013 jiang et al 2018 thus we roughly estimate s k using equation 1 with the cumulative subsidence and head drop indicated by triangles in fig 3 then we obtain s kv by subtracting the mean s ke in the municipal district s kv in the municipal district is 2 78 10 2 which agrees well with the result derived from insar deformation 4 3 the influence of long term overexploitation on deep groundwater resources skeletal storativity is theoretically effective stress dependent rudolph and frind 1991 the laboratory consolidation tests on sediment cores of aquifer layer iii in cangzhou suggest that the compressibility of the sediment and consequent skeletal storativity decrease greatly along with the rapid rising effective stress due to the head drops guo et al 2014 therefore if we use the constant skeletal storativity to estimate the tgws depletion and remaining exploitable gws the former will be underestimated and the latter will be overestimated liu et al 2019 investigated the relation between s k and head decline in cangzhou using a one dimensional nonlinear subsidence model see fig s6 in the supplementary material based on this relation we know that the average drop in head of 62 m across cangzhou results in a 51 decrease in the original skeletal storativity since a constant s k will lead to large estimation errors we use the effective stress dependent s k to estimate the total exploitable gws and gws depletion in this study the effective stress dependent s k can be obtained via jointly analyzing the estimated s k using insar deformation and the relation between s k and head drop derived by liu et al 2019 because the results of s kv are relatively sparse we jointly use s kv estimated using insar deformation and s kv estimated using the cumulative subsidence in the municipal district to calculate the exploitable gws and gws depletion since the head data are not available in renqiu city and suning county the exploitable gws and gws depletion are not calculated in these two regions 4 3 1 the total exploitable gws in the confined aquifer system the upper aquifer layers are saline brackish in cangzhou the freshwater aquifers in aquifer layer iii are thicker than those in other aquifer layers with coarser sediments higher hydraulic conductivity and better water yield therefore the groundwater is mainly pumped from aquifer layer iii zhang et al 2009 at the beginning of large scale pumping in the 1960s the head was close to the earth s surface in the west and was above the surface in the east hebei bureau of geology and mineral resources exploration 1977 we assume that the mean original head is equal to the elevation of the surface causing the depth of the original head h in equation 4 to be zero thus we use the depth of the roof of aquifer layer iii derived from zhang et al 2009 to estimate the total exploitable gws according to equation 4 the total exploitable gws in cangzhou excluding renqiu city and suning county is 26 1 21 3 km3 the distribution of the total exploitable gws fig 4 indicates that the exploitable gws varies spatially throughout cangzhou the large skeletal storativity and depth of aquifer layer iii result in the highly exploitable gws in qing county which can reach up to 5 m in ewt in contrast the exploitable gws is typically less than 1 5 m in ewt in the eastern coastal areas due to the small inelastic skeletal storativity 4 3 2 the gws depletion during 1960 2010 since the depth of the original head is zero in cangzhou the total head change is equal to the depth to water level therefore we use the depth of head in 2010 and estimate s ke to calculate the rgws depletion across cangzhou according to equation 5 until 2010 the rgws depletion in cangzhou excluding renqiu city and suning county was 1 64 0 82 km3 fig 5 shows the distribution of rgws depletion across cangzhou the rgws depletion mainly occurs in uplift zone g and the eastern part of cangzhou due to the large s ke and hydraulic head drops theoretically the rgws depletion due to elastic compaction should be recovered when the head returns to its original level however in the eastern area adjacent to bohai bay the lateral recharge from the western piedmont plain is negligible since cangzhou is surrounded by several deep groundwater depression cones zhu et al 2014 additionally because both overlying aquifer layer i and aquifer layer ii are saline or brackish aquifers gray dashed lines in fig 5 the leakage recharge from the overlying aquifers will lead to saline intrusion therefore the actual recoverable gws depletion is less than the estimated value to estimate the igws depletion the change in the preconsolidation head is needed the preconsolidation head is the lowest head ever experienced in aquitards in the past jiang et al 2018 leake 1990 and cannot be directly measured the preconsolidation head is usually determined by the responses of the confined aquifer systems to head changes we assume that the original preconsolidation head is the head before large scale pumping which is equal to the surface elevation since there are no historical deformation data in cangzhou we will use the deformation derived from insar and hydraulic head observations during 2003 and 2010 to determine the preconsolidation head in 2010 as mentioned in section 5 2 the observed head should be below the preconsolidation head before 2005 the 64 observation wells can be divided into 5 kinds depending on the responses of the confined aquifer systems to head changes during 2005 and 2010 1 if the head drops and subsidence continues fig 6 a the head should be below the preconsolidation head we determine the highest head during the period of time constant before 2010 to be the preconsolidation head 2 if the head is relatively static with obvious oscillations but subsidence still continues at a reduced rate fig 6b there are two cases that may lead to this phenomenon a the head was always below the preconsolidation head during 2005 2010 in this case we assume that the highest head is the upper estimation of the preconsolidation head h pre u in fig 6b b the high head in each year downward arrows in fig 6b is above the preconsolidation head but the low head in each year upward arrows in fig 6b is below the preconsolidation head in this case the highest value of low heads is determined as the lower estimation of the preconsolidation head h pre l in fig 6b 3 if the head rises and subsidence continues with a reduced rate fig 6c this suggests that the head is still lower than the preconsolidation head we assume that the highest head is the preconsolidation head 4 if the head rises the subsidence rate is reduced to zero fig 6d the preconsolidation head is determined to be the head corresponding to the time when the subsidence stops 5 if the head rises and uplift occurs fig 6e this suggests that the head is above the preconsolidation head we determine the lowest head to be the preconsolidation head these estimated preconsolidation heads might have relatively large uncertainties but can still be used to approximately characterize the distribution of the actual preconsolidation head since the head changes from declining to rising during the study period and the period of head rise 2005 2010 6 years is approximately equal to the mean time constant 6 2 years fig 7 a illustrates the igws depletion in cangzhou excluding renqiu city and suning county estimated using equation 6 the cumulative igws depletion until 2010 was 11 4 8 0 km3 12 0 8 5 km3 the municipal district and qing county experienced the most serious igws depletion which can reach up to 2 7 m in ewt in contrast the igws depletion is typically less than 0 8 m in the eastern coastal areas the tgws depletion is 13 0 8 1 km3 13 6 8 5 km3 accounting for 49 8 52 2 of the total exploitable gws as shown in fig 7b the spatial distribution pattern of tgws depletion is similar to that of the igws depletion the percentage of tgws depletion in the total exploitable gws is typically larger than 40 in most parts of the study area except the southeast and southwest areas and can reach up to 77 in the municipal district fig 7c the high percentage suggests that long term overexploitation has threatened groundwater strategic reserve security and emergency water supply capacity the more serious problem is that the igws depletion accounts for 87 4 87 9 of tgws depletion suggesting that most tgws depletion is irreversible and will lead to permanent loss of groundwater storage capacity subtracting the tgws depletion from the total exploitable gws we can obtain the remaining exploitable gws ranging from 12 5 22 8 km3 to 13 1 22 9 km3 fig 7d 5 conclusions in this study we present a new method to estimate the elastic and inelastic skeletal storativity through the combination of insar deformation and head observations furthermore using the effective stress dependent skeletal storativity head measurements and hydrogeological data we quantify the total exploitable gws the tgws depletion and the remaining exploitable gws in cangzhou during 1960 2010 our results suggest that the tgws depletion and remaining exploitable gws in cangzhou are 13 0 8 1 km3 13 6 8 5 km3 and 12 5 22 8 km3 to 13 1 22 9 km3 respectively which account for 49 8 52 2 and 47 8 50 2 of the total exploitable gws respectively the high percentage of tgws depletion in the total exploitable gws which can reach up to 77 in the municipal district of cangzhou suggests that the long term overexploitation has threatened the groundwater strategic reserve security and the emergency water supply capacity the igws depletion accounts for 87 4 87 9 of tgws depletion inferring that most of the gws depletion is irreversible and leads to permanent loss of groundwater storage capacity in the confined aquifer system this presented method enables us to estimate the tgws depletion the permanent loss of groundwater storage capacity due to long term overexploitation and the remaining exploitable gws these results regarding the sustainability of deep groundwater resources can offer regulators crucial information for making plans for deep groundwater pumping and surface water allocation therefore insar is testified to be an effective tool for assessing the physical state and sustainable development potential of a confined aquifer system credit authorship contribution statement lin bai conceptualization methodology visualization writing original draft liming jiang conceptualization writing review editing funding acquisition yong zhao resources investigation zhenhong li supervision writing review editing guoliang cao data curation chaoying zhao writing review editing rong liu formal analysis visualization hansheng wang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was supported by the national key research and development program of china grant no 2019yfc1509201 the national natural science foundation of china 42004005 41621091 41874005 41974009 the natural science basic research program of shaanxi program no 2020jq 357 the fundamental research funds for the central universities chd ref 300102260104 300102260301 and 300102261404 and the open research fund of state key laboratory of geodesy and earth s dynamics cas sklged2019 2 1 e we want to thank esa for providing the envisat asar data projects dragon 4 32388 and 32244 dragon 5 59339 and data service request 37777 and sentinel 1 data hooper at the university of leeds for providing the stamps software tu delft for providing the doris software and the ssa mtm group at ucla for providing the ssa mtm toolkit additiionally we thank ph d zhou meiling at chang an university for providing the extent of the urban area in cangzhou 
3753,deep groundwater confined groundwater is the major water source in cangzhou situated in the north china plain long term deep groundwater overexploitation has resulted in substantial groundwater storage gws depletion quantifying the influence of long term overexploitation on deep groundwater resources is extremely important to maintain the sustainability of the confined aquifer system in this study we estimate the amount of total exploitable gws and total gws depletion during 1960 2010 in the confined aquifer system across cangzhou by combining use of the insar deformation estimated skeletal storativity hydraulic head observations and hydrogeological data the total exploitable gws in cangzhou was 26 1 21 3 km3 and decreased by 13 0 8 1 km3 13 6 8 5 km3 until 2010 accounting for 49 8 52 2 of the total amount it is worth noting that 87 4 87 9 of the total gws depletion is irreversible leading to a substantial permanent loss of groundwater storage capacity our results suggest that the long term overexploitation has threatened the water supply security in cangzhou it is demonstrated that insar can be an effective tool for assessing the physical state and sustainable development potential of a confined aquifer system keywords insar cangzhou skeletal storativity the deep gws depletion sustainability of the confined aquifer system 1 introduction cangzhou is a highly productive industrial and agricultural area in the north china plain ncp since the beijing hangzhou grand canal cangzhou section dried up in the 1960s zhang et al 2009 groundwater has become the main water source and has experienced long term overexploitation to satisfy the rapidly increasing agricultural industrial and domestic needs groundwater in the semiconfined and unconfined aquifer systems is saline or brackish zhang et al 2009 thus groundwater is majorly exploited from the confined aquifer systems the substantial overexploitation of deep groundwater confined groundwater has led to largely irreversible groundwater storage gws depletion jiang et al 2018 threatening the water supply and food security scientific management of the limited deep groundwater resources and increasing the surface water supply are effective ways to maintain the sustainability of the confined aquifer system chen et al 2017 therefore quantification of the total exploitable gws in the confined aquifer system and the total gws depletion since the beginning of large scale pumping is vital for groundwater management and surface water allocation for cangzhou the total exploitable gws and gws depletion can be addressed by the groundwater flow model cao et al 2013 however the time cost and computational cost of a model are very high smith et al 2017 in addition to accurately estimate the amount of total exploitable gws and gws depletion the model requires detailed aquifer parameters however these data are deficient in cangzhou the total gws depletion can also be estimated based on the cumulative subsidence volume guo et al 1995 zhu et al 2014 unfortunately historical subsidence measurements e g leveling and gps with long temporal intervals and low spatial density cannot characterize the spatiotemporal evolution of ground subsidence across cangzhou caused by groundwater overexploitation interferometric synthetic aperture radar insar a remote sensing method that can map land deformation over large areas with high spatial and temporal resolutions ferretti et al 2001 hooper et al 2012 has been used to monitor land subsidence induced by groundwater overexploitation galloway and hoffmann 2007 othman and abotalib 2019 rateb and abotalib 2020 moreover insar offers an alternative way to estimate the skeletal storativity and gws depletion over areas where detailed hydrogeological data and historical subsidence measurements are scarce jiang et al 2018 previous studies such as chaussard et al 2017 smith et al 2017 and ojha et al 2018 successfully estimated gws depletion during the study period using multi temporal insar results and hydraulic head observations in previous work jiang et al 2018 we presented a method to quantify the recoverable gws rgws depletion and irreversible gws igws depletion by combining use of insar deformation and hydraulic head observations however these studies only focused on the gws depletion over a short time period according to our knowledge no investigations have been published on the quantification of the long term overexploitation influence on deep groundwater resources using insar deformation in this paper we present a new method to calculate the total exploitable gws and the total gws depletion since the 1960s and quantify the influence of long term overexploitation on deep groundwater resources first multi temporal insar analysis is employed with envisat asar data during 2003 2010 and sentinel 1 data during 2016 2019 to characterize the spatial temporal variability in land deformation over cangzhou second the elastic and inelastic skeletal storativity at observation well locations are estimated based on the coupling of insar deformation and hydraulic head changes finally we synergistically use the effective stress dependent skeletal storativity hydrogeological data and head measurements to determine the total exploitable gws the total gws depletion and the remaining exploitable gws in the confined aquifer system across cangzhou during 1960 2010 2 study area and datasets 2 1 study area cangzhou is situated in the eastern ncp and adjacent to bohai bay see fig 1 a the aquifer system containing four aquifer layers in cangzhou is comprised of unconsolidated quaternary sediments whose thickness can reach up to 400 500 m zhang et al 2009 there are 40 300 m thick saline brackish aquifers overlying the freshwater aquifers in the aquifer system fig 1b the groundwater is mainly pumped from the freshwater aquifers above the bottom of aquifer layer iii with a thickness of 10 100 m from west to east fig 1a because heterogeneous aquifers are controlled by the distribution of palaeochannels the thickness might vary sharply within a small area hebei bureau of geology and mineral resources exploration 1977 the aquifer is composed of fine sand in the west but a mixture of silt and fine sand in the coastal area zhang et al 2009 resulting in a decrease in sediment diameter toward bohai bay cangzhou is a typical city in china experiencing water shortage in recent decades surface water resources have decreased by 60 due to low precipitation and drying up of rivers which are caused by frequent and intensified droughts li 2010 to match the rapidly increasing water demand from industry agriculture and the domestic sector cangzhou began to pump groundwater from the confined aquifer system in the 1960 s groundwater offers approximately 80 of the total fresh water supply in cangzhou li 2015 the long term overexploitation led to one of the largest confined groundwater depression cones in the ncp with a maximum head drop of 100 m until 2005 zhang et al 2009 the rapid decline in the hydraulic head resulted in severe land subsidence with a maximum cumulative subsidence of 2 676 m hebei provincial department of land and resources 2013 to deal with the substantial gws depletion and rapid land subsidence a policy restricting the confined groundwater pumping and transferring surface water from the dalangdian reservoir has been implemented by the government since 2005 these measures resulted in a head rise of 13 5 m in the cangzhou urban zone until 2012 pang et al 2014 the recovery of heads led to uplift in the midwestern parts of cangzhou in contrast the subsidence continues in other areas although the heads in some regions are rising jiang et al 2018 2 2 datasets used in this study in this study two sar datasets composed of 123 envisat asar images acquired from 3 adjacent tracks during 2003 2010 and 103 sentinel 1a images during 2016 2019 are used to map the spatiotemporal deformation pattern across cangzhou the coverage of datasets is shown in fig 1 hydraulic head measurements of 64 wells fig 1 during 2002 2015 are used to calculate the aquifer parameters and quantify the total gws depletion since the 1960s the hydraulic head changes are monitored for aquifer layer iii in the west and for aquifer layers iii and iv in the east 3 methods 3 1 multi temporal insar analysis to obtain the spatial temporal variation of land deformation across cangzhou we implement the stamps sb method hooper et al 2007 with envisat asar data during 2003 2010 and sentinel 1 data during 2016 2019 when processing the asar data we use the long strip sar data to avoid the errors caused by aligning the frames within a path when processing the sentinel 1 data due to the limitation of computing power the datasets are divided into two parts 2016 2017 and 2018 2019 and processed separately the details for the multi temporal insar analysis are described in text s1 supplementary material the head in the hh5 observation well fig 1 was relatively stable during 2003 2010 thus we set the reference point in the town close to well hh5 for track 175 and track 447 due to the geocoding error and differences in the radar viewing geometry the geographic coordinates of one target in the overlapping areas of adjacent tracks are usually different therefore we interpolate the insar results in the overlapping areas on a 100 100 m grid and use the interpolated deformation to calculate the constant shift between track 218 and track 447 finally we align the insar results in the adjacent tracks with the estimated constant shift and obtain a seamless deformation map across cangzhou from 2003 to 2010 during 2016 2019 due to lack of the head data and we collect the deformation time series and velocity for the hecx gps station fig 1 provided by the first monitoring and application center china earthquake administration the hecx gps station is set as the reference point of insar analysis the mean insar deformation rate within a 500 m radius around the gps station is set to be equal to the gps deformation rate the horizontal deformation is negligible in the study area jiang et al 2018 thus we convert the insar retrieved los deformation to vertical deformation with the incident angle 3 2 estimation of skeletal storativity the skeletal storativity s k which is the volume of drained water from the unit area of the aquifer system when the hydraulic head declines one unit is given by the following equation hoffmann et al 2001 1 s k δ b δ h where δb is the thickness change compaction which equals the land deformation and δh is the head change of the aquifer system the skeletal storativity varies greatly depending on whether the head is above the preconsolidation head which is the previous lowest head level in aquitards leake 1990 when the head is above the preconsolidation head the compaction is elastic in the aquifers and aquitards and can be restored after the head returns to the initial level chaussard et al 2014 however if the head drops below the preconsolidation head inelastic and irreversible compaction due to grain rearrangement occurs in aquitards the compressibility and thus the skeletal storativity in the elastic range are much smaller than those in the inelastic range hoffmann et al 2003 therefore we use elastic skeletal storativity s ke and inelastic skeletal storativity s kv to describe the water release capacity due to elastic and inelastic compactions in a confined aquifer system respectively we can estimate the elastic skeletal storativity according to the following equation miller et al 2015 jiang et al 2018 2 s ke δ b s δ h s where δ b s is the seasonal deformation and δ h s is the seasonal change in the hydraulic head because the vertical hydraulic conductivity in aquitards is low the head change in aquitards typically lags behind those in adjacent aquifers hoffmann et al 2003 when the head in aquifers drops the head in aquitards will take a period of time to achieve balance during this period of time which is described by the time constant τ 0 head difference between the aquitards and the adjacent aquifers will lead to continuous drainage of water from aquitards to aquifers and consequent inelastic compaction deformation jiang et al 2018 for the confined aquifer system s kv and τ 0 can be estimated by the following relation hoffmann et al 2003 3 δ b inelastic t s kv δ h 1 8 π 2 e π 2 t 4 τ 0 where δ b inelastic is the inelastic deformation in aquitards and t is the time after the change in head 3 3 estimation of the exploitable gws and gws depletion overexploitation leads to rapid head decline when the head drops below the roof of the confined aquifer system thus this confined aquifer system will become unsaturated and unconfined we refer to the total volume of water released from a confined aquifer system when the heads in both aquifers and aquitards drop from the original level to the roof of this confined aquifer system as the total exploitable gws we assume that the original heads in aquifers and aquitards are the same the total exploitable gws v total can be estimated as follows 4 v total s ke s kv d h a where h is the depth of the original head which is the distance from the original head to the surface d is the depth of the roof of the confined aquifer system and a is the area long term groundwater overexploitation since the 1960s has led to rapid compaction and consequent gws depletion in the confined aquifer system across cangzhou the total gws tgws depletion can be divided into recoverable gws rgws depletion due to elastic compaction and irreversible gws igws depletion due to inelastic compaction jiang et al 2018 the rgws depletion δ v r can be calculated as follows 5 δ v r s ke δ h total a where δ h total is the total head change since the 1960s the igws depletion δ v i can be estimated as follows 6 δ v i s kv δ h pre a where δ h pre is the change in preconsolidation head since the 1960s the tgws depletion δ v can be estimated as follows 7 δ v δ v r δ v i the remaining exploitable gws v r can be calculated by subtracting the tgws depletion from the total exploitable gws 8 v r v total δ v when we calculate the total exploitable gws and gws depletion the inverse distance weighted idw interpolation method is applied to the discrete skeletal storativity and hydraulic head measurements the uncertainty estimation methods for the total exploitable gws and gws depletion are similar to those described in our previous work jiang et al 2018 and are briefly described in text s3 4 results and discussion 4 1 spatiotemporal distribution of land deformation in cangzhou fig 2 shows the mean deformation rate maps in cangzhou obtained from the multi temporal insar analysis during 2003 2010 there were five subsidence bowls with the subsidence rate greater than 20 mm yr in cangzhou the most serious subsidence occurs in the subsidence bowl a with a maximum rate of 70 mm yr the subsidence bowls across cangzhou can be divided into 2 kinds depending on the response of the confined aquifer system to a head change in the subsidence bowls c and d the hydraulic head is relatively stable the change is less than 5 m fig 2 but the subsidence continues with a decreasing rate fig s1 in the supplementary material suggesting that the subsidence is mainly due to the delayed water release from the aquitards caused by the head drop before the study period in the subsidence bowls b and e the subsidence distribution is consistent with that of the head drops indicating that the subsidence is mainly due to head declines during the study period although there are no head data available in the subsidence bowl a we can infer that the subsidence is mainly due to the ongoing head drops during the study period since the annual mean deformation rate varies from year to year which is similar to the deformation patterns seen in subsidence bowls b and e fig s1 an obvious uplift pattern can be observed in northwest cangzhou during 2003 2010 which should be attributed to the head rise due to the groundwater exploitation restriction policy an interesting phenomenon is that the uplift in the southern part of the uplift zone f is characterized by a linear distribution pattern in space this pattern is consistent with the distribution of the hutuohe palaeochannel see the red dashed lines in fig 2 which is composed of sand and gravel with high hydraulic conductivity and runoff conditions to avoid drying up of baiyangdian lake the government transferred 5 2 108 m3 of water from the yellow river and yuecheng reservoir through 4 water transfer projects during 2004 and 2010 hu et al 2013 wang et al 2011 these findings suggest that the linear distribution pattern of uplift is most likely due to lateral recharge along the hutuohe palaeochannel from baiyangdian lake the subsidence patterns during 2016 2017 and 2018 2019 are similar to that during 2003 2010 but the subsidence rate increases and the uplift patterns in northwest cangzhou disappear the severe drought occurred in 2014 led to an average drop of 6 m in hydraulic head across cangzhou and the head continued to be low during 2016 2019 the average head dropped by 7 2 m from 2003 to 2010 to 2016 2019 fig s2 this large hydraulic head drop should be responsible for the aggravated subsidence during 2016 2019 compared with the insar result during 2016 2017 the subsidence rate decreases in the eastern part but increases in the western part during 2018 2019 the decreasing subsidence rate in the east is consistent with the pattern of delayed inelastic subsidence caused by head drops in 2014 the increasing subsidence rate in the west is attributed mainly to the rapidly growing confined groundwater depression cone in adjacent areas in hengshui city where the head dropped 10 m from 2018 to 2019 department of water resources of hebei province 2018 2019 to investigate the relationship between the deformation and the land covers the glc fcs30 data a global 30 m land cover product with a fine classification system from 1985 to 2020 zhang et al 2021 are collected the land covers in cangzhou are dominated by impervious surfaces and rainfed croplands fig s3 due to the low coherence caused by the crops few ps pixels are selected in the rainfed cropland since the villages are small and surrounded by rainfed croplands the insar results in villages can characterize the deformation in rainfed croplands caused by groundwater pumping for irrigation we redivide cangzhou into urban areas and agricultural areas and investigate their relationships with deformation rate the extent of the urban areas is collected from zhou et al 2021 and the agricultural areas include rainfed croplands and impervious surfaces except for the urban area the mean deformation rates in urban areas and agricultural areas were 13 9 mm yr and 11 3 mm yr during 2003 2010 and 42 1 mm yr and 39 7 mm yr during 2016 2019 respectively the deformation rate in urban areas is slightly faster than that in agricultural areas but no significant difference exists less than 3 mm yr 4 2 skeletal storativity in this study we collect the head observations from 2002 to 2015 at 64 wells to estimate the skeletal storativity across cangzhou fig 1 thus the elastic skeletal storativity is estimated using the insar results and the head observations during 2003 2010 the estimation method of elastic skeletal storativity was published previously in earlier work jiang et al 2018 but we briefly summarize the processing flowchart here the details for the method are found in text s2 of the supplementary material and our previous work jiang et al 2018 first the seasonal deformation and seasonal head change are isolated from the original time series of deformation and head changes using multichannel singular spectrum analysis m ssa owing to the limited data in track 218 and track 447 before 2007 and in track 175 during 2003 2010 only the deformation results in track 218 and track 447 during 2007 and 2010 are used to isolate the seasonal signals then we apply a correlation analysis to detect the time lags between the seasonal deformation and seasonal head change and calibrate the seasonal deformation with the estimated time lags the calibrated seasonal deformation time series is linearly interpolated in time to coincide with the head observations finally the elastic skeletal storativity are calculated with a least squares inversion at 57 well locations the values of the elastic skeletal storativity range from 2 2 10 4 to 4 4 10 3 validation with the results derived from pumping tests and poroelastic rebound and a comparison between the results in adjacent tracks suggest that the estimated s ke using seasonal deformation is reliable table s1 figures s4 and s5 using an idw algorithm the results of estimated elastic skeletal storativity are interpolated on a map with a cell resolution of 500 m fig 3 we find that the larger values of s ke correlate with areas that have thicker aquifers and finer sediments in the uplift zone g and the eastern part of cangzhou if the head drops below the preconsolidation head inelastic compaction occurs in aquitards to estimate the inelastic skeletal storativity we need to select the wells where the head is below the preconsolidation head before the policy was implemented in 2005 which restricted groundwater exploitation the heads in both aquifers and aquitards continued to drop since the 1960 s zhang et al 2009 because the vertical hydraulic conductivity is low in aquitards the head in aquifers should be below that in aquitards i e the preconsolidation head jiang et al 2018 therefore if the head continues to drop and subsidence continues during the study period the head should be below the preconsolidation head a total of 8 wells are identified squares in fig 3 and used to calculate the inelastic skeletal storativity the elastic deformation can be estimated by s ke and the head change we can obtain the inelastic deformation by subtracting the elastic deformation from the total deformation then s kv and τ 0 can be inverted using equation 3 with the estimated inelastic deformation and head measurements since equation 3 is nonlinear we implement the inversion as a search for parameter space followed by a linear inversion to estimate the optimal solution we set the step length as 1 day and the search range as 50 years for τ 0 for each search s kv is estimated using a least squares inversion the result with the minimum root mean square error is regarded as the optimal solution for the inversion the inelastic skeletal storativity and time constant range from 3 32 10 3 to 3 19 10 2 and 1 02 to 12 75 years respectively at these 8 well locations table 1 well dg3 is located in the overlapping region of track 218 and track 447 the values of s kv at well dg3 in track 218 and track 447 are 9 62 1 08 10 3 and 9 59 0 92 10 3 respectively which shows good consistency s ke at wells hh1 and hh2 used to estimate the elastic deformation are the interpolation results since the s ke at these two wells are not estimated due to the negligible seasonal changes in hydraulic head until 2013 a maximum cumulative subsidence of 2 676 m and a maximum head drop of 91 8 m occurred in the municipal district of cangzhou hebei provincial department of land and resources 2013 the head in the municipal district was above the preconsolidation head and was relatively static during 2008 2013 jiang et al 2018 thus we roughly estimate s k using equation 1 with the cumulative subsidence and head drop indicated by triangles in fig 3 then we obtain s kv by subtracting the mean s ke in the municipal district s kv in the municipal district is 2 78 10 2 which agrees well with the result derived from insar deformation 4 3 the influence of long term overexploitation on deep groundwater resources skeletal storativity is theoretically effective stress dependent rudolph and frind 1991 the laboratory consolidation tests on sediment cores of aquifer layer iii in cangzhou suggest that the compressibility of the sediment and consequent skeletal storativity decrease greatly along with the rapid rising effective stress due to the head drops guo et al 2014 therefore if we use the constant skeletal storativity to estimate the tgws depletion and remaining exploitable gws the former will be underestimated and the latter will be overestimated liu et al 2019 investigated the relation between s k and head decline in cangzhou using a one dimensional nonlinear subsidence model see fig s6 in the supplementary material based on this relation we know that the average drop in head of 62 m across cangzhou results in a 51 decrease in the original skeletal storativity since a constant s k will lead to large estimation errors we use the effective stress dependent s k to estimate the total exploitable gws and gws depletion in this study the effective stress dependent s k can be obtained via jointly analyzing the estimated s k using insar deformation and the relation between s k and head drop derived by liu et al 2019 because the results of s kv are relatively sparse we jointly use s kv estimated using insar deformation and s kv estimated using the cumulative subsidence in the municipal district to calculate the exploitable gws and gws depletion since the head data are not available in renqiu city and suning county the exploitable gws and gws depletion are not calculated in these two regions 4 3 1 the total exploitable gws in the confined aquifer system the upper aquifer layers are saline brackish in cangzhou the freshwater aquifers in aquifer layer iii are thicker than those in other aquifer layers with coarser sediments higher hydraulic conductivity and better water yield therefore the groundwater is mainly pumped from aquifer layer iii zhang et al 2009 at the beginning of large scale pumping in the 1960s the head was close to the earth s surface in the west and was above the surface in the east hebei bureau of geology and mineral resources exploration 1977 we assume that the mean original head is equal to the elevation of the surface causing the depth of the original head h in equation 4 to be zero thus we use the depth of the roof of aquifer layer iii derived from zhang et al 2009 to estimate the total exploitable gws according to equation 4 the total exploitable gws in cangzhou excluding renqiu city and suning county is 26 1 21 3 km3 the distribution of the total exploitable gws fig 4 indicates that the exploitable gws varies spatially throughout cangzhou the large skeletal storativity and depth of aquifer layer iii result in the highly exploitable gws in qing county which can reach up to 5 m in ewt in contrast the exploitable gws is typically less than 1 5 m in ewt in the eastern coastal areas due to the small inelastic skeletal storativity 4 3 2 the gws depletion during 1960 2010 since the depth of the original head is zero in cangzhou the total head change is equal to the depth to water level therefore we use the depth of head in 2010 and estimate s ke to calculate the rgws depletion across cangzhou according to equation 5 until 2010 the rgws depletion in cangzhou excluding renqiu city and suning county was 1 64 0 82 km3 fig 5 shows the distribution of rgws depletion across cangzhou the rgws depletion mainly occurs in uplift zone g and the eastern part of cangzhou due to the large s ke and hydraulic head drops theoretically the rgws depletion due to elastic compaction should be recovered when the head returns to its original level however in the eastern area adjacent to bohai bay the lateral recharge from the western piedmont plain is negligible since cangzhou is surrounded by several deep groundwater depression cones zhu et al 2014 additionally because both overlying aquifer layer i and aquifer layer ii are saline or brackish aquifers gray dashed lines in fig 5 the leakage recharge from the overlying aquifers will lead to saline intrusion therefore the actual recoverable gws depletion is less than the estimated value to estimate the igws depletion the change in the preconsolidation head is needed the preconsolidation head is the lowest head ever experienced in aquitards in the past jiang et al 2018 leake 1990 and cannot be directly measured the preconsolidation head is usually determined by the responses of the confined aquifer systems to head changes we assume that the original preconsolidation head is the head before large scale pumping which is equal to the surface elevation since there are no historical deformation data in cangzhou we will use the deformation derived from insar and hydraulic head observations during 2003 and 2010 to determine the preconsolidation head in 2010 as mentioned in section 5 2 the observed head should be below the preconsolidation head before 2005 the 64 observation wells can be divided into 5 kinds depending on the responses of the confined aquifer systems to head changes during 2005 and 2010 1 if the head drops and subsidence continues fig 6 a the head should be below the preconsolidation head we determine the highest head during the period of time constant before 2010 to be the preconsolidation head 2 if the head is relatively static with obvious oscillations but subsidence still continues at a reduced rate fig 6b there are two cases that may lead to this phenomenon a the head was always below the preconsolidation head during 2005 2010 in this case we assume that the highest head is the upper estimation of the preconsolidation head h pre u in fig 6b b the high head in each year downward arrows in fig 6b is above the preconsolidation head but the low head in each year upward arrows in fig 6b is below the preconsolidation head in this case the highest value of low heads is determined as the lower estimation of the preconsolidation head h pre l in fig 6b 3 if the head rises and subsidence continues with a reduced rate fig 6c this suggests that the head is still lower than the preconsolidation head we assume that the highest head is the preconsolidation head 4 if the head rises the subsidence rate is reduced to zero fig 6d the preconsolidation head is determined to be the head corresponding to the time when the subsidence stops 5 if the head rises and uplift occurs fig 6e this suggests that the head is above the preconsolidation head we determine the lowest head to be the preconsolidation head these estimated preconsolidation heads might have relatively large uncertainties but can still be used to approximately characterize the distribution of the actual preconsolidation head since the head changes from declining to rising during the study period and the period of head rise 2005 2010 6 years is approximately equal to the mean time constant 6 2 years fig 7 a illustrates the igws depletion in cangzhou excluding renqiu city and suning county estimated using equation 6 the cumulative igws depletion until 2010 was 11 4 8 0 km3 12 0 8 5 km3 the municipal district and qing county experienced the most serious igws depletion which can reach up to 2 7 m in ewt in contrast the igws depletion is typically less than 0 8 m in the eastern coastal areas the tgws depletion is 13 0 8 1 km3 13 6 8 5 km3 accounting for 49 8 52 2 of the total exploitable gws as shown in fig 7b the spatial distribution pattern of tgws depletion is similar to that of the igws depletion the percentage of tgws depletion in the total exploitable gws is typically larger than 40 in most parts of the study area except the southeast and southwest areas and can reach up to 77 in the municipal district fig 7c the high percentage suggests that long term overexploitation has threatened groundwater strategic reserve security and emergency water supply capacity the more serious problem is that the igws depletion accounts for 87 4 87 9 of tgws depletion suggesting that most tgws depletion is irreversible and will lead to permanent loss of groundwater storage capacity subtracting the tgws depletion from the total exploitable gws we can obtain the remaining exploitable gws ranging from 12 5 22 8 km3 to 13 1 22 9 km3 fig 7d 5 conclusions in this study we present a new method to estimate the elastic and inelastic skeletal storativity through the combination of insar deformation and head observations furthermore using the effective stress dependent skeletal storativity head measurements and hydrogeological data we quantify the total exploitable gws the tgws depletion and the remaining exploitable gws in cangzhou during 1960 2010 our results suggest that the tgws depletion and remaining exploitable gws in cangzhou are 13 0 8 1 km3 13 6 8 5 km3 and 12 5 22 8 km3 to 13 1 22 9 km3 respectively which account for 49 8 52 2 and 47 8 50 2 of the total exploitable gws respectively the high percentage of tgws depletion in the total exploitable gws which can reach up to 77 in the municipal district of cangzhou suggests that the long term overexploitation has threatened the groundwater strategic reserve security and the emergency water supply capacity the igws depletion accounts for 87 4 87 9 of tgws depletion inferring that most of the gws depletion is irreversible and leads to permanent loss of groundwater storage capacity in the confined aquifer system this presented method enables us to estimate the tgws depletion the permanent loss of groundwater storage capacity due to long term overexploitation and the remaining exploitable gws these results regarding the sustainability of deep groundwater resources can offer regulators crucial information for making plans for deep groundwater pumping and surface water allocation therefore insar is testified to be an effective tool for assessing the physical state and sustainable development potential of a confined aquifer system credit authorship contribution statement lin bai conceptualization methodology visualization writing original draft liming jiang conceptualization writing review editing funding acquisition yong zhao resources investigation zhenhong li supervision writing review editing guoliang cao data curation chaoying zhao writing review editing rong liu formal analysis visualization hansheng wang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was supported by the national key research and development program of china grant no 2019yfc1509201 the national natural science foundation of china 42004005 41621091 41874005 41974009 the natural science basic research program of shaanxi program no 2020jq 357 the fundamental research funds for the central universities chd ref 300102260104 300102260301 and 300102261404 and the open research fund of state key laboratory of geodesy and earth s dynamics cas sklged2019 2 1 e we want to thank esa for providing the envisat asar data projects dragon 4 32388 and 32244 dragon 5 59339 and data service request 37777 and sentinel 1 data hooper at the university of leeds for providing the stamps software tu delft for providing the doris software and the ssa mtm group at ucla for providing the ssa mtm toolkit additiionally we thank ph d zhou meiling at chang an university for providing the extent of the urban area in cangzhou 
3754,stochastic simulations of streamflow sequences are essential for water resource planning and management in this study a new gaussian mixture model gmm based method is proposed to generate long term synthetic streamflow sequences of any time scale first the gmm model which is established based on the k means algorithm expectation maximization algorithm and akaike s information criteria is employed to describe the temporal dependences of the observed streamflow data second the accuracy and reliability of the constructed gmm are verified by the kolmogorov smirnov test of goodness of fit then daily 10 day and monthly streamflow sequences at a single site were generated using the proposed streamflow simulation method finally the performance of the proposed method was verified based on the absolute and relative performance indexes yichang gauging stations on the upper yangtze river were selected as case studies and two copula methods were selected as the contrast methods to evaluate the proposed method the results demonstrate that the proposed method can effectively capture the statistical properties of observed streamflow data at low middle and high time scales and can comprehensively preserve the lower and higher order statistics as well as the linear and nonlinear correlations of observed streamflow data the proposed method is an effective method for stochastic streamflow simulations keywords stochastic streamflow simulation gaussian mixture model k means clustering single site streamflow streamflow series at multiple time scales 1 introduction in water resource planning and management observed streamflow sequences are indispensable medda and bhar 2019 however because of limitations in observation conditions and technology the length of observed streamflow sequences is limited and is not sufficient to effectively support decision making in water resources management medda and bhar 2019 therefore long term synthetic streamflow series that are statistically similar to observed streamflow records are typically needed in actual water resource management chen et al 2019 2015 hao and singh 2012 2011 synthetic streamflow series are very useful for the design of reservoirs srinivas and srinivasan 2005 derivation of optimal reservoir operating rules jia et al 2019 zhou et al 2019 risk assessment of reservoir flood control policies huang et al 2018b wang et al 2021 2019 reliability assessments of water resource system operations sharma and o neill 2002 and analysis of multi reservoir operation policies kumar et al 2000 overall they may help prepare for events too much or too little water that have not yet been observed in the past but can be expected in the future szilagyi et al 2006 synthetic streamflow sequences can be generated using stochastic streamflow simulation methods the key requirement for streamflow simulation is that the synthetic streamflow sequences should maximum preserve the key statistical properties of the observed streamflow series hao and singh 2011 these properties include the mean standard deviation skewness coefficient kurtosis coefficient and lag correlations numerous streamflow simulation methods have been developed several commonly used models include autoregressive ar kendall and dracup 1991 autoregressive moving average arma boukharouba 2013 vogel and stedinger 1988 autoregressive integrated moving average arima montanari et al 1997 periodic autoregressive moving average parma rasmussen et al 1996 and other variants of arma these models are flexible and can be used for annual and seasonal streamflow simulations however they are based on gaussian and linearity assumptions and these assumptions are not typically satisfied by the observed streamflow series hao and singh 2011 the streamflow records are almost nonlinear non stationary and non normal zhao et al 2017 therefore transformation techniques that render the data normal are typically applied in the above models thereby leading to the statistical properties of observed streamflow data that cannot be effectively captured hao and singh 2011 additionally these classic linear models likely can reproduce the skewness characteristics by combining them with non gaussian white noise however there may be a tendency to construct unrealistic dependence structures tsoukalas et al 2018 a few disaggregation methods have also been proposed to generate synthetic streamflow series stedinger et al 1985 stedinger and vogel 1984 valencia and schaake 1973 for a time disaggregation model annual streamflow is generated using an appropriate model and then the generated annual streamflow is disaggregated into monthly daily or seasonal flows hao and singh 2011 the disaggregation model ensures the reproduction of key statistical characteristics at a specific time scale of interest and the sum of low time scale streamflow values e g monthly equal to high time scale streamflow values e g yearly hao and singh 2011 however the disaggregation model has many parameters that need to be estimated hao and singh 2011 other challenges include difficulties in the effective estimation of parameters inaccuracies in preserving higher order statistical properties and nonlinear dependence structures and computational inefficiency koutsoyiannis 2016 wang et al 2021 consequently some nonparametric methods such as the moving block bootstrapping method srinivas and srinivasan 2005 and the k nearest neighbor resampling method prairie et al 2007 have been proposed for stochastic streamflow simulations these nonparametric models are driven by sample data are typically based on bootstrap techniques and kernel density estimation and do not require any data transformation or assumptions about probability distribution hao and singh 2011 lall and sharma 1996 wang et al 2021 they can partly represent the nonlinear or non gaussian characteristics of the observed streamflow series lall and sharma 1996 however nonparametric methods generate streamflow values only within the range of observed streamflow data rendering it difficult to simulate extreme situations that can be expected in the future but different from the historical records salas and lee 2010 a more attractive method termed the copula method was recently developed for stochastic streamflow simulation the copula method has been extensively applied for stochastic simulation of hydrological data because of its flexibility in selecting marginal distributions representing the dependence structure extending to multivariate analysis and permitting separate analysis of marginal distributions and dependence structures chen et al 2019 2015 in addition the copula method does not require the observed streamflow series to meet the conditions of linearity or normal probability distribution therefore it does not have to deal with the normalizing transformation of streamflow data chen et al 2015 lee and salas 2011 used the copula method for a stochastic annual streamflow simulation hao and singh 2012 proposed an entropy copula method for a single site monthly streamflow simulation chen et al 2015 proposed a copula based method to generate long term multisite monthly streamflow sequences wang et al 2018 proposed hierarchical network copula conditional models for stochastic monthly streamflow simulations these copula methods are primarily used for annual or monthly streamflow simulation and only consider the dependence between the streamflow of time t and t 1 to overcome these limitations chen et al 2019 proposed a copula based method for stochastic single site daily streamflow simulation considering lag 2 autocorrelation in this method a trivariate copula was established to describe temporal dependencies among streamflow at time t t 1 and t 2 a pearson type iii distribution was employed to fit the marginal distribution of streamflow for each day compared with the arma disaggregation and moving block bootstrapping methods the copula method proposed by chen et al 2019 is superior for stochastic daily streamflow simulation owing to its simplified model structure efficient parameter estimation good nonlinear characterization capability and absence of linearity and gaussian assumptions however the copula method has two shortcomings 1 the marginal probability distribution of the streamflow for each day or month needs to be assumed and constructed the real marginal distribution is typically unknown hao and singh 2011 2 the model parameters are too few to more effectively describe the high order statistical characteristics of streamflow series fewer parameters are not necessarily advantageous which motivates the work presented in this paper the gaussian mixture model gmm consists of several basic multivariate gaussian distributions liu et al 2019 unlike the copula model it does not require any assumption regarding the marginal distribution of streamflow data in modeling the dependence structure of streamflow series in addition compared with a single probability model such as the p iii probability and copula model any continuous probability density can be approximated by the gmm model with arbitrary accuracy liu et al 2019 2018 thus gmm can deal well with the modeling of nonlinear and non gaussian streamflow series and has a high ability to describe multimodal and skewed distributions in recent years the gmm model has attracted increasing interest from hydrological researchers and has been widely used for streamflow forecasting and forecasting error simulation such as the research works of ji et al 2019 liu et al 2018 liu et al 2019 and zhang et al 2021 however to the authors knowledge it has not been applied to the stochastic simulation of hydrologic streamflow data therefore motivated by the shortcomings of existing streamflow simulation methods and inspired by the research on streamflow forecasting based on gmm a new stochastic streamflow simulation method based on gmm is explored in this study in this study a more effective stochastic streamflow simulation method based on a gmm is proposed long term daily ten day and monthly observed streamflow sequences from the yichang gauging station in the yangtze river were selected as case studies to prove the superiority of the proposed method the results show that the proposed method is significantly superior to the contrast methods in preserving the high order statistical characteristics and lag 1 linear autocorrelation of the observed streamflow series the remainder of this paper is organized as follows in section 2 the gmm parameter optimization for gmm and the entire process of the proposed streamflow simulation method are introduced in detail in section 3 the goodness of fit test and performance evaluation methods are described in section 4 the application of the proposed method and contrast methods to generate daily ten day and monthly streamflow is presented in section 5 the results and discussion are presented finally section 6 presents the conclusions of the study 2 methodology 2 1 gaussian mixture model the two dimensional joint probability density function pdf between the streamflow of the t 1 time period and the streamflow of the t time period was assumed to be a gmm the mathematical formula of the gmm probabilistic model is as follows bishop 2006 1 p x θ k 1 k π k n x μ k k n x μ k k 1 2 π k 1 2 exp x μ k t k 1 x μ k 2 k 1 k π k 1 0 π k 1 where p x θ is the density value of the two dimensional joint distribution x q t 1 q t t is a two dimensional vector composed of the streamflow q t 1 of the t 1 th time period and the streamflow q t of the t th time period in a certain year n x μ k σ k is the density function of the two dimensional joint normal distribution with the vector x as input which is the k th component of the gmm θ π μ σ is the parameter set to be optimized for the gmm and π π 1 π 2 π k μ μ 1 μ 2 μ k σ σ 1 σ 2 σ k π k is the proportion of the k th component also called mixing coefficients μ k is the mean vector of the k th component σ k is the covariance matrix of the k th component and k is the number of components of the gmm which is a hyperparameter to be optimized in fact x can be a vector of any dimension but this paper only constructed two dimensional gmms so the two dimensional gmm was described in detail 2 2 optimization of parameters for the gmm according to equation 1 the parameters of the gmm include two parts model parameters θ π μ σ and hyperparameter k the parameters of the gmm can be optimized through the following steps 1 based on a predefined hyperparameter k the model parameters θ are initialized by the k means clustering algorithm 2 based on the initialization value of the model parameters the model parameters θ are further optimized using the expectation maximization em algorithm dempster et al 1977 3 a new hyperparameter k value is set and steps 1 and 2 are repeated until all possible k values are traversed 4 according to the akaike s information criteria aic acquah 2010 determine the optimal hyperparameter k and simultaneously obtain the corresponding optimal model parameters θ the detailed description of parameters optimization for the gmm is provided in the supplementary material text s1 2 3 stochastic streamflow simulation method based on the gmm based on the gmm a more effective stochastic streamflow simulation method gmm ssm is proposed in this study first according to the product rule of the joint gaussian distribution the gmm model of x q t 1 q t t which is shown in equation 1 can be written as follows 2 p x 1 x 2 k 1 k π k n x μ k σ k k 1 k π k n x 1 μ k 1 σ k 11 n x 2 μ k 2 1 σ k 2 1 where x 1 and x 2 is the first and second element of the vector x respectively μ k 2 1 and σ k 2 1 are the conditional mean and conditional covariance of x 2 given x 1 respectively μ k 2 1 and σ k 2 1 can be calculated using equations 3 and 4 3 μ k 2 1 μ k 2 σ k 21 σ k 11 1 x 1 μ k 1 4 σ k 2 1 σ k 22 σ k 21 σ k 11 1 σ k 12 where σ k 21 is the element of the first column of the second row of the covariance matrix σ k μ k 1 is the first element of the mean vector μ k similarly other variables can be understood second according to the rule of total probability the marginal pdfs of x 1 and x 2 can be obtained as shown in equations 5 and 6 5 p x 1 p x 1 x 2 d x 2 k 1 k π k n x 1 μ k 1 σ k 11 6 p x 2 p x 1 x 2 d x 1 k 1 k π k n x 2 μ k 2 σ k 22 then according to the conditional probability formula the conditional pdf and conditional cumulative distribution function cdf of x 2 given x 1 can be derived as shown in equations 7 and 8 7 p x 2 x 1 p x 1 x 2 p x 1 k 1 k π k n x 1 μ k 1 σ k 11 n x 2 μ k 2 1 σ k 2 1 k 1 k π k n x 1 μ k 1 σ k 11 8 f x 2 x 1 x 2 p x 2 x 1 d x 2 finally the main steps of the proposed stochastic streamflow simulation method are described as follows 1 based on the sample data set gmms are constructed between the streamflow of the t 1 time period and the streamflow of the t time period and the conditional cdfs f x 2 x 1 of x 2 are derived given x 1 when the length of time period is one day the number of the gmm and f x 2 x 1 equals 365 n 365 when the length of the time period is ten days n equals 36 and when the length of the time period is one month n equals 12 2 in the first year of the stochastic streamflow simulation first make the simulated streamflow q 0 1 equal to 1 m i 1 m q n i where m is the number of years of sample data q n i is the observed streamflow of the n th time period in the i th year generate a uniform random number ε and assign it to the conditional cdf that is f q t 1 q t 1 1 ε t 1 then obtain the simulated streamflow q t 1 f 1 ε q t 1 1 t 1 of the t th time period of the first year the above processes are repeated until t equals n 3 in the i th year of the stochastic streamflow simulation first generate a uniform random number ε and assign it to the conditional cdf that is f q t i q t 1 i ε i 2 t 1 then calculate the simulated streamflow q t i f 1 ε q t 1 i i 2 t 1 of the t th time period of the i th year it is worth emphasizing that q 0 i equals q n i 1 the above processes are repeated until t equals n 4 let i i 1 repeat step 3 until i equals m and finally complete the stochastic streamflow simulation of m years where m is the number of years of the synthetic streamflow sequences 3 goodness of fit test and performance evaluation the accuracy and reliability of the constructed stochastic streamflow simulation models were verified using the one sample kolmogorov smirnov ks goodness of fit test massey 1951 the effectiveness and superiority of the proposed stochastic streamflow simulation method were demonstrated based on the performance evaluation indexes including the mean square error rmse mean absolute error mae mean absolute percentage error mape and coefficient of determination r2 3 1 goodness of fit test of the stochastic streamflow simulation models the accuracy of the constructed models was verified using the one sample ks test for goodness of fit of the constructed model the one sample ks test is a nonparametric test of the null hypothesis that the population cdf of the observed sample data is equal to the hypothesized cdf the test statistic of the one sample ks test is the maximum absolute difference between the empirical cdf and the hypothesized cdf of the observed sample data as follows 9 d t one max q t i e t q t i h t q t i t 1 2 n i 1 2 m 10 d t 1 t two max q t 1 i q t i e t 1 t q t 1 i q t i h t 1 t q t 1 i q t i t 1 2 n i 1 2 m where d t one is the maximum absolute difference between the empirical marginal cdf and the hypothesized marginal cdf d t 1 t two is the maximum absolute difference between the empirical joint cdf and the hypothesized joint cdf q t i is the observed streamflow of the t time period in the i th year e t and h t are the empirical and hypothesized marginal cdfs for the streamflow of the t th time period respectively e t 1 t and h t 1 t are the empirical and hypothesized joint cdf between the streamflow of the t 1 th time period and the streamflow of the t th time period the calculation formulas for the empirical marginal cdf and empirical joint cdf can be found in gringorten 1963 and huang et al 2018a notably e 0 1 q 0 i q 1 i represents the empirical joint cdf between the streamflow of the n th time period and the streamflow of the 1 th time period that is e 0 1 q 0 i q 1 i e 0 1 q n i 1 q 1 i based on this d 0 1 two and h 0 1 q 0 i q 1 i can be understood additionally n is the number of time periods per year when the length of the time period is one day n equals 365 when the length of the time period is ten days n equals 36 and when the length of the time period is one month n equals to 12 by querying the critical value table massey 1951 of the test statistic of the one sample ks test the critical values d α m and p values p m corresponding to different levels of significance α and sample numbers m are obtained when d t one or d t 1 t two is greater than d α m the null hypothesis is rejected otherwise it is accepted additionally a decision to accept the null hypothesis can be based on the p value when p m is greater than α the null hypothesis is accepted otherwise it is rejected small values of p m cast doubt on the validity of the null hypothesis in contrast the higher p m is the more strongly the null hypothesis is accepted 3 2 basic statistics of streamflow series the effectiveness and superiority of the proposed method were demonstrated by comparing the approximation degree of the basic statistics of the simulated streamflow series generated by different stochastic streamflow simulation methods and the basic statistics of the observed streamflow series seven basic statistics were used the mean μ t standard deviation s d t skewness coefficient c s t and kurtosis coefficient c k t of the streamflow series in the t th time period of all years the pearson correlation coefficient r p t 1 t kendall correlation coefficient r k t 1 t and spearman correlation coefficient r s t 1 t between the streamflow series in the t 1 th time period and the streamflow series in the t th time period the definitions of these basic statistics of the streamflow series are provided in the supplementary material text s2 3 3 performance evaluation indexes of the stochastic streamflow simulation methods the commonly used rmse mae mape and coefficient of determination r2 were selected as evaluation indices to evaluate the performance of the proposed stochastic streamflow simulation method without loss of generality referring to the research work of he et al 2019 the definitions of these performance evaluation indexes are as follows 11 rmse 1 n t 1 n s t s t 12 mae 1 n t 1 n s t s t 13 mape 1 n t 1 n s t s t s t 100 14 r 2 1 t 1 n s t s t 2 t 1 n s t s 2 where n represents the number of time periods per year s t and s t denote the basic statistics of the observed and simulated streamflow series respectively and s is the mean value of s t furthermore p rmse p mae p mape and p r 2 are introduced to describe the improvement degree of the proposed method compared with the contrast methods p rmse 0 p mae 0 p mape 0 and p r 2 0 indicate that the proposed method is better than the contrast method the closer p rmse p mae p mape and p r 2 are to 0 the smaller the performance difference between the proposed method and the contrast method referring to the research of he et al 2019 the definition of these indexes can be given as 15 p rmse rms e 2 r m s e 1 rms e 2 100 16 p mae ma e 2 m a e 1 ma e 2 100 17 p mape map e 2 m a p e 1 map e 2 100 18 p r 2 r 1 2 r 2 2 r 2 2 100 r 2 2 0 r 1 2 r 2 2 r 2 2 100 r 2 2 0 where the subscript 1 indicates the performance index of the proposed method and subscript 2 denotes the performance index of the contrast methods 4 case study 4 1 study area and data used to prove the superiority of the proposed method the yichang hydrological gauging station was selected as the case study in this study yichang station is located approximately 40 km downstream of the three gorges project fig 1 it is one of the most important hydrological gauging stations in the yangtze river basin its area is controlled by approximately 1 0 million km2 accounting for approximately 58 of the area of the yangtze river basin in this case study 136 year daily streamflow records 1882 2017 from the yichang gauging station were used because the three gorges reservoir has been regulating and storing streamflow from the upper reaches since 2003 the streamflow records of 2003 2017 were restored to ensure the consistency of the statistical characteristics of the streamflow series in addition the ten day average streamflow series and monthly average streamflow series were also used the calculation formula for the average streamflow series at a certain time scale is as follows 19 q δ i t 1 n δ i t j 1 n δ i t q d i t j where q δ i t is the streamflow value of the t th time period of the i th year of the streamflow series of a certain time scale n δ i t is the number of days in the t th time period of the i th year and q d i t j is the average streamflow of the j th day of the t th time period in the i th year 4 2 model development 4 2 1 development of the gmm for the daily streamflow series 365 gmms were constructed and the corresponding conditional cdfs were derived using the methodology described in section 2 for the ten day streamflow series 36 gmms were constructed and the corresponding conditional cdfs were derived for the monthly streamflow series 12 gmms were constructed and the corresponding conditional cdfs were derived the model parameters θ of all gmms were optimized using the em and the k means algorithms there is no specific display for the optimized model parameters owing to space limitations the hyperparameters k of all gmms were selected based on the aic information criteria fig 2 in fig 2a the values in the first row and the first column represent the k value of the gmm between the streamflow on the 365th day and the streamflow on the first day and the values in other positions represent the k value of the gmm between the streamflow on the previous day and the streamflow on the next day fig 2b and c present data in a similar fashion 4 2 2 two dimensional copula and three dimensional copula models development in this study to demonstrate the effectiveness and superiority of the proposed method the two dimensional copula based stochastic streamflow simulation method or the bivariate copula method twc ssm and three dimensional copula based stochastic streamflow simulation method or the trivariate copula method thc ssm were used as competitive methods for stochastic streamflow simulation similar to the work of constructing gmm for the daily ten day and monthly streamflow series 365 36 and 12 two dimensional copula models were constructed respectively in the same way the work of building three dimensional copula models can be understood the two dimensional copula model represents the joint probability distribution of the streamflow of the t 1 th time period and the streamflow of the t th time period the three dimensional copula model represents the joint probability distribution of the streamflow of the t 2 th time period the streamflow of the t 1 th time period and the streamflow of the t time period in contrast to the construction process of the gmm the construction process of the copula model includes two steps construction marginal distribution and determination of the dependence structure in this study by referring to the research work of chen et al 2019 2015 pearson type iii p iii distribution was selected as the marginal distribution of the streamflow in the t th time period and the gumbel copula was selected as the two dimensional or three dimensional joint distribution of the streamflow time series the thc ssm method proposed by chen et al 2019 is a relatively new stochastic streamflow simulation method the details of building the two dimensional and three dimensional copula model and the procedure for carrying out stochastic streamflow simulation using twc ssm and thc smm methods are detailed by chen et al 2019 and will not be repeated here 5 results and discussion the proposed method and the contrast methods were applied to stochastic streamflow simulation at the yichang station the results are presented in three parts the first is the accuracy and reliability of the gmm probability model which was first verified by the one sample ks goodness of fit test in the second part the effectiveness and superiority of the proposed stochastic streamflow simulation method were demonstrated by comparing the proposed method with the contrast methods thirdly the implications for further improvement of the stochastic streamflow simulation method are discussed based on the application results of different methods 5 1 goodness of fit test results of the probability models the one sample ks test of goodness of fit of the constructed gmm models and the constructed two dimensional copula models to the empirical joint distribution of the daily streamflow series were performed using the methodology described in section 3 1 fig 3 the ks test results of the goodness of fit of the gmm model and the p iii probability model to the empirical marginal distribution of the daily streamflow series are shown in fig 4 similarly for the ten day streamflow series and monthly streamflow series the ks test results of the goodness of fit of the gmm are presented in figs 5 and 6 respectively notably because the three dimensional copula is constructed based on the two dimensional copula and conditional copula the goodness of fit of the three dimensional copula to the empirical joint distribution of the streamflow series is the same as that of the two dimensional copula this is also why only the goodness of fit test results of the gmm model and two dimensional copula model are given in figs 3 5a b fig 6a and b in addition to describe the marginal distribution of streamflow series by gmm see equations 5 and 6 as shown in fig 3 under different levels of significance α and different days the p value of the goodness of fit test of gmm is much larger than α fig 3a and the test statistic is also much smaller than the critical test statistic fig 3b therefore the null hypothesis of the gmm is accepted that is the gmm can accurately describe the population joint distribution of the daily streamflow series however for the copula model only when the level of significance is 0 01 the null hypothesis that it can accurately describe the population joint distribution of the daily streamflow series is accepted thus compared with the copula model the gmm can more accurately describe the joint distribution characteristics of daily streamflow series and its reliability is significantly higher additionally according to fig 4 a similar conclusion can be obtained that is compared with the p iii probability model the marginal distribution characteristics of the daily streamflow series can be more accurately described by the gmm model this further demonstrates the reliability of the gmm model as shown in fig 5a and b under different levels of significance and different time periods the p values are very large and the test statistics are very small therefore the null hypothesis that the constructed 36 gmms are equal to the population joint distributions of the observed ten day streamflow series is tenable similarly fig 5c and d indicate that the gmm can accurately describe the marginal distributions of the ten day streamflow series on the contrary with an increase in the level of significance the null hypothesis that the constructed 36 copula models are able to accurately simulate the joint distribution characteristics of the ten day streamflow series will be rejected as shown in fig 5a and b this shows that to a certain extent the copula model is feasible to use to describe the statistical characteristics of the ten day streamflow series but its credibility is lower than that of the gmm similarly in describing the marginal distributions of the ten day streamflow series the accuracy and reliability of the p iii probability model are lower than the gmm overall as shown in fig 5c and d figure 6 shows the ks test results of the goodness of fit of the constructed 12 gmms to the empirical joint distributions and empirical marginal distributions as shown by the red dotted lines in fig 6a and b the p value of goodness of fit of gmm is above all levels of significance and the test statistic is below all critical test statistics therefore the gmm can reliably describe the joint probability distributions of monthly streamflow series similarly fig 6c and d show that the marginal probability distributions of the monthly streamflow series can be accurately described by the gmm in addition it is obvious from fig 6a and b that the copula model can also effectively reflect the statistical characteristics of the monthly streamflow series but compared with gmm its accuracy and reliability are obviously lower fig 6c and d support a similar conclusion that the p iii probability model is reliable in describing the marginal probability distributions of the monthly streamflow series but not as good as the gmm model according to figs 3 6 and the above analysis compared with the copula model and p iii probability model gmm can more accurately and reliably describe the joint probability distribution and marginal probability distribution of the daily streamflow series ten day streamflow series and monthly streamflow series therefore the proposed stochastic streamflow simulation method is more effective than existing methods the next section further analyzes and demonstrates the effectiveness of the proposed method 5 2 performance evaluation results of the stochastic streamflow simulation methods the gmm ssm twc ssm and thc ssm methods were used to generate daily streamflow series ten day streamflow series and monthly streamflow series with a length of 2000 years if necessary a longer runoff series can be generated but 2000 years should be enough the basic statistics of these three simulated streamflow series generated by each method were calculated according to equations a1 a7 in the supplementary material text s2 as shown in figs 7 8 and 9 figure 7 shows seven statistics for the three simulated daily streamflow series and the observed daily streamflow series it can be seen that the simulated mean fig 7a sd fig 7b rk fig 7f and rs fig 7g obtained by the three methods are all relatively close to the corresponding statistics of the observed daily streamflow series to a certain extent this shows that the three methods can effectively preserve the statistical characteristics of the mean sd rk and rs exhibited by the observed daily streamflow series furthermore it can be seen from fig 7c d and e that the cs ck and rp values generated by gmm ssm are much closer to the corresponding statistics of the observed daily streamflow series than those generated by the twc ssm and thc ssm methods the above analysis preliminarily demonstrates the superiority and effectiveness of the proposed gmm ssm method the performance indexes of each method were calculated according to equations 11 to 14 as shown in table 1 to further quantitatively compare and analyze the performance of the three methods in preserving the statistical characteristics of the daily streamflow series the degree of improvement of the proposed method compared with the contrast methods was also calculated according to equations 15 to 18 as shown in fig 10 it can be seen from the four performance indexes shown in table 1 that the proposed gmm ssm method can most effectively simulate the sd cs ck rp and rs statistics of the observed daily streamflow series moreover compared with the other two methods the gmm ssm method has significant advantages in preserving cs ck and rp statistics which is intuitively shown in the blue and red bars above the 0 value line in fig 10 however the gmm ssm is slightly inferior to other methods in preserving the statistical mean and rk as shown in the bars below the 0 value line in fig 10a b and c however the mapes of the mean and rk of the proposed method are very small within 0 8 and the determination coefficients r2 are also large above 0 95 as shown in table 1 the above analysis shows that the comprehensive performance of the proposed gmm ssm method is better than the contrast methods and it can more effectively generate a simulated daily streamflow series with the statistical characteristics of the observed daily streamflow series which is intuitively shown in fig 10d figure 8 shows seven statistics of three simulated ten day streamflow series and the observed ten day streamflow series table 2 presents the performance indexes of different stochastic streamflow simulation methods for preserving the statistical characteristics of the observed ten day streamflow series fig 11 presents the degree of improvement of the proposed gmm ssm method compared to the contrast methods in fig 11 when the bar is above the 0 value line the performance of the proposed method is better the results plotted in fig 8 present a conclusion similar to that shown in fig 7 additionally rmse mae and r2 of rk are slightly worse than those of the contrast methods other performance indexes of the proposed method are better than those of the contrast methods table 2 this provides compelling evidence that the proposed method can describe the statistical characteristics of the ten day streamflow series more accurately and can more effectively generate simulated streamflow series reflecting the statistical characteristics of the observed ten day streamflow series the data displayed in fig 11 corroborate this conclusion figure 9 shows seven statistics of three simulated monthly streamflow series and the observed monthly streamflow series table 3 presents the performance indexes of different stochastic streamflow simulation methods in preserving the statistical characteristics of the observed monthly streamflow series fig 12 shows the improvement degree of the proposed gmm ssm method compared with the contrast methods in preserving the statistical characteristics of the monthly streamflow series by analyzing fig 9 a conclusion similar to figs 7 and 8 can be obtained in addition table 3 and fig 12 evidently present that the proposed method can preserve the statistical characteristics of the observed monthly streamflow series more comprehensively and has better comprehensive performance than the contrast methods finally based on the discussion and analysis in sections 5 1 and 5 2 the following conclusions can be drawn 1 compared with the p iii probability model the gmm model can more accurately describe the marginal distribution characteristics of the observed streamflow time series 2 compared with the copula model the gmm model can more accurately describe the joint distribution characteristics of the observed streamflow time series 3 compared with the twc ssm and thc ssm methods the proposed gmm ssm method has a better comprehensive performance in particular the proposed method is significantly superior to the contrast methods in preserving the high order statistical characteristics and lag 1 linear autocorrelation of the observed streamflow series 4 one of the reasons why the gmm and gmm ssm methods have better comprehensive performance is that the gmm model has more parameters and the parameters can be easily optimized by the em algorithm the number of parameters of gmm is 7 k 1 while the number of parameters of the copula model based on p iii marginal distribution is only four two dimensional copula or six three dimensional copula details of the copula model can be found in chen et al 2019 2015 5 3 implications for further improvement of stochastic streamflow simulation method 5 3 1 improving the method by integrating the advantages of multiple probability models the absolute performance indexes of the three methods shown in tables 1 2 and 3 indicate that all performance indexes of the proposed gmm ssm method are relatively good and this is a more effective stochastic streamflow simulation method however figs 10 11 and 12 clearly indicate that the gmm ssm method is not completely superior to the contrast methods in terms of preserving the mean value standard deviation and kendall correlation coefficient rk of the streamflow series therefore improving the proposed stochastic streamflow simulation method and further improving its performance is worth discussing the performance of the stochastic streamflow simulation method likely can be further improved by integrating the advantages of the gmm two dimensional and three dimensional copulas integrating the advantages of multiple sub models is a typical method especially in the field of runoff forecasting such as the combined model huang et al 2019 and hybrid model sun et al 2018 of runoff forecasting this has greatly enhanced our confidence in the stochastic streamflow simulation method integrating the gmm two dimensional copula and three dimensional copula intuitively we consider that the combined model based stochastic streamflow simulation method performs better than the single model based method however further experimental studies are needed to confirm this the advantages of these three models can be effectively integrated through weighted summation as shown in the following equation 20 f c q t q t 1 q t 2 ω 1 f gmm q t q t 1 ω 2 f twc q t q t 1 ω 3 f thc q t q t 1 q t 2 where fc qt qt 1 qt 2 is the combined conditional cdf fgmm qt qt 1 is the conditional cdf derived from the gmm model as shown in equation 8 ftwc qt qt 1 is the conditional cdf derived from the two dimensional copula fthc qt qt 1 qt 2 is the conditional cdf derived from the three dimensional copula and ω 1 ω 2 and ω 3 are weights whose sum is 1 using equation 20 and referring to the stochastic streamflow simulation steps at the end of section 2 3 a stochastic streamflow simulation can be carried out for equation 20 the determination of its weights is a key task it primarily involves the selection or development of an optimization algorithm the construction of an objective function and the consideration of the dynamic change in weights there has not been enough time to implement the foregoing this will be included in our future research and we hope that colleagues can publish relevant research results as soon as possible 5 3 2 improving the method by introducing machine learning models through the above research work it can be seen that gmm ssm twc ssm and thc ssm methods need to construct the joint probability distribution explicitly first and then carry out stochastic streamflow simulation on this basis in fact there is a method that does not need to explicitly rely on the joint probability distribution that is the method of coupling regression model and probability model the mathematical formulas of this type of methods are as follows 21 q t f t q t 1 q t 2 q t p ε t t 1 2 n 22 q t f q t 1 q t 2 q t p ε where qt is the streamflow of the t th time period in a certain year qt pis the streamflow in the p th time period before qt ε t and ε are independent random variables that obey a certain one dimensional distribution f and ft are regression models n is the number of time periods per year the steps of generating synthetic streamflow series by using equation 21 and 22 is similar firstly the regression value ft qt 1 qt qt p or f qt 1 qt 2 qt p is obtained according to the simulated streamflow in the previous periods secondly a sample value is randomly generated according to the probability distribution of εt or ε then the sum of the regression value and the sample value is the simulated streamflow qt finally repeat the above steps to generate long term synthetic streamflow sequences the difference between equation 21 and 22 is that equation 21 is applicable to seasonal streamflow series e g monthly ten days daily and equation 22 is applicable to weak stationary streamflow series e g annual since there is no essential difference between equation 21 and 22 equation 21 is only further analyzed and discussed below for equation 21 the key work is to determine the regression model ft and the probability distribution of εt in the existing research papers boukharouba 2013 chen et al 2019 zhou et al 2019 εt is often assumed to obey the normal distribution with zero mean for the convenience of modeling and ft is often designed as ar arma and other traditional regression models however the research of chen et al 2019 shows that the performance of stochastic streamflow simulation method based on ar model and normal hypothesis is inferior to the twc ssm and thc ssm methods the possible reasons are 1 the ar model is a linear model and is difficult to accurately describe the nonlinear characteristics of the streamflow series 2 the simulation error εt of the regression model is difficult to meet the assumptions of zero mean and normal distribution based on these two reasons some feasible improvement methods are discussed below in recent years machine learning algorithms such as lstm gru and svm have been widely used in time series prediction feng et al 2020 gao et al 2020 he et al 2019 but rarely in stochastic streamflow simulation these machine learning models have strong fitting ability and generalization ability compared with ar and its variants they can more accurately describe the nonlinear relationship between input x qt 1 qt 2 qt p and output qt therefore taking the machine learning algorithm as the regression model of equation 21 is likely to further improve the performance of stochastic streamflow simulation method but this needs to be demonstrated by further experimental studies in addition for the random variable ε t gmm also a machine learning model can be directly used to describe its probability distribution because gmm can easily fit any continuous probability distribution without relying on any assumptions and its goodness of fit performance is better which is proved in section 5 1 through the above discussion and analysis an improvement strategy that is likely to further improve the performance of the stochastic streamflow simulation method is proposed that is the regression model ft and probability model ε t in equation 21 are designed as machine learning models instead of traditional linear model and normal distribution this method combines gmm model with other machine learning models and its performance may be better than the gmm ssm proposed in this paper to the authors knowledge this idea has not generally appeared in the open literature and is worthy of further study there has not been enough time and ability to implement the foregoing this will be included in our future research and we hope that colleagues can publish relevant research results as soon as possible 6 conclusions this paper proposes a gmm based method for stochastic streamflow simulations the yichang hydrological gauging station in the upper yangtze river basin was selected as a case study to demonstrate the superiority of the proposed method specifically it includes four aspects first the gmm two dimensional copula and three dimensional copula models at different time scales were developed to describe the statistical characteristics of the observed daily ten day and monthly streamflow series second the accuracy and reliability of the constructed three models were verified by the goodness of fit test third the effectiveness and superiority of the proposed stochastic streamflow simulation method were demonstrated based on the performance evaluation indices by comparing with the contrast methods fourth the tentative idea of further improving the stochastic streamflow simulation method was proposed we conclude the following 1 the gmm can more accurately describe the marginal distribution characteristics and two dimensional joint distribution characteristics of streamflow time series compared with the p iii distribution function and copula model as shown in figs 3 to 6 2 the proposed gmm ssm method has a better comprehensive performance than the contrast methods it can effectively preserve the statistical characteristics of the observed streamflow series including daily ten day and monthly streamflow series these statistics include the mean standard deviation skewness coefficient kurtosis coefficient pearson correlation coefficient kendall correlation coefficient and spearman correlation coefficient in particular the proposed method is significantly superior to the contrast methods in preserving the skewness kurtosis and pearson correlation coefficients as shown in figs 10 11 and 12 3 the proposed method has pronounced adaptability and can be applied to stochastic streamflow simulations at various time scales therefore it has broad application prospects in this study a more effective stochastic streamflow simulation method was proposed and demonstrated however this study is only a small step forward for stochastic streamflow simulation research several aspects need to be further studied first only one hydrological gauging station was taken as a case study to test the proposed method more data from different hydrological stations should be collected to further verify the new method in further research second relevant research and further improvement of the stochastic streamflow simulation method are necessary according to the tentative idea described in section 5 3 third it should be further demonstrated whether the gmm ssm method has the ability to preserve lag n n is greater than or equal to 2 autocorrelation of streamflow series and propose the corresponding solutions fourth the gmm ssm method needs to be extended to stochastic simulation of multisite streamflow credit authorship contribution statement benjun jia conceptualization investigation methodology software writing original draft jianzhong zhou funding acquisition resources zhengyang tang writing review editing zhanxing xu writing review editing xiao chen software validation wei fang visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to thank the editor and anonymous reviewers for their valuable comments and suggestions which have greatly promoted the improvement of this paper this study was supported by the key project of the natural science foundation of china u1865202 52039004 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 127366 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3754,stochastic simulations of streamflow sequences are essential for water resource planning and management in this study a new gaussian mixture model gmm based method is proposed to generate long term synthetic streamflow sequences of any time scale first the gmm model which is established based on the k means algorithm expectation maximization algorithm and akaike s information criteria is employed to describe the temporal dependences of the observed streamflow data second the accuracy and reliability of the constructed gmm are verified by the kolmogorov smirnov test of goodness of fit then daily 10 day and monthly streamflow sequences at a single site were generated using the proposed streamflow simulation method finally the performance of the proposed method was verified based on the absolute and relative performance indexes yichang gauging stations on the upper yangtze river were selected as case studies and two copula methods were selected as the contrast methods to evaluate the proposed method the results demonstrate that the proposed method can effectively capture the statistical properties of observed streamflow data at low middle and high time scales and can comprehensively preserve the lower and higher order statistics as well as the linear and nonlinear correlations of observed streamflow data the proposed method is an effective method for stochastic streamflow simulations keywords stochastic streamflow simulation gaussian mixture model k means clustering single site streamflow streamflow series at multiple time scales 1 introduction in water resource planning and management observed streamflow sequences are indispensable medda and bhar 2019 however because of limitations in observation conditions and technology the length of observed streamflow sequences is limited and is not sufficient to effectively support decision making in water resources management medda and bhar 2019 therefore long term synthetic streamflow series that are statistically similar to observed streamflow records are typically needed in actual water resource management chen et al 2019 2015 hao and singh 2012 2011 synthetic streamflow series are very useful for the design of reservoirs srinivas and srinivasan 2005 derivation of optimal reservoir operating rules jia et al 2019 zhou et al 2019 risk assessment of reservoir flood control policies huang et al 2018b wang et al 2021 2019 reliability assessments of water resource system operations sharma and o neill 2002 and analysis of multi reservoir operation policies kumar et al 2000 overall they may help prepare for events too much or too little water that have not yet been observed in the past but can be expected in the future szilagyi et al 2006 synthetic streamflow sequences can be generated using stochastic streamflow simulation methods the key requirement for streamflow simulation is that the synthetic streamflow sequences should maximum preserve the key statistical properties of the observed streamflow series hao and singh 2011 these properties include the mean standard deviation skewness coefficient kurtosis coefficient and lag correlations numerous streamflow simulation methods have been developed several commonly used models include autoregressive ar kendall and dracup 1991 autoregressive moving average arma boukharouba 2013 vogel and stedinger 1988 autoregressive integrated moving average arima montanari et al 1997 periodic autoregressive moving average parma rasmussen et al 1996 and other variants of arma these models are flexible and can be used for annual and seasonal streamflow simulations however they are based on gaussian and linearity assumptions and these assumptions are not typically satisfied by the observed streamflow series hao and singh 2011 the streamflow records are almost nonlinear non stationary and non normal zhao et al 2017 therefore transformation techniques that render the data normal are typically applied in the above models thereby leading to the statistical properties of observed streamflow data that cannot be effectively captured hao and singh 2011 additionally these classic linear models likely can reproduce the skewness characteristics by combining them with non gaussian white noise however there may be a tendency to construct unrealistic dependence structures tsoukalas et al 2018 a few disaggregation methods have also been proposed to generate synthetic streamflow series stedinger et al 1985 stedinger and vogel 1984 valencia and schaake 1973 for a time disaggregation model annual streamflow is generated using an appropriate model and then the generated annual streamflow is disaggregated into monthly daily or seasonal flows hao and singh 2011 the disaggregation model ensures the reproduction of key statistical characteristics at a specific time scale of interest and the sum of low time scale streamflow values e g monthly equal to high time scale streamflow values e g yearly hao and singh 2011 however the disaggregation model has many parameters that need to be estimated hao and singh 2011 other challenges include difficulties in the effective estimation of parameters inaccuracies in preserving higher order statistical properties and nonlinear dependence structures and computational inefficiency koutsoyiannis 2016 wang et al 2021 consequently some nonparametric methods such as the moving block bootstrapping method srinivas and srinivasan 2005 and the k nearest neighbor resampling method prairie et al 2007 have been proposed for stochastic streamflow simulations these nonparametric models are driven by sample data are typically based on bootstrap techniques and kernel density estimation and do not require any data transformation or assumptions about probability distribution hao and singh 2011 lall and sharma 1996 wang et al 2021 they can partly represent the nonlinear or non gaussian characteristics of the observed streamflow series lall and sharma 1996 however nonparametric methods generate streamflow values only within the range of observed streamflow data rendering it difficult to simulate extreme situations that can be expected in the future but different from the historical records salas and lee 2010 a more attractive method termed the copula method was recently developed for stochastic streamflow simulation the copula method has been extensively applied for stochastic simulation of hydrological data because of its flexibility in selecting marginal distributions representing the dependence structure extending to multivariate analysis and permitting separate analysis of marginal distributions and dependence structures chen et al 2019 2015 in addition the copula method does not require the observed streamflow series to meet the conditions of linearity or normal probability distribution therefore it does not have to deal with the normalizing transformation of streamflow data chen et al 2015 lee and salas 2011 used the copula method for a stochastic annual streamflow simulation hao and singh 2012 proposed an entropy copula method for a single site monthly streamflow simulation chen et al 2015 proposed a copula based method to generate long term multisite monthly streamflow sequences wang et al 2018 proposed hierarchical network copula conditional models for stochastic monthly streamflow simulations these copula methods are primarily used for annual or monthly streamflow simulation and only consider the dependence between the streamflow of time t and t 1 to overcome these limitations chen et al 2019 proposed a copula based method for stochastic single site daily streamflow simulation considering lag 2 autocorrelation in this method a trivariate copula was established to describe temporal dependencies among streamflow at time t t 1 and t 2 a pearson type iii distribution was employed to fit the marginal distribution of streamflow for each day compared with the arma disaggregation and moving block bootstrapping methods the copula method proposed by chen et al 2019 is superior for stochastic daily streamflow simulation owing to its simplified model structure efficient parameter estimation good nonlinear characterization capability and absence of linearity and gaussian assumptions however the copula method has two shortcomings 1 the marginal probability distribution of the streamflow for each day or month needs to be assumed and constructed the real marginal distribution is typically unknown hao and singh 2011 2 the model parameters are too few to more effectively describe the high order statistical characteristics of streamflow series fewer parameters are not necessarily advantageous which motivates the work presented in this paper the gaussian mixture model gmm consists of several basic multivariate gaussian distributions liu et al 2019 unlike the copula model it does not require any assumption regarding the marginal distribution of streamflow data in modeling the dependence structure of streamflow series in addition compared with a single probability model such as the p iii probability and copula model any continuous probability density can be approximated by the gmm model with arbitrary accuracy liu et al 2019 2018 thus gmm can deal well with the modeling of nonlinear and non gaussian streamflow series and has a high ability to describe multimodal and skewed distributions in recent years the gmm model has attracted increasing interest from hydrological researchers and has been widely used for streamflow forecasting and forecasting error simulation such as the research works of ji et al 2019 liu et al 2018 liu et al 2019 and zhang et al 2021 however to the authors knowledge it has not been applied to the stochastic simulation of hydrologic streamflow data therefore motivated by the shortcomings of existing streamflow simulation methods and inspired by the research on streamflow forecasting based on gmm a new stochastic streamflow simulation method based on gmm is explored in this study in this study a more effective stochastic streamflow simulation method based on a gmm is proposed long term daily ten day and monthly observed streamflow sequences from the yichang gauging station in the yangtze river were selected as case studies to prove the superiority of the proposed method the results show that the proposed method is significantly superior to the contrast methods in preserving the high order statistical characteristics and lag 1 linear autocorrelation of the observed streamflow series the remainder of this paper is organized as follows in section 2 the gmm parameter optimization for gmm and the entire process of the proposed streamflow simulation method are introduced in detail in section 3 the goodness of fit test and performance evaluation methods are described in section 4 the application of the proposed method and contrast methods to generate daily ten day and monthly streamflow is presented in section 5 the results and discussion are presented finally section 6 presents the conclusions of the study 2 methodology 2 1 gaussian mixture model the two dimensional joint probability density function pdf between the streamflow of the t 1 time period and the streamflow of the t time period was assumed to be a gmm the mathematical formula of the gmm probabilistic model is as follows bishop 2006 1 p x θ k 1 k π k n x μ k k n x μ k k 1 2 π k 1 2 exp x μ k t k 1 x μ k 2 k 1 k π k 1 0 π k 1 where p x θ is the density value of the two dimensional joint distribution x q t 1 q t t is a two dimensional vector composed of the streamflow q t 1 of the t 1 th time period and the streamflow q t of the t th time period in a certain year n x μ k σ k is the density function of the two dimensional joint normal distribution with the vector x as input which is the k th component of the gmm θ π μ σ is the parameter set to be optimized for the gmm and π π 1 π 2 π k μ μ 1 μ 2 μ k σ σ 1 σ 2 σ k π k is the proportion of the k th component also called mixing coefficients μ k is the mean vector of the k th component σ k is the covariance matrix of the k th component and k is the number of components of the gmm which is a hyperparameter to be optimized in fact x can be a vector of any dimension but this paper only constructed two dimensional gmms so the two dimensional gmm was described in detail 2 2 optimization of parameters for the gmm according to equation 1 the parameters of the gmm include two parts model parameters θ π μ σ and hyperparameter k the parameters of the gmm can be optimized through the following steps 1 based on a predefined hyperparameter k the model parameters θ are initialized by the k means clustering algorithm 2 based on the initialization value of the model parameters the model parameters θ are further optimized using the expectation maximization em algorithm dempster et al 1977 3 a new hyperparameter k value is set and steps 1 and 2 are repeated until all possible k values are traversed 4 according to the akaike s information criteria aic acquah 2010 determine the optimal hyperparameter k and simultaneously obtain the corresponding optimal model parameters θ the detailed description of parameters optimization for the gmm is provided in the supplementary material text s1 2 3 stochastic streamflow simulation method based on the gmm based on the gmm a more effective stochastic streamflow simulation method gmm ssm is proposed in this study first according to the product rule of the joint gaussian distribution the gmm model of x q t 1 q t t which is shown in equation 1 can be written as follows 2 p x 1 x 2 k 1 k π k n x μ k σ k k 1 k π k n x 1 μ k 1 σ k 11 n x 2 μ k 2 1 σ k 2 1 where x 1 and x 2 is the first and second element of the vector x respectively μ k 2 1 and σ k 2 1 are the conditional mean and conditional covariance of x 2 given x 1 respectively μ k 2 1 and σ k 2 1 can be calculated using equations 3 and 4 3 μ k 2 1 μ k 2 σ k 21 σ k 11 1 x 1 μ k 1 4 σ k 2 1 σ k 22 σ k 21 σ k 11 1 σ k 12 where σ k 21 is the element of the first column of the second row of the covariance matrix σ k μ k 1 is the first element of the mean vector μ k similarly other variables can be understood second according to the rule of total probability the marginal pdfs of x 1 and x 2 can be obtained as shown in equations 5 and 6 5 p x 1 p x 1 x 2 d x 2 k 1 k π k n x 1 μ k 1 σ k 11 6 p x 2 p x 1 x 2 d x 1 k 1 k π k n x 2 μ k 2 σ k 22 then according to the conditional probability formula the conditional pdf and conditional cumulative distribution function cdf of x 2 given x 1 can be derived as shown in equations 7 and 8 7 p x 2 x 1 p x 1 x 2 p x 1 k 1 k π k n x 1 μ k 1 σ k 11 n x 2 μ k 2 1 σ k 2 1 k 1 k π k n x 1 μ k 1 σ k 11 8 f x 2 x 1 x 2 p x 2 x 1 d x 2 finally the main steps of the proposed stochastic streamflow simulation method are described as follows 1 based on the sample data set gmms are constructed between the streamflow of the t 1 time period and the streamflow of the t time period and the conditional cdfs f x 2 x 1 of x 2 are derived given x 1 when the length of time period is one day the number of the gmm and f x 2 x 1 equals 365 n 365 when the length of the time period is ten days n equals 36 and when the length of the time period is one month n equals 12 2 in the first year of the stochastic streamflow simulation first make the simulated streamflow q 0 1 equal to 1 m i 1 m q n i where m is the number of years of sample data q n i is the observed streamflow of the n th time period in the i th year generate a uniform random number ε and assign it to the conditional cdf that is f q t 1 q t 1 1 ε t 1 then obtain the simulated streamflow q t 1 f 1 ε q t 1 1 t 1 of the t th time period of the first year the above processes are repeated until t equals n 3 in the i th year of the stochastic streamflow simulation first generate a uniform random number ε and assign it to the conditional cdf that is f q t i q t 1 i ε i 2 t 1 then calculate the simulated streamflow q t i f 1 ε q t 1 i i 2 t 1 of the t th time period of the i th year it is worth emphasizing that q 0 i equals q n i 1 the above processes are repeated until t equals n 4 let i i 1 repeat step 3 until i equals m and finally complete the stochastic streamflow simulation of m years where m is the number of years of the synthetic streamflow sequences 3 goodness of fit test and performance evaluation the accuracy and reliability of the constructed stochastic streamflow simulation models were verified using the one sample kolmogorov smirnov ks goodness of fit test massey 1951 the effectiveness and superiority of the proposed stochastic streamflow simulation method were demonstrated based on the performance evaluation indexes including the mean square error rmse mean absolute error mae mean absolute percentage error mape and coefficient of determination r2 3 1 goodness of fit test of the stochastic streamflow simulation models the accuracy of the constructed models was verified using the one sample ks test for goodness of fit of the constructed model the one sample ks test is a nonparametric test of the null hypothesis that the population cdf of the observed sample data is equal to the hypothesized cdf the test statistic of the one sample ks test is the maximum absolute difference between the empirical cdf and the hypothesized cdf of the observed sample data as follows 9 d t one max q t i e t q t i h t q t i t 1 2 n i 1 2 m 10 d t 1 t two max q t 1 i q t i e t 1 t q t 1 i q t i h t 1 t q t 1 i q t i t 1 2 n i 1 2 m where d t one is the maximum absolute difference between the empirical marginal cdf and the hypothesized marginal cdf d t 1 t two is the maximum absolute difference between the empirical joint cdf and the hypothesized joint cdf q t i is the observed streamflow of the t time period in the i th year e t and h t are the empirical and hypothesized marginal cdfs for the streamflow of the t th time period respectively e t 1 t and h t 1 t are the empirical and hypothesized joint cdf between the streamflow of the t 1 th time period and the streamflow of the t th time period the calculation formulas for the empirical marginal cdf and empirical joint cdf can be found in gringorten 1963 and huang et al 2018a notably e 0 1 q 0 i q 1 i represents the empirical joint cdf between the streamflow of the n th time period and the streamflow of the 1 th time period that is e 0 1 q 0 i q 1 i e 0 1 q n i 1 q 1 i based on this d 0 1 two and h 0 1 q 0 i q 1 i can be understood additionally n is the number of time periods per year when the length of the time period is one day n equals 365 when the length of the time period is ten days n equals 36 and when the length of the time period is one month n equals to 12 by querying the critical value table massey 1951 of the test statistic of the one sample ks test the critical values d α m and p values p m corresponding to different levels of significance α and sample numbers m are obtained when d t one or d t 1 t two is greater than d α m the null hypothesis is rejected otherwise it is accepted additionally a decision to accept the null hypothesis can be based on the p value when p m is greater than α the null hypothesis is accepted otherwise it is rejected small values of p m cast doubt on the validity of the null hypothesis in contrast the higher p m is the more strongly the null hypothesis is accepted 3 2 basic statistics of streamflow series the effectiveness and superiority of the proposed method were demonstrated by comparing the approximation degree of the basic statistics of the simulated streamflow series generated by different stochastic streamflow simulation methods and the basic statistics of the observed streamflow series seven basic statistics were used the mean μ t standard deviation s d t skewness coefficient c s t and kurtosis coefficient c k t of the streamflow series in the t th time period of all years the pearson correlation coefficient r p t 1 t kendall correlation coefficient r k t 1 t and spearman correlation coefficient r s t 1 t between the streamflow series in the t 1 th time period and the streamflow series in the t th time period the definitions of these basic statistics of the streamflow series are provided in the supplementary material text s2 3 3 performance evaluation indexes of the stochastic streamflow simulation methods the commonly used rmse mae mape and coefficient of determination r2 were selected as evaluation indices to evaluate the performance of the proposed stochastic streamflow simulation method without loss of generality referring to the research work of he et al 2019 the definitions of these performance evaluation indexes are as follows 11 rmse 1 n t 1 n s t s t 12 mae 1 n t 1 n s t s t 13 mape 1 n t 1 n s t s t s t 100 14 r 2 1 t 1 n s t s t 2 t 1 n s t s 2 where n represents the number of time periods per year s t and s t denote the basic statistics of the observed and simulated streamflow series respectively and s is the mean value of s t furthermore p rmse p mae p mape and p r 2 are introduced to describe the improvement degree of the proposed method compared with the contrast methods p rmse 0 p mae 0 p mape 0 and p r 2 0 indicate that the proposed method is better than the contrast method the closer p rmse p mae p mape and p r 2 are to 0 the smaller the performance difference between the proposed method and the contrast method referring to the research of he et al 2019 the definition of these indexes can be given as 15 p rmse rms e 2 r m s e 1 rms e 2 100 16 p mae ma e 2 m a e 1 ma e 2 100 17 p mape map e 2 m a p e 1 map e 2 100 18 p r 2 r 1 2 r 2 2 r 2 2 100 r 2 2 0 r 1 2 r 2 2 r 2 2 100 r 2 2 0 where the subscript 1 indicates the performance index of the proposed method and subscript 2 denotes the performance index of the contrast methods 4 case study 4 1 study area and data used to prove the superiority of the proposed method the yichang hydrological gauging station was selected as the case study in this study yichang station is located approximately 40 km downstream of the three gorges project fig 1 it is one of the most important hydrological gauging stations in the yangtze river basin its area is controlled by approximately 1 0 million km2 accounting for approximately 58 of the area of the yangtze river basin in this case study 136 year daily streamflow records 1882 2017 from the yichang gauging station were used because the three gorges reservoir has been regulating and storing streamflow from the upper reaches since 2003 the streamflow records of 2003 2017 were restored to ensure the consistency of the statistical characteristics of the streamflow series in addition the ten day average streamflow series and monthly average streamflow series were also used the calculation formula for the average streamflow series at a certain time scale is as follows 19 q δ i t 1 n δ i t j 1 n δ i t q d i t j where q δ i t is the streamflow value of the t th time period of the i th year of the streamflow series of a certain time scale n δ i t is the number of days in the t th time period of the i th year and q d i t j is the average streamflow of the j th day of the t th time period in the i th year 4 2 model development 4 2 1 development of the gmm for the daily streamflow series 365 gmms were constructed and the corresponding conditional cdfs were derived using the methodology described in section 2 for the ten day streamflow series 36 gmms were constructed and the corresponding conditional cdfs were derived for the monthly streamflow series 12 gmms were constructed and the corresponding conditional cdfs were derived the model parameters θ of all gmms were optimized using the em and the k means algorithms there is no specific display for the optimized model parameters owing to space limitations the hyperparameters k of all gmms were selected based on the aic information criteria fig 2 in fig 2a the values in the first row and the first column represent the k value of the gmm between the streamflow on the 365th day and the streamflow on the first day and the values in other positions represent the k value of the gmm between the streamflow on the previous day and the streamflow on the next day fig 2b and c present data in a similar fashion 4 2 2 two dimensional copula and three dimensional copula models development in this study to demonstrate the effectiveness and superiority of the proposed method the two dimensional copula based stochastic streamflow simulation method or the bivariate copula method twc ssm and three dimensional copula based stochastic streamflow simulation method or the trivariate copula method thc ssm were used as competitive methods for stochastic streamflow simulation similar to the work of constructing gmm for the daily ten day and monthly streamflow series 365 36 and 12 two dimensional copula models were constructed respectively in the same way the work of building three dimensional copula models can be understood the two dimensional copula model represents the joint probability distribution of the streamflow of the t 1 th time period and the streamflow of the t th time period the three dimensional copula model represents the joint probability distribution of the streamflow of the t 2 th time period the streamflow of the t 1 th time period and the streamflow of the t time period in contrast to the construction process of the gmm the construction process of the copula model includes two steps construction marginal distribution and determination of the dependence structure in this study by referring to the research work of chen et al 2019 2015 pearson type iii p iii distribution was selected as the marginal distribution of the streamflow in the t th time period and the gumbel copula was selected as the two dimensional or three dimensional joint distribution of the streamflow time series the thc ssm method proposed by chen et al 2019 is a relatively new stochastic streamflow simulation method the details of building the two dimensional and three dimensional copula model and the procedure for carrying out stochastic streamflow simulation using twc ssm and thc smm methods are detailed by chen et al 2019 and will not be repeated here 5 results and discussion the proposed method and the contrast methods were applied to stochastic streamflow simulation at the yichang station the results are presented in three parts the first is the accuracy and reliability of the gmm probability model which was first verified by the one sample ks goodness of fit test in the second part the effectiveness and superiority of the proposed stochastic streamflow simulation method were demonstrated by comparing the proposed method with the contrast methods thirdly the implications for further improvement of the stochastic streamflow simulation method are discussed based on the application results of different methods 5 1 goodness of fit test results of the probability models the one sample ks test of goodness of fit of the constructed gmm models and the constructed two dimensional copula models to the empirical joint distribution of the daily streamflow series were performed using the methodology described in section 3 1 fig 3 the ks test results of the goodness of fit of the gmm model and the p iii probability model to the empirical marginal distribution of the daily streamflow series are shown in fig 4 similarly for the ten day streamflow series and monthly streamflow series the ks test results of the goodness of fit of the gmm are presented in figs 5 and 6 respectively notably because the three dimensional copula is constructed based on the two dimensional copula and conditional copula the goodness of fit of the three dimensional copula to the empirical joint distribution of the streamflow series is the same as that of the two dimensional copula this is also why only the goodness of fit test results of the gmm model and two dimensional copula model are given in figs 3 5a b fig 6a and b in addition to describe the marginal distribution of streamflow series by gmm see equations 5 and 6 as shown in fig 3 under different levels of significance α and different days the p value of the goodness of fit test of gmm is much larger than α fig 3a and the test statistic is also much smaller than the critical test statistic fig 3b therefore the null hypothesis of the gmm is accepted that is the gmm can accurately describe the population joint distribution of the daily streamflow series however for the copula model only when the level of significance is 0 01 the null hypothesis that it can accurately describe the population joint distribution of the daily streamflow series is accepted thus compared with the copula model the gmm can more accurately describe the joint distribution characteristics of daily streamflow series and its reliability is significantly higher additionally according to fig 4 a similar conclusion can be obtained that is compared with the p iii probability model the marginal distribution characteristics of the daily streamflow series can be more accurately described by the gmm model this further demonstrates the reliability of the gmm model as shown in fig 5a and b under different levels of significance and different time periods the p values are very large and the test statistics are very small therefore the null hypothesis that the constructed 36 gmms are equal to the population joint distributions of the observed ten day streamflow series is tenable similarly fig 5c and d indicate that the gmm can accurately describe the marginal distributions of the ten day streamflow series on the contrary with an increase in the level of significance the null hypothesis that the constructed 36 copula models are able to accurately simulate the joint distribution characteristics of the ten day streamflow series will be rejected as shown in fig 5a and b this shows that to a certain extent the copula model is feasible to use to describe the statistical characteristics of the ten day streamflow series but its credibility is lower than that of the gmm similarly in describing the marginal distributions of the ten day streamflow series the accuracy and reliability of the p iii probability model are lower than the gmm overall as shown in fig 5c and d figure 6 shows the ks test results of the goodness of fit of the constructed 12 gmms to the empirical joint distributions and empirical marginal distributions as shown by the red dotted lines in fig 6a and b the p value of goodness of fit of gmm is above all levels of significance and the test statistic is below all critical test statistics therefore the gmm can reliably describe the joint probability distributions of monthly streamflow series similarly fig 6c and d show that the marginal probability distributions of the monthly streamflow series can be accurately described by the gmm in addition it is obvious from fig 6a and b that the copula model can also effectively reflect the statistical characteristics of the monthly streamflow series but compared with gmm its accuracy and reliability are obviously lower fig 6c and d support a similar conclusion that the p iii probability model is reliable in describing the marginal probability distributions of the monthly streamflow series but not as good as the gmm model according to figs 3 6 and the above analysis compared with the copula model and p iii probability model gmm can more accurately and reliably describe the joint probability distribution and marginal probability distribution of the daily streamflow series ten day streamflow series and monthly streamflow series therefore the proposed stochastic streamflow simulation method is more effective than existing methods the next section further analyzes and demonstrates the effectiveness of the proposed method 5 2 performance evaluation results of the stochastic streamflow simulation methods the gmm ssm twc ssm and thc ssm methods were used to generate daily streamflow series ten day streamflow series and monthly streamflow series with a length of 2000 years if necessary a longer runoff series can be generated but 2000 years should be enough the basic statistics of these three simulated streamflow series generated by each method were calculated according to equations a1 a7 in the supplementary material text s2 as shown in figs 7 8 and 9 figure 7 shows seven statistics for the three simulated daily streamflow series and the observed daily streamflow series it can be seen that the simulated mean fig 7a sd fig 7b rk fig 7f and rs fig 7g obtained by the three methods are all relatively close to the corresponding statistics of the observed daily streamflow series to a certain extent this shows that the three methods can effectively preserve the statistical characteristics of the mean sd rk and rs exhibited by the observed daily streamflow series furthermore it can be seen from fig 7c d and e that the cs ck and rp values generated by gmm ssm are much closer to the corresponding statistics of the observed daily streamflow series than those generated by the twc ssm and thc ssm methods the above analysis preliminarily demonstrates the superiority and effectiveness of the proposed gmm ssm method the performance indexes of each method were calculated according to equations 11 to 14 as shown in table 1 to further quantitatively compare and analyze the performance of the three methods in preserving the statistical characteristics of the daily streamflow series the degree of improvement of the proposed method compared with the contrast methods was also calculated according to equations 15 to 18 as shown in fig 10 it can be seen from the four performance indexes shown in table 1 that the proposed gmm ssm method can most effectively simulate the sd cs ck rp and rs statistics of the observed daily streamflow series moreover compared with the other two methods the gmm ssm method has significant advantages in preserving cs ck and rp statistics which is intuitively shown in the blue and red bars above the 0 value line in fig 10 however the gmm ssm is slightly inferior to other methods in preserving the statistical mean and rk as shown in the bars below the 0 value line in fig 10a b and c however the mapes of the mean and rk of the proposed method are very small within 0 8 and the determination coefficients r2 are also large above 0 95 as shown in table 1 the above analysis shows that the comprehensive performance of the proposed gmm ssm method is better than the contrast methods and it can more effectively generate a simulated daily streamflow series with the statistical characteristics of the observed daily streamflow series which is intuitively shown in fig 10d figure 8 shows seven statistics of three simulated ten day streamflow series and the observed ten day streamflow series table 2 presents the performance indexes of different stochastic streamflow simulation methods for preserving the statistical characteristics of the observed ten day streamflow series fig 11 presents the degree of improvement of the proposed gmm ssm method compared to the contrast methods in fig 11 when the bar is above the 0 value line the performance of the proposed method is better the results plotted in fig 8 present a conclusion similar to that shown in fig 7 additionally rmse mae and r2 of rk are slightly worse than those of the contrast methods other performance indexes of the proposed method are better than those of the contrast methods table 2 this provides compelling evidence that the proposed method can describe the statistical characteristics of the ten day streamflow series more accurately and can more effectively generate simulated streamflow series reflecting the statistical characteristics of the observed ten day streamflow series the data displayed in fig 11 corroborate this conclusion figure 9 shows seven statistics of three simulated monthly streamflow series and the observed monthly streamflow series table 3 presents the performance indexes of different stochastic streamflow simulation methods in preserving the statistical characteristics of the observed monthly streamflow series fig 12 shows the improvement degree of the proposed gmm ssm method compared with the contrast methods in preserving the statistical characteristics of the monthly streamflow series by analyzing fig 9 a conclusion similar to figs 7 and 8 can be obtained in addition table 3 and fig 12 evidently present that the proposed method can preserve the statistical characteristics of the observed monthly streamflow series more comprehensively and has better comprehensive performance than the contrast methods finally based on the discussion and analysis in sections 5 1 and 5 2 the following conclusions can be drawn 1 compared with the p iii probability model the gmm model can more accurately describe the marginal distribution characteristics of the observed streamflow time series 2 compared with the copula model the gmm model can more accurately describe the joint distribution characteristics of the observed streamflow time series 3 compared with the twc ssm and thc ssm methods the proposed gmm ssm method has a better comprehensive performance in particular the proposed method is significantly superior to the contrast methods in preserving the high order statistical characteristics and lag 1 linear autocorrelation of the observed streamflow series 4 one of the reasons why the gmm and gmm ssm methods have better comprehensive performance is that the gmm model has more parameters and the parameters can be easily optimized by the em algorithm the number of parameters of gmm is 7 k 1 while the number of parameters of the copula model based on p iii marginal distribution is only four two dimensional copula or six three dimensional copula details of the copula model can be found in chen et al 2019 2015 5 3 implications for further improvement of stochastic streamflow simulation method 5 3 1 improving the method by integrating the advantages of multiple probability models the absolute performance indexes of the three methods shown in tables 1 2 and 3 indicate that all performance indexes of the proposed gmm ssm method are relatively good and this is a more effective stochastic streamflow simulation method however figs 10 11 and 12 clearly indicate that the gmm ssm method is not completely superior to the contrast methods in terms of preserving the mean value standard deviation and kendall correlation coefficient rk of the streamflow series therefore improving the proposed stochastic streamflow simulation method and further improving its performance is worth discussing the performance of the stochastic streamflow simulation method likely can be further improved by integrating the advantages of the gmm two dimensional and three dimensional copulas integrating the advantages of multiple sub models is a typical method especially in the field of runoff forecasting such as the combined model huang et al 2019 and hybrid model sun et al 2018 of runoff forecasting this has greatly enhanced our confidence in the stochastic streamflow simulation method integrating the gmm two dimensional copula and three dimensional copula intuitively we consider that the combined model based stochastic streamflow simulation method performs better than the single model based method however further experimental studies are needed to confirm this the advantages of these three models can be effectively integrated through weighted summation as shown in the following equation 20 f c q t q t 1 q t 2 ω 1 f gmm q t q t 1 ω 2 f twc q t q t 1 ω 3 f thc q t q t 1 q t 2 where fc qt qt 1 qt 2 is the combined conditional cdf fgmm qt qt 1 is the conditional cdf derived from the gmm model as shown in equation 8 ftwc qt qt 1 is the conditional cdf derived from the two dimensional copula fthc qt qt 1 qt 2 is the conditional cdf derived from the three dimensional copula and ω 1 ω 2 and ω 3 are weights whose sum is 1 using equation 20 and referring to the stochastic streamflow simulation steps at the end of section 2 3 a stochastic streamflow simulation can be carried out for equation 20 the determination of its weights is a key task it primarily involves the selection or development of an optimization algorithm the construction of an objective function and the consideration of the dynamic change in weights there has not been enough time to implement the foregoing this will be included in our future research and we hope that colleagues can publish relevant research results as soon as possible 5 3 2 improving the method by introducing machine learning models through the above research work it can be seen that gmm ssm twc ssm and thc ssm methods need to construct the joint probability distribution explicitly first and then carry out stochastic streamflow simulation on this basis in fact there is a method that does not need to explicitly rely on the joint probability distribution that is the method of coupling regression model and probability model the mathematical formulas of this type of methods are as follows 21 q t f t q t 1 q t 2 q t p ε t t 1 2 n 22 q t f q t 1 q t 2 q t p ε where qt is the streamflow of the t th time period in a certain year qt pis the streamflow in the p th time period before qt ε t and ε are independent random variables that obey a certain one dimensional distribution f and ft are regression models n is the number of time periods per year the steps of generating synthetic streamflow series by using equation 21 and 22 is similar firstly the regression value ft qt 1 qt qt p or f qt 1 qt 2 qt p is obtained according to the simulated streamflow in the previous periods secondly a sample value is randomly generated according to the probability distribution of εt or ε then the sum of the regression value and the sample value is the simulated streamflow qt finally repeat the above steps to generate long term synthetic streamflow sequences the difference between equation 21 and 22 is that equation 21 is applicable to seasonal streamflow series e g monthly ten days daily and equation 22 is applicable to weak stationary streamflow series e g annual since there is no essential difference between equation 21 and 22 equation 21 is only further analyzed and discussed below for equation 21 the key work is to determine the regression model ft and the probability distribution of εt in the existing research papers boukharouba 2013 chen et al 2019 zhou et al 2019 εt is often assumed to obey the normal distribution with zero mean for the convenience of modeling and ft is often designed as ar arma and other traditional regression models however the research of chen et al 2019 shows that the performance of stochastic streamflow simulation method based on ar model and normal hypothesis is inferior to the twc ssm and thc ssm methods the possible reasons are 1 the ar model is a linear model and is difficult to accurately describe the nonlinear characteristics of the streamflow series 2 the simulation error εt of the regression model is difficult to meet the assumptions of zero mean and normal distribution based on these two reasons some feasible improvement methods are discussed below in recent years machine learning algorithms such as lstm gru and svm have been widely used in time series prediction feng et al 2020 gao et al 2020 he et al 2019 but rarely in stochastic streamflow simulation these machine learning models have strong fitting ability and generalization ability compared with ar and its variants they can more accurately describe the nonlinear relationship between input x qt 1 qt 2 qt p and output qt therefore taking the machine learning algorithm as the regression model of equation 21 is likely to further improve the performance of stochastic streamflow simulation method but this needs to be demonstrated by further experimental studies in addition for the random variable ε t gmm also a machine learning model can be directly used to describe its probability distribution because gmm can easily fit any continuous probability distribution without relying on any assumptions and its goodness of fit performance is better which is proved in section 5 1 through the above discussion and analysis an improvement strategy that is likely to further improve the performance of the stochastic streamflow simulation method is proposed that is the regression model ft and probability model ε t in equation 21 are designed as machine learning models instead of traditional linear model and normal distribution this method combines gmm model with other machine learning models and its performance may be better than the gmm ssm proposed in this paper to the authors knowledge this idea has not generally appeared in the open literature and is worthy of further study there has not been enough time and ability to implement the foregoing this will be included in our future research and we hope that colleagues can publish relevant research results as soon as possible 6 conclusions this paper proposes a gmm based method for stochastic streamflow simulations the yichang hydrological gauging station in the upper yangtze river basin was selected as a case study to demonstrate the superiority of the proposed method specifically it includes four aspects first the gmm two dimensional copula and three dimensional copula models at different time scales were developed to describe the statistical characteristics of the observed daily ten day and monthly streamflow series second the accuracy and reliability of the constructed three models were verified by the goodness of fit test third the effectiveness and superiority of the proposed stochastic streamflow simulation method were demonstrated based on the performance evaluation indices by comparing with the contrast methods fourth the tentative idea of further improving the stochastic streamflow simulation method was proposed we conclude the following 1 the gmm can more accurately describe the marginal distribution characteristics and two dimensional joint distribution characteristics of streamflow time series compared with the p iii distribution function and copula model as shown in figs 3 to 6 2 the proposed gmm ssm method has a better comprehensive performance than the contrast methods it can effectively preserve the statistical characteristics of the observed streamflow series including daily ten day and monthly streamflow series these statistics include the mean standard deviation skewness coefficient kurtosis coefficient pearson correlation coefficient kendall correlation coefficient and spearman correlation coefficient in particular the proposed method is significantly superior to the contrast methods in preserving the skewness kurtosis and pearson correlation coefficients as shown in figs 10 11 and 12 3 the proposed method has pronounced adaptability and can be applied to stochastic streamflow simulations at various time scales therefore it has broad application prospects in this study a more effective stochastic streamflow simulation method was proposed and demonstrated however this study is only a small step forward for stochastic streamflow simulation research several aspects need to be further studied first only one hydrological gauging station was taken as a case study to test the proposed method more data from different hydrological stations should be collected to further verify the new method in further research second relevant research and further improvement of the stochastic streamflow simulation method are necessary according to the tentative idea described in section 5 3 third it should be further demonstrated whether the gmm ssm method has the ability to preserve lag n n is greater than or equal to 2 autocorrelation of streamflow series and propose the corresponding solutions fourth the gmm ssm method needs to be extended to stochastic simulation of multisite streamflow credit authorship contribution statement benjun jia conceptualization investigation methodology software writing original draft jianzhong zhou funding acquisition resources zhengyang tang writing review editing zhanxing xu writing review editing xiao chen software validation wei fang visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to thank the editor and anonymous reviewers for their valuable comments and suggestions which have greatly promoted the improvement of this paper this study was supported by the key project of the natural science foundation of china u1865202 52039004 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 127366 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
