index,text
22860,waterjet hull interaction has different effects on the propulsion performance of the outer and inner waterjets in ships propelled by four waterjets the dead rise angle of the hull lines near the stern leads to different inflow characteristics in the capture areas of individual waterjets to better understand these effects self propulsion tests were performed to investigate the thrust deduction fraction and energy momentum velocity coefficients and numerical simulations of unsteady multiphase flows were conducted using a discretised impeller stator with dynamic overset grids results obtained indicate that the flow rates and gross thrust of inner waterjets were greater than those of the outer waterjets under the same rotational speeds and that these differences gradually decreased with increases in the advanced speed the hull had a stronger negative effect on the inflow of the outer waterjet because its energy momentum velocity coefficients were smaller than those of the inner waterjets additionally flow field analysis of the capture area verified the quality of the computations and internal flow field analysis provided additional validation of observed results it was found that the inlet duct design and the presence of stabilizer fins caused different interaction behaviours resulting in the propulsion performance discrepancies observed in four waterjet systems keywords waterjet hull interaction propulsion thrust deduction flow filed characteristics 1 introduction waterjets provide higher propulsive efficiency less vibration and better manoeuvrability compared to conventional propellers and are thus extensively applied in high speed ships in operating at speeds excess of 30 knots molland et al 2017 with the increasing tonnage and size of high speed ships waterjet propulsion must provide higher output power to meet speed demands to this end ships utilizing waterjet propulsion systems generally adopt multiple waterjets two to four to provide sufficient thrust at a high efficiency in limited installation spaces consequently the resulting interaction between multiple waterjet propulsion and hull systems becomes exceedingly complicated and its complete understanding requires in depth investigations to be performed the international towing tank conference ittc set up the waterjet specialist committee in 1993 and more recently has summarised several recommended procedures for marine vehicles with waterjets ittc 25th 2008 ittc 26th 2011 waterjet hull interaction is the core concern of scholars focused on self propulsion analysis coop 1995 van terwisga 1996 eslamdoost 2014 some of their research and recommendations were adopted by the ittc and continuous improvements have been added to perfect the procedures coop 1995 investigated the effects of interaction between a waterjet featuring a flush type intake and a planing hull in both model scale and full scale the thrust deduction characteristics and interaction forces were measured and reported while an analytical propulsion model was constructed to incorporate the waterjet momentum forces moreover the mechanisms possibly contributing to the overall interaction effect were discussed van terwisga 1996 developed a complete study on waterjet hull interaction in his doctoral thesis and utilised analytical numerical and experimental methods he explained the difference between gross thrust and net thrust and specified the negative thrust deduction fraction of a waterjet propelled ship bulten 2006 conducted a waterjet test in a cavitation tunnel and performed detailed investigations both experimentally and numerically he measured the velocity distribution of an impeller plane with a three hole pitot tube and revealed non uniform characteristics of the inflow pattern rispin 2007 studied the effect of model scale on the boundary layer thickness of a demi hull with two waterjets he found that the velocity distributions of the capture area and the thrust deduction fraction were influenced by the scale jessup et al 2008 conducted model tests and a detailed power analysis of a joint high speed sealift jhss which was propelled by four axial flow waterjets the experiments included detailed laser doppler velocimetry ldv measurements at different stations ldv provided a superior presentation detailing the flow non uniformities at each station gong et al 2017 applied particle image velocimetry piv techniques to measure the velocity distribution of the capture area in the mid body of a trimaran with a pair of waterjet units they pointed out that the motion of the ship during the piv test affected the measured results of the capture area their research provided some guidance for employing piv applications in waterjet propelled vessels eslamdoost et al 2018 studied the thrust deduction fraction of a waterjet propelled hull in a wide range of speeds and clarified the reasons for the large variation in the fraction they concluded that the jet system thrust deduction fraction was the main reason for the negative thrust deduction recent progress in computational fluid dynamics cfd techniques has enabled faster and more effective approaches for predicting waterjet hull interactions takai 2010 investigated the flow fields for a bare hull and the self propelled conditions of the jhss employing the unsteady reynolds averaged navier stokes urans solver cfdship iowa detailed cfd verification and validation analysis of the jhss were performed by takai et al 2011 kandasamy et al 2010 developed an integral force moment waterjet model and applied it by using cfdship iowa to analyse the local flow and powering of ships eslamdoost et al 2014 presented a pressure jump method for modelling waterjet hull interaction based on potential flow theory and identified the major parameters which contributed to waterjet hull interaction eslamdoost 2014 additionally they investigated the difference between the net thrust and gross thrust of a waterjet unit through a rans study eslamdoost et al 2016 and summarised the mechanism of thrust deduction in a more recent study eslamdoost et al 2018 many previous studies have contributed to the understanding of waterjet hull interactions via experimental and numerical analyses however the hydrodynamic performance of individual waterjets may be different since a dedicated inlet duct design must be performed to facilitate accurate alignment of a ship s operational profile with the optimum point of waterjet operation especially in the case of ships characterised by varying hull lines near the locations of waterjet installation the dead rise angle of the hull lines near the stern leads to different inflow characteristics in the capture areas of different waterjets also initial immersed depth of the waterjets influences the efficiency and output power of the waterjets mounted on the hull waterjet hull interaction has different effects on the propulsion performance of individual waterjets in a multiple waterjet system thus the goal of the present study is to investigate how waterjet hull interaction affects the propulsion performance of a self propelled ship with four waterjets the inflow characteristics of the capture area and the gross thrust are analysed to quantitatively verify this complex interaction this remainder of this study is organised as follows the model tests and cfd setup are described in section 2 section 3 describes a comparison of the experimental and numerical results and contains a detailed analysis comparing the inner waterjets and outer waterjets finally conclusions are presented in section 4 2 model test and cfd setup 2 1 design of self propulsion test self propulsion tests were conducted in a large 108 7 3 5 m towing tank at harbin engineering university the four component motion measuring device and the underwater particle image velocimetry piv devices were used for data collection the experiments included resistance self propulsion and piv tests for a ship model with four waterjets a medium speed mono hull ship with two sets of stabilizer fins was chosen for the experiments a deep v hull form with a transom stern was adopted in the ship design and four flush type waterjets were selected for the propulsion system fig 1 to indicate the different positions of the four mixed flow waterjets they were defined as inner waterjets iw and outer waterjets ow see fig 1 c the main parameters of the ship and waterjet models are presented in table 1 in the self propulsion test the impeller rpm range could fully cover the full scale performance across the model speed range fr 0 167 to 0 534 r e 2 01 106 to 3 79 106 to achieve the self propulsion point spp four waterjets maintain the same rotational speed during the experiment as the most critical quantity the volume flow rate q j through the waterjet system was determined indirectly using differential pressure transducers dpts two micro pulsating pressure transducers pt1 and pt2 were installed in different longitudinal positions as a group both perpendicular to the nozzle slope and 30 from the vertical direction see fig 2 a the precision level of the pressure transducer was 0 25 and the probe diameter was 5 0 mm two groups of transducers denoted as p1 through p4 were mounted on the iws and ows in order to measure the volume flow rate fig 2 b calibration of the dpts method was performed prior to commencement of the self propulsion test and described in subsequent section 3 1 to confirm the repeatability and reliability of the dpts methods the precision limit p m of the measured flow rates measured during multiple tests was analysed using the relation p m ks dev m 1 2 ittc 2011 where m denotes the number of runs s dev denotes the sample standard deviation and k is called coverage factor the value of which approximately equals 2 at a forward speed corresponding to fr 0 4 during the three repeated tests the precision limits of the flow rates were observed to be 0 37 and 0 42 for the inner and outer waterjets respectively a vehicle mounted three dimensional underwater stereo piv device was used to measure the inlet velocity distribution for fr 0 3 0 4 and 0 534 for the waterjet propelled ship model gong et al 2019 the coverage area of the piv camera was rectangular with a size of approximately 260 320 mm2 as determined after the calibration process this was sufficient to cover the target capture area of the iw and ow the sampling frequency was 7 5 hz in the piv test and a total of 250 particle image pairs were captured for each speed the piv tests were carried out in the resistance test to measure the velocity distribution of the capture area which was used to calculate the energy momentum velocity coefficients c e and c m additionally the results obtained from the piv test were used to evaluate the accuracy of the computational flow fields 2 2 numerical model cfd simulations were performed using the unsteady rans flow solver star ccm 11 04 the multiphase air water three dimensional flows including free surface effects were established to analyse the hydrodynamic performance in both the bare hull and self propulsion simulations in terms of motion two degrees of freedom heave and pitch and free surface effects were considered in order to maintain consistency with the experimental conditions in addition the waterjet components including the shaft impeller stator and channel were discretised in the numerical simulations to investigate differences between the complex internal flow fields of the iws and ows 2 2 1 governing equations and turbulence model the governing equations for the turbulent flow field around the waterjet hull system comprised the instantaneous conservation of mass continuity equation and momentum rans for an incompressible newtonian fluid wang 2004 an additional equation is needed to solve the unknown reynolds stress the turbulence model is a closure equation that combines the fluctuating time averages in this study the shear stress transport sst k ω turbulence model is selected for all simulations because it combines the advantages of the standard k ω and standard k ε models and exhibits good behaviour in calculating the separating flow menter 1994 the governing equations and the transport equations of turbulence model are discretised using the finite volume method with a second order upwind scheme while pressure velocity coupling is facilitated through the simple algorithm the time terms are discretised using second order implicit time discretisation 2 2 2 grid system and boundary conditions to save computational resources and improve efficiency only half of the ship hull was used for bare hull simulations and thus only two of the waterjets were included for self propulsion simulations with respect to the computational coordinate system a cartesian earth fixed coordinates o xyz were used and defined as follows the positive direction of the x axis indicated the direction from the bow to the stern of the ship the positive direction of the y axis indicated the direction from mid ship to the port side and the positive direction of the z axis indicated the direction from the bottom of the ship to its deck see fig 1 the dimensions of the computational domain see fig 3 along the three directions were 2 5l pp x 4l pp 0 0 y 2l pp and 2 0l pp z 1 0l pp the boundary conditions of the computational domain were set as follows a symmetry boundary condition of y 0 was adopted the inlet was the velocity inlet as were the top sides and bottom wang et al 2015 gong et al 2018 which simulated infinite far field boundary conditions the outlet was the pressure outlet the mid ship section was a symmetry plane and the hull channels impellers shafts stators and nozzles were non slip surfaces for the self propelled simulations the overset grid technique was used to simulate the rotation of the impeller and coupled with the motion of ship model the overset grid technique can help mitigate the effects of the very small gap between the blade tips and wall boundary and it is an effective solution for calculating unsteady problems see fig 4 c an overset grid allows complex regions to be replaced with multiple overlapping body conforming curvilinear grids the overset grid divides a computed flow regime into several sub regimes thus enhancing the flexibility of grid generation this allows component grids to be added in a mutually independent manner therefore grid connectivity only has to be updated locally and information is propagated through the embedding and overlapping of each regional grid while interpolations are used to couple information from the boundary flow fields of the overset grids koblitz et al 2017 the overset grids were widely used in previous self propulsion simulations carrica et al 2010 castro et al 2011 shen et al 2015 the overset grid approach divides the computational domain into three subdomains one static region and two rotational regions and the overset regions are coupled to the background region using the overset mesh interface it is necessary to consider the level of discretisation in the special regions of the computational region during meshing the cartesian cut cell method was used to generate the unstructured computational grids with a boundary layer that consisted of a prism layer mesh and trimmed mesh the cell size of the computational domain should transition in a gradual manner to avoid numerical dissipations the surface mesh of the waterjet hull system is shown in fig 4 three refinement volumes were used around the hull with gradually changed isotropic sizes of 3 l pp 1 5 l pp and 0 75 l pp in order to improve the simulation precision of the non uniform flow field and capture the free surface more accurately three refinement volumes were applied in the gas liquid interface areas with finer sizes 0 375 l pp 0 187 l pp and 0 094 l pp in the z direction in addition several refinement volumes were set near the stern and trailing flow region to capture the flow details to maintain consistency throughout the simulations the mesh size and mesh distribution around the hull were kept almost the same during the self propulsion and bare hull simulations for the rotational regions in self propulsion simulations even finer grid sizes were employed to discretise the blade surfaces of the impeller and stator with a minimum size of 0 5 d i further the blade surfaces were refined along the feature lines of the leading and trailing edges with respect to the volume mesh a refinement volume was employed in the static region to better discretise the region inside the pump with an isotropic size of 2 d i also a cylindrical refinement volume was employed in the static region isotropic size of 1 d i to match the overset mesh size in the rotational region with an isotropic size of 0 25 d i the tip clearance region about 2 mm between the channel and impeller blade tips was further discretised in addition the boundary layer thickness δ of the hull was estimated according to the theory of flat plate boundary layer white 1998 ten prism layers were computed and meshed near the surfaces with a total thickness equals to the estimated δ 1 26 1 37 l pp finally the total number of cells in the fine grid was 12 67 million while the static and rotational sub domains contained 9 95 million and 2 72 million cells respectively the volume of fluid vof model was utilised to capture the free surface hirt and nichols 1981 the high resolution interface capturing hric scheme was used to capture the free surface in star ccm böhm and graf 2014 the dynamic fluid body interaction dfbi model was employed to simulate the motion of the ship ohmori 1998 it was important that the time step size satisfied the demands of the courant friedrichs levy number cfl 1 thus a time step δt of l pp 100v 0 was used in the bare hull simulations which was consistent with the minimum grid spacing δmin note that v 0 refers to the ship speed moreover a two steps calculation strategy yang et al 2014 was employed during the self propulsion simulations step1 a larger time step l pp 100v 0 was used at the initial stage to simulate the free surface elevation and the rotational speed of the impeller was maintained zero step 2 a relatively slow acceleration was imparted to the impeller to speed up the convergence to achieve the self propulsion point and the time step δt for each rotational speed was maintained at 2 per step the different time step s effect on the computed forces was negligible as the maximum time step value l pp 100v 0 had met the demand of cfl number both in bare hull and self propulsion simulations five inner iterations were used for the convergence of the flow field equations within each time step pressure equation convergence is reached when the residual imbalance of the poisson equation drops by six orders of magnitude all other variables are assumed converged when the residuals drop to 10 5 2 2 3 grid sensitivity verification to assess the numerical uncertainty of the simulations a suite of meshes was generated to quantitatively test the grid sensitivity where δt δmin was kept constant to ensure that the cfl number was also kept constant for all grid schemes the two grid assessment procedure proposed by roache 1997 was used to evaluate grid sensitivity in these cases grid convergence analysis was performed using the total resistance coefficient c r dynamic sinkage h e and trim t r in the bare hull cases while the iw q ji and ow q jo flow rates were used in the self propulsion cases values of q ji and q jo are normalised by q 0 which corresponds to the maximum volume flow rate obtained from the inner waterjet for fr 0 5 under operation at spp the disposal of an unstructured mesh is described in baek et al 2015 in a similar manner the refinement ratio r 0 was considered as a function of the total number of cells to uniformly refine the grid the function is as follows 1 r 0 n f i n e n m e d i u m 1 d where n denotes the total number of cells in the grid and d denotes the dimensionality of the problem d 3 the error of the fine grid is estimated as follows 2 e f 2 f 1 1 r 0 p 0 where f 1 and f 2 respectively denote the solutions on the fine and medium grids r 0 denotes the mesh refinement factor r 0 1 2 and p 0 denotes the formal order of accuracy p 0 2 the uncertainty is evaluated as follows 3 u n f s e where f s denotes a safety factor that is assumed to equal 3 di mascio et al 2014 computational results obtained from the medium and fine meshes are listed in table 2 based on the values of medium and fine mesh systems extr represented the predicted values of finer grid system employing the same refinement ratio with linear extrapolation and the uncertainties u n were normalised by extr it is shown in table 2 that the u n values of the dynamic sinkage and trim are considered as slightly excessive u n 9 and 12 in the bare hull and self propulsion cases it is expected that this is associated with the attitude dynamic of the ship for fr 0 4 the results in table 2 indicate that a considerable difference exists between the predicted flow rates for iw and ow this difference is related to the different ingested flow conditions in station 1a the dead rise angle of the hull near the stern refer section 3 3 1 leads to non homogeneous boundary layer distribution from inboard to bilge area on the other hand the existence of the stabilizer fins induces local vortices and further alters the velocity distribution in the capture areas of iw and ow however when compared against the experimental results described in section 3 2 simulation predictions were observed to be considerably reliable with a numerical uncertainty of u n 6 thus the fine grid system was adopted in the following analysis 3 results and discussion 3 1 definitions of hydrodynamic performance of waterjet hull system recommended procedures and guidelines for marine vehicles with waterjets were specified by the ittc ittc 25th 2008 the control volume approach was employed in which eight stations from station 1a to station 7 see fig 5 were defined and measured pressure or velocity in order to calculate the momentum flux and thrust the differential pressure transducers dpts method was introduced in the recommended procedures and used in the present study when measuring the flow rates the procedures in the waterjet propulsion test to confirm the self propulsion point are the same as those in the self propulsion test for ships with conventional propellers eslamdoost et al 2018 the skin friction correction force f d was calculated on the basis of the bare hull resistance results while considering the differences between the full and model scale frictional resistance coefficients in accordance with recommended procedures to be followed during the self propulsion test sheng and liu 2011 the tow force f which is measured by means of the resistance dynamometer should locate in the range of 0 1 2f d under different rotational speeds for one advance speed operation at the self propulsion point spp is realized when f f d via interpolation 4 f d r m ρ m ρ s r s λ 3 where ρ m and ρ s respectively denote the density of water in the towing tank and actual sea conditions and λ is the scale factor r m and r s respectively denote the total resistances of the model and the full scale ship r s is obtained according to the 2014 ittc recommended procedure of the resistance test ittc 2014 as illustrated in section 2 1 two micro pulsating pressure transducers were used as a group to measure the dynamic pressures under spp calculating the flow rates of two waterjets the nozzle corresponds to a contracted contour tube and by measuring the average dynamic pressures p 1 and p 2 an expression of theoretical flow rate q jt can be obtained on the basis of the continuity equation for incompressible flow 5 q j t v 1 a 1 v 2 a 2 on the other hand bernoulli equation is assumed to hold along the centre streamline of the nozzle white 1998 6 p 1 1 2 ρ v 1 2 ρ g h 1 p 2 1 2 ρ v 2 2 ρ g h 2 where a 1 and a 2 are the areas of flow passing surfaces in two positions and v 1 and v 2 are the velocities of the two sections the tube is horizontal so h 1 h 2 combining equations 5 and 6 the theoretical flow rate q jt is expressed as follows 7 q j t 2 p 1 p 2 a 1 2 a 2 2 ρ a 1 2 a 2 2 the flow rate measured using the dpts method was calibrated prior to performing the propulsion test the calibration process was performed in the bollard pull test by means of mass flow measurement through weighing the flow discharged from the nozzle over a time interval δt was collected via a hose connected to a collecting tank placed behind the model and the mass δm of the collected water was measured the volume flow rate q jt obtained through use of the dpts method was calculated using equation 7 then the calibration factor c 0 could be defined as 8 c 0 δ m ρ δ t q j t thus the volume flow rate q j can be expressed as 9 q j c 0 2 p 1 p 2 a 1 2 a 2 2 ρ a 1 2 a 2 2 according to the recommended procedures and guidelines of ittc ittc 24th 2005 the gross thrust t g can be calculated according to the change in momentum flux from station 1a through station 6 nozzle in the x direction the gross thrust t g is defined by 10 t g m j m i ρ q j c m 6 v x 6 a 0 ρ v x 2 d a where m j and m i represent the momentum flux from the nozzle and station 1a q j denotes the flow rate through the waterjet system a 0 denotes the capture area and v x denotes the axial velocity distribution in a 0 the parameter c m6 represents momentum correction factor defined as 11 c m 6 1 a 6 a 6 v x 6 v x 6 2 d a where a 6 denotes the nozzle area v x6 denotes the local axial velocity and v x 6 denotes the area weighted average of v x6 over a 6 the value of c m6 is obtained from the cfd calculation as a reference specifically the thrust deduction fraction and energy momentum velocity coefficients are defined to quantitatively describe the waterjet hull interaction the thrust deduction fraction t of a waterjet propelled craft is calculated basing on the gross thrust and t is defined as follows 12 t 1 r m f d t g the energy velocity coefficient c e and momentum velocity coefficient c m are used to represent the hull s influence on the inflow in the capture area of the waterjet based on the axial velocity distribution in the capture area c e and c m are calculated as follows 13 c e 1 v 0 2 a 0 v x 3 d a a 0 v x d a 14 c m 1 v 0 a 0 v x 2 d a a 0 v x d a where a 0 and v x have been defined earlier in equation 10 3 2 comparison of model test and cfd results firstly the resistance heave and pitch curves of the bare hull simulations were compared with the experimental results as a preliminary verification of the cfd simulations moreover numerical pulsating pressures recorded by four probes at the nozzles were compared directly with pressures recorded in the propulsion test in order to verify the accuracy of the self propelled simulations the total resistance r m dynamic sinkage h e measured at half l pp and trim t r were monitored for all numerical cases across the speed range fr 0 2 0 534 the dynamic sinkage was defined as positive when the hull moved upward and the trim was defined as positive when the stern moved downward as shown in fig 6 r m exhibited good agreement with the experimental data for all speeds with an average difference of 1 98 d d denotes experimental data for lower speeds 0 2 fr 0 334 and 3 89 d for medium speeds 0 334 fr 0 534 the dynamic sinkage and trim fig 7 exhibited the same trends with the experimental results both in bare hull bh and self propulsion sp simulations however the average difference for h e and t r in medium speeds fr 0 4 were slightly larger than those in lower speeds similar to the results of takai et al 2011 the cfd computations under predicted the sinkage and over predicted the trim angle even so the cfd simulations provided acceptable results overall regarding the resistance of the ship and correctly captured the heave and pitch motion tendencies over the tested speed range as stated earlier two groups of micro pulsating pressure transducers were installed on the nozzle in order to measure flow rate q j in the self propelled simulations the pulsating pressures recorded by four probes in the corresponding positions were monitored to form a direct comparison fig 8 illustrates the comparison between simulated and measured pulsating pressures in the time domain from p1 to p4 fig 2 b they were carried out for fr 0 3 0 4 and 0 534 labelled from a to c with the rotational speed at spp table 3 shows a comparison of average pressures for p1 to p4 and the flow rates of iw and ow as shown in fig 8 a the cfd results were similar to the experimental results from p1 to p4 for fr 0 3 stronger numerical diffusion occurred during higher speed conditions and the differences between the measured pressures were gradually increased the average relative error reached a maximum value of 14 88 in p4 for fr 0 534 see table 3 values of flow rates obtained via cfd were calculated by performing velocity integration within the nozzle to provide more accurate values except for the inner waterjet value for fr 0 5 most of the relative errors of the numerical flow rates of iw and ow remained under 4 when compared against experimental data thereby demonstrating an acceptable accuracy of the self propulsion simulations 3 3 discrepancies analysis of iw and ow 3 3 1 flow rates volume flow rates corresponding to iw and ow are compared at the spp for varying ship speeds fr 0 167 to 0 534 fig 9 shows the non dimensional measured flow rates q j q 0 for iw and ow the values were normalised by dividing the maximum flow rate q 0 for fr 0 534 iw the iw and ow flow rates increase gradually with increases in advanced speed it is noticeable that ow flow rates were consistently lower than those of iw within the range of advanced speeds the relative errors for all speeds varies from 5 44 to 13 28 all waterjets provide the demanded total thrust to balance the resistance of the ship the differences illustrated above are considered to be related to the matching of the waterjet hull system and the installation locations of the waterjets the plan line of the hull was designed with a dead rise angle α near the stern see fig 10 the position of the shaft of the outer waterjet was lifted to fit the hull resulting in a shaft height differenceδh between the iw and ow fig 11 shows the non dimensional axial velocity distributions v x v 0 in station 1a without and with stabilizer fins the dead rise angle α resulted in non homogeneous boundary layer distribution in station 1a see fig 11 a the influence of the stabilizer fins was excluded the boundary layer thickness gradually decreased from the inboard to the bilge area the existence of stabilizer fins further increased the nonuniformity by inducing local vortices and thus changed the velocity distribution see fig 11 b circle a and b in station 1a on the other hand the shaft height differenceδh influenced the head rise h directly this was related to the flow rates in addition the immersed depth of the inner waterjet was always greater than that of the outer one which had a direct effect on the power conversion capability of the waterjet according to the momentum flux method for waterjet propelled ships the flow rate determines the waterjet s thrust directly therefore it is necessary to conduct a deeper investigation into the difference in propulsion performance between the iws and ows 3 3 2 gross thrust and thrust deduction the gross thrust t g was calculated according to the change in momentum flux through station 1a to the nozzle exit in the x direction as illustrated in equation 8 the determination of the ingested momentum flux through station 1a was obtained by integration of the velocity distribution in the capture area a 0 which was obtained from the piv test using the velocity integral in station 1a and flow rate measurement from station 6 see fig 5 the geometric shape semi ellipse was confirmed when the flow rate of the capture area equals that of the nozzle iws and ows contributed differently amounts of thrust to the total gross thrust under spp the relative magnitudes of gross thrust t g iw t g ow contributed by iws and ows and the computational torque values t or iw t or ow are depicted in fig 12 it is clear that iws provided greater thrust by 18 4 efd and 15 9 cfd on average compared to ows under identical input rotational speeds in addition a direct comparison of thrust values clarifies that the gross thrust of iws is significantly higher 7 2 13 1 than that of ows at low advance speeds 0 167 fr 0 4 and it declines to 5 1 7 4 for 0 4 fr 0 534 on the other hand the observed torque difference is rather small as the value of t or iw t or ow remains approximately equal to 1 for all speeds this indicates that the output power of iws is larger compared to that of ows under identical input power conditions at low speeds and that the difference between them gradually declines with the increase in advanced speed the thrust deduction fraction data is calculated based on the bare hull resistance external tow force and total gross thrust for fr 0 167 0 534 fig 13 shows that the waterjets effect on the resistance of the hull differed with the advanced speeds large positive values for t were observed in low speed ranges fr 0 3 t decreased toward zero for 0 3 fr 0 4 then exhibited small negative values in the high speed range 0 4 fr 0 534 the computed t values are lower than the measured ones over the speed range and maximum difference between the two was observed when fr 0 534 the negative t values were caused by the jet system thrust deduction as reported in eslamdoost et al 2018 3 3 3 flow fields to further analyse the hydrodynamic performance discrepancies between iws and ows the internal flow field characteristics of iws and ows were compared to provide additional auxiliary information additionally the flow around the hull was analysed to reveal the physical mechanism behind the waterjet hull interaction behaviour the following portion of the paper compares the velocity distributions of station 1a x l pp 0 09 and station 3 x l pp 0 03 for the inner and outer waterjets station 1a is defined as the inflow capture area and is located one pump diameter ahead of the inlet tangency while station 3 is defined as the inflow plane of the pump in accordance with ittc guidelines ittc 24th 2005 the inlet velocity distributions in station 1a were compared and analysed for the bare hull cases the piv tests were conducted in the bare hull resistance tests which provided experimental verification for the flow field accuracy of the numerical simulations fig 14 compares the piv results and cfd computations in terms of the non dimensional axial velocity contours v x v 0 in the capture area for fr 0 3 0 4 and 0 534 the coordinate axis of the velocity contours were normalised by l pp where y l pp 0 corresponds to the central longitudinal section the laminar bottom data obtained from the piv measurements was distorted and was therefore replaced by grey bars gong et al 2019 the velocity distribution in the laminar layer was assumed to follow the one seventh power law in the calculation of tested c e and c m white 1998 the outlines of the hull at station 1a for the three speeds are different because of the heave and pitch motions of the ship model the capture area geometry of cfd cases was determined based on the ingested inflow which was determined by backward tracing of the streamlines from the impeller surface in self propulsion simulations fig 15 shows the capture areas in self propulsion simulations for fr 0 4 case under spp in station 1a the vortex structures around the hull were visualized by means of q criterion wu 2013 in fig 16 it was observed that the visualized capture area of ow was more narrow and higher than that of iw which reflected the influence of stabilizer fins both piv and cfd results demonstrate that the effect of the induced flow in the capture area are apparently different for iws and ows cfd based and experimentally obtained values of the non dimensional velocity at mid sections of the capture area of iw y l pp 0 012 and ow y l pp 0 036 are plotted in fig 17 the velocity demonstrates increased stability along the depth direction negative z for iw while values of the same slightly fluctuate in the bottom half of the ow capture area owing to the presence of small scale vortices and noisy velocities the measured contour lines are not as smooth as the numerical results for the iws the turbulence boundary layers at station 1a provide relatively high accuracy and the velocity distribution reflects a consistency between the experimental and numerical results however the difference between the piv and cfd results is distinguished by the increasing reynolds number for the ows the gradient of the ow velocity distribution is clearly larger than that of the iws which indicates a higher inhomogeneity in the inflow c e and c m are summarised in table 4 including the numerical results of bare hull cases cfd and the experimental results piv the predictions from the cfd results agree well with the piv measured results with only a slight quantitative difference both c e and c m of the ows are apparently smaller than those of the iws which indicates that the hull has a stronger negative effect on the ows inflow as mentioned in section 2 1 two sets of stabilizer fins were mounted on the hull the tip vortices generated by these fins convect downstream and alters the velocity distribution of the capture area the uniformity of the capture areas is therefore affected as the stabilizer fin vortex passed through the capture area of the outer waterjet and smaller c e and c m values are obtained for ow in comparison to iw based on this consideration trends observed in fig 17 can also be explained although there exist certain differences with regards to flow details in certain areas values of the energy momentum velocity coefficients obtained in the capture area were observed to be consistent between the cfd simulations and piv tests for the perspective of the internal flow field fig 18 shows the detailed flow characteristics at several longitudinal and transverse sections inside the inner waterjet for the fr 0 4 case under spp the ingested flow gets discharged by the nozzle at high speeds as it absorbs the power delivered by the impeller see fig 18 a the distribution of v x v 0 between each blade phase remains consistent across the impeller fig 18 b and stator plane fig 18 c it is noted that the low speed region located in the middle of the stator and nozzle planes fig 18 d after the stator rectification additionally fig 19 shows the calculated non dimensional axial velocity v x v 0 of iws and ows at station 3 for cases corresponding to fr 0 3 0 4 and 0 534 the non dimensional velocity distributions of iws and ows both showed consistency in terms of inflow characteristics the shape and location of the high velocity flow distributed near the bottom dead centre bdc and the velocity distribution in the lower half disk were greater than those of the upper half disk owing to the shaft retardation the axial velocity gradually decreased from the circumference to the shaft surface additionally there exist some differences between local velocity distributions for iws and ows in that of the high and low velocity regions of ow remain most concentrated whereas a gradual velocity transition is observed in iw thereby indicating that iw velocity distribution demonstrates greater uniformity compared to that of the ow however the ingested flow of iw and ow becomes fully developed under high speed conditions thereby causing flow field differences to reduce as the advance speed increases from fr 0 3 to fr 0 54 as described in section 3 3 2 the gross thrust discrepancies between iws and ows for fr 0 3 0 4 and 0 534 were gradually diminished therefore the above analysis provided an auxiliary explanation for the flow rates and gross thrust results and better revealed the flow mechanism of a ship propelled by four waterjets the experimental and numerical jet streams and wake elevations are compared in fig 20 because the geometric model and test conditions were completely consistent and finer girds were distributed in the nozzle and wake regions the numerical jet stream morphology and wake elevations were very close to those in the self propulsion test the jet stream travelled a long distance before hitting the transom wake in higher speeds strong interference was observed between the jet streams and the tailing flow from a transom stern owing to limitations with regard to grid resolution it was difficult for the numerical simulations to accurately capture the finer flow phenomenon manifested during model test e g jet diffusion and the splash zone 4 conclusion using a combined experimental and numerical approach this study analysed how waterjet hull interaction affects the propulsion performance of a self propelled ship with four waterjets the thrust deduction fraction as well as energy and momentum velocity coefficients were determined to quantitatively describe the waterjet hull interaction self propulsion tests were carried out to investigate the flow rates and gross thrust values corresponding to inner and outer waterjets further numerical simulations were conducted for bare hull and self propulsion conditions using a discretised impeller stator with dynamic overset grids major conclusions drawn from this study are listed as follows 1 ow flow rates consistently measured lower compared to those of iws within the considered range of advance speeds albeit the said difference gradually declined when the inflow was fully developed under high speed operation 2 observed differences between thrusts obtained from iws and ows demonstrated a direct impact on the total gross thrust under spp conditions iws provided greater thrust on average 18 4 efd and 15 9 cfd compared to ows under identical input rotational speeds the thrust deduction fraction demonstrated small negative values close to 0 05 under high speed conditions 3 consistency was observed in terms of energy and momentum velocity coefficient values between numerical and piv measured results which in turn validated the flow field accuracy of the rans computations additionally the effect of the stabilizer fin vortex on ow inflow was verified by the fact that its c e and c m values were smaller than those of iw 4 difference in inlet duct design of the waterjet hull system as well as the influence of the stabilizer fins lead to manifestation of different interaction behaviours thereby resulting in discrepancies in propulsion performance of a four waterjet propelled system a clear understanding of the above mentioned propulsion performance differences is a must to take full advantage of the same in engineering practice because our research was conducted and analysed based on experimental and numerical results obtained for a model scale subsequent studies would use these findings to investigate the scale effect of the waterjet hull interaction on the propulsion performance acknowledgments this work was in response to the research project titled high technology ship scientific research project performed by ministry of industry and information technology miit2016 26 china and the foundation of key laboratory of defense science and technology for equipment pre research china grant no 61422230203182223010 the authors would like to acknowledge the help and support by prof nhan phan thien prof boo cheong khoo and dr wang di from national university of singapore nus funding this work was supported by the national natural science foundation of china grant numbers 51679052 51639004 and 51709060 
22860,waterjet hull interaction has different effects on the propulsion performance of the outer and inner waterjets in ships propelled by four waterjets the dead rise angle of the hull lines near the stern leads to different inflow characteristics in the capture areas of individual waterjets to better understand these effects self propulsion tests were performed to investigate the thrust deduction fraction and energy momentum velocity coefficients and numerical simulations of unsteady multiphase flows were conducted using a discretised impeller stator with dynamic overset grids results obtained indicate that the flow rates and gross thrust of inner waterjets were greater than those of the outer waterjets under the same rotational speeds and that these differences gradually decreased with increases in the advanced speed the hull had a stronger negative effect on the inflow of the outer waterjet because its energy momentum velocity coefficients were smaller than those of the inner waterjets additionally flow field analysis of the capture area verified the quality of the computations and internal flow field analysis provided additional validation of observed results it was found that the inlet duct design and the presence of stabilizer fins caused different interaction behaviours resulting in the propulsion performance discrepancies observed in four waterjet systems keywords waterjet hull interaction propulsion thrust deduction flow filed characteristics 1 introduction waterjets provide higher propulsive efficiency less vibration and better manoeuvrability compared to conventional propellers and are thus extensively applied in high speed ships in operating at speeds excess of 30 knots molland et al 2017 with the increasing tonnage and size of high speed ships waterjet propulsion must provide higher output power to meet speed demands to this end ships utilizing waterjet propulsion systems generally adopt multiple waterjets two to four to provide sufficient thrust at a high efficiency in limited installation spaces consequently the resulting interaction between multiple waterjet propulsion and hull systems becomes exceedingly complicated and its complete understanding requires in depth investigations to be performed the international towing tank conference ittc set up the waterjet specialist committee in 1993 and more recently has summarised several recommended procedures for marine vehicles with waterjets ittc 25th 2008 ittc 26th 2011 waterjet hull interaction is the core concern of scholars focused on self propulsion analysis coop 1995 van terwisga 1996 eslamdoost 2014 some of their research and recommendations were adopted by the ittc and continuous improvements have been added to perfect the procedures coop 1995 investigated the effects of interaction between a waterjet featuring a flush type intake and a planing hull in both model scale and full scale the thrust deduction characteristics and interaction forces were measured and reported while an analytical propulsion model was constructed to incorporate the waterjet momentum forces moreover the mechanisms possibly contributing to the overall interaction effect were discussed van terwisga 1996 developed a complete study on waterjet hull interaction in his doctoral thesis and utilised analytical numerical and experimental methods he explained the difference between gross thrust and net thrust and specified the negative thrust deduction fraction of a waterjet propelled ship bulten 2006 conducted a waterjet test in a cavitation tunnel and performed detailed investigations both experimentally and numerically he measured the velocity distribution of an impeller plane with a three hole pitot tube and revealed non uniform characteristics of the inflow pattern rispin 2007 studied the effect of model scale on the boundary layer thickness of a demi hull with two waterjets he found that the velocity distributions of the capture area and the thrust deduction fraction were influenced by the scale jessup et al 2008 conducted model tests and a detailed power analysis of a joint high speed sealift jhss which was propelled by four axial flow waterjets the experiments included detailed laser doppler velocimetry ldv measurements at different stations ldv provided a superior presentation detailing the flow non uniformities at each station gong et al 2017 applied particle image velocimetry piv techniques to measure the velocity distribution of the capture area in the mid body of a trimaran with a pair of waterjet units they pointed out that the motion of the ship during the piv test affected the measured results of the capture area their research provided some guidance for employing piv applications in waterjet propelled vessels eslamdoost et al 2018 studied the thrust deduction fraction of a waterjet propelled hull in a wide range of speeds and clarified the reasons for the large variation in the fraction they concluded that the jet system thrust deduction fraction was the main reason for the negative thrust deduction recent progress in computational fluid dynamics cfd techniques has enabled faster and more effective approaches for predicting waterjet hull interactions takai 2010 investigated the flow fields for a bare hull and the self propelled conditions of the jhss employing the unsteady reynolds averaged navier stokes urans solver cfdship iowa detailed cfd verification and validation analysis of the jhss were performed by takai et al 2011 kandasamy et al 2010 developed an integral force moment waterjet model and applied it by using cfdship iowa to analyse the local flow and powering of ships eslamdoost et al 2014 presented a pressure jump method for modelling waterjet hull interaction based on potential flow theory and identified the major parameters which contributed to waterjet hull interaction eslamdoost 2014 additionally they investigated the difference between the net thrust and gross thrust of a waterjet unit through a rans study eslamdoost et al 2016 and summarised the mechanism of thrust deduction in a more recent study eslamdoost et al 2018 many previous studies have contributed to the understanding of waterjet hull interactions via experimental and numerical analyses however the hydrodynamic performance of individual waterjets may be different since a dedicated inlet duct design must be performed to facilitate accurate alignment of a ship s operational profile with the optimum point of waterjet operation especially in the case of ships characterised by varying hull lines near the locations of waterjet installation the dead rise angle of the hull lines near the stern leads to different inflow characteristics in the capture areas of different waterjets also initial immersed depth of the waterjets influences the efficiency and output power of the waterjets mounted on the hull waterjet hull interaction has different effects on the propulsion performance of individual waterjets in a multiple waterjet system thus the goal of the present study is to investigate how waterjet hull interaction affects the propulsion performance of a self propelled ship with four waterjets the inflow characteristics of the capture area and the gross thrust are analysed to quantitatively verify this complex interaction this remainder of this study is organised as follows the model tests and cfd setup are described in section 2 section 3 describes a comparison of the experimental and numerical results and contains a detailed analysis comparing the inner waterjets and outer waterjets finally conclusions are presented in section 4 2 model test and cfd setup 2 1 design of self propulsion test self propulsion tests were conducted in a large 108 7 3 5 m towing tank at harbin engineering university the four component motion measuring device and the underwater particle image velocimetry piv devices were used for data collection the experiments included resistance self propulsion and piv tests for a ship model with four waterjets a medium speed mono hull ship with two sets of stabilizer fins was chosen for the experiments a deep v hull form with a transom stern was adopted in the ship design and four flush type waterjets were selected for the propulsion system fig 1 to indicate the different positions of the four mixed flow waterjets they were defined as inner waterjets iw and outer waterjets ow see fig 1 c the main parameters of the ship and waterjet models are presented in table 1 in the self propulsion test the impeller rpm range could fully cover the full scale performance across the model speed range fr 0 167 to 0 534 r e 2 01 106 to 3 79 106 to achieve the self propulsion point spp four waterjets maintain the same rotational speed during the experiment as the most critical quantity the volume flow rate q j through the waterjet system was determined indirectly using differential pressure transducers dpts two micro pulsating pressure transducers pt1 and pt2 were installed in different longitudinal positions as a group both perpendicular to the nozzle slope and 30 from the vertical direction see fig 2 a the precision level of the pressure transducer was 0 25 and the probe diameter was 5 0 mm two groups of transducers denoted as p1 through p4 were mounted on the iws and ows in order to measure the volume flow rate fig 2 b calibration of the dpts method was performed prior to commencement of the self propulsion test and described in subsequent section 3 1 to confirm the repeatability and reliability of the dpts methods the precision limit p m of the measured flow rates measured during multiple tests was analysed using the relation p m ks dev m 1 2 ittc 2011 where m denotes the number of runs s dev denotes the sample standard deviation and k is called coverage factor the value of which approximately equals 2 at a forward speed corresponding to fr 0 4 during the three repeated tests the precision limits of the flow rates were observed to be 0 37 and 0 42 for the inner and outer waterjets respectively a vehicle mounted three dimensional underwater stereo piv device was used to measure the inlet velocity distribution for fr 0 3 0 4 and 0 534 for the waterjet propelled ship model gong et al 2019 the coverage area of the piv camera was rectangular with a size of approximately 260 320 mm2 as determined after the calibration process this was sufficient to cover the target capture area of the iw and ow the sampling frequency was 7 5 hz in the piv test and a total of 250 particle image pairs were captured for each speed the piv tests were carried out in the resistance test to measure the velocity distribution of the capture area which was used to calculate the energy momentum velocity coefficients c e and c m additionally the results obtained from the piv test were used to evaluate the accuracy of the computational flow fields 2 2 numerical model cfd simulations were performed using the unsteady rans flow solver star ccm 11 04 the multiphase air water three dimensional flows including free surface effects were established to analyse the hydrodynamic performance in both the bare hull and self propulsion simulations in terms of motion two degrees of freedom heave and pitch and free surface effects were considered in order to maintain consistency with the experimental conditions in addition the waterjet components including the shaft impeller stator and channel were discretised in the numerical simulations to investigate differences between the complex internal flow fields of the iws and ows 2 2 1 governing equations and turbulence model the governing equations for the turbulent flow field around the waterjet hull system comprised the instantaneous conservation of mass continuity equation and momentum rans for an incompressible newtonian fluid wang 2004 an additional equation is needed to solve the unknown reynolds stress the turbulence model is a closure equation that combines the fluctuating time averages in this study the shear stress transport sst k ω turbulence model is selected for all simulations because it combines the advantages of the standard k ω and standard k ε models and exhibits good behaviour in calculating the separating flow menter 1994 the governing equations and the transport equations of turbulence model are discretised using the finite volume method with a second order upwind scheme while pressure velocity coupling is facilitated through the simple algorithm the time terms are discretised using second order implicit time discretisation 2 2 2 grid system and boundary conditions to save computational resources and improve efficiency only half of the ship hull was used for bare hull simulations and thus only two of the waterjets were included for self propulsion simulations with respect to the computational coordinate system a cartesian earth fixed coordinates o xyz were used and defined as follows the positive direction of the x axis indicated the direction from the bow to the stern of the ship the positive direction of the y axis indicated the direction from mid ship to the port side and the positive direction of the z axis indicated the direction from the bottom of the ship to its deck see fig 1 the dimensions of the computational domain see fig 3 along the three directions were 2 5l pp x 4l pp 0 0 y 2l pp and 2 0l pp z 1 0l pp the boundary conditions of the computational domain were set as follows a symmetry boundary condition of y 0 was adopted the inlet was the velocity inlet as were the top sides and bottom wang et al 2015 gong et al 2018 which simulated infinite far field boundary conditions the outlet was the pressure outlet the mid ship section was a symmetry plane and the hull channels impellers shafts stators and nozzles were non slip surfaces for the self propelled simulations the overset grid technique was used to simulate the rotation of the impeller and coupled with the motion of ship model the overset grid technique can help mitigate the effects of the very small gap between the blade tips and wall boundary and it is an effective solution for calculating unsteady problems see fig 4 c an overset grid allows complex regions to be replaced with multiple overlapping body conforming curvilinear grids the overset grid divides a computed flow regime into several sub regimes thus enhancing the flexibility of grid generation this allows component grids to be added in a mutually independent manner therefore grid connectivity only has to be updated locally and information is propagated through the embedding and overlapping of each regional grid while interpolations are used to couple information from the boundary flow fields of the overset grids koblitz et al 2017 the overset grids were widely used in previous self propulsion simulations carrica et al 2010 castro et al 2011 shen et al 2015 the overset grid approach divides the computational domain into three subdomains one static region and two rotational regions and the overset regions are coupled to the background region using the overset mesh interface it is necessary to consider the level of discretisation in the special regions of the computational region during meshing the cartesian cut cell method was used to generate the unstructured computational grids with a boundary layer that consisted of a prism layer mesh and trimmed mesh the cell size of the computational domain should transition in a gradual manner to avoid numerical dissipations the surface mesh of the waterjet hull system is shown in fig 4 three refinement volumes were used around the hull with gradually changed isotropic sizes of 3 l pp 1 5 l pp and 0 75 l pp in order to improve the simulation precision of the non uniform flow field and capture the free surface more accurately three refinement volumes were applied in the gas liquid interface areas with finer sizes 0 375 l pp 0 187 l pp and 0 094 l pp in the z direction in addition several refinement volumes were set near the stern and trailing flow region to capture the flow details to maintain consistency throughout the simulations the mesh size and mesh distribution around the hull were kept almost the same during the self propulsion and bare hull simulations for the rotational regions in self propulsion simulations even finer grid sizes were employed to discretise the blade surfaces of the impeller and stator with a minimum size of 0 5 d i further the blade surfaces were refined along the feature lines of the leading and trailing edges with respect to the volume mesh a refinement volume was employed in the static region to better discretise the region inside the pump with an isotropic size of 2 d i also a cylindrical refinement volume was employed in the static region isotropic size of 1 d i to match the overset mesh size in the rotational region with an isotropic size of 0 25 d i the tip clearance region about 2 mm between the channel and impeller blade tips was further discretised in addition the boundary layer thickness δ of the hull was estimated according to the theory of flat plate boundary layer white 1998 ten prism layers were computed and meshed near the surfaces with a total thickness equals to the estimated δ 1 26 1 37 l pp finally the total number of cells in the fine grid was 12 67 million while the static and rotational sub domains contained 9 95 million and 2 72 million cells respectively the volume of fluid vof model was utilised to capture the free surface hirt and nichols 1981 the high resolution interface capturing hric scheme was used to capture the free surface in star ccm böhm and graf 2014 the dynamic fluid body interaction dfbi model was employed to simulate the motion of the ship ohmori 1998 it was important that the time step size satisfied the demands of the courant friedrichs levy number cfl 1 thus a time step δt of l pp 100v 0 was used in the bare hull simulations which was consistent with the minimum grid spacing δmin note that v 0 refers to the ship speed moreover a two steps calculation strategy yang et al 2014 was employed during the self propulsion simulations step1 a larger time step l pp 100v 0 was used at the initial stage to simulate the free surface elevation and the rotational speed of the impeller was maintained zero step 2 a relatively slow acceleration was imparted to the impeller to speed up the convergence to achieve the self propulsion point and the time step δt for each rotational speed was maintained at 2 per step the different time step s effect on the computed forces was negligible as the maximum time step value l pp 100v 0 had met the demand of cfl number both in bare hull and self propulsion simulations five inner iterations were used for the convergence of the flow field equations within each time step pressure equation convergence is reached when the residual imbalance of the poisson equation drops by six orders of magnitude all other variables are assumed converged when the residuals drop to 10 5 2 2 3 grid sensitivity verification to assess the numerical uncertainty of the simulations a suite of meshes was generated to quantitatively test the grid sensitivity where δt δmin was kept constant to ensure that the cfl number was also kept constant for all grid schemes the two grid assessment procedure proposed by roache 1997 was used to evaluate grid sensitivity in these cases grid convergence analysis was performed using the total resistance coefficient c r dynamic sinkage h e and trim t r in the bare hull cases while the iw q ji and ow q jo flow rates were used in the self propulsion cases values of q ji and q jo are normalised by q 0 which corresponds to the maximum volume flow rate obtained from the inner waterjet for fr 0 5 under operation at spp the disposal of an unstructured mesh is described in baek et al 2015 in a similar manner the refinement ratio r 0 was considered as a function of the total number of cells to uniformly refine the grid the function is as follows 1 r 0 n f i n e n m e d i u m 1 d where n denotes the total number of cells in the grid and d denotes the dimensionality of the problem d 3 the error of the fine grid is estimated as follows 2 e f 2 f 1 1 r 0 p 0 where f 1 and f 2 respectively denote the solutions on the fine and medium grids r 0 denotes the mesh refinement factor r 0 1 2 and p 0 denotes the formal order of accuracy p 0 2 the uncertainty is evaluated as follows 3 u n f s e where f s denotes a safety factor that is assumed to equal 3 di mascio et al 2014 computational results obtained from the medium and fine meshes are listed in table 2 based on the values of medium and fine mesh systems extr represented the predicted values of finer grid system employing the same refinement ratio with linear extrapolation and the uncertainties u n were normalised by extr it is shown in table 2 that the u n values of the dynamic sinkage and trim are considered as slightly excessive u n 9 and 12 in the bare hull and self propulsion cases it is expected that this is associated with the attitude dynamic of the ship for fr 0 4 the results in table 2 indicate that a considerable difference exists between the predicted flow rates for iw and ow this difference is related to the different ingested flow conditions in station 1a the dead rise angle of the hull near the stern refer section 3 3 1 leads to non homogeneous boundary layer distribution from inboard to bilge area on the other hand the existence of the stabilizer fins induces local vortices and further alters the velocity distribution in the capture areas of iw and ow however when compared against the experimental results described in section 3 2 simulation predictions were observed to be considerably reliable with a numerical uncertainty of u n 6 thus the fine grid system was adopted in the following analysis 3 results and discussion 3 1 definitions of hydrodynamic performance of waterjet hull system recommended procedures and guidelines for marine vehicles with waterjets were specified by the ittc ittc 25th 2008 the control volume approach was employed in which eight stations from station 1a to station 7 see fig 5 were defined and measured pressure or velocity in order to calculate the momentum flux and thrust the differential pressure transducers dpts method was introduced in the recommended procedures and used in the present study when measuring the flow rates the procedures in the waterjet propulsion test to confirm the self propulsion point are the same as those in the self propulsion test for ships with conventional propellers eslamdoost et al 2018 the skin friction correction force f d was calculated on the basis of the bare hull resistance results while considering the differences between the full and model scale frictional resistance coefficients in accordance with recommended procedures to be followed during the self propulsion test sheng and liu 2011 the tow force f which is measured by means of the resistance dynamometer should locate in the range of 0 1 2f d under different rotational speeds for one advance speed operation at the self propulsion point spp is realized when f f d via interpolation 4 f d r m ρ m ρ s r s λ 3 where ρ m and ρ s respectively denote the density of water in the towing tank and actual sea conditions and λ is the scale factor r m and r s respectively denote the total resistances of the model and the full scale ship r s is obtained according to the 2014 ittc recommended procedure of the resistance test ittc 2014 as illustrated in section 2 1 two micro pulsating pressure transducers were used as a group to measure the dynamic pressures under spp calculating the flow rates of two waterjets the nozzle corresponds to a contracted contour tube and by measuring the average dynamic pressures p 1 and p 2 an expression of theoretical flow rate q jt can be obtained on the basis of the continuity equation for incompressible flow 5 q j t v 1 a 1 v 2 a 2 on the other hand bernoulli equation is assumed to hold along the centre streamline of the nozzle white 1998 6 p 1 1 2 ρ v 1 2 ρ g h 1 p 2 1 2 ρ v 2 2 ρ g h 2 where a 1 and a 2 are the areas of flow passing surfaces in two positions and v 1 and v 2 are the velocities of the two sections the tube is horizontal so h 1 h 2 combining equations 5 and 6 the theoretical flow rate q jt is expressed as follows 7 q j t 2 p 1 p 2 a 1 2 a 2 2 ρ a 1 2 a 2 2 the flow rate measured using the dpts method was calibrated prior to performing the propulsion test the calibration process was performed in the bollard pull test by means of mass flow measurement through weighing the flow discharged from the nozzle over a time interval δt was collected via a hose connected to a collecting tank placed behind the model and the mass δm of the collected water was measured the volume flow rate q jt obtained through use of the dpts method was calculated using equation 7 then the calibration factor c 0 could be defined as 8 c 0 δ m ρ δ t q j t thus the volume flow rate q j can be expressed as 9 q j c 0 2 p 1 p 2 a 1 2 a 2 2 ρ a 1 2 a 2 2 according to the recommended procedures and guidelines of ittc ittc 24th 2005 the gross thrust t g can be calculated according to the change in momentum flux from station 1a through station 6 nozzle in the x direction the gross thrust t g is defined by 10 t g m j m i ρ q j c m 6 v x 6 a 0 ρ v x 2 d a where m j and m i represent the momentum flux from the nozzle and station 1a q j denotes the flow rate through the waterjet system a 0 denotes the capture area and v x denotes the axial velocity distribution in a 0 the parameter c m6 represents momentum correction factor defined as 11 c m 6 1 a 6 a 6 v x 6 v x 6 2 d a where a 6 denotes the nozzle area v x6 denotes the local axial velocity and v x 6 denotes the area weighted average of v x6 over a 6 the value of c m6 is obtained from the cfd calculation as a reference specifically the thrust deduction fraction and energy momentum velocity coefficients are defined to quantitatively describe the waterjet hull interaction the thrust deduction fraction t of a waterjet propelled craft is calculated basing on the gross thrust and t is defined as follows 12 t 1 r m f d t g the energy velocity coefficient c e and momentum velocity coefficient c m are used to represent the hull s influence on the inflow in the capture area of the waterjet based on the axial velocity distribution in the capture area c e and c m are calculated as follows 13 c e 1 v 0 2 a 0 v x 3 d a a 0 v x d a 14 c m 1 v 0 a 0 v x 2 d a a 0 v x d a where a 0 and v x have been defined earlier in equation 10 3 2 comparison of model test and cfd results firstly the resistance heave and pitch curves of the bare hull simulations were compared with the experimental results as a preliminary verification of the cfd simulations moreover numerical pulsating pressures recorded by four probes at the nozzles were compared directly with pressures recorded in the propulsion test in order to verify the accuracy of the self propelled simulations the total resistance r m dynamic sinkage h e measured at half l pp and trim t r were monitored for all numerical cases across the speed range fr 0 2 0 534 the dynamic sinkage was defined as positive when the hull moved upward and the trim was defined as positive when the stern moved downward as shown in fig 6 r m exhibited good agreement with the experimental data for all speeds with an average difference of 1 98 d d denotes experimental data for lower speeds 0 2 fr 0 334 and 3 89 d for medium speeds 0 334 fr 0 534 the dynamic sinkage and trim fig 7 exhibited the same trends with the experimental results both in bare hull bh and self propulsion sp simulations however the average difference for h e and t r in medium speeds fr 0 4 were slightly larger than those in lower speeds similar to the results of takai et al 2011 the cfd computations under predicted the sinkage and over predicted the trim angle even so the cfd simulations provided acceptable results overall regarding the resistance of the ship and correctly captured the heave and pitch motion tendencies over the tested speed range as stated earlier two groups of micro pulsating pressure transducers were installed on the nozzle in order to measure flow rate q j in the self propelled simulations the pulsating pressures recorded by four probes in the corresponding positions were monitored to form a direct comparison fig 8 illustrates the comparison between simulated and measured pulsating pressures in the time domain from p1 to p4 fig 2 b they were carried out for fr 0 3 0 4 and 0 534 labelled from a to c with the rotational speed at spp table 3 shows a comparison of average pressures for p1 to p4 and the flow rates of iw and ow as shown in fig 8 a the cfd results were similar to the experimental results from p1 to p4 for fr 0 3 stronger numerical diffusion occurred during higher speed conditions and the differences between the measured pressures were gradually increased the average relative error reached a maximum value of 14 88 in p4 for fr 0 534 see table 3 values of flow rates obtained via cfd were calculated by performing velocity integration within the nozzle to provide more accurate values except for the inner waterjet value for fr 0 5 most of the relative errors of the numerical flow rates of iw and ow remained under 4 when compared against experimental data thereby demonstrating an acceptable accuracy of the self propulsion simulations 3 3 discrepancies analysis of iw and ow 3 3 1 flow rates volume flow rates corresponding to iw and ow are compared at the spp for varying ship speeds fr 0 167 to 0 534 fig 9 shows the non dimensional measured flow rates q j q 0 for iw and ow the values were normalised by dividing the maximum flow rate q 0 for fr 0 534 iw the iw and ow flow rates increase gradually with increases in advanced speed it is noticeable that ow flow rates were consistently lower than those of iw within the range of advanced speeds the relative errors for all speeds varies from 5 44 to 13 28 all waterjets provide the demanded total thrust to balance the resistance of the ship the differences illustrated above are considered to be related to the matching of the waterjet hull system and the installation locations of the waterjets the plan line of the hull was designed with a dead rise angle α near the stern see fig 10 the position of the shaft of the outer waterjet was lifted to fit the hull resulting in a shaft height differenceδh between the iw and ow fig 11 shows the non dimensional axial velocity distributions v x v 0 in station 1a without and with stabilizer fins the dead rise angle α resulted in non homogeneous boundary layer distribution in station 1a see fig 11 a the influence of the stabilizer fins was excluded the boundary layer thickness gradually decreased from the inboard to the bilge area the existence of stabilizer fins further increased the nonuniformity by inducing local vortices and thus changed the velocity distribution see fig 11 b circle a and b in station 1a on the other hand the shaft height differenceδh influenced the head rise h directly this was related to the flow rates in addition the immersed depth of the inner waterjet was always greater than that of the outer one which had a direct effect on the power conversion capability of the waterjet according to the momentum flux method for waterjet propelled ships the flow rate determines the waterjet s thrust directly therefore it is necessary to conduct a deeper investigation into the difference in propulsion performance between the iws and ows 3 3 2 gross thrust and thrust deduction the gross thrust t g was calculated according to the change in momentum flux through station 1a to the nozzle exit in the x direction as illustrated in equation 8 the determination of the ingested momentum flux through station 1a was obtained by integration of the velocity distribution in the capture area a 0 which was obtained from the piv test using the velocity integral in station 1a and flow rate measurement from station 6 see fig 5 the geometric shape semi ellipse was confirmed when the flow rate of the capture area equals that of the nozzle iws and ows contributed differently amounts of thrust to the total gross thrust under spp the relative magnitudes of gross thrust t g iw t g ow contributed by iws and ows and the computational torque values t or iw t or ow are depicted in fig 12 it is clear that iws provided greater thrust by 18 4 efd and 15 9 cfd on average compared to ows under identical input rotational speeds in addition a direct comparison of thrust values clarifies that the gross thrust of iws is significantly higher 7 2 13 1 than that of ows at low advance speeds 0 167 fr 0 4 and it declines to 5 1 7 4 for 0 4 fr 0 534 on the other hand the observed torque difference is rather small as the value of t or iw t or ow remains approximately equal to 1 for all speeds this indicates that the output power of iws is larger compared to that of ows under identical input power conditions at low speeds and that the difference between them gradually declines with the increase in advanced speed the thrust deduction fraction data is calculated based on the bare hull resistance external tow force and total gross thrust for fr 0 167 0 534 fig 13 shows that the waterjets effect on the resistance of the hull differed with the advanced speeds large positive values for t were observed in low speed ranges fr 0 3 t decreased toward zero for 0 3 fr 0 4 then exhibited small negative values in the high speed range 0 4 fr 0 534 the computed t values are lower than the measured ones over the speed range and maximum difference between the two was observed when fr 0 534 the negative t values were caused by the jet system thrust deduction as reported in eslamdoost et al 2018 3 3 3 flow fields to further analyse the hydrodynamic performance discrepancies between iws and ows the internal flow field characteristics of iws and ows were compared to provide additional auxiliary information additionally the flow around the hull was analysed to reveal the physical mechanism behind the waterjet hull interaction behaviour the following portion of the paper compares the velocity distributions of station 1a x l pp 0 09 and station 3 x l pp 0 03 for the inner and outer waterjets station 1a is defined as the inflow capture area and is located one pump diameter ahead of the inlet tangency while station 3 is defined as the inflow plane of the pump in accordance with ittc guidelines ittc 24th 2005 the inlet velocity distributions in station 1a were compared and analysed for the bare hull cases the piv tests were conducted in the bare hull resistance tests which provided experimental verification for the flow field accuracy of the numerical simulations fig 14 compares the piv results and cfd computations in terms of the non dimensional axial velocity contours v x v 0 in the capture area for fr 0 3 0 4 and 0 534 the coordinate axis of the velocity contours were normalised by l pp where y l pp 0 corresponds to the central longitudinal section the laminar bottom data obtained from the piv measurements was distorted and was therefore replaced by grey bars gong et al 2019 the velocity distribution in the laminar layer was assumed to follow the one seventh power law in the calculation of tested c e and c m white 1998 the outlines of the hull at station 1a for the three speeds are different because of the heave and pitch motions of the ship model the capture area geometry of cfd cases was determined based on the ingested inflow which was determined by backward tracing of the streamlines from the impeller surface in self propulsion simulations fig 15 shows the capture areas in self propulsion simulations for fr 0 4 case under spp in station 1a the vortex structures around the hull were visualized by means of q criterion wu 2013 in fig 16 it was observed that the visualized capture area of ow was more narrow and higher than that of iw which reflected the influence of stabilizer fins both piv and cfd results demonstrate that the effect of the induced flow in the capture area are apparently different for iws and ows cfd based and experimentally obtained values of the non dimensional velocity at mid sections of the capture area of iw y l pp 0 012 and ow y l pp 0 036 are plotted in fig 17 the velocity demonstrates increased stability along the depth direction negative z for iw while values of the same slightly fluctuate in the bottom half of the ow capture area owing to the presence of small scale vortices and noisy velocities the measured contour lines are not as smooth as the numerical results for the iws the turbulence boundary layers at station 1a provide relatively high accuracy and the velocity distribution reflects a consistency between the experimental and numerical results however the difference between the piv and cfd results is distinguished by the increasing reynolds number for the ows the gradient of the ow velocity distribution is clearly larger than that of the iws which indicates a higher inhomogeneity in the inflow c e and c m are summarised in table 4 including the numerical results of bare hull cases cfd and the experimental results piv the predictions from the cfd results agree well with the piv measured results with only a slight quantitative difference both c e and c m of the ows are apparently smaller than those of the iws which indicates that the hull has a stronger negative effect on the ows inflow as mentioned in section 2 1 two sets of stabilizer fins were mounted on the hull the tip vortices generated by these fins convect downstream and alters the velocity distribution of the capture area the uniformity of the capture areas is therefore affected as the stabilizer fin vortex passed through the capture area of the outer waterjet and smaller c e and c m values are obtained for ow in comparison to iw based on this consideration trends observed in fig 17 can also be explained although there exist certain differences with regards to flow details in certain areas values of the energy momentum velocity coefficients obtained in the capture area were observed to be consistent between the cfd simulations and piv tests for the perspective of the internal flow field fig 18 shows the detailed flow characteristics at several longitudinal and transverse sections inside the inner waterjet for the fr 0 4 case under spp the ingested flow gets discharged by the nozzle at high speeds as it absorbs the power delivered by the impeller see fig 18 a the distribution of v x v 0 between each blade phase remains consistent across the impeller fig 18 b and stator plane fig 18 c it is noted that the low speed region located in the middle of the stator and nozzle planes fig 18 d after the stator rectification additionally fig 19 shows the calculated non dimensional axial velocity v x v 0 of iws and ows at station 3 for cases corresponding to fr 0 3 0 4 and 0 534 the non dimensional velocity distributions of iws and ows both showed consistency in terms of inflow characteristics the shape and location of the high velocity flow distributed near the bottom dead centre bdc and the velocity distribution in the lower half disk were greater than those of the upper half disk owing to the shaft retardation the axial velocity gradually decreased from the circumference to the shaft surface additionally there exist some differences between local velocity distributions for iws and ows in that of the high and low velocity regions of ow remain most concentrated whereas a gradual velocity transition is observed in iw thereby indicating that iw velocity distribution demonstrates greater uniformity compared to that of the ow however the ingested flow of iw and ow becomes fully developed under high speed conditions thereby causing flow field differences to reduce as the advance speed increases from fr 0 3 to fr 0 54 as described in section 3 3 2 the gross thrust discrepancies between iws and ows for fr 0 3 0 4 and 0 534 were gradually diminished therefore the above analysis provided an auxiliary explanation for the flow rates and gross thrust results and better revealed the flow mechanism of a ship propelled by four waterjets the experimental and numerical jet streams and wake elevations are compared in fig 20 because the geometric model and test conditions were completely consistent and finer girds were distributed in the nozzle and wake regions the numerical jet stream morphology and wake elevations were very close to those in the self propulsion test the jet stream travelled a long distance before hitting the transom wake in higher speeds strong interference was observed between the jet streams and the tailing flow from a transom stern owing to limitations with regard to grid resolution it was difficult for the numerical simulations to accurately capture the finer flow phenomenon manifested during model test e g jet diffusion and the splash zone 4 conclusion using a combined experimental and numerical approach this study analysed how waterjet hull interaction affects the propulsion performance of a self propelled ship with four waterjets the thrust deduction fraction as well as energy and momentum velocity coefficients were determined to quantitatively describe the waterjet hull interaction self propulsion tests were carried out to investigate the flow rates and gross thrust values corresponding to inner and outer waterjets further numerical simulations were conducted for bare hull and self propulsion conditions using a discretised impeller stator with dynamic overset grids major conclusions drawn from this study are listed as follows 1 ow flow rates consistently measured lower compared to those of iws within the considered range of advance speeds albeit the said difference gradually declined when the inflow was fully developed under high speed operation 2 observed differences between thrusts obtained from iws and ows demonstrated a direct impact on the total gross thrust under spp conditions iws provided greater thrust on average 18 4 efd and 15 9 cfd compared to ows under identical input rotational speeds the thrust deduction fraction demonstrated small negative values close to 0 05 under high speed conditions 3 consistency was observed in terms of energy and momentum velocity coefficient values between numerical and piv measured results which in turn validated the flow field accuracy of the rans computations additionally the effect of the stabilizer fin vortex on ow inflow was verified by the fact that its c e and c m values were smaller than those of iw 4 difference in inlet duct design of the waterjet hull system as well as the influence of the stabilizer fins lead to manifestation of different interaction behaviours thereby resulting in discrepancies in propulsion performance of a four waterjet propelled system a clear understanding of the above mentioned propulsion performance differences is a must to take full advantage of the same in engineering practice because our research was conducted and analysed based on experimental and numerical results obtained for a model scale subsequent studies would use these findings to investigate the scale effect of the waterjet hull interaction on the propulsion performance acknowledgments this work was in response to the research project titled high technology ship scientific research project performed by ministry of industry and information technology miit2016 26 china and the foundation of key laboratory of defense science and technology for equipment pre research china grant no 61422230203182223010 the authors would like to acknowledge the help and support by prof nhan phan thien prof boo cheong khoo and dr wang di from national university of singapore nus funding this work was supported by the national natural science foundation of china grant numbers 51679052 51639004 and 51709060 
22861,recently published experimental results show variations in surge and pitch decay periods of floating wind turbines fwts subjected to different incident wind velocities this paper explores the external loads acting on a fwt with special attention to nonlinearities which affect its low frequency global motions the period variations in surge and pitch are found to have different sources in surge the mooring system nonlinearities dominate while for pitch the relative phase between the nacelle velocity and the thrust induced in the rotor leads to an apparent inertia damping effect simplified 2 dof models using linearized stiffness coefficients for surge and modified inertia and damping matrices for pitch are developed comparisons with state of the art aero hydro servo elastic time domain simulations show excellent agreement for three distinct catenary moored fwt designs keywords floating wind turbines mooring systems coupled dynamics 1 introduction floating wind turbines fwts have been proposed as the next generation of offshore wind energy harvesting systems some prototypes have already been deployed with power varying between 2 and 6 mw principlepower 2014 fukushima forward 2016 equinor 2018 while the generous wind resources at deeper waters and the more relaxed constraints in tower and rotor dimensions have resulted in ambitious concepts for supporting 10 mw turbines lifes50 2015 lemmer et al 2016 still several challenges are to be overcome before fwts become technically and commercially feasible in particular the platform construction costs have to be reduced a good understanding of fwt dynamics is necessary for optimal structural design and accurate power production estimates however fwts are complex systems subjected to nonlinear coupled aerodynamic hydrodynamic mooring and controller induced loads prediction of the system responses to different environmental conditions may be complicated and unexpected behavior may be observed depending on the combination of loads one such behavior has been recently observed in fwt model tests first reported in bachynski et al 2016 the natural periods measured in surge and pitch decay tests varied when a scale model fwt was subjected to different incident wind velocities the effect was noticed in both the below and above rated wind velocity regimes another model test campaign goupee et al 2017 reported the same phenomenon but the tests were limited to pitch decay in above rated wind velocities the authors propose a qualitative explanation for the effect based on taylor expansion of the thrust considering the blade pitch control action but do not provide a prediction for the changes nor do they discuss the effect for surge motions in both publications the model fwts corresponded to catenary moored semi submersible platforms low frequency motions are of great importance in the design of a fwt the low frequency components of the aerodynamic thrust second order wave loads and the mooring system loads may excite rigid body responses the observed variations in natural period are therefore particularly important for the mooring system design and tuning of rotor controller gains in addition there is a growing interest in the development of simplified models e g frequency domain approaches that can reproduce fwt dynamics with an acceptable level of accuracy for efficient application in early design iterations lupton 2014 pegalajar jurado et al 2018 an accurate estimation of the decay periods for different operational conditions is necessary for proper tuning of such models ensuring a fair prediction of the rigid body response to linear loads 1 1 background previous expertise and tools from the offshore industry have been adapted for the analysis of fwts dynamics in particular the technology and software for platform structural analysis wave structure interaction and mooring system design ormberg and larsen 1998 introduced a method for simultaneously evaluating the floater motions and fem modelled mooring dynamics of a floating platform in time domain the model was later updated ormberg et al 2011 luxcey et al 2011 for inclusion of flexible tower and blades and wind turbine aerodynamics and control a different approach was taken by jonkman 2007 who extended a land based wind turbine analysis software for applications with floating substructures the hydrodynamics and mooring models were nevertheless also borrowed from established knowledge of offshore engineering disciplines brown 2005 summarizes the fundamental theory and practical design aspects of catenary mooring systems highlighting the intrinsic nonlinear relation between platform excursion and the horizontal restoring component mooring systems for fwts normally consist of 3 4 lines which may combine chain and polyester segments for simulation purposes it may be convenient to assume simpler configurations with a uniform cross section jonkman 2010 robertson et al 2014 luan et al 2016 wind turbine aerodynamics can be reproduced with fairly simple models like the blade element momentum bem method which is based on the equilibrium between aerodynamic loads on elements of the blade and the changes in fluid momentum through the rotor plane manwell et al 2009 corrections for large induction factors and tip hub losses respectively are normally considered with simple multipliers and additional accuracy may be obtained by adopting øye s models for dynamic stall and dynamic wake effects hansen 2013 though developed for ground fixed wind turbines these models are also suitable for fwts especially in terms of thrust prediction vaal et al 2014 pedersen 2017 proposed a different approach for finding thrust and torque based on circulation theory arriving to a convenient model where the interconnected nature of both loads becomes evident through a compact matrix representation a wind turbine model comprises the main aerodynamic characteristics of the blades i e lift drag coefficients and geometric parameters rotor and drivetrain mechanical properties and control system strategies and parameters the nrel 5 mw reference wind turbine jonkman et al 2009 provides realistic parameters for the turbine subsystems a variable speed variable pitch vsvp control system is adopted actuating both on the generator torque and on the collective blade pitch angle in order to regulate power production under different operating regimes the adoption of a blade pitch controller for fwts results in the instabilities reported in e g nielsen et al 2006 larsen and hanson 2007 jonkman 2008 leading to amplification of the platform surge and pitch motions this effect may be attenuated by proper detuning of the controller gains by placing the controller frequency away from the fwt surge pitch natural rigid body modes 1 2 scope and text organization this paper explores the phenomenon of surge and pitch decay period variation when the fwt is subjected to different incident wind velocities in section 2 three different platform concepts are considered surge and pitch decay simulations are performed for each under steady incident wind velocities covering the entire operational range and the period variations are highlighted section 3 discusses fwt dynamics and introduces a simplified 2 dof model to be used in the prediction of the periods in section 4 the period variation is related to the mooring system nonlinearities and to an apparent inertia and damping effect and a strategy to consider these effects in the simplified model is developed the predicted periods are compared with the simulations in section 5 and conclusions and final considerations are presented in section 6 2 the decay period changing phenomenon in order to illustrate the effect of changing surge pitch decay periods for fwts under varying incident velocities time domain simulations with three platform concepts are presented 2 1 fwt concepts considered the fwt models considered have all been published previously and support the nrel 5 mw wind turbine jonkman et al 2009 the platforms and mooring systems are briefly described below oc3 hywind jonkman 2010 a spar platform originally developed by the norwegian company equinor formerly statoil and adapted as a concept design for the offshore code comparison collaboration oc3 the mooring system is composed of 3 catenary homogeneous lines with one of them aligned with the positive x axis and forming an angle of 120 with the other two oc4semi robertson et al 2014 a semi submersible platform comprising a central column connected through thin braces to three side columns at the bottom of each column there is a heave column that is a segment with larger diameter with the purpose of increasing the heave added mass and damping the mooring system is also a 3 lines catenary configuration but with two lines in the fore and another aligned with the negative x axis csc5mw luan et al 2016 2017 another semi submersible platform differing from the former in that the three side columns are connected to the central column with pontoons instead of braces the pontoons contribute significantly to the buoyancy and are symmetrically distributed the mooring system also consists of three homogeneous catenary lines arranged similarly to the oc3hywind fig 1 shows the three fwt concepts and table 1 presents their main dimensions the tower model has also been obtained from jonkman et al 2009 and consists of a 77 6 m long tubular structure with a base diameter of 6 50 m and top diameter of 3 87 m the tower base lies at 10 0 m above swl on all platforms such that the top is 87 6 m high the resulting hub height is 90 0 m 2 2 simulation tool and procedure the decay simulations are carried out with sima which combines riflex sintef ocean 2016a and simo sintef ocean 2016b in coupled time domain simulations 1 1 the adopted simulation tool has been compared to other codes and experimental results for example decay simulations results without wind had excellent agreement with similar software in the context of oc3 jonkman and musial 2010 and oc4 robertson et al 2017 the aerodynamic module was compared with other codes and experimental results within oc5 popko et al 2018 also providing very satisfactory matching with the results obtained by the other participants simo is a simulator of marine operations and is responsible for computing the hydrodynamic loads on the platform riflex is a fem based software for analysis of slender marine structures and is used for the analysis of structural loads and displacements of the tower rotor blades beam elements and mooring lines bar elements in addition it calculates the aerodynamic loads based on the bem method manwell et al 2009 with corrections for dynamic wake and dynamic stall effects and rotor dynamics including control structural damping is included in the fe model by means of rayleigh damping since moored floating platforms have compliant low frequency modes only the stiffness proportional term is considered cook 2001 then the damping model attenuates higher frequency structural vibrations and numerical noise while the platform motions are damped by hydrodynamic and aerodynamic effects only the simulations consisted in applying an initial displacement in the positive x direction for the decay in surge or a positive angle θ for the decay in pitch the platform was then released to oscillate under the action of the rotor thrust it is noted that the initial displacements were applied in addition to the loads imposed by the incident wind i e the platforms oscillated around the static displacements caused by the thrust surge and pitch decay tests were simulated for each of the wind velocities u w of table 2 which cover the entire operational range of the nrel 5 mw wind turbine in addition to the free decay condition i e u w 0 2 3 decay simulation results for each simulation the decay period was determined as the average period between oscillation peaks using the statistical tool wafo wafo group 2017 for wind velocities near rated the limit cycle behavior arising from the control induced negative damping effect nielsen et al 2006 jonkman 2008 is noticed as illustrated in fig 2 it is then important to constrain the analysis to a limited time window after the platform is released in order to ensure that the cycles considered for the period measurement are dominated by the decay motion nonetheless the measured periods close to rated wind velocity are expected to be less accurate than those for which the limit cycle effect is minor or non existent the decay periods for surge and pitch as a function of incident wind velocity are shown in fig 3 for the surge decay periods left hand column the pattern is similar for both the oc3 hywind and the csc5mw concepts the period increases in the below rated region reaching a maximum at the rated wind speed u w 11 4 m s and then decreases slowly for increasing velocities in the above rated region but always lying above the free decay 2 2 i e the decay for u w 0 m s period for the oc4semi concept however the pattern is somewhat the opposite the period decreases for increasing velocities in the below rated region has a minimum near rated wind velocity and then increases moderately in the above rated regime for pitch decay as shown in the right hand column the pattern is similar for the three concepts the period is roughly constant until u w 5 0 m s and then decreases until near rated wind velocity it is then suddenly increased reaching its maximum for u w 12 0 m s and decreasing from then on the variations in pitch period may vary in range according to the fwt considered the oc4semi pitch periods lie inside a range of about 5 0 s this interval varies more than 10 0 s for the oc3hywind and csc5mw 3 floating wind turbine dynamics the simulations presented in the previous section are based on a complete model including elastic effects and multibody dynamics now a simplified approach is introduced in which the rigid body motions of a floating catenary moored body are the object of the analysis the corresponding natural periods are distant from structural flexible modes while the amplitudes may be 2 3 orders of magnitude higher than those associated with e g bending of the tower consequently the following single rigid body system can be used for representing the dynamic effects of interest næss and moan 2013 1 m r b a r a d η 0 t k t τ η τ d τ d v η η c h s η c m r η η f e x t where m r b is the rigid body inertia matrix a r a d is the infinite frequency added mass matrix k is a matrix of retardation functions d v is the viscous damping matrix c h s and c m r are the hydrostatic and mooring stiffness matrices respectively f e x t is a vector of external loads and η is a vector with the body coordinates in an earth fixed coordinate system which has its origin on the water free surface with the z axis pointing upwards fig 4 3 1 simplified 2 dof model the present study considers 0 winds only i e travelling along the positive x direction rotor gyroscopic effects are disregarded and heave motions are assumed to be entirely decoupled from the other degrees of freedom therefore only surge and pitch dynamics are of interest besides a few assumptions can be proposed to simplify equation 1 in the analysis of surge and pitch decay 1 the platform motions have very low frequency ω 0 such that k can be disregarded and the radiation effects can be approximated by replacing a r a d for a r a d 0 the reason behind this assumption is the absence of waves and the long natural periods of the floating system s rigid body motions corresponding to negligible radiation damping 2 the viscous damping can be represented by linear damping only this is a reasonable statement considering the low velocities involved 3 the hydrostatic and mooring stiffness matrices are independent of the body position for the hydrostatic restoring stiffness this assumption may be justified based on the small changes in volume due to the floater motion and also on the fairly wall sided platforms considered in the analysis with regards to mooring the matrix has to be linearized around points of interest since nonlinear effects become important far from the equilibrium position see fig 5 4 the only external load is the rotor thrust this follows from the fact that radiation loads viscous hydrodynamic forces and mooring hydrostatic stiffness are already considered in the l h s of the equation and no waves are present besides wind drag loads on the tower are disregarded equation 1 then reduces to 2 m η b v l η c η f w i n d for a 2 dof surge pitch system the matrices in 2 become m m r b a r a d 0 m r b m m z g m z g i y y a r a d 0 a 11 a 15 a 51 a 55 b v l b 11 0 0 b 55 c c h s c m r c h s 0 0 0 c 55 h s c m r c 11 m r c 15 m r c 51 m r c 55 m r η x θ f w i n d f a e r cos θ f a e r z h u b cos 2 θ where m is the total mass of the platform tower hub and nacelle z g is the system s vertical coordinate of the center of gravity i y y is the total moment of inertia in pitch a i j are the zero frequency added mass coefficients b i i are the linearized viscous damping coefficients in surge and pitch c 55 h s is the linear hydrostatic restoring coefficient in pitch already accounting for gravitational effects c i j m r are the linear mooring restoring coefficients x is the displacement in surge θ is the pitch angle f a e r is the turbine thrust and z h u b is the hub height 3 2 control system wind turbines are normally equipped with a control system in order to optimize power production and interrupt the operation under unfavourable conditions the nrel 5 mw wind turbine controller actuates on the generator torque q g e n and collective blade pitch angle β depending on the operational regime the generator torque is based on the filtered shaft velocity ω in the below rated regime 3 0 m s u w 11 4 m s the torque is proportional to the squared shaft velocity such as to optimize power production in the above rated region 11 4 m s u w 25 0 m s it is inversely proportional to the shaft velocity such as to keep the power constant in the above rated regime the rotor speed is regulated through changes in the blade pitch angle which lead to changes in the aerodynamic torque load the change in blade pitch angle is determined by a gain scheduled proportional integral pi controller 3 δ β k p β δ ω k i β 0 t δ ω d t where the proportional k p and integral k i gains are calculated as a function of the blades current pitch angle β see table 3 for the gains adopted for β 0 the input to the controller δ ω is the difference between the rotor speed and the reference rotor speed a more detailed description of the control strategy including the gain scheduling procedure is provided by jonkman et al 2009 3 3 external loads when a fwt oscillates under the action of wind it is subjected to three main sources of loads the aerodynamic thrust induced on the rotor 3 3 the drag on tower and hull should also be classified as an aerodynamic effect but is of secondary importance and therefore disregarded the hydrodynamic loads acting on the submerged portion of the platform and the mooring loads applied on the fairleads which normally are also underwater the aerodynamic thrust is a function of the relative flow velocity in the rotor which is a combination of the incident wind velocity the nacelle velocity and the inflow velocity when the turbine oscillates the nacelle velocity is also oscillatory and so is the thrust a phase shift however is observed between thrust and nacelle velocity this effect may be worked out and treated as a modification in the nacelle s inertia and damping therefore influencing the fwt decay periods in the absence of waves hydrodynamic loads may be divided into two groups the radiation loads related to the waves produced by the body s motion and the viscous loads which are a function of the body s velocity for typical surge pitch decay periods ω 0 radiation loads reduce to acceleration proportional terms commonly known as added mass the added mass influences the natural periods but there is no reason to relate it to the period changes for different wind velocities 4 4 actually geometric changes due to variations in the mean pitch offset can affect the radiation loads this effect is however disregarded in the benchmark simulations presented in section 2 and therefore are also neglected here viscous damping also affects natural periods but cannot be used to explain the period variations either catenary mooring systems normally provide fairly linear stiffness when the platform is close to the neutral position for surge however the stiffness gets nonlinear as the platform is displaced along the x axis therefore when subjected to a mean wind loading the platform may oscillate around a mean position which lies in the nonlinear range leading to a natural period different from when the system oscillates around the neutral position it is then expected that the nonlinearities induced by aerodynamic thrust and catenary mooring system should play prevailing roles behind the period variation phenomenon as discussed below 4 prediction of the decay period changes for varying u w simplified representations for the nonlinear effects discussed in the previous section are now developed providing means to estimate the decay periods based on equation 2 4 1 mooring system nonlinearities catenary mooring systems are meant to position a floating body using the mooring lines own weight in water when the platform is displaced away from the anchor a portion of the line resting on the seabed is lifted increasing the weight to be supported by the floater in addition due to the change in angle the horizontal component of the tension increases also contributing nonlinearly to the horizontal restoring force brown 2005 the nonlinearity is evident in fig 5 where the mooring stiffness curves for the three platforms are shown when subjected to a mean wind force the platform will oscillate around the corresponding offset with different stiffnesses and therefore periods for varying wind velocities loads induced by catenary mooring systems may be estimated analytically faltinsen 1993 here expressions for the mooring stiffness are instead determined through polynomial fitting of the data in fig 5 since the wind displaces the fwt towards the positive x direction the fitting is made for x 0 only 3rd order polynomials are found to fit the data with excellent agreement such that the following nonlinear stiffness model is applied 4 f r x k 1 x k 2 x 2 k 3 x 3 k x x where k 1 k 2 and k 3 are obtained from the data fitting procedure and the x dependent stiffness coefficient is given by 5 k x k 1 k 2 x k 3 x 2 time domain simulations can be performed by replacing the c 11 m r element of the stiffness matrix with k x calculated according to the procedure above in equation 2 alternatively the nonlinear model of equation 4 can be linearized around a given offset x 0 keeping up to first order terms in a taylor expansion it becomes 6 f r x k 2 x 0 2 2 k 3 x 0 3 k 1 2 k 2 x 0 3 k 3 x 0 2 x such that the linearized stiffness coefficient k 11 l i n is given by 7 k 11 l i n x 0 k 1 2 k 2 x 0 3 k 3 x 0 2 typical platform rotations in pitch do not produce important geometric changes in the mooring lines resulting in a fairly linear behavior for the mooring stiffness in this dof therefore the main source of nonlinear mooring restoring for pitch comes from the surge pitch coupling which depends on the vertical distance from the fairleads to the platform s center of gravity still restoring in pitch for catenary moored fwts is dominated by hydrostatic effects which for typical pitch angles have linear behavior therefore mooring stiffness should not be behind the observed changes in the pitch decay period for varying incident wind velocities the pitch period changes must then be related to the r h s of equation 2 4 2 prediction of the surge decay periods with a linearized stiffness matrix a simple way to estimate the surge decay periods is to linearize the stiffness around the offset associated to a given u w using the x 0 values obtained from the sima simulations in equation 7 the coefficients k 1 k 2 and k 3 for each curve in figure 5 are presented in table 4 the cross terms of the mooring stiffness matrix are obtained from the linear stiffness in surge multiplied by the fairleads vertical position relative to the swl z f l and the term for pitch is kept unchanged the matrix for a given offset c m r x 0 is then given by 8 c m r x 0 k 11 l i n x 0 k 11 l i n x 0 z f l k 11 l i n x 0 z f l c 55 m r the period for each u w can then be calculated from the eigenvalues of equation 2 with the stiffness matrix defined as above 4 3 aerodynamic apparent inertia stiffness and damping effects let a fwt be subjected to steady non turbulent wind the airflow velocity w t is the relative axial flow velocity felt by the rotor and is given by 9 w t w 0 w i t x n a c where w 0 is the incident wind velocity x n a c is the nacelle horizontal velocity and the inflow velocity w i is a flow induced in the rotor by the vorticity shed by the blades as stated by the biot savart law platform oscillations affect w t through variations in x n a c 5 5 the inflow velocity w i is also affected but in a much lower degree provoking fluctuations in the rotor torque and thrust a thorough discussion about this effect is provided by pedersen 2017 appendix a summarizes the most relevant formulations from that work for the purposes of this paper particularly important insight is obtained from a combination of equations a 5 and a 6 leading to the following expression for the thrust 6 6 note that equation a 6 actually refers to the circulatory thrust only i e the drag portion a 7 is disregarded in this discussion due to its relatively lower importance 10 f κ cos u w sin u ω ℓ ω where u is the blade pitch control action ω is the rotor angular velocity and κ ℓ are constants noting that u 0 in the below rated regime no blade pitch action equation 10 reduces to 11 f κ w ω replacing w as given by 9 and writing the rotor velocity as a mean plus a varying term ω t ω 0 ω t the following expression is obtained for the thrust in the below rated regime 12 f κ ω 0 w 0 w i κ w 0 w i ω κ ω 0 x n a c where only linear terms were kept assuming small variations in w i the first term in the r h s of equation 12 may be seen as a constant while the second term depends essentially on the rotor dynamics the last term oscillates proportionally to x n a c and since κ and ω 0 are both positive the negative sign implies that the thrust in the below rated region will always induce a damping effect into the nacelle dynamics when the turbine operates in the above rated regime the blade pitch control system results in non zero values for u and equation 11 may be rewritten according to 13 f κ ω cos u w 0 w i sin u ω ℓ κ ω 0 cos u x n a c the second term now depends on cos u which is a function of the generator angular velocity through a pi controller therefore it is no longer possible to affirm that the oscillating term is proportional to x n a c while an analytical development of this relation is not in the scope of this paper it is of interest to understand how f varies as a function of x n a c in the above rated regime and the consequent effects on the system global dynamics for this purpose a series of simulations were executed in which the nrel 5 mw turbine including controller oscillated horizontally with rotor aerodynamics calculated with aerodyn moriarty and hansen 2005 it was decided to adopt the bem formulation with dynamic stall correction and the blades were kept rigid the oscillation amplitude was 10 0 m and the period varied from 20 0 s to 160 0 s with increments of 1 0 s the incident wind velocities are the same as those presented in table 2 fig 6 shows the aerodynamic thrust and nacelle velocity for an oscillation period of 30 0 s and incident wind velocities of 9 0 m s 11 4 m s and 18 0 m s it is suggested that the thrust f can be written as a sum of a mean term f m e a n u w and a varying term f v a r u w x n a c 14 f a e r f m e a n u w f v a r u w x n a c for u w 9 0 m s the phase difference between f v a r and x n a c is close to π rad which is in agreement with the discussion above defining a velocity to thrust amplitude factor f 0 f v a r u w x n a c may be rewritten as follows 15 f v a r u w x n a c f 0 x n a c the 1 dof motion of the nacelle with mass m stiffness k and damping c and forced by f is driven by 16 m x c x k x f m e a n f 0 x m x c f 0 x k x f m e a n where the nac indicator on x was suppressed for conciseness the discussed damping effect of the thrust is now more visible this is a well known effect for fwts explained e g in jonkman 2008 goupee et al 2017 the second and third plots of fig 6 however show that the controller action results in the thrust oscillating with a phase ϕ relative to the nacelle velocity this effect also reported in lennie et al 2016 is not fully understood yet but dynamic wake effects actuator dynamics and delays induced by signal filtering may possibly contribute to it assuming that the nacelle motion may be described as x t x 0 sin ω t the velocity is given by x t x 0 ω cos ω t and f v a r becomes 17 f v a r f 0 x 0 ω cos ω t ϕ f 0 x 0 ω cos ω t cos ϕ x 0 ω sin ω t sin ϕ f 0 x cos ϕ ω x sin ϕ noting that ω x ω 2 ω x x ω the last term of equation 17 can then alternatively be written as 18 f v a r f 0 x cos ϕ x ω sin ϕ in the above rated regime the thrust is thus no longer proportional to the nacelle velocity only but rather to a combination of nacelle velocity and position acceleration in the latter case the effect may be interpreted as an apparent inertia 19 m f 0 ω sin ϕ x c f 0 cos ϕ x k x f m e a n variations in the system s natural period can now be related to f 0 and ϕ when the phase is such that sin ϕ increases the thrust effect on the system s damping is reduced and the apparent changes in inertia become more important a quantification of this influence demands a better understanding on how f 0 and ϕ vary with the incident wind velocity the nacelle s period of oscillation and the motion amplitude 4 4 quantification of the apparent inertia and damping effects induced by the thrust the above mentioned simulations with aerodyn provided a total of 3384 pairs of rotor thrust and nacelle velocity time series for each pair a fast fourier transform fft was performed for both time series yielding their discrete frequency domain representations the phase ϕ between the time series could then be determined as the angle of the ratio between the thrust and nacelle velocity representations in the frequency domain at the frequency of oscillation the velocity to thrust amplitude factor f 0 is obtained directly from the time series by considering the ratio of their maximum amplitudes fig 7 shows the values of ϕ calculated as explained above one can clearly distinguish the below rated region by the nearly uniform phase values close to π rad as discussed previously close to u w 11 4 m s the phase values change smoothly for shorter oscillation periods lying between π 6 rad and 2 π 3 rad as the wind velocity increases when the period is longer the change is more abrupt and the phase tends to be smaller lying between 0 rad and π 6 rad this indicates that when the system dynamics are slower the thrust tends to follow the velocity more closely another important feature of the plot is that it helps to visualize the operating conditions when according to equation 19 the thrust results in a negative damping effect i e when the phase lies between 0 rad and π 2 rad this is observed for most of the above rated region but for shorter periods and wind velocities closer to rated the phase may be slightly higher than π 2 rad this may be useful e g during the design of a controller the f 0 factor values are presented in a similar scheme in fig 8 in general the factor changes more intensely near rated wind velocity where it is highly amplified in comparison to other operational regions the thrust amplitude changes much faster from below rated to rated when the periods are longer while this transition is smoother for shorter periods once ϕ and f 0 are known the apparent inertia and damping from thrust can be quantified from equation 19 the aerodynamic apparent inertia and damping coefficients a a e r and b a e r are defined according to 20 a a e r f 0 ω sin ϕ b a e r f 0 cos ϕ the matrices of aerodynamic apparent inertia and damping can then be written as 21 a a e r a a e r a a e r h n a c a a e r h n a c a a e r h n a c 2 22 b a e r b a e r b a e r h n a c b a e r h n a c b a e r h n a c 2 where h n a c is the height of the nacelle with respect to swl one should note that figs 7 and 8 are based on imposed nacelle oscillations i e the motions are not affected by the thrust this is in contrast with the decay simulations in which the motions are not only influenced by the thrust but also indirectly modify it through the changes in flow velocity and varying rotor speed indeed the second term on the r h s of equation 12 depends on ω whose dynamics are given by 23 ω q a e r q g e n i r o t where q a e r and q g e n are the aerodynamic and generator torque respectively and i r o t is the rotor moment of inertia around the shaft from equation a 6 and the discussions in section 3 2 the dependence of ω on both x n a c and ω become evident but this is not captured by the proposed model inaccuracies on the period predictions are therefore expected especially in the below rated regime above rated the torque regulation through blade pitch control reduces the importance of the rotor dynamics leading to more accurate period predictions 4 5 prediction of the pitch decay periods based on the apparent inertia and damping effects the aerodynamic effects on inertia and damping can be accounted for in the fwt dynamics by adding a a e r and b a e r to the inertia and damping matrices 24 m m r b a r a d 0 a a e r 25 b b v l b a e r such that equation 2 can now be rewritten as follows 26 m η b η c η f w i n d where f w i n d is formed by the mean thrust component f m e a n 27 f w i n d f m e a n f m e a n z h u b it is assumed in equation 27 that the pitch angle is small enough for the dependence in θ to be neglected as it is noted the varying component of the thrust is now absorbed by the inertia and damping matrices making it straightforward to relate its effects to changes in the decay periods for different incident wind velocities the pitch decay period for a given u w can be calculated once the coefficients a a e r and b a e r are known these coefficients however depend themselves on the period such that an iterative procedure is adopted departing from an initial guess for the period the phase ϕ and the amplitude factor f 0 are obtained by interpolation in the matrices presented in figs 7 and 8 a new value for the period is then obtained based on the corresponding a a e r and b a e r and is compared to the previous guess the process is repeated until the difference becomes lower than a given tolerance the relevance of the apparent inertia can now be assessed table 5 shows the ratio between the apparent inertia and the rigid body plus zero frequency added inertia in surge top and pitch bottom for three values of u w for surge the effect of apparent inertia is irrelevant for the below and above rated regimes while near rated the value may have some importance 7 7 fig 7 shows however that for periods higher than 90 0 s the change in phase at 11 4 m s is quite sudden such that one should be careful with the phases and therefore inertia damping effects calculated for this wind speed for pitch the apparent inertia is again negligible at the below rated region for above rated however the nacelle apparent inertia assumes values that when multiplied by the squared nacelle height may result in an apparent moment of inertia effect with order of magnitude comparable to the fwt s rigid body and added inertia depending on the platform the apparent damping effect is relevant for both surge and pitch as indicated in table 6 for below rated wind speeds it may significantly increase the viscous damping at both dofs for u w 11 4 m s however the damping assumes a negative value in surge even exceeding the equivalent linear viscous coefficient for the oc4semi in the sima simulations where the damping is a combination of linear and quadratic terms this results in an effective zero damping scenario leading to the limit cycle effect discussed in section 2 3 for pitch however the damping is still positive at rated but becomes negative for all platforms as the wind velocity increases 5 results the natural frequencies for each u w are obtained from the eigenvalues of the undamped and homogeneous version of equation 2 28 m η c η 0 where for surge the mooring stiffness matrix is written as in equation 8 while for pitch the inertia matrix includes a a e r as given by equation 24 the undamped natural frequency for a given dof ω 0 i is then corrected for accounting for damping yielding the decay frequency ω d i 29 ω d i ω 0 i 1 ζ i 2 where ζ i is the relative damping coefficient while for surge it is based on the b 11 coefficients from section 3 for pitch it also accounts for the main diagonal elements of the matrix given in equation 22 5 1 periods in surge the predicted surge periods are presented in figs 9 11 which show the estimates for the three fwt concepts considered under the range of incident wind velocities of table 2 the bottom plots bring the relative error between estimated and simulated periods for the oc3 hywind fig 9 the estimated periods match the simulations with an error in general lower than 0 5 in the above rated regime for the below rated region there is an increase in the relative error as the wind speed approaches the rated condition notably for u w 8 0 11 0 m s at this range of wind speeds the platform offsets in surge are not so different from what is observed for u w 12 0 16 0 m s where the discrepancy between simulations and estimates is much lower this suggests that the discrepancies may hardly be attributed to the linearization method adopted the agreement between estimated and simulated periods is much better for the oc4semi fig 10 and the csc5mw fig 11 indeed the relative error for both fwts is lower than 1 for most u w values increasing only near rated wind velocity 5 2 periods in pitch figs 12 14 show the estimated decay periods in pitch for the three fwt concepts considered under the range of incident wind velocities of table 2 for all three concepts it is seen that the period variation from the sima simulations is very satisfactorily followed by the estimates in the rated and above rated regime for the oc3hywind the relative error for u w 11 4 m s is around 4 lying below 2 for higher velocities for the oc4semi and csc5mw the relative errors are even smaller with simulated and estimated curves nearly coincident along the above rated regime in the below rated region however the estimates for all concepts fail to predict a depression observed for the simulated periods in the range 6 0 m s u w 10 0 m s a possible explanation may be the absence in the simplified model of the influence of the rotor dynamics as discussed in section 4 4 even though all three fwt concepts are equipped with the same turbine the magnitude of the period changes is not the same as already pointed out in section 2 3 this can be related to the fact that the natural periods for u w 0 differ for each design falling in different regions of fig 7 indeed fig 7 shows that at the range of periods between 20 0 s and 40 0 s the phases vary significantly in the above rated regime implying that modest changes in the fwt inertia properties may heavily influence the period variation phenomenon 6 conclusions as previously reported in bachynski et al 2016 goupee et al 2017 surge and pitch decay periods variations were observed for fwts operating under different incident wind velocities in this paper the effect was reproduced in time domain simulations performed with sima and an investigation for its origins was carried out it was found that the period variations in surge and pitch have distinct sources while for the former the effect is mainly linked to the mooring system nonlinearities for the latter it is induced by the thrust at the turbine in combination with the nacelle motions a simplified model was then applied for predicting the period variations as a function of the incident wind velocity for surge the mooring stiffness coefficient was linearized around the offsets associated to each u w and then the periods were found from the eigenvalues of the linear 2 dof equation of motion the predictions closely agreed with the simulated periods with relative errors of less than 1 along most of the range of u w values higher but still limited discrepancies were observed close to rated regime for pitch the relative phase between nacelle velocity and the thrust induced in the rotor could be related to apparent inertia and damping terms in the equations of motion this effect was quantified for a combination of wind velocities and oscillation periods through simulations involving aerodyn coupled to an 1 dof system inertia and damping coefficients were then included in a linear model from which the periods could be estimated the method resulted in precise predictions of the period in comparison with the time domain simulations in the above rated region in the below rated region a depression was noticed for the simulated data which could not be replicated with the approximated method the reasons for this discrepancy are unclear but a possible explanation could be that the phases and amplitudes from figs 7 and 8 are based on imposed nacelle oscillations which did not depend on the thrust and rotor dynamics in a coupled manner a better understanding of this coupling effect and how to include it in the simplified model would represent important contributions to the method the period variation in pitch depended on the height of the nacelle relative to swl the effect is expected to be more relevant for higher towers and thus more important for turbines of higher capacity on the other hand the phenomenon can be attenuated by proper tuning of the fwt s own pitch natural period by placing the oscillations in a range where the apparent inertia effect is less relevant the capability of predicting the period variation with a simplified method may be useful in different stages of the development of new fwt concepts for example the possibility of replacing full decay simulations which took approximately 15 min with an intel core i7 6500u 2 50 ghz cpu for each wind velocity for eigenvalues calculations 0 8 s for the entire range of wind velocities can be an advantage when different platform concepts are to be considered in early design phases further research may relate the proposed method to disciplines like structural integrity assessment control system design mooring systems and model testing the method could also contribute in the development of new frequency domain tools acknowledgements the authors are sincerely grateful to the financial support from ntnu imt and the centre for autonomous marine operations and systems norwegian research council project 223254 appendix a parametric aerodynamics model based on dynamic vortex theory pedersen 2017 devised a convenient model for the aerodynamic thrust and torque where the interconnected nature of those loads are made evident through the so defined circulation function from the kutta joukowsky theorem the lift force d f on a line element d l is given by a 1 d f ρ u r γ d l where γ is the circulation 8 8 the circulation is defined as the integral of the flow velocity field around any closed path c enclosing the airfoil γ c u d l and u r is the relative flow velocity which in a system of cylindrical coordinates r θ z fixed to the rotor is given by a 2 u r t e z w t e θ ω t r with w being the airflow and ω the rotor angular velocity under the assumption of purely axial inflow the normal component of d f is integrated over each of the blades leading to the following expression for the circulatory thrust f c a 3 f c t ρ a n 2 π γ t ω t where ρ is the density of the air a is the rotor swept area and n is the number of blades equivalently the circulatory torque is found by integrating the tangential component of d f along each blade a 4 q c t ρ a n 2 π γ t w t the author then proceeds with a series of simplifications for the circulation function with the objective of devising an engineering model without significant losses in accuracy notably by approximating γ as an equivalent airfoil model and assuming a flat plate behavior for small angles of incidence the circulation function g ω w u is defined as a 5 g ω w u κ cos u w sin u ω ℓ where κ 2 ρ a p r 3 λ with a p being the swept area corrected for blade tip losses 9 9 a common method for modelling tip loss effects is by reducing the effective rotor radius through multiplication by a factor 0 b 1 the corrected radius r p b r then results in an effective swept area a p b 2 a r the rotor radius λ the tip speed ratio for maximum wind power extraction and ℓ a length scale factor the parameter u is the controlled blade pitch angle which is non zero in the above rated region only the circulatory thrust and torque can then be rewritten as a 6 f c g ω w u ω q c g ω w u w drag may be relevant for the torque and in a lesser degree for the thrust the drag thrust and torque are modelled according to a 7 f d d f w w q d d q ω 2 where the coefficients d f and d q are determined in terms of losses in typical wind turbines the following compact model in matrix form is then proposed a 8 f q d f w g ω w u g ω w u d q ω w ω where the airflow w is given by equation 9 pedersen proposes that the low frequency dynamics of the inflow w i are driven by a 9 μ r p w i w w i f c 2 ρ a p where μ 8 3 π is a virtual inertia parameter 
22861,recently published experimental results show variations in surge and pitch decay periods of floating wind turbines fwts subjected to different incident wind velocities this paper explores the external loads acting on a fwt with special attention to nonlinearities which affect its low frequency global motions the period variations in surge and pitch are found to have different sources in surge the mooring system nonlinearities dominate while for pitch the relative phase between the nacelle velocity and the thrust induced in the rotor leads to an apparent inertia damping effect simplified 2 dof models using linearized stiffness coefficients for surge and modified inertia and damping matrices for pitch are developed comparisons with state of the art aero hydro servo elastic time domain simulations show excellent agreement for three distinct catenary moored fwt designs keywords floating wind turbines mooring systems coupled dynamics 1 introduction floating wind turbines fwts have been proposed as the next generation of offshore wind energy harvesting systems some prototypes have already been deployed with power varying between 2 and 6 mw principlepower 2014 fukushima forward 2016 equinor 2018 while the generous wind resources at deeper waters and the more relaxed constraints in tower and rotor dimensions have resulted in ambitious concepts for supporting 10 mw turbines lifes50 2015 lemmer et al 2016 still several challenges are to be overcome before fwts become technically and commercially feasible in particular the platform construction costs have to be reduced a good understanding of fwt dynamics is necessary for optimal structural design and accurate power production estimates however fwts are complex systems subjected to nonlinear coupled aerodynamic hydrodynamic mooring and controller induced loads prediction of the system responses to different environmental conditions may be complicated and unexpected behavior may be observed depending on the combination of loads one such behavior has been recently observed in fwt model tests first reported in bachynski et al 2016 the natural periods measured in surge and pitch decay tests varied when a scale model fwt was subjected to different incident wind velocities the effect was noticed in both the below and above rated wind velocity regimes another model test campaign goupee et al 2017 reported the same phenomenon but the tests were limited to pitch decay in above rated wind velocities the authors propose a qualitative explanation for the effect based on taylor expansion of the thrust considering the blade pitch control action but do not provide a prediction for the changes nor do they discuss the effect for surge motions in both publications the model fwts corresponded to catenary moored semi submersible platforms low frequency motions are of great importance in the design of a fwt the low frequency components of the aerodynamic thrust second order wave loads and the mooring system loads may excite rigid body responses the observed variations in natural period are therefore particularly important for the mooring system design and tuning of rotor controller gains in addition there is a growing interest in the development of simplified models e g frequency domain approaches that can reproduce fwt dynamics with an acceptable level of accuracy for efficient application in early design iterations lupton 2014 pegalajar jurado et al 2018 an accurate estimation of the decay periods for different operational conditions is necessary for proper tuning of such models ensuring a fair prediction of the rigid body response to linear loads 1 1 background previous expertise and tools from the offshore industry have been adapted for the analysis of fwts dynamics in particular the technology and software for platform structural analysis wave structure interaction and mooring system design ormberg and larsen 1998 introduced a method for simultaneously evaluating the floater motions and fem modelled mooring dynamics of a floating platform in time domain the model was later updated ormberg et al 2011 luxcey et al 2011 for inclusion of flexible tower and blades and wind turbine aerodynamics and control a different approach was taken by jonkman 2007 who extended a land based wind turbine analysis software for applications with floating substructures the hydrodynamics and mooring models were nevertheless also borrowed from established knowledge of offshore engineering disciplines brown 2005 summarizes the fundamental theory and practical design aspects of catenary mooring systems highlighting the intrinsic nonlinear relation between platform excursion and the horizontal restoring component mooring systems for fwts normally consist of 3 4 lines which may combine chain and polyester segments for simulation purposes it may be convenient to assume simpler configurations with a uniform cross section jonkman 2010 robertson et al 2014 luan et al 2016 wind turbine aerodynamics can be reproduced with fairly simple models like the blade element momentum bem method which is based on the equilibrium between aerodynamic loads on elements of the blade and the changes in fluid momentum through the rotor plane manwell et al 2009 corrections for large induction factors and tip hub losses respectively are normally considered with simple multipliers and additional accuracy may be obtained by adopting øye s models for dynamic stall and dynamic wake effects hansen 2013 though developed for ground fixed wind turbines these models are also suitable for fwts especially in terms of thrust prediction vaal et al 2014 pedersen 2017 proposed a different approach for finding thrust and torque based on circulation theory arriving to a convenient model where the interconnected nature of both loads becomes evident through a compact matrix representation a wind turbine model comprises the main aerodynamic characteristics of the blades i e lift drag coefficients and geometric parameters rotor and drivetrain mechanical properties and control system strategies and parameters the nrel 5 mw reference wind turbine jonkman et al 2009 provides realistic parameters for the turbine subsystems a variable speed variable pitch vsvp control system is adopted actuating both on the generator torque and on the collective blade pitch angle in order to regulate power production under different operating regimes the adoption of a blade pitch controller for fwts results in the instabilities reported in e g nielsen et al 2006 larsen and hanson 2007 jonkman 2008 leading to amplification of the platform surge and pitch motions this effect may be attenuated by proper detuning of the controller gains by placing the controller frequency away from the fwt surge pitch natural rigid body modes 1 2 scope and text organization this paper explores the phenomenon of surge and pitch decay period variation when the fwt is subjected to different incident wind velocities in section 2 three different platform concepts are considered surge and pitch decay simulations are performed for each under steady incident wind velocities covering the entire operational range and the period variations are highlighted section 3 discusses fwt dynamics and introduces a simplified 2 dof model to be used in the prediction of the periods in section 4 the period variation is related to the mooring system nonlinearities and to an apparent inertia and damping effect and a strategy to consider these effects in the simplified model is developed the predicted periods are compared with the simulations in section 5 and conclusions and final considerations are presented in section 6 2 the decay period changing phenomenon in order to illustrate the effect of changing surge pitch decay periods for fwts under varying incident velocities time domain simulations with three platform concepts are presented 2 1 fwt concepts considered the fwt models considered have all been published previously and support the nrel 5 mw wind turbine jonkman et al 2009 the platforms and mooring systems are briefly described below oc3 hywind jonkman 2010 a spar platform originally developed by the norwegian company equinor formerly statoil and adapted as a concept design for the offshore code comparison collaboration oc3 the mooring system is composed of 3 catenary homogeneous lines with one of them aligned with the positive x axis and forming an angle of 120 with the other two oc4semi robertson et al 2014 a semi submersible platform comprising a central column connected through thin braces to three side columns at the bottom of each column there is a heave column that is a segment with larger diameter with the purpose of increasing the heave added mass and damping the mooring system is also a 3 lines catenary configuration but with two lines in the fore and another aligned with the negative x axis csc5mw luan et al 2016 2017 another semi submersible platform differing from the former in that the three side columns are connected to the central column with pontoons instead of braces the pontoons contribute significantly to the buoyancy and are symmetrically distributed the mooring system also consists of three homogeneous catenary lines arranged similarly to the oc3hywind fig 1 shows the three fwt concepts and table 1 presents their main dimensions the tower model has also been obtained from jonkman et al 2009 and consists of a 77 6 m long tubular structure with a base diameter of 6 50 m and top diameter of 3 87 m the tower base lies at 10 0 m above swl on all platforms such that the top is 87 6 m high the resulting hub height is 90 0 m 2 2 simulation tool and procedure the decay simulations are carried out with sima which combines riflex sintef ocean 2016a and simo sintef ocean 2016b in coupled time domain simulations 1 1 the adopted simulation tool has been compared to other codes and experimental results for example decay simulations results without wind had excellent agreement with similar software in the context of oc3 jonkman and musial 2010 and oc4 robertson et al 2017 the aerodynamic module was compared with other codes and experimental results within oc5 popko et al 2018 also providing very satisfactory matching with the results obtained by the other participants simo is a simulator of marine operations and is responsible for computing the hydrodynamic loads on the platform riflex is a fem based software for analysis of slender marine structures and is used for the analysis of structural loads and displacements of the tower rotor blades beam elements and mooring lines bar elements in addition it calculates the aerodynamic loads based on the bem method manwell et al 2009 with corrections for dynamic wake and dynamic stall effects and rotor dynamics including control structural damping is included in the fe model by means of rayleigh damping since moored floating platforms have compliant low frequency modes only the stiffness proportional term is considered cook 2001 then the damping model attenuates higher frequency structural vibrations and numerical noise while the platform motions are damped by hydrodynamic and aerodynamic effects only the simulations consisted in applying an initial displacement in the positive x direction for the decay in surge or a positive angle θ for the decay in pitch the platform was then released to oscillate under the action of the rotor thrust it is noted that the initial displacements were applied in addition to the loads imposed by the incident wind i e the platforms oscillated around the static displacements caused by the thrust surge and pitch decay tests were simulated for each of the wind velocities u w of table 2 which cover the entire operational range of the nrel 5 mw wind turbine in addition to the free decay condition i e u w 0 2 3 decay simulation results for each simulation the decay period was determined as the average period between oscillation peaks using the statistical tool wafo wafo group 2017 for wind velocities near rated the limit cycle behavior arising from the control induced negative damping effect nielsen et al 2006 jonkman 2008 is noticed as illustrated in fig 2 it is then important to constrain the analysis to a limited time window after the platform is released in order to ensure that the cycles considered for the period measurement are dominated by the decay motion nonetheless the measured periods close to rated wind velocity are expected to be less accurate than those for which the limit cycle effect is minor or non existent the decay periods for surge and pitch as a function of incident wind velocity are shown in fig 3 for the surge decay periods left hand column the pattern is similar for both the oc3 hywind and the csc5mw concepts the period increases in the below rated region reaching a maximum at the rated wind speed u w 11 4 m s and then decreases slowly for increasing velocities in the above rated region but always lying above the free decay 2 2 i e the decay for u w 0 m s period for the oc4semi concept however the pattern is somewhat the opposite the period decreases for increasing velocities in the below rated region has a minimum near rated wind velocity and then increases moderately in the above rated regime for pitch decay as shown in the right hand column the pattern is similar for the three concepts the period is roughly constant until u w 5 0 m s and then decreases until near rated wind velocity it is then suddenly increased reaching its maximum for u w 12 0 m s and decreasing from then on the variations in pitch period may vary in range according to the fwt considered the oc4semi pitch periods lie inside a range of about 5 0 s this interval varies more than 10 0 s for the oc3hywind and csc5mw 3 floating wind turbine dynamics the simulations presented in the previous section are based on a complete model including elastic effects and multibody dynamics now a simplified approach is introduced in which the rigid body motions of a floating catenary moored body are the object of the analysis the corresponding natural periods are distant from structural flexible modes while the amplitudes may be 2 3 orders of magnitude higher than those associated with e g bending of the tower consequently the following single rigid body system can be used for representing the dynamic effects of interest næss and moan 2013 1 m r b a r a d η 0 t k t τ η τ d τ d v η η c h s η c m r η η f e x t where m r b is the rigid body inertia matrix a r a d is the infinite frequency added mass matrix k is a matrix of retardation functions d v is the viscous damping matrix c h s and c m r are the hydrostatic and mooring stiffness matrices respectively f e x t is a vector of external loads and η is a vector with the body coordinates in an earth fixed coordinate system which has its origin on the water free surface with the z axis pointing upwards fig 4 3 1 simplified 2 dof model the present study considers 0 winds only i e travelling along the positive x direction rotor gyroscopic effects are disregarded and heave motions are assumed to be entirely decoupled from the other degrees of freedom therefore only surge and pitch dynamics are of interest besides a few assumptions can be proposed to simplify equation 1 in the analysis of surge and pitch decay 1 the platform motions have very low frequency ω 0 such that k can be disregarded and the radiation effects can be approximated by replacing a r a d for a r a d 0 the reason behind this assumption is the absence of waves and the long natural periods of the floating system s rigid body motions corresponding to negligible radiation damping 2 the viscous damping can be represented by linear damping only this is a reasonable statement considering the low velocities involved 3 the hydrostatic and mooring stiffness matrices are independent of the body position for the hydrostatic restoring stiffness this assumption may be justified based on the small changes in volume due to the floater motion and also on the fairly wall sided platforms considered in the analysis with regards to mooring the matrix has to be linearized around points of interest since nonlinear effects become important far from the equilibrium position see fig 5 4 the only external load is the rotor thrust this follows from the fact that radiation loads viscous hydrodynamic forces and mooring hydrostatic stiffness are already considered in the l h s of the equation and no waves are present besides wind drag loads on the tower are disregarded equation 1 then reduces to 2 m η b v l η c η f w i n d for a 2 dof surge pitch system the matrices in 2 become m m r b a r a d 0 m r b m m z g m z g i y y a r a d 0 a 11 a 15 a 51 a 55 b v l b 11 0 0 b 55 c c h s c m r c h s 0 0 0 c 55 h s c m r c 11 m r c 15 m r c 51 m r c 55 m r η x θ f w i n d f a e r cos θ f a e r z h u b cos 2 θ where m is the total mass of the platform tower hub and nacelle z g is the system s vertical coordinate of the center of gravity i y y is the total moment of inertia in pitch a i j are the zero frequency added mass coefficients b i i are the linearized viscous damping coefficients in surge and pitch c 55 h s is the linear hydrostatic restoring coefficient in pitch already accounting for gravitational effects c i j m r are the linear mooring restoring coefficients x is the displacement in surge θ is the pitch angle f a e r is the turbine thrust and z h u b is the hub height 3 2 control system wind turbines are normally equipped with a control system in order to optimize power production and interrupt the operation under unfavourable conditions the nrel 5 mw wind turbine controller actuates on the generator torque q g e n and collective blade pitch angle β depending on the operational regime the generator torque is based on the filtered shaft velocity ω in the below rated regime 3 0 m s u w 11 4 m s the torque is proportional to the squared shaft velocity such as to optimize power production in the above rated region 11 4 m s u w 25 0 m s it is inversely proportional to the shaft velocity such as to keep the power constant in the above rated regime the rotor speed is regulated through changes in the blade pitch angle which lead to changes in the aerodynamic torque load the change in blade pitch angle is determined by a gain scheduled proportional integral pi controller 3 δ β k p β δ ω k i β 0 t δ ω d t where the proportional k p and integral k i gains are calculated as a function of the blades current pitch angle β see table 3 for the gains adopted for β 0 the input to the controller δ ω is the difference between the rotor speed and the reference rotor speed a more detailed description of the control strategy including the gain scheduling procedure is provided by jonkman et al 2009 3 3 external loads when a fwt oscillates under the action of wind it is subjected to three main sources of loads the aerodynamic thrust induced on the rotor 3 3 the drag on tower and hull should also be classified as an aerodynamic effect but is of secondary importance and therefore disregarded the hydrodynamic loads acting on the submerged portion of the platform and the mooring loads applied on the fairleads which normally are also underwater the aerodynamic thrust is a function of the relative flow velocity in the rotor which is a combination of the incident wind velocity the nacelle velocity and the inflow velocity when the turbine oscillates the nacelle velocity is also oscillatory and so is the thrust a phase shift however is observed between thrust and nacelle velocity this effect may be worked out and treated as a modification in the nacelle s inertia and damping therefore influencing the fwt decay periods in the absence of waves hydrodynamic loads may be divided into two groups the radiation loads related to the waves produced by the body s motion and the viscous loads which are a function of the body s velocity for typical surge pitch decay periods ω 0 radiation loads reduce to acceleration proportional terms commonly known as added mass the added mass influences the natural periods but there is no reason to relate it to the period changes for different wind velocities 4 4 actually geometric changes due to variations in the mean pitch offset can affect the radiation loads this effect is however disregarded in the benchmark simulations presented in section 2 and therefore are also neglected here viscous damping also affects natural periods but cannot be used to explain the period variations either catenary mooring systems normally provide fairly linear stiffness when the platform is close to the neutral position for surge however the stiffness gets nonlinear as the platform is displaced along the x axis therefore when subjected to a mean wind loading the platform may oscillate around a mean position which lies in the nonlinear range leading to a natural period different from when the system oscillates around the neutral position it is then expected that the nonlinearities induced by aerodynamic thrust and catenary mooring system should play prevailing roles behind the period variation phenomenon as discussed below 4 prediction of the decay period changes for varying u w simplified representations for the nonlinear effects discussed in the previous section are now developed providing means to estimate the decay periods based on equation 2 4 1 mooring system nonlinearities catenary mooring systems are meant to position a floating body using the mooring lines own weight in water when the platform is displaced away from the anchor a portion of the line resting on the seabed is lifted increasing the weight to be supported by the floater in addition due to the change in angle the horizontal component of the tension increases also contributing nonlinearly to the horizontal restoring force brown 2005 the nonlinearity is evident in fig 5 where the mooring stiffness curves for the three platforms are shown when subjected to a mean wind force the platform will oscillate around the corresponding offset with different stiffnesses and therefore periods for varying wind velocities loads induced by catenary mooring systems may be estimated analytically faltinsen 1993 here expressions for the mooring stiffness are instead determined through polynomial fitting of the data in fig 5 since the wind displaces the fwt towards the positive x direction the fitting is made for x 0 only 3rd order polynomials are found to fit the data with excellent agreement such that the following nonlinear stiffness model is applied 4 f r x k 1 x k 2 x 2 k 3 x 3 k x x where k 1 k 2 and k 3 are obtained from the data fitting procedure and the x dependent stiffness coefficient is given by 5 k x k 1 k 2 x k 3 x 2 time domain simulations can be performed by replacing the c 11 m r element of the stiffness matrix with k x calculated according to the procedure above in equation 2 alternatively the nonlinear model of equation 4 can be linearized around a given offset x 0 keeping up to first order terms in a taylor expansion it becomes 6 f r x k 2 x 0 2 2 k 3 x 0 3 k 1 2 k 2 x 0 3 k 3 x 0 2 x such that the linearized stiffness coefficient k 11 l i n is given by 7 k 11 l i n x 0 k 1 2 k 2 x 0 3 k 3 x 0 2 typical platform rotations in pitch do not produce important geometric changes in the mooring lines resulting in a fairly linear behavior for the mooring stiffness in this dof therefore the main source of nonlinear mooring restoring for pitch comes from the surge pitch coupling which depends on the vertical distance from the fairleads to the platform s center of gravity still restoring in pitch for catenary moored fwts is dominated by hydrostatic effects which for typical pitch angles have linear behavior therefore mooring stiffness should not be behind the observed changes in the pitch decay period for varying incident wind velocities the pitch period changes must then be related to the r h s of equation 2 4 2 prediction of the surge decay periods with a linearized stiffness matrix a simple way to estimate the surge decay periods is to linearize the stiffness around the offset associated to a given u w using the x 0 values obtained from the sima simulations in equation 7 the coefficients k 1 k 2 and k 3 for each curve in figure 5 are presented in table 4 the cross terms of the mooring stiffness matrix are obtained from the linear stiffness in surge multiplied by the fairleads vertical position relative to the swl z f l and the term for pitch is kept unchanged the matrix for a given offset c m r x 0 is then given by 8 c m r x 0 k 11 l i n x 0 k 11 l i n x 0 z f l k 11 l i n x 0 z f l c 55 m r the period for each u w can then be calculated from the eigenvalues of equation 2 with the stiffness matrix defined as above 4 3 aerodynamic apparent inertia stiffness and damping effects let a fwt be subjected to steady non turbulent wind the airflow velocity w t is the relative axial flow velocity felt by the rotor and is given by 9 w t w 0 w i t x n a c where w 0 is the incident wind velocity x n a c is the nacelle horizontal velocity and the inflow velocity w i is a flow induced in the rotor by the vorticity shed by the blades as stated by the biot savart law platform oscillations affect w t through variations in x n a c 5 5 the inflow velocity w i is also affected but in a much lower degree provoking fluctuations in the rotor torque and thrust a thorough discussion about this effect is provided by pedersen 2017 appendix a summarizes the most relevant formulations from that work for the purposes of this paper particularly important insight is obtained from a combination of equations a 5 and a 6 leading to the following expression for the thrust 6 6 note that equation a 6 actually refers to the circulatory thrust only i e the drag portion a 7 is disregarded in this discussion due to its relatively lower importance 10 f κ cos u w sin u ω ℓ ω where u is the blade pitch control action ω is the rotor angular velocity and κ ℓ are constants noting that u 0 in the below rated regime no blade pitch action equation 10 reduces to 11 f κ w ω replacing w as given by 9 and writing the rotor velocity as a mean plus a varying term ω t ω 0 ω t the following expression is obtained for the thrust in the below rated regime 12 f κ ω 0 w 0 w i κ w 0 w i ω κ ω 0 x n a c where only linear terms were kept assuming small variations in w i the first term in the r h s of equation 12 may be seen as a constant while the second term depends essentially on the rotor dynamics the last term oscillates proportionally to x n a c and since κ and ω 0 are both positive the negative sign implies that the thrust in the below rated region will always induce a damping effect into the nacelle dynamics when the turbine operates in the above rated regime the blade pitch control system results in non zero values for u and equation 11 may be rewritten according to 13 f κ ω cos u w 0 w i sin u ω ℓ κ ω 0 cos u x n a c the second term now depends on cos u which is a function of the generator angular velocity through a pi controller therefore it is no longer possible to affirm that the oscillating term is proportional to x n a c while an analytical development of this relation is not in the scope of this paper it is of interest to understand how f varies as a function of x n a c in the above rated regime and the consequent effects on the system global dynamics for this purpose a series of simulations were executed in which the nrel 5 mw turbine including controller oscillated horizontally with rotor aerodynamics calculated with aerodyn moriarty and hansen 2005 it was decided to adopt the bem formulation with dynamic stall correction and the blades were kept rigid the oscillation amplitude was 10 0 m and the period varied from 20 0 s to 160 0 s with increments of 1 0 s the incident wind velocities are the same as those presented in table 2 fig 6 shows the aerodynamic thrust and nacelle velocity for an oscillation period of 30 0 s and incident wind velocities of 9 0 m s 11 4 m s and 18 0 m s it is suggested that the thrust f can be written as a sum of a mean term f m e a n u w and a varying term f v a r u w x n a c 14 f a e r f m e a n u w f v a r u w x n a c for u w 9 0 m s the phase difference between f v a r and x n a c is close to π rad which is in agreement with the discussion above defining a velocity to thrust amplitude factor f 0 f v a r u w x n a c may be rewritten as follows 15 f v a r u w x n a c f 0 x n a c the 1 dof motion of the nacelle with mass m stiffness k and damping c and forced by f is driven by 16 m x c x k x f m e a n f 0 x m x c f 0 x k x f m e a n where the nac indicator on x was suppressed for conciseness the discussed damping effect of the thrust is now more visible this is a well known effect for fwts explained e g in jonkman 2008 goupee et al 2017 the second and third plots of fig 6 however show that the controller action results in the thrust oscillating with a phase ϕ relative to the nacelle velocity this effect also reported in lennie et al 2016 is not fully understood yet but dynamic wake effects actuator dynamics and delays induced by signal filtering may possibly contribute to it assuming that the nacelle motion may be described as x t x 0 sin ω t the velocity is given by x t x 0 ω cos ω t and f v a r becomes 17 f v a r f 0 x 0 ω cos ω t ϕ f 0 x 0 ω cos ω t cos ϕ x 0 ω sin ω t sin ϕ f 0 x cos ϕ ω x sin ϕ noting that ω x ω 2 ω x x ω the last term of equation 17 can then alternatively be written as 18 f v a r f 0 x cos ϕ x ω sin ϕ in the above rated regime the thrust is thus no longer proportional to the nacelle velocity only but rather to a combination of nacelle velocity and position acceleration in the latter case the effect may be interpreted as an apparent inertia 19 m f 0 ω sin ϕ x c f 0 cos ϕ x k x f m e a n variations in the system s natural period can now be related to f 0 and ϕ when the phase is such that sin ϕ increases the thrust effect on the system s damping is reduced and the apparent changes in inertia become more important a quantification of this influence demands a better understanding on how f 0 and ϕ vary with the incident wind velocity the nacelle s period of oscillation and the motion amplitude 4 4 quantification of the apparent inertia and damping effects induced by the thrust the above mentioned simulations with aerodyn provided a total of 3384 pairs of rotor thrust and nacelle velocity time series for each pair a fast fourier transform fft was performed for both time series yielding their discrete frequency domain representations the phase ϕ between the time series could then be determined as the angle of the ratio between the thrust and nacelle velocity representations in the frequency domain at the frequency of oscillation the velocity to thrust amplitude factor f 0 is obtained directly from the time series by considering the ratio of their maximum amplitudes fig 7 shows the values of ϕ calculated as explained above one can clearly distinguish the below rated region by the nearly uniform phase values close to π rad as discussed previously close to u w 11 4 m s the phase values change smoothly for shorter oscillation periods lying between π 6 rad and 2 π 3 rad as the wind velocity increases when the period is longer the change is more abrupt and the phase tends to be smaller lying between 0 rad and π 6 rad this indicates that when the system dynamics are slower the thrust tends to follow the velocity more closely another important feature of the plot is that it helps to visualize the operating conditions when according to equation 19 the thrust results in a negative damping effect i e when the phase lies between 0 rad and π 2 rad this is observed for most of the above rated region but for shorter periods and wind velocities closer to rated the phase may be slightly higher than π 2 rad this may be useful e g during the design of a controller the f 0 factor values are presented in a similar scheme in fig 8 in general the factor changes more intensely near rated wind velocity where it is highly amplified in comparison to other operational regions the thrust amplitude changes much faster from below rated to rated when the periods are longer while this transition is smoother for shorter periods once ϕ and f 0 are known the apparent inertia and damping from thrust can be quantified from equation 19 the aerodynamic apparent inertia and damping coefficients a a e r and b a e r are defined according to 20 a a e r f 0 ω sin ϕ b a e r f 0 cos ϕ the matrices of aerodynamic apparent inertia and damping can then be written as 21 a a e r a a e r a a e r h n a c a a e r h n a c a a e r h n a c 2 22 b a e r b a e r b a e r h n a c b a e r h n a c b a e r h n a c 2 where h n a c is the height of the nacelle with respect to swl one should note that figs 7 and 8 are based on imposed nacelle oscillations i e the motions are not affected by the thrust this is in contrast with the decay simulations in which the motions are not only influenced by the thrust but also indirectly modify it through the changes in flow velocity and varying rotor speed indeed the second term on the r h s of equation 12 depends on ω whose dynamics are given by 23 ω q a e r q g e n i r o t where q a e r and q g e n are the aerodynamic and generator torque respectively and i r o t is the rotor moment of inertia around the shaft from equation a 6 and the discussions in section 3 2 the dependence of ω on both x n a c and ω become evident but this is not captured by the proposed model inaccuracies on the period predictions are therefore expected especially in the below rated regime above rated the torque regulation through blade pitch control reduces the importance of the rotor dynamics leading to more accurate period predictions 4 5 prediction of the pitch decay periods based on the apparent inertia and damping effects the aerodynamic effects on inertia and damping can be accounted for in the fwt dynamics by adding a a e r and b a e r to the inertia and damping matrices 24 m m r b a r a d 0 a a e r 25 b b v l b a e r such that equation 2 can now be rewritten as follows 26 m η b η c η f w i n d where f w i n d is formed by the mean thrust component f m e a n 27 f w i n d f m e a n f m e a n z h u b it is assumed in equation 27 that the pitch angle is small enough for the dependence in θ to be neglected as it is noted the varying component of the thrust is now absorbed by the inertia and damping matrices making it straightforward to relate its effects to changes in the decay periods for different incident wind velocities the pitch decay period for a given u w can be calculated once the coefficients a a e r and b a e r are known these coefficients however depend themselves on the period such that an iterative procedure is adopted departing from an initial guess for the period the phase ϕ and the amplitude factor f 0 are obtained by interpolation in the matrices presented in figs 7 and 8 a new value for the period is then obtained based on the corresponding a a e r and b a e r and is compared to the previous guess the process is repeated until the difference becomes lower than a given tolerance the relevance of the apparent inertia can now be assessed table 5 shows the ratio between the apparent inertia and the rigid body plus zero frequency added inertia in surge top and pitch bottom for three values of u w for surge the effect of apparent inertia is irrelevant for the below and above rated regimes while near rated the value may have some importance 7 7 fig 7 shows however that for periods higher than 90 0 s the change in phase at 11 4 m s is quite sudden such that one should be careful with the phases and therefore inertia damping effects calculated for this wind speed for pitch the apparent inertia is again negligible at the below rated region for above rated however the nacelle apparent inertia assumes values that when multiplied by the squared nacelle height may result in an apparent moment of inertia effect with order of magnitude comparable to the fwt s rigid body and added inertia depending on the platform the apparent damping effect is relevant for both surge and pitch as indicated in table 6 for below rated wind speeds it may significantly increase the viscous damping at both dofs for u w 11 4 m s however the damping assumes a negative value in surge even exceeding the equivalent linear viscous coefficient for the oc4semi in the sima simulations where the damping is a combination of linear and quadratic terms this results in an effective zero damping scenario leading to the limit cycle effect discussed in section 2 3 for pitch however the damping is still positive at rated but becomes negative for all platforms as the wind velocity increases 5 results the natural frequencies for each u w are obtained from the eigenvalues of the undamped and homogeneous version of equation 2 28 m η c η 0 where for surge the mooring stiffness matrix is written as in equation 8 while for pitch the inertia matrix includes a a e r as given by equation 24 the undamped natural frequency for a given dof ω 0 i is then corrected for accounting for damping yielding the decay frequency ω d i 29 ω d i ω 0 i 1 ζ i 2 where ζ i is the relative damping coefficient while for surge it is based on the b 11 coefficients from section 3 for pitch it also accounts for the main diagonal elements of the matrix given in equation 22 5 1 periods in surge the predicted surge periods are presented in figs 9 11 which show the estimates for the three fwt concepts considered under the range of incident wind velocities of table 2 the bottom plots bring the relative error between estimated and simulated periods for the oc3 hywind fig 9 the estimated periods match the simulations with an error in general lower than 0 5 in the above rated regime for the below rated region there is an increase in the relative error as the wind speed approaches the rated condition notably for u w 8 0 11 0 m s at this range of wind speeds the platform offsets in surge are not so different from what is observed for u w 12 0 16 0 m s where the discrepancy between simulations and estimates is much lower this suggests that the discrepancies may hardly be attributed to the linearization method adopted the agreement between estimated and simulated periods is much better for the oc4semi fig 10 and the csc5mw fig 11 indeed the relative error for both fwts is lower than 1 for most u w values increasing only near rated wind velocity 5 2 periods in pitch figs 12 14 show the estimated decay periods in pitch for the three fwt concepts considered under the range of incident wind velocities of table 2 for all three concepts it is seen that the period variation from the sima simulations is very satisfactorily followed by the estimates in the rated and above rated regime for the oc3hywind the relative error for u w 11 4 m s is around 4 lying below 2 for higher velocities for the oc4semi and csc5mw the relative errors are even smaller with simulated and estimated curves nearly coincident along the above rated regime in the below rated region however the estimates for all concepts fail to predict a depression observed for the simulated periods in the range 6 0 m s u w 10 0 m s a possible explanation may be the absence in the simplified model of the influence of the rotor dynamics as discussed in section 4 4 even though all three fwt concepts are equipped with the same turbine the magnitude of the period changes is not the same as already pointed out in section 2 3 this can be related to the fact that the natural periods for u w 0 differ for each design falling in different regions of fig 7 indeed fig 7 shows that at the range of periods between 20 0 s and 40 0 s the phases vary significantly in the above rated regime implying that modest changes in the fwt inertia properties may heavily influence the period variation phenomenon 6 conclusions as previously reported in bachynski et al 2016 goupee et al 2017 surge and pitch decay periods variations were observed for fwts operating under different incident wind velocities in this paper the effect was reproduced in time domain simulations performed with sima and an investigation for its origins was carried out it was found that the period variations in surge and pitch have distinct sources while for the former the effect is mainly linked to the mooring system nonlinearities for the latter it is induced by the thrust at the turbine in combination with the nacelle motions a simplified model was then applied for predicting the period variations as a function of the incident wind velocity for surge the mooring stiffness coefficient was linearized around the offsets associated to each u w and then the periods were found from the eigenvalues of the linear 2 dof equation of motion the predictions closely agreed with the simulated periods with relative errors of less than 1 along most of the range of u w values higher but still limited discrepancies were observed close to rated regime for pitch the relative phase between nacelle velocity and the thrust induced in the rotor could be related to apparent inertia and damping terms in the equations of motion this effect was quantified for a combination of wind velocities and oscillation periods through simulations involving aerodyn coupled to an 1 dof system inertia and damping coefficients were then included in a linear model from which the periods could be estimated the method resulted in precise predictions of the period in comparison with the time domain simulations in the above rated region in the below rated region a depression was noticed for the simulated data which could not be replicated with the approximated method the reasons for this discrepancy are unclear but a possible explanation could be that the phases and amplitudes from figs 7 and 8 are based on imposed nacelle oscillations which did not depend on the thrust and rotor dynamics in a coupled manner a better understanding of this coupling effect and how to include it in the simplified model would represent important contributions to the method the period variation in pitch depended on the height of the nacelle relative to swl the effect is expected to be more relevant for higher towers and thus more important for turbines of higher capacity on the other hand the phenomenon can be attenuated by proper tuning of the fwt s own pitch natural period by placing the oscillations in a range where the apparent inertia effect is less relevant the capability of predicting the period variation with a simplified method may be useful in different stages of the development of new fwt concepts for example the possibility of replacing full decay simulations which took approximately 15 min with an intel core i7 6500u 2 50 ghz cpu for each wind velocity for eigenvalues calculations 0 8 s for the entire range of wind velocities can be an advantage when different platform concepts are to be considered in early design phases further research may relate the proposed method to disciplines like structural integrity assessment control system design mooring systems and model testing the method could also contribute in the development of new frequency domain tools acknowledgements the authors are sincerely grateful to the financial support from ntnu imt and the centre for autonomous marine operations and systems norwegian research council project 223254 appendix a parametric aerodynamics model based on dynamic vortex theory pedersen 2017 devised a convenient model for the aerodynamic thrust and torque where the interconnected nature of those loads are made evident through the so defined circulation function from the kutta joukowsky theorem the lift force d f on a line element d l is given by a 1 d f ρ u r γ d l where γ is the circulation 8 8 the circulation is defined as the integral of the flow velocity field around any closed path c enclosing the airfoil γ c u d l and u r is the relative flow velocity which in a system of cylindrical coordinates r θ z fixed to the rotor is given by a 2 u r t e z w t e θ ω t r with w being the airflow and ω the rotor angular velocity under the assumption of purely axial inflow the normal component of d f is integrated over each of the blades leading to the following expression for the circulatory thrust f c a 3 f c t ρ a n 2 π γ t ω t where ρ is the density of the air a is the rotor swept area and n is the number of blades equivalently the circulatory torque is found by integrating the tangential component of d f along each blade a 4 q c t ρ a n 2 π γ t w t the author then proceeds with a series of simplifications for the circulation function with the objective of devising an engineering model without significant losses in accuracy notably by approximating γ as an equivalent airfoil model and assuming a flat plate behavior for small angles of incidence the circulation function g ω w u is defined as a 5 g ω w u κ cos u w sin u ω ℓ where κ 2 ρ a p r 3 λ with a p being the swept area corrected for blade tip losses 9 9 a common method for modelling tip loss effects is by reducing the effective rotor radius through multiplication by a factor 0 b 1 the corrected radius r p b r then results in an effective swept area a p b 2 a r the rotor radius λ the tip speed ratio for maximum wind power extraction and ℓ a length scale factor the parameter u is the controlled blade pitch angle which is non zero in the above rated region only the circulatory thrust and torque can then be rewritten as a 6 f c g ω w u ω q c g ω w u w drag may be relevant for the torque and in a lesser degree for the thrust the drag thrust and torque are modelled according to a 7 f d d f w w q d d q ω 2 where the coefficients d f and d q are determined in terms of losses in typical wind turbines the following compact model in matrix form is then proposed a 8 f q d f w g ω w u g ω w u d q ω w ω where the airflow w is given by equation 9 pedersen proposes that the low frequency dynamics of the inflow w i are driven by a 9 μ r p w i w w i f c 2 ρ a p where μ 8 3 π is a virtual inertia parameter 
22862,a new fully non hydrostatic model is developed and then applied to simulate the evolution of unidirectional propagating waves in intermediate and deep water the ability and efficiency of the model are examined using experimental data then the evolutions of initially uniform and perturbed wave trains are simulated frequency downshift phenomena occur during the wave evolution for a small initial steepness there are approximately two incidents of partial recurrence however with increasing initial wave steepness the energy transfers from the lower sideband to the carried wave decreases and a permanent frequency downshift is more likely to occur for the initially imposed wave trains if the wave steepness is lower than 0 11 an approximate fermi pasta ulam fpu phenomenon occurs for wave trains with a steepness of approximately 0 13 a partial recurrence still can appear recurrence is not observed in larger wave trains additionally the kinematics of extreme waves formed during the wave evolution are also investigated and the non dimensional horizontal velocity profiles under the extreme crests are converged and can be well modelled by the theoretically exponential curve in addition the crest speeds of the steep waves are less than the linear wave speeds it is found that larger waves have slower crest speeds keywords non hydrostatic model water waves modulational instability extreme waves kinematics 1 introduction modulational instability which was first found by benjamin and feir 1967 is a phenomenon in which the propagation of a wave train is unstable under small perturbations if the water depth kh k is the wave number and h is the local water depth is larger than 1 363 under this instability perturbations grow exponentially in the propagation direction with the expense of primary waves at present modulational instability has widely been considered as one of the possible physical mechanisms of generating freak waves janssen 2004 kharif 2003 osborne 2010 zakharov et al 2006 which have devastating effects on marine structures in recent decades many studies have been conducted to analyse the phenomenon through theoretical predictions experimental confirmations and numerical simulations zakharov 1968 demonstrated that the evolution of weakly nonlinear and narrowband deep water wave trains can be well modelled by the nonlinear schrödinger nls equation in the framework of the nonlinear schrödinger equation the evolution of modulational instability exhibits the fermi pasta ulam fpu recurrence phenomenon yuen and ferguson 1978 which was first discovered by fermi pasta ulam fermi et al 1955 the physical experiments of lake et al 1977 also found that wave trains with small steepness exhibit a recurrent fashion according to the nls equation both the lower and upper sidebands have same growth rates however models with a high order of nonlinearity such as the dysthe equation dysthe 1979 and the higher order spectral model dommermuth and yue 1987 west et al 1987 indicate that the evolution of the sidebands is not symmetrical lo and mei 1985 kato and oikawa 1995 tao et al 2012 tulin 1996 trulsen and dysthe 1990 physical experiments have also confirmed the asymmetric modulations melville 1982 1983 conducted a series of sideband evolution experiments in which the initial wave steepness is much higher than that in lake et al 1977 and revealed that the evolution of the spectrum will form a continuous spectrum rather than be restricted to a few discrete frequencies indicating that the fpu recurrence phenomenon is not a complete description of the evolution of modulational instability tulin and waseda 1999 conducted a series of experiments and showed that the fpu recurrence phenomenon occurred in an initially perturbed wave train without breaking and that wave breaking could result in irreversible energy transfer from the higher to the lower sidebands numerical simulations in the framework of nls equations have found that energy dissipation can cause a permanent downshift kato and oikawa 1995 trulsen and dysthe 1990 however chiang and hwung 2007 and hwung et al 2007 found that the frequency downshift induced by wave breaking is not permanent in a super large wave flume 300 m in length 5 0 m in depth 5 2 m in width there are many studies on the effects of external factors such as currents ma et al 2013 wind kharif et al 2010 leblanc 2007 and dissipation ma et al 2012a b segur et al 2005 wu et al 2006 on modulational instability at present many numerical simulations of modulational instability have been conducted using various forms of the nonlinear schrödinger equations lake et al 1977 shabat and zakharov 1972 yuen and ferguson 1978 the higher order spectral model dold and peregrine 1987 dommermuth and yue 1987 wu et al 2006 tao et al 2012 and boundary integral models tulin 1996 however heretofore most simulations have been performed using spatially periodic boundary conditions to keep the computational domain small the main drawbacks of models based on nls equations are the narrow band assumption and weak nonlinearity which lead to a limited steepness range of validity ε 0 10 the ability of the high order spectral hos model to investigate modulational instability was first proven by dommermuth and yue 1987 since then many studies have been implemented based on the spectral model in addition based on the boundary elements method bem tulin et al 1994 1999 simulated the exact inviscid flow in a wave tank up to wave breaking with improvements in computational power navier stokes models have received more attention in particular non hydrostatic wave models have developed rapidly in recent years the models which are governed by navier stokes equations or the euler equations divide pressure into non hydrostatic and hydrostatic pressure unlike methods of capturing moving boundaries non hydrostatic models assume that the free surface elevation is a single value faction of the horizontal positions which significantly reduces the computational cost of these models compared to other navier stokes wave models ai et al 2011 bradford 2005 casulli 1999 chen 2003 lee et al 2006 lin and li 2002 ma et al 2012a mahadevan et al 1996 mayer et al 1998 walters 2005 stelling and zijlema 2003 young et al 2007 young et al 2009 young and wu 2010 yuan and wu 2004a b zijlema and stelling 2005 these types of models have the advantage of simulating wave shoaling nonlinearity refraction and diffraction phenomena accurately and efficiently ai et al 2011 lee et al 2006 ma et al 2012a young and wu 2010 zijlema and stelling 2005 with the developing of non hydrostatic wave models the models are able to capture wave surface as well as velocity profiles using a few vertical layers in addition in contrast with boussinesq type wave models the dispersion ability of non hydrostatic models can be improved by increasing the number of vertical layers rather than by increasing the order of derivatives of the dependent variables stelling and zijlema 2003 at present non hydrostatic wave models are mainly used to simulate coastal hydrodynamics however these models still have great potential to simulate nonlinear waves in intermediate and deep water ai et al 2014 simulated nonlinear focusing wave groups in deep water and well reproduced the main characteristics of focusing waves using an in house developed non hydrostatic model young and wu 2010 resolved the propagation of bi chromatic wave groups in deep water by using a non hydrostatic model combined with embedded boussinesq type like equations modulational instability reflects the unbalance of the dispersion and nonlinearity of water waves as discussed by tulin et al 1994 and madsen et al 2002 the accurate modelling of the sideband instability requires an accurate description of amplitude dispersion thus it is a challenge to model modulational instability accurately to our knowledge non hydrostatic wave models have not been applied to simulate modulational instability in the present study a new fully non hydrostatic wave model is proposed then the model is used to investigate the long term evolution of wave trains in deep water in addition the propagation properties of long distance wave trains and related discussions of extreme waves will be examined following the introduction in section 2 the numerical algorithm of the non hydrostatic wave model is described in section 3 the model is validated by several classical experimental cases in section 4 the numerical results of the uniform and initially imposed wave trains are discussed finally conclusions are presented in section 5 2 description of the fully non hydrostatic wave model 2 1 governing equations the governing equations of the non hydrostatic free surface water flow are 3d incompressible euler equations the total pressure is decomposed into two parts namely the hydrostatic pressure ρg η z and the dynamic pressure p thereafter the equations in the cartesian coordinates are given by 1 u x v y w z 0 2 u t u u x v u y w u z g η x 1 ρ p x 3 v t u v x v v y w v z g η y 1 ρ p y 4 w t u w x v w y w w z 1 ρ p z where t is time u v and w are the velocity components in the horizontal x y and vertical z directions respectively g is the gravitational acceleration η is the free surface elevation and ρ is the water density taken here to be 1 0 g cm3 to accurately describe variations of the bottom and surface geometry vertical σ coordinates are adopted in the model of phillips 1957 the transformation between the σ coordinates and the cartesian system coordinates is as follows 5 σ z h d where d x y t h x y t η x y t h is water depth and η is the surface elevation therefore the value of σ varies from 0 to 1 when h spans from the bottom to surface elevation lin and li 2002 fig 1 shows a schematic diagram of the transformation between the cartesian coordinates and the σ coordinates according to the coordinate transformation the governing equations in the vertical σ coordinate are 6 d t d u x d v y w ˆ σ 0 7 d u t u d u x v d u y w ˆ u σ g d d h x d ρ p x p σ σ x 8 d v t u d v x v d v y w ˆ v σ g d d h y d ρ p y p σ σ y 9 d w t u d w x v d w y w ˆ w σ 1 ρ p σ where du dv dw are the conservative velocities in the x y and the z coordinates and w ˆ is the vertical velocity in the σ coordinates given by 10 w ˆ d d σ d t d σ t u σ x v σ y w σ z in which 11 σ t 1 d h t σ d d t σ x 1 d h x σ d d x σ y 1 d h y σ d d y σ z 1 d 2 2 boundary conditions to solve the governing equations boundary conditions in all physical boundaries must be imposed considering the parallel computing implementation two ghost cells are used at each boundary to specify the boundary conditions ma et al 2012a fig 2 shows the layout of ghost cells in the horizontal direction the kinematic boundary conditions at the free surface and the impermeable bottom in cartesian coordinates can be written as 12 η t u η x v η y w z η 13 h t u h x v h y w z h taking eq 10 into eq 12 and eq 13 the velocity boundary conditions in the vertical σ coordinates are obtained 14 w ˆ σ 0 w ˆ σ 1 0 using the kinematic boundary conditions i e eq 14 in the integrated form of the continuity equation eq 6 over the water column the free surface equation is obtained 15 d t x d 0 1 u d σ y d 0 1 v d σ 0 boundary conditions are divided into the inlet and outlet boundaries at the inlet boundary waves are generated by specifying a local velocity and the wave surface elevation at the outlet boundary an absorbing condition is employed to guarantee that the waves cross the outflow boundary without reflections in the model a sponge layer technology larsen and dancy 1983 is employed 2 3 spatial discretization the 3d physical domain is divided into several rectangular grids set i j k as the centre of the cells to apply the keller box method stelling and zijlema 2003 the pressure is placed at the upper cell faces denoted by i j k 1 2 however the velocity u v w and water surface η are located at the cell centre i j k ma et al 2012a the layout of the computational variables is shown in fig 3 2 4 numerical algorithm to avoid introducing a splitting error which can result in significant wave damping zijlema and stelling 2005 a projection method is adopted to discretize the governing equations the numerical algorithm is decomposed into three major steps to solve the governing equations first the intermediate velocity fields are obtained by solving the momentum equations that contain the non hydrostatic pressure at the previous time step second the non hydrostatic pressure difference of the current time step is computed by the discretized poisson equation and then the final velocity in the current time step is obtained by the pressure correction finally the wave surface is determined by the integrated form of the continuity equation fig 4 shows a flow chart of the computing procedure in the first step the momentum equations eqs 7 9 containing the non hydrostatic pressure are solved to obtain the new intermediate conservative velocity field du dv dw to track the wave breaking point automatically without adding other conditions to judge when and where breaking occurs the shock capturing method based on the second order godunov type finite volume approach is employed ma et al 2012a therefore eqs 7 9 are rewritten into the following forms 16 u t f x g y h σ s h s p where u d u d v d w t f g and h are fluxes and s h and s p are source terms f d u u 1 2 g η 2 g h η d u v d u w g d u v d v v 1 2 g η 2 g h η d v w h u w ˆ v w ˆ w w ˆ 17 s h g η h x g η h y 0 s p d ρ p x p σ σ x d ρ p y p σ σ y 1 ρ p σ consequently the intermediate velocity field is obtained as follows 18 u u n δ t f x g y h σ n s h n s p n in eq 18 the fluxes f g and h are required at the cell faces hence the values of the variables defined at the centre of the cell are calculated using a reconstruction method in the present study third order central weighted essentially non oscillatory cweno reconstruction is employed to improve the reconstruction accuracy and to avoid numerical oscillations the reconstruction method provides a third order accurate interpolant and efficiently prevents the production of spurious oscillations in the process the details of the reconstruction procedure can be found in levy et al 2000 after the reconstruction cell faces velocity u l u r the flux is calculated by solving the riemann problem the musta riemann approximation toro 2006 is adopted here to estimate the fluxes at the horizontal cell faces compared with other riemann approximation methods such as hll harten et al 1983 this method does not need to solve the wave speed of the local riemann problem and therefore can reduce the complexity of the computation in the second step the non hydrostatic pressure difference of the current time step is computed by the discretized poisson equation then the final velocities in the current time level are obtained by the pressure correction 19 u n 1 u δ t s p n 1 s p n s δ p n 1 the above equation can be written as 20 d u n 1 d u δ t ρ d δ p x δ p σ σ x n 1 21 d v n 1 d v δ t ρ d δ p y δ p σ σ y n 1 22 d w n 1 d w δ t ρ δ p n 1 σ the poisson equation for the non hydrostatic pressure correction term δp is derived by substituting the expressions for the new velocities from eqs 20 22 into eq 6 then the equation is discretized with the second order space centred finite difference method finally the poisson equation is symbolically written as 23 a δ p b where a is an asymmetrical sparse coefficient matrix δp is a vector of the calculated non hydrostatic pressure correction and b is a known vector related to the intermediate velocities lastly surface elevations are achieved by the integrated form of the continuity equation 24 d t x d 0 1 u d σ y d 0 1 v d σ 0 2 5 the grid division criterion in the vertical direction it is well known that the grid division for computational areas especially in the vertical direction is an important issue for non hydrostatic models ai et al 2011 ma et al 2012a b zijlema et al 2011 non hydrostatic models could improve their frequency dispersion by simply increasing their number of vertical layers zijlema et al 2011 therefore knowing how to reasonably divide vertical layers is the key issue to guarantee the accuracy of the models in non hydrostatic models vertical grid division includes both uniform layers and equal ratio non uniform layers the latter permits higher resolution near the free surface via a smooth transition the equal ratio coefficient varies from 0 to 1 with decrease in the equal ratio coefficient the non uniformity of the grid and the resolution near the wave surface increase hence in the present study for the long term simulation of nonlinear waves in deep water equal ratio non uniform layers are adopted to satisfy the high dispersion furthermore due to the improvement of accuracy is limited when vertical layers reach a reasonable amount see section 3 1 therefore simulations with different vertical layers are examined then for a case the least number of vertical layer in the condition of guaranteeing accuracy to capture the amplitude dispersion is chosen 3 model validations to evaluate the accuracy and efficiency of the non hydrostatic model developed in the present study the model is first applied to simulate two classical test cases of wave motions the first test case is a standing short wave in a 2d closed basin this test case has been simulated in many tests casulli 1999 casulli and stelling 1998 chen et al 2003 on the basis of these simulations the present model increases the water depth to demonstrate the model s capacity to simulate linear wave dispersion in deep water conditions the second test case is a 2d dispersive focusing wave in deep water baldock et al 1996 this case could verify the model s capacity to simulate strong nonlinear waves 3 1 standing waves in closed basins the closed basin has a length of l 20 m and depth of h 10 m the initial free surface profile is given by 25 η a cos k x 0 x l where η is the surface elevation a 0 1 m is the amplitude of the standing wave l 20 m is the wave length k 2π l is the wave number and ω 2π t 1 75 rad s is the circular frequency and satisfies the dispersion relationship ω 2 gkth kh kh π the horizontal grid size δx 0 2 m and the time step δt 0 01 s are used in the calculation the simulation time is 30 s only two uniform layers are employed in the vertical direction fig 5 shows the comparisons between numerical and analytical surface elevations at x 0 1 m and x 17 5 m the simulation results agree well with the analytical solution to further study the capacity of the model in deeper water the water depth is increased to 100 m i e kh 10π but the wave parameters are unchanged in addition in the simulation five uniform layers are adopted in the vertical direction fig 6 shows the comparison results between the numerical and analytical surface elevations the present model still works well in deep water these case results show that the model can accurately predict both the amplitude and phase of short standing waves with only a few vertical layers to quantify the errors between numerical and analytical results a root mean square error is defined as follows 26 e r r o r 1 n i 1 n η a η i 2 where n is the number of sampling data η a is the analytical wave surface η i is the numerical results the root mean square errors at x 17 5 m for different vertical layers and water depth kh are shown in fig 7 where k is the wave number and h is the water depth the simulation time is 30 s it is found that the errors decrease with increasing the number of vertical layers in general improvement is limited when more than 5 vertical layers are used therefore 5 vertical layers are enough to guarantee the accuracy of simulation to standing waves besides computation time of the two test cases are shown in table 1 the model is computationally efficient in simulating such cases in deeper water conditions as more vertical layers are needed the computational time increases significantly 3 2 dispersive focusing wave packets in intermediate and deep water to verify the ability of the present model to simulate strong nonlinear water waves cases of dispersive focusing wave groups in deep and intermediate water conditions baldock et al 1996 are simulated the flume is 20 m long and 0 3 m wide and the water depth is h 0 7 m a 5 m sponge layer is applied at the end of the computational domain wave groups with two frequency bands table 2 are considered in the simulations case a corresponds to a broad bandwidth δf 0 95 hz while case b represents a narrow bandwidth δf 0 42 hz each wave group consists of n 29 individual wave components in the frequency domain and the inputted linear focusing wave amplitudes are 38 cm and 55 cm the inflow boundary is imposed at x 0 m and the theoretical focusing position and time are specified as x a 8 m and t a 30 s respectively the simulation time is 35 s the wave components are of equal amplitude and are equally spaced within the period range in case b the horizontal grid size is set to δx 0 025 m δy 0 05 m and the time step is δt 0 0025 s in case a as the wave group contains components with shorter waves the horizontal grid size is smaller δx 0 0125 m and the time step is δt 0 00125 s ten uniform layers are employed in the vertical direction for both cases fig 8 shows the comparisons between the numerical and experimental results for the surface elevations at the focal position in addition the horizontal velocity profiles are demonstrated in fig 9 good agreements between the simulations and the experimental results are achieved therefore the model has the ability to simulate strong nonlinear waves table 3 shows the computation times of the test cases the simulation time is fairly short which further confirms the efficiency of the model to simulate nonlinear wave propagation furthermore with increasing computation grid size the grids for case a are larger than those for case b the simulation time obviously increases 4 simulation of the long term evolution of wave trains in this section the evolution of both initial uniform and disturbed wave trains with different steepness are simulated using the present model initial uniform wave trains can be written as 27 η t a c sin ω c t where η is the surface elevations a c is the amplitude ω c is the angular frequency of the carrier wave and t is the time imposed sideband wave trains can be written as 28 η t a c sin ω c t a sin ω t π 4 a sin ω t π 4 29 ω ω c δ ω where a c and a are the amplitudes of the carrier wave and the imposed sidebands denotes the upper side of the carrier wave and denotes the lower side of the carrier wave ω c and ω are the angular frequencies of the carrier and imposed sidebands and δω is the frequency difference between the carrier wave and imposed sidebands the initial phase difference between the carrier wave and imposed sidebands is set to π 4 corresponding to the fastest growth rate benjamin and feir 1967 to reduce the effect of wave fronts following tulin and waseda 1999 a finite ramp r t is added at the beginning of the wave generation signals 30 r t 1 2 1 cos π t τ 0 t τ where τ is the ramp duration which is set at 3 times the carrier wave period 4 1 the evolution of initially uniform wave trains first the long term evolution of initial uniform wave trains is simulated and compared with the experimental results of hwung et al 2007 in which a series of experiments were conducted in a large wave flume to study the further propagation properties of the wave trains in the present simulation the length of the numerical tank is 400 m which is approximately 100 m larger than that of the experiments the working depth is h 3 5 m the initial wave period is 1 6 s and the wave steepness varies from 0 165 to 0 25 the vertical layers adopted equal ratio non uniform layers and the equal ratio coefficient is 0 97 with increasing wave steepness the vertical layers range from 37 to 40 the horizontal grid size δx is set corresponding to 100 grid cells per wavelength a sponge layer with a length of three times the primary wave length is applied at the end of the computational domain to achieve a quasi steady state and ensure sufficiently long data samples to accurately calculate the power spectra the simulation time for each wave train is 2400 s fig 10 shows the simulated surface elevations of the initial uniform wave train k c a c 0 22 k c h 5 5 an unsteady wave front where the local wave amplitude increases gradually from zero to a steady state further evolves with the propagation of the wave trains at k c x 11 the wave trains are almost uniform except for the initial transient wave front with increasing propagation distance a distinct wave group with steep waves is gradually formed in the wave front at the same time the effect of the wave front is gradually transmitted to the back part of the wave train fig 11 shows the numerical surface elevations and corresponding wave spectra for the wave conditions k c a c 0 165 k c h 5 5 the spectra are obtained using a standard fft procedure with a hanning window the frequency resolution of the spectra is approximately 0 0122 hz at k c x 184 after approximately 29 wave length evolutions the initial uniform wave train gradually develops into a modulated wave train with distinct extreme waves obvious sidebands naturally grow with the increase in the energy of the primary wave at first the growth rate for the lower and upper sides are approximately equal however with increasing propagation distance the lower sideband gains more energy than the upper sideband eventually the lower sideband amplitude exceeds the initial primary wave amplitude resulting in a frequency downshift at k c x 283 approximately 45 wave lengths from the initial condition the maximum surface elevation increases with the growth of the lower sideband at approximately k c x 292 approximately 46 5 wave lengths from the initial condition the wave surface reaches its maximum 0 29 m which is 2 6 times the initial wave surface level approximately 0 11 m the local wave steepness kη m is 0 46 where k is defined as π divided by the local zero crossing separation spanning the given crest then the wave train demodulates and the carrier wave amplitude gradually recovers at k c x 424 approximately 67 wave lengths from the initial condition the carrier wave amplitude exceeds the lower sideband amplitude resulting in a temporary partial recurrence because this location is beyond the length of the experimental flume see fig 12 this temporary partial recurrence was not observed in the experiments of hwung et al 2007 hereafter the amplitude of the lower sideband exceeds the primary amplitude again the spatial variations in the non dimensional by the initial carrier wave amplitude amplitudes of the carrier wave and a pair of the fastest growth sidebands with three different wave steepness i e k c a c 0 165 0 220 and 0 252 are shown in fig 12 the experimental data of hwung et al 2007 are also embedded for comparison the numerical initial growth rates of the sidebands agree well with the experimental results these results demonstrate that the long term evolution of initial uniform wave trains with different steepness can be well simulated by the present model in addition according to the wave breaking area given by hwung et al 2007 the numerical model is able to capture wave breaking reasonably due to the shock capturing scheme employed based on godunov type approach in the model godunov type finite volume schemes assume that the flow variables at cell faces are discontinuous which are generally in the basis of riemann solvers to compute mass and momentum fluxes begnudelli et al 2008 even though this scheme can not resolve the complex process induced by breaking it can model changes of water surface elevations reasonable bradford 2010 ma et al 2012a b in fig 12 b the maximum wave surface reaches 0 31 m at k c x 170 which is 2 2 times the initial wave surface value approximately 0 14 m the local wave steepness kη m is 0 49 in fig 12 c at k c x 100 the maximum wave surface reaches 0 33 m which is 2 06 times the initial wave surface approximately 0 16 m the local wave steepness kη m is 0 52 as the numerical flume is longer than that of the experiments more information can be observed for example temporary recurrences the primary amplitude exceeds the lower sideband occur at k c x 420 and k c x 650 for the case with steepness of 0 165 as shown in fig 12 a notably in this case the numerical flume was extended to 700 m to investigate the evolution of the wave trains with the smallest wave steepness an approximate fpu phenomenon which was not observed in the experiment due to the length limitation of the wave flume will occur with slight increases in wave steepness the location wave recurrence appears is advanced in fig 12 b a transient wave recurrence occurs at k c x 280 reaching almost at the same location as that in the experiments however the second wave recurrence occurs at k c x 520 with a further increase of wave steepness wave recurrence does not occur and the amplitudes of the primary and sideband waves are relatively stable after k c x 300 the results indicate that the wave evolution is strongly related to the wave steepness and a permanent frequency downshift will occur after a sufficient propagation distance from the above results there is an obvious pair of sideband components that spontaneously grow with the expense of carrier wave energy in addition the frequency difference δf between the fundamental and lower and upper sidebands is almost the same which nearly satisfies the relationship f f c δf the sideband frequencies can be considered the most unstable frequency benjamin and feir 1967 to analyse the most unstable frequency a series of initial uniform wave trains table 4 with an initial steepness varying from 0 1 to 0 35 are simulated then the most unstable sidebands are obtained by analysing the simulation results as only identifying the most unstable sidebands the length of the numerical flume is set to 100 m and the depth is 1 m for each case the simulation time is 200 s table 4 shows the numerical conditions for the initial uniform wave trains the most unstable sidebands are shown in fig 13 the analytical solutions of benjamin and feir 1967 dysthe 1979 longuet higgins 1980 krasitskii 1994 and some experimental results hwung et al 2007 lake et al 1977 melville 1982 are also embedded for comparison the numerical results agree well with the experimental data further validating the ability of the present model 4 2 the evolution of the initially imposed sideband wave trains from the above evolution of the initially uniform wave trains temporary wave recurrences can be identified however perfect wave recurrence fpu can be predicted by theories yuen and ferguson 1978 for the evolution of imposed sideband wave trains tulin and waseda 1999 conducted a well controlled experiment and found near perfect wave recurrence for an initially imposed sideband wave train to further verify the present model the fpu recurrence case of tulin and waseda 1999 is simulated according to tulin and waseda 1999 the numerical flume is set to 50 m in length and 2 1 m in depth the carrier frequency is 1 23 hz and the lower and upper sideband frequencies are 1 12 hz and 1 34 hz respectively the initial carrier wave steepness is 0 1 and the initial perturbation rate is a a c 0 3535 the vertical layers are set to 40 and the equal ratio coefficient is 0 9 a 3 m sponge layer is applied at the end of the computational domain fig 14 shows the simulation results in both the time and the frequency domains the numerical results agree well with the experimental data further demonstrating the ability of the model chiang and hwung 2007 conducted a series of experiments with different wave steepnesses in a very large wave flume 300 m in length 5 0 m in depth 5 2 m in width to study the influence of steepness on the long time evolution of imposed sideband wave trains to further verify the capacity of the model the experimental cases of chiang and hwung 2007 are simulated by the present model however the numerical wave flume of the simulation is longer than that of the experiments to investigate the evolution of wave trains over a longer distance the numerical flume is 400 m long with a working depth of h 3 5 m as the initial wave steepness increases the vertical layers vary from 40 to 45 and the equal ratio coefficient is 0 92 the simulation time for each wave case is 600 s table 5 shows the detailed wave parameters fig 15 shows the comparisons of the non dimensional amplitudes nondimensionalized by the initial primary wave for the carrier wave and the sidebands the numerical results are almost identical to the experimental data with increasing wave steepness the wave evolution patterns vary from recurrence to a permanent frequency downshift due to the presence of wave breaking for the case with an initial wave steepness lower than 0 11 case a the numerical flume is extended to 600 m to investigate the evolution of the wave trains another wave recurrence which was not observed in the experiment due to the length limitation of the wave flume occurs by increasing wave steepness wave breaking occurs and stops fpu recurrence a frequency downshift phenomenon occurs after wave breaking but for waves with a moderate wave steepness ε 0 13 a temporally partial recurrence occurs a comparison of fig 15 b and c shows that for waves with the same initial wave steepness the evolution of wave trains accelerates with increasing water depth i e the partial wave recurrence is slightly advancing however subsequently the amplitude of the lower sideband exceeds that of the primary wave resulting in a permanent frequency downshift for waves with a large wave steepness fig 15 d and e permanent frequency downshift will occur after wave breaking 4 3 kinematics of large waves due to modulational instability as demonstrated in the previous section extreme waves are generated in the evolution process for example in fig 15 a at k c x 205 the maximum wave surface reaches 0 23 m which is 3 33 times the initial carrier wave surface value approximately 0 069 m the local wave steepness kη m is 0 39 in fig 15 b at k c x 300 the maximum wave surface reaches 0 29 m which is 3 49 times the initial carrier wave surface value approximately 0 083 m the local wave steepness kη m is 0 50 in fig 15 c at k c x 315 the maximum wave surface reaches 0 17 m which is 3 14 times the initial carrier wave surface value approximately 0 054 m the local wave steepness kη m is 0 44 in fig 15 d at k c x 188 the maximum wave surface reaches 0 19 m which is 3 01 times the initial carrier wave surface value approximately 0 063 m the local wave steepness kη m is 0 47 in fig 15 e at k c x 145 the maximum wave surface reaches 0 21 m which is 2 91 times the initial carrier wave surface value approximately 0 072 m the local wave steepness kη m is 0 50 describing velocities of extreme waves accurately is very important to the analysis of loads on coastal and marine structures many experimental studies have been conducted to obtain the kinematical characteristics of extreme waves using laser doppler velocimetry baldock et al 1996 kim et al 1992 longridge et al 1996 skjelbreia and torum 1989 skjelbreia and berek 1991 and particle image velocity grue et al 2003 the present model is able to obtain the wave velocities at each vertical level directly instead of estimating the velocities using theory therefore the calculated kinematics under the extreme waves in the evolution of wave trains can be obtained directly following grue s work grue et al 2003 the local wave number k and the wave slope ε for extreme waves are calculated from 31 ω 2 g k 1 ε 2 32 k η m ε 1 2 ε 2 1 2 ε 3 where ω 2π t t t t is the wave period defined trough to trough η m is the maximum crest elevation and g is the acceleration of gravity then the non dimensional velocities u ε g k are obtained because the background mechanism of generating extreme waves in both uniform wave trains and imposed sideband wave trains is actually modulational instability the velocities of the largest waves in these wave trains can be compared with the experiment data of grue et al 2003 specifically the 51 largest waves in the uniform wave trains and imposed sideband wave trains are investigated to calculate the non dimensional velocities u ε g k the parameter ε varies from 0 15 to 0 495 the non dimensional velocity profiles of the wave events are plotted together in fig 16 a strong collapse of the data is observed which agrees well with the experimental results of grue et al 2003 furthermore the maximum non dimensional velocities increase with increasing u ε g k local wave steepness in the experiment of grue et al 2003 a wave steepness lower than 0 35 was measured however in the present simulation the maximum steepness is approximately 0 5 as shown in fig 16 the horizontal velocities of these large waves are still modelled by the exponential curve in addition the investigation of the crest speeds of steep waves is an important subject longuet higgins 1975 suggested that the wave speed of maximally steep steady waves is approximately 1 1c 0 where c 0 is the linear wave speed however johannessen and swan 2001 2003 found an o 10 crest speed slowdown relative to the linear theory prediction of focusing waves banner et al 2014 and saket et al 2017 further validated the crest slowdown with extensive laboratory and field observations to investigate the crest speeds of steep waves in the evolution of wave trains using the simulation data the nondimensionalized crest speeds c c 0 of the steep waves against the local crest steepness e are shown in fig 17 where c 0 is the linear carrier wave speed and c is calculated by the spatial wave profiles within a time interval of 0 5 s the crest slowdown phenomenon occurs and all of the crest speeds of the steep waves are less than the wave speed for linear waves as the local wave slope increases the nondimensionalized crest speeds c c 0 decrease specifically when the local steepness is lower than 0 35 c c 0 varies from 0 8 to 0 95 whereas when the local steepness is greater than 0 35 c c 0 is in the range of 0 7 0 8 therefore most of the nondimensionalized crest speeds c c 0 are in the range of 0 7 0 9 which demonstrates the o 10 30 crest speed slowdown in the occurrence of extreme events 5 conclusions a new fully non hydrostatic free surface model is proposed and used to simulate unidirectional propagating wave trains in deep water the model is based on a vertical σ coordinate system the staggered grid system is employed to discretize the computational domain and the explicit method is used to discretize the incompressible euler equations the model adopts the musta riemann approximation to estimate fluxes at horizontal cell faces and the third order cweno is adopted to avoid numerical oscillations the accuracy and efficiency of the model are examined by two classic tests then the evolutions of initially uniform and perturbed wave trains are simulated by the model the results show that the most unstable perturbations and the growth rates agree well with experimental data in addition the numerical model is able to capture wave breaking reasonably according to the wave breaking area given by the experiments additionally the evolution of wave trains is strongly connected to the initial wave steepness for a small initial steepness partial recurrence occurs twice with evolution furthermore the location wave recurrence appears is advanced with a slightly increase in wave steepness however with a further increase in the initial wave steepness the energy transfer from the lower sideband to the carried wave decreases and a permanent frequency downshift occurs for the initially imposed wave trains an approximate fpu phenomenon will occur in the condition of an initial steepness lower than 0 11 if wave steepness is approximately 0 13 a partial recurrence will still appear even though the wave is breaking furthermore recurrence will not be observed for a wave steepness greater than 0 13 additionally the kinematics of the extreme waves formed during the wave evolution are studied the non dimensional horizontal velocity profiles under the extreme crests are converged and can be well modelled by the theoretically exponential curve in addition the crest speeds of the steep waves are less than the linear wave speed the maximum crest speed decreases with increasing local crest steepness acknowledgement this research is supported financially by the national natural science foundation of china grant nos 51720105010 51679031 and the fundamental research funds for the central universities of china grant no dut16td08 
22862,a new fully non hydrostatic model is developed and then applied to simulate the evolution of unidirectional propagating waves in intermediate and deep water the ability and efficiency of the model are examined using experimental data then the evolutions of initially uniform and perturbed wave trains are simulated frequency downshift phenomena occur during the wave evolution for a small initial steepness there are approximately two incidents of partial recurrence however with increasing initial wave steepness the energy transfers from the lower sideband to the carried wave decreases and a permanent frequency downshift is more likely to occur for the initially imposed wave trains if the wave steepness is lower than 0 11 an approximate fermi pasta ulam fpu phenomenon occurs for wave trains with a steepness of approximately 0 13 a partial recurrence still can appear recurrence is not observed in larger wave trains additionally the kinematics of extreme waves formed during the wave evolution are also investigated and the non dimensional horizontal velocity profiles under the extreme crests are converged and can be well modelled by the theoretically exponential curve in addition the crest speeds of the steep waves are less than the linear wave speeds it is found that larger waves have slower crest speeds keywords non hydrostatic model water waves modulational instability extreme waves kinematics 1 introduction modulational instability which was first found by benjamin and feir 1967 is a phenomenon in which the propagation of a wave train is unstable under small perturbations if the water depth kh k is the wave number and h is the local water depth is larger than 1 363 under this instability perturbations grow exponentially in the propagation direction with the expense of primary waves at present modulational instability has widely been considered as one of the possible physical mechanisms of generating freak waves janssen 2004 kharif 2003 osborne 2010 zakharov et al 2006 which have devastating effects on marine structures in recent decades many studies have been conducted to analyse the phenomenon through theoretical predictions experimental confirmations and numerical simulations zakharov 1968 demonstrated that the evolution of weakly nonlinear and narrowband deep water wave trains can be well modelled by the nonlinear schrödinger nls equation in the framework of the nonlinear schrödinger equation the evolution of modulational instability exhibits the fermi pasta ulam fpu recurrence phenomenon yuen and ferguson 1978 which was first discovered by fermi pasta ulam fermi et al 1955 the physical experiments of lake et al 1977 also found that wave trains with small steepness exhibit a recurrent fashion according to the nls equation both the lower and upper sidebands have same growth rates however models with a high order of nonlinearity such as the dysthe equation dysthe 1979 and the higher order spectral model dommermuth and yue 1987 west et al 1987 indicate that the evolution of the sidebands is not symmetrical lo and mei 1985 kato and oikawa 1995 tao et al 2012 tulin 1996 trulsen and dysthe 1990 physical experiments have also confirmed the asymmetric modulations melville 1982 1983 conducted a series of sideband evolution experiments in which the initial wave steepness is much higher than that in lake et al 1977 and revealed that the evolution of the spectrum will form a continuous spectrum rather than be restricted to a few discrete frequencies indicating that the fpu recurrence phenomenon is not a complete description of the evolution of modulational instability tulin and waseda 1999 conducted a series of experiments and showed that the fpu recurrence phenomenon occurred in an initially perturbed wave train without breaking and that wave breaking could result in irreversible energy transfer from the higher to the lower sidebands numerical simulations in the framework of nls equations have found that energy dissipation can cause a permanent downshift kato and oikawa 1995 trulsen and dysthe 1990 however chiang and hwung 2007 and hwung et al 2007 found that the frequency downshift induced by wave breaking is not permanent in a super large wave flume 300 m in length 5 0 m in depth 5 2 m in width there are many studies on the effects of external factors such as currents ma et al 2013 wind kharif et al 2010 leblanc 2007 and dissipation ma et al 2012a b segur et al 2005 wu et al 2006 on modulational instability at present many numerical simulations of modulational instability have been conducted using various forms of the nonlinear schrödinger equations lake et al 1977 shabat and zakharov 1972 yuen and ferguson 1978 the higher order spectral model dold and peregrine 1987 dommermuth and yue 1987 wu et al 2006 tao et al 2012 and boundary integral models tulin 1996 however heretofore most simulations have been performed using spatially periodic boundary conditions to keep the computational domain small the main drawbacks of models based on nls equations are the narrow band assumption and weak nonlinearity which lead to a limited steepness range of validity ε 0 10 the ability of the high order spectral hos model to investigate modulational instability was first proven by dommermuth and yue 1987 since then many studies have been implemented based on the spectral model in addition based on the boundary elements method bem tulin et al 1994 1999 simulated the exact inviscid flow in a wave tank up to wave breaking with improvements in computational power navier stokes models have received more attention in particular non hydrostatic wave models have developed rapidly in recent years the models which are governed by navier stokes equations or the euler equations divide pressure into non hydrostatic and hydrostatic pressure unlike methods of capturing moving boundaries non hydrostatic models assume that the free surface elevation is a single value faction of the horizontal positions which significantly reduces the computational cost of these models compared to other navier stokes wave models ai et al 2011 bradford 2005 casulli 1999 chen 2003 lee et al 2006 lin and li 2002 ma et al 2012a mahadevan et al 1996 mayer et al 1998 walters 2005 stelling and zijlema 2003 young et al 2007 young et al 2009 young and wu 2010 yuan and wu 2004a b zijlema and stelling 2005 these types of models have the advantage of simulating wave shoaling nonlinearity refraction and diffraction phenomena accurately and efficiently ai et al 2011 lee et al 2006 ma et al 2012a young and wu 2010 zijlema and stelling 2005 with the developing of non hydrostatic wave models the models are able to capture wave surface as well as velocity profiles using a few vertical layers in addition in contrast with boussinesq type wave models the dispersion ability of non hydrostatic models can be improved by increasing the number of vertical layers rather than by increasing the order of derivatives of the dependent variables stelling and zijlema 2003 at present non hydrostatic wave models are mainly used to simulate coastal hydrodynamics however these models still have great potential to simulate nonlinear waves in intermediate and deep water ai et al 2014 simulated nonlinear focusing wave groups in deep water and well reproduced the main characteristics of focusing waves using an in house developed non hydrostatic model young and wu 2010 resolved the propagation of bi chromatic wave groups in deep water by using a non hydrostatic model combined with embedded boussinesq type like equations modulational instability reflects the unbalance of the dispersion and nonlinearity of water waves as discussed by tulin et al 1994 and madsen et al 2002 the accurate modelling of the sideband instability requires an accurate description of amplitude dispersion thus it is a challenge to model modulational instability accurately to our knowledge non hydrostatic wave models have not been applied to simulate modulational instability in the present study a new fully non hydrostatic wave model is proposed then the model is used to investigate the long term evolution of wave trains in deep water in addition the propagation properties of long distance wave trains and related discussions of extreme waves will be examined following the introduction in section 2 the numerical algorithm of the non hydrostatic wave model is described in section 3 the model is validated by several classical experimental cases in section 4 the numerical results of the uniform and initially imposed wave trains are discussed finally conclusions are presented in section 5 2 description of the fully non hydrostatic wave model 2 1 governing equations the governing equations of the non hydrostatic free surface water flow are 3d incompressible euler equations the total pressure is decomposed into two parts namely the hydrostatic pressure ρg η z and the dynamic pressure p thereafter the equations in the cartesian coordinates are given by 1 u x v y w z 0 2 u t u u x v u y w u z g η x 1 ρ p x 3 v t u v x v v y w v z g η y 1 ρ p y 4 w t u w x v w y w w z 1 ρ p z where t is time u v and w are the velocity components in the horizontal x y and vertical z directions respectively g is the gravitational acceleration η is the free surface elevation and ρ is the water density taken here to be 1 0 g cm3 to accurately describe variations of the bottom and surface geometry vertical σ coordinates are adopted in the model of phillips 1957 the transformation between the σ coordinates and the cartesian system coordinates is as follows 5 σ z h d where d x y t h x y t η x y t h is water depth and η is the surface elevation therefore the value of σ varies from 0 to 1 when h spans from the bottom to surface elevation lin and li 2002 fig 1 shows a schematic diagram of the transformation between the cartesian coordinates and the σ coordinates according to the coordinate transformation the governing equations in the vertical σ coordinate are 6 d t d u x d v y w ˆ σ 0 7 d u t u d u x v d u y w ˆ u σ g d d h x d ρ p x p σ σ x 8 d v t u d v x v d v y w ˆ v σ g d d h y d ρ p y p σ σ y 9 d w t u d w x v d w y w ˆ w σ 1 ρ p σ where du dv dw are the conservative velocities in the x y and the z coordinates and w ˆ is the vertical velocity in the σ coordinates given by 10 w ˆ d d σ d t d σ t u σ x v σ y w σ z in which 11 σ t 1 d h t σ d d t σ x 1 d h x σ d d x σ y 1 d h y σ d d y σ z 1 d 2 2 boundary conditions to solve the governing equations boundary conditions in all physical boundaries must be imposed considering the parallel computing implementation two ghost cells are used at each boundary to specify the boundary conditions ma et al 2012a fig 2 shows the layout of ghost cells in the horizontal direction the kinematic boundary conditions at the free surface and the impermeable bottom in cartesian coordinates can be written as 12 η t u η x v η y w z η 13 h t u h x v h y w z h taking eq 10 into eq 12 and eq 13 the velocity boundary conditions in the vertical σ coordinates are obtained 14 w ˆ σ 0 w ˆ σ 1 0 using the kinematic boundary conditions i e eq 14 in the integrated form of the continuity equation eq 6 over the water column the free surface equation is obtained 15 d t x d 0 1 u d σ y d 0 1 v d σ 0 boundary conditions are divided into the inlet and outlet boundaries at the inlet boundary waves are generated by specifying a local velocity and the wave surface elevation at the outlet boundary an absorbing condition is employed to guarantee that the waves cross the outflow boundary without reflections in the model a sponge layer technology larsen and dancy 1983 is employed 2 3 spatial discretization the 3d physical domain is divided into several rectangular grids set i j k as the centre of the cells to apply the keller box method stelling and zijlema 2003 the pressure is placed at the upper cell faces denoted by i j k 1 2 however the velocity u v w and water surface η are located at the cell centre i j k ma et al 2012a the layout of the computational variables is shown in fig 3 2 4 numerical algorithm to avoid introducing a splitting error which can result in significant wave damping zijlema and stelling 2005 a projection method is adopted to discretize the governing equations the numerical algorithm is decomposed into three major steps to solve the governing equations first the intermediate velocity fields are obtained by solving the momentum equations that contain the non hydrostatic pressure at the previous time step second the non hydrostatic pressure difference of the current time step is computed by the discretized poisson equation and then the final velocity in the current time step is obtained by the pressure correction finally the wave surface is determined by the integrated form of the continuity equation fig 4 shows a flow chart of the computing procedure in the first step the momentum equations eqs 7 9 containing the non hydrostatic pressure are solved to obtain the new intermediate conservative velocity field du dv dw to track the wave breaking point automatically without adding other conditions to judge when and where breaking occurs the shock capturing method based on the second order godunov type finite volume approach is employed ma et al 2012a therefore eqs 7 9 are rewritten into the following forms 16 u t f x g y h σ s h s p where u d u d v d w t f g and h are fluxes and s h and s p are source terms f d u u 1 2 g η 2 g h η d u v d u w g d u v d v v 1 2 g η 2 g h η d v w h u w ˆ v w ˆ w w ˆ 17 s h g η h x g η h y 0 s p d ρ p x p σ σ x d ρ p y p σ σ y 1 ρ p σ consequently the intermediate velocity field is obtained as follows 18 u u n δ t f x g y h σ n s h n s p n in eq 18 the fluxes f g and h are required at the cell faces hence the values of the variables defined at the centre of the cell are calculated using a reconstruction method in the present study third order central weighted essentially non oscillatory cweno reconstruction is employed to improve the reconstruction accuracy and to avoid numerical oscillations the reconstruction method provides a third order accurate interpolant and efficiently prevents the production of spurious oscillations in the process the details of the reconstruction procedure can be found in levy et al 2000 after the reconstruction cell faces velocity u l u r the flux is calculated by solving the riemann problem the musta riemann approximation toro 2006 is adopted here to estimate the fluxes at the horizontal cell faces compared with other riemann approximation methods such as hll harten et al 1983 this method does not need to solve the wave speed of the local riemann problem and therefore can reduce the complexity of the computation in the second step the non hydrostatic pressure difference of the current time step is computed by the discretized poisson equation then the final velocities in the current time level are obtained by the pressure correction 19 u n 1 u δ t s p n 1 s p n s δ p n 1 the above equation can be written as 20 d u n 1 d u δ t ρ d δ p x δ p σ σ x n 1 21 d v n 1 d v δ t ρ d δ p y δ p σ σ y n 1 22 d w n 1 d w δ t ρ δ p n 1 σ the poisson equation for the non hydrostatic pressure correction term δp is derived by substituting the expressions for the new velocities from eqs 20 22 into eq 6 then the equation is discretized with the second order space centred finite difference method finally the poisson equation is symbolically written as 23 a δ p b where a is an asymmetrical sparse coefficient matrix δp is a vector of the calculated non hydrostatic pressure correction and b is a known vector related to the intermediate velocities lastly surface elevations are achieved by the integrated form of the continuity equation 24 d t x d 0 1 u d σ y d 0 1 v d σ 0 2 5 the grid division criterion in the vertical direction it is well known that the grid division for computational areas especially in the vertical direction is an important issue for non hydrostatic models ai et al 2011 ma et al 2012a b zijlema et al 2011 non hydrostatic models could improve their frequency dispersion by simply increasing their number of vertical layers zijlema et al 2011 therefore knowing how to reasonably divide vertical layers is the key issue to guarantee the accuracy of the models in non hydrostatic models vertical grid division includes both uniform layers and equal ratio non uniform layers the latter permits higher resolution near the free surface via a smooth transition the equal ratio coefficient varies from 0 to 1 with decrease in the equal ratio coefficient the non uniformity of the grid and the resolution near the wave surface increase hence in the present study for the long term simulation of nonlinear waves in deep water equal ratio non uniform layers are adopted to satisfy the high dispersion furthermore due to the improvement of accuracy is limited when vertical layers reach a reasonable amount see section 3 1 therefore simulations with different vertical layers are examined then for a case the least number of vertical layer in the condition of guaranteeing accuracy to capture the amplitude dispersion is chosen 3 model validations to evaluate the accuracy and efficiency of the non hydrostatic model developed in the present study the model is first applied to simulate two classical test cases of wave motions the first test case is a standing short wave in a 2d closed basin this test case has been simulated in many tests casulli 1999 casulli and stelling 1998 chen et al 2003 on the basis of these simulations the present model increases the water depth to demonstrate the model s capacity to simulate linear wave dispersion in deep water conditions the second test case is a 2d dispersive focusing wave in deep water baldock et al 1996 this case could verify the model s capacity to simulate strong nonlinear waves 3 1 standing waves in closed basins the closed basin has a length of l 20 m and depth of h 10 m the initial free surface profile is given by 25 η a cos k x 0 x l where η is the surface elevation a 0 1 m is the amplitude of the standing wave l 20 m is the wave length k 2π l is the wave number and ω 2π t 1 75 rad s is the circular frequency and satisfies the dispersion relationship ω 2 gkth kh kh π the horizontal grid size δx 0 2 m and the time step δt 0 01 s are used in the calculation the simulation time is 30 s only two uniform layers are employed in the vertical direction fig 5 shows the comparisons between numerical and analytical surface elevations at x 0 1 m and x 17 5 m the simulation results agree well with the analytical solution to further study the capacity of the model in deeper water the water depth is increased to 100 m i e kh 10π but the wave parameters are unchanged in addition in the simulation five uniform layers are adopted in the vertical direction fig 6 shows the comparison results between the numerical and analytical surface elevations the present model still works well in deep water these case results show that the model can accurately predict both the amplitude and phase of short standing waves with only a few vertical layers to quantify the errors between numerical and analytical results a root mean square error is defined as follows 26 e r r o r 1 n i 1 n η a η i 2 where n is the number of sampling data η a is the analytical wave surface η i is the numerical results the root mean square errors at x 17 5 m for different vertical layers and water depth kh are shown in fig 7 where k is the wave number and h is the water depth the simulation time is 30 s it is found that the errors decrease with increasing the number of vertical layers in general improvement is limited when more than 5 vertical layers are used therefore 5 vertical layers are enough to guarantee the accuracy of simulation to standing waves besides computation time of the two test cases are shown in table 1 the model is computationally efficient in simulating such cases in deeper water conditions as more vertical layers are needed the computational time increases significantly 3 2 dispersive focusing wave packets in intermediate and deep water to verify the ability of the present model to simulate strong nonlinear water waves cases of dispersive focusing wave groups in deep and intermediate water conditions baldock et al 1996 are simulated the flume is 20 m long and 0 3 m wide and the water depth is h 0 7 m a 5 m sponge layer is applied at the end of the computational domain wave groups with two frequency bands table 2 are considered in the simulations case a corresponds to a broad bandwidth δf 0 95 hz while case b represents a narrow bandwidth δf 0 42 hz each wave group consists of n 29 individual wave components in the frequency domain and the inputted linear focusing wave amplitudes are 38 cm and 55 cm the inflow boundary is imposed at x 0 m and the theoretical focusing position and time are specified as x a 8 m and t a 30 s respectively the simulation time is 35 s the wave components are of equal amplitude and are equally spaced within the period range in case b the horizontal grid size is set to δx 0 025 m δy 0 05 m and the time step is δt 0 0025 s in case a as the wave group contains components with shorter waves the horizontal grid size is smaller δx 0 0125 m and the time step is δt 0 00125 s ten uniform layers are employed in the vertical direction for both cases fig 8 shows the comparisons between the numerical and experimental results for the surface elevations at the focal position in addition the horizontal velocity profiles are demonstrated in fig 9 good agreements between the simulations and the experimental results are achieved therefore the model has the ability to simulate strong nonlinear waves table 3 shows the computation times of the test cases the simulation time is fairly short which further confirms the efficiency of the model to simulate nonlinear wave propagation furthermore with increasing computation grid size the grids for case a are larger than those for case b the simulation time obviously increases 4 simulation of the long term evolution of wave trains in this section the evolution of both initial uniform and disturbed wave trains with different steepness are simulated using the present model initial uniform wave trains can be written as 27 η t a c sin ω c t where η is the surface elevations a c is the amplitude ω c is the angular frequency of the carrier wave and t is the time imposed sideband wave trains can be written as 28 η t a c sin ω c t a sin ω t π 4 a sin ω t π 4 29 ω ω c δ ω where a c and a are the amplitudes of the carrier wave and the imposed sidebands denotes the upper side of the carrier wave and denotes the lower side of the carrier wave ω c and ω are the angular frequencies of the carrier and imposed sidebands and δω is the frequency difference between the carrier wave and imposed sidebands the initial phase difference between the carrier wave and imposed sidebands is set to π 4 corresponding to the fastest growth rate benjamin and feir 1967 to reduce the effect of wave fronts following tulin and waseda 1999 a finite ramp r t is added at the beginning of the wave generation signals 30 r t 1 2 1 cos π t τ 0 t τ where τ is the ramp duration which is set at 3 times the carrier wave period 4 1 the evolution of initially uniform wave trains first the long term evolution of initial uniform wave trains is simulated and compared with the experimental results of hwung et al 2007 in which a series of experiments were conducted in a large wave flume to study the further propagation properties of the wave trains in the present simulation the length of the numerical tank is 400 m which is approximately 100 m larger than that of the experiments the working depth is h 3 5 m the initial wave period is 1 6 s and the wave steepness varies from 0 165 to 0 25 the vertical layers adopted equal ratio non uniform layers and the equal ratio coefficient is 0 97 with increasing wave steepness the vertical layers range from 37 to 40 the horizontal grid size δx is set corresponding to 100 grid cells per wavelength a sponge layer with a length of three times the primary wave length is applied at the end of the computational domain to achieve a quasi steady state and ensure sufficiently long data samples to accurately calculate the power spectra the simulation time for each wave train is 2400 s fig 10 shows the simulated surface elevations of the initial uniform wave train k c a c 0 22 k c h 5 5 an unsteady wave front where the local wave amplitude increases gradually from zero to a steady state further evolves with the propagation of the wave trains at k c x 11 the wave trains are almost uniform except for the initial transient wave front with increasing propagation distance a distinct wave group with steep waves is gradually formed in the wave front at the same time the effect of the wave front is gradually transmitted to the back part of the wave train fig 11 shows the numerical surface elevations and corresponding wave spectra for the wave conditions k c a c 0 165 k c h 5 5 the spectra are obtained using a standard fft procedure with a hanning window the frequency resolution of the spectra is approximately 0 0122 hz at k c x 184 after approximately 29 wave length evolutions the initial uniform wave train gradually develops into a modulated wave train with distinct extreme waves obvious sidebands naturally grow with the increase in the energy of the primary wave at first the growth rate for the lower and upper sides are approximately equal however with increasing propagation distance the lower sideband gains more energy than the upper sideband eventually the lower sideband amplitude exceeds the initial primary wave amplitude resulting in a frequency downshift at k c x 283 approximately 45 wave lengths from the initial condition the maximum surface elevation increases with the growth of the lower sideband at approximately k c x 292 approximately 46 5 wave lengths from the initial condition the wave surface reaches its maximum 0 29 m which is 2 6 times the initial wave surface level approximately 0 11 m the local wave steepness kη m is 0 46 where k is defined as π divided by the local zero crossing separation spanning the given crest then the wave train demodulates and the carrier wave amplitude gradually recovers at k c x 424 approximately 67 wave lengths from the initial condition the carrier wave amplitude exceeds the lower sideband amplitude resulting in a temporary partial recurrence because this location is beyond the length of the experimental flume see fig 12 this temporary partial recurrence was not observed in the experiments of hwung et al 2007 hereafter the amplitude of the lower sideband exceeds the primary amplitude again the spatial variations in the non dimensional by the initial carrier wave amplitude amplitudes of the carrier wave and a pair of the fastest growth sidebands with three different wave steepness i e k c a c 0 165 0 220 and 0 252 are shown in fig 12 the experimental data of hwung et al 2007 are also embedded for comparison the numerical initial growth rates of the sidebands agree well with the experimental results these results demonstrate that the long term evolution of initial uniform wave trains with different steepness can be well simulated by the present model in addition according to the wave breaking area given by hwung et al 2007 the numerical model is able to capture wave breaking reasonably due to the shock capturing scheme employed based on godunov type approach in the model godunov type finite volume schemes assume that the flow variables at cell faces are discontinuous which are generally in the basis of riemann solvers to compute mass and momentum fluxes begnudelli et al 2008 even though this scheme can not resolve the complex process induced by breaking it can model changes of water surface elevations reasonable bradford 2010 ma et al 2012a b in fig 12 b the maximum wave surface reaches 0 31 m at k c x 170 which is 2 2 times the initial wave surface value approximately 0 14 m the local wave steepness kη m is 0 49 in fig 12 c at k c x 100 the maximum wave surface reaches 0 33 m which is 2 06 times the initial wave surface approximately 0 16 m the local wave steepness kη m is 0 52 as the numerical flume is longer than that of the experiments more information can be observed for example temporary recurrences the primary amplitude exceeds the lower sideband occur at k c x 420 and k c x 650 for the case with steepness of 0 165 as shown in fig 12 a notably in this case the numerical flume was extended to 700 m to investigate the evolution of the wave trains with the smallest wave steepness an approximate fpu phenomenon which was not observed in the experiment due to the length limitation of the wave flume will occur with slight increases in wave steepness the location wave recurrence appears is advanced in fig 12 b a transient wave recurrence occurs at k c x 280 reaching almost at the same location as that in the experiments however the second wave recurrence occurs at k c x 520 with a further increase of wave steepness wave recurrence does not occur and the amplitudes of the primary and sideband waves are relatively stable after k c x 300 the results indicate that the wave evolution is strongly related to the wave steepness and a permanent frequency downshift will occur after a sufficient propagation distance from the above results there is an obvious pair of sideband components that spontaneously grow with the expense of carrier wave energy in addition the frequency difference δf between the fundamental and lower and upper sidebands is almost the same which nearly satisfies the relationship f f c δf the sideband frequencies can be considered the most unstable frequency benjamin and feir 1967 to analyse the most unstable frequency a series of initial uniform wave trains table 4 with an initial steepness varying from 0 1 to 0 35 are simulated then the most unstable sidebands are obtained by analysing the simulation results as only identifying the most unstable sidebands the length of the numerical flume is set to 100 m and the depth is 1 m for each case the simulation time is 200 s table 4 shows the numerical conditions for the initial uniform wave trains the most unstable sidebands are shown in fig 13 the analytical solutions of benjamin and feir 1967 dysthe 1979 longuet higgins 1980 krasitskii 1994 and some experimental results hwung et al 2007 lake et al 1977 melville 1982 are also embedded for comparison the numerical results agree well with the experimental data further validating the ability of the present model 4 2 the evolution of the initially imposed sideband wave trains from the above evolution of the initially uniform wave trains temporary wave recurrences can be identified however perfect wave recurrence fpu can be predicted by theories yuen and ferguson 1978 for the evolution of imposed sideband wave trains tulin and waseda 1999 conducted a well controlled experiment and found near perfect wave recurrence for an initially imposed sideband wave train to further verify the present model the fpu recurrence case of tulin and waseda 1999 is simulated according to tulin and waseda 1999 the numerical flume is set to 50 m in length and 2 1 m in depth the carrier frequency is 1 23 hz and the lower and upper sideband frequencies are 1 12 hz and 1 34 hz respectively the initial carrier wave steepness is 0 1 and the initial perturbation rate is a a c 0 3535 the vertical layers are set to 40 and the equal ratio coefficient is 0 9 a 3 m sponge layer is applied at the end of the computational domain fig 14 shows the simulation results in both the time and the frequency domains the numerical results agree well with the experimental data further demonstrating the ability of the model chiang and hwung 2007 conducted a series of experiments with different wave steepnesses in a very large wave flume 300 m in length 5 0 m in depth 5 2 m in width to study the influence of steepness on the long time evolution of imposed sideband wave trains to further verify the capacity of the model the experimental cases of chiang and hwung 2007 are simulated by the present model however the numerical wave flume of the simulation is longer than that of the experiments to investigate the evolution of wave trains over a longer distance the numerical flume is 400 m long with a working depth of h 3 5 m as the initial wave steepness increases the vertical layers vary from 40 to 45 and the equal ratio coefficient is 0 92 the simulation time for each wave case is 600 s table 5 shows the detailed wave parameters fig 15 shows the comparisons of the non dimensional amplitudes nondimensionalized by the initial primary wave for the carrier wave and the sidebands the numerical results are almost identical to the experimental data with increasing wave steepness the wave evolution patterns vary from recurrence to a permanent frequency downshift due to the presence of wave breaking for the case with an initial wave steepness lower than 0 11 case a the numerical flume is extended to 600 m to investigate the evolution of the wave trains another wave recurrence which was not observed in the experiment due to the length limitation of the wave flume occurs by increasing wave steepness wave breaking occurs and stops fpu recurrence a frequency downshift phenomenon occurs after wave breaking but for waves with a moderate wave steepness ε 0 13 a temporally partial recurrence occurs a comparison of fig 15 b and c shows that for waves with the same initial wave steepness the evolution of wave trains accelerates with increasing water depth i e the partial wave recurrence is slightly advancing however subsequently the amplitude of the lower sideband exceeds that of the primary wave resulting in a permanent frequency downshift for waves with a large wave steepness fig 15 d and e permanent frequency downshift will occur after wave breaking 4 3 kinematics of large waves due to modulational instability as demonstrated in the previous section extreme waves are generated in the evolution process for example in fig 15 a at k c x 205 the maximum wave surface reaches 0 23 m which is 3 33 times the initial carrier wave surface value approximately 0 069 m the local wave steepness kη m is 0 39 in fig 15 b at k c x 300 the maximum wave surface reaches 0 29 m which is 3 49 times the initial carrier wave surface value approximately 0 083 m the local wave steepness kη m is 0 50 in fig 15 c at k c x 315 the maximum wave surface reaches 0 17 m which is 3 14 times the initial carrier wave surface value approximately 0 054 m the local wave steepness kη m is 0 44 in fig 15 d at k c x 188 the maximum wave surface reaches 0 19 m which is 3 01 times the initial carrier wave surface value approximately 0 063 m the local wave steepness kη m is 0 47 in fig 15 e at k c x 145 the maximum wave surface reaches 0 21 m which is 2 91 times the initial carrier wave surface value approximately 0 072 m the local wave steepness kη m is 0 50 describing velocities of extreme waves accurately is very important to the analysis of loads on coastal and marine structures many experimental studies have been conducted to obtain the kinematical characteristics of extreme waves using laser doppler velocimetry baldock et al 1996 kim et al 1992 longridge et al 1996 skjelbreia and torum 1989 skjelbreia and berek 1991 and particle image velocity grue et al 2003 the present model is able to obtain the wave velocities at each vertical level directly instead of estimating the velocities using theory therefore the calculated kinematics under the extreme waves in the evolution of wave trains can be obtained directly following grue s work grue et al 2003 the local wave number k and the wave slope ε for extreme waves are calculated from 31 ω 2 g k 1 ε 2 32 k η m ε 1 2 ε 2 1 2 ε 3 where ω 2π t t t t is the wave period defined trough to trough η m is the maximum crest elevation and g is the acceleration of gravity then the non dimensional velocities u ε g k are obtained because the background mechanism of generating extreme waves in both uniform wave trains and imposed sideband wave trains is actually modulational instability the velocities of the largest waves in these wave trains can be compared with the experiment data of grue et al 2003 specifically the 51 largest waves in the uniform wave trains and imposed sideband wave trains are investigated to calculate the non dimensional velocities u ε g k the parameter ε varies from 0 15 to 0 495 the non dimensional velocity profiles of the wave events are plotted together in fig 16 a strong collapse of the data is observed which agrees well with the experimental results of grue et al 2003 furthermore the maximum non dimensional velocities increase with increasing u ε g k local wave steepness in the experiment of grue et al 2003 a wave steepness lower than 0 35 was measured however in the present simulation the maximum steepness is approximately 0 5 as shown in fig 16 the horizontal velocities of these large waves are still modelled by the exponential curve in addition the investigation of the crest speeds of steep waves is an important subject longuet higgins 1975 suggested that the wave speed of maximally steep steady waves is approximately 1 1c 0 where c 0 is the linear wave speed however johannessen and swan 2001 2003 found an o 10 crest speed slowdown relative to the linear theory prediction of focusing waves banner et al 2014 and saket et al 2017 further validated the crest slowdown with extensive laboratory and field observations to investigate the crest speeds of steep waves in the evolution of wave trains using the simulation data the nondimensionalized crest speeds c c 0 of the steep waves against the local crest steepness e are shown in fig 17 where c 0 is the linear carrier wave speed and c is calculated by the spatial wave profiles within a time interval of 0 5 s the crest slowdown phenomenon occurs and all of the crest speeds of the steep waves are less than the wave speed for linear waves as the local wave slope increases the nondimensionalized crest speeds c c 0 decrease specifically when the local steepness is lower than 0 35 c c 0 varies from 0 8 to 0 95 whereas when the local steepness is greater than 0 35 c c 0 is in the range of 0 7 0 8 therefore most of the nondimensionalized crest speeds c c 0 are in the range of 0 7 0 9 which demonstrates the o 10 30 crest speed slowdown in the occurrence of extreme events 5 conclusions a new fully non hydrostatic free surface model is proposed and used to simulate unidirectional propagating wave trains in deep water the model is based on a vertical σ coordinate system the staggered grid system is employed to discretize the computational domain and the explicit method is used to discretize the incompressible euler equations the model adopts the musta riemann approximation to estimate fluxes at horizontal cell faces and the third order cweno is adopted to avoid numerical oscillations the accuracy and efficiency of the model are examined by two classic tests then the evolutions of initially uniform and perturbed wave trains are simulated by the model the results show that the most unstable perturbations and the growth rates agree well with experimental data in addition the numerical model is able to capture wave breaking reasonably according to the wave breaking area given by the experiments additionally the evolution of wave trains is strongly connected to the initial wave steepness for a small initial steepness partial recurrence occurs twice with evolution furthermore the location wave recurrence appears is advanced with a slightly increase in wave steepness however with a further increase in the initial wave steepness the energy transfer from the lower sideband to the carried wave decreases and a permanent frequency downshift occurs for the initially imposed wave trains an approximate fpu phenomenon will occur in the condition of an initial steepness lower than 0 11 if wave steepness is approximately 0 13 a partial recurrence will still appear even though the wave is breaking furthermore recurrence will not be observed for a wave steepness greater than 0 13 additionally the kinematics of the extreme waves formed during the wave evolution are studied the non dimensional horizontal velocity profiles under the extreme crests are converged and can be well modelled by the theoretically exponential curve in addition the crest speeds of the steep waves are less than the linear wave speed the maximum crest speed decreases with increasing local crest steepness acknowledgement this research is supported financially by the national natural science foundation of china grant nos 51720105010 51679031 and the fundamental research funds for the central universities of china grant no dut16td08 
22863,unmanned wave gliders uwgs are a new type of wave powered unmanned marine vehicle for persistent ocean environmental monitoring the present paper proposed the dynamic model of a uwg by considering the influences of the flexibility of the umbilical the dynamic models of surface float body float and submerged glider glider with slack umbilical were first separately established and subsequently the dynamic model of the uwg was formulated when the umbilical was under tension furthermore the judgment principle and the state transfer problem in the switching process were analyzed and numerical simulations of longitudinal and rotary motions of the uwg were performed the established dynamic model was found to be reasonable to reflect the dynamic characteristics of the uwg with flexible umbilical keywords unmanned wave glider dynamic model flexible umbilical motion simulation abbreviations uwg unmanned wave glider dof degree of freedom float surface float body glider submerged glider 1 introduction unmanned wave gliders uwgs are a new class of marine vehicle to harness wave energy for platform propulsion in comparison to the traditional marine environment observation equipment such as fixed buoy subsurface buoy shipborne survey equipment autonomous underwater vehicle and underwater glider uwgs manifest great advantages in long time and low cost marine environmental monitoring in recent years uwgs have been widely applied to multifarious marine scientific research and survey activities anderson et al 2018 bittencourt et al 2018 benson et al 2017 ibrahim et al 2018 liao et al 2017 2016a 2016b manley and hine 2016 shi et al 2018 thomson et al 2018 zhang et al 2016 a uwg generally consists of a surface float body float a submerged glider glider and a flexible umbilical and several wings are hinged on the glider as the depth of water increases the amplitudes of surface waves start to decrease when the float is pulled by surface waves the glider moves relative to water during the heave process hydrofoils are continuously forced to rotate in order to make the forward lift independent of wave directions a rudder is also attached to the glider to maneuver the uwg the operating principle of a uwg is depicted in fig 1 which is one of the publicly available images by liquid robotics inc some researchers elaborately analyzed the hydrodynamic performances of uwgs by considering different factors such as hydrofoil profile and attack angle hu et al 2018 liu et al 2018 salari and anvar 2015 xu 2018 yang et al 2018 zhang 2017 some researchers have made great contributions to the dynamic analysis of uwg 1 kraus and bingham 2011 presented the two dimensional model of uwgs in both the along track and the heave directions qi et al 2013 and zhou et al 2017 established the multi rigid dynamic model of uwgs in the vertical plane by the kane equation finnemore and franzini 2013 tian et al 2015b 2014 formulated the dynamic model of uwgs in the longitudinal direction based on the newton euler equation these investigations mainly concentrate on longitudinal velocities of uwgs and are beneficial for their motion analysis in the vertical plane 2 kraus 2012 constructed a maneuverability model of a uwg with 6 dof by improving the mathematical model of space motion of a ship tian and yu 2015 described the relative motion of each part of a uwg by the denavit hartenberg dh method and established the dynamic model by lagrange equation li et al 2017 completed the motion simulation of a uwg by conjoint analysis using the multi dynamic software adams and matlab wang et al 2018c established the 4 dof model of a uwg based on the newton euler approach and the second order wave drift force on the horizontal plane and the first order wave force in the vertical direction were considered during calculation chen et al 2018 proposed a non linear kinetic model of a uwg with 6 dof and analyzed the relationship between vertical liquid velocity and longitudinal speed of the uwg these research works mainly discuss the yawing motion of uwgs and are beneficial for their control algorithm design 3 wang et al 2018b discussed the yawing response equation of a uwg and identified the parameters of its planar motion model wang et al 2018a proposed the dynamic model of the multi heading system of a uwg and corrected it in real time by dynamic input and output i o data generated from the control system these research works mainly provide the ideas of dynamic modeling of uwgs by identification algorithms 4 zhang and xu 2018 studied the motion relationship between float and glider by dividing the umbilical into several micro segments and solving the dynamic equilibrium equation of each segment the aforesaid research works assumed that the umbilical was always under tension and it is reasonable to a certain extent as a glider is heavy and produces thrust however in the actual sailing under high wave conditions the umbilical loses tension after a certain period of time and is alternately pulled and loosened in a uwg the glider produces both control forces and thrust whereas the float withstands environmental disturbances the transmission of forces and motion between float and glider depends on the umbilical when the umbilical is slack the strength of association between float and glider becomes much weaker therefore the dynamic characteristics and the control performances of uwgs mainly depend on the flexibility of the umbilical in the current paper the dynamic models of float and glider with flexible umbilical were first separately established and subsequently the dynamic model of a uwg was formulated when the umbilical was under tension the judgment principle and the state transfer problem in the switching process were analyzed and numerical simulations were carried out to verify the rationality of the established dynamic model of the uwg with flexible umbilical 2 dynamic models of float and glider with slack umbilical the body fixed float and glider frames and the earth fixed frame are presented in fig 2 kraus 2012 1 float frame with the right superscript f the origin of the coordinate frame is located on the hinged joint between float and umbilical x f points to the bow of the float y f points to the starboard of the float and z f lies vertically downward 2 glider frame with the right superscript g the origin of the coordinate frame is located on the hinged joint between glider and umbilical x g points to the bow of the glider y g points to the starboard of the glider and z g lies vertically downward 3 earth fixed frame ξ η ζ it is the north east down frame where ξ represents the positive north η is the positive east and ζ lies vertically downward the hinged joint between umbilical and float is located in the longitudinal section of the center plane of the float and the connecting point between umbilical and glider is located on the center of gravity of the glider therefore 1 x g g y g g z g g y g f z g f 0 remarks the origins of the float frame and the glider frame are located on the hinged joints between float and umbilical and between glider and umbilical respectively in section 4 1 1 the distance between the origins of the float frame and the glider frame is related to the judgment principle in the switching process the hinged joint between float and umbilical is located in front of the center of gravity of the float therefore x g f 0 in the following sections s c and t respectively represent the sine the cosine and the tangent of an angle 2 1 dynamic model of the float when the umbilical was slack no active control input force acted on the float considering the change in the draft of the float was much less than the amplitude of wave motion under high wave conditions the heave motion of the float was assumed as the heave motion of surface waves and was decoupled from the surge the sway and the yawing motions of the float the 3 dof surge sway and yaw coupled model of the float was formulated as follows fossen 2011 2 m f ν r f c f ν r f ν r f d f ν r f τ w i n d f τ w a v e f where ν r f u r f v r f r f t u f u f c v f v f c r f t is the velocity vector of the float relative to current u r f and v r f are respectively the surge and the sway velocities of the float relative to current u f and v f are respectively the surge and the sway velocities of the float in the float frame u f c and v f c are respectively the longitudinal and the transverse velocities of ocean current in the float frame and r f is the yawing velocity of the float m f m r b f m a f is the inertia matrix of the float including the added mass c f v r f c r b f v r f c a f is the coriolis centripetal matrix of the float including the added mass d f v r f is the damping vector of the float τ w i n d f is the vector of wind forces on the float and τ w a v e f is the vector of wave forces on the float now based on eq 1 m f and c f v r f were further simplified to eqs 3 and 4 respectively 3 m f m f x u f 0 0 0 m f y v f m f x g f 0 m f x g f i z f n r f 4 c f v r f 0 0 m f x g f r f v r f a 2 f 0 0 m f u r f a 1 f m f x g f r f v r f a 2 f m f u r f a 1 f 0 where m f is the mass of the float i z f is the moment of inertia of the float about the z axis of the float frame x u f y v f and n r f are the inertia hydrodynamic coefficients of the float and a 1 f a 2 f are the hydrodynamic coriolis centripetal coefficients of the float d f v r f was formulated as follows 5 d f v r f c u f u r f 2 sign u r f c v f v r f 2 sign v r f c r f r f 2 sign r f t where c u f c v f and c r f are respectively the hydrodynamic coefficients of surge sway and yawing motions of the float and sign represents the sign function the location of the float in the earth fixed frame was derived by eq 6 6 ξ f u f c ψ f v f s ψ f η f u f s ψ f v f c ψ f ψ f r f where ξ f and η f are respectively the longitudinal and the transverse coordinates of the float in the earth fixed frame and ψ f is the heading of the float 2 2 dynamic model of a glider the 4 dof surge sway heave and yaw coupled model of a glider was formulated as follows fossen 2011 7 m g ν r g c g ν r g ν r g d g ν r g τ g p g where v r g u r g v r g w g r g t u g u g c v g v g c w g r g t is the velocity vector of the glider relative to current u r g and v r g are respectively the surge and the sway velocities of the glider relative to current u g v g and w g are respectively the surge the sway and the heave velocities of the glider in the glider frame u g c and v g c are respectively the longitudinal and the transverse velocities of ocean current in the glider frame and r g is the yawing velocity of the glider m g m r b g m a g is the inertia matrix of the glider including the added mass c g v r g c r b g v r g c a g is the coriolis centripetal matrix of the glider including the added mass d g ν r g is the damping vector of the glider τ g is the vector of active control inputs on the glider including thrust and rudder forces and p g is the vector of static force on the glider now based on eq 1 m g and c g v r g were further simplified to eqs 8 and 9 respectively 8 m g m g x u g 0 0 0 0 m g y v g 0 0 0 0 m g z w g 0 0 0 0 i z g n r g 9 c g v r g 0 0 0 m g v r g a 2 g 0 0 0 m g u r g a 1 g 0 0 0 0 m g v r g a 2 g m g u r g a 1 g 0 0 where m g is the mass of the glider i z g is the moment of inertia of the glider about the z axis of the glider frame x u g y v g z w g and n r g are the inertia hydrodynamic coefficients of the glider and a 1 g a 2 g are the hydrodynamic coriolis centripetal coefficients of the glider d g ν r g was formulated as follows 10 d g ν r g c u g u r g 2 sign u r g c v g v r g 2 sign v r g c w g w r g 2 sign w r g c r g r g 2 sign r g t where c u g c v g c w g and c r g are respectively the hydrodynamic coefficients of surge sway heave and yawing motions of the glider remarks in section 5 the data of thrust zhang 2017 were considered as the resultant force of pure thrust and pure damping of the glider thus the first element of d g ν r g was set to 0 τ g was expressed as follows 11 τ g x τ g y τ g z τ g n τ g t 1 2 ρ s v r δ 2 c d δ 1 2 ρ s v r δ 2 c l δ 0 y τ g l δ where t is the thrust generated by hydrofoils ρ is the medium density 1 025 103 kg m3 in seawater s is the area of rudder v r δ is the inflow velocity of rudder c l δ and c d δ are respectively the coefficients of lift and drag forces on rudder and are related to rudder angle δ and l δ is the distance between rudder and the center of the glider p g was formulated as follows 12 p g 0 0 w 0 t where w is the underwater gravity of the glider the location of the glider in the earth fixed frame was derived by eq 13 13 ξ g u g c ψ g v g s ψ g η g u g s ψ g v g c ψ g ζ g w g ψ g r g where ξ g η g and ζ g are respectively the longitudinal the transverse and the vertical coordinates of the glider in the earth fixed frame and ψ g is the heading of the glider 3 dynamic model of the uwg when the umbilical is under tension 3 1 coordinate frames and dofs four coordinate frames system frame float frame glider frame and earth fixed frame are displayed in fig 3 kraus 2012 1 system frame with the right superscript 0 it is attached to the center of gravity of the system on the umbilical the axis defined as x 0 is locally normal to the umbilical and is positive in the direction of forward velocity the axis defined as z 0 lies along with umbilical and points to the glider and y 0 satisfies the right hand rule 2 the coordinates of the float frame with the right superscript f the glider frame with the right superscript g and the earth fixed frame ξ η ζ are similar to those described in section 2 remarks the origins of the float frame and the glider frame are located on the hinged joints between float and umbilical and between glider and umbilical respectively the relative position between float and glider is described by rolling and pitching angles of the umbilical the hinged joint between float and umbilical is located in front of the center of gravity of the float thus x g f 0 the surge and the sway of the center of gravity of the uwg the roll and the pitch of the umbilical and the yawing motions of float and glider were mainly considered the relative positions between float and glider were described by ϕ rolling angle of the umbilical and θ pitching angle of the umbilical furthermore the yawing angle of the system frame was set as ψ 0 ψ g and the heading error between float and glider was considered as δ ψ ψ g ψ f the acceleration vector the velocity vector and the position vector of the uwg were expressed as follows 14 a u v p q r f r g t v u v p q r f r g t η ξ η ϕ θ ψ f ψ g t where u and v are respectively the surge and the sway velocities of the uwg in the system frame and p and q are respectively the rolling and the pitching velocities of the umbilical now the velocity vector of the uwg relative to ocean current was formulated by eq 15 15 ν r u r v r p q r f r g t where u r and v r are respectively the surge and the sway velocities of the uwg relative to ocean current in the system frame 16 u r u u c v r v v c where u c and v c are respectively the longitudinal and the transverse velocities of ocean current in the system frame the transformation matrix from the system frame to the float frame was derived by eq 17 kraus 2012 17 r o f c θ c δ ψ s θ c δ ψ s ϕ s δ ψ c ϕ s θ c δ ψ c ϕ s δ ψ s ϕ c θ s δ ψ s θ s δ ψ s ϕ c δ ψ c ϕ s θ s δ ψ c ϕ c δ ψ s ϕ s θ c θ s ϕ c θ c ϕ α β ϖ γ χ s θ κ μ the transformation matrix from the system frame to the glider frame was expressed by eq 18 kraus 2012 18 r o g c θ s θ s ϕ s θ c ϕ 0 c ϕ s ϕ s θ c θ s ϕ c θ c ϕ c θ γ λ 0 c ϕ s ϕ s θ κ μ the transformation matrix from the system frame to the earth fixed frame was derived by eq 19 kraus 2012 19 r o n e d c θ c ψ g c ψ g s θ s ϕ s ψ g c ϕ c ψ g s θ c ϕ s ψ g s ϕ c θ s ψ g s ψ g s θ s ϕ c ψ g c ϕ s ψ g s θ c ϕ c ψ g s ϕ s θ c θ s ϕ c θ c ϕ now 20 r f o r o f t r g o r o g t r n e d o r o n e d t 3 2 kinematics of the uwg when the umbilical is under tension motion parameters of float and glider in the system frame were derived based on rigid body motion equations 21 η f o η r f η g o η r g v f o v ω r f v g o v ω r g a f o a α r f ω ω r f a g o a α r g ω ω r g v f r o f v f o v f r o g v g o a f r o f a f o a g r o g a g o where 22 r f 0 0 d f t r g 0 0 d g t ω p q 0 t α p q 0 t where η η f o η g o v v f o v g o v f v g and a a f o a g o a f a g are respectively the position the velocity and the acceleration vectors right superscripts refer to a particular component and left superscripts refer to the reference coordinate frame the vector is expressed in the omission of left superscripts indicates that the variable is expressed in the body fixed frame of itself by default ω and α are respectively the angular velocity and the angular acceleration vectors of the system frame d f is the distance from the hinged joint between float and umbilical to the origin of the system frame and d g is the distance from the hinged joint between glider and umbilical to the origin of the system frame the heave and the yawing velocities of the system frame were calculated as follows lu 2015 23 w w f s θ u q d f κ v p d f μ 24 r c θ r g s ϕ q c ϕ the relationship between the velocity vector and the position vector can be expressed by eq 25 fossen 2011 25 ξ η ζ t r o n e d u v w t ϕ p t θ s ϕ q t θ c ϕ r θ c ϕ q s ϕ r ψ f r f ψ g r g 3 3 dynamic model of the uwg when the umbilical is under tension the dynamic model of the uwg when the umbilical was under tension can be presented by eq 26 26 m r b v c r b ν ν f m a ν r f c a ν r d ν r g η τ where m r b r 6 6 is the rigid mass matrix c r b ν r 6 6 is the coriolis centripetal coefficient matrix f m a ν r r 6 1 is the inertial hydrodynamic force vector f c a ν r r 6 1 is the hydrodynamic coriolis centripetal force vector d ν r r 6 1 is the damping force vector g η r 6 1 is the restoring force vector and τ r 6 1 is the active control force vector d ν r contains viscous hydrodynamic force and τ possesses thrust and rudder forces furthermore ν is the velocity vector of the uwg relative to earth and ν r is the velocity vector of the uwg relative to current the longitudinal the transverse and the vertical forces and the yawing moments of float and glider are represented as x f and x g y f and y g z f and z g n f and n g respectively the force vector of the uwg x r 6 1 was obtained as 27 x 1 2 f 1 2 28 x 3 4 m 1 2 29 x 5 6 n f n g t where 30 f r f o x f y f z f t r g o x g y g z g t 31 m r f r f o x f y f z f t r g r g o x g y g z g t x i j represents the vector consisted of the ith element to the jth element of the vector x when considering the holistic motion of the uwg the shapes of float and glider were ignored thus the moments of inertia about the x axis and the y axis and the inertial product of the uwg about the system frame were expressed as follows 32 i x i y m f d f 2 m g d g 2 33 i x y 0 the origin of the system frame was set at the center of gravity of the uwg therefore 34 x g y g z g 0 m r b and c r b ν were formulated as follows 35 m r b m 0 0 0 m f x g f γ 0 0 m 0 0 m f x g f χ 0 0 0 i x 0 m f d f x g f χ 0 0 0 0 i y m f d f x g f γ 0 m f x g f γ m f x g f χ m f x g f χ d f m f x g f γ d f i z f 0 0 0 0 0 0 i z g 36 c r b 0 0 0 m w m f x g f r f v f α m f u f γ m g v g c θ 0 0 m w 0 m f x g f r f v f β m f u f χ m g v g γ m g u g c ϕ 0 m w 0 0 d f m f x g f r f v f β u f χ d g m g v g γ u g c ϕ m w 0 0 0 d f m f x g f r f v f α u f γ d g m g v g c θ 0 0 0 0 m f x g f u f 0 0 0 0 0 0 0 where m is the mass of uwg m m f m g furthermore an additional force was considered during the derivation process of the rigid mass matrix 37 m f w m f x g f p p q q d f m f x g f r p d f m f x g f γ r q d f m f x g f χ now for g η the underwater gravity w of the glider and the extra buoyancy of the float the balance force for the underwater gravity of the glider produce rolling and pitching moments of the uwg 38 m g r f r f o 0 0 w t r g r g o 0 0 w t d f d g κ w s θ w 0 t therefore 39 g η 0 0 d f d g κ w d f d g s θ w 0 0 t 4 judgment principle and state transfer in the switching process 4 1 from slack umbilical to the umbilical under tension 4 1 1 judgment principle when the umbilical has some slack the glider falls under its own gravity thus the initial distance between float and glider becomes less than the length of the umbilical when the float is pulled upward by surface waves or falls with a lower velocity than that of the glider the distance between float and glider increases the maximum distance between float and glider is restricted by the length of the umbilical furthermore with the increasing distance between float and glider the distance between float and glider becomes equal to the length of the umbilical at a certain time therefore the umbilical changes from its loose state to the state under tension in two cases 1 the distance between float and glider d f g is larger than the length of the umbilical d u m b i l i c a l 40 d f g ξ f ξ g 2 η f η g 2 ζ f ζ g 2 d u m b i l i c a l 2 the distance between float and glider is equal to the length of the umbilical and float and glider move away from each other 41 d f g d u m b i l i c a l and v r f g 0 where v r f g is the projective velocity of the glider relative to the float on the connecting line from the float to the glider 42 v r f g r f g v r f g where r f g is the normalized radius vector from float to glider in the earth fixed frame 43 r f g ξ g ξ f η g η f ζ g ζ f t d f g v r f g is the velocity vector of the glider relative to the float in the earth fixed frame 44 v r f g ξ g ξ f η g η f ζ g ζ f t 4 1 2 state transfer the initial velocity of the uwg in the system frame the initial position of the uwg in the earth fixed frame the initial rolling and pitching angles of the umbilical and the angular velocities of the system frame were expressed by the following equations the origin of the system frame was set at the center of gravity of the uwg therefore 45 η o n e d m f η f n e d m g η g n e d m f m g 46 η o n e d m f η f n e d m g η g n e d m f m g where η o n e d ξ η ζ t η f n e d ξ f η f ζ f t and η g n e d ξ g η g ζ g t the velocity vector of the uwg in the system frame was derived by eq 47 47 v r n e d o η o n e d now from eq 21 48 v g o v ω r g q d g i p d g j 0 k therefore 49 p v g o v j d g 50 q v g o v i d g where 51 v g o r g o v furthermore 52 r g n e d r o n e d r g where r g n e d is the radius vector from the origin of the system frame to the origin of the glider frame in the earth fixed frame 53 r g n e d η g n e d η o n e d eq 52 is a vector equation and can be expanded to an equation group consisted of three scalar equations the first and second equations of the equation group are two equations including ϕ and θ 54 d g c ψ g s θ c ϕ s ψ g s ϕ r g n e d i 55 d g s ψ g s θ c ϕ c ψ g s ϕ r g n e d j moreover 56 s 2 θ c 2 θ 1 57 s 2 ϕ c 2 ϕ 1 the equation set consisting of eqs 54 57 has four unknown quantities s θ c θ s ϕ and c ϕ which can be solved by numerical methods the values of initial rolling ϕ and pitching θ angles were obtained by the anti trigonometric function multiple solutions were achieved for the equation set however the right solution was considered for the case of c θ 0 c ϕ 0 90 ϕ 90 and 90 θ 90 4 2 from the umbilical under tension to slack umbilical 4 2 1 judgment principle when the umbilical is under tension the distance between float and glider remains unchanged when the float falls rapidly the umbilical may provide a compressive force and becomes slack the umbilical is considered as squeezed when the vertical force on the glider from the umbilical is positive the force on the glider from the umbilical can be obtained by removing other forces such as static force active control input force and hydrodynamic force from the resultant force of the glider the resultant force vector of the glider was expressed by eq 58 58 f g m g a g where a g is the acceleration vector of the glider in the glider frame 59 a g r o g a g o the vector of tension from umbilical to glider was derived by eq 60 60 t g f g p g τ g d g where p g τ g and d g are respectively the vectors of static force active control input force and hydrodynamic force on the glider the vector t g consists of three elements the third element of t g or t g 3 which is the vertical force of the umbilical on the glider was only used for the judgment when t g 3 0 the umbilical becomes slack 4 2 2 state transfer the initial positions of float and glider in the earth fixed frame and the initial velocities of float and glider in their body fixed frames were obtained from the following equations 61 η f n e d η o n e d r o n e d r f 62 η g n e d η o n e d r o n e d r g 63 v f r o f v f o 64 v g r o g v g o 5 numerical simulation experiments and analysis the main parameters of the uwg are presented in table 1 lu 2015 the added masses of the uwg in the horizontal and the vertical directions were respectively set to 0 1 and 2 1 times of the inherent mass tian et al 2015a 2015b korotkin 2010 zhang 2017 calculated thrusts produced by hydrofoils under regular sine waves of different amplitudes and periods through cfd simulations and the output result was the resultant force of pure thrust and pure damping of the glider table 2 5 1 distance between float and glider under different wave conditions numerical simulation results of longitudinal and rotary motions of the uwg under different typical regular sine wave conditions are presented in table 3 rasmussen and williams 2006 the initial velocities of float and glider the initial pitching and rolling angles of the umbilical and the initial headings of float and glider were all set to 0 the length of the umbilical was 4 m during rotary motion simulation rudder angle was set to 20 the obtained simulation results are expressed in figs 4 11 and in tables 4 and 5 figs 4 11 present distances between float and glider during longitudinal and rotary motions under different wave conditions under wave condition 1 the umbilical was always under tension during both longitudinal and rotary motions thus the distance between float and glider was always equal to the length of the umbilical it is evident from tables 4 and 5 that the maximum heave velocity of waves under wave condition 1 was less than those under other wave conditions hence the umbilical did not experience the loose state under wave conditions 2 4 the distance between float and glider was smaller than the length of the umbilical for a certain period of time the umbilical became slack and was alternately pulled and loosened it is noticeable from tables 4 and 5 that as the maximum heave velocity of waves started to increase the distance between float and glider became smaller thereby resulting in larger proportions of time when there is slack in the umbilical this happened because the heave motion of the float was more intense under higher wave conditions when the float fell faster than the glider the umbilical was easily loosened under wave condition 4 the proportions of time when there is slack in the umbilical during longitudinal and rotary motions were respectively 27 54 and 32 34 it signifies that almost no transmission of forces and motion between float and glider occurred for about 30 time period 5 2 motion responses of the uwg in the present section the dynamic characteristics of the uwg during longitudinal and rotary motions under wave condition 2 wave height 0 5 m and wave length 16 m are examined 5 2 1 longitudinal motion simulation simulation results of the uwg during longitudinal motion are depicted in figs 12 14 in fig 12 blue round points red square points and black lines respectively represent float glider and umbilical the motion of the float was found to be comparatively more regular whereas the glider was pulled more intensely the longitudinal velocities of float and glider and the pitching angle of the umbilical are presented in figs 13 and 14 respectively the average velocities of float and glider were measured as about 0 78 m s under the specific sea condition 5 2 2 rotary motion simulation simulation results of the uwg during rotary motion with 20 rudder angle are displayed in figs 15 17 in figs 15 and 16 the curves of blue round points and red square points respectively represent the irregularly round trajectories of float and glider whereas black lines denote the umbilical moreover the heading of the float lagged behind that of the glider fig 17 it happened because the yawing moment of the float was generated from the tension of the umbilical therefore a non zero heading error between glider and float is the precondition for the yawing moment of the float 6 conclusions 1 the dynamic model of a uwg with flexible umbilical was established in the afore discussed research and the proposed model was found to be reasonable and operable in practice 2 simulation results revealed that the umbilical was not always under tension when the wave surface fell rapidly under high wave conditions the umbilical easily became slack 3 the uwg due to its unique rigid flexible multibody joint structure manifested unique dynamic characteristics the velocities of float and glider oscillated with undulating waves and the heading of the float lagged behind that of the glider in our future research a nonlinear model of the flexible umbilical will be developed in order to study the influences of geometrically nonlinear effects tension and stiffening on uwgs the umbilical will be divided into multiple nonlinear elements with mass and axial stiffness and each element would be capable of large rotations funding this work was supported by the national key r d program of china grant number 2017yfc0305700 the national natural science foundation of china grant number 51779052 51879057 u1806228 the natural science foundation of heilongjiang province of china grant number qc2016062 the heilongjiang postdoctoral funds for scientific research initiation grant number lbh q17046 the fundamental research funds for the central universities grant numbers heucfp201741 heucfg201810 the qingdao national laboratory for marine science and technology grant number qnlm2016orp0406 the research fund from science and technology on underwater vehicle laboratory grant number 6142215180102 614221503091701 appendix appendix 1 nomenclature of all state variables name description m f m g m the masses of the float the glider and the whole uwg i z f i z g the moments of inertia about the z axis of the corresponding body fixed frame of the part specified by the right superscript i x i y i x y the moments of inertial of uwg about the x axis and y axis of system frame and the inertial product of uwg d f d g the distances from the hinged joint between the part specified by the right superscript and umbilical to the origin of system frame d f g d u m b i l i c a l the distance between the float and the glider the length of umbilical x g f y g f z g f x g g y g g z g g the x y z coordinates of the center of gravity of the part specified by the right superscript in the corresponding body fixed frame x g y g z g the x y z coordinates of the center of gravity of uwg in system frame ξ f η f ζ f ξ g η g ζ g the longitudinal transverse and vertical coordinates of the part specified by the right superscript in the earth fixed frame ξ η ζ the longitudinal transverse and vertical coordinates of the origin of system frame in the earth fixed frame ψ f ψ g ψ 0 δ ψ the heading of the float the heading of the glider the heading of the system frame the heading error between the float and the glider ϕ θ the rolling angle and the pitching angle of umbilical u f v f w f r f the surge sway heave yawing velocity of the float in the float frame u g v g w g r g the surge sway heave yawing velocity of the glider in the glider frame u v w p q r the surge sway heave rolling pitching yawing velocities of uwg in the system frame u f c v f c u g c v g c the longitudinal and transverse velocities of ocean current in the body fixed frame specified by the right subscript u c v c the longitudinal and transverse velocity of ocean current in the system frame u r v r the surge and sway velocities of the system frame in system frame u r f v r f u r g v r g the surge and sway velocities of the part specified by the right superscript relative to current v r f g the projective velocity of the glider relative to the float on the connecting line from the float to the glider i j k the x axis y axis z axis unit vector of the system frame ω α the angular velocity vector and angular acceleration vector of the system frame v r f v r g the vector of velocity relative to current for the part specified by the right superscript in the dynamic equation of the part with slack umbilical ν r the vector of velocity relative to current for the uwg in the dynamic model of uwg when the umbilical is under tension v r f g the velocity vector of the glider relative to the float in the earth fixed frame a v η the acceleration vector velocity vector position vector of uwg in the dynamic model of uwg when the umbilical is under tension a v η the acceleration vector velocity vector position vector of surge sway and heave motion of uwg in the system frame η f o η g o η o n e d η f n e d η g n e d v f o v g o v f v g a f o a g o a f a g the vectors of position velocity and acceleration of surge sway and heave motion while the right superscript refers to a particular component and the left superscript refers to the reference coordinate frame the vector is expressed in omission of the left superscript indicates the variable is expressed in the body fixed frame of itself by default r f r g the position vector of the part specified by the right superscript in the system frame r f g the normalized radius vector from the float to the glider in the earth fixed frame r g n e d the radius vector from the origin of the system frame to the origin of the glider frame in the earth fixed frame r o f r o g r o n e d r f o r g o r n e d o the transformation matrix from the frame specified by the left subscript to the frame specified by the left superscript α β ϖ γ χ κ μ γ λ substitutions related to ϕ θ δ ψ to simplify the expression of other equations m f m r b f m a f m g m r b g m a g the inertia matrix rigid body mass matrix added mass matrix of the part specified by the right superscript c f c r b f c a f c g c r b g c a g the coriolis centripetal matrix rigid body coriolis centripetal matrix hydrodynamic coriolis centripetal force matrix of the part specified by the right superscript d f d g the damping vector of the part specified by the right superscript m r b rigid body mass matrix of uwg c r b the matrix of coriolis centripetal coefficient of uwg f c a f m a d g τ the vector of hydrodynamic coriolis centripetal force the vector of inertial hydrodynamic force the vector of damping force the vector of restoring force the vector of active control force in the dynamic model of uwg when the umbilical is under tension m f the additional force in the derivation process of rigid mass matrix m r b τ w i n d f τ w a v e f the vector of wind forces and the vector of wave forces on the float τ g the vector of active control inputs on the glider including thrust and rudder forces p g the vector of the static force on the glider f g the vector of resultant force of the glider of surge sway and heave motion t g the vector of tension of umbilical acted on the glider of surge sway and heave motion d g the vector of damping force of the glider of surge sway and heave motion τ g the vector of active control inputs on the glider of surge sway and heave motion p g the vector of the static force on the glider of surge sway and heave motion m g the vector of the rolling and pitching moments of uwg related to the underwater gravity of the glider x u f y v f n r f the inertial hydrodynamic coefficient in surge sway and yawing motion of the float c u f c v f c r f c u g c v g c w g c r g the hydrodynamic coefficient of the part specified by the right superscript related to the motion specified by the right subscript a 1 f a 2 f a 1 g a 2 g the elements of hydrodynamic coriolis centripetal matrix of the part specified by the right superscript t the thrust generated by hydrofoils ρ the medium density s the area of rudder v r δ the inflow velocity of rudder δ rudder angle c l δ c d δ coefficients of lift and drag of rudder l δ the distance from the rudder to the center of the glider w the underwater gravity of the glider 
22863,unmanned wave gliders uwgs are a new type of wave powered unmanned marine vehicle for persistent ocean environmental monitoring the present paper proposed the dynamic model of a uwg by considering the influences of the flexibility of the umbilical the dynamic models of surface float body float and submerged glider glider with slack umbilical were first separately established and subsequently the dynamic model of the uwg was formulated when the umbilical was under tension furthermore the judgment principle and the state transfer problem in the switching process were analyzed and numerical simulations of longitudinal and rotary motions of the uwg were performed the established dynamic model was found to be reasonable to reflect the dynamic characteristics of the uwg with flexible umbilical keywords unmanned wave glider dynamic model flexible umbilical motion simulation abbreviations uwg unmanned wave glider dof degree of freedom float surface float body glider submerged glider 1 introduction unmanned wave gliders uwgs are a new class of marine vehicle to harness wave energy for platform propulsion in comparison to the traditional marine environment observation equipment such as fixed buoy subsurface buoy shipborne survey equipment autonomous underwater vehicle and underwater glider uwgs manifest great advantages in long time and low cost marine environmental monitoring in recent years uwgs have been widely applied to multifarious marine scientific research and survey activities anderson et al 2018 bittencourt et al 2018 benson et al 2017 ibrahim et al 2018 liao et al 2017 2016a 2016b manley and hine 2016 shi et al 2018 thomson et al 2018 zhang et al 2016 a uwg generally consists of a surface float body float a submerged glider glider and a flexible umbilical and several wings are hinged on the glider as the depth of water increases the amplitudes of surface waves start to decrease when the float is pulled by surface waves the glider moves relative to water during the heave process hydrofoils are continuously forced to rotate in order to make the forward lift independent of wave directions a rudder is also attached to the glider to maneuver the uwg the operating principle of a uwg is depicted in fig 1 which is one of the publicly available images by liquid robotics inc some researchers elaborately analyzed the hydrodynamic performances of uwgs by considering different factors such as hydrofoil profile and attack angle hu et al 2018 liu et al 2018 salari and anvar 2015 xu 2018 yang et al 2018 zhang 2017 some researchers have made great contributions to the dynamic analysis of uwg 1 kraus and bingham 2011 presented the two dimensional model of uwgs in both the along track and the heave directions qi et al 2013 and zhou et al 2017 established the multi rigid dynamic model of uwgs in the vertical plane by the kane equation finnemore and franzini 2013 tian et al 2015b 2014 formulated the dynamic model of uwgs in the longitudinal direction based on the newton euler equation these investigations mainly concentrate on longitudinal velocities of uwgs and are beneficial for their motion analysis in the vertical plane 2 kraus 2012 constructed a maneuverability model of a uwg with 6 dof by improving the mathematical model of space motion of a ship tian and yu 2015 described the relative motion of each part of a uwg by the denavit hartenberg dh method and established the dynamic model by lagrange equation li et al 2017 completed the motion simulation of a uwg by conjoint analysis using the multi dynamic software adams and matlab wang et al 2018c established the 4 dof model of a uwg based on the newton euler approach and the second order wave drift force on the horizontal plane and the first order wave force in the vertical direction were considered during calculation chen et al 2018 proposed a non linear kinetic model of a uwg with 6 dof and analyzed the relationship between vertical liquid velocity and longitudinal speed of the uwg these research works mainly discuss the yawing motion of uwgs and are beneficial for their control algorithm design 3 wang et al 2018b discussed the yawing response equation of a uwg and identified the parameters of its planar motion model wang et al 2018a proposed the dynamic model of the multi heading system of a uwg and corrected it in real time by dynamic input and output i o data generated from the control system these research works mainly provide the ideas of dynamic modeling of uwgs by identification algorithms 4 zhang and xu 2018 studied the motion relationship between float and glider by dividing the umbilical into several micro segments and solving the dynamic equilibrium equation of each segment the aforesaid research works assumed that the umbilical was always under tension and it is reasonable to a certain extent as a glider is heavy and produces thrust however in the actual sailing under high wave conditions the umbilical loses tension after a certain period of time and is alternately pulled and loosened in a uwg the glider produces both control forces and thrust whereas the float withstands environmental disturbances the transmission of forces and motion between float and glider depends on the umbilical when the umbilical is slack the strength of association between float and glider becomes much weaker therefore the dynamic characteristics and the control performances of uwgs mainly depend on the flexibility of the umbilical in the current paper the dynamic models of float and glider with flexible umbilical were first separately established and subsequently the dynamic model of a uwg was formulated when the umbilical was under tension the judgment principle and the state transfer problem in the switching process were analyzed and numerical simulations were carried out to verify the rationality of the established dynamic model of the uwg with flexible umbilical 2 dynamic models of float and glider with slack umbilical the body fixed float and glider frames and the earth fixed frame are presented in fig 2 kraus 2012 1 float frame with the right superscript f the origin of the coordinate frame is located on the hinged joint between float and umbilical x f points to the bow of the float y f points to the starboard of the float and z f lies vertically downward 2 glider frame with the right superscript g the origin of the coordinate frame is located on the hinged joint between glider and umbilical x g points to the bow of the glider y g points to the starboard of the glider and z g lies vertically downward 3 earth fixed frame ξ η ζ it is the north east down frame where ξ represents the positive north η is the positive east and ζ lies vertically downward the hinged joint between umbilical and float is located in the longitudinal section of the center plane of the float and the connecting point between umbilical and glider is located on the center of gravity of the glider therefore 1 x g g y g g z g g y g f z g f 0 remarks the origins of the float frame and the glider frame are located on the hinged joints between float and umbilical and between glider and umbilical respectively in section 4 1 1 the distance between the origins of the float frame and the glider frame is related to the judgment principle in the switching process the hinged joint between float and umbilical is located in front of the center of gravity of the float therefore x g f 0 in the following sections s c and t respectively represent the sine the cosine and the tangent of an angle 2 1 dynamic model of the float when the umbilical was slack no active control input force acted on the float considering the change in the draft of the float was much less than the amplitude of wave motion under high wave conditions the heave motion of the float was assumed as the heave motion of surface waves and was decoupled from the surge the sway and the yawing motions of the float the 3 dof surge sway and yaw coupled model of the float was formulated as follows fossen 2011 2 m f ν r f c f ν r f ν r f d f ν r f τ w i n d f τ w a v e f where ν r f u r f v r f r f t u f u f c v f v f c r f t is the velocity vector of the float relative to current u r f and v r f are respectively the surge and the sway velocities of the float relative to current u f and v f are respectively the surge and the sway velocities of the float in the float frame u f c and v f c are respectively the longitudinal and the transverse velocities of ocean current in the float frame and r f is the yawing velocity of the float m f m r b f m a f is the inertia matrix of the float including the added mass c f v r f c r b f v r f c a f is the coriolis centripetal matrix of the float including the added mass d f v r f is the damping vector of the float τ w i n d f is the vector of wind forces on the float and τ w a v e f is the vector of wave forces on the float now based on eq 1 m f and c f v r f were further simplified to eqs 3 and 4 respectively 3 m f m f x u f 0 0 0 m f y v f m f x g f 0 m f x g f i z f n r f 4 c f v r f 0 0 m f x g f r f v r f a 2 f 0 0 m f u r f a 1 f m f x g f r f v r f a 2 f m f u r f a 1 f 0 where m f is the mass of the float i z f is the moment of inertia of the float about the z axis of the float frame x u f y v f and n r f are the inertia hydrodynamic coefficients of the float and a 1 f a 2 f are the hydrodynamic coriolis centripetal coefficients of the float d f v r f was formulated as follows 5 d f v r f c u f u r f 2 sign u r f c v f v r f 2 sign v r f c r f r f 2 sign r f t where c u f c v f and c r f are respectively the hydrodynamic coefficients of surge sway and yawing motions of the float and sign represents the sign function the location of the float in the earth fixed frame was derived by eq 6 6 ξ f u f c ψ f v f s ψ f η f u f s ψ f v f c ψ f ψ f r f where ξ f and η f are respectively the longitudinal and the transverse coordinates of the float in the earth fixed frame and ψ f is the heading of the float 2 2 dynamic model of a glider the 4 dof surge sway heave and yaw coupled model of a glider was formulated as follows fossen 2011 7 m g ν r g c g ν r g ν r g d g ν r g τ g p g where v r g u r g v r g w g r g t u g u g c v g v g c w g r g t is the velocity vector of the glider relative to current u r g and v r g are respectively the surge and the sway velocities of the glider relative to current u g v g and w g are respectively the surge the sway and the heave velocities of the glider in the glider frame u g c and v g c are respectively the longitudinal and the transverse velocities of ocean current in the glider frame and r g is the yawing velocity of the glider m g m r b g m a g is the inertia matrix of the glider including the added mass c g v r g c r b g v r g c a g is the coriolis centripetal matrix of the glider including the added mass d g ν r g is the damping vector of the glider τ g is the vector of active control inputs on the glider including thrust and rudder forces and p g is the vector of static force on the glider now based on eq 1 m g and c g v r g were further simplified to eqs 8 and 9 respectively 8 m g m g x u g 0 0 0 0 m g y v g 0 0 0 0 m g z w g 0 0 0 0 i z g n r g 9 c g v r g 0 0 0 m g v r g a 2 g 0 0 0 m g u r g a 1 g 0 0 0 0 m g v r g a 2 g m g u r g a 1 g 0 0 where m g is the mass of the glider i z g is the moment of inertia of the glider about the z axis of the glider frame x u g y v g z w g and n r g are the inertia hydrodynamic coefficients of the glider and a 1 g a 2 g are the hydrodynamic coriolis centripetal coefficients of the glider d g ν r g was formulated as follows 10 d g ν r g c u g u r g 2 sign u r g c v g v r g 2 sign v r g c w g w r g 2 sign w r g c r g r g 2 sign r g t where c u g c v g c w g and c r g are respectively the hydrodynamic coefficients of surge sway heave and yawing motions of the glider remarks in section 5 the data of thrust zhang 2017 were considered as the resultant force of pure thrust and pure damping of the glider thus the first element of d g ν r g was set to 0 τ g was expressed as follows 11 τ g x τ g y τ g z τ g n τ g t 1 2 ρ s v r δ 2 c d δ 1 2 ρ s v r δ 2 c l δ 0 y τ g l δ where t is the thrust generated by hydrofoils ρ is the medium density 1 025 103 kg m3 in seawater s is the area of rudder v r δ is the inflow velocity of rudder c l δ and c d δ are respectively the coefficients of lift and drag forces on rudder and are related to rudder angle δ and l δ is the distance between rudder and the center of the glider p g was formulated as follows 12 p g 0 0 w 0 t where w is the underwater gravity of the glider the location of the glider in the earth fixed frame was derived by eq 13 13 ξ g u g c ψ g v g s ψ g η g u g s ψ g v g c ψ g ζ g w g ψ g r g where ξ g η g and ζ g are respectively the longitudinal the transverse and the vertical coordinates of the glider in the earth fixed frame and ψ g is the heading of the glider 3 dynamic model of the uwg when the umbilical is under tension 3 1 coordinate frames and dofs four coordinate frames system frame float frame glider frame and earth fixed frame are displayed in fig 3 kraus 2012 1 system frame with the right superscript 0 it is attached to the center of gravity of the system on the umbilical the axis defined as x 0 is locally normal to the umbilical and is positive in the direction of forward velocity the axis defined as z 0 lies along with umbilical and points to the glider and y 0 satisfies the right hand rule 2 the coordinates of the float frame with the right superscript f the glider frame with the right superscript g and the earth fixed frame ξ η ζ are similar to those described in section 2 remarks the origins of the float frame and the glider frame are located on the hinged joints between float and umbilical and between glider and umbilical respectively the relative position between float and glider is described by rolling and pitching angles of the umbilical the hinged joint between float and umbilical is located in front of the center of gravity of the float thus x g f 0 the surge and the sway of the center of gravity of the uwg the roll and the pitch of the umbilical and the yawing motions of float and glider were mainly considered the relative positions between float and glider were described by ϕ rolling angle of the umbilical and θ pitching angle of the umbilical furthermore the yawing angle of the system frame was set as ψ 0 ψ g and the heading error between float and glider was considered as δ ψ ψ g ψ f the acceleration vector the velocity vector and the position vector of the uwg were expressed as follows 14 a u v p q r f r g t v u v p q r f r g t η ξ η ϕ θ ψ f ψ g t where u and v are respectively the surge and the sway velocities of the uwg in the system frame and p and q are respectively the rolling and the pitching velocities of the umbilical now the velocity vector of the uwg relative to ocean current was formulated by eq 15 15 ν r u r v r p q r f r g t where u r and v r are respectively the surge and the sway velocities of the uwg relative to ocean current in the system frame 16 u r u u c v r v v c where u c and v c are respectively the longitudinal and the transverse velocities of ocean current in the system frame the transformation matrix from the system frame to the float frame was derived by eq 17 kraus 2012 17 r o f c θ c δ ψ s θ c δ ψ s ϕ s δ ψ c ϕ s θ c δ ψ c ϕ s δ ψ s ϕ c θ s δ ψ s θ s δ ψ s ϕ c δ ψ c ϕ s θ s δ ψ c ϕ c δ ψ s ϕ s θ c θ s ϕ c θ c ϕ α β ϖ γ χ s θ κ μ the transformation matrix from the system frame to the glider frame was expressed by eq 18 kraus 2012 18 r o g c θ s θ s ϕ s θ c ϕ 0 c ϕ s ϕ s θ c θ s ϕ c θ c ϕ c θ γ λ 0 c ϕ s ϕ s θ κ μ the transformation matrix from the system frame to the earth fixed frame was derived by eq 19 kraus 2012 19 r o n e d c θ c ψ g c ψ g s θ s ϕ s ψ g c ϕ c ψ g s θ c ϕ s ψ g s ϕ c θ s ψ g s ψ g s θ s ϕ c ψ g c ϕ s ψ g s θ c ϕ c ψ g s ϕ s θ c θ s ϕ c θ c ϕ now 20 r f o r o f t r g o r o g t r n e d o r o n e d t 3 2 kinematics of the uwg when the umbilical is under tension motion parameters of float and glider in the system frame were derived based on rigid body motion equations 21 η f o η r f η g o η r g v f o v ω r f v g o v ω r g a f o a α r f ω ω r f a g o a α r g ω ω r g v f r o f v f o v f r o g v g o a f r o f a f o a g r o g a g o where 22 r f 0 0 d f t r g 0 0 d g t ω p q 0 t α p q 0 t where η η f o η g o v v f o v g o v f v g and a a f o a g o a f a g are respectively the position the velocity and the acceleration vectors right superscripts refer to a particular component and left superscripts refer to the reference coordinate frame the vector is expressed in the omission of left superscripts indicates that the variable is expressed in the body fixed frame of itself by default ω and α are respectively the angular velocity and the angular acceleration vectors of the system frame d f is the distance from the hinged joint between float and umbilical to the origin of the system frame and d g is the distance from the hinged joint between glider and umbilical to the origin of the system frame the heave and the yawing velocities of the system frame were calculated as follows lu 2015 23 w w f s θ u q d f κ v p d f μ 24 r c θ r g s ϕ q c ϕ the relationship between the velocity vector and the position vector can be expressed by eq 25 fossen 2011 25 ξ η ζ t r o n e d u v w t ϕ p t θ s ϕ q t θ c ϕ r θ c ϕ q s ϕ r ψ f r f ψ g r g 3 3 dynamic model of the uwg when the umbilical is under tension the dynamic model of the uwg when the umbilical was under tension can be presented by eq 26 26 m r b v c r b ν ν f m a ν r f c a ν r d ν r g η τ where m r b r 6 6 is the rigid mass matrix c r b ν r 6 6 is the coriolis centripetal coefficient matrix f m a ν r r 6 1 is the inertial hydrodynamic force vector f c a ν r r 6 1 is the hydrodynamic coriolis centripetal force vector d ν r r 6 1 is the damping force vector g η r 6 1 is the restoring force vector and τ r 6 1 is the active control force vector d ν r contains viscous hydrodynamic force and τ possesses thrust and rudder forces furthermore ν is the velocity vector of the uwg relative to earth and ν r is the velocity vector of the uwg relative to current the longitudinal the transverse and the vertical forces and the yawing moments of float and glider are represented as x f and x g y f and y g z f and z g n f and n g respectively the force vector of the uwg x r 6 1 was obtained as 27 x 1 2 f 1 2 28 x 3 4 m 1 2 29 x 5 6 n f n g t where 30 f r f o x f y f z f t r g o x g y g z g t 31 m r f r f o x f y f z f t r g r g o x g y g z g t x i j represents the vector consisted of the ith element to the jth element of the vector x when considering the holistic motion of the uwg the shapes of float and glider were ignored thus the moments of inertia about the x axis and the y axis and the inertial product of the uwg about the system frame were expressed as follows 32 i x i y m f d f 2 m g d g 2 33 i x y 0 the origin of the system frame was set at the center of gravity of the uwg therefore 34 x g y g z g 0 m r b and c r b ν were formulated as follows 35 m r b m 0 0 0 m f x g f γ 0 0 m 0 0 m f x g f χ 0 0 0 i x 0 m f d f x g f χ 0 0 0 0 i y m f d f x g f γ 0 m f x g f γ m f x g f χ m f x g f χ d f m f x g f γ d f i z f 0 0 0 0 0 0 i z g 36 c r b 0 0 0 m w m f x g f r f v f α m f u f γ m g v g c θ 0 0 m w 0 m f x g f r f v f β m f u f χ m g v g γ m g u g c ϕ 0 m w 0 0 d f m f x g f r f v f β u f χ d g m g v g γ u g c ϕ m w 0 0 0 d f m f x g f r f v f α u f γ d g m g v g c θ 0 0 0 0 m f x g f u f 0 0 0 0 0 0 0 where m is the mass of uwg m m f m g furthermore an additional force was considered during the derivation process of the rigid mass matrix 37 m f w m f x g f p p q q d f m f x g f r p d f m f x g f γ r q d f m f x g f χ now for g η the underwater gravity w of the glider and the extra buoyancy of the float the balance force for the underwater gravity of the glider produce rolling and pitching moments of the uwg 38 m g r f r f o 0 0 w t r g r g o 0 0 w t d f d g κ w s θ w 0 t therefore 39 g η 0 0 d f d g κ w d f d g s θ w 0 0 t 4 judgment principle and state transfer in the switching process 4 1 from slack umbilical to the umbilical under tension 4 1 1 judgment principle when the umbilical has some slack the glider falls under its own gravity thus the initial distance between float and glider becomes less than the length of the umbilical when the float is pulled upward by surface waves or falls with a lower velocity than that of the glider the distance between float and glider increases the maximum distance between float and glider is restricted by the length of the umbilical furthermore with the increasing distance between float and glider the distance between float and glider becomes equal to the length of the umbilical at a certain time therefore the umbilical changes from its loose state to the state under tension in two cases 1 the distance between float and glider d f g is larger than the length of the umbilical d u m b i l i c a l 40 d f g ξ f ξ g 2 η f η g 2 ζ f ζ g 2 d u m b i l i c a l 2 the distance between float and glider is equal to the length of the umbilical and float and glider move away from each other 41 d f g d u m b i l i c a l and v r f g 0 where v r f g is the projective velocity of the glider relative to the float on the connecting line from the float to the glider 42 v r f g r f g v r f g where r f g is the normalized radius vector from float to glider in the earth fixed frame 43 r f g ξ g ξ f η g η f ζ g ζ f t d f g v r f g is the velocity vector of the glider relative to the float in the earth fixed frame 44 v r f g ξ g ξ f η g η f ζ g ζ f t 4 1 2 state transfer the initial velocity of the uwg in the system frame the initial position of the uwg in the earth fixed frame the initial rolling and pitching angles of the umbilical and the angular velocities of the system frame were expressed by the following equations the origin of the system frame was set at the center of gravity of the uwg therefore 45 η o n e d m f η f n e d m g η g n e d m f m g 46 η o n e d m f η f n e d m g η g n e d m f m g where η o n e d ξ η ζ t η f n e d ξ f η f ζ f t and η g n e d ξ g η g ζ g t the velocity vector of the uwg in the system frame was derived by eq 47 47 v r n e d o η o n e d now from eq 21 48 v g o v ω r g q d g i p d g j 0 k therefore 49 p v g o v j d g 50 q v g o v i d g where 51 v g o r g o v furthermore 52 r g n e d r o n e d r g where r g n e d is the radius vector from the origin of the system frame to the origin of the glider frame in the earth fixed frame 53 r g n e d η g n e d η o n e d eq 52 is a vector equation and can be expanded to an equation group consisted of three scalar equations the first and second equations of the equation group are two equations including ϕ and θ 54 d g c ψ g s θ c ϕ s ψ g s ϕ r g n e d i 55 d g s ψ g s θ c ϕ c ψ g s ϕ r g n e d j moreover 56 s 2 θ c 2 θ 1 57 s 2 ϕ c 2 ϕ 1 the equation set consisting of eqs 54 57 has four unknown quantities s θ c θ s ϕ and c ϕ which can be solved by numerical methods the values of initial rolling ϕ and pitching θ angles were obtained by the anti trigonometric function multiple solutions were achieved for the equation set however the right solution was considered for the case of c θ 0 c ϕ 0 90 ϕ 90 and 90 θ 90 4 2 from the umbilical under tension to slack umbilical 4 2 1 judgment principle when the umbilical is under tension the distance between float and glider remains unchanged when the float falls rapidly the umbilical may provide a compressive force and becomes slack the umbilical is considered as squeezed when the vertical force on the glider from the umbilical is positive the force on the glider from the umbilical can be obtained by removing other forces such as static force active control input force and hydrodynamic force from the resultant force of the glider the resultant force vector of the glider was expressed by eq 58 58 f g m g a g where a g is the acceleration vector of the glider in the glider frame 59 a g r o g a g o the vector of tension from umbilical to glider was derived by eq 60 60 t g f g p g τ g d g where p g τ g and d g are respectively the vectors of static force active control input force and hydrodynamic force on the glider the vector t g consists of three elements the third element of t g or t g 3 which is the vertical force of the umbilical on the glider was only used for the judgment when t g 3 0 the umbilical becomes slack 4 2 2 state transfer the initial positions of float and glider in the earth fixed frame and the initial velocities of float and glider in their body fixed frames were obtained from the following equations 61 η f n e d η o n e d r o n e d r f 62 η g n e d η o n e d r o n e d r g 63 v f r o f v f o 64 v g r o g v g o 5 numerical simulation experiments and analysis the main parameters of the uwg are presented in table 1 lu 2015 the added masses of the uwg in the horizontal and the vertical directions were respectively set to 0 1 and 2 1 times of the inherent mass tian et al 2015a 2015b korotkin 2010 zhang 2017 calculated thrusts produced by hydrofoils under regular sine waves of different amplitudes and periods through cfd simulations and the output result was the resultant force of pure thrust and pure damping of the glider table 2 5 1 distance between float and glider under different wave conditions numerical simulation results of longitudinal and rotary motions of the uwg under different typical regular sine wave conditions are presented in table 3 rasmussen and williams 2006 the initial velocities of float and glider the initial pitching and rolling angles of the umbilical and the initial headings of float and glider were all set to 0 the length of the umbilical was 4 m during rotary motion simulation rudder angle was set to 20 the obtained simulation results are expressed in figs 4 11 and in tables 4 and 5 figs 4 11 present distances between float and glider during longitudinal and rotary motions under different wave conditions under wave condition 1 the umbilical was always under tension during both longitudinal and rotary motions thus the distance between float and glider was always equal to the length of the umbilical it is evident from tables 4 and 5 that the maximum heave velocity of waves under wave condition 1 was less than those under other wave conditions hence the umbilical did not experience the loose state under wave conditions 2 4 the distance between float and glider was smaller than the length of the umbilical for a certain period of time the umbilical became slack and was alternately pulled and loosened it is noticeable from tables 4 and 5 that as the maximum heave velocity of waves started to increase the distance between float and glider became smaller thereby resulting in larger proportions of time when there is slack in the umbilical this happened because the heave motion of the float was more intense under higher wave conditions when the float fell faster than the glider the umbilical was easily loosened under wave condition 4 the proportions of time when there is slack in the umbilical during longitudinal and rotary motions were respectively 27 54 and 32 34 it signifies that almost no transmission of forces and motion between float and glider occurred for about 30 time period 5 2 motion responses of the uwg in the present section the dynamic characteristics of the uwg during longitudinal and rotary motions under wave condition 2 wave height 0 5 m and wave length 16 m are examined 5 2 1 longitudinal motion simulation simulation results of the uwg during longitudinal motion are depicted in figs 12 14 in fig 12 blue round points red square points and black lines respectively represent float glider and umbilical the motion of the float was found to be comparatively more regular whereas the glider was pulled more intensely the longitudinal velocities of float and glider and the pitching angle of the umbilical are presented in figs 13 and 14 respectively the average velocities of float and glider were measured as about 0 78 m s under the specific sea condition 5 2 2 rotary motion simulation simulation results of the uwg during rotary motion with 20 rudder angle are displayed in figs 15 17 in figs 15 and 16 the curves of blue round points and red square points respectively represent the irregularly round trajectories of float and glider whereas black lines denote the umbilical moreover the heading of the float lagged behind that of the glider fig 17 it happened because the yawing moment of the float was generated from the tension of the umbilical therefore a non zero heading error between glider and float is the precondition for the yawing moment of the float 6 conclusions 1 the dynamic model of a uwg with flexible umbilical was established in the afore discussed research and the proposed model was found to be reasonable and operable in practice 2 simulation results revealed that the umbilical was not always under tension when the wave surface fell rapidly under high wave conditions the umbilical easily became slack 3 the uwg due to its unique rigid flexible multibody joint structure manifested unique dynamic characteristics the velocities of float and glider oscillated with undulating waves and the heading of the float lagged behind that of the glider in our future research a nonlinear model of the flexible umbilical will be developed in order to study the influences of geometrically nonlinear effects tension and stiffening on uwgs the umbilical will be divided into multiple nonlinear elements with mass and axial stiffness and each element would be capable of large rotations funding this work was supported by the national key r d program of china grant number 2017yfc0305700 the national natural science foundation of china grant number 51779052 51879057 u1806228 the natural science foundation of heilongjiang province of china grant number qc2016062 the heilongjiang postdoctoral funds for scientific research initiation grant number lbh q17046 the fundamental research funds for the central universities grant numbers heucfp201741 heucfg201810 the qingdao national laboratory for marine science and technology grant number qnlm2016orp0406 the research fund from science and technology on underwater vehicle laboratory grant number 6142215180102 614221503091701 appendix appendix 1 nomenclature of all state variables name description m f m g m the masses of the float the glider and the whole uwg i z f i z g the moments of inertia about the z axis of the corresponding body fixed frame of the part specified by the right superscript i x i y i x y the moments of inertial of uwg about the x axis and y axis of system frame and the inertial product of uwg d f d g the distances from the hinged joint between the part specified by the right superscript and umbilical to the origin of system frame d f g d u m b i l i c a l the distance between the float and the glider the length of umbilical x g f y g f z g f x g g y g g z g g the x y z coordinates of the center of gravity of the part specified by the right superscript in the corresponding body fixed frame x g y g z g the x y z coordinates of the center of gravity of uwg in system frame ξ f η f ζ f ξ g η g ζ g the longitudinal transverse and vertical coordinates of the part specified by the right superscript in the earth fixed frame ξ η ζ the longitudinal transverse and vertical coordinates of the origin of system frame in the earth fixed frame ψ f ψ g ψ 0 δ ψ the heading of the float the heading of the glider the heading of the system frame the heading error between the float and the glider ϕ θ the rolling angle and the pitching angle of umbilical u f v f w f r f the surge sway heave yawing velocity of the float in the float frame u g v g w g r g the surge sway heave yawing velocity of the glider in the glider frame u v w p q r the surge sway heave rolling pitching yawing velocities of uwg in the system frame u f c v f c u g c v g c the longitudinal and transverse velocities of ocean current in the body fixed frame specified by the right subscript u c v c the longitudinal and transverse velocity of ocean current in the system frame u r v r the surge and sway velocities of the system frame in system frame u r f v r f u r g v r g the surge and sway velocities of the part specified by the right superscript relative to current v r f g the projective velocity of the glider relative to the float on the connecting line from the float to the glider i j k the x axis y axis z axis unit vector of the system frame ω α the angular velocity vector and angular acceleration vector of the system frame v r f v r g the vector of velocity relative to current for the part specified by the right superscript in the dynamic equation of the part with slack umbilical ν r the vector of velocity relative to current for the uwg in the dynamic model of uwg when the umbilical is under tension v r f g the velocity vector of the glider relative to the float in the earth fixed frame a v η the acceleration vector velocity vector position vector of uwg in the dynamic model of uwg when the umbilical is under tension a v η the acceleration vector velocity vector position vector of surge sway and heave motion of uwg in the system frame η f o η g o η o n e d η f n e d η g n e d v f o v g o v f v g a f o a g o a f a g the vectors of position velocity and acceleration of surge sway and heave motion while the right superscript refers to a particular component and the left superscript refers to the reference coordinate frame the vector is expressed in omission of the left superscript indicates the variable is expressed in the body fixed frame of itself by default r f r g the position vector of the part specified by the right superscript in the system frame r f g the normalized radius vector from the float to the glider in the earth fixed frame r g n e d the radius vector from the origin of the system frame to the origin of the glider frame in the earth fixed frame r o f r o g r o n e d r f o r g o r n e d o the transformation matrix from the frame specified by the left subscript to the frame specified by the left superscript α β ϖ γ χ κ μ γ λ substitutions related to ϕ θ δ ψ to simplify the expression of other equations m f m r b f m a f m g m r b g m a g the inertia matrix rigid body mass matrix added mass matrix of the part specified by the right superscript c f c r b f c a f c g c r b g c a g the coriolis centripetal matrix rigid body coriolis centripetal matrix hydrodynamic coriolis centripetal force matrix of the part specified by the right superscript d f d g the damping vector of the part specified by the right superscript m r b rigid body mass matrix of uwg c r b the matrix of coriolis centripetal coefficient of uwg f c a f m a d g τ the vector of hydrodynamic coriolis centripetal force the vector of inertial hydrodynamic force the vector of damping force the vector of restoring force the vector of active control force in the dynamic model of uwg when the umbilical is under tension m f the additional force in the derivation process of rigid mass matrix m r b τ w i n d f τ w a v e f the vector of wind forces and the vector of wave forces on the float τ g the vector of active control inputs on the glider including thrust and rudder forces p g the vector of the static force on the glider f g the vector of resultant force of the glider of surge sway and heave motion t g the vector of tension of umbilical acted on the glider of surge sway and heave motion d g the vector of damping force of the glider of surge sway and heave motion τ g the vector of active control inputs on the glider of surge sway and heave motion p g the vector of the static force on the glider of surge sway and heave motion m g the vector of the rolling and pitching moments of uwg related to the underwater gravity of the glider x u f y v f n r f the inertial hydrodynamic coefficient in surge sway and yawing motion of the float c u f c v f c r f c u g c v g c w g c r g the hydrodynamic coefficient of the part specified by the right superscript related to the motion specified by the right subscript a 1 f a 2 f a 1 g a 2 g the elements of hydrodynamic coriolis centripetal matrix of the part specified by the right superscript t the thrust generated by hydrofoils ρ the medium density s the area of rudder v r δ the inflow velocity of rudder δ rudder angle c l δ c d δ coefficients of lift and drag of rudder l δ the distance from the rudder to the center of the glider w the underwater gravity of the glider 
22864,the xiazhimen waterway is regarded as the bottleneck of the shipping routes linking the ship traffic between the hub areas in ningbo zhoushan port and the outside waters in this paper a microcosmic simulation model for ship traffic in the waterway is developed to investigate the motion behaviours of ships to various navigational scenarios the simulation model is derived from the statistical analysis of ais data and takes the ships acceleration and deceleration into account by the extraction of ship traffic characteristics an empirical ship domain model is formulated to determine the safe distance between ships the update rules incorporating the ships interactions the empirical domain model as well as transit rules are designed to simulate the speed fluctuations of ships by comparing the real case with the simulation results in terms of the average passage time and the average speed along the waterway the performance of the model are further validated the model also facilitates the prediction of navigation risk and channel capacity with increased traffic volume and increased proportion of large size ships keywords xiazhimen waterway traffic simulation ais data analysis ship domain 1 introduction the xiazhimen waterway is a 12 km long and 1 km wide channel located in ningbo zhoushan port of zhejiang province china see fig 1 and the port area where the waterway is situated ranks the largest port in the world in terms of cargo throughput the waterway is also one of the most important and busiest shipping channels due to its excellent navigable conditions and plays a vital role in the international as well as domestic freight transportation linking the ship traffic between the hub areas in ningbo zhoushan port and the outside waters however the waterway narrows to only 500 m wide in the xialan mountain segment resulting in a big traffic bottleneck the traffic efficiency in the waterway is becoming an important issue that has to be dealt with properly moreover once ship collisions occur in such busy waters the consequences can be catastrophic especially for oil tankers and chemical lng lpg vlcc ships which may cause huge economic loss serious environmental pollution and fatalities therefore the operational efficiency and safety of vessels through the waterway have attracted many attentions from the zhejiang maritime bureau and other relevant stakeholders including port authorities ship owners as well as carriers many regulations for enhancing transportation efficiency and safety of vessels sailing in the waterway have been implemented over the past 10 years the traffic separation scheme tss and the mandatory ship reporting system have been brought into force and applied since aug 1st 2010 the traffic in opposite directions was separated by the establishment of traffic lanes however the marine traffic is increasing over the years in the waterway due to the continuous growth of transportation demand the increase of traffic flow would lead to high traffic density and pose more risks accordingly the existing maritime traffic control strategies may be not enough to maintain the navigational efficiency and safety at a high level to improve the navigational efficiency and safety of such narrow and busy waterway it is a pre requisite to have a deep insight into the characteristics of ship movements which can facilitate the maritime authorities to make and evaluate new operational strategies the conventional feature analysis of ship movements in narrow waterways is usually conducted based on ship traffic surveys such as observations radar monitoring as well as airborne photography fujii and tanaka 1971 however such traffic surveys are sometimes difficult due to the large time and resource consumption yamaguchi and sakaki 1971 moreover it is not possible to obtain the picture of ship movements by utilizing the above mentioned methods when taking into account the continuous growth of traffic volume in the future one possible alternative to overcome the above challenge is to build a simulation model for ship traffic to investigate the motion behaviors of ships with distinct traffic flow in the waterway automatic identification system ais has been identified as a very useful data source reflecting the ship traffic characteristics following this idea extensive statistical analysis on ais data is performed in this paper in view of its high reliability of ship traffic information and its promising value in identifying the ship traffic characteristics the statistical results are further used in the ship traffic simulation to get the picture of ship movements in the waterway this study aims to develop a simulation model for ship traffic in the xiazhimen waterway to describe the ship movement characteristics more precisely the contributions of this study are threefold first it initiates research into investigating some statistical distributions of ship traffic based on ais data analysis especially identifying the ships acceleration and deceleration behaviors it is found that the acceleration and deceleration of ships derived from the ais data are much smaller than the speed variation in existing simulation models further investigations are performed to identify the timing that ships take collision avoidance actions when they are interacting with each other in terms of the newton s laws of motion second an empirical ship domain model is formulated by visualizing the distances between all ships with a special intensity plot which can determine the safe distance between ships more accurately and be embedded into the ship traffic simulation model third the update rules which take into account the ships interactions the empirical domain model as well as transit rules are designed to simulate the fluctuations of ship speed in the waterway meanwhile with the designed simulation model the tendencies of navigation efficiency and risk indices of ship movements in the waterway along with the increased traffic volumes are estimated the new operational proposals and theoretical channel capacity are also evaluated and predicted based on the proposed model respectively the rest of the paper is organized as follow section 2 reviews the existing studies conducted on ais data analysis and applications as well as the research related to ship traffic simulation in section 3 the research methodology and analysis of ship traffic based on ais data are described including data pre processing statistical characteristics of ship traffic and an empirical ship domain model section 4 presents the procedure and the update rules for the simulation model the validation and application of the proposed model are demonstrated in section 5 conclusions and the future research are summarized in section 6 2 literature review many research works have been conducted on ais data analysis from different perspectives or objectives which mainly include ship traffic statistics meng et al 2014 wu et al 2016 geographical visualization willems et al 2009 ship traffic pattern recognition aarsæther and moan 2009 silveira et al 2013 ship domain calculation and shaping hansen et al 2013 as well as ship conflicts extraction chai et al 2017 weng et al 2012 for example xiao et al 2015 performed ais data analysis to explore the spatial and temporal distributions of ship traffic tsou 2010 investigated the visualization features of ship trajectory and density by applying data mining technique to the analysis of ais data weng et al 2012 estimated the number of vessel conflicts using ais data in the singapore strait to identify the most risky area wang and chin 2016 developed an empirical dynamic ship domain model based on vessel movement data in singapore port and singapore strait for risk assessment these studies motivated a deeper understanding on the ship traffic characteristics and are meaningful for improving the performances of ship traffic simulation regarding to simulation models a series of studies have been conducted and applied for navigational safety and risk management in different waters köse et al 2003 merrick et al 2005 uluscu and altiok 2009 van dorp and merrick 2011 van dorp et al 2001 to list some ince and topuz 2004 proposed a safe navigation simulation model by combining with a hydrographic prediction model to prevent marine causalities in different waterways yeo et al 2007 proposed the awe sim simulation program for the evaluation of the port traffic congestion at north harbor in busan in the year of 2011 szpak and tapamo 2011 utilized a background subtraction model to address the tracking of moving vessels in water areas mavrakis and kontinakis 2008 proposed a queueing model of maritime traffic in bosporus straits incorporating the physical characteristics of the waterway as well as the maritime regulations it should be noted that the ship movement characteristics and the interactions among ships are not fully considered in the above mentioned simulation models in dealing with the interactions among ships the cellular automaton ca approach has been applied to simulation models of ship movements which is widely used in the study of vehicle traffic flow due to its simplicity and high computational efficiency biham et al 1992 kerner et al 2002 nagel and schreckenberg 1992 for example sun et al 2015 proposed a two lane cellular automata model named si stca to investigate the traffic flow patterns when overtaking occurs qu and meng 2012 developed a ca based ship movement model in which the velocities of vessels were divided into two directions as well as the effects of captain behaviors and the navigational rules were taken into account to illustrate the pictures of traffic movements in the singapore strait qi et al 2017a proposed a novel ca model called the spatial logical mapping slm to address the ship pseudo lane change issue in these models issues like the interactions among ships in narrow and busy shipping channels the behaviors of ship captains and pilots and the movement characteristics of ships with different categories and sizes etc have been considered however the acceleration and deceleration magnitude of ships were not systematically taken into account or the acceleration and deceleration are set too large in these simulation models which is not realistic in many applications these problems may give rise to biased or inaccurate results as the negligence of the acceleration and deceleration magnitude of ships would affect the timing that ships take collision avoidance actions when the ship interactions occur in the simulation models regarding to such problems a ship traffic simulation model is developed for the xiazhimen waterway incorporating the acceleration and deceleration magnitude of ships as well as an empirical ship domain model the model was constructed on the basis of the analysis of ais data from the xiazhimen waterway 3 ais data analysis 3 1 data collection and pre processing a period of 12 day s aug 14 25 2016 ais data with a collection of 444 276 records in the xiazhimen waterway was collected the ais data mainly consists of the following information mmsi maritime mobile service identity number time coordinate position longitude and latitude course and speed as well as ship length to extract useful and relevant information some vessels whose voyage trajectories are irregular were excluded these vessels mainly include tug boats pilot boat police patrols and fishing vessels which may not follow the conventional trajectories due to their special missions due to the loss and or errors and or other reasons during data collection transmission and reception the ais data usually includes some errors noises which would affect the ship traffic statistics and analysis therefore it is necessary to ensure the reliability of the ais data to remove some errors in ais data such as the messy codes and data irrationalities a tangible error elimination method proposed by kang et al 2018 is employed to check ship id errors to eliminate ship position errors and to remove ship speed errors then the data cleaning procedure presented in qu et al 2011 is adopted to update those inaccurate records instead of eliminating them so as to keep the integrality of the real time data this procedure is based on the newton s laws of motion and can identify whether the variations of speed and position of each record are within the reasonable range in addition the analysis of ship interactions requires that the ship movements timestamps are synchronous so a linear interpolation method proposed by zhang et al 2015 is applied for data synchronization with a predefined time interval the details of the ais data cleaning and interpolating algorithm are presented in appendix a in zhang et al 2017a which are available for reference 3 2 data statistics and analysis 3 2 1 ship traffic characteristics an extensive analysis of ais data is conducted in this section to obtain the input parameters for the traffic simulation including distribution statistics of ship traffic and analysis of ships acceleration and deceleration characteristics the statistics of ship traffic are performed according to the following aspects the distribution of ships arriving fig 2 ship speed fig 3 and ship length table 1 the results are used for the ship generation from the two directions of the xiazhimen waterway in the simulation model fig 2 demonstrates the number of ships arriving per hour throughout the day a significant fluctuation can be found in the number of ships arriving at each hour during the day according to the related studies the distributions of ship arrivals are usually assumed to follow a stationary poisson process przywarty 2008 however this is no longer suitable for this case because the number of ships arriving is fluctuating during different hours of the day as a result the distributions of ships arriving are modeled as a non stationary poisson process in the following simulations goerlandt and kujala 2011 the process is associated with time dependent arrival rate in which its intensity function λ t is fluctuating with time fig 3 a and b present the distributions of ships initial speed in the two portals of the waterway it can be seen that normal and weibull distribution curves fit these histograms well besides due to the fact that the ships need to slow down in the lower part of the waterway to get on or off the pilots the northbound ships initial speed is usually less than their expected speed therefore the distributions of the difference between expected speed of each trajectory and its initial speed are analyzed which are shown in fig 3 c and d the expected speed values are determined by calculating the mean speed of each trajectory in the upper part of the waterway it can be found the mean in fig 3 c is 1 98 knots meaning that most of northbound ships will speed up after transiting the lower part of the waterway there is no significate distinction between the southbound ships expected speed and their initial speed since the mean in fig 3 d is close to 0 the distributions of ship length in the two directions are presented in table 1 in addition the acceleration and deceleration characteristics of ship traffic are explored to reveal the motion behaviors of ships and to further determine the timing that ships take collision avoidance actions when they are interacting with each other fig 4 depicts the distributions of average acceleration and deceleration of each ship respectively it can be found that gamma curves fit these histograms well it should be noted that the trajectory points with acceleration or deceleration smaller than 0 1 kn min are excluded in the process of statistics this is due to that the main purpose of statistics is to determine the acceleration and deceleration magnitude when ship navigators take the initiative to slow down or speed up so they can be used in the simulation to illustrate the interactions among ships in the statistical process it can be found that the speed of each ship s trajectory has always been fluctuating and there are too many small irregular fluctuations which is not related to the ship navigators active actions if these small fluctuations are involved in the results the ship s acceleration and deceleration will be reduced therefore these small speed fluctuations were not considered in the statistical results the results show that the acceleration and deceleration are mainly between 0 1 and 0 9 kn min which are much smaller than the speed variation per minute in some existing simulation models qi et al 2017a qu and meng 2012 sun et al 2015 this finding signifies that the parameter settings on speed fluctuations in these models are not completely reasonable and the acceleration and deceleration magnitude are not considered in detail in the ship movement simulation models in this paper the acceleration and deceleration of each ship are supposed to follow gamma distributions within a range of 0 1 0 9 kn min in the simulations to describe the ship movement characteristics more reasonably it should be noted that there is little overtaking in the xiazhimen waterway and overtaking in the upper part of the channel is prohibited according to the interviews to safety managers in zhejiang maritime bureau therefore the ships transit this waterway based on ship following rules and their navigational behaviors are mainly influenced by their preceding ships qi et al 2017a 2017b considering this the distance and speed difference the speed of the ship ahead minus own speed with the ship ahead when the ship starts to accelerate are extracted from ais data see fig 5 two interesting findings can be found in this figure first a lot of ships would speed up if their speed is less than that of their preceding ships and the distances with their preceding ships are not necessary to be too large second when the ship speed is greater than that of the ship ahead it will speed up only if the distance to its preceding ship is large enough most of which are larger than 10l l is the length of present ship these two findings will be involved in determining whether the ship would accelerate during navigating in the simulation model the deceleration timing of ships is determined by combining the concept of arena proposed by davis et al 1980 with the ships deceleration magnitude and the safe distance between ships which will be analyzed in section 4 2 3 2 2 ship domain model ship safety domain is a generalization of a safe space around a ship for collision avoidance with respect to other ships or stationary obstacles since the concept was first introduced in fujii and tanaka 1971 numerous ship domain models were developed for applications on collision avoidance szlapczynski and szlapczynska 2017a 2015 near miss detection iperen 2015 waterway risk analysis qu et al 2011 and channel capacity analysis zhang et al 2017b the methods of determining these domain models can be roughly divided into four groups empirical knowledge based safety analysis based and combinations of them dinh and im 2016 liu et al 2016 pietrzykowski 2008 wang 2013 wang and chin 2016 in this section an empirical method based on ais data proposed by hansen et al 2013 is applied to design the ship domain model in the xiazhimen waterway since it enables observing the minimum distance between ships when passing each other in different directions the model is subsequently used in the simulation model to determine the safe distance between ships the idea of this method is to visualize the distances between all ships in this area with a special intensity plot and the color intensity in the plot reflects the distribution of other ships around the own ship the outline of the algorithm for determining the intensity plot of ais data are presented in fig 6 fig 7 demonstrates the intensity of ais data in the xiazhimen waterway together with the elliptical ship domain model the regions with larger intensity index of colors represent that there are more amount of timestamps in these grids the intensity plot is discretized into grids of 0 2 0 2 of the ship length covering an area with a length of 24l l represents the length of ship and a breadth of 12l it can be seen that the intensity of the port side is higher than that of the starboard which is in line with the real situation that ships are navigating on the right side of the waterway according to the tss and there are no other ships to their starboard in most cases to determine the size of the ship domain an ellipse is used to describe the safe distance between ships in terms of the colors in the intensity plot the results indicate that the ellipse have a length of 9l and a breadth of 2 4l more exactly the ship domain is an ellipse with a length of 5 5l in front of the ship and 3 5l behind the ship that is the ship position is moved from the ellipse s center towards aft by 1l this finding indicates that ship navigators will pay more attention to the ships in front compared to the ships behind in addition the long axis of the elliptical domain is larger whereas the short axis is smaller compared with the traditional elliptical domains coldwell 1983 fujii and tanaka 1971 this may be due to the fact that the water area is a typical narrow waterway where overtaking between ships is almost impossible thus the consecutive ships tend to maintain a larger front to back spacing for safe navigation moreover the elliptical domain determined in this section complies with the 3rd definition of ship domain in szlapczynski and szlapczynska 2017b where neither of the ship domains should be violated therefore unlike the domain models in rawson et al 2014 wang and chin 2016 the overlapping domains are allowed based on the proposed model as long as the ships do not invade each other s domain 4 simulation model 4 1 the procedure a ship movement model mainly includes two parts generating the ships entering the waterway and running the ships in the waterway the generations of the ships including the attributes of the ships such as arrival time ship length initial speed expected speed acceleration and deceleration are realized by applying a discrete event model based on the statistical distributions in section 3 2 the sequential update rules incorporating interactions among ships and navigation rules are used to simulate the operations of ships to reflect their motion behaviors in the simulations the speed location and time are the most important contributing elements for visualizations of ship movements so the movements of each ship navigating in the waterway are simulated in the time domain the speed and position of ships are updated minute by minute and the simulation procedure can be summarized as follows step 1 determine the simulation duration t the simulation time should be long enough in order to obtain much data to enable statistical analysis step 2 generate ships in the two portals of the waterway over the simulation period from time 0 to time t based on the results from statistical analysis of the historical ais data step 3 check whether there are ships entering the waterway at t i if so the ships would enter the waterway step 4 check all ships speed and location in the waterway at t i step 5 update the ships speed and location at t i 1 based on the update rules step 6 check whether there are ships leaving the waterway at t i 1 if so the simulation for these ships come to an end and the relevant data are stored for the analysis of traffic flow characteristics step 7 check whether t i 1 t if so the simulation terminates otherwise go to step 3 4 2 update rules for simulation model in order to analyze the characteristics of ship movements the update rules of ship traffic are made to be utilized into the simulation model considering the fact that the ships in this area navigate based on ship following rules it is assumed that the ships are navigating along the predefined routes from two directions in the simulation so the movement characteristics of ship traffic are mainly reflected by speed changes one of the most important reasons for speed changes is the interactions among ships to avoid collision ships are required to maintain a safe space with each other by adjusting their speed in real time in the xiazhimen waterway the speed change related to ship interactions is mainly caused by their preceding ships in the same direction based on collision avoidance rules and ship following rules the safe distance between two consecutive ships in the same direction in terms of the empirical ship domain model built before are set as follows 1 d i j s a f e min 5 5 l i 3 5 l j where l i and l j represent the length of the present and the preceding ship respectively the reason for this assumption is that the proposed domain model satisfies the safety criteria that neither of the ship domain should be violated in order to ensure that the distance between ships is larger than the safe distance in the simulation model the minimum initial distance between two consecutive ships is set as follows 2 d i j e n t r y s a f e d i j s a f e v i e n t r y δ t where v i entry represents the initial speed of ship i and δt is set to be 1 min according to the two findings in fig 5 the acceleration timing related to ship interactions are divided into two cases 1 when the distance to the preceding ship is large enough the ship would not be affected by its preceding ship so it can accelerate if its speed is smaller than its expected speed 2 when the distance to the preceding ship is not large enough the ship can accelerate only if its speed is less than that of its preceding ship let v i t be the speed of ship i at time t d i j t represents the distance between ship i and its preceding ship at time t v i max represents the expected speed a i represents the acceleration and d i max represents the distance threshold for accelerating which is set to be 10l l represents the length of present ship by referring to the statistical results in fig 5 see the red vertical line thus 1 if d i j t d i max and v i t v i max then v i t min v i t a i δt v i max 2 if d i j t d i max v i t v i max and v i t v j t then v i t min v i t a i δt min v i max v j t the deceleration timing related to ship interactions are determined based on the concept of arena mentioned before the arena refers to the initial distance with other ships when ship operators start to take actions to avoid an urgent situation which is known as the super domain that is to say when the distance between two ships is close to the arena it is the time for the ship to decelerate it should be noted that such deceleration occurs only when the speed of ship is larger than that of the ship ahead in the same direction in the waterway therefore taking into discount the ship s deceleration magnitude the safe distance to the preceding ship as well as the speed difference the super domain can be expressed as follows 3 d i j s a f e f a i d i j s a f e δ v i j where a i is the deceleration of ship i δv i j is the speed difference with its preceding ship more specifically according to the newton s laws of motion the equation is calculated as follows 4 d i j s a f e d i j s a f e v i t v j t 2 2 a i where v i t v j t a i represents the deceleration duration of ship i and v i t v j t 2 v i t v j t a i represents the reduced distance with the ship ahead during the deceleration process in order to maintain the required safe distance between ships when v i t v j t the deceleration conditions are set as follows 5 d i j t d i j s a f e v i t δ t it should be noted if d i j t d i j safe the safe distance cannot be guaranteed based on the original deceleration so the deceleration need to be adjusted as follows 6 a i 2 v i t v j t 2 2 d i j t d i j s a f e in addition the characteristics of ship movements are also affected by the transit rules for example since most ships will get on or off the pilots in the lower part of the waterway they are required to slow down to 8 9 knots for navigation safety when docking with the pilot boats in the simulation model a uniformly distributed random number between 8 and 9 which is expressed as v i p is generated to represent the speed of ships when docking with the pilot boats if the ship speed is larger than v i p then the deceleration timing for getting on or off the pilots is determined as follows 7 x i p x i t v i t v i p v i t v i p 2 a i v i t δ t where x i p is the position of ship i where to get on or off the pilots x i t is the position of ship i at time t according to the observation of the continuous ais speed records of the same ships sometimes their speed fluctuates irregularly and slightly which is not caused by the interactions among ships these small speed fluctuations are also considered in the simulation model the normal distribution with mean 0 and variance 0 1 knots is applied to generate a random value ε i to reflect the randomness and dynamics of speed fluctuations it should be mentioned that the interactions related to ship overtaking du et al 2018 wang and zou 2014 are not considered since the overtaking between ships seldom occurs in the waterway based on the above analysis the update rules are demonstrated below and ordered in terms of priorities a deceleration related to ship interactions if the ship speed is larger than that of its preceding ship and eq 5 is satisfied then v i t v i t a i δt or v i t v i t a i 2 δt b deceleration related to docking with the pilot boat if the ship speed is larger than its speed of docking with the pilot boat and its distance to the position for getting on or off the pilot complies with eq 7 then v i t v i t a i δt c deceleration related to speed limitation if the ship is approaching the xialan mountain area e g 1000 m ahead and its speed is larger than the speed limit 12 knots then v i t v i t a i δt d acceleration related to ship interactions if the above mentioned acceleration requirements are satisfied then v i t min v i t a i δt v i max or v i t min v i t a i δt min v i max v j t e small speed fluctuations unrelated to the interactions among ships if there are no active acceleration or deceleration actions taken by the ship the ship speed may still have small changes due to some other reasons let p denote the probability of small speed fluctuations p i denotes a random number that is uniformly distributed between 0 and 1 if p i p then v i t v i t ε i after all the above steps the speed and position of ship i at time t 1 are updated correspondingly which are v i t 1 v i t and x i t 1 x i t v i t 1 5 model validation and application 5 1 model validation the outputs of the proposed simulation model include the ships entry time departure time as well as the positions and speeds in a set of discrete time point minute by minute which are helpful to get the picture of ship movements in order to assess the performance of simulation model the proposed model is used to simulate the ship traffic with a period of one month with a set of 10 identical replications the ships average travel time is chosen as an indicator for comparisons with the results from ais data the real case travel time of each ship trajectory can be obtained by identifying the time they passed through the entrance and exit of the waterway the ships travel time in the simulation model can also be obtained by recording discrete time points the comparison results are presented in table 2 in general there is no significant difference between the two datasets because the relative errors for northbound ships and southbound ships are both less than 2 13 in addition the average speed at different segments along the waterway is selected as another indicator for further evaluation of the accuracy of the simulation model the results are presented in fig 8 it can be found that the values of speed from the simulation model are in general consistent with the real case the relative error at each segment in the two directions is smaller than 4 1 which can be considered acceptable it also should be noted that the values of average speed from the simulation model are larger than those derived from the ais data between 6 and 10 km in the waterway this indicates that the real motion behaviors of ships are more complicated and some other factors that may affect the ship speed are not considered in the simulation model but such factors also pose impact on the ship traffic it is worth noting that the speed changes along the waterway in fig 8 are mainly related to the actions of the ships docking with the pilot boats and the rules of ship speed limit for northbound ships they would get on the pilots near the entrance of the waterway thus their initial speeds are smaller after they passed the xialan mountain area 8 5 9 5 km they are no longer affected by speed limitation and some ships would navigate with a larger speed for southbound ships they would dock with the pilot boats between 2 and 4 km thus the average speed reaches the bottom in this area this phenomenon reflects that the simulation model works well in reflecting the fluctuations of the ship speed during navigating within the waterway 5 2 model applications with the proposed simulation model more investigations can be performed on ship traffic characteristics including assessing navigation risk and efficiency evaluating new operational proposals predicting channel capacity utilization and crowdedness among others as mentioned previously the number of traffic movements in the xiazhimen waterway has witnessed significant growth in the past few years due to the increase of transportation demand therefore it is meaningful to conduct efficiency and risk assessment for ship traffic in the waterway with increased traffic volumes accordingly the average passage time and the degree of deceleration due to ship interactions are considered as the indicators of efficiency and risk evaluation respectively note that the risk index adopted in this section refers to the ship collision risk indices presented in qu et al 2011 in which the assumption is made that higher degree of acceleration and deceleration indicates more frequent occurrence of scenarios with collision potentials in this study the degree of deceleration caused by the restrictions of preceding ships abbreviated as a is considered as the risk index since higher degree of deceleration implies that the ships need to slow down frequently to avoid collision with the preceding ships which may result in higher collision risk the risk index is expressed as follows 8 a i 1 n j 1 j i a i j 2 n where n is the number of ships j i is the number of deceleration records of ship i due to interactions among ships the tendencies of the two indicators are illustrated in fig 9 a and b the results indicate that the increased traffic volumes would bring a slight rise in average passage time and a significant rise in a respectively these are possibly due to the increase in traffic density increases the ships interactions which causes ships to slow down more frequently moreover with the same traffic volume the a of the southbound ships is much higher than that of the northbound ships this may be due to the fact that the speed of southbound ships decreased to a large degree when docking with the pilot boats which has apparent impact on subsequent ships on the contrary the initial speeds of northbound ships are small and they have less speed changes when docking with the pilot boats compared with the southbound ships as the increased traffic volumes would lead to fast growth of the a some new traffic management strategies may have to be implemented to control traffic risk beforehand by adjusting the parameters in the discrete event model the effectiveness of risk mitigation measures can be evaluated the measures mainly include ship entry control which has already been implemented in the istanbul strait uluscu et al 2009 as observed in fig 9 b the a with distinct traffic volumes for the northbound and southbound ships are between 0 11 and 0 23 and between 0 24 and 0 60 respectively accordingly the simulations are performed using the increased traffic volumes in which the minimum time interval between two consecutive ships entering the waterway is set to be 10 min fig 10 presents the results of ship entry control measure it can be found that the degrees of deceleration in the two directions are between 0 08 and 0 17 and between 0 15 and 0 31 respectively this implies that the ship entry control measure can effectively reduce the collision risk however this strategy can also increase the ships waiting time to a large degree and furthermore may pose impact on the ships berthing planning therefore it is necessary for the maritime and port authorities to make a trade off between risk and efficiency to identify whether the strategy is feasible another possible application is to estimate the relationship between the theoretical capacity of ship traffic and ship sizes in view of that the proportion of large scale ships is likely to increase in the future the theoretical capacity refers to the maximum number of ships passing through the channel per unit time which is associated with the ship mean speed and ship density according to the traffic flow theory fujii and tanaka 1971 the simulation model is capable of determining the speed density relation with different distributions of ship length therefore the estimation of theoretical capacity can be conducted based on this model it is assumed that the ships whose lengths are over 300 m are the large ships and p l is used to denote the proportion of the large ships the simulation results of speed density distributions when p l 0 p l 0 25 p l 0 50 p l 0 75 and p l 1 are illustrated in fig 11 according to the figure the higher ship density corresponds to the smaller average ship speed which indicates that the ship traffic follows a clear speed density relation namely ship following phenomenon therefore the classic greenshields stream model greenshields 1935 is applied to reveal the speed density relationship which is expressed as follows 9 v v f 1 k k j where v represents the average speed k represents the traffic density v f is the free flow speed k j is the jam density it should be noted that eq 9 can be easily transformed into linear function so the speed density model can be regressed by the least square approach the straight lines in fig 11 are the corresponding regression results with distinct proportion of large scale ships according to the regression results the theoretical capacity of ship traffic can be estimated the theoretical capacity when p l 0 p l 0 25 p l 0 50 p l 0 75 and p l 1 is 20 16 19 48 18 99 18 59 and 17 98 ship hour respectively that is to say the increase in proportion of large scale ships would result in a slow decline in theoretical capacity if we consider that the capacities of large ships are much larger than those of small ships the overall cargo throughput through the waterway may grow greatly but on the other hand if the proportion of large ships increases the interactions between small ships and large ships would be more complex as their navigation speeds are usually not identical moreover large ships usually have limited maneuverability which means that small ships would be assigned more obligation in collision avoidance by changing their speed than large ships that is to say the trade off between small and large ships should be considered and dealt with properly by considering the safety issues 6 conclusion and future work in this paper a simulation model for ship traffic in the xiazhimen waterway is proposed in order to facilitate a deeper insight into the characteristics of ship movements the ais data is first applied to investigate some statistical characteristics of ship traffic especially identifying the magnitude and timing of ships acceleration and deceleration then an empirical ship domain model is formulated to determine the safe distance between ships in the simulation model the update rules that incorporate the interactions among ships the empirical ship domain model and the transit rules in the waterway are further used to simulate the motion behaviors of ships under various navigational scenarios in order to test the performance of the proposed simulation model the ships passage time through the waterway and the average speed along the waterway are adopted as the indicators for comparisons with the real case data the results show that the simulation model works well in reflecting the ship movement characteristics in the waterway finally the capabilities of the proposed model on assessing navigational efficiency and risk on evaluating new operational strategies and on estimating the relationship between the theoretical channel capacity and ship sizes are demonstrated according to the results of ais data statistical analysis it can be seen that the ships acceleration and deceleration are usually less than 1 kn min which indicates that the speed variations per minute in some existing simulation models are not practicable it can also be found that the long axis of the elliptical ship domain is larger whereas the short axis is smaller compared with the traditional elliptical domains which is possibly because that the water area is a narrow waterway where ships tend to maintain a larger front to back spacing for safe navigation the simulation results further show that the increased traffic volumes would bring a slight rise in average passage time and a significant rise in the degree of deceleration the ship entry control measure can effectively reduce the collision risk even though it may increase the ships waiting time to a large degree in addition the simulation results also show that the ship traffic in the waterway follows a clear speed density relation and the increase in proportion of large scale ships would result in a slow decline in theoretical channel capacity it should be noted that some factors that also have impact on traffic efficiency and safety including the impacts of human factors and navigational environment are not fully considered in the proposed model due to their complex causation relationships one possible extension of the model can be incorporating human factors into the simulation for instance how long it would take for the waterway to return to normal condition given an accident occurs in the waterway moreover noting that the simulation results indicate that there should be a trade off between safety and efficiency it would be meaningful to study the scheduling optimization of waterway traffic in the future work acknowledgement the work of this paper was financially supported by the national nature science foundation of china grant no 51479157 national key technologies research development program 2017yfe0118000 the marie skłodowska curie grant agreement no 730888 reset and china postdoctoral science foundation 2016m592889xb 
22864,the xiazhimen waterway is regarded as the bottleneck of the shipping routes linking the ship traffic between the hub areas in ningbo zhoushan port and the outside waters in this paper a microcosmic simulation model for ship traffic in the waterway is developed to investigate the motion behaviours of ships to various navigational scenarios the simulation model is derived from the statistical analysis of ais data and takes the ships acceleration and deceleration into account by the extraction of ship traffic characteristics an empirical ship domain model is formulated to determine the safe distance between ships the update rules incorporating the ships interactions the empirical domain model as well as transit rules are designed to simulate the speed fluctuations of ships by comparing the real case with the simulation results in terms of the average passage time and the average speed along the waterway the performance of the model are further validated the model also facilitates the prediction of navigation risk and channel capacity with increased traffic volume and increased proportion of large size ships keywords xiazhimen waterway traffic simulation ais data analysis ship domain 1 introduction the xiazhimen waterway is a 12 km long and 1 km wide channel located in ningbo zhoushan port of zhejiang province china see fig 1 and the port area where the waterway is situated ranks the largest port in the world in terms of cargo throughput the waterway is also one of the most important and busiest shipping channels due to its excellent navigable conditions and plays a vital role in the international as well as domestic freight transportation linking the ship traffic between the hub areas in ningbo zhoushan port and the outside waters however the waterway narrows to only 500 m wide in the xialan mountain segment resulting in a big traffic bottleneck the traffic efficiency in the waterway is becoming an important issue that has to be dealt with properly moreover once ship collisions occur in such busy waters the consequences can be catastrophic especially for oil tankers and chemical lng lpg vlcc ships which may cause huge economic loss serious environmental pollution and fatalities therefore the operational efficiency and safety of vessels through the waterway have attracted many attentions from the zhejiang maritime bureau and other relevant stakeholders including port authorities ship owners as well as carriers many regulations for enhancing transportation efficiency and safety of vessels sailing in the waterway have been implemented over the past 10 years the traffic separation scheme tss and the mandatory ship reporting system have been brought into force and applied since aug 1st 2010 the traffic in opposite directions was separated by the establishment of traffic lanes however the marine traffic is increasing over the years in the waterway due to the continuous growth of transportation demand the increase of traffic flow would lead to high traffic density and pose more risks accordingly the existing maritime traffic control strategies may be not enough to maintain the navigational efficiency and safety at a high level to improve the navigational efficiency and safety of such narrow and busy waterway it is a pre requisite to have a deep insight into the characteristics of ship movements which can facilitate the maritime authorities to make and evaluate new operational strategies the conventional feature analysis of ship movements in narrow waterways is usually conducted based on ship traffic surveys such as observations radar monitoring as well as airborne photography fujii and tanaka 1971 however such traffic surveys are sometimes difficult due to the large time and resource consumption yamaguchi and sakaki 1971 moreover it is not possible to obtain the picture of ship movements by utilizing the above mentioned methods when taking into account the continuous growth of traffic volume in the future one possible alternative to overcome the above challenge is to build a simulation model for ship traffic to investigate the motion behaviors of ships with distinct traffic flow in the waterway automatic identification system ais has been identified as a very useful data source reflecting the ship traffic characteristics following this idea extensive statistical analysis on ais data is performed in this paper in view of its high reliability of ship traffic information and its promising value in identifying the ship traffic characteristics the statistical results are further used in the ship traffic simulation to get the picture of ship movements in the waterway this study aims to develop a simulation model for ship traffic in the xiazhimen waterway to describe the ship movement characteristics more precisely the contributions of this study are threefold first it initiates research into investigating some statistical distributions of ship traffic based on ais data analysis especially identifying the ships acceleration and deceleration behaviors it is found that the acceleration and deceleration of ships derived from the ais data are much smaller than the speed variation in existing simulation models further investigations are performed to identify the timing that ships take collision avoidance actions when they are interacting with each other in terms of the newton s laws of motion second an empirical ship domain model is formulated by visualizing the distances between all ships with a special intensity plot which can determine the safe distance between ships more accurately and be embedded into the ship traffic simulation model third the update rules which take into account the ships interactions the empirical domain model as well as transit rules are designed to simulate the fluctuations of ship speed in the waterway meanwhile with the designed simulation model the tendencies of navigation efficiency and risk indices of ship movements in the waterway along with the increased traffic volumes are estimated the new operational proposals and theoretical channel capacity are also evaluated and predicted based on the proposed model respectively the rest of the paper is organized as follow section 2 reviews the existing studies conducted on ais data analysis and applications as well as the research related to ship traffic simulation in section 3 the research methodology and analysis of ship traffic based on ais data are described including data pre processing statistical characteristics of ship traffic and an empirical ship domain model section 4 presents the procedure and the update rules for the simulation model the validation and application of the proposed model are demonstrated in section 5 conclusions and the future research are summarized in section 6 2 literature review many research works have been conducted on ais data analysis from different perspectives or objectives which mainly include ship traffic statistics meng et al 2014 wu et al 2016 geographical visualization willems et al 2009 ship traffic pattern recognition aarsæther and moan 2009 silveira et al 2013 ship domain calculation and shaping hansen et al 2013 as well as ship conflicts extraction chai et al 2017 weng et al 2012 for example xiao et al 2015 performed ais data analysis to explore the spatial and temporal distributions of ship traffic tsou 2010 investigated the visualization features of ship trajectory and density by applying data mining technique to the analysis of ais data weng et al 2012 estimated the number of vessel conflicts using ais data in the singapore strait to identify the most risky area wang and chin 2016 developed an empirical dynamic ship domain model based on vessel movement data in singapore port and singapore strait for risk assessment these studies motivated a deeper understanding on the ship traffic characteristics and are meaningful for improving the performances of ship traffic simulation regarding to simulation models a series of studies have been conducted and applied for navigational safety and risk management in different waters köse et al 2003 merrick et al 2005 uluscu and altiok 2009 van dorp and merrick 2011 van dorp et al 2001 to list some ince and topuz 2004 proposed a safe navigation simulation model by combining with a hydrographic prediction model to prevent marine causalities in different waterways yeo et al 2007 proposed the awe sim simulation program for the evaluation of the port traffic congestion at north harbor in busan in the year of 2011 szpak and tapamo 2011 utilized a background subtraction model to address the tracking of moving vessels in water areas mavrakis and kontinakis 2008 proposed a queueing model of maritime traffic in bosporus straits incorporating the physical characteristics of the waterway as well as the maritime regulations it should be noted that the ship movement characteristics and the interactions among ships are not fully considered in the above mentioned simulation models in dealing with the interactions among ships the cellular automaton ca approach has been applied to simulation models of ship movements which is widely used in the study of vehicle traffic flow due to its simplicity and high computational efficiency biham et al 1992 kerner et al 2002 nagel and schreckenberg 1992 for example sun et al 2015 proposed a two lane cellular automata model named si stca to investigate the traffic flow patterns when overtaking occurs qu and meng 2012 developed a ca based ship movement model in which the velocities of vessels were divided into two directions as well as the effects of captain behaviors and the navigational rules were taken into account to illustrate the pictures of traffic movements in the singapore strait qi et al 2017a proposed a novel ca model called the spatial logical mapping slm to address the ship pseudo lane change issue in these models issues like the interactions among ships in narrow and busy shipping channels the behaviors of ship captains and pilots and the movement characteristics of ships with different categories and sizes etc have been considered however the acceleration and deceleration magnitude of ships were not systematically taken into account or the acceleration and deceleration are set too large in these simulation models which is not realistic in many applications these problems may give rise to biased or inaccurate results as the negligence of the acceleration and deceleration magnitude of ships would affect the timing that ships take collision avoidance actions when the ship interactions occur in the simulation models regarding to such problems a ship traffic simulation model is developed for the xiazhimen waterway incorporating the acceleration and deceleration magnitude of ships as well as an empirical ship domain model the model was constructed on the basis of the analysis of ais data from the xiazhimen waterway 3 ais data analysis 3 1 data collection and pre processing a period of 12 day s aug 14 25 2016 ais data with a collection of 444 276 records in the xiazhimen waterway was collected the ais data mainly consists of the following information mmsi maritime mobile service identity number time coordinate position longitude and latitude course and speed as well as ship length to extract useful and relevant information some vessels whose voyage trajectories are irregular were excluded these vessels mainly include tug boats pilot boat police patrols and fishing vessels which may not follow the conventional trajectories due to their special missions due to the loss and or errors and or other reasons during data collection transmission and reception the ais data usually includes some errors noises which would affect the ship traffic statistics and analysis therefore it is necessary to ensure the reliability of the ais data to remove some errors in ais data such as the messy codes and data irrationalities a tangible error elimination method proposed by kang et al 2018 is employed to check ship id errors to eliminate ship position errors and to remove ship speed errors then the data cleaning procedure presented in qu et al 2011 is adopted to update those inaccurate records instead of eliminating them so as to keep the integrality of the real time data this procedure is based on the newton s laws of motion and can identify whether the variations of speed and position of each record are within the reasonable range in addition the analysis of ship interactions requires that the ship movements timestamps are synchronous so a linear interpolation method proposed by zhang et al 2015 is applied for data synchronization with a predefined time interval the details of the ais data cleaning and interpolating algorithm are presented in appendix a in zhang et al 2017a which are available for reference 3 2 data statistics and analysis 3 2 1 ship traffic characteristics an extensive analysis of ais data is conducted in this section to obtain the input parameters for the traffic simulation including distribution statistics of ship traffic and analysis of ships acceleration and deceleration characteristics the statistics of ship traffic are performed according to the following aspects the distribution of ships arriving fig 2 ship speed fig 3 and ship length table 1 the results are used for the ship generation from the two directions of the xiazhimen waterway in the simulation model fig 2 demonstrates the number of ships arriving per hour throughout the day a significant fluctuation can be found in the number of ships arriving at each hour during the day according to the related studies the distributions of ship arrivals are usually assumed to follow a stationary poisson process przywarty 2008 however this is no longer suitable for this case because the number of ships arriving is fluctuating during different hours of the day as a result the distributions of ships arriving are modeled as a non stationary poisson process in the following simulations goerlandt and kujala 2011 the process is associated with time dependent arrival rate in which its intensity function λ t is fluctuating with time fig 3 a and b present the distributions of ships initial speed in the two portals of the waterway it can be seen that normal and weibull distribution curves fit these histograms well besides due to the fact that the ships need to slow down in the lower part of the waterway to get on or off the pilots the northbound ships initial speed is usually less than their expected speed therefore the distributions of the difference between expected speed of each trajectory and its initial speed are analyzed which are shown in fig 3 c and d the expected speed values are determined by calculating the mean speed of each trajectory in the upper part of the waterway it can be found the mean in fig 3 c is 1 98 knots meaning that most of northbound ships will speed up after transiting the lower part of the waterway there is no significate distinction between the southbound ships expected speed and their initial speed since the mean in fig 3 d is close to 0 the distributions of ship length in the two directions are presented in table 1 in addition the acceleration and deceleration characteristics of ship traffic are explored to reveal the motion behaviors of ships and to further determine the timing that ships take collision avoidance actions when they are interacting with each other fig 4 depicts the distributions of average acceleration and deceleration of each ship respectively it can be found that gamma curves fit these histograms well it should be noted that the trajectory points with acceleration or deceleration smaller than 0 1 kn min are excluded in the process of statistics this is due to that the main purpose of statistics is to determine the acceleration and deceleration magnitude when ship navigators take the initiative to slow down or speed up so they can be used in the simulation to illustrate the interactions among ships in the statistical process it can be found that the speed of each ship s trajectory has always been fluctuating and there are too many small irregular fluctuations which is not related to the ship navigators active actions if these small fluctuations are involved in the results the ship s acceleration and deceleration will be reduced therefore these small speed fluctuations were not considered in the statistical results the results show that the acceleration and deceleration are mainly between 0 1 and 0 9 kn min which are much smaller than the speed variation per minute in some existing simulation models qi et al 2017a qu and meng 2012 sun et al 2015 this finding signifies that the parameter settings on speed fluctuations in these models are not completely reasonable and the acceleration and deceleration magnitude are not considered in detail in the ship movement simulation models in this paper the acceleration and deceleration of each ship are supposed to follow gamma distributions within a range of 0 1 0 9 kn min in the simulations to describe the ship movement characteristics more reasonably it should be noted that there is little overtaking in the xiazhimen waterway and overtaking in the upper part of the channel is prohibited according to the interviews to safety managers in zhejiang maritime bureau therefore the ships transit this waterway based on ship following rules and their navigational behaviors are mainly influenced by their preceding ships qi et al 2017a 2017b considering this the distance and speed difference the speed of the ship ahead minus own speed with the ship ahead when the ship starts to accelerate are extracted from ais data see fig 5 two interesting findings can be found in this figure first a lot of ships would speed up if their speed is less than that of their preceding ships and the distances with their preceding ships are not necessary to be too large second when the ship speed is greater than that of the ship ahead it will speed up only if the distance to its preceding ship is large enough most of which are larger than 10l l is the length of present ship these two findings will be involved in determining whether the ship would accelerate during navigating in the simulation model the deceleration timing of ships is determined by combining the concept of arena proposed by davis et al 1980 with the ships deceleration magnitude and the safe distance between ships which will be analyzed in section 4 2 3 2 2 ship domain model ship safety domain is a generalization of a safe space around a ship for collision avoidance with respect to other ships or stationary obstacles since the concept was first introduced in fujii and tanaka 1971 numerous ship domain models were developed for applications on collision avoidance szlapczynski and szlapczynska 2017a 2015 near miss detection iperen 2015 waterway risk analysis qu et al 2011 and channel capacity analysis zhang et al 2017b the methods of determining these domain models can be roughly divided into four groups empirical knowledge based safety analysis based and combinations of them dinh and im 2016 liu et al 2016 pietrzykowski 2008 wang 2013 wang and chin 2016 in this section an empirical method based on ais data proposed by hansen et al 2013 is applied to design the ship domain model in the xiazhimen waterway since it enables observing the minimum distance between ships when passing each other in different directions the model is subsequently used in the simulation model to determine the safe distance between ships the idea of this method is to visualize the distances between all ships in this area with a special intensity plot and the color intensity in the plot reflects the distribution of other ships around the own ship the outline of the algorithm for determining the intensity plot of ais data are presented in fig 6 fig 7 demonstrates the intensity of ais data in the xiazhimen waterway together with the elliptical ship domain model the regions with larger intensity index of colors represent that there are more amount of timestamps in these grids the intensity plot is discretized into grids of 0 2 0 2 of the ship length covering an area with a length of 24l l represents the length of ship and a breadth of 12l it can be seen that the intensity of the port side is higher than that of the starboard which is in line with the real situation that ships are navigating on the right side of the waterway according to the tss and there are no other ships to their starboard in most cases to determine the size of the ship domain an ellipse is used to describe the safe distance between ships in terms of the colors in the intensity plot the results indicate that the ellipse have a length of 9l and a breadth of 2 4l more exactly the ship domain is an ellipse with a length of 5 5l in front of the ship and 3 5l behind the ship that is the ship position is moved from the ellipse s center towards aft by 1l this finding indicates that ship navigators will pay more attention to the ships in front compared to the ships behind in addition the long axis of the elliptical domain is larger whereas the short axis is smaller compared with the traditional elliptical domains coldwell 1983 fujii and tanaka 1971 this may be due to the fact that the water area is a typical narrow waterway where overtaking between ships is almost impossible thus the consecutive ships tend to maintain a larger front to back spacing for safe navigation moreover the elliptical domain determined in this section complies with the 3rd definition of ship domain in szlapczynski and szlapczynska 2017b where neither of the ship domains should be violated therefore unlike the domain models in rawson et al 2014 wang and chin 2016 the overlapping domains are allowed based on the proposed model as long as the ships do not invade each other s domain 4 simulation model 4 1 the procedure a ship movement model mainly includes two parts generating the ships entering the waterway and running the ships in the waterway the generations of the ships including the attributes of the ships such as arrival time ship length initial speed expected speed acceleration and deceleration are realized by applying a discrete event model based on the statistical distributions in section 3 2 the sequential update rules incorporating interactions among ships and navigation rules are used to simulate the operations of ships to reflect their motion behaviors in the simulations the speed location and time are the most important contributing elements for visualizations of ship movements so the movements of each ship navigating in the waterway are simulated in the time domain the speed and position of ships are updated minute by minute and the simulation procedure can be summarized as follows step 1 determine the simulation duration t the simulation time should be long enough in order to obtain much data to enable statistical analysis step 2 generate ships in the two portals of the waterway over the simulation period from time 0 to time t based on the results from statistical analysis of the historical ais data step 3 check whether there are ships entering the waterway at t i if so the ships would enter the waterway step 4 check all ships speed and location in the waterway at t i step 5 update the ships speed and location at t i 1 based on the update rules step 6 check whether there are ships leaving the waterway at t i 1 if so the simulation for these ships come to an end and the relevant data are stored for the analysis of traffic flow characteristics step 7 check whether t i 1 t if so the simulation terminates otherwise go to step 3 4 2 update rules for simulation model in order to analyze the characteristics of ship movements the update rules of ship traffic are made to be utilized into the simulation model considering the fact that the ships in this area navigate based on ship following rules it is assumed that the ships are navigating along the predefined routes from two directions in the simulation so the movement characteristics of ship traffic are mainly reflected by speed changes one of the most important reasons for speed changes is the interactions among ships to avoid collision ships are required to maintain a safe space with each other by adjusting their speed in real time in the xiazhimen waterway the speed change related to ship interactions is mainly caused by their preceding ships in the same direction based on collision avoidance rules and ship following rules the safe distance between two consecutive ships in the same direction in terms of the empirical ship domain model built before are set as follows 1 d i j s a f e min 5 5 l i 3 5 l j where l i and l j represent the length of the present and the preceding ship respectively the reason for this assumption is that the proposed domain model satisfies the safety criteria that neither of the ship domain should be violated in order to ensure that the distance between ships is larger than the safe distance in the simulation model the minimum initial distance between two consecutive ships is set as follows 2 d i j e n t r y s a f e d i j s a f e v i e n t r y δ t where v i entry represents the initial speed of ship i and δt is set to be 1 min according to the two findings in fig 5 the acceleration timing related to ship interactions are divided into two cases 1 when the distance to the preceding ship is large enough the ship would not be affected by its preceding ship so it can accelerate if its speed is smaller than its expected speed 2 when the distance to the preceding ship is not large enough the ship can accelerate only if its speed is less than that of its preceding ship let v i t be the speed of ship i at time t d i j t represents the distance between ship i and its preceding ship at time t v i max represents the expected speed a i represents the acceleration and d i max represents the distance threshold for accelerating which is set to be 10l l represents the length of present ship by referring to the statistical results in fig 5 see the red vertical line thus 1 if d i j t d i max and v i t v i max then v i t min v i t a i δt v i max 2 if d i j t d i max v i t v i max and v i t v j t then v i t min v i t a i δt min v i max v j t the deceleration timing related to ship interactions are determined based on the concept of arena mentioned before the arena refers to the initial distance with other ships when ship operators start to take actions to avoid an urgent situation which is known as the super domain that is to say when the distance between two ships is close to the arena it is the time for the ship to decelerate it should be noted that such deceleration occurs only when the speed of ship is larger than that of the ship ahead in the same direction in the waterway therefore taking into discount the ship s deceleration magnitude the safe distance to the preceding ship as well as the speed difference the super domain can be expressed as follows 3 d i j s a f e f a i d i j s a f e δ v i j where a i is the deceleration of ship i δv i j is the speed difference with its preceding ship more specifically according to the newton s laws of motion the equation is calculated as follows 4 d i j s a f e d i j s a f e v i t v j t 2 2 a i where v i t v j t a i represents the deceleration duration of ship i and v i t v j t 2 v i t v j t a i represents the reduced distance with the ship ahead during the deceleration process in order to maintain the required safe distance between ships when v i t v j t the deceleration conditions are set as follows 5 d i j t d i j s a f e v i t δ t it should be noted if d i j t d i j safe the safe distance cannot be guaranteed based on the original deceleration so the deceleration need to be adjusted as follows 6 a i 2 v i t v j t 2 2 d i j t d i j s a f e in addition the characteristics of ship movements are also affected by the transit rules for example since most ships will get on or off the pilots in the lower part of the waterway they are required to slow down to 8 9 knots for navigation safety when docking with the pilot boats in the simulation model a uniformly distributed random number between 8 and 9 which is expressed as v i p is generated to represent the speed of ships when docking with the pilot boats if the ship speed is larger than v i p then the deceleration timing for getting on or off the pilots is determined as follows 7 x i p x i t v i t v i p v i t v i p 2 a i v i t δ t where x i p is the position of ship i where to get on or off the pilots x i t is the position of ship i at time t according to the observation of the continuous ais speed records of the same ships sometimes their speed fluctuates irregularly and slightly which is not caused by the interactions among ships these small speed fluctuations are also considered in the simulation model the normal distribution with mean 0 and variance 0 1 knots is applied to generate a random value ε i to reflect the randomness and dynamics of speed fluctuations it should be mentioned that the interactions related to ship overtaking du et al 2018 wang and zou 2014 are not considered since the overtaking between ships seldom occurs in the waterway based on the above analysis the update rules are demonstrated below and ordered in terms of priorities a deceleration related to ship interactions if the ship speed is larger than that of its preceding ship and eq 5 is satisfied then v i t v i t a i δt or v i t v i t a i 2 δt b deceleration related to docking with the pilot boat if the ship speed is larger than its speed of docking with the pilot boat and its distance to the position for getting on or off the pilot complies with eq 7 then v i t v i t a i δt c deceleration related to speed limitation if the ship is approaching the xialan mountain area e g 1000 m ahead and its speed is larger than the speed limit 12 knots then v i t v i t a i δt d acceleration related to ship interactions if the above mentioned acceleration requirements are satisfied then v i t min v i t a i δt v i max or v i t min v i t a i δt min v i max v j t e small speed fluctuations unrelated to the interactions among ships if there are no active acceleration or deceleration actions taken by the ship the ship speed may still have small changes due to some other reasons let p denote the probability of small speed fluctuations p i denotes a random number that is uniformly distributed between 0 and 1 if p i p then v i t v i t ε i after all the above steps the speed and position of ship i at time t 1 are updated correspondingly which are v i t 1 v i t and x i t 1 x i t v i t 1 5 model validation and application 5 1 model validation the outputs of the proposed simulation model include the ships entry time departure time as well as the positions and speeds in a set of discrete time point minute by minute which are helpful to get the picture of ship movements in order to assess the performance of simulation model the proposed model is used to simulate the ship traffic with a period of one month with a set of 10 identical replications the ships average travel time is chosen as an indicator for comparisons with the results from ais data the real case travel time of each ship trajectory can be obtained by identifying the time they passed through the entrance and exit of the waterway the ships travel time in the simulation model can also be obtained by recording discrete time points the comparison results are presented in table 2 in general there is no significant difference between the two datasets because the relative errors for northbound ships and southbound ships are both less than 2 13 in addition the average speed at different segments along the waterway is selected as another indicator for further evaluation of the accuracy of the simulation model the results are presented in fig 8 it can be found that the values of speed from the simulation model are in general consistent with the real case the relative error at each segment in the two directions is smaller than 4 1 which can be considered acceptable it also should be noted that the values of average speed from the simulation model are larger than those derived from the ais data between 6 and 10 km in the waterway this indicates that the real motion behaviors of ships are more complicated and some other factors that may affect the ship speed are not considered in the simulation model but such factors also pose impact on the ship traffic it is worth noting that the speed changes along the waterway in fig 8 are mainly related to the actions of the ships docking with the pilot boats and the rules of ship speed limit for northbound ships they would get on the pilots near the entrance of the waterway thus their initial speeds are smaller after they passed the xialan mountain area 8 5 9 5 km they are no longer affected by speed limitation and some ships would navigate with a larger speed for southbound ships they would dock with the pilot boats between 2 and 4 km thus the average speed reaches the bottom in this area this phenomenon reflects that the simulation model works well in reflecting the fluctuations of the ship speed during navigating within the waterway 5 2 model applications with the proposed simulation model more investigations can be performed on ship traffic characteristics including assessing navigation risk and efficiency evaluating new operational proposals predicting channel capacity utilization and crowdedness among others as mentioned previously the number of traffic movements in the xiazhimen waterway has witnessed significant growth in the past few years due to the increase of transportation demand therefore it is meaningful to conduct efficiency and risk assessment for ship traffic in the waterway with increased traffic volumes accordingly the average passage time and the degree of deceleration due to ship interactions are considered as the indicators of efficiency and risk evaluation respectively note that the risk index adopted in this section refers to the ship collision risk indices presented in qu et al 2011 in which the assumption is made that higher degree of acceleration and deceleration indicates more frequent occurrence of scenarios with collision potentials in this study the degree of deceleration caused by the restrictions of preceding ships abbreviated as a is considered as the risk index since higher degree of deceleration implies that the ships need to slow down frequently to avoid collision with the preceding ships which may result in higher collision risk the risk index is expressed as follows 8 a i 1 n j 1 j i a i j 2 n where n is the number of ships j i is the number of deceleration records of ship i due to interactions among ships the tendencies of the two indicators are illustrated in fig 9 a and b the results indicate that the increased traffic volumes would bring a slight rise in average passage time and a significant rise in a respectively these are possibly due to the increase in traffic density increases the ships interactions which causes ships to slow down more frequently moreover with the same traffic volume the a of the southbound ships is much higher than that of the northbound ships this may be due to the fact that the speed of southbound ships decreased to a large degree when docking with the pilot boats which has apparent impact on subsequent ships on the contrary the initial speeds of northbound ships are small and they have less speed changes when docking with the pilot boats compared with the southbound ships as the increased traffic volumes would lead to fast growth of the a some new traffic management strategies may have to be implemented to control traffic risk beforehand by adjusting the parameters in the discrete event model the effectiveness of risk mitigation measures can be evaluated the measures mainly include ship entry control which has already been implemented in the istanbul strait uluscu et al 2009 as observed in fig 9 b the a with distinct traffic volumes for the northbound and southbound ships are between 0 11 and 0 23 and between 0 24 and 0 60 respectively accordingly the simulations are performed using the increased traffic volumes in which the minimum time interval between two consecutive ships entering the waterway is set to be 10 min fig 10 presents the results of ship entry control measure it can be found that the degrees of deceleration in the two directions are between 0 08 and 0 17 and between 0 15 and 0 31 respectively this implies that the ship entry control measure can effectively reduce the collision risk however this strategy can also increase the ships waiting time to a large degree and furthermore may pose impact on the ships berthing planning therefore it is necessary for the maritime and port authorities to make a trade off between risk and efficiency to identify whether the strategy is feasible another possible application is to estimate the relationship between the theoretical capacity of ship traffic and ship sizes in view of that the proportion of large scale ships is likely to increase in the future the theoretical capacity refers to the maximum number of ships passing through the channel per unit time which is associated with the ship mean speed and ship density according to the traffic flow theory fujii and tanaka 1971 the simulation model is capable of determining the speed density relation with different distributions of ship length therefore the estimation of theoretical capacity can be conducted based on this model it is assumed that the ships whose lengths are over 300 m are the large ships and p l is used to denote the proportion of the large ships the simulation results of speed density distributions when p l 0 p l 0 25 p l 0 50 p l 0 75 and p l 1 are illustrated in fig 11 according to the figure the higher ship density corresponds to the smaller average ship speed which indicates that the ship traffic follows a clear speed density relation namely ship following phenomenon therefore the classic greenshields stream model greenshields 1935 is applied to reveal the speed density relationship which is expressed as follows 9 v v f 1 k k j where v represents the average speed k represents the traffic density v f is the free flow speed k j is the jam density it should be noted that eq 9 can be easily transformed into linear function so the speed density model can be regressed by the least square approach the straight lines in fig 11 are the corresponding regression results with distinct proportion of large scale ships according to the regression results the theoretical capacity of ship traffic can be estimated the theoretical capacity when p l 0 p l 0 25 p l 0 50 p l 0 75 and p l 1 is 20 16 19 48 18 99 18 59 and 17 98 ship hour respectively that is to say the increase in proportion of large scale ships would result in a slow decline in theoretical capacity if we consider that the capacities of large ships are much larger than those of small ships the overall cargo throughput through the waterway may grow greatly but on the other hand if the proportion of large ships increases the interactions between small ships and large ships would be more complex as their navigation speeds are usually not identical moreover large ships usually have limited maneuverability which means that small ships would be assigned more obligation in collision avoidance by changing their speed than large ships that is to say the trade off between small and large ships should be considered and dealt with properly by considering the safety issues 6 conclusion and future work in this paper a simulation model for ship traffic in the xiazhimen waterway is proposed in order to facilitate a deeper insight into the characteristics of ship movements the ais data is first applied to investigate some statistical characteristics of ship traffic especially identifying the magnitude and timing of ships acceleration and deceleration then an empirical ship domain model is formulated to determine the safe distance between ships in the simulation model the update rules that incorporate the interactions among ships the empirical ship domain model and the transit rules in the waterway are further used to simulate the motion behaviors of ships under various navigational scenarios in order to test the performance of the proposed simulation model the ships passage time through the waterway and the average speed along the waterway are adopted as the indicators for comparisons with the real case data the results show that the simulation model works well in reflecting the ship movement characteristics in the waterway finally the capabilities of the proposed model on assessing navigational efficiency and risk on evaluating new operational strategies and on estimating the relationship between the theoretical channel capacity and ship sizes are demonstrated according to the results of ais data statistical analysis it can be seen that the ships acceleration and deceleration are usually less than 1 kn min which indicates that the speed variations per minute in some existing simulation models are not practicable it can also be found that the long axis of the elliptical ship domain is larger whereas the short axis is smaller compared with the traditional elliptical domains which is possibly because that the water area is a narrow waterway where ships tend to maintain a larger front to back spacing for safe navigation the simulation results further show that the increased traffic volumes would bring a slight rise in average passage time and a significant rise in the degree of deceleration the ship entry control measure can effectively reduce the collision risk even though it may increase the ships waiting time to a large degree in addition the simulation results also show that the ship traffic in the waterway follows a clear speed density relation and the increase in proportion of large scale ships would result in a slow decline in theoretical channel capacity it should be noted that some factors that also have impact on traffic efficiency and safety including the impacts of human factors and navigational environment are not fully considered in the proposed model due to their complex causation relationships one possible extension of the model can be incorporating human factors into the simulation for instance how long it would take for the waterway to return to normal condition given an accident occurs in the waterway moreover noting that the simulation results indicate that there should be a trade off between safety and efficiency it would be meaningful to study the scheduling optimization of waterway traffic in the future work acknowledgement the work of this paper was financially supported by the national nature science foundation of china grant no 51479157 national key technologies research development program 2017yfe0118000 the marie skłodowska curie grant agreement no 730888 reset and china postdoctoral science foundation 2016m592889xb 
