index,text
22060,extreme weather conditions put heavy environmental loads on systems and may cause catastrophic failure classification societies such as lloyd s register dnv gl and the american bureau of shipping recommend methods for environmental load calculations these methods do not consider dependencies among parameters when calculating environmental loads this paper proposes a novel methodology to consider the copula based bivariate failure function to evaluate the dependence structure of parameters and minimize uncertainty in load calculations it also presents a robust operational failure assessment model that considers real time environmental parameters along with their dependencies the proposed methodology and models are tested on a semi submersible mobile unit smu the failure probability corresponding to the wind and wave loads imposed on the smu is calculated using a physical reliability model and bayesian network the copula based bivariate failure function defines the dependence using the parameters δ which are estimated using maximum likelihood estimation a detailed case study illustrates the advantage of the proposed methodology the proposed method is of vital significance to developing a safe operating envelope for offshore assets likely to face extreme weather conditions keywords operational failure environmental loads dependence copula function maximum likelihood estimation 1 introduction hurricanes have become more frequent in the past few decades in the 2005 atlantic hurricane season for example the number of hurricanes recorded that year 15 broke the annual record set in 1969 beven et al 2007 the property damage and economic losses that result from the landfall of hurricanes have also become more severe for example hurricane katrina destroyed 44 offshore platforms cruz and krausmann 2008 and shut down many of the oil and gas production facilities located in the gulf of mexico hence research on environmental loads and their impact on the failure of systems is of great importance to avoiding personal injury and property loss classification societies suggest employing standards to calculate environmental loads such as those used by dnv gl dnvgl rp c205 2017 and the american bureau of shipping abs american bureau of shipping abs 2019 these standards provide effective and accurate results are widely applied and have been proven to be effective in numerous engineering practices suja thauvin et al 2018 used dnv gl standards to develop a hydrodynamic load model that analyzes the mode response of a monopile offshore wind turbine caille et al 2017 adopted and validated a hydrodynamics model based on dnv gl methods for a tension leg platform tlp with inclined legs flis 2016 applied the provisions of the abs and calculated the environmental loads for cooling skid units li et al 2018 calculated wave loads in accordance with the abs rules of a 7th generation semi submersible drilling unit csdu to optimize its structural configuration however the assessment of the dependencies among the parameters to calculate environmental loads is lacking in the case of actual operation these weather parameters have a certain interaction relationship particularly in harsh environments this paper examines whether it underestimates or overestimates the impact on the failure of the system in regard to dependence construction the copula function is an emerging model due to the complex interactions that occur in nature the linear correlation coefficient lacks the ability to ascertain the dependence among real time environmental parameters the copulas overcome this limitation through the capacity to model any dependence structures and they have been widely used in the field of financial investment portfolio construction and so on durante and sempi 2015 recently scholars have applied the copula function to system safety and reliability assessments jia et al 2018 zhang and wilson 2017 hashemi et al 2015 guo et al 2019 shen et al 2016 hashemi et al 2015 proposed a multivariate loss function that combined the marginal loss functions with copulas for process facilities risk analysis guo et al 2019 conducted a copula based bayesian network cbbn model to analyze the process system that addressed the limitations of non linear dependence structures shen et al 2016 developed a mixed copula function to acquire the dependence details among failure modes to analyze the reliability of a gear door lock system here the copula function is considered to propose an innovative operational failure assessment model because of its flexibility this work calculates environmental loads using real time weather data and estimates the operational failure probability of the system the dependence structure between the real time environmental parameters is described with copula functions the dependence parameters δ of the candidate copula models are estimated using maximum likelihood estimation then the akaike s information criterion aic differences and akaike weight are used to select the best copula model to depict the dependence structure between the parameters to calculate the environmental loads the comparison results of the case study demonstrate the flexibility and significance of the proposed model the structure of this paper is described as follows section 2 explains the procedure of the proposed real time environmental load and its impact considering the dependence model with a simple illustrative example then section 3 applies the proposed model to a typical semi submersible mobile unit smu as a case study to demonstrate its general applicability the results of the copula based bivariate failure function and independent load failure function are compared and discussed in section 4 the main findings of the study are summarized in section 5 2 the proposed methodology the practical applicability of operational failure assessment with real time weather observation is highlighted using a copula based dependence function the copula function defines the dependence between the parameters to calculate environmental loads in this paper fig 1 shows the details of the proposed methodology the steps of the proposed methodology are explained with a simple example 2 1 step 1 real time weather observation as the basis of the proposed model the first step is to gain access to real time weather data the environmental loads calculated in this paper are wind loads and wave loads therefore 500 sets of wave data and concurrent meteorological observation data were obtained from wave data available online from the department of fisheries and oceans canada dfo department of fisheries and oceans canada dfo 2019 fig 2 plots an example with wind speed and wave height 2 2 step 2 environmental load calculation once the real time weather data are obtained the environmental loads are calculated with the corresponding model it is suggested from dnvgl rp c205 dnvgl rp c205 2017 that the wind and wave induced loads are estimated from the wind load modeling and morison wave load model respectively table 1 shows the physical characteristics of the sample object as revealed in fig 3 the sample object is used to demonstrate the proposed methodology the sample object consists of a pontoon and a column the pontoon provides flotation to the system and supports other functional structure components which are simplified as a column on the top of it to further evaluate the impact of the environmental loads on the failure of the system each structural component is divided into several sections that form the root causes of the bayesian network bn the sections for the column are trisected according to the height as presented in fig 3 similarly generated sections 1 2 and 3 of the pontoon are divided by the length 2 3 step 3 define dependence calculated using data in step 1 along this line of consideration the procedure followed is the dependence assessment the copula was first proposed by sklar 1959 in 1959 and is known as the theorem of sklar it has been shown that copula is a robust tool for assessing the dependence among random variables by establishing the joint distribution because it is a marginal distribution free model it is capable of capturing the dependence directly from the sample data in other words copula based dependence assessment allows the combination of a variety of types of d dimensional marginal distributions here the bivariate case is used to analyze the dependence structure between wind speed and wave height which are the dominant parameters used to calculate the wind loads and wave loads respectively 1 f x 1 x 2 c f 1 x 1 f 2 x 2 the joint distribution function is expressed in equation 1 two random variables are represented as x 1 and x 2 then the copula function c is written in equation 2 2 c μ 1 μ 2 f f 1 1 μ 1 f 2 1 μ 2 μ 1 μ 2 c x y d x d y where c x y is the density of the copula compared with implicit copulas such as gaussian copula archimedean copula family nelsen 2006 are defined as explicit copulas with simple closed forms this makes them suitable for low dimensional joint distribution three examples of archimedean copulas melo et al 2008 are the clayton copula the frank copula and the gumbel copula 3 c c l a y t o n μ 1 μ 2 μ 1 δ μ 2 δ 1 1 δ where δ 1 0 4 c f r a n k μ 1 μ 2 1 δ l n 1 e δ μ 1 1 e δ μ 2 1 e δ 1 where δ 0 5 c g u m b e l μ 1 μ 2 e x p ln μ 1 δ ln μ 2 δ 1 δ where δ 1 δ explains the dependence information between the random variables μ 1 and μ 2 the clayton copula the frank copula and the gumbel copula have lower tail dependence radial symmetry and upper tail dependence respectively therefore nearly all the tail dependences can be estimated by the three copula candidate models logically the next thing to do is to determine the parameters δ efficiently and precisely the canonical maximum likelihood method cml genest and favre 2007 is introduced here the main advantage of the copula function is that the error caused by the improper choice of the marginal distributions can be avoided the semiparametric method cml satisfies the goal of estimating the parameters δ directly from the data sets the copula density is used to calculate the pseudo log likelihood function symbolic expressions of the bivariate copula density for the three candidate models are addressed with the help of matlab mathworks 2017 for example the copula density for the clayton copula is shown in equation 6 6 c μ 1 μ 2 2 c c l a y t o n μ 1 μ 2 μ 1 μ 2 1 δ μ 1 μ 2 δ 1 μ 1 δ μ 2 δ 1 1 δ 2 following this μ 1 and μ 2 are the uniform marginal variates it can be solved by the rescaled empirical distribution function by means of the indicator function as is shown in equation 7 7 μ f x i 1 n 1 x i x n 1 where n is the sample data size ultimately the parameter δ is confirmed by forming and maximizing the pseudo log likelihood function llf which is written in equation 8 8 δ arg m a x l l f δ i 1 n l n c μ 1 μ 2 for the sake of method demonstration the dependence function between the wind speed and wave height in fig 2 is used as an example application fig 4 presents the transformed data sample results using the rescaled empirical distribution function although the parameters δ are estimated by the cml the specification of the most suitable copula function should be clarified hashemi et al 2015 recommended application of the akaike s information criterion aic to select the best model among candidate copulas as a comparison approach aic compares the distances between the candidate models and the real model which are shown in equation 9 9 a i c 2 p l l f δ where p is the number of unknown parameters in this paper cml needs to estimate the parameters δ therefore p equals 1 the differences between the distances of the candidate models and the real model and the corresponding akaike weights are written in equations 10 and 11 10 δ i a i c i a i c m i n it is natural that the candidate model with the smallest δ i is the most suitable model in other words the greater the δ i the further the distance between the candidate model and the best model 11 w i e x p 0 5 δ i r 1 r e x p 0 5 δ r another alternative selection method burnham and anderson 2002 is the akaike weight w i where r is the number of candidate copulas thus the weight w i is influenced by the candidate number the larger the w i the more evident it is that the corresponding model is the exact model table 2 shows the example results calculated from the maximum log likelihood function and best model selection methods aic differences and akaike weights as can be seen the aic differences and the akaike weights show substantial evidence that the gumbel copula model is sufficient to describe the dependence structure between the 500 set example for wind speed and wave height accordingly the cml and aic with associated aic differences and akaike weights are able to capture the dependence function among bivariate distributed random variables therefore it is suitable for assessing the dependence structure between the parameters to calculate the loads induced by wind and waves 2 4 step 4 failure probability calculation from steps 1 to 3 the environmental loads and dependence structure between parameters used to calculate the environmental loads are clarified therefore how to evaluate the imposed environmental loads of each section quantitatively with probabilities is of great significance ebeling 1997 put forward the physical reliability model which can assess the failure probability of structures mechanical facilities and so on it is assumed that either stress or strengthen or both of them follow specific types of distributions each divided section is made up of many nodes each of which has different resistances to wind induced loads and wave induced loads the resistances should be no less than zero thus it is assumed that both resistances to wind induced loads and wave induced loads of a particular section follow the lognormal distributions 12 p f a i l u r e 0 l f r r d r φ 1 s l n l t m e d equation 12 explains that the failure probability is calculated through the integration of the resistance from zero to the load when the wind speed is 30 m s or the wave height is 30 m maximum design and manufactured environmental parameters for the sample object the wind or wave loads correspond to the failure probabilities 10 2 as recommended by dnvgl os c101 dnvgl os c101 2019 the coefficient of variation cv is also used to derive the unknown parameters of the lognormal distribution fig 5 shows the influence of the cv intuitively the higher the cv the more sensitive to the loads the section is robert bea a professor emeritus at the university of california berkeley observed zhang 2017 that cresting waves will do real damage when compared to wind and rainfall thus the cv of wave load resistance is greater than the cv of wind load resistance for the section under the impact of combined loads in this example case it is assumed that the cv of wave load resistance is 0 132 and the cv of wind load resistance is 0 108 for section 2 of the column when compared to the pontoon and section 3 of the column the wave forces imposed on section 3 are smaller from the perspective of operation the sample object has the ability to withstand the designed maximum wave height as a whole system which means the column and pontoon are all in normal operating conditions therefore the failure probabilities should be at a similar magnitude it is assumed that the cv of wave load resistances for the pontoon and section 3 of the column are 0 083 and 0 068 respectively and the cv of wind load resistance for section 1 of the column is 0 101 for the sake of manufacture safety standards sample data wind speed 21 7 m s wave height 14 3 m from fig 2 are used as example environmental parameters to calculate the environmental loads and failure probabilities the results are shown in tables 3 and 4 2 5 step 5 compare and consider the maximum probability of failure the failure probabilities for every section are calculated through the physical reliability model and the next step is to derive the failure probabilities from the level of sections to the level of components and from the level of components to the system bayesian network bn is a causal inference model capable of integrating the overall probability with the help of nodes arcs and conditional probability tables cpts yuan et al 2015 it is demonstrated in fig 6 that root causes represent the failure probabilities from the level of sections the arcs represent the causal relationships among nodes that are achieved mathematically by the cpts as mentioned before the main structural components of the sample object include a column and pontoon as shown in fig 3 the pontoon and column have three sections which are represented as ps1 3 and cs1 3 the suffix s refers to damage caused by debris from adjacent sections clearly both wind load and wave load act on the sections 2 column of the sample object the failure probability considering dependent loads the dependence between the parameters to calculate the environmental loads is defined in step 3 should be addressed by the copula based bivariate failure function in equation 13 on the contrary the failure probability assuming independent loads is calculated by the bivariate lognormal distribution with correlation coefficient ρ equals to 0 13 b f f p 1 p 2 f 1 p 1 f 2 p 2 c f 1 p 1 f 2 p 2 where bff p 1 p 2 is the bivariate failure density function p 1 and p 2 are parameters to calculate wind loads and wave loads f p is the load calculation model and physical reliability model and c f 1 p 1 f 2 p 2 is the copula based dependence function the failure probabilities of the components and the sample object are presented in table 4 the failure probabilities of section 2 of the column are shown in fig 7 the failure probability considering dependent loads is greater than the failure probability with independent loads assumption it is calculated in step 3 that the dependence between the wind speed and wave height for the example data sample is established by the gumbel copula the results reveal that the failure probability estimated considering independent environmental loads is an underestimation it is therefore crucial to take dependence into consideration to provide a safety operational envelope using the copula based bivariate failure function 3 application of the proposed methodology the proposed methodology is applied to a typical semi submersible mobile unit smu operating in the grand banks to identify a safety operating envelope the results are compared with the traditional approach 3 1 step 1 2 real time weather observation and environmental load calculation in this paper 1000 sets of wave data and concurrent meteorological observation data from the buoy banquereau 44139 are used from the wave data available on line from the department of fisheries and oceans canada dfo department of fisheries and oceans canada dfo 2019 fig 8 presents the wind speed and wave height observed from banquereau 44139 as the basis of the proposed modeling it is necessary to clarify the geometric dimension parameters and related operational characteristics of the smu table 5 shows the physical characteristics of the smu as revealed in fig 9 the primary structural components from the top to the bottom for the typical smu are the derrick deck columns and pontoons the derrick and columns are divided into three sections according to the height similarly sections 1 2 and 3 of the pontoon are generated by the length then the wind induced loads and wave induced loads for each section are calculated from the wind load modeling and morison load model as suggested from dnvgl rp c205 dnvgl rp c205 2017 3 2 step 3 define dependence calculated using data in step 1 the crux of the proposed methodology is to deduce the dependence function between the parameters to calculate the environmental loads in practical situations the occurrence of the surge is usually related to extreme wind hence it is of considerable significance to consider the dependence to construct the bivariate failure function following the rescaled empirical distribution function in equation 7 the uniform transformed marginals of wind speed and wave height are shown in fig 10 to describe the dependence structure to the greatest extent possible three copula models from the archimedean family are filtered out as potential candidates for their ability to reflect lower tail dependence radial symmetry and upper tail dependence then the uniform marginals are substituted into the copula density which is processed using matlab the dependence parameters δ are calculated using maximum likelihood estimation with equation 8 afterward the aic value aic difference δ i and akaike weights w i are presented in table 6 in view of the best model selection criteria convincing evidence is shown that the gumbel copula is the closest model to the true model generally speaking the larger aic difference δ i is the smaller the akaike weight w i is and the farther the distance between the candidate model and the true model based on the rules of thumb proposed by burnham and anderson 2002 the level of support for the candidate model is essentially none if δ i is larger than 10 the gumbel copula is selected to describe the dependence structure between the parameters to calculate the environmental loads it is also apparent from figs 8 and 10 that the occurrence of strong winds is always accompanied with rogue waves in summary the upper tail dependence between the wind speed and wave height is captured by the gumbel copula 3 3 step 4 5 failure probability calculation and comparison as mentioned before the main structural components of the smu include the derrick deck columns and pontoons the derrick raises and lowers drilling tools while the deck stores the generator room machine equipment and so on due to the support of columns that connect the deck and pontoons the sources of the floatation the smu is a column stabilized mobile unit consequently the construction of the bn follows the unit configuration logic as shown in fig 11 in general the tailored bn consists of four parts which illustrate the four subsystems the pontoon column derrick and deck as shown in fig 9 the pontoon column and derrick have three sections which are represented as ps1 3 cs1 3 and ds1 3 in the bn apart from the necessary sections the mutual dependences are considered as distinguished with the suffix s due to the fact that falling debris may destroy the adjacent sections the lower sections suffer damage from environmental loads directly and debris from adjacent higher sections the damage dependences are adopted from the cpts in fu s research fu and khan 2019 without the stabilization of the columns the deck could not bear the derrick in addition falling debris from the derrick may hit the deck which would further threaten the integrity of the deck the subsystem of the pontoon is responsible for floatation accordingly failure of any one of the abovementioned components would result in the failure of the smu to display the advantage of the operational failure assessment for the smu considering dependent environmental loads a comparison study is conducted using one sample of data wind speed 25 m s wave height 16 1 m as a case example the maximum bearable environmental loads for the smu are calculated with the design and manufactured maximum allowable parameters wind speed 50 m s wave height 35 m it is recommended by dnvgl os c101 dnvgl os c101 2019 that the corresponding failure probabilities be 10 2 for the sake of simplicity the cvs for the sections impacted by combined environmental loads are assumed as 0 295 for the wave load resistances and 0 222 for the wind load resistances table 7 shows the results of the maximum bearable environmental loads and the case example loads for the smu as can be seen sections 1 and 2 of the column are impacted by wind loads and wave loads simultaneously using the example case data the copula based bivariate failure function as expressed in equation 13 is used to calculate the failure probability considering dependent loads for the purpose of comparison the failure probability assuming the independent loads is solved by the joint bivariate lognormal distribution ρ 0 in brief the probabilities of the nodes in the bayesian network are summarized in table 8 the comparison results are shown in fig 12 4 results and discussion table 7 shows that the actual environmental loads are less than the maximum bearable loads because of the small wind speed and low wave height following this the failure probabilities in table 8 reveal that the smu operates within the bounds of safety permission under the circumstances of wind speed 25 m s and wave height 16 1 m as the corresponding failure probability is merely 3 00 10 4 the failure probability for the component derrick is 7 75 10 5 under the impact of wind load only the failure probabilities of the column and pontoon are 7 74 10 5 and 8 02 10 5 respectively which are nearly at the same magnitude however fig 12 demonstrates the superiority of assessing the load impact on the failure of the system considering the dependence among parameters to calculate environmental loads as is shown in fig 12 the failure probabilities of sections 1 and 2 calculated by the copula based bivariate failure function are approximately fifty times larger than the one with the independent loads assumption the failure probability of the smu is integrated with the aid of the bn consequently the failure probability of the smu considering dependent loads is 10 times greater than the one without taking dependence into account ρ 0 under practical circumstances the occurrence of strong winds tends to be accompanied with severe wave conditions thus the marginal failure probabilities induced by the large wind loads are often accompanied by high failure probabilities brought by the significant wave loads for the system under the impact of the combined environmental loads therefore the joint failure probability estimated by the copula based bivariate failure function turns out to be more realistic as it captures the dependence details between the parameters to calculate environmental loads on the other hand fig 10 and the selected gumbel copula show the upper tail dependence character this clearly shows that the stronger wind speed and higher wave height have more substantial dependence on the basis of the copula based bivariate failure function in equation 13 the larger the dependency the greater the value of the failure probability therefore it is vital to take dependence into consideration in extreme weather conditions in conclusion consideration of the dependence structure between the parameters to calculate the environmental loads for operational failure assessment is necessary for the sake of safety production especially in harsh environments it allows the failure probability to be much closer to reality if feasible it is recommended that the historical wave and meteorological data of the operational location be thoroughly investigated 5 conclusions this paper proposes a novel methodology and robust model that consider real time weather observation and estimate the operational failure probability of the system the methodology is explained with a simple example the developed robust model is tested and applied to a detailed case study the novelty of this paper is the consideration of dependence between the parameters to calculate environmental loads the dependence is considered using the copula based bivariate failure function the dependence parameters are estimated by maximizing the pseudo log likelihood functions the selection of the best model among all candidate copula models is accomplished with the aid of akaike s information criterion aic aic differences and akaike weight measure the distances between the best model and candidate model and the level of empirical support the comparison of the proposed approach with the traditional approach considering independence demonstrates the advantage of the operational failure assessment model considering the copula function the failure probability considering dependent loads calculated by the copula based bivariate failure function is noticeably higher and closer to the real life situation this observation emphasizes the vital significance of considering dependence when defining safe operation envelopes under extreme weather conditions this work will help decision makers make informed operational decisions for the system it is important to note that the accuracy and precision of copula selection strongly depends on the data set the broader range the data sets the more the dependence details can be reflected it is recommended that the proper copula function be defined considering a wide range of data so both temporal and spatial variations are captured in defining the dependency therefore the further research direction is to determine the suitable copula function facing the widely encountered issue of data paucity credit authorship contribution statement jinjie fu conceptualization methodology formal analysis investigation writing original draft writing review editing faisal khan conceptualization methodology writing review editing supervision project administration funding acquisition acknowledgements the authors thankfully acknowledge the financial support from the natural science and engineering council of canada nserc and also the canada research chair crc tier i program in offshore safety and risk engineering 
22060,extreme weather conditions put heavy environmental loads on systems and may cause catastrophic failure classification societies such as lloyd s register dnv gl and the american bureau of shipping recommend methods for environmental load calculations these methods do not consider dependencies among parameters when calculating environmental loads this paper proposes a novel methodology to consider the copula based bivariate failure function to evaluate the dependence structure of parameters and minimize uncertainty in load calculations it also presents a robust operational failure assessment model that considers real time environmental parameters along with their dependencies the proposed methodology and models are tested on a semi submersible mobile unit smu the failure probability corresponding to the wind and wave loads imposed on the smu is calculated using a physical reliability model and bayesian network the copula based bivariate failure function defines the dependence using the parameters δ which are estimated using maximum likelihood estimation a detailed case study illustrates the advantage of the proposed methodology the proposed method is of vital significance to developing a safe operating envelope for offshore assets likely to face extreme weather conditions keywords operational failure environmental loads dependence copula function maximum likelihood estimation 1 introduction hurricanes have become more frequent in the past few decades in the 2005 atlantic hurricane season for example the number of hurricanes recorded that year 15 broke the annual record set in 1969 beven et al 2007 the property damage and economic losses that result from the landfall of hurricanes have also become more severe for example hurricane katrina destroyed 44 offshore platforms cruz and krausmann 2008 and shut down many of the oil and gas production facilities located in the gulf of mexico hence research on environmental loads and their impact on the failure of systems is of great importance to avoiding personal injury and property loss classification societies suggest employing standards to calculate environmental loads such as those used by dnv gl dnvgl rp c205 2017 and the american bureau of shipping abs american bureau of shipping abs 2019 these standards provide effective and accurate results are widely applied and have been proven to be effective in numerous engineering practices suja thauvin et al 2018 used dnv gl standards to develop a hydrodynamic load model that analyzes the mode response of a monopile offshore wind turbine caille et al 2017 adopted and validated a hydrodynamics model based on dnv gl methods for a tension leg platform tlp with inclined legs flis 2016 applied the provisions of the abs and calculated the environmental loads for cooling skid units li et al 2018 calculated wave loads in accordance with the abs rules of a 7th generation semi submersible drilling unit csdu to optimize its structural configuration however the assessment of the dependencies among the parameters to calculate environmental loads is lacking in the case of actual operation these weather parameters have a certain interaction relationship particularly in harsh environments this paper examines whether it underestimates or overestimates the impact on the failure of the system in regard to dependence construction the copula function is an emerging model due to the complex interactions that occur in nature the linear correlation coefficient lacks the ability to ascertain the dependence among real time environmental parameters the copulas overcome this limitation through the capacity to model any dependence structures and they have been widely used in the field of financial investment portfolio construction and so on durante and sempi 2015 recently scholars have applied the copula function to system safety and reliability assessments jia et al 2018 zhang and wilson 2017 hashemi et al 2015 guo et al 2019 shen et al 2016 hashemi et al 2015 proposed a multivariate loss function that combined the marginal loss functions with copulas for process facilities risk analysis guo et al 2019 conducted a copula based bayesian network cbbn model to analyze the process system that addressed the limitations of non linear dependence structures shen et al 2016 developed a mixed copula function to acquire the dependence details among failure modes to analyze the reliability of a gear door lock system here the copula function is considered to propose an innovative operational failure assessment model because of its flexibility this work calculates environmental loads using real time weather data and estimates the operational failure probability of the system the dependence structure between the real time environmental parameters is described with copula functions the dependence parameters δ of the candidate copula models are estimated using maximum likelihood estimation then the akaike s information criterion aic differences and akaike weight are used to select the best copula model to depict the dependence structure between the parameters to calculate the environmental loads the comparison results of the case study demonstrate the flexibility and significance of the proposed model the structure of this paper is described as follows section 2 explains the procedure of the proposed real time environmental load and its impact considering the dependence model with a simple illustrative example then section 3 applies the proposed model to a typical semi submersible mobile unit smu as a case study to demonstrate its general applicability the results of the copula based bivariate failure function and independent load failure function are compared and discussed in section 4 the main findings of the study are summarized in section 5 2 the proposed methodology the practical applicability of operational failure assessment with real time weather observation is highlighted using a copula based dependence function the copula function defines the dependence between the parameters to calculate environmental loads in this paper fig 1 shows the details of the proposed methodology the steps of the proposed methodology are explained with a simple example 2 1 step 1 real time weather observation as the basis of the proposed model the first step is to gain access to real time weather data the environmental loads calculated in this paper are wind loads and wave loads therefore 500 sets of wave data and concurrent meteorological observation data were obtained from wave data available online from the department of fisheries and oceans canada dfo department of fisheries and oceans canada dfo 2019 fig 2 plots an example with wind speed and wave height 2 2 step 2 environmental load calculation once the real time weather data are obtained the environmental loads are calculated with the corresponding model it is suggested from dnvgl rp c205 dnvgl rp c205 2017 that the wind and wave induced loads are estimated from the wind load modeling and morison wave load model respectively table 1 shows the physical characteristics of the sample object as revealed in fig 3 the sample object is used to demonstrate the proposed methodology the sample object consists of a pontoon and a column the pontoon provides flotation to the system and supports other functional structure components which are simplified as a column on the top of it to further evaluate the impact of the environmental loads on the failure of the system each structural component is divided into several sections that form the root causes of the bayesian network bn the sections for the column are trisected according to the height as presented in fig 3 similarly generated sections 1 2 and 3 of the pontoon are divided by the length 2 3 step 3 define dependence calculated using data in step 1 along this line of consideration the procedure followed is the dependence assessment the copula was first proposed by sklar 1959 in 1959 and is known as the theorem of sklar it has been shown that copula is a robust tool for assessing the dependence among random variables by establishing the joint distribution because it is a marginal distribution free model it is capable of capturing the dependence directly from the sample data in other words copula based dependence assessment allows the combination of a variety of types of d dimensional marginal distributions here the bivariate case is used to analyze the dependence structure between wind speed and wave height which are the dominant parameters used to calculate the wind loads and wave loads respectively 1 f x 1 x 2 c f 1 x 1 f 2 x 2 the joint distribution function is expressed in equation 1 two random variables are represented as x 1 and x 2 then the copula function c is written in equation 2 2 c μ 1 μ 2 f f 1 1 μ 1 f 2 1 μ 2 μ 1 μ 2 c x y d x d y where c x y is the density of the copula compared with implicit copulas such as gaussian copula archimedean copula family nelsen 2006 are defined as explicit copulas with simple closed forms this makes them suitable for low dimensional joint distribution three examples of archimedean copulas melo et al 2008 are the clayton copula the frank copula and the gumbel copula 3 c c l a y t o n μ 1 μ 2 μ 1 δ μ 2 δ 1 1 δ where δ 1 0 4 c f r a n k μ 1 μ 2 1 δ l n 1 e δ μ 1 1 e δ μ 2 1 e δ 1 where δ 0 5 c g u m b e l μ 1 μ 2 e x p ln μ 1 δ ln μ 2 δ 1 δ where δ 1 δ explains the dependence information between the random variables μ 1 and μ 2 the clayton copula the frank copula and the gumbel copula have lower tail dependence radial symmetry and upper tail dependence respectively therefore nearly all the tail dependences can be estimated by the three copula candidate models logically the next thing to do is to determine the parameters δ efficiently and precisely the canonical maximum likelihood method cml genest and favre 2007 is introduced here the main advantage of the copula function is that the error caused by the improper choice of the marginal distributions can be avoided the semiparametric method cml satisfies the goal of estimating the parameters δ directly from the data sets the copula density is used to calculate the pseudo log likelihood function symbolic expressions of the bivariate copula density for the three candidate models are addressed with the help of matlab mathworks 2017 for example the copula density for the clayton copula is shown in equation 6 6 c μ 1 μ 2 2 c c l a y t o n μ 1 μ 2 μ 1 μ 2 1 δ μ 1 μ 2 δ 1 μ 1 δ μ 2 δ 1 1 δ 2 following this μ 1 and μ 2 are the uniform marginal variates it can be solved by the rescaled empirical distribution function by means of the indicator function as is shown in equation 7 7 μ f x i 1 n 1 x i x n 1 where n is the sample data size ultimately the parameter δ is confirmed by forming and maximizing the pseudo log likelihood function llf which is written in equation 8 8 δ arg m a x l l f δ i 1 n l n c μ 1 μ 2 for the sake of method demonstration the dependence function between the wind speed and wave height in fig 2 is used as an example application fig 4 presents the transformed data sample results using the rescaled empirical distribution function although the parameters δ are estimated by the cml the specification of the most suitable copula function should be clarified hashemi et al 2015 recommended application of the akaike s information criterion aic to select the best model among candidate copulas as a comparison approach aic compares the distances between the candidate models and the real model which are shown in equation 9 9 a i c 2 p l l f δ where p is the number of unknown parameters in this paper cml needs to estimate the parameters δ therefore p equals 1 the differences between the distances of the candidate models and the real model and the corresponding akaike weights are written in equations 10 and 11 10 δ i a i c i a i c m i n it is natural that the candidate model with the smallest δ i is the most suitable model in other words the greater the δ i the further the distance between the candidate model and the best model 11 w i e x p 0 5 δ i r 1 r e x p 0 5 δ r another alternative selection method burnham and anderson 2002 is the akaike weight w i where r is the number of candidate copulas thus the weight w i is influenced by the candidate number the larger the w i the more evident it is that the corresponding model is the exact model table 2 shows the example results calculated from the maximum log likelihood function and best model selection methods aic differences and akaike weights as can be seen the aic differences and the akaike weights show substantial evidence that the gumbel copula model is sufficient to describe the dependence structure between the 500 set example for wind speed and wave height accordingly the cml and aic with associated aic differences and akaike weights are able to capture the dependence function among bivariate distributed random variables therefore it is suitable for assessing the dependence structure between the parameters to calculate the loads induced by wind and waves 2 4 step 4 failure probability calculation from steps 1 to 3 the environmental loads and dependence structure between parameters used to calculate the environmental loads are clarified therefore how to evaluate the imposed environmental loads of each section quantitatively with probabilities is of great significance ebeling 1997 put forward the physical reliability model which can assess the failure probability of structures mechanical facilities and so on it is assumed that either stress or strengthen or both of them follow specific types of distributions each divided section is made up of many nodes each of which has different resistances to wind induced loads and wave induced loads the resistances should be no less than zero thus it is assumed that both resistances to wind induced loads and wave induced loads of a particular section follow the lognormal distributions 12 p f a i l u r e 0 l f r r d r φ 1 s l n l t m e d equation 12 explains that the failure probability is calculated through the integration of the resistance from zero to the load when the wind speed is 30 m s or the wave height is 30 m maximum design and manufactured environmental parameters for the sample object the wind or wave loads correspond to the failure probabilities 10 2 as recommended by dnvgl os c101 dnvgl os c101 2019 the coefficient of variation cv is also used to derive the unknown parameters of the lognormal distribution fig 5 shows the influence of the cv intuitively the higher the cv the more sensitive to the loads the section is robert bea a professor emeritus at the university of california berkeley observed zhang 2017 that cresting waves will do real damage when compared to wind and rainfall thus the cv of wave load resistance is greater than the cv of wind load resistance for the section under the impact of combined loads in this example case it is assumed that the cv of wave load resistance is 0 132 and the cv of wind load resistance is 0 108 for section 2 of the column when compared to the pontoon and section 3 of the column the wave forces imposed on section 3 are smaller from the perspective of operation the sample object has the ability to withstand the designed maximum wave height as a whole system which means the column and pontoon are all in normal operating conditions therefore the failure probabilities should be at a similar magnitude it is assumed that the cv of wave load resistances for the pontoon and section 3 of the column are 0 083 and 0 068 respectively and the cv of wind load resistance for section 1 of the column is 0 101 for the sake of manufacture safety standards sample data wind speed 21 7 m s wave height 14 3 m from fig 2 are used as example environmental parameters to calculate the environmental loads and failure probabilities the results are shown in tables 3 and 4 2 5 step 5 compare and consider the maximum probability of failure the failure probabilities for every section are calculated through the physical reliability model and the next step is to derive the failure probabilities from the level of sections to the level of components and from the level of components to the system bayesian network bn is a causal inference model capable of integrating the overall probability with the help of nodes arcs and conditional probability tables cpts yuan et al 2015 it is demonstrated in fig 6 that root causes represent the failure probabilities from the level of sections the arcs represent the causal relationships among nodes that are achieved mathematically by the cpts as mentioned before the main structural components of the sample object include a column and pontoon as shown in fig 3 the pontoon and column have three sections which are represented as ps1 3 and cs1 3 the suffix s refers to damage caused by debris from adjacent sections clearly both wind load and wave load act on the sections 2 column of the sample object the failure probability considering dependent loads the dependence between the parameters to calculate the environmental loads is defined in step 3 should be addressed by the copula based bivariate failure function in equation 13 on the contrary the failure probability assuming independent loads is calculated by the bivariate lognormal distribution with correlation coefficient ρ equals to 0 13 b f f p 1 p 2 f 1 p 1 f 2 p 2 c f 1 p 1 f 2 p 2 where bff p 1 p 2 is the bivariate failure density function p 1 and p 2 are parameters to calculate wind loads and wave loads f p is the load calculation model and physical reliability model and c f 1 p 1 f 2 p 2 is the copula based dependence function the failure probabilities of the components and the sample object are presented in table 4 the failure probabilities of section 2 of the column are shown in fig 7 the failure probability considering dependent loads is greater than the failure probability with independent loads assumption it is calculated in step 3 that the dependence between the wind speed and wave height for the example data sample is established by the gumbel copula the results reveal that the failure probability estimated considering independent environmental loads is an underestimation it is therefore crucial to take dependence into consideration to provide a safety operational envelope using the copula based bivariate failure function 3 application of the proposed methodology the proposed methodology is applied to a typical semi submersible mobile unit smu operating in the grand banks to identify a safety operating envelope the results are compared with the traditional approach 3 1 step 1 2 real time weather observation and environmental load calculation in this paper 1000 sets of wave data and concurrent meteorological observation data from the buoy banquereau 44139 are used from the wave data available on line from the department of fisheries and oceans canada dfo department of fisheries and oceans canada dfo 2019 fig 8 presents the wind speed and wave height observed from banquereau 44139 as the basis of the proposed modeling it is necessary to clarify the geometric dimension parameters and related operational characteristics of the smu table 5 shows the physical characteristics of the smu as revealed in fig 9 the primary structural components from the top to the bottom for the typical smu are the derrick deck columns and pontoons the derrick and columns are divided into three sections according to the height similarly sections 1 2 and 3 of the pontoon are generated by the length then the wind induced loads and wave induced loads for each section are calculated from the wind load modeling and morison load model as suggested from dnvgl rp c205 dnvgl rp c205 2017 3 2 step 3 define dependence calculated using data in step 1 the crux of the proposed methodology is to deduce the dependence function between the parameters to calculate the environmental loads in practical situations the occurrence of the surge is usually related to extreme wind hence it is of considerable significance to consider the dependence to construct the bivariate failure function following the rescaled empirical distribution function in equation 7 the uniform transformed marginals of wind speed and wave height are shown in fig 10 to describe the dependence structure to the greatest extent possible three copula models from the archimedean family are filtered out as potential candidates for their ability to reflect lower tail dependence radial symmetry and upper tail dependence then the uniform marginals are substituted into the copula density which is processed using matlab the dependence parameters δ are calculated using maximum likelihood estimation with equation 8 afterward the aic value aic difference δ i and akaike weights w i are presented in table 6 in view of the best model selection criteria convincing evidence is shown that the gumbel copula is the closest model to the true model generally speaking the larger aic difference δ i is the smaller the akaike weight w i is and the farther the distance between the candidate model and the true model based on the rules of thumb proposed by burnham and anderson 2002 the level of support for the candidate model is essentially none if δ i is larger than 10 the gumbel copula is selected to describe the dependence structure between the parameters to calculate the environmental loads it is also apparent from figs 8 and 10 that the occurrence of strong winds is always accompanied with rogue waves in summary the upper tail dependence between the wind speed and wave height is captured by the gumbel copula 3 3 step 4 5 failure probability calculation and comparison as mentioned before the main structural components of the smu include the derrick deck columns and pontoons the derrick raises and lowers drilling tools while the deck stores the generator room machine equipment and so on due to the support of columns that connect the deck and pontoons the sources of the floatation the smu is a column stabilized mobile unit consequently the construction of the bn follows the unit configuration logic as shown in fig 11 in general the tailored bn consists of four parts which illustrate the four subsystems the pontoon column derrick and deck as shown in fig 9 the pontoon column and derrick have three sections which are represented as ps1 3 cs1 3 and ds1 3 in the bn apart from the necessary sections the mutual dependences are considered as distinguished with the suffix s due to the fact that falling debris may destroy the adjacent sections the lower sections suffer damage from environmental loads directly and debris from adjacent higher sections the damage dependences are adopted from the cpts in fu s research fu and khan 2019 without the stabilization of the columns the deck could not bear the derrick in addition falling debris from the derrick may hit the deck which would further threaten the integrity of the deck the subsystem of the pontoon is responsible for floatation accordingly failure of any one of the abovementioned components would result in the failure of the smu to display the advantage of the operational failure assessment for the smu considering dependent environmental loads a comparison study is conducted using one sample of data wind speed 25 m s wave height 16 1 m as a case example the maximum bearable environmental loads for the smu are calculated with the design and manufactured maximum allowable parameters wind speed 50 m s wave height 35 m it is recommended by dnvgl os c101 dnvgl os c101 2019 that the corresponding failure probabilities be 10 2 for the sake of simplicity the cvs for the sections impacted by combined environmental loads are assumed as 0 295 for the wave load resistances and 0 222 for the wind load resistances table 7 shows the results of the maximum bearable environmental loads and the case example loads for the smu as can be seen sections 1 and 2 of the column are impacted by wind loads and wave loads simultaneously using the example case data the copula based bivariate failure function as expressed in equation 13 is used to calculate the failure probability considering dependent loads for the purpose of comparison the failure probability assuming the independent loads is solved by the joint bivariate lognormal distribution ρ 0 in brief the probabilities of the nodes in the bayesian network are summarized in table 8 the comparison results are shown in fig 12 4 results and discussion table 7 shows that the actual environmental loads are less than the maximum bearable loads because of the small wind speed and low wave height following this the failure probabilities in table 8 reveal that the smu operates within the bounds of safety permission under the circumstances of wind speed 25 m s and wave height 16 1 m as the corresponding failure probability is merely 3 00 10 4 the failure probability for the component derrick is 7 75 10 5 under the impact of wind load only the failure probabilities of the column and pontoon are 7 74 10 5 and 8 02 10 5 respectively which are nearly at the same magnitude however fig 12 demonstrates the superiority of assessing the load impact on the failure of the system considering the dependence among parameters to calculate environmental loads as is shown in fig 12 the failure probabilities of sections 1 and 2 calculated by the copula based bivariate failure function are approximately fifty times larger than the one with the independent loads assumption the failure probability of the smu is integrated with the aid of the bn consequently the failure probability of the smu considering dependent loads is 10 times greater than the one without taking dependence into account ρ 0 under practical circumstances the occurrence of strong winds tends to be accompanied with severe wave conditions thus the marginal failure probabilities induced by the large wind loads are often accompanied by high failure probabilities brought by the significant wave loads for the system under the impact of the combined environmental loads therefore the joint failure probability estimated by the copula based bivariate failure function turns out to be more realistic as it captures the dependence details between the parameters to calculate environmental loads on the other hand fig 10 and the selected gumbel copula show the upper tail dependence character this clearly shows that the stronger wind speed and higher wave height have more substantial dependence on the basis of the copula based bivariate failure function in equation 13 the larger the dependency the greater the value of the failure probability therefore it is vital to take dependence into consideration in extreme weather conditions in conclusion consideration of the dependence structure between the parameters to calculate the environmental loads for operational failure assessment is necessary for the sake of safety production especially in harsh environments it allows the failure probability to be much closer to reality if feasible it is recommended that the historical wave and meteorological data of the operational location be thoroughly investigated 5 conclusions this paper proposes a novel methodology and robust model that consider real time weather observation and estimate the operational failure probability of the system the methodology is explained with a simple example the developed robust model is tested and applied to a detailed case study the novelty of this paper is the consideration of dependence between the parameters to calculate environmental loads the dependence is considered using the copula based bivariate failure function the dependence parameters are estimated by maximizing the pseudo log likelihood functions the selection of the best model among all candidate copula models is accomplished with the aid of akaike s information criterion aic aic differences and akaike weight measure the distances between the best model and candidate model and the level of empirical support the comparison of the proposed approach with the traditional approach considering independence demonstrates the advantage of the operational failure assessment model considering the copula function the failure probability considering dependent loads calculated by the copula based bivariate failure function is noticeably higher and closer to the real life situation this observation emphasizes the vital significance of considering dependence when defining safe operation envelopes under extreme weather conditions this work will help decision makers make informed operational decisions for the system it is important to note that the accuracy and precision of copula selection strongly depends on the data set the broader range the data sets the more the dependence details can be reflected it is recommended that the proper copula function be defined considering a wide range of data so both temporal and spatial variations are captured in defining the dependency therefore the further research direction is to determine the suitable copula function facing the widely encountered issue of data paucity credit authorship contribution statement jinjie fu conceptualization methodology formal analysis investigation writing original draft writing review editing faisal khan conceptualization methodology writing review editing supervision project administration funding acquisition acknowledgements the authors thankfully acknowledge the financial support from the natural science and engineering council of canada nserc and also the canada research chair crc tier i program in offshore safety and risk engineering 
22061,in this paper a deep reinforcement learning drl based collision avoidance method is proposed for an unmanned surface vehicle usv this approach is applicable to the decision making stage of collision avoidance which determines whether the avoidance is necessary and if so determines the direction of the avoidance maneuver to utilize the visual recognition capability of deep neural networks as a tool for analyzing the complex and ambiguous situations that are typically encountered a grid map representation of the ship encounter situation was suggested for the composition of the drl network we proposed a neural network architecture and semi markov decision process model that was specially designed for the usv collision avoidance problem the proposed drl network was trained through repeated simulations of collision avoidance after the training process the drl network was implemented in collision avoidance experiments and simulations to evaluate its situation recognition and collision avoidance capability keywords deep reinforcement learning collision avoidance unmanned surface vehicle colregs artificial intelligence 1 introduction 1 1 research background in recent years as the social demands for unmanned systems have increased and the performance and reliability of related technologies have improved human operated systems have been actively replaced by unmanned systems this trend is also apparent in the maritime domain in the case of the unmanned surface vehicle usv the unmanned system can substitute for human operations that are time consuming or dangerous such as environmental monitoring or mine searching several different types of usvs have been recently developed or are under development for example defense advanced research projects agency darpa developed a usv for long term tracking of enemy submarines sea hunter while an israeli military company has developed a usv for reconnaissance of the persian gulf coast protector in the private sector a usv has been developed for long term oceanic data collection c enduro as well as marine transportation revolt although these usvs perform different tasks and were developed for different purposes they must have the ability to avoid collisions to nearby obstacles to successfully perform their task collisions can cause structural damage in surface vehicles moreover of equal importance is the risk of property damage environmental pollution caused by oil spillage and the loss of life as such usvs must possess collision avoidance capabilities that are equivalent to that of a human operator or beyond according to campbell et al 2012 investigations have revealed that most ship collision accidents are caused by human errors such as guard negligence or violation of collision prevention rules in the case of usv we can exclude human error from the collision avoidance process therefore it is expected that the collision accident probability in a marine environment can be significantly reduced by the development and deployment of effective and reliable usv collision avoidance algorithms 1 2 previous research in this research we adopted the deep reinforcement learning drl approach to deal with usv collision avoidance problem the following is a representative example of precedent research for both drl and ship collision avoidance research in the field of ship collision avoidance can be classified into obstacle detection inference of the time of collision avoidance and avoidance path planning 1 2 1 obstacle detection to detect nearby obstacles usv depends on perception sensors such as radar lidar light detection and ranging vision sensor sonar and etc almeida et al 2009 conducted a study on the detection of obstacles using a mounted radar and assessed the risk of collision using the closest point of approach cpa information woo and kim 2015 have conducted research on vision based obstacle detection of usv using monocular cameras in order to determine the region of interest in an image a horizontal line was extracted using the ransac algorithm and feature extraction methods were used to detect obstacles lebbad and nataraj 2015 used lidar sensors to estimate the obstacle region of interest in a vision image according to this work they determined that there is distortion of the lidar image due to the oscillatory motion induced by environmental disturbances such as waves 1 2 2 inference of the time of collision avoidance research on the inference of the time of collision avoidance has been actively pursued since the 1970s previous research on this topic can be categorized into approaches based on the ship domain and the closest point of approach cpa methods the ship domain is a concept proposed by fujii and tanaka 1971 that establishes a virtual safety zone around a vessel and performs collision avoidance maneuvers when any obstacle violates the virtual zone subsequent to this work several researchers such as goodwin 1975 coldwell 1983 and davis et al 1980 proposed an advanced ship domain that reflects the colregs in the formation of the ship domain in these works a lateral asymmetry ship domain was proposed to allocate a greater area to the starboard side of the vessel the collision avoidance time inference method using cpa was initially proposed by iwasaki and hara this approach estimates collision risk based on distance to closest point of approach dcpa and time to closest point of approach tcpa information hasegawa and kouzuki 1987 attempted to reflect the experience of an expert ship operator by designing membership function and rules of a fuzzy estimator based on interviews with an expert 1 2 3 avoidance path planning ship collision avoidance path planning algorithms can be categorized into two groups global path planning and local path planning global path planning methods generate collision avoidance paths based on an obstacle map information however a local path planning method generates local avoidance path based on real time sensor information as a global path planning technique there are path generation approaches based on the a algorithm for the grid map proposed by larson et al 2006 and the visibility graph vg proposed by casalino et al 2009 a representative example of the local path planning technique for the usv is the collision avoidance technique using the velocity obstacle vo proposed by kuwata et al 2014 this approach has significantly influenced subsequent research by myre 2016 and stenersen 2015 in the vo technique the obstacle represents a set of velocities that cause a collision when considering the kinematics of moving obstacles and the vehicle by selecting velocity and course angles outside of the vo the vehicle can avoid collision with nearby obstacles 1 2 4 deep reinforcement learning in recent years the deep reinforcement learning method have been actively adopted to deal with various control problem in robotic domain polvara et al applied the drl method to end to end autonomous landing of an uav unmanned aerial vehicle toward stationary marker polvara et al 2018 as well as to a deck of an usv platform polvara et al 2019 similarly a number of researcher applied the drl method to deal with guidance and control of mobile robot zhu et al 2017 tai et al 2017 kahn et al 2018 especially in the indoor environment due to the flexibility of the input layer configuration input data of the drl network are varied from visual image zhu et al 2017 kahn et al 2018 to laser sensor signal tai et al 2017 because of its control capability of the complex and coupled system the drl method is often used to control manipulator robots as well kahn et al 2018 in this work gu et al 2017 validated the effectiveness of asynchronous off policy drl algorithm can successfully perform complex manipulation task such as target reaching and door opening the remainder of this report is organized in sections in section 2 the background concepts used in this work with respect to ship collision avoidance are presented in section 3 the background and problem formulation of the deep reinforcement learning based collision avoidance algorithm is given in section 4 validation of the proposed deep reinforcement learning based collision avoidance method is examined a feasibility analysis in addition to simulation and experiment based collision avoidance test results are also presented in this section finally in section 5 the conclusions of the research and further discussion are reviewed 2 ship collision avoidance 2 1 stages of ship collision avoidance the process of collision avoidance in usvs generally involves four steps shown as fig 1 in the sensing phase obstacle detection is performed using perception sensors such as radar ais lidar and vision sensors using the perceived information motion information of the obstacle is obtained at this point a collision avoidance decision is made during the decision making phase in this stage the usv decide whether the collision avoidance action is necessary or not and if necessary determines the appropriate avoidance action if collision avoidance action is necessary the usv enters the path planning phase in this step a path planner determines the desired guidance command to attempt avoidance action in the last step a controller calculates the desired control input for each actuator to perform the collision avoidance action based on the guidance command generated during the path planning stage our work is focused on the decision making stage however in the process of performing collision avoidance simulations and experiments for usvs the other three stages must be considered as such we adopted the velocity obstacle path planning method to for the path planning stage and for the controller we designed a proportional integral differential pid based steering and speed controller to track the guidance command in the decision making stage of collision avoidance an international regulation for ship collision avoidance should be considered to determine the appropriate avoidance action based on the encountered situation in the remaining parts of this section the background concept of the regulation will be presented 2 2 colregs international regulations for the prevention of collisions at sea colregs is a set of rules established by the international maritime organization imo in 1972 that are mandatory for the operation of marine vessels colregs specifies the give way vessel and the stand on vessel of each encountered situation as well as the desired direction of avoidance to prevent collisions since colregs is an internationally accepted set of rules that are closely related to international maritime laws it is necessary to develop an action plan for unmanned vessels based on colregs to ensure safety at sea the following are representative rules of colregs that are often used for ship collision avoidance in a variety of encountered situations see fig 2 head on situation in a head on encounter situation where the own vessel and the obstacle vessel approach each other both vessels have a duty to avoid each other by performing a turning maneuver to the starboard side colregs article 14 crossing give way in a crossing give way situation the obstacle vessel crosses from the starboard side of the own vessel in this situation the obstacle vessel is the stand on vessel which has no obligation to avoid a collision the own vessel must perform appropriate avoidance action give way vessel to avoid a potential collision according to colregs the own vessel must not cross the moving direction of the other vessel in this case the own vessel must turn to the starboard side to avoid a collision colregs article 15 crossing stand on in a crossing stand on situation the obstacle vessel crosses from the port side of the own vessel in this situation the obstacle vessel is the give way vessel and must perform appropriate action to avoid a potential collision however if the give way vessel does not take appropriate action the own vessel should perform an appropriate avoidance action to prevent the collision despite being the stand on vessel colregs article 17 a overtaking in an overtaking situation where the own vessel overtakes the obstacle vessel the former is the give way vessel and obstacle vessel is the stand on vessel the colregs rule for overtaking article 13 does not specifically state any desired avoidance direction therefore either the port or the starboard direction of avoiding action is permitted 2 3 velocity obstacle path planning in this study the vo algorithm was utilized for the planning of the avoidance path the vo method is commonly used in the field of robotics to plan safe paths for obstacle collision avoidance in 1989 tychonievich proposed the concept of maneuvering board for ship navigation thereafter the technique was developed and improved under different names such as collision cone velocity map and velocity obstacle in recent years stenersen myre and kuwata adopted the vo method in collision avoidance of an unmanned surface vehicle in the velocity obstacle method a velocity obstacle v o is a set of velocities that cause collisions when considering the relative velocities of moving obstacles among the velocities that can be selected this can be expressed as mathematical equations where the operation refers to the minkowski sum operation a b a b a a b b and the operation indicates the reflection operation a a a a 1 v o b a v b v a λ p a v a v b b a 0 according to eq 1 if we assume that the obstacle is defined as disk shaped then eq 1 can be expressed as eq 2 where the d x r represents a disk with radius r and center location vector x 2 v o b a v b v a λ p a v a v b d p b p a r a b once the velocity obstacle set is calculated using eq 2 by selecting a velocity vector outside of the vo and velocity set that violates the colregs a safe guidance command can be calculated in the work of kuwata et al 2014 an optimization technique in a velocity space grid was utilized to determine the best speed and course angle 3 deep reinforcement learning based collision avoidance 3 1 deep reinforcement learning drl according to sutton 1992 reinforcement learning rl is defined as the learning of a mapping from situations to actions to maximize a scalar reward or reinforcement signal in the reinforcement learning problem an agent can recognize environmental situations using a state evaluation function called a value function which is often approximated by a function approximator such as a neural network in recent years multilayer neural networks have often been utilized to solve the rl problem which is known as drl therefore the domain of the rl problem was extended to a more complex environment including visual image based decision making problems because of the deep neural network s powerful capability in image recognition and visual feature extraction in 2013 mnih et al 2015 proposed a powerful deep rl algorithm known as dqn that significantly increased the stability and speed of the learning process in the dqn model the agent is trained to select an optimal action that maximizes cumulative future reward based on its policy π similar to other q learning based rl algorithm the optimal action is determined by selecting an action with the optimal action value function q s a where s and a represent the current state and action and r t is a reward value at time t 3 q s a max π e r t γ r t 1 γ 2 r t 2 s t s a t a π during the training process of the dqn the agent collects experience data sets and they are used to update the action value function so that the result of the agent environment interaction can be reflected in the action value function q s a an iterative update process of the action value function is performed using the following bellman equation where s and a represent the state and action at the next time step respectively 4 q t 1 s a m a x a e r γ m a x a q t s a s a using the convolutional neural network with the parameter θ the action value function q s a can be approximated as q s a θ and the action value network can be iteratively updated using the loss function l θ where θ t is a parameter for the separate deep neural network for target action value 5 l θ e s a r s r γ m a x a q s a θ t q s a θ 2 after mnih et al introduced several technique to increase the stability and performance of the drl such as experience replay and separate target q network used in dqn several researches have produced works on the enhancement of the performance of drl for example van hasselt et al 2016 proposed a method called double dqn which can suppress q value overestimation tendency during the training by decoupling the action selection process from the target q value estimation process in the double dqn method two separate networks were used to determine the best action and to calculate the target q value respectively another import structure is called dueling dqn also known as ddqn suggested by wang et al 2015 in this method the learning process of the action value function q value function is divided into the value of the current state v and the advantage of the action a as described by the following equation 6 q s a v s a s a by dividing the value function and advantage learning of v and a is performed in a parallel manner a benefit of this approach is that the network can separately learn the utility of a state and that of an action so that it can accurately estimate the value function to address the ship collision avoidance decision making problem we adopted the dqn architecture proposed by mnih et al 2015 as well as the double dqn van hasselt et al 2016 and dueling dqn wang et al 2015 to build the network architecture a more detailed description of the proposed network architecture will be provided in section 3 2 3 2 ship collision avoidance using drl fig 3 illustrates the overall block diagram of the proposed collision avoidance system the first group of blocks yellow addresses the recognition of the encountered situation and the selection of the desired behavior of the usv according to the current status this includes decision making on whether the vehicle should avoid the obstacle or not as well as the determination of which direction to avoid to make appropriate decisions the drl network should be able to recognize nearby encounter situations to identify complex collision features in the encountered situation we proposed a visual representation method block 1 of fig 3 generates an encounter situation image and delivers it to the drl network in this regard kinematic information both position η and velocity ν of the usv is necessary as well as path and obstacle information when obstacles are present near the usv determined using tcpa dcpa comparison in 2 of fig 3 the drl network is activated to perform collision avoidance decision making based on the encountered situation the drl network selects one of three behavior candidates from the options of path following starboard side avoidance and port side avoidance once the drl network designates the desired guidance law as illustrated by the red shaded region of fig 3 the corresponding guidance commands desired course angle χ d and velocity ν d can be calculated using the guidance command as a tracking reference the control input u can be determined using steering and speed controllers later in this section a detailed description of the proposed drl based collision avoidance system will be provided 3 2 1 semi markov decision process for the mathematical model of decision making we adopted a semi markov decision process smdp proposed by sutton et al 1999 in smdp the concept of action is temporally extended from that of the markov decision process mdp thus the smdp model can address more sophisticated behavior the action behavior of the proposed drl network is defined as high level behaviors such as path following starboard avoidance and port avoidance instead of instant low level action such as steering control command by selecting the smdp as a base model we can restrict the drl network s role as a behavior selection isolate it from the calculation of control command because of this approach the decision making and control processes can be separated which enables the systematic analysis of the drl based simulation or experiment besides mathematical stability analysis of the low level controller can be conducted by selecting the conventional control algorithms such as pid or lqr controller instead of direct control from deep neural network to address the collision avoidance problem we formulated components of the smdp state action and reward in the following manner firstly the state of the smdp should include all the necessary information to judge collision risk and situation this information includes the target path relative position and velocity of obstacles and own vehicle in this work we suggested a state representation of a visual grid map obstacle image to represent the geometric information of the encountered situation as such we can provide more intuitive information to the drl network and exploit the deep neural network s image recognition capability to understand and assess encountered situations fig 4 illustrates an encountered situation and the corresponding grid map representation the grid map is composed of three layers that contain information on the target path dynamic moving obstacle and static obstacle respectively in this work instead of merging all information into a single channel we intentionally separated each layer in order to prevent it from mixed or overlapped by other layer information according to fig 4 there exists a body fixed virtual window 336 336 m sized fixed to the vehicle and any features obstacle or target path inside this window is represented in the corresponding grid map layer 84 84 pixel sized using an intensity value between 0 and 255 for simplicity of representation of the obstacle using a grid map both the static and dynamic obstacles are assumed to have a circular shape as expressed in fig 4 in the case of the path layer a relative path representation inside of the virtual window is expressed given that the static obstacle and target path are stationary the provision of relative positional information is sufficient to facilitate avoidance decisions however for dynamic obstacles the velocity of the dynamic obstacle should be considered in the avoidance decision process to express the velocity information a line that represents the direction of the obstacle s velocity is included as shown in fig 4 in the dynamic obstacle layer the length of the line is defined as being proportional to the speed of the corresponding obstacle as such if a target obstacle moves with a high speed a relatively long line will be represented in the dynamic obstacle layer so that the drl network can recognize the temporal dependent information using a single image layer although the grid map represents path and nearby obstacle information some of the own vehicle statuses cannot be expressed using the grid map this information includes speed angular late and the thruster rpm of the own vehicle in the problem of usv collision avoidance such information can be directly accessible from the on board devices installed on the usv such as gyro gps and control computer to feed these information to the network an additional low dimensional state vector is utilized in the work of mnih et al a stack of 4 consecutive images was used as an input state to implicitly express the temporal information however in our configuration there is no need for stacking a series of images since the temporal information is already provided to drl network by using the low dimensional state input by combining these two kinds of states both the grid map and the low dimensional state vector the state of the smdp represents the current situation as a result of the collision avoidance decision making process the proposed drl network selects the desired behavior of the vehicle in an encountered situation and the guidance command is calculated from the corresponding guidance law we define three behavior candidates path following starboard side avoidance and port side avoidance for the path following behavior the vector field guidance vfg method proposed by nelson et al 2007 is utilized to determine the guidance command fig 5 a illustrates a schematic description of the vfg method while eq 7 represents the desired course angle command calculated using the vfg method in the equation χ and k represent the maximum course angle variation for path following and convergence rate tuning parameters respectively χ p a t h represents the direction of the target path defined in the inertial reference frame the cross track error e y of the vehicle to the target path can be calculated using the eq 9 7 χ d χ t a n 1 k e y χ p a t h 8 d w k 1 y u s v y k 1 2 x u s v x k 1 2 9 e y s i n χ p a t h a t a n y u s v y k 1 x u s v x k 1 d w k 1 for avoidance path planning we used the vo approach described in section 2 3 to include the avoidance direction selection process in the decision making process we separated the different avoidance direction as independent behaviors in this regard we defined separate prohibited velocity regions in the vo for each avoidance direction as illustrated in fig 5 b and c the desired speed and course angle can then be selected from the remaining safe velocity space after the desired behavior is performed it should be evaluated using the reward function to train the policy of the drl network to address the ship collision avoidance problem the reward function of the smdp was defined as follows we established that there exists three types of rewards for path following collision avoidance and penalty denoted as r p a t h r a v o i d and r p e n a l t y respectively the reward for path following r p a t h is a positive reward that is inverse proportional to the cross track error of the vehicle towards the target path e y r p a t h is included in the reward composition in order to prevent unnecessary or premature avoidance maneuvering of the vehicle r p a t h is defined by the following equation where k r p a t h is a parameter to tune the sensitivity for the case when the drl network conducts path following behavior the final reward r is defined as r r p a t h 10 r p a t h e x p k r p a t h a b s e y due to the positive reward of path following the vehicle tends to follow a path when the collision risk is relatively low in addition by imposing a positive reward for appropriate collision avoidance maneuvering r a v o i d the vehicle can be guided to perform desirable avoidance maneuvers when a collision is imminent the important aspect of this process is that the efficacy of the avoidance maneuver varies according to the starting time of the collision avoidance if the avoidance procedure is performed too late the vehicle may encounter a risky situation or fail to avoid the collision in contrast if the procedure is implemented too early the vehicle may perform unnecessary avoidance maneuvers although it is still safe to follow the target path the suitable moment to initiate an avoidance action differs for each situation encountered thus a reward function should be appropriately designed to facilitate the capture of the required moment by the agent for conducting an avoidance maneuver to achieve this requirement we have categorized encounter situation into two groups in the first group it is assumed that the vehicle should perform avoidance maneuvers as soon as the obstacle is recognized according to the cpa information as illustrated in block 3 of fig 3 this is the case where the crossing give way and overtaking situations should be included because of the give way status of the own vessel in such cases it is important to perform instant avoidance motion to provide prompt avoidance intention to the obstacle vehicle in this case the reward for the avoidance maneuver r a v o i d is calculated using the following equation where k r a v o i d is the sensitivity tuning parameter and t c p a c u r r e n t refers to tcpa at the instance of avoidance the t c p a t h r e s h is defined as the threshold tcpa value used in block 2 of fig 3 to determine the conservative list of the alert obstacle 11 r a v o i d e x p k r a v o i d a b s t c p a c u r r e n t t c p a t h r e s h for the other group we assumed that the own vehicle should hold on to avoid until achieves the appropriate avoidance time this is the case for the head on crossing stand on and the static obstacle is included in comparison with the first group this group of the encounter situation has a relatively large temporal margin until the own vehicle performs avoidance for the case of the head on situation both the own vehicle and the obstacle vehicle are give way vessels thus instead of performing an instant avoidance maneuver we concluded that it is more important to provide clear and obvious avoidance intention to the obstacle vehicle by performing a large course angle change when collisions are avoided using the vo method if the avoidance maneuver is performed too early it tends to be ambiguous due to the small change in the course angle myre 2016 noted that this characteristic of the vo method degrades the quality of the avoidance process thus in this work we determined that the avoidance moment during the head on situation should produce 30 degrees of course angle change to provide clear avoidance intention to the obstacle ship in crossing stand on encountered situations colregs suggest that the own vehicle should maintain its course unless it is evident that the stand on vessel does not perform proper avoidance maneuver in this case despite the status of the stand on vessel the own vehicle must perform appropriate avoidance maneuvers to avert a catastrophic accident to reflect this regulation we determined that the avoidance moment during the crossing stand on situation should produce 75 degrees of course angle change as such the vehicle in the crossing stand on receives a maximum reward value when the implemented course angle change of the avoidance maneuver is 75 degrees it is the domain of the drl leaning process to identify which temporal moment of the avoidance results in the maximum reward for the case of the static obstacle we determined that the avoidance moment during the encountered situation should produce 45 degrees of course angle change such thresholds for the course angle change for different situations are determined by trial and error for several collision avoidance simulations in this group the reward for avoidance maneuver r a v o i d is calculated using the following equation where χ ˆ a v o i d represents the change of the course angle due to the avoidance maneuver and χ ˆ d refers to the desired change in the course angle value according to the corresponding situation for the case when the drl network conducts avoidance maneuver the final reward r is defined as r r a v o i d 12 r a v o i d e x p k r a v o i d a b s χ ˆ a v o i d χ ˆ d in contrast to the positive reward previously mentioned there is also a negative reward for penalty term this penalty reward is active when the vehicle collides with any obstacle or violates the colregs rule during the avoidance maneuver the reward for penalty is defined as the minimum reward value 1 thus r p e n a l t y 1 if any obstacle collision or colregs violation event occurs the reward for the behavior performed is defined as r r p e n a l t y and the learning episode is automatically terminated 3 2 2 deep reinforcement learning network fig 6 illustrates the structure of the proposed drl network in order to suppress the overestimation phenomenon and stabilize the learning process we have adopted the network structure of the dual dqn proposed by wang et al 2015 and double dqn structure van hasselt et al 2016 suggested by hasselt et al in addition to consider non visual information and temporal information such as speed and yaw rate of the own vessel we have constructed input layer for the low dimensional state to train the proposed collision avoidance drl network we performed repeated rl simulations during the simulation experience tuples s a r s are collected into the experience buffer until the number of the tuple reaches to maximum buffer size in this case 750 000 in every training steps a mini batch of the tuple set is randomly selected and will be used as a training data for policy update once the simulation based training process was complete the trained drl network model will be implemented in a real world platform for validation experiments therefore precise modeling of the simulation environment is a crucial aspect to guarantee the performance of the simulation based on the trained drl network in a real world regime in this regard we adopted a dynamic model derived from the system identification experiment woo et al 2018 to reflect the maneuvering characteristics of the research target usv platform in addition the time delay and the measurement noise of the navigation sensor and sampling rate are considered to improve the reality of the simulation in the rl problem the exploration strategy is one of the most important design factors to increase the effectiveness and stability of the learning process in this work we utilized the smdp model to handle temporally extended behavior e g path following guidance instead of instant action e g course angle as a result of this difference the conventional exploration strategy that is typically used to solve the mdp problem such as epsilon greedy exploration cannot be directly applied in the single vessel collision avoidance scenario a single appropriate avoidance behavior is required to avoid the target obstacle the purpose of the rl is to determine the appropriate time required for avoidance during the episode thus the exploration strategy should focus on the uniform exploration of avoidance behavior with respect to the temporal period in an episode instead of the uniform exploration of the action space each time step as in the case of the epsilon greedy exploration strategy to reflect such a difference we propose an exploration method that is applicable to the drl based ship collision avoidance problem 1 similar to the epsilon greedy exploration the epsilon value ϵ is selected the epsilon value gradually decreases during the progression of the training process 2 once an obstacle is classified as an alert obstacle according to the cpa information the tcpa of the alert obstacle is calculated t c p a i n i t 3 exploration is performed with a probability of ϵ during the exploration a tcpa value t c p a e x p which is a randomly selected value between 0 to t c p a i n i t is calculated 4 in the case of the exploration avoidance behavior is implemented when the t c p a i n i t of the obstacle is less than t c p a e x p if there exist multiple avoidance behavior candidates the direction of the avoidance is randomly selected for uniform training of the drl network in various situations we composed a single episode of the rl as a combination of six different sub episodes for different encountered situations each sub episode is in charge of 1 head on 2 crossing give way 3 crossing stand on 4 overtaking 5 multiple static obstacles and 6 multiple dynamic obstacle encounter situations the initial position and velocity of the obstacle are randomly selected within a predefined range of corresponding encounter situations fig 7 describes the training result for the drl network with respect to the collision avoidance scenario the x axis of the figure represents the training time whereas the y axis represents the episodic reward which indicates the efficacy of the agent usv in avoiding collisions episodic reward is defined as the sum of each of the six sub episode rewards in fig 7 the red solid line represents the moving average of the episodic reward for 200 episodes window while the green shaded region represents the standard deviation of the episodic reward within the moving window the training result of fig 7 is achieved from a single training process conducted for approximately 110 h the number of total training steps is 800 000 steps and it took about 0 5 s for a single step of the drl based on the training we can verify that the effectiveness of the drl network in collision avoidance increases with training after a certain time period the slope of the performance index converges to approximately zero and the policy converges to the final policy the training process of the drl network is performed using the tensorflow framework and the adam optimizer is used for optimization during training to train the drl network a desktop pc with a 6th generation i7 3 40 ghz cpu 16 gb ram and a geforce gtx970 gpu was used 4 validation in this chapter we provide validation results for the proposed collision avoidance method before directly implementing the trained policy network for collision avoidance simulation we attempted to evaluate the validity of the proposed method using several approaches these included an assessment of the collision risk and the saliency map after this process several collision avoidance simulations and full scale usv experiments were performed for different encountered conditions to evaluate the effectiveness of the proposed method and verify its applicability in the real world domain 4 1 research target usv in this study we selected a 14 ft wave adaptive modular vessel wam v type usv as the research target an wam v usv is catamaran shaped usv and composed of two pontoon based hull and upper deck there are two suspensions between the upper deck and each pontoon which are designed to minimize wave induced motion of the upper deck this usv has a length of 4 88 m and a breadth of 2 5 m thrust is produced by two electric motors mounted on each hull and the maximum speed of the vehicle is up to 5 knots since the direction of the thrust force is fixed the vehicle can generate steering control moment by generating rpm differences for the port and starboard side thrusters fig 8 shows an image of the wam v platform used in this work as the research target vehicle woo et al 2018 recently conducted a dynamic system identification of the identical wam v platform in this work a dynamic model of the wam v usv was derived based on system identification experiments thus for the collision avoidance simulation environment we used the dynamic system suggested by woo et al 2018 4 2 collision risk assessment once the training process was completed we utilized the trained network to estimate the collision risk hasegawa and kouzuki 1987 ahn et al 2012 for verification of the situation awareness capability under a given input situation by definition the collision risk is an index that describes the negative extent of the encountered situation this is the opposite definition of the value function in reinforcement learning a value function is defined as the accumulated future reward intuitively this term describes the positive extent of the encountered situation thus by reversing the sign of the value function and normalizing the term with a maximum value v m a x as eq 13 we define a collision risk c r using the value function v s of the reinforcement learning network 13 c r v m a x v s v m a x v m i n for collision risk estimation we performed virtual experiments by applying arbitrary input data to the drl network by analyzing the output value function of the corresponding input situation encountered the recognition ability of the proposed method can be verified for the virtual experiment we defined 5000 encounter situations as input data in each encountered situation a single obstacle ship is located the speed and course angle of the obstacle vehicle are fixed as the negative y axis direction and 1 5 m s respectively for the relative position of the obstacle vehicle the range of the initial lateral position is defined as 168 to 168 and the variables are divided into 100 equal steps the range of the initial longitudinal position is set as 0 to 168 and is divided into 50 equal steps fig 9 shows a color representation of the collision risk estimation result with the corresponding obstacle ship location based on the virtual experiments we can determine that the collision risk tends to be high as the distance to the obstacle ship become is reduced in addition the proposed method recognizes that an obstacle ship on the port side has a higher collision risk than an obstacle ship on the port side a similar tendency was also observed in previous works such as the asymmetry ship domain proposed by coldwell 1983 goodwin 1975 and davis et al 1980 this tendency is due to the influence of colregs according to colregs in most of the encountered situation a ship must perform a starboard side turning maneuver to avoid the obstacle vehicle however if there is an obstacle on the ship s starboard side the vehicle tends to be exposed to a more risky situation during collision avoidance as a result of the iterative learning process the agent can discover such tendency on its own without prior knowledge 4 2 1 saliency map analysis as described in section 3 2 1 we processed maritime traffic encounter situation information to produce visual information using a grid map this visual information is then used as input data of the convolutional neural network cnn layer when the cnn analyzes the current encounter situation we can determine the regions of the grid map that the cnn focuses on using a saliency map using this tool we can visualize the active region of the input grid map simonyan et al 2013 proposed a systematic approach for obtaining a saliency map based on the jacobians of the trained value function of the drl with respect to the image pixel if there is a higher jacobian in a certain region of an image this implies that visual information in this region has a significant effect on the value function for the validation purpose we produced two encounter situation grid maps virtually and used them as input images for the reinforcement learning network fig 10 shows a comparison result for an encounter situation grid map and the corresponding saliency maps there are two grid maps one without obstacle and another one with an obstacle near the vessel in the first case the reinforcement learning network focuses on the region where the own vehicle is located and the overall both the forward and behind side region of the target path moreover once there is an approaching dynamic obstacle in front of the own vehicle the network tends to focus more on the region where the obstacle is located instead of the behind side region of the target path 4 3 collision avoidance simulation during the collision risk assessment and saliency map analysis we verified the applicability of the proposed method for the collision avoidance problem however to evaluate its effectiveness during the collision avoidance stage corresponding simulations should be performed in the collision avoidance simulation we assumed that the obstacle information is provided by other perception devices from the perspective of ship collision avoidance problem the level of uncertainty tends to be high when there is a large number of obstacles near the vehicle this is because the ship collision avoidance problem is a decision making problem in which previous decisions affect future events as a result an acceptable avoidance maneuver decision made in the past may have a catastrophic result in the future considering a collision avoidance scenario with multiple ships as described in fig 11 firstly the usv should avoid an obstacle vehicle location in front in the case of an overtaking encounter situation obs1 behind the obs1 two obstacle vehicles are approaching toward the usv with head on encounter situation obs2 and obs3 according to the colregs either port or starboard side avoidance maneuvers are acceptable to avoid the obs1 overtaking encounter situation since the obstacle ship is located on the port side of the usv an avoidance maneuver with starboard side turning is desirable considering the relative position of the obs1 and target path however once the usv performs the starboard turning maneuver the vehicle will encounter obs2 and obs3 and it will have to perform successive avoidance maneuvers to avoid a collision this is a typical example of a decision making problem to address these issues decisions should be made based on the expectation of future events according to the current action choice unlike the conventional approach the proposed drl based collision avoidance method can foresee future situations using the action value function that was trained via repeated collision avoidance simulations for the validation of the proposed method we performed collision avoidance simulations for the encounter situation described in fig 11 using both the proposed method and conventional approach for the conventional method a cpa based collision risk assessment method suggested by hasegawa and kouzuki 1987 and the velocity obstacle method kuwata et al 2014 for path planning were used fig 12 describes collision avoidance simulation result based on conventional approaches as the usv faces the overtaking vessel obs1 the kinematic information of the usv and obstacle vessels are transformed into cpa based parameters using the calculated tcpa and dcpa an encounter situation was considered as an alert situation at approximately 5 s when considering the current encounter situation a starboard side avoidance maneuver is determined using the vo method although the vo method can address the path planning of multiple vessels the effect of obs2 and obs3 when considering the avoidance maneuver for obs1 is limited due to the large distance to obs2 and obs3 after avoiding obs1 the usv encountered obs2 and obs3 and successive avoidance maneuvers were performed to avoid collisions fig 13 represents the collision avoidance simulation results obtained using the proposed method in an identical scenario in this case once the usv encounters the obs1 it can determine the likely outcome if a starboard maneuver is performed to avoid a vehicle based on the current encounter situation grid map thus instead of performing a starboard turning maneuver the vehicle turned to the port side in order to avoid obs1 the port side avoidance maneuver seems to be inefficient when considering obs1 only however considering the encounter situation the maneuver is a far more efficient and safe avoidance maneuver based on experiences during the training stage the proposed drl network can develop the ability to understand and interpret complex ship encounter situations on its own this ability to predict imminent risk under the complicated encountering situation is one of the most distinctive characteristics of this proposed method such ability is one of the most crucial aspects of autonomous ship collision avoidance this is because most ship collision incidents occur when there is a high level of uncertainty due to complex and ambiguous encounter situations to deal with such complexity a high level decision should be made using the entire complex encounter situation information however conventional collision risk assessment methods both cpa and ship domain based collision risk assessment methods cannot provide such information because these approaches tend to simplify the encounter situation when conventional collision risk assessment interprets complex and ambiguous encounter situation the encounter situation is parameterized into a few parameters during the parameterization most of the delicate and complex information is diminished and diluted into a few parameters on the contrary the proposed drl based method uses the complete information of the current encounter situation to make collision avoidance decisions therefore it can recognize complex encounter situation fig 14 schematically illustrates such difference between conventional approaches and the proposed method 4 4 collision avoidance experiment to validate the proposed collision avoidance decision makingmethod in the real world we performed free running experiments with a full scale usv for the experiment we utilized the trained drl model network that was used during the validation simulation and deployed the network into the usv control system using the parameters from the extracted drl network the action value function advantage of each behavior candidate can be calculated in real time for navigation of the usv we used navigational sensor information such as dual frequency gps novatel smart6 and an ins sensor microstrain 3dm gx3 for the obstacle perception we assumed that there are virtual obstacles in the experimental site to simplify the range of the research in real world application we defined constant velocity obstacle models and calculated the obstacle s kinematic information based on the running time of the experiment the free running experiment was performed in lake pyoungtaek and the wam v usv platform is described in section 4 1 was used as the target usv platform for experimental validation of the collision avoidance capability of the proposed method both the single obstacle ship head on and overtaking encounter situation and multiple obstacle ship scenario were selected as experimental scenarios 4 4 1 head on encounter scenario in the head on encounter scenario we defined a head on encounter situation with an obstacle ship approaching the usv with a ship speed of 0 8 m s fig 15 represents the experimental result for collision avoidance during the head on encounter scenario the red dotted line represents autonomous experimental results and the green solid line represents the corresponding simulation results for identical initial conditions of the usv and obstacle the avoidance maneuver was performed when the distance between the two vehicles was approximately equal to 65 m and the maximum course angle change was measured as 46 in the reward function designing process the desired course angle change was defined as 30 however the measured course angle change tends to have a higher value we concluded that this is due to the different dynamic characteristics of the controller in the usv platform and simulation given that the dynamic model identification process performed by woo et al 2018 was limited to open loop system identification the controllers in both the real world plant and the simulation were independently designed and tuned in the experimental results a higher overshoot level of the tracking error is determined for the course angle at 15 s at 31 s oscillatory motion of the course angle occurred based on detailed analysis it was determined that this is because of the modeling uncertainty or environmental disturbances as a result of the collision avoidance during the experiments and simulations the usv returned to its target path in the case of the experimental results there is a delay of approximately 4 s between the moment of recovery and the target path compared to the result of the simulation this tendency is due to the repeated oscillatory motion of the course angle given that the usv is a differential thruster type vehicle to produce a steering control moment the rpm of the port and the starboard side thruster should be changed as a result of the rpm change a speed reduction may occur and the recovery time may be delayed despite the temporal difference the usv was able to stably avoid the obstacle ship in both the experiments and simulations with the guarantee of a predefined avoidance range margin of 25 m fig 15 right shows the snapshot trajectory of the usv and obstacle ship during the head on encounter collision avoidance experiment as well as aerial images of the conducted experiment 4 4 2 overtaking encounter scenario fig 16 illustrates the experimental results for the overtaking encounter collision avoidance scenario for the initial condition we the obstacle ship was set to head north 90 which is same as the usv and speed of the obstacle ship and the usv were set as 0 4 m s and 1 5 m s respectively in the case of the overtaking encounter scenario the avoidance maneuver was performed over a wide area due to the low relative velocity based on the experiments the course angle overshoot error which was found in the result of head on scenario can also be determined however the usv tends to guarantee a predefined avoidance range margin of 25 m throughout the entire maneuvering process due to the slow relative velocity the simulation and experiment results tend to have a small trajectory error by examining the trajectory point at 125 s it was determined that there is 6 m of difference in the usv position between the experiment and simulation as indicated in the case of the head on scenario we determined that this is due to the speed reduction in the experiment caused by the oscillation of the course angle fig 16 right describes the snapshot trajectory of the usv and obstacle ship and the aerial snapshot acquired during the overtaking experiment 4 4 3 multiple ship encounter scenario fig 17 illustrates the initial condition for the multiple ship avoidance scenario in this encounter situation three obstacle vessels are defined as obstacles of the usv according to the course angle change described in fig 18 the initial avoidance maneuver starts approximately at 10 s in both the experiment and simulation the usv then returns to the target path at approximately 70 s at this instance it is evident that there is 6 m of difference between the position of the usv in the simulation and experiment fig 19 the usv tends to follow the target path for 82 s then encounters the second obstacle ship at that instance the usv in the simulation is ahead of the usv in the experiment therefore the former starts to perform avoidance maneuvers relatively early these differences in the starting time of collision avoidance for different collision avoidance trajectories are as illustrated in the snapshot trajectory fig 19 at 110 s once the usv returns to the target path at approximately 140 s it encounters an obstacle ship in an overtaking situation to overtake the vehicle the usv starts to perform a starboard maneuver according to the trajectory result described in fig 18 it can be inferred that the corresponding avoidance in the simulation was performed at an earlier moment compared to the experiment fig 18 depicts a snapshot of the vehicle s trajectory during each encounter situation of the scenario 5 conclusion in this work we proposed a drl based collision avoidance decision making algorithm and conducted simulations and experiments to validate its effectiveness in the proposed method a usv recognizes its nearby environment using a grid map representation of the encountered situation the generation of this information using a visual grid map representation is one of the crucial aspects of the proposed method by providing information on the convolutional neural network cnn the feature extraction capability of the cnn can be adapted to develop an intuition for collision situation awareness to consider colregs in the process of the collision avoidance decision we designed reward functions for the drl network with respect to each encountered situation the resulting drl network was trained based on repeated collision avoidance simulations it is therefore able to reflect experiences during various encounter circumstances as a result of this work we can state the following conclusions according to the collision risk assessment analysis it was determined that the proposed method can identify the risk of collision in a similar manner to conventional approaches for example the proposed method recognized the asymmetric characteristic of the collision risk highlighted in previous works coldwell 1983 goodwin 1975 davis et al 1980 via repeated collision avoidance simulations the proposed method can recognize complex and ambiguous situations with multiple obstacles in addition it can empirically foresee future risk of collision when considering avoidance action candidates the proposed method can select a suitable avoidance strategy according to the type of encounter based on the colregs there are a variety of avoidance requirements for different encountered situations the proposed method can consider such difference by independently designing the reward function throughout the full scale usv collision avoidance experiments under various scenarios the applicability and the effectiveness of the proposed method in the real world domain was verified although there are several merits there are also a few limitations of the proposed system given that the proposed method repeatedly performs reinforcement learning on a high dimensional state grid map visual information this requires hundreds of hours of training in addition the application of the trained drl network is affected by the uncertainty of the modeling of the vehicle because the training process is performed in the simulation environment if the usv can be trained in a real world environment this limitation will be overcome for future work we are planning to consider the effect of environmental load in making collision avoidance decisions in order to increase the reliability and effectiveness of the proposed method in a real world domain in addition we are considering extension of the action space to ship s speed control as well as steering control this approach will be effective especially under the multi vessel encounter scenario credit authorship contribution statement joohyun woo conceptualization methodology software writing original draft writing review editing nakwan kim supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
22061,in this paper a deep reinforcement learning drl based collision avoidance method is proposed for an unmanned surface vehicle usv this approach is applicable to the decision making stage of collision avoidance which determines whether the avoidance is necessary and if so determines the direction of the avoidance maneuver to utilize the visual recognition capability of deep neural networks as a tool for analyzing the complex and ambiguous situations that are typically encountered a grid map representation of the ship encounter situation was suggested for the composition of the drl network we proposed a neural network architecture and semi markov decision process model that was specially designed for the usv collision avoidance problem the proposed drl network was trained through repeated simulations of collision avoidance after the training process the drl network was implemented in collision avoidance experiments and simulations to evaluate its situation recognition and collision avoidance capability keywords deep reinforcement learning collision avoidance unmanned surface vehicle colregs artificial intelligence 1 introduction 1 1 research background in recent years as the social demands for unmanned systems have increased and the performance and reliability of related technologies have improved human operated systems have been actively replaced by unmanned systems this trend is also apparent in the maritime domain in the case of the unmanned surface vehicle usv the unmanned system can substitute for human operations that are time consuming or dangerous such as environmental monitoring or mine searching several different types of usvs have been recently developed or are under development for example defense advanced research projects agency darpa developed a usv for long term tracking of enemy submarines sea hunter while an israeli military company has developed a usv for reconnaissance of the persian gulf coast protector in the private sector a usv has been developed for long term oceanic data collection c enduro as well as marine transportation revolt although these usvs perform different tasks and were developed for different purposes they must have the ability to avoid collisions to nearby obstacles to successfully perform their task collisions can cause structural damage in surface vehicles moreover of equal importance is the risk of property damage environmental pollution caused by oil spillage and the loss of life as such usvs must possess collision avoidance capabilities that are equivalent to that of a human operator or beyond according to campbell et al 2012 investigations have revealed that most ship collision accidents are caused by human errors such as guard negligence or violation of collision prevention rules in the case of usv we can exclude human error from the collision avoidance process therefore it is expected that the collision accident probability in a marine environment can be significantly reduced by the development and deployment of effective and reliable usv collision avoidance algorithms 1 2 previous research in this research we adopted the deep reinforcement learning drl approach to deal with usv collision avoidance problem the following is a representative example of precedent research for both drl and ship collision avoidance research in the field of ship collision avoidance can be classified into obstacle detection inference of the time of collision avoidance and avoidance path planning 1 2 1 obstacle detection to detect nearby obstacles usv depends on perception sensors such as radar lidar light detection and ranging vision sensor sonar and etc almeida et al 2009 conducted a study on the detection of obstacles using a mounted radar and assessed the risk of collision using the closest point of approach cpa information woo and kim 2015 have conducted research on vision based obstacle detection of usv using monocular cameras in order to determine the region of interest in an image a horizontal line was extracted using the ransac algorithm and feature extraction methods were used to detect obstacles lebbad and nataraj 2015 used lidar sensors to estimate the obstacle region of interest in a vision image according to this work they determined that there is distortion of the lidar image due to the oscillatory motion induced by environmental disturbances such as waves 1 2 2 inference of the time of collision avoidance research on the inference of the time of collision avoidance has been actively pursued since the 1970s previous research on this topic can be categorized into approaches based on the ship domain and the closest point of approach cpa methods the ship domain is a concept proposed by fujii and tanaka 1971 that establishes a virtual safety zone around a vessel and performs collision avoidance maneuvers when any obstacle violates the virtual zone subsequent to this work several researchers such as goodwin 1975 coldwell 1983 and davis et al 1980 proposed an advanced ship domain that reflects the colregs in the formation of the ship domain in these works a lateral asymmetry ship domain was proposed to allocate a greater area to the starboard side of the vessel the collision avoidance time inference method using cpa was initially proposed by iwasaki and hara this approach estimates collision risk based on distance to closest point of approach dcpa and time to closest point of approach tcpa information hasegawa and kouzuki 1987 attempted to reflect the experience of an expert ship operator by designing membership function and rules of a fuzzy estimator based on interviews with an expert 1 2 3 avoidance path planning ship collision avoidance path planning algorithms can be categorized into two groups global path planning and local path planning global path planning methods generate collision avoidance paths based on an obstacle map information however a local path planning method generates local avoidance path based on real time sensor information as a global path planning technique there are path generation approaches based on the a algorithm for the grid map proposed by larson et al 2006 and the visibility graph vg proposed by casalino et al 2009 a representative example of the local path planning technique for the usv is the collision avoidance technique using the velocity obstacle vo proposed by kuwata et al 2014 this approach has significantly influenced subsequent research by myre 2016 and stenersen 2015 in the vo technique the obstacle represents a set of velocities that cause a collision when considering the kinematics of moving obstacles and the vehicle by selecting velocity and course angles outside of the vo the vehicle can avoid collision with nearby obstacles 1 2 4 deep reinforcement learning in recent years the deep reinforcement learning method have been actively adopted to deal with various control problem in robotic domain polvara et al applied the drl method to end to end autonomous landing of an uav unmanned aerial vehicle toward stationary marker polvara et al 2018 as well as to a deck of an usv platform polvara et al 2019 similarly a number of researcher applied the drl method to deal with guidance and control of mobile robot zhu et al 2017 tai et al 2017 kahn et al 2018 especially in the indoor environment due to the flexibility of the input layer configuration input data of the drl network are varied from visual image zhu et al 2017 kahn et al 2018 to laser sensor signal tai et al 2017 because of its control capability of the complex and coupled system the drl method is often used to control manipulator robots as well kahn et al 2018 in this work gu et al 2017 validated the effectiveness of asynchronous off policy drl algorithm can successfully perform complex manipulation task such as target reaching and door opening the remainder of this report is organized in sections in section 2 the background concepts used in this work with respect to ship collision avoidance are presented in section 3 the background and problem formulation of the deep reinforcement learning based collision avoidance algorithm is given in section 4 validation of the proposed deep reinforcement learning based collision avoidance method is examined a feasibility analysis in addition to simulation and experiment based collision avoidance test results are also presented in this section finally in section 5 the conclusions of the research and further discussion are reviewed 2 ship collision avoidance 2 1 stages of ship collision avoidance the process of collision avoidance in usvs generally involves four steps shown as fig 1 in the sensing phase obstacle detection is performed using perception sensors such as radar ais lidar and vision sensors using the perceived information motion information of the obstacle is obtained at this point a collision avoidance decision is made during the decision making phase in this stage the usv decide whether the collision avoidance action is necessary or not and if necessary determines the appropriate avoidance action if collision avoidance action is necessary the usv enters the path planning phase in this step a path planner determines the desired guidance command to attempt avoidance action in the last step a controller calculates the desired control input for each actuator to perform the collision avoidance action based on the guidance command generated during the path planning stage our work is focused on the decision making stage however in the process of performing collision avoidance simulations and experiments for usvs the other three stages must be considered as such we adopted the velocity obstacle path planning method to for the path planning stage and for the controller we designed a proportional integral differential pid based steering and speed controller to track the guidance command in the decision making stage of collision avoidance an international regulation for ship collision avoidance should be considered to determine the appropriate avoidance action based on the encountered situation in the remaining parts of this section the background concept of the regulation will be presented 2 2 colregs international regulations for the prevention of collisions at sea colregs is a set of rules established by the international maritime organization imo in 1972 that are mandatory for the operation of marine vessels colregs specifies the give way vessel and the stand on vessel of each encountered situation as well as the desired direction of avoidance to prevent collisions since colregs is an internationally accepted set of rules that are closely related to international maritime laws it is necessary to develop an action plan for unmanned vessels based on colregs to ensure safety at sea the following are representative rules of colregs that are often used for ship collision avoidance in a variety of encountered situations see fig 2 head on situation in a head on encounter situation where the own vessel and the obstacle vessel approach each other both vessels have a duty to avoid each other by performing a turning maneuver to the starboard side colregs article 14 crossing give way in a crossing give way situation the obstacle vessel crosses from the starboard side of the own vessel in this situation the obstacle vessel is the stand on vessel which has no obligation to avoid a collision the own vessel must perform appropriate avoidance action give way vessel to avoid a potential collision according to colregs the own vessel must not cross the moving direction of the other vessel in this case the own vessel must turn to the starboard side to avoid a collision colregs article 15 crossing stand on in a crossing stand on situation the obstacle vessel crosses from the port side of the own vessel in this situation the obstacle vessel is the give way vessel and must perform appropriate action to avoid a potential collision however if the give way vessel does not take appropriate action the own vessel should perform an appropriate avoidance action to prevent the collision despite being the stand on vessel colregs article 17 a overtaking in an overtaking situation where the own vessel overtakes the obstacle vessel the former is the give way vessel and obstacle vessel is the stand on vessel the colregs rule for overtaking article 13 does not specifically state any desired avoidance direction therefore either the port or the starboard direction of avoiding action is permitted 2 3 velocity obstacle path planning in this study the vo algorithm was utilized for the planning of the avoidance path the vo method is commonly used in the field of robotics to plan safe paths for obstacle collision avoidance in 1989 tychonievich proposed the concept of maneuvering board for ship navigation thereafter the technique was developed and improved under different names such as collision cone velocity map and velocity obstacle in recent years stenersen myre and kuwata adopted the vo method in collision avoidance of an unmanned surface vehicle in the velocity obstacle method a velocity obstacle v o is a set of velocities that cause collisions when considering the relative velocities of moving obstacles among the velocities that can be selected this can be expressed as mathematical equations where the operation refers to the minkowski sum operation a b a b a a b b and the operation indicates the reflection operation a a a a 1 v o b a v b v a λ p a v a v b b a 0 according to eq 1 if we assume that the obstacle is defined as disk shaped then eq 1 can be expressed as eq 2 where the d x r represents a disk with radius r and center location vector x 2 v o b a v b v a λ p a v a v b d p b p a r a b once the velocity obstacle set is calculated using eq 2 by selecting a velocity vector outside of the vo and velocity set that violates the colregs a safe guidance command can be calculated in the work of kuwata et al 2014 an optimization technique in a velocity space grid was utilized to determine the best speed and course angle 3 deep reinforcement learning based collision avoidance 3 1 deep reinforcement learning drl according to sutton 1992 reinforcement learning rl is defined as the learning of a mapping from situations to actions to maximize a scalar reward or reinforcement signal in the reinforcement learning problem an agent can recognize environmental situations using a state evaluation function called a value function which is often approximated by a function approximator such as a neural network in recent years multilayer neural networks have often been utilized to solve the rl problem which is known as drl therefore the domain of the rl problem was extended to a more complex environment including visual image based decision making problems because of the deep neural network s powerful capability in image recognition and visual feature extraction in 2013 mnih et al 2015 proposed a powerful deep rl algorithm known as dqn that significantly increased the stability and speed of the learning process in the dqn model the agent is trained to select an optimal action that maximizes cumulative future reward based on its policy π similar to other q learning based rl algorithm the optimal action is determined by selecting an action with the optimal action value function q s a where s and a represent the current state and action and r t is a reward value at time t 3 q s a max π e r t γ r t 1 γ 2 r t 2 s t s a t a π during the training process of the dqn the agent collects experience data sets and they are used to update the action value function so that the result of the agent environment interaction can be reflected in the action value function q s a an iterative update process of the action value function is performed using the following bellman equation where s and a represent the state and action at the next time step respectively 4 q t 1 s a m a x a e r γ m a x a q t s a s a using the convolutional neural network with the parameter θ the action value function q s a can be approximated as q s a θ and the action value network can be iteratively updated using the loss function l θ where θ t is a parameter for the separate deep neural network for target action value 5 l θ e s a r s r γ m a x a q s a θ t q s a θ 2 after mnih et al introduced several technique to increase the stability and performance of the drl such as experience replay and separate target q network used in dqn several researches have produced works on the enhancement of the performance of drl for example van hasselt et al 2016 proposed a method called double dqn which can suppress q value overestimation tendency during the training by decoupling the action selection process from the target q value estimation process in the double dqn method two separate networks were used to determine the best action and to calculate the target q value respectively another import structure is called dueling dqn also known as ddqn suggested by wang et al 2015 in this method the learning process of the action value function q value function is divided into the value of the current state v and the advantage of the action a as described by the following equation 6 q s a v s a s a by dividing the value function and advantage learning of v and a is performed in a parallel manner a benefit of this approach is that the network can separately learn the utility of a state and that of an action so that it can accurately estimate the value function to address the ship collision avoidance decision making problem we adopted the dqn architecture proposed by mnih et al 2015 as well as the double dqn van hasselt et al 2016 and dueling dqn wang et al 2015 to build the network architecture a more detailed description of the proposed network architecture will be provided in section 3 2 3 2 ship collision avoidance using drl fig 3 illustrates the overall block diagram of the proposed collision avoidance system the first group of blocks yellow addresses the recognition of the encountered situation and the selection of the desired behavior of the usv according to the current status this includes decision making on whether the vehicle should avoid the obstacle or not as well as the determination of which direction to avoid to make appropriate decisions the drl network should be able to recognize nearby encounter situations to identify complex collision features in the encountered situation we proposed a visual representation method block 1 of fig 3 generates an encounter situation image and delivers it to the drl network in this regard kinematic information both position η and velocity ν of the usv is necessary as well as path and obstacle information when obstacles are present near the usv determined using tcpa dcpa comparison in 2 of fig 3 the drl network is activated to perform collision avoidance decision making based on the encountered situation the drl network selects one of three behavior candidates from the options of path following starboard side avoidance and port side avoidance once the drl network designates the desired guidance law as illustrated by the red shaded region of fig 3 the corresponding guidance commands desired course angle χ d and velocity ν d can be calculated using the guidance command as a tracking reference the control input u can be determined using steering and speed controllers later in this section a detailed description of the proposed drl based collision avoidance system will be provided 3 2 1 semi markov decision process for the mathematical model of decision making we adopted a semi markov decision process smdp proposed by sutton et al 1999 in smdp the concept of action is temporally extended from that of the markov decision process mdp thus the smdp model can address more sophisticated behavior the action behavior of the proposed drl network is defined as high level behaviors such as path following starboard avoidance and port avoidance instead of instant low level action such as steering control command by selecting the smdp as a base model we can restrict the drl network s role as a behavior selection isolate it from the calculation of control command because of this approach the decision making and control processes can be separated which enables the systematic analysis of the drl based simulation or experiment besides mathematical stability analysis of the low level controller can be conducted by selecting the conventional control algorithms such as pid or lqr controller instead of direct control from deep neural network to address the collision avoidance problem we formulated components of the smdp state action and reward in the following manner firstly the state of the smdp should include all the necessary information to judge collision risk and situation this information includes the target path relative position and velocity of obstacles and own vehicle in this work we suggested a state representation of a visual grid map obstacle image to represent the geometric information of the encountered situation as such we can provide more intuitive information to the drl network and exploit the deep neural network s image recognition capability to understand and assess encountered situations fig 4 illustrates an encountered situation and the corresponding grid map representation the grid map is composed of three layers that contain information on the target path dynamic moving obstacle and static obstacle respectively in this work instead of merging all information into a single channel we intentionally separated each layer in order to prevent it from mixed or overlapped by other layer information according to fig 4 there exists a body fixed virtual window 336 336 m sized fixed to the vehicle and any features obstacle or target path inside this window is represented in the corresponding grid map layer 84 84 pixel sized using an intensity value between 0 and 255 for simplicity of representation of the obstacle using a grid map both the static and dynamic obstacles are assumed to have a circular shape as expressed in fig 4 in the case of the path layer a relative path representation inside of the virtual window is expressed given that the static obstacle and target path are stationary the provision of relative positional information is sufficient to facilitate avoidance decisions however for dynamic obstacles the velocity of the dynamic obstacle should be considered in the avoidance decision process to express the velocity information a line that represents the direction of the obstacle s velocity is included as shown in fig 4 in the dynamic obstacle layer the length of the line is defined as being proportional to the speed of the corresponding obstacle as such if a target obstacle moves with a high speed a relatively long line will be represented in the dynamic obstacle layer so that the drl network can recognize the temporal dependent information using a single image layer although the grid map represents path and nearby obstacle information some of the own vehicle statuses cannot be expressed using the grid map this information includes speed angular late and the thruster rpm of the own vehicle in the problem of usv collision avoidance such information can be directly accessible from the on board devices installed on the usv such as gyro gps and control computer to feed these information to the network an additional low dimensional state vector is utilized in the work of mnih et al a stack of 4 consecutive images was used as an input state to implicitly express the temporal information however in our configuration there is no need for stacking a series of images since the temporal information is already provided to drl network by using the low dimensional state input by combining these two kinds of states both the grid map and the low dimensional state vector the state of the smdp represents the current situation as a result of the collision avoidance decision making process the proposed drl network selects the desired behavior of the vehicle in an encountered situation and the guidance command is calculated from the corresponding guidance law we define three behavior candidates path following starboard side avoidance and port side avoidance for the path following behavior the vector field guidance vfg method proposed by nelson et al 2007 is utilized to determine the guidance command fig 5 a illustrates a schematic description of the vfg method while eq 7 represents the desired course angle command calculated using the vfg method in the equation χ and k represent the maximum course angle variation for path following and convergence rate tuning parameters respectively χ p a t h represents the direction of the target path defined in the inertial reference frame the cross track error e y of the vehicle to the target path can be calculated using the eq 9 7 χ d χ t a n 1 k e y χ p a t h 8 d w k 1 y u s v y k 1 2 x u s v x k 1 2 9 e y s i n χ p a t h a t a n y u s v y k 1 x u s v x k 1 d w k 1 for avoidance path planning we used the vo approach described in section 2 3 to include the avoidance direction selection process in the decision making process we separated the different avoidance direction as independent behaviors in this regard we defined separate prohibited velocity regions in the vo for each avoidance direction as illustrated in fig 5 b and c the desired speed and course angle can then be selected from the remaining safe velocity space after the desired behavior is performed it should be evaluated using the reward function to train the policy of the drl network to address the ship collision avoidance problem the reward function of the smdp was defined as follows we established that there exists three types of rewards for path following collision avoidance and penalty denoted as r p a t h r a v o i d and r p e n a l t y respectively the reward for path following r p a t h is a positive reward that is inverse proportional to the cross track error of the vehicle towards the target path e y r p a t h is included in the reward composition in order to prevent unnecessary or premature avoidance maneuvering of the vehicle r p a t h is defined by the following equation where k r p a t h is a parameter to tune the sensitivity for the case when the drl network conducts path following behavior the final reward r is defined as r r p a t h 10 r p a t h e x p k r p a t h a b s e y due to the positive reward of path following the vehicle tends to follow a path when the collision risk is relatively low in addition by imposing a positive reward for appropriate collision avoidance maneuvering r a v o i d the vehicle can be guided to perform desirable avoidance maneuvers when a collision is imminent the important aspect of this process is that the efficacy of the avoidance maneuver varies according to the starting time of the collision avoidance if the avoidance procedure is performed too late the vehicle may encounter a risky situation or fail to avoid the collision in contrast if the procedure is implemented too early the vehicle may perform unnecessary avoidance maneuvers although it is still safe to follow the target path the suitable moment to initiate an avoidance action differs for each situation encountered thus a reward function should be appropriately designed to facilitate the capture of the required moment by the agent for conducting an avoidance maneuver to achieve this requirement we have categorized encounter situation into two groups in the first group it is assumed that the vehicle should perform avoidance maneuvers as soon as the obstacle is recognized according to the cpa information as illustrated in block 3 of fig 3 this is the case where the crossing give way and overtaking situations should be included because of the give way status of the own vessel in such cases it is important to perform instant avoidance motion to provide prompt avoidance intention to the obstacle vehicle in this case the reward for the avoidance maneuver r a v o i d is calculated using the following equation where k r a v o i d is the sensitivity tuning parameter and t c p a c u r r e n t refers to tcpa at the instance of avoidance the t c p a t h r e s h is defined as the threshold tcpa value used in block 2 of fig 3 to determine the conservative list of the alert obstacle 11 r a v o i d e x p k r a v o i d a b s t c p a c u r r e n t t c p a t h r e s h for the other group we assumed that the own vehicle should hold on to avoid until achieves the appropriate avoidance time this is the case for the head on crossing stand on and the static obstacle is included in comparison with the first group this group of the encounter situation has a relatively large temporal margin until the own vehicle performs avoidance for the case of the head on situation both the own vehicle and the obstacle vehicle are give way vessels thus instead of performing an instant avoidance maneuver we concluded that it is more important to provide clear and obvious avoidance intention to the obstacle vehicle by performing a large course angle change when collisions are avoided using the vo method if the avoidance maneuver is performed too early it tends to be ambiguous due to the small change in the course angle myre 2016 noted that this characteristic of the vo method degrades the quality of the avoidance process thus in this work we determined that the avoidance moment during the head on situation should produce 30 degrees of course angle change to provide clear avoidance intention to the obstacle ship in crossing stand on encountered situations colregs suggest that the own vehicle should maintain its course unless it is evident that the stand on vessel does not perform proper avoidance maneuver in this case despite the status of the stand on vessel the own vehicle must perform appropriate avoidance maneuvers to avert a catastrophic accident to reflect this regulation we determined that the avoidance moment during the crossing stand on situation should produce 75 degrees of course angle change as such the vehicle in the crossing stand on receives a maximum reward value when the implemented course angle change of the avoidance maneuver is 75 degrees it is the domain of the drl leaning process to identify which temporal moment of the avoidance results in the maximum reward for the case of the static obstacle we determined that the avoidance moment during the encountered situation should produce 45 degrees of course angle change such thresholds for the course angle change for different situations are determined by trial and error for several collision avoidance simulations in this group the reward for avoidance maneuver r a v o i d is calculated using the following equation where χ ˆ a v o i d represents the change of the course angle due to the avoidance maneuver and χ ˆ d refers to the desired change in the course angle value according to the corresponding situation for the case when the drl network conducts avoidance maneuver the final reward r is defined as r r a v o i d 12 r a v o i d e x p k r a v o i d a b s χ ˆ a v o i d χ ˆ d in contrast to the positive reward previously mentioned there is also a negative reward for penalty term this penalty reward is active when the vehicle collides with any obstacle or violates the colregs rule during the avoidance maneuver the reward for penalty is defined as the minimum reward value 1 thus r p e n a l t y 1 if any obstacle collision or colregs violation event occurs the reward for the behavior performed is defined as r r p e n a l t y and the learning episode is automatically terminated 3 2 2 deep reinforcement learning network fig 6 illustrates the structure of the proposed drl network in order to suppress the overestimation phenomenon and stabilize the learning process we have adopted the network structure of the dual dqn proposed by wang et al 2015 and double dqn structure van hasselt et al 2016 suggested by hasselt et al in addition to consider non visual information and temporal information such as speed and yaw rate of the own vessel we have constructed input layer for the low dimensional state to train the proposed collision avoidance drl network we performed repeated rl simulations during the simulation experience tuples s a r s are collected into the experience buffer until the number of the tuple reaches to maximum buffer size in this case 750 000 in every training steps a mini batch of the tuple set is randomly selected and will be used as a training data for policy update once the simulation based training process was complete the trained drl network model will be implemented in a real world platform for validation experiments therefore precise modeling of the simulation environment is a crucial aspect to guarantee the performance of the simulation based on the trained drl network in a real world regime in this regard we adopted a dynamic model derived from the system identification experiment woo et al 2018 to reflect the maneuvering characteristics of the research target usv platform in addition the time delay and the measurement noise of the navigation sensor and sampling rate are considered to improve the reality of the simulation in the rl problem the exploration strategy is one of the most important design factors to increase the effectiveness and stability of the learning process in this work we utilized the smdp model to handle temporally extended behavior e g path following guidance instead of instant action e g course angle as a result of this difference the conventional exploration strategy that is typically used to solve the mdp problem such as epsilon greedy exploration cannot be directly applied in the single vessel collision avoidance scenario a single appropriate avoidance behavior is required to avoid the target obstacle the purpose of the rl is to determine the appropriate time required for avoidance during the episode thus the exploration strategy should focus on the uniform exploration of avoidance behavior with respect to the temporal period in an episode instead of the uniform exploration of the action space each time step as in the case of the epsilon greedy exploration strategy to reflect such a difference we propose an exploration method that is applicable to the drl based ship collision avoidance problem 1 similar to the epsilon greedy exploration the epsilon value ϵ is selected the epsilon value gradually decreases during the progression of the training process 2 once an obstacle is classified as an alert obstacle according to the cpa information the tcpa of the alert obstacle is calculated t c p a i n i t 3 exploration is performed with a probability of ϵ during the exploration a tcpa value t c p a e x p which is a randomly selected value between 0 to t c p a i n i t is calculated 4 in the case of the exploration avoidance behavior is implemented when the t c p a i n i t of the obstacle is less than t c p a e x p if there exist multiple avoidance behavior candidates the direction of the avoidance is randomly selected for uniform training of the drl network in various situations we composed a single episode of the rl as a combination of six different sub episodes for different encountered situations each sub episode is in charge of 1 head on 2 crossing give way 3 crossing stand on 4 overtaking 5 multiple static obstacles and 6 multiple dynamic obstacle encounter situations the initial position and velocity of the obstacle are randomly selected within a predefined range of corresponding encounter situations fig 7 describes the training result for the drl network with respect to the collision avoidance scenario the x axis of the figure represents the training time whereas the y axis represents the episodic reward which indicates the efficacy of the agent usv in avoiding collisions episodic reward is defined as the sum of each of the six sub episode rewards in fig 7 the red solid line represents the moving average of the episodic reward for 200 episodes window while the green shaded region represents the standard deviation of the episodic reward within the moving window the training result of fig 7 is achieved from a single training process conducted for approximately 110 h the number of total training steps is 800 000 steps and it took about 0 5 s for a single step of the drl based on the training we can verify that the effectiveness of the drl network in collision avoidance increases with training after a certain time period the slope of the performance index converges to approximately zero and the policy converges to the final policy the training process of the drl network is performed using the tensorflow framework and the adam optimizer is used for optimization during training to train the drl network a desktop pc with a 6th generation i7 3 40 ghz cpu 16 gb ram and a geforce gtx970 gpu was used 4 validation in this chapter we provide validation results for the proposed collision avoidance method before directly implementing the trained policy network for collision avoidance simulation we attempted to evaluate the validity of the proposed method using several approaches these included an assessment of the collision risk and the saliency map after this process several collision avoidance simulations and full scale usv experiments were performed for different encountered conditions to evaluate the effectiveness of the proposed method and verify its applicability in the real world domain 4 1 research target usv in this study we selected a 14 ft wave adaptive modular vessel wam v type usv as the research target an wam v usv is catamaran shaped usv and composed of two pontoon based hull and upper deck there are two suspensions between the upper deck and each pontoon which are designed to minimize wave induced motion of the upper deck this usv has a length of 4 88 m and a breadth of 2 5 m thrust is produced by two electric motors mounted on each hull and the maximum speed of the vehicle is up to 5 knots since the direction of the thrust force is fixed the vehicle can generate steering control moment by generating rpm differences for the port and starboard side thrusters fig 8 shows an image of the wam v platform used in this work as the research target vehicle woo et al 2018 recently conducted a dynamic system identification of the identical wam v platform in this work a dynamic model of the wam v usv was derived based on system identification experiments thus for the collision avoidance simulation environment we used the dynamic system suggested by woo et al 2018 4 2 collision risk assessment once the training process was completed we utilized the trained network to estimate the collision risk hasegawa and kouzuki 1987 ahn et al 2012 for verification of the situation awareness capability under a given input situation by definition the collision risk is an index that describes the negative extent of the encountered situation this is the opposite definition of the value function in reinforcement learning a value function is defined as the accumulated future reward intuitively this term describes the positive extent of the encountered situation thus by reversing the sign of the value function and normalizing the term with a maximum value v m a x as eq 13 we define a collision risk c r using the value function v s of the reinforcement learning network 13 c r v m a x v s v m a x v m i n for collision risk estimation we performed virtual experiments by applying arbitrary input data to the drl network by analyzing the output value function of the corresponding input situation encountered the recognition ability of the proposed method can be verified for the virtual experiment we defined 5000 encounter situations as input data in each encountered situation a single obstacle ship is located the speed and course angle of the obstacle vehicle are fixed as the negative y axis direction and 1 5 m s respectively for the relative position of the obstacle vehicle the range of the initial lateral position is defined as 168 to 168 and the variables are divided into 100 equal steps the range of the initial longitudinal position is set as 0 to 168 and is divided into 50 equal steps fig 9 shows a color representation of the collision risk estimation result with the corresponding obstacle ship location based on the virtual experiments we can determine that the collision risk tends to be high as the distance to the obstacle ship become is reduced in addition the proposed method recognizes that an obstacle ship on the port side has a higher collision risk than an obstacle ship on the port side a similar tendency was also observed in previous works such as the asymmetry ship domain proposed by coldwell 1983 goodwin 1975 and davis et al 1980 this tendency is due to the influence of colregs according to colregs in most of the encountered situation a ship must perform a starboard side turning maneuver to avoid the obstacle vehicle however if there is an obstacle on the ship s starboard side the vehicle tends to be exposed to a more risky situation during collision avoidance as a result of the iterative learning process the agent can discover such tendency on its own without prior knowledge 4 2 1 saliency map analysis as described in section 3 2 1 we processed maritime traffic encounter situation information to produce visual information using a grid map this visual information is then used as input data of the convolutional neural network cnn layer when the cnn analyzes the current encounter situation we can determine the regions of the grid map that the cnn focuses on using a saliency map using this tool we can visualize the active region of the input grid map simonyan et al 2013 proposed a systematic approach for obtaining a saliency map based on the jacobians of the trained value function of the drl with respect to the image pixel if there is a higher jacobian in a certain region of an image this implies that visual information in this region has a significant effect on the value function for the validation purpose we produced two encounter situation grid maps virtually and used them as input images for the reinforcement learning network fig 10 shows a comparison result for an encounter situation grid map and the corresponding saliency maps there are two grid maps one without obstacle and another one with an obstacle near the vessel in the first case the reinforcement learning network focuses on the region where the own vehicle is located and the overall both the forward and behind side region of the target path moreover once there is an approaching dynamic obstacle in front of the own vehicle the network tends to focus more on the region where the obstacle is located instead of the behind side region of the target path 4 3 collision avoidance simulation during the collision risk assessment and saliency map analysis we verified the applicability of the proposed method for the collision avoidance problem however to evaluate its effectiveness during the collision avoidance stage corresponding simulations should be performed in the collision avoidance simulation we assumed that the obstacle information is provided by other perception devices from the perspective of ship collision avoidance problem the level of uncertainty tends to be high when there is a large number of obstacles near the vehicle this is because the ship collision avoidance problem is a decision making problem in which previous decisions affect future events as a result an acceptable avoidance maneuver decision made in the past may have a catastrophic result in the future considering a collision avoidance scenario with multiple ships as described in fig 11 firstly the usv should avoid an obstacle vehicle location in front in the case of an overtaking encounter situation obs1 behind the obs1 two obstacle vehicles are approaching toward the usv with head on encounter situation obs2 and obs3 according to the colregs either port or starboard side avoidance maneuvers are acceptable to avoid the obs1 overtaking encounter situation since the obstacle ship is located on the port side of the usv an avoidance maneuver with starboard side turning is desirable considering the relative position of the obs1 and target path however once the usv performs the starboard turning maneuver the vehicle will encounter obs2 and obs3 and it will have to perform successive avoidance maneuvers to avoid a collision this is a typical example of a decision making problem to address these issues decisions should be made based on the expectation of future events according to the current action choice unlike the conventional approach the proposed drl based collision avoidance method can foresee future situations using the action value function that was trained via repeated collision avoidance simulations for the validation of the proposed method we performed collision avoidance simulations for the encounter situation described in fig 11 using both the proposed method and conventional approach for the conventional method a cpa based collision risk assessment method suggested by hasegawa and kouzuki 1987 and the velocity obstacle method kuwata et al 2014 for path planning were used fig 12 describes collision avoidance simulation result based on conventional approaches as the usv faces the overtaking vessel obs1 the kinematic information of the usv and obstacle vessels are transformed into cpa based parameters using the calculated tcpa and dcpa an encounter situation was considered as an alert situation at approximately 5 s when considering the current encounter situation a starboard side avoidance maneuver is determined using the vo method although the vo method can address the path planning of multiple vessels the effect of obs2 and obs3 when considering the avoidance maneuver for obs1 is limited due to the large distance to obs2 and obs3 after avoiding obs1 the usv encountered obs2 and obs3 and successive avoidance maneuvers were performed to avoid collisions fig 13 represents the collision avoidance simulation results obtained using the proposed method in an identical scenario in this case once the usv encounters the obs1 it can determine the likely outcome if a starboard maneuver is performed to avoid a vehicle based on the current encounter situation grid map thus instead of performing a starboard turning maneuver the vehicle turned to the port side in order to avoid obs1 the port side avoidance maneuver seems to be inefficient when considering obs1 only however considering the encounter situation the maneuver is a far more efficient and safe avoidance maneuver based on experiences during the training stage the proposed drl network can develop the ability to understand and interpret complex ship encounter situations on its own this ability to predict imminent risk under the complicated encountering situation is one of the most distinctive characteristics of this proposed method such ability is one of the most crucial aspects of autonomous ship collision avoidance this is because most ship collision incidents occur when there is a high level of uncertainty due to complex and ambiguous encounter situations to deal with such complexity a high level decision should be made using the entire complex encounter situation information however conventional collision risk assessment methods both cpa and ship domain based collision risk assessment methods cannot provide such information because these approaches tend to simplify the encounter situation when conventional collision risk assessment interprets complex and ambiguous encounter situation the encounter situation is parameterized into a few parameters during the parameterization most of the delicate and complex information is diminished and diluted into a few parameters on the contrary the proposed drl based method uses the complete information of the current encounter situation to make collision avoidance decisions therefore it can recognize complex encounter situation fig 14 schematically illustrates such difference between conventional approaches and the proposed method 4 4 collision avoidance experiment to validate the proposed collision avoidance decision makingmethod in the real world we performed free running experiments with a full scale usv for the experiment we utilized the trained drl model network that was used during the validation simulation and deployed the network into the usv control system using the parameters from the extracted drl network the action value function advantage of each behavior candidate can be calculated in real time for navigation of the usv we used navigational sensor information such as dual frequency gps novatel smart6 and an ins sensor microstrain 3dm gx3 for the obstacle perception we assumed that there are virtual obstacles in the experimental site to simplify the range of the research in real world application we defined constant velocity obstacle models and calculated the obstacle s kinematic information based on the running time of the experiment the free running experiment was performed in lake pyoungtaek and the wam v usv platform is described in section 4 1 was used as the target usv platform for experimental validation of the collision avoidance capability of the proposed method both the single obstacle ship head on and overtaking encounter situation and multiple obstacle ship scenario were selected as experimental scenarios 4 4 1 head on encounter scenario in the head on encounter scenario we defined a head on encounter situation with an obstacle ship approaching the usv with a ship speed of 0 8 m s fig 15 represents the experimental result for collision avoidance during the head on encounter scenario the red dotted line represents autonomous experimental results and the green solid line represents the corresponding simulation results for identical initial conditions of the usv and obstacle the avoidance maneuver was performed when the distance between the two vehicles was approximately equal to 65 m and the maximum course angle change was measured as 46 in the reward function designing process the desired course angle change was defined as 30 however the measured course angle change tends to have a higher value we concluded that this is due to the different dynamic characteristics of the controller in the usv platform and simulation given that the dynamic model identification process performed by woo et al 2018 was limited to open loop system identification the controllers in both the real world plant and the simulation were independently designed and tuned in the experimental results a higher overshoot level of the tracking error is determined for the course angle at 15 s at 31 s oscillatory motion of the course angle occurred based on detailed analysis it was determined that this is because of the modeling uncertainty or environmental disturbances as a result of the collision avoidance during the experiments and simulations the usv returned to its target path in the case of the experimental results there is a delay of approximately 4 s between the moment of recovery and the target path compared to the result of the simulation this tendency is due to the repeated oscillatory motion of the course angle given that the usv is a differential thruster type vehicle to produce a steering control moment the rpm of the port and the starboard side thruster should be changed as a result of the rpm change a speed reduction may occur and the recovery time may be delayed despite the temporal difference the usv was able to stably avoid the obstacle ship in both the experiments and simulations with the guarantee of a predefined avoidance range margin of 25 m fig 15 right shows the snapshot trajectory of the usv and obstacle ship during the head on encounter collision avoidance experiment as well as aerial images of the conducted experiment 4 4 2 overtaking encounter scenario fig 16 illustrates the experimental results for the overtaking encounter collision avoidance scenario for the initial condition we the obstacle ship was set to head north 90 which is same as the usv and speed of the obstacle ship and the usv were set as 0 4 m s and 1 5 m s respectively in the case of the overtaking encounter scenario the avoidance maneuver was performed over a wide area due to the low relative velocity based on the experiments the course angle overshoot error which was found in the result of head on scenario can also be determined however the usv tends to guarantee a predefined avoidance range margin of 25 m throughout the entire maneuvering process due to the slow relative velocity the simulation and experiment results tend to have a small trajectory error by examining the trajectory point at 125 s it was determined that there is 6 m of difference in the usv position between the experiment and simulation as indicated in the case of the head on scenario we determined that this is due to the speed reduction in the experiment caused by the oscillation of the course angle fig 16 right describes the snapshot trajectory of the usv and obstacle ship and the aerial snapshot acquired during the overtaking experiment 4 4 3 multiple ship encounter scenario fig 17 illustrates the initial condition for the multiple ship avoidance scenario in this encounter situation three obstacle vessels are defined as obstacles of the usv according to the course angle change described in fig 18 the initial avoidance maneuver starts approximately at 10 s in both the experiment and simulation the usv then returns to the target path at approximately 70 s at this instance it is evident that there is 6 m of difference between the position of the usv in the simulation and experiment fig 19 the usv tends to follow the target path for 82 s then encounters the second obstacle ship at that instance the usv in the simulation is ahead of the usv in the experiment therefore the former starts to perform avoidance maneuvers relatively early these differences in the starting time of collision avoidance for different collision avoidance trajectories are as illustrated in the snapshot trajectory fig 19 at 110 s once the usv returns to the target path at approximately 140 s it encounters an obstacle ship in an overtaking situation to overtake the vehicle the usv starts to perform a starboard maneuver according to the trajectory result described in fig 18 it can be inferred that the corresponding avoidance in the simulation was performed at an earlier moment compared to the experiment fig 18 depicts a snapshot of the vehicle s trajectory during each encounter situation of the scenario 5 conclusion in this work we proposed a drl based collision avoidance decision making algorithm and conducted simulations and experiments to validate its effectiveness in the proposed method a usv recognizes its nearby environment using a grid map representation of the encountered situation the generation of this information using a visual grid map representation is one of the crucial aspects of the proposed method by providing information on the convolutional neural network cnn the feature extraction capability of the cnn can be adapted to develop an intuition for collision situation awareness to consider colregs in the process of the collision avoidance decision we designed reward functions for the drl network with respect to each encountered situation the resulting drl network was trained based on repeated collision avoidance simulations it is therefore able to reflect experiences during various encounter circumstances as a result of this work we can state the following conclusions according to the collision risk assessment analysis it was determined that the proposed method can identify the risk of collision in a similar manner to conventional approaches for example the proposed method recognized the asymmetric characteristic of the collision risk highlighted in previous works coldwell 1983 goodwin 1975 davis et al 1980 via repeated collision avoidance simulations the proposed method can recognize complex and ambiguous situations with multiple obstacles in addition it can empirically foresee future risk of collision when considering avoidance action candidates the proposed method can select a suitable avoidance strategy according to the type of encounter based on the colregs there are a variety of avoidance requirements for different encountered situations the proposed method can consider such difference by independently designing the reward function throughout the full scale usv collision avoidance experiments under various scenarios the applicability and the effectiveness of the proposed method in the real world domain was verified although there are several merits there are also a few limitations of the proposed system given that the proposed method repeatedly performs reinforcement learning on a high dimensional state grid map visual information this requires hundreds of hours of training in addition the application of the trained drl network is affected by the uncertainty of the modeling of the vehicle because the training process is performed in the simulation environment if the usv can be trained in a real world environment this limitation will be overcome for future work we are planning to consider the effect of environmental load in making collision avoidance decisions in order to increase the reliability and effectiveness of the proposed method in a real world domain in addition we are considering extension of the action space to ship s speed control as well as steering control this approach will be effective especially under the multi vessel encounter scenario credit authorship contribution statement joohyun woo conceptualization methodology software writing original draft writing review editing nakwan kim supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
22062,this paper presents the hydrodynamic optimization study of ceco a point absorber wave energy converter wec with sloped motion to maintain the overall costs the characteristic dimensions of the optimized solution were not allowed to change significantly instead different geometrical shapes have been generated and numerically investigated based on the exhaustive search method with a heuristic approach the assessment of the different geometries was based on a new index the hydrodynamic capacity for wave energy conversion which considers that the theoretical maximum wec s absorbed power from irregular waves is obtained assuming that for each individual wave component of the sea spectrum the pto system can operate with its optimum damping coefficient the optimum geometry obtained is able to harvest twice as much wave energy than the original design of ceco the numerical outcomes have been validated with the results of experimental tests with the new geometry unlike pure heaving wecs a sloped motion wec can achieve natural oscillation periods within a broad range by controlling the inclination of the motion path the submergence level or the shape of its floaters therefore ceco can be tuned to any given sea state and avoid the need for active complex control strategies keywords ceco exhaustive search method wec tuning experimental testing frequency domain modelling hydrodynamic efficiency 1 introduction the global energy demand is expected to grow by more than 25 to 2040 iea 2018 in addition the share of renewables in energy generation should rise to over 40 by 2040 from 25 today which is essential in securing a sustainable future for the planet ocean wave energy in spite of being on a pre commercial stage has the potential to provide utility scale power production in the future due to the huge global offshore wave power resource estimated at approximately 32 000 twh yr reguero et al 2015 that potential could be used to provide about 10 of the europe electricity needs by 2050 rusu and onea 2018 suppling not only the onshore grids but also offshore activities oliveira pinto et al 2019 a large variety of technologies to convert wave energy has been developed and tested but a dominant concept was not found yet taveira pinto et al 2015 however some promising designs are presently undergoing detailed optimization studies and demonstration testing at open sea therefore approaching the commercial phase e g liang et al 2017 moretti et al 2020 sheng et al 2017 a key variable in the optimization of a wave energy converter wec is the amount of power absorbed which shall take into account the wave climate at the installation site in this process the wec is often tuned so that its natural period of oscillation matches the most probable sea state period or that with the higher amount of energy on a yearly basis at the point of interest however the characteristics of the power matrix also have an important influence on the annual power absorption of the wec de andres et al 2015 this explains why in some studies the optimization is done so as to harvest the maximum power over the largest range of periods possible considering the wave climate at site shadman et al 2018 the two main alternatives to adjust and optimize the performance of a wec are i the modification of the physical characteristics of the device e g size mass or geometry which has a direct impact on its natural oscillation periods and ii the control of the power take off pto system which consists in the modification of the wec absorption characteristics over time to maximize its power production the tuning of wecs to the prevailing sea states can be done in different ways depending on the type of device namely by modifying the inertia of the system e g flocard and finnigan 2012 the mass distribution e g meng et al 2019 the geometry of floating bodies e g goggins and finnegan 2014 the mooring system characteristics e g paredes et al 2016 the pto inclination angle e g lópez et al 2018 or the pto characteristics e g shi et al 2019 xiao et al 2017 moreover different pto control strategies are available to maximize power production ozkop and altas 2017 namely the passive loading control the latching control and the reactive loading control however in contrast to the characteristics of the pto system stiffness and or damping the physical characteristics of the wec are often more difficult to vary according to the incoming waves and therefore are defined first different approaches of varying complexity can be applied in the optimization process of wecs in a simplified form the main goal is to maximize the mean absorbed power while the construction costs are minimized to reach the tradeoff between multiple goals multi objective optimization techniques can be applied namely those based on genetic e g alamian et al 2019 mccabe 2013 or differential evolutionary algorithms e g blanco et al 2019 other alternatives are the sequential optimization procedures in which the optimal parameters are set in a consecutive manner bouali and larbi 2017 or the optimization approach based on exhaustive search and driven by constrains to reduce the number of variables and simplify the optimization process in this last case if constrains are incorrectly chosen inappropriate results may be obtained as garcia rosa et al 2015 demonstrated when analyzed the impact of pto restrictions on the shape optimization of a heaving buoy since different control strategies resulted in different optimal geometries the geometry optimization is of relevance for all classes of wecs since it determines the hydrodynamic characteristics of the fluid structure interaction therefore to ensure that a wec works efficiently at a given site its geometry is often considered the first variable for the optimization of its design bozzi et al 2018 esmaeilzadeh and alam 2019 to maximize the absorbed power and the absorption bandwidth of a heaving point absorber shadman et al 2018 optimized the draft and diameter of the floater while maintaining its natural period close to the predominant wave periods at site using a frequency domain method the pto was assumed to be a pure damper and its damping frequency independent and equal to the hydrodynamic damping of each floater shape at its resonant frequency to maximize the power absorption at that frequency pastor and liu 2014 optimized also a point absorber by testing different shapes drafts and diameters of the buoy taking into account the wave conditions of the deployment site near the gulf of mexico the pto control parameters i e spring and damping coefficients were adjusted to tune the wec to the incident wave conditions and therefore to maximize its power absorption goggins and finnegan 2014 presented a methodology for the geometry optimization of a floating axisymmetric point absorber which considers 6 basic geometric shapes derived from a vertical cylinder and have used the average annual wave energy spectrum for the case study location offshore the west coast of ireland an ideal linear damper was used where the pto damping coefficient is maintained constant since this approach facilitates the dynamic response calculation in the frequency domain the optimum damping was determined so as to maximize the mean power absorbed at the reference site even though the classical linear approach allows defining an optimum pto damping coefficient that maximizes the absorbed power for each particular wave period the use of a single optimum damping coefficient for the whole set of waves that compose a given sea spectrum is questionable if the maximum power output is envisioned in the geometric optimization work the assessment of the power absorbed considering that the pto system is operating with its optimum damping coefficient for each individual period of the wave spectrum would have the benefit of allowing to obtain the maximum power output for each tested geometry avoiding the arbitrariness of choosing a particular damping coefficient the advancement of computational resources facilitates the application of optimization methodologies the computational fluid dynamics models based on the navier stokes equations allow considering the effect of all relevant nonlinearities on the hydrodynamic analysis e g wave breaking surface piercing vortex shedding but are still not a cost effective tool to be used in cases where a systematic analysis of a large number of variables needs to be done nonetheless such models were already applied in some optimization studies of wecs e g shi et al 2019 on the other hand the use of frequency domain hydrodynamic methods linear based on potential flow theory in the optimization of wecs has two important advantages a smaller computational cost and the possibility of carrying out systematic analyses considering a wide range of physical characteristics of the wec a large number of examples can be found in which those models were used in the optimization process e g goggins and finnegan 2014 piscopo et al 2016 shadman et al 2018 tom et al 2016 time domain models are however recommended in the more advanced development phases to validate the characteristics the optimized wecs this paper presents the hydrodynamic optimization of the floaters of a sloped motion wec ceco since the original geometry of the floaters was intuitively defined an exhaustive search method with a heuristic approach is used to improve its ability to harvest wave energy in order to maintain the costs of the different solutions in the same order of magnitude the characteristic dimensions of ceco were not changed significantly the different geometric shapes were assessed numerically and then compared using a new hydrodynamic efficiency parameter the index of hydrodynamic capacity for wave energy conversion the optimum geometry of the floaters has been validated experimentally 2 ceco s working principle the wec concept for the present study ceco is a point absorber that harvests wave energy from the translational motions of its floaters along a straight sloped path defined by the inclination of the guiding rods fig 1 ceco consists of two structures a moving part composed of two lateral floaters attached to a central connecting frame and a fixed reference structure that houses the power take off system when the moving structure is excited by the waves its sloped oscillatory motion is converted into rotations by a rack pinion mechanism the rack is attached to the connecting structure while the pinion is connected to a dc generator s shaft finally rotations are converted into electricity by the dc generator which is fixed and housed in the reference structure for the sake of simplicity the axis of the central cylinder is installed perpendicular to the motion path of the floaters the most outstanding features of ceco concept are its ability to harness energy from both surge and heave modes simultaneously and as shown in previous studies e g rodríguez et al 2019b rosa santos et al 2019b the possibility of tuning the natural frequency of the wec motion with the angle of its translation path the nominal design inclination and submergence volume of the floaters was 45 and 60 respectively for this condition the free oscillation frequency of ceco s floating part is around 8 s table 1 presents the main dimensions and nominal operational parameters of ceco 3 optimization strategy the standard form of the general optimization problem is typically represented by the objective or goal function and the constraints both are defined in terms of design variables which in the optimization process are modified to obtain the optimum in the literature several references can be found describing a large number of optimization techniques that exist for engineering optimization applications e g coello coello 1999 onwubolu and babu 2013 rao 2019 venter 2010 in general depending on the complexity of the objective function the associated constraints and the optimization technique the optimization process requires substantial computational effort in this study the objective function is the absorbed power of the wec which is intrinsic to its hydrodynamic response in other words the complexity of the objective function and the associated constraints depends on the type of the adopted hydrodynamic model lópez et al 2017a 2017b have performed time domain simulations using a nonlinear numerical tool based on the potential flow theory although that approach is expected to be more accurate for the analysis of wave body interaction it still demands substantial computational effort when body dynamics in irregular wave conditions are required more recently rodríguez et al 2019a used a frequency domain linear numerical model for the assessment of damping coefficients for regular and irregular wave conditions from model tests their results compared very well with those from the respective time domain nonlinear approach with much less computational time therefore the frequency domain approach was considered adequate for the hydrodynamic optimization process a significant amount of computational cost can be further saved if the design variables are considered as deterministic variables at their reference values i e the number of analyses is reduced by systematically fixing unessential design variables throughout the optimization process kim et al 2004 the term unessential may not necessarily refer to irrelevant design variables but to variables whose effect can be assessed easily and independently of the other design variables the behavior and effects of these unessential variables may be predicted in advance through preliminary analyses 3 1 optimization scope and criteria the results of previous studies with ceco highlighted the fact that its original design was not suitable for the wave conditions typical of the most energetic coastal stretches of the target sea site for example the northern portuguese coast ramos et al 2017 rosa santos et al 2019b in this context the first objective of the optimization task is to adapt the geometry of ceco so that its natural period of oscillation becomes resonant with the period of the target sea condition to improve its efficiency for wave energy harvesting since the focus is the hydrodynamic performance associated to wave energy extraction the criteria for the assessment of the alternative geometries to be analyzed in the optimization process in principle can be expressed by the response amplitude operator rao of the motions of the floating part considering only its inherent damping i e without the pto effect the efficiency in the wave energy absorption for the target sea condition the first criterion assesses the capacity of the wec for the conversion of wave excitation into motions the greater the motions the greater the available power that can be absorbed by the pto system typically the peak of the rao curve is obtained when the wave excitation period matches the natural period of the system i e at resonance therefore the tuning between those periods is a key parameter in the optimization of wecs the second criterion is related to the conditions of maximum power absorption specified in the traditional approach however there are two important aspects that should be highlighted first in the present approach the second criterion refers to a given sea condition i e irregular waves with random heights and periods while the traditional approach is based in regular waves single wave period and amplitude in irregular waves there is no uniform distribution of wave energy indeed wave energy is unevenly distributed over a wide range of periods although concentrated around the peak period of the sea spectrum so the wec that maximizes wave power absorption is not necessarily the one whose natural oscillation period matches the sea spectrum s peak that wec in fact can present a very high sharp peak of absorbed energy at its resonant period but it may not absorb a significant amount of energy at the other periods of the sea spectrum in contrast a hypothetical wec with its resonant period detuned from the sea s peak period may absorb a larger amount of wave energy resultant from the overall contribution of a number of other components of the wave spectrum to explain the latter case the dynamic behavior of the wec along the wave frequency domain should be considered the aim is to keep the wec motions significant in a broad range of wave periods by putting for instance the sea s peak period to excite oscillation periods at which the wec does not display sufficiently large motions and the periods of smaller wave energy to excite the resonant period of the wec the wec s motion will not be the largest in any case but the system will be able in principle to absorb a larger amount of wave energy by adding the individual contributions from a broader range of periods the second aspect is related to the pto damping coefficient and the definition of the captured power efficiency for the wec under irregular waves as known the amount of absorbed energy is directly dependent on the level of damping of the pto system for regular waves the classical linear approach provides an optimum pto damping coefficient that maximizes the wec s absorbed power for each single regular wave period if this approach is applied to a passive wec in irregular waves a challenge arises because a single optimum pto damping coefficient should be chosen for the whole set of waves that compose the given sea spectrum the selection of that pto damping coefficient can be arbitrary but is limited by the range of damping levels that the actual pto system can provide especially at the peak period of the wave spectrum and at the wec s resonant condition however intermediate values may not be disregarded since an overall optimum condition is sought for the full range of periods of the wave spectrum for the assessment in the optimization study this dependence on arbitrarily chosen values of the pto damping coefficients is not desirable to avoid that challenge an alternative efficiency index for irregular sea conditions is proposed for the assessment of the wec s captured power this index is denominated hydrodynamic capacity for wave energy conversion ηhydro max and is defined as the ratio of the maximum wec s absorbed power under optimum pto damping condition over the energy flux of the incident wave along the wec s width see eqs 9 11 for a given sea state the optimum pto damping condition assumes that for each individual wave period of the sea spectrum the pto system is operating with its optimum damping coefficient obtained from the classical linear approach although in practice the optimum pto condition in irregular waves may be impossible to be achieved the hydrodynamic capacity index for wave energy conversion represents a theoretical condition in which the maximum absorbed power could be obtained from an irregular sea if an ideal theoretical control system is applied to the wec this dimensionless index concentrates in a single value the hydrodynamic performance of the wec in irregular waves as such it will be used as the objective function in the optimization problem i e the optimum candidate will be the one that displays the highest index of hydrodynamic performance 3 2 hydrodynamic model although ceco is composed of two bodies partially submerged the oscillating part and the central fixed structure in terms of dynamics it can be modelled as a one degree of freedom 1 dof body notice that since the cylinder is fixed it is not allowed to move in any degree of freedom to describe the motions in regular waves of a 1 dof body i e the floating oscillating part of ceco the most common mathematical model is 1 m a s s b s b p t o s c s s f w s cos ω t α s where m is the mass of ceco s oscillating part a s b s and c s are added mass hydrodynamic damping and hydrostatic force coefficients respectively f ws and α s are the amplitude and phase of the wave excitation force ω is the wave excitation frequency and t is the time b pto is the damping coefficient of the force exerted on ceco by the pto system that is modelled as a linear damper system proportional to the wec s velocity time derivatives are expressed by dots over the instantaneous position of ceco s oscillating part along the inclined path s subscripts s indicate that the coefficients of the forces refer to the inclined 1 dof since typically the purpose of the simulations in optimization studies is to compare different designs more qualitatively than quantitatively for the sake of simplicity the hydrodynamic damping coefficients consider only the potential non viscous contribution if the force coefficients in eq 1 are assumed constant for a given regular wave condition the equation of motion becomes linear and its time dependence vanishes to give place to an algebraic frequency domain equation the solution for this equation of motion can be expressed as 2 s ω f w s ω ω 2 m a s ω i ω b s ω b p t o c s where s and f w s are the complex amplitudes of the harmonic motion and the wave excitation force respectively i 1 this dynamic system has been numerically implemented in wamit a radiation diffraction panel program developed for the linear analysis of the interaction of surface waves with various types of floating and submerged structures lee and newman 2013 for ceco both the fixed cylinder and the oscillating floaters have been modelled to allow a multibody hydrodynamic analysis it should be highlighted that different from traditional wec applications such as the heave point absorbers ceco s dynamics required the definition of a generalized additional mode of motion while the motions in the other 6 dof conventional modes were restrained the definition of the generalized mode allows the computation of hydrodynamic coefficients and wave excitation force for the inclined degree of freedom of the floaters although eq 1 refers only to the motion dynamics of ceco s floating part the effect of the central fixed cylinder is automatically accounted for by wamit as a hydrodynamic interaction effect in the added mass coefficient a s and in the hydrodynamic damping coefficient b s of the floaters when the amplitude of the response for any given wave excitation period is divided by the amplitude of the incident wave the well known rao of motions for the floaters is obtained 3 r a o s ω s a ω ζ a ω where ζ a ω is the amplitude of the incident wave and s a the amplitude of the wec s response for such a system the time average power absorbed by an arbitrary pto damper in regular waves is expressed as 4 p pto reg 1 2 b p t o ω 2 s a 2 according to falnes 2002 the optimum pto damping for a regular wave of frequency ω is given by optimum amplitude condition 5 b p t o o p t ω b s 2 ω ω m a s ω c s ω 2 1 2 this optimum pto damping coefficient allows the wec to absorb maximum average power for that regular wave frequency 6 p max o p t ω f w s ω 2 4 b s ω b p t o o p t ω to describe the motions of the wec in irregular waves the spectral approach can be applied if the linear superposition principle is assumed for the description of wave elevation and the wec s response according to this principle the response of a floating body to an irregular sea can be approximated by superimposing the responses of the body to each one of the regular waves components of the irregular sea this approach is typically applied for the assessment of motions of ships and offshore platforms in irregular waves faltinsen 1993 lewis 1988 and can be expressed as 7 s s ω r a o s 2 ω s ζ ω where s ζ ω and s s ω denote the power spectral densities of the incident sea wave spectrum and the wec s response response spectrum respectively for the computation of the wec s absorbed power in an incident irregular wave characterized by a wave spectrum s ζ ω the linear superposition principle can also be applied so that for an arbitrary constant pto damping coefficient the average wec s absorbed power is expressed by 8 p pto irr 0 b p t o ω 2 r a o s ω 2 s ζ ω d ω for the computation of the index of hydrodynamic capacity for wave energy conversion the theoretical maximum absorbed power from an irregular sea is given by 9 p max irr 0 b p t o o p t ω ω 2 r a o s ω 2 s ζ ω d ω the energy flux of the given sea state can be obtained by 10 p ζ ρ g b 0 c g ω s ζ ω d ω where c g represents the group velocity of the wave and b the wec s width which is considered as twice the floater s width therefore the index of hydrodynamic capacity for wave energy conversion is given by 11 η h y d r o max p max i r r p ζ 3 3 preliminary analyses the preliminary analyses involve the assessment of the hydrodynamic interaction between the floating part and the central support structure as well as the impact on the response of ceco of the inclination of the trajectory of the floating part and the submerged volume of the floaters in terms of wave energy absorption the hydrodynamic performance is directly dependent on the wave induced motions of the wec so the preliminary analyses will be based on the dimensionless responses of the floating part of ceco in regular waves i e the rao the assessment consists of comparing the raos of alternative configurations of ceco with the reference design configuration marinheiro et al 2015 i e floaters with a semi cylindrical shape whose axis is horizontal and perpendicular to the direction of incident waves about 60 of floaters submergence 45 degree inclination for the path translational trajectory of the floating part and a fixed support structure with a cylindrical cross section in between the floaters in the computation of the raos of ceco s floating part the damping of the system only included the potential radiation effects in eq 2 i e viscous effects were neglected and the pto damping was set to zero the effect of the central fixed cylinder was investigated by comparing the motion response of the floaters with and without that structure for the inclinations of 45 and 30 fig 2 shows that the effect of the central structure on performance can be considered negligible so the following numerical analyses can be further simplified by modelling only the two floaters as a single structure instead of the actual multibody system floaters fixed cylinder fig 3 details the effect of the inclination of ceco s trajectory by considering besides the floaters response at the reference inclination 45 inclinations ranging from null corresponding to a pure surge oscillator to 90 pure heave oscillator the floaters response is significantly affected not only in amplitude but mainly in the location of its natural period which in turn is dependent on hydrostatic restoring and hydromechanical inertial characteristics both the restoring force and added mass coefficients are strongly affected by the inclination of the motion trajectory figs 4 and 5 moreover their combined trends make the inclination effect even stronger starting from 90 inclination pure heave and moving towards smaller inclination angles it is observed that added mass coefficients increase whereas restoring coefficients decrease both trends contribute to an increase of the natural oscillation period with the reduction of the path s inclination on the other side the unrealistic large values of response amplitudes as the inclination is decreased from the vertical direction towards smaller angles particularly for oscillation periods over 4 s can be explained by the drastic decrease of the potential damping coefficient for all the inclination angles fig 6 in spite of the decrease of the wave excitation force fig 7 in practice such unrealistic large response amplitudes are not expected to occur due to the presence of other sources of damping such as viscous drag and mechanical friction besides the pto damping however for the preliminary analyses and subsequent optimization process based on previous validations against experimental results lópez et al 2017a rodríguez et al 2019a b the potential model is believed to reproduce well the behavior of ceco in regular and irregular waves both lópez et al 2017b with a time domain nonlinear tool and rodríguez et al 2019a 2019b with a frequency domain linear model have reported a satisfactory agreement in the prediction of rao motions particularly the ceco s natural oscillation period in the optimization strategy the effect of those punctual unrealistic rao values is strongly attenuated first in the computation of rao velocities when the raos of motion are multiplied by oscillation frequencies and then in the computation of the density spectrum of absorbed power when the sea spectrum is introduced it should be also noticed that the hydrodynamic index results from the integration of the spectrum of the absorbed power along the sea spectrum frequencies in summary the smaller the inclination the greater the natural oscillation period e g by changing the inclination from 90 to 20 the natural oscillation period can be shifted from 4 5 s to more than 16 s based on the above analyses and results it may be concluded that the effect of inclination angle is known and can be readily predicted therefore to reduce the number of design variables hereafter the inclination angle of the motion path will be set as constant in the optimization process another parameter that was analyzed in advance is the level of submergence of the floaters for the reference inclination 45 different submergence levels have been simulated and the corresponding wave induced responses computed see fig 8 based on hydrostatic considerations the increase of submergence increases the submerged volume thus the required mass of the system and induces variations in the mean waterplane area due to the semi cylindrical shape of the floaters the maximum waterplane area occurs for a submergence of 50 below and over that submergence level a decrease in the waterplane area is obtained towards the extreme draughts therefore for submergences over 50 the natural oscillation period increases with the increasing draught due to the reduction in waterplane area and the increase in the submerged volume for submergences below 50 the reduction in draught decreases the waterplane area and the submerged volume together so that depending on the dominant effect a decrease or increase in the natural oscillation period can be obtained for the ceco floaters at 45 a continuous increase in the natural period is observed as draught increases notice however that by controlling the submergence of the floaters natural periods between 6 s and 9 s are obtained fig 7 i e the effect of submergence is less intense than the inclination effect based on these results the effect of submergence can be considered as known and predictable 3 4 constrained parameters based on the preliminary analyses the effect of some of the design variables on the hydrodynamic behavior of the wec are already known and can be readily predicted these design variables may be classified as unessential in the design process and will be set as constants at reference values hereafter however there are still a significant number of parameters that even with an efficient hydrodynamical numerical tool make the optimization process still unfeasible a typical practice to further reduce the number of design variables is to set some constraints in the configuration of the system in the design of wecs for a particular sea site location the first step is to determine the most frequent waves according to the sea site probability data sergiienko et al 2017 and to assess the energy content of each sea state in a yearly basis in the present study the choosen location was the northern atlantic coast of the iberian peninsula which has been extensively analyzed in ramos et al 2017 and ramos et al 2018 those studies have shown that the main bulk of wave energy can be found in sea states whose peak periods are between 9 and 16 s with significant wave heights ranging between 1 5 and 5 0 m the maximum values of the mean annual wave energy resource are concentrated mainly around two peak periods t p 10 and 14 s with significant wave heights h s of 1 5 and 2 5 m respectively the average annual occurrence of the first maximum is approx 19 1737 h per year while the second one is approx 5 442 h per year as for this location the level of wave energy for both sea states is quite similar around 15 20 mwh m the criteria for choosing the target sea state was the wave occurrence probability which resulted in the following sea state t p 10 s and h s 1 5 m long crested unidirectional waves are also assumed another imposed constraint is related to the main characteristic dimensions of ceco in the design of heave oscillating wecs typically the main dimensions of the oscillating body are systematically varied to achieve natural oscillating periods around the peak period of the target sea state variations of those main dimensions directly affect all the costs of the wec i e both capex and opex thus impacting the levelized cost of the produced energy for this sloped motion wec since only shape variations were allowed the natural oscillation period should achieve the target peak period without significant changes in the main dimensions of ceco s reference design in addition the angle of inclination of the motion path will be set at the reference value of ceco s original design i e 45 this inclination angle represents the bisectrix path relative to pure heave vertical or pure surge horizontal oscillations and allows equal wave energy absorption from heave and surge oscillation modes furthermore for later adjustments or tuning of the wec system the 45 configuration also allows equal margin to both sides facilitating the control of this parameter for the sake of simplicity and to allow more versatility during operation only the submergence level or draught corresponding to approx 50 of the floaters height will be simulated the water depth and the distance between the floaters will be considered constant parameters during the optimization process according to ramos et al 2018 as the operating water depth increases ceco s power performance improves however this effect is almost negligible here for the sake of comparison with the experimental test conditions of the reference design the local water depth adopted for the optimization study was 16 0 m and the distance between the floaters 5 0 m 3 5 shape optimization method the preliminary analyses and the adopted constraints have left the floaters shape as the unique parameter to be optimized in this study the optimization of shapes would require ideally a numerical tool to automatize the systematic generation of a series of geometric shapes however the complexity in the specification of constraints to avoid unrealistic geometries precludes the use of this kind of tools therefore the wec s shape will be optimized for the target sea state using the technique of exhaustive search also known as brute force type or generate and test method with a heuristic approach the exhaustive search method is a problem solving technique that consists of systematically enumerating all possible solution candidates and checking whether each candidate satisfies the problem s statement the brute force search is simple to implement but its computational cost is proportional to the number of candidate solutions which in many practical problems tends to grow very quickly as the size of the problem increases therefore the brute force search is typically used when the problem size is limited or when there are problem specific heuristics that can be used to reduce the set of candidate solutions to a manageable size the latter is the case of the present study i e the heuristic approach based on trial and error rules of thumb intuitive judgment supported by theory experience from earlier experimental tests etc was adopted for the generation of a reduced number of candidate geometric shapes 4 numerical results and analyses in order to systematize and speed up the numerical optimization work eqs 2 11 have been implemented in matlab the hydrodynamic coefficients and wave excitation forces required have been computed in wamit for 60 regular wave periods ranging between 2 and 50 s for all shapes idealized the characteristic dimension of the panels used in the numerical modelling meshing of the floaters and the central cylinder was around 0 25 m for the description of the irregular wave spectrum and the wec response spectrum 5000 regular wave components have been used table 2 shows the most relevant shapes of the floaters analyzed during the optimization search for all of them the submergence considered was around 50 of the total volume of the floaters and the width of each floater of approx 4 5 m the incident sea state was characterized by a jonswap spectrum h s 1 5 m t p 10 s peak enhancement factor of 3 3 propagating in the direction perpendicular to the floaters and the angle of inclination of the trajectory path was fixed at 45 the basis for shape generation was the shape of the floaters of ceco s original design shape 00 shape 01 is similar to the reference design but to allow more margin for later draught adjustments the draught was set to approximately 50 of the total depth then based on the fact that hydrodynamic performance is affected by the relative orientation between the submerged geometry and the incident flow the first approach was to simulate different orthogonal orientations of the floaters while keeping the overall volume and in principle the overall costs constant shapes 02 to 07 shapes 02 to 04 were obtained by rotating the floaters of shape 01 around the vertical axis shape 05 kept the same mass of shape 01 but with a waterplane area greater than that of the reference design shapes 06 and 07 keep the waterplane area of shape 05 but respectively have a smaller and a greater volume than the shape 00 since no improvements were observed in terms of hydrodynamic efficiency ηhydro max intermediate orientations were also analyzed to speed up the process of shape generation this time changes in the displaced volume were allowed shapes 08 to 10 so shapes 08 and 09 have been rotated around the transversal axis 45 and shape 10 was rotated 135 also around the transversal axis again none of these alternative shapes performed better than the original shape the first ten alternative shapes allowed to conclude that in general deeper and fuller submerged shapes such as shape 10 performed better than shallower shapes to verify the above conclusion shapes 11 to 13 with approximately half the overall dimensions of the original wec were also simulated indeed shape 13 box shaped displayed a significant improvement when compared to shape 12 but not relatively to shape 11 suggesting that a smaller waterplane area is also an important parameter in other words the hydrodynamic performance is reduced when the characteristic length of the submerged body is small in comparison to the wavelength from shape 14 to 22 non cylindrical shapes within the overall dimensions of the original design were also simulated shape 16 box shaped achieved a slightly better performance than shape 01 but without overcoming the original design shape 00 these shapes also confirm that the best hydrodynamic performances were obtained for bodies whose natural periods were closer to 10 s shape 19 and 21 furthermore shapes with protuberant fore and or aft volumes exhibit greater performances indeed shape 21 displayed a hydrodynamic performance of 39 5 i e close to twice the value of the original ceco s design after analyzing shapes 20 to 22 it was preliminary concluded that the fore protuberant volume which resembles a ship s bulbous bow has a significant beneficial effect in the wec performance so to verify that hypotheses shapes with only protuberant fore volumes were generated shapes 23 to 26 indeed all these shapes achieved a hydrodynamic index above 40 being shape 26 the best ηhydro max 50 thus evidencing a significant improvement in relation to ceco s original design notice that although viscous effects are not considered in the potential hydrodynamic model sharp edges were avoided in the final shapes to reduce losses associated with vortex shedding fig 9 presents the frequency response operator of absorbed power in regular waves while fig 10 presents the density spectrum of absorbed wave power for the target sea state i e the integrand of eq 9 its integration along the wave frequency allows the computation of the maximum average absorbed power i e under ideal pto damping fig 10 also highlights the better performance of shapes 24 and 25 however despite the highest peak of shape 25 in the response in regular waves and in the density spectrum the total amount of absorbed power of shape 24 is higher thus more hydrodynamically efficient than shape 25 as evidenced by the index of hydrodynamic performance in table 2 therefore shape 24 was selected as the shape to be adopted for the new ceco design it should be noticed that the new ceco design can be further improved by fine adjustments in the angle of inclination and or the submerged volume furthermore the inclusion of the support cylinder and the additional damping in the wec from viscous effects pto damping etc will lead to an increase in the natural oscillation period of the wec and consequently the improvement in the hydrodynamic performance of the new design due to the better tuning with the peak period of the target sea state regarding the pto damping the optimum values corresponding to the wec s natural period and to the peak period of the target sea state have been also presented in table 2 at the natural period the values are in general low compared to those achieved during the model tests with ceco s reference design lópez et al 2017a rodríguez et al 2019a fig 11 displays the curve of optimum pto damping that was used for the computation of the maximum absorbed power for regular and irregular waves shown in figs 9 and 10 respectively fig 12 shows the response amplitude operator rao of motion in regular waves considering only the radiation potential damping it can be noticed that the difference between the amplitudes of the peaks of raos of motion between the new and the reference design is not as big as the difference between the peaks of frequency response of absorbed power fig 9 but the shape of the motion response curve of the new design is broader than that of the reference design 5 validation of results after the optimization process the new design of ceco hereafter referred to as cecov2 is that corresponding to shape 24 to validate the conclusion of the optimization study regarding the new shape of the floaters a new experimental campaign was carried out the scale chosen for the model tests was 1 25 to allow the maximum expected motions of this wec in the available water depth of the wave basin of the hydraulics laboratory of the hydraulics water resources and environment division of the faculty of engineering of the university of porto feup portugal the available water depth in the basin is also associated to the operational limitations of the wave maker and for cecov2 s model tests corresponded to 20 0 m full scale i e slightly larger than the water depth used in the optimization studies 16 0 m the effect of the water depth in the results has been investigated through numerical simulations and it was found to be negligible to simplify the physical model test arrangements the same set up used in the experimental tests with ceco s reference design hereafter referred to as cecov1 was adopted lópez et al 2017a b rosa santos et al 2019a thus a central fixed cylinder perpendicular to the motion path was used to house the pto system due to space limitation during the construction of the physical model the separation distance between the two floaters needed to be increased to 6 25 m full scale value in comparison to the distance adopted in the optimization simulations the final separation distance resulted from the diameter of the central cylinder 5 0 m plus an additional distance between the cylinder and each of the floaters to allow their fixation to their connecting structure regarding the connecting structure which is basically a metallic frame composed of tubular members its effect on the hydrodynamic behavior has been considered negligible compared to that of the central cylinder thus it was not included in the numerical model at this stage fig 13 still in the context of the numerical simulations some previous calculations were necessary to validate the assumptions made in the preliminary analyses which were based on cevov1 those assumptions refer to the effect of the presence of the fixed support cylinder the submergence of the floaters and the inclination of the motion path fig 14 presents the response amplitudes of cecov2 s reference design characterized by a submergence in terms of draught of 52 inclination of 45 and water depth of 20 0 m together with alternative configurations to assess the above effects fig 14 confirms that neither the presence of the cylinder nor the water depth has a significant effect on cecov2 s hydrodynamic performance and that inclination and submergence have a strong impact on the natural oscillation period of this wec these conclusions are in agreement with the tendencies observed for cecov1 the overall experimental test campaign included pre tests with the pto system alone decay tests and tests in regular and irregular waves also systematic variations of the levels of pto damping have been considered including tests without the pto system for the experimental validation of the numerical conclusions of the optimization study only a few physical model tests results are presented namely those test conditions of cecov2 without pto damping fig 15 compares the experimental raos of cecov1 and cecov2 obtained from regular wave tests for wave periods around the corresponding natural periods these results confirm that cecov2 is a better motion converter than cecov1 for the period corresponding to the peak of the target sea state the response of cecov2 almost doubles the response of cecov1 fig 16 shows the motion response spectra of cecov2 for three irregular sea spectra namely the target sea state t p 10 s a sea state with a lower peak period t p 7 s and one with a larger peak period t p 13 s all with the same significant wave height h s 1 5 m for the sake of comparison the motion response spectra of cecov1 for similar sea states are plotted together notice that the significant wave heights in the experimental tests with cecov1 were larger h s 2 0 m despite the wave conditions for cecov1 being more energetic cecov2 displayed larger excursions than cecov1 for the target sea state fig 16 thus confirming the numerically predicted resonant behavior of cecov2 for the sea state with lower peak period cecov1 performs better than cecov2 the reason is that the lower peak period for cecov1 matches its resonant period 8 s while for cecov2 this peak period 7 s is quite far from its resonant period 10s for the sea state with the largest peak period cecov1 motions are slightly larger than those of cecov2 however it should be recalled that the waves for cecov1 h s 2 0 m are much more energetic than those for cecov2 h s 1 5 m the comparison of the experimental results obtained for cecov1 and cecov2 has allowed an indirect validation of the numerical outcomes of the optimization study however a more direct validation can be performed by comparing numerical simulations of motions with experimental results once damping has been calibrated using for instance the hybrid approach proposed by rodríguez et al 2019a this approach relies on the numerical rao of motion and the experimental incident wave time series to compute the numerical motion response spectra based on eq 7 starting with the radiation damping coefficient an additional external damping is iteratively applied in the rao of motion until the numerical response spectra matches the experimental one to obtain the calibrated external damping coefficient for the test conditions without pto damping the calibrated damping coefficient represents the hydrodynamic damping potential damping plus losses including viscous effects for the target sea state and cecov2 at the 45 inclination two additional pto damping levels has been experimentally tested too the experimental response spectra and the corresponding calibrated numerical spectra and numerical raos are shown in fig 17 since the hybrid calibration procedure for irregular seas is based on the area under the response spectrum it is inherently guaranteed that the significant response amplitude is the same for the experimental tests and the corresponding numerical simulation for conditions b pto 1 and b pto 2 the shapes of the calibrated response spectra also resemble quite well the corresponding experimental spectra thus evidencing the suitability of the linear hydrodynamic model and the calibration procedure the external damping coefficient total damping excluding potential effects for the condition without pto damping was 45 kn s m while for damping levels 1 and 2 the values were 110 kn s m and 195 kn s m respectively the absorbed power associated to those pto damping coefficients were 18 3 kw and 18 6 kw with capture efficiencies of 17 5 and 17 8 respectively notice that these efficiencies correspond to arbitrary values of pto damping tested during the experimental model tests according to the results presented in table 2 higher capture efficiencies may be achieved for lower pto damping coefficients further analyses are necessary to determine the best pto damping for a given wec condition but are out of the scope of the present study currently ceco is classified in the technological readiness level trl 3 4 where its performance is assessed through numerical studies and physical model tests higher stages of development of ceco will demand full scale tests where in principle the optimum geometry found in the prior numerical and experimental tests is expected to be used on the other hand the pto system will depend on the available technologies at the time of full scale testing currently most of the point absorber wecs adopt direct mechanical drive pto systems i e the same type of pto system used in the experimental tests carried out with ceco however more recently direct electrical drive systems have become more popular and an attractive solution to reduce mechanical losses 6 conclusions the hydrodynamic optimization of the geometry of the floaters of a sloped motion wec named ceco has been performed based on a time efficient frequency domain numerical model the optimization procedure relied on the use of the exhaustive search technique with heuristic approach prior to the optimization study some of the parameters that govern ceco s hydrodynamics were numerically investigated to understand their effects in advance so that the optimization procedure could only focus on the shape of the floaters those preliminary analyses allowed to conclude that the effects of the fixed central cylinder and of the water depth were negligible while the submergence level of the floaters and the inclination of the motion path determine the natural period of ceco the optimization study showed that the shape of the floaters controls also the natural period and depending on its tuning with the peak period of the target sea state a more efficient wave energy converter can be developed it was shown that the geometry obtained as the optimum solution from the numerical optimization study is able to harvest twice as much wave energy than the original ceco design cecov1 in order to validate the numerical outcomes experimental model tests have been conducted with the optimized geometry the experimental results with regular and irregular wave tests have confirmed that cecov2 is in fact a better motion converter than cecov1 in regular waves the peak of the rao of motion was almost twice the value measured for cecov1 in irregular waves the motion spectrum for the target sea state was significantly larger than the spectrum of cecov1 even considering a much more energetic sea state finally it was demonstrated that unlike pure heave oscillators where basically the main dimensions of the floaters control the natural frequency for ceco concept the inclination of the motion path submergence or shape of the floaters can be adjusted to achieve any natural oscillating period within a relatively broad range thus it is possible to adapt ceco parameters to tune it to any sea state so that high energy capture efficiencies can be obtained credit authorship contribution statement claudio a rodríguez conceptualization methodology formal analysis writing original draft writing review editing supervision paulo rosa santos conceptualization methodology validation writing review editing supervision francisco taveira pinto conceptualization methodology validation writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was financially supported by project ptdc mar tec 6984 2014 poci 01 0145 feder 016882 funded by feder funds through compete2020 programa operacional competitividade e internacionalização poci and by national funds through fct fundação para a ciência e a tecnologia i p 
22062,this paper presents the hydrodynamic optimization study of ceco a point absorber wave energy converter wec with sloped motion to maintain the overall costs the characteristic dimensions of the optimized solution were not allowed to change significantly instead different geometrical shapes have been generated and numerically investigated based on the exhaustive search method with a heuristic approach the assessment of the different geometries was based on a new index the hydrodynamic capacity for wave energy conversion which considers that the theoretical maximum wec s absorbed power from irregular waves is obtained assuming that for each individual wave component of the sea spectrum the pto system can operate with its optimum damping coefficient the optimum geometry obtained is able to harvest twice as much wave energy than the original design of ceco the numerical outcomes have been validated with the results of experimental tests with the new geometry unlike pure heaving wecs a sloped motion wec can achieve natural oscillation periods within a broad range by controlling the inclination of the motion path the submergence level or the shape of its floaters therefore ceco can be tuned to any given sea state and avoid the need for active complex control strategies keywords ceco exhaustive search method wec tuning experimental testing frequency domain modelling hydrodynamic efficiency 1 introduction the global energy demand is expected to grow by more than 25 to 2040 iea 2018 in addition the share of renewables in energy generation should rise to over 40 by 2040 from 25 today which is essential in securing a sustainable future for the planet ocean wave energy in spite of being on a pre commercial stage has the potential to provide utility scale power production in the future due to the huge global offshore wave power resource estimated at approximately 32 000 twh yr reguero et al 2015 that potential could be used to provide about 10 of the europe electricity needs by 2050 rusu and onea 2018 suppling not only the onshore grids but also offshore activities oliveira pinto et al 2019 a large variety of technologies to convert wave energy has been developed and tested but a dominant concept was not found yet taveira pinto et al 2015 however some promising designs are presently undergoing detailed optimization studies and demonstration testing at open sea therefore approaching the commercial phase e g liang et al 2017 moretti et al 2020 sheng et al 2017 a key variable in the optimization of a wave energy converter wec is the amount of power absorbed which shall take into account the wave climate at the installation site in this process the wec is often tuned so that its natural period of oscillation matches the most probable sea state period or that with the higher amount of energy on a yearly basis at the point of interest however the characteristics of the power matrix also have an important influence on the annual power absorption of the wec de andres et al 2015 this explains why in some studies the optimization is done so as to harvest the maximum power over the largest range of periods possible considering the wave climate at site shadman et al 2018 the two main alternatives to adjust and optimize the performance of a wec are i the modification of the physical characteristics of the device e g size mass or geometry which has a direct impact on its natural oscillation periods and ii the control of the power take off pto system which consists in the modification of the wec absorption characteristics over time to maximize its power production the tuning of wecs to the prevailing sea states can be done in different ways depending on the type of device namely by modifying the inertia of the system e g flocard and finnigan 2012 the mass distribution e g meng et al 2019 the geometry of floating bodies e g goggins and finnegan 2014 the mooring system characteristics e g paredes et al 2016 the pto inclination angle e g lópez et al 2018 or the pto characteristics e g shi et al 2019 xiao et al 2017 moreover different pto control strategies are available to maximize power production ozkop and altas 2017 namely the passive loading control the latching control and the reactive loading control however in contrast to the characteristics of the pto system stiffness and or damping the physical characteristics of the wec are often more difficult to vary according to the incoming waves and therefore are defined first different approaches of varying complexity can be applied in the optimization process of wecs in a simplified form the main goal is to maximize the mean absorbed power while the construction costs are minimized to reach the tradeoff between multiple goals multi objective optimization techniques can be applied namely those based on genetic e g alamian et al 2019 mccabe 2013 or differential evolutionary algorithms e g blanco et al 2019 other alternatives are the sequential optimization procedures in which the optimal parameters are set in a consecutive manner bouali and larbi 2017 or the optimization approach based on exhaustive search and driven by constrains to reduce the number of variables and simplify the optimization process in this last case if constrains are incorrectly chosen inappropriate results may be obtained as garcia rosa et al 2015 demonstrated when analyzed the impact of pto restrictions on the shape optimization of a heaving buoy since different control strategies resulted in different optimal geometries the geometry optimization is of relevance for all classes of wecs since it determines the hydrodynamic characteristics of the fluid structure interaction therefore to ensure that a wec works efficiently at a given site its geometry is often considered the first variable for the optimization of its design bozzi et al 2018 esmaeilzadeh and alam 2019 to maximize the absorbed power and the absorption bandwidth of a heaving point absorber shadman et al 2018 optimized the draft and diameter of the floater while maintaining its natural period close to the predominant wave periods at site using a frequency domain method the pto was assumed to be a pure damper and its damping frequency independent and equal to the hydrodynamic damping of each floater shape at its resonant frequency to maximize the power absorption at that frequency pastor and liu 2014 optimized also a point absorber by testing different shapes drafts and diameters of the buoy taking into account the wave conditions of the deployment site near the gulf of mexico the pto control parameters i e spring and damping coefficients were adjusted to tune the wec to the incident wave conditions and therefore to maximize its power absorption goggins and finnegan 2014 presented a methodology for the geometry optimization of a floating axisymmetric point absorber which considers 6 basic geometric shapes derived from a vertical cylinder and have used the average annual wave energy spectrum for the case study location offshore the west coast of ireland an ideal linear damper was used where the pto damping coefficient is maintained constant since this approach facilitates the dynamic response calculation in the frequency domain the optimum damping was determined so as to maximize the mean power absorbed at the reference site even though the classical linear approach allows defining an optimum pto damping coefficient that maximizes the absorbed power for each particular wave period the use of a single optimum damping coefficient for the whole set of waves that compose a given sea spectrum is questionable if the maximum power output is envisioned in the geometric optimization work the assessment of the power absorbed considering that the pto system is operating with its optimum damping coefficient for each individual period of the wave spectrum would have the benefit of allowing to obtain the maximum power output for each tested geometry avoiding the arbitrariness of choosing a particular damping coefficient the advancement of computational resources facilitates the application of optimization methodologies the computational fluid dynamics models based on the navier stokes equations allow considering the effect of all relevant nonlinearities on the hydrodynamic analysis e g wave breaking surface piercing vortex shedding but are still not a cost effective tool to be used in cases where a systematic analysis of a large number of variables needs to be done nonetheless such models were already applied in some optimization studies of wecs e g shi et al 2019 on the other hand the use of frequency domain hydrodynamic methods linear based on potential flow theory in the optimization of wecs has two important advantages a smaller computational cost and the possibility of carrying out systematic analyses considering a wide range of physical characteristics of the wec a large number of examples can be found in which those models were used in the optimization process e g goggins and finnegan 2014 piscopo et al 2016 shadman et al 2018 tom et al 2016 time domain models are however recommended in the more advanced development phases to validate the characteristics the optimized wecs this paper presents the hydrodynamic optimization of the floaters of a sloped motion wec ceco since the original geometry of the floaters was intuitively defined an exhaustive search method with a heuristic approach is used to improve its ability to harvest wave energy in order to maintain the costs of the different solutions in the same order of magnitude the characteristic dimensions of ceco were not changed significantly the different geometric shapes were assessed numerically and then compared using a new hydrodynamic efficiency parameter the index of hydrodynamic capacity for wave energy conversion the optimum geometry of the floaters has been validated experimentally 2 ceco s working principle the wec concept for the present study ceco is a point absorber that harvests wave energy from the translational motions of its floaters along a straight sloped path defined by the inclination of the guiding rods fig 1 ceco consists of two structures a moving part composed of two lateral floaters attached to a central connecting frame and a fixed reference structure that houses the power take off system when the moving structure is excited by the waves its sloped oscillatory motion is converted into rotations by a rack pinion mechanism the rack is attached to the connecting structure while the pinion is connected to a dc generator s shaft finally rotations are converted into electricity by the dc generator which is fixed and housed in the reference structure for the sake of simplicity the axis of the central cylinder is installed perpendicular to the motion path of the floaters the most outstanding features of ceco concept are its ability to harness energy from both surge and heave modes simultaneously and as shown in previous studies e g rodríguez et al 2019b rosa santos et al 2019b the possibility of tuning the natural frequency of the wec motion with the angle of its translation path the nominal design inclination and submergence volume of the floaters was 45 and 60 respectively for this condition the free oscillation frequency of ceco s floating part is around 8 s table 1 presents the main dimensions and nominal operational parameters of ceco 3 optimization strategy the standard form of the general optimization problem is typically represented by the objective or goal function and the constraints both are defined in terms of design variables which in the optimization process are modified to obtain the optimum in the literature several references can be found describing a large number of optimization techniques that exist for engineering optimization applications e g coello coello 1999 onwubolu and babu 2013 rao 2019 venter 2010 in general depending on the complexity of the objective function the associated constraints and the optimization technique the optimization process requires substantial computational effort in this study the objective function is the absorbed power of the wec which is intrinsic to its hydrodynamic response in other words the complexity of the objective function and the associated constraints depends on the type of the adopted hydrodynamic model lópez et al 2017a 2017b have performed time domain simulations using a nonlinear numerical tool based on the potential flow theory although that approach is expected to be more accurate for the analysis of wave body interaction it still demands substantial computational effort when body dynamics in irregular wave conditions are required more recently rodríguez et al 2019a used a frequency domain linear numerical model for the assessment of damping coefficients for regular and irregular wave conditions from model tests their results compared very well with those from the respective time domain nonlinear approach with much less computational time therefore the frequency domain approach was considered adequate for the hydrodynamic optimization process a significant amount of computational cost can be further saved if the design variables are considered as deterministic variables at their reference values i e the number of analyses is reduced by systematically fixing unessential design variables throughout the optimization process kim et al 2004 the term unessential may not necessarily refer to irrelevant design variables but to variables whose effect can be assessed easily and independently of the other design variables the behavior and effects of these unessential variables may be predicted in advance through preliminary analyses 3 1 optimization scope and criteria the results of previous studies with ceco highlighted the fact that its original design was not suitable for the wave conditions typical of the most energetic coastal stretches of the target sea site for example the northern portuguese coast ramos et al 2017 rosa santos et al 2019b in this context the first objective of the optimization task is to adapt the geometry of ceco so that its natural period of oscillation becomes resonant with the period of the target sea condition to improve its efficiency for wave energy harvesting since the focus is the hydrodynamic performance associated to wave energy extraction the criteria for the assessment of the alternative geometries to be analyzed in the optimization process in principle can be expressed by the response amplitude operator rao of the motions of the floating part considering only its inherent damping i e without the pto effect the efficiency in the wave energy absorption for the target sea condition the first criterion assesses the capacity of the wec for the conversion of wave excitation into motions the greater the motions the greater the available power that can be absorbed by the pto system typically the peak of the rao curve is obtained when the wave excitation period matches the natural period of the system i e at resonance therefore the tuning between those periods is a key parameter in the optimization of wecs the second criterion is related to the conditions of maximum power absorption specified in the traditional approach however there are two important aspects that should be highlighted first in the present approach the second criterion refers to a given sea condition i e irregular waves with random heights and periods while the traditional approach is based in regular waves single wave period and amplitude in irregular waves there is no uniform distribution of wave energy indeed wave energy is unevenly distributed over a wide range of periods although concentrated around the peak period of the sea spectrum so the wec that maximizes wave power absorption is not necessarily the one whose natural oscillation period matches the sea spectrum s peak that wec in fact can present a very high sharp peak of absorbed energy at its resonant period but it may not absorb a significant amount of energy at the other periods of the sea spectrum in contrast a hypothetical wec with its resonant period detuned from the sea s peak period may absorb a larger amount of wave energy resultant from the overall contribution of a number of other components of the wave spectrum to explain the latter case the dynamic behavior of the wec along the wave frequency domain should be considered the aim is to keep the wec motions significant in a broad range of wave periods by putting for instance the sea s peak period to excite oscillation periods at which the wec does not display sufficiently large motions and the periods of smaller wave energy to excite the resonant period of the wec the wec s motion will not be the largest in any case but the system will be able in principle to absorb a larger amount of wave energy by adding the individual contributions from a broader range of periods the second aspect is related to the pto damping coefficient and the definition of the captured power efficiency for the wec under irregular waves as known the amount of absorbed energy is directly dependent on the level of damping of the pto system for regular waves the classical linear approach provides an optimum pto damping coefficient that maximizes the wec s absorbed power for each single regular wave period if this approach is applied to a passive wec in irregular waves a challenge arises because a single optimum pto damping coefficient should be chosen for the whole set of waves that compose the given sea spectrum the selection of that pto damping coefficient can be arbitrary but is limited by the range of damping levels that the actual pto system can provide especially at the peak period of the wave spectrum and at the wec s resonant condition however intermediate values may not be disregarded since an overall optimum condition is sought for the full range of periods of the wave spectrum for the assessment in the optimization study this dependence on arbitrarily chosen values of the pto damping coefficients is not desirable to avoid that challenge an alternative efficiency index for irregular sea conditions is proposed for the assessment of the wec s captured power this index is denominated hydrodynamic capacity for wave energy conversion ηhydro max and is defined as the ratio of the maximum wec s absorbed power under optimum pto damping condition over the energy flux of the incident wave along the wec s width see eqs 9 11 for a given sea state the optimum pto damping condition assumes that for each individual wave period of the sea spectrum the pto system is operating with its optimum damping coefficient obtained from the classical linear approach although in practice the optimum pto condition in irregular waves may be impossible to be achieved the hydrodynamic capacity index for wave energy conversion represents a theoretical condition in which the maximum absorbed power could be obtained from an irregular sea if an ideal theoretical control system is applied to the wec this dimensionless index concentrates in a single value the hydrodynamic performance of the wec in irregular waves as such it will be used as the objective function in the optimization problem i e the optimum candidate will be the one that displays the highest index of hydrodynamic performance 3 2 hydrodynamic model although ceco is composed of two bodies partially submerged the oscillating part and the central fixed structure in terms of dynamics it can be modelled as a one degree of freedom 1 dof body notice that since the cylinder is fixed it is not allowed to move in any degree of freedom to describe the motions in regular waves of a 1 dof body i e the floating oscillating part of ceco the most common mathematical model is 1 m a s s b s b p t o s c s s f w s cos ω t α s where m is the mass of ceco s oscillating part a s b s and c s are added mass hydrodynamic damping and hydrostatic force coefficients respectively f ws and α s are the amplitude and phase of the wave excitation force ω is the wave excitation frequency and t is the time b pto is the damping coefficient of the force exerted on ceco by the pto system that is modelled as a linear damper system proportional to the wec s velocity time derivatives are expressed by dots over the instantaneous position of ceco s oscillating part along the inclined path s subscripts s indicate that the coefficients of the forces refer to the inclined 1 dof since typically the purpose of the simulations in optimization studies is to compare different designs more qualitatively than quantitatively for the sake of simplicity the hydrodynamic damping coefficients consider only the potential non viscous contribution if the force coefficients in eq 1 are assumed constant for a given regular wave condition the equation of motion becomes linear and its time dependence vanishes to give place to an algebraic frequency domain equation the solution for this equation of motion can be expressed as 2 s ω f w s ω ω 2 m a s ω i ω b s ω b p t o c s where s and f w s are the complex amplitudes of the harmonic motion and the wave excitation force respectively i 1 this dynamic system has been numerically implemented in wamit a radiation diffraction panel program developed for the linear analysis of the interaction of surface waves with various types of floating and submerged structures lee and newman 2013 for ceco both the fixed cylinder and the oscillating floaters have been modelled to allow a multibody hydrodynamic analysis it should be highlighted that different from traditional wec applications such as the heave point absorbers ceco s dynamics required the definition of a generalized additional mode of motion while the motions in the other 6 dof conventional modes were restrained the definition of the generalized mode allows the computation of hydrodynamic coefficients and wave excitation force for the inclined degree of freedom of the floaters although eq 1 refers only to the motion dynamics of ceco s floating part the effect of the central fixed cylinder is automatically accounted for by wamit as a hydrodynamic interaction effect in the added mass coefficient a s and in the hydrodynamic damping coefficient b s of the floaters when the amplitude of the response for any given wave excitation period is divided by the amplitude of the incident wave the well known rao of motions for the floaters is obtained 3 r a o s ω s a ω ζ a ω where ζ a ω is the amplitude of the incident wave and s a the amplitude of the wec s response for such a system the time average power absorbed by an arbitrary pto damper in regular waves is expressed as 4 p pto reg 1 2 b p t o ω 2 s a 2 according to falnes 2002 the optimum pto damping for a regular wave of frequency ω is given by optimum amplitude condition 5 b p t o o p t ω b s 2 ω ω m a s ω c s ω 2 1 2 this optimum pto damping coefficient allows the wec to absorb maximum average power for that regular wave frequency 6 p max o p t ω f w s ω 2 4 b s ω b p t o o p t ω to describe the motions of the wec in irregular waves the spectral approach can be applied if the linear superposition principle is assumed for the description of wave elevation and the wec s response according to this principle the response of a floating body to an irregular sea can be approximated by superimposing the responses of the body to each one of the regular waves components of the irregular sea this approach is typically applied for the assessment of motions of ships and offshore platforms in irregular waves faltinsen 1993 lewis 1988 and can be expressed as 7 s s ω r a o s 2 ω s ζ ω where s ζ ω and s s ω denote the power spectral densities of the incident sea wave spectrum and the wec s response response spectrum respectively for the computation of the wec s absorbed power in an incident irregular wave characterized by a wave spectrum s ζ ω the linear superposition principle can also be applied so that for an arbitrary constant pto damping coefficient the average wec s absorbed power is expressed by 8 p pto irr 0 b p t o ω 2 r a o s ω 2 s ζ ω d ω for the computation of the index of hydrodynamic capacity for wave energy conversion the theoretical maximum absorbed power from an irregular sea is given by 9 p max irr 0 b p t o o p t ω ω 2 r a o s ω 2 s ζ ω d ω the energy flux of the given sea state can be obtained by 10 p ζ ρ g b 0 c g ω s ζ ω d ω where c g represents the group velocity of the wave and b the wec s width which is considered as twice the floater s width therefore the index of hydrodynamic capacity for wave energy conversion is given by 11 η h y d r o max p max i r r p ζ 3 3 preliminary analyses the preliminary analyses involve the assessment of the hydrodynamic interaction between the floating part and the central support structure as well as the impact on the response of ceco of the inclination of the trajectory of the floating part and the submerged volume of the floaters in terms of wave energy absorption the hydrodynamic performance is directly dependent on the wave induced motions of the wec so the preliminary analyses will be based on the dimensionless responses of the floating part of ceco in regular waves i e the rao the assessment consists of comparing the raos of alternative configurations of ceco with the reference design configuration marinheiro et al 2015 i e floaters with a semi cylindrical shape whose axis is horizontal and perpendicular to the direction of incident waves about 60 of floaters submergence 45 degree inclination for the path translational trajectory of the floating part and a fixed support structure with a cylindrical cross section in between the floaters in the computation of the raos of ceco s floating part the damping of the system only included the potential radiation effects in eq 2 i e viscous effects were neglected and the pto damping was set to zero the effect of the central fixed cylinder was investigated by comparing the motion response of the floaters with and without that structure for the inclinations of 45 and 30 fig 2 shows that the effect of the central structure on performance can be considered negligible so the following numerical analyses can be further simplified by modelling only the two floaters as a single structure instead of the actual multibody system floaters fixed cylinder fig 3 details the effect of the inclination of ceco s trajectory by considering besides the floaters response at the reference inclination 45 inclinations ranging from null corresponding to a pure surge oscillator to 90 pure heave oscillator the floaters response is significantly affected not only in amplitude but mainly in the location of its natural period which in turn is dependent on hydrostatic restoring and hydromechanical inertial characteristics both the restoring force and added mass coefficients are strongly affected by the inclination of the motion trajectory figs 4 and 5 moreover their combined trends make the inclination effect even stronger starting from 90 inclination pure heave and moving towards smaller inclination angles it is observed that added mass coefficients increase whereas restoring coefficients decrease both trends contribute to an increase of the natural oscillation period with the reduction of the path s inclination on the other side the unrealistic large values of response amplitudes as the inclination is decreased from the vertical direction towards smaller angles particularly for oscillation periods over 4 s can be explained by the drastic decrease of the potential damping coefficient for all the inclination angles fig 6 in spite of the decrease of the wave excitation force fig 7 in practice such unrealistic large response amplitudes are not expected to occur due to the presence of other sources of damping such as viscous drag and mechanical friction besides the pto damping however for the preliminary analyses and subsequent optimization process based on previous validations against experimental results lópez et al 2017a rodríguez et al 2019a b the potential model is believed to reproduce well the behavior of ceco in regular and irregular waves both lópez et al 2017b with a time domain nonlinear tool and rodríguez et al 2019a 2019b with a frequency domain linear model have reported a satisfactory agreement in the prediction of rao motions particularly the ceco s natural oscillation period in the optimization strategy the effect of those punctual unrealistic rao values is strongly attenuated first in the computation of rao velocities when the raos of motion are multiplied by oscillation frequencies and then in the computation of the density spectrum of absorbed power when the sea spectrum is introduced it should be also noticed that the hydrodynamic index results from the integration of the spectrum of the absorbed power along the sea spectrum frequencies in summary the smaller the inclination the greater the natural oscillation period e g by changing the inclination from 90 to 20 the natural oscillation period can be shifted from 4 5 s to more than 16 s based on the above analyses and results it may be concluded that the effect of inclination angle is known and can be readily predicted therefore to reduce the number of design variables hereafter the inclination angle of the motion path will be set as constant in the optimization process another parameter that was analyzed in advance is the level of submergence of the floaters for the reference inclination 45 different submergence levels have been simulated and the corresponding wave induced responses computed see fig 8 based on hydrostatic considerations the increase of submergence increases the submerged volume thus the required mass of the system and induces variations in the mean waterplane area due to the semi cylindrical shape of the floaters the maximum waterplane area occurs for a submergence of 50 below and over that submergence level a decrease in the waterplane area is obtained towards the extreme draughts therefore for submergences over 50 the natural oscillation period increases with the increasing draught due to the reduction in waterplane area and the increase in the submerged volume for submergences below 50 the reduction in draught decreases the waterplane area and the submerged volume together so that depending on the dominant effect a decrease or increase in the natural oscillation period can be obtained for the ceco floaters at 45 a continuous increase in the natural period is observed as draught increases notice however that by controlling the submergence of the floaters natural periods between 6 s and 9 s are obtained fig 7 i e the effect of submergence is less intense than the inclination effect based on these results the effect of submergence can be considered as known and predictable 3 4 constrained parameters based on the preliminary analyses the effect of some of the design variables on the hydrodynamic behavior of the wec are already known and can be readily predicted these design variables may be classified as unessential in the design process and will be set as constants at reference values hereafter however there are still a significant number of parameters that even with an efficient hydrodynamical numerical tool make the optimization process still unfeasible a typical practice to further reduce the number of design variables is to set some constraints in the configuration of the system in the design of wecs for a particular sea site location the first step is to determine the most frequent waves according to the sea site probability data sergiienko et al 2017 and to assess the energy content of each sea state in a yearly basis in the present study the choosen location was the northern atlantic coast of the iberian peninsula which has been extensively analyzed in ramos et al 2017 and ramos et al 2018 those studies have shown that the main bulk of wave energy can be found in sea states whose peak periods are between 9 and 16 s with significant wave heights ranging between 1 5 and 5 0 m the maximum values of the mean annual wave energy resource are concentrated mainly around two peak periods t p 10 and 14 s with significant wave heights h s of 1 5 and 2 5 m respectively the average annual occurrence of the first maximum is approx 19 1737 h per year while the second one is approx 5 442 h per year as for this location the level of wave energy for both sea states is quite similar around 15 20 mwh m the criteria for choosing the target sea state was the wave occurrence probability which resulted in the following sea state t p 10 s and h s 1 5 m long crested unidirectional waves are also assumed another imposed constraint is related to the main characteristic dimensions of ceco in the design of heave oscillating wecs typically the main dimensions of the oscillating body are systematically varied to achieve natural oscillating periods around the peak period of the target sea state variations of those main dimensions directly affect all the costs of the wec i e both capex and opex thus impacting the levelized cost of the produced energy for this sloped motion wec since only shape variations were allowed the natural oscillation period should achieve the target peak period without significant changes in the main dimensions of ceco s reference design in addition the angle of inclination of the motion path will be set at the reference value of ceco s original design i e 45 this inclination angle represents the bisectrix path relative to pure heave vertical or pure surge horizontal oscillations and allows equal wave energy absorption from heave and surge oscillation modes furthermore for later adjustments or tuning of the wec system the 45 configuration also allows equal margin to both sides facilitating the control of this parameter for the sake of simplicity and to allow more versatility during operation only the submergence level or draught corresponding to approx 50 of the floaters height will be simulated the water depth and the distance between the floaters will be considered constant parameters during the optimization process according to ramos et al 2018 as the operating water depth increases ceco s power performance improves however this effect is almost negligible here for the sake of comparison with the experimental test conditions of the reference design the local water depth adopted for the optimization study was 16 0 m and the distance between the floaters 5 0 m 3 5 shape optimization method the preliminary analyses and the adopted constraints have left the floaters shape as the unique parameter to be optimized in this study the optimization of shapes would require ideally a numerical tool to automatize the systematic generation of a series of geometric shapes however the complexity in the specification of constraints to avoid unrealistic geometries precludes the use of this kind of tools therefore the wec s shape will be optimized for the target sea state using the technique of exhaustive search also known as brute force type or generate and test method with a heuristic approach the exhaustive search method is a problem solving technique that consists of systematically enumerating all possible solution candidates and checking whether each candidate satisfies the problem s statement the brute force search is simple to implement but its computational cost is proportional to the number of candidate solutions which in many practical problems tends to grow very quickly as the size of the problem increases therefore the brute force search is typically used when the problem size is limited or when there are problem specific heuristics that can be used to reduce the set of candidate solutions to a manageable size the latter is the case of the present study i e the heuristic approach based on trial and error rules of thumb intuitive judgment supported by theory experience from earlier experimental tests etc was adopted for the generation of a reduced number of candidate geometric shapes 4 numerical results and analyses in order to systematize and speed up the numerical optimization work eqs 2 11 have been implemented in matlab the hydrodynamic coefficients and wave excitation forces required have been computed in wamit for 60 regular wave periods ranging between 2 and 50 s for all shapes idealized the characteristic dimension of the panels used in the numerical modelling meshing of the floaters and the central cylinder was around 0 25 m for the description of the irregular wave spectrum and the wec response spectrum 5000 regular wave components have been used table 2 shows the most relevant shapes of the floaters analyzed during the optimization search for all of them the submergence considered was around 50 of the total volume of the floaters and the width of each floater of approx 4 5 m the incident sea state was characterized by a jonswap spectrum h s 1 5 m t p 10 s peak enhancement factor of 3 3 propagating in the direction perpendicular to the floaters and the angle of inclination of the trajectory path was fixed at 45 the basis for shape generation was the shape of the floaters of ceco s original design shape 00 shape 01 is similar to the reference design but to allow more margin for later draught adjustments the draught was set to approximately 50 of the total depth then based on the fact that hydrodynamic performance is affected by the relative orientation between the submerged geometry and the incident flow the first approach was to simulate different orthogonal orientations of the floaters while keeping the overall volume and in principle the overall costs constant shapes 02 to 07 shapes 02 to 04 were obtained by rotating the floaters of shape 01 around the vertical axis shape 05 kept the same mass of shape 01 but with a waterplane area greater than that of the reference design shapes 06 and 07 keep the waterplane area of shape 05 but respectively have a smaller and a greater volume than the shape 00 since no improvements were observed in terms of hydrodynamic efficiency ηhydro max intermediate orientations were also analyzed to speed up the process of shape generation this time changes in the displaced volume were allowed shapes 08 to 10 so shapes 08 and 09 have been rotated around the transversal axis 45 and shape 10 was rotated 135 also around the transversal axis again none of these alternative shapes performed better than the original shape the first ten alternative shapes allowed to conclude that in general deeper and fuller submerged shapes such as shape 10 performed better than shallower shapes to verify the above conclusion shapes 11 to 13 with approximately half the overall dimensions of the original wec were also simulated indeed shape 13 box shaped displayed a significant improvement when compared to shape 12 but not relatively to shape 11 suggesting that a smaller waterplane area is also an important parameter in other words the hydrodynamic performance is reduced when the characteristic length of the submerged body is small in comparison to the wavelength from shape 14 to 22 non cylindrical shapes within the overall dimensions of the original design were also simulated shape 16 box shaped achieved a slightly better performance than shape 01 but without overcoming the original design shape 00 these shapes also confirm that the best hydrodynamic performances were obtained for bodies whose natural periods were closer to 10 s shape 19 and 21 furthermore shapes with protuberant fore and or aft volumes exhibit greater performances indeed shape 21 displayed a hydrodynamic performance of 39 5 i e close to twice the value of the original ceco s design after analyzing shapes 20 to 22 it was preliminary concluded that the fore protuberant volume which resembles a ship s bulbous bow has a significant beneficial effect in the wec performance so to verify that hypotheses shapes with only protuberant fore volumes were generated shapes 23 to 26 indeed all these shapes achieved a hydrodynamic index above 40 being shape 26 the best ηhydro max 50 thus evidencing a significant improvement in relation to ceco s original design notice that although viscous effects are not considered in the potential hydrodynamic model sharp edges were avoided in the final shapes to reduce losses associated with vortex shedding fig 9 presents the frequency response operator of absorbed power in regular waves while fig 10 presents the density spectrum of absorbed wave power for the target sea state i e the integrand of eq 9 its integration along the wave frequency allows the computation of the maximum average absorbed power i e under ideal pto damping fig 10 also highlights the better performance of shapes 24 and 25 however despite the highest peak of shape 25 in the response in regular waves and in the density spectrum the total amount of absorbed power of shape 24 is higher thus more hydrodynamically efficient than shape 25 as evidenced by the index of hydrodynamic performance in table 2 therefore shape 24 was selected as the shape to be adopted for the new ceco design it should be noticed that the new ceco design can be further improved by fine adjustments in the angle of inclination and or the submerged volume furthermore the inclusion of the support cylinder and the additional damping in the wec from viscous effects pto damping etc will lead to an increase in the natural oscillation period of the wec and consequently the improvement in the hydrodynamic performance of the new design due to the better tuning with the peak period of the target sea state regarding the pto damping the optimum values corresponding to the wec s natural period and to the peak period of the target sea state have been also presented in table 2 at the natural period the values are in general low compared to those achieved during the model tests with ceco s reference design lópez et al 2017a rodríguez et al 2019a fig 11 displays the curve of optimum pto damping that was used for the computation of the maximum absorbed power for regular and irregular waves shown in figs 9 and 10 respectively fig 12 shows the response amplitude operator rao of motion in regular waves considering only the radiation potential damping it can be noticed that the difference between the amplitudes of the peaks of raos of motion between the new and the reference design is not as big as the difference between the peaks of frequency response of absorbed power fig 9 but the shape of the motion response curve of the new design is broader than that of the reference design 5 validation of results after the optimization process the new design of ceco hereafter referred to as cecov2 is that corresponding to shape 24 to validate the conclusion of the optimization study regarding the new shape of the floaters a new experimental campaign was carried out the scale chosen for the model tests was 1 25 to allow the maximum expected motions of this wec in the available water depth of the wave basin of the hydraulics laboratory of the hydraulics water resources and environment division of the faculty of engineering of the university of porto feup portugal the available water depth in the basin is also associated to the operational limitations of the wave maker and for cecov2 s model tests corresponded to 20 0 m full scale i e slightly larger than the water depth used in the optimization studies 16 0 m the effect of the water depth in the results has been investigated through numerical simulations and it was found to be negligible to simplify the physical model test arrangements the same set up used in the experimental tests with ceco s reference design hereafter referred to as cecov1 was adopted lópez et al 2017a b rosa santos et al 2019a thus a central fixed cylinder perpendicular to the motion path was used to house the pto system due to space limitation during the construction of the physical model the separation distance between the two floaters needed to be increased to 6 25 m full scale value in comparison to the distance adopted in the optimization simulations the final separation distance resulted from the diameter of the central cylinder 5 0 m plus an additional distance between the cylinder and each of the floaters to allow their fixation to their connecting structure regarding the connecting structure which is basically a metallic frame composed of tubular members its effect on the hydrodynamic behavior has been considered negligible compared to that of the central cylinder thus it was not included in the numerical model at this stage fig 13 still in the context of the numerical simulations some previous calculations were necessary to validate the assumptions made in the preliminary analyses which were based on cevov1 those assumptions refer to the effect of the presence of the fixed support cylinder the submergence of the floaters and the inclination of the motion path fig 14 presents the response amplitudes of cecov2 s reference design characterized by a submergence in terms of draught of 52 inclination of 45 and water depth of 20 0 m together with alternative configurations to assess the above effects fig 14 confirms that neither the presence of the cylinder nor the water depth has a significant effect on cecov2 s hydrodynamic performance and that inclination and submergence have a strong impact on the natural oscillation period of this wec these conclusions are in agreement with the tendencies observed for cecov1 the overall experimental test campaign included pre tests with the pto system alone decay tests and tests in regular and irregular waves also systematic variations of the levels of pto damping have been considered including tests without the pto system for the experimental validation of the numerical conclusions of the optimization study only a few physical model tests results are presented namely those test conditions of cecov2 without pto damping fig 15 compares the experimental raos of cecov1 and cecov2 obtained from regular wave tests for wave periods around the corresponding natural periods these results confirm that cecov2 is a better motion converter than cecov1 for the period corresponding to the peak of the target sea state the response of cecov2 almost doubles the response of cecov1 fig 16 shows the motion response spectra of cecov2 for three irregular sea spectra namely the target sea state t p 10 s a sea state with a lower peak period t p 7 s and one with a larger peak period t p 13 s all with the same significant wave height h s 1 5 m for the sake of comparison the motion response spectra of cecov1 for similar sea states are plotted together notice that the significant wave heights in the experimental tests with cecov1 were larger h s 2 0 m despite the wave conditions for cecov1 being more energetic cecov2 displayed larger excursions than cecov1 for the target sea state fig 16 thus confirming the numerically predicted resonant behavior of cecov2 for the sea state with lower peak period cecov1 performs better than cecov2 the reason is that the lower peak period for cecov1 matches its resonant period 8 s while for cecov2 this peak period 7 s is quite far from its resonant period 10s for the sea state with the largest peak period cecov1 motions are slightly larger than those of cecov2 however it should be recalled that the waves for cecov1 h s 2 0 m are much more energetic than those for cecov2 h s 1 5 m the comparison of the experimental results obtained for cecov1 and cecov2 has allowed an indirect validation of the numerical outcomes of the optimization study however a more direct validation can be performed by comparing numerical simulations of motions with experimental results once damping has been calibrated using for instance the hybrid approach proposed by rodríguez et al 2019a this approach relies on the numerical rao of motion and the experimental incident wave time series to compute the numerical motion response spectra based on eq 7 starting with the radiation damping coefficient an additional external damping is iteratively applied in the rao of motion until the numerical response spectra matches the experimental one to obtain the calibrated external damping coefficient for the test conditions without pto damping the calibrated damping coefficient represents the hydrodynamic damping potential damping plus losses including viscous effects for the target sea state and cecov2 at the 45 inclination two additional pto damping levels has been experimentally tested too the experimental response spectra and the corresponding calibrated numerical spectra and numerical raos are shown in fig 17 since the hybrid calibration procedure for irregular seas is based on the area under the response spectrum it is inherently guaranteed that the significant response amplitude is the same for the experimental tests and the corresponding numerical simulation for conditions b pto 1 and b pto 2 the shapes of the calibrated response spectra also resemble quite well the corresponding experimental spectra thus evidencing the suitability of the linear hydrodynamic model and the calibration procedure the external damping coefficient total damping excluding potential effects for the condition without pto damping was 45 kn s m while for damping levels 1 and 2 the values were 110 kn s m and 195 kn s m respectively the absorbed power associated to those pto damping coefficients were 18 3 kw and 18 6 kw with capture efficiencies of 17 5 and 17 8 respectively notice that these efficiencies correspond to arbitrary values of pto damping tested during the experimental model tests according to the results presented in table 2 higher capture efficiencies may be achieved for lower pto damping coefficients further analyses are necessary to determine the best pto damping for a given wec condition but are out of the scope of the present study currently ceco is classified in the technological readiness level trl 3 4 where its performance is assessed through numerical studies and physical model tests higher stages of development of ceco will demand full scale tests where in principle the optimum geometry found in the prior numerical and experimental tests is expected to be used on the other hand the pto system will depend on the available technologies at the time of full scale testing currently most of the point absorber wecs adopt direct mechanical drive pto systems i e the same type of pto system used in the experimental tests carried out with ceco however more recently direct electrical drive systems have become more popular and an attractive solution to reduce mechanical losses 6 conclusions the hydrodynamic optimization of the geometry of the floaters of a sloped motion wec named ceco has been performed based on a time efficient frequency domain numerical model the optimization procedure relied on the use of the exhaustive search technique with heuristic approach prior to the optimization study some of the parameters that govern ceco s hydrodynamics were numerically investigated to understand their effects in advance so that the optimization procedure could only focus on the shape of the floaters those preliminary analyses allowed to conclude that the effects of the fixed central cylinder and of the water depth were negligible while the submergence level of the floaters and the inclination of the motion path determine the natural period of ceco the optimization study showed that the shape of the floaters controls also the natural period and depending on its tuning with the peak period of the target sea state a more efficient wave energy converter can be developed it was shown that the geometry obtained as the optimum solution from the numerical optimization study is able to harvest twice as much wave energy than the original ceco design cecov1 in order to validate the numerical outcomes experimental model tests have been conducted with the optimized geometry the experimental results with regular and irregular wave tests have confirmed that cecov2 is in fact a better motion converter than cecov1 in regular waves the peak of the rao of motion was almost twice the value measured for cecov1 in irregular waves the motion spectrum for the target sea state was significantly larger than the spectrum of cecov1 even considering a much more energetic sea state finally it was demonstrated that unlike pure heave oscillators where basically the main dimensions of the floaters control the natural frequency for ceco concept the inclination of the motion path submergence or shape of the floaters can be adjusted to achieve any natural oscillating period within a relatively broad range thus it is possible to adapt ceco parameters to tune it to any sea state so that high energy capture efficiencies can be obtained credit authorship contribution statement claudio a rodríguez conceptualization methodology formal analysis writing original draft writing review editing supervision paulo rosa santos conceptualization methodology validation writing review editing supervision francisco taveira pinto conceptualization methodology validation writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was financially supported by project ptdc mar tec 6984 2014 poci 01 0145 feder 016882 funded by feder funds through compete2020 programa operacional competitividade e internacionalização poci and by national funds through fct fundação para a ciência e a tecnologia i p 
22063,an innovative self elevating seawall is attracting attention as an effective countermeasure to protect ports and their hinterland from tsunamis however seawater may intrude into the port basin through a narrow gap between its gate units resulting in a significant water level change when a tsunami strikes herein a 2d 3d hybrid hydrodynamic model is used to investigate water inflow through the gap in a self elevating seawall induced by a tsunami that approaches a port a practical hydraulic head to discharge formula is then derived this formula is validated by a case analysis that numerically simulates the intrusion with a hypothetical time series of water levels originating from a tsunami and astronomical tide a self elevating seawall acts as an effective low pass filter system though it may not completely prevent inflow a case study for assessing a medium sized fishery port also demonstrates that tsunami induced impact can be significantly reduced by sheltering with the self elevating seawall system however a longer wave component such as astronomical tide will inevitably intrude into the port through the gate gap as well as the void of breakwater s rubble mound as seepage flow the risk of a secondary tsunami gate opening induced tsunami is also addressed for appropriate gate operations after a tsunami has receded the proposed model can calculate rise fall in water level over a port basin enclosed by the self elevating seawall and port breakwaters using a simple spreadsheet without expensive computational fluid dynamics keywords self elevating seawall tsunami intrusion gate gap practical formula case study breakwater rubble mound level 1 tsunami tide storm surge gate opening induced tsunami 1 introduction the great east japan earthquake and resulting tsunami that occurred in 2011 revealed weaknesses in the flood prevention structures that are currently in place tsunami breakwaters have been constructed in several bay mouths in northern japan over the last few decades these breakwaters were exclusively designed to protect bays ports and nearby communities from tsunamis when designing these structures seismic and high wave forces as well as tsunami forces must be considered resulting in breakwaters with massive dimensions and expensive costs for example the ofunato bay mouth breakwater the oldest tsunami breakwater in japan was constructed immediately after the chilean tsunami in 1960 however this breakwater was almost completely destroyed by the tsunami in 2011 the kamaishi tsunami breakwater was the largest in the world and was built in a maximum water depth of 63 m raby et al 2015 however this was also largely destroyed during the tsunami in 2011 allowing significant tsunami intrusion into kamaishi city the hydrodynamic scour due to the overtopping jet plunging down the landward side of the caisson and the punching failure of the rubble mound foundation were considered two fundamental causes of breakwater failure arikawa et al 2012 bricker et al 2013 esteban et al 2017 immediately after the disaster a governmental research institute publicly estimated that the tsunami height was probably reduced from 13 7 to 8 0 m and that the tsunami breakwater allowed residents an extra 6 min to evacuate however this estimation may not be completely reliable as it neglected the influence of several breakwater sections that were toppled during the tsunami cyranoski 2012 therefore much more research is needed to validate this shibayama et al 2013 in addition to uncertainties related to the effectiveness and durability of the structure the enormous construction cost e g 124 billion jpy approx 1 1 billion of the kamaishi tsunami breakwater will make it difficult to disseminate such technologies across the country and the world on the other hand general breakwaters are attracting attention as effective countermeasures to protect ports and their hinterland from tsunamis as these appeared to reduce fatality ratios in most coastal areas during the 2011 tsunami latcharote et al 2016 extensive investigation of the 1983 japan sea tsunami also indicated that upright revetments and breakwaters in many ports probably reduced tsunami run up heights tanimoto et al 1983 however the effectiveness of general breakwaters which were designed to reflect wind waves in reducing tsunami impact should not be overestimated takagi and bricker 2014 takagi 2015 when comparing the region protected by breakwaters with an unsheltered area in ishinomaki a tsunami simulation model showed no noticeable differences in inundation due to the 2011 tsunami because the tsunami intrudes through the port s wide openings a few hundred meters and rapidly fills the basin with seawater however a hypothetical simulation revealed that water levels could be greatly reduced if the port were fully enclosed by a self elevating seawall before a tsunami struck takagi and bricker 2014 storm surge barriers have been studied developed and constructed over the last few decades in several countries such as the united states uk netherlands italy france and japan pianc 2006 dircke et al 2012 present a systematic overview comparison and selection of six navigable storm surge barriers miter gate vertical lifting gate flap gate horizontal rotating gate vertical rotating gate and inflatable rubber dam the flap gate appears to be one of the most common self elevating structures this consists of a straight or curved retaining surface which is pivoted on a fixed axis at the sill erbisti 2004 among several others the gates being constructed in the mose project https www mosevenezia eu which aim to protect the city of venice may be the most famous structure of this type in the world fig 1 a iwate prefecture was the most damaged by the tsunamis in 2011 as these had heights exceeding 20 m mori et al 2012 with much support from the local inhabitants a port flap gate has been approved and its construction has started at a fishing port in ofunato bay in iwate fig 1 b although this has not been well recognized internationally it will become the first fully operational flap gate against tsunamis in the world the gate which consists of four separate walls is 32 m wide and 12 m high and is placed at a water depth of 4 5 m the estimated construction cost may reach 2 5 billion jpy 22 million more recently the macau sar government announced a plan for protecting the inner harbor area one of the areas most impacted from storm surge this plan involves a 650 m long huge movable floodgate system at the mouth of the wan chai waterway moura 2018 takagi et al 2019a although technologies are still being investigated many researchers have studied other types of self elevating tsunami gates over the last decade for example kimura et al 2010 proposed the flap gate breakwater which normally lies down on the seabed and rises as a sea wall driven by buoyancy when a tsunami strikes this type of structure appears similar to the gate of the mose project but employs a different supporting method nakashima et al 2011 investigated the performance of a vertical telescopic breakwater which consists of movable upper and fixed lower steel pipes hofland et al 2015 proposed a novel tsunami barrier consisting of a membrane floater and cables which are normally stored underground and are automatically floated by buoyancy a japanese research group for self elevating seawall rgss 2016 proposed a new type of structure which is stored under a pneumatic caisson system and is elevated when a tsunami strikes fig 2 the pneumatic caisson method is utilized in this technology which allows the construction of an underground structure and simultaneous excavation of the soil based on compressed air geotechnical engineering abe et al 2017 a common floodgate such as that shown in fig 1 c must be supported by massive columns to resist tsunami as well as seismic forces resulting in massive dimensions and costs on the other hand the self elevating seawall which is normally stored under the sea has many advantages over traditional floodgates particularly it is highly beneficial that ships can enter the port without height restrictions under normal operation also these structures will not mar the scenery unlike vertical lifting gates supported by huge columns and beams or an extension of the existing breakwater as shown in fig 3 a 2 m tsunami can be perfectly hold back by implementing the self elevating seawall if it can completely enclose the opening of a medium sized fishery port rgss 2016 however there appear to be weaknesses in the self elevating seawall structure most importantly a narrow gap between gate units would allow intrusion of seawater into the port basin which would probably cause significant water level changes when a tsunami struck while being sufficiently small a gap must exist between adjacent gate units because of mechanical systems that ensure smooth elevation of the gates even after a major earthquake fig 2 the gate shown in fig 1 c classified as a vertical lifting gate will not allow seawater intrusion when closed as the edges of the gate can be almost perfectly sealed with the concrete columns on the other hand self elevating seawalls such as those proposed by rgss 2016 and fujii et al 2018 figs 2 and 4 flap gates in venice fig 1 a and the rotating gate in the netherlands fig 1 d inevitably have slight gate gaps of at least a few tens of centimeters nakashima et al 2011 suggested that the gap width in the floating breakwater system should be less than 3 of the total stretch of the port breakwater however no technical procedure for estimating the tsunami inflow was presented flow through such a constriction is usually complicated that the resulting flow pattern is not readily subject to any analytical solution chow 1959 the mechanism of tsunami intrusion through the gaps cannot be easily evaluated using a commonly used tsunami numerical model because the gap is too narrow to be captured in the simulation a tsunami simulation protocol with a shallow water wave model suggests that the grid size should be reduced at a ratio of one third unesco 1997 for example if the smallest grid is connected to an 810 m grid which is a typical grid size over a large computational domain covering an ocean basin containing a seismic rupture area the nesting procedure must be repeated up to 10 times to obtain a 1 cm grid that is sufficient to capture the narrow gap between individual gates while theoretically possible such multiple connections appear to be computationally too expensive a tsunami may also intrude through the void of rubble mound beneath an existing breakwater fig 5 a hybrid structure known as caisson type breakwater is composed of caisson concrete and rubble mound tanimoto and goda 1991 the caisson structure is impermeable whereas the rubble mound inevitably undergoes seepage flow when difference in water level appears before and after the breakwater the rubble mound is submerged under the sea and generally as thin as 20 40 of the height of the caisson takagi and esteban 2013 a tsunami inflow due to the overtopping of a breakwater has been extensively investigated over the last decade esteban et al 2015 however the seepage flow during the rising phase of a tsunami appears to be invisible and thus this phenomenon tends to be overlooked the assessment of tsunami intrusion through the rubble mound is particularly important when a vertical lifting gate is installed in the port opening surrounded by long stretched breakwaters even if the lifting gate perfectly prevents from a tsunami entering seawater through the mound could raise the water level inside the port and might damage ships facilities and buildings in light of the seepage flow takata and takagi 2019 recently proposed the following practical formula to estimate the inflow discharge rate through a breakwater mound by conducting a hydraulic experiment and numerical analysis using openfoam their formula considered the nonstationary flow forchheimer flow in porous medium using the formula of ergun 1952 which incorporates size of medium and porosity of the layer usually about 40 for rubble mound 1 v β 2 g δ h where v is the mean velocity within rubble mound β is an experimental coefficient and g is the gravitational acceleration δ h is the hydraulic head difference between the sea side and the port side of the breakwater the value of β is recommended to use 0 0354 to best estimate the rate of seepage flow through the rubble mound composed of stones with the mean diameter of 50 cm rapid varied flows through the contractions in hydraulic structures have been extensively studied by hydraulic engineers for example the discharge coefficients for a vertical embankment with an opening can be readily derived from the diagrams provided by chow 1959 as these studies mostly considered steady flow in an open channel the continuity equation is valid between the upstream and downstream boundaries thereby simplifying the required calculations however to the best of the authors knowledge no reliable and practical methods have been proposed for estimating the intrusion of seawater caused by tsunamis or other types of long waves e g storm surges seiches through gaps in seawalls unlike in a river stream the downstream discharge is not an a priori condition when a tsunami approaches representing an unsteady flow therefore the conventional diagrams for open channel flows may not be applied when assessing the intrusion of seawater through the gate gaps due to a tsunami on the other hand wind waves passing through cylinders have been extensively studied by coastal engineers aiming to investigate the performance of special types of breakwaters such as wave screens and slit type breakwaters e g kakuno and liu 1993 mei et al 2005 the most advanced solutions of these systems are based on potential flow methods in which the velocity potentials are solved for both the linear incident and reflected waves by applying both far field boundary conditions and matching conditions at the wall boundary theoretical and experimental studies have both demonstrated that wave transmission decreases as the wave steepness increases and the porosity decreases kriebel 1992 the solutions derived by those potential approaches will satisfy the equation k r 2 k t 2 1 where k r and k t are the reflection and transmission coefficients respectively this implies that the solution lacks information pertaining to the time lag between the reflected and transmitted waves as wind waves are repetitive and short period processes this lag may not be very important however tsunamis cause water level rises falls over a much longer duration hence the time lag of the water level between the two sides of a gate is more significant for example a shorter time lags indicates a prompt response of the water level inside of the port in response to the rise of the water level due to tsunamis outside of the port and consequently the seawater will quickly rise in the port however this in turn reduces the gradient of the sea surface between the outer sea and the port basin resulting in a reduction of the inflow discharge this expected feedback mechanism between water levels inside and outside of the port cannot be readily accounted for by the potential theory used for wind waves given the lack of practical methods the present paper attempts to derive a method for calculating the inflow discharge caused by a tsunami whereby engineers can quickly estimate the water levels in an enclosed port one of the greatest motivations of this study is to provide a methodology that can be performed using a spreadsheet and involves no expensive numerical modeling processes by simply using the derived formula in a spreadsheet a case study is then conducted to examine whether or not a self elevating wall is effective even under unfavorable conditions considering inflows through the gate gap and the rubble mound of a breakwater 2 methodology this section describes tsunami waveforms assumed in this study followed by explanation on numerical models for the estimation of tsunami intrusions through the gap of a gate as a result a hydraulic head to discharge formula is derived to provide an assessment tool for tsunami intrusion 2 1 model tsunamis since the great east japan earthquake and tsunami in 2011 the idea that hard measures can completely protect the lives of inhabitants has been abandoned shibayama et al 2013 in order to classify according to the frequency magnitude of tsunami two levels were introduced by the central disaster management council of the cabinet office of japan 2011 level 1 tsunamis these are events with a return period of several decades to 150 years they generate low to medium inundation depths typically less than several meters both human lives and properties should be essentially saved by hard countermeasures level 2 tsunamis these are much rarer events typically taking place at intervals of a few hundred to a few thousand years the tsunami inundation depths would be much larger typically over 10 m but would encompass inundations reaching 20 30 m as hard countermeasures cannot work against this level of tsunami soft countermeasures need to be implemented to save people extremely high tsunami waves such as those categorized as a level 2 tsunami may break offshore and propagate in shallow coastal areas in the form of a violent hydraulic bore which consists of hydrostatic hydrodynamic and surge forces nistor et al 2009 in particular the surge force which is generated by the impingement of the advancing water front of a tsunami bore on a structure causes huge forces although accurately estimating the impact force remains a challenging task the city and county of honolulu building code cch has recommended the following formula to estimate this force based on a report by dames and moore 1980 2 f s 4 5 ρ g h 2 where f s is the surge force per unit width of the wall and h is the surge height this force is equivalent to 9 times the hydrostatic force typical coastal structures buildings and self elevating seawalls may not withstand such enormous forces given these emerging consensuses among japanese engineers the present study considers only moderately high tsunami waves such as those categorized as a level 1 tsunami against this level of tsunami protection measures must protect human lives and properties and effectively facilitate the evacuation of local inhabitants to safer places esteban et al 2017 in this study it was hypothesized that the self elevating seawall would not be breached by level 1 tsunamis though water levels would rise in front of the gate the range of tsunami heights was set at 1 4 m because an ordinary flood protection system can protect against this level of tsunami on the other hand a tsunami exceeding this range may overtop the existing port breakwater even if the port opening is closed by a gate nullifying the entire system the present study assumes that the long waves of a tsunami are represented by the flat pattern of water elevations shown the gaussian type tsunami pattern was also examined to investigate whether flow characteristics are influenced by a rapid increase in water surface elevation in front of the gate a time series of water levels could be represented by the following gaussian distribution which can reproduce a rapid rise and subsequent fall in water level of η 3 η η 0 exp t r 2 r where η 0 denotes the tsunami height t is time minutes and r is the rise time which is the time taken to reach the peak water level a total of eight water levels were examined in this study fig 6 the numerical offshore boundary condition will depend on how quickly the seawater rises as a tsunami approaches if the tsunami strongly impacts the gate as an impulsive tsunami a solitary wave or dam break type wave boundary may be used however it is currently generally acknowledged that incident tsunamis approaching coasts behave either as leading depression waves or leading elevation waves rather than as steep solitary waves madsen et al 2008 although tsunami wave forms may appear to be solitary waves the actual wave periods are generally much longer than those derived using the kdv equation typically shorter than 1 min for example fig 7 shows the water levels observed at three tide stations before and after the occurrence of the tsunami generated by the great east japan earthquake sendai port is located close to the epicenter while mera and chiba are both relatively distant from the epicenter mera faces the pacific ocean while chiba is inside of tokyo bay the identifiable major signals of the tsunami in these figures are not very short but it appears that each wave continued for at least 20 min it is also interesting to note that higher frequency waves disappeared in the inner bay at chiba wherein a wave period of approximately 60 min became predominant this is likely because of the shallow bathymetry that smoothed the waves propagating into the bay using satellite data which was obtained during the 2004 indian ocean tsunami gower 2005 estimated a wavelength at 430 km with a wave period of 37 min as the tsunami traveled over the deep ocean given these observations the long waves shown in fig 6 which possess periods of 6 min may be used to represent level 1 tsunamis at a port site 2 2 model for tsunami intrusion via gate gaps the authors used delft3d flow deltares 2011 constructed on the supercomputer tokyo tech tsubame ver2 5 17 1 pflops of single precision performance to simulate the flow through the narrow gap of a self elevating seawall the delft3d flow solves the unsteady shallow water equations in two or three dimensions the system of equations consists of the horizontal momentum equations the continuity equation the transport equation and a turbulence model the vertical momentum equation is reduced to the hydrostatic pressure relationship because the vertical accelerations are assumed to be small compared to the gravitational acceleration this feature makes the model particularly suitable for simulating flows that occur in shallow seas coastal areas and estuaries lesser et al 2004 deltares 2011 sasaki et al 2012 this hydrodynamic model was the most commonly used open source software in the world and selected from other equivalent models for two main reasons firstly it appears that a very small computational grid spacing and time step must be adopted to simulate a tsunami passing through such narrow gate gaps which connect with both the sea and port basin if the simulation is performed using an explicit scheme such as euler s method a preliminary study revealed that a time step of an order of 0 001 s would be required to stably simulate tsunami propagation as a longer time step would cause numerical instability this would not be economical on the other hand the delft model adopts the adi alternating direction implicit method for time integration which splits one time step into two stages since water velocities and water levels can be implicitly solved along grid lines by this method the courant number does not need to be below unity in practical situations the courant number could be relaxed to a value of 10 deltares 2011 contributing to a realistic computation secondly the model adopts domain decomposition dd which divides the computational domain into several smaller domains communication between the domains occurs along internal boundaries so called dd boundaries when using a parallel computing technique it should be noted that using a fully unstructured grid would allow as much or even more flexibility than using the dd method however connecting an unstructured grid with a spacing of several meters to those with spacings of a few centimeters by a short distance appears to be complex and the resultant model may be both inaccurate and inefficient three computational domains 1 outside the port 2 the tsunami gate and 3 inside the port are sequentially connected as shown in fig 8 with the dd boundary the middle domain was constructed with the finest grids to reproduce the narrow gap width assuming a range from 10 to 30 cm it is noted that a 3d grid vertically dividing 20 layers was applied to the middle domain to determine whether vertical flows are significant in addition to horizontal flows the k ε model was adopted for simulating turbulence while the bottom friction was evaluated with a manning s n value of 0 025 which is a typical value for seabed bricker et al 2015 the other two domains used a 2d horizontal grid thus the code is equivalent to a shallow water wave model takagi et al 2016 the grid size in the 2d 3d hybrid model varies in the flow direction from a maximum of 50 m inside and outside the port to a minimum of 4 cm within the narrow gap the total area of the port basin considered in this model is about 75 000 m2 7 5 ha which is typical of medium sized fishing ports in japan the computational time step was set as 0 03 s which appears to be sufficiently small to stably perform the computation including the gate gap with the adi method incident water levels as shown in fig 6 are imposed from the offshore boundary of domain 1 with no incident angle on the other hand an impermeable and indefinite high wall is assigned as the landward boundary in domain 3 to inhibit overflow of the port s apron the width of the tsunami gate was assumed to be 2 m by referencing to a standard dimension of the self elevating seawall proposed by rgss 2016 2 3 water levels and flow velocities inside and outside the gap the profiles of simulated water levels along the cross section of the gate gap clearly demonstrate that water surface elevation substantially dropped behind the gate fig 9 a total of eight incident wave patterns as shown in fig 6 were generated in front of the gate for the flat water level pattern the profiles are those output 3 min after the start of the simulation which coincides with the peak time of the gaussian scenario all the water levels are normalized by dividing by the incident heights 1 2 3 or 4 m measured at 5 m in front of the dyke shown as front in fig 8 to show the transmission ratio tr during the passage of waves through the gate gap the water level starts to drop immediately in front of the gate and the tr decreases by about 40 for all the scenarios the water level further drops within the gate gap but the extent of the drop is highly dependent on the initial tsunami height all the lines re converge behind the gate and drop rapidly to almost zero the profiles of flat and gaussian patterns are not remarkably different the tr decreases with increasing incident height inside the gate gap the larger the tsunami height the faster the flow velocity as shown in fig 10 for example the calculated velocity is about 1 5 m s for a height of 1 m while it increases to 6 m s for a height of 4 m the velocity shown in fig 10 is the depth averaged velocity which is calculated by dividing the flow discharge through the gap by the water depth at a given time and location it was useful that the delft3d flow model contains a module for estimating the depth averaged velocity although the velocity is relatively small before and after the gate it increases considerably when water passes through the gate gap although the water level drops in a staircase pattern there is no strong undulation and turbulence for a gate gap of 30 cm this is also confirmed by fig 11 which shows the froude number fr in addition to the tr fr increases as the gap width decreases fr exceeds unity when the gate width is 10 cm and 15 cm demonstrating that a hydraulic jump occurs near the gate exit where water intrudes into the port basin according to chow 1959 fr values between 1 7 and 2 5 and between 1 and 1 7 are classified as weak jumps and undular jumps respectively in these states the velocity is fairly uniform and energy loss is low although a series of small rollers develop on the surface of the jump the downstream water surface is expected to remain fairly smooth on the other hand fr is below unity for gap widths of 20 and 30 cm therefore no remarkable jumps occur one may consider making the gap as narrow as possible to prevent water inflow however the gap width then significantly influences the flow regime implying a trade off whereby a narrower gap may reduce the stability of hydrodynamic conditions inside and behind the gate 2 4 hydraulic head to discharge formula in this study the middle point of the gate indicated as mid in fig 8 was selected for estimating the inflow discharge this is because the flow is relatively stable at this point even in those cases with a hydraulic jump as demonstrated by figs 9 10 and 11 enabling precise measurement of the water discharge interestingly figs 9 and 10 demonstrate that the influence of the tsunami rise time on the inflow discharge is unremarkable and both the velocity and water elevation are similar for flat and gaussian patterns nevertheless fig 10 shows that the velocity in the gaussian case is about 6 smaller than in the flat one for η input values of 2 and 3 m however for the safety of the design as well as its practical simplicity the flat pattern is used to investigate water inflow via the gap in a self elevating seawall from here onwards the flow discharge via the gap in a gate was calculated using the following formula which is like torricelli s theorem 4 q γ c 2 g δ h h l w h γ c 2 g δ h w h where q is the flow discharge c is the discharge coefficient 1 g is the gravitational acceleration δ h and h f are the hydraulic head between the sea side and port side of the gate and the friction loss within the gate gap respectively w is the gap width and h is the water depth in the gate gap γ is a correction factor as will be explained later in this paper the friction loss h l can be calculated using the darcy welsbach formula and this value should be small when the gate width is narrow in this case study the gate width is as narrow as 2 m given that the quantification of the energy loss is highly uncertain this factor that reduces the calculated inflow discharge should be neglected during design to ensure that a safe design is achieved the discharge coefficient c which represents the total head loss can be estimated by rearranging equation 4 i e c q 2 g δ h w h using the numerical result for q which is presented in the previous section the discharge coefficient represents the balance between the momentum of a tsunami and energy loss that leads to a reduction in discharge through friction contraction expansion and eddy the larger the coefficient the more predominant the momentum which facilitates water flow via the gap the regression between the discharge coefficient and hydraulic head was derived for w 10 15 20 and 30 cm as follows w 10 cm 5 δ h 2 c 0 24 δ h 0 45 6 δ h 2 c 0 93 w 15 cm 7 c 0 04 δ h 2 0 34 δ h 0 18 0 93 w 20 cm 8 c 0 15 δ h 0 29 0 93 w 30 cm 9 c 0 15 δ h 0 25 0 93 fig 12 demonstrates some general characteristics of these relationships for example the discharge coefficient increases with the hydraulic head implying that seawater flows more easily into the port basin with relatively less momentum reduction as the tsunami height increases the discharge coefficient for a 10 cm gap is composed of two regression lines while the coefficients with the other gap widths are drawn in a simple linear manner this is because a hydraulic jump appears for a width of 10 cm and it begins when the hydraulic head exceeds 2 m if the flow becomes supercritical fr 1 the fluid motion is determined by the water levels in the downstream part of the port and subsequently the flat regression line is derived interestingly the regression line for a 15 cm gap can be expressed with a polynomial curve exhibiting a transition between the linear regression groups equation 4 is based on torricelli s theorem however the discharge coefficients with equations 5 9 were purely derived from the numerical analysis therefore the correction factor γ aims to modify the formula by incorporating some of the other energy dissipating mechanisms that cannot be fully reproduced by the present hydrodynamic model for example the delft3d flow model can reproduce moderate turbulence using the k ε model however this model cannot simulate highly turbulent flow such as breaking waves and dam break waves because the hydrostatic pressure assumption may limit the representation of fluid dynamics within around the gate gap nevertheless as explained earlier impulsive tsunami impacts are not considered in the present analysis because the self elevating seawall is expected to be designed considering the gradual rise fall in water levels in such an environment the hydrostatic assumption may be reasonable as the forces resulting from the tsunami should predominantly act in the horizontal direction the correction factor γ may be modified via experiment using a water flow or wave flume however the physical hydraulic test cannot also be readily carried out because the gate gap 10 30 cm in this study must be the same between the test scale model and the actual scale gate i e the components in the experiment cannot be scaled down using the froude similitude this condition cannot be reproduced within a normally sized flume which typically possesses a length of 10 20 m and a width of 1 m or less even if a large flume is available a very large pump with a high discharge capacity over 1 m3 s is required to maintain the water level difference in front of behind the gate obviously this is not a readily available option in addition the pump will also generate unnecessary and strong turbulence the authors wish to carry out large sized flume tests to validate the calculated discharge coefficients in the near future but it is recommended that the correction factor γ is simply assumed to be unity for now 3 results this section describes the reliability of the proposed formula by comparing it with the numerical model a spectrum analysis is also performed to investigate if any difference in performance of the self elevating seawall occurs as wave period changes finally a case study is conducted to examine the performance of the self elevating seawall under a realistic condition some of extra considerations are also addressed for achieving appropriate gate operations 3 1 simplified formula vs numerical model water discharge through a gate gap can be easily calculated by applying the discharge coefficients to the formula of equation 4 it is straightforward to investigate changes in water surface variation inside the port over time by assuming parameters such as the number of gate gaps gap width depth tsunami scenario and area of the port basin this level of calculation can be achieved even using an ordinary spreadsheet the proposed model was examined based on its ability to a reasonable prediction equivalent to the numerical simulation the water level in the port basin was output using delft3d to compare the proposed method with the numerical simulation although the same domain as that shown in fig 8 was used for the simulation a total of five gaps each with a 30 cm width were allocated at intervals of 15 m thus the sum of the gate gaps accounts for 0 7 1 5 215 m of the total extent of the self elevating seawall for this trial a hypothetical test tsunami up to 2 5 m was generated by combining a 2 m high tsunami r in equation 3 was set as 60 min and a semi diurnal tidal oscillation with a 1 m amplitude as shown in fig 13 the output point for the numerical result was placed at the center of a port basin with an area of 350 215 m after 60 min the tsunami reached its highest peak with a resultant water level reaching 2 5 m water level variations inside the port showed excellent agreement with each other validating the proposed formula in both results the sharp tsunami signal almost disappeared inside the port clearly showing the effectiveness of the self elevating seawall on the other hand the semi diurnal tide penetrated the port shows only slight attenuation as discussed further in the following section this implies that the performance of the gate depends on wave frequency as it tends to admit longer period waves 3 2 frequency analysis to further determine to what extent wave transmission through a self elevating seawall depends on its frequency a random tsunami was used as a test case generated by composing multiple component waves the range of long period waves is typically 5 min to 12 h covering tsunamis to astronomical tides munk 1950 in response to such a wide range of periods a total of 60 multiple component waves with equal amplitudes 20 cm was assumed for this study and different periods were superimposed resulting in a pseudorandom signal as shown in fig 14 the phase lag of each wave was determined by generating a uniformly distributed random number here the test wave is referred as a white noise tsunami because the signal is equivalent to random white noise in signal processing this test intends to examine the inflow characteristics in terms of the wave periods tsunamis naturally consist of a number of transient non periodic shorter and longer waves during the propagation of these waves from the ocean to a nearshore area these waves are gradually modified with respect to their amplitudes wave lengths and wave periods madsen et al 2008 therefore this test that involves the use of a white noise tsunami may be meaningful to investigate the performance of the self elevating seawall against tsunamis composed of many different wave components such as those shown in fig 7 the thick red line in fig 14 shows the output signal which corresponds to the water level inside a port protected by a self elevating seawall with five gaps each with a 30 cm width short period waves found in the input signal appear to mostly disappear whereas a long period fluctuation remains visible a more detailed response is shown in fig 15 which is the result of a fast fourier transform fft rather than showing an ordinary amplitude spectrum the vertical axis indicates the transmission ratio of each wave component which was calculated by dividing the output amplitude inside the port by the input amplitude outside the port 20 cm a longer wave component which is associated with the astronomical tide can be sufficiently reduced if there is only one gap however astronomical tidal components cannot be eliminated as the number of gaps increases likewise a typhoon storm surge may not be substantially reduced because typically it lasts over a few hours though shorter wave components during a storm e g wind waves infragrabity waves will be much reduced on the other hand a tsunami component which is typically shorter than an hour will be efficiently attenuated on passing the gate gap for this case the tsunami amplitude was reduced by 80 and 90 with ten and five gaps respectively the self elevating seawall effectively functions as a low pass filter system though it may not completely hold back seawater 3 3 case study all the observed tsunamis shown in fig 7 include a high degree of uncertain fluctuations therefore a detailed design must be conducted by incorporating a more realistic time series of tsunami fluctuation rather than a distinctive solitary wave such as the tsunami model shown in fig 13 for example the cabinet office of japan has publicized various tsunami scenarios that may occur along the coast of western japan during the imminent megathrust earthquake known as the nankai trough earthquake which is anticipated to happen within the next 30 years at a likelihood of 80 http www bousai go jp jishin nankai in the case that the authority responsible for overseeing tsunami disasters has already established such future tsunami scenarios engineers may directly use the official scenarios without performing any advanced simulations themselves fig 3 shows that a 2 m level tsunami which is one of the scenarios of the cabinet office of japan could be completely hold back by constructing a self elevating seawall in the opening of a port rgss 2016 the study by takagi and bricker 2014 also supports these expectations through their hypothetical analysis applied to ishinomaki fishery port where the 2011 tohoku tsunami devastated the town behind the port however their analysis essentially neglected possibility of tsunami intrusion through various voids such as gate gap and breakwater rubble mound therefore the authors re evaluated effectiveness of the self elevating seawall system by considering the combined influence of tsunami intrusion through the gate gap and the mound the port geometry is similar with the one studied by rgss 2016 as shown in fig 16 equations 1 and 4 were used to evaluate inflow discharge through the mound and the gap respectively and these results were linearly combined to calculate increase decrease in water level inside the port with its basin of 7 5 ha the breakwater is composed of caisson and rubble mound as the caisson is an impermeable structure only the submerged mound layer with a 2 m thickness is considered as a permeable part this port is assumed to be enclosed by a total of three self elevating gate units as a result 4 gate gaps each with a 30 cm width are created the discharge coefficient can be calculated by applying equation 9 fig 17 shows how the water level inside the port changes with water level outside which is composed of a level 1 tsunami for this port and astronomical tide a semi diurnal tide the time history of this potential tsunami was originally provided by a prefectural office which was based on the fundamental scenarios presented by the cabinet office of japan http www bousai go jp jishin nankai taisaku pdf 1 1 pdf while the longest wave component induced by the tide is not significantly reduced the rapid fluctuation due to the tsunami is mostly vanished within the port basin unlike the assessment by rgss 2016 under the ideal assumption tsunami substantially intrudes into the port however the peak of the tsunami can be reduced by about 90 cm which would mitigate the most powerful impact caused by the tsunami although this is highly dependent on the layout of port fig 16 demonstrates that the predominant influence is not caused by the inflow through the gate gap but that through the rubble mound hence the preliminary survey will be the most important factor to make the planned project to be success by finding a suitable port for installation of self elevating seawall 3 4 discussion extra considerations required the fewer the gate gaps the lower the wave transmission to minimize water intrusion induced by tsunamis and tides it is important to reduce the number of gate gaps as much as possible however a port opening of an order of 100 m will be protected by at least several separate gates of the self elevating seawall system rgss 2016 therefore planners and engineers in charge must firstly recognize that tsunami intrusion is unavoidable to some extent even if the port is protected by a well designed self elevating seawall a tsunami mitigation plan should be planned to minimize the impact of a tsunami inside the port area rather than aim for total elimination of tsunamis once water is allowed to enter to some extent engineers must consider additional design issues for example a strong water jet through a narrow gate gap might cause scouring erosion behind the self elevating seawall such strong flows might even destabilize ships on the port basin and thus an appropriate design for ensuring that ships are safely moored will also be required although this is outside the scope of the present paper the calculated discharge with the proposed formula can be used as an input boundary for computing velocity fields within the port basin such analysis will be highly useful for investigating the influence of tsunami intrusion on moored ships or estimating scouring behind the gate given that it takes 15 20 min to mechanically uplift the embedded gate it is required for the disaster management authority to immediately start the operation after the earthquake however it should be recognized that any modern system including self elevating seawall is unlikely to work against a very short warning time tsunami such as that triggered by submarine and or subaerial landslide takagi et al 2019b heidarzadeh et al 2020 the risk of a gate opening induced tsunami should also be addressed this secondary tsunami could potentially occur if the gate is unconsciously reopened for example if the water level outside the port is about to drop to zero at 360 min as shown in fig 13 the port authorities may decide to reopen the gate at this moment because rapid resumption of port operations is critical however the water level inside the port still exceeds 50 cm if the gate is suddenly opened a gate opening induced tsunami could be generated which could result in many unfavorable effects such as a strong drag on moored vessels and a returning tsunami engulfing adjacent coastal areas to avoid such unexpected impacts the port authorities must wait for the water levels outside and inside the port to coincide e g at 600 min in fig 13 a self elevating seawall can work only when adjacent port facilities also work against earthquakes as well as tsunamis out of 67 port breakwaters in the tohoku region 29 suffered damage due to the 2011 tsunami takagi 2015 many floodgates even withstood the 2011 great east japan earthquake and tsunami e g those in minami sanriku japan fig 18 but their adjacent coastal structures were destroyed nullifying the function of the gate itself such disastrous incidents may occur unless the adjacent structure is also carefully examined and improved if necessary as a part of the self elevating seawall system 4 conclusions self elevating seawalls are attracting attention as effective countermeasures against tsunamis particularly after the great east japan earthquake and tsunami in 2011 however a narrow gap between adjacent gate units would inevitably cause an intrusion of seawater into the port basin which cannot be simply simulated using common tsunami models because the gap is too small to be reproduced in the model the present study examines the water flow passing through a gate gap by applying a 2d 3d hybrid hydrodynamic model to derive the hydraulic head to inflow discharge conversion formula which is defined as q γ c 2 g δ h w h where q is the discharge g is gravitational acceleration δ h is the hydraulic head difference between the sea side and the port side of the seawall h is the water depth and w is the gap width the correction factor γ may be modified via experiment the discharge coefficient of c can be estimated by a regression formula which varies with the gap width between the relevant floodgates for example the relationship c 0 15 δ h 0 25 was derived for the case where w 0 3m the proposed model was verified through case studies in which a time series of hypothetical water levels composed of a level 1 tsunami and semi diurnal tide was simulated for a medium sized port with this proposed method and given the water level outside the port the water level rising over a port basin enclosed by floodgates and breakwaters can be calculated using a spreadsheet that do not require expensive computational fluid dynamics a frequency analysis is also performed to investigate to what extent the performance of the system is influenced by differences in wave period a self elevating seawall system acts as an effective low pass filter system against tsunamis though it may not completely hold back much longer wave components such as tides and storm surges last but not least the tsunami waveforms assumed in this study may not represent an impulsive solitary wave and therefore the derived formula should not be applied to such a violent tsunami credit authorship contribution statement ryoichi tomiyasu conceptualization writing review editing tomoyuki oyake conceptualization writing review editing taketo araki conceptualization writing review editing kyosuke mori conceptualization writing review editing yasuhiro matsubara conceptualization writing review editing yohei ninomiya conceptualization writing review editing yoshifumi takata conceptualization writing review editing declaration of competing interest we have no conflict of interest to declare acknowledgments funding for this research was supported by the grants to tokyo institute of technology from the jsps kakenhi no 16kk0121 and 19k04964 and the maeda engineering foundation the spreadsheet can be shared upon request takagi ide titech ac jp 
22063,an innovative self elevating seawall is attracting attention as an effective countermeasure to protect ports and their hinterland from tsunamis however seawater may intrude into the port basin through a narrow gap between its gate units resulting in a significant water level change when a tsunami strikes herein a 2d 3d hybrid hydrodynamic model is used to investigate water inflow through the gap in a self elevating seawall induced by a tsunami that approaches a port a practical hydraulic head to discharge formula is then derived this formula is validated by a case analysis that numerically simulates the intrusion with a hypothetical time series of water levels originating from a tsunami and astronomical tide a self elevating seawall acts as an effective low pass filter system though it may not completely prevent inflow a case study for assessing a medium sized fishery port also demonstrates that tsunami induced impact can be significantly reduced by sheltering with the self elevating seawall system however a longer wave component such as astronomical tide will inevitably intrude into the port through the gate gap as well as the void of breakwater s rubble mound as seepage flow the risk of a secondary tsunami gate opening induced tsunami is also addressed for appropriate gate operations after a tsunami has receded the proposed model can calculate rise fall in water level over a port basin enclosed by the self elevating seawall and port breakwaters using a simple spreadsheet without expensive computational fluid dynamics keywords self elevating seawall tsunami intrusion gate gap practical formula case study breakwater rubble mound level 1 tsunami tide storm surge gate opening induced tsunami 1 introduction the great east japan earthquake and resulting tsunami that occurred in 2011 revealed weaknesses in the flood prevention structures that are currently in place tsunami breakwaters have been constructed in several bay mouths in northern japan over the last few decades these breakwaters were exclusively designed to protect bays ports and nearby communities from tsunamis when designing these structures seismic and high wave forces as well as tsunami forces must be considered resulting in breakwaters with massive dimensions and expensive costs for example the ofunato bay mouth breakwater the oldest tsunami breakwater in japan was constructed immediately after the chilean tsunami in 1960 however this breakwater was almost completely destroyed by the tsunami in 2011 the kamaishi tsunami breakwater was the largest in the world and was built in a maximum water depth of 63 m raby et al 2015 however this was also largely destroyed during the tsunami in 2011 allowing significant tsunami intrusion into kamaishi city the hydrodynamic scour due to the overtopping jet plunging down the landward side of the caisson and the punching failure of the rubble mound foundation were considered two fundamental causes of breakwater failure arikawa et al 2012 bricker et al 2013 esteban et al 2017 immediately after the disaster a governmental research institute publicly estimated that the tsunami height was probably reduced from 13 7 to 8 0 m and that the tsunami breakwater allowed residents an extra 6 min to evacuate however this estimation may not be completely reliable as it neglected the influence of several breakwater sections that were toppled during the tsunami cyranoski 2012 therefore much more research is needed to validate this shibayama et al 2013 in addition to uncertainties related to the effectiveness and durability of the structure the enormous construction cost e g 124 billion jpy approx 1 1 billion of the kamaishi tsunami breakwater will make it difficult to disseminate such technologies across the country and the world on the other hand general breakwaters are attracting attention as effective countermeasures to protect ports and their hinterland from tsunamis as these appeared to reduce fatality ratios in most coastal areas during the 2011 tsunami latcharote et al 2016 extensive investigation of the 1983 japan sea tsunami also indicated that upright revetments and breakwaters in many ports probably reduced tsunami run up heights tanimoto et al 1983 however the effectiveness of general breakwaters which were designed to reflect wind waves in reducing tsunami impact should not be overestimated takagi and bricker 2014 takagi 2015 when comparing the region protected by breakwaters with an unsheltered area in ishinomaki a tsunami simulation model showed no noticeable differences in inundation due to the 2011 tsunami because the tsunami intrudes through the port s wide openings a few hundred meters and rapidly fills the basin with seawater however a hypothetical simulation revealed that water levels could be greatly reduced if the port were fully enclosed by a self elevating seawall before a tsunami struck takagi and bricker 2014 storm surge barriers have been studied developed and constructed over the last few decades in several countries such as the united states uk netherlands italy france and japan pianc 2006 dircke et al 2012 present a systematic overview comparison and selection of six navigable storm surge barriers miter gate vertical lifting gate flap gate horizontal rotating gate vertical rotating gate and inflatable rubber dam the flap gate appears to be one of the most common self elevating structures this consists of a straight or curved retaining surface which is pivoted on a fixed axis at the sill erbisti 2004 among several others the gates being constructed in the mose project https www mosevenezia eu which aim to protect the city of venice may be the most famous structure of this type in the world fig 1 a iwate prefecture was the most damaged by the tsunamis in 2011 as these had heights exceeding 20 m mori et al 2012 with much support from the local inhabitants a port flap gate has been approved and its construction has started at a fishing port in ofunato bay in iwate fig 1 b although this has not been well recognized internationally it will become the first fully operational flap gate against tsunamis in the world the gate which consists of four separate walls is 32 m wide and 12 m high and is placed at a water depth of 4 5 m the estimated construction cost may reach 2 5 billion jpy 22 million more recently the macau sar government announced a plan for protecting the inner harbor area one of the areas most impacted from storm surge this plan involves a 650 m long huge movable floodgate system at the mouth of the wan chai waterway moura 2018 takagi et al 2019a although technologies are still being investigated many researchers have studied other types of self elevating tsunami gates over the last decade for example kimura et al 2010 proposed the flap gate breakwater which normally lies down on the seabed and rises as a sea wall driven by buoyancy when a tsunami strikes this type of structure appears similar to the gate of the mose project but employs a different supporting method nakashima et al 2011 investigated the performance of a vertical telescopic breakwater which consists of movable upper and fixed lower steel pipes hofland et al 2015 proposed a novel tsunami barrier consisting of a membrane floater and cables which are normally stored underground and are automatically floated by buoyancy a japanese research group for self elevating seawall rgss 2016 proposed a new type of structure which is stored under a pneumatic caisson system and is elevated when a tsunami strikes fig 2 the pneumatic caisson method is utilized in this technology which allows the construction of an underground structure and simultaneous excavation of the soil based on compressed air geotechnical engineering abe et al 2017 a common floodgate such as that shown in fig 1 c must be supported by massive columns to resist tsunami as well as seismic forces resulting in massive dimensions and costs on the other hand the self elevating seawall which is normally stored under the sea has many advantages over traditional floodgates particularly it is highly beneficial that ships can enter the port without height restrictions under normal operation also these structures will not mar the scenery unlike vertical lifting gates supported by huge columns and beams or an extension of the existing breakwater as shown in fig 3 a 2 m tsunami can be perfectly hold back by implementing the self elevating seawall if it can completely enclose the opening of a medium sized fishery port rgss 2016 however there appear to be weaknesses in the self elevating seawall structure most importantly a narrow gap between gate units would allow intrusion of seawater into the port basin which would probably cause significant water level changes when a tsunami struck while being sufficiently small a gap must exist between adjacent gate units because of mechanical systems that ensure smooth elevation of the gates even after a major earthquake fig 2 the gate shown in fig 1 c classified as a vertical lifting gate will not allow seawater intrusion when closed as the edges of the gate can be almost perfectly sealed with the concrete columns on the other hand self elevating seawalls such as those proposed by rgss 2016 and fujii et al 2018 figs 2 and 4 flap gates in venice fig 1 a and the rotating gate in the netherlands fig 1 d inevitably have slight gate gaps of at least a few tens of centimeters nakashima et al 2011 suggested that the gap width in the floating breakwater system should be less than 3 of the total stretch of the port breakwater however no technical procedure for estimating the tsunami inflow was presented flow through such a constriction is usually complicated that the resulting flow pattern is not readily subject to any analytical solution chow 1959 the mechanism of tsunami intrusion through the gaps cannot be easily evaluated using a commonly used tsunami numerical model because the gap is too narrow to be captured in the simulation a tsunami simulation protocol with a shallow water wave model suggests that the grid size should be reduced at a ratio of one third unesco 1997 for example if the smallest grid is connected to an 810 m grid which is a typical grid size over a large computational domain covering an ocean basin containing a seismic rupture area the nesting procedure must be repeated up to 10 times to obtain a 1 cm grid that is sufficient to capture the narrow gap between individual gates while theoretically possible such multiple connections appear to be computationally too expensive a tsunami may also intrude through the void of rubble mound beneath an existing breakwater fig 5 a hybrid structure known as caisson type breakwater is composed of caisson concrete and rubble mound tanimoto and goda 1991 the caisson structure is impermeable whereas the rubble mound inevitably undergoes seepage flow when difference in water level appears before and after the breakwater the rubble mound is submerged under the sea and generally as thin as 20 40 of the height of the caisson takagi and esteban 2013 a tsunami inflow due to the overtopping of a breakwater has been extensively investigated over the last decade esteban et al 2015 however the seepage flow during the rising phase of a tsunami appears to be invisible and thus this phenomenon tends to be overlooked the assessment of tsunami intrusion through the rubble mound is particularly important when a vertical lifting gate is installed in the port opening surrounded by long stretched breakwaters even if the lifting gate perfectly prevents from a tsunami entering seawater through the mound could raise the water level inside the port and might damage ships facilities and buildings in light of the seepage flow takata and takagi 2019 recently proposed the following practical formula to estimate the inflow discharge rate through a breakwater mound by conducting a hydraulic experiment and numerical analysis using openfoam their formula considered the nonstationary flow forchheimer flow in porous medium using the formula of ergun 1952 which incorporates size of medium and porosity of the layer usually about 40 for rubble mound 1 v β 2 g δ h where v is the mean velocity within rubble mound β is an experimental coefficient and g is the gravitational acceleration δ h is the hydraulic head difference between the sea side and the port side of the breakwater the value of β is recommended to use 0 0354 to best estimate the rate of seepage flow through the rubble mound composed of stones with the mean diameter of 50 cm rapid varied flows through the contractions in hydraulic structures have been extensively studied by hydraulic engineers for example the discharge coefficients for a vertical embankment with an opening can be readily derived from the diagrams provided by chow 1959 as these studies mostly considered steady flow in an open channel the continuity equation is valid between the upstream and downstream boundaries thereby simplifying the required calculations however to the best of the authors knowledge no reliable and practical methods have been proposed for estimating the intrusion of seawater caused by tsunamis or other types of long waves e g storm surges seiches through gaps in seawalls unlike in a river stream the downstream discharge is not an a priori condition when a tsunami approaches representing an unsteady flow therefore the conventional diagrams for open channel flows may not be applied when assessing the intrusion of seawater through the gate gaps due to a tsunami on the other hand wind waves passing through cylinders have been extensively studied by coastal engineers aiming to investigate the performance of special types of breakwaters such as wave screens and slit type breakwaters e g kakuno and liu 1993 mei et al 2005 the most advanced solutions of these systems are based on potential flow methods in which the velocity potentials are solved for both the linear incident and reflected waves by applying both far field boundary conditions and matching conditions at the wall boundary theoretical and experimental studies have both demonstrated that wave transmission decreases as the wave steepness increases and the porosity decreases kriebel 1992 the solutions derived by those potential approaches will satisfy the equation k r 2 k t 2 1 where k r and k t are the reflection and transmission coefficients respectively this implies that the solution lacks information pertaining to the time lag between the reflected and transmitted waves as wind waves are repetitive and short period processes this lag may not be very important however tsunamis cause water level rises falls over a much longer duration hence the time lag of the water level between the two sides of a gate is more significant for example a shorter time lags indicates a prompt response of the water level inside of the port in response to the rise of the water level due to tsunamis outside of the port and consequently the seawater will quickly rise in the port however this in turn reduces the gradient of the sea surface between the outer sea and the port basin resulting in a reduction of the inflow discharge this expected feedback mechanism between water levels inside and outside of the port cannot be readily accounted for by the potential theory used for wind waves given the lack of practical methods the present paper attempts to derive a method for calculating the inflow discharge caused by a tsunami whereby engineers can quickly estimate the water levels in an enclosed port one of the greatest motivations of this study is to provide a methodology that can be performed using a spreadsheet and involves no expensive numerical modeling processes by simply using the derived formula in a spreadsheet a case study is then conducted to examine whether or not a self elevating wall is effective even under unfavorable conditions considering inflows through the gate gap and the rubble mound of a breakwater 2 methodology this section describes tsunami waveforms assumed in this study followed by explanation on numerical models for the estimation of tsunami intrusions through the gap of a gate as a result a hydraulic head to discharge formula is derived to provide an assessment tool for tsunami intrusion 2 1 model tsunamis since the great east japan earthquake and tsunami in 2011 the idea that hard measures can completely protect the lives of inhabitants has been abandoned shibayama et al 2013 in order to classify according to the frequency magnitude of tsunami two levels were introduced by the central disaster management council of the cabinet office of japan 2011 level 1 tsunamis these are events with a return period of several decades to 150 years they generate low to medium inundation depths typically less than several meters both human lives and properties should be essentially saved by hard countermeasures level 2 tsunamis these are much rarer events typically taking place at intervals of a few hundred to a few thousand years the tsunami inundation depths would be much larger typically over 10 m but would encompass inundations reaching 20 30 m as hard countermeasures cannot work against this level of tsunami soft countermeasures need to be implemented to save people extremely high tsunami waves such as those categorized as a level 2 tsunami may break offshore and propagate in shallow coastal areas in the form of a violent hydraulic bore which consists of hydrostatic hydrodynamic and surge forces nistor et al 2009 in particular the surge force which is generated by the impingement of the advancing water front of a tsunami bore on a structure causes huge forces although accurately estimating the impact force remains a challenging task the city and county of honolulu building code cch has recommended the following formula to estimate this force based on a report by dames and moore 1980 2 f s 4 5 ρ g h 2 where f s is the surge force per unit width of the wall and h is the surge height this force is equivalent to 9 times the hydrostatic force typical coastal structures buildings and self elevating seawalls may not withstand such enormous forces given these emerging consensuses among japanese engineers the present study considers only moderately high tsunami waves such as those categorized as a level 1 tsunami against this level of tsunami protection measures must protect human lives and properties and effectively facilitate the evacuation of local inhabitants to safer places esteban et al 2017 in this study it was hypothesized that the self elevating seawall would not be breached by level 1 tsunamis though water levels would rise in front of the gate the range of tsunami heights was set at 1 4 m because an ordinary flood protection system can protect against this level of tsunami on the other hand a tsunami exceeding this range may overtop the existing port breakwater even if the port opening is closed by a gate nullifying the entire system the present study assumes that the long waves of a tsunami are represented by the flat pattern of water elevations shown the gaussian type tsunami pattern was also examined to investigate whether flow characteristics are influenced by a rapid increase in water surface elevation in front of the gate a time series of water levels could be represented by the following gaussian distribution which can reproduce a rapid rise and subsequent fall in water level of η 3 η η 0 exp t r 2 r where η 0 denotes the tsunami height t is time minutes and r is the rise time which is the time taken to reach the peak water level a total of eight water levels were examined in this study fig 6 the numerical offshore boundary condition will depend on how quickly the seawater rises as a tsunami approaches if the tsunami strongly impacts the gate as an impulsive tsunami a solitary wave or dam break type wave boundary may be used however it is currently generally acknowledged that incident tsunamis approaching coasts behave either as leading depression waves or leading elevation waves rather than as steep solitary waves madsen et al 2008 although tsunami wave forms may appear to be solitary waves the actual wave periods are generally much longer than those derived using the kdv equation typically shorter than 1 min for example fig 7 shows the water levels observed at three tide stations before and after the occurrence of the tsunami generated by the great east japan earthquake sendai port is located close to the epicenter while mera and chiba are both relatively distant from the epicenter mera faces the pacific ocean while chiba is inside of tokyo bay the identifiable major signals of the tsunami in these figures are not very short but it appears that each wave continued for at least 20 min it is also interesting to note that higher frequency waves disappeared in the inner bay at chiba wherein a wave period of approximately 60 min became predominant this is likely because of the shallow bathymetry that smoothed the waves propagating into the bay using satellite data which was obtained during the 2004 indian ocean tsunami gower 2005 estimated a wavelength at 430 km with a wave period of 37 min as the tsunami traveled over the deep ocean given these observations the long waves shown in fig 6 which possess periods of 6 min may be used to represent level 1 tsunamis at a port site 2 2 model for tsunami intrusion via gate gaps the authors used delft3d flow deltares 2011 constructed on the supercomputer tokyo tech tsubame ver2 5 17 1 pflops of single precision performance to simulate the flow through the narrow gap of a self elevating seawall the delft3d flow solves the unsteady shallow water equations in two or three dimensions the system of equations consists of the horizontal momentum equations the continuity equation the transport equation and a turbulence model the vertical momentum equation is reduced to the hydrostatic pressure relationship because the vertical accelerations are assumed to be small compared to the gravitational acceleration this feature makes the model particularly suitable for simulating flows that occur in shallow seas coastal areas and estuaries lesser et al 2004 deltares 2011 sasaki et al 2012 this hydrodynamic model was the most commonly used open source software in the world and selected from other equivalent models for two main reasons firstly it appears that a very small computational grid spacing and time step must be adopted to simulate a tsunami passing through such narrow gate gaps which connect with both the sea and port basin if the simulation is performed using an explicit scheme such as euler s method a preliminary study revealed that a time step of an order of 0 001 s would be required to stably simulate tsunami propagation as a longer time step would cause numerical instability this would not be economical on the other hand the delft model adopts the adi alternating direction implicit method for time integration which splits one time step into two stages since water velocities and water levels can be implicitly solved along grid lines by this method the courant number does not need to be below unity in practical situations the courant number could be relaxed to a value of 10 deltares 2011 contributing to a realistic computation secondly the model adopts domain decomposition dd which divides the computational domain into several smaller domains communication between the domains occurs along internal boundaries so called dd boundaries when using a parallel computing technique it should be noted that using a fully unstructured grid would allow as much or even more flexibility than using the dd method however connecting an unstructured grid with a spacing of several meters to those with spacings of a few centimeters by a short distance appears to be complex and the resultant model may be both inaccurate and inefficient three computational domains 1 outside the port 2 the tsunami gate and 3 inside the port are sequentially connected as shown in fig 8 with the dd boundary the middle domain was constructed with the finest grids to reproduce the narrow gap width assuming a range from 10 to 30 cm it is noted that a 3d grid vertically dividing 20 layers was applied to the middle domain to determine whether vertical flows are significant in addition to horizontal flows the k ε model was adopted for simulating turbulence while the bottom friction was evaluated with a manning s n value of 0 025 which is a typical value for seabed bricker et al 2015 the other two domains used a 2d horizontal grid thus the code is equivalent to a shallow water wave model takagi et al 2016 the grid size in the 2d 3d hybrid model varies in the flow direction from a maximum of 50 m inside and outside the port to a minimum of 4 cm within the narrow gap the total area of the port basin considered in this model is about 75 000 m2 7 5 ha which is typical of medium sized fishing ports in japan the computational time step was set as 0 03 s which appears to be sufficiently small to stably perform the computation including the gate gap with the adi method incident water levels as shown in fig 6 are imposed from the offshore boundary of domain 1 with no incident angle on the other hand an impermeable and indefinite high wall is assigned as the landward boundary in domain 3 to inhibit overflow of the port s apron the width of the tsunami gate was assumed to be 2 m by referencing to a standard dimension of the self elevating seawall proposed by rgss 2016 2 3 water levels and flow velocities inside and outside the gap the profiles of simulated water levels along the cross section of the gate gap clearly demonstrate that water surface elevation substantially dropped behind the gate fig 9 a total of eight incident wave patterns as shown in fig 6 were generated in front of the gate for the flat water level pattern the profiles are those output 3 min after the start of the simulation which coincides with the peak time of the gaussian scenario all the water levels are normalized by dividing by the incident heights 1 2 3 or 4 m measured at 5 m in front of the dyke shown as front in fig 8 to show the transmission ratio tr during the passage of waves through the gate gap the water level starts to drop immediately in front of the gate and the tr decreases by about 40 for all the scenarios the water level further drops within the gate gap but the extent of the drop is highly dependent on the initial tsunami height all the lines re converge behind the gate and drop rapidly to almost zero the profiles of flat and gaussian patterns are not remarkably different the tr decreases with increasing incident height inside the gate gap the larger the tsunami height the faster the flow velocity as shown in fig 10 for example the calculated velocity is about 1 5 m s for a height of 1 m while it increases to 6 m s for a height of 4 m the velocity shown in fig 10 is the depth averaged velocity which is calculated by dividing the flow discharge through the gap by the water depth at a given time and location it was useful that the delft3d flow model contains a module for estimating the depth averaged velocity although the velocity is relatively small before and after the gate it increases considerably when water passes through the gate gap although the water level drops in a staircase pattern there is no strong undulation and turbulence for a gate gap of 30 cm this is also confirmed by fig 11 which shows the froude number fr in addition to the tr fr increases as the gap width decreases fr exceeds unity when the gate width is 10 cm and 15 cm demonstrating that a hydraulic jump occurs near the gate exit where water intrudes into the port basin according to chow 1959 fr values between 1 7 and 2 5 and between 1 and 1 7 are classified as weak jumps and undular jumps respectively in these states the velocity is fairly uniform and energy loss is low although a series of small rollers develop on the surface of the jump the downstream water surface is expected to remain fairly smooth on the other hand fr is below unity for gap widths of 20 and 30 cm therefore no remarkable jumps occur one may consider making the gap as narrow as possible to prevent water inflow however the gap width then significantly influences the flow regime implying a trade off whereby a narrower gap may reduce the stability of hydrodynamic conditions inside and behind the gate 2 4 hydraulic head to discharge formula in this study the middle point of the gate indicated as mid in fig 8 was selected for estimating the inflow discharge this is because the flow is relatively stable at this point even in those cases with a hydraulic jump as demonstrated by figs 9 10 and 11 enabling precise measurement of the water discharge interestingly figs 9 and 10 demonstrate that the influence of the tsunami rise time on the inflow discharge is unremarkable and both the velocity and water elevation are similar for flat and gaussian patterns nevertheless fig 10 shows that the velocity in the gaussian case is about 6 smaller than in the flat one for η input values of 2 and 3 m however for the safety of the design as well as its practical simplicity the flat pattern is used to investigate water inflow via the gap in a self elevating seawall from here onwards the flow discharge via the gap in a gate was calculated using the following formula which is like torricelli s theorem 4 q γ c 2 g δ h h l w h γ c 2 g δ h w h where q is the flow discharge c is the discharge coefficient 1 g is the gravitational acceleration δ h and h f are the hydraulic head between the sea side and port side of the gate and the friction loss within the gate gap respectively w is the gap width and h is the water depth in the gate gap γ is a correction factor as will be explained later in this paper the friction loss h l can be calculated using the darcy welsbach formula and this value should be small when the gate width is narrow in this case study the gate width is as narrow as 2 m given that the quantification of the energy loss is highly uncertain this factor that reduces the calculated inflow discharge should be neglected during design to ensure that a safe design is achieved the discharge coefficient c which represents the total head loss can be estimated by rearranging equation 4 i e c q 2 g δ h w h using the numerical result for q which is presented in the previous section the discharge coefficient represents the balance between the momentum of a tsunami and energy loss that leads to a reduction in discharge through friction contraction expansion and eddy the larger the coefficient the more predominant the momentum which facilitates water flow via the gap the regression between the discharge coefficient and hydraulic head was derived for w 10 15 20 and 30 cm as follows w 10 cm 5 δ h 2 c 0 24 δ h 0 45 6 δ h 2 c 0 93 w 15 cm 7 c 0 04 δ h 2 0 34 δ h 0 18 0 93 w 20 cm 8 c 0 15 δ h 0 29 0 93 w 30 cm 9 c 0 15 δ h 0 25 0 93 fig 12 demonstrates some general characteristics of these relationships for example the discharge coefficient increases with the hydraulic head implying that seawater flows more easily into the port basin with relatively less momentum reduction as the tsunami height increases the discharge coefficient for a 10 cm gap is composed of two regression lines while the coefficients with the other gap widths are drawn in a simple linear manner this is because a hydraulic jump appears for a width of 10 cm and it begins when the hydraulic head exceeds 2 m if the flow becomes supercritical fr 1 the fluid motion is determined by the water levels in the downstream part of the port and subsequently the flat regression line is derived interestingly the regression line for a 15 cm gap can be expressed with a polynomial curve exhibiting a transition between the linear regression groups equation 4 is based on torricelli s theorem however the discharge coefficients with equations 5 9 were purely derived from the numerical analysis therefore the correction factor γ aims to modify the formula by incorporating some of the other energy dissipating mechanisms that cannot be fully reproduced by the present hydrodynamic model for example the delft3d flow model can reproduce moderate turbulence using the k ε model however this model cannot simulate highly turbulent flow such as breaking waves and dam break waves because the hydrostatic pressure assumption may limit the representation of fluid dynamics within around the gate gap nevertheless as explained earlier impulsive tsunami impacts are not considered in the present analysis because the self elevating seawall is expected to be designed considering the gradual rise fall in water levels in such an environment the hydrostatic assumption may be reasonable as the forces resulting from the tsunami should predominantly act in the horizontal direction the correction factor γ may be modified via experiment using a water flow or wave flume however the physical hydraulic test cannot also be readily carried out because the gate gap 10 30 cm in this study must be the same between the test scale model and the actual scale gate i e the components in the experiment cannot be scaled down using the froude similitude this condition cannot be reproduced within a normally sized flume which typically possesses a length of 10 20 m and a width of 1 m or less even if a large flume is available a very large pump with a high discharge capacity over 1 m3 s is required to maintain the water level difference in front of behind the gate obviously this is not a readily available option in addition the pump will also generate unnecessary and strong turbulence the authors wish to carry out large sized flume tests to validate the calculated discharge coefficients in the near future but it is recommended that the correction factor γ is simply assumed to be unity for now 3 results this section describes the reliability of the proposed formula by comparing it with the numerical model a spectrum analysis is also performed to investigate if any difference in performance of the self elevating seawall occurs as wave period changes finally a case study is conducted to examine the performance of the self elevating seawall under a realistic condition some of extra considerations are also addressed for achieving appropriate gate operations 3 1 simplified formula vs numerical model water discharge through a gate gap can be easily calculated by applying the discharge coefficients to the formula of equation 4 it is straightforward to investigate changes in water surface variation inside the port over time by assuming parameters such as the number of gate gaps gap width depth tsunami scenario and area of the port basin this level of calculation can be achieved even using an ordinary spreadsheet the proposed model was examined based on its ability to a reasonable prediction equivalent to the numerical simulation the water level in the port basin was output using delft3d to compare the proposed method with the numerical simulation although the same domain as that shown in fig 8 was used for the simulation a total of five gaps each with a 30 cm width were allocated at intervals of 15 m thus the sum of the gate gaps accounts for 0 7 1 5 215 m of the total extent of the self elevating seawall for this trial a hypothetical test tsunami up to 2 5 m was generated by combining a 2 m high tsunami r in equation 3 was set as 60 min and a semi diurnal tidal oscillation with a 1 m amplitude as shown in fig 13 the output point for the numerical result was placed at the center of a port basin with an area of 350 215 m after 60 min the tsunami reached its highest peak with a resultant water level reaching 2 5 m water level variations inside the port showed excellent agreement with each other validating the proposed formula in both results the sharp tsunami signal almost disappeared inside the port clearly showing the effectiveness of the self elevating seawall on the other hand the semi diurnal tide penetrated the port shows only slight attenuation as discussed further in the following section this implies that the performance of the gate depends on wave frequency as it tends to admit longer period waves 3 2 frequency analysis to further determine to what extent wave transmission through a self elevating seawall depends on its frequency a random tsunami was used as a test case generated by composing multiple component waves the range of long period waves is typically 5 min to 12 h covering tsunamis to astronomical tides munk 1950 in response to such a wide range of periods a total of 60 multiple component waves with equal amplitudes 20 cm was assumed for this study and different periods were superimposed resulting in a pseudorandom signal as shown in fig 14 the phase lag of each wave was determined by generating a uniformly distributed random number here the test wave is referred as a white noise tsunami because the signal is equivalent to random white noise in signal processing this test intends to examine the inflow characteristics in terms of the wave periods tsunamis naturally consist of a number of transient non periodic shorter and longer waves during the propagation of these waves from the ocean to a nearshore area these waves are gradually modified with respect to their amplitudes wave lengths and wave periods madsen et al 2008 therefore this test that involves the use of a white noise tsunami may be meaningful to investigate the performance of the self elevating seawall against tsunamis composed of many different wave components such as those shown in fig 7 the thick red line in fig 14 shows the output signal which corresponds to the water level inside a port protected by a self elevating seawall with five gaps each with a 30 cm width short period waves found in the input signal appear to mostly disappear whereas a long period fluctuation remains visible a more detailed response is shown in fig 15 which is the result of a fast fourier transform fft rather than showing an ordinary amplitude spectrum the vertical axis indicates the transmission ratio of each wave component which was calculated by dividing the output amplitude inside the port by the input amplitude outside the port 20 cm a longer wave component which is associated with the astronomical tide can be sufficiently reduced if there is only one gap however astronomical tidal components cannot be eliminated as the number of gaps increases likewise a typhoon storm surge may not be substantially reduced because typically it lasts over a few hours though shorter wave components during a storm e g wind waves infragrabity waves will be much reduced on the other hand a tsunami component which is typically shorter than an hour will be efficiently attenuated on passing the gate gap for this case the tsunami amplitude was reduced by 80 and 90 with ten and five gaps respectively the self elevating seawall effectively functions as a low pass filter system though it may not completely hold back seawater 3 3 case study all the observed tsunamis shown in fig 7 include a high degree of uncertain fluctuations therefore a detailed design must be conducted by incorporating a more realistic time series of tsunami fluctuation rather than a distinctive solitary wave such as the tsunami model shown in fig 13 for example the cabinet office of japan has publicized various tsunami scenarios that may occur along the coast of western japan during the imminent megathrust earthquake known as the nankai trough earthquake which is anticipated to happen within the next 30 years at a likelihood of 80 http www bousai go jp jishin nankai in the case that the authority responsible for overseeing tsunami disasters has already established such future tsunami scenarios engineers may directly use the official scenarios without performing any advanced simulations themselves fig 3 shows that a 2 m level tsunami which is one of the scenarios of the cabinet office of japan could be completely hold back by constructing a self elevating seawall in the opening of a port rgss 2016 the study by takagi and bricker 2014 also supports these expectations through their hypothetical analysis applied to ishinomaki fishery port where the 2011 tohoku tsunami devastated the town behind the port however their analysis essentially neglected possibility of tsunami intrusion through various voids such as gate gap and breakwater rubble mound therefore the authors re evaluated effectiveness of the self elevating seawall system by considering the combined influence of tsunami intrusion through the gate gap and the mound the port geometry is similar with the one studied by rgss 2016 as shown in fig 16 equations 1 and 4 were used to evaluate inflow discharge through the mound and the gap respectively and these results were linearly combined to calculate increase decrease in water level inside the port with its basin of 7 5 ha the breakwater is composed of caisson and rubble mound as the caisson is an impermeable structure only the submerged mound layer with a 2 m thickness is considered as a permeable part this port is assumed to be enclosed by a total of three self elevating gate units as a result 4 gate gaps each with a 30 cm width are created the discharge coefficient can be calculated by applying equation 9 fig 17 shows how the water level inside the port changes with water level outside which is composed of a level 1 tsunami for this port and astronomical tide a semi diurnal tide the time history of this potential tsunami was originally provided by a prefectural office which was based on the fundamental scenarios presented by the cabinet office of japan http www bousai go jp jishin nankai taisaku pdf 1 1 pdf while the longest wave component induced by the tide is not significantly reduced the rapid fluctuation due to the tsunami is mostly vanished within the port basin unlike the assessment by rgss 2016 under the ideal assumption tsunami substantially intrudes into the port however the peak of the tsunami can be reduced by about 90 cm which would mitigate the most powerful impact caused by the tsunami although this is highly dependent on the layout of port fig 16 demonstrates that the predominant influence is not caused by the inflow through the gate gap but that through the rubble mound hence the preliminary survey will be the most important factor to make the planned project to be success by finding a suitable port for installation of self elevating seawall 3 4 discussion extra considerations required the fewer the gate gaps the lower the wave transmission to minimize water intrusion induced by tsunamis and tides it is important to reduce the number of gate gaps as much as possible however a port opening of an order of 100 m will be protected by at least several separate gates of the self elevating seawall system rgss 2016 therefore planners and engineers in charge must firstly recognize that tsunami intrusion is unavoidable to some extent even if the port is protected by a well designed self elevating seawall a tsunami mitigation plan should be planned to minimize the impact of a tsunami inside the port area rather than aim for total elimination of tsunamis once water is allowed to enter to some extent engineers must consider additional design issues for example a strong water jet through a narrow gate gap might cause scouring erosion behind the self elevating seawall such strong flows might even destabilize ships on the port basin and thus an appropriate design for ensuring that ships are safely moored will also be required although this is outside the scope of the present paper the calculated discharge with the proposed formula can be used as an input boundary for computing velocity fields within the port basin such analysis will be highly useful for investigating the influence of tsunami intrusion on moored ships or estimating scouring behind the gate given that it takes 15 20 min to mechanically uplift the embedded gate it is required for the disaster management authority to immediately start the operation after the earthquake however it should be recognized that any modern system including self elevating seawall is unlikely to work against a very short warning time tsunami such as that triggered by submarine and or subaerial landslide takagi et al 2019b heidarzadeh et al 2020 the risk of a gate opening induced tsunami should also be addressed this secondary tsunami could potentially occur if the gate is unconsciously reopened for example if the water level outside the port is about to drop to zero at 360 min as shown in fig 13 the port authorities may decide to reopen the gate at this moment because rapid resumption of port operations is critical however the water level inside the port still exceeds 50 cm if the gate is suddenly opened a gate opening induced tsunami could be generated which could result in many unfavorable effects such as a strong drag on moored vessels and a returning tsunami engulfing adjacent coastal areas to avoid such unexpected impacts the port authorities must wait for the water levels outside and inside the port to coincide e g at 600 min in fig 13 a self elevating seawall can work only when adjacent port facilities also work against earthquakes as well as tsunamis out of 67 port breakwaters in the tohoku region 29 suffered damage due to the 2011 tsunami takagi 2015 many floodgates even withstood the 2011 great east japan earthquake and tsunami e g those in minami sanriku japan fig 18 but their adjacent coastal structures were destroyed nullifying the function of the gate itself such disastrous incidents may occur unless the adjacent structure is also carefully examined and improved if necessary as a part of the self elevating seawall system 4 conclusions self elevating seawalls are attracting attention as effective countermeasures against tsunamis particularly after the great east japan earthquake and tsunami in 2011 however a narrow gap between adjacent gate units would inevitably cause an intrusion of seawater into the port basin which cannot be simply simulated using common tsunami models because the gap is too small to be reproduced in the model the present study examines the water flow passing through a gate gap by applying a 2d 3d hybrid hydrodynamic model to derive the hydraulic head to inflow discharge conversion formula which is defined as q γ c 2 g δ h w h where q is the discharge g is gravitational acceleration δ h is the hydraulic head difference between the sea side and the port side of the seawall h is the water depth and w is the gap width the correction factor γ may be modified via experiment the discharge coefficient of c can be estimated by a regression formula which varies with the gap width between the relevant floodgates for example the relationship c 0 15 δ h 0 25 was derived for the case where w 0 3m the proposed model was verified through case studies in which a time series of hypothetical water levels composed of a level 1 tsunami and semi diurnal tide was simulated for a medium sized port with this proposed method and given the water level outside the port the water level rising over a port basin enclosed by floodgates and breakwaters can be calculated using a spreadsheet that do not require expensive computational fluid dynamics a frequency analysis is also performed to investigate to what extent the performance of the system is influenced by differences in wave period a self elevating seawall system acts as an effective low pass filter system against tsunamis though it may not completely hold back much longer wave components such as tides and storm surges last but not least the tsunami waveforms assumed in this study may not represent an impulsive solitary wave and therefore the derived formula should not be applied to such a violent tsunami credit authorship contribution statement ryoichi tomiyasu conceptualization writing review editing tomoyuki oyake conceptualization writing review editing taketo araki conceptualization writing review editing kyosuke mori conceptualization writing review editing yasuhiro matsubara conceptualization writing review editing yohei ninomiya conceptualization writing review editing yoshifumi takata conceptualization writing review editing declaration of competing interest we have no conflict of interest to declare acknowledgments funding for this research was supported by the grants to tokyo institute of technology from the jsps kakenhi no 16kk0121 and 19k04964 and the maeda engineering foundation the spreadsheet can be shared upon request takagi ide titech ac jp 
22064,pipelines are widely used for transporting oil resources in offshore oil exploitation as burying an entire deep water pipeline is not possible owing to the large water depth an on bottom pipeline inevitably exhibits lateral global buckling deformation under high temperature and pressure in practice triggering several controllable mitigatory global buckling deformations by installing sleepers under pipelines is a more effective alternative to prevent cross sectional failure caused by excessive buckling while sleepers may trigger vertical global buckling and this risk must be verified before they are installed in practice this study analysed the feature of lifting deformation for a pipeline laid on a sleeper nine influential factors of the variation in the lifting displacement were analysed based on the nonlinear relationship between lifting displacement and temperature difference three key points and four relevant key parameters for describing the lifting displacement curve were proposed and calculated for the conditions of a pipeline with different combinations of influential factors a back propagation neural network was trained to model the relationship between the locations of the three key points and the values of the nine influential factors the error analysis indicated that the trained network can effectively predict the vertical lifting deformation and is suitable for a pipeline that experiences no lifting deformation based on the feature points predicted by the trained network the approximate profile of vertical lifting displacement during the heating process can be described and the assessment of whether the lifting displacement with the loading conditions in practice is allowable can be conducted keywords deep water pipeline sleepers vertical lifting deformation deformation prediction bp network notation d outer diameter of pipeline cross section e s seabed vertical stiffness h s initial vertical out of straight h v vertical lifting displacement h vm maximum vertical lifting displacement during heating process l total length of a pipeline l 0 wavelength of initial out of straight t wall thickness of pipeline cross section v 0 amplitude of initial out of straight w sub merged weight of per unit long pipeline section α thermal expansion coefficient δt temperature difference δt 1 temperature difference when pipeline section starts to deform upward δt 2 temperature difference when lifted pipeline section rests on sleeper again δt p temperature difference corresponding to peak point of lifting displacement μ friction coefficient for pipeline sleeper interaction μa equivalent axial pipe soil friction coefficient μl equivalent lateral pipe soil friction coefficient 1 introduction an efficient and safe transportation system the submarine pipeline system is widely used in offshore oil exploitation the high temperature and pressure cause pipelines to undergo global buckling deformation pipelines with excessive global buckling deformation experience large strain in bended sections which causes cross sectional failure nielsen et al 1990 pasqualino et al 2001 in the early stage of offshore oil exploitation only a shallow sea oil field was exploited offshore and on land pipelines were treated equally pipelines were placed in a trench and covered with soil and a heavy concrete block to prevent global buckling deformation ellinas et al 1990 palmer et al 1990 cathie and wintgens 2001 deng et al 2010 these treatments enhance the critical global buckling force and maintain the stability of pipelines in practice however with the increase in water depth the treatment of trenching and covering a pipeline has become extremely expensive and difficult in practice thus the pipeline global buckling protection method needs to be improved in deep water oil exploitation the covering treatment for a deep water pipeline is not feasible in practice hence pipelines are directly installed on the seabed which is slightly restricted by seabed soil around pipelines in addition a deep water pipeline exhibits a substantially larger temperature and pressure than a shallow water pipeline therefore a deep water pipeline inevitably exhibits lateral global buckling the priority of pipeline design is converted from preventing global buckling to triggering lateral global buckling and controlling lateral buckling deformation preston et al 1999 reported and analysed a new pipeline global buckling control method by laying pipeline with a zig zag shape to trigger controllable mitigatory lateral global buckling mitigatory lateral buckling reduces the axial compressive force in the deformation process to avoid the occurrence of concentrated and substantial buckling deformation of a pipeline without any treatment this lateral buckling decentralised strategy has been employed in an increasing number of projects to reduce the risk of cross section over bending harrison et al 2003 carr et al 2004 hooper et al 2004 junior et al 2004 matheson et al 2004 nystrøm et al 2012 rathbone et al 2008 wang et al 2015 yang et al 2010 solano et al 2012 guan et al 2007 chee et al 2018 in addition to a zig zag laid pipeline additional lateral global buckling triggering methods such as sleepers kristiansen et al 2005 silva junior et al 2008 nikkhaah et al 2009 li et al 2016 and distributed buoyancy block antunes et al 2010 peek and yun 2007 sriskandarajah et al 2011 were proposed and implemented the reliability of triggers in reducing the critical buckling force matheson et al 2004 hansen et al 2011 and stress distribution for the cross section of a post buckling pipeline chee et al 2018 hong et al 2015 hong and liu 2019 became the main focus in pipeline design a suitable design of buckling trigger distinctly reduces the critical buckling force and extends the lateral buckling to a mitigatory deformation with a low stress concentration among these buckling triggers the sleeper is selected with priority owing to its convenience and excellent performance sleepers reduce the critical buckling force by lifting a pipeline above the seabed to generate a vertical offset they should be carefully designed as the sub weight of a pipeline acts on sleepers which may then penetrate the seabed similar to the failure of strip footings zhou et al 2017 2018 even though the sleeper remains stable in the pipeline operation process the vertical offset of a pipeline may generate a risk to trigger vertical global buckling the touch down section of a pipeline generates more stress in vertical buckling deformation and pipeline failure is likely guijt 1990 ballet and hobbs 1992 therefore vertical global buckling is not allowed and the buckling form of a pipeline with sleepers should be estimated a sleeper which may trigger vertical global buckling must be re designed until only lateral buckling deformation remains a regular way to prevent vertical global buckling is to reduce the height of a sleeper to a critical value the small height of a sleeper is usually allowed based on this method as the effect of sleepers decreases with a reduction in height a shorter sleeper may not trigger and control lateral buckling as expected although a sleeper can reduce the critical buckling force unexpected buckling deformation may occur between two sleepers in practice hansen et al 2011 increasing the height of a sleeper may improve the effect of a sleeper on reducing the critical buckling force and prevent unexpected buckling deformation however a higher sleeper may also generate vertical deformation and threaten pipeline systems this study analysed the vertical lifting displacement of a pipeline laid on a sleeper and revealed the characteristics of the lifting displacement development curve with increasing temperature for a pipeline that contains man made lateral out of straightness oos statoil 2002 endal et al 2014 endal and nystrom 2017 chee et al 2018 a parametrical analysis of influential factors with regard to the variation in the displacement curve was also conducted a neural network for modelling the complex relationship between the influential factors and feature points of the lifting displacement curve was trained based on a large number of finite element analysis fea results an error analysis was also performed to verify the prediction accuracy 2 description of finite element analysis model the research was conducted using the commercially available software abaqus with implicit dynamical analyses the latter can be performed to calculate the transient dynamic or quasi static response of a system lateral global buckling of a pipeline occurs because of the temperature load and the inertia effects substantially change in the long heating procedure the inertia effect can be considerable at the moment of lateral global buckling as the structure loses stability and the pipeline section laterally deforms over time the inertia effect decreases and can be disregarded at a subsequent stage of lateral global buckling the implicit dynamical analysis offers an efficient method for obtaining a brief and strong dynamical response and a snap through structural response with less computational cost the pipeline was prescribed with the element type of s4r the axial movement of the two pipeline endpoints were fixed the other part of the pipeline with the exception of the two endpoints expanded in the axial direction and freely deformed in both the vertical and lateral directions the pipeline was axially meshed with an interval of 1 m and each pipeline cross section was assigned 12 elements the sleeper was simulated with the element type c3d8r with restricted lateral movement of all elements the seabed was simulated with the element type c3d8r lateral displacements of all sides were restricted and movements in all three directions of the seabed bottom were fixed the seabed was also meshed with an interval of 1 m in the axial direction the cross section of the seabed was assigned 11 meshes in the lateral direction and 3 meshes in the vertical direction the axial length of the seabed equalled the total length of the pipeline which was sufficient for the seabed as the axial movement of the two endpoints of the pipeline was fixed to simulate the virtual anchor point in practice the width of the seabed and sleeper should be larger than the maximum lateral displacement of the pipeline generated in the heating process therefore the specific width differs in different cases the depth of the seabed is 1 m which is sufficiently deep for these simulations the pipe soil interaction was modelled with a general contact algorithm that obeys a coulomb friction law peek and yun 2007 walker et al 2010 wang et al 2017 shi and wang 2015 hong et al 2019 chee et al 2019 the lateral coefficient and axial friction coefficient termed μl and μa respectively between the pipeline and the seabed remain constant during the pipeline global buckling process the constant friction between the pipeline and sleeper was termed μ the loading conditions are specified as follows 1 a vertical load was applied to make the sleeper contact the seabed 2 the initial lateral oos was introduced into the pipeline by editing the input file 3 the gravity of the pipeline was applied to simulate the pipeline laying process and an initial vertical oos was shaped by the sleeper between the seabed and the pipeline section in this process 4 the pipeline was uniformly heated to trigger the global buckling deformation the total temperature difference is termed δt in the simulation fig 1 demonstrates the configuration of the finite element analysis model as shown in fig 1 the pipeline contains initial oos in both the vertical and lateral directions before exhibiting the temperature load in the simulation the wavelength of the lateral initial oos is termed l 0 and its amplitude is termed v 0 the vertical oos of a pipeline that lifts from the seabed by the sleeper is termed h s the midpoint of the pipeline rested on the sleeper and other pipeline sections farther from the midpoint rested on the seabed owing to the submerged weight of the pipeline 3 post buckling deformation behaviour a reference case was simulated to illustrate the development of post buckling configuration for a pipeline laid on a sleeper the input parameters are listed in table 1 for comparison a pipeline without initial lateral oos was also simulated fig 2 depicts the post buckling configurations of the two pipelines during the heating process a pipeline laid on a sleeper exhibiting no initial lateral oos experiences and only vertical displacement was considered the pipeline section moved vertically and was lifted away from the sleeper no contact with the sleeper the vertical lifting displacement h v which is the value of the vertical gap between the sleeper and the pipeline section increases with the increment in the temperature difference δt as depicted in fig 2 a in contrast the pipeline laid on the sleeper with existing initial lateral oos underwent both vertical displacement and lateral displacement during the heating process the vertical lifting displacement h v initially increased and then decreased with the increment in δt at a subsequent stage of the heating process the pipeline section again rested on the sleeper the value of h v peaked when the temperature difference δt reached 50 c and declined to zero when the temperature difference δt was 88 c in the reference case fig 3 depicts the vertical deformation of the pipeline midpoint which is also the touchpoint on the pipeline and sleeper the development of vertical lifting displacement of the midpoint during the entire heating process is nonlinear the temperature difference at the moment of vertical displacement which coincides with the moment that the pipeline section starts lifting away from the sleeper is termed δt 1 the temperature difference at the moment when vertical displacement vanished which is also the moment that the pipeline section rested again on the sleeper is termed δt 2 the temperature range δt 1 δt 2 is termed the risky zone which means that the pipeline section is at risk of lifting deformation within this temperature range the maximum value of h v is termed h vm and its corresponding temperature difference is termed δt p the value of δt 1 δt 2 and h vm are 26 c 88 c and 0 49 m for the reference case when the temperature difference δt is larger than 26 c and less than 26 c the pipeline section is suspended above the sleeper owing to the buckling deformation this vertical deformation may threaten the stability and safety of the pipeline according to the post buckling configuration comparison between a pipeline with initial lateral oos and a pipeline without it the vertical lifting deformation of the pipeline laid on a sleeper occurs in the heating process of both the pipelines and vanishes only if the pipeline contains an initial lateral oos additionally a pipeline that contains an initial lateral oos also undergoes lifting displacement when the temperature difference δt is located in the risky zone in practice therefore the values of δt 1 δt 2 δt p and h vm are important for assessing the possibility of vertical lifting deformation when the following two conditions occur in practice 1 practical δt is beyond the risky zone and 2 predicted h vm is negligible the pipeline may undergo only a slight risk of lifting deformation considering the values of δt 1 and δt 2 δt p and h vm are dependent on the combinations of the influential parameters a parametrical analysis of the impact of the influential parameters on the values of δt 1 δt 2 δt p and h vm is proposed the following section presents the influence rule of these parameters all the nine influential parameters are classified into three categories geometry of the initial oos seabed properties and pipeline properties the geometry of the initial oos contains three influential parameters initial vertical oos h s initial lateral oos wavelength l 0 and amplitude v 0 the seabed properties contain three influential parameters equivalent lateral soil resistance coefficient μl equivalent axial soil resistance coefficient μa and seabed vertical stiffness e s the pipeline properties contain three influential parameters submerged weight w pipeline total length l and pipe sleeper friction coefficient μ table 2 presents the typical conditions in offshore pipeline design bruton et al 2007 2010 chee et al 2018 guan et al 2007 hansen et al 2011 harrison et al 2003 li et al 2016 the results presented in section 4 were obtained by changing one of the nine influential parameters each time and setting the remaining eight influential parameters equal to the values in the reference case 4 impact of influential factors on upheaval deformation 4 1 geometry of initial oos fig 4 illustrates the influence of h s on the vertical lifting displacement h v the initial vertical oos h s ranges from 0 75 m to 1 5 m h s of reference case is 1 m the pipeline with the higher h s may undergo more serious vertical lifting deformation when the other 8 influential factors remain unchanged the values of δt 2 and δt p increase and h vm rapidly increases with the increment in h s when h s equals 1 5 m the values of δt 2 δt p and h vm are 150 c 82 c and 1 4 m respectively fig 5 depicts the impact of lateral oos geometry on the vertical lifting displacement h v the dark line represents h v of the reference case the blue lines represent the impact of the lateral oos amplitude v 0 on h v in comparison with the reference case and the red lines represent the impact of the lateral oos length l 0 on h v in comparison with the reference case the results reveal that the lateral oos geometry both v 0 and l 0 does not have an effect on δt 1 however δt 2 δt p and h vm increase with a decrement in v 0 or an increment in l 0 a pipeline experiences more gentle vertical lifting deformation when the lateral oos has a larger value of v 0 l 0 4 2 seabed properties fig 6 shows the impact of lateral soil resistance on the vertical lifting displacement the temperature difference δt 1 with vertical displacement was not affected by μl the values of δt 2 δt p and h vm increase with a decrement in μl and the rate of increase of h vm to the variation in μl gradually decreases with an increment in μl a pipeline undergoes more substantial vertical lifting deformation when the lateral soil resistance is strong fig 7 shows the impact of the lateral soil resistance on the vertical lifting displacement the values of δt 2 δt p and h vm decrease with an increment in μa whereas the value of δt 1 increases with an increment in μa the temperature difference range decreases owing to the increase in the temperature difference δt 1 at the beginning of the vertical deformation and the decline in the temperature difference δt 2 at the ending of the vertical deformation when the axial resistance in the pipeline section increases fig 8 shows the impact of the seabed soil stiffness e s on the vertical lifting displacement the value of δt 1 barely changes with the variation in e s the values of δt 2 δt p and h vm decrease with the decrement in e s only when the seabed is sufficiently soft however the decrements in δt 2 δt p and h vm due to the softening of the seabed are limited 4 3 pipeline properties fig 9 depicts the impact of the submerged weight w on the vertical lifting displacement the values of δt 2 δt p and h vm decrease with the increment in w whereas the decreasing rate reduces with the incremental w the heavier pipeline experiences a shorter temperature difference range of vertical deformation and lower maximum vertical displacement fig 10 depicts the impact of the total length l of the pipeline on the vertical lifting displacement the temperature differences δt 1 at the beginning of the vertical deformation and δt 2 at the end of the vertical deformation increase with the increment in l based on the three cases depicted in fig 10 the temperature difference range increases with the increase in l a longer pipeline undergoes more substantial vertical lifting deformation fig 11 depicts the impact of pipe sleeper friction on the vertical lifting displacement larger pipe sleeper friction can reduce the vertical lifting deformation not only with the declining temperature difference δt 2 at the ending of the vertical deformation but also the maximum lifting displacement h vm and its corresponding temperature difference δt p this reduction effect is limited when the pipe sleeper friction becomes sufficiently large as depicted in figs 4 11 the value of δt 1 is relatively stable which is only affected by μa w and l the value of δt 1 varies from 24 c to 40 c which is considerably lower than the temperature employed in practice and lifting deformation cannot be avoided by reducing the temperature load to the value of δt 1 all nine influential factors affect δt 2 δt p and h vm to some degree especially the initial vertical and lateral oos when h s is sufficiently small or v 0 l 0 is sufficiently large the vertical lifting displacement will not occur during the heating process 5 prediction of post buckling behaviour 5 1 modelling of relationship between influential factors and behaviour of lifting displacement section 4 presents the impact of each influential factor on the vertical lifting deformation for pipelines laid on sleepers nine influential factors affect the lifting displacement behaviours in different ways and degrees once the relationship between the nine influential factors and the vertical lifting displacement behaviours is established the risk of lifting deformation for a pipeline laid on a sleeper can be predicted as previously presented the relationship between lifting displacement and temperature difference exhibits a parabolic type curve and the beginning ending and peak points are key parameters for describing this curve therefore the relationship between the lifting displacement and the temperature difference can be expressed as a function of nine influential factors and four key parameters δt 1 δt 2 δt p and h vm further study based on section 4 shows that the relationship between the increasing or decreasing rate of δt 1 δt 2 δt p and h vm and any of the nine influential factors depends on the values of the other 8 influential factors and the nine influential factors are non independent variables in predicting δt 1 δt 2 δt p and h vm complex mathematics must be used in simulating this nonlinear complex relationship therefore a backpropagation bp neural network was used to establish the analytical solution in predicting the vertical lifting displacement behaviour for a pipeline laid on a sleeper a bp neural network is a type of multi layer feedforward network that is trained according to error backpropagation the premise of bp the gradient descent method minimises the mean square error of the actual output and expected output values by proposing the gradient search technique fig 12 depicts the typical structure of a bp neural network which contains three layers input hidden and output layers the number of nodes on the input and output layers are determined by actual requirements and the number of hidden layers and the number of nodes on them are determined by the modelling requirements the training of the bp neural network in this study was conducted with matlab software herein the input layer has nine nodes which are h s v 0 l 0 μl μa e s w l and μ and the output layer has nine nodes which are δt 1 δt 2 δt p and h vm two hidden layers are established in the modelling the number of nodes in the first and second hidden layers is 9 the transfer function in the first hidden layer is the linear function purelin and the transfer function in the second hidden layer is the log sigmoid function logsig the transfer function in the output layer is the hyperbolic tangent sigmoid function tansig the training target error learning of the neural network and maximum training time are set to 0 0001 0 0001 and 60 000 respectively other parameters of the network follow the default value the neural network calculation applies the following procedure 1 first initialise the connecting weights from neurons on the input layer to those on the hidden layer and the connecting weights from the neurons on the hidden layer to those on the output layer 2 second normalise the input data and calculate the value of the neurons on the hidden layer with assumed weight 3 calculate the value of the neurons on the output layer based on the assumed weight and value of the neurons on the hidden layer 4 calculate the error according to the output results 5 compute the partial derivatives of the error functions with respect to the neurons on the output layer modify the connecting weights from the neurons on the input layer to those on the hidden layer and the connecting weights from the neurons on the hidden layer to those on the output layer 6 calculate the global error and assess whether the network error satisfies the requirement when the error is smaller than the requirement or the learning time reaches the maximum the training ends otherwise choose the next learning sample and a corresponding desired output and start the next round of training to train the bp neural network we simulated an additional 200 cases and the variations in the vertical lifting displacement of these models were obtained at least two influential factors changed in comparison with the reference case in each of these 200 cases the values of the changed factors were randomly determined within the common value ranges which are listed in table 2 the results from 180 of the 200 added cases with the results from the 19 cases presented in section 4 form the training database among the 199 training cases no lifting displacement occurs in 18 different cases during the entire heating process the other results from 20 of the added 200 cases comprise the testing database 5 2 error analysis of the established model the neural network was trained and tested and the relative error between the predicted results and the fea simulation results of δt 1 δt 2 δt p and h vm for the 20 cases are depicted in fig 13 the lifting displacement curve in fig 13 was normalised for a better analysis of the relative error all predicted results are located in the circles which represent a critical value with 15 relative error of the 20 cases in the error analysis lifting displacement occurred in three cases according to the fea results the neural network successfully predicts zero lifting displacement for all three cases the trained network demonstrates high accuracy in predicting the vertical deformation of a pipeline laid on a sleeper 6 conclusions a pipeline laid on a high sleeper may experience vertical global buckling which causes considerable stress concentration and increases the risk of vortex induced vibration failure this study analysed the deformation feature of the lifting deformation of a pipeline laid on a sleeper the main conclusions are presented as follows 1 the vertical lifting deformation is caused by the initial oos which is generated by the sleeper the vertical lifted pipeline section can rest on the sleeper after the lifting deformation when the pipeline has lateral oos the lifting displacement varies non monotonically with the increment in temperature difference 2 the parabolic type curve of vertical displacement during the heating process can be approximately described by three key points beginning ending and peak points therefore at least four key parameters are utilised the beginning temperature difference δt 1 ending temperature difference δt 2 temperature difference that corresponds to the peak point δt p and maximum lifting displacement h vm if the temperature difference δt used in engineering practice is located in a risky zone δt 1 δt δt 2 the pipeline section will experience lifting deformation 3 the development of vertical lifting displacement is primarily affected by nine influential factors including initial oos geometry seabed property and pipeline property the critical temperature difference when the pipeline section starts to deform upward is relatively stable and only affected by μa w and l the value of δt 1 is considerably smaller than the temperature load in practice and lifting deformation cannot be prevented by reducing the temperature load to equal the value of δt 1 among the nine influential factors the initial vertical oos lateral oos amplitude and wavelength exhibit the most significant influence when h s is sufficiently small or v 0 l 0 is sufficiently large the vertical lifting displacement does not occur during the heating process 4 a parametrical analysis of the nine influential factors of the variation in the vertical displacement development curve was performed as the relationship between the nine influential factors and the four key parameters is complex and the former are non independent variables a backpropagation neural network was employed for modelling a four layer network including two hidden layers was trained the accuracy of this network was verified the relative error of the three key points of the lifting displacement development curve is lower than 15 for all 20 cases the network is also suitable for a pipeline that does not undergo lifting displacement with the trained network feature points of the lifting displacement curve for a pipeline with different conditions can be easily calculated and the profile of the curve of lifting displacement can be constructed without numerical simulations the assessment of whether the lifting displacement in the loading conditions is feasible in practice and the following optimisation analysis can be quickly performed author contributions section zhaohui hong conceptualization methodology software visualization wenbin liu validation formal analysis resources writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
22064,pipelines are widely used for transporting oil resources in offshore oil exploitation as burying an entire deep water pipeline is not possible owing to the large water depth an on bottom pipeline inevitably exhibits lateral global buckling deformation under high temperature and pressure in practice triggering several controllable mitigatory global buckling deformations by installing sleepers under pipelines is a more effective alternative to prevent cross sectional failure caused by excessive buckling while sleepers may trigger vertical global buckling and this risk must be verified before they are installed in practice this study analysed the feature of lifting deformation for a pipeline laid on a sleeper nine influential factors of the variation in the lifting displacement were analysed based on the nonlinear relationship between lifting displacement and temperature difference three key points and four relevant key parameters for describing the lifting displacement curve were proposed and calculated for the conditions of a pipeline with different combinations of influential factors a back propagation neural network was trained to model the relationship between the locations of the three key points and the values of the nine influential factors the error analysis indicated that the trained network can effectively predict the vertical lifting deformation and is suitable for a pipeline that experiences no lifting deformation based on the feature points predicted by the trained network the approximate profile of vertical lifting displacement during the heating process can be described and the assessment of whether the lifting displacement with the loading conditions in practice is allowable can be conducted keywords deep water pipeline sleepers vertical lifting deformation deformation prediction bp network notation d outer diameter of pipeline cross section e s seabed vertical stiffness h s initial vertical out of straight h v vertical lifting displacement h vm maximum vertical lifting displacement during heating process l total length of a pipeline l 0 wavelength of initial out of straight t wall thickness of pipeline cross section v 0 amplitude of initial out of straight w sub merged weight of per unit long pipeline section α thermal expansion coefficient δt temperature difference δt 1 temperature difference when pipeline section starts to deform upward δt 2 temperature difference when lifted pipeline section rests on sleeper again δt p temperature difference corresponding to peak point of lifting displacement μ friction coefficient for pipeline sleeper interaction μa equivalent axial pipe soil friction coefficient μl equivalent lateral pipe soil friction coefficient 1 introduction an efficient and safe transportation system the submarine pipeline system is widely used in offshore oil exploitation the high temperature and pressure cause pipelines to undergo global buckling deformation pipelines with excessive global buckling deformation experience large strain in bended sections which causes cross sectional failure nielsen et al 1990 pasqualino et al 2001 in the early stage of offshore oil exploitation only a shallow sea oil field was exploited offshore and on land pipelines were treated equally pipelines were placed in a trench and covered with soil and a heavy concrete block to prevent global buckling deformation ellinas et al 1990 palmer et al 1990 cathie and wintgens 2001 deng et al 2010 these treatments enhance the critical global buckling force and maintain the stability of pipelines in practice however with the increase in water depth the treatment of trenching and covering a pipeline has become extremely expensive and difficult in practice thus the pipeline global buckling protection method needs to be improved in deep water oil exploitation the covering treatment for a deep water pipeline is not feasible in practice hence pipelines are directly installed on the seabed which is slightly restricted by seabed soil around pipelines in addition a deep water pipeline exhibits a substantially larger temperature and pressure than a shallow water pipeline therefore a deep water pipeline inevitably exhibits lateral global buckling the priority of pipeline design is converted from preventing global buckling to triggering lateral global buckling and controlling lateral buckling deformation preston et al 1999 reported and analysed a new pipeline global buckling control method by laying pipeline with a zig zag shape to trigger controllable mitigatory lateral global buckling mitigatory lateral buckling reduces the axial compressive force in the deformation process to avoid the occurrence of concentrated and substantial buckling deformation of a pipeline without any treatment this lateral buckling decentralised strategy has been employed in an increasing number of projects to reduce the risk of cross section over bending harrison et al 2003 carr et al 2004 hooper et al 2004 junior et al 2004 matheson et al 2004 nystrøm et al 2012 rathbone et al 2008 wang et al 2015 yang et al 2010 solano et al 2012 guan et al 2007 chee et al 2018 in addition to a zig zag laid pipeline additional lateral global buckling triggering methods such as sleepers kristiansen et al 2005 silva junior et al 2008 nikkhaah et al 2009 li et al 2016 and distributed buoyancy block antunes et al 2010 peek and yun 2007 sriskandarajah et al 2011 were proposed and implemented the reliability of triggers in reducing the critical buckling force matheson et al 2004 hansen et al 2011 and stress distribution for the cross section of a post buckling pipeline chee et al 2018 hong et al 2015 hong and liu 2019 became the main focus in pipeline design a suitable design of buckling trigger distinctly reduces the critical buckling force and extends the lateral buckling to a mitigatory deformation with a low stress concentration among these buckling triggers the sleeper is selected with priority owing to its convenience and excellent performance sleepers reduce the critical buckling force by lifting a pipeline above the seabed to generate a vertical offset they should be carefully designed as the sub weight of a pipeline acts on sleepers which may then penetrate the seabed similar to the failure of strip footings zhou et al 2017 2018 even though the sleeper remains stable in the pipeline operation process the vertical offset of a pipeline may generate a risk to trigger vertical global buckling the touch down section of a pipeline generates more stress in vertical buckling deformation and pipeline failure is likely guijt 1990 ballet and hobbs 1992 therefore vertical global buckling is not allowed and the buckling form of a pipeline with sleepers should be estimated a sleeper which may trigger vertical global buckling must be re designed until only lateral buckling deformation remains a regular way to prevent vertical global buckling is to reduce the height of a sleeper to a critical value the small height of a sleeper is usually allowed based on this method as the effect of sleepers decreases with a reduction in height a shorter sleeper may not trigger and control lateral buckling as expected although a sleeper can reduce the critical buckling force unexpected buckling deformation may occur between two sleepers in practice hansen et al 2011 increasing the height of a sleeper may improve the effect of a sleeper on reducing the critical buckling force and prevent unexpected buckling deformation however a higher sleeper may also generate vertical deformation and threaten pipeline systems this study analysed the vertical lifting displacement of a pipeline laid on a sleeper and revealed the characteristics of the lifting displacement development curve with increasing temperature for a pipeline that contains man made lateral out of straightness oos statoil 2002 endal et al 2014 endal and nystrom 2017 chee et al 2018 a parametrical analysis of influential factors with regard to the variation in the displacement curve was also conducted a neural network for modelling the complex relationship between the influential factors and feature points of the lifting displacement curve was trained based on a large number of finite element analysis fea results an error analysis was also performed to verify the prediction accuracy 2 description of finite element analysis model the research was conducted using the commercially available software abaqus with implicit dynamical analyses the latter can be performed to calculate the transient dynamic or quasi static response of a system lateral global buckling of a pipeline occurs because of the temperature load and the inertia effects substantially change in the long heating procedure the inertia effect can be considerable at the moment of lateral global buckling as the structure loses stability and the pipeline section laterally deforms over time the inertia effect decreases and can be disregarded at a subsequent stage of lateral global buckling the implicit dynamical analysis offers an efficient method for obtaining a brief and strong dynamical response and a snap through structural response with less computational cost the pipeline was prescribed with the element type of s4r the axial movement of the two pipeline endpoints were fixed the other part of the pipeline with the exception of the two endpoints expanded in the axial direction and freely deformed in both the vertical and lateral directions the pipeline was axially meshed with an interval of 1 m and each pipeline cross section was assigned 12 elements the sleeper was simulated with the element type c3d8r with restricted lateral movement of all elements the seabed was simulated with the element type c3d8r lateral displacements of all sides were restricted and movements in all three directions of the seabed bottom were fixed the seabed was also meshed with an interval of 1 m in the axial direction the cross section of the seabed was assigned 11 meshes in the lateral direction and 3 meshes in the vertical direction the axial length of the seabed equalled the total length of the pipeline which was sufficient for the seabed as the axial movement of the two endpoints of the pipeline was fixed to simulate the virtual anchor point in practice the width of the seabed and sleeper should be larger than the maximum lateral displacement of the pipeline generated in the heating process therefore the specific width differs in different cases the depth of the seabed is 1 m which is sufficiently deep for these simulations the pipe soil interaction was modelled with a general contact algorithm that obeys a coulomb friction law peek and yun 2007 walker et al 2010 wang et al 2017 shi and wang 2015 hong et al 2019 chee et al 2019 the lateral coefficient and axial friction coefficient termed μl and μa respectively between the pipeline and the seabed remain constant during the pipeline global buckling process the constant friction between the pipeline and sleeper was termed μ the loading conditions are specified as follows 1 a vertical load was applied to make the sleeper contact the seabed 2 the initial lateral oos was introduced into the pipeline by editing the input file 3 the gravity of the pipeline was applied to simulate the pipeline laying process and an initial vertical oos was shaped by the sleeper between the seabed and the pipeline section in this process 4 the pipeline was uniformly heated to trigger the global buckling deformation the total temperature difference is termed δt in the simulation fig 1 demonstrates the configuration of the finite element analysis model as shown in fig 1 the pipeline contains initial oos in both the vertical and lateral directions before exhibiting the temperature load in the simulation the wavelength of the lateral initial oos is termed l 0 and its amplitude is termed v 0 the vertical oos of a pipeline that lifts from the seabed by the sleeper is termed h s the midpoint of the pipeline rested on the sleeper and other pipeline sections farther from the midpoint rested on the seabed owing to the submerged weight of the pipeline 3 post buckling deformation behaviour a reference case was simulated to illustrate the development of post buckling configuration for a pipeline laid on a sleeper the input parameters are listed in table 1 for comparison a pipeline without initial lateral oos was also simulated fig 2 depicts the post buckling configurations of the two pipelines during the heating process a pipeline laid on a sleeper exhibiting no initial lateral oos experiences and only vertical displacement was considered the pipeline section moved vertically and was lifted away from the sleeper no contact with the sleeper the vertical lifting displacement h v which is the value of the vertical gap between the sleeper and the pipeline section increases with the increment in the temperature difference δt as depicted in fig 2 a in contrast the pipeline laid on the sleeper with existing initial lateral oos underwent both vertical displacement and lateral displacement during the heating process the vertical lifting displacement h v initially increased and then decreased with the increment in δt at a subsequent stage of the heating process the pipeline section again rested on the sleeper the value of h v peaked when the temperature difference δt reached 50 c and declined to zero when the temperature difference δt was 88 c in the reference case fig 3 depicts the vertical deformation of the pipeline midpoint which is also the touchpoint on the pipeline and sleeper the development of vertical lifting displacement of the midpoint during the entire heating process is nonlinear the temperature difference at the moment of vertical displacement which coincides with the moment that the pipeline section starts lifting away from the sleeper is termed δt 1 the temperature difference at the moment when vertical displacement vanished which is also the moment that the pipeline section rested again on the sleeper is termed δt 2 the temperature range δt 1 δt 2 is termed the risky zone which means that the pipeline section is at risk of lifting deformation within this temperature range the maximum value of h v is termed h vm and its corresponding temperature difference is termed δt p the value of δt 1 δt 2 and h vm are 26 c 88 c and 0 49 m for the reference case when the temperature difference δt is larger than 26 c and less than 26 c the pipeline section is suspended above the sleeper owing to the buckling deformation this vertical deformation may threaten the stability and safety of the pipeline according to the post buckling configuration comparison between a pipeline with initial lateral oos and a pipeline without it the vertical lifting deformation of the pipeline laid on a sleeper occurs in the heating process of both the pipelines and vanishes only if the pipeline contains an initial lateral oos additionally a pipeline that contains an initial lateral oos also undergoes lifting displacement when the temperature difference δt is located in the risky zone in practice therefore the values of δt 1 δt 2 δt p and h vm are important for assessing the possibility of vertical lifting deformation when the following two conditions occur in practice 1 practical δt is beyond the risky zone and 2 predicted h vm is negligible the pipeline may undergo only a slight risk of lifting deformation considering the values of δt 1 and δt 2 δt p and h vm are dependent on the combinations of the influential parameters a parametrical analysis of the impact of the influential parameters on the values of δt 1 δt 2 δt p and h vm is proposed the following section presents the influence rule of these parameters all the nine influential parameters are classified into three categories geometry of the initial oos seabed properties and pipeline properties the geometry of the initial oos contains three influential parameters initial vertical oos h s initial lateral oos wavelength l 0 and amplitude v 0 the seabed properties contain three influential parameters equivalent lateral soil resistance coefficient μl equivalent axial soil resistance coefficient μa and seabed vertical stiffness e s the pipeline properties contain three influential parameters submerged weight w pipeline total length l and pipe sleeper friction coefficient μ table 2 presents the typical conditions in offshore pipeline design bruton et al 2007 2010 chee et al 2018 guan et al 2007 hansen et al 2011 harrison et al 2003 li et al 2016 the results presented in section 4 were obtained by changing one of the nine influential parameters each time and setting the remaining eight influential parameters equal to the values in the reference case 4 impact of influential factors on upheaval deformation 4 1 geometry of initial oos fig 4 illustrates the influence of h s on the vertical lifting displacement h v the initial vertical oos h s ranges from 0 75 m to 1 5 m h s of reference case is 1 m the pipeline with the higher h s may undergo more serious vertical lifting deformation when the other 8 influential factors remain unchanged the values of δt 2 and δt p increase and h vm rapidly increases with the increment in h s when h s equals 1 5 m the values of δt 2 δt p and h vm are 150 c 82 c and 1 4 m respectively fig 5 depicts the impact of lateral oos geometry on the vertical lifting displacement h v the dark line represents h v of the reference case the blue lines represent the impact of the lateral oos amplitude v 0 on h v in comparison with the reference case and the red lines represent the impact of the lateral oos length l 0 on h v in comparison with the reference case the results reveal that the lateral oos geometry both v 0 and l 0 does not have an effect on δt 1 however δt 2 δt p and h vm increase with a decrement in v 0 or an increment in l 0 a pipeline experiences more gentle vertical lifting deformation when the lateral oos has a larger value of v 0 l 0 4 2 seabed properties fig 6 shows the impact of lateral soil resistance on the vertical lifting displacement the temperature difference δt 1 with vertical displacement was not affected by μl the values of δt 2 δt p and h vm increase with a decrement in μl and the rate of increase of h vm to the variation in μl gradually decreases with an increment in μl a pipeline undergoes more substantial vertical lifting deformation when the lateral soil resistance is strong fig 7 shows the impact of the lateral soil resistance on the vertical lifting displacement the values of δt 2 δt p and h vm decrease with an increment in μa whereas the value of δt 1 increases with an increment in μa the temperature difference range decreases owing to the increase in the temperature difference δt 1 at the beginning of the vertical deformation and the decline in the temperature difference δt 2 at the ending of the vertical deformation when the axial resistance in the pipeline section increases fig 8 shows the impact of the seabed soil stiffness e s on the vertical lifting displacement the value of δt 1 barely changes with the variation in e s the values of δt 2 δt p and h vm decrease with the decrement in e s only when the seabed is sufficiently soft however the decrements in δt 2 δt p and h vm due to the softening of the seabed are limited 4 3 pipeline properties fig 9 depicts the impact of the submerged weight w on the vertical lifting displacement the values of δt 2 δt p and h vm decrease with the increment in w whereas the decreasing rate reduces with the incremental w the heavier pipeline experiences a shorter temperature difference range of vertical deformation and lower maximum vertical displacement fig 10 depicts the impact of the total length l of the pipeline on the vertical lifting displacement the temperature differences δt 1 at the beginning of the vertical deformation and δt 2 at the end of the vertical deformation increase with the increment in l based on the three cases depicted in fig 10 the temperature difference range increases with the increase in l a longer pipeline undergoes more substantial vertical lifting deformation fig 11 depicts the impact of pipe sleeper friction on the vertical lifting displacement larger pipe sleeper friction can reduce the vertical lifting deformation not only with the declining temperature difference δt 2 at the ending of the vertical deformation but also the maximum lifting displacement h vm and its corresponding temperature difference δt p this reduction effect is limited when the pipe sleeper friction becomes sufficiently large as depicted in figs 4 11 the value of δt 1 is relatively stable which is only affected by μa w and l the value of δt 1 varies from 24 c to 40 c which is considerably lower than the temperature employed in practice and lifting deformation cannot be avoided by reducing the temperature load to the value of δt 1 all nine influential factors affect δt 2 δt p and h vm to some degree especially the initial vertical and lateral oos when h s is sufficiently small or v 0 l 0 is sufficiently large the vertical lifting displacement will not occur during the heating process 5 prediction of post buckling behaviour 5 1 modelling of relationship between influential factors and behaviour of lifting displacement section 4 presents the impact of each influential factor on the vertical lifting deformation for pipelines laid on sleepers nine influential factors affect the lifting displacement behaviours in different ways and degrees once the relationship between the nine influential factors and the vertical lifting displacement behaviours is established the risk of lifting deformation for a pipeline laid on a sleeper can be predicted as previously presented the relationship between lifting displacement and temperature difference exhibits a parabolic type curve and the beginning ending and peak points are key parameters for describing this curve therefore the relationship between the lifting displacement and the temperature difference can be expressed as a function of nine influential factors and four key parameters δt 1 δt 2 δt p and h vm further study based on section 4 shows that the relationship between the increasing or decreasing rate of δt 1 δt 2 δt p and h vm and any of the nine influential factors depends on the values of the other 8 influential factors and the nine influential factors are non independent variables in predicting δt 1 δt 2 δt p and h vm complex mathematics must be used in simulating this nonlinear complex relationship therefore a backpropagation bp neural network was used to establish the analytical solution in predicting the vertical lifting displacement behaviour for a pipeline laid on a sleeper a bp neural network is a type of multi layer feedforward network that is trained according to error backpropagation the premise of bp the gradient descent method minimises the mean square error of the actual output and expected output values by proposing the gradient search technique fig 12 depicts the typical structure of a bp neural network which contains three layers input hidden and output layers the number of nodes on the input and output layers are determined by actual requirements and the number of hidden layers and the number of nodes on them are determined by the modelling requirements the training of the bp neural network in this study was conducted with matlab software herein the input layer has nine nodes which are h s v 0 l 0 μl μa e s w l and μ and the output layer has nine nodes which are δt 1 δt 2 δt p and h vm two hidden layers are established in the modelling the number of nodes in the first and second hidden layers is 9 the transfer function in the first hidden layer is the linear function purelin and the transfer function in the second hidden layer is the log sigmoid function logsig the transfer function in the output layer is the hyperbolic tangent sigmoid function tansig the training target error learning of the neural network and maximum training time are set to 0 0001 0 0001 and 60 000 respectively other parameters of the network follow the default value the neural network calculation applies the following procedure 1 first initialise the connecting weights from neurons on the input layer to those on the hidden layer and the connecting weights from the neurons on the hidden layer to those on the output layer 2 second normalise the input data and calculate the value of the neurons on the hidden layer with assumed weight 3 calculate the value of the neurons on the output layer based on the assumed weight and value of the neurons on the hidden layer 4 calculate the error according to the output results 5 compute the partial derivatives of the error functions with respect to the neurons on the output layer modify the connecting weights from the neurons on the input layer to those on the hidden layer and the connecting weights from the neurons on the hidden layer to those on the output layer 6 calculate the global error and assess whether the network error satisfies the requirement when the error is smaller than the requirement or the learning time reaches the maximum the training ends otherwise choose the next learning sample and a corresponding desired output and start the next round of training to train the bp neural network we simulated an additional 200 cases and the variations in the vertical lifting displacement of these models were obtained at least two influential factors changed in comparison with the reference case in each of these 200 cases the values of the changed factors were randomly determined within the common value ranges which are listed in table 2 the results from 180 of the 200 added cases with the results from the 19 cases presented in section 4 form the training database among the 199 training cases no lifting displacement occurs in 18 different cases during the entire heating process the other results from 20 of the added 200 cases comprise the testing database 5 2 error analysis of the established model the neural network was trained and tested and the relative error between the predicted results and the fea simulation results of δt 1 δt 2 δt p and h vm for the 20 cases are depicted in fig 13 the lifting displacement curve in fig 13 was normalised for a better analysis of the relative error all predicted results are located in the circles which represent a critical value with 15 relative error of the 20 cases in the error analysis lifting displacement occurred in three cases according to the fea results the neural network successfully predicts zero lifting displacement for all three cases the trained network demonstrates high accuracy in predicting the vertical deformation of a pipeline laid on a sleeper 6 conclusions a pipeline laid on a high sleeper may experience vertical global buckling which causes considerable stress concentration and increases the risk of vortex induced vibration failure this study analysed the deformation feature of the lifting deformation of a pipeline laid on a sleeper the main conclusions are presented as follows 1 the vertical lifting deformation is caused by the initial oos which is generated by the sleeper the vertical lifted pipeline section can rest on the sleeper after the lifting deformation when the pipeline has lateral oos the lifting displacement varies non monotonically with the increment in temperature difference 2 the parabolic type curve of vertical displacement during the heating process can be approximately described by three key points beginning ending and peak points therefore at least four key parameters are utilised the beginning temperature difference δt 1 ending temperature difference δt 2 temperature difference that corresponds to the peak point δt p and maximum lifting displacement h vm if the temperature difference δt used in engineering practice is located in a risky zone δt 1 δt δt 2 the pipeline section will experience lifting deformation 3 the development of vertical lifting displacement is primarily affected by nine influential factors including initial oos geometry seabed property and pipeline property the critical temperature difference when the pipeline section starts to deform upward is relatively stable and only affected by μa w and l the value of δt 1 is considerably smaller than the temperature load in practice and lifting deformation cannot be prevented by reducing the temperature load to equal the value of δt 1 among the nine influential factors the initial vertical oos lateral oos amplitude and wavelength exhibit the most significant influence when h s is sufficiently small or v 0 l 0 is sufficiently large the vertical lifting displacement does not occur during the heating process 4 a parametrical analysis of the nine influential factors of the variation in the vertical displacement development curve was performed as the relationship between the nine influential factors and the four key parameters is complex and the former are non independent variables a backpropagation neural network was employed for modelling a four layer network including two hidden layers was trained the accuracy of this network was verified the relative error of the three key points of the lifting displacement development curve is lower than 15 for all 20 cases the network is also suitable for a pipeline that does not undergo lifting displacement with the trained network feature points of the lifting displacement curve for a pipeline with different conditions can be easily calculated and the profile of the curve of lifting displacement can be constructed without numerical simulations the assessment of whether the lifting displacement in the loading conditions is feasible in practice and the following optimisation analysis can be quickly performed author contributions section zhaohui hong conceptualization methodology software visualization wenbin liu validation formal analysis resources writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
