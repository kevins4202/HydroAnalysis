index,text
3490,the partition of flood routing uncertainties from multiple sources provides a foundation for managing flood risks this paper develops a partition approach for the one dimensional river flood routing uncertainty due to boundary conditions upstream inflow hydrograph and downstream stage hydrograph and riverbed roughness a theoretical derivation based on the monte carlo method is presented using a one dimensional hydrodynamic model the developed approach is successfully applied to a real world case of the xunjiang river in china the results indicate the following 1 each uncertainty source leads to unique effects on flood routing and the uncertainty contribution ratio varies significantly with both time and space providing evidences for identifying the dominant uncertainty sources 2 the uncertainty of the simulated discharge is most influenced by the boundary conditions whereas the simulated water stage is most influenced by the riverbed roughness and 3 the highly coupled uncertainty propagation is hardly affected by the flood pattern as well as the probability distribution of uncertainty source but it is significantly affected by the river morphology the developed approach can effectively partition the uncertainty effects of the boundary conditions and riverbed roughness without explicating their interactions and the uncertainty partition of flood routing is useful for risky decision making in flood management keywords boundary condition flood routing monte carlo riverbed roughness uncertainty partition 1 introduction floods in open channels are dynamic waves controlled by gravitational and inertial forces pressure and resistance flood propagation is significantly affected by dams and reservoirs pappenberger et al 2006 whereas flood routing affects the operation of reservoirs to fulfill their designated functionalities and ensure safety che and mays 2015 chen et al 2017 the accuracy of flood routing is important for successful flood management however in a real world scenario floods are extremely complex and flood routing always has uncertainties due to different sources including the boundary conditions river morphology and riverbed roughness bozzi et al 2015 pappenberger et al 2006 scharffenberg and kavvas 2011 thus quantifiable and identifiable uncertainties are critical to flood routing models many numerical models have been developed for hydrodynamic flood routing horritt and bates 2002 scharffenberg and kavvas 2011 stelling and verwey 2006 which can be generally classified into two categories according to their construction method and computational complexity 1 one dimensional 1d hydrodynamic routing models such as hec ras and mike 11 are based on 1d shallow water equations and are widely used in river flood routing because of their proven performance hsu et al 2006 pappenberger et al 2005 pappenberger et al 2006 2 higher dimensional models include 1d 2d models such as lisfloo fp and 2d models such as mike 21 dutta et al 2007 leopardi et al 2002 horritt and bates 2002 these models use less restrictive assumptions and simulate floods in more detail however they require more refined data that are typically difficult to obtain apel et al 2009 horritt and bates 2002 generally 1d hydrodynamic models still prevail in the river flood routing bozzi et al 2015 pappenberger et al 2005 stelling and verwey 2006 and are considered in this research multiple uncertainties can jointly influence flood routing in a complex and convoluted manner owing to the nonlinear nature of the dynamical system however different uncertainty sources require different strategies for accuracy improvement thus an uncertainty partition is required it is necessary to know how the effects of multiple uncertainty sources propagate which uncertainty source is dominant and whether the effects are independent generally the boundary conditions river morphology and riverbed roughness are all related to the uncertainties in flood routing in this study the boundary conditions and riverbed roughness are analyzed the variation in river morphology will be implicitly considered in the uncertainty of riverbed roughness which is closely related to the river morphology yu and lane 2011 there are many methods for uncertainty analysis most of which are statistical bozzi et al 2015 commonly used methods include the bayesian approach guo et al 2020 jung et al 2018 monte carlo method fan et al 2020 scharffenberg and kavvas 2011 tate et al 2015 and generalized likelihood uncertainty estimation jung and merwade 2012 pappenberger et al 2006 the major uncertainty sources for river flood routing have been extensively studied using the monte carlo method which can solve the stochastic problem without explicating the mechanisms bozzi et al 2015 pappenberger et al 2006 scharffenberg and kavvas 2011 for example gates and al zahrani 1996 investigated the uncertainty in boundary conditions manning s roughness coefficient hydraulic geometry bed slope lateral seepage and momentum correction parameters used in solving the 1d open channel flow equations via monte carlo simulation buhman et al 2002 and harman et al 2008 analyzed the variability and uncertainty associated with the representation of the stream cross section geometry with the uncertainty quantified relative to the surveyed variation nevertheless to the best of our knowledge no previous studies have involved the partition of the joint effects from multiple uncertainty sources in river flood routing to fill this knowledge gap this paper presents an uncertainty partition approach based on the monte carlo method that has been widely used in flood routing as introduced above the partition approach can easily handle the coupling issue of two uncertainty sources for the streamflow forecast zhao and zhao 2014 in this study the partition approach was applied to the flood routing issue and modified to manage more than two uncertainty sources a real river case was used to demonstrate the proposed approach the remainder of this paper is organized as follows section 2 presents the 1d hydrodynamic model uncertainty sources and uncertainty partition approach in section 3 a real world case study is presented section 4 presents the discussions and conclusions are presented in section 5 2 methods 2 1 flood routing model the 1d hydrodynamic model for flood routing is based on the saint venant equations which are derived from the conservation principles of mass and momentum as follows 1 a t q x q 2 q t x q 2 a g a z x g as f 0 where x represents the location along the river m t represents the time s q represents the flow discharge m3 s z represents the water level m a represents the cross sectional wetted area perpendicular to the river flow direction m2 q represents the lateral inflow within unit length along the flow direction m3 s m g 9 81 m s2 represents the gravitational acceleration and s f represents the friction slope s f can be approximated using manning s equation 3 s f n 2 q q a 2 r 4 3 where n represents the riverbed roughness and r represents the hydraulic radius m riverbed roughness is a critical parameter for flood routing it is estimated based on geomorphic features surface roughness or empirical formulas kopecki et al 2017 in practice it is used as a model calibration parameter however even with extensive calibration it remains one of the major uncertainty sources due to the changeable river morphology in both time and space in this study the governing equations were discretized using the finite difference method the discretization of time t and space x forms a grid on which the dynamical model is solved see fig 1 using approximations of the partial derivatives here the implicit four point preissmann scheme is adopted because it allows non equidistant grids and computes the discharge and stage at the same point chau 1990 as well as for its stability and convergence characteristics lyn and goodwin 1987 the labels t and t 1 represent the previous and present time steps respectively the labels j and j 1 represent the adjacent grid points in the x direction the time and space dependent variables and their derivatives are discretized according to fig 1 and have the forms of equations 4 7 4 f o θ 2 f j 1 t 1 f j t 1 1 θ 2 f j 1 t f j t 5 f t o f j 1 t 1 f j t 1 f j 1 t f j t 2 δ t 6 f x o θ f j 1 t 1 f j t 1 δ x 1 θ f j 1 t f j t δ x 7 f 2 x o θ f j 1 t f j 1 t 1 f j t f j t 1 δ x 1 θ f j 1 t f j 1 t f j t f j t δ x where δ x and δ t represent the time and space step sizes respectively θ is the weight coefficient between time steps ranging from 0 to 1 chau 1990 f is a generic flow variable and the subscript o represents the currently calculated grid according to the discretization the saint venant equations are transformed into linear equations as follows 8 a 2 j 1 1 q j a 2 j 1 2 z j a 2 j 1 3 q j 1 a 2 j 1 4 z j 1 b 2 j 1 9 a 2 j 1 q j a 2 j 2 z j a 2 j 3 q j 1 a 2 j 4 z j 1 b 2 j where q j and z j represent the flow discharge and the stage at present time t 1 and at the j th discrete cross section respectively the coefficients a 2 j 1 i a 2 j i and b 2 j 1 b 2 j are determined by the flow discharge and the water stage at time t i 1 2 3 4 j 1 2 n as follows a 2 j 1 1 a 2 j 1 3 1 a 2 j 1 2 a 2 j 1 4 b j 1 2 t δ x 2 δ t θ b 2 j 1 q j 1 2 δ x 1 θ θ q j 1 t q j t a 2 j 1 2 z j 1 t z j t a 2 j 1 δ x 2 δ t θ q a j t g q a n 2 2 θ r 4 3 j t δ x a 2 j 3 δ x 2 δ t θ q a j 1 t g q a n 2 2 θ r 4 3 j 1 t δ x a 2 j 2 a 2 j 4 g a j a j 1 t 2 b 2 j δ x 2 δ t θ q j 1 t q j t 1 θ θ q 2 a j 1 t q 2 a j t 1 θ θ a 2 j 1 2 z j 1 t z j t where b represents the top width of cross section m because of the hyperbolic nature of the saint venant equations initial and boundary conditions are required singh 2004 the linear equations 8 and 9 can be solved using the double sweep method which is an efficient method for solving a set of linear algebraic equations zhang 2005 2 2 uncertainty source analysis in 1d flood routing the uncertainty in flood routing comes from the input data and model parameter the input data mainly includes boundary conditions and river morphology information the model parameter refers to the riverbed roughness previous research has indicated that the uncertainties from the boundary conditions and riverbed roughness are both significant for river flood routing with a 1d hydrodynamic model bozzi et al 2015 pappenberger et al 2005 warmink et al 2011 in most river flood routing cases the riverbed slope is small and the flow state remains in the subcritical regime meselhe et al 1997 therefore both the upstream and downstream boundary conditions are needed three types of boundary conditions are commonly used in the 1d river flood routing the time variable discharge series time variable stage series and stage discharge rating curve or combined flow and stage hydrographs singh 2004 lian et al 2007 generally the time variable inflow series is obtained and input into the flood routing model as the upstream boundary condition pappenberger et al 2006 and the inflow propagation in the river is then simulated for the downstream boundary condition the time variable stage series can be used if there are gauging stations at the outlet otherwise the stage discharge rating curve is used when no stage observation is available jung et al 2018 pappenberger et al 2006 schmidt and yen 2008 1 uncertainty of upstream boundary condition the time variable inflow series used as the upstream boundary condition can be expressed as follows 10 q u p q t the inflow series is usually obtained from the observation at hydrological gauging stations or forecast from hydrological models lian et al 2007 a common assumption that the observation error or forecast error follows the gaussian distribution is adopted zhang et al 2015 zhao et al 2011 the gaussian distribution assumes that data tends to be around a central value with no bias left or right and it can be expressed as follows 11 f x 1 2 π σ exp x μ 2 2 σ 2 where f x is the probability density function x is the error value μ is the mean of the distribution σ is the standard deviation and the distribution of x can be denoted as n μ σ 2 in the gaussian distribution σ is the critical indicator to assess the uncertainty of x the uncertainty of the upstream boundary condition can be modelled using the gaussian distribution as follows 12 q t q 0 t ε q t ε q t n 0 a 2 q 0 t 2 where q 0 t represents the observed inflow discharge m3 s ε q t represents the perturbation induced by the uncertainty of q 0 t and a a 0 is a constant coefficient the variance of ε q t is estimated with a 2 q 0 t 2 because the inflow uncertainty is generally proportional to the magnitude of the flow discharge bozzi et al 2015 lai et al 2013 zhang et al 2015 and the coefficient a can be estimated with the observational error 2 uncertainty of downstream boundary condition in this research we considered the case in which the stage hydrograph can be obtained at the outlet and used as the downstream boundary condition in contrast to the flow discharge the observational error of the water stage is mainly determined by the observation instruments horner et al 2018 and it often varies within a limited range independent of the stage magnitude following the gaussian distribution assumption the uncertainty of the water stage was approximately simulated as follows 13 z t z 0 t ε z ε z n 0 b 2 where z 0 t represents the observed stage m ε z represents the perturbation that follows the gaussian distribution centered at zero with a variance of b 2 b 0 and b quantifies the observational uncertainty in this study the coefficient b of water stage is considered to be a time constant determined by the observational accuracy 3 uncertainty of riverbed roughness many factors may contribute to the uncertainty of riverbed roughness such as imperfect model calibration variation in river morphology and unsteady flow state as the critical model parameter the riverbed roughness can affect the uncertainty propagation originating from the boundary conditions similar to the boundary conditions the uncertainty of roughness coefficient n is simulated using the gaussian distribution papaioannou et al 2017 14 n n 0 ε n ε n n 0 c 2 where n 0 represents the calibrated value and ε n represents the perturbation induced by the uncertainty of the riverbed roughness which is quantified by the variance coefficient c c 0 in this study the coefficient c is also a time constant estimated from the maximum variation range of riverbed roughness owing to the spatial variability of the riverbed roughness the coefficient n of different river cross sections is different and simulated independently in addition the riverbed roughness is time variable due to the morphological modifications during flood propagation this part of uncertainty is simulated by increasing the value of the coefficient c to cover the possible variation range of n finally the three sources of uncertainties were simulated with the coefficients a representing the uncertainty of the upstream inflow b representing the uncertainty of the downstream water stage and c representing the uncertainty of the riverbed roughness the uncertainty sources were independently input into the model to identify their individual and joint effects on flood routing 2 3 uncertainty partition approach the boundary conditions and riverbed roughness were independently input into the flood routing model it is not feasible to obtain analytical solutions for the partition of uncertainty propagation from multiple sources instead stochastic methods can be used to infer uncertainties with variances of random variables the uncertainty partition was then derived using monte carlo sampling by repeated random sampling to obtain numerical results bozzi et al 2015 chen et al 2017 xu et al 2007 at first two random variables x a n d y can be sampled using the monte carlo method with the sampled time series of x i a n d y j i 1 2 m j 1 2 n input into the simulation model an uncertain output time series of variable z ij flow discharge or water stage jointly influenced by x i and y j can be obtained and written in matrix form 15 z z 11 z 12 z 1 n z 21 z 22 z 2 n z m 1 z m 2 z mn where m and n represent the sample sizes of x and y respectively the uncertainty of z i j can be quantified with its σ z value which is estimated using equation 16 16 σ z 2 1 m n 1 i 1 m j 1 n z ij z 0 2 here z 0 represent the mean value of z ij 17 z 0 1 m n i 1 m j 1 n z ij for every row i in the matrix of z ij equation 15 the uncertainty from x cannot be observed as all the z ij j 1 2 n values in this row are output from the same input x i a row captures the effect uncertainty of the variation of y from y 1 to y n thus a row variation of z ij j 1 2 n can be attributed to the uncertainty of y for different rows the mean value z i of z ij j 1 2 n varies owing to the variation of x i i 1 2 m 18 z i 1 n j 1 n z ij again the variation of z ij j 1 2 n in row i is caused by the uncertainty of y and the variation of z i is caused by the uncertainty of x consequently the partition be derived as follows first the output variable z ij i 1 2 m j 1 2 n is decomposed as 19 z ij z 0 z i z 0 z ij z i then the decomposition equation 19 is substituted into equation 16 yielding 20 σ z 2 1 m n 1 i 1 m j 1 n z i z 0 z ij z i 2 1 m n 1 n i 1 m z i z 0 2 i 1 m j 1 n z ij z i 2 2 i 1 m z i z 0 j 1 n z ij z i according to equation 18 for every row i z i 1 n j 1 n z ij and then j 1 n z ij z i j 1 n z ij n z i 0 therefore the above equation can be simplified as 21 σ z 2 n m n 1 i 1 m z i z 0 2 1 m n 1 i 1 m j 1 n z ij z i 2 1 m 1 i 1 m z i z 0 2 1 m n 1 i 1 m j 1 n z ij z i 2 where the approximation to obtain the last equation is valid if n is large the first term on the right side of equation 21 represents the variation of z i caused by the uncertainty of x denoted as σ z x 2 the second term represents the variation of z ij caused by the uncertainty of y denoted as σ z x y 2 equation 21 can then be modified as follows 22 σ z 2 σ z x 2 σ z x y 2 similar to the abovementioned derivation the individual uncertainty can be analyzed if one of the two input random variables x or y is fixed to its true value without any uncertainty without loss of generality if x is fixed to its true value x 0 a different y j results in a different z j which produces σ z y clearly σ z y differs from σ z x y as x i in row i always deviates from the true value x 0 the comparison between σ z y and σ z x y can be useful for investigating the coupling effects of x and y in particular if their uncertainty effects are independent σ z y will equal σ z x y 23 σ z 2 σ z x 2 σ z y 2 based on the partitioned variance the contribution ratio of different uncertainty sources fan et al 2020 can be defined as follows to quantify their contribution 24 cr x σ z x 2 σ z 2 25 cr y σ z y x 2 σ z 2 where cr x and cr y represent the contribution ratios of x and y respectively the aforementioned partition for two random variables can be used for streamflow forecast with two uncertainty sources zhao and zhao 2014 however this partition should be improved to the case of three random variables before it can be applied to flood routing when the number of random variables increases to three i e x y and w the variance of the output variable z ijk k 1 2 k is estimated as follows 26 σ z 2 1 m n k 1 i 1 m j 1 n k 1 k z ijk z 0 2 then the partition is deduced from the case of two random variables σ z 2 1 m n k 1 i 1 m j 1 n k 1 k z i z 0 z ij z i z ijk z ij 2 1 m n k 1 n k i 1 m z i z 0 2 k i 1 m j 1 n z ij z i 2 i 1 m j 1 n k 1 k z ijk z ij 2 27 1 m 1 i 1 m z i z 0 2 1 m n 1 i 1 m j 1 n z ij z i 2 1 m n k 1 i 1 m j 1 n k 1 k z ijk z ij 2 28 z ij 1 k k 1 k z ijk accordingly σ z 2 is partitioned as 29 σ z 2 σ z x 2 σ z y x 2 σ z w y x 2 30 cr w σ z w y x 2 σ z 2 cr x and cr y are calculated using the same equations expressed in equations 24 and 25 3 case study 3 1 case description the river reach from the dahuangjiangkou to tengxian gauging stations 96 19 km downstream away from dahuangjiangkou on the xunjiang river of the pearl river basin in china was selected as a case study the pingnan 26 04 km downstream away from dahuangjiangkou is another hydrological gauging station along this river which is located in a city with flood control target the predicted flood discharge and water stage at pingnan were calibrated and their uncertainties were analyzed the locations of this river reach and the two gauging stations are shown in fig 2 in this study three floods in 2011 and 2012 were used fig 3 the 1d flood routing model was constructed using bathymetric data surveyed in 2011 the topographic data were refined with spatial interpolation and a uniform computational grid along the river was used with the space step equal to 500 m the flood routing model used in this study was calibrated and validated with the observations at pingnan gauging station as shown in fig 4 in the second row of fig 4 the vertical axis starts from 21 m for better observation of the simulation error the maximum absolute simulation errors were slightly different in three floods 233 m3 s for discharge and 0 14 m for water stage in flood1 151 m3 s for discharge and 0 16 m for water stage in flood2 245 m3 s for discharge and 0 25 m for water stage in flood3 according to the comparison in fig 4 the simulation results are very close to the observations and the flood routing model is feasible and suitable for this study the uncertainties from the upstream inflow downstream water stage and riverbed roughness were quantified with three random variables x y and w respectively the observation data of the upstream inflow and downstream water stage were obtained from the hydrologic yearbook published by the chinese ministry of water resources and their uncertainties were derived from the code for hydrological data processing 2012 the standard for stage observation 2010 and the code for liquid flow measurement in open channels published by the chinese government finally the uncertainty of the boundary conditions was estimated with a representing the uncertainty of the upstream inflow equal to 0 02 and b representing the uncertainty of the downstream water stage equal to 0 3 the river roughness coefficient n in equation 14 is mainly derived from the previous research and field surveys dou et al 2013 reported that the roughness coefficient changes from 0 016 to 0 044 for the river network of the pearl river basin and zhang et al 2013 reported a range of 0 015 0 045 both reported ranges cover the variation information with time and space including the variation caused by dynamic morphological modification after field surveys and model calibration the river roughness n 0 in equation 14 was estimated to be 0 033 for all the calculated cross sections and their estimation uncertainties quantified by the coefficient c were set at 0 015 four cases with and without combinations of uncertainty sources were examined table 1 3 2 results 3 2 1 individual cases case a b and c for the individual uncertainty source in table 1 were first analyzed as a baseline for the joint case d using the monte carlo method with 25 realizations a reasonable number of realizations is reached when the mean and standard deviation of the ensembles change slightly fig 5 for all three uncertainty sources the individual uncertainties in terms of standard deviation of the simulated discharge and water stage were calculated as shown in fig 6 fig 6 shows the uncertainties of the discharge and water stage at pingnan as a function of time these uncertainties are all due to individual sources the subfigures are arranged as follows the left column corresponds to the uncertainty of the discharge and the right column corresponds to the uncertainty of the stage it can be found that different uncertainty source resulted in significantly different standard deviations of the discharge and water stage as indicated by the left column the uncertainty induced by the upstream inflow followed the rise and fall of the flow magnitude and the standard deviations of the simulated discharge reached its maximum around the flood peak t 75 h in flood1 t 132 h in flood2 and t 125 h in flood3 in contrast the uncertainties induced by the downstream water stage and riverbed roughness were most significant at the beginning and end times in more detail the maximum value of the standard deviations of the simulated discharge due to upstream inflow reached approximately 160 m3 s which is almost 1 of the flood peak in three floods slightly larger than that due to the downstream water stage and riverbed roughness at the beginning of the three floods the standard deviations of the simulated discharge corresponding to upstream inflow is minimum almost 75 m3 s which is the maximum value of the standard deviations corresponding to the riverbed roughness overall the uncertainty of simulated discharge is dominated by the boundary conditions for the right column in fig 6 regarding the uncertainty of simulated water stage the results are significantly different from the left one the water stage uncertainty induced by the riverbed roughness was much larger than that by boundary conditions reaching approximately 0 4 m which is about 2 of the maximum water depth in three floods additionally the standard deviations of the simulated stage corresponding to riverbed roughness also reached their maximum around the flood peak this reveals that the uncertainties from the three sources evolved in a significantly diverse manner and had different effects the uncertainties from boundary conditions mainly affected the flow discharge whereas the water stage was most influenced by the riverbed roughness clearly the uncertainty effects from boundary conditions are related to the river positions for example the proximity to the outlet amplifies the uncertainty effects of the downstream boundary therefore the standard deviations of the simulated discharge and water stage along the river were calculated to investigate the spatial difference of uncertainty effects as shown in fig 7 where the maximum standard deviations over times at different river positions are plotted although the uncertainty variation along the river is highly nonlinear two aspects of rules can be found for all three floods as listed in table 2 regarding the tendency of uncertainty variation for every boundary the uncertainty effects decrease when getting away from it and its effects are substantially reduced by the other boundary for the variation rate the uncertainty from upstream inflow decrease gradually along the river whereas the uncertainty from downstream water stage sharply decrease at a specific position this sharp decrease is possibly related to the river morphology overall the spatial variations of uncertainty effects due to boundary conditions and riverbed roughness are significantly different in addition with the results of different floods compared in both figs 6 and 7 it can be found that the propagation and evolution of flood routing uncertainties are very similar in three floods this finding implies that the flood routing uncertainty partition is hardly affected by the flood pattern 3 2 2 uncertainty partition in joint case the individual case provides the identifiable uncertainty variation in the flood routing results different uncertainty sources cause much different variation in uncertainty effects however how the effects of the three uncertainty sources are coupled what the contribution of different uncertainty source takes and whether their effects are independent can only be answered after a joint case analysis joint case d in table 1 was simulated and analyzed using equation 29 the contribution ratios of different uncertainty sources were calculated and plotted as shown in fig 8 where the left and right columns show the partition results for the simulated discharges and water stages respectively as shown in fig 8 the contribution ratio of every uncertainty source changed significantly over time in accordance with the individual case results the uncertainty contribution ratio of upstream inflow reached a maximum when the flood peaks with cr equal to 0 86 in flood1 0 74 in flood2 and 0 91 in flood3 the uncertainty contribution ratio of downstream water stage reached a maximum at the beginning and end time of the three floods and the contribution ratio of the riverbed roughness is much smaller than the boundary conditions smaller than 0 1 at most times this suggests the uncertainty dominance of the boundary conditions on the simulated discharge however different dominance was observed in the results of simulated water stage the uncertainty contribution ratio of riverbed roughness was 0 9 at most times for all three floods this large contribution ratio of riverbed roughness is partly attributed to the uncertainty overestimation of the river morphology because its maximum effects are considered to determine the variation range of riverbed roughness in the joint case the coupling uncertainty effects make the partitioned results different from those in the individual cases as shown in figs 9 to 11 all figures present comparisons between the partitioned uncertainty in the joint case and individual uncertainty in individual cases if the two standard deviations are the same they fall exactly on a 1 1 line obviously the effects of different uncertainty sources were not independent although their perturbations were independently input to the flood routing model for boundary conditions the correlation between the joint results and individual results is low smaller than 0 62 with the scatters highly random this irregularity is most significant in flood3 however the results regarding riverbed roughness are more regular because consistent deviations in the subfigures about riverbed roughness can be observed for water stage the individual uncertainty is higher showing that the boundary uncertainty in the joint case attenuates the effects of riverbed roughness for flow discharge most of the measures in the range 0 50 m3 s are above the 1 1 line which means that partitioned uncertainty is higher than individual uncertainty this reveals that the uncertainties from boundary conditions can increase the uncertainty effects of riverbed roughness on simulated discharge but reduce its effects on water stage 4 discussion with the proposed partition approach applied the coupling uncertainty effects from multiple sources are successfully quantified and their correlations and contribution ratios can be determined which is useful for uncertainty identification of flood routing however several factors should be considered for the application of the proposed approach in addition to the flood pattern which has been analyzed above the probability distribution of uncertainty source and the river morphology are discussed in this section 4 1 effects of probability distribution of uncertainty source in this study it was assumed that the errors of boundary conditions and riverbed roughness followed a gaussian distribution however the proposed partition approach could be used to other uncertainty distributions for example another probability distribution uniform distribution was examined the detailed uniform distributions of three uncertainty sources are q t u 0 98 q 0 t 1 02 q 0 t z t u z 0 t 0 3 z 0 t 0 3 n u 0 015 0 045 and the results are shown in figs 12 and 13 comparing the individual results in fig 12 and joint results in fig 13 with those in figs 6 and 8 it can be found that the rule of uncertainty contribution is hardly affected by the selected probability distribution nevertheless the uncertainty contribution of the boundary conditions decreases but the riverbed roughness increases for example in the individual case of flood1 the maximum standard deviation of the simulated discharge corresponding to upstream inflow was about 100 m3 s smaller than the 160 m3 s in fig 6 whereas the maximum standard deviation of the simulated water stage corresponding to riverbed roughness is about 0 45 m which is larger than the 0 40 m in fig 6 the uniform distribution increases the uncertainty contribution ratio of riverbed roughness it s reasonable because the calibrated n 0 equal to 0 033 is not the center point of its uncertain range from 0 015 to 0 045 and there are more scatters deviating from n 0 in the uniform case 4 2 effects of river morphology the river morphology is important for flood routing and it is also an uncertainty source due to the complexity of morphological modification in unsteady flow the uncertainty effects of river morphology are implicitly considered by increasing the variation range of riverbed roughness however the uncertainty partition may be affected by the hydraulic geometry therefore the uncertainty partition of flood routing was observed with a prismatic trapezoidal channel referring to the studied real river this hypothetical channel had the length of 100 km bottom width of 1000 m side slope of 2 5 and longitudinal slope of 0 0001 and the riverbed roughness n 0 is also 0 033 the upstream inflow hydrograph was similar to that of flood1 with a peak flow of 16000 m3 s the uncertainty coefficients were set same as that in real world case a 0 02 b 0 3 and c 0 015 the uncertainty partition analysis was conducted at a gauging station 30 km from the inlet and the results are shown in figs 14 and 15 the hypothetical case confirmed the dominance of upstream inflow on the simulated discharge uncertainty for the simulated water stage like the real world case the uncertainty is mainly attributed to the riverbed roughness with average contribution ratio 0 95 however differences were obvious between the two river cases for example the uncertainty effects of downstream water stage and riverbed roughness on the simulated discharge are different from that in the real world case the downstream water stage makes negligible contribution but the riverbed roughness has the contribution ratio reaching 0 80 at the flood beginning these differences also indicate that the partition results are significantly affected by the river morphology nevertheless the proposed approach for obtaining partitioned uncertainty results is not limited by the river morphology 4 3 contributions and drawbacks of this research this research successfully partitioned the uncertainty effects from both boundary conditions and riverbed roughness with their contribution quantified the results reveal that the uncertainty partition is related to the river morphology and the uncertainty overestimation of the river morphology increases the uncertainty contribution ratio of riverbed roughness in the hypothetical case the contribution ratio of riverbed roughness is more significant than that in the real world case while the uncertainty from downstream boundary can be negligible however the rule of uncertainty contribution is hardly affected by the flood pattern as well as the probability distribution of uncertainty source the partition results in three selected floods are very similar and only slight difference can be observed no matter the gaussian distribution or uniform distribution is considered compared with previous works on this topic the present study makes the following contributions 1 the developed uncertainty partition approach can quantify the uncertainty contribution of boundary conditions and riverbed roughness without explicating the interaction between the sources similar issues were reported by scharffenberg and kavvas 2011 and bozzi et al 2015 who also considered the uncertainty from both the boundary conditions and riverbed roughness however their studies shared the same drawback the flood routing model was simplified for explicating the interaction between multiple sources 2 the case study revealed that each uncertainty source leads to unique uncertainty variations in the flood simulation these characteristics of each uncertainty source provide opportunities to identify and manage the dominant uncertainty in flood routing however this study has two drawbacks that should be noted 1 the selected numerical scheme was closely related to the uncertainty results in this study only the preissmann scheme was considered the proposed partition approach could be extended to other numerical schemes to assess the uncertainty partition independently on the hydrodynamic model but this is out of the paper aim 2 the xunjiang river was selected as an example to demonstrate the proposed approach and the results could vary depending on the type of terrain the river morphology has significant effects on the flood routing results any change in the morphology can induce differences in the partitioned uncertainty because the maximum effects of river morphology were implicitly considered in the uncertainty of riverbed roughness the uncertainty overestimation is inevitable therefore other real rivers with different morphologies should be compared in subsequent research 5 conclusions an uncertainty partition approach was proposed to quantify the coupled uncertainty effects from the upstream inflow downstream water stage and riverbed roughness in 1d river flood routing the developed approach was applied to a real world case study and the results indicated the following 1 the developed approach can effectively partition the uncertainty effects of boundary conditions and riverbed roughness without explicating the interaction between multiple sources 2 each uncertainty source leads to unique effects on flood routing and the uncertainty contribution ratio varies significantly with both time and space for the studied river the boundary conditions contribute to most of the uncertainty of simulated discharge while the uncertainty of simulated water stage is dominated by the riverbed roughness the proposed approach provides evidences for identifying the dominant uncertainty sources 3 the coupling effects of the three uncertainty sources are highly dependent and the uncertainty from boundary conditions can increase the uncertainty effects of riverbed roughness on simulated discharge but reduce its effects on water stage 4 the coupled uncertainty propagation is hardly affected by the flood pattern as well as the probability distribution of uncertainty source but it is significantly affected by the river morphology the research could be improved in the future this developed partition approach can be applied to other real rivers and the uncertainty associated with river morphology should be deeply studied with much more details explained for example the morphological modification could be considered with simulated bedform dynamics and the effects that the time variable river morphology has on the quantification of riverbed roughness would be explicitly investigated credit authorship contribution statement jiabiao wang conceptualization data curation investigation methodology writing original draft jianshi zhao conceptualization data curation methodology writing review editing tongtiegang zhao methodology hao wang conceptualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the first author expresses gratitude for the support provided by the chinese scholarship council for his visit to pennsylvania state university where this study was conducted we also thank the editors and the two anonymous reviewers for their insightful comments and excellent suggestions which are very helpful for the improvements of this paper this research was supported by the guangdong basic and applied basic research foundation 2020a1515110906 the national natural science foundation of china 52109047 and the joint open research fund program of state key laboratory of hydroscience and engineering and tsinghua ningxia yinchuan joint institute of internet of waters on digital water governance sklhse 2021 iow01 
3490,the partition of flood routing uncertainties from multiple sources provides a foundation for managing flood risks this paper develops a partition approach for the one dimensional river flood routing uncertainty due to boundary conditions upstream inflow hydrograph and downstream stage hydrograph and riverbed roughness a theoretical derivation based on the monte carlo method is presented using a one dimensional hydrodynamic model the developed approach is successfully applied to a real world case of the xunjiang river in china the results indicate the following 1 each uncertainty source leads to unique effects on flood routing and the uncertainty contribution ratio varies significantly with both time and space providing evidences for identifying the dominant uncertainty sources 2 the uncertainty of the simulated discharge is most influenced by the boundary conditions whereas the simulated water stage is most influenced by the riverbed roughness and 3 the highly coupled uncertainty propagation is hardly affected by the flood pattern as well as the probability distribution of uncertainty source but it is significantly affected by the river morphology the developed approach can effectively partition the uncertainty effects of the boundary conditions and riverbed roughness without explicating their interactions and the uncertainty partition of flood routing is useful for risky decision making in flood management keywords boundary condition flood routing monte carlo riverbed roughness uncertainty partition 1 introduction floods in open channels are dynamic waves controlled by gravitational and inertial forces pressure and resistance flood propagation is significantly affected by dams and reservoirs pappenberger et al 2006 whereas flood routing affects the operation of reservoirs to fulfill their designated functionalities and ensure safety che and mays 2015 chen et al 2017 the accuracy of flood routing is important for successful flood management however in a real world scenario floods are extremely complex and flood routing always has uncertainties due to different sources including the boundary conditions river morphology and riverbed roughness bozzi et al 2015 pappenberger et al 2006 scharffenberg and kavvas 2011 thus quantifiable and identifiable uncertainties are critical to flood routing models many numerical models have been developed for hydrodynamic flood routing horritt and bates 2002 scharffenberg and kavvas 2011 stelling and verwey 2006 which can be generally classified into two categories according to their construction method and computational complexity 1 one dimensional 1d hydrodynamic routing models such as hec ras and mike 11 are based on 1d shallow water equations and are widely used in river flood routing because of their proven performance hsu et al 2006 pappenberger et al 2005 pappenberger et al 2006 2 higher dimensional models include 1d 2d models such as lisfloo fp and 2d models such as mike 21 dutta et al 2007 leopardi et al 2002 horritt and bates 2002 these models use less restrictive assumptions and simulate floods in more detail however they require more refined data that are typically difficult to obtain apel et al 2009 horritt and bates 2002 generally 1d hydrodynamic models still prevail in the river flood routing bozzi et al 2015 pappenberger et al 2005 stelling and verwey 2006 and are considered in this research multiple uncertainties can jointly influence flood routing in a complex and convoluted manner owing to the nonlinear nature of the dynamical system however different uncertainty sources require different strategies for accuracy improvement thus an uncertainty partition is required it is necessary to know how the effects of multiple uncertainty sources propagate which uncertainty source is dominant and whether the effects are independent generally the boundary conditions river morphology and riverbed roughness are all related to the uncertainties in flood routing in this study the boundary conditions and riverbed roughness are analyzed the variation in river morphology will be implicitly considered in the uncertainty of riverbed roughness which is closely related to the river morphology yu and lane 2011 there are many methods for uncertainty analysis most of which are statistical bozzi et al 2015 commonly used methods include the bayesian approach guo et al 2020 jung et al 2018 monte carlo method fan et al 2020 scharffenberg and kavvas 2011 tate et al 2015 and generalized likelihood uncertainty estimation jung and merwade 2012 pappenberger et al 2006 the major uncertainty sources for river flood routing have been extensively studied using the monte carlo method which can solve the stochastic problem without explicating the mechanisms bozzi et al 2015 pappenberger et al 2006 scharffenberg and kavvas 2011 for example gates and al zahrani 1996 investigated the uncertainty in boundary conditions manning s roughness coefficient hydraulic geometry bed slope lateral seepage and momentum correction parameters used in solving the 1d open channel flow equations via monte carlo simulation buhman et al 2002 and harman et al 2008 analyzed the variability and uncertainty associated with the representation of the stream cross section geometry with the uncertainty quantified relative to the surveyed variation nevertheless to the best of our knowledge no previous studies have involved the partition of the joint effects from multiple uncertainty sources in river flood routing to fill this knowledge gap this paper presents an uncertainty partition approach based on the monte carlo method that has been widely used in flood routing as introduced above the partition approach can easily handle the coupling issue of two uncertainty sources for the streamflow forecast zhao and zhao 2014 in this study the partition approach was applied to the flood routing issue and modified to manage more than two uncertainty sources a real river case was used to demonstrate the proposed approach the remainder of this paper is organized as follows section 2 presents the 1d hydrodynamic model uncertainty sources and uncertainty partition approach in section 3 a real world case study is presented section 4 presents the discussions and conclusions are presented in section 5 2 methods 2 1 flood routing model the 1d hydrodynamic model for flood routing is based on the saint venant equations which are derived from the conservation principles of mass and momentum as follows 1 a t q x q 2 q t x q 2 a g a z x g as f 0 where x represents the location along the river m t represents the time s q represents the flow discharge m3 s z represents the water level m a represents the cross sectional wetted area perpendicular to the river flow direction m2 q represents the lateral inflow within unit length along the flow direction m3 s m g 9 81 m s2 represents the gravitational acceleration and s f represents the friction slope s f can be approximated using manning s equation 3 s f n 2 q q a 2 r 4 3 where n represents the riverbed roughness and r represents the hydraulic radius m riverbed roughness is a critical parameter for flood routing it is estimated based on geomorphic features surface roughness or empirical formulas kopecki et al 2017 in practice it is used as a model calibration parameter however even with extensive calibration it remains one of the major uncertainty sources due to the changeable river morphology in both time and space in this study the governing equations were discretized using the finite difference method the discretization of time t and space x forms a grid on which the dynamical model is solved see fig 1 using approximations of the partial derivatives here the implicit four point preissmann scheme is adopted because it allows non equidistant grids and computes the discharge and stage at the same point chau 1990 as well as for its stability and convergence characteristics lyn and goodwin 1987 the labels t and t 1 represent the previous and present time steps respectively the labels j and j 1 represent the adjacent grid points in the x direction the time and space dependent variables and their derivatives are discretized according to fig 1 and have the forms of equations 4 7 4 f o θ 2 f j 1 t 1 f j t 1 1 θ 2 f j 1 t f j t 5 f t o f j 1 t 1 f j t 1 f j 1 t f j t 2 δ t 6 f x o θ f j 1 t 1 f j t 1 δ x 1 θ f j 1 t f j t δ x 7 f 2 x o θ f j 1 t f j 1 t 1 f j t f j t 1 δ x 1 θ f j 1 t f j 1 t f j t f j t δ x where δ x and δ t represent the time and space step sizes respectively θ is the weight coefficient between time steps ranging from 0 to 1 chau 1990 f is a generic flow variable and the subscript o represents the currently calculated grid according to the discretization the saint venant equations are transformed into linear equations as follows 8 a 2 j 1 1 q j a 2 j 1 2 z j a 2 j 1 3 q j 1 a 2 j 1 4 z j 1 b 2 j 1 9 a 2 j 1 q j a 2 j 2 z j a 2 j 3 q j 1 a 2 j 4 z j 1 b 2 j where q j and z j represent the flow discharge and the stage at present time t 1 and at the j th discrete cross section respectively the coefficients a 2 j 1 i a 2 j i and b 2 j 1 b 2 j are determined by the flow discharge and the water stage at time t i 1 2 3 4 j 1 2 n as follows a 2 j 1 1 a 2 j 1 3 1 a 2 j 1 2 a 2 j 1 4 b j 1 2 t δ x 2 δ t θ b 2 j 1 q j 1 2 δ x 1 θ θ q j 1 t q j t a 2 j 1 2 z j 1 t z j t a 2 j 1 δ x 2 δ t θ q a j t g q a n 2 2 θ r 4 3 j t δ x a 2 j 3 δ x 2 δ t θ q a j 1 t g q a n 2 2 θ r 4 3 j 1 t δ x a 2 j 2 a 2 j 4 g a j a j 1 t 2 b 2 j δ x 2 δ t θ q j 1 t q j t 1 θ θ q 2 a j 1 t q 2 a j t 1 θ θ a 2 j 1 2 z j 1 t z j t where b represents the top width of cross section m because of the hyperbolic nature of the saint venant equations initial and boundary conditions are required singh 2004 the linear equations 8 and 9 can be solved using the double sweep method which is an efficient method for solving a set of linear algebraic equations zhang 2005 2 2 uncertainty source analysis in 1d flood routing the uncertainty in flood routing comes from the input data and model parameter the input data mainly includes boundary conditions and river morphology information the model parameter refers to the riverbed roughness previous research has indicated that the uncertainties from the boundary conditions and riverbed roughness are both significant for river flood routing with a 1d hydrodynamic model bozzi et al 2015 pappenberger et al 2005 warmink et al 2011 in most river flood routing cases the riverbed slope is small and the flow state remains in the subcritical regime meselhe et al 1997 therefore both the upstream and downstream boundary conditions are needed three types of boundary conditions are commonly used in the 1d river flood routing the time variable discharge series time variable stage series and stage discharge rating curve or combined flow and stage hydrographs singh 2004 lian et al 2007 generally the time variable inflow series is obtained and input into the flood routing model as the upstream boundary condition pappenberger et al 2006 and the inflow propagation in the river is then simulated for the downstream boundary condition the time variable stage series can be used if there are gauging stations at the outlet otherwise the stage discharge rating curve is used when no stage observation is available jung et al 2018 pappenberger et al 2006 schmidt and yen 2008 1 uncertainty of upstream boundary condition the time variable inflow series used as the upstream boundary condition can be expressed as follows 10 q u p q t the inflow series is usually obtained from the observation at hydrological gauging stations or forecast from hydrological models lian et al 2007 a common assumption that the observation error or forecast error follows the gaussian distribution is adopted zhang et al 2015 zhao et al 2011 the gaussian distribution assumes that data tends to be around a central value with no bias left or right and it can be expressed as follows 11 f x 1 2 π σ exp x μ 2 2 σ 2 where f x is the probability density function x is the error value μ is the mean of the distribution σ is the standard deviation and the distribution of x can be denoted as n μ σ 2 in the gaussian distribution σ is the critical indicator to assess the uncertainty of x the uncertainty of the upstream boundary condition can be modelled using the gaussian distribution as follows 12 q t q 0 t ε q t ε q t n 0 a 2 q 0 t 2 where q 0 t represents the observed inflow discharge m3 s ε q t represents the perturbation induced by the uncertainty of q 0 t and a a 0 is a constant coefficient the variance of ε q t is estimated with a 2 q 0 t 2 because the inflow uncertainty is generally proportional to the magnitude of the flow discharge bozzi et al 2015 lai et al 2013 zhang et al 2015 and the coefficient a can be estimated with the observational error 2 uncertainty of downstream boundary condition in this research we considered the case in which the stage hydrograph can be obtained at the outlet and used as the downstream boundary condition in contrast to the flow discharge the observational error of the water stage is mainly determined by the observation instruments horner et al 2018 and it often varies within a limited range independent of the stage magnitude following the gaussian distribution assumption the uncertainty of the water stage was approximately simulated as follows 13 z t z 0 t ε z ε z n 0 b 2 where z 0 t represents the observed stage m ε z represents the perturbation that follows the gaussian distribution centered at zero with a variance of b 2 b 0 and b quantifies the observational uncertainty in this study the coefficient b of water stage is considered to be a time constant determined by the observational accuracy 3 uncertainty of riverbed roughness many factors may contribute to the uncertainty of riverbed roughness such as imperfect model calibration variation in river morphology and unsteady flow state as the critical model parameter the riverbed roughness can affect the uncertainty propagation originating from the boundary conditions similar to the boundary conditions the uncertainty of roughness coefficient n is simulated using the gaussian distribution papaioannou et al 2017 14 n n 0 ε n ε n n 0 c 2 where n 0 represents the calibrated value and ε n represents the perturbation induced by the uncertainty of the riverbed roughness which is quantified by the variance coefficient c c 0 in this study the coefficient c is also a time constant estimated from the maximum variation range of riverbed roughness owing to the spatial variability of the riverbed roughness the coefficient n of different river cross sections is different and simulated independently in addition the riverbed roughness is time variable due to the morphological modifications during flood propagation this part of uncertainty is simulated by increasing the value of the coefficient c to cover the possible variation range of n finally the three sources of uncertainties were simulated with the coefficients a representing the uncertainty of the upstream inflow b representing the uncertainty of the downstream water stage and c representing the uncertainty of the riverbed roughness the uncertainty sources were independently input into the model to identify their individual and joint effects on flood routing 2 3 uncertainty partition approach the boundary conditions and riverbed roughness were independently input into the flood routing model it is not feasible to obtain analytical solutions for the partition of uncertainty propagation from multiple sources instead stochastic methods can be used to infer uncertainties with variances of random variables the uncertainty partition was then derived using monte carlo sampling by repeated random sampling to obtain numerical results bozzi et al 2015 chen et al 2017 xu et al 2007 at first two random variables x a n d y can be sampled using the monte carlo method with the sampled time series of x i a n d y j i 1 2 m j 1 2 n input into the simulation model an uncertain output time series of variable z ij flow discharge or water stage jointly influenced by x i and y j can be obtained and written in matrix form 15 z z 11 z 12 z 1 n z 21 z 22 z 2 n z m 1 z m 2 z mn where m and n represent the sample sizes of x and y respectively the uncertainty of z i j can be quantified with its σ z value which is estimated using equation 16 16 σ z 2 1 m n 1 i 1 m j 1 n z ij z 0 2 here z 0 represent the mean value of z ij 17 z 0 1 m n i 1 m j 1 n z ij for every row i in the matrix of z ij equation 15 the uncertainty from x cannot be observed as all the z ij j 1 2 n values in this row are output from the same input x i a row captures the effect uncertainty of the variation of y from y 1 to y n thus a row variation of z ij j 1 2 n can be attributed to the uncertainty of y for different rows the mean value z i of z ij j 1 2 n varies owing to the variation of x i i 1 2 m 18 z i 1 n j 1 n z ij again the variation of z ij j 1 2 n in row i is caused by the uncertainty of y and the variation of z i is caused by the uncertainty of x consequently the partition be derived as follows first the output variable z ij i 1 2 m j 1 2 n is decomposed as 19 z ij z 0 z i z 0 z ij z i then the decomposition equation 19 is substituted into equation 16 yielding 20 σ z 2 1 m n 1 i 1 m j 1 n z i z 0 z ij z i 2 1 m n 1 n i 1 m z i z 0 2 i 1 m j 1 n z ij z i 2 2 i 1 m z i z 0 j 1 n z ij z i according to equation 18 for every row i z i 1 n j 1 n z ij and then j 1 n z ij z i j 1 n z ij n z i 0 therefore the above equation can be simplified as 21 σ z 2 n m n 1 i 1 m z i z 0 2 1 m n 1 i 1 m j 1 n z ij z i 2 1 m 1 i 1 m z i z 0 2 1 m n 1 i 1 m j 1 n z ij z i 2 where the approximation to obtain the last equation is valid if n is large the first term on the right side of equation 21 represents the variation of z i caused by the uncertainty of x denoted as σ z x 2 the second term represents the variation of z ij caused by the uncertainty of y denoted as σ z x y 2 equation 21 can then be modified as follows 22 σ z 2 σ z x 2 σ z x y 2 similar to the abovementioned derivation the individual uncertainty can be analyzed if one of the two input random variables x or y is fixed to its true value without any uncertainty without loss of generality if x is fixed to its true value x 0 a different y j results in a different z j which produces σ z y clearly σ z y differs from σ z x y as x i in row i always deviates from the true value x 0 the comparison between σ z y and σ z x y can be useful for investigating the coupling effects of x and y in particular if their uncertainty effects are independent σ z y will equal σ z x y 23 σ z 2 σ z x 2 σ z y 2 based on the partitioned variance the contribution ratio of different uncertainty sources fan et al 2020 can be defined as follows to quantify their contribution 24 cr x σ z x 2 σ z 2 25 cr y σ z y x 2 σ z 2 where cr x and cr y represent the contribution ratios of x and y respectively the aforementioned partition for two random variables can be used for streamflow forecast with two uncertainty sources zhao and zhao 2014 however this partition should be improved to the case of three random variables before it can be applied to flood routing when the number of random variables increases to three i e x y and w the variance of the output variable z ijk k 1 2 k is estimated as follows 26 σ z 2 1 m n k 1 i 1 m j 1 n k 1 k z ijk z 0 2 then the partition is deduced from the case of two random variables σ z 2 1 m n k 1 i 1 m j 1 n k 1 k z i z 0 z ij z i z ijk z ij 2 1 m n k 1 n k i 1 m z i z 0 2 k i 1 m j 1 n z ij z i 2 i 1 m j 1 n k 1 k z ijk z ij 2 27 1 m 1 i 1 m z i z 0 2 1 m n 1 i 1 m j 1 n z ij z i 2 1 m n k 1 i 1 m j 1 n k 1 k z ijk z ij 2 28 z ij 1 k k 1 k z ijk accordingly σ z 2 is partitioned as 29 σ z 2 σ z x 2 σ z y x 2 σ z w y x 2 30 cr w σ z w y x 2 σ z 2 cr x and cr y are calculated using the same equations expressed in equations 24 and 25 3 case study 3 1 case description the river reach from the dahuangjiangkou to tengxian gauging stations 96 19 km downstream away from dahuangjiangkou on the xunjiang river of the pearl river basin in china was selected as a case study the pingnan 26 04 km downstream away from dahuangjiangkou is another hydrological gauging station along this river which is located in a city with flood control target the predicted flood discharge and water stage at pingnan were calibrated and their uncertainties were analyzed the locations of this river reach and the two gauging stations are shown in fig 2 in this study three floods in 2011 and 2012 were used fig 3 the 1d flood routing model was constructed using bathymetric data surveyed in 2011 the topographic data were refined with spatial interpolation and a uniform computational grid along the river was used with the space step equal to 500 m the flood routing model used in this study was calibrated and validated with the observations at pingnan gauging station as shown in fig 4 in the second row of fig 4 the vertical axis starts from 21 m for better observation of the simulation error the maximum absolute simulation errors were slightly different in three floods 233 m3 s for discharge and 0 14 m for water stage in flood1 151 m3 s for discharge and 0 16 m for water stage in flood2 245 m3 s for discharge and 0 25 m for water stage in flood3 according to the comparison in fig 4 the simulation results are very close to the observations and the flood routing model is feasible and suitable for this study the uncertainties from the upstream inflow downstream water stage and riverbed roughness were quantified with three random variables x y and w respectively the observation data of the upstream inflow and downstream water stage were obtained from the hydrologic yearbook published by the chinese ministry of water resources and their uncertainties were derived from the code for hydrological data processing 2012 the standard for stage observation 2010 and the code for liquid flow measurement in open channels published by the chinese government finally the uncertainty of the boundary conditions was estimated with a representing the uncertainty of the upstream inflow equal to 0 02 and b representing the uncertainty of the downstream water stage equal to 0 3 the river roughness coefficient n in equation 14 is mainly derived from the previous research and field surveys dou et al 2013 reported that the roughness coefficient changes from 0 016 to 0 044 for the river network of the pearl river basin and zhang et al 2013 reported a range of 0 015 0 045 both reported ranges cover the variation information with time and space including the variation caused by dynamic morphological modification after field surveys and model calibration the river roughness n 0 in equation 14 was estimated to be 0 033 for all the calculated cross sections and their estimation uncertainties quantified by the coefficient c were set at 0 015 four cases with and without combinations of uncertainty sources were examined table 1 3 2 results 3 2 1 individual cases case a b and c for the individual uncertainty source in table 1 were first analyzed as a baseline for the joint case d using the monte carlo method with 25 realizations a reasonable number of realizations is reached when the mean and standard deviation of the ensembles change slightly fig 5 for all three uncertainty sources the individual uncertainties in terms of standard deviation of the simulated discharge and water stage were calculated as shown in fig 6 fig 6 shows the uncertainties of the discharge and water stage at pingnan as a function of time these uncertainties are all due to individual sources the subfigures are arranged as follows the left column corresponds to the uncertainty of the discharge and the right column corresponds to the uncertainty of the stage it can be found that different uncertainty source resulted in significantly different standard deviations of the discharge and water stage as indicated by the left column the uncertainty induced by the upstream inflow followed the rise and fall of the flow magnitude and the standard deviations of the simulated discharge reached its maximum around the flood peak t 75 h in flood1 t 132 h in flood2 and t 125 h in flood3 in contrast the uncertainties induced by the downstream water stage and riverbed roughness were most significant at the beginning and end times in more detail the maximum value of the standard deviations of the simulated discharge due to upstream inflow reached approximately 160 m3 s which is almost 1 of the flood peak in three floods slightly larger than that due to the downstream water stage and riverbed roughness at the beginning of the three floods the standard deviations of the simulated discharge corresponding to upstream inflow is minimum almost 75 m3 s which is the maximum value of the standard deviations corresponding to the riverbed roughness overall the uncertainty of simulated discharge is dominated by the boundary conditions for the right column in fig 6 regarding the uncertainty of simulated water stage the results are significantly different from the left one the water stage uncertainty induced by the riverbed roughness was much larger than that by boundary conditions reaching approximately 0 4 m which is about 2 of the maximum water depth in three floods additionally the standard deviations of the simulated stage corresponding to riverbed roughness also reached their maximum around the flood peak this reveals that the uncertainties from the three sources evolved in a significantly diverse manner and had different effects the uncertainties from boundary conditions mainly affected the flow discharge whereas the water stage was most influenced by the riverbed roughness clearly the uncertainty effects from boundary conditions are related to the river positions for example the proximity to the outlet amplifies the uncertainty effects of the downstream boundary therefore the standard deviations of the simulated discharge and water stage along the river were calculated to investigate the spatial difference of uncertainty effects as shown in fig 7 where the maximum standard deviations over times at different river positions are plotted although the uncertainty variation along the river is highly nonlinear two aspects of rules can be found for all three floods as listed in table 2 regarding the tendency of uncertainty variation for every boundary the uncertainty effects decrease when getting away from it and its effects are substantially reduced by the other boundary for the variation rate the uncertainty from upstream inflow decrease gradually along the river whereas the uncertainty from downstream water stage sharply decrease at a specific position this sharp decrease is possibly related to the river morphology overall the spatial variations of uncertainty effects due to boundary conditions and riverbed roughness are significantly different in addition with the results of different floods compared in both figs 6 and 7 it can be found that the propagation and evolution of flood routing uncertainties are very similar in three floods this finding implies that the flood routing uncertainty partition is hardly affected by the flood pattern 3 2 2 uncertainty partition in joint case the individual case provides the identifiable uncertainty variation in the flood routing results different uncertainty sources cause much different variation in uncertainty effects however how the effects of the three uncertainty sources are coupled what the contribution of different uncertainty source takes and whether their effects are independent can only be answered after a joint case analysis joint case d in table 1 was simulated and analyzed using equation 29 the contribution ratios of different uncertainty sources were calculated and plotted as shown in fig 8 where the left and right columns show the partition results for the simulated discharges and water stages respectively as shown in fig 8 the contribution ratio of every uncertainty source changed significantly over time in accordance with the individual case results the uncertainty contribution ratio of upstream inflow reached a maximum when the flood peaks with cr equal to 0 86 in flood1 0 74 in flood2 and 0 91 in flood3 the uncertainty contribution ratio of downstream water stage reached a maximum at the beginning and end time of the three floods and the contribution ratio of the riverbed roughness is much smaller than the boundary conditions smaller than 0 1 at most times this suggests the uncertainty dominance of the boundary conditions on the simulated discharge however different dominance was observed in the results of simulated water stage the uncertainty contribution ratio of riverbed roughness was 0 9 at most times for all three floods this large contribution ratio of riverbed roughness is partly attributed to the uncertainty overestimation of the river morphology because its maximum effects are considered to determine the variation range of riverbed roughness in the joint case the coupling uncertainty effects make the partitioned results different from those in the individual cases as shown in figs 9 to 11 all figures present comparisons between the partitioned uncertainty in the joint case and individual uncertainty in individual cases if the two standard deviations are the same they fall exactly on a 1 1 line obviously the effects of different uncertainty sources were not independent although their perturbations were independently input to the flood routing model for boundary conditions the correlation between the joint results and individual results is low smaller than 0 62 with the scatters highly random this irregularity is most significant in flood3 however the results regarding riverbed roughness are more regular because consistent deviations in the subfigures about riverbed roughness can be observed for water stage the individual uncertainty is higher showing that the boundary uncertainty in the joint case attenuates the effects of riverbed roughness for flow discharge most of the measures in the range 0 50 m3 s are above the 1 1 line which means that partitioned uncertainty is higher than individual uncertainty this reveals that the uncertainties from boundary conditions can increase the uncertainty effects of riverbed roughness on simulated discharge but reduce its effects on water stage 4 discussion with the proposed partition approach applied the coupling uncertainty effects from multiple sources are successfully quantified and their correlations and contribution ratios can be determined which is useful for uncertainty identification of flood routing however several factors should be considered for the application of the proposed approach in addition to the flood pattern which has been analyzed above the probability distribution of uncertainty source and the river morphology are discussed in this section 4 1 effects of probability distribution of uncertainty source in this study it was assumed that the errors of boundary conditions and riverbed roughness followed a gaussian distribution however the proposed partition approach could be used to other uncertainty distributions for example another probability distribution uniform distribution was examined the detailed uniform distributions of three uncertainty sources are q t u 0 98 q 0 t 1 02 q 0 t z t u z 0 t 0 3 z 0 t 0 3 n u 0 015 0 045 and the results are shown in figs 12 and 13 comparing the individual results in fig 12 and joint results in fig 13 with those in figs 6 and 8 it can be found that the rule of uncertainty contribution is hardly affected by the selected probability distribution nevertheless the uncertainty contribution of the boundary conditions decreases but the riverbed roughness increases for example in the individual case of flood1 the maximum standard deviation of the simulated discharge corresponding to upstream inflow was about 100 m3 s smaller than the 160 m3 s in fig 6 whereas the maximum standard deviation of the simulated water stage corresponding to riverbed roughness is about 0 45 m which is larger than the 0 40 m in fig 6 the uniform distribution increases the uncertainty contribution ratio of riverbed roughness it s reasonable because the calibrated n 0 equal to 0 033 is not the center point of its uncertain range from 0 015 to 0 045 and there are more scatters deviating from n 0 in the uniform case 4 2 effects of river morphology the river morphology is important for flood routing and it is also an uncertainty source due to the complexity of morphological modification in unsteady flow the uncertainty effects of river morphology are implicitly considered by increasing the variation range of riverbed roughness however the uncertainty partition may be affected by the hydraulic geometry therefore the uncertainty partition of flood routing was observed with a prismatic trapezoidal channel referring to the studied real river this hypothetical channel had the length of 100 km bottom width of 1000 m side slope of 2 5 and longitudinal slope of 0 0001 and the riverbed roughness n 0 is also 0 033 the upstream inflow hydrograph was similar to that of flood1 with a peak flow of 16000 m3 s the uncertainty coefficients were set same as that in real world case a 0 02 b 0 3 and c 0 015 the uncertainty partition analysis was conducted at a gauging station 30 km from the inlet and the results are shown in figs 14 and 15 the hypothetical case confirmed the dominance of upstream inflow on the simulated discharge uncertainty for the simulated water stage like the real world case the uncertainty is mainly attributed to the riverbed roughness with average contribution ratio 0 95 however differences were obvious between the two river cases for example the uncertainty effects of downstream water stage and riverbed roughness on the simulated discharge are different from that in the real world case the downstream water stage makes negligible contribution but the riverbed roughness has the contribution ratio reaching 0 80 at the flood beginning these differences also indicate that the partition results are significantly affected by the river morphology nevertheless the proposed approach for obtaining partitioned uncertainty results is not limited by the river morphology 4 3 contributions and drawbacks of this research this research successfully partitioned the uncertainty effects from both boundary conditions and riverbed roughness with their contribution quantified the results reveal that the uncertainty partition is related to the river morphology and the uncertainty overestimation of the river morphology increases the uncertainty contribution ratio of riverbed roughness in the hypothetical case the contribution ratio of riverbed roughness is more significant than that in the real world case while the uncertainty from downstream boundary can be negligible however the rule of uncertainty contribution is hardly affected by the flood pattern as well as the probability distribution of uncertainty source the partition results in three selected floods are very similar and only slight difference can be observed no matter the gaussian distribution or uniform distribution is considered compared with previous works on this topic the present study makes the following contributions 1 the developed uncertainty partition approach can quantify the uncertainty contribution of boundary conditions and riverbed roughness without explicating the interaction between the sources similar issues were reported by scharffenberg and kavvas 2011 and bozzi et al 2015 who also considered the uncertainty from both the boundary conditions and riverbed roughness however their studies shared the same drawback the flood routing model was simplified for explicating the interaction between multiple sources 2 the case study revealed that each uncertainty source leads to unique uncertainty variations in the flood simulation these characteristics of each uncertainty source provide opportunities to identify and manage the dominant uncertainty in flood routing however this study has two drawbacks that should be noted 1 the selected numerical scheme was closely related to the uncertainty results in this study only the preissmann scheme was considered the proposed partition approach could be extended to other numerical schemes to assess the uncertainty partition independently on the hydrodynamic model but this is out of the paper aim 2 the xunjiang river was selected as an example to demonstrate the proposed approach and the results could vary depending on the type of terrain the river morphology has significant effects on the flood routing results any change in the morphology can induce differences in the partitioned uncertainty because the maximum effects of river morphology were implicitly considered in the uncertainty of riverbed roughness the uncertainty overestimation is inevitable therefore other real rivers with different morphologies should be compared in subsequent research 5 conclusions an uncertainty partition approach was proposed to quantify the coupled uncertainty effects from the upstream inflow downstream water stage and riverbed roughness in 1d river flood routing the developed approach was applied to a real world case study and the results indicated the following 1 the developed approach can effectively partition the uncertainty effects of boundary conditions and riverbed roughness without explicating the interaction between multiple sources 2 each uncertainty source leads to unique effects on flood routing and the uncertainty contribution ratio varies significantly with both time and space for the studied river the boundary conditions contribute to most of the uncertainty of simulated discharge while the uncertainty of simulated water stage is dominated by the riverbed roughness the proposed approach provides evidences for identifying the dominant uncertainty sources 3 the coupling effects of the three uncertainty sources are highly dependent and the uncertainty from boundary conditions can increase the uncertainty effects of riverbed roughness on simulated discharge but reduce its effects on water stage 4 the coupled uncertainty propagation is hardly affected by the flood pattern as well as the probability distribution of uncertainty source but it is significantly affected by the river morphology the research could be improved in the future this developed partition approach can be applied to other real rivers and the uncertainty associated with river morphology should be deeply studied with much more details explained for example the morphological modification could be considered with simulated bedform dynamics and the effects that the time variable river morphology has on the quantification of riverbed roughness would be explicitly investigated credit authorship contribution statement jiabiao wang conceptualization data curation investigation methodology writing original draft jianshi zhao conceptualization data curation methodology writing review editing tongtiegang zhao methodology hao wang conceptualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the first author expresses gratitude for the support provided by the chinese scholarship council for his visit to pennsylvania state university where this study was conducted we also thank the editors and the two anonymous reviewers for their insightful comments and excellent suggestions which are very helpful for the improvements of this paper this research was supported by the guangdong basic and applied basic research foundation 2020a1515110906 the national natural science foundation of china 52109047 and the joint open research fund program of state key laboratory of hydroscience and engineering and tsinghua ningxia yinchuan joint institute of internet of waters on digital water governance sklhse 2021 iow01 
3491,accurate quantification of the evolution of water resources requires a better understanding of the movements of water and energy from the subsurface to the lower atmosphere physically based integrated hydrologic models provide one of the key approaches to build such understanding however these models utilize a significant number of parameters that are measured only sparsely if at all in particular the hydrodynamic parameters in this work we perform a global sensitivity analysis to quantify the sensitivity of evapotranspiration et to the hydrodynamic parameters we study the east river watershed located in the coloradobasinand characterized by cold and snowy winters and hot summers high topographic gradients and heterogeneous land cover and geology our results highlight that hydrodynamic parameter uncertainties lead to 20 to 50 uncertainties in et in areas characterized by a disconnection betweengroundwaterand land surface processes under water limited conditions hydrodynamic parameter uncertainties strongly impact et which is highly sensitive to the parameters describing the unsaturated zone parameters conversely in energy limited areas where plants have year round access to groundwater et is mainly sensitive to the effects of saturated hydraulic conductivities et uncertainties due to the uncertainties in hydrodynamic parameters were higher than those associated with the river stages and water table depths therefore et measurements could be used to improve the estimation of hydrodynamic parameters keywords integrated hydrologic models parametric uncertainties global sensitivity analysis evapotranspiration hydrodynamic parameters mountainous watershed 1 introduction climate perturbations and ecosystems disturbances are significantly changing the water cycle in mountainous watersheds also called water towers that provide water for billions of people around the world accurate quantification of these impacts essential for water resource management require physically based integrated hydrologic models representing the movements of water and energy from the bedrock to the lower atmosphere abbott et al 1986 brunner and simmons 2012 camporese et al 2010 maxwell and miller 2005 nevertheless these models are embedded with several sources of uncertainties including the meteorological forcing and the physical properties of the land cover and the subsurface song et al 2015 while accurate and high resolution meteorological forcing daly et al 2008 maina et al 2020 and land cover data e g neon dataset 2020 could be obtained although their acquisition may not be affordable the subsurface data remains a challenge due to its complexity and difficulty of access understanding how subsurface properties uncertainties propagate through integrated hydrologic models and affect their outputs is therefore essential numerous works e g dai et al 2017 gan et al 2014 bianchi janetti et al 2019 maina and guadagnini 2018 van werkhoven et al 2008 have analyzed the impact of these subsurface properties uncertainties on the simulated hydrology however these works are mostly limited to the understanding of the subsurface flow processes while integrated hydrologic models also simulate key land surface processes such as evapotranspiration et the largest flux in the water and energy cycles an accurate quantification of et is essential for a better understanding of the connection between the water and energy balances in the subsurface and the atmosphere e g anyah et al 2008 j chen et al 2020 fan et al 2007 maxwell et al 2007 miguez macho and fan 2012 rahman et al 2014 2016 trevisan et al 2020 vergnes et al 2014 moreover the use of multiple sources of information including et is important to better estimate the physical properties of the subsurface clark et al 2015 nijzink et al 2018 paniconi and putti 2015 stisen et al 2018 remotely sensed et are available lettenmaier et al 2015 mccabe and wood 2006 zhang et al 2016 at unprecedented resolutions allen et al 2007 hulley et al 2017 justice et al 1998 on the contrary to the measurements of groundwater levels and river stages which are performed at a point scale as a result the use of et datasets to constraint hydrologic models has emerged in recent years becker et al 2019 dembélé et al 2020 li et al 2009 stisen et al 2011 wambura et al 2017 because of its potential to reduce the equifinalities and uncertainties inherent to hydrologic models especially in data scarce regions and ungauged basins immerzeel and droogers 2008 jiang et al 2020 lópez lópez et al 2017 rajib et al 2018 rientjes et al 2013 stisen et al 2018 tobin and bennett 2017 wambura et al 2018 willem vervoort et al 2014 previous studies anyah et al 2008 ferguson and maxwell 2010 jiang et al 2009 lo and famiglietti 2010 have highlighted that the interactions between et and the subsurface depend on the depth of the water table and the et conditions water or energy limited conditions however these studies did not rely on a global sensitivity analysis gsa hence they did not investigate the impacts of the hydrodynamic parameters i e saturated hydraulic conductivity porosity specific storage manning coefficient etc on et gsa allows determining the influence of input parameters on model outputs and requires multiple simulations of the model although gsa is very important to integrated hydrologic models because of their numerous parameters and nonlinearities wainwright et al 2014 homma and saltelli 1996 pianosi and wagener 2015 razavi and gupta 2015 sarrazin et al 2016 song et al 2015 it is not widely applied to these models due to their high computational demand miller et al 2018 among the few existing gsa applications on integrated hydrologic models jefferson et al 2015 use the active subspaces approach constantine and diaz 2017 to assess the impacts of vegetative parameter uncertainties in parflow clm maxwell and miller 2005 ryken et al 2020 use the same methodology to identify the most important parameters to snow dynamics gatel et al 2020 utilize a gsa based on sobol indices sobol 1993 to study the exchange between surface and subsurface processes ghasemizade et al 2017 use hydrogeosphere brunner and simmons 2012 and sobol indices to discuss the differences between sensitivity and identifiability of hydrodynamic parameters using et water content and seepage srivastava et al 2014 perform gsa based on morris indices morris 1991 to study the impacts of vegetative and hydrodynamic parameters in parflow clm recently maina and siirila woodburn 2020 study the impacts of subsurface properties on et with sobol indices applied to the integrated hydrologic model parflow clm maxwell and miller 2005 while this study elucidates the connectivity between the subsurface and et it is based on a semi synthetic small and homogeneous domain in this work we study the impacts of hydrodynamic parameter uncertainties on et in a mountainous watershed the east river located in the upper basin of the colorado river hubbard et al 2018 the watershed is characterized by a significant topographic gradient and a highly heterogeneous land cover with coniferous and aspen forests bare soil and grasses overlying a complex geological formation because previous studies have shown that hydrodynamic parameters are more uncertain and important than the vegetative parameters srivastava et al 2014 we only focus on the hydrodynamic parameters in this study we use the integrated hydrologic model parflow clm maxwell and miller 2005 however the conclusions drawn from this work will provide useful information for other integrated hydrologic models e g hydrogeosphere as they use similar equations we use sobol indices computed with a surrogate model based on a polynomial chaos expansion sudret 2008 wiener 1938 we compare et sensitivities to the sensitivities of surface and subsurface hydrologic processes i e river stages saturation and pressure head to evaluate the potential of et in hydrodynamic parameters estimation we aim to investigate how 1 the incomplete knowledge i e uncertainties of the hydrodynamic parameters alter the estimation of et in real world setting and in both water and energy limited conditions and 2 the land surface processes information could help to determine subsurface parameters 2 study area east river watershed located in the upper colorado basin the east river watershed fig 1 covers an area of approximately 255 km2 the river is one of the two major tributaries that form the gunnison river which in turn accounts for just under half of the colorado river s discharge at the colorado utah border the watershed elevation varies from approximately 2700 to 3900 m the area has a continental subarctic climate with long cold winters and short warm summers the average precipitation in the watershed is 1200 mm year and the average temperature is 0 degreesc daly et al 2008 because of its very low winter temperature most of the winter precipitation falls as snow which will later melt in late spring and summer due to the hot temperatures to contribute along with the summer monsoons to groundwater recharge as well as river discharge watershed vegetation includes grasses conifers mixed conifers aspens and meadows and lies on a complex geologic terrain which is comprised of a diverse collection of paleozoic and mesozoic sedimentary and unconsolidated rocks the east river watershed provides a unique opportunity to study the interactions between et and the hydrodynamics in a complex topographic geologic and land cover setting besides east river s physical characteristics and climate variability allow studying the impacts of hydrodynamic parameters on et under both water and energy limited conditions we focus in this study on the lower part of the watershed encompassing its outlet as shown in fig 1 this smaller domain called the lower triangle captures the important heterogeneities of the watershed including steep changes in topography geology and vegetation while at a smaller scale thus maintaining computationally feasibility in addition this domain it is subject to several instrumentations and monitoring in the east river 3 modeling framework we describe in this section the integrated hydrologic model parflow clm maxwell and miller 2005 and the global sensitivity analysis based on the chaos polynomial expansion 3 1 integrated hydrologic model parflow clm the three dimensional mixed form of the richards equation richards 1931 is used in parflow to describe the flow in variably saturated media eq 1 1 s s s w ψ p ψ p t ϕ s w ψ p t k x k r ψ p ψ p z q s where is s s the specific storage l 1 s w ψ p is the degree of saturation associated with the subsurface pressure head ψ p l t is the time t ϕ is the porosity k r is the relative permeability z is the depth q s is the source sink term t 1 that accounts for infiltration and evapotranspiration and k x is the saturated hydraulic conductivity l t 1 which is assumed to be a diagonal tensor with entries given as k x x k y x and k z x we assumed in this study that the domain is isotropic and the tensor is equal to 1 for all the three directions in the unsaturated zone both s w and k r depend on ψ these relations are described by the van genuchten model van genuchten 1980 given by 2 s w ψ p 1 α ψ p η m g ψ p 0 1 0 ψ p 0 3 k r s w ψ p 1 2 1 1 s w ψ p 1 m g mg 2 ψ p 0 1 0 ψ p 0 where α and η are the van genuchten parameters and mg 1 1 η overland flow is solved by the kinematic wave equation in two dimensions 4 k x k r ψ 0 ψ 0 z ψ 0 0 t υ ψ 0 0 q r x where ψ 0 is the ponding depth ψ 0 0 indicates the greater term between ψ 0 the pressure head at the top layer and 0 υ is the depth averaged velocity vector of surface runoff l t 1 q r is a source sink term representing rainfall and evaporative fluxes l t 1 surface water velocity at the surface in x and y directions υ x and υ y respectively is computed using the following set of equations 5 υ x s f x m ψ 0 2 3 a n d υ y s f y m ψ 0 2 3 where s f x and s f y friction slopes along x and y respectively and m is the manning coefficient parflow employs a cell centered finite difference scheme along with an implicit backward euler scheme and the newton krylow linearization method to solve these nonlinear equations the computational grid follows the terrain to mimic the slope of the domain maxwell 2013 parflow is coupled to the community land model clm dai et al 2003 to account for the interactions between the lower atmosphere and the land surface clm determines the quantity of water leaving or entering the surface and subsurface denotes q s and q r respectively in the richards and kinematic wave equations we note that evaporation e indicating the evaporation from bare soil and water bodies is only applied to the top soil layer of parflow while the transpiration t i e canopy evaporation and plant transpiration is distributed over the entire root zone defined by the user clm models the thermal processes by closing the energy balance at the land surface given by 6 r n θ l e θ h θ g θ where θ ϕ s w is the soil moisture r n is the net radiation at the land surface e lt a balance between the shortwave also called solar and longwave radiation le is the latent heat flux e lt which captures the energy required to change the phase of water to or from vapor h is the sensible heat flux e lt and g is the ground heat flux e lt the following one dimensional form of the conduction equation is used to solve the ground temperature 7 t ϕ s w ρ w c w 1 ϕ c s t λ t q t the ground heat flux at the land surface boundary is equal to 8 λ t g where ρ w is the density of water ml 3 c w and c s are respectively the specific heat capacity of the water and soil jm 1k 1 t is the temperature in the soil column k λ is the thermal hydraulic conductivity wm 1k 1 latent le and sensible heat h fluxes are computed differently for bare soil and vegetation in bare soil the le depends on a soil resistance factor and a friction velocity whereas when vegetation is present le depends on vegetative parameters such as leaf and stem area indices h from bare soil depends on the air temperature at the ground surface and an aerodynamic resistance factor whereas when vegetation is present h also accounts for the heat conductance of vegetation and its temperature the ground heat flux is linked to the longwave radiation and is determined from the closure of the energy balance described in eq 6 it therefore accounts for both le and h fluxes the calculation of the different components of the energy balance requires meteorological forcing vegetative parameters and soil moisture the soil moisture is computed by parflow using eqs 1 and 2 meteorological forcing includes precipitation temperature east to west and north to south wind speed long wave and short wave solar radiation air pressure and relative humidity vegetative parameters include maximum and minimum leaf area index stem area index aerodynamic roughness height optical properties stomatal physiology roughness length and displacement height we note that clm along with the ecosystem dynamics clm also accounts for the effects of radiation using variables such as the surface albedo and the solar zenith angle more details about the coupling between parflow and clm as well as the equations governing the snow dynamics and et can be found in the following papers maxwell and condon 2016 jefferson et al 2015 maxwell and miller 2005 ryken et al 2020 3 2 global sensitivity analysis in this paper we focus on the uncertainties associated with the following hydrodynamic parameters saturated hydraulic conductivity k specific storage s s porosity ϕ van genuchten α and η and the manning coefficient m we assumed that these parameters are identically and uniformly distributed therefore a logarithmic transformation was applied to the parameters whose ranges of variability span multiple order of magnitude such as k and s s for the sake of simplicity we assume that the spatial distributions of the parameters are known derived from soil and geological maps only that their values are uncertain we analyze the following outputs et sw river stages and subsurface pressure head we use the sobol indices sobol 1993 widely used in geosciences and derived from the analysis of variance anova archer et al 1997 saltelli et al 2010 these indices quantify the contribution of each model parameter either alone or in interactions with other parameters to the variance of the model output the variance of any model output which belongs to the space of square integrable functions and depends on a set of input parameters identically and uniformly distributed and defined in 0 1 n can be decomposed into a sum of variances given by 9 v i 1 n v i j i n v ij v 1 n where v is the total variance of the output of interest and the subscripts indicate the parameters for example v i is the variance of parameter i from this decomposition total sobol indices s i tot hereafter refereed as sobol indices that quantify the contribution of an input parameter either solely or in interaction with the other inputs based the variance of the output are derived 10 s i tot i i 1 i s v i 1 i s v accurate quantification of the sobol indices requires extensive explorations i e multiple simulations of the parameter space because parflow clm is computationally expensive we constructed a reduced order model based on a polynomial chaos expansion crestaux et al 2009 fajraoui 2014 fajraoui et al 2011 maina and guadagnini 2018 maina et al 2021 sudret 2008 that will allow us to perform multiple simulations at a reasonable computational cost in the polynomial chaos expansion like in the decomposition of variance eq 9 any square integrable function can be decomposed into a sum of orthogonally multivariate polynomial wiener 1938 given by 11 y j 0 a j ξ j x j where a is the polynomial coefficients and ξ multivariate orthogonal polynomial of legendre note that the wiener decomposition initially of an infinite order is truncated to a finite order m for computational purposes for polynomial degree p is the polynomial degree m is calculated by 12 m n p n p the truncated eq 11 is given by 13 y j 0 m a j ξ j x j ε where the residual ε is supposed to be a zero mean variable coefficients a are determined using lest squares regression method 14 14 a ζ t ζ 1 ζ t f where ζ is the matrix of coefficients of ξ j x j and f is the vector containing the model outputs we use the expansion as defined in eq 10 to construct the surrogate model with a polynomial degree p equal to 4 and the number of parameters n is equal to 13 we provided a schematic representation of the different steps we followed to compute the sobol indices using the surrogate model based on the polynomial chaos expansion in appendix a1 more details about the construction of the surrogate model could be found in sudret 2008 4 numerical experiments 4 1 integrated hydrologic model model discretization the spatial extent of the domain is 6 3 km by 6 6 km in the x and y horizontal directions respectively with a thickness equals to 30 m the spatial resolution of the model is 100 m and 5 layers constitute the model in the vertical direction with varying thickness from 0 1 m at the land surface to 21 m at the bottom of the domain as in the previous studies foster et al 2020 foster and maxwell 2019 we opt for this vertical discretization to reduce uncertainties in the computation of fluxes in the unsaturated zone we run the model in parallel using 32 cores on nersc s cori supercomputer land surface parameterization the land cover is derived from the neon dataset neon dataset 2020 which is originally at 1 m resolution then upscaled to the resolution of our model we distinguish 4 types of land cover forests i e conifers and aspens mixed forests grasses and bare soil the latter represents the outcropping of the bedrock in high elevations areas neon dataset 2020 their vegetative properties are derived from the igbp database subsurface parameterization the subsurface is heterogeneous in both vertical and horizontal directions foster and maxwell 2019 the top 1 m corresponds to three soil layers as defined by the ssurgo database and then corrected based on the land cover and geologic maps to include the outcropping of the bedrock we distinguish two types of soil sandy loam and clay loam the geology of the subsurface comprised between 1 m and 8 m below the ground was defined with the usgs maps this zone is highly heterogeneous with different formations such as crystalline sedimentary rocks unconsolidated rocks alluvial deposits and debris flow the bottom layer of the domain extending 8 m below the ground surface to the bottom of the model is assumed homogeneous and represents the fractured bedrock boundary conditions dirichlet i e imposed pressure heads boundary conditions are set at the northern limit of the study area time varying daily pressure heads are derived from a simulation of a larger east river watershed model i e the region in fig 1b to account for the transient flow conditions neumann i e no flow boundary conditions are imposed at the three other limits and the bottom of the domain initial conditions we simulated the water year 2015 a relatively average water year based on precipitation and temperature patterns initial conditions for pressure head were obtained from a spin up using the forcing of 2015 and the median value for each parameter i e the median of the range of uncertainties listed in table 1 we recursively simulated the water year until the differences of storage at the end of the water year were less than 1 indicating convergence meteorological forcing prism datasets daly et al 2008 were used for precipitation and temperature because of their accuracy and high spatial resolution 800 m however the temporal resolution of prism is daily fig 2 which hampers the ability of this dataset to reproduce diurnal cycles an important factor when studying et the phase 2 of the north america land data assimilation system nldas 2 forcing cosgrove et al 2003 provides hourly changes in precipitation and temperature yet are only available at coarser resolutions 1 8 degree which limits the accuracy in reproducing snow dynamics and discharge as such we convert prism daily data to hourly using the nldas 2 forcing temporal resolution we employ a mass conservative temporal interpolation which disaggregates the total daily prism precipitation and temperature into hourly for the other forcing variables i e short and long wave radiation wind speed atmospheric pressure and specific humidity we use native nldas 2 forcing cosgrove et al 2003 without applying downscaling approaches model validation we compare in appendix a2 simulated and observed river stages and snow water equivalent swe we use the results from the large east river watershed model foster and maxwell 2019 for comparisons because of the lack of measurements especially swe in our area of interest 4 2 global sensitivity analysis the selected ranges of uncertainty of the parameters shown in table 1 are meant to represent geologic formations varying from coarse and high permeable to fine and low permeable materials saturated hydraulic conductivity porosity and the manning coefficient are assumed to be heterogeneous while the specific storage ss and van genuchten α and η are spatially homogenous because their estimation is difficult and previous calibration were successful by considering them homogeneous the model has five saturated hydraulic conductivities two associated with the soil layers k1 and k2 for sandy loam and clay loam respectively two for the subsurface between 1 and 8 m k3 and k4 for sedimentary and unconsolidated rocks and one in fractured bedrock i e bottom layer which is assumed to be homogeneous k5 we note that the majority of forests lie on k3 while the grasses sit on k4 the porosity is heterogeneous in the soil layers sandy loam ϕ1 and clay loam ϕ2 and homogeneous in the subsurface layers below 1 m ϕ3 we define two manning coefficients one for the forests and the other one for grasses we perform 700 simulations to construct the surrogate model a single simulation requires approximately 2 to 3 h of wall clock time to complete we sample the hydrodynamic parameters for each simulation using the quasi monte carlo sampling technique a method with reliable convergence properties b feil 2009 braaten and weller 1979 caflisch 1998 that allows a good exploration of the parameter space the surrogate model based on a polynomial chaos expansion of order 4 was then used to generate 3000 additional simulations the accuracy of the reduced order model has been assessed by several cross validations which consist of comparing the surrogate model output with the full model response the rmses not shown here are of the order of 10 7 0 01 and 0 1 for et saturation and pressure head respectively sobol indices were then computed with the 3700 simulations obtained with both the full and surrogate models previous studies have shown that because sobol indices only describe the impact of the uncertainties of the input variables on the variance of the output they could provide an incomplete picture of the impact of model parameters on its output therefore it is important to not only study the variance of the output but also the other characteristics of the output s probability density function such as the mean and the skewness dell oca et al 2017 to address this limitation of the sobol indices we computed the amae indices which quantify the contribution of each parameter to the mean of the model output dell oca et al 2017 our results not shown here for brevity have indicated that the amae indices provide similar information as the sobol indices for this particular test case 5 results we study in both space and time the following model outputs et and its components e and t river stages ψs soil saturation sw at the first 2 m and subsurface pressure head ψb we investigate sw ψs and ψb to compare the sensitivities of et to these variables commonly measured in hydrological observatories we study the spatiotemporal distributions of the mean μ the coefficient of variation cv σ μ where σ is the standard deviation and the sobol total indices 5 1 evapotranspiration at the catchment scale fig 3 shows monthly variations of the mean values μ of et e and t and their sobol indices as expected μ of et is high in summer due to the availability of water originating snow ablation and monsoon to meet the high et demand of the hot summer this period has also the highest et uncertainties as indicated by the gray lines representing all the computed et in fig 3a changes in et are mainly controlled by k1 and the van genuchten α and η as indicated by the sobol indices in fig 3b we also observe similar behavior with e fig 3c and d and t fig 3e and f the sensitivity of e to the hydrodynamic parameters is similar to the one associated with et but t shows a slightly different response with high sensitivity to the van genuchten η these results highlight that et at the watershed scale is mostly sensitive to the parameters describing flow in the soil k1 and the van genuchten α and η fig 3b 5 2 spatial distributions of the sensitivity indices because et μ and cv are high in summer we study the spatial patterns in july fig 4 shows the histograms of the μ and the cv of et e t sw and ψb of all cells of the discretized integrated hydrologic model we classified the cells according to their land cover bare soil forests mixed forests and grasses forests and mixed forests have the highest mean μ values of et on contrary to grasses and bare soil fig 4a the distribution of the mean μ values of t is very similar to mean μ values of et fig 4e whereas we observe a different pattern for the mean μ values of e which are high in bare soil fig 4c the cv values of et fig 4b are high in forests because they are under water limited conditions as such et strongly depends on groundwater dynamics and therefore the hydrodynamic parameters et under grasses and bare soil on the other hand is more energy limited than water limited as a result the cv values of et are low because et mainly depends on the atmospheric conditions the spatial distributions of μ and cv of the selected outputs are shown in fig 5 a and b the high mean μ values of et observed under forests lead to a deeper water table low mean μ values of ψb and low mean μ values of sw fig 5a the cv values of ψb and sw are low compared to the cv values of et fig 5b indicating the strong impact of hydrodynamic parameters on et compared to the unsaturated and saturated flows i e ψb and sw the cv values of ψs is also lower than the cv values of et fig 5b especially in the branch of the east river because the variations of ψs are mainly controlled by the snowmelt which depends more on the climatic conditions than the hydrodynamic parameters fig 5c depicts the spatial distribution of the sobol indices for the sake of simplicity we will discuss these indices separately for each output in the next sections evapotranspiration et in section 5 2 1 river stages ψs and saturation sw in section 5 2 1 and subsurface pressure head ψb in section 5 2 1 5 2 1 evapotranspiration et the spatial distributions of the sobol indices associated with et are shown in fig 5c saturated hydraulic conductivities k1 is influential everywhere in the domain with the exception of the northwest corresponding to the outcropping of the bedrock i e bare soil the sobol indices of k3 are only significant under grasses whereas the indices of k4 and k5 are negligible van genuchten parameters the sobol indices of α and η show opposite trends areas with high et forests under water limited conditions are very sensitive to η because to meet these high demands water has to be taken from the pores and this depends on the distribution of the pore size i e η while areas with low et grasses mostly depend on α because the available water which depends on α is sufficient to meet the et demand porosity and specific storage mostly control et in areas with high values of sw because in these zones the amount of available water to meet the et demand only depends on their values manning coefficient this parameter only influences et in the river 5 2 2 surface and soil hydrodynamics river stages ψs and saturation sw the manning coefficient is the most influential parameter to ψs all the saturated hydraulic conductivities except k5 contribute to the changes in sw k1 is influential to sw in the vicinity of the river while k3 and k4 are influential to sw in areas subject to low et i e grasses the spatial distributions of the sobol indices of the van genuchten α and η associated with sw are similar to the ones associated with et because of the strong connection between sw i e water availability and et 5 2 3 subsurface pressure head ψb the sobol indices of k3 and k4 associated with ψb are mainly noticeable in low et areas while in areas with high et characterized by a deep water table ψb is sensitive to the van genuchten α and k5 the manning coefficient influences ψb in the vicinity of the river due to the river groundwater exchange 5 3 temporal variations of the sobol indices because the sobol indices depend on the land cover as shown in the previous sections we discuss the temporal patterns by land cover type we illustrate in fig 6 the monthly variations of swe infiltration et ψs sw and ψb at three selected points forests point a grasses point b and mixed forests point c see their location in fig 1c fig 7 depicts the box plots of the sobol indices of monthly averaged values of the hourly simulated et and sobol indices of daily averaged values of the hourly simulated sw and ψb at the three selected points 5 3 1 forests in forests the snow peak is low because of their canopy intercepting most of the snowfall and the snow ablation and infiltration start early with low rates fig 6 the 3700 simulations have similar snow accumulation however the durations of snow ablation are slightly different due to the uncertainties in k1 affecting the soil thermodynamics and governing its ability to infiltrate water as a result the infiltration timing and magnitudes are also different forests have the highest et fluxes as such they have a thick unsaturated zone as indicated by their low sw values fig 6d and their deep water table fig 6e forests et is highly sensitive to the van genuchten η in addition to k1 k3 and the van genuchten α fig 7a the sensitivity of et to these parameters is high in summer because et is water limited forests sw are sensitive to k3 k5 and the van genuchten α and η fig 7b during baseflow sw is sensitive to the van genuchten α and η whereas k3 and k5 are the most important parameters to sw during peak flow not shown here for brevity the low recharge of forests is due to their thick unsaturated zone as a consequence forests ψb has low seasonal changes fig 6e and is sensitive to the van genuchten α and k5 fig 7c 5 3 2 grasses grasses are characterized by high peak snow late snow ablation high infiltration and low et fig 6a c due to their low transpiration and root uptake grasses sw is close to 1 during peak flow and it decreases by 50 in baseflow fig 6d similarly their water table depth is shallow and experiences a strong decrease up to 5 m during baseflow conditions fig 6e grasses et and sw are highly sensitive to k1 k4 and the van genuchten α fig 7d and e grasses ψb is mainly sensitive to k1 and k4 fig 7c 5 3 3 mixed forests results of mixed forests show that et values are in between the et of forests and grasses hence their sensitivities include both the hydrodynamic controlling et in forests and grasses fig 7g i 5 4 interactions between land cover topography and water table depth fig 8 depicts the annual averages of the sobol indices of the van genuchten η k1 and the sum of the 5 saturated hydraulic conductivities associated with et as a function of the water table depth the dots represent the cells of the discretized integrated hydrologic model which are colored according to their type of land cover dark green for forests green for mixed forests and dark yellow for grasses the relationship between the sensitivity of et to the van genuchten η and the water table depth is nonlinear fig 8a this is in agreement with the results of lo and famiglietti 2010 who show that the feedback between groundwater and land surface processes follows a nonlinear relationship for cells with a deep water table forest cells in dark green the sensitivity to the van genuchten η is high the latter decreases in a nonlinear way as the water table depth decreases corresponding to the grassland areas in dark yellow we note a similar but inverse relationship between the sensitivity of et to the saturated hydraulic conductivities fig 8b and c and the water table depth the two extremities of the curves remain the same grasses and forests while the mixed forests are in between even if in general forests and grasses are characterized by distinct hydrologic processes and control parameters the latter change from one point to another in the same land cover type depending on the water table depth the combination of the water table depth whose changes are controlled by the topography and the land cover highlights that the processes aren t disconnected and specific for each type of land cover but change gradually with respect to the water table depth the topography and the land cover hence a forest cell with a shallow water table depth will likely behave as a grassland cell with a deep water table 6 discussions 6 1 comparisons with previous studies our results show that forests on contrary to grasses are characterized by a deep water table and their high et is sensitive to the unsaturated zone parameters these findings are in agreement with the work of srivastava et al 2014 soylu et al 2011 and maina and siirila woodburn 2020 furthermore maina and siirila woodburn 2020 highlight that the van genuchten η affects et in forests as in this work although the water table is deep under forests et is high because the deeper root zone allows the vegetation to maintain t which is consistent with the results of rihani et al 2010 and trevisan et al 2020 our results as the previous studies also indicate that groundwater influences more the variability of the land surface processes under water limited conditions high et areas than under energy limited conditions where land surface processes mostly depend on the atmospheric forcing rahman et al 2014 moreover the authors point out that the dependence of et on water table depth is more pronounced in summer than winter as shown in our results 6 2 hydrodynamic parameters estimation our results illustrate that the hydrodynamic parameter uncertainties lead to up to 20 uncertainties in et at the basin scale and up to 50 at a point scale these et uncertainties are at the same order of magnitude and even greater than the reported remote sensing uncertainties which vary from 15 to 50 depending on the scale of time and space and the physical characteristics of the basin mu et al 2011 nagler et al 2005 velpuri et al 2013 therefore our results emphasize that remote sensing products could be used to estimate hydrodynamic parameters besides the cv of et is higher than that of the measured hydrologic variables ψs sw and ψb also et could contain information about the soil saturated hydraulic conductivity and van genuchten α and η which are difficult to measure although current remotely sensed et are embedded with high uncertainties these uncertainties will likely decrease in the near future strengthening their potential for parameter estimation however as discussed by ghasemizade et al 2017 sobol indices are not suitable for conclusions about the identifiability of the parameters a rigorous parameter identifiability study could be performed in the future by applying gsa on objective function or employing the mutual information theory framework to determine the amount of information about the hydrodynamic parameters contained in remotely sensed et 6 3 the importance of hydrodynamic parameters on the feedback between the atmosphere and the subsurface because hydrodynamic parameters have strong impacts on et they also affect the surface energy fluxes interestingly the most important parameters i e van genuchten η to et are not relevant to subsurface hydrology ψb and ψs although the importance of accounting for the two way interactions between the land surface and subsurface is widely discussed in the literature clark et al 2015 condon et al 2013 ferguson and maxwell 2010 keune et al 2016 maxwell et al 2007 maxwell and condon 2016 current models often neglect these interconnections especially a detailed representation of the physical characteristics of the subsurface while supporting previous findings our study highlights that a better estimation of the hydrodynamic parameters is necessary to improve the estimation of energy fluxes at the land surface 6 4 study limitations we acknowledge that although the model we employ in this study has the advantage of physically representing the processes governing the hydrodynamics it is embedded with irreducible uncertainties from many sources including the assumptions made in the physical representation of both hydrodynamic processes and land surface processes such as transpiration mechanisms and the numerical resolution of the equations governing these processes future studies will focus further assess and compare the impacts of these different sources of uncertainties in addition to the parametric uncertainties on model outputs 7 summary and conclusions in this work we assessed the impacts of hydrodynamic parameter uncertainties saturated hydraulic conductivities porosities specific storage van genuchten parameters and manning coefficients on simulated et we do so by using the integrated hydrologic model parflow clm and sobol indices we studied the lower portion of the east river watershed a complex system characterized by high topographic gradients and heterogeneous land cover and geology our results highlight that hydrodynamic parameter uncertainties lead to up to 20 at the basin scale and up to 50 at a point scale et uncertainties the sensitivity of et to hydrodynamic parameters depends on the land cover fig 9 shows a summary of land surface processes and hydrodynamics as well as their influential parameters associated with three types of land cover in forests i e water limited conditions the et is high as a result the unsaturated zone is thick and the water table is deep et is highly sensitive to the unsaturated zone parameters the van genuchten η due to the disconnection between the saturated zone hydrodynamics and the land surface processes grasses i e to energy limited conditions have low et highly sensitive to the subsurface saturated hydraulic conductivity because the water table is shallow however due to the complexities of the system these influential parameters are not specific for each land cover type and depend on the water table depth in a nonlinear way because et is very sensitive to hydrodynamic parameters with coefficients of variation greater than those associated with the river stages water table depth and saturation et could contain valuable information about hydrodynamic parameters and could improve their estimation a better characterization of the physical properties of the subsurface is essential to accurately quantify et credit authorship contribution statement fadji z maina conceptualization formal analysis methodology software writing original draft writing review editing erica r siirila woodburn conceptualization formal analysis methodology software writing original draft writing review editing peter james dennedy frank conceptualization formal analysis methodology software writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement data supporting the findings of this study can be found here maina f z 2020 assessing the interconnectivity between land surface processes and hydrodynamics in a mountainous watershed hydroshare http www hydroshare org resource 7e7e207546d94c9aab91427d49f51c98 this work was supported by the watershed function scientific focus area funded by the u s department of energy office of science office of biological and environmental research under award no de ac02 05ch11231 appendix a1 schematic representation of the computation of the sobol indices appendix a2 comparisons with measurements 
3491,accurate quantification of the evolution of water resources requires a better understanding of the movements of water and energy from the subsurface to the lower atmosphere physically based integrated hydrologic models provide one of the key approaches to build such understanding however these models utilize a significant number of parameters that are measured only sparsely if at all in particular the hydrodynamic parameters in this work we perform a global sensitivity analysis to quantify the sensitivity of evapotranspiration et to the hydrodynamic parameters we study the east river watershed located in the coloradobasinand characterized by cold and snowy winters and hot summers high topographic gradients and heterogeneous land cover and geology our results highlight that hydrodynamic parameter uncertainties lead to 20 to 50 uncertainties in et in areas characterized by a disconnection betweengroundwaterand land surface processes under water limited conditions hydrodynamic parameter uncertainties strongly impact et which is highly sensitive to the parameters describing the unsaturated zone parameters conversely in energy limited areas where plants have year round access to groundwater et is mainly sensitive to the effects of saturated hydraulic conductivities et uncertainties due to the uncertainties in hydrodynamic parameters were higher than those associated with the river stages and water table depths therefore et measurements could be used to improve the estimation of hydrodynamic parameters keywords integrated hydrologic models parametric uncertainties global sensitivity analysis evapotranspiration hydrodynamic parameters mountainous watershed 1 introduction climate perturbations and ecosystems disturbances are significantly changing the water cycle in mountainous watersheds also called water towers that provide water for billions of people around the world accurate quantification of these impacts essential for water resource management require physically based integrated hydrologic models representing the movements of water and energy from the bedrock to the lower atmosphere abbott et al 1986 brunner and simmons 2012 camporese et al 2010 maxwell and miller 2005 nevertheless these models are embedded with several sources of uncertainties including the meteorological forcing and the physical properties of the land cover and the subsurface song et al 2015 while accurate and high resolution meteorological forcing daly et al 2008 maina et al 2020 and land cover data e g neon dataset 2020 could be obtained although their acquisition may not be affordable the subsurface data remains a challenge due to its complexity and difficulty of access understanding how subsurface properties uncertainties propagate through integrated hydrologic models and affect their outputs is therefore essential numerous works e g dai et al 2017 gan et al 2014 bianchi janetti et al 2019 maina and guadagnini 2018 van werkhoven et al 2008 have analyzed the impact of these subsurface properties uncertainties on the simulated hydrology however these works are mostly limited to the understanding of the subsurface flow processes while integrated hydrologic models also simulate key land surface processes such as evapotranspiration et the largest flux in the water and energy cycles an accurate quantification of et is essential for a better understanding of the connection between the water and energy balances in the subsurface and the atmosphere e g anyah et al 2008 j chen et al 2020 fan et al 2007 maxwell et al 2007 miguez macho and fan 2012 rahman et al 2014 2016 trevisan et al 2020 vergnes et al 2014 moreover the use of multiple sources of information including et is important to better estimate the physical properties of the subsurface clark et al 2015 nijzink et al 2018 paniconi and putti 2015 stisen et al 2018 remotely sensed et are available lettenmaier et al 2015 mccabe and wood 2006 zhang et al 2016 at unprecedented resolutions allen et al 2007 hulley et al 2017 justice et al 1998 on the contrary to the measurements of groundwater levels and river stages which are performed at a point scale as a result the use of et datasets to constraint hydrologic models has emerged in recent years becker et al 2019 dembélé et al 2020 li et al 2009 stisen et al 2011 wambura et al 2017 because of its potential to reduce the equifinalities and uncertainties inherent to hydrologic models especially in data scarce regions and ungauged basins immerzeel and droogers 2008 jiang et al 2020 lópez lópez et al 2017 rajib et al 2018 rientjes et al 2013 stisen et al 2018 tobin and bennett 2017 wambura et al 2018 willem vervoort et al 2014 previous studies anyah et al 2008 ferguson and maxwell 2010 jiang et al 2009 lo and famiglietti 2010 have highlighted that the interactions between et and the subsurface depend on the depth of the water table and the et conditions water or energy limited conditions however these studies did not rely on a global sensitivity analysis gsa hence they did not investigate the impacts of the hydrodynamic parameters i e saturated hydraulic conductivity porosity specific storage manning coefficient etc on et gsa allows determining the influence of input parameters on model outputs and requires multiple simulations of the model although gsa is very important to integrated hydrologic models because of their numerous parameters and nonlinearities wainwright et al 2014 homma and saltelli 1996 pianosi and wagener 2015 razavi and gupta 2015 sarrazin et al 2016 song et al 2015 it is not widely applied to these models due to their high computational demand miller et al 2018 among the few existing gsa applications on integrated hydrologic models jefferson et al 2015 use the active subspaces approach constantine and diaz 2017 to assess the impacts of vegetative parameter uncertainties in parflow clm maxwell and miller 2005 ryken et al 2020 use the same methodology to identify the most important parameters to snow dynamics gatel et al 2020 utilize a gsa based on sobol indices sobol 1993 to study the exchange between surface and subsurface processes ghasemizade et al 2017 use hydrogeosphere brunner and simmons 2012 and sobol indices to discuss the differences between sensitivity and identifiability of hydrodynamic parameters using et water content and seepage srivastava et al 2014 perform gsa based on morris indices morris 1991 to study the impacts of vegetative and hydrodynamic parameters in parflow clm recently maina and siirila woodburn 2020 study the impacts of subsurface properties on et with sobol indices applied to the integrated hydrologic model parflow clm maxwell and miller 2005 while this study elucidates the connectivity between the subsurface and et it is based on a semi synthetic small and homogeneous domain in this work we study the impacts of hydrodynamic parameter uncertainties on et in a mountainous watershed the east river located in the upper basin of the colorado river hubbard et al 2018 the watershed is characterized by a significant topographic gradient and a highly heterogeneous land cover with coniferous and aspen forests bare soil and grasses overlying a complex geological formation because previous studies have shown that hydrodynamic parameters are more uncertain and important than the vegetative parameters srivastava et al 2014 we only focus on the hydrodynamic parameters in this study we use the integrated hydrologic model parflow clm maxwell and miller 2005 however the conclusions drawn from this work will provide useful information for other integrated hydrologic models e g hydrogeosphere as they use similar equations we use sobol indices computed with a surrogate model based on a polynomial chaos expansion sudret 2008 wiener 1938 we compare et sensitivities to the sensitivities of surface and subsurface hydrologic processes i e river stages saturation and pressure head to evaluate the potential of et in hydrodynamic parameters estimation we aim to investigate how 1 the incomplete knowledge i e uncertainties of the hydrodynamic parameters alter the estimation of et in real world setting and in both water and energy limited conditions and 2 the land surface processes information could help to determine subsurface parameters 2 study area east river watershed located in the upper colorado basin the east river watershed fig 1 covers an area of approximately 255 km2 the river is one of the two major tributaries that form the gunnison river which in turn accounts for just under half of the colorado river s discharge at the colorado utah border the watershed elevation varies from approximately 2700 to 3900 m the area has a continental subarctic climate with long cold winters and short warm summers the average precipitation in the watershed is 1200 mm year and the average temperature is 0 degreesc daly et al 2008 because of its very low winter temperature most of the winter precipitation falls as snow which will later melt in late spring and summer due to the hot temperatures to contribute along with the summer monsoons to groundwater recharge as well as river discharge watershed vegetation includes grasses conifers mixed conifers aspens and meadows and lies on a complex geologic terrain which is comprised of a diverse collection of paleozoic and mesozoic sedimentary and unconsolidated rocks the east river watershed provides a unique opportunity to study the interactions between et and the hydrodynamics in a complex topographic geologic and land cover setting besides east river s physical characteristics and climate variability allow studying the impacts of hydrodynamic parameters on et under both water and energy limited conditions we focus in this study on the lower part of the watershed encompassing its outlet as shown in fig 1 this smaller domain called the lower triangle captures the important heterogeneities of the watershed including steep changes in topography geology and vegetation while at a smaller scale thus maintaining computationally feasibility in addition this domain it is subject to several instrumentations and monitoring in the east river 3 modeling framework we describe in this section the integrated hydrologic model parflow clm maxwell and miller 2005 and the global sensitivity analysis based on the chaos polynomial expansion 3 1 integrated hydrologic model parflow clm the three dimensional mixed form of the richards equation richards 1931 is used in parflow to describe the flow in variably saturated media eq 1 1 s s s w ψ p ψ p t ϕ s w ψ p t k x k r ψ p ψ p z q s where is s s the specific storage l 1 s w ψ p is the degree of saturation associated with the subsurface pressure head ψ p l t is the time t ϕ is the porosity k r is the relative permeability z is the depth q s is the source sink term t 1 that accounts for infiltration and evapotranspiration and k x is the saturated hydraulic conductivity l t 1 which is assumed to be a diagonal tensor with entries given as k x x k y x and k z x we assumed in this study that the domain is isotropic and the tensor is equal to 1 for all the three directions in the unsaturated zone both s w and k r depend on ψ these relations are described by the van genuchten model van genuchten 1980 given by 2 s w ψ p 1 α ψ p η m g ψ p 0 1 0 ψ p 0 3 k r s w ψ p 1 2 1 1 s w ψ p 1 m g mg 2 ψ p 0 1 0 ψ p 0 where α and η are the van genuchten parameters and mg 1 1 η overland flow is solved by the kinematic wave equation in two dimensions 4 k x k r ψ 0 ψ 0 z ψ 0 0 t υ ψ 0 0 q r x where ψ 0 is the ponding depth ψ 0 0 indicates the greater term between ψ 0 the pressure head at the top layer and 0 υ is the depth averaged velocity vector of surface runoff l t 1 q r is a source sink term representing rainfall and evaporative fluxes l t 1 surface water velocity at the surface in x and y directions υ x and υ y respectively is computed using the following set of equations 5 υ x s f x m ψ 0 2 3 a n d υ y s f y m ψ 0 2 3 where s f x and s f y friction slopes along x and y respectively and m is the manning coefficient parflow employs a cell centered finite difference scheme along with an implicit backward euler scheme and the newton krylow linearization method to solve these nonlinear equations the computational grid follows the terrain to mimic the slope of the domain maxwell 2013 parflow is coupled to the community land model clm dai et al 2003 to account for the interactions between the lower atmosphere and the land surface clm determines the quantity of water leaving or entering the surface and subsurface denotes q s and q r respectively in the richards and kinematic wave equations we note that evaporation e indicating the evaporation from bare soil and water bodies is only applied to the top soil layer of parflow while the transpiration t i e canopy evaporation and plant transpiration is distributed over the entire root zone defined by the user clm models the thermal processes by closing the energy balance at the land surface given by 6 r n θ l e θ h θ g θ where θ ϕ s w is the soil moisture r n is the net radiation at the land surface e lt a balance between the shortwave also called solar and longwave radiation le is the latent heat flux e lt which captures the energy required to change the phase of water to or from vapor h is the sensible heat flux e lt and g is the ground heat flux e lt the following one dimensional form of the conduction equation is used to solve the ground temperature 7 t ϕ s w ρ w c w 1 ϕ c s t λ t q t the ground heat flux at the land surface boundary is equal to 8 λ t g where ρ w is the density of water ml 3 c w and c s are respectively the specific heat capacity of the water and soil jm 1k 1 t is the temperature in the soil column k λ is the thermal hydraulic conductivity wm 1k 1 latent le and sensible heat h fluxes are computed differently for bare soil and vegetation in bare soil the le depends on a soil resistance factor and a friction velocity whereas when vegetation is present le depends on vegetative parameters such as leaf and stem area indices h from bare soil depends on the air temperature at the ground surface and an aerodynamic resistance factor whereas when vegetation is present h also accounts for the heat conductance of vegetation and its temperature the ground heat flux is linked to the longwave radiation and is determined from the closure of the energy balance described in eq 6 it therefore accounts for both le and h fluxes the calculation of the different components of the energy balance requires meteorological forcing vegetative parameters and soil moisture the soil moisture is computed by parflow using eqs 1 and 2 meteorological forcing includes precipitation temperature east to west and north to south wind speed long wave and short wave solar radiation air pressure and relative humidity vegetative parameters include maximum and minimum leaf area index stem area index aerodynamic roughness height optical properties stomatal physiology roughness length and displacement height we note that clm along with the ecosystem dynamics clm also accounts for the effects of radiation using variables such as the surface albedo and the solar zenith angle more details about the coupling between parflow and clm as well as the equations governing the snow dynamics and et can be found in the following papers maxwell and condon 2016 jefferson et al 2015 maxwell and miller 2005 ryken et al 2020 3 2 global sensitivity analysis in this paper we focus on the uncertainties associated with the following hydrodynamic parameters saturated hydraulic conductivity k specific storage s s porosity ϕ van genuchten α and η and the manning coefficient m we assumed that these parameters are identically and uniformly distributed therefore a logarithmic transformation was applied to the parameters whose ranges of variability span multiple order of magnitude such as k and s s for the sake of simplicity we assume that the spatial distributions of the parameters are known derived from soil and geological maps only that their values are uncertain we analyze the following outputs et sw river stages and subsurface pressure head we use the sobol indices sobol 1993 widely used in geosciences and derived from the analysis of variance anova archer et al 1997 saltelli et al 2010 these indices quantify the contribution of each model parameter either alone or in interactions with other parameters to the variance of the model output the variance of any model output which belongs to the space of square integrable functions and depends on a set of input parameters identically and uniformly distributed and defined in 0 1 n can be decomposed into a sum of variances given by 9 v i 1 n v i j i n v ij v 1 n where v is the total variance of the output of interest and the subscripts indicate the parameters for example v i is the variance of parameter i from this decomposition total sobol indices s i tot hereafter refereed as sobol indices that quantify the contribution of an input parameter either solely or in interaction with the other inputs based the variance of the output are derived 10 s i tot i i 1 i s v i 1 i s v accurate quantification of the sobol indices requires extensive explorations i e multiple simulations of the parameter space because parflow clm is computationally expensive we constructed a reduced order model based on a polynomial chaos expansion crestaux et al 2009 fajraoui 2014 fajraoui et al 2011 maina and guadagnini 2018 maina et al 2021 sudret 2008 that will allow us to perform multiple simulations at a reasonable computational cost in the polynomial chaos expansion like in the decomposition of variance eq 9 any square integrable function can be decomposed into a sum of orthogonally multivariate polynomial wiener 1938 given by 11 y j 0 a j ξ j x j where a is the polynomial coefficients and ξ multivariate orthogonal polynomial of legendre note that the wiener decomposition initially of an infinite order is truncated to a finite order m for computational purposes for polynomial degree p is the polynomial degree m is calculated by 12 m n p n p the truncated eq 11 is given by 13 y j 0 m a j ξ j x j ε where the residual ε is supposed to be a zero mean variable coefficients a are determined using lest squares regression method 14 14 a ζ t ζ 1 ζ t f where ζ is the matrix of coefficients of ξ j x j and f is the vector containing the model outputs we use the expansion as defined in eq 10 to construct the surrogate model with a polynomial degree p equal to 4 and the number of parameters n is equal to 13 we provided a schematic representation of the different steps we followed to compute the sobol indices using the surrogate model based on the polynomial chaos expansion in appendix a1 more details about the construction of the surrogate model could be found in sudret 2008 4 numerical experiments 4 1 integrated hydrologic model model discretization the spatial extent of the domain is 6 3 km by 6 6 km in the x and y horizontal directions respectively with a thickness equals to 30 m the spatial resolution of the model is 100 m and 5 layers constitute the model in the vertical direction with varying thickness from 0 1 m at the land surface to 21 m at the bottom of the domain as in the previous studies foster et al 2020 foster and maxwell 2019 we opt for this vertical discretization to reduce uncertainties in the computation of fluxes in the unsaturated zone we run the model in parallel using 32 cores on nersc s cori supercomputer land surface parameterization the land cover is derived from the neon dataset neon dataset 2020 which is originally at 1 m resolution then upscaled to the resolution of our model we distinguish 4 types of land cover forests i e conifers and aspens mixed forests grasses and bare soil the latter represents the outcropping of the bedrock in high elevations areas neon dataset 2020 their vegetative properties are derived from the igbp database subsurface parameterization the subsurface is heterogeneous in both vertical and horizontal directions foster and maxwell 2019 the top 1 m corresponds to three soil layers as defined by the ssurgo database and then corrected based on the land cover and geologic maps to include the outcropping of the bedrock we distinguish two types of soil sandy loam and clay loam the geology of the subsurface comprised between 1 m and 8 m below the ground was defined with the usgs maps this zone is highly heterogeneous with different formations such as crystalline sedimentary rocks unconsolidated rocks alluvial deposits and debris flow the bottom layer of the domain extending 8 m below the ground surface to the bottom of the model is assumed homogeneous and represents the fractured bedrock boundary conditions dirichlet i e imposed pressure heads boundary conditions are set at the northern limit of the study area time varying daily pressure heads are derived from a simulation of a larger east river watershed model i e the region in fig 1b to account for the transient flow conditions neumann i e no flow boundary conditions are imposed at the three other limits and the bottom of the domain initial conditions we simulated the water year 2015 a relatively average water year based on precipitation and temperature patterns initial conditions for pressure head were obtained from a spin up using the forcing of 2015 and the median value for each parameter i e the median of the range of uncertainties listed in table 1 we recursively simulated the water year until the differences of storage at the end of the water year were less than 1 indicating convergence meteorological forcing prism datasets daly et al 2008 were used for precipitation and temperature because of their accuracy and high spatial resolution 800 m however the temporal resolution of prism is daily fig 2 which hampers the ability of this dataset to reproduce diurnal cycles an important factor when studying et the phase 2 of the north america land data assimilation system nldas 2 forcing cosgrove et al 2003 provides hourly changes in precipitation and temperature yet are only available at coarser resolutions 1 8 degree which limits the accuracy in reproducing snow dynamics and discharge as such we convert prism daily data to hourly using the nldas 2 forcing temporal resolution we employ a mass conservative temporal interpolation which disaggregates the total daily prism precipitation and temperature into hourly for the other forcing variables i e short and long wave radiation wind speed atmospheric pressure and specific humidity we use native nldas 2 forcing cosgrove et al 2003 without applying downscaling approaches model validation we compare in appendix a2 simulated and observed river stages and snow water equivalent swe we use the results from the large east river watershed model foster and maxwell 2019 for comparisons because of the lack of measurements especially swe in our area of interest 4 2 global sensitivity analysis the selected ranges of uncertainty of the parameters shown in table 1 are meant to represent geologic formations varying from coarse and high permeable to fine and low permeable materials saturated hydraulic conductivity porosity and the manning coefficient are assumed to be heterogeneous while the specific storage ss and van genuchten α and η are spatially homogenous because their estimation is difficult and previous calibration were successful by considering them homogeneous the model has five saturated hydraulic conductivities two associated with the soil layers k1 and k2 for sandy loam and clay loam respectively two for the subsurface between 1 and 8 m k3 and k4 for sedimentary and unconsolidated rocks and one in fractured bedrock i e bottom layer which is assumed to be homogeneous k5 we note that the majority of forests lie on k3 while the grasses sit on k4 the porosity is heterogeneous in the soil layers sandy loam ϕ1 and clay loam ϕ2 and homogeneous in the subsurface layers below 1 m ϕ3 we define two manning coefficients one for the forests and the other one for grasses we perform 700 simulations to construct the surrogate model a single simulation requires approximately 2 to 3 h of wall clock time to complete we sample the hydrodynamic parameters for each simulation using the quasi monte carlo sampling technique a method with reliable convergence properties b feil 2009 braaten and weller 1979 caflisch 1998 that allows a good exploration of the parameter space the surrogate model based on a polynomial chaos expansion of order 4 was then used to generate 3000 additional simulations the accuracy of the reduced order model has been assessed by several cross validations which consist of comparing the surrogate model output with the full model response the rmses not shown here are of the order of 10 7 0 01 and 0 1 for et saturation and pressure head respectively sobol indices were then computed with the 3700 simulations obtained with both the full and surrogate models previous studies have shown that because sobol indices only describe the impact of the uncertainties of the input variables on the variance of the output they could provide an incomplete picture of the impact of model parameters on its output therefore it is important to not only study the variance of the output but also the other characteristics of the output s probability density function such as the mean and the skewness dell oca et al 2017 to address this limitation of the sobol indices we computed the amae indices which quantify the contribution of each parameter to the mean of the model output dell oca et al 2017 our results not shown here for brevity have indicated that the amae indices provide similar information as the sobol indices for this particular test case 5 results we study in both space and time the following model outputs et and its components e and t river stages ψs soil saturation sw at the first 2 m and subsurface pressure head ψb we investigate sw ψs and ψb to compare the sensitivities of et to these variables commonly measured in hydrological observatories we study the spatiotemporal distributions of the mean μ the coefficient of variation cv σ μ where σ is the standard deviation and the sobol total indices 5 1 evapotranspiration at the catchment scale fig 3 shows monthly variations of the mean values μ of et e and t and their sobol indices as expected μ of et is high in summer due to the availability of water originating snow ablation and monsoon to meet the high et demand of the hot summer this period has also the highest et uncertainties as indicated by the gray lines representing all the computed et in fig 3a changes in et are mainly controlled by k1 and the van genuchten α and η as indicated by the sobol indices in fig 3b we also observe similar behavior with e fig 3c and d and t fig 3e and f the sensitivity of e to the hydrodynamic parameters is similar to the one associated with et but t shows a slightly different response with high sensitivity to the van genuchten η these results highlight that et at the watershed scale is mostly sensitive to the parameters describing flow in the soil k1 and the van genuchten α and η fig 3b 5 2 spatial distributions of the sensitivity indices because et μ and cv are high in summer we study the spatial patterns in july fig 4 shows the histograms of the μ and the cv of et e t sw and ψb of all cells of the discretized integrated hydrologic model we classified the cells according to their land cover bare soil forests mixed forests and grasses forests and mixed forests have the highest mean μ values of et on contrary to grasses and bare soil fig 4a the distribution of the mean μ values of t is very similar to mean μ values of et fig 4e whereas we observe a different pattern for the mean μ values of e which are high in bare soil fig 4c the cv values of et fig 4b are high in forests because they are under water limited conditions as such et strongly depends on groundwater dynamics and therefore the hydrodynamic parameters et under grasses and bare soil on the other hand is more energy limited than water limited as a result the cv values of et are low because et mainly depends on the atmospheric conditions the spatial distributions of μ and cv of the selected outputs are shown in fig 5 a and b the high mean μ values of et observed under forests lead to a deeper water table low mean μ values of ψb and low mean μ values of sw fig 5a the cv values of ψb and sw are low compared to the cv values of et fig 5b indicating the strong impact of hydrodynamic parameters on et compared to the unsaturated and saturated flows i e ψb and sw the cv values of ψs is also lower than the cv values of et fig 5b especially in the branch of the east river because the variations of ψs are mainly controlled by the snowmelt which depends more on the climatic conditions than the hydrodynamic parameters fig 5c depicts the spatial distribution of the sobol indices for the sake of simplicity we will discuss these indices separately for each output in the next sections evapotranspiration et in section 5 2 1 river stages ψs and saturation sw in section 5 2 1 and subsurface pressure head ψb in section 5 2 1 5 2 1 evapotranspiration et the spatial distributions of the sobol indices associated with et are shown in fig 5c saturated hydraulic conductivities k1 is influential everywhere in the domain with the exception of the northwest corresponding to the outcropping of the bedrock i e bare soil the sobol indices of k3 are only significant under grasses whereas the indices of k4 and k5 are negligible van genuchten parameters the sobol indices of α and η show opposite trends areas with high et forests under water limited conditions are very sensitive to η because to meet these high demands water has to be taken from the pores and this depends on the distribution of the pore size i e η while areas with low et grasses mostly depend on α because the available water which depends on α is sufficient to meet the et demand porosity and specific storage mostly control et in areas with high values of sw because in these zones the amount of available water to meet the et demand only depends on their values manning coefficient this parameter only influences et in the river 5 2 2 surface and soil hydrodynamics river stages ψs and saturation sw the manning coefficient is the most influential parameter to ψs all the saturated hydraulic conductivities except k5 contribute to the changes in sw k1 is influential to sw in the vicinity of the river while k3 and k4 are influential to sw in areas subject to low et i e grasses the spatial distributions of the sobol indices of the van genuchten α and η associated with sw are similar to the ones associated with et because of the strong connection between sw i e water availability and et 5 2 3 subsurface pressure head ψb the sobol indices of k3 and k4 associated with ψb are mainly noticeable in low et areas while in areas with high et characterized by a deep water table ψb is sensitive to the van genuchten α and k5 the manning coefficient influences ψb in the vicinity of the river due to the river groundwater exchange 5 3 temporal variations of the sobol indices because the sobol indices depend on the land cover as shown in the previous sections we discuss the temporal patterns by land cover type we illustrate in fig 6 the monthly variations of swe infiltration et ψs sw and ψb at three selected points forests point a grasses point b and mixed forests point c see their location in fig 1c fig 7 depicts the box plots of the sobol indices of monthly averaged values of the hourly simulated et and sobol indices of daily averaged values of the hourly simulated sw and ψb at the three selected points 5 3 1 forests in forests the snow peak is low because of their canopy intercepting most of the snowfall and the snow ablation and infiltration start early with low rates fig 6 the 3700 simulations have similar snow accumulation however the durations of snow ablation are slightly different due to the uncertainties in k1 affecting the soil thermodynamics and governing its ability to infiltrate water as a result the infiltration timing and magnitudes are also different forests have the highest et fluxes as such they have a thick unsaturated zone as indicated by their low sw values fig 6d and their deep water table fig 6e forests et is highly sensitive to the van genuchten η in addition to k1 k3 and the van genuchten α fig 7a the sensitivity of et to these parameters is high in summer because et is water limited forests sw are sensitive to k3 k5 and the van genuchten α and η fig 7b during baseflow sw is sensitive to the van genuchten α and η whereas k3 and k5 are the most important parameters to sw during peak flow not shown here for brevity the low recharge of forests is due to their thick unsaturated zone as a consequence forests ψb has low seasonal changes fig 6e and is sensitive to the van genuchten α and k5 fig 7c 5 3 2 grasses grasses are characterized by high peak snow late snow ablation high infiltration and low et fig 6a c due to their low transpiration and root uptake grasses sw is close to 1 during peak flow and it decreases by 50 in baseflow fig 6d similarly their water table depth is shallow and experiences a strong decrease up to 5 m during baseflow conditions fig 6e grasses et and sw are highly sensitive to k1 k4 and the van genuchten α fig 7d and e grasses ψb is mainly sensitive to k1 and k4 fig 7c 5 3 3 mixed forests results of mixed forests show that et values are in between the et of forests and grasses hence their sensitivities include both the hydrodynamic controlling et in forests and grasses fig 7g i 5 4 interactions between land cover topography and water table depth fig 8 depicts the annual averages of the sobol indices of the van genuchten η k1 and the sum of the 5 saturated hydraulic conductivities associated with et as a function of the water table depth the dots represent the cells of the discretized integrated hydrologic model which are colored according to their type of land cover dark green for forests green for mixed forests and dark yellow for grasses the relationship between the sensitivity of et to the van genuchten η and the water table depth is nonlinear fig 8a this is in agreement with the results of lo and famiglietti 2010 who show that the feedback between groundwater and land surface processes follows a nonlinear relationship for cells with a deep water table forest cells in dark green the sensitivity to the van genuchten η is high the latter decreases in a nonlinear way as the water table depth decreases corresponding to the grassland areas in dark yellow we note a similar but inverse relationship between the sensitivity of et to the saturated hydraulic conductivities fig 8b and c and the water table depth the two extremities of the curves remain the same grasses and forests while the mixed forests are in between even if in general forests and grasses are characterized by distinct hydrologic processes and control parameters the latter change from one point to another in the same land cover type depending on the water table depth the combination of the water table depth whose changes are controlled by the topography and the land cover highlights that the processes aren t disconnected and specific for each type of land cover but change gradually with respect to the water table depth the topography and the land cover hence a forest cell with a shallow water table depth will likely behave as a grassland cell with a deep water table 6 discussions 6 1 comparisons with previous studies our results show that forests on contrary to grasses are characterized by a deep water table and their high et is sensitive to the unsaturated zone parameters these findings are in agreement with the work of srivastava et al 2014 soylu et al 2011 and maina and siirila woodburn 2020 furthermore maina and siirila woodburn 2020 highlight that the van genuchten η affects et in forests as in this work although the water table is deep under forests et is high because the deeper root zone allows the vegetation to maintain t which is consistent with the results of rihani et al 2010 and trevisan et al 2020 our results as the previous studies also indicate that groundwater influences more the variability of the land surface processes under water limited conditions high et areas than under energy limited conditions where land surface processes mostly depend on the atmospheric forcing rahman et al 2014 moreover the authors point out that the dependence of et on water table depth is more pronounced in summer than winter as shown in our results 6 2 hydrodynamic parameters estimation our results illustrate that the hydrodynamic parameter uncertainties lead to up to 20 uncertainties in et at the basin scale and up to 50 at a point scale these et uncertainties are at the same order of magnitude and even greater than the reported remote sensing uncertainties which vary from 15 to 50 depending on the scale of time and space and the physical characteristics of the basin mu et al 2011 nagler et al 2005 velpuri et al 2013 therefore our results emphasize that remote sensing products could be used to estimate hydrodynamic parameters besides the cv of et is higher than that of the measured hydrologic variables ψs sw and ψb also et could contain information about the soil saturated hydraulic conductivity and van genuchten α and η which are difficult to measure although current remotely sensed et are embedded with high uncertainties these uncertainties will likely decrease in the near future strengthening their potential for parameter estimation however as discussed by ghasemizade et al 2017 sobol indices are not suitable for conclusions about the identifiability of the parameters a rigorous parameter identifiability study could be performed in the future by applying gsa on objective function or employing the mutual information theory framework to determine the amount of information about the hydrodynamic parameters contained in remotely sensed et 6 3 the importance of hydrodynamic parameters on the feedback between the atmosphere and the subsurface because hydrodynamic parameters have strong impacts on et they also affect the surface energy fluxes interestingly the most important parameters i e van genuchten η to et are not relevant to subsurface hydrology ψb and ψs although the importance of accounting for the two way interactions between the land surface and subsurface is widely discussed in the literature clark et al 2015 condon et al 2013 ferguson and maxwell 2010 keune et al 2016 maxwell et al 2007 maxwell and condon 2016 current models often neglect these interconnections especially a detailed representation of the physical characteristics of the subsurface while supporting previous findings our study highlights that a better estimation of the hydrodynamic parameters is necessary to improve the estimation of energy fluxes at the land surface 6 4 study limitations we acknowledge that although the model we employ in this study has the advantage of physically representing the processes governing the hydrodynamics it is embedded with irreducible uncertainties from many sources including the assumptions made in the physical representation of both hydrodynamic processes and land surface processes such as transpiration mechanisms and the numerical resolution of the equations governing these processes future studies will focus further assess and compare the impacts of these different sources of uncertainties in addition to the parametric uncertainties on model outputs 7 summary and conclusions in this work we assessed the impacts of hydrodynamic parameter uncertainties saturated hydraulic conductivities porosities specific storage van genuchten parameters and manning coefficients on simulated et we do so by using the integrated hydrologic model parflow clm and sobol indices we studied the lower portion of the east river watershed a complex system characterized by high topographic gradients and heterogeneous land cover and geology our results highlight that hydrodynamic parameter uncertainties lead to up to 20 at the basin scale and up to 50 at a point scale et uncertainties the sensitivity of et to hydrodynamic parameters depends on the land cover fig 9 shows a summary of land surface processes and hydrodynamics as well as their influential parameters associated with three types of land cover in forests i e water limited conditions the et is high as a result the unsaturated zone is thick and the water table is deep et is highly sensitive to the unsaturated zone parameters the van genuchten η due to the disconnection between the saturated zone hydrodynamics and the land surface processes grasses i e to energy limited conditions have low et highly sensitive to the subsurface saturated hydraulic conductivity because the water table is shallow however due to the complexities of the system these influential parameters are not specific for each land cover type and depend on the water table depth in a nonlinear way because et is very sensitive to hydrodynamic parameters with coefficients of variation greater than those associated with the river stages water table depth and saturation et could contain valuable information about hydrodynamic parameters and could improve their estimation a better characterization of the physical properties of the subsurface is essential to accurately quantify et credit authorship contribution statement fadji z maina conceptualization formal analysis methodology software writing original draft writing review editing erica r siirila woodburn conceptualization formal analysis methodology software writing original draft writing review editing peter james dennedy frank conceptualization formal analysis methodology software writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement data supporting the findings of this study can be found here maina f z 2020 assessing the interconnectivity between land surface processes and hydrodynamics in a mountainous watershed hydroshare http www hydroshare org resource 7e7e207546d94c9aab91427d49f51c98 this work was supported by the watershed function scientific focus area funded by the u s department of energy office of science office of biological and environmental research under award no de ac02 05ch11231 appendix a1 schematic representation of the computation of the sobol indices appendix a2 comparisons with measurements 
3492,the high spatiotemporal variability of rainfall in tropical regions has posed a great challenge for generating satisfactory satellite precipitation products spps most of previous studies have found a modest performance of various spps in estimating daily rainfall in tropical regions such as malaysia in depth research on effective ways to correct the bias of spps in the tropical region is urgently needed this study aims to establish a bidirectional long short term memory recurrent network bi lstm framework for the bias correction of spps and apply it to correct daily rainfall estimates of the early runs of integrated multisatellite retrievals for the global precipitation measurement imerg e from 2010 to 2016 in the kelantan river basin malaysia after optimization and statistical comparison bi lstm with the covariates of daily maximum and minimum temperature bi lstm t was determined to be the best model for bias correction annually bi lstm t could raise the correlation coefficient cc of imerg e by 26 7 while reducing its root mean square error rmse and mean absolute error mae by 23 9 and 21 7 in the kelantan river basin in the four seasons it increased the cc of imerg e by 19 7 27 5 while decreasing its rmse and mae by 18 4 30 0 and 20 9 23 2 multiple statistical tests confirmed that bi lstm t significantly outperformed two benchmark methods namely ratio bias correction rbc and cumulative distribution function cdf matching in correcting the bias of imerg e for all four seasons this suggests that the bi lstm t model may work as a promising framework of great potentials for correcting the bias of spps in tropical regions where adequate precipitation data are in great need for diverse purposes such as water related disaster prevention and mitigation keywords satellite precipitation product bias correction deep neural network ratio bias correction cumulative distribution function statistical evaluation 1 introduction the spatiotemporal variability of precipitation strongly conditions water availability to diverse human society needs as well as the maintenance of vital ecosystem functions reliable precipitation data are essential to the sustainable management of water resources as well as monitoring and predicting the risk of various water related hazards including drought and flood sadeghi et al 2019 yuan et al 2017 under the context of global climate change and the increasing likelihood of extreme event occurrences ipcc 2021 obtaining precipitation data of adequate spatial and temporal resolution in a timely manner is critical especially to tropical regions where fast heat and water movement makes the regions more sensitive to climate change and more susceptible to the catastrophic consequences of water related hazards o gorman 2012 van beusekom et al 2016 traditionally precipitation measurements by ground based rain gauges have served as the primary source of rainfall data around the world kidd et al 2017 tan et al 2021 although considered as the most reliable method for rainfall estimation rain gauges could only provide point measurements whose spatial distribution is often limited due to various reasons such as high altitude complex terrain inaccessible areas and limited financial resources kim et al 2017 pomeon et al 2017 prakash 2019 zhang et al 2019 satellite precipitation products spps are capable of providing rainfall estimates at a relatively fine spatiotemporal resolution with a quasi global coverage which makes them increasingly popular especially in regions with sparse rainfall data skofronick jackson et al 2018 currently a number of spps are operationally available and free to the public such as cmorph climate prediction center morphing technique product joyce et al 2004 trmm tropical rainfall measuring mission tmpa multi satellite precipitation analysis products huffman et al 2007 and imerg integrated multisatellite retrievals for the global precipitation measurement skofronick jackson et al 2018 however satellite precipitation products are likely to contain both systematic and random errors such as those related to satellite sensors spatial and temporal sampling and retrieval algorithms aghakouchak et al 2012 gumindoga et al 2019 habib et al 2014 many studies have assessed the performance of spps in regions with diverse topographic and climatic conditions as well as different ground rainfall data availability hamza et al 2020 hosseini moghari and tang 2020 palomino angel et al 2019 tang et al 2020 vallejo bernal et al 2021 yu et al 2020 zhu et al 2020 in tropical regions the high variability in the spatiotemporal distribution of rainfall has posed a great challenge for generating satisfactory rainfall estimates through satellite remote sensing for example previous studies evaluating various spps in malaysia have mostly concluded a modest performance in daily rainfall estimation in the country tan et al 2015 evaluated the performance of six spps across malaysia between 2014 and 2016 and concluded that the ccs of daily spps ranged from 0 43 of persiann precipitation estimation from remotely sensed information using artificial neural networks to 0 60 of imerg f resampled to 0 25 similarly in their assessment of three imerg products in the kelantan river basin between 2014 and 2016 tan et al 2018 found that imerg l had the highest daily cc of 0 63 in view of their inadequate performance there is an urgent need for research on effective ways for correcting the bias of daily spps to enhance their utility for hydrometeorological applications in tropical regions in previous studies a variety of methods have been tested for reducing the bias of spps including power transformation mastrantonas et al 2019 soo et al 2020 ratio bias correction bhatti et al 2016 gumindoga et al 2019 habib et al 2014 mastrantonas et al 2019 cumulative distribution function cdf matching gumindoga et al 2019 katiraie boroujerdy et al 2020 mastrantonas et al 2019 and regression analysis chen et al 2018 chen et al 2020 yeh et al 2020 neural network is a computational model designed by imitating the functioning of human brain nervous system over the past two decades it has gained much popularity in a variety of fields such as medicine finance image processing and environmental sciences chen et al 2018 hong et al 2004 hsu et al 1997 maier et al 2010 schmidhuber 2015 zhi et al 2021 recent fast development in deep neural networks characterized by their flexibility and capacity to deal with huge and complex datasets allows to better exploit spatial and temporal structures of multiple data sources to generate more accurate precipitation estimates asanjan et al 2018 miao et al 2019 pan et al 2019 tao et al 2017 tao et al 2018 and sadeghi et al 2019 respectively proposed persiann sdae stacked denoising autoencoders model and persiann cnn convolutional neural network model to utilize infrared and water vapor channels of goes geostationary operational environmental satellites to make classifications between rain and no rain events as well as estimate precipitation amount both of them tested their models in the united states and concluded that their models outperformed the operational satellite precipitation product persiann ccs precipitation estimation from remotely sensed information using artificial neural networks cloud classification system sadeghi et al 2019 tao et al 2018 in addition hayatbini et al 2019 used the conditional generative neural networks to extract useful features from goes 16 for estimating precipitation over the continental united states based on fengyun 2 satellite data xue et al 2021 used cnn to estimate precipitation over the arid xinjiang province in northwestern china up to date very few studies have attempted to use deep neural networks to correct the bias of spps wu et al 2020 to the best of our knowledge deep neural networks have yet been utilized for correcting the bias of spps in tropical regions such as malaysia meanwhile in spite of the substantial seasonal rainfall variations in many regions around the world previous studies have rarely investigated potential seasonal differences in the bias correction performance furthermore most studies have largely resorted to simple mean metric values to assess the differences among various bias correction methods however this simple averaging approach fails to assess the significance of the difference in their bias correction performance to fill in these gaps this paper aims to establish a deep neural network framework for correcting the bias of spps and apply it to correct the daily imerg e products in the kelantan river basin of malaysia over a period of seven years from 2010 to 2016 statistical tests are conducted to systematically compare the bias correction performance of different neural network architectures so as to identify the optimal configuration in addition deep neural network is statistically compared with two benchmark bias correction methods ratio bias correction and cdf matching in their bias correction performance both annually and seasonally 2 materials and methods 2 1 study region with a drainage area of 12 134 km2 the kelantan river basin 4 40 6 12 n 101 20 102 20 e is located in northeastern peninsular malaysia fig 1 as the major river in the basin the 248 km long kelantan river originates from the western tahan and titiwangsa mountain ranges and flows north and northeastward till its eventually discharging into the south china sea as a typical tropical river basin the kelantan river basin is hot and humid throughout the year with an annual average temperature of 27 5 c and total precipitation of 2500 mm year under the heavy influence of monsoons the basin exhibits distinct seasonal alternations between wet and dry periods heavy precipitation usually occurs during the northeast monsoon nem season that spans from november to the following january in contrast relatively less precipitation occurs in the southwest monsoon swm season from may to august during the two inter monsoon seasons february to april and september to october due to intense surface heating and sea breeze circulation tan and santo 2018 historically the kelantan river basin has been frequently hit by both flood and drought causing severe damages to local economy and daily livelihoods and in some cases even loss of life mansor et al 2018 tan et al 2017a 2017b 2 2 data sources 2 2 1 satellite precipitation estimates over the last two decades a number of satellite precipitation products spps with different spatiotemporal resolutions have been released with the aim to produce more accurate satellite precipitation estimates at finer spatiotemporal resolutions nasa national aeronautics and space administration and jaxa japan aerospace exploration agency jointly launched the gpm global precipitation measurement mission in 2014 the gpm mission consists of an international collection of low earth orbiting satellites which carry both dual frequency precipitation radar and conical scanning multichannel gpm microwave imager for better rainfall detection the imerg integrated multisatellite retrievals for global precipitation measurement algorithm is used to generate rainfall estimates worldwide at fine spatial and temporal resolution through inter calibrating interpolating and merging all available satellite microwave precipitation estimates ground gauge measurements and other potential precipitation estimates there are three types of imerg products with different latencies the near real time early imerg e and late imerg l runs and the post real time final run imerg f imerg e and imerg l products are usually released in around 4 and 14 h after the event whereas imerg f in about 4 months after going through adjustment against monthly ground rainfall records and other potentially available precipitation estimates because of its short latency the near real time imerg e products are especially useful for timely prediction of water related disasters and formulation of effective mitigation strategies therefore this study focuses on correcting the bias of daily rainfall estimates of imerg e the 30 min imerg v6 products with a spatial resolution of 0 1 were downloaded from the nasa website https disc gsfc nasa gov and aggregated to the daily level 2 2 2 ground rainfall records historical daily precipitation records from 2010 to 2016 in the kelantan river basin were obtained from the department of irrigation and drainage did of malaysia and the malaysia meteorological department mmd all daily precipitation measurements have been consistently taken at 00 00 utc time each day a total of 26 rain gauges which have less than 10 missing values were used in our study their missing values were estimated based on the amount of rainfall at the nearest stations fig 1 2 3 bias correction methods 2 3 1 deep neural network method the most classic neural network architecture is mlp multilayer perceptron which consists of input hidden and output layers in mlp neurons in the input layer pass on the weighted inputs to those in the hidden layer where the possible usage of nonlinear activation functions could help capture the complexity and non linearity of the modelled system maier et al 2010 however mlp is not suitable for dealing with sequential information because it generates output solely based on the current input data unlike mlp the recurrent neural network rnn architecture contains cyclic connection which allows it to update its state based on current input data as well as previous states up to date rnn has been widely used in fields that require to process massive sequential data such as text audio and video yu et al 2019 when it comes to use rnn for processing massive daily rainfall series two issues need to be solved firstly as the time interval between the related inputs grows it is hard for the standard rnn to learn their connection information yu et al 2019 this so called long term dependency problem of rnn reduces its ability to process long term input series to solve the problem hochreiter and schmidhuber 1997 proposed the long short term memory lstm cell which improved the remembering capacity of the standard recurrent cell through a gate mechanism the lstm utilizes different gates such as input forget and output gates to determine what information are retained or thrown away from the cell state as shown in eqs 1 6 1 f t σ w f h t 1 x t b f 2 i t σ w i h t 1 x t b i 3 o t σ w o h t 1 x t b o 4 c t t a n h w c h t 1 x t b c 5 c t f t c t 1 i t c t 6 h t o t t a n h c t where f t i t o t respectively represents the forget input and output gate c t is the cell state c t is a potential vector of cell state h is a hidden vector w is the weight matrix b is the bias term a b represents the concatenation of two vectors tanh is the hyperbolic tangent represents the element wise multiplication secondly at any time t the standard rnn could only learn from the previous inputs thus missing all valuable information contained in the input series afterwards schuster and paliwal 1997 proposed the bidirectional recurrent neural network brnn to mitigate this problem of information loss by superposing two rnns with opposite training sequences and separate hidden layers at certain time t the output of brnn is jointly determined by these two rnns so that inputs both backward and forward in time are used to generate outputs brnn and the lstm cell were combined to form the bidirectional lstm bi lstm to correct the bias of daily imerg e products in the kelantan river basin besides daily satellite precipitation estimates covariates may be included in the input layer of the bi lstm as ziarh et al 2021 found significant correlation between annual mean rainfall and surface elevation and distance to coast in malaysia both variables were tested as potential covariates in the bi lstm surface elevation of the rainfall gauges was estimated based on the shuttle radar topography mission srtm dem whereas their distance to coast was calculated as the euclidean distance to the closest coastline in addition as a tropical country temperature changes little throughout the year in malaysia rainfall events could play a relatively important role in its daily temperature fluctuations in view of this feature we included daily maximum and daily minimum temperature as the potential covariates in the bi lstm temperature data at the kuala krai station 102 2 e 5 53 n were used and assumed to be the same throughout the basin fig 2 illustrated the proposed deep neural network framework for correcting the bias of spps 2 3 2 ratio bias correction rbc ratio bias correction rbc is one of the mostly widely used methods for correcting the bias of the spps due to its simplicity it usually involves four steps 1 determine the size and type of temporal window for calculating the correction ratios 2 calculate the ratio between cumulative ground rainfall measurement and cumulative satellite rainfall estimate within the window at each gauge location 3 spatially interpolate the ratios at all gauge locations to create a grid and 4 multiply the original spp with the grid of correction ratios to produce the ratio bias corrected spp steps 2 to 4 are repeated for each succeeding temporal window till the end of the bias correction period mastrantonas et al 2019 up to date different sizes and types of temporal windows have been used for generating the subsets to calculate the correction ratios bhatti et al 2016 habib et al 2014 for example bhatti et al 2016 examined the performance of rbc using both moving windows mw and sequential windows sw whose sizes range from 1 to 31 days they concluded that the 7 day sw was the best temporal window for correcting the bias of cmorph estimates in the gilgel abbey catchment ethiopia similar to bhatti et al 2016 this study compared the performance of rbc among various sizes of mw and sw 3 to 31 days in the kelantan river basin in generating a new subset the mw approach shifts the window one time step forward while the sw approach shifts forward by the window size in the sw approach a single bias factor is estimated for all days falling within each window in the mw approach however the bias factor could be calculated with different schemes such as fw bw and cw for instance under a window size of 5 days fw scheme calculates the bias correction factor based on spp estimates and ground rainfall observations of the current day and the following 4 days bw calculates the factor based on those of the current day and the previous 4 days whereas cw calculates the factor based on those of the current day as well as the previous and following 2 days in the following are the equations for calculating the correction ratio at day d under the fw eq 7 bw eq 8 and cw eq 9 scheme respectively 7 rb i d t d t d l p g i t d t d l p s i 8 rb i d t d l t d p g i t d l t d p s i 9 rb i d i d m i d m p g i i d m i d m p s i where pg i and ps i respectively represents ground rainfall observation and satellite precipitation estimate on day i l is the sampling window size and m is the number of days before after day d included in the sampling window under the cw scheme which is calculated as following 10 m l 1 2 it needs to be noted that the cw scheme is only applicable to sampling windows with a size of odd number of days 2 3 3 cumulative distribution function matching method cdf the cdf matching method is another widely used method for correcting the bias of spps it makes adjustment to satellite rainfall estimates so that the cdfs of adjusted rainfall estimates and ground rainfall measurements are similar within certain temporal window in each temporal window the cdf matching method contains the following steps 1 obtain the cdf of ground rainfall observations at each gauge location and use the cdf to adjust the corresponding satellite rainfall estimates eq 11 2 calculate the difference between the original and adjusted satellite rainfall estimates at each gauge location 3 spatially interpolate the difference at all gauge locations through the inverse distance weighting idw method to create a grid 4 add the grid of difference to the original spp to produce the cdf bias corrected spp these steps need to be repeated for each succeeding temporal window till the end of the bias correction period mastrantonas et al 2019 11 p s i f g i 1 f s i p s i where f s i is the cdf of satellite rainfall estimates of the grid cell corresponding to rain gauge i f g i 1 is the inverse cdf of ground rainfall observations of rain gauge i and p s i and p s i are respectively the bias corrected and actual satellite rainfall estimates of the grid cell corresponding to rain gauge i the cdf of ground rainfall observations and satellite rainfall estimates was estimated for each month individually 2 4 comparison of bias correction performance performance of the bias correction methods was evaluated and compared through the so called cross validation process during cross validation all rainfall stations except one were utilized in each bias correction process to estimate daily rainfall at the left out rainfall station four metrics were used to evaluate the bias correction performance at the left out rainfall station including correlation coefficient cc root mean square error rmse mean absolute error mae and relative bias rb yang et al 2020 12 c c i 1 n x i o x o x i s x s i 1 n x i o x o 2 i 1 n x i s x s 2 13 r m s e i 1 n x i s x i o 2 n 14 m a e i 1 n x i o x i s n 15 r b i 1 n x i s x i o i 1 n x i o 100 where n represents the number of observed and estimated data pairs x i o and x i s represent the ith pair of observed and estimated amount x o and x s represent mean observed and estimated amount the above process was repeated to evaluate the bias correction performance of each method at all rainfall stations most of previous studies made comparison among different bias correction methods simply based on the mean metric values the simple averaging approach masks potentially large variability in metrics among the stations unlike previous studies we statistically compared the difference in metrics among various bias correction methods using the one way repeated measures anova analysis of variance and multiple posterior comparison tests including the bonferroni test scheffe test tukey test sidak test and fisher test all statistic tests were implemented in the origin 2018 statistical package 3 results and discussion 3 1 spatial variability in daily rainfall historical daily rainfall observations from 2010 to 2016 at 26 stations in the kelantan river basin were used in our bias correction study to assess the spatial variability of daily rainfall in the basin we calculated both the range and coefficient of variation cv of daily precipitation among the 26 stations for each day during the study period fig 3 compared the boxplots of the range and cv of daily rainfall among five groups of days whose mean daily rainfall fell in the interval of 50 mm n 26 days 30 50 mm n 47 days 20 30 mm n 111 days 10 20 mm n 466 days and 1 10 mm n 1243 days respectively both boxplots revealed the tremendous spatial variability in daily rainfall among the 26 stations in the kelantan river basin for example during the 26 days with mean daily rainfall above 50 mm the average range of daily rainfall was 168 mm whereas the maximum could reach 370 mm the average range of the other four groups were 109 mm 82 mm 58 mm and 31 mm whereas their maximum reached 197 mm 182 mm 127 mm and 117 mm fig 3a similarly the average cv of the two groups with heavier rainfall both surpassed 0 6 while the other three groups exceeded 1 meanwhile the maximum cv of the five groups reached 1 05 1 40 2 05 2 75 and 5 10 respectively fig 3b the revealed large spatial variability in daily rainfall distribution illustrates the utility of satellite precipitation estimates as a valuable complement to ground measurements due to its advantage of continuous spatial coverage 3 2 architecture optimization of bi lstm previous machine learning studies usually put all candidate covariates directly as model inputs baez villanueva et al 2020 xue et al 2021 ziarh et al 2021 however it is possible that not every candidate covariate is essential to the model unlike previous studies this study attempted to ultimately obtain a parsimonious bi lstm architecture by specifically examining the contribution of individual group of covariates to the bias correction performance of bi lstm four potential covariates were tested for their contributions to bi lstm namely surface elevation distance to coast daily maximum temperature tmax and daily minimum temperature tmin the four covariates were divided into three groups with group 1 containing surface elevation group 2 containing distance to coast and group 3 containing tmax and tmin besides the bi lstm with all four covariates bi lstm all we ran three additional bi lstms bi lstm e bi lstm d bi lstm t each containing only one group of the covariates hyperparameters were tuned to yield the optimal bi lstm models through minimizing the loss function on given inputs multiple experiments have indicated that the loss function composed of a weighted sum of mean square error mse and mean absolute error mae could yield the best bias correction results eq 18 16 l mse i 1 n x i s x i o 2 n 17 l mae i 1 n x i o x i s n 18 l estimation 0 8 l mse 0 2 l mae where n represents the number of observed and estimated data pairs x i o and x i s represent the ith pair of observed and estimated amount of precipitation the bi lstm was trained with the adam adaptive moment estimation optimizer kingma and ba 2014 xue et al 2021 under the tensorflow 2 2 0 and keras 2 3 1 frameworks its learning rate exponential decay rates for the first and second moment estimates and batch size were set as 0 01 0 9 0 99 and 2048 respectively meanwhile relu was used as the activation function which may help reduce computing amount avoid gradient disappearance and alleviate overfitting risk the ultimate optimized architecture of the three bi lstms containing single group of covariates was identical meanwhile their architecture was also similar to that of bi lstm all except it had fewer neurons in the bidirectional lstm and dense layers to reduce the risk of overfitting fig 4 fig 5 compared the boxplots of the four metrics across the 26 rainfall stations among the four bi lstms with different covariates for example the four boxplots in fig 5b characterized the distribution of rmses of the bi lstms that contained only elevation bi lstm e only distance to coast bi lstm d only tmax and tmin bi lstm t and all four covariates bi lstm all respectively across the 26 rainfall stations rmse of bi lstm all ranged from 8 41 to 13 80 with a mean of 10 00 compared to 9 75 15 82 with a mean of 12 20 for bi lstm e 9 67 15 50 with a mean of 12 13 for bi lstm d and 8 83 13 80 with a mean of 10 29 for bi lstm t one way repeated measures anova was respectively performed to evaluate the significance of the difference in each metric among the four bi lstms anova results indicated that all four metrics were significantly different among the four bi lstms at the significance level α of 0 05 therefore multiple posterior comparison tests were further performed to identify the pairs of bi lstms that were indeed significantly different in fig 5 solid lines were drawn between two bi lstms if posterior comparison tests concluded that they were not significantly different at the α level of 0 05 as shown in fig 5 all four metrics were significantly different between every pair of bi lstms except two pairs namely the pair between bi lstm e and bi lstm d and the pair between bi lstm all and bi lstm t this showed that tmax and tmin contributed significantly more than the other two covariates to the bias correction performance of bi lstm the much more significant contribution by tmax and tmin is rather unexpected since surface elevation has been the most widely used covariate in previous studies whereas temperature has been rarely used baez villanueva et al 2020 chao et al 2018 wu et al 2020 xue et al 2021 zhang et al 2018 one possible reason for this result is due to the unique climate conditions in tropical regions where temperature usually changes little throughout the year and consequently the cooling effect of rainfall events is more conspicuous since the bias correction performance of the bi lstm containing only tmax and tmin was comparable to that with all four covariates the parsimonious bi lstm t was determined to be the best bi lstm model for comparison with the other bias correction methods 3 3 window selection in ratio bias correction rbc we compared the performance of rbc among four types of sampling windows sw and three mws respectively with the fw bw and cw scheme with size ranging from 3 to 31 days fig 6 compared the mean rmses and ccs of the satellite precipitation estimates after being corrected with rbc using four types of windows of different size under sw bw and cw mean rmse tended to decrease initially with increasing window size followed by a leveling off with further increase in window size under fw however mean rmse increased continuously after its initial decline with increasing window size after window size surpassed 11 days cw consistently performed the best followed by bw while fw and sw performed considerably worse overall mean rmse reached the minimum of 12 55 mm under cw with a size of 13 days fig 6a in terms of cc mean cc of sw mostly remained lower than those of the three mws under the three mws mean cc mostly fluctuated between 0 61 and 0 64 with the maximum of 0 64 hit under many window settings including cw with a size of 13 days fig 6b based on the results of both rmse and cc we concluded that the best window setting for rbc was cw with a size of 13 days and therefore used its bias correction results to compare with the other bias correction methods 3 4 comparison of bias correction performance 3 4 1 annual comparison fig 7 compared the bias correction performance of rbc cdf and bi lstm t across all rainfall stations in terms of cc rmse mae and rb in the figure the 26 rainfall stations were numbered in the order of increasing surface elevation for the sake of comparison the metric values of imerg e and imerg f were also shown in the figure as seen from fig 7 cc of bi lstm t surpassed that of cdf and rbc as well as both imerg products at all stations while its rmse stayed constantly lower than all other products in addition its mae was also consistently less than the other products except exceeding cdf by 0 04 at one station table 1 compared the mean of the metrics across 26 stations among different products as expected bi lstm t consistently performed the best with the highest mean cc of 0 74 the lowest rmse of 10 29 and the lowest mae of 5 41 it increased the mean cc of imerg e by 26 7 while reducing its rmse and mae by 23 9 and 21 8 respectively posterior pairwise comparison results confirmed that bi lstm t differed significantly from cdf and rbc as well as both imerg products with regard to mean cc rmse and mae fig 7 furthermore bi lstm t correction results did not exhibit a systematic bias with a mean rb of 0 4 compared to 13 12 of cdf and 2 02 of rbc table 1 both inferior to bi lstm t performance of cdf and rbc was mixed while cdf outperformed rbc with regard to cc and rmse its mean mae was slightly higher table 1 in addition posterior pairwise comparisons results indicated that the difference in mean cc and mae was actually insignificant between the two methods fig 7 previous studies have found much difference in the performance of various spps at different altitude milewski et al 2015 yang et al 2020 in view of this we further examined whether elevation could affect the bias correction performance of rbc cdf and bi lstm t in the kelantan river basin the 26 rain gauges were divided into four groups based on their elevation namely low elevation group seven gauges with elevation from 12 to 51 m medium low elevation group eight gauges with elevation from 62 to 93 m medium high elevation group six gauges with elevation from 101 to 153 m and high elevation group five gauges with elevation from 165 to 640 m fig 8 compared the bias correction performance of rbc cdf and bi lstm t among the four elevation groups in terms of cc rmse mae and rb boxplots of the metrics for imerg e were also shown in the figure for comparison the ccs of imerg e and three bias corrected satellite precipitation products all exhibited a decreasing trend with increasing elevation however posterior comparison tests showed that mean ccs were not all significantly different among the four elevation groups in fig 8 dotted lines were drawn between two elevation groups if posterior comparison tests concluded that they were significantly different at the α level of 0 05 for imerg e and bi lstm t mean cc of the high elevation group was significantly lower than the other three groups fig 8a fig 8d for rbc and cdf mean cc of the high elevation group was only significantly lower than that of the low and medium low elevation groups meanwhile mean cc of medium high elevation group was significantly lower than that of the low elevation group fig 8b fig 8c unlike cc none of the other three metrics showed a consistent trend of change with elevation posterior comparison tests have also concluded an insignificant difference in both rmse and rb among all elevation groups for all spps fig 8e 8h and fig 8m 8p however posterior comparison tests did find a significant difference in mae between the low and medium high elevation group for cdf fig 8k and between the low and medium high as well as high elevation groups for bi lstm t fig 8l 3 4 2 seasonal comparison as a tropical river basin intra annual rainfall distribution in the kelantan river basin is highly unbalanced the basin usually receives heavy precipitation during the northeast monsoon nem season and relatively less rainfall during the southwest monsoon swm season meanwhile some precipitation occurs during the two inter monsoon seasons during the study period from 2010 to 2016 annual average precipitation in the kelantan river basin amounted to 2485 mm rainfall in the nem and swm seasons respectively accounted for 37 8 and 30 4 compared to 13 9 and 17 9 in the first and second inter monsoon seasons seasonal evaluation of imerg e revealed much difference in its performance among the four seasons table 2 for example its mean cc varied considerably from 0 43 in the swm season to 0 71 in the nem season in view of the substantial difference in the seasonal performance of imerg e we further compared the bias correction performance of rbc cdf and bi lstm t within each season figs 9 12 compared the bias correction performance of rbc cdf and bi lstm t across all rainfall stations in the four seasons respectively for the sake of comparison the seasonal metric values of imerg e and imerg f were also shown in the figures in terms of cc bi lstm t surpassed rbc at all 26 stations within each season meanwhile it surpassed cdf at 25 stations in the nem and first inter monsoon seasons 23 stations in the swm season and 20 stations in the second inter monsoon season in terms of rmse bi lstm t outperformed rbc at all stations and cdf at 23 stations within each season with regard to mae bi lstm t consistently outperformed rbc at 23 stations meanwhile it outperformed cdf at 16 stations in the nem season and 24 stations in all other seasons table 2 compared the seasonal means of the metrics across 26 stations among different products unsurprisingly bi lstm t constantly outperformed both cdf and rbc throughout the four seasons yielding the highest mean cc value as well as the lowest rmse and mae values in the four seasons bi lstm t was able to increase the mean cc of the imerg e by 19 7 27 5 while decreasing its mean rmse by 18 4 30 0 and mean mae by 20 9 23 2 posterior pairwise comparison results confirmed that the mean cc of bi lstm t was significantly higher than that of rbc and cdf as well as both imerg products while its mean rmse was significantly lower in all four seasons mean mae of bi lstm t was also significantly lower than all products throughout the four seasons except it was lower than cdf insignificantly in the nem season figs 9 12 unlike bi lstm t posterior comparison results showed that both cdf and rbc failed to improve the imerg products significantly in some cases for example in the second inter monsoon season mean cc of rbc differed insignificantly from both imerg products while mean mae of cdf differed insignificantly from imerg f cases of insignificant difference in rmse and mae between cdf rbc and imerg products also existed in all other three seasons figs 9 12 while bi lstm t consistently stayed at the top the relative performance between rbc and cdf was mixed and varied over seasons during the nem season cdf consistently outperformed rbc with a higher cc of 0 80 as well as a lower rmse and mae of 12 96 and 6 20 posterior comparison results confirmed that mean cc of cdf surpassed that of rbc significantly while its mean rmse and mae were significantly lower in the season fig 9 in the other three seasons however cdf was able to yield higher cc and lower rmse values than rbc but also higher mae values in the meantime figs 10 12 for instance in the first inter monsoon season mean cc of cdf surpassed that of rbc by 0 03 while its rmse was 0 09 lower nevertheless cdf had the highest mae surpassing bi lstm t and rbc by17 8 and 6 6 respectively furthermore cdf exhibited a much stronger tendency of systematic bias in correction than both bi lstm t and rbc in all four seasons as shown in table 2 absolute mean rb of cdf exceeded 15 in the nem season while approaching or even surpassing 30 in the other three seasons in contrast absolute mean rb of rbc and lstm was respectively below 4 and 7 throughout the four seasons 4 conclusion reliable precipitation data are vital to sustainable water resource management as well as water related disaster prevention and mitigation spps have emerged as a promising alternative for providing quasi global rainfall estimates of high spatial and temporal resolution nevertheless evaluation of various spps in malaysia has revealed a relatively unsatisfactory performance in comparison to many other regions for example annual mean cc of imerg e was merely 0 58 in the kelantan river basin while its seasonal cc could drop to 0 43 in the swm season therefore effective bias correction methods are much in need to reduce the bias of imerg e to make it useful for hydrological or other potential applications in view of the need we established the framework of using bi lstm to correct the bias of spps and tested its performance in correcting daily imerg e from 2010 to 2016 in the kelantan river basin optimization of the architecture of bi lstm revealed that the covariates of daily maximum and minimum temperature unexpectedly contributed the absolute majority to the bias correction performance of bi lstm in comparison with the other two covariates of surface elevation and distance to coast statistical tests showed that the performance of bi lstm only with the covariates of daily maximum and minimum temperature bi lstm t was not significantly different from that with all four covariates bi lstm all in addition further comparison of bi lstm t with two benchmark methods namely ratio bias correction and cdf matching showed that bi lstm t consistently outperformed the two methods in bias correction both annually and seasonally annually bi lstm t increased the mean cc of imerg e by 26 7 while reducing its rmse and mae by 23 9 and 21 7 in the four seasons it increased the mean cc of imerg e by 19 7 27 5 while decreasing its rmse and mae by 18 4 30 0 and 20 9 23 2 its good performance in the kelantan river basin suggests that the bi lstm t model may work as a promising framework of great potentials for correcting the bias of various spps besides imerg in tropical regions where adequate precipitation data are in great need for diverse purposes such as water related disaster prevention and mitigation funding this work received supports from the belt and road special foundation of the state key laboratory of hydrology water resources and hydraulic engineering at nanjing hydraulic research institute china grant number 2018nkzd01 the national key r d program of china grant number 2019yfc1805102 the ministry of higher education malaysia under long term research grant scheme project 2 grant number lrgs 1 2020 ukm usm 01 6 2 national natural science foundation of china grant numbers 41830863 51679144 credit authorship contribution statement xiaoying yang conceptualization methodology formal analysis writing original draft funding acquisition shuai yang methodology software formal analysis visualization validation mou leong tan conceptualization data curation writing review editing funding acquisition hengyang pan formal analysis investigation visualization hongliang zhang conceptualization writing review editing guoqing wang conceptualization writing review editing ruimin he conceptualization writing review editing zimeng wang project administration resources writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
3492,the high spatiotemporal variability of rainfall in tropical regions has posed a great challenge for generating satisfactory satellite precipitation products spps most of previous studies have found a modest performance of various spps in estimating daily rainfall in tropical regions such as malaysia in depth research on effective ways to correct the bias of spps in the tropical region is urgently needed this study aims to establish a bidirectional long short term memory recurrent network bi lstm framework for the bias correction of spps and apply it to correct daily rainfall estimates of the early runs of integrated multisatellite retrievals for the global precipitation measurement imerg e from 2010 to 2016 in the kelantan river basin malaysia after optimization and statistical comparison bi lstm with the covariates of daily maximum and minimum temperature bi lstm t was determined to be the best model for bias correction annually bi lstm t could raise the correlation coefficient cc of imerg e by 26 7 while reducing its root mean square error rmse and mean absolute error mae by 23 9 and 21 7 in the kelantan river basin in the four seasons it increased the cc of imerg e by 19 7 27 5 while decreasing its rmse and mae by 18 4 30 0 and 20 9 23 2 multiple statistical tests confirmed that bi lstm t significantly outperformed two benchmark methods namely ratio bias correction rbc and cumulative distribution function cdf matching in correcting the bias of imerg e for all four seasons this suggests that the bi lstm t model may work as a promising framework of great potentials for correcting the bias of spps in tropical regions where adequate precipitation data are in great need for diverse purposes such as water related disaster prevention and mitigation keywords satellite precipitation product bias correction deep neural network ratio bias correction cumulative distribution function statistical evaluation 1 introduction the spatiotemporal variability of precipitation strongly conditions water availability to diverse human society needs as well as the maintenance of vital ecosystem functions reliable precipitation data are essential to the sustainable management of water resources as well as monitoring and predicting the risk of various water related hazards including drought and flood sadeghi et al 2019 yuan et al 2017 under the context of global climate change and the increasing likelihood of extreme event occurrences ipcc 2021 obtaining precipitation data of adequate spatial and temporal resolution in a timely manner is critical especially to tropical regions where fast heat and water movement makes the regions more sensitive to climate change and more susceptible to the catastrophic consequences of water related hazards o gorman 2012 van beusekom et al 2016 traditionally precipitation measurements by ground based rain gauges have served as the primary source of rainfall data around the world kidd et al 2017 tan et al 2021 although considered as the most reliable method for rainfall estimation rain gauges could only provide point measurements whose spatial distribution is often limited due to various reasons such as high altitude complex terrain inaccessible areas and limited financial resources kim et al 2017 pomeon et al 2017 prakash 2019 zhang et al 2019 satellite precipitation products spps are capable of providing rainfall estimates at a relatively fine spatiotemporal resolution with a quasi global coverage which makes them increasingly popular especially in regions with sparse rainfall data skofronick jackson et al 2018 currently a number of spps are operationally available and free to the public such as cmorph climate prediction center morphing technique product joyce et al 2004 trmm tropical rainfall measuring mission tmpa multi satellite precipitation analysis products huffman et al 2007 and imerg integrated multisatellite retrievals for the global precipitation measurement skofronick jackson et al 2018 however satellite precipitation products are likely to contain both systematic and random errors such as those related to satellite sensors spatial and temporal sampling and retrieval algorithms aghakouchak et al 2012 gumindoga et al 2019 habib et al 2014 many studies have assessed the performance of spps in regions with diverse topographic and climatic conditions as well as different ground rainfall data availability hamza et al 2020 hosseini moghari and tang 2020 palomino angel et al 2019 tang et al 2020 vallejo bernal et al 2021 yu et al 2020 zhu et al 2020 in tropical regions the high variability in the spatiotemporal distribution of rainfall has posed a great challenge for generating satisfactory rainfall estimates through satellite remote sensing for example previous studies evaluating various spps in malaysia have mostly concluded a modest performance in daily rainfall estimation in the country tan et al 2015 evaluated the performance of six spps across malaysia between 2014 and 2016 and concluded that the ccs of daily spps ranged from 0 43 of persiann precipitation estimation from remotely sensed information using artificial neural networks to 0 60 of imerg f resampled to 0 25 similarly in their assessment of three imerg products in the kelantan river basin between 2014 and 2016 tan et al 2018 found that imerg l had the highest daily cc of 0 63 in view of their inadequate performance there is an urgent need for research on effective ways for correcting the bias of daily spps to enhance their utility for hydrometeorological applications in tropical regions in previous studies a variety of methods have been tested for reducing the bias of spps including power transformation mastrantonas et al 2019 soo et al 2020 ratio bias correction bhatti et al 2016 gumindoga et al 2019 habib et al 2014 mastrantonas et al 2019 cumulative distribution function cdf matching gumindoga et al 2019 katiraie boroujerdy et al 2020 mastrantonas et al 2019 and regression analysis chen et al 2018 chen et al 2020 yeh et al 2020 neural network is a computational model designed by imitating the functioning of human brain nervous system over the past two decades it has gained much popularity in a variety of fields such as medicine finance image processing and environmental sciences chen et al 2018 hong et al 2004 hsu et al 1997 maier et al 2010 schmidhuber 2015 zhi et al 2021 recent fast development in deep neural networks characterized by their flexibility and capacity to deal with huge and complex datasets allows to better exploit spatial and temporal structures of multiple data sources to generate more accurate precipitation estimates asanjan et al 2018 miao et al 2019 pan et al 2019 tao et al 2017 tao et al 2018 and sadeghi et al 2019 respectively proposed persiann sdae stacked denoising autoencoders model and persiann cnn convolutional neural network model to utilize infrared and water vapor channels of goes geostationary operational environmental satellites to make classifications between rain and no rain events as well as estimate precipitation amount both of them tested their models in the united states and concluded that their models outperformed the operational satellite precipitation product persiann ccs precipitation estimation from remotely sensed information using artificial neural networks cloud classification system sadeghi et al 2019 tao et al 2018 in addition hayatbini et al 2019 used the conditional generative neural networks to extract useful features from goes 16 for estimating precipitation over the continental united states based on fengyun 2 satellite data xue et al 2021 used cnn to estimate precipitation over the arid xinjiang province in northwestern china up to date very few studies have attempted to use deep neural networks to correct the bias of spps wu et al 2020 to the best of our knowledge deep neural networks have yet been utilized for correcting the bias of spps in tropical regions such as malaysia meanwhile in spite of the substantial seasonal rainfall variations in many regions around the world previous studies have rarely investigated potential seasonal differences in the bias correction performance furthermore most studies have largely resorted to simple mean metric values to assess the differences among various bias correction methods however this simple averaging approach fails to assess the significance of the difference in their bias correction performance to fill in these gaps this paper aims to establish a deep neural network framework for correcting the bias of spps and apply it to correct the daily imerg e products in the kelantan river basin of malaysia over a period of seven years from 2010 to 2016 statistical tests are conducted to systematically compare the bias correction performance of different neural network architectures so as to identify the optimal configuration in addition deep neural network is statistically compared with two benchmark bias correction methods ratio bias correction and cdf matching in their bias correction performance both annually and seasonally 2 materials and methods 2 1 study region with a drainage area of 12 134 km2 the kelantan river basin 4 40 6 12 n 101 20 102 20 e is located in northeastern peninsular malaysia fig 1 as the major river in the basin the 248 km long kelantan river originates from the western tahan and titiwangsa mountain ranges and flows north and northeastward till its eventually discharging into the south china sea as a typical tropical river basin the kelantan river basin is hot and humid throughout the year with an annual average temperature of 27 5 c and total precipitation of 2500 mm year under the heavy influence of monsoons the basin exhibits distinct seasonal alternations between wet and dry periods heavy precipitation usually occurs during the northeast monsoon nem season that spans from november to the following january in contrast relatively less precipitation occurs in the southwest monsoon swm season from may to august during the two inter monsoon seasons february to april and september to october due to intense surface heating and sea breeze circulation tan and santo 2018 historically the kelantan river basin has been frequently hit by both flood and drought causing severe damages to local economy and daily livelihoods and in some cases even loss of life mansor et al 2018 tan et al 2017a 2017b 2 2 data sources 2 2 1 satellite precipitation estimates over the last two decades a number of satellite precipitation products spps with different spatiotemporal resolutions have been released with the aim to produce more accurate satellite precipitation estimates at finer spatiotemporal resolutions nasa national aeronautics and space administration and jaxa japan aerospace exploration agency jointly launched the gpm global precipitation measurement mission in 2014 the gpm mission consists of an international collection of low earth orbiting satellites which carry both dual frequency precipitation radar and conical scanning multichannel gpm microwave imager for better rainfall detection the imerg integrated multisatellite retrievals for global precipitation measurement algorithm is used to generate rainfall estimates worldwide at fine spatial and temporal resolution through inter calibrating interpolating and merging all available satellite microwave precipitation estimates ground gauge measurements and other potential precipitation estimates there are three types of imerg products with different latencies the near real time early imerg e and late imerg l runs and the post real time final run imerg f imerg e and imerg l products are usually released in around 4 and 14 h after the event whereas imerg f in about 4 months after going through adjustment against monthly ground rainfall records and other potentially available precipitation estimates because of its short latency the near real time imerg e products are especially useful for timely prediction of water related disasters and formulation of effective mitigation strategies therefore this study focuses on correcting the bias of daily rainfall estimates of imerg e the 30 min imerg v6 products with a spatial resolution of 0 1 were downloaded from the nasa website https disc gsfc nasa gov and aggregated to the daily level 2 2 2 ground rainfall records historical daily precipitation records from 2010 to 2016 in the kelantan river basin were obtained from the department of irrigation and drainage did of malaysia and the malaysia meteorological department mmd all daily precipitation measurements have been consistently taken at 00 00 utc time each day a total of 26 rain gauges which have less than 10 missing values were used in our study their missing values were estimated based on the amount of rainfall at the nearest stations fig 1 2 3 bias correction methods 2 3 1 deep neural network method the most classic neural network architecture is mlp multilayer perceptron which consists of input hidden and output layers in mlp neurons in the input layer pass on the weighted inputs to those in the hidden layer where the possible usage of nonlinear activation functions could help capture the complexity and non linearity of the modelled system maier et al 2010 however mlp is not suitable for dealing with sequential information because it generates output solely based on the current input data unlike mlp the recurrent neural network rnn architecture contains cyclic connection which allows it to update its state based on current input data as well as previous states up to date rnn has been widely used in fields that require to process massive sequential data such as text audio and video yu et al 2019 when it comes to use rnn for processing massive daily rainfall series two issues need to be solved firstly as the time interval between the related inputs grows it is hard for the standard rnn to learn their connection information yu et al 2019 this so called long term dependency problem of rnn reduces its ability to process long term input series to solve the problem hochreiter and schmidhuber 1997 proposed the long short term memory lstm cell which improved the remembering capacity of the standard recurrent cell through a gate mechanism the lstm utilizes different gates such as input forget and output gates to determine what information are retained or thrown away from the cell state as shown in eqs 1 6 1 f t σ w f h t 1 x t b f 2 i t σ w i h t 1 x t b i 3 o t σ w o h t 1 x t b o 4 c t t a n h w c h t 1 x t b c 5 c t f t c t 1 i t c t 6 h t o t t a n h c t where f t i t o t respectively represents the forget input and output gate c t is the cell state c t is a potential vector of cell state h is a hidden vector w is the weight matrix b is the bias term a b represents the concatenation of two vectors tanh is the hyperbolic tangent represents the element wise multiplication secondly at any time t the standard rnn could only learn from the previous inputs thus missing all valuable information contained in the input series afterwards schuster and paliwal 1997 proposed the bidirectional recurrent neural network brnn to mitigate this problem of information loss by superposing two rnns with opposite training sequences and separate hidden layers at certain time t the output of brnn is jointly determined by these two rnns so that inputs both backward and forward in time are used to generate outputs brnn and the lstm cell were combined to form the bidirectional lstm bi lstm to correct the bias of daily imerg e products in the kelantan river basin besides daily satellite precipitation estimates covariates may be included in the input layer of the bi lstm as ziarh et al 2021 found significant correlation between annual mean rainfall and surface elevation and distance to coast in malaysia both variables were tested as potential covariates in the bi lstm surface elevation of the rainfall gauges was estimated based on the shuttle radar topography mission srtm dem whereas their distance to coast was calculated as the euclidean distance to the closest coastline in addition as a tropical country temperature changes little throughout the year in malaysia rainfall events could play a relatively important role in its daily temperature fluctuations in view of this feature we included daily maximum and daily minimum temperature as the potential covariates in the bi lstm temperature data at the kuala krai station 102 2 e 5 53 n were used and assumed to be the same throughout the basin fig 2 illustrated the proposed deep neural network framework for correcting the bias of spps 2 3 2 ratio bias correction rbc ratio bias correction rbc is one of the mostly widely used methods for correcting the bias of the spps due to its simplicity it usually involves four steps 1 determine the size and type of temporal window for calculating the correction ratios 2 calculate the ratio between cumulative ground rainfall measurement and cumulative satellite rainfall estimate within the window at each gauge location 3 spatially interpolate the ratios at all gauge locations to create a grid and 4 multiply the original spp with the grid of correction ratios to produce the ratio bias corrected spp steps 2 to 4 are repeated for each succeeding temporal window till the end of the bias correction period mastrantonas et al 2019 up to date different sizes and types of temporal windows have been used for generating the subsets to calculate the correction ratios bhatti et al 2016 habib et al 2014 for example bhatti et al 2016 examined the performance of rbc using both moving windows mw and sequential windows sw whose sizes range from 1 to 31 days they concluded that the 7 day sw was the best temporal window for correcting the bias of cmorph estimates in the gilgel abbey catchment ethiopia similar to bhatti et al 2016 this study compared the performance of rbc among various sizes of mw and sw 3 to 31 days in the kelantan river basin in generating a new subset the mw approach shifts the window one time step forward while the sw approach shifts forward by the window size in the sw approach a single bias factor is estimated for all days falling within each window in the mw approach however the bias factor could be calculated with different schemes such as fw bw and cw for instance under a window size of 5 days fw scheme calculates the bias correction factor based on spp estimates and ground rainfall observations of the current day and the following 4 days bw calculates the factor based on those of the current day and the previous 4 days whereas cw calculates the factor based on those of the current day as well as the previous and following 2 days in the following are the equations for calculating the correction ratio at day d under the fw eq 7 bw eq 8 and cw eq 9 scheme respectively 7 rb i d t d t d l p g i t d t d l p s i 8 rb i d t d l t d p g i t d l t d p s i 9 rb i d i d m i d m p g i i d m i d m p s i where pg i and ps i respectively represents ground rainfall observation and satellite precipitation estimate on day i l is the sampling window size and m is the number of days before after day d included in the sampling window under the cw scheme which is calculated as following 10 m l 1 2 it needs to be noted that the cw scheme is only applicable to sampling windows with a size of odd number of days 2 3 3 cumulative distribution function matching method cdf the cdf matching method is another widely used method for correcting the bias of spps it makes adjustment to satellite rainfall estimates so that the cdfs of adjusted rainfall estimates and ground rainfall measurements are similar within certain temporal window in each temporal window the cdf matching method contains the following steps 1 obtain the cdf of ground rainfall observations at each gauge location and use the cdf to adjust the corresponding satellite rainfall estimates eq 11 2 calculate the difference between the original and adjusted satellite rainfall estimates at each gauge location 3 spatially interpolate the difference at all gauge locations through the inverse distance weighting idw method to create a grid 4 add the grid of difference to the original spp to produce the cdf bias corrected spp these steps need to be repeated for each succeeding temporal window till the end of the bias correction period mastrantonas et al 2019 11 p s i f g i 1 f s i p s i where f s i is the cdf of satellite rainfall estimates of the grid cell corresponding to rain gauge i f g i 1 is the inverse cdf of ground rainfall observations of rain gauge i and p s i and p s i are respectively the bias corrected and actual satellite rainfall estimates of the grid cell corresponding to rain gauge i the cdf of ground rainfall observations and satellite rainfall estimates was estimated for each month individually 2 4 comparison of bias correction performance performance of the bias correction methods was evaluated and compared through the so called cross validation process during cross validation all rainfall stations except one were utilized in each bias correction process to estimate daily rainfall at the left out rainfall station four metrics were used to evaluate the bias correction performance at the left out rainfall station including correlation coefficient cc root mean square error rmse mean absolute error mae and relative bias rb yang et al 2020 12 c c i 1 n x i o x o x i s x s i 1 n x i o x o 2 i 1 n x i s x s 2 13 r m s e i 1 n x i s x i o 2 n 14 m a e i 1 n x i o x i s n 15 r b i 1 n x i s x i o i 1 n x i o 100 where n represents the number of observed and estimated data pairs x i o and x i s represent the ith pair of observed and estimated amount x o and x s represent mean observed and estimated amount the above process was repeated to evaluate the bias correction performance of each method at all rainfall stations most of previous studies made comparison among different bias correction methods simply based on the mean metric values the simple averaging approach masks potentially large variability in metrics among the stations unlike previous studies we statistically compared the difference in metrics among various bias correction methods using the one way repeated measures anova analysis of variance and multiple posterior comparison tests including the bonferroni test scheffe test tukey test sidak test and fisher test all statistic tests were implemented in the origin 2018 statistical package 3 results and discussion 3 1 spatial variability in daily rainfall historical daily rainfall observations from 2010 to 2016 at 26 stations in the kelantan river basin were used in our bias correction study to assess the spatial variability of daily rainfall in the basin we calculated both the range and coefficient of variation cv of daily precipitation among the 26 stations for each day during the study period fig 3 compared the boxplots of the range and cv of daily rainfall among five groups of days whose mean daily rainfall fell in the interval of 50 mm n 26 days 30 50 mm n 47 days 20 30 mm n 111 days 10 20 mm n 466 days and 1 10 mm n 1243 days respectively both boxplots revealed the tremendous spatial variability in daily rainfall among the 26 stations in the kelantan river basin for example during the 26 days with mean daily rainfall above 50 mm the average range of daily rainfall was 168 mm whereas the maximum could reach 370 mm the average range of the other four groups were 109 mm 82 mm 58 mm and 31 mm whereas their maximum reached 197 mm 182 mm 127 mm and 117 mm fig 3a similarly the average cv of the two groups with heavier rainfall both surpassed 0 6 while the other three groups exceeded 1 meanwhile the maximum cv of the five groups reached 1 05 1 40 2 05 2 75 and 5 10 respectively fig 3b the revealed large spatial variability in daily rainfall distribution illustrates the utility of satellite precipitation estimates as a valuable complement to ground measurements due to its advantage of continuous spatial coverage 3 2 architecture optimization of bi lstm previous machine learning studies usually put all candidate covariates directly as model inputs baez villanueva et al 2020 xue et al 2021 ziarh et al 2021 however it is possible that not every candidate covariate is essential to the model unlike previous studies this study attempted to ultimately obtain a parsimonious bi lstm architecture by specifically examining the contribution of individual group of covariates to the bias correction performance of bi lstm four potential covariates were tested for their contributions to bi lstm namely surface elevation distance to coast daily maximum temperature tmax and daily minimum temperature tmin the four covariates were divided into three groups with group 1 containing surface elevation group 2 containing distance to coast and group 3 containing tmax and tmin besides the bi lstm with all four covariates bi lstm all we ran three additional bi lstms bi lstm e bi lstm d bi lstm t each containing only one group of the covariates hyperparameters were tuned to yield the optimal bi lstm models through minimizing the loss function on given inputs multiple experiments have indicated that the loss function composed of a weighted sum of mean square error mse and mean absolute error mae could yield the best bias correction results eq 18 16 l mse i 1 n x i s x i o 2 n 17 l mae i 1 n x i o x i s n 18 l estimation 0 8 l mse 0 2 l mae where n represents the number of observed and estimated data pairs x i o and x i s represent the ith pair of observed and estimated amount of precipitation the bi lstm was trained with the adam adaptive moment estimation optimizer kingma and ba 2014 xue et al 2021 under the tensorflow 2 2 0 and keras 2 3 1 frameworks its learning rate exponential decay rates for the first and second moment estimates and batch size were set as 0 01 0 9 0 99 and 2048 respectively meanwhile relu was used as the activation function which may help reduce computing amount avoid gradient disappearance and alleviate overfitting risk the ultimate optimized architecture of the three bi lstms containing single group of covariates was identical meanwhile their architecture was also similar to that of bi lstm all except it had fewer neurons in the bidirectional lstm and dense layers to reduce the risk of overfitting fig 4 fig 5 compared the boxplots of the four metrics across the 26 rainfall stations among the four bi lstms with different covariates for example the four boxplots in fig 5b characterized the distribution of rmses of the bi lstms that contained only elevation bi lstm e only distance to coast bi lstm d only tmax and tmin bi lstm t and all four covariates bi lstm all respectively across the 26 rainfall stations rmse of bi lstm all ranged from 8 41 to 13 80 with a mean of 10 00 compared to 9 75 15 82 with a mean of 12 20 for bi lstm e 9 67 15 50 with a mean of 12 13 for bi lstm d and 8 83 13 80 with a mean of 10 29 for bi lstm t one way repeated measures anova was respectively performed to evaluate the significance of the difference in each metric among the four bi lstms anova results indicated that all four metrics were significantly different among the four bi lstms at the significance level α of 0 05 therefore multiple posterior comparison tests were further performed to identify the pairs of bi lstms that were indeed significantly different in fig 5 solid lines were drawn between two bi lstms if posterior comparison tests concluded that they were not significantly different at the α level of 0 05 as shown in fig 5 all four metrics were significantly different between every pair of bi lstms except two pairs namely the pair between bi lstm e and bi lstm d and the pair between bi lstm all and bi lstm t this showed that tmax and tmin contributed significantly more than the other two covariates to the bias correction performance of bi lstm the much more significant contribution by tmax and tmin is rather unexpected since surface elevation has been the most widely used covariate in previous studies whereas temperature has been rarely used baez villanueva et al 2020 chao et al 2018 wu et al 2020 xue et al 2021 zhang et al 2018 one possible reason for this result is due to the unique climate conditions in tropical regions where temperature usually changes little throughout the year and consequently the cooling effect of rainfall events is more conspicuous since the bias correction performance of the bi lstm containing only tmax and tmin was comparable to that with all four covariates the parsimonious bi lstm t was determined to be the best bi lstm model for comparison with the other bias correction methods 3 3 window selection in ratio bias correction rbc we compared the performance of rbc among four types of sampling windows sw and three mws respectively with the fw bw and cw scheme with size ranging from 3 to 31 days fig 6 compared the mean rmses and ccs of the satellite precipitation estimates after being corrected with rbc using four types of windows of different size under sw bw and cw mean rmse tended to decrease initially with increasing window size followed by a leveling off with further increase in window size under fw however mean rmse increased continuously after its initial decline with increasing window size after window size surpassed 11 days cw consistently performed the best followed by bw while fw and sw performed considerably worse overall mean rmse reached the minimum of 12 55 mm under cw with a size of 13 days fig 6a in terms of cc mean cc of sw mostly remained lower than those of the three mws under the three mws mean cc mostly fluctuated between 0 61 and 0 64 with the maximum of 0 64 hit under many window settings including cw with a size of 13 days fig 6b based on the results of both rmse and cc we concluded that the best window setting for rbc was cw with a size of 13 days and therefore used its bias correction results to compare with the other bias correction methods 3 4 comparison of bias correction performance 3 4 1 annual comparison fig 7 compared the bias correction performance of rbc cdf and bi lstm t across all rainfall stations in terms of cc rmse mae and rb in the figure the 26 rainfall stations were numbered in the order of increasing surface elevation for the sake of comparison the metric values of imerg e and imerg f were also shown in the figure as seen from fig 7 cc of bi lstm t surpassed that of cdf and rbc as well as both imerg products at all stations while its rmse stayed constantly lower than all other products in addition its mae was also consistently less than the other products except exceeding cdf by 0 04 at one station table 1 compared the mean of the metrics across 26 stations among different products as expected bi lstm t consistently performed the best with the highest mean cc of 0 74 the lowest rmse of 10 29 and the lowest mae of 5 41 it increased the mean cc of imerg e by 26 7 while reducing its rmse and mae by 23 9 and 21 8 respectively posterior pairwise comparison results confirmed that bi lstm t differed significantly from cdf and rbc as well as both imerg products with regard to mean cc rmse and mae fig 7 furthermore bi lstm t correction results did not exhibit a systematic bias with a mean rb of 0 4 compared to 13 12 of cdf and 2 02 of rbc table 1 both inferior to bi lstm t performance of cdf and rbc was mixed while cdf outperformed rbc with regard to cc and rmse its mean mae was slightly higher table 1 in addition posterior pairwise comparisons results indicated that the difference in mean cc and mae was actually insignificant between the two methods fig 7 previous studies have found much difference in the performance of various spps at different altitude milewski et al 2015 yang et al 2020 in view of this we further examined whether elevation could affect the bias correction performance of rbc cdf and bi lstm t in the kelantan river basin the 26 rain gauges were divided into four groups based on their elevation namely low elevation group seven gauges with elevation from 12 to 51 m medium low elevation group eight gauges with elevation from 62 to 93 m medium high elevation group six gauges with elevation from 101 to 153 m and high elevation group five gauges with elevation from 165 to 640 m fig 8 compared the bias correction performance of rbc cdf and bi lstm t among the four elevation groups in terms of cc rmse mae and rb boxplots of the metrics for imerg e were also shown in the figure for comparison the ccs of imerg e and three bias corrected satellite precipitation products all exhibited a decreasing trend with increasing elevation however posterior comparison tests showed that mean ccs were not all significantly different among the four elevation groups in fig 8 dotted lines were drawn between two elevation groups if posterior comparison tests concluded that they were significantly different at the α level of 0 05 for imerg e and bi lstm t mean cc of the high elevation group was significantly lower than the other three groups fig 8a fig 8d for rbc and cdf mean cc of the high elevation group was only significantly lower than that of the low and medium low elevation groups meanwhile mean cc of medium high elevation group was significantly lower than that of the low elevation group fig 8b fig 8c unlike cc none of the other three metrics showed a consistent trend of change with elevation posterior comparison tests have also concluded an insignificant difference in both rmse and rb among all elevation groups for all spps fig 8e 8h and fig 8m 8p however posterior comparison tests did find a significant difference in mae between the low and medium high elevation group for cdf fig 8k and between the low and medium high as well as high elevation groups for bi lstm t fig 8l 3 4 2 seasonal comparison as a tropical river basin intra annual rainfall distribution in the kelantan river basin is highly unbalanced the basin usually receives heavy precipitation during the northeast monsoon nem season and relatively less rainfall during the southwest monsoon swm season meanwhile some precipitation occurs during the two inter monsoon seasons during the study period from 2010 to 2016 annual average precipitation in the kelantan river basin amounted to 2485 mm rainfall in the nem and swm seasons respectively accounted for 37 8 and 30 4 compared to 13 9 and 17 9 in the first and second inter monsoon seasons seasonal evaluation of imerg e revealed much difference in its performance among the four seasons table 2 for example its mean cc varied considerably from 0 43 in the swm season to 0 71 in the nem season in view of the substantial difference in the seasonal performance of imerg e we further compared the bias correction performance of rbc cdf and bi lstm t within each season figs 9 12 compared the bias correction performance of rbc cdf and bi lstm t across all rainfall stations in the four seasons respectively for the sake of comparison the seasonal metric values of imerg e and imerg f were also shown in the figures in terms of cc bi lstm t surpassed rbc at all 26 stations within each season meanwhile it surpassed cdf at 25 stations in the nem and first inter monsoon seasons 23 stations in the swm season and 20 stations in the second inter monsoon season in terms of rmse bi lstm t outperformed rbc at all stations and cdf at 23 stations within each season with regard to mae bi lstm t consistently outperformed rbc at 23 stations meanwhile it outperformed cdf at 16 stations in the nem season and 24 stations in all other seasons table 2 compared the seasonal means of the metrics across 26 stations among different products unsurprisingly bi lstm t constantly outperformed both cdf and rbc throughout the four seasons yielding the highest mean cc value as well as the lowest rmse and mae values in the four seasons bi lstm t was able to increase the mean cc of the imerg e by 19 7 27 5 while decreasing its mean rmse by 18 4 30 0 and mean mae by 20 9 23 2 posterior pairwise comparison results confirmed that the mean cc of bi lstm t was significantly higher than that of rbc and cdf as well as both imerg products while its mean rmse was significantly lower in all four seasons mean mae of bi lstm t was also significantly lower than all products throughout the four seasons except it was lower than cdf insignificantly in the nem season figs 9 12 unlike bi lstm t posterior comparison results showed that both cdf and rbc failed to improve the imerg products significantly in some cases for example in the second inter monsoon season mean cc of rbc differed insignificantly from both imerg products while mean mae of cdf differed insignificantly from imerg f cases of insignificant difference in rmse and mae between cdf rbc and imerg products also existed in all other three seasons figs 9 12 while bi lstm t consistently stayed at the top the relative performance between rbc and cdf was mixed and varied over seasons during the nem season cdf consistently outperformed rbc with a higher cc of 0 80 as well as a lower rmse and mae of 12 96 and 6 20 posterior comparison results confirmed that mean cc of cdf surpassed that of rbc significantly while its mean rmse and mae were significantly lower in the season fig 9 in the other three seasons however cdf was able to yield higher cc and lower rmse values than rbc but also higher mae values in the meantime figs 10 12 for instance in the first inter monsoon season mean cc of cdf surpassed that of rbc by 0 03 while its rmse was 0 09 lower nevertheless cdf had the highest mae surpassing bi lstm t and rbc by17 8 and 6 6 respectively furthermore cdf exhibited a much stronger tendency of systematic bias in correction than both bi lstm t and rbc in all four seasons as shown in table 2 absolute mean rb of cdf exceeded 15 in the nem season while approaching or even surpassing 30 in the other three seasons in contrast absolute mean rb of rbc and lstm was respectively below 4 and 7 throughout the four seasons 4 conclusion reliable precipitation data are vital to sustainable water resource management as well as water related disaster prevention and mitigation spps have emerged as a promising alternative for providing quasi global rainfall estimates of high spatial and temporal resolution nevertheless evaluation of various spps in malaysia has revealed a relatively unsatisfactory performance in comparison to many other regions for example annual mean cc of imerg e was merely 0 58 in the kelantan river basin while its seasonal cc could drop to 0 43 in the swm season therefore effective bias correction methods are much in need to reduce the bias of imerg e to make it useful for hydrological or other potential applications in view of the need we established the framework of using bi lstm to correct the bias of spps and tested its performance in correcting daily imerg e from 2010 to 2016 in the kelantan river basin optimization of the architecture of bi lstm revealed that the covariates of daily maximum and minimum temperature unexpectedly contributed the absolute majority to the bias correction performance of bi lstm in comparison with the other two covariates of surface elevation and distance to coast statistical tests showed that the performance of bi lstm only with the covariates of daily maximum and minimum temperature bi lstm t was not significantly different from that with all four covariates bi lstm all in addition further comparison of bi lstm t with two benchmark methods namely ratio bias correction and cdf matching showed that bi lstm t consistently outperformed the two methods in bias correction both annually and seasonally annually bi lstm t increased the mean cc of imerg e by 26 7 while reducing its rmse and mae by 23 9 and 21 7 in the four seasons it increased the mean cc of imerg e by 19 7 27 5 while decreasing its rmse and mae by 18 4 30 0 and 20 9 23 2 its good performance in the kelantan river basin suggests that the bi lstm t model may work as a promising framework of great potentials for correcting the bias of various spps besides imerg in tropical regions where adequate precipitation data are in great need for diverse purposes such as water related disaster prevention and mitigation funding this work received supports from the belt and road special foundation of the state key laboratory of hydrology water resources and hydraulic engineering at nanjing hydraulic research institute china grant number 2018nkzd01 the national key r d program of china grant number 2019yfc1805102 the ministry of higher education malaysia under long term research grant scheme project 2 grant number lrgs 1 2020 ukm usm 01 6 2 national natural science foundation of china grant numbers 41830863 51679144 credit authorship contribution statement xiaoying yang conceptualization methodology formal analysis writing original draft funding acquisition shuai yang methodology software formal analysis visualization validation mou leong tan conceptualization data curation writing review editing funding acquisition hengyang pan formal analysis investigation visualization hongliang zhang conceptualization writing review editing guoqing wang conceptualization writing review editing ruimin he conceptualization writing review editing zimeng wang project administration resources writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
3493,this paper presents an investigation on the effect of dam operation on the ensemble kalman filter enkf performance in a distributed hydrological model based on kinematic wave theory for this purpose two flood events in a mountainous catchment in japan are selected and the model error parameters for the enkf implementation are first determined through a series of experiments by varying the input error magnitude state variable perturbation and its correlation length then through the assimilation of dam outflow observations it is shown that special treatment of such measurements is critical in ensuring the success of the filter when flood control operation significantly changes the flow hydrograph and when the covariances between distant grids are high localization methods based on euclidean distance flow accumulation values and river distance are all able to limit the deleterious updates to model states at distant grids and improve filter efficacy however no single localization approach is found to be consistently optimal for varying noise configurations number and type of assimilated stations or flood events separate localization of dam outflows from streamflow measurements by assuming the dam grids to be only related to their downstream grids shows potential in improving prediction at locations near the dams themselves while minimizing disruptions at long distances keywords distributed hydrological model ensemble kalman filter data assimilation localization dam outflow measurements human control 1 introduction accurate flood prediction is critical for saving lives and supporting sustainable development although considerable advances have been made in flood forecasting prediction capabilities are still lacking owing to the uncertainties originating from simulation models observations and forcing data among others noh et al 2013 data assimilation da techniques which provide a framework to merge the model and observations conditioned on their respective uncertainties pathiraja et al 2018 are used extensively in hydrology to address this issue the state update achieved through da has been shown to be effective in improving model performance e g chen et al 2013 clark et al 2008 komma et al 2008 mcmillan et al 2013 noh et al 2014 reichle et al 2002 revel et al 2019 trudel et al 2014 weerts and el serafy 2006 and others as an extension studies have also shown the usefulness of da in updating model parameters e g liu et al 2017 moradkhani et al 2005 noh et al 2011 samuel et al 2014 vrugt et al 2006 xie and zhang 2010 and others da methods can be typically classified as a objective analysis methods and b time dependent methods sun et al 2016 while objective analysis methods such as the variational assimilation algorithms aim to minimize the error between the observation field and the background field usually a temporal snapshot by fusing the new observations into the background time dependent methods such as the ensemble kalman filter use a probabilistic framework and estimate the system state sequentially by propagating information forward in time sun et al 2016 essentially the variational methods update the first guess model by propagating information backward in time and the sequential methods update the model states when the observations become available liu and gupta 2007 the kalman filter kf kalman 1960 is an optimal sequential data assimilation technique for linear model and gaussian errors however to cater to the nonlinear processes of nature variations of the kalman filter such as the extended kalman filter ekf and the ensemble kalman filter enkf have been developed evensen 2003 the ekf involves constructing local linear approximations of the nonlinear operators at each da step to make the filtering problem amenable to the typical kf liu and gupta 2007 but may lead to instabilities and divergence due to the approximations arising from neglecting the higher order derivatives evensen 2003 the enkf addresses this problem by working on the monte carlo generation of the model states and approximating the required statistics from these ensembles its simplicity ease of implementation and affordable computational requirements have made the enkf popular in the field of earth sciences evensen 2003 as such the enkf and its variants have been the topic of extensive study in the field of hydrology as well e g clark et al 2008 khaniya et al 2020 maxwell et al 2018 moradkhani et al 2005 paiva et al 2013 rakovec et al 2012 wongchuig et al 2021 and others in distributed hydrological modeling streamflow measurements and soil moisture data both in situ and remotely sensed are commonly used for assimilation with the enkf of the two discharge observations are more readily available and therefore offer more advantages in rainfall runoff improvement because of their reliability and direct relation to streamflow modeling liu et al 2016 clark et al 2008 used streamflow observations to successfully update distributed hydrological model states with a variant of the enkf which avoids perturbing the observations through the use of both synthetic and real data rakovec et al 2012 analyzed the effects of the updating frequency and observation density on enkf performance and found that increasing the number of assimilated observations led to more improvement in forecasts compared to increasing the updating frequency noh et al 2013 used streamflow measurements in a real world case to update the model states in a lag time window framework to account for the routing time lag issue liu et al 2016 also used both the synthetic and real data experiments to demonstrate the benefits of assimilating streamflow observations into a distributed hydrological model with the enkf in addition to streamflow observations outflow measurements from dams and reservoirs in basins with human interventions are as common however the impact of including such observations in the assimilation framework on prediction performance remains mostly unexplored clark et al 2008 reported the issue of large updates to state variables at distant locations with streamflow observation assimilation localization is a commonly used method for reducing the spurious correlations that arise in the enkf when the ensemble of model states cannot properly describe the correlations rasmussen et al 2015 it can also be used to remove connections between physically distant locations wongchuig et al 2021 localization techniques used in hydrological data assimilation include both distance based and adaptive approaches rasmussen et al 2015 compared these two approaches in an integrated hydrological modeling framework with the ensemble transform kalman filter etkf and found the latter to be superior wongchuig et al 2021 used a non euclidean distance based localization approach with a semi distributed hydrological model revel et al 2019 also used the localized etkf to demonstrate the benefits of using physically based localization parameters the localization patches in this case were derived based on semi variogram analysis of long term historical data and performed better than the traditional euclidean based localization recently el gharamti et al 2021 also reported improved performance from using a topologically based localization that propagates information along the stream compared to the euclidean approach despite these efforts identifying efficient localization approaches for distributed hydrological modeling remains an important research topic this study investigates the impact of assimilating dam outflow observations with the enkf in a distributed hydrological model setup since these observations are not representative of the natural flow in the catchment but rather the measures of human control different distance based localization approaches are compared for their efficacy in improving flood prediction the localization weights are calculated based on the euclidean flow accumulation and river grid distance general applicability of the localization approaches is also tested by excluding the dam outflow measurements from the assimilation setup furthermore localization specific to dam outflow measurements where the dam information only affects the grids located downstream is also included this study is therefore conducted with the intention of i evaluating the effect of assimilating a measure of human control i e dam outflow observations on enkf performance ii comparing the efficacy of four distance based localization approaches for different noise settings number of assimilated stations and flood events and iii assessing the suitability of a localization method tailored for dam outflow assimilation the experiments are carried out with real world data only for short term streamflow modeling and are applied to a fast responding small scale catchment in japan the remainder of this paper is organized as follows section 2 introduces the study area and data used in this study along with the hydrological model ensemble kalman filter and corresponding noise models this section also details the localization approaches and experimental setups for the tests conducted in the study the results of the experiments are summarized and discussed in section 3 with the conclusions provided in section 4 2 materials and methods 2 1 study area and data a hydrological prediction system with a physically based distributed model and the ensemble kalman filter is applied to the kizu river basin a mountainous catchment located in central japan fig 1 draining approximately 1594 km2 of the larger yodo river basin the catchment merges with the katsura river basin at the southwestern edge of kyoto and osaka to discharge into the osaka bay the basin receives an average annual precipitation of approximately 1600 mm and has high flow during the typhoon season from september to october there are five multi purpose dams and one retarding basin within the catchment of the eight observation stations and five dams utilized in the study one observation station and four dams are in the nabari river and its tributaries approximately 40 contribution to the total drainage area one dam is in the nunome river approximately 5 contribution and the rest are in the kizu river itself and its upstream tributaries the topography information required for distributed modeling is based on the 30 second digital elevation model and flow direction data available from hydrological data and maps based on shuttle elevation derivatives at multiple scales hydrosheds lehner et al 2008 the filter is applied to two flood events in the basin the 2013 typhoon of september 15 21 and the 2018 heavy rainfall of july 04 13 gridded precipitation input also called the radar rain gauge analyzed precipitation product is obtained for both these events from the japan meteorological agency jma this product is prepared through the calibration of one hour accumulated radar echo data with the rain gauge precipitation accumulated over the same duration and provides precipitation estimation in areas lacking rain gauges nagata 2015 precipitation information is available for every 30 minute interval at a resolution of 45 30 gauged streamflow observations and the measurements related to dam operation are obtained from the ministry of land infrastructure transport and tourism mlit japan mlit record has missing streamflow observations at inooka and its upstream gauging station kamo for the high flow period between 03 00am and 15 00pm of september 16 2013 discharge data at these locations are generated by using the existing rating curve equations to extrapolate the recorded stage levels for the 2018 flood one of the upstream gauges has missing observations for most of the flood duration and is therefore only assimilated when data are available 2 2 hydrological model the distributed hydrological model used in this study 1k dhm tachikawa and tanaka 2013 was developed at the hydrology and water resources research laboratory of kyoto university and is based on kinematic wave theory schematic diagram of the modeling process within the hydrological model is shown in fig 2 fig 2 a shows the flow direction data governing the flow movement within the catchment and is generated using the steepest descent algorithm applied to a digital elevation model dem the arrows in the figure therefore indicate the direction of flow movement which is always restricted to a single direction fig 2 b and c show how each grid within the catchment is modeled this open book type catchment representation consists of two rectangular slopes on the sides with a stream in the middle precipitation is the input to the slope components and is unrelated to other grids in the catchment the river which receives the outflow from the slopes routes this inflow along with the inflow from possibly more than one upstream grids to its single downstream grid there are altogether 2255 grids of approximately 900 m 900 m area upstream of the catchment outlet at inooka for the typical case of short term flooding in the study area the model does not account for other hydrological components such as evapotranspiration and groundwater as such the model can be considered as an extension of kinematic wave theory to also include sub surface flows in the slope components i e an integrated kinematic wave model for subsurface flow and overland flows this approach is commonly used in japanese catchments for short term streamflow modeling within the model slope flow is calculated based on a pre defined storage discharge relationship developed by tachikawa et al 2004 for a soil layer assumed to consist of large voids for gravity water and a matrix layer for capillary water flow the equations used for computing the slope runoff are given as 1 h t q x r 2 q v c d c h d c β i f h d c v c d c a h d c i f d c h d v c d c a h d c α h d m i f d h where h q and r are water depth slope discharge per unit width and rainfall intensity respectively furthermore vc is the saturated flow velocity dc is the saturation volumetric moisture content of the matrix layer and β is the exponent parameter describing the relationship between hydraulic conductivity and saturation similarly a is the flow velocity in the large voids in the soil subsurface and α and m are overland flow parameters the three relations in eq 2 thus represent unsaturated flow in the matrix layer saturated subsurface flow and overland flow river flow is routed downstream using the kinematic wave approximation of the shallow water equations 3 a t q x q 4 q α a m where a is the cross sectional area of the river q is the discharge and q is the lateral inflow from slopes these equations are solved using the four point finite difference approximation scheme at those locations where dams or reservoirs are present the open book type catchment model is replaced with the corresponding dam operation rule or a linear reservoir model following equations are used for calculating the dam outflows 5 q q in i f q in q f q f i f q in q f a n d s s max q in i f q in q f a n d s s max where q in is the inflow to the dam s is the current storage q f is the predetermined flood discharge and s max is the dam storage capacity this constant volume discharge scheme is followed by three of the five dams in the basin syorenji murou and hinachi while the remaining two takayama and nunome adopt the constant rate and constant discharge method nakamura and shimatani 2021 for simplicity it is assumed that the operation of the latter two dams is not too dissimilar to the constant volume discharge scheme the flood control operation rules used here are obtained from mlit and were prepared for the corresponding design floods the actual operation however can vary depending on the flood situation severity 2 3 model calibration the 1k dhm model parameters for the study are taken from kobayashi et al 2020 therefore only a short summary of the calibration procedure is provided here the model was calibrated using the sce ua algorithm duan et al 1994 at murou dam for the 2013 typhoon this location was chosen to avoid any interference from dam operation rainfall data used for calibration were the gauged precipitation data from mlit and were interpolated using the nearest neighbor interpolation method the nash sutcliffe efficiency nse measure at the calibration point was obtained as 0 92 these parameters were then validated at hirakata station in the yodo river basin catchment area 7290 km2 for the typhoon lan in 2017 the corresponding nse was obtained as 0 90 this study uses the same set of spatially uniform model parameters for both events without any further tuning 2 4 ensemble kalman filter the ensemble kalman filter evensen 2003 is the monte carlo approximation of the linear kalman filter wherein the probability distribution of the model states is represented using the ensembles generated through the perturbation of one or multiple of model forcings parameters or the states themselves and is corrected based on the measurement uncertainties consider a dynamic state space hydrological system 6 x t b f x t 1 a u t θ ω t and the observation process 7 y t h t x t v t where x t and x t 1 are the model states at times t and t 1 respectively with superscripts b and a denoting the background and analysis forms u t is the forcing data at time t θ is the model parameter set ω t is the system noise at time t and f is the hydrological model furthermore y t is the observation vector at time t h t is the linear operator mapping the states into the observation space and v t is the observation noise for an individual ensemble i the state space equation can be written as 8 x i t b f x i t 1 a u i t θ ω i t ω i t n 0 s here ω i t is the system noise at time t with zero mean and covariance defined in s for an ensemble size of n ens the background state matrix n state n ens is defined as 9 x b x 1 b x 2 b x n ens b for the ensemble mean x b ensemble anomalies are calculated as 10 x i b x i b x b the ensemble anomalies matrix is then 11 x b x 1 b x 2 b x n ens b the background error covariance matrix p b is estimated as 12 p b 1 n ens 1 x b x b t given the ensemble of observations 13 y i y v i v i n 0 r where v i is the measurement noise with zero mean and covariance r and the analysis state vector x i a is 14 x i a x i b k y i hx i b where k is the kalman gain calculated as 15 k p b h t h p b h t r 1 2 4 1 state variables the state vector consists of outflows from the river section in the open book type model discussed in section 2 2 i e q in eq 4 with dams or reservoirs this q is replaced by the outflow calculated using the respective models the total number of state variables is therefore 2255 one for each grid within the basin since streamflow observations are used to update the discharge states directly there is a one to one relationship between the model states and observations the matrix h is hence populated with only ones and zeros one where observations are available and zero where they are not ideally discharges at the discretized river sections within each grid should also be included in the state vector however to reduce the number of state variables discharges at those sections are interpolated by using the grid s own updated outflow and the updates in the upstream grids if the update at the outlet of a grid m is x m up for the background discharge x m b then the updates along the river in this grid are linearly interpolated within the interval x m i n up x m up where 16 x m i n up k 1 u x k up here x k up is the update at the outlet of grid k which flows into the grid m and u is the number of upstream grids 2 4 2 system noise in this study noise in the system is represented by perturbing the forcing i e precipitation and the state variables i e discharge uncertainty in the model parameters have not been considered separately precipitation input is perturbed using a log normal distribution following nijssen and lettenmaier 2004 17 p c 1 β e 2 1 exp ln e 2 1 s p where p c is the corrupted hourly precipitation for the uncorrupted precipitation p s is a spatially correlated standard normal variable e is the relative error and β is the relative bias noise in the state variable ω i is defined as 18 ω i n 0 ε state q state 2 where ε state is the fractional error term for the state q state here the errors ω i are considered to have been drawn from a gaussian distribution of mean 0 and standard deviation equivalent to the magnitude of the state scaled by the fractional error ε state the spatial correlation of both the precipitation and state variable noise is modeled as an exponential decay function given by 19 e l i j λ where l i j is the grid distance between grids i and j in euclidean space and λ is the correlation length in number of grid cells pixels temporal correlations of the errors are not considered for either noise models while it is well known that the success of data assimilation experiments is dependent on the errors in the model and observations accurate information about these errors is generally not available or the errors themselves are difficult to identify chen et al 2013 thiboult and anctil 2015 as a replacement of such knowledge sensitivity tests are often carried out to estimate these error parameters e g chen et al 2013 paiva et al 2013 this study also adopts this methodology and hence the model error parameters namely the precipitation relative error e state variable fractional error ε state and its correlation length λ are tuned through the sensitivity experiments detailed in section 2 6 1 correlation lengths of the precipitation errors are estimated from the semi variograms constructed using the gridded data for the study region and the relative bias β is assumed to be zero for simplicity 2 4 3 observation noise the observation error v i is defined in a similar manner to the noise in the state variables drawn from a normal distribution of mean 0 and scaled standard deviation and is given as 20 v i n 0 ε obs q obs 2 where ε obs is the fractional error term for the observation q obs observation noise spatial correlation has not been considered this approach of noise modeling is common in hydrological data assimilation e g clark et al 2008 paiva et al 2013 rakovec et al 2012 and others as it assigns larger uncertainties to the high flows to account for the uncertainties in discharge rating curves introduced by limited gauging of streamflow during this period clark et al 2008 the observation error scaling ε obs is taken as 0 1 based on previous studies involving streamflow assimilation e g clark et al 2008 2 5 localization the issue of spurious correlations typically occurs with limited size ensembles and applying appropriate localization techniques can help improve model performance while keeping the computational burden at a minimum localization can also be used to remove connections between areas that are not physically related by modifying the background error covariance matrix as dam outflows are the results of human intervention that affect mostly the areas located near these structures localization may be a crucial component of the filter in ensuring its success localization matrix ρ of dimensions n state n state is defined as 21 ρ i j e d i j η where ρ i j is the j th element in the i th row of the matrix ρ d i j is the distance between grids i and j and η is the correlation length then the kalman gain given by eq 15 is computed using the background error matrix p b modified as 22 p b ρ p b where the p b on the right hand side is the same as that computed using eq 12 denotes the element wise schur product and is the assignment operator all the localization approaches applied in this study use a stationary localization matrix ρ that is prepared only once at the beginning of the simulation period the distance d i j between any two grids i and j is defined in four different ways fig 3 i euclidean distance where the distance is calculated following euclidean geometry referred to as euc ii flow accumulation distance where the distance is calculated as the difference in flow accumulation values between these grids referred to as acc iii similar to ii but the grids in different tributaries are considered to be unrelated referred to as acc st and iv river distance where the distance is calculated by counting the number of grids along the river network in the same tributary that separate the two grids referred to as riv since riv localization is akin to measuring the chainage distance along the river network grids with large differences in flow but located close to each other e g grids upstream and downstream of confluence points are considered to be closer in this approach compared to the acc or acc st approaches where distance is calculated based on accumulation number e g fig 3 c and d furthermore for acc st and riv approaches the distances between the grids in different tributaries are not defined and as such the corresponding entries in the covariance matrix are changed to zero the riv localization is similar to the one proposed by el gharamti et al 2021 which localizes the covariance matrix along the river stream localization approach applicable only to dam outflow assimilation is also tested in the study this approach applies localization based on flow accumulation values only to the downstream of the dams assuming that the dams are unrelated to the grids located upstream furthermore the dam grids do not receive updates from any of the other assimilated observations this implies that the relationship between the dam grids and the downstream grids is asymmetric and is also reflected as such in the covariance matrix the asymmetry of the localized covariance matrix p b is not problematic as it is never explicitly used in the ensemble kalman filter equations however asymmetry of the matrix hp b h t may render the matrix hp b h t r non invertible this can be precluded by forcing the matrix hp b h t to be symmetric by changing all the entries corresponding to the cross covariances with the dam grids to zero this means that even the observations downstream of the dams are considered to be unrelated to the dam outflow observations for the purpose of calculating the gain matrix correlation structure for dam localization for the localization length of 2255 is shown in fig 4 experiments related to the localized implementation are described in section 2 6 3 2 6 experimental setup three sets of experiments are included in this study i experiments with different system noise models for enkf parameter tuning ii assimilation of dam outflow measurements and iii localization the first set of experiments is carried out to determine the best parameters for filter implementation whereas the second set is intended to investigate the impact of assimilating dam outflow observations on filter performance both these sets are the standard implementations of the enkf without localization the last set of experiments is the localized implementation of the filter and tests whether localization can improve prediction by removing spurious correlations all the experiments are carried out with 16 ensembles with observations assimilated every hour although the ensemble size is an important factor controlling the filter performance as it affects the sampling errors this ensemble size is chosen to keep the computational burden reasonably low this is also based on the results from khaniya et al 2020 which reported improved prediction at short lead times with the ensemble of size 16 in another basin in japan 2 6 1 tuning of model noise parameters the experimental setup is shown in table 1 the observation error scaling ε obs is fixed at 0 1 while the model error scaling ε state eq 18 is varied in the range of 0 01 to 0 3 these settings are repeated for different input errors e ranging from 0 01 to 0 75 correlation lengths for these errors are taken as 50 and 75 grid cells for the 2013 and 2018 events respectively based on semi variogram inspection the correlation of state variable perturbations is modeled as given by eq 19 with correlation lengths λ of 1 5 25 and 100 grid cells one grid is approximately of size 900 m 900 m observation errors are not considered to be correlated these sensitivity experiments are conducted for both the events by assimilating five streamflow gauges and inflows to the five dams within the basin refer to fig 1 these are collectively referred to as assimilated stations three gauging stations at different locations in the basin i e inooka nabari and shimagahara are not used for assimilation and are considered only for evaluation they are collectively referred to as validation stations and are consistent across all the experiments carried out in this study 2 6 2 impact of assimilating dam outflow measurements after selecting the parameters for enkf implementation the effect of including dam outflow measurements in the assimilation setup is tested for both the events for two noise settings e 0 75 ε state 0 01 λ 1 and e 0 75 ε state 0 1 λ 100 refer to section 3 1 for discussion on noise parameter selection the number of assimilated stations is therefore increased to 15 with five additional outflow measurements for each of the five dams in the basin 2 6 3 localization the experimental setup for the localization implementation is shown in table 2 different correlation lengths η are defined for the tested localization approaches and experiments are carried out for the two noise settings e 0 75 ε state 0 01 λ 1 and e 0 75 ε state 0 1 λ 100 the results of these experiments are then compared with the ensemble open loop simulation i e no assimilation the ensemble open loop or enol differs from the deterministic off line simulation as the latter is a single model simulation without any correction from the filter whereas the former is a probabilistic run without assimilation to facilitate comparison among different localization approaches simulations are started with the same seed for random number generation which ensures consistency in the input and state variable perturbations 2 6 3 1 comparison of different localization approaches this set of experiments compares different distance based localization approaches for the two noise settings while varying the number and type of assimilated stations the first assimilation scenario involves assimilating all the available observations which amounts to 15 stations in total five dam inflow measurements five dam outflow measurements and five streamflow observations the second scenario involves assimilating only the streamflow observations and dam inflow measurements ten in total the third scenario involves the assimilation of only the three upstream gauges i e the inflows to the dams syorenji murou and hinachi 2 6 3 2 localization of dam outflow measurements this experiment set is conducted only for the 2013 flood because of the significant changes induced by dam operation on the flow hydrograph while all 15 observations are assimilated it is assumed that dam outflows can be treated differently from the streamflow including the dam inflow observations therefore the entries in the covariance matrix that are related to these ten observations are localized using the distance based approach whereas those that relate to the dam observations are localized only in the downstream direction by cutting off their relationship with the grids upstream section 2 5 to this end only the localization length that gives the best performance at the basin outlet when ten observations are assimilated is selected and different correlation lengths 1 25 50 100 250 750 and 2255 for dam outflow localization are tested in other words the correlation length for streamflow observation localization is fixed while varying the correlation length for dam outflow observation localization 2 7 evaluation measures for evaluation two metrics namely the root mean square error rmse and the normalized error reduction index ner are used they are given as 23 rmse t 1 t x t y t 2 t 24 ner 100 1 rms e enkf rms e base where x t and y t are the t th model forecast and observation respectively for the time series of length t i e the simulation duration the rmse ranges from 0 to with values close to zero indicating better performance and the ner ranges from to 100 with values greater than 0 indicative of improvement in prediction in relation to the base simulation the base simulation in this study corresponds to the deterministic off line simulation without assimilation unless otherwise indicated 3 results and discussion 3 1 tuning of model noise parameters the sensitivity of the filter performance to different noise parameters i e rainfall perturbation error e state variable fractional error ε state and its correlation length λ for the 2013 typhoon and 2018 heavy rainfall is shown in fig 5 note that the correlation lengths of the input errors are fixed at 50 and 75 grid cells for these two events λ is plotted in the horizontal axis while ε state is in the vertical axis and each column represents different input perturbation e average ner values for the relevant stations calculated for the ensemble mean time series are indicated in the bins for assimilated stations top rows it is the average of ten stations and for validation stations bottom rows it is the average of three stations texts within the bins indicate the number of stations where the ner is positive bins where the texts indicate 10 for assimilated stations or 3 for validation stations therefore correspond to those cases where all the evaluated stations have positive ner it is clear that the filter performance tends to improve as the input error e increases with the best results seen for the highest e 0 75 for both assimilated and validation stations this could be because other uncertainties in hydrological modeling are not considered explicitly in the study except for state perturbation thus the larger input uncertainty compensates for this limitation this has also been discussed by thiboult and anctil 2015 who note that the enkf error parameters tend to be unintuitive when other error components are not disentangled therefore it should be noted that such a large error in the input data while better suited for assimilation purposes may not be representative of the actual errors in the precipitation product for assimilated stations the performance is less sensitive to the state variable perturbation and its correlation length compared to the validation stations filter updates at these assimilated locations are mostly controlled by the observations available at the same grids where the performances are evaluated however for validation stations observations are unavailable at those points therefore the updates are controlled by their covariances with the observation grids as such performances at the validation locations degrade for higher ε state and smaller λ likely owing to the larger and inconsistent updates related to the magnitude and sign of the kalman gain as the sign of the gain can vary even in close locations with weak correlations increasing λ avoids sharp variations in filter updates especially with larger ε state leading to improved prediction as well as less oscillatory hydrographs for both the events while higher values of ε state provide the best performance at the assimilated stations the ner at the validation stations are usually less than zero in these cases meaning that the performance is worse than that of the deterministic simulation therefore two noise settings e 0 75 ε state 0 01 λ 1 and e 0 75 ε state 0 1 λ 100 are chosen for the remainder of the study as they provide satisfactory results at all the assimilated and most of the validation stations 3 2 assimilating dam outflow measurements fig 6 shows the effect of assimilating the dam outflow measurements at the three validation stations rows for the two noise settings columns for the 2013 event the number in the top right corner of each panel shows the ner where the base rmse is taken for the case without dam outflow assimilation with which the case with dam outflow assimilation is evaluated a positive ner therefore indicates improvement due to dam outflow assimilation compared to when dam outflows are not assimilated and a negative ner indicates the opposite fig 7 shows the same results for the 2018 flood the impact of dam assimilation at all the locations in the basin can be observed in fig 8 assimilation of dam outflow measurements generally has a positive impact at the location close to the dam i e nabari but tends to degrade performance at distant locations e g inooka the basin outlet the degradation of performance near the outlet is magnified when correlated errors with larger magnitude of state variable perturbations are used e g noise configuration e 0 75 ε state 0 1 λ 100 for the 2013 flood furthermore the deleterious updates are also related to the dam operation in real time or in other words when abrupt changes in flows are caused by either sudden storage or release of flows from the dams filter performance tends to be affected this is the reason for the more severe performance degradation for the 2013 flood compared to the 2018 event for the 2013 flood noise configuration e 0 75 ε state 0 1 λ 100 the results at inooka are particularly worse between september 16 and 17 when the flows are severely underestimated which coincides with sudden changes in flow due to flood control operation in the upstream dams limited flow release from the dams around this period can be seen in fig 9 where the deterministic off line solid line and observed dashed line hydrographs for the five dams in the basin are plotted when spurious correlations exist such operations can have a deleterious impact on the grids where the effects of dam operation may not appear until later the tendency for the flow to be affected by the filter in this period is more pronounced in this noise setting compared to the one with smaller ε state and λ as the former configuration leads to larger covariance between grids resulting in higher gains thus any negative influence is also magnified while this tendency of the filter to be affected at long distances is related to the issue of time lag encountered in hydrological data assimilation the case of dam outflow assimilation is peculiar in the sense that this is mostly affected by the decision making of the dam operator rather than the laws of hydrology this added uncertainty introduced by dam operation may be undesirable for assimilation purposes but quick appraisal of the situation during a flood event is critical in limiting the damages through efficient dam operation as such sudden changes in flows near dams are expected especially during a large event such as the one seen in 2013 however as seen from the results this can have a deleterious impact at distant locations and therefore some localization approaches to contain these spurious correlations between the model states and the dam measurements are explored in the next section 3 3 localization 3 3 1 comparison of different localization approaches table 3 summarizes the best localization methods and lengths levels for the three validation stations for different numbers or types of assimilated stations and noise settings for the 2013 event table 4 shows the same for the 2018 flood for the case where the dam outflow assimilation has the most impact i e noise configuration e 0 75 ε state 0 1 λ 100 for the 2013 flood the deleterious updates at the basin outlet have been removed through localization all four localization approaches significantly improve upon the case with no localization with the most improvement seen for acc st localization as the issue of flows erroneously being reduced is eradicated fig 10 the flood peaks are also better estimated as the spurious correlations in this region are mostly tempered through localization localization improves performance at the other two locations as well with error reduction of as much as 30 and 18 76 compared to assimilation without localization seen at nabari and shimagahara respectively for euc localization however acc st localization slightly increases the rms errors at these two locations the impact of localization on prior covariance can be seen in fig 11 which shows the representative plots of the error covariances between the catchment grids and the hinachi dam outflow i e an individual column of the matrix p b h t for different localization approaches and correlation lengths when no localization is applied fig 11 a the covariances between the dam and the downstream grids are quite high however with localization fig 11 b these covariances are reduced although at different rates with different localization lengths implying that the deleterious updates from dam outflows are tempered at the downstream grids for euc and acc localization approaches as the correlation length increases the localization factors i e the elements of the matrix ρ tend to approach unity which limits the changes to the covariance matrix as such using very high correlation lengths for these two approaches causes the results to be the same as those obtained without localization however for the other two approaches acc st and riv the covariance matrix after localization does not approach the one prior to localization even when the correlation length is increased as the covariances between the grids in the different tributaries are always set to zero regardless of the correlation length more generally localization has a positive impact on assimilation performance in all the tested cases as the rms errors after localization are reduced compared to assimilation without localization in some scenarios however while localization reduces the errors caused by spurious correlations it is unable to improve upon the ensemble open loop simulation e g at inooka for the 2018 flood and at shimagahara for 2013 flood when only the upstream gauges are assimilated for these cases the tested localization methods at best are only able to remove the updates altogether but not extract the information from other stations that would improve the filter efficacy therefore the best performance for these cases tends to approach the open loop scenario for a few of these approaches some localization lengths produced significantly worse results but have been omitted from the tables as the optimal correlation lengths for localization are typically determined via a sensitivity analysis therefore only those that performed the best for the given localization approaches are included here furthermore there is no one superior localization approach or the localization length that is suitable for all noise settings assimilated stations validation locations or events in general better results after localization are obtained with the noise setting with larger and strongly correlated perturbations to the state variables compared to the weakly correlated smaller noise setting this could be due to localization causing the covariances to be too weak when the prior covariances are already small meaning that the updates corresponding to the true correlations are also removed one of the exceptions to this is seen at shimagahara for the 2013 flood for three stations assimilated where the best results after assimilation are the same as the ensemble open loop performance for which the weakly correlated noise with smaller state variable perturbation has a lower rmse the best results therefore correspond to the cases where the covariances between grids in different tributaries are set to zero i e acc st and riv or approach zero due to very small localization length euc with low localization level as all the observations assimilated stations are located in a different tributary this indicates possible issues with information transfer to ungauged basins however the same is not observed for the 2018 flood for this event even for only three stations assimilated euc and acc localization are able to improve upon both the open loop simulation and assimilation without localization here the rms errors are again smaller for the larger state variable perturbation the discussions that follow therefore focus only on the noise configuration e 0 75 ε state 0 1 λ 100 the best localization approach is also not necessarily the same for different numbers of assimilated stations for example for the 2013 flood the best localization approaches for improving performance at inooka are acc st with medium localization level when all 15 observations are assimilated riv with medium localization level for ten stations assimilated and acc st with medium localization level for three stations assimilated for the 2018 flood these correspond to riv with low localization level for 15 stations assimilated and euc with low localization level for the latter two similarly the most suitable localization level i e correlation length can also vary depending on the location e g for the 2013 flood when ten stations are assimilated the best localization levels for acc st are high medium low and medium at inooka nabari and shimagahara respectively although this can be ameliorated to some extent through extensive sensitivity analysis it may be beneficial to use different localization lengths for different observation stations nevertheless even if such an approach of spatially heterogeneous localization length is adopted localization parameters tuned through sensitivity experiments may cause issues during operational forecasting in real time as sudden malfunction of observation gauges can lead to missing information and previously determined localization lengths may no longer be optimal as a result adaptive localization approaches that obviate the need for conducting sensitivity experiments for parameter tuning should be developed to facilitate the integration of these filtering algorithms into real time forecasting systems it is also noteworthy that the performance of the euclidean approach euc is comparable to other approaches based on the river network structure i e acc acc st or riv for the tested localization lengths for example as can be seen from tables 3 and 4 euc localization outperforms the other approaches including no localization in 13 out of the 36 total cases of these 13 cases however 12 are for the two gauging stations with smaller upstream areas seven at shimagahara and five at nabari whereas only one is for the outlet station i e inooka where either the acc st or riv localizations are superior this is possibly because for small catchments where the basin response time is short precipitation which is governed by the euclidean distance plays a very important role and as such even the traditional euclidean approach performs well nevertheless since any localization implementation is bound to be case specific different patterns may be revealed depending on the application region and or methodology e g el gharamti et al 2021 revel et al 2019 3 3 2 localization of dam outflow measurements returning to the 2013 flood for the noise configuration e 0 75 ε state 0 1 λ 100 it is seen that rmse after localization at inooka for ten assimilated stations is smaller than the rmse after localization for 15 assimilated stations table 3 as the five additional stations are all related to dam outflows this indicates that treating the dam outflow measurements the same as the streamflow measurements in this case to find the best localization approach length has also denied the areas near the outlet of the correct filter updates on the other hand opposite behavior is observed at nabari which is located near the three upstream dams as the rmse after localization for 15 stations assimilated is smaller at this location compared to ten stations assimilated therefore if it is assumed that the localization implementation is constrained by having to choose a single optimal parameter η i e the correlation length for the whole basin some compromise has to be found in order to balance the filter performance at these two locations this assumption is not unrealistic as using a single localization parameter at the basin scale is common in hydrological data assimilation e g el gharamti et al 2021 khaki et al 2018 wongchuig et al 2021 one approach to achieving this compromise could be to select the best correlation length for the catchment outlet for localization with ten assimilated stations and use a different method of localization specific to dams to update the state variables in their vicinity as such medium localization level for euc acc and riv localization and high localization level for acc st localization are selected and the dam outflow measurements are localized separately the expectation from this method is that the performance at inooka should be similar to the best result at inooka achieved with the localization length that is optimized for this location for the case with ten assimilated stations and the performance at nabari should approach that achieved with the localization length optimized for nabari itself for the case with 15 assimilated stations fig 12 shows the results for 15 stations assimilated where the ten streamflow gauges are localized using the distance based method and the five dam outflow measurements are localized using the dam localization approach correlation lengths for dam outflow localization are on the horizontal axis and the points represent the corresponding rms errors the red dotted lines indicate the rmse for ten stations assimilated case for the localization length optimized for inooka and the blue dotted lines indicate the rmse for the localization length optimized for nabari when all 15 stations are assimilated for all localization approaches the rmses at nabari have decreased compared to localization with only ten stations assimilated except for very high dam localization lengths e g 2255 for acc st and riv increasing the dam localization length also affects performance at the basin outlet in general smaller dam localization lengths tend to improve performance at nabari while keeping the rmses at inooka mostly unchanged for such small lengths the filter performance at shimagahara is also similar to the performance obtained from the localization of only the ten streamflow observation stations esp acc st and riv however for the tested lengths none of the results at nabari match the blue line i e the rms error obtained for the length optimized for nabari when all 15 stations are assimilated this is likely because dam localization i e localization only in the downstream direction is applied for the entire duration of the flood rather than for just the dam operation period nevertheless these results indicate that the dam localization approach used here has the potential to be used for improving filter performance immediately downstream of dams without affecting performance at very distant locations 4 conclusions this study investigated the effect of assimilating dam outflow measurements on ensemble kalman filter performance in a distributed hydrological model applied to a small scale catchment experiments with different system noise models parameterized by precipitation relative error model state fractional error scaling and state error correlation lengths were first performed to determine the best enkf parameters the efficacy of data assimilation increased with increasing magnitude of precipitation error while the magnitude and the correlation of the state variable perturbations were important in improving assimilation performance at grids where observations were not available at these locations the filter performance improved and the sensitivity to the state error fractional term was also reduced with increasing state error correlation length as the issue of inconsistent spatial noise structure over the basin was resolved assimilating dam outflow observations led to deleterious updates to the state variables more so when dam operation caused significant changes to the flow and when the state variable perturbations were larger and strongly correlated all four distance based approaches tested in this study were able to limit the impact of these measurements at long hydrological distances as the predictions significantly improved near the basin outlet the issue of deleterious updates was also tempered within the basin however experiments conducted by varying the noise setting number and type of assimilated stations and flood events indicated that there is no single localization approach or the corresponding correlation length that is best for all locations within the basin therefore any localization implementation would benefit from carrying out sensitivity tests beforehand to determine the most suitable localization method the results further highlight the need to develop more sophisticated localization techniques that can adapt themselves to yield the most optimal filter performance independent localization of dam outflow measurements from the streamflow observations was also tested in this study streamflow observations were localized using the traditional distance based approaches and dam outflow observations were assumed to affect only the grids located downstream as such the covariances between the dam grids and their upstream grids were set to zero while an exponential decay function was used to calculate the localization weight for the downstream grids the distance for calculating this weight was based on the flow accumulation values of the grids such separate treatment of dam outflows showed potential for improving predictions at locations near the dams themselves using this approach during the period of dam operation therefore can limit the deleterious updates to the state variables at distant locations and help avoid filter degradation future studies are expected to utilize these insights to develop more robust localization approaches that ensure that the filter updates are consistent with the hydrology of the catchment credit authorship contribution statement manoj khaniya conceptualization methodology software visualization writing original draft yasuto tachikawa supervision conceptualization methodology software writing review editing yutaka ichikawa conceptualization resources kazuaki yorozu conceptualization resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the council for science technology and innovation csti of japan cross ministerial strategic innovation promotion program sip enhancement of national resilience against natural disasters funding agency national research institute for earth science and disaster resilience nied 
3493,this paper presents an investigation on the effect of dam operation on the ensemble kalman filter enkf performance in a distributed hydrological model based on kinematic wave theory for this purpose two flood events in a mountainous catchment in japan are selected and the model error parameters for the enkf implementation are first determined through a series of experiments by varying the input error magnitude state variable perturbation and its correlation length then through the assimilation of dam outflow observations it is shown that special treatment of such measurements is critical in ensuring the success of the filter when flood control operation significantly changes the flow hydrograph and when the covariances between distant grids are high localization methods based on euclidean distance flow accumulation values and river distance are all able to limit the deleterious updates to model states at distant grids and improve filter efficacy however no single localization approach is found to be consistently optimal for varying noise configurations number and type of assimilated stations or flood events separate localization of dam outflows from streamflow measurements by assuming the dam grids to be only related to their downstream grids shows potential in improving prediction at locations near the dams themselves while minimizing disruptions at long distances keywords distributed hydrological model ensemble kalman filter data assimilation localization dam outflow measurements human control 1 introduction accurate flood prediction is critical for saving lives and supporting sustainable development although considerable advances have been made in flood forecasting prediction capabilities are still lacking owing to the uncertainties originating from simulation models observations and forcing data among others noh et al 2013 data assimilation da techniques which provide a framework to merge the model and observations conditioned on their respective uncertainties pathiraja et al 2018 are used extensively in hydrology to address this issue the state update achieved through da has been shown to be effective in improving model performance e g chen et al 2013 clark et al 2008 komma et al 2008 mcmillan et al 2013 noh et al 2014 reichle et al 2002 revel et al 2019 trudel et al 2014 weerts and el serafy 2006 and others as an extension studies have also shown the usefulness of da in updating model parameters e g liu et al 2017 moradkhani et al 2005 noh et al 2011 samuel et al 2014 vrugt et al 2006 xie and zhang 2010 and others da methods can be typically classified as a objective analysis methods and b time dependent methods sun et al 2016 while objective analysis methods such as the variational assimilation algorithms aim to minimize the error between the observation field and the background field usually a temporal snapshot by fusing the new observations into the background time dependent methods such as the ensemble kalman filter use a probabilistic framework and estimate the system state sequentially by propagating information forward in time sun et al 2016 essentially the variational methods update the first guess model by propagating information backward in time and the sequential methods update the model states when the observations become available liu and gupta 2007 the kalman filter kf kalman 1960 is an optimal sequential data assimilation technique for linear model and gaussian errors however to cater to the nonlinear processes of nature variations of the kalman filter such as the extended kalman filter ekf and the ensemble kalman filter enkf have been developed evensen 2003 the ekf involves constructing local linear approximations of the nonlinear operators at each da step to make the filtering problem amenable to the typical kf liu and gupta 2007 but may lead to instabilities and divergence due to the approximations arising from neglecting the higher order derivatives evensen 2003 the enkf addresses this problem by working on the monte carlo generation of the model states and approximating the required statistics from these ensembles its simplicity ease of implementation and affordable computational requirements have made the enkf popular in the field of earth sciences evensen 2003 as such the enkf and its variants have been the topic of extensive study in the field of hydrology as well e g clark et al 2008 khaniya et al 2020 maxwell et al 2018 moradkhani et al 2005 paiva et al 2013 rakovec et al 2012 wongchuig et al 2021 and others in distributed hydrological modeling streamflow measurements and soil moisture data both in situ and remotely sensed are commonly used for assimilation with the enkf of the two discharge observations are more readily available and therefore offer more advantages in rainfall runoff improvement because of their reliability and direct relation to streamflow modeling liu et al 2016 clark et al 2008 used streamflow observations to successfully update distributed hydrological model states with a variant of the enkf which avoids perturbing the observations through the use of both synthetic and real data rakovec et al 2012 analyzed the effects of the updating frequency and observation density on enkf performance and found that increasing the number of assimilated observations led to more improvement in forecasts compared to increasing the updating frequency noh et al 2013 used streamflow measurements in a real world case to update the model states in a lag time window framework to account for the routing time lag issue liu et al 2016 also used both the synthetic and real data experiments to demonstrate the benefits of assimilating streamflow observations into a distributed hydrological model with the enkf in addition to streamflow observations outflow measurements from dams and reservoirs in basins with human interventions are as common however the impact of including such observations in the assimilation framework on prediction performance remains mostly unexplored clark et al 2008 reported the issue of large updates to state variables at distant locations with streamflow observation assimilation localization is a commonly used method for reducing the spurious correlations that arise in the enkf when the ensemble of model states cannot properly describe the correlations rasmussen et al 2015 it can also be used to remove connections between physically distant locations wongchuig et al 2021 localization techniques used in hydrological data assimilation include both distance based and adaptive approaches rasmussen et al 2015 compared these two approaches in an integrated hydrological modeling framework with the ensemble transform kalman filter etkf and found the latter to be superior wongchuig et al 2021 used a non euclidean distance based localization approach with a semi distributed hydrological model revel et al 2019 also used the localized etkf to demonstrate the benefits of using physically based localization parameters the localization patches in this case were derived based on semi variogram analysis of long term historical data and performed better than the traditional euclidean based localization recently el gharamti et al 2021 also reported improved performance from using a topologically based localization that propagates information along the stream compared to the euclidean approach despite these efforts identifying efficient localization approaches for distributed hydrological modeling remains an important research topic this study investigates the impact of assimilating dam outflow observations with the enkf in a distributed hydrological model setup since these observations are not representative of the natural flow in the catchment but rather the measures of human control different distance based localization approaches are compared for their efficacy in improving flood prediction the localization weights are calculated based on the euclidean flow accumulation and river grid distance general applicability of the localization approaches is also tested by excluding the dam outflow measurements from the assimilation setup furthermore localization specific to dam outflow measurements where the dam information only affects the grids located downstream is also included this study is therefore conducted with the intention of i evaluating the effect of assimilating a measure of human control i e dam outflow observations on enkf performance ii comparing the efficacy of four distance based localization approaches for different noise settings number of assimilated stations and flood events and iii assessing the suitability of a localization method tailored for dam outflow assimilation the experiments are carried out with real world data only for short term streamflow modeling and are applied to a fast responding small scale catchment in japan the remainder of this paper is organized as follows section 2 introduces the study area and data used in this study along with the hydrological model ensemble kalman filter and corresponding noise models this section also details the localization approaches and experimental setups for the tests conducted in the study the results of the experiments are summarized and discussed in section 3 with the conclusions provided in section 4 2 materials and methods 2 1 study area and data a hydrological prediction system with a physically based distributed model and the ensemble kalman filter is applied to the kizu river basin a mountainous catchment located in central japan fig 1 draining approximately 1594 km2 of the larger yodo river basin the catchment merges with the katsura river basin at the southwestern edge of kyoto and osaka to discharge into the osaka bay the basin receives an average annual precipitation of approximately 1600 mm and has high flow during the typhoon season from september to october there are five multi purpose dams and one retarding basin within the catchment of the eight observation stations and five dams utilized in the study one observation station and four dams are in the nabari river and its tributaries approximately 40 contribution to the total drainage area one dam is in the nunome river approximately 5 contribution and the rest are in the kizu river itself and its upstream tributaries the topography information required for distributed modeling is based on the 30 second digital elevation model and flow direction data available from hydrological data and maps based on shuttle elevation derivatives at multiple scales hydrosheds lehner et al 2008 the filter is applied to two flood events in the basin the 2013 typhoon of september 15 21 and the 2018 heavy rainfall of july 04 13 gridded precipitation input also called the radar rain gauge analyzed precipitation product is obtained for both these events from the japan meteorological agency jma this product is prepared through the calibration of one hour accumulated radar echo data with the rain gauge precipitation accumulated over the same duration and provides precipitation estimation in areas lacking rain gauges nagata 2015 precipitation information is available for every 30 minute interval at a resolution of 45 30 gauged streamflow observations and the measurements related to dam operation are obtained from the ministry of land infrastructure transport and tourism mlit japan mlit record has missing streamflow observations at inooka and its upstream gauging station kamo for the high flow period between 03 00am and 15 00pm of september 16 2013 discharge data at these locations are generated by using the existing rating curve equations to extrapolate the recorded stage levels for the 2018 flood one of the upstream gauges has missing observations for most of the flood duration and is therefore only assimilated when data are available 2 2 hydrological model the distributed hydrological model used in this study 1k dhm tachikawa and tanaka 2013 was developed at the hydrology and water resources research laboratory of kyoto university and is based on kinematic wave theory schematic diagram of the modeling process within the hydrological model is shown in fig 2 fig 2 a shows the flow direction data governing the flow movement within the catchment and is generated using the steepest descent algorithm applied to a digital elevation model dem the arrows in the figure therefore indicate the direction of flow movement which is always restricted to a single direction fig 2 b and c show how each grid within the catchment is modeled this open book type catchment representation consists of two rectangular slopes on the sides with a stream in the middle precipitation is the input to the slope components and is unrelated to other grids in the catchment the river which receives the outflow from the slopes routes this inflow along with the inflow from possibly more than one upstream grids to its single downstream grid there are altogether 2255 grids of approximately 900 m 900 m area upstream of the catchment outlet at inooka for the typical case of short term flooding in the study area the model does not account for other hydrological components such as evapotranspiration and groundwater as such the model can be considered as an extension of kinematic wave theory to also include sub surface flows in the slope components i e an integrated kinematic wave model for subsurface flow and overland flows this approach is commonly used in japanese catchments for short term streamflow modeling within the model slope flow is calculated based on a pre defined storage discharge relationship developed by tachikawa et al 2004 for a soil layer assumed to consist of large voids for gravity water and a matrix layer for capillary water flow the equations used for computing the slope runoff are given as 1 h t q x r 2 q v c d c h d c β i f h d c v c d c a h d c i f d c h d v c d c a h d c α h d m i f d h where h q and r are water depth slope discharge per unit width and rainfall intensity respectively furthermore vc is the saturated flow velocity dc is the saturation volumetric moisture content of the matrix layer and β is the exponent parameter describing the relationship between hydraulic conductivity and saturation similarly a is the flow velocity in the large voids in the soil subsurface and α and m are overland flow parameters the three relations in eq 2 thus represent unsaturated flow in the matrix layer saturated subsurface flow and overland flow river flow is routed downstream using the kinematic wave approximation of the shallow water equations 3 a t q x q 4 q α a m where a is the cross sectional area of the river q is the discharge and q is the lateral inflow from slopes these equations are solved using the four point finite difference approximation scheme at those locations where dams or reservoirs are present the open book type catchment model is replaced with the corresponding dam operation rule or a linear reservoir model following equations are used for calculating the dam outflows 5 q q in i f q in q f q f i f q in q f a n d s s max q in i f q in q f a n d s s max where q in is the inflow to the dam s is the current storage q f is the predetermined flood discharge and s max is the dam storage capacity this constant volume discharge scheme is followed by three of the five dams in the basin syorenji murou and hinachi while the remaining two takayama and nunome adopt the constant rate and constant discharge method nakamura and shimatani 2021 for simplicity it is assumed that the operation of the latter two dams is not too dissimilar to the constant volume discharge scheme the flood control operation rules used here are obtained from mlit and were prepared for the corresponding design floods the actual operation however can vary depending on the flood situation severity 2 3 model calibration the 1k dhm model parameters for the study are taken from kobayashi et al 2020 therefore only a short summary of the calibration procedure is provided here the model was calibrated using the sce ua algorithm duan et al 1994 at murou dam for the 2013 typhoon this location was chosen to avoid any interference from dam operation rainfall data used for calibration were the gauged precipitation data from mlit and were interpolated using the nearest neighbor interpolation method the nash sutcliffe efficiency nse measure at the calibration point was obtained as 0 92 these parameters were then validated at hirakata station in the yodo river basin catchment area 7290 km2 for the typhoon lan in 2017 the corresponding nse was obtained as 0 90 this study uses the same set of spatially uniform model parameters for both events without any further tuning 2 4 ensemble kalman filter the ensemble kalman filter evensen 2003 is the monte carlo approximation of the linear kalman filter wherein the probability distribution of the model states is represented using the ensembles generated through the perturbation of one or multiple of model forcings parameters or the states themselves and is corrected based on the measurement uncertainties consider a dynamic state space hydrological system 6 x t b f x t 1 a u t θ ω t and the observation process 7 y t h t x t v t where x t and x t 1 are the model states at times t and t 1 respectively with superscripts b and a denoting the background and analysis forms u t is the forcing data at time t θ is the model parameter set ω t is the system noise at time t and f is the hydrological model furthermore y t is the observation vector at time t h t is the linear operator mapping the states into the observation space and v t is the observation noise for an individual ensemble i the state space equation can be written as 8 x i t b f x i t 1 a u i t θ ω i t ω i t n 0 s here ω i t is the system noise at time t with zero mean and covariance defined in s for an ensemble size of n ens the background state matrix n state n ens is defined as 9 x b x 1 b x 2 b x n ens b for the ensemble mean x b ensemble anomalies are calculated as 10 x i b x i b x b the ensemble anomalies matrix is then 11 x b x 1 b x 2 b x n ens b the background error covariance matrix p b is estimated as 12 p b 1 n ens 1 x b x b t given the ensemble of observations 13 y i y v i v i n 0 r where v i is the measurement noise with zero mean and covariance r and the analysis state vector x i a is 14 x i a x i b k y i hx i b where k is the kalman gain calculated as 15 k p b h t h p b h t r 1 2 4 1 state variables the state vector consists of outflows from the river section in the open book type model discussed in section 2 2 i e q in eq 4 with dams or reservoirs this q is replaced by the outflow calculated using the respective models the total number of state variables is therefore 2255 one for each grid within the basin since streamflow observations are used to update the discharge states directly there is a one to one relationship between the model states and observations the matrix h is hence populated with only ones and zeros one where observations are available and zero where they are not ideally discharges at the discretized river sections within each grid should also be included in the state vector however to reduce the number of state variables discharges at those sections are interpolated by using the grid s own updated outflow and the updates in the upstream grids if the update at the outlet of a grid m is x m up for the background discharge x m b then the updates along the river in this grid are linearly interpolated within the interval x m i n up x m up where 16 x m i n up k 1 u x k up here x k up is the update at the outlet of grid k which flows into the grid m and u is the number of upstream grids 2 4 2 system noise in this study noise in the system is represented by perturbing the forcing i e precipitation and the state variables i e discharge uncertainty in the model parameters have not been considered separately precipitation input is perturbed using a log normal distribution following nijssen and lettenmaier 2004 17 p c 1 β e 2 1 exp ln e 2 1 s p where p c is the corrupted hourly precipitation for the uncorrupted precipitation p s is a spatially correlated standard normal variable e is the relative error and β is the relative bias noise in the state variable ω i is defined as 18 ω i n 0 ε state q state 2 where ε state is the fractional error term for the state q state here the errors ω i are considered to have been drawn from a gaussian distribution of mean 0 and standard deviation equivalent to the magnitude of the state scaled by the fractional error ε state the spatial correlation of both the precipitation and state variable noise is modeled as an exponential decay function given by 19 e l i j λ where l i j is the grid distance between grids i and j in euclidean space and λ is the correlation length in number of grid cells pixels temporal correlations of the errors are not considered for either noise models while it is well known that the success of data assimilation experiments is dependent on the errors in the model and observations accurate information about these errors is generally not available or the errors themselves are difficult to identify chen et al 2013 thiboult and anctil 2015 as a replacement of such knowledge sensitivity tests are often carried out to estimate these error parameters e g chen et al 2013 paiva et al 2013 this study also adopts this methodology and hence the model error parameters namely the precipitation relative error e state variable fractional error ε state and its correlation length λ are tuned through the sensitivity experiments detailed in section 2 6 1 correlation lengths of the precipitation errors are estimated from the semi variograms constructed using the gridded data for the study region and the relative bias β is assumed to be zero for simplicity 2 4 3 observation noise the observation error v i is defined in a similar manner to the noise in the state variables drawn from a normal distribution of mean 0 and scaled standard deviation and is given as 20 v i n 0 ε obs q obs 2 where ε obs is the fractional error term for the observation q obs observation noise spatial correlation has not been considered this approach of noise modeling is common in hydrological data assimilation e g clark et al 2008 paiva et al 2013 rakovec et al 2012 and others as it assigns larger uncertainties to the high flows to account for the uncertainties in discharge rating curves introduced by limited gauging of streamflow during this period clark et al 2008 the observation error scaling ε obs is taken as 0 1 based on previous studies involving streamflow assimilation e g clark et al 2008 2 5 localization the issue of spurious correlations typically occurs with limited size ensembles and applying appropriate localization techniques can help improve model performance while keeping the computational burden at a minimum localization can also be used to remove connections between areas that are not physically related by modifying the background error covariance matrix as dam outflows are the results of human intervention that affect mostly the areas located near these structures localization may be a crucial component of the filter in ensuring its success localization matrix ρ of dimensions n state n state is defined as 21 ρ i j e d i j η where ρ i j is the j th element in the i th row of the matrix ρ d i j is the distance between grids i and j and η is the correlation length then the kalman gain given by eq 15 is computed using the background error matrix p b modified as 22 p b ρ p b where the p b on the right hand side is the same as that computed using eq 12 denotes the element wise schur product and is the assignment operator all the localization approaches applied in this study use a stationary localization matrix ρ that is prepared only once at the beginning of the simulation period the distance d i j between any two grids i and j is defined in four different ways fig 3 i euclidean distance where the distance is calculated following euclidean geometry referred to as euc ii flow accumulation distance where the distance is calculated as the difference in flow accumulation values between these grids referred to as acc iii similar to ii but the grids in different tributaries are considered to be unrelated referred to as acc st and iv river distance where the distance is calculated by counting the number of grids along the river network in the same tributary that separate the two grids referred to as riv since riv localization is akin to measuring the chainage distance along the river network grids with large differences in flow but located close to each other e g grids upstream and downstream of confluence points are considered to be closer in this approach compared to the acc or acc st approaches where distance is calculated based on accumulation number e g fig 3 c and d furthermore for acc st and riv approaches the distances between the grids in different tributaries are not defined and as such the corresponding entries in the covariance matrix are changed to zero the riv localization is similar to the one proposed by el gharamti et al 2021 which localizes the covariance matrix along the river stream localization approach applicable only to dam outflow assimilation is also tested in the study this approach applies localization based on flow accumulation values only to the downstream of the dams assuming that the dams are unrelated to the grids located upstream furthermore the dam grids do not receive updates from any of the other assimilated observations this implies that the relationship between the dam grids and the downstream grids is asymmetric and is also reflected as such in the covariance matrix the asymmetry of the localized covariance matrix p b is not problematic as it is never explicitly used in the ensemble kalman filter equations however asymmetry of the matrix hp b h t may render the matrix hp b h t r non invertible this can be precluded by forcing the matrix hp b h t to be symmetric by changing all the entries corresponding to the cross covariances with the dam grids to zero this means that even the observations downstream of the dams are considered to be unrelated to the dam outflow observations for the purpose of calculating the gain matrix correlation structure for dam localization for the localization length of 2255 is shown in fig 4 experiments related to the localized implementation are described in section 2 6 3 2 6 experimental setup three sets of experiments are included in this study i experiments with different system noise models for enkf parameter tuning ii assimilation of dam outflow measurements and iii localization the first set of experiments is carried out to determine the best parameters for filter implementation whereas the second set is intended to investigate the impact of assimilating dam outflow observations on filter performance both these sets are the standard implementations of the enkf without localization the last set of experiments is the localized implementation of the filter and tests whether localization can improve prediction by removing spurious correlations all the experiments are carried out with 16 ensembles with observations assimilated every hour although the ensemble size is an important factor controlling the filter performance as it affects the sampling errors this ensemble size is chosen to keep the computational burden reasonably low this is also based on the results from khaniya et al 2020 which reported improved prediction at short lead times with the ensemble of size 16 in another basin in japan 2 6 1 tuning of model noise parameters the experimental setup is shown in table 1 the observation error scaling ε obs is fixed at 0 1 while the model error scaling ε state eq 18 is varied in the range of 0 01 to 0 3 these settings are repeated for different input errors e ranging from 0 01 to 0 75 correlation lengths for these errors are taken as 50 and 75 grid cells for the 2013 and 2018 events respectively based on semi variogram inspection the correlation of state variable perturbations is modeled as given by eq 19 with correlation lengths λ of 1 5 25 and 100 grid cells one grid is approximately of size 900 m 900 m observation errors are not considered to be correlated these sensitivity experiments are conducted for both the events by assimilating five streamflow gauges and inflows to the five dams within the basin refer to fig 1 these are collectively referred to as assimilated stations three gauging stations at different locations in the basin i e inooka nabari and shimagahara are not used for assimilation and are considered only for evaluation they are collectively referred to as validation stations and are consistent across all the experiments carried out in this study 2 6 2 impact of assimilating dam outflow measurements after selecting the parameters for enkf implementation the effect of including dam outflow measurements in the assimilation setup is tested for both the events for two noise settings e 0 75 ε state 0 01 λ 1 and e 0 75 ε state 0 1 λ 100 refer to section 3 1 for discussion on noise parameter selection the number of assimilated stations is therefore increased to 15 with five additional outflow measurements for each of the five dams in the basin 2 6 3 localization the experimental setup for the localization implementation is shown in table 2 different correlation lengths η are defined for the tested localization approaches and experiments are carried out for the two noise settings e 0 75 ε state 0 01 λ 1 and e 0 75 ε state 0 1 λ 100 the results of these experiments are then compared with the ensemble open loop simulation i e no assimilation the ensemble open loop or enol differs from the deterministic off line simulation as the latter is a single model simulation without any correction from the filter whereas the former is a probabilistic run without assimilation to facilitate comparison among different localization approaches simulations are started with the same seed for random number generation which ensures consistency in the input and state variable perturbations 2 6 3 1 comparison of different localization approaches this set of experiments compares different distance based localization approaches for the two noise settings while varying the number and type of assimilated stations the first assimilation scenario involves assimilating all the available observations which amounts to 15 stations in total five dam inflow measurements five dam outflow measurements and five streamflow observations the second scenario involves assimilating only the streamflow observations and dam inflow measurements ten in total the third scenario involves the assimilation of only the three upstream gauges i e the inflows to the dams syorenji murou and hinachi 2 6 3 2 localization of dam outflow measurements this experiment set is conducted only for the 2013 flood because of the significant changes induced by dam operation on the flow hydrograph while all 15 observations are assimilated it is assumed that dam outflows can be treated differently from the streamflow including the dam inflow observations therefore the entries in the covariance matrix that are related to these ten observations are localized using the distance based approach whereas those that relate to the dam observations are localized only in the downstream direction by cutting off their relationship with the grids upstream section 2 5 to this end only the localization length that gives the best performance at the basin outlet when ten observations are assimilated is selected and different correlation lengths 1 25 50 100 250 750 and 2255 for dam outflow localization are tested in other words the correlation length for streamflow observation localization is fixed while varying the correlation length for dam outflow observation localization 2 7 evaluation measures for evaluation two metrics namely the root mean square error rmse and the normalized error reduction index ner are used they are given as 23 rmse t 1 t x t y t 2 t 24 ner 100 1 rms e enkf rms e base where x t and y t are the t th model forecast and observation respectively for the time series of length t i e the simulation duration the rmse ranges from 0 to with values close to zero indicating better performance and the ner ranges from to 100 with values greater than 0 indicative of improvement in prediction in relation to the base simulation the base simulation in this study corresponds to the deterministic off line simulation without assimilation unless otherwise indicated 3 results and discussion 3 1 tuning of model noise parameters the sensitivity of the filter performance to different noise parameters i e rainfall perturbation error e state variable fractional error ε state and its correlation length λ for the 2013 typhoon and 2018 heavy rainfall is shown in fig 5 note that the correlation lengths of the input errors are fixed at 50 and 75 grid cells for these two events λ is plotted in the horizontal axis while ε state is in the vertical axis and each column represents different input perturbation e average ner values for the relevant stations calculated for the ensemble mean time series are indicated in the bins for assimilated stations top rows it is the average of ten stations and for validation stations bottom rows it is the average of three stations texts within the bins indicate the number of stations where the ner is positive bins where the texts indicate 10 for assimilated stations or 3 for validation stations therefore correspond to those cases where all the evaluated stations have positive ner it is clear that the filter performance tends to improve as the input error e increases with the best results seen for the highest e 0 75 for both assimilated and validation stations this could be because other uncertainties in hydrological modeling are not considered explicitly in the study except for state perturbation thus the larger input uncertainty compensates for this limitation this has also been discussed by thiboult and anctil 2015 who note that the enkf error parameters tend to be unintuitive when other error components are not disentangled therefore it should be noted that such a large error in the input data while better suited for assimilation purposes may not be representative of the actual errors in the precipitation product for assimilated stations the performance is less sensitive to the state variable perturbation and its correlation length compared to the validation stations filter updates at these assimilated locations are mostly controlled by the observations available at the same grids where the performances are evaluated however for validation stations observations are unavailable at those points therefore the updates are controlled by their covariances with the observation grids as such performances at the validation locations degrade for higher ε state and smaller λ likely owing to the larger and inconsistent updates related to the magnitude and sign of the kalman gain as the sign of the gain can vary even in close locations with weak correlations increasing λ avoids sharp variations in filter updates especially with larger ε state leading to improved prediction as well as less oscillatory hydrographs for both the events while higher values of ε state provide the best performance at the assimilated stations the ner at the validation stations are usually less than zero in these cases meaning that the performance is worse than that of the deterministic simulation therefore two noise settings e 0 75 ε state 0 01 λ 1 and e 0 75 ε state 0 1 λ 100 are chosen for the remainder of the study as they provide satisfactory results at all the assimilated and most of the validation stations 3 2 assimilating dam outflow measurements fig 6 shows the effect of assimilating the dam outflow measurements at the three validation stations rows for the two noise settings columns for the 2013 event the number in the top right corner of each panel shows the ner where the base rmse is taken for the case without dam outflow assimilation with which the case with dam outflow assimilation is evaluated a positive ner therefore indicates improvement due to dam outflow assimilation compared to when dam outflows are not assimilated and a negative ner indicates the opposite fig 7 shows the same results for the 2018 flood the impact of dam assimilation at all the locations in the basin can be observed in fig 8 assimilation of dam outflow measurements generally has a positive impact at the location close to the dam i e nabari but tends to degrade performance at distant locations e g inooka the basin outlet the degradation of performance near the outlet is magnified when correlated errors with larger magnitude of state variable perturbations are used e g noise configuration e 0 75 ε state 0 1 λ 100 for the 2013 flood furthermore the deleterious updates are also related to the dam operation in real time or in other words when abrupt changes in flows are caused by either sudden storage or release of flows from the dams filter performance tends to be affected this is the reason for the more severe performance degradation for the 2013 flood compared to the 2018 event for the 2013 flood noise configuration e 0 75 ε state 0 1 λ 100 the results at inooka are particularly worse between september 16 and 17 when the flows are severely underestimated which coincides with sudden changes in flow due to flood control operation in the upstream dams limited flow release from the dams around this period can be seen in fig 9 where the deterministic off line solid line and observed dashed line hydrographs for the five dams in the basin are plotted when spurious correlations exist such operations can have a deleterious impact on the grids where the effects of dam operation may not appear until later the tendency for the flow to be affected by the filter in this period is more pronounced in this noise setting compared to the one with smaller ε state and λ as the former configuration leads to larger covariance between grids resulting in higher gains thus any negative influence is also magnified while this tendency of the filter to be affected at long distances is related to the issue of time lag encountered in hydrological data assimilation the case of dam outflow assimilation is peculiar in the sense that this is mostly affected by the decision making of the dam operator rather than the laws of hydrology this added uncertainty introduced by dam operation may be undesirable for assimilation purposes but quick appraisal of the situation during a flood event is critical in limiting the damages through efficient dam operation as such sudden changes in flows near dams are expected especially during a large event such as the one seen in 2013 however as seen from the results this can have a deleterious impact at distant locations and therefore some localization approaches to contain these spurious correlations between the model states and the dam measurements are explored in the next section 3 3 localization 3 3 1 comparison of different localization approaches table 3 summarizes the best localization methods and lengths levels for the three validation stations for different numbers or types of assimilated stations and noise settings for the 2013 event table 4 shows the same for the 2018 flood for the case where the dam outflow assimilation has the most impact i e noise configuration e 0 75 ε state 0 1 λ 100 for the 2013 flood the deleterious updates at the basin outlet have been removed through localization all four localization approaches significantly improve upon the case with no localization with the most improvement seen for acc st localization as the issue of flows erroneously being reduced is eradicated fig 10 the flood peaks are also better estimated as the spurious correlations in this region are mostly tempered through localization localization improves performance at the other two locations as well with error reduction of as much as 30 and 18 76 compared to assimilation without localization seen at nabari and shimagahara respectively for euc localization however acc st localization slightly increases the rms errors at these two locations the impact of localization on prior covariance can be seen in fig 11 which shows the representative plots of the error covariances between the catchment grids and the hinachi dam outflow i e an individual column of the matrix p b h t for different localization approaches and correlation lengths when no localization is applied fig 11 a the covariances between the dam and the downstream grids are quite high however with localization fig 11 b these covariances are reduced although at different rates with different localization lengths implying that the deleterious updates from dam outflows are tempered at the downstream grids for euc and acc localization approaches as the correlation length increases the localization factors i e the elements of the matrix ρ tend to approach unity which limits the changes to the covariance matrix as such using very high correlation lengths for these two approaches causes the results to be the same as those obtained without localization however for the other two approaches acc st and riv the covariance matrix after localization does not approach the one prior to localization even when the correlation length is increased as the covariances between the grids in the different tributaries are always set to zero regardless of the correlation length more generally localization has a positive impact on assimilation performance in all the tested cases as the rms errors after localization are reduced compared to assimilation without localization in some scenarios however while localization reduces the errors caused by spurious correlations it is unable to improve upon the ensemble open loop simulation e g at inooka for the 2018 flood and at shimagahara for 2013 flood when only the upstream gauges are assimilated for these cases the tested localization methods at best are only able to remove the updates altogether but not extract the information from other stations that would improve the filter efficacy therefore the best performance for these cases tends to approach the open loop scenario for a few of these approaches some localization lengths produced significantly worse results but have been omitted from the tables as the optimal correlation lengths for localization are typically determined via a sensitivity analysis therefore only those that performed the best for the given localization approaches are included here furthermore there is no one superior localization approach or the localization length that is suitable for all noise settings assimilated stations validation locations or events in general better results after localization are obtained with the noise setting with larger and strongly correlated perturbations to the state variables compared to the weakly correlated smaller noise setting this could be due to localization causing the covariances to be too weak when the prior covariances are already small meaning that the updates corresponding to the true correlations are also removed one of the exceptions to this is seen at shimagahara for the 2013 flood for three stations assimilated where the best results after assimilation are the same as the ensemble open loop performance for which the weakly correlated noise with smaller state variable perturbation has a lower rmse the best results therefore correspond to the cases where the covariances between grids in different tributaries are set to zero i e acc st and riv or approach zero due to very small localization length euc with low localization level as all the observations assimilated stations are located in a different tributary this indicates possible issues with information transfer to ungauged basins however the same is not observed for the 2018 flood for this event even for only three stations assimilated euc and acc localization are able to improve upon both the open loop simulation and assimilation without localization here the rms errors are again smaller for the larger state variable perturbation the discussions that follow therefore focus only on the noise configuration e 0 75 ε state 0 1 λ 100 the best localization approach is also not necessarily the same for different numbers of assimilated stations for example for the 2013 flood the best localization approaches for improving performance at inooka are acc st with medium localization level when all 15 observations are assimilated riv with medium localization level for ten stations assimilated and acc st with medium localization level for three stations assimilated for the 2018 flood these correspond to riv with low localization level for 15 stations assimilated and euc with low localization level for the latter two similarly the most suitable localization level i e correlation length can also vary depending on the location e g for the 2013 flood when ten stations are assimilated the best localization levels for acc st are high medium low and medium at inooka nabari and shimagahara respectively although this can be ameliorated to some extent through extensive sensitivity analysis it may be beneficial to use different localization lengths for different observation stations nevertheless even if such an approach of spatially heterogeneous localization length is adopted localization parameters tuned through sensitivity experiments may cause issues during operational forecasting in real time as sudden malfunction of observation gauges can lead to missing information and previously determined localization lengths may no longer be optimal as a result adaptive localization approaches that obviate the need for conducting sensitivity experiments for parameter tuning should be developed to facilitate the integration of these filtering algorithms into real time forecasting systems it is also noteworthy that the performance of the euclidean approach euc is comparable to other approaches based on the river network structure i e acc acc st or riv for the tested localization lengths for example as can be seen from tables 3 and 4 euc localization outperforms the other approaches including no localization in 13 out of the 36 total cases of these 13 cases however 12 are for the two gauging stations with smaller upstream areas seven at shimagahara and five at nabari whereas only one is for the outlet station i e inooka where either the acc st or riv localizations are superior this is possibly because for small catchments where the basin response time is short precipitation which is governed by the euclidean distance plays a very important role and as such even the traditional euclidean approach performs well nevertheless since any localization implementation is bound to be case specific different patterns may be revealed depending on the application region and or methodology e g el gharamti et al 2021 revel et al 2019 3 3 2 localization of dam outflow measurements returning to the 2013 flood for the noise configuration e 0 75 ε state 0 1 λ 100 it is seen that rmse after localization at inooka for ten assimilated stations is smaller than the rmse after localization for 15 assimilated stations table 3 as the five additional stations are all related to dam outflows this indicates that treating the dam outflow measurements the same as the streamflow measurements in this case to find the best localization approach length has also denied the areas near the outlet of the correct filter updates on the other hand opposite behavior is observed at nabari which is located near the three upstream dams as the rmse after localization for 15 stations assimilated is smaller at this location compared to ten stations assimilated therefore if it is assumed that the localization implementation is constrained by having to choose a single optimal parameter η i e the correlation length for the whole basin some compromise has to be found in order to balance the filter performance at these two locations this assumption is not unrealistic as using a single localization parameter at the basin scale is common in hydrological data assimilation e g el gharamti et al 2021 khaki et al 2018 wongchuig et al 2021 one approach to achieving this compromise could be to select the best correlation length for the catchment outlet for localization with ten assimilated stations and use a different method of localization specific to dams to update the state variables in their vicinity as such medium localization level for euc acc and riv localization and high localization level for acc st localization are selected and the dam outflow measurements are localized separately the expectation from this method is that the performance at inooka should be similar to the best result at inooka achieved with the localization length that is optimized for this location for the case with ten assimilated stations and the performance at nabari should approach that achieved with the localization length optimized for nabari itself for the case with 15 assimilated stations fig 12 shows the results for 15 stations assimilated where the ten streamflow gauges are localized using the distance based method and the five dam outflow measurements are localized using the dam localization approach correlation lengths for dam outflow localization are on the horizontal axis and the points represent the corresponding rms errors the red dotted lines indicate the rmse for ten stations assimilated case for the localization length optimized for inooka and the blue dotted lines indicate the rmse for the localization length optimized for nabari when all 15 stations are assimilated for all localization approaches the rmses at nabari have decreased compared to localization with only ten stations assimilated except for very high dam localization lengths e g 2255 for acc st and riv increasing the dam localization length also affects performance at the basin outlet in general smaller dam localization lengths tend to improve performance at nabari while keeping the rmses at inooka mostly unchanged for such small lengths the filter performance at shimagahara is also similar to the performance obtained from the localization of only the ten streamflow observation stations esp acc st and riv however for the tested lengths none of the results at nabari match the blue line i e the rms error obtained for the length optimized for nabari when all 15 stations are assimilated this is likely because dam localization i e localization only in the downstream direction is applied for the entire duration of the flood rather than for just the dam operation period nevertheless these results indicate that the dam localization approach used here has the potential to be used for improving filter performance immediately downstream of dams without affecting performance at very distant locations 4 conclusions this study investigated the effect of assimilating dam outflow measurements on ensemble kalman filter performance in a distributed hydrological model applied to a small scale catchment experiments with different system noise models parameterized by precipitation relative error model state fractional error scaling and state error correlation lengths were first performed to determine the best enkf parameters the efficacy of data assimilation increased with increasing magnitude of precipitation error while the magnitude and the correlation of the state variable perturbations were important in improving assimilation performance at grids where observations were not available at these locations the filter performance improved and the sensitivity to the state error fractional term was also reduced with increasing state error correlation length as the issue of inconsistent spatial noise structure over the basin was resolved assimilating dam outflow observations led to deleterious updates to the state variables more so when dam operation caused significant changes to the flow and when the state variable perturbations were larger and strongly correlated all four distance based approaches tested in this study were able to limit the impact of these measurements at long hydrological distances as the predictions significantly improved near the basin outlet the issue of deleterious updates was also tempered within the basin however experiments conducted by varying the noise setting number and type of assimilated stations and flood events indicated that there is no single localization approach or the corresponding correlation length that is best for all locations within the basin therefore any localization implementation would benefit from carrying out sensitivity tests beforehand to determine the most suitable localization method the results further highlight the need to develop more sophisticated localization techniques that can adapt themselves to yield the most optimal filter performance independent localization of dam outflow measurements from the streamflow observations was also tested in this study streamflow observations were localized using the traditional distance based approaches and dam outflow observations were assumed to affect only the grids located downstream as such the covariances between the dam grids and their upstream grids were set to zero while an exponential decay function was used to calculate the localization weight for the downstream grids the distance for calculating this weight was based on the flow accumulation values of the grids such separate treatment of dam outflows showed potential for improving predictions at locations near the dams themselves using this approach during the period of dam operation therefore can limit the deleterious updates to the state variables at distant locations and help avoid filter degradation future studies are expected to utilize these insights to develop more robust localization approaches that ensure that the filter updates are consistent with the hydrology of the catchment credit authorship contribution statement manoj khaniya conceptualization methodology software visualization writing original draft yasuto tachikawa supervision conceptualization methodology software writing review editing yutaka ichikawa conceptualization resources kazuaki yorozu conceptualization resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the council for science technology and innovation csti of japan cross ministerial strategic innovation promotion program sip enhancement of national resilience against natural disasters funding agency national research institute for earth science and disaster resilience nied 
3494,hongjiannao lake hl the largest desert freshwater lake in china has been undergoing quickly evolution of lake area during the past 30 years the causes and driving mechanism of such changes however are still not well understood the evolution process can be divided into three phases the stationary phase the shrinking phase and the rising phase which were affected by climate change and human activities such as unreasonable utilization and water diversion here wavelet coherence was used to analyze the relationship between the groundwater level and the lake level and the results shown that groundwater levels in the lakeshore region were positively correlated to lake level within a short lag period of approximately 30 days then a gradient boosting decision tree based regression model was applied to analyze the relative importance of climatic factors model 1 and both of climatic factors and groundwater level model 2 to the lake level in model 1 the most important factor was the evaporation to the hl level while in model 2 it was the groundwater level and the evaporation which also achieved better prediction performance finally using the 2021 meteorological data and groundwater level model 2 was utilized to dynamically predict the daily water level of the hl showing that the lake level fluctuated upward keywords remote sensing interpretation wavelet coherence gradient boosting decision tree dynamic prediction 1 introduction frequent human activities and climate change have posed a great threat to water resources and ecological environment especially in arid and semi arid regions azizpour et al 2021 truong et al 2021 over the past four decades natural environmental changes such as global warming radiation dimming brightening wind weakening and abnormal climate fluctuations as well as intense human activities such as damming water transfer and water diversion have profoundly changed the physical environment and processes of lakes driving the evolution of lake environments and ecosystems vuglinsky and kuznetsova 2019 piccolroaz et al 2021 wang et al 2021a wang et al 2021b understanding the characteristics and driving factors of lake level variations caused by climate change and human activities can guide the mitigation of the degradation of lake ecosystems and the improvement of lake functions to determine the driving factors of lake level dynamics arkian et al 2018 found that the decline in the lake level was mainly attributed to the decrease in the mean annual precipitation and wind speed the increase in the mean annual temperature and sunshine hours in the watershed precipitation playing the most important role mishra et al 2018 discovered that the first rise in the lake level was caused by the inflow of snowmelt and that the second lake level rise was mainly due to an increase in annual precipitation and a decrease in evapotranspiration the traditional methods for analyzing lake level variations and predicting lake levels were mainly based on water budget calculation wu et al 2014 rodríguez rodríguez et al 2012 correlation analysis using statistical regression models ding et al 2021 li et al 2016 lake level time series analysis gill et al 2013 ghashghaie and nozari 2018 and the gray model mohammadi et al 2020 in recent years machine learning methods have been widely used in hydrology kim et al 2019 gharib and davies 2021 zounemat kermnai et al 2021 many researchers have applied machine learning method to predict real time water level zhao et al 2020 reverse flow and water level of tonle sap lake morovati et al 2021 water level in reservoirs wee et al 2021 water level of red river phan and nguyen 2020 daily streamflow reis et al 2021 and multiple scales nonstationary hydrological time series feng et al 2021 for predicting lake level zhu et al 2020a systematically reviewed various machine learning models e g artificial neural networks support vector machines and evolutionary models in the dynamic variation and prediction of lake levels shiri et al 2016 used a genetic algorithm an artificial neural network and an extreme learning machine to predict the water level of lake urmia showing that the extreme learning machine made the most accurate predictions of the lake level zhu et al 2020b used the feed forward neural network and deep learning technique to predict the monthly lake level gradient tree boosting or gradient boosting decision tree gbdt an iterative decision tree model established on the basis of boosting is an accurate and effective off the shelf procedure for optimizing the regression tree with the residual gradient brédy et al 2020 holloway et al 2019 which was proposed by friedman 2001 the gbdt model has very strong generalizability and can process different types of data including nonlinear data continuous values and discrete values that can be used for both regression and classification problems in a broad range of areas including search engine ranking and ecology the predictive performance of its algorithm depends on the selection of feature data and the setting of the number of iterations and it has been widely used in the fields of model evaluation risk assessment and dynamic prediction wei et al 2019 zhang et al 2020 neelakandan and paulraj 2020 rufaida et al 2020 nguyen et al 2021 developed an extreme gradient boosting model for hourly water level prediction in the jungrang basin kim et al 2022 forecasted flood water level of bokha stream in namhan river by using gradient boosting truong et al 2021 proposed gradient tree boosting based model to forecasting water levels in the bac hung hai catchment since more advanced models such as deep neural networks always require large scale data sets to learn the underlying relationship between input features and output target for small dataset like the one used in this study gbdt generalizes the other methods by boosting to arbitrary differentiable loss functions which usually outperforms other prediction methods therefore we utilized gbdt algorithm to develop machine learning models to dynamically predict the daily water level of the target area with the emergence of remote sensing data with high spatiotemporal and high spectral resolutions many researchers have used remote sensing data to extract lake water information hongjiannao lake the largest desert freshwater lake in china is a nationally important wetland that plays a key role in protecting the local ecological environment wu et al 2020 liang and yan 2017 in the past two decades the unreasonable development and utilization of water resources and frequent human engineering activities have led to the shrinkage of the hl year by year causing severe damage to the ecological environment and thus posing a serious threat to the flora and fauna in the wetland mu et al 2021 many scholars focus on studying the hl change and its driving factors and their conclusions are based on regression analysis of lake area rainfall evaporation and human activities liang and yan 2017 wu et al 2020 yue and liu 2021 there is no qualitative analysis of the relative importance of climate change and human activities on lake level which can provide effective recommendations for water resource management to maintain lake level stability arkian et al 2018 mishra et al 2018 wang et al 2021a the long term stability of the lake level would support the stability of the ecological environment system to the hongjiannao wetland and climatic factors are the key factors in the evolution of the lake level yue and liu 2021 then it is urgent to analyze the characteristics and driving factors of lake level changes by climate change and human activities and to predict lake level dynamically although many studies have been conducted to interpret the hl area most of them have only been based on different imaging and interpretation methods but rarely have quantitatively analyzed the patterns and causes of the variation in the hl area in addition many researchers have not delved into an interpretation of the hl area and most of them focused on analyzing the spatiotemporal variation in its area without understanding the relative importance of climate change and human activities to the variations of lake area and level the management may make some wrong decisions which may lead to the deterioration of the ecological environment of the hongjiannao basin given these shortcomings of previous research on the hl the present study attempted to delved into an interpretation of the hl area in combination with the lake level of the hl and meteorological monitoring data along with the chahannao area we quantitatively evaluated the change rule of the hl area and investigated the contribution of climate change and human activities meanwhile based on the monitoring data the study first investigated the relationship between the hl level and monthly meteorological data as well as groundwater level moreover wavelet coherence was used to analyze the significant correlation between the groundwater level and the lake level and to revealed whether groundwater level could be a substitute for human activities finally we introduced the gbdt regression model to discuss the relative importance of climatic factors and also combining them with groundwater level to the lake level respectively and to dynamically predict daily values of lake level 2 material and methods 2 1 study area the hl is the largest desert freshwater lake in china located in the relatively low lying area of the eastern margin of the mu su desert and of the cretaceous basin of the ordos plateau fig 1 the hongjiannao basin hb has an arid semiarid temperate plateau continental climate with abundant sunshine little precipitation strong winds and sandstorms and a short frost free period fig a1 in supplementary shows the monthly variation in the climatic factors of the hb from 2014 to 2018 there is a consistent annual temperature variation pattern with a maximum temperature of approximately 22 c in july each year and a multiyear mean annual temperature of 8 7 c strong winds are common in the watershed with a multiyear mean wind speed of 2 5 m s and a maximum wind speed of approximately 3 0 m s in may the hb has multiyear mean sunshine of 2 875 h a sunshine rate of approximately 65 and annual radiation of 141 86 kcal cm2 the number of frost free days varies from 108 to 207 with a maximum of 207 days and a multiyear mean of 154 days the mean annual relative humidity ranges from 28 to 78 with a multiyear mean relative humidity of 49 and a humidity coefficient of 0 29 0 37 the multiyear mean precipitation of 356 4 mm and annual precipitation concentrated between july and september fig a1 accounting for 69 of the total annual precipitation and mostly occurring in the form of heavy rainfall with a maximum monthly rainfall of 223 7 mm which easily leads to flooding the evaporation reached its maximum in april then decreased month by month to october followed by a slight increase afterward with a multiyear maximum monthly evaporation of 258 1 mm and a multiyear mean annual evaporation of 1328 5 mm using the 20 cm evaporation pan the hb is dominated by the hl which together with the cl and several seasonal rivers forms a surface water system fig 1 the hl and cl are the closed inland lakes whose recharge relies on atmospheric precipitation surface runoff and groundwater discharge especially atmospheric precipitation no rivers flow into the cl the hl once had a total of seven seasonal rivers flowing into it namely zhasake river zr mudushili river mdr qibusu river qr manggaitu river mgr erlintu river er songdaogou river sr and miaohao river mhr among which the zr and mdr belong to the yijinhuoluo banner of inner mongolia accounting for approximately 63 of the water entering the lake 2 2 methods 2 2 1 remote sensing interpretation jordan jordan 1969 proposed the ratio vegetation index rvi rvi nir r where nir is the near infrared band emissivity and r is the infrared band emissivity for vegetation studies that use a combination of satellite remote sensing data in different bands since then relevant vegetation indices have been proposed such as the difference vegetation index dvi nir r which can well reflect the change in vegetation coverage and ndvi nir r nir r which further eliminates such influencing factors as topographic and atmospheric conditions and is currently the most widely used rvi mcfeeters mcfeeters 1996 further proposed the ndwi green nir green nir which is a normalized ratio index based on the green band and the near infrared band and is widely used to extract water body information from remote sensing images in this paper the ndwi is calculated from landsat satellite remote sensing data as ndwi tm etm band2 band4 band2 band4 and ndwi oil band3 band5 band3 band5 2 2 2 monitoring data the meteorological station was located in the northern of the study area as showed in fig 1 the meteorological data were daily data from surface meteorological stations which downloaded for free from china meteorological data service centre http data cma cn in this study we downloaded the daily meteorological data from 1994 to 2020 those data were used to analyze monthly changes of meteorological factor and the relationship between the lake area and precipitation and evaporation the groundwater monitoring station was built on the lake beach and located in the north of the hl the lake level monitoring station was in the north central part of the hl as showed in fig 1 they started operating in september 2017 we preliminarily investigated the relationship between these monitoring data and further revealed the significant correlation between groundwater level and lake level by cross wavelet and wavelet coherence consider the previous discussion the gbtd model was used to reveal the relative importance of meteorological factor and both of meteorological factor and groundwater to the lake level and dynamically predict the lake level 2 2 3 wavelet coherence the morlet wavelet boasts good temporal clustering high frequency resolution the inclusion of phase information and similarity to conventional signals it is mostly used to identify the degree of correlation between two nonstationary time series and to perform spectral estimation of signals zhang et al 2021 at frequency f and time τ the morlet wavelet is defined as follows 1 ψ τ f u f exp i 2 π f u τ exp u τ 2 σ 2 where ψ τ f u is the product of a sine wave with frequency f and a gaussian function centered at time τ with the standard deviation σ of the gaussian function proportional to the reciprocal of f therefore the wavelet transform of the signal x u is a function of frequency f and time τ obtained from the convolution of the signal with the wavelet as follows 2 w xx τ f x u ψ τ f u d u torrence and webster torrence and webster 2010 suggested that the wavelet coherence be determined by a smooth estimate of the wavelet spectrum we define the smooth wavelet spectrum s xx τ f and the cross wavelet spectrum s xy τ f of the signal at frequency f and time τ as follows 3 s w xx τ f τ δ 2 τ δ 2 w xx τ f w xx τ f d τ 4 s w xy τ f τ δ 2 τ δ 2 w xx τ f w yy τ f d τ where w xx τ f is the complex conjugate of w xx τ f and δ is a scalar that depends on the frequency in wavelet coherence δ is an important parameter that defines its temporal resolution the smaller the δ value is the higher the applicable signal frequency is and thus the better the temporal variation incoherence can be satisfied similar to the fourier based coherence the wavelet coherence at frequency f and time τ w c τ f is defined as 5 w c τ f s w xy τ f s w xx τ f s w yy τ f where s w xy τ f a scalar of signals and y was defined by eq 5 based on the cauchy schwarz inequality 0 w c τ f 1 is satisfied and when δ 0 the wavelet coherence of the two signals w c τ f 1 for any frequency f and time τ 2 2 4 gradient boosting decision tree gradient boosting is a machine learning technique for regression and classification problems it treats boosting as a numerical optimization problem by sequentially adding base learners in a gradient of descent like steps to find an optimal function in the function space that minimizes the loss function friedman 2001 and 2002 gradient descent is a classical numerical optimization method with its parameter θ updated as follows 6 θ θ α θ l θ the boosting algorithm can make a weak learner improve into a strong learner it adjusts the sample distribution based on the training result of the previous learner and then trains the next learner based on the new sample distribution and finally combines a series of weak learners into one strong learner after multiple iterations gradient boosting uses an additive model that is a strong learner is a linear combination of a series of weak learners as expressed in the following equation 7 f x m 1 m α m g m x where gm x is the base learner and αm is the corresponding coefficient for the random output vector y and the random input vector set x x 1 x 2 xn the training sample y i x i 1 n is used to solve for the value of y x to obtain an approximate f x to describe the relationship between y and x which is expressed as follows 8 f x arg min f e y x l y f x where the loss function l y f has three forms i e the squared error loss y f 2 the absolute error y f y r 1 and the logarithmic negative binomial log 1 e 2 y f y 1 1 at the m th step of the gradient boosting algorithm our objective is to minimize the specified loss function l y f x that is 9 min α m g m i 1 n l y i m 1 m α m g m x where x 1 y 1 x 2 y 2 xn yn are the training data sets for any loss function l choosing the optimal function g at each stage is a computationally infeasible optimization problem this problem is usually solved by the simplification method and the steepest descent method that is it is assumed that in the m th iteration the coefficient α and the base learner g x in each of the m 1th iterations are both fixed 10 f m x f m 1 x α m g m x replacing the parameter θ in the eq 6 by f x yields 11 f m x f m 1 x α m f m 1 x l y f m 1 x by simultaneously solving eq 10 and eq 11 the relation between the base learner and the loss function can be obtained as follows 12 g m x f m 1 x l y f m 1 x next the base learner gm x can be used to fit the negative gradient of the loss function of the model in the previous round i e the loss function l f is minimized by the gradient descent method as expressed below 13 α m arg min α i 1 n l y i f m 1 x i α l y i f m 1 x i f m 1 x i a negative gradient is also called pseudo residual the larger the residual r y f x the greater the difference between the result of the previous round of learner f x and the true value of y then the learner of the next round can correct the previous learners by fitting the residuals or negative gradients the loss function of the gradient boosting algorithm is defined by the following equation 14 j x i 1 n y i f x i 2 at the m th step the objective of the optimization is given as 15 j m x i 1 n y i f m x i 2 i 1 n y i f m 1 x i α m g x i 2 i 1 n r i α m g x i 2 where r i y i f m 1 x i is the residual in summary the process of the gradient boosting algorithm can be generalized into the following steps xiong et al 2018 inputs differentiable loss function l y f x training data set y i x i 1 n and number of iterations m 1 initialization f o x arg min f i 1 n l y i f x i 2 for m 1 to m a calculate the negative gradient y i f m 1 x i l y i f m 1 x i i 1 2 n b fit y i with the base learner gm x by minimizing the squared error w m arg min w i 1 n y i g m x i w 2 c use line search to determine the step size αm that minimizes l α m arg min α i 1 n l y i f m 1 x i α g m x i w m d f m x f m 1 x α m g m x w m 3 output fm x the commonly used base learner in the gradient boosting algorithm is the decision tree the gbdt is an algorithm that combines the two to solve regression problems in the gbdt algorithm the decision tree is regarded as a piecewise function that divides the feature space into several independent regions each of which is used to predict a constant in this algorithm a single decision tree can be expressed as g x r j b j 1 j j 1 j b j i x r j where r j 1 j is a divided independent region and b j 1 j is the output value in each region the αm in step 2 c of the algorithm flowchart is the same for all regions in the decision tree and thus does not minimize the loss function friedman friedman 2002 proposed that an optimal value γ m α m b jm be determined for each region r j making the expression in step 2 c become 16 γ m arg min γ x i r jm l y i f m 1 x i γ in summary the process of the gbdt regression algorithm can be generalized into the following steps wei et al 2019 1 initialization set f o x arg min f i 1 n l y i f x i 2 for m 1 to m a calculate the negative gradient y i f m 1 x i l y i f m 1 x i i 1 2 n b r jm 1 j arg min r jm 1 j i 1 n y i g m x i r jm b jm 1 j 2 c γ jm arg min γ x i r jm l y i f m 1 x i γ d f m x f m 1 x j 1 j γ jm i x r jm 3 output f m x 3 results and discussion 3 1 hongjiannao lake area landsat data were downloaded for free from the geospatial data cloud http www gscloud cn search a total of 53 scenes of image data with a cloud cover of less than 10 were selected from the period 1988 2018 for 1988 2012 one scene per year was selected with an imaging time between may and september to avoid the influence of ice melting on the lake area between 2013 and 2018 four to five scenes were selected each year to qualitatively analyze lake area changes the original remote sensing image data were first subjected to radiometric geometric and atmospheric correction preprocessing and the images were uniformly converted to the utm projection of the wgs 84 ellipsoid model fig 2 a shows that the changes in the hl area between 1988 and 2018 can be divided into three phases namely the stationary phase the shrinking phase and the rising phase as shown in table 1 from 1988 to 1998 the water area fluctuated slightly in the range of 50 96 to 54 59 km2 with a year to year change between 1 81 and 1 97 km2 indicating the hl was in a relatively stationary phase from 1998 to 2015 the water area decreased from 52 70 km2 to 30 10 km2 i e the lake area decreased by 22 6 km2 showing an overall continuous shrinking trend from 2015 to 2018 the lake area expanded from 30 10 km2 to 35 81 km2 i e the water area increased by 5 71 km2 during the three years suggesting that the hl was in a rising phase fig 2b shows the water level of the hl from 2015 to 2018 the variation curves of the measured water level and the hl area were interpreted using landsat data the variation trends in the lake area and the lake level were basically the same indicating accurate interpretation of the hl area from 1988 to 2018 by landsat data based on the overlay analysis of the lake area vector data by arcgis 10 2 software the spatiotemporal dynamic changes in the lake area during the stationary shrinking and rising phases were obtained fig 3 as shown in fig 3a the hl area changed dynamically between 1988 and 1998 with small areas e g green area in 1990 and yellow area in 1994 being covered and the hl area reaching a maximum of 54 59 km2 in 1993 the spatiotemporal variation in the hl area was concentrated in small parts of the northern western and southern regions of the hl according to fig 1 the northern region is the inflow region of the zr and the mdr the western region is the inflow region of the mgr and the southern region is between the inflow regions of the qr and er indicating that the amount of surface water entering the hl was the key factor in the dynamic changes during the stationary phase as shown in fig 3b the hl area decreased year by year from 1999 to 2014 and the regions with the most shrinkage of the hl area was located in the north and southeast during this period zr and mdr were cut off for the construction of reservoirs fig 1 blocking the surface water from entering the lake from the north while the shrinkage in the southeast was mainly due to the increase in human activities as a result of the development of the hongjiannao tourist area the gaolemiao water storage project was built in the middle reaches of the mgr but did not cut off the river fig 1 so the area of this river s inflow shrank relatively little all other regions showed a regular shrinking trend indicating that the changes in the hl area during this period were affected by both climate change and human activities since 2015 there has been a trend of the hl area expansion fig 3c with the inflow regions of the zr mgr and qr expanding obviously currently the zhasake reservoir releases approximately 3 million m3 of floodwater to the downstream lake region each year the qr has been renovated to increase the amount of water entering the hl and the implementation of other protection regulations has been key in the gradual expansion of the hl area the hb has a temperate continental semiarid climate and the hl is a typically closed inland lake in the desert region of northwest china the intra annual variation in the lake area is mainly affected by climatic factors and human activities liang and yan 2017 wang et al 2018a in this study the precipitation and evaporation data were collected from the meteorological station of yijinhuoluo banner in the period 1990 2018 to analyze the influence of climatic factors on the hl area the relationship between the hl area and the precipitation during 2014 2017 fig 4 a shows that the lake area fluctuated within each year the smallest lake area being in the rainy season july to september in 2014 2017 the average rainfall in august 2016 reached 219 9 mm which led to an increase in the hl area the evaporation data collected in the watershed were converted to natural water evaporation with the conversion factor z e0 e1 where e0 is the natural water evaporation mm e1 is the evaporation mm observed using a small evaporator with a diameter of 20 cm and the z value was set at 0 622 the relationship between lake area and water evaporation fig 4b shows that the corresponding lake area decreased continuously as evaporation increased and the water surface evaporation was the most important source of loss from the lake in general climatic factors have a significant impact on the hl area the lake water volume directly affects the changes in the lake area and the lake deficit is equal to the difference between the precipitation and the water surface evaporation multiplied by the hl area fig 4c shows the relationship between lake deficit and lake area between 1988 and 2018 the deficit decreased and the lake area increased accordingly during the stationary phase of the hl during the shrinking phase the relationship between the lake area and the lake deficit was not pronounced mainly due to the frequent human activities at this time in the hb the zhasake reservoir and the gaolemiao water storage project were constructed in the middle reaches of the zr and mgr respectively and a dam was built on the mdr to store water for power generation fig 1 all of these to a certain extent blocked surface water from entering the hl in addition the mining of the hongqinghe and mataihao coal mines and the establishment of groundwater sources in the hb led to changes in the local groundwater flow field and thus affected the groundwater recharge into the lake during the rising phase the lake deficit was negatively correlated with the lake area this is because the hongjiannao national nature reserve invested in the renovation of the qr and implemented other protection rules which increased the surface water inflow into the lake and regulated human activities these put the hl area into a trend of expansion overall the changes in the hl area have been a comprehensive reflection of the water budget of the lake quantitative analysis of the input from precipitation surface water and groundwater recharge and the output formed by the evaporation of lake water is the key to studying the lake area climate change and human activities are the main reasons for the overall shrinking trend of the hl area in the past three decades and human activities are the key factor in the lake changes 3 2 chahannao lake area the cl is another large lake in the hb and no surface river water flowing into it the main recharge sources of the cl are atmospheric precipitation and groundwater discharge and its discharge methods are evaporation and artificial mining we selected landsat image data to interpret the cl area and qualitatively analyze the relationship between the changes in the cl and hl areas during the same period as shown in fig 4d from 1988 to 1998 the hl was in a stationary phase and the variation in the cl area was basically consistent with that of the hl exhibiting certain fluctuations and being controlled by climatic factors from 1999 to 2014 the hl area decreased year by year while the cl area first increased and then decreased from 2015 to the present the hl area was in the rising phase and the cl area also increased year by year at a fast rate during the stationary and rising phases of the hl the changes in the cl area were consistent with those of the hl indirectly proving the impact of human activities on the hl area during the shrinking phase we further analyzed the relationship between the cl area and climatic factors as shown in fig 4e in region a red dotted area the fluctuation in the cl area and the climatic factors are clearly correlated with each other as evaporation increased and precipitation decreased the corresponding lake area decreased and the opposite also held the lake area in region b was basically unchanged and the precipitation and evaporation were also in a steady state in region c the cl area increased significantly the annual precipitation reaching 596 6 mm in 2016 after which the evaporation gradually decreased in summary the cl area was basically positively correlated with the annual precipitation and negatively correlated with the annual evaporation 3 3 hongjiannao lake level to analyze the relationships between the water level of the hl and climatic factors we collected daily lake level monitoring data and eight climatic factors air pressure air temperature humidity ground temperature precipitation evaporation wind speed and sunshine duration as shown in fig a2 the orange lines indicate the daily change in lake level from january 1 2015 to december 31 2018 the break in the orange line indicates that monitoring data were lost during this period the lake level exhibited a fluctuating upward trend overall in particular the lake level rose sharply at approximately 1 6 m from august 2016 to april 2017 moreover the lake level fell sharply and then rose rapidly from may 10 2015 to june 7 2015 which may have been due to human activities the change rule of air pressure followed a v like pattern as shown in fig a2a the lowest air pressure was concentrated in july august every year and there was no obvious relationship between the lake level and air pressure as shown in fig a2b the change rule of air temperature was contrary to that of air pressure showing an inverted v shape and the greatest air temperature was concentrated in july every year however the change in air temperature did not cause a greater response at the lake level as air temperature gradually rose in march april every year the lake level rose slightly due to melting ice on the hl the change rule of ground temperature was similar to that of air temperature fig a2d the maximum difference between the ground and air temperature was 9 8 c and the minimum difference was 3 4 c fig a2c shows that the humidity fluctuated irregularly throughout the year ranging from 10 5 to 95 0 precipitation was concentrated in july sep every year as shown in fig a2e in august 2016 heavy rainfall continued with maximum daily precipitation of 64 5 mm causing the lake level to rise sharply since 2015 there has been heavy rainfall every year so the lake level has continued to rise as shown in fig a2f the change rule of evaporation was basically the same each year and the evaporation was concentrated in april every year the lake level gradually dropped from july 2016 to july 2017 because there was no significant heavy rainfall and evaporation continued to increase the last two climatic factors wind speed and sunshine duration had no significant influence on the lake level and they changed irregularly fig a2g h in summary contrastive analysis of the lake level and each climatic factor did not reveal a significant influence of climatic factors on the change in the lake level next a gbdt regression model was used to quantitatively assess the relative importance of each climatic factor 3 4 lake level and groundwater level groundwater monitoring stations gms was located on the shore of the hl approximately 3 km from the lake fig 1 this monitoring station started operating in september 2017 fig a3a presented the daily variation curves of the lake level and groundwater level which fully demonstrated the intra annual dynamic characteristics of the groundwater level and its response to the changes in the lake level from january 2018 to april 2018 some lake level data were missing on march 4 2018 the lake level dropped sharply and then started to rise again probably due to the gradual melting of the ice on the lake surface at this time the groundwater level had an upward trend and groundwater runoff recharge also caused the lake level to rise after april 2018 the lake level and the groundwater level fluctuated in clear synchronicity overall spatially the changes in the lake level and the groundwater level showed a high degree of consistency indicating that the lakeshore groundwater level dynamically responds to changes in the lake level on the other hand the lakeshore groundwater level and lake level changes did not have a high degree of consistency on a daily time scale and the groundwater level dynamics had a certain lag in its response to the lake level changes which may be related to the groundwater runoff path fig a3b c shown the comprehensive analysis of cross wavelet and wavelet coherence between the water level of the hl and the groundwater level of the gms it can be seen from the cross wavelet plot in fig a3b that the lake level and the groundwater level shared common high energy signals over a long timescale and the mutual influence was concentrated within approximately 30 days indicating that they were highly significantly correlated in this period it can be seen from the wavelet coherence plot in fig a3c that for most of the year after approximately day 120 the lake level and the groundwater level were positively correlated with each other and the groundwater level changed before the lake level indicating that the groundwater change affected the lake level to some extent and that there was a certain lateral hydraulic connection between the lake level and the groundwater level 3 5 dynamic prediction of lake level based on the principle of the gbdt algorithm we used the daily lake level monitoring data from 2017 to 2019 as the output vector y and the meteorological data as the input vector set x 1 x 2 xn the climatic factors were precipitation evaporation air temperature ground temperature sunshine wind speed humidity and air pressure the daily lake level data and meteorological data constituted the training set y i x i 1 n for the gbdt model model 1 calculation the model 1 just was used to investigate the relative importance of each climatic factors and lake level fig 5 a shown the relative importance of the independent variables in the gbdt regression evaporation was the climatic factor that contributed the most to the dynamic change in the water level of the hl and precipitation had the least importance the climatic factors were ranked by relative importance as follows evaporation humidity ground temperature air temperature air pressure wind speed sunshine precipitation the relative importance of climatic factors is in line with the characteristics of the hb which is an arid semiarid region the above wavelet coherence analysis shown that the groundwater level was closely related to the lake water level the daily groundwater level was further considered as the independent variable of the gbdt regression model model 2 to analyze its relative importance to the dynamic changes of lake water level as shown in fig 5b the groundwater contributed the most to the dynamic change in the lake water level and climatic factors were ranked by relative importance as follows evaporation ground temperature sunshine air pressure air temperature humidity wind speed precipitation it is observed that model 2 had a slight influence on the relative importance of climatic factors the maximum relative importance for climatic factors also was the evaporation of 35 70 and the minimum relative importance was precipitation of 1 43 based on the relative importance of model 1 and model 2 the daily meteorological data and groundwater levels of 2020 was input as the independent variables of the model to predict the daily lake level in that year fig 6 a presented taylor diagrams illustrating the statistics of the measured lake level and predicted value to model 1 model 2 taylor diagrams provided the ratio of standard deviation sd as a radial distance and the pearson correlation on the main arc baik and choi 2015 it indicated the sd root means square deviation rmsd and correlation coefficient cc all of which were mutually dependent the sd and rmsd were normalized by the ratio of the predicted value and the measured value of the lake level good ranges of correlation were observed for model 2 with the value of between 0 9 and 0 95 while lower correlation ranges of near 0 8 were observed for model 1 meanwhile the sd and rmsd were observed for model 2 lower than that of model 1 on the basis of the results shown in the taylor diagram the predicted lake level of model 2 with a high cc and lower sd and rmsd indicated better performances than model 1 fig 6b shown the dynamic curves of the predicted values of the gbdt model 1 and 2 and the measured values of the lake level the trend of the predicted value for model 2 was closer to the measured value of the lake level which may be due to model 2 combing the climatic factors and groundwater level in model 2 we regarded the change of groundwater level as human activities also demonstrate that the change of the hl area rising phase was influenced by both climatic factors and human activities thus the regression model could be used to investigate the relative importance of climatic factors and predict the dynamic changes in the water level in order to yield the optimal performance for predicting the daily water level the data from 2017 to 2018 were used to train the gbdt model and then the trained model was tested on 2019 data to further tune the hyper parameters and validated the model performance the models that achieved the overall best performance on both training and testing data was further validated using 2020 data as shown in the first portion of fig 6b which utilized the climatic factors and groundwater level it can be observed that both model 1 and model 2 were able to make water level prediction close to the actual values and the predicted values obtained by model 2 i e the orange line was more accurate than model 1 therefore based on the gbdt regression model 2 the daily variation in the water level of the hl was predicted using 2021 meteorological data and groundwater level as shown in the second half of fig 6b the predicted results indicated that the daily values of the lake level from january to july 2021 would first slowly rise and then fall similar to the changes in the measured water level during the same period in 2020 which showed an overall upward trend overall this study made fully use of gbdt algorithm that not only investigated the strongly predictive features that significantly impacted the dynamic change in the lake water level using the impurity based feature importance but also built tested and validated an effective regression model to dynamically predict the daily water level of the hl 4 conclusions with a focus on the characteristics and driving factors of lake level variations of hongjiannao lake by climate change and human activities this study used remote sensing data to interpret the changes in the lake area analyzed the correlation between groundwater level and lake level using wavelet coherence and analyzed the relative importance of climatic factors and groundwater level to lake level changes and dynamically predicted the lake level using the gbdt regression model the following conclusions are drawn 1 changes in the hl area can be divided into three phases the stationary phase 1988 1998 the shrinking phase 1998 2015 and the rising phase 2015 2018 combing the cl area and meteorological data during the same phases the changes in the hl area must have been influenced by climatic factors during the stationary phase and by both climatic factors and human activities during the shrinking and rising phases 2 cross wavelet and wavelet coherence functions were used to analyze the relationship between groundwater level and lake level the lake level and the lakeshore groundwater level had common high energy signals on a long timescale and the mutual influence between was concentrated within a short lag period of approximately 30 days showing the strong connection between the two the lake level and the groundwater were positively correlated with each other and the groundwater level changed before the lake level indicating that the groundwater change affected the lake level to some extent 3 the relative importance of climatic factors and groundwater level to the lake level was analyzed using the gbdt regression model the results shown that evaporation made the greatest contribution to the dynamic changes in the lake level while precipitation made the least for only climatic factors however combing climatic factors and groundwater level in the model the greatest contribution was groundwater level and the second was the evaporation of 35 70 and the minimum relative importance was precipitation of 1 43 4 the meteorological data and groundwater level of 2020 were input as independent variables to dynamically predict the lake level using the model 1 and 2 the results shown that the predicted lake level of model 2 with a high cc and lower sd and rmsd indicated better performances than model 1 indicating high accuracy of the lake level prediction of model 2 on this basis the daily water level of the hl was predicted using climatic factors and groundwater level from january to july 2020 and the results shown that the lake level fluctuated upward declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national key research and development program of china no 2021yfc3000205 national natural science foundation of china no 41572227 and applied technology research and development program of heilongjiang province ga19c005 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 127654 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3494,hongjiannao lake hl the largest desert freshwater lake in china has been undergoing quickly evolution of lake area during the past 30 years the causes and driving mechanism of such changes however are still not well understood the evolution process can be divided into three phases the stationary phase the shrinking phase and the rising phase which were affected by climate change and human activities such as unreasonable utilization and water diversion here wavelet coherence was used to analyze the relationship between the groundwater level and the lake level and the results shown that groundwater levels in the lakeshore region were positively correlated to lake level within a short lag period of approximately 30 days then a gradient boosting decision tree based regression model was applied to analyze the relative importance of climatic factors model 1 and both of climatic factors and groundwater level model 2 to the lake level in model 1 the most important factor was the evaporation to the hl level while in model 2 it was the groundwater level and the evaporation which also achieved better prediction performance finally using the 2021 meteorological data and groundwater level model 2 was utilized to dynamically predict the daily water level of the hl showing that the lake level fluctuated upward keywords remote sensing interpretation wavelet coherence gradient boosting decision tree dynamic prediction 1 introduction frequent human activities and climate change have posed a great threat to water resources and ecological environment especially in arid and semi arid regions azizpour et al 2021 truong et al 2021 over the past four decades natural environmental changes such as global warming radiation dimming brightening wind weakening and abnormal climate fluctuations as well as intense human activities such as damming water transfer and water diversion have profoundly changed the physical environment and processes of lakes driving the evolution of lake environments and ecosystems vuglinsky and kuznetsova 2019 piccolroaz et al 2021 wang et al 2021a wang et al 2021b understanding the characteristics and driving factors of lake level variations caused by climate change and human activities can guide the mitigation of the degradation of lake ecosystems and the improvement of lake functions to determine the driving factors of lake level dynamics arkian et al 2018 found that the decline in the lake level was mainly attributed to the decrease in the mean annual precipitation and wind speed the increase in the mean annual temperature and sunshine hours in the watershed precipitation playing the most important role mishra et al 2018 discovered that the first rise in the lake level was caused by the inflow of snowmelt and that the second lake level rise was mainly due to an increase in annual precipitation and a decrease in evapotranspiration the traditional methods for analyzing lake level variations and predicting lake levels were mainly based on water budget calculation wu et al 2014 rodríguez rodríguez et al 2012 correlation analysis using statistical regression models ding et al 2021 li et al 2016 lake level time series analysis gill et al 2013 ghashghaie and nozari 2018 and the gray model mohammadi et al 2020 in recent years machine learning methods have been widely used in hydrology kim et al 2019 gharib and davies 2021 zounemat kermnai et al 2021 many researchers have applied machine learning method to predict real time water level zhao et al 2020 reverse flow and water level of tonle sap lake morovati et al 2021 water level in reservoirs wee et al 2021 water level of red river phan and nguyen 2020 daily streamflow reis et al 2021 and multiple scales nonstationary hydrological time series feng et al 2021 for predicting lake level zhu et al 2020a systematically reviewed various machine learning models e g artificial neural networks support vector machines and evolutionary models in the dynamic variation and prediction of lake levels shiri et al 2016 used a genetic algorithm an artificial neural network and an extreme learning machine to predict the water level of lake urmia showing that the extreme learning machine made the most accurate predictions of the lake level zhu et al 2020b used the feed forward neural network and deep learning technique to predict the monthly lake level gradient tree boosting or gradient boosting decision tree gbdt an iterative decision tree model established on the basis of boosting is an accurate and effective off the shelf procedure for optimizing the regression tree with the residual gradient brédy et al 2020 holloway et al 2019 which was proposed by friedman 2001 the gbdt model has very strong generalizability and can process different types of data including nonlinear data continuous values and discrete values that can be used for both regression and classification problems in a broad range of areas including search engine ranking and ecology the predictive performance of its algorithm depends on the selection of feature data and the setting of the number of iterations and it has been widely used in the fields of model evaluation risk assessment and dynamic prediction wei et al 2019 zhang et al 2020 neelakandan and paulraj 2020 rufaida et al 2020 nguyen et al 2021 developed an extreme gradient boosting model for hourly water level prediction in the jungrang basin kim et al 2022 forecasted flood water level of bokha stream in namhan river by using gradient boosting truong et al 2021 proposed gradient tree boosting based model to forecasting water levels in the bac hung hai catchment since more advanced models such as deep neural networks always require large scale data sets to learn the underlying relationship between input features and output target for small dataset like the one used in this study gbdt generalizes the other methods by boosting to arbitrary differentiable loss functions which usually outperforms other prediction methods therefore we utilized gbdt algorithm to develop machine learning models to dynamically predict the daily water level of the target area with the emergence of remote sensing data with high spatiotemporal and high spectral resolutions many researchers have used remote sensing data to extract lake water information hongjiannao lake the largest desert freshwater lake in china is a nationally important wetland that plays a key role in protecting the local ecological environment wu et al 2020 liang and yan 2017 in the past two decades the unreasonable development and utilization of water resources and frequent human engineering activities have led to the shrinkage of the hl year by year causing severe damage to the ecological environment and thus posing a serious threat to the flora and fauna in the wetland mu et al 2021 many scholars focus on studying the hl change and its driving factors and their conclusions are based on regression analysis of lake area rainfall evaporation and human activities liang and yan 2017 wu et al 2020 yue and liu 2021 there is no qualitative analysis of the relative importance of climate change and human activities on lake level which can provide effective recommendations for water resource management to maintain lake level stability arkian et al 2018 mishra et al 2018 wang et al 2021a the long term stability of the lake level would support the stability of the ecological environment system to the hongjiannao wetland and climatic factors are the key factors in the evolution of the lake level yue and liu 2021 then it is urgent to analyze the characteristics and driving factors of lake level changes by climate change and human activities and to predict lake level dynamically although many studies have been conducted to interpret the hl area most of them have only been based on different imaging and interpretation methods but rarely have quantitatively analyzed the patterns and causes of the variation in the hl area in addition many researchers have not delved into an interpretation of the hl area and most of them focused on analyzing the spatiotemporal variation in its area without understanding the relative importance of climate change and human activities to the variations of lake area and level the management may make some wrong decisions which may lead to the deterioration of the ecological environment of the hongjiannao basin given these shortcomings of previous research on the hl the present study attempted to delved into an interpretation of the hl area in combination with the lake level of the hl and meteorological monitoring data along with the chahannao area we quantitatively evaluated the change rule of the hl area and investigated the contribution of climate change and human activities meanwhile based on the monitoring data the study first investigated the relationship between the hl level and monthly meteorological data as well as groundwater level moreover wavelet coherence was used to analyze the significant correlation between the groundwater level and the lake level and to revealed whether groundwater level could be a substitute for human activities finally we introduced the gbdt regression model to discuss the relative importance of climatic factors and also combining them with groundwater level to the lake level respectively and to dynamically predict daily values of lake level 2 material and methods 2 1 study area the hl is the largest desert freshwater lake in china located in the relatively low lying area of the eastern margin of the mu su desert and of the cretaceous basin of the ordos plateau fig 1 the hongjiannao basin hb has an arid semiarid temperate plateau continental climate with abundant sunshine little precipitation strong winds and sandstorms and a short frost free period fig a1 in supplementary shows the monthly variation in the climatic factors of the hb from 2014 to 2018 there is a consistent annual temperature variation pattern with a maximum temperature of approximately 22 c in july each year and a multiyear mean annual temperature of 8 7 c strong winds are common in the watershed with a multiyear mean wind speed of 2 5 m s and a maximum wind speed of approximately 3 0 m s in may the hb has multiyear mean sunshine of 2 875 h a sunshine rate of approximately 65 and annual radiation of 141 86 kcal cm2 the number of frost free days varies from 108 to 207 with a maximum of 207 days and a multiyear mean of 154 days the mean annual relative humidity ranges from 28 to 78 with a multiyear mean relative humidity of 49 and a humidity coefficient of 0 29 0 37 the multiyear mean precipitation of 356 4 mm and annual precipitation concentrated between july and september fig a1 accounting for 69 of the total annual precipitation and mostly occurring in the form of heavy rainfall with a maximum monthly rainfall of 223 7 mm which easily leads to flooding the evaporation reached its maximum in april then decreased month by month to october followed by a slight increase afterward with a multiyear maximum monthly evaporation of 258 1 mm and a multiyear mean annual evaporation of 1328 5 mm using the 20 cm evaporation pan the hb is dominated by the hl which together with the cl and several seasonal rivers forms a surface water system fig 1 the hl and cl are the closed inland lakes whose recharge relies on atmospheric precipitation surface runoff and groundwater discharge especially atmospheric precipitation no rivers flow into the cl the hl once had a total of seven seasonal rivers flowing into it namely zhasake river zr mudushili river mdr qibusu river qr manggaitu river mgr erlintu river er songdaogou river sr and miaohao river mhr among which the zr and mdr belong to the yijinhuoluo banner of inner mongolia accounting for approximately 63 of the water entering the lake 2 2 methods 2 2 1 remote sensing interpretation jordan jordan 1969 proposed the ratio vegetation index rvi rvi nir r where nir is the near infrared band emissivity and r is the infrared band emissivity for vegetation studies that use a combination of satellite remote sensing data in different bands since then relevant vegetation indices have been proposed such as the difference vegetation index dvi nir r which can well reflect the change in vegetation coverage and ndvi nir r nir r which further eliminates such influencing factors as topographic and atmospheric conditions and is currently the most widely used rvi mcfeeters mcfeeters 1996 further proposed the ndwi green nir green nir which is a normalized ratio index based on the green band and the near infrared band and is widely used to extract water body information from remote sensing images in this paper the ndwi is calculated from landsat satellite remote sensing data as ndwi tm etm band2 band4 band2 band4 and ndwi oil band3 band5 band3 band5 2 2 2 monitoring data the meteorological station was located in the northern of the study area as showed in fig 1 the meteorological data were daily data from surface meteorological stations which downloaded for free from china meteorological data service centre http data cma cn in this study we downloaded the daily meteorological data from 1994 to 2020 those data were used to analyze monthly changes of meteorological factor and the relationship between the lake area and precipitation and evaporation the groundwater monitoring station was built on the lake beach and located in the north of the hl the lake level monitoring station was in the north central part of the hl as showed in fig 1 they started operating in september 2017 we preliminarily investigated the relationship between these monitoring data and further revealed the significant correlation between groundwater level and lake level by cross wavelet and wavelet coherence consider the previous discussion the gbtd model was used to reveal the relative importance of meteorological factor and both of meteorological factor and groundwater to the lake level and dynamically predict the lake level 2 2 3 wavelet coherence the morlet wavelet boasts good temporal clustering high frequency resolution the inclusion of phase information and similarity to conventional signals it is mostly used to identify the degree of correlation between two nonstationary time series and to perform spectral estimation of signals zhang et al 2021 at frequency f and time τ the morlet wavelet is defined as follows 1 ψ τ f u f exp i 2 π f u τ exp u τ 2 σ 2 where ψ τ f u is the product of a sine wave with frequency f and a gaussian function centered at time τ with the standard deviation σ of the gaussian function proportional to the reciprocal of f therefore the wavelet transform of the signal x u is a function of frequency f and time τ obtained from the convolution of the signal with the wavelet as follows 2 w xx τ f x u ψ τ f u d u torrence and webster torrence and webster 2010 suggested that the wavelet coherence be determined by a smooth estimate of the wavelet spectrum we define the smooth wavelet spectrum s xx τ f and the cross wavelet spectrum s xy τ f of the signal at frequency f and time τ as follows 3 s w xx τ f τ δ 2 τ δ 2 w xx τ f w xx τ f d τ 4 s w xy τ f τ δ 2 τ δ 2 w xx τ f w yy τ f d τ where w xx τ f is the complex conjugate of w xx τ f and δ is a scalar that depends on the frequency in wavelet coherence δ is an important parameter that defines its temporal resolution the smaller the δ value is the higher the applicable signal frequency is and thus the better the temporal variation incoherence can be satisfied similar to the fourier based coherence the wavelet coherence at frequency f and time τ w c τ f is defined as 5 w c τ f s w xy τ f s w xx τ f s w yy τ f where s w xy τ f a scalar of signals and y was defined by eq 5 based on the cauchy schwarz inequality 0 w c τ f 1 is satisfied and when δ 0 the wavelet coherence of the two signals w c τ f 1 for any frequency f and time τ 2 2 4 gradient boosting decision tree gradient boosting is a machine learning technique for regression and classification problems it treats boosting as a numerical optimization problem by sequentially adding base learners in a gradient of descent like steps to find an optimal function in the function space that minimizes the loss function friedman 2001 and 2002 gradient descent is a classical numerical optimization method with its parameter θ updated as follows 6 θ θ α θ l θ the boosting algorithm can make a weak learner improve into a strong learner it adjusts the sample distribution based on the training result of the previous learner and then trains the next learner based on the new sample distribution and finally combines a series of weak learners into one strong learner after multiple iterations gradient boosting uses an additive model that is a strong learner is a linear combination of a series of weak learners as expressed in the following equation 7 f x m 1 m α m g m x where gm x is the base learner and αm is the corresponding coefficient for the random output vector y and the random input vector set x x 1 x 2 xn the training sample y i x i 1 n is used to solve for the value of y x to obtain an approximate f x to describe the relationship between y and x which is expressed as follows 8 f x arg min f e y x l y f x where the loss function l y f has three forms i e the squared error loss y f 2 the absolute error y f y r 1 and the logarithmic negative binomial log 1 e 2 y f y 1 1 at the m th step of the gradient boosting algorithm our objective is to minimize the specified loss function l y f x that is 9 min α m g m i 1 n l y i m 1 m α m g m x where x 1 y 1 x 2 y 2 xn yn are the training data sets for any loss function l choosing the optimal function g at each stage is a computationally infeasible optimization problem this problem is usually solved by the simplification method and the steepest descent method that is it is assumed that in the m th iteration the coefficient α and the base learner g x in each of the m 1th iterations are both fixed 10 f m x f m 1 x α m g m x replacing the parameter θ in the eq 6 by f x yields 11 f m x f m 1 x α m f m 1 x l y f m 1 x by simultaneously solving eq 10 and eq 11 the relation between the base learner and the loss function can be obtained as follows 12 g m x f m 1 x l y f m 1 x next the base learner gm x can be used to fit the negative gradient of the loss function of the model in the previous round i e the loss function l f is minimized by the gradient descent method as expressed below 13 α m arg min α i 1 n l y i f m 1 x i α l y i f m 1 x i f m 1 x i a negative gradient is also called pseudo residual the larger the residual r y f x the greater the difference between the result of the previous round of learner f x and the true value of y then the learner of the next round can correct the previous learners by fitting the residuals or negative gradients the loss function of the gradient boosting algorithm is defined by the following equation 14 j x i 1 n y i f x i 2 at the m th step the objective of the optimization is given as 15 j m x i 1 n y i f m x i 2 i 1 n y i f m 1 x i α m g x i 2 i 1 n r i α m g x i 2 where r i y i f m 1 x i is the residual in summary the process of the gradient boosting algorithm can be generalized into the following steps xiong et al 2018 inputs differentiable loss function l y f x training data set y i x i 1 n and number of iterations m 1 initialization f o x arg min f i 1 n l y i f x i 2 for m 1 to m a calculate the negative gradient y i f m 1 x i l y i f m 1 x i i 1 2 n b fit y i with the base learner gm x by minimizing the squared error w m arg min w i 1 n y i g m x i w 2 c use line search to determine the step size αm that minimizes l α m arg min α i 1 n l y i f m 1 x i α g m x i w m d f m x f m 1 x α m g m x w m 3 output fm x the commonly used base learner in the gradient boosting algorithm is the decision tree the gbdt is an algorithm that combines the two to solve regression problems in the gbdt algorithm the decision tree is regarded as a piecewise function that divides the feature space into several independent regions each of which is used to predict a constant in this algorithm a single decision tree can be expressed as g x r j b j 1 j j 1 j b j i x r j where r j 1 j is a divided independent region and b j 1 j is the output value in each region the αm in step 2 c of the algorithm flowchart is the same for all regions in the decision tree and thus does not minimize the loss function friedman friedman 2002 proposed that an optimal value γ m α m b jm be determined for each region r j making the expression in step 2 c become 16 γ m arg min γ x i r jm l y i f m 1 x i γ in summary the process of the gbdt regression algorithm can be generalized into the following steps wei et al 2019 1 initialization set f o x arg min f i 1 n l y i f x i 2 for m 1 to m a calculate the negative gradient y i f m 1 x i l y i f m 1 x i i 1 2 n b r jm 1 j arg min r jm 1 j i 1 n y i g m x i r jm b jm 1 j 2 c γ jm arg min γ x i r jm l y i f m 1 x i γ d f m x f m 1 x j 1 j γ jm i x r jm 3 output f m x 3 results and discussion 3 1 hongjiannao lake area landsat data were downloaded for free from the geospatial data cloud http www gscloud cn search a total of 53 scenes of image data with a cloud cover of less than 10 were selected from the period 1988 2018 for 1988 2012 one scene per year was selected with an imaging time between may and september to avoid the influence of ice melting on the lake area between 2013 and 2018 four to five scenes were selected each year to qualitatively analyze lake area changes the original remote sensing image data were first subjected to radiometric geometric and atmospheric correction preprocessing and the images were uniformly converted to the utm projection of the wgs 84 ellipsoid model fig 2 a shows that the changes in the hl area between 1988 and 2018 can be divided into three phases namely the stationary phase the shrinking phase and the rising phase as shown in table 1 from 1988 to 1998 the water area fluctuated slightly in the range of 50 96 to 54 59 km2 with a year to year change between 1 81 and 1 97 km2 indicating the hl was in a relatively stationary phase from 1998 to 2015 the water area decreased from 52 70 km2 to 30 10 km2 i e the lake area decreased by 22 6 km2 showing an overall continuous shrinking trend from 2015 to 2018 the lake area expanded from 30 10 km2 to 35 81 km2 i e the water area increased by 5 71 km2 during the three years suggesting that the hl was in a rising phase fig 2b shows the water level of the hl from 2015 to 2018 the variation curves of the measured water level and the hl area were interpreted using landsat data the variation trends in the lake area and the lake level were basically the same indicating accurate interpretation of the hl area from 1988 to 2018 by landsat data based on the overlay analysis of the lake area vector data by arcgis 10 2 software the spatiotemporal dynamic changes in the lake area during the stationary shrinking and rising phases were obtained fig 3 as shown in fig 3a the hl area changed dynamically between 1988 and 1998 with small areas e g green area in 1990 and yellow area in 1994 being covered and the hl area reaching a maximum of 54 59 km2 in 1993 the spatiotemporal variation in the hl area was concentrated in small parts of the northern western and southern regions of the hl according to fig 1 the northern region is the inflow region of the zr and the mdr the western region is the inflow region of the mgr and the southern region is between the inflow regions of the qr and er indicating that the amount of surface water entering the hl was the key factor in the dynamic changes during the stationary phase as shown in fig 3b the hl area decreased year by year from 1999 to 2014 and the regions with the most shrinkage of the hl area was located in the north and southeast during this period zr and mdr were cut off for the construction of reservoirs fig 1 blocking the surface water from entering the lake from the north while the shrinkage in the southeast was mainly due to the increase in human activities as a result of the development of the hongjiannao tourist area the gaolemiao water storage project was built in the middle reaches of the mgr but did not cut off the river fig 1 so the area of this river s inflow shrank relatively little all other regions showed a regular shrinking trend indicating that the changes in the hl area during this period were affected by both climate change and human activities since 2015 there has been a trend of the hl area expansion fig 3c with the inflow regions of the zr mgr and qr expanding obviously currently the zhasake reservoir releases approximately 3 million m3 of floodwater to the downstream lake region each year the qr has been renovated to increase the amount of water entering the hl and the implementation of other protection regulations has been key in the gradual expansion of the hl area the hb has a temperate continental semiarid climate and the hl is a typically closed inland lake in the desert region of northwest china the intra annual variation in the lake area is mainly affected by climatic factors and human activities liang and yan 2017 wang et al 2018a in this study the precipitation and evaporation data were collected from the meteorological station of yijinhuoluo banner in the period 1990 2018 to analyze the influence of climatic factors on the hl area the relationship between the hl area and the precipitation during 2014 2017 fig 4 a shows that the lake area fluctuated within each year the smallest lake area being in the rainy season july to september in 2014 2017 the average rainfall in august 2016 reached 219 9 mm which led to an increase in the hl area the evaporation data collected in the watershed were converted to natural water evaporation with the conversion factor z e0 e1 where e0 is the natural water evaporation mm e1 is the evaporation mm observed using a small evaporator with a diameter of 20 cm and the z value was set at 0 622 the relationship between lake area and water evaporation fig 4b shows that the corresponding lake area decreased continuously as evaporation increased and the water surface evaporation was the most important source of loss from the lake in general climatic factors have a significant impact on the hl area the lake water volume directly affects the changes in the lake area and the lake deficit is equal to the difference between the precipitation and the water surface evaporation multiplied by the hl area fig 4c shows the relationship between lake deficit and lake area between 1988 and 2018 the deficit decreased and the lake area increased accordingly during the stationary phase of the hl during the shrinking phase the relationship between the lake area and the lake deficit was not pronounced mainly due to the frequent human activities at this time in the hb the zhasake reservoir and the gaolemiao water storage project were constructed in the middle reaches of the zr and mgr respectively and a dam was built on the mdr to store water for power generation fig 1 all of these to a certain extent blocked surface water from entering the hl in addition the mining of the hongqinghe and mataihao coal mines and the establishment of groundwater sources in the hb led to changes in the local groundwater flow field and thus affected the groundwater recharge into the lake during the rising phase the lake deficit was negatively correlated with the lake area this is because the hongjiannao national nature reserve invested in the renovation of the qr and implemented other protection rules which increased the surface water inflow into the lake and regulated human activities these put the hl area into a trend of expansion overall the changes in the hl area have been a comprehensive reflection of the water budget of the lake quantitative analysis of the input from precipitation surface water and groundwater recharge and the output formed by the evaporation of lake water is the key to studying the lake area climate change and human activities are the main reasons for the overall shrinking trend of the hl area in the past three decades and human activities are the key factor in the lake changes 3 2 chahannao lake area the cl is another large lake in the hb and no surface river water flowing into it the main recharge sources of the cl are atmospheric precipitation and groundwater discharge and its discharge methods are evaporation and artificial mining we selected landsat image data to interpret the cl area and qualitatively analyze the relationship between the changes in the cl and hl areas during the same period as shown in fig 4d from 1988 to 1998 the hl was in a stationary phase and the variation in the cl area was basically consistent with that of the hl exhibiting certain fluctuations and being controlled by climatic factors from 1999 to 2014 the hl area decreased year by year while the cl area first increased and then decreased from 2015 to the present the hl area was in the rising phase and the cl area also increased year by year at a fast rate during the stationary and rising phases of the hl the changes in the cl area were consistent with those of the hl indirectly proving the impact of human activities on the hl area during the shrinking phase we further analyzed the relationship between the cl area and climatic factors as shown in fig 4e in region a red dotted area the fluctuation in the cl area and the climatic factors are clearly correlated with each other as evaporation increased and precipitation decreased the corresponding lake area decreased and the opposite also held the lake area in region b was basically unchanged and the precipitation and evaporation were also in a steady state in region c the cl area increased significantly the annual precipitation reaching 596 6 mm in 2016 after which the evaporation gradually decreased in summary the cl area was basically positively correlated with the annual precipitation and negatively correlated with the annual evaporation 3 3 hongjiannao lake level to analyze the relationships between the water level of the hl and climatic factors we collected daily lake level monitoring data and eight climatic factors air pressure air temperature humidity ground temperature precipitation evaporation wind speed and sunshine duration as shown in fig a2 the orange lines indicate the daily change in lake level from january 1 2015 to december 31 2018 the break in the orange line indicates that monitoring data were lost during this period the lake level exhibited a fluctuating upward trend overall in particular the lake level rose sharply at approximately 1 6 m from august 2016 to april 2017 moreover the lake level fell sharply and then rose rapidly from may 10 2015 to june 7 2015 which may have been due to human activities the change rule of air pressure followed a v like pattern as shown in fig a2a the lowest air pressure was concentrated in july august every year and there was no obvious relationship between the lake level and air pressure as shown in fig a2b the change rule of air temperature was contrary to that of air pressure showing an inverted v shape and the greatest air temperature was concentrated in july every year however the change in air temperature did not cause a greater response at the lake level as air temperature gradually rose in march april every year the lake level rose slightly due to melting ice on the hl the change rule of ground temperature was similar to that of air temperature fig a2d the maximum difference between the ground and air temperature was 9 8 c and the minimum difference was 3 4 c fig a2c shows that the humidity fluctuated irregularly throughout the year ranging from 10 5 to 95 0 precipitation was concentrated in july sep every year as shown in fig a2e in august 2016 heavy rainfall continued with maximum daily precipitation of 64 5 mm causing the lake level to rise sharply since 2015 there has been heavy rainfall every year so the lake level has continued to rise as shown in fig a2f the change rule of evaporation was basically the same each year and the evaporation was concentrated in april every year the lake level gradually dropped from july 2016 to july 2017 because there was no significant heavy rainfall and evaporation continued to increase the last two climatic factors wind speed and sunshine duration had no significant influence on the lake level and they changed irregularly fig a2g h in summary contrastive analysis of the lake level and each climatic factor did not reveal a significant influence of climatic factors on the change in the lake level next a gbdt regression model was used to quantitatively assess the relative importance of each climatic factor 3 4 lake level and groundwater level groundwater monitoring stations gms was located on the shore of the hl approximately 3 km from the lake fig 1 this monitoring station started operating in september 2017 fig a3a presented the daily variation curves of the lake level and groundwater level which fully demonstrated the intra annual dynamic characteristics of the groundwater level and its response to the changes in the lake level from january 2018 to april 2018 some lake level data were missing on march 4 2018 the lake level dropped sharply and then started to rise again probably due to the gradual melting of the ice on the lake surface at this time the groundwater level had an upward trend and groundwater runoff recharge also caused the lake level to rise after april 2018 the lake level and the groundwater level fluctuated in clear synchronicity overall spatially the changes in the lake level and the groundwater level showed a high degree of consistency indicating that the lakeshore groundwater level dynamically responds to changes in the lake level on the other hand the lakeshore groundwater level and lake level changes did not have a high degree of consistency on a daily time scale and the groundwater level dynamics had a certain lag in its response to the lake level changes which may be related to the groundwater runoff path fig a3b c shown the comprehensive analysis of cross wavelet and wavelet coherence between the water level of the hl and the groundwater level of the gms it can be seen from the cross wavelet plot in fig a3b that the lake level and the groundwater level shared common high energy signals over a long timescale and the mutual influence was concentrated within approximately 30 days indicating that they were highly significantly correlated in this period it can be seen from the wavelet coherence plot in fig a3c that for most of the year after approximately day 120 the lake level and the groundwater level were positively correlated with each other and the groundwater level changed before the lake level indicating that the groundwater change affected the lake level to some extent and that there was a certain lateral hydraulic connection between the lake level and the groundwater level 3 5 dynamic prediction of lake level based on the principle of the gbdt algorithm we used the daily lake level monitoring data from 2017 to 2019 as the output vector y and the meteorological data as the input vector set x 1 x 2 xn the climatic factors were precipitation evaporation air temperature ground temperature sunshine wind speed humidity and air pressure the daily lake level data and meteorological data constituted the training set y i x i 1 n for the gbdt model model 1 calculation the model 1 just was used to investigate the relative importance of each climatic factors and lake level fig 5 a shown the relative importance of the independent variables in the gbdt regression evaporation was the climatic factor that contributed the most to the dynamic change in the water level of the hl and precipitation had the least importance the climatic factors were ranked by relative importance as follows evaporation humidity ground temperature air temperature air pressure wind speed sunshine precipitation the relative importance of climatic factors is in line with the characteristics of the hb which is an arid semiarid region the above wavelet coherence analysis shown that the groundwater level was closely related to the lake water level the daily groundwater level was further considered as the independent variable of the gbdt regression model model 2 to analyze its relative importance to the dynamic changes of lake water level as shown in fig 5b the groundwater contributed the most to the dynamic change in the lake water level and climatic factors were ranked by relative importance as follows evaporation ground temperature sunshine air pressure air temperature humidity wind speed precipitation it is observed that model 2 had a slight influence on the relative importance of climatic factors the maximum relative importance for climatic factors also was the evaporation of 35 70 and the minimum relative importance was precipitation of 1 43 based on the relative importance of model 1 and model 2 the daily meteorological data and groundwater levels of 2020 was input as the independent variables of the model to predict the daily lake level in that year fig 6 a presented taylor diagrams illustrating the statistics of the measured lake level and predicted value to model 1 model 2 taylor diagrams provided the ratio of standard deviation sd as a radial distance and the pearson correlation on the main arc baik and choi 2015 it indicated the sd root means square deviation rmsd and correlation coefficient cc all of which were mutually dependent the sd and rmsd were normalized by the ratio of the predicted value and the measured value of the lake level good ranges of correlation were observed for model 2 with the value of between 0 9 and 0 95 while lower correlation ranges of near 0 8 were observed for model 1 meanwhile the sd and rmsd were observed for model 2 lower than that of model 1 on the basis of the results shown in the taylor diagram the predicted lake level of model 2 with a high cc and lower sd and rmsd indicated better performances than model 1 fig 6b shown the dynamic curves of the predicted values of the gbdt model 1 and 2 and the measured values of the lake level the trend of the predicted value for model 2 was closer to the measured value of the lake level which may be due to model 2 combing the climatic factors and groundwater level in model 2 we regarded the change of groundwater level as human activities also demonstrate that the change of the hl area rising phase was influenced by both climatic factors and human activities thus the regression model could be used to investigate the relative importance of climatic factors and predict the dynamic changes in the water level in order to yield the optimal performance for predicting the daily water level the data from 2017 to 2018 were used to train the gbdt model and then the trained model was tested on 2019 data to further tune the hyper parameters and validated the model performance the models that achieved the overall best performance on both training and testing data was further validated using 2020 data as shown in the first portion of fig 6b which utilized the climatic factors and groundwater level it can be observed that both model 1 and model 2 were able to make water level prediction close to the actual values and the predicted values obtained by model 2 i e the orange line was more accurate than model 1 therefore based on the gbdt regression model 2 the daily variation in the water level of the hl was predicted using 2021 meteorological data and groundwater level as shown in the second half of fig 6b the predicted results indicated that the daily values of the lake level from january to july 2021 would first slowly rise and then fall similar to the changes in the measured water level during the same period in 2020 which showed an overall upward trend overall this study made fully use of gbdt algorithm that not only investigated the strongly predictive features that significantly impacted the dynamic change in the lake water level using the impurity based feature importance but also built tested and validated an effective regression model to dynamically predict the daily water level of the hl 4 conclusions with a focus on the characteristics and driving factors of lake level variations of hongjiannao lake by climate change and human activities this study used remote sensing data to interpret the changes in the lake area analyzed the correlation between groundwater level and lake level using wavelet coherence and analyzed the relative importance of climatic factors and groundwater level to lake level changes and dynamically predicted the lake level using the gbdt regression model the following conclusions are drawn 1 changes in the hl area can be divided into three phases the stationary phase 1988 1998 the shrinking phase 1998 2015 and the rising phase 2015 2018 combing the cl area and meteorological data during the same phases the changes in the hl area must have been influenced by climatic factors during the stationary phase and by both climatic factors and human activities during the shrinking and rising phases 2 cross wavelet and wavelet coherence functions were used to analyze the relationship between groundwater level and lake level the lake level and the lakeshore groundwater level had common high energy signals on a long timescale and the mutual influence between was concentrated within a short lag period of approximately 30 days showing the strong connection between the two the lake level and the groundwater were positively correlated with each other and the groundwater level changed before the lake level indicating that the groundwater change affected the lake level to some extent 3 the relative importance of climatic factors and groundwater level to the lake level was analyzed using the gbdt regression model the results shown that evaporation made the greatest contribution to the dynamic changes in the lake level while precipitation made the least for only climatic factors however combing climatic factors and groundwater level in the model the greatest contribution was groundwater level and the second was the evaporation of 35 70 and the minimum relative importance was precipitation of 1 43 4 the meteorological data and groundwater level of 2020 were input as independent variables to dynamically predict the lake level using the model 1 and 2 the results shown that the predicted lake level of model 2 with a high cc and lower sd and rmsd indicated better performances than model 1 indicating high accuracy of the lake level prediction of model 2 on this basis the daily water level of the hl was predicted using climatic factors and groundwater level from january to july 2020 and the results shown that the lake level fluctuated upward declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national key research and development program of china no 2021yfc3000205 national natural science foundation of china no 41572227 and applied technology research and development program of heilongjiang province ga19c005 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 127654 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
