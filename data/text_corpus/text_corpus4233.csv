index,text
21165,hydrokinetic turbines are electromechanical devices which convert the kinetic energy of freely flowing water into electricity without accumulating water turbine blades are generated by optimally combining one or more types of blade sections the performance of blade sections is quite important directly affecting the power coefficient of the rotor since hydrokinetic technology is relatively a new branch of renewable energy blade sections optimized for wind turbines or aviation applications had hitherto been used however hydrodynamics of water should be better considered during design processes the main scope of this study is to optimize blade sections specifically for stall regulated hydrokinetic turbines considering high hydrodynamic forces cavitation leading edge contamination and ideal stall behavior differential evolution algorithm dea was employed for the optimization process five different primary hydrofoil families were optimized and they have been scaled for various regions along the blade lift drag transition and pressure coefficient performances of optimized sections have been analyzed and discussed with mostly used naca risø and nrel sections the optimized hydrofoils are found to deliver quite successful performance for hydrokinetic turbines based on design objectives constraints and comparing to the most preferred sections graphical abstract image 1 keywords hydrokinetic blade hydrofoil optimization stall differential evolution abbreviations b number of blades b blade s span length c chord length c d drag coefficient c l lift coefficient c l max maximum lift coefficient c p power coefficient c p pressure coefficient ϕ angle of relative velocity l d lift to drag ratio p power p atm atmospheric pressure p v vapor pressure p 0 local pressure q torque r radial distance of blade section s cavitation number t thrust u velocity of fluid particle u free stream velocity u cav cavitation velocity u rel relative velocity u t tangential velocity α angle of attack α d design angle of attack β twist angle ρ density 1 introduction blade profiles are the main components of hydrokinetic turbines similar to the aircraft unmanned aerial vehicles jet engines and wind turbines etc blade section blade profile airfoil or hydrofoil terms are interchangeably used in the related literature mainly the blade sections which are used in the aquatic environments are referred to as hydrofoils turbine propellers are constructed by using at least two identical blades each blade is composed of combining one or more blade sections having different lengths thickness twist angles etc characteristics the power output of the turbines is greatly related to the hydrodynamic performance of the utilized blade sections at present the number of airfoils particularly optimized for wind turbines is quite sufficient in the literature dahl and fuglsang 1998 derakhshan et al 2015 ram et al 2012 ribeiro et al 2012 however the number of blade profiles for hydrokinetic technology is limited and designers have been constrained to use wind turbine airfoils since the aquatic environment has different characteristics from the air wind turbine blade profiles exhibit undesirable hydrodynamic performance in hydrokinetic turbines and cannot be fully applied to this area on the other hand the number of optimization studies on stall regulated hydrokinetic turbines is very limited and available works have insufficient stall performance and undesirable sensitivity to the leading edge contamination han et al 2018 soltani et al 2011 wind turbine blade sections are designed to be relatively thin to maximize power production li et al 2020 water is approximately 830 times denser than air and hydrokinetic turbine blades are subjected to higher forces niebuhr et al 2019 than same scale wind turbines causing structural strength problems therefore hydrokinetic turbine blade sections should be thicker than that of wind turbines bryden et al 2004 goundar and ahmed 2013 the majority of naca airfoils are not suitable in hydrokinetic turbines because of their poor stall characteristics low structural efficiencies deteriorating performance at different re numbers and undesirable results due to leading edge contamination ahmed 2012 the hydrokinetic turbine design provided by kolekar and banerjee 2013 employs a single type of blade section sg6043 from root to tip this section has been developed for relatively small scale and variable speed wind turbines having a thickness of 10 giguè re and selig 1998 as we mentioned above thin blade sections may provide relatively high power but it is likely to cause structural problems in hydrokinetic turbines similarly a universal hydrokinetic turbine blade was optimized by wu et al 2013 using naca 63 815 profiles having a single percent thickness from root to tip however torque on the turbine blades is maximized toward the root therefore it is essential to consider increasing the percent thickness of employed foils from root to tip region of the blade goundar et al 2012 this situation necessitates considering more than one type of blade profile on the other hand the cavitation problem encountered in hydrokinetic turbine blades has been outlined by many literature studies fontaine et al 2020 mohammadi et al 2020 silva et al 2017 to the authors high hydrodynamic loads and the risk of cavitation must be specifically considered in hydrokinetic turbines it is reported that the risk of cavitation can be significantly reduced by using appropriate hydrofoils batten et al 2008 silva et al 2015 nevertheless the number of design studies taking cavitation into account is limited silva et al 2015 and designers are constrained to choose wind turbine blade sections that may not be suitable in hydrokinetic turbines g25sx6 wind turbine blade section having 25 thickness was optimized by grasso et al 2017 their study is provided for air environment and cavitation risk has not been separately investigated risø a1 profile family 24 21 and 18 thicknesses which was developed for wind turbines is employed by grogan et al 2013 at a design work of a hydrokinetic turbine having 12 m blade length and 1 5 mw nominal capacity similarly muratoglu and yuce 2017 designed a river hydrokinetic turbine employing the risø a1 type of airfoil family however risø sections were developed for wind turbines and more studies are required for testing their applicability in hydrokinetic turbines likewise relatively a smaller scale hydrokinetic turbine having 0 8 m rotor diameter was designed by anyi and kirke 2011 using s822 type of profiles which were developed by nrel while cavitation is a primary characteristic of the blade section they tried to prevent cavitation by modifying the rotational speed of the rotor or changing the hydro mechanical properties of the turbine due to the lack of cavitation tolerant hydrokinetic turbine blade sections there are several hydrodynamic differences between hydrofoils utilized by stall and pitch regulated turbines therefore the type of regulation control mechanism stall or pitch regulation must be considered in the optimization process the total torque generated by the rotor has been automatically optimized in pitch regulated turbines therefore the maximization of lift drag ratio l d at a narrow range of the c l α curve becomes sufficient however stall regulated turbines do not employ such an automatic process and l d ratio should particularly become high at a relatively wider range of angles of attack dahl and fuglsang 1998 the post stall condition should also be considered at the optimization works sharp stall curve of blade sections could lead to undesired performance generating sudden loads vibration fatigue and noise problems on the blades grasso et al 2017 consequently the most convenient and efficient situation in stall regulated turbines can be obtained by reducing the lift coefficient and increasing the drag coefficient smoothly in the post stall region ahmed 2012 grasso et al 2017 turbine blades are exposed to dust dirt insects and other substances due to the continuous movement of fluid around them han et al 2018 sagol et al 2013 accumulation of these small particles increases surface roughness especially at the leading edge site this process is known as leading edge contamination and significantly reduces the performance resulting in undesired flow separation at the transition region the performance loss becomes more critical in stall regulated systems it has been reported that the airfoil performance can be reduced by up to 40 due to the leading edge contamination manwell et al 2009 another study conducted by nrel claims that leading edge pollution had undesirable effects on naca 44 naca 23xxx naca 63xxx nasa ls 1 series of blade sections of wind turbines tangler and somers 1995 it has been observed that the energy loss due to leading edge contamination somehow reduces the maximum lift coefficient c l max tangler and somers 1995 therefore c l max should be limited to reduce off design loads generated in case of exceeding design rated power ahmed 2012 likewise tangler and somers 1995 calculated that the limitation of maximum lift coefficient could increase the performance of stall regulated turbines by 23 35 and may facilitate to use 10 15 more disk sweeping area for a given generator scale the vulnerability of all blade sections to the leading edge contamination is not similar and the minimum level of sensitivity is the desired design criterion there is an important deficiency in the literature regarding the hydrokinetic turbine blade profiles while the majority of existing hydrokinetic turbines which are in operation employs stall regulation mechanism the number of blade sections specifically developed for stall regulated hydrokinetic turbines is found to be inadequate for both quantity and performance the main scope of this study is to optimize blade sections for stall regulated hydrokinetic turbines taking the hydrodynamic requirements into account in this study different blade profiles have been optimized in order of having different thicknesses along the turbine blade for better structural strength sections 3 1 3 2 also the cavitation phenomenon has been considered in the design phase on the other hand the stall behavior of the blade section is of special importance in order to prevent the turbine rotor from unwanted loadings vibration noise and deformations in this study a relatively smooth post stall behavior is aimed to deliver high power at a relatively wider range of α which is also suggested by ahmed 2012 although preventing early flow separation due to leading edge contamination is an important design criterion the number of studies considering this problem on the design process is quite limited goundar et al 2012 goundar and ahmed 2013 grasso 2012 kolekar and banerjee 2013 luo et al 2014 ouyang et al 2006 wu et al 2013 zhang et al 2016 in this study we considered preventing leading edge contamination by constraining the maximum lift coefficient mentioned aero hydrodynamic prerequisites have been introduced as optimization constraints and objective functions the performance predictions of blade sections were provided by the xfoil panel code integrating with the differential evolution algorithm dea which is controlled at the matlab interface detailed knowledge on the mathematical description of the foil geometry and dea optimization process is provided in section 2 2 theory and methodology 2 1 loads generated on blade profiles torque q and thrust force t are two major loads generated on the blade sections the total power converted by the turbine is equal to the net torque multiplied by the angular velocity thrust is defined as net force developed by the effect of fluid s movement accordingly the torque should be maximized and the thrust should be minimized in order to attain maximum efficiency based on one dimensional momentum rotor disk and blade element momentum theories the net torque and thrust forces on each differential circular section of the turbine can be written as follows manwell et al 2009 1 d q b 1 2 ρ u r e l 2 c c l sin ϕ c d cos ϕ r d r 2 d t b 1 2 ρ u r e l 2 c c l cos ϕ c d sin ϕ d r where q is torque t is thrust force b is the number of blades ρ is density u rel is the relative velocity c is chord length c l is the lift coefficient the c d is the drag coefficient and ϕ is the angle of relative velocity net lift and drag forces generated on the blade profiles can be written as 3 d 1 2 ρ u r e l 2 b c c d 4 l 1 2 ρ u r e l 2 b c c l where d is the net drag force l is the lift force and b is the blade s span length the angle and magnitude of the relative velocity vector u rel at different positions on the turbine blade are represented in fig 1 the tangential velocity in any section of the blade is a function of the angular velocity multiplied by the total distance to the hub while the tangential velocity vector u t in the root section is relatively small its magnitude increases toward the tip according to equation 1 u rel is one of the most important parameters that affect the overall power of the turbine since u rel is the resultant of u t and free steam velocity u vectors the angle of relative velocity ϕ would decrease toward the tip in order to ensure a uniform angle of attack along the turbine blade a twist angle β is defined for each blade segment in fig 1 u rel is the relative velocity u t is the tangential velocity u is the free stream velocity ϕ is the angle between relative velocity and tangential velocity vectors α is the angle of attack the angle between chord length and relative velocity and β is the twist angle the angle between chord length and tangential velocity vector 2 2 numerical performance analyses experimental analysis of three dimensional sections in water or wind tunnels is relatively expensive and time consuming work instead numerical panel codes such as xfoil javafoil profil and ellipsys2d have been developed in which aero hydrodynamic performance outputs of 2d geometries can be determined xfoil is a fast and effective interactive algorithm drela 2001 developed for the design and analysis of two dimensional blade profiles under subsonic viscous and non viscous flow conditions drela 2013 in this study we employed the xfoil code to obtain hydrofoils hydrodynamic performance parameters c l c d stall behavior c l α and c d α curves l d c l max c p the panel code has been integrated with dea via matlab interface and the performance has been analyzed for the geometries which are generated iteratively detailed numerical analyses of optimum shapes were provided by the xflr5 algorithm which has been created by rewriting xfoil with c having additional graphical user interface specialties uiuc 2018 2 3 cavitation on blade profiles if the absolute value of pressure coefficient c p around the blade profile exceeds the cavitation number the section incepts cavitation molland et al 2004 equation 5 the pressure coefficient is a non dimensional parameter that shows the relative pressure around the blade profile in this study the distribution of c p around 2d blade sections is calculated by the xfoil panel code it is reported that sufficient information about the cavitation inception of hydrofoils could be provided from the xfoil algorithm molland et al 2004 the pressure coefficient and the cavitation number can be given as follows 5 c p σ 6 c p p 0 p 0 5 ρ u 2 1 u u 7 σ p 0 p v 0 5 ρ u 2 where σ is the cavitation number c p is the pressure coefficient p is the static pressure of free stream u is the velocity of fluid particle u is the velocity of free stream p 0 is the local pressure and p v is the vapor pressure of water 2 4 mathematical description of profile geometry robustness and efficiency of the optimization work greatly depend on the suitable and accurate representation and parametrization of the studied geometry pérez arribas and castañeda sabadell 2016 generally blade sections are commonly expressed using a data file containing two dimensional cartesian coordinates of dozens of independent usually more than 100 points however making logical changes at each separate point is a very time consuming operation at the optimization stage instead the expression of the upper and lower surfaces of the blade sections by b spline or bezier curves prautzsch et al 2002 which are also known as nurbs non uniform rational b spline is a commonly used technique in the literature cocke et al 2014 goundar and ahmed 2013 grasso 2012 hafez et al 2001 ouyang et al 2006 yang and shu 2012 b spline curves facilitate to provide effective local geometric modifications and control of the foil geometry wang et al 2013 in this manner the number of design parameters can be substantially reduced while maintaining sufficient freedom and flexibility for representing a large number of data points pérez arribas and castañeda sabadell 2016 in the present study b spline curves have been employed for mathematical representation of the 2d geometry of blade profiles parametrization of the airfoil shape with b spline curves is illustrated in fig 2 the airfoil geometry has been defined by two different b spline curves for pressure and suction sides lower and upper surfaces separately each spline has been generated by 7 control points cp having a polynomial degree of k 4 control points are specified to be at the critical locations required for better geometrical modeling and modification cps that define exactly the leading 0 0 and trailing 1 0 edges were assigned to have no degrees of freedom cp no 1 7 8 and 14 the remaining cps were defined to move freely on x and y axes within proposed limits the freedom of cps is reported in section 2 5 1 design variables 2 5 optimization algorithm relative to the experimental and simulation works optimization algorithms provide the most simple and cost effective solution for obtaining blade sections having desired performance the main reason for this achievement is their searching strategy unlike the other approaches optimization algorithms do not rely on searching and trying all possibilities instead it is aimed to reach the best solutions by testing the performance of the model at each trial using an objective function in this study the optimization process has been conducted based on differential evolution algorithm dea dea is a metaheuristic method that searches the global optimum this searching process is based on determining optimal parameters via the evolution of a population iteration in each of the iterations the searching is done around the best solutions i e the individuals that have the lowest costs peng et al 2018 storn and price 1997 2015 it was reported that dea provides better global convergence and robustness than the genetic algorithm furthermore it is easier and requires a lower number of parameters compared to the genetic algorithm das and suganthan 2011 each step of the dea algorithm employed in this study has been briefly described below step 1 assigning population the control parameters of evolution the cost function and termination criteria step 2 randomly generation of a population and calculating the cost of each individual in the population step 3 do until reaching any of the termination criterion e g cost or maximum number of evolutions step 3 1 mutation with difference vectors x r 1 g x r 2 g and x r 3 g based on the mutation scale f and generate a new vector v g 8 v g x r 1 g f x r 2 g x r 3 g step 3 2 crossover according to crossover constant c r step 3 3 calculating the cost of the evolved population step 3 4 selection of optimized individual according to the lowest cost step 4 go to step 3 2 5 1 design variables during the iterations the control points are modified according to the employed optimization algorithm s constraints in order to maximize the objective function thus the design variables are assigned to be x and y coordinates of the cps of b spline curves the specified spline curves and control points have already been illustrated in fig 2 the initial airfoil geometries were randomly generated according to position and freedom intervals given in table 1 2 5 2 optimization constraints many studies report that leading edge contamination reduces the overall efficiency of the stall regulated turbines ahmed 2012 dahl and fuglsang 1998 manwell et al 2009 somers 1997 tangler and somers 1995 thus the energy loss due to contamination would be prevented if the maximum lift coefficient c l max is restricted high c l max would result in leading edge contamination while its lower value causes lower lift performance dahl and fuglsang 1998 proposed a c l max value around 1 6 1 7 for stall regulated wind turbines accordingly in this study an upper bound of 1 7 has been assigned as an optimization constraint in order to prevent the blade sections from the unwanted effects of flow separation and for delivering reasonable lift performance on the other hand sharp post stall behavior and suddenly decreasing lift coefficient is not recommended for stall regulated turbines ahmed 2012 grasso et al 2017 also high l d performance is desired at a wide range of α fig 3 in this study targeted lift and drag performance were assigned to be optimization constraints for this purpose the c l and l d performance of each individual geometrical shapes generated by iterations were tested for an α range between 0 and 25 with an increment of 1 the individuals were allowed to be reproduced by dea if their c l α curve exhibit slowly decreasing behavior without abrupt changes the same criterion is applied to both sides of the l d α curve new generations fitting gaussian distribution without instantaneous changes are accepted and survived the state of cavitation is also important to be considered in the hydrodynamic optimization process as a design constraint the cavitation number is estimated by calculating the pressure coefficient around the blade profile equation 5 in this study the minimization of the pressure coefficient is defined to be a parameter of the cost function 2 5 3 cost fitness objective function the accurate definition of objectives is one of the most important steps of any optimization problem in order to calculate the performance of each individual a cost function has been employed as proposed by dahl and fuglsang 1998 the cost function is defined to be a linear combination of various objectives and a weight factor is utilized for each target equation 9 determination of weight factors is also important and should be specified by the designer dahl and fuglsang 1998 9 f i 1 n w i f i the parameters affecting the total power and thrust of the rotor are defined in equations 1 and 2 here the parameters related to blade sections can be listed as c l c d α and u rel reducing c d directly increases the hydrodynamic efficiency of turbines by increasing the amount of torque and decreasing overall drag on the other hand sufficiently high c l is a desirable design criterion however maximization of lift coefficient increases the overall thrust to a certain extent which is undesirable thus the direct maximization of the lift coefficient has no significant effect on hydrodynamic efficiency which is also reported by ahmed 2012 consequently the objectives and weights of optimization components are reported in table 2 here each listed component is represented by a logical value new geometries introduced in the optimization algorithm are tested according to their total cost which is calculated based on the objective function table 2 if the overall score of a new section is greater than the minimum cost in the same population that geometry is added as a new foil by replacing the geometry of the minimum objective function the weight of the individual geometries that do not fit the optimization constraints section 2 5 2 is multiplied by 0 the weight of individuals that obey the optimization constraints is multiplied by 1 in this way the newly developed geometries that fit the optimization constraints are sustained and their relevant weight is added to the cost score generated sections that do not respect the optimization constraints are ignored and the total score remains unchanged the weights have been specified by the optimizers to deliver acceptable results accordingly the most important objective is to maximize the l d ratio within the limit of design constraints similar to the majority of the related optimization works that exist in the literature goundar et al 2012 goundar and ahmed 2013 grasso 2012 luo et al 2014 ouyang et al 2006 yu et al 2014 new generations having maximum cost function is allowed to be reproduced by the dea 2 5 4 termination criteria the reason for checking or applying a termination criterion is to decrease the computational cost and achieve a faster solution in this study the termination criteria is specified to be either reaching the maximum number of iterations or achieving the optimization objective consequently the optimization flow chart that is employed in this study is illustrated in fig 4 3 results and discussion generally the average free stream velocity of natural flows river tidal and ocean currents vary between 1 3 and 3 5 m s johnson and pride 2010 vinod and banerjee 2019 thus the hydrokinetic turbines should be designed to be operated in this range however the lift and drag performance of turbomachinery is a function of relative velocity u rel rather than the free stream speed section 2 1 u rel is maximized towards to the blade tip as a function tangential velocity fig 1 thus the re number should be specified considering u rel in this study design re number re d is specified to be 1 106 which is approximated for an airfoil having 0 2 m chord length and 5 m s relative water velocity it is explicit that the re number varies at different positions on the blade and around the blade section like many optimization studies we preferred to use a constant and common re number for better comparison of optimized geometries within this study and other literature studies re d has been inputted as a default value to the optimization algorithm on the other hand the specification of the design angle of attack α d is provided based on the intended stall behavior α d is usually suggested to be 1 2 below c l max for stall regulated turbines dahl and fuglsang 1998 accordingly the α d has been specified to be 9 to prevent an early stall and to assure a softer stall behavior ahmed 2012 grasso et al 2017 no forced trip location for the transition has been specified n crit which is a measure of free flow turbulence is remained to be the default value of 9 xfoil accordingly after various test running processes the optimum generations were obtained around 16 h using a computer having intel i7 ghz processor and 16 gb ram generated sections were analyzed for a wide range of α between 0 and 25 convergence problems have been encountered in xfoil for various sections at different angles of attack the performance predictions for non converged individuals were ignored for the angles of attack in which the convergence problem is encountered it should be stated that restraining c l max is an important limitation for obtaining individuals of high performance impeding the optimization algorithm to reach the local optima furthermore strict percent thickness values have not been assigned and a wide range of freedom was allocated for control points of b spline curves on x and y axes in order to keep the design space as high as possible generally available literature studies rely on an initial airfoil having desired performance and thickness characteristics nrel s s821 and s819 sections were used as reference airfoils by grasso et al 2017 again the s1210 airfoil was selected as a base section by goundar and ahmed 2013 and goundar et al 2012 modifying the maximum chamber and maximum thickness in the present study an initial airfoil section has not been employed in order of providing a wide solution space and searching the best individuals fitting objective function initially 50 primitive generations were randomly produced based on the geometrical design variables that are detailed in table 1 then primitive geometries were improved after an optimization process of 1000 iterations primitive and optimized generations were illustrated in fig 5 for better comparison showing the evolution of the blade profiles 3 1 primarily optimized sections initial hydrofoil data were randomly generated for different thicknesses it has been seen that the first shapes do not represent regular airfoil shapes fig 5 since the preliminary sections were randomly produced the dea can produce optimum sections due to their nature at the end of optimization the best sections having the desired c l α curve and highest cost function were selected as the primary optimized sections accordingly five different blade sections of various thicknesses were generated with different initial populations and called as mte profiles the first letter of author surnames respectively finally the hydrofoil geometries after the optimization process are completely different from the first geometries owing to the objective function the letter after the hyphen symbolizes separate airfoil families generated through different optimization processes which were applied by changing the parameters of dea these sections were illustrated in fig 6 and their lift and drag performances were provided in fig 7 primary sections fig 6 have different geometrical details as a result of the evolution of design variables to satisfy the constraints basically the optimized sections can be characterized to have a relatively flat pressure side and highly curved suction side here sections mte a and mte d have relatively thick leading edges mte d has quite desirable lift performance where c l gradually decreases after stall fig 7 however the relatively lower l d ratio of this profile is a disadvantage for performance on the other hand mte c has relatively flat stall behavior where the stall is observed at lower angles of attack contrary to their geometrical differences mte a mte b and mte d sections have a quite similar lift and drag performance all the generated sections have a linearly increasing lift behavior until c l max point 3 2 scaling the primary sections it is a well known situation that the percent thickness of the profiles has significant effects on the performance dongli et al 2015 reported that thinner airfoils deliver a higher l d ratio and provide good stall characteristics in this study the primarily generated blade profiles do not exactly have the same thicknesses thus we standardized and scaled them at a constant thickness for better performance comparison among various profiles fig 8 xflr5 algorithm s scale camber and thickness option have been used for this operation here the position on the x axis of the camber maximum thickness and the value of maximum camber remained unchanged while only the thickness at chord has been varied and scaled to the desired ratio many studies outline the importance of employing relatively thicker sections in hydrokinetic turbines especially for the middle and root sections of blades ahmed 2012 bryden et al 2004 goundar et al 2012 goundar and ahmed 2013 accordingly in this study each primary profile fig 6 were scaled to have the integer numbers of 12 15 18 21 24 27 and 30 thicknesses an airfoil family consisting of seven different thicknesses was generated from each primary profile in order of obtaining a wide range of thickness category then the performance of each primary airfoil family was compared with the other sections having the same thickness the profiles delivering the maximum l d ratio at a wide range of α and having desired lift characteristics were reported in fig 9 the xflr5 analysis results for lift drag and pressure coefficient distributions along the section at different angles of attack are illustrated in fig 10 3 3 performance comparison naca 63 and 44 4 digits series lawson et al 2011 risø a family of airfoils bertagnolio et al 2001 dahl and fuglsang 1998 and nrel s profiles ahmed 2012 tangler and somers 1995 are among the mostly employed blade sections in hydrokinetic turbines mohammadi et al 2020 several more studies have been conducted for the optimization of blade sections for stall regulated turbines grasso et al 2017 studied on airfoil optimization for stall regulated wind turbines however since the hydrodynamic properties of the water environment have not been considered their outcomes would not be convenient for hydrokinetic turbines on the other hand many recent design works on wind turbine sections have not shared their final geometries goundar et al 2012 goundar and ahmed 2013 which makes it impossible to analyze hydrodynamic properties the design works of hf10xx and hf sx profiles reported by goundar and ahmed goundar et al 2012 goundar and ahmed 2013 specifically considers the cavitation phenomenon however they exhibit sharp and abrupt post stall mechanism g hydra a section designed by grasso 2012 shows sudden changes at the stall curve on the other hand naca 63 618 profiles were used as hydrofoil in several hydrokinetic turbine design works arzu et al 2017 lust et al 2018 luznik et al 2012 similarly the naca 4418 profile has been utilized as a reference section in hydrokinetic turbines badea et al 2014 noruzi et al 2015 shiu et al 2012 risø a 18 airfoil has been employed in a number of studies ahmed 2012 implying its low risk of cavitation due to its relatively small c p nrel s s825 and s833 sections designed for wind turbines to be a thick airfoil family buhl 2020 delivering good aerodynamic performance especially at low re number sun et al 2019 again s833 was used as the primary section of tidal current turbines vanzwieten et al 2011 in this section the performance of naca 63 3 618 naca 4418 risø a 18 nrel s825 and nrel s833 profiles were compared with the mte b18 profile which is optimized in this study each of these profiles has approximately 18 thickness the geometry of these sections is reported in fig 11 their performance comparison is provided in fig 12 accordingly mte b18 hydrofoil has relatively similar c l behavior with naca 4418 and nrel s825 profiles where c l max is slightly higher than both sections although delivering high c l is advantageous for higher torque in this study it has been limited at 1 7 by the optimization algorithm to prevent the sections from leading edge contamination similarly a sharply decreasing lift coefficient is not a desired property for the post stall region in stall regulated turbines owing to the design constraints mte b18 profiles and other hydrofoils optimized in this study are found to be successful in terms of post stall behavior c d of mte b18 profile is minimized especially for an α range until 13 minimization of the drag coefficient is a desired property to maximize the delivered torque and efficiency of the rotor constructed from this section as illustrated in optimization objectives section 2 5 3 on the other hand the mte b18 section delivers quite a high lift to drag ratio maximum l d ratio is 135 at a wide range of angles of attack relative to naca risø and nrel sections analyzed in this study it should be noted that thinner profiles deliver a higher l d ratio and the primary profiles optimized in this study exceeds a maximum l d ratio of 150 fig 7 finally naca 63 3 618 nrel s825 and s833 profiles would have undesired consequences in hydrokinetic turbines while mte b18 represents quite low pressure coefficient distribution which is very important to prevent cavitation risø sections are mostly preferred because of their low cavitation risk here the maximum c p of the mte b18 section is found to be lower than risø a 18 representing minimized the risk of cavitation showing the success of the optimization algorithm equations 5 7 3 4 reliability and validation of xfoil xfoil code employs a linear vorticity second order panel method coupled with an integral boundary layer method and en type transition prediction model yirtici et al 2019 owing to its high speed and accuracy xfoil is commonly preferred in many optimization codes timmer and bak 2013 many studies compared the performance of xfoil with respect to experimental studies cfd analyses and other panel codes mohammadi et al 2020 validated the xfoil algorithm comparing the experimental results and reported around 10 error for naca 4415 airfoil similarly morgado et al 2016 compared the xfoil with cfd algorithms and noted that overall best prediction results are delivered by xfoil relative to the computational studies even that of having the capability of boundary layer transition detection on the other hand rfoil is an improved derivative of xfoil that is developed by the national aerospace laboratory of netherlands and delft university of technology timmer and bak 2013 implementing the extended boundary layer equations montgomerie et al 1997 it is reported that rfoil provides better convergence around the maximum lift owing to the modifications at the calculations of turbulent boundary layer shape factors timmer and bak 2013 li et al 2020 compared both codes considering the experimental results and reported that xfoil and rfoil codes delivered approximate results at the linear region before stall however xfoil exhibited overestimation at the lift coefficient while rfoil underestimated the drag coefficient li et al 2020 fig 13 includes the comparison of xfoil and rfoil for mte a15 hydrofoil which is optimized through this study at re 1 106 accordingly it is observed that while the stall behavior and c l max characteristics are similar in both codes rfoil delivered a slightly lower lift coefficient and lower l d ratio after stall 3 5 applicability of genetic algorithm ge and particle swarm optimization pso in this section ge and pso which are among the other popular optimization methods have been compared with dea both algorithms were run using the same methodology as for dea described in section 2 the comparison is provided based on the same parameters in the objective function listed in table 2 the performance outputs of the optimized geometries c l l d and c p with respect to α after 1000th iteration are summarized in table 3 accordingly the obtained results were found to be approximated to each other the most ideal stall curve section 2 5 2 was obtained from dea algorithm while pso exhibited a relatively sharp stall which is not intended within the scope of this study dea and ge represented quite similar c l α curve while dea has slightly higher performance in terms of power production overall it can be stated that both ge and pso would also be employed in the optimization problem within the scope of this study to the authors neither of these optimization methods guarantees the same results in every trial due to their methodology e g random determination of the initial population consequently the main advantage of dea is its simple and effective searching algorithm and simplicity in creating new populations this simplicity gives dea a higher searching range and better optimization capability 3 6 limitations and future studies the maximizing lift coefficient is mainly the desired property in terms of power production however it would be quite disadvantageous resulting in leading edge contamination nevertheless to date literature studies do not agree on a specific c l max behavior thus more studies especially experimental are needed on the flow separation and leading edge contamination problems in hydrokinetic turbines in order to avoid unnecessarily reducing the turbine performance also in this study thickness is not defined as an optimization constraint to keep the solution space as wide as possible instead thickness distributions for root and primary regions of the blade are manually obtained employing the xflr5 algorithm keeping the position and value of maximum camber unchanged although there are several literature studies employing similar methodology the effect of scaling on the performance and stall behavior is not clear yet assigning thicknesses as an optimization parameter would also be an alternative choice for future studies on the other hand in this study only hydrodynamic properties are included as design objectives and constraints coupled hydro structural design optimization is suggested by many studies for 3d blade or rotor optimization garg et al 2019 kolekar and banerjee 2013 garg et al 2017 reported that hydro structural optimization may lead to completely different geometry relative to hydrodynamic only optimization therefore the structural requirements of the 3d blades that are constructed from the proposed hydrofoils should also be considered by blade designers using xfoil in the post stall region is another limitation of this study the code delivers reasonable performance at the attached flow before the stall region where the potential flow theory is valid marten et al 2016 which is found to be sufficiently accurate at the conceptual design phase morgado et al 2016 good agreement with the wind tunnel experimental data is attained at low angles of attack liang and li 2018 however several pieces of research noted its undesirable performance and poor results in the post stall region due to the incapability of resolving the boundary layer and flow separation battisti et al 2020 dahl and fuglsang 1998 it is reported that drag coefficient is underestimated morgado et al 2016 and lift coefficient is overestimated abutunis et al 2020 by the xfoil at higher angles of attack it should be stated that low order panel methods deliver satisfactory results up to the stall point however beyond the stall the airfoils exhibit similar to a bluff body battisti et al 2020 in fact modeling the aero hydrodynamic performance of the blade sections or airfoils at high angles of attack is found to be quite difficult higher order methods are strongly recommended by the researchers to eliminate this deficiency necessitating massive computational time and effort at each specific angle of attack is the main disadvantage of higher order methods mukherjee and gopalarathnam 2006 polat 2011 different post stall extrapolation methods such as montgomerie viterna corrigan kirke models bianchini et al 2015 liang and li 2018 and numerical analyses based on navier stokes solvers for 2d and 3d steady and unsteady domains morgado et al 2016 are also suggested by researchers again in this study α d and re number are specified to be constant through the optimization process future studies would consider optimization for a range of α and re number finally the authors believe that the airfoil hydrofoil optimization works will tend to be device specific in the future considering more specific dynamic and geometrical conditions of the working environment where energy will be extracted 4 conclusion in the literature the number of blade sections specifically optimized for stall regulated hydrokinetic turbines is quite limited thus designers are constrained to use wind turbine airfoils which deliver undesirable performance in hydrokinetic turbines in this study hydrofoil geometries were optimized mte considering high hydrodynamic loads cavitation risk speed regulation mechanism and leading edge contamination optimized sections exhibit quite satisfactory results achieved the optimization constraints and delivered good performance comparing to the mostly used naca nrel and risø sections the authors believe that this research will contribute to the hydrokinetic turbine design studies for better performance and efficiency and decrease the dependency of wind turbine blade sections funding this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors data availability the coordinates of the hydrofoils optimized in this study are confidential and not publicly available because of a pending patent application for a new industrial product credit authorship contribution statement abdullah muratoglu conceptualization resources methodology investigation visualization writing original draft validation data curation ramazan tekin software writing review editing formal analysis ömer faruk ertuğrul software supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank dr huseyin ozdemir university of twente and tno the netherlands for providing the rfoil code and its documentation 
21165,hydrokinetic turbines are electromechanical devices which convert the kinetic energy of freely flowing water into electricity without accumulating water turbine blades are generated by optimally combining one or more types of blade sections the performance of blade sections is quite important directly affecting the power coefficient of the rotor since hydrokinetic technology is relatively a new branch of renewable energy blade sections optimized for wind turbines or aviation applications had hitherto been used however hydrodynamics of water should be better considered during design processes the main scope of this study is to optimize blade sections specifically for stall regulated hydrokinetic turbines considering high hydrodynamic forces cavitation leading edge contamination and ideal stall behavior differential evolution algorithm dea was employed for the optimization process five different primary hydrofoil families were optimized and they have been scaled for various regions along the blade lift drag transition and pressure coefficient performances of optimized sections have been analyzed and discussed with mostly used naca risø and nrel sections the optimized hydrofoils are found to deliver quite successful performance for hydrokinetic turbines based on design objectives constraints and comparing to the most preferred sections graphical abstract image 1 keywords hydrokinetic blade hydrofoil optimization stall differential evolution abbreviations b number of blades b blade s span length c chord length c d drag coefficient c l lift coefficient c l max maximum lift coefficient c p power coefficient c p pressure coefficient ϕ angle of relative velocity l d lift to drag ratio p power p atm atmospheric pressure p v vapor pressure p 0 local pressure q torque r radial distance of blade section s cavitation number t thrust u velocity of fluid particle u free stream velocity u cav cavitation velocity u rel relative velocity u t tangential velocity α angle of attack α d design angle of attack β twist angle ρ density 1 introduction blade profiles are the main components of hydrokinetic turbines similar to the aircraft unmanned aerial vehicles jet engines and wind turbines etc blade section blade profile airfoil or hydrofoil terms are interchangeably used in the related literature mainly the blade sections which are used in the aquatic environments are referred to as hydrofoils turbine propellers are constructed by using at least two identical blades each blade is composed of combining one or more blade sections having different lengths thickness twist angles etc characteristics the power output of the turbines is greatly related to the hydrodynamic performance of the utilized blade sections at present the number of airfoils particularly optimized for wind turbines is quite sufficient in the literature dahl and fuglsang 1998 derakhshan et al 2015 ram et al 2012 ribeiro et al 2012 however the number of blade profiles for hydrokinetic technology is limited and designers have been constrained to use wind turbine airfoils since the aquatic environment has different characteristics from the air wind turbine blade profiles exhibit undesirable hydrodynamic performance in hydrokinetic turbines and cannot be fully applied to this area on the other hand the number of optimization studies on stall regulated hydrokinetic turbines is very limited and available works have insufficient stall performance and undesirable sensitivity to the leading edge contamination han et al 2018 soltani et al 2011 wind turbine blade sections are designed to be relatively thin to maximize power production li et al 2020 water is approximately 830 times denser than air and hydrokinetic turbine blades are subjected to higher forces niebuhr et al 2019 than same scale wind turbines causing structural strength problems therefore hydrokinetic turbine blade sections should be thicker than that of wind turbines bryden et al 2004 goundar and ahmed 2013 the majority of naca airfoils are not suitable in hydrokinetic turbines because of their poor stall characteristics low structural efficiencies deteriorating performance at different re numbers and undesirable results due to leading edge contamination ahmed 2012 the hydrokinetic turbine design provided by kolekar and banerjee 2013 employs a single type of blade section sg6043 from root to tip this section has been developed for relatively small scale and variable speed wind turbines having a thickness of 10 giguè re and selig 1998 as we mentioned above thin blade sections may provide relatively high power but it is likely to cause structural problems in hydrokinetic turbines similarly a universal hydrokinetic turbine blade was optimized by wu et al 2013 using naca 63 815 profiles having a single percent thickness from root to tip however torque on the turbine blades is maximized toward the root therefore it is essential to consider increasing the percent thickness of employed foils from root to tip region of the blade goundar et al 2012 this situation necessitates considering more than one type of blade profile on the other hand the cavitation problem encountered in hydrokinetic turbine blades has been outlined by many literature studies fontaine et al 2020 mohammadi et al 2020 silva et al 2017 to the authors high hydrodynamic loads and the risk of cavitation must be specifically considered in hydrokinetic turbines it is reported that the risk of cavitation can be significantly reduced by using appropriate hydrofoils batten et al 2008 silva et al 2015 nevertheless the number of design studies taking cavitation into account is limited silva et al 2015 and designers are constrained to choose wind turbine blade sections that may not be suitable in hydrokinetic turbines g25sx6 wind turbine blade section having 25 thickness was optimized by grasso et al 2017 their study is provided for air environment and cavitation risk has not been separately investigated risø a1 profile family 24 21 and 18 thicknesses which was developed for wind turbines is employed by grogan et al 2013 at a design work of a hydrokinetic turbine having 12 m blade length and 1 5 mw nominal capacity similarly muratoglu and yuce 2017 designed a river hydrokinetic turbine employing the risø a1 type of airfoil family however risø sections were developed for wind turbines and more studies are required for testing their applicability in hydrokinetic turbines likewise relatively a smaller scale hydrokinetic turbine having 0 8 m rotor diameter was designed by anyi and kirke 2011 using s822 type of profiles which were developed by nrel while cavitation is a primary characteristic of the blade section they tried to prevent cavitation by modifying the rotational speed of the rotor or changing the hydro mechanical properties of the turbine due to the lack of cavitation tolerant hydrokinetic turbine blade sections there are several hydrodynamic differences between hydrofoils utilized by stall and pitch regulated turbines therefore the type of regulation control mechanism stall or pitch regulation must be considered in the optimization process the total torque generated by the rotor has been automatically optimized in pitch regulated turbines therefore the maximization of lift drag ratio l d at a narrow range of the c l α curve becomes sufficient however stall regulated turbines do not employ such an automatic process and l d ratio should particularly become high at a relatively wider range of angles of attack dahl and fuglsang 1998 the post stall condition should also be considered at the optimization works sharp stall curve of blade sections could lead to undesired performance generating sudden loads vibration fatigue and noise problems on the blades grasso et al 2017 consequently the most convenient and efficient situation in stall regulated turbines can be obtained by reducing the lift coefficient and increasing the drag coefficient smoothly in the post stall region ahmed 2012 grasso et al 2017 turbine blades are exposed to dust dirt insects and other substances due to the continuous movement of fluid around them han et al 2018 sagol et al 2013 accumulation of these small particles increases surface roughness especially at the leading edge site this process is known as leading edge contamination and significantly reduces the performance resulting in undesired flow separation at the transition region the performance loss becomes more critical in stall regulated systems it has been reported that the airfoil performance can be reduced by up to 40 due to the leading edge contamination manwell et al 2009 another study conducted by nrel claims that leading edge pollution had undesirable effects on naca 44 naca 23xxx naca 63xxx nasa ls 1 series of blade sections of wind turbines tangler and somers 1995 it has been observed that the energy loss due to leading edge contamination somehow reduces the maximum lift coefficient c l max tangler and somers 1995 therefore c l max should be limited to reduce off design loads generated in case of exceeding design rated power ahmed 2012 likewise tangler and somers 1995 calculated that the limitation of maximum lift coefficient could increase the performance of stall regulated turbines by 23 35 and may facilitate to use 10 15 more disk sweeping area for a given generator scale the vulnerability of all blade sections to the leading edge contamination is not similar and the minimum level of sensitivity is the desired design criterion there is an important deficiency in the literature regarding the hydrokinetic turbine blade profiles while the majority of existing hydrokinetic turbines which are in operation employs stall regulation mechanism the number of blade sections specifically developed for stall regulated hydrokinetic turbines is found to be inadequate for both quantity and performance the main scope of this study is to optimize blade sections for stall regulated hydrokinetic turbines taking the hydrodynamic requirements into account in this study different blade profiles have been optimized in order of having different thicknesses along the turbine blade for better structural strength sections 3 1 3 2 also the cavitation phenomenon has been considered in the design phase on the other hand the stall behavior of the blade section is of special importance in order to prevent the turbine rotor from unwanted loadings vibration noise and deformations in this study a relatively smooth post stall behavior is aimed to deliver high power at a relatively wider range of α which is also suggested by ahmed 2012 although preventing early flow separation due to leading edge contamination is an important design criterion the number of studies considering this problem on the design process is quite limited goundar et al 2012 goundar and ahmed 2013 grasso 2012 kolekar and banerjee 2013 luo et al 2014 ouyang et al 2006 wu et al 2013 zhang et al 2016 in this study we considered preventing leading edge contamination by constraining the maximum lift coefficient mentioned aero hydrodynamic prerequisites have been introduced as optimization constraints and objective functions the performance predictions of blade sections were provided by the xfoil panel code integrating with the differential evolution algorithm dea which is controlled at the matlab interface detailed knowledge on the mathematical description of the foil geometry and dea optimization process is provided in section 2 2 theory and methodology 2 1 loads generated on blade profiles torque q and thrust force t are two major loads generated on the blade sections the total power converted by the turbine is equal to the net torque multiplied by the angular velocity thrust is defined as net force developed by the effect of fluid s movement accordingly the torque should be maximized and the thrust should be minimized in order to attain maximum efficiency based on one dimensional momentum rotor disk and blade element momentum theories the net torque and thrust forces on each differential circular section of the turbine can be written as follows manwell et al 2009 1 d q b 1 2 ρ u r e l 2 c c l sin ϕ c d cos ϕ r d r 2 d t b 1 2 ρ u r e l 2 c c l cos ϕ c d sin ϕ d r where q is torque t is thrust force b is the number of blades ρ is density u rel is the relative velocity c is chord length c l is the lift coefficient the c d is the drag coefficient and ϕ is the angle of relative velocity net lift and drag forces generated on the blade profiles can be written as 3 d 1 2 ρ u r e l 2 b c c d 4 l 1 2 ρ u r e l 2 b c c l where d is the net drag force l is the lift force and b is the blade s span length the angle and magnitude of the relative velocity vector u rel at different positions on the turbine blade are represented in fig 1 the tangential velocity in any section of the blade is a function of the angular velocity multiplied by the total distance to the hub while the tangential velocity vector u t in the root section is relatively small its magnitude increases toward the tip according to equation 1 u rel is one of the most important parameters that affect the overall power of the turbine since u rel is the resultant of u t and free steam velocity u vectors the angle of relative velocity ϕ would decrease toward the tip in order to ensure a uniform angle of attack along the turbine blade a twist angle β is defined for each blade segment in fig 1 u rel is the relative velocity u t is the tangential velocity u is the free stream velocity ϕ is the angle between relative velocity and tangential velocity vectors α is the angle of attack the angle between chord length and relative velocity and β is the twist angle the angle between chord length and tangential velocity vector 2 2 numerical performance analyses experimental analysis of three dimensional sections in water or wind tunnels is relatively expensive and time consuming work instead numerical panel codes such as xfoil javafoil profil and ellipsys2d have been developed in which aero hydrodynamic performance outputs of 2d geometries can be determined xfoil is a fast and effective interactive algorithm drela 2001 developed for the design and analysis of two dimensional blade profiles under subsonic viscous and non viscous flow conditions drela 2013 in this study we employed the xfoil code to obtain hydrofoils hydrodynamic performance parameters c l c d stall behavior c l α and c d α curves l d c l max c p the panel code has been integrated with dea via matlab interface and the performance has been analyzed for the geometries which are generated iteratively detailed numerical analyses of optimum shapes were provided by the xflr5 algorithm which has been created by rewriting xfoil with c having additional graphical user interface specialties uiuc 2018 2 3 cavitation on blade profiles if the absolute value of pressure coefficient c p around the blade profile exceeds the cavitation number the section incepts cavitation molland et al 2004 equation 5 the pressure coefficient is a non dimensional parameter that shows the relative pressure around the blade profile in this study the distribution of c p around 2d blade sections is calculated by the xfoil panel code it is reported that sufficient information about the cavitation inception of hydrofoils could be provided from the xfoil algorithm molland et al 2004 the pressure coefficient and the cavitation number can be given as follows 5 c p σ 6 c p p 0 p 0 5 ρ u 2 1 u u 7 σ p 0 p v 0 5 ρ u 2 where σ is the cavitation number c p is the pressure coefficient p is the static pressure of free stream u is the velocity of fluid particle u is the velocity of free stream p 0 is the local pressure and p v is the vapor pressure of water 2 4 mathematical description of profile geometry robustness and efficiency of the optimization work greatly depend on the suitable and accurate representation and parametrization of the studied geometry pérez arribas and castañeda sabadell 2016 generally blade sections are commonly expressed using a data file containing two dimensional cartesian coordinates of dozens of independent usually more than 100 points however making logical changes at each separate point is a very time consuming operation at the optimization stage instead the expression of the upper and lower surfaces of the blade sections by b spline or bezier curves prautzsch et al 2002 which are also known as nurbs non uniform rational b spline is a commonly used technique in the literature cocke et al 2014 goundar and ahmed 2013 grasso 2012 hafez et al 2001 ouyang et al 2006 yang and shu 2012 b spline curves facilitate to provide effective local geometric modifications and control of the foil geometry wang et al 2013 in this manner the number of design parameters can be substantially reduced while maintaining sufficient freedom and flexibility for representing a large number of data points pérez arribas and castañeda sabadell 2016 in the present study b spline curves have been employed for mathematical representation of the 2d geometry of blade profiles parametrization of the airfoil shape with b spline curves is illustrated in fig 2 the airfoil geometry has been defined by two different b spline curves for pressure and suction sides lower and upper surfaces separately each spline has been generated by 7 control points cp having a polynomial degree of k 4 control points are specified to be at the critical locations required for better geometrical modeling and modification cps that define exactly the leading 0 0 and trailing 1 0 edges were assigned to have no degrees of freedom cp no 1 7 8 and 14 the remaining cps were defined to move freely on x and y axes within proposed limits the freedom of cps is reported in section 2 5 1 design variables 2 5 optimization algorithm relative to the experimental and simulation works optimization algorithms provide the most simple and cost effective solution for obtaining blade sections having desired performance the main reason for this achievement is their searching strategy unlike the other approaches optimization algorithms do not rely on searching and trying all possibilities instead it is aimed to reach the best solutions by testing the performance of the model at each trial using an objective function in this study the optimization process has been conducted based on differential evolution algorithm dea dea is a metaheuristic method that searches the global optimum this searching process is based on determining optimal parameters via the evolution of a population iteration in each of the iterations the searching is done around the best solutions i e the individuals that have the lowest costs peng et al 2018 storn and price 1997 2015 it was reported that dea provides better global convergence and robustness than the genetic algorithm furthermore it is easier and requires a lower number of parameters compared to the genetic algorithm das and suganthan 2011 each step of the dea algorithm employed in this study has been briefly described below step 1 assigning population the control parameters of evolution the cost function and termination criteria step 2 randomly generation of a population and calculating the cost of each individual in the population step 3 do until reaching any of the termination criterion e g cost or maximum number of evolutions step 3 1 mutation with difference vectors x r 1 g x r 2 g and x r 3 g based on the mutation scale f and generate a new vector v g 8 v g x r 1 g f x r 2 g x r 3 g step 3 2 crossover according to crossover constant c r step 3 3 calculating the cost of the evolved population step 3 4 selection of optimized individual according to the lowest cost step 4 go to step 3 2 5 1 design variables during the iterations the control points are modified according to the employed optimization algorithm s constraints in order to maximize the objective function thus the design variables are assigned to be x and y coordinates of the cps of b spline curves the specified spline curves and control points have already been illustrated in fig 2 the initial airfoil geometries were randomly generated according to position and freedom intervals given in table 1 2 5 2 optimization constraints many studies report that leading edge contamination reduces the overall efficiency of the stall regulated turbines ahmed 2012 dahl and fuglsang 1998 manwell et al 2009 somers 1997 tangler and somers 1995 thus the energy loss due to contamination would be prevented if the maximum lift coefficient c l max is restricted high c l max would result in leading edge contamination while its lower value causes lower lift performance dahl and fuglsang 1998 proposed a c l max value around 1 6 1 7 for stall regulated wind turbines accordingly in this study an upper bound of 1 7 has been assigned as an optimization constraint in order to prevent the blade sections from the unwanted effects of flow separation and for delivering reasonable lift performance on the other hand sharp post stall behavior and suddenly decreasing lift coefficient is not recommended for stall regulated turbines ahmed 2012 grasso et al 2017 also high l d performance is desired at a wide range of α fig 3 in this study targeted lift and drag performance were assigned to be optimization constraints for this purpose the c l and l d performance of each individual geometrical shapes generated by iterations were tested for an α range between 0 and 25 with an increment of 1 the individuals were allowed to be reproduced by dea if their c l α curve exhibit slowly decreasing behavior without abrupt changes the same criterion is applied to both sides of the l d α curve new generations fitting gaussian distribution without instantaneous changes are accepted and survived the state of cavitation is also important to be considered in the hydrodynamic optimization process as a design constraint the cavitation number is estimated by calculating the pressure coefficient around the blade profile equation 5 in this study the minimization of the pressure coefficient is defined to be a parameter of the cost function 2 5 3 cost fitness objective function the accurate definition of objectives is one of the most important steps of any optimization problem in order to calculate the performance of each individual a cost function has been employed as proposed by dahl and fuglsang 1998 the cost function is defined to be a linear combination of various objectives and a weight factor is utilized for each target equation 9 determination of weight factors is also important and should be specified by the designer dahl and fuglsang 1998 9 f i 1 n w i f i the parameters affecting the total power and thrust of the rotor are defined in equations 1 and 2 here the parameters related to blade sections can be listed as c l c d α and u rel reducing c d directly increases the hydrodynamic efficiency of turbines by increasing the amount of torque and decreasing overall drag on the other hand sufficiently high c l is a desirable design criterion however maximization of lift coefficient increases the overall thrust to a certain extent which is undesirable thus the direct maximization of the lift coefficient has no significant effect on hydrodynamic efficiency which is also reported by ahmed 2012 consequently the objectives and weights of optimization components are reported in table 2 here each listed component is represented by a logical value new geometries introduced in the optimization algorithm are tested according to their total cost which is calculated based on the objective function table 2 if the overall score of a new section is greater than the minimum cost in the same population that geometry is added as a new foil by replacing the geometry of the minimum objective function the weight of the individual geometries that do not fit the optimization constraints section 2 5 2 is multiplied by 0 the weight of individuals that obey the optimization constraints is multiplied by 1 in this way the newly developed geometries that fit the optimization constraints are sustained and their relevant weight is added to the cost score generated sections that do not respect the optimization constraints are ignored and the total score remains unchanged the weights have been specified by the optimizers to deliver acceptable results accordingly the most important objective is to maximize the l d ratio within the limit of design constraints similar to the majority of the related optimization works that exist in the literature goundar et al 2012 goundar and ahmed 2013 grasso 2012 luo et al 2014 ouyang et al 2006 yu et al 2014 new generations having maximum cost function is allowed to be reproduced by the dea 2 5 4 termination criteria the reason for checking or applying a termination criterion is to decrease the computational cost and achieve a faster solution in this study the termination criteria is specified to be either reaching the maximum number of iterations or achieving the optimization objective consequently the optimization flow chart that is employed in this study is illustrated in fig 4 3 results and discussion generally the average free stream velocity of natural flows river tidal and ocean currents vary between 1 3 and 3 5 m s johnson and pride 2010 vinod and banerjee 2019 thus the hydrokinetic turbines should be designed to be operated in this range however the lift and drag performance of turbomachinery is a function of relative velocity u rel rather than the free stream speed section 2 1 u rel is maximized towards to the blade tip as a function tangential velocity fig 1 thus the re number should be specified considering u rel in this study design re number re d is specified to be 1 106 which is approximated for an airfoil having 0 2 m chord length and 5 m s relative water velocity it is explicit that the re number varies at different positions on the blade and around the blade section like many optimization studies we preferred to use a constant and common re number for better comparison of optimized geometries within this study and other literature studies re d has been inputted as a default value to the optimization algorithm on the other hand the specification of the design angle of attack α d is provided based on the intended stall behavior α d is usually suggested to be 1 2 below c l max for stall regulated turbines dahl and fuglsang 1998 accordingly the α d has been specified to be 9 to prevent an early stall and to assure a softer stall behavior ahmed 2012 grasso et al 2017 no forced trip location for the transition has been specified n crit which is a measure of free flow turbulence is remained to be the default value of 9 xfoil accordingly after various test running processes the optimum generations were obtained around 16 h using a computer having intel i7 ghz processor and 16 gb ram generated sections were analyzed for a wide range of α between 0 and 25 convergence problems have been encountered in xfoil for various sections at different angles of attack the performance predictions for non converged individuals were ignored for the angles of attack in which the convergence problem is encountered it should be stated that restraining c l max is an important limitation for obtaining individuals of high performance impeding the optimization algorithm to reach the local optima furthermore strict percent thickness values have not been assigned and a wide range of freedom was allocated for control points of b spline curves on x and y axes in order to keep the design space as high as possible generally available literature studies rely on an initial airfoil having desired performance and thickness characteristics nrel s s821 and s819 sections were used as reference airfoils by grasso et al 2017 again the s1210 airfoil was selected as a base section by goundar and ahmed 2013 and goundar et al 2012 modifying the maximum chamber and maximum thickness in the present study an initial airfoil section has not been employed in order of providing a wide solution space and searching the best individuals fitting objective function initially 50 primitive generations were randomly produced based on the geometrical design variables that are detailed in table 1 then primitive geometries were improved after an optimization process of 1000 iterations primitive and optimized generations were illustrated in fig 5 for better comparison showing the evolution of the blade profiles 3 1 primarily optimized sections initial hydrofoil data were randomly generated for different thicknesses it has been seen that the first shapes do not represent regular airfoil shapes fig 5 since the preliminary sections were randomly produced the dea can produce optimum sections due to their nature at the end of optimization the best sections having the desired c l α curve and highest cost function were selected as the primary optimized sections accordingly five different blade sections of various thicknesses were generated with different initial populations and called as mte profiles the first letter of author surnames respectively finally the hydrofoil geometries after the optimization process are completely different from the first geometries owing to the objective function the letter after the hyphen symbolizes separate airfoil families generated through different optimization processes which were applied by changing the parameters of dea these sections were illustrated in fig 6 and their lift and drag performances were provided in fig 7 primary sections fig 6 have different geometrical details as a result of the evolution of design variables to satisfy the constraints basically the optimized sections can be characterized to have a relatively flat pressure side and highly curved suction side here sections mte a and mte d have relatively thick leading edges mte d has quite desirable lift performance where c l gradually decreases after stall fig 7 however the relatively lower l d ratio of this profile is a disadvantage for performance on the other hand mte c has relatively flat stall behavior where the stall is observed at lower angles of attack contrary to their geometrical differences mte a mte b and mte d sections have a quite similar lift and drag performance all the generated sections have a linearly increasing lift behavior until c l max point 3 2 scaling the primary sections it is a well known situation that the percent thickness of the profiles has significant effects on the performance dongli et al 2015 reported that thinner airfoils deliver a higher l d ratio and provide good stall characteristics in this study the primarily generated blade profiles do not exactly have the same thicknesses thus we standardized and scaled them at a constant thickness for better performance comparison among various profiles fig 8 xflr5 algorithm s scale camber and thickness option have been used for this operation here the position on the x axis of the camber maximum thickness and the value of maximum camber remained unchanged while only the thickness at chord has been varied and scaled to the desired ratio many studies outline the importance of employing relatively thicker sections in hydrokinetic turbines especially for the middle and root sections of blades ahmed 2012 bryden et al 2004 goundar et al 2012 goundar and ahmed 2013 accordingly in this study each primary profile fig 6 were scaled to have the integer numbers of 12 15 18 21 24 27 and 30 thicknesses an airfoil family consisting of seven different thicknesses was generated from each primary profile in order of obtaining a wide range of thickness category then the performance of each primary airfoil family was compared with the other sections having the same thickness the profiles delivering the maximum l d ratio at a wide range of α and having desired lift characteristics were reported in fig 9 the xflr5 analysis results for lift drag and pressure coefficient distributions along the section at different angles of attack are illustrated in fig 10 3 3 performance comparison naca 63 and 44 4 digits series lawson et al 2011 risø a family of airfoils bertagnolio et al 2001 dahl and fuglsang 1998 and nrel s profiles ahmed 2012 tangler and somers 1995 are among the mostly employed blade sections in hydrokinetic turbines mohammadi et al 2020 several more studies have been conducted for the optimization of blade sections for stall regulated turbines grasso et al 2017 studied on airfoil optimization for stall regulated wind turbines however since the hydrodynamic properties of the water environment have not been considered their outcomes would not be convenient for hydrokinetic turbines on the other hand many recent design works on wind turbine sections have not shared their final geometries goundar et al 2012 goundar and ahmed 2013 which makes it impossible to analyze hydrodynamic properties the design works of hf10xx and hf sx profiles reported by goundar and ahmed goundar et al 2012 goundar and ahmed 2013 specifically considers the cavitation phenomenon however they exhibit sharp and abrupt post stall mechanism g hydra a section designed by grasso 2012 shows sudden changes at the stall curve on the other hand naca 63 618 profiles were used as hydrofoil in several hydrokinetic turbine design works arzu et al 2017 lust et al 2018 luznik et al 2012 similarly the naca 4418 profile has been utilized as a reference section in hydrokinetic turbines badea et al 2014 noruzi et al 2015 shiu et al 2012 risø a 18 airfoil has been employed in a number of studies ahmed 2012 implying its low risk of cavitation due to its relatively small c p nrel s s825 and s833 sections designed for wind turbines to be a thick airfoil family buhl 2020 delivering good aerodynamic performance especially at low re number sun et al 2019 again s833 was used as the primary section of tidal current turbines vanzwieten et al 2011 in this section the performance of naca 63 3 618 naca 4418 risø a 18 nrel s825 and nrel s833 profiles were compared with the mte b18 profile which is optimized in this study each of these profiles has approximately 18 thickness the geometry of these sections is reported in fig 11 their performance comparison is provided in fig 12 accordingly mte b18 hydrofoil has relatively similar c l behavior with naca 4418 and nrel s825 profiles where c l max is slightly higher than both sections although delivering high c l is advantageous for higher torque in this study it has been limited at 1 7 by the optimization algorithm to prevent the sections from leading edge contamination similarly a sharply decreasing lift coefficient is not a desired property for the post stall region in stall regulated turbines owing to the design constraints mte b18 profiles and other hydrofoils optimized in this study are found to be successful in terms of post stall behavior c d of mte b18 profile is minimized especially for an α range until 13 minimization of the drag coefficient is a desired property to maximize the delivered torque and efficiency of the rotor constructed from this section as illustrated in optimization objectives section 2 5 3 on the other hand the mte b18 section delivers quite a high lift to drag ratio maximum l d ratio is 135 at a wide range of angles of attack relative to naca risø and nrel sections analyzed in this study it should be noted that thinner profiles deliver a higher l d ratio and the primary profiles optimized in this study exceeds a maximum l d ratio of 150 fig 7 finally naca 63 3 618 nrel s825 and s833 profiles would have undesired consequences in hydrokinetic turbines while mte b18 represents quite low pressure coefficient distribution which is very important to prevent cavitation risø sections are mostly preferred because of their low cavitation risk here the maximum c p of the mte b18 section is found to be lower than risø a 18 representing minimized the risk of cavitation showing the success of the optimization algorithm equations 5 7 3 4 reliability and validation of xfoil xfoil code employs a linear vorticity second order panel method coupled with an integral boundary layer method and en type transition prediction model yirtici et al 2019 owing to its high speed and accuracy xfoil is commonly preferred in many optimization codes timmer and bak 2013 many studies compared the performance of xfoil with respect to experimental studies cfd analyses and other panel codes mohammadi et al 2020 validated the xfoil algorithm comparing the experimental results and reported around 10 error for naca 4415 airfoil similarly morgado et al 2016 compared the xfoil with cfd algorithms and noted that overall best prediction results are delivered by xfoil relative to the computational studies even that of having the capability of boundary layer transition detection on the other hand rfoil is an improved derivative of xfoil that is developed by the national aerospace laboratory of netherlands and delft university of technology timmer and bak 2013 implementing the extended boundary layer equations montgomerie et al 1997 it is reported that rfoil provides better convergence around the maximum lift owing to the modifications at the calculations of turbulent boundary layer shape factors timmer and bak 2013 li et al 2020 compared both codes considering the experimental results and reported that xfoil and rfoil codes delivered approximate results at the linear region before stall however xfoil exhibited overestimation at the lift coefficient while rfoil underestimated the drag coefficient li et al 2020 fig 13 includes the comparison of xfoil and rfoil for mte a15 hydrofoil which is optimized through this study at re 1 106 accordingly it is observed that while the stall behavior and c l max characteristics are similar in both codes rfoil delivered a slightly lower lift coefficient and lower l d ratio after stall 3 5 applicability of genetic algorithm ge and particle swarm optimization pso in this section ge and pso which are among the other popular optimization methods have been compared with dea both algorithms were run using the same methodology as for dea described in section 2 the comparison is provided based on the same parameters in the objective function listed in table 2 the performance outputs of the optimized geometries c l l d and c p with respect to α after 1000th iteration are summarized in table 3 accordingly the obtained results were found to be approximated to each other the most ideal stall curve section 2 5 2 was obtained from dea algorithm while pso exhibited a relatively sharp stall which is not intended within the scope of this study dea and ge represented quite similar c l α curve while dea has slightly higher performance in terms of power production overall it can be stated that both ge and pso would also be employed in the optimization problem within the scope of this study to the authors neither of these optimization methods guarantees the same results in every trial due to their methodology e g random determination of the initial population consequently the main advantage of dea is its simple and effective searching algorithm and simplicity in creating new populations this simplicity gives dea a higher searching range and better optimization capability 3 6 limitations and future studies the maximizing lift coefficient is mainly the desired property in terms of power production however it would be quite disadvantageous resulting in leading edge contamination nevertheless to date literature studies do not agree on a specific c l max behavior thus more studies especially experimental are needed on the flow separation and leading edge contamination problems in hydrokinetic turbines in order to avoid unnecessarily reducing the turbine performance also in this study thickness is not defined as an optimization constraint to keep the solution space as wide as possible instead thickness distributions for root and primary regions of the blade are manually obtained employing the xflr5 algorithm keeping the position and value of maximum camber unchanged although there are several literature studies employing similar methodology the effect of scaling on the performance and stall behavior is not clear yet assigning thicknesses as an optimization parameter would also be an alternative choice for future studies on the other hand in this study only hydrodynamic properties are included as design objectives and constraints coupled hydro structural design optimization is suggested by many studies for 3d blade or rotor optimization garg et al 2019 kolekar and banerjee 2013 garg et al 2017 reported that hydro structural optimization may lead to completely different geometry relative to hydrodynamic only optimization therefore the structural requirements of the 3d blades that are constructed from the proposed hydrofoils should also be considered by blade designers using xfoil in the post stall region is another limitation of this study the code delivers reasonable performance at the attached flow before the stall region where the potential flow theory is valid marten et al 2016 which is found to be sufficiently accurate at the conceptual design phase morgado et al 2016 good agreement with the wind tunnel experimental data is attained at low angles of attack liang and li 2018 however several pieces of research noted its undesirable performance and poor results in the post stall region due to the incapability of resolving the boundary layer and flow separation battisti et al 2020 dahl and fuglsang 1998 it is reported that drag coefficient is underestimated morgado et al 2016 and lift coefficient is overestimated abutunis et al 2020 by the xfoil at higher angles of attack it should be stated that low order panel methods deliver satisfactory results up to the stall point however beyond the stall the airfoils exhibit similar to a bluff body battisti et al 2020 in fact modeling the aero hydrodynamic performance of the blade sections or airfoils at high angles of attack is found to be quite difficult higher order methods are strongly recommended by the researchers to eliminate this deficiency necessitating massive computational time and effort at each specific angle of attack is the main disadvantage of higher order methods mukherjee and gopalarathnam 2006 polat 2011 different post stall extrapolation methods such as montgomerie viterna corrigan kirke models bianchini et al 2015 liang and li 2018 and numerical analyses based on navier stokes solvers for 2d and 3d steady and unsteady domains morgado et al 2016 are also suggested by researchers again in this study α d and re number are specified to be constant through the optimization process future studies would consider optimization for a range of α and re number finally the authors believe that the airfoil hydrofoil optimization works will tend to be device specific in the future considering more specific dynamic and geometrical conditions of the working environment where energy will be extracted 4 conclusion in the literature the number of blade sections specifically optimized for stall regulated hydrokinetic turbines is quite limited thus designers are constrained to use wind turbine airfoils which deliver undesirable performance in hydrokinetic turbines in this study hydrofoil geometries were optimized mte considering high hydrodynamic loads cavitation risk speed regulation mechanism and leading edge contamination optimized sections exhibit quite satisfactory results achieved the optimization constraints and delivered good performance comparing to the mostly used naca nrel and risø sections the authors believe that this research will contribute to the hydrokinetic turbine design studies for better performance and efficiency and decrease the dependency of wind turbine blade sections funding this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors data availability the coordinates of the hydrofoils optimized in this study are confidential and not publicly available because of a pending patent application for a new industrial product credit authorship contribution statement abdullah muratoglu conceptualization resources methodology investigation visualization writing original draft validation data curation ramazan tekin software writing review editing formal analysis ömer faruk ertuğrul software supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank dr huseyin ozdemir university of twente and tno the netherlands for providing the rfoil code and its documentation 
21166,widespread flooding of reef fringed islands demonstrates the insufficient protection provided by reef topographies and suggests the necessity of artificial structures for hazard prevention and mitigation as an indicator of the structural protection efficiency the wave overtopping rate is difficult to estimate in reef environments because hydrodynamics over reefs violate the application conditions of standard overtopping formulas a combined physical and numerical modeling was performed to investigate wave transformations over reefs of different topographies and overtopping at vertical seawalls on the reefs results showed that in addition to the off reef wave height and still water level the off reef wave period also played significant roles the intensity of short wave motions and the level of wave setup near the seawall were positively correlated with the off reef wave period and the intensity of infragravity wave motions depended largely on it steeper fore reef slopes would lead to more intensive wave motions and higher setup on reef flats and consequently higher overtopping rates furthermore the overtopping rate exponentially decreased with the distance between the seawall and reef edge primarily due to the decay of short waves in the surf zone keywords coral reef flooding infragravity wave seawall overtopping non hydrostatic model 1 introduction many tropical and subtropical reef fringed islands are exposed to open oceans where severe storms and energetic swells usually occur for these islands wave induced flooding has become a serious hazard due to the limited land areas low coastal plain elevations and fragile terrestrial ecosystems moreover climate change related sea level rise which may be up to 60 200 cm by the end of this century grinsted et al 2010 ipcc 2007 could increase the frequency and intensity of flooding consequently making these islands more vulnerable the frequent occurrence of flooding hazards in the last few decades e g hoeke et al 2013 jaffe and richmond 1993 roeber and bricker 2015 combined with the awareness of more serious threats in the future storlazzi et al 2015 suggest the necessary protection of artificial structures such as seawalls for both natural e g male marshall islands and reclaimed e g city of hope maldives islands dauenhauer 2017 packard 2014 however compared with the profound understanding regarding mild sloping coasts little is known about the seawall efficiency in mitigating the damage associated with energetic waves for reef fringed islands because of the complex hydrodynamics over the unique topography of reefs liu et al 2020a fringing reefs commonly have relative steep fore slopes 1 20 extending from deep waters to nearly horizontal reef flats with shallow water depths reefs that cover relatively narrow regions compared with continental shelves limit the development of storm surge dean and dalrymple 1991 but the abrupt changes in water depth over reef topographies impose significant influences on waves the energy of incident short waves sws 0 04 0 2 hz in prototype can be effectively dissipated by the depth limited breaking which starts in the vicinity of the reef edge and extends to some distance shoreward gourlay 1994 yao et al 2013 2020a as a result the transmission of sws is significantly controlled by the water depth on the reef flat both field observations and laboratory experiments proved that heights of individual stable sws never exceed 0 55 times of local water depths gourlay 1994 nelson 1996 in this regard reefs are often thought to be natural barriers for the fringed coasts costa et al 2016 ferrario et al 2014 however breaking of sws elevates the mean water level i e wave setup to balance the spatial reduction in radiation stress on the reef flat the magnitude of setup depends on the difference between radiation stresses at the breakpoint and on the reef flat so that it is influenced by the incident wave height still water level and fore reef slope becker et al 2014 buckley et al 2015 vetter et al 2010 yao et al 2017 since they have impacts on the intensity and persistence of breaking generally wave setup is higher on a reef than on a mild slope beach because the enlarged breaker index on the steep fore reef slope results in a transfer of a large amount of kinetic energy from waves and rollers to the potential energy of waters buckley et al 2015 except for the sws infragravity waves igws 0 004 0 04 hz in prototype also contribute largely to the water level fluctuations and the consequent coastal flooding despite their secondary magnitude in off reef regions interactions between incident waves and reef topographies highly promote the igws on the reef flat buckley et al 2018 cheriton et al 2016 masselink et al 2019 nwogu and demirbilek 2010 yao et al 2019 because the steep fore reef slope is favorable to the generation of moving breakpoint forced igws which are more energetic than the released bound igws masselink et al 2019 yao et al 2020b phases and heights of the generated free igws are subsequently modified by the reflection processes at both the shoreline or seawall and the reef edge thus igws may be trapped and resonantly amplified on reef flats buckley et al 2018 moreover because the motions of igws significantly alter the local water depths of sws in the surf zone the sw groups after breaking tend to be in phase with the local igws it means that larger sws are more likely to ride on the crests of igws and promote extreme water levels liu et al 2020a liu and li 2018 as reviewed above most of the existing studies focused on wave hydrodynamics on natural reef topographies without an artificial defense structure recently chen et al 2020 numerically investigated regular wave overtopping over a seawall on a reef flat and wave force acting on the seawall however studies on the interaction between random waves and vertical seawalls in reef environments are very few to assist the design of engineering measures in hazard mitigation projects as well as to provide a basic evaluation on flooding risk for islands fringed by different reef morphologies there is a need to understand how these physical drivers of wave induced flooding i e sws igws and wave setup vary with different random wave conditions and reef morphologies as well as the mechanisms underneath it this study conducted a combined physical and numerical investigation to include possible variations of these parameters aiming to examine their effects and provide insights on the responsible mechanisms the rest of the paper is organized as follows section 2 introduces the methods including the physical experiment and the numerical modeling an overview of the formulae used for analysis a preliminary description of wave transformation over the reef and the validation of the numerical model results of the physical experiment of various off reef sea states and the numerical modeling of various reef morphologies are presented in section 3 section 4 discusses the role of reefs on the flooding of the attached islands the main conclusions are drawn in section 5 2 methods 2 1 physical experiment liu et al 2020a 2020b detailly described measurements of wave transformation over a laboratory reef topography model and overtopping at vertical seawalls on the reef flat as illustrated in fig 1 a two dimensional reef profile was constructed to a 1 49 geometric scaling factor with a 1 5 fore reef slope and a horizontal reef flat of 4 14 m 203 m in prototype or 6 00 m 294 m in prototype length depending on the location of the vertical seawall the reef surface was made of smooth polyvinyl chloride to guarantee the protection of seawalls in worst case scenarios concerning the possible coral degradation caused by climate change and coral mining random waves were generated according to the jonswap spectrum with a peak enhancement factor of 3 3 the duration for each run was 1000 t p where t p is the off reef spectral peak period water surface elevations across the reef and in the overtopping tank were measured using capacitance wave gauges with a sampling rate of 30 hz fig 1b fifteen runs of wave conditions were conducted at three water levels table 1 with the designed deep water significant wave height h m0 deep ranging from 4 to 10 cm 2 0 4 9 m in prototype the spectral peak period of 1 0 2 5 s 7 0 17 5 s in prototype and the still water depth on the reef flat h r of 3 0 6 0 cm 1 5 3 0 m in prototype covering waves of a wide range of conditions note that the test runs with t p 2 5 s implied a relatively shallow off reef water depth where the jonswap spectral form was physically invalid therefore using non hydrostatic numerical simulations we assessed the influences of off reef water depth on the spatial variations of wave motion intensities and wave setup as well as the overtopping rate it was found that such an off reef water depth led to neglectable effects and can be accepted not shown the deep water surf similarity parameter eq 8 in section 2 3 1 was within the range of 0 9 3 1 mainly falling in the plunging type breaker pattern on the fore reef slope nevertheless we also observed spilling breakers and non breaking waves in a single wave train cf fig 7 of li et al 2019 due to the irregularity of wave groups it must be noted that the actual wave parameter values from measurements see section 2 3 1 may be slightly different from the designed values listed in table 1 however the differences did not lead to a substantial deviation from the conclusions of the present study liu et al 2020a focused on the responses of overtopping rate to various still water depth incident wave condition at the seawall toe and the seawall height while in this study we used the data with reef flat length of 6 00 m 294 m in prototype and seawall height of 10 cm 4 9 m in prototype to analyze further the influences of combined off reef wave conditions and water levels on the main drivers of coastal flooding i e the intensities of sw and igw motions and wave setup in front of the seawall based on these results wave overtopping responses to off reef wave conditions and water levels were presented only the runs with the overtopping rate q larger than 10 6 m3 s m 3 4 10 4 m3 s m in prototype were considered in this study hence the runs with t p 1 0 s 7 0 s in prototype were excluded in the following because the overtopping rate q in these runs barely exceeded the threshold 2 2 numerical modeling 2 2 1 model description since only one fixed reef morphology was involved in the physical experiment numerical modeling became an alternative to investigating the influences of varying reef morphology this study adopted the open source phase resolved non hydrostatic model swash zijlema et al 2011 considering its outstanding performances in simulating nearshore hydrodynamics over a wide range of environments including coral reefs see the swash related publications on the website of http swash sourceforge net the governing equations for its depth averaged version are the nonlinear shallow water equations with additional non hydrostatic pressure terms 1 ζ t h u x 0 2 u t u u x g ζ x 1 2 p b x 1 2 p b h ζ d x c f u u h 0 3 w s t 2 p b h w b t w b u d x 4 u x w s w b h 0 where ζ is the water surface elevation x is the horizontal spatial coordinate t is the time h and d are total and still water depths respectively u is the depth averaged horizontal velocity c f n 2 g h 1 3 is the roughness friction factor where n is the manning s roughness coefficient and g the gravitational acceleration p b is the non hydrostatic pressure at the bottom and w s and w b are the vertical velocities at the free surface and the bottom respectively the model turns off the non hydrostatic pressure and reduces to a nonlinear shallow water equation model to foster the development of free surface discontinuity when the temporal partial derivative of surface elevation exceeds a specific time of the local speed of shallow water waves then the wave breaking and associated energy dissipation are inherently accounted for by ensuring the momentum conservation over the discontinuity the criterion for neglecting the non hydrostatic pressure terms is expressed as 5 ζ t α g h 2 2 2 model setup the model setup generally followed that of liu et al 2020b the incident wave boundary was fixed at x 2 16 m i e the location of gauge 1 in the physical experiment and the toe of the fore reef slope was fixed at x 0 00 m fig 2 the crest level of the vertical seawall above the reef flat was 0 1 m a numerical overtopping water tank of 6 0 m long was attached to the back of the seawall the overtopping rate was estimated based on the flux on top of the seawall by varying the fore reef slope and the reef flat length different reef morphologies were implemented water surface elevations of incident waves which were obtained by applying the separation method of mansard and funke 1980 to physical measurements of the gauges 1 3 were specified at the incident wave boundary x 2 16 m reflection at the wave maker boundary was weakened by adopting a weakly reflective condition a sponge layer of 3 m in length and a sommerfeld radiation condition were placed at the outflow end of the numerical overtopping tank the grid size was 0 01 m and the time step was governed by the courant friedrichs lewy condition the manning s roughness coefficient n was 0 012 s m1 3 to simulate a relatively smooth surface the sampling frequency of 30 hz was the same as that in the physical experiment two series of numerical tests were conducted table 2 both employed the intermediate water level of the physical experiment series a and b aimed at assessing the effects of fore reef slope and reef flat length respectively 2 3 data processing 2 3 1 spectral analysis and parameter definition spectral analysis employed surface elevation time series of 215 samples with hanning windowed segments of 211 samples and 50 overlapping resulting in 31 degrees of freedom the wave spectrum s f was decomposed into sw and igw components by a cutoff frequency of f p 2 f p 1 t p is the off reef spectral peak frequency liu et al 2020a 2020b and many others used 4 s f d f as a representative wave height over shallow reefs in analogy with the definition for the approximate value of significant wave height in deep water however since the statistical formulation and associated properties on individual wave heights of the wave fields over shallow reefs are not well known the definition 4 s f d f essentially represents the potential energy of wave motions rather than the statistical wave heights therefore we used the following parameters as measures of intensities of short wave eq 6 and infragravity wave eq 7 motions 6 m 0 s w 1 2 f p 2 6 f p s f d f 7 m 0 igw 1 2 0 f p 2 s f d f local water depth h composes of the still water depth d and wave setup setdown η i e h d η surf similarity parameter was estimated by 8 ξ 0 tanθ h m 0 d e e p l 0 p where l 0p denotes the deep water wavelength associated with the peak period responses of m 0 sw 1 2 m 0 igw 1 2 η and q denoted by x to the variation of a morphological parameter were quantified by the ratio between the values of x to the value of x of a morphological reference case 9 γ x x i j x i j r e f where the subscript i and j denote different wave conditions and different values of the morphological parameter respectively the morphological reference case i e the ref in the subscript was cotθ 5 for series a and l r 6 0 m for series b table 2 respectively then the influences of varying wave conditions were further averaged out to only reserve the effects of morphological variations as 10 γ x 1 n i 1 n x i j x i j r e f 2 3 2 separation of shoreward and seaward infragravity waves surface elevations of shoreward η i g and seaward η i g igws were separated using the synchronous data of surface elevations η i g and horizontal velocities u ig in the igw frequency band f f p 2 as follows e g lashley et al 2020 11 η ig η i g c u i g h c c 12 η ig η i g c u i g h c c where phase celerity of shoreward propagating igws c was calculated by the group celerity c g at x x b and by the shallow water celerity g h at x x b where x b is the mean position of the breakpoint phase celerity of seaward propagating igws c was g h since there was no velocity measurement in the physical experiment the separation was done based on the numerical results 2 3 3 standing wave a standing wave shows spatially alternating nodes minimum potential energy and antinodes maximum potential energy for a given location on the reef flat nodes of standing waves resulting from the reflection of seawall occur at the frequencies buckley et al 2018 13 f n o d e 1 4 2 m 1 x x s e a w a l l 1 g h d x 1 where m 0 1 2 is the order of mode and x seawall is the location of seawall this equation considers the reef topography as an open basin of variable depth natural resonances will be excited with a standing wave node located at the reef edge x 3 m in fig 1b where the downwind steep slope partly reflects the seaward igws and changes the igw phases by π thus the igw energy is trapped and amplified on the reef flat 2 3 4 performance metric the performance of the swash model was quantified using the following objective function 14 s k i l l 1 x s x m 2 x s x m x m x m 2 where the subscripts s and m stand for swash simulated and physically measured values respectively the overbar means taking the averaged value an increase in the skill value between 0 and 1 indicates an improved performance 2 4 validation of the swash model and wave transformation across the reef the value of α that controls the contribution of non hydrostatic terms eq 5 may influence the accuracy of the swash model however numerical sensitivity tests of liu et al 2020b showed promising results that the simulated cross reef distribution of total wave height including sw and igw setup and spectral mean period are not susceptible to the value of α see fig 8 therein these results are consistent with buckley et al 2014 and lashley et al 2018 which showed that both the default and tuned values of α led to satisfactory results the reason may be that the slope of fore reef is of secondary importance to wave breaking yao et al 2013 by contrast tuning the value of α is necessary for correctly reproducing the overtopping rate liu et al 2020b because the wave motion of runup on a vertical wall involves significant vertical acceleration closely related to the non hydrostatic pressure gradient therefore for a given wave condition in the present study the value of α was preliminarily tuned based on the overtopping rates measured in the physical experiment 2 4 1 wave heights and setup model data comparisons of cross reef variations of m 0 sw 1 2 m 0 igw 1 2 and η for two runs run h45h08t25 with h r 4 5 cm h m0 deep 8 0 cm and t p 2 5 s run h45h06t15 with h r 4 5 cm h m0 deep 6 0 cm and t p 1 5 s at the middle water level are shown in fig 3 to illustrate the general features of wave transformation as well as to validate the swash model in general spatial variations of m 0 sw 1 2 over the reef were well reproduced by the swash model fig 3a b for both runs m 0 sw 1 2 increased in the shoaling zone on the fore reef slope then rapidly decreased on the outer reef flat mainly due to wave breaking on the middle and inner reef m 0 sw 1 2 slowly decayed which was caused by the bottom friction and the energy transfer to lower frequencies due to resonant triad interactions over the shallow reef at the location of gauge 20 x 8 98 m neighboring the seawall m 0 sw 1 2 was about 50 higher than that at gauge 19 x 8 46 m probably a consequence of co existing wave height fluctuations goda and suzuki 1976 a challenging phenomenon well captured by the swash model here for both runs m 0 igw 1 2 increased in the shoaling zone of sws and decreased in the outer surf zone before reaching the reef edge x 3 m fig 3a b on the reef flat x 3 m the variations of m 0 igw 1 2 showed different behaviors for the two runs m 0 igw 1 2 gradually increased shoreward for the run with energetic incident waves fig 3a while remaining nearly unchanged for the run with moderate wave actions fig 3b all these features were captured by the swash model with reasonable accuracy though igws were more challenging to simulate than sws to shed more light on the cross reef variations of m 0 igw 1 2 the shoreward and seaward propagating igws were separated based on the numerical results results showed that although the shoreward igws were small in magnitude in the off reef region their shoaling rates on the fore reef slope were high owing to the energy transfer from sws to igws through triad interactions on an upward slope li et al 2020 the decrease in shoreward m 0 igw 1 2 from the breakpoint to the reef edge was consistent with the dissipative tendency of group bounded waves in the surf zone which was first suggested by longuet higgins and stewart 1962 and lately discussed by baldock 2012 comparative heights of shoreward and seaward igws on the reef flat indicated the full reflection of igws at the vertical seawall therefore the spatial distribution of total igw height on the reef flat could be largely accounted for by the interferences between its shoreward and seaward components as will be illustrated in section 2 4 2 the wave setup η gradually decreased in the shoaling zone while rapidly increased in the surf zone fig 3c d the swash model slightly underpredicted η on the reef flat because the model is currently unable to simulate surface rollers leading to the underestimating the kinetic energy of breaking waves however the underprediction effect was trivial in the context of its relatively small magnitude compared with the total mean water depth 2 4 2 wave spectrum the wave spectrum changed drastically over the reef for the run h45h08t25 fig 4 a b higher and lower harmonics grew remarkably on the fore reef indicating the nonlinear energy transfer to these frequencies during shoaling li et al 2020 breaking of sws played the primary effect in the continuous decrease of energy around the spectral peaks another feature is the wave energy concentrating toward the igw frequencies near the seawall the presence of standing waves significantly altered the measured spectra on the reef flat fig 4b the spectra showed alternative crests and troughs in the frequency domain the frequencies of spectral troughs corresponded well with the frequencies of theoretical standing wave nodes eq 13 in both sw and igw frequency bands in this run h45h08t25 energy at the fundamental frequency of natural reef resonances m 0 and f node 0 03 hz eq 13 dominated the igws on the reef flat similar to previous studies buckley et al 2018 nwogu and demirbilek 2010 other resonant modes were discernible but not significant since the fundamental mode contained only one node at the reef edge and one antinode at the seawall phases of its surface elevations were identical over the reef flat and its amplitude increased from the reef edge to the seawall hence justifying the spatial variation of m 0 igw 1 2 displayed in fig 3a overall features of the spectral spatial evolution in the condition of moderate off reef waves h45h06t15 fig 5 a b were roughly the same as that in the condition of energetic off reef waves h45h08t25 fig 4a b however a noticeable difference in the igw band can be observed there were three resonant reef modes for the run h45h06t15 but the modes were not intensely excited fig 5b the igws mainly consisted of standing waves with frequencies between adjacent resonant frequencies these standing waves had different wave lengths so that their nodes and antinodes were not clustered but dispersed over the reef flat therefore the node antinode pattern was less evident as indicated by the smaller ratio of total to shoreward m 0 igw 1 2 despite the full reflection at the seawall fig 3b measured and simulated spectra of the two runs were compared in figs 4c and 5c from which it can be seen that the swash model achieved satisfactory levels of accuracy in both sw and igw frequencies as indicated by the high values of the performance index skill eq 14 2 4 3 overtopping rate the swash model was calibrated by optimizing the parameter α to minimize the error in overtopping rate predictions the optimal α for the runs with h r 4 5 cm and seawall height of 10 cm had a mean of 1 92 and a standard deviation of 0 26 perfect agreements between the measured q meas and simulated q swash overtopping rates with optimal α for each run can be seen in fig 6 3 results 3 1 influences of off reef hydrodynamic forcing in this subsection the physical measurements were used to explore the influences of the off reef hydrodynamic forcing i e wave height period and water level on wave setup and intensities of sw and igw motions near the seawall as well as on the overtopping rate the analysis focused on the measurements of gauge 19 x 8 46 m instead of that of gauge 20 x 8 98 m to avoid influences of co existing wave height fluctuations in the vicinity of the seawall in the following the variables will be displayed in prototype scale by transforming their small scale values according to froude s similarity law 3 1 1 impacts on wave setup on average wave setup near the seawall η r increased with the decrease of still water depth on the reef flat h r fig 7 a consistent with previous laboratory studies and field observations becker et al 2014 gourlay 1996 yao et al 2017 forcing of greater off reef wave height and longer period would result in larger η r because of the concomitant higher energy flux that is proportional to h m 0 d e e p 2 t p although η r was inversely modulated by h r the total mean water depth still positively depended on the h r fig 7b 3 1 2 impacts on the intensity of short wave motion a significant decrease of m 0 sw 1 2 near the seawall compared with the h m0 deep demonstrated the dissipative effect of the reef topography on the sw energy fig 7c obviously the effectiveness in reducing sw energy highly depended on the h m0 deep h r as a typical consequence of depth limited wave breaking on the reef flat with nearly horizontal topography m 0 sw 1 2 near the seawall increased linearly to the increase of h m0 deep fig 7c however the dependence of the ratio of m 0 sw 1 2 to total mean water depth with still water depth and setup incorporated on the h m0 deep was not remarkable fig 7d therefore it turns out that the enlargement of m 0 sw 1 2 was mainly a consequence of high setup induced by large h m0 deep as indicated by fig 7b moreover m 0 sw 1 2 increased with the t p of deep water waves fig 7c and the effect of t p was more evident at lower still water depths this could also be related to the higher off reef wave energy flux of waves with a longer period and the resultant stronger depth modulation effect due to the more significant wave setup fig 7a b fig 7d shows that the ratio of m 0 sw 1 2 to the total mean water depth achieved a more considerable value at higher h r it may be because of the different characteristics of spilling and plunging breakers on one hand waves reformed at the end of the surf zone have a larger wave height to water depth ratio for spilling breakers compared with that of plunging breakers gourlay 1994 on the other hand different from regular waves a random wave train could have both spilling and plunging breakers due to the irregularity of individual wave parameters li et al 2019 the portions of the two types of breakers depend on h r based on the results of regular wave experiments gourlay 1994 yao et al 2013 when h r becomes high waves are more likely to break in spilling which will therefore result in a large ratio of wave motion intensity to water depth based on the experimental data of the present physical experiment it was found that the wave motion intensity to total mean water depth ratio roughly increased with the decreasing f c 0 g 1 25 h m 0 d e e p 0 5 t p 2 5 h r 1 75 and h m0 deep h r which are the parameters controlling the breaking types on coral reefs not shown gourlay 1994 yao et al 2013 3 1 3 impacts on the intensity of infragravity wave motion although igws were secondary in magnitude in off reef regions they could be highly pronounced on the reef flat see fig 7e and contributed largely to the water level fluctuations consistent with previous field obversions and laboratory studies buckley et al 2018 masselink et al 2019 nwogu and demirbilek 2010 pomeroy et al 2012a a distinct feature of m 0 igw 1 2 was that it varied linearly with respect to h m0 deep but was well grouped by t p rather than by h r fig 7e more specifically waves with longer periods produced higher m 0 igw 1 2 near the seawall using the off reef energy flux parameter h m 0 d e e p 2 t p could not eliminate the scattering fig 7f while a clustered linear relation was obtained by an off reef forcing parameter h m 0 d e e p l 0 p 0 5 fig 7g that gives more weight to the t p as l0p is in proportion to the square of t p the high dependence of m 0 igw 1 2 on t p was in partial agreement with the field observation of gawehn et al 2016 this result highlights the role of the off reef wave period on the flooding risk of reef fringed coasts since igws contribute largely to the wave fields on reef flats 3 1 4 impacts on overtopping rate an exponential relation between q and h m0 deep was found in fig 8 similar to the exponential relation between q and the incident wave height at the seawall toe liu et al 2020a it may be partly because both m 0 sw 1 2 and m 0 igw 1 2 near the seawall increased for increasing h m0 deep fig 7 c and e furthermore h r and t p also had positive influences on q but the significance was also subject to h m0 deep for small values of h m0 deep the q was sensitive to h r for larger values of h m0 deep however the t p became increasingly important liu et al 2020a investigated the effects of wave parameters at the seawall toe on the overtopping rate they found that as a comprehensive representation of both sws and igws the effect of the wave spectral mean period t m 1 0 m 1 m 0 where m n is the m th spectral moment was neglectable in estimating the overtopping rate such a result is not in contradiction with the finding of fig 8 as the wave parameters at the seawall toe have been altered by the off reef forcing the study of liu et al 2020a aimed at proposing an approach to estimate overtopping rates based on prior knowledge on the wave heights on reef flats while fig 8 attempts to provide a basic understanding of how the off reef forcing conditions affect the overtopping rate 3 2 influences of reef morphology in this subsection the influences of reef morphology i e slope of fore reef and length of reef flat on wave setup and intensities of sw and igw motions near the seawall as well as on the overtopping rate were investigated based on the numerical results wave parameters at 0 5 m 24 5 m in prototype scale away from the seawalls were analyzed and the results are displayed in prototype scales 3 2 1 impacts on wave setup wave setup in front of the seawall η r simulated by the swash model demonstrated strong dependency on the fore reef slope fig 9 a for instance the values of η r in a steep slope condition cotθ 2 were on average 2 4 times the ones with a relatively mild slope cotθ 20 and the value of γ η eq 10 followed an exponential type monotone decreasing function concerning cotθ in this range fig 9c the results were consistent with fig 12 of yao et al 2017 which shows that the experimental data of η r with cotθ 1 were much larger than η r with cotθ 6 9 6 concerning the reef flat length l r the η r first increased and then approached a constant value fig 9b when the reef flat became long enough for wave breaking to develop and finally cease fig 3 the runs with shorter wave periods reached their upper limits within a narrower range of the reef flat but on average the increase of η r would cease for l r further extended beyond 200 m such a pattern of variation could be described by a hyperbolic tangent type function fig 9d 3 2 2 impacts on the intensity of short wave motion fig 9e shows a decreasing trend of m 0 sw 1 2 as the fore reef slope becomes mild it may be due to that the decrease of η r allowed less sw energy on the reef flat for the depth limited breaking mode however the runs with smaller off reef wave steepness i e small h m0 deep and large t p exhibited a slight opposite trend of increase for cotθ 3 5 the reason is that these runs had surf similarity parameters of 3 9 eq 8 which indicated a dominant breaking manner of surging in general the variation of m 0 sw 1 2 could be described by an exponent type regression curve fig 9g but the prediction is expected to be more refined if wave steepness is considered fig 9f shows that the m 0 sw 1 2 in front of the seawall decreased rapidly with an increase of l r when l r 200 m mainly due to the increasingly complete wave breaking process whilst it slowly decayed when l r 300 m due to bottom friction this behavior could be described by a curve of a two exponent function fig 9h 3 2 3 impacts on the intensity of infragravity wave motion m 0 igw 1 2 in front of the seawall decreased as the fore reef slope became mild fig 9i this result agreed with the findings of masselink et al 2019 that cotθ is a key factor accounting for the generation mechanism of igws in the surf zone the effect of cotθ on m 0 igw 1 2 gradually diminished as the slope became mild fig 9i and there were critical slopes milder than which the cotθ would have a neglectable effect on m 0 igw 1 2 the critical slope was milder for waves with larger t p nevertheless the overall effect of cotθ on m 0 igw 1 2 can be described by an exponential function as shown in fig 9k the results in fig 9j suggest the existence of a particular reef flat length l r where the m 0 igw 1 2 achieves its maximum this particular l r was positively correlated with t p e g the l r 200 m for t p 14 s while the l r 150 m for t p 10 5 s note that these reef flat length values roughly corresponded to the ones where the wave setup approached its ceiling implying that the wave breaking process significantly influences the generation of igws furthermore a gradual decrease in m 0 igw 1 2 for l r 200 was found since the bottom roughness was neglectable in the present numerical setting the decreasing trend may result from the weakened resonant mode of the reef system longer reef flat lowered the resonant frequency eq 13 and resulted in resonant modes being overlapping over less energetic igws thus less energy was transferred to the resonant system pomeroy et al 2012b the overall variation of m 0 igw 1 2 with respect to the varying l r could be described by a piecewise function shown in fig 9l 3 2 4 impacts on overtopping rate as the wave intensity and setup generally decreased with the increase of cotθ and l r a decreasing tendency of q for the increase of these two morphology variables can be expected fig 10 a b except for the run with low wave steepness as mentioned above due to possible surging breaking unlike the continual decreasing trend of q with respect to cotθ the overtopping rate q approached constant values slightly later when l r 300 m fig 10c d the overtopping rate q was more sensitive to the morphology variables than that of wave parameters the values of q with cotθ 2 could be on average 15 times the one with cotθ 20 fig 10c and the ratio was more pronounced about 33 between the runs with l r 25 m and 500 m fig 10d this result demonstrates the highly variable level of flooding risk of coral reef islands worldwide considering their contrasting morphology characteristics 4 discussion waves interact with the seawalls on reef flats and may overtop over them under energetic wave conditions the overtopping rates provide vital assessments for the flooding risk behind the seawall this study revealed that the flooding risk depends not only on the sea state but also on the large scale reef morphology in the past few decades little attention has been paid to the artificial protection projects of coral reef islands probably because the reef topographies are often thought to be natural barriers or submerged breakwaters since the shallow reef flats are expected to be efficient in dissipating wave energy based on the concept of depth limited breaking over horizontal bottoms e g costa et al 2016 ferrario et al 2014 however the results of this study demonstrated that the reef topography may exacerbate the flooding risk of the fringed islands due to the following two aspects first the steep fore reef slope could significantly elevate the water levels on reef flats since the wave setup is more enhanced with a steeper fore reef slope this could be a great threat to the reef islands in tropical and subtropical oceans because they commonly have maximum elevations less than 4 m higher than the mean sea level pearson et al 2017 the enhancement of wave setup in reef environments is not only a product of the physical experiment e g buckley et al 2015 gourlay 1996 yao et al 2017 but also observed in natural reefs during storm conditions e g vetter et al 2010 especially regular wave experimental results of kawasaki et al 2008 demonstrated that the wave setup over a scaled model of okinawa reef was much higher than that over a 1 33 mild slope causing a much larger overtopping rate on the former topography second steep fore reef slopes are more favorable to the generation of igws than mild slope beaches as the moving breakpoint forcing mechanism that dominates on steep slopes is more effective in generating igws than the mechanism of the release of shoaling bound igws that dominates on mild slopes baldock 2012 masselink et al 2019 moreover the steeper fore reef slopes result in larger reflection coefficients for the seaward igws on reef flats dean 1964 which help in preventing the leaking of seaward igws and exciting the natural reef resonances leading to an increase of the igw energy across the reef flat buckley et al 2018 in the present study the igws appeared to undergo little dissipation on the reef flat they exhibited an evident increase in magnitude toward the seawall under energetic off reef forcing conditions consistent with the field observations on roi namur island cheriton et al 2016 the resulted igws near the seawall were found to be closely correlated to the strength of an off reef forcing parameter h m 0 d e e p l 0 p 0 5 which means that the reef topography could exacerbate the flooding through generating large igws under energetic off reef wave conditions i e storms or large swells e g cheriton et al 2016 hoeke et al 2013 péquignet et al 2009 roeber and bricker 2015 shimozono et al 2015 to demonstrate the effects of reef topography on the flooding of fringed islands more clearly additional numerical modeling was conducted to obtain the incident wave parameters at the toe of a vertical seawall on a 1 50 mild slope beach then the overtopping rates of the seawall were estimated by using the formula of goda 2009 appendix a and were compared with the overtopping rates on coral reefs since the swash model has been extensively validated in terms of wave transformation on mild slopes in existing literature a cumbrous validation will not be conducted here and the simulated results are considered reliable the wave conditions and still water levels considered were the same as that of the physical experiment listed in table 1 and the seawall height was 10 cm on the model scale the computational domain is shown in fig 11 and the numerical settings were the same as stated in section 2 2 2 again the modeling was conducted on the model scale while the results would be translated to the prototype scale fig 12 shows that the overtopping rates for the reef were generally comparable to the estimated overtopping rates for the sloping beach however the reef topography tended to generate larger overtopping rates under lower still water depth conditions lower triangles where the wave induced setups were relatively remarkable furthermore the overtopping rates with energetic off reef wave forcing h m 0 d e e p l 0 p 0 5 40 m would be larger because of the accompanied energetic igws on the reef flat fig 7g combined with the effects of fore reef slope and reef flat length on the wave heights and setup demonstrated in fig 10 the complex effects of reef topographies can be concluded compared with a mild sloping beach the shallow and horizontal reef flat provides a space for sw energy dissipation but the steep fore reef slope is an effective promoter to the igws and wave setup reefs are advantageous to protecting the attached island under moderate sea states when wave breaking generated setup and igws are not remarkable while are the disadvantageous factors under extreme wave conditions especially the reefs with steep fore reef slopes and narrow reef flats this study contributed to the knowledge of how the wave induced overtopping at a vertical seawall is affected by the characteristics of the reef topography and off reef waves which helps in planning reclaimed islands on reefs from the perspective of the functionality of islands the seawalls are expected to locate to the seaward side as far as possible however by doing so one has to face higher flooding risk such that a higher and therefore more uneconomical seawall has to be built to provide equivalent protection therefore balances shall be made between the functionality of islands and the costs for protection the empirical function between the overtopping rate and the reef flat length shown in fig 10d provides a basic understanding while an artificial neural network predictor developed by liu et al 2020b that considers a wide range of fore reef slopes reef flat lengths seawall heights and sea states could be used to give a preliminary estimate 5 conclusions a laboratory experiment was performed to investigate wave transformation characteristics over reef topography and the response of wave overtopping rate of a vertical seawall built on the reef flat to the varying off reef wave height period and the still water level the experimental results on the general features of sw energy dissipation igw generation wave setup over the reef were in agreement with previous field observations and laboratory studies on the reef flat due to the reflection at the seawall standing waves dominated the wave motion which was identified from the spatial distribution of nodes and antinodes of wave spectra and was further confirmed by a theoretical standing wave formula off reef conditions with energetic wave forcing were likely to result in a dominant standing wave pattern at the fundamental resonant frequency on the reef flat corresponding to the first node locating at the reef edge and the first antinode at the seawall under this circumstance the igw height saw a drastic increase from the reef edge to the seawall which was interpreted as a sign of amplification due to the excitation of the fundamental resonant mode in previous studies the off reef wave period was shown to be an important factor controlling the hydrodynamics on the reef flat off reef waves of the longer periods resulted in higher intensity of sw motion mainly by raising the mean total water level and the intensity of igw motion was found to be linearly in proportional to the off reef forcing parameter h m 0 d e e p l 0 p 0 5 regardless of the still water depth the non hydrostatic wave model swash was validated against the laboratory measurements which showed that the model could reasonably predict the essential hydrodynamic process in wave transformation across the reef then the swash model was used to augment the laboratory experiment dataset with two series of simulations aiming to explore the effects of varied reef topographies it was found that the intensity of sw motion and setup decreased as the fore reef slope became mild the intensity of igw motion decreased remarkably when the slope of fore reef varied from 1 2 to 1 10 and then the influence of fore reef slope gradually diminished for a slope milder than 1 10 the reef flat length affected the intensity of sw motion and setup on the reef flat oppositely to the fore reef slope and a particular length for the highest intensity was found overall the overtopping rate followed constant trends of decreasing with decreasing fore reef slope and increasing reef flat length a comparative study regarding the overtopping rate of vertical seawalls on a reef flat and on a sandy beach was conducted results suggested a complex role of the reef topography on the flooding risk of the attached islands compared with topographies of sloping beaches coral reefs with mild fore reef slopes and wide reef flat both of which contribute to a longer topography are more effective in protecting the attached island under moderate sea state while reefs with steep fore reef slopes and narrow reef flat could exacerbate the flooding under extreme wave conditions credit authorship contribution statement ye liu conceptualization methodology investigation formal analysis writing original draft shaowu li supervision writing review editing funding acquisition zhiling liao writing review editing methodology kun liu writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments two anonymous reviewers are acknowledged for their helpful comments dr guangyao wang of the university of michigan is acknowledged for his effort in improving the writing of the manuscript this research work is supported by the national natural science foundation of china grant no 51779170 appendix a goda 2009 wave overtopping formulas goda 2009 derived unified formulas for vertical and inclined seawalls with impermeable surfaces which is expressed in an exponential function form as a 1 q g h m 0 t o e 3 exp a b r c h m 0 t o e where h m0 toe is the significant wave height of incident waves at the toe of the structure r c is the crest freeboard and a 2 a a 0 tanh 0 956 4 44 tan θ d t h m 0 t o e 1 242 2 032 tan 0 25 θ b b 0 tanh 0 822 2 22 tan θ d t h m 0 t o e 0 578 2 22 tan θ with a 0 and b 0 being the functions of the seawall slope d t the still water depth at the structural toe and θ and slope angle for vertical seawalls constant values of a 0 3 4 and b 0 2 3 are recommended 
21166,widespread flooding of reef fringed islands demonstrates the insufficient protection provided by reef topographies and suggests the necessity of artificial structures for hazard prevention and mitigation as an indicator of the structural protection efficiency the wave overtopping rate is difficult to estimate in reef environments because hydrodynamics over reefs violate the application conditions of standard overtopping formulas a combined physical and numerical modeling was performed to investigate wave transformations over reefs of different topographies and overtopping at vertical seawalls on the reefs results showed that in addition to the off reef wave height and still water level the off reef wave period also played significant roles the intensity of short wave motions and the level of wave setup near the seawall were positively correlated with the off reef wave period and the intensity of infragravity wave motions depended largely on it steeper fore reef slopes would lead to more intensive wave motions and higher setup on reef flats and consequently higher overtopping rates furthermore the overtopping rate exponentially decreased with the distance between the seawall and reef edge primarily due to the decay of short waves in the surf zone keywords coral reef flooding infragravity wave seawall overtopping non hydrostatic model 1 introduction many tropical and subtropical reef fringed islands are exposed to open oceans where severe storms and energetic swells usually occur for these islands wave induced flooding has become a serious hazard due to the limited land areas low coastal plain elevations and fragile terrestrial ecosystems moreover climate change related sea level rise which may be up to 60 200 cm by the end of this century grinsted et al 2010 ipcc 2007 could increase the frequency and intensity of flooding consequently making these islands more vulnerable the frequent occurrence of flooding hazards in the last few decades e g hoeke et al 2013 jaffe and richmond 1993 roeber and bricker 2015 combined with the awareness of more serious threats in the future storlazzi et al 2015 suggest the necessary protection of artificial structures such as seawalls for both natural e g male marshall islands and reclaimed e g city of hope maldives islands dauenhauer 2017 packard 2014 however compared with the profound understanding regarding mild sloping coasts little is known about the seawall efficiency in mitigating the damage associated with energetic waves for reef fringed islands because of the complex hydrodynamics over the unique topography of reefs liu et al 2020a fringing reefs commonly have relative steep fore slopes 1 20 extending from deep waters to nearly horizontal reef flats with shallow water depths reefs that cover relatively narrow regions compared with continental shelves limit the development of storm surge dean and dalrymple 1991 but the abrupt changes in water depth over reef topographies impose significant influences on waves the energy of incident short waves sws 0 04 0 2 hz in prototype can be effectively dissipated by the depth limited breaking which starts in the vicinity of the reef edge and extends to some distance shoreward gourlay 1994 yao et al 2013 2020a as a result the transmission of sws is significantly controlled by the water depth on the reef flat both field observations and laboratory experiments proved that heights of individual stable sws never exceed 0 55 times of local water depths gourlay 1994 nelson 1996 in this regard reefs are often thought to be natural barriers for the fringed coasts costa et al 2016 ferrario et al 2014 however breaking of sws elevates the mean water level i e wave setup to balance the spatial reduction in radiation stress on the reef flat the magnitude of setup depends on the difference between radiation stresses at the breakpoint and on the reef flat so that it is influenced by the incident wave height still water level and fore reef slope becker et al 2014 buckley et al 2015 vetter et al 2010 yao et al 2017 since they have impacts on the intensity and persistence of breaking generally wave setup is higher on a reef than on a mild slope beach because the enlarged breaker index on the steep fore reef slope results in a transfer of a large amount of kinetic energy from waves and rollers to the potential energy of waters buckley et al 2015 except for the sws infragravity waves igws 0 004 0 04 hz in prototype also contribute largely to the water level fluctuations and the consequent coastal flooding despite their secondary magnitude in off reef regions interactions between incident waves and reef topographies highly promote the igws on the reef flat buckley et al 2018 cheriton et al 2016 masselink et al 2019 nwogu and demirbilek 2010 yao et al 2019 because the steep fore reef slope is favorable to the generation of moving breakpoint forced igws which are more energetic than the released bound igws masselink et al 2019 yao et al 2020b phases and heights of the generated free igws are subsequently modified by the reflection processes at both the shoreline or seawall and the reef edge thus igws may be trapped and resonantly amplified on reef flats buckley et al 2018 moreover because the motions of igws significantly alter the local water depths of sws in the surf zone the sw groups after breaking tend to be in phase with the local igws it means that larger sws are more likely to ride on the crests of igws and promote extreme water levels liu et al 2020a liu and li 2018 as reviewed above most of the existing studies focused on wave hydrodynamics on natural reef topographies without an artificial defense structure recently chen et al 2020 numerically investigated regular wave overtopping over a seawall on a reef flat and wave force acting on the seawall however studies on the interaction between random waves and vertical seawalls in reef environments are very few to assist the design of engineering measures in hazard mitigation projects as well as to provide a basic evaluation on flooding risk for islands fringed by different reef morphologies there is a need to understand how these physical drivers of wave induced flooding i e sws igws and wave setup vary with different random wave conditions and reef morphologies as well as the mechanisms underneath it this study conducted a combined physical and numerical investigation to include possible variations of these parameters aiming to examine their effects and provide insights on the responsible mechanisms the rest of the paper is organized as follows section 2 introduces the methods including the physical experiment and the numerical modeling an overview of the formulae used for analysis a preliminary description of wave transformation over the reef and the validation of the numerical model results of the physical experiment of various off reef sea states and the numerical modeling of various reef morphologies are presented in section 3 section 4 discusses the role of reefs on the flooding of the attached islands the main conclusions are drawn in section 5 2 methods 2 1 physical experiment liu et al 2020a 2020b detailly described measurements of wave transformation over a laboratory reef topography model and overtopping at vertical seawalls on the reef flat as illustrated in fig 1 a two dimensional reef profile was constructed to a 1 49 geometric scaling factor with a 1 5 fore reef slope and a horizontal reef flat of 4 14 m 203 m in prototype or 6 00 m 294 m in prototype length depending on the location of the vertical seawall the reef surface was made of smooth polyvinyl chloride to guarantee the protection of seawalls in worst case scenarios concerning the possible coral degradation caused by climate change and coral mining random waves were generated according to the jonswap spectrum with a peak enhancement factor of 3 3 the duration for each run was 1000 t p where t p is the off reef spectral peak period water surface elevations across the reef and in the overtopping tank were measured using capacitance wave gauges with a sampling rate of 30 hz fig 1b fifteen runs of wave conditions were conducted at three water levels table 1 with the designed deep water significant wave height h m0 deep ranging from 4 to 10 cm 2 0 4 9 m in prototype the spectral peak period of 1 0 2 5 s 7 0 17 5 s in prototype and the still water depth on the reef flat h r of 3 0 6 0 cm 1 5 3 0 m in prototype covering waves of a wide range of conditions note that the test runs with t p 2 5 s implied a relatively shallow off reef water depth where the jonswap spectral form was physically invalid therefore using non hydrostatic numerical simulations we assessed the influences of off reef water depth on the spatial variations of wave motion intensities and wave setup as well as the overtopping rate it was found that such an off reef water depth led to neglectable effects and can be accepted not shown the deep water surf similarity parameter eq 8 in section 2 3 1 was within the range of 0 9 3 1 mainly falling in the plunging type breaker pattern on the fore reef slope nevertheless we also observed spilling breakers and non breaking waves in a single wave train cf fig 7 of li et al 2019 due to the irregularity of wave groups it must be noted that the actual wave parameter values from measurements see section 2 3 1 may be slightly different from the designed values listed in table 1 however the differences did not lead to a substantial deviation from the conclusions of the present study liu et al 2020a focused on the responses of overtopping rate to various still water depth incident wave condition at the seawall toe and the seawall height while in this study we used the data with reef flat length of 6 00 m 294 m in prototype and seawall height of 10 cm 4 9 m in prototype to analyze further the influences of combined off reef wave conditions and water levels on the main drivers of coastal flooding i e the intensities of sw and igw motions and wave setup in front of the seawall based on these results wave overtopping responses to off reef wave conditions and water levels were presented only the runs with the overtopping rate q larger than 10 6 m3 s m 3 4 10 4 m3 s m in prototype were considered in this study hence the runs with t p 1 0 s 7 0 s in prototype were excluded in the following because the overtopping rate q in these runs barely exceeded the threshold 2 2 numerical modeling 2 2 1 model description since only one fixed reef morphology was involved in the physical experiment numerical modeling became an alternative to investigating the influences of varying reef morphology this study adopted the open source phase resolved non hydrostatic model swash zijlema et al 2011 considering its outstanding performances in simulating nearshore hydrodynamics over a wide range of environments including coral reefs see the swash related publications on the website of http swash sourceforge net the governing equations for its depth averaged version are the nonlinear shallow water equations with additional non hydrostatic pressure terms 1 ζ t h u x 0 2 u t u u x g ζ x 1 2 p b x 1 2 p b h ζ d x c f u u h 0 3 w s t 2 p b h w b t w b u d x 4 u x w s w b h 0 where ζ is the water surface elevation x is the horizontal spatial coordinate t is the time h and d are total and still water depths respectively u is the depth averaged horizontal velocity c f n 2 g h 1 3 is the roughness friction factor where n is the manning s roughness coefficient and g the gravitational acceleration p b is the non hydrostatic pressure at the bottom and w s and w b are the vertical velocities at the free surface and the bottom respectively the model turns off the non hydrostatic pressure and reduces to a nonlinear shallow water equation model to foster the development of free surface discontinuity when the temporal partial derivative of surface elevation exceeds a specific time of the local speed of shallow water waves then the wave breaking and associated energy dissipation are inherently accounted for by ensuring the momentum conservation over the discontinuity the criterion for neglecting the non hydrostatic pressure terms is expressed as 5 ζ t α g h 2 2 2 model setup the model setup generally followed that of liu et al 2020b the incident wave boundary was fixed at x 2 16 m i e the location of gauge 1 in the physical experiment and the toe of the fore reef slope was fixed at x 0 00 m fig 2 the crest level of the vertical seawall above the reef flat was 0 1 m a numerical overtopping water tank of 6 0 m long was attached to the back of the seawall the overtopping rate was estimated based on the flux on top of the seawall by varying the fore reef slope and the reef flat length different reef morphologies were implemented water surface elevations of incident waves which were obtained by applying the separation method of mansard and funke 1980 to physical measurements of the gauges 1 3 were specified at the incident wave boundary x 2 16 m reflection at the wave maker boundary was weakened by adopting a weakly reflective condition a sponge layer of 3 m in length and a sommerfeld radiation condition were placed at the outflow end of the numerical overtopping tank the grid size was 0 01 m and the time step was governed by the courant friedrichs lewy condition the manning s roughness coefficient n was 0 012 s m1 3 to simulate a relatively smooth surface the sampling frequency of 30 hz was the same as that in the physical experiment two series of numerical tests were conducted table 2 both employed the intermediate water level of the physical experiment series a and b aimed at assessing the effects of fore reef slope and reef flat length respectively 2 3 data processing 2 3 1 spectral analysis and parameter definition spectral analysis employed surface elevation time series of 215 samples with hanning windowed segments of 211 samples and 50 overlapping resulting in 31 degrees of freedom the wave spectrum s f was decomposed into sw and igw components by a cutoff frequency of f p 2 f p 1 t p is the off reef spectral peak frequency liu et al 2020a 2020b and many others used 4 s f d f as a representative wave height over shallow reefs in analogy with the definition for the approximate value of significant wave height in deep water however since the statistical formulation and associated properties on individual wave heights of the wave fields over shallow reefs are not well known the definition 4 s f d f essentially represents the potential energy of wave motions rather than the statistical wave heights therefore we used the following parameters as measures of intensities of short wave eq 6 and infragravity wave eq 7 motions 6 m 0 s w 1 2 f p 2 6 f p s f d f 7 m 0 igw 1 2 0 f p 2 s f d f local water depth h composes of the still water depth d and wave setup setdown η i e h d η surf similarity parameter was estimated by 8 ξ 0 tanθ h m 0 d e e p l 0 p where l 0p denotes the deep water wavelength associated with the peak period responses of m 0 sw 1 2 m 0 igw 1 2 η and q denoted by x to the variation of a morphological parameter were quantified by the ratio between the values of x to the value of x of a morphological reference case 9 γ x x i j x i j r e f where the subscript i and j denote different wave conditions and different values of the morphological parameter respectively the morphological reference case i e the ref in the subscript was cotθ 5 for series a and l r 6 0 m for series b table 2 respectively then the influences of varying wave conditions were further averaged out to only reserve the effects of morphological variations as 10 γ x 1 n i 1 n x i j x i j r e f 2 3 2 separation of shoreward and seaward infragravity waves surface elevations of shoreward η i g and seaward η i g igws were separated using the synchronous data of surface elevations η i g and horizontal velocities u ig in the igw frequency band f f p 2 as follows e g lashley et al 2020 11 η ig η i g c u i g h c c 12 η ig η i g c u i g h c c where phase celerity of shoreward propagating igws c was calculated by the group celerity c g at x x b and by the shallow water celerity g h at x x b where x b is the mean position of the breakpoint phase celerity of seaward propagating igws c was g h since there was no velocity measurement in the physical experiment the separation was done based on the numerical results 2 3 3 standing wave a standing wave shows spatially alternating nodes minimum potential energy and antinodes maximum potential energy for a given location on the reef flat nodes of standing waves resulting from the reflection of seawall occur at the frequencies buckley et al 2018 13 f n o d e 1 4 2 m 1 x x s e a w a l l 1 g h d x 1 where m 0 1 2 is the order of mode and x seawall is the location of seawall this equation considers the reef topography as an open basin of variable depth natural resonances will be excited with a standing wave node located at the reef edge x 3 m in fig 1b where the downwind steep slope partly reflects the seaward igws and changes the igw phases by π thus the igw energy is trapped and amplified on the reef flat 2 3 4 performance metric the performance of the swash model was quantified using the following objective function 14 s k i l l 1 x s x m 2 x s x m x m x m 2 where the subscripts s and m stand for swash simulated and physically measured values respectively the overbar means taking the averaged value an increase in the skill value between 0 and 1 indicates an improved performance 2 4 validation of the swash model and wave transformation across the reef the value of α that controls the contribution of non hydrostatic terms eq 5 may influence the accuracy of the swash model however numerical sensitivity tests of liu et al 2020b showed promising results that the simulated cross reef distribution of total wave height including sw and igw setup and spectral mean period are not susceptible to the value of α see fig 8 therein these results are consistent with buckley et al 2014 and lashley et al 2018 which showed that both the default and tuned values of α led to satisfactory results the reason may be that the slope of fore reef is of secondary importance to wave breaking yao et al 2013 by contrast tuning the value of α is necessary for correctly reproducing the overtopping rate liu et al 2020b because the wave motion of runup on a vertical wall involves significant vertical acceleration closely related to the non hydrostatic pressure gradient therefore for a given wave condition in the present study the value of α was preliminarily tuned based on the overtopping rates measured in the physical experiment 2 4 1 wave heights and setup model data comparisons of cross reef variations of m 0 sw 1 2 m 0 igw 1 2 and η for two runs run h45h08t25 with h r 4 5 cm h m0 deep 8 0 cm and t p 2 5 s run h45h06t15 with h r 4 5 cm h m0 deep 6 0 cm and t p 1 5 s at the middle water level are shown in fig 3 to illustrate the general features of wave transformation as well as to validate the swash model in general spatial variations of m 0 sw 1 2 over the reef were well reproduced by the swash model fig 3a b for both runs m 0 sw 1 2 increased in the shoaling zone on the fore reef slope then rapidly decreased on the outer reef flat mainly due to wave breaking on the middle and inner reef m 0 sw 1 2 slowly decayed which was caused by the bottom friction and the energy transfer to lower frequencies due to resonant triad interactions over the shallow reef at the location of gauge 20 x 8 98 m neighboring the seawall m 0 sw 1 2 was about 50 higher than that at gauge 19 x 8 46 m probably a consequence of co existing wave height fluctuations goda and suzuki 1976 a challenging phenomenon well captured by the swash model here for both runs m 0 igw 1 2 increased in the shoaling zone of sws and decreased in the outer surf zone before reaching the reef edge x 3 m fig 3a b on the reef flat x 3 m the variations of m 0 igw 1 2 showed different behaviors for the two runs m 0 igw 1 2 gradually increased shoreward for the run with energetic incident waves fig 3a while remaining nearly unchanged for the run with moderate wave actions fig 3b all these features were captured by the swash model with reasonable accuracy though igws were more challenging to simulate than sws to shed more light on the cross reef variations of m 0 igw 1 2 the shoreward and seaward propagating igws were separated based on the numerical results results showed that although the shoreward igws were small in magnitude in the off reef region their shoaling rates on the fore reef slope were high owing to the energy transfer from sws to igws through triad interactions on an upward slope li et al 2020 the decrease in shoreward m 0 igw 1 2 from the breakpoint to the reef edge was consistent with the dissipative tendency of group bounded waves in the surf zone which was first suggested by longuet higgins and stewart 1962 and lately discussed by baldock 2012 comparative heights of shoreward and seaward igws on the reef flat indicated the full reflection of igws at the vertical seawall therefore the spatial distribution of total igw height on the reef flat could be largely accounted for by the interferences between its shoreward and seaward components as will be illustrated in section 2 4 2 the wave setup η gradually decreased in the shoaling zone while rapidly increased in the surf zone fig 3c d the swash model slightly underpredicted η on the reef flat because the model is currently unable to simulate surface rollers leading to the underestimating the kinetic energy of breaking waves however the underprediction effect was trivial in the context of its relatively small magnitude compared with the total mean water depth 2 4 2 wave spectrum the wave spectrum changed drastically over the reef for the run h45h08t25 fig 4 a b higher and lower harmonics grew remarkably on the fore reef indicating the nonlinear energy transfer to these frequencies during shoaling li et al 2020 breaking of sws played the primary effect in the continuous decrease of energy around the spectral peaks another feature is the wave energy concentrating toward the igw frequencies near the seawall the presence of standing waves significantly altered the measured spectra on the reef flat fig 4b the spectra showed alternative crests and troughs in the frequency domain the frequencies of spectral troughs corresponded well with the frequencies of theoretical standing wave nodes eq 13 in both sw and igw frequency bands in this run h45h08t25 energy at the fundamental frequency of natural reef resonances m 0 and f node 0 03 hz eq 13 dominated the igws on the reef flat similar to previous studies buckley et al 2018 nwogu and demirbilek 2010 other resonant modes were discernible but not significant since the fundamental mode contained only one node at the reef edge and one antinode at the seawall phases of its surface elevations were identical over the reef flat and its amplitude increased from the reef edge to the seawall hence justifying the spatial variation of m 0 igw 1 2 displayed in fig 3a overall features of the spectral spatial evolution in the condition of moderate off reef waves h45h06t15 fig 5 a b were roughly the same as that in the condition of energetic off reef waves h45h08t25 fig 4a b however a noticeable difference in the igw band can be observed there were three resonant reef modes for the run h45h06t15 but the modes were not intensely excited fig 5b the igws mainly consisted of standing waves with frequencies between adjacent resonant frequencies these standing waves had different wave lengths so that their nodes and antinodes were not clustered but dispersed over the reef flat therefore the node antinode pattern was less evident as indicated by the smaller ratio of total to shoreward m 0 igw 1 2 despite the full reflection at the seawall fig 3b measured and simulated spectra of the two runs were compared in figs 4c and 5c from which it can be seen that the swash model achieved satisfactory levels of accuracy in both sw and igw frequencies as indicated by the high values of the performance index skill eq 14 2 4 3 overtopping rate the swash model was calibrated by optimizing the parameter α to minimize the error in overtopping rate predictions the optimal α for the runs with h r 4 5 cm and seawall height of 10 cm had a mean of 1 92 and a standard deviation of 0 26 perfect agreements between the measured q meas and simulated q swash overtopping rates with optimal α for each run can be seen in fig 6 3 results 3 1 influences of off reef hydrodynamic forcing in this subsection the physical measurements were used to explore the influences of the off reef hydrodynamic forcing i e wave height period and water level on wave setup and intensities of sw and igw motions near the seawall as well as on the overtopping rate the analysis focused on the measurements of gauge 19 x 8 46 m instead of that of gauge 20 x 8 98 m to avoid influences of co existing wave height fluctuations in the vicinity of the seawall in the following the variables will be displayed in prototype scale by transforming their small scale values according to froude s similarity law 3 1 1 impacts on wave setup on average wave setup near the seawall η r increased with the decrease of still water depth on the reef flat h r fig 7 a consistent with previous laboratory studies and field observations becker et al 2014 gourlay 1996 yao et al 2017 forcing of greater off reef wave height and longer period would result in larger η r because of the concomitant higher energy flux that is proportional to h m 0 d e e p 2 t p although η r was inversely modulated by h r the total mean water depth still positively depended on the h r fig 7b 3 1 2 impacts on the intensity of short wave motion a significant decrease of m 0 sw 1 2 near the seawall compared with the h m0 deep demonstrated the dissipative effect of the reef topography on the sw energy fig 7c obviously the effectiveness in reducing sw energy highly depended on the h m0 deep h r as a typical consequence of depth limited wave breaking on the reef flat with nearly horizontal topography m 0 sw 1 2 near the seawall increased linearly to the increase of h m0 deep fig 7c however the dependence of the ratio of m 0 sw 1 2 to total mean water depth with still water depth and setup incorporated on the h m0 deep was not remarkable fig 7d therefore it turns out that the enlargement of m 0 sw 1 2 was mainly a consequence of high setup induced by large h m0 deep as indicated by fig 7b moreover m 0 sw 1 2 increased with the t p of deep water waves fig 7c and the effect of t p was more evident at lower still water depths this could also be related to the higher off reef wave energy flux of waves with a longer period and the resultant stronger depth modulation effect due to the more significant wave setup fig 7a b fig 7d shows that the ratio of m 0 sw 1 2 to the total mean water depth achieved a more considerable value at higher h r it may be because of the different characteristics of spilling and plunging breakers on one hand waves reformed at the end of the surf zone have a larger wave height to water depth ratio for spilling breakers compared with that of plunging breakers gourlay 1994 on the other hand different from regular waves a random wave train could have both spilling and plunging breakers due to the irregularity of individual wave parameters li et al 2019 the portions of the two types of breakers depend on h r based on the results of regular wave experiments gourlay 1994 yao et al 2013 when h r becomes high waves are more likely to break in spilling which will therefore result in a large ratio of wave motion intensity to water depth based on the experimental data of the present physical experiment it was found that the wave motion intensity to total mean water depth ratio roughly increased with the decreasing f c 0 g 1 25 h m 0 d e e p 0 5 t p 2 5 h r 1 75 and h m0 deep h r which are the parameters controlling the breaking types on coral reefs not shown gourlay 1994 yao et al 2013 3 1 3 impacts on the intensity of infragravity wave motion although igws were secondary in magnitude in off reef regions they could be highly pronounced on the reef flat see fig 7e and contributed largely to the water level fluctuations consistent with previous field obversions and laboratory studies buckley et al 2018 masselink et al 2019 nwogu and demirbilek 2010 pomeroy et al 2012a a distinct feature of m 0 igw 1 2 was that it varied linearly with respect to h m0 deep but was well grouped by t p rather than by h r fig 7e more specifically waves with longer periods produced higher m 0 igw 1 2 near the seawall using the off reef energy flux parameter h m 0 d e e p 2 t p could not eliminate the scattering fig 7f while a clustered linear relation was obtained by an off reef forcing parameter h m 0 d e e p l 0 p 0 5 fig 7g that gives more weight to the t p as l0p is in proportion to the square of t p the high dependence of m 0 igw 1 2 on t p was in partial agreement with the field observation of gawehn et al 2016 this result highlights the role of the off reef wave period on the flooding risk of reef fringed coasts since igws contribute largely to the wave fields on reef flats 3 1 4 impacts on overtopping rate an exponential relation between q and h m0 deep was found in fig 8 similar to the exponential relation between q and the incident wave height at the seawall toe liu et al 2020a it may be partly because both m 0 sw 1 2 and m 0 igw 1 2 near the seawall increased for increasing h m0 deep fig 7 c and e furthermore h r and t p also had positive influences on q but the significance was also subject to h m0 deep for small values of h m0 deep the q was sensitive to h r for larger values of h m0 deep however the t p became increasingly important liu et al 2020a investigated the effects of wave parameters at the seawall toe on the overtopping rate they found that as a comprehensive representation of both sws and igws the effect of the wave spectral mean period t m 1 0 m 1 m 0 where m n is the m th spectral moment was neglectable in estimating the overtopping rate such a result is not in contradiction with the finding of fig 8 as the wave parameters at the seawall toe have been altered by the off reef forcing the study of liu et al 2020a aimed at proposing an approach to estimate overtopping rates based on prior knowledge on the wave heights on reef flats while fig 8 attempts to provide a basic understanding of how the off reef forcing conditions affect the overtopping rate 3 2 influences of reef morphology in this subsection the influences of reef morphology i e slope of fore reef and length of reef flat on wave setup and intensities of sw and igw motions near the seawall as well as on the overtopping rate were investigated based on the numerical results wave parameters at 0 5 m 24 5 m in prototype scale away from the seawalls were analyzed and the results are displayed in prototype scales 3 2 1 impacts on wave setup wave setup in front of the seawall η r simulated by the swash model demonstrated strong dependency on the fore reef slope fig 9 a for instance the values of η r in a steep slope condition cotθ 2 were on average 2 4 times the ones with a relatively mild slope cotθ 20 and the value of γ η eq 10 followed an exponential type monotone decreasing function concerning cotθ in this range fig 9c the results were consistent with fig 12 of yao et al 2017 which shows that the experimental data of η r with cotθ 1 were much larger than η r with cotθ 6 9 6 concerning the reef flat length l r the η r first increased and then approached a constant value fig 9b when the reef flat became long enough for wave breaking to develop and finally cease fig 3 the runs with shorter wave periods reached their upper limits within a narrower range of the reef flat but on average the increase of η r would cease for l r further extended beyond 200 m such a pattern of variation could be described by a hyperbolic tangent type function fig 9d 3 2 2 impacts on the intensity of short wave motion fig 9e shows a decreasing trend of m 0 sw 1 2 as the fore reef slope becomes mild it may be due to that the decrease of η r allowed less sw energy on the reef flat for the depth limited breaking mode however the runs with smaller off reef wave steepness i e small h m0 deep and large t p exhibited a slight opposite trend of increase for cotθ 3 5 the reason is that these runs had surf similarity parameters of 3 9 eq 8 which indicated a dominant breaking manner of surging in general the variation of m 0 sw 1 2 could be described by an exponent type regression curve fig 9g but the prediction is expected to be more refined if wave steepness is considered fig 9f shows that the m 0 sw 1 2 in front of the seawall decreased rapidly with an increase of l r when l r 200 m mainly due to the increasingly complete wave breaking process whilst it slowly decayed when l r 300 m due to bottom friction this behavior could be described by a curve of a two exponent function fig 9h 3 2 3 impacts on the intensity of infragravity wave motion m 0 igw 1 2 in front of the seawall decreased as the fore reef slope became mild fig 9i this result agreed with the findings of masselink et al 2019 that cotθ is a key factor accounting for the generation mechanism of igws in the surf zone the effect of cotθ on m 0 igw 1 2 gradually diminished as the slope became mild fig 9i and there were critical slopes milder than which the cotθ would have a neglectable effect on m 0 igw 1 2 the critical slope was milder for waves with larger t p nevertheless the overall effect of cotθ on m 0 igw 1 2 can be described by an exponential function as shown in fig 9k the results in fig 9j suggest the existence of a particular reef flat length l r where the m 0 igw 1 2 achieves its maximum this particular l r was positively correlated with t p e g the l r 200 m for t p 14 s while the l r 150 m for t p 10 5 s note that these reef flat length values roughly corresponded to the ones where the wave setup approached its ceiling implying that the wave breaking process significantly influences the generation of igws furthermore a gradual decrease in m 0 igw 1 2 for l r 200 was found since the bottom roughness was neglectable in the present numerical setting the decreasing trend may result from the weakened resonant mode of the reef system longer reef flat lowered the resonant frequency eq 13 and resulted in resonant modes being overlapping over less energetic igws thus less energy was transferred to the resonant system pomeroy et al 2012b the overall variation of m 0 igw 1 2 with respect to the varying l r could be described by a piecewise function shown in fig 9l 3 2 4 impacts on overtopping rate as the wave intensity and setup generally decreased with the increase of cotθ and l r a decreasing tendency of q for the increase of these two morphology variables can be expected fig 10 a b except for the run with low wave steepness as mentioned above due to possible surging breaking unlike the continual decreasing trend of q with respect to cotθ the overtopping rate q approached constant values slightly later when l r 300 m fig 10c d the overtopping rate q was more sensitive to the morphology variables than that of wave parameters the values of q with cotθ 2 could be on average 15 times the one with cotθ 20 fig 10c and the ratio was more pronounced about 33 between the runs with l r 25 m and 500 m fig 10d this result demonstrates the highly variable level of flooding risk of coral reef islands worldwide considering their contrasting morphology characteristics 4 discussion waves interact with the seawalls on reef flats and may overtop over them under energetic wave conditions the overtopping rates provide vital assessments for the flooding risk behind the seawall this study revealed that the flooding risk depends not only on the sea state but also on the large scale reef morphology in the past few decades little attention has been paid to the artificial protection projects of coral reef islands probably because the reef topographies are often thought to be natural barriers or submerged breakwaters since the shallow reef flats are expected to be efficient in dissipating wave energy based on the concept of depth limited breaking over horizontal bottoms e g costa et al 2016 ferrario et al 2014 however the results of this study demonstrated that the reef topography may exacerbate the flooding risk of the fringed islands due to the following two aspects first the steep fore reef slope could significantly elevate the water levels on reef flats since the wave setup is more enhanced with a steeper fore reef slope this could be a great threat to the reef islands in tropical and subtropical oceans because they commonly have maximum elevations less than 4 m higher than the mean sea level pearson et al 2017 the enhancement of wave setup in reef environments is not only a product of the physical experiment e g buckley et al 2015 gourlay 1996 yao et al 2017 but also observed in natural reefs during storm conditions e g vetter et al 2010 especially regular wave experimental results of kawasaki et al 2008 demonstrated that the wave setup over a scaled model of okinawa reef was much higher than that over a 1 33 mild slope causing a much larger overtopping rate on the former topography second steep fore reef slopes are more favorable to the generation of igws than mild slope beaches as the moving breakpoint forcing mechanism that dominates on steep slopes is more effective in generating igws than the mechanism of the release of shoaling bound igws that dominates on mild slopes baldock 2012 masselink et al 2019 moreover the steeper fore reef slopes result in larger reflection coefficients for the seaward igws on reef flats dean 1964 which help in preventing the leaking of seaward igws and exciting the natural reef resonances leading to an increase of the igw energy across the reef flat buckley et al 2018 in the present study the igws appeared to undergo little dissipation on the reef flat they exhibited an evident increase in magnitude toward the seawall under energetic off reef forcing conditions consistent with the field observations on roi namur island cheriton et al 2016 the resulted igws near the seawall were found to be closely correlated to the strength of an off reef forcing parameter h m 0 d e e p l 0 p 0 5 which means that the reef topography could exacerbate the flooding through generating large igws under energetic off reef wave conditions i e storms or large swells e g cheriton et al 2016 hoeke et al 2013 péquignet et al 2009 roeber and bricker 2015 shimozono et al 2015 to demonstrate the effects of reef topography on the flooding of fringed islands more clearly additional numerical modeling was conducted to obtain the incident wave parameters at the toe of a vertical seawall on a 1 50 mild slope beach then the overtopping rates of the seawall were estimated by using the formula of goda 2009 appendix a and were compared with the overtopping rates on coral reefs since the swash model has been extensively validated in terms of wave transformation on mild slopes in existing literature a cumbrous validation will not be conducted here and the simulated results are considered reliable the wave conditions and still water levels considered were the same as that of the physical experiment listed in table 1 and the seawall height was 10 cm on the model scale the computational domain is shown in fig 11 and the numerical settings were the same as stated in section 2 2 2 again the modeling was conducted on the model scale while the results would be translated to the prototype scale fig 12 shows that the overtopping rates for the reef were generally comparable to the estimated overtopping rates for the sloping beach however the reef topography tended to generate larger overtopping rates under lower still water depth conditions lower triangles where the wave induced setups were relatively remarkable furthermore the overtopping rates with energetic off reef wave forcing h m 0 d e e p l 0 p 0 5 40 m would be larger because of the accompanied energetic igws on the reef flat fig 7g combined with the effects of fore reef slope and reef flat length on the wave heights and setup demonstrated in fig 10 the complex effects of reef topographies can be concluded compared with a mild sloping beach the shallow and horizontal reef flat provides a space for sw energy dissipation but the steep fore reef slope is an effective promoter to the igws and wave setup reefs are advantageous to protecting the attached island under moderate sea states when wave breaking generated setup and igws are not remarkable while are the disadvantageous factors under extreme wave conditions especially the reefs with steep fore reef slopes and narrow reef flats this study contributed to the knowledge of how the wave induced overtopping at a vertical seawall is affected by the characteristics of the reef topography and off reef waves which helps in planning reclaimed islands on reefs from the perspective of the functionality of islands the seawalls are expected to locate to the seaward side as far as possible however by doing so one has to face higher flooding risk such that a higher and therefore more uneconomical seawall has to be built to provide equivalent protection therefore balances shall be made between the functionality of islands and the costs for protection the empirical function between the overtopping rate and the reef flat length shown in fig 10d provides a basic understanding while an artificial neural network predictor developed by liu et al 2020b that considers a wide range of fore reef slopes reef flat lengths seawall heights and sea states could be used to give a preliminary estimate 5 conclusions a laboratory experiment was performed to investigate wave transformation characteristics over reef topography and the response of wave overtopping rate of a vertical seawall built on the reef flat to the varying off reef wave height period and the still water level the experimental results on the general features of sw energy dissipation igw generation wave setup over the reef were in agreement with previous field observations and laboratory studies on the reef flat due to the reflection at the seawall standing waves dominated the wave motion which was identified from the spatial distribution of nodes and antinodes of wave spectra and was further confirmed by a theoretical standing wave formula off reef conditions with energetic wave forcing were likely to result in a dominant standing wave pattern at the fundamental resonant frequency on the reef flat corresponding to the first node locating at the reef edge and the first antinode at the seawall under this circumstance the igw height saw a drastic increase from the reef edge to the seawall which was interpreted as a sign of amplification due to the excitation of the fundamental resonant mode in previous studies the off reef wave period was shown to be an important factor controlling the hydrodynamics on the reef flat off reef waves of the longer periods resulted in higher intensity of sw motion mainly by raising the mean total water level and the intensity of igw motion was found to be linearly in proportional to the off reef forcing parameter h m 0 d e e p l 0 p 0 5 regardless of the still water depth the non hydrostatic wave model swash was validated against the laboratory measurements which showed that the model could reasonably predict the essential hydrodynamic process in wave transformation across the reef then the swash model was used to augment the laboratory experiment dataset with two series of simulations aiming to explore the effects of varied reef topographies it was found that the intensity of sw motion and setup decreased as the fore reef slope became mild the intensity of igw motion decreased remarkably when the slope of fore reef varied from 1 2 to 1 10 and then the influence of fore reef slope gradually diminished for a slope milder than 1 10 the reef flat length affected the intensity of sw motion and setup on the reef flat oppositely to the fore reef slope and a particular length for the highest intensity was found overall the overtopping rate followed constant trends of decreasing with decreasing fore reef slope and increasing reef flat length a comparative study regarding the overtopping rate of vertical seawalls on a reef flat and on a sandy beach was conducted results suggested a complex role of the reef topography on the flooding risk of the attached islands compared with topographies of sloping beaches coral reefs with mild fore reef slopes and wide reef flat both of which contribute to a longer topography are more effective in protecting the attached island under moderate sea state while reefs with steep fore reef slopes and narrow reef flat could exacerbate the flooding under extreme wave conditions credit authorship contribution statement ye liu conceptualization methodology investigation formal analysis writing original draft shaowu li supervision writing review editing funding acquisition zhiling liao writing review editing methodology kun liu writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments two anonymous reviewers are acknowledged for their helpful comments dr guangyao wang of the university of michigan is acknowledged for his effort in improving the writing of the manuscript this research work is supported by the national natural science foundation of china grant no 51779170 appendix a goda 2009 wave overtopping formulas goda 2009 derived unified formulas for vertical and inclined seawalls with impermeable surfaces which is expressed in an exponential function form as a 1 q g h m 0 t o e 3 exp a b r c h m 0 t o e where h m0 toe is the significant wave height of incident waves at the toe of the structure r c is the crest freeboard and a 2 a a 0 tanh 0 956 4 44 tan θ d t h m 0 t o e 1 242 2 032 tan 0 25 θ b b 0 tanh 0 822 2 22 tan θ d t h m 0 t o e 0 578 2 22 tan θ with a 0 and b 0 being the functions of the seawall slope d t the still water depth at the structural toe and θ and slope angle for vertical seawalls constant values of a 0 3 4 and b 0 2 3 are recommended 
21167,this study investigates the macroscopic features of tidal farm layouts optimized to maximize power production in an idealized shallow channel with steady unidirectional flow by varying the number of turbines and optimization constraints numerical experiments were conducted using opentidalfarm an open source solver for tidal farm optimization using pde constraint gradient based optimization to alleviate the computational complexity for identifying a global optimum a concept of quasi global optimum was introduced a local optimum that serves as a global optimum in a crude sense from extensive numerical results notable patterns in the shape of the quasi global optimal layout were observed and explained by a nondimensional parameter e the ratio of the shortest hypothetical linear fence to the length of the lateral farm site constraint the quasi global optimal layout had a linear fence shape when e 1 the layout evolved into a downstream concave parabola and subsequently into a v shape as e increased beyond 1 moreover as more turbines were added to an array the quasi global optimal layout was no longer a single fence and some turbines were separated from the main body from the quantitative perspective it is shown that the power production could be increased by up to 50 by tuning the optimization constraints keywords tidal current turbine tct tidal farm gradient based optimization initial layout shape optimization constraint 1 introduction renewable energy technology is destined to play a major role in helping tackle the world s energy and climate change related problems one such technology involves the extraction of hydro kinetic energy from natural flows such as wind river and tidal currents unlike most power generation methods that use natural flows the tidal current turbine tct is free from the intermittency issue of resources because of its high predictability denny 2009 recently the tidal energy industry has reported success in generating electric energy equivalent to the local energy demand using a floating type tct device thereby revealing the prospects for the commercialization of tcts marineenergy biz 2018 roberts et al 2016 in order to satisfy the energy demand a general way to implement turbines in flows is deploying them as a group or so called tidal farm vennell et al 2015b the design of a tidal farm involves two steps of macro and micro arrangements vennell et al 2015a while a macro arrangement helps determine the number of turbines in a row and the number of rows in an array a micro arrangement determines the positions of turbines within an array once a macro arrangement has been made with respect to the local electricity demand a micro arrangement proceeds to improve the farm efficiency by tuning the turbines in a single row vennell 2010 or multiple rows in concert vennell 2011 various numerical and analytical studies have found that arranging an equal number of turbines in a centered array produces less power than arranging them in a staggered form churchfield et al 2013 divett et al 2013 draper and nishino 2014 hunter et al 2015 malki et al 2014 vennell 2012 gonzález gorbeña et al 2016 notably malki et al 2014 and divett et al 2013 demonstrated the performance of a staggered array in the case where the streamwise spaces between the front and rear rows were small within a range of diameters of 2 3 turbines however the array layouts in those previous works are only applicable to cases where each row is a linear line type fence no substantial evidence has been presented to support their advantages over the myriad of other possible array layouts especially turbines in the rear rows inevitably suffer reduced productivity as the flow decelerates after passing through the front rows therefore it has come under scrutiny that the use of conventional two step arrangements for a tidal array would lead to a design that can fully extract all energy available from a site to overcome such limitations in previous works the present study tries to find optimal array layouts that could maximize the extraction of energy without imposing structural layouts such as centered or staggered forms by freely arranging the turbine positions a possible approach to finding an optimal tidal farm layout is to use an optimization algorithm gradient based algorithms update the positions of design parameters by using first or higher order derivatives of objective functions by contrast gradient free algorithms do not require computing functional derivatives instead design parameters are updated by exploiting the results of functional evaluations at numerous sample points in the parameter space since the mid 1990s studies on wind farm optimization have widely adopted gradient free algorithms mosetti et al 1994 and found that the genetic algorithm and particle swarm optimization yielded good results for wind farm layout optimization problems salcedo sanz et al 2011 wan et al 2010 brutto et al 2016 successfully implemented particle swarm optimization to optimize tidal farm layout in a discrete domain with an analytical approximation for the flow field with tcts however their approach does not fully reflect the hydrodynamical effects such as the duct effect vennell et al 2015b and so the estimated power production from the tidal farm could be underestimated if the farm site is located at a laterally bounded tidal channel a more accurate way to resolve the tidal flows with tcts is to solve the hydrodynamic model of tidal currents which are generally expressed by partial differential equations pdes in this case the pdes used as the governing equations of the tidal flow act as a constraint in the optimization giving rise to a class of problem known as pde constrained optimization hence every functional evaluation involves a state evaluation step which is computationally expensive to circumvent the burdensome computation expense on solving pdes gonzález gorbeña et al 2016 2018 used surrogate based optimization sbo by constructing a surrogate model which approximates the objective function from the sample data drawn from high fidelity hydrodynamic models and searching the optima using the gradient free approach gonzález gorbeña et al 2016 2018 successfully showed that sbo approach offers an effective way of avoiding burdensome state evaluations when the aim of optimization is the micro arrangement of a fixed form of layout however constructing a valid surrogate could be more expensive than directly solving pde constraint if no baseline layout for the tidal farm is prescribed and all turbines are let to be placed freely to form an optimal layout in this study we are not making presumptions on the shape of the optimal layout of a tidal farm and thus a gradient based algorithm is preferred over a gradient free algorithm to meet the objective of this study the gradient based algorithm also faces the problem of obtaining the functional derivative of pde constrained optimization because it is too computationally taxing funke et al 2014 proposed a novel technique to formulate the pde constrained gradient based optimization problem automatically for a tidal farm using the adjoint method for the fast and scale independent evaluation of a functional derivative notably funke et al 2014 demonstrated a maximum increase of 96 in power production could be achieved after optimizing a densely packed regular grid type array with 32 turbines increased power production has been predicted in previous studies on micro array arrangement divett et al 2013 but not as large as obtained by funke et al 2014 thereby underlining the importance of site specific arrangements gradient based optimization has another inherent drawback in that its solution is highly sensitive to the initial solution additionally solutions of this optimization method are likely to be stuck in the local minima of multimodal functions and in most cases the convergence of solutions to the global optima cannot be guaranteed noel 2012 funke et al 2014 recognized the limitation of gradient based optimization and hence focused on validating the robustness and efficiency of the developed framework a way to avoid this is to prescribe a proper initial layout il of which the knowledge is currently unavailable inspired by the fact that a flock of birds forms an array with specific shape during migration we speculated that the layout of an optimal tidal farm would exhibit a specific shape under ideal conditions if the speculation is true and the il is prescribed by the expected shape of the global optima it is more likely that the solution will not deviate from the true global optima by a significant margin and thus one may prevent the solutions from converging to unexpected or less productive local optima therefore the present study aims to unveil the uncovered features of the optimal configuration of a tct array mainly by answering the following three questions while finding the optimal solutions for a tct farm formulated with the gradient based method i what types of il can ensure faster convergence to the global optima ii does the configuration of the global optima have a specific characteristic shape iii what effect do the optimization constraints ocs such as the size of the available farm site and the minimum turbine spacing have on the optimal layout of a tidal farm and its power production to answer these questions a set of consecutive numerical experiments were performed with opentidalfarm an open source solver for specific pde constrained gradient based optimization problems funke et al 2014 especially those related to tidal farm design as the complexity of a problem increases it becomes difficult to prove that the obtained solution is a global optimum as an alternative we attempted to reconcile the cost and accuracy by using a sub optimal solution that can be regarded as a surrogate of the true global optimum this work refers to such solutions as quasi global optimum qgo a detailed conceptualization will be discussed in section 4 from this concept alone one cannot quantitatively evaluate the deviations from the exact global optima still we believe this concept can work as a prototype of the exact global optima and aid in engineering practices the paper is organized as follows in section 2 we briefly present the pde constrained gradient based optimization and its hydrodynamic model i e shallow water equations in section 3 a methodology for tct modeling and simulation settings for the numerical experiments are presented throughout sections 4 to 6 we develop a stepwise framework of a set of numerical experiments to find qgo finally we give some concluding remarks in section 7 2 problem formulation the optimal layout of a tidal farm can be obtained by solving an optimization problem with pde constraints the equations of the pde constrained optimization can be defined as 1 max z p j z p subject to f z p 0 g p 0 l b p l u where j z p is the objective function to be maximized z is the state variable p is the design parameter and f z p 0 is the state equation which consists of a system of pdes such a set of pdes physically constrains the given problems by invoking conservation laws in this study the set of pdes is comprised of two dimensional shallow water equations swe g p 0 is an inequality constraint that enforces a minimum distance between each turbine and l b and l u are the lower and upper bounds for a box constraint respectively there exists a unique z for every p if the pde constraint is well posed which is true for the swe funke et al 2014 in such a case z can be represented as a function of the design parameter p i e z z p by plugging this function into j the objective functional becomes j j z p p and the pde constrained optimization problem is reduced to a simpler form without the pde constraint the model based on this reduced form i e opentidalfarm shows good performance in the time marching problem long et al 2012 thus it is worth noting that although the present study addresses steady state problems it can be further extended to unsteady problems the aim of optimization is to maximize the power generation of a tidal farm with n turbines as the optimal positions of each turbine should be identified on a two dimensional plane the design parameter p in this study is defined as 2 p x 1 y 1 x 2 y 2 x n y n where x i y i is the location of i t h turbine and n is the total number of turbines the objective functional j is the total power produced by the turbines in an array it is worth noting that this power is not the real available electrical power rather it is a theoretical indicator representing the farm productivity while neglecting the energy loss during conversion to electricity the mechanical power produced by a turbine is defined as the product of flow velocity and turbine thrust with a quadratic relationship to the velocity magnitude hence the objective functional is 3 j u p ω ρ c t p u 3 d x where u u v is the vector of depth averaged x and y directional velocities ω is the domain of interest for a farm ρ is the fluid density c t p is the thrust coefficient for a tidal turbine and represents 2 norm in equation 3 evaluation of j inevitably involves that of u therefore to obtain precise two dimensional velocity fields of tidal flows a non conservative form of swe is used for the state equation the state variable z is defined as u h where h is the water depth and is uniquely determined for every p through an implicit function f in this study we assumed the flow to be stationary as a trade off between accuracy and computational cost of over a hundred simulations now the pde f z p 0 becomes 4 u u ν 2 u g h c b c t p h u u 0 h u 0 where ν is the viscosity g is the gravitational acceleration c b is the bottom friction coefficient and c t p is the thrust coefficient for a tidal turbine or the turbine friction coefficient which will be discussed in a later section both the bed friction and the thrust exerted by the turbine on the fluid body were implemented as one depth averaged sink term which is proportional to the square of velocity the diffusion term i e ν 2 u is artificially imposed large enough to ensure the existence of steady state solution by suppressing the occurrence of unsteady wakes behind each turbine it is worth noting that the resolved flow field might suffer some disparity to the true flow field because the oscillatory wake behind the turbine is smeared out by artificial viscous dissipation instead the resulting flow field is designed to reproduce the important mean flow features section 3 3 which is sufficiently reasonable for our macroscopic objective of investigating the shape of optimized arrangements of the tidal turbines to enforce constraints on p two types of inequality constraints are provided one limits the farm site to a rectangular area with the length l x and width l y of the site the tidal array is allowed to be deployed within that area the second constraint addresses the distances between each turbine this constraint is applied to prevent the turbines from overlapping each other it is worth noting that in the real practice of wind firm construction it is a rule of thumb to avoid the deleterious wake effects on the adjacent turbine structures patel 2005 minimum distance d min between the turbines is ensured by implementing inequality constraints as follows 5 p i p j 2 d min 2 for 1 i j n where p indicates the position vector of the turbine and the subscript of integers i and j represent the i t h and j t h turbines 3 experimental setup 3 1 simulation domain all the cases were simulated by setting a rectangular farm site located along the centerline of an ideal shallow channel see fig 1 in order to ensure that the fluid structure interactions were properly resolved in turbine simulation a hybrid mesh is utilized over the whole simulation domain composed of two different types of meshes for the region of interest that includes the farm site an alternated structured mesh consisting of uniform triangular elements with 2 m long edge was used for the outer region an unstructured mesh in which the elements were stretched from 2 m up to 20 m toward the boundaries was used the tidal channel was modeled as a simplified rectangle with an area of 900 m 600 m whereas the fine mesh zone sat at the channel s center with an area of 600 m 500 m the whole domain consists of approximately 160 000 nodes and 80 000 elements these mesh configurations were used consistently to preserve the resolution of the turbine wake instead of the case dependent number of meshes the mesh was generated using gmsh 2 0 geuzaine and remacle 2007 to reduce unwanted numerical reflections at the open boundaries of the upstream and downstream of the tidal farm the flather boundary condition was applied to the inlet and outlet which are denoted as boundary 1 and 2 in fig 1 a respectively the flather boundary condition is a type of radiation boundary condition commonly used in the field of ocean modeling pham et al 2016 pham and hwang 2020 constructed by coupling sommerfeld radiation equation with continuity equation the flather boundary condition allows propagation of a conservative quantity throughout the boundary by radiating deviations from the reference values and shows good performance for flows with small wave amplitude jung and hwang 2018 reference velocity at the inlet was set as u inlet u 0 0 and reference water level at the outlet was h values of u 0 and h are listed in table 2 the free slip condition was applied elsewhere boundary 3 in fig 1 opentidalfarm uses the finite element method to solve swe to discretize swe in the weak formulation piece wise quadratic functions for u and piece wise linear functions for η c b and c t are used as basis functions or shape functions the newton method was used to find the global matrix in an iterative manner for the optimization algorithm the sequential least square quadratic programming included in the scipy optimization package was selected for its record of good convergence for the constrained optimization problem virtanen et al 2020 3 2 tidal turbine modeling as mentioned before the energy extraction by a tidal turbine has been implemented as additional bed friction proportional to the momentum flux which is a simple model that exclusively accounts for the horizontal thrust being exerted on the fluid although there are many other advanced turbine models such as the linear momentum actuator disc theory garrett and cummins 2007 houlsby et al 2008 nishino and willden 2012 the present study prefers a simple turbine model to ensure smoothness of the functional j even though it is common practice to uniformly add the sink term to the turbine s representative area while adding zero value elsewhere this manner of parameterization can be problematic to the application of gradient based optimization because the friction function becomes non differentiable therefore friction due to the turbine was modeled as a smooth bell shaped bump function within the turbine s radius the two dimensional function is expressed as 6 φ p r x y exp 2 1 1 q x i 1 1 q y i for q i i r 1 0 otherwise where p i x i y i is the location of the i t h turbine s center and r is the turbine s radius summation of all distribution functions over the entire domain yields the total turbine friction function c t p 7 c t p i 1 n k i φ p r x y where k i is the scaling or tuning parameter for the thrust intensity of the i th turbine k i should be adjusted so that the scaled thrust can generate a realistic turbine effect the turbine model used in this study however cannot reproduce the exact influence on the flow field as real rotor turbines myers and bahaj 2010 due to the simplifications still it can reproduce the distance for wake recovery i e the downstream distance where the mean velocity of the wake flow recovers to the expected percentage of the upstream velocity and we believe that it is sufficient for the present problem this is because the length and velocity of the turbine s wake are the reliable features which can be resolved at the scale of shallow flows and these features are expected to be the crucial influence factors for our proposed optimization problem previous works on the wake recovery structure of an isolated tidal turbine summarized in table 1 indicate that velocity at the near wake zone x 3 d where x is the downstream distance from the turbine s center strongly depends on the turbine s specifications at x 5 d and x 10 d downstream the velocity magnitude lay within the range of 65 75 and 70 80 of the upstream velocity respectively at the centerline the velocity recovers 90 of its upstream velocity at x 20 d we can easily deduce that the wake profile is dependent on k but k would not be the sole factor determining the wake structure reduced flow velocity near the center of the wake is recovered by the momentum transfer from the fast bypass flow to the slow wake flow which can be determined by the value of ν and the rate of momentum diffusion as ν is mainly dependent on the flow properties a proper set of k and ν should be determined for the given simulation settings 3 3 simulation parameters the parameters and physical constants of the simulation are summarized in table 2 these parameters were determined to emulate a realistic tidal current flowing through a shallow tidal channel in typical natural tidal channels the froude numbers range from 0 1 to 0 2 roberts et al 2016 stallard et al 2013 for this study we set the froude number at the inlet as 0 1 with an initial water depth h of 50 m and an inlet velocity u 0 of 2 m s the diameter of a tidal turbine blade d was set to 20 m typically commercial tidal turbines are installed in the water at a depth that is 1 5 3 0 times larger than their diameters stallard et al 2013 the bottom friction coefficient was set to a constant value of 0 0025 funke et al 2014 to set the appropriate k and ν simultaneously wakes behind a single tidal turbine were simulated and analyzed under the diverse conditions a turbine was deployed at the center of the domain for each case with the eight different combinations of k and ν fig 2 a the case with k 10 and ν 2 m 2 s reproduced the desired wake properties which have been discussed in section 3 2 and this set of values was chosen for the subsequent experiments with multiple turbines with the given parameters an isolated turbine could generate a power of 2 75 mw on average the power coefficient c p is commonly used to represent the mechanical power and its magnitude is normalized by the kinetic energy of the upstream flows subject to the turbine area this study defined c p for a single rotor as c p 0 0 3361 among the many types of commercial turbines with similar specifications simec atlantis energy s seagen s exhibited 2 mw of power with flows traveling at 2 5 m s atlantis resources 2016 therefore the modeled turbine was able to mimic the performance of a real turbine and its impact on flows in a simplified tidal current modeling it should be noted that the value of k 10 depends on the positions of the turbine as the friction distribution function equation 6 is linearly interpolated over the grid domain thus the turbine areas to which the bottom friction is applied vary slightly with the turbine location the maximum deviation 0 45 of c p 0 is used to represent half of the uncertainty interval ui of c p which is discussed in subsequent sections and interpreted as a criterion for determining whether the c p s are same 4 impact of initial layout on the solutions in this section a concept of qgo which is a surrogate of the true global optimum that possesses important features that the global optimum is expected to have is introduced then the experimental framework to deduce the qgo is discussed followed by the demonstration on the experimental setup and the results of the baseline test set hereinafter referred to as test 1 to shed light on the desirable features of a qgo the methodology addressed in section 3 often yields a local optimum which comprises the positions of individual turbines that locally maximize j on one of the multiple concave hulls in general the global optimum could be found by solving the optimization problems with a set of initial solutions where its cardinality is sufficiently large enough to contain the global optimum after optimization as the number of turbines n increases however we face higher dimensional problems with many concave hulls making it much harder to obtain a global optimum hence the present study introduced the qgo concept to alleviate this difficulty qgo was designed with speculation that the optimal solution possesses some macroscopic features e g the shape of the array which may be more important than microscopic information e g the specific position of turbines based on this speculation we anticipated that there would be a macro scale concave hull which is wiggly at micro scale i e includes numerous small concave hulls the local extremum points and global maximum point on the macro scale concave hull are expected to share the macroscopic features hence instead of finding the exact global optimum the objective has been mitigated to find a sub optimum that the value of j does not differ significantly from the global optimum and possesses the desired macroscopic features we refer to qgo as the best solution i e the solution which gives the highest j among the solutions starting from some finite size of il sets as the cardinality of il increases to infinity qgo converges to the true global optimum and thus consistency is satisfied to efficiently deduce qgo from small il sets a step by step sequential set of experiments is introduced as the first test 1 we solve the optimization problem with a small set of different shapes of ils then we extract some notable features shown from the solutions with the best performance i e highest c p i n d after the observation the following test is designed with the modified ils and we check whether the macroscopic features are observed again from the solutions if the features observed in the previous test are observed in the solutions in the following tests consistently it will consolidate that the qgo will possess the observed attributes if some new features are observed another following test is designed otherwise if no more new significant observations are made we stop designing the next test and finally qgo is suggested by integrating the desirable features of the qgo it is worth noting that desirable features of qgo would satisfy the following i the optimal layout will expose a symmetric shape ii if the il is designed to have the desired macroscopic features then the solution will converge faster the estimated global optimum namely qgo from the presented method may not return the true global optimum due to inadequate selection of il sets to start with still it is expected to be leveraged as a good surrogate in engineering practice as the starter test 1 applied five different types of ils a randomly scattered layout constructed by using latin hypercube sampling lhs one row two rows with two different distances one far and the other close respectively and the v shape layout fig 3 first for the lhs il the simulation was repeated five times for each case of n to observe any tendency on using this layout for the second il one row all turbines were placed as a single straight row spanning across the width of the farm site this case was not simulated when n was too large to align as a single row n 8 the third and fourth ils were selected to investigate the effects of streamwise distances between the rows of the turbines the distances between the rows are 14 d which is the maximum distance available and 5 d respectively if n is even the two rows are center aligned otherwise they were deployed in the staggered type with one less turbine in the rear row it should be noted that each row is uniformly spanned across the farm site the fifth type is a v shaped layout pointing upstream and the angle between the two lines was set as a right angle i e slope of 1 see fig 3 a all tests were performed near a tidal farm site with a rectangular area of 300 m 230 m with placing its lower left point at streamwisely 225 m and laterally 70 m apart from the origin of the entire domain d min was fixed to 1 5 d i e 30 m for all cases among all 43 simulation cases the nine cases of optimized layouts that overlapped with their corresponding ils are presented in fig 4 the quantitative comparison for the power output and the computational cost are proposed as the averaged individual power coefficient c p i n d and the number of iterations n iter respectively fig 5 it is notable that in several cases the optimal layout was not symmetric and did not have regular intra spacing layouts instead they had a small anomaly from a form that can be classified as a certain group such irregularities arise due to the high dimensionality of the problem and imply that the obtained solutions are local optima consider a certain case or cases that yields yield the highest power production among a group of cases with the same n we refer to this these case s as the best optimum optima if its their identifiable attributes are commonly observed in the other optimal layouts which are also classified as having highest productivity those attributes are regarded as the tentative attributes of a qgo grouping the results by n the differences in c p i n d s of the optimized arrays were in most cases insignificant regardless of the il type i e the differences of c p i n d s were within the uis of c p i n d for instance in the case of c p the cases of lhs one row and two rows 14 d ils corresponding to fig 4 a fig 4 b and fig 4 c respectively had nearly identical values of c p i n d s analogously for all groups with the same n there were more than one optima classified as the best optima marked as in fig a1 notably for each n these best optima shared a similar shape with some difference in the micro arrangement see fig a1 this result further demonstrates the complexity of the optimization problem and suggests the existence of multiple local optima that can produce a power approximate to the optimal power a common feature of the best optima is the congregated fence shape to be specific the array converged to a single fence spanning the full width of the farm site which is a linear row when n 8 if the turbines are more deployed then the layout becomes a curved or a v shaped fence it should be noted that the layouts are convex in the downstream direction and we refer to this shape as the upstream concave uc whereas the opposite is called the downstream concave dc assuming that the cost of state evaluation is similar in all cases the iteration number to evaluate the functional n iter can be used as a metric for computational cost because solving the equation of state is the most cumbersome part of this problem we hardly found any distinguishable tendency in n iter when they were grouped by il or n fig 5 b except that the v shape and one row il groups needed fewer iterations than the other il groups to find a local optimum in particular one row il groups converged to the best optima implying that the shape of the qgo is a unit row when n is small enough to deploy all turbines in a row this result suggests that initializing an array as a randomly scattered one i e lhs il or two separate rows i e two rows 5 d and 14 d il is ineffective because their shape largely deviates from a unit fence which is the expected shape of qgo moreover as it is not always possible to implement a tidal array in a single row n 8 for test 1 the v shaped il could be an alternative because it converges to the expected shape of qgo with small n iter in most cases there are still some issues to be resolved in using the upstream pointing v shaped il which will be discussed in the subsequent experiments in the case of a single row il there were no significant changes in the layouts after the optimization as the c p i n d could be improved only by a maximum of 0 1 fig 5 a since the optima are symmetric one row can be regarded as a strong candidate for the shape of a qgo for the cases of il with two rows with a spacing of 5 d the optimization solutions commonly converged to arrays that were symmetric and regularly spaced and the best optima this contrasts with the cases having two rows ils with a spacing of 14 d which fall under a more irregularly shaped local optima compared to the case with a 5 d spacing fig a1 considering that the qgo has the shape of a congregated fence more iterations will be required to merge the two rows into a single row as the distances between the front and rear rows become larger also in most cases placing an array in two rows has a negative impact on its neighboring downstream turbines in terms of turbine performance by exhibiting a c p i n d less than c p 0 additionally the power after optimization increases maximally by 95 7 of c p i n d when n 9 and il is in two rows with a spacing of 14 d fig 5 a note that it is a staggered il this result indicates that the staggered layout a typical tidal farm design can be less productive than a randomly scattered layout lhs il unless the distances between the front and rear rows are properly tuned note that these results apply for cases of a moderately small number of turbines and does not cover the case when n is large so that the array must form multiple rows the v shaped il requires fewer iterations to converge to the best optimum when n 10 when compared with the other ils for instance n 8 fig 4 f after optimization the array changes its shape from upstream to downstream concave but when n 10 the change of layout after optimization was not significant while the shape of the converged array was the only case with an upstream concave type array fig 4 i of these the aforementioned case shows the worst performance i e 5 3 smaller c p i n d than the case of the highest c p i n d this indicates that uc v shaped il in test 1 has ensnared the solution in the local optima further supporting the necessity of an il that does not impede the solution from converging to the qgo the present test demonstrated the importance of layout optimization in terms of the tidal farm performance and its dependency on the il type furthermore both convergences to the qgo and the computational cost depend on the il type thus the appropriate il will help solutions converge to a qgo in a more cost effective manner when conducting gradient based optimization for the tidal farm optimization problem analyzing the shape of the best optima we could deduce that a promising attribute of a qgo is being a dc fence specifically for a small n the shapes of qgo appear as a unit linear fence while for larger n they bend toward downstream forming a single fence among the five types of il uc v shape il mostly converged to the best optimum with a moderately small n iter however its shape is different from the expected shape of the qgo deduced from test 1 i e dc fence hence an improved il could be proposed which is similar in the shape of the qgo and thus ensures good convergence to the qgo with fewer iterations this will be addressed in the following sections we will also explore the fact that the v shaped il posed in uc did not always yield a qgo in the following experiment by additionally considering the optimization constraints 5 impact of optimization constraints on the optimization results one of the remarks we made from the previous section test 1 is that the gradient based algorithm occasionally fails to update toward the qgo but yields a local optimum still we could deduce some expected features of the qgo by analyzing the best optima in addition in most cases the v shaped il rapidly and reasonably converged to a symmetric solution however under certain conditions the layouts end up with a uc local optimum whereas the global one is expected to be dc along with our original objective to find the qgo the current set of experiments hereinafter referred to as test 2 is designed to investigate this interesting behavior by focusing on the v shaped il and varying the values of ocs for this experiment two parameters were controlled to examine the impact of ocs while the n was fixed to 8 l y was varied from 270 to 370 m in intervals of 25 m and d min was varied from 1 5 to 3 0 d in intervals of 0 5 d to observe the effect of direction of the v shaped il on the solutions two types of v shaped il were applied as shown in fig 3 b and fig 3 c one il is the uc v shape ucil which is analogous to the one used in test 1 and the other il is dc v shape henceforth dcil the v shaped ils were designed to have an intra turbine spacing of d min with a slope of the wing of 3 4 positive for the upper side and negative for the lower side change in the slope magnitude was to ensure array emplacement under the case of extreme constraints for example see d in fig 6 and fig 7 to analyze the result a new non dimensional parameter e is introduced as follows 8 e n 1 d min d l y e represents the ratio of the total length of a linear fence composed of n turbines with an intra spacing of d min and a turbine diameter of d to the lateral width of the farm site ly when e 1 the layout cannot exhibit a linear configuration with the given constraints when e 1 the solution converged to a linear fence regardless of the convexity of il in contrast when c p 0 ucil converged to a uc array fig 6 and dcil converged to a dc array fig 7 fig 8 a quantitatively shows that the dc optima produced more power than the uc optima when e 1 by a maximum difference of 2 5 this corresponds to the case when e 1 63 fig 6 d for the uc optima and fig 7 d for the dc optima where the c p i n d of dc optima is 116 c p 0 fig 8 a therefore it is reasonable to deduce that the qgo possess a dc v shape under a large e and dcil is suggested to be implemented to ensure the qgo for the gradient based optimization as e increased the shape of the optimal array changed as it did in test 1 fig 8 b starting from a linear array at e 1 the curvature of the optimized array increased with the e until the optima transformed from a smooth parabola to a v shape as the optimal layouts were symmetric in shape and were in agreement with the observed features of the qgo they can be assumed as the qgo for the given ocs interestingly this shape transition of the optimal array corresponds to the linear decrease of c p i n d in terms of the e with a slope of 0 113 fig 8 a by contrast the performance of an array does not vary when the optima possess the linear fence form with e 1 the mean c p i n d 0 4280 and sd 0 6 of the mean c p i n d although the optima could not always be classified as qgo due to their irregularities this result indicates that once e is tuned to be less than unity it can maximize the performance of the array in terms of power 6 designing robust initial layout and analysis on its resulting qgo the previous tests demonstrated an obvious trend in the shape of the optimal layout which is a function of n d min and l y likewise ils need to be chosen with care to have an analogous layout with the qgo to ensure fast and solid convergence to the qgo therefore an adaptive il reflecting the change in the shape of the optimal layout under various conditions should be introduced meanwhile we also explored the array separation process and observed it until the maximum number of turbines in an array that can maintain a single fence form has been reached the analysis of array configuration and its power production under array separation or breakdown is expected to provide valuable insights for planning a cost effective tidal farm in this section the experimental set test 3 is designed to resolve the following two goals a to propose an il that can ensure convergence to the qgo under various conditions i e different combinations of ocs and b to find a condition in which the qgo does not maintain the unit fence form and analyze its notable features in total nine sets of optimization constraints were imposed by combining d mins of 1 5 d 2 0 d and 2 5 d and ly of 230 m 300 m and 370 m for each oc set several turbines were installed in the initial experiment and more turbines were continuously being added for the next experiments until the array separated into two distinct parts after the optimization i e a single turbine is detached from the main array while the starting n is designed to form a tightly placed linear fence i e e 1 in the lateral direction to eliminate the influence of the streamwise length of the farm site l x on results l x was doubled from the value used in the previous tests i e lx 600 m the results of test 2 showed that the uc v shaped layout may have a good convergence to the qgo with the large e yet the result may not always be symmetric nor have the regular turbine intra spacings with the small e this supports the fact that an il guaranteeing sound and fast convergence should be designed analogous to the expected optimal layout here we introduce the arc shaped il fig 3 d distances between the turbines were set by d min and r and the arc radius was determined to satisfy the condition where the chord of the arc is equal to l y for example a linear fence like il was produced by setting a large radius and the minimum value of the available radius was ly d 2 which yields a semicircular shape to increase the n from the aforementioned semicircular state turbines were added to the front thus producing a horseshoe shaped array like although the graphical results have not been presented here the arc il yielded a decent qgo which is regular and symmetric with a relatively moderate n iter compared with test 1 fig a2 in appendix a grouping the results by the set of ocs fig 9 c p i n d tends to reach a maximum value as e approaches unity and decrease as more turbines are added i e as e increases this result is analogous to that of test 2 and the decreasing rate of power is steeper when d min 1 5 d also grouped by l y c p i n d was maximum when d min 1 5 d the overall maximum c p i n d was observed when d min was 1 5 d and l y was 370 m however it is premature to conclude that denser deployments of tidal fences are more conducive to power production this is because the generated shallow water field does not resolve the negative lateral wake effect although the graphical results have not been included the same trend was found in the shape of the qgo with respect to e fig 8 b it is notable that the use of the new arc type il yielded a symmetric and regularly spaced optima that can be classified as a qgo when excess turbines are deployed to the domain the array starts to break apart and a few turbines become detached from the v shaped main body the detached turbines were then placed upstream by an appropriate distance where the wake of the separated turbine diffuses helping the turbine in the downstream avoid the negative impact of wake on the power production fig 10 we also observed that when the array separation occurs the angle between the two edges of the v shaped main body array is smaller when ly is small and d min is large furthermore significant drops in c p i n d were observed except for the case of d min 2 5 d and l y 300 m after a turbine had been detached from the v shaped main body in addition for the case represented in fig 10 b deploying 12 turbines with d min 2 5 d and l y 270 m c p i n d was less than c p 0 the ineffectiveness of optimization is not because the observed optima is not qgo we have found that v shaped array is a valid qgo for large e but the above results implies the ineffectiveness of adding excess turbines after the array separation in total 65 cases with the nine sets of optimization constraints ocs were simulated the results were grouped with the number of turbines n the values of the optimal power output vary by a maximum of 50 54 depending on the set of ocs in case of n 13 see fig 11 a also the case with d min 1 5 d and ly 370 m yielded the highest c p i n d among the group of n 13 which is around 1 5 cp 0 in other words if properly arranged 13 turbines can produce as much energy as 20 turbines additionally when e 2 c p i n d of the optimal array was less than c p 0 therefore providing a well designed set of ocs is important to ensure better performance of a tidal farm we also validate the results of test 2 in that c p i n d linearly decreases with e when e 1 see fig a2 7 conclusions this work addresses the various aspects of the optimal configuration of a tct farm along with tests to obtain a reliable qgo with the gradient based optimization various numerical experiments were conducted to find the underlying general trend of the optimal array layout and furthermore its dependency on ocs owing to the inherent features of the tidal farm optimization problem we preferred the gradient based algorithm over the gradient free algorithm the three main findings of this study are i the il is critical for the gradient based algorithm to overcome its inherent limitation of convergence to local optima and to ensure the convergence to qgo at a low computational cost thus we recommend using a well designed il as it has a configuration similar to the global optima this requires the information on the expected optimal array in advance and we recommend the dc arc shape as a practical il configuration for an idealized channel its shape should be determined by adjusting the arc radius such that all turbines could be placed with the designed l y while the length of the chord is equal to l y ii for an ideal tidal strait with a rectangular geometry constraint there exists a generalized trend in the global optima if possible the optimal layout is a linear fence that expands laterally over the full width of the farm if there are too many turbines to be deployed in a linear fence with the minimum distance constraint of d min then the optimal layout will develop into an arc shaped fence and subsequently into a v shape until a turbine is detached from the array and the array breaks into two parts all qgos commonly possess dc shape additionally placing turbines in the linear fence arrangement is the most productive choice for a fixed n c p i n d linearly decreases as e increases when e 1 iii the oc significantly affects the configuration of the optimal array and its power production the shape of an optimal array is subject to the ocs for an identical number of turbines in an array the generated power substantially varies with oc suggesting that the selection of oc is important to the design of a cost efficient tidal farm finally from these conclusions we recommend a method of designing an efficient tidal farm in idealised rectangular channels with uniform flow all turbines should be connected as a single fence located at the center of the tidal channel cross section if possible the linear fence form should be adopted for the highest possible power efficiency this further implies that overly conservative ocs insufficient l y or overestimated wake recovery lengths may yield a less effective design therefore we need to utilize engineering criteria for designing minimum spacing between the turbines considering the analysis of its wake regions future studies should develop a criterion for determining the minimum distance on the lateral impact of wakes on the neighboring turbines additionally practical applications of this work should consider the idealization we made for the simulation domain while the suggested qgo is only valid for the case of a unidirectional tidal current natural tidal straits may have bidirectional or unsteady flows with periodicity a non streamwise symmetric qgo will be less productive when the current flows in the reverse direction this may imply that a linear tidal fence is a universal qgo still the bidirectionality may not be a serious problem because a uc array has been found to be effective local optima with an acceptable performance decline when the value of e is moderate to include the time varying features of a tidal current it is desirable to perform optimization constraining with a transient swe future studies could also incorporate complex coastal sites as the simulation domain or non rectangular geometry for the farm site constraints to test the extensibility of the qgo layouts from this study to the case of irregular channels or unsteady bidirectional flow the sbo approach could be exploited by setting the qgo layouts as the baseline layouts for the metamodel construction validation of the derived optimal array can be made through experiments or comprehensive cfd simulations moreover we did not consider the possible environmental impacts while designing the tidal farm one may use the suggested array to extract more energy by changing the local flow fields but such an action may alter the sediment transport and further degrade its local marine ecosystem thus striking a balance between the economic gain and environmental loss should be considered in the practical design stage credit authorship contribution statement jisu han conceptualization methodology data curation investigation visualization writing original draft jaeyoung jung conceptualization visualization editing the manuscript jin hwan hwang supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper abbreviations and nomenclature il initial layout oc optimization constraint qgo quasi global optima uc upstreamwise concave dc downstreamwise concave ucil upstreamwise concave v shape initial layout dcil downstreamwise concave v shape initial layout pde partial differential equation lhs latin hypercube sampling cfd computational fluid dynamics j objective functional mechanical power produced by the tidal farm z u h state variable solution of the state equation u depth averaged x and y directional velocities h water depth h initial water depth p design parameter a list of 2 d positions of the turbines ν kinematic viscosity g gravitational acceleration ρ density of water d turbine diameter n number of deployed turbines d min minimum intra turbine distance constraint lx streamwise width of the farm site l y lateral width of the farm site cb bottom friction function c t p turbine friction function k scaling parameter for the turbine thrust intensity ϕ p r x y 2 d bump function for an individual turbine u0 streamwise inlet velocity cp power coefficient of turbine c p 0 nominal power coefficient of a single turbine c p i n d averaged power coefficient of a turbine a from tidal array e ratio of the shortest hypothetical linear fence that could be constructed satisfying d min to l y appendix fig a 1 test 1 extended version of graphical representation of test 1 shaded rectangular area is the available farm site red dots indicate the turbines associated with the il and blue dots indicate the ones after optimization in total 23 cases are presented rows are grouped into n from 6 to 10 top to bottom and columns into il type lhs one row two rows with a spacing of 5 d two rows with a spacing of 14 d v shape from left to right representative cases with lhs il are the ones that yield the highest power output among the five lhs simulation realizations for each n asterisk under the label denotes the best optimum in the row fig a 1 fig a 2 test 3 grouping by n from 10 to 13 top to bottom c p i n d c p i n d linearly decreases with the increase in e as observed in test 2 cases with other ns are neglected as the data points are not large enough for the regression fig a 2 
21167,this study investigates the macroscopic features of tidal farm layouts optimized to maximize power production in an idealized shallow channel with steady unidirectional flow by varying the number of turbines and optimization constraints numerical experiments were conducted using opentidalfarm an open source solver for tidal farm optimization using pde constraint gradient based optimization to alleviate the computational complexity for identifying a global optimum a concept of quasi global optimum was introduced a local optimum that serves as a global optimum in a crude sense from extensive numerical results notable patterns in the shape of the quasi global optimal layout were observed and explained by a nondimensional parameter e the ratio of the shortest hypothetical linear fence to the length of the lateral farm site constraint the quasi global optimal layout had a linear fence shape when e 1 the layout evolved into a downstream concave parabola and subsequently into a v shape as e increased beyond 1 moreover as more turbines were added to an array the quasi global optimal layout was no longer a single fence and some turbines were separated from the main body from the quantitative perspective it is shown that the power production could be increased by up to 50 by tuning the optimization constraints keywords tidal current turbine tct tidal farm gradient based optimization initial layout shape optimization constraint 1 introduction renewable energy technology is destined to play a major role in helping tackle the world s energy and climate change related problems one such technology involves the extraction of hydro kinetic energy from natural flows such as wind river and tidal currents unlike most power generation methods that use natural flows the tidal current turbine tct is free from the intermittency issue of resources because of its high predictability denny 2009 recently the tidal energy industry has reported success in generating electric energy equivalent to the local energy demand using a floating type tct device thereby revealing the prospects for the commercialization of tcts marineenergy biz 2018 roberts et al 2016 in order to satisfy the energy demand a general way to implement turbines in flows is deploying them as a group or so called tidal farm vennell et al 2015b the design of a tidal farm involves two steps of macro and micro arrangements vennell et al 2015a while a macro arrangement helps determine the number of turbines in a row and the number of rows in an array a micro arrangement determines the positions of turbines within an array once a macro arrangement has been made with respect to the local electricity demand a micro arrangement proceeds to improve the farm efficiency by tuning the turbines in a single row vennell 2010 or multiple rows in concert vennell 2011 various numerical and analytical studies have found that arranging an equal number of turbines in a centered array produces less power than arranging them in a staggered form churchfield et al 2013 divett et al 2013 draper and nishino 2014 hunter et al 2015 malki et al 2014 vennell 2012 gonzález gorbeña et al 2016 notably malki et al 2014 and divett et al 2013 demonstrated the performance of a staggered array in the case where the streamwise spaces between the front and rear rows were small within a range of diameters of 2 3 turbines however the array layouts in those previous works are only applicable to cases where each row is a linear line type fence no substantial evidence has been presented to support their advantages over the myriad of other possible array layouts especially turbines in the rear rows inevitably suffer reduced productivity as the flow decelerates after passing through the front rows therefore it has come under scrutiny that the use of conventional two step arrangements for a tidal array would lead to a design that can fully extract all energy available from a site to overcome such limitations in previous works the present study tries to find optimal array layouts that could maximize the extraction of energy without imposing structural layouts such as centered or staggered forms by freely arranging the turbine positions a possible approach to finding an optimal tidal farm layout is to use an optimization algorithm gradient based algorithms update the positions of design parameters by using first or higher order derivatives of objective functions by contrast gradient free algorithms do not require computing functional derivatives instead design parameters are updated by exploiting the results of functional evaluations at numerous sample points in the parameter space since the mid 1990s studies on wind farm optimization have widely adopted gradient free algorithms mosetti et al 1994 and found that the genetic algorithm and particle swarm optimization yielded good results for wind farm layout optimization problems salcedo sanz et al 2011 wan et al 2010 brutto et al 2016 successfully implemented particle swarm optimization to optimize tidal farm layout in a discrete domain with an analytical approximation for the flow field with tcts however their approach does not fully reflect the hydrodynamical effects such as the duct effect vennell et al 2015b and so the estimated power production from the tidal farm could be underestimated if the farm site is located at a laterally bounded tidal channel a more accurate way to resolve the tidal flows with tcts is to solve the hydrodynamic model of tidal currents which are generally expressed by partial differential equations pdes in this case the pdes used as the governing equations of the tidal flow act as a constraint in the optimization giving rise to a class of problem known as pde constrained optimization hence every functional evaluation involves a state evaluation step which is computationally expensive to circumvent the burdensome computation expense on solving pdes gonzález gorbeña et al 2016 2018 used surrogate based optimization sbo by constructing a surrogate model which approximates the objective function from the sample data drawn from high fidelity hydrodynamic models and searching the optima using the gradient free approach gonzález gorbeña et al 2016 2018 successfully showed that sbo approach offers an effective way of avoiding burdensome state evaluations when the aim of optimization is the micro arrangement of a fixed form of layout however constructing a valid surrogate could be more expensive than directly solving pde constraint if no baseline layout for the tidal farm is prescribed and all turbines are let to be placed freely to form an optimal layout in this study we are not making presumptions on the shape of the optimal layout of a tidal farm and thus a gradient based algorithm is preferred over a gradient free algorithm to meet the objective of this study the gradient based algorithm also faces the problem of obtaining the functional derivative of pde constrained optimization because it is too computationally taxing funke et al 2014 proposed a novel technique to formulate the pde constrained gradient based optimization problem automatically for a tidal farm using the adjoint method for the fast and scale independent evaluation of a functional derivative notably funke et al 2014 demonstrated a maximum increase of 96 in power production could be achieved after optimizing a densely packed regular grid type array with 32 turbines increased power production has been predicted in previous studies on micro array arrangement divett et al 2013 but not as large as obtained by funke et al 2014 thereby underlining the importance of site specific arrangements gradient based optimization has another inherent drawback in that its solution is highly sensitive to the initial solution additionally solutions of this optimization method are likely to be stuck in the local minima of multimodal functions and in most cases the convergence of solutions to the global optima cannot be guaranteed noel 2012 funke et al 2014 recognized the limitation of gradient based optimization and hence focused on validating the robustness and efficiency of the developed framework a way to avoid this is to prescribe a proper initial layout il of which the knowledge is currently unavailable inspired by the fact that a flock of birds forms an array with specific shape during migration we speculated that the layout of an optimal tidal farm would exhibit a specific shape under ideal conditions if the speculation is true and the il is prescribed by the expected shape of the global optima it is more likely that the solution will not deviate from the true global optima by a significant margin and thus one may prevent the solutions from converging to unexpected or less productive local optima therefore the present study aims to unveil the uncovered features of the optimal configuration of a tct array mainly by answering the following three questions while finding the optimal solutions for a tct farm formulated with the gradient based method i what types of il can ensure faster convergence to the global optima ii does the configuration of the global optima have a specific characteristic shape iii what effect do the optimization constraints ocs such as the size of the available farm site and the minimum turbine spacing have on the optimal layout of a tidal farm and its power production to answer these questions a set of consecutive numerical experiments were performed with opentidalfarm an open source solver for specific pde constrained gradient based optimization problems funke et al 2014 especially those related to tidal farm design as the complexity of a problem increases it becomes difficult to prove that the obtained solution is a global optimum as an alternative we attempted to reconcile the cost and accuracy by using a sub optimal solution that can be regarded as a surrogate of the true global optimum this work refers to such solutions as quasi global optimum qgo a detailed conceptualization will be discussed in section 4 from this concept alone one cannot quantitatively evaluate the deviations from the exact global optima still we believe this concept can work as a prototype of the exact global optima and aid in engineering practices the paper is organized as follows in section 2 we briefly present the pde constrained gradient based optimization and its hydrodynamic model i e shallow water equations in section 3 a methodology for tct modeling and simulation settings for the numerical experiments are presented throughout sections 4 to 6 we develop a stepwise framework of a set of numerical experiments to find qgo finally we give some concluding remarks in section 7 2 problem formulation the optimal layout of a tidal farm can be obtained by solving an optimization problem with pde constraints the equations of the pde constrained optimization can be defined as 1 max z p j z p subject to f z p 0 g p 0 l b p l u where j z p is the objective function to be maximized z is the state variable p is the design parameter and f z p 0 is the state equation which consists of a system of pdes such a set of pdes physically constrains the given problems by invoking conservation laws in this study the set of pdes is comprised of two dimensional shallow water equations swe g p 0 is an inequality constraint that enforces a minimum distance between each turbine and l b and l u are the lower and upper bounds for a box constraint respectively there exists a unique z for every p if the pde constraint is well posed which is true for the swe funke et al 2014 in such a case z can be represented as a function of the design parameter p i e z z p by plugging this function into j the objective functional becomes j j z p p and the pde constrained optimization problem is reduced to a simpler form without the pde constraint the model based on this reduced form i e opentidalfarm shows good performance in the time marching problem long et al 2012 thus it is worth noting that although the present study addresses steady state problems it can be further extended to unsteady problems the aim of optimization is to maximize the power generation of a tidal farm with n turbines as the optimal positions of each turbine should be identified on a two dimensional plane the design parameter p in this study is defined as 2 p x 1 y 1 x 2 y 2 x n y n where x i y i is the location of i t h turbine and n is the total number of turbines the objective functional j is the total power produced by the turbines in an array it is worth noting that this power is not the real available electrical power rather it is a theoretical indicator representing the farm productivity while neglecting the energy loss during conversion to electricity the mechanical power produced by a turbine is defined as the product of flow velocity and turbine thrust with a quadratic relationship to the velocity magnitude hence the objective functional is 3 j u p ω ρ c t p u 3 d x where u u v is the vector of depth averaged x and y directional velocities ω is the domain of interest for a farm ρ is the fluid density c t p is the thrust coefficient for a tidal turbine and represents 2 norm in equation 3 evaluation of j inevitably involves that of u therefore to obtain precise two dimensional velocity fields of tidal flows a non conservative form of swe is used for the state equation the state variable z is defined as u h where h is the water depth and is uniquely determined for every p through an implicit function f in this study we assumed the flow to be stationary as a trade off between accuracy and computational cost of over a hundred simulations now the pde f z p 0 becomes 4 u u ν 2 u g h c b c t p h u u 0 h u 0 where ν is the viscosity g is the gravitational acceleration c b is the bottom friction coefficient and c t p is the thrust coefficient for a tidal turbine or the turbine friction coefficient which will be discussed in a later section both the bed friction and the thrust exerted by the turbine on the fluid body were implemented as one depth averaged sink term which is proportional to the square of velocity the diffusion term i e ν 2 u is artificially imposed large enough to ensure the existence of steady state solution by suppressing the occurrence of unsteady wakes behind each turbine it is worth noting that the resolved flow field might suffer some disparity to the true flow field because the oscillatory wake behind the turbine is smeared out by artificial viscous dissipation instead the resulting flow field is designed to reproduce the important mean flow features section 3 3 which is sufficiently reasonable for our macroscopic objective of investigating the shape of optimized arrangements of the tidal turbines to enforce constraints on p two types of inequality constraints are provided one limits the farm site to a rectangular area with the length l x and width l y of the site the tidal array is allowed to be deployed within that area the second constraint addresses the distances between each turbine this constraint is applied to prevent the turbines from overlapping each other it is worth noting that in the real practice of wind firm construction it is a rule of thumb to avoid the deleterious wake effects on the adjacent turbine structures patel 2005 minimum distance d min between the turbines is ensured by implementing inequality constraints as follows 5 p i p j 2 d min 2 for 1 i j n where p indicates the position vector of the turbine and the subscript of integers i and j represent the i t h and j t h turbines 3 experimental setup 3 1 simulation domain all the cases were simulated by setting a rectangular farm site located along the centerline of an ideal shallow channel see fig 1 in order to ensure that the fluid structure interactions were properly resolved in turbine simulation a hybrid mesh is utilized over the whole simulation domain composed of two different types of meshes for the region of interest that includes the farm site an alternated structured mesh consisting of uniform triangular elements with 2 m long edge was used for the outer region an unstructured mesh in which the elements were stretched from 2 m up to 20 m toward the boundaries was used the tidal channel was modeled as a simplified rectangle with an area of 900 m 600 m whereas the fine mesh zone sat at the channel s center with an area of 600 m 500 m the whole domain consists of approximately 160 000 nodes and 80 000 elements these mesh configurations were used consistently to preserve the resolution of the turbine wake instead of the case dependent number of meshes the mesh was generated using gmsh 2 0 geuzaine and remacle 2007 to reduce unwanted numerical reflections at the open boundaries of the upstream and downstream of the tidal farm the flather boundary condition was applied to the inlet and outlet which are denoted as boundary 1 and 2 in fig 1 a respectively the flather boundary condition is a type of radiation boundary condition commonly used in the field of ocean modeling pham et al 2016 pham and hwang 2020 constructed by coupling sommerfeld radiation equation with continuity equation the flather boundary condition allows propagation of a conservative quantity throughout the boundary by radiating deviations from the reference values and shows good performance for flows with small wave amplitude jung and hwang 2018 reference velocity at the inlet was set as u inlet u 0 0 and reference water level at the outlet was h values of u 0 and h are listed in table 2 the free slip condition was applied elsewhere boundary 3 in fig 1 opentidalfarm uses the finite element method to solve swe to discretize swe in the weak formulation piece wise quadratic functions for u and piece wise linear functions for η c b and c t are used as basis functions or shape functions the newton method was used to find the global matrix in an iterative manner for the optimization algorithm the sequential least square quadratic programming included in the scipy optimization package was selected for its record of good convergence for the constrained optimization problem virtanen et al 2020 3 2 tidal turbine modeling as mentioned before the energy extraction by a tidal turbine has been implemented as additional bed friction proportional to the momentum flux which is a simple model that exclusively accounts for the horizontal thrust being exerted on the fluid although there are many other advanced turbine models such as the linear momentum actuator disc theory garrett and cummins 2007 houlsby et al 2008 nishino and willden 2012 the present study prefers a simple turbine model to ensure smoothness of the functional j even though it is common practice to uniformly add the sink term to the turbine s representative area while adding zero value elsewhere this manner of parameterization can be problematic to the application of gradient based optimization because the friction function becomes non differentiable therefore friction due to the turbine was modeled as a smooth bell shaped bump function within the turbine s radius the two dimensional function is expressed as 6 φ p r x y exp 2 1 1 q x i 1 1 q y i for q i i r 1 0 otherwise where p i x i y i is the location of the i t h turbine s center and r is the turbine s radius summation of all distribution functions over the entire domain yields the total turbine friction function c t p 7 c t p i 1 n k i φ p r x y where k i is the scaling or tuning parameter for the thrust intensity of the i th turbine k i should be adjusted so that the scaled thrust can generate a realistic turbine effect the turbine model used in this study however cannot reproduce the exact influence on the flow field as real rotor turbines myers and bahaj 2010 due to the simplifications still it can reproduce the distance for wake recovery i e the downstream distance where the mean velocity of the wake flow recovers to the expected percentage of the upstream velocity and we believe that it is sufficient for the present problem this is because the length and velocity of the turbine s wake are the reliable features which can be resolved at the scale of shallow flows and these features are expected to be the crucial influence factors for our proposed optimization problem previous works on the wake recovery structure of an isolated tidal turbine summarized in table 1 indicate that velocity at the near wake zone x 3 d where x is the downstream distance from the turbine s center strongly depends on the turbine s specifications at x 5 d and x 10 d downstream the velocity magnitude lay within the range of 65 75 and 70 80 of the upstream velocity respectively at the centerline the velocity recovers 90 of its upstream velocity at x 20 d we can easily deduce that the wake profile is dependent on k but k would not be the sole factor determining the wake structure reduced flow velocity near the center of the wake is recovered by the momentum transfer from the fast bypass flow to the slow wake flow which can be determined by the value of ν and the rate of momentum diffusion as ν is mainly dependent on the flow properties a proper set of k and ν should be determined for the given simulation settings 3 3 simulation parameters the parameters and physical constants of the simulation are summarized in table 2 these parameters were determined to emulate a realistic tidal current flowing through a shallow tidal channel in typical natural tidal channels the froude numbers range from 0 1 to 0 2 roberts et al 2016 stallard et al 2013 for this study we set the froude number at the inlet as 0 1 with an initial water depth h of 50 m and an inlet velocity u 0 of 2 m s the diameter of a tidal turbine blade d was set to 20 m typically commercial tidal turbines are installed in the water at a depth that is 1 5 3 0 times larger than their diameters stallard et al 2013 the bottom friction coefficient was set to a constant value of 0 0025 funke et al 2014 to set the appropriate k and ν simultaneously wakes behind a single tidal turbine were simulated and analyzed under the diverse conditions a turbine was deployed at the center of the domain for each case with the eight different combinations of k and ν fig 2 a the case with k 10 and ν 2 m 2 s reproduced the desired wake properties which have been discussed in section 3 2 and this set of values was chosen for the subsequent experiments with multiple turbines with the given parameters an isolated turbine could generate a power of 2 75 mw on average the power coefficient c p is commonly used to represent the mechanical power and its magnitude is normalized by the kinetic energy of the upstream flows subject to the turbine area this study defined c p for a single rotor as c p 0 0 3361 among the many types of commercial turbines with similar specifications simec atlantis energy s seagen s exhibited 2 mw of power with flows traveling at 2 5 m s atlantis resources 2016 therefore the modeled turbine was able to mimic the performance of a real turbine and its impact on flows in a simplified tidal current modeling it should be noted that the value of k 10 depends on the positions of the turbine as the friction distribution function equation 6 is linearly interpolated over the grid domain thus the turbine areas to which the bottom friction is applied vary slightly with the turbine location the maximum deviation 0 45 of c p 0 is used to represent half of the uncertainty interval ui of c p which is discussed in subsequent sections and interpreted as a criterion for determining whether the c p s are same 4 impact of initial layout on the solutions in this section a concept of qgo which is a surrogate of the true global optimum that possesses important features that the global optimum is expected to have is introduced then the experimental framework to deduce the qgo is discussed followed by the demonstration on the experimental setup and the results of the baseline test set hereinafter referred to as test 1 to shed light on the desirable features of a qgo the methodology addressed in section 3 often yields a local optimum which comprises the positions of individual turbines that locally maximize j on one of the multiple concave hulls in general the global optimum could be found by solving the optimization problems with a set of initial solutions where its cardinality is sufficiently large enough to contain the global optimum after optimization as the number of turbines n increases however we face higher dimensional problems with many concave hulls making it much harder to obtain a global optimum hence the present study introduced the qgo concept to alleviate this difficulty qgo was designed with speculation that the optimal solution possesses some macroscopic features e g the shape of the array which may be more important than microscopic information e g the specific position of turbines based on this speculation we anticipated that there would be a macro scale concave hull which is wiggly at micro scale i e includes numerous small concave hulls the local extremum points and global maximum point on the macro scale concave hull are expected to share the macroscopic features hence instead of finding the exact global optimum the objective has been mitigated to find a sub optimum that the value of j does not differ significantly from the global optimum and possesses the desired macroscopic features we refer to qgo as the best solution i e the solution which gives the highest j among the solutions starting from some finite size of il sets as the cardinality of il increases to infinity qgo converges to the true global optimum and thus consistency is satisfied to efficiently deduce qgo from small il sets a step by step sequential set of experiments is introduced as the first test 1 we solve the optimization problem with a small set of different shapes of ils then we extract some notable features shown from the solutions with the best performance i e highest c p i n d after the observation the following test is designed with the modified ils and we check whether the macroscopic features are observed again from the solutions if the features observed in the previous test are observed in the solutions in the following tests consistently it will consolidate that the qgo will possess the observed attributes if some new features are observed another following test is designed otherwise if no more new significant observations are made we stop designing the next test and finally qgo is suggested by integrating the desirable features of the qgo it is worth noting that desirable features of qgo would satisfy the following i the optimal layout will expose a symmetric shape ii if the il is designed to have the desired macroscopic features then the solution will converge faster the estimated global optimum namely qgo from the presented method may not return the true global optimum due to inadequate selection of il sets to start with still it is expected to be leveraged as a good surrogate in engineering practice as the starter test 1 applied five different types of ils a randomly scattered layout constructed by using latin hypercube sampling lhs one row two rows with two different distances one far and the other close respectively and the v shape layout fig 3 first for the lhs il the simulation was repeated five times for each case of n to observe any tendency on using this layout for the second il one row all turbines were placed as a single straight row spanning across the width of the farm site this case was not simulated when n was too large to align as a single row n 8 the third and fourth ils were selected to investigate the effects of streamwise distances between the rows of the turbines the distances between the rows are 14 d which is the maximum distance available and 5 d respectively if n is even the two rows are center aligned otherwise they were deployed in the staggered type with one less turbine in the rear row it should be noted that each row is uniformly spanned across the farm site the fifth type is a v shaped layout pointing upstream and the angle between the two lines was set as a right angle i e slope of 1 see fig 3 a all tests were performed near a tidal farm site with a rectangular area of 300 m 230 m with placing its lower left point at streamwisely 225 m and laterally 70 m apart from the origin of the entire domain d min was fixed to 1 5 d i e 30 m for all cases among all 43 simulation cases the nine cases of optimized layouts that overlapped with their corresponding ils are presented in fig 4 the quantitative comparison for the power output and the computational cost are proposed as the averaged individual power coefficient c p i n d and the number of iterations n iter respectively fig 5 it is notable that in several cases the optimal layout was not symmetric and did not have regular intra spacing layouts instead they had a small anomaly from a form that can be classified as a certain group such irregularities arise due to the high dimensionality of the problem and imply that the obtained solutions are local optima consider a certain case or cases that yields yield the highest power production among a group of cases with the same n we refer to this these case s as the best optimum optima if its their identifiable attributes are commonly observed in the other optimal layouts which are also classified as having highest productivity those attributes are regarded as the tentative attributes of a qgo grouping the results by n the differences in c p i n d s of the optimized arrays were in most cases insignificant regardless of the il type i e the differences of c p i n d s were within the uis of c p i n d for instance in the case of c p the cases of lhs one row and two rows 14 d ils corresponding to fig 4 a fig 4 b and fig 4 c respectively had nearly identical values of c p i n d s analogously for all groups with the same n there were more than one optima classified as the best optima marked as in fig a1 notably for each n these best optima shared a similar shape with some difference in the micro arrangement see fig a1 this result further demonstrates the complexity of the optimization problem and suggests the existence of multiple local optima that can produce a power approximate to the optimal power a common feature of the best optima is the congregated fence shape to be specific the array converged to a single fence spanning the full width of the farm site which is a linear row when n 8 if the turbines are more deployed then the layout becomes a curved or a v shaped fence it should be noted that the layouts are convex in the downstream direction and we refer to this shape as the upstream concave uc whereas the opposite is called the downstream concave dc assuming that the cost of state evaluation is similar in all cases the iteration number to evaluate the functional n iter can be used as a metric for computational cost because solving the equation of state is the most cumbersome part of this problem we hardly found any distinguishable tendency in n iter when they were grouped by il or n fig 5 b except that the v shape and one row il groups needed fewer iterations than the other il groups to find a local optimum in particular one row il groups converged to the best optima implying that the shape of the qgo is a unit row when n is small enough to deploy all turbines in a row this result suggests that initializing an array as a randomly scattered one i e lhs il or two separate rows i e two rows 5 d and 14 d il is ineffective because their shape largely deviates from a unit fence which is the expected shape of qgo moreover as it is not always possible to implement a tidal array in a single row n 8 for test 1 the v shaped il could be an alternative because it converges to the expected shape of qgo with small n iter in most cases there are still some issues to be resolved in using the upstream pointing v shaped il which will be discussed in the subsequent experiments in the case of a single row il there were no significant changes in the layouts after the optimization as the c p i n d could be improved only by a maximum of 0 1 fig 5 a since the optima are symmetric one row can be regarded as a strong candidate for the shape of a qgo for the cases of il with two rows with a spacing of 5 d the optimization solutions commonly converged to arrays that were symmetric and regularly spaced and the best optima this contrasts with the cases having two rows ils with a spacing of 14 d which fall under a more irregularly shaped local optima compared to the case with a 5 d spacing fig a1 considering that the qgo has the shape of a congregated fence more iterations will be required to merge the two rows into a single row as the distances between the front and rear rows become larger also in most cases placing an array in two rows has a negative impact on its neighboring downstream turbines in terms of turbine performance by exhibiting a c p i n d less than c p 0 additionally the power after optimization increases maximally by 95 7 of c p i n d when n 9 and il is in two rows with a spacing of 14 d fig 5 a note that it is a staggered il this result indicates that the staggered layout a typical tidal farm design can be less productive than a randomly scattered layout lhs il unless the distances between the front and rear rows are properly tuned note that these results apply for cases of a moderately small number of turbines and does not cover the case when n is large so that the array must form multiple rows the v shaped il requires fewer iterations to converge to the best optimum when n 10 when compared with the other ils for instance n 8 fig 4 f after optimization the array changes its shape from upstream to downstream concave but when n 10 the change of layout after optimization was not significant while the shape of the converged array was the only case with an upstream concave type array fig 4 i of these the aforementioned case shows the worst performance i e 5 3 smaller c p i n d than the case of the highest c p i n d this indicates that uc v shaped il in test 1 has ensnared the solution in the local optima further supporting the necessity of an il that does not impede the solution from converging to the qgo the present test demonstrated the importance of layout optimization in terms of the tidal farm performance and its dependency on the il type furthermore both convergences to the qgo and the computational cost depend on the il type thus the appropriate il will help solutions converge to a qgo in a more cost effective manner when conducting gradient based optimization for the tidal farm optimization problem analyzing the shape of the best optima we could deduce that a promising attribute of a qgo is being a dc fence specifically for a small n the shapes of qgo appear as a unit linear fence while for larger n they bend toward downstream forming a single fence among the five types of il uc v shape il mostly converged to the best optimum with a moderately small n iter however its shape is different from the expected shape of the qgo deduced from test 1 i e dc fence hence an improved il could be proposed which is similar in the shape of the qgo and thus ensures good convergence to the qgo with fewer iterations this will be addressed in the following sections we will also explore the fact that the v shaped il posed in uc did not always yield a qgo in the following experiment by additionally considering the optimization constraints 5 impact of optimization constraints on the optimization results one of the remarks we made from the previous section test 1 is that the gradient based algorithm occasionally fails to update toward the qgo but yields a local optimum still we could deduce some expected features of the qgo by analyzing the best optima in addition in most cases the v shaped il rapidly and reasonably converged to a symmetric solution however under certain conditions the layouts end up with a uc local optimum whereas the global one is expected to be dc along with our original objective to find the qgo the current set of experiments hereinafter referred to as test 2 is designed to investigate this interesting behavior by focusing on the v shaped il and varying the values of ocs for this experiment two parameters were controlled to examine the impact of ocs while the n was fixed to 8 l y was varied from 270 to 370 m in intervals of 25 m and d min was varied from 1 5 to 3 0 d in intervals of 0 5 d to observe the effect of direction of the v shaped il on the solutions two types of v shaped il were applied as shown in fig 3 b and fig 3 c one il is the uc v shape ucil which is analogous to the one used in test 1 and the other il is dc v shape henceforth dcil the v shaped ils were designed to have an intra turbine spacing of d min with a slope of the wing of 3 4 positive for the upper side and negative for the lower side change in the slope magnitude was to ensure array emplacement under the case of extreme constraints for example see d in fig 6 and fig 7 to analyze the result a new non dimensional parameter e is introduced as follows 8 e n 1 d min d l y e represents the ratio of the total length of a linear fence composed of n turbines with an intra spacing of d min and a turbine diameter of d to the lateral width of the farm site ly when e 1 the layout cannot exhibit a linear configuration with the given constraints when e 1 the solution converged to a linear fence regardless of the convexity of il in contrast when c p 0 ucil converged to a uc array fig 6 and dcil converged to a dc array fig 7 fig 8 a quantitatively shows that the dc optima produced more power than the uc optima when e 1 by a maximum difference of 2 5 this corresponds to the case when e 1 63 fig 6 d for the uc optima and fig 7 d for the dc optima where the c p i n d of dc optima is 116 c p 0 fig 8 a therefore it is reasonable to deduce that the qgo possess a dc v shape under a large e and dcil is suggested to be implemented to ensure the qgo for the gradient based optimization as e increased the shape of the optimal array changed as it did in test 1 fig 8 b starting from a linear array at e 1 the curvature of the optimized array increased with the e until the optima transformed from a smooth parabola to a v shape as the optimal layouts were symmetric in shape and were in agreement with the observed features of the qgo they can be assumed as the qgo for the given ocs interestingly this shape transition of the optimal array corresponds to the linear decrease of c p i n d in terms of the e with a slope of 0 113 fig 8 a by contrast the performance of an array does not vary when the optima possess the linear fence form with e 1 the mean c p i n d 0 4280 and sd 0 6 of the mean c p i n d although the optima could not always be classified as qgo due to their irregularities this result indicates that once e is tuned to be less than unity it can maximize the performance of the array in terms of power 6 designing robust initial layout and analysis on its resulting qgo the previous tests demonstrated an obvious trend in the shape of the optimal layout which is a function of n d min and l y likewise ils need to be chosen with care to have an analogous layout with the qgo to ensure fast and solid convergence to the qgo therefore an adaptive il reflecting the change in the shape of the optimal layout under various conditions should be introduced meanwhile we also explored the array separation process and observed it until the maximum number of turbines in an array that can maintain a single fence form has been reached the analysis of array configuration and its power production under array separation or breakdown is expected to provide valuable insights for planning a cost effective tidal farm in this section the experimental set test 3 is designed to resolve the following two goals a to propose an il that can ensure convergence to the qgo under various conditions i e different combinations of ocs and b to find a condition in which the qgo does not maintain the unit fence form and analyze its notable features in total nine sets of optimization constraints were imposed by combining d mins of 1 5 d 2 0 d and 2 5 d and ly of 230 m 300 m and 370 m for each oc set several turbines were installed in the initial experiment and more turbines were continuously being added for the next experiments until the array separated into two distinct parts after the optimization i e a single turbine is detached from the main array while the starting n is designed to form a tightly placed linear fence i e e 1 in the lateral direction to eliminate the influence of the streamwise length of the farm site l x on results l x was doubled from the value used in the previous tests i e lx 600 m the results of test 2 showed that the uc v shaped layout may have a good convergence to the qgo with the large e yet the result may not always be symmetric nor have the regular turbine intra spacings with the small e this supports the fact that an il guaranteeing sound and fast convergence should be designed analogous to the expected optimal layout here we introduce the arc shaped il fig 3 d distances between the turbines were set by d min and r and the arc radius was determined to satisfy the condition where the chord of the arc is equal to l y for example a linear fence like il was produced by setting a large radius and the minimum value of the available radius was ly d 2 which yields a semicircular shape to increase the n from the aforementioned semicircular state turbines were added to the front thus producing a horseshoe shaped array like although the graphical results have not been presented here the arc il yielded a decent qgo which is regular and symmetric with a relatively moderate n iter compared with test 1 fig a2 in appendix a grouping the results by the set of ocs fig 9 c p i n d tends to reach a maximum value as e approaches unity and decrease as more turbines are added i e as e increases this result is analogous to that of test 2 and the decreasing rate of power is steeper when d min 1 5 d also grouped by l y c p i n d was maximum when d min 1 5 d the overall maximum c p i n d was observed when d min was 1 5 d and l y was 370 m however it is premature to conclude that denser deployments of tidal fences are more conducive to power production this is because the generated shallow water field does not resolve the negative lateral wake effect although the graphical results have not been included the same trend was found in the shape of the qgo with respect to e fig 8 b it is notable that the use of the new arc type il yielded a symmetric and regularly spaced optima that can be classified as a qgo when excess turbines are deployed to the domain the array starts to break apart and a few turbines become detached from the v shaped main body the detached turbines were then placed upstream by an appropriate distance where the wake of the separated turbine diffuses helping the turbine in the downstream avoid the negative impact of wake on the power production fig 10 we also observed that when the array separation occurs the angle between the two edges of the v shaped main body array is smaller when ly is small and d min is large furthermore significant drops in c p i n d were observed except for the case of d min 2 5 d and l y 300 m after a turbine had been detached from the v shaped main body in addition for the case represented in fig 10 b deploying 12 turbines with d min 2 5 d and l y 270 m c p i n d was less than c p 0 the ineffectiveness of optimization is not because the observed optima is not qgo we have found that v shaped array is a valid qgo for large e but the above results implies the ineffectiveness of adding excess turbines after the array separation in total 65 cases with the nine sets of optimization constraints ocs were simulated the results were grouped with the number of turbines n the values of the optimal power output vary by a maximum of 50 54 depending on the set of ocs in case of n 13 see fig 11 a also the case with d min 1 5 d and ly 370 m yielded the highest c p i n d among the group of n 13 which is around 1 5 cp 0 in other words if properly arranged 13 turbines can produce as much energy as 20 turbines additionally when e 2 c p i n d of the optimal array was less than c p 0 therefore providing a well designed set of ocs is important to ensure better performance of a tidal farm we also validate the results of test 2 in that c p i n d linearly decreases with e when e 1 see fig a2 7 conclusions this work addresses the various aspects of the optimal configuration of a tct farm along with tests to obtain a reliable qgo with the gradient based optimization various numerical experiments were conducted to find the underlying general trend of the optimal array layout and furthermore its dependency on ocs owing to the inherent features of the tidal farm optimization problem we preferred the gradient based algorithm over the gradient free algorithm the three main findings of this study are i the il is critical for the gradient based algorithm to overcome its inherent limitation of convergence to local optima and to ensure the convergence to qgo at a low computational cost thus we recommend using a well designed il as it has a configuration similar to the global optima this requires the information on the expected optimal array in advance and we recommend the dc arc shape as a practical il configuration for an idealized channel its shape should be determined by adjusting the arc radius such that all turbines could be placed with the designed l y while the length of the chord is equal to l y ii for an ideal tidal strait with a rectangular geometry constraint there exists a generalized trend in the global optima if possible the optimal layout is a linear fence that expands laterally over the full width of the farm if there are too many turbines to be deployed in a linear fence with the minimum distance constraint of d min then the optimal layout will develop into an arc shaped fence and subsequently into a v shape until a turbine is detached from the array and the array breaks into two parts all qgos commonly possess dc shape additionally placing turbines in the linear fence arrangement is the most productive choice for a fixed n c p i n d linearly decreases as e increases when e 1 iii the oc significantly affects the configuration of the optimal array and its power production the shape of an optimal array is subject to the ocs for an identical number of turbines in an array the generated power substantially varies with oc suggesting that the selection of oc is important to the design of a cost efficient tidal farm finally from these conclusions we recommend a method of designing an efficient tidal farm in idealised rectangular channels with uniform flow all turbines should be connected as a single fence located at the center of the tidal channel cross section if possible the linear fence form should be adopted for the highest possible power efficiency this further implies that overly conservative ocs insufficient l y or overestimated wake recovery lengths may yield a less effective design therefore we need to utilize engineering criteria for designing minimum spacing between the turbines considering the analysis of its wake regions future studies should develop a criterion for determining the minimum distance on the lateral impact of wakes on the neighboring turbines additionally practical applications of this work should consider the idealization we made for the simulation domain while the suggested qgo is only valid for the case of a unidirectional tidal current natural tidal straits may have bidirectional or unsteady flows with periodicity a non streamwise symmetric qgo will be less productive when the current flows in the reverse direction this may imply that a linear tidal fence is a universal qgo still the bidirectionality may not be a serious problem because a uc array has been found to be effective local optima with an acceptable performance decline when the value of e is moderate to include the time varying features of a tidal current it is desirable to perform optimization constraining with a transient swe future studies could also incorporate complex coastal sites as the simulation domain or non rectangular geometry for the farm site constraints to test the extensibility of the qgo layouts from this study to the case of irregular channels or unsteady bidirectional flow the sbo approach could be exploited by setting the qgo layouts as the baseline layouts for the metamodel construction validation of the derived optimal array can be made through experiments or comprehensive cfd simulations moreover we did not consider the possible environmental impacts while designing the tidal farm one may use the suggested array to extract more energy by changing the local flow fields but such an action may alter the sediment transport and further degrade its local marine ecosystem thus striking a balance between the economic gain and environmental loss should be considered in the practical design stage credit authorship contribution statement jisu han conceptualization methodology data curation investigation visualization writing original draft jaeyoung jung conceptualization visualization editing the manuscript jin hwan hwang supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper abbreviations and nomenclature il initial layout oc optimization constraint qgo quasi global optima uc upstreamwise concave dc downstreamwise concave ucil upstreamwise concave v shape initial layout dcil downstreamwise concave v shape initial layout pde partial differential equation lhs latin hypercube sampling cfd computational fluid dynamics j objective functional mechanical power produced by the tidal farm z u h state variable solution of the state equation u depth averaged x and y directional velocities h water depth h initial water depth p design parameter a list of 2 d positions of the turbines ν kinematic viscosity g gravitational acceleration ρ density of water d turbine diameter n number of deployed turbines d min minimum intra turbine distance constraint lx streamwise width of the farm site l y lateral width of the farm site cb bottom friction function c t p turbine friction function k scaling parameter for the turbine thrust intensity ϕ p r x y 2 d bump function for an individual turbine u0 streamwise inlet velocity cp power coefficient of turbine c p 0 nominal power coefficient of a single turbine c p i n d averaged power coefficient of a turbine a from tidal array e ratio of the shortest hypothetical linear fence that could be constructed satisfying d min to l y appendix fig a 1 test 1 extended version of graphical representation of test 1 shaded rectangular area is the available farm site red dots indicate the turbines associated with the il and blue dots indicate the ones after optimization in total 23 cases are presented rows are grouped into n from 6 to 10 top to bottom and columns into il type lhs one row two rows with a spacing of 5 d two rows with a spacing of 14 d v shape from left to right representative cases with lhs il are the ones that yield the highest power output among the five lhs simulation realizations for each n asterisk under the label denotes the best optimum in the row fig a 1 fig a 2 test 3 grouping by n from 10 to 13 top to bottom c p i n d c p i n d linearly decreases with the increase in e as observed in test 2 cases with other ns are neglected as the data points are not large enough for the regression fig a 2 
21168,the operability of walk to work operation through gangway regarding floating wind turbine and service operation vessel is studied an attempt has been made to investigate the limiting wave height in particular by the numerical modeling of multi body configuration in the time domain special attention has been paid to the impact of second order drift motion which is traditionally not taken into account in operability analysis meanwhile the fluctuation of rao and shielding effect due to the hydrodynamic interaction are discussed in depth the failure mode that interrupts the operation asymmetry of the polar diagram and the effect of drift motion are emphasized and discussed in detail the operational failure in the short wave peak period is caused by the horizontal displacement or velocity depending on whether the drift motion is considered for a longer period the vertical motion is the dominant the failure mode walk to work operation is checked against the obtained limiting wave height using two actual onsite wave conditions with drift motion the curves of allowable wave height show the declining trend as peak period increases however they present a growing trend if drift motion was considered keywords floating wind turbine service operation vessel walk to work wave drift force multi body hydrodynamics gangway 1 introduction wind turbine requires routine maintenance several times every year just like the motor vehicle compared to the onshore installation offshore wind turbine indeed inherits the existing technology however it makes the maintenance work complex to implement according to stehly and beiter 2019 the cost estimate on the operation and maintaining service reaches over 30 of the total cost over the life cycle of an offshore wind turbine therefore the specialized service operation vessel sov received much attention recently because the offshore operation requests more strict criteria on many aspects such as the accessibility to the wind turbine together with the dedicated sov vessel for the offshore wind turbine the walk to work w2w approach was proposed a few years ago which aims at improving the efficiency of offshore maintenance and guaranteeing the safety of personnel transferring between the wind turbine and sov w2w requests sov to equip dynamic positioning dp system and offshore gangway which supports motion compensation for most cases fig 1 shows an example of sov servicing a wind turbine even so the operation of the gangway is still highly dependent on the weather condition especially when the sov is deployed alongside a floating foundation since the operating limit of w2w is determined by the dynamic motion of gangway one of the key challengings that we can anticipate is the complex motion behavior due to the multi body hydrodynamic interaction which was previously investigated by the author s study regarding gangway utilized for oil and gas industry huang et al 2018 li 2020 however the requirement on the operability is even higher for offshore wind because the limited number of sovs have to service the entire wind farm where it may have hundreds of turbines therefore the prediction of operability is the critical issue that affects significantly the safety efficiency and economics of operation by sov shuttling between wind turbines in light of the experience from the marine and offshore industry a methodology of operability study could be concluded as illustrated in fig 2 certainly similar methodologies are also been discussed by tezdogan et al 2014 gao et al 2016 and sandvik et al 2018 although the engineering topics are different as shown in fig 2 the preliminary study is mainly preformed for screening the critical sea state governing design condition and long term statistics etc typically the frequency domain approach is used at this stage to most actual engineering projects the analysis is done at this step except for complex issues that have to be further investigated by the advanced numerical method which is usually established in the time domain for w2w operation as mentioned earlier the operational limit depends on the gangway s dynamic motion on both horizontal and vertical planes which is consequently determined by the respective motion of the wind turbine and sov vessel if the wind turbine is a floating moored structure the low frequency slow drift motion on the horizontal plane should be significant which was proved by the existing model tests robertson et al 2017 goupee et al 2014 for nearshore or coastal area where most wind farm projects locate the short period wave is dominant which unfortunately may magnify the drift effect because short wave induces large drift force these wave conditions may be less important compared to storm weather in terms of turbine design based on extreme condition however they are capable to impact the w2w operation besides the multi body interaction might affect drift force as well which further increases the uncertainty to take account the drift motion into the operability analysis the time domain computation is the most straightforward way which facilitates the nonlinear properties like damping the phase difference in low frequency motion and the post processing such as estimation of extreme etc wu 2014 and guanche et al 2016 studied w2w gangway operability analysis for fixed and floating wind turbine respectively the numerical simulation was carried out for limiting wave height valuable results have been obtained however their modeling was established based on the frequency domain approach that considers wave frequency response only guanche et al 2016 also stressed in the conclusion that the nonlinear drift motion needs to be taken into account in future research motivated by the above mentioned engineering challenges an operability study of w2w for oc4 deepcwind floating wind turbine and service operational vessel is studied in this paper the limiting wave height is analyzed in particular by the multi body numerical model in the time domain the impact of nonlinear drift motion is emphasized in this study the hydrodynamic interaction between oc4 and sov like the amplification shielding effect and drift forces are also investigated in depth the failure modes that cause the operational interruption asymmetry behavior of the polar diagram are studied and discussed in detail the operation check is also demonstrated by using two sets of onsite operational wave conditions and obtained allowable wave heights with and without drift force in sect 2 of this paper the theoretical background of hydrodynamics in the frequency domain dynamics of floating structure in the time domain as well as the mooring line modeling etc are briefly introduced the engineering configuration and layout about w2w operation are described in sect 3 in sect 4 1 the numerical modeling is validated by existing experimental results through offset test free decay test and white noise test etc raos of global motions and relative motion regarding gangway are discussed in sect 4 2 the limiting wave height with and without drift motion is investigated in sects 4 3 and 4 4 the operational check with actual wave conditions is conducted and interpreted in sect 4 5 in this study the multi body hydrodynamics in the frequency domain was computed by the in house code hydra the time domain simulation and operability processing were performed by the in house software kraken 2 theoretical background in this section the theoretical foundations and numerical modeling that are used in this study are introduced and only the most necessary formula are given and explained in general two different coordinate systems are defined to describe the kinematics of floating structure floater including the earth fixed global system o x y z and local inertial system o x y z attached to each moving floater the floater is considered as a rigid body of 6 dofs degree of freedom fig 3 illustrates both the coordinate systems and the directional convention of environmental load etc in the 2d o x y plane both coordinate systems follow right hand rule the horizontal o x y and o x y planes coincide with the undisturbed free surface and the vertical o z and o z axes are orienting positively upward 2 1 multi body hydrodynamics the computation of hydrodynamic loads on a multi body system is considered it is assumed that the fluid is inviscid and incompressible and the flow is irrotational so that a velocity potential φ exists deep water is assumed and the normal vector is defined positively pointing inwards the fluid domain in the steady state the velocity potential at a flow field point p is written as 1 φ p t re φ p e i ω t based on the linear superposition principle the spatial potential φ is decomposed into 2 φ m 1 m j 1 6 i ω η j m φ j m a 0 φ 0 m 1 m φ 7 m where a 0 is the amplitude of incident waves φ 7 m denotes the scattering potential η j m means the amplitude of the motion in j mode of body m and φ j m is the corresponding radiation potential besides φ 0 is the potential of incident waves per unit amplitude given by 3 φ 0 g ω e k 0 z i x cos β y sin β where β and k 0 denote the heading angle and wavenumber of incident waves respectively the linearized boundary value problem for the potential φ j m with j 1 2 7 is expressed as chen 2004 lee and newman 2005 4a 2 φ j m 0 in the fluid domain 4b φ j m n n j m on h m 4c k 0 φ j m φ j m z 0 at z 0 4d lim r r φ j m r i k 0 φ j m 0 in the far field where n j m denotes the generalized vector defined as 5 n j m n j on h m 0 otherwise with n j n j for j 1 2 3 r n for j 4 5 6 n φ 0 for j 7 where h m is the hull surface of the body m the boundary value problem 4 is solved by means of the boundary element method in which the free surface green function is adopted as the fundamental solution and the boundary integral equation is written as 6 2 π φ j p m h m φ j q n q g p q g p q n q φ j q d s where p x y z and q ξ η ζ denote the flow field and source points respectively and g is the free surface green function written as wehausen and laitone 1960 7 g 1 r 1 d g f with r d x ξ 2 y η 2 z ζ 2 where g f is the free surface term in the form of a single integral by solving the boundary integral equation 6 the radiation and diffraction potentials can be determined and then the added mass a k j n m wave radiation damping b k j n m and the wave exciting force f k m are obtained 8 i ω a k j n m b k j n m i ω ρ h n φ j m n k d s and f k n i ω ρ a 0 h n φ 0 φ 7 n n k d s the coupling terms of wave radiation damping b k j n m when n m represent the coupling effect due to motion of the other structure a coupling strategy in the time domain computation is to ignore these terms and benefits the computational time more details about coupling strategy are explained in sect 4 for the computation of the added mass at infinite frequency the green function satisfying the free surface condition at infinite frequency is adopted and it is expressed as 9 g 1 r 1 d the second order wave mean drift force is based on the direct pressure integration which is so called near field which is expressed as 10 f k n 2 ρ h n 1 2 φ 2 η t η r r φ t n n d s ρ g 2 γ e η 3 η 4 y η 5 x 2 n n d l where η t and η r stand for the translation η 1 η 2 η 3 and rotation η 4 η 5 η 6 r is x x 0 y y 0 z z 0 for the position vector with respect to the reference point x 0 y 0 z 0 of rotation γ denotes the intersection of floater at mean position with the mean water surface the first item of eq 10 is the area integral over hull and second term is the line integral that reflects the integration of the first order pressure on the intermittent zone around the waterline the mean drift moment does not appear in eq 10 because of which are insignificant in terms of global motions and therefore not taken into account in the time domain analysis hereafter it should note that the mean drift force must be given by near field formulation in eq 10 based on the first order potentials and body motions because the momentum conservation method far field formulation only gives the total force instead of that for each vessel the above mentioned method provides wave force and hydrodynamic coefficients for the time domain computation the in house software hydra li 2020 liang et al 2018 wu et al 2018 is employed which is dedicated for 3d diffraction and radiation calculation in frequency domain in this study the hydrodynamic behavior of oc4 and sov is coupled with each other in diffraction and radiation computation as shown in eq 1 with boundary conditions eq 4 and eq 5 the coupling effect is also reflected in the 2nd order drift force which is emphasized in the work 2 2 time domain dynamics of floating structures the time domain approach is employed for the computation of vessel motion of multi body configuration the time domain motion computation relies on the motion equations based on newton s 2nd law the frequency dependent wave radiation damping and added mass are needed which are therefore treated further by using cummins s equation cummins 1962 11 m m a x t 0 t k t τ x τ d τ b lin x t b qua x t x t c x t f t where m is the mass matrix of dimension 6 n 6 n with n denoting the number of bodies here c denotes linear stiffness matrix such as the hydrostatic restoring matrix b lin and b qua represent frequency independent linear and quadratic damping matrix f is the external force vector which consists of the environmental force connection force such as mooring or other force acting on the structure k is the retardation function defined as 12 k t 2 π 0 b ω cos ω t d ω where b and ω are radiation damping and angular frequency meanwhile the added mass m a at the infinite frequency can alternatively be estimated by 13 m a m a ω 1 ω 0 k t sin ω t d t where ω is an arbitrary frequency in reality it is impractical and unnecessary to carry out the computation from zero to infinite frequency in the diffraction and radiation computation therefore the artificial decay is conducted on b for a certain range of frequencies beyond both upper and lower cutoff points before calculating eq 12 τ also needs to be cut off at a reasonable duration where no more fluctuation exists in k regarding m a the mean value can be taken by repeating eq 13 at different ω for reliable precision alternatively the added mass at infinity frequency is also able to be provided by radiation calculation the motion equation in 11 with respect to floater s cog center of gravity is solved in the local coordinate system at each time step by 4th order runge kutta scheme then the location of cog and other points to be studied such as fairlead is converted to the global coordinate system the environmental load of floater is updated at each time step based on the filtered low frequency position when considering the irregular waves the elevation is described by a series of linear harmonic waves as follows 14 η t x β wave re i 1 n a i e i ω i t k i x ε i with x cos β wave x sin β wave y where x y and β wave are locations in north and west as well as wave incoming direction in the global system ε i and k i denote random phase and wavenumber respectively and the wavenumber satisfies the dispersion equation for deep water ω 2 g k a i is the wave amplitude determined by 15 a i 2 s η η ω i δ ω where s η η is the wave spectrum the linear wave exciting force is then expressed as 16 f wave 1 t r i 1 n a i 1 a i e i ϕ i e i ω i t k i x ε i where a i 1 ϕ i are the amplitude of the linear wave force and corresponding phase determined by the hydrodynamic analysis the amplitude and phase could be updated at each time step by interpolation due to the change of floater s heading the second order drift and slow drift force is computed by employing newman s approximation newman 1974 and can be expressed as follows 17 f w a v e 2 t i 1 n q t f ω i ω i a i cos ω i t k i χ ε i i 1 n a i cos ω i t k i χ ε i i 1 n q t f ω i ω i a i sin ω i t k i χ ε i i 1 n a i sin ω i t k i χ ε i where q t f denotes the quadratic transfer function which is given by eq 10 in eq 17 only the mean drift force elements on the main diagonal of the q t f matrix is required after solving eq 11 based on obtained motions at cog three translation displacements at any fixed point on the vessel in the local coordinate system can be expressed as follows according to rigid body kinematics 18 x p y p z p a 1 a 2 a 3 0 z p y p z p 0 x p y p x p 0 a 4 a 5 a 6 where a i i 1 6 denote surge sway heave roll pitch and yaw motions respectively besides x p y p z p is the location of arbitrary point 2 3 mooring line modeling traditionally the mechanism of mooring line load and profile could be derived by considering a small element of line in a 2d plane e g x z horizontal and vertical plane the bending and torsion are neglected which is a reasonable and acceptable assumption to the industry in terms of the mooring line material of chain and wire rope because the radius of curvature is large globally the dynamic effect of the line inertia is not considered in the model the equilibrium equations of tangential and normal direction are expressed as follows based on force balance 19 t t d t cos d θ w sin θ d l f 1 t e a d l 0 20 t d t sin d θ w cos θ d l d 1 t e a d l 0 where t f d denote effective tension the external force on tangent and normal directions w d l and θ are wet weight per unit length element length the angle between elements and horizontal plane considering d l is infinitesimal the above equations are further derived as follows 21 d t w sin θ d l f 1 t e a d l 0 22 t d θ w cos θ d l d 1 t e a d l 0 the coordinate system of x z has the following geometrical relationship with θ and l 23 d x 1 t e a cos θ d l 24 d z 1 t e a sin θ d l the catenary method considering elastic line is employed in this study the external forces f and d are ignored therefore eqs 21 and 22 could be further simplified before they are brought into eqs 23 and 24 after deriving the integration the governing equations of the elastic line are expressed as follows 25 x t h w sinh 1 t v t h sinh 1 t v 0 t h t h t v t v 0 w e a z t h w 1 t v t h 2 1 t v 0 t h 2 t v 2 t v 0 2 2 w e a l t v t v 0 w t h 2 2 w e a t v t h 1 t v t h sinh 1 t v t h t v 0 t h 1 t v 0 t h sinh 1 t v 0 t h t v w l 0 t v 0 where t h t v l and l 0 are the horizontal tension vertical tension stretched and unstretched line length respectively t v 0 is the vertical tension at the starting point of this segment in case the mooring line is comprised of multiple materials by numerical iteration the convergence of variables in governing equations in eq 25 could be reached the line load and profile are obtained the mooring line model is coupled with the dynamics of the floating structure introduced in sect 2 2 through the fairlead the tension at fairlead is further transferred to cog of floating structure to form a 6 dof force vector in the local system the time domain computations were performed by in house software kraken li 2020 which is developed for dynamic analysis of floating systems and specialized in offshore operation study 3 engineering background of floating wind turbine and service operation vessel the engineering specifications of oc4 wind turbine and service operation vessel are given in this section the engineering basis of walk to work operation and the physical configuration in this study are briefly introduced 3 1 engineering specifications of oc4 and sov in general the physical configuration of oc4 and sov in operation condition of this study is illustrated in fig 4 the main dimensions inertial properties and mooring system etc of the oc4 wind turbine are summarized in table 1 the mean draught of oc4 is 20 m from keel to swl steel water level the total mass in table 1 is inclusive of floating foundation hull and ballast etc tower and rna rotor nacelle assembly of the turbine etc the mooring system of oc4 is comprised of three identical lines which connect between offset columns and seabed at 200 m from swl downward the mooring lines are 120 apart from each other the representative value of line mechanical properties shown in table 1 is employed in the mooring modeling such as equivalent extensional stiffness e a and wet weight defined in sect 2 3 the service operation vessel is of typical monohull lines plan of an offshore support vessel the length width and draught are 66 m 15 m and 5 3 m respectively table 2 summarized the mass dimension properties and natural periods the dynamic positioning system is deployed on the vessel for station keeping purposes 3 2 multi body configuration of walk to work operation as discussed previously the operation of walk to work relies on the access equipment which is the offshore gangway considering the feature of geometry the landing point on oc4 can be arranged on the top of one offset column which is shown in fig 4 the representative coordinate of landing point with respect to the center of gravity of oc4 is 14 43 m 28 5 m and 20 07 m in the local o x y z system on the sov side a motion compensated gangway with operation length 22 m is equipped and located at the vessel portside the departure point of the gangway is located at the top of the pedestal which is 2 m 4 m and 12 15 m from the center of gravity in the local o x y z system nowadays it is often seen that the gangway is deployed near the middle ship unlike the gangway at the ship stern the installation around the middle ship could minimize the impact due to the pitch on the vertical motion of the pedestal however the gangway at the middle ship has to rule out the possibility for longitudinal w2w operation only the transverse access is workable shown in fig 4 according to fig 4 the azimuth of both structures are identical and heading towards the north in this study of course the relative azimuth could be adjusted during actual operation in case it is needed 4 results and discussion in this section the numerical model of the oc4 wind turbine is validated first with the existing experimental results such as the mooring line tension natural period and motion raos etc the raos representing the wave frequency motions are obtained by white noise simulation the 6 dofs global response of oc4 and sov as well as the relative motions regarding gangway are discussed combining with the operating limit the limiting wave height considering wave frequency motion only as well as wave frequency plus drift motion are computed and investigated in detail the obtained limiting wave height is demonstrated for walk to work operation checks regarding two actual onsite wave conditions except for the hydrodynamic parameters that are calculated in the frequency domain all other simulations are conducted in the time domain since the operability analysis focuses only on waves and induced dynamics there are no aerodynamic or current forces therefore taken into account in this study i e the wind turbine is supposed to be in idling operation mode in the operation of wind turbine access the duration needed usually lasts long the dynamic positioning strategy auto area positioning mode is considered to save energy and fuel consumption this mode is intended for stand by operations where the vessel must remain within a specified geographical area however it also allows the vessel to shift or rotate within a certain limit from the center of the controlled area therefore a simplified method is adopted to consider the effect of dynamic positioning for sov vessel by employing a spring damper system a linear roll damping 6 is applied to sov vessel according to industry experience while the nonlinear quadratic damping is used for oc4 4 1 validation of numerical modeling the validation of the mooring line tension of oc4 wind turbine is conducted by carrying out a series of static offset tests the numerical model of oc4 and the mooring system are shown in fig 5 the simulation in this section is compared to the model test results presented by koo et al 2014 the model tests were performed at marin maritime research institute netherlands with a model of oc4 corresponding to a 1 50 froude scaling in the experiment the systematical tests including static offset free decay white noise test as well as the combined test of wind and wave were carried out the calculated and experimental axial tension of the mooring line at the fairlead position with a couple of offset locations is plotted in fig 6 the offset test pushes oc4 towards the negative x axis so the mooring line connecting the upper column as shown in fig 4 goes tauter and the other two lines become slack generally the comparison with measurement shows good agreement however the calculated tension at the offset 20 m is slightly larger the damping plays an important role in the resonant response and it particularly affects the motion of moored structure in the low frequency region because where the wave induced damping is almost negligible oc4 is multiple cylindrical structures which induce notable viscous damping which is proportional to the square of velocity a set of quadratic damping coefficient suggested by robertson et al 2014 is summarized in table 3 which is obtained by calibrating the free decay curve against the nonlinear damping model these coefficients are then included in the simulation directly as a diagonal quadratic damping matrix a free decay test in calm water is conducted by imposing an initial offset or angle to demonstrate the comparison with the measurement the decay curve of surge motion is presented in fig 7 an excellent agreement is achieved which provides a decent foundation for further dynamic analysis and especially the nonlinear slow drift motion meanwhile the decay test determines the natural periods of the respective degree of freedom table 4 summarizes both the calculated and experimental natural periods once again results show the discrepancy between simulation and measurement is small thus the modeling of oc4 dynamics is accepted and satisfied to further verify the numerical model under waves the simulated motion rao could be compared to the experimental result to be consistent with the implementation in the model test raos are obtained from the white noise simulation in the time domain the significant wave height h s is 10 5 m the wave heading is 0 and the signal covers from 6 to 26 s once the time domain simulation is done the rao curve can be acquired by calculating the cross spectral density function divided by the auto spectral density function between structure response and wave elevation compared to rao from the frequency domain white noise simulation can take into account the non linearity such as mooring tension quadratic damping that is discussed earlier without linearization fig 8 presents a comparison between simulation and existing measurement for the surge heave and pitch rao the simulated surge is seen to reach an excellent agreement with the experimental result regarding heave the simulated rao almost damps the resonance of natural frequency around 0 35 rad s to a similar level of measurement which once again proves reliable quadratic damping discussed earlier near 0 4 rad s the simulated rao curve drops towards zero which shows the characteristics of cancellation frequency theoretically the cancellation frequency occurs mainly because the heave wave exciting forces froudekrylov and diffraction force on the upper and lower surface of the offset base column reach the close magnitude but inverse directions however it is not the case in reality because the resultant force in heave won t be necessarily zero because of the existence of viscosity the introduction of an additional morison model may eliminate it according to the author s previous research li et al 2013 nevertheless which is not included in this paper because the quadratic damping is directly given and applied the simulated pitch rao reaches an acceptable agreement with measurement in general however the simulation over predicts around 0 5 rad s somehow we found the discrepancy on the pitch also exists notably between simulation and experiment from the study of robertson et al 2017 4 2 results of response amplitude operator in this section the seakeeping behavior of oc4 and sov are studied by analyzing rao curves the impact of multi body hydrodynamic interaction is evaluated by comparing results under different wave headings the white noise simulation in the time domain is conducted a lower level 4 0 m h s is considered raos are then obtained by calculating the cross spectral density function divided by the auto spectral density function between structure response and wave elevation raos are given in 45 interval of a wave heading as the focus here is the wave frequency motion the rao is therefore presented according to the wave period which better links to other results like limiting wave height in sect 4 3 and thereafter fig 9 shows rao of 6 dof motion for the oc4 wind turbine as the physical configuration of oc4 is defined symmetrically with respect to the x axis as shown fig 4 the motion characteristics should be also symmetric in terms of a wave propagated from starboard 0 to 180 and portside 0 180 in fact it is not the case in this study due to the sov vessel in proximity by comparing surge raos between 45 and 45 as well as 135 and 135 the obvious discrepancy could be seen which concentrate in the short period range around 6 s raos gradually converge without an obvious difference as an increase of wave period meanwhile the peaks around 6 s are observed to shift to the shorter period for raos of 45 and 135 since sov is located at the starboard of oc4 the above findings demonstrate clearly the impact due to the interaction of multi body hydrodynamics however the influence is limited within the short period region as for sway raos of waves from the portside such as 135 are seen to be greater fluctuation compared to corresponding raos from starboard generally the wave from starboard induces a smaller sway response which could be explained by the shielding effect because oc4 is protected by sov vessel on her starboard side the similar phenomenon was also observed and discussed in depth by zhao et al 2019 about heave the motion in the wave frequency range is relatively in small magnitude compared to the typical vessel because the natural period is far away the influence of hydrodynamic interaction is seen to be limited similarly roll and pitch motions are also much smaller than the traditional vessel as for roll peaks of raos due to portside waves present an apparent shift towards the shorter period compared to corresponding raos from starboard and the value of the peak slightly increases yaw motion shows also the asymmetrical behavior as rao of 90 is observed to be amplified compared to that of 90 in particular fig 10 shows rao of 6 dof motion for sov vessel as for surge rao the curves develop smoothly and do not show apparent indication about the hydrodynamic resonance however sway raos demonstrate strong fluctuation for waves from both portside and starboard certainly the level of fluctuation due to starboard waves is obviously higher than the portside such as the comparison between 135 and 135 this is not surprising because starboard is the weather side to sov vessel the motion of heave roll and pitch is significantly larger than that of oc4 as mentioned earlier regarding heave and pitch the rao of starboard wave is notably larger than the corresponding one on the portside besides a few additional peaks can be seen for heave under oblique seas 45 and 135 a similar trend also happens to the yaw motion however roll motion seems not to be sensitive to the multi body interaction rao curves display smooth varying as the period increases the differences of raos between waves of portside and starboard are limited compared to other dofs the operation of walk to work depends on the motion behavior of the gangway which is consequently determined by relative motions of oc4 and sov the relative motions are computed by subtracting the movement of the landing point on oc4 from the pedestal location of sov which is calculated by rigid body motion equation eq 18 fig 11 plots the rao of relative motions in the o x y z system by observing the trend of δ x sov s pitch fig 10 e seems to be the governing factor here it is understandable because both surge motion of oc4 and sov are mild however according to eq 18 the significant sov pitch that multiplies relatively high z location of pedestal contributes the majority of δ x the curves of δ y present two peaks one locates around 7 s and the other one appears at 11 s the first peak is due to sov s sway fig 10 b the second one should be credited with the resonance of sov s roll fig 10 d as for δ z sov s heave fig 10 c dominates the general trend and the roll motion also influences a bit especially under beam sea after 15 s curve of δ z is seen to develop upward further due to oc4 s heave motion fig 9 c 4 3 the limiting wave height with wave frequency motion only the operational limiting criteria of walk to work is summarized in table 5 according to wu et al 2018 guanche et al 2016 except for the roll angle the most limiting criteria are regarding relative motion and velocity between the gangway departure point at top of the pedestal and landing point on top of oc4 offset column the discussion of limiting wave height in this section does not consider the effect of nonlinear drift motion therefore only the first order wave force is taken into account to simulate the irregular waves the jonswap wave spectrum is employed 3 3 which describes the fully developed sea is used as the peak enhancement factor for all sea state the results are given from 180 to 135 with the 45 interval which covers the occasions of following quartering beam bow and head seas on both starboard and portside the range of peak period t p discussed in this study is from 4 5 to 10 5 s which is discretized by step of 1 5 s the period range is adequate to cover most scenarios because the offshore operation is conducted only under relatively mild weather conditions the limiting wave height is obtained by repeatedly running a 3 h time domain simulation with consecutively increased significant wave height until one of the limiting criteria in table 5 is exceeded the increment is 0 25 m per step of significant wave height for this study after each simulation the extreme values of all operational limit listed in table 5 are calculated at the mpm level most probable maximum before checking with the respective criterion in this study the mpm extreme values are obtained by fitting the weibull distribution and peaks also troughs from time series the tail fitting strategy is used for higher accuracy which fits 7 sets of tailed peaks i e 60 65 70 90 the final weibull parameters were obtained by averaging parameters of these 7 sets the result of limiting wave height is summarized in table 6 besides the values presented in the table investigating the failure mode which criterion is exceeded is beneficial for better understanding the motion which interrupts the walk to work operation therefore table 6 is colored according to different failure modes and the meaning of color is described in the caption of the table title the polar diagram of limiting wave height is shown in fig 12 firstly table 6 shows the failure under beam sea 90 and 90 are due to the velocity of δ y for all different t p for the period between 4 5 and 7 5 s the velocity of δ x dominates rest headings except beam seas for the period above 7 5 s failures are all caused by δ z motion except beam seas secondly we found the wave heights of 4 5 s t p is much higher than other periods which can be explained that the δ x rao is quite small for the short period wu 2014 reported a similar result however the wave height in his research was even higher because the wind turbine was fixed in that case however we must remind that some obtained wave heights in a short period such as that of t p 4 5 s with the corresponding wavelength of 32 m in table 6 may not occur in reality because the waves break when the wave height is over 1 7 of the wavelength which is about 4 6 m according to the wave breaking criterion this is the estimation based on the individual wave assumption if consider the real wave and spectrum a more practical method was proposed by buckley 1988 the relationship of limiting h s l i m and t p is defined as h s l i m t p 2 0 00776 g by using this formula the actual maximum significant wave height of t p 4 5 s and 6 0 s is limited to 1 54 m and 2 74 m which seems to allow unconditional operation according to the result in table 6 thirdly by observing the polar diagram the shape appears longer along the axis 180 to 0 while shorter along the axis 90 to 90 in addition the shape above axis 90 to 90 also appears bigger size than that below until t p increases to 9 0 s and above which illustrate the asymmetrical behavior the asymmetry is seen between the starboard and portside as well the limiting wave heights of portside waves are slightly higher than that of starboard it reminds the discussion in fig 11 a earlier that raos of starboard waves in the short period in particular is larger than that of portside due to the interaction of multi body hydrodynamics in general results show the failure mode concentrates on horizontal δ x and δ y and the velocity is the governing factor rather than the displacement the vertical motion is the main concern in the case of the long wave period 4 4 the limiting wave height considering the drift motion in this section the drift and slow drift motions are added in the analysis of limiting wave height table 7 summarized the result the colors representing failure modes are explained in the caption of table title fig 13 displays the polar diagram apparently the size of the polar diagram is significantly reduced compared to fig 12 the limiting wave height obtained is around 2 3 m however which is about 3 5 m in table 6 for the case without drift motion although the horizontal δ x and δ y still dominate the failure modes except for the long wave period the failure modes actually change to the displacement from the velocity it indicates the horizontal motion must largely increase due to the drift force however the velocity contribution by increased slow drift motion is nearly negligible compare to the component of wave frequency motion because the natural period of oc4 is over 100 s as shown in fig 4 the displacement therefore can exceed the limit at lower wave height than the velocity in this case meanwhile we notice the wave height of t p 4 5 s is the lowest over all t p which reminds in the earlier study without drift motion the wave height is dramatically as high as over 10 m nevertheless as t p increase further to 10 5 s the vertical motion takes back control it therefore implies the drift effect is weakened to further understand the phenomenon more pieces of evidence are needed and presented firstly for instance the surge and sway drift forces of oc4 under quartering sea are shown in fig 14 the drift forces are the outcome of diffraction and radiation computation in frequency domain as discussed in sect 2 1 in general the drift force is seen to gradually decrease as an increase of wave period moreover the strong fluctuations occur in the range of short periods for both waves from starboard and portside although the intensity of the portside wave 135 is obviously higher once again the shielding effect mentioned earlier regarding wave frequency result is also applicable to the second order forces secondly for instance the time history of the δ x and surge motion of both oc4 and sov for t p 4 5 s at its limiting wave height 1 75 m is drawn together in fig 15 time series shows the surge of oc4 experiences the significant long period oscillation the slow drift motion governs the total response because sov s surge is much smaller than that of oc4 the δ x is seen to be nearly dominated by oc4 s motion considering the h s is only 1 75 m which however causes δ x over 3 m of amplitude the drift motions contribute the most dynamic response the percentage of low frequency and wave frequency motions in δ x are evaluated by response spectra shown in fig 16 the curves in the figure represent δ x spectra at the limiting wave height from t p 4 5 9 0 s under wave from 180 the standard deviation σ of both low frequency and wave frequency are further quantified low frequency range 0 0 3 rad s wave frequency range 0 3 2 0 rad s in table 8 it s clearly seen that the low frequency motion absolutely control the δ x for the short period like 4 5 s the ratio of σ is almost 10 1 as t p increases the wave frequency motion gradually increases too and is accompanied by reduction of low frequency motion the ratio of σ therefore changes to nearly 1 1 when t p goes up to 9 0 s this is the reason the limiting wave height in table 6 without considering drift motion could be close to the result in table 7 only when t p is long we are also interested in how operating limit changes with h s in one combination of t p and wave heading therefore mpm extremes estimated from the time domain simulation for the surge and sway motions are plotted against the stepped increase of h s in fig 17 the intermediate results of t p 9 0 s from quartering sea 135 are exhibited here for an example in this case mpm extremes of sov are apparently larger than that of oc4 over all h s by observing these curves although they actually present just weakly nonlinear manner the mpm extreme curve of sov especially the sway shows clearer nonlinear behavior than that of oc4 this is because the waterline shape of mono hull sov attracts a larger drift force compared to oc4 of the small water plane cylindrical structure the different waterline patterns affect the waterline integral which is an important part of drift force and sensitive to drift force in short period range fig 18 presents the surge and sway drift force for sov vessel which is shown for comparison purposes against fig 14 same with fig 14 the drift forces of sov vessel in fig 18 are also the results of diffraction and radiation computation in frequency domain the mpm extreme curve of all operating limit is plotted against h s in fig 19 we can observe that the slope of δ x or δ y velocity shows a flatter trend than δ x or δ y displacement besides the velocity of δ x or δ y still has a certain space to reach the respective threshold defined in table 5 however δ x displacement is approaching to 3 2 m limit besides the nonlinear behavior of δ x or δ y seems to be further weakened compared to the trend of surge and sway in fig 17 by mixing the contribution of rotation like pitch which is a linear response it is also worth noting that the wave second order drift force is presented by qtf and predicted in the frequency domain as discussed in sect 2 1 therefore the drift force has to be transferred from the frequency domain to the time domain by eq 10 in order to implement the simulation compared to the direct time domain simulation of fully nonlinear potential flow or cfd computational fluid dynamics the qtf method shows less capable in case of the strong nonlinear or transient occasion nevertheless most implementation of fully nonlinear potential flow and cfd is based on the numerical wave tank which brings additional problems to be handled carefully such as the setup of the damping layer moreover the computational grid and the interface between body and fluid have to be updated timely due to the movement of the body therefore there are still concerns about the effectiveness and stability of the calculation on one hand for the offshore floating structure or ship the drift motion induced by drift force is a kind of typical weakly nonlinear effects on the other hand the operability study like this case requires computations for a large number of sea state the frequency domain qtf method is therefore considered as the most applicable formulation by far 4 5 the application of limiting wave height in offshore operation the previously obtained limiting wave height is employed for helping make the decision in actual design and analysis of offshore operation usually the comparison between onsite operational sea state and limiting wave height is conducted which is straightforward but efficient in this section two sets of operational sea state dedicated for wind turbine project i e gulf of mexico gom and gulf of maine me abs 2013 are used to demonstrate which are summarized in table 9 fig 20 show the results by using limiting wave height with and without drift motion the limiting wave height is presented by a curve of t p and h s for each wave heading the b spline interpolation is used for smooth purposes apparently curves of limiting wave height with and without drift motion illustrate different patterns without drift motion the curves present the declining trend as t p increases while they show a growing trend by taking into account the drift of course two different results converge when t p increases to a certain level like 10 s in this case because drift motion does not govern the operating limit anymore to the steep onsite operational sea state regarding t p and h s like me shown in figures the impact of drift motion seems not an issue because the wave height in the short period is adequately low however to the less steep site like gom the operation becomes not allowable from t p 6 s it is about 9 s without drift motion for some particular wave headings by considering the drift motion if beam seas were not counted here generally speaking the involvement of the drift motion lets the check of limiting wave height more strict than that considering wave frequency motion only it is fine to ignore the drift motion in the preliminary stage which is indeed quick execution and the analysis in the frequency domain is enough most of the time however it is highly recommended to refine the numerical model by considering the nonlinear factors like drift motion in the final stage analysis lastly both figures in fig 20 shows clearly that the walk to work operation under the beam sea must be avoided or carefully conducted 5 conclusions the operability of walk to work operation between floating wind turbine and service operation vessel sov is studied using a time domain approach by in house software kraken the hydrodynamics of the wind turbine and vessel in a multi body configuration are solved by frequency domain in house code hydra the established numerical modeling for oc4 and its mooring system is validated by the existing model test result the raos from white noise tests representing wave frequency motions are discussed in depth and the effect of hydrodynamic interaction e g shielding is especially focused on the discussion combining various operating limits regarding gangway work ability in particular the limiting wave height that considering with and without nonlinear drift motion is calculated by time domain simulations the failure mode asymmetry of the polar diagram impact due to the drift motion etc are emphasized and discussed in detail the obtained limiting wave height is demonstrated for walk to work operation checks regarding two actual onsite wave conditions the conclusions are drawn as follows raos show the obvious fluctuating for oc4 wind turbine in short periods the global motions present asymmetrical behavior with respect to the axis of symmetry the surge motions in a short period appear peak shit for waves coming from sov side and so does the roll motion the sway shows a larger response for waves from the weather side compared to the sov side which clearly demonstrates the multi body interaction and shielding effect oc4 s heave roll and pitch in a vertical plane present smaller responses in general compared to a traditional vessel on sov side surge motion seems not so much affected by oc4 while sway illustrates strong fluctuation and waves from the weather side induce obviously higher motion than that from oc4 side motions of heave and pitch are notably amplified by waves from the weather side however the roll is seen not sensitive to multi body interaction raos of relative motions between gangway departure and landing points show the x axis component δ x is governed by sov s pitch because gangway s departure location is relatively high in the vertical plane δ y presents double peaks due to sov s roll and sway δ z is dominated by sov s heave from the point of view regarding linear wave frequency motion relative motions are mostly controlled by sov not oc4 the limiting wave heights that considering wave frequency motion concentrate about 3 5 m at very short t p like 4 5 s in this case the limiting wave height could be up to 10 m for some wave heading which is significantly larger than other periods under beam seas the failure mode is completely dominated by the velocity of δ y one of the operating limits over all t p when t p is below 7 5 s the velocity of δ x is the major failure mode however the δ z displacement takes control for the failure from 9 s onward the polar diagram demonstrates that the limiting wave heights on osv s weather side are smaller than that on osv s lee side oc4 is on the weather side in this situation which shows the asymmetrical characteristic meanwhile the asymmetrical phenomenon is also observed between bow and following waves in general the horizontal velocity is the main reason cause the operation failure however as t p grows the vertical motion takes over control by taking into account the nonlinear drift motions the general limiting wave height reduces to 2 3 m for short t p the governing failure modes change to δ x or δ y displacement because the slow drift motions play an important role especially in short period range besides the newly added slow drift motion does not contribute a notable increase to velocity therefore the limiting wave height at 4 5 s declines significantly to 1 2 m which becomes the lowest limiting wave height over all t p that considered in this study certainly vertical δ z is still the dominant failure mode for long t p the wave drift force of the frequency domain indeed shows the fluctuation and amplification in the short period range due to hydrodynamic interaction the shielding effect is also applicable to the second order drift force the response spectra analysis further demonstrate that the oc4 s horizontal motion like surge is mainly governed by low frequency motion the ratio of standard deviation between low and wave frequency motion is as high as 10 1 in short t p and the domination gradually lost as t p grows up by investigating the relation of the mpm operating limit and h s we found the extremes of surge and sway of oc4 and sov actually present a weakly nonlinear manner with h s the nonlinear behavior of δ x and δ y is further weakened by the linear motion component like pitch during operation check regarding two actual onsite wave conditions curves of limiting wave height with and without drift motion present different patterns without drift motion the curves show the declining trend as t p increases while they show a growing trend if the drift motion was considered to the case that the relation of t p and h s is steep the impact of drift motion seems not a critical issue because the wave height in a short period is adequately low nevertheless for the less steep site the operation may be interrupted in the short t p no matter with or without drift motion the result both demonstrate clearly that the walk to work operation under beam sea must be avoided or carefully conducted finally regarding w2w operation analysis it is highly recommended to employ a refined time domain numerical model by considering the nonlinear drift motion in the final check credit authorship contribution statement binbin li conceptualization methodology computation writing original draft plotting revising and responding to reviewer declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
21168,the operability of walk to work operation through gangway regarding floating wind turbine and service operation vessel is studied an attempt has been made to investigate the limiting wave height in particular by the numerical modeling of multi body configuration in the time domain special attention has been paid to the impact of second order drift motion which is traditionally not taken into account in operability analysis meanwhile the fluctuation of rao and shielding effect due to the hydrodynamic interaction are discussed in depth the failure mode that interrupts the operation asymmetry of the polar diagram and the effect of drift motion are emphasized and discussed in detail the operational failure in the short wave peak period is caused by the horizontal displacement or velocity depending on whether the drift motion is considered for a longer period the vertical motion is the dominant the failure mode walk to work operation is checked against the obtained limiting wave height using two actual onsite wave conditions with drift motion the curves of allowable wave height show the declining trend as peak period increases however they present a growing trend if drift motion was considered keywords floating wind turbine service operation vessel walk to work wave drift force multi body hydrodynamics gangway 1 introduction wind turbine requires routine maintenance several times every year just like the motor vehicle compared to the onshore installation offshore wind turbine indeed inherits the existing technology however it makes the maintenance work complex to implement according to stehly and beiter 2019 the cost estimate on the operation and maintaining service reaches over 30 of the total cost over the life cycle of an offshore wind turbine therefore the specialized service operation vessel sov received much attention recently because the offshore operation requests more strict criteria on many aspects such as the accessibility to the wind turbine together with the dedicated sov vessel for the offshore wind turbine the walk to work w2w approach was proposed a few years ago which aims at improving the efficiency of offshore maintenance and guaranteeing the safety of personnel transferring between the wind turbine and sov w2w requests sov to equip dynamic positioning dp system and offshore gangway which supports motion compensation for most cases fig 1 shows an example of sov servicing a wind turbine even so the operation of the gangway is still highly dependent on the weather condition especially when the sov is deployed alongside a floating foundation since the operating limit of w2w is determined by the dynamic motion of gangway one of the key challengings that we can anticipate is the complex motion behavior due to the multi body hydrodynamic interaction which was previously investigated by the author s study regarding gangway utilized for oil and gas industry huang et al 2018 li 2020 however the requirement on the operability is even higher for offshore wind because the limited number of sovs have to service the entire wind farm where it may have hundreds of turbines therefore the prediction of operability is the critical issue that affects significantly the safety efficiency and economics of operation by sov shuttling between wind turbines in light of the experience from the marine and offshore industry a methodology of operability study could be concluded as illustrated in fig 2 certainly similar methodologies are also been discussed by tezdogan et al 2014 gao et al 2016 and sandvik et al 2018 although the engineering topics are different as shown in fig 2 the preliminary study is mainly preformed for screening the critical sea state governing design condition and long term statistics etc typically the frequency domain approach is used at this stage to most actual engineering projects the analysis is done at this step except for complex issues that have to be further investigated by the advanced numerical method which is usually established in the time domain for w2w operation as mentioned earlier the operational limit depends on the gangway s dynamic motion on both horizontal and vertical planes which is consequently determined by the respective motion of the wind turbine and sov vessel if the wind turbine is a floating moored structure the low frequency slow drift motion on the horizontal plane should be significant which was proved by the existing model tests robertson et al 2017 goupee et al 2014 for nearshore or coastal area where most wind farm projects locate the short period wave is dominant which unfortunately may magnify the drift effect because short wave induces large drift force these wave conditions may be less important compared to storm weather in terms of turbine design based on extreme condition however they are capable to impact the w2w operation besides the multi body interaction might affect drift force as well which further increases the uncertainty to take account the drift motion into the operability analysis the time domain computation is the most straightforward way which facilitates the nonlinear properties like damping the phase difference in low frequency motion and the post processing such as estimation of extreme etc wu 2014 and guanche et al 2016 studied w2w gangway operability analysis for fixed and floating wind turbine respectively the numerical simulation was carried out for limiting wave height valuable results have been obtained however their modeling was established based on the frequency domain approach that considers wave frequency response only guanche et al 2016 also stressed in the conclusion that the nonlinear drift motion needs to be taken into account in future research motivated by the above mentioned engineering challenges an operability study of w2w for oc4 deepcwind floating wind turbine and service operational vessel is studied in this paper the limiting wave height is analyzed in particular by the multi body numerical model in the time domain the impact of nonlinear drift motion is emphasized in this study the hydrodynamic interaction between oc4 and sov like the amplification shielding effect and drift forces are also investigated in depth the failure modes that cause the operational interruption asymmetry behavior of the polar diagram are studied and discussed in detail the operation check is also demonstrated by using two sets of onsite operational wave conditions and obtained allowable wave heights with and without drift force in sect 2 of this paper the theoretical background of hydrodynamics in the frequency domain dynamics of floating structure in the time domain as well as the mooring line modeling etc are briefly introduced the engineering configuration and layout about w2w operation are described in sect 3 in sect 4 1 the numerical modeling is validated by existing experimental results through offset test free decay test and white noise test etc raos of global motions and relative motion regarding gangway are discussed in sect 4 2 the limiting wave height with and without drift motion is investigated in sects 4 3 and 4 4 the operational check with actual wave conditions is conducted and interpreted in sect 4 5 in this study the multi body hydrodynamics in the frequency domain was computed by the in house code hydra the time domain simulation and operability processing were performed by the in house software kraken 2 theoretical background in this section the theoretical foundations and numerical modeling that are used in this study are introduced and only the most necessary formula are given and explained in general two different coordinate systems are defined to describe the kinematics of floating structure floater including the earth fixed global system o x y z and local inertial system o x y z attached to each moving floater the floater is considered as a rigid body of 6 dofs degree of freedom fig 3 illustrates both the coordinate systems and the directional convention of environmental load etc in the 2d o x y plane both coordinate systems follow right hand rule the horizontal o x y and o x y planes coincide with the undisturbed free surface and the vertical o z and o z axes are orienting positively upward 2 1 multi body hydrodynamics the computation of hydrodynamic loads on a multi body system is considered it is assumed that the fluid is inviscid and incompressible and the flow is irrotational so that a velocity potential φ exists deep water is assumed and the normal vector is defined positively pointing inwards the fluid domain in the steady state the velocity potential at a flow field point p is written as 1 φ p t re φ p e i ω t based on the linear superposition principle the spatial potential φ is decomposed into 2 φ m 1 m j 1 6 i ω η j m φ j m a 0 φ 0 m 1 m φ 7 m where a 0 is the amplitude of incident waves φ 7 m denotes the scattering potential η j m means the amplitude of the motion in j mode of body m and φ j m is the corresponding radiation potential besides φ 0 is the potential of incident waves per unit amplitude given by 3 φ 0 g ω e k 0 z i x cos β y sin β where β and k 0 denote the heading angle and wavenumber of incident waves respectively the linearized boundary value problem for the potential φ j m with j 1 2 7 is expressed as chen 2004 lee and newman 2005 4a 2 φ j m 0 in the fluid domain 4b φ j m n n j m on h m 4c k 0 φ j m φ j m z 0 at z 0 4d lim r r φ j m r i k 0 φ j m 0 in the far field where n j m denotes the generalized vector defined as 5 n j m n j on h m 0 otherwise with n j n j for j 1 2 3 r n for j 4 5 6 n φ 0 for j 7 where h m is the hull surface of the body m the boundary value problem 4 is solved by means of the boundary element method in which the free surface green function is adopted as the fundamental solution and the boundary integral equation is written as 6 2 π φ j p m h m φ j q n q g p q g p q n q φ j q d s where p x y z and q ξ η ζ denote the flow field and source points respectively and g is the free surface green function written as wehausen and laitone 1960 7 g 1 r 1 d g f with r d x ξ 2 y η 2 z ζ 2 where g f is the free surface term in the form of a single integral by solving the boundary integral equation 6 the radiation and diffraction potentials can be determined and then the added mass a k j n m wave radiation damping b k j n m and the wave exciting force f k m are obtained 8 i ω a k j n m b k j n m i ω ρ h n φ j m n k d s and f k n i ω ρ a 0 h n φ 0 φ 7 n n k d s the coupling terms of wave radiation damping b k j n m when n m represent the coupling effect due to motion of the other structure a coupling strategy in the time domain computation is to ignore these terms and benefits the computational time more details about coupling strategy are explained in sect 4 for the computation of the added mass at infinite frequency the green function satisfying the free surface condition at infinite frequency is adopted and it is expressed as 9 g 1 r 1 d the second order wave mean drift force is based on the direct pressure integration which is so called near field which is expressed as 10 f k n 2 ρ h n 1 2 φ 2 η t η r r φ t n n d s ρ g 2 γ e η 3 η 4 y η 5 x 2 n n d l where η t and η r stand for the translation η 1 η 2 η 3 and rotation η 4 η 5 η 6 r is x x 0 y y 0 z z 0 for the position vector with respect to the reference point x 0 y 0 z 0 of rotation γ denotes the intersection of floater at mean position with the mean water surface the first item of eq 10 is the area integral over hull and second term is the line integral that reflects the integration of the first order pressure on the intermittent zone around the waterline the mean drift moment does not appear in eq 10 because of which are insignificant in terms of global motions and therefore not taken into account in the time domain analysis hereafter it should note that the mean drift force must be given by near field formulation in eq 10 based on the first order potentials and body motions because the momentum conservation method far field formulation only gives the total force instead of that for each vessel the above mentioned method provides wave force and hydrodynamic coefficients for the time domain computation the in house software hydra li 2020 liang et al 2018 wu et al 2018 is employed which is dedicated for 3d diffraction and radiation calculation in frequency domain in this study the hydrodynamic behavior of oc4 and sov is coupled with each other in diffraction and radiation computation as shown in eq 1 with boundary conditions eq 4 and eq 5 the coupling effect is also reflected in the 2nd order drift force which is emphasized in the work 2 2 time domain dynamics of floating structures the time domain approach is employed for the computation of vessel motion of multi body configuration the time domain motion computation relies on the motion equations based on newton s 2nd law the frequency dependent wave radiation damping and added mass are needed which are therefore treated further by using cummins s equation cummins 1962 11 m m a x t 0 t k t τ x τ d τ b lin x t b qua x t x t c x t f t where m is the mass matrix of dimension 6 n 6 n with n denoting the number of bodies here c denotes linear stiffness matrix such as the hydrostatic restoring matrix b lin and b qua represent frequency independent linear and quadratic damping matrix f is the external force vector which consists of the environmental force connection force such as mooring or other force acting on the structure k is the retardation function defined as 12 k t 2 π 0 b ω cos ω t d ω where b and ω are radiation damping and angular frequency meanwhile the added mass m a at the infinite frequency can alternatively be estimated by 13 m a m a ω 1 ω 0 k t sin ω t d t where ω is an arbitrary frequency in reality it is impractical and unnecessary to carry out the computation from zero to infinite frequency in the diffraction and radiation computation therefore the artificial decay is conducted on b for a certain range of frequencies beyond both upper and lower cutoff points before calculating eq 12 τ also needs to be cut off at a reasonable duration where no more fluctuation exists in k regarding m a the mean value can be taken by repeating eq 13 at different ω for reliable precision alternatively the added mass at infinity frequency is also able to be provided by radiation calculation the motion equation in 11 with respect to floater s cog center of gravity is solved in the local coordinate system at each time step by 4th order runge kutta scheme then the location of cog and other points to be studied such as fairlead is converted to the global coordinate system the environmental load of floater is updated at each time step based on the filtered low frequency position when considering the irregular waves the elevation is described by a series of linear harmonic waves as follows 14 η t x β wave re i 1 n a i e i ω i t k i x ε i with x cos β wave x sin β wave y where x y and β wave are locations in north and west as well as wave incoming direction in the global system ε i and k i denote random phase and wavenumber respectively and the wavenumber satisfies the dispersion equation for deep water ω 2 g k a i is the wave amplitude determined by 15 a i 2 s η η ω i δ ω where s η η is the wave spectrum the linear wave exciting force is then expressed as 16 f wave 1 t r i 1 n a i 1 a i e i ϕ i e i ω i t k i x ε i where a i 1 ϕ i are the amplitude of the linear wave force and corresponding phase determined by the hydrodynamic analysis the amplitude and phase could be updated at each time step by interpolation due to the change of floater s heading the second order drift and slow drift force is computed by employing newman s approximation newman 1974 and can be expressed as follows 17 f w a v e 2 t i 1 n q t f ω i ω i a i cos ω i t k i χ ε i i 1 n a i cos ω i t k i χ ε i i 1 n q t f ω i ω i a i sin ω i t k i χ ε i i 1 n a i sin ω i t k i χ ε i where q t f denotes the quadratic transfer function which is given by eq 10 in eq 17 only the mean drift force elements on the main diagonal of the q t f matrix is required after solving eq 11 based on obtained motions at cog three translation displacements at any fixed point on the vessel in the local coordinate system can be expressed as follows according to rigid body kinematics 18 x p y p z p a 1 a 2 a 3 0 z p y p z p 0 x p y p x p 0 a 4 a 5 a 6 where a i i 1 6 denote surge sway heave roll pitch and yaw motions respectively besides x p y p z p is the location of arbitrary point 2 3 mooring line modeling traditionally the mechanism of mooring line load and profile could be derived by considering a small element of line in a 2d plane e g x z horizontal and vertical plane the bending and torsion are neglected which is a reasonable and acceptable assumption to the industry in terms of the mooring line material of chain and wire rope because the radius of curvature is large globally the dynamic effect of the line inertia is not considered in the model the equilibrium equations of tangential and normal direction are expressed as follows based on force balance 19 t t d t cos d θ w sin θ d l f 1 t e a d l 0 20 t d t sin d θ w cos θ d l d 1 t e a d l 0 where t f d denote effective tension the external force on tangent and normal directions w d l and θ are wet weight per unit length element length the angle between elements and horizontal plane considering d l is infinitesimal the above equations are further derived as follows 21 d t w sin θ d l f 1 t e a d l 0 22 t d θ w cos θ d l d 1 t e a d l 0 the coordinate system of x z has the following geometrical relationship with θ and l 23 d x 1 t e a cos θ d l 24 d z 1 t e a sin θ d l the catenary method considering elastic line is employed in this study the external forces f and d are ignored therefore eqs 21 and 22 could be further simplified before they are brought into eqs 23 and 24 after deriving the integration the governing equations of the elastic line are expressed as follows 25 x t h w sinh 1 t v t h sinh 1 t v 0 t h t h t v t v 0 w e a z t h w 1 t v t h 2 1 t v 0 t h 2 t v 2 t v 0 2 2 w e a l t v t v 0 w t h 2 2 w e a t v t h 1 t v t h sinh 1 t v t h t v 0 t h 1 t v 0 t h sinh 1 t v 0 t h t v w l 0 t v 0 where t h t v l and l 0 are the horizontal tension vertical tension stretched and unstretched line length respectively t v 0 is the vertical tension at the starting point of this segment in case the mooring line is comprised of multiple materials by numerical iteration the convergence of variables in governing equations in eq 25 could be reached the line load and profile are obtained the mooring line model is coupled with the dynamics of the floating structure introduced in sect 2 2 through the fairlead the tension at fairlead is further transferred to cog of floating structure to form a 6 dof force vector in the local system the time domain computations were performed by in house software kraken li 2020 which is developed for dynamic analysis of floating systems and specialized in offshore operation study 3 engineering background of floating wind turbine and service operation vessel the engineering specifications of oc4 wind turbine and service operation vessel are given in this section the engineering basis of walk to work operation and the physical configuration in this study are briefly introduced 3 1 engineering specifications of oc4 and sov in general the physical configuration of oc4 and sov in operation condition of this study is illustrated in fig 4 the main dimensions inertial properties and mooring system etc of the oc4 wind turbine are summarized in table 1 the mean draught of oc4 is 20 m from keel to swl steel water level the total mass in table 1 is inclusive of floating foundation hull and ballast etc tower and rna rotor nacelle assembly of the turbine etc the mooring system of oc4 is comprised of three identical lines which connect between offset columns and seabed at 200 m from swl downward the mooring lines are 120 apart from each other the representative value of line mechanical properties shown in table 1 is employed in the mooring modeling such as equivalent extensional stiffness e a and wet weight defined in sect 2 3 the service operation vessel is of typical monohull lines plan of an offshore support vessel the length width and draught are 66 m 15 m and 5 3 m respectively table 2 summarized the mass dimension properties and natural periods the dynamic positioning system is deployed on the vessel for station keeping purposes 3 2 multi body configuration of walk to work operation as discussed previously the operation of walk to work relies on the access equipment which is the offshore gangway considering the feature of geometry the landing point on oc4 can be arranged on the top of one offset column which is shown in fig 4 the representative coordinate of landing point with respect to the center of gravity of oc4 is 14 43 m 28 5 m and 20 07 m in the local o x y z system on the sov side a motion compensated gangway with operation length 22 m is equipped and located at the vessel portside the departure point of the gangway is located at the top of the pedestal which is 2 m 4 m and 12 15 m from the center of gravity in the local o x y z system nowadays it is often seen that the gangway is deployed near the middle ship unlike the gangway at the ship stern the installation around the middle ship could minimize the impact due to the pitch on the vertical motion of the pedestal however the gangway at the middle ship has to rule out the possibility for longitudinal w2w operation only the transverse access is workable shown in fig 4 according to fig 4 the azimuth of both structures are identical and heading towards the north in this study of course the relative azimuth could be adjusted during actual operation in case it is needed 4 results and discussion in this section the numerical model of the oc4 wind turbine is validated first with the existing experimental results such as the mooring line tension natural period and motion raos etc the raos representing the wave frequency motions are obtained by white noise simulation the 6 dofs global response of oc4 and sov as well as the relative motions regarding gangway are discussed combining with the operating limit the limiting wave height considering wave frequency motion only as well as wave frequency plus drift motion are computed and investigated in detail the obtained limiting wave height is demonstrated for walk to work operation checks regarding two actual onsite wave conditions except for the hydrodynamic parameters that are calculated in the frequency domain all other simulations are conducted in the time domain since the operability analysis focuses only on waves and induced dynamics there are no aerodynamic or current forces therefore taken into account in this study i e the wind turbine is supposed to be in idling operation mode in the operation of wind turbine access the duration needed usually lasts long the dynamic positioning strategy auto area positioning mode is considered to save energy and fuel consumption this mode is intended for stand by operations where the vessel must remain within a specified geographical area however it also allows the vessel to shift or rotate within a certain limit from the center of the controlled area therefore a simplified method is adopted to consider the effect of dynamic positioning for sov vessel by employing a spring damper system a linear roll damping 6 is applied to sov vessel according to industry experience while the nonlinear quadratic damping is used for oc4 4 1 validation of numerical modeling the validation of the mooring line tension of oc4 wind turbine is conducted by carrying out a series of static offset tests the numerical model of oc4 and the mooring system are shown in fig 5 the simulation in this section is compared to the model test results presented by koo et al 2014 the model tests were performed at marin maritime research institute netherlands with a model of oc4 corresponding to a 1 50 froude scaling in the experiment the systematical tests including static offset free decay white noise test as well as the combined test of wind and wave were carried out the calculated and experimental axial tension of the mooring line at the fairlead position with a couple of offset locations is plotted in fig 6 the offset test pushes oc4 towards the negative x axis so the mooring line connecting the upper column as shown in fig 4 goes tauter and the other two lines become slack generally the comparison with measurement shows good agreement however the calculated tension at the offset 20 m is slightly larger the damping plays an important role in the resonant response and it particularly affects the motion of moored structure in the low frequency region because where the wave induced damping is almost negligible oc4 is multiple cylindrical structures which induce notable viscous damping which is proportional to the square of velocity a set of quadratic damping coefficient suggested by robertson et al 2014 is summarized in table 3 which is obtained by calibrating the free decay curve against the nonlinear damping model these coefficients are then included in the simulation directly as a diagonal quadratic damping matrix a free decay test in calm water is conducted by imposing an initial offset or angle to demonstrate the comparison with the measurement the decay curve of surge motion is presented in fig 7 an excellent agreement is achieved which provides a decent foundation for further dynamic analysis and especially the nonlinear slow drift motion meanwhile the decay test determines the natural periods of the respective degree of freedom table 4 summarizes both the calculated and experimental natural periods once again results show the discrepancy between simulation and measurement is small thus the modeling of oc4 dynamics is accepted and satisfied to further verify the numerical model under waves the simulated motion rao could be compared to the experimental result to be consistent with the implementation in the model test raos are obtained from the white noise simulation in the time domain the significant wave height h s is 10 5 m the wave heading is 0 and the signal covers from 6 to 26 s once the time domain simulation is done the rao curve can be acquired by calculating the cross spectral density function divided by the auto spectral density function between structure response and wave elevation compared to rao from the frequency domain white noise simulation can take into account the non linearity such as mooring tension quadratic damping that is discussed earlier without linearization fig 8 presents a comparison between simulation and existing measurement for the surge heave and pitch rao the simulated surge is seen to reach an excellent agreement with the experimental result regarding heave the simulated rao almost damps the resonance of natural frequency around 0 35 rad s to a similar level of measurement which once again proves reliable quadratic damping discussed earlier near 0 4 rad s the simulated rao curve drops towards zero which shows the characteristics of cancellation frequency theoretically the cancellation frequency occurs mainly because the heave wave exciting forces froudekrylov and diffraction force on the upper and lower surface of the offset base column reach the close magnitude but inverse directions however it is not the case in reality because the resultant force in heave won t be necessarily zero because of the existence of viscosity the introduction of an additional morison model may eliminate it according to the author s previous research li et al 2013 nevertheless which is not included in this paper because the quadratic damping is directly given and applied the simulated pitch rao reaches an acceptable agreement with measurement in general however the simulation over predicts around 0 5 rad s somehow we found the discrepancy on the pitch also exists notably between simulation and experiment from the study of robertson et al 2017 4 2 results of response amplitude operator in this section the seakeeping behavior of oc4 and sov are studied by analyzing rao curves the impact of multi body hydrodynamic interaction is evaluated by comparing results under different wave headings the white noise simulation in the time domain is conducted a lower level 4 0 m h s is considered raos are then obtained by calculating the cross spectral density function divided by the auto spectral density function between structure response and wave elevation raos are given in 45 interval of a wave heading as the focus here is the wave frequency motion the rao is therefore presented according to the wave period which better links to other results like limiting wave height in sect 4 3 and thereafter fig 9 shows rao of 6 dof motion for the oc4 wind turbine as the physical configuration of oc4 is defined symmetrically with respect to the x axis as shown fig 4 the motion characteristics should be also symmetric in terms of a wave propagated from starboard 0 to 180 and portside 0 180 in fact it is not the case in this study due to the sov vessel in proximity by comparing surge raos between 45 and 45 as well as 135 and 135 the obvious discrepancy could be seen which concentrate in the short period range around 6 s raos gradually converge without an obvious difference as an increase of wave period meanwhile the peaks around 6 s are observed to shift to the shorter period for raos of 45 and 135 since sov is located at the starboard of oc4 the above findings demonstrate clearly the impact due to the interaction of multi body hydrodynamics however the influence is limited within the short period region as for sway raos of waves from the portside such as 135 are seen to be greater fluctuation compared to corresponding raos from starboard generally the wave from starboard induces a smaller sway response which could be explained by the shielding effect because oc4 is protected by sov vessel on her starboard side the similar phenomenon was also observed and discussed in depth by zhao et al 2019 about heave the motion in the wave frequency range is relatively in small magnitude compared to the typical vessel because the natural period is far away the influence of hydrodynamic interaction is seen to be limited similarly roll and pitch motions are also much smaller than the traditional vessel as for roll peaks of raos due to portside waves present an apparent shift towards the shorter period compared to corresponding raos from starboard and the value of the peak slightly increases yaw motion shows also the asymmetrical behavior as rao of 90 is observed to be amplified compared to that of 90 in particular fig 10 shows rao of 6 dof motion for sov vessel as for surge rao the curves develop smoothly and do not show apparent indication about the hydrodynamic resonance however sway raos demonstrate strong fluctuation for waves from both portside and starboard certainly the level of fluctuation due to starboard waves is obviously higher than the portside such as the comparison between 135 and 135 this is not surprising because starboard is the weather side to sov vessel the motion of heave roll and pitch is significantly larger than that of oc4 as mentioned earlier regarding heave and pitch the rao of starboard wave is notably larger than the corresponding one on the portside besides a few additional peaks can be seen for heave under oblique seas 45 and 135 a similar trend also happens to the yaw motion however roll motion seems not to be sensitive to the multi body interaction rao curves display smooth varying as the period increases the differences of raos between waves of portside and starboard are limited compared to other dofs the operation of walk to work depends on the motion behavior of the gangway which is consequently determined by relative motions of oc4 and sov the relative motions are computed by subtracting the movement of the landing point on oc4 from the pedestal location of sov which is calculated by rigid body motion equation eq 18 fig 11 plots the rao of relative motions in the o x y z system by observing the trend of δ x sov s pitch fig 10 e seems to be the governing factor here it is understandable because both surge motion of oc4 and sov are mild however according to eq 18 the significant sov pitch that multiplies relatively high z location of pedestal contributes the majority of δ x the curves of δ y present two peaks one locates around 7 s and the other one appears at 11 s the first peak is due to sov s sway fig 10 b the second one should be credited with the resonance of sov s roll fig 10 d as for δ z sov s heave fig 10 c dominates the general trend and the roll motion also influences a bit especially under beam sea after 15 s curve of δ z is seen to develop upward further due to oc4 s heave motion fig 9 c 4 3 the limiting wave height with wave frequency motion only the operational limiting criteria of walk to work is summarized in table 5 according to wu et al 2018 guanche et al 2016 except for the roll angle the most limiting criteria are regarding relative motion and velocity between the gangway departure point at top of the pedestal and landing point on top of oc4 offset column the discussion of limiting wave height in this section does not consider the effect of nonlinear drift motion therefore only the first order wave force is taken into account to simulate the irregular waves the jonswap wave spectrum is employed 3 3 which describes the fully developed sea is used as the peak enhancement factor for all sea state the results are given from 180 to 135 with the 45 interval which covers the occasions of following quartering beam bow and head seas on both starboard and portside the range of peak period t p discussed in this study is from 4 5 to 10 5 s which is discretized by step of 1 5 s the period range is adequate to cover most scenarios because the offshore operation is conducted only under relatively mild weather conditions the limiting wave height is obtained by repeatedly running a 3 h time domain simulation with consecutively increased significant wave height until one of the limiting criteria in table 5 is exceeded the increment is 0 25 m per step of significant wave height for this study after each simulation the extreme values of all operational limit listed in table 5 are calculated at the mpm level most probable maximum before checking with the respective criterion in this study the mpm extreme values are obtained by fitting the weibull distribution and peaks also troughs from time series the tail fitting strategy is used for higher accuracy which fits 7 sets of tailed peaks i e 60 65 70 90 the final weibull parameters were obtained by averaging parameters of these 7 sets the result of limiting wave height is summarized in table 6 besides the values presented in the table investigating the failure mode which criterion is exceeded is beneficial for better understanding the motion which interrupts the walk to work operation therefore table 6 is colored according to different failure modes and the meaning of color is described in the caption of the table title the polar diagram of limiting wave height is shown in fig 12 firstly table 6 shows the failure under beam sea 90 and 90 are due to the velocity of δ y for all different t p for the period between 4 5 and 7 5 s the velocity of δ x dominates rest headings except beam seas for the period above 7 5 s failures are all caused by δ z motion except beam seas secondly we found the wave heights of 4 5 s t p is much higher than other periods which can be explained that the δ x rao is quite small for the short period wu 2014 reported a similar result however the wave height in his research was even higher because the wind turbine was fixed in that case however we must remind that some obtained wave heights in a short period such as that of t p 4 5 s with the corresponding wavelength of 32 m in table 6 may not occur in reality because the waves break when the wave height is over 1 7 of the wavelength which is about 4 6 m according to the wave breaking criterion this is the estimation based on the individual wave assumption if consider the real wave and spectrum a more practical method was proposed by buckley 1988 the relationship of limiting h s l i m and t p is defined as h s l i m t p 2 0 00776 g by using this formula the actual maximum significant wave height of t p 4 5 s and 6 0 s is limited to 1 54 m and 2 74 m which seems to allow unconditional operation according to the result in table 6 thirdly by observing the polar diagram the shape appears longer along the axis 180 to 0 while shorter along the axis 90 to 90 in addition the shape above axis 90 to 90 also appears bigger size than that below until t p increases to 9 0 s and above which illustrate the asymmetrical behavior the asymmetry is seen between the starboard and portside as well the limiting wave heights of portside waves are slightly higher than that of starboard it reminds the discussion in fig 11 a earlier that raos of starboard waves in the short period in particular is larger than that of portside due to the interaction of multi body hydrodynamics in general results show the failure mode concentrates on horizontal δ x and δ y and the velocity is the governing factor rather than the displacement the vertical motion is the main concern in the case of the long wave period 4 4 the limiting wave height considering the drift motion in this section the drift and slow drift motions are added in the analysis of limiting wave height table 7 summarized the result the colors representing failure modes are explained in the caption of table title fig 13 displays the polar diagram apparently the size of the polar diagram is significantly reduced compared to fig 12 the limiting wave height obtained is around 2 3 m however which is about 3 5 m in table 6 for the case without drift motion although the horizontal δ x and δ y still dominate the failure modes except for the long wave period the failure modes actually change to the displacement from the velocity it indicates the horizontal motion must largely increase due to the drift force however the velocity contribution by increased slow drift motion is nearly negligible compare to the component of wave frequency motion because the natural period of oc4 is over 100 s as shown in fig 4 the displacement therefore can exceed the limit at lower wave height than the velocity in this case meanwhile we notice the wave height of t p 4 5 s is the lowest over all t p which reminds in the earlier study without drift motion the wave height is dramatically as high as over 10 m nevertheless as t p increase further to 10 5 s the vertical motion takes back control it therefore implies the drift effect is weakened to further understand the phenomenon more pieces of evidence are needed and presented firstly for instance the surge and sway drift forces of oc4 under quartering sea are shown in fig 14 the drift forces are the outcome of diffraction and radiation computation in frequency domain as discussed in sect 2 1 in general the drift force is seen to gradually decrease as an increase of wave period moreover the strong fluctuations occur in the range of short periods for both waves from starboard and portside although the intensity of the portside wave 135 is obviously higher once again the shielding effect mentioned earlier regarding wave frequency result is also applicable to the second order forces secondly for instance the time history of the δ x and surge motion of both oc4 and sov for t p 4 5 s at its limiting wave height 1 75 m is drawn together in fig 15 time series shows the surge of oc4 experiences the significant long period oscillation the slow drift motion governs the total response because sov s surge is much smaller than that of oc4 the δ x is seen to be nearly dominated by oc4 s motion considering the h s is only 1 75 m which however causes δ x over 3 m of amplitude the drift motions contribute the most dynamic response the percentage of low frequency and wave frequency motions in δ x are evaluated by response spectra shown in fig 16 the curves in the figure represent δ x spectra at the limiting wave height from t p 4 5 9 0 s under wave from 180 the standard deviation σ of both low frequency and wave frequency are further quantified low frequency range 0 0 3 rad s wave frequency range 0 3 2 0 rad s in table 8 it s clearly seen that the low frequency motion absolutely control the δ x for the short period like 4 5 s the ratio of σ is almost 10 1 as t p increases the wave frequency motion gradually increases too and is accompanied by reduction of low frequency motion the ratio of σ therefore changes to nearly 1 1 when t p goes up to 9 0 s this is the reason the limiting wave height in table 6 without considering drift motion could be close to the result in table 7 only when t p is long we are also interested in how operating limit changes with h s in one combination of t p and wave heading therefore mpm extremes estimated from the time domain simulation for the surge and sway motions are plotted against the stepped increase of h s in fig 17 the intermediate results of t p 9 0 s from quartering sea 135 are exhibited here for an example in this case mpm extremes of sov are apparently larger than that of oc4 over all h s by observing these curves although they actually present just weakly nonlinear manner the mpm extreme curve of sov especially the sway shows clearer nonlinear behavior than that of oc4 this is because the waterline shape of mono hull sov attracts a larger drift force compared to oc4 of the small water plane cylindrical structure the different waterline patterns affect the waterline integral which is an important part of drift force and sensitive to drift force in short period range fig 18 presents the surge and sway drift force for sov vessel which is shown for comparison purposes against fig 14 same with fig 14 the drift forces of sov vessel in fig 18 are also the results of diffraction and radiation computation in frequency domain the mpm extreme curve of all operating limit is plotted against h s in fig 19 we can observe that the slope of δ x or δ y velocity shows a flatter trend than δ x or δ y displacement besides the velocity of δ x or δ y still has a certain space to reach the respective threshold defined in table 5 however δ x displacement is approaching to 3 2 m limit besides the nonlinear behavior of δ x or δ y seems to be further weakened compared to the trend of surge and sway in fig 17 by mixing the contribution of rotation like pitch which is a linear response it is also worth noting that the wave second order drift force is presented by qtf and predicted in the frequency domain as discussed in sect 2 1 therefore the drift force has to be transferred from the frequency domain to the time domain by eq 10 in order to implement the simulation compared to the direct time domain simulation of fully nonlinear potential flow or cfd computational fluid dynamics the qtf method shows less capable in case of the strong nonlinear or transient occasion nevertheless most implementation of fully nonlinear potential flow and cfd is based on the numerical wave tank which brings additional problems to be handled carefully such as the setup of the damping layer moreover the computational grid and the interface between body and fluid have to be updated timely due to the movement of the body therefore there are still concerns about the effectiveness and stability of the calculation on one hand for the offshore floating structure or ship the drift motion induced by drift force is a kind of typical weakly nonlinear effects on the other hand the operability study like this case requires computations for a large number of sea state the frequency domain qtf method is therefore considered as the most applicable formulation by far 4 5 the application of limiting wave height in offshore operation the previously obtained limiting wave height is employed for helping make the decision in actual design and analysis of offshore operation usually the comparison between onsite operational sea state and limiting wave height is conducted which is straightforward but efficient in this section two sets of operational sea state dedicated for wind turbine project i e gulf of mexico gom and gulf of maine me abs 2013 are used to demonstrate which are summarized in table 9 fig 20 show the results by using limiting wave height with and without drift motion the limiting wave height is presented by a curve of t p and h s for each wave heading the b spline interpolation is used for smooth purposes apparently curves of limiting wave height with and without drift motion illustrate different patterns without drift motion the curves present the declining trend as t p increases while they show a growing trend by taking into account the drift of course two different results converge when t p increases to a certain level like 10 s in this case because drift motion does not govern the operating limit anymore to the steep onsite operational sea state regarding t p and h s like me shown in figures the impact of drift motion seems not an issue because the wave height in the short period is adequately low however to the less steep site like gom the operation becomes not allowable from t p 6 s it is about 9 s without drift motion for some particular wave headings by considering the drift motion if beam seas were not counted here generally speaking the involvement of the drift motion lets the check of limiting wave height more strict than that considering wave frequency motion only it is fine to ignore the drift motion in the preliminary stage which is indeed quick execution and the analysis in the frequency domain is enough most of the time however it is highly recommended to refine the numerical model by considering the nonlinear factors like drift motion in the final stage analysis lastly both figures in fig 20 shows clearly that the walk to work operation under the beam sea must be avoided or carefully conducted 5 conclusions the operability of walk to work operation between floating wind turbine and service operation vessel sov is studied using a time domain approach by in house software kraken the hydrodynamics of the wind turbine and vessel in a multi body configuration are solved by frequency domain in house code hydra the established numerical modeling for oc4 and its mooring system is validated by the existing model test result the raos from white noise tests representing wave frequency motions are discussed in depth and the effect of hydrodynamic interaction e g shielding is especially focused on the discussion combining various operating limits regarding gangway work ability in particular the limiting wave height that considering with and without nonlinear drift motion is calculated by time domain simulations the failure mode asymmetry of the polar diagram impact due to the drift motion etc are emphasized and discussed in detail the obtained limiting wave height is demonstrated for walk to work operation checks regarding two actual onsite wave conditions the conclusions are drawn as follows raos show the obvious fluctuating for oc4 wind turbine in short periods the global motions present asymmetrical behavior with respect to the axis of symmetry the surge motions in a short period appear peak shit for waves coming from sov side and so does the roll motion the sway shows a larger response for waves from the weather side compared to the sov side which clearly demonstrates the multi body interaction and shielding effect oc4 s heave roll and pitch in a vertical plane present smaller responses in general compared to a traditional vessel on sov side surge motion seems not so much affected by oc4 while sway illustrates strong fluctuation and waves from the weather side induce obviously higher motion than that from oc4 side motions of heave and pitch are notably amplified by waves from the weather side however the roll is seen not sensitive to multi body interaction raos of relative motions between gangway departure and landing points show the x axis component δ x is governed by sov s pitch because gangway s departure location is relatively high in the vertical plane δ y presents double peaks due to sov s roll and sway δ z is dominated by sov s heave from the point of view regarding linear wave frequency motion relative motions are mostly controlled by sov not oc4 the limiting wave heights that considering wave frequency motion concentrate about 3 5 m at very short t p like 4 5 s in this case the limiting wave height could be up to 10 m for some wave heading which is significantly larger than other periods under beam seas the failure mode is completely dominated by the velocity of δ y one of the operating limits over all t p when t p is below 7 5 s the velocity of δ x is the major failure mode however the δ z displacement takes control for the failure from 9 s onward the polar diagram demonstrates that the limiting wave heights on osv s weather side are smaller than that on osv s lee side oc4 is on the weather side in this situation which shows the asymmetrical characteristic meanwhile the asymmetrical phenomenon is also observed between bow and following waves in general the horizontal velocity is the main reason cause the operation failure however as t p grows the vertical motion takes over control by taking into account the nonlinear drift motions the general limiting wave height reduces to 2 3 m for short t p the governing failure modes change to δ x or δ y displacement because the slow drift motions play an important role especially in short period range besides the newly added slow drift motion does not contribute a notable increase to velocity therefore the limiting wave height at 4 5 s declines significantly to 1 2 m which becomes the lowest limiting wave height over all t p that considered in this study certainly vertical δ z is still the dominant failure mode for long t p the wave drift force of the frequency domain indeed shows the fluctuation and amplification in the short period range due to hydrodynamic interaction the shielding effect is also applicable to the second order drift force the response spectra analysis further demonstrate that the oc4 s horizontal motion like surge is mainly governed by low frequency motion the ratio of standard deviation between low and wave frequency motion is as high as 10 1 in short t p and the domination gradually lost as t p grows up by investigating the relation of the mpm operating limit and h s we found the extremes of surge and sway of oc4 and sov actually present a weakly nonlinear manner with h s the nonlinear behavior of δ x and δ y is further weakened by the linear motion component like pitch during operation check regarding two actual onsite wave conditions curves of limiting wave height with and without drift motion present different patterns without drift motion the curves show the declining trend as t p increases while they show a growing trend if the drift motion was considered to the case that the relation of t p and h s is steep the impact of drift motion seems not a critical issue because the wave height in a short period is adequately low nevertheless for the less steep site the operation may be interrupted in the short t p no matter with or without drift motion the result both demonstrate clearly that the walk to work operation under beam sea must be avoided or carefully conducted finally regarding w2w operation analysis it is highly recommended to employ a refined time domain numerical model by considering the nonlinear drift motion in the final check credit authorship contribution statement binbin li conceptualization methodology computation writing original draft plotting revising and responding to reviewer declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
21169,estimating hydrodynamic coefficients is important in the design of submarines to enhance the efficiency of the computational fluid dynamics cfd method for evaluating the hydrodynamic performance of submarines we have developed a velocity decomposition solver for the simulation of a moving body based on the open source cfd platform openfoam the total velocity is decomposed into potential flow velocity and non potential flow velocity the potential flow velocity is further decomposed into unit components which can be computed by the proposed method with less interpolation cost further the original potential flow velocity can be recovered by linear summation of these unit velocity components this avoids solving laplace equation at each time step the non potential flow velocity is solved by using a complementary navier stokes equation in a smaller domain as compared to that used in the conventional cfd method in addition a buffer source term is introduced for the transition of non potential flow velocity to potential flow velocity oblique towing test and planar motion mechanism test are numerically simulated using the proposed method which reveal good consistency between the experimental data and simulation results this validates the efficiency and reliability of the proposed method in estimating the hydrodynamic coefficients of submarines keywords hydrodynamics coefficients coupling method velocity decomposition pmm simulation 1 introduction maneuvering motions such as steady turning depth change and rising are unavoidable during the mission time of submarines further the stability of submarines during these motions should be considered while designing the vehicle by predicting the submarine behavior the submarine behavior can be evaluated by solving the equations of motion with hydrodynamic coefficients conventionally there are three methods to predict the hydrodynamic coefficients of a submarine 1 semi empirical method 2 experimental analysis 3 numerical simulations semi empirical method is advantageous in terms of computational efficiency but it cannot take the submarine shape into account experimental analysis fan et al 2012 zhang and zou 2013 nouri et al 2016 is widely accepted as the most reliable and accurate method however it requires special facilities and equipments and the relevant costs can be quite high during the preliminary design stage numerical simulation method has been widely used in analyzing hydrodynamic problems e g for oblique towing test and planar motion mechanism pmm test to obtain the velocity and acceleration hydrodynamic coefficients respectively kim et al 2002 tyagi and sen 2006 generally conventional numerical simulation methods are time consuming especially in simulating the pmm test with the dynamic mesh method jasak 2009 therefore our objective is to develop efficient and straightforward solvers for numerical simulation to shorten the design period of submarine according to prandtl s boundary layer theory schlichting and gersten 2016 viscosity effect just exists around the submarine and along the wake flow during the simulation meanwhile the far field flow can be treated as potential flow therefore a coupled potential viscous method is an appropriate choice for analyzing the flow coupling method li et al 2018a 2019 sheng et al 2015 is commonly used to solve hydrodynamic problems with excellent computational accuracy and efficiency there are two typical formulations of coupling methods velocity decomposition method and domain decomposition method kristiansen and faltinsen 2012 in this study the coupling method is based on velocity decomposition because it is more effective than domain decomposition method for simulating a moving object the coupled numerical methods based on velocity decomposition are based on the same theoretical principle in these methods the total velocity is decomposed into potential flow velocity and is solved in the reduced potential domain the remaining part of velocity is obtained by solving a complementary n s equation in viscous domain several previous works have focused on the velocity decomposition method kunho et al 2005 decomposed the velocity into potential part and non potential part and simulated the flow field around a two dimensional 2d airfoil to prove that the velocity decomposition method can enhance the simulation accuracy with the same mesh configuration edmund et al 2013 decomposed the velocity into potential and vortical components and proved that the velocity decomposition method can reduce the simulation domain by simulating the flow field around a submarine yang et al chen and maki 2016 used a similar decomposition approach to solve unsteady turbulent flow spectral wave explicit navier stokes equations swense method decomposes the total field into incident and complementary components and this method has been proved to provide an accurate result with a relatively coarser mesh li et al 2018b the swense method has been widely used in solving many hydrodynamic problems with free surface when the floating body is steady or is moving with a small amplitude luquet et al 2007 monroy et al 2011 schrooyen et al 2016 in this study a new velocity decomposition method is presented for simulating the motion of a submarine with pure sway and pure yaw as shown in fig 1 there are four main differences between our method and the existing coupling methods 1 we introduce the dynamic mesh method in the complementary n s equation and establish the coupling method for simulating the sway and yaw motion 2 we introduce a buffer source term and a buffer region for the transition from viscous velocity to potential flow velocity 3 we devise a method to decompose the potential flow velocity into unit components and derive a formula for the linear potential flow velocity to improve the computational efficiency meanwhile the time derivative of the potential flow velocity in complementary n s equation can be solved with semi analytic formula 4 we implement an interpolation strategy to reduce the interpolation cost there are three main advantages of the present decomposition method over the conventional cfd method firstly the entire domain ω v can move with the submarine without mesh deformation during the motion simulation which is because the flow field outside the domain ω v can be treated as potential flow during the motion of the submarine secondly the size of viscous domain ω v can be much smaller than that in the conventional cfd method this is because the viscous domain only needs to include the areas where viscous effects are significant and these effects are confined around the hull and wake region thirdly the solver is relatively robust because the main component of the complementary n s equation is the potential velocity and the time derivative of the potential flow velocity can be solved with semi analytic formula generally the coupling method includes an additional process for solving and interpolating the potential flow velocity as compared to the conventional method in this work the potential velocity can be easily obtained by linear summation of unit potential flow velocities with negligible computation time and the interpolation of the potential domain and the viscous domain only occurs at the boundary s v therefore the time required for solving and interpolating the potential flow velocity can be ignored as compared to that required for solving the complementary n s equation the rest of this paper is organized as follows section 2 presents the relevant theoretical framework and the derivation of the complementary n s equations for solving the non potential flow velocity the theoretical framework includes the decomposition of the total velocity further decomposition of the potential flow velocity introduction of the buffer source term and the method for estimating the hydrodynamic coefficients in section 3 the solution procedure and the interpolation method are described verification study including investigating viscous domain size and buffering zone influence is conducted in section 4 in section 5 convergence analysis for mesh and domain size is presented in section 6 the oblique towing test pure sway test and pure yaw test are numerically simulated based on the proposed velocity decomposition method further the predicted results of the static acceleration coefficients of the submarine model are compared with the experimental results to validate the efficacy of the proposed method finally the study is concluded in section 7 the proposed coupling method is developed on the openfoam platform christopher 2017 li et al 2012 2 theoretical formulation 2 1 velocity decomposition according to helmholtz velocity decomposition theory morino 1986 the velocity of the flow field is decomposed as follows 1 u u p u n where u is the total velocity of the flow field u p is the potential flow velocity and u n is the non potential part the potential flow velocity u p is expressed as the gradient of velocity potential which satisfies the laplace equation 2 u p φ 2 φ 0 where φ is the velocity potential 2 2 potential flow velocity decomposition for a submarine with forced harmonic sway motion or yaw motion with incoming flow the potential flow velocity can be obtained by solving the laplace equation with the corresponding boundary condition b c as follows 3 2 φ 0 ω p φ n u y r c f n f s b o d y φ u x x s p where u y 0 v 0 is the vertical velocity r 0 0 r is the yaw rate c f is the coordinate of the hull surface in the body fixed frame n f is the unit normal vector of the body surface and u x is the incoming flow velocity because these velocities change over time eq 3 should be solved at each time step to obtain the total potential flow velocity according to the linear characteristics of the potential theory the total velocity potential can be further decomposed as follows 4 φ u x φ u v φ v r φ r where φ u is the unit velocity potential under the condition u x 1 m s v 0 m s and r 0 rad s φ v is the unit velocity potential under the condition u x 0 m s v 1 m s and r 0 rad s φ r is the unit velocity potential under the condition u x 0 m s v 0 m s and r 1 rad s the governing equations for each unit velocity potential can be computed as follows 5 φ u 2 φ u 0 ω p φ u n 0 s b o d y φ u 1 x s p 6 φ v 2 φ v 0 ω p φ v n 0 1 0 n f s b o d y φ v 0 s p 7 φ r 2 φ r 0 ω p φ r n 0 0 1 c f n f s b o d y φ r 0 s p and the potential flow velocity u p at time t is obtained by gradient operation of eq 4 as 8 u p u x u p u v u p v r u p r where u p u φ u u p v φ v and u p r φ r are the unit potential flow velocities since the values of u p u u p v and u p r only depend on the shape of submarine they are constants and need be computed just once before the time loop during the simulation further the potential flow velocity is obtained by linear summation according to eq 8 2 3 governing equations for non potential flow velocity while adopting the dynamic mesh method if the fluid is incompressible the velocity u should satisfy the following reynolds averaged navier stokes rans equations 9 u 0 10 u t u u b u 1 ρ p ν e f f u ν e f f d e v u t s where p is the pressure ν e f f is the effective kinematic viscosity ρ is the fluid density s is the buffer source term and u b is the velocity on the control face caused by the movement of mesh substituting eq 1 into eq 9 and 10 we get 11 u p u n 0 12 u p u n t u p u n u b u p u n 1 ρ p ν e f f u p u n ν e f f d e v u p u n t s according to eq 8 the time derivative of the potential flow velocity in eq 12 can be expressed as 13 u p t u x t u p u v t u p v r t u p r f t in the velocity decomposition mode the viscous domain rigidly moves along with the submarine and there is no deformation within the mesh so the mesh velocity is u b u y for sway motion and u b u y r c f for yaw motion since 2 u p 0 eq 11 12 can be written as 14 u n 0 15 u n t u n u b u n f t u p u n u n u p u b u p 1 ρ p ν e f f u n ν e f f d e v u p u n t s eq 14 15 indicate the complementary n s equation corresponding to the non potential flow velocity the complementary equation retains the form of the original n s equation with the coupled potential part the bracketed term in eq 15 indicates the coupling term which represents the interaction between the potential flow velocity and non potential flow velocity in this work the menter s shear stress transport sst k omega turbulence model is employed for solving ν e f f the turbulence model includes the contribution of the total velocity u which implies that the k equation and ω equation retain the same form as the conventional equations and the relevant empirical constants in the turbulence model need not be determined again 2 4 buffer source term for velocity transition on the boundary s v of domain ω v the non potential flow velocity is theoretically small but not negligible due to the weak viscosity effect meanwhile the total velocity is discontinuous at the boundary s v therefore a buffer source term is necessary to maintain the continuity of the total velocity in domains ω v and ω p it also weakens the viscosity effect the buffer source term is defined as follows 16 s θ u n where θ is the damping item this term is zero at the boundary of inner buffer region s t r a n s but it is very large at the boundary s v as shown in fig 2 θ is expressed in the form of damping term feng et al 2015 for cylindrical domain it can be expressed as 17 θ θ 0 m a x x x 0 0 5 l d d x 0 d x m a x r r 0 r d d r 0 d r where θ 0 is a constant that needs to be determined which value is set 20 in the present work x 0 and r 0 are the axial and radial distance from the center of the domain ω v to the origin of the coordinate system respectively l d and r d are the length and radius of the domain ω v respectively and d x d r are the distance from s t r a n s to s v as shown in fig 2 the buffer source term in eq 16 works on the entire buffer region in fact the non potential flow velocity is almost zero at the boundary s v except in the wake region so the main function of the buffer source term is to reduce the viscosity effect of the wake flow at the outlet boundary 2 5 boundary conditions the solution procedure of eq 14 15 is similar to that of the conventional n s equation with minor difference in the b c as shown in fig 3 in fig 3 the boundary s v is decomposed into inlet boundary s i n and outlet boundary s o u t according to the viscous effect on each boundary the b c for velocity is shown as follows 18 s w a y u n u y u p s b o d y u n 0 s i n u n 0 s o u t y a w u n u y r c f u p s b o d y u n 0 s i n u n 0 s o u t the b c at the boundary s b o d y is derived from no slip b c at the inlet boundary s i n zero value b c is considered which implies that the flow outside the viscous domain can be treated as potential flow the outlet boundary s o u t adopts the zero gradient b c because the viscosity effect cannot be ignored in the wake region the value of non potential flow velocity is close to zero because we have introduced the buffer source term to reduce the viscosity effect so it is reasonable to use a zero gradient b c here 2 6 estimation of hydrodynamic coefficients the hydrodynamic coefficients are obtained by numerical simulation according to the corresponding model test 2 6 1 oblique towing test in oblique towing test the model is located under a given angle with respect to the flow direction the coordinate system for numerical simulation is shown in fig 4 a schematic of viscous domain is shown as the dashed box in fig 4 the velocity and acceleration are zero in the oblique towing test the corresponding potential flow velocity according to eq 8 and the time derivative term in eq 13 are expressed as follows 19 u p u u p u f t 0 the taylor series expansion of the hydrodynamic force and moment can be expressed as follows feldman 1979 20 f y y v v y v v v v m z n v v n v v v v where v u s i n α u is the incoming flow velocity α is the given pitch angle f y is the hydrodynamic force m z is the hydrodynamic moment and y v y v v n v n v v are velocity hydrodynamic coefficients 2 6 2 pure sway test pmm tests are divided into pure translation and rotation motions to obtain the acceleration hydrodynamic coefficients related to translation and rotation respectively in the pure sway test the model is subjected to a harmonic motion with invariant amplitude and frequency as shown in fig 5 a schematic of viscous domain is shown as dashed box in fig 5 such motion consists of a harmonic oscillation along the y axis and steady motion along the x axis vertical displacement y vertical velocity v and vertical acceleration v for pure sway motion are defined as follows 21 y a s i n ω t v y a ω c o s ω t v y a ω 2 s i n ω t where a and ω are the amplitude and frequency of the submarine with forced harmonic sway motion respectively the corresponding potential flow velocity according to eq 8 and the time derivative term in eq 13 are expressed as follows 22 u p u u p u v u p v f t a ω 2 s i n ω t u p v for the pure sway motion regardless of nonlinear effects the taylor series expansion of the hydrodynamic forces and moments can be rewritten as follows 23 f y y v v y v v m z n v v n v v where y v and n v are the acceleration hydrodynamic coefficients substituting eq 21 in eq 23 and comparing with the fourier integrals carslaw 1921 of the hydrodynamic forces and moments we have 24 f y y v a ω 2 s i n ω t y v a ω c o s ω t f y s i n e s i n ω t f y c o s e c o s ω t m z n v a ω 2 s i n ω t n v a ω c o s ω t m z s i n e s i n ω t m z c o s e c o s ω t where f y s i n e and f y c o s e are the sine and cosine terms of lateral force respectively which are obtained from fourier integral of the numerically computed force time curve m z s i n e and m z c o s e are the sine and cosine terms of yaw moment respectively 2 6 3 pure yaw test in the pure yaw motion the model s center of gravity moves in a sinusoidal path while the model axis remains tangential to the path as shown in fig 6 in this work the model s motion is equivalent to the vertical movement and rotation with incoming flow velocity u as shown in fig 6 the corresponding linear and angular velocities are 25 α α 0 s i n ω t r α α 0 ω c o s ω t r α α 0 ω 2 s i n ω t v u t a n α 0 s i n ω t u x u 1 t a n 2 α 0 s i n ω t 1 2 where α 0 and ω are the amplitude and frequency of the submarine with pure yaw motion respectively in the velocity decomposition method the potential flow velocity is solved with the body fixed frame of o x y z the correspoing potential flow velocity according to eq 8 and the time derivative term in eq 13 are expressed as follows 26 u p u x u p u r u p r f t u α 0 ω 1 t a n 2 α 0 s i n ω t 1 2 s i n α 0 s i n ω t c o s 3 α 0 s i n ω t c o s ω t u p u α 0 ω 2 s i n ω t u p r considering pure yaw motion regardless of nonlinear effects the taylor series expansion of the hydrodynamic forces and moments can be rewritten as follows 27 f y y r r y r r m z n r r n r r ere y r and n r are the acceleration hydrodynamic coefficients substituting eq 25 into eq 27 and comparing with the fourier integrals of the hydrodynamic forces and moments we have 28 f y y r α 0 ω 2 s i n ω t y r α 0 ω c o s ω t f y s i n e s i n ω t f y c o s e c o s ω t m z n r α 0 ω 2 s i n ω t n r α 0 ω c o s ω t m z s i n e s i n ω t m z c o s e c o s ω t where f y s i n e and f y c o s e are the sine and cosine tms of lateral force respectively which are derived from the fourier integral of numerically computed force time curve m z s i n e and m z c o s e are the sine and cosine terms of yaw moment respectively the hydrodynamic coefficients can be estimated by eq 24 28 using least square method the non dimensional hydrodynamic coefficients are shown as follows 29 y v y v 1 2 ρ l 2 u n v n v 1 2 ρ l 3 u y v v y v v 1 2 ρ l 2 n v v n v v 1 2 ρ l 3 y v y v 1 2 ρ l 3 n v n v 1 2 ρ l 4 y r y r 1 2 ρ l 3 u n r n r 1 2 ρ l 4 u y r y r 1 2 ρ l 4 n r n r 1 2 ρ l 5 where l is the model length 3 numerical implementation in the proposed coupling method two sets of meshes are required one is generated as a large domain for solving the potential flow velocity and the other is generated as a small domain for solving the non potential flow velocity information is exchanged between the two sets of meshes by interpolation therefore finding an efficient interpolation method and reducing the interpolation error are the primary tasks in the numerical implementation of the coupling method 3 1 solution procedure fig 7 shows the solution procedure of the present coupling method the finite volume method fvm is chosen for solving both potential flow velocity and non potential flow velocity the potential velocity is obtained by solving the laplace equation in the corresponding domain with the b c the non potential velocity is obtained by solving the complementary n s equation in viscous domain with the corresponding b c after obtaining the solution of potential flow velocity the solution process of the complementary n s equation is almost the same as that of the conventional n s equation because these equations have the same form typically the boundary element method bem chen et al 2016 zhao et al 2018 is implemented for numerically solving the potential theory problems however in our coupling method we need to obtain the potential flow velocity in the viscous domain ω v according to eq 15 and bem method is not efficient for computing the value in the flow field in the solution procedure shown in fig 7 the unit potential flow velocities are obtained before the time loop and just need to be calculated once while the laplace equation and interpolation are included in the procedure of solving the uniform potential flow velocity besides according to eq 8 the linear summation of potential flow velocity u p takes negligible time therefore the time consumed in evaluating the potential flow velocity can be ignored generally iteration is necessary during the coupling between potential and non potential flow velocity in the proposed velocity decomposition method the potential flow velocity is the main component of the flow velocity which affects the non potential flow velocity as a source term see eq 15 the calculated non potential flow velocity determines the force and moment acting on the submarine if the velocity of submarine is computed by forces acting on it instead of forced motion the value of the non slip b c is changed due to the variation in the velocity which in turn affects the value of potential flow velocity field therefore an iteration process is necessary in the present numerical simulation of forced harmonic heaving motion the boundary velocity is specified instead of computing it from motion equations with six degrees of freedom therefore the procedure appears like one way coupling to check the efficiency of the current coupling solver the average central processing unit cpu time for each time step of pure sway case serially running on a computer with 2 3 ghz cpu intel xeon gold 5118 corresponding to different methods were recorded the results are shown in fig 8 in fig 8 the overset mesh method is implemented in starccm software where the mesh size in the background overset region is similar to that in our potential viscous zone the remesh method is implemented with pimpledymfoam solver in openfoam where the remesh 1 and remesh 2 cases are computed with number of meshes similar to that in the viscous zone and potential zone respectively it is clear that our solver requires less computation time and is more efficient than the conventional cfd method 3 2 interpolation algorithm theoretically the potential flow velocity in domain ω v can be obtained by global interpolation after solving the laplace equation in domain ω p however interpolation on the entire domain is time consuming and tends to generate substantial errors according to the linear characteristics of potential flow theory as long as the potential flow velocity on the boundary of the viscous domain is obtained the accurate potential flow velocity in the viscous domain can be obtained by solving the laplace equation therefore we just need to conduct the interpolation on the boundary s v and solve the laplace equation in domain ω v to obtain the potential flow velocity fig 9 shows the interpolation method used in the present work the velocity potential on the boundary s v is interpolated from corresponding cell values in domain ω p the corresponding b c is employed on the body surface that directly depends on the motion mode without interpolation the governing equations in domain ω v can be expressed as follows 30 φ u ω v 2 φ u 0 ω v φ u n 0 s b o d y φ u φ u ω p s v φ v ω v 2 φ v 0 ω v φ v n 0 1 0 n f s b o d y φ v φ v ω p s v φ r ω v 2 φ r 0 ω v φ r n 0 0 1 c f n f s b o d y φ r φ r ω p s v eq 30 and eqs 5 6 7 are the governing equations in domain ω p and domain ω v respectively here fine grids are only needed around the boundary s v in domain ω p because the interpolation is just conducted on this boundary 4 verification study 4 1 verification of accuracy the present method is verified by simulating the flow over stationary and oscillating cylinders at r e 10000 and r e is computed using the in flow velocity u 0 and the cylinder diameter d the simulation of flow over bluff bodies with unsteady reynolds averaged navier stokes urans model has always been a challenge for researchers due to the use of standard logarithmic wall functions for low r e meshes leads to high inaccuracies in this study the mesh is generated with the boundary layer grid size y 1 and the k omega sst turbulence model is adopted with k and ω b c are computed according to stringer s work stringer et al 2014 the dimensions of the domain are shown in fig 10 the spanwise dimension of the domain l z is chosen as l z d π other dimensions are determined by the inlet length l i n which is set as 20 d for potential domain and 5 d for viscous domain as shown in fig 11 the drag coefficient and lift coefficient of flow over the stationary cylinder are compared with experiment data moeller and leehey 1984 gopalkrishnan 1993 and values obtained using cfd method with urans approach stringer et al 2014 in table 1 where c d a v e is average drag coefficient and c l r m s is root mean square of lift coefficient it can be seen that the drag coefficient obtained by the proposed method agrees well with the experiment data but the predicted lift coefficient is significantly different from the experiment data which is similar to the stringer s work stringer et al 2014 this may be caused by the limitation of urans approach in simulating vortex behavior our computed lift coefficient is significantly larger than the stringer s result stringer et al 2014 which may be because we have employed 3d simulation with a different solver the average pressure coefficient c p along the cylinder is shown in fig 12 it is clear that the present method overestimates the magnitude of the minimum pressure on the cylindrical surface as compared to the experiment data which is the reason for the overestimated lift coefficient the forced sinusoidal oscillation in the cross flow is simulated under the condition when the displacement amplitude of cylinder y 0 0 3 d and its oscillation frequency f 0 0 21 u 0 d the average drag coefficient c d a v e and maximum lift coefficient c l m a x obtained by the present method dong s dns method dong and karniadakis 2005 zhao s urans method zhao et al 2012 and experiment gopalkrishnan 1993 are compared in table 2 it is clear from table 2 that the drag coefficient computed by the present method is in good agreement with the experiment data our maximum lift coefficient is higher than the experiment data but is close to simulation results of other studies the time variation of drag coefficient lift coefficient and non dimensional cylindrical displacement are shown in fig 13 it can be observed the time vs lift coefficient curve is almost a pure sinusoidal curve which is consistent with gopalkrishnan s conclusion gopalkrishnan 1993 that the motion corresponding to y 0 d 0 3 and f 0 d u 0 0 21 belongs to periodic lock in situation 4 2 verification of viscous domain size and buffering zone to investigate the influence of viscous domain size and buffering zone on the reliability of the proposed method we change the former by varying the inlet length l i n from 10 d to 1 5 d in the simulation of flow over an oscillation object meanwhile simulations in the absence and presence of buffering zone are conducted for each viscous domain size the width of buffering zone is set as d and 0 5 d for l i n 10 d to 4 d and 3 d to 1 5 d respectively the computed average drag coefficient c d a v e and maximum lift coefficient c l m a x are shown in fig 14 and the velocity contours of total velocity at t u 0 d 100 are shown in fig 15 it is evident in fig 14 that the force coefficients remain almost the same until l i n is reduced to 4 d it can be seen in fig 15 d that the domain size is just equal to the wake width plus width of buffering domain in y direction which indicates that the viscous domain should be larger than the wake width plus the width of buffering zone comparing the results with and without buffering zone in fig 14 it can be observed that the lift coefficient computed with buffering zone is slightly smaller than that without buffering zone and is closer to the experiment value of 1 582 when l i n is less than 4 d the buffering zones do not seem to work this might be attributed to several reasons such as very small buffering zone very small damping constant θ 0 and the advantages brought by the buffering zone are equivalent to its influence on the flow field nevertheless the discussion of buffering zone is meaningless when l i n is less than 4d since the results are unreliable in this situation the non potential flow velocity u n fields with and without bufring zone are shown in fig 16 it is clear that the flow field with buffering zone is smoother and avoid blockage effects around the outlet boundary than that without buffering zone therefore a buffering zone is recommended for better computation accuracy 5 convergence and sensitivity analysis 5 1 mesh and convergence analysis in this study the submarine model suboff with a scale factor of 0 5 is used its geometric parameters are chosen from reference groves et al 1989 and the principle dimensions are listed in table 3 according to the proposed velocity decomposition method two sets of meshes are generated the mesh for the potential domain is generated with trimmed mesher because hexahedral mesh is suitable for interpolation as a background mesh and the mesh for the viscous domain is generated with polyhedral mesher because the polyhedral shaped cells are more robust in the opemfoam simulation the meshes are generated in starccm software and transformed to openfoam with ccm26tofoam tool numerical meshes used in pmm simulation are shown in fig 17 fig 17a shows the mesh of domain ω p which is used for calculating the potential flow velocity therefore the domain size can be large and its mesh is relatively coarse as compared to that of the viscous domain ω v the potential flow velocity on the boundary s v in eq 30 is interpolated from the domain ω p so there exists a refined region around this boundary to ensure the interpolation accuracy the number of mess in the potential domain is 1 1 million fig 17b shows the mesh of domain ω v which moves along with the suboff hull to ensure that the wake region remains located inside the refined zone when the body moves a much finer mesh with larger refinement in the wake zone is used here fig 17c shows the boundary layer mesh system the boundary layer mesh is generated with 5 layers and the total thickness is fixed fig 17d shows the mesh of hull the hull mesh is also dense enough to avoid large aspect ratio in the boundary layer in this study the complimentary n s equation is solved in the domain ω v so the sensitivity of the solution to the resolution of the mesh in this domain should be determined before analysis a mesh with 0 12 million grids is chosen as the initial mesh meshes for the viscous domain were refined using the ratio of 2 in each direction toward the previous mesh three set of meshes with 0 12 million 0 27 million and 0 49 milln grids were adopted in the mesh convergence analysis besides the grid number we also examined the value of hyper parameter y which is the non dimensional distance from the wall to its closest node the value of y affects the accuracy of the numerical predictions here y varies from 30 for the finest grid to 67 for the coarsest one the mesh convergence analysis is focused on force and moment imposed on the hull at 2 and 6 attack angles table 4 summarizes the values of lateral force y and yaw moment m obtained by the mesh convergence analysis it is evident that the results tend to converge with the refinement of the mesh and the force and moment of body remain nearly the same for medium and fine meshes considering the computational cost the medium mesh size was selected for the following simulation 5 2 convergence analysis of domain size in the proposed coupling method the size of domain ω v is determined by the range of viscosity effect we hypothesize that the flow can be treated as pure potential flow on the boundary s v where non potential flow velocity is zero according to the prandtl s boundary layer theory the non potential flow velocity is expected to rapidly vanish when it is away from the body surface besides a buffer source is used in the coupling method to weaken the viscosity effect at boundary s v therefore the theoretical size of the domain ω v can be relatively small the parameters of the viscous domain are shown in fig 18 according to our velocity decomposition theory all the regions with significant viscous effects should be incorporated in the viscous domain including the hull surface and the wake region so the radius of the viscous domain should be greater than the wake amplitude plus the width of the wake and a certain distance should be reserved as the buffer zone therefore the estimated radius of the viscous domain is 1 0 m in terms of wake length selection since the inflow velocity is 0 7 m s the simulated motion period is 5 s and the wavelength of wake is 3 5 m to analyze the development of wake our estimated l d o is 5 m four viscous domains with different parameters were chosen for the convergence analysis the parameters of each domain are listed in table 5 where d2 is the pre estimated domain size the four selected domain sizes are much smaller than the domain size used for a conventional cfd pmm simulation the convergence analysis of domain size is conducted using the proposed coupling method with flow velocity u 0 7 m s harmonic heaving period t 5 s and harmonic heaving amplitude a 0 02 m and a 0 1 m fig 19 and table 6 show the lateral force f y and the yaw moment m z obtained for the convergence analysis of domain size in space fixed frame o ξ η ζ numerical results corresponding to the four domain sizes exhibit a minor difference it is clear that the force and moment acting on the suboff hull are not sensitive to the size of domain ω v around the domain size of d2 which indicates that a relatively smaller domain can be used to improve the computational efficiency 6 numerical application 6 1 simulation of oblique towing test the oblique towing test was numerically simulated to obtain the hydrodynamic coefficients related to velocity the oblique towing test is similar to the resistant test except the model has a fixed attack angle during the test the present coupling method has been validated for resistant test in our previous work zhao et al 2017 in this study a uniform inflow velocity of u 0 7 m s is considered and the attack angle is increased from 0 to 12 in steps of 2 since the suboff hull is xoz symmetrical only half attack angles need to be simulated the velocity fields for each attack angle are shown in fig 20 it is clear that the wake region shifts with the increase in the attack angle there is no viscous accumulation phenomenon on the outlet boundary even though the viscous domain is small and the wake region is close to the side boundary at an attack angle of 12 which proves the effectiveness of our buffer domain strategy fig 21 shows the velocity field of the magnitudes of potential flow velocity u p obtained using eq 8 non potential flow velocity u n obtained using eq 15 and total velocity u derived by assembling the potential and non potential parts for t 10 s it is observed that the non potential flow velocity is not zero around the suboff hull and the wake region where the viscous effects cannot be ignored further the value on the boundary s v fig 21b is almost zero which is consistent with the hypothesis that the flow can be treated as potential flow on the boundary s v the lateral force f y and the yaw moment m z computed at each vertical velocity are presented in fig 22 where the cfd results are obtained from reference toxopeus 2011 and cao et al 2016 in which the suboff model is simulated with a scale of 1 and the incoming flow velocity is 2 76 m s further the experiment data is from reference roddy 1990 these data are fitted with a cubic spline curve the values of the static coefficients y v and n v are determined from the slope of the curve at v 0 so these coefficients computed using the three curves are very close however the values at large attack angles are slightly different which may be attributed to different model scales and reynolds number in the simulation the results computed by the present coupling method cfd method and the experimental data roddy 1990 lin et al 2018 are listed in table 7 the discrepancy between the linear hydrodynamic coefficients calculated by the proposed method and roddy s result roddy 1990 is less than 5 all these results indicate that the present method is adequate for the estimation of static coefficients besides the proposed method uses a much smaller viscous domain than that used in the conventional method 6 2 simulation of pure sway test the pure sway test was simulated to obtain the hydrodynamic coefficients related to linear acceleration in the proposed coupling method the entire viscous domain moves along with the submarine the uniform inflow velocity u 0 7 m s the period t and amplitude a of the forced harmonic sway motion are listed in table 8 6 2 1 interpolation results as discussed in section 3 2 the potential flow velocity is derived by linear summation of unit potential flow velocities that are obtained by the interpolation method to further validate the efficacy of the proposed coupling method the interpolation accuracy should be analyzed in fig 23 25 one quarter of domains ω v and ω p are placed side by side and the values of unit velocity potential are indicated with different colors the velocity potentials φ u φ v and φ r in domain ω v are computed with an interpolated b c according to eq 30 and the unit velocity potentials in the potential domain are computed according to eqs 5 6 7 comparing the velocity potential contour in domains ω v and ω p it is clear that the contour is continuous at the interface of the domains which indicates that the proposed coupling method exhibits minor interpolation errors the unit potential flow velocities are computed by the gradient operation of velocity potential the comparison of the computed velocity contours in domains ω v and ω p is shown in fig 26 28 it is clear that the values of u p u u p v and u p r in the domains ω v and ω p are negligibly different which proves the accuracy of the proposed interpolation method it must be noted that the velocity contour in the potential domain ω p may not as smooth as that in the viscous domain ω v which is because the mesh in the potential domain is relative coarser than that in the viscous domain 6 2 2 analysis of velocity fields the velocity fields of pure sway tests at t 10 s are shown in fig 29 it can be seen that the wake exhibits a sinusoidal form and its amplitude gradually increases as the sway amplitude increases further the wake diverges when the sway amplitude is sufficiently large this is because the incoming flow velocity is small and when the vertical velocity is large the angle between the hull and the related incoming flow is large resulting in a widened wake region the velocity fields at different times for t 5 s and a 0 04 m are shown in fig 30 it is evident that the hull sways along the origin of coordinates o ξ η ζ and the wake develops in a sinusoidal form which is consistent with the expected sway motion described in section 2 6 2 the total velocity is decomposed into potential flow velocity and non potential flow velocity in the proposed coupling method the numerically simulated magnitudes of total velocity field u potential flow velocity field u p and non potential flow velocity field u n are shown in fig 31 it is clear from fig 31a that there is no wake region in the potential flow velocity field the situation is almost opposite for the non potential flow velocity field which is shown in fig 31b the non potential flow velocity is nearly zero except around the hull and the wake region to examine the relationship between non potential flow velocity and viscous effect the contour of vorticity magnitude greater than 0 1 s 1 is presented in fig 32 the region in which the vorticity magnitude is greater than 0 1 s 1 is considered to be the region with significant viscosity effect comparing figs 32 and 31b it is clear that the vorticity contour is similar to the region where the non potential flow velocity is significant which implies that the non potential flow velocity represents the viscosity effect to analyze the flow field in detail the x component of potential flow velocity u p non potential flow velocity u n and the total velocity u were monitored along three representative lines at t 10 s and a 0 02 m the corresponding locations are shown in fig 33 a the velocities along line 1 to line 3 are presented in fig 33 b d respectively fig 33b and fig 33c show the velocity distribution in front of and above the submarine it is evident that the non potential flow velocity rapidly decays to zero when it is away from the body surface which is consistent with the boundary layer theory the velocity distribution in the wake region is shown in fig 33 d it is observed that the viscosity effect still exists in the wake region and the non potential flow velocity is negligible even far away from the body hull the buffer source term of eq 16 works at the buffer region in this region the non potential flow velocity tends to be zero instead of exhibiting periodic oscillation further its value is rather small at the boundary s v which means the flow can be treated as potential flow at the boundary s v 6 2 3 estimated hydrodynamic coefficients hydrodynamic coefficients are estimated according to section 2 6 2 the numerically computed results at each amplitude and period of sway motion are shown in fig 34 fig 34 shows the fitting results according to eq 24 the y axes represent the non dimensional force and moment of the sinusoidal and cosinusoidal part obtained by fourier integration method the x axes denote the acceleration and velocity amplitudes based on eq 24 the slopes of the curves in fig 34 indicate the hydrodynamic coefficients y v n v y v and n v the results obtained by the proposed coupling method cfd method cao et al 2016 potential flow method sahin et al 1997 and previously reported experiments roddy 1990 lin et al 2018 are listed in table 9 the error of y v obtained by the proposed coupling method and roddy s result roddy 1990 is nearly 10 while the error of n v reaches 50 n v is obtained from the sinusoidal part of the yaw moment which is much smaller than the cosinusoidal part generally the numerically computed value of n v should be of the same order of magnitude as the experimental value to meet the engineering requirements pan et al 2012 the error of y v obtained by the present pure sway test is larger than that obtained by the oblique towing test due to following three reasons first the incoming flow velocity remains constant in the pure sway test while it changes with the attack angle in the oblique towing test second non linear terms are ignored in the force expression eq 23 of pure sway test which significantly affects the accuracy of y v third y v is obtained from the damping forces however the proportion of damping force in pure heave motion is smaller than that in the oblique towing test so the accuracy of the analysis is relatively low comparing the present method and the potential method it is clear that the results obtained by the former method are much closer to the experiment data because viscous effect is considered in this method our numerical results indicate that the proposed coupling method is suitable for the estimation of acceleration hydrodynamic coefficients 6 3 simulation of pure yaw test the pure yaw test was simulated to obtain the hydrodynamic coefficients related to angular acceleration cases with different periods t and amplitudes α 0 of yaw motion were simulated which are listed in table 10 the velocity fields corresponding to the pure sway tests at t 10 s are shown in fig 35 it is clear that the wake exhibits a sinusoidal form and its amplitude gradually increases with the increase in the angular amplitude and frequency of yaw motion the vertical motion amplitude y 0 of hull for cases 1 to 4 are 0 023 m 0 046 m 0 040 m and 0 085 m respectively in contrast to the sway motion the wake does not diverge in yaw motion even if the motion amplitude is large this is because the attack angle remains zero during the yaw motio the velocity fields at different times for t 10 s and α 0 4 are shown in fig 36 it is evident that the viscous domain translates and rotates along with the hull further the hull axis is always tangential to the wake trajectory which is consistent with the expected yaw motion described in section 2 6 3 the hydrodynamic coefficients related to rotation are estimated according to section 2 6 3 the results obtained by the proposed coupling method and the experimental data roddy 1990 lin et al 2018 are listed in table 11 the difference between the estimated and experimental roddy 1990 roddy 1990 hydrodynamic coefficients is less than 15 which proves the effectiveness of the proposed coupling method for estimating the hydrodynamic coefficients related to rotation further in the yaw simulation the viscous domain moves along with the hull which indicates that the dynamic mesh method is more efficient and convenient than the conventional cfd simulation method 7 conclusions we presented a velocity decomposition strategy to simulate unsteady submarine maneuverability the proposed strategy was validated using oblique towing test and pmm test the predicted static acceleration coefficients of the submarine model met a satisfactory level of accuracy there are three main features of our velocity decomposition method firstly the non potential flow velocity represents the viscosity effect the viscosity effects are confined to a small domain around the submerged body so the non potential flow velocity is assumed to be nearly zero in the far field and a much smaller computation domain than that used in the conventional cfd method is needed in principle secondly the flow field outside the viscous domain can be treated as potential flow and the inlet and outlet b c for solving non potential flow velocity are fixed as zero value b c and zero gradient b c wherever the submarine moves this implies that the mesh of viscous domain can move with the computed body without deformation and the corresponding movement is not confined in viscous domain therefore the proposed method is highly suitable for the simulation of large amplitude movement thirdly the decomposed potential flow velocity complies with the linear potential theory and the flow field values are linearly proportional to the boundary values this leads to two main advantages a the potential flow velocity can be computed by linear summation of unit potential flow velocities the unit potential flow velocities are obtained from further decomposition of the potential flow velocity according to the mode of body motion b an efficient interpolation methodology can be used in which the required velocity potential can be precisely computed with well interpolated b c instead of interpolating on the entire domain overall our method requires negligible time to evaluate the potential flow velocity and confines the computation of complimentary equation to a small domain that ensures excellent computational efficiency this method is directly applicable for the simulation of sway and yaw motions further the developed solver is potentially useful for motion simulation with six degrees of freedom credit authorship contribution statement j zhao conceptualization methodology software validation r c zhu supervision data curation writing original draft preparation x chen software investigation l hong writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work has been supported by national natural science foundation of china nsfc grant no 51479117 51579147 advance research program of china no 41407010202 and program of state key laboratory of ocean engineering sjtu china no gkzd010071 
21169,estimating hydrodynamic coefficients is important in the design of submarines to enhance the efficiency of the computational fluid dynamics cfd method for evaluating the hydrodynamic performance of submarines we have developed a velocity decomposition solver for the simulation of a moving body based on the open source cfd platform openfoam the total velocity is decomposed into potential flow velocity and non potential flow velocity the potential flow velocity is further decomposed into unit components which can be computed by the proposed method with less interpolation cost further the original potential flow velocity can be recovered by linear summation of these unit velocity components this avoids solving laplace equation at each time step the non potential flow velocity is solved by using a complementary navier stokes equation in a smaller domain as compared to that used in the conventional cfd method in addition a buffer source term is introduced for the transition of non potential flow velocity to potential flow velocity oblique towing test and planar motion mechanism test are numerically simulated using the proposed method which reveal good consistency between the experimental data and simulation results this validates the efficiency and reliability of the proposed method in estimating the hydrodynamic coefficients of submarines keywords hydrodynamics coefficients coupling method velocity decomposition pmm simulation 1 introduction maneuvering motions such as steady turning depth change and rising are unavoidable during the mission time of submarines further the stability of submarines during these motions should be considered while designing the vehicle by predicting the submarine behavior the submarine behavior can be evaluated by solving the equations of motion with hydrodynamic coefficients conventionally there are three methods to predict the hydrodynamic coefficients of a submarine 1 semi empirical method 2 experimental analysis 3 numerical simulations semi empirical method is advantageous in terms of computational efficiency but it cannot take the submarine shape into account experimental analysis fan et al 2012 zhang and zou 2013 nouri et al 2016 is widely accepted as the most reliable and accurate method however it requires special facilities and equipments and the relevant costs can be quite high during the preliminary design stage numerical simulation method has been widely used in analyzing hydrodynamic problems e g for oblique towing test and planar motion mechanism pmm test to obtain the velocity and acceleration hydrodynamic coefficients respectively kim et al 2002 tyagi and sen 2006 generally conventional numerical simulation methods are time consuming especially in simulating the pmm test with the dynamic mesh method jasak 2009 therefore our objective is to develop efficient and straightforward solvers for numerical simulation to shorten the design period of submarine according to prandtl s boundary layer theory schlichting and gersten 2016 viscosity effect just exists around the submarine and along the wake flow during the simulation meanwhile the far field flow can be treated as potential flow therefore a coupled potential viscous method is an appropriate choice for analyzing the flow coupling method li et al 2018a 2019 sheng et al 2015 is commonly used to solve hydrodynamic problems with excellent computational accuracy and efficiency there are two typical formulations of coupling methods velocity decomposition method and domain decomposition method kristiansen and faltinsen 2012 in this study the coupling method is based on velocity decomposition because it is more effective than domain decomposition method for simulating a moving object the coupled numerical methods based on velocity decomposition are based on the same theoretical principle in these methods the total velocity is decomposed into potential flow velocity and is solved in the reduced potential domain the remaining part of velocity is obtained by solving a complementary n s equation in viscous domain several previous works have focused on the velocity decomposition method kunho et al 2005 decomposed the velocity into potential part and non potential part and simulated the flow field around a two dimensional 2d airfoil to prove that the velocity decomposition method can enhance the simulation accuracy with the same mesh configuration edmund et al 2013 decomposed the velocity into potential and vortical components and proved that the velocity decomposition method can reduce the simulation domain by simulating the flow field around a submarine yang et al chen and maki 2016 used a similar decomposition approach to solve unsteady turbulent flow spectral wave explicit navier stokes equations swense method decomposes the total field into incident and complementary components and this method has been proved to provide an accurate result with a relatively coarser mesh li et al 2018b the swense method has been widely used in solving many hydrodynamic problems with free surface when the floating body is steady or is moving with a small amplitude luquet et al 2007 monroy et al 2011 schrooyen et al 2016 in this study a new velocity decomposition method is presented for simulating the motion of a submarine with pure sway and pure yaw as shown in fig 1 there are four main differences between our method and the existing coupling methods 1 we introduce the dynamic mesh method in the complementary n s equation and establish the coupling method for simulating the sway and yaw motion 2 we introduce a buffer source term and a buffer region for the transition from viscous velocity to potential flow velocity 3 we devise a method to decompose the potential flow velocity into unit components and derive a formula for the linear potential flow velocity to improve the computational efficiency meanwhile the time derivative of the potential flow velocity in complementary n s equation can be solved with semi analytic formula 4 we implement an interpolation strategy to reduce the interpolation cost there are three main advantages of the present decomposition method over the conventional cfd method firstly the entire domain ω v can move with the submarine without mesh deformation during the motion simulation which is because the flow field outside the domain ω v can be treated as potential flow during the motion of the submarine secondly the size of viscous domain ω v can be much smaller than that in the conventional cfd method this is because the viscous domain only needs to include the areas where viscous effects are significant and these effects are confined around the hull and wake region thirdly the solver is relatively robust because the main component of the complementary n s equation is the potential velocity and the time derivative of the potential flow velocity can be solved with semi analytic formula generally the coupling method includes an additional process for solving and interpolating the potential flow velocity as compared to the conventional method in this work the potential velocity can be easily obtained by linear summation of unit potential flow velocities with negligible computation time and the interpolation of the potential domain and the viscous domain only occurs at the boundary s v therefore the time required for solving and interpolating the potential flow velocity can be ignored as compared to that required for solving the complementary n s equation the rest of this paper is organized as follows section 2 presents the relevant theoretical framework and the derivation of the complementary n s equations for solving the non potential flow velocity the theoretical framework includes the decomposition of the total velocity further decomposition of the potential flow velocity introduction of the buffer source term and the method for estimating the hydrodynamic coefficients in section 3 the solution procedure and the interpolation method are described verification study including investigating viscous domain size and buffering zone influence is conducted in section 4 in section 5 convergence analysis for mesh and domain size is presented in section 6 the oblique towing test pure sway test and pure yaw test are numerically simulated based on the proposed velocity decomposition method further the predicted results of the static acceleration coefficients of the submarine model are compared with the experimental results to validate the efficacy of the proposed method finally the study is concluded in section 7 the proposed coupling method is developed on the openfoam platform christopher 2017 li et al 2012 2 theoretical formulation 2 1 velocity decomposition according to helmholtz velocity decomposition theory morino 1986 the velocity of the flow field is decomposed as follows 1 u u p u n where u is the total velocity of the flow field u p is the potential flow velocity and u n is the non potential part the potential flow velocity u p is expressed as the gradient of velocity potential which satisfies the laplace equation 2 u p φ 2 φ 0 where φ is the velocity potential 2 2 potential flow velocity decomposition for a submarine with forced harmonic sway motion or yaw motion with incoming flow the potential flow velocity can be obtained by solving the laplace equation with the corresponding boundary condition b c as follows 3 2 φ 0 ω p φ n u y r c f n f s b o d y φ u x x s p where u y 0 v 0 is the vertical velocity r 0 0 r is the yaw rate c f is the coordinate of the hull surface in the body fixed frame n f is the unit normal vector of the body surface and u x is the incoming flow velocity because these velocities change over time eq 3 should be solved at each time step to obtain the total potential flow velocity according to the linear characteristics of the potential theory the total velocity potential can be further decomposed as follows 4 φ u x φ u v φ v r φ r where φ u is the unit velocity potential under the condition u x 1 m s v 0 m s and r 0 rad s φ v is the unit velocity potential under the condition u x 0 m s v 1 m s and r 0 rad s φ r is the unit velocity potential under the condition u x 0 m s v 0 m s and r 1 rad s the governing equations for each unit velocity potential can be computed as follows 5 φ u 2 φ u 0 ω p φ u n 0 s b o d y φ u 1 x s p 6 φ v 2 φ v 0 ω p φ v n 0 1 0 n f s b o d y φ v 0 s p 7 φ r 2 φ r 0 ω p φ r n 0 0 1 c f n f s b o d y φ r 0 s p and the potential flow velocity u p at time t is obtained by gradient operation of eq 4 as 8 u p u x u p u v u p v r u p r where u p u φ u u p v φ v and u p r φ r are the unit potential flow velocities since the values of u p u u p v and u p r only depend on the shape of submarine they are constants and need be computed just once before the time loop during the simulation further the potential flow velocity is obtained by linear summation according to eq 8 2 3 governing equations for non potential flow velocity while adopting the dynamic mesh method if the fluid is incompressible the velocity u should satisfy the following reynolds averaged navier stokes rans equations 9 u 0 10 u t u u b u 1 ρ p ν e f f u ν e f f d e v u t s where p is the pressure ν e f f is the effective kinematic viscosity ρ is the fluid density s is the buffer source term and u b is the velocity on the control face caused by the movement of mesh substituting eq 1 into eq 9 and 10 we get 11 u p u n 0 12 u p u n t u p u n u b u p u n 1 ρ p ν e f f u p u n ν e f f d e v u p u n t s according to eq 8 the time derivative of the potential flow velocity in eq 12 can be expressed as 13 u p t u x t u p u v t u p v r t u p r f t in the velocity decomposition mode the viscous domain rigidly moves along with the submarine and there is no deformation within the mesh so the mesh velocity is u b u y for sway motion and u b u y r c f for yaw motion since 2 u p 0 eq 11 12 can be written as 14 u n 0 15 u n t u n u b u n f t u p u n u n u p u b u p 1 ρ p ν e f f u n ν e f f d e v u p u n t s eq 14 15 indicate the complementary n s equation corresponding to the non potential flow velocity the complementary equation retains the form of the original n s equation with the coupled potential part the bracketed term in eq 15 indicates the coupling term which represents the interaction between the potential flow velocity and non potential flow velocity in this work the menter s shear stress transport sst k omega turbulence model is employed for solving ν e f f the turbulence model includes the contribution of the total velocity u which implies that the k equation and ω equation retain the same form as the conventional equations and the relevant empirical constants in the turbulence model need not be determined again 2 4 buffer source term for velocity transition on the boundary s v of domain ω v the non potential flow velocity is theoretically small but not negligible due to the weak viscosity effect meanwhile the total velocity is discontinuous at the boundary s v therefore a buffer source term is necessary to maintain the continuity of the total velocity in domains ω v and ω p it also weakens the viscosity effect the buffer source term is defined as follows 16 s θ u n where θ is the damping item this term is zero at the boundary of inner buffer region s t r a n s but it is very large at the boundary s v as shown in fig 2 θ is expressed in the form of damping term feng et al 2015 for cylindrical domain it can be expressed as 17 θ θ 0 m a x x x 0 0 5 l d d x 0 d x m a x r r 0 r d d r 0 d r where θ 0 is a constant that needs to be determined which value is set 20 in the present work x 0 and r 0 are the axial and radial distance from the center of the domain ω v to the origin of the coordinate system respectively l d and r d are the length and radius of the domain ω v respectively and d x d r are the distance from s t r a n s to s v as shown in fig 2 the buffer source term in eq 16 works on the entire buffer region in fact the non potential flow velocity is almost zero at the boundary s v except in the wake region so the main function of the buffer source term is to reduce the viscosity effect of the wake flow at the outlet boundary 2 5 boundary conditions the solution procedure of eq 14 15 is similar to that of the conventional n s equation with minor difference in the b c as shown in fig 3 in fig 3 the boundary s v is decomposed into inlet boundary s i n and outlet boundary s o u t according to the viscous effect on each boundary the b c for velocity is shown as follows 18 s w a y u n u y u p s b o d y u n 0 s i n u n 0 s o u t y a w u n u y r c f u p s b o d y u n 0 s i n u n 0 s o u t the b c at the boundary s b o d y is derived from no slip b c at the inlet boundary s i n zero value b c is considered which implies that the flow outside the viscous domain can be treated as potential flow the outlet boundary s o u t adopts the zero gradient b c because the viscosity effect cannot be ignored in the wake region the value of non potential flow velocity is close to zero because we have introduced the buffer source term to reduce the viscosity effect so it is reasonable to use a zero gradient b c here 2 6 estimation of hydrodynamic coefficients the hydrodynamic coefficients are obtained by numerical simulation according to the corresponding model test 2 6 1 oblique towing test in oblique towing test the model is located under a given angle with respect to the flow direction the coordinate system for numerical simulation is shown in fig 4 a schematic of viscous domain is shown as the dashed box in fig 4 the velocity and acceleration are zero in the oblique towing test the corresponding potential flow velocity according to eq 8 and the time derivative term in eq 13 are expressed as follows 19 u p u u p u f t 0 the taylor series expansion of the hydrodynamic force and moment can be expressed as follows feldman 1979 20 f y y v v y v v v v m z n v v n v v v v where v u s i n α u is the incoming flow velocity α is the given pitch angle f y is the hydrodynamic force m z is the hydrodynamic moment and y v y v v n v n v v are velocity hydrodynamic coefficients 2 6 2 pure sway test pmm tests are divided into pure translation and rotation motions to obtain the acceleration hydrodynamic coefficients related to translation and rotation respectively in the pure sway test the model is subjected to a harmonic motion with invariant amplitude and frequency as shown in fig 5 a schematic of viscous domain is shown as dashed box in fig 5 such motion consists of a harmonic oscillation along the y axis and steady motion along the x axis vertical displacement y vertical velocity v and vertical acceleration v for pure sway motion are defined as follows 21 y a s i n ω t v y a ω c o s ω t v y a ω 2 s i n ω t where a and ω are the amplitude and frequency of the submarine with forced harmonic sway motion respectively the corresponding potential flow velocity according to eq 8 and the time derivative term in eq 13 are expressed as follows 22 u p u u p u v u p v f t a ω 2 s i n ω t u p v for the pure sway motion regardless of nonlinear effects the taylor series expansion of the hydrodynamic forces and moments can be rewritten as follows 23 f y y v v y v v m z n v v n v v where y v and n v are the acceleration hydrodynamic coefficients substituting eq 21 in eq 23 and comparing with the fourier integrals carslaw 1921 of the hydrodynamic forces and moments we have 24 f y y v a ω 2 s i n ω t y v a ω c o s ω t f y s i n e s i n ω t f y c o s e c o s ω t m z n v a ω 2 s i n ω t n v a ω c o s ω t m z s i n e s i n ω t m z c o s e c o s ω t where f y s i n e and f y c o s e are the sine and cosine terms of lateral force respectively which are obtained from fourier integral of the numerically computed force time curve m z s i n e and m z c o s e are the sine and cosine terms of yaw moment respectively 2 6 3 pure yaw test in the pure yaw motion the model s center of gravity moves in a sinusoidal path while the model axis remains tangential to the path as shown in fig 6 in this work the model s motion is equivalent to the vertical movement and rotation with incoming flow velocity u as shown in fig 6 the corresponding linear and angular velocities are 25 α α 0 s i n ω t r α α 0 ω c o s ω t r α α 0 ω 2 s i n ω t v u t a n α 0 s i n ω t u x u 1 t a n 2 α 0 s i n ω t 1 2 where α 0 and ω are the amplitude and frequency of the submarine with pure yaw motion respectively in the velocity decomposition method the potential flow velocity is solved with the body fixed frame of o x y z the correspoing potential flow velocity according to eq 8 and the time derivative term in eq 13 are expressed as follows 26 u p u x u p u r u p r f t u α 0 ω 1 t a n 2 α 0 s i n ω t 1 2 s i n α 0 s i n ω t c o s 3 α 0 s i n ω t c o s ω t u p u α 0 ω 2 s i n ω t u p r considering pure yaw motion regardless of nonlinear effects the taylor series expansion of the hydrodynamic forces and moments can be rewritten as follows 27 f y y r r y r r m z n r r n r r ere y r and n r are the acceleration hydrodynamic coefficients substituting eq 25 into eq 27 and comparing with the fourier integrals of the hydrodynamic forces and moments we have 28 f y y r α 0 ω 2 s i n ω t y r α 0 ω c o s ω t f y s i n e s i n ω t f y c o s e c o s ω t m z n r α 0 ω 2 s i n ω t n r α 0 ω c o s ω t m z s i n e s i n ω t m z c o s e c o s ω t where f y s i n e and f y c o s e are the sine and cosine tms of lateral force respectively which are derived from the fourier integral of numerically computed force time curve m z s i n e and m z c o s e are the sine and cosine terms of yaw moment respectively the hydrodynamic coefficients can be estimated by eq 24 28 using least square method the non dimensional hydrodynamic coefficients are shown as follows 29 y v y v 1 2 ρ l 2 u n v n v 1 2 ρ l 3 u y v v y v v 1 2 ρ l 2 n v v n v v 1 2 ρ l 3 y v y v 1 2 ρ l 3 n v n v 1 2 ρ l 4 y r y r 1 2 ρ l 3 u n r n r 1 2 ρ l 4 u y r y r 1 2 ρ l 4 n r n r 1 2 ρ l 5 where l is the model length 3 numerical implementation in the proposed coupling method two sets of meshes are required one is generated as a large domain for solving the potential flow velocity and the other is generated as a small domain for solving the non potential flow velocity information is exchanged between the two sets of meshes by interpolation therefore finding an efficient interpolation method and reducing the interpolation error are the primary tasks in the numerical implementation of the coupling method 3 1 solution procedure fig 7 shows the solution procedure of the present coupling method the finite volume method fvm is chosen for solving both potential flow velocity and non potential flow velocity the potential velocity is obtained by solving the laplace equation in the corresponding domain with the b c the non potential velocity is obtained by solving the complementary n s equation in viscous domain with the corresponding b c after obtaining the solution of potential flow velocity the solution process of the complementary n s equation is almost the same as that of the conventional n s equation because these equations have the same form typically the boundary element method bem chen et al 2016 zhao et al 2018 is implemented for numerically solving the potential theory problems however in our coupling method we need to obtain the potential flow velocity in the viscous domain ω v according to eq 15 and bem method is not efficient for computing the value in the flow field in the solution procedure shown in fig 7 the unit potential flow velocities are obtained before the time loop and just need to be calculated once while the laplace equation and interpolation are included in the procedure of solving the uniform potential flow velocity besides according to eq 8 the linear summation of potential flow velocity u p takes negligible time therefore the time consumed in evaluating the potential flow velocity can be ignored generally iteration is necessary during the coupling between potential and non potential flow velocity in the proposed velocity decomposition method the potential flow velocity is the main component of the flow velocity which affects the non potential flow velocity as a source term see eq 15 the calculated non potential flow velocity determines the force and moment acting on the submarine if the velocity of submarine is computed by forces acting on it instead of forced motion the value of the non slip b c is changed due to the variation in the velocity which in turn affects the value of potential flow velocity field therefore an iteration process is necessary in the present numerical simulation of forced harmonic heaving motion the boundary velocity is specified instead of computing it from motion equations with six degrees of freedom therefore the procedure appears like one way coupling to check the efficiency of the current coupling solver the average central processing unit cpu time for each time step of pure sway case serially running on a computer with 2 3 ghz cpu intel xeon gold 5118 corresponding to different methods were recorded the results are shown in fig 8 in fig 8 the overset mesh method is implemented in starccm software where the mesh size in the background overset region is similar to that in our potential viscous zone the remesh method is implemented with pimpledymfoam solver in openfoam where the remesh 1 and remesh 2 cases are computed with number of meshes similar to that in the viscous zone and potential zone respectively it is clear that our solver requires less computation time and is more efficient than the conventional cfd method 3 2 interpolation algorithm theoretically the potential flow velocity in domain ω v can be obtained by global interpolation after solving the laplace equation in domain ω p however interpolation on the entire domain is time consuming and tends to generate substantial errors according to the linear characteristics of potential flow theory as long as the potential flow velocity on the boundary of the viscous domain is obtained the accurate potential flow velocity in the viscous domain can be obtained by solving the laplace equation therefore we just need to conduct the interpolation on the boundary s v and solve the laplace equation in domain ω v to obtain the potential flow velocity fig 9 shows the interpolation method used in the present work the velocity potential on the boundary s v is interpolated from corresponding cell values in domain ω p the corresponding b c is employed on the body surface that directly depends on the motion mode without interpolation the governing equations in domain ω v can be expressed as follows 30 φ u ω v 2 φ u 0 ω v φ u n 0 s b o d y φ u φ u ω p s v φ v ω v 2 φ v 0 ω v φ v n 0 1 0 n f s b o d y φ v φ v ω p s v φ r ω v 2 φ r 0 ω v φ r n 0 0 1 c f n f s b o d y φ r φ r ω p s v eq 30 and eqs 5 6 7 are the governing equations in domain ω p and domain ω v respectively here fine grids are only needed around the boundary s v in domain ω p because the interpolation is just conducted on this boundary 4 verification study 4 1 verification of accuracy the present method is verified by simulating the flow over stationary and oscillating cylinders at r e 10000 and r e is computed using the in flow velocity u 0 and the cylinder diameter d the simulation of flow over bluff bodies with unsteady reynolds averaged navier stokes urans model has always been a challenge for researchers due to the use of standard logarithmic wall functions for low r e meshes leads to high inaccuracies in this study the mesh is generated with the boundary layer grid size y 1 and the k omega sst turbulence model is adopted with k and ω b c are computed according to stringer s work stringer et al 2014 the dimensions of the domain are shown in fig 10 the spanwise dimension of the domain l z is chosen as l z d π other dimensions are determined by the inlet length l i n which is set as 20 d for potential domain and 5 d for viscous domain as shown in fig 11 the drag coefficient and lift coefficient of flow over the stationary cylinder are compared with experiment data moeller and leehey 1984 gopalkrishnan 1993 and values obtained using cfd method with urans approach stringer et al 2014 in table 1 where c d a v e is average drag coefficient and c l r m s is root mean square of lift coefficient it can be seen that the drag coefficient obtained by the proposed method agrees well with the experiment data but the predicted lift coefficient is significantly different from the experiment data which is similar to the stringer s work stringer et al 2014 this may be caused by the limitation of urans approach in simulating vortex behavior our computed lift coefficient is significantly larger than the stringer s result stringer et al 2014 which may be because we have employed 3d simulation with a different solver the average pressure coefficient c p along the cylinder is shown in fig 12 it is clear that the present method overestimates the magnitude of the minimum pressure on the cylindrical surface as compared to the experiment data which is the reason for the overestimated lift coefficient the forced sinusoidal oscillation in the cross flow is simulated under the condition when the displacement amplitude of cylinder y 0 0 3 d and its oscillation frequency f 0 0 21 u 0 d the average drag coefficient c d a v e and maximum lift coefficient c l m a x obtained by the present method dong s dns method dong and karniadakis 2005 zhao s urans method zhao et al 2012 and experiment gopalkrishnan 1993 are compared in table 2 it is clear from table 2 that the drag coefficient computed by the present method is in good agreement with the experiment data our maximum lift coefficient is higher than the experiment data but is close to simulation results of other studies the time variation of drag coefficient lift coefficient and non dimensional cylindrical displacement are shown in fig 13 it can be observed the time vs lift coefficient curve is almost a pure sinusoidal curve which is consistent with gopalkrishnan s conclusion gopalkrishnan 1993 that the motion corresponding to y 0 d 0 3 and f 0 d u 0 0 21 belongs to periodic lock in situation 4 2 verification of viscous domain size and buffering zone to investigate the influence of viscous domain size and buffering zone on the reliability of the proposed method we change the former by varying the inlet length l i n from 10 d to 1 5 d in the simulation of flow over an oscillation object meanwhile simulations in the absence and presence of buffering zone are conducted for each viscous domain size the width of buffering zone is set as d and 0 5 d for l i n 10 d to 4 d and 3 d to 1 5 d respectively the computed average drag coefficient c d a v e and maximum lift coefficient c l m a x are shown in fig 14 and the velocity contours of total velocity at t u 0 d 100 are shown in fig 15 it is evident in fig 14 that the force coefficients remain almost the same until l i n is reduced to 4 d it can be seen in fig 15 d that the domain size is just equal to the wake width plus width of buffering domain in y direction which indicates that the viscous domain should be larger than the wake width plus the width of buffering zone comparing the results with and without buffering zone in fig 14 it can be observed that the lift coefficient computed with buffering zone is slightly smaller than that without buffering zone and is closer to the experiment value of 1 582 when l i n is less than 4 d the buffering zones do not seem to work this might be attributed to several reasons such as very small buffering zone very small damping constant θ 0 and the advantages brought by the buffering zone are equivalent to its influence on the flow field nevertheless the discussion of buffering zone is meaningless when l i n is less than 4d since the results are unreliable in this situation the non potential flow velocity u n fields with and without bufring zone are shown in fig 16 it is clear that the flow field with buffering zone is smoother and avoid blockage effects around the outlet boundary than that without buffering zone therefore a buffering zone is recommended for better computation accuracy 5 convergence and sensitivity analysis 5 1 mesh and convergence analysis in this study the submarine model suboff with a scale factor of 0 5 is used its geometric parameters are chosen from reference groves et al 1989 and the principle dimensions are listed in table 3 according to the proposed velocity decomposition method two sets of meshes are generated the mesh for the potential domain is generated with trimmed mesher because hexahedral mesh is suitable for interpolation as a background mesh and the mesh for the viscous domain is generated with polyhedral mesher because the polyhedral shaped cells are more robust in the opemfoam simulation the meshes are generated in starccm software and transformed to openfoam with ccm26tofoam tool numerical meshes used in pmm simulation are shown in fig 17 fig 17a shows the mesh of domain ω p which is used for calculating the potential flow velocity therefore the domain size can be large and its mesh is relatively coarse as compared to that of the viscous domain ω v the potential flow velocity on the boundary s v in eq 30 is interpolated from the domain ω p so there exists a refined region around this boundary to ensure the interpolation accuracy the number of mess in the potential domain is 1 1 million fig 17b shows the mesh of domain ω v which moves along with the suboff hull to ensure that the wake region remains located inside the refined zone when the body moves a much finer mesh with larger refinement in the wake zone is used here fig 17c shows the boundary layer mesh system the boundary layer mesh is generated with 5 layers and the total thickness is fixed fig 17d shows the mesh of hull the hull mesh is also dense enough to avoid large aspect ratio in the boundary layer in this study the complimentary n s equation is solved in the domain ω v so the sensitivity of the solution to the resolution of the mesh in this domain should be determined before analysis a mesh with 0 12 million grids is chosen as the initial mesh meshes for the viscous domain were refined using the ratio of 2 in each direction toward the previous mesh three set of meshes with 0 12 million 0 27 million and 0 49 milln grids were adopted in the mesh convergence analysis besides the grid number we also examined the value of hyper parameter y which is the non dimensional distance from the wall to its closest node the value of y affects the accuracy of the numerical predictions here y varies from 30 for the finest grid to 67 for the coarsest one the mesh convergence analysis is focused on force and moment imposed on the hull at 2 and 6 attack angles table 4 summarizes the values of lateral force y and yaw moment m obtained by the mesh convergence analysis it is evident that the results tend to converge with the refinement of the mesh and the force and moment of body remain nearly the same for medium and fine meshes considering the computational cost the medium mesh size was selected for the following simulation 5 2 convergence analysis of domain size in the proposed coupling method the size of domain ω v is determined by the range of viscosity effect we hypothesize that the flow can be treated as pure potential flow on the boundary s v where non potential flow velocity is zero according to the prandtl s boundary layer theory the non potential flow velocity is expected to rapidly vanish when it is away from the body surface besides a buffer source is used in the coupling method to weaken the viscosity effect at boundary s v therefore the theoretical size of the domain ω v can be relatively small the parameters of the viscous domain are shown in fig 18 according to our velocity decomposition theory all the regions with significant viscous effects should be incorporated in the viscous domain including the hull surface and the wake region so the radius of the viscous domain should be greater than the wake amplitude plus the width of the wake and a certain distance should be reserved as the buffer zone therefore the estimated radius of the viscous domain is 1 0 m in terms of wake length selection since the inflow velocity is 0 7 m s the simulated motion period is 5 s and the wavelength of wake is 3 5 m to analyze the development of wake our estimated l d o is 5 m four viscous domains with different parameters were chosen for the convergence analysis the parameters of each domain are listed in table 5 where d2 is the pre estimated domain size the four selected domain sizes are much smaller than the domain size used for a conventional cfd pmm simulation the convergence analysis of domain size is conducted using the proposed coupling method with flow velocity u 0 7 m s harmonic heaving period t 5 s and harmonic heaving amplitude a 0 02 m and a 0 1 m fig 19 and table 6 show the lateral force f y and the yaw moment m z obtained for the convergence analysis of domain size in space fixed frame o ξ η ζ numerical results corresponding to the four domain sizes exhibit a minor difference it is clear that the force and moment acting on the suboff hull are not sensitive to the size of domain ω v around the domain size of d2 which indicates that a relatively smaller domain can be used to improve the computational efficiency 6 numerical application 6 1 simulation of oblique towing test the oblique towing test was numerically simulated to obtain the hydrodynamic coefficients related to velocity the oblique towing test is similar to the resistant test except the model has a fixed attack angle during the test the present coupling method has been validated for resistant test in our previous work zhao et al 2017 in this study a uniform inflow velocity of u 0 7 m s is considered and the attack angle is increased from 0 to 12 in steps of 2 since the suboff hull is xoz symmetrical only half attack angles need to be simulated the velocity fields for each attack angle are shown in fig 20 it is clear that the wake region shifts with the increase in the attack angle there is no viscous accumulation phenomenon on the outlet boundary even though the viscous domain is small and the wake region is close to the side boundary at an attack angle of 12 which proves the effectiveness of our buffer domain strategy fig 21 shows the velocity field of the magnitudes of potential flow velocity u p obtained using eq 8 non potential flow velocity u n obtained using eq 15 and total velocity u derived by assembling the potential and non potential parts for t 10 s it is observed that the non potential flow velocity is not zero around the suboff hull and the wake region where the viscous effects cannot be ignored further the value on the boundary s v fig 21b is almost zero which is consistent with the hypothesis that the flow can be treated as potential flow on the boundary s v the lateral force f y and the yaw moment m z computed at each vertical velocity are presented in fig 22 where the cfd results are obtained from reference toxopeus 2011 and cao et al 2016 in which the suboff model is simulated with a scale of 1 and the incoming flow velocity is 2 76 m s further the experiment data is from reference roddy 1990 these data are fitted with a cubic spline curve the values of the static coefficients y v and n v are determined from the slope of the curve at v 0 so these coefficients computed using the three curves are very close however the values at large attack angles are slightly different which may be attributed to different model scales and reynolds number in the simulation the results computed by the present coupling method cfd method and the experimental data roddy 1990 lin et al 2018 are listed in table 7 the discrepancy between the linear hydrodynamic coefficients calculated by the proposed method and roddy s result roddy 1990 is less than 5 all these results indicate that the present method is adequate for the estimation of static coefficients besides the proposed method uses a much smaller viscous domain than that used in the conventional method 6 2 simulation of pure sway test the pure sway test was simulated to obtain the hydrodynamic coefficients related to linear acceleration in the proposed coupling method the entire viscous domain moves along with the submarine the uniform inflow velocity u 0 7 m s the period t and amplitude a of the forced harmonic sway motion are listed in table 8 6 2 1 interpolation results as discussed in section 3 2 the potential flow velocity is derived by linear summation of unit potential flow velocities that are obtained by the interpolation method to further validate the efficacy of the proposed coupling method the interpolation accuracy should be analyzed in fig 23 25 one quarter of domains ω v and ω p are placed side by side and the values of unit velocity potential are indicated with different colors the velocity potentials φ u φ v and φ r in domain ω v are computed with an interpolated b c according to eq 30 and the unit velocity potentials in the potential domain are computed according to eqs 5 6 7 comparing the velocity potential contour in domains ω v and ω p it is clear that the contour is continuous at the interface of the domains which indicates that the proposed coupling method exhibits minor interpolation errors the unit potential flow velocities are computed by the gradient operation of velocity potential the comparison of the computed velocity contours in domains ω v and ω p is shown in fig 26 28 it is clear that the values of u p u u p v and u p r in the domains ω v and ω p are negligibly different which proves the accuracy of the proposed interpolation method it must be noted that the velocity contour in the potential domain ω p may not as smooth as that in the viscous domain ω v which is because the mesh in the potential domain is relative coarser than that in the viscous domain 6 2 2 analysis of velocity fields the velocity fields of pure sway tests at t 10 s are shown in fig 29 it can be seen that the wake exhibits a sinusoidal form and its amplitude gradually increases as the sway amplitude increases further the wake diverges when the sway amplitude is sufficiently large this is because the incoming flow velocity is small and when the vertical velocity is large the angle between the hull and the related incoming flow is large resulting in a widened wake region the velocity fields at different times for t 5 s and a 0 04 m are shown in fig 30 it is evident that the hull sways along the origin of coordinates o ξ η ζ and the wake develops in a sinusoidal form which is consistent with the expected sway motion described in section 2 6 2 the total velocity is decomposed into potential flow velocity and non potential flow velocity in the proposed coupling method the numerically simulated magnitudes of total velocity field u potential flow velocity field u p and non potential flow velocity field u n are shown in fig 31 it is clear from fig 31a that there is no wake region in the potential flow velocity field the situation is almost opposite for the non potential flow velocity field which is shown in fig 31b the non potential flow velocity is nearly zero except around the hull and the wake region to examine the relationship between non potential flow velocity and viscous effect the contour of vorticity magnitude greater than 0 1 s 1 is presented in fig 32 the region in which the vorticity magnitude is greater than 0 1 s 1 is considered to be the region with significant viscosity effect comparing figs 32 and 31b it is clear that the vorticity contour is similar to the region where the non potential flow velocity is significant which implies that the non potential flow velocity represents the viscosity effect to analyze the flow field in detail the x component of potential flow velocity u p non potential flow velocity u n and the total velocity u were monitored along three representative lines at t 10 s and a 0 02 m the corresponding locations are shown in fig 33 a the velocities along line 1 to line 3 are presented in fig 33 b d respectively fig 33b and fig 33c show the velocity distribution in front of and above the submarine it is evident that the non potential flow velocity rapidly decays to zero when it is away from the body surface which is consistent with the boundary layer theory the velocity distribution in the wake region is shown in fig 33 d it is observed that the viscosity effect still exists in the wake region and the non potential flow velocity is negligible even far away from the body hull the buffer source term of eq 16 works at the buffer region in this region the non potential flow velocity tends to be zero instead of exhibiting periodic oscillation further its value is rather small at the boundary s v which means the flow can be treated as potential flow at the boundary s v 6 2 3 estimated hydrodynamic coefficients hydrodynamic coefficients are estimated according to section 2 6 2 the numerically computed results at each amplitude and period of sway motion are shown in fig 34 fig 34 shows the fitting results according to eq 24 the y axes represent the non dimensional force and moment of the sinusoidal and cosinusoidal part obtained by fourier integration method the x axes denote the acceleration and velocity amplitudes based on eq 24 the slopes of the curves in fig 34 indicate the hydrodynamic coefficients y v n v y v and n v the results obtained by the proposed coupling method cfd method cao et al 2016 potential flow method sahin et al 1997 and previously reported experiments roddy 1990 lin et al 2018 are listed in table 9 the error of y v obtained by the proposed coupling method and roddy s result roddy 1990 is nearly 10 while the error of n v reaches 50 n v is obtained from the sinusoidal part of the yaw moment which is much smaller than the cosinusoidal part generally the numerically computed value of n v should be of the same order of magnitude as the experimental value to meet the engineering requirements pan et al 2012 the error of y v obtained by the present pure sway test is larger than that obtained by the oblique towing test due to following three reasons first the incoming flow velocity remains constant in the pure sway test while it changes with the attack angle in the oblique towing test second non linear terms are ignored in the force expression eq 23 of pure sway test which significantly affects the accuracy of y v third y v is obtained from the damping forces however the proportion of damping force in pure heave motion is smaller than that in the oblique towing test so the accuracy of the analysis is relatively low comparing the present method and the potential method it is clear that the results obtained by the former method are much closer to the experiment data because viscous effect is considered in this method our numerical results indicate that the proposed coupling method is suitable for the estimation of acceleration hydrodynamic coefficients 6 3 simulation of pure yaw test the pure yaw test was simulated to obtain the hydrodynamic coefficients related to angular acceleration cases with different periods t and amplitudes α 0 of yaw motion were simulated which are listed in table 10 the velocity fields corresponding to the pure sway tests at t 10 s are shown in fig 35 it is clear that the wake exhibits a sinusoidal form and its amplitude gradually increases with the increase in the angular amplitude and frequency of yaw motion the vertical motion amplitude y 0 of hull for cases 1 to 4 are 0 023 m 0 046 m 0 040 m and 0 085 m respectively in contrast to the sway motion the wake does not diverge in yaw motion even if the motion amplitude is large this is because the attack angle remains zero during the yaw motio the velocity fields at different times for t 10 s and α 0 4 are shown in fig 36 it is evident that the viscous domain translates and rotates along with the hull further the hull axis is always tangential to the wake trajectory which is consistent with the expected yaw motion described in section 2 6 3 the hydrodynamic coefficients related to rotation are estimated according to section 2 6 3 the results obtained by the proposed coupling method and the experimental data roddy 1990 lin et al 2018 are listed in table 11 the difference between the estimated and experimental roddy 1990 roddy 1990 hydrodynamic coefficients is less than 15 which proves the effectiveness of the proposed coupling method for estimating the hydrodynamic coefficients related to rotation further in the yaw simulation the viscous domain moves along with the hull which indicates that the dynamic mesh method is more efficient and convenient than the conventional cfd simulation method 7 conclusions we presented a velocity decomposition strategy to simulate unsteady submarine maneuverability the proposed strategy was validated using oblique towing test and pmm test the predicted static acceleration coefficients of the submarine model met a satisfactory level of accuracy there are three main features of our velocity decomposition method firstly the non potential flow velocity represents the viscosity effect the viscosity effects are confined to a small domain around the submerged body so the non potential flow velocity is assumed to be nearly zero in the far field and a much smaller computation domain than that used in the conventional cfd method is needed in principle secondly the flow field outside the viscous domain can be treated as potential flow and the inlet and outlet b c for solving non potential flow velocity are fixed as zero value b c and zero gradient b c wherever the submarine moves this implies that the mesh of viscous domain can move with the computed body without deformation and the corresponding movement is not confined in viscous domain therefore the proposed method is highly suitable for the simulation of large amplitude movement thirdly the decomposed potential flow velocity complies with the linear potential theory and the flow field values are linearly proportional to the boundary values this leads to two main advantages a the potential flow velocity can be computed by linear summation of unit potential flow velocities the unit potential flow velocities are obtained from further decomposition of the potential flow velocity according to the mode of body motion b an efficient interpolation methodology can be used in which the required velocity potential can be precisely computed with well interpolated b c instead of interpolating on the entire domain overall our method requires negligible time to evaluate the potential flow velocity and confines the computation of complimentary equation to a small domain that ensures excellent computational efficiency this method is directly applicable for the simulation of sway and yaw motions further the developed solver is potentially useful for motion simulation with six degrees of freedom credit authorship contribution statement j zhao conceptualization methodology software validation r c zhu supervision data curation writing original draft preparation x chen software investigation l hong writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work has been supported by national natural science foundation of china nsfc grant no 51479117 51579147 advance research program of china no 41407010202 and program of state key laboratory of ocean engineering sjtu china no gkzd010071 
