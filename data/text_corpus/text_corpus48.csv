index,text
240,in this work the formation of karstic networks is modeled through the phenomenological stochastic differential langevin equation the solution of this equation follows through the application of the lattice gas cellular automata formalism in terms of spatial and temporal discretization the flow velocity vector is computed using a stochastic dimensionless equation where permeability porosity facies and fracture persistence are the input parameters fluid flow is assumed to follow minimum effort paths in a heterogeneous medium from sinkholes or dolines towards springs the shortest path search is performed using a fast marching algorithm in which fracture persistence is used as a proxy for a velocity field additionally the langevin equation s memory effect allows the coupling of the widening of the conduits with the amount of flowing water taking into account dissolution phenomena as conduits widen more particles tend to run through them this work presents a workflow for the modeling of karst generation in carbonate reservoirs the workflow is applied to the study of an outcrop from jandaíra formation potiguar basin brazil high resolution aerial images of the area scanlines and karst facies stacking pattern of an outcrop near this area are the primary data to define the three dimensional model three feasible scenarios of karstification were generated epigenic hypogenic and hybrid karst as a result 3d karstic networks form considering the regional geology flow conditions and local heterogeneities keywords 3d karstic network langevin equation lattice gas cellular automata fast marching method epigenic karst hypogenic karst 1 introduction the diagenetic processes of karst structures in carbonate rocks by dissolution are responsible for enhancing the porosity of the sedimentary facies and play a distinguished role in creating and distributing vuggy pore space and breccias in carbonate formations consequently well developed highly permeable channels and conduits embedded in low permeability fractured rocks are typical carbonate aquifers ford 1988 presented the main components of a karstic system from a geomorphological viewpoint focusing on the dissolution of carbonates in the erosion zone compared to the deposition region meyers 1988 observed two different patterns of the karstification process the classic karst confined or pipe shaped is dominated by the widening of bedding planes and joints generally resulting in large caves and preferential flow passages on the other hand diffuse karstification patterns occur when the dissolution process happens at intergranular pores small cavities and irregular veins numerical modeling of flow and transport in karstic systems remains a challenge due to the high contrast in the hydraulic properties at a microscopic spatial scale specifically at the borders between conduits fractures and rock matrix thus predicting groundwater flow directions may be challenging since due to anisotropy and the presence of conduit systems it may not be perpendicular to equipotential lines the review article of hartmann et al 2014 introduces karst its evolution and its particular hydrological processes they discussed the limitations of current karst models and showed challenges regarding data availability and its information content the works studying karst structure are generally based on geostatistical models data calibrated models and speleogenesis models firstly geostatistical models such as collon et al 2017 computed statistical metrics to characterize the geometry and the topology of 34 karstic networks jouves et al 2017 built a 3d numerical database from 26 caves statistical analysis was used to calculate eight morphometric cave descriptors four geometric parameters width to height ratio tortuosity curvature and vertical index and four topological parameters degree of node connectivity graph indices and ramification index data calibrated models are adopted in mohammadi illman 2019 two synthetic karst aquifers with branchwork and network conduit patterns bcp and ncp are used to explore hydraulic tomography s ability to detect karst conduit patterns under steady and transient conditions berglund et al 2020 used the finite element subsurface flow model to simulate the conduit connection between a sinking stream and a spring in central pennsylvania a sensitivity analysis of 52 parameter combinations for four conduit geometry scenarios was carried out using the latin hypercube method andrade gómez et al 2019 proposed a regional conceptual model for the aquifer structure of the ring of cenotes on the yucatan peninsula mexico the apparent resistivity distribution is interpreted based on electrical resistivity tomography to calibrate hydrogeological models borghi et al 2016 described two numerical experiments the first experiment considers the influence of geometry and topology of the karst conduits on the network the models are generated using the pseudo genetic algorithm developed by borghi et al 2012 the second experiment investigates the capability of an inverse analysis algorithm such as doherty et al 1994 to retrieve optimal physical parameters of a 3d model with karst conduits modeled through 1d pipe elements with non linear flow dynamics fischer et al 2017a b proposed a new method called cellular automata based deterministic inversion cadi it permits a deterministic inversion based on a bayesian approach and uses dynamic optimization to generate different linear structures subsequently fischer et al 2017a b used cadi to distribute hydraulic properties in the flow conduits and iteratively modify the network s structural geometry to progressively match a set of multi borehole hydraulic tests these tests were collected from a hydraulic tomography experiment conducted at terrieu field in the lez aquifer southern france recently fischer et al 2018 applied cadi to image the spatial heterogeneity of the hydraulic properties hydraulic conductivity and storage coefficient based on harmonic pumping tests in a karstic field located near montpellier southern france wang et al 2016 collected geological and hydrological data in a confined carbonate aquifer located north of montpellier they constructed a 2d equivalent porous medium model to represent the test site domain the available hydraulic head data recorded at 22 boreholes during 8 sequential cross hole pumping tests were used to solve an inverse problem alternatively the double continuum approach kordilla et al 2012 defines karst systems heterogeneity through two interacting continua one for the matrix and another for the karst conduits the continua exchange water using a linear exchange term according to their water levels finally speleogenesis models such as de rooij graham 2017 proposed a hydrochemical model with an implicit reactive transport scheme to generate realistic karstic networks this speleogenesis model when applied to a karst region in florida usa avoids numerical saturation of calcite and allows for coarser conduit cells the approach proposed by jaquet et al 2004 is based on modified lattice gas automation in which walkers with a certain erosion potential travel through the medium the initial rock body is assumed to contain connected discontinuities fissures fractures etc in their work the more heavily fissured zones are first attacked and conduits are formed rapidly within these zones the larger the conduit the more the following particles tend to select these conduits which is called the memory effect thus the size of a given conduit depends on the number of particles passed through it particles gradually consume the rock along preferential pathways creating a heterogeneous network of conduits in the methodology presented in lafare 2011 conduits are generated using a heuristic erosion potential function depending on flow velocities and water ages borghi et al 2012 use a pseudo genetic approach in which a 3d map of conduits is eroded along minimum effort pathways computed by a fast marching algorithm fma the tracks of the particles are stored via an indicator function used to update the initial velocity field iteratively indicator functions describe the class of heterogeneity present in the model fractures bedding planes matrix aquitard etc pardo igúzquiza et al 2012 presented an efficient method for conditional and non conditional stochastic simulation of karst conduit networks the authors adopt a resampling method for generating conduit geometries from templates and a modified diffusion limited aggregation method for network topology generation following the work in stark 1991 ronayne 2013 proposed a non looping invasion percolation model to evaluate the advective solute transport in synthetic karst systems with 3d branching networks advective transport behavior within the velocity field is quantified by analyzing the distribution of solute particle travel times henson et al 2018 used a process based approach to generate karstic conduits based on a speleogenesis model applied to silver springshed in central florida usa de rooij graham 2017 a sensitivity analysis was carried out by using the morris method in this work karstic networks formation is modeled through the langevin equation by applying the lattice gas cellular automata formalism in spatial and temporal discretization in the reference work of jaquet et al 2004 the model s velocity field is deterministic and assumed to be known the flow velocity vector is computed stochastically in our new proposition depending on geological properties such as permeability porosity facies and fracture persistence also fluid flow follows minimum effort paths in a heterogeneous medium from sinkholes or dolines towards springs the fast marching algorithm is used to find the shortest path between sinkholes springs configurations in which fracture persistence is used as a proxy to compute the velocity field our work differs from borghi et al 2012 in the use of indicator functions to create contrasts between the different hydrogeological features fractures and bedding planes are more conductive high velocity than the matrix low velocity aquitard formations have very low velocity additionally based on the work of jaquet et al 2004 a memory effect introduced in the langevin equation allows coupling the widening of conduits with the amount of flowing water a three dimensional model was built with data collected from jandaíra formation potiguar basin brazil high resolution aerial images of lajedo arapuá scanlines and the karst facies stacking pattern were obtained from quadros 2019 three karstification scenarios were generated epigenic hypogenic and hybrid karst as a result a realistic 3d karstic network forms considering the regional geology flow conditions and local heterogeneities our novel methodology combining the langevin equation the lattice gas cellular automata and the fast marching method permits the analysis of the most important phenomena in karst diagenesis our lattice gas cellular automata implementation solves the langevin equation by defining a stochastic rule of evolution composed of two parameters the first one is related to the flow velocity and the second one is to the random vector consequently the state of a cell evolves depending on neighbor cells values of velocity and random vector fluid flow is determined stochastically depending on geological properties such as permeability porosity facies and fracture persistence the particle tracking determined by the fast marching method depends on the persistence field between recharge and discharge points additionally heterogeneities and dissolution are taken into account through fracture persistence and conduit opening updates as the karstification process occurs epigenic hypogenic and hybrid karstification processes are simulated to generate complex network scenarios 2 methodology of the stochastic modelling for karstic network diagenesis the langevin stochastic differential equation is used to simulate fluid transport using a random walk type stochastic process the basic idea for modeling the formation of karst geometry is to solve the langevin equation by applying the lattice gas cellular automata lgca formalism in terms of spatial and temporal discretization based on the assumption that water and karst conduits follow the path of minimum effort between entrances and exits path search is performed using the fast marching method fmm sethian 1996 1999 2001 the particle follows the shortest path and corrodes the model as in jaquet et al 2004 the resulting path becomes one of the karst conduits figure 1 shows the workflow for the generation of karstic conduits using the langevin equation the lattice gas cellular automata and the fast marching method fmm our simulation starts with the definition of initial conditions such as porosity facies permeability fracture opening and the model s persistence field then based on the location of outlet points the fmm determines the time map which defines the time required by particles to travel from everywhere in the domain to the outlet locations consequently particle tracking is carried out to determine the shortest path from the dolines or inlet points to the springs or outlet points thus the particle travel time is computed the direction of the velocity field in the langevin equation is then obtained stochastically from the lattice gas cellular automata based on geological parameters consequently the particle gives its first jump the second jump given by the random vector in the langevin equation is determined stochastically from the lattice gas cellular automata based on fracture opening and the persistence field the memory effect applied in the langevin equation allows the coupling of conduit widening with flowing water considering dissolution phenomena this procedure is executed for each particle in the domain until all time steps are simulated the following subsection provides a detailed description of the methodology 2 1 langevin equation a stochastic process of the random walk type can be applied to solve the transport equations such a process corresponds to a lagrangian representation of the formation of karstic networks i e karst evolution is described by the displacement of particles as a function of time this description can follow by the stochastic differential equation of langevin jaquet 1995 one consequence of the spatial and temporal dependence of the opening sizes of fractures and karstic conduits is that the langevin equation becomes non linear which precludes its solution using analytical methods therefore applying the langevin equation to the modeling of karstic networks requires a numerical method this work proposes solving the langevin equation through the lattice gas cellular automata formalism in spatial and temporal discretization the discrete form of the langevin equation 1 is the following jaquet et al 2004 1 x n 1 i λ j λ k λ x n i j k v i j k δ t n w n i j k λ where i j k represent the lattice discretization indices of direction x y and z respectively v i j k is the flow velocity vector computed stochastically in equation 3 w n i j k is the random vector and λ the spacing of the lattice m for each time step n the particle can move up to two times the lattice spacing the first jump is related to the flow velocity and the second one to heterogeneity and dissolution the memory effect is solely directional the particles tend to follow previous trajectories with a constant displacement value the values of the random vector w n i j k are computed probabilistically the directional probability is proportional to the cubic value of the neighboring conduit diameters this choice is based on poiseuille s law where transmissivity and fracture opening are linked through a cubic function as shown in equation 2 witherspoon et al 1980 2 w n i j k 1 a i j k θ n i j k 3 c 1 s 1 a i j k θ n c i j k 3 w i t h θ n c i j k θ c i n i i j k i n p n c i j k where a i j k is the fracture persistence m 2 θ c i n i i j k is the initial opening m of conduit c i is the increase in the opening m per passage n p n c i j k is the number of passages of particles at time n for a conduit c and θ n c i j k is its updated opening the persistence field introduced here relates the medium s initial heterogeneity to conduit geometry the memory effect allows the coupling of conduit widening with the number of particles as the conduits widen more particles run through them which defines the relationship between water flow and conduit size the flow velocity is assumed to be large enough to allow neglecting the effects of saturation more specifically conduit widening occurs when the number of passages of particles n p n c i j k in a cell increases the number of passages of particles multiplied by the gradient i updates the conduit opening 2 2 lattice gas cellular automata in general the cellular automata method comprises a grid of points a neighborhood a global state and a set of rules for evolution the grid represents the geometric part associated with the automaton one of the fundamental properties of cellular automata is the cells location each cell can only interact with a finite number of neighboring cells i e moore s and von neumann s neighborhood the third property of the cellular automaton is the state associated with the cell this property is in fact the differential of the cellular automata method to other more sophisticated techniques such as lattice gas cellular automata and lattice boltzmann because the state associated with the cell can be binary discrete or continuous the formal definition of the cellular automata ends with the rules of evolution these rules define how the state of a cell can evolve depending on the state of neighboring cells the evolution rules can take a stochastic or deterministic form depending on the modeled system when considering the automaton as a dynamic entity an evolution step is the state update from its neighboring configuration the objective of the computational method presented below is to use cellular automata in solving fluid flow problems and modeling the formation and evolution of karst structures it is based on the model developed by planteblat 2013 the reference work uses the cellular automata to model the diagenetic flow and its effects on geological formations mineralogical composition and petro physical properties a cloud of particles of unit mass and zero dimension with the capacity to move between centroids defines the cell state the model presented here does not consider one of the fundamental principles of physics that two particles can not occupy the same position simultaneously likewise the equations for conserving linear momentum and continuity fundamental to lattice boltzmann s method are not satisfied finally the rules of evolution complete the model of cellular automata the translation of a particle depends fundamentally on the permeability porosity and facies of the medium the nature of the gas particles that coexist in the grid defines the cellular automata system s evolution the starting point of the analysis is understanding the system and each parameter s influence on the particle trajectory for example porosity influences the particle trajectory as higher porosity implies less resistance to the movement of gas particles and defines a preferential path the karstic model differs from the lattice gas approach used in hydrodynamics as no direct interactions between particles occur hence no exclusion principle holds on the lattice collisions between particles are replaced by probabilistic interactions of particles with the same trajectory of predecessors consequently particles tend to jump probabilistically towards the largest opening fissure or conduit our lattice gas cellular automata implementation solves the langevin equation by defining an evolution rule composed of two stochastically determined parameters equation 1 the first one is related to the flow velocity v i j k equation 3 and the second one to the random vector w n i j k equation 2 consequently the state of a cell evolves depending on neighboring cells values of velocity and random vector 2 3 fast marching method fmm the flow velocity vector is also computed stochastically firstly by taking into account the state of the neighboring cells and secondly selecting a specific adjacent cell by a uniformly distributed integer random number generator the flow direction of particles depends on permeability porosity facies and the arrival time computed from the fmm as shown in equation 3 3 v i j k ω l ω k k i j k ω ϕ ϕ i j k ω f f i j k ω t t i j k where k i j k is the permeability φ i j k the porosity f i j k the facies parameter ω k ωφ ω f are tunning parameters which describe the relative influence among the geological parameters ω l are the geometrical weights of the lattice as defined in equation 4 4 ω l 1 3 l 0 ω l 1 18 l 1 7 ω l 1 36 l 8 18 the magnitudes of the weights are computed following the scheme of d3q18 used in three dimensional cubic lattices as in the work of xia et al 2018 the parameter t represents the particle travel time computed from the fast marching method the conduits are assumed to follow minimum effort paths in a heterogeneous medium from sinkholes or dolines toward springs the shortest path search follows the fast marching method fmm sethian 1996 1999 2001 the open source fmm implemented by tommy hinks https github com thinks fast marching method was coupled to the implemented automata cellular algorithm to represent a probabilistic karst model we use a proxy to mimic the final result mature system without modeling the physical and chemical processes the proxy is based on the assumption that water and thus karst conduits will follow the minimum effort path i e the most convenient path between inlets and outlets fracture persistence is used as a proxy of a velocity field for each simulation of the fracture network our work differs from borghi et al 2012 in the use of indicator functions to create contrasts between the different hydrogeological features fractures and bedding planes are more conductive high velocity than the matrix low velocity aquitard formations have very low velocity this persistence proxy indicates that the greater the persistence the higher the velocity field in a homogeneous medium it would be a straight line between sinkholes and the spring the fmm is a front propagation algorithm thus spring s i e known outlet s of the aquifer is used as a starting point for the propagation algorithm the velocity of front propagation at any point in the domain is given initially by the persistence field the result of the fmm is a 3d map of front arrival times from outlets to any point in the domain the next step consists of using the set of starting point locations to compute the inlet path to the outlet by following the time map gradient for each point in this set in this way the algorithm performs particle tracking from the sinkholes or dolines towards the springs the particle follows the shortest path and corrodes the rock as in jaquet et al 2004 the resulting path becomes one of the karst conduits 2 4 methodology validation figure 2 shows an example in which there are regions with different permeability values representing an inclined fault the 2d model top down viewed has 100 100 cells the blue colored region has zero permeability green 0 05 m s and red 0 1 m s the particles are located at the lower left edge z 0 20 with a constant flow velocity direction v 1 0 0 0 it is observed that particles flow in the direction of maximum permeability the memory effect of the particles that tend to follow the previous ones is shown additionally the implemented bounce back algorithm shows its capabilities to simulate fluid flow with obstacles the particle counter indicates the preferential path of the fluid by showing which cells have received more particles figure 3 shows a 3 layer model with different fracture persistence values 1 5 and 10 particles are initialized along the right edge of the model and the preferred flow direction is horizontal v 1 0 0 0 as expected the memory effect applied by the random vector through the persistence and opening of the conduit causes more particles to tend to flow in this direction the generation of preferential flow channels increases with fracture persistence particles flow preferentially at the boundaries between layers due to the memory effect in other words particles near the interface tend to flow towards the region with greater persistence and consequently other particles are attracted to this region to validate the inclusion of the fast marching method fmm to determine the shortest path between dolines and springs several examples are presented figure 4 shows a model in which the spring or exit is located in a cell at the lower left edge and the initial propagation field passed to the fmm is constant throughout the model the arrival time shows the time needed to arrive at the exit from any point in the domain subsequently the particles are inserted into a cell on the upper right edge of the model the shortest flow path is shown in figure 4 figure 5 shows a model in which the spring or discharge is located in a cell in the middle of the left edge and the initial propagation field passed to the fmm is constant throughout the model the arrival time shows the time needed to arrive at the exit from any point in the domain subsequently the particles are inserted along the right edge of the model the shortest flow path and the particle counter are shown in figure 5 3 application 3 1 lajedo arapuá jandaíra formation potiguar basin brazil the potiguar basin is located at the brazilian equatorial margin covering the state of rio grande do norte and part of ceará araripe feijó 1994 formalized the lithostratigraphic units of the potiguar basin in an integrated work according to these authors the jandaíra formation comprises bioclastic grainstones green algae mudstones with root marks mudstones wackestones with fenestras and contraction cracks are possibly present pessoa et al 2007 present an updated version of the potiguar basin stratigraphic chart they illustrate the main tectonic sedimentary events in geochronological order the carbonate sedimentation of the jandaíra formation occurred between the turonian and campanian ages it represents the implantation of the marine system after the drift of the south american and african continents this formation outcrop is an extensive plateau intensively eroded and karstified quadros 2019 lajedo arapuá or apodi 4 according to bisdom et al 2017 is located in the southwestern portion of the potiguar basin near the county of dix sept rosado as shown in figure 6 a it is a remarkable outcrop of jandaíra formation affected by intense fracturing in orthogonal patterns and karst features associated with these fractures based on information from several outcrops in the region and samples from oil wells drilled in the area cordoba 2012 characterizes the various depositional facies of the jandaíra formation the lithofacies described by this author are mudstones to wackestones with restricted biota wackestones to oncolytic packstones mudstones with birdeyes and mudstones with algal lamination the mapping of the fracture networks in the area apodi 4 was carried out in a multiscale approach combining uav imagery and measurements at the outcrop surface bisdom et al 2017 as shown in figure 6 b this area presents natural fractures in an orthogonal pattern with pre karstification openings between 0 and 0 28mm these authors estimated this range of openings based on the barton bandis model in order to simulate subsurface conditions equivalent to a burial of 2 5 to 3 0 km in the potiguar basin reis et al 2013 it was considered constant jrc 15 jcs 120 mpa maximum horizontal stress of 30 mpa young s modulus of 50 gpa and poisson s ratio of 0 3 in quadros 2019 eight scanlines were used to measure the structural features of the lajedo arapuá as shown in figure 6 b building a three dimensional model requires a horizontal data source in this case the lajedo arapuá surface map figure 6 b and a vertical data source represented by the tijubina outcrop figure 7 described in the work of quadros 2019 in terms of depositional facies and karst features figure 7 shows the stacking of facies on the outcrop a the schematic vertical stacking b and the two faciological frameworks c the tijubina outcrop is an exhibition of the jandaíra formation with approximately three meters of thickness the classification of carbonate rocks by terra et al 2010 was the basis for describing the depositional facies crystalline limestone clayey mudstone silty mudstone and tufa are the lithofacies recognized in a macroscopic description by quadros 2019 according to the classification proposed by terra et al 2010 and shown in figure 7 additionally karst features have been described qualitatively in terms of the intensity of dissolution the features of the intense karst dissolution of the tijubina outcrop are predominantly associated with horizontal discontinuities bedding planes with a total of eight intensively dissolved horizontal surfaces are identified table 1 presents the porosity and permeability values considered in this work based on quadros 2019 statistics for fracture openings from the scanlines show maximum and minimum values between 10 mm and 620 mm see table 3 quadros 2019 on the other hand the work of bisdom et al 2017 presents values between 0 and 0 28 mm for the openings of the discontinuities of lajedo arapuá there are two main reasons for this difference i the opening measures from the scanlines reflect an extension of the fractures due to the karstification process not considered in the work of bisdom et al 2017 ii the estimate of openings by bisdom et al 2017 considers a burial of around 3 km and currently the jandaíra formation is exhumed under the surface stress regime therefore as the purpose of this work is to model the karst features a priori it was assumed that the openings of the joints and stylolites proposed by bisdom et al 2017 refer to the pre karstification period see table 2 based on the scanlines from quadros 2019 the fracture intensity map p21 shown in figure 8 is used considering the following aspects the conceptual model of more significant fracturing in the presence of vegetation and the range of fracture intensity values in the domain of scanlines 3 2 model description based on the model developed in quadros 2019 the geological model was built considering the lajedo arapuá grid map of 200 m by 200 m and the vertical thickness of 2 5 m tijubina outcrop in this way it was possible to build cells with horizontal dimensions of 2 m by 2 m i x j and variable vertical thickness the number of cells i x j x k was 116 104 30 and the total number of cells was 361920 the 3d model geometry and initial values of depositional facies karst features porosity permeability and fracture intensity p21 were taken from quadros 2019 the boundary conditions defined at the model borders impose zero particle flux the three dimensional framework of facies and fractures with their respective permeability properties was based on constructing models of epigenic hypogenic and hybrid processes for the generation of the epigenic karst model the concept of variation in the phreatic level was considered a primary dissolution control factor at horizontal levels therefore three hypothetical times t1 t2 and t3 were considered representing a progressive lowering of the water table from t1 to t3 the infiltration points at time t1 were selected in regions with high fracture density where vegetation was present for the definition of the infiltration points of time t2 and t3 in addition to the information on regions of intense fracturing it was possible to use the skeleton generated in t1 and t2 respectively to determine some infiltration points the discharge point was positioned in the southern part of lajedo arapuá where the apodi river currently exists the hypogenic karst model considers that upward fluid flow is the process responsible for the rocks dissolution for this scenario multiple deep recharge points were defined at a 2 5m depth in the southwest of lajedo arapuá the work of quadros 2019 considers one recharge point and one discharge point here two shallow discharge points were placed on the surface to the northeast where intense fracturing was identified by the vegetation as shown in figure 8 another possible scenario is the occurrence of the two karstification processes together simultaneously or not this process is called superposed or hybrid karstification in which epigenic karst occurs preferentially on the surface while hypogenic karst tends to be a more critical process after burial therefore when considering a carbonate oil reservoir it is expected that throughout the geological evolution of the formation it is most likely is that the two karstification processes have occurred this scenario represents the superposition of the two processes previously modeled 3 3 results 3 3 1 epigenic karst model for the generation of the epigenic karst model the water table variation was considered a primary factor for controlling dissolution at horizontal levels therefore three hypothetical times t1 t2 and t3 were considered for this scenario representing a progressive lowering of the water table from t1 to t3 the infiltration or recharge points were defined in regions with high fracture intensity where vegetation was present the exfiltration or discharge point was always positioned in the southern part of lajedo arapuá where the apodi river currently exists quadros 2019 the simulation of the epigenic skeleton for time t1 was performed from this information as shown in figure 9 a our simulation estimates the path with the lowest transit time for particles between recharge and discharge points vertical downstream channels develop first and then horizontal conduits are generated to reach the exfiltration point at the discharge depth additionally figure 9 a shows the opening values θ c after the karst network s dissolution process through equation 2 the final opening for each cell is obtained as a function of the number of particle passages during the simulation at the end of the simulation cells are filtered to highlight those that have received more particles subsequently voxels are created from the centroid of the filtered cells and their color represents the magnitude of the final opening since the filter is a function of the number of particle passages isolated voxels can be observed thus stochastically multiple particles coming from the same cell can choose different neighbor cells then when the filter is applied neighbor voxels can be neglected because they do not meet the criterion of the filter for the definition of the infiltration points of time t2 in addition to the information on regions of intense fracturing it was possible to use the skeleton generated in t1 to determine some infiltration points the simulated skeleton for the second lowering of the water table t2 is shown in figure 9 b characteristic of epigenic karst the dissolution process creates vertical channels until the discharge depth is achieved thus fluids flow horizontally to the exit region the infiltration and exfiltration points for t3 the final time in the lowering of the water table followed the same criterion as in time t2 figure 9 c illustrates the hypothetical skeleton of epigenic karstification for time t3 similar to the simulated karst of the water table lowering vertical downflow channels and horizontal channels can be observed additionally in figure 9 b and c the opening values θ c after dissolution are shown green arrows indicate the recharge point location whereas orange ones highlight discharge points the epigenic skeleton for times t1 t2 and t3 and the opening values θ c after karst network generation are shown in figure 10 green arrows indicate recharge point locations whereas orange ones highlight discharge points 3 3 2 hypogenic karst model the hypogenic karst model considers that the process responsible for promoting rock dissolution is upwards fluid flow for this scenario multiple deep recharge points were defined at southeast lajedo arapuá at 2 5m two shallow discharge points are located on the northeast surface where intense fracturing is identified by the presence of vegetation quadros 2019 the skeleton of the hypogenic karst shown in figure 11 a presents long flow channels the channels reach the surface level generate wide horizontal channels to reach the exfiltration points furthest from the recharge points figure 11 b shows the top view and the opening values θ c after the dissolution process generated the karst network green arrows show recharge points whereas orange ones highlight discharge points 3 3 3 hybrid or superimposed karst model superposed or hybrid karstification considers the occurrence of the two karstification processes simultaneous or not epigenic karst occurs mainly on the surface while hypogenic karst tends to be more important after burial this scenario represents the union of the previously modeled processes and their combined architecture is shown in figure 12 figure 12 shows the aperture values ap after the dissolution process generated the karst network for three different steps figure 12 a shows the skeleton and of the karst network openings along 15 time steps for the epigenic karst vertical channels with the descendant fluid flow are present the hypogenic karst shows vertical conduits but in the opposite direction for time step 60 illustrated in figure 12 b particles have reached discharge points creating vertical and horizontal channels in the epigenic karst in contrast only vertical upflow channels show by hypogenic karst as expected increasing the number of steps leads to further dissolution consequently wider conduits are generated see figure 12 c for the evolution of the hybrid karst along 200 time steps horizontal superficial channels are created from further recharge points to the discharge point in the hypogenic karst broader horizontal and vertical conduits can be observed in the epigenic karst green arrows show recharge points whereas orange ones highlight discharge points 4 discussion this section brings a parametric analysis of the main factors influencing the karst network generation figure 13 presents the diagenesis of an epigenic karst network at the top of the model seven recharge points and one discharge point at the bottom right side of the domain are defined the discharge point was positioned in the southern part of lajedo arapuá where the apodi river currently exists the infiltration or recharge points were selected in regions with high fracture intensity quadros 2019 an initial fracture opening of 0 15 mm is set in all cells values for facies permeability porosity and persistence are the same as those in the previous models in this case geological parameters influence is ignored by setting zero to the weights in equation 3 instead the diagenesis of the karst network is controlled by fracture persistence described in equation 2 in figure 13 a long vertical channels flowing downstream can be observed additionally at spring depth horizontal conduits drive the fluids to the discharge region the top view of the resulting karst network is shown in figure 13 b illustrating the aerial channel distribution the opening values shown in figure 13 reflect the significant effect of the dissolution process in karst network generation where a maximum opening of 11 mm is obtained for the initial opening value of 0 15 mm the number of cells in x y z axis are constant for all the parametric analysis 116 104 30 respectively the green arrows show recharge points and the orange ones highlight discharge points all of the following simulations have the same recharge and discharge points locations 4 1 facies the effect of the depositional facies in the resulting karst network is shown in figure 14 the parameter ω f in equation 3 tunes the predominance of the facies concerning the other geological parameters two cases with facies weight parameter of value 1 and 10 were analyzed the remaining weights of the other geological parameters in equation 3 are assumed negligible in terms of the karst network geometry in figure 14 a compact and well defined channels are observed compared to figure 14 b and c as the effect of depositional facies effect increases more dispersive channels develop the drop in particle probability causes this effect to take the shortest path due to the widespread distribution of the facies values see table 1 therefore maximum openings of 3 5 mm to 1 75 mm can be visualized in figure 14 b and c compared to 11 mm in figure 14 a 4 2 permeability figure 15 exhibits the effect of permeability on karst network generation permeability weights ω k with values 1 and 10 were considered in equation 3 for this sensitivity analysis the effect of the other geological parameters is neglected dispersion in permeability values reduces particle probability to take the shortest path between recharge and discharge points as its influence is enforced consequently diffuse channels can be appreciated in figure 15 b and c compared to the delineated conduits seen in figure 15 a additionally karst network opening is reduced as the distribution of the permeability values assumed at pre karstification is not aligned with the shortest path between the recharge and discharge points constant values are established for each depositional facies see table 1 subsequently narrower channels 2 1 mm to 1 75 mm can be identified in figure 15 b and c unlike the broader conduits 11 mm from figure 15 a furthermore the permeability effect on the resulting karst geometry is more pronounced than the facies effect due to its higher heterogeneity consequently multiples paths can lead to the spring 4 3 porosity the influence of rock porosity on the generation of karst networks can be seen in figure 16 similar to the results shown in figure 14 and figure 15 dissemination of the parameter values assumed at pre karstification see table 1 creates highly diffusive channels due to misalignment with the shortest path between dolines and springs as the probability of the particle choosing the shortest path reduces stochastically different courses can be taken to reach the discharge point therefore thinner channels 2 1mm to 1 75 mm can be observed in figure 16 b and c in comparison to those displayed in figure 16 a 11mm 4 4 initial opening of fractures to study the effect of the initial opening of fractures θ c in the resulting karst network a sensitivity analysis of this parameter in equation 2 is proposed a constant initial fracture opening 0 15 mm was considered in the entire model for the results obtained in figure 13 based on the pre karstification values depicted in table 2 two scenarios for joints and stiolites opening values were attributed using the normal distribution as illustrated in figure 17 b and c respectively compared with the results in figure 17 a wider conduits are generated when the distribution of the opening values assumed at pre karstification has maximum values between 0 25 mm to 0 28 mm along the shortest path between the recharge and discharge points consequently the probability of following the shortest path increases maximum opening values obtained after the dissolution process are higher 28 mm and 22 mm as shown in figure 17 b and c compared to those displayed in figure 17 a 11 mm this difference can be justified by the initial opening value of 0 15 mm assumed in the analysis of figure 17 a in contrast to maximum values between 0 25 mm to 0 28 mm admitted for the simulations shown in figure 17 b and c additionally when comparing the numerical results with the statistics obtained from the scanlines measured on the lajedo arapauá see table 3 maximum opening values from figure 17 b and c 28 mm and 22 mm belong to the range of opening values observed on the field for joint and stylolites 4 5 fracture intensity the effect of the fracture intensity for the distribution summarized in table 4 is shown in figure 18 three scenarios are simulated the first one is based on the data extracted by quadros 2019 in the p21 map shown in figure 8 from the area called lajedo arapuá jandaíra formation potiguar basin brazil cases 2 and 3 are synthetic cases varying the mean and standard deviation of the first case the karst network geometry is very sensitive to the distribution of fracture intensity values when comparing figure 18 a with figure 18 b and c the shortest path between the recharge and discharge points is followed closely when the intensity configuration of the second and third cases is taken into account as shown in figure 18 b and c similar to case 1 figure 18 a compact and well defined channels can be observed however wider channels 16 mm are seen in figure 18 b showing a different solution to the thinner conduits 11 mm interpreted from figure 18 a 5 conclusion this paper develops a new methodology to simulate the generation of 3d karstic networks it combines the langevin equation the lattice gas cellular automata and the fast marching method the stochastic computation of the velocity field in the langevin equation is a novelty considering geological parameters such as permeability porosity persistence and depositional facies furthermore the so called feedback loop kiraly 1997 which implies widening conduits due to dissolution is considered following borghi et al 2012 our methodology performs particle tracking starting from the sinkholes or dolines towards the springs by estimating the shortest path numerical results obtained with the proposed methodology demonstrated its capability to simulate complex karst diagenesis using field data such as high resolution aerial images of the area scanlines and the karst facies stacking pattern from the application area additionally the memory effect applied by the random vector through persistence and conduit opening established that the higher the persistence of fractures the more preferential flow channels are generated estimation of the shortest path between the recharge and discharge points was validated through 2d and 3d models our methodology was applied to study the diagenesis of karstic networks in the area called lajedo arapuá jandaíra formation potiguar basin brazil the construction of three dimensional models of epigenic hypogenic and hybrid or superimposed karst was carried out by considering depositional facies karst features porosity permeability and fracture intensity p21 taken from the work of quadros 2019 the concept of variation in the water table was successfully incorporated in the methodology as a primary factor for controlling dissolution at horizontal levels in the epigenic karst model the resulting hypogenic karst presented here can consider multiple recharge and discharge points allowing to model complex and realistic karstification processes the possibility of both karstification processes hybrid karst simultaneous or not is included in our methodology this feature is relevant for modeling the diagenesis of karstic networks in carbonate oil reservoirs where hybrid karstification processes take place the main geological characteristics influencing karst network generation such as porosity permeability depositional facies and fracture intensity were studied greater spatial distribution of the parameter values assumed at pre karstification creates thicker diffusive channels due to its misalignment with the shortest path between dolines and springs subsequently narrower channels can result after the dissolution process takes place additionally maximum opening values computed numerically belong to the range of opening values observed on the field for joint and stylolites obtained from the scanlines measured on the lajedo arapauá the karst network geometry is very sensitive to the distribution of fracture intensity values however the shortest path between the recharge and discharge points is followed closely for a non constant intensity configuration finally this work provides a better understanding of the generation of karstic networks simulating realistic scenarios efficiently the results of this methodology can be used in inverse analysis to iteratively modify the network s structural geometry to match a set of multi borehole hydraulic tests progressively moreover the generated networks can be used to simulate flow and transport additionally our methodology can be applied jointly with groundwater modelling techniques to solve surface pollution issues furthermore the oil production of carbonate reservoirs can be optimized by considering the developed karstic networks in reservoir simulations credit toxonomy conception and design of study r g escobar d roehl acquisition of data f b quadros c l cazarin analysis and or interpretation of data r g escobar drafting the manuscript r g escobar revising the manuscript critically for important intellectual content d roehl f b quadros c l cazarin approval of the version of the manuscript to be published the names of all authors must be listed r g escobar d roehl f b quadros c l cazarin declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was carried out in association with the ongoing r d projects registered as anp no 20329 9 modicarste puc rio petrobras anp sponsored by petrobras under the anp r d levy brazil as compromisso de investimentos com pesquisa e desenvolvimento and the brazilian national council for scientific and technological development cnpq under grant no 308547 2016 0 
240,in this work the formation of karstic networks is modeled through the phenomenological stochastic differential langevin equation the solution of this equation follows through the application of the lattice gas cellular automata formalism in terms of spatial and temporal discretization the flow velocity vector is computed using a stochastic dimensionless equation where permeability porosity facies and fracture persistence are the input parameters fluid flow is assumed to follow minimum effort paths in a heterogeneous medium from sinkholes or dolines towards springs the shortest path search is performed using a fast marching algorithm in which fracture persistence is used as a proxy for a velocity field additionally the langevin equation s memory effect allows the coupling of the widening of the conduits with the amount of flowing water taking into account dissolution phenomena as conduits widen more particles tend to run through them this work presents a workflow for the modeling of karst generation in carbonate reservoirs the workflow is applied to the study of an outcrop from jandaíra formation potiguar basin brazil high resolution aerial images of the area scanlines and karst facies stacking pattern of an outcrop near this area are the primary data to define the three dimensional model three feasible scenarios of karstification were generated epigenic hypogenic and hybrid karst as a result 3d karstic networks form considering the regional geology flow conditions and local heterogeneities keywords 3d karstic network langevin equation lattice gas cellular automata fast marching method epigenic karst hypogenic karst 1 introduction the diagenetic processes of karst structures in carbonate rocks by dissolution are responsible for enhancing the porosity of the sedimentary facies and play a distinguished role in creating and distributing vuggy pore space and breccias in carbonate formations consequently well developed highly permeable channels and conduits embedded in low permeability fractured rocks are typical carbonate aquifers ford 1988 presented the main components of a karstic system from a geomorphological viewpoint focusing on the dissolution of carbonates in the erosion zone compared to the deposition region meyers 1988 observed two different patterns of the karstification process the classic karst confined or pipe shaped is dominated by the widening of bedding planes and joints generally resulting in large caves and preferential flow passages on the other hand diffuse karstification patterns occur when the dissolution process happens at intergranular pores small cavities and irregular veins numerical modeling of flow and transport in karstic systems remains a challenge due to the high contrast in the hydraulic properties at a microscopic spatial scale specifically at the borders between conduits fractures and rock matrix thus predicting groundwater flow directions may be challenging since due to anisotropy and the presence of conduit systems it may not be perpendicular to equipotential lines the review article of hartmann et al 2014 introduces karst its evolution and its particular hydrological processes they discussed the limitations of current karst models and showed challenges regarding data availability and its information content the works studying karst structure are generally based on geostatistical models data calibrated models and speleogenesis models firstly geostatistical models such as collon et al 2017 computed statistical metrics to characterize the geometry and the topology of 34 karstic networks jouves et al 2017 built a 3d numerical database from 26 caves statistical analysis was used to calculate eight morphometric cave descriptors four geometric parameters width to height ratio tortuosity curvature and vertical index and four topological parameters degree of node connectivity graph indices and ramification index data calibrated models are adopted in mohammadi illman 2019 two synthetic karst aquifers with branchwork and network conduit patterns bcp and ncp are used to explore hydraulic tomography s ability to detect karst conduit patterns under steady and transient conditions berglund et al 2020 used the finite element subsurface flow model to simulate the conduit connection between a sinking stream and a spring in central pennsylvania a sensitivity analysis of 52 parameter combinations for four conduit geometry scenarios was carried out using the latin hypercube method andrade gómez et al 2019 proposed a regional conceptual model for the aquifer structure of the ring of cenotes on the yucatan peninsula mexico the apparent resistivity distribution is interpreted based on electrical resistivity tomography to calibrate hydrogeological models borghi et al 2016 described two numerical experiments the first experiment considers the influence of geometry and topology of the karst conduits on the network the models are generated using the pseudo genetic algorithm developed by borghi et al 2012 the second experiment investigates the capability of an inverse analysis algorithm such as doherty et al 1994 to retrieve optimal physical parameters of a 3d model with karst conduits modeled through 1d pipe elements with non linear flow dynamics fischer et al 2017a b proposed a new method called cellular automata based deterministic inversion cadi it permits a deterministic inversion based on a bayesian approach and uses dynamic optimization to generate different linear structures subsequently fischer et al 2017a b used cadi to distribute hydraulic properties in the flow conduits and iteratively modify the network s structural geometry to progressively match a set of multi borehole hydraulic tests these tests were collected from a hydraulic tomography experiment conducted at terrieu field in the lez aquifer southern france recently fischer et al 2018 applied cadi to image the spatial heterogeneity of the hydraulic properties hydraulic conductivity and storage coefficient based on harmonic pumping tests in a karstic field located near montpellier southern france wang et al 2016 collected geological and hydrological data in a confined carbonate aquifer located north of montpellier they constructed a 2d equivalent porous medium model to represent the test site domain the available hydraulic head data recorded at 22 boreholes during 8 sequential cross hole pumping tests were used to solve an inverse problem alternatively the double continuum approach kordilla et al 2012 defines karst systems heterogeneity through two interacting continua one for the matrix and another for the karst conduits the continua exchange water using a linear exchange term according to their water levels finally speleogenesis models such as de rooij graham 2017 proposed a hydrochemical model with an implicit reactive transport scheme to generate realistic karstic networks this speleogenesis model when applied to a karst region in florida usa avoids numerical saturation of calcite and allows for coarser conduit cells the approach proposed by jaquet et al 2004 is based on modified lattice gas automation in which walkers with a certain erosion potential travel through the medium the initial rock body is assumed to contain connected discontinuities fissures fractures etc in their work the more heavily fissured zones are first attacked and conduits are formed rapidly within these zones the larger the conduit the more the following particles tend to select these conduits which is called the memory effect thus the size of a given conduit depends on the number of particles passed through it particles gradually consume the rock along preferential pathways creating a heterogeneous network of conduits in the methodology presented in lafare 2011 conduits are generated using a heuristic erosion potential function depending on flow velocities and water ages borghi et al 2012 use a pseudo genetic approach in which a 3d map of conduits is eroded along minimum effort pathways computed by a fast marching algorithm fma the tracks of the particles are stored via an indicator function used to update the initial velocity field iteratively indicator functions describe the class of heterogeneity present in the model fractures bedding planes matrix aquitard etc pardo igúzquiza et al 2012 presented an efficient method for conditional and non conditional stochastic simulation of karst conduit networks the authors adopt a resampling method for generating conduit geometries from templates and a modified diffusion limited aggregation method for network topology generation following the work in stark 1991 ronayne 2013 proposed a non looping invasion percolation model to evaluate the advective solute transport in synthetic karst systems with 3d branching networks advective transport behavior within the velocity field is quantified by analyzing the distribution of solute particle travel times henson et al 2018 used a process based approach to generate karstic conduits based on a speleogenesis model applied to silver springshed in central florida usa de rooij graham 2017 a sensitivity analysis was carried out by using the morris method in this work karstic networks formation is modeled through the langevin equation by applying the lattice gas cellular automata formalism in spatial and temporal discretization in the reference work of jaquet et al 2004 the model s velocity field is deterministic and assumed to be known the flow velocity vector is computed stochastically in our new proposition depending on geological properties such as permeability porosity facies and fracture persistence also fluid flow follows minimum effort paths in a heterogeneous medium from sinkholes or dolines towards springs the fast marching algorithm is used to find the shortest path between sinkholes springs configurations in which fracture persistence is used as a proxy to compute the velocity field our work differs from borghi et al 2012 in the use of indicator functions to create contrasts between the different hydrogeological features fractures and bedding planes are more conductive high velocity than the matrix low velocity aquitard formations have very low velocity additionally based on the work of jaquet et al 2004 a memory effect introduced in the langevin equation allows coupling the widening of conduits with the amount of flowing water a three dimensional model was built with data collected from jandaíra formation potiguar basin brazil high resolution aerial images of lajedo arapuá scanlines and the karst facies stacking pattern were obtained from quadros 2019 three karstification scenarios were generated epigenic hypogenic and hybrid karst as a result a realistic 3d karstic network forms considering the regional geology flow conditions and local heterogeneities our novel methodology combining the langevin equation the lattice gas cellular automata and the fast marching method permits the analysis of the most important phenomena in karst diagenesis our lattice gas cellular automata implementation solves the langevin equation by defining a stochastic rule of evolution composed of two parameters the first one is related to the flow velocity and the second one is to the random vector consequently the state of a cell evolves depending on neighbor cells values of velocity and random vector fluid flow is determined stochastically depending on geological properties such as permeability porosity facies and fracture persistence the particle tracking determined by the fast marching method depends on the persistence field between recharge and discharge points additionally heterogeneities and dissolution are taken into account through fracture persistence and conduit opening updates as the karstification process occurs epigenic hypogenic and hybrid karstification processes are simulated to generate complex network scenarios 2 methodology of the stochastic modelling for karstic network diagenesis the langevin stochastic differential equation is used to simulate fluid transport using a random walk type stochastic process the basic idea for modeling the formation of karst geometry is to solve the langevin equation by applying the lattice gas cellular automata lgca formalism in terms of spatial and temporal discretization based on the assumption that water and karst conduits follow the path of minimum effort between entrances and exits path search is performed using the fast marching method fmm sethian 1996 1999 2001 the particle follows the shortest path and corrodes the model as in jaquet et al 2004 the resulting path becomes one of the karst conduits figure 1 shows the workflow for the generation of karstic conduits using the langevin equation the lattice gas cellular automata and the fast marching method fmm our simulation starts with the definition of initial conditions such as porosity facies permeability fracture opening and the model s persistence field then based on the location of outlet points the fmm determines the time map which defines the time required by particles to travel from everywhere in the domain to the outlet locations consequently particle tracking is carried out to determine the shortest path from the dolines or inlet points to the springs or outlet points thus the particle travel time is computed the direction of the velocity field in the langevin equation is then obtained stochastically from the lattice gas cellular automata based on geological parameters consequently the particle gives its first jump the second jump given by the random vector in the langevin equation is determined stochastically from the lattice gas cellular automata based on fracture opening and the persistence field the memory effect applied in the langevin equation allows the coupling of conduit widening with flowing water considering dissolution phenomena this procedure is executed for each particle in the domain until all time steps are simulated the following subsection provides a detailed description of the methodology 2 1 langevin equation a stochastic process of the random walk type can be applied to solve the transport equations such a process corresponds to a lagrangian representation of the formation of karstic networks i e karst evolution is described by the displacement of particles as a function of time this description can follow by the stochastic differential equation of langevin jaquet 1995 one consequence of the spatial and temporal dependence of the opening sizes of fractures and karstic conduits is that the langevin equation becomes non linear which precludes its solution using analytical methods therefore applying the langevin equation to the modeling of karstic networks requires a numerical method this work proposes solving the langevin equation through the lattice gas cellular automata formalism in spatial and temporal discretization the discrete form of the langevin equation 1 is the following jaquet et al 2004 1 x n 1 i λ j λ k λ x n i j k v i j k δ t n w n i j k λ where i j k represent the lattice discretization indices of direction x y and z respectively v i j k is the flow velocity vector computed stochastically in equation 3 w n i j k is the random vector and λ the spacing of the lattice m for each time step n the particle can move up to two times the lattice spacing the first jump is related to the flow velocity and the second one to heterogeneity and dissolution the memory effect is solely directional the particles tend to follow previous trajectories with a constant displacement value the values of the random vector w n i j k are computed probabilistically the directional probability is proportional to the cubic value of the neighboring conduit diameters this choice is based on poiseuille s law where transmissivity and fracture opening are linked through a cubic function as shown in equation 2 witherspoon et al 1980 2 w n i j k 1 a i j k θ n i j k 3 c 1 s 1 a i j k θ n c i j k 3 w i t h θ n c i j k θ c i n i i j k i n p n c i j k where a i j k is the fracture persistence m 2 θ c i n i i j k is the initial opening m of conduit c i is the increase in the opening m per passage n p n c i j k is the number of passages of particles at time n for a conduit c and θ n c i j k is its updated opening the persistence field introduced here relates the medium s initial heterogeneity to conduit geometry the memory effect allows the coupling of conduit widening with the number of particles as the conduits widen more particles run through them which defines the relationship between water flow and conduit size the flow velocity is assumed to be large enough to allow neglecting the effects of saturation more specifically conduit widening occurs when the number of passages of particles n p n c i j k in a cell increases the number of passages of particles multiplied by the gradient i updates the conduit opening 2 2 lattice gas cellular automata in general the cellular automata method comprises a grid of points a neighborhood a global state and a set of rules for evolution the grid represents the geometric part associated with the automaton one of the fundamental properties of cellular automata is the cells location each cell can only interact with a finite number of neighboring cells i e moore s and von neumann s neighborhood the third property of the cellular automaton is the state associated with the cell this property is in fact the differential of the cellular automata method to other more sophisticated techniques such as lattice gas cellular automata and lattice boltzmann because the state associated with the cell can be binary discrete or continuous the formal definition of the cellular automata ends with the rules of evolution these rules define how the state of a cell can evolve depending on the state of neighboring cells the evolution rules can take a stochastic or deterministic form depending on the modeled system when considering the automaton as a dynamic entity an evolution step is the state update from its neighboring configuration the objective of the computational method presented below is to use cellular automata in solving fluid flow problems and modeling the formation and evolution of karst structures it is based on the model developed by planteblat 2013 the reference work uses the cellular automata to model the diagenetic flow and its effects on geological formations mineralogical composition and petro physical properties a cloud of particles of unit mass and zero dimension with the capacity to move between centroids defines the cell state the model presented here does not consider one of the fundamental principles of physics that two particles can not occupy the same position simultaneously likewise the equations for conserving linear momentum and continuity fundamental to lattice boltzmann s method are not satisfied finally the rules of evolution complete the model of cellular automata the translation of a particle depends fundamentally on the permeability porosity and facies of the medium the nature of the gas particles that coexist in the grid defines the cellular automata system s evolution the starting point of the analysis is understanding the system and each parameter s influence on the particle trajectory for example porosity influences the particle trajectory as higher porosity implies less resistance to the movement of gas particles and defines a preferential path the karstic model differs from the lattice gas approach used in hydrodynamics as no direct interactions between particles occur hence no exclusion principle holds on the lattice collisions between particles are replaced by probabilistic interactions of particles with the same trajectory of predecessors consequently particles tend to jump probabilistically towards the largest opening fissure or conduit our lattice gas cellular automata implementation solves the langevin equation by defining an evolution rule composed of two stochastically determined parameters equation 1 the first one is related to the flow velocity v i j k equation 3 and the second one to the random vector w n i j k equation 2 consequently the state of a cell evolves depending on neighboring cells values of velocity and random vector 2 3 fast marching method fmm the flow velocity vector is also computed stochastically firstly by taking into account the state of the neighboring cells and secondly selecting a specific adjacent cell by a uniformly distributed integer random number generator the flow direction of particles depends on permeability porosity facies and the arrival time computed from the fmm as shown in equation 3 3 v i j k ω l ω k k i j k ω ϕ ϕ i j k ω f f i j k ω t t i j k where k i j k is the permeability φ i j k the porosity f i j k the facies parameter ω k ωφ ω f are tunning parameters which describe the relative influence among the geological parameters ω l are the geometrical weights of the lattice as defined in equation 4 4 ω l 1 3 l 0 ω l 1 18 l 1 7 ω l 1 36 l 8 18 the magnitudes of the weights are computed following the scheme of d3q18 used in three dimensional cubic lattices as in the work of xia et al 2018 the parameter t represents the particle travel time computed from the fast marching method the conduits are assumed to follow minimum effort paths in a heterogeneous medium from sinkholes or dolines toward springs the shortest path search follows the fast marching method fmm sethian 1996 1999 2001 the open source fmm implemented by tommy hinks https github com thinks fast marching method was coupled to the implemented automata cellular algorithm to represent a probabilistic karst model we use a proxy to mimic the final result mature system without modeling the physical and chemical processes the proxy is based on the assumption that water and thus karst conduits will follow the minimum effort path i e the most convenient path between inlets and outlets fracture persistence is used as a proxy of a velocity field for each simulation of the fracture network our work differs from borghi et al 2012 in the use of indicator functions to create contrasts between the different hydrogeological features fractures and bedding planes are more conductive high velocity than the matrix low velocity aquitard formations have very low velocity this persistence proxy indicates that the greater the persistence the higher the velocity field in a homogeneous medium it would be a straight line between sinkholes and the spring the fmm is a front propagation algorithm thus spring s i e known outlet s of the aquifer is used as a starting point for the propagation algorithm the velocity of front propagation at any point in the domain is given initially by the persistence field the result of the fmm is a 3d map of front arrival times from outlets to any point in the domain the next step consists of using the set of starting point locations to compute the inlet path to the outlet by following the time map gradient for each point in this set in this way the algorithm performs particle tracking from the sinkholes or dolines towards the springs the particle follows the shortest path and corrodes the rock as in jaquet et al 2004 the resulting path becomes one of the karst conduits 2 4 methodology validation figure 2 shows an example in which there are regions with different permeability values representing an inclined fault the 2d model top down viewed has 100 100 cells the blue colored region has zero permeability green 0 05 m s and red 0 1 m s the particles are located at the lower left edge z 0 20 with a constant flow velocity direction v 1 0 0 0 it is observed that particles flow in the direction of maximum permeability the memory effect of the particles that tend to follow the previous ones is shown additionally the implemented bounce back algorithm shows its capabilities to simulate fluid flow with obstacles the particle counter indicates the preferential path of the fluid by showing which cells have received more particles figure 3 shows a 3 layer model with different fracture persistence values 1 5 and 10 particles are initialized along the right edge of the model and the preferred flow direction is horizontal v 1 0 0 0 as expected the memory effect applied by the random vector through the persistence and opening of the conduit causes more particles to tend to flow in this direction the generation of preferential flow channels increases with fracture persistence particles flow preferentially at the boundaries between layers due to the memory effect in other words particles near the interface tend to flow towards the region with greater persistence and consequently other particles are attracted to this region to validate the inclusion of the fast marching method fmm to determine the shortest path between dolines and springs several examples are presented figure 4 shows a model in which the spring or exit is located in a cell at the lower left edge and the initial propagation field passed to the fmm is constant throughout the model the arrival time shows the time needed to arrive at the exit from any point in the domain subsequently the particles are inserted into a cell on the upper right edge of the model the shortest flow path is shown in figure 4 figure 5 shows a model in which the spring or discharge is located in a cell in the middle of the left edge and the initial propagation field passed to the fmm is constant throughout the model the arrival time shows the time needed to arrive at the exit from any point in the domain subsequently the particles are inserted along the right edge of the model the shortest flow path and the particle counter are shown in figure 5 3 application 3 1 lajedo arapuá jandaíra formation potiguar basin brazil the potiguar basin is located at the brazilian equatorial margin covering the state of rio grande do norte and part of ceará araripe feijó 1994 formalized the lithostratigraphic units of the potiguar basin in an integrated work according to these authors the jandaíra formation comprises bioclastic grainstones green algae mudstones with root marks mudstones wackestones with fenestras and contraction cracks are possibly present pessoa et al 2007 present an updated version of the potiguar basin stratigraphic chart they illustrate the main tectonic sedimentary events in geochronological order the carbonate sedimentation of the jandaíra formation occurred between the turonian and campanian ages it represents the implantation of the marine system after the drift of the south american and african continents this formation outcrop is an extensive plateau intensively eroded and karstified quadros 2019 lajedo arapuá or apodi 4 according to bisdom et al 2017 is located in the southwestern portion of the potiguar basin near the county of dix sept rosado as shown in figure 6 a it is a remarkable outcrop of jandaíra formation affected by intense fracturing in orthogonal patterns and karst features associated with these fractures based on information from several outcrops in the region and samples from oil wells drilled in the area cordoba 2012 characterizes the various depositional facies of the jandaíra formation the lithofacies described by this author are mudstones to wackestones with restricted biota wackestones to oncolytic packstones mudstones with birdeyes and mudstones with algal lamination the mapping of the fracture networks in the area apodi 4 was carried out in a multiscale approach combining uav imagery and measurements at the outcrop surface bisdom et al 2017 as shown in figure 6 b this area presents natural fractures in an orthogonal pattern with pre karstification openings between 0 and 0 28mm these authors estimated this range of openings based on the barton bandis model in order to simulate subsurface conditions equivalent to a burial of 2 5 to 3 0 km in the potiguar basin reis et al 2013 it was considered constant jrc 15 jcs 120 mpa maximum horizontal stress of 30 mpa young s modulus of 50 gpa and poisson s ratio of 0 3 in quadros 2019 eight scanlines were used to measure the structural features of the lajedo arapuá as shown in figure 6 b building a three dimensional model requires a horizontal data source in this case the lajedo arapuá surface map figure 6 b and a vertical data source represented by the tijubina outcrop figure 7 described in the work of quadros 2019 in terms of depositional facies and karst features figure 7 shows the stacking of facies on the outcrop a the schematic vertical stacking b and the two faciological frameworks c the tijubina outcrop is an exhibition of the jandaíra formation with approximately three meters of thickness the classification of carbonate rocks by terra et al 2010 was the basis for describing the depositional facies crystalline limestone clayey mudstone silty mudstone and tufa are the lithofacies recognized in a macroscopic description by quadros 2019 according to the classification proposed by terra et al 2010 and shown in figure 7 additionally karst features have been described qualitatively in terms of the intensity of dissolution the features of the intense karst dissolution of the tijubina outcrop are predominantly associated with horizontal discontinuities bedding planes with a total of eight intensively dissolved horizontal surfaces are identified table 1 presents the porosity and permeability values considered in this work based on quadros 2019 statistics for fracture openings from the scanlines show maximum and minimum values between 10 mm and 620 mm see table 3 quadros 2019 on the other hand the work of bisdom et al 2017 presents values between 0 and 0 28 mm for the openings of the discontinuities of lajedo arapuá there are two main reasons for this difference i the opening measures from the scanlines reflect an extension of the fractures due to the karstification process not considered in the work of bisdom et al 2017 ii the estimate of openings by bisdom et al 2017 considers a burial of around 3 km and currently the jandaíra formation is exhumed under the surface stress regime therefore as the purpose of this work is to model the karst features a priori it was assumed that the openings of the joints and stylolites proposed by bisdom et al 2017 refer to the pre karstification period see table 2 based on the scanlines from quadros 2019 the fracture intensity map p21 shown in figure 8 is used considering the following aspects the conceptual model of more significant fracturing in the presence of vegetation and the range of fracture intensity values in the domain of scanlines 3 2 model description based on the model developed in quadros 2019 the geological model was built considering the lajedo arapuá grid map of 200 m by 200 m and the vertical thickness of 2 5 m tijubina outcrop in this way it was possible to build cells with horizontal dimensions of 2 m by 2 m i x j and variable vertical thickness the number of cells i x j x k was 116 104 30 and the total number of cells was 361920 the 3d model geometry and initial values of depositional facies karst features porosity permeability and fracture intensity p21 were taken from quadros 2019 the boundary conditions defined at the model borders impose zero particle flux the three dimensional framework of facies and fractures with their respective permeability properties was based on constructing models of epigenic hypogenic and hybrid processes for the generation of the epigenic karst model the concept of variation in the phreatic level was considered a primary dissolution control factor at horizontal levels therefore three hypothetical times t1 t2 and t3 were considered representing a progressive lowering of the water table from t1 to t3 the infiltration points at time t1 were selected in regions with high fracture density where vegetation was present for the definition of the infiltration points of time t2 and t3 in addition to the information on regions of intense fracturing it was possible to use the skeleton generated in t1 and t2 respectively to determine some infiltration points the discharge point was positioned in the southern part of lajedo arapuá where the apodi river currently exists the hypogenic karst model considers that upward fluid flow is the process responsible for the rocks dissolution for this scenario multiple deep recharge points were defined at a 2 5m depth in the southwest of lajedo arapuá the work of quadros 2019 considers one recharge point and one discharge point here two shallow discharge points were placed on the surface to the northeast where intense fracturing was identified by the vegetation as shown in figure 8 another possible scenario is the occurrence of the two karstification processes together simultaneously or not this process is called superposed or hybrid karstification in which epigenic karst occurs preferentially on the surface while hypogenic karst tends to be a more critical process after burial therefore when considering a carbonate oil reservoir it is expected that throughout the geological evolution of the formation it is most likely is that the two karstification processes have occurred this scenario represents the superposition of the two processes previously modeled 3 3 results 3 3 1 epigenic karst model for the generation of the epigenic karst model the water table variation was considered a primary factor for controlling dissolution at horizontal levels therefore three hypothetical times t1 t2 and t3 were considered for this scenario representing a progressive lowering of the water table from t1 to t3 the infiltration or recharge points were defined in regions with high fracture intensity where vegetation was present the exfiltration or discharge point was always positioned in the southern part of lajedo arapuá where the apodi river currently exists quadros 2019 the simulation of the epigenic skeleton for time t1 was performed from this information as shown in figure 9 a our simulation estimates the path with the lowest transit time for particles between recharge and discharge points vertical downstream channels develop first and then horizontal conduits are generated to reach the exfiltration point at the discharge depth additionally figure 9 a shows the opening values θ c after the karst network s dissolution process through equation 2 the final opening for each cell is obtained as a function of the number of particle passages during the simulation at the end of the simulation cells are filtered to highlight those that have received more particles subsequently voxels are created from the centroid of the filtered cells and their color represents the magnitude of the final opening since the filter is a function of the number of particle passages isolated voxels can be observed thus stochastically multiple particles coming from the same cell can choose different neighbor cells then when the filter is applied neighbor voxels can be neglected because they do not meet the criterion of the filter for the definition of the infiltration points of time t2 in addition to the information on regions of intense fracturing it was possible to use the skeleton generated in t1 to determine some infiltration points the simulated skeleton for the second lowering of the water table t2 is shown in figure 9 b characteristic of epigenic karst the dissolution process creates vertical channels until the discharge depth is achieved thus fluids flow horizontally to the exit region the infiltration and exfiltration points for t3 the final time in the lowering of the water table followed the same criterion as in time t2 figure 9 c illustrates the hypothetical skeleton of epigenic karstification for time t3 similar to the simulated karst of the water table lowering vertical downflow channels and horizontal channels can be observed additionally in figure 9 b and c the opening values θ c after dissolution are shown green arrows indicate the recharge point location whereas orange ones highlight discharge points the epigenic skeleton for times t1 t2 and t3 and the opening values θ c after karst network generation are shown in figure 10 green arrows indicate recharge point locations whereas orange ones highlight discharge points 3 3 2 hypogenic karst model the hypogenic karst model considers that the process responsible for promoting rock dissolution is upwards fluid flow for this scenario multiple deep recharge points were defined at southeast lajedo arapuá at 2 5m two shallow discharge points are located on the northeast surface where intense fracturing is identified by the presence of vegetation quadros 2019 the skeleton of the hypogenic karst shown in figure 11 a presents long flow channels the channels reach the surface level generate wide horizontal channels to reach the exfiltration points furthest from the recharge points figure 11 b shows the top view and the opening values θ c after the dissolution process generated the karst network green arrows show recharge points whereas orange ones highlight discharge points 3 3 3 hybrid or superimposed karst model superposed or hybrid karstification considers the occurrence of the two karstification processes simultaneous or not epigenic karst occurs mainly on the surface while hypogenic karst tends to be more important after burial this scenario represents the union of the previously modeled processes and their combined architecture is shown in figure 12 figure 12 shows the aperture values ap after the dissolution process generated the karst network for three different steps figure 12 a shows the skeleton and of the karst network openings along 15 time steps for the epigenic karst vertical channels with the descendant fluid flow are present the hypogenic karst shows vertical conduits but in the opposite direction for time step 60 illustrated in figure 12 b particles have reached discharge points creating vertical and horizontal channels in the epigenic karst in contrast only vertical upflow channels show by hypogenic karst as expected increasing the number of steps leads to further dissolution consequently wider conduits are generated see figure 12 c for the evolution of the hybrid karst along 200 time steps horizontal superficial channels are created from further recharge points to the discharge point in the hypogenic karst broader horizontal and vertical conduits can be observed in the epigenic karst green arrows show recharge points whereas orange ones highlight discharge points 4 discussion this section brings a parametric analysis of the main factors influencing the karst network generation figure 13 presents the diagenesis of an epigenic karst network at the top of the model seven recharge points and one discharge point at the bottom right side of the domain are defined the discharge point was positioned in the southern part of lajedo arapuá where the apodi river currently exists the infiltration or recharge points were selected in regions with high fracture intensity quadros 2019 an initial fracture opening of 0 15 mm is set in all cells values for facies permeability porosity and persistence are the same as those in the previous models in this case geological parameters influence is ignored by setting zero to the weights in equation 3 instead the diagenesis of the karst network is controlled by fracture persistence described in equation 2 in figure 13 a long vertical channels flowing downstream can be observed additionally at spring depth horizontal conduits drive the fluids to the discharge region the top view of the resulting karst network is shown in figure 13 b illustrating the aerial channel distribution the opening values shown in figure 13 reflect the significant effect of the dissolution process in karst network generation where a maximum opening of 11 mm is obtained for the initial opening value of 0 15 mm the number of cells in x y z axis are constant for all the parametric analysis 116 104 30 respectively the green arrows show recharge points and the orange ones highlight discharge points all of the following simulations have the same recharge and discharge points locations 4 1 facies the effect of the depositional facies in the resulting karst network is shown in figure 14 the parameter ω f in equation 3 tunes the predominance of the facies concerning the other geological parameters two cases with facies weight parameter of value 1 and 10 were analyzed the remaining weights of the other geological parameters in equation 3 are assumed negligible in terms of the karst network geometry in figure 14 a compact and well defined channels are observed compared to figure 14 b and c as the effect of depositional facies effect increases more dispersive channels develop the drop in particle probability causes this effect to take the shortest path due to the widespread distribution of the facies values see table 1 therefore maximum openings of 3 5 mm to 1 75 mm can be visualized in figure 14 b and c compared to 11 mm in figure 14 a 4 2 permeability figure 15 exhibits the effect of permeability on karst network generation permeability weights ω k with values 1 and 10 were considered in equation 3 for this sensitivity analysis the effect of the other geological parameters is neglected dispersion in permeability values reduces particle probability to take the shortest path between recharge and discharge points as its influence is enforced consequently diffuse channels can be appreciated in figure 15 b and c compared to the delineated conduits seen in figure 15 a additionally karst network opening is reduced as the distribution of the permeability values assumed at pre karstification is not aligned with the shortest path between the recharge and discharge points constant values are established for each depositional facies see table 1 subsequently narrower channels 2 1 mm to 1 75 mm can be identified in figure 15 b and c unlike the broader conduits 11 mm from figure 15 a furthermore the permeability effect on the resulting karst geometry is more pronounced than the facies effect due to its higher heterogeneity consequently multiples paths can lead to the spring 4 3 porosity the influence of rock porosity on the generation of karst networks can be seen in figure 16 similar to the results shown in figure 14 and figure 15 dissemination of the parameter values assumed at pre karstification see table 1 creates highly diffusive channels due to misalignment with the shortest path between dolines and springs as the probability of the particle choosing the shortest path reduces stochastically different courses can be taken to reach the discharge point therefore thinner channels 2 1mm to 1 75 mm can be observed in figure 16 b and c in comparison to those displayed in figure 16 a 11mm 4 4 initial opening of fractures to study the effect of the initial opening of fractures θ c in the resulting karst network a sensitivity analysis of this parameter in equation 2 is proposed a constant initial fracture opening 0 15 mm was considered in the entire model for the results obtained in figure 13 based on the pre karstification values depicted in table 2 two scenarios for joints and stiolites opening values were attributed using the normal distribution as illustrated in figure 17 b and c respectively compared with the results in figure 17 a wider conduits are generated when the distribution of the opening values assumed at pre karstification has maximum values between 0 25 mm to 0 28 mm along the shortest path between the recharge and discharge points consequently the probability of following the shortest path increases maximum opening values obtained after the dissolution process are higher 28 mm and 22 mm as shown in figure 17 b and c compared to those displayed in figure 17 a 11 mm this difference can be justified by the initial opening value of 0 15 mm assumed in the analysis of figure 17 a in contrast to maximum values between 0 25 mm to 0 28 mm admitted for the simulations shown in figure 17 b and c additionally when comparing the numerical results with the statistics obtained from the scanlines measured on the lajedo arapauá see table 3 maximum opening values from figure 17 b and c 28 mm and 22 mm belong to the range of opening values observed on the field for joint and stylolites 4 5 fracture intensity the effect of the fracture intensity for the distribution summarized in table 4 is shown in figure 18 three scenarios are simulated the first one is based on the data extracted by quadros 2019 in the p21 map shown in figure 8 from the area called lajedo arapuá jandaíra formation potiguar basin brazil cases 2 and 3 are synthetic cases varying the mean and standard deviation of the first case the karst network geometry is very sensitive to the distribution of fracture intensity values when comparing figure 18 a with figure 18 b and c the shortest path between the recharge and discharge points is followed closely when the intensity configuration of the second and third cases is taken into account as shown in figure 18 b and c similar to case 1 figure 18 a compact and well defined channels can be observed however wider channels 16 mm are seen in figure 18 b showing a different solution to the thinner conduits 11 mm interpreted from figure 18 a 5 conclusion this paper develops a new methodology to simulate the generation of 3d karstic networks it combines the langevin equation the lattice gas cellular automata and the fast marching method the stochastic computation of the velocity field in the langevin equation is a novelty considering geological parameters such as permeability porosity persistence and depositional facies furthermore the so called feedback loop kiraly 1997 which implies widening conduits due to dissolution is considered following borghi et al 2012 our methodology performs particle tracking starting from the sinkholes or dolines towards the springs by estimating the shortest path numerical results obtained with the proposed methodology demonstrated its capability to simulate complex karst diagenesis using field data such as high resolution aerial images of the area scanlines and the karst facies stacking pattern from the application area additionally the memory effect applied by the random vector through persistence and conduit opening established that the higher the persistence of fractures the more preferential flow channels are generated estimation of the shortest path between the recharge and discharge points was validated through 2d and 3d models our methodology was applied to study the diagenesis of karstic networks in the area called lajedo arapuá jandaíra formation potiguar basin brazil the construction of three dimensional models of epigenic hypogenic and hybrid or superimposed karst was carried out by considering depositional facies karst features porosity permeability and fracture intensity p21 taken from the work of quadros 2019 the concept of variation in the water table was successfully incorporated in the methodology as a primary factor for controlling dissolution at horizontal levels in the epigenic karst model the resulting hypogenic karst presented here can consider multiple recharge and discharge points allowing to model complex and realistic karstification processes the possibility of both karstification processes hybrid karst simultaneous or not is included in our methodology this feature is relevant for modeling the diagenesis of karstic networks in carbonate oil reservoirs where hybrid karstification processes take place the main geological characteristics influencing karst network generation such as porosity permeability depositional facies and fracture intensity were studied greater spatial distribution of the parameter values assumed at pre karstification creates thicker diffusive channels due to its misalignment with the shortest path between dolines and springs subsequently narrower channels can result after the dissolution process takes place additionally maximum opening values computed numerically belong to the range of opening values observed on the field for joint and stylolites obtained from the scanlines measured on the lajedo arapauá the karst network geometry is very sensitive to the distribution of fracture intensity values however the shortest path between the recharge and discharge points is followed closely for a non constant intensity configuration finally this work provides a better understanding of the generation of karstic networks simulating realistic scenarios efficiently the results of this methodology can be used in inverse analysis to iteratively modify the network s structural geometry to match a set of multi borehole hydraulic tests progressively moreover the generated networks can be used to simulate flow and transport additionally our methodology can be applied jointly with groundwater modelling techniques to solve surface pollution issues furthermore the oil production of carbonate reservoirs can be optimized by considering the developed karstic networks in reservoir simulations credit toxonomy conception and design of study r g escobar d roehl acquisition of data f b quadros c l cazarin analysis and or interpretation of data r g escobar drafting the manuscript r g escobar revising the manuscript critically for important intellectual content d roehl f b quadros c l cazarin approval of the version of the manuscript to be published the names of all authors must be listed r g escobar d roehl f b quadros c l cazarin declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was carried out in association with the ongoing r d projects registered as anp no 20329 9 modicarste puc rio petrobras anp sponsored by petrobras under the anp r d levy brazil as compromisso de investimentos com pesquisa e desenvolvimento and the brazilian national council for scientific and technological development cnpq under grant no 308547 2016 0 
241,the migration of active particles in a laminar open channel flow is significant for many ecological and biological processes associated with ambient water for example the harmful algae blooms in the long distance water conveyance project this paper presents an analytical analysis of the migration of the buoyancy controlled active particles in a laminar open channel flow the analytical solution of concentration distribution has also been derived for the active particle cloud in the laminar open channel flow under the combined action of ambient flow and self migration of active particles by combing chatwin s long time asymptotic expansion and central concentration moments the analytical solution shows that the active particle cloud accumulates near the surface rather than uniform distribution in the cross section even for the long time evolution the analytical solutions are also been rigorously derived to reflect the holistic characteristics of the active particle cloud including the total quantity over each streamline moving velocity of mass center longitudinal dispersivity skewness and kurtosis have been rigorously derived for an instantaneous point source in a laminar open channel flow it is found that the distribution of total active particles over each streamline centroid motion and longitudinal dispersion eventually reach a stable status with a necessary time dependent on the relative strength of the vertical migration velocity and the total vertical diffusion however the self migration of active particles results in the deviation of the moving velocity of mass center from the depth averaged flow velocity the longitudinal dispersivity of the active particle cloud gradually increases to the peak and then decreases to a constant value in contrast to the monotonous increase for the passive particle cloud it is also found that the strong vertical self migration can result in changes of skewness and kurtosis of concentration distribution negative skewness and positive kurtosis during the initial stage however both of them gradually tend to zero for the long time evolution of the active particle cloud keywords environmental dispersion active particles open channel flow nomenclature c concentration of active particles number of cells m 3 d longitudinal dispersion coefficient dimensionless d depth averaged d dimensionless d l r ratio of the total longitudinal diffusivity to the total vertical diffusivity dimensionless h water depth m h e n hermite polynomials m p p th p 0 1 2 concentration moment dimensionless p e x péclet number associated with advection and total vertical diffusion dimensionless p e z péclet number associated with vertical self migration and total vertical diffusion dimensionless q total number of active particles dimensionless t time s u longitudinal flow velocity ms 1 u depth averaged longitudinal flow velocity ms 1 u flow velocity ms 1 u b migration velocity of active particles ms 1 v c moving velocity of the mass center of active particles dimensionless v c depth averaged v c dimensionless w b self migration velocity of active particles ms 1 x z coordinates in the longitudinal and vertical direction m x standardized variable dimensionless φ flow velocity deviation from its mean dimensionless λ mass diffusivity m 2 s 1 λ b translational diffusivity tensor of active particles m 2 s 1 λ x x b longitudinal component of λ b m 2 s 1 λ z z b vertical component of λ b m 2 s 1 τ dimensionless time dimensionless ψ dimensionless self migration velocity of active particles dimensionless ξ dimensionless coordinate in the longitudinal direction dimensionless ζ dimensionless coordinate in the vertical direction dimensionless ν p p th central concentration moment dimensionless γ 1 skewness dimensionless γ 1 depth averaged γ 1 dimensionless γ 2 kurtosis dimensionless γ 2 depth averaged γ 2 dimensionless χ n eigenfunction λ n eigenvalue ω dimensionless concentration dimensionless gradient operator δ delta function 1 introduction the migration of particles plays a significant role in many ecological and biological phenomena in ambient waters such as the harmful algal blooms in reservoirs river lakes and coastal zones biofilm formation on the surface of porous media associated with the constructed wetlands for wastewater treatment and occurrence of thin phytoplankton layer in oceans golian et al 2020 luo et al 2016 ostad ali askari et al 2019 wu et al 2011 wu and chen 2014 zeng et al 2019 zeng and pedley 2018 there exist two typical types of particles in waters namely the passive and active particles the former s migration mainly depends on the ambient flow and molecular diffusion while the latter relies on the combined action of ambient flow molecular diffusion and self migration due to external stimuli such as gravity light heat nutrient etc regarding the migration of passive particles there has been an abundance of theoretical analysis experimental measurement and field observation the pioneering work can trace back to classical analysis of solute dispersion through a circular tube by taylor 1953 who pointed out that the distribution of soluble materials eventually reaches uniform in the cross section due to the combined effects of velocity non uniformity and molecular diffusion aris 1956 presented the concentration moment method to describe the initial and long term transport of a solute in a tube in which the zeroth first second third and fourth central concentration moments reflect the mass distribution advection velocity dispersion rate skewness and kurtosis of the solute cloud respectively the governing equation of cross sectional mean concentration for the long time evolution of particles was also rigorously derived by mei et al 1996 using the multi scale perturbation method with small parameters the evolution of mean concentration during the whole transport process has been derived based on the expansion of concentration function chatwin 1970 gill 1967 yu and chang 1991 developed a method to compute the solute concentration in a wall bounded channel based on green s function taylor dispersion analysis the concentration moment method the multi scale perturbation method and the expansion of concentration function have been widely applied to investigate the transport of passive particles in the tube flows ng 2002 wu et al 2012 ostad ali askari et al 2020 open channel flows ng 2000 ng and yip 2001 wang and huai 2016 guo et al 2018 derakhshannia et al 2020 wetland flows chen 2013 luo et al 2017 nepf 2011 yang et al 2016 2020 zeng et al 2019 and natural rivers wang and huai 2016 wang and chen 2017 differing from the transport of passive particles in ambient flows the migration of active particles is also affected by their self migration usually cells self migration through the water body is achieved by waving their appendages such as flagella or cilia and regulating cells buoyancy many efforts have been made to understand the distribution of active particles propelled by waving their flagella or cilia such as chlamydomonas reinhardtii and heterosigma akashiwo in various flow patterns distinguishing from the concentration distribution of passive particles self migration results in many unique distribution patterns such as the circumferential accumulation of cells on the tube wall for an upward poiseuille flow and central accumulation for a downward flow kessler 1985 shear induced generation of thin phytoplankton layer durham et al 2009 microscale patches driven by turbulence structures durham 2013 and cell accumulation in the lee of the cylinder and depletion on the leading side zeng and pedley 2018 very recently the migration of flagella driven active particles in the free surface constructed wetland flow has also been analyzed yang et al 2020 zeng et al 2019 various experimental observations and numerical simulation have also been performed to examine the vertical distribution of buoyancy controlled active particles ostad ali askari and shayannejad 2021 wu et al 2020 salehi hafshejani et al 2019 missaghi et al 2016 rowe et al 2016 medrano et al 2013 wu and kong 2010 hunter et al 2008 o brien et al 2004 kanoshina et al 2003 for example microcystis colonies however the buoyancy controlled active particles migration in an open channel flow has not been understood very well especially the characteristics of overall transport and concentration distribution across the channel with regarding the theoretical analysis of the migration of particles in the open channel laminar flow previous work mainly focused on the total quantity over each streamline moving velocity of mass center passive particles the longitudinal dispersivity skewness and kurtosis of the passive particle cloud the effects of the self migration of active particles on those transport characteristics are not clear although some analytical solutions yang et al 2020 zeng et al 2019 have been reported on the migration of active particles in some idealized wetland flows they mainly focused on the total quantity over each streamline moving velocity mass center and the longitudinal dispersion however the combined action of ambient flow and self migration on the skewness and kurtosis is not well understood for the active particle cloud in the idealized wetland flows more importantly the previous analytical solution on active particle distribution mainly focused on the characteristics of holistic transport rather than the distribution of active particles presented in this work is a theoretical analysis of the transport of buoyancy controlled active particles in an open channel flow including the analytical solution of active particle concentration as well as the comprehensive analysis for the holistic properties of active particles cloud the total quantity over each streamline moving velocity of mass center the longitudinal dispersivity skewness and kurtosis of the active particle cloud presented in this work is a theoretical analysis of the transport of buoyancy controlled active particles in an open channel flow the specific objects of this work are i to formulate the concentration transport of a buoyancy controlled active particle cloud ii to reveal the characteristics of total quantity over each streamline moving velocity of the mass center longitudinal dispersion skewness and kurtosis of the active particles cloud and iii to obtain the concentration distribution of the active particle cloud 2 formulation for a laminar open channel flow the concentration transport of buoyancy controlled active particles is governed by guo et al 2018 yang et al 2020 zeng et al 2019 1 c t u u b c λ b c λ c where c is the concentration of active particles t is time u is the flow velocity u b and λ b are the migration velocity and the translational diffusivity tensor of the active particles respectively and λ is the mass diffusivity λ b reflects the random motion of the buoyancy controlled active particles due to the irregularity of particle shape while λ reflects the effects of brownian motion of water molecules for the large particles for example microcystis colonies the former plays a leading role eq 1 shows that the concentration distribution of active particles is attributed to four factors i e the advection of ambient flow molecular diffusion the mean self migration velocity and the translational diffusion the last two factors mainly depend on the biological behaviour although sometimes they are also affected by the ambient flow in the present work we focus on the dilute suspensions of active particles which means that the effect of active particles on ambient flow can be neglected however it is necessary to consider the effects of active particles on the flow for the dense suspensions of active particles in which the bio convection can occur for the limiting case of u b 0 and λ b 0 eq 1 reduces to the concentration equation of passive particles in corresponding flows consider the migration of a buoyancy controlled active particle cloud in a steady laminar open channel flow in a cartesian coordinate system with x axis parallel to the direction of the water flow z axis vertically upwards and the origin located at the bottom of the channel as shown in fig 1 the flow velocity profile can be expressed as u z 3 z 2 h z u 2 h 2 where u is the cross sectional average velocity and h is the water depth as the first step of theoretical analysis of the active particles cloud in the open channel flow we assume that the active particle as a rigid sphere with a constant velocity in the vertical direction and eq 1 reduces to 2 c t u c x w b c z λ λ x x b 2 c x 2 λ λ z z b 2 c z 2 where u is the longitudinal flow velocity w b is the self migration velocity of active particles and λ x x b and λ z z b are the longitudinal and vertical components of translational diffusivity tensor respectively in previous work by yang et al 2020 they focused on the gyrotatic micro organisms which can swim in all directions by waving undulating or rotating flagella or cilia therefore the longitudinal swimming velocity exists in the concentration transport equation in their work however in the present work we focus on the buoyancy controlled active particles for example m i c r o c y s t i s colonies this type of active particles only self migrate in the vertical direction because the driving force to control their self migration i e the mean buoyancy due to the density difference of them and ambient water is always in the vertical direction consider an instantaneous point source located at x 0 and z 0 the initial condition for particle concentration can be expressed as 3 c x z t t 0 q δ x δ z where q is the total number of active particles and δ is the dirac delta function the concentration boundary conditions at x z 0 and z h are given by 4 c x z t x 0 5 w b c λ λ z z b c z z 0 h 0 the idealized initial condition employed in the present work can be considered as a simplification of active particles patches the boundary condition eq 5 means that there exists a balance between the advective flux due to the self migration velocity and the diffusivity flux caused by the molecular diffusion and translation diffusion of active particles eq 5 also means that all active particles cannot penetrate through the water surface and the bed bottom and that adsorption and desorption do not occur with dimensionless parameters 6 ω c h 2 q τ λ λ z z b t h 2 ξ x u t h ζ z h φ u u u ψ w b u eqs 2 5 can be rewritten as 7 ω τ p e x φ ω ξ p e x ψ ω ζ d l r 2 ω ξ 2 2 ω ζ 2 8 ω ξ ζ 0 ξ 0 9 p e x ψ ω ω ζ ζ 0 1 0 10 ω ξ ζ 0 δ ξ δ ζ where p e x u h λ λ z z b is the péclet number to reflect the relative strength of the advection and total vertical diffusion and d l r λ λ x x b λ λ z z b is the ratio of the total longitudinal diffusivity to the total vertical diffusivity the concentration moment method is extend to analyze the migration of the buoyancy controlled active particle cloud in the laminar open channel flow the p th concentration moment and p th central concentration moment are defined as aris 1956 11 m p ζ τ ω ξ ζ τ ξ p d ξ p 0 1 2 12 ν p ξ ξ c p ω d ξ ω d ξ respectively where 13 ξ c ξ ω d ξ ω d ξ m 1 m 0 is the position of mass center from the above definition the higher order central concentration moments are given by 14 ν 2 m 2 m 0 ξ c 2 15 ν 3 m 3 m 0 3 ξ c ν 2 ξ c 3 16 ν 4 m 4 m 0 4 ξ c ν 3 6 ξ c 2 ν 2 ξ c 4 since the concentration of active particles in the moving water has the characteristics of exponential attenuation satisfies the following relationship barton 1983 yang et al 2020 17 ξ i ω i i ω ξ i ξ i j ω ξ j 0 i 1 2 j 1 2 3 results and discussion 3 1 total quantity of active particles over each streamline applying the operation ξ 0 d ξ to eqs 7 9 and 10 with the aid of eq 17 gives the definite solution problem of m 0 including the governing equation and boundary and initial conditions 18 m 0 τ p e z m 0 ζ 2 m 0 ζ 2 19 m 0 ζ 0 δ ζ 20 p e z m 0 m 0 ζ ζ 0 1 0 where p e z p e ψ is the péclet number to reflect the relative strength of the vertical self migration and the total vertical diffusion following the method by yang et al 2020 we obtain the solution of m 0 21 m 0 exp p e z 2 τ 4 p e z ζ 2 n 0 φ n χ n e λ n τ where 22 χ 0 c 0 exp p e z ζ 2 λ 0 p e z 2 4 23 χ n c n sin n π ζ 2 n π p e z cos n π ζ λ n n 2 π 2 n 1 2 24 c 0 p e z exp p e z 1 25 c n 2 p e z 2 p e z 2 4 n 2 π 2 26 φ n 0 1 δ ζ exp p e z ζ 2 χ n ζ d ζ the zeroth order concentration moment reflects the total quantity variation of the active particles over each streamline with time and vertical position it is shown that m 0 eventually reaches a stable status under the combined effect of vertical advection and diffusion as shown in fig 2 the final distribution of m 0 and the necessary time to reach the stable status depend on p e z for the small p e z m 0 approximately satisfies a uniform distribution in the vertical direction while for the large p e z it tends to an exponential distribution the necessary time to obtain the stable status is 3 π 2 p e z 2 4 which has the same form for the migration of active particles in the free surface wetland flow yang et al 2020 the large p e z can diminish the time for m 0 to reach the stable status for the long time evolution of active particles in the flowing water the distribution of the total quantity of active particles along each streamline in the vertical position i e m 0 eventually attain the same status if the initial distribution is a dirac delta function we compared the analytical solution of m 0 in the present work and that by yang et al 2020 it is found that for τ 1 m 0 eventually reach a stable status 27 m 0 ζ τ p e z exp p e z 1 exp p e z ζ which is consistent with the analytical solution by yang et al 2020 3 2 motion of mass center applying the operation ξ d ξ to eqs 7 9 and 10 with the aid of eq 17 gives the definite solution problem of m 1 including the governing equation and boundary and initial conditions 28 m 1 τ p e z m 1 ζ 2 m 1 ζ 2 p e x φ m 0 29 m 1 ζ 0 0 30 p e z m 1 m 1 ζ ζ 0 1 0 with the integral transform technique we obtain the solution of m 1 31 m 1 exp p e z 2 τ 4 p e z ζ 2 m 1 ζ τ where 32 m 1 n m 0 λ m λ n e τ λ m e τ λ n χ n φ m ψ n m λ m λ n n 0 e τ λ n τ χ n φ n ψ n n where 33 ψ n m 0 1 χ n ζ χ m ζ pe x φ ζ d ζ the moving velocity of the mass center of active particles over each streamline can be expressed as v c d ξ c d τ the depth averaged v c is denoted by v c fig 3 presents the variation of v c with time and depth for different p e z during the initial stage the motion of the centroid of active particles over each streamline near the bed bottom is slower than that near the free water surface since the active particle cloud is initially located on the bed bottom the difference of v c for different vertical positions gradually disappears under the combined action of the vertical translational diffusion molecular diffusion and vertical swimming for long time evolution of the active particle cloud near the bed bottom v c increases to the peak and then decreases to a constant for the large p e z in contrast to the monotonous variation of v c for the small p e z the increase of p e z can enhance v c at the stable status and reduce the necessary time to reach the status as shown in fig 3 for the limiting case of p e z 0 v c tends to zero fig 4 shows the variation of v c with time the large p e z results in the large v c differing from the variation of v c with τ for the active particles near the bed bottom v c keeps the monotonous increase during the initial stage 3 3 longitudinal dispersion applying the operation ξ 2 d ξ to eqs 7 9 and 10 with the aid of eq 17 gives the definite solution problem of m 2 including the governing equation and boundary and initial conditions 34 m 2 τ p e z m 2 ζ 2 m 2 ζ 2 p e x φ 2 m 1 2 d l r m 0 35 m 2 ζ 0 0 36 p e z m p m p ζ ζ 0 1 0 with the integral transform technique we obtain the solution of m 2 37 m 2 exp p e z 2 τ 4 p e z ζ 2 m 2 ζ τ where 38 m 2 n 0 2 d l r e τ λ n τ χ n φ n n m k 0 λ k λ m λ k λ n 2 e τ λ k e τ λ n χ n φ k ψ m k ψ n m λ k λ m λ k λ n n m k 0 λ k λ m λ k λ n 2 e τ λ n τ χ n φ k ψ m k ψ n m λ m λ n n m k 0 λ k λ m λ m λ n 2 e τ λ m e τ λ n χ n φ k ψ m k ψ n m λ k λ m λ m λ n n m k 0 λ k λ m λ m λ n 2 e τ λ n τ χ n φ k ψ m k ψ n m λ k λ n n m k 0 λ k λ m λ m λ n 2 χ n φ k ψ m k ψ n m e τ λ n e τ λ m t λ m e τ λ m 1 τ λ n λ m λ n 2 n m k 0 λ k λ m λ m λ n e τ λ n τ 2 χ n φ k ψ m k ψ n m the longitudinal dispersivity of active particles can be expressed as wang and chen 2017 39 d 1 2 d ν 2 d τ where ν 2 is the second order central concentration moment the depth averaged longitudinal dispersivity is denoted by d fig 5 presents the evolution of d with τ and ζ it is shown that d eventually increases to an asymptotic constant similar to the variation of v c with ζ and τ d displays a monotonous increase for the active particles near the free water surface during the initial stage and a nonmonotonic variation near the bed the value of dispersivity increases in the initial time and eventually reaches a stable status for a long time evolution the maximum longitudinal dispersivity of the active particle cloud near the bed bottom is stronger than that near the free water surface as shown in fig 6 fig 7 presents the variation of d with τ d increases to the peak and then decreases to a constant value for the active particle cloud in contrast to the monotonic increase of that for the passive particle cloud the vertical migration of active particles can weaken the longitudinal dispersion 3 4 skewness and kurtosis the governing equation and boundary and initial conditions for the third and fourth order concentration moments m p ζ τ p 3 4 can be expressed as 40 m p τ p e z m p ζ 2 m p ζ 2 p p e x φ m p 1 p p 1 d l r m p 2 41 m p ζ 0 0 42 p e z m p m p ζ ζ 0 1 0 with the integral transform technique we obtain the solution of m 3 43 m 3 exp p e z 2 τ 4 p e z ζ 2 m 3 ζ τ the expression of m 3 ζ τ has been given in the appendix a the analytical solution of m 4 is too lengthy to be shown here to explore the effects of vertical self migration on the asymmetry and outliers of the concentration distribution of active particles we examine the skewness γ 1 and kurtosis γ 2 for different p e z which are defined as wang and chen 2017 44 γ 1 ν 3 ν 2 3 2 45 γ 2 ν 4 ν 2 2 2 respectively where ν 3 and ν 4 represents the third and fourth order central concentration moments the depth averaged γ 1 and γ 2 are denoted by γ 1 and γ 2 for the case of weak self migration the active particles displays the positive skewness for the short time evolution and the negative skewness for the long time evolution the large p e z can weaken the positive skewness as shown in figs 8 and 9 positive skewness indicates that the downstream concentration is more uniform than upstream jiang et al 2017 the positive γ 2 means that the distribution is more concentrated while the negative γ 2 means that the distribution is flatter during the initial stage the large p e z can result in the large positive kurtosis as shown in figs 10 and 11 the necessary time for γ 2 to reach an asymptotic constant decreases with the increase of p e z γ 1 and γ 2 eventually tend to zero due to the translational diffusion and molecular diffusion as shown in fig 12 3 5 concentration distribution of active particles using the long time asymptotic expansion of chatwin 1970 an edgeworth expansion guo et al 2018 jiang and chen 2019 we obtain the solution of spatial concentration distribution of active particles in the laminar open channel flow 46 ω ξ ζ t m 0 2 π σ e x 2 2 n 0 a n ζ τ n σ n h e n x where x ξ ξ c σ is the standardized variable h e n is the hermite polynomials expressed as 47 h e n x 1 n e x 2 2 d n d x n e x 2 2 n 0 1 2 and the coefficients a n are given by 48 a 0 1 a 1 0 a 2 0 a 3 ν 3 a 4 ν 4 2 ν 2 2 the first four coefficients of a n are a reasonable approximation to the solution figs 13 16 present the variation of concentration with ξ and ζ for different p e z at τ 0 05 0 1 1 0 and 10 0 during the initial stage the active particles initially on the bed bottom spreads towards the free water surface the vertical self migration velocity and translational diffusion cause the active particles more easily spread in the ambient water as shown in fig 13 there exists a sharp concentration distribution near the free water surface at τ 1 for large p e z in contrast to the relative uniform distribution of active particles in the vertical direction for small p e z as shown in figs 14 and 15 the contrast between uniformity and non uniformity of active particles for different p e z is more obvious for τ 10 as shown in fig 16 the longitudinal distribution of depth averaged concentration is presented for τ 0 05 0 1 1 0 and 10 0 as shown in fig 17 during the initial stage the position of maximum depth averaged concentration is biased upstream fig 17 a b while during the long time evolution the position is biased downstream the large p e z causes the mean distribution to be more concentrated near the free water surface 4 conclusions the migration of buoyancy controlled active particles in a laminar open channel flow is significant for understanding various ecological and bio1ogical processes in ambient water for example the harmful algae blooms in the long distance water conveyance project a theoretical analysis has been performed to explore the migration of buoyancy controlled active particles in a laminar open channel flow under the combined action of ambient flow and self migration of active particles the analytical solution of the mass distribution moving velocity of mass center longitudinal dispersivity skewness and kurtosis have been rigorously derived for the active particles in a laminar open channel flow using aris concentration moment method similar to the transport of passive particles the mass distribution moving velocity of mass center and longitudinal dispersion eventually reach a stable status in a laminar open channel flow with a necessary time of 3 π 2 p e z 2 4 however the distribution of total active particles over each a streamline displays the characteristics of an exponential distribution rather than a uniform distribution for the passive particle cloud the moving velocity of the mass center of the active particle cloud is not equal to the depth averaged flow velocity for the passive particles the longitudinal dispersivity increases to the peak and decreases to an asymptotic constant for the active particle cloud in contrast to the monotonic variation of depth averaged longitudinal dispersivity the strong vertical self migration velocity can result in negative skewness and positive kurtosis for the active particle cloud during the initial stage the concentration distribution is derived based on the combination of chatwin s long time asymptotic expansion and central concentration moments there exists a distinct difference between the active and passive particles in the laminar open channel flow the former cannot reach a uniform status even for the long time evolution due to the effects of vertical self migration while the latter can reach a uniform distribution across the channel for the large p e z the active particles concentrate near the free water surface it is also found that the position of the maximum depth averaged concentration does not coincide with the origin which moves at the depth average velocity which is consistent with the analysis of the first order concentration moment for the migration of active particle cloud it is noted that the active particles considered here are the buoyancy controlled particles which can only self migrate in the vertical direction by the buoyancy due to the density difference of them and ambient water rather than the active particles which can swim in all directions by waving undulating or rotating flagella or cilia although we validate our solution for the long time evolution of active particles to some extent by comparing the total quantity of active particles along each streamline some separated experiments matching this work is still deserved to perform in the future to help us understand the migration of active particles more deeply and comprehensively testify the analytical solution of distribution of the active particles in a laminar open channel flow especially during the initial stage credit authorship contribution statement y yang writing original draft methodology w q jiang methodology y h wu methodology p wang methodology z wu methodology writing review editing b zhang methodology l zeng methodology writing review editing declaration of competing interest we declare that we have no financial and personal relationships with other people or organizations that can inappropriately influence our work there is no professional or other personal interest of any nature or kind in any product service and or company that could be construed as influencing the position presented in or the review of the manuscript entitled migration of buoyancy controlled active particles in a laminar open channel flow acknowledgments this work is supported by the national key r d program of china grant no 2016yfc0502202 the iwhr research development support program grant nos hy0145b402016 and hy0145b682017 and the independent research project of state key laboratory of simulation and regulation of water cycle in river basin grant no skl2020zy05 authors greatly appreciated the valuable and helpful comments from editor and anonymous reviewers which helped us improve the quality of this work greatly appendix a solution of m 3 a 1 m 3 m 3 a m 3 b m 3 c a 2 m 3 a n m 0 λ m λ n 6 d l r e τ λ m e τ λ n τ χ n φ m ψ n m λ m λ n n m 0 λ m λ n 6 d l r e τ λ n τ 2 χ n φ m ψ n m n m k l 0 λ l λ k λ l λ m λ l λ n 6 e τ λ l e τ λ n χ n φ l ψ k l ψ m k ψ n m λ k λ l λ l λ m λ l λ n n m k l 0 λ l λ k λ l λ m λ l λ n 6 e τ λ n τ χ n φ l ψ k l ψ m k ψ n m λ k λ n λ m λ n n m k l 0 λ l λ k λ l λ m λ m λ n 6 e τ λ m e τ λ n χ n φ l ψ k l ψ m k ψ n m λ k λ l λ l λ m λ m λ n n m k l 0 λ l λ k λ l λ m λ m λ n 6 e τ λ n τ χ n φ l ψ k l ψ m k ψ n m λ k λ l λ l λ n n m k l 0 λ l λ k λ l λ m λ m λ n 6 χ n φ l ψ k l ψ m k ψ n m e τ λ n e τ λ m τ λ m e τ λ m 1 τ λ n λ k λ m λ m λ n 2 n m k l 0 λ l λ k λ l λ m λ m λ n 3 e τ λ n τ 2 χ n φ l ψ k l ψ m k ψ n m λ k λ n a 3 m 3 b n m k l 0 λ l λ k λ k λ m λ k λ n 6 e τ λ k e τ λ n χ n φ l ψ k l ψ m k ψ n m λ k λ l λ k λ m λ k λ n n m k l 0 λ l λ k λ k λ m λ k λ n 6 e τ λ n τ χ n φ l ψ k l ψ m k ψ n m λ l λ n λ m λ n n m k l 0 λ l λ k λ k λ m λ m λ n 6 e τ λ m e τ λ n χ n φ l ψ k l ψ m k ψ n m λ k λ l λ k λ m λ m λ n n m k l 0 λ l λ k λ k λ m λ m λ n 6 e τ λ n τ χ n φ l ψ k l ψ m k ψ n m λ k λ l λ k λ n n m k l 0 λ l λ k λ k λ m λ m λ n 6 χ n φ l ψ k l ψ m k ψ n m e τ λ n e τ λ m τ λ m e τ λ m 1 τ λ n λ l λ m λ m λ n 2 n m k l 0 λ l λ k λ k λ m λ m λ n 3 e τ λ n τ 2 χ n φ l ψ k l ψ m k ψ n m λ l λ n n m k l 0 λ l λ k λ k λ m λ l λ n 6 χ n φ l ψ k l ψ m k ψ n m e τ λ l τ λ l 2 e τ λ n λ m e τ λ n λ n λ l λ m 2 λ l λ n 2 n m k l 0 λ l λ k λ k λ m λ l λ n 6 χ n φ l ψ k l ψ m k ψ n m e τ λ l λ m λ n τ λ m λ n λ l λ m 2 λ l λ n 2 n m k l 0 λ l λ k λ k λ m λ l λ n 6 χ n φ l ψ k l ψ m k ψ n m λ l 2 e τ λ n e τ λ l 2 τ λ m τ λ n λ l λ m 2 λ l λ n 2 n m k l 0 λ l λ k λ k λ m λ l λ n 3 e τ λ n τ χ n φ l ψ k l ψ m k ψ n m 2 τ λ m τ λ n λ m λ n 2 n m k l 0 λ l λ k λ k λ m λ m λ n 6 e τ λ m e τ λ n χ n φ l ψ k l ψ m k ψ n m λ l λ m 2 λ m λ n a 4 m 3 c n m k l 0 λ l λ k λ k λ m λ m λ n 6 e τ λ n τ χ n φ l ψ k l ψ m k ψ n m λ l λ n 2 n m k l 0 λ l λ k λ k λ m λ m λ n 6 χ n φ l ψ k l ψ m k ψ n m e τ λ n λ m λ n 3 n m k l 0 λ l λ k λ k λ m λ m λ n 3 χ n φ l ψ k l ψ m k ψ n m e τ λ m 2 τ 2 λ m 2 2 τ λ n τ 2 λ n 2 λ m λ n 3 n m k l 0 λ l λ k λ k λ m λ m λ n 6 χ n φ l ψ k l ψ m k ψ n m e τ λ m τ λ m 1 τ λ n λ m λ n 3 n m k l 0 λ l λ k λ k λ m λ m λ n e τ λ n τ 3 χ n φ l ψ k l ψ m k ψ n m where is the truth functional operator of logical conjunction appendix b solution of m 0 following the method by yang et al 2020 the detailed solving processes are given as follows with the transformation of b 1 m 0 exp p e z 2 τ 4 p e z ζ 2 m 0 ζ τ eqs 18 20 reduce to b 2 m 0 τ 2 m 0 ζ 2 b 3 m 0 ζ 0 δ ζ exp p e z ζ 2 b 4 p e z 2 m 0 m 0 ζ ζ 0 1 0 the eigenvalue problem corresponding to eqs b 2 and b 4 is given by b 5 2 χ ζ 2 λ χ 0 b 6 p e z 2 χ χ ζ ζ 0 1 0 where χ is the eigenfunction and λ is the corresponding eigenvalue solving eqs b 5 and b 6 gives b 7 χ 0 c 0 exp p e z ζ 2 λ 0 p e z 2 4 b 8 χ n c n sin n π ζ 2 n π p e z cos n π ζ λ n n 2 π 2 n 1 2 m 0 can be expressed with eigenfunction as b 9 m 0 n 0 φ n χ n e λ n τ b 10 φ n 0 1 δ ζ exp p e z ζ 2 χ n ζ d ζ using the initial condition eq b 3 with the aid of eqs b 7 and b 8 we have b 11 c 0 1 0 1 exp p e z ζ 2 exp p e z ζ 2 d ζ p e z exp p e z 1 b 12 c n 1 0 1 sin n π ζ 2 n π p e z cos n π ζ sin n π ζ 2 n π p e z cos n π ζ d ζ 2 p e z 2 p e z 2 4 n 2 π 2 then we have b 13 m 0 ζ τ p e z exp p e z 1 exp p e z 2 ζ exp p e z 2 4 τ n 1 4 n π p e z 4 n 2 π 2 p e z 2 sin n π ζ 2 n π p e z cos n π ζ exp n 2 π 2 τ substituting eq b 13 into eq b 1 gives b 14 m 0 ζ τ p e z exp p e z 1 exp p e z ζ n 1 4 n π p e z 4 n 2 π 2 p e z 2 sin n π ζ 2 n π p e z cos n π ζ exp p e z 2 ζ exp 4 n 2 π 2 p e z 2 4 τ the explanation of the key step to solve p th concentration moment p 0 there only exists a slight difference for solving the governing equations of p th concentration moment p 0 and that of zeroth concentration moment and we only need to add a transformation according to the duhamel s second principle yang et al 2020 
241,the migration of active particles in a laminar open channel flow is significant for many ecological and biological processes associated with ambient water for example the harmful algae blooms in the long distance water conveyance project this paper presents an analytical analysis of the migration of the buoyancy controlled active particles in a laminar open channel flow the analytical solution of concentration distribution has also been derived for the active particle cloud in the laminar open channel flow under the combined action of ambient flow and self migration of active particles by combing chatwin s long time asymptotic expansion and central concentration moments the analytical solution shows that the active particle cloud accumulates near the surface rather than uniform distribution in the cross section even for the long time evolution the analytical solutions are also been rigorously derived to reflect the holistic characteristics of the active particle cloud including the total quantity over each streamline moving velocity of mass center longitudinal dispersivity skewness and kurtosis have been rigorously derived for an instantaneous point source in a laminar open channel flow it is found that the distribution of total active particles over each streamline centroid motion and longitudinal dispersion eventually reach a stable status with a necessary time dependent on the relative strength of the vertical migration velocity and the total vertical diffusion however the self migration of active particles results in the deviation of the moving velocity of mass center from the depth averaged flow velocity the longitudinal dispersivity of the active particle cloud gradually increases to the peak and then decreases to a constant value in contrast to the monotonous increase for the passive particle cloud it is also found that the strong vertical self migration can result in changes of skewness and kurtosis of concentration distribution negative skewness and positive kurtosis during the initial stage however both of them gradually tend to zero for the long time evolution of the active particle cloud keywords environmental dispersion active particles open channel flow nomenclature c concentration of active particles number of cells m 3 d longitudinal dispersion coefficient dimensionless d depth averaged d dimensionless d l r ratio of the total longitudinal diffusivity to the total vertical diffusivity dimensionless h water depth m h e n hermite polynomials m p p th p 0 1 2 concentration moment dimensionless p e x péclet number associated with advection and total vertical diffusion dimensionless p e z péclet number associated with vertical self migration and total vertical diffusion dimensionless q total number of active particles dimensionless t time s u longitudinal flow velocity ms 1 u depth averaged longitudinal flow velocity ms 1 u flow velocity ms 1 u b migration velocity of active particles ms 1 v c moving velocity of the mass center of active particles dimensionless v c depth averaged v c dimensionless w b self migration velocity of active particles ms 1 x z coordinates in the longitudinal and vertical direction m x standardized variable dimensionless φ flow velocity deviation from its mean dimensionless λ mass diffusivity m 2 s 1 λ b translational diffusivity tensor of active particles m 2 s 1 λ x x b longitudinal component of λ b m 2 s 1 λ z z b vertical component of λ b m 2 s 1 τ dimensionless time dimensionless ψ dimensionless self migration velocity of active particles dimensionless ξ dimensionless coordinate in the longitudinal direction dimensionless ζ dimensionless coordinate in the vertical direction dimensionless ν p p th central concentration moment dimensionless γ 1 skewness dimensionless γ 1 depth averaged γ 1 dimensionless γ 2 kurtosis dimensionless γ 2 depth averaged γ 2 dimensionless χ n eigenfunction λ n eigenvalue ω dimensionless concentration dimensionless gradient operator δ delta function 1 introduction the migration of particles plays a significant role in many ecological and biological phenomena in ambient waters such as the harmful algal blooms in reservoirs river lakes and coastal zones biofilm formation on the surface of porous media associated with the constructed wetlands for wastewater treatment and occurrence of thin phytoplankton layer in oceans golian et al 2020 luo et al 2016 ostad ali askari et al 2019 wu et al 2011 wu and chen 2014 zeng et al 2019 zeng and pedley 2018 there exist two typical types of particles in waters namely the passive and active particles the former s migration mainly depends on the ambient flow and molecular diffusion while the latter relies on the combined action of ambient flow molecular diffusion and self migration due to external stimuli such as gravity light heat nutrient etc regarding the migration of passive particles there has been an abundance of theoretical analysis experimental measurement and field observation the pioneering work can trace back to classical analysis of solute dispersion through a circular tube by taylor 1953 who pointed out that the distribution of soluble materials eventually reaches uniform in the cross section due to the combined effects of velocity non uniformity and molecular diffusion aris 1956 presented the concentration moment method to describe the initial and long term transport of a solute in a tube in which the zeroth first second third and fourth central concentration moments reflect the mass distribution advection velocity dispersion rate skewness and kurtosis of the solute cloud respectively the governing equation of cross sectional mean concentration for the long time evolution of particles was also rigorously derived by mei et al 1996 using the multi scale perturbation method with small parameters the evolution of mean concentration during the whole transport process has been derived based on the expansion of concentration function chatwin 1970 gill 1967 yu and chang 1991 developed a method to compute the solute concentration in a wall bounded channel based on green s function taylor dispersion analysis the concentration moment method the multi scale perturbation method and the expansion of concentration function have been widely applied to investigate the transport of passive particles in the tube flows ng 2002 wu et al 2012 ostad ali askari et al 2020 open channel flows ng 2000 ng and yip 2001 wang and huai 2016 guo et al 2018 derakhshannia et al 2020 wetland flows chen 2013 luo et al 2017 nepf 2011 yang et al 2016 2020 zeng et al 2019 and natural rivers wang and huai 2016 wang and chen 2017 differing from the transport of passive particles in ambient flows the migration of active particles is also affected by their self migration usually cells self migration through the water body is achieved by waving their appendages such as flagella or cilia and regulating cells buoyancy many efforts have been made to understand the distribution of active particles propelled by waving their flagella or cilia such as chlamydomonas reinhardtii and heterosigma akashiwo in various flow patterns distinguishing from the concentration distribution of passive particles self migration results in many unique distribution patterns such as the circumferential accumulation of cells on the tube wall for an upward poiseuille flow and central accumulation for a downward flow kessler 1985 shear induced generation of thin phytoplankton layer durham et al 2009 microscale patches driven by turbulence structures durham 2013 and cell accumulation in the lee of the cylinder and depletion on the leading side zeng and pedley 2018 very recently the migration of flagella driven active particles in the free surface constructed wetland flow has also been analyzed yang et al 2020 zeng et al 2019 various experimental observations and numerical simulation have also been performed to examine the vertical distribution of buoyancy controlled active particles ostad ali askari and shayannejad 2021 wu et al 2020 salehi hafshejani et al 2019 missaghi et al 2016 rowe et al 2016 medrano et al 2013 wu and kong 2010 hunter et al 2008 o brien et al 2004 kanoshina et al 2003 for example microcystis colonies however the buoyancy controlled active particles migration in an open channel flow has not been understood very well especially the characteristics of overall transport and concentration distribution across the channel with regarding the theoretical analysis of the migration of particles in the open channel laminar flow previous work mainly focused on the total quantity over each streamline moving velocity of mass center passive particles the longitudinal dispersivity skewness and kurtosis of the passive particle cloud the effects of the self migration of active particles on those transport characteristics are not clear although some analytical solutions yang et al 2020 zeng et al 2019 have been reported on the migration of active particles in some idealized wetland flows they mainly focused on the total quantity over each streamline moving velocity mass center and the longitudinal dispersion however the combined action of ambient flow and self migration on the skewness and kurtosis is not well understood for the active particle cloud in the idealized wetland flows more importantly the previous analytical solution on active particle distribution mainly focused on the characteristics of holistic transport rather than the distribution of active particles presented in this work is a theoretical analysis of the transport of buoyancy controlled active particles in an open channel flow including the analytical solution of active particle concentration as well as the comprehensive analysis for the holistic properties of active particles cloud the total quantity over each streamline moving velocity of mass center the longitudinal dispersivity skewness and kurtosis of the active particle cloud presented in this work is a theoretical analysis of the transport of buoyancy controlled active particles in an open channel flow the specific objects of this work are i to formulate the concentration transport of a buoyancy controlled active particle cloud ii to reveal the characteristics of total quantity over each streamline moving velocity of the mass center longitudinal dispersion skewness and kurtosis of the active particles cloud and iii to obtain the concentration distribution of the active particle cloud 2 formulation for a laminar open channel flow the concentration transport of buoyancy controlled active particles is governed by guo et al 2018 yang et al 2020 zeng et al 2019 1 c t u u b c λ b c λ c where c is the concentration of active particles t is time u is the flow velocity u b and λ b are the migration velocity and the translational diffusivity tensor of the active particles respectively and λ is the mass diffusivity λ b reflects the random motion of the buoyancy controlled active particles due to the irregularity of particle shape while λ reflects the effects of brownian motion of water molecules for the large particles for example microcystis colonies the former plays a leading role eq 1 shows that the concentration distribution of active particles is attributed to four factors i e the advection of ambient flow molecular diffusion the mean self migration velocity and the translational diffusion the last two factors mainly depend on the biological behaviour although sometimes they are also affected by the ambient flow in the present work we focus on the dilute suspensions of active particles which means that the effect of active particles on ambient flow can be neglected however it is necessary to consider the effects of active particles on the flow for the dense suspensions of active particles in which the bio convection can occur for the limiting case of u b 0 and λ b 0 eq 1 reduces to the concentration equation of passive particles in corresponding flows consider the migration of a buoyancy controlled active particle cloud in a steady laminar open channel flow in a cartesian coordinate system with x axis parallel to the direction of the water flow z axis vertically upwards and the origin located at the bottom of the channel as shown in fig 1 the flow velocity profile can be expressed as u z 3 z 2 h z u 2 h 2 where u is the cross sectional average velocity and h is the water depth as the first step of theoretical analysis of the active particles cloud in the open channel flow we assume that the active particle as a rigid sphere with a constant velocity in the vertical direction and eq 1 reduces to 2 c t u c x w b c z λ λ x x b 2 c x 2 λ λ z z b 2 c z 2 where u is the longitudinal flow velocity w b is the self migration velocity of active particles and λ x x b and λ z z b are the longitudinal and vertical components of translational diffusivity tensor respectively in previous work by yang et al 2020 they focused on the gyrotatic micro organisms which can swim in all directions by waving undulating or rotating flagella or cilia therefore the longitudinal swimming velocity exists in the concentration transport equation in their work however in the present work we focus on the buoyancy controlled active particles for example m i c r o c y s t i s colonies this type of active particles only self migrate in the vertical direction because the driving force to control their self migration i e the mean buoyancy due to the density difference of them and ambient water is always in the vertical direction consider an instantaneous point source located at x 0 and z 0 the initial condition for particle concentration can be expressed as 3 c x z t t 0 q δ x δ z where q is the total number of active particles and δ is the dirac delta function the concentration boundary conditions at x z 0 and z h are given by 4 c x z t x 0 5 w b c λ λ z z b c z z 0 h 0 the idealized initial condition employed in the present work can be considered as a simplification of active particles patches the boundary condition eq 5 means that there exists a balance between the advective flux due to the self migration velocity and the diffusivity flux caused by the molecular diffusion and translation diffusion of active particles eq 5 also means that all active particles cannot penetrate through the water surface and the bed bottom and that adsorption and desorption do not occur with dimensionless parameters 6 ω c h 2 q τ λ λ z z b t h 2 ξ x u t h ζ z h φ u u u ψ w b u eqs 2 5 can be rewritten as 7 ω τ p e x φ ω ξ p e x ψ ω ζ d l r 2 ω ξ 2 2 ω ζ 2 8 ω ξ ζ 0 ξ 0 9 p e x ψ ω ω ζ ζ 0 1 0 10 ω ξ ζ 0 δ ξ δ ζ where p e x u h λ λ z z b is the péclet number to reflect the relative strength of the advection and total vertical diffusion and d l r λ λ x x b λ λ z z b is the ratio of the total longitudinal diffusivity to the total vertical diffusivity the concentration moment method is extend to analyze the migration of the buoyancy controlled active particle cloud in the laminar open channel flow the p th concentration moment and p th central concentration moment are defined as aris 1956 11 m p ζ τ ω ξ ζ τ ξ p d ξ p 0 1 2 12 ν p ξ ξ c p ω d ξ ω d ξ respectively where 13 ξ c ξ ω d ξ ω d ξ m 1 m 0 is the position of mass center from the above definition the higher order central concentration moments are given by 14 ν 2 m 2 m 0 ξ c 2 15 ν 3 m 3 m 0 3 ξ c ν 2 ξ c 3 16 ν 4 m 4 m 0 4 ξ c ν 3 6 ξ c 2 ν 2 ξ c 4 since the concentration of active particles in the moving water has the characteristics of exponential attenuation satisfies the following relationship barton 1983 yang et al 2020 17 ξ i ω i i ω ξ i ξ i j ω ξ j 0 i 1 2 j 1 2 3 results and discussion 3 1 total quantity of active particles over each streamline applying the operation ξ 0 d ξ to eqs 7 9 and 10 with the aid of eq 17 gives the definite solution problem of m 0 including the governing equation and boundary and initial conditions 18 m 0 τ p e z m 0 ζ 2 m 0 ζ 2 19 m 0 ζ 0 δ ζ 20 p e z m 0 m 0 ζ ζ 0 1 0 where p e z p e ψ is the péclet number to reflect the relative strength of the vertical self migration and the total vertical diffusion following the method by yang et al 2020 we obtain the solution of m 0 21 m 0 exp p e z 2 τ 4 p e z ζ 2 n 0 φ n χ n e λ n τ where 22 χ 0 c 0 exp p e z ζ 2 λ 0 p e z 2 4 23 χ n c n sin n π ζ 2 n π p e z cos n π ζ λ n n 2 π 2 n 1 2 24 c 0 p e z exp p e z 1 25 c n 2 p e z 2 p e z 2 4 n 2 π 2 26 φ n 0 1 δ ζ exp p e z ζ 2 χ n ζ d ζ the zeroth order concentration moment reflects the total quantity variation of the active particles over each streamline with time and vertical position it is shown that m 0 eventually reaches a stable status under the combined effect of vertical advection and diffusion as shown in fig 2 the final distribution of m 0 and the necessary time to reach the stable status depend on p e z for the small p e z m 0 approximately satisfies a uniform distribution in the vertical direction while for the large p e z it tends to an exponential distribution the necessary time to obtain the stable status is 3 π 2 p e z 2 4 which has the same form for the migration of active particles in the free surface wetland flow yang et al 2020 the large p e z can diminish the time for m 0 to reach the stable status for the long time evolution of active particles in the flowing water the distribution of the total quantity of active particles along each streamline in the vertical position i e m 0 eventually attain the same status if the initial distribution is a dirac delta function we compared the analytical solution of m 0 in the present work and that by yang et al 2020 it is found that for τ 1 m 0 eventually reach a stable status 27 m 0 ζ τ p e z exp p e z 1 exp p e z ζ which is consistent with the analytical solution by yang et al 2020 3 2 motion of mass center applying the operation ξ d ξ to eqs 7 9 and 10 with the aid of eq 17 gives the definite solution problem of m 1 including the governing equation and boundary and initial conditions 28 m 1 τ p e z m 1 ζ 2 m 1 ζ 2 p e x φ m 0 29 m 1 ζ 0 0 30 p e z m 1 m 1 ζ ζ 0 1 0 with the integral transform technique we obtain the solution of m 1 31 m 1 exp p e z 2 τ 4 p e z ζ 2 m 1 ζ τ where 32 m 1 n m 0 λ m λ n e τ λ m e τ λ n χ n φ m ψ n m λ m λ n n 0 e τ λ n τ χ n φ n ψ n n where 33 ψ n m 0 1 χ n ζ χ m ζ pe x φ ζ d ζ the moving velocity of the mass center of active particles over each streamline can be expressed as v c d ξ c d τ the depth averaged v c is denoted by v c fig 3 presents the variation of v c with time and depth for different p e z during the initial stage the motion of the centroid of active particles over each streamline near the bed bottom is slower than that near the free water surface since the active particle cloud is initially located on the bed bottom the difference of v c for different vertical positions gradually disappears under the combined action of the vertical translational diffusion molecular diffusion and vertical swimming for long time evolution of the active particle cloud near the bed bottom v c increases to the peak and then decreases to a constant for the large p e z in contrast to the monotonous variation of v c for the small p e z the increase of p e z can enhance v c at the stable status and reduce the necessary time to reach the status as shown in fig 3 for the limiting case of p e z 0 v c tends to zero fig 4 shows the variation of v c with time the large p e z results in the large v c differing from the variation of v c with τ for the active particles near the bed bottom v c keeps the monotonous increase during the initial stage 3 3 longitudinal dispersion applying the operation ξ 2 d ξ to eqs 7 9 and 10 with the aid of eq 17 gives the definite solution problem of m 2 including the governing equation and boundary and initial conditions 34 m 2 τ p e z m 2 ζ 2 m 2 ζ 2 p e x φ 2 m 1 2 d l r m 0 35 m 2 ζ 0 0 36 p e z m p m p ζ ζ 0 1 0 with the integral transform technique we obtain the solution of m 2 37 m 2 exp p e z 2 τ 4 p e z ζ 2 m 2 ζ τ where 38 m 2 n 0 2 d l r e τ λ n τ χ n φ n n m k 0 λ k λ m λ k λ n 2 e τ λ k e τ λ n χ n φ k ψ m k ψ n m λ k λ m λ k λ n n m k 0 λ k λ m λ k λ n 2 e τ λ n τ χ n φ k ψ m k ψ n m λ m λ n n m k 0 λ k λ m λ m λ n 2 e τ λ m e τ λ n χ n φ k ψ m k ψ n m λ k λ m λ m λ n n m k 0 λ k λ m λ m λ n 2 e τ λ n τ χ n φ k ψ m k ψ n m λ k λ n n m k 0 λ k λ m λ m λ n 2 χ n φ k ψ m k ψ n m e τ λ n e τ λ m t λ m e τ λ m 1 τ λ n λ m λ n 2 n m k 0 λ k λ m λ m λ n e τ λ n τ 2 χ n φ k ψ m k ψ n m the longitudinal dispersivity of active particles can be expressed as wang and chen 2017 39 d 1 2 d ν 2 d τ where ν 2 is the second order central concentration moment the depth averaged longitudinal dispersivity is denoted by d fig 5 presents the evolution of d with τ and ζ it is shown that d eventually increases to an asymptotic constant similar to the variation of v c with ζ and τ d displays a monotonous increase for the active particles near the free water surface during the initial stage and a nonmonotonic variation near the bed the value of dispersivity increases in the initial time and eventually reaches a stable status for a long time evolution the maximum longitudinal dispersivity of the active particle cloud near the bed bottom is stronger than that near the free water surface as shown in fig 6 fig 7 presents the variation of d with τ d increases to the peak and then decreases to a constant value for the active particle cloud in contrast to the monotonic increase of that for the passive particle cloud the vertical migration of active particles can weaken the longitudinal dispersion 3 4 skewness and kurtosis the governing equation and boundary and initial conditions for the third and fourth order concentration moments m p ζ τ p 3 4 can be expressed as 40 m p τ p e z m p ζ 2 m p ζ 2 p p e x φ m p 1 p p 1 d l r m p 2 41 m p ζ 0 0 42 p e z m p m p ζ ζ 0 1 0 with the integral transform technique we obtain the solution of m 3 43 m 3 exp p e z 2 τ 4 p e z ζ 2 m 3 ζ τ the expression of m 3 ζ τ has been given in the appendix a the analytical solution of m 4 is too lengthy to be shown here to explore the effects of vertical self migration on the asymmetry and outliers of the concentration distribution of active particles we examine the skewness γ 1 and kurtosis γ 2 for different p e z which are defined as wang and chen 2017 44 γ 1 ν 3 ν 2 3 2 45 γ 2 ν 4 ν 2 2 2 respectively where ν 3 and ν 4 represents the third and fourth order central concentration moments the depth averaged γ 1 and γ 2 are denoted by γ 1 and γ 2 for the case of weak self migration the active particles displays the positive skewness for the short time evolution and the negative skewness for the long time evolution the large p e z can weaken the positive skewness as shown in figs 8 and 9 positive skewness indicates that the downstream concentration is more uniform than upstream jiang et al 2017 the positive γ 2 means that the distribution is more concentrated while the negative γ 2 means that the distribution is flatter during the initial stage the large p e z can result in the large positive kurtosis as shown in figs 10 and 11 the necessary time for γ 2 to reach an asymptotic constant decreases with the increase of p e z γ 1 and γ 2 eventually tend to zero due to the translational diffusion and molecular diffusion as shown in fig 12 3 5 concentration distribution of active particles using the long time asymptotic expansion of chatwin 1970 an edgeworth expansion guo et al 2018 jiang and chen 2019 we obtain the solution of spatial concentration distribution of active particles in the laminar open channel flow 46 ω ξ ζ t m 0 2 π σ e x 2 2 n 0 a n ζ τ n σ n h e n x where x ξ ξ c σ is the standardized variable h e n is the hermite polynomials expressed as 47 h e n x 1 n e x 2 2 d n d x n e x 2 2 n 0 1 2 and the coefficients a n are given by 48 a 0 1 a 1 0 a 2 0 a 3 ν 3 a 4 ν 4 2 ν 2 2 the first four coefficients of a n are a reasonable approximation to the solution figs 13 16 present the variation of concentration with ξ and ζ for different p e z at τ 0 05 0 1 1 0 and 10 0 during the initial stage the active particles initially on the bed bottom spreads towards the free water surface the vertical self migration velocity and translational diffusion cause the active particles more easily spread in the ambient water as shown in fig 13 there exists a sharp concentration distribution near the free water surface at τ 1 for large p e z in contrast to the relative uniform distribution of active particles in the vertical direction for small p e z as shown in figs 14 and 15 the contrast between uniformity and non uniformity of active particles for different p e z is more obvious for τ 10 as shown in fig 16 the longitudinal distribution of depth averaged concentration is presented for τ 0 05 0 1 1 0 and 10 0 as shown in fig 17 during the initial stage the position of maximum depth averaged concentration is biased upstream fig 17 a b while during the long time evolution the position is biased downstream the large p e z causes the mean distribution to be more concentrated near the free water surface 4 conclusions the migration of buoyancy controlled active particles in a laminar open channel flow is significant for understanding various ecological and bio1ogical processes in ambient water for example the harmful algae blooms in the long distance water conveyance project a theoretical analysis has been performed to explore the migration of buoyancy controlled active particles in a laminar open channel flow under the combined action of ambient flow and self migration of active particles the analytical solution of the mass distribution moving velocity of mass center longitudinal dispersivity skewness and kurtosis have been rigorously derived for the active particles in a laminar open channel flow using aris concentration moment method similar to the transport of passive particles the mass distribution moving velocity of mass center and longitudinal dispersion eventually reach a stable status in a laminar open channel flow with a necessary time of 3 π 2 p e z 2 4 however the distribution of total active particles over each a streamline displays the characteristics of an exponential distribution rather than a uniform distribution for the passive particle cloud the moving velocity of the mass center of the active particle cloud is not equal to the depth averaged flow velocity for the passive particles the longitudinal dispersivity increases to the peak and decreases to an asymptotic constant for the active particle cloud in contrast to the monotonic variation of depth averaged longitudinal dispersivity the strong vertical self migration velocity can result in negative skewness and positive kurtosis for the active particle cloud during the initial stage the concentration distribution is derived based on the combination of chatwin s long time asymptotic expansion and central concentration moments there exists a distinct difference between the active and passive particles in the laminar open channel flow the former cannot reach a uniform status even for the long time evolution due to the effects of vertical self migration while the latter can reach a uniform distribution across the channel for the large p e z the active particles concentrate near the free water surface it is also found that the position of the maximum depth averaged concentration does not coincide with the origin which moves at the depth average velocity which is consistent with the analysis of the first order concentration moment for the migration of active particle cloud it is noted that the active particles considered here are the buoyancy controlled particles which can only self migrate in the vertical direction by the buoyancy due to the density difference of them and ambient water rather than the active particles which can swim in all directions by waving undulating or rotating flagella or cilia although we validate our solution for the long time evolution of active particles to some extent by comparing the total quantity of active particles along each streamline some separated experiments matching this work is still deserved to perform in the future to help us understand the migration of active particles more deeply and comprehensively testify the analytical solution of distribution of the active particles in a laminar open channel flow especially during the initial stage credit authorship contribution statement y yang writing original draft methodology w q jiang methodology y h wu methodology p wang methodology z wu methodology writing review editing b zhang methodology l zeng methodology writing review editing declaration of competing interest we declare that we have no financial and personal relationships with other people or organizations that can inappropriately influence our work there is no professional or other personal interest of any nature or kind in any product service and or company that could be construed as influencing the position presented in or the review of the manuscript entitled migration of buoyancy controlled active particles in a laminar open channel flow acknowledgments this work is supported by the national key r d program of china grant no 2016yfc0502202 the iwhr research development support program grant nos hy0145b402016 and hy0145b682017 and the independent research project of state key laboratory of simulation and regulation of water cycle in river basin grant no skl2020zy05 authors greatly appreciated the valuable and helpful comments from editor and anonymous reviewers which helped us improve the quality of this work greatly appendix a solution of m 3 a 1 m 3 m 3 a m 3 b m 3 c a 2 m 3 a n m 0 λ m λ n 6 d l r e τ λ m e τ λ n τ χ n φ m ψ n m λ m λ n n m 0 λ m λ n 6 d l r e τ λ n τ 2 χ n φ m ψ n m n m k l 0 λ l λ k λ l λ m λ l λ n 6 e τ λ l e τ λ n χ n φ l ψ k l ψ m k ψ n m λ k λ l λ l λ m λ l λ n n m k l 0 λ l λ k λ l λ m λ l λ n 6 e τ λ n τ χ n φ l ψ k l ψ m k ψ n m λ k λ n λ m λ n n m k l 0 λ l λ k λ l λ m λ m λ n 6 e τ λ m e τ λ n χ n φ l ψ k l ψ m k ψ n m λ k λ l λ l λ m λ m λ n n m k l 0 λ l λ k λ l λ m λ m λ n 6 e τ λ n τ χ n φ l ψ k l ψ m k ψ n m λ k λ l λ l λ n n m k l 0 λ l λ k λ l λ m λ m λ n 6 χ n φ l ψ k l ψ m k ψ n m e τ λ n e τ λ m τ λ m e τ λ m 1 τ λ n λ k λ m λ m λ n 2 n m k l 0 λ l λ k λ l λ m λ m λ n 3 e τ λ n τ 2 χ n φ l ψ k l ψ m k ψ n m λ k λ n a 3 m 3 b n m k l 0 λ l λ k λ k λ m λ k λ n 6 e τ λ k e τ λ n χ n φ l ψ k l ψ m k ψ n m λ k λ l λ k λ m λ k λ n n m k l 0 λ l λ k λ k λ m λ k λ n 6 e τ λ n τ χ n φ l ψ k l ψ m k ψ n m λ l λ n λ m λ n n m k l 0 λ l λ k λ k λ m λ m λ n 6 e τ λ m e τ λ n χ n φ l ψ k l ψ m k ψ n m λ k λ l λ k λ m λ m λ n n m k l 0 λ l λ k λ k λ m λ m λ n 6 e τ λ n τ χ n φ l ψ k l ψ m k ψ n m λ k λ l λ k λ n n m k l 0 λ l λ k λ k λ m λ m λ n 6 χ n φ l ψ k l ψ m k ψ n m e τ λ n e τ λ m τ λ m e τ λ m 1 τ λ n λ l λ m λ m λ n 2 n m k l 0 λ l λ k λ k λ m λ m λ n 3 e τ λ n τ 2 χ n φ l ψ k l ψ m k ψ n m λ l λ n n m k l 0 λ l λ k λ k λ m λ l λ n 6 χ n φ l ψ k l ψ m k ψ n m e τ λ l τ λ l 2 e τ λ n λ m e τ λ n λ n λ l λ m 2 λ l λ n 2 n m k l 0 λ l λ k λ k λ m λ l λ n 6 χ n φ l ψ k l ψ m k ψ n m e τ λ l λ m λ n τ λ m λ n λ l λ m 2 λ l λ n 2 n m k l 0 λ l λ k λ k λ m λ l λ n 6 χ n φ l ψ k l ψ m k ψ n m λ l 2 e τ λ n e τ λ l 2 τ λ m τ λ n λ l λ m 2 λ l λ n 2 n m k l 0 λ l λ k λ k λ m λ l λ n 3 e τ λ n τ χ n φ l ψ k l ψ m k ψ n m 2 τ λ m τ λ n λ m λ n 2 n m k l 0 λ l λ k λ k λ m λ m λ n 6 e τ λ m e τ λ n χ n φ l ψ k l ψ m k ψ n m λ l λ m 2 λ m λ n a 4 m 3 c n m k l 0 λ l λ k λ k λ m λ m λ n 6 e τ λ n τ χ n φ l ψ k l ψ m k ψ n m λ l λ n 2 n m k l 0 λ l λ k λ k λ m λ m λ n 6 χ n φ l ψ k l ψ m k ψ n m e τ λ n λ m λ n 3 n m k l 0 λ l λ k λ k λ m λ m λ n 3 χ n φ l ψ k l ψ m k ψ n m e τ λ m 2 τ 2 λ m 2 2 τ λ n τ 2 λ n 2 λ m λ n 3 n m k l 0 λ l λ k λ k λ m λ m λ n 6 χ n φ l ψ k l ψ m k ψ n m e τ λ m τ λ m 1 τ λ n λ m λ n 3 n m k l 0 λ l λ k λ k λ m λ m λ n e τ λ n τ 3 χ n φ l ψ k l ψ m k ψ n m where is the truth functional operator of logical conjunction appendix b solution of m 0 following the method by yang et al 2020 the detailed solving processes are given as follows with the transformation of b 1 m 0 exp p e z 2 τ 4 p e z ζ 2 m 0 ζ τ eqs 18 20 reduce to b 2 m 0 τ 2 m 0 ζ 2 b 3 m 0 ζ 0 δ ζ exp p e z ζ 2 b 4 p e z 2 m 0 m 0 ζ ζ 0 1 0 the eigenvalue problem corresponding to eqs b 2 and b 4 is given by b 5 2 χ ζ 2 λ χ 0 b 6 p e z 2 χ χ ζ ζ 0 1 0 where χ is the eigenfunction and λ is the corresponding eigenvalue solving eqs b 5 and b 6 gives b 7 χ 0 c 0 exp p e z ζ 2 λ 0 p e z 2 4 b 8 χ n c n sin n π ζ 2 n π p e z cos n π ζ λ n n 2 π 2 n 1 2 m 0 can be expressed with eigenfunction as b 9 m 0 n 0 φ n χ n e λ n τ b 10 φ n 0 1 δ ζ exp p e z ζ 2 χ n ζ d ζ using the initial condition eq b 3 with the aid of eqs b 7 and b 8 we have b 11 c 0 1 0 1 exp p e z ζ 2 exp p e z ζ 2 d ζ p e z exp p e z 1 b 12 c n 1 0 1 sin n π ζ 2 n π p e z cos n π ζ sin n π ζ 2 n π p e z cos n π ζ d ζ 2 p e z 2 p e z 2 4 n 2 π 2 then we have b 13 m 0 ζ τ p e z exp p e z 1 exp p e z 2 ζ exp p e z 2 4 τ n 1 4 n π p e z 4 n 2 π 2 p e z 2 sin n π ζ 2 n π p e z cos n π ζ exp n 2 π 2 τ substituting eq b 13 into eq b 1 gives b 14 m 0 ζ τ p e z exp p e z 1 exp p e z ζ n 1 4 n π p e z 4 n 2 π 2 p e z 2 sin n π ζ 2 n π p e z cos n π ζ exp p e z 2 ζ exp 4 n 2 π 2 p e z 2 4 τ the explanation of the key step to solve p th concentration moment p 0 there only exists a slight difference for solving the governing equations of p th concentration moment p 0 and that of zeroth concentration moment and we only need to add a transformation according to the duhamel s second principle yang et al 2020 
242,small scale bed form topographies control hyporheic exchange and biogeochemical processes within aquatic sediments which ultimately affect water quality and nutrient cycling at the watershed scale the impact of three dimensional and small scale bed form topographies on hyporheic exchange and solute mixing is investigated in the present work the effect of bed form morphologies on the development of zones of enhanced reaction rates i e hotspots is also studied a computational fluid dynamics model to simulate river flow over bed forms is combined with a subsurface flow and multicomponent reactive solute transport model a wide variety of bed form topographies are generated using geometric models by varying parameters controlling curvature as well as bed form wavelength and amplitude the results in this research suggest that out of phase bed forms generate more complex hyporheic flow patterns which reduce the efficiency of solute transformations higher phase shifts in bed form shapes result in overall higher average velocity larger zones of enhanced pressure and reaction rates and higher amounts of solute exchange moreover the bed form shapes control the reaction process for a wide range of sediment conductivities this study advances the understanding of the effects of complex and small scale morphological features on hyporheic exchange processes including the rate and spatio temporal distribution of reaction hotspots keywords hyporheic exchange solute mixing bed form three dimensionality geochemical hotspots 1 introduction surface water in rivers and streams mixes with groundwater as it is diverted along subsurface hyporheic flow paths bringing with it a myriad of chemical solutes that are transported throughout the shallow streambed by advective and dispersive processes and exposed to microbially active sediments as a coupled system the interactions between surface water and groundwater control the delivery of limiting nutrients and the distribution and abundance of microorganisms in streams and the hyporheic zone transport processes constantly re adjust spatially and temporally in response to geomorphic features along the channel and variations in streamflow in particular the size and shape of small bed forms strongly influence hyporheic exchange elliott and brooks 1997 gomez velez et al 2015a boano et al 2010 liu et al 2020 thus impacting the distribution of solutes throughout the hyporheic zone buffington and tonina 2009 harvey et al 2012 chen et al 2018 bayani cardenas et al 2008 as a result regions of enhanced biogeochemical reaction rates i e hotspots often develop as river water and groundwater coalesce in close contact with geochemically and microbially active sediment surfaces mcclain et al 2003 lautz and fanelli 2008 li et al 2017 variable in terms of stage velocity pressure or turbulent flow over the non uniform streambed further drives hyporheic flow and solute transport as high and low pressure zones develop around the bed form geometries often referred to as bed form induced hyporheic flow thibodeaux and boyle 1987 cardenas and wilson 2007b 2007a marion et al 2002 boano et al 2007 across scales the three dimensional 3d geometric configuration of bed forms i e assemblage of bed forms of a given type occurring in a specific bed area such as a dune bed configuration introduces complexities into flow and solute exchange between surface water and groundwater allen 1982 fleckenstein et al 2010 often such complexities are analyzed using numerical simulations which provide a detailed understanding of the mechanics of bed form induced hyporheic exchange e g elliott and brooks 1997 packman et al 2000 wörman et al 2002 kazezyılmaz alhan and medina 2006 trauth et al 2014 trauth et al 2015 li et al 2020 yabusaki et al 2017 the majority of these studies have focused on idealized two dimensional 2d bed forms elliott and brooks 1997 cardenas and wilson 2007b boano et al 2014 janssen et al 2012 bardini et al 2013 sawyer and cardenas 2009 a few recent exceptions incorporate the third dimension into their investigations marion et al 2002 tonina and buffington 2007 chen et al 2015 zhou et al 2014 zheng et al 2019 but were exclusive to one simplified bed form type or shape wörman et al 2006 proposed a semi empirical method to study 3d hyporheic exchange by assigning pressure over a flat sediment water interface following a fourier series spectrum translated from topographic data they extended the simple 2d case in elliott and brooks 1997 using a fourier series to represent pressure variations along the sediment water interface for dynamic pressure head they assigned a spatially periodic e g sine or cosine function derived from 2d pressure measurements over a triangular dune recent studies stonedahl et al 2012 2013 have applied the same approach based on 2d measurements presented in elliott and brooks 1997 since it would neglect the complexity of 3d turbulent flow and its influence on hyporheic flow their approach is not an effective way of simulating 3d problems to provide a systematic analysis of 3d bed form induced hyporheic flow over ripples and dunes chen et al 2015 simulated flow through a single 3d barchanoid dune with a lateral cross section following a full cosine wave and a planform straight crest i e orthogonal to the mean flow at all positions they showed that despite the relatively simple bed form geometry 3d bed forms generated more complex patterns of hyporheic flow and significantly greater hyporheic fluxes than the equivalent 2d setting in mclean et al 1994 other studies have expanded the analysis to include solute exchange through 3d domains for example trauth et al 2014 simulated reactive solute transport through a 3d pool riffle and found that the flux and residence times of solutes and the associated size of the reaction zones are influenced by both the magnitude and direction of ambient groundwater flow they also showed that the complex 3d pressure distribution over the streambed can induce significant lateral hyporheic flow which results in a hyporheic exchange flow independent of riffle height when higher than a specific threshold height in a similar study li et al 2020 simulated flow and reactive transport through a dune bed form to demonstrate the capability of a coupled surface water and groundwater model they compared the fully coupled simulation of surface groundwater exchanges with the sequential approach results and found out that the difference between sequential and coupled model results primarily depends on permeability a key parameter in the magnitude of hyporheic exchange as permeability increases and drives hyporheic exchange coupled modeling becomes more imperative by incorporating the migration of ripples into their numerical framework zheng et al 2019 found that the turnover exchange due to ripple migration has a large impact on reactant supply and reaction rates given the importance of bed form induced hyporheic exchange on reactive solute transport a fundamental understanding of how static bed form geometry influences the distribution of flow and biogeochemical reaction rates is needed especially given its implications for remediation of both traditional e g nitrate phosphate and emerging contaminants e g per and polyfluoroalkyl substances pfas however none of the previous studies considered the effects of static bed form geometry on the magnitude of solute exchange nor on the rate of biogeochemical reaction processes in the hyporheic zone the most relevant study to this work is by chen et al 2018 which investigated the impacts of bed form three dimensionality on hyporheic flow they calculated both the surface flow over and hyporheic flux through various 3d bed forms using a computational fluid dynamics cfd model implemented across a range of reynolds numbers they found that hyporheic exchange is sensitive to the geometric parameters which define the bed form three dimensionality particularly the bed form steepness and lateral elongation however the focus of their work was on hyporheic flow and they did not consider the effects of bed forms on biogeochemical reaction processes they concluded that their study needs to be further extended to investigate the effects of 3d bed forms on hyporheic biogeochemical processes which motivated the present work here a computational surface water groundwater modeling framework is developed and used to extend the study of chen et al 2018 which is investigating the effects of complex bed form geometries on hyporheic solute transport and biogeochemical reaction processes the novelty of this work compared to available studies in the literature including chen et al 2018 lies in 1 investigating the effects of complex 3d bed form geometries on hyporheic biogeochemical processes and understanding of what aspects of bed form morphology at small scale control biogeochemical processes 2 performing a series of sensitivity analysis of solute mass exchange reaction zone size reaction rate and location of hotspots and 3 evaluating the effect of transient pressure fluctuations on surface groundwater interactions here we show that the reaction rate and the volume of reaction zone increase for out of phase bed forms which implies the higher intensity of geochemical hotspots chen et al 2018 used their model to evaluate the hyporheic flow sensitivity to bed form geometric parameters i e planform curvature steepness and lateral elongation while the present study explores sensitivity of solute exchange and reactions in hyporheic zone regarding the planform sinuosity of bed forms moreover in chen et al 2018 the turbulent flow model was simulated with the commercial cfd code fluent ansys inc to solve the rans k ω equations gambit was used for grid generation and comsol multiphysics to solve the governing pore water flow equation in the sediment whereas in the present work lagrit openfoam and pflotran are used for grid generation surface flow computations and pore water flow simulation respectively the details of the geometric model for generating bed form topographies and of the modeling framework are presented in section 2 section 3 presents model validation and verification using flume scale experimental data as well as simulated results reported by jin et al 2010 and chen et al 2018 the simulation results and conducted sensitivity analysis are discussed in section 4 2 methodology 2 1 streambed morphology bed forms are deformations of a bed at the interface of fluid and moving sediments which develop under certain hydraulic and sediment conditions some examples of bed forms exposed in aquatic environments are shown in fig 1 this study follows the methodology of chen et al 2018 to create synthetic 3d bed forms for use in coupled numerical surface water groundwater flow and reactive transport models bed form morphology is generated using the geometric model from a widely used set of codes originally developed by rubin 1987 and later published by rubin and carter 2005 as a set of matlab routines more than eighty parameters are used in their model which generates geomorphologically plausible and realistic bed form morphologies that represent a wide range of dynamic environmental conditions see examples in fig 2 the focus is on relating the depositional and geomorphological processes and resulting characteristics to different scales of bed forms specifically the models synthesize the bed form geometry by merging two sets of surfaces generated using sine functions here nine representative bed forms are used to represent typical types of sand dunes under unidirectional river flow such as barchanoid or linguoid forms with dune crest lines that are sinusoidal and with pronounced lobes and saddles the mathematical formulation for reproducing the bed form geometry may be written as 1 z i η λ l l 7 5 6 sin π l 50 λ l m i 1 5 sin π l 25 λ l m i where m i is defined as 2 m i x λ l φ i b f 360 a i f sin 2 π λ t y 2 π 360 α i a i s sin 4 π λ t y 2 π 360 β i the bed form topographies i e elevations in the x y plane are calculated as the maximum value of each set as 3 z b e d x y max z i where i 1 2 represent the first and second set of bed forms respectively x and y are the cartesian coordinates and l m is the length of the repeating block in x and y directions η is the mean steepness height to wavelength ratio and λ l m and λ t m are the longitudinal and transverse wavelengths of the bed form respectively φ i b f is the bed form phase in degrees a i f m and a i s m are the planform amplitudes of the first and second sine curves of each set of bed forms respectively α i and β i are the phases of the first and second planform sinuosity of each set of bed forms in degrees changing α i and β i in eq 2 results in various bed form shapes in this study two phase shifts are defined based on α i and β i to change bed form patterns 4 δ φ 1 β 1 α 1 5 δ φ 2 α 2 α 1 with β 2 β 1 fig 2 and table 1 present details of the nine different bed forms other parameters are held constant throughout the computations table 2 the overall bed form geometry changes based on variations in the phase shift parameters fig 2 for instance a δ φ 1 value of 90 represents linguoid bed forms while a δ φ 1 value of 270 represents lunate crescent shaped bed forms there are also more subtle differences between bed forms that are better observed in 2d cross sections for example while linguoid ripples produce an angle to the flow and have a random shape rather than a w type shape the stoss sides of lunate ripples are curved rather than having a lee slope the bed forms studied in the present work are the same as cases studied by chen et al 2018 and the only difference is in x and y origins of the repeating block in this work 0 0 x 1 0 and 0 37 y 1 37 to cover two continuous waves of the bed form shape for most cases also as mentioned previously the purpose of this study is to investigate the effects of the same bed form geometries in chen et al 2018 on hyporheic solute transport and biogeochemical reaction processes 2 2 modeling framework for hyporheic exchange processes a modeling framework named simsgi simulation of surface water and groundwater interactions is developed to more realistically simulate bed form driven hyporheic exchange processes simsgi integrates two advanced models of flow and mass transport a surface water solver openfoam openfoam v7 2019 and a subsurface simulator pflotran hammond et al 2014 lichtner et al 2019b a simsgi also uses lagrit los alamos grid toolbox 2020 an open source mesh generation toolbox to create numerical meshes for the different bed form geometries discussed above after the streambed topographies are geometrically simulated lagrit generates computational grids based on the resulting surfaces and the simsgi framework provides interface scripts for using them in both the surface water openfoam and groundwater pflotran domains fig 3 a one way sequential coupling scheme is utilized to simulate the solute exchange between surface flow and pore water first the pressure distribution at the sediment water interface is calculated by solving the turbulent surface flow in openfoam and is assigned as the top boundary condition for the pore water domain then the groundwater flow and reactive solute transport is simulated in pflotran the one way coupling method has been approved to be an effective scheme in simulating flux exchange between free surface and pore water cardenas and wilson 2007b 2007a jin et al 2010 zhou et al 2018 bardini et al 2012 2 2 1 surface model simulation of turbulent flow over 3d bed forms the simsgi framework simulates surface water flow over 3d bed forms using the open source cfd toolbox openfoam openfoam v7 2019 wherein the 3d navier stokes equations are solved to fully capture the effects of turbulent surface water flow on hyporheic exchange the finite volume approach for the numerical discretization behzadi et al 2018 the piso algorithm for pressure velocity coupling and the shear stress transport sst k ω model for the turbulence closure are applied turbulent model equations the reynolds averaged navier stokes rans equations for an incompressible homogeneous fluid is used to simulate surface water flow in this study behzadi and newman 2020 janssen et al 2012 launder and spalding 1974 6 u i x i 0 7 ρ u j u i x j p x i x j 2 μ s i j ρ u j u i where u i and u i are the time averaged velocity and the fluctuations in instantaneous velocity components in x i directions respectively with i 1 2 ρ and μ are fluid density and dynamic viscosity p is the time averaged pressure and s i j is the strain rate tensor specified as 8 s i j 1 2 u i x j u j x i the reynolds stress is defined as 9 τ i j u j u i ν t 2 s i j 2 3 δ i j k where ν t is the kinematic eddy viscosity δ i j represents kronecher delta and k is the turbulent kinetic energy the equations governing the turbulence kinetic energy and specific dissipation rate for the sst model are menter 1994 menter et al 2003 10 ρ k t ρ u i k x i p k β ρ k ω x i μ σ k μ t k x i 11 ρ ω t ρ u i ω x i α ρ s 2 β ρ ω 2 x i μ σ ω μ t ω x i 2 1 f 1 ρ σ ω 2 1 ω k x i ω x i where the first blending function f 1 is defined by 12 f 1 tanh min max k β ω y 500 ν y 2 ω 4 ρ σ ω 2 k c d k ω y 2 4 with c d k ω max 2 ρ σ ω 2 1 ω k x i ω x i 10 10 and y is the distance from the wall the turbulent eddy viscosity is defined as 13 ν t a 1 k max a 1 ω s f 2 where s is the invariant measure of the strain rate and f 2 is a second blending function defined by 14 f 2 tanh max 2 k β ω y 500 ν y 2 ω 2 in the sst model a production limiter p k is used to prevent the build up of turbulence stagnation regions 15 p k min p k 10 β ρ k ω where p k μ t u i x j u i x j u j x i each constant in the above formulations is calculated by ϕ ϕ 1 f 1 ϕ 2 1 f 1 required constants and coefficients for turbulent closure model are presented in table 3 initial and boundary conditions of surface flow following the approach of chen et al 2018 the bed form height h is considered here as the characteristic length and thus the reynolds number for turbulent flow is defined as 16 r e u a v e h ν where u a v e is the average horizontal velocity of the surface flow m s and ν is the kinematic viscosity of the fluid m 2 s other required parameters are l 1 m and the width of the domain which is from y 0 37 m to y 1 37 m following the prior work in chen et al 2018 a fixed velocity inlet fixed pressure outlet no slip bed and symmetrical sides are implemented as boundary conditions for the surface flow fig 3 since the water depth is significantly greater than the bed form height and thus the free surface is not affected by the bed form it is safe to assume the symmetric boundary for the free surface at the no slip bed all velocity components are assumed to be zero and no penetration is simulated and thus the exchange flux is later calculated in pore water simulation driven by the pressure distribution over the bed the turbulent flow near the no slip bed may be divided into three regions versteeg and malalasekera 1995 the viscous sub layer the fluid flow adjacent to the wall is dominated by viscous effects the buffer layer viscous and turbulent stresses are of similar magnitude and the logarithmic region turbulent stresses dominate computational boundary cells could be located in any of these regions the existing wall functions in openfoam developed based on kalitzin et al 2005 are applied to simulate the velocity field near the no slip wall accurately regardless of the boundary cell location liu 2016 the grid spacing of the surface water computational domain is 0 02 m in all directions resulting in 87 500 computational grid cells the sensitivity of the grid spacing was tested to ensure that the results are accurate and the mesh is of enough resolution to capture bed form topographies solute concentration in surface water concentration of solute is assumed to be uniform within the surface water domain and it is constant at the beginning of flux exchange between surface water and sediment once the pressure distribution is calculated from the surface water model and applied at the water sediment interface the mass flux from surface water to groundwater is simulated in pflotran which is discussed in the following section 2 2 2 subsurface model flow and solute transport simulation after the surface water dynamics have been simulated using openfoam simsgi feeds the output to pflotran a massively parallel subsurface flow and multicomponent reactive transport code which has seen broad acceptance within the scientific community hammond et al 2014 lichtner et al 2019b 2019a dwivedi et al 2018a 2018b groundwater flow and reactive solute transport are simulated over a 3d representative volume of riverbed fig 3 pflotran offers several modes of mass conservation equation for subsurface flow e g richards thermal hydrologic multiphase flow this work considers saturated aquatic sediments and thus we used mass conservation equation below that represent saturated flow conditions lichtner et al 2019a 17 t ρ ϕ ρ k μ p ρ g z 0 where ϕ denotes porosity ρ water density k g m 3 k sediment permeability m 2 μ viscosity p a s p pressure p a and g gravitational acceleration m s 2 the resulting pressure field is used to calculate the darcy velocity and is used to solve the advection dispersion reaction equation for solute transport 18 c t d c v c r i where c is solute concentration mol l v is fluid velocity m s and ri is the sum of all reactions that influence the solute the hydrodynamic dispersion coefficient tensor d dij is 19 d i j α l α t v i v j v α t v δ i j τ d m where τ is tortuosity dm is the molecular diffusion coefficient in porous media m2 s α l is longitudinal dispersivity m α t is transverse dispersivity m and δ i j is the kronecker delta function bear 1972 simulation of reaction processes within hyporheic zone simulating an elementary representative reaction addresses the primary goal of understanding the response of reaction hotspots i e zones of enhanced reaction rates to bed form topography without the complexities associated with complex reaction networks here we used a simple surrogate microbial reaction a b c which can be used as a general description for chemical reactions when homogeneous reactions between chemical species are considered li and berkowitz 2019 the assumption of a simple reaction is valid since complex reactions may be described by multiple elementary reactions such as a b c as shown by gillespie 2000 this simple reaction could also represent several basic reactions lindsay smith et al 1989 gramling et al 2002 the benefits of using a simple reaction are 1 producing more general and thus transformative results 2 reducing the complexity induced by several reactions and creating a basic understanding of how bed form morphologies at small scale control reaction hot spots the reaction is represented by multiple monod kinetics 20 r i k max x c a k a c a c b k b c b where ri is the rate of the ith reaction ca and cb are concentrations of solutes a and b respectively mg l ka and kb are the half saturation constants mg l k max is the maximum specific uptake rate h 1 and x is microbial biomass mg l initial and boundary conditions of subsurface flow the groundwater flow field and advection dispersion reaction equations are solved using the finite volume approach in pflotran lichtner et al 2019a the model domain is uniformly discretized with 0 02 m horizontal and vertical resolution resulting in 82 500 computational grid cells for the subsurface domain all groundwater simulations are run for simulation time of 480 h to allow solute concentrations to reach the steady state the top of the groundwater domain is reciprocal to the bottom of the surface water domain wherein the top boundary cells are assigned steady pressures based on output from surface water simulations no flow boundaries with zero solute flux are applied for the bottom and sides of the subsurface domain to characterize exchange solely between the river and groundwater the initial hydraulic head is set to 0 5 m of standing water above the domain surface water concentrations and initial concentrations in groundwater are specified so that solutes are only supplied by surface water infiltration and in situ microbial production table 4 3 model validation and verification 3 1 verification of hyporheic flux and residence time as stated earlier the present study is a logical extension of the work by chen et al 2018 to verify our model the hyporheic flux and the mean fluid residence time in the hyporheic zone are calculated for four bed forms a c g and i presented in fig 2 under two reynolds numbers r e 3000 r e 9000 and compared with chen et al 2018 results in table 5 the hyporheic flux q i n t is calculated following the definition in chen et al 2018 by spatially integrating the magnitude of normal flux over the swi divided by 2 to give the upwelling or downwelling flux q i n t is then normalized as 21 q i n t q i n t k a s where a s is the bed form surface area k k ρ g μ is the sediment hydraulic conductivity k is the intrinsic permeability ρ is the water density g is the gravitational acceleration and μ is the dynamic viscosity the mean fluid residence time t r is also calculated and normalized based on the definition in chen et al 2018 as 22 t r v q i n t where v is the dimensionless hyporheic zone volume which is defined as v v λ l a s v is the volume between the swi and the surface enveloping all fluid particles released from the swi the comparison results presented in table 5 indicate that the hyporheic flux and the residence time estimated by the present work agree well with the results of chen et al 2018 the difference in hyporheic flux and residence time for all test cases are between 1 1 and 8 1 which could be due to the difference in the spatial discretization and numerical integration errors 3 2 validation and verification of solute transport to ensure that our simsgi framework is able to capture hyporheic flow dynamics and transport processes of advection and dispersion accurately we performed model validation using a laboratory flume experiment by jin et al 2010 their experiment carried out on a 2d triangular dune with height h b and length l to examine the solute pathways jin et al 2010 collected data from two vertical arrays of observation points n1 and n2 n1 array is located at the stoss slope where the solute entered the sediment and n2 array is located at the lee slope of the bed where the solute exited the sediment the observation ports coordinates are presented in table 6 to simulate the steady state turbulent flow over the 2d dune jin et al 2010 used the fluent fluent 6 3 user s guide 2006 bottacin busolin and marion 2010 a finite volume based software and solved the reynolds averaged navier stokes rans equations janssen et al 2012 for an incompressible homogeneous fluid the boundary conditions for the surface water domain are imposed as symmetric boundary for the free surface periodic pressure and velocity for the two vertical sides and a no slip wall for the sediment water interface moreover they used comsol comsol multiphysics user s guide 2006 a finite element based software to numerically solve the laplace equation for hydraulic head bear 1972 and simulate the flow and solute transport in sediment periodic condition was imposed for vertical boundaries and the bottom boundary was set as no flow boundary they used the pressure distribution at the sediment water interface calculated from fluent to determine the hydraulic head at the top boundary of the sediment finally the nacl transport in groundwater was simulated using the 2d mass transport equation in this section the developed simsgi model is applied to the same test case with the similar boundary conditions and the results are validated against the experimental data presented in jin et al 2010 the computational domain and observation points are shown in fig 4 to match the numerical results with the experimental measurements the hydraulic conductivity and the bulk porosity of the sand are adjusted to 7 4 10 3 m s and 0 29 respectively the longitudinal dispersivity of the sediment is set to 0 001 m and the ratio of transverse dispersivity to longitudinal dispersivity is assumed to be 0 1 bear 1972 simulated solute concentration at sampling points are compared with measured data and numerical results of jin et al 2010 in fig 5 an overall excellent agreement is observed between the present model results and the experimental data with regression coefficients close to unity as reported in table 7 note that further parameter adjustment could provide more accurate results however perfectly matching the observation data through parameter adjustment was outside the scope of this work instead we focused on capturing the overall dynamics of solute concentration in the hyporheic zone this validation test indicates that the simsgi model estimates the solute propagation in sediment accurately and thus it is ready to use in a more complex simulation of 3d domains with solute transport and reaction processes as discussed in the following sections 4 results and discussions surface water attributes bed form shape and sediment characteristics change the pressure patterns on the sediment water interface swi and consequently affect the distribution and reaction of solutes moving through the sediment in this section the effects of the aforementioned factors are numerically evaluated following the work in chen et al 2018 all computations carried out with h 0 04 m r e 3000 and a surface water depth of 0 5 m which results in an average surface flow velocity of u a v e 0 075 m s a turbulent energy k 2 9 10 5 m 2 s 2 and a specific turbulent dissipation rate of ω 3 52 s 1 to capture the maximum solute penetration depth in the groundwater domain the sediment thickness is set to 0 6 m the average total cpu time for all surface groundwater simulations is 1385 sec for illustration purposes a cross section of bed form e at y 0 98 m with simulated distributions of pressure velocity and solute transport characteristics are presented in fig 6 bed form shape and size determine the flow velocity and pressure gradients over the bed form higher pressure zones are correlated with higher pore water velocity at the sediment water interface fig 6b and e pressure gradients drive water and solute to penetrate into the sediment fig 6c and lower pressure zones are related to higher reaction rates fig 6d table 8 summarizes the simulation results for each bed form which will be discussed in details in the following sections the geometry of bed form i generates the maximum pressure gradient which not only resulted in the highest average groundwater velocity and greatest solute flux but also drove the highest reaction rates and largest reaction zone volume 4 1 pressure distribution at the sediment water interface turbulent surface water flow generates non uniform pressure distributions across the sediment water interface in response to bed form shape with more complex patterns associated with increasing δ φ 2 fig 7 for example as δ φ 2 increases for both linguoid δ φ 1 90 and lunate δ φ 1 270 bed forms the flow regime shifts as adjacent bed forms become staggered resulting in larger high pressure zones on the lee faces of the bed forms in phase δ φ 2 0 and out of phase δ φ 2 180 bed forms display symmetrical pressure distributions with aligned low and high pressure zones while the pressure distribution across intermediate bed forms δ φ 2 90 is more erratic in contrast as δ φ 1 increases the high and low pressure zones becomes more uniformly distributed across the bed form geometry trending away from focused high pressure zones along bed form troughs that drive downwelling conditions the spatially variable pressure distribution is applied on the surface groundwater interface as the dirichlet condition which has direct impact on the solute transport within the pore water further larger pressure zones ultimately affect hotspot formation by increasing both the volume of the reaction zone and the overall reaction rates table 8 4 2 solute exchange at the sediment water interface as explained in the methodology section once the stream flow reaches the steady state the subsurface flow simulation launches water and solute fluxes at the sediment water interface are calculated in pflotran the total mass flux entering or leaving the pore water is calculated by taking the sum of the mass flux in each boundary cell during the first few days of pore water simulation solutes are only infiltrating until the amounts of infiltration and exfiltration are stabilized and the system reaches an equilibrium as shown in fig 8 a and 8 b the net exchange flux of solute a is positive meaning that infiltration of solute a at the streambed is more than its exfiltration it should be noted that characteristics of solute a and solute b are identical and thus they show the same behavior net flux of solute c through the streambed is negative which indicates that solute c is mostly leaving the subsurface and going back to the surface water moreover the comparison of exchange fluxes for all bed forms in fig 8a and b shows that as δ φ 2 grows the net flux of solute a transferring from surface into subsurface as well as the net flux of solute c leaving the sediment increase in other words bed forms with larger δ φ 2 transfer higher amounts of solute in particular for lunate bed forms c f i the absolute value of solute transferred both solute a and solute c is growing as δ φ 2 is increasing from bed form c to bed form i linguoid bed forms a d g shows similar trend this is also shown in table 8 that higher δ φ 2 results in higher average velocity larger reaction rate and higher amounts of solute exchange bed form i has a phase shift δ φ 2 of 180 compared to bed form a which leads to 21 change in average velocity and average reaction rate the solute exchange flux is also increased by 21 for bed form i furthermore both streambed morphology and hydraulic conductivity k influence the solute exchange amount between surface water and groundwater fig 9 displays the equilibrated mass flux at time 20 days for linguiod type bed forms and with different k other bed form types such as lunate with the same δ φ 1 shows similar trends as shown increasing k will enhance the amount of entering mass of solute a from surface water to the hyporheic zone however the amount of solute c moving out of the hyporheic zone and into the stream decreases it is also clear that if sediment is more conductive the differences between linguoid bed forms are amplified in terms of solute mass flux 4 3 solute dynamics in the hyporheic zone the efficiency of nutrient transformations in the subsurface is largely a function of the timescale of biogeochemical reactions with enhanced removal often depending on sufficiently long solute residence times gomez velez and harvey 2014 gomez velez et al 2015b subsurface residence time distributions can influence the type and rate of many processes occurring in surface near surface and deep hydrologic environments ranging from solely physical to complex biogeochemical processes cardenas 2008 a number of recent studies have investigated the mechanisms controlling solute residence times associated with multiscale hyporheic exchange processes wörman et al 2006 cardenas 2007 kollet and maxwell 2008 wörman et al 2007 pflotran does not explicitly simulate solute residence time distributions rtd using traditional particle tracking rtd is the probability that an individual molecule of solute will travel from point a to point b in practice rtd may be estimated by injecting a solute at point a time 0 with a concentration of c0 and measuring concentrations c t at point b over time therefore in the present study instead of calculating the residence time distribution directly the age of infiltrated i e a and b and produced i e c solutes traveling along hyporheic flowpaths are estimated which essentially provides information about how long a given solute has been in the subsurface in each model grid cell gardner et al 2015 solutes are at age 0 the moment they infiltrate the subsurface and continue to age until they are transported out of the domain pflotran tracks the age of a conservative solute not subject to microbial degradation but when correlated with the concentrations of a reactive solute in each cell provides a proxy for residence time distributions bed form geometry controlled the extent of solute transformations by controlling how long solutes reside within the streambed at steady state t 20 days solute ages are lowest in the shallow streambed associated with higher groundwater velocities and shorter hyporheic flowpaths than deeper regions fig 10 higher ages up to 14 days in the deeper streambed which indicate longer solute residence times allowed for more complete solute transformation however resulting in lower concentrations of a and b and the highest concentrations of c as a governing factor in the dynamics of groundwater flow patterns the phase shift in the second planform sinuosity δ φ 2 strongly controlled the distribution of solute age based on bed form geometry average solute age increased from 2 08 0 01 days to 2 52 0 03 days as phase shift increased from δ φ 2 0 to δ φ 2 180 though solute concentration profiles followed a similar trend for all bed form geometries with solutes a and b decreasing to roughly 0 1 m and solute c reaching up to 0 9 m as the solute age in each cell increased concentrations are much more variable throughout the domain when bed forms are out of phase δ φ 2 0 for example the average standard deviation of the concentration of solute c is 568 and 351 larger in bed forms where δ φ 2 90 than those where δ φ 2 0 and δ φ 2 180 respectively temporal variation of concentration can also be described as time series at a particular depth as shown in fig 11 at 0 2 m deep in the center of the subsurface domain solute concentrations for out of phase bed forms δ φ 2 0 experience sharp increases while they gradually increase for in phase bed forms δ φ 2 0 this outcome agrees well with the exchange flux results in section 4 2 which demonstrated that the out of phase bed forms allow for a greater amount of solute exchange 4 4 sensitivity analysis on volume of reaction zone the volume of the reaction zone v r z is defined where reaction rates are greater than 1 of the maximum rate k max for each bed form type e g linguiod versus lunate v r z is most sensitive to δ φ 2 and increases for out of phase bed forms δ φ 2 0 figs 12 table 8 also shows that with a 180 phase shift v r z grows by 20 time series of v r z indicates that within the first 12 h half a day the volume of reaction zone is increasing with the same rate and value for all bed forms and later it will grow larger for out of phase bed forms fig 13 a hydraulic properties of sediments also influence solute transport and reaction processes hyporheic exchange volumes are lower in less conductive sediments and the flux of solutes into the streambed is thus decreased as a result bed form morphology is negligible to v r z because the magnitude of hyporheic exchange is below the threshold of influence conversely bed form shape is a primary control on v r z in highly conductive sediments k 10 6 m s because flow and solute exchange are not hindered by sediment permeability fig 13b however given the different flow regimes imposed by varying bed form geometries this relationship may not be consistent in all environments this inverse relationship also represents another layer of complexity that should be evaluated in future studies under otherwise analogous environmental conditions i e flow depth surface water velocity streambed sediments of varying permeability will form bed forms of different size and shape as a result the relative influence of bed form geometry and sediment permeability on hyporheic processes will shift across time and space as sediments are transported and the complex streambed topography evolves in response to episodic flow events depending on the bed form geometry the maximum reaction rate for identical biogeochemical processes may change in space fig 14 a depicts the plan view of locations with maximum reaction rates in different bed forms fig 14b d display the locations of maximum reaction rate from a cross sectional view here bed forms a e and h are presented to show distinct locations of maximum reaction rate spots 4 5 effects of instantaneous pressure fluctuations on hyporheic exchange the results presented in the previous sections were calculated under the steady state pressure distribution along the sediment water interface in this section in order to evaluate the hyporheic exchange driven by pressure fluctuations across bed forms we simulated transient behavior of river pressure condition at the outlet fig 15 a the large eddy simulation les sagaut 2006 was carried out in openfoam to simulate pressure changes due to a hydropeaking event the resulting pressure distribution over swi at each time step was used in pflotran to calculate the flow and solute exchange in the hyporheic zone fig 15d to f display the pressure distribution over swi at the center line of the domain 0 0 x 1 0 m y 0 87 m at three time snapshots t 2 1 days t 6 3 days t 10 5 days considering the wave like boundary condition for pressure at the outlet fig 15a these time snapshots are selected to cover a range of varied pressure distribution over the domain it is found that the pressure distribution over swi changes with time and consequently the reaction zone size fig 15b and the maximum reaction rate fig 15c prior studies have shown that the pressure fluctuations are important in enhancing the size of geochemical hotspots shuai et al 2017 in the present section to investigate how the pressure change combined with the bed form phase shifts influence the geochemical hotspots we performed the transient simulation for bed forms a d and g our results show that differences in reaction zone size and the maximum reaction rates among bed forms a d and g are consistent during the stage fluctuations confirming the strong controls of bed form geometry on development of reaction hotspots while the pressure profile changes at swi over each bed form type the volume of reaction zone slightly increases due to pressure fluctuations see fig 15b and d f the maximum reaction rate is dependent on values of δ φ 2 for example for bed form a with δ φ 2 0 the maximum reaction rate slightly increases with time while the opposite is observed for bed form g with δ φ 2 180 5 conclusions and future directions this work studied how bed form topographies control various hyporheic exchange processes a framework to simulate surface and subsurface flow and reactive solute transport within the hyporheic zone is developed the framework enables prediction of hotspots for different surface flow properties bed form shapes and sediment characteristics while the framework is currently utilized for a simple reactions and the homogeneous sediment it could also be used to represent heterogeneous sediments as well as biogeochemical processes such as nutrient transformation which involve multiple equilibrium and kinetically controlled reactions bed forms drive small scale hyporheic exchange and host dynamic regions of biogeochemical activity as a primary control on hyporheic residence times and nutrient availability bed form geometry largely influences the rate and distribution of such microbial hotspots as shown in table 8 and fig 12 the reaction rate and the volume of reaction zone increase for out of phase bed forms which implies the higher intensity of geochemical hotspots this work specifically shows that the reaction rates depend on exchange fluxes and thus on bed form specific shape and morphologies in particular when bed form shape is represented by a series of sine curves the phase shift of the second planform sinuosity δ φ 2 drives complex pressure distributions across the streambed that increases solute exchange and the depth of solute penetration often resulting in larger reaction zones and overall higher reaction rates for instance with a phase shift δ φ 2 of 180 the solute exchange flux would increase by 21 and the volume of reaction zone would grow by 20 the results in this research suggest that out of phase bed forms generate more complex groundwater flow patterns with variable solute ages however which reduce the efficiency of solute transformations another key finding of the present study is that the bed form shape is a primary control on the size of the reaction zone in highly conductive sediments k 10 6 m s because flow and solute exchanges are not hindered by sediment permeability time is also an important factor in pressure variations over swi which leads to change of the reaction zone size and the reaction rates future studies will need to address how heterogeneity in various bed forms affects the biogeochemical process and reaction rates bed form migration and erosional and depositional processes were outside of the scope of this study but evolving bed topography would cause removal efficiency to vary temporally as the geometry shifted between in and out of phase future research should also focus on how temporal variability in bed form geometry alters hyporheic flow patterns and shifts biogeochemical reaction rates especially in dynamic environments with regular stage changes i e tides dam release where erosional and depositional processes would likely be accelerated a clear understanding of the role of hyporheic bed forms on hyporheic exchange processes is crucial to the protection of water quality especially as anthropogenic contaminant input to the biosphere increases credit author statement faranak behzadi software conceptualization methodology visualization validation writing the original draft corey d wallace software writing validation visualization dylan ward review and editing haiyan zhou review and editing roelof versteeg review and editing funding acquisition mohamad reza soltanian supervision conceptualization methodology review and editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the first author fb was funded by university of cincinnati through faculty startup fund to the last author mrs the second author cdw was funded by the national science foundation ear pf 1855193 this research was partially supported by the u s department of energy under sbir award de sc0019621 to subsurface insights llc to ensure open science and data accessibility the codes and input files associated with the present model are provided in http www hydroshare org resource e6b1394d006a430f9cac331f9f251d1b which can reproduce the examples and results 
242,small scale bed form topographies control hyporheic exchange and biogeochemical processes within aquatic sediments which ultimately affect water quality and nutrient cycling at the watershed scale the impact of three dimensional and small scale bed form topographies on hyporheic exchange and solute mixing is investigated in the present work the effect of bed form morphologies on the development of zones of enhanced reaction rates i e hotspots is also studied a computational fluid dynamics model to simulate river flow over bed forms is combined with a subsurface flow and multicomponent reactive solute transport model a wide variety of bed form topographies are generated using geometric models by varying parameters controlling curvature as well as bed form wavelength and amplitude the results in this research suggest that out of phase bed forms generate more complex hyporheic flow patterns which reduce the efficiency of solute transformations higher phase shifts in bed form shapes result in overall higher average velocity larger zones of enhanced pressure and reaction rates and higher amounts of solute exchange moreover the bed form shapes control the reaction process for a wide range of sediment conductivities this study advances the understanding of the effects of complex and small scale morphological features on hyporheic exchange processes including the rate and spatio temporal distribution of reaction hotspots keywords hyporheic exchange solute mixing bed form three dimensionality geochemical hotspots 1 introduction surface water in rivers and streams mixes with groundwater as it is diverted along subsurface hyporheic flow paths bringing with it a myriad of chemical solutes that are transported throughout the shallow streambed by advective and dispersive processes and exposed to microbially active sediments as a coupled system the interactions between surface water and groundwater control the delivery of limiting nutrients and the distribution and abundance of microorganisms in streams and the hyporheic zone transport processes constantly re adjust spatially and temporally in response to geomorphic features along the channel and variations in streamflow in particular the size and shape of small bed forms strongly influence hyporheic exchange elliott and brooks 1997 gomez velez et al 2015a boano et al 2010 liu et al 2020 thus impacting the distribution of solutes throughout the hyporheic zone buffington and tonina 2009 harvey et al 2012 chen et al 2018 bayani cardenas et al 2008 as a result regions of enhanced biogeochemical reaction rates i e hotspots often develop as river water and groundwater coalesce in close contact with geochemically and microbially active sediment surfaces mcclain et al 2003 lautz and fanelli 2008 li et al 2017 variable in terms of stage velocity pressure or turbulent flow over the non uniform streambed further drives hyporheic flow and solute transport as high and low pressure zones develop around the bed form geometries often referred to as bed form induced hyporheic flow thibodeaux and boyle 1987 cardenas and wilson 2007b 2007a marion et al 2002 boano et al 2007 across scales the three dimensional 3d geometric configuration of bed forms i e assemblage of bed forms of a given type occurring in a specific bed area such as a dune bed configuration introduces complexities into flow and solute exchange between surface water and groundwater allen 1982 fleckenstein et al 2010 often such complexities are analyzed using numerical simulations which provide a detailed understanding of the mechanics of bed form induced hyporheic exchange e g elliott and brooks 1997 packman et al 2000 wörman et al 2002 kazezyılmaz alhan and medina 2006 trauth et al 2014 trauth et al 2015 li et al 2020 yabusaki et al 2017 the majority of these studies have focused on idealized two dimensional 2d bed forms elliott and brooks 1997 cardenas and wilson 2007b boano et al 2014 janssen et al 2012 bardini et al 2013 sawyer and cardenas 2009 a few recent exceptions incorporate the third dimension into their investigations marion et al 2002 tonina and buffington 2007 chen et al 2015 zhou et al 2014 zheng et al 2019 but were exclusive to one simplified bed form type or shape wörman et al 2006 proposed a semi empirical method to study 3d hyporheic exchange by assigning pressure over a flat sediment water interface following a fourier series spectrum translated from topographic data they extended the simple 2d case in elliott and brooks 1997 using a fourier series to represent pressure variations along the sediment water interface for dynamic pressure head they assigned a spatially periodic e g sine or cosine function derived from 2d pressure measurements over a triangular dune recent studies stonedahl et al 2012 2013 have applied the same approach based on 2d measurements presented in elliott and brooks 1997 since it would neglect the complexity of 3d turbulent flow and its influence on hyporheic flow their approach is not an effective way of simulating 3d problems to provide a systematic analysis of 3d bed form induced hyporheic flow over ripples and dunes chen et al 2015 simulated flow through a single 3d barchanoid dune with a lateral cross section following a full cosine wave and a planform straight crest i e orthogonal to the mean flow at all positions they showed that despite the relatively simple bed form geometry 3d bed forms generated more complex patterns of hyporheic flow and significantly greater hyporheic fluxes than the equivalent 2d setting in mclean et al 1994 other studies have expanded the analysis to include solute exchange through 3d domains for example trauth et al 2014 simulated reactive solute transport through a 3d pool riffle and found that the flux and residence times of solutes and the associated size of the reaction zones are influenced by both the magnitude and direction of ambient groundwater flow they also showed that the complex 3d pressure distribution over the streambed can induce significant lateral hyporheic flow which results in a hyporheic exchange flow independent of riffle height when higher than a specific threshold height in a similar study li et al 2020 simulated flow and reactive transport through a dune bed form to demonstrate the capability of a coupled surface water and groundwater model they compared the fully coupled simulation of surface groundwater exchanges with the sequential approach results and found out that the difference between sequential and coupled model results primarily depends on permeability a key parameter in the magnitude of hyporheic exchange as permeability increases and drives hyporheic exchange coupled modeling becomes more imperative by incorporating the migration of ripples into their numerical framework zheng et al 2019 found that the turnover exchange due to ripple migration has a large impact on reactant supply and reaction rates given the importance of bed form induced hyporheic exchange on reactive solute transport a fundamental understanding of how static bed form geometry influences the distribution of flow and biogeochemical reaction rates is needed especially given its implications for remediation of both traditional e g nitrate phosphate and emerging contaminants e g per and polyfluoroalkyl substances pfas however none of the previous studies considered the effects of static bed form geometry on the magnitude of solute exchange nor on the rate of biogeochemical reaction processes in the hyporheic zone the most relevant study to this work is by chen et al 2018 which investigated the impacts of bed form three dimensionality on hyporheic flow they calculated both the surface flow over and hyporheic flux through various 3d bed forms using a computational fluid dynamics cfd model implemented across a range of reynolds numbers they found that hyporheic exchange is sensitive to the geometric parameters which define the bed form three dimensionality particularly the bed form steepness and lateral elongation however the focus of their work was on hyporheic flow and they did not consider the effects of bed forms on biogeochemical reaction processes they concluded that their study needs to be further extended to investigate the effects of 3d bed forms on hyporheic biogeochemical processes which motivated the present work here a computational surface water groundwater modeling framework is developed and used to extend the study of chen et al 2018 which is investigating the effects of complex bed form geometries on hyporheic solute transport and biogeochemical reaction processes the novelty of this work compared to available studies in the literature including chen et al 2018 lies in 1 investigating the effects of complex 3d bed form geometries on hyporheic biogeochemical processes and understanding of what aspects of bed form morphology at small scale control biogeochemical processes 2 performing a series of sensitivity analysis of solute mass exchange reaction zone size reaction rate and location of hotspots and 3 evaluating the effect of transient pressure fluctuations on surface groundwater interactions here we show that the reaction rate and the volume of reaction zone increase for out of phase bed forms which implies the higher intensity of geochemical hotspots chen et al 2018 used their model to evaluate the hyporheic flow sensitivity to bed form geometric parameters i e planform curvature steepness and lateral elongation while the present study explores sensitivity of solute exchange and reactions in hyporheic zone regarding the planform sinuosity of bed forms moreover in chen et al 2018 the turbulent flow model was simulated with the commercial cfd code fluent ansys inc to solve the rans k ω equations gambit was used for grid generation and comsol multiphysics to solve the governing pore water flow equation in the sediment whereas in the present work lagrit openfoam and pflotran are used for grid generation surface flow computations and pore water flow simulation respectively the details of the geometric model for generating bed form topographies and of the modeling framework are presented in section 2 section 3 presents model validation and verification using flume scale experimental data as well as simulated results reported by jin et al 2010 and chen et al 2018 the simulation results and conducted sensitivity analysis are discussed in section 4 2 methodology 2 1 streambed morphology bed forms are deformations of a bed at the interface of fluid and moving sediments which develop under certain hydraulic and sediment conditions some examples of bed forms exposed in aquatic environments are shown in fig 1 this study follows the methodology of chen et al 2018 to create synthetic 3d bed forms for use in coupled numerical surface water groundwater flow and reactive transport models bed form morphology is generated using the geometric model from a widely used set of codes originally developed by rubin 1987 and later published by rubin and carter 2005 as a set of matlab routines more than eighty parameters are used in their model which generates geomorphologically plausible and realistic bed form morphologies that represent a wide range of dynamic environmental conditions see examples in fig 2 the focus is on relating the depositional and geomorphological processes and resulting characteristics to different scales of bed forms specifically the models synthesize the bed form geometry by merging two sets of surfaces generated using sine functions here nine representative bed forms are used to represent typical types of sand dunes under unidirectional river flow such as barchanoid or linguoid forms with dune crest lines that are sinusoidal and with pronounced lobes and saddles the mathematical formulation for reproducing the bed form geometry may be written as 1 z i η λ l l 7 5 6 sin π l 50 λ l m i 1 5 sin π l 25 λ l m i where m i is defined as 2 m i x λ l φ i b f 360 a i f sin 2 π λ t y 2 π 360 α i a i s sin 4 π λ t y 2 π 360 β i the bed form topographies i e elevations in the x y plane are calculated as the maximum value of each set as 3 z b e d x y max z i where i 1 2 represent the first and second set of bed forms respectively x and y are the cartesian coordinates and l m is the length of the repeating block in x and y directions η is the mean steepness height to wavelength ratio and λ l m and λ t m are the longitudinal and transverse wavelengths of the bed form respectively φ i b f is the bed form phase in degrees a i f m and a i s m are the planform amplitudes of the first and second sine curves of each set of bed forms respectively α i and β i are the phases of the first and second planform sinuosity of each set of bed forms in degrees changing α i and β i in eq 2 results in various bed form shapes in this study two phase shifts are defined based on α i and β i to change bed form patterns 4 δ φ 1 β 1 α 1 5 δ φ 2 α 2 α 1 with β 2 β 1 fig 2 and table 1 present details of the nine different bed forms other parameters are held constant throughout the computations table 2 the overall bed form geometry changes based on variations in the phase shift parameters fig 2 for instance a δ φ 1 value of 90 represents linguoid bed forms while a δ φ 1 value of 270 represents lunate crescent shaped bed forms there are also more subtle differences between bed forms that are better observed in 2d cross sections for example while linguoid ripples produce an angle to the flow and have a random shape rather than a w type shape the stoss sides of lunate ripples are curved rather than having a lee slope the bed forms studied in the present work are the same as cases studied by chen et al 2018 and the only difference is in x and y origins of the repeating block in this work 0 0 x 1 0 and 0 37 y 1 37 to cover two continuous waves of the bed form shape for most cases also as mentioned previously the purpose of this study is to investigate the effects of the same bed form geometries in chen et al 2018 on hyporheic solute transport and biogeochemical reaction processes 2 2 modeling framework for hyporheic exchange processes a modeling framework named simsgi simulation of surface water and groundwater interactions is developed to more realistically simulate bed form driven hyporheic exchange processes simsgi integrates two advanced models of flow and mass transport a surface water solver openfoam openfoam v7 2019 and a subsurface simulator pflotran hammond et al 2014 lichtner et al 2019b a simsgi also uses lagrit los alamos grid toolbox 2020 an open source mesh generation toolbox to create numerical meshes for the different bed form geometries discussed above after the streambed topographies are geometrically simulated lagrit generates computational grids based on the resulting surfaces and the simsgi framework provides interface scripts for using them in both the surface water openfoam and groundwater pflotran domains fig 3 a one way sequential coupling scheme is utilized to simulate the solute exchange between surface flow and pore water first the pressure distribution at the sediment water interface is calculated by solving the turbulent surface flow in openfoam and is assigned as the top boundary condition for the pore water domain then the groundwater flow and reactive solute transport is simulated in pflotran the one way coupling method has been approved to be an effective scheme in simulating flux exchange between free surface and pore water cardenas and wilson 2007b 2007a jin et al 2010 zhou et al 2018 bardini et al 2012 2 2 1 surface model simulation of turbulent flow over 3d bed forms the simsgi framework simulates surface water flow over 3d bed forms using the open source cfd toolbox openfoam openfoam v7 2019 wherein the 3d navier stokes equations are solved to fully capture the effects of turbulent surface water flow on hyporheic exchange the finite volume approach for the numerical discretization behzadi et al 2018 the piso algorithm for pressure velocity coupling and the shear stress transport sst k ω model for the turbulence closure are applied turbulent model equations the reynolds averaged navier stokes rans equations for an incompressible homogeneous fluid is used to simulate surface water flow in this study behzadi and newman 2020 janssen et al 2012 launder and spalding 1974 6 u i x i 0 7 ρ u j u i x j p x i x j 2 μ s i j ρ u j u i where u i and u i are the time averaged velocity and the fluctuations in instantaneous velocity components in x i directions respectively with i 1 2 ρ and μ are fluid density and dynamic viscosity p is the time averaged pressure and s i j is the strain rate tensor specified as 8 s i j 1 2 u i x j u j x i the reynolds stress is defined as 9 τ i j u j u i ν t 2 s i j 2 3 δ i j k where ν t is the kinematic eddy viscosity δ i j represents kronecher delta and k is the turbulent kinetic energy the equations governing the turbulence kinetic energy and specific dissipation rate for the sst model are menter 1994 menter et al 2003 10 ρ k t ρ u i k x i p k β ρ k ω x i μ σ k μ t k x i 11 ρ ω t ρ u i ω x i α ρ s 2 β ρ ω 2 x i μ σ ω μ t ω x i 2 1 f 1 ρ σ ω 2 1 ω k x i ω x i where the first blending function f 1 is defined by 12 f 1 tanh min max k β ω y 500 ν y 2 ω 4 ρ σ ω 2 k c d k ω y 2 4 with c d k ω max 2 ρ σ ω 2 1 ω k x i ω x i 10 10 and y is the distance from the wall the turbulent eddy viscosity is defined as 13 ν t a 1 k max a 1 ω s f 2 where s is the invariant measure of the strain rate and f 2 is a second blending function defined by 14 f 2 tanh max 2 k β ω y 500 ν y 2 ω 2 in the sst model a production limiter p k is used to prevent the build up of turbulence stagnation regions 15 p k min p k 10 β ρ k ω where p k μ t u i x j u i x j u j x i each constant in the above formulations is calculated by ϕ ϕ 1 f 1 ϕ 2 1 f 1 required constants and coefficients for turbulent closure model are presented in table 3 initial and boundary conditions of surface flow following the approach of chen et al 2018 the bed form height h is considered here as the characteristic length and thus the reynolds number for turbulent flow is defined as 16 r e u a v e h ν where u a v e is the average horizontal velocity of the surface flow m s and ν is the kinematic viscosity of the fluid m 2 s other required parameters are l 1 m and the width of the domain which is from y 0 37 m to y 1 37 m following the prior work in chen et al 2018 a fixed velocity inlet fixed pressure outlet no slip bed and symmetrical sides are implemented as boundary conditions for the surface flow fig 3 since the water depth is significantly greater than the bed form height and thus the free surface is not affected by the bed form it is safe to assume the symmetric boundary for the free surface at the no slip bed all velocity components are assumed to be zero and no penetration is simulated and thus the exchange flux is later calculated in pore water simulation driven by the pressure distribution over the bed the turbulent flow near the no slip bed may be divided into three regions versteeg and malalasekera 1995 the viscous sub layer the fluid flow adjacent to the wall is dominated by viscous effects the buffer layer viscous and turbulent stresses are of similar magnitude and the logarithmic region turbulent stresses dominate computational boundary cells could be located in any of these regions the existing wall functions in openfoam developed based on kalitzin et al 2005 are applied to simulate the velocity field near the no slip wall accurately regardless of the boundary cell location liu 2016 the grid spacing of the surface water computational domain is 0 02 m in all directions resulting in 87 500 computational grid cells the sensitivity of the grid spacing was tested to ensure that the results are accurate and the mesh is of enough resolution to capture bed form topographies solute concentration in surface water concentration of solute is assumed to be uniform within the surface water domain and it is constant at the beginning of flux exchange between surface water and sediment once the pressure distribution is calculated from the surface water model and applied at the water sediment interface the mass flux from surface water to groundwater is simulated in pflotran which is discussed in the following section 2 2 2 subsurface model flow and solute transport simulation after the surface water dynamics have been simulated using openfoam simsgi feeds the output to pflotran a massively parallel subsurface flow and multicomponent reactive transport code which has seen broad acceptance within the scientific community hammond et al 2014 lichtner et al 2019b 2019a dwivedi et al 2018a 2018b groundwater flow and reactive solute transport are simulated over a 3d representative volume of riverbed fig 3 pflotran offers several modes of mass conservation equation for subsurface flow e g richards thermal hydrologic multiphase flow this work considers saturated aquatic sediments and thus we used mass conservation equation below that represent saturated flow conditions lichtner et al 2019a 17 t ρ ϕ ρ k μ p ρ g z 0 where ϕ denotes porosity ρ water density k g m 3 k sediment permeability m 2 μ viscosity p a s p pressure p a and g gravitational acceleration m s 2 the resulting pressure field is used to calculate the darcy velocity and is used to solve the advection dispersion reaction equation for solute transport 18 c t d c v c r i where c is solute concentration mol l v is fluid velocity m s and ri is the sum of all reactions that influence the solute the hydrodynamic dispersion coefficient tensor d dij is 19 d i j α l α t v i v j v α t v δ i j τ d m where τ is tortuosity dm is the molecular diffusion coefficient in porous media m2 s α l is longitudinal dispersivity m α t is transverse dispersivity m and δ i j is the kronecker delta function bear 1972 simulation of reaction processes within hyporheic zone simulating an elementary representative reaction addresses the primary goal of understanding the response of reaction hotspots i e zones of enhanced reaction rates to bed form topography without the complexities associated with complex reaction networks here we used a simple surrogate microbial reaction a b c which can be used as a general description for chemical reactions when homogeneous reactions between chemical species are considered li and berkowitz 2019 the assumption of a simple reaction is valid since complex reactions may be described by multiple elementary reactions such as a b c as shown by gillespie 2000 this simple reaction could also represent several basic reactions lindsay smith et al 1989 gramling et al 2002 the benefits of using a simple reaction are 1 producing more general and thus transformative results 2 reducing the complexity induced by several reactions and creating a basic understanding of how bed form morphologies at small scale control reaction hot spots the reaction is represented by multiple monod kinetics 20 r i k max x c a k a c a c b k b c b where ri is the rate of the ith reaction ca and cb are concentrations of solutes a and b respectively mg l ka and kb are the half saturation constants mg l k max is the maximum specific uptake rate h 1 and x is microbial biomass mg l initial and boundary conditions of subsurface flow the groundwater flow field and advection dispersion reaction equations are solved using the finite volume approach in pflotran lichtner et al 2019a the model domain is uniformly discretized with 0 02 m horizontal and vertical resolution resulting in 82 500 computational grid cells for the subsurface domain all groundwater simulations are run for simulation time of 480 h to allow solute concentrations to reach the steady state the top of the groundwater domain is reciprocal to the bottom of the surface water domain wherein the top boundary cells are assigned steady pressures based on output from surface water simulations no flow boundaries with zero solute flux are applied for the bottom and sides of the subsurface domain to characterize exchange solely between the river and groundwater the initial hydraulic head is set to 0 5 m of standing water above the domain surface water concentrations and initial concentrations in groundwater are specified so that solutes are only supplied by surface water infiltration and in situ microbial production table 4 3 model validation and verification 3 1 verification of hyporheic flux and residence time as stated earlier the present study is a logical extension of the work by chen et al 2018 to verify our model the hyporheic flux and the mean fluid residence time in the hyporheic zone are calculated for four bed forms a c g and i presented in fig 2 under two reynolds numbers r e 3000 r e 9000 and compared with chen et al 2018 results in table 5 the hyporheic flux q i n t is calculated following the definition in chen et al 2018 by spatially integrating the magnitude of normal flux over the swi divided by 2 to give the upwelling or downwelling flux q i n t is then normalized as 21 q i n t q i n t k a s where a s is the bed form surface area k k ρ g μ is the sediment hydraulic conductivity k is the intrinsic permeability ρ is the water density g is the gravitational acceleration and μ is the dynamic viscosity the mean fluid residence time t r is also calculated and normalized based on the definition in chen et al 2018 as 22 t r v q i n t where v is the dimensionless hyporheic zone volume which is defined as v v λ l a s v is the volume between the swi and the surface enveloping all fluid particles released from the swi the comparison results presented in table 5 indicate that the hyporheic flux and the residence time estimated by the present work agree well with the results of chen et al 2018 the difference in hyporheic flux and residence time for all test cases are between 1 1 and 8 1 which could be due to the difference in the spatial discretization and numerical integration errors 3 2 validation and verification of solute transport to ensure that our simsgi framework is able to capture hyporheic flow dynamics and transport processes of advection and dispersion accurately we performed model validation using a laboratory flume experiment by jin et al 2010 their experiment carried out on a 2d triangular dune with height h b and length l to examine the solute pathways jin et al 2010 collected data from two vertical arrays of observation points n1 and n2 n1 array is located at the stoss slope where the solute entered the sediment and n2 array is located at the lee slope of the bed where the solute exited the sediment the observation ports coordinates are presented in table 6 to simulate the steady state turbulent flow over the 2d dune jin et al 2010 used the fluent fluent 6 3 user s guide 2006 bottacin busolin and marion 2010 a finite volume based software and solved the reynolds averaged navier stokes rans equations janssen et al 2012 for an incompressible homogeneous fluid the boundary conditions for the surface water domain are imposed as symmetric boundary for the free surface periodic pressure and velocity for the two vertical sides and a no slip wall for the sediment water interface moreover they used comsol comsol multiphysics user s guide 2006 a finite element based software to numerically solve the laplace equation for hydraulic head bear 1972 and simulate the flow and solute transport in sediment periodic condition was imposed for vertical boundaries and the bottom boundary was set as no flow boundary they used the pressure distribution at the sediment water interface calculated from fluent to determine the hydraulic head at the top boundary of the sediment finally the nacl transport in groundwater was simulated using the 2d mass transport equation in this section the developed simsgi model is applied to the same test case with the similar boundary conditions and the results are validated against the experimental data presented in jin et al 2010 the computational domain and observation points are shown in fig 4 to match the numerical results with the experimental measurements the hydraulic conductivity and the bulk porosity of the sand are adjusted to 7 4 10 3 m s and 0 29 respectively the longitudinal dispersivity of the sediment is set to 0 001 m and the ratio of transverse dispersivity to longitudinal dispersivity is assumed to be 0 1 bear 1972 simulated solute concentration at sampling points are compared with measured data and numerical results of jin et al 2010 in fig 5 an overall excellent agreement is observed between the present model results and the experimental data with regression coefficients close to unity as reported in table 7 note that further parameter adjustment could provide more accurate results however perfectly matching the observation data through parameter adjustment was outside the scope of this work instead we focused on capturing the overall dynamics of solute concentration in the hyporheic zone this validation test indicates that the simsgi model estimates the solute propagation in sediment accurately and thus it is ready to use in a more complex simulation of 3d domains with solute transport and reaction processes as discussed in the following sections 4 results and discussions surface water attributes bed form shape and sediment characteristics change the pressure patterns on the sediment water interface swi and consequently affect the distribution and reaction of solutes moving through the sediment in this section the effects of the aforementioned factors are numerically evaluated following the work in chen et al 2018 all computations carried out with h 0 04 m r e 3000 and a surface water depth of 0 5 m which results in an average surface flow velocity of u a v e 0 075 m s a turbulent energy k 2 9 10 5 m 2 s 2 and a specific turbulent dissipation rate of ω 3 52 s 1 to capture the maximum solute penetration depth in the groundwater domain the sediment thickness is set to 0 6 m the average total cpu time for all surface groundwater simulations is 1385 sec for illustration purposes a cross section of bed form e at y 0 98 m with simulated distributions of pressure velocity and solute transport characteristics are presented in fig 6 bed form shape and size determine the flow velocity and pressure gradients over the bed form higher pressure zones are correlated with higher pore water velocity at the sediment water interface fig 6b and e pressure gradients drive water and solute to penetrate into the sediment fig 6c and lower pressure zones are related to higher reaction rates fig 6d table 8 summarizes the simulation results for each bed form which will be discussed in details in the following sections the geometry of bed form i generates the maximum pressure gradient which not only resulted in the highest average groundwater velocity and greatest solute flux but also drove the highest reaction rates and largest reaction zone volume 4 1 pressure distribution at the sediment water interface turbulent surface water flow generates non uniform pressure distributions across the sediment water interface in response to bed form shape with more complex patterns associated with increasing δ φ 2 fig 7 for example as δ φ 2 increases for both linguoid δ φ 1 90 and lunate δ φ 1 270 bed forms the flow regime shifts as adjacent bed forms become staggered resulting in larger high pressure zones on the lee faces of the bed forms in phase δ φ 2 0 and out of phase δ φ 2 180 bed forms display symmetrical pressure distributions with aligned low and high pressure zones while the pressure distribution across intermediate bed forms δ φ 2 90 is more erratic in contrast as δ φ 1 increases the high and low pressure zones becomes more uniformly distributed across the bed form geometry trending away from focused high pressure zones along bed form troughs that drive downwelling conditions the spatially variable pressure distribution is applied on the surface groundwater interface as the dirichlet condition which has direct impact on the solute transport within the pore water further larger pressure zones ultimately affect hotspot formation by increasing both the volume of the reaction zone and the overall reaction rates table 8 4 2 solute exchange at the sediment water interface as explained in the methodology section once the stream flow reaches the steady state the subsurface flow simulation launches water and solute fluxes at the sediment water interface are calculated in pflotran the total mass flux entering or leaving the pore water is calculated by taking the sum of the mass flux in each boundary cell during the first few days of pore water simulation solutes are only infiltrating until the amounts of infiltration and exfiltration are stabilized and the system reaches an equilibrium as shown in fig 8 a and 8 b the net exchange flux of solute a is positive meaning that infiltration of solute a at the streambed is more than its exfiltration it should be noted that characteristics of solute a and solute b are identical and thus they show the same behavior net flux of solute c through the streambed is negative which indicates that solute c is mostly leaving the subsurface and going back to the surface water moreover the comparison of exchange fluxes for all bed forms in fig 8a and b shows that as δ φ 2 grows the net flux of solute a transferring from surface into subsurface as well as the net flux of solute c leaving the sediment increase in other words bed forms with larger δ φ 2 transfer higher amounts of solute in particular for lunate bed forms c f i the absolute value of solute transferred both solute a and solute c is growing as δ φ 2 is increasing from bed form c to bed form i linguoid bed forms a d g shows similar trend this is also shown in table 8 that higher δ φ 2 results in higher average velocity larger reaction rate and higher amounts of solute exchange bed form i has a phase shift δ φ 2 of 180 compared to bed form a which leads to 21 change in average velocity and average reaction rate the solute exchange flux is also increased by 21 for bed form i furthermore both streambed morphology and hydraulic conductivity k influence the solute exchange amount between surface water and groundwater fig 9 displays the equilibrated mass flux at time 20 days for linguiod type bed forms and with different k other bed form types such as lunate with the same δ φ 1 shows similar trends as shown increasing k will enhance the amount of entering mass of solute a from surface water to the hyporheic zone however the amount of solute c moving out of the hyporheic zone and into the stream decreases it is also clear that if sediment is more conductive the differences between linguoid bed forms are amplified in terms of solute mass flux 4 3 solute dynamics in the hyporheic zone the efficiency of nutrient transformations in the subsurface is largely a function of the timescale of biogeochemical reactions with enhanced removal often depending on sufficiently long solute residence times gomez velez and harvey 2014 gomez velez et al 2015b subsurface residence time distributions can influence the type and rate of many processes occurring in surface near surface and deep hydrologic environments ranging from solely physical to complex biogeochemical processes cardenas 2008 a number of recent studies have investigated the mechanisms controlling solute residence times associated with multiscale hyporheic exchange processes wörman et al 2006 cardenas 2007 kollet and maxwell 2008 wörman et al 2007 pflotran does not explicitly simulate solute residence time distributions rtd using traditional particle tracking rtd is the probability that an individual molecule of solute will travel from point a to point b in practice rtd may be estimated by injecting a solute at point a time 0 with a concentration of c0 and measuring concentrations c t at point b over time therefore in the present study instead of calculating the residence time distribution directly the age of infiltrated i e a and b and produced i e c solutes traveling along hyporheic flowpaths are estimated which essentially provides information about how long a given solute has been in the subsurface in each model grid cell gardner et al 2015 solutes are at age 0 the moment they infiltrate the subsurface and continue to age until they are transported out of the domain pflotran tracks the age of a conservative solute not subject to microbial degradation but when correlated with the concentrations of a reactive solute in each cell provides a proxy for residence time distributions bed form geometry controlled the extent of solute transformations by controlling how long solutes reside within the streambed at steady state t 20 days solute ages are lowest in the shallow streambed associated with higher groundwater velocities and shorter hyporheic flowpaths than deeper regions fig 10 higher ages up to 14 days in the deeper streambed which indicate longer solute residence times allowed for more complete solute transformation however resulting in lower concentrations of a and b and the highest concentrations of c as a governing factor in the dynamics of groundwater flow patterns the phase shift in the second planform sinuosity δ φ 2 strongly controlled the distribution of solute age based on bed form geometry average solute age increased from 2 08 0 01 days to 2 52 0 03 days as phase shift increased from δ φ 2 0 to δ φ 2 180 though solute concentration profiles followed a similar trend for all bed form geometries with solutes a and b decreasing to roughly 0 1 m and solute c reaching up to 0 9 m as the solute age in each cell increased concentrations are much more variable throughout the domain when bed forms are out of phase δ φ 2 0 for example the average standard deviation of the concentration of solute c is 568 and 351 larger in bed forms where δ φ 2 90 than those where δ φ 2 0 and δ φ 2 180 respectively temporal variation of concentration can also be described as time series at a particular depth as shown in fig 11 at 0 2 m deep in the center of the subsurface domain solute concentrations for out of phase bed forms δ φ 2 0 experience sharp increases while they gradually increase for in phase bed forms δ φ 2 0 this outcome agrees well with the exchange flux results in section 4 2 which demonstrated that the out of phase bed forms allow for a greater amount of solute exchange 4 4 sensitivity analysis on volume of reaction zone the volume of the reaction zone v r z is defined where reaction rates are greater than 1 of the maximum rate k max for each bed form type e g linguiod versus lunate v r z is most sensitive to δ φ 2 and increases for out of phase bed forms δ φ 2 0 figs 12 table 8 also shows that with a 180 phase shift v r z grows by 20 time series of v r z indicates that within the first 12 h half a day the volume of reaction zone is increasing with the same rate and value for all bed forms and later it will grow larger for out of phase bed forms fig 13 a hydraulic properties of sediments also influence solute transport and reaction processes hyporheic exchange volumes are lower in less conductive sediments and the flux of solutes into the streambed is thus decreased as a result bed form morphology is negligible to v r z because the magnitude of hyporheic exchange is below the threshold of influence conversely bed form shape is a primary control on v r z in highly conductive sediments k 10 6 m s because flow and solute exchange are not hindered by sediment permeability fig 13b however given the different flow regimes imposed by varying bed form geometries this relationship may not be consistent in all environments this inverse relationship also represents another layer of complexity that should be evaluated in future studies under otherwise analogous environmental conditions i e flow depth surface water velocity streambed sediments of varying permeability will form bed forms of different size and shape as a result the relative influence of bed form geometry and sediment permeability on hyporheic processes will shift across time and space as sediments are transported and the complex streambed topography evolves in response to episodic flow events depending on the bed form geometry the maximum reaction rate for identical biogeochemical processes may change in space fig 14 a depicts the plan view of locations with maximum reaction rates in different bed forms fig 14b d display the locations of maximum reaction rate from a cross sectional view here bed forms a e and h are presented to show distinct locations of maximum reaction rate spots 4 5 effects of instantaneous pressure fluctuations on hyporheic exchange the results presented in the previous sections were calculated under the steady state pressure distribution along the sediment water interface in this section in order to evaluate the hyporheic exchange driven by pressure fluctuations across bed forms we simulated transient behavior of river pressure condition at the outlet fig 15 a the large eddy simulation les sagaut 2006 was carried out in openfoam to simulate pressure changes due to a hydropeaking event the resulting pressure distribution over swi at each time step was used in pflotran to calculate the flow and solute exchange in the hyporheic zone fig 15d to f display the pressure distribution over swi at the center line of the domain 0 0 x 1 0 m y 0 87 m at three time snapshots t 2 1 days t 6 3 days t 10 5 days considering the wave like boundary condition for pressure at the outlet fig 15a these time snapshots are selected to cover a range of varied pressure distribution over the domain it is found that the pressure distribution over swi changes with time and consequently the reaction zone size fig 15b and the maximum reaction rate fig 15c prior studies have shown that the pressure fluctuations are important in enhancing the size of geochemical hotspots shuai et al 2017 in the present section to investigate how the pressure change combined with the bed form phase shifts influence the geochemical hotspots we performed the transient simulation for bed forms a d and g our results show that differences in reaction zone size and the maximum reaction rates among bed forms a d and g are consistent during the stage fluctuations confirming the strong controls of bed form geometry on development of reaction hotspots while the pressure profile changes at swi over each bed form type the volume of reaction zone slightly increases due to pressure fluctuations see fig 15b and d f the maximum reaction rate is dependent on values of δ φ 2 for example for bed form a with δ φ 2 0 the maximum reaction rate slightly increases with time while the opposite is observed for bed form g with δ φ 2 180 5 conclusions and future directions this work studied how bed form topographies control various hyporheic exchange processes a framework to simulate surface and subsurface flow and reactive solute transport within the hyporheic zone is developed the framework enables prediction of hotspots for different surface flow properties bed form shapes and sediment characteristics while the framework is currently utilized for a simple reactions and the homogeneous sediment it could also be used to represent heterogeneous sediments as well as biogeochemical processes such as nutrient transformation which involve multiple equilibrium and kinetically controlled reactions bed forms drive small scale hyporheic exchange and host dynamic regions of biogeochemical activity as a primary control on hyporheic residence times and nutrient availability bed form geometry largely influences the rate and distribution of such microbial hotspots as shown in table 8 and fig 12 the reaction rate and the volume of reaction zone increase for out of phase bed forms which implies the higher intensity of geochemical hotspots this work specifically shows that the reaction rates depend on exchange fluxes and thus on bed form specific shape and morphologies in particular when bed form shape is represented by a series of sine curves the phase shift of the second planform sinuosity δ φ 2 drives complex pressure distributions across the streambed that increases solute exchange and the depth of solute penetration often resulting in larger reaction zones and overall higher reaction rates for instance with a phase shift δ φ 2 of 180 the solute exchange flux would increase by 21 and the volume of reaction zone would grow by 20 the results in this research suggest that out of phase bed forms generate more complex groundwater flow patterns with variable solute ages however which reduce the efficiency of solute transformations another key finding of the present study is that the bed form shape is a primary control on the size of the reaction zone in highly conductive sediments k 10 6 m s because flow and solute exchanges are not hindered by sediment permeability time is also an important factor in pressure variations over swi which leads to change of the reaction zone size and the reaction rates future studies will need to address how heterogeneity in various bed forms affects the biogeochemical process and reaction rates bed form migration and erosional and depositional processes were outside of the scope of this study but evolving bed topography would cause removal efficiency to vary temporally as the geometry shifted between in and out of phase future research should also focus on how temporal variability in bed form geometry alters hyporheic flow patterns and shifts biogeochemical reaction rates especially in dynamic environments with regular stage changes i e tides dam release where erosional and depositional processes would likely be accelerated a clear understanding of the role of hyporheic bed forms on hyporheic exchange processes is crucial to the protection of water quality especially as anthropogenic contaminant input to the biosphere increases credit author statement faranak behzadi software conceptualization methodology visualization validation writing the original draft corey d wallace software writing validation visualization dylan ward review and editing haiyan zhou review and editing roelof versteeg review and editing funding acquisition mohamad reza soltanian supervision conceptualization methodology review and editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the first author fb was funded by university of cincinnati through faculty startup fund to the last author mrs the second author cdw was funded by the national science foundation ear pf 1855193 this research was partially supported by the u s department of energy under sbir award de sc0019621 to subsurface insights llc to ensure open science and data accessibility the codes and input files associated with the present model are provided in http www hydroshare org resource e6b1394d006a430f9cac331f9f251d1b which can reproduce the examples and results 
243,pumping tests are established for characterizing spatial average properties of aquifers at the same time they are promising tools to identify heterogeneity characteristics such as log conductivity variance and correlation scales we present the extended generalized radial flow model egrf which combines the characterization of well flow in fractal geometry with an upscaled conductivity for pumping tests in heterogeneous media we show that the egrf is a generalization of previously solutions such as that of barker butler and neuman we derive effective conductivities for uniform and well flow conditions in heterogeneous log normal media with a truncated power law correlation structure through the upscaling procedure coarse graining the radial dependent effective conductivity for well flow reflects the gradual change of heterogeneity impact on average pumping test drawdowns we then combine upscaled conductivities with the egrf model to determine the effective pumping test solution we provide a proof of concept by comparing theoretical upscaling results with monte carlo well flow simulations in heterogeneous fractal fields the egrf and upscaling results are implemented and made freely available as python code for transport simulation as well as pumping test analysis keywords egrf groundwater heterogeneity groundwater flow equation pumping test 1 introduction due to their cost efficiency pumping tests are widely used to hydraulically characterize subsurface drawdowns at observation wells are fitted to analytical expression such as thiem s solution thiem 1906 to estimate the mean conductivity from steady state drawdowns or theis solution theis 1935 for estimating the mean hydraulic conductivity and mean storativity from transient drawdowns despite their long history pumping tests continue to evolve and new improvements are developed renard 2005 however common analyzing techniques assume a single mean conductivity to be representative for the entire aquifer domain under investigation consequently their results cannot represent spatial heterogeneities which are known to be an important feature for many sediments field observations show that log conductivity is approximately normal distributed gelhar 1993 rubin 2003 thus spatial heterogeneities are modelled as log normal random fields characterized by the mean value and a covariance function to account for spatially correlated variability here the characteristic length scale is a crucial parameter given that heterogeneity is present from pore to regional scales dagan 1986 indelman and abramovich 1994 showed that pumping tests in heterogeneous media cannot be interpreted by simple averaging strategies least a homogeneous k representative mean values differ depending on the distance to the pumping well sánchez vila et al 2006 an effective description of hydraulic conductivity k eff is required which reproduces the effect of heterogeneity on pumping as function of the aquifer statistics and boundary conditions the nature of convergent flow further leads to an radially symmetric form of the effective conductivity k eff r neuman et al 2004 schneider and attinger 2008 based on a explicit effective conductivity k eff r derived through upscaling zech et al 2012 proposed extensions to thiem s and zech et al 2016 to theis formula to characterize well flow in heterogeneous aquifers these extensions allow estimating the parameters of gaussian fields like the mean variance and correlation length from pumping test observations zech et al 2015a well flow in fractured media is even more complex since such media shows self similarity and behaves like fractals bonnet et al 2001 diagnostic plots renard et al 2009 are powerful tools to identify if pumping test observations reveal fractal behavior and consequently if interpretation requires to consider a non integer dimension however quantitative approaches for interpreting pumping tests in heterogeneous media are still limited at best to a single correlation scale and cannot be used for an analysis of fractal properties such as the fractal flow dimension barker 1988 borgne et al 2004 the generalized radial flow grf model of barker 1988 represents an early example for an interpretative model of pumping tests in fractured media this work was recently extended with regard to i skin effect chang and yeh 2011 ii synthetic flow systems bowman et al 2013 iii non darcian radial flow liu et al 2016 iv generalized forchheimer radial flow liu et al 2017 and v generalized radial transport mamud 2019 however all these extensions are restricted to a constant value for transmissivity and storativity for the whole domain which hampers their use to infer heterogeneous properties to account for the impact of heterogeneity butler 1988 introduced a simple approach which combines near and far field influences in an effective solution for the drawdown of the pumping test avci and sahin 2014 generalized this concept further by modelling multiple concentric zones around the pumping well both approaches provide effective solutions for the drawdown but do not connect to and therefore do not facilitate any inference of the heterogeneous properties of the conductivity field neuman et al 2004 and subsequently zech et al 2012 2015a addressed this problem and extended the approach by connecting the characteristic of the heterogeneous properties of the conductivity field to the resulting drawdown but to this day all these approaches neither account for heterogeneous fields with fractal covariance functions nor provide a general solver for the radial symmetric groundwater flow equation thus numerical tools for pumping test analysis with these methods are lacking we address the present shortcomings by developing an extended grf egrf model which combines both aforementioned developments the egrf model is able to account for spatial heterogeneities including fractal representations using an efficient and stable numerical solver for the effective head solution of the drawdown we demonstrate the capabilities of the egrf model using a generalized version of the truncated power law tpl variogram di federico and neuman 1997 we derive an effective well flow adapted conductivity field for the tpl covariance function using the upscaling procedure coarse graining attinger 2003 in a well flow adapted methodology schneider and attinger 2008 zech and attinger 2016 in combination with the egrf we are able to calculate the effective drawdown solution we demonstrate the validity of this approach by comparing the analytical method with monte carlo simulations of pumping tests in random fractal conductivity fields we further make all software public available as open source python packages the course of the paper is the following we outline the used methods such as the grf model the heterogeneity representation and the fundamentals on power law variograms used to describe a fractal conductivity field next follows the result section where we derive the extended generalized radial flow model and demonstrate how it acts as a solver for other effective solutions previously reported in the literature we demonstrate the upscaling procedure coarse graining for tpl variograms both for uniform and well flow with particular emphasis on the effective head solution for a tpl variogram making use of the egrf eventually we discuss monte carlo simulations that demonstrate the validity of our egrf model for a pumping test in a heterogeneous fractal conductivity field in two dimensions the full mathematical derivations of the theoretical results are presented in the supporting information si we close with a summary and conclusions 2 methods foundations 2 1 generalized radial flow model barker 1988 introduced the generalized radial flow grf model to characterize hydraulic tests in fractal geometry by the partial differential equation 1 1 r d 1 r r d 1 t h r s h t where h r t is the hydraulic head as a function of the radial distance r from the well s is the storativity t is the transmissivity and d is the arbitrary flow dimension the model is completed by specifying the initial condition h r t 0 0 the outer boundary condition h r r inf t 0 and the pumping condition lim r r w b r w 0 t h d σ q which can be rewritten in terms of lim r r w r d 1 h r r t q t α d where α d 2 π d γ d 2 1 is the surface of the unit sphere r inf represents the aquifer dimension and r w is the radius of the well further assumptions are an infinitely small well r w 0 and an infinitely big aquifer r inf we interpret transmissivity t and storativity s as dependent on the flow dimension d which can be calculated according to s s s b 3 d and t k b 3 d s s is the storage term and k the conductivity b is the extent of the aquifer as described in barker 1988 for integer cases of d the following interpretations hold i d 1 b is the square root of the cross section area and t is an integrated quantity like in 2d ii d 2 t and s coincide with the classical meaning of storativity and transmissivity iii d 3 the term b 3 d vanishes and s s s and t k while t and s represent local constant parameter of the domain in the grf model we stick to the definition of t through k for the adaption to a radial dependent quantity representative for the well flow behaviour observed during pumping for constant values of s and t eq 1 is solved by 2 h r t q r 2 d 4 π d t γ d 2 1 s r 2 4 t t here γ s x is the incomplete gamma function abramowitz et al 1972 2 2 log normal conductivity and representative averages for the application part of this study we model the heterogeneous hydraulic conductivity as a spatial random function following a log normal distribution 3 pdf k x μ σ 2 1 x 2 π σ 2 exp ln x μ 2 2 σ 2 the parameters μ and σ 2 are the mean and variance of the underlying normal distribution of ln k n μ σ 2 when considering flow through log normal conductivity representative averages have been determined for particular flow situations by representative hydraulic conductivity we mean a single parameter describing the average behavior of groundwater flow within an aquifer at a given scale and flow condition a detailed review on the subject is eg provided by sánchez vila et al 2006 of particular interest for us are two special cases uniform flow through isotropic stationary media in a d dimensional unbounded domain the effective conductivity which describes a response of a medium to these boundary conditions is commonly described by the effective conductivity of matheron 1967 4 k efu k g exp 1 2 1 d σ 2 with the geometric mean k g exp μ and log conductivity variance σ 2 note that k efu is not fully exact since it actually depends on the correlation function as shown by stepanyants and teodorovich 2003 but provides a reasonable approximation radially convergent flow does not have a unique constant representative value indelman and abramovich 1994 but its asymptotic behaviour is known depending on the assigned boundary condition bc at the well 5 r 0 k well k h k g exp 1 2 σ 2 for constant flux bc k a k g exp 1 2 σ 2 for constant head bc 6 r k efu while constant flux bc at the well are typical for studies considering 2d flow and transmissivity i e well flow at larger scales small scale pumping tests require adoption to 3d flow where a constant head bc is more realistic indelman et al 1996 indelman and dagan 2004 the representative conductivity in the far field refers to that of uniform flow eq 4 given that the flow there is not further impacted by the gradients at the well 2 3 truncated power law tpl variograms 2 3 1 definition and background power law variograms are used in hydrogeology to account for a continuous increase in log conductivity variance with growing domain size which is typical for fractal media 7 γ r c 0 r 2 h for 0 h 1 where r characterizes the two point euclidean distance c 0 describes the intensity of variation and h is the hurst coefficient di federico and neuman 1997 showed that power law variograms γ r can be constructed through a superposition of classic non fractal variograms like the gaussian or exponential variogram functions γ r λ this superposition is done using a weighted integral over the length scales λ 8 γ r 0 γ r λ d λ λ the modes γ r λ are the classical variogram functions at each scale λ with a scale dependent variance of σ 2 λ c λ 2 h such fractal behaviour is typical for fractured geological media neuman and di federico 2003 heße et al 2014 di federico and neuman 1997 used the integral representation in eq 8 to introduce an upper and lower truncation reflecting the upper fine size and lower scales resolution of a real world subsurface system let ℓ u and ℓ l be these upper and lower bounds respectively for the sake of brevity we assume ℓ l 0 in the following consequently the tpl variograms with gaussian γ g and exponential γ e modes were given by di federico and neuman 1997 as follows 9 γ ℓ u g r c ℓ u 2 h 2 h 1 exp r 2 ℓ u 2 r ℓ u 2 h γ 1 h r ℓ u 2 10 γ ℓ u e r c ℓ u 2 h 2 h 1 exp r ℓ u r ℓ u 2 h γ 1 2 h r ℓ u where γ s x is the incomplete gamma function abramowitz et al 1972 here the gaussian variogram is defined according to the auto correlation function ρ g r exp r 2 λ 2 and the exponential variogram through ρ e r exp r λ 2 3 2 the stable tpl variogram we use the stable model ρ s r wackernagel 2003 to unify and simplify the given tpl variograms a joint generalization of the gaussian and exponential auto correlation function is provided by 11 ρ s r exp r λ α for 0 α 2 the roughness parameter 0 α 2 covers the transition from the uncorrelated nugget model α 0 the rough exponential model α 1 up to the smooth gaussian model α 2 applying the stable model as modes of the tpl variogram in eq 8 results in the auto correlation function of the stable tpl model 12 ρ ℓ u s r 2 h α e 1 2 h α r ℓ u α where e z is the exponential integral function abramowitz et al 1972 the resulting stable tpl variogram is given by 13 γ ℓ u s r σ ℓ u 2 1 2 h α e 1 2 h α r ℓ u α with variance σ ℓ u 2 c ℓ u 2 h 2 h the stable variogram 13 results in the truncated gaussian eq 9 for α 2 and in the truncated exponential eq 10 for α 1 in order for the tpl variogram 13 to converge to a power law as in eq 7 it has to provide a finite limit for the case of ℓ u di federico and neuman 1997 thus the hurst coefficient has to meet the condition 14 0 h α 2 the hurst coefficient ultimately controls the roughness of the corresponding field since it determines the slope of the variogram at the origin the tpl model is thereby able to reproduce the same spectrum of variograms as the matérn model wackernagel 2003 which is outlined in detail in the si 3 results 3 1 the extended generalized radial flow model 3 1 1 derivation we extend the grf model to account for radially dependent transmissivity t r and storativity s r making use of a step function approximation note that the radial dependency is not assumed for the underlying aquifer characteristics but relate to the way a pumping test filters transmissivity and storativity thus t r and s r reflect upscaled quantities not the local ones a similar procedure was presented by avci and sahin 2014 for a fixed number of concentric zones in 2d which in turn was build on the findings of butler 1988 the characteristic differential equation of the egrf as extension of eq 1 reads 15 1 r n 1 r r n 1 t r h r s r h t we treat transmissivity and storativity as radial symmetric step functions 16 t r t 0 r r 0 t n r r n s r s 0 r r 0 s n r r n with t and s being constant on concentric circles around the point of origin given by r i r i r i 1 with r 0 r w and r n 1 r inf adapting a continuous radially dependent transmissivity as derived for the tpl structure later eq 22 to the radially symmetric step functions is achieved by making use of the harmonic average over each ring r i the harmonic mean of a radial symmetric function f r over a concentric segment r x r d r 0 x r 1 in d dimensions is given by 17 f r h d r 1 d r 0 d r 0 r 1 r d 1 f r 1 d r 1 more details on the radial harmonic mean is given in the si examples of the function approximations for a radially dependent transmissivity t r are displayed in fig 1 for two forms of an effective conductivity with different underlying variograms the hydraulic head as solution of eqs 15 with 16 is a piece wise function h i h r i which has to fulfil conditions along the ring boundaries for i 0 n 1 18 h i r i 1 t h i 1 r i 1 t 19 t i t i 1 h i r r i 1 t h i 1 r r i 1 t the first equation is a continuity condition and the second one ensures mass conservation to the best of our knowledge no analytical solution of the hydraulic head h r t of eq 15 exists instead we apply the laplace transformation to derive an equation system which can be solved by applying a penta diagonal matrix solver as presented by askar and karawia 2015 and implemented by müller 2019 2020b the result is then transformed back into the time domain by the algorithm of stehfest 1970 a detailed derivation including the full set of equations is provided in the si the whole workflow is implemented and made available as an open source python package named anaflow müller 2020a 3 1 2 application of egrf the egrf can be applied to arbitrary radial conductivity functions k r reflecting the averaging effect of pumping tests on conductivity examples are the extended theis solution in 2d and 3d of zech et al 2016 derived from the effective representations found in schneider and attinger 2008 zech et al 2012 the apparent transmissivity of neuman et al 2004 as well as the transmissivity for a concentric zone aquifer of avci and sahin 2014 which is an extension to the two zone aquifer described by butler 1988 a visualization is provided in fig 2 a shows the solution of barker 1988 for a finite domain b represents the solution of butler 1988 incorporating a separate transmissivity at the well c coincides with the finding of avci and sahin 2014 for a finite domain d is the transient solution for the apparent transmissivity presented by neuman et al 2004 e shows the effective solution for transient pumping test in heterogeneous aquifers following a gaussian variogram derived by schneider and attinger 2008 which is in line with the derivations of zech et al 2016 f is an extension of e incorporating anisotropy in 3d zech et al 2012 under the dupuit forchheimer assumption to solve the depth averaged groundwater flow equation in 2d the results match the calculations of zech et al 2016 all solutions share the same far field behavior meaning the fluctuations near the pumping well do not influence the drawdown at a sufficient distance the solutions d and e behave very similar which confirms that these two approaches to characterize effective drawdowns in heterogeneous media result in almost the same type curves the solution shown in e was used by müller et al 2021 to identify parameters of aquifer heterogeneity from actual pumping test observations 3 2 upscaling of tpl conductivity with coarse graining 3 2 1 effective conductivity for uniform groundwater flow we determine the effective conductivity for a log normal conductivity with tpl variogram for uniform flow considering a finite filter length in the upscaling process the coarse graining method provides a framework to analyze the groundwater flow through random conductivity fields for filtering up to a length scale λ following the lines of attinger 2003 we focus on the gaussian case of stable tpl setting α 2 in eq 13 this choice can be justified by the often reported insensitivity of groundwater flow to the roughness of the conductivity field riva and willmann 2009 heße et al 2015 and that roughness is not solely controlled by α but also h a detailed explanation and derivation is provided in the si the scale dependent mean conductivity for uniform flow at the filter scale λ is given by 20 k tpl uni λ k g exp σ u 2 2 σ u 2 d 1 1 λ 2 ℓ u 2 d 2 ϕ d h λ 2 ℓ u 21 ϕ d h z 2 h d 2 h 2 f 1 d 2 1 d 2 h 1 1 1 z 2 1 z 0 2 h d 2 h z where k g is the geometric mean σ u 2 is the log conductivity variance d denotes the dimension h is the hurst coefficient ℓ u is the upper truncation length and 2 f 1 is the ordinary hyper geometric function abramowitz et al 1972 the result for the mean value of log normal conductivity with a tpl variogram when filtering under uniform flow conditions eq 20 is an extension of the findings of attinger 2003 which focused on a gaussian variogram the difference is solely expressed in the correction factor ϕ d h eq 21 which incorporates the effect of the hurst coefficient h 3 2 2 effective conductivity for radially convergent flow we apply the upscaling procedure radial coarse graining to determine the effective mean conductivity for a well flow setting note that this effective mean conductivity is neither the equivalent nor the apparent quantity according to the classification given in sánchez vila et al 2006 but is a quantity reproducing observed well flow when solving the flow equation with it following schneider and attinger 2008 and zech and attinger 2016 we adapt the coarse graining procedure to radially convergent flow by substituting the filter length scale λ with the distance to the well r having a variable filter length r instead of a constant represents the non uniform averaging behaviour of flow during pumping the distance dependent effective conductivity for well flow reads 22 k tpl r k efu exp χ 1 ξ r ℓ u 2 d 2 ϕ d h ξ r ℓ u here k efu denotes the dimension dependent effective conductivity for uniform flow eq 4 representative for flow far from the pumping well χ is a short notation for the ratio χ ln k well k efu where k well is the effective conductivity at the pumping well depending on the boundary condition eq 5 it simplifies to χ h ln k h k efu 1 d 1 σ u 2 and χ a ln k a k efu σ u 2 d respectively ξ is a proportionality factor determined as ξ 2 by zech et al 2012 ϕ d h z is defined in eq 21 k tpl r in eq 22 is based on the assumption of isotropy however it can be easily extended to a solution in d 3 dimensions with vertical anisotropy following the lines of zech et al 2015a the specific solution is provided in the si the radially symmetric effective conductivity k tpl r represents the way a pumping test radially filters the non symmetric heterogeneity of the underlying regular log normal field eq 3 with tpl variogram eq 7 fig 3 shows the shape of the effective conductivity as function of the dimensionless ratio of radial distance to correlation scale ℓ u it displays the transition between the two representative conductivities for well flow k efu in the far field dimension dependent and k h at the well assuming the constant flux bc here the specifics of this transition are a function of the correlation structure and its defining parameters the effective conductivity k tpl r is in line with effective representations of conductivity for well tests such as of neuman et al 2004 schneider and attinger 2008 zech et al 2012 zech et al 2015a zech and attinger 2016 zech et al 2016 they all provide effective transmissivity or conductivity distributions that act as a transition between the harmonic mean at the pumping well and the effective far field value 3 2 3 effective head solution for tpl variograms the representative mean hydraulic head for a pumping test results from solving the groundwater flow equation in radial coordinates eq 15 with k tpl r along the lines of zech et al 2012 2016 a closed form analytical expression cannot be determined instead we provide semi analytical type curves making use of the egrf section 3 1 we solve the flow equation with the egrf inserting the effective tpl conductivity eq 22 for t r the resulting effective head drawdown h tpl r t can be interpreted as an average behaviour representing the well flow through a heterogeneous aquifers with a log normal conductivity distribution following a tpl variogram a visual impression is provided in fig 4 for a certain choice of aquifer statistical parameters head values have been determined numerically making use of anaflow 3 3 proof of concept with monte carlo simulations we performed numerical pumping tests simulations in random conductivity as virtual measurements to demonstrate the viability of our method the average pumping test drawdown h ens r t for an ensemble of log normal transmissivity fields with a tpl variogram provides the representative behaviour of well flow in heterogeneous aquifers the ensemble average drawdown h ens r t is independent from the semi analytical upscaling results h tpl r t we compare both results to prove the validity of h tpl r t as semi analytical generalization of effective pumping test behaviour first we generate ensembles of 1000 log normal random transmissivity fields eq 3 with a tpl variogram eq 9 using the python package gstools müller and schüler 2020 heße et al 2014 one realization is shown in fig 5 we cover various parameter combinations with variances of σ 2 1 and 2 25 upper length scale of correlation ℓ 10 m and 20 m and hurst coefficient h 0 5 and 0 9 pumping tests are simulated using the finite element software opengeosys through the python api ogs5py müller et al 2020 we use a process adapted 2d radially symmetric numerical mesh it has a diameter of 2000 m to avoid boundary effects 64 angular subdivisions and 100 radial units with resolution decreasing with distance to the pumping well we applied a constant flux boundary condition at the well with a constant pumping rate of q w 10 4 m 3 s technical details are further outlined in the si the simulated drawdown of each heterogeneous transmissivity realizations is averaged over the angle to gain a solely radial depending head ensemble means h ens r t for each set of statistical parameters is achieved through averaging over the n 1000 individual numerical pumping tests fig 6 shows the calculated ensemble mean for the parameter set p0 with s 10 4 t g 10 4 m 2 s σ 2 1 0 ℓ 10 m and h 0 5 in comparison to the effective drawdown h tpl r t for the same parameters with a relative error of 2 56 results of all other ensembles are provided in the si along with information about relative errors between ensemble means and effective heads interested readers can generate their own ensemble making use of the provided workflow müller and zech 2021 the agreement of the ensemble mean h ens r t and the effective drawdown h tpl r t in fig 6 the same holds for all other ensembles see si provides evidence that t tpl r represents the effective transmissivity for pumping test in this particular heterogeneous structure thus the average drawdown behaviour of pumping tests can be predicted based on the transmissivity statistics using h tpl r t 4 summary and conclusions we presented the extended general radial flow model egrf which combines the mathematical characterization of well flow in arbitrary fractal dimensions and an effective description of conductivity for pumping tests in heterogeneous log normal fields the non uniform effective conductivity accounts for the radial filtering effect of well flow on aquifer heterogeneity results are implemented in an efficient and stable numerical solver to compute the effective head drawdown from the radial flow equation the egrf extends the advantage of the general radial flow model barker 1988 of non integer dimensions of the flow system to heterogeneous fractal aquifers we show that the egrf acts as general solver for non uniform transmissivity descriptions of pumping tests such as that of butler 1988 neuman et al 2004 avci and sahin 2014 or zech et al 2016 we further derive effective conductivities for uniform flow and for pumping tests in heterogeneous aquifers with a log normal conductivity distribution and a truncated power law tpl correlation structure this conceptualization of the heterogeneity represents fractal aquifers which exhibit structures with more then one length scale we used the upscaling procedure coarse graining to derive effective conductivity descriptions as a function of the tpl heterogeneity input parameters mean log conductivity variance upper correlation scale and hurst coefficient we present an analytical expression for mean conductivity which represent average behaviour under uniform flow conditions at a particular filter length scale results are extended to radial convergent flow conditions leading to an effective upscaled conductivity function depending on the radial distance and aquifer statistics making use of the presented egrf we determine the effective drawdown behaviour i e the hydraulic head as function of radial distance and tpl heterogeneity parameters we show that upscaling results are indeed representing well flow in log normal media with a tpl correlation structure by performing monte carlo flow simulations we generated ensembles of random fields with various parameter combinations and performed numerical pumping tests these independent ensemble simulations are fully in line with the mean drawdown predicted by the tpl effective head from the egrf the presented results lead us to the following conclusions the egrf can be used to calculate pumping test drawdowns for an arbitrary form of upscaled radial transmissivity t r this opens the opportunity to generate type curves for effective transient drawdowns in heterogeneous media well flow in heterogeneous fields with a truncated power law correlation structure can be effectively described in the average with an analytical expression for the conductivity as function of the radial distance to the well and the statistical field parameters the methodology can be used for inverse aquifer characterization comparing observed drawdowns to egrf drawdowns of effective tpl transmissivity allows estimating mean storativity mean transmissivity log transmissivity variance upper correlation scale and hurst coefficient the results presented herein are a sound foundation for verifying the applicability of the method using real data from heterogeneous aquifers we anticipate and plan further studies on e g i the significance of fractal flow dimensions d in interaction with effective transmissivity distributions ii the analysis of actual field pumping tests in fractured media iii analyzing the influence of radial varying storativity while fractals are well established for describing fractured media with its heterogeneities at multiple scales it is still under debate if porous media shows such behaviour at least at the scale of interest here although some authors report on self similar porous media with heterogeneities at increasing scales e g desbarats and bachu 1994 molz et al 2004 neuman et al 2008 many studies build on the miss interpretation of the data reported by gelhar et al 1992 along the universal scaling of macrodispersivity which is actually not supported by reliable field data zech et al 2015b 2018 given that the matter is still debated we leave it to the user if he considers it legitimate to use a fractal model in porous media the presented novel methodology including open source software implementations müller and zech 2021 does not only provide a workflow to describe pumping test in heterogeneous aquifers of arbitrary flow dimension and fractal heterogeneity structure but allows quantifying it thus we can infer fractal heterogeneity characteristics from pumping test drawdowns code availability software packages with solution implementations and scripts for reproducing figures and ensemble simulations are given at geostat examples extended grf model müller and zech 2021 workflow to reproduce results of this paper anaflow müller 2020a implementation of the egrf model the effective solution h tpl and the effective transmissivity t tpl pentapy müller 2019 pentadiagonal matrix solver used for the egrf solution in laplace space gstools müller and schüler 2020 tpl variograms and random field generation credit authorship contribution statement sebastian müller conceptualization methodology software validation formal analysis writing original draft visualization falk heße writing original draft writing review editing sabine attinger supervision alraune zech conceptualization validation writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements sebastian müller was funded by the german federal environmental foundation via grant number 20016 432 the authors are thankful to the editors the anonymous reviewers and aldo fiori for their constructive comments which helped to improve the manuscript supplementary material supplementary material associated with this article can be found in the online version at 10 1016 j advwatres 2021 104027 appendix a supplementary materials supplementary data s1 supplementary raw research data this is open data under the cc by license http creativecommons org licenses by 4 0 supplementary data s1 
243,pumping tests are established for characterizing spatial average properties of aquifers at the same time they are promising tools to identify heterogeneity characteristics such as log conductivity variance and correlation scales we present the extended generalized radial flow model egrf which combines the characterization of well flow in fractal geometry with an upscaled conductivity for pumping tests in heterogeneous media we show that the egrf is a generalization of previously solutions such as that of barker butler and neuman we derive effective conductivities for uniform and well flow conditions in heterogeneous log normal media with a truncated power law correlation structure through the upscaling procedure coarse graining the radial dependent effective conductivity for well flow reflects the gradual change of heterogeneity impact on average pumping test drawdowns we then combine upscaled conductivities with the egrf model to determine the effective pumping test solution we provide a proof of concept by comparing theoretical upscaling results with monte carlo well flow simulations in heterogeneous fractal fields the egrf and upscaling results are implemented and made freely available as python code for transport simulation as well as pumping test analysis keywords egrf groundwater heterogeneity groundwater flow equation pumping test 1 introduction due to their cost efficiency pumping tests are widely used to hydraulically characterize subsurface drawdowns at observation wells are fitted to analytical expression such as thiem s solution thiem 1906 to estimate the mean conductivity from steady state drawdowns or theis solution theis 1935 for estimating the mean hydraulic conductivity and mean storativity from transient drawdowns despite their long history pumping tests continue to evolve and new improvements are developed renard 2005 however common analyzing techniques assume a single mean conductivity to be representative for the entire aquifer domain under investigation consequently their results cannot represent spatial heterogeneities which are known to be an important feature for many sediments field observations show that log conductivity is approximately normal distributed gelhar 1993 rubin 2003 thus spatial heterogeneities are modelled as log normal random fields characterized by the mean value and a covariance function to account for spatially correlated variability here the characteristic length scale is a crucial parameter given that heterogeneity is present from pore to regional scales dagan 1986 indelman and abramovich 1994 showed that pumping tests in heterogeneous media cannot be interpreted by simple averaging strategies least a homogeneous k representative mean values differ depending on the distance to the pumping well sánchez vila et al 2006 an effective description of hydraulic conductivity k eff is required which reproduces the effect of heterogeneity on pumping as function of the aquifer statistics and boundary conditions the nature of convergent flow further leads to an radially symmetric form of the effective conductivity k eff r neuman et al 2004 schneider and attinger 2008 based on a explicit effective conductivity k eff r derived through upscaling zech et al 2012 proposed extensions to thiem s and zech et al 2016 to theis formula to characterize well flow in heterogeneous aquifers these extensions allow estimating the parameters of gaussian fields like the mean variance and correlation length from pumping test observations zech et al 2015a well flow in fractured media is even more complex since such media shows self similarity and behaves like fractals bonnet et al 2001 diagnostic plots renard et al 2009 are powerful tools to identify if pumping test observations reveal fractal behavior and consequently if interpretation requires to consider a non integer dimension however quantitative approaches for interpreting pumping tests in heterogeneous media are still limited at best to a single correlation scale and cannot be used for an analysis of fractal properties such as the fractal flow dimension barker 1988 borgne et al 2004 the generalized radial flow grf model of barker 1988 represents an early example for an interpretative model of pumping tests in fractured media this work was recently extended with regard to i skin effect chang and yeh 2011 ii synthetic flow systems bowman et al 2013 iii non darcian radial flow liu et al 2016 iv generalized forchheimer radial flow liu et al 2017 and v generalized radial transport mamud 2019 however all these extensions are restricted to a constant value for transmissivity and storativity for the whole domain which hampers their use to infer heterogeneous properties to account for the impact of heterogeneity butler 1988 introduced a simple approach which combines near and far field influences in an effective solution for the drawdown of the pumping test avci and sahin 2014 generalized this concept further by modelling multiple concentric zones around the pumping well both approaches provide effective solutions for the drawdown but do not connect to and therefore do not facilitate any inference of the heterogeneous properties of the conductivity field neuman et al 2004 and subsequently zech et al 2012 2015a addressed this problem and extended the approach by connecting the characteristic of the heterogeneous properties of the conductivity field to the resulting drawdown but to this day all these approaches neither account for heterogeneous fields with fractal covariance functions nor provide a general solver for the radial symmetric groundwater flow equation thus numerical tools for pumping test analysis with these methods are lacking we address the present shortcomings by developing an extended grf egrf model which combines both aforementioned developments the egrf model is able to account for spatial heterogeneities including fractal representations using an efficient and stable numerical solver for the effective head solution of the drawdown we demonstrate the capabilities of the egrf model using a generalized version of the truncated power law tpl variogram di federico and neuman 1997 we derive an effective well flow adapted conductivity field for the tpl covariance function using the upscaling procedure coarse graining attinger 2003 in a well flow adapted methodology schneider and attinger 2008 zech and attinger 2016 in combination with the egrf we are able to calculate the effective drawdown solution we demonstrate the validity of this approach by comparing the analytical method with monte carlo simulations of pumping tests in random fractal conductivity fields we further make all software public available as open source python packages the course of the paper is the following we outline the used methods such as the grf model the heterogeneity representation and the fundamentals on power law variograms used to describe a fractal conductivity field next follows the result section where we derive the extended generalized radial flow model and demonstrate how it acts as a solver for other effective solutions previously reported in the literature we demonstrate the upscaling procedure coarse graining for tpl variograms both for uniform and well flow with particular emphasis on the effective head solution for a tpl variogram making use of the egrf eventually we discuss monte carlo simulations that demonstrate the validity of our egrf model for a pumping test in a heterogeneous fractal conductivity field in two dimensions the full mathematical derivations of the theoretical results are presented in the supporting information si we close with a summary and conclusions 2 methods foundations 2 1 generalized radial flow model barker 1988 introduced the generalized radial flow grf model to characterize hydraulic tests in fractal geometry by the partial differential equation 1 1 r d 1 r r d 1 t h r s h t where h r t is the hydraulic head as a function of the radial distance r from the well s is the storativity t is the transmissivity and d is the arbitrary flow dimension the model is completed by specifying the initial condition h r t 0 0 the outer boundary condition h r r inf t 0 and the pumping condition lim r r w b r w 0 t h d σ q which can be rewritten in terms of lim r r w r d 1 h r r t q t α d where α d 2 π d γ d 2 1 is the surface of the unit sphere r inf represents the aquifer dimension and r w is the radius of the well further assumptions are an infinitely small well r w 0 and an infinitely big aquifer r inf we interpret transmissivity t and storativity s as dependent on the flow dimension d which can be calculated according to s s s b 3 d and t k b 3 d s s is the storage term and k the conductivity b is the extent of the aquifer as described in barker 1988 for integer cases of d the following interpretations hold i d 1 b is the square root of the cross section area and t is an integrated quantity like in 2d ii d 2 t and s coincide with the classical meaning of storativity and transmissivity iii d 3 the term b 3 d vanishes and s s s and t k while t and s represent local constant parameter of the domain in the grf model we stick to the definition of t through k for the adaption to a radial dependent quantity representative for the well flow behaviour observed during pumping for constant values of s and t eq 1 is solved by 2 h r t q r 2 d 4 π d t γ d 2 1 s r 2 4 t t here γ s x is the incomplete gamma function abramowitz et al 1972 2 2 log normal conductivity and representative averages for the application part of this study we model the heterogeneous hydraulic conductivity as a spatial random function following a log normal distribution 3 pdf k x μ σ 2 1 x 2 π σ 2 exp ln x μ 2 2 σ 2 the parameters μ and σ 2 are the mean and variance of the underlying normal distribution of ln k n μ σ 2 when considering flow through log normal conductivity representative averages have been determined for particular flow situations by representative hydraulic conductivity we mean a single parameter describing the average behavior of groundwater flow within an aquifer at a given scale and flow condition a detailed review on the subject is eg provided by sánchez vila et al 2006 of particular interest for us are two special cases uniform flow through isotropic stationary media in a d dimensional unbounded domain the effective conductivity which describes a response of a medium to these boundary conditions is commonly described by the effective conductivity of matheron 1967 4 k efu k g exp 1 2 1 d σ 2 with the geometric mean k g exp μ and log conductivity variance σ 2 note that k efu is not fully exact since it actually depends on the correlation function as shown by stepanyants and teodorovich 2003 but provides a reasonable approximation radially convergent flow does not have a unique constant representative value indelman and abramovich 1994 but its asymptotic behaviour is known depending on the assigned boundary condition bc at the well 5 r 0 k well k h k g exp 1 2 σ 2 for constant flux bc k a k g exp 1 2 σ 2 for constant head bc 6 r k efu while constant flux bc at the well are typical for studies considering 2d flow and transmissivity i e well flow at larger scales small scale pumping tests require adoption to 3d flow where a constant head bc is more realistic indelman et al 1996 indelman and dagan 2004 the representative conductivity in the far field refers to that of uniform flow eq 4 given that the flow there is not further impacted by the gradients at the well 2 3 truncated power law tpl variograms 2 3 1 definition and background power law variograms are used in hydrogeology to account for a continuous increase in log conductivity variance with growing domain size which is typical for fractal media 7 γ r c 0 r 2 h for 0 h 1 where r characterizes the two point euclidean distance c 0 describes the intensity of variation and h is the hurst coefficient di federico and neuman 1997 showed that power law variograms γ r can be constructed through a superposition of classic non fractal variograms like the gaussian or exponential variogram functions γ r λ this superposition is done using a weighted integral over the length scales λ 8 γ r 0 γ r λ d λ λ the modes γ r λ are the classical variogram functions at each scale λ with a scale dependent variance of σ 2 λ c λ 2 h such fractal behaviour is typical for fractured geological media neuman and di federico 2003 heße et al 2014 di federico and neuman 1997 used the integral representation in eq 8 to introduce an upper and lower truncation reflecting the upper fine size and lower scales resolution of a real world subsurface system let ℓ u and ℓ l be these upper and lower bounds respectively for the sake of brevity we assume ℓ l 0 in the following consequently the tpl variograms with gaussian γ g and exponential γ e modes were given by di federico and neuman 1997 as follows 9 γ ℓ u g r c ℓ u 2 h 2 h 1 exp r 2 ℓ u 2 r ℓ u 2 h γ 1 h r ℓ u 2 10 γ ℓ u e r c ℓ u 2 h 2 h 1 exp r ℓ u r ℓ u 2 h γ 1 2 h r ℓ u where γ s x is the incomplete gamma function abramowitz et al 1972 here the gaussian variogram is defined according to the auto correlation function ρ g r exp r 2 λ 2 and the exponential variogram through ρ e r exp r λ 2 3 2 the stable tpl variogram we use the stable model ρ s r wackernagel 2003 to unify and simplify the given tpl variograms a joint generalization of the gaussian and exponential auto correlation function is provided by 11 ρ s r exp r λ α for 0 α 2 the roughness parameter 0 α 2 covers the transition from the uncorrelated nugget model α 0 the rough exponential model α 1 up to the smooth gaussian model α 2 applying the stable model as modes of the tpl variogram in eq 8 results in the auto correlation function of the stable tpl model 12 ρ ℓ u s r 2 h α e 1 2 h α r ℓ u α where e z is the exponential integral function abramowitz et al 1972 the resulting stable tpl variogram is given by 13 γ ℓ u s r σ ℓ u 2 1 2 h α e 1 2 h α r ℓ u α with variance σ ℓ u 2 c ℓ u 2 h 2 h the stable variogram 13 results in the truncated gaussian eq 9 for α 2 and in the truncated exponential eq 10 for α 1 in order for the tpl variogram 13 to converge to a power law as in eq 7 it has to provide a finite limit for the case of ℓ u di federico and neuman 1997 thus the hurst coefficient has to meet the condition 14 0 h α 2 the hurst coefficient ultimately controls the roughness of the corresponding field since it determines the slope of the variogram at the origin the tpl model is thereby able to reproduce the same spectrum of variograms as the matérn model wackernagel 2003 which is outlined in detail in the si 3 results 3 1 the extended generalized radial flow model 3 1 1 derivation we extend the grf model to account for radially dependent transmissivity t r and storativity s r making use of a step function approximation note that the radial dependency is not assumed for the underlying aquifer characteristics but relate to the way a pumping test filters transmissivity and storativity thus t r and s r reflect upscaled quantities not the local ones a similar procedure was presented by avci and sahin 2014 for a fixed number of concentric zones in 2d which in turn was build on the findings of butler 1988 the characteristic differential equation of the egrf as extension of eq 1 reads 15 1 r n 1 r r n 1 t r h r s r h t we treat transmissivity and storativity as radial symmetric step functions 16 t r t 0 r r 0 t n r r n s r s 0 r r 0 s n r r n with t and s being constant on concentric circles around the point of origin given by r i r i r i 1 with r 0 r w and r n 1 r inf adapting a continuous radially dependent transmissivity as derived for the tpl structure later eq 22 to the radially symmetric step functions is achieved by making use of the harmonic average over each ring r i the harmonic mean of a radial symmetric function f r over a concentric segment r x r d r 0 x r 1 in d dimensions is given by 17 f r h d r 1 d r 0 d r 0 r 1 r d 1 f r 1 d r 1 more details on the radial harmonic mean is given in the si examples of the function approximations for a radially dependent transmissivity t r are displayed in fig 1 for two forms of an effective conductivity with different underlying variograms the hydraulic head as solution of eqs 15 with 16 is a piece wise function h i h r i which has to fulfil conditions along the ring boundaries for i 0 n 1 18 h i r i 1 t h i 1 r i 1 t 19 t i t i 1 h i r r i 1 t h i 1 r r i 1 t the first equation is a continuity condition and the second one ensures mass conservation to the best of our knowledge no analytical solution of the hydraulic head h r t of eq 15 exists instead we apply the laplace transformation to derive an equation system which can be solved by applying a penta diagonal matrix solver as presented by askar and karawia 2015 and implemented by müller 2019 2020b the result is then transformed back into the time domain by the algorithm of stehfest 1970 a detailed derivation including the full set of equations is provided in the si the whole workflow is implemented and made available as an open source python package named anaflow müller 2020a 3 1 2 application of egrf the egrf can be applied to arbitrary radial conductivity functions k r reflecting the averaging effect of pumping tests on conductivity examples are the extended theis solution in 2d and 3d of zech et al 2016 derived from the effective representations found in schneider and attinger 2008 zech et al 2012 the apparent transmissivity of neuman et al 2004 as well as the transmissivity for a concentric zone aquifer of avci and sahin 2014 which is an extension to the two zone aquifer described by butler 1988 a visualization is provided in fig 2 a shows the solution of barker 1988 for a finite domain b represents the solution of butler 1988 incorporating a separate transmissivity at the well c coincides with the finding of avci and sahin 2014 for a finite domain d is the transient solution for the apparent transmissivity presented by neuman et al 2004 e shows the effective solution for transient pumping test in heterogeneous aquifers following a gaussian variogram derived by schneider and attinger 2008 which is in line with the derivations of zech et al 2016 f is an extension of e incorporating anisotropy in 3d zech et al 2012 under the dupuit forchheimer assumption to solve the depth averaged groundwater flow equation in 2d the results match the calculations of zech et al 2016 all solutions share the same far field behavior meaning the fluctuations near the pumping well do not influence the drawdown at a sufficient distance the solutions d and e behave very similar which confirms that these two approaches to characterize effective drawdowns in heterogeneous media result in almost the same type curves the solution shown in e was used by müller et al 2021 to identify parameters of aquifer heterogeneity from actual pumping test observations 3 2 upscaling of tpl conductivity with coarse graining 3 2 1 effective conductivity for uniform groundwater flow we determine the effective conductivity for a log normal conductivity with tpl variogram for uniform flow considering a finite filter length in the upscaling process the coarse graining method provides a framework to analyze the groundwater flow through random conductivity fields for filtering up to a length scale λ following the lines of attinger 2003 we focus on the gaussian case of stable tpl setting α 2 in eq 13 this choice can be justified by the often reported insensitivity of groundwater flow to the roughness of the conductivity field riva and willmann 2009 heße et al 2015 and that roughness is not solely controlled by α but also h a detailed explanation and derivation is provided in the si the scale dependent mean conductivity for uniform flow at the filter scale λ is given by 20 k tpl uni λ k g exp σ u 2 2 σ u 2 d 1 1 λ 2 ℓ u 2 d 2 ϕ d h λ 2 ℓ u 21 ϕ d h z 2 h d 2 h 2 f 1 d 2 1 d 2 h 1 1 1 z 2 1 z 0 2 h d 2 h z where k g is the geometric mean σ u 2 is the log conductivity variance d denotes the dimension h is the hurst coefficient ℓ u is the upper truncation length and 2 f 1 is the ordinary hyper geometric function abramowitz et al 1972 the result for the mean value of log normal conductivity with a tpl variogram when filtering under uniform flow conditions eq 20 is an extension of the findings of attinger 2003 which focused on a gaussian variogram the difference is solely expressed in the correction factor ϕ d h eq 21 which incorporates the effect of the hurst coefficient h 3 2 2 effective conductivity for radially convergent flow we apply the upscaling procedure radial coarse graining to determine the effective mean conductivity for a well flow setting note that this effective mean conductivity is neither the equivalent nor the apparent quantity according to the classification given in sánchez vila et al 2006 but is a quantity reproducing observed well flow when solving the flow equation with it following schneider and attinger 2008 and zech and attinger 2016 we adapt the coarse graining procedure to radially convergent flow by substituting the filter length scale λ with the distance to the well r having a variable filter length r instead of a constant represents the non uniform averaging behaviour of flow during pumping the distance dependent effective conductivity for well flow reads 22 k tpl r k efu exp χ 1 ξ r ℓ u 2 d 2 ϕ d h ξ r ℓ u here k efu denotes the dimension dependent effective conductivity for uniform flow eq 4 representative for flow far from the pumping well χ is a short notation for the ratio χ ln k well k efu where k well is the effective conductivity at the pumping well depending on the boundary condition eq 5 it simplifies to χ h ln k h k efu 1 d 1 σ u 2 and χ a ln k a k efu σ u 2 d respectively ξ is a proportionality factor determined as ξ 2 by zech et al 2012 ϕ d h z is defined in eq 21 k tpl r in eq 22 is based on the assumption of isotropy however it can be easily extended to a solution in d 3 dimensions with vertical anisotropy following the lines of zech et al 2015a the specific solution is provided in the si the radially symmetric effective conductivity k tpl r represents the way a pumping test radially filters the non symmetric heterogeneity of the underlying regular log normal field eq 3 with tpl variogram eq 7 fig 3 shows the shape of the effective conductivity as function of the dimensionless ratio of radial distance to correlation scale ℓ u it displays the transition between the two representative conductivities for well flow k efu in the far field dimension dependent and k h at the well assuming the constant flux bc here the specifics of this transition are a function of the correlation structure and its defining parameters the effective conductivity k tpl r is in line with effective representations of conductivity for well tests such as of neuman et al 2004 schneider and attinger 2008 zech et al 2012 zech et al 2015a zech and attinger 2016 zech et al 2016 they all provide effective transmissivity or conductivity distributions that act as a transition between the harmonic mean at the pumping well and the effective far field value 3 2 3 effective head solution for tpl variograms the representative mean hydraulic head for a pumping test results from solving the groundwater flow equation in radial coordinates eq 15 with k tpl r along the lines of zech et al 2012 2016 a closed form analytical expression cannot be determined instead we provide semi analytical type curves making use of the egrf section 3 1 we solve the flow equation with the egrf inserting the effective tpl conductivity eq 22 for t r the resulting effective head drawdown h tpl r t can be interpreted as an average behaviour representing the well flow through a heterogeneous aquifers with a log normal conductivity distribution following a tpl variogram a visual impression is provided in fig 4 for a certain choice of aquifer statistical parameters head values have been determined numerically making use of anaflow 3 3 proof of concept with monte carlo simulations we performed numerical pumping tests simulations in random conductivity as virtual measurements to demonstrate the viability of our method the average pumping test drawdown h ens r t for an ensemble of log normal transmissivity fields with a tpl variogram provides the representative behaviour of well flow in heterogeneous aquifers the ensemble average drawdown h ens r t is independent from the semi analytical upscaling results h tpl r t we compare both results to prove the validity of h tpl r t as semi analytical generalization of effective pumping test behaviour first we generate ensembles of 1000 log normal random transmissivity fields eq 3 with a tpl variogram eq 9 using the python package gstools müller and schüler 2020 heße et al 2014 one realization is shown in fig 5 we cover various parameter combinations with variances of σ 2 1 and 2 25 upper length scale of correlation ℓ 10 m and 20 m and hurst coefficient h 0 5 and 0 9 pumping tests are simulated using the finite element software opengeosys through the python api ogs5py müller et al 2020 we use a process adapted 2d radially symmetric numerical mesh it has a diameter of 2000 m to avoid boundary effects 64 angular subdivisions and 100 radial units with resolution decreasing with distance to the pumping well we applied a constant flux boundary condition at the well with a constant pumping rate of q w 10 4 m 3 s technical details are further outlined in the si the simulated drawdown of each heterogeneous transmissivity realizations is averaged over the angle to gain a solely radial depending head ensemble means h ens r t for each set of statistical parameters is achieved through averaging over the n 1000 individual numerical pumping tests fig 6 shows the calculated ensemble mean for the parameter set p0 with s 10 4 t g 10 4 m 2 s σ 2 1 0 ℓ 10 m and h 0 5 in comparison to the effective drawdown h tpl r t for the same parameters with a relative error of 2 56 results of all other ensembles are provided in the si along with information about relative errors between ensemble means and effective heads interested readers can generate their own ensemble making use of the provided workflow müller and zech 2021 the agreement of the ensemble mean h ens r t and the effective drawdown h tpl r t in fig 6 the same holds for all other ensembles see si provides evidence that t tpl r represents the effective transmissivity for pumping test in this particular heterogeneous structure thus the average drawdown behaviour of pumping tests can be predicted based on the transmissivity statistics using h tpl r t 4 summary and conclusions we presented the extended general radial flow model egrf which combines the mathematical characterization of well flow in arbitrary fractal dimensions and an effective description of conductivity for pumping tests in heterogeneous log normal fields the non uniform effective conductivity accounts for the radial filtering effect of well flow on aquifer heterogeneity results are implemented in an efficient and stable numerical solver to compute the effective head drawdown from the radial flow equation the egrf extends the advantage of the general radial flow model barker 1988 of non integer dimensions of the flow system to heterogeneous fractal aquifers we show that the egrf acts as general solver for non uniform transmissivity descriptions of pumping tests such as that of butler 1988 neuman et al 2004 avci and sahin 2014 or zech et al 2016 we further derive effective conductivities for uniform flow and for pumping tests in heterogeneous aquifers with a log normal conductivity distribution and a truncated power law tpl correlation structure this conceptualization of the heterogeneity represents fractal aquifers which exhibit structures with more then one length scale we used the upscaling procedure coarse graining to derive effective conductivity descriptions as a function of the tpl heterogeneity input parameters mean log conductivity variance upper correlation scale and hurst coefficient we present an analytical expression for mean conductivity which represent average behaviour under uniform flow conditions at a particular filter length scale results are extended to radial convergent flow conditions leading to an effective upscaled conductivity function depending on the radial distance and aquifer statistics making use of the presented egrf we determine the effective drawdown behaviour i e the hydraulic head as function of radial distance and tpl heterogeneity parameters we show that upscaling results are indeed representing well flow in log normal media with a tpl correlation structure by performing monte carlo flow simulations we generated ensembles of random fields with various parameter combinations and performed numerical pumping tests these independent ensemble simulations are fully in line with the mean drawdown predicted by the tpl effective head from the egrf the presented results lead us to the following conclusions the egrf can be used to calculate pumping test drawdowns for an arbitrary form of upscaled radial transmissivity t r this opens the opportunity to generate type curves for effective transient drawdowns in heterogeneous media well flow in heterogeneous fields with a truncated power law correlation structure can be effectively described in the average with an analytical expression for the conductivity as function of the radial distance to the well and the statistical field parameters the methodology can be used for inverse aquifer characterization comparing observed drawdowns to egrf drawdowns of effective tpl transmissivity allows estimating mean storativity mean transmissivity log transmissivity variance upper correlation scale and hurst coefficient the results presented herein are a sound foundation for verifying the applicability of the method using real data from heterogeneous aquifers we anticipate and plan further studies on e g i the significance of fractal flow dimensions d in interaction with effective transmissivity distributions ii the analysis of actual field pumping tests in fractured media iii analyzing the influence of radial varying storativity while fractals are well established for describing fractured media with its heterogeneities at multiple scales it is still under debate if porous media shows such behaviour at least at the scale of interest here although some authors report on self similar porous media with heterogeneities at increasing scales e g desbarats and bachu 1994 molz et al 2004 neuman et al 2008 many studies build on the miss interpretation of the data reported by gelhar et al 1992 along the universal scaling of macrodispersivity which is actually not supported by reliable field data zech et al 2015b 2018 given that the matter is still debated we leave it to the user if he considers it legitimate to use a fractal model in porous media the presented novel methodology including open source software implementations müller and zech 2021 does not only provide a workflow to describe pumping test in heterogeneous aquifers of arbitrary flow dimension and fractal heterogeneity structure but allows quantifying it thus we can infer fractal heterogeneity characteristics from pumping test drawdowns code availability software packages with solution implementations and scripts for reproducing figures and ensemble simulations are given at geostat examples extended grf model müller and zech 2021 workflow to reproduce results of this paper anaflow müller 2020a implementation of the egrf model the effective solution h tpl and the effective transmissivity t tpl pentapy müller 2019 pentadiagonal matrix solver used for the egrf solution in laplace space gstools müller and schüler 2020 tpl variograms and random field generation credit authorship contribution statement sebastian müller conceptualization methodology software validation formal analysis writing original draft visualization falk heße writing original draft writing review editing sabine attinger supervision alraune zech conceptualization validation writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements sebastian müller was funded by the german federal environmental foundation via grant number 20016 432 the authors are thankful to the editors the anonymous reviewers and aldo fiori for their constructive comments which helped to improve the manuscript supplementary material supplementary material associated with this article can be found in the online version at 10 1016 j advwatres 2021 104027 appendix a supplementary materials supplementary data s1 supplementary raw research data this is open data under the cc by license http creativecommons org licenses by 4 0 supplementary data s1 
244,we conduct numerical simulations to investigate the role of aperture heterogeneity in early stage karstification of a fractured carbonate rock the fracture network is formed by a dominant set of persistent fractures and a secondary set of short fractures that abuts the dominant set the variable aperture distribution priori to dissolution is derived from geomechanical simulation we report that the extent to which aperture distribution affects karstification is jointly controlled by the far field stress orientation flow direction and structural hierarchy when reactive flow occurs in the direction of the dominant fracture set karst conduits only develop locally along a few large discontinuities preferentially oriented for frictional sliding such that differential stress can produce shear dilatancy and enhance hydraulic transmissivity in contrast when reactive flow is along the direction of the secondary fracture set the far field stress loading has a negligible impact on the emergent dissolution pattern except somewhat impact on the onset time of breakthrough in this case the developed conduits exhibit much more tortuous pathways associated with numerous branches our results demonstrate that flow heterogeneity induced by geometrical complexities and geological conditions seems to play an essential role in the karst growth in fractured rocks the research findings provide useful insights into the interplay among tectonic structures in situ stresses and karst cavities which have important implications for underground engineering activities in karstified fractured rocks keywords karstification fracture network aperture heterogeneity stress reactive flow 1 introduction karstified carbonate rocks are highly heterogeneous geological media fluid flow and mass transport in such systems are largely restrained to highly conductive conduits that are formed on the basis of pre existing fracture networks via calcite dissolution the understanding of how karst features initiate and evolve may help infer the spatial and hydraulic properties of major karst conduits which is crucial for many geo engineering applications in carbonate rocks including groundwater remediation dam construction carbon sequestration hydrocarbon production and underground excavation lolcama et al 2002 turkmen et al 2002 romanov et al 2012 wang et al 2017 lei et al 2017a aminnaji et al 2020 feng et al 2020 extensive studies have been done on modeling karst genesis over the past two decades the foundation of karst genesis models dates back to the early laboratory dissolution experiments plummer et al 1978 and the theory of coupled transport and dissolution processes weyl 1958 dreybrodt and buhmann 1991 the earliest mechanistic modeling of karst genesis started from the evolution of single 1 d fractures palmer 1991 dreybrodt 1996 karst genesis simulation was then extended to the scenario of 2 d discrete fracture networks dfns groves and howard 1994a siemers and dreybrodt 1998 kaufmann and braun 2000 within which more complex dissolution dynamics emerge compared to 1 d systems the most prevailing effect is the accelerated breakthrough when aperture heterogeneity is present due to the formation of preferential flow paths hanna and rajaram 1998 bauer et al 2003 gabrovsek et al 2004 szymczak and ladd 2011 szymczak and ladd 2011 also showed that the flow focusing mechanism is more dominant in driving the conduit evolution in 2 d in comparison to the non linear dissolution kinetics which was used as a prerequisite condition for explaining the paradox that the penetration length of dissolution front is very short i e on the order of centimeters but kilometer long limestone caves exist in nature using the 1 d karst genesis model white and longyear 1962 white 1977 such 2 d models that simulate the positive feedback mechanism between dissolution and fluid flow have been used to understand the complex effects of fluctuation of water table kaufmann 2002 matrix conduit flow exchange bauer et al 2003 mixing corrosion gabrovšek and dreybrodt 2000 kaufmann 2003 and realistic recharge boundary condition bauer et al 2005 on the karst aquifer evolution compared to the fruitful discussions on the effect of hydraulic and hydrochemical factors the geological control of the aquifer evolution is much less examined one of the most important aspects is how the structure of aperture arrangement acting as preferential flow paths or flow barriers affects karstification although a few studies have examined the impact of spatial heterogeneity in aperture fields on the formation of wormholes hanna and rajaram 1998 and the development of karst conduits hubinger and birk 2011 the adopted aperture variability model was only based on theoretical statistical laws for instance it is often assumed that the aperture distribution of single fractures hanna and rajaram 1998 or fracture networks hubinger and birk 2011 obeys lognormal distributions although the assumed lognormal aperture distribution may be sufficient for theoretical investigations of physical mechanisms controlling the wormhole formation or conduit network evolution they are far from being representative for actual aperture distribution in natural fracture systems the analysis of subsurface data indicates that the fluid flow in natural fracture systems are often hierarchical distributed among the fracture population fractures that are critically stressed tend to dominate the flow barton et al 1995 odling et al 1999 the hydraulic and transport properties of fractured rocks are strongly dependent on both the fracture geometry e g density length and orientation fracture aperture and in situ stress state e g stress magnitude and ratio zhang and sanderson 1996 rutqvist and stephansson 2003 min et al 2004 baghbanan and jing 2008 lei et al 2017b zhao et al 2011 nick et al 2011 zhao et al 2013 kang et al 2019 heterogeneous fracture aperture distribution often leads to profound flow anisotropy and channelization tsang and neretniek 1998 under in situ conditions the stress may modify the flow organization in the fracture network by altering fracture apertures previous studies have shown that fracture aperture is highly sensitive to normal and shear loadings witherspoon et al 1980 bandis et al 1983 barton et al 1985 pyrak nolte and morris 2000 the stress dependent flow pattern may further affect the transport of chemical components nick et al 2011 kang et al 2019 and alter the macroscopic behavior of water rock interactions martinez landa et al 2012 if the fracture network is isotropically loaded with high stress magnitude fractures tend to close leading to a delayed solute arrival time however if the fracture network is anisotropically stressed early arrival may occur as a result of shear dilation induced preferential flow pathways zhao et al 2011 kang et al 2019 in a recent study we have shown that the fracture network topology plays an important role in controlling early stage karst generation aliouache et al 2019 in the current paper we extend our previous analysis based on 2 d natural fracture networks to investigate the impact of heterogeneous aperture field which is determined jointly by the network topology stress loading configuration and initial aperture variability on the incipient karst formation through numerical modeling of geomechanical deformation fluid flow and dissolution kinetics we adopt a sequential coupling scheme in which geomechanical modeling of fracture aperture distribution is performed first the derived aperture field is then used in the simulation of karst formation we focus on the dissolutional growth of conduits in the early phase of karst formation the process of precipitation is not considered the rest of the paper is organized as follows the methods for constructing the natural fracture network and simulating the geomechanics fluid flow and reactive transport are described in section 2 the numerical model set up and boundary conditions are provided in section 3 the simulation results are presented in section 4 finally a discussion and conclusions are given in section 5 2 methodology 2 1 nature fracture network the fracture network used in our simulations is mapped from an outcrop of triassic limestone beds exposed at klive on the southern margin of bristol channel basin united kingdom belayneh and cosgrove 2004 fig 1 the fracture network is well connected and consists of two major fracture sets the e w striking set is formed by persistent long fractures while the n s striking set includes small joints that abut the e w striking dominant set the emergent ladder pattern represents a typical hierarchical topology of natural joint networks in carbonate rocks pollard and aydin 1988 this fracture network has been extensively used in many previous studies on fluid flow matthäi and belayneh 2004 matthäi et al 2010 lei et al 2017b mass and heat transport geiger and emmanuel 2010 edery et al 2016 kang et al 2019 and reactive transport aliouache et al 2019 in this paper we use this fracture network to investigate the impact of aperture variability on the incipient karst formation 2 2 geomechanically generated heterogeneous aperture field the aperture distribution used in the karst genesis modeling is derived from geomechanical simulations which are based on a hybrid finite discrete element method fdem munjiza 2004 to simulate the deformation of 2 d fracture networks in response to in situ stress conditions in the context of the fdem method an empirical joint constitutive model has been implemented to capture the nonlinear displacement behavior of natural rough fractures in response to mixed normal and shear loadings lei et al 2014 2015 2016 thus the geomechanical model can realistically mimic the deformation of intact rocks variability of local stresses displacement of pre existing fractures and propagation of new fractures lei et al 2017b the compression induced fracture closure is calculated based on a hyperbolic relation bandis et al 1983 1 v n σ n v m k n 0 v m σ n where v n is the normal closure σ n is the effective normal compressive stress k n0 is the initial normal stiffness and v m is the maximum allowable closure values of k n0 and v m are given by bandis et al 1983 2 k n 0 7 15 1 75 jrc 0 02 jcs a 0 3 v m 0 1032 0 0074 jrc 1 1350 jcs a 0 0 2510 where a 0 is the initial aperture mm jrc is the joint roughness coefficient and jcs is the joint compressive strength mpa during the shearing process under a normal compression fractures contract firstly due to the compressibility of asperities and then dilate with roughness damaged and destroyed barton et al 1985 dilational displacement may be related to the shear displacement via an incremental form as olsson and barton 2001 4 d v s tan d mob du where dv s is the increment of normal displacement caused by shear dilation du is the increment of shear displacement and d mob is the mobilized tangential dilation angle given by olsson and barton 2001 5 d mob 1 m jr c mob log 10 jcs σ n where m is a damage coefficient given by barton and choubey 1977 6 m jrc 12 log 10 jcs σ n 0 70 and the mobilized joint roughness coefficient jrcmob can be derived via a dimensionless tabular analysis barton et al 1985 the fracture aperture a under coupled normal and shear loadings is thus given by lei et al 2016 7 a a 0 o σ n 0 a 0 v n v s σ n 0 where o is the separation of opposing fracture walls if the fracture is under tension 2 3 fluid flow and reactive transport the flow and transport processes are simulated using a finite difference method based on a resistor network fig 2 aliouache et al 2019 fluid flow is assumed to occur only on fractures with the fracture matrix interaction omitted the local flow velocity between fracture nodes i and j is calculated using the poiseuille equation for laminar incompressible fluid flow through parallel plates as follows witherspoon et al 1980 8 v i j a i j 3 12 μ h j h j l i j where vij is the flow velocity aij is the fracture aperture hi is the hydraulic head at node i l ij is the fracture segment length and μ is the dynamic viscosity of the fluid we solve flow by imposing the conservation of mass at each node i 9 j a i j v i j w 0 where w is the thickness of the rock block fig 2 when calculating flow a constant hydraulic gradient is created by imposing a high hydraulic head at the inlet boundary and a low hydraulic head at the outlet boundary no flow conditions are prescribed for the remaining two orthogonal boundaries the use of constant head boundary is reasonable as we focus on the initiation stage of karstification where flow rate in the system is smaller than the recharge rate palmer 1991 to examine if non laminar flow occurs which is one of the criteria to terminate the coupled simulation we calculate the reynolds number re for each segment based on the fracture aperture and local velocity the emergence of non laminar flow is defined based on the criterion of re 2100 hanna and rajaram 1998 the transport problem in the fracture network is solved by assuming mass conservation at fracture intersections the flux weighted formula is adopted in deriving the concentration field fig 2 aliouache et al 2019 10 c 0 c 3 δ c 3 0 q 3 0 c 4 δ c 4 0 q 4 0 q 3 0 q 4 0 where q 3 0 and q 4 0 are the corresponding flow rates along the two branches c 3 and c 4 are concentrations at the surrounding nodes that transfer fluids to the central node δc 3 0 and δc 4 0 are the concentration increments when the fluids flowing from nodes 3 and 4 to the central node the concentration increment due to the dissolution of fracture walls can be calculated by 11 δ c r c q δ t where r c is the reaction rate q is the flow rate and δt is the time interval in this study we focus on the dissolutional growth of conduits in the early phase of karst formation the process of precipitation is not considered in the reactive transport calculation we assume a zero concentration of ca2 at the inflow boundary and a non constrained concentration at the outflow boundary 2 4 calcite dissolution once the steady state flow and the transport problems are solved the aperture growth due to calcite dissolution can be calculated from 12 δ a r c q δ t ρ r l where δa is the aperture increase r c is the reaction rate within the segment q is the flow rate δt is the time step l is the segment length and ρr is the density of the rock material the assumption that the dissolved mass is evenly distributed over each single fracture segment is reasonable given the segment length is sufficiently small the calcite dissolution may be constrained by two processes water rock reaction at fracture surfaces and diffusive transport of ca2 from the rock surface to the main flow stream for small fracture apertures the surface reaction is the rate limiting process the reaction rate is expressed by palmer 1991 dreybrodt 1996 13 r c k 1 c eq c where k 1 is the reaction kinetics c eq is the concentration at saturation and c is the concentration of ca2 when fracture aperture is sufficiently enlarged the dissolution rate is limited by diffusion in such a condition the reaction rate is given by incropera and dewitt 1990 14 r c d sh a c eq c where d is the molecular diffusion coefficient for ca2 in water a is the fracture aperture and sh is the sherwood coefficient the concentration for a segment is approximated by the mean of the concentrations of inlet and outlet nodes 3 numerical model set up we assume that the initial aperture field of the fracture network before conducting geomechanical simulations follows a lognormal distribution with a mean value of 1 mm and a variance of 0 i e constant initial aperture scenario or 1 i e variable initial aperture scenario the use of lognormal aperture distribution is justified by many field observations long and billaux 1987 cacas et al 1990 bonnet et al 2001 in the variable initial aperture case lognormally distributed aperture values are assigned randomly to fracture segments in the fdem model the complex correlation between aperture and other geometric properties such as fracture length or orientation is not considered in the initial aperture field however spatially correlated and hierarchically organized aperture structures may emerge during the geomechanical simulations we apply effective far field stresses orthogonally to the domain and consider two different stress conditions i s x 5 0 mpa s y 15 0 mpa and ii s x 15 0 mpa s y 5 0 mpa for the variable aperture case average behaviors were derived based on simulations runs performed in ten realizations of random aperture distributions for each stress loading configuration the geomechanically derived fracture aperture distributions are then used to simulate karst genesis the coupling of flow transport and dissolution is based on a quasi stationary approximation hanna and rajaram 1998 dreybrodt and gabrovšek 2018 the steady state flow mass transport and reaction equations are solved iteratively over each dissolution time step the aperture growth is computed based on the reaction rate of individual fracture segments the dissolved mass is assumed to evenly distributed over a single segment the iterative process is stopped when either breakthrough or non laminar flow occurs we consider reactive flow in both x and y directions which correspond to the directions of the e w and n s striking fracture sets respectively when solving flow and transport problems fractures are discretized into small segments with a maximum length of 0 1 m due to the variable length of natural fractures applying an exactly uniform discretization is not possible we thus calculate the number of segments through dividing the length of each individual fracture by a pre defined average segment length of 0 05 m fractures within the first 0 1 m from the inlet are meshed with a smaller segment length of 0 01 m to avoid the potential issue of numerical saturation groves and howard 1994b upadhyay et al 2015 aliouache et al 2019 furthermore a sufficiently small time step of δt 0 01 year is adopted to make the breakthrough time comparable among cases with different aperture distributions we fix the initial flow rate at 5 10 7 m2 s for all cases by adjusting the hydraulic gradient across the fracture network in the current study we assume the fracture surface dissolution plays a dominant role in the karst genesis process while the pressure solution effect is omitted ishibashi et al 2013 the fluid and rock properties used in the simulations are assumed as follows the density of limestone is 2700 kg m3 the young s modulus is 30 0 gpa the poisson s ratio is 0 27 the internal friction coefficient is 0 6 the tensile strength is 4 0 mpa the cohesive strength is 8 0 mpa the mode i and ii energy release rates are 20 0 and 100 0 j m2 respectively the residual friction coefficient is 0 6 the joint roughness coefficient jrc equals to 15 and the joint compressive strength jcs equals to 120 mpa furthermore the molecular diffusion coefficient for ca2 is 6 73 10 10 m2 s dreybrodt 1990 the sherwood number for laminar flow is 8 szymczak and ladd 2011 the ca2 equilibrium concentration is 2 mol m3 dreybrodt 1996 4 results we present the modeling results of incipient karst generation in natural fracture networks with different stress dependent aperture distributions we first show the case with a constant initial aperture field and then the case with a variable initial aperture field the mean of initial aperture for both cases is identical and equals to 1 mm 4 1 constant initial aperture case we show the spatial aperture fields of the fracture networks under different in situ stress conditions before dissolution occurs see the upper panel of fig 3 here fracture apertures are normalized by the mean aperture of the fracture network under zero stress loading i e 1 mm when s x 5 mpa and s y 15 mpa there is a global reduction in aperture distribution of the fracture network and the resulting apertures are fairly uniform in contrast when s x 15 mpa and s y 5 mpa several e w striking through going fractures exhibit enhanced openings due to the shear dilation effect the evolved aperture fields at the breakthrough time for reactive flow along the x and y directions are shown in the middle and lower panels of fig 3 respectively when reactive flow occurs in the x direction two main conduit networks develop toward the outlet for the no stress case the conduit networks fan out at the downstream side due to the effect of imposed constant head boundary for the two anisotropic stress loading cases only one conduit pathway develops although the shape of the evolved conduit structure differs in the two cases the conduit pattern of the case with s x 5 mpa and s y 15 mpa resembles that of the conduit network developed in the lower model area in the no stress case while the extent of the developed conduit network is much larger under the stress condition of s x 15 mpa and s y 5 mpa where multiple conduits are also developed close to the inlet i e the left boundary in this case the location of the developed conduits match that of the shear induced preferential path with large openings when reactive flow occurs in the y direction if no stress is applied multiple conduit networks develop in the middle of the model domain and the one with larger lateral extent reaches the outlet the fan out feature at the outlet is also manifest when s x 5 mpa and s y 15 mpa the geometry of the most developed conduit network is similar to that in the no stress case with only slight differences observed in the downstream side the extent of other developed conduit networks is much smaller compared to those appearing at similar locations in the no stress case we observe a much larger extent of highly dissolved fractures in the stress case of s x 15 mpa and s y 5 mpa particularly near the outlet due to the presence of the curved long fractures in the transverse direction that have undergone significant shear dilations however the trajectory of the most developed conduits in the three stress cases is rather similar in the upstream region we further analyze the evolutionary behavior of aperture fields under different in situ stresses by plotting aperture pdfs fig 4 when reactive flow occurs in the x direction the two stress cases exhibit very different pdf evolutions when s x 5 mpa and s y 15 mpa the pdf at the intermediate growth step i e half of the total simulation steps has some spread compared to the initial state with a few large aperture values at the breakthrough the aperture pdf becomes even broader and a short plateau emerges the largest aperture value increases to more than 30 mm when s x 15 mpa and s y 5 mpa the pdf is still centered around the initial mean at the intermediate step however the spread of the pdf is more profound for aperture values within the interval between the peak and 10 mm moreover there are no isolated large range values at the breakthrough the pdf is more stretched towards large values and the plateau feature is more evident however when reactive flow occurs in the y direction the evolutionary behavior of the aperture pdf for the two stress cases is rather similar at the breakthrough the aperture pdfs also exhibit a similar shape despite the right peak is more prominent in the case of s x 15 mpa and s y 5 mpa due to the shear dilation effect fig 5 presents the velocity fields at the initial and breakthrough times for different stress cases if reactive flow occurs along the x direction the initial flow field is quite homogeneous under no stress loading fig 5a the flow field is still fairly homogeneous when s x 5 mpa and s y 15 mpa however the flow magnitude is reduced due to compression induced aperture closure fig 5b when s x 15 mpa and s y 5 mpa flow channelization with highly correlated velocities emerges due to shear induced dilations along two curved long fractures that are preferentially oriented to the maximum principal stress fig 5c at the breakthrough flow channelization occurs in all cases as a result of dissolution which creates main flow paths connecting the inlet and outlet figs 5d 5e and 5f for the no stress case fig 5d and the case of s x 5 mpa and s y 15 mpa fig 5e no obvious correlation between the flow fields before dissolution and at the breakthrough time can be found while for the stress case of s x 15 mpa and s y 5 mpa fig 5f the emergent high flow paths at breakthrough clearly correlate to the channelized flow structure before dissolution when reactive flow occurs along the y direction a different flow evolution behavior is observed at the initial time the flow fields are similar among the three stress conditions fig 5g i the flow field of the case of s x 5 mpa and s y 15 mpa has a slightly higher heterogeneity fig 5h at the breakthrough time the emergent flow structures for the no stress case fig 5g and the case of s x 5 mpa and s y 15 mpa fig 5k are similar while the flow paths are only slightly different in the downstream side in the case of s x 15 mpa and s y 5 mpa fig 5l due to the presence of the highly dilated fractures that promote the lateral spreading of the dissolution in all the cases the location of emergent main flow paths tends to match the location of channels with high initial flow velocities we further analyze the interactive impacts of in situ stress and network geometry on karst generation with the evolution of the breakthrough curves as show in fig 6 when the reactive flow occurs in the x direction the breakthrough time is quite different for different stress loadings the breakthrough onsets several tens of years earlier in the case of s x 15 mpa and s y 5 mpa than the no stress case in contrast in the case of s x 5 mpa and s y 15 mpa breakthrough occurs several tens of years later fig 6 if the reactive flow is along the y direction the breakthrough of the two nonzero stress cases occurs at a similar time i e 28 years for the studied examples which is later than that of the zero stress case 4 2 variable initial aperture case the normalized spatial distributions of fracture apertures for the variable initial aperture case following a lognormal distribution with a mean of 1 mm and a variance of 1 under different stress loadings are shown in fig 7 top panel the high variability of the initial aperture field tends to obscure the stress induced aperture changes compared to the constant initial aperture case the preferential paths with correlated apertures are difficult to be visually observed even for the anisotropic stress scenario a quantitative comparison of the aperture pdfs shows only a mild difference between the various stress cases the pdf is slightly more stretched towards higher aperture values when s x 15 mpa and s y 5 mpa since the shear dilation induced aperture increase is compromised by the compression induced closure the evolved aperture fields at the breakthrough time for reactive flow along the x and y directions are shown in the middle and lower panels of fig 7 respectively the corresponding pdfs are plotted in fig 8 when reactive flow occurs in the x direction only one conduit network develops in the case of zero stress loading which is different from the constant initial aperture case figs 3 and 7 the anisotropic stress loading conditions lead to an alternation in the location of main karst conduits that favor enhanced dissolution comparing to the zero stress case fig 7 middle panel the stress effect is also evident from the aperture pdfs fig 8 which are more stretched toward large values in the case of s x 15 mpa and s y 5 mpa due to the faster dissolution accommodated by dilated fractures fig 8 lower panel when reactive flow occurs in the y direction and no stress loading is applied the location of the most developed conduit network near the inlet is similar to the respective case with a constant initial aperture but becomes different close to the outlet figs 3 and 7 for the two anisotropic stress cases the developed conduit networks are very tortuous and located in different areas of the model domain it seems that more intermediate apertures e g 5 20 mm develop in the case of s x 15 mpa and s y 5 mpa while larger apertures e g 20 mm emerge in the case of s x 5 mpa and s y 15 mpa fig 8 lower panel the flow fields under various stress conditions at the initial and breakthrough times of the reactive transport simulation are shown in fig 9 when reactive flow occurs in the x direction a very heterogeneous flow pattern emerges under zero stress loading due to the presence of initial aperture variability fig 9a the anisotropic stress loading of s x 5 mpa and s y 15 mpa decreases flow magnitude but increases velocity correlation fig 9b a highly heterogeneous flow field characterized by profound flow channelization occurs in the network when s x 15 mpa and s y 5 mpa fig 9c in general the developed flow conduits primarily correspond to the portion of the fracture network that shows correlated spatial flow organization fig 9d f when reactive flow occurs in the y direction the initial flow field under no stress loading is also more heterogeneous compared to that of the corresponding constant initial aperture case figs 5g and 9g the application of anisotropic stress loading leads to a higher flow heterogeneity and a stronger correlation of large velocities fig 9h and i in the evolved conduit networks the location of the high velocity paths seems to match well to the initially correlated high velocity regions fig 9g k and l moreover the difference in location of the most developed conduit network in the variable initial aperture case from the network geometry regularized conduit locations as in the constant initial aperture case indicates that the interplay among fracture network aperture variability and in situ stress strongly impacts karst genesis the impact of stress loading on karst genesis is further analyzed based on the breakthrough curves the error plot is used to show the mean and range of breakthrough time based on the simulations in ten random initial aperture distributions for each stress scenario fig 10 when the reactive flow occurs in the x direction the anisotropic stress loading with s x 15 mpa and s y 5 mpa may lead to an earlier breakthrough compared to the case of no stress loading fig 10 due to the presence of dilated fractures fig 9 in contrast the mean breakthrough time of the stress case of s x 5 mpa and s y 15 mpa is similar compared to that of the no stress case while the value range of the former is much larger when the reactive flow is along the y direction the breakthrough time for all stress scenarios is much shorter comparing to that of x direction flow cases fig 10 the breakthrough on average occurs later in the no stress case and the case of s x 5 mpa and s y 15 mpa compared to that of the case with s x 15 mpa and s y 5 mpa although the difference is quite small only a few years overall the difference in breakthrough time among different stress loading cases is much smaller comparing to respective x direction flow cases which is similar to what we observe for the constant initial aperture case 5 discussion and conclusions in this paper we investigated the impact of fracture aperture heterogeneity on early stage karst formation in natural fracture networks we observed that the geomechanically derived aperture structure causes flow channelization in the fracture network and accelerates the breakthrough of the dissolution front this is consistent with previous research findings about the impact of flow organization on the dissolutional growth in 2 d single fractures hanna and rajaram 1998 szymczak and ladd 2011 our results further show that the interplay among fracture network geometry initial aperture variability and geomechanical loading condition controls the dissolution process in 2 d natural fracture networks the impact of heterogeneous aperture structure induced by stress loadings on incipient karst formation appears secondary and is dependent essentially on the relative orientation between the reactive flow direction and the dominant persistent fractures the first order influence by fracture network geometry on early time karstification has already been pointed out by aliouache et al 2019 here we further show that when the aperture variability is present due to stress loading fundamental changes in the dissolution patterns may occur regulated by distinctive spatial fracture organizations however the breakthrough dynamics is more strongly affected in cases where the maximum principal stress is parallel to the persistent fractures i e when the studied natural fracture network is loaded with s x 15 mpa and s y 5 mpa in contrast the aperture variability alone or with stress loading of s x 5 mpa and s y 15 mpa does not exert significant impacts on the breakthrough when the same initial flow rate is applied the breakthrough time of cases where the mean flow is perpendicular to the persistent fracture set appear to be not sensitive to stress loading conditions with or without initial aperture variability this again emphasizes the dominant role of geological control under specific configurations of structural and mean flow directions the results may have important implication for various subsurface engineering applications in fractured carbonate rocks such as aquifer remediation and dam construction in the present study we focus on investigating the influence of aperture heterogeneity induced by in situ stresses the coupling of stress and pore pressure are not considered the results are only applicable to the situation where pore pressure in fractures is much less than the imposed geomechanical stresses thus are only valid for near surface karst formations the proposed reactive transport model based on realistic fracture networks will be further extended to account for fully coupled stress flow dissolution processes such as the effect of mechanical evolution on karstification to investigate the spatial relationship between tectonic structures and karst cavities under complex in situ stress conditions the 2 d analysis conducted in this work may be extended to 3 d in the future where different behavior of stress dependent karst genesis may be anticipated for example when the shear deformation is dominant in 3 d fractured rocks preferential fluid flow tends to occur along the direction perpendicular to the shear because the aperture correlation is more persistent along the direction normal to sliding yeo et al 1998 mallikamas and rajaram 2005 nemoto et al 2009 future work will also explore more complex scenarios such as other anisotropic fracture patterns with variable fracture orientations lei et al 2014 correlation between fracture lengths and initial apertures renshaw and park 1997 olson 2003 variable in situ stress conditions hudson and harrison 1992 and fracture matrix flow exchange effects bauer et al 2003 kaufmann et al 2010 in summary we report that the stress dependent aperture heterogeneity may play a critical role in the early stage karstification processes in fractured carbonate the extent of the stress impact depends on the relative relationship between flow and structural anisotropies as well as aperture variability when the reactive flow direction is aligned with the set of persistent fractures stress loading direction may alter the dissolution pattern significantly and reduce the karstification extent in contrast when the reactive flow direction is along the set of short fractures the evolved karst patterns are insensitive to stress loading aperture variability may enhance the stress effects in both flow conditions such that more profound effects are observed when the maximum stress is oriented normal to the long fractures our results highlight the critical importance of incorporating realistic fracture network geometry and stress dependent fracture aperture in karst genesis modeling the conventional approaches that neglect the effects of network geometry and in situ stress state may lead to biased prediction of karst pattern and breakthrough time our simulations have been restricted to two dimensional scenarios the overall trend of the observed dissolutional growth behavior may remain valid in 3d networks formed by a simple extrusion of the 2d networks in the third dimension this is because the bulk geomechanical response of the quasi 3d fracture network will not change qualitatively however the evolution behavior of the dissolutional front might be more complex in the quasi 3d network as a result the breakthrough behavior may be quite different from the 2d results if a 3d multi layer joint network is considered it is anticipated that a very different dissolutional growth pattern may occur as the network topology differs significantly in this situation 3d geomechanical modeling is needed to derive the intricate aperture distribution in 3d fracture networks the coupled stress flow dissolution analysis would also help improve engineering design and construction by more accurately forecasting karst conduits ubiquitously existing in fractured carbonate rocks credit authorship contribution statement xiaoguang wang conceptualization methodology writing original draft mohammed aliouache investigation formal analysis visualization yanyong wang conceptualization writing review editing qinghua lei methodology software validation herve jourde writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments x w and y w are grateful for the support from national key research and development program of china grant no 2020yfc1808300 and national natural science foundation of china grant no 42102300 q l is grateful for the support from the swiss national science foundation grant no 189882 and the national natural science foundation of china grant no 41961134032 
244,we conduct numerical simulations to investigate the role of aperture heterogeneity in early stage karstification of a fractured carbonate rock the fracture network is formed by a dominant set of persistent fractures and a secondary set of short fractures that abuts the dominant set the variable aperture distribution priori to dissolution is derived from geomechanical simulation we report that the extent to which aperture distribution affects karstification is jointly controlled by the far field stress orientation flow direction and structural hierarchy when reactive flow occurs in the direction of the dominant fracture set karst conduits only develop locally along a few large discontinuities preferentially oriented for frictional sliding such that differential stress can produce shear dilatancy and enhance hydraulic transmissivity in contrast when reactive flow is along the direction of the secondary fracture set the far field stress loading has a negligible impact on the emergent dissolution pattern except somewhat impact on the onset time of breakthrough in this case the developed conduits exhibit much more tortuous pathways associated with numerous branches our results demonstrate that flow heterogeneity induced by geometrical complexities and geological conditions seems to play an essential role in the karst growth in fractured rocks the research findings provide useful insights into the interplay among tectonic structures in situ stresses and karst cavities which have important implications for underground engineering activities in karstified fractured rocks keywords karstification fracture network aperture heterogeneity stress reactive flow 1 introduction karstified carbonate rocks are highly heterogeneous geological media fluid flow and mass transport in such systems are largely restrained to highly conductive conduits that are formed on the basis of pre existing fracture networks via calcite dissolution the understanding of how karst features initiate and evolve may help infer the spatial and hydraulic properties of major karst conduits which is crucial for many geo engineering applications in carbonate rocks including groundwater remediation dam construction carbon sequestration hydrocarbon production and underground excavation lolcama et al 2002 turkmen et al 2002 romanov et al 2012 wang et al 2017 lei et al 2017a aminnaji et al 2020 feng et al 2020 extensive studies have been done on modeling karst genesis over the past two decades the foundation of karst genesis models dates back to the early laboratory dissolution experiments plummer et al 1978 and the theory of coupled transport and dissolution processes weyl 1958 dreybrodt and buhmann 1991 the earliest mechanistic modeling of karst genesis started from the evolution of single 1 d fractures palmer 1991 dreybrodt 1996 karst genesis simulation was then extended to the scenario of 2 d discrete fracture networks dfns groves and howard 1994a siemers and dreybrodt 1998 kaufmann and braun 2000 within which more complex dissolution dynamics emerge compared to 1 d systems the most prevailing effect is the accelerated breakthrough when aperture heterogeneity is present due to the formation of preferential flow paths hanna and rajaram 1998 bauer et al 2003 gabrovsek et al 2004 szymczak and ladd 2011 szymczak and ladd 2011 also showed that the flow focusing mechanism is more dominant in driving the conduit evolution in 2 d in comparison to the non linear dissolution kinetics which was used as a prerequisite condition for explaining the paradox that the penetration length of dissolution front is very short i e on the order of centimeters but kilometer long limestone caves exist in nature using the 1 d karst genesis model white and longyear 1962 white 1977 such 2 d models that simulate the positive feedback mechanism between dissolution and fluid flow have been used to understand the complex effects of fluctuation of water table kaufmann 2002 matrix conduit flow exchange bauer et al 2003 mixing corrosion gabrovšek and dreybrodt 2000 kaufmann 2003 and realistic recharge boundary condition bauer et al 2005 on the karst aquifer evolution compared to the fruitful discussions on the effect of hydraulic and hydrochemical factors the geological control of the aquifer evolution is much less examined one of the most important aspects is how the structure of aperture arrangement acting as preferential flow paths or flow barriers affects karstification although a few studies have examined the impact of spatial heterogeneity in aperture fields on the formation of wormholes hanna and rajaram 1998 and the development of karst conduits hubinger and birk 2011 the adopted aperture variability model was only based on theoretical statistical laws for instance it is often assumed that the aperture distribution of single fractures hanna and rajaram 1998 or fracture networks hubinger and birk 2011 obeys lognormal distributions although the assumed lognormal aperture distribution may be sufficient for theoretical investigations of physical mechanisms controlling the wormhole formation or conduit network evolution they are far from being representative for actual aperture distribution in natural fracture systems the analysis of subsurface data indicates that the fluid flow in natural fracture systems are often hierarchical distributed among the fracture population fractures that are critically stressed tend to dominate the flow barton et al 1995 odling et al 1999 the hydraulic and transport properties of fractured rocks are strongly dependent on both the fracture geometry e g density length and orientation fracture aperture and in situ stress state e g stress magnitude and ratio zhang and sanderson 1996 rutqvist and stephansson 2003 min et al 2004 baghbanan and jing 2008 lei et al 2017b zhao et al 2011 nick et al 2011 zhao et al 2013 kang et al 2019 heterogeneous fracture aperture distribution often leads to profound flow anisotropy and channelization tsang and neretniek 1998 under in situ conditions the stress may modify the flow organization in the fracture network by altering fracture apertures previous studies have shown that fracture aperture is highly sensitive to normal and shear loadings witherspoon et al 1980 bandis et al 1983 barton et al 1985 pyrak nolte and morris 2000 the stress dependent flow pattern may further affect the transport of chemical components nick et al 2011 kang et al 2019 and alter the macroscopic behavior of water rock interactions martinez landa et al 2012 if the fracture network is isotropically loaded with high stress magnitude fractures tend to close leading to a delayed solute arrival time however if the fracture network is anisotropically stressed early arrival may occur as a result of shear dilation induced preferential flow pathways zhao et al 2011 kang et al 2019 in a recent study we have shown that the fracture network topology plays an important role in controlling early stage karst generation aliouache et al 2019 in the current paper we extend our previous analysis based on 2 d natural fracture networks to investigate the impact of heterogeneous aperture field which is determined jointly by the network topology stress loading configuration and initial aperture variability on the incipient karst formation through numerical modeling of geomechanical deformation fluid flow and dissolution kinetics we adopt a sequential coupling scheme in which geomechanical modeling of fracture aperture distribution is performed first the derived aperture field is then used in the simulation of karst formation we focus on the dissolutional growth of conduits in the early phase of karst formation the process of precipitation is not considered the rest of the paper is organized as follows the methods for constructing the natural fracture network and simulating the geomechanics fluid flow and reactive transport are described in section 2 the numerical model set up and boundary conditions are provided in section 3 the simulation results are presented in section 4 finally a discussion and conclusions are given in section 5 2 methodology 2 1 nature fracture network the fracture network used in our simulations is mapped from an outcrop of triassic limestone beds exposed at klive on the southern margin of bristol channel basin united kingdom belayneh and cosgrove 2004 fig 1 the fracture network is well connected and consists of two major fracture sets the e w striking set is formed by persistent long fractures while the n s striking set includes small joints that abut the e w striking dominant set the emergent ladder pattern represents a typical hierarchical topology of natural joint networks in carbonate rocks pollard and aydin 1988 this fracture network has been extensively used in many previous studies on fluid flow matthäi and belayneh 2004 matthäi et al 2010 lei et al 2017b mass and heat transport geiger and emmanuel 2010 edery et al 2016 kang et al 2019 and reactive transport aliouache et al 2019 in this paper we use this fracture network to investigate the impact of aperture variability on the incipient karst formation 2 2 geomechanically generated heterogeneous aperture field the aperture distribution used in the karst genesis modeling is derived from geomechanical simulations which are based on a hybrid finite discrete element method fdem munjiza 2004 to simulate the deformation of 2 d fracture networks in response to in situ stress conditions in the context of the fdem method an empirical joint constitutive model has been implemented to capture the nonlinear displacement behavior of natural rough fractures in response to mixed normal and shear loadings lei et al 2014 2015 2016 thus the geomechanical model can realistically mimic the deformation of intact rocks variability of local stresses displacement of pre existing fractures and propagation of new fractures lei et al 2017b the compression induced fracture closure is calculated based on a hyperbolic relation bandis et al 1983 1 v n σ n v m k n 0 v m σ n where v n is the normal closure σ n is the effective normal compressive stress k n0 is the initial normal stiffness and v m is the maximum allowable closure values of k n0 and v m are given by bandis et al 1983 2 k n 0 7 15 1 75 jrc 0 02 jcs a 0 3 v m 0 1032 0 0074 jrc 1 1350 jcs a 0 0 2510 where a 0 is the initial aperture mm jrc is the joint roughness coefficient and jcs is the joint compressive strength mpa during the shearing process under a normal compression fractures contract firstly due to the compressibility of asperities and then dilate with roughness damaged and destroyed barton et al 1985 dilational displacement may be related to the shear displacement via an incremental form as olsson and barton 2001 4 d v s tan d mob du where dv s is the increment of normal displacement caused by shear dilation du is the increment of shear displacement and d mob is the mobilized tangential dilation angle given by olsson and barton 2001 5 d mob 1 m jr c mob log 10 jcs σ n where m is a damage coefficient given by barton and choubey 1977 6 m jrc 12 log 10 jcs σ n 0 70 and the mobilized joint roughness coefficient jrcmob can be derived via a dimensionless tabular analysis barton et al 1985 the fracture aperture a under coupled normal and shear loadings is thus given by lei et al 2016 7 a a 0 o σ n 0 a 0 v n v s σ n 0 where o is the separation of opposing fracture walls if the fracture is under tension 2 3 fluid flow and reactive transport the flow and transport processes are simulated using a finite difference method based on a resistor network fig 2 aliouache et al 2019 fluid flow is assumed to occur only on fractures with the fracture matrix interaction omitted the local flow velocity between fracture nodes i and j is calculated using the poiseuille equation for laminar incompressible fluid flow through parallel plates as follows witherspoon et al 1980 8 v i j a i j 3 12 μ h j h j l i j where vij is the flow velocity aij is the fracture aperture hi is the hydraulic head at node i l ij is the fracture segment length and μ is the dynamic viscosity of the fluid we solve flow by imposing the conservation of mass at each node i 9 j a i j v i j w 0 where w is the thickness of the rock block fig 2 when calculating flow a constant hydraulic gradient is created by imposing a high hydraulic head at the inlet boundary and a low hydraulic head at the outlet boundary no flow conditions are prescribed for the remaining two orthogonal boundaries the use of constant head boundary is reasonable as we focus on the initiation stage of karstification where flow rate in the system is smaller than the recharge rate palmer 1991 to examine if non laminar flow occurs which is one of the criteria to terminate the coupled simulation we calculate the reynolds number re for each segment based on the fracture aperture and local velocity the emergence of non laminar flow is defined based on the criterion of re 2100 hanna and rajaram 1998 the transport problem in the fracture network is solved by assuming mass conservation at fracture intersections the flux weighted formula is adopted in deriving the concentration field fig 2 aliouache et al 2019 10 c 0 c 3 δ c 3 0 q 3 0 c 4 δ c 4 0 q 4 0 q 3 0 q 4 0 where q 3 0 and q 4 0 are the corresponding flow rates along the two branches c 3 and c 4 are concentrations at the surrounding nodes that transfer fluids to the central node δc 3 0 and δc 4 0 are the concentration increments when the fluids flowing from nodes 3 and 4 to the central node the concentration increment due to the dissolution of fracture walls can be calculated by 11 δ c r c q δ t where r c is the reaction rate q is the flow rate and δt is the time interval in this study we focus on the dissolutional growth of conduits in the early phase of karst formation the process of precipitation is not considered in the reactive transport calculation we assume a zero concentration of ca2 at the inflow boundary and a non constrained concentration at the outflow boundary 2 4 calcite dissolution once the steady state flow and the transport problems are solved the aperture growth due to calcite dissolution can be calculated from 12 δ a r c q δ t ρ r l where δa is the aperture increase r c is the reaction rate within the segment q is the flow rate δt is the time step l is the segment length and ρr is the density of the rock material the assumption that the dissolved mass is evenly distributed over each single fracture segment is reasonable given the segment length is sufficiently small the calcite dissolution may be constrained by two processes water rock reaction at fracture surfaces and diffusive transport of ca2 from the rock surface to the main flow stream for small fracture apertures the surface reaction is the rate limiting process the reaction rate is expressed by palmer 1991 dreybrodt 1996 13 r c k 1 c eq c where k 1 is the reaction kinetics c eq is the concentration at saturation and c is the concentration of ca2 when fracture aperture is sufficiently enlarged the dissolution rate is limited by diffusion in such a condition the reaction rate is given by incropera and dewitt 1990 14 r c d sh a c eq c where d is the molecular diffusion coefficient for ca2 in water a is the fracture aperture and sh is the sherwood coefficient the concentration for a segment is approximated by the mean of the concentrations of inlet and outlet nodes 3 numerical model set up we assume that the initial aperture field of the fracture network before conducting geomechanical simulations follows a lognormal distribution with a mean value of 1 mm and a variance of 0 i e constant initial aperture scenario or 1 i e variable initial aperture scenario the use of lognormal aperture distribution is justified by many field observations long and billaux 1987 cacas et al 1990 bonnet et al 2001 in the variable initial aperture case lognormally distributed aperture values are assigned randomly to fracture segments in the fdem model the complex correlation between aperture and other geometric properties such as fracture length or orientation is not considered in the initial aperture field however spatially correlated and hierarchically organized aperture structures may emerge during the geomechanical simulations we apply effective far field stresses orthogonally to the domain and consider two different stress conditions i s x 5 0 mpa s y 15 0 mpa and ii s x 15 0 mpa s y 5 0 mpa for the variable aperture case average behaviors were derived based on simulations runs performed in ten realizations of random aperture distributions for each stress loading configuration the geomechanically derived fracture aperture distributions are then used to simulate karst genesis the coupling of flow transport and dissolution is based on a quasi stationary approximation hanna and rajaram 1998 dreybrodt and gabrovšek 2018 the steady state flow mass transport and reaction equations are solved iteratively over each dissolution time step the aperture growth is computed based on the reaction rate of individual fracture segments the dissolved mass is assumed to evenly distributed over a single segment the iterative process is stopped when either breakthrough or non laminar flow occurs we consider reactive flow in both x and y directions which correspond to the directions of the e w and n s striking fracture sets respectively when solving flow and transport problems fractures are discretized into small segments with a maximum length of 0 1 m due to the variable length of natural fractures applying an exactly uniform discretization is not possible we thus calculate the number of segments through dividing the length of each individual fracture by a pre defined average segment length of 0 05 m fractures within the first 0 1 m from the inlet are meshed with a smaller segment length of 0 01 m to avoid the potential issue of numerical saturation groves and howard 1994b upadhyay et al 2015 aliouache et al 2019 furthermore a sufficiently small time step of δt 0 01 year is adopted to make the breakthrough time comparable among cases with different aperture distributions we fix the initial flow rate at 5 10 7 m2 s for all cases by adjusting the hydraulic gradient across the fracture network in the current study we assume the fracture surface dissolution plays a dominant role in the karst genesis process while the pressure solution effect is omitted ishibashi et al 2013 the fluid and rock properties used in the simulations are assumed as follows the density of limestone is 2700 kg m3 the young s modulus is 30 0 gpa the poisson s ratio is 0 27 the internal friction coefficient is 0 6 the tensile strength is 4 0 mpa the cohesive strength is 8 0 mpa the mode i and ii energy release rates are 20 0 and 100 0 j m2 respectively the residual friction coefficient is 0 6 the joint roughness coefficient jrc equals to 15 and the joint compressive strength jcs equals to 120 mpa furthermore the molecular diffusion coefficient for ca2 is 6 73 10 10 m2 s dreybrodt 1990 the sherwood number for laminar flow is 8 szymczak and ladd 2011 the ca2 equilibrium concentration is 2 mol m3 dreybrodt 1996 4 results we present the modeling results of incipient karst generation in natural fracture networks with different stress dependent aperture distributions we first show the case with a constant initial aperture field and then the case with a variable initial aperture field the mean of initial aperture for both cases is identical and equals to 1 mm 4 1 constant initial aperture case we show the spatial aperture fields of the fracture networks under different in situ stress conditions before dissolution occurs see the upper panel of fig 3 here fracture apertures are normalized by the mean aperture of the fracture network under zero stress loading i e 1 mm when s x 5 mpa and s y 15 mpa there is a global reduction in aperture distribution of the fracture network and the resulting apertures are fairly uniform in contrast when s x 15 mpa and s y 5 mpa several e w striking through going fractures exhibit enhanced openings due to the shear dilation effect the evolved aperture fields at the breakthrough time for reactive flow along the x and y directions are shown in the middle and lower panels of fig 3 respectively when reactive flow occurs in the x direction two main conduit networks develop toward the outlet for the no stress case the conduit networks fan out at the downstream side due to the effect of imposed constant head boundary for the two anisotropic stress loading cases only one conduit pathway develops although the shape of the evolved conduit structure differs in the two cases the conduit pattern of the case with s x 5 mpa and s y 15 mpa resembles that of the conduit network developed in the lower model area in the no stress case while the extent of the developed conduit network is much larger under the stress condition of s x 15 mpa and s y 5 mpa where multiple conduits are also developed close to the inlet i e the left boundary in this case the location of the developed conduits match that of the shear induced preferential path with large openings when reactive flow occurs in the y direction if no stress is applied multiple conduit networks develop in the middle of the model domain and the one with larger lateral extent reaches the outlet the fan out feature at the outlet is also manifest when s x 5 mpa and s y 15 mpa the geometry of the most developed conduit network is similar to that in the no stress case with only slight differences observed in the downstream side the extent of other developed conduit networks is much smaller compared to those appearing at similar locations in the no stress case we observe a much larger extent of highly dissolved fractures in the stress case of s x 15 mpa and s y 5 mpa particularly near the outlet due to the presence of the curved long fractures in the transverse direction that have undergone significant shear dilations however the trajectory of the most developed conduits in the three stress cases is rather similar in the upstream region we further analyze the evolutionary behavior of aperture fields under different in situ stresses by plotting aperture pdfs fig 4 when reactive flow occurs in the x direction the two stress cases exhibit very different pdf evolutions when s x 5 mpa and s y 15 mpa the pdf at the intermediate growth step i e half of the total simulation steps has some spread compared to the initial state with a few large aperture values at the breakthrough the aperture pdf becomes even broader and a short plateau emerges the largest aperture value increases to more than 30 mm when s x 15 mpa and s y 5 mpa the pdf is still centered around the initial mean at the intermediate step however the spread of the pdf is more profound for aperture values within the interval between the peak and 10 mm moreover there are no isolated large range values at the breakthrough the pdf is more stretched towards large values and the plateau feature is more evident however when reactive flow occurs in the y direction the evolutionary behavior of the aperture pdf for the two stress cases is rather similar at the breakthrough the aperture pdfs also exhibit a similar shape despite the right peak is more prominent in the case of s x 15 mpa and s y 5 mpa due to the shear dilation effect fig 5 presents the velocity fields at the initial and breakthrough times for different stress cases if reactive flow occurs along the x direction the initial flow field is quite homogeneous under no stress loading fig 5a the flow field is still fairly homogeneous when s x 5 mpa and s y 15 mpa however the flow magnitude is reduced due to compression induced aperture closure fig 5b when s x 15 mpa and s y 5 mpa flow channelization with highly correlated velocities emerges due to shear induced dilations along two curved long fractures that are preferentially oriented to the maximum principal stress fig 5c at the breakthrough flow channelization occurs in all cases as a result of dissolution which creates main flow paths connecting the inlet and outlet figs 5d 5e and 5f for the no stress case fig 5d and the case of s x 5 mpa and s y 15 mpa fig 5e no obvious correlation between the flow fields before dissolution and at the breakthrough time can be found while for the stress case of s x 15 mpa and s y 5 mpa fig 5f the emergent high flow paths at breakthrough clearly correlate to the channelized flow structure before dissolution when reactive flow occurs along the y direction a different flow evolution behavior is observed at the initial time the flow fields are similar among the three stress conditions fig 5g i the flow field of the case of s x 5 mpa and s y 15 mpa has a slightly higher heterogeneity fig 5h at the breakthrough time the emergent flow structures for the no stress case fig 5g and the case of s x 5 mpa and s y 15 mpa fig 5k are similar while the flow paths are only slightly different in the downstream side in the case of s x 15 mpa and s y 5 mpa fig 5l due to the presence of the highly dilated fractures that promote the lateral spreading of the dissolution in all the cases the location of emergent main flow paths tends to match the location of channels with high initial flow velocities we further analyze the interactive impacts of in situ stress and network geometry on karst generation with the evolution of the breakthrough curves as show in fig 6 when the reactive flow occurs in the x direction the breakthrough time is quite different for different stress loadings the breakthrough onsets several tens of years earlier in the case of s x 15 mpa and s y 5 mpa than the no stress case in contrast in the case of s x 5 mpa and s y 15 mpa breakthrough occurs several tens of years later fig 6 if the reactive flow is along the y direction the breakthrough of the two nonzero stress cases occurs at a similar time i e 28 years for the studied examples which is later than that of the zero stress case 4 2 variable initial aperture case the normalized spatial distributions of fracture apertures for the variable initial aperture case following a lognormal distribution with a mean of 1 mm and a variance of 1 under different stress loadings are shown in fig 7 top panel the high variability of the initial aperture field tends to obscure the stress induced aperture changes compared to the constant initial aperture case the preferential paths with correlated apertures are difficult to be visually observed even for the anisotropic stress scenario a quantitative comparison of the aperture pdfs shows only a mild difference between the various stress cases the pdf is slightly more stretched towards higher aperture values when s x 15 mpa and s y 5 mpa since the shear dilation induced aperture increase is compromised by the compression induced closure the evolved aperture fields at the breakthrough time for reactive flow along the x and y directions are shown in the middle and lower panels of fig 7 respectively the corresponding pdfs are plotted in fig 8 when reactive flow occurs in the x direction only one conduit network develops in the case of zero stress loading which is different from the constant initial aperture case figs 3 and 7 the anisotropic stress loading conditions lead to an alternation in the location of main karst conduits that favor enhanced dissolution comparing to the zero stress case fig 7 middle panel the stress effect is also evident from the aperture pdfs fig 8 which are more stretched toward large values in the case of s x 15 mpa and s y 5 mpa due to the faster dissolution accommodated by dilated fractures fig 8 lower panel when reactive flow occurs in the y direction and no stress loading is applied the location of the most developed conduit network near the inlet is similar to the respective case with a constant initial aperture but becomes different close to the outlet figs 3 and 7 for the two anisotropic stress cases the developed conduit networks are very tortuous and located in different areas of the model domain it seems that more intermediate apertures e g 5 20 mm develop in the case of s x 15 mpa and s y 5 mpa while larger apertures e g 20 mm emerge in the case of s x 5 mpa and s y 15 mpa fig 8 lower panel the flow fields under various stress conditions at the initial and breakthrough times of the reactive transport simulation are shown in fig 9 when reactive flow occurs in the x direction a very heterogeneous flow pattern emerges under zero stress loading due to the presence of initial aperture variability fig 9a the anisotropic stress loading of s x 5 mpa and s y 15 mpa decreases flow magnitude but increases velocity correlation fig 9b a highly heterogeneous flow field characterized by profound flow channelization occurs in the network when s x 15 mpa and s y 5 mpa fig 9c in general the developed flow conduits primarily correspond to the portion of the fracture network that shows correlated spatial flow organization fig 9d f when reactive flow occurs in the y direction the initial flow field under no stress loading is also more heterogeneous compared to that of the corresponding constant initial aperture case figs 5g and 9g the application of anisotropic stress loading leads to a higher flow heterogeneity and a stronger correlation of large velocities fig 9h and i in the evolved conduit networks the location of the high velocity paths seems to match well to the initially correlated high velocity regions fig 9g k and l moreover the difference in location of the most developed conduit network in the variable initial aperture case from the network geometry regularized conduit locations as in the constant initial aperture case indicates that the interplay among fracture network aperture variability and in situ stress strongly impacts karst genesis the impact of stress loading on karst genesis is further analyzed based on the breakthrough curves the error plot is used to show the mean and range of breakthrough time based on the simulations in ten random initial aperture distributions for each stress scenario fig 10 when the reactive flow occurs in the x direction the anisotropic stress loading with s x 15 mpa and s y 5 mpa may lead to an earlier breakthrough compared to the case of no stress loading fig 10 due to the presence of dilated fractures fig 9 in contrast the mean breakthrough time of the stress case of s x 5 mpa and s y 15 mpa is similar compared to that of the no stress case while the value range of the former is much larger when the reactive flow is along the y direction the breakthrough time for all stress scenarios is much shorter comparing to that of x direction flow cases fig 10 the breakthrough on average occurs later in the no stress case and the case of s x 5 mpa and s y 15 mpa compared to that of the case with s x 15 mpa and s y 5 mpa although the difference is quite small only a few years overall the difference in breakthrough time among different stress loading cases is much smaller comparing to respective x direction flow cases which is similar to what we observe for the constant initial aperture case 5 discussion and conclusions in this paper we investigated the impact of fracture aperture heterogeneity on early stage karst formation in natural fracture networks we observed that the geomechanically derived aperture structure causes flow channelization in the fracture network and accelerates the breakthrough of the dissolution front this is consistent with previous research findings about the impact of flow organization on the dissolutional growth in 2 d single fractures hanna and rajaram 1998 szymczak and ladd 2011 our results further show that the interplay among fracture network geometry initial aperture variability and geomechanical loading condition controls the dissolution process in 2 d natural fracture networks the impact of heterogeneous aperture structure induced by stress loadings on incipient karst formation appears secondary and is dependent essentially on the relative orientation between the reactive flow direction and the dominant persistent fractures the first order influence by fracture network geometry on early time karstification has already been pointed out by aliouache et al 2019 here we further show that when the aperture variability is present due to stress loading fundamental changes in the dissolution patterns may occur regulated by distinctive spatial fracture organizations however the breakthrough dynamics is more strongly affected in cases where the maximum principal stress is parallel to the persistent fractures i e when the studied natural fracture network is loaded with s x 15 mpa and s y 5 mpa in contrast the aperture variability alone or with stress loading of s x 5 mpa and s y 15 mpa does not exert significant impacts on the breakthrough when the same initial flow rate is applied the breakthrough time of cases where the mean flow is perpendicular to the persistent fracture set appear to be not sensitive to stress loading conditions with or without initial aperture variability this again emphasizes the dominant role of geological control under specific configurations of structural and mean flow directions the results may have important implication for various subsurface engineering applications in fractured carbonate rocks such as aquifer remediation and dam construction in the present study we focus on investigating the influence of aperture heterogeneity induced by in situ stresses the coupling of stress and pore pressure are not considered the results are only applicable to the situation where pore pressure in fractures is much less than the imposed geomechanical stresses thus are only valid for near surface karst formations the proposed reactive transport model based on realistic fracture networks will be further extended to account for fully coupled stress flow dissolution processes such as the effect of mechanical evolution on karstification to investigate the spatial relationship between tectonic structures and karst cavities under complex in situ stress conditions the 2 d analysis conducted in this work may be extended to 3 d in the future where different behavior of stress dependent karst genesis may be anticipated for example when the shear deformation is dominant in 3 d fractured rocks preferential fluid flow tends to occur along the direction perpendicular to the shear because the aperture correlation is more persistent along the direction normal to sliding yeo et al 1998 mallikamas and rajaram 2005 nemoto et al 2009 future work will also explore more complex scenarios such as other anisotropic fracture patterns with variable fracture orientations lei et al 2014 correlation between fracture lengths and initial apertures renshaw and park 1997 olson 2003 variable in situ stress conditions hudson and harrison 1992 and fracture matrix flow exchange effects bauer et al 2003 kaufmann et al 2010 in summary we report that the stress dependent aperture heterogeneity may play a critical role in the early stage karstification processes in fractured carbonate the extent of the stress impact depends on the relative relationship between flow and structural anisotropies as well as aperture variability when the reactive flow direction is aligned with the set of persistent fractures stress loading direction may alter the dissolution pattern significantly and reduce the karstification extent in contrast when the reactive flow direction is along the set of short fractures the evolved karst patterns are insensitive to stress loading aperture variability may enhance the stress effects in both flow conditions such that more profound effects are observed when the maximum stress is oriented normal to the long fractures our results highlight the critical importance of incorporating realistic fracture network geometry and stress dependent fracture aperture in karst genesis modeling the conventional approaches that neglect the effects of network geometry and in situ stress state may lead to biased prediction of karst pattern and breakthrough time our simulations have been restricted to two dimensional scenarios the overall trend of the observed dissolutional growth behavior may remain valid in 3d networks formed by a simple extrusion of the 2d networks in the third dimension this is because the bulk geomechanical response of the quasi 3d fracture network will not change qualitatively however the evolution behavior of the dissolutional front might be more complex in the quasi 3d network as a result the breakthrough behavior may be quite different from the 2d results if a 3d multi layer joint network is considered it is anticipated that a very different dissolutional growth pattern may occur as the network topology differs significantly in this situation 3d geomechanical modeling is needed to derive the intricate aperture distribution in 3d fracture networks the coupled stress flow dissolution analysis would also help improve engineering design and construction by more accurately forecasting karst conduits ubiquitously existing in fractured carbonate rocks credit authorship contribution statement xiaoguang wang conceptualization methodology writing original draft mohammed aliouache investigation formal analysis visualization yanyong wang conceptualization writing review editing qinghua lei methodology software validation herve jourde writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments x w and y w are grateful for the support from national key research and development program of china grant no 2020yfc1808300 and national natural science foundation of china grant no 42102300 q l is grateful for the support from the swiss national science foundation grant no 189882 and the national natural science foundation of china grant no 41961134032 
