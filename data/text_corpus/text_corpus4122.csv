index,text
20610,local scour at pile supported bridge foundations in coastal and offshore areas are an essential factor to engineering design and evaluation this study experimentally investigates live bed local scour at complex bridge piers under the influence of bed form migration the results show that the variation of the mean scour depth as a function of flow intensity ratio u u c u c threshold velocity for incipient motion depends on the pile cap elevation and is significantly different to single piers instantaneous bed level cross correlation analysis and power spectra show that bed forms approaching an exposed pile group may be damped leading to mean bed level fluctuation that are slightly smaller than the bed form heights in contrast when the pile cap is completely buried by the original bed but can be exposed during scour approaching bed forms tend to keep their individual features and cause larger scour fluctuation at pile cap s leading edge the enlargement is due to the concurrence between the enhanced or weakened scouring capacity and the decreased or increased upstream sediment supply the scour predictor proposed by previous studies is extended to live bed range and performs better than existing predictors keywords live bed scour complex bridge pier steady current pile cap elevation bed from migration scour fluctuation notation d pier width d e equivalent width of complex bridge pier d s scour depth d s e equilibrium scour depth d s e d s a v for live bed scour at equilibrium stage d s a v mean scour depth d s d e s i g n design scour depth for ensuring pier safety under live bed flow regime d s m a x a v mean scour maxima d s m i n a v mean scour minima d 50 median diameter of sediment particles f 1 parameter of the modified predictor regarding the effect of flow shallowness f 2 parameter of the modified predictor regarding the effect of flow intensity f 3 parameter of the modified predictor regarding the effect of sediment coarseness h b mean bed from height h c pile cap elevation e g the height of column base to the bed positive when above the bed t pile cap thickness u mean flow velocity u c mean critical velocity for incipient motion of bed sediment depth averaged u l p mean flow velocity at the live bed scour peak y 0 flow depth α pier skew angle δ d s mean scour fluctuation σ g geometric standard deviation of sediment size distribution 1 introduction scour is one of the most common damages to bridge piers located in coastal and offshore areas under the influence of strong currents the existence of the scour hole around a bridge pier may impair its structural stability and lead to settling bending or enlarged wobbling during natural hazards e g floods or earthquakes coastal and offshore bridge piers are usually built with a complex form with non uniform cross sectional shape due to mechanical geotechnical and structural considerations sheppard 2003 provides a detailed field study of scour at complex piers located in an intracoastal waterway a complex bridge pier often consists of three components a wall like column supporting the bridge deck and superstructure a pile cap under the column and a group of piles supporting both the column and the pile cap as shown in fig 1 this pier form is as widely used around the world as single pier forms with uniform cross sections however there have been fewer studies of scour at complex bridge piers than those for single piers early studies conducted in the 2000s including jones and sheppard 2000 coleman 2005 sheppard and glasser 2009 and ataie ashtiani et al 2010 focused on parameterizing the effect of different pier components especially the pile cap s relative elevation and proposing new scour prediction methods based on those for simple piers thus the frameworks of some popular methods were established and are still widely used such methods including the hec 18 arneson et al 2012 method and the fdot method sheppard and renna 2010 grimaldi and cardoso 2010 further tested scour at a centrosymmetric pier with a circular column and pile cap more recently moreno et al 2015 2016a b and ferraro et al 2013 performed a large number of experiments to investigate more complicated parameter influences such parameters including the relative column width pile cap thickness etc amini et al 2014 link et al 2018 and baghbadorani et al 2018 also provided useful experimental data the authors of this paper yang et al 2018 2020a 2020a studied the scour depth and temporal evolution under clear water conditions using complex piers skewed to the approaching flow to simulate more close to reality scenarios the influence of combined regular waves and steady current is further examined by yang et al 2020b regarding the flow field beheshti and ataie ashtiani 2010 2016 measured the flow around aligned complex piers with flat and scoured beds by expanding the definition of complex pier to those foundation structures with multiple components more studies in recent years are also relevant specifically yuan et al 2017 tested scour at a wind turbine tripod foundation ma et al 2018 and yang et al 2020 studied the scour features at a group of vertical piles under steady currents those studies can also provide useful information for understanding the scour features at non uniforms foundation structures however it should be noted that all the studies mentioned above considered only scour under clear water flow conditions i e without general bed motion and bed from migration thus although a large number of experimental data are available a noticeable gap in the current knowledge stills exists that how migrating bed forms will influence the scouring process at complex bridge piers the interaction between the approaching bed forms and the pier components brings more complexities and uncertainties to the scouring process thereby making such scour prediction much more difficult than for either single piers or complex piers under a clear water flow condition even live bed scour at single piers is a topic with relatively sparse information and experimental data the most recent studies include radice and lauva 2017 and yang et al 2019 as pointed out by ettema et al 2017 high priority should be given to determining the potential scenarios in which the most severe scour damage may occur the main features of the scour mechanism around pier components should also be a research priority especially with bed form migration under a live bed flow condition this paper is aimed at providing new information on live bed scour characteristics at complex bridge piers including the mean scour depth i e the time averaged scour depth at the dynamic equilibrium stage the trend of scour fluctuation and the scour mechanism under the influence of bed forms furthermore an improved scour prediction method is also proposed for the convenience of practitioners the findings in this study would also be relevant for understanding the live bed scour mechanism at single piers 2 experimental set up the experiments were performed in a 2 4 m wide 0 6 m deep and 25 m long sediment recirculating flume in the fluid mechanics laboratory at the university of auckland a 4 0 m long 0 6 m deep test section for scour experiments is located 11 m downstream from the inlet section which ensures that the approaching flow at the models is fully developed turbulent flow for live bed tests the entire channel was filled with another sediment layer with a thickness of 0 14 m to simulate close to reality bed form migration scenarios thus the sediment thickness in the test section was 0 74 m in total 0 14 m 0 60 m which is sufficient for tests with large scour depth the sediment used in the present study is uniform quartz sand with the median particle diameter d 50 0 84 mm and the geometrical standard deviation σ g 1 30 this type of sediment is considered as non cohesive and non ripple forming the complex pier model used in the present study was made of wooden and pvc materials and represents a typical form based on the bridge piers that have failed in the past several decades in new zealand as described by melville and coleman 2000 these failures include the bulls road bridge on sh1 the blackmount road bridge the oreti river road bridge and the whakatane river road bridge this model consists of a rectangular wall like column a rectangular pile cap and a 2 4 pile group it has an approximate geometric scale of 3 50 and is the same as the primary model used by yang et al 2018 fig 1 shows the dimensions of this model and the flume table 1 shows the basic experimental design and parameters of the present study experiments were designed with seven different pile cap elevations corresponding to different burial levels of the pile cap relative to the undisturbed bed for s1 and s2 the pile cap was entirely above the original bed for s3 s4 and s5 the pile cap was partially buried at the beginning for s6 the pile cap was fully buried by the original bed but could also be exposed by the scour hole while for s7 the pile cap was deeply buried and could not be exposed by scouring column only the pier model was kept aligned to the approaching flow i e no skew angle existed the flow depth was constant at 0 10 m the flow intensity ratio u u c was set from 0 9 to 5 2 with an interval of 0 3 where u is the mean flow velocity and u c is the critical velocity for sediment incipient motion the critical mean flow velocity for sediment incipient motion u c was calculated using the equations by melville and coleman 2000 the flow depth to pier size ratio y 0 d e is in the range of 0 76 2 70 where d e is the equivalent pier width i e the diameter of an equivalent circular pier that can lead to the same scour depth as the target complex pier specifically d e is calculated using the method of coleman 2005 in this study yang et al 2018 found that the method of coleman 2005 is more suitable for calculating d e for aligned complex piers while the method of sheppard and renna 2010 is more suitable for skewed complex piers more details about the determination of d e can be found in the scour prediction section for each series the experiments were performed consecutively in order of the value of u u c i e an experiment was the continuation of the previous one with smaller u u c depth averaged velocities were measured by a vectrino side looking acoustic doppler velocimetry adv made by nortek rud norway scour depth and bed form data were obtained using a seatek gainsville florida usa multiple transducer array instrument mta the calibration and filtering method of the mta data are described in detail by guan et al 2015 wang et al 2018 and yang et al 2019 and are further described in the following section data recording for each test stopped when sufficient bed forms usually more than 30 had passed the pier after the dynamic equilibrium stage was reached so that the time averaged scour depth became stable for live bed pier scour this dynamic equilibrium could usually be reached very quickly in a few hours or less than an hour due to the large flow intensity and sediment transport rate in this study the equilibrium was determined by calculating the time averaged scour depth in different time sections for experiments with large u u c i e with short scour development stage the first 25 of the recorded time series was trimmed directly as a convenient and straightforward approach for data processing 3 processing mta data previous studies have shown that the location of the maximum scour depth at an aligned complex bridge pier is highly dependent on the pile cap position relative to the original bed level the different locations of maximum scour included the first row of piles when pile group is highly exposed the projection of the leading face of the pile cap when pile cap is partially exposed or only the first row piles are exposed and the leading face of the column column only s7 thus the mta transducers were set up and fixed at each of these locations to monitor and record the instantaneous scour depth with a time interval from 1s to 0 05s the sampling interval was determined according to the flow intensity ratio u u c i e for a test with higher flow intensity a shorter sampling interval was chosen fig 2 shows the set up of the mta transducers and a photo before the start of the experiments s2 the primary method introduced by guan et al 2015 was applied to process the data of the mta transducers specifically this method extract the instantaneous scour depth at one transducer by drawing an upper envelop of the data scatters to attenuate the influence of signal disturbance or suspended particles however no manual filtering process was needed as the improved mta signal processor is capable of keeping the level of noise low enough even with a very high flow intensity due to the migration of bed forms and the corresponding fluctuating bed level at the tested complex piers the location of the maximum scour depth may change with time thus the following steps were followed to integrate the data from different transducers 1 processing the data from every single transducer according to the method of guan et al 2015 and drawing an envelope to determine the actual scour variation with time 2 combining all the envelopes to make a new envelope by finding the instantaneous maximum scour depth 3 determining scour fluctuation elements scour maxima and minima according to the new envelope the mean scour fluctuation is then defined as the mean of the scour maxima minus the mean of the scour minima δ d s d s max a v d s min a v similarly the mean upstream bed form height h b equals to the mean of the bed elevation maxima minus the mean of the bed elevation minima fig 3 shows the steps needed to process mta transducers data using part of the data from s3 with u u c 1 6 in fig 3b the data at two first row piles are represented by two different line types a and b respectively so that the difference between them can also be observed specifically in the 3rd step fig 3c the red lines indicate that the maximum scour depth occurred at the first row piles and the blue lines indicate that the maximum scour depth occurred at the projection of the pile cap s leading face 4 test results the results of the 94 tests in total in the present study are shown in table 2 where d s a v is the mean scour depth d s m a x a v is the mean scour maxima d s m i n a v is the mean scour minima δ d s is the mean scour fluctuation h b is the mean bed form height on the undisturbed upstream channel 0 8 m from the leading edge of pile cap besides the pile cap elevation relative to the original bed h c and the flow intensity ratio u u c are also listed in the table h c t is the ratio of pile cap elevation to pile cap thickness 4 1 mean scour depth fig 4 shows the measured mean scour depth d s a v versus the flow intensity ratio u u c for every series of tests the mean scour maxima and minima are also displayed by short dashes to show the mean scour fluctuation for each test δ d s the vertical distance between two short dashes previous studies on live bed scour at single piers with uniform cross sectional shape show similar general trends for the variation of scour depth with u u c with a descending phase after entering the live bed range followed by an ascending phase with further increase in u u c this ascending phase leads to a scour peak at the transitional flat bed stage when bed forms are basically washed out and flattened two similar peaks of mean scour depth occur at the clear water threshold and the live bed flat bed phase normally when u u c 4 5 and their relationship of size is also affected by the test scale however in the present study we have found that the existence of the pile cap will also influence the variation of mean scour depth that is a function of u u c in fig 4 when the pile cap is close to the original bed s3 s5 the descend ascend trend as with a single pier can still be observed but the descent is more pronounced with higher pile cap elevation for which the clear water scour hole is deeper when the pile cap is above the original bed and the influence of pile group on scour hole becomes dominant s1 s2 only a continuous descending trend can be observed while approaching a minimum value asymptotically in the live bed transitional flat bed stage when the pile cap is under the original bed s6 s7 the column induces scour like that at a single pier when the scour is initiated and the pile cap provides protection after being exposed under such circumstances the mean scour depth as a function of the flow intensity ratio u u c follows a different trend i e the scour depth varies only weakly with u u c but does drop slightly at the transitional flat bed stage the mean scour depths of each series are compared directly in fig 5 the curves in the figure are drawn to show the general trend of the experimental data in fig 5a the maximum clear water scour depth occurs when the pile cap is undercut by the original bed s3 h c 6 cm this is in accord with the conclusion of previous studies that the maximum clear water scour depth occurs when the pile cap is close to the original bed level as stated by coleman 2005 ataie ashtiani et al 2010 and moreno et al 2015 and yang et al 2018 however the live bed scour depth of s3 is only two thirds of the clear water depth the s3 depth is smaller than that of s4 for flow intensity ratios exceeding 3 after comparing the trends shown in fig 4c e it is suggested that the ratio of the two scour peaks clear water threshold and live bed peak is also related to the burial depth of the pile cap the difference between the two scour peaks diminishes with a pile cap that is initially just completely buried s5 h c 0 cm and is greatest with a pile cap that is initially just completely exposed s3 h c 6 cm more study on the flow field around complex piers with different configurations is needed to better understand this observation when the pile cap is totally above the original bed s1 and s2 the mean scour depth decreases with increasing flow intensity ratio u u c at least up to a ratio of 5 this trend is probably because that the flow beneath the pile cap is not effectively pressurized and accelerated whereas the sediment supply from the upstream increases significantly with the increasing flow intensity in addition the pile group effect becomes significant with a decreased pile cap submergence and thus the strength of the main scour agent e g horseshoe vortex is also weakened due to the reduced frontal blockage the maximum scour depth still occurs at the first row piles as the downstream piles are in the wake zones of the upstream piles where the generation of large scale turbulence structures are restricted when the pile cap is entirely buried by the original bed s6 and s7 the flow intensity ratio that produces the maximum mean scour depth is approximately the ratio that produces the maximum bed form height u u c 2 3 and a convex trend with flow intensity ratio can be observed the opposite to the other series this trend is different to the normal descend ascend trend found for live bed scour under such circumstances the maximum mean scour depth occurs when the bed form height is the maximum u u c 2 3 as the scouring process may be to some degree aggravated when a deep trough passes the scour hole generally the trend of mean scour depth with flow intensity ratio is highly dependent on the pile cap s level and may be significantly different to the trend for a single pier it should also be noted that the flow depth in this study are relatively shallow and some experiments fall into the category of transition pier i e 1 4 y 0 d e 0 2 as defined by ettema et al 2017 the conclusions made above should be applicable for similar or deeper flows as the bed forms and turbulence structures are well developed and are less dependent on the flow depth however caution should be exercised when the flow is further shallower that leads to a significant restriction on bed form initiation and horseshoe vortex besides a very small y 0 t ratio may lead to much different pier submergence conditions and scour scenarios more studies are needed to address this extra wide pier situation 4 2 scour fluctuation in the present study the maximum scour depth occurred at either the first row of piles or the leading edge of the pile cap or its projection fig 6 shows typical real time scour records for different pile cap elevations and illustrates where the maximum scour depth occurred specifically the blue or red lines indicate that the maximum scour depth occurred at the first row of piles or the pile cap s leading edge previous studies including chiew 1984 and melville and coleman 2000 concluded that the mean scour fluctuation δ d s at a single pier is linearly related to the mean height of approaching bed forms h b with this linear relationship varying between δ d s 0 5 h b and δ d s h b thus the design approach of adding one half the mean bed form height to the mean scour depth for design safety has been widely accepted by many researchers including chiew 1984 and melville and coleman 2000 however in fig 6 scour fluctuation may vary for different relative pile cap positions when the pile cap is entirely buried by the original bed h c 0 03 m and 0 m δ d s is much larger than that for cases when the pile cap is entirely above the original bed h c 0 06 m h c 0 09 m and h c 0 12 m the scour characteristics of the latter resemble those of a single pier a transitional case was observed with h c 0 03 m the pile cap half buried by the original bed where the scour hole is occasionally fully filled by the large approaching dunes forming the spikes in the fig while the pile group remains completely exposed most of the time the location of the maximum scour depth also varies according to the position of the pile cap this location tends to be at the first row of piles when the pile cap elevation is high especially when the pile cap is entirely above the original bed but at the leading edge of the pile cap or its projection when the pile cap is low especially when it is fully buried by the original bed 4 3 relationship between bed form and scour fluctuations the relationship between the mean scour fluctuation δds and the mean bed form height h b is shown in fig 7 the shaded area shows the range between δ d s 0 5 h b and δ d s h b where pier scour data lie for simple cylindrical piers the results show that a large number of data solid scatters in the present study lie in this area close to the perfect agreement line δ d s h b this trend is similar to that found by chiew 1984 however when the pile cap is fully buried by the original bed but can still be exposed occasionally during the scour process h c 0 m and 0 03 m the mean scour fluctuation δ d s is significantly larger than the mean bed form height h b as mentioned in the last section under such circumstances δ d s still varies linearly with h b while the positive interceptions on the x axis suggest that scour fluctuation may still exist when bed form height is zero ideal transitional flat bed condition the relationship between δ d s and h b may be affected by many parameters we have found that the effect of d s a v h b is predominant for single piers while for complex piers in this study geometric and flow field complexity are the key factors causing further amplified fluctuation more details regarding those parameters will be discussed in the following sections in addition it is also suggested that the current design approach may significantly underestimate the actual risk of scour at a complex pier under a live bed flow regime possible solutions include adding a value larger than h b to d s a v or performing physical modelling to determine the potential risk for specific cases researchers have not reported any similar results as shown in fig 7 more analysis addressing this phenomenon and tentative explanations is provided later in this paper 5 dynamic scour processes 5 1 scour fluctuation analysis to investigate the relationship between bed forms and scour fluctuation synchronous measurements of bed levels at the piers and upstream of the scour hole representing real time scour depth and bed form height are plotted in fig 8 two scenarios are plotted the pile cap completely buried by the original bed and the pile cap completely exposed the light grey lines connect the same dunes that are significantly deformed during migration from the upstream bed into the scour hole the zero value of y axis means the position of the original bed it should be noted that the scour fluctuation was measured at the pile cap s leading edge in fig 8a and at the first row piles in fig 8b thus the distance between the two measurement locations in fig 8a and b is 800 mm and 860 mm respectively it can be seen in fig 8a that when pile cap was entirely buried by the original bed many of the dune crests and dune trough amplitudes were significantly enlarged when approaching the location where the maximum scour depth occurred i e under the leading edge of the pile cap the coalescence of bed forms reported by radice and lauva 2017 for single piers were also observed but not as a regular mechanism during migration while most of the bed forms still tended to maintain their individual features when entering the scour hole in fig 8b when the pile cap was entirely above the original bed the scour fluctuation values were close to and slightly smaller than the corresponding bed from heights with significantly distorted crest shapes and slopes in addition a large dune crest tends to be damped and split into two or more smaller scour peaks with shorter period part of which are marked by the dashed circles this phenomenon is different to what was reported by radice and lauva 2017 for single piers that the scour fluctuations have a similar amplitude to the approaching dunes the data presented in this paper show that the relative elevation of the pile cap affects its influence on the flow field around it the pile cap may have a significant effect on the approaching bed forms the power spectra shown in fig 9 support this conclusion from another perspective specifically the spectra were computed using fast fourier transformation fft and periodogram which estimates the power from the amplitude of the fourier transformed data the computed spectra were also smoothed using savitzky golay filter with a smoothing window of 20 points about 5s to reduce the influence of spikes while maintain the original tendency in fig 9a when the pile cap is entirely above the original bed the higher frequency scour fluctuations are enhanced at the first row piles especially for period smaller than 100s it indicates that scour at this location tends to have more rapid and smaller fluctuations less than a minute which is in accord with the findings in fig 8b the spectral profile and amplitude of the approaching bed forms is otherwise maintained when they just enter the scour hole under the leading edge of pile cap in fig 9b when the pile cap is entirely buried by the original bed the fluctuation at the leading edge of pile cap shows higher power at the range of normal bed form frequencies as marked by the dashed rectangle it indicates that the approaching bed forms basically maintain their original features while showing larger amplitude this is in accord with the findings in fig 8a cross correlation analysis has been conducted to show the similarity between real time data series at different locations as shown in fig 10 and fig 11 specifically the correlation coefficients are normalized by the peak value in the first sub fig i e figs 10a and fig 11a to show the decline of the correlation level fig 10 shows cross correlations when the pile cap was entirely above the original bed the bed forms had very little deformation when migrating within an undisturbed region fig 10a showing a distinct peak with much weaker sub peaks in fig 10b the correlation between upstream bed form and scour fluctuation under the pile cap s leading edge was weakened with a lower but still distinct main peak this implies that the bed forms entering the scour hole underwent deformation to some extent but the basic shapes and periods were still maintained however in fig 10c no distinct peak can be found in the expected range while general fluctuation is weaker than the other two subplots this means that the bed forms original shapes and individual features were entirely destroyed on the short path from the pile cap to the first row piles it also supports the conclusion made from figs 8b and 9a confirm that the pressurized flow under the pile cap distorts the approaching dunes fig 11 shows cross correlations when the pile cap was entirely buried by the original bed the strong correlations resemble those in fig 10a and b confirming that bed forms tend to maintain their original shapes when approaching the leading edge of the pile cap however the vertical piles supporting the pile cap were buried most of the time and thus the maximum scour depth and the greatest fluctuation in scour depth both occurred at the leading edge of the pile cap rather than at the first row piles the phenomenon stated in this section indicates that the relationship between bed level variations at upstream bed and the pier is affected by the relative pile cap elevation which is also presumed to affect the flow field around the pier in general the deformation of approaching bed forms is affected by the bed form size the equilibrium scour depth and the pier s structure for example an extremely slender pier with negligible scour inducing flow structures e g horseshoe vortex can hardly deform the approaching bed forms so that the fluctuation in front of the pier will be equal to the bed form size the pier size to bed form size ratio or the ratio of d s a v h b is a key factor that determines the potential extent of bed from deformation in the scour hole and the magnitude of scour fluctuation our laboratory studies in recent years show that a functional relationship between d s a v h b and δ d s h b is apparent i e larger d s a v h b in general leads to smaller δ d s h b for scour at common structures the observed δ d s h b for single uniform piers are usually no larger than 1 0 while the amplified fluctuation for deeply buried complex piers in this study occurs specifically for structures that can produce flow pressurization since that the effect of d s a v h b is not significant in this study more works are expected to further investigate this relation in the future 5 2 variation of scour mechanism with bed form migration beheshti and ataie ashtiani 2006 2010 investigated the flow field at complex bridge pier on a fixed flat bed and a scoured bed under clear water flow regime it was found that the main flow features producing scour come from the interaction between separate flows created by the pier components fig 12 has been prepared for this paper to illustrate the main flow features the flow approaching the pile cap is deflected upward and downward by the pile cap s frontal face the downward flow is then pressurized by the pile cap and accelerated toward the vertical pile flow 2 with amplified turbulence energy while the upward flow interacts with the down flow created by the column flow 1 around the top of the pile cap and is then deflected laterally the deflected flows meet at the both sides of the pile cap and produce vortices flow 3 counter clockwise on the right hand side entraining and carrying sediment at the both sides in addition the flow coming out from the space under the pile cap meets the downward flow behind the pile cap and produce another vortex flow 4 entraining the sediment particles the exposed vertical piles can also produce separate down flow and horseshoe vortex flow 5 at the bottom enhancing the scouring effect by flow 2 beheshti and ataie ashtiani s works identified flow 2 as the most important flow feature for scour development and its scouring capacity was found to be inversely proportional to the height between the pile cap and the bed besides when the bed level is higher than the bottom of the pile cap i e partially buried flow 2 will be replaced by a typical horseshoe vortex system caused by the downward flow deflected by the pile cap s face this phenomenon can also be observed in the study and more detailed explanations will be given in the following paragraphs in the present study no flow measurement or visualization could be made due to the high flow velocity and the corresponding sediment suspension and aeration around the piers however possible explanations are given according to the observed fill erosion processes and the reported flow mechanism by beheshti and ataie ashtiani 2010 2016 fig 13 prepared for the present paper shows schematic drawings of the flow field in front of a pier with a completely buried pile cap as it varies over five stages of scour hole fluctuation the sediment volume marked as red and green represent the first and the second dune crests in fig 13a a scour maximum occurs when one of the dune troughs passes the front face of the pier at this stage the space under the pile cap has been cleared by the scour mainly caused by the flow deflected downwards when the following dune crest approaches and collapses into the scour hole as shown in fig 13b the scour hole is filled by the incoming sediment quickly in spite of this high scour capacity while the pressurized flow also diminishes once the pile cap is undercut as a result the scour capacity is weakened when the incoming sediment fills the space under the pile cap further deposition then elevates the bed to be flush to the pile cap s top as shown in fig 13c the remained sediment supply will be quickly removed downstream along the top of the pile cap top without accumulating at this stage the scour capacity is minimized as the main flow features responsible for scour the downward flow the pressurized flow under the pile cap and the vortices caused by the pile cap s frontal face have all disappeared after the dune crest completely passes the pier face in fig 13d the approaching dune trough again lowers the bed level in front of the pier and significantly reduces the sediment supply while the scouring capacity is enhanced accordingly especially after the pile cap s face is entirely exposed eventually in fig 13e a complete cycle ends when a new dune trough reaches the pier s face with the similar deep scour and pile cap exposure as fig 13a it should also be noted that fig 13 is only schematic and does not show exactly the same phenomenon occurring in real scour scenarios the scour rate beneath the pile cap may not be at the same rate of bed from migration and thus the processes shown in fig 13 may be slightly different if the migration speed increases relative to the scour rate or vice versa the randomness of bed form may also influence the bed response in every single cycle fig 14 provides a typical data record test s5 5 showing how scour developed with the pile cap being entirely buried by the original bed as in fig 13 the data support the above inferences about the flow mechanism from another perspective in fig 14 a typical cycle of scour variation is highlighted with five marked stages corresponding to the five stages illustrated in fig 13 the stage of a b and d e represent the processes of the flow path under the pile cap being steadily buried and rapidly excavated during bed form migration stage c is a quasi steady condition that often occurs when the bed is elevated to the top of pile cap sediment supplied from upstream moves downstream quickly without further accumulation creating undulant and sustained flat peaks as marked by the brackets the maximum accumulation rate and the maximum erosion rate both usually occur from when the bed elevation passes the bottom of the pile cap dashed horizontal line indicating that the exposure of any part of the pile cap increases the capacity for scour the scour fluctuations are generally much larger than the upstream bed form heights a similar process termed tunnel erosion was reported by sumer and fredsøe 2002 for scour at pipelines the small gap between the pipeline and the bed at the initiation of scour leads to the amplification of bed shear stress and flow velocity and a tremendous increase of sediment transport rate to summarise in contrast to single piers the scouring capacity of complex piers tend to vary as a series of bed forms pass the scour hole this variation is enhanced when the pile cap can be buried and then uncovered by the approaching bed forms the enhancement or weakening of the scouring capacity originates with the decrease or increase of upstream sediment supply and depending on the elevation of the pile cap there may be enlarged scour fluctuation compared to the upstream bed forms therefore this study indicates that when bridge designers calculated design scour depths they need to allow for scour aggravation caused by bed form migration it is also worth mentioning that for live bed scour at single piers the response of bed morphology to bed form migration tends to follow more regular and predictable patterns in general for slender piers the typical drawing elongation deceleration process chiew 1984 is observed as bed forms pass the scour hole with their integrity maintained for large piers the incoming bed forms are totally destroyed and then collapse into the scour hole in the form of periodic sediment replenishments with much less magnitude the flow condition is also a key factor for both single and complex piers the scour fluctuations occurring with transitional flat bed or antidunes i e very high flow intensity are expected to be significantly different from our experiments although those conditions are rare for pier scour furthermore fine ripple forming or coarse gravel like bed materials or cohesive sediment e g silt or clay do not produce the typical dune like bed forms in this study and thus the influence of scour fluctuation might be minor the wave induced submarine ripples also do not produce significant scour fluctuation due to their small sizes and low migrating celerity generally the conclusion drawn in this section are subjected to limitations and should be treated with caution 6 scour prediction 6 1 existing scour predictors for complex pier so far the hec 18 arneson et al 2012 method and the sheppard melville s m method sheppard et al 2011 are the most widely used prediction methods for local scour at bridge piers specifically the s m method is recommended by sheppard et al 2014 and ettema et al 2017 as the most accurate method and one that is more readily adapted as further information becomes available for complex bridge piers the hec 18 method provides an independent set of equations for calculation of equivalent pier width while the s m method needs the prior calculation of equivalent pier width using equations from other sources specifically equivalent pier width is the diameter of an equivalent circular pier that can lead to the same scour depth as the target complex pier two sets of equations for equivalent pier width have been proposed by sheppard and renna 2010 fdot scour manual and coleman 2005 respectively yang et al 2018 evaluated the performance of combining the s m method with each of these two methods the results showed a better accuracy for aligned complex piers with the combination s m coleman and for skewed complex pier with the combination s m fdot a new equation for equilibrium scour depth was also proposed by yang et al 2018 based on the original s m method for clear water scour at skewed complex bridge piers these four combinations of prediction methods were selected to evaluate their performances in the present study as shown in table 3 it should be noted that in method 3 the equation by yang et al 2018 was developed only for clear water scour thus an extension of this equation to the live bed range of this method was necessary for this study 6 2 extension of the equation from yang et al 2018 yang et al 2018 proposed a new set of equations according to the original sheppard melville method for complex bridge piers with typical structure and in the clear water flow regime u u c 1 the equation can be expressed as follows 1 d s e d e 3 17 f 1 f 2 f 3 2 f 1 t a n h y 0 d e 0 65 3 f 2 1 1 2 l n u u c 2 4 f 3 d e d 50 69 25 d e d 50 0 34 0 14 d e d 50 1 41 where d s e equilibrium scour depth i e mean scour depth d s a v at equilibrium stage for live bed scour y 0 flow depth d e equivalent pier width and d 50 median diameter of sediment particles to extend the equations to the live bed flow regime u u c 1 the framework of the original sheppard melville method is applied with modification to take the full range of flow intensity into account the new extended equations can be expressed as below when 1 u u c u l p u c 5 d s e d e f 1 2 3 1 u u c u l p u c u l p u c 1 1 1 3 17 f 3 u u c u l p u c u l p u c 1 1 1 when u u c u l p u c 6 d s e d e 2 3 f 1 7 u l p m a x 5 u c 0 6 g y 0 specifically u l p represents the flow velocity where the bed form is washed out i e the transitional flat bed condition many researchers including chee 1982 melville 1984 and chiew 1984 have found a scour peak occurring under this bed regime for single piers i e the live bed peak with the extension as listed above method 3 of table 3 can be used to predict scour depth at complex bridge piers under both clear water and live bed flow regimes 6 3 evaluation of predictors the existing predictors listed in table 3 are compared for each test series in the present study in fig 15 method 4 the hec 18 method produces an unrealistic trend the predicted scour depth at the clear water threshold is realistic but there is a rapid increase in scour depth with increasing flow intensity after entering the live bed flow regime this is because the equation of the hec 18 method includes the channel froude number rather than flow intensity ratio u u c when taking flow velocity into account method 1 and method 2 are based on the original framework of the sheppard melville method with alternative input of equivalent pier width for each method the results show that method 2 is more accurate than method 1 when the pile cap is near or buried by the original flat bed s3 s6 for other series s1 s2 s7 the results of method 1 and method 2 are similar due to the two methods calculating the same pier equivalent width these results show the equation of coleman 2005 giving the more realistic value of pier equivalent width for complex bridge piers aligned to the approaching flow as found by yang et al 2018 generally method 1 and method 2 were designed to envelop both the scour peaks at clear water and live bed transitional flat bed stage while the scour depth between the two peaks is approximated using a linear relation obviously the accuracy of enveloping is dependent on pier configuration in the present study and is not satisfactory by comparison the equation proposed in the present study method 3 predicts a more natural and realistic trend including both of the scour peaks and the descend ascend trend after entering live bed flow regime in addition estimation of the scour depth at clear water threshold underestimated by method 2 has also been improved several statistical indicators were selected for a quantitative test of the accuracy of the four methods table 4 these indicatots included the root mean square error rmse mean absolute percentage error mbpe the number of data above the 30 error line p30 the number of data below the perfect agreement line m0 the number of data below the 10 error line m10 and the mbpe of the under estimated data mbpe m0 method 3 gave slightly larger rmse and mbpe values than method 2 while the number of under estimated data especially those below the 10 error line was significantly reduced the mbpe value of data under estimated by method 3 was also 50 smaller than the corresponding value for method 2 for these data method 3 was generally more accurate with a more natural scour trend and therefore provided a larger safety margin by reducing under estimation it should also be noted that method 3 has been shown by yang et al 2018 to be more suitable for clear water scour at skewed complex piers and thus is extended in the present study to cover the full range of flow intensity ratio u u c this method can also be more readily modified when further live bed scour data become available in addition this method should be used for situations with the values of y 0 d e and y 0 t similar to or large than those used in this study extra cautions should be exercised for an unusually small flow depth to pier size ratio e g y 0 d e 0 2 or large pile cap thickness relative to the flow depth e g y 0 t 1 which may lead to a flow mechanism different from that discussed in this paper 7 conclusion this paper is focused on live bed scour at complex bridge piers with bed form migration about which no available information has been reported yet melville and coleman 2000 as well as other more recent studies mentioned in the introduction section only proposed solutions for complex piers under clear water condition the conclusions drawn in this paper are listed below 1 at a complex pier the variation of mean scour depth d s a v with flow intensity ratio depends on the pile cap elevation h c and may differ from the typical descend ascend trend found with a single pier thus the existence and size relationship of both the scour peaks at the clear water threshold and the transitional flat bed stage are significantly also different for complex bridge piers 2 at complex piers in live bed conditions scour depth fluctuates the mean scour fluctuation δ d s depends on the relative pile cap position when the pile cap is completely buried by the original bed δ d s may be much larger than the upstream bed form height 3 synchronous measurements power spectra analysis and cross correlation analysis of bed elevation data both near the pier and at on the upstream channel bed indicate that when the pile cap is completely buried by the original bed bed forms approaching the scour hole may be significantly magnified at the pile cap s leading edge while still keeping their individual form resulting in high scour fluctuation when the pile cap is above the original bed the approaching bed forms are typically destroyed among the vertical piles showing less correlation with upstream bed forms the destroyed bed forms bring more rapid flotations with smaller periods under such circumstances the mean scour fluctuation is found to be slightly less than the bed form height upstream 4 scour depth as well as flow field at complex bridge pier vary with the arrival of the upstream bed forms the pile cap plays an important role when the pile cap is entirely buried by the original bed scour fluctuation is enlarged due to the cyclic exposure burial of the pile cap in such a cycle decreased or increased sediment supply lowers or elevates the bed level at the pier and then further increases or decreases the flow s scouring capacity 5 a new method is proposed according to the equation from yang et al 2018 to calculate the mean scour depth at a complex bridge pier under the live bed flow regime u u c 1 the new method is found to provide better accuracy and less underestimation than the existing methods and is more suitable for further improvement when more data for live bed scour at skewed complex piers become available the natural trend of d s a v as a function of u u c can also be better represented 6 it should also be noted that many different geometric designs for complex bridge piers are built and the scour design approach may need to vary for the different complex pier designs ettema et al 2017 emphasized that actual pier designs should be scour tested although the general trends reported in the present paper can be applied to all pier designs physical testing may still be needed credit authorship contribution statement yifan yang conceptualization investigation methodology data curation writing original draft writing review editing bruce w melville supervision conceptualization writing review editing graham h macky conceptualization methodology writing review editing asaad y shamseldin writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the first author would like to thank china scholarship council csc for the financial support and the love and care from dr yu huang 
20610,local scour at pile supported bridge foundations in coastal and offshore areas are an essential factor to engineering design and evaluation this study experimentally investigates live bed local scour at complex bridge piers under the influence of bed form migration the results show that the variation of the mean scour depth as a function of flow intensity ratio u u c u c threshold velocity for incipient motion depends on the pile cap elevation and is significantly different to single piers instantaneous bed level cross correlation analysis and power spectra show that bed forms approaching an exposed pile group may be damped leading to mean bed level fluctuation that are slightly smaller than the bed form heights in contrast when the pile cap is completely buried by the original bed but can be exposed during scour approaching bed forms tend to keep their individual features and cause larger scour fluctuation at pile cap s leading edge the enlargement is due to the concurrence between the enhanced or weakened scouring capacity and the decreased or increased upstream sediment supply the scour predictor proposed by previous studies is extended to live bed range and performs better than existing predictors keywords live bed scour complex bridge pier steady current pile cap elevation bed from migration scour fluctuation notation d pier width d e equivalent width of complex bridge pier d s scour depth d s e equilibrium scour depth d s e d s a v for live bed scour at equilibrium stage d s a v mean scour depth d s d e s i g n design scour depth for ensuring pier safety under live bed flow regime d s m a x a v mean scour maxima d s m i n a v mean scour minima d 50 median diameter of sediment particles f 1 parameter of the modified predictor regarding the effect of flow shallowness f 2 parameter of the modified predictor regarding the effect of flow intensity f 3 parameter of the modified predictor regarding the effect of sediment coarseness h b mean bed from height h c pile cap elevation e g the height of column base to the bed positive when above the bed t pile cap thickness u mean flow velocity u c mean critical velocity for incipient motion of bed sediment depth averaged u l p mean flow velocity at the live bed scour peak y 0 flow depth α pier skew angle δ d s mean scour fluctuation σ g geometric standard deviation of sediment size distribution 1 introduction scour is one of the most common damages to bridge piers located in coastal and offshore areas under the influence of strong currents the existence of the scour hole around a bridge pier may impair its structural stability and lead to settling bending or enlarged wobbling during natural hazards e g floods or earthquakes coastal and offshore bridge piers are usually built with a complex form with non uniform cross sectional shape due to mechanical geotechnical and structural considerations sheppard 2003 provides a detailed field study of scour at complex piers located in an intracoastal waterway a complex bridge pier often consists of three components a wall like column supporting the bridge deck and superstructure a pile cap under the column and a group of piles supporting both the column and the pile cap as shown in fig 1 this pier form is as widely used around the world as single pier forms with uniform cross sections however there have been fewer studies of scour at complex bridge piers than those for single piers early studies conducted in the 2000s including jones and sheppard 2000 coleman 2005 sheppard and glasser 2009 and ataie ashtiani et al 2010 focused on parameterizing the effect of different pier components especially the pile cap s relative elevation and proposing new scour prediction methods based on those for simple piers thus the frameworks of some popular methods were established and are still widely used such methods including the hec 18 arneson et al 2012 method and the fdot method sheppard and renna 2010 grimaldi and cardoso 2010 further tested scour at a centrosymmetric pier with a circular column and pile cap more recently moreno et al 2015 2016a b and ferraro et al 2013 performed a large number of experiments to investigate more complicated parameter influences such parameters including the relative column width pile cap thickness etc amini et al 2014 link et al 2018 and baghbadorani et al 2018 also provided useful experimental data the authors of this paper yang et al 2018 2020a 2020a studied the scour depth and temporal evolution under clear water conditions using complex piers skewed to the approaching flow to simulate more close to reality scenarios the influence of combined regular waves and steady current is further examined by yang et al 2020b regarding the flow field beheshti and ataie ashtiani 2010 2016 measured the flow around aligned complex piers with flat and scoured beds by expanding the definition of complex pier to those foundation structures with multiple components more studies in recent years are also relevant specifically yuan et al 2017 tested scour at a wind turbine tripod foundation ma et al 2018 and yang et al 2020 studied the scour features at a group of vertical piles under steady currents those studies can also provide useful information for understanding the scour features at non uniforms foundation structures however it should be noted that all the studies mentioned above considered only scour under clear water flow conditions i e without general bed motion and bed from migration thus although a large number of experimental data are available a noticeable gap in the current knowledge stills exists that how migrating bed forms will influence the scouring process at complex bridge piers the interaction between the approaching bed forms and the pier components brings more complexities and uncertainties to the scouring process thereby making such scour prediction much more difficult than for either single piers or complex piers under a clear water flow condition even live bed scour at single piers is a topic with relatively sparse information and experimental data the most recent studies include radice and lauva 2017 and yang et al 2019 as pointed out by ettema et al 2017 high priority should be given to determining the potential scenarios in which the most severe scour damage may occur the main features of the scour mechanism around pier components should also be a research priority especially with bed form migration under a live bed flow condition this paper is aimed at providing new information on live bed scour characteristics at complex bridge piers including the mean scour depth i e the time averaged scour depth at the dynamic equilibrium stage the trend of scour fluctuation and the scour mechanism under the influence of bed forms furthermore an improved scour prediction method is also proposed for the convenience of practitioners the findings in this study would also be relevant for understanding the live bed scour mechanism at single piers 2 experimental set up the experiments were performed in a 2 4 m wide 0 6 m deep and 25 m long sediment recirculating flume in the fluid mechanics laboratory at the university of auckland a 4 0 m long 0 6 m deep test section for scour experiments is located 11 m downstream from the inlet section which ensures that the approaching flow at the models is fully developed turbulent flow for live bed tests the entire channel was filled with another sediment layer with a thickness of 0 14 m to simulate close to reality bed form migration scenarios thus the sediment thickness in the test section was 0 74 m in total 0 14 m 0 60 m which is sufficient for tests with large scour depth the sediment used in the present study is uniform quartz sand with the median particle diameter d 50 0 84 mm and the geometrical standard deviation σ g 1 30 this type of sediment is considered as non cohesive and non ripple forming the complex pier model used in the present study was made of wooden and pvc materials and represents a typical form based on the bridge piers that have failed in the past several decades in new zealand as described by melville and coleman 2000 these failures include the bulls road bridge on sh1 the blackmount road bridge the oreti river road bridge and the whakatane river road bridge this model consists of a rectangular wall like column a rectangular pile cap and a 2 4 pile group it has an approximate geometric scale of 3 50 and is the same as the primary model used by yang et al 2018 fig 1 shows the dimensions of this model and the flume table 1 shows the basic experimental design and parameters of the present study experiments were designed with seven different pile cap elevations corresponding to different burial levels of the pile cap relative to the undisturbed bed for s1 and s2 the pile cap was entirely above the original bed for s3 s4 and s5 the pile cap was partially buried at the beginning for s6 the pile cap was fully buried by the original bed but could also be exposed by the scour hole while for s7 the pile cap was deeply buried and could not be exposed by scouring column only the pier model was kept aligned to the approaching flow i e no skew angle existed the flow depth was constant at 0 10 m the flow intensity ratio u u c was set from 0 9 to 5 2 with an interval of 0 3 where u is the mean flow velocity and u c is the critical velocity for sediment incipient motion the critical mean flow velocity for sediment incipient motion u c was calculated using the equations by melville and coleman 2000 the flow depth to pier size ratio y 0 d e is in the range of 0 76 2 70 where d e is the equivalent pier width i e the diameter of an equivalent circular pier that can lead to the same scour depth as the target complex pier specifically d e is calculated using the method of coleman 2005 in this study yang et al 2018 found that the method of coleman 2005 is more suitable for calculating d e for aligned complex piers while the method of sheppard and renna 2010 is more suitable for skewed complex piers more details about the determination of d e can be found in the scour prediction section for each series the experiments were performed consecutively in order of the value of u u c i e an experiment was the continuation of the previous one with smaller u u c depth averaged velocities were measured by a vectrino side looking acoustic doppler velocimetry adv made by nortek rud norway scour depth and bed form data were obtained using a seatek gainsville florida usa multiple transducer array instrument mta the calibration and filtering method of the mta data are described in detail by guan et al 2015 wang et al 2018 and yang et al 2019 and are further described in the following section data recording for each test stopped when sufficient bed forms usually more than 30 had passed the pier after the dynamic equilibrium stage was reached so that the time averaged scour depth became stable for live bed pier scour this dynamic equilibrium could usually be reached very quickly in a few hours or less than an hour due to the large flow intensity and sediment transport rate in this study the equilibrium was determined by calculating the time averaged scour depth in different time sections for experiments with large u u c i e with short scour development stage the first 25 of the recorded time series was trimmed directly as a convenient and straightforward approach for data processing 3 processing mta data previous studies have shown that the location of the maximum scour depth at an aligned complex bridge pier is highly dependent on the pile cap position relative to the original bed level the different locations of maximum scour included the first row of piles when pile group is highly exposed the projection of the leading face of the pile cap when pile cap is partially exposed or only the first row piles are exposed and the leading face of the column column only s7 thus the mta transducers were set up and fixed at each of these locations to monitor and record the instantaneous scour depth with a time interval from 1s to 0 05s the sampling interval was determined according to the flow intensity ratio u u c i e for a test with higher flow intensity a shorter sampling interval was chosen fig 2 shows the set up of the mta transducers and a photo before the start of the experiments s2 the primary method introduced by guan et al 2015 was applied to process the data of the mta transducers specifically this method extract the instantaneous scour depth at one transducer by drawing an upper envelop of the data scatters to attenuate the influence of signal disturbance or suspended particles however no manual filtering process was needed as the improved mta signal processor is capable of keeping the level of noise low enough even with a very high flow intensity due to the migration of bed forms and the corresponding fluctuating bed level at the tested complex piers the location of the maximum scour depth may change with time thus the following steps were followed to integrate the data from different transducers 1 processing the data from every single transducer according to the method of guan et al 2015 and drawing an envelope to determine the actual scour variation with time 2 combining all the envelopes to make a new envelope by finding the instantaneous maximum scour depth 3 determining scour fluctuation elements scour maxima and minima according to the new envelope the mean scour fluctuation is then defined as the mean of the scour maxima minus the mean of the scour minima δ d s d s max a v d s min a v similarly the mean upstream bed form height h b equals to the mean of the bed elevation maxima minus the mean of the bed elevation minima fig 3 shows the steps needed to process mta transducers data using part of the data from s3 with u u c 1 6 in fig 3b the data at two first row piles are represented by two different line types a and b respectively so that the difference between them can also be observed specifically in the 3rd step fig 3c the red lines indicate that the maximum scour depth occurred at the first row piles and the blue lines indicate that the maximum scour depth occurred at the projection of the pile cap s leading face 4 test results the results of the 94 tests in total in the present study are shown in table 2 where d s a v is the mean scour depth d s m a x a v is the mean scour maxima d s m i n a v is the mean scour minima δ d s is the mean scour fluctuation h b is the mean bed form height on the undisturbed upstream channel 0 8 m from the leading edge of pile cap besides the pile cap elevation relative to the original bed h c and the flow intensity ratio u u c are also listed in the table h c t is the ratio of pile cap elevation to pile cap thickness 4 1 mean scour depth fig 4 shows the measured mean scour depth d s a v versus the flow intensity ratio u u c for every series of tests the mean scour maxima and minima are also displayed by short dashes to show the mean scour fluctuation for each test δ d s the vertical distance between two short dashes previous studies on live bed scour at single piers with uniform cross sectional shape show similar general trends for the variation of scour depth with u u c with a descending phase after entering the live bed range followed by an ascending phase with further increase in u u c this ascending phase leads to a scour peak at the transitional flat bed stage when bed forms are basically washed out and flattened two similar peaks of mean scour depth occur at the clear water threshold and the live bed flat bed phase normally when u u c 4 5 and their relationship of size is also affected by the test scale however in the present study we have found that the existence of the pile cap will also influence the variation of mean scour depth that is a function of u u c in fig 4 when the pile cap is close to the original bed s3 s5 the descend ascend trend as with a single pier can still be observed but the descent is more pronounced with higher pile cap elevation for which the clear water scour hole is deeper when the pile cap is above the original bed and the influence of pile group on scour hole becomes dominant s1 s2 only a continuous descending trend can be observed while approaching a minimum value asymptotically in the live bed transitional flat bed stage when the pile cap is under the original bed s6 s7 the column induces scour like that at a single pier when the scour is initiated and the pile cap provides protection after being exposed under such circumstances the mean scour depth as a function of the flow intensity ratio u u c follows a different trend i e the scour depth varies only weakly with u u c but does drop slightly at the transitional flat bed stage the mean scour depths of each series are compared directly in fig 5 the curves in the figure are drawn to show the general trend of the experimental data in fig 5a the maximum clear water scour depth occurs when the pile cap is undercut by the original bed s3 h c 6 cm this is in accord with the conclusion of previous studies that the maximum clear water scour depth occurs when the pile cap is close to the original bed level as stated by coleman 2005 ataie ashtiani et al 2010 and moreno et al 2015 and yang et al 2018 however the live bed scour depth of s3 is only two thirds of the clear water depth the s3 depth is smaller than that of s4 for flow intensity ratios exceeding 3 after comparing the trends shown in fig 4c e it is suggested that the ratio of the two scour peaks clear water threshold and live bed peak is also related to the burial depth of the pile cap the difference between the two scour peaks diminishes with a pile cap that is initially just completely buried s5 h c 0 cm and is greatest with a pile cap that is initially just completely exposed s3 h c 6 cm more study on the flow field around complex piers with different configurations is needed to better understand this observation when the pile cap is totally above the original bed s1 and s2 the mean scour depth decreases with increasing flow intensity ratio u u c at least up to a ratio of 5 this trend is probably because that the flow beneath the pile cap is not effectively pressurized and accelerated whereas the sediment supply from the upstream increases significantly with the increasing flow intensity in addition the pile group effect becomes significant with a decreased pile cap submergence and thus the strength of the main scour agent e g horseshoe vortex is also weakened due to the reduced frontal blockage the maximum scour depth still occurs at the first row piles as the downstream piles are in the wake zones of the upstream piles where the generation of large scale turbulence structures are restricted when the pile cap is entirely buried by the original bed s6 and s7 the flow intensity ratio that produces the maximum mean scour depth is approximately the ratio that produces the maximum bed form height u u c 2 3 and a convex trend with flow intensity ratio can be observed the opposite to the other series this trend is different to the normal descend ascend trend found for live bed scour under such circumstances the maximum mean scour depth occurs when the bed form height is the maximum u u c 2 3 as the scouring process may be to some degree aggravated when a deep trough passes the scour hole generally the trend of mean scour depth with flow intensity ratio is highly dependent on the pile cap s level and may be significantly different to the trend for a single pier it should also be noted that the flow depth in this study are relatively shallow and some experiments fall into the category of transition pier i e 1 4 y 0 d e 0 2 as defined by ettema et al 2017 the conclusions made above should be applicable for similar or deeper flows as the bed forms and turbulence structures are well developed and are less dependent on the flow depth however caution should be exercised when the flow is further shallower that leads to a significant restriction on bed form initiation and horseshoe vortex besides a very small y 0 t ratio may lead to much different pier submergence conditions and scour scenarios more studies are needed to address this extra wide pier situation 4 2 scour fluctuation in the present study the maximum scour depth occurred at either the first row of piles or the leading edge of the pile cap or its projection fig 6 shows typical real time scour records for different pile cap elevations and illustrates where the maximum scour depth occurred specifically the blue or red lines indicate that the maximum scour depth occurred at the first row of piles or the pile cap s leading edge previous studies including chiew 1984 and melville and coleman 2000 concluded that the mean scour fluctuation δ d s at a single pier is linearly related to the mean height of approaching bed forms h b with this linear relationship varying between δ d s 0 5 h b and δ d s h b thus the design approach of adding one half the mean bed form height to the mean scour depth for design safety has been widely accepted by many researchers including chiew 1984 and melville and coleman 2000 however in fig 6 scour fluctuation may vary for different relative pile cap positions when the pile cap is entirely buried by the original bed h c 0 03 m and 0 m δ d s is much larger than that for cases when the pile cap is entirely above the original bed h c 0 06 m h c 0 09 m and h c 0 12 m the scour characteristics of the latter resemble those of a single pier a transitional case was observed with h c 0 03 m the pile cap half buried by the original bed where the scour hole is occasionally fully filled by the large approaching dunes forming the spikes in the fig while the pile group remains completely exposed most of the time the location of the maximum scour depth also varies according to the position of the pile cap this location tends to be at the first row of piles when the pile cap elevation is high especially when the pile cap is entirely above the original bed but at the leading edge of the pile cap or its projection when the pile cap is low especially when it is fully buried by the original bed 4 3 relationship between bed form and scour fluctuations the relationship between the mean scour fluctuation δds and the mean bed form height h b is shown in fig 7 the shaded area shows the range between δ d s 0 5 h b and δ d s h b where pier scour data lie for simple cylindrical piers the results show that a large number of data solid scatters in the present study lie in this area close to the perfect agreement line δ d s h b this trend is similar to that found by chiew 1984 however when the pile cap is fully buried by the original bed but can still be exposed occasionally during the scour process h c 0 m and 0 03 m the mean scour fluctuation δ d s is significantly larger than the mean bed form height h b as mentioned in the last section under such circumstances δ d s still varies linearly with h b while the positive interceptions on the x axis suggest that scour fluctuation may still exist when bed form height is zero ideal transitional flat bed condition the relationship between δ d s and h b may be affected by many parameters we have found that the effect of d s a v h b is predominant for single piers while for complex piers in this study geometric and flow field complexity are the key factors causing further amplified fluctuation more details regarding those parameters will be discussed in the following sections in addition it is also suggested that the current design approach may significantly underestimate the actual risk of scour at a complex pier under a live bed flow regime possible solutions include adding a value larger than h b to d s a v or performing physical modelling to determine the potential risk for specific cases researchers have not reported any similar results as shown in fig 7 more analysis addressing this phenomenon and tentative explanations is provided later in this paper 5 dynamic scour processes 5 1 scour fluctuation analysis to investigate the relationship between bed forms and scour fluctuation synchronous measurements of bed levels at the piers and upstream of the scour hole representing real time scour depth and bed form height are plotted in fig 8 two scenarios are plotted the pile cap completely buried by the original bed and the pile cap completely exposed the light grey lines connect the same dunes that are significantly deformed during migration from the upstream bed into the scour hole the zero value of y axis means the position of the original bed it should be noted that the scour fluctuation was measured at the pile cap s leading edge in fig 8a and at the first row piles in fig 8b thus the distance between the two measurement locations in fig 8a and b is 800 mm and 860 mm respectively it can be seen in fig 8a that when pile cap was entirely buried by the original bed many of the dune crests and dune trough amplitudes were significantly enlarged when approaching the location where the maximum scour depth occurred i e under the leading edge of the pile cap the coalescence of bed forms reported by radice and lauva 2017 for single piers were also observed but not as a regular mechanism during migration while most of the bed forms still tended to maintain their individual features when entering the scour hole in fig 8b when the pile cap was entirely above the original bed the scour fluctuation values were close to and slightly smaller than the corresponding bed from heights with significantly distorted crest shapes and slopes in addition a large dune crest tends to be damped and split into two or more smaller scour peaks with shorter period part of which are marked by the dashed circles this phenomenon is different to what was reported by radice and lauva 2017 for single piers that the scour fluctuations have a similar amplitude to the approaching dunes the data presented in this paper show that the relative elevation of the pile cap affects its influence on the flow field around it the pile cap may have a significant effect on the approaching bed forms the power spectra shown in fig 9 support this conclusion from another perspective specifically the spectra were computed using fast fourier transformation fft and periodogram which estimates the power from the amplitude of the fourier transformed data the computed spectra were also smoothed using savitzky golay filter with a smoothing window of 20 points about 5s to reduce the influence of spikes while maintain the original tendency in fig 9a when the pile cap is entirely above the original bed the higher frequency scour fluctuations are enhanced at the first row piles especially for period smaller than 100s it indicates that scour at this location tends to have more rapid and smaller fluctuations less than a minute which is in accord with the findings in fig 8b the spectral profile and amplitude of the approaching bed forms is otherwise maintained when they just enter the scour hole under the leading edge of pile cap in fig 9b when the pile cap is entirely buried by the original bed the fluctuation at the leading edge of pile cap shows higher power at the range of normal bed form frequencies as marked by the dashed rectangle it indicates that the approaching bed forms basically maintain their original features while showing larger amplitude this is in accord with the findings in fig 8a cross correlation analysis has been conducted to show the similarity between real time data series at different locations as shown in fig 10 and fig 11 specifically the correlation coefficients are normalized by the peak value in the first sub fig i e figs 10a and fig 11a to show the decline of the correlation level fig 10 shows cross correlations when the pile cap was entirely above the original bed the bed forms had very little deformation when migrating within an undisturbed region fig 10a showing a distinct peak with much weaker sub peaks in fig 10b the correlation between upstream bed form and scour fluctuation under the pile cap s leading edge was weakened with a lower but still distinct main peak this implies that the bed forms entering the scour hole underwent deformation to some extent but the basic shapes and periods were still maintained however in fig 10c no distinct peak can be found in the expected range while general fluctuation is weaker than the other two subplots this means that the bed forms original shapes and individual features were entirely destroyed on the short path from the pile cap to the first row piles it also supports the conclusion made from figs 8b and 9a confirm that the pressurized flow under the pile cap distorts the approaching dunes fig 11 shows cross correlations when the pile cap was entirely buried by the original bed the strong correlations resemble those in fig 10a and b confirming that bed forms tend to maintain their original shapes when approaching the leading edge of the pile cap however the vertical piles supporting the pile cap were buried most of the time and thus the maximum scour depth and the greatest fluctuation in scour depth both occurred at the leading edge of the pile cap rather than at the first row piles the phenomenon stated in this section indicates that the relationship between bed level variations at upstream bed and the pier is affected by the relative pile cap elevation which is also presumed to affect the flow field around the pier in general the deformation of approaching bed forms is affected by the bed form size the equilibrium scour depth and the pier s structure for example an extremely slender pier with negligible scour inducing flow structures e g horseshoe vortex can hardly deform the approaching bed forms so that the fluctuation in front of the pier will be equal to the bed form size the pier size to bed form size ratio or the ratio of d s a v h b is a key factor that determines the potential extent of bed from deformation in the scour hole and the magnitude of scour fluctuation our laboratory studies in recent years show that a functional relationship between d s a v h b and δ d s h b is apparent i e larger d s a v h b in general leads to smaller δ d s h b for scour at common structures the observed δ d s h b for single uniform piers are usually no larger than 1 0 while the amplified fluctuation for deeply buried complex piers in this study occurs specifically for structures that can produce flow pressurization since that the effect of d s a v h b is not significant in this study more works are expected to further investigate this relation in the future 5 2 variation of scour mechanism with bed form migration beheshti and ataie ashtiani 2006 2010 investigated the flow field at complex bridge pier on a fixed flat bed and a scoured bed under clear water flow regime it was found that the main flow features producing scour come from the interaction between separate flows created by the pier components fig 12 has been prepared for this paper to illustrate the main flow features the flow approaching the pile cap is deflected upward and downward by the pile cap s frontal face the downward flow is then pressurized by the pile cap and accelerated toward the vertical pile flow 2 with amplified turbulence energy while the upward flow interacts with the down flow created by the column flow 1 around the top of the pile cap and is then deflected laterally the deflected flows meet at the both sides of the pile cap and produce vortices flow 3 counter clockwise on the right hand side entraining and carrying sediment at the both sides in addition the flow coming out from the space under the pile cap meets the downward flow behind the pile cap and produce another vortex flow 4 entraining the sediment particles the exposed vertical piles can also produce separate down flow and horseshoe vortex flow 5 at the bottom enhancing the scouring effect by flow 2 beheshti and ataie ashtiani s works identified flow 2 as the most important flow feature for scour development and its scouring capacity was found to be inversely proportional to the height between the pile cap and the bed besides when the bed level is higher than the bottom of the pile cap i e partially buried flow 2 will be replaced by a typical horseshoe vortex system caused by the downward flow deflected by the pile cap s face this phenomenon can also be observed in the study and more detailed explanations will be given in the following paragraphs in the present study no flow measurement or visualization could be made due to the high flow velocity and the corresponding sediment suspension and aeration around the piers however possible explanations are given according to the observed fill erosion processes and the reported flow mechanism by beheshti and ataie ashtiani 2010 2016 fig 13 prepared for the present paper shows schematic drawings of the flow field in front of a pier with a completely buried pile cap as it varies over five stages of scour hole fluctuation the sediment volume marked as red and green represent the first and the second dune crests in fig 13a a scour maximum occurs when one of the dune troughs passes the front face of the pier at this stage the space under the pile cap has been cleared by the scour mainly caused by the flow deflected downwards when the following dune crest approaches and collapses into the scour hole as shown in fig 13b the scour hole is filled by the incoming sediment quickly in spite of this high scour capacity while the pressurized flow also diminishes once the pile cap is undercut as a result the scour capacity is weakened when the incoming sediment fills the space under the pile cap further deposition then elevates the bed to be flush to the pile cap s top as shown in fig 13c the remained sediment supply will be quickly removed downstream along the top of the pile cap top without accumulating at this stage the scour capacity is minimized as the main flow features responsible for scour the downward flow the pressurized flow under the pile cap and the vortices caused by the pile cap s frontal face have all disappeared after the dune crest completely passes the pier face in fig 13d the approaching dune trough again lowers the bed level in front of the pier and significantly reduces the sediment supply while the scouring capacity is enhanced accordingly especially after the pile cap s face is entirely exposed eventually in fig 13e a complete cycle ends when a new dune trough reaches the pier s face with the similar deep scour and pile cap exposure as fig 13a it should also be noted that fig 13 is only schematic and does not show exactly the same phenomenon occurring in real scour scenarios the scour rate beneath the pile cap may not be at the same rate of bed from migration and thus the processes shown in fig 13 may be slightly different if the migration speed increases relative to the scour rate or vice versa the randomness of bed form may also influence the bed response in every single cycle fig 14 provides a typical data record test s5 5 showing how scour developed with the pile cap being entirely buried by the original bed as in fig 13 the data support the above inferences about the flow mechanism from another perspective in fig 14 a typical cycle of scour variation is highlighted with five marked stages corresponding to the five stages illustrated in fig 13 the stage of a b and d e represent the processes of the flow path under the pile cap being steadily buried and rapidly excavated during bed form migration stage c is a quasi steady condition that often occurs when the bed is elevated to the top of pile cap sediment supplied from upstream moves downstream quickly without further accumulation creating undulant and sustained flat peaks as marked by the brackets the maximum accumulation rate and the maximum erosion rate both usually occur from when the bed elevation passes the bottom of the pile cap dashed horizontal line indicating that the exposure of any part of the pile cap increases the capacity for scour the scour fluctuations are generally much larger than the upstream bed form heights a similar process termed tunnel erosion was reported by sumer and fredsøe 2002 for scour at pipelines the small gap between the pipeline and the bed at the initiation of scour leads to the amplification of bed shear stress and flow velocity and a tremendous increase of sediment transport rate to summarise in contrast to single piers the scouring capacity of complex piers tend to vary as a series of bed forms pass the scour hole this variation is enhanced when the pile cap can be buried and then uncovered by the approaching bed forms the enhancement or weakening of the scouring capacity originates with the decrease or increase of upstream sediment supply and depending on the elevation of the pile cap there may be enlarged scour fluctuation compared to the upstream bed forms therefore this study indicates that when bridge designers calculated design scour depths they need to allow for scour aggravation caused by bed form migration it is also worth mentioning that for live bed scour at single piers the response of bed morphology to bed form migration tends to follow more regular and predictable patterns in general for slender piers the typical drawing elongation deceleration process chiew 1984 is observed as bed forms pass the scour hole with their integrity maintained for large piers the incoming bed forms are totally destroyed and then collapse into the scour hole in the form of periodic sediment replenishments with much less magnitude the flow condition is also a key factor for both single and complex piers the scour fluctuations occurring with transitional flat bed or antidunes i e very high flow intensity are expected to be significantly different from our experiments although those conditions are rare for pier scour furthermore fine ripple forming or coarse gravel like bed materials or cohesive sediment e g silt or clay do not produce the typical dune like bed forms in this study and thus the influence of scour fluctuation might be minor the wave induced submarine ripples also do not produce significant scour fluctuation due to their small sizes and low migrating celerity generally the conclusion drawn in this section are subjected to limitations and should be treated with caution 6 scour prediction 6 1 existing scour predictors for complex pier so far the hec 18 arneson et al 2012 method and the sheppard melville s m method sheppard et al 2011 are the most widely used prediction methods for local scour at bridge piers specifically the s m method is recommended by sheppard et al 2014 and ettema et al 2017 as the most accurate method and one that is more readily adapted as further information becomes available for complex bridge piers the hec 18 method provides an independent set of equations for calculation of equivalent pier width while the s m method needs the prior calculation of equivalent pier width using equations from other sources specifically equivalent pier width is the diameter of an equivalent circular pier that can lead to the same scour depth as the target complex pier two sets of equations for equivalent pier width have been proposed by sheppard and renna 2010 fdot scour manual and coleman 2005 respectively yang et al 2018 evaluated the performance of combining the s m method with each of these two methods the results showed a better accuracy for aligned complex piers with the combination s m coleman and for skewed complex pier with the combination s m fdot a new equation for equilibrium scour depth was also proposed by yang et al 2018 based on the original s m method for clear water scour at skewed complex bridge piers these four combinations of prediction methods were selected to evaluate their performances in the present study as shown in table 3 it should be noted that in method 3 the equation by yang et al 2018 was developed only for clear water scour thus an extension of this equation to the live bed range of this method was necessary for this study 6 2 extension of the equation from yang et al 2018 yang et al 2018 proposed a new set of equations according to the original sheppard melville method for complex bridge piers with typical structure and in the clear water flow regime u u c 1 the equation can be expressed as follows 1 d s e d e 3 17 f 1 f 2 f 3 2 f 1 t a n h y 0 d e 0 65 3 f 2 1 1 2 l n u u c 2 4 f 3 d e d 50 69 25 d e d 50 0 34 0 14 d e d 50 1 41 where d s e equilibrium scour depth i e mean scour depth d s a v at equilibrium stage for live bed scour y 0 flow depth d e equivalent pier width and d 50 median diameter of sediment particles to extend the equations to the live bed flow regime u u c 1 the framework of the original sheppard melville method is applied with modification to take the full range of flow intensity into account the new extended equations can be expressed as below when 1 u u c u l p u c 5 d s e d e f 1 2 3 1 u u c u l p u c u l p u c 1 1 1 3 17 f 3 u u c u l p u c u l p u c 1 1 1 when u u c u l p u c 6 d s e d e 2 3 f 1 7 u l p m a x 5 u c 0 6 g y 0 specifically u l p represents the flow velocity where the bed form is washed out i e the transitional flat bed condition many researchers including chee 1982 melville 1984 and chiew 1984 have found a scour peak occurring under this bed regime for single piers i e the live bed peak with the extension as listed above method 3 of table 3 can be used to predict scour depth at complex bridge piers under both clear water and live bed flow regimes 6 3 evaluation of predictors the existing predictors listed in table 3 are compared for each test series in the present study in fig 15 method 4 the hec 18 method produces an unrealistic trend the predicted scour depth at the clear water threshold is realistic but there is a rapid increase in scour depth with increasing flow intensity after entering the live bed flow regime this is because the equation of the hec 18 method includes the channel froude number rather than flow intensity ratio u u c when taking flow velocity into account method 1 and method 2 are based on the original framework of the sheppard melville method with alternative input of equivalent pier width for each method the results show that method 2 is more accurate than method 1 when the pile cap is near or buried by the original flat bed s3 s6 for other series s1 s2 s7 the results of method 1 and method 2 are similar due to the two methods calculating the same pier equivalent width these results show the equation of coleman 2005 giving the more realistic value of pier equivalent width for complex bridge piers aligned to the approaching flow as found by yang et al 2018 generally method 1 and method 2 were designed to envelop both the scour peaks at clear water and live bed transitional flat bed stage while the scour depth between the two peaks is approximated using a linear relation obviously the accuracy of enveloping is dependent on pier configuration in the present study and is not satisfactory by comparison the equation proposed in the present study method 3 predicts a more natural and realistic trend including both of the scour peaks and the descend ascend trend after entering live bed flow regime in addition estimation of the scour depth at clear water threshold underestimated by method 2 has also been improved several statistical indicators were selected for a quantitative test of the accuracy of the four methods table 4 these indicatots included the root mean square error rmse mean absolute percentage error mbpe the number of data above the 30 error line p30 the number of data below the perfect agreement line m0 the number of data below the 10 error line m10 and the mbpe of the under estimated data mbpe m0 method 3 gave slightly larger rmse and mbpe values than method 2 while the number of under estimated data especially those below the 10 error line was significantly reduced the mbpe value of data under estimated by method 3 was also 50 smaller than the corresponding value for method 2 for these data method 3 was generally more accurate with a more natural scour trend and therefore provided a larger safety margin by reducing under estimation it should also be noted that method 3 has been shown by yang et al 2018 to be more suitable for clear water scour at skewed complex piers and thus is extended in the present study to cover the full range of flow intensity ratio u u c this method can also be more readily modified when further live bed scour data become available in addition this method should be used for situations with the values of y 0 d e and y 0 t similar to or large than those used in this study extra cautions should be exercised for an unusually small flow depth to pier size ratio e g y 0 d e 0 2 or large pile cap thickness relative to the flow depth e g y 0 t 1 which may lead to a flow mechanism different from that discussed in this paper 7 conclusion this paper is focused on live bed scour at complex bridge piers with bed form migration about which no available information has been reported yet melville and coleman 2000 as well as other more recent studies mentioned in the introduction section only proposed solutions for complex piers under clear water condition the conclusions drawn in this paper are listed below 1 at a complex pier the variation of mean scour depth d s a v with flow intensity ratio depends on the pile cap elevation h c and may differ from the typical descend ascend trend found with a single pier thus the existence and size relationship of both the scour peaks at the clear water threshold and the transitional flat bed stage are significantly also different for complex bridge piers 2 at complex piers in live bed conditions scour depth fluctuates the mean scour fluctuation δ d s depends on the relative pile cap position when the pile cap is completely buried by the original bed δ d s may be much larger than the upstream bed form height 3 synchronous measurements power spectra analysis and cross correlation analysis of bed elevation data both near the pier and at on the upstream channel bed indicate that when the pile cap is completely buried by the original bed bed forms approaching the scour hole may be significantly magnified at the pile cap s leading edge while still keeping their individual form resulting in high scour fluctuation when the pile cap is above the original bed the approaching bed forms are typically destroyed among the vertical piles showing less correlation with upstream bed forms the destroyed bed forms bring more rapid flotations with smaller periods under such circumstances the mean scour fluctuation is found to be slightly less than the bed form height upstream 4 scour depth as well as flow field at complex bridge pier vary with the arrival of the upstream bed forms the pile cap plays an important role when the pile cap is entirely buried by the original bed scour fluctuation is enlarged due to the cyclic exposure burial of the pile cap in such a cycle decreased or increased sediment supply lowers or elevates the bed level at the pier and then further increases or decreases the flow s scouring capacity 5 a new method is proposed according to the equation from yang et al 2018 to calculate the mean scour depth at a complex bridge pier under the live bed flow regime u u c 1 the new method is found to provide better accuracy and less underestimation than the existing methods and is more suitable for further improvement when more data for live bed scour at skewed complex piers become available the natural trend of d s a v as a function of u u c can also be better represented 6 it should also be noted that many different geometric designs for complex bridge piers are built and the scour design approach may need to vary for the different complex pier designs ettema et al 2017 emphasized that actual pier designs should be scour tested although the general trends reported in the present paper can be applied to all pier designs physical testing may still be needed credit authorship contribution statement yifan yang conceptualization investigation methodology data curation writing original draft writing review editing bruce w melville supervision conceptualization writing review editing graham h macky conceptualization methodology writing review editing asaad y shamseldin writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the first author would like to thank china scholarship council csc for the financial support and the love and care from dr yu huang 
20611,in this study the monopile of a 10 mw offshore wind turbine owt is designed for a specific ocean site and a new soil structure interaction ssi framework is developed for the aero servo hydro elastic code fast taking the dtu 10 mw owt as the prototype a bladed style controller is developed to regulate the rotor speed and blade pitch angle and its performance is evaluated by comparisons with the dtu original controller subsequently an ssi analysis model is established for fast using the nonlinear winkler foundation model and this module is verified by the analysis results obtained from gl bladed software in addition the monopile of this 10 mw owt is designed for layered sand adopting the metocean data from the north sea the soft stiff design philosophy is used in this task and the 1st order natural frequency of the system is 0 22 hz lying in the middle of 1p and 3p frequency bands of owt besides the dynamic response and fatigue damage of this 10 mw monopile supported owt are investigated using the fully coupled model the results show that ssi effect and time variant blade pitch angle significantly influence the dynamic response of owt and fatigue life of the monopile keywords dynamic response analysis 10 mw offshore wind turbine fully coupled model controller soil structure interaction nomenclature f 0 1st natural frequency of wind turbine f c corner frequency of filter f e excitation frequency f yk characteristic yield strength k 0 initial modulus of subgrade reaction p soil reaction force p u soil ultimate bearing capacity t time t p pile wall thickness daf dynamic amplification factor d p pile diameter eog extreme operating gust ess extreme sea state etm extreme turbulence model ewh extreme wave height f mudline shear force amplitude f r horizontal load capacity of foundation i p pile s second moment of area jd drivetrain inertia cast to low speed shaft jg generator inertia relative to high speed shaft jr rotor inertia k d derivative gain k i integral gain k p proportional gain k l lateral stiffness of foundation k r rotational stiffness of foundation k lr cross coupling stiffness of foundation l p pile embedded length m mudline bending moment amplitude m r moment capacity of foundation m u mudline bending moment of monopile for ultimate limit state ng gearbox ratio nss normal sea state ntm normal turbulence model nwh normal wave height p 0 rated mechanical power t a aerodynamic torque of rotor t g generator torque v mean wind speed at hub height γ effective soil unit weight γ m material factor γ sat unit weight of saturated soil ξ damping ratio η r height of hub pertaining to mean sea level θ full span blade pitch angle δ t time step ω 0 rated angular velocity of low speed shaft 1 introduction offshore wind energy is rich because of the strong and stable wind and its exploration brings less visual impacts it is predicted that the installed capacity of owts may grow from 6 gw in 2019 to 15 gw by 2024 gwec 2020 to reduce the levelized cost of wind power large scale wind turbines have been installed veers et al 2019 however they are more susceptible to dynamic excitations because of the large mass of rotor nacelle assemble rna and flexibility of support structure therefore accurate dynamic analysis is crucial for the integrity and economy of owts in the harness environment and the numerical simulation method has been extensively utilized to predict their responses carswell et al 2015 wang et al 2018 zuo et al 2018 the uncoupled method was first used to investigate the dynamic behaviors of wind turbines under different loads bazeos et al 2002 dong et al 2011 in the preliminary stage the rna was replaced by a concentrated mass and the aerodynamic loads on the rotor were modelled as a quasi static concentrated force bazeos et al 2002 with these simplifications bisoi and haldar 2014 modelled the monopile of owt as a beam on nonlinear winkler foundation bnwf and emphasized that the consideration of ssi was necessary to achieve an accurate prediction for large scale wind turbines the blade is becoming more flexible and the aerodynamic loads on the rotor should be computed by aero elastic tools hansen et al 2006 computing the hub height aerodynamic loads by fast abhinav and saha 2015 established a finite element model using the hydro geotech code usfos where the soil is represented through p y t z and q z curves this model was used to explore the dynamic behaviors of owts under different loads carswell et al 2015 however the simplification of rna may bring errors to the dynamic analysis of owts for multi megawatt wind turbines higher modes of blades were essential for the seismic response analysis of the system ishihara and sarwar 2008 as the lack of details for the blade the beam element was usually used to model the rotor zhao et al 2019 recently banerjee et al 2019 analyzed the response of an owt excited by wind and wave and concluded that the blade tower coupling was also crucial for the structure response to consider the aero elastic effect aerodynamic damping was introduced into the uncoupled analysis method by viscous damper or modal damping santangelo et al 2016 chen et al 2017 zuo et al 2018 proposed a new uncoupled method where the time variant rotor speed and blade pitch angle were replaced by their average value this method has been used to analyze the dynamic responses of owts excited by wind or earthquakes zuo et al 2018 2020 while its reliability has not been evaluated up to now the dynamic response of owts excited by wind wave and other loads indicates aero servo hydro elastic coupling effect significantly jonkman and buhl jr 2005 the leading software of the wind energy community i e fast hawc2 and bladed employs the combined modal and multi body dynamics to perform the fully coupled dynamic analysis of owts jonkman and buhl jr 2005 larsen and hansen 2007 bossanyi 2011 with these codes researchers have conducted dynamic analyses of wind turbines agarwal and manuel 2009 shi et al 2012 damgaard et al 2014 where the coupling of aerodynamics elasticity hydrodynamics and foundation are considered in the time domain among the existing aero elastic codes fast is open source software and has been widely used to perform the dynamic analysis of wind turbines agarwal and manuel 2009 morató et al 2017 this software has passed gl certification and its reliability was also verified by shaking table tests and numerical simulations prowell 2011 sørum et al 2017 and researchers have conducted a series of development for this code and formed an active community it has been concluded that the ssi is crucial for the dynamic analysis of multi megawatt wind turbines therefore the development of ssi module for fast has attracted the attention of researchers jung et al 2015 customized the subroutine userptfmld to apply concentrated springs at the mudline along this line häfele et al 2016 introduced ssi matrices into the system matrices to improve the analysis model of owts with this method hübler et al 2018 addressed the incorporation of dynamic soil properties for a linearized approach and employed a piecewise response surface to determine approximated operating points in order to analyze the response of monopile embedded in the seabed directly the bnwf model was widely utilized to simulate the soil pile interaction of owts nrel utilized the linear distributed springs in fast when comparing aero elastic software but the report does not provide sufficient details jonkman and musial 2010 yang et al 2019 2019b 2020 used linear and nonlinear distributed spring to simulate ssi in fast but the development and verification were mainly used to analyze the seismic response of owts as a simplified method for pile soil interaction analysis the computation capacity of bnwf model is significantly smaller than that of the continuous model with soil elements mardfekri 2012 and it exhibits high efficiency for offshore wind turbine design where many load cases should be considered in particular the improved dynamic bnwf models can consider the dynamic contact and separation between pile and soil boulanger et al 1999 taciroglu et al 2006 and the accuracy has been verified by centrifuge tests meanwhile according to the characteristics of monopile the soil reaction curve was also improved sun et al 2020 which makes the bnwf model have a broad prospect in the field of offshore wind energy although researchers have developed several ssi models for fast to the best of authors knowledge no specific investigations have been carried out on the dynamic response of owts excited by random wind wave loads using the nonlinear distributed spring model and aero servo hydro elastic coupled method in addition the foundation structures of owts in existing studies were designed according to related specifications although it is more realistic in order to minimize the cost of wind power 10 mw wind turbines have been developed by some manufacturers however current studies on owts are mainly performed for the nrel 5 mw wind turbine wang et al 2018 zuo et al 2018 yang et al 2019 zhao et al 2020 dtu released a 10 mw reference wind turbine in 2013 bak et al 2013 as the controller of this wind turbine was developed for hawc2 existing studies were also based on this commercial software dimitrov 2016 natarajan et al 2019 velarde et al 2020 when this 10 mw wind turbine was used in fast some controlling problems were encountered nwtc 2019 in addition the support structure of this 10 mw owt has not been designed for layered ocean sites in order to address the identified research gap this study not only designs the controller and monopile for dtu 10 mw owt but also develops an ssi framework for fast code the outline of this study is as follows firstly a robust controller is designed for this 10 mw owt in order to perform the dynamic analysis using the fast code secondly the ssi analysis module is introduced into this code and verified by numerical simulations thirdly the monopile of 10 mw owt is designed for a specific marine site using the measured ocean meteorological data and the dynamic response and fatigue damage of this monopile owt are investigated using different models finally some conclusions are summarized briefly 2 controller development of dtu 10 mw wind turbine for fast the 10 mw wind turbine released by the dtu wind energy is taken as the prototype its main specifications are listed in table 1 and more details can be found in the report bak et al 2013 the original controller of this turbine developed for hawc2 hansen and henriksen 2013 has been transformed into the style supported by fast borg et al 2016 under high frequency excitation e g earthquakes the time step should be little enough to maintain the stability of numerical simulations however this controller was prone to be instability in this situation nwtc 2019 consequently a robust controller for this turbine should be developed to meet the urgent demand 2 1 development of controller in this section a new controller for the dtu 10 mw wind turbine is developed considering that the purpose of this task is not to optimize the control of this 10 mw wind turbine but to promote its application the performance of the original controller is set as the target this strategy guarantees that the analysis results using the new controller are comparable with the existing studies e g wang and larsen 2019 jalbi et al 2019 velarde et al 2020 the generator speed is taken as the feedback input which is also the selection of other wind turbines hansen et al 2005 wright and fingersh 2008 for brevity the controller developed by dtu for this 10 mw wind turbine is referred to as dtu controller 2 1 1 baseline control measurement filter to prevent the instability of the controller high frequency excitation of the control systems should be mitigated in the present study a single pole low pass filter with exponential smoothing is used to filter the measured generator speed smith 2006 and its recursion equation is 1 y i 1 α u i α y i 1 with 2 α e 2 π δ t f c where y is the filtered generator speed output measurement u is the unfiltered generator speed input α is the low pass filter coefficient i is the time step counter corner frequency f c is set as 0 2325 hz one quarter of the 1st edgewise natural frequency of the blade following the ref jonkman et al 2009 2 1 2 generator torque controller as shown in fig 1 this variable speed wind turbine has three operational regions and similar models were used by nrel wright and fingersh 2008 jonkman et al 2009 in region 1 the mean wind speed is less than the cut in wind speed and the generator torque is zero in region 2 the generator torque is proportional to the square of generator speed to hold an optimal tip speed ratio according to the report bak et al 2013 the tip speed ratio of dtu 10 mw wind turbine is 7 5 in this region which results in an optimal constant of proportionality of 83 55 n m rad s 2 in region 3 the mean wind speed is between the rated and cut out wind speed and the generator torque is inversely proportional to generator speed with a rated generator speed of 480 rpm electric power of 10 mw and generator efficiency of 94 4 bak et al 2013 the rated mechanical power and generator torque are 10 593 mw and 210 847 9 n m respectively the generator torque is saturated to 231 932 7 n m a maximum of 10 above the rated to avoid excessive overload following the recommendation of jonkman jonkman et al 2009 meanwhile a generator torque rate limit of 80 000 n m s is imposed also two transition regions are set to maintain the continuity of generator torque jonkman et al 2009 region 1½ spans the range of generator speeds between 300 rpm and 10 above this value the generator slip percentage in region 2½ is taken to be 10 following the value used in the dowec and nrel study kooijman et al 2003 jonkman et al 2009 the transitional generator speed between regions 2½ and 3 is 99 of the rated generator speed i e 475 rpm 2 1 3 blade pitch controller for operational region 3 the blade pitch regulation is performed to hold the generator power constant where a proportional integral pi controller determines the pitch angle as shown in fig 2 a single degree of freedom sdof model is established for the rotor drivetrain generator system to identify the parameters of the blade pitch controller taking the angular velocity of the low speed shaft as the basic variable the equation of motion of this system can be obtained according to the theorem of angular momentum 3 t a n g t g j r n g 2 j g d d t ω 0 δω j d δ ω where δω is the perturbation of angular velocity of the low speed shaft δ ω is the angular acceleration of low speed shaft because the generator power is constant in this operational region the generator torque is inversely proportional to the generator speed 4 t g p 0 n g ω where the rotor speed ω is the sum of ω 0 and δω similarly neglecting the oscillation of aerodynamic torque with rotor speed the aerodynamic torque can be expressed as 5 t a p θ ω 0 ω 0 where p is the mechanical power considering that the blade pitch angle variation may result in aerodynamic torque and rotor speed oscillation eqs 4 and 5 can be expanded by using the first order taylor series 6 t g p 0 n g ω 0 p 0 n g ω 0 2 δω 7 t a p 0 ω 0 1 ω 0 p θ δθ where δθ is the perturbation of blade pitch angle with proportional integral derivative pid control δθ is related to the rotor speed perturbations 8 δθ k p n g δω k i 0 t n g δωdt k d n g δ ω by setting ϕ δω and substituting eqs 6 8 into eq 3 the equation of motion of the system becomes 9 m ϕ ϕ c ϕ ϕ k ϕ ϕ 0 where m ϕ c ϕ and k ϕ are the generalized mass damping coefficient and stiffness of this sdof system respectively they can be determined by 10 m ϕ j d 1 ω 0 p θ n g k d 11 c ϕ 1 ω 0 p θ n g k p p 0 ω 0 2 12 k ϕ 1 ω 0 p θ n g k i the natural frequency ω ϕn and damping ratio ζ ϕ are expressed as 13 ω ϕ k ϕ m ϕ 14 ζ ϕ c ϕ 2 k ϕ m ϕ c ϕ 2 m ϕ ω ϕ based on the refs hansen et al 2005 2013 the differential gain kd and negative damping from the generator torque controller are neglected therefore pi gains are determined for the given value of ω ϕ and ζ ϕ 15 k p 2 j d ω 0 ζ ϕ ω ϕ n g p θ 16 k i j d ω 0 ζ ϕ ω ϕ 2 n g p θ where p θ is the blade pitch sensitivity and related to the wind speed rotor speed and blade pitch angle the blade pitch sensitivity of this 10 mw wind turbine is determined by performing a linearization analysis in fast where the uniform steady wind speeds are set as 11 4 m s 12 m s and at intervals of 1 m s until 25 m s the blade pitch angle is perturbed at each operating point and the resulted aerodynamic power variation is measured subsequently the central difference procedure is used to compute the partial derivative within fast in which the induced wake velocities are held constant jonkman et al 2009 as shown in fig 3 the sensitivity of aerodynamic power to the blade pitch angle varies over region 3 and can be accurately modelled by the linear equation 17 p θ p θ θ 0 θ k θ p θ θ 0 where p θ θ 0 is the pitch sensitivity at the rated state and θk is the blade pitch angle at which the pitch sensitivity has doubled from its value at the rated operating point i e p θ θ θ k 2 p θ θ 0 according to the linear relation between pitch sensitivity and blade pitch angle the gains are determined as 18 k p θ 2 j d ω 0 ζ ϕ ω ϕ n g p θ θ 0 g θ 19 k i θ j d ω 0 ζ ϕ ω ϕ 2 n g p θ θ 0 g θ where g θ is the dimensionless gain correction factor and depends on the blade pitch angle 20 g θ 1 1 θ θ k according to the properties and performances of the dtu 10 mw wind turbine from ref bak et al 2013 the gains of the pi controller are set as k p θ 0 0 0191 s and k i θ 0 0 00273 the damping ratio is set as 0 7 and the blade pitch rate limit is set to 8 s in absolute value this is also the blade pitch rate limit of multi megawatt wind turbines jonkman et al 2009 hansen and henriksen 2013 and the minimum and maximum blade pitch angles are set to 0 and 90 respectively 2 2 performance of the new controller a new controller has been developed for this 10 mw wind turbine considering the purpose of this study the new controller should have a similar performance to the dtu controller initially the response of this wind turbine to the uniform steady wind is investigated using these two controllers fig 4 a compares the rotor speed employing the new and dtu controllers a good consistency is achieved between them in this and the following figures new and dtu in legends represent the new and dtu controller respectively as shown in fig 4b their blade pitch angles are also similar except for the low wind speed regions in which the new controller deletes the minimum blade pitch angle requirements for the wind speed lower than 6 m s because the rotor speed and blade pitch angle obtained from the two controllers are in full agreement the generator power represented in fig 4c is also similar subsequently the performance and response of the dtu 10 mw wind turbine subjected to turbulent wind are analyzed to evaluate this new controller the turbulent wind field is generated by the turbsim jonkman 2009 the mean wind speed u η is calculated using the power law wind profile as 21 u η v η η r 0 14 where η denotes the height of the current position pertaining to the mean sea level msl the fluctuating wind velocity is assumed to be a stationary random vector field and the frequency content of the wind velocity is described using the kaimal spectrum kaimal et al 1972 stated in eq 22 22 s k f 4 σ k 2 l k v 1 6 f l k v 5 3 where f is the frequency hz subscript k refers to component along the x y and z axes σ k and l k are the standard deviation and integral scale parameter respectively the iec turbulence level b iec 2005 is selected to determine all these parameters the wind field is discretized into a 220 m 220 m vertical rectangular grid to cover the rotor plane the distance between two adjacent nodes is 10 m in both the horizontal and vertical directions to simulate the spatial dependency of the wind velocity the cross power spectral density function between nodes i and j is defined as 23 s i j f c δ r f s i i f δ s j j f where s i i f and s j j f denote the wind velocity auto spectra at points i and j respectively c δ r f is the coherence function described in iec iec 2005 24 c δ r f e x p b f δ r v 2 0 12 δ r l c 2 where δ r is the distance between the two nodes b is the coherence decrement with a value of 12 l c is the coherence scale parameter with a value of 340 2 m in the following the turbulent wind field is generated by turbsim using this model unless otherwise specified fig 5 shows time histories of hub height wind speed with a mean of 7 m s 11 4 m s and 15 m s respectively the performance of the new and dtu controller are compared in fig 6 where the value in legends refers to the average hub height wind speed when the mean wind speed at hub height is near the rated wind speed i e 11 4 m s the controlling strategies continually switch between the optimal generator speed and variable blade pitch due to the unsteady nature of wind therefore the differences in performances between the two controllers are the most significant in this operating point qualitatively the performance of the two controllers is similar considering the length of this section only a few results are listed here and more comparisons are shown in the supplementary data of this paper considering the randomness of wind 6 samples are generated for each mean wind speed to predict the response of this wind turbine according to fig 7 the average rotor speed and blade pitch angle using the two controllers separately are similar such that the generator power also achieves agreement more comparisons of the wind turbine response can be obtained from the supplementary data they all indicate that the performance of these two controllers is in full agreement in addition when the time step is 1 0 e 5 s short enough to analyze the seismic response of this 10 mw owt the controller is still stable to regulate the blade pitch angle therefore this new controller fulfills the requirement of this study and is suitable for the dynamic analysis of the 10 mw wind turbine especially for the load with high frequency e g earthquake load 3 implement of winkler foundation model for fast 3 1 development of soil pile interaction framework for fast the baseline version of fast jonkman and buhl 2005 consists of aerodyn hydrodyn servodyn and elastdyn modules the aerodyn computes the aerodynamic loads on the rotor using the blade element momentum theory where the aero elastic effect is considered the hydrodyn calculates the wave and current loads on the monopile using the morison equation and added mass method the servodyn implements the blade pitch and generator speed regulation through an external dynamic link library the elastdyn performs the dynamic analysis where the kane equation is used to establish the governing equation of motion for the wind turbine the fourth order runge kutta method an explicit time marching procedure is used for the nonlinear dynamic analysis in the time domain in order to simulate the soil pile interaction of wind turbines the bnwf approach allotey and naggar 2008 is developed in the fast code this model simplifies the soil into independent layers ignoring the interaction between the adjacent and has been widely used to simulate the soil pile interaction due to its simplicity fig 8 summarizes the framework of this user compiled code and the improvement is concentrated in the ssi module initially this module determines the constitutive relation of the springs and dampers attached to the monopile according to the site property subsequently the displacement and velocity of the monopile are passed to the springs and dampers and the constrained forces of the soil around the pile were computed finally the constrained forces of the soil are applied to the monopile by the twrload subroutine this framework makes full use of the existing modules of fast which is prone to be implemented also the improved soil spring and damper models can be easily introduced by updating their constitutive equation according to the latest development of soil pile interaction as shown in fig 9 the springs and dashpots along the embedded monopile are used to simulate the ssi in this framework the horizontal springs the p y springs in fig 9 are used to determine the lateral resistances of the soil against the monopile movements the vertical springs are used to simulate the axial interaction t z spring and end bearing capacity at the tip of the monopile q z spring the following expressions are recommended by api api 2014 in constructing p y curves for sand 25 p a p u t a n h k 0 z a p u y 26 p u s c 1 z c 2 d γ z f o r s h a l l o w d e p t h 27 p u d c 3 d γ z f o r d e e p d e p t h 28 p u m i n p u s p u d where a is a factor with a value of 0 9 for cyclic loading z is the depth of soil below mudline m y is the lateral deflection m c 1 c 2 and c 3 are dimensionless coefficients and their formulas are summarized in section 8 5 6 of the ref api 2014 in order to consider the energy dissipation of the foundation the viscous dashpot is connected in parallel with the horizontal soil springs and the dashpot coefficients are calculated following makris and gazetas 2010 29 c m 2 k s β m ω where ω is the 1st order natural angular frequency of the support structure k s is the secant stiffness of the p y curves and β m is the hysteresis damping ratio with a value of 5 for the sake of brevity only p y curves for sand are mentioned the t z and q z curves are described in section 8 4 2 and 8 4 3 of api respectively the displacement corresponding to the maximum soil monopile adhesion z peak is set as 1 of the monopile outer diameter this soil reaction curves model is still widely utilized in offshore wind energy bisoi and haldar 2014 abhinav and saha 2015 and it is out of the scope of this study to develop new soil reaction curves as a studied case the api p y t z and q z curves are used to calculate the reaction of sand to monopile deflections in fact more accurate constitutive equations of the soil spring can be conveniently introduced into this ssi module 3 2 validation of soil pile interaction framework for fast 3 2 1 models and parameters the monopile of dtu 10 mw owt introduced by yang et al 2020 is used to verify this ssi module the average water depth is 30 m and the properties of this homogeneous site are listed in table 2 because the original tower is designed for onshore environment its diameter and thickness are up scaled by factors of 1 25 and 1 3 respectively consequently the monopile diameter and thickness are changed to 9 0 m and 66 5 mm respectively more details on the support structure of the 10 mw owt are presented in section 3 1 of the ref yang et al 2020 as a widely utilized commercial software the dnv gl bladed bladed employs the combined modal and multi body dynamics bossanyi 2011 and uses the identical ssi model employed by fast in this study therefore the dynamic analysis of the 10 mw owt is performed by fast and bladed respectively to evaluate this new ssi module the first two fore aft fa and side to side ss tower modes the first two flapwise blade modes and the first edgewise blade mode are included in fast and bladed also the controller developed in section 2 1 is employed by fast and bladed the turbsim code is used to generate turbulent wind fields that are applied to fast and bladed both fast and bladed generate the random wave fields however neither of them can directly import the wave fields the water is still in simulations to prevent differences in wave fields the bladed does not supply the foundation damping model directly and an equivalent damping ratio should be added to the tower mode taking the damping model of eq 29 and the method proposed by chen and duffour 2018 the first order modal damping ratio of the tower caused by foundation damping is about 1 5 which is added to the tower and the time step is set as 0 005 s in numerical simulations of this section 3 2 2 response of 10 mw monopile owt excited by wind firstly the 10 mw owt responses to uniform steady wind are analyzed using fast and bladed respectively fig 10 compares the tower top displacement and mudline bending moment in the fa direction for different wind speeds the results simulated by the two codes are in good agreement other response indicators of the support structure and blades also have this characteristic therefore under the uniform steady wind excitation the ssi module established in this study has sufficient accuracy subsequently the 10 mw owt responses to the turbulent wind are analyzed using the two codes respectively where 6 wind samples are generated for each mean wind speed the tower top displacement and mudline bending moment amplitudes of the fa direction are shown in fig 11 where they are averaged pertaining to wind samples the differences between them are minor such that this new ssi framework has sufficient accuracy as bladed the maximum error in figs 10 and 11 is less than 6 which is within the margin of practical engineering and further comparison indicates that the error is related to the difference of foundation damping models in the two codes considering that the api soil reaction curves used in the examples of this paper have been widely utilized the validations of ssi model are performed for the overall reliability of this framework without verification of api p y t z and q z curves 4 dynamic response of 10 mw owt 4 1 preliminary design of the monopile for 10 mw owt although the monopile of the dtu 10 mw owt in the homogeneous sand was designed velarde 2016 wang and larsen 2019 yang et al 2020 few studies were performed for the layered sand which is more universal in ocean engineering and the dynamic analysis of a well designed monopile supported owt is representative therefore the monopile of the 10 mw owt is designed for the layered sand in fig 12 this site has been widely used in dynamic analysis of owts e g oc3 project of nrel jonkman and musial 2010 the design requirements of api dnv iec and gl api 2014 dnv 2005 2010 2013 gl 2005 iec 2005 2009 are adopted in this study and part of them are shown in table 3 the wind and wave conditions of ijmuiden munitiestort from the upwind project are used and the design process is illustrated in appendix a to meet all the requirements of table 3 the monopile dimensions are d p 7 8 m t p 85 mm and l p 39 m considering that it is challenging to perform fatigue analysis in the time domain using this simplified design method a detailed fatigue analysis is carried out in section 4 2 2 4 2 dynamic response of 10 mw owt the responses of this 10 mw owt to random wind and wave are analyzed using the fast code updated in section 3 4 2 1 dynamic response excited by stochastic wind and wave the load cases lcs used to perform the dynamic analysis of 10 mw owt are shown in table 4 ti is the turbulence intensity of the wind h s and t p are the significant wave height and peak spectral period of the incident wave respectively and p f represents the occurrence probability these lcs lumped from the measured data of ijmuiden munitiestort site bredmose et al 2012 have been used to analyze the dynamic response and fatigue damage of owts løken and kaynia 2019 it is noticeable that the monopile of 10 mw owt is also designed for this site therefore the dynamic analysis of this wind turbine is site specific for loadings and support structure which is more realistic for lcs 2 12 the owt is in operational conditions while the owt is parked for lc1 and lcs 13 17 for operational state the controller developed in section 2 is used to regulate the rotor speed and blade pitch angle for parked state the blade pitch angle is set to 90 the rotor speed is set to 0 and the generator is turned off the hydrodynamic loads are computed by the hydrodyn code where the jonswap wave spectrum is used fig 13 shows the samples of wave elevation and hub height wind speed for lcs 3 6 and 9 the responses of 10 mw owt excited by these wind and wave fields are compared in fig 14 the tower top displacement and mudline bending moment amplitudes are the largest for lc6 which has a mean wind speed of 12 m s close to the rated wind speed of this wind turbine considering the randomness of wind 6 samples are generated for each mean wind speed following the requirement of dnv dnv 2013 some statistics of tower top displacement and mudline bending moment the mean and standard deviation sd minimum and maximum are displayed in fig 15 for different average wind speed for all these statistics the amplitude occurs in lc6 which has a wind speed of 12 m s close to the rated speed this is consistent with the conclusion that the highest wind loads are expected to occur at the rated wind speeds jonkman 2007 meanwhile influenced by the controller the responses of owt do not monotonically increase with the mean wind speed which is different from the responses of traditional marine structures subsequently to evaluate wind and wave contribution the individual responses of owt to wind only and wave only are computed and the mudline internal force amplitudes are compared in fig 16 for shear force the amplitudes caused by wind are larger than those caused by waves when the wind speed is between 8 m s and 12 m s when the average wind speed is beyond this range the mudline shear force amplitudes caused by wave are greater than those caused by wind especially when the wind speed exceeds 18 m s the mudline shear force amplitudes caused by wave loads are significantly larger than those induced by wind for mudline bending moment the moment arm of wind load is much larger than that of wave load the mudline bending moment amplitudes caused by the wave are larger than those caused by wind when the owt is in the parked state 4 2 2 influence of controller as shown in fig 17 the rotor speed and blade pitch angle oscillate in the time domain due to turbulent wind characteristics yuan et al 2020 believed that the controller significantly influences the seismic response of wind turbines in operational conditions however the existing structural analysis tools cannot directly simulate the servo elastic coupling between the control system and structure consequently zuo et al 2018 proposed a simplified method where the average rotor speed and blade pitch angle are used to compute the aerodynamic loads on the rotor this attractive method has been performed in abaqus to analyze the dynamic response of owts zuo et al 2018 2020 in this section the comparisons between this simplified method and the fully coupled method are performed to evaluate its reliability because the controller works when the wind turbine is in operation only the lcs 2 12 are employed in the analysis the tower top displacement and mudline bending moment obtained from the coupled and simplified methods are compared in fig 18 obviously the differences between them are significant the statistics of mudline fa bending moment resulted from these two methods are shown in fig 19 the maximum relative error of mean maximum and sd of mudline bending moment between the two models are 1 7 43 5 and 88 1 respectively therefore the simplified method has sufficient accuracy in predicting the average response of wind turbines while the errors are significant for the maximum and sd of mudline bending moment for the simplified model the blade pitch angle is set as constant in the simulation which may overestimate the maximum aerodynamic load 4 2 3 influence of ssi in this section the influence of ssi on this 10 mw monopile supported owt is discussed through the comparisons on the structural response as shown in fig 20 two analysis models are applied the first is the ssi model developed in section 3 1 the second model only includes the part of owt above the mudline and it is assumed that the structure is fixed at the bottom the tower top displacement and the mudline bending moment obtained by using these two models are compared in fig 21 overall the amplitudes of tower top displacement and mudline bending moment considering the ssi are larger than those without considering this effect the differences between the analysis results of the two models with a mean wind speed of 28 m s are more significant than those with a wind speed of 12 m s the statistics of the mudline bending moment separately obtained from the two models are compared in fig 22 overall the analysis errors between the two models in the parked condition are significantly larger than those in the operational condition the maximum relative error of mean maximum and sd of mudline fa bending moment between the two models are 8 58 1 and 83 8 respectively this phenomenon may significantly influence the long term behavior of owt support structures such as fatigue damage 4 3 fatigue analysis the lifetime of wind turbines is not less than 20 years during which the support structure is suffered from load cycles of the order of 500 million løken and kaynia 2019 the fatigue may occur even though the stresses of components are far below the yield stress limit of the material compared with other engineering structures the contribution of the self weight of wind turbines to the stresses is negligible while the contribution from bending moment is significant therefore the fatigue analyses of monopile are performed according to mudline fa bending moment time series for each load case in tables 4 and 6 random wind samples are generated to take the randomness of wind into account the rainflow counting is used to determine the stress cycles for each time serie considering that the mean mudline fa bending moment for different lcs is not constant the goodman correction is performed to analyze the data as if each cycle occurred about a fixed mean load to get the lifetime 20 years fatigue of wind turbines the damage cycle counts of these time series are extrapolated according to the occurrence probability of lcs meanwhile it is assumed that the wind turbine is always producing power when the mean wind speed at hub height is between cut in and cut out speeds the ultimate strength of the steel used for the dtu 10 mw substructure is assumed to be 440 mpa and the corresponding ultimate load is 1720 mn m the palmgren miner rule is used to predict fatigue damage and is given as 30 d i n i n i where d is the lifetime fatigue damage n i is the cycle count at stress level i and n i is the number of cycles to failure at stress level i the fatigue analysis of the 10 mw monopile supported owt is performed using mlife code developed by nrel hayman and buhl 2012 the load bin width is set to 200 n m and the fixed mean load is specified as the aggregate mean across all input files following the recommendation of det norske veritas dnv 2005 wohler exponent m is set as 5 in this analysis more details of the fatigue analysis method have been illustrated in the theory manual hayman 2012 the fatigue damage of each lc is described by the normalized fatigue damage η j 31 η j d j st d j st max where d j st is the accumulated damage from time series corresponding to lc j d j st max is the maximum of d j st for all lcs the normalized fatigue damage of different lcs is shown in fig 23 a the fatigue damage increases with wind speed on the whole with two slight variations related to the blade pitch regulation the first change occurs between lc6 and lc7 due to the influence of blade pitch regulation when the owt is in operational condition the maximum and sd of mudline bending moment are the largest for lc6 as shown in fig 15 the second variation is between lc12 and lc13 for lc12 the wind turbine is in operational condition while it is in the parked state for lc13 therefore the average bending moment at the mudline reduces from 79 5 mn m to 2 7 mn m leading to less fatigue damage in order to evaluate the contribution of different lcs to the lifetime fatigue of wind turbines their occurrence probability is taken into account the normalized fatigue damage contribution is defined in eq 32 and shown in fig 23b 32 ζ j d j st p v j d j st p v j max where p v j is the probability of lc j the fatigue damage of this owt is dominated by the lcs around the rated wind speed the lifetime fatigue damage of the monopile is 0 56 corresponding to a lifetime of 35 7 years therefore the monopile of this 10 mw owt meets the requirement of fatigue summarized in table 3 because the fatigue analysis is nonlinear it is challenging to separate wind and wave contribution directly therefore the fatigue analysis of monopile under the separate excitation of wind only and wave only is performed to evaluate their contribution the lcs are still those listed in table 4 yet the analysis only includes the corresponding wind or wave columns the lifetime fatigue damage of owt monopile caused by wind only and waves only is 0 248 and 0 239 respectively therefore both wind and wave excitations are essential in the fatigue analysis of the 10 mw owt the normalized fatigue damage and contributions for different lcs are shown in fig 24 as for the wind the mudline bending moment is relatively small when owt is parked such that the corresponding fatigue damage is close to 0 lc6 corresponding to the operational condition of wind turbines results in the most significant fatigue damage from fig 24b the contribution of lc6 to the lifetime fatigue damage of monopile for owt under the separate wind excitation reaches 50 for the wave the fatigue damage caused by each lc increases monotonously from lc1 to lc17 which is similar to the characteristics of mudline internal forces shown in fig 16 the total contribution of lcs 6 10 to lifetime fatigue damage of monopile under the separate wave excitation is 62 among which lc8 makes the most significant contribution of 17 the influence of controller and ssi on the fatigue damage of owts monopile is also investigated the lifetime fatigue damage of the monopile employing the analysis method proposed by zuo et al 2018 is 1 01 while it is 0 57 for the fully coupled method this simplified analysis method may overestimate the fatigue damage of owt significantly the lifetime fatigue damage of the monopile is 0 43 for the fixed base model which corresponds to a lifetime of 46 5 years compared with ssi model the fatigue life of the monopile is overestimated for 10 8 years i e 30 relative error due to the ignoring of soil structure interaction 5 conclusions in this paper the monopile of a 10 mw owt with a robust controller is designed based on the soft stiff philosophy its dynamic response and fatigue damage excited by random wind and wave are performed by the updated fast code where the soil structure interaction and aero servo hydro elastic coupling are considered some conclusions can be drawn as the following 1 a variable speed and collective pitch controller is developed for the dtu 10 mw owt for mean wind speeds at hub height lower than the rated wind speed the generator speed is regulated to maintain the optimal tip speed ratio for mean wind speeds higher than the rated wind speed the blade pitch angle is increased to control the aerodynamic torque the numerical simulations indicate that this controller has a similar performance to the baseline controller released by dtu but with better robustness 2 an ssi framework based on the beam on nonlinear winkler foundation is compiled in the fast code numerical examples show that this framework has sufficient precision for the dynamic analysis of wind turbines compared with the gl bladed software this method is carried out through the existing tower load module of fast such that it is prone to be implemented and updated e g introducing more accurate soil reaction curves 3 the monopile of this 10 mw owt is designed by a simplified method for the typical ocean site with the measured metocean data in the north sea the design utilizes the soft stiff philosophy and the 1st order natural frequency of the system is 0 22 hz lying in the middle of 1p and 3p frequency bands meanwhile this design also meets the requirements of ultimate limit state serviceability limit state and fatigue limit state 4 the dynamic analysis of this monopile supported 10 mw owt is performed using the updated fast code for this studied case the unsteady rotor speed and blade pitch angle induced by turbulent wind influence the maximum mudline bending moment of monopile especially as the mean wind speed is between the rated and cut out wind speed this leads to an overestimation of 90 on lifetime fatigue damage of the monopile when neglecting the unsteady nature for this numerical example the ssi exhibits a significant influence on the mudline bending moment amplitude and fatigue life of the monopile in this study the api soil reaction curves are used to simulate soil structure interaction for future work new soil reaction curves should be introduced into this framework to simulate the dynamic ssi more accurately such as considering the dissipation of pore pressure in cohesionless soil including all degrees of freedom of pile section also the results of this numerical tool should be compared with experimental results to validate its reliability credit authorship contribution statement renqiang xi conceptualization methodology data curation writing original draft preparation software xiuli du methodology conceptualization supervision resources visualization piguang wang investigation writing reviewing and editing validation chengshun xu methodology data curation endi zhai methodology data curation suyu wang methodology declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is funded by the national natural science foundation of china and the grant numbers are 51808061 and 51722801 the results and conclusions presented are of the authors and do not necessarily reflect the view of the sponsors the authors would like to give special thanks to dr jason jonkman of the national renewable energy laboratory whose guidance and recommendations have been of great importance in achieving the present results the first author is especially grateful for the discussion with dr yang at university of shanghai for science and technology during this work appendix b supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix b supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2021 109346 appendix a the specifications api 2014 dnv 2005 2010 2013 gl 2005 iec 2005 2009 describe hundreds of lcs that need to be considered to ensure the integrity of wind turbines however in terms of foundation design not all these cases are relevant or significant and the most severe lcs are listed in table a1 according to the ref arany et al 2017 table a1 representative environmental scenarios as load cases chosen for foundation design table a1 name and description wind model wave model alignment e 1 normal operational conditions ntm at ur u 1 1 year ess w 1 collinear e 2 extreme wave load scenario etm at ur u 2 50 year ewh w 4 collinear e 3 extreme wind load scenario eog at ur u 3 1 year ewh w 2 collinear e 4 cut out wind speed and extreme operating gust scenario eog at uout u 4 50 year ewh w 4 collinear e 5 wind wave misalignment scenario etm at ur u 2 50 year ewh w 4 the operational range of this owt is 6 9 6 rpm and its 1p and 3p frequency bands are 0 10 0 16 hz and 0 30 0 48 hz respectively considering the uncertainty of the analysis model dnv 2002 recommends that the natural frequency should be at least 10 away from 1p and 3p frequenciy bands therefore the natural frequency of this 10 mw owt should be between 0 176 hz and 0 27 hz and the desired natural frequency is chosen to be 0 22 hz the simplified method proposed by the ref arany et al 2017 is used to design the monopile of this owt a 1 input data this study uses the wind and wave conditions of ijmuiden munitiestort from the upwind project upwind to get a realistic design the average water depth of this site is 21 m which is suitable for the monopile foundation bredmose et al 2012 its climate data has been measured for 22 years and the parameters used in this simplified design are summarized in table a2 more data can be obtained from a report of upwind fischer et al 2010 table a2 metocean data table a2 parameter symbol value unit wind speed weibull distribution shape parameter s 1 97 wind speed weibull distribution scale parameter k 11 73 m s reference turbulence intensity i 14 turbulence integral length scale l k 340 2 m density of air ρ a 1 225 kg m3 significant wave height with 50 year return period h s 8 24 m peak wave period t s 10 97 s mean surface line msl 21 m density of sear water ρ w 1030 kg m3 a 2 wind wave load and pile dimensions the design load of ultimate limit state uls is used to determine pile dimensions however considering that the wave load is related to monopile diameter the wind load on the rotor is computed to guess initial pile dimensions adopting the simplified formulas summarized by arany et al 2017 the wind loads and mudline internal forces of monopile are computed and listed in table a3 table a3 load and bending moment for wind scenarios table a3 parameters unit scenario u 1 scenario u 2 scenario u 3 scenario u 4 standard deviation of wind speed m s 1 98 3 07 standard deviation in f f1p m s 0 64 0 99 turbulent wind speed component m s 0 82 1 99 8 24 6 39 maximum force mn 1 40 1 68 3 62 0 88 minimum force mn 1 22 1 22 1 22 0 56 mean force without turbulence mn 1 05 0 83 0 14 0 31 maximum moment mn m 196 236 507 123 minimum moment mn m 170 170 170 78 mean moment without turbulence mn m 147 117 18 1 43 the maximum mudline bending moment of monopile induced by wind m u is 685 mn m after applying a load factor of γ l 1 35 according to the recommendation of api 2005 it is assumed that a1 t p 6 35 d p 100 the diameter of monopile d p can be determined by eq a2 a2 σ m m u i p d p 2 f y k γ m with f y k 355 m p a and γ m 1 1 eq a2 gives initial pile dimensions d p 6 5 m and t p 72 m m considering the wall thickness of the transition piece and its gap between monopile the total diameter of substructure is set as 6 8 m table a4 summarizes the wave height and periods of different scenarios the monopile wave load is computed using the method proposed by arany et al 2017 and listed in table a5 table a4 wave heights and wave periods for different wave scenarios table a4 parameters scenario w 1 scenario w 2 scenario w 3 scenario w 4 wave height m 6 05 11 31 8 24 15 41 wave period s 10 12 11 81 10 97 13 78 table a5 load and bending moment for wave scenarios table a5 parameters scenario w 1 scenario w 2 scenario w 3 scenario w 4 total wave load mn 2 03 5 66 3 34 9 90 total wave moment mn m 34 110 60 220 according to the representative lcs in table a1 the wind and wave load are combined and the resulted uls loads with a load factor of γ l 1 35 are summarized in table a6 the load scenario e 3 is the driving case for this example and the maximum moment is 833 mn m the updated total loads are used to recalculate the foundation dimensions by eq a2 which results in new pile dimensions d p 6 9 m t p 78 mm velarde 2016 concluded that no significant change in natural frequency occurred from pile embedment length 10 times to 5 times d p for the monopile of 10 mw owt therefore l p is set to 5 times the diameter of the pile i e 35 m table a6 uls load combinations table a6 parameters e 1 e 2 e 3 e 4 e 5 maximum wind load mn 1 89 2 27 4 89 1 19 2 27 maximum wind moment mn m 264 6 318 6 684 45 105 3 318 6 maximum wave load mn 2 74 13 37 7 64 13 37 13 37 maximum wave moment mn m 45 9 297 148 5 297 297 total load mn 4 63 15 63 12 53 14 55 13 55 total bendning moment mn m 310 5 615 6 833 402 3 435 56 a 3 capacity of foundation and deformation of pile it is assumed that the soil resistance increases linearly with depth the moment and horizontal load capacity of the monopile foundation can be computed by the following equations poulos and davis 1980 a3 m r f r e 2 3 f a4 f r 0 5 γ d p l p 3 k p e l p with a5 k p 1 s i n ϕ 1 s i n ϕ a6 f 0 82 f r d p k p γ where e is the load eccentricity e m f substituting the values of these parameters into eq a3 a6 the ultimate capacity of the foundation is m r 4017 mn m and f r 105 mn respectively according to eq a2 the yield bending moment of monopile m y is 907 3 mn m less than the ultimate capacity of foundation therefore the monopile will act as a long pile and f r may be calculated by eq a3 and a6 putting m r m y this results in a f r 13 6 mn they are above the total load and bending moment listed in table a6 according to the formulas proposed by poulos and davis 1980 this monopile is not a flexible or rigid pile therefore its stiffness is determined from numerical simulations referring to passon 2006 as shown in fig a1 the horizontal load f 0 is set as 9 28 mn and bending moment m 0 is 617 mn m the foundation stiffness k l k r and k lr are 2 31 gn m 306 5 gn rad and 21 1 gn respectively the deformations can be computed by ρ k r k l k r k l r 2 f k l r k l k r k l r 2 m a 7 θ k l r k l k r k l r 2 f k l k l k r k l r 2 m a 8 where ρ and θ are the displacement and the rotation angle of the monopile at mudline respectively consequently deflections ρ and rotations θ are 7 6 cm and 0 37 respectively fig a1 analysis model of lpile fig a1 a 4 natural frequency of the system according to the formula proposed by arany et al 2015 the fixed base natural frequency is a9 f fb 0 232 hz the natural frequency of the system is influenced by flexibility of substructure and foundation which are represented by corresponding coefficients respectively it is assumed that the monopile goes up to the bottom of the tower the tower height is 105 3 m the hub height is 119 m the nacelle is 7 4 m tall and the distance between the mudline and the bottom of the tower is 31 m following arany et al 2015 the substructure flexibility coefficient c s and foundation flexibility coefficients c r and c l are a10 c s 0 851 a11 c r 0 901 a12 c l 0 981 the formulas of these coefficients are listed in eqs 69 and 70 of the ref arany et al 2017 consequently the 1st order natural frequency of the 10 mw monopile supported owt is a13 f 0 c s c r c l f f b 0 174 hz this value is less than the limit value given in table 3 and the influence of water and soil around the monopile is not considered in this simplified method when the pile diameter is increased to 7 8 m a14 f 0 0 217 hz as a result the monopile dimensions are set as d p 7 8 m t p 85 mm and l p 39 m to consider the dynamic effect of wave load the dynamic amplification factor is calculated using the wave period listed in table a4 the structural damping of owt is set as 1 according to the ref dnv 2013 the aerodynamic damping depends on the wind speed and the fa value may be between 2 and 10 while that of the ss can be neglected the total damping ratios are the sum of structural and aerodynamic damping and they were chosen conservatively as 3 and 1 for the fa and ss directions of wind turbines respectively consequently the dynamic amplification factor is calculated as a15 d a f 1 1 f e f 0 2 2 2 ξ f e f 0 2 and the dafs for typical wave scenarios are represented in table a7 table a7 dynamic amplitude factors dafs table a7 parameters wave scenario w 1 wave scenario w 2 wave scenario w 3 wave scenario w 4 dynamic amplification fa 1 253 1 171 1 207 1 1201 dynamic amplification ss 1 255 1 172 1 209 1 204 the wave loads are recalculated considering the dynamic amplification effect of loads and then combined with the wind loads the bending moment and normal stress of monopile at mudline are listed in table a8 where the maximum mudline bending moment of monopile is 690 8 mn m the monopile strength foundation bearing capacity and deformation are checked using the updated loads and monopile dimensions the results indicate that these conditions are all satisfied for the latest pile dimensions table a8 bending moment and normal stress of monopile at mudline table a8 parameter scenario e 1 scenario e 2 scenario e 3 scenario e 4 scenario e 5 maximum moment mn m 258 1 586 5 690 8 473 7 422 6 minimum moment mn m 61 8 350 9 183 5 350 9 116 5 maximum stress level mpa 59 1 134 1 157 9 108 3 96 6 maximum cyclic stress range mpa 70 4 214 5 200 1 188 65 70 1 a 5 long term performance it is essential to evaluate the influences of soil stiffness evolution on the natural frequency of wind turbines fig a2 shows the change in natural frequency resulting from the variation of the coefficient of subgrade reaction for this numerical example it can be concluded that a change of 30 in soil coefficient of subgrade reaction produces less than 1 5 change in the natural frequency for this 10 mw monopile supported owt as for frequency change degradation is more critical than stiffening in this studied case fig a2 frequency change due to change in soil stiffness during the lifetime of the turbine fig a2 the simplified approach of accumulated deformation is often used in literature which is equivalent to reducing soil stiffness the coefficient of subgrade reaction n h can be reduced to account for the effects of the cyclic load broms 1964 pointed out that its reduction depends on the density of the cohesionless soil these studies suggest reducing n h by a fixed percentage 30 in davisson 1970 75 and 50 for dense and loose sand in broms 1964 when the coefficient of subgrade reaction n h is reduced by 75 the deformation of monopile at mudline will increase from ρ 4 12 c m and θ 0 12 to ρ 8 82 c m and θ 0 23 although the increase is larger than 100 the deformation is still below the limit in table 3 
20611,in this study the monopile of a 10 mw offshore wind turbine owt is designed for a specific ocean site and a new soil structure interaction ssi framework is developed for the aero servo hydro elastic code fast taking the dtu 10 mw owt as the prototype a bladed style controller is developed to regulate the rotor speed and blade pitch angle and its performance is evaluated by comparisons with the dtu original controller subsequently an ssi analysis model is established for fast using the nonlinear winkler foundation model and this module is verified by the analysis results obtained from gl bladed software in addition the monopile of this 10 mw owt is designed for layered sand adopting the metocean data from the north sea the soft stiff design philosophy is used in this task and the 1st order natural frequency of the system is 0 22 hz lying in the middle of 1p and 3p frequency bands of owt besides the dynamic response and fatigue damage of this 10 mw monopile supported owt are investigated using the fully coupled model the results show that ssi effect and time variant blade pitch angle significantly influence the dynamic response of owt and fatigue life of the monopile keywords dynamic response analysis 10 mw offshore wind turbine fully coupled model controller soil structure interaction nomenclature f 0 1st natural frequency of wind turbine f c corner frequency of filter f e excitation frequency f yk characteristic yield strength k 0 initial modulus of subgrade reaction p soil reaction force p u soil ultimate bearing capacity t time t p pile wall thickness daf dynamic amplification factor d p pile diameter eog extreme operating gust ess extreme sea state etm extreme turbulence model ewh extreme wave height f mudline shear force amplitude f r horizontal load capacity of foundation i p pile s second moment of area jd drivetrain inertia cast to low speed shaft jg generator inertia relative to high speed shaft jr rotor inertia k d derivative gain k i integral gain k p proportional gain k l lateral stiffness of foundation k r rotational stiffness of foundation k lr cross coupling stiffness of foundation l p pile embedded length m mudline bending moment amplitude m r moment capacity of foundation m u mudline bending moment of monopile for ultimate limit state ng gearbox ratio nss normal sea state ntm normal turbulence model nwh normal wave height p 0 rated mechanical power t a aerodynamic torque of rotor t g generator torque v mean wind speed at hub height γ effective soil unit weight γ m material factor γ sat unit weight of saturated soil ξ damping ratio η r height of hub pertaining to mean sea level θ full span blade pitch angle δ t time step ω 0 rated angular velocity of low speed shaft 1 introduction offshore wind energy is rich because of the strong and stable wind and its exploration brings less visual impacts it is predicted that the installed capacity of owts may grow from 6 gw in 2019 to 15 gw by 2024 gwec 2020 to reduce the levelized cost of wind power large scale wind turbines have been installed veers et al 2019 however they are more susceptible to dynamic excitations because of the large mass of rotor nacelle assemble rna and flexibility of support structure therefore accurate dynamic analysis is crucial for the integrity and economy of owts in the harness environment and the numerical simulation method has been extensively utilized to predict their responses carswell et al 2015 wang et al 2018 zuo et al 2018 the uncoupled method was first used to investigate the dynamic behaviors of wind turbines under different loads bazeos et al 2002 dong et al 2011 in the preliminary stage the rna was replaced by a concentrated mass and the aerodynamic loads on the rotor were modelled as a quasi static concentrated force bazeos et al 2002 with these simplifications bisoi and haldar 2014 modelled the monopile of owt as a beam on nonlinear winkler foundation bnwf and emphasized that the consideration of ssi was necessary to achieve an accurate prediction for large scale wind turbines the blade is becoming more flexible and the aerodynamic loads on the rotor should be computed by aero elastic tools hansen et al 2006 computing the hub height aerodynamic loads by fast abhinav and saha 2015 established a finite element model using the hydro geotech code usfos where the soil is represented through p y t z and q z curves this model was used to explore the dynamic behaviors of owts under different loads carswell et al 2015 however the simplification of rna may bring errors to the dynamic analysis of owts for multi megawatt wind turbines higher modes of blades were essential for the seismic response analysis of the system ishihara and sarwar 2008 as the lack of details for the blade the beam element was usually used to model the rotor zhao et al 2019 recently banerjee et al 2019 analyzed the response of an owt excited by wind and wave and concluded that the blade tower coupling was also crucial for the structure response to consider the aero elastic effect aerodynamic damping was introduced into the uncoupled analysis method by viscous damper or modal damping santangelo et al 2016 chen et al 2017 zuo et al 2018 proposed a new uncoupled method where the time variant rotor speed and blade pitch angle were replaced by their average value this method has been used to analyze the dynamic responses of owts excited by wind or earthquakes zuo et al 2018 2020 while its reliability has not been evaluated up to now the dynamic response of owts excited by wind wave and other loads indicates aero servo hydro elastic coupling effect significantly jonkman and buhl jr 2005 the leading software of the wind energy community i e fast hawc2 and bladed employs the combined modal and multi body dynamics to perform the fully coupled dynamic analysis of owts jonkman and buhl jr 2005 larsen and hansen 2007 bossanyi 2011 with these codes researchers have conducted dynamic analyses of wind turbines agarwal and manuel 2009 shi et al 2012 damgaard et al 2014 where the coupling of aerodynamics elasticity hydrodynamics and foundation are considered in the time domain among the existing aero elastic codes fast is open source software and has been widely used to perform the dynamic analysis of wind turbines agarwal and manuel 2009 morató et al 2017 this software has passed gl certification and its reliability was also verified by shaking table tests and numerical simulations prowell 2011 sørum et al 2017 and researchers have conducted a series of development for this code and formed an active community it has been concluded that the ssi is crucial for the dynamic analysis of multi megawatt wind turbines therefore the development of ssi module for fast has attracted the attention of researchers jung et al 2015 customized the subroutine userptfmld to apply concentrated springs at the mudline along this line häfele et al 2016 introduced ssi matrices into the system matrices to improve the analysis model of owts with this method hübler et al 2018 addressed the incorporation of dynamic soil properties for a linearized approach and employed a piecewise response surface to determine approximated operating points in order to analyze the response of monopile embedded in the seabed directly the bnwf model was widely utilized to simulate the soil pile interaction of owts nrel utilized the linear distributed springs in fast when comparing aero elastic software but the report does not provide sufficient details jonkman and musial 2010 yang et al 2019 2019b 2020 used linear and nonlinear distributed spring to simulate ssi in fast but the development and verification were mainly used to analyze the seismic response of owts as a simplified method for pile soil interaction analysis the computation capacity of bnwf model is significantly smaller than that of the continuous model with soil elements mardfekri 2012 and it exhibits high efficiency for offshore wind turbine design where many load cases should be considered in particular the improved dynamic bnwf models can consider the dynamic contact and separation between pile and soil boulanger et al 1999 taciroglu et al 2006 and the accuracy has been verified by centrifuge tests meanwhile according to the characteristics of monopile the soil reaction curve was also improved sun et al 2020 which makes the bnwf model have a broad prospect in the field of offshore wind energy although researchers have developed several ssi models for fast to the best of authors knowledge no specific investigations have been carried out on the dynamic response of owts excited by random wind wave loads using the nonlinear distributed spring model and aero servo hydro elastic coupled method in addition the foundation structures of owts in existing studies were designed according to related specifications although it is more realistic in order to minimize the cost of wind power 10 mw wind turbines have been developed by some manufacturers however current studies on owts are mainly performed for the nrel 5 mw wind turbine wang et al 2018 zuo et al 2018 yang et al 2019 zhao et al 2020 dtu released a 10 mw reference wind turbine in 2013 bak et al 2013 as the controller of this wind turbine was developed for hawc2 existing studies were also based on this commercial software dimitrov 2016 natarajan et al 2019 velarde et al 2020 when this 10 mw wind turbine was used in fast some controlling problems were encountered nwtc 2019 in addition the support structure of this 10 mw owt has not been designed for layered ocean sites in order to address the identified research gap this study not only designs the controller and monopile for dtu 10 mw owt but also develops an ssi framework for fast code the outline of this study is as follows firstly a robust controller is designed for this 10 mw owt in order to perform the dynamic analysis using the fast code secondly the ssi analysis module is introduced into this code and verified by numerical simulations thirdly the monopile of 10 mw owt is designed for a specific marine site using the measured ocean meteorological data and the dynamic response and fatigue damage of this monopile owt are investigated using different models finally some conclusions are summarized briefly 2 controller development of dtu 10 mw wind turbine for fast the 10 mw wind turbine released by the dtu wind energy is taken as the prototype its main specifications are listed in table 1 and more details can be found in the report bak et al 2013 the original controller of this turbine developed for hawc2 hansen and henriksen 2013 has been transformed into the style supported by fast borg et al 2016 under high frequency excitation e g earthquakes the time step should be little enough to maintain the stability of numerical simulations however this controller was prone to be instability in this situation nwtc 2019 consequently a robust controller for this turbine should be developed to meet the urgent demand 2 1 development of controller in this section a new controller for the dtu 10 mw wind turbine is developed considering that the purpose of this task is not to optimize the control of this 10 mw wind turbine but to promote its application the performance of the original controller is set as the target this strategy guarantees that the analysis results using the new controller are comparable with the existing studies e g wang and larsen 2019 jalbi et al 2019 velarde et al 2020 the generator speed is taken as the feedback input which is also the selection of other wind turbines hansen et al 2005 wright and fingersh 2008 for brevity the controller developed by dtu for this 10 mw wind turbine is referred to as dtu controller 2 1 1 baseline control measurement filter to prevent the instability of the controller high frequency excitation of the control systems should be mitigated in the present study a single pole low pass filter with exponential smoothing is used to filter the measured generator speed smith 2006 and its recursion equation is 1 y i 1 α u i α y i 1 with 2 α e 2 π δ t f c where y is the filtered generator speed output measurement u is the unfiltered generator speed input α is the low pass filter coefficient i is the time step counter corner frequency f c is set as 0 2325 hz one quarter of the 1st edgewise natural frequency of the blade following the ref jonkman et al 2009 2 1 2 generator torque controller as shown in fig 1 this variable speed wind turbine has three operational regions and similar models were used by nrel wright and fingersh 2008 jonkman et al 2009 in region 1 the mean wind speed is less than the cut in wind speed and the generator torque is zero in region 2 the generator torque is proportional to the square of generator speed to hold an optimal tip speed ratio according to the report bak et al 2013 the tip speed ratio of dtu 10 mw wind turbine is 7 5 in this region which results in an optimal constant of proportionality of 83 55 n m rad s 2 in region 3 the mean wind speed is between the rated and cut out wind speed and the generator torque is inversely proportional to generator speed with a rated generator speed of 480 rpm electric power of 10 mw and generator efficiency of 94 4 bak et al 2013 the rated mechanical power and generator torque are 10 593 mw and 210 847 9 n m respectively the generator torque is saturated to 231 932 7 n m a maximum of 10 above the rated to avoid excessive overload following the recommendation of jonkman jonkman et al 2009 meanwhile a generator torque rate limit of 80 000 n m s is imposed also two transition regions are set to maintain the continuity of generator torque jonkman et al 2009 region 1½ spans the range of generator speeds between 300 rpm and 10 above this value the generator slip percentage in region 2½ is taken to be 10 following the value used in the dowec and nrel study kooijman et al 2003 jonkman et al 2009 the transitional generator speed between regions 2½ and 3 is 99 of the rated generator speed i e 475 rpm 2 1 3 blade pitch controller for operational region 3 the blade pitch regulation is performed to hold the generator power constant where a proportional integral pi controller determines the pitch angle as shown in fig 2 a single degree of freedom sdof model is established for the rotor drivetrain generator system to identify the parameters of the blade pitch controller taking the angular velocity of the low speed shaft as the basic variable the equation of motion of this system can be obtained according to the theorem of angular momentum 3 t a n g t g j r n g 2 j g d d t ω 0 δω j d δ ω where δω is the perturbation of angular velocity of the low speed shaft δ ω is the angular acceleration of low speed shaft because the generator power is constant in this operational region the generator torque is inversely proportional to the generator speed 4 t g p 0 n g ω where the rotor speed ω is the sum of ω 0 and δω similarly neglecting the oscillation of aerodynamic torque with rotor speed the aerodynamic torque can be expressed as 5 t a p θ ω 0 ω 0 where p is the mechanical power considering that the blade pitch angle variation may result in aerodynamic torque and rotor speed oscillation eqs 4 and 5 can be expanded by using the first order taylor series 6 t g p 0 n g ω 0 p 0 n g ω 0 2 δω 7 t a p 0 ω 0 1 ω 0 p θ δθ where δθ is the perturbation of blade pitch angle with proportional integral derivative pid control δθ is related to the rotor speed perturbations 8 δθ k p n g δω k i 0 t n g δωdt k d n g δ ω by setting ϕ δω and substituting eqs 6 8 into eq 3 the equation of motion of the system becomes 9 m ϕ ϕ c ϕ ϕ k ϕ ϕ 0 where m ϕ c ϕ and k ϕ are the generalized mass damping coefficient and stiffness of this sdof system respectively they can be determined by 10 m ϕ j d 1 ω 0 p θ n g k d 11 c ϕ 1 ω 0 p θ n g k p p 0 ω 0 2 12 k ϕ 1 ω 0 p θ n g k i the natural frequency ω ϕn and damping ratio ζ ϕ are expressed as 13 ω ϕ k ϕ m ϕ 14 ζ ϕ c ϕ 2 k ϕ m ϕ c ϕ 2 m ϕ ω ϕ based on the refs hansen et al 2005 2013 the differential gain kd and negative damping from the generator torque controller are neglected therefore pi gains are determined for the given value of ω ϕ and ζ ϕ 15 k p 2 j d ω 0 ζ ϕ ω ϕ n g p θ 16 k i j d ω 0 ζ ϕ ω ϕ 2 n g p θ where p θ is the blade pitch sensitivity and related to the wind speed rotor speed and blade pitch angle the blade pitch sensitivity of this 10 mw wind turbine is determined by performing a linearization analysis in fast where the uniform steady wind speeds are set as 11 4 m s 12 m s and at intervals of 1 m s until 25 m s the blade pitch angle is perturbed at each operating point and the resulted aerodynamic power variation is measured subsequently the central difference procedure is used to compute the partial derivative within fast in which the induced wake velocities are held constant jonkman et al 2009 as shown in fig 3 the sensitivity of aerodynamic power to the blade pitch angle varies over region 3 and can be accurately modelled by the linear equation 17 p θ p θ θ 0 θ k θ p θ θ 0 where p θ θ 0 is the pitch sensitivity at the rated state and θk is the blade pitch angle at which the pitch sensitivity has doubled from its value at the rated operating point i e p θ θ θ k 2 p θ θ 0 according to the linear relation between pitch sensitivity and blade pitch angle the gains are determined as 18 k p θ 2 j d ω 0 ζ ϕ ω ϕ n g p θ θ 0 g θ 19 k i θ j d ω 0 ζ ϕ ω ϕ 2 n g p θ θ 0 g θ where g θ is the dimensionless gain correction factor and depends on the blade pitch angle 20 g θ 1 1 θ θ k according to the properties and performances of the dtu 10 mw wind turbine from ref bak et al 2013 the gains of the pi controller are set as k p θ 0 0 0191 s and k i θ 0 0 00273 the damping ratio is set as 0 7 and the blade pitch rate limit is set to 8 s in absolute value this is also the blade pitch rate limit of multi megawatt wind turbines jonkman et al 2009 hansen and henriksen 2013 and the minimum and maximum blade pitch angles are set to 0 and 90 respectively 2 2 performance of the new controller a new controller has been developed for this 10 mw wind turbine considering the purpose of this study the new controller should have a similar performance to the dtu controller initially the response of this wind turbine to the uniform steady wind is investigated using these two controllers fig 4 a compares the rotor speed employing the new and dtu controllers a good consistency is achieved between them in this and the following figures new and dtu in legends represent the new and dtu controller respectively as shown in fig 4b their blade pitch angles are also similar except for the low wind speed regions in which the new controller deletes the minimum blade pitch angle requirements for the wind speed lower than 6 m s because the rotor speed and blade pitch angle obtained from the two controllers are in full agreement the generator power represented in fig 4c is also similar subsequently the performance and response of the dtu 10 mw wind turbine subjected to turbulent wind are analyzed to evaluate this new controller the turbulent wind field is generated by the turbsim jonkman 2009 the mean wind speed u η is calculated using the power law wind profile as 21 u η v η η r 0 14 where η denotes the height of the current position pertaining to the mean sea level msl the fluctuating wind velocity is assumed to be a stationary random vector field and the frequency content of the wind velocity is described using the kaimal spectrum kaimal et al 1972 stated in eq 22 22 s k f 4 σ k 2 l k v 1 6 f l k v 5 3 where f is the frequency hz subscript k refers to component along the x y and z axes σ k and l k are the standard deviation and integral scale parameter respectively the iec turbulence level b iec 2005 is selected to determine all these parameters the wind field is discretized into a 220 m 220 m vertical rectangular grid to cover the rotor plane the distance between two adjacent nodes is 10 m in both the horizontal and vertical directions to simulate the spatial dependency of the wind velocity the cross power spectral density function between nodes i and j is defined as 23 s i j f c δ r f s i i f δ s j j f where s i i f and s j j f denote the wind velocity auto spectra at points i and j respectively c δ r f is the coherence function described in iec iec 2005 24 c δ r f e x p b f δ r v 2 0 12 δ r l c 2 where δ r is the distance between the two nodes b is the coherence decrement with a value of 12 l c is the coherence scale parameter with a value of 340 2 m in the following the turbulent wind field is generated by turbsim using this model unless otherwise specified fig 5 shows time histories of hub height wind speed with a mean of 7 m s 11 4 m s and 15 m s respectively the performance of the new and dtu controller are compared in fig 6 where the value in legends refers to the average hub height wind speed when the mean wind speed at hub height is near the rated wind speed i e 11 4 m s the controlling strategies continually switch between the optimal generator speed and variable blade pitch due to the unsteady nature of wind therefore the differences in performances between the two controllers are the most significant in this operating point qualitatively the performance of the two controllers is similar considering the length of this section only a few results are listed here and more comparisons are shown in the supplementary data of this paper considering the randomness of wind 6 samples are generated for each mean wind speed to predict the response of this wind turbine according to fig 7 the average rotor speed and blade pitch angle using the two controllers separately are similar such that the generator power also achieves agreement more comparisons of the wind turbine response can be obtained from the supplementary data they all indicate that the performance of these two controllers is in full agreement in addition when the time step is 1 0 e 5 s short enough to analyze the seismic response of this 10 mw owt the controller is still stable to regulate the blade pitch angle therefore this new controller fulfills the requirement of this study and is suitable for the dynamic analysis of the 10 mw wind turbine especially for the load with high frequency e g earthquake load 3 implement of winkler foundation model for fast 3 1 development of soil pile interaction framework for fast the baseline version of fast jonkman and buhl 2005 consists of aerodyn hydrodyn servodyn and elastdyn modules the aerodyn computes the aerodynamic loads on the rotor using the blade element momentum theory where the aero elastic effect is considered the hydrodyn calculates the wave and current loads on the monopile using the morison equation and added mass method the servodyn implements the blade pitch and generator speed regulation through an external dynamic link library the elastdyn performs the dynamic analysis where the kane equation is used to establish the governing equation of motion for the wind turbine the fourth order runge kutta method an explicit time marching procedure is used for the nonlinear dynamic analysis in the time domain in order to simulate the soil pile interaction of wind turbines the bnwf approach allotey and naggar 2008 is developed in the fast code this model simplifies the soil into independent layers ignoring the interaction between the adjacent and has been widely used to simulate the soil pile interaction due to its simplicity fig 8 summarizes the framework of this user compiled code and the improvement is concentrated in the ssi module initially this module determines the constitutive relation of the springs and dampers attached to the monopile according to the site property subsequently the displacement and velocity of the monopile are passed to the springs and dampers and the constrained forces of the soil around the pile were computed finally the constrained forces of the soil are applied to the monopile by the twrload subroutine this framework makes full use of the existing modules of fast which is prone to be implemented also the improved soil spring and damper models can be easily introduced by updating their constitutive equation according to the latest development of soil pile interaction as shown in fig 9 the springs and dashpots along the embedded monopile are used to simulate the ssi in this framework the horizontal springs the p y springs in fig 9 are used to determine the lateral resistances of the soil against the monopile movements the vertical springs are used to simulate the axial interaction t z spring and end bearing capacity at the tip of the monopile q z spring the following expressions are recommended by api api 2014 in constructing p y curves for sand 25 p a p u t a n h k 0 z a p u y 26 p u s c 1 z c 2 d γ z f o r s h a l l o w d e p t h 27 p u d c 3 d γ z f o r d e e p d e p t h 28 p u m i n p u s p u d where a is a factor with a value of 0 9 for cyclic loading z is the depth of soil below mudline m y is the lateral deflection m c 1 c 2 and c 3 are dimensionless coefficients and their formulas are summarized in section 8 5 6 of the ref api 2014 in order to consider the energy dissipation of the foundation the viscous dashpot is connected in parallel with the horizontal soil springs and the dashpot coefficients are calculated following makris and gazetas 2010 29 c m 2 k s β m ω where ω is the 1st order natural angular frequency of the support structure k s is the secant stiffness of the p y curves and β m is the hysteresis damping ratio with a value of 5 for the sake of brevity only p y curves for sand are mentioned the t z and q z curves are described in section 8 4 2 and 8 4 3 of api respectively the displacement corresponding to the maximum soil monopile adhesion z peak is set as 1 of the monopile outer diameter this soil reaction curves model is still widely utilized in offshore wind energy bisoi and haldar 2014 abhinav and saha 2015 and it is out of the scope of this study to develop new soil reaction curves as a studied case the api p y t z and q z curves are used to calculate the reaction of sand to monopile deflections in fact more accurate constitutive equations of the soil spring can be conveniently introduced into this ssi module 3 2 validation of soil pile interaction framework for fast 3 2 1 models and parameters the monopile of dtu 10 mw owt introduced by yang et al 2020 is used to verify this ssi module the average water depth is 30 m and the properties of this homogeneous site are listed in table 2 because the original tower is designed for onshore environment its diameter and thickness are up scaled by factors of 1 25 and 1 3 respectively consequently the monopile diameter and thickness are changed to 9 0 m and 66 5 mm respectively more details on the support structure of the 10 mw owt are presented in section 3 1 of the ref yang et al 2020 as a widely utilized commercial software the dnv gl bladed bladed employs the combined modal and multi body dynamics bossanyi 2011 and uses the identical ssi model employed by fast in this study therefore the dynamic analysis of the 10 mw owt is performed by fast and bladed respectively to evaluate this new ssi module the first two fore aft fa and side to side ss tower modes the first two flapwise blade modes and the first edgewise blade mode are included in fast and bladed also the controller developed in section 2 1 is employed by fast and bladed the turbsim code is used to generate turbulent wind fields that are applied to fast and bladed both fast and bladed generate the random wave fields however neither of them can directly import the wave fields the water is still in simulations to prevent differences in wave fields the bladed does not supply the foundation damping model directly and an equivalent damping ratio should be added to the tower mode taking the damping model of eq 29 and the method proposed by chen and duffour 2018 the first order modal damping ratio of the tower caused by foundation damping is about 1 5 which is added to the tower and the time step is set as 0 005 s in numerical simulations of this section 3 2 2 response of 10 mw monopile owt excited by wind firstly the 10 mw owt responses to uniform steady wind are analyzed using fast and bladed respectively fig 10 compares the tower top displacement and mudline bending moment in the fa direction for different wind speeds the results simulated by the two codes are in good agreement other response indicators of the support structure and blades also have this characteristic therefore under the uniform steady wind excitation the ssi module established in this study has sufficient accuracy subsequently the 10 mw owt responses to the turbulent wind are analyzed using the two codes respectively where 6 wind samples are generated for each mean wind speed the tower top displacement and mudline bending moment amplitudes of the fa direction are shown in fig 11 where they are averaged pertaining to wind samples the differences between them are minor such that this new ssi framework has sufficient accuracy as bladed the maximum error in figs 10 and 11 is less than 6 which is within the margin of practical engineering and further comparison indicates that the error is related to the difference of foundation damping models in the two codes considering that the api soil reaction curves used in the examples of this paper have been widely utilized the validations of ssi model are performed for the overall reliability of this framework without verification of api p y t z and q z curves 4 dynamic response of 10 mw owt 4 1 preliminary design of the monopile for 10 mw owt although the monopile of the dtu 10 mw owt in the homogeneous sand was designed velarde 2016 wang and larsen 2019 yang et al 2020 few studies were performed for the layered sand which is more universal in ocean engineering and the dynamic analysis of a well designed monopile supported owt is representative therefore the monopile of the 10 mw owt is designed for the layered sand in fig 12 this site has been widely used in dynamic analysis of owts e g oc3 project of nrel jonkman and musial 2010 the design requirements of api dnv iec and gl api 2014 dnv 2005 2010 2013 gl 2005 iec 2005 2009 are adopted in this study and part of them are shown in table 3 the wind and wave conditions of ijmuiden munitiestort from the upwind project are used and the design process is illustrated in appendix a to meet all the requirements of table 3 the monopile dimensions are d p 7 8 m t p 85 mm and l p 39 m considering that it is challenging to perform fatigue analysis in the time domain using this simplified design method a detailed fatigue analysis is carried out in section 4 2 2 4 2 dynamic response of 10 mw owt the responses of this 10 mw owt to random wind and wave are analyzed using the fast code updated in section 3 4 2 1 dynamic response excited by stochastic wind and wave the load cases lcs used to perform the dynamic analysis of 10 mw owt are shown in table 4 ti is the turbulence intensity of the wind h s and t p are the significant wave height and peak spectral period of the incident wave respectively and p f represents the occurrence probability these lcs lumped from the measured data of ijmuiden munitiestort site bredmose et al 2012 have been used to analyze the dynamic response and fatigue damage of owts løken and kaynia 2019 it is noticeable that the monopile of 10 mw owt is also designed for this site therefore the dynamic analysis of this wind turbine is site specific for loadings and support structure which is more realistic for lcs 2 12 the owt is in operational conditions while the owt is parked for lc1 and lcs 13 17 for operational state the controller developed in section 2 is used to regulate the rotor speed and blade pitch angle for parked state the blade pitch angle is set to 90 the rotor speed is set to 0 and the generator is turned off the hydrodynamic loads are computed by the hydrodyn code where the jonswap wave spectrum is used fig 13 shows the samples of wave elevation and hub height wind speed for lcs 3 6 and 9 the responses of 10 mw owt excited by these wind and wave fields are compared in fig 14 the tower top displacement and mudline bending moment amplitudes are the largest for lc6 which has a mean wind speed of 12 m s close to the rated wind speed of this wind turbine considering the randomness of wind 6 samples are generated for each mean wind speed following the requirement of dnv dnv 2013 some statistics of tower top displacement and mudline bending moment the mean and standard deviation sd minimum and maximum are displayed in fig 15 for different average wind speed for all these statistics the amplitude occurs in lc6 which has a wind speed of 12 m s close to the rated speed this is consistent with the conclusion that the highest wind loads are expected to occur at the rated wind speeds jonkman 2007 meanwhile influenced by the controller the responses of owt do not monotonically increase with the mean wind speed which is different from the responses of traditional marine structures subsequently to evaluate wind and wave contribution the individual responses of owt to wind only and wave only are computed and the mudline internal force amplitudes are compared in fig 16 for shear force the amplitudes caused by wind are larger than those caused by waves when the wind speed is between 8 m s and 12 m s when the average wind speed is beyond this range the mudline shear force amplitudes caused by wave are greater than those caused by wind especially when the wind speed exceeds 18 m s the mudline shear force amplitudes caused by wave loads are significantly larger than those induced by wind for mudline bending moment the moment arm of wind load is much larger than that of wave load the mudline bending moment amplitudes caused by the wave are larger than those caused by wind when the owt is in the parked state 4 2 2 influence of controller as shown in fig 17 the rotor speed and blade pitch angle oscillate in the time domain due to turbulent wind characteristics yuan et al 2020 believed that the controller significantly influences the seismic response of wind turbines in operational conditions however the existing structural analysis tools cannot directly simulate the servo elastic coupling between the control system and structure consequently zuo et al 2018 proposed a simplified method where the average rotor speed and blade pitch angle are used to compute the aerodynamic loads on the rotor this attractive method has been performed in abaqus to analyze the dynamic response of owts zuo et al 2018 2020 in this section the comparisons between this simplified method and the fully coupled method are performed to evaluate its reliability because the controller works when the wind turbine is in operation only the lcs 2 12 are employed in the analysis the tower top displacement and mudline bending moment obtained from the coupled and simplified methods are compared in fig 18 obviously the differences between them are significant the statistics of mudline fa bending moment resulted from these two methods are shown in fig 19 the maximum relative error of mean maximum and sd of mudline bending moment between the two models are 1 7 43 5 and 88 1 respectively therefore the simplified method has sufficient accuracy in predicting the average response of wind turbines while the errors are significant for the maximum and sd of mudline bending moment for the simplified model the blade pitch angle is set as constant in the simulation which may overestimate the maximum aerodynamic load 4 2 3 influence of ssi in this section the influence of ssi on this 10 mw monopile supported owt is discussed through the comparisons on the structural response as shown in fig 20 two analysis models are applied the first is the ssi model developed in section 3 1 the second model only includes the part of owt above the mudline and it is assumed that the structure is fixed at the bottom the tower top displacement and the mudline bending moment obtained by using these two models are compared in fig 21 overall the amplitudes of tower top displacement and mudline bending moment considering the ssi are larger than those without considering this effect the differences between the analysis results of the two models with a mean wind speed of 28 m s are more significant than those with a wind speed of 12 m s the statistics of the mudline bending moment separately obtained from the two models are compared in fig 22 overall the analysis errors between the two models in the parked condition are significantly larger than those in the operational condition the maximum relative error of mean maximum and sd of mudline fa bending moment between the two models are 8 58 1 and 83 8 respectively this phenomenon may significantly influence the long term behavior of owt support structures such as fatigue damage 4 3 fatigue analysis the lifetime of wind turbines is not less than 20 years during which the support structure is suffered from load cycles of the order of 500 million løken and kaynia 2019 the fatigue may occur even though the stresses of components are far below the yield stress limit of the material compared with other engineering structures the contribution of the self weight of wind turbines to the stresses is negligible while the contribution from bending moment is significant therefore the fatigue analyses of monopile are performed according to mudline fa bending moment time series for each load case in tables 4 and 6 random wind samples are generated to take the randomness of wind into account the rainflow counting is used to determine the stress cycles for each time serie considering that the mean mudline fa bending moment for different lcs is not constant the goodman correction is performed to analyze the data as if each cycle occurred about a fixed mean load to get the lifetime 20 years fatigue of wind turbines the damage cycle counts of these time series are extrapolated according to the occurrence probability of lcs meanwhile it is assumed that the wind turbine is always producing power when the mean wind speed at hub height is between cut in and cut out speeds the ultimate strength of the steel used for the dtu 10 mw substructure is assumed to be 440 mpa and the corresponding ultimate load is 1720 mn m the palmgren miner rule is used to predict fatigue damage and is given as 30 d i n i n i where d is the lifetime fatigue damage n i is the cycle count at stress level i and n i is the number of cycles to failure at stress level i the fatigue analysis of the 10 mw monopile supported owt is performed using mlife code developed by nrel hayman and buhl 2012 the load bin width is set to 200 n m and the fixed mean load is specified as the aggregate mean across all input files following the recommendation of det norske veritas dnv 2005 wohler exponent m is set as 5 in this analysis more details of the fatigue analysis method have been illustrated in the theory manual hayman 2012 the fatigue damage of each lc is described by the normalized fatigue damage η j 31 η j d j st d j st max where d j st is the accumulated damage from time series corresponding to lc j d j st max is the maximum of d j st for all lcs the normalized fatigue damage of different lcs is shown in fig 23 a the fatigue damage increases with wind speed on the whole with two slight variations related to the blade pitch regulation the first change occurs between lc6 and lc7 due to the influence of blade pitch regulation when the owt is in operational condition the maximum and sd of mudline bending moment are the largest for lc6 as shown in fig 15 the second variation is between lc12 and lc13 for lc12 the wind turbine is in operational condition while it is in the parked state for lc13 therefore the average bending moment at the mudline reduces from 79 5 mn m to 2 7 mn m leading to less fatigue damage in order to evaluate the contribution of different lcs to the lifetime fatigue of wind turbines their occurrence probability is taken into account the normalized fatigue damage contribution is defined in eq 32 and shown in fig 23b 32 ζ j d j st p v j d j st p v j max where p v j is the probability of lc j the fatigue damage of this owt is dominated by the lcs around the rated wind speed the lifetime fatigue damage of the monopile is 0 56 corresponding to a lifetime of 35 7 years therefore the monopile of this 10 mw owt meets the requirement of fatigue summarized in table 3 because the fatigue analysis is nonlinear it is challenging to separate wind and wave contribution directly therefore the fatigue analysis of monopile under the separate excitation of wind only and wave only is performed to evaluate their contribution the lcs are still those listed in table 4 yet the analysis only includes the corresponding wind or wave columns the lifetime fatigue damage of owt monopile caused by wind only and waves only is 0 248 and 0 239 respectively therefore both wind and wave excitations are essential in the fatigue analysis of the 10 mw owt the normalized fatigue damage and contributions for different lcs are shown in fig 24 as for the wind the mudline bending moment is relatively small when owt is parked such that the corresponding fatigue damage is close to 0 lc6 corresponding to the operational condition of wind turbines results in the most significant fatigue damage from fig 24b the contribution of lc6 to the lifetime fatigue damage of monopile for owt under the separate wind excitation reaches 50 for the wave the fatigue damage caused by each lc increases monotonously from lc1 to lc17 which is similar to the characteristics of mudline internal forces shown in fig 16 the total contribution of lcs 6 10 to lifetime fatigue damage of monopile under the separate wave excitation is 62 among which lc8 makes the most significant contribution of 17 the influence of controller and ssi on the fatigue damage of owts monopile is also investigated the lifetime fatigue damage of the monopile employing the analysis method proposed by zuo et al 2018 is 1 01 while it is 0 57 for the fully coupled method this simplified analysis method may overestimate the fatigue damage of owt significantly the lifetime fatigue damage of the monopile is 0 43 for the fixed base model which corresponds to a lifetime of 46 5 years compared with ssi model the fatigue life of the monopile is overestimated for 10 8 years i e 30 relative error due to the ignoring of soil structure interaction 5 conclusions in this paper the monopile of a 10 mw owt with a robust controller is designed based on the soft stiff philosophy its dynamic response and fatigue damage excited by random wind and wave are performed by the updated fast code where the soil structure interaction and aero servo hydro elastic coupling are considered some conclusions can be drawn as the following 1 a variable speed and collective pitch controller is developed for the dtu 10 mw owt for mean wind speeds at hub height lower than the rated wind speed the generator speed is regulated to maintain the optimal tip speed ratio for mean wind speeds higher than the rated wind speed the blade pitch angle is increased to control the aerodynamic torque the numerical simulations indicate that this controller has a similar performance to the baseline controller released by dtu but with better robustness 2 an ssi framework based on the beam on nonlinear winkler foundation is compiled in the fast code numerical examples show that this framework has sufficient precision for the dynamic analysis of wind turbines compared with the gl bladed software this method is carried out through the existing tower load module of fast such that it is prone to be implemented and updated e g introducing more accurate soil reaction curves 3 the monopile of this 10 mw owt is designed by a simplified method for the typical ocean site with the measured metocean data in the north sea the design utilizes the soft stiff philosophy and the 1st order natural frequency of the system is 0 22 hz lying in the middle of 1p and 3p frequency bands meanwhile this design also meets the requirements of ultimate limit state serviceability limit state and fatigue limit state 4 the dynamic analysis of this monopile supported 10 mw owt is performed using the updated fast code for this studied case the unsteady rotor speed and blade pitch angle induced by turbulent wind influence the maximum mudline bending moment of monopile especially as the mean wind speed is between the rated and cut out wind speed this leads to an overestimation of 90 on lifetime fatigue damage of the monopile when neglecting the unsteady nature for this numerical example the ssi exhibits a significant influence on the mudline bending moment amplitude and fatigue life of the monopile in this study the api soil reaction curves are used to simulate soil structure interaction for future work new soil reaction curves should be introduced into this framework to simulate the dynamic ssi more accurately such as considering the dissipation of pore pressure in cohesionless soil including all degrees of freedom of pile section also the results of this numerical tool should be compared with experimental results to validate its reliability credit authorship contribution statement renqiang xi conceptualization methodology data curation writing original draft preparation software xiuli du methodology conceptualization supervision resources visualization piguang wang investigation writing reviewing and editing validation chengshun xu methodology data curation endi zhai methodology data curation suyu wang methodology declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is funded by the national natural science foundation of china and the grant numbers are 51808061 and 51722801 the results and conclusions presented are of the authors and do not necessarily reflect the view of the sponsors the authors would like to give special thanks to dr jason jonkman of the national renewable energy laboratory whose guidance and recommendations have been of great importance in achieving the present results the first author is especially grateful for the discussion with dr yang at university of shanghai for science and technology during this work appendix b supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix b supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2021 109346 appendix a the specifications api 2014 dnv 2005 2010 2013 gl 2005 iec 2005 2009 describe hundreds of lcs that need to be considered to ensure the integrity of wind turbines however in terms of foundation design not all these cases are relevant or significant and the most severe lcs are listed in table a1 according to the ref arany et al 2017 table a1 representative environmental scenarios as load cases chosen for foundation design table a1 name and description wind model wave model alignment e 1 normal operational conditions ntm at ur u 1 1 year ess w 1 collinear e 2 extreme wave load scenario etm at ur u 2 50 year ewh w 4 collinear e 3 extreme wind load scenario eog at ur u 3 1 year ewh w 2 collinear e 4 cut out wind speed and extreme operating gust scenario eog at uout u 4 50 year ewh w 4 collinear e 5 wind wave misalignment scenario etm at ur u 2 50 year ewh w 4 the operational range of this owt is 6 9 6 rpm and its 1p and 3p frequency bands are 0 10 0 16 hz and 0 30 0 48 hz respectively considering the uncertainty of the analysis model dnv 2002 recommends that the natural frequency should be at least 10 away from 1p and 3p frequenciy bands therefore the natural frequency of this 10 mw owt should be between 0 176 hz and 0 27 hz and the desired natural frequency is chosen to be 0 22 hz the simplified method proposed by the ref arany et al 2017 is used to design the monopile of this owt a 1 input data this study uses the wind and wave conditions of ijmuiden munitiestort from the upwind project upwind to get a realistic design the average water depth of this site is 21 m which is suitable for the monopile foundation bredmose et al 2012 its climate data has been measured for 22 years and the parameters used in this simplified design are summarized in table a2 more data can be obtained from a report of upwind fischer et al 2010 table a2 metocean data table a2 parameter symbol value unit wind speed weibull distribution shape parameter s 1 97 wind speed weibull distribution scale parameter k 11 73 m s reference turbulence intensity i 14 turbulence integral length scale l k 340 2 m density of air ρ a 1 225 kg m3 significant wave height with 50 year return period h s 8 24 m peak wave period t s 10 97 s mean surface line msl 21 m density of sear water ρ w 1030 kg m3 a 2 wind wave load and pile dimensions the design load of ultimate limit state uls is used to determine pile dimensions however considering that the wave load is related to monopile diameter the wind load on the rotor is computed to guess initial pile dimensions adopting the simplified formulas summarized by arany et al 2017 the wind loads and mudline internal forces of monopile are computed and listed in table a3 table a3 load and bending moment for wind scenarios table a3 parameters unit scenario u 1 scenario u 2 scenario u 3 scenario u 4 standard deviation of wind speed m s 1 98 3 07 standard deviation in f f1p m s 0 64 0 99 turbulent wind speed component m s 0 82 1 99 8 24 6 39 maximum force mn 1 40 1 68 3 62 0 88 minimum force mn 1 22 1 22 1 22 0 56 mean force without turbulence mn 1 05 0 83 0 14 0 31 maximum moment mn m 196 236 507 123 minimum moment mn m 170 170 170 78 mean moment without turbulence mn m 147 117 18 1 43 the maximum mudline bending moment of monopile induced by wind m u is 685 mn m after applying a load factor of γ l 1 35 according to the recommendation of api 2005 it is assumed that a1 t p 6 35 d p 100 the diameter of monopile d p can be determined by eq a2 a2 σ m m u i p d p 2 f y k γ m with f y k 355 m p a and γ m 1 1 eq a2 gives initial pile dimensions d p 6 5 m and t p 72 m m considering the wall thickness of the transition piece and its gap between monopile the total diameter of substructure is set as 6 8 m table a4 summarizes the wave height and periods of different scenarios the monopile wave load is computed using the method proposed by arany et al 2017 and listed in table a5 table a4 wave heights and wave periods for different wave scenarios table a4 parameters scenario w 1 scenario w 2 scenario w 3 scenario w 4 wave height m 6 05 11 31 8 24 15 41 wave period s 10 12 11 81 10 97 13 78 table a5 load and bending moment for wave scenarios table a5 parameters scenario w 1 scenario w 2 scenario w 3 scenario w 4 total wave load mn 2 03 5 66 3 34 9 90 total wave moment mn m 34 110 60 220 according to the representative lcs in table a1 the wind and wave load are combined and the resulted uls loads with a load factor of γ l 1 35 are summarized in table a6 the load scenario e 3 is the driving case for this example and the maximum moment is 833 mn m the updated total loads are used to recalculate the foundation dimensions by eq a2 which results in new pile dimensions d p 6 9 m t p 78 mm velarde 2016 concluded that no significant change in natural frequency occurred from pile embedment length 10 times to 5 times d p for the monopile of 10 mw owt therefore l p is set to 5 times the diameter of the pile i e 35 m table a6 uls load combinations table a6 parameters e 1 e 2 e 3 e 4 e 5 maximum wind load mn 1 89 2 27 4 89 1 19 2 27 maximum wind moment mn m 264 6 318 6 684 45 105 3 318 6 maximum wave load mn 2 74 13 37 7 64 13 37 13 37 maximum wave moment mn m 45 9 297 148 5 297 297 total load mn 4 63 15 63 12 53 14 55 13 55 total bendning moment mn m 310 5 615 6 833 402 3 435 56 a 3 capacity of foundation and deformation of pile it is assumed that the soil resistance increases linearly with depth the moment and horizontal load capacity of the monopile foundation can be computed by the following equations poulos and davis 1980 a3 m r f r e 2 3 f a4 f r 0 5 γ d p l p 3 k p e l p with a5 k p 1 s i n ϕ 1 s i n ϕ a6 f 0 82 f r d p k p γ where e is the load eccentricity e m f substituting the values of these parameters into eq a3 a6 the ultimate capacity of the foundation is m r 4017 mn m and f r 105 mn respectively according to eq a2 the yield bending moment of monopile m y is 907 3 mn m less than the ultimate capacity of foundation therefore the monopile will act as a long pile and f r may be calculated by eq a3 and a6 putting m r m y this results in a f r 13 6 mn they are above the total load and bending moment listed in table a6 according to the formulas proposed by poulos and davis 1980 this monopile is not a flexible or rigid pile therefore its stiffness is determined from numerical simulations referring to passon 2006 as shown in fig a1 the horizontal load f 0 is set as 9 28 mn and bending moment m 0 is 617 mn m the foundation stiffness k l k r and k lr are 2 31 gn m 306 5 gn rad and 21 1 gn respectively the deformations can be computed by ρ k r k l k r k l r 2 f k l r k l k r k l r 2 m a 7 θ k l r k l k r k l r 2 f k l k l k r k l r 2 m a 8 where ρ and θ are the displacement and the rotation angle of the monopile at mudline respectively consequently deflections ρ and rotations θ are 7 6 cm and 0 37 respectively fig a1 analysis model of lpile fig a1 a 4 natural frequency of the system according to the formula proposed by arany et al 2015 the fixed base natural frequency is a9 f fb 0 232 hz the natural frequency of the system is influenced by flexibility of substructure and foundation which are represented by corresponding coefficients respectively it is assumed that the monopile goes up to the bottom of the tower the tower height is 105 3 m the hub height is 119 m the nacelle is 7 4 m tall and the distance between the mudline and the bottom of the tower is 31 m following arany et al 2015 the substructure flexibility coefficient c s and foundation flexibility coefficients c r and c l are a10 c s 0 851 a11 c r 0 901 a12 c l 0 981 the formulas of these coefficients are listed in eqs 69 and 70 of the ref arany et al 2017 consequently the 1st order natural frequency of the 10 mw monopile supported owt is a13 f 0 c s c r c l f f b 0 174 hz this value is less than the limit value given in table 3 and the influence of water and soil around the monopile is not considered in this simplified method when the pile diameter is increased to 7 8 m a14 f 0 0 217 hz as a result the monopile dimensions are set as d p 7 8 m t p 85 mm and l p 39 m to consider the dynamic effect of wave load the dynamic amplification factor is calculated using the wave period listed in table a4 the structural damping of owt is set as 1 according to the ref dnv 2013 the aerodynamic damping depends on the wind speed and the fa value may be between 2 and 10 while that of the ss can be neglected the total damping ratios are the sum of structural and aerodynamic damping and they were chosen conservatively as 3 and 1 for the fa and ss directions of wind turbines respectively consequently the dynamic amplification factor is calculated as a15 d a f 1 1 f e f 0 2 2 2 ξ f e f 0 2 and the dafs for typical wave scenarios are represented in table a7 table a7 dynamic amplitude factors dafs table a7 parameters wave scenario w 1 wave scenario w 2 wave scenario w 3 wave scenario w 4 dynamic amplification fa 1 253 1 171 1 207 1 1201 dynamic amplification ss 1 255 1 172 1 209 1 204 the wave loads are recalculated considering the dynamic amplification effect of loads and then combined with the wind loads the bending moment and normal stress of monopile at mudline are listed in table a8 where the maximum mudline bending moment of monopile is 690 8 mn m the monopile strength foundation bearing capacity and deformation are checked using the updated loads and monopile dimensions the results indicate that these conditions are all satisfied for the latest pile dimensions table a8 bending moment and normal stress of monopile at mudline table a8 parameter scenario e 1 scenario e 2 scenario e 3 scenario e 4 scenario e 5 maximum moment mn m 258 1 586 5 690 8 473 7 422 6 minimum moment mn m 61 8 350 9 183 5 350 9 116 5 maximum stress level mpa 59 1 134 1 157 9 108 3 96 6 maximum cyclic stress range mpa 70 4 214 5 200 1 188 65 70 1 a 5 long term performance it is essential to evaluate the influences of soil stiffness evolution on the natural frequency of wind turbines fig a2 shows the change in natural frequency resulting from the variation of the coefficient of subgrade reaction for this numerical example it can be concluded that a change of 30 in soil coefficient of subgrade reaction produces less than 1 5 change in the natural frequency for this 10 mw monopile supported owt as for frequency change degradation is more critical than stiffening in this studied case fig a2 frequency change due to change in soil stiffness during the lifetime of the turbine fig a2 the simplified approach of accumulated deformation is often used in literature which is equivalent to reducing soil stiffness the coefficient of subgrade reaction n h can be reduced to account for the effects of the cyclic load broms 1964 pointed out that its reduction depends on the density of the cohesionless soil these studies suggest reducing n h by a fixed percentage 30 in davisson 1970 75 and 50 for dense and loose sand in broms 1964 when the coefficient of subgrade reaction n h is reduced by 75 the deformation of monopile at mudline will increase from ρ 4 12 c m and θ 0 12 to ρ 8 82 c m and θ 0 23 although the increase is larger than 100 the deformation is still below the limit in table 3 
20612,the predictive uncertainty of ocean currents needs to be considered in the path planning of autonomous underwater vehicles auv in oceanic environments an interval optimization io scheme is presented in this paper to plan time optimal paths for auvs operating in oceanic environments with dynamic and uncertain flow fields interval currents are established to process the uncertainty of forecasted ocean flows and the io scheme is used to search for time optimal paths in the interval current fields the io scheme is a two layer framework in the outer layer quantum behaved particle swarm optimization is used to generate and optimize candidate paths in the inner layer the interval response of the candidate path from the outer layer is calculated under interval current fields and they are converted into a time optimal fitness value in accordance with the possibility degree of interval numbers the influence of predictive uncertainty is analyzed via simulation and the robustness of the io scheme is verified keywords interval optimization uncertain ocean currents autonomous underwater vehicles path planning abbreviations auvs autonomous underwater vehicles qpso quantum behaved particle swarm optimization mdp markov decision processes rpdi reliability based possibility degree of interval io interval optimization em ensemble method dff deterministic flow field 1 introduction autonomous underwater vehicles auvs have been extensively used to perform various complex missions such as oceanographic surveys wynn et al 2014 target tracking shojaei and dolatshahi 2017 and monitoring bayat et al 2017 because of their outstanding capability to work in remote or hazardous scenarios they provide a means of continuously monitoring specific regions and for measuring ocean parameters because they can work for a long time underwater at considerably lower operating costs than those of the manned research vessels however the limited energy capacity of auvs restricts their range and endurance during deployment path planning is a critical part of the auv control system and it not only determines the level of autonomy of the auv but also the premise of the reliability of a mission and the likelihood of success zeng et al 2015 the path planner needs to be capable of finding a trajectory that safely leads the auv from its initial or current position to its destination with various objectives for example based on minimizing the risk of collision with ships and land pereira et al 2013 traveling time wang et al 2019 energy consumption subramani and lermusiaux 2016 and maximizing data collection khan et al 2019 under different mission scenarios such as inspection lin et al 2018 and target tracking kim et al 2018 in this research we focus on optimizing the traveling time of auvs the high inertia of ocean environments provides a good opportunity for vehicles to exploit ocean currents for efficient navigation thus various solution approaches have been developed to determine time or energy optimal paths in the current fields the graph based search method is extensively used in path planning algorithms such as the dijkstra algorithm niu et al 2018 and the a algorithm lee et al 2015 hernandez et al 2015 singh et al 2018 song et al 2019 which have good consistency and convergence as they employ a discretized representation of the environment called a grid map however the final paths are not always optimal and have redundant turns because the search space is limited by the grid cell further the graph searching algorithms cannot easily address the optimal path planning problem in environments with time varying ocean currents kularatne et al 2018a the level set scheme is another efficient path planning method for auvs that considers continuous strong and dynamic ocean currents this scheme was proposed for time optimal planning in a dynamic flow field lolla et al 2014a 2014b then an improved level set optimization methodology was presented to compute energy optimal paths wherein the relative vehicle speed and headings are considered stochastic subramani et al 2016 2017a b however the underlying motion model behind the level set method includes a velocity model which is often very restrictive metaheuristic optimization algorithms are efficient for solving path planning problems with an np hard and multiobjective nature tang et al 2016 integrated particle swarm optimization pso with the differential evolution de algorithm to solve the global path planning problem efficiently a dynamic augmented multiobjective pso mopso ma et al 2018 was proposed to generate an energy efficient path by considering multiple objectives and constraints the alarm pheromone assisted ant colony system was proposed to deal with path planning problems in large scale spaces with nonlinearity and constraint issues of the auv ma et al 2019 however these works use only a grid map that cannot be applied in an environment with a continuous flow field a shell space decomposition scheme integrated with a quantum behaved particle swarm optimization qpso was presented to obtain time and energy optimal paths in 3d space with cluttered currents and uncertain obstacles zeng et al 2014 2019 a comparison of optimization techniques for auv path planning in environments with ocean currents is performed including a rrt rrt genetic algorithm ga pso and qpso the results show that qpso outperforms the other five algorithms in terms of path optimality zeng et al 2016 the differential evolution de algorithm is employed to generate time efficient paths within a complex 3d underwater environment incorporated with turbulent current vector fields coastal areas islands and static dynamic obstacles zadeh et al 2018a the de scheme was compared with three state of art evolutionary algorithms pso biogeography based optimization and firefly algorithm zadeh et al 2018b niu et al 2020 proposed a novel energy efficient path planning algorithm to address challenges with the presence of spatially temporally variant sea current and complex geographic map data by integrating the following algorithms voronoi roadmap dijkstra s searching coastline expanding and ga in addition several researchers applied path planning algorithms in real time sea exercises with real auvs and they verified the importance and effectiveness of path planning edwards et al 2017 subramani et al 2017a b the majority of the aforementioned studies assume that the full knowledge of ocean currents in space and time are available note that forecasting ocean current velocities is complex and difficult and this complexity coupled with the limited understanding of the dynamics of ocean currents results in uncertainty in the prediction of ocean currents further low spatiotemporal sampling resolutions and limited accuracies of measurement devices contribute to errors in the data used to initialize forecasting models therefore a major challenge in path planning is the uncertainty of ocean currents the effect of uncertainties in ocean current prediction on path planning has been analyzed zeng et al 2019 the results indicate that neglecting ocean current uncertainty in path planning can lead to significant wastage of energy in the auvs even if the outcome path is not feasible when the level of uncertainty is high recently progress has been achieved in path planning for autonomous robots in uncertain environments a nonlinear robust model predictive control method was developed to compute a minimum energy cost policy under forecast uncertainties in time varying ocean flows by huynh et al 2015 however their path planner can only be used for small ranges because the computational time cannot exceed the sampling time of the predictive control algorithm the markov decision process mdp has been used to plan paths with minimum time in wind fields ai sabban et al 2013 and to compute the minimum expected energy paths kularatne et al 2018b in ocean environments with uncertain flow fields however the mdp has a high computational cost an ensemble approach em has also been presented to obtain the statistics of optimal trajectories wang et al 2016 although em can considerably improve the stability of the result paths it requires a large initial flow field ensemble and it performs deterministic path planning for each flow field this considerably increases the computation time currently the level set approach subramani et al 2018 is used to complete stochastic reachability and time optimal path planning and to quantify the sensitivity of time optimal paths to forecast errors to solve the auv path planning problem under uncertain ocean currents this paper proposes an interval based optimization algorithm such an approach can help us choose an appropriate path to offset the effect of errors on ocean current predictions the proposed scheme is a two layer optimization framework that is based on the interval optimization io theory in the inner layer we calculate the interval response i e upper and lower bounds for a candidate path using the vector analysis method in the outer layer we search for the optimal path among all candidate paths using qpso the main contributions of this paper are summarized as follows 1 an algorithm that combines qpso and interval optimization is presented to enhance the robustness of the path planner for an auv in uncertain flow fields 2 the vector analysis method is derived to evaluate the interval responses this greatly improves the computational efficiency of the path planning algorithm 2 problem formulation 2 1 ocean field environment oceans are extremely complex dynamic systems and many of their phenomena and dynamic processes are difficult to track and predict inevitable differences exist between actual and modeled values of physical fields and properties these difference cause fundamental limitations in the predictability of nonlinear dynamics therefore most predicted ocean current data are uncertain and it is difficult to estimate a correct probability distribution function from these data in contrast estimating the two bounds of the ocean current vector is easier and more computationally feasible than acquiring precise ocean currents or probability distributions thus interval currents are constructed to represent uncertainties in the proposed scheme in this study the 3d environment w r 3 is considered this environment is subject to a time varying uncertain flow field v f w t r 3 where w t w t t and t t r 0 denote the time interval under consideration for x w and t t t v f x t v m x t v d x t denotes the uncertain ocean current v m x t and v d x t represent the magnitude and direction of the uncertain current vector respectively the uncertainty in the flow velocity vector can be simulated by 1a v m x t v m x t v m x t 1 σ m v m x t 1 σ m v m x t 1b v d x t v d x t v d x t v d x t σ d v d x t σ d where v m x t and v d x t respectively represent the magnitude and direction of the deterministic flow velocity these values are defined as the nominal magnitude and direction of ocean currents respectively similarly v f x t is defined as the nominal ocean current and it can be obtained from ocean current prediction systems such as the regional ocean modeling system σ m and σ d represent forecast uncertainties in terms of magnitude and direction respectively where σ m 1 they can be computed and estimated through historical nowcasts and forecasts respectively because horizontal ocean currents and propulsion velocity are considerably stronger than the vertical ones the latter are ignored in the ocean current model the model of the interval current vector is shown in fig 1 an example of a 2d interval flow field is shown in fig 2 in this study the nominal current fields used for the analysis were obtained from the marine reanalysis product data set mrpds http ocean geodata cn the mrpds provides daily ocean current data with a 0 1 spatial resolution from 99 e to 134 e between 1 n and 30 n which is an area in and around the south china sea the vertical direction is divided into 24 layers from sea level to 1200 m 2 2 cost evaluation an auv is assumed to be a holonomic kinematic model this assumption is reasonable when the dimensions of the auv are smaller than those of the flow structures using this model the net velocity v g x t of vehicles with respect to the seabed can be obtained as 2 v g x t v p x t v f x t where v p denotes the thrust velocity of the vehicle generated by the propulsion system the cost function kularatne et al 2018 that represents the energy consumption of the auv is given as 3 e γ e hotel e drag t s t g k h k d v p γ t 3 d t where e γ denotes the energy consumption of vehicles traveling along path γ further e hotel represents the energy required to operate the vehicle s computation and sensor systems independent of propulsion and e drag denotes the energy expended to overcome drag forces exerted by the fluid t s and t g denote the beginning and end times respectively the values of k h and k d are constants determined by the auv design for a slight path segment d x d y d z in path γ assume that it is sufficiently small it can be approximated as a straight line and the thrust velocity is constant in d x d y d z the cost of d x d y d z traversed in time t is given by 4 e k h k d v p 3 t 2 3 interval response the auv trajectory γ is defined as b spline curves generated by a set of control points to measure the energy consumption along a given trajectory γ the continuous spline curves are discretized into a sequence of slight path segments k k 1 k 2 k i k i 1 k λ k λ 1 where λ denotes the number of path segments then the energy consumption can be obtained by accumulating the energy consumption of each path segment in deterministic ocean current environments the energy consumption along a given path γ is a real number because the energy consumption of each path segment e i is a real number however under uncertain ocean currents e i is an interval number e i e i where e i and e i are the minimum and maximum energy consumptions of the corresponding path segment respectively thus the energy consumption along the trajectory γ in an environment with uncertain ocean currents is the interval number 5 e e e i 1 λ e i i 1 λ e i where e e represents the interval response 2 4 vector analysis method the energy consumption of each path segment is within an interval e i e i according to equation 5 e i and e i of each path segment need to be calculated to evaluate the interval response of the path γ in general e i and e i can be obtained by an iterative optimization algorithm however this method will lead to the nested optimization problem and increase the computation time of the path planning algorithm to avoid the nested optimization mentioned above the vector analysis method is used in this study this method can solve e i and e i via simple evaluation and algebraic expression calculation which can greatly improve the calculation efficiency of the path planning algorithm before introducing the vector analysis method the following assumptions are considered to facilitate discussion the detailed proof can be found in appendix a assumption 1 the magnitudes of v p and v f are assumed to be fixed and θ represents the angle between v g and v f for θ 1 θ 2 if θ 1 θ 2 then v g 1 v g 2 assumption 2 θ and the magnitude of v p are assumed to be fixed when 0 θ π 2 the relationship between v g and v f is a convex function and v g is the maximum if and only if v f v p when π 2 θ π the relationship between v g and v f is monotonically decreasing we assume that thrust velocity v p and current vector v f are constant during navigation along a path segment this assumption is important for computing the interval response and it is reasonable when the path segment is sufficiently short such that the traveling time along path segment is smaller than the change rate of the ocean current under this assumption the energy consumption e i is linear with traveling time t i as per 4 for a path segment vector k i k i 1 the traveling time of a vehicle varies with the magnitude and direction of the ocean currents the ocean current vectors v f min and v f max correspond to the minimum and maximum traveling time within the interval ocean current and they need to be acquired to compute the interval response based on the above two assumptions the interval response of the path segment under the interval ocean current can be discussed in accordance with the pre navigating direction and the bounds of interval ocean current 1 the projection of the pre navigating direction within the bounds of the ocean current interval and 2 the projection of the pre navigating direction outside the bounds of the ocean current interval as shown in fig 3 the direction of k i k i 1 is consistent with that of v g v d min and v m min represent the direction and magnitude of v f min respectively and v d max and v m max represent the direction and magnitude of v f max respectively case 1 projection of pre navigating direction within the bounds of the ocean current interval minimum traveling time t i because t i k i k i 1 v g t i is the minimum when the net velocity v g is the maximum therefore v f min needs to be acquired to maximize v g according to assumption 1 the smaller the angle θ the larger is v g in this scenario it is easy to prove that v d min is consistent with the projection direction of k i k i 1 the angle θ min is equal to the angle between k i k i 1 and the projection of k i k i 1 then we discuss the magnitude of v f min in this case θ min denotes that the angle v d min k i k i 1 is less than π 2 because the projection of k i k i 1 is within the bounds of the ocean current interval assumption 2 indicates that when 0 θ π 2 the relationship between v g and v f is a convex function and v g is the maximum if and only if v f v p as shown in fig 5 v f equals v p cot θ when v f v p this suggests that the closer v f is to v p cot θ the larger is the value of v g thus v m min should be equal v p cot θ when v p cot θ v m v m and v m min should be as close to v p cot θ as possible when v p cot θ v m v m based on the above analysis v m min can be obtained as 6 v m min v p cot θ when v m v p cot θ v m v m min v m when v p cot θ v m v m min v m when v p cot θ v m where v p is a given constant an example of v f min is shown by the red vector in fig 4 a maximum traveling time t i similarly t i is the maximum when the net velocity v g is the minimum first assumption 1 indicates that larger the angle θ the smaller is the value of v g thus v d max k i k i 1 should be the maximum under v d max v d v d based on the definition of the interval ocean currents only the angles of v d k i k i 1 and v d n k i k i 1 need to be compared 7 v d max v d when v d k i k i 1 v d k i k i 1 v d max v d when v d k i k i 1 v d k i k i 1 then according to assumption 2 the larger the value of v f the smaller is v g when π 2 θ π therefore v m max equals v m under π 2 θ π an example of v f max 1 is shown by the red vector in fig 4 b in addition assumption 2 indicates that when 0 θ π 2 the relationship between v g and v f is a convex function that is when v f equals v m or v m v g is the minimum thus when 0 θ π 2 t v d max v m and t v d max v m are both calculated and then the larger value is selected as the maximum traveling time t i the red vectors represent v f max 1 and v f max 2 and one of them equals v f max as shown in fig 4 b case 2 projection of pre navigating direction outside the bounds of the ocean current interval minimum traveling time t i t i denotes the minimum when the net velocity v g is the maximum assumption 1 indicates that the smaller the angle θ the larger is the value of v g therefore v d min k i k i 1 should be the minimum under v d min v d v d further v d min can be obtained by 8 v d v d when v d k i k i 1 v d k i k i 1 v d v d when v d k i k i 1 v d k i k i 1 according to assumption 2 when 0 θ π 2 the relationship between v g and v f is a convex function and v g is the maximum if and only if v f v p similar to case 1 v m min can be obtained by equation 6 v f min is shown by the red vector in fig 4 c in addition assumption 2 posits that when v f is smaller v g is larger if π 2 θ π thus when π 2 θ π v m min is set as v m v f min is shown by the yellow vector in fig 4 d maximum traveling time t i according to assumption 1 θ should be the largest under v d v d therefore v d max equals to the larger value between v d k i k i 1 and v d n k i k i 1 when the reverse extension line of k i k i 1 projection is outside the bounds of the ocean current interval as shown by the red vectors in fig 4 e vice v d max is consistent with the direction of the k i k i 1 projection as shown by the red vectors in fig 4 f in addition similar to case 1 v m max equals v m under π 2 θ π and v m max equals v m or v m under 0 θ π 2 in fig 4 e and f the red vectors represent v f max 1 and v f max 2 respectively one of which is v f max through the above analysis ocean current vectors v f min and v f max can be obtained in accordance with the direction and magnitude of the ocean current vector the maximum and minimum traveling times of the path segment k i k i 1 can be computed as 9 t i δ v fx d x v fy d y v p 2 v f 2 if v p v f t i d x 2 d y 2 d z 2 2 v fx d x v fy d y if v p v f where δ v fx d x v fy d y 2 v f 2 v p 2 d x 2 d y 2 d z 2 v fx and v fy are the projections of the current v f on the x axis and y axis respectively further d x d y and d z represent the projection of the path segment k i k i 1 on the x y and z axes respectively the maximum and minimum energy consumptions of the path segment k i k i 1 can be computed by formulation 4 2 5 interval number comparison and fitness function the io algorithm is an effective method to address uncertain optimization problems wherein the information required is only the lower and upper bounds of uncertain parameters the io algorithm has already been applied in many fields including power system dispatch planning li et al 2016 product mix problems badri et al 2014 and water allocation zarghami et al 2015 the io algorithm is employed in this study to solve the problem of auv path planning in uncertain ocean current environments in the context of this study the general mathematical formulation of nonlinear optimization based on interval analysis is expressed as 10 min γ f γ v f s t γ r obstacle v f v i f v f v f v p v max where γ denotes a candidate path represented by a b spline curve generated by a set of control points v f represents the uncertain ocean current field represented by interval numbers r obstacle denotes the area of the obstacles and v max denotes the maximum propulsion speed for a candidate path the energy consumption of an auv is an interval number rather than a real number because of the uncertainties of ocean currents therefore a suitable assessment criterion is necessary to compare the interval responses of the candidate paths the reliability based possibility degree of interval rpdi jiang et al 2012 is an effective method for the quantitative comparison of interval numbers in io before rpdi is introduced two parameters about the interval number and decision making should be known the mean value of intervals is given by 11 e c 1 2 e e the width of intervals is given by 12 e w 1 2 e e the mean value e c indicates the expected value of the interval responses and the width e w denotes the uncertainty level in the context of uncertainty optimizing e c involves improving the average performance of an objective function in some way the minimization of e w can help reduce the fluctuation of the objective function under an uncertain ocean current environment which can thus enhance the robustness of the resultant paths the rpdi is a method of converting interval number comparison into a real number comparison for interval numbers e a and e b the rpdi can be expressed as 13 p e a i e b i e b r e a l 2 e a w 2 e b w where p e a i e b i represents the degree of e a i e b i the range of p e a i e b i is a reference interval v i v l v r must be introduced in the rpdi the uncertain objective function can then be transformed into a deterministic objective function by substituting the rpdi model into formula 10 the path planning problem in uncertain currents can be expressed as 14 min γ p v i e i γ v f e r γ v f v l 2 e w γ v f 2 v w s t γ r obstacle v f v i f v f v f v p v max the reference interval has some influence on the optimization results which requires the designer to select the value based on their experience based on multiple simulations we determined that the optimization results are better when the width of the reference interval is large further we found that v l has little influence on the optimization results in summary the response interval of the candidate path can be converted to a real value in addition the problem of optimal path planning for auvs under uncertain ocean current fields is transformed into a deterministic multiobjective path planning problem 3 io algorithm in this section we present the io algorithms for solving the problem of time optimal path planning in uncertain ocean current fields which combines interval mathematics and the qpso algorithm the structure and complexity of the io algorithm are introduced 3 1 structure of io algorithm fig 6 shows the io algorithm structure of the time optimal path planning for clarity the algorithms can be classified as outer and inner algorithms in the outer algorithm qpso is used to generate candidate paths and search for the optimal path in the inner algorithm the fitness value of the candidate path is evaluated by the dotted box in fig 6 a detailed description of the outer and inner algorithms can be found in appendix b as shown in fig 7 the 3d b spline curve path can be generated by a set of control points the set of control points corresponds to a unique 3d b spline curve path the coordinates and tangent directions of any point on the b spline curve path can be obtained according to the b spline curve equation and its derivative equation points 1 and 7 denote the starting point and destination of the mission respectively their positions need to be set before path planning the positions of the remaining five control points are optimized in the path planning process in the scheme of time optimal path planning the overall traveling time and energy consumption interval of each path can be obtained as first the continuous b spline curves path is discretized into a sequence of slight path segments k k 1 k 2 k i k i 1 k λ k λ 1 where λ denotes the number of path segments second for each path segment k i k i 1 i 1 2 λ the minimum traveling time t i and maximum traveling time t i can be calculated using the vector analysis method described in section 2 4 the minimum and maximum energy consumption e i e i can be evaluated according to formula 4 finally the minimum and maximum traveling times of the overall path are equal to i 1 λ t i and i 1 λ t i respectively similarly the minimum and maximum energy consumption of the overall path are respectively equal to i 1 λ e i and i 1 λ e i 3 2 complexity of io algorithm the asymptotic computational complexity of path planning algorithms is quantified in this section as shown in algorithm 1 of appendix b the main loop includes two loop bodies while loop and for loop the complexity of the while loop is o x max in the worst situation where x max denotes the maximum number of iterations the complexity of the for loop is o n where n denotes the population size the computational complexity of qpso is o n x max f c where f c represents the complexity inside the for loop the computational complexity of the io algorithm is largely decided by f c as shown in fig 6 the time optimal path planning algorithm includes three parts the main loop based on qpso path generation based on the b spline curve and cost evaluation traveling time or energy consumption of the path segment when generating a path the b spline curve is divided into n p path segments the complexity of each path segment is o 1 and hence generating a path has a complexity of o n p in the cost evaluation function the cost of each segment is computed with a vector analysis method for which the complexity is o 1 the complexity of the cost evaluation function is o n p therefore f c is equal to o n p and the computing complexity of the path planning algorithm is o n x max n p 4 simulation the simulation results obtained for the time optimal path planning in ocean environments with uncertain current fields are shown and analyzed in this section the objective is to estimate the performance of the io algorithm in the path planning problem em wang et al 2016 and the deterministic flow field dff scheme are implemented to assess the performance of the proposed io scheme then 1000 random flow fields with a gaussian distribution are generated to verify the performance of the path obtained by the three schemes the algorithms were implemented using matlab 2019b mathworks on an intel core i7 processor with a processing speed of 2 6 ghz 6 and 16 gb ram 4 1 simulation setup the ocean current data are obtained from the mrpds the data are updated every 24 h the initial and final destination points are located at 21 n 119 e and 26 n 124 e respectively the starting time was 0 00 on january 1 1992 the search space is set to a square area from 21 n to 26 n between 119 e and 124 e with 0 1 resolution which is 550 km 550 km the flow field and search region are shown in fig 8 the mean current velocity v mean and the maximum current velocity v max encountered in the domain are 0 3 m s and 1 5 m s respectively the cost function parameters are set as k h 0 005 and k d 1 4 2 simulations results this section compares the performance of the three schemes under a constant thrust speed in uncertain and time varying flow fields because the thrust speed is constant the energy consumption of the vehicles is only related to the traveling time according to 4 i e the time optimal path planning the thrust speed is set as 0 8 m s io em and dff are set as follows 1 io scheme each individual b spline path is formed by five control points then the b spline curved path is uniformly subdivided into 1000 path segments the number of points is conservatively selected such that it is sufficiently large to guarantee that the spline formed paths closely conform to the intended paths in the outer algorithm the population size of qpso is 100 and the maximum number of iterations is 200 in the io scheme the uncertainties of the ocean current magnitude and direction are set as σ m 0 3 and σ d 30 the reference interval v i is set as 100 1100 i e v l and v w are 100 and 500 respectively 2 em the em is an approximate approach to path planning in uncertain flows it involves generating a finite size ensemble of the current fields according to the gaussian distribution which is denoted as the initial current fields for each current field in the initial current fields a deterministic path planning algorithm is applied to generate the optimal paths then the result paths are evaluated by a large number of random current fields with gaussian distribution the best performance path is selected as the result path of em in the em scheme the ensemble size is set to 64 3 dff scheme the dff scheme is a special case of the io scheme under σ m 0 and σ d 0 therefore the dff scheme has a similar architecture as io however solving the interval response is replaced by simply computing the energy consumption the time optimal paths generated by the three schemes are shown in fig 9 a and b fig 9 a shows the 3d view and fig 9 b shows the top view to show the path change in depth clearly the depth axis is enlarged in fig 9 a the total depth is 1 2 km which is only 0 22 of the horizontal length the green and red circles represent the start point and destination respectively a comparison of the optimal paths shown in fig 9 a indicates that the io scheme takes a deeper navigation route than the other two schemes normally the current velocity decreases as depth increases as shown in fig 9 b the dff and em schemes select the downstream region to reduce the energy consumption especially in the latter half of the paths however the io scheme chooses the region with small currents the convergence curves showing the best fitness values for the io and dff schemes with the corresponding numbers of iterations are shown in fig 9 c the fitness functions of io and dff are equal to p v i e i γ v f and f γ v f respectively the fitness values of the io and dff schemes are not of comparative significance because their fitness functions are different fig 9 c shows that the first 20 iterations do not find a feasible path in the io scheme and the dff scheme has a higher rate of convergence than the io scheme this is because the uncertainty of ocean currents is considered in the io scheme which increases the probability that the path is unfeasible compared with the dff scheme the io scheme is more rigorous in path evaluation which increases the difficulty of path searching and reduces its convergence rate in terms of computation time the io and dff schemes are more efficient and effective than em because it needs to perform deterministic path planning 64 times the computation times of io and dff are 119 s and 97 s respectively and that of em is 3 53 103 s 4 3 robustness assessment a total of 1000 flow fields are randomly generated to evaluate the resultant path performance of each scheme in which the current direction obeys n μ d i r e c t σ d i r e c t and the current magnitude obeys n μ m a n g i σ m a n g i μ d i r e c t and μ m a n g i respectively equal the predicted direction and magnitude of currents σ d i r e c t and σ m a n g i are set as 15 and 0 15 m s respectively it should be noted that the 95 confidence intervals of the current direction and magnitude are equal to the interval widths of the current direction and magnitude set in the io scheme this implies that the io scheme can solve the 95 impact caused by uncertainty however the other 5 is not solved the information of each path running in 1000 flow fields is presented in table 1 a hypothetical propulsion speed is set for the path planning and the auv will travel on the resulting path at this speed however the auv may not be able to follow the resulting path because of the uncertainty of ocean currents the accessibility region of a vehicle is a sector where the current velocity is greater than the vehicle propulsion speed soulignac 2011 moreover as the current velocity increases the angle of sector decreases therefore if the actual current velocity is greater than the predicted current velocity and it causes a path segment to be out of the accessibility region the resulting path cannot be followed the larger the current velocity of the region passed by the resulting path the greater is the probability of failure however during a real mission the velocity of the auv will not be strictly limited to the hypothetical propulsion speed instead it can be adjusted within the propulsion capability to maintain the path according to actual ocean currents therefore if a path segment is not feasible the propulsion speed and energy consumption on this path segment are recalculated as shown in fig 10 the calculation method is discussed according to angle θ between the path segment k i k i 1 and current vector v f 1 if θ 90 the propulsion speed of the auv must be greater than or equal to v p min for the auv to travel along k i k i 1 as shown in fig 10 a here v p min is called the minimum accessible velocity which is equal to v f sin θ 2 if θ 90 the propulsion speed of the auv must be greater than v f as shown in fig 10 b v p min is equal to v f ε where ε is a small value in this section ε is set as 0 01 m s in summary if a path segment is not feasible the minimum accessible velocity will be calculated based on the above method if the minimum accessible velocity is less than or equal to the maximum propulsion speed provided by the auv the energy consumption of the path segment is calculated using the minimum accessible velocity if the minimum accessible speed is larger than the maximum propulsion speed the path is considered unfeasible and it thus returns a failure the maximum propulsion speed provided by the auv is set as 1 m s the statistical results listed in table 1 indicate that the io scheme generates the path with the lowest failure count this finding suggests that the io scheme has better robustness in uncertain flow fields compared with that for dff and em as shown in fig 9 b the io scheme selects a path with small currents to decrease the probability of failure and enhance the robustness of the resulting path furthermore compared with the other two schemes the io scheme selects a deeper navigation path as shown in fig 9 a this is because the current velocity decreases with the depth a deeper path is beneficial for reducing the probability of failure however large downstream currents help reduce the traveling time and minimize the energy consumption of the vehicles thus the mean traveling time of the io scheme is higher than that of the two other schemes because the io scheme needs to compromise between reliability and traveling time in uncertain current fields in addition the performance of em is better than that of the dff scheme but it is worse than that of the io scheme the performance of the em can be improved by increasing the size of the initial current fields however the computation time increases linearly 4 4 robustness assessment for different uncertainties to further evaluate the influence of ocean current uncertainty on auv path planning robustness assessments under different uncertainties are conducted in the io scheme the path needs to be planned according to the uncertainty the parameters σ m and σ d in the io scheme are set as 2 σ d i r e c t and 2 σ m a n g i such that σ m and σ d are 10 and 0 1 m s respectively when σ d i r e c t 5 and σ m a n g i 0 05 m s the simulation results are presented in table 2 as shown in table 2 the statistical results indicate that the mean energy consumption increases with an increase in uncertainty the mean energy consumption of the io scheme is higher than that of the other two schemes moreover with the increase in uncertainty the energy consumption of the io scheme increases faster than that of the dff scheme when σ d i r e c t 5 and σ m a n g i 0 05 m s the energy consumption difference between the io and dff is only 0 46 however the difference reaches 7 07 when σ d i r e c t 20 and σ m a n g i 0 2 m s this is because as the uncertainty increases the io scheme requires higher energy consumption to enhance the robustness of the path in the em scheme the mean energy consumption shows strong randomness which has little relation with uncertainty for example the mean energy consumption is up to 415 6 kj at σ d i r e c t 10 and σ m a n g i 0 05 m s which is even higher than the mean energy consumption when σ d i r e c t 20 and σ m a n g i 0 15 m s this is caused by the em scheme s search mechanism in fact the performance of the em scheme depends on the number of initial flow fields in terms of failure count all three schemes are zero when σ d i r e c t 5 however with the increase in σ d i r e c t the failure count of the dff scheme increases significantly in particular when σ d i r e c t 20 the failure count is as high as in the hundreds this means that the probability that the dff path can be successfully tracked is at most 80 when σ d i r e c t 20 such path planning is dangerous and has low practicability because of low reliability however it has low mean energy consumption the reliability of the em scheme is greatly improved compared with the dff scheme however as analyzed in the previous paragraph the stability of em remains poor the failure count of the io scheme is at most 2 which is considerably lower than those of the two other schemes in fact 95 4 of infeasible paths under a gaussian distribution have been excluded in the optimization process of the io scheme therefore the path generated by the io scheme has strong robustness and it guarantees the safety and stability for auv navigation in conclusion when σ d i r e c t is less than 10 the uncertainty has little impact on auv navigation each scheme has only a few failures in simulations however the energy consumption of the dff scheme is minimal therefore the performance of the dff scheme is optimal among the three schemes when the level of uncertainty is low however when σ d i r e c t is 15 the influence of uncertainty on auv navigation gradually appears in the dff scheme moreover the influence increases sharply when σ d i r e c t 20 in the io scheme the probability that the planned path cannot be tracked is minimal at most 0 2 and this considerably reduces the effect of uncertainty on auv navigation thus the performance of the io scheme is optimal in the three schemes when the level of uncertainty is high 5 conclusion this paper presented a time optimal path planning algorithm for auvs under ocean environments with uncertain and time varying flow fields in this scheme uncertain ocean currents were expressed as intervals the interval response was obtained by the proposed vector analysis method and it was then transformed into a deterministic number using an rpdi simulation tests were performed in uncertain and time varying flow fields and random flow fields with gaussian distribution errors were used to assess the robustness of the paths generated by the io em and dff schemes the simulation results indicate that em is time consuming and em performance is unstable further the path found by the io scheme is more reliable than those found by the em and dff schemes however the io scheme consumes more energy than the em and dff schemes credit authorship contribution statement xuliang yao conceptualization methodology supervision funding acquisition feng wang conceptualization methodology software formal analysis writing original draft writing review editing changshun yuan software validation writing review editing visualization jingfang wang methodology validation formal analysis investigation xiaowei wang software formal analysis writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the high technology vessel project of china no ky10400170181 appendix a in this appendix we provide the proof of assumptions 1 and 2 we define v f as the ocean current vector v p as the thrust velocity vector x i x i 1 as the pre navigating vector v g as the vehicle velocity with respect to the seabed in which the direction is consistent with the direction of x i x i 1 and θ as the angle between v f and x i x i 1 assumption 1 the magnitudes of v p and v f are assumed to be fixed and θ represents the angle between x i x i 1 and v f for θ 1 θ 2 if θ 1 θ 2 then v g 1 v g 2 proof 1 when 0 θ 1 θ 2 π 2 v p and v f are decomposed in the tangential and normal directions of v g as 24 v p t v f t v g v p s v f s 0 where the upper corner marks s and t represent the normal and tangential directions respectively as shown in fig 11 a v f 1 s v f 2 s v p 1 s v p 2 s v p and v f are fixed and v p 1 t v p 2 t and v f 1 t v f 2 t therefore v g 1 v g 2 2 when π 2 θ 1 θ 2 π as shown in fig 11 b the relation is obtained as follows in accordance with the cosine theorem reduction to absurdity is used and we assume that v g 1 v g 2 then the conclusion and condition are contradicting and hence assumption 1 is correct under π 2 θ 1 θ 2 π 3 when 0 θ 1 π 2 and π 2 θ 2 π the relation is obtained as v g 1 v g π 2 and v g π 2 v g 2 where v g π 2 denotes the vehicle velocity with θ π 2 thus v g 1 v g 2 fig 11 relationship of v f v p and v g with fixed v p and v f under different θ values fig 11 assumption 2 θ and the magnitude of v p are assumed to be fixed when 0 θ π 2 the relationship between v g and v f is a convex function and v g is the maximum if and only if v f v p when π 2 θ π the relationship between v g and v f is monotonically decreasing proof 1 when 0 θ π 2 as shown in fig 12 a the following expression is obtained based on the sine theorem 25 sin θ v p sin α v g where α represents the angle between v f and v p and θ and v p are fixed consequently the value of sin α v p is constant v g v p sin α sin θ when v f is perpendicular to v p that is α π 2 the value of v g is the maximum with a decrease or an increase in v f α monotonically decreases or increases from α π 2 and sin α monotonically decreases therefore when 0 θ π 2 the relationship between v g and v f is a convex function and v g is the maximum if and only if v f v p 2 when π 2 θ π as shown in fig 12 b then similar to case 1 v g v p sin α sin θ the inner angle sum of the triangle is equal to π and therefore α is less π 2 under the condition π 2 θ π with a decrease or an increase in v f α decreases or increases whereas sin α increases or decreases therefore when π 2 θ π the relationship between v g and v f monotonically decreases fig 12 relationship of v f v p and v g with fixed θ and v p under different v f values fig 12 appendix b outer algorithm the pseudocode for the outer algorithm is presented in algorithm 1 where pbest denotes the individual optimal position and gbest denotes the global optimal position algorithm 1 outer algorithm image 3 the outer algorithm depends on the iterative qpso algorithm for searching and optimizing the paths the detailed implementation of the outer algorithm for path planning can be described as follows step 1 initialization of the qpso algorithm as shown in algorithm 1 the parameters that need to be initialized are the population size n and the maximum number of iterations x max step 2 randomly generate an initial swarm of particles every particle in the swarm represents a potential path the position of the ith particle is defined as 23 p i p i 1 p i j p i k where p i j represents the coordinate of the jth control point the dimension k of a particle represents the number of control points set each particle s current best position p i 0 as p i 0 in addition the annular space decomposition asd approach zeng et al 2014 was applied to distribute the control points evenly and reasonably in the asd scheme the 2d search space is decomposed into layers radiating from the start point to the destination and the control points are evenly assigned to all layers control points can move freely within their respective layers step 3 for each iteration evaluate mbest which is defined as the mean of the best position of all particles step 4 for each particle generate the b spline curve using control points represented by the particle p i x c then the continuous spline curves are discretized into a set of path segments using uniform subdivision step 5 for each path evaluate the fitness value f p i x c using the vector analysis as described in section 2 4 and the interval number comparison as described in section 2 5 step 6 update the ith particle s individual best position p i x c and the swarm s global best position g using 17 and 18 respectively step 7 calculate and update each dimension of the particle using 19 22 in this step the particle is attracted by p i x c and g the contraction expansion coefficient is represented as τ which can be tuned to control the convergence speed of the algorithms ϕ i j denotes a random number distributed uniformly in 0 1 ψ i j denotes the potential well length which represents the search scope of the particles step 8 repeat steps 3 7 until the program meets the stop criterion inner algorithm the inner algorithm of time optimal path planning can be obtained by combining the vector analysis method and the reliability based possibility degree of interval rpdi described in sections 2 4 and 2 5 algorithm 2 inner algorithm image 4 
20612,the predictive uncertainty of ocean currents needs to be considered in the path planning of autonomous underwater vehicles auv in oceanic environments an interval optimization io scheme is presented in this paper to plan time optimal paths for auvs operating in oceanic environments with dynamic and uncertain flow fields interval currents are established to process the uncertainty of forecasted ocean flows and the io scheme is used to search for time optimal paths in the interval current fields the io scheme is a two layer framework in the outer layer quantum behaved particle swarm optimization is used to generate and optimize candidate paths in the inner layer the interval response of the candidate path from the outer layer is calculated under interval current fields and they are converted into a time optimal fitness value in accordance with the possibility degree of interval numbers the influence of predictive uncertainty is analyzed via simulation and the robustness of the io scheme is verified keywords interval optimization uncertain ocean currents autonomous underwater vehicles path planning abbreviations auvs autonomous underwater vehicles qpso quantum behaved particle swarm optimization mdp markov decision processes rpdi reliability based possibility degree of interval io interval optimization em ensemble method dff deterministic flow field 1 introduction autonomous underwater vehicles auvs have been extensively used to perform various complex missions such as oceanographic surveys wynn et al 2014 target tracking shojaei and dolatshahi 2017 and monitoring bayat et al 2017 because of their outstanding capability to work in remote or hazardous scenarios they provide a means of continuously monitoring specific regions and for measuring ocean parameters because they can work for a long time underwater at considerably lower operating costs than those of the manned research vessels however the limited energy capacity of auvs restricts their range and endurance during deployment path planning is a critical part of the auv control system and it not only determines the level of autonomy of the auv but also the premise of the reliability of a mission and the likelihood of success zeng et al 2015 the path planner needs to be capable of finding a trajectory that safely leads the auv from its initial or current position to its destination with various objectives for example based on minimizing the risk of collision with ships and land pereira et al 2013 traveling time wang et al 2019 energy consumption subramani and lermusiaux 2016 and maximizing data collection khan et al 2019 under different mission scenarios such as inspection lin et al 2018 and target tracking kim et al 2018 in this research we focus on optimizing the traveling time of auvs the high inertia of ocean environments provides a good opportunity for vehicles to exploit ocean currents for efficient navigation thus various solution approaches have been developed to determine time or energy optimal paths in the current fields the graph based search method is extensively used in path planning algorithms such as the dijkstra algorithm niu et al 2018 and the a algorithm lee et al 2015 hernandez et al 2015 singh et al 2018 song et al 2019 which have good consistency and convergence as they employ a discretized representation of the environment called a grid map however the final paths are not always optimal and have redundant turns because the search space is limited by the grid cell further the graph searching algorithms cannot easily address the optimal path planning problem in environments with time varying ocean currents kularatne et al 2018a the level set scheme is another efficient path planning method for auvs that considers continuous strong and dynamic ocean currents this scheme was proposed for time optimal planning in a dynamic flow field lolla et al 2014a 2014b then an improved level set optimization methodology was presented to compute energy optimal paths wherein the relative vehicle speed and headings are considered stochastic subramani et al 2016 2017a b however the underlying motion model behind the level set method includes a velocity model which is often very restrictive metaheuristic optimization algorithms are efficient for solving path planning problems with an np hard and multiobjective nature tang et al 2016 integrated particle swarm optimization pso with the differential evolution de algorithm to solve the global path planning problem efficiently a dynamic augmented multiobjective pso mopso ma et al 2018 was proposed to generate an energy efficient path by considering multiple objectives and constraints the alarm pheromone assisted ant colony system was proposed to deal with path planning problems in large scale spaces with nonlinearity and constraint issues of the auv ma et al 2019 however these works use only a grid map that cannot be applied in an environment with a continuous flow field a shell space decomposition scheme integrated with a quantum behaved particle swarm optimization qpso was presented to obtain time and energy optimal paths in 3d space with cluttered currents and uncertain obstacles zeng et al 2014 2019 a comparison of optimization techniques for auv path planning in environments with ocean currents is performed including a rrt rrt genetic algorithm ga pso and qpso the results show that qpso outperforms the other five algorithms in terms of path optimality zeng et al 2016 the differential evolution de algorithm is employed to generate time efficient paths within a complex 3d underwater environment incorporated with turbulent current vector fields coastal areas islands and static dynamic obstacles zadeh et al 2018a the de scheme was compared with three state of art evolutionary algorithms pso biogeography based optimization and firefly algorithm zadeh et al 2018b niu et al 2020 proposed a novel energy efficient path planning algorithm to address challenges with the presence of spatially temporally variant sea current and complex geographic map data by integrating the following algorithms voronoi roadmap dijkstra s searching coastline expanding and ga in addition several researchers applied path planning algorithms in real time sea exercises with real auvs and they verified the importance and effectiveness of path planning edwards et al 2017 subramani et al 2017a b the majority of the aforementioned studies assume that the full knowledge of ocean currents in space and time are available note that forecasting ocean current velocities is complex and difficult and this complexity coupled with the limited understanding of the dynamics of ocean currents results in uncertainty in the prediction of ocean currents further low spatiotemporal sampling resolutions and limited accuracies of measurement devices contribute to errors in the data used to initialize forecasting models therefore a major challenge in path planning is the uncertainty of ocean currents the effect of uncertainties in ocean current prediction on path planning has been analyzed zeng et al 2019 the results indicate that neglecting ocean current uncertainty in path planning can lead to significant wastage of energy in the auvs even if the outcome path is not feasible when the level of uncertainty is high recently progress has been achieved in path planning for autonomous robots in uncertain environments a nonlinear robust model predictive control method was developed to compute a minimum energy cost policy under forecast uncertainties in time varying ocean flows by huynh et al 2015 however their path planner can only be used for small ranges because the computational time cannot exceed the sampling time of the predictive control algorithm the markov decision process mdp has been used to plan paths with minimum time in wind fields ai sabban et al 2013 and to compute the minimum expected energy paths kularatne et al 2018b in ocean environments with uncertain flow fields however the mdp has a high computational cost an ensemble approach em has also been presented to obtain the statistics of optimal trajectories wang et al 2016 although em can considerably improve the stability of the result paths it requires a large initial flow field ensemble and it performs deterministic path planning for each flow field this considerably increases the computation time currently the level set approach subramani et al 2018 is used to complete stochastic reachability and time optimal path planning and to quantify the sensitivity of time optimal paths to forecast errors to solve the auv path planning problem under uncertain ocean currents this paper proposes an interval based optimization algorithm such an approach can help us choose an appropriate path to offset the effect of errors on ocean current predictions the proposed scheme is a two layer optimization framework that is based on the interval optimization io theory in the inner layer we calculate the interval response i e upper and lower bounds for a candidate path using the vector analysis method in the outer layer we search for the optimal path among all candidate paths using qpso the main contributions of this paper are summarized as follows 1 an algorithm that combines qpso and interval optimization is presented to enhance the robustness of the path planner for an auv in uncertain flow fields 2 the vector analysis method is derived to evaluate the interval responses this greatly improves the computational efficiency of the path planning algorithm 2 problem formulation 2 1 ocean field environment oceans are extremely complex dynamic systems and many of their phenomena and dynamic processes are difficult to track and predict inevitable differences exist between actual and modeled values of physical fields and properties these difference cause fundamental limitations in the predictability of nonlinear dynamics therefore most predicted ocean current data are uncertain and it is difficult to estimate a correct probability distribution function from these data in contrast estimating the two bounds of the ocean current vector is easier and more computationally feasible than acquiring precise ocean currents or probability distributions thus interval currents are constructed to represent uncertainties in the proposed scheme in this study the 3d environment w r 3 is considered this environment is subject to a time varying uncertain flow field v f w t r 3 where w t w t t and t t r 0 denote the time interval under consideration for x w and t t t v f x t v m x t v d x t denotes the uncertain ocean current v m x t and v d x t represent the magnitude and direction of the uncertain current vector respectively the uncertainty in the flow velocity vector can be simulated by 1a v m x t v m x t v m x t 1 σ m v m x t 1 σ m v m x t 1b v d x t v d x t v d x t v d x t σ d v d x t σ d where v m x t and v d x t respectively represent the magnitude and direction of the deterministic flow velocity these values are defined as the nominal magnitude and direction of ocean currents respectively similarly v f x t is defined as the nominal ocean current and it can be obtained from ocean current prediction systems such as the regional ocean modeling system σ m and σ d represent forecast uncertainties in terms of magnitude and direction respectively where σ m 1 they can be computed and estimated through historical nowcasts and forecasts respectively because horizontal ocean currents and propulsion velocity are considerably stronger than the vertical ones the latter are ignored in the ocean current model the model of the interval current vector is shown in fig 1 an example of a 2d interval flow field is shown in fig 2 in this study the nominal current fields used for the analysis were obtained from the marine reanalysis product data set mrpds http ocean geodata cn the mrpds provides daily ocean current data with a 0 1 spatial resolution from 99 e to 134 e between 1 n and 30 n which is an area in and around the south china sea the vertical direction is divided into 24 layers from sea level to 1200 m 2 2 cost evaluation an auv is assumed to be a holonomic kinematic model this assumption is reasonable when the dimensions of the auv are smaller than those of the flow structures using this model the net velocity v g x t of vehicles with respect to the seabed can be obtained as 2 v g x t v p x t v f x t where v p denotes the thrust velocity of the vehicle generated by the propulsion system the cost function kularatne et al 2018 that represents the energy consumption of the auv is given as 3 e γ e hotel e drag t s t g k h k d v p γ t 3 d t where e γ denotes the energy consumption of vehicles traveling along path γ further e hotel represents the energy required to operate the vehicle s computation and sensor systems independent of propulsion and e drag denotes the energy expended to overcome drag forces exerted by the fluid t s and t g denote the beginning and end times respectively the values of k h and k d are constants determined by the auv design for a slight path segment d x d y d z in path γ assume that it is sufficiently small it can be approximated as a straight line and the thrust velocity is constant in d x d y d z the cost of d x d y d z traversed in time t is given by 4 e k h k d v p 3 t 2 3 interval response the auv trajectory γ is defined as b spline curves generated by a set of control points to measure the energy consumption along a given trajectory γ the continuous spline curves are discretized into a sequence of slight path segments k k 1 k 2 k i k i 1 k λ k λ 1 where λ denotes the number of path segments then the energy consumption can be obtained by accumulating the energy consumption of each path segment in deterministic ocean current environments the energy consumption along a given path γ is a real number because the energy consumption of each path segment e i is a real number however under uncertain ocean currents e i is an interval number e i e i where e i and e i are the minimum and maximum energy consumptions of the corresponding path segment respectively thus the energy consumption along the trajectory γ in an environment with uncertain ocean currents is the interval number 5 e e e i 1 λ e i i 1 λ e i where e e represents the interval response 2 4 vector analysis method the energy consumption of each path segment is within an interval e i e i according to equation 5 e i and e i of each path segment need to be calculated to evaluate the interval response of the path γ in general e i and e i can be obtained by an iterative optimization algorithm however this method will lead to the nested optimization problem and increase the computation time of the path planning algorithm to avoid the nested optimization mentioned above the vector analysis method is used in this study this method can solve e i and e i via simple evaluation and algebraic expression calculation which can greatly improve the calculation efficiency of the path planning algorithm before introducing the vector analysis method the following assumptions are considered to facilitate discussion the detailed proof can be found in appendix a assumption 1 the magnitudes of v p and v f are assumed to be fixed and θ represents the angle between v g and v f for θ 1 θ 2 if θ 1 θ 2 then v g 1 v g 2 assumption 2 θ and the magnitude of v p are assumed to be fixed when 0 θ π 2 the relationship between v g and v f is a convex function and v g is the maximum if and only if v f v p when π 2 θ π the relationship between v g and v f is monotonically decreasing we assume that thrust velocity v p and current vector v f are constant during navigation along a path segment this assumption is important for computing the interval response and it is reasonable when the path segment is sufficiently short such that the traveling time along path segment is smaller than the change rate of the ocean current under this assumption the energy consumption e i is linear with traveling time t i as per 4 for a path segment vector k i k i 1 the traveling time of a vehicle varies with the magnitude and direction of the ocean currents the ocean current vectors v f min and v f max correspond to the minimum and maximum traveling time within the interval ocean current and they need to be acquired to compute the interval response based on the above two assumptions the interval response of the path segment under the interval ocean current can be discussed in accordance with the pre navigating direction and the bounds of interval ocean current 1 the projection of the pre navigating direction within the bounds of the ocean current interval and 2 the projection of the pre navigating direction outside the bounds of the ocean current interval as shown in fig 3 the direction of k i k i 1 is consistent with that of v g v d min and v m min represent the direction and magnitude of v f min respectively and v d max and v m max represent the direction and magnitude of v f max respectively case 1 projection of pre navigating direction within the bounds of the ocean current interval minimum traveling time t i because t i k i k i 1 v g t i is the minimum when the net velocity v g is the maximum therefore v f min needs to be acquired to maximize v g according to assumption 1 the smaller the angle θ the larger is v g in this scenario it is easy to prove that v d min is consistent with the projection direction of k i k i 1 the angle θ min is equal to the angle between k i k i 1 and the projection of k i k i 1 then we discuss the magnitude of v f min in this case θ min denotes that the angle v d min k i k i 1 is less than π 2 because the projection of k i k i 1 is within the bounds of the ocean current interval assumption 2 indicates that when 0 θ π 2 the relationship between v g and v f is a convex function and v g is the maximum if and only if v f v p as shown in fig 5 v f equals v p cot θ when v f v p this suggests that the closer v f is to v p cot θ the larger is the value of v g thus v m min should be equal v p cot θ when v p cot θ v m v m and v m min should be as close to v p cot θ as possible when v p cot θ v m v m based on the above analysis v m min can be obtained as 6 v m min v p cot θ when v m v p cot θ v m v m min v m when v p cot θ v m v m min v m when v p cot θ v m where v p is a given constant an example of v f min is shown by the red vector in fig 4 a maximum traveling time t i similarly t i is the maximum when the net velocity v g is the minimum first assumption 1 indicates that larger the angle θ the smaller is the value of v g thus v d max k i k i 1 should be the maximum under v d max v d v d based on the definition of the interval ocean currents only the angles of v d k i k i 1 and v d n k i k i 1 need to be compared 7 v d max v d when v d k i k i 1 v d k i k i 1 v d max v d when v d k i k i 1 v d k i k i 1 then according to assumption 2 the larger the value of v f the smaller is v g when π 2 θ π therefore v m max equals v m under π 2 θ π an example of v f max 1 is shown by the red vector in fig 4 b in addition assumption 2 indicates that when 0 θ π 2 the relationship between v g and v f is a convex function that is when v f equals v m or v m v g is the minimum thus when 0 θ π 2 t v d max v m and t v d max v m are both calculated and then the larger value is selected as the maximum traveling time t i the red vectors represent v f max 1 and v f max 2 and one of them equals v f max as shown in fig 4 b case 2 projection of pre navigating direction outside the bounds of the ocean current interval minimum traveling time t i t i denotes the minimum when the net velocity v g is the maximum assumption 1 indicates that the smaller the angle θ the larger is the value of v g therefore v d min k i k i 1 should be the minimum under v d min v d v d further v d min can be obtained by 8 v d v d when v d k i k i 1 v d k i k i 1 v d v d when v d k i k i 1 v d k i k i 1 according to assumption 2 when 0 θ π 2 the relationship between v g and v f is a convex function and v g is the maximum if and only if v f v p similar to case 1 v m min can be obtained by equation 6 v f min is shown by the red vector in fig 4 c in addition assumption 2 posits that when v f is smaller v g is larger if π 2 θ π thus when π 2 θ π v m min is set as v m v f min is shown by the yellow vector in fig 4 d maximum traveling time t i according to assumption 1 θ should be the largest under v d v d therefore v d max equals to the larger value between v d k i k i 1 and v d n k i k i 1 when the reverse extension line of k i k i 1 projection is outside the bounds of the ocean current interval as shown by the red vectors in fig 4 e vice v d max is consistent with the direction of the k i k i 1 projection as shown by the red vectors in fig 4 f in addition similar to case 1 v m max equals v m under π 2 θ π and v m max equals v m or v m under 0 θ π 2 in fig 4 e and f the red vectors represent v f max 1 and v f max 2 respectively one of which is v f max through the above analysis ocean current vectors v f min and v f max can be obtained in accordance with the direction and magnitude of the ocean current vector the maximum and minimum traveling times of the path segment k i k i 1 can be computed as 9 t i δ v fx d x v fy d y v p 2 v f 2 if v p v f t i d x 2 d y 2 d z 2 2 v fx d x v fy d y if v p v f where δ v fx d x v fy d y 2 v f 2 v p 2 d x 2 d y 2 d z 2 v fx and v fy are the projections of the current v f on the x axis and y axis respectively further d x d y and d z represent the projection of the path segment k i k i 1 on the x y and z axes respectively the maximum and minimum energy consumptions of the path segment k i k i 1 can be computed by formulation 4 2 5 interval number comparison and fitness function the io algorithm is an effective method to address uncertain optimization problems wherein the information required is only the lower and upper bounds of uncertain parameters the io algorithm has already been applied in many fields including power system dispatch planning li et al 2016 product mix problems badri et al 2014 and water allocation zarghami et al 2015 the io algorithm is employed in this study to solve the problem of auv path planning in uncertain ocean current environments in the context of this study the general mathematical formulation of nonlinear optimization based on interval analysis is expressed as 10 min γ f γ v f s t γ r obstacle v f v i f v f v f v p v max where γ denotes a candidate path represented by a b spline curve generated by a set of control points v f represents the uncertain ocean current field represented by interval numbers r obstacle denotes the area of the obstacles and v max denotes the maximum propulsion speed for a candidate path the energy consumption of an auv is an interval number rather than a real number because of the uncertainties of ocean currents therefore a suitable assessment criterion is necessary to compare the interval responses of the candidate paths the reliability based possibility degree of interval rpdi jiang et al 2012 is an effective method for the quantitative comparison of interval numbers in io before rpdi is introduced two parameters about the interval number and decision making should be known the mean value of intervals is given by 11 e c 1 2 e e the width of intervals is given by 12 e w 1 2 e e the mean value e c indicates the expected value of the interval responses and the width e w denotes the uncertainty level in the context of uncertainty optimizing e c involves improving the average performance of an objective function in some way the minimization of e w can help reduce the fluctuation of the objective function under an uncertain ocean current environment which can thus enhance the robustness of the resultant paths the rpdi is a method of converting interval number comparison into a real number comparison for interval numbers e a and e b the rpdi can be expressed as 13 p e a i e b i e b r e a l 2 e a w 2 e b w where p e a i e b i represents the degree of e a i e b i the range of p e a i e b i is a reference interval v i v l v r must be introduced in the rpdi the uncertain objective function can then be transformed into a deterministic objective function by substituting the rpdi model into formula 10 the path planning problem in uncertain currents can be expressed as 14 min γ p v i e i γ v f e r γ v f v l 2 e w γ v f 2 v w s t γ r obstacle v f v i f v f v f v p v max the reference interval has some influence on the optimization results which requires the designer to select the value based on their experience based on multiple simulations we determined that the optimization results are better when the width of the reference interval is large further we found that v l has little influence on the optimization results in summary the response interval of the candidate path can be converted to a real value in addition the problem of optimal path planning for auvs under uncertain ocean current fields is transformed into a deterministic multiobjective path planning problem 3 io algorithm in this section we present the io algorithms for solving the problem of time optimal path planning in uncertain ocean current fields which combines interval mathematics and the qpso algorithm the structure and complexity of the io algorithm are introduced 3 1 structure of io algorithm fig 6 shows the io algorithm structure of the time optimal path planning for clarity the algorithms can be classified as outer and inner algorithms in the outer algorithm qpso is used to generate candidate paths and search for the optimal path in the inner algorithm the fitness value of the candidate path is evaluated by the dotted box in fig 6 a detailed description of the outer and inner algorithms can be found in appendix b as shown in fig 7 the 3d b spline curve path can be generated by a set of control points the set of control points corresponds to a unique 3d b spline curve path the coordinates and tangent directions of any point on the b spline curve path can be obtained according to the b spline curve equation and its derivative equation points 1 and 7 denote the starting point and destination of the mission respectively their positions need to be set before path planning the positions of the remaining five control points are optimized in the path planning process in the scheme of time optimal path planning the overall traveling time and energy consumption interval of each path can be obtained as first the continuous b spline curves path is discretized into a sequence of slight path segments k k 1 k 2 k i k i 1 k λ k λ 1 where λ denotes the number of path segments second for each path segment k i k i 1 i 1 2 λ the minimum traveling time t i and maximum traveling time t i can be calculated using the vector analysis method described in section 2 4 the minimum and maximum energy consumption e i e i can be evaluated according to formula 4 finally the minimum and maximum traveling times of the overall path are equal to i 1 λ t i and i 1 λ t i respectively similarly the minimum and maximum energy consumption of the overall path are respectively equal to i 1 λ e i and i 1 λ e i 3 2 complexity of io algorithm the asymptotic computational complexity of path planning algorithms is quantified in this section as shown in algorithm 1 of appendix b the main loop includes two loop bodies while loop and for loop the complexity of the while loop is o x max in the worst situation where x max denotes the maximum number of iterations the complexity of the for loop is o n where n denotes the population size the computational complexity of qpso is o n x max f c where f c represents the complexity inside the for loop the computational complexity of the io algorithm is largely decided by f c as shown in fig 6 the time optimal path planning algorithm includes three parts the main loop based on qpso path generation based on the b spline curve and cost evaluation traveling time or energy consumption of the path segment when generating a path the b spline curve is divided into n p path segments the complexity of each path segment is o 1 and hence generating a path has a complexity of o n p in the cost evaluation function the cost of each segment is computed with a vector analysis method for which the complexity is o 1 the complexity of the cost evaluation function is o n p therefore f c is equal to o n p and the computing complexity of the path planning algorithm is o n x max n p 4 simulation the simulation results obtained for the time optimal path planning in ocean environments with uncertain current fields are shown and analyzed in this section the objective is to estimate the performance of the io algorithm in the path planning problem em wang et al 2016 and the deterministic flow field dff scheme are implemented to assess the performance of the proposed io scheme then 1000 random flow fields with a gaussian distribution are generated to verify the performance of the path obtained by the three schemes the algorithms were implemented using matlab 2019b mathworks on an intel core i7 processor with a processing speed of 2 6 ghz 6 and 16 gb ram 4 1 simulation setup the ocean current data are obtained from the mrpds the data are updated every 24 h the initial and final destination points are located at 21 n 119 e and 26 n 124 e respectively the starting time was 0 00 on january 1 1992 the search space is set to a square area from 21 n to 26 n between 119 e and 124 e with 0 1 resolution which is 550 km 550 km the flow field and search region are shown in fig 8 the mean current velocity v mean and the maximum current velocity v max encountered in the domain are 0 3 m s and 1 5 m s respectively the cost function parameters are set as k h 0 005 and k d 1 4 2 simulations results this section compares the performance of the three schemes under a constant thrust speed in uncertain and time varying flow fields because the thrust speed is constant the energy consumption of the vehicles is only related to the traveling time according to 4 i e the time optimal path planning the thrust speed is set as 0 8 m s io em and dff are set as follows 1 io scheme each individual b spline path is formed by five control points then the b spline curved path is uniformly subdivided into 1000 path segments the number of points is conservatively selected such that it is sufficiently large to guarantee that the spline formed paths closely conform to the intended paths in the outer algorithm the population size of qpso is 100 and the maximum number of iterations is 200 in the io scheme the uncertainties of the ocean current magnitude and direction are set as σ m 0 3 and σ d 30 the reference interval v i is set as 100 1100 i e v l and v w are 100 and 500 respectively 2 em the em is an approximate approach to path planning in uncertain flows it involves generating a finite size ensemble of the current fields according to the gaussian distribution which is denoted as the initial current fields for each current field in the initial current fields a deterministic path planning algorithm is applied to generate the optimal paths then the result paths are evaluated by a large number of random current fields with gaussian distribution the best performance path is selected as the result path of em in the em scheme the ensemble size is set to 64 3 dff scheme the dff scheme is a special case of the io scheme under σ m 0 and σ d 0 therefore the dff scheme has a similar architecture as io however solving the interval response is replaced by simply computing the energy consumption the time optimal paths generated by the three schemes are shown in fig 9 a and b fig 9 a shows the 3d view and fig 9 b shows the top view to show the path change in depth clearly the depth axis is enlarged in fig 9 a the total depth is 1 2 km which is only 0 22 of the horizontal length the green and red circles represent the start point and destination respectively a comparison of the optimal paths shown in fig 9 a indicates that the io scheme takes a deeper navigation route than the other two schemes normally the current velocity decreases as depth increases as shown in fig 9 b the dff and em schemes select the downstream region to reduce the energy consumption especially in the latter half of the paths however the io scheme chooses the region with small currents the convergence curves showing the best fitness values for the io and dff schemes with the corresponding numbers of iterations are shown in fig 9 c the fitness functions of io and dff are equal to p v i e i γ v f and f γ v f respectively the fitness values of the io and dff schemes are not of comparative significance because their fitness functions are different fig 9 c shows that the first 20 iterations do not find a feasible path in the io scheme and the dff scheme has a higher rate of convergence than the io scheme this is because the uncertainty of ocean currents is considered in the io scheme which increases the probability that the path is unfeasible compared with the dff scheme the io scheme is more rigorous in path evaluation which increases the difficulty of path searching and reduces its convergence rate in terms of computation time the io and dff schemes are more efficient and effective than em because it needs to perform deterministic path planning 64 times the computation times of io and dff are 119 s and 97 s respectively and that of em is 3 53 103 s 4 3 robustness assessment a total of 1000 flow fields are randomly generated to evaluate the resultant path performance of each scheme in which the current direction obeys n μ d i r e c t σ d i r e c t and the current magnitude obeys n μ m a n g i σ m a n g i μ d i r e c t and μ m a n g i respectively equal the predicted direction and magnitude of currents σ d i r e c t and σ m a n g i are set as 15 and 0 15 m s respectively it should be noted that the 95 confidence intervals of the current direction and magnitude are equal to the interval widths of the current direction and magnitude set in the io scheme this implies that the io scheme can solve the 95 impact caused by uncertainty however the other 5 is not solved the information of each path running in 1000 flow fields is presented in table 1 a hypothetical propulsion speed is set for the path planning and the auv will travel on the resulting path at this speed however the auv may not be able to follow the resulting path because of the uncertainty of ocean currents the accessibility region of a vehicle is a sector where the current velocity is greater than the vehicle propulsion speed soulignac 2011 moreover as the current velocity increases the angle of sector decreases therefore if the actual current velocity is greater than the predicted current velocity and it causes a path segment to be out of the accessibility region the resulting path cannot be followed the larger the current velocity of the region passed by the resulting path the greater is the probability of failure however during a real mission the velocity of the auv will not be strictly limited to the hypothetical propulsion speed instead it can be adjusted within the propulsion capability to maintain the path according to actual ocean currents therefore if a path segment is not feasible the propulsion speed and energy consumption on this path segment are recalculated as shown in fig 10 the calculation method is discussed according to angle θ between the path segment k i k i 1 and current vector v f 1 if θ 90 the propulsion speed of the auv must be greater than or equal to v p min for the auv to travel along k i k i 1 as shown in fig 10 a here v p min is called the minimum accessible velocity which is equal to v f sin θ 2 if θ 90 the propulsion speed of the auv must be greater than v f as shown in fig 10 b v p min is equal to v f ε where ε is a small value in this section ε is set as 0 01 m s in summary if a path segment is not feasible the minimum accessible velocity will be calculated based on the above method if the minimum accessible velocity is less than or equal to the maximum propulsion speed provided by the auv the energy consumption of the path segment is calculated using the minimum accessible velocity if the minimum accessible speed is larger than the maximum propulsion speed the path is considered unfeasible and it thus returns a failure the maximum propulsion speed provided by the auv is set as 1 m s the statistical results listed in table 1 indicate that the io scheme generates the path with the lowest failure count this finding suggests that the io scheme has better robustness in uncertain flow fields compared with that for dff and em as shown in fig 9 b the io scheme selects a path with small currents to decrease the probability of failure and enhance the robustness of the resulting path furthermore compared with the other two schemes the io scheme selects a deeper navigation path as shown in fig 9 a this is because the current velocity decreases with the depth a deeper path is beneficial for reducing the probability of failure however large downstream currents help reduce the traveling time and minimize the energy consumption of the vehicles thus the mean traveling time of the io scheme is higher than that of the two other schemes because the io scheme needs to compromise between reliability and traveling time in uncertain current fields in addition the performance of em is better than that of the dff scheme but it is worse than that of the io scheme the performance of the em can be improved by increasing the size of the initial current fields however the computation time increases linearly 4 4 robustness assessment for different uncertainties to further evaluate the influence of ocean current uncertainty on auv path planning robustness assessments under different uncertainties are conducted in the io scheme the path needs to be planned according to the uncertainty the parameters σ m and σ d in the io scheme are set as 2 σ d i r e c t and 2 σ m a n g i such that σ m and σ d are 10 and 0 1 m s respectively when σ d i r e c t 5 and σ m a n g i 0 05 m s the simulation results are presented in table 2 as shown in table 2 the statistical results indicate that the mean energy consumption increases with an increase in uncertainty the mean energy consumption of the io scheme is higher than that of the other two schemes moreover with the increase in uncertainty the energy consumption of the io scheme increases faster than that of the dff scheme when σ d i r e c t 5 and σ m a n g i 0 05 m s the energy consumption difference between the io and dff is only 0 46 however the difference reaches 7 07 when σ d i r e c t 20 and σ m a n g i 0 2 m s this is because as the uncertainty increases the io scheme requires higher energy consumption to enhance the robustness of the path in the em scheme the mean energy consumption shows strong randomness which has little relation with uncertainty for example the mean energy consumption is up to 415 6 kj at σ d i r e c t 10 and σ m a n g i 0 05 m s which is even higher than the mean energy consumption when σ d i r e c t 20 and σ m a n g i 0 15 m s this is caused by the em scheme s search mechanism in fact the performance of the em scheme depends on the number of initial flow fields in terms of failure count all three schemes are zero when σ d i r e c t 5 however with the increase in σ d i r e c t the failure count of the dff scheme increases significantly in particular when σ d i r e c t 20 the failure count is as high as in the hundreds this means that the probability that the dff path can be successfully tracked is at most 80 when σ d i r e c t 20 such path planning is dangerous and has low practicability because of low reliability however it has low mean energy consumption the reliability of the em scheme is greatly improved compared with the dff scheme however as analyzed in the previous paragraph the stability of em remains poor the failure count of the io scheme is at most 2 which is considerably lower than those of the two other schemes in fact 95 4 of infeasible paths under a gaussian distribution have been excluded in the optimization process of the io scheme therefore the path generated by the io scheme has strong robustness and it guarantees the safety and stability for auv navigation in conclusion when σ d i r e c t is less than 10 the uncertainty has little impact on auv navigation each scheme has only a few failures in simulations however the energy consumption of the dff scheme is minimal therefore the performance of the dff scheme is optimal among the three schemes when the level of uncertainty is low however when σ d i r e c t is 15 the influence of uncertainty on auv navigation gradually appears in the dff scheme moreover the influence increases sharply when σ d i r e c t 20 in the io scheme the probability that the planned path cannot be tracked is minimal at most 0 2 and this considerably reduces the effect of uncertainty on auv navigation thus the performance of the io scheme is optimal in the three schemes when the level of uncertainty is high 5 conclusion this paper presented a time optimal path planning algorithm for auvs under ocean environments with uncertain and time varying flow fields in this scheme uncertain ocean currents were expressed as intervals the interval response was obtained by the proposed vector analysis method and it was then transformed into a deterministic number using an rpdi simulation tests were performed in uncertain and time varying flow fields and random flow fields with gaussian distribution errors were used to assess the robustness of the paths generated by the io em and dff schemes the simulation results indicate that em is time consuming and em performance is unstable further the path found by the io scheme is more reliable than those found by the em and dff schemes however the io scheme consumes more energy than the em and dff schemes credit authorship contribution statement xuliang yao conceptualization methodology supervision funding acquisition feng wang conceptualization methodology software formal analysis writing original draft writing review editing changshun yuan software validation writing review editing visualization jingfang wang methodology validation formal analysis investigation xiaowei wang software formal analysis writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the high technology vessel project of china no ky10400170181 appendix a in this appendix we provide the proof of assumptions 1 and 2 we define v f as the ocean current vector v p as the thrust velocity vector x i x i 1 as the pre navigating vector v g as the vehicle velocity with respect to the seabed in which the direction is consistent with the direction of x i x i 1 and θ as the angle between v f and x i x i 1 assumption 1 the magnitudes of v p and v f are assumed to be fixed and θ represents the angle between x i x i 1 and v f for θ 1 θ 2 if θ 1 θ 2 then v g 1 v g 2 proof 1 when 0 θ 1 θ 2 π 2 v p and v f are decomposed in the tangential and normal directions of v g as 24 v p t v f t v g v p s v f s 0 where the upper corner marks s and t represent the normal and tangential directions respectively as shown in fig 11 a v f 1 s v f 2 s v p 1 s v p 2 s v p and v f are fixed and v p 1 t v p 2 t and v f 1 t v f 2 t therefore v g 1 v g 2 2 when π 2 θ 1 θ 2 π as shown in fig 11 b the relation is obtained as follows in accordance with the cosine theorem reduction to absurdity is used and we assume that v g 1 v g 2 then the conclusion and condition are contradicting and hence assumption 1 is correct under π 2 θ 1 θ 2 π 3 when 0 θ 1 π 2 and π 2 θ 2 π the relation is obtained as v g 1 v g π 2 and v g π 2 v g 2 where v g π 2 denotes the vehicle velocity with θ π 2 thus v g 1 v g 2 fig 11 relationship of v f v p and v g with fixed v p and v f under different θ values fig 11 assumption 2 θ and the magnitude of v p are assumed to be fixed when 0 θ π 2 the relationship between v g and v f is a convex function and v g is the maximum if and only if v f v p when π 2 θ π the relationship between v g and v f is monotonically decreasing proof 1 when 0 θ π 2 as shown in fig 12 a the following expression is obtained based on the sine theorem 25 sin θ v p sin α v g where α represents the angle between v f and v p and θ and v p are fixed consequently the value of sin α v p is constant v g v p sin α sin θ when v f is perpendicular to v p that is α π 2 the value of v g is the maximum with a decrease or an increase in v f α monotonically decreases or increases from α π 2 and sin α monotonically decreases therefore when 0 θ π 2 the relationship between v g and v f is a convex function and v g is the maximum if and only if v f v p 2 when π 2 θ π as shown in fig 12 b then similar to case 1 v g v p sin α sin θ the inner angle sum of the triangle is equal to π and therefore α is less π 2 under the condition π 2 θ π with a decrease or an increase in v f α decreases or increases whereas sin α increases or decreases therefore when π 2 θ π the relationship between v g and v f monotonically decreases fig 12 relationship of v f v p and v g with fixed θ and v p under different v f values fig 12 appendix b outer algorithm the pseudocode for the outer algorithm is presented in algorithm 1 where pbest denotes the individual optimal position and gbest denotes the global optimal position algorithm 1 outer algorithm image 3 the outer algorithm depends on the iterative qpso algorithm for searching and optimizing the paths the detailed implementation of the outer algorithm for path planning can be described as follows step 1 initialization of the qpso algorithm as shown in algorithm 1 the parameters that need to be initialized are the population size n and the maximum number of iterations x max step 2 randomly generate an initial swarm of particles every particle in the swarm represents a potential path the position of the ith particle is defined as 23 p i p i 1 p i j p i k where p i j represents the coordinate of the jth control point the dimension k of a particle represents the number of control points set each particle s current best position p i 0 as p i 0 in addition the annular space decomposition asd approach zeng et al 2014 was applied to distribute the control points evenly and reasonably in the asd scheme the 2d search space is decomposed into layers radiating from the start point to the destination and the control points are evenly assigned to all layers control points can move freely within their respective layers step 3 for each iteration evaluate mbest which is defined as the mean of the best position of all particles step 4 for each particle generate the b spline curve using control points represented by the particle p i x c then the continuous spline curves are discretized into a set of path segments using uniform subdivision step 5 for each path evaluate the fitness value f p i x c using the vector analysis as described in section 2 4 and the interval number comparison as described in section 2 5 step 6 update the ith particle s individual best position p i x c and the swarm s global best position g using 17 and 18 respectively step 7 calculate and update each dimension of the particle using 19 22 in this step the particle is attracted by p i x c and g the contraction expansion coefficient is represented as τ which can be tuned to control the convergence speed of the algorithms ϕ i j denotes a random number distributed uniformly in 0 1 ψ i j denotes the potential well length which represents the search scope of the particles step 8 repeat steps 3 7 until the program meets the stop criterion inner algorithm the inner algorithm of time optimal path planning can be obtained by combining the vector analysis method and the reliability based possibility degree of interval rpdi described in sections 2 4 and 2 5 algorithm 2 inner algorithm image 4 
20613,to offer references for ventilation and load fluctuation of propeller in actual seaway this paper presents a rans reynolds averaged navier stokes equations investigation on open propeller dynamic loads in regular head waves at variant submergence depths from the perspective of the coupled oblique flow and free surface effect discussions are made concerning the dynamic integral loads and single blade loads both axial and in plane and instantaneous single blade loads at different azimuthal positions cfd computational fluid dynamics verification and validation are conducted based on an experiment in calm water and regular head waves conducted in a circulating water channel as conclusions under fully submerged condition single blade load variations are related solely to the unsteady oblique flow environment with shifts of azimuthal positions corresponding to the maximum and minimum thrust and torque due to inflow non uniformity under periodical emerging condition high frequency integral load fluctuations are identified by both simulation and experiment resulting from the enhanced propeller surface interactions due to upward wake inclination this enhanced propeller surface interaction also causes serious ventilation abrupt rises or drops of axial single blade loads and destruction and dissipation of propeller vortex system furthermore the self induction effect on the load distribution non uniformity is found to be unobvious in regular waves due to the unsteady and non uniform inflow environment keywords open propeller dynamic loads oblique flow enhanced propeller surface interaction regular head waves 1 introduction the abrupt loss and large amplitude fluctuation of propeller loads for ships in rough seas are responsible for problems such as speed loss propeller and bearing damages and even hull vibration under severe circumstances to offer more valuable references for understanding and solving such problems propeller dynamic loads in waves requires in depth investigations near surface propeller dynamic loads basically result from the propeller surface interactions especially at high loadings where ventilation is more inclined to occur in recent years a number of numerical researches have been conducted regarding ventilated marine propellers in calm water for example based on numerical and experimental methods kozlowska et al 2011 investigated propeller ventilation and thrust fluctuation at constant submergence depth in a wide range of advance ratios it was found that cfd over predicts the propeller loads under ventilating condition a phenomenon that was attributed by the authors to the inability of the rans methods to solve the miniature ventilating vortices califano et al 2011 simulated the dynamic loads of a fully submerged propeller at high loading in which case the propeller blade was found to be surface piercing during ventilation although good agreement was achieved between the simulated and measured dynamic loads on the upper most blade piercing the free surface relatively obvious discrepancies were found on the blades at other angular positions and the reason for the discrepancies were investigated thoroughly li et al 2015 performed cfd simulations to investigate the effect of free surface on propeller transient forces and vortical structures it was found that as the propeller submergence decreases higher harmonics appear on the simulated thrust and torque especially at higher loadings using two propeller models of different sizes as the research object paik 2017 numerically studies the hydrodynamic performance vortex structure and propeller induced wave pattern of near surface propeller it was found that the smaller propeller model experiences a greater decrease of thrust and torque than the larger due to the free surface effect the above listed studies all focused on calm water conditions concerning the dynamic loads of near surface propeller in waves most researches are based on experiments conducted in early times for example naito and nakamura 1979 conducted a model experiment to investigate the time averaged and dynamic loads of open propeller in calm water with varied submergence depths and in regular waves with varied wave heights it was concluded that the propeller load fluctuation behaviors in regular waves are influenced by both the orbital velocity variation and submergence variation cao 1988 conducted an experimental study primarily on the time averaged open propeller performances in calm water and regular waves the thrust fluctuation behaviors in waves were calculated based on a quasi steady method koushan 2009 experimentally studied the load fluctuations of an open propeller under the effect of regular waves and ventilation the maximum and minimum load are identified respectively at wave crest and wave trough indicating a dominating effect of water surface elevation on load fluctuation behaviors more recently very limited cfd researches have been published for example based on a propeller body force model tokgoz et al 2017 calculated the time varying thrust and torque of two propeller models in regular waves the authors made a similar observation to that by koushan 2009 i e the highest and lowest thrust and torque appear respectively at the wave crest and wave trough zhao et al 2017 did a comparison study on propeller dynamic loads at two advance ratios using both numerical and experimental methods the authors observed obvious thrust and torque fluctuations from the simulated and measured thrust and torque time series the physical mechanism of near surface propeller dynamic loads in regular waves is more complicated compared to that in calm water in axial uniform inflow generally the dominant factor for the complicatedness is the oblique flow effect as an inherent feature of the propagating regular waves and the coupled free surface effect at low submergences for a propeller fully submerged within the whole period of encounter neglecting the free surface effect due to the wave orbital velocity it experiences non uniform inflow with periodically varying magnitude and incidence angle therefore on one hand the single blade loads vary with azimuthal positions due to the oblique flow effect but supposedly there are differences from the uniform and steady oblique flow environment due to inflow unsteadiness and non uniformity on the other hand the instantaneous load distribution on the propeller disk is unsteady due to the unsteady oblique flow environment itself more importantly for a propeller periodically emerging in regular waves one must also consider the free surface effect which is closely coupled with the oblique flow effect with time varying inflow incidence angle comes a time varying propeller wake inclination direction hence the propeller surface interactions are enhanced with an upward wake inclination which can destruct and dissipate the propeller vortex system and cause high frequency load fluctuation and abrupt thrust loss obviously for an in depth understanding of the dynamic behaviors of the integral and single blade loads of propeller in waves one must put emphasis on the coupled oblique flow and free surface effect as well as the consequent flow field details this is what previous researches regarding propeller dynamic loads in waves have neglected to do regarding propeller in oblique flow numerous numerical and experimental researches can offer us abundant inspiration for example dubbioso et al 2013 studied pressure distribution and wake field characteristics of a propeller model in oblique flow and discussed the effect of induced velocity over the propeller disk due to slipstream inclination i e the self induction effect which amplifies the non uniformity of pressure distribution on each blade as an extension of the experimental study byfelli et al 2018 regarding the wake behaviors of propeller in axial inflow to the oblique flow conditions di mascio et al 2014 conducted des detached eddy simulation simulations to investigate the wake dynamics of the e779a insean propeller model in oblique flow at two different propeller loadings and one constant incidence angle it was found that the propeller wake tilt in oblique flow which forms a misalignment with respect to the incoming flow causes the root and hub vortices to interact with and bring instabilities to the tip vortices alimirzazadeh et al 2016 investigated the time varying loadings on a single blade of a surface piercing propeller spp at different angles of incidence and different submergence depths it was found that the maximum efficiency of spp is not achieved at zero angle of incidence which is worth considering in the design of spps based on both experimental and numerical methods berchiche et al 2018 studied the dynamic integral loads and single blade loads of a ducted thruster in oblique flow with numerical simulations performed at small submergences in axial inflow to evaluate the free surface effect on the thruster performance felli et al 2018 conducted detailed measurements of wake characteristics of a propeller in oblique flow at variant incidence angles based on particle image velocimetry piv technology the authors observed remarkable differences in propeller vortical behaviors between oblique flow condition and axisymmetric condition which are allegedly caused by the wake stream tube misalignment with the main flow and the presence of a main flow component on the propeller plane zhang chen and jiang 2020 b used urans unsteady reynolds averaged navier stokes equations method to investigate the oblique flow effect on the propeller lateral loads in open water and behind hull conditions it was concluded that the oblique flow has larger effects on the blade loads in the bottom half of the propeller disk compared with the top half aside from the coupled oblique flow and free surface effect for a periodically emerging propeller in waves one must also consider the hysteresis effect califano 2010 on the integral and single blade loads the hysteresis here refers to the fact that for a previously emerging propeller the recovery of the full thrust after this propeller is fully submerged is a gradual process it was inferred by koushan 2004 that for a typical propeller of typical geometry that is previously out of water it takes approximately 4 revolutions in full submergence to regain full thrust also according to an experimental research by zhang et al 2020 a b it takes approximately 5 propeller revolutions in full submergence for a previously emerging propeller to regain full thrust the hysteresis effect is generally considered related to the wagner effect wagner 1925 i e for an airfoil that accelerates instantaneously from rest to a certain constant speed there will be a delay in the build up of steady state lift to sum up in this paper we offer a rans investigation upon the dynamic loads of an open propeller in regular head waves at variant submergence depths from the perspective of the coupled oblique flow and free surface effect separate discussions are made regarding the integral load variation in the entire period of encounter the single blade load variation in different time intervals and the instantaneous single blade loads at different azimuthal positions and instants instantaneous wake analysis is also conducted cfd verification and validation v v are first conducted on a surface piercing test case in calm water according to the ittc international towing tank conference recommended procedure ittc 2017 with further validation on a periodically emerging test case in regular head waves the experimental results for validation purposes were obtained through an open propeller model experiment conducted in a circulating water channel 2 numerical methods 2 1 propeller geometry dimensionless coefficients and working conditions the propeller model used is a four bladed right handed mau series propeller table 1 shows its main particulars a cartesian reference system is shown in fig 1 the system origin is at the propeller disk center the x axis points to the bow the z and y axis to the vertical and port direction respectively as for the azimuthal position of propeller blades 0 and 180 refer respectively to the positive upward and negative downward z direction 90 and 270 to the starboard and port thrust torque coefficients in the i axis direction i x y and z are defined as 1 k t i t i ρ n 2 d 4 k q i q ρ n 2 d 5 where t i and q i are the propeller forces and moments in the i axis direction the advance ratio j is defined as eq 2 where v a is the inflow velocity prescribed at the inlet boundary of the computation domain 2 j v a n d the submergence depth and wave height are expressed non dimensionally as l d and h d where l is the vertical distance between the propeller disk center and static water surface h being the wave height in regular head waves the instantaneous advance ratio j ins and submergence depth l d ins at the propeller disk center are defined as 3 j i n s v a a ω w sin k x ω w t exp k z nd l d i n s l a cos k x ω w t d where a is wave amplitude ω w is wave frequency k is wave number and z is the vertical distance between the propeller shaft and static water surface the simulation cases are summarized as table 2 where t w represents wave period in validation part one calm water test case of l d 0 167 j 0 3 was selected for a systematic cfd uncertainty analysis and one regular wave test case of l d 0 5 h d 0 8 t w 1 0408s j 0 was chosen for further validation in results and discussions part three simulation cases of variant submergence depths are performed at first i e l d 0 5 0 75 1 0 h d 0 6 t w 1 0408s j 0 4 in these three cases l d 1 0 represents fully submerged condition where the propeller is fully submerged in the entire period of encounter l d 0 5 and 0 75 both represent periodically emerging condition i e the propeller tip periodically emerges from the free surface near the wave trough following these three cases is one case of l d 1 0 h d 1 0 t w 1 0408s j 0 05 which is offered for the completeness of this work 2 2 numerical models and solver options for incompressible flow the continuity equation and rans equation are written in tensor form as 4 x i u i 0 5 ρ u i t x j ρ u i u j p x i τ i j x j ρ f i where ρ is water density p is static pressure τ ij is shear stress ρf i is the gravity component on the i th direction by introducing the concept of the turbulent eddy viscosity coefficient μ t the reynolds stress ρ u i u j in eq 5 is calculated based on the boussinesq approximation written as eq 6 6 ρ u i u j 2 μ t u i x j u j x i 2 3 ρ k μ t u i x i δ i j where k is the turbulent kinetic energy δ ij is the kronecker delta with the boussinesq approximation used the calculation of the reynolds stress now depends on the calculation of μ t the shear stress transport sst k ω model is considered to have good performance in resolving viscous flow within the boundary layer and in predicting flow separation and reattachment as a common phenomenon on the propeller suction side therefore we select the sst k ω model for turbulence modeling the definition of μ t in the sst k ω model is written as 7 μ t ρ k min α ω t a 1 s f 2 where α is a model coefficient s is the mean strain tensor and f 2 is a blending function the definitions and expressions of these variables and functions can be found in the star ccm documentation ver 12 06 cd adapco 2017 the transport equations for the turbulent kinetic energy k and the turbulent dissipation rate ω t are written as follows 8 ρ k t x i ρ k u i x j γ k k x j g k y k 9 ρ ω t t x i ρ ω t u i x j γ ω t ω t x j g ω t y ω t d ω t where g y and γ are the generation dissipation and effective diffusivity of k and ω t d ωt is the cross diffusion term the 2nd order time and space discretization is used to solve the governing equations time step is 1 15e 04s roughly 0 5 degrees of rotation each of which contains 15 inner iterations the pressure velocity coupling was implemented based on the simple semi implicit method for pressure lined equation algorithm the under relaxation factors for velocity and pressure are set as default values rather than reduced because the simulation has been well stabilized in the trial runs by other measures e g elongating the computation domain the vof volume of fluid multiphase model was applied to simulate the free surface deformation and wave pattern the basic information about the vof model has been thoroughly introduced by alimirzazadeh et al 2016 overset mesh method was applied to simulate propeller rotation all simulations were performed using the commercial code star ccm ver 14 02 using a node with 36 processors 2 3 computation domain computation domain the computation domain is a rectangular parallelepiped which is 18m in length 6m in width and 4m in height as shown in fig 2 the distance is 5m between the propeller model center and inlet boundary and 13m from the propeller center to the outlet boundary to eliminate the reverse flows at the outlet wave propagating and inflow direction is negative x axis direction with overset grid method used for simulating propeller rotation the domain is split into a global fixed part static region and a cylindrical rotating part rotating region that encloses the entire propeller model boundary conditions the propeller blade and hub surfaces are set as no slip wall condition on the cylinder surface of the rotating region an overset mesh interface was created to couple the rotating region mesh with background mesh for the computation domain the boundary conditions of velocity inlet and pressure outlet are respectively set on the inlet and outlet boundaries while the other four boundaries are set as slip wall condition wave generation and absorption in regular wave simulations the first order waves are generated and absorbed with the wave forcing method kim et al 2012 applied at both the inlet and outlet boundaries this method forces the solution of the discretized n s equations towards the theoretical solution of the wave model by adding a source term written as eq 10 10 q ϕ α ρ ϕ r a n s ϕ w a v e where φ rans is the current solution of the rans equations and φ wave is the theoretical solution of the wave model α 1 is specified as a function of the distance d to the boundary 11 α 1 α 0 cos 2 π 2 d d 1 where α 0 is a parameter of the wave forcing model d ranges from 0 to d 1 d 1 2 5m is the wave forcing length for our simulations approximately 1 5 times the wave length a monitoring point for water surface elevation is located at 0 0 8 0 i e 0 8m away from the propeller disk center on the port side where the generated regular waves are not disturbed by propeller generated waves in calm water simulations for v v purposes wave damping method choi et al 2009 is applied at the outlet boundary to absorb propeller generated waves by adding z axis direction damping source terms written as eq 12 to the water particle vertical velocity equation 12 s z d ρ f 1 f 2 w e κ 1 e 1 w the variable κ is written as 13 κ x x s d x e d x s d n d where x sd and x ed respectively are the starting point 2 5m away from the outlet boundary and end point outlet boundary of the wave damping zone f 1 f 2 and n d are parameters of the wave damping model w being vertical velocity component 2 4 meshing an unstructured hexahedral mesh was generated in the computational domain local mesh refinement is performed in the rotating region propeller wake area and free surface area leading to a total grid cell number of approximately 13 million as shown in figs 3 and 4 a special mesh refinement was performed on the leading trailing edges as well as the blade roots to ensure the fidelity of geometry details 15 orthogonal prismatic cell layers are generated on the propeller surface and the absolute thickness of the near wall prism layer was selected so that the dimensionless wall distance y 3 anywhere on the propeller blade for fully submerged conditions fig 5 shows the instantaneous y contour for the case of l d 1 0 in regular waves after the simulation has reached a steady state as one can observe y is rather small on the majority of the blade surface on both pressure left and suction sides right but relatively large in the vicinity of the leading edges figs 6 8 respectively shows the mesh generation on the x 0 y 0 plane sections and on the calm water surface in fig 6 a and b represent the cuboid mesh refinement area for the free surface near the propeller which stretches 0 3m upstream and 0 55m downstream of the propeller disk center in this area the generated mesh consists of all trimmed hexahedra grids with anisotropic size x 1 300 wave length y 1 150 wave length and z 1 40 wave height c and d respectively refers to the mesh refinement area for the overlapping area and the rotating region the mesh is distributed evenly and isotropically in these two areas with grid cell size being 1 100d in the rotating region and 1 50d in the overlapping area the boxed area labeled e in fig 7 is the inflow velocity mesh refinement area located upstream of the propeller in order to better capture the propeller wake evolution mesh refinement is performed in the area labeled f where the isotropic grid size is 1 50 the propeller model diameter the same as that in the overlapping area labeled c in fig 6 a typical free surface mesh refinement is done for the whole computational domain represented by g in fig 8 with anisotropic grid size being x 1 150 wave length resulting in a courant number of around 0 012 that can well satisfy the cfl courant friedrichs lewy converge condition cfl 0 5 for the free surface simulation under 2nd order time discretization y 1 37 5 wave length and z 1 20 wave height in addition we give an extra refinement for the propeller aroused kelvin wave area the trapezoid area h for which the anisotropic grid size x 1 300 wave length the a b g and h mesh refinement areas can be relocated along the z axis according to the desired submergence depth 3 inflow analysis of propeller in regular head waves in this section to lay a foundation for the following discussions regarding the dynamic integral and single blade loads we offer an inflow analysis for this propeller in regular head waves respectively on the y 0 section plane fig 9 and propeller blade pressure side fig 10 and on the generic blade sections fig 11 at different azimuthal positions of 0 90 180 and 270 in fig 10 left inflow analysis for when the four blades are at random azimuthal positions is also offered considering t 0t e as the starting instant where the propeller is located at the first wave crest t e represents the period of encounter two instants are selected to respectively represent the process of the propeller approaching the wave crest from wave trough t 0 75t e labeled as a in the following figures and approaching the wave trough from wave crest t 1 25t e b fig 12 shows the instantaneous velocity vectors at both instants in regular head waves on the y 0 section plane of the computation domain for l d 0 75 and t w 1 0408s the advance ratio j 0 4 corresponding to a flow velocity of v a 0 624 m s prescribed at the inlet boundary in order to better illustrate the actual instantaneous inflow velocity field where the propeller is operating the spatially averaged inflow velocities and the incidence angles to the four blades at 0 90 180 and 270 are respectively expressed as u 1 β 1 u 2 β 2 u 3 β 3 and u 4 β 4 in figs 10 and 11 ωr represents propeller rotational velocity where ω and r respectively represent propeller rotation angular velocity and the radial position of blade section the instantaneous angle of attack α of each blade section can be defined as 14 α θ arctan u axial u circumferential where u axial and u circumferential are the instantaneous axial and circumferential components of blade section inflow velocity θ the geometric pitch angle the calculated α of each blade section at 0 90 180 and 270 is shown in fig 11 according to figs 9 11 the inflow analysis results can be described as follows at both instants the instantaneous thrust produced by the propeller blade at 0 is of the same magnitude as that at 180 due to the same α theoretically the wave orbital velocity points vertically at both instants therefore the u axial into the two blade sections have the same magnitude i e u 1cosβ 1 u 3cosβ 3 furthermore at t 0 75t e the maximum and minimum instantaneous α hence the maximum and minimum instantaneous thrust respectively corresponds to the starboard 90 and port 270 at t 1 25t e contrarily the maximum and minimum instantaneous thrust respectively corresponds to the port 270 and starboard 90 in fig 9 the self induction effect on the inflow velocity asymmetry is qualitatively described on the y 0 plane at t 0 75t e fig 9 a the induced velocities by the tip vortices on the leeward side windward side generate a down wash up wash velocity that increases decreases the axial inflow velocity on the upper portion lower portion of propeller disk at t 1 25t e fig 9 b contrarily an up wash and a down wash velocity are generated to decrease increase the axial inflow velocity on the upper lower portion of the propeller disk the self induction effect would undoubtedly affect the instantaneous load distribution on the propeller disk but it is not considered in the calculation of α of each blade according to section 5 2 the self induction effect on the axial single blade load distribution is found to be unobvious which is supposedly due to the unsteady and non uniform inflow environment in regular waves furthermore it must be stated that the free surface effect as well as the inflow non uniformity and unsteadiness illustrated by the instantaneous inflow velocity vectors in fig 12 is neglected therefore the above inflow analysis does not necessarily reflect the actual circumstances of such complicated condition as near surface propeller in regular waves but rather serves as a reference 4 verification and validation of numerical methods in this section cfd verification and validation v v are conducted based on the ittc recommended procedure ittc 2017 on the time averaged thrust and torque k tx and 10k qx of this propeller model in calm water under surface piercing condition further comparison is offered between the measured and simulated k tx and 10k qx time series in regular head waves for validation purposes a propeller open water experiment was conducted in the circulating water channel cwc laboratory of shanghai jiao tong university in calm water and regular head waves using the propeller model introduced in table 1 that was made of aluminum alloy fig 13 shows the experiment arrangement the cwc test section is 8m in length 3m in width and the water depth is kept constant as 1 6m a flap type wave maker and a flow transparent wave absorber are respectively located at the left and right end of cwc test section the open boat device on which the propeller model is mounted stretches across the side track and contains a dynamometer and an electric motor that are linked to each other with gears a wave gauge is used to measure the wave surface elevation throughout the regular wave test conditions which is carefully placed so as not to affect the flow field in proximity to the propeller model a hand operated height regulator on the open boat device as well as a fixated ruler is used to achieve the desired submergence depth the flow velocity set values are adjusted on the control panel so that the target advance ratio j is achieved the sampling frequency is 100hz for calm water test case and 500hz for regular wave test case to capture the transient features more accurately measuring time is 30s for each case a high resolution camera is located on the ground aside the propeller model to capture the instantaneous free surface profiles the case of l d 0 167 and j 0 3 in calm water was selected for v v fig 14 shows the frequency spectrum of measured 10k qx of this test case which is obtained using fast fourier transform fft the shaft frequency n 12hz can be observed as the dominant frequency along with a rather high amplitude of the blade frequency n 48hz due to the propeller blades alternately impacting the water surface and ventilation electric noises at 20hz and 40 hz are also quite obvious that must be eliminated therefore the measured data in figs 15 and 16 were filtered with a low pass filter cut off frequency 50hz and with notch filters 19hz 21hz 39hz 41hz to get rid of the electric noises the present cfd verification was done based on three sets of grids of different resolution with a proper refinement ratio considering that the recommended grid spacing refinement ratio of r g 21 2 ittc 2017 would result in a prohibitively large cell number for the finest mesh 35m if the medium mesh were generated according to section 2 4 three sets of grids namely coarse grid 3 medium grid 2 and fine grid 1 are generated with r g 21 3 among which the medium grid is generated using the meshing strategies in section 2 4 cell number and calculated time averaged k tx and 10k qx of the three grids obtained from the time window in which the thrust and torque has reached a steady state are listed in table 3 fig 15 presents the k tx and 10k qx time histories obtained with the three grids along with experiment results the simulation physical time is 1 5s for each case which ensures a long enough steady state of propeller performance 0 7s 1 5s from which the time averaged k tx and 10k qx of three grids were obtained an intercepted 15s long measured time series is used as comparison as one may observe after 0 7s the time histories obtained with the coarse grid yellow appear relatively lower while the results of medium blue and fine red grids are higher and fairly close with each other for a clearer view of the steady state of propeller performance fig 16 shows a certain steady state portion of the simulated k tx and 10k qx time histories physical time 1s 1 25s corresponding to 3 propeller revolutions along with measured ones physical time 10s 12 5s corresponding to 30 propeller revolutions table 4 shows the results of verification and validation d represents experimental results e being the comparison error between d and numerical results based on the medium grid the efd experimental fluid dynamics uncertainty u d is determined following the ittc recommended procedure of uncertainty analysis for open water tests ittc 2014 with extra consideration of the bias in the measurement of submergence depth l b l 0 0015m the grid uncertainty u g is calculated using the factor of safety approach written as eq 9 where f s 1 25 15 u g f s δ r e g according to table 4 first with the increasing grid cell number monotonic convergence is achieved for both k t and 10k q showing an obviously weakened dependency of numerical results on the grid cell number once the medium standard is reached second validation is achieved at the u v level for both k tx and 10k qx based on the medium grid it s now safe to say that the medium grid along with the entire numerical methods has satisfactory accuracy for the simulation of propeller performance under surface piercing condition although the v v in calm water has been conducted further validation is still required for propeller dynamic loads in regular head waves which is a more complicated problem and is the research focus of the present work therefore using the medium grid we offer a cfd efd comparison of k tx and 10k qx time series in regular head waves within two wave periods the test case of l d 0 5 h d 0 8 j 0 and t 1 0408s is selected fig 17 shows the frequency spectrum of measured 10k q of this test case obtained using fast fourier transform fft the wave related harmonics are rather obvious with the dominant frequency being the wave frequency f w 0 96hz the shaft blade frequency and higher propeller related harmonics are also observable electric noises are obvious at both 42hz and 100hz and observable in the frequency range between 5n 60hz and 175hz hence a band block filter with cutoff frequency of 55hz lower and 175hz upper is used as well as a notch filter between 41hz and 43hz fig 18 presents the comparison of simulated and measured k tx and 10k qx time series of this test case along with simulated water surface elevation it is obvious that the simulated and measured results agree well with each other regarding both the maximum minimum values and overall variation trends showing the accuracy of the present numerical methods in simulating near surface propeller dynamic loads in waves more importantly in the time span of t t 0 1 0 3 and 1 1 1 3 in which the propeller approaches the wave crest until entering full submergence high frequency components are identified on both the simulated and measured k tx and 10k qx time series however in the time span t t 0 7 1 and 1 7 2 in which the propeller enters partial emergence and approaches the wave trough high frequency components are much less obvious with basically only shaft frequency and blade frequency fluctuations of k tx and 10k qx observed considering in the time span of t t 0 1 0 3 and 1 1 1 3 the inflow velocity to the propeller disk is upward inclined we attribute this high frequency thrust and torque fluctuation to the upward inclination of propeller wake that enhances the propeller surface interaction and causes thorough destruction of propeller vortex system 5 results and discussions 5 1 axial and in plane integral loads within one period of encounter for an investigation of the axial forces and moments i e thrust and torque fig 19 shows the simulated time history of k tx and 10k qx within one period of encounter a b from the first to the second wave crest j ins calculated according to eq 3 on the left side c and l d ins calculated according to eq 3 on the right d using the simulated water surface elevation first at l d 1 0 fully submerged condition k tx and 10k qx present an almost sinusoidal variation in the entire period of encounter the j ins periodical variation is the sole determinant of the integral load variation characteristics while the effect of l d ins periodical variation is unobvious with very limited propeller surface interaction even at wave trough fig 20 let s come back to fig 19 at l d 0 5 and 0 75 periodically emerging condition after the propeller leaves the first wave crest t 0 k tx and 10k qx both experience a smooth increase at first and then blade frequency fluctuations starting from a certain instant for l d 0 5 t 0 2t e for l d 0 75 t 0 3t e this instant is featured by a sudden impact occurring between the upper most blade tip and the wave surface causing an abrupt drop of the instantaneous integral loads indicating that the propeller becomes surface piercing again from this instant to the wave trough t 0 5t e blade frequency fluctuations of k tx and 10k qx appear resulting from the alternate impacting between each blade and the water surface subsequently in the time interval where the propeller leaves the wave trough and approaches the second wave crest for l d 0 5 t 0 5t e 0 9t e for l d 0 75 t 0 5t e 0 72t e the values of k t and 10k q are generally lower than in the interval where the propeller approaches the wave trough for l d 0 5 t 0 2t e 0 5t e for l d 0 75 t 0 3t e 0 5t e one reason is the hysteresis effect due to propeller blade emergence near the wave trough so that the propeller thrust is not fully recovered in the former time interval the other reason is the thrust loss from the enhanced propeller surface interactions with an upward wake inclination this enhanced propeller surface interaction also causes high frequency k tx and 10k qx fluctuations for l d 0 5 in the interval t 0 5t e 0 9t e while only blade frequency fluctuations are observed in t 0 2t e 0 5t e the high frequency components have been identified by both experimental and numerical results in the regular wave test case at j 0 as discussed in section 4 aside from the axial integral loads a short discussion is offered herein regarding the in plane integral load variations fig 21 shows the simulated time history of k ty a 10k qy b k tz c and 10k qz d within one period of encounter first at l d 1 0 fully submerged condition with an almost absent free surface effect throughout the entire period of encounter one can observe an approximately sinusoidal variation trend of both the lateral and vertical forces and moments black dotted curves in line with the periodical variation of wave orbital velocity which is similar to that experienced by k tx and 10k qx see fig 19 a b in addition the maximum absolute values of both the lateral load components k ty 10k qy and the vertical ones k tz 10k qz are identified at approximately t 0 75t e this is because in regular head waves the instant of t 0 75t e features the maximum incidence angle of inflow with respect to the propeller disk at which the instantaneous wave orbital velocity points vertically upwards also in the entire period of encounter despite the fact that the y axis component of the inflow velocity is zero the average lateral forces and moments is observed to be slightly below zero see fig 21 a b this results possibly from the non homogeneity of the self induction velocity over the propeller disk dubbioso et al 2013 at l d 0 5 and 0 75 periodically emerging condition the lateral and vertical forces and moments show high amplitude fluctuations at the blade frequency and even higher frequencies in basically the same patterns and actually due to the same reasons as thrust and torque see fig 19 a b take l d 0 5 as an example in the interval of t 0 2t e 0 5t e blade frequency fluctuations are observed for both the lateral and vertical load components due to the periodical impact between the blade tip and the free surface in the interval of t 0 5t e 0 9t e the high frequency fluctuations are due to the enhanced propeller surface interactions with an upward inclined propeller wake this reminds us that in actual seaway aside from the drastic fluctuations of thrust and torque the lateral and vertical forces and moments may behave the same way these load fluctuations may contribute to strength problems of the bearing system and affect the ship s maneuverability negatively as a supplement for the above discussions we would like to point out that the submergence depth of l d 1 0 in regular waves does not necessarily guarantee a negligible free surface effect on this propeller s dynamic load behaviors in fact even at large submergence depths but under certain circumstances propeller forces and moments may just as well suffer from severe fluctuations at blade frequency or even higher frequencies as they do at low submergences as an example an enlarged wave height h d and a decreased j would both contribute to more intense propeller surface interactions a larger h d means a smaller l d ins as the propeller approaches the wave trough so that ventilation and even tip emergence is easier to occur and a smaller j would lead to even lower pressure on the suction side hence more intense ventilation taking the thrust and torque as an example we herein offer a short discussion with the case of l d 1 0 h d 1 0 j 0 05 and t w 1 0408s fig 22 presents the k tx and 10k qx time histories left as well as calculated j ins and simulated l d ins time histories right for this case one may observe from fig 22 that in the interval of t 0t e 0 47t e the k t and 10k q shows a roughly sinusoidal variation trend which is similar to the case of l d 1 0 h d 0 6 j 0 4 see fig 19 a and b black dotted curves but as the propeller approaches the wave trough one can observe slight blade frequency fluctuations in the interval t 0 25t e 0 47t e due to the increasingly intense propeller surface interactions which cannot be observed in the case of l d 1 0 h d 0 6 j 0 4 in the same interval more importantly at the instant of t 0 47t e the propeller is near the wave trough k tx and 10k qx experiences an abrupt drop and then fluctuations at blade frequency and even higher frequencies until t 0 71t e the abrupt drop of k tx and 10k qx most likely results from an impact between the propeller tip and the free surface l d ins 0 5 and the enhanced propeller surface interactions due to upward wake inclination are deemed responsible for the fluctuations after t 0 71t e high frequency components have disappeared in the load fluctuations leaving only blade frequency components of very limited amplitude this manifests a decreasing intensity of propeller surface interactions after this point the reason for this is as the propeller approaches the wave crest not only l d ins is gradually increasing but also the inclination angle of propeller wake is decreasing due to a decreasing angle of incidence of the inflow velocity as illustrated in fig 12 hence the propeller wake is further away from and hence free of direct interactions with the free surface let s come back to the enhanced propeller surface interaction that causes high frequency fluctuations in the propeller axial and in plane loads which was at first identified from the instantaneous free surface profiles in the regular wave experiment cases see fig 23 belonging to the test case of l d 0 5 h d 0 6 0 8 j 0 2 and t w 1 0408s one can observe rather obvious difference in ventilation patterns due to different directions of wake inclination despite the similar l d ins and j ins specifically when the propeller is approaching the wave crest from wave trough left despite the fact that the propeller is fully submerged serious ventilation occurs due to direct interactions between the free surface and the upward inclined wake featuring concentrated air bubbles downstream in the near wake representing an air entrainment through the tip vortices in contrast no ventilation can be observed when the propeller is approaching the wave trough right in which case the propeller slipstream is downward inclined and hence avoids direct interactions with the free surface the enhanced propeller surface interactions can be better visualized with cfd figs 24 26 in these figures considering t 0t e as the starting instant where the propeller is located at the first wave crest two instants are chosen to respectively represent the process of the propeller approaching the wave crest from wave trough t 0 753t e and the propeller approaching the wave trough from wave crest t 1 223t e fig 24 shows the instantaneous free surface profiles on the y 0 plane for l d 0 5 and 0 75 at t 0 753t e left and t 1 223t e right obviously for a certain l d free surface deformation and ventilation are obviously more intense at t 0 753t e than at t 1 223t e the reason for this as was also discussed above with fig 23 is that at t 0 753t e there exists a direct interaction between the free surface and the upward inclined propeller wake while at t 1 223t e the downward inclined propeller wake avoids direct interaction with the free surface as illustrated in fig 12 also one can observe drastic free surface deformation for l d 0 5 at t 0 753t e upper left in the near wake indicating the destruction and dissipation of propeller vortex system which will be further investigated in the subsequent sections this vortex system destruction and dissipation is considered responsible for the high frequency fluctuations of not only the axial and in plane integral loads discussed above but also the single blade loads which will be discussed in section 5 2 fig 25 shows the vortical structure colored with velocity magnitude at t 0 753t e left and t 1 223t e right respectively for l d 0 5 0 75 and 1 0 for l d 0 5 0 75 at t 0 753t e obvious free surface deformation and vortex structure destruction is observed due to the direct interactions between the propeller vortex system and the free surface for l d 0 75 at t 0 753t e tip vortices are the first to engage in direct interactions with the free surface in the near wake which start at around 0 5d downstream from this point downstream the free surface effect as a strong external disturbance significantly facilitates the breakdown of the entire vortex system and accelerates the merging process of the tip hub and trailing vortices into a distorted vortex tube the breakdown and merging of vortices have been observed in numerous studies of propeller vortical structure at high loadings such as baek et al 2015 and felli et al 2008 but mostly due to the internal instabilities e g interactions among neighboring tip vortices back to fig 25 for l d 0 5 at t 0 753t e the entire vortex system engages in direct interaction with the free surface which makes the free surface deformation and vortex destruction all the more drastic the seriously destructed and distorted vortex system explains the high frequency thrust fluctuation in the interval of t 0 5t e 0 9t e in contrast at t 1 223t e with a downward wake inclination the propeller surface interactions are obviously weakened for l d 0 5 at t 1 223t e no vortex structure destruction or obvious ventilation can be observed the tip trailing and hub vortices remain stable and distinguished until around 2d downstream and later merge into a large vortex tube also a large free surface vortex with low velocity is formed around 1d downstream which is due to the induced velocities generated by the tip vortices in the upper portion of the wake for l d 0 75 at t 1 223t e the vortex system remains rather stable in the entire wake the low velocity area is still observed at the free surface but no free surface vortex is formed for l d 1 0 with an absent direct interaction with the free surface the propeller vortex system remains stable in the near wake even at t 0 753t e the free surface receives very limited effects by the rotating propeller with only a small free surface vortex formed near the blade tip and a low velocity area at the free surface due to tip vortex induced velocities at t 1 223t e no discernible free surface deformation exists indicating that the free surface effect is negligible the enhanced propeller surface interactions can also be described with the transverse vorticity component ω y in the y 0 plane as shown in fig 26 for l d 0 75 corresponding to the bottom row of fig 24 and the middle row of fig 25 at t 0 753t e with enhanced propeller surface interactions the tip vortices on the leeward side are destructed in the near wake around 0 5d downstream and dissipated into the free surface in the far wake along with the trailing vortices although the first tip vortex core in the nearest wake is not part of said destruction and dissipation its strength is obviously smaller than the corresponding one at t 1 223t e at t 1 223t e the entire vortex system is rather stable without direct interaction with the free surface the tip trailing and hub vortices on both windward and leeward sides are rather distinguished in general through both simulation and experiment we have identified the enhanced propeller surface interactions and consequent high frequency fluctuation of the integral loads due to an upward wake inclination as the periodically emerging propeller approaches the wave crest from wave trough cfd results further indicated that this enhanced propeller surface interaction causes destruction and dissipation of propeller vortex system which explains the high frequency fluctuations its effect on the dynamic and instantaneous single blade loads will be discussed in following sections 5 2 single blade load variation in different time intervals as a discussion of the axial single blade load variations fig 27 a c present the variation of k tx and 10k qx on a single blade with time and azimuthal positions respectively for l d 0 5 top 0 75 middle and 1 0 bottom in two time intervals selected near t 0 753t e t 0 641t e 0 861t e left and t 1 223t e t 1 109t e 1 329t e right lasting for two revolutions some observations can be first made regarding the variation of k tx and 10k qx on a single blade at l d 0 5 fig 27 a first in the interval t 0 641t e 0 861t e left the blade azimuthal positions corresponding to the minimum k tx and 10k qx are around 0 t 0 641t e 360 t 0 751t e and 720 t 0 861t e i e closest to the free surface which is inconsistent with the inflow analysis results in chapter 4 this is because the upper blade 0 is inevitably subjected to serious ventilation and out of water effect fig 24 upper left at such a low submergence with an enhanced propeller surface interaction second in the interval t 0 641t e 0 861t e aside from the high frequency thrust and torque fluctuations abrupt rises of k tx and 10k qx appear in the azimuthal position range of 230 290 t 0 71t e 0 73t e and 670 690 t 0 845t e 0 85t e which is probably associated with the transient forces from a blade water impact i e during the water exit phase described by califano 2010 a similar observation was made by olofsson 1996 in his experimental investigation on the transient loads of a near surface single propeller blade i e an abrupt increase of thrust and torque appears as the blade impacts the water in addition for the first abrupt rise of k tx and 10k qx its corresponding azimuthal position range 230 290 and amplitude are obviously larger than the second one representing a more drastic blade water impact this is due to an increasing submergence as the wave propagates third in the interval t 0 641t e 0 861t e in certain ranges of time and azimuthal positions k tx and 10k qx present a relatively smooth variation trend almost consistent with that for larger submergences indicating a secondary free surface effect in the range of 100 230 t 0 675t e 0 71t e and 460 580 t 0 785t e 0 82t e k tx and 10k qx experience a similar smooth decrease as in the case of l d 0 75 fig 27 b and l d 1 0 fig 27 c these two intervals correspond to the in water phase as described by califano 2010 which indicates that single blade loads currently receive a relatively weak free surface effect compared to the water exit phase where the transient impact forces occur fourth in the interval t 1 109t e 1 329t e right the overall smooth variation of k t and 10k q along with large amplitude rises and drops indicate a generally weakened propeller surface interaction but still obvious for azimuthal positions close to the free surface specifically the second maximum k tx and 10k qx on the curve near 640 t 1 31t e experiences an abrupt rise making it obviously larger than the second maximum k tx and 10k qx in the same interval for l d 0 75 and 1 0 see fig 27 b and c this abrupt rise also probably results from a blade water impact as the propeller approaches the wave trough furthermore while the azimuthal position of the first minimum k tx and 10k qx is consistent with l d 0 75 and 1 0 near 45 t 1 123t e the azimuthal positions of the second and third minimum k tx and 10k qx experience an obvious shift to respectively 370 t 1 22t e and 720 t 1 329t e and the third minimum k tx and 10k qx is reduced to nearly zero this indicates an increasingly intense free surface effect for the upper blade as the propeller approaches the wave trough next we discuss the single blade load variation for l d 0 75 fig 27 b and l d 1 0 fig 27 c in which cases the free surface effect is now secondary or negligible and the unsteady and non uniform oblique flow effect is dominant first for both submergence depths in both time intervals with less intense propeller surface interactions compared to that for l d 0 5 k tx and 10k qx almost follow a smooth variation trend that is roughly consistent with the inflow analysis results however for l d 0 75 in the interval of t 0 641t e 0 861t e there s an exception in the azimuthal position range of 0 90 t 0 641t e 0 669t e fig 27 b left due to free surface effect in which k tx and 10k qx experience a more obvious increase from a low value at 0 with a hint of high frequency fluctuation this high frequency fluctuation of k tx and 10k qx results from the enhanced propeller surface interactions the low k tx and 10k qx at 0 from a possible blade tip emergence second in both intervals other than the above mentioned range in the last paragraph one may notice a slightly larger load variation magnitude for l d 0 75 than l d 1 0 this is due to the decreased variation magnitude of wave orbital velocity at a deeper submergence the third aspect requires special attention according to the inflow analysis in chapter 4 at t 0 75t e the maximum and minimum load respectively correspond to the azimuthal position of 90 and 270 at t 1 25t e contrarily it is 270 and 90 that correspond to the maximum and minimum load however in practice there is a shift of the azimuthal position corresponding to the maximum and minimum load take l d 1 0 fig 27 c as an example in which case the free surface effect is very limited in the interval t 0 641t e 0 861t e there s a slight shift of the first maximum and first minimum k tx and 10k qx from the azimuthal position of 90 to around 80 from 270 to around 280 although the second maximum k tx and 10k qx remains very close to 450 there is a slight shift of the second minimum k tx and 10k qx from 630 to around 640 comparatively in the interval t 1 109t e 1 329t e there is a more obvious shift of the two maximum and two minimum values of k tx and 10k qx from 270 to around 290 from 90 to 50 and from 630 to around 655 from 450 to 425 in our opinion there are two possible causes with coupled effects for this slight shift one is the self induction effect that would further amplify the non uniformity of load distribution on the propeller disk which has been qualitatively discussed in section 3 and was thoroughly investigated by dubbioso 2013 the more important one is the spatial non uniformity of the inflow velocity or more specifically the difference in the vertical component of inflow velocity on the propeller disk as for the self induction effect on the y 0 plane at t 0 75t e see fig 9 a due to the down wash up wash velocity on the upper portion lower portion of the propeller disk the instantaneous load decreases on the upper portion but increases on the lower portion at t 1 25t e fig 9 b contrarily the instantaneous load increases on the upper portion but decreases on the lower portion consequently assuming that only the self induction effect is considered at t 0 75t e the maximum minimum load on the propeller disk will experience a shift from 90 towards 180 from 270 towards 360 at t 1 25t e on the contrary the maximum minimum load will experience a shift from 270 towards 360 from 90 towards 180 however according to fig 27 c the maximum minimum load shift is of rather complicated pattern and obviously not totally in accordance with the above description a reminder that the spatial non uniformity of the inflow velocity may be the dominant cause which can be illustrated with fig 10 left side in section 3 at t 0 75t e fig 10 a as the azimuthal position increases from 0 to 180 with an increasing submergence on the propeller disk the upward pointing vertical component of inflow velocity yellow arrows decreases with the decrease of wave orbital velocity indicating that u circumferential and consequently α neglecting the minor difference in the axial component of inflow velocity at different submergences may hit their maximum slightly before the azimuthal position reaches 90 fig 10 a left side hence the maximum load may experience a slight shift from 90 towards 0 accordingly the minimum u circumferential and α may appear at an azimuthal position slightly larger than 270 causing the minimum load to shift from 270 towards 360 analogously at t 1 25t e fig 10 b the decreasing downward pointing vertical component of inflow velocity yellow arrows with increasing submergence indicates that the minimum and maximum u circumferential and α may appear at an azimuthal position smaller than 90 larger than 270 causing a shift of the minimum and maximum load from 90 towards 0 from 270 towards 360 apparently the spatial non uniformity of inflow velocity is the dominant cause for the shift of maximum and minimum load because the above explanation is totally consistent with fig 27 c with the above description let s come back to fig 27 c first in the interval t 0 641t e 0 861t e on one hand the first and second minimum k tx and 10k qx experience a slight shift respectively to 280 and 640 resulting from the inflow non uniformity effect or the synergy of the self induction effect and inflow non uniformity on the other hand as for the shift of the maximum load there exists a contradictory effect between the self induction effect from 90 towards 180 and inflow non uniformity effect from 90 towards 0 as discussed in the above paragraphs although the first maximum k tx and 10k qx shift slightly towards 0 the second maximum does not experience any obvious shift which probably results from an enhanced self induction effect near t 0 75t e with a maximum wake inclination second in the interval t 1 109t e 1 329t e the maximum and minimum k tx and 10k qx experience a shift that can be explained with solely the effect of inflow non uniformity the self induction effect whether contradictory or synergetic is not obvious it s safe to say that although the self induction effect of a propeller in oblique flow would contribute to an even more non uniform load distribution on the propeller disk it is not obvious on the single blade variations of a propeller in regular waves even at a sufficiently large submergence depth this could be associated with the unsteady and non uniform adjacent flow field in regular waves therefore the self induction effect will not be considered in the following sections as a supplement for the axial single blade load discussions above we herein offer a brief observation of the in plane single blade load dynamic behaviors at variant l d 0 5 0 75 and 1 0 in both intervals as shown in fig 28 a k ty b k tz for brevity only the in plane forces are discussed the moments are not included considering the similar dynamic behaviors generally speaking the effect of submergence depth on the variation trend of single blade k ty and k tz is basically similar to that of k tx and 10k qx as thoroughly discussed with fig 27 specifically at l d 1 0 and 0 75 in both intervals green and red dotted curves k ty and k tz both show an approximately sinusoidal variation trend with slight changes of the maximum and minimum values due to the unsteadiness and non uniformity of inflow this observation along with fig 27 b and c indicates a minor or even negligible free surface effect on both the axial and in plane single blade loads although an exception is observed at l d 0 75 in the range of 0 50 t 0 641t e 0 66t e where the maximum k ty and k tz is lowered to some extent with respect to l d 1 0 in the same range this phenomenon similar to the one observed with fig 27 b left side results from the enhanced propeller surface interactions with an upward inclined wake and from a possible blade tip emergence due to a low l d ins around 0 55 according to fig 19 d at l d 0 5 with the decisive free surface effect the single blade k ty and k tz show obvious difference than at l d 1 0 and 0 75 especially in the azimuthal position range where the blade is interacting with or even emerging from the free surface for example in the interval t 1 109t e 1 329t e right the maximum single blade k ty and k tz is relatively lower than at l d 1 0 and 0 75 in the azimuthal position range of approximately 360 420 t 1 219t e 1 35t e which corresponds to the out of water phase as described by califano 2010 subsequently the lowering of the maximum in plane loads in the next revolution appears even earlier at the azimuthal position of approximately 675 t 1 315t e corresponding to the water exit phase this is because as the wave propagates the propeller is approaching the wave trough hence spends an even larger portion of revolution interacting with the free surface in the interval t 0 641t e 0 861t e left the lowering of the maximum in plane loads is observed to correspond to an even larger azimuthal position range e g 320 450 t 0 74t e 0 779t e compared to the interval t 1 109t e 1 329t e right also one may observe a hint of high frequency components in both the k ty and k tz time series these phenomena are attributed to the enhanced propeller surface interactions 5 3 instantaneous thrust and torque at different azimuthal positions fig 29 a c shows the instantaneous k tx and 10k qx generated by the four blades at different azimuthal positions of 0 90 180 and 270 at two instants t 0 753t e left and t 1 223t e right first for l d 0 5 fig 29 a the instantaneous thrust and torque on each blade is obviously inconsistent with the inflow analysis results at certain azimuthal positions for example at t 0 753t e and t 1 223t e the instantaneous thrust and torque on the upper blade 0 at t 0 753t e k tx 0 0136 10k qx 0 02198 at t 1 223t e k tx 0 03262 10k qx 0 04842 is obviously lower than the corresponding one for l d 0 75 at t 0 753t e k tx 0 03949 10k qx 0 05731 at t 1 223t e k tx 0 04801 10k qx 0 06609 and 1 0 at t 0 753t e k tx 0 04518 10k qx 0 06317 at t 1 223t e k tx 0 04892 10k qx 0 06703 this is due to the emergence of the blade tip also at t 0 753t e due to the impact forces the instantaneous loads on the portside blade 270 k tx 0 04662 10k qx 0 05933 is obviously larger than the corresponding one for l d 0 75 k tx 0 03199 10k qx 0 04532 and 1 0 k tx 0 03553 10k qx 0 04921 other than these azimuthal positions the instantaneous loads on the blades at 90 180 at t 0 753t e and 90 180 and 270 at t 1 223t e have similar trends to that for larger submergences indicating a less intense free surface effect on said blades in addition the instantaneous loads on the upper blade 0 at t 0 753t e k tx 0 0136 10k qx 0 02198 is obviously lower than at t 1 223t e k tx 0 03262 10k qx 0 04842 due to the emergence of the upper blade consequently due to the hysteresis effect the instantaneous loads on the lower blade 180 k tx 0 04123 10k qx 0 05863 at t 0 753t e is also lower than at t 1 223t e k tx 0 04957 10k qx 0 06718 second for l d 0 75 fig 29 b the magnitudes of the instantaneous loads on each blade are basically similar to those for l d 1 0 fig 29 c indicating a secondary free surface effect to the oblique flow effect although at t 0 753t e an obviously lower instantaneous k tx 0 03949 and 10k qx 0 05731 appears for the upper blade with respect to l d 1 0 k t 0 04518 10k q 0 06317 at said instant due to an enhanced propeller surface interaction third at l d 1 0 fig 29 c there is some difference between the instantaneous k tx and 10k qx generated by the upper blade and the lower blade which is less obvious at t 1 223t e than at t 0 753t e specifically at t 0 753t e k tx and 10k qx on the upper blade are obviously lower than on the lower blade k tx 0 04518 0 04629 10k qx 0 06317 0 06445 at t 1 223t e the differences of k tx and 10k qx between the upper and lower blades become less obvious k tx 0 04892 0 04949 10k qx 0 06703 0 06718 in our opinion it is the minor but non negligible free surface effect that results in this difference at t 0 753t e the downstream axial velocity in the upper portion of the wake is slightly reduced due to the enhanced propeller surface interaction and is consequently slightly lower than that in the lower portion fig 33 lower left a similar observation was made by paik 2008 that the downstream axial velocity is reduced if the propeller is moved closer to the free surface the lower downstream axial velocity in the upper wake indicates a lower instantaneous thrust generated by the upper blade at t 1 223t e because of the almost absent free surface effect the downstream axial velocity in the upper wake is barely reduced hence of similar magnitude as that in the lower wake fig 33 lower right indicating that the difference is very minor between the instantaneous thrust and torque generated by the upper and lower blades see fig 31 finally for l d 1 0 fig 29 c a lower instantaneous k tx and 10k qx is observed on the upper and lower blades at t 0 753t e than at t 1 223t e k tx 0 04518 0 04892 at 0 0 04629 0 04949 at 180 10k qx 0 06317 0 06703 at 0 0 06445 0 06718 at 180 one reason is at t 0 753t e due to the enhanced propeller surface interaction the minor free surface effect alters the pressure distribution and causes thrust loss on the upper blade which also lowers the instantaneous thrust on the lower blade due to hysteresis effect the other may be a larger instantaneous upstream axial velocity at t 0 753t e than t 1 223t e as can be observed in figs 32 and 33 which results in a larger instantaneous axial inflow velocity and a smaller instantaneous k tx and 10k qx 5 4 pressure distribution and wake characteristics the instantaneous static pressure contours on pressure and suction sides are shown in fig 30 t 0 753t e and 31 1 223t e first for l d 0 5 left the enhanced propeller surface interaction at t 0 753t e is clearly reflected on the scattered pressure distribution of weak intensity on the upper blade indicating low and fluctuating thrust and torque on said blade fig 27 a and 29 a left this chaotic pressure distribution also results in a less fully developed pressure distribution and lower instantaneous thrust and torque on the lower blade due to the hysteresis effect compared to t 1 223t e on the same blade as discussed with fig 29 a also on the portside blade due to the blade water impact obvious high pressure and high suction areas of strong intensity are respectively formed on the leading edge of the pressure and suction side near mid span which explains the abrupt increase in the instantaneous thrust and torque near the azimuthal position of 270 fig 27 a and 29 a left side second for l d 0 75 middle and 1 0 right the instantaneous blade load distribution is basically consistent with the inflow analysis specifically at t 0 753t e the pressure and suction intensity on the starboard blade is obviously larger than on the port side indicating a larger instantaneous thrust on the starboard blade see fig 29 b and c left conversely at t 1 223t e the portside blade has the larger pressure and suction intensity hence a larger instantaneous thrust also for l d 1 0 a weaker pressure intensity is observed on the pressure and suction sides of the upper and lower blades at t 0 753t e than at t 1 223t e indicating a lower instantaneous k t and 10k q on the upper and lower blades at t 0 753t e than at t 1 223t e the reason as discussed with fig 29 c is the minor free surface effect at t 0 753t e and a larger instantaneous axial inflow velocity at t 0 753t e the instantaneous downstream axial velocity contours normalized by v a on the z 0 plane is shown in fig 32 in which the positive y direction portside 270 points upward first at t 0 753t e due to the enhanced propeller surface interactions the propeller wake experiences even more obvious contraction towards the propeller axis as l d decreases from 1 0 to 0 5 the propeller wake contraction has been studied in many researches e g baek et al 2015 regarding propeller wake characteristics without considering the free surface which similar to vortex breakdown and merging is considered as related to the inherent wake instability at high loadings in the present simulations for l d 0 5 and 0 75 the more obvious wake contraction mainly results from the external disturbance of the free surface that destructs and dissipates the propeller vortex system for l d 1 0 with very limited free surface effect the less obvious wake contraction is attributed mainly to the internal wake instabilities aside from the contraction with decreasing l d comes more chaotic distortion of the vortex system the starboard lower and portside portion upper of the wake are merged together in the far wake for l d 0 75 and then completely distorted for l d 0 5 despite the contraction and distortion at l d 0 5 and 0 75 the oblique flow effect still manifests in the fact that the starboard portion of the wake has the larger downstream velocity magnitude even for l d 0 5 with completely distorted wake also for l d 0 5 an upstream high velocity area with negative magnitude is formed near the portside blade which represents the blade water impact that causes abrupt thrust rise on said blade as discussed with fig 27 a and 29 a at t 1 223t e without direct interactions with the free surface the propeller wake remains relatively stable for all three submergences with a larger induced velocity magnitude in the portside portion of the wake than in the starboard portion the wake contraction still exists with a small slope in the near wake but ceases in the far wake most likely due to the inherent instability of the wake itself in addition one may notice a larger downstream axial velocity at t 0 753t e than at t 1 223t e also see fig 33 due to a larger upstream axial velocity near the propeller disk at t 0 753t e which is related to the wave orbital velocity distribution fig 33 offers the instantaneous downstream axial velocity contours normalized by v a on the y 0 plane for l d 0 75 and 1 0 from which we can make two observations first at t 0 753t e for both submergences the axial velocity magnitude in the lower portion near 180 is slightly larger than that in the upper portion near 0 of the wake this results from the free surface effect so that the downstream axial velocity magnitude in the upper wake is reduced with respect to the lower wake which explains the lower instantaneous thrust produced by the upper blade than the lower blade for l d 0 75 and 1 0 as can be observed in fig 29 b and c left side second at t 1 223t e for both submergences there is no obvious difference in the axial velocity magnitude between the lower and upper portion of the wake suggesting a very limited difference in the instantaneous thrust produced by the upper and lower blades as confirmed by fig 29 b and c right side this phenomenon also verifies the conclusion section 5 2 that the self induction effect on the single blade load non uniformity is unobvious in the present simulations or on a larger scale for a propeller in regular waves 6 concluding remarks for an in depth view of ventilation and load fluctuation of propeller in waves this paper presents a rans investigation on open propeller dynamic loads in regular head waves at variant submergence depths from the perspective of the coupled oblique flow and free surface effect as an inherent feature of propagating regular waves numerical methods are first proven reliable in dealing with propeller surface piercing conditions through cfd v v on a test case in calm water as well as further validation on a test case in regular head waves in detail discussions are made mainly focusing on the dynamic behaviors of thrust and torque including the integral load variations in the entire period of encounter single blade load variations in different time intervals as well as instantaneous loads at different azimuthal positions and instants with the aid of instantaneous flow visualization short discussions are also offered as a supplement regarding the in plane integral and single blade load dynamic behaviors conclusions are as follows first via both numerical simulation and model experiment we have identified the enhanced propeller surface interactions due to an upward wake inclination referring to a direct interaction between the propeller vortex system and the free surface as well as the consequent high frequency fluctuation of the axial and in plane integral loads this enhanced propeller surface interaction happens for a periodically emerging propeller approaching the wave crest from wave trough which according to numerical results exerts various negative influences on propeller performance e g destruction and dissipation of the propeller vortex system wake contraction and distortion chaotic pressure distribution on propeller blades as well as high frequency fluctuation of the single blade thrust torque and in plane loads second for very small submergence depths especially when the enhanced propeller surface interactions occur the free surface effect is the dominant factor on the single blade thrust torque and in plane loads and instantaneous thrust and torque at different azimuthal positions the emerging upper blade produces the minimum thrust and torque resulting in a partially developed pressure distribution on the lower blade due to hysteresis effect also the thrust and torque generated by the portside blade i e water exit phase will experience an abrupt rise due to a drastic impact with the free surface on the contrary the lower blade and the starboard side blade receive a relatively less intense free surface effect third for larger submergence depths e g fully submerged condition with secondary or eliminated free surface effect single blade thrust torque and in plane loads and instantaneous thrust torque at different azimuthal positions are basically dominated by the unsteady and non uniform oblique flow environment with possible exceptions of the blade close to the free surface as a result the axial load distribution on the propeller disk is concentrated on the port side as the propeller approaches the wave trough from wave crest but on the starboard side as the propeller approaches the wave crest from wave trough the shift of the maximum and minimum thrust and torque from the exact port and starboard position results from the inflow velocity non uniformity while the difference between the instantaneous loads on the upper and lower blades is due to the minor but non negligible free surface effect also the self induction effect in oblique flow which would further amplify the non uniformity of the load distribution on the propeller disk is found to be unobvious on the single blade thrust and torque both dynamic and instantaneous of a propeller working in regular waves which is attributed to the unsteady and non uniform inflow environment credit authorship contribution statement wencan zhang investigation formal analysis writing original draft writing review editing ning ma writing review editing resources supervision xiechong gu writing review editing peiyuan feng writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this research is supported by the china ministry of education key research project kship ii project knowledge based ship design hyper integrated platform no gkzy010004 and by the national natural science foundation of china grant numbers 51709240 
20613,to offer references for ventilation and load fluctuation of propeller in actual seaway this paper presents a rans reynolds averaged navier stokes equations investigation on open propeller dynamic loads in regular head waves at variant submergence depths from the perspective of the coupled oblique flow and free surface effect discussions are made concerning the dynamic integral loads and single blade loads both axial and in plane and instantaneous single blade loads at different azimuthal positions cfd computational fluid dynamics verification and validation are conducted based on an experiment in calm water and regular head waves conducted in a circulating water channel as conclusions under fully submerged condition single blade load variations are related solely to the unsteady oblique flow environment with shifts of azimuthal positions corresponding to the maximum and minimum thrust and torque due to inflow non uniformity under periodical emerging condition high frequency integral load fluctuations are identified by both simulation and experiment resulting from the enhanced propeller surface interactions due to upward wake inclination this enhanced propeller surface interaction also causes serious ventilation abrupt rises or drops of axial single blade loads and destruction and dissipation of propeller vortex system furthermore the self induction effect on the load distribution non uniformity is found to be unobvious in regular waves due to the unsteady and non uniform inflow environment keywords open propeller dynamic loads oblique flow enhanced propeller surface interaction regular head waves 1 introduction the abrupt loss and large amplitude fluctuation of propeller loads for ships in rough seas are responsible for problems such as speed loss propeller and bearing damages and even hull vibration under severe circumstances to offer more valuable references for understanding and solving such problems propeller dynamic loads in waves requires in depth investigations near surface propeller dynamic loads basically result from the propeller surface interactions especially at high loadings where ventilation is more inclined to occur in recent years a number of numerical researches have been conducted regarding ventilated marine propellers in calm water for example based on numerical and experimental methods kozlowska et al 2011 investigated propeller ventilation and thrust fluctuation at constant submergence depth in a wide range of advance ratios it was found that cfd over predicts the propeller loads under ventilating condition a phenomenon that was attributed by the authors to the inability of the rans methods to solve the miniature ventilating vortices califano et al 2011 simulated the dynamic loads of a fully submerged propeller at high loading in which case the propeller blade was found to be surface piercing during ventilation although good agreement was achieved between the simulated and measured dynamic loads on the upper most blade piercing the free surface relatively obvious discrepancies were found on the blades at other angular positions and the reason for the discrepancies were investigated thoroughly li et al 2015 performed cfd simulations to investigate the effect of free surface on propeller transient forces and vortical structures it was found that as the propeller submergence decreases higher harmonics appear on the simulated thrust and torque especially at higher loadings using two propeller models of different sizes as the research object paik 2017 numerically studies the hydrodynamic performance vortex structure and propeller induced wave pattern of near surface propeller it was found that the smaller propeller model experiences a greater decrease of thrust and torque than the larger due to the free surface effect the above listed studies all focused on calm water conditions concerning the dynamic loads of near surface propeller in waves most researches are based on experiments conducted in early times for example naito and nakamura 1979 conducted a model experiment to investigate the time averaged and dynamic loads of open propeller in calm water with varied submergence depths and in regular waves with varied wave heights it was concluded that the propeller load fluctuation behaviors in regular waves are influenced by both the orbital velocity variation and submergence variation cao 1988 conducted an experimental study primarily on the time averaged open propeller performances in calm water and regular waves the thrust fluctuation behaviors in waves were calculated based on a quasi steady method koushan 2009 experimentally studied the load fluctuations of an open propeller under the effect of regular waves and ventilation the maximum and minimum load are identified respectively at wave crest and wave trough indicating a dominating effect of water surface elevation on load fluctuation behaviors more recently very limited cfd researches have been published for example based on a propeller body force model tokgoz et al 2017 calculated the time varying thrust and torque of two propeller models in regular waves the authors made a similar observation to that by koushan 2009 i e the highest and lowest thrust and torque appear respectively at the wave crest and wave trough zhao et al 2017 did a comparison study on propeller dynamic loads at two advance ratios using both numerical and experimental methods the authors observed obvious thrust and torque fluctuations from the simulated and measured thrust and torque time series the physical mechanism of near surface propeller dynamic loads in regular waves is more complicated compared to that in calm water in axial uniform inflow generally the dominant factor for the complicatedness is the oblique flow effect as an inherent feature of the propagating regular waves and the coupled free surface effect at low submergences for a propeller fully submerged within the whole period of encounter neglecting the free surface effect due to the wave orbital velocity it experiences non uniform inflow with periodically varying magnitude and incidence angle therefore on one hand the single blade loads vary with azimuthal positions due to the oblique flow effect but supposedly there are differences from the uniform and steady oblique flow environment due to inflow unsteadiness and non uniformity on the other hand the instantaneous load distribution on the propeller disk is unsteady due to the unsteady oblique flow environment itself more importantly for a propeller periodically emerging in regular waves one must also consider the free surface effect which is closely coupled with the oblique flow effect with time varying inflow incidence angle comes a time varying propeller wake inclination direction hence the propeller surface interactions are enhanced with an upward wake inclination which can destruct and dissipate the propeller vortex system and cause high frequency load fluctuation and abrupt thrust loss obviously for an in depth understanding of the dynamic behaviors of the integral and single blade loads of propeller in waves one must put emphasis on the coupled oblique flow and free surface effect as well as the consequent flow field details this is what previous researches regarding propeller dynamic loads in waves have neglected to do regarding propeller in oblique flow numerous numerical and experimental researches can offer us abundant inspiration for example dubbioso et al 2013 studied pressure distribution and wake field characteristics of a propeller model in oblique flow and discussed the effect of induced velocity over the propeller disk due to slipstream inclination i e the self induction effect which amplifies the non uniformity of pressure distribution on each blade as an extension of the experimental study byfelli et al 2018 regarding the wake behaviors of propeller in axial inflow to the oblique flow conditions di mascio et al 2014 conducted des detached eddy simulation simulations to investigate the wake dynamics of the e779a insean propeller model in oblique flow at two different propeller loadings and one constant incidence angle it was found that the propeller wake tilt in oblique flow which forms a misalignment with respect to the incoming flow causes the root and hub vortices to interact with and bring instabilities to the tip vortices alimirzazadeh et al 2016 investigated the time varying loadings on a single blade of a surface piercing propeller spp at different angles of incidence and different submergence depths it was found that the maximum efficiency of spp is not achieved at zero angle of incidence which is worth considering in the design of spps based on both experimental and numerical methods berchiche et al 2018 studied the dynamic integral loads and single blade loads of a ducted thruster in oblique flow with numerical simulations performed at small submergences in axial inflow to evaluate the free surface effect on the thruster performance felli et al 2018 conducted detailed measurements of wake characteristics of a propeller in oblique flow at variant incidence angles based on particle image velocimetry piv technology the authors observed remarkable differences in propeller vortical behaviors between oblique flow condition and axisymmetric condition which are allegedly caused by the wake stream tube misalignment with the main flow and the presence of a main flow component on the propeller plane zhang chen and jiang 2020 b used urans unsteady reynolds averaged navier stokes equations method to investigate the oblique flow effect on the propeller lateral loads in open water and behind hull conditions it was concluded that the oblique flow has larger effects on the blade loads in the bottom half of the propeller disk compared with the top half aside from the coupled oblique flow and free surface effect for a periodically emerging propeller in waves one must also consider the hysteresis effect califano 2010 on the integral and single blade loads the hysteresis here refers to the fact that for a previously emerging propeller the recovery of the full thrust after this propeller is fully submerged is a gradual process it was inferred by koushan 2004 that for a typical propeller of typical geometry that is previously out of water it takes approximately 4 revolutions in full submergence to regain full thrust also according to an experimental research by zhang et al 2020 a b it takes approximately 5 propeller revolutions in full submergence for a previously emerging propeller to regain full thrust the hysteresis effect is generally considered related to the wagner effect wagner 1925 i e for an airfoil that accelerates instantaneously from rest to a certain constant speed there will be a delay in the build up of steady state lift to sum up in this paper we offer a rans investigation upon the dynamic loads of an open propeller in regular head waves at variant submergence depths from the perspective of the coupled oblique flow and free surface effect separate discussions are made regarding the integral load variation in the entire period of encounter the single blade load variation in different time intervals and the instantaneous single blade loads at different azimuthal positions and instants instantaneous wake analysis is also conducted cfd verification and validation v v are first conducted on a surface piercing test case in calm water according to the ittc international towing tank conference recommended procedure ittc 2017 with further validation on a periodically emerging test case in regular head waves the experimental results for validation purposes were obtained through an open propeller model experiment conducted in a circulating water channel 2 numerical methods 2 1 propeller geometry dimensionless coefficients and working conditions the propeller model used is a four bladed right handed mau series propeller table 1 shows its main particulars a cartesian reference system is shown in fig 1 the system origin is at the propeller disk center the x axis points to the bow the z and y axis to the vertical and port direction respectively as for the azimuthal position of propeller blades 0 and 180 refer respectively to the positive upward and negative downward z direction 90 and 270 to the starboard and port thrust torque coefficients in the i axis direction i x y and z are defined as 1 k t i t i ρ n 2 d 4 k q i q ρ n 2 d 5 where t i and q i are the propeller forces and moments in the i axis direction the advance ratio j is defined as eq 2 where v a is the inflow velocity prescribed at the inlet boundary of the computation domain 2 j v a n d the submergence depth and wave height are expressed non dimensionally as l d and h d where l is the vertical distance between the propeller disk center and static water surface h being the wave height in regular head waves the instantaneous advance ratio j ins and submergence depth l d ins at the propeller disk center are defined as 3 j i n s v a a ω w sin k x ω w t exp k z nd l d i n s l a cos k x ω w t d where a is wave amplitude ω w is wave frequency k is wave number and z is the vertical distance between the propeller shaft and static water surface the simulation cases are summarized as table 2 where t w represents wave period in validation part one calm water test case of l d 0 167 j 0 3 was selected for a systematic cfd uncertainty analysis and one regular wave test case of l d 0 5 h d 0 8 t w 1 0408s j 0 was chosen for further validation in results and discussions part three simulation cases of variant submergence depths are performed at first i e l d 0 5 0 75 1 0 h d 0 6 t w 1 0408s j 0 4 in these three cases l d 1 0 represents fully submerged condition where the propeller is fully submerged in the entire period of encounter l d 0 5 and 0 75 both represent periodically emerging condition i e the propeller tip periodically emerges from the free surface near the wave trough following these three cases is one case of l d 1 0 h d 1 0 t w 1 0408s j 0 05 which is offered for the completeness of this work 2 2 numerical models and solver options for incompressible flow the continuity equation and rans equation are written in tensor form as 4 x i u i 0 5 ρ u i t x j ρ u i u j p x i τ i j x j ρ f i where ρ is water density p is static pressure τ ij is shear stress ρf i is the gravity component on the i th direction by introducing the concept of the turbulent eddy viscosity coefficient μ t the reynolds stress ρ u i u j in eq 5 is calculated based on the boussinesq approximation written as eq 6 6 ρ u i u j 2 μ t u i x j u j x i 2 3 ρ k μ t u i x i δ i j where k is the turbulent kinetic energy δ ij is the kronecker delta with the boussinesq approximation used the calculation of the reynolds stress now depends on the calculation of μ t the shear stress transport sst k ω model is considered to have good performance in resolving viscous flow within the boundary layer and in predicting flow separation and reattachment as a common phenomenon on the propeller suction side therefore we select the sst k ω model for turbulence modeling the definition of μ t in the sst k ω model is written as 7 μ t ρ k min α ω t a 1 s f 2 where α is a model coefficient s is the mean strain tensor and f 2 is a blending function the definitions and expressions of these variables and functions can be found in the star ccm documentation ver 12 06 cd adapco 2017 the transport equations for the turbulent kinetic energy k and the turbulent dissipation rate ω t are written as follows 8 ρ k t x i ρ k u i x j γ k k x j g k y k 9 ρ ω t t x i ρ ω t u i x j γ ω t ω t x j g ω t y ω t d ω t where g y and γ are the generation dissipation and effective diffusivity of k and ω t d ωt is the cross diffusion term the 2nd order time and space discretization is used to solve the governing equations time step is 1 15e 04s roughly 0 5 degrees of rotation each of which contains 15 inner iterations the pressure velocity coupling was implemented based on the simple semi implicit method for pressure lined equation algorithm the under relaxation factors for velocity and pressure are set as default values rather than reduced because the simulation has been well stabilized in the trial runs by other measures e g elongating the computation domain the vof volume of fluid multiphase model was applied to simulate the free surface deformation and wave pattern the basic information about the vof model has been thoroughly introduced by alimirzazadeh et al 2016 overset mesh method was applied to simulate propeller rotation all simulations were performed using the commercial code star ccm ver 14 02 using a node with 36 processors 2 3 computation domain computation domain the computation domain is a rectangular parallelepiped which is 18m in length 6m in width and 4m in height as shown in fig 2 the distance is 5m between the propeller model center and inlet boundary and 13m from the propeller center to the outlet boundary to eliminate the reverse flows at the outlet wave propagating and inflow direction is negative x axis direction with overset grid method used for simulating propeller rotation the domain is split into a global fixed part static region and a cylindrical rotating part rotating region that encloses the entire propeller model boundary conditions the propeller blade and hub surfaces are set as no slip wall condition on the cylinder surface of the rotating region an overset mesh interface was created to couple the rotating region mesh with background mesh for the computation domain the boundary conditions of velocity inlet and pressure outlet are respectively set on the inlet and outlet boundaries while the other four boundaries are set as slip wall condition wave generation and absorption in regular wave simulations the first order waves are generated and absorbed with the wave forcing method kim et al 2012 applied at both the inlet and outlet boundaries this method forces the solution of the discretized n s equations towards the theoretical solution of the wave model by adding a source term written as eq 10 10 q ϕ α ρ ϕ r a n s ϕ w a v e where φ rans is the current solution of the rans equations and φ wave is the theoretical solution of the wave model α 1 is specified as a function of the distance d to the boundary 11 α 1 α 0 cos 2 π 2 d d 1 where α 0 is a parameter of the wave forcing model d ranges from 0 to d 1 d 1 2 5m is the wave forcing length for our simulations approximately 1 5 times the wave length a monitoring point for water surface elevation is located at 0 0 8 0 i e 0 8m away from the propeller disk center on the port side where the generated regular waves are not disturbed by propeller generated waves in calm water simulations for v v purposes wave damping method choi et al 2009 is applied at the outlet boundary to absorb propeller generated waves by adding z axis direction damping source terms written as eq 12 to the water particle vertical velocity equation 12 s z d ρ f 1 f 2 w e κ 1 e 1 w the variable κ is written as 13 κ x x s d x e d x s d n d where x sd and x ed respectively are the starting point 2 5m away from the outlet boundary and end point outlet boundary of the wave damping zone f 1 f 2 and n d are parameters of the wave damping model w being vertical velocity component 2 4 meshing an unstructured hexahedral mesh was generated in the computational domain local mesh refinement is performed in the rotating region propeller wake area and free surface area leading to a total grid cell number of approximately 13 million as shown in figs 3 and 4 a special mesh refinement was performed on the leading trailing edges as well as the blade roots to ensure the fidelity of geometry details 15 orthogonal prismatic cell layers are generated on the propeller surface and the absolute thickness of the near wall prism layer was selected so that the dimensionless wall distance y 3 anywhere on the propeller blade for fully submerged conditions fig 5 shows the instantaneous y contour for the case of l d 1 0 in regular waves after the simulation has reached a steady state as one can observe y is rather small on the majority of the blade surface on both pressure left and suction sides right but relatively large in the vicinity of the leading edges figs 6 8 respectively shows the mesh generation on the x 0 y 0 plane sections and on the calm water surface in fig 6 a and b represent the cuboid mesh refinement area for the free surface near the propeller which stretches 0 3m upstream and 0 55m downstream of the propeller disk center in this area the generated mesh consists of all trimmed hexahedra grids with anisotropic size x 1 300 wave length y 1 150 wave length and z 1 40 wave height c and d respectively refers to the mesh refinement area for the overlapping area and the rotating region the mesh is distributed evenly and isotropically in these two areas with grid cell size being 1 100d in the rotating region and 1 50d in the overlapping area the boxed area labeled e in fig 7 is the inflow velocity mesh refinement area located upstream of the propeller in order to better capture the propeller wake evolution mesh refinement is performed in the area labeled f where the isotropic grid size is 1 50 the propeller model diameter the same as that in the overlapping area labeled c in fig 6 a typical free surface mesh refinement is done for the whole computational domain represented by g in fig 8 with anisotropic grid size being x 1 150 wave length resulting in a courant number of around 0 012 that can well satisfy the cfl courant friedrichs lewy converge condition cfl 0 5 for the free surface simulation under 2nd order time discretization y 1 37 5 wave length and z 1 20 wave height in addition we give an extra refinement for the propeller aroused kelvin wave area the trapezoid area h for which the anisotropic grid size x 1 300 wave length the a b g and h mesh refinement areas can be relocated along the z axis according to the desired submergence depth 3 inflow analysis of propeller in regular head waves in this section to lay a foundation for the following discussions regarding the dynamic integral and single blade loads we offer an inflow analysis for this propeller in regular head waves respectively on the y 0 section plane fig 9 and propeller blade pressure side fig 10 and on the generic blade sections fig 11 at different azimuthal positions of 0 90 180 and 270 in fig 10 left inflow analysis for when the four blades are at random azimuthal positions is also offered considering t 0t e as the starting instant where the propeller is located at the first wave crest t e represents the period of encounter two instants are selected to respectively represent the process of the propeller approaching the wave crest from wave trough t 0 75t e labeled as a in the following figures and approaching the wave trough from wave crest t 1 25t e b fig 12 shows the instantaneous velocity vectors at both instants in regular head waves on the y 0 section plane of the computation domain for l d 0 75 and t w 1 0408s the advance ratio j 0 4 corresponding to a flow velocity of v a 0 624 m s prescribed at the inlet boundary in order to better illustrate the actual instantaneous inflow velocity field where the propeller is operating the spatially averaged inflow velocities and the incidence angles to the four blades at 0 90 180 and 270 are respectively expressed as u 1 β 1 u 2 β 2 u 3 β 3 and u 4 β 4 in figs 10 and 11 ωr represents propeller rotational velocity where ω and r respectively represent propeller rotation angular velocity and the radial position of blade section the instantaneous angle of attack α of each blade section can be defined as 14 α θ arctan u axial u circumferential where u axial and u circumferential are the instantaneous axial and circumferential components of blade section inflow velocity θ the geometric pitch angle the calculated α of each blade section at 0 90 180 and 270 is shown in fig 11 according to figs 9 11 the inflow analysis results can be described as follows at both instants the instantaneous thrust produced by the propeller blade at 0 is of the same magnitude as that at 180 due to the same α theoretically the wave orbital velocity points vertically at both instants therefore the u axial into the two blade sections have the same magnitude i e u 1cosβ 1 u 3cosβ 3 furthermore at t 0 75t e the maximum and minimum instantaneous α hence the maximum and minimum instantaneous thrust respectively corresponds to the starboard 90 and port 270 at t 1 25t e contrarily the maximum and minimum instantaneous thrust respectively corresponds to the port 270 and starboard 90 in fig 9 the self induction effect on the inflow velocity asymmetry is qualitatively described on the y 0 plane at t 0 75t e fig 9 a the induced velocities by the tip vortices on the leeward side windward side generate a down wash up wash velocity that increases decreases the axial inflow velocity on the upper portion lower portion of propeller disk at t 1 25t e fig 9 b contrarily an up wash and a down wash velocity are generated to decrease increase the axial inflow velocity on the upper lower portion of the propeller disk the self induction effect would undoubtedly affect the instantaneous load distribution on the propeller disk but it is not considered in the calculation of α of each blade according to section 5 2 the self induction effect on the axial single blade load distribution is found to be unobvious which is supposedly due to the unsteady and non uniform inflow environment in regular waves furthermore it must be stated that the free surface effect as well as the inflow non uniformity and unsteadiness illustrated by the instantaneous inflow velocity vectors in fig 12 is neglected therefore the above inflow analysis does not necessarily reflect the actual circumstances of such complicated condition as near surface propeller in regular waves but rather serves as a reference 4 verification and validation of numerical methods in this section cfd verification and validation v v are conducted based on the ittc recommended procedure ittc 2017 on the time averaged thrust and torque k tx and 10k qx of this propeller model in calm water under surface piercing condition further comparison is offered between the measured and simulated k tx and 10k qx time series in regular head waves for validation purposes a propeller open water experiment was conducted in the circulating water channel cwc laboratory of shanghai jiao tong university in calm water and regular head waves using the propeller model introduced in table 1 that was made of aluminum alloy fig 13 shows the experiment arrangement the cwc test section is 8m in length 3m in width and the water depth is kept constant as 1 6m a flap type wave maker and a flow transparent wave absorber are respectively located at the left and right end of cwc test section the open boat device on which the propeller model is mounted stretches across the side track and contains a dynamometer and an electric motor that are linked to each other with gears a wave gauge is used to measure the wave surface elevation throughout the regular wave test conditions which is carefully placed so as not to affect the flow field in proximity to the propeller model a hand operated height regulator on the open boat device as well as a fixated ruler is used to achieve the desired submergence depth the flow velocity set values are adjusted on the control panel so that the target advance ratio j is achieved the sampling frequency is 100hz for calm water test case and 500hz for regular wave test case to capture the transient features more accurately measuring time is 30s for each case a high resolution camera is located on the ground aside the propeller model to capture the instantaneous free surface profiles the case of l d 0 167 and j 0 3 in calm water was selected for v v fig 14 shows the frequency spectrum of measured 10k qx of this test case which is obtained using fast fourier transform fft the shaft frequency n 12hz can be observed as the dominant frequency along with a rather high amplitude of the blade frequency n 48hz due to the propeller blades alternately impacting the water surface and ventilation electric noises at 20hz and 40 hz are also quite obvious that must be eliminated therefore the measured data in figs 15 and 16 were filtered with a low pass filter cut off frequency 50hz and with notch filters 19hz 21hz 39hz 41hz to get rid of the electric noises the present cfd verification was done based on three sets of grids of different resolution with a proper refinement ratio considering that the recommended grid spacing refinement ratio of r g 21 2 ittc 2017 would result in a prohibitively large cell number for the finest mesh 35m if the medium mesh were generated according to section 2 4 three sets of grids namely coarse grid 3 medium grid 2 and fine grid 1 are generated with r g 21 3 among which the medium grid is generated using the meshing strategies in section 2 4 cell number and calculated time averaged k tx and 10k qx of the three grids obtained from the time window in which the thrust and torque has reached a steady state are listed in table 3 fig 15 presents the k tx and 10k qx time histories obtained with the three grids along with experiment results the simulation physical time is 1 5s for each case which ensures a long enough steady state of propeller performance 0 7s 1 5s from which the time averaged k tx and 10k qx of three grids were obtained an intercepted 15s long measured time series is used as comparison as one may observe after 0 7s the time histories obtained with the coarse grid yellow appear relatively lower while the results of medium blue and fine red grids are higher and fairly close with each other for a clearer view of the steady state of propeller performance fig 16 shows a certain steady state portion of the simulated k tx and 10k qx time histories physical time 1s 1 25s corresponding to 3 propeller revolutions along with measured ones physical time 10s 12 5s corresponding to 30 propeller revolutions table 4 shows the results of verification and validation d represents experimental results e being the comparison error between d and numerical results based on the medium grid the efd experimental fluid dynamics uncertainty u d is determined following the ittc recommended procedure of uncertainty analysis for open water tests ittc 2014 with extra consideration of the bias in the measurement of submergence depth l b l 0 0015m the grid uncertainty u g is calculated using the factor of safety approach written as eq 9 where f s 1 25 15 u g f s δ r e g according to table 4 first with the increasing grid cell number monotonic convergence is achieved for both k t and 10k q showing an obviously weakened dependency of numerical results on the grid cell number once the medium standard is reached second validation is achieved at the u v level for both k tx and 10k qx based on the medium grid it s now safe to say that the medium grid along with the entire numerical methods has satisfactory accuracy for the simulation of propeller performance under surface piercing condition although the v v in calm water has been conducted further validation is still required for propeller dynamic loads in regular head waves which is a more complicated problem and is the research focus of the present work therefore using the medium grid we offer a cfd efd comparison of k tx and 10k qx time series in regular head waves within two wave periods the test case of l d 0 5 h d 0 8 j 0 and t 1 0408s is selected fig 17 shows the frequency spectrum of measured 10k q of this test case obtained using fast fourier transform fft the wave related harmonics are rather obvious with the dominant frequency being the wave frequency f w 0 96hz the shaft blade frequency and higher propeller related harmonics are also observable electric noises are obvious at both 42hz and 100hz and observable in the frequency range between 5n 60hz and 175hz hence a band block filter with cutoff frequency of 55hz lower and 175hz upper is used as well as a notch filter between 41hz and 43hz fig 18 presents the comparison of simulated and measured k tx and 10k qx time series of this test case along with simulated water surface elevation it is obvious that the simulated and measured results agree well with each other regarding both the maximum minimum values and overall variation trends showing the accuracy of the present numerical methods in simulating near surface propeller dynamic loads in waves more importantly in the time span of t t 0 1 0 3 and 1 1 1 3 in which the propeller approaches the wave crest until entering full submergence high frequency components are identified on both the simulated and measured k tx and 10k qx time series however in the time span t t 0 7 1 and 1 7 2 in which the propeller enters partial emergence and approaches the wave trough high frequency components are much less obvious with basically only shaft frequency and blade frequency fluctuations of k tx and 10k qx observed considering in the time span of t t 0 1 0 3 and 1 1 1 3 the inflow velocity to the propeller disk is upward inclined we attribute this high frequency thrust and torque fluctuation to the upward inclination of propeller wake that enhances the propeller surface interaction and causes thorough destruction of propeller vortex system 5 results and discussions 5 1 axial and in plane integral loads within one period of encounter for an investigation of the axial forces and moments i e thrust and torque fig 19 shows the simulated time history of k tx and 10k qx within one period of encounter a b from the first to the second wave crest j ins calculated according to eq 3 on the left side c and l d ins calculated according to eq 3 on the right d using the simulated water surface elevation first at l d 1 0 fully submerged condition k tx and 10k qx present an almost sinusoidal variation in the entire period of encounter the j ins periodical variation is the sole determinant of the integral load variation characteristics while the effect of l d ins periodical variation is unobvious with very limited propeller surface interaction even at wave trough fig 20 let s come back to fig 19 at l d 0 5 and 0 75 periodically emerging condition after the propeller leaves the first wave crest t 0 k tx and 10k qx both experience a smooth increase at first and then blade frequency fluctuations starting from a certain instant for l d 0 5 t 0 2t e for l d 0 75 t 0 3t e this instant is featured by a sudden impact occurring between the upper most blade tip and the wave surface causing an abrupt drop of the instantaneous integral loads indicating that the propeller becomes surface piercing again from this instant to the wave trough t 0 5t e blade frequency fluctuations of k tx and 10k qx appear resulting from the alternate impacting between each blade and the water surface subsequently in the time interval where the propeller leaves the wave trough and approaches the second wave crest for l d 0 5 t 0 5t e 0 9t e for l d 0 75 t 0 5t e 0 72t e the values of k t and 10k q are generally lower than in the interval where the propeller approaches the wave trough for l d 0 5 t 0 2t e 0 5t e for l d 0 75 t 0 3t e 0 5t e one reason is the hysteresis effect due to propeller blade emergence near the wave trough so that the propeller thrust is not fully recovered in the former time interval the other reason is the thrust loss from the enhanced propeller surface interactions with an upward wake inclination this enhanced propeller surface interaction also causes high frequency k tx and 10k qx fluctuations for l d 0 5 in the interval t 0 5t e 0 9t e while only blade frequency fluctuations are observed in t 0 2t e 0 5t e the high frequency components have been identified by both experimental and numerical results in the regular wave test case at j 0 as discussed in section 4 aside from the axial integral loads a short discussion is offered herein regarding the in plane integral load variations fig 21 shows the simulated time history of k ty a 10k qy b k tz c and 10k qz d within one period of encounter first at l d 1 0 fully submerged condition with an almost absent free surface effect throughout the entire period of encounter one can observe an approximately sinusoidal variation trend of both the lateral and vertical forces and moments black dotted curves in line with the periodical variation of wave orbital velocity which is similar to that experienced by k tx and 10k qx see fig 19 a b in addition the maximum absolute values of both the lateral load components k ty 10k qy and the vertical ones k tz 10k qz are identified at approximately t 0 75t e this is because in regular head waves the instant of t 0 75t e features the maximum incidence angle of inflow with respect to the propeller disk at which the instantaneous wave orbital velocity points vertically upwards also in the entire period of encounter despite the fact that the y axis component of the inflow velocity is zero the average lateral forces and moments is observed to be slightly below zero see fig 21 a b this results possibly from the non homogeneity of the self induction velocity over the propeller disk dubbioso et al 2013 at l d 0 5 and 0 75 periodically emerging condition the lateral and vertical forces and moments show high amplitude fluctuations at the blade frequency and even higher frequencies in basically the same patterns and actually due to the same reasons as thrust and torque see fig 19 a b take l d 0 5 as an example in the interval of t 0 2t e 0 5t e blade frequency fluctuations are observed for both the lateral and vertical load components due to the periodical impact between the blade tip and the free surface in the interval of t 0 5t e 0 9t e the high frequency fluctuations are due to the enhanced propeller surface interactions with an upward inclined propeller wake this reminds us that in actual seaway aside from the drastic fluctuations of thrust and torque the lateral and vertical forces and moments may behave the same way these load fluctuations may contribute to strength problems of the bearing system and affect the ship s maneuverability negatively as a supplement for the above discussions we would like to point out that the submergence depth of l d 1 0 in regular waves does not necessarily guarantee a negligible free surface effect on this propeller s dynamic load behaviors in fact even at large submergence depths but under certain circumstances propeller forces and moments may just as well suffer from severe fluctuations at blade frequency or even higher frequencies as they do at low submergences as an example an enlarged wave height h d and a decreased j would both contribute to more intense propeller surface interactions a larger h d means a smaller l d ins as the propeller approaches the wave trough so that ventilation and even tip emergence is easier to occur and a smaller j would lead to even lower pressure on the suction side hence more intense ventilation taking the thrust and torque as an example we herein offer a short discussion with the case of l d 1 0 h d 1 0 j 0 05 and t w 1 0408s fig 22 presents the k tx and 10k qx time histories left as well as calculated j ins and simulated l d ins time histories right for this case one may observe from fig 22 that in the interval of t 0t e 0 47t e the k t and 10k q shows a roughly sinusoidal variation trend which is similar to the case of l d 1 0 h d 0 6 j 0 4 see fig 19 a and b black dotted curves but as the propeller approaches the wave trough one can observe slight blade frequency fluctuations in the interval t 0 25t e 0 47t e due to the increasingly intense propeller surface interactions which cannot be observed in the case of l d 1 0 h d 0 6 j 0 4 in the same interval more importantly at the instant of t 0 47t e the propeller is near the wave trough k tx and 10k qx experiences an abrupt drop and then fluctuations at blade frequency and even higher frequencies until t 0 71t e the abrupt drop of k tx and 10k qx most likely results from an impact between the propeller tip and the free surface l d ins 0 5 and the enhanced propeller surface interactions due to upward wake inclination are deemed responsible for the fluctuations after t 0 71t e high frequency components have disappeared in the load fluctuations leaving only blade frequency components of very limited amplitude this manifests a decreasing intensity of propeller surface interactions after this point the reason for this is as the propeller approaches the wave crest not only l d ins is gradually increasing but also the inclination angle of propeller wake is decreasing due to a decreasing angle of incidence of the inflow velocity as illustrated in fig 12 hence the propeller wake is further away from and hence free of direct interactions with the free surface let s come back to the enhanced propeller surface interaction that causes high frequency fluctuations in the propeller axial and in plane loads which was at first identified from the instantaneous free surface profiles in the regular wave experiment cases see fig 23 belonging to the test case of l d 0 5 h d 0 6 0 8 j 0 2 and t w 1 0408s one can observe rather obvious difference in ventilation patterns due to different directions of wake inclination despite the similar l d ins and j ins specifically when the propeller is approaching the wave crest from wave trough left despite the fact that the propeller is fully submerged serious ventilation occurs due to direct interactions between the free surface and the upward inclined wake featuring concentrated air bubbles downstream in the near wake representing an air entrainment through the tip vortices in contrast no ventilation can be observed when the propeller is approaching the wave trough right in which case the propeller slipstream is downward inclined and hence avoids direct interactions with the free surface the enhanced propeller surface interactions can be better visualized with cfd figs 24 26 in these figures considering t 0t e as the starting instant where the propeller is located at the first wave crest two instants are chosen to respectively represent the process of the propeller approaching the wave crest from wave trough t 0 753t e and the propeller approaching the wave trough from wave crest t 1 223t e fig 24 shows the instantaneous free surface profiles on the y 0 plane for l d 0 5 and 0 75 at t 0 753t e left and t 1 223t e right obviously for a certain l d free surface deformation and ventilation are obviously more intense at t 0 753t e than at t 1 223t e the reason for this as was also discussed above with fig 23 is that at t 0 753t e there exists a direct interaction between the free surface and the upward inclined propeller wake while at t 1 223t e the downward inclined propeller wake avoids direct interaction with the free surface as illustrated in fig 12 also one can observe drastic free surface deformation for l d 0 5 at t 0 753t e upper left in the near wake indicating the destruction and dissipation of propeller vortex system which will be further investigated in the subsequent sections this vortex system destruction and dissipation is considered responsible for the high frequency fluctuations of not only the axial and in plane integral loads discussed above but also the single blade loads which will be discussed in section 5 2 fig 25 shows the vortical structure colored with velocity magnitude at t 0 753t e left and t 1 223t e right respectively for l d 0 5 0 75 and 1 0 for l d 0 5 0 75 at t 0 753t e obvious free surface deformation and vortex structure destruction is observed due to the direct interactions between the propeller vortex system and the free surface for l d 0 75 at t 0 753t e tip vortices are the first to engage in direct interactions with the free surface in the near wake which start at around 0 5d downstream from this point downstream the free surface effect as a strong external disturbance significantly facilitates the breakdown of the entire vortex system and accelerates the merging process of the tip hub and trailing vortices into a distorted vortex tube the breakdown and merging of vortices have been observed in numerous studies of propeller vortical structure at high loadings such as baek et al 2015 and felli et al 2008 but mostly due to the internal instabilities e g interactions among neighboring tip vortices back to fig 25 for l d 0 5 at t 0 753t e the entire vortex system engages in direct interaction with the free surface which makes the free surface deformation and vortex destruction all the more drastic the seriously destructed and distorted vortex system explains the high frequency thrust fluctuation in the interval of t 0 5t e 0 9t e in contrast at t 1 223t e with a downward wake inclination the propeller surface interactions are obviously weakened for l d 0 5 at t 1 223t e no vortex structure destruction or obvious ventilation can be observed the tip trailing and hub vortices remain stable and distinguished until around 2d downstream and later merge into a large vortex tube also a large free surface vortex with low velocity is formed around 1d downstream which is due to the induced velocities generated by the tip vortices in the upper portion of the wake for l d 0 75 at t 1 223t e the vortex system remains rather stable in the entire wake the low velocity area is still observed at the free surface but no free surface vortex is formed for l d 1 0 with an absent direct interaction with the free surface the propeller vortex system remains stable in the near wake even at t 0 753t e the free surface receives very limited effects by the rotating propeller with only a small free surface vortex formed near the blade tip and a low velocity area at the free surface due to tip vortex induced velocities at t 1 223t e no discernible free surface deformation exists indicating that the free surface effect is negligible the enhanced propeller surface interactions can also be described with the transverse vorticity component ω y in the y 0 plane as shown in fig 26 for l d 0 75 corresponding to the bottom row of fig 24 and the middle row of fig 25 at t 0 753t e with enhanced propeller surface interactions the tip vortices on the leeward side are destructed in the near wake around 0 5d downstream and dissipated into the free surface in the far wake along with the trailing vortices although the first tip vortex core in the nearest wake is not part of said destruction and dissipation its strength is obviously smaller than the corresponding one at t 1 223t e at t 1 223t e the entire vortex system is rather stable without direct interaction with the free surface the tip trailing and hub vortices on both windward and leeward sides are rather distinguished in general through both simulation and experiment we have identified the enhanced propeller surface interactions and consequent high frequency fluctuation of the integral loads due to an upward wake inclination as the periodically emerging propeller approaches the wave crest from wave trough cfd results further indicated that this enhanced propeller surface interaction causes destruction and dissipation of propeller vortex system which explains the high frequency fluctuations its effect on the dynamic and instantaneous single blade loads will be discussed in following sections 5 2 single blade load variation in different time intervals as a discussion of the axial single blade load variations fig 27 a c present the variation of k tx and 10k qx on a single blade with time and azimuthal positions respectively for l d 0 5 top 0 75 middle and 1 0 bottom in two time intervals selected near t 0 753t e t 0 641t e 0 861t e left and t 1 223t e t 1 109t e 1 329t e right lasting for two revolutions some observations can be first made regarding the variation of k tx and 10k qx on a single blade at l d 0 5 fig 27 a first in the interval t 0 641t e 0 861t e left the blade azimuthal positions corresponding to the minimum k tx and 10k qx are around 0 t 0 641t e 360 t 0 751t e and 720 t 0 861t e i e closest to the free surface which is inconsistent with the inflow analysis results in chapter 4 this is because the upper blade 0 is inevitably subjected to serious ventilation and out of water effect fig 24 upper left at such a low submergence with an enhanced propeller surface interaction second in the interval t 0 641t e 0 861t e aside from the high frequency thrust and torque fluctuations abrupt rises of k tx and 10k qx appear in the azimuthal position range of 230 290 t 0 71t e 0 73t e and 670 690 t 0 845t e 0 85t e which is probably associated with the transient forces from a blade water impact i e during the water exit phase described by califano 2010 a similar observation was made by olofsson 1996 in his experimental investigation on the transient loads of a near surface single propeller blade i e an abrupt increase of thrust and torque appears as the blade impacts the water in addition for the first abrupt rise of k tx and 10k qx its corresponding azimuthal position range 230 290 and amplitude are obviously larger than the second one representing a more drastic blade water impact this is due to an increasing submergence as the wave propagates third in the interval t 0 641t e 0 861t e in certain ranges of time and azimuthal positions k tx and 10k qx present a relatively smooth variation trend almost consistent with that for larger submergences indicating a secondary free surface effect in the range of 100 230 t 0 675t e 0 71t e and 460 580 t 0 785t e 0 82t e k tx and 10k qx experience a similar smooth decrease as in the case of l d 0 75 fig 27 b and l d 1 0 fig 27 c these two intervals correspond to the in water phase as described by califano 2010 which indicates that single blade loads currently receive a relatively weak free surface effect compared to the water exit phase where the transient impact forces occur fourth in the interval t 1 109t e 1 329t e right the overall smooth variation of k t and 10k q along with large amplitude rises and drops indicate a generally weakened propeller surface interaction but still obvious for azimuthal positions close to the free surface specifically the second maximum k tx and 10k qx on the curve near 640 t 1 31t e experiences an abrupt rise making it obviously larger than the second maximum k tx and 10k qx in the same interval for l d 0 75 and 1 0 see fig 27 b and c this abrupt rise also probably results from a blade water impact as the propeller approaches the wave trough furthermore while the azimuthal position of the first minimum k tx and 10k qx is consistent with l d 0 75 and 1 0 near 45 t 1 123t e the azimuthal positions of the second and third minimum k tx and 10k qx experience an obvious shift to respectively 370 t 1 22t e and 720 t 1 329t e and the third minimum k tx and 10k qx is reduced to nearly zero this indicates an increasingly intense free surface effect for the upper blade as the propeller approaches the wave trough next we discuss the single blade load variation for l d 0 75 fig 27 b and l d 1 0 fig 27 c in which cases the free surface effect is now secondary or negligible and the unsteady and non uniform oblique flow effect is dominant first for both submergence depths in both time intervals with less intense propeller surface interactions compared to that for l d 0 5 k tx and 10k qx almost follow a smooth variation trend that is roughly consistent with the inflow analysis results however for l d 0 75 in the interval of t 0 641t e 0 861t e there s an exception in the azimuthal position range of 0 90 t 0 641t e 0 669t e fig 27 b left due to free surface effect in which k tx and 10k qx experience a more obvious increase from a low value at 0 with a hint of high frequency fluctuation this high frequency fluctuation of k tx and 10k qx results from the enhanced propeller surface interactions the low k tx and 10k qx at 0 from a possible blade tip emergence second in both intervals other than the above mentioned range in the last paragraph one may notice a slightly larger load variation magnitude for l d 0 75 than l d 1 0 this is due to the decreased variation magnitude of wave orbital velocity at a deeper submergence the third aspect requires special attention according to the inflow analysis in chapter 4 at t 0 75t e the maximum and minimum load respectively correspond to the azimuthal position of 90 and 270 at t 1 25t e contrarily it is 270 and 90 that correspond to the maximum and minimum load however in practice there is a shift of the azimuthal position corresponding to the maximum and minimum load take l d 1 0 fig 27 c as an example in which case the free surface effect is very limited in the interval t 0 641t e 0 861t e there s a slight shift of the first maximum and first minimum k tx and 10k qx from the azimuthal position of 90 to around 80 from 270 to around 280 although the second maximum k tx and 10k qx remains very close to 450 there is a slight shift of the second minimum k tx and 10k qx from 630 to around 640 comparatively in the interval t 1 109t e 1 329t e there is a more obvious shift of the two maximum and two minimum values of k tx and 10k qx from 270 to around 290 from 90 to 50 and from 630 to around 655 from 450 to 425 in our opinion there are two possible causes with coupled effects for this slight shift one is the self induction effect that would further amplify the non uniformity of load distribution on the propeller disk which has been qualitatively discussed in section 3 and was thoroughly investigated by dubbioso 2013 the more important one is the spatial non uniformity of the inflow velocity or more specifically the difference in the vertical component of inflow velocity on the propeller disk as for the self induction effect on the y 0 plane at t 0 75t e see fig 9 a due to the down wash up wash velocity on the upper portion lower portion of the propeller disk the instantaneous load decreases on the upper portion but increases on the lower portion at t 1 25t e fig 9 b contrarily the instantaneous load increases on the upper portion but decreases on the lower portion consequently assuming that only the self induction effect is considered at t 0 75t e the maximum minimum load on the propeller disk will experience a shift from 90 towards 180 from 270 towards 360 at t 1 25t e on the contrary the maximum minimum load will experience a shift from 270 towards 360 from 90 towards 180 however according to fig 27 c the maximum minimum load shift is of rather complicated pattern and obviously not totally in accordance with the above description a reminder that the spatial non uniformity of the inflow velocity may be the dominant cause which can be illustrated with fig 10 left side in section 3 at t 0 75t e fig 10 a as the azimuthal position increases from 0 to 180 with an increasing submergence on the propeller disk the upward pointing vertical component of inflow velocity yellow arrows decreases with the decrease of wave orbital velocity indicating that u circumferential and consequently α neglecting the minor difference in the axial component of inflow velocity at different submergences may hit their maximum slightly before the azimuthal position reaches 90 fig 10 a left side hence the maximum load may experience a slight shift from 90 towards 0 accordingly the minimum u circumferential and α may appear at an azimuthal position slightly larger than 270 causing the minimum load to shift from 270 towards 360 analogously at t 1 25t e fig 10 b the decreasing downward pointing vertical component of inflow velocity yellow arrows with increasing submergence indicates that the minimum and maximum u circumferential and α may appear at an azimuthal position smaller than 90 larger than 270 causing a shift of the minimum and maximum load from 90 towards 0 from 270 towards 360 apparently the spatial non uniformity of inflow velocity is the dominant cause for the shift of maximum and minimum load because the above explanation is totally consistent with fig 27 c with the above description let s come back to fig 27 c first in the interval t 0 641t e 0 861t e on one hand the first and second minimum k tx and 10k qx experience a slight shift respectively to 280 and 640 resulting from the inflow non uniformity effect or the synergy of the self induction effect and inflow non uniformity on the other hand as for the shift of the maximum load there exists a contradictory effect between the self induction effect from 90 towards 180 and inflow non uniformity effect from 90 towards 0 as discussed in the above paragraphs although the first maximum k tx and 10k qx shift slightly towards 0 the second maximum does not experience any obvious shift which probably results from an enhanced self induction effect near t 0 75t e with a maximum wake inclination second in the interval t 1 109t e 1 329t e the maximum and minimum k tx and 10k qx experience a shift that can be explained with solely the effect of inflow non uniformity the self induction effect whether contradictory or synergetic is not obvious it s safe to say that although the self induction effect of a propeller in oblique flow would contribute to an even more non uniform load distribution on the propeller disk it is not obvious on the single blade variations of a propeller in regular waves even at a sufficiently large submergence depth this could be associated with the unsteady and non uniform adjacent flow field in regular waves therefore the self induction effect will not be considered in the following sections as a supplement for the axial single blade load discussions above we herein offer a brief observation of the in plane single blade load dynamic behaviors at variant l d 0 5 0 75 and 1 0 in both intervals as shown in fig 28 a k ty b k tz for brevity only the in plane forces are discussed the moments are not included considering the similar dynamic behaviors generally speaking the effect of submergence depth on the variation trend of single blade k ty and k tz is basically similar to that of k tx and 10k qx as thoroughly discussed with fig 27 specifically at l d 1 0 and 0 75 in both intervals green and red dotted curves k ty and k tz both show an approximately sinusoidal variation trend with slight changes of the maximum and minimum values due to the unsteadiness and non uniformity of inflow this observation along with fig 27 b and c indicates a minor or even negligible free surface effect on both the axial and in plane single blade loads although an exception is observed at l d 0 75 in the range of 0 50 t 0 641t e 0 66t e where the maximum k ty and k tz is lowered to some extent with respect to l d 1 0 in the same range this phenomenon similar to the one observed with fig 27 b left side results from the enhanced propeller surface interactions with an upward inclined wake and from a possible blade tip emergence due to a low l d ins around 0 55 according to fig 19 d at l d 0 5 with the decisive free surface effect the single blade k ty and k tz show obvious difference than at l d 1 0 and 0 75 especially in the azimuthal position range where the blade is interacting with or even emerging from the free surface for example in the interval t 1 109t e 1 329t e right the maximum single blade k ty and k tz is relatively lower than at l d 1 0 and 0 75 in the azimuthal position range of approximately 360 420 t 1 219t e 1 35t e which corresponds to the out of water phase as described by califano 2010 subsequently the lowering of the maximum in plane loads in the next revolution appears even earlier at the azimuthal position of approximately 675 t 1 315t e corresponding to the water exit phase this is because as the wave propagates the propeller is approaching the wave trough hence spends an even larger portion of revolution interacting with the free surface in the interval t 0 641t e 0 861t e left the lowering of the maximum in plane loads is observed to correspond to an even larger azimuthal position range e g 320 450 t 0 74t e 0 779t e compared to the interval t 1 109t e 1 329t e right also one may observe a hint of high frequency components in both the k ty and k tz time series these phenomena are attributed to the enhanced propeller surface interactions 5 3 instantaneous thrust and torque at different azimuthal positions fig 29 a c shows the instantaneous k tx and 10k qx generated by the four blades at different azimuthal positions of 0 90 180 and 270 at two instants t 0 753t e left and t 1 223t e right first for l d 0 5 fig 29 a the instantaneous thrust and torque on each blade is obviously inconsistent with the inflow analysis results at certain azimuthal positions for example at t 0 753t e and t 1 223t e the instantaneous thrust and torque on the upper blade 0 at t 0 753t e k tx 0 0136 10k qx 0 02198 at t 1 223t e k tx 0 03262 10k qx 0 04842 is obviously lower than the corresponding one for l d 0 75 at t 0 753t e k tx 0 03949 10k qx 0 05731 at t 1 223t e k tx 0 04801 10k qx 0 06609 and 1 0 at t 0 753t e k tx 0 04518 10k qx 0 06317 at t 1 223t e k tx 0 04892 10k qx 0 06703 this is due to the emergence of the blade tip also at t 0 753t e due to the impact forces the instantaneous loads on the portside blade 270 k tx 0 04662 10k qx 0 05933 is obviously larger than the corresponding one for l d 0 75 k tx 0 03199 10k qx 0 04532 and 1 0 k tx 0 03553 10k qx 0 04921 other than these azimuthal positions the instantaneous loads on the blades at 90 180 at t 0 753t e and 90 180 and 270 at t 1 223t e have similar trends to that for larger submergences indicating a less intense free surface effect on said blades in addition the instantaneous loads on the upper blade 0 at t 0 753t e k tx 0 0136 10k qx 0 02198 is obviously lower than at t 1 223t e k tx 0 03262 10k qx 0 04842 due to the emergence of the upper blade consequently due to the hysteresis effect the instantaneous loads on the lower blade 180 k tx 0 04123 10k qx 0 05863 at t 0 753t e is also lower than at t 1 223t e k tx 0 04957 10k qx 0 06718 second for l d 0 75 fig 29 b the magnitudes of the instantaneous loads on each blade are basically similar to those for l d 1 0 fig 29 c indicating a secondary free surface effect to the oblique flow effect although at t 0 753t e an obviously lower instantaneous k tx 0 03949 and 10k qx 0 05731 appears for the upper blade with respect to l d 1 0 k t 0 04518 10k q 0 06317 at said instant due to an enhanced propeller surface interaction third at l d 1 0 fig 29 c there is some difference between the instantaneous k tx and 10k qx generated by the upper blade and the lower blade which is less obvious at t 1 223t e than at t 0 753t e specifically at t 0 753t e k tx and 10k qx on the upper blade are obviously lower than on the lower blade k tx 0 04518 0 04629 10k qx 0 06317 0 06445 at t 1 223t e the differences of k tx and 10k qx between the upper and lower blades become less obvious k tx 0 04892 0 04949 10k qx 0 06703 0 06718 in our opinion it is the minor but non negligible free surface effect that results in this difference at t 0 753t e the downstream axial velocity in the upper portion of the wake is slightly reduced due to the enhanced propeller surface interaction and is consequently slightly lower than that in the lower portion fig 33 lower left a similar observation was made by paik 2008 that the downstream axial velocity is reduced if the propeller is moved closer to the free surface the lower downstream axial velocity in the upper wake indicates a lower instantaneous thrust generated by the upper blade at t 1 223t e because of the almost absent free surface effect the downstream axial velocity in the upper wake is barely reduced hence of similar magnitude as that in the lower wake fig 33 lower right indicating that the difference is very minor between the instantaneous thrust and torque generated by the upper and lower blades see fig 31 finally for l d 1 0 fig 29 c a lower instantaneous k tx and 10k qx is observed on the upper and lower blades at t 0 753t e than at t 1 223t e k tx 0 04518 0 04892 at 0 0 04629 0 04949 at 180 10k qx 0 06317 0 06703 at 0 0 06445 0 06718 at 180 one reason is at t 0 753t e due to the enhanced propeller surface interaction the minor free surface effect alters the pressure distribution and causes thrust loss on the upper blade which also lowers the instantaneous thrust on the lower blade due to hysteresis effect the other may be a larger instantaneous upstream axial velocity at t 0 753t e than t 1 223t e as can be observed in figs 32 and 33 which results in a larger instantaneous axial inflow velocity and a smaller instantaneous k tx and 10k qx 5 4 pressure distribution and wake characteristics the instantaneous static pressure contours on pressure and suction sides are shown in fig 30 t 0 753t e and 31 1 223t e first for l d 0 5 left the enhanced propeller surface interaction at t 0 753t e is clearly reflected on the scattered pressure distribution of weak intensity on the upper blade indicating low and fluctuating thrust and torque on said blade fig 27 a and 29 a left this chaotic pressure distribution also results in a less fully developed pressure distribution and lower instantaneous thrust and torque on the lower blade due to the hysteresis effect compared to t 1 223t e on the same blade as discussed with fig 29 a also on the portside blade due to the blade water impact obvious high pressure and high suction areas of strong intensity are respectively formed on the leading edge of the pressure and suction side near mid span which explains the abrupt increase in the instantaneous thrust and torque near the azimuthal position of 270 fig 27 a and 29 a left side second for l d 0 75 middle and 1 0 right the instantaneous blade load distribution is basically consistent with the inflow analysis specifically at t 0 753t e the pressure and suction intensity on the starboard blade is obviously larger than on the port side indicating a larger instantaneous thrust on the starboard blade see fig 29 b and c left conversely at t 1 223t e the portside blade has the larger pressure and suction intensity hence a larger instantaneous thrust also for l d 1 0 a weaker pressure intensity is observed on the pressure and suction sides of the upper and lower blades at t 0 753t e than at t 1 223t e indicating a lower instantaneous k t and 10k q on the upper and lower blades at t 0 753t e than at t 1 223t e the reason as discussed with fig 29 c is the minor free surface effect at t 0 753t e and a larger instantaneous axial inflow velocity at t 0 753t e the instantaneous downstream axial velocity contours normalized by v a on the z 0 plane is shown in fig 32 in which the positive y direction portside 270 points upward first at t 0 753t e due to the enhanced propeller surface interactions the propeller wake experiences even more obvious contraction towards the propeller axis as l d decreases from 1 0 to 0 5 the propeller wake contraction has been studied in many researches e g baek et al 2015 regarding propeller wake characteristics without considering the free surface which similar to vortex breakdown and merging is considered as related to the inherent wake instability at high loadings in the present simulations for l d 0 5 and 0 75 the more obvious wake contraction mainly results from the external disturbance of the free surface that destructs and dissipates the propeller vortex system for l d 1 0 with very limited free surface effect the less obvious wake contraction is attributed mainly to the internal wake instabilities aside from the contraction with decreasing l d comes more chaotic distortion of the vortex system the starboard lower and portside portion upper of the wake are merged together in the far wake for l d 0 75 and then completely distorted for l d 0 5 despite the contraction and distortion at l d 0 5 and 0 75 the oblique flow effect still manifests in the fact that the starboard portion of the wake has the larger downstream velocity magnitude even for l d 0 5 with completely distorted wake also for l d 0 5 an upstream high velocity area with negative magnitude is formed near the portside blade which represents the blade water impact that causes abrupt thrust rise on said blade as discussed with fig 27 a and 29 a at t 1 223t e without direct interactions with the free surface the propeller wake remains relatively stable for all three submergences with a larger induced velocity magnitude in the portside portion of the wake than in the starboard portion the wake contraction still exists with a small slope in the near wake but ceases in the far wake most likely due to the inherent instability of the wake itself in addition one may notice a larger downstream axial velocity at t 0 753t e than at t 1 223t e also see fig 33 due to a larger upstream axial velocity near the propeller disk at t 0 753t e which is related to the wave orbital velocity distribution fig 33 offers the instantaneous downstream axial velocity contours normalized by v a on the y 0 plane for l d 0 75 and 1 0 from which we can make two observations first at t 0 753t e for both submergences the axial velocity magnitude in the lower portion near 180 is slightly larger than that in the upper portion near 0 of the wake this results from the free surface effect so that the downstream axial velocity magnitude in the upper wake is reduced with respect to the lower wake which explains the lower instantaneous thrust produced by the upper blade than the lower blade for l d 0 75 and 1 0 as can be observed in fig 29 b and c left side second at t 1 223t e for both submergences there is no obvious difference in the axial velocity magnitude between the lower and upper portion of the wake suggesting a very limited difference in the instantaneous thrust produced by the upper and lower blades as confirmed by fig 29 b and c right side this phenomenon also verifies the conclusion section 5 2 that the self induction effect on the single blade load non uniformity is unobvious in the present simulations or on a larger scale for a propeller in regular waves 6 concluding remarks for an in depth view of ventilation and load fluctuation of propeller in waves this paper presents a rans investigation on open propeller dynamic loads in regular head waves at variant submergence depths from the perspective of the coupled oblique flow and free surface effect as an inherent feature of propagating regular waves numerical methods are first proven reliable in dealing with propeller surface piercing conditions through cfd v v on a test case in calm water as well as further validation on a test case in regular head waves in detail discussions are made mainly focusing on the dynamic behaviors of thrust and torque including the integral load variations in the entire period of encounter single blade load variations in different time intervals as well as instantaneous loads at different azimuthal positions and instants with the aid of instantaneous flow visualization short discussions are also offered as a supplement regarding the in plane integral and single blade load dynamic behaviors conclusions are as follows first via both numerical simulation and model experiment we have identified the enhanced propeller surface interactions due to an upward wake inclination referring to a direct interaction between the propeller vortex system and the free surface as well as the consequent high frequency fluctuation of the axial and in plane integral loads this enhanced propeller surface interaction happens for a periodically emerging propeller approaching the wave crest from wave trough which according to numerical results exerts various negative influences on propeller performance e g destruction and dissipation of the propeller vortex system wake contraction and distortion chaotic pressure distribution on propeller blades as well as high frequency fluctuation of the single blade thrust torque and in plane loads second for very small submergence depths especially when the enhanced propeller surface interactions occur the free surface effect is the dominant factor on the single blade thrust torque and in plane loads and instantaneous thrust and torque at different azimuthal positions the emerging upper blade produces the minimum thrust and torque resulting in a partially developed pressure distribution on the lower blade due to hysteresis effect also the thrust and torque generated by the portside blade i e water exit phase will experience an abrupt rise due to a drastic impact with the free surface on the contrary the lower blade and the starboard side blade receive a relatively less intense free surface effect third for larger submergence depths e g fully submerged condition with secondary or eliminated free surface effect single blade thrust torque and in plane loads and instantaneous thrust torque at different azimuthal positions are basically dominated by the unsteady and non uniform oblique flow environment with possible exceptions of the blade close to the free surface as a result the axial load distribution on the propeller disk is concentrated on the port side as the propeller approaches the wave trough from wave crest but on the starboard side as the propeller approaches the wave crest from wave trough the shift of the maximum and minimum thrust and torque from the exact port and starboard position results from the inflow velocity non uniformity while the difference between the instantaneous loads on the upper and lower blades is due to the minor but non negligible free surface effect also the self induction effect in oblique flow which would further amplify the non uniformity of the load distribution on the propeller disk is found to be unobvious on the single blade thrust and torque both dynamic and instantaneous of a propeller working in regular waves which is attributed to the unsteady and non uniform inflow environment credit authorship contribution statement wencan zhang investigation formal analysis writing original draft writing review editing ning ma writing review editing resources supervision xiechong gu writing review editing peiyuan feng writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this research is supported by the china ministry of education key research project kship ii project knowledge based ship design hyper integrated platform no gkzy010004 and by the national natural science foundation of china grant numbers 51709240 
20614,this paper presents an automatic size optimization framework for the typical internal turret of fpso for optimization preparation a point set based modeling method is proposed to offer finite element fe models of outer shell for hydrodynamic load calculation the fe model of outer shell is built rapidly by establishing mesh through point set which are extracted by intersecting three dimension 3d geometric surface of hull with orthogonal plane groups for size optimization an integrated optimization platform on isight coupled with fe analysis based on msc patran nastran is established the radial basis function rbf models are applied to approximate the yield stresses of the structure without computationally expensive fe analysis during the optimization process a typical turret area of fpso has been taken as an example to show the whole process of size optimization including the application of point set based fe modeling method on hydrodynamic load calculation and the process of searching optimal thickness distribution of the turret that minimizes the weight under actual engineering constraints the optimization result shows the feasibility and rapidity of point set based fe modeling method and the efficiency of the optimization framework keywords fe modeling point set out shell turret area fpso integrated optimization 1 introduction fpso is an important marine engineering equipment for offshore oil and gas exploitation at present fpso has been widely used in offshore oil and gas exploitation all over the world in recent years with the rapid development of the global economy the demand for energy is increasing in this context fpso has also been developed rapidly fpso mainly includes hull part mooring system oil and gas production equipment outgoing system and other parts zhao 2006 the mooring system is the key structure of fpso for the fpso mooring system operating in deep water due to the bad sea conditions turret single point mooring is often adopted wu 2012 under the action of wind wave and current the fpso can rotate around the inner bearing of the turret according to the structure characteristic of the turret and its installation position on fpso the turret can be divided into two types internal turret and external turret cao et al 2013 this paper mainly studies the inner turret in order to make the hull have good wind vane effect the turret is usually located in the bow of fpso hull fpso needs to be moored in the scheduled sea area for a long time it must be able to withstand the once in a century severe sea conditions the local structure of fpso bow turret is the area where mooring forces concentrate on the hull the failure of the connection will lead to the failure of the whole mooring system therefore it is of great significance to optimize the local structure strength of the hull at the turret a few researcher have put forward the optimization for various offshore floating structures including semi submersibles and tension leg platform tlp etc zhang et al 2018 park et al 2015 venzon et al 2013 rustad et al 2008 lee et al 2007 clauss et al 1996 akagi et al 1984 and the hyrodynamic performance seakeeping performance stability fatigue life etc are considered while the structural optimization for fpso is few in the context of this paper structural optimization refers to the process of obtaining a lower structural weight of the turret area while keeping maximum equivalent stresses below permissible stresses as defined by classification societies as the first important step of the optimization procedure 3d modeling of the structure need to be performed accurately in order to obtain the proper mass and inertia properties of the structure for subsequent wave load calculation and finite element fe analysis traditionally the fe model is built manually according to calculation requirements provided by classification societies which is time consuming there have been a few researchers focus on automatic fe modeling of semi submersible structures uzunoglu et al 2018 proposed a numerical 3d modeling method which integrates radius based approach and face based approach to represent a semisubmersible floating wind turbine platform and a ship park et al 2015 applied the bezier b spline method for panel generation of a semi submersible fpu while there are few researches on 3d modeling of fpso compared with the semi submersible structures the outer shell of the fpso is more complex because of the complex curvature changes on fore and after part as a result it takes relatively long time to build the fe model especially the outer shell part the presented research investigate fe fast modeling of outer shell based on point set and automatic optimization of turret structure of fpso taking a fpso with internal turret as the research object the fe model of outer shell is established rapidly and the hydrodynamic loads which are applied on turret structure fe model for analysis is obtained rapidly besides an integrated platform for the automatic optimization of the internal turret structure is built to realize the automatic optimization of the internal turret structure the modeling efficiency is improved and the stress distribution on the turret is optimized 2 point set based modeling of outer shell recently there is some difficulty in the translation of a geometric model into a fe model mainly because the two models differ in their graphics primitive the geometric model relies on non uniform rational b splines nurbs while fe model on meshes hence the fe model is traditionaly built and modified manually to guarantee the accuracy of the model there have been some methods dealing with the relatively regular geometry such as cylinders cones triangular prism and so on but the outshell of a vessel is more complex especially in fore and after part in order to bridge the gap the direct fe modeling method based on point set is proposed through an integrated application of the software catia and ansys it has to be mentioned that the method is also suitable for other fe modeling softwares such as msc patran nastran the key thought of the method is to establish the thin shell element directly with nodes and the node information is obtained through the point set which are extracted from 3d geometric model to start with the modeling the mesh characteristics of the outshell including element type element size etc are analyzed when setting up a 3d fe model all main structural components of the vessel including outshell plating decks transverse and longitudinal bulkheads web frames and so on are considered to determine the primary stresses and deformations in hull under overall loads all these major structural components are idealised by plane stress elements in the model payer and schellin 2013 in particular the shell element called shell63 with ansys is applied to build the major structural components this kind of element can be used to model membranes plates and thick or thin shell which is suitable for vessel outshell in addition as quadrilateral elements are preferred over the triangular elements triangular elements are used only for mesh transition when quadrilateral elements are impractical it needs to be mentioned that the fe analysis model is different in each level of the analysis for wave load analysis the inner structure is not considered hence only the outer shell is modeled without considering the connection between the outer shell and the inner structure for yield strength analysis the internal structure is regarded when modeling the outer shell the element continuous transition should be assured at the connection of the internal structure and the outer shell the different outer shell fe models need to be generated for different analysis levels the modeling of fore part for wave load analysis is taken as an example the structure modeling method considering internal structures was illustrated in lin et al 2019 shown as fig 1 the procedure of the modeling method mainly comprises four steps 1 3d geometric modeling the three dimension 3d geometric model is built based on conventional 2d lines plan with the aid of the catia modeling environment the transverse sections capturing shape transition deckline and the bowprofile are defined as the control curves fig 2 by sweeping the control curves along a computed spine the multi section surfaces are generated fig 3 ensuring tangent plane geometric continuity g1 ginnis et al 2011 2 point set generation considering the calculation requirement the frame space the connection positions of the internal structures e g platforms plate longitudinal three sets of orthogonal planes are defined then three sets of lines are obtained by intersecting the surfaces with those planes fig 4 the intersection points of the lines are extracted as point set fig 5 whose locations can be extracted easily at once 3 data transformation since the acquired point sets are not suitable for a direct use as mesh the data transformation is needed all points in the point set data are sorted and numbered according to their locations x y and z coordinates so that each point can be recognized by the following meshing process fig 6 shows the distribution of the numberd point set 4 fe surface generation the point set is transformed into nodes with the same ids in ansys the shell63 elements are built directly by nodes fig 7 shows the fe modeling result of the fore surface 3 application of point set based modeling on hydrodynamic load calculation the hyrodynamic analysis is performed to determine the critical design wave load cases for structural analysis a linear frequency domain strip theory is applied to calculate vessel accelerations and wave induced pressures for the vessel waves of different lengths heights and directions are considered to cover all expected maximum wave load cases shigunov et al 2015 then the wave induced hydrodynamic pressures are applied to the wetted outer shell in this paper the panel method based ansys aqwa is applied for prediction of wave pressures in frequency domain ansys aqwa has been proved as a suitable tool for the investigation of the effects of wave on marine structures including fpsos ships etc firstly the hydrodynamic surface model is directly built by the modeling method described in section 2 secondly the vessel accelerations and wave induced pressures are calculated with aqwa line module finally the wave induced pressure is generated as structural loading and mapped on the structural surface model with aqwa wave module in some cases the structural model and hydrodynamic model are identical however it is not required and more commonly the mesh of the structural model is more refined than the hydrodynamic model the process to generate the wave loads is shown in fig 8 4 turret structure optimization 4 1 the definition of the turret structure optimization problem the turret structure optimization starts with some setup works including the selection of design variables and the formulation of objective function as well as constraints in actual design the form of turret structure fig 9 is basically the same a conical buoy mating cone with vertical radial web frames and platforms inside the turret system cylinder hence the main difference of the structure is the structure size including plate thickness and stiffer specifications in this paper plate thickness is chosen as the design variables structural weight of the turret area is taken as the objective function the yield strength of the structure is performed to provide the maximum stresses among all the conditions and load cases which have been selected for evaluation which are seen as the constraints through the optimization algorithm different sets of design variables are altered corresponding yield strength analysis are repeated constraints are checked in addition in order to improve optimization efficiency the surrogate model is applied to approximate the yield strength of the structure the more detailed discussion of the different part of the optimization procedure are shown in the following subsections 4 2 yield strength analysis of turret area 4 2 1 fe model of turret area a 3d fe model for turret area is extended over in length of three tanks fig 10 including fore peak tank turret area and no 1 cargo oil tank the modeling procedure and boundary condition follows the bureau veritas rules bureau veritas 2016a b the outer shell is generated according to section 3 plane stress elements are used to idealise all primary structure components including deck bulkheads walls girders etc the truss elements are utilized for deck beams longitudinals and stiffeners the standard size of mesh is based on the spacing of ordinary stiffeners the whole model is fixed at the aftermost bulkhead detailed information of the fe model for structural analysis can be found in lin et al 2019 4 2 2 loading conditions and load cases overall two static loading conditions are considered 1 full loaded condition with maximum draft 2 ballast loaded condition with minium draft loads applied to the fe model for each load case are sorted into a linear combination of the following load groups payer and schellin 2013 the hull girder bending moment and motion induced acceleration static weight loads external hydrostatic pressure hydrodynamic sea pressure extracted from hydrodynamic analysis internal pressure due to liquid in the tanks mooring loads in particular the mooring loads acting on buoy vessel interface play a dominant role in the analysis of turret area hence the mooring loads in the analysis are conservatively combined the extreme mooring loads including r h v forces from three directions are taken into account the r and h forces are applied with five directions 0 45 90 135 180 to the longitudinal axis of the vessel and the reaction forces in way of the bearings are distributed according to the bureau veritas rules bureau 2016a b i e over a 120 angle with a cosine distribution fig 11 the v force is applied with vertical direction on the cone averagely detailed information of the loading condition can be found in lin et al 2019 4 2 3 yield strength analysis result the calculation is performed for 10 load cases considering the two loading conditions and mooring load directions stated in section 4 2 2 strength results for turret area are evaluated with regard to permissible overall stresses in addition the stress contour plot helps to present the stress distribution identifying admissible stresses fig 12 as the permissible stresses varies with steel grades the structure of different parts being made of different steel grades are checked separately maximum von mises stresses of different parts of turret area are extracted from all load cases listed as table 1 4 3 the surrogate model in optimization procedure in order to obtain the strength results the direct fe calculation is performed for each design case searching during the optimization which spends a large amount of computation time the surrogate model is a good alternative which has been widely used in the structural optimization prebeg et al 2014 the main idea of the surrogate model is to utilize the surrogate model which establishes accurate levels of approximate objective or constraint functions over the exploratory design space in this paper the maximum stresses of different parts are approximated as surrogate models to reduce computational costs in the optimization process basically generation of a surrogate model starts with sampling by an appropriate design of experiment then the calculation is executed with original analysis methods and tools a surrogate model type is chosen based on the characteristics of the input variables e g structural sizes and output variables e g structural responses finally the surrogate model is created and validated widely used surrogate models in engineering include response surface method rsm radial based functions rbf kriging and neural networks nn etc prebeg et al 2014 in our study the rbf model is applied which has been proposed for scattered multivariate data interpolation and has been used in structural optimization tornabene et al 2013 wang et al 2006 the response function of rbf model is approximated by using linear combinations of the radially symmetric functions based on euclidean distance or other such metric prebeg et al 2014 4 4 evolutionary optimization algorithm the evolutionary optimization algorithm beyer et al 2002 is proposed as it has been proved well suited for non linear and discontinuous design space the main feature of the evolutionary algorithm is the mutation method by adding a normally distributed random value the designs are mutated the mutation strength is self adaptive and changes during the optimization process 4 5 integrated optimization platform an automatic optimization is proposed through the software isight lai 2012 by integrating msc patran nastran as an analyzer the flowchart of the optimization process is described in fig 13 before the evolutionary algorithm executes some preparations are made 1 a fe model is constructed by msc patran the loading conditions and load cases are also set in the model and a design variable set is determined 2 the rbf models for the maximum stresses of structure at all load cases related with the design variables are constructed to surrogate the strength results of the structure in the optimization the output maximum stresses are obtain by a loop that the fe model is modified and analyzed through msc patran nastran according to the doe results after the preparation the optimization is activated by the evol algorithm passing a trial design variable set to rbf model and fe model the structural weight of structure is extracted as objective function from modified fe model and returned to optimizer the strength results are estimated by rbf models and checked as constraints then the convergence condition is estimated if the condition is satisfied the optimization is terminated while if the condition is not satisfied a new trial design variable set is generated depending on the evol algorithm and a next iteration starts 5 application example in this section a size optimization of a typical internal turret area of fpso is presented as an example to show the efficiency of automatic optimization framework including outer shell fe modeling hyrodynamic load calculation the transformation of wave load from hydrodynamic load calculation into external sea pressure acting on surface of structure model rbf model establishment and integrated optimization 5 1 hydrodynamic load calculation based on point set fe modeling method before the optimization the hydrodynamic load calculations are performed to offer the strength results as fig 14 shows the geometric surface of the fpso is established through catia the point sets are generated according to different requirements of mesh for hydrodynamic analysis the mesh is relatively coarse while for strength analysis the mesh is refined both kinds of mesh are directly built from point set then the hydrodynamic load calculation is performed through ansys awqa to obtain load files for strength analysis it has to be mentioned that the load files can be directly used in patran because of the different code formats in different fea softwares hence the load file transformations are needed however all the surface models in the analysis process are easily obtained by the point set fe modeling method which save time and reduce the number of repetitive tasks compared with the traditional modeling method 5 2 the size optimization of turret area 5 2 1 definition of the optimization case total 16 design variables are selected which are the plate thickness of turret area fig 15 shows the design variables and their original values the lower and upper bounds of the design variables are set as 80 120 of the original design variables the objective function is considered as the structure steel weight of turret area the maximum stresses σ m 1 σ m 2 σ m 3 are checked with regard to permissible stresses according to bv rules 5 2 2 rbf models of maximum stresses the rbf models of maximum stresses are built with 370 samples which are selected by optimal latin hypercube sampling olhs method additional 185 samples are randomly selected for error analysis it takes approximately 7 min in completing each sample simulation on 40 core processors with 32g of ram all the design variables are set as the input variables with the same range as design variables maximum stresses σ m 1 σ m 2 σ m 3 are set as output variables after direct fe analysis of total 555 samples the rbf models are constructed and validated table 2 lists the error analysis results of rbf models showing the good accuracy of the models fig 16 shows the contour graphs of rbf model because of the large amount of data only two design variables are presented in each of the graph while the other variables are fixed with the original value 5 2 3 optimization results and discussion the optimal design solution is obtained after 101 iterations the convergence history of the optimization process is shown in fig 17 and fig 18 wherein the feasible solutions are plotted as blue in the web version the infeasible solutions are plotted as red in the web version the improved solutions during the process are also lined up in green in the web version in fig 17 the optimum results are summarized and compared with the original case in table 3 the weight of the optimum structure reduces 13 16 of original weight all three stress constraint results obtained by rbf models are revaluated using direct fe analysis and the results are shown in table 4 as illustrated in table 4 by comparing the results by rbf models and direct fe analysis the maximum relative error is less than 2 0 which confirms the satisfactory accuracy of the rbf models 6 conclusion this paper explores an integrated optimization platform for size optimization of internal turret area of a fpso for preparation of the optimization a point set based modeling method is proposed to offer fe model of out shell for hydrodynamic load calculation in addition the rbf models of maximum yield stress are established with 370 training samples and 185 error analysis samples to approximate the stresses instead of direct strength analysis which effectively reduces the computational time necessary during the optimization process an application example of the integrated optimization platform is presented with weight reduction of 13 16 the analysis progress and optimization result show the feasibility and reliability of the modeling method analysis method and optimization strategy which are well suited for actual optimization problem of turret area structure our future work will focus on the application of the point set modeling method on shape optimization of vessels in that case the proposed method will make a key role in modifying the outer shell fe model when the shape of vessel hull changes credit authorship contribution statement guan guan conceptualization methodology project administration resources supervision qu yang investigation software data curation visualization validation writing original draft formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the authors would like to express their sincere thanks to institute of ship and marine engineering design dalian university of technology for providing support for the research the authors are grateful to the national natural science foundation of china 51609036 
20614,this paper presents an automatic size optimization framework for the typical internal turret of fpso for optimization preparation a point set based modeling method is proposed to offer finite element fe models of outer shell for hydrodynamic load calculation the fe model of outer shell is built rapidly by establishing mesh through point set which are extracted by intersecting three dimension 3d geometric surface of hull with orthogonal plane groups for size optimization an integrated optimization platform on isight coupled with fe analysis based on msc patran nastran is established the radial basis function rbf models are applied to approximate the yield stresses of the structure without computationally expensive fe analysis during the optimization process a typical turret area of fpso has been taken as an example to show the whole process of size optimization including the application of point set based fe modeling method on hydrodynamic load calculation and the process of searching optimal thickness distribution of the turret that minimizes the weight under actual engineering constraints the optimization result shows the feasibility and rapidity of point set based fe modeling method and the efficiency of the optimization framework keywords fe modeling point set out shell turret area fpso integrated optimization 1 introduction fpso is an important marine engineering equipment for offshore oil and gas exploitation at present fpso has been widely used in offshore oil and gas exploitation all over the world in recent years with the rapid development of the global economy the demand for energy is increasing in this context fpso has also been developed rapidly fpso mainly includes hull part mooring system oil and gas production equipment outgoing system and other parts zhao 2006 the mooring system is the key structure of fpso for the fpso mooring system operating in deep water due to the bad sea conditions turret single point mooring is often adopted wu 2012 under the action of wind wave and current the fpso can rotate around the inner bearing of the turret according to the structure characteristic of the turret and its installation position on fpso the turret can be divided into two types internal turret and external turret cao et al 2013 this paper mainly studies the inner turret in order to make the hull have good wind vane effect the turret is usually located in the bow of fpso hull fpso needs to be moored in the scheduled sea area for a long time it must be able to withstand the once in a century severe sea conditions the local structure of fpso bow turret is the area where mooring forces concentrate on the hull the failure of the connection will lead to the failure of the whole mooring system therefore it is of great significance to optimize the local structure strength of the hull at the turret a few researcher have put forward the optimization for various offshore floating structures including semi submersibles and tension leg platform tlp etc zhang et al 2018 park et al 2015 venzon et al 2013 rustad et al 2008 lee et al 2007 clauss et al 1996 akagi et al 1984 and the hyrodynamic performance seakeeping performance stability fatigue life etc are considered while the structural optimization for fpso is few in the context of this paper structural optimization refers to the process of obtaining a lower structural weight of the turret area while keeping maximum equivalent stresses below permissible stresses as defined by classification societies as the first important step of the optimization procedure 3d modeling of the structure need to be performed accurately in order to obtain the proper mass and inertia properties of the structure for subsequent wave load calculation and finite element fe analysis traditionally the fe model is built manually according to calculation requirements provided by classification societies which is time consuming there have been a few researchers focus on automatic fe modeling of semi submersible structures uzunoglu et al 2018 proposed a numerical 3d modeling method which integrates radius based approach and face based approach to represent a semisubmersible floating wind turbine platform and a ship park et al 2015 applied the bezier b spline method for panel generation of a semi submersible fpu while there are few researches on 3d modeling of fpso compared with the semi submersible structures the outer shell of the fpso is more complex because of the complex curvature changes on fore and after part as a result it takes relatively long time to build the fe model especially the outer shell part the presented research investigate fe fast modeling of outer shell based on point set and automatic optimization of turret structure of fpso taking a fpso with internal turret as the research object the fe model of outer shell is established rapidly and the hydrodynamic loads which are applied on turret structure fe model for analysis is obtained rapidly besides an integrated platform for the automatic optimization of the internal turret structure is built to realize the automatic optimization of the internal turret structure the modeling efficiency is improved and the stress distribution on the turret is optimized 2 point set based modeling of outer shell recently there is some difficulty in the translation of a geometric model into a fe model mainly because the two models differ in their graphics primitive the geometric model relies on non uniform rational b splines nurbs while fe model on meshes hence the fe model is traditionaly built and modified manually to guarantee the accuracy of the model there have been some methods dealing with the relatively regular geometry such as cylinders cones triangular prism and so on but the outshell of a vessel is more complex especially in fore and after part in order to bridge the gap the direct fe modeling method based on point set is proposed through an integrated application of the software catia and ansys it has to be mentioned that the method is also suitable for other fe modeling softwares such as msc patran nastran the key thought of the method is to establish the thin shell element directly with nodes and the node information is obtained through the point set which are extracted from 3d geometric model to start with the modeling the mesh characteristics of the outshell including element type element size etc are analyzed when setting up a 3d fe model all main structural components of the vessel including outshell plating decks transverse and longitudinal bulkheads web frames and so on are considered to determine the primary stresses and deformations in hull under overall loads all these major structural components are idealised by plane stress elements in the model payer and schellin 2013 in particular the shell element called shell63 with ansys is applied to build the major structural components this kind of element can be used to model membranes plates and thick or thin shell which is suitable for vessel outshell in addition as quadrilateral elements are preferred over the triangular elements triangular elements are used only for mesh transition when quadrilateral elements are impractical it needs to be mentioned that the fe analysis model is different in each level of the analysis for wave load analysis the inner structure is not considered hence only the outer shell is modeled without considering the connection between the outer shell and the inner structure for yield strength analysis the internal structure is regarded when modeling the outer shell the element continuous transition should be assured at the connection of the internal structure and the outer shell the different outer shell fe models need to be generated for different analysis levels the modeling of fore part for wave load analysis is taken as an example the structure modeling method considering internal structures was illustrated in lin et al 2019 shown as fig 1 the procedure of the modeling method mainly comprises four steps 1 3d geometric modeling the three dimension 3d geometric model is built based on conventional 2d lines plan with the aid of the catia modeling environment the transverse sections capturing shape transition deckline and the bowprofile are defined as the control curves fig 2 by sweeping the control curves along a computed spine the multi section surfaces are generated fig 3 ensuring tangent plane geometric continuity g1 ginnis et al 2011 2 point set generation considering the calculation requirement the frame space the connection positions of the internal structures e g platforms plate longitudinal three sets of orthogonal planes are defined then three sets of lines are obtained by intersecting the surfaces with those planes fig 4 the intersection points of the lines are extracted as point set fig 5 whose locations can be extracted easily at once 3 data transformation since the acquired point sets are not suitable for a direct use as mesh the data transformation is needed all points in the point set data are sorted and numbered according to their locations x y and z coordinates so that each point can be recognized by the following meshing process fig 6 shows the distribution of the numberd point set 4 fe surface generation the point set is transformed into nodes with the same ids in ansys the shell63 elements are built directly by nodes fig 7 shows the fe modeling result of the fore surface 3 application of point set based modeling on hydrodynamic load calculation the hyrodynamic analysis is performed to determine the critical design wave load cases for structural analysis a linear frequency domain strip theory is applied to calculate vessel accelerations and wave induced pressures for the vessel waves of different lengths heights and directions are considered to cover all expected maximum wave load cases shigunov et al 2015 then the wave induced hydrodynamic pressures are applied to the wetted outer shell in this paper the panel method based ansys aqwa is applied for prediction of wave pressures in frequency domain ansys aqwa has been proved as a suitable tool for the investigation of the effects of wave on marine structures including fpsos ships etc firstly the hydrodynamic surface model is directly built by the modeling method described in section 2 secondly the vessel accelerations and wave induced pressures are calculated with aqwa line module finally the wave induced pressure is generated as structural loading and mapped on the structural surface model with aqwa wave module in some cases the structural model and hydrodynamic model are identical however it is not required and more commonly the mesh of the structural model is more refined than the hydrodynamic model the process to generate the wave loads is shown in fig 8 4 turret structure optimization 4 1 the definition of the turret structure optimization problem the turret structure optimization starts with some setup works including the selection of design variables and the formulation of objective function as well as constraints in actual design the form of turret structure fig 9 is basically the same a conical buoy mating cone with vertical radial web frames and platforms inside the turret system cylinder hence the main difference of the structure is the structure size including plate thickness and stiffer specifications in this paper plate thickness is chosen as the design variables structural weight of the turret area is taken as the objective function the yield strength of the structure is performed to provide the maximum stresses among all the conditions and load cases which have been selected for evaluation which are seen as the constraints through the optimization algorithm different sets of design variables are altered corresponding yield strength analysis are repeated constraints are checked in addition in order to improve optimization efficiency the surrogate model is applied to approximate the yield strength of the structure the more detailed discussion of the different part of the optimization procedure are shown in the following subsections 4 2 yield strength analysis of turret area 4 2 1 fe model of turret area a 3d fe model for turret area is extended over in length of three tanks fig 10 including fore peak tank turret area and no 1 cargo oil tank the modeling procedure and boundary condition follows the bureau veritas rules bureau veritas 2016a b the outer shell is generated according to section 3 plane stress elements are used to idealise all primary structure components including deck bulkheads walls girders etc the truss elements are utilized for deck beams longitudinals and stiffeners the standard size of mesh is based on the spacing of ordinary stiffeners the whole model is fixed at the aftermost bulkhead detailed information of the fe model for structural analysis can be found in lin et al 2019 4 2 2 loading conditions and load cases overall two static loading conditions are considered 1 full loaded condition with maximum draft 2 ballast loaded condition with minium draft loads applied to the fe model for each load case are sorted into a linear combination of the following load groups payer and schellin 2013 the hull girder bending moment and motion induced acceleration static weight loads external hydrostatic pressure hydrodynamic sea pressure extracted from hydrodynamic analysis internal pressure due to liquid in the tanks mooring loads in particular the mooring loads acting on buoy vessel interface play a dominant role in the analysis of turret area hence the mooring loads in the analysis are conservatively combined the extreme mooring loads including r h v forces from three directions are taken into account the r and h forces are applied with five directions 0 45 90 135 180 to the longitudinal axis of the vessel and the reaction forces in way of the bearings are distributed according to the bureau veritas rules bureau 2016a b i e over a 120 angle with a cosine distribution fig 11 the v force is applied with vertical direction on the cone averagely detailed information of the loading condition can be found in lin et al 2019 4 2 3 yield strength analysis result the calculation is performed for 10 load cases considering the two loading conditions and mooring load directions stated in section 4 2 2 strength results for turret area are evaluated with regard to permissible overall stresses in addition the stress contour plot helps to present the stress distribution identifying admissible stresses fig 12 as the permissible stresses varies with steel grades the structure of different parts being made of different steel grades are checked separately maximum von mises stresses of different parts of turret area are extracted from all load cases listed as table 1 4 3 the surrogate model in optimization procedure in order to obtain the strength results the direct fe calculation is performed for each design case searching during the optimization which spends a large amount of computation time the surrogate model is a good alternative which has been widely used in the structural optimization prebeg et al 2014 the main idea of the surrogate model is to utilize the surrogate model which establishes accurate levels of approximate objective or constraint functions over the exploratory design space in this paper the maximum stresses of different parts are approximated as surrogate models to reduce computational costs in the optimization process basically generation of a surrogate model starts with sampling by an appropriate design of experiment then the calculation is executed with original analysis methods and tools a surrogate model type is chosen based on the characteristics of the input variables e g structural sizes and output variables e g structural responses finally the surrogate model is created and validated widely used surrogate models in engineering include response surface method rsm radial based functions rbf kriging and neural networks nn etc prebeg et al 2014 in our study the rbf model is applied which has been proposed for scattered multivariate data interpolation and has been used in structural optimization tornabene et al 2013 wang et al 2006 the response function of rbf model is approximated by using linear combinations of the radially symmetric functions based on euclidean distance or other such metric prebeg et al 2014 4 4 evolutionary optimization algorithm the evolutionary optimization algorithm beyer et al 2002 is proposed as it has been proved well suited for non linear and discontinuous design space the main feature of the evolutionary algorithm is the mutation method by adding a normally distributed random value the designs are mutated the mutation strength is self adaptive and changes during the optimization process 4 5 integrated optimization platform an automatic optimization is proposed through the software isight lai 2012 by integrating msc patran nastran as an analyzer the flowchart of the optimization process is described in fig 13 before the evolutionary algorithm executes some preparations are made 1 a fe model is constructed by msc patran the loading conditions and load cases are also set in the model and a design variable set is determined 2 the rbf models for the maximum stresses of structure at all load cases related with the design variables are constructed to surrogate the strength results of the structure in the optimization the output maximum stresses are obtain by a loop that the fe model is modified and analyzed through msc patran nastran according to the doe results after the preparation the optimization is activated by the evol algorithm passing a trial design variable set to rbf model and fe model the structural weight of structure is extracted as objective function from modified fe model and returned to optimizer the strength results are estimated by rbf models and checked as constraints then the convergence condition is estimated if the condition is satisfied the optimization is terminated while if the condition is not satisfied a new trial design variable set is generated depending on the evol algorithm and a next iteration starts 5 application example in this section a size optimization of a typical internal turret area of fpso is presented as an example to show the efficiency of automatic optimization framework including outer shell fe modeling hyrodynamic load calculation the transformation of wave load from hydrodynamic load calculation into external sea pressure acting on surface of structure model rbf model establishment and integrated optimization 5 1 hydrodynamic load calculation based on point set fe modeling method before the optimization the hydrodynamic load calculations are performed to offer the strength results as fig 14 shows the geometric surface of the fpso is established through catia the point sets are generated according to different requirements of mesh for hydrodynamic analysis the mesh is relatively coarse while for strength analysis the mesh is refined both kinds of mesh are directly built from point set then the hydrodynamic load calculation is performed through ansys awqa to obtain load files for strength analysis it has to be mentioned that the load files can be directly used in patran because of the different code formats in different fea softwares hence the load file transformations are needed however all the surface models in the analysis process are easily obtained by the point set fe modeling method which save time and reduce the number of repetitive tasks compared with the traditional modeling method 5 2 the size optimization of turret area 5 2 1 definition of the optimization case total 16 design variables are selected which are the plate thickness of turret area fig 15 shows the design variables and their original values the lower and upper bounds of the design variables are set as 80 120 of the original design variables the objective function is considered as the structure steel weight of turret area the maximum stresses σ m 1 σ m 2 σ m 3 are checked with regard to permissible stresses according to bv rules 5 2 2 rbf models of maximum stresses the rbf models of maximum stresses are built with 370 samples which are selected by optimal latin hypercube sampling olhs method additional 185 samples are randomly selected for error analysis it takes approximately 7 min in completing each sample simulation on 40 core processors with 32g of ram all the design variables are set as the input variables with the same range as design variables maximum stresses σ m 1 σ m 2 σ m 3 are set as output variables after direct fe analysis of total 555 samples the rbf models are constructed and validated table 2 lists the error analysis results of rbf models showing the good accuracy of the models fig 16 shows the contour graphs of rbf model because of the large amount of data only two design variables are presented in each of the graph while the other variables are fixed with the original value 5 2 3 optimization results and discussion the optimal design solution is obtained after 101 iterations the convergence history of the optimization process is shown in fig 17 and fig 18 wherein the feasible solutions are plotted as blue in the web version the infeasible solutions are plotted as red in the web version the improved solutions during the process are also lined up in green in the web version in fig 17 the optimum results are summarized and compared with the original case in table 3 the weight of the optimum structure reduces 13 16 of original weight all three stress constraint results obtained by rbf models are revaluated using direct fe analysis and the results are shown in table 4 as illustrated in table 4 by comparing the results by rbf models and direct fe analysis the maximum relative error is less than 2 0 which confirms the satisfactory accuracy of the rbf models 6 conclusion this paper explores an integrated optimization platform for size optimization of internal turret area of a fpso for preparation of the optimization a point set based modeling method is proposed to offer fe model of out shell for hydrodynamic load calculation in addition the rbf models of maximum yield stress are established with 370 training samples and 185 error analysis samples to approximate the stresses instead of direct strength analysis which effectively reduces the computational time necessary during the optimization process an application example of the integrated optimization platform is presented with weight reduction of 13 16 the analysis progress and optimization result show the feasibility and reliability of the modeling method analysis method and optimization strategy which are well suited for actual optimization problem of turret area structure our future work will focus on the application of the point set modeling method on shape optimization of vessels in that case the proposed method will make a key role in modifying the outer shell fe model when the shape of vessel hull changes credit authorship contribution statement guan guan conceptualization methodology project administration resources supervision qu yang investigation software data curation visualization validation writing original draft formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the authors would like to express their sincere thanks to institute of ship and marine engineering design dalian university of technology for providing support for the research the authors are grateful to the national natural science foundation of china 51609036 
