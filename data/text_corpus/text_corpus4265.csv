index,text
21325,laboratory experiments and numerical simulation were conducted to study the residual liquefaction mechanism of two layer seabed with upper crust layer under standing waves in this study the buildup process of pore pressure and onset of liquefaction were firstly analyzed furthermore the residual liquefaction mechanism at the nodal section was discussed in addition a parametric study was conducted with the present model to investigate the effects of the soil and wave characteristics to residual liquefaction the results indicate that the liquefaction occurred before the excess pore pressure reached the maximum then the liquefaction advanced downwards to maximal depth different with nodal section the horizontal transporting of pore pressure and the accumulating of plastic volumetric strain induced by cyclic normal stress contribute to the liquefaction at the antinodal section simultaneously the former and latter contribute about 52 6 and 47 4 respectively at the depth of 0 15 m the thinner upper crust layer the smaller k s1 k s2 k s2 1 2 10 6 m s the shorter wave period the higher wave steepness result in a deeper liquefaction depth additionally the wave period and wave steepness had a more significant effect for the upper crust layer than the lower layer at the nodal section but the opposite trend appeared at antinodal section keywords residual liquefaction standing waves two layer seabed accumulated excess pore pressure laboratory experiments and numerical simulation 1 introduction in recent years the response of porous seabed due to gravity waves has received special attention by marine geotechnical engineers related to the stability of offshore structures when a train progressive waves arrive normally at a vertical wall they will be fully reflected from the vertical wall and the reflected waves are superimposed on the incident waves leading to the formation of standing waves system goda 1967 tsai 1995 jeng 1997 the surface of standing wave only oscillates exactly where it is and the waveform doesn t advance in the situation of linear superposition the wave height of the standing wave is twice that of the incident wave enhancing the pressure on seabed soil than incident progressive wave tsai and jeng 1994 standing waves may be produced easily in front of breakwaters and seawalls seabed soil will undergo liquefaction in vicinity of such structures under standing waves when the excess pore pressure equals the effective stresses resulting in the instability of seabed foundation of marine structures the wave induced seabed soil liquefaction can be classified into two kinds of mechanisms according to how the excess pore pressure is developed zen and yamazaki 1990 jeng and zhao 2015 the first mechanism is transient or oscillatory liquefaction which occurs when the seabed soil suffers wave troughs leading a sharp upwardly directed pressure gradient the upward seepage force acting on the soil skeleton reduces the vertical effective stress and when the excess pore pressure is larger than the vertical effective stress transient liquefaction occurs sakai et al 1992 seymour et al 1996 jeng and lee 2001 mory et al 2007 jeng and zhao 2015 the second mechanism is residual or accumulated liquefaction the wave causes the soil skeleton subjected to cyclic shear stress which leading to the rearrangement of soil particles the change of pore volume and the accumulation of excess pore pressure similar to transient liquefaction the residual liquefaction occurs when the accumulated excess pore pressure is greater than the vertical effective stress mcdougal et al 1989 li and jeng 2008 sumer et al 2006 zhu 2013 the work presented in this paper focuses on the mechanism of residual liquefaction under standing waves the amplitude of excess pore pressure induced by standing waves is twice that of incident waves under the case of linear superposition tsai and lee 1995 therefore compared with the incident waves the seabed is prone to suffer residual liquefaction under standing waves sekiguchi et al 1995 sassa and sekiguchi 1999 carried out several sets of centrifugal standing wave experiments respectively and the experiments show that excess pore pressure increased significantly and reached maximum accumulated pore pressure via 2 3 wave periods identical to the case of progressive wave the liquefaction first occurred in the surface layer of seabed under standing waves when the excess pore pressure accumulated to a certain extent and then advanced downward to the maximum liquefied depth miyamoto et al 2004 sumer et al 2006 the soil dynamics theory tells us that the directions of principal stress axes in a seabed soil element rotates continuously under a train of progressive and standing waves inducing the seabed soil element suffered cyclic shear stress which is independent with the position of soil element madsen 1978 yamamoto et al 1978 ishihara and towhata 1983 considerable experiments and theories have proved that the buildup of excess pore pressure in seabed are related to the plastic volumetric strain induced by cyclic shear stress and proposed extensive elastoplastic models to compute excess pore pressure yamamoto 1981 jeng and lin 2000 cheng et al 2001 sassa and sekiguchi 2001 lin 2004 jeng et al 2007 zhao et al 2017 contrary to progressive wave case the soil element only underwent cyclic shear stress at the nodal section and cyclic normal stress at the antinodal section respectively however many experimental and numerical results kirca et al 2013 wang et al 2014 jeng and zhao 2015 yang and ye 2018 indicted the excess pore pressure exists not only under node but also antinode which builds up and results in residual liquefaction therefore it is a problem how to explain the residual liquefaction mechanism without the role of shear stress at antinodal section under standing waves so far there are two kinds of mechanisms accounting for residual liquefaction under antinodes according to published literatures one is the residual liquefaction under antinodes only was induced by the accumulated pore pressure transporting in seabed kirca et al 2013 the liquefaction zone first appeared at the nodal section in which suffering maximum shear strain compared with other positions then the accumulated pore pressure transporting from nodes toward antinodes due to pore pressure gradient in seabed eventually the liquefaction also coming up under antinodes after several wave periods sassa and sekiguchi 1999 2001 kirca et al 2013 conducted a series of wave flume experiments under standing waves to investigate the diffusion of residual pore pressure indicted that the transport efficiency of excess pore water is linked with the coefficient of consolidation but the time of pore pressure transporting calculated by eq 3 from node to neighboring antinode has a discrepancy about 1 6 times less in the horizontal direction than the actual time observed in the tests the reason for the discrepancy can ascribe the wave induced shear stress therefore the shear strain exist over the entire interval between the node and the neighboring antinode the other mechanism is that the seabed soil element generated plastic volumetric strains under the cyclic normal stress at the antinodal section resulting in the excess pore pressure accumulated and liquefied soon after wang et al 2014 wang et al 2014 carried out a large number of reflective standing wave experiments with rectangular wave tank and proposed that the excess pore pressure accumulates under antinode only as the result of cyclic normal stress and ignoring the influence of pore pressure transporting however the cyclic deviatoric stress causing residual pore pressures are not included by the shear stresses only but also by the stress differences in horizontal and vertical directions zhao et al 2020 zhu et al 2020 liu et al 2019 so the liquefaction at the antinodal section under standing waves presumably are influenced by the above two kinds of mechanism simultaneously to date none of the methods have been developed to distinguish the contributing proportion of the above two mechanisms individually hence it s meaningful to measuring the contribution of the cyclic normal stress and pore pressure transporting respectively for liquefaction at the antinodal section under standing waves moreover most previous researches mainly focused on the developing pattern and mechanism of liquefaction in single layer seabed under standing waves sekiguchi et al 1995 tsai and lee 1995 jeng 1997 sassa and sekiguchi 1999 ulker et al 2010 jeng and zhao 2015 yang and ye 2018 jeng et al 2019 lacking relevant experimental studies on multi layered seabed according to a relative field tests and engineering surveys in yellow river delta of china yang et al 2009 zheng et al 2011 2014 liu et al 2013 it s generally exists that the sedimentary crust layer commonly called ferro plate sand overlies the upmost layer of seabed silty seabed therefore further research are still needed in the aspect of mechanism of liquefaction in two layer seabed with upper crust layer under standing waves the purpose of this paper is to study the mechanism for residual liquefaction induced by standing waves under antinodes in two layer silty seabed with upper crust layer and discuss the effects of the soil characteristics permeability thickness of upper crust layer and wave characteristics wave period wave steepness to liquefaction the organization of this study is as follows firstly the excess pore pressure response of two layer silty seabed under standing waves was investigated with wave flume then based on the experimental results the process of the excess pore pressure building up under nodes and antinodes was analyzed respectively distinguishing the contributing proportion of cyclic normal stress and pore pressure transporting for liquefaction finally a parametric study was conducted with the present model to investigate the effects of the soil characteristics and wave characteristics to residual liquefaction 2 experiment plan and method 2 1 experiments setup the experiments were conducted in a wave flume figs 1a and 3 5 m in length 0 6 m in width and 1 2 m in height a rectangular soil pit 1 4 m in length 0 5 m in height was placed at the mid and low portion of wave flume as shown in fig 1 the wave generating system was set at one end of wave flume including air compressor electric control cabinet single rod double acting cylinder and wave paddle the objective waveform can be obtained by adjusting the stroke of double acting cylinder in the experiments a vertical and impervious plate was installed on the onshore end of soil pit the linear progressive waves produced by wave paddle would be fully reflected when reached the vertical wall and linear standing waves could be produced in front of vertical wall with superposition of incident and reflected waves jeng et al 2005 the tests were designed such that the wavelength l equals the length of soil pit i e l 140 cm fig 1 schematically displays the waveform generated in experiments and the layout of pore pressure tranducers the antinodal section were located at the middle and two sides of the soil pit s length direction and the nodal section existed in the middle of neighboring antinodal section before tests pore pressure tranducers were installed across the seabed soil depth at the antinodal and nodal section separately in order to measure the development of pore pressure accurately the type of used pore pressure tranducer is cyy2 produced by shuguang technologies of beijing ltd china the multichannel data acquisition system dewe 43 a was used to connect with the pore pressure tranducers so as to capture the signals with sampling rate of 50 hz the pore pressure tranducers were calibrated before embedded in soil and its measuring accuracy was 0 2 0 3 2 2 soil examples although the aim of this study is to investigate the liquefaction mechanism in two layer seabed with upper crust layer under standing waves same tests were carried out with single layer seabed to facilitate comparison under the case for single layer the seabed soil used mainly was made up of quartz and feldspar collected from the tidal flat of the yellow river delat in china the soil samples were a typical silt with median diameter d 50 0 045 mm the geometric standard deviation of the soil is σ g d 84 d 50 1 26 in which d 84 is the grain size for which 84 is finer the specific gravity of soil particle is g s 2 64 the permeability coefficient is k s2 1 2 10 6 m s and porosity is n 0 41 and possion s ratio is ν 0 29 the shear modulus is g 1 5 105 pa the methods of confirming the above soil properties can be found in sumer et al 2011 for the case of two layer seabed the medium sand was placed on the surface of single layer seabed to simulate the upper crust layer of seabed in yellow river delta the thickness of the upper crust layer selected in the experiments was 0 1 m the properties of medium sand were as follows median diameter is d 50 0 52 mm geometric standard deviation of the soil is σ g d 84 d 50 1 38 specific gravity of soil particle is g s 2 81 permeability coefficient is k s1 1 0 10 5 m s and porosity is n 0 46 and possion s ratio is ν 0 30 the shear modulus is g 2 5 8 105 pa the collected soil samples were dried and then crushed by a crusher the crushed soil samples were put into the mixer with water simultaneously after removing impurities and would be stirred into mud the mud was poured into the wave tank slowly along the inner wall to form the seabed with a preset depth after that a pipe fixed on the tank s side was used to inject water along the inner wall until the water depth achieving 40 cm from the mudline the seabed was kept for about one week before standing wave tests to make sure the self weight consolidation basically completed when the settlement of seabed was stable 2 3 design of test conditions in the experiments the water depth h 40 cm and wave period t 1 02 s were kept constant the wave height varied from 20 to 28 cm the parameters of tests are summarized in table 1 3 experimental results and discussion 3 1 identification of wave surface profile when the incident wave arrive normally at the vertical impervious plate it will be reflected from the vertical plate and the reflected waves are superimposed on the incident waves leading to the formation of standing waves system taking h i and h r as the height of incident wave and reflected wave respectively the reflection coefficient k r h r h i 0 98 fig 2 illustrates the change of wave surface within one wave cycle from fig 2 it can be seen that the antinodal section were located at the middle of the soil pit s length direction and the nodal section existed in the middle of neighboring antinodal section the surface of standing wave only oscillates exactly where it was and the waveform agrees well with the characteristics of standing wave hsu and jeng 1994 tsai 1995 jeng 1997 additionally the comparison between the pore pressure measured by p4 see fig 1b in test 6 for test 6 and the theoretical value calculated following jeng 1997 is shown in fig 3 fig 3 indicates that the measured value show good agreement with the theoretical value which proves the experimental setup is capable to produce the objective standing waves accurately 3 2 pore pressure response at the nodal section the results with time development of excess pore pressure were acquired ranging from 0 to 600 s under standing wave loading which are similar to some extent taking test 5 single layer seabed table 1 and test 6 two layer seabed as examples the accumulated process of excess pore pressure at different depths under node are shown in fig 4 according to the liquefaction criterion proposed by zen and yamazaki 1990 and jeng 1997 when the accumulated excess pore pressure exceeds the value of initial mean normal effective stress σ 0 eq 1 the liquefaction occurs in this paper σ 0 and σ 0 express the mean normal effective stress of single layer seabed and two layer seabed respectively 1 σ 0 γ z 1 2 k 0 3 where γ is the submerge specific weight of soil z is the depth of seabed soil element measuring from the mudline and k 0 is the lateral pressure coefficient of soil as shown in fig 4 there is very slight difference between single and two layer seabed for the development pattern of excess pore pressure under standing wave loading in the first 200 s the excess pore pressure built up rapidly whether in single or two layer seabed after that the excess pore pressure achieved a maximum value gradually with the time increasing of wave loads compared with single layer seabed the value of the excess pore pressure in two layer seabed was lower at the same depth and the time required to reach a maximum value was shorter this phenomenon occurred presumably because the permeability coefficient of upper crust layer in two layer seabed is higher than that of single layer seabed which means the accumulated pore pressure in deeper depth is easier to dissipate and achieves a maximum value within a relative short time the maximum excess pore pressure varied with depth both in single or two layer seabed taking the single layer seabed as example p max 0 05 denotes the maximum excess pore pressure at the depth of 0 05 m from fig 4 a c and d it can be seen that the maximum excess pore pressure at the different depths exist the following relationship p max 0 15 p max 0 05 p max 0 30 indicating the maximum excess pore pressure occurred at a certain depth and the excess pore pressure decreased when exceeding the certain depth that is existing a critical depth in seabed with the maximal excess pore pressure this is consistent with the observation in the case of progressive wave loading by sumer et al 2011 and liu et al 2015 the reason can be attributed to the drainage effect on surface of seabed the buildup process of excess pore pressure is influenced by the dissipating velocity and wave loading intensity simultaneously the excess pore pressure in shallow layer of seabed dissipates quickly than deep layer because of adjacent to drainage boundary in addition the intensity of wave induced shear stress decreases with the depth increasing so as to the soil elements in deep depth may suffer wave loading weaker than shallow layer which leads to small strain and the excess pore pressure accumulating difficultly in deep layer with the time increasing of wave loads the liquefaction occurred when the accumulated excess pore pressure exceeded the value of initial mean normal effective stress σ 0 or σ 0 the development of liquefaction were similar between single and two layer seabed taking the single layer seabed as example as shown in fig 4 c the time corresponding to the onset of liquefaction was 25 8 s at the depth of 0 15 m it should be noted that the liquefaction occurred before the excess pore pressure achieved the maximum i e the excess pore pressure equaled critical pore pressure p cr when liquefaction occurred and the p cr was less than p max according to the above liquefaction criterion when the critical pore pressure p cr exceed initial mean normal effective stress σ 0 or σ 0 the liquefaction take place i e p c r σ 0 1 or p c r σ 0 1 this is consistent with the findings of sumer et al 2006 2011 in case of progressive waves taking t 0 05 denotes the time corresponding to the incipient liquefaction at the depth of 0 05 m in single layer seabed fig 4 b c d tell us that t 0 05 t 0 15 t 0 30 indicating the liquefaction front advanced downwards from the surface of seabed to the deeper depth under standing wave loads similar observations for the case of progressive and standing wave were also reported by sassa and sekiguchi 1999 in contrast to single layer seabed the time required for incipient liquefaction in two layer seabed at the same depth was longer owing to the upper crust layer with the higher permeability coefficient which resulted in the accumulated pore pressure in seabed dissipating readily noteworthy is that there was no liquefaction at the depth of 0 3 m in two layer seabed it can be inferred that the liquefaction front advanced downwards to maximal depth under the certain combination of soil properties and wave parameters based on relevant investigations to progressive waves foda et al 1997 miyamoto et al 2004 sumer et al 2006 sumer 2013 this may be explained as follows the seabed soil element is subjected to cyclic shear stresses induced by standing wave then the cyclic shear stresses will lead to the soil particles rearranged and the plastic volumetric strain will be caused at the above process that is the dilatancy effect the plastic volumetric strain will accumulate and pressurize the pore water resulting in the buildup of excess pore pressure as a result the liquefaction takes place when the accumulating pore pressure exceeds the value of initial mean normal effective stress as described above the dissipating velocity and wave loading intensity influence the buildup process of excess pore pressure simultaneously therefore the liquefaction advances downwards to maximal depth in which the dissipating velocity of excess pore pressure equals the accumulating rate of plastic volumetric strain induced by standing wave loads 3 3 pore pressure response at the antinodal section taking test 5 single layer seabed table 1 and test 6 two layer seabed as examples fig 5 shows the buildup process of excess pore pressure for different depths at antinodal section it can be seen from the figure that the development pattern of excess pore pressure at the antinodal section was similar to the location of nodes the excess pore pressure continuously built up and liquefaction occurred in shallow layer after several wave cycles fig 5 a tells us the time corresponding to onset of liquefaction was 134 s for single layer seabed and 498 s for two layer seabed at the depth of 0 05 m instructing the two layer seabed mitigates liquefaction development due to the setting of upper crust layer with the higher permeability coefficient as shown in figs 4 and 5 there are two obvious differences in aspects of incident liquefaction and maximal liquefaction depth between the nodal and antionodal section 1 the time for incident liquefaction at the antinodal section was longer than that of nodal section for example the liquefaction took place at the time of 134 s under antinodes for two layer seabed and 2 5 s for single layer seabed at the depth of 0 05 m 2 the liquefaction existed at the depth of 0 15 m for the nodal section but no liquefaction for antinodal section implying the maximal liquefaction depth under nodes was greater than that of antinodes according to previous experimental and theoretical research done by madsen 1978 and sumer et al 2006 the building up of pore pressure is a result of the accumulating of soil volumetric strain induced by cyclic shear stress under wave loading however as fig 6 shown the representative soil element at antinodes only suffered cyclic normal stress without shear stress but the liquefaction occurred kirca et al 2013 proposed that the pore pressure accumulated in the areas around the nodes firstly and the accumulated pore pressure transported toward the antinodes by a diffusion mechanism which can explain the above two differences between node and antinode interestingly wang et al 2014 found the plastic volumetric strain accumulated at the antinodal section by experimental work and inferred the plastic volumetric strain was caused by cyclic normal stress additionally the settlement is directly related to the plastic volumetric strain induced by cyclic normal stress at the antinodal section the excess pore pressure is corresponding to the plastic volume shrinkage and the plastic volume shrinkage shows up as the unrecoverable settlement in experimental test after fully dissipation of excess pore pressure and re consolidation of soil therefore it is reasonable to assume that the liquefaction at the antinodal section presumably are caused by pore pressure transporting and cyclic normal stress simultaneously 3 4 mechanism of residual liquefaction at the antinodal section the supplementary experiment was conducted so as to measure the contribution of the pore pressure transporting and cyclic normal stress respectively for liquefaction under antinodes fig 6 displays the sketch of representative soil elements stress and strain under standing wave loads from fig 6 it can be known that the soil element only suffered the maximal shear stress at nodal section and the maximal or minimal normal stress at antinodal section the soil element between node and antinode experienced shear stress and normal stress simultaneously as talked in previous section the accumulated plastic volumetric strain induced by cyclic shear stress results in the pore pressure building up therefore the pore pressure will build up to some extent in the areas around the antinode in supplementary experiment two vertical sealed plastic plates were installed symmetrically just adjacent to the two sides of antinode respectively in order to inhibit the accumulated pore pressure transporting toward the antinode most possibly fig 7 the supplementary experiment was carried out in two layer seabed with total thickness of 50 cm consisting of the upper crust layer with thickness of 10 cm and the silt sublayer with thickness of 40 cm the soil properties are same as described in previous section the wave parameters are identical with test 6 the layout of pore pressure tranducers are shown in fig 7 b the results of pore pressure at the antinodal section are shown in fig 8 and the results that of test 6 were also plotted corresponding to the case of no vertical sealed plate compared with the case of no sealed plate the accumulated pore pressure decreased evidently such that the pore pressure never exceeded initial mean normal effective stress at the antinodal section and liquefaction could not take place even at the shallow depth of 0 05 m after installing vertical sealed plates the difference could be attributed to the setting of sealed plates which inhibited the accumulated pore pressure transported in the areas around the nodal section and spread out toward the antinodal section however although the sealed plate cut off the transporting of accumulated pore pressure from node to antinode the pore pressure still built up to some extent as mentioned previously the buildup of pore pressure is the result of accumulating of plastic volumetric strain therefore the soil at the antinodal section yields and the plastic volumetric strain accumulates under cyclic normal stress which called the soil yield under isotropic compression in general it can be concluded that the horizontal transporting of pore pressure and the accumulating of plastic volumetric strain induced by cyclic normal stress contribute to the buildup of pore pressure at the antinodal section simultaneously taking p res denotes the total accumulated pore pressure at the nodal section and p res1 denotes the accumulated pore pressure caused by horizontal transporting from nodes to antinodes and p res2 is the accumulated pore pressure induced by cyclic normal stress as discussed in the above section the p res p res1 and p res2 satisfy the relationship p res p res1 p res2 according to the previous studies done by mcdougal et al 1989 sumer et al 2011 and kirca et al 2013 the efficiency of pore pressure transporting is linked to the coefficient of consolidation c v the time corresponding to the pore pressure transporting from the node to the neighboring antinode δt can be calculated by the following equation 2 δ t x 2 2 c v where the x is the horizontal distance between the node and neighboring antinode the c v is 0 002 m2 s at the depth of 0 15 m and the δt calculated by equation 2 is about 30 6 s noteworthy is that kirca et al 2013 also used equation 2 to calculate δt but the calculating result is 1 6 times less than observed in the experiment in his experiments the vertical plate was placed in the soil midway between the nodal section and neighboring antinodal section so the discrepancy could be attributed to the shear stress in the generation of accumulated pore pressure over the entire areas between the vertical plate and neighboring antinode the distinction of this study is two vertical sealed plates were placed symmetrically just adjacent to the two sides of antinode respectively so it s reasonable to assume the plates cut off the horizontal transporting of pore pressure from neighboring areas possibly and the accumulated pore pressure under the antinodal section only induced by cyclic normal stress fig 9 displays the results of accumulated pore pressure at the depth of 1 5 m including the case of installing sealed plates and no plate as shown in fig 9 a the excess pore pressure at nodal section accumulated to the point a after wave loading 5 s then the pore pressure transported to neighboring antinodal section via 30 6 s i e the point b in fig 9 a the point b corresponded to the case of no plate so the accumulated pore pressure of point b consisted of p res1 and p res2 actually the p res2 can be acquired by the test with installing vertical sealed plate as described in the previous section i e the point c in fig 9 a and the p res1 can also be acquired by the value of point a minus point b defining the ratio of the accumulating excess pore pressure caused by horizontal transporting to the total accumulated excess pore pressure at the antinodal section as α1 p res1 p res and the ratio of the accumulated excess pore pressure induced by cyclic normal stress to the total accumulated excess pore pressure at the antinodal section as α2 p res2 p res from fig 9 it can be seen that the α1 α2 varied continuously with the buildup of excess pore pressure at 0 40 s and kept constant basically when the accumulated pore pressure reached a steady state such as 560 600 s in this experiment α1 52 6 and α2 47 4 with steady state at the depth of 0 15 m moreover it should be noted although the vertical sealed plate cut off the horizontal transporting of pore pressure the vertical accumulated pore pressure gradient also existed as mentioned in section 3 2 therefore the p res2 also presumably includes or excludes the component of transporting in vertical direction but the p res2 is only induced by cyclic normal stress at the antinodal section 4 numerical model 4 1 governing equations the force equilibrium equations based on biot s poroelastic theory biot 1941 1960 and hydraulic continuity equation derived by darcy s law darcy 1856 are used as the governing equations for the compressible soil skeleton and pore fluid respectively the governing equations in the x and z directions are as follows 3 g 2 u g 1 2 υ ε v x p t x 4 g 2 w g 1 2 υ ε v z p t z 5 2 p t γ n β k p t t γ w k ε v t 6 ε v u x w z 7 τ g u z w x where g is shear modulus u and w are horizontal and normal displacement respectively ε v is volumetric strain p t is the wave induced pore pressure β is compressibility coefficient of pore fluid which can be expressed as follows 8 β 1 k 1 s r p w where k is the bulk modulus of pore water p w is absolute static pressure s r is degree of saturation the magnitude of wave induced residual pore pressure can be calculated by the following governing equation proposed by jeng et al 2007 9 p r e s t c v 2 p r e s x 2 2 p r e s z 2 f where f is the source term c v is coefficient of consolidation defined as 10 c v g k γ 2 1 υ 1 2 υ 2 2 υ n g β based on the build up pattern of pore pressure u σ 0 u is pore pressure proposed by liu et al 2005 for silty and silty sand in yellow river of china the u σ 0 can be expressed as follows 11 u σ 0 n n l a b n n l a c where the initial mean normal effective stress σ 0 can be calculated by eq 1 n is the number of cyclic loading n l is the number of cycles to liquefaction a b and c are empirical coefficients in this study for silty sand a 0 25 b 1 0 c 1 2 for silty a 0 235 b 1 1 c 0 9 liu et al 2005 the n and n l can be calculated by the follow equations mcdougal et al 1989 12 n t t 13 n l 1 α r τ σ 0 1 β r where α r and β r are dimensionless coefficients in this study α r1 0 206 β r2 0 326 for upper crust layer α r1 0 221 β r2 0 312 for bottom layer sumer et al 2011 using equations 11 13 the source term f can be defined as 14 f u t u n n t a c σ 0 t a 1 t a n l a b t a t a n l a c 2 according to the standing wave theory the pressure induced by standing wave on the seabed surface is expressed by 15 p b p 0 cos k x cos ω t 16 p 0 γ h 2 cosh k d where h is wave height d is mean water depth k is wave number ω is wave frequency p 0 is the amplitude of the wave pressure 4 2 boundary conditions appropriate boundary conditions are indispensable so as to solve the above governing equations first of all at the seabed surface the effective normal stress and shear stress vanish the wave induced pore pressure equal to the wave pressure induced by standing wave the volumetric strain of soil skeleton is zero without the role of shear stress and normal stress so the residual pore pressure is zero 17 σ 0 τ 0 p t p b p r e s 0 second at the bottom of seabed the seabed is assumed to be rigid and impermeable and soil displacement and the normal gradients of pore pressures are zero 18 u w 0 p r e s z 0 furthermore the boundary conditions for two sides of seabed are regard as zero flux in addition the displacement pore pressure and stress are continuous at the interface between the upper layer and lower layer 19 u i u j w i w j p r e s i p r e s j k i p r e s i z k j p r e s j z σ i σ j τ i τ j where i and j denote the upper layer and lower layer seabed individually the seabed model were built with geometry partion in comsol then the govern equations eq 3 16 and boundary conditions eq 17 19 were input the partial differential equation modules after that the finite element method was used to solve the above equations 5 numerical results and discussion the present model was utilized for studying the seabed residual response and liquefaction induced by standing wave in this section the experimental results of this study and kirca et al 2013 were applied to validate the present model next a parametric study was conducted based on the present model firstly the effect of surface layer of seabed parameters for residual liquefaction was investigated including thickness and permeability of surface layer secondly the effect of two wave characteristics wave period and wave steepness on the residual liquefaction was discussed the parameters of wave and seabed for the first validation are same as described in section 2 2 the input parameters for the parametric study are listed in table 2 5 1 model validation the results of present model were compared with the experimental data of this study to validate the reliability of the numerical simulation the comparison were conducted against the experimental data at the node and antinode section respectively and the results is shown in fig 10 a fig 10 a reveals that the excess pore pressure builds up gradually with an increase of wave loading time the build up pattern of pore pressure calculated by the present model is basically consistent with experimental data of this study although the accumulated pore pressure in the present model is slightly smaller than those measured in the experiments at the antinode section in general the accumulated pore pressure calculated by the present model agrees well with experimental data of this study in addition the results of present model were also compared with the standing wave experiments conducted by kirca et al 2013 in the experiments the parameters for the seabed and standing wave are seabed depth h 20 cm permeability coefficient k 1 5 10 3 m s void ratio e 1 02 and poison s ratio μ 0 33 linear standing wave period t 1 09 s wavelength l 156 cm wave height h 10 5 cm and water depth d 30 cm fig 9 b shows a comparison between the simulated and measured results kirca et al 2013 at the location of x z 9 75 7 cm as fig 10b indicates the accumulated pore pressure calculated by the present model has good overall agreement with experimental data reported in kirca et al 2013 and this proves the present model is reasonable and reliable in dealing with pore pressure under standing waves 5 2 effects of upper crust layer thickness to further investigate the liquefaction under different thickness of upper crust layer three models of two layer seabed were built respectively according to the thickness of upper crust layer of 0 05 m 0 1 m and 0 2 m corresponding to h 1 h equaling 0 1 0 2 and 0 4 where h denoting the total thickness of seabed h 0 5 m moreover the simulation in the case of a single layer was also carried out as a control group fig 11 shows the distribution of accumulated excess pore pressure with different thickness of upper crust layer it was found that the maximum and minimum value of accumulated excess pore pressure occurred at the nodal and antinodal section respectively this is consistent with the experimental findings of this study specifically the location of the largest excess pore pressure advanced downwards with the increase of upper crust layer thickness for h 1 h 0 4 the largest excess pore pressure even appeared at the bottom of seabed fig 12 a b and c illustrate the time histories of excess pore pressure at different depths from fig 12 it can be known the excess pore pressure built up rapidly at initial stage of wave loading and reached a relative steady stage gradually after a while the whole tendency of present result is consistent with the findings of gatmiri 1992 hsu et al 1995 jeng 1997 2013 zhou et al 2011 on the other hand the increase of the thickness of the upper crust layer from h 1 h 0 to 0 1 0 2 and 0 4 lead to a significant decrease of accumulated excess pore pressure which indicating the accumulated excess pore pressure dissipated more readily in the case with a large upper crust layer in addition the time corresponding to the onset of liquefaction increased evidently with the increase of h 1 h and there was no liquefaction with the case of h 1 h 0 2 and 0 4 at the depth of 0 3 m it is believed that placing an upper crust layer with high permeability on the existing silt seabed may inhabit the liquefaction and mitigate liquefaction risk compared to that of original single layer seabed 5 3 effects of soil permeability besides the thickness of upper crust layer the soil permeability is also a key parameter for wave induced seabed residual response and liquefaction zhao et al 2017 zhao and jeng 2015 in this section three models with different soil permeability namely k s1 k s2 1 10 and 50 were proposed to study the residual liquefaction under standing waves as shown in fig 13 at the same depth the excess pore pressure built up to a large value as k s1 k s2 decreases whether it s node or antinode section what s more the value of excess pore pressure under antinode was less than that of antinode with same depth and this is consistent with the experimental results of this study zhao et al 2017 and sumer et al 2011 it should be noted that the distribution pattern of accumulated pore pressure versus depth was different between node and antinode section which may be attributed to the soil element suffering fully different stress path under standing wave at nodal and antinodal section respectively as described in section 3 4 the soil element only underwent cyclic shear stress at nodal section and cyclic normal stress at the antinodal section respectively and the horizontal transporting of pore pressure and the accumulating of plastic volumetric strain induced by cyclic normal stress contribute to the residual pore pressure at the antinodal section simultaneously from fig 13 it also can be found that liquefaction front advanced downwards with decrease of k s1 k s2 specifically when k s1 k s2 1 the liquefaction front arrived at the bottom of seabed the increase in liquefied depth is attributed to the decrease of k s1 which indicates the seabed residual liquefaction can be enhanced with poor drainage conditions in the upper layer 5 4 effects of wave characteristics in marine environment the wave conditions may vary significantly even in coastal sea areas and different wave characteristics will lead to the variability of the residual response of a seabed so it s a key topic to investigate the seabed residual response and liquefaction with different wave characteristics here the effects of two wave characteristics wave period t and wave steepness h l on the residual liquefaction under standing waves were examined as fig 14 illustrate the excess pore pressure and liquefaction depth increased as the wave period decreased compared to the case of t 2 s the maximum value of excess pore pressure was significantly higher for t 1 s this is because the excess pore pressure drain out more readily in the case with short wave period while based on the difference between t 2 s and t 3 s the effect of a short wave period t 2 s on the seabed residual response seem insignificant in addition noteworthy is that the variation of excess pore pressure was considerably larger in the upper crust layer at the nodal section than that in the lower layer but the opposite appeared at antinodal section the distribution of excess pore pressure versus relative depth z h for various wave steepness h l is shown in fig 15 fig 15 implies that the excess pore pressure and liquefaction depth increased significantly as wave steepness increases indicating that the standing waves with large wave steepness result in the excess pore pressure accumulate more substantially than that of small wave steepness and therefore liquefy deeper 6 conclusions the response of excess pore pressure in single layer and two layer seabed under standing waves were investigated by performing a series of wave flume tests and numerical solution with the present model respectively based on the experimental results the residual liquefaction mechanism at the antinodal section was analyzed the effects of the soil characteristics permeability thickness of upper crust layer and wave characteristics wave period wave steepness to residual liquefaction were acquired with the present numerical model the principal conclusion can be summarized as follows 1 the measured standing wave surface profile and pore pressure on the mudline show good agreement with the previous theoretical model which proves the experimental setup is capable to produce the objective standing waves accurately 2 compared with single layer seabed the value of the excess pore pressure in two layer seabed including upper crust layer with high permeability was lower and the time required to reach a maximum value was shorter 3 the liquefaction occurred before the excess pore pressure achieved the maximum and the liquefaction advanced downwards to maximal depth in which the dissipating velocity of excess pore pressure equaled the accumulating rate of plastic volumetric strain induced by standing wave loads 4 the horizontal transporting of pore pressure and the accumulating of plastic volumetric strain induced by cyclic normal stress contribute to the liquefaction at the antinodal section simultaneously in this experiment the former and latter contribute about 52 6 and 47 4 respectively for liquefaction with steady state at the depth of 0 15 m 5 the present numerical model was verified by comparing with experimental results the thinner upper crust layer the smaller k s1 k s2 k s2 1 2 10 6 m s the shorter wave period the higher wave steepness result in a deeper liquefaction depth additionally the wave period and wave steepness had a more significant effect for the upper crust layer than that the lower layer at the nodal section but the opposite trend appeared at antinodal section credit authorship contribution statement ruigeng hu conceptualization methodology software investigation validation writing original draft peng yu formal analysis investigation writing review editing zhaoyao wang investigation data curation wei shi resources supervision hongjun liu resources supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was financially supported by the funds for the national natural science foundation of china 41572247 
21325,laboratory experiments and numerical simulation were conducted to study the residual liquefaction mechanism of two layer seabed with upper crust layer under standing waves in this study the buildup process of pore pressure and onset of liquefaction were firstly analyzed furthermore the residual liquefaction mechanism at the nodal section was discussed in addition a parametric study was conducted with the present model to investigate the effects of the soil and wave characteristics to residual liquefaction the results indicate that the liquefaction occurred before the excess pore pressure reached the maximum then the liquefaction advanced downwards to maximal depth different with nodal section the horizontal transporting of pore pressure and the accumulating of plastic volumetric strain induced by cyclic normal stress contribute to the liquefaction at the antinodal section simultaneously the former and latter contribute about 52 6 and 47 4 respectively at the depth of 0 15 m the thinner upper crust layer the smaller k s1 k s2 k s2 1 2 10 6 m s the shorter wave period the higher wave steepness result in a deeper liquefaction depth additionally the wave period and wave steepness had a more significant effect for the upper crust layer than the lower layer at the nodal section but the opposite trend appeared at antinodal section keywords residual liquefaction standing waves two layer seabed accumulated excess pore pressure laboratory experiments and numerical simulation 1 introduction in recent years the response of porous seabed due to gravity waves has received special attention by marine geotechnical engineers related to the stability of offshore structures when a train progressive waves arrive normally at a vertical wall they will be fully reflected from the vertical wall and the reflected waves are superimposed on the incident waves leading to the formation of standing waves system goda 1967 tsai 1995 jeng 1997 the surface of standing wave only oscillates exactly where it is and the waveform doesn t advance in the situation of linear superposition the wave height of the standing wave is twice that of the incident wave enhancing the pressure on seabed soil than incident progressive wave tsai and jeng 1994 standing waves may be produced easily in front of breakwaters and seawalls seabed soil will undergo liquefaction in vicinity of such structures under standing waves when the excess pore pressure equals the effective stresses resulting in the instability of seabed foundation of marine structures the wave induced seabed soil liquefaction can be classified into two kinds of mechanisms according to how the excess pore pressure is developed zen and yamazaki 1990 jeng and zhao 2015 the first mechanism is transient or oscillatory liquefaction which occurs when the seabed soil suffers wave troughs leading a sharp upwardly directed pressure gradient the upward seepage force acting on the soil skeleton reduces the vertical effective stress and when the excess pore pressure is larger than the vertical effective stress transient liquefaction occurs sakai et al 1992 seymour et al 1996 jeng and lee 2001 mory et al 2007 jeng and zhao 2015 the second mechanism is residual or accumulated liquefaction the wave causes the soil skeleton subjected to cyclic shear stress which leading to the rearrangement of soil particles the change of pore volume and the accumulation of excess pore pressure similar to transient liquefaction the residual liquefaction occurs when the accumulated excess pore pressure is greater than the vertical effective stress mcdougal et al 1989 li and jeng 2008 sumer et al 2006 zhu 2013 the work presented in this paper focuses on the mechanism of residual liquefaction under standing waves the amplitude of excess pore pressure induced by standing waves is twice that of incident waves under the case of linear superposition tsai and lee 1995 therefore compared with the incident waves the seabed is prone to suffer residual liquefaction under standing waves sekiguchi et al 1995 sassa and sekiguchi 1999 carried out several sets of centrifugal standing wave experiments respectively and the experiments show that excess pore pressure increased significantly and reached maximum accumulated pore pressure via 2 3 wave periods identical to the case of progressive wave the liquefaction first occurred in the surface layer of seabed under standing waves when the excess pore pressure accumulated to a certain extent and then advanced downward to the maximum liquefied depth miyamoto et al 2004 sumer et al 2006 the soil dynamics theory tells us that the directions of principal stress axes in a seabed soil element rotates continuously under a train of progressive and standing waves inducing the seabed soil element suffered cyclic shear stress which is independent with the position of soil element madsen 1978 yamamoto et al 1978 ishihara and towhata 1983 considerable experiments and theories have proved that the buildup of excess pore pressure in seabed are related to the plastic volumetric strain induced by cyclic shear stress and proposed extensive elastoplastic models to compute excess pore pressure yamamoto 1981 jeng and lin 2000 cheng et al 2001 sassa and sekiguchi 2001 lin 2004 jeng et al 2007 zhao et al 2017 contrary to progressive wave case the soil element only underwent cyclic shear stress at the nodal section and cyclic normal stress at the antinodal section respectively however many experimental and numerical results kirca et al 2013 wang et al 2014 jeng and zhao 2015 yang and ye 2018 indicted the excess pore pressure exists not only under node but also antinode which builds up and results in residual liquefaction therefore it is a problem how to explain the residual liquefaction mechanism without the role of shear stress at antinodal section under standing waves so far there are two kinds of mechanisms accounting for residual liquefaction under antinodes according to published literatures one is the residual liquefaction under antinodes only was induced by the accumulated pore pressure transporting in seabed kirca et al 2013 the liquefaction zone first appeared at the nodal section in which suffering maximum shear strain compared with other positions then the accumulated pore pressure transporting from nodes toward antinodes due to pore pressure gradient in seabed eventually the liquefaction also coming up under antinodes after several wave periods sassa and sekiguchi 1999 2001 kirca et al 2013 conducted a series of wave flume experiments under standing waves to investigate the diffusion of residual pore pressure indicted that the transport efficiency of excess pore water is linked with the coefficient of consolidation but the time of pore pressure transporting calculated by eq 3 from node to neighboring antinode has a discrepancy about 1 6 times less in the horizontal direction than the actual time observed in the tests the reason for the discrepancy can ascribe the wave induced shear stress therefore the shear strain exist over the entire interval between the node and the neighboring antinode the other mechanism is that the seabed soil element generated plastic volumetric strains under the cyclic normal stress at the antinodal section resulting in the excess pore pressure accumulated and liquefied soon after wang et al 2014 wang et al 2014 carried out a large number of reflective standing wave experiments with rectangular wave tank and proposed that the excess pore pressure accumulates under antinode only as the result of cyclic normal stress and ignoring the influence of pore pressure transporting however the cyclic deviatoric stress causing residual pore pressures are not included by the shear stresses only but also by the stress differences in horizontal and vertical directions zhao et al 2020 zhu et al 2020 liu et al 2019 so the liquefaction at the antinodal section under standing waves presumably are influenced by the above two kinds of mechanism simultaneously to date none of the methods have been developed to distinguish the contributing proportion of the above two mechanisms individually hence it s meaningful to measuring the contribution of the cyclic normal stress and pore pressure transporting respectively for liquefaction at the antinodal section under standing waves moreover most previous researches mainly focused on the developing pattern and mechanism of liquefaction in single layer seabed under standing waves sekiguchi et al 1995 tsai and lee 1995 jeng 1997 sassa and sekiguchi 1999 ulker et al 2010 jeng and zhao 2015 yang and ye 2018 jeng et al 2019 lacking relevant experimental studies on multi layered seabed according to a relative field tests and engineering surveys in yellow river delta of china yang et al 2009 zheng et al 2011 2014 liu et al 2013 it s generally exists that the sedimentary crust layer commonly called ferro plate sand overlies the upmost layer of seabed silty seabed therefore further research are still needed in the aspect of mechanism of liquefaction in two layer seabed with upper crust layer under standing waves the purpose of this paper is to study the mechanism for residual liquefaction induced by standing waves under antinodes in two layer silty seabed with upper crust layer and discuss the effects of the soil characteristics permeability thickness of upper crust layer and wave characteristics wave period wave steepness to liquefaction the organization of this study is as follows firstly the excess pore pressure response of two layer silty seabed under standing waves was investigated with wave flume then based on the experimental results the process of the excess pore pressure building up under nodes and antinodes was analyzed respectively distinguishing the contributing proportion of cyclic normal stress and pore pressure transporting for liquefaction finally a parametric study was conducted with the present model to investigate the effects of the soil characteristics and wave characteristics to residual liquefaction 2 experiment plan and method 2 1 experiments setup the experiments were conducted in a wave flume figs 1a and 3 5 m in length 0 6 m in width and 1 2 m in height a rectangular soil pit 1 4 m in length 0 5 m in height was placed at the mid and low portion of wave flume as shown in fig 1 the wave generating system was set at one end of wave flume including air compressor electric control cabinet single rod double acting cylinder and wave paddle the objective waveform can be obtained by adjusting the stroke of double acting cylinder in the experiments a vertical and impervious plate was installed on the onshore end of soil pit the linear progressive waves produced by wave paddle would be fully reflected when reached the vertical wall and linear standing waves could be produced in front of vertical wall with superposition of incident and reflected waves jeng et al 2005 the tests were designed such that the wavelength l equals the length of soil pit i e l 140 cm fig 1 schematically displays the waveform generated in experiments and the layout of pore pressure tranducers the antinodal section were located at the middle and two sides of the soil pit s length direction and the nodal section existed in the middle of neighboring antinodal section before tests pore pressure tranducers were installed across the seabed soil depth at the antinodal and nodal section separately in order to measure the development of pore pressure accurately the type of used pore pressure tranducer is cyy2 produced by shuguang technologies of beijing ltd china the multichannel data acquisition system dewe 43 a was used to connect with the pore pressure tranducers so as to capture the signals with sampling rate of 50 hz the pore pressure tranducers were calibrated before embedded in soil and its measuring accuracy was 0 2 0 3 2 2 soil examples although the aim of this study is to investigate the liquefaction mechanism in two layer seabed with upper crust layer under standing waves same tests were carried out with single layer seabed to facilitate comparison under the case for single layer the seabed soil used mainly was made up of quartz and feldspar collected from the tidal flat of the yellow river delat in china the soil samples were a typical silt with median diameter d 50 0 045 mm the geometric standard deviation of the soil is σ g d 84 d 50 1 26 in which d 84 is the grain size for which 84 is finer the specific gravity of soil particle is g s 2 64 the permeability coefficient is k s2 1 2 10 6 m s and porosity is n 0 41 and possion s ratio is ν 0 29 the shear modulus is g 1 5 105 pa the methods of confirming the above soil properties can be found in sumer et al 2011 for the case of two layer seabed the medium sand was placed on the surface of single layer seabed to simulate the upper crust layer of seabed in yellow river delta the thickness of the upper crust layer selected in the experiments was 0 1 m the properties of medium sand were as follows median diameter is d 50 0 52 mm geometric standard deviation of the soil is σ g d 84 d 50 1 38 specific gravity of soil particle is g s 2 81 permeability coefficient is k s1 1 0 10 5 m s and porosity is n 0 46 and possion s ratio is ν 0 30 the shear modulus is g 2 5 8 105 pa the collected soil samples were dried and then crushed by a crusher the crushed soil samples were put into the mixer with water simultaneously after removing impurities and would be stirred into mud the mud was poured into the wave tank slowly along the inner wall to form the seabed with a preset depth after that a pipe fixed on the tank s side was used to inject water along the inner wall until the water depth achieving 40 cm from the mudline the seabed was kept for about one week before standing wave tests to make sure the self weight consolidation basically completed when the settlement of seabed was stable 2 3 design of test conditions in the experiments the water depth h 40 cm and wave period t 1 02 s were kept constant the wave height varied from 20 to 28 cm the parameters of tests are summarized in table 1 3 experimental results and discussion 3 1 identification of wave surface profile when the incident wave arrive normally at the vertical impervious plate it will be reflected from the vertical plate and the reflected waves are superimposed on the incident waves leading to the formation of standing waves system taking h i and h r as the height of incident wave and reflected wave respectively the reflection coefficient k r h r h i 0 98 fig 2 illustrates the change of wave surface within one wave cycle from fig 2 it can be seen that the antinodal section were located at the middle of the soil pit s length direction and the nodal section existed in the middle of neighboring antinodal section the surface of standing wave only oscillates exactly where it was and the waveform agrees well with the characteristics of standing wave hsu and jeng 1994 tsai 1995 jeng 1997 additionally the comparison between the pore pressure measured by p4 see fig 1b in test 6 for test 6 and the theoretical value calculated following jeng 1997 is shown in fig 3 fig 3 indicates that the measured value show good agreement with the theoretical value which proves the experimental setup is capable to produce the objective standing waves accurately 3 2 pore pressure response at the nodal section the results with time development of excess pore pressure were acquired ranging from 0 to 600 s under standing wave loading which are similar to some extent taking test 5 single layer seabed table 1 and test 6 two layer seabed as examples the accumulated process of excess pore pressure at different depths under node are shown in fig 4 according to the liquefaction criterion proposed by zen and yamazaki 1990 and jeng 1997 when the accumulated excess pore pressure exceeds the value of initial mean normal effective stress σ 0 eq 1 the liquefaction occurs in this paper σ 0 and σ 0 express the mean normal effective stress of single layer seabed and two layer seabed respectively 1 σ 0 γ z 1 2 k 0 3 where γ is the submerge specific weight of soil z is the depth of seabed soil element measuring from the mudline and k 0 is the lateral pressure coefficient of soil as shown in fig 4 there is very slight difference between single and two layer seabed for the development pattern of excess pore pressure under standing wave loading in the first 200 s the excess pore pressure built up rapidly whether in single or two layer seabed after that the excess pore pressure achieved a maximum value gradually with the time increasing of wave loads compared with single layer seabed the value of the excess pore pressure in two layer seabed was lower at the same depth and the time required to reach a maximum value was shorter this phenomenon occurred presumably because the permeability coefficient of upper crust layer in two layer seabed is higher than that of single layer seabed which means the accumulated pore pressure in deeper depth is easier to dissipate and achieves a maximum value within a relative short time the maximum excess pore pressure varied with depth both in single or two layer seabed taking the single layer seabed as example p max 0 05 denotes the maximum excess pore pressure at the depth of 0 05 m from fig 4 a c and d it can be seen that the maximum excess pore pressure at the different depths exist the following relationship p max 0 15 p max 0 05 p max 0 30 indicating the maximum excess pore pressure occurred at a certain depth and the excess pore pressure decreased when exceeding the certain depth that is existing a critical depth in seabed with the maximal excess pore pressure this is consistent with the observation in the case of progressive wave loading by sumer et al 2011 and liu et al 2015 the reason can be attributed to the drainage effect on surface of seabed the buildup process of excess pore pressure is influenced by the dissipating velocity and wave loading intensity simultaneously the excess pore pressure in shallow layer of seabed dissipates quickly than deep layer because of adjacent to drainage boundary in addition the intensity of wave induced shear stress decreases with the depth increasing so as to the soil elements in deep depth may suffer wave loading weaker than shallow layer which leads to small strain and the excess pore pressure accumulating difficultly in deep layer with the time increasing of wave loads the liquefaction occurred when the accumulated excess pore pressure exceeded the value of initial mean normal effective stress σ 0 or σ 0 the development of liquefaction were similar between single and two layer seabed taking the single layer seabed as example as shown in fig 4 c the time corresponding to the onset of liquefaction was 25 8 s at the depth of 0 15 m it should be noted that the liquefaction occurred before the excess pore pressure achieved the maximum i e the excess pore pressure equaled critical pore pressure p cr when liquefaction occurred and the p cr was less than p max according to the above liquefaction criterion when the critical pore pressure p cr exceed initial mean normal effective stress σ 0 or σ 0 the liquefaction take place i e p c r σ 0 1 or p c r σ 0 1 this is consistent with the findings of sumer et al 2006 2011 in case of progressive waves taking t 0 05 denotes the time corresponding to the incipient liquefaction at the depth of 0 05 m in single layer seabed fig 4 b c d tell us that t 0 05 t 0 15 t 0 30 indicating the liquefaction front advanced downwards from the surface of seabed to the deeper depth under standing wave loads similar observations for the case of progressive and standing wave were also reported by sassa and sekiguchi 1999 in contrast to single layer seabed the time required for incipient liquefaction in two layer seabed at the same depth was longer owing to the upper crust layer with the higher permeability coefficient which resulted in the accumulated pore pressure in seabed dissipating readily noteworthy is that there was no liquefaction at the depth of 0 3 m in two layer seabed it can be inferred that the liquefaction front advanced downwards to maximal depth under the certain combination of soil properties and wave parameters based on relevant investigations to progressive waves foda et al 1997 miyamoto et al 2004 sumer et al 2006 sumer 2013 this may be explained as follows the seabed soil element is subjected to cyclic shear stresses induced by standing wave then the cyclic shear stresses will lead to the soil particles rearranged and the plastic volumetric strain will be caused at the above process that is the dilatancy effect the plastic volumetric strain will accumulate and pressurize the pore water resulting in the buildup of excess pore pressure as a result the liquefaction takes place when the accumulating pore pressure exceeds the value of initial mean normal effective stress as described above the dissipating velocity and wave loading intensity influence the buildup process of excess pore pressure simultaneously therefore the liquefaction advances downwards to maximal depth in which the dissipating velocity of excess pore pressure equals the accumulating rate of plastic volumetric strain induced by standing wave loads 3 3 pore pressure response at the antinodal section taking test 5 single layer seabed table 1 and test 6 two layer seabed as examples fig 5 shows the buildup process of excess pore pressure for different depths at antinodal section it can be seen from the figure that the development pattern of excess pore pressure at the antinodal section was similar to the location of nodes the excess pore pressure continuously built up and liquefaction occurred in shallow layer after several wave cycles fig 5 a tells us the time corresponding to onset of liquefaction was 134 s for single layer seabed and 498 s for two layer seabed at the depth of 0 05 m instructing the two layer seabed mitigates liquefaction development due to the setting of upper crust layer with the higher permeability coefficient as shown in figs 4 and 5 there are two obvious differences in aspects of incident liquefaction and maximal liquefaction depth between the nodal and antionodal section 1 the time for incident liquefaction at the antinodal section was longer than that of nodal section for example the liquefaction took place at the time of 134 s under antinodes for two layer seabed and 2 5 s for single layer seabed at the depth of 0 05 m 2 the liquefaction existed at the depth of 0 15 m for the nodal section but no liquefaction for antinodal section implying the maximal liquefaction depth under nodes was greater than that of antinodes according to previous experimental and theoretical research done by madsen 1978 and sumer et al 2006 the building up of pore pressure is a result of the accumulating of soil volumetric strain induced by cyclic shear stress under wave loading however as fig 6 shown the representative soil element at antinodes only suffered cyclic normal stress without shear stress but the liquefaction occurred kirca et al 2013 proposed that the pore pressure accumulated in the areas around the nodes firstly and the accumulated pore pressure transported toward the antinodes by a diffusion mechanism which can explain the above two differences between node and antinode interestingly wang et al 2014 found the plastic volumetric strain accumulated at the antinodal section by experimental work and inferred the plastic volumetric strain was caused by cyclic normal stress additionally the settlement is directly related to the plastic volumetric strain induced by cyclic normal stress at the antinodal section the excess pore pressure is corresponding to the plastic volume shrinkage and the plastic volume shrinkage shows up as the unrecoverable settlement in experimental test after fully dissipation of excess pore pressure and re consolidation of soil therefore it is reasonable to assume that the liquefaction at the antinodal section presumably are caused by pore pressure transporting and cyclic normal stress simultaneously 3 4 mechanism of residual liquefaction at the antinodal section the supplementary experiment was conducted so as to measure the contribution of the pore pressure transporting and cyclic normal stress respectively for liquefaction under antinodes fig 6 displays the sketch of representative soil elements stress and strain under standing wave loads from fig 6 it can be known that the soil element only suffered the maximal shear stress at nodal section and the maximal or minimal normal stress at antinodal section the soil element between node and antinode experienced shear stress and normal stress simultaneously as talked in previous section the accumulated plastic volumetric strain induced by cyclic shear stress results in the pore pressure building up therefore the pore pressure will build up to some extent in the areas around the antinode in supplementary experiment two vertical sealed plastic plates were installed symmetrically just adjacent to the two sides of antinode respectively in order to inhibit the accumulated pore pressure transporting toward the antinode most possibly fig 7 the supplementary experiment was carried out in two layer seabed with total thickness of 50 cm consisting of the upper crust layer with thickness of 10 cm and the silt sublayer with thickness of 40 cm the soil properties are same as described in previous section the wave parameters are identical with test 6 the layout of pore pressure tranducers are shown in fig 7 b the results of pore pressure at the antinodal section are shown in fig 8 and the results that of test 6 were also plotted corresponding to the case of no vertical sealed plate compared with the case of no sealed plate the accumulated pore pressure decreased evidently such that the pore pressure never exceeded initial mean normal effective stress at the antinodal section and liquefaction could not take place even at the shallow depth of 0 05 m after installing vertical sealed plates the difference could be attributed to the setting of sealed plates which inhibited the accumulated pore pressure transported in the areas around the nodal section and spread out toward the antinodal section however although the sealed plate cut off the transporting of accumulated pore pressure from node to antinode the pore pressure still built up to some extent as mentioned previously the buildup of pore pressure is the result of accumulating of plastic volumetric strain therefore the soil at the antinodal section yields and the plastic volumetric strain accumulates under cyclic normal stress which called the soil yield under isotropic compression in general it can be concluded that the horizontal transporting of pore pressure and the accumulating of plastic volumetric strain induced by cyclic normal stress contribute to the buildup of pore pressure at the antinodal section simultaneously taking p res denotes the total accumulated pore pressure at the nodal section and p res1 denotes the accumulated pore pressure caused by horizontal transporting from nodes to antinodes and p res2 is the accumulated pore pressure induced by cyclic normal stress as discussed in the above section the p res p res1 and p res2 satisfy the relationship p res p res1 p res2 according to the previous studies done by mcdougal et al 1989 sumer et al 2011 and kirca et al 2013 the efficiency of pore pressure transporting is linked to the coefficient of consolidation c v the time corresponding to the pore pressure transporting from the node to the neighboring antinode δt can be calculated by the following equation 2 δ t x 2 2 c v where the x is the horizontal distance between the node and neighboring antinode the c v is 0 002 m2 s at the depth of 0 15 m and the δt calculated by equation 2 is about 30 6 s noteworthy is that kirca et al 2013 also used equation 2 to calculate δt but the calculating result is 1 6 times less than observed in the experiment in his experiments the vertical plate was placed in the soil midway between the nodal section and neighboring antinodal section so the discrepancy could be attributed to the shear stress in the generation of accumulated pore pressure over the entire areas between the vertical plate and neighboring antinode the distinction of this study is two vertical sealed plates were placed symmetrically just adjacent to the two sides of antinode respectively so it s reasonable to assume the plates cut off the horizontal transporting of pore pressure from neighboring areas possibly and the accumulated pore pressure under the antinodal section only induced by cyclic normal stress fig 9 displays the results of accumulated pore pressure at the depth of 1 5 m including the case of installing sealed plates and no plate as shown in fig 9 a the excess pore pressure at nodal section accumulated to the point a after wave loading 5 s then the pore pressure transported to neighboring antinodal section via 30 6 s i e the point b in fig 9 a the point b corresponded to the case of no plate so the accumulated pore pressure of point b consisted of p res1 and p res2 actually the p res2 can be acquired by the test with installing vertical sealed plate as described in the previous section i e the point c in fig 9 a and the p res1 can also be acquired by the value of point a minus point b defining the ratio of the accumulating excess pore pressure caused by horizontal transporting to the total accumulated excess pore pressure at the antinodal section as α1 p res1 p res and the ratio of the accumulated excess pore pressure induced by cyclic normal stress to the total accumulated excess pore pressure at the antinodal section as α2 p res2 p res from fig 9 it can be seen that the α1 α2 varied continuously with the buildup of excess pore pressure at 0 40 s and kept constant basically when the accumulated pore pressure reached a steady state such as 560 600 s in this experiment α1 52 6 and α2 47 4 with steady state at the depth of 0 15 m moreover it should be noted although the vertical sealed plate cut off the horizontal transporting of pore pressure the vertical accumulated pore pressure gradient also existed as mentioned in section 3 2 therefore the p res2 also presumably includes or excludes the component of transporting in vertical direction but the p res2 is only induced by cyclic normal stress at the antinodal section 4 numerical model 4 1 governing equations the force equilibrium equations based on biot s poroelastic theory biot 1941 1960 and hydraulic continuity equation derived by darcy s law darcy 1856 are used as the governing equations for the compressible soil skeleton and pore fluid respectively the governing equations in the x and z directions are as follows 3 g 2 u g 1 2 υ ε v x p t x 4 g 2 w g 1 2 υ ε v z p t z 5 2 p t γ n β k p t t γ w k ε v t 6 ε v u x w z 7 τ g u z w x where g is shear modulus u and w are horizontal and normal displacement respectively ε v is volumetric strain p t is the wave induced pore pressure β is compressibility coefficient of pore fluid which can be expressed as follows 8 β 1 k 1 s r p w where k is the bulk modulus of pore water p w is absolute static pressure s r is degree of saturation the magnitude of wave induced residual pore pressure can be calculated by the following governing equation proposed by jeng et al 2007 9 p r e s t c v 2 p r e s x 2 2 p r e s z 2 f where f is the source term c v is coefficient of consolidation defined as 10 c v g k γ 2 1 υ 1 2 υ 2 2 υ n g β based on the build up pattern of pore pressure u σ 0 u is pore pressure proposed by liu et al 2005 for silty and silty sand in yellow river of china the u σ 0 can be expressed as follows 11 u σ 0 n n l a b n n l a c where the initial mean normal effective stress σ 0 can be calculated by eq 1 n is the number of cyclic loading n l is the number of cycles to liquefaction a b and c are empirical coefficients in this study for silty sand a 0 25 b 1 0 c 1 2 for silty a 0 235 b 1 1 c 0 9 liu et al 2005 the n and n l can be calculated by the follow equations mcdougal et al 1989 12 n t t 13 n l 1 α r τ σ 0 1 β r where α r and β r are dimensionless coefficients in this study α r1 0 206 β r2 0 326 for upper crust layer α r1 0 221 β r2 0 312 for bottom layer sumer et al 2011 using equations 11 13 the source term f can be defined as 14 f u t u n n t a c σ 0 t a 1 t a n l a b t a t a n l a c 2 according to the standing wave theory the pressure induced by standing wave on the seabed surface is expressed by 15 p b p 0 cos k x cos ω t 16 p 0 γ h 2 cosh k d where h is wave height d is mean water depth k is wave number ω is wave frequency p 0 is the amplitude of the wave pressure 4 2 boundary conditions appropriate boundary conditions are indispensable so as to solve the above governing equations first of all at the seabed surface the effective normal stress and shear stress vanish the wave induced pore pressure equal to the wave pressure induced by standing wave the volumetric strain of soil skeleton is zero without the role of shear stress and normal stress so the residual pore pressure is zero 17 σ 0 τ 0 p t p b p r e s 0 second at the bottom of seabed the seabed is assumed to be rigid and impermeable and soil displacement and the normal gradients of pore pressures are zero 18 u w 0 p r e s z 0 furthermore the boundary conditions for two sides of seabed are regard as zero flux in addition the displacement pore pressure and stress are continuous at the interface between the upper layer and lower layer 19 u i u j w i w j p r e s i p r e s j k i p r e s i z k j p r e s j z σ i σ j τ i τ j where i and j denote the upper layer and lower layer seabed individually the seabed model were built with geometry partion in comsol then the govern equations eq 3 16 and boundary conditions eq 17 19 were input the partial differential equation modules after that the finite element method was used to solve the above equations 5 numerical results and discussion the present model was utilized for studying the seabed residual response and liquefaction induced by standing wave in this section the experimental results of this study and kirca et al 2013 were applied to validate the present model next a parametric study was conducted based on the present model firstly the effect of surface layer of seabed parameters for residual liquefaction was investigated including thickness and permeability of surface layer secondly the effect of two wave characteristics wave period and wave steepness on the residual liquefaction was discussed the parameters of wave and seabed for the first validation are same as described in section 2 2 the input parameters for the parametric study are listed in table 2 5 1 model validation the results of present model were compared with the experimental data of this study to validate the reliability of the numerical simulation the comparison were conducted against the experimental data at the node and antinode section respectively and the results is shown in fig 10 a fig 10 a reveals that the excess pore pressure builds up gradually with an increase of wave loading time the build up pattern of pore pressure calculated by the present model is basically consistent with experimental data of this study although the accumulated pore pressure in the present model is slightly smaller than those measured in the experiments at the antinode section in general the accumulated pore pressure calculated by the present model agrees well with experimental data of this study in addition the results of present model were also compared with the standing wave experiments conducted by kirca et al 2013 in the experiments the parameters for the seabed and standing wave are seabed depth h 20 cm permeability coefficient k 1 5 10 3 m s void ratio e 1 02 and poison s ratio μ 0 33 linear standing wave period t 1 09 s wavelength l 156 cm wave height h 10 5 cm and water depth d 30 cm fig 9 b shows a comparison between the simulated and measured results kirca et al 2013 at the location of x z 9 75 7 cm as fig 10b indicates the accumulated pore pressure calculated by the present model has good overall agreement with experimental data reported in kirca et al 2013 and this proves the present model is reasonable and reliable in dealing with pore pressure under standing waves 5 2 effects of upper crust layer thickness to further investigate the liquefaction under different thickness of upper crust layer three models of two layer seabed were built respectively according to the thickness of upper crust layer of 0 05 m 0 1 m and 0 2 m corresponding to h 1 h equaling 0 1 0 2 and 0 4 where h denoting the total thickness of seabed h 0 5 m moreover the simulation in the case of a single layer was also carried out as a control group fig 11 shows the distribution of accumulated excess pore pressure with different thickness of upper crust layer it was found that the maximum and minimum value of accumulated excess pore pressure occurred at the nodal and antinodal section respectively this is consistent with the experimental findings of this study specifically the location of the largest excess pore pressure advanced downwards with the increase of upper crust layer thickness for h 1 h 0 4 the largest excess pore pressure even appeared at the bottom of seabed fig 12 a b and c illustrate the time histories of excess pore pressure at different depths from fig 12 it can be known the excess pore pressure built up rapidly at initial stage of wave loading and reached a relative steady stage gradually after a while the whole tendency of present result is consistent with the findings of gatmiri 1992 hsu et al 1995 jeng 1997 2013 zhou et al 2011 on the other hand the increase of the thickness of the upper crust layer from h 1 h 0 to 0 1 0 2 and 0 4 lead to a significant decrease of accumulated excess pore pressure which indicating the accumulated excess pore pressure dissipated more readily in the case with a large upper crust layer in addition the time corresponding to the onset of liquefaction increased evidently with the increase of h 1 h and there was no liquefaction with the case of h 1 h 0 2 and 0 4 at the depth of 0 3 m it is believed that placing an upper crust layer with high permeability on the existing silt seabed may inhabit the liquefaction and mitigate liquefaction risk compared to that of original single layer seabed 5 3 effects of soil permeability besides the thickness of upper crust layer the soil permeability is also a key parameter for wave induced seabed residual response and liquefaction zhao et al 2017 zhao and jeng 2015 in this section three models with different soil permeability namely k s1 k s2 1 10 and 50 were proposed to study the residual liquefaction under standing waves as shown in fig 13 at the same depth the excess pore pressure built up to a large value as k s1 k s2 decreases whether it s node or antinode section what s more the value of excess pore pressure under antinode was less than that of antinode with same depth and this is consistent with the experimental results of this study zhao et al 2017 and sumer et al 2011 it should be noted that the distribution pattern of accumulated pore pressure versus depth was different between node and antinode section which may be attributed to the soil element suffering fully different stress path under standing wave at nodal and antinodal section respectively as described in section 3 4 the soil element only underwent cyclic shear stress at nodal section and cyclic normal stress at the antinodal section respectively and the horizontal transporting of pore pressure and the accumulating of plastic volumetric strain induced by cyclic normal stress contribute to the residual pore pressure at the antinodal section simultaneously from fig 13 it also can be found that liquefaction front advanced downwards with decrease of k s1 k s2 specifically when k s1 k s2 1 the liquefaction front arrived at the bottom of seabed the increase in liquefied depth is attributed to the decrease of k s1 which indicates the seabed residual liquefaction can be enhanced with poor drainage conditions in the upper layer 5 4 effects of wave characteristics in marine environment the wave conditions may vary significantly even in coastal sea areas and different wave characteristics will lead to the variability of the residual response of a seabed so it s a key topic to investigate the seabed residual response and liquefaction with different wave characteristics here the effects of two wave characteristics wave period t and wave steepness h l on the residual liquefaction under standing waves were examined as fig 14 illustrate the excess pore pressure and liquefaction depth increased as the wave period decreased compared to the case of t 2 s the maximum value of excess pore pressure was significantly higher for t 1 s this is because the excess pore pressure drain out more readily in the case with short wave period while based on the difference between t 2 s and t 3 s the effect of a short wave period t 2 s on the seabed residual response seem insignificant in addition noteworthy is that the variation of excess pore pressure was considerably larger in the upper crust layer at the nodal section than that in the lower layer but the opposite appeared at antinodal section the distribution of excess pore pressure versus relative depth z h for various wave steepness h l is shown in fig 15 fig 15 implies that the excess pore pressure and liquefaction depth increased significantly as wave steepness increases indicating that the standing waves with large wave steepness result in the excess pore pressure accumulate more substantially than that of small wave steepness and therefore liquefy deeper 6 conclusions the response of excess pore pressure in single layer and two layer seabed under standing waves were investigated by performing a series of wave flume tests and numerical solution with the present model respectively based on the experimental results the residual liquefaction mechanism at the antinodal section was analyzed the effects of the soil characteristics permeability thickness of upper crust layer and wave characteristics wave period wave steepness to residual liquefaction were acquired with the present numerical model the principal conclusion can be summarized as follows 1 the measured standing wave surface profile and pore pressure on the mudline show good agreement with the previous theoretical model which proves the experimental setup is capable to produce the objective standing waves accurately 2 compared with single layer seabed the value of the excess pore pressure in two layer seabed including upper crust layer with high permeability was lower and the time required to reach a maximum value was shorter 3 the liquefaction occurred before the excess pore pressure achieved the maximum and the liquefaction advanced downwards to maximal depth in which the dissipating velocity of excess pore pressure equaled the accumulating rate of plastic volumetric strain induced by standing wave loads 4 the horizontal transporting of pore pressure and the accumulating of plastic volumetric strain induced by cyclic normal stress contribute to the liquefaction at the antinodal section simultaneously in this experiment the former and latter contribute about 52 6 and 47 4 respectively for liquefaction with steady state at the depth of 0 15 m 5 the present numerical model was verified by comparing with experimental results the thinner upper crust layer the smaller k s1 k s2 k s2 1 2 10 6 m s the shorter wave period the higher wave steepness result in a deeper liquefaction depth additionally the wave period and wave steepness had a more significant effect for the upper crust layer than that the lower layer at the nodal section but the opposite trend appeared at antinodal section credit authorship contribution statement ruigeng hu conceptualization methodology software investigation validation writing original draft peng yu formal analysis investigation writing review editing zhaoyao wang investigation data curation wei shi resources supervision hongjun liu resources supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was financially supported by the funds for the national natural science foundation of china 41572247 
21326,in this paper a finite time extended state observer based nonsingular fast terminal sliding mode control nftsmc is proposed for the trajectory tracking of autonomous underwater vehicles auvs with various hydrodynamic uncertainties and external disturbances first a proportional integral velocity variable based third order fast finite time extended state observer is designed to estimate the lumped uncertainties and their first derivatives the concepts of finite time stability and a new proposition are utilized to prove the finite time uniformly ultimately boundness of the proposed observer then based on the disturbance estimation an nftsmc is developed for auvs the inverse tangent function and linear control term are used to provide robustness against estimation error and avoid chattering in the thrusters the position and attitude trajectories are proved to be fast finite time stable via the lyapunov theorem to verify the theoretical analysis comparative numerical simulations are provided to demonstrate the effectiveness of the proposed control scheme keywords autonomous underwater vehicles nonsingular fast terminal sliding mode control finite time observer trajectory tracking 1 introduction autonomous underwater vehicles auvs are widely used to accomplish numerous undersea operations such as monitoring and surveillance petroleum exploration underwater rescue marine meteorological observation deep sea archaeological research and oceanographic research paull et al 2014 jacobi 2015 yan et al 2019a kumar and rani 2020 to perform the above operations and acquire quality data the accurate trajectory tracking control of auvs is required since the auvs are always subject to highly nonlinear and strongly coupled dynamic model which operates in an uncertain oceanic environment and possess model uncertainties the conventional linear controllers may be unsuitable to cope with these problems the existence of such uncertainties and various environmental disturbances brings adverse effects on the attitude and position tracking performance rendering great challenges in the control design over the last decade various advanced approaches like sliding mode control smc yan and yu 2018 backstepping cho et al 2020 adaptive control hassanein et al 2016 model predictive control khan et al 2020 and disturbance observer based feedback control mukherjee et al 2015 have been proposed by the research community to achieve precise position control performance based on the convergence analysis these methods can be classified as exponential or asymptotic stable among these control methodologies smc has received considerable attention because of its remarkable features of strong robustness order reduction and design simplification utkin 1992 owing to these features smc was designed for underwater vehicles to compensate the external disturbances and hydrodynamic uncertainties yoerger and slotine 1991 huang and yang 2019 elmokadem et al 2016 yan et al 2019b the first experimental validation of adaptive smc was performed by yoerger and slotine 1991 for trajectory tracking control of auv and discuss their implementation issues in practical implementations smc suffers from unwanted chattering phenomenon due to a discontinuous feedback term in the control signal this switching action occurs at high frequency and may excite the unmodeled dynamics leading to frequent oscillations in the speed of the thrusters which result in large energy consumption and even may damage the thrusters huang and yang 2019 the chattering problem can be reduced by approximating the discontinuous terms by continuous functions like saturation function arctan function and hyperbolic tangent function huang and yang 2019 elmokadem et al 2016 labbadi and cherkaoui 2019a the traditional smc methods adopt the conventional linear switching surfaces and ensure the asymptotic convergence of attitude and position errors to equilibrium points finite time control is a particular case of the asymptotic tracking control and it can force the system trajectories to reach their equilibrium point in a finite time hu et al 2019 the fractional power terms in the finite time control law can accelerate the convergence rate of the states and improve the tracking precision terminal smc tsmc is an efficient control tool that can achieve finite time stability of a nonlinear uncertain system wu et al 1998 wang et al 2016 this control scheme has a fractional power of less than 1 with the merit of increasing the convergence speed near the equilibrium point based on the fast tsmc ftsmc yu and zhihong 2002 a new form of ftsmc has been adopted in yang and yang 2011 that contains an additional high order term and can accelerate the transient performance both near and far from the equilibrium point elmokadem et al 2017 proposed the tsmc and ftmsc for position tracking of underactuated auv these control schemes contain negative fractional power terms which may cause the problem of singularity around the equilibrium point feng et al 2002 labbadi and cherkaoui 2019b the authors in elmokadem et al 2017 also proposed a nonsingular tsmc ntsmc that evades the issue of singularity the upper bounds of the disturbances are required to be known in the control design and robustness is obtained by designing large switching gains which causes the chattering problem to further enhance the position tracking performance the concept of nonsingular ftsmc nftsmc was utilized in patre et al 2018 and yang et al 2019 for underwater vehicles the authors in patre et al 2018 integrated a nonlinear disturbance observer into the controller to avoid the use of large switching gains meanwhile the fuzzy logic tool is employed to model the discontinuous control term consequently attenuating the chattering the results are based on the assumption that the lumped disturbances are slow varying and their first derivatives are approximately zero in yang et al 2019 a sliding mode differentiator is employed to observe the exogenous disturbance and uncertain parameters it is worth mentioning that the observer based finite time controller is an effective approach to address the disturbance attenuation and chattering problem li et al 2019 propose robust fault tolerant control for a spacecraft system a nonsingular terminal sliding surface based finite time extended state observer eso is designed to estimate the lumped uncertainties the control algorithm is developed using ntsmc and super twisting methods the proposed scheme restrains the chattering problem in the control input and maintains tracking precision however lamraoui and qidan 2019 indicate that the higher order eso offers improved estimation performance as compared to conventional eso another weakness that needs to be perfected is that when the tracking errors are far from their equilibrium points the convergence rate of ntsmc is slower than conventional smc motivated by the above discussions this paper aims to investigate a finite time control scheme consisting of a fast finite time eso ffteso and nftsmc for a fully actuated auv inspired by the generalized eso geso in lamraoui and qidan 2019 and fteso in li et al 2019 a continuous third order ffteso is proposed to estimate the external disturbances and dynamic uncertainties the main contributions of the paper are listed as follows 1 a new proposition for the fast finite time uniformly ultimate boundedness is given and proven that will be used to facilitate the stability analysis of the ffteso 2 compared with li et al 2019 the designed observer can estimate the lumped disturbances and their first derivatives thus increases the estimation accuracy the fractional powers used in the ffteso maintains fast finite time convergence which is superior to exponential convergence rate of geso in lamraoui and qidan 2019 3 by integrating the nftsmc a fast control law is proposed unlike the existing tsm approaches patre et al 2018 li et al 2019 convergence rate of the sliding surface and position tracking errors is improved the gain requirement is very small as compared to conventional nftsmc to further reduce the chattering in the thrusters an inverse tangent function is used instead of discontinuous function and is combined with a linear control term the remainder of this paper is structured as follows section 2 presents notations used throughout the paper some useful lemmas and a new proposition the problem formulation including mathematical model of auv and control objective is described in section 3 in section 4 the main achievements of our research where a finite time disturbance observer is designed and analyzed section 5 details the nftsmc design and close loop stability in section 6 comparative simulations are carried out to validate the efficacy of the proposed scheme finally concluding remarks are given in section 7 2 notation and preliminaries 2 1 notations for a vector f r n f g f g sgn f where g is a positive constant sgn is the standard signum function and f g diag f 1 g f n g min i 1 n f i denotes the smallest element in f f is euclidean norm and is given by f f t f for a matrix f λ max f and λ min f denote the maximum and minimum eigenvalues respectively σ max f and σ min f denote the maximum and minimum singular values i n and 0 n represent identity and zero matrices of size n n 2 2 lemmas and new propositions consider the following nonlinear system 1 x f x t f 0 0 where x r n and f d 0 r n is continuous on an open neighborhood d 0 of the origin suppose that the system in 1 has a unique solution in forward time for all initial conditions x 0 lemma 1 yu et al 2005 and hu and jiang 2018 consider the above system 1 assume a positive definite lyapunov function v x which fulfills the following differential inequality v α v p 1 β v where α β 0 and p 1 0 1 let v 0 be the initial value of v then the states x t of the system 1 converges to zero from any initial value x 0 in finite time the settling time is bounded as t 1 β 1 p 1 ln α β v 0 1 p 1 α lemma 2 hu and jiang 2018 consider the system 1 and suppose there exist a lyapunov candidate function v x such that v x 0 if α β γ 0 θ 1 0 α and p 1 0 5 1 are positive constants and we have v α v p 1 β v γ v 1 2 0 then the system 1 is fast finite time uniformly ultimately bounded stable it implies that the trajectories x t converge to a stable region q x θ 1 v p 1 1 2 θ 2 v 1 2 γ in a finite time t 1 β θ 2 1 p 1 ln β θ 2 v 0 1 p 1 α θ 1 1 proposition 1 consider the system 1 and assume there exist a lyapunov candidate function v x starting from an arbitrary initial value denoted by v 0 let α 1 β γ 0 and p 1 p 2 0 5 1 be positive constants with p 1 p 2 and p 2 2 p 1 1 then the following statements hold 1 if the lyapunov function fulfills the differential inequality of the form v α v p 1 β v p 2 then origin of the system 1 is fast finite time stable it means the states x t converge to zero in the bounded finite time given by t β α 2 p 1 p 2 ln β α v 0 p 1 p 2 β v 0 p 1 p 2 α p 1 p 2 2 if the lyapunov function fulfills the differential inequality of the form v α v p 1 β v p 2 γ v 1 2 then the system 1 is fast finite time uniformly ultimately bounded it implies that the trajectory x t of the system 1 converges to a stable region q x θ 1 v p 1 1 2 θ 2 v p 2 1 2 γ in a finite time the bounded settling time is given as t β θ 2 α θ 1 2 p 1 p 2 ln β θ 2 α θ 1 v 0 p 1 p 2 β θ 2 v 0 p 1 p 2 α θ 1 p 1 p 2 where θ 1 0 α and θ 2 0 β are positive constants proof of 1 as the differential inequality in 1 satisfies the defined constraints on the design gains the system trajectories reach the origin within a finite time suppose t is a finite time at which the v x t 0 from an arbitrary initial value v x 0 v 0 the inequality in 1 can be expressed as 2 v 2 p 1 p 2 1 v α v p 1 p 2 β rearranging and integrating both sides of 2 one can obtain 3 t 0 v 0 v 2 p 1 p 2 1 α v p 1 p 2 β d v subsequently the settling time can be obtained as 4 t β α 2 p 1 p 2 ln β α v 0 p 1 p 2 β v 0 p 1 p 2 α p 1 p 2 proof of 2 the lyapunov differential inequality in 2 can be written as 5 v α θ 1 v p 1 β θ 2 v p 2 θ 1 v p 1 1 2 θ 2 v p 2 1 2 γ v 1 2 if θ 1 0 α θ 2 0 β and assume initially x q i e θ 1 v p 1 1 2 θ 2 v p 2 1 2 γ we can clearly see that v 0 it implies that v x is a progressively decreasing function starting from an arbitrary initial value v 0 further reducing v at some point we have θ 1 v p 1 1 2 θ 2 v p 2 1 2 γ then inequality 5 can be expressed as 6 v α θ 1 v p 1 β θ 2 v p 2 the above differential inequality has the same structure as in 1 of proposition 1 and the settling time can be obtained as 7 t β θ 2 α θ 1 2 p 1 p 2 ln β θ 2 α θ 1 v 0 p 1 p 2 β θ 2 v 0 p 1 p 2 α θ 1 p 1 p 2 we can conclude that for all the subsequent time the states x t of the system 1 do not escape the stable region q which completes the proof 3 auv modeling and problem formulation 3 1 auv kinematics the omni directional intelligent navigator odin is a spherical auv as illustrated in fig 1 which is equipped with eight thrusters and can perform the 3d spatial movement the motion of auv in three dimensional space can be described in the inertial frame for navigation and body fixed frame the velocity transformation relating the two coordinate systems can be expressed as fossen 2011 8 η r η ν where η x y z ϕ θ ψ t represents position and orientation of vehicle in inertial frame and ν u v w p q r t represent linear and angular velocities in body fixed frame the rotation matrix r η that describes the transformation between the inertial frame and body fixed frame which is related through the functions of euler angles is defined as 9 r η r 1 η 0 3 0 3 r 2 η where r 1 η and r 2 η are defined as follows r 1 η c ψ c θ s ψ c ϕ c ψ s θ s ϕ s ψ s ϕ c ψ c ϕ s θ s ψ c θ c ψ c ϕ s ψ s θ s ϕ c ψ s ϕ s ψ c ϕ s θ s θ c θ s ϕ c θ c ϕ r 2 η 1 s ϕ t θ c ϕ t θ 0 c ϕ s ϕ 0 s ϕ c θ c ϕ c θ here the symbols s c and t imply sin cos and tan respectively assumption 1 qiao et al 2017 the pitch angle θ is bounded such that θ max π 2 to avoid possible singularity problem in the rotation matrix r η remark 1 the rotation matrix and its inverse must exist note that r 2 η suffers from euler angle singularity for the pitch angle θ π 2 several ways of operation have been reported in the literature to avoid such singularity 1 during routine operations auvs are unlikely to enter the regions of θ π 2 due to metacentric restoring forces do and pan 2009 2 the desired trajectory for the pitch angle can be chosen that is sufficiently far from the singularity point qiao and zhang 2019a 3 the unit quaternion can be used to represent the vehicle attitude shihua li and zhang 2015 in this paper we have considered the first two modes of operation for fully actuated auv thus assumption 1 holds 3 2 auv dynamics using newton euler formulation the dynamics of auv in body fixed frame can be described as fossen 2011 10 m ν c ν ν d ν ν g η τ e x τ ν where m r 6 6 is the inertia matrix that include body mass and added mass c ν r 6 6 is a matrix describing centripetal and coriolis forces produced due to added inertia d ν r 6 6 denote the hydrodynamic damping matrix g η r 6 denotes the combined gravitational and buoyancy forces vector τ e x r 6 is the vector of unknown time varying environmental forces such as waves and ocean current and τ ν r 6 is the vector of control moments and forces these hydrodynamic parameters are slightly uncertain from those obtained by experiments because of the real sea environment therefore the parameter accuracy cannot be guaranteed and it is necessary to make the following assumption assumption 2 the parameters mentioned in 10 can be expressed as x x 0 δ x for x c d g where the terms x 0 and δ x denotes the nominal values and parametric uncertainties in auv model respectively remark 2 in practical control systems the parameters of a system may not be precisely known and may exhibit perturbations because of the modeling errors hydrodynamic uncertainties and exogenous disturbances the auv possesses uncertainties the actual values of hydrodynamic coefficients are split into nominal terms and uncertain terms in this work the nominal terms are precisely known to us while the uncertain parts are unknown using the above remarks and assumption 2 10 can be rewritten as 11 m ν c 0 ν ν d 0 ν ν g 0 η τ d τ ν where τ d represent the lumped uncertain forces that include exogenous disturbances and parametric perturbations and is defined as 12 τ d δ c ν ν δ d ν ν δ g η τ e x by substituting 8 in 11 followed by assumption 1 and the first time derivative of r η exist the dynamic equation of motion of the auv with respect to the inertial frame can be expressed as 13 m η η η c η 0 ν η η d η 0 ν η η g η 0 η τ d η τ η where 14 m η η r t η m r 1 η c η ν η r t η c 0 ν m r 1 η r η r 1 η d η ν η r t η d 0 ν r 1 η g η η r t η g 0 η τ η r t τ ν τ d η r t τ d based on realistic assumption 2 we can make the following assumption assumption 3 the model uncertainties in assumption 2 i e δ x for x c d g are unknown and bounded there exist two positive constants x m and x n so that x n δ x x m hence keeping assumptions 1 and 2 in mind the lumped disturbances vector in expression 12 is also bounded and is given by τ d i τ d i 3 3 thrust forces distribution the propulsion system of the odin consists of four horizontal and four vertical thrusters as shown in fig 2 the control input forces vector in 10 acting in each degree of freedom are jointly produced by the propulsion of the individual mounted thrusters the horizontal thrusters produce forces in the surge sway and yaw directions and the vertical thrusters produce forces in heave roll and yaw directions the relationship can be described as 15 τ ν e u where u r 8 is the vector of thrust forces produced by each propeller the thrust force allocation matrix e r 6 8 is taken from podder and sarkar 2001 in practical applications the thrust force saturation should be considered for normal operation of auv as mentioned in qiao and zhang 2019b the lumped disturbances and desired position trajectories two factors responsible for thrust saturation in this paper as in sarkar et al 2002 the thrust force limits for vertical and horizontal propellers are taken as 50 n and 150 n respectively 3 4 control objectives as depicted in 12 the auv suffers from external disturbances and hydrodynamic uncertainties the first objective of our paper is to design a ffteso to estimate the lumped uncertainties the next objective is to design a finite time robust control law and to incorporate the ffteso to track the reference position trajectories 4 fast finite time extended state observer in this section a novel ffteso is designed to reconstruct the lumped disturbance in auv in finite time 4 1 design of ffteso first of all define proportional integral velocity variables as 16 σ ν m ν ν where σ ν σ 11 σ 12 t is a vector of auxiliary variables by proceeding with differentiation of eqs 16 along 11 it yields 17 σ ν ν c 0 ν ν d 0 ν ν g 0 η τ ν τ d ν for the sake of simplicity denote a ν η ν c 0 ν ν d 0 ν ν g 0 η and considering the importance of extended state observer in estimating the lumped disturbances we defined a new variable ξ 1 σ ν the order of the system will be expanded by one additional state variables instead of the traditional one state extension ξ 2 ξ 3 using the above mentioned notation the extended dynamic equations are given by 18 ξ 1 a ν η τ ν ξ 2 ξ 2 ξ 3 ξ 3 ϖ the third order ffteso can be designed as 19 ξ ˆ 1 a ν η τ ξ ˆ 2 ε 1 ξ ˆ 1 ξ 1 β 1 ξ ˆ 1 ξ 1 ξ ˆ 2 ξ ˆ 3 ε 2 ξ ˆ 1 ξ 1 β 2 2 ξ ˆ 1 ξ 1 β 1 ξ ˆ 1 ξ 1 ξ ˆ 3 ε 3 ξ ˆ 1 ξ 1 β 3 2 ξ ˆ 1 ξ 1 β 2 ξ ˆ 1 ξ 1 β 1 where ξ ˆ 1 ξ ˆ 2 and ξ ˆ 3 are the estimates of ξ 1 ξ 2 and ξ 3 in the extended system respectively ε i c i ω and β i i β o i 1 i 1 2 3 are the observer gains to be designed satisfying c i 0 2 3 β o 1 and ω is a diagonal positive definite matrix assumption 4 the lumped uncertain term ξ 2 in 18 is unknown bounded and continuously differentiable the second derivative satisfies ϖ ϖ where ϖ is a vector of maximum value of ϖ 4 2 convergence analysis of ffteso the stability and convergence of the proposed observer 19 is stated as the following theorem theorem 1 under the assumption 4 if the ffteso is designed as in 19 for the system 18 satisfying the constraints on the observer gains the variables ξ 1 ξ 2 and ξ 3 will be estimated in a finite time t f proof of theorem 1 let z i ξ ˆ i ξ i for i 1 2 3 be the estimation error the error system of ffteso can be written as 20 z 1 z 2 ε 1 z 1 β 1 z 1 z 2 z 3 ε 2 z 1 β 2 2 z 1 β 1 z 1 z 3 ε 3 z 1 β 3 2 z 1 β 2 z 1 β 1 ϖ consider a lyapunov candidate function as v z ξ t p ξ where ξ z 1 β 1 z 1 t z 2 t z 3 t t is introduced as a new error variable and p is a positive definite symmetric matrix taking time derivative of ξ invoking 20 yields 21 ξ β 1 z 1 β 1 1 z 2 ε 1 z 1 β 1 z 1 z 3 2 ε 2 z 1 β 2 z 1 β 1 ε 3 z 1 β 3 z 1 β 2 z 2 ε 1 z 1 β 1 z 1 z 3 2 ε 2 z 1 β 1 z 1 ε 3 z 1 β 2 z 1 β 1 0 6 0 6 ϖ diag z 1 β 1 1 z 1 β 1 1 z 1 β 1 1 a 1 ξ a 2 ξ ω where ω 0 6 0 6 ϖ t and state dependent matrices which are given by 22 a 1 β 1 ε 1 β 1 i 6 0 6 ε 2 0 6 ρ 1 1 2 ε 3 ρ 1 0 6 0 6 a 2 ε 1 i 6 0 6 ε 2 0 6 i 6 2 ε 3 ρ 1 0 6 0 6 with ρ 1 z 1 β 1 1 0 since 2 3 β 1 1 the characteristic polynomials of 22 shows that if the observer gains are set as ε 1 ε 2 ε 3 0 then all the eigenvalues of a 1 and a 2 lies in the left half plane thus the system 21 is stable according to hurwitz the lyapunov function v z is continuously differentiable everywhere except z 1 0 moreover the error trajectories of system 20 reaches the neighborhood of origin and stay thereafter thus the time derivative of lyapunov candidate function is given as 23 v z ξ t diag ρ 1 ρ 1 ρ 1 a 1 t p p a 1 ξ ξ t a 2 t p p a 2 ξ 2 ω t p ξ since a 1 and a 2 are negative definite matrix and p is a symmetric as well as positive definite matrix satisfying the following lyapunov equations 24 a j t p p a j q j for j 1 2 where q j is symmetric positive definite matrix which is generally taken as the identity matrix recalling the assumption 4 one can obtain ω 6 ϖ using 24 the expression 23 can be written as 25 v z ξ t diag ρ 1 ρ 1 ρ 1 q 1 ξ ξ t q 2 ξ 2 ω t p ξ ρ min λ min q 1 ξ 2 λ min q 2 ξ 2 2 6 ϖ p ξ where ρ min min ρ 11 ρ 16 the state dependent matrices in 22 can be decomposed as 26 a 1 h 1 h 2 a 2 h 1 h 3 where h 1 i 6 0 6 0 6 0 6 i 6 0 6 0 6 0 6 ρ 1 h 2 β 1 ε 1 β 1 i 6 0 6 ε 2 0 6 ρ 1 1 2 ε 3 0 6 0 6 and h 3 ε 1 i 6 0 6 ε 2 0 6 i 6 2 ε 3 0 6 0 6 as h 1 is a diagonal matrices and ρ 1 0 is a decreasing function of z 1 since 2 3 β 1 1 one can obtain 27 σ min h 1 1 max z 1 1 ρ min max z 1 1 as q 1 and q 2 are symmetric positive definite matrices then σ min q j λ min q j σ max q j holds using 26 the inequality for lyapunov equation 24 can be expressed as 28 λ min q j 2 σ min p σ min h 1 σ min h j 1 given that ρ min z 1 β 1 1 ξ 1 1 β 1 and if max z 1 1 resulting ξ 1 the inequality 25 becomes 29 v z 2 ρ min 2 σ min p σ min h 2 ξ 2 2 ρ min σ min p σ min h 3 ξ 2 2 6 ϖ p ξ 2 σ min p σ min h 2 ξ 4 2 β 1 2 σ min p σ min h 3 ξ 3 1 β 1 2 6 ϖ p ξ 2 σ min p σ min h 2 λ max p 1 β 1 2 v 2 1 β 1 2 σ min p σ min h 3 λ max p 1 2 β 1 3 2 v 3 2 1 2 β 1 2 6 ϖ p λ max p 1 2 v 1 2 λ 1 v 2 1 β 1 λ 2 v 3 2 1 2 β 1 λ 3 v 1 2 where λ 1 2 σ min p σ min h 2 λ max p 1 β 1 2 λ 2 2 σ min p σ min h 3 λ max p 1 2 β 1 3 2 and λ 3 2 6 ϖ p λ max p 1 2 according to 2 of proposition 1 the system 20 will converge into a stable region subsequently z 1 1 the settling time and stable region are given by 30 and 31 30 t 1 2 β 1 λ 1 λ 1 ln λ 1 λ 1 λ 2 λ 2 v z 0 1 2 β 1 1 2 λ 1 λ 1 λ 2 λ 2 2 1 β 1 2 β 1 v z 0 1 2 β 1 1 2 λ 2 λ 2 1 β 1 31 x 1 z λ 2 v 1 1 2 β 1 λ 1 v 3 2 1 β 1 λ 3 where λ 1 0 λ 1 and λ 2 0 λ 2 are arbitrary constants once the system enters region where max z 1 1 then using 27 and 28 the inequality 25 becomes 32 v z 2 ρ min σ min p σ min h 2 ξ 2 2 σ min p σ min h 3 ξ 2 2 6 ϖ p ξ 2 σ min p σ min h 2 ξ 3 1 β 1 2 σ min p σ min h 2 ξ 2 2 6 ϖ p ξ λ 4 v 3 2 1 2 β 1 λ 5 v λ 3 v 1 2 where λ 4 2 σ min p σ min h 2 λ max p 1 2 β 1 3 2 and λ 5 2 σ min p σ min h 2 λ max p 1 according to lemma 2 the error trajectories of the proposed ffteso 20 are uniformly ultimately bounded stable the bounded settling time is 33 t 2 2 β 1 λ 5 λ 5 1 β 1 ln λ 5 λ 5 v z t 1 1 2 β 1 1 2 λ 4 λ 4 1 the observation errors decreases with time and finally enters the domain 34 x 2 z λ 4 v 1 1 2 β 1 λ 5 v 1 2 λ 3 in a finite time t f t 1 t 2 remark 3 compared with an fteso in li et al 2019 the structure of the ffteso 19 developed in this section consider the dynamics of the disturbances to achieve high estimation accuracy the proposed observer guarantees finite time convergence and can provide more accurate performance with small oscillations compared with the geso in lamraoui and qidan 2019 5 nftsmc design in this section an nftsmc is designed to control the fully actuated auv in the presence of hydrodynamic uncertainties and external disturbances to cope with the unknown lumped disturbances we have designed an ffteso 19 in section 2 that provides its real time estimation the prime control objective is to design a ffteso based nftsmc algorithm that ensures the actual position and attitude trajectories of auv to track the desired trajectories η d in finite time let η η η d represents the tracking error a non singular fast terminal sliding surface nftss labbadi and cherkaoui 2020 for an auv moving in 6 degree of freedom can be defined as 35 s η α η g h β η a b here α diag α 1 α 6 and β diag β 1 β 6 where α i and β i for i 1 6 are positive constants a b and g h are positive odd integers which satisfy the conditions 1 a b 2 and g h a b when η is far from the equilibrium point the term α η g h plays dominant role in the fast convergence rate of η boukattaya et al 2018 once η stays close to the origin then 35 provides same convergence of η as ntsmc manifold in elmokadem et al 2017 taking time derivative of 35 and using 13 yields the following 36 s η g α h η g h 1 η a β b η a b 1 m η η 1 c η 0 ν η η d η 0 ν η η g η 0 η τ d η τ η η d to achieve sufficient condition for the stability of nftss a finite time control law can be designed as 37 τ η τ e τ s where τ e and τ s represents the equivalent continuous control law and switching control law and are defined as follows 38 τ e c η 0 ν η η d η 0 ν η η g η 0 η r t ξ ˆ 2 m η η η d b a β 1 η 2 a b b g a h β 1 α η g h 1 η 2 a b k 1 s 39 τ s m η η k 2 sgn s where k 1 diag k 11 k 16 and k 2 diag k 21 k 26 k 1 i k 2 i 0 i 1 6 denotes the continuous and switching control gains to be designed the equivalent continuous controller 38 contain model information this control law is responsible to realize the desired dynamics for the nominal model of the vehicle due to model uncertainties and time varying external disturbances the switching control term is used to offset the difference between the desired and actual dynamics however sgn is a discontinuous function and cause chattering problem in practice the term k 1 s in 38 is introduced to alleviate the chattering problem by making it possible to use smaller switching gain k 2 incorporating 37 in 36 leads to the following form 40 s a β b η a b 1 m η 1 η r t z 2 k 1 s k 2 sgn s remark 4 the expression 40 shows that a strong reachability law has been considered in this paper to guarantee the stability the continuous and switching gains are designed as k 1 i 0 and k 2 i 0 respectively since the lumped disturbance has been precisely estimated by the fteso the estimation error z 2 which converges to a stable region x 2 see theorem 1 the magnitude of z 2 is much smaller than the magnitude of the disturbance τ d for all the subsequent time t t f hence the gains of the proposed controller can be designed much smaller as compared to the control method in elmokadem et al 2017 and chattering can be reduced to some extent 5 1 stability analysis theorem 2 if the nftss is chosen according to 35 and ffteso 19 based controller 37 is designed for uncertain auv dynamic system 13 then all the position and attitude error trajectories converge to zero in finite time proof of theorem 2 consider a new lyapunov candidate function is formed as v c i 1 2 s i 2 i 1 6 its time derivative along 40 and denoting f η t m η 1 η r t η z 2 takes the following structure 41 v c i s i a β i b η i a b 1 f i η t k 1 i s i k 2 i sgn s i according to theorem 1 z 2 converges to stable region x 2 in a finite time t f hence we can assume the f i η t is also bounded such that there exist a small positive constant δ f i such that f i η t δ f i using the above assumption 41 can be written as 42 v c i a β i b η i a b 1 k 2 i δ f i s i k 1 i s i 2 since 1 a b 2 when s 0 we have η i a b 1 0 for η i 0 the performance of control law 37 can be adjusted by selecting k 1 and k 2 from 42 for greater values of k 1 i and k 2 i in the feedback the sliding mode enforcement is more faster at the cost of high thrust forces which may leads to violate the saturation limits to maintain the thrust forces within the saturation limits defined in sarkar et al 2002 the feedback gains must satisfy the design conditions k 1 i 0 and k 2 i δ f i δ i where δ i is small positive constant this makes v c i negative definite and provides sufficient condition for the stability of nftss let γ i a β i b η i a b 1 λ 1 i 2 γ i k 1 i and λ 2 i 2 γ i δ i then we can write the differential inequality 42 as 43 v c i λ 1 i v c i λ 2 i v c i 1 2 the above differential inequality has the same form as that in lemma 1 which implies that the fast enforcement of sliding mode is guaranteed and it can be confirmed that position error trajectories of the vehicle will reach the sliding mode s 0 within a finite time given by the following equation 44 t s i 2 λ 1 i l n λ 1 i v c i t 0 1 2 λ 2 i λ 2 i therefore the designed control input satisfies 43 and keep the surface variable s i at zero for t t s i once the sliding mode occurs eq 35 can be written as 45 η i α η i g h β η i a b 0 on the nftss s i 0 the time taken to travel from η t s i 0 to η t s i t η i 0 is finite and is given by 46 t η i a β i b a a b η i t s i 1 b a f b a h a b a g h a g b h a g h α i ζ i where ζ i η i t s i g h 1 and f represent hyper geometric function abramowitz and stegun 1972 remark 5 as mention in remark 4 that the linear gain helps to reduce the chattering in control input the control law 39 provides robustness but brings an adverse effect of chattering to further reduce the chattering phenomenon the signum function can be replaced by a continuous switching function in this paper the inverse tangent function is used as a switching control law 47 τ s 2 π m η η k 2 atan s γ where s γ s 1 γ s 6 γ γ 0 represent boundary layer thickness remark 6 the linear control term k 1 i s i forces the error trajectories to approach the switching manifold faster which is also indicated as proof in 44 when the terminal sliding mode is achieved we have 48 η i η i α i η i g h β i b a the differential equation 48 ensures fast convergence of the position error trajectories to the equilibrium point as depicted in 46 6 results and discussion to validate the efficiency of the proposed fftseo based nftsmc the simulations will be carried on a realistic model of odin auv operating under environmental disturbance and parametric uncertainties the detailed parameters of the vehicle used in this paper are obtained from qiao and zhang 2019a to reflect the uncertainties in the vehicle dynamics 20 of the actual parameter s inaccuracy is considered in the simulations the time varying environmental disturbances are given by 49 τ e x 1 2 3 sin 0 2 t n τ e x 2 3 sin 0 3 t n τ e x 3 4 sin 0 1 t n τ e x 4 2 c o s 0 1 t n m τ e x 5 1 cos 0 2 t n m τ e x 5 2 2 cos 0 3 t n m the design parameters of the ffteso 19 are chosen as β o 0 7 ε 1 5 ω ε 2 30 ω and ε 3 30 ω where ω diag 6 6 6 3 3 3 the control gains in 37 are adjusted as a 5 b 3 g 7 h 3 β d i a g 2 2 2 5 2 5 2 5 3 α i 6 6 k 2 d i a g 0 5 0 2 0 3 0 15 0 15 0 2 and k 1 0 008 i 6 6 for the switching control terms 47 the thickness of boundary layer γ 0 01 the initial position of odin is assumed η 0 1 5 1 5 1 0 5 0 8 1 2 t and the initial velocities are set at zero the desired trajectory vector for the odin which refer to qiao and zhang 2019a are given by 50 x d sin 0 2 t m y d cos 0 2 t m z d 0 1 t 2 m ϕ d 0 rad θ d a t a n 1 2 rad ψ d 0 2 t rad according to the remark 1 the desired pitch angle θ d is far from the π 2 rad which avoids the kinematic singularity during motion of the odin to verify the performance of the proposed observer 19 comparative simulations with the fteso 51 in li et al 2019 and geso 52 in lamraoui and qidan 2019 are carried out the disturbance estimation errors are plotted in fig 3 to illustrate the transient and steady state responses table 1 presents their quantitative analysis in terms of the settling time and estimation error it is quite clear from fig 3 that the performance of the proposed ffteso is superior than fteso 51 and geso 52 51 ξ ˆ 1 a ν η τ ξ ˆ 2 ε 1 z 1 β 1 z 1 ξ ˆ 2 ε 2 z 1 β 2 2 z 1 β 1 z 1 52 ξ ˆ 1 a ν η τ ξ ˆ 2 ε 1 z 1 ξ ˆ 2 ξ ˆ 3 ε 2 z 1 ξ ˆ 3 ε 3 z 1 for comparison of the trajectory tracking performance of the developed ffteso ntsmc a similar order geso is combined with nsftsmc noted as geso nsftsmc the linear gains matrix of geso nftsmc is adjusted at zero while the rest of the parameters are selected same as that of the proposed scheme the simulation results of both the controllers are shown in fig 4 fig 4 a shows the trajectories tracking of odin in 3 dimensional space figs 4 b to 4 d depicts the tracking performance given by the two control schemes in x y x z and y z planes the corresponding position and attitude errors are shown in fig 5 it can be seen from figs 4 and 5 that both the controllers exhibit finite time stability however there are two major factors that increase the convergence rate and increases the tracking precision of the ffteso nftsmc first the ffteso updates the control law by providing more accurate information of the disturbances than geso as depicted in fig 3 and also analytically predicted by remark 4 second the linear gains exhibit strong reachability during the reaching phase which is also indicated as proof in 43 for the clarity of the results the analysis of both controllers is given in table 2 the thrust forces generated by each thruster of the odin are shown in fig 6 thrusts 1 4 denote the force produced by the horizontal and thrusts 5 8 denotes thrust forces produced by vertical thrusters the plotted forces clearly demonstrate that all the thrusters do not violate the thrust saturation limits defined in sarkar et al 2002 as predicted by remarks 4 and 5 the combination of linear control term k 1 s and switching function 47 in ffteso nftsmc avoids the chattering problem in thrusters as shown in the zoom view of fig 6 7 conclusion in this paper a novel ffteso based nfstmc is proposed for auvs which achieves fast finite time stability in the presence of the model uncertainties and external disturbances we propose an ffteso to estimate the lumped disturbances in a finite time with proper parameters by comparing with the geso and fteso the proposed observer can achieve faster and accurate performance the estimates of the disturbances are used as compensation in the designed nftsmc to achieve robustness the gains of the inverse tangent function are required to be greater than estimation errors meanwhile a linear term is contained in the control input to further alleviate chatter in the thrusters and ensures fast convergence of the position error trajectories to the nftss as shown in the simulation results the proposed control scheme provides better response than geso nftsmc the extension of the finite time controller based on event triggered fteso for underactuated auvs with small delays will be presented in the future work credit authorship contribution statement nihad ali conceptualization methodology software writing original draft investigation writing review editing isaac tawiah validation investigation writing review editing weidong zhang supervision resources funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this paper is partly supported by the national science foundation of china 61473183 u1509211 61627810 and national key r d program of china 2017yfe0128500 
21326,in this paper a finite time extended state observer based nonsingular fast terminal sliding mode control nftsmc is proposed for the trajectory tracking of autonomous underwater vehicles auvs with various hydrodynamic uncertainties and external disturbances first a proportional integral velocity variable based third order fast finite time extended state observer is designed to estimate the lumped uncertainties and their first derivatives the concepts of finite time stability and a new proposition are utilized to prove the finite time uniformly ultimately boundness of the proposed observer then based on the disturbance estimation an nftsmc is developed for auvs the inverse tangent function and linear control term are used to provide robustness against estimation error and avoid chattering in the thrusters the position and attitude trajectories are proved to be fast finite time stable via the lyapunov theorem to verify the theoretical analysis comparative numerical simulations are provided to demonstrate the effectiveness of the proposed control scheme keywords autonomous underwater vehicles nonsingular fast terminal sliding mode control finite time observer trajectory tracking 1 introduction autonomous underwater vehicles auvs are widely used to accomplish numerous undersea operations such as monitoring and surveillance petroleum exploration underwater rescue marine meteorological observation deep sea archaeological research and oceanographic research paull et al 2014 jacobi 2015 yan et al 2019a kumar and rani 2020 to perform the above operations and acquire quality data the accurate trajectory tracking control of auvs is required since the auvs are always subject to highly nonlinear and strongly coupled dynamic model which operates in an uncertain oceanic environment and possess model uncertainties the conventional linear controllers may be unsuitable to cope with these problems the existence of such uncertainties and various environmental disturbances brings adverse effects on the attitude and position tracking performance rendering great challenges in the control design over the last decade various advanced approaches like sliding mode control smc yan and yu 2018 backstepping cho et al 2020 adaptive control hassanein et al 2016 model predictive control khan et al 2020 and disturbance observer based feedback control mukherjee et al 2015 have been proposed by the research community to achieve precise position control performance based on the convergence analysis these methods can be classified as exponential or asymptotic stable among these control methodologies smc has received considerable attention because of its remarkable features of strong robustness order reduction and design simplification utkin 1992 owing to these features smc was designed for underwater vehicles to compensate the external disturbances and hydrodynamic uncertainties yoerger and slotine 1991 huang and yang 2019 elmokadem et al 2016 yan et al 2019b the first experimental validation of adaptive smc was performed by yoerger and slotine 1991 for trajectory tracking control of auv and discuss their implementation issues in practical implementations smc suffers from unwanted chattering phenomenon due to a discontinuous feedback term in the control signal this switching action occurs at high frequency and may excite the unmodeled dynamics leading to frequent oscillations in the speed of the thrusters which result in large energy consumption and even may damage the thrusters huang and yang 2019 the chattering problem can be reduced by approximating the discontinuous terms by continuous functions like saturation function arctan function and hyperbolic tangent function huang and yang 2019 elmokadem et al 2016 labbadi and cherkaoui 2019a the traditional smc methods adopt the conventional linear switching surfaces and ensure the asymptotic convergence of attitude and position errors to equilibrium points finite time control is a particular case of the asymptotic tracking control and it can force the system trajectories to reach their equilibrium point in a finite time hu et al 2019 the fractional power terms in the finite time control law can accelerate the convergence rate of the states and improve the tracking precision terminal smc tsmc is an efficient control tool that can achieve finite time stability of a nonlinear uncertain system wu et al 1998 wang et al 2016 this control scheme has a fractional power of less than 1 with the merit of increasing the convergence speed near the equilibrium point based on the fast tsmc ftsmc yu and zhihong 2002 a new form of ftsmc has been adopted in yang and yang 2011 that contains an additional high order term and can accelerate the transient performance both near and far from the equilibrium point elmokadem et al 2017 proposed the tsmc and ftmsc for position tracking of underactuated auv these control schemes contain negative fractional power terms which may cause the problem of singularity around the equilibrium point feng et al 2002 labbadi and cherkaoui 2019b the authors in elmokadem et al 2017 also proposed a nonsingular tsmc ntsmc that evades the issue of singularity the upper bounds of the disturbances are required to be known in the control design and robustness is obtained by designing large switching gains which causes the chattering problem to further enhance the position tracking performance the concept of nonsingular ftsmc nftsmc was utilized in patre et al 2018 and yang et al 2019 for underwater vehicles the authors in patre et al 2018 integrated a nonlinear disturbance observer into the controller to avoid the use of large switching gains meanwhile the fuzzy logic tool is employed to model the discontinuous control term consequently attenuating the chattering the results are based on the assumption that the lumped disturbances are slow varying and their first derivatives are approximately zero in yang et al 2019 a sliding mode differentiator is employed to observe the exogenous disturbance and uncertain parameters it is worth mentioning that the observer based finite time controller is an effective approach to address the disturbance attenuation and chattering problem li et al 2019 propose robust fault tolerant control for a spacecraft system a nonsingular terminal sliding surface based finite time extended state observer eso is designed to estimate the lumped uncertainties the control algorithm is developed using ntsmc and super twisting methods the proposed scheme restrains the chattering problem in the control input and maintains tracking precision however lamraoui and qidan 2019 indicate that the higher order eso offers improved estimation performance as compared to conventional eso another weakness that needs to be perfected is that when the tracking errors are far from their equilibrium points the convergence rate of ntsmc is slower than conventional smc motivated by the above discussions this paper aims to investigate a finite time control scheme consisting of a fast finite time eso ffteso and nftsmc for a fully actuated auv inspired by the generalized eso geso in lamraoui and qidan 2019 and fteso in li et al 2019 a continuous third order ffteso is proposed to estimate the external disturbances and dynamic uncertainties the main contributions of the paper are listed as follows 1 a new proposition for the fast finite time uniformly ultimate boundedness is given and proven that will be used to facilitate the stability analysis of the ffteso 2 compared with li et al 2019 the designed observer can estimate the lumped disturbances and their first derivatives thus increases the estimation accuracy the fractional powers used in the ffteso maintains fast finite time convergence which is superior to exponential convergence rate of geso in lamraoui and qidan 2019 3 by integrating the nftsmc a fast control law is proposed unlike the existing tsm approaches patre et al 2018 li et al 2019 convergence rate of the sliding surface and position tracking errors is improved the gain requirement is very small as compared to conventional nftsmc to further reduce the chattering in the thrusters an inverse tangent function is used instead of discontinuous function and is combined with a linear control term the remainder of this paper is structured as follows section 2 presents notations used throughout the paper some useful lemmas and a new proposition the problem formulation including mathematical model of auv and control objective is described in section 3 in section 4 the main achievements of our research where a finite time disturbance observer is designed and analyzed section 5 details the nftsmc design and close loop stability in section 6 comparative simulations are carried out to validate the efficacy of the proposed scheme finally concluding remarks are given in section 7 2 notation and preliminaries 2 1 notations for a vector f r n f g f g sgn f where g is a positive constant sgn is the standard signum function and f g diag f 1 g f n g min i 1 n f i denotes the smallest element in f f is euclidean norm and is given by f f t f for a matrix f λ max f and λ min f denote the maximum and minimum eigenvalues respectively σ max f and σ min f denote the maximum and minimum singular values i n and 0 n represent identity and zero matrices of size n n 2 2 lemmas and new propositions consider the following nonlinear system 1 x f x t f 0 0 where x r n and f d 0 r n is continuous on an open neighborhood d 0 of the origin suppose that the system in 1 has a unique solution in forward time for all initial conditions x 0 lemma 1 yu et al 2005 and hu and jiang 2018 consider the above system 1 assume a positive definite lyapunov function v x which fulfills the following differential inequality v α v p 1 β v where α β 0 and p 1 0 1 let v 0 be the initial value of v then the states x t of the system 1 converges to zero from any initial value x 0 in finite time the settling time is bounded as t 1 β 1 p 1 ln α β v 0 1 p 1 α lemma 2 hu and jiang 2018 consider the system 1 and suppose there exist a lyapunov candidate function v x such that v x 0 if α β γ 0 θ 1 0 α and p 1 0 5 1 are positive constants and we have v α v p 1 β v γ v 1 2 0 then the system 1 is fast finite time uniformly ultimately bounded stable it implies that the trajectories x t converge to a stable region q x θ 1 v p 1 1 2 θ 2 v 1 2 γ in a finite time t 1 β θ 2 1 p 1 ln β θ 2 v 0 1 p 1 α θ 1 1 proposition 1 consider the system 1 and assume there exist a lyapunov candidate function v x starting from an arbitrary initial value denoted by v 0 let α 1 β γ 0 and p 1 p 2 0 5 1 be positive constants with p 1 p 2 and p 2 2 p 1 1 then the following statements hold 1 if the lyapunov function fulfills the differential inequality of the form v α v p 1 β v p 2 then origin of the system 1 is fast finite time stable it means the states x t converge to zero in the bounded finite time given by t β α 2 p 1 p 2 ln β α v 0 p 1 p 2 β v 0 p 1 p 2 α p 1 p 2 2 if the lyapunov function fulfills the differential inequality of the form v α v p 1 β v p 2 γ v 1 2 then the system 1 is fast finite time uniformly ultimately bounded it implies that the trajectory x t of the system 1 converges to a stable region q x θ 1 v p 1 1 2 θ 2 v p 2 1 2 γ in a finite time the bounded settling time is given as t β θ 2 α θ 1 2 p 1 p 2 ln β θ 2 α θ 1 v 0 p 1 p 2 β θ 2 v 0 p 1 p 2 α θ 1 p 1 p 2 where θ 1 0 α and θ 2 0 β are positive constants proof of 1 as the differential inequality in 1 satisfies the defined constraints on the design gains the system trajectories reach the origin within a finite time suppose t is a finite time at which the v x t 0 from an arbitrary initial value v x 0 v 0 the inequality in 1 can be expressed as 2 v 2 p 1 p 2 1 v α v p 1 p 2 β rearranging and integrating both sides of 2 one can obtain 3 t 0 v 0 v 2 p 1 p 2 1 α v p 1 p 2 β d v subsequently the settling time can be obtained as 4 t β α 2 p 1 p 2 ln β α v 0 p 1 p 2 β v 0 p 1 p 2 α p 1 p 2 proof of 2 the lyapunov differential inequality in 2 can be written as 5 v α θ 1 v p 1 β θ 2 v p 2 θ 1 v p 1 1 2 θ 2 v p 2 1 2 γ v 1 2 if θ 1 0 α θ 2 0 β and assume initially x q i e θ 1 v p 1 1 2 θ 2 v p 2 1 2 γ we can clearly see that v 0 it implies that v x is a progressively decreasing function starting from an arbitrary initial value v 0 further reducing v at some point we have θ 1 v p 1 1 2 θ 2 v p 2 1 2 γ then inequality 5 can be expressed as 6 v α θ 1 v p 1 β θ 2 v p 2 the above differential inequality has the same structure as in 1 of proposition 1 and the settling time can be obtained as 7 t β θ 2 α θ 1 2 p 1 p 2 ln β θ 2 α θ 1 v 0 p 1 p 2 β θ 2 v 0 p 1 p 2 α θ 1 p 1 p 2 we can conclude that for all the subsequent time the states x t of the system 1 do not escape the stable region q which completes the proof 3 auv modeling and problem formulation 3 1 auv kinematics the omni directional intelligent navigator odin is a spherical auv as illustrated in fig 1 which is equipped with eight thrusters and can perform the 3d spatial movement the motion of auv in three dimensional space can be described in the inertial frame for navigation and body fixed frame the velocity transformation relating the two coordinate systems can be expressed as fossen 2011 8 η r η ν where η x y z ϕ θ ψ t represents position and orientation of vehicle in inertial frame and ν u v w p q r t represent linear and angular velocities in body fixed frame the rotation matrix r η that describes the transformation between the inertial frame and body fixed frame which is related through the functions of euler angles is defined as 9 r η r 1 η 0 3 0 3 r 2 η where r 1 η and r 2 η are defined as follows r 1 η c ψ c θ s ψ c ϕ c ψ s θ s ϕ s ψ s ϕ c ψ c ϕ s θ s ψ c θ c ψ c ϕ s ψ s θ s ϕ c ψ s ϕ s ψ c ϕ s θ s θ c θ s ϕ c θ c ϕ r 2 η 1 s ϕ t θ c ϕ t θ 0 c ϕ s ϕ 0 s ϕ c θ c ϕ c θ here the symbols s c and t imply sin cos and tan respectively assumption 1 qiao et al 2017 the pitch angle θ is bounded such that θ max π 2 to avoid possible singularity problem in the rotation matrix r η remark 1 the rotation matrix and its inverse must exist note that r 2 η suffers from euler angle singularity for the pitch angle θ π 2 several ways of operation have been reported in the literature to avoid such singularity 1 during routine operations auvs are unlikely to enter the regions of θ π 2 due to metacentric restoring forces do and pan 2009 2 the desired trajectory for the pitch angle can be chosen that is sufficiently far from the singularity point qiao and zhang 2019a 3 the unit quaternion can be used to represent the vehicle attitude shihua li and zhang 2015 in this paper we have considered the first two modes of operation for fully actuated auv thus assumption 1 holds 3 2 auv dynamics using newton euler formulation the dynamics of auv in body fixed frame can be described as fossen 2011 10 m ν c ν ν d ν ν g η τ e x τ ν where m r 6 6 is the inertia matrix that include body mass and added mass c ν r 6 6 is a matrix describing centripetal and coriolis forces produced due to added inertia d ν r 6 6 denote the hydrodynamic damping matrix g η r 6 denotes the combined gravitational and buoyancy forces vector τ e x r 6 is the vector of unknown time varying environmental forces such as waves and ocean current and τ ν r 6 is the vector of control moments and forces these hydrodynamic parameters are slightly uncertain from those obtained by experiments because of the real sea environment therefore the parameter accuracy cannot be guaranteed and it is necessary to make the following assumption assumption 2 the parameters mentioned in 10 can be expressed as x x 0 δ x for x c d g where the terms x 0 and δ x denotes the nominal values and parametric uncertainties in auv model respectively remark 2 in practical control systems the parameters of a system may not be precisely known and may exhibit perturbations because of the modeling errors hydrodynamic uncertainties and exogenous disturbances the auv possesses uncertainties the actual values of hydrodynamic coefficients are split into nominal terms and uncertain terms in this work the nominal terms are precisely known to us while the uncertain parts are unknown using the above remarks and assumption 2 10 can be rewritten as 11 m ν c 0 ν ν d 0 ν ν g 0 η τ d τ ν where τ d represent the lumped uncertain forces that include exogenous disturbances and parametric perturbations and is defined as 12 τ d δ c ν ν δ d ν ν δ g η τ e x by substituting 8 in 11 followed by assumption 1 and the first time derivative of r η exist the dynamic equation of motion of the auv with respect to the inertial frame can be expressed as 13 m η η η c η 0 ν η η d η 0 ν η η g η 0 η τ d η τ η where 14 m η η r t η m r 1 η c η ν η r t η c 0 ν m r 1 η r η r 1 η d η ν η r t η d 0 ν r 1 η g η η r t η g 0 η τ η r t τ ν τ d η r t τ d based on realistic assumption 2 we can make the following assumption assumption 3 the model uncertainties in assumption 2 i e δ x for x c d g are unknown and bounded there exist two positive constants x m and x n so that x n δ x x m hence keeping assumptions 1 and 2 in mind the lumped disturbances vector in expression 12 is also bounded and is given by τ d i τ d i 3 3 thrust forces distribution the propulsion system of the odin consists of four horizontal and four vertical thrusters as shown in fig 2 the control input forces vector in 10 acting in each degree of freedom are jointly produced by the propulsion of the individual mounted thrusters the horizontal thrusters produce forces in the surge sway and yaw directions and the vertical thrusters produce forces in heave roll and yaw directions the relationship can be described as 15 τ ν e u where u r 8 is the vector of thrust forces produced by each propeller the thrust force allocation matrix e r 6 8 is taken from podder and sarkar 2001 in practical applications the thrust force saturation should be considered for normal operation of auv as mentioned in qiao and zhang 2019b the lumped disturbances and desired position trajectories two factors responsible for thrust saturation in this paper as in sarkar et al 2002 the thrust force limits for vertical and horizontal propellers are taken as 50 n and 150 n respectively 3 4 control objectives as depicted in 12 the auv suffers from external disturbances and hydrodynamic uncertainties the first objective of our paper is to design a ffteso to estimate the lumped uncertainties the next objective is to design a finite time robust control law and to incorporate the ffteso to track the reference position trajectories 4 fast finite time extended state observer in this section a novel ffteso is designed to reconstruct the lumped disturbance in auv in finite time 4 1 design of ffteso first of all define proportional integral velocity variables as 16 σ ν m ν ν where σ ν σ 11 σ 12 t is a vector of auxiliary variables by proceeding with differentiation of eqs 16 along 11 it yields 17 σ ν ν c 0 ν ν d 0 ν ν g 0 η τ ν τ d ν for the sake of simplicity denote a ν η ν c 0 ν ν d 0 ν ν g 0 η and considering the importance of extended state observer in estimating the lumped disturbances we defined a new variable ξ 1 σ ν the order of the system will be expanded by one additional state variables instead of the traditional one state extension ξ 2 ξ 3 using the above mentioned notation the extended dynamic equations are given by 18 ξ 1 a ν η τ ν ξ 2 ξ 2 ξ 3 ξ 3 ϖ the third order ffteso can be designed as 19 ξ ˆ 1 a ν η τ ξ ˆ 2 ε 1 ξ ˆ 1 ξ 1 β 1 ξ ˆ 1 ξ 1 ξ ˆ 2 ξ ˆ 3 ε 2 ξ ˆ 1 ξ 1 β 2 2 ξ ˆ 1 ξ 1 β 1 ξ ˆ 1 ξ 1 ξ ˆ 3 ε 3 ξ ˆ 1 ξ 1 β 3 2 ξ ˆ 1 ξ 1 β 2 ξ ˆ 1 ξ 1 β 1 where ξ ˆ 1 ξ ˆ 2 and ξ ˆ 3 are the estimates of ξ 1 ξ 2 and ξ 3 in the extended system respectively ε i c i ω and β i i β o i 1 i 1 2 3 are the observer gains to be designed satisfying c i 0 2 3 β o 1 and ω is a diagonal positive definite matrix assumption 4 the lumped uncertain term ξ 2 in 18 is unknown bounded and continuously differentiable the second derivative satisfies ϖ ϖ where ϖ is a vector of maximum value of ϖ 4 2 convergence analysis of ffteso the stability and convergence of the proposed observer 19 is stated as the following theorem theorem 1 under the assumption 4 if the ffteso is designed as in 19 for the system 18 satisfying the constraints on the observer gains the variables ξ 1 ξ 2 and ξ 3 will be estimated in a finite time t f proof of theorem 1 let z i ξ ˆ i ξ i for i 1 2 3 be the estimation error the error system of ffteso can be written as 20 z 1 z 2 ε 1 z 1 β 1 z 1 z 2 z 3 ε 2 z 1 β 2 2 z 1 β 1 z 1 z 3 ε 3 z 1 β 3 2 z 1 β 2 z 1 β 1 ϖ consider a lyapunov candidate function as v z ξ t p ξ where ξ z 1 β 1 z 1 t z 2 t z 3 t t is introduced as a new error variable and p is a positive definite symmetric matrix taking time derivative of ξ invoking 20 yields 21 ξ β 1 z 1 β 1 1 z 2 ε 1 z 1 β 1 z 1 z 3 2 ε 2 z 1 β 2 z 1 β 1 ε 3 z 1 β 3 z 1 β 2 z 2 ε 1 z 1 β 1 z 1 z 3 2 ε 2 z 1 β 1 z 1 ε 3 z 1 β 2 z 1 β 1 0 6 0 6 ϖ diag z 1 β 1 1 z 1 β 1 1 z 1 β 1 1 a 1 ξ a 2 ξ ω where ω 0 6 0 6 ϖ t and state dependent matrices which are given by 22 a 1 β 1 ε 1 β 1 i 6 0 6 ε 2 0 6 ρ 1 1 2 ε 3 ρ 1 0 6 0 6 a 2 ε 1 i 6 0 6 ε 2 0 6 i 6 2 ε 3 ρ 1 0 6 0 6 with ρ 1 z 1 β 1 1 0 since 2 3 β 1 1 the characteristic polynomials of 22 shows that if the observer gains are set as ε 1 ε 2 ε 3 0 then all the eigenvalues of a 1 and a 2 lies in the left half plane thus the system 21 is stable according to hurwitz the lyapunov function v z is continuously differentiable everywhere except z 1 0 moreover the error trajectories of system 20 reaches the neighborhood of origin and stay thereafter thus the time derivative of lyapunov candidate function is given as 23 v z ξ t diag ρ 1 ρ 1 ρ 1 a 1 t p p a 1 ξ ξ t a 2 t p p a 2 ξ 2 ω t p ξ since a 1 and a 2 are negative definite matrix and p is a symmetric as well as positive definite matrix satisfying the following lyapunov equations 24 a j t p p a j q j for j 1 2 where q j is symmetric positive definite matrix which is generally taken as the identity matrix recalling the assumption 4 one can obtain ω 6 ϖ using 24 the expression 23 can be written as 25 v z ξ t diag ρ 1 ρ 1 ρ 1 q 1 ξ ξ t q 2 ξ 2 ω t p ξ ρ min λ min q 1 ξ 2 λ min q 2 ξ 2 2 6 ϖ p ξ where ρ min min ρ 11 ρ 16 the state dependent matrices in 22 can be decomposed as 26 a 1 h 1 h 2 a 2 h 1 h 3 where h 1 i 6 0 6 0 6 0 6 i 6 0 6 0 6 0 6 ρ 1 h 2 β 1 ε 1 β 1 i 6 0 6 ε 2 0 6 ρ 1 1 2 ε 3 0 6 0 6 and h 3 ε 1 i 6 0 6 ε 2 0 6 i 6 2 ε 3 0 6 0 6 as h 1 is a diagonal matrices and ρ 1 0 is a decreasing function of z 1 since 2 3 β 1 1 one can obtain 27 σ min h 1 1 max z 1 1 ρ min max z 1 1 as q 1 and q 2 are symmetric positive definite matrices then σ min q j λ min q j σ max q j holds using 26 the inequality for lyapunov equation 24 can be expressed as 28 λ min q j 2 σ min p σ min h 1 σ min h j 1 given that ρ min z 1 β 1 1 ξ 1 1 β 1 and if max z 1 1 resulting ξ 1 the inequality 25 becomes 29 v z 2 ρ min 2 σ min p σ min h 2 ξ 2 2 ρ min σ min p σ min h 3 ξ 2 2 6 ϖ p ξ 2 σ min p σ min h 2 ξ 4 2 β 1 2 σ min p σ min h 3 ξ 3 1 β 1 2 6 ϖ p ξ 2 σ min p σ min h 2 λ max p 1 β 1 2 v 2 1 β 1 2 σ min p σ min h 3 λ max p 1 2 β 1 3 2 v 3 2 1 2 β 1 2 6 ϖ p λ max p 1 2 v 1 2 λ 1 v 2 1 β 1 λ 2 v 3 2 1 2 β 1 λ 3 v 1 2 where λ 1 2 σ min p σ min h 2 λ max p 1 β 1 2 λ 2 2 σ min p σ min h 3 λ max p 1 2 β 1 3 2 and λ 3 2 6 ϖ p λ max p 1 2 according to 2 of proposition 1 the system 20 will converge into a stable region subsequently z 1 1 the settling time and stable region are given by 30 and 31 30 t 1 2 β 1 λ 1 λ 1 ln λ 1 λ 1 λ 2 λ 2 v z 0 1 2 β 1 1 2 λ 1 λ 1 λ 2 λ 2 2 1 β 1 2 β 1 v z 0 1 2 β 1 1 2 λ 2 λ 2 1 β 1 31 x 1 z λ 2 v 1 1 2 β 1 λ 1 v 3 2 1 β 1 λ 3 where λ 1 0 λ 1 and λ 2 0 λ 2 are arbitrary constants once the system enters region where max z 1 1 then using 27 and 28 the inequality 25 becomes 32 v z 2 ρ min σ min p σ min h 2 ξ 2 2 σ min p σ min h 3 ξ 2 2 6 ϖ p ξ 2 σ min p σ min h 2 ξ 3 1 β 1 2 σ min p σ min h 2 ξ 2 2 6 ϖ p ξ λ 4 v 3 2 1 2 β 1 λ 5 v λ 3 v 1 2 where λ 4 2 σ min p σ min h 2 λ max p 1 2 β 1 3 2 and λ 5 2 σ min p σ min h 2 λ max p 1 according to lemma 2 the error trajectories of the proposed ffteso 20 are uniformly ultimately bounded stable the bounded settling time is 33 t 2 2 β 1 λ 5 λ 5 1 β 1 ln λ 5 λ 5 v z t 1 1 2 β 1 1 2 λ 4 λ 4 1 the observation errors decreases with time and finally enters the domain 34 x 2 z λ 4 v 1 1 2 β 1 λ 5 v 1 2 λ 3 in a finite time t f t 1 t 2 remark 3 compared with an fteso in li et al 2019 the structure of the ffteso 19 developed in this section consider the dynamics of the disturbances to achieve high estimation accuracy the proposed observer guarantees finite time convergence and can provide more accurate performance with small oscillations compared with the geso in lamraoui and qidan 2019 5 nftsmc design in this section an nftsmc is designed to control the fully actuated auv in the presence of hydrodynamic uncertainties and external disturbances to cope with the unknown lumped disturbances we have designed an ffteso 19 in section 2 that provides its real time estimation the prime control objective is to design a ffteso based nftsmc algorithm that ensures the actual position and attitude trajectories of auv to track the desired trajectories η d in finite time let η η η d represents the tracking error a non singular fast terminal sliding surface nftss labbadi and cherkaoui 2020 for an auv moving in 6 degree of freedom can be defined as 35 s η α η g h β η a b here α diag α 1 α 6 and β diag β 1 β 6 where α i and β i for i 1 6 are positive constants a b and g h are positive odd integers which satisfy the conditions 1 a b 2 and g h a b when η is far from the equilibrium point the term α η g h plays dominant role in the fast convergence rate of η boukattaya et al 2018 once η stays close to the origin then 35 provides same convergence of η as ntsmc manifold in elmokadem et al 2017 taking time derivative of 35 and using 13 yields the following 36 s η g α h η g h 1 η a β b η a b 1 m η η 1 c η 0 ν η η d η 0 ν η η g η 0 η τ d η τ η η d to achieve sufficient condition for the stability of nftss a finite time control law can be designed as 37 τ η τ e τ s where τ e and τ s represents the equivalent continuous control law and switching control law and are defined as follows 38 τ e c η 0 ν η η d η 0 ν η η g η 0 η r t ξ ˆ 2 m η η η d b a β 1 η 2 a b b g a h β 1 α η g h 1 η 2 a b k 1 s 39 τ s m η η k 2 sgn s where k 1 diag k 11 k 16 and k 2 diag k 21 k 26 k 1 i k 2 i 0 i 1 6 denotes the continuous and switching control gains to be designed the equivalent continuous controller 38 contain model information this control law is responsible to realize the desired dynamics for the nominal model of the vehicle due to model uncertainties and time varying external disturbances the switching control term is used to offset the difference between the desired and actual dynamics however sgn is a discontinuous function and cause chattering problem in practice the term k 1 s in 38 is introduced to alleviate the chattering problem by making it possible to use smaller switching gain k 2 incorporating 37 in 36 leads to the following form 40 s a β b η a b 1 m η 1 η r t z 2 k 1 s k 2 sgn s remark 4 the expression 40 shows that a strong reachability law has been considered in this paper to guarantee the stability the continuous and switching gains are designed as k 1 i 0 and k 2 i 0 respectively since the lumped disturbance has been precisely estimated by the fteso the estimation error z 2 which converges to a stable region x 2 see theorem 1 the magnitude of z 2 is much smaller than the magnitude of the disturbance τ d for all the subsequent time t t f hence the gains of the proposed controller can be designed much smaller as compared to the control method in elmokadem et al 2017 and chattering can be reduced to some extent 5 1 stability analysis theorem 2 if the nftss is chosen according to 35 and ffteso 19 based controller 37 is designed for uncertain auv dynamic system 13 then all the position and attitude error trajectories converge to zero in finite time proof of theorem 2 consider a new lyapunov candidate function is formed as v c i 1 2 s i 2 i 1 6 its time derivative along 40 and denoting f η t m η 1 η r t η z 2 takes the following structure 41 v c i s i a β i b η i a b 1 f i η t k 1 i s i k 2 i sgn s i according to theorem 1 z 2 converges to stable region x 2 in a finite time t f hence we can assume the f i η t is also bounded such that there exist a small positive constant δ f i such that f i η t δ f i using the above assumption 41 can be written as 42 v c i a β i b η i a b 1 k 2 i δ f i s i k 1 i s i 2 since 1 a b 2 when s 0 we have η i a b 1 0 for η i 0 the performance of control law 37 can be adjusted by selecting k 1 and k 2 from 42 for greater values of k 1 i and k 2 i in the feedback the sliding mode enforcement is more faster at the cost of high thrust forces which may leads to violate the saturation limits to maintain the thrust forces within the saturation limits defined in sarkar et al 2002 the feedback gains must satisfy the design conditions k 1 i 0 and k 2 i δ f i δ i where δ i is small positive constant this makes v c i negative definite and provides sufficient condition for the stability of nftss let γ i a β i b η i a b 1 λ 1 i 2 γ i k 1 i and λ 2 i 2 γ i δ i then we can write the differential inequality 42 as 43 v c i λ 1 i v c i λ 2 i v c i 1 2 the above differential inequality has the same form as that in lemma 1 which implies that the fast enforcement of sliding mode is guaranteed and it can be confirmed that position error trajectories of the vehicle will reach the sliding mode s 0 within a finite time given by the following equation 44 t s i 2 λ 1 i l n λ 1 i v c i t 0 1 2 λ 2 i λ 2 i therefore the designed control input satisfies 43 and keep the surface variable s i at zero for t t s i once the sliding mode occurs eq 35 can be written as 45 η i α η i g h β η i a b 0 on the nftss s i 0 the time taken to travel from η t s i 0 to η t s i t η i 0 is finite and is given by 46 t η i a β i b a a b η i t s i 1 b a f b a h a b a g h a g b h a g h α i ζ i where ζ i η i t s i g h 1 and f represent hyper geometric function abramowitz and stegun 1972 remark 5 as mention in remark 4 that the linear gain helps to reduce the chattering in control input the control law 39 provides robustness but brings an adverse effect of chattering to further reduce the chattering phenomenon the signum function can be replaced by a continuous switching function in this paper the inverse tangent function is used as a switching control law 47 τ s 2 π m η η k 2 atan s γ where s γ s 1 γ s 6 γ γ 0 represent boundary layer thickness remark 6 the linear control term k 1 i s i forces the error trajectories to approach the switching manifold faster which is also indicated as proof in 44 when the terminal sliding mode is achieved we have 48 η i η i α i η i g h β i b a the differential equation 48 ensures fast convergence of the position error trajectories to the equilibrium point as depicted in 46 6 results and discussion to validate the efficiency of the proposed fftseo based nftsmc the simulations will be carried on a realistic model of odin auv operating under environmental disturbance and parametric uncertainties the detailed parameters of the vehicle used in this paper are obtained from qiao and zhang 2019a to reflect the uncertainties in the vehicle dynamics 20 of the actual parameter s inaccuracy is considered in the simulations the time varying environmental disturbances are given by 49 τ e x 1 2 3 sin 0 2 t n τ e x 2 3 sin 0 3 t n τ e x 3 4 sin 0 1 t n τ e x 4 2 c o s 0 1 t n m τ e x 5 1 cos 0 2 t n m τ e x 5 2 2 cos 0 3 t n m the design parameters of the ffteso 19 are chosen as β o 0 7 ε 1 5 ω ε 2 30 ω and ε 3 30 ω where ω diag 6 6 6 3 3 3 the control gains in 37 are adjusted as a 5 b 3 g 7 h 3 β d i a g 2 2 2 5 2 5 2 5 3 α i 6 6 k 2 d i a g 0 5 0 2 0 3 0 15 0 15 0 2 and k 1 0 008 i 6 6 for the switching control terms 47 the thickness of boundary layer γ 0 01 the initial position of odin is assumed η 0 1 5 1 5 1 0 5 0 8 1 2 t and the initial velocities are set at zero the desired trajectory vector for the odin which refer to qiao and zhang 2019a are given by 50 x d sin 0 2 t m y d cos 0 2 t m z d 0 1 t 2 m ϕ d 0 rad θ d a t a n 1 2 rad ψ d 0 2 t rad according to the remark 1 the desired pitch angle θ d is far from the π 2 rad which avoids the kinematic singularity during motion of the odin to verify the performance of the proposed observer 19 comparative simulations with the fteso 51 in li et al 2019 and geso 52 in lamraoui and qidan 2019 are carried out the disturbance estimation errors are plotted in fig 3 to illustrate the transient and steady state responses table 1 presents their quantitative analysis in terms of the settling time and estimation error it is quite clear from fig 3 that the performance of the proposed ffteso is superior than fteso 51 and geso 52 51 ξ ˆ 1 a ν η τ ξ ˆ 2 ε 1 z 1 β 1 z 1 ξ ˆ 2 ε 2 z 1 β 2 2 z 1 β 1 z 1 52 ξ ˆ 1 a ν η τ ξ ˆ 2 ε 1 z 1 ξ ˆ 2 ξ ˆ 3 ε 2 z 1 ξ ˆ 3 ε 3 z 1 for comparison of the trajectory tracking performance of the developed ffteso ntsmc a similar order geso is combined with nsftsmc noted as geso nsftsmc the linear gains matrix of geso nftsmc is adjusted at zero while the rest of the parameters are selected same as that of the proposed scheme the simulation results of both the controllers are shown in fig 4 fig 4 a shows the trajectories tracking of odin in 3 dimensional space figs 4 b to 4 d depicts the tracking performance given by the two control schemes in x y x z and y z planes the corresponding position and attitude errors are shown in fig 5 it can be seen from figs 4 and 5 that both the controllers exhibit finite time stability however there are two major factors that increase the convergence rate and increases the tracking precision of the ffteso nftsmc first the ffteso updates the control law by providing more accurate information of the disturbances than geso as depicted in fig 3 and also analytically predicted by remark 4 second the linear gains exhibit strong reachability during the reaching phase which is also indicated as proof in 43 for the clarity of the results the analysis of both controllers is given in table 2 the thrust forces generated by each thruster of the odin are shown in fig 6 thrusts 1 4 denote the force produced by the horizontal and thrusts 5 8 denotes thrust forces produced by vertical thrusters the plotted forces clearly demonstrate that all the thrusters do not violate the thrust saturation limits defined in sarkar et al 2002 as predicted by remarks 4 and 5 the combination of linear control term k 1 s and switching function 47 in ffteso nftsmc avoids the chattering problem in thrusters as shown in the zoom view of fig 6 7 conclusion in this paper a novel ffteso based nfstmc is proposed for auvs which achieves fast finite time stability in the presence of the model uncertainties and external disturbances we propose an ffteso to estimate the lumped disturbances in a finite time with proper parameters by comparing with the geso and fteso the proposed observer can achieve faster and accurate performance the estimates of the disturbances are used as compensation in the designed nftsmc to achieve robustness the gains of the inverse tangent function are required to be greater than estimation errors meanwhile a linear term is contained in the control input to further alleviate chatter in the thrusters and ensures fast convergence of the position error trajectories to the nftss as shown in the simulation results the proposed control scheme provides better response than geso nftsmc the extension of the finite time controller based on event triggered fteso for underactuated auvs with small delays will be presented in the future work credit authorship contribution statement nihad ali conceptualization methodology software writing original draft investigation writing review editing isaac tawiah validation investigation writing review editing weidong zhang supervision resources funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this paper is partly supported by the national science foundation of china 61473183 u1509211 61627810 and national key r d program of china 2017yfe0128500 
21327,maintenance improvement is affected by many uncertain factors such as maintainer experience machine deterioration state maintenance tools and equipment it is very hard to determine each restoration degree ahead of repair operation therefore this paper considers a maintenance problem in the presence of competing risks degradation and sudden failure under stochastic maintenance quality for a ship pump the degradation process of ship pump is characterized by a non homogeneous gamma process and the hazard rate of sudden failure is described by a proportional hazards model we propose a two level condition based maintenance cbm policy with stochastic maintenance quality the policy combines degradation control limit and age control limit under stochastic maintenance quality of beta distribution normal distribution and uniform distribution respectively in maintenance decision making maintenance optimization problem is formulated and solved by a computational algorithm in a semi markov decision process smdp framework with the objective of minimizing the long run expected average cost the proposed model is illustrated using a numerical study and a real case study of ship pump respectively and comparative results show the effectiveness and superiority of our approach keywords condition based maintenance stochastic maintenance quality maintenance optimization control limit policy 1 introduction ship pump is the key component for water transportation and pollution draining for shipborne and it is widely used in ocean industries in recent decades however extreme operation conditions on ocean such as salt water random shock and humid environment might cause serious damage and fatigue on the ship pump and consequently lead to unexpected breakdown operational losses and safety hazards li et al 2020 for these reasons advanced maintenance technique i e cbm is desired to perform based on the actual operating status of the pump before failure occurs cipollini et al 2018 current maintenance practices use age based or experience based policy to maintain the ship pump which is not effective and may easily result in high risks of pipe blockage and effluent backflow therefore development of cbm for ship pump is significantly necessary and pressing in maintaining desirable reliability and satisfactory performance of shipborne hwang et al 2018 garbatov et al 2018 dong and frangopol 2015 the existing maintenance strategies can be classified as preventive maintenance which repair is taken before failure and corrective maintenance which repair is performed after the failure occurs tang et al 2015 cbm combines preventive maintenance and corrective maintenance to perform repair according to the monitored operating conditions zou et al 2019 the aim of cbm is to jointly determine when and what the maintenance should be taken some successful examples have been implemented to demonstrate the effectiveness of cbm in real applications scheu et al 2019 tan et al 2019 among these cases maintenance models are categorized into two types deterministic maintenance model and stochastic maintenance model research works related to deterministic maintenance assumed that the machine can be repaired to a certain operating condition give a maintenance action the action restoration could be perfect or imperfect for which brings the machine state to a brand new or to a condition between new and old respectively maintenance with full perfect restoration accounts for majority of cbm applications in various cases such as boring machines gear boxes lasers etc tang et al 2015 li et al 2019 duan et al 2020 while maintenance with partial imperfect restoration has extensive variants including cost related recovery model liu and huang 2010 failure rate reduction model nakagawa 1988 age reduction model kijima et al 1988 and hybrid model combining the failure rate reduction and the age reduction lin et al 2001 xia et al 2015 even although models with assumption of deterministic maintenance effects are quite convenient for maintenance modeling and optimization especially for modern complex machines they usually do not truly reflect the real status of the system after machine being repaired this is due to that the maintenance restoration is largely affected by many uncertain or unknown factors such as maintainer experience machine deterioration state maintenance tools and equipment as an extension to deterministic maintenance stochastic maintenance considers that quality of maintenance is a random variable which can be described by a certain distribution this practical consideration was proposed by wu and clementscroome 2005 to assume the machine condition falls into a fixed degradation interval with constant probability after repair for which the improvement follows uniform distribution khatab and aghezzaf 2016 further assumed maintenance quality follows beta distributions to model age reduction factors for binary state system maintenance scheduling more generally duan et al 2018a assumed multiple maintenance options with different level of stochastic quality following beta distributions in a selective maintenance scheduling for variety of multi unit systems another stochastic maintenance model is probabilistic repair model which assumes that maintenance improvement is equivalent to minimal repair no change with probability p and equivalent to preventive maintenance a certain change with probability 1 p brown and proschan 1983 shahraki et al 2020 this considered maintenance improvement factor is indeed a discrete random variable dependent on deteriorating state maintenance cost and time besides these mentioned works few papers have been focused on stochastic maintenance to develop and implement cbm models the essential part to analyze and optimize a cbm policy is to develop a suitable cbm model tang et al 2015 cipollini et al 2018 hwang et al 2018 in cbm models the evolution of the failure process and its underlying degradation path should be modeled according to practical deterioration of the machine asuquo et al 2019 the failure processes may interact each other internally and externally the occurrence of external shock might cause a sudden increase of deterioration level while the deterioration might increase the hazard rate of random shock and lead to catastrophic failure this interaction between shock and gradual degradation has been studied in the literature by considering dependent competing risks process currently research works focusing on system competing risks mainly apply three approaches to model the failure interactions in cbm namely degradation shock model dependent hidden markov model and proportional hazards model phm degradation shock model was proposed earlier than other approaches to model machine degradation and sudden failure as two evolution processes and defined that the sudden shock may cause ultimate random failure as well as degradation failure when the level of system deterioration crosses the predetermined limit the main challenge for the degradation shock model is the definition of failure interactions which contains lots of ideal assumptions and cannot be sufficiently verified by real cases dependent hidden markov model proposed by akram and makis khaleghei and makis 2016 who assumed that the time to catastrophic failure and the sojourn time in the healthy state follow a bivariate distribution they have provided detailed parameters estimation procedures and proved the effectiveness of the proposed approach with real applications in transmission units gear boxes and machine tools li et al 2019 duan et al 2020 phm is a natural candidate to model the competing risks by incorporating the degradation process and sudden failure as covariate and baseline function to model the hazard rate of the machine it was originally proposed by makis and jardine 1992 to model a single failure mode i e hard failure and then extended by tang et al 2015 to model the competing risks of hard failure and degradation failure in gaas lasers due to convenient concept and flexible covariate process phm model was generally used in partially observable system modeling and it was extended with wiener covariate zhao et al 2016 gamma covariate duan et al 2018b markovian covariate wu and ryan 2011 normal covariate liu et al 2017 to fit different degradation patterns in complex systems nevertheless most phms in the literature have focused mainly on the sudden hard failure mode the failure of degradation process has not been sufficiently discussed in the cbm community zhou et al 2014 duan and deng 2020 furthermore existing maintenance models for phm considered the quality of maintenance on machine degradation restoration as ideal which is not true when we check the degradation interactions for whole life cycle of machine liu et al 2017 hu and chen 2020 moreover even some works have proposed maintenance policy for competing risks in phm these maintenance strategies only considered the control limit of machine hazard rate or degradation state an efficient two level control limit policy was not considered in maintenance decision making tang et al 2015 jafari et al 2018 up to now very little work has been devoted to analyzing the competing risks with stochastic maintenance quality to remedy this gap in this paper we focus on the cbm problem of competing risks with stochastic maintenance quality both degradation and aging processes limits are considered as decision variables for developing cbm policy stochastic maintenance quality is also studied in our policy and a detailed comparison by numerical and real case studies is presented the proposed approach differs from the existing works in that a it presents a competing risks model incorporating degradation failure and hard failure b it investigates the different stochastic maintenance qualities under new proposed cbm policy c it develops a computational algorithm in smdp framework to obtain the maintenance decision variables the remaining parts of this paper are structured as follows section 2 formulates the competing risks by modeling pump s degradation as gamma process and hard failure as phm section 3 describes a new cbm policy with three commonly used stochastic maintenance quality models section 4 formulates and optimizes the cbm problem in the smdp framework section 5 presents a numerical study to illustrate the performance of three stochastic maintenance quality models in the proposed cbm section 6 further verifies the proposed approach through a real case of ship pump section 7 summaries the conclusion and future research directions 2 competing risks modeling generally ship pump experiences a degradation failure when its degradation state reaches a certain level and a sudden failure which occurs unexpectedly and stops pump from functioning the ship pump is under periodical inspections to provide information of degradation levels at discrete time epochs t n n h n 1 2 3 which is the case in practices based on the nature of competing risks the modeling approach involves two distinct sub modeling approaches degradation signal modeling approach and sudden failure modeling approach 2 1 model of system degradation the ship pump is subject to a continuous accumulation of wear over time and its degradation i e performance loss path usually presents an non decreasing and continuous pattern the degradation path can be thought as the accumulation of an infinite number of small shocks which increases with aging and is characterized by a scalar random variable do et al 2015 for such a system gamma process which can be considered as an accumulation of a sequence of small increments is an excellent candidate to describe such a monotonic degradation path to model the degradation process it is assumed the deterioration of the pump y t t r evolves like a non stationary gamma stochastic process g a α t β and the probability density function is given by f y t y β α t γ α t y α t 1 e β y i y 0 where i y 0 is an indicator function i y 0 1 if y 0 otherwise i y 0 0 α t is non linear shape parameter with form α t c t d and β 0 is the scale parameter γ α t 0 u α t 1 e u d u is the gamma function the degradation model has the following properties y 0 is a known initial state and is 0 for any given inspection times the increments y n t y t n y t n 1 are independent for any consecutive inspection points 0 t n 1 t n the random increment y n y t n y t n 1 follows a gamma distribution with shape parameter α t n 1 α t n and scale parameter β the mean deterioration speed between two inspection points is equal to α t n 1 α t n β and the variance is equal to α t n 1 α t n β 2 α t is a given monotone increasing function parameter estimates for gamma process can be obtained by maximizing the logarithm of the likelihood function of the deterioration increments with respect to c d and β van noortwijk 2009 cinlar et al 1977 if the degradation failure threshold d f is given the probability of degradation failure for the next inspection interval n h n 1 h conditioning on the current observation i e inspected degradation level y t y t d f can be expressed by 1 p r t n 1 h y t y t d f d f y t f z α n h β d z 2 2 model of sudden failure when a ship pump is functioning the sudden failure is more likely to occur with service time the sudden failure can interrupt functioning state and cause unexpected catastrophic loss in this paper we assume that the occurrence rate of sudden failures is described by the proportional hazards model see e g kumar and klefsjo 1994 which explicitly includes both the effect of the age and the degradation state it can be expressed by the following relation 2 h t y t h 0 t ψ y t ϒ where h 0 t denotes baseline failure rate at time t ψ y t ϒ is positive function with a regression parameter ϒ depending on the degradation state of y t the survival function is given by p ξ 2 t y s 0 s t exp 0 t h 0 s ψ y s ϒ d s where ξ 2 is the time of sudden failure for the pump which has not failed by time n h if the latest observation is y n h y n the conditional reliability function of surviving beyond n h t for any 0 t h can be approximated as r y n n t p ξ 2 n h t ξ 2 n h y n exp n h n h t h 0 s ψ y n ϒ d s exp ψ y n ϒ n h n h t h 0 s d s thus the expected sojourn time for pump to keep functioning during interval n h n h a is given by τ y n n a 0 a r y n n t d t 0 a exp ψ y n ϒ n h n h t h 0 s d s d t since we consider two failure modes the pump s time to failure is the minimum failure time among the degradation failure time ξ 1 and sudden failure time ξ 2 and can be obtained as ξ min ξ 1 ξ 2 with eq 2 the hazard rate of the pump at the n th inspection epoch is given by 3 h n h y n h h 0 n h ψ y n h ϒ the sudden failure is characterized by the phm based on the competing risks model we develop a maintenance model in the next section 3 maintenance model 3 1 maintenance policy consider a repairable pump system described as in section 2 the degradation state of the system is hidden and the degradation failure is non self announcing no indicator can exhibit the degradation state except to do an inspection the system starts working at time t 0 and is inspected every h time units the inspections are assumed to be perfect and incurred a cost c i combining the degradation based policy and age based policy a two level control limit policy is considered three types of maintenance actions are available on the pump and the cbm policy is as follows corrective maintenance is performed which consumes t s time units and c s cost at inspection epochs when the degradation state exceeds degradation failure threshold d f corrective maintenance is performed with the expected time t h and cost c h right after a sudden failure occurs preventive maintenance is triggered at the expected time t p and cost c p when the degradation level of the pump system reaches degradation control limit w at inspection epoch a preventive replacement is triggered at the expected time t r and cost c r when the age of the pump system exceeds the age control limit t where t k h and t t t is the maximum predetermined age a corrective maintenance or replacement action can be either a physical replacement or an overhaul or repair such that the pump system is as good as new after the replacement even though both the corrective maintenance actions for degradation failure and sudden failure put the pump system back in the as good as new state they are not necessarily identical in practices because the corrective maintenance for sudden failure is unplanned and is considered to be more complex and more expensive the preventive maintenance is assumed to be imperfect with stochastic restoration impact on the system degradation state which is practical in real situations the decisions variables in this maintenance policy are age control limit t and degradation control limit w for initiating preventive maintenance replacement the objective is to jointly optimize the age control limit and degradation control limit to minimize the long run expected average cost per unit time 3 2 stochastic quality of maintenance in the literature related to maintenance strategy keizer et al 2017 alaswad and xiang 2017 a system is typically assumed to be restored to a certain condition by a deterministic quality of a maintenance action however due to the expertise differences and maintenance environment factors the restoration of a maintenance action is not fixed throughout this paper the quality of maintenance is assumed to be stochastic and characterized by a random variable η after a maintenance operation the degradation level y t of the pump system is reduced to y t 1 η where η for 0 η 1 is the degradation reduction coefficient accordingly the degradation of system becomes to initial new status if its deterioration is reset to zero with reduction coefficient η 1 while it becomes as bad as old if the reduction coefficient η 0 duan et al 2018a zhao et al 2017 therefore a random variable η is used to represent the new degradation reduction factor which characterizes the stochastic maintenance quality since the probability density function f η and cumulative distribution function f η of the stochastic maintenance quality are defined on the support 0 1 we use a beta distribution to model the random variable η which is defined as f η 1 b a b η a 1 1 η b 1 where a and b for a 0 b 0 are shape parameters b a b 0 1 t a 1 1 t b 1 d t is the beta function the expected value μ η and the standard deviation σ η of random variable η are μ η a a b σ η a b a b 2 a b 1 the stochastic quality of maintenance under different expected improvements is depicted in fig 1 in the figure the curves corresponds to the probability density functions of the stochastic maintenance improvements with expected values and standard deviations on 0 25 0 01 0 5 0 01 0 75 0 01 respectively in this work the improvement of maintenance is set on degradation process this is due to that the degradation is observable and measurable the maintainer can evaluate the maintenance improvement through the degradation measurement after repair after repair operation the system degradation will restore system to state y t 1 η besides beta distribution two models have appeared in literature to model the quality of maintenance which are normal distribution and uniform distribution for the maintenance quality follows normal distribution the stochastic maintenance quality is defined on the support 0 1 the corresponding probability density function is given by f η 1 2 π σ 2 exp η μ η 2 2 σ 2 for 0 η 1 0 1 2 π σ 2 exp η μ η 2 2 σ 2 d η for η 0 1 1 2 π σ 2 exp η μ η 2 2 σ 2 d η for η 1 where μ η is the expected value of random variable η σ η is the standard deviation since normal distribution is defined on the support we assume that the possible values of the reduction coefficient η fall within 0 1 for the values falling into intervals smaller than 0 they are considered to be 0 while for values greater than 1 are considered to be 1 thus we re define the probability density function and the new f η is a hybrid function the expected average value μ η can be obtained as μ η 1 1 2 π σ 2 exp η μ 2 2 σ 2 d η 0 1 1 2 π σ 2 exp η μ 2 2 σ 2 η d η and the standard deviation σ η can be calculated by σ η 2 0 1 η μ η 2 f η d η μ η 2 0 1 2 π σ 2 exp η μ 2 2 σ 2 d η 1 μ η 2 1 1 2 π σ 2 exp η μ 2 2 σ 2 d η fig 2 shows the stochastic maintenance model under normal distribution with cases of μ η σ η 0 25 0 05 μ η σ η 0 5 0 05 and μ η σ η 0 75 0 05 respectively the third stochastic model used in preventive maintenance quality is uniform distribution which has equal probability for different value of η the probability density function is defined on the support as well and can be expressed by f η 1 m for 0 η 1 0 otherwise where m is the number of intervals divided in the support 0 1 the support is defined by the two parameters 0 and 1 which are the minimum and maximum values of maintenance improvement the quality of maintenance is assumed to have probability of 1 m in each small interval there are some limitations for applying uniform distribution to model the quality of imperfect maintenance on the one hand the improvement of maintenance is fixed and it does not support multiple levels maintenance policy on the other hand the restoration of maintenance is equal for each deteriorating state which is violated with maintenance practices in real world situations 4 maintenance optimization in smdp framework the objective of our maintenance policy is to find the optimal values of the control limits w t to initiate a preventive maintenance replacement that minimizes the long run expected average cost per unit time by renewal theory the cost minimization problem is equivalent to finding optimal control limits w t such that 4 g w t e w t c c e w t c l inf e w t c c e w t c l subject to 5 0 w d f 6 0 t t where c c and c l denote the cycle cost and cycle length respectively constraints 5 and 6 confine the ranges of the control limits w t to optimize the maintenance policy we now develop a computational algorithm in the smdp framework to determine the optimal control limits w t the degradation process at each inspection epoch is monitored suppose that the pump is operational at the n th inspection epoch n h then we compute the hazard rate using eq 3 generally the computation of the smdp requires discretization of the possible range of y n 0 d f we partition the interval of the degradation level 0 d f into a fixed large l subintervals with constant length δ d f l and define d f as the failure state f the number of subintervals l should be selected properly the more accurate results will be obtained by choosing the larger number of subintervals l however the computational time increases therefore the number of subintervals should be selected big enough to get the precise results in a reasonable time if at inspection point the observed system degradation y t is in i d f l i 1 d f l then the degradation process is defined to be in state i if the observed system degradation exceeds the degradation level w then the process is defined to be in p m state before calculating the transition probabilities the exact definitions of the state space for the smdp are required state 0 0 the system is in as good as new state state l n the first component denotes the state of the observed degradation at time n h and the second component is the operating age of the system at time n h state p m the value of observable degradation crosses the degradation level w a preventive maintenance action is performed state f the value of observable degradation reaches the degradation failure threshold d f a corrective maintenance action is performed state r the age of the system reaches the age level t a replacement is initiated therefore the state space of smdp can be represented as s s 1 s 2 s 3 s 4 s 5 where s 1 y n y 0 w n h t n n s 2 p m s 3 f s 4 r s 5 0 0 with the definition of the state space of the smdp for cost minimization problem the smdp is determined by the following quantities tijms 1994 p i j the probability that at the next epoch the system will be in state j s given the present state is i s τ i the expected sojourn until the next decision epoch given the current state i s c i the expected cost incurred until the next decision epoch given the current state i s with the quantities defined above for fixed control limits w t the long run expected average cost g w t can be obtained by solving the following linear equations v k c k g w t l s p k l v l for each k s 7 v s 0 for some s s where v k is the relative value the optimal control limits w t and corresponding minimal average cost will be obtained by iteratively solving 7 the remainder of the mathematical analysis in this section is devoted to deriving closed form expressions for the smdp quantities p i j τ i c i to proceed with the smdp approach the transition probability for gamma degradation process of pump is required since the state of deterioration process is only observable at inspection points it may transit to any state at any time between two inspections for the degradation process the transition probability from state l at current inspection n h to l at the next inspection n 1 h can be formulated as p l l h l l δ l l 1 δ β α n 1 h α n h γ α n 1 h α n h y α n 1 h α n h 1 e β y d y p l w h l l δ l l 1 δ β α n 1 h α n h γ α n 1 h α n h y α n 1 h α n h 1 e β y d y p l d f h 1 0 l l 1 δ β α n 1 h α n h γ α n 1 h α n h y α n 1 h α n h 1 e β y d y the first term indicates the probability of system degradation transiting to state l under control limit w the second term means the probability of system degradation going to state in w d f the last term shows the probability that system degradation exceeds d f at the next inspection next we present the derivation of the required smdp transition probabilities 4 1 developing the transition probabilities the smdp transition probabilities for the states defined in the previous paragraphs are calculated as follows 1 assume that the system is in the state l n where l δ d f n h t then the transition probability to the next decision epoch at state l n 1 where l δ d f n h t is given by p l n l n 1 p y n 1 l δ l 1 δ ξ 2 n 1 h y n l δ l 1 δ ξ 2 n h the right side of formula is the probability that the system degradation will not exceed the degradation control limit w the age of the system will not exceed age control limit t and the system will not fail in the next inspection interval then this probability can be calculated as p y n 1 l δ l 1 δ ξ 2 n 1 h y n l δ l 1 δ ξ 2 n h p y n 1 l δ l 1 δ ξ 2 n 1 h y n l δ l 1 δ ξ 2 n h p ξ 2 n 1 h y n l δ l 1 δ ξ 2 n h p l l h r l n h 2 if the system degradation level crosses the degradation control limit i e l δ w at the next decision epoch given the current state l n where l δ d f n h t then the system goes to the p m state and the transition probability is given by p l n p m p y n 1 w d f ξ 2 n 1 h y n l δ l 1 δ ξ 2 n h p ξ 2 n 1 h y n l δ l 1 δ ξ 2 n h p l w h r l n h 3 if the degradation state of the system reaches the failure threshold d f at the next decision epoch given the current state l n where l δ d f and n h t then the system goes to the f state and the transition probability is given by p l n f p l d f h r l n h where p y d f h is the probability that system will exceed the failure threshold d f at inspection interval h 4 if the age of the system exceeds the age level t at the next decision epoch given the current state l n where l δ d f and n h t then the system goes to the r state and the transition probability is given by p l n r r l n h 5 if the sudden failure occurs the corrective maintenance will be set up which brings the system back to state 0 0 then the transition probability is given by p l n 0 0 1 r l n h 6 new cycle begins when corrective maintenance action or age replacement is taken which is given by p f 0 0 1 p r 0 0 1 since the quality of preventive maintenance is stochastic instead of returning back to 0 0 the system will go to state l n 1 with probability p p m l n 1 after preventive maintenance action the p p m l n 1 is given by p p m l n 1 1 l l 1 l 1 l l 1 η d f η where l is the degradation state before the preventive maintenance with impact between 1 l l and 1 l 1 l the degradation state returns back to the state l with probability p p m l n 1 in the next subsection the expected sojourn times and the expected cost in each state are determined 4 2 computing the mean sojourn times and expected costs we consider different scenarios of mean sojourn times and expected costs for smdp states which are presented as follows the mean sojourn time and expected cost incurred until the next inspection epoch at state l n 1 where l δ d f n h t given the current state l n where l δ d f n h t are given by τ l n 0 h r l n t d t 1 r l n h t h c l n c i 1 r l n h c h when the degradation process crosses the failure threshold d f the mean sojourn time and expected cost in the failure state f are given by τ f t s c f c i c s when the system reaches the age control limit t the mean sojourn time and expected cost in the replacement state r are given by τ r t r c r c i c r when the system degradation level reaches the control limit w the mean sojourn time and expected cost in the preventive maintenance state p m are given by τ p m t p c p m c i c p by substituting the above quantities in 7 the optimal values of w t and corresponding minimal long run expected average cost per unit time can be obtained by solving the linear equations in the smdp algorithm an appropriate l to partition the continuous state space y t t 0 is needed in this algorithm a basic approach rule is developed to determine l which is given by the following expression 8 g w t l 2 u 1 g w t l 2 u ε where l is positive integers and ε is the selected small number 5 comparison of maintenance quality through a numerical study the purpose of our work is twofold one is to investigate the stochastic maintenance quality the other is to validate the effects of the proposed cbm model in this section we compare the proposed stochastic maintenance models with deterministic maintenance model through a numerical study we assume that the pump system deterioration follows a phm with dependent degradation failure and sudden failure the degradation process is described by a non homogeneous gamma process with shape parameter α t 0 63 t 1 09 and the scale parameter β 1 18 the failure threshold d f for the system is 18 the baseline hazard rate is assumed to follow a weibull distribution h 0 t ρ t ρ 1 θ ρ where θ 1 84 ρ 5 5 and ψ y t exp 0 5 y t the system is periodically inspected with h 1 and maximum predetermined age is t 50 we consider the following cost and time parameters in our case to illustrate our maintenance policy c i 5 c s 400 c h 800 c r 600 c p 150 t s 2 5 t h 4 t r 2 5 t p 1 to investigate how the maintenance decision will change with the quality of the maintenance we compare three stochastic models with the deterministic case under different values of μ η from 0 1 to 0 9 under σ η 0 01 the maintenance quality in deterministic maintenance is set to be same as the expected impact of stochastic cases for notation convenience we denote the case of deterministic maintenance as dm since the expected value of uniform distribution is 0 5 regardless of parameters changing the comparison is only made for case of μ η 0 5 for uniform distribution the optimal control limits w t and corresponding expected average cost are obtained using smdp algorithm table 1 indicates the results of optimal control limits w t considering different expected maintenance improvements for four compared cases it can be seen that the control limits increase with the value of μ η which means the higher expected restoration the looser control policy compare with deterministic maintenance quality the beta distribution has a relative lower control limits of w t while normal distribution has a stricter control at the beginning and a looser control after μ η 0 5 the uniform distribution which is not so efficient in practical maintenance quality modeling has the lowest w t with the highest average cost 32 5 among four cases under μ η 0 5 in fig 3 it is clear that the beta distribution has a very similar control limit w with case of deterministic maintenance quality although some small changes in 0 5 0 9 the control limit w of normal distribution shows a high fluctuation and control policy is conservative as expected maintenance improvement is below 0 5 fig 4 shows the minimum expected average cost under different expected maintenance improvement impact we can see that the maintenance quality following beta distribution has smaller expected average cost than deterministic case when μ η 0 3 and the expected average cost becomes almost equal with the deterministic maintenance case as μ η 0 3 in general the expected average cost of beta distribution is either higher or lower than deterministic maintenance case but their costs are very close with increase of expected maintenance impact in contrast the expected average cost of normal distribution shows a highly undulated trend which is much greater than other two cases as μ η 0 4 and much lower as μ η 0 5 the reason of this result is that the normal distribution is a hybrid distribution which is defined on the internal 0 1 when the mean of distribution approaches to 0 1 or to 0 9 the μ η has a large probability to fall into the value of 0 or 1 when μ η equals 0 it has no any restoration effect but incurs maintenance cost which is relative costly in all cases whereas if μ η equals 1 the restoration is perfect with imperfect preventive maintenance cost which is very cost effective through the comparison the maintenance decision is influenced by the maintenance quality different maintenance quality models lead to different control limit policies and operating costs the normal distribution model has a great impact on the maintenance decision making whereas the beta distribution model has not changed too much with deterministic case in the proposed maintenance policy 6 case study 6 1 experimental results to further investigate the performance of the proposed model in real practical applications we study a real diagnostic data set coming from the ship diaphragm pump the major function of this pump is to realize the control of liquid draining and dewatering in the ship the pump is subject to gradual degradation failure and random sudden failure the degradation failure does not halt the pump operating condition but leads to inferior performance the sudden failure will abruptly stop the pump from operating condition the degradation of the ship pump leads to performance loss of diaphragm operating the pump diaphragm operating frequency is periodically inspected every 720 h for collecting degradation information and the maximum lifetime of the pump is 18000 h the pump starts operating with frequency of 35 per second and is considered to be failed if the degradation namely operating frequency loss increases to 25 per second the baseline function of phm is assumed to be weibull distribution with the hazard rate h 0 t ρ t ρ 1 θ ρ and covariate process is gamma process with non linear shape parameter α t c t d using maximum log likelihood method the parameter estimates for both degradation process and baseline function are given in table 2 the stochastic maintenance quality for beta distribution and normal distribution are estimated using the procedure in zhang et al 2015 through the goodness of fit tests we find that anderson darling statistic ad value of beta distribution is 0 218 and p value is above 0 500 while ad value of normal distribution is 18 33 and p value is less than 0 05 for the uniform distribution the test indicates that the maintenance data does not follow this specified distribution therefore we pick the beta distribution as the better fit for modeling the stochastic maintenance quality the expected impact of maintenance improvement μ η and corresponding standard derivation σ η are 0 78 and 0 0093 respectively the pump preventive and corrective time parameters are given by t s 24 t h 36 t r 24 and t p 12 hours respectively the maintenance costs considered in the experiment are given by c i 50 c s 3000 c h 7200 c r 4000 c p 1500 we partition the continuous degradation process 0 25 into l 64 intervals for maintenance optimization in smdp framework the minimum expected average cost per inspection cycle is 255 78 with optimal w 17 64 t 12960 it means the replacement is taken at 18th inspection epoch if no sudden failure and degradation failure occur the computational algorithm in smdp framework for acquiring optimal decision variables w t requires an appropriate discretization l to get the sufficiently precise results with a reasonable time using the proposed model in section 4 the expected average cost with optimal control limits under different discretization l are demonstrated in table 3 when l 32 the expected average cost has not changed much using the stopping rule defined in 8 we can conclude that l 32 the partition leads to a sufficient degree of precision it should be noted that the ai based techniques can be used here to find the optimal decision variables instead of smdp algorithm but the quality of the solution is not stable for this reason we choose smdp algorithm to optimize the maintenance problem since it has complete mathematical derivations and can obtain the stable and optimal decision variables 6 2 case comparison we first compare the proposed model with the maintenance policy which assumes that maintenance improvement is constant same parameters as in the previous case study are considered the maintenance impact is set to be the expected value of beta distribution μ η 0 78 the discretization l is set to 64 as well the minimum long run expected average cost using the maintenance policy with constant maintenance impact has increased to 264 58 with w 18 02 t 13680 which are higher than the optimal average cost and control limits obtained using the proposed approach with stochastic maintenance model fig 5 shows the degradation path plot for the one of data histories with the optimal decision variables w t the stars show the degradation state at each inspection epoch once the degradation state exceeds the degradation control limit w preventive maintenance will be performed for the proposed policy considering stochastic maintenance effect this occurred at the 16th inspection epoch which is one inspection interval earlier than its deterministic counterpart similar result can be seen with age control limit we also have verified the superiority of the proposed approach by comparing the results with the hazard rate based policy age based policy run to failure policy considering the same parameters as in the previous example the minimum long run expected average cost using the conventional maintenance policies increased to 279 83 348 87 580 96 respectively which are higher than the optimal average cost obtained using the proposed approach with degradation and age control limits table 4 shows the long run expected average cost per unit time and the optimal decision variables for the proposed approach and conventional maintenance policies when the maintenance impact varies the optimal maintenance policy will be changed the relationship of minimal expected average cost for varying maintenance quality parameter μ η is depicted in fig 6 in this real case study the maintenance impact modeled as a random variable has a lower average cost for each maintenance quality parameter μ η this is due to that the real maintenance improvement in the case study is not constant modeling as a constant may either overestimate or underestimate the pump actual condition and therefore lead to high risk and some operational losses from above comparison the main gains of our work are as follows a through investigating the maintenance data the stochastic maintenance model fits better to maintenance quality than deterministic model b through comparison with the deterministic case the proposed cbm model with beta distribution leads to much stricter maintenance control policy with lower control limits c through comparison with other commonly used policies the proposed approach with two level control limit is cost effective and policy efficient 7 conclusions in this paper we have developed a stochastic cbm model for ship pump whose sensor information can be modeled by stochastic process and sudden failure information can be modeled by phm which is influenced by both the age and the degradation state of the pump the quality of maintenance in cbm is considered as stochastic and three stochastic models are presented under these conditions a two level cbm policy is proposed which combines the degradation control limit and age control limit of competing risks the decision variables in cbm optimization is determined by a computational algorithm in smdp framework the effectiveness of the stochastic cbm is demonstrated by a numerical study and a real case of ship pump the aim of this proposed model is to develop a general and practical model for maintaining operating machines it has presented new techniques and broadened the applications of stochastic cbm in this paper there are four main contributions of the proposed model i the first contribution is the modeling of stochastic maintenance quality with three random distributions respectively and the investigations of advantages and disadvantage of these models ii the second contribution is the modeling of the competing risks using phm and illustration of the applicability of the model iii the third contribution is the development of a two level cbm model and illustration of the superiority of the new approach iv the fourth contribution is the development of computational algorithms in smdp framework to solve optimization problem of the stochastic cbm under competing risks the proposed approach can be used in both single unit and multi unit machines it provides new insights into the optimization modeling of stochastic maintenance quality further extension of the model to develop the stochastic cbm for a multi unit machine with non identical units under competing risks is a suitable topic for future research moreover another interesting research direction could be to consider the dynamic environments in competing risks modeling which is valuable for applications of stochastic cbm under ocean environment credit authorship contribution statement chaoqun duan conceptualization of this study methodology algorithm writing zhongjie li project administration investigation fuqiang liu data curation investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
21327,maintenance improvement is affected by many uncertain factors such as maintainer experience machine deterioration state maintenance tools and equipment it is very hard to determine each restoration degree ahead of repair operation therefore this paper considers a maintenance problem in the presence of competing risks degradation and sudden failure under stochastic maintenance quality for a ship pump the degradation process of ship pump is characterized by a non homogeneous gamma process and the hazard rate of sudden failure is described by a proportional hazards model we propose a two level condition based maintenance cbm policy with stochastic maintenance quality the policy combines degradation control limit and age control limit under stochastic maintenance quality of beta distribution normal distribution and uniform distribution respectively in maintenance decision making maintenance optimization problem is formulated and solved by a computational algorithm in a semi markov decision process smdp framework with the objective of minimizing the long run expected average cost the proposed model is illustrated using a numerical study and a real case study of ship pump respectively and comparative results show the effectiveness and superiority of our approach keywords condition based maintenance stochastic maintenance quality maintenance optimization control limit policy 1 introduction ship pump is the key component for water transportation and pollution draining for shipborne and it is widely used in ocean industries in recent decades however extreme operation conditions on ocean such as salt water random shock and humid environment might cause serious damage and fatigue on the ship pump and consequently lead to unexpected breakdown operational losses and safety hazards li et al 2020 for these reasons advanced maintenance technique i e cbm is desired to perform based on the actual operating status of the pump before failure occurs cipollini et al 2018 current maintenance practices use age based or experience based policy to maintain the ship pump which is not effective and may easily result in high risks of pipe blockage and effluent backflow therefore development of cbm for ship pump is significantly necessary and pressing in maintaining desirable reliability and satisfactory performance of shipborne hwang et al 2018 garbatov et al 2018 dong and frangopol 2015 the existing maintenance strategies can be classified as preventive maintenance which repair is taken before failure and corrective maintenance which repair is performed after the failure occurs tang et al 2015 cbm combines preventive maintenance and corrective maintenance to perform repair according to the monitored operating conditions zou et al 2019 the aim of cbm is to jointly determine when and what the maintenance should be taken some successful examples have been implemented to demonstrate the effectiveness of cbm in real applications scheu et al 2019 tan et al 2019 among these cases maintenance models are categorized into two types deterministic maintenance model and stochastic maintenance model research works related to deterministic maintenance assumed that the machine can be repaired to a certain operating condition give a maintenance action the action restoration could be perfect or imperfect for which brings the machine state to a brand new or to a condition between new and old respectively maintenance with full perfect restoration accounts for majority of cbm applications in various cases such as boring machines gear boxes lasers etc tang et al 2015 li et al 2019 duan et al 2020 while maintenance with partial imperfect restoration has extensive variants including cost related recovery model liu and huang 2010 failure rate reduction model nakagawa 1988 age reduction model kijima et al 1988 and hybrid model combining the failure rate reduction and the age reduction lin et al 2001 xia et al 2015 even although models with assumption of deterministic maintenance effects are quite convenient for maintenance modeling and optimization especially for modern complex machines they usually do not truly reflect the real status of the system after machine being repaired this is due to that the maintenance restoration is largely affected by many uncertain or unknown factors such as maintainer experience machine deterioration state maintenance tools and equipment as an extension to deterministic maintenance stochastic maintenance considers that quality of maintenance is a random variable which can be described by a certain distribution this practical consideration was proposed by wu and clementscroome 2005 to assume the machine condition falls into a fixed degradation interval with constant probability after repair for which the improvement follows uniform distribution khatab and aghezzaf 2016 further assumed maintenance quality follows beta distributions to model age reduction factors for binary state system maintenance scheduling more generally duan et al 2018a assumed multiple maintenance options with different level of stochastic quality following beta distributions in a selective maintenance scheduling for variety of multi unit systems another stochastic maintenance model is probabilistic repair model which assumes that maintenance improvement is equivalent to minimal repair no change with probability p and equivalent to preventive maintenance a certain change with probability 1 p brown and proschan 1983 shahraki et al 2020 this considered maintenance improvement factor is indeed a discrete random variable dependent on deteriorating state maintenance cost and time besides these mentioned works few papers have been focused on stochastic maintenance to develop and implement cbm models the essential part to analyze and optimize a cbm policy is to develop a suitable cbm model tang et al 2015 cipollini et al 2018 hwang et al 2018 in cbm models the evolution of the failure process and its underlying degradation path should be modeled according to practical deterioration of the machine asuquo et al 2019 the failure processes may interact each other internally and externally the occurrence of external shock might cause a sudden increase of deterioration level while the deterioration might increase the hazard rate of random shock and lead to catastrophic failure this interaction between shock and gradual degradation has been studied in the literature by considering dependent competing risks process currently research works focusing on system competing risks mainly apply three approaches to model the failure interactions in cbm namely degradation shock model dependent hidden markov model and proportional hazards model phm degradation shock model was proposed earlier than other approaches to model machine degradation and sudden failure as two evolution processes and defined that the sudden shock may cause ultimate random failure as well as degradation failure when the level of system deterioration crosses the predetermined limit the main challenge for the degradation shock model is the definition of failure interactions which contains lots of ideal assumptions and cannot be sufficiently verified by real cases dependent hidden markov model proposed by akram and makis khaleghei and makis 2016 who assumed that the time to catastrophic failure and the sojourn time in the healthy state follow a bivariate distribution they have provided detailed parameters estimation procedures and proved the effectiveness of the proposed approach with real applications in transmission units gear boxes and machine tools li et al 2019 duan et al 2020 phm is a natural candidate to model the competing risks by incorporating the degradation process and sudden failure as covariate and baseline function to model the hazard rate of the machine it was originally proposed by makis and jardine 1992 to model a single failure mode i e hard failure and then extended by tang et al 2015 to model the competing risks of hard failure and degradation failure in gaas lasers due to convenient concept and flexible covariate process phm model was generally used in partially observable system modeling and it was extended with wiener covariate zhao et al 2016 gamma covariate duan et al 2018b markovian covariate wu and ryan 2011 normal covariate liu et al 2017 to fit different degradation patterns in complex systems nevertheless most phms in the literature have focused mainly on the sudden hard failure mode the failure of degradation process has not been sufficiently discussed in the cbm community zhou et al 2014 duan and deng 2020 furthermore existing maintenance models for phm considered the quality of maintenance on machine degradation restoration as ideal which is not true when we check the degradation interactions for whole life cycle of machine liu et al 2017 hu and chen 2020 moreover even some works have proposed maintenance policy for competing risks in phm these maintenance strategies only considered the control limit of machine hazard rate or degradation state an efficient two level control limit policy was not considered in maintenance decision making tang et al 2015 jafari et al 2018 up to now very little work has been devoted to analyzing the competing risks with stochastic maintenance quality to remedy this gap in this paper we focus on the cbm problem of competing risks with stochastic maintenance quality both degradation and aging processes limits are considered as decision variables for developing cbm policy stochastic maintenance quality is also studied in our policy and a detailed comparison by numerical and real case studies is presented the proposed approach differs from the existing works in that a it presents a competing risks model incorporating degradation failure and hard failure b it investigates the different stochastic maintenance qualities under new proposed cbm policy c it develops a computational algorithm in smdp framework to obtain the maintenance decision variables the remaining parts of this paper are structured as follows section 2 formulates the competing risks by modeling pump s degradation as gamma process and hard failure as phm section 3 describes a new cbm policy with three commonly used stochastic maintenance quality models section 4 formulates and optimizes the cbm problem in the smdp framework section 5 presents a numerical study to illustrate the performance of three stochastic maintenance quality models in the proposed cbm section 6 further verifies the proposed approach through a real case of ship pump section 7 summaries the conclusion and future research directions 2 competing risks modeling generally ship pump experiences a degradation failure when its degradation state reaches a certain level and a sudden failure which occurs unexpectedly and stops pump from functioning the ship pump is under periodical inspections to provide information of degradation levels at discrete time epochs t n n h n 1 2 3 which is the case in practices based on the nature of competing risks the modeling approach involves two distinct sub modeling approaches degradation signal modeling approach and sudden failure modeling approach 2 1 model of system degradation the ship pump is subject to a continuous accumulation of wear over time and its degradation i e performance loss path usually presents an non decreasing and continuous pattern the degradation path can be thought as the accumulation of an infinite number of small shocks which increases with aging and is characterized by a scalar random variable do et al 2015 for such a system gamma process which can be considered as an accumulation of a sequence of small increments is an excellent candidate to describe such a monotonic degradation path to model the degradation process it is assumed the deterioration of the pump y t t r evolves like a non stationary gamma stochastic process g a α t β and the probability density function is given by f y t y β α t γ α t y α t 1 e β y i y 0 where i y 0 is an indicator function i y 0 1 if y 0 otherwise i y 0 0 α t is non linear shape parameter with form α t c t d and β 0 is the scale parameter γ α t 0 u α t 1 e u d u is the gamma function the degradation model has the following properties y 0 is a known initial state and is 0 for any given inspection times the increments y n t y t n y t n 1 are independent for any consecutive inspection points 0 t n 1 t n the random increment y n y t n y t n 1 follows a gamma distribution with shape parameter α t n 1 α t n and scale parameter β the mean deterioration speed between two inspection points is equal to α t n 1 α t n β and the variance is equal to α t n 1 α t n β 2 α t is a given monotone increasing function parameter estimates for gamma process can be obtained by maximizing the logarithm of the likelihood function of the deterioration increments with respect to c d and β van noortwijk 2009 cinlar et al 1977 if the degradation failure threshold d f is given the probability of degradation failure for the next inspection interval n h n 1 h conditioning on the current observation i e inspected degradation level y t y t d f can be expressed by 1 p r t n 1 h y t y t d f d f y t f z α n h β d z 2 2 model of sudden failure when a ship pump is functioning the sudden failure is more likely to occur with service time the sudden failure can interrupt functioning state and cause unexpected catastrophic loss in this paper we assume that the occurrence rate of sudden failures is described by the proportional hazards model see e g kumar and klefsjo 1994 which explicitly includes both the effect of the age and the degradation state it can be expressed by the following relation 2 h t y t h 0 t ψ y t ϒ where h 0 t denotes baseline failure rate at time t ψ y t ϒ is positive function with a regression parameter ϒ depending on the degradation state of y t the survival function is given by p ξ 2 t y s 0 s t exp 0 t h 0 s ψ y s ϒ d s where ξ 2 is the time of sudden failure for the pump which has not failed by time n h if the latest observation is y n h y n the conditional reliability function of surviving beyond n h t for any 0 t h can be approximated as r y n n t p ξ 2 n h t ξ 2 n h y n exp n h n h t h 0 s ψ y n ϒ d s exp ψ y n ϒ n h n h t h 0 s d s thus the expected sojourn time for pump to keep functioning during interval n h n h a is given by τ y n n a 0 a r y n n t d t 0 a exp ψ y n ϒ n h n h t h 0 s d s d t since we consider two failure modes the pump s time to failure is the minimum failure time among the degradation failure time ξ 1 and sudden failure time ξ 2 and can be obtained as ξ min ξ 1 ξ 2 with eq 2 the hazard rate of the pump at the n th inspection epoch is given by 3 h n h y n h h 0 n h ψ y n h ϒ the sudden failure is characterized by the phm based on the competing risks model we develop a maintenance model in the next section 3 maintenance model 3 1 maintenance policy consider a repairable pump system described as in section 2 the degradation state of the system is hidden and the degradation failure is non self announcing no indicator can exhibit the degradation state except to do an inspection the system starts working at time t 0 and is inspected every h time units the inspections are assumed to be perfect and incurred a cost c i combining the degradation based policy and age based policy a two level control limit policy is considered three types of maintenance actions are available on the pump and the cbm policy is as follows corrective maintenance is performed which consumes t s time units and c s cost at inspection epochs when the degradation state exceeds degradation failure threshold d f corrective maintenance is performed with the expected time t h and cost c h right after a sudden failure occurs preventive maintenance is triggered at the expected time t p and cost c p when the degradation level of the pump system reaches degradation control limit w at inspection epoch a preventive replacement is triggered at the expected time t r and cost c r when the age of the pump system exceeds the age control limit t where t k h and t t t is the maximum predetermined age a corrective maintenance or replacement action can be either a physical replacement or an overhaul or repair such that the pump system is as good as new after the replacement even though both the corrective maintenance actions for degradation failure and sudden failure put the pump system back in the as good as new state they are not necessarily identical in practices because the corrective maintenance for sudden failure is unplanned and is considered to be more complex and more expensive the preventive maintenance is assumed to be imperfect with stochastic restoration impact on the system degradation state which is practical in real situations the decisions variables in this maintenance policy are age control limit t and degradation control limit w for initiating preventive maintenance replacement the objective is to jointly optimize the age control limit and degradation control limit to minimize the long run expected average cost per unit time 3 2 stochastic quality of maintenance in the literature related to maintenance strategy keizer et al 2017 alaswad and xiang 2017 a system is typically assumed to be restored to a certain condition by a deterministic quality of a maintenance action however due to the expertise differences and maintenance environment factors the restoration of a maintenance action is not fixed throughout this paper the quality of maintenance is assumed to be stochastic and characterized by a random variable η after a maintenance operation the degradation level y t of the pump system is reduced to y t 1 η where η for 0 η 1 is the degradation reduction coefficient accordingly the degradation of system becomes to initial new status if its deterioration is reset to zero with reduction coefficient η 1 while it becomes as bad as old if the reduction coefficient η 0 duan et al 2018a zhao et al 2017 therefore a random variable η is used to represent the new degradation reduction factor which characterizes the stochastic maintenance quality since the probability density function f η and cumulative distribution function f η of the stochastic maintenance quality are defined on the support 0 1 we use a beta distribution to model the random variable η which is defined as f η 1 b a b η a 1 1 η b 1 where a and b for a 0 b 0 are shape parameters b a b 0 1 t a 1 1 t b 1 d t is the beta function the expected value μ η and the standard deviation σ η of random variable η are μ η a a b σ η a b a b 2 a b 1 the stochastic quality of maintenance under different expected improvements is depicted in fig 1 in the figure the curves corresponds to the probability density functions of the stochastic maintenance improvements with expected values and standard deviations on 0 25 0 01 0 5 0 01 0 75 0 01 respectively in this work the improvement of maintenance is set on degradation process this is due to that the degradation is observable and measurable the maintainer can evaluate the maintenance improvement through the degradation measurement after repair after repair operation the system degradation will restore system to state y t 1 η besides beta distribution two models have appeared in literature to model the quality of maintenance which are normal distribution and uniform distribution for the maintenance quality follows normal distribution the stochastic maintenance quality is defined on the support 0 1 the corresponding probability density function is given by f η 1 2 π σ 2 exp η μ η 2 2 σ 2 for 0 η 1 0 1 2 π σ 2 exp η μ η 2 2 σ 2 d η for η 0 1 1 2 π σ 2 exp η μ η 2 2 σ 2 d η for η 1 where μ η is the expected value of random variable η σ η is the standard deviation since normal distribution is defined on the support we assume that the possible values of the reduction coefficient η fall within 0 1 for the values falling into intervals smaller than 0 they are considered to be 0 while for values greater than 1 are considered to be 1 thus we re define the probability density function and the new f η is a hybrid function the expected average value μ η can be obtained as μ η 1 1 2 π σ 2 exp η μ 2 2 σ 2 d η 0 1 1 2 π σ 2 exp η μ 2 2 σ 2 η d η and the standard deviation σ η can be calculated by σ η 2 0 1 η μ η 2 f η d η μ η 2 0 1 2 π σ 2 exp η μ 2 2 σ 2 d η 1 μ η 2 1 1 2 π σ 2 exp η μ 2 2 σ 2 d η fig 2 shows the stochastic maintenance model under normal distribution with cases of μ η σ η 0 25 0 05 μ η σ η 0 5 0 05 and μ η σ η 0 75 0 05 respectively the third stochastic model used in preventive maintenance quality is uniform distribution which has equal probability for different value of η the probability density function is defined on the support as well and can be expressed by f η 1 m for 0 η 1 0 otherwise where m is the number of intervals divided in the support 0 1 the support is defined by the two parameters 0 and 1 which are the minimum and maximum values of maintenance improvement the quality of maintenance is assumed to have probability of 1 m in each small interval there are some limitations for applying uniform distribution to model the quality of imperfect maintenance on the one hand the improvement of maintenance is fixed and it does not support multiple levels maintenance policy on the other hand the restoration of maintenance is equal for each deteriorating state which is violated with maintenance practices in real world situations 4 maintenance optimization in smdp framework the objective of our maintenance policy is to find the optimal values of the control limits w t to initiate a preventive maintenance replacement that minimizes the long run expected average cost per unit time by renewal theory the cost minimization problem is equivalent to finding optimal control limits w t such that 4 g w t e w t c c e w t c l inf e w t c c e w t c l subject to 5 0 w d f 6 0 t t where c c and c l denote the cycle cost and cycle length respectively constraints 5 and 6 confine the ranges of the control limits w t to optimize the maintenance policy we now develop a computational algorithm in the smdp framework to determine the optimal control limits w t the degradation process at each inspection epoch is monitored suppose that the pump is operational at the n th inspection epoch n h then we compute the hazard rate using eq 3 generally the computation of the smdp requires discretization of the possible range of y n 0 d f we partition the interval of the degradation level 0 d f into a fixed large l subintervals with constant length δ d f l and define d f as the failure state f the number of subintervals l should be selected properly the more accurate results will be obtained by choosing the larger number of subintervals l however the computational time increases therefore the number of subintervals should be selected big enough to get the precise results in a reasonable time if at inspection point the observed system degradation y t is in i d f l i 1 d f l then the degradation process is defined to be in state i if the observed system degradation exceeds the degradation level w then the process is defined to be in p m state before calculating the transition probabilities the exact definitions of the state space for the smdp are required state 0 0 the system is in as good as new state state l n the first component denotes the state of the observed degradation at time n h and the second component is the operating age of the system at time n h state p m the value of observable degradation crosses the degradation level w a preventive maintenance action is performed state f the value of observable degradation reaches the degradation failure threshold d f a corrective maintenance action is performed state r the age of the system reaches the age level t a replacement is initiated therefore the state space of smdp can be represented as s s 1 s 2 s 3 s 4 s 5 where s 1 y n y 0 w n h t n n s 2 p m s 3 f s 4 r s 5 0 0 with the definition of the state space of the smdp for cost minimization problem the smdp is determined by the following quantities tijms 1994 p i j the probability that at the next epoch the system will be in state j s given the present state is i s τ i the expected sojourn until the next decision epoch given the current state i s c i the expected cost incurred until the next decision epoch given the current state i s with the quantities defined above for fixed control limits w t the long run expected average cost g w t can be obtained by solving the following linear equations v k c k g w t l s p k l v l for each k s 7 v s 0 for some s s where v k is the relative value the optimal control limits w t and corresponding minimal average cost will be obtained by iteratively solving 7 the remainder of the mathematical analysis in this section is devoted to deriving closed form expressions for the smdp quantities p i j τ i c i to proceed with the smdp approach the transition probability for gamma degradation process of pump is required since the state of deterioration process is only observable at inspection points it may transit to any state at any time between two inspections for the degradation process the transition probability from state l at current inspection n h to l at the next inspection n 1 h can be formulated as p l l h l l δ l l 1 δ β α n 1 h α n h γ α n 1 h α n h y α n 1 h α n h 1 e β y d y p l w h l l δ l l 1 δ β α n 1 h α n h γ α n 1 h α n h y α n 1 h α n h 1 e β y d y p l d f h 1 0 l l 1 δ β α n 1 h α n h γ α n 1 h α n h y α n 1 h α n h 1 e β y d y the first term indicates the probability of system degradation transiting to state l under control limit w the second term means the probability of system degradation going to state in w d f the last term shows the probability that system degradation exceeds d f at the next inspection next we present the derivation of the required smdp transition probabilities 4 1 developing the transition probabilities the smdp transition probabilities for the states defined in the previous paragraphs are calculated as follows 1 assume that the system is in the state l n where l δ d f n h t then the transition probability to the next decision epoch at state l n 1 where l δ d f n h t is given by p l n l n 1 p y n 1 l δ l 1 δ ξ 2 n 1 h y n l δ l 1 δ ξ 2 n h the right side of formula is the probability that the system degradation will not exceed the degradation control limit w the age of the system will not exceed age control limit t and the system will not fail in the next inspection interval then this probability can be calculated as p y n 1 l δ l 1 δ ξ 2 n 1 h y n l δ l 1 δ ξ 2 n h p y n 1 l δ l 1 δ ξ 2 n 1 h y n l δ l 1 δ ξ 2 n h p ξ 2 n 1 h y n l δ l 1 δ ξ 2 n h p l l h r l n h 2 if the system degradation level crosses the degradation control limit i e l δ w at the next decision epoch given the current state l n where l δ d f n h t then the system goes to the p m state and the transition probability is given by p l n p m p y n 1 w d f ξ 2 n 1 h y n l δ l 1 δ ξ 2 n h p ξ 2 n 1 h y n l δ l 1 δ ξ 2 n h p l w h r l n h 3 if the degradation state of the system reaches the failure threshold d f at the next decision epoch given the current state l n where l δ d f and n h t then the system goes to the f state and the transition probability is given by p l n f p l d f h r l n h where p y d f h is the probability that system will exceed the failure threshold d f at inspection interval h 4 if the age of the system exceeds the age level t at the next decision epoch given the current state l n where l δ d f and n h t then the system goes to the r state and the transition probability is given by p l n r r l n h 5 if the sudden failure occurs the corrective maintenance will be set up which brings the system back to state 0 0 then the transition probability is given by p l n 0 0 1 r l n h 6 new cycle begins when corrective maintenance action or age replacement is taken which is given by p f 0 0 1 p r 0 0 1 since the quality of preventive maintenance is stochastic instead of returning back to 0 0 the system will go to state l n 1 with probability p p m l n 1 after preventive maintenance action the p p m l n 1 is given by p p m l n 1 1 l l 1 l 1 l l 1 η d f η where l is the degradation state before the preventive maintenance with impact between 1 l l and 1 l 1 l the degradation state returns back to the state l with probability p p m l n 1 in the next subsection the expected sojourn times and the expected cost in each state are determined 4 2 computing the mean sojourn times and expected costs we consider different scenarios of mean sojourn times and expected costs for smdp states which are presented as follows the mean sojourn time and expected cost incurred until the next inspection epoch at state l n 1 where l δ d f n h t given the current state l n where l δ d f n h t are given by τ l n 0 h r l n t d t 1 r l n h t h c l n c i 1 r l n h c h when the degradation process crosses the failure threshold d f the mean sojourn time and expected cost in the failure state f are given by τ f t s c f c i c s when the system reaches the age control limit t the mean sojourn time and expected cost in the replacement state r are given by τ r t r c r c i c r when the system degradation level reaches the control limit w the mean sojourn time and expected cost in the preventive maintenance state p m are given by τ p m t p c p m c i c p by substituting the above quantities in 7 the optimal values of w t and corresponding minimal long run expected average cost per unit time can be obtained by solving the linear equations in the smdp algorithm an appropriate l to partition the continuous state space y t t 0 is needed in this algorithm a basic approach rule is developed to determine l which is given by the following expression 8 g w t l 2 u 1 g w t l 2 u ε where l is positive integers and ε is the selected small number 5 comparison of maintenance quality through a numerical study the purpose of our work is twofold one is to investigate the stochastic maintenance quality the other is to validate the effects of the proposed cbm model in this section we compare the proposed stochastic maintenance models with deterministic maintenance model through a numerical study we assume that the pump system deterioration follows a phm with dependent degradation failure and sudden failure the degradation process is described by a non homogeneous gamma process with shape parameter α t 0 63 t 1 09 and the scale parameter β 1 18 the failure threshold d f for the system is 18 the baseline hazard rate is assumed to follow a weibull distribution h 0 t ρ t ρ 1 θ ρ where θ 1 84 ρ 5 5 and ψ y t exp 0 5 y t the system is periodically inspected with h 1 and maximum predetermined age is t 50 we consider the following cost and time parameters in our case to illustrate our maintenance policy c i 5 c s 400 c h 800 c r 600 c p 150 t s 2 5 t h 4 t r 2 5 t p 1 to investigate how the maintenance decision will change with the quality of the maintenance we compare three stochastic models with the deterministic case under different values of μ η from 0 1 to 0 9 under σ η 0 01 the maintenance quality in deterministic maintenance is set to be same as the expected impact of stochastic cases for notation convenience we denote the case of deterministic maintenance as dm since the expected value of uniform distribution is 0 5 regardless of parameters changing the comparison is only made for case of μ η 0 5 for uniform distribution the optimal control limits w t and corresponding expected average cost are obtained using smdp algorithm table 1 indicates the results of optimal control limits w t considering different expected maintenance improvements for four compared cases it can be seen that the control limits increase with the value of μ η which means the higher expected restoration the looser control policy compare with deterministic maintenance quality the beta distribution has a relative lower control limits of w t while normal distribution has a stricter control at the beginning and a looser control after μ η 0 5 the uniform distribution which is not so efficient in practical maintenance quality modeling has the lowest w t with the highest average cost 32 5 among four cases under μ η 0 5 in fig 3 it is clear that the beta distribution has a very similar control limit w with case of deterministic maintenance quality although some small changes in 0 5 0 9 the control limit w of normal distribution shows a high fluctuation and control policy is conservative as expected maintenance improvement is below 0 5 fig 4 shows the minimum expected average cost under different expected maintenance improvement impact we can see that the maintenance quality following beta distribution has smaller expected average cost than deterministic case when μ η 0 3 and the expected average cost becomes almost equal with the deterministic maintenance case as μ η 0 3 in general the expected average cost of beta distribution is either higher or lower than deterministic maintenance case but their costs are very close with increase of expected maintenance impact in contrast the expected average cost of normal distribution shows a highly undulated trend which is much greater than other two cases as μ η 0 4 and much lower as μ η 0 5 the reason of this result is that the normal distribution is a hybrid distribution which is defined on the internal 0 1 when the mean of distribution approaches to 0 1 or to 0 9 the μ η has a large probability to fall into the value of 0 or 1 when μ η equals 0 it has no any restoration effect but incurs maintenance cost which is relative costly in all cases whereas if μ η equals 1 the restoration is perfect with imperfect preventive maintenance cost which is very cost effective through the comparison the maintenance decision is influenced by the maintenance quality different maintenance quality models lead to different control limit policies and operating costs the normal distribution model has a great impact on the maintenance decision making whereas the beta distribution model has not changed too much with deterministic case in the proposed maintenance policy 6 case study 6 1 experimental results to further investigate the performance of the proposed model in real practical applications we study a real diagnostic data set coming from the ship diaphragm pump the major function of this pump is to realize the control of liquid draining and dewatering in the ship the pump is subject to gradual degradation failure and random sudden failure the degradation failure does not halt the pump operating condition but leads to inferior performance the sudden failure will abruptly stop the pump from operating condition the degradation of the ship pump leads to performance loss of diaphragm operating the pump diaphragm operating frequency is periodically inspected every 720 h for collecting degradation information and the maximum lifetime of the pump is 18000 h the pump starts operating with frequency of 35 per second and is considered to be failed if the degradation namely operating frequency loss increases to 25 per second the baseline function of phm is assumed to be weibull distribution with the hazard rate h 0 t ρ t ρ 1 θ ρ and covariate process is gamma process with non linear shape parameter α t c t d using maximum log likelihood method the parameter estimates for both degradation process and baseline function are given in table 2 the stochastic maintenance quality for beta distribution and normal distribution are estimated using the procedure in zhang et al 2015 through the goodness of fit tests we find that anderson darling statistic ad value of beta distribution is 0 218 and p value is above 0 500 while ad value of normal distribution is 18 33 and p value is less than 0 05 for the uniform distribution the test indicates that the maintenance data does not follow this specified distribution therefore we pick the beta distribution as the better fit for modeling the stochastic maintenance quality the expected impact of maintenance improvement μ η and corresponding standard derivation σ η are 0 78 and 0 0093 respectively the pump preventive and corrective time parameters are given by t s 24 t h 36 t r 24 and t p 12 hours respectively the maintenance costs considered in the experiment are given by c i 50 c s 3000 c h 7200 c r 4000 c p 1500 we partition the continuous degradation process 0 25 into l 64 intervals for maintenance optimization in smdp framework the minimum expected average cost per inspection cycle is 255 78 with optimal w 17 64 t 12960 it means the replacement is taken at 18th inspection epoch if no sudden failure and degradation failure occur the computational algorithm in smdp framework for acquiring optimal decision variables w t requires an appropriate discretization l to get the sufficiently precise results with a reasonable time using the proposed model in section 4 the expected average cost with optimal control limits under different discretization l are demonstrated in table 3 when l 32 the expected average cost has not changed much using the stopping rule defined in 8 we can conclude that l 32 the partition leads to a sufficient degree of precision it should be noted that the ai based techniques can be used here to find the optimal decision variables instead of smdp algorithm but the quality of the solution is not stable for this reason we choose smdp algorithm to optimize the maintenance problem since it has complete mathematical derivations and can obtain the stable and optimal decision variables 6 2 case comparison we first compare the proposed model with the maintenance policy which assumes that maintenance improvement is constant same parameters as in the previous case study are considered the maintenance impact is set to be the expected value of beta distribution μ η 0 78 the discretization l is set to 64 as well the minimum long run expected average cost using the maintenance policy with constant maintenance impact has increased to 264 58 with w 18 02 t 13680 which are higher than the optimal average cost and control limits obtained using the proposed approach with stochastic maintenance model fig 5 shows the degradation path plot for the one of data histories with the optimal decision variables w t the stars show the degradation state at each inspection epoch once the degradation state exceeds the degradation control limit w preventive maintenance will be performed for the proposed policy considering stochastic maintenance effect this occurred at the 16th inspection epoch which is one inspection interval earlier than its deterministic counterpart similar result can be seen with age control limit we also have verified the superiority of the proposed approach by comparing the results with the hazard rate based policy age based policy run to failure policy considering the same parameters as in the previous example the minimum long run expected average cost using the conventional maintenance policies increased to 279 83 348 87 580 96 respectively which are higher than the optimal average cost obtained using the proposed approach with degradation and age control limits table 4 shows the long run expected average cost per unit time and the optimal decision variables for the proposed approach and conventional maintenance policies when the maintenance impact varies the optimal maintenance policy will be changed the relationship of minimal expected average cost for varying maintenance quality parameter μ η is depicted in fig 6 in this real case study the maintenance impact modeled as a random variable has a lower average cost for each maintenance quality parameter μ η this is due to that the real maintenance improvement in the case study is not constant modeling as a constant may either overestimate or underestimate the pump actual condition and therefore lead to high risk and some operational losses from above comparison the main gains of our work are as follows a through investigating the maintenance data the stochastic maintenance model fits better to maintenance quality than deterministic model b through comparison with the deterministic case the proposed cbm model with beta distribution leads to much stricter maintenance control policy with lower control limits c through comparison with other commonly used policies the proposed approach with two level control limit is cost effective and policy efficient 7 conclusions in this paper we have developed a stochastic cbm model for ship pump whose sensor information can be modeled by stochastic process and sudden failure information can be modeled by phm which is influenced by both the age and the degradation state of the pump the quality of maintenance in cbm is considered as stochastic and three stochastic models are presented under these conditions a two level cbm policy is proposed which combines the degradation control limit and age control limit of competing risks the decision variables in cbm optimization is determined by a computational algorithm in smdp framework the effectiveness of the stochastic cbm is demonstrated by a numerical study and a real case of ship pump the aim of this proposed model is to develop a general and practical model for maintaining operating machines it has presented new techniques and broadened the applications of stochastic cbm in this paper there are four main contributions of the proposed model i the first contribution is the modeling of stochastic maintenance quality with three random distributions respectively and the investigations of advantages and disadvantage of these models ii the second contribution is the modeling of the competing risks using phm and illustration of the applicability of the model iii the third contribution is the development of a two level cbm model and illustration of the superiority of the new approach iv the fourth contribution is the development of computational algorithms in smdp framework to solve optimization problem of the stochastic cbm under competing risks the proposed approach can be used in both single unit and multi unit machines it provides new insights into the optimization modeling of stochastic maintenance quality further extension of the model to develop the stochastic cbm for a multi unit machine with non identical units under competing risks is a suitable topic for future research moreover another interesting research direction could be to consider the dynamic environments in competing risks modeling which is valuable for applications of stochastic cbm under ocean environment credit authorship contribution statement chaoqun duan conceptualization of this study methodology algorithm writing zhongjie li project administration investigation fuqiang liu data curation investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
21328,in this paper finite element indirect boundary element fe ibe coupling approach based on the isogeometric analysis iga framework is proposed to deal with acoustic structural interaction asi problems numerical simulation of thin walled structures is carried out by using isogeometric reissner mindlin shell theory the isogeometric indirect boundary element method ibem is used to simulate the fluid domain and the coupling formula is established by connecting the primary variables ibem contains information on both sides of the boundary naturally fe ibe coupling method inherits these attractive features fe ibe coupling method has a wide application prospect in general it can not only deal with the common problems but also solve the problems that finite element direct boundary element fe dbe coupling method cannot handle such as the opened boundary problems whose inner and outer boundaries contact the liquid in order to further expand its application range based on the universality of the primary variables in ibem a more generalized coupling formula is derived to solve the hybrid problems with both the closed and opened boundaries numerical examples with analytical solution verify the reliability and stability of the proposed iga fe ibe coupling method and two complex problems in aerospace engineering and ocean engineering are studied in detail keywords isogeometric analysis isogeometric reissner mindlin shell indirect boundary element method acoustic structural interaction 1 introduction the interaction between thin walled structure and fluid is a common problem in engineering in aerospace engineering it is necessary to carry out strict acoustic tests on the instruments inside the rocket in marine engineering submarine acoustic stealth performance is one of the most critical technologies which must be evaluated strictly all of the above are related to asi problems due to the existence of cost constraints and complex models it is necessary to choose appropriate numerical methods to solve these problems naturally we considered two of the most popular numerical methods finite element method fem and boundary element method bem for thin walled structures the shell theory bischoff et al 2018 in fem is based on assumption that the thickness of a thin walled structure is far less than other sizes therefore the deformation along the thickness direction can be ignored which reduces the calculation cost while ensuring sufficient accuracy the fem is also suitable for interior acoustic problems marburg and nolte 2008 such as wave propagation in fluid filled pipe but fem is difficult to deal with the sommerfeld boundary condition sommerfeld 1949 for exterior problems compared with fem based on domain discretization bem only needs to discretize the surface of the model and its fundamental solution naturally satisfies the sommerfeld boundary condition there are two distinct bem techniques in acoustic application the direct boundary element method dbem chertock 1964 seybert et al 1984 koopman and benner 1982 wu 2000 and the ibem wu 2000 filippi 1977 raveendra et al 1998 coox et al 2017 wu et al 2020a for dbem its primary variables are the acoustic pressure p and the derivative p n on only one side of the boundary therefore the dbem can only deal with interior or exterior problems with closed boundaries however a large number of structures with opened boundaries are used in engineering such as plate the wings of aircraft and the fins of submarine while the primary variables of ibem are μ the jump of p and σ the jump of p n which contains the information on both sides of the boundary this feature makes ibem very useful for handling the model whose both sides interact with fluid on the other hand different from dbem which obtains nonsymmetric matrix a variational formulation associated with the double boundary integrals is used in ibem to generate the symmetric matrix it is a feasible idea to combine the fem and bem to deal with asi problems the early work on asi problems using fe be coupling method began wilton 1978 mathews 1986 everstine and henderson 1990 and was prosperously developed by many researchers warszawski et al 2008 brunner et al 2009 chen et al 2014 wu et al 2019 however the limitations of dbem reduce the spectrum of problem types that the method can cover compared with the fe dbe coupling method there are relatively few studies on the combination of ibem and fem mariem et al mariem and hamdi 1987 first combined the classical structural function with the variational formulation of the integral equations to solve the asi problems which was inherited and developed by jeans et al jeans 1990 high order isoparametric elements were implemented in this fe be coupling approach to solve the opened boundary model in which both sides interact with the fluid vlahopoulos et al 1999 combined ibem with fem and the meshes of fem and bem were independent of the coupling interface which makes the calculation more efficient the above fe ibe coupling methods fully inherit the flexibility of the ibem which can not only solve the model with opened boundary but also handle closed problem that only one side of the boundary interacts with the fluid it is important to note that the model in the above literature is of a single type that is either both sides of the entire boundary of the model opened boundary problems or only one side closed boundary problems is in contact with the fluid when we encounter more complex situations in engineering the above fe ibe coupling method is no longer applicable for example a submarine consists of three parts blades fins and fuselage among them the blades and fins are typical opened boundary models with water interaction on both sides while the fuselage is a closed boundary model with no water inside the combination of two typical models makes the submarine a hybrid coupling model with both closed and opened boundaries to the authors knowledge there is no related research on hybrid coupling model on the other hand the incompatible communication between computer aided design cad and computer aided engineering cae is still a challenging issue in order to avoid the time consuming re parameterization and approximation process in lagrange based cae hughes et al 2005 proposed iga which has attracted the attention of many scholars in the field of computational mechanics and becomes a new research hotspot cottrell et al 2009 nguyen et al 2015 iga directly uses the geometry data from cad for numerical analysis while bem requires only the boundary discretization of the model for numerical analysis which makes the existing cad technology and bem combine easily and naturally to form igabem which has been developed by many scholars coox et al 2017 wu et al 2020a simpson et al 2012 2013 peng et al 2017 keuchel et al 2017 gong et al 2019 marussig et al 2015 beam plate and shell theories combined with the iga have been investigated by many researchers in recent years referring to adam et al 2014 2015 yan et al 2020 kiendl et al 2009 2015 benson et al 2010 yang and dong 2019 yang et al 2020 and references therein the fe be coupling method combined with iga is relatively few in the available literature maestre et al 2017 introduced a 3d thin membrane fe be coupling approach combined with analysis suitable t splines ast to study deformable capsules suspended in shear flows liu et al 2018 showed the isogeometric fe be coupling method based on a triangular loop subdivision surface discretization to solve acoustic scattering over thin kirchhoff love shell structures yildizdag et al 2019 presented a non uniform rational b splines nurbs based isogeometric fe be approach for the hydroelastic vibration analysis of the clamped rectangular plates wu et al 2020b introduced two nurbs based isogeometric fe be coupling approaches i e directed coupling method and symmetric iterative coupling method to solve asi problems in this paper the fem ibem and the implementation of the coupling approach are integrated into the nurbs based iga to study various coupling problems to the authors knowledge this paper is the first to combine fe ibe coupling approach with iga to solve asi problems the thin walled structures are discretized by the isogeometric reissner mindlin shell element while ibem is used to model the fluid domain the way to combine the two numerical methods is to connect the primary variables of the fem and ibem on the coupling interface where the mesh density between the structural and the acoustic model is equal by introducing the admissible variation into the equilibrium equation of fem and the boundary integral equation the coupled double integral form is obtained among them the double layer potential μ of the ibem is used as the pressure of fem and the normal particle displacement of fem is converted to the normal velocity of ibem because of the existence of double integral the explicit calculation of the hadamard finite part is avoided by using stokes formula hamdi 1982 atalla and sgard 2015 numerical examples can be divided into three categories a both sides of the model s boundary are in contact with the fluid and the coupling matrix is symmetric b only one side of the closed model boundary interacts with the fluid and this model forms nonsymmetric coupling matrix c the boundary of hybrid model is divided into closed boundary and opened boundary and the resulting coupling matrix is nonsymmetric the organization of this paper is as follows in the next section we introduce the foundations of mathematics including nurbs isogeometric reissner mindlin shell theory and ibem in the third section two coupling approaches are deduced by combining the ibem and fem the fourth section has four numerical examples the first two examples belong to the a model the third example to the b model and the last one to the hybrid model and the conclusions are given in sections 5 2 mathematical background 2 1 nurbs basis function a nurbs surface is formed by the tensor product of two nurbs curves 1 s ξ η i 1 n j 1 m r i j p q ξ η p i j in which p i j are the net of control points with dimension n m and r i j p q ξ η are bivariate nurbs basis functions and defined as 2 r i j p q ξ η n i p ξ m j q η ϖ i j k 1 n l 1 m n k p ξ m l q η ϖ k l where ϖ are the positive weights n i p m j q are the univariate b spline basis functions with degrees p and q and they are defined on the corresponding knot vectors ξ ξ 1 ξ 2 ξ n p 1 ψ η 1 η 2 η m q 1 respectively the univariate b splines basis functions n i p in eq 2 are defined by the cox de boor recursion formula hughes et al 2005 3 n i 0 ξ 1 ξ i ξ ξ i 1 0 o t h e r w i s e n i p ε ξ ξ ξ i ξ i p ξ i n i p ε 1 ξ ξ i p 1 ξ ξ i p 1 ξ i 1 n i 1 p 1 ξ p 1 it should be noted that ξ ξ 1 ξ 2 ξ n p 1 is called the open knot vector if the multiplicity of the first and last knots is equal to p 1 and this kind of knot vectors are applied to the rest of this paper 2 2 isogeometric reissner mindlin shell structural equations the coupling models studied in this paper are limited to dynamics of simple harmonic motion in which the time dependency of all variables are sinusoidal with circular frequency ω for mathematical simplification body force f i and damping μ are neglected so the final equilibrium equation of the structural domain ω s is simplified to 4 σ i j j ρ s ω 2 u i 0 in ω s in which σ ij are the stress components ρ s is the density of the structural material u i are the displacement components i j 1 2 for 2d case i j 1 2 3 for 3d case and the subscript j following a comma represents partial differentiation with respect to the spatial variable the neumann boundary condition is contact forces t i on boundary ω s n i e 5 σ i j n j t i 0 in ω s n and dirichlet boundary condition is the specified displacement u i over ω s d ω s ω s n i e 6 u i u i in ω s d by multiplying eq 4 with a regular admissible function δu i then applying green s formula and considering the neumann boundary condition the weak form is obtained 7 ω s δ ε i j σ i j ω 2 ρ s u i δ u i d ω s ω s n δ u i t i d ω s n where δ ε i j are the virtual stain components the finite element discretization of eq 7 involves the following terms 8 ω s σ i j δ ε i j d ω s δ u t k u ω s ρ s u i δ u i d ω s δ u t m u ω s n δ u i t i d ω s n δ u t f where k is the stiffness matrix m is the consistent mass matrix and f is the external force vector introducing eq 8 into eq 7 the dynamic equilibrium equation is expressed as 9 k u ω 2 m u f all structures involved in this paper are thin walled and the isogeometric reissner mindlin shell theory is used to obtain the stiffness matrix k and the consistent mass matrix m the relevant theory is briefly introduced here benson et al 2010 adam et al 2015 the nurbs exact geometry of a thin shell is depicted in fig 1 and defined as 10 x ξ η ζ r ξ η h 2 ζ n ξ η where x is the position vector with parametric coordinates ξ η ζ in which ζ 1 1 r is the position vector of the midsurface of the shell h is the thickness and n n x n y n z is the unit normal vector on the midsurface the displacement vector of the shell is described by 11 u ξ η ζ a 1 n m r a ξ η u a h 2 ζ θ a n ξ η where u a u ax u ay u az t and θ a θ ax θ ay θ az t are the translation and rotation dofs corresponding to the control points in the global coordinates system respectively and n m are the numbers of control points in ξ and η directions of the nurbs tensor product surface respectively therefore a control point contains 6 dofs in isogeometric reissner mindlin shell theory introducing eq 11 into strain displacement relationship we can obtain the linear strain matrix 12 b b 1 u b 1 θ b a u b a θ b nm u b nm θ where 13 b a u b a θ r a x 0 0 0 r a n z x r a n y x 0 r a y 0 r a n z y 0 r a n x y 0 0 r a z r a n y z r a n x z 0 r a y r a x 0 r a n z z r a n z y r a n x x r a n y y 0 r a z r a y r a n y y r a n z z r a n x y r a n x z r a z 0 r a x r a n y x r a n z z r a n x x r a n y z in which r a h 2 ζ r a the jacobian matrix of the transformation is 14 j x x α a 1 n m r a α x a t h 2 ζ n α α ξ η ξ and the derivatives of the unit normal vector w r t the spatial coordinates are computed by 15 n x j x 1 n α using the transformation matrix qt from the global coordinate system to the local coordinate system we can get the global material constitutive matrix 16 d g qt t d l qt where the superscript g and l refer to global and local coordinates respectively the local orthonormal basis vector is depicted in fig 2 and expressed as l t 1 t t 2 t n t t 1 r ξ r ξ 2 t 2 n t 1 n r ξ r η r ξ r η 2 and 17 d l e 1 ν 2 1 ν 0 0 0 ν 1 0 0 0 0 0 1 ν 2 0 0 0 0 0 5 6 1 ν 2 0 0 0 0 0 5 6 1 ν 2 18 qt l 11 2 l 12 2 l 13 2 l 11 l 12 l 12 l 13 l 13 l 11 l 21 2 l 22 2 l 23 2 l 21 l 22 l 22 l 23 l 23 l 21 2 l 11 l 21 2 l 12 l 22 2 l 13 l 23 l 11 l 22 l 12 l 21 l 12 l 23 l 13 l 22 l 13 l 21 l 11 l 23 2 l 21 l 31 2 l 22 l 32 2 l 23 l 33 l 21 l 32 l 22 l 31 l 22 l 33 l 23 l 32 l 23 l 31 l 21 l 33 2 l 31 l 11 2 l 32 l 12 2 l 33 l 13 l 31 l 12 l 32 l 11 l 32 l 13 l 33 l 12 l 33 l 11 l 31 l 13 where e and v are the young modulus and poisson s ratio respectively l ij i j 1 2 3 are the entries of the local orthonormal basis vector l next the stiffness matrix is 19 k ω s b t d g b d v the singularity of the stiffness matrix caused by the rotation dofs about the normal direction at the control points can be eliminated by introducing a small rotational stiffness of each control point in the system of equation benson et al 2010 the discretized form of m in eq 8 under the reissner mindlin shell theory is 20 m ω s r t m r d v where 21 m ρ s 0 0 0 0 0 0 ρ s 0 0 0 0 0 0 ρ s 0 0 0 0 0 0 ρ s h 2 0 0 0 0 0 0 ρ s h 2 0 0 0 0 0 0 ρ s h 2 r a r a 0 0 0 0 0 0 r a 0 0 0 0 0 0 r a 0 0 0 0 0 0 h 2 ζ r a 0 0 0 0 0 0 h 2 ζ r a 0 0 0 0 0 0 h 2 ζ r a the external force vector is computed as 22 f ω s r t t d s 2 3 the indirect boundary integral formulations considering that ibem is closely related to dbem we first introduce dbem the helmholtz integral formulation is defined as brebbia and dominguez 1994 23 c p p p ω f p q n q g p q p q g p q n q d s q where p and q are the source point and the field point respectively g p q e i k x p x q 4 π x p x q is the fundamental solution in which i denotes the imaginary unit and k is the wavenumber n is unit outward normal vector at q p q and p q n are primary variable and its derivative respectively and c p is defined according to the position of p as 24 c p 0 p ω f ω f 1 p ω f s ψ l n d s p ω f 1 s ψ l n d s p ω f in which ψ l 1 4 π x p x q is the fundamental solution of laplace equation ω f refers to the fluid domain and ω f ω f and ω f represent the corresponding boundaries as shown in fig 3 in the following theory the normal is assigned an outward direction for both internal and external problems as shown in fig 3 thus the integral representations eq 23 of the interior and exterior problems can be written as 25 c p p p ω p q g p q n q p q n q g p q d s q 26 c p p p ω p q n q g p q p q g p q n q d s q adding eq 25 to eq 26 results in 27 c p p p c p p p ω μ q g p q n q σ q g p q d s q where σ q p q n q p q n q and μ q p q p q are the jump of p n and p through ω respectively which are primary variables of ibem and a control point contains 1 dofs in ibem eq 27 is an integral formulation of ibem by applying the corresponding boundary conditions and implementing a variational formulation we can get the solution matrix of the ibem for specific implementation please refer to wu 2000 atalla and sgard 2015 3 fundamental of coupling method in this section we divide the coupling problems into two categories and derive the relevant coupling theory respectively it should be noted that the coupling strategy in this section is not only applicable to the fem and ibem under the iga framework but also to the traditional fem and ibem 3 1 the coupling model in which both inner and outer boundaries are in contact with a fluid for an opened thin walled structure immersed in fluid as seen in fig 4 the new boundary conditions of equilibrium equation are 28 σ i j n j p n i 0 in ω s w where ω s w is the wetted surface of the structure and consists of ω s w and ω s w thus eq 7 becomes 29 ω s δ ε i j σ i j ρ s ω 2 u i δ u i d v ω s n δ u i t i d s ω s w δ u i p n i d s let p and p be the pressures on ω s w and ω s w respectively we can then write the right part of eq 29 as 30 ω s w δ u i p n i d s ω s w δ u i p n i d s ω s w δ u i p n i d s ω s w δ u i μ n i d s the finite element discretization of eq 30 involves the new matrix 31 ω s w δ u i μ n i d s δ u t c u μ μ calculating the normal gradient of the sound pressure of eq 27 32 c x p x n x c x p x n x ω μ y 2 g x y n x n y σ q g x y n x d s y then apply the corresponding neumann condition on the coupling interface ω s w due to p x n x p x n x i ρ f ω v n the primary variable σ 0 and c c 1 into eq 32 we obtain the following equation 33 i ρ f ω v n ω s w μ y 2 g x y n x n y d s y in order to build the relationship between the jump of sound pressure μ the primary variable of ibem and the normal particle displacement the variable of fem on the coupling interface and avoid calculating the hadamard finite part of eq 33 considering v n u n u n e i ω t i ω we construct a new variational formulation as follows 34 ω s w u x n x δ p x d s x 1 ρ f ω 2 ω s w ω s w μ y 2 g x y n x n y d s y δ p x d s x where δp x is the admissible variation of sound pressure the hypersingular integrals ω ω p y 2 g x y n x n y d s y δ p x d s x in eq 34 can be reduced to a weakly singular form by applying the stokes formula wu 2000 as shown in eq 35 35 ω ω μ y 2 g x y n x n y d s y δ p x d s x ω ω g x y k 2 δ p μ n x n y n x δ p n y μ d s y d s x where k is the wavenumber the boundary element discretization of eq 34 involves the following ibem matrices 36 ω s w u x n x δ p x d s x δ p x t c u μ t u 37 ω s w ω s w μ y 2 g x y n x n y d s y δ p x d s x δ p x t d μ the primary variables μ y on the boundary are represented by a set of nurbs splines basis functions and the admissible variations δp x are also represented by the same basis functions combing eqs 29 and 34 the coupled system equations can be obtained and expressed as 38 k ω 2 m c u μ c u μ t 1 ρ f ω 2 d u μ f 0 it is clear that the coupled matrix is symmetric 3 2 the coupling model in which only one side of boundary is in contact with a fluid the previous section is only valid for the thin walled structure which interacts with fluid on both sides as shown in fig 5 when the structure boundary is closed and only one side of the boundary interacts with the fluid the coupling theory must be modified in order to apply the sound pressure of fluid to the structure we modify eq 27 and considering an exterior problem eq 27 becomes 39 p x c x μ x ω μ y g x y n y σ y g x y d s y p ω for the case where only neumann condition is specified over the boundary p n is known and σ 0 thus eq 39 reduces 40 p x c x μ x ω μ y g x y n y d s y the right part of eq 29 now becomes 41 ω δ u x p n x d s x ω c x μ x δ u x n x d s x ω ω μ y g x y n y d s y δ u x n x d s x the source point x is the integration point and must locate inside an element and c x is related to the position of x for all the models in this paper the non smooth part of the physical space only occurs at the joint of the patches and the surface of a complete element projecting on the physical space is smooth so c x is always equal to 0 5 the finite element discretization of eq 41 involves a new matrix 42 ω ω μ y g x y n y d s y δ u x n x d s x δ u t c ˆ μ next eq 43 the derivative of eq 40 builds the relationship between μ the primary variable of ibem and u the primary variable of fem 43 i ρ f ω v f ω μ y 2 g x y n x n y d s y p ω obviously eq 43 and eq 33 are the same in form by the same operation the coupled system equations can be obtained 44 k ω 2 m 0 5 c u μ c ˆ c u μ t 1 ρ f ω 2 d u μ f 0 compared with eq 38 the coupling matrix of eq 44 is unsymmetric 3 3 the hybrid coupling theory in order to expand the application of fe ibe coupling method this section studies a complex hybrid coupling model simultaneously containing the closed and opened boundaries let us redefine the boundary ωa refers to the closed part of the boundary that only one side interacts with the fluid ωb refers to the open boundary of the structure unlike eqs 30 and 41 the right part of eq 29 becomes 45 ω a p δ u x n x d s x ω a c μ x δ u x n x d s x ω a ω μ y g x y n y d s y δ u x n x d s x ω b p δ u x n x d s x ω b μ x δ u x n x d s x the finite element discretization of eq 45 involves three new matrices 46 ω a μ x δ u n d s x δ u t c u μ p a r t a μ ω b μ x δ u n d s x δ u t c u μ p a r t b μ ω a ω μ y g x y n y d s y δ u n d s x δ u t c ˆ p a r t a μ next in order to build the relationship between μ the primary variable of ibem and u the primary variable of fem on the coupling interface we need to get the derivation of the integral equation eq 27 if one side of the boundary is in contact with water the corresponding derivative equation is the same as eq 43 and if both sides of the boundary are in contact with water the corresponding derivative equation is the same as eq 33 although the physical meanings of the two boundaries are different their integral equations are formally the same which makes the subsequent coupling treatment the same as section 3 1 and section 3 2 the final coupling matrix becomes 47 k ω 2 m 0 5 c u μ p a r t a c u μ p a r t b c ˆ p a r t a c u μ t 1 ρ f ω 2 d u μ f 0 4 numerical examples and discussions in this section several numerical examples are presented to demonstrate the validity of fe ibe coupling method because r n x is in the order of o r wu 2000 the big o refers to asymptotic trend g x y n x e i k r 4 π r 1 r i k r n x is in the order of o 1 r and ω g x y n x d s converges in the regular sense rather than only in the cauchy principal value sense singular integrals involved in this coupling formulation are all weak singular integrals wu 2000 atalla and sgard 2015 and can be effectively evaluated by the element subdivision technique atalla and sgard 2015 which is based on a polar coordinate transformation in the parameter space unless otherwise stated the p 1 q 1 gauss points are used for fem elements and the nonsingular elements in bem and the p 2 q 2 gauss points are used for the singular elements in bem where p q is the polynomial degree of basis functions it should be noted that the reissner mindlin assumption causes shear locking effect for shin shells thus the thickness of the shell and degree of basis functions are selected according to the corresponding principles wu et al 2020b which prevents all models from shear locking effect in the first two examples both interior and exterior sides of their boundary interact with the fluid and the corresponding coupling theory is connected with section 3 1 the third example is a closed spherical shell submerged in fluid and excited by a concentrated force which is connected with the coupling theory in section 3 2 the last example is a complex hybrid coupling model from ocean engineering and the hybrid coupling theory is developed to solve this problem 4 1 a sphere shell excited by a plane wave and coupled with internal and external fluids the fluid filled elastic spherical shell excited by plane waves in an unbounded fluid is shown in fig 6 this scattering coupling problem can be calculated analytically junger and feit 1986 considering a plane incident wave of unit magnitude along z axis it is defined as 48 p i n c e i k z due to the existence of the spherical shell the total sound pressure can be decomposed into the incident scattered and elastic components i e 49 p p i n c p s c a t p e l a where p scat is the scattering sound pressure from rigid sphere p ela is the radiation sound pressure of the elastic spherical shell and they can be expressed as junger and feit 1986 50 p s c a t a n 0 i n 2 n 1 j n k a h n k a p n cos θ h n k r where a 1 is the incident wave magnitude j n is the derivative of the nth spherical bessel function of the second kind h n and h n are nth spherical hankel functions of the first kind and their derivatives a is radius of spherical sphere θ is the angle between the incident direction and the response point r is the distance to the center point of the sphere and p n is the legendre s polynomial of order n and 51 p e l a i ρ f c n 0 p b n z m e c n z i n z e n p n cos θ h n k r h n k a in which p b n a k a 2 2 n 1 i n 1 h n k a z i n and z e n denote the internal and external radiation impedance of mode n respectively 52 z i n i ρ f c j n k a j n k a 53 z e n i ρ f c h n k a h n k a z m e c n is the mechanical impedance of order n 54 z m e c n i h ρ s c p a h a ω 2 ω 0 2 2 n 0 i ρ s c p ω h a ω 2 ω n 1 2 ω 2 ω n 2 2 ω 2 1 β 2 ν λ n 1 n 1 where λ n n n 1 ω ωa c p is the dimensionless frequency of the vibrating spherical shell c p e ρ s 1 υ 2 is the phase velocity ω n 1 and ω n 2 are computed by solving the characteristic frequency equation junger and feit 1986 55 ω n 4 1 3 υ λ n β 2 1 υ λ n 2 υ λ n ω n 2 λ n 2 1 υ 2 β 2 λ n 3 4 λ n 2 λ n 5 υ 2 2 1 υ 2 0 in which β 2 h 2 12 a 2 and ω 0 2 2 2 1 υ the material properties of the structure and the fluid as well as the geometry information are listed in table 1 the nurbs model consists of six patches as shown in fig 7 and the polynomial degree of each patch is 4 in order to evaluate the accuracy of the calculation a spherical surface with radius of 3 m is chosen as the reference surface the average relative error of sound pressure on the reference surface is defined in relative l 2 norm form as 56 2 p p r e f 2 p r e f 2 ω p p r e f 2 d s ω p r e f 2 d s where p ref is given by eq 49 the frequency is 50 hz fig 8 shows the convergence using the relative l 2 norm of the sound pressure error in numerical calculation the number of control points ranges from 98 to 602 with dofs from 686 to 4214 and the corresponding number of elements is between 6 and 294 the sound pressure are calculated on the reference spherical surface whose radius is 3 m it can be seen that the algorithm has high accuracy and stable convergence and the slope of the convergence curve is 0 7371 indicating that the algorithm is reliable we chose a mesh the selected mesh in fig 8 with 152 control points 1064 dofs and 24 elements for specific analysis fig 9 shows the scattered sound pressure contour of the reference surface a meridian the yz plane with x 0 on this reference surface is selected and the scattering patterns at the meridian is depicted in fig 10 it shows that the numerical solution is in good agreement with the analytical solution the relative error p p r e f p r e f of sound pressure at the meridian is shown in fig 11 it can be seen that the order of calculation accuracy of the selected mesh is between 10 4 10 5 fig 12 shows the structure of the coupling matrix in eq 38 and it s clear that the matrix profile for nonzero values is symmetric the upper left part of the matrix is from stiffness matrix and mass matrix in fem part the lower right part is from eq 37 in ibem part and the remaining parts are the transformation matrices between fem dofs and bem dofs 4 2 rocket tail the previous example is concerned with the coupling model whose boundary is closed a complex open boundary model is studied here to illustrate the wide applicability of the coupling approach in section 3 1 a sketch of rocket tail structure is shown in fig 13 the diameter and height of the rocket are both 1 m and the height and width of wings are all 0 7 m the height of the outermost end of wings is 0 105 m the nurbs model consists of 5 patches in which a cylindrical surface patch 1 is used as the main body of the rocket and the other four patches patch 2 5 are the same and used as wings of the rocket due to the c0 continuity requirement of each element boundary in the isogeometric reissner mindlin shell theory a complete rocket tail structure can be easily formed by uniformly setting the number of meshes and control points at the joints of each patches without any additional operation this model contains 728 cubic elements and 1228 control points as shown in fig 14 the rocket tail is made of aluminum and is in contact with air its material properties and geometric information are listed in table 2 considering the inner surface of cylinder patch 1 is subjected to an evenly distributed time harmonic pressure load as shown in fig 15 a and the responses of spl sound pressure level are measured at 7 points of ã g as shown in fig 15b their coordinates are shown in table 3 the excitation frequency varies from 6 hz to 720 hz with a frequency step of 6 hz fig 16 shows the frequency response functions of these 7 selected points of which 4 points shown in blue have the same frequency response function because the positions of a b c and d are symmetric the growth trend of these curves is consistent in most frequency bands the spl inside the rocket tail points e g is greater than the spl outside the rocket tail points ã d fig 17 illustrates the distribution of the double layer potential μ the difference of sound pressure at the frequency 600 hz it can be observed that the distribution of μ is axisymmetric and the double layer potential on the 4 wings is consistent corresponding to the symmetry of the structure and the applied pressure load the largest double layer potential occurs at the upper and lower ends of the cylindrical surface because the ends of the cylindrical surface are not supported by other structures however the double layer potential on wings is small because the applied load does not directly affect wings fig 18 shows the normal displacement amplitude of the rocket tail structure at 600 hz similar to fig 17 the displacement is still axisymmetric the maximum displacement occurs at the lower end of the cylindrical surface the displacement of the 4 wings is almost zero because the 4 wings are not loaded vertically a plane as shown in fig 19 through the rocket tail is selected to study the sound field distribution inside and outside the rocket tail the sound pressure contour and corresponding distribution of sound pressure level spl on the selected plane are displayed in fig 20 a and 20b respectively the square dotted box on fig 20 refers to the cross section of the rocket the magnitude of sound pressure is symmetrically distributed on this plane and the maximum value concentrates on the upper and lower ends of the cylindrical surface which is also consistent with fig 17 fig 20b depicts the distribution of spl similar to fig 20a the maximum spl occurs near the inner cylindrical surface which indicates that the internal sound pressure is greater than the external sound pressure 4 3 the coupling problem that only one side of the boundary is in contact with the fluid the first two examples are about the coupling problems where both sides of the problems interact with fluid in this example a closed spherical shell with a vacuum inside excited by a concentrated force in a fluid is studied the displacement of the spherical shell can be determined analytically as junger and feit 1986 57 u θ f i 4 π a 2 ω n 0 2 n 2 z n z n p n cos θ where f is the excitation force θ is the central angle between the excited point and the response point and the specific acoustic impedance z n and the modal impedance z n are expressed as junger and feit 1986 58 z n i ρ f c h n k a h n k a 59 z n i h ρ s c p a ω 2 ω n 1 2 ω 2 ω n 2 2 ω 3 ω n 2 n 1 ν in which c p ω2 ω n 1 ω n 2 and other symbols are expressed in section 4 1 the material properties of the spherical shell and fluid as well as the geometry information are also listed in table 1 numerical simulations are carried out at the frequency 10 hz and the nurbs mesh is the same as the mesh in section 4 1 due to the interpolation property of nurbs basis functions at the junction of the three patches it is easy to enforce the concentrated force at the red point 1 3 1 3 1 3 in fig 21 the average relative error of the displacement is defined in relative l 2 norm in eq 56 fig 22 shows the convergence behavior using the relative l 2 norm of the displacement error it indicates that the calculation accuracy converges steadily with the increase of the number of elements and the slope of the convergence curve is 0 7565 however the calculation accuracy is not as high as that of section 4 1 the selected mesh in fig 22 with 152 control points 1064 dofs and 24 elements is chosen for specific analysis fig 23 shows the corresponding displacement on the spherical shell taking the red point in fig 21 as the north pole it can be clearly seen that the maximum displacement of the spherical shell occurs at the south and north poles and the displacements at the same latitude are consistent the displacement error of this nurbs model is shown in fig 24 it can be observed that the error of the entire spherical surface is almost the same except for some discrete points on the equator fig 25 shows the structure of the coupling matrix which is related to eq 44 and is nonsymmetric compared with the coupling matrix in fig 12 most of the matrix is the same except for the upper right corner of the matrix 4 4 the hybrid coupling problem the previous numerical examples are unitary coupling problems i e the thin walled structure interacts with inside and outside fluids section 4 1 and 4 2 or with fluid only on one side of the closed structure section 4 3 a submarine coupling model simultaneously containing the closed and opened boundaries is studied in this section it consists of 9 patches as shown in fig 26 a including the main body of the submarine fig 26b a cylinder at the end fig 26c 4 blades fig 26d and 3 fins of the submarine fig 26e it is clear that only the boundary of patch 1 fig 26b is ω a while the boundaries of patches 2 9 are ω b the nurbs model possesses 790 cubic elements and 1707 control points as shown in fig 27 we consider the submarine submerged in infinite water and a plane incident wave of unit magnitude propagate in the positive direction along the z axis the angle with z axis is 0 and imping on the submarine the plane incident wave is defined as 60 p i n c e i k z the material properties of the structure and the water are consistent with those in table 1 except the thickness of the shell is 0 015 m and the numerical simulation is carried out at the frequency 100 hz fig 28 shows the distribution of the double layer potential μ at the frequency 100 hz it should be noted that the μ on the surface of the main body fig 28a does not has any physical meaning due to closed boundary for the other parts of the submarine fig 28b 28e μ means the difference of sound pressure the distribution of double layer potential μ over the submarine surface is approximately symmetric to the xoz plane because the whole structure of submarine is not symmetric the maximum value of double layer potential μ the sound pressure difference occurs on the lower blade the distribution of the surface displacement amplitude of the submarine is shown in fig 29 obviously the displacement distribution is nonsymmetric about xoz plane the displacement amplitude on the main body of the submarine fig 29b is relatively minimum and the maximum displacement amplitude occurs on the blade to better understand the coupling effect of submarine on the plane incident wave we choose a plane with z 2 below the submarine fig 30 a shows the magnitude of the sound pressure on the plane when the submarine does not exist obviously because the amplitude of plane wave is set to 1 the magnitude of sound pressure on the plate is also 1 fig 30b and c illustrate the effect of the acoustic structure coupling on the sound field distribution compared with fig 30a the distribution of sound pressure on the plane varies greatly the minimum magnitude of the sound pressure appears under the head of the submarine while the maximum value appears under the tail of the submarine the distribution of the sound pressure is nonsymmetric about the xoz plane similarly select a spherical surface that can wrap the submarine as the reference plane as shown in fig 31 a fig 31a shows the distribution of sound pressure on the spherical surface without submarine fig 31b 31d depict the coupling effect it can be observed that the magnitude of sound pressure is small in front of and under the head of the submarine while the maximum value appears on the left side of the submarine 5 conclusions in this paper the variational ibem coupled with fem under iga framework has been proposed to solve asi problems the thin walled structure is discretized by the first order isogeometric reissner mindlin shell elements and the fluid domain is modeled by the isogeometric ibem the coupling approach absorbs the characteristics of ibem and iga by comparing with the analytical solutions the reliability of the fe ibe coupling method has been verified in addition the fe ibe coupling method has been further extended to solve the hybrid problem through the implementation of numerical examples the following main conclusions can be obtained the fe ibe coupling approach can handle the model whose inner and outer boundaries are in contact with the fluid and the final coupling coefficient matrix is symmetric the fe ibe coupling approach can still solve problems with closed boundary and only one side contacting the fluid but nonsymmetric coupling coefficient matrix is obtained and the primary variable μ has no practical physical meaning although the calculation results of the above two models are stable and convergent the accuracy of the two models is different and the model forming the symmetric matrix has higher accuracy the coupling theory is extended to a more complex practical model that not only contains the opened boundary but also possess the closed structure credit authorship contribution statement y h wu writing original draft software validation c y dong supervision methodology writing review editing h s yang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research is supported by the national natural science foundation of china 11972085 11672038 appendix a the nurbs information of spherical model in section 4 1 and 4 3 is introduced here in detail table a shows the coordinates of control point and corresponding weights one single patch of the spherical surface model and the radius is 1 m table a control point coordinates and corresponding weights table a no x coordinate y coordinate z coordinate weights 1 0 577350269189626 0 577350269189626 0 577350269189626 5 07179676972449 2 0 452719947655045 0 639665429956916 0 639665429956916 4 79591943666392 3 0 159306583842616 0 731396674651543 0 731396674651543 4 43865384675575 4 0 159306583842616 0 731396674651543 0 731396674651543 4 43865384675575 5 0 452719947655045 0 639665429956916 0 639665429956916 4 79591943666392 6 0 577350269189626 0 577350269189626 0 577350269189626 5 07179676972449 7 0 639665429956916 0 452719947655045 0 639665429956916 4 79591943666392 8 0 508838866828441 0 508838866828441 0 734732808579269 4 49447659517890 9 0 183807821047845 0 595410978680763 0 881200594360890 4 09706420074247 10 0 183807821047845 0 595410978680763 0 881200594360890 4 09706420074247 11 0 508838866828441 0 508838866828441 0 734732808579269 4 49447659517890 12 0 639665429956916 0 452719947655045 0 639665429956916 4 79591943666392 13 0 731396674651543 0 159306583842616 0 731396674651543 4 43865384675575 14 0 595410978680763 0 183807821047845 0 881200594360890 4 09706420074247 15 0 224232021854631 0 224232021854631 1 12553383498534 3 64010754132133 16 0 224232021854631 0 224232021854631 1 12553383498534 3 64010754132133 17 0 595410978680763 0 183807821047845 0 881200594360890 4 09706420074247 18 0 731396674651543 0 159306583842616 0 731396674651543 4 43865384675575 19 0 731396674651543 0 159306583842616 0 731396674651543 4 43865384675575 20 0 595410978680763 0 183807821047845 0 881200594360890 4 09706420074247 21 0 224232021854631 0 224232021854631 1 12553383498534 3 64010754132133 22 0 224232021854631 0 224232021854631 1 12553383498534 3 64010754132133 23 0 595410978680763 0 183807821047845 0 881200594360890 4 09706420074247 24 0 731396674651543 0 159306583842616 0 731396674651543 4 43865384675575 25 0 639665429956916 0 452719947655045 0 639665429956916 4 79591943666392 26 0 508838866828441 0 508838866828441 0 734732808579269 4 49447659517890 27 0 183807821047845 0 595410978680763 0 881200594360890 4 09706420074247 28 0 183807821047845 0 595410978680763 0 881200594360890 4 09706420074247 29 0 508838866828441 0 508838866828441 0 734732808579269 4 49447659517890 30 0 639665429956916 0 452719947655045 0 639665429956916 4 79591943666392 31 0 577350269189626 0 577350269189626 0 577350269189626 5 07179676972449 32 0 452719947655045 0 639665429956916 0 639665429956916 4 79591943666392 33 0 159306583842616 0 731396674651543 0 731396674651543 4 43865384675575 34 0 159306583842616 0 731396674651543 0 731396674651543 4 43865384675575 35 0 452719947655045 0 639665429956916 0 639665429956916 4 79591943666392 36 0 577350269189626 0 577350269189626 0 577350269189626 5 07179676972449 the corresponding knot vectors are ξ 0 0 0 0 0 0 5 1 1 1 1 1 and ψ 0 0 0 0 0 0 5 1 1 1 1 1 fig a shows the element boundaries and control points of the patch the other five patches are exactly the same as the patch in fig a and can be obtained by proper rotation after unifying the global numberings of the control points that overlap at the patch boundaries a complete spherical surface model can be obtained fig a distribution of the control points and meshes of the single patch fig a in order to reproduce the numerical examples the rocket model submarine model and other calculation results are provided in https github com yihao wu data 
21328,in this paper finite element indirect boundary element fe ibe coupling approach based on the isogeometric analysis iga framework is proposed to deal with acoustic structural interaction asi problems numerical simulation of thin walled structures is carried out by using isogeometric reissner mindlin shell theory the isogeometric indirect boundary element method ibem is used to simulate the fluid domain and the coupling formula is established by connecting the primary variables ibem contains information on both sides of the boundary naturally fe ibe coupling method inherits these attractive features fe ibe coupling method has a wide application prospect in general it can not only deal with the common problems but also solve the problems that finite element direct boundary element fe dbe coupling method cannot handle such as the opened boundary problems whose inner and outer boundaries contact the liquid in order to further expand its application range based on the universality of the primary variables in ibem a more generalized coupling formula is derived to solve the hybrid problems with both the closed and opened boundaries numerical examples with analytical solution verify the reliability and stability of the proposed iga fe ibe coupling method and two complex problems in aerospace engineering and ocean engineering are studied in detail keywords isogeometric analysis isogeometric reissner mindlin shell indirect boundary element method acoustic structural interaction 1 introduction the interaction between thin walled structure and fluid is a common problem in engineering in aerospace engineering it is necessary to carry out strict acoustic tests on the instruments inside the rocket in marine engineering submarine acoustic stealth performance is one of the most critical technologies which must be evaluated strictly all of the above are related to asi problems due to the existence of cost constraints and complex models it is necessary to choose appropriate numerical methods to solve these problems naturally we considered two of the most popular numerical methods finite element method fem and boundary element method bem for thin walled structures the shell theory bischoff et al 2018 in fem is based on assumption that the thickness of a thin walled structure is far less than other sizes therefore the deformation along the thickness direction can be ignored which reduces the calculation cost while ensuring sufficient accuracy the fem is also suitable for interior acoustic problems marburg and nolte 2008 such as wave propagation in fluid filled pipe but fem is difficult to deal with the sommerfeld boundary condition sommerfeld 1949 for exterior problems compared with fem based on domain discretization bem only needs to discretize the surface of the model and its fundamental solution naturally satisfies the sommerfeld boundary condition there are two distinct bem techniques in acoustic application the direct boundary element method dbem chertock 1964 seybert et al 1984 koopman and benner 1982 wu 2000 and the ibem wu 2000 filippi 1977 raveendra et al 1998 coox et al 2017 wu et al 2020a for dbem its primary variables are the acoustic pressure p and the derivative p n on only one side of the boundary therefore the dbem can only deal with interior or exterior problems with closed boundaries however a large number of structures with opened boundaries are used in engineering such as plate the wings of aircraft and the fins of submarine while the primary variables of ibem are μ the jump of p and σ the jump of p n which contains the information on both sides of the boundary this feature makes ibem very useful for handling the model whose both sides interact with fluid on the other hand different from dbem which obtains nonsymmetric matrix a variational formulation associated with the double boundary integrals is used in ibem to generate the symmetric matrix it is a feasible idea to combine the fem and bem to deal with asi problems the early work on asi problems using fe be coupling method began wilton 1978 mathews 1986 everstine and henderson 1990 and was prosperously developed by many researchers warszawski et al 2008 brunner et al 2009 chen et al 2014 wu et al 2019 however the limitations of dbem reduce the spectrum of problem types that the method can cover compared with the fe dbe coupling method there are relatively few studies on the combination of ibem and fem mariem et al mariem and hamdi 1987 first combined the classical structural function with the variational formulation of the integral equations to solve the asi problems which was inherited and developed by jeans et al jeans 1990 high order isoparametric elements were implemented in this fe be coupling approach to solve the opened boundary model in which both sides interact with the fluid vlahopoulos et al 1999 combined ibem with fem and the meshes of fem and bem were independent of the coupling interface which makes the calculation more efficient the above fe ibe coupling methods fully inherit the flexibility of the ibem which can not only solve the model with opened boundary but also handle closed problem that only one side of the boundary interacts with the fluid it is important to note that the model in the above literature is of a single type that is either both sides of the entire boundary of the model opened boundary problems or only one side closed boundary problems is in contact with the fluid when we encounter more complex situations in engineering the above fe ibe coupling method is no longer applicable for example a submarine consists of three parts blades fins and fuselage among them the blades and fins are typical opened boundary models with water interaction on both sides while the fuselage is a closed boundary model with no water inside the combination of two typical models makes the submarine a hybrid coupling model with both closed and opened boundaries to the authors knowledge there is no related research on hybrid coupling model on the other hand the incompatible communication between computer aided design cad and computer aided engineering cae is still a challenging issue in order to avoid the time consuming re parameterization and approximation process in lagrange based cae hughes et al 2005 proposed iga which has attracted the attention of many scholars in the field of computational mechanics and becomes a new research hotspot cottrell et al 2009 nguyen et al 2015 iga directly uses the geometry data from cad for numerical analysis while bem requires only the boundary discretization of the model for numerical analysis which makes the existing cad technology and bem combine easily and naturally to form igabem which has been developed by many scholars coox et al 2017 wu et al 2020a simpson et al 2012 2013 peng et al 2017 keuchel et al 2017 gong et al 2019 marussig et al 2015 beam plate and shell theories combined with the iga have been investigated by many researchers in recent years referring to adam et al 2014 2015 yan et al 2020 kiendl et al 2009 2015 benson et al 2010 yang and dong 2019 yang et al 2020 and references therein the fe be coupling method combined with iga is relatively few in the available literature maestre et al 2017 introduced a 3d thin membrane fe be coupling approach combined with analysis suitable t splines ast to study deformable capsules suspended in shear flows liu et al 2018 showed the isogeometric fe be coupling method based on a triangular loop subdivision surface discretization to solve acoustic scattering over thin kirchhoff love shell structures yildizdag et al 2019 presented a non uniform rational b splines nurbs based isogeometric fe be approach for the hydroelastic vibration analysis of the clamped rectangular plates wu et al 2020b introduced two nurbs based isogeometric fe be coupling approaches i e directed coupling method and symmetric iterative coupling method to solve asi problems in this paper the fem ibem and the implementation of the coupling approach are integrated into the nurbs based iga to study various coupling problems to the authors knowledge this paper is the first to combine fe ibe coupling approach with iga to solve asi problems the thin walled structures are discretized by the isogeometric reissner mindlin shell element while ibem is used to model the fluid domain the way to combine the two numerical methods is to connect the primary variables of the fem and ibem on the coupling interface where the mesh density between the structural and the acoustic model is equal by introducing the admissible variation into the equilibrium equation of fem and the boundary integral equation the coupled double integral form is obtained among them the double layer potential μ of the ibem is used as the pressure of fem and the normal particle displacement of fem is converted to the normal velocity of ibem because of the existence of double integral the explicit calculation of the hadamard finite part is avoided by using stokes formula hamdi 1982 atalla and sgard 2015 numerical examples can be divided into three categories a both sides of the model s boundary are in contact with the fluid and the coupling matrix is symmetric b only one side of the closed model boundary interacts with the fluid and this model forms nonsymmetric coupling matrix c the boundary of hybrid model is divided into closed boundary and opened boundary and the resulting coupling matrix is nonsymmetric the organization of this paper is as follows in the next section we introduce the foundations of mathematics including nurbs isogeometric reissner mindlin shell theory and ibem in the third section two coupling approaches are deduced by combining the ibem and fem the fourth section has four numerical examples the first two examples belong to the a model the third example to the b model and the last one to the hybrid model and the conclusions are given in sections 5 2 mathematical background 2 1 nurbs basis function a nurbs surface is formed by the tensor product of two nurbs curves 1 s ξ η i 1 n j 1 m r i j p q ξ η p i j in which p i j are the net of control points with dimension n m and r i j p q ξ η are bivariate nurbs basis functions and defined as 2 r i j p q ξ η n i p ξ m j q η ϖ i j k 1 n l 1 m n k p ξ m l q η ϖ k l where ϖ are the positive weights n i p m j q are the univariate b spline basis functions with degrees p and q and they are defined on the corresponding knot vectors ξ ξ 1 ξ 2 ξ n p 1 ψ η 1 η 2 η m q 1 respectively the univariate b splines basis functions n i p in eq 2 are defined by the cox de boor recursion formula hughes et al 2005 3 n i 0 ξ 1 ξ i ξ ξ i 1 0 o t h e r w i s e n i p ε ξ ξ ξ i ξ i p ξ i n i p ε 1 ξ ξ i p 1 ξ ξ i p 1 ξ i 1 n i 1 p 1 ξ p 1 it should be noted that ξ ξ 1 ξ 2 ξ n p 1 is called the open knot vector if the multiplicity of the first and last knots is equal to p 1 and this kind of knot vectors are applied to the rest of this paper 2 2 isogeometric reissner mindlin shell structural equations the coupling models studied in this paper are limited to dynamics of simple harmonic motion in which the time dependency of all variables are sinusoidal with circular frequency ω for mathematical simplification body force f i and damping μ are neglected so the final equilibrium equation of the structural domain ω s is simplified to 4 σ i j j ρ s ω 2 u i 0 in ω s in which σ ij are the stress components ρ s is the density of the structural material u i are the displacement components i j 1 2 for 2d case i j 1 2 3 for 3d case and the subscript j following a comma represents partial differentiation with respect to the spatial variable the neumann boundary condition is contact forces t i on boundary ω s n i e 5 σ i j n j t i 0 in ω s n and dirichlet boundary condition is the specified displacement u i over ω s d ω s ω s n i e 6 u i u i in ω s d by multiplying eq 4 with a regular admissible function δu i then applying green s formula and considering the neumann boundary condition the weak form is obtained 7 ω s δ ε i j σ i j ω 2 ρ s u i δ u i d ω s ω s n δ u i t i d ω s n where δ ε i j are the virtual stain components the finite element discretization of eq 7 involves the following terms 8 ω s σ i j δ ε i j d ω s δ u t k u ω s ρ s u i δ u i d ω s δ u t m u ω s n δ u i t i d ω s n δ u t f where k is the stiffness matrix m is the consistent mass matrix and f is the external force vector introducing eq 8 into eq 7 the dynamic equilibrium equation is expressed as 9 k u ω 2 m u f all structures involved in this paper are thin walled and the isogeometric reissner mindlin shell theory is used to obtain the stiffness matrix k and the consistent mass matrix m the relevant theory is briefly introduced here benson et al 2010 adam et al 2015 the nurbs exact geometry of a thin shell is depicted in fig 1 and defined as 10 x ξ η ζ r ξ η h 2 ζ n ξ η where x is the position vector with parametric coordinates ξ η ζ in which ζ 1 1 r is the position vector of the midsurface of the shell h is the thickness and n n x n y n z is the unit normal vector on the midsurface the displacement vector of the shell is described by 11 u ξ η ζ a 1 n m r a ξ η u a h 2 ζ θ a n ξ η where u a u ax u ay u az t and θ a θ ax θ ay θ az t are the translation and rotation dofs corresponding to the control points in the global coordinates system respectively and n m are the numbers of control points in ξ and η directions of the nurbs tensor product surface respectively therefore a control point contains 6 dofs in isogeometric reissner mindlin shell theory introducing eq 11 into strain displacement relationship we can obtain the linear strain matrix 12 b b 1 u b 1 θ b a u b a θ b nm u b nm θ where 13 b a u b a θ r a x 0 0 0 r a n z x r a n y x 0 r a y 0 r a n z y 0 r a n x y 0 0 r a z r a n y z r a n x z 0 r a y r a x 0 r a n z z r a n z y r a n x x r a n y y 0 r a z r a y r a n y y r a n z z r a n x y r a n x z r a z 0 r a x r a n y x r a n z z r a n x x r a n y z in which r a h 2 ζ r a the jacobian matrix of the transformation is 14 j x x α a 1 n m r a α x a t h 2 ζ n α α ξ η ξ and the derivatives of the unit normal vector w r t the spatial coordinates are computed by 15 n x j x 1 n α using the transformation matrix qt from the global coordinate system to the local coordinate system we can get the global material constitutive matrix 16 d g qt t d l qt where the superscript g and l refer to global and local coordinates respectively the local orthonormal basis vector is depicted in fig 2 and expressed as l t 1 t t 2 t n t t 1 r ξ r ξ 2 t 2 n t 1 n r ξ r η r ξ r η 2 and 17 d l e 1 ν 2 1 ν 0 0 0 ν 1 0 0 0 0 0 1 ν 2 0 0 0 0 0 5 6 1 ν 2 0 0 0 0 0 5 6 1 ν 2 18 qt l 11 2 l 12 2 l 13 2 l 11 l 12 l 12 l 13 l 13 l 11 l 21 2 l 22 2 l 23 2 l 21 l 22 l 22 l 23 l 23 l 21 2 l 11 l 21 2 l 12 l 22 2 l 13 l 23 l 11 l 22 l 12 l 21 l 12 l 23 l 13 l 22 l 13 l 21 l 11 l 23 2 l 21 l 31 2 l 22 l 32 2 l 23 l 33 l 21 l 32 l 22 l 31 l 22 l 33 l 23 l 32 l 23 l 31 l 21 l 33 2 l 31 l 11 2 l 32 l 12 2 l 33 l 13 l 31 l 12 l 32 l 11 l 32 l 13 l 33 l 12 l 33 l 11 l 31 l 13 where e and v are the young modulus and poisson s ratio respectively l ij i j 1 2 3 are the entries of the local orthonormal basis vector l next the stiffness matrix is 19 k ω s b t d g b d v the singularity of the stiffness matrix caused by the rotation dofs about the normal direction at the control points can be eliminated by introducing a small rotational stiffness of each control point in the system of equation benson et al 2010 the discretized form of m in eq 8 under the reissner mindlin shell theory is 20 m ω s r t m r d v where 21 m ρ s 0 0 0 0 0 0 ρ s 0 0 0 0 0 0 ρ s 0 0 0 0 0 0 ρ s h 2 0 0 0 0 0 0 ρ s h 2 0 0 0 0 0 0 ρ s h 2 r a r a 0 0 0 0 0 0 r a 0 0 0 0 0 0 r a 0 0 0 0 0 0 h 2 ζ r a 0 0 0 0 0 0 h 2 ζ r a 0 0 0 0 0 0 h 2 ζ r a the external force vector is computed as 22 f ω s r t t d s 2 3 the indirect boundary integral formulations considering that ibem is closely related to dbem we first introduce dbem the helmholtz integral formulation is defined as brebbia and dominguez 1994 23 c p p p ω f p q n q g p q p q g p q n q d s q where p and q are the source point and the field point respectively g p q e i k x p x q 4 π x p x q is the fundamental solution in which i denotes the imaginary unit and k is the wavenumber n is unit outward normal vector at q p q and p q n are primary variable and its derivative respectively and c p is defined according to the position of p as 24 c p 0 p ω f ω f 1 p ω f s ψ l n d s p ω f 1 s ψ l n d s p ω f in which ψ l 1 4 π x p x q is the fundamental solution of laplace equation ω f refers to the fluid domain and ω f ω f and ω f represent the corresponding boundaries as shown in fig 3 in the following theory the normal is assigned an outward direction for both internal and external problems as shown in fig 3 thus the integral representations eq 23 of the interior and exterior problems can be written as 25 c p p p ω p q g p q n q p q n q g p q d s q 26 c p p p ω p q n q g p q p q g p q n q d s q adding eq 25 to eq 26 results in 27 c p p p c p p p ω μ q g p q n q σ q g p q d s q where σ q p q n q p q n q and μ q p q p q are the jump of p n and p through ω respectively which are primary variables of ibem and a control point contains 1 dofs in ibem eq 27 is an integral formulation of ibem by applying the corresponding boundary conditions and implementing a variational formulation we can get the solution matrix of the ibem for specific implementation please refer to wu 2000 atalla and sgard 2015 3 fundamental of coupling method in this section we divide the coupling problems into two categories and derive the relevant coupling theory respectively it should be noted that the coupling strategy in this section is not only applicable to the fem and ibem under the iga framework but also to the traditional fem and ibem 3 1 the coupling model in which both inner and outer boundaries are in contact with a fluid for an opened thin walled structure immersed in fluid as seen in fig 4 the new boundary conditions of equilibrium equation are 28 σ i j n j p n i 0 in ω s w where ω s w is the wetted surface of the structure and consists of ω s w and ω s w thus eq 7 becomes 29 ω s δ ε i j σ i j ρ s ω 2 u i δ u i d v ω s n δ u i t i d s ω s w δ u i p n i d s let p and p be the pressures on ω s w and ω s w respectively we can then write the right part of eq 29 as 30 ω s w δ u i p n i d s ω s w δ u i p n i d s ω s w δ u i p n i d s ω s w δ u i μ n i d s the finite element discretization of eq 30 involves the new matrix 31 ω s w δ u i μ n i d s δ u t c u μ μ calculating the normal gradient of the sound pressure of eq 27 32 c x p x n x c x p x n x ω μ y 2 g x y n x n y σ q g x y n x d s y then apply the corresponding neumann condition on the coupling interface ω s w due to p x n x p x n x i ρ f ω v n the primary variable σ 0 and c c 1 into eq 32 we obtain the following equation 33 i ρ f ω v n ω s w μ y 2 g x y n x n y d s y in order to build the relationship between the jump of sound pressure μ the primary variable of ibem and the normal particle displacement the variable of fem on the coupling interface and avoid calculating the hadamard finite part of eq 33 considering v n u n u n e i ω t i ω we construct a new variational formulation as follows 34 ω s w u x n x δ p x d s x 1 ρ f ω 2 ω s w ω s w μ y 2 g x y n x n y d s y δ p x d s x where δp x is the admissible variation of sound pressure the hypersingular integrals ω ω p y 2 g x y n x n y d s y δ p x d s x in eq 34 can be reduced to a weakly singular form by applying the stokes formula wu 2000 as shown in eq 35 35 ω ω μ y 2 g x y n x n y d s y δ p x d s x ω ω g x y k 2 δ p μ n x n y n x δ p n y μ d s y d s x where k is the wavenumber the boundary element discretization of eq 34 involves the following ibem matrices 36 ω s w u x n x δ p x d s x δ p x t c u μ t u 37 ω s w ω s w μ y 2 g x y n x n y d s y δ p x d s x δ p x t d μ the primary variables μ y on the boundary are represented by a set of nurbs splines basis functions and the admissible variations δp x are also represented by the same basis functions combing eqs 29 and 34 the coupled system equations can be obtained and expressed as 38 k ω 2 m c u μ c u μ t 1 ρ f ω 2 d u μ f 0 it is clear that the coupled matrix is symmetric 3 2 the coupling model in which only one side of boundary is in contact with a fluid the previous section is only valid for the thin walled structure which interacts with fluid on both sides as shown in fig 5 when the structure boundary is closed and only one side of the boundary interacts with the fluid the coupling theory must be modified in order to apply the sound pressure of fluid to the structure we modify eq 27 and considering an exterior problem eq 27 becomes 39 p x c x μ x ω μ y g x y n y σ y g x y d s y p ω for the case where only neumann condition is specified over the boundary p n is known and σ 0 thus eq 39 reduces 40 p x c x μ x ω μ y g x y n y d s y the right part of eq 29 now becomes 41 ω δ u x p n x d s x ω c x μ x δ u x n x d s x ω ω μ y g x y n y d s y δ u x n x d s x the source point x is the integration point and must locate inside an element and c x is related to the position of x for all the models in this paper the non smooth part of the physical space only occurs at the joint of the patches and the surface of a complete element projecting on the physical space is smooth so c x is always equal to 0 5 the finite element discretization of eq 41 involves a new matrix 42 ω ω μ y g x y n y d s y δ u x n x d s x δ u t c ˆ μ next eq 43 the derivative of eq 40 builds the relationship between μ the primary variable of ibem and u the primary variable of fem 43 i ρ f ω v f ω μ y 2 g x y n x n y d s y p ω obviously eq 43 and eq 33 are the same in form by the same operation the coupled system equations can be obtained 44 k ω 2 m 0 5 c u μ c ˆ c u μ t 1 ρ f ω 2 d u μ f 0 compared with eq 38 the coupling matrix of eq 44 is unsymmetric 3 3 the hybrid coupling theory in order to expand the application of fe ibe coupling method this section studies a complex hybrid coupling model simultaneously containing the closed and opened boundaries let us redefine the boundary ωa refers to the closed part of the boundary that only one side interacts with the fluid ωb refers to the open boundary of the structure unlike eqs 30 and 41 the right part of eq 29 becomes 45 ω a p δ u x n x d s x ω a c μ x δ u x n x d s x ω a ω μ y g x y n y d s y δ u x n x d s x ω b p δ u x n x d s x ω b μ x δ u x n x d s x the finite element discretization of eq 45 involves three new matrices 46 ω a μ x δ u n d s x δ u t c u μ p a r t a μ ω b μ x δ u n d s x δ u t c u μ p a r t b μ ω a ω μ y g x y n y d s y δ u n d s x δ u t c ˆ p a r t a μ next in order to build the relationship between μ the primary variable of ibem and u the primary variable of fem on the coupling interface we need to get the derivation of the integral equation eq 27 if one side of the boundary is in contact with water the corresponding derivative equation is the same as eq 43 and if both sides of the boundary are in contact with water the corresponding derivative equation is the same as eq 33 although the physical meanings of the two boundaries are different their integral equations are formally the same which makes the subsequent coupling treatment the same as section 3 1 and section 3 2 the final coupling matrix becomes 47 k ω 2 m 0 5 c u μ p a r t a c u μ p a r t b c ˆ p a r t a c u μ t 1 ρ f ω 2 d u μ f 0 4 numerical examples and discussions in this section several numerical examples are presented to demonstrate the validity of fe ibe coupling method because r n x is in the order of o r wu 2000 the big o refers to asymptotic trend g x y n x e i k r 4 π r 1 r i k r n x is in the order of o 1 r and ω g x y n x d s converges in the regular sense rather than only in the cauchy principal value sense singular integrals involved in this coupling formulation are all weak singular integrals wu 2000 atalla and sgard 2015 and can be effectively evaluated by the element subdivision technique atalla and sgard 2015 which is based on a polar coordinate transformation in the parameter space unless otherwise stated the p 1 q 1 gauss points are used for fem elements and the nonsingular elements in bem and the p 2 q 2 gauss points are used for the singular elements in bem where p q is the polynomial degree of basis functions it should be noted that the reissner mindlin assumption causes shear locking effect for shin shells thus the thickness of the shell and degree of basis functions are selected according to the corresponding principles wu et al 2020b which prevents all models from shear locking effect in the first two examples both interior and exterior sides of their boundary interact with the fluid and the corresponding coupling theory is connected with section 3 1 the third example is a closed spherical shell submerged in fluid and excited by a concentrated force which is connected with the coupling theory in section 3 2 the last example is a complex hybrid coupling model from ocean engineering and the hybrid coupling theory is developed to solve this problem 4 1 a sphere shell excited by a plane wave and coupled with internal and external fluids the fluid filled elastic spherical shell excited by plane waves in an unbounded fluid is shown in fig 6 this scattering coupling problem can be calculated analytically junger and feit 1986 considering a plane incident wave of unit magnitude along z axis it is defined as 48 p i n c e i k z due to the existence of the spherical shell the total sound pressure can be decomposed into the incident scattered and elastic components i e 49 p p i n c p s c a t p e l a where p scat is the scattering sound pressure from rigid sphere p ela is the radiation sound pressure of the elastic spherical shell and they can be expressed as junger and feit 1986 50 p s c a t a n 0 i n 2 n 1 j n k a h n k a p n cos θ h n k r where a 1 is the incident wave magnitude j n is the derivative of the nth spherical bessel function of the second kind h n and h n are nth spherical hankel functions of the first kind and their derivatives a is radius of spherical sphere θ is the angle between the incident direction and the response point r is the distance to the center point of the sphere and p n is the legendre s polynomial of order n and 51 p e l a i ρ f c n 0 p b n z m e c n z i n z e n p n cos θ h n k r h n k a in which p b n a k a 2 2 n 1 i n 1 h n k a z i n and z e n denote the internal and external radiation impedance of mode n respectively 52 z i n i ρ f c j n k a j n k a 53 z e n i ρ f c h n k a h n k a z m e c n is the mechanical impedance of order n 54 z m e c n i h ρ s c p a h a ω 2 ω 0 2 2 n 0 i ρ s c p ω h a ω 2 ω n 1 2 ω 2 ω n 2 2 ω 2 1 β 2 ν λ n 1 n 1 where λ n n n 1 ω ωa c p is the dimensionless frequency of the vibrating spherical shell c p e ρ s 1 υ 2 is the phase velocity ω n 1 and ω n 2 are computed by solving the characteristic frequency equation junger and feit 1986 55 ω n 4 1 3 υ λ n β 2 1 υ λ n 2 υ λ n ω n 2 λ n 2 1 υ 2 β 2 λ n 3 4 λ n 2 λ n 5 υ 2 2 1 υ 2 0 in which β 2 h 2 12 a 2 and ω 0 2 2 2 1 υ the material properties of the structure and the fluid as well as the geometry information are listed in table 1 the nurbs model consists of six patches as shown in fig 7 and the polynomial degree of each patch is 4 in order to evaluate the accuracy of the calculation a spherical surface with radius of 3 m is chosen as the reference surface the average relative error of sound pressure on the reference surface is defined in relative l 2 norm form as 56 2 p p r e f 2 p r e f 2 ω p p r e f 2 d s ω p r e f 2 d s where p ref is given by eq 49 the frequency is 50 hz fig 8 shows the convergence using the relative l 2 norm of the sound pressure error in numerical calculation the number of control points ranges from 98 to 602 with dofs from 686 to 4214 and the corresponding number of elements is between 6 and 294 the sound pressure are calculated on the reference spherical surface whose radius is 3 m it can be seen that the algorithm has high accuracy and stable convergence and the slope of the convergence curve is 0 7371 indicating that the algorithm is reliable we chose a mesh the selected mesh in fig 8 with 152 control points 1064 dofs and 24 elements for specific analysis fig 9 shows the scattered sound pressure contour of the reference surface a meridian the yz plane with x 0 on this reference surface is selected and the scattering patterns at the meridian is depicted in fig 10 it shows that the numerical solution is in good agreement with the analytical solution the relative error p p r e f p r e f of sound pressure at the meridian is shown in fig 11 it can be seen that the order of calculation accuracy of the selected mesh is between 10 4 10 5 fig 12 shows the structure of the coupling matrix in eq 38 and it s clear that the matrix profile for nonzero values is symmetric the upper left part of the matrix is from stiffness matrix and mass matrix in fem part the lower right part is from eq 37 in ibem part and the remaining parts are the transformation matrices between fem dofs and bem dofs 4 2 rocket tail the previous example is concerned with the coupling model whose boundary is closed a complex open boundary model is studied here to illustrate the wide applicability of the coupling approach in section 3 1 a sketch of rocket tail structure is shown in fig 13 the diameter and height of the rocket are both 1 m and the height and width of wings are all 0 7 m the height of the outermost end of wings is 0 105 m the nurbs model consists of 5 patches in which a cylindrical surface patch 1 is used as the main body of the rocket and the other four patches patch 2 5 are the same and used as wings of the rocket due to the c0 continuity requirement of each element boundary in the isogeometric reissner mindlin shell theory a complete rocket tail structure can be easily formed by uniformly setting the number of meshes and control points at the joints of each patches without any additional operation this model contains 728 cubic elements and 1228 control points as shown in fig 14 the rocket tail is made of aluminum and is in contact with air its material properties and geometric information are listed in table 2 considering the inner surface of cylinder patch 1 is subjected to an evenly distributed time harmonic pressure load as shown in fig 15 a and the responses of spl sound pressure level are measured at 7 points of ã g as shown in fig 15b their coordinates are shown in table 3 the excitation frequency varies from 6 hz to 720 hz with a frequency step of 6 hz fig 16 shows the frequency response functions of these 7 selected points of which 4 points shown in blue have the same frequency response function because the positions of a b c and d are symmetric the growth trend of these curves is consistent in most frequency bands the spl inside the rocket tail points e g is greater than the spl outside the rocket tail points ã d fig 17 illustrates the distribution of the double layer potential μ the difference of sound pressure at the frequency 600 hz it can be observed that the distribution of μ is axisymmetric and the double layer potential on the 4 wings is consistent corresponding to the symmetry of the structure and the applied pressure load the largest double layer potential occurs at the upper and lower ends of the cylindrical surface because the ends of the cylindrical surface are not supported by other structures however the double layer potential on wings is small because the applied load does not directly affect wings fig 18 shows the normal displacement amplitude of the rocket tail structure at 600 hz similar to fig 17 the displacement is still axisymmetric the maximum displacement occurs at the lower end of the cylindrical surface the displacement of the 4 wings is almost zero because the 4 wings are not loaded vertically a plane as shown in fig 19 through the rocket tail is selected to study the sound field distribution inside and outside the rocket tail the sound pressure contour and corresponding distribution of sound pressure level spl on the selected plane are displayed in fig 20 a and 20b respectively the square dotted box on fig 20 refers to the cross section of the rocket the magnitude of sound pressure is symmetrically distributed on this plane and the maximum value concentrates on the upper and lower ends of the cylindrical surface which is also consistent with fig 17 fig 20b depicts the distribution of spl similar to fig 20a the maximum spl occurs near the inner cylindrical surface which indicates that the internal sound pressure is greater than the external sound pressure 4 3 the coupling problem that only one side of the boundary is in contact with the fluid the first two examples are about the coupling problems where both sides of the problems interact with fluid in this example a closed spherical shell with a vacuum inside excited by a concentrated force in a fluid is studied the displacement of the spherical shell can be determined analytically as junger and feit 1986 57 u θ f i 4 π a 2 ω n 0 2 n 2 z n z n p n cos θ where f is the excitation force θ is the central angle between the excited point and the response point and the specific acoustic impedance z n and the modal impedance z n are expressed as junger and feit 1986 58 z n i ρ f c h n k a h n k a 59 z n i h ρ s c p a ω 2 ω n 1 2 ω 2 ω n 2 2 ω 3 ω n 2 n 1 ν in which c p ω2 ω n 1 ω n 2 and other symbols are expressed in section 4 1 the material properties of the spherical shell and fluid as well as the geometry information are also listed in table 1 numerical simulations are carried out at the frequency 10 hz and the nurbs mesh is the same as the mesh in section 4 1 due to the interpolation property of nurbs basis functions at the junction of the three patches it is easy to enforce the concentrated force at the red point 1 3 1 3 1 3 in fig 21 the average relative error of the displacement is defined in relative l 2 norm in eq 56 fig 22 shows the convergence behavior using the relative l 2 norm of the displacement error it indicates that the calculation accuracy converges steadily with the increase of the number of elements and the slope of the convergence curve is 0 7565 however the calculation accuracy is not as high as that of section 4 1 the selected mesh in fig 22 with 152 control points 1064 dofs and 24 elements is chosen for specific analysis fig 23 shows the corresponding displacement on the spherical shell taking the red point in fig 21 as the north pole it can be clearly seen that the maximum displacement of the spherical shell occurs at the south and north poles and the displacements at the same latitude are consistent the displacement error of this nurbs model is shown in fig 24 it can be observed that the error of the entire spherical surface is almost the same except for some discrete points on the equator fig 25 shows the structure of the coupling matrix which is related to eq 44 and is nonsymmetric compared with the coupling matrix in fig 12 most of the matrix is the same except for the upper right corner of the matrix 4 4 the hybrid coupling problem the previous numerical examples are unitary coupling problems i e the thin walled structure interacts with inside and outside fluids section 4 1 and 4 2 or with fluid only on one side of the closed structure section 4 3 a submarine coupling model simultaneously containing the closed and opened boundaries is studied in this section it consists of 9 patches as shown in fig 26 a including the main body of the submarine fig 26b a cylinder at the end fig 26c 4 blades fig 26d and 3 fins of the submarine fig 26e it is clear that only the boundary of patch 1 fig 26b is ω a while the boundaries of patches 2 9 are ω b the nurbs model possesses 790 cubic elements and 1707 control points as shown in fig 27 we consider the submarine submerged in infinite water and a plane incident wave of unit magnitude propagate in the positive direction along the z axis the angle with z axis is 0 and imping on the submarine the plane incident wave is defined as 60 p i n c e i k z the material properties of the structure and the water are consistent with those in table 1 except the thickness of the shell is 0 015 m and the numerical simulation is carried out at the frequency 100 hz fig 28 shows the distribution of the double layer potential μ at the frequency 100 hz it should be noted that the μ on the surface of the main body fig 28a does not has any physical meaning due to closed boundary for the other parts of the submarine fig 28b 28e μ means the difference of sound pressure the distribution of double layer potential μ over the submarine surface is approximately symmetric to the xoz plane because the whole structure of submarine is not symmetric the maximum value of double layer potential μ the sound pressure difference occurs on the lower blade the distribution of the surface displacement amplitude of the submarine is shown in fig 29 obviously the displacement distribution is nonsymmetric about xoz plane the displacement amplitude on the main body of the submarine fig 29b is relatively minimum and the maximum displacement amplitude occurs on the blade to better understand the coupling effect of submarine on the plane incident wave we choose a plane with z 2 below the submarine fig 30 a shows the magnitude of the sound pressure on the plane when the submarine does not exist obviously because the amplitude of plane wave is set to 1 the magnitude of sound pressure on the plate is also 1 fig 30b and c illustrate the effect of the acoustic structure coupling on the sound field distribution compared with fig 30a the distribution of sound pressure on the plane varies greatly the minimum magnitude of the sound pressure appears under the head of the submarine while the maximum value appears under the tail of the submarine the distribution of the sound pressure is nonsymmetric about the xoz plane similarly select a spherical surface that can wrap the submarine as the reference plane as shown in fig 31 a fig 31a shows the distribution of sound pressure on the spherical surface without submarine fig 31b 31d depict the coupling effect it can be observed that the magnitude of sound pressure is small in front of and under the head of the submarine while the maximum value appears on the left side of the submarine 5 conclusions in this paper the variational ibem coupled with fem under iga framework has been proposed to solve asi problems the thin walled structure is discretized by the first order isogeometric reissner mindlin shell elements and the fluid domain is modeled by the isogeometric ibem the coupling approach absorbs the characteristics of ibem and iga by comparing with the analytical solutions the reliability of the fe ibe coupling method has been verified in addition the fe ibe coupling method has been further extended to solve the hybrid problem through the implementation of numerical examples the following main conclusions can be obtained the fe ibe coupling approach can handle the model whose inner and outer boundaries are in contact with the fluid and the final coupling coefficient matrix is symmetric the fe ibe coupling approach can still solve problems with closed boundary and only one side contacting the fluid but nonsymmetric coupling coefficient matrix is obtained and the primary variable μ has no practical physical meaning although the calculation results of the above two models are stable and convergent the accuracy of the two models is different and the model forming the symmetric matrix has higher accuracy the coupling theory is extended to a more complex practical model that not only contains the opened boundary but also possess the closed structure credit authorship contribution statement y h wu writing original draft software validation c y dong supervision methodology writing review editing h s yang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research is supported by the national natural science foundation of china 11972085 11672038 appendix a the nurbs information of spherical model in section 4 1 and 4 3 is introduced here in detail table a shows the coordinates of control point and corresponding weights one single patch of the spherical surface model and the radius is 1 m table a control point coordinates and corresponding weights table a no x coordinate y coordinate z coordinate weights 1 0 577350269189626 0 577350269189626 0 577350269189626 5 07179676972449 2 0 452719947655045 0 639665429956916 0 639665429956916 4 79591943666392 3 0 159306583842616 0 731396674651543 0 731396674651543 4 43865384675575 4 0 159306583842616 0 731396674651543 0 731396674651543 4 43865384675575 5 0 452719947655045 0 639665429956916 0 639665429956916 4 79591943666392 6 0 577350269189626 0 577350269189626 0 577350269189626 5 07179676972449 7 0 639665429956916 0 452719947655045 0 639665429956916 4 79591943666392 8 0 508838866828441 0 508838866828441 0 734732808579269 4 49447659517890 9 0 183807821047845 0 595410978680763 0 881200594360890 4 09706420074247 10 0 183807821047845 0 595410978680763 0 881200594360890 4 09706420074247 11 0 508838866828441 0 508838866828441 0 734732808579269 4 49447659517890 12 0 639665429956916 0 452719947655045 0 639665429956916 4 79591943666392 13 0 731396674651543 0 159306583842616 0 731396674651543 4 43865384675575 14 0 595410978680763 0 183807821047845 0 881200594360890 4 09706420074247 15 0 224232021854631 0 224232021854631 1 12553383498534 3 64010754132133 16 0 224232021854631 0 224232021854631 1 12553383498534 3 64010754132133 17 0 595410978680763 0 183807821047845 0 881200594360890 4 09706420074247 18 0 731396674651543 0 159306583842616 0 731396674651543 4 43865384675575 19 0 731396674651543 0 159306583842616 0 731396674651543 4 43865384675575 20 0 595410978680763 0 183807821047845 0 881200594360890 4 09706420074247 21 0 224232021854631 0 224232021854631 1 12553383498534 3 64010754132133 22 0 224232021854631 0 224232021854631 1 12553383498534 3 64010754132133 23 0 595410978680763 0 183807821047845 0 881200594360890 4 09706420074247 24 0 731396674651543 0 159306583842616 0 731396674651543 4 43865384675575 25 0 639665429956916 0 452719947655045 0 639665429956916 4 79591943666392 26 0 508838866828441 0 508838866828441 0 734732808579269 4 49447659517890 27 0 183807821047845 0 595410978680763 0 881200594360890 4 09706420074247 28 0 183807821047845 0 595410978680763 0 881200594360890 4 09706420074247 29 0 508838866828441 0 508838866828441 0 734732808579269 4 49447659517890 30 0 639665429956916 0 452719947655045 0 639665429956916 4 79591943666392 31 0 577350269189626 0 577350269189626 0 577350269189626 5 07179676972449 32 0 452719947655045 0 639665429956916 0 639665429956916 4 79591943666392 33 0 159306583842616 0 731396674651543 0 731396674651543 4 43865384675575 34 0 159306583842616 0 731396674651543 0 731396674651543 4 43865384675575 35 0 452719947655045 0 639665429956916 0 639665429956916 4 79591943666392 36 0 577350269189626 0 577350269189626 0 577350269189626 5 07179676972449 the corresponding knot vectors are ξ 0 0 0 0 0 0 5 1 1 1 1 1 and ψ 0 0 0 0 0 0 5 1 1 1 1 1 fig a shows the element boundaries and control points of the patch the other five patches are exactly the same as the patch in fig a and can be obtained by proper rotation after unifying the global numberings of the control points that overlap at the patch boundaries a complete spherical surface model can be obtained fig a distribution of the control points and meshes of the single patch fig a in order to reproduce the numerical examples the rocket model submarine model and other calculation results are provided in https github com yihao wu data 
21329,thrust allocation is a key procedure in the dynamic position system dps of marine vessels the present work aims to study the characteristics of dynamic optimization in thrust allocation a two phase analysis process is proposed in phase i the model for thrust allocation is generated from the viewpoint of multiobjective optimization fuel consumption and tear and wear on the thrusters are chosen as objectives multiobjective feasibility enhanced particle swarm optimization algorithm mofepso is applied to find the pareto set of this problem an additional decision making procedure the technique of order preference by similarity to ideal solution topsis is utilized to choose the final compromise solution in phase ii the self organizing map som technique is undertaken to mine the pareto data set a remote operated vehicle rov example is provided for illustrating the above analysis process the effects of relative importance between objectives upon characteristics of thrust allocation are studied the trajectories of decision variables and objectives are examined through the som method results from numerical examples demonstrate that the multiobjective optimization method together with decision making skills can extend the application of optimization in the thrust allocation field the findings in this work add to the understanding of relationships among several aspects of dps keywords thrust allocation dynamic multiobjective optimization mofepso decision making som rov 1 introduction dynamic positioning systems dps are installed in so many marine vessels which are employed in drilling exploration and pipe laying operations the main goal of a dps is to maintain the vessel position and heading when subjected to the environmental disturbance such as wind wave and current usually for safety and better performance vessels installed with dps will have an over actuated control system which means the number of actuators is greater than the required number of degrees of freedom the main function of control allocation also thrust allocation ta is to distribute the generalized force and moment obtained from a high level motion control system into the individual thruster the distribution solution is usually found by the optimization method for over actuated vessels optimization based thrust allocation methods have been extensively used in the previous work a comprehensive survey of optimization based thrust allocation methods and their applications in engineering fields including aerospace ship automotive and the ground vehicle was provided by johansen and fossen 2013 in marine applications optimization algorithms can be classified as conventional gradient based types such as linear programming lp zalewski 2016 quadratic programming qp zalewski 2016 koschorrek et al 2018 sequential quadratic programming sqp arditti et al 2018 witkowska and śmierzchalski 2018 and modern meta heuristic types usually population based for example genetic algorithm ga ren et al 2015 mauro and nabergoj 2016 particle swarm optimization pso ren et al 2015 artificial bee colony abc wu et al 2016 and mine blast algorithm mba li and yang 2019 the modern meta heuristic algorithms can overcome the drawbacks of traditional ones such as depending on the optimization problem type features of the solution space convex or non convex and the initial solutions therefore continuous research and applications of meta heuristic algorithms can be found in this field the optimization model includes three main elements namely objective function decision variables and constraints the objective function reflects the main goal of the model either being minimized or maximized the number of objective functions can be single or multiple in the previous work several characteristics of dps have been chosen as the objective function such as minimization of fuel consumption kim and kim 2018 veksler et al 2016 minimization of tear and wear on thruster and generators johansen and fossen 2013 thrust allocation error minimization arditti et al 2018 koschorrek et al 2018 and minimization of the variation in the power consumption veksler et al 2016 these aspects can be considered separately or together if those characteristics are studied separately a single objective optimization problem will be generated then it is worthy to be noted that so many studies have considered 2 or more characteristics together just through weights to form only one objective that is only one aggregated objective which contains several parts is formed for example fuel consumption resulted from thrusts and angles allocation error characteristics and the singularity avoiding was selected by johansen et al 2004 to form a 4 part objective function through weights and adopt by other works wu et al 2016 xu et al 2018 despite the recent progress of optimization algorithms and applications in thrust allocation several problems in this kind of optimization model construction method i e weighted sum approach are remaining and further research is needed it should be noted first that the aggregated objective function style johansen et al 2004 is not an ordinary weighted sum type like w i f i x however it can be converted to this type just by normalization easily concerning objective construction the previous use of the weighted sum approach has 6 limits as follows 1 during preparing the optimization model different goals or aspects of dps will be chosen as objectives all these aspects have their physical meanings and dimensions after aggregating these aspects through weights the designer can t identify the clear physical meaning of that aggregated objective function then even if the optimal solution has been found by traditional or modern optimization algorithms the connection between this solution and the individual part of the aggregated objective is fuzzy since this is the solution to the aggregated objective function not its part real physical aspect 2 in practical application when command force is well beyond the capability of the effectors the slack variables i e additional decision variables will be introduced johansen and fossen 2013 for minimal thrust allocation error that is thrusts azimuth angles and slack variables will all be considered as decision variables due to aggregating operation the optimization model complexity and search space will increase and the calculation load also rises 3 according to the mechanism of weighting the effects of every individual part are cumulative even if two aspects may be conflicting after aggregating operations through weights the mutual relationships between those aspects are lost then further relationship investigation between individual parts can t be obtained from this aggregating operation 4 it is very hard to determine the weights of each part for example when fuel consumption and allocation error are chosen as parts of objective how can one find the relative importance between these two kinds of aspects exactly johansen et al 2004 different weights will lead to different optimization solutions this may raise difficulties in identifying the real practical solution to the dps besides the phenomena that a larger number annihilates a small number will occur among the individual parts of the aggregated objective function if their weights are not suitable 5 the objective space of individual parts of the objective function is not studied intensively from the viewpoint of multiobjective optimization the weighted sum approach is a popular scalarizing method due to its simplicity when individual parts are conflicting the weighted sum approach can t find certain solutions when the objective space is non convex even if one parametrically varies the weights coello et al 2007 deb 2001 6 during aggregating several aspects into one objective some aspects e g singularity avoiding fossen 2011 johansen et al 2004 wu et al 2016 which do not reflect the goal of the designer have been chosen as an individual objective part in the previous work from the standpoint of optimization singularity avoiding should be treated as constraints not an objective part in terms of decision variables till now very little attention has been paid to defining the bounds of the slack variables before the optimization procedure li and yang 2019 in the previous work the slack variables are introduced in the optimization model at 2 places i e as a part of the objective function thrust allocation error through weight q matrix and thrust constraint through equality condition these slack variables are chosen as decision variables so their bounds should be clearly defined in the optimization model this work has aimed to study the characteristics of thrust allocation from the viewpoint of dynamic multiobjective optimization multi attribute decision making madm hwang and yoon 1981 and data mining skills first to obtain a further comprehension of thrust allocation and break through the limits of the weighted sum approach a multiobjective optimization model for thrust allocation is constructed many modern optimization methods which are known as meta heuristic have been developed in the last 4 decades yang 2018 in this work a newly developed meta heuristic approach multiobjective feasibility enhanced particle swarm optimization mofepso hasanoglu and dolen 2018 algorithm will be used to find the solutions i e the pareto set for this optimization model the characteristics of the solutions from the multiobjective optimization analysis procedure will be investigated and its comparison with the single objective optimization method i e weighted sum will also be studied second decision making is a necessary process in the application of multiobjective optimization for ta it is worthy to be noted that the solution to the multiobjective optimization is usually a set not a single solution as in the single objective optimization problem although several solutions i e the pareto solutions of thrust allocation from multiobjective optimization analysis have been found only one solution will be determined as the control input status at this time and initial condition for the next time step therefore an additional analysis task will follow the optimization process that is a decision making procedure in which the designer has to choose a final compromise solution in the pareto set at this time step in this work a widely used multi attribute decision making madm hwang and yoon 1981 approach the technique of order preference by similarity to ideal solution topsis hwang and yoon 1981 ishizaka and nemery 2013 is employed to choose the final compromise solution from the pareto set it should be noted the data set for the topsis process is from the objective space of the pareto set and the relative importance of each objective i e attribute used in the madm field will be given by the designer the effects of various weights among the attributes upon the allocation solutions will be discussed in detail this two phase operation i e pareto set seeking and decision making will be executed from the beginning of vessel motion the whole history of thrust allocation can be found just by executing this 2 phase analysis along the time axis third when examining the data of thrust allocation solution i e thrusts angles and slack variables and dps aspects such as fuel consumption tear and wear thrust allocation error etc they are high dimensional to study the characteristics of this high dimensional data a dimensionality reduction skill lee and verleysen 2007 self organizing map som approach kohonen 2013 is utilized in this work from 2d graphs of this neural network the designer can mine hidden information among these dimensionalities further the history of each physical parameter can be displayed in the graphs the main contributions of the present work are as follows 1 a two phase analysis framework is proposed for the optimization based thrust allocation together with further data mining based on the som approach 2 the dynamic thrust allocation problem is solved by the modern multiobjective optimization method rather than a traditional weighted sum approach the physical meanings of the objective functions are clear and maintained during the optimization process moreover a suggestion is made to classify objective function construction 3 the solutions to the ta problem at each time step provide more choices for the designer a decision making procedure is integrated into the framework the preferences of the designer can be easily considered through various weights 4 the data mining operations upon the pareto solutions in history can provide more useful information and more understanding of the ta model the remaining of the present work is organized as follows in sec 2 the thrust allocation problem will be defined briefly first and proposed methods will be described including mofepso topsis and som a numerical model a remote operated vehicle rov will be given in sec 3 the obtained results are discussed there finally conclusions and further recommendations are listed in sec 4 2 theory in this section the definition of a dynamic multiobjective optimization problem dmop in thrust allocation is listed first the proposed methods in this work will be described the solutions to the dmop can be found through mofepso and the final compromise solution at each sampling is determined by the topsis procedure finally historical characteristics of thrust allocation will be studied by som skill 2 1 dynamic multiobjective optimization in practical engineering applications so many problems need to optimize several competing objectives simultaneously furthermore those applications are dynamic this means that they have time varying objectives and constraints the optimization tasks about this kind of dmop are twofold finding near optimal pareto front pf and determining the desired solution before the next change comprehensive surveys of dmop can be found in the work of azzouz et al 2017 and raquel and yao 2013 the thrust allocation in vessel application is a typical dynamic optimization problem due to 1 the motion of the ships is continuous in the time axis and 2 several objectives usually conflicting exist during optimization operation if two or more objectives are considered in thrust allocation a dmop will be generated then the characteristic of dmop in the marine field is its time linkage lin et al 2019 in which the decision at each sampling will affect the following behaviours when solving time linkage dmop a series of the static multiobjective optimization problem mop of different periods can be used if the time interval is small enough the characteristics of the dps in each sampling can be regarded as static due to the slow motion of the dynamic positioning process the dmop can be defined as follows min f x t f 1 x t f 2 x t f m x t 1 s t g x t 0 h x t 0 where x decision variables f objective functions to be minimized g and h are inequality and equality constraints respectively f g and h are functions of time t m number of objectives the definition of eq 1 is extended from static mop the basic definitions of static mop pareto set dominance etc may be found in the classical works such as coello et al 2007 and deb 2001 2 2 proposed methods the weighted sum approach is a simple and widely used method for solving mop in which a linear aggregating function is applied to calculate the fitness of the solution the weight usual normalization reflects the relative importance of each objective function the main shortfall of the weighted sum method is that it can t find the pareto solution when the pareto front is not convex even if one parametrically varies the weights an example of 2 objective optimization is shown in fig 1 suppose the weighted sum fitness is as follows 2 fit min w 1 f 1 x w 2 f 2 x where w 1 w 2 1 the optimization procedure is to find the intersection point of lines with slope k w1 w2 and feasible objective space a point is a solution to eq 2 due to its smaller fitness compared with b point it can be observed the near area of c point can t be obtained through this method coello et al 2007 deb 2001 if the designer is interested in this area this weighted sum method is unable to find the solution due to the concave characteristic of the pareto front in section 3 this characteristic of thrust allocation can be encountered in previous work johansen et al 2004 wu et al 2016 several aspects of thrust allocation have been selected as objective functions some of them can be conflicting and aggregated into one final function just like eq 2 the essential feature of that operation is based on the weighted sum method the advantages of using multiobjective optimization in thrust allocation can be described as follows a the aspects of dps which are taken into considerations in the previous work can be chosen as optimization objectives independently rather than aggregating them with different weights the physical meanings of the aspects considered are kept during optimization and the space shapes of the objective functions are clear this will assist the designer to study the relationships among the objectives b the relationships between objectives especially when conflicting can be investigated through a multiobjective optimization easily this is quite different from just aggregating them through weights c the visual relationship between objectives pareto set or feasible solutions can be found by scatter graphs when 2 or 3 objectives are considered ordinary 2d or 3d figures can display the relationship usually conflicting easily when the dimension of the objective functions is more than 3 i e high dimensional data set dimensionality reduction skill lee and verleysen 2007 can be used to mine the relationship among variables and objectives d no tedious work for weight determination is needed moreover the potential limitation that adding several constraint like aspects e g singularity avoiding into the objective function can be avoided easily in this work the modern meta heuristic algorithm is introduced to study the multiobjective optimization of thrust allocation the whole history of thrust allocation can be divided into many equal periods due to the slow motion of the vessels in each time step a two phase approach will be utilized the solution finding procedure can be depicted in fig 2 the solution to domp is a set pareto solutions and additional decision making procedure e g topsis in this work is required to determine the status at each time step 2 2 1 multiobjective feasibility enhanced particle swarm optimization swarm intelligence si algorithms are important in the optimization field they are usually inspired by behaviours among agents the agents can be ants bees fish and birds flocking mavrovouniotis et al 2017 particle swarm optimization pso was first introduced by kennedy and eberhart 1995 this method and its multiobjective version mopso hasanoglu and dolen 2018 khalili damghani et al 2013 have been used in many engineering fields a newly developed si algorithm multi objective feasibility enhanced particle swarm optimization mofepso hasanoglu and dolen 2018 is utilized in the present work in this method the feasible particle flight will be guided by two factors 1 repositories of non dominated and 2 feasible positions furthermore no feasible solutions are required in population initialization and no infeasible particles assessing are needed when previously satisfied constraints become violated the particle will not fly there the particles only fly along with sensitive directions therefore the overall feasible solution of the swarm will increase gradually through this mechanism it is worthy to be noted that mofepso is an extension of its previous single objective optimization version fepso hasanoglu and dolen 2016 the main flowchart of mofepso is listed in fig 3 hasanoglu and dolen 2018 it can be divided into four parts i initialization block ii feasible particle fp in fig 3 behaviour block iii infeasible particle ip in fig 3 behaviour block and iv post flight operations block respectively before the main flowchart of mofepso begins the initialization operation will be executed this procedure is labelled as initialization routine in fig 3 there are six steps in this routine hasanoglu and dolen 2018 1 random initialization of the particle positions x and particle velocities v 2 then the constraint matrix c is calculated for the population 3 the next step is calculating the set of global best positions b gbest and the set of local best positions d pbest this operation needs iteration for all particles 4 to identify which decision variables each constraint is sensitive to a sensitivity matrix s is used the elements of s s m n is 1 only when constraint m is sensitive to variable n otherwise it is zero 5 calculating the constraint priority vector p this vector length is the number of inequality constraints its element is the number of particles that violate each constraint one constraint is said to have the highest priority means that it is violated by the highest number of particles 6 initialization of active constraint selection count matrix t the elements of t are the numbers of times when each constraint is chosen as an activated constraint ac after initialization iterations of mofepso will begin in two layers the outer layer is about the main iteration loop while the inner layer is the population loop the population is divided into two groups feasible particles and infeasible particles different operations are employed for each particle in these 2 groups shown as 2 branches i e ii iii parts enclosed by rectangle dotted lines in fig 3 when the current particle is a feasible solution 3 steps are included in part ii step 1 choosing global and local guides when the particle is feasible global and personal guide positions will be selected randomly from b gbest and d pbest respectively step 2 velocity updating and candidate position generating the velocity of this feasible particle is updated according to the inertia factor social and cognitive acceleration coefficients then a new candidate position is generated just adding its updated velocity to the original position step 3 particle flight routine a candidate s position is obtained in step 2 if this new candidate wants to be a real particle position of interest additional 2 criteria no 1 no 2 should be satisfied in sequence one is the decision variable bounds check the other is the previously unviolated constraints check if criterion no 1 is not satisfied the position of this candidate will be adjusted according to the mechanism of enforcing decision variable limits in which limit violation rate is adopted based on violation level in this case the velocity of the particle is zero if criterion no 1 is satisfied calculating the constraints of this particle and then criterion no 2 is used to check them if this condition is satisfied update the particle position otherwise the candidate s position will be modified according to the virtual boundary search routine the main purpose of this routine is to update the position so that the particle does not violate any previously unviolated constraints on the other hand when the current particle is an infeasible solution 5 operations will be used in part iii step 1 choosing activated constraint ac the ac selection of infeasible particle is based on 2 factors 1 current constraint priorities and 2 the number of selection recurrences of the constraints that is the constraint with the highest priority and the least chosen number will be selected as ac the purpose of this selection operation is to ensure the diversity of the population without overemphasizing the high priority constraint step 2 selection of global guide for ip the global guide is randomly chosen from those particles which do not violate the ac step 3 velocity updating for ip the velocity updating law for ip is composed of two parts sensitivity term and regular updating operation which are based on inertia factor social acceleration coefficient and the global guide in step 2 if the ac is not sensitive to one decision variable this sensitivity term will force the velocity term to be zero therefore the particle motion along the dimension where the ac is not sensitive will be ignored step 4 particle flight routine this routine is the same as those in fp step 5 constraints priorities updating compared with fp an additional process for ip is to update the constraint priorities after the flight routine after passing through flowchart branch ii or iii the new particle is then generated if this new particle is not a feasible solution select the next particle in the population and begin the inner iteration loop for the population otherwise part iv is activated then in part iv 2 tasks will be completed one task is to calculate the objective function of this new feasible particle the other is to update global and local non dominated sets pbest and gbest respectively if this new objective function is a non dominated solution just add this objective function vector and corresponding decision variables into the data set moreover all the members of the set which is dominated by this new solution will be deleted from the dataset after the inner iteration loop of the population is finished the outer iteration condition check is executed now if the maximum iterations don t satisfy go back for the next outer iteration otherwise the entire iteration finished then more details about mofepso can be found in hasanoglu and dolen 2016 2018 2 2 2 decision making the solution to eq 1 is usually a set not a single point an additional decision making task has to be completed after the pareto set being obtained from mofepso that is the final compromise solution should be chosen through some kind of decision making approach many decision making theories have been developed and applied in engineering fields such as analytic hierarchy process ahp multi attribute utility theory maut topsis and measuring attractiveness by a categorical based evaluation technique macbeth ishizaka and nemery 2013 a decision making example of 2 attributes minimization is given in fig 4 it is worthy to be noted that the decision making is carried out in the objective space i e f 1 f 2 space 2 methods nearest to the utopian point u and topsis are shown in this figure the utopian solution is composed of the best objective function value for each objective s1 and s2 points in mop this utopian point does not exist f has the nearest euclidean distance to u point and can be selected as the final compromise solution before using this method 2 single optimization tasks for finding s1 and s2 points have to be finished thus forming u point then the calculation load is much larger in dmop a simple and effective method is to rank the alternatives in attribute space rather than carrying out the single optimization tasks additionally a widely used approach topsis hwang and yoon 1981 is based on the compound similarity among alternatives and applied in this research the final decision results can be g or h point in fig 4 depending on different weights of attributes the basic mechanism of topsis is that the best alternative is the one that is nearest to the ideal solution and the farthest to the anti ideal solution the whole topsis procedure can be divided into the following 5 steps hwang and yoon 1981 step 1 attributes gathering according to the considerations of the designer step 2 attribute normalization step 3 the weights of attributes are given by the designer calculating the weighted score of each alternative step 4 finding distances to ideal solution and anti ideal solution step 5 relative closeness calculations the alternative with the highest closeness will be the compromise solution in the decision making process then two characteristics of topsis should be considered one is attributes gathering in step 1 the other is the weight setting in step 3 in the decision making field the word attribute or criteria is commonly used ishizaka and nemery 2013 generally it may be the objective function s in optimization however it also can contain some aspects of decision variables or constraints according to the main concern of the designer in terms of weights setting many methods can be applied to find the relative importance of these attributes either by subjective or objective approaches ehrgott et al 2010 subjective weight is the designer s personal preference information about the objective function on the contrary the objective weight is just obtained from the mathematical calculation of the data for example entropy weight jaynes 1957 in this work subjective weight is utilized several pairs of weights are provided by the designer just before ta 2 3 data mining and self organizing map from the viewpoint of data analysis much information will be gathered in the history of the dynamic positioning procedure the data are high dimensional the dimensionalities of the data may contain optimization objectives i e attributes in decision making decision variables and constraints besides the time factor in dmop will be considered it is interesting to mine the hidden information among these dimensionalities self organizing map som is a sophisticated data mining approach and widely used in many fields kohonen 2013 it can display the high dimensional data in 2d graphs simultaneously it is an artificial network with a dimensionality reduction capability lee and verleysen 2007 this network is composed of only 2 layers the input layer and the output layer shown as in fig 5 the input layer connects the data set for analysis with n samples and q dimensionality the output layer is usually constructed by rectangular or hexagonal neurons the neighbourhood of the neurons is listed to 2 levels with dotted lines in fig 5 the mechanism of som is based on unsupervised learning when the data is input into the network the similarity examination will be found between the original data and the weight vector of the map bmu which means the best matching unit is the mapping point of this data in the output layer then the basic som operations can be described briefly as follows kohonen 2013 step 1 initialization small random values are set to weight vectors of neurons the learning rate and neighbourhood style are determined before training the network step 2 finding bmu according to the minimum euclidean distance criterion step 3 updating weights the weights of neighbours are updated according to distance and learning rate function step 4 repeat step 2 and step 3 the iteration process stops when the weights are stabilized more technical details of som may be found in the work of kohonen 2013 therefore the whole flowchart for thrust allocation in this work can be summarized in table 1 in table 1 tspan is the whole period interval considered in the ta process 3 numerical example and discussions in this part a thrust allocation example will be studied using the above analysis procedures a remote operated vehicle rov under dynamic positioning condition is selected the numerical results are obtained with windows 7 64 bit environment intel i5 3470 cpu 3 20 ghz 4 0 gb ram 3 1 model and problem in this section the rov model is described and the definition of dmop for this rov is given 3 1 1 rov model and external force in this example the rov model is a modification of the real vehicle minerva kajanus 2014 in real minerva the lateral thruster no 1 in the bow has two propellers one on each side the second thruster has 2 fixed pitch propellers in the centre with bollard pull 2 195 n at the stern are no 3 and no 4 thrusters oriented 10 towards the centreline the thruster no 1 no 3 and no 4 are set as azimuth thrusters for this study the configuration of the model is shown in fig 6 the parameters of the rov model are listed in table 2 in the control of rov minerva the commands of motion are in the form of thruster revolutions rpm when the thrusters propellers receive revolution command the corresponding motion of the rov can be achieved then therefore the desired generalized force should be transformed to the rotational speed of shafts i e rpm the relationship between force including positive and negative direction and shaft speed is achieved according to the following equations kajanus 2014 3 f ρ k t d 4 θ n n n 4 n sign f f c rpm where c ρ k t d 4 θ ρ density of water k t thrust coefficient of the propeller d diameter of the propeller n rpm of the shaft θ thrust loss the rotation direction of the shaft of the propeller is related to the force required on the motion of rov with azimuth thrusters the force with direction of a thruster can be obtained by the rotation speed n of the shaft in the positive or negative direction and its azimuth angle the task of the ta system is to find suitable combinations of the thrusts i e rotation speeds in rpm and angles rad for all thrusters usually when the shaft rotates in the positive or negative direction the corresponding forces are not identical due to different kt and θ in two directions labels are employed to identify the direction of the force here c means positive thrust force coefficient while c denotes negative thrust force coefficient respectively these c and c values are used as bounds in two directions respectively to confine the results of the thrusters in the ta routine other parameters of the original minerva for ta remain in this work only 4 degree of freedoms i e surge sway heave and yaw are considered here the configure matrix of these 4 thrusters is listed as eq 5 5 b cos α 1 0 cos α 3 cos α 4 sin α 1 0 sin α 3 sin α 4 0 1 0 0 l 1 x 0 l 3 x sin α 3 l 3 y cos α 3 l 4 x sin α 4 l 4 y cos α 4 one dynamic positioning condition is chosen for illustration the generalized external force is provided in fig 7 the main task of optimization based thrust allocation is to find the history of thrust forces and angles of these 4 thrusters according to optimization purposes 3 1 2 dynamic multiobjective optimization problem for rov in this section the dynamic multiobjective optimization problem dmop for this rov is constructed according to the above analysis the decision variables will be discussed first followed by objectives and constraints according to the main task of thrust allocation i e finding suitable combinations of forces u and angles α of these thrusters the forces and angles will be chosen as decision variables moreover when allocation error is considered either in the objective function or in constraints the slack variables s should be included in the decision variable space usually slack variables are small values the bounds of all these variables are shown in table 3 in terms of objective function construction 2 conflicting characteristic aspects of dps fuel consumption and tear and wear are chosen for the present research purpose 6 min f 1 a n d f 2 f 1 u α s t i 1 m w i u i f 2 u α s t α α 0 t ψ α α 0 where t time u α force and angle vector of the thrusters respectively m number of the thrusters 4 w i fuel consumption mapping related to thrust forces kajanus 2014 the relationship between thrust force and angular velocity is a quadratic function therefore the power consumption of a thruster can be obtained from a cubic function of angular velocity a type of w i u i k i u i 3 2 is adopted by johansen et al 2004 and is also used in this work moreover k i 1 i 1 2 3 and 4 is supposed ψ tear and wear feature mapping of the thrusters in this model the variation magnitude of each azimuth angle compared with its previous status either increasing or decreasing will be calculated therefore the absolute value function abs is used the ψ value should be obtained from practical data however in this example an illustrative virtual value 10 3 diag 111 is supposed due to practical data insufficiency this value is just to illustrate the mapping relationship physical law of angles and objective function f2 nothing to do with the other objective function it is worthy to be noted that the mapping function of this virtual value is quite different from those weights function among different aspects of dps in the previous work e g kajanus 2014 even if they are identical in magnitude α 0 angles of the thrusters in the last time step it should be pointed out that these 2 objectives f 1 and f 2 will be considered independently in dmop solving process in this example the thrust allocation error will be much smaller since the external generalized load is within the capability of the thrust allocation system in this case the allocation error is unnecessary to be considered in objective functions therefore the slack variables will only appear in the equality constraint about generalized force i e 7 s τ b α u where τ the commanded generalized force vector other constraints may include the individual capability of the thrusters and the rate of limits they are listed as u m i n u u m a x α m i n α α m a x δ α m i n α α 0 δ α m a x 8 δ u m i n u u 0 δ u m a x in this example δ u m i n 20 n δ u m a x 20 n δ α m i n 40 and δ α m a x 40 the singularity will often occur for more azimuthal thrusters in the case of some combinations of angles johansen et al 2004 this may lead to failure of thrust allocation therefore this case should be avoided in optimization from the viewpoint of mathematics the configuration matrix b is not a full rank one in this case to avoid singularity an additional constraint must be added then ensuring that b is a full rank matrix i e 9 r a n k b α m where rank the rank of the matrix m 4 here in summary the dynamic multiobjective optimization problem dmop defined in this work is listed as follows objectives eq 6 10 subjected to eq 7 eq 8 and eq 9 the bounds of decision variables are defined in table 3 the main concern in this study is the introduction of multiobjective analysis into the ta field from the viewpoint of the classification of dmop lin et al 2019 dynamic multiobjective thrust allocation dmta is an application of dmop in the marine field with time linkage features in this research dmop and dmta are the same things they can be treated indiscriminately in dmop dmta the decision at each sampling will affect the following prospective behaviours when the next time step begins the optimization method will search suitable combinations of decision variables either free in the decision variables bounds as done in mofepso or starting from an initial guess solution given by the designer as done in traditional approaches qp sqp etc whatever algorithm is selected the physical constraints of thrusts and angles e g input saturation and rate constraints shown as eq 8 should be considered during each iteration step dependencies between 2 adjacent time steps are expressed by the constraint conditions for instance in mofepso when a new thrust or angle is found by the optimization method during updates procedure refers fig 3 this new thrust or angle should not violate the constraints the current solution satisfied previously where the constraints are just defined in eq 8 exactly parameters of the previous status are known for the present time the rate constraints about thrust and angle are the main dependencies between two time steps besides this new thrust or angle should be in the bounds as defined in table 3 if this new value reaches its bounds input saturation will be considered the singularity avoiding condition eq 9 should be satisfied too 3 2 optimization results and discussions suppose the initial status of the rov is u 0 0 0 0 0 and α 0 0 5 0 5 0 5 the sampling interval of the rotation speed of thrust shafts and angles is 0 2s this period is enough for transforming this dmop also dmta into an ordinary static mop during each sampling the parameters of mofepso are given in table 4 in this work the 2 objectives eq 6 will be used as attributes in the topsis procedure that is the dimensionality of the dataset for topsis is 2 before using topsis the relative importance of these 2 attributes will be provided by the designer table 1 different weights will lead to different results several pairs of weights about these two objectives attributes are chosen to study the effects of weights upon the characteristics of thrust allocation in this example usually the main concern of the designer about dps is fuel consumption therefore the weights of f 1 and f 2 can be set as for example 0 9 0 1 during the topsis procedure the history curves of objective space decision variables are shown as fig 8 and fig 9 respectively the pareto fronts at t 20 40 60 80 100 and 120s are provided fig 8 a and the whole history of objective space is also shown fig 8 b c it can be observed the pareto fronts at these sampling points are convex for this pair of weight the relationship between these 2 objectives can be studied from a 2d scatter plot however in the previous weighted sum approach johansen et al 2004 wu et al 2016 their relationships can t be read clearly due to aggregating operations before the optimization process besides the conflicting relationship between these 2 objectives is clearly shown in fig 8 a that is if one wants to reduce fuel consumption the corresponding tear and wear will increase one can t decrease them concurrently due to the intrinsic characteristic of a dmop on the contrary in the weighted sum approach the contribution of each part is cumulative and the conflicting of fuel consumption and tear and wear is not considered the location of the pareto front in the objective space plot will vary in the whole dynamic positioning process fig 8 a besides its shape will change at different time points a complex shape example is listed in fig 10 in which convex and non convex part can be found at t 45s for w 0 2 0 8 at least 3 local areas with concave features i e labelled as d1 d2 and d3 in fig 10 are found the relationship between fuel consumption and tear and wear is complex now and can be learned easily from the scatter plot of the objective space of dmop optimal solutions adjacent to d1 d2 and d3 area can t be found through the traditional weighted sum approach even if one changes weights parametrically this relationship between objectives has been omitted in the weighted sum approach through the weights just before the optimization before carrying out topsis the weights between fuel consumption and tear and wear are defined by the designer that is the preference of the designer depending on one s personal experience the effects of different weights on objectives and decision variables are examined here the effects of weights setting upon 2 objectives are illustrated in fig 11 it can be observed that when the importance of fuel consumption and tear and wear is equal i e w 0 5 0 5 the fuel consumption of the system fig 11 a is the lowest among these weights settings the values of tear and wear are quite relatively smaller compared with fuel consumption characteristics to investigate the difference resulted from these weights clearly a logarithmic coordinate is used for f 2 fig 11 b the effects of different weights upon tear and wear are not obvious it may recall that the physical law of angles and tear and wear ψ is 10 3 diag 111 if the weighted sum method is used to aggregate the two objectives how to ensure the effectiveness of tear and wear in the aggregated objective function will remain to be a problem as the phenomena a larger number annihilates a small number will occur often this result may suggest that to maintain the calculation precision of the weighted sum method for thrust allocation choosing suitable weights among individual aspects of dps is very important for example the allocation error item s t q s has been extensively used as a part of the objective function in the previous work johansen et al 2004 wu et al 2016 how to determine the q value is quite a challenge for the designer a suitable q should ensure that the differences between individual parts of the aggregated functions are not very large in the whole dynamic positioning process the advantage of the dmop method is demonstrated here that this challenge can be solved easily just through independent operations of objectives no evaluation works about the importance of each aspect during optimization model construction is required introducing weights between the objectives attributes in the decision making process will also have important effects on decision variables the history curves of thrusts from 3 pairs of weights are depicted in fig 12 it is observed that roughnesses exist in the history of thrusts this phenomenon is caused by two factors 1 characteristics of mofepso and 2 the nature of ta in each new time step mofepso will begin a completely new population initialization in design space fig 3 part i in other words the new initial status has nothing to do with the previous step status the rov status of the previous step will only be considered as constraints eq 8 rather than a reference for initialization in searching since ta is a time continual procedure different previous step status will give different free space for the next time step the searching and updating procedure will be carried out in the whole decision variable space therefore after iteration quite different solutions may be found roughness or jumping points on the curve will occur then the magnitude of the roughness is confined to those constraints besides mofepso when other meta heuristic algorithms are used to solve the ta problem this kind of roughness of the curves may also occur for example a similar phenomenon existed in the history of thrusts in our previous work li and yang 2019 where a single objective optimization of ta was obtained from 2 newly meta heuristic population based approaches mine blast algorithm mba and its improvement imba in the application of mba and imba for ta a completely new population is generated when a new time step starts too on the contrary the traditional methods e g qp sqp etc jahansen and fossen 2013 are gradient based algorithms when they are utilized in ta and the new time step begins an initial guess solution must be provided by the designer how to give this guess status of the ta system more efficiently is quite a challenging work if this guess status is defined freely in the whole decision variable space the traditional method can t give a guarantee to find the final optimal solutions solutions of traditional methods depend heavily on initial guess solutions i e local optimization points will be found by traditional methods the status in the previous time step is a good choice for the next time step this previous status is an available status which the system just experienced through this mechanism only the adjacent solutions around the previous time step will be found therefore smoothness features can be obtained by traditional methods the effects of varying weights upon thrusts are not large as shown in fig 12 especially for u 2 namely in heave direction this interesting observation can be explained by the constraint condition in this direction according to the definition of slack variables eq 7 and the configure matrix in eq 5 the equation in heave direction can be rewritten as 11 b 3 2 u 2 τ 3 s 3 u 2 is only dependent on τ 3 and s 3 in this example τ 3 is given as external generalized force and has nothing to do with weights between objective functions s 3 will vary when weights change too as shown in fig 13 s 3 is a small decision variable between 1 n and 1 n table 3 therefore according to eq 11 it is observed that 3 curves about u 2 in fig 12 b for different weights are nearly identical in conventional approaches qp sqp etc slack variables are not decision variables they are used in equations about external forces and generated forces by the thrusters they are usually considered as a part of the objective function too johansen et al 2004 they will become smaller along with the ta procedure in this work the bounds of slack variables are clearly defined in table 3 it is noticed that all these 3 slack variables vary in the bounds freely during the entire optimization procedure figs 9 b fig 13 the history curves of 3 azimuth angles are listed in fig 14 the angle variation of thruster no 1 bow resulted from weight difference is little in the whole history after the 80s the angle difference of the port thruster no 3 is becoming larger for the starboard thruster no 4 the noticeable difference will exist from the beginning of the dynamic positioning procedure the results of objective space fig 8 demonstrate the two characteristics of thrust allocation fuel consumption and tear and wear are conflicting in the whole dynamic positioning procedure therefore if one wants to find a solution to the thrust allocation a dmop rather than a dsop dynamic single optimization problem should be constructed the weight concept has been used in previous work johansen and fossen 2013 and this study however the difference is obvious in the previous work weight is used to construct the objective function i e dsop just aggregating several aspects into one final aggregated form through weights this operation is done before optimization problem solving in this study weight is also designed for evaluating the relative importance between objectives attributes however this operation is carried out in topsis where the pareto set has already been found through mofepso in solving this time linkage thrust allocation problem a compromise solution at each time sample must be determined for the next step in fact from the viewpoint of mop the weighted sum method is a priori skill before optimization and many modern multiobjective optimization algorithms e g mofepso in this study are posteriori approaches in which the decision maker s preferences should be given after the optimization procedure coello et al 2007 based on the above analysis a further examination of the objective function construction in the previous work will be provided here and a classification suggestion about this issue is proposed as shown in fig 15 it should be emphasized that two subcategories of the single objective optimization problem sop are contained in this classification i e sop1 and sop2 the selection of sop1 and sop2 branch is based on the judgement about external forces and allocation capability when generalized forces are far beyond the thrust capability only an allocation error is considered sop1 branch the main concern of the designer is just the slack variables now it is obvious the weight q is no longer necessary then i e s norm function is enough rather than qs this is due that the primary objective which is to satisfy the command generalized force can t be satisfied in this case moreover it is worthy to be noted that the slack variables only emerge in the objective function when s are much larger the equality constraint of generalized forces and slack variables i e eq 7 will not be considered in the optimization model now due that generalized forces are too larger than the allocation capability this equality constraint can t be satisfied in any case when the bounds of the slack variables are defined in a narrow range that is to say only a large and virtual force can meet the requirements of this equality equation from the view of practical design if the slack variable in one direction is large enough e g far away from the bounds in table 3 it may suggest that an additional thruster in this direction is needed the commanded force should be provided by this new thruster rather than the virtual larger slack variable on the contrary if external forces are within the capability of the thrust allocation system the sop2 branch is used in other words if this branch is examined the allocation error will not be considered as an objective or an individual part of the objective due to its minor magnitude according to its original definition the slack variables will only appear in the external force constraints eq 7 in this case this equality constraint can be satisfied easily in the bounds of the slack variables in the previous work the objective functions of these two branches have been mixed that is aggregating allocation error sop1 just through q weight with other criteria sop2 to form an aggregated objective function in this operation q is used for matching allocation error with other criteria from the viewpoint of calculation precision in addition to the difficult work of defining q weight the aggregated objective function will also lead to fuzzy physical meaning besides if only an sop is considered in practical application when the generalized force is input into the thrust allocation system this ta should give a judgement first a suitable optimization model i e either sop1 or sop2 branch should be chosen according to the comparison results between generalized force and allocation capability of course this judgement can also be undertaken by the upper level control system commanded generalized forces resulted from the upper level control system can be filtered when they are beyond the capability of the allocation system lessening the analysis load of the ta then in terms of the application of a multiobjective optimization method two parts of fuel consumption resulted from thruster force and moments were tested as 2 conflicting objectives in our previous study li and yang 2019 using the nsga ii deb 2001 approach to find the pareto set however only a one time sample not the whole dynamic positioning procedure was investigated no further decision making procedure was considered there 3 3 data mining results in each time sample many pareto solutions will be found by mofepso and only a compromise solution should be chosen as the initial condition for the next time sample the high dimensional data set can be accumulated through the whole thrust allocation process then to investigate the mutual relationships among objectives and decision variables in the pareto set the som approach with dimensionality features is used here two major purposes of som are 1 investigating the relationships among variables through the output layer and 2 examining the trajectories of variables in the positioning process it is worthy to be noted that som is also a kind of multivariate analysis approach lee and verleysen 2007 the word multivariate may be all aspects considered for example objective functions and decision variables can be regarded as research subjects here the following som analysis results are obtained with the help of a toolbox in the matlab environment som toolbox vesanto 2002 2 examples of som study are provided here the dimensionality of the data set for mining is 10 namely t time thrusts 4 angles 3 and objectives 2 the weights between objectives in these 2 examples are 0 2 0 8 and 0 8 0 2 respectively in example 1 the pareto solutions in each time point 5 points in 1 s are all collected the data set size is 127 425 10 then after network training a 69 height 26 width hexagonal plane of the output layer is generated listed in fig 16 the relationships among all these aspects can be learned from fig 16 1 from the time graph fig 16 1 it is observed that t 80s is a border point in history so do other variables this is the same with ordinary history curves in the above analysis 2 when rov begins a dynamic positioning process 0 t 80s the conflicting characteristics between fuel consumption fig 16 9 and tear and wear fig 16 10 are so obvious the upper part of their graphs when t is in 80 150 s the motion of rov becomes stably gradually the change of these objectives is relatively little just like the trends in fig 8 c 3 the lateral thruster no 1 fig 16 2 has a similar variation trend as the port thruster no 3 fig 16 4 a roughly similar trend can be found between u 2 fig 16 3 and α 3 fig 16 7 in the ordinary analysis one may not take notice of the relationships among different kinds of decision variables the advantage of som is that it can provide an overall visual graph among all variables learning cross kind relationships among variables is possible 4 it can be read that f 1 has a similar variation trend with u 1 and u 3 this may suggest that the correlations between fuel consumption f 1 and u 1 u 3 is stronger than f 1 and other 2 thrust forces u 2 and u 4 on the other hand the connection between the tear and wear feature f 2 of dps and 3 angles is complex when t 80s the final compromise solutions in each time step total 750 samples have also been shown in fig 16 the white lines in the graphs tell the trajectory of each variable in which the start point locates in the middle of the graph ending at the upper left corner the variation trends of high dimensional compromise solutions are displayed through this dimensionality reduction approach it may be noted that the history of objective space in fig 8 c is only 3 dimensional in example 1 all the pareto solutions in the whole dynamic positioning process are used the designer may have more interest in the final compromise solution at each time step som approach can also be applied then in example 2 after topsis operation only 750 compromise points in the whole dataset are left for w 0 8 0 2 therefore the 18 8 panel of som will be formed then listed in fig 17 several characteristics can be learned from fig 17 1 a similar trend still exists between u 1 fig 17 1 and u 3 fig 17 3 when the weight of fuel consumption fig 17 8 increases from 0 2 to 0 8 so does the connection among these 2 variables and fuel consumption f 1 2 the angles of α 1 fig 17 5 and α 3 fig 17 6 have a similar style they are different from those of α 4 fig 17 7 3 in this example a similar cross kind relationship u 1 fig 17 1 and u 3 fig 17 3 versus α 4 fig 17 7 can be identified 4 the variation of tear and wear is smooth in history however the fuel consumption f 1 is more dependent on decision variables 3 4 comparisons with existing results to study the features of the proposed approaches in this work comparisons with existing results are carried out here the ta results are heavily dependent on the physical model i e specifications of the ship and corresponding thrust allocation system e g number and layout of thrusters etc in the above study a virtual rov minerva with 3 azimuth thrusters is utilized for dmop dmta to the best knowledge of the author no existing results with features of multiobjective optimization analysis and subsequent whole history of ta results at the same time are available in the literature for this virtual rov minerva in our previous study li and yang 2019 one of the main research aims was the introduction of meta heuristic algorithms mba and imba into the application of the ship ta field the virtual rov minerva was adopted in that work the history of thrusts and angles was obtained through these 2 algorithms and compared with traditional methods sqp with multistart mechanism further multiobjective optimization of this virtual rov was tested only at a one time step therefore no decision making procedure was required for the next time step and the subsequent whole history of ta results from the multiobjective optimization viewpoint was not studied there this work compares with li and yang 2019 separately in two tasks multiobjective optimization results at a one time point and the whole history of ta results in single objective optimization in task 1 multiobjective optimization results are compared with nsga ii example 3 at t 60s whole ta history i e t 0 150 s is compared with the mba in a single optimization for task 2 example 1 mba is selected for comparison since the slack variables are considered only in that case the generalized external forces and constraints are taken from li and yang 2019 the decision variables and their bounds are the same as that work the objective functions in task 1 and task 2 are consistent with example 3 and example 1 in li and yang 2019 respectively in task 1 the external force is τ 42 82 n 256 00 n 19 04 n 1 50 nm u 0 167 74 23 74 56 23 71 72 n α 0 1 6226 0 9165 2 501 rad respectively the parameters of mofepso are the same as those in table 4 the pareto solutions at this time and comparison with nsga ii are given in fig 18 two parts of fuel consumption are selected as objective functions in example 3 li and yang 2019 two compromise solutions achieved from topsis of this work using different weights are shown as black blocks fig 18 a it is observed that the pareto set of mofepso has better objective functions fig 18 b this means mofepso can find a solution with lower 2 objective functions simultaneously for this multiobjective optimization example at this time in task 2 example 1 in the work of li and yang 2019 is studied and compared with mba the whole fuel consumption is chosen as the objective function j which is composed of 4 parts through the weighted sum method johansen et al 2004 appropriate modifications are adopted in mofepso to solve this single objective problem the updating of the non dominated set is no longer needed fig 3 the second section of part iv in fact in task 2 the function of mofepso is equivalent to its single objective version i e fepso hasanoglu and dolen 2016 the history of the objective function j and the relative difference percent with the mba are listed in fig 19 it is noticed that mofepso with modifications can find lower objective function value in the whole history which means the solution has even lower fuel consumption this is due to the higher searching capability of mofepso in decision variable space the history curves of the thrusts and angles of the thrusters are provided in fig 20 and fig 21 respectively the difference in the objective function is very small fig 19 and the ta results from mofepso here are also very close to those of mba li and yang 2019 it can be observed the history of mofepso is much smoother than those of mba for u1 u3 and u4 similar smoothness in 3 angles can be found in fig 21 too from the above comparisons it is noticed that the searching capability of mofepso in the whole ta procedure is better than that of the mba in this example however the running time of mofepso for 1 ta time step is about 26 8s in this single objective optimization problem while only 10 2s is needed in the mba 3 5 discussions on the complexity of the ta method the ta method in this study includes 3 parts mofepso multiobjective optimization topsis decision making and som data analysis the implementation complexity of the proposed method is investigated here 1 due to the complexity of the ta model especially handling 8 inequality constraints eq 8 and 2 equality constraints i e eq 7 and eq 9 mofepso is adopted here to find the pareto set at each time step mofepso is a kind of multiobjective particle swarm optimization mopso with several specialized operations the complexity of mofepso is raised from its unique constraint handling method the extra calculation load is related to the complexity of constraints directly compared with generic mopso 2 aspects are emphasized in mofepso as follows hasanoglu and dolen 2018 first in the initialization phase the constraint sensitivity calculation involves number of population x number of decision variables member movements and constraint evaluations to find sensitive directions this operation is based on one principal direction at a time thus increasing the computational cost significantly second in the main iteration loop the algorithm complexity comes from activated constraint selection virtual boundary search vbs and constraints priority updating operations selections of ac and updating of constraint priority are only executed on infeasible particles and time cost can be neglected due to just updating several elements of initial arrays therefore the major computation load is contributed by the vbs process constraints will be calculated continuously until a legitimate virtual boundary is found it should be noted that this complex vbs procedure will be performed at each iteration step the total computation time has a direct relation to the number of constraint function evaluations cfes demonstrated numerically for a benchmark problem c14 by hasanoglu dolen 2018 in this work the population size is 200 and the maximum iteration is 500 the numbers of cfe and objective function evaluations ofe in each ta time step are about 118 thousand and 83 thousand respectively 2 decision making is a necessary procedure after the pareto set is found by mofepso topsis is a sophisticated decision making approach the dataset needed in the topsis procedure is generated directly from objective space eq 6 and weights are given by the designer in advance table 1 operations in topsis are just basic matrix calculations the structure of topsis is simple and the time cost can be ignored 3 som is used as an analysis tool to mine useful information about ta results obtained from mofepso and topsis in this work similar to topsis the som approach is also widely used in many fields when the 127 425 10 data set fig 16 is input to train the network about only 10s is needed it is worthy to be noted the trajectory of the ta is shown in fig 16 this may suggest that the som component graphs can be used as a background for monitoring the ta procedure this monitoring function is an important feature of som and is adopted in many industrial fields vesanto 2002 to use this monitoring function so much data of the ta system resulted from various working conditions e g external generalized forces the capability of ta initial thrust and angles etc together with different control strategies should be collected in advance the visualization of ta trajectory in those som graphs in real time is easy however to obtain a robust som is quite a tedious work in this work the simulation is finished on the matlab platform specifications of a personal computer are intel i5 3470 cpu 3 20 ghz 4 0 gb ram with the 64 bit operating system serial computation is used in mofepso this study is an attempt for the potential industrial application of meta heuristic methods in ship ta in this example the time consumption in mofepso and topsis task for 1 ta time step requires approximately 45s when the population size is 200 and the maximum number of iterations is 500 table 4 the proposed approach can t be implemented in the direct control layer of dps in real time without extra help in the last 2 decades many works have been conducted to speed up the execution of heavy computational workload resulted from population based meta heuristic algorithms e g pso through implementing them just on hardware the optimization algorithm can be embedded in the hardware thus the solving speed can increase significantly for instance an efficient hardware core for pso was developed by damaj et al 2020 to run in field programmable gate arrays fpgas platform the corresponding statistical framework was also built taking the features of the optimization algorithm and its implementations into consideration the test of benchmark problems showed the effectiveness of hardware implementation and significant time reduction 23 300 and 1777 improvement ratio of execution times were achieved for elliptic evaluation function and shifted schwefel s function respectively moreover the hardware software co design approach is another alternative method for speeding up the execution of optimization loads for example a design plan was proposed by li et al 2011 where the particle updating accelerator module was executed by hardware updating velocity and position of the particles fitness evaluations are carried out in fpga or soft cored processor evaluating the objective functions 13 benchmark functions from the ieee congress on evolutionary computation cec 2005 and cec 2010 were tested and better performances were observed via the hardware software co design approach furthermore an experiment in shifting sphere function with 32 variables demonstrated that overall execution time reduced from 163 1549s to 13 4673 ms via pure hardware realization a speedup up to 12 115 was obtained this may suggest that if the calculation loads of the present work could be executed on the fpga platform wholly or partly the time consumption might be shortened dramatically it will have the potential to guarantee the real time feature in ta this research direction will be considered in our future work 3 6 summary in the analysis the dynamic positioning process of an rov example is examined the results of mofepso topsis and som analysis are dependent on the initial condition moreover the relative importance of 2 objectives fuel consumption and tear and wear is defined before the topsis operation according to the preferences of the designer i e subjective weight different characteristics of thrust allocation for this rov will emerge for other external generalized forces and different weights setting methods the main concern of the present work is to provide a two phase analysis flowchart for thrust allocation in ship application from the viewpoint of multiobjective optimization decision making and further data analysis the above results demonstrate that those aspects which are taken into consideration in the previous thrust allocation works are conflicting and therefore a dmop also dmta can be constructed and solved by the modern meta heuristic optimization algorithm compared with the conventional and the most popular weighted sum approach in the previous work the proposed analysis procedure in this work extends the application of optimization algorithms in ta and can help the designer to understand the characteristics of thrust allocation from a new viewpoint besides the analysis framework in this study is general other meta heuristic optimization algorithms e g multiobjective evolutionary algorithm moea coello et al 2007 and multiobjective differential evolution mode das et al 2016 other weight setting methods e g entropy method jaynes 1957 ahp ishizaka and nemery 2013 etc and data mining approaches e g correlation clustering härdle simar 2012 etc can all be tested within this framework much hidden information behind the optimization model can be grasped by the designers it may be noted that selecting a suitable mop method for a certain application may need much work due to no free lunch nfl theorems coello et al 2007 that is an algorithm s robustness for all problems can t be assured certainly applying the present approaches in real time is another important research direction 4 conclusions in this study a two phase analysis framework is proposed for thrust allocation in ship application from the viewpoint of multiobjective optimization and decision making furthermore a widely used data mining skill som is employed to find the hidden relationships among objectives and decision variables in the whole dynamic positioning history from the above analysis several conclusions and recommendations for future work are given here 1 the aspects which were considered in the previous work e g fuel consumption and tear and wear characteristics are conflicting in fact the thrust allocation solutions can be obtained through modern multiobjective optimization approaches taking advantage of those meta heuristic algorithms therefore the application of optimization in thrust allocation is extended the drawbacks of the widely used weighted sum method in the previous work can be overcome then 2 a suggestion about objective function construction is provided in terms of discussing of slack variables when external generalized forces are far beyond the thrust capability only an allocation error is considered in the objective function on the contrary the allocation error will be considered just in the constraints about generalized forces 3 the analytical framework proposed here is generally for obtaining the pareto set choosing a final compromise solution and mining useful information among high dimensional data set any other approaches of interest can easily be investigated for applications in the ship field within this framework in future work other criteria can also be chosen as the objective function of dmop dmta depending on the specific application many other modern multiobjective optimization methods could be investigated then the objective weight calculation method e g entropy or combinations of objective weights and subjective weights will be tested in the decision making procedure other data mining skills can also be examined in ship applications implementing modern meta heuristic optimization algorithms on hardware in real time is another important direction for ta study moreover monitoring the dynamic thrust allocation process with the help of som visualization will be a meaningful exploration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the author would like to thank the anonymous reviewers for valuable comments and suggestions which helped to enrich the quality of the work presented in the manuscript 
21329,thrust allocation is a key procedure in the dynamic position system dps of marine vessels the present work aims to study the characteristics of dynamic optimization in thrust allocation a two phase analysis process is proposed in phase i the model for thrust allocation is generated from the viewpoint of multiobjective optimization fuel consumption and tear and wear on the thrusters are chosen as objectives multiobjective feasibility enhanced particle swarm optimization algorithm mofepso is applied to find the pareto set of this problem an additional decision making procedure the technique of order preference by similarity to ideal solution topsis is utilized to choose the final compromise solution in phase ii the self organizing map som technique is undertaken to mine the pareto data set a remote operated vehicle rov example is provided for illustrating the above analysis process the effects of relative importance between objectives upon characteristics of thrust allocation are studied the trajectories of decision variables and objectives are examined through the som method results from numerical examples demonstrate that the multiobjective optimization method together with decision making skills can extend the application of optimization in the thrust allocation field the findings in this work add to the understanding of relationships among several aspects of dps keywords thrust allocation dynamic multiobjective optimization mofepso decision making som rov 1 introduction dynamic positioning systems dps are installed in so many marine vessels which are employed in drilling exploration and pipe laying operations the main goal of a dps is to maintain the vessel position and heading when subjected to the environmental disturbance such as wind wave and current usually for safety and better performance vessels installed with dps will have an over actuated control system which means the number of actuators is greater than the required number of degrees of freedom the main function of control allocation also thrust allocation ta is to distribute the generalized force and moment obtained from a high level motion control system into the individual thruster the distribution solution is usually found by the optimization method for over actuated vessels optimization based thrust allocation methods have been extensively used in the previous work a comprehensive survey of optimization based thrust allocation methods and their applications in engineering fields including aerospace ship automotive and the ground vehicle was provided by johansen and fossen 2013 in marine applications optimization algorithms can be classified as conventional gradient based types such as linear programming lp zalewski 2016 quadratic programming qp zalewski 2016 koschorrek et al 2018 sequential quadratic programming sqp arditti et al 2018 witkowska and śmierzchalski 2018 and modern meta heuristic types usually population based for example genetic algorithm ga ren et al 2015 mauro and nabergoj 2016 particle swarm optimization pso ren et al 2015 artificial bee colony abc wu et al 2016 and mine blast algorithm mba li and yang 2019 the modern meta heuristic algorithms can overcome the drawbacks of traditional ones such as depending on the optimization problem type features of the solution space convex or non convex and the initial solutions therefore continuous research and applications of meta heuristic algorithms can be found in this field the optimization model includes three main elements namely objective function decision variables and constraints the objective function reflects the main goal of the model either being minimized or maximized the number of objective functions can be single or multiple in the previous work several characteristics of dps have been chosen as the objective function such as minimization of fuel consumption kim and kim 2018 veksler et al 2016 minimization of tear and wear on thruster and generators johansen and fossen 2013 thrust allocation error minimization arditti et al 2018 koschorrek et al 2018 and minimization of the variation in the power consumption veksler et al 2016 these aspects can be considered separately or together if those characteristics are studied separately a single objective optimization problem will be generated then it is worthy to be noted that so many studies have considered 2 or more characteristics together just through weights to form only one objective that is only one aggregated objective which contains several parts is formed for example fuel consumption resulted from thrusts and angles allocation error characteristics and the singularity avoiding was selected by johansen et al 2004 to form a 4 part objective function through weights and adopt by other works wu et al 2016 xu et al 2018 despite the recent progress of optimization algorithms and applications in thrust allocation several problems in this kind of optimization model construction method i e weighted sum approach are remaining and further research is needed it should be noted first that the aggregated objective function style johansen et al 2004 is not an ordinary weighted sum type like w i f i x however it can be converted to this type just by normalization easily concerning objective construction the previous use of the weighted sum approach has 6 limits as follows 1 during preparing the optimization model different goals or aspects of dps will be chosen as objectives all these aspects have their physical meanings and dimensions after aggregating these aspects through weights the designer can t identify the clear physical meaning of that aggregated objective function then even if the optimal solution has been found by traditional or modern optimization algorithms the connection between this solution and the individual part of the aggregated objective is fuzzy since this is the solution to the aggregated objective function not its part real physical aspect 2 in practical application when command force is well beyond the capability of the effectors the slack variables i e additional decision variables will be introduced johansen and fossen 2013 for minimal thrust allocation error that is thrusts azimuth angles and slack variables will all be considered as decision variables due to aggregating operation the optimization model complexity and search space will increase and the calculation load also rises 3 according to the mechanism of weighting the effects of every individual part are cumulative even if two aspects may be conflicting after aggregating operations through weights the mutual relationships between those aspects are lost then further relationship investigation between individual parts can t be obtained from this aggregating operation 4 it is very hard to determine the weights of each part for example when fuel consumption and allocation error are chosen as parts of objective how can one find the relative importance between these two kinds of aspects exactly johansen et al 2004 different weights will lead to different optimization solutions this may raise difficulties in identifying the real practical solution to the dps besides the phenomena that a larger number annihilates a small number will occur among the individual parts of the aggregated objective function if their weights are not suitable 5 the objective space of individual parts of the objective function is not studied intensively from the viewpoint of multiobjective optimization the weighted sum approach is a popular scalarizing method due to its simplicity when individual parts are conflicting the weighted sum approach can t find certain solutions when the objective space is non convex even if one parametrically varies the weights coello et al 2007 deb 2001 6 during aggregating several aspects into one objective some aspects e g singularity avoiding fossen 2011 johansen et al 2004 wu et al 2016 which do not reflect the goal of the designer have been chosen as an individual objective part in the previous work from the standpoint of optimization singularity avoiding should be treated as constraints not an objective part in terms of decision variables till now very little attention has been paid to defining the bounds of the slack variables before the optimization procedure li and yang 2019 in the previous work the slack variables are introduced in the optimization model at 2 places i e as a part of the objective function thrust allocation error through weight q matrix and thrust constraint through equality condition these slack variables are chosen as decision variables so their bounds should be clearly defined in the optimization model this work has aimed to study the characteristics of thrust allocation from the viewpoint of dynamic multiobjective optimization multi attribute decision making madm hwang and yoon 1981 and data mining skills first to obtain a further comprehension of thrust allocation and break through the limits of the weighted sum approach a multiobjective optimization model for thrust allocation is constructed many modern optimization methods which are known as meta heuristic have been developed in the last 4 decades yang 2018 in this work a newly developed meta heuristic approach multiobjective feasibility enhanced particle swarm optimization mofepso hasanoglu and dolen 2018 algorithm will be used to find the solutions i e the pareto set for this optimization model the characteristics of the solutions from the multiobjective optimization analysis procedure will be investigated and its comparison with the single objective optimization method i e weighted sum will also be studied second decision making is a necessary process in the application of multiobjective optimization for ta it is worthy to be noted that the solution to the multiobjective optimization is usually a set not a single solution as in the single objective optimization problem although several solutions i e the pareto solutions of thrust allocation from multiobjective optimization analysis have been found only one solution will be determined as the control input status at this time and initial condition for the next time step therefore an additional analysis task will follow the optimization process that is a decision making procedure in which the designer has to choose a final compromise solution in the pareto set at this time step in this work a widely used multi attribute decision making madm hwang and yoon 1981 approach the technique of order preference by similarity to ideal solution topsis hwang and yoon 1981 ishizaka and nemery 2013 is employed to choose the final compromise solution from the pareto set it should be noted the data set for the topsis process is from the objective space of the pareto set and the relative importance of each objective i e attribute used in the madm field will be given by the designer the effects of various weights among the attributes upon the allocation solutions will be discussed in detail this two phase operation i e pareto set seeking and decision making will be executed from the beginning of vessel motion the whole history of thrust allocation can be found just by executing this 2 phase analysis along the time axis third when examining the data of thrust allocation solution i e thrusts angles and slack variables and dps aspects such as fuel consumption tear and wear thrust allocation error etc they are high dimensional to study the characteristics of this high dimensional data a dimensionality reduction skill lee and verleysen 2007 self organizing map som approach kohonen 2013 is utilized in this work from 2d graphs of this neural network the designer can mine hidden information among these dimensionalities further the history of each physical parameter can be displayed in the graphs the main contributions of the present work are as follows 1 a two phase analysis framework is proposed for the optimization based thrust allocation together with further data mining based on the som approach 2 the dynamic thrust allocation problem is solved by the modern multiobjective optimization method rather than a traditional weighted sum approach the physical meanings of the objective functions are clear and maintained during the optimization process moreover a suggestion is made to classify objective function construction 3 the solutions to the ta problem at each time step provide more choices for the designer a decision making procedure is integrated into the framework the preferences of the designer can be easily considered through various weights 4 the data mining operations upon the pareto solutions in history can provide more useful information and more understanding of the ta model the remaining of the present work is organized as follows in sec 2 the thrust allocation problem will be defined briefly first and proposed methods will be described including mofepso topsis and som a numerical model a remote operated vehicle rov will be given in sec 3 the obtained results are discussed there finally conclusions and further recommendations are listed in sec 4 2 theory in this section the definition of a dynamic multiobjective optimization problem dmop in thrust allocation is listed first the proposed methods in this work will be described the solutions to the dmop can be found through mofepso and the final compromise solution at each sampling is determined by the topsis procedure finally historical characteristics of thrust allocation will be studied by som skill 2 1 dynamic multiobjective optimization in practical engineering applications so many problems need to optimize several competing objectives simultaneously furthermore those applications are dynamic this means that they have time varying objectives and constraints the optimization tasks about this kind of dmop are twofold finding near optimal pareto front pf and determining the desired solution before the next change comprehensive surveys of dmop can be found in the work of azzouz et al 2017 and raquel and yao 2013 the thrust allocation in vessel application is a typical dynamic optimization problem due to 1 the motion of the ships is continuous in the time axis and 2 several objectives usually conflicting exist during optimization operation if two or more objectives are considered in thrust allocation a dmop will be generated then the characteristic of dmop in the marine field is its time linkage lin et al 2019 in which the decision at each sampling will affect the following behaviours when solving time linkage dmop a series of the static multiobjective optimization problem mop of different periods can be used if the time interval is small enough the characteristics of the dps in each sampling can be regarded as static due to the slow motion of the dynamic positioning process the dmop can be defined as follows min f x t f 1 x t f 2 x t f m x t 1 s t g x t 0 h x t 0 where x decision variables f objective functions to be minimized g and h are inequality and equality constraints respectively f g and h are functions of time t m number of objectives the definition of eq 1 is extended from static mop the basic definitions of static mop pareto set dominance etc may be found in the classical works such as coello et al 2007 and deb 2001 2 2 proposed methods the weighted sum approach is a simple and widely used method for solving mop in which a linear aggregating function is applied to calculate the fitness of the solution the weight usual normalization reflects the relative importance of each objective function the main shortfall of the weighted sum method is that it can t find the pareto solution when the pareto front is not convex even if one parametrically varies the weights an example of 2 objective optimization is shown in fig 1 suppose the weighted sum fitness is as follows 2 fit min w 1 f 1 x w 2 f 2 x where w 1 w 2 1 the optimization procedure is to find the intersection point of lines with slope k w1 w2 and feasible objective space a point is a solution to eq 2 due to its smaller fitness compared with b point it can be observed the near area of c point can t be obtained through this method coello et al 2007 deb 2001 if the designer is interested in this area this weighted sum method is unable to find the solution due to the concave characteristic of the pareto front in section 3 this characteristic of thrust allocation can be encountered in previous work johansen et al 2004 wu et al 2016 several aspects of thrust allocation have been selected as objective functions some of them can be conflicting and aggregated into one final function just like eq 2 the essential feature of that operation is based on the weighted sum method the advantages of using multiobjective optimization in thrust allocation can be described as follows a the aspects of dps which are taken into considerations in the previous work can be chosen as optimization objectives independently rather than aggregating them with different weights the physical meanings of the aspects considered are kept during optimization and the space shapes of the objective functions are clear this will assist the designer to study the relationships among the objectives b the relationships between objectives especially when conflicting can be investigated through a multiobjective optimization easily this is quite different from just aggregating them through weights c the visual relationship between objectives pareto set or feasible solutions can be found by scatter graphs when 2 or 3 objectives are considered ordinary 2d or 3d figures can display the relationship usually conflicting easily when the dimension of the objective functions is more than 3 i e high dimensional data set dimensionality reduction skill lee and verleysen 2007 can be used to mine the relationship among variables and objectives d no tedious work for weight determination is needed moreover the potential limitation that adding several constraint like aspects e g singularity avoiding into the objective function can be avoided easily in this work the modern meta heuristic algorithm is introduced to study the multiobjective optimization of thrust allocation the whole history of thrust allocation can be divided into many equal periods due to the slow motion of the vessels in each time step a two phase approach will be utilized the solution finding procedure can be depicted in fig 2 the solution to domp is a set pareto solutions and additional decision making procedure e g topsis in this work is required to determine the status at each time step 2 2 1 multiobjective feasibility enhanced particle swarm optimization swarm intelligence si algorithms are important in the optimization field they are usually inspired by behaviours among agents the agents can be ants bees fish and birds flocking mavrovouniotis et al 2017 particle swarm optimization pso was first introduced by kennedy and eberhart 1995 this method and its multiobjective version mopso hasanoglu and dolen 2018 khalili damghani et al 2013 have been used in many engineering fields a newly developed si algorithm multi objective feasibility enhanced particle swarm optimization mofepso hasanoglu and dolen 2018 is utilized in the present work in this method the feasible particle flight will be guided by two factors 1 repositories of non dominated and 2 feasible positions furthermore no feasible solutions are required in population initialization and no infeasible particles assessing are needed when previously satisfied constraints become violated the particle will not fly there the particles only fly along with sensitive directions therefore the overall feasible solution of the swarm will increase gradually through this mechanism it is worthy to be noted that mofepso is an extension of its previous single objective optimization version fepso hasanoglu and dolen 2016 the main flowchart of mofepso is listed in fig 3 hasanoglu and dolen 2018 it can be divided into four parts i initialization block ii feasible particle fp in fig 3 behaviour block iii infeasible particle ip in fig 3 behaviour block and iv post flight operations block respectively before the main flowchart of mofepso begins the initialization operation will be executed this procedure is labelled as initialization routine in fig 3 there are six steps in this routine hasanoglu and dolen 2018 1 random initialization of the particle positions x and particle velocities v 2 then the constraint matrix c is calculated for the population 3 the next step is calculating the set of global best positions b gbest and the set of local best positions d pbest this operation needs iteration for all particles 4 to identify which decision variables each constraint is sensitive to a sensitivity matrix s is used the elements of s s m n is 1 only when constraint m is sensitive to variable n otherwise it is zero 5 calculating the constraint priority vector p this vector length is the number of inequality constraints its element is the number of particles that violate each constraint one constraint is said to have the highest priority means that it is violated by the highest number of particles 6 initialization of active constraint selection count matrix t the elements of t are the numbers of times when each constraint is chosen as an activated constraint ac after initialization iterations of mofepso will begin in two layers the outer layer is about the main iteration loop while the inner layer is the population loop the population is divided into two groups feasible particles and infeasible particles different operations are employed for each particle in these 2 groups shown as 2 branches i e ii iii parts enclosed by rectangle dotted lines in fig 3 when the current particle is a feasible solution 3 steps are included in part ii step 1 choosing global and local guides when the particle is feasible global and personal guide positions will be selected randomly from b gbest and d pbest respectively step 2 velocity updating and candidate position generating the velocity of this feasible particle is updated according to the inertia factor social and cognitive acceleration coefficients then a new candidate position is generated just adding its updated velocity to the original position step 3 particle flight routine a candidate s position is obtained in step 2 if this new candidate wants to be a real particle position of interest additional 2 criteria no 1 no 2 should be satisfied in sequence one is the decision variable bounds check the other is the previously unviolated constraints check if criterion no 1 is not satisfied the position of this candidate will be adjusted according to the mechanism of enforcing decision variable limits in which limit violation rate is adopted based on violation level in this case the velocity of the particle is zero if criterion no 1 is satisfied calculating the constraints of this particle and then criterion no 2 is used to check them if this condition is satisfied update the particle position otherwise the candidate s position will be modified according to the virtual boundary search routine the main purpose of this routine is to update the position so that the particle does not violate any previously unviolated constraints on the other hand when the current particle is an infeasible solution 5 operations will be used in part iii step 1 choosing activated constraint ac the ac selection of infeasible particle is based on 2 factors 1 current constraint priorities and 2 the number of selection recurrences of the constraints that is the constraint with the highest priority and the least chosen number will be selected as ac the purpose of this selection operation is to ensure the diversity of the population without overemphasizing the high priority constraint step 2 selection of global guide for ip the global guide is randomly chosen from those particles which do not violate the ac step 3 velocity updating for ip the velocity updating law for ip is composed of two parts sensitivity term and regular updating operation which are based on inertia factor social acceleration coefficient and the global guide in step 2 if the ac is not sensitive to one decision variable this sensitivity term will force the velocity term to be zero therefore the particle motion along the dimension where the ac is not sensitive will be ignored step 4 particle flight routine this routine is the same as those in fp step 5 constraints priorities updating compared with fp an additional process for ip is to update the constraint priorities after the flight routine after passing through flowchart branch ii or iii the new particle is then generated if this new particle is not a feasible solution select the next particle in the population and begin the inner iteration loop for the population otherwise part iv is activated then in part iv 2 tasks will be completed one task is to calculate the objective function of this new feasible particle the other is to update global and local non dominated sets pbest and gbest respectively if this new objective function is a non dominated solution just add this objective function vector and corresponding decision variables into the data set moreover all the members of the set which is dominated by this new solution will be deleted from the dataset after the inner iteration loop of the population is finished the outer iteration condition check is executed now if the maximum iterations don t satisfy go back for the next outer iteration otherwise the entire iteration finished then more details about mofepso can be found in hasanoglu and dolen 2016 2018 2 2 2 decision making the solution to eq 1 is usually a set not a single point an additional decision making task has to be completed after the pareto set being obtained from mofepso that is the final compromise solution should be chosen through some kind of decision making approach many decision making theories have been developed and applied in engineering fields such as analytic hierarchy process ahp multi attribute utility theory maut topsis and measuring attractiveness by a categorical based evaluation technique macbeth ishizaka and nemery 2013 a decision making example of 2 attributes minimization is given in fig 4 it is worthy to be noted that the decision making is carried out in the objective space i e f 1 f 2 space 2 methods nearest to the utopian point u and topsis are shown in this figure the utopian solution is composed of the best objective function value for each objective s1 and s2 points in mop this utopian point does not exist f has the nearest euclidean distance to u point and can be selected as the final compromise solution before using this method 2 single optimization tasks for finding s1 and s2 points have to be finished thus forming u point then the calculation load is much larger in dmop a simple and effective method is to rank the alternatives in attribute space rather than carrying out the single optimization tasks additionally a widely used approach topsis hwang and yoon 1981 is based on the compound similarity among alternatives and applied in this research the final decision results can be g or h point in fig 4 depending on different weights of attributes the basic mechanism of topsis is that the best alternative is the one that is nearest to the ideal solution and the farthest to the anti ideal solution the whole topsis procedure can be divided into the following 5 steps hwang and yoon 1981 step 1 attributes gathering according to the considerations of the designer step 2 attribute normalization step 3 the weights of attributes are given by the designer calculating the weighted score of each alternative step 4 finding distances to ideal solution and anti ideal solution step 5 relative closeness calculations the alternative with the highest closeness will be the compromise solution in the decision making process then two characteristics of topsis should be considered one is attributes gathering in step 1 the other is the weight setting in step 3 in the decision making field the word attribute or criteria is commonly used ishizaka and nemery 2013 generally it may be the objective function s in optimization however it also can contain some aspects of decision variables or constraints according to the main concern of the designer in terms of weights setting many methods can be applied to find the relative importance of these attributes either by subjective or objective approaches ehrgott et al 2010 subjective weight is the designer s personal preference information about the objective function on the contrary the objective weight is just obtained from the mathematical calculation of the data for example entropy weight jaynes 1957 in this work subjective weight is utilized several pairs of weights are provided by the designer just before ta 2 3 data mining and self organizing map from the viewpoint of data analysis much information will be gathered in the history of the dynamic positioning procedure the data are high dimensional the dimensionalities of the data may contain optimization objectives i e attributes in decision making decision variables and constraints besides the time factor in dmop will be considered it is interesting to mine the hidden information among these dimensionalities self organizing map som is a sophisticated data mining approach and widely used in many fields kohonen 2013 it can display the high dimensional data in 2d graphs simultaneously it is an artificial network with a dimensionality reduction capability lee and verleysen 2007 this network is composed of only 2 layers the input layer and the output layer shown as in fig 5 the input layer connects the data set for analysis with n samples and q dimensionality the output layer is usually constructed by rectangular or hexagonal neurons the neighbourhood of the neurons is listed to 2 levels with dotted lines in fig 5 the mechanism of som is based on unsupervised learning when the data is input into the network the similarity examination will be found between the original data and the weight vector of the map bmu which means the best matching unit is the mapping point of this data in the output layer then the basic som operations can be described briefly as follows kohonen 2013 step 1 initialization small random values are set to weight vectors of neurons the learning rate and neighbourhood style are determined before training the network step 2 finding bmu according to the minimum euclidean distance criterion step 3 updating weights the weights of neighbours are updated according to distance and learning rate function step 4 repeat step 2 and step 3 the iteration process stops when the weights are stabilized more technical details of som may be found in the work of kohonen 2013 therefore the whole flowchart for thrust allocation in this work can be summarized in table 1 in table 1 tspan is the whole period interval considered in the ta process 3 numerical example and discussions in this part a thrust allocation example will be studied using the above analysis procedures a remote operated vehicle rov under dynamic positioning condition is selected the numerical results are obtained with windows 7 64 bit environment intel i5 3470 cpu 3 20 ghz 4 0 gb ram 3 1 model and problem in this section the rov model is described and the definition of dmop for this rov is given 3 1 1 rov model and external force in this example the rov model is a modification of the real vehicle minerva kajanus 2014 in real minerva the lateral thruster no 1 in the bow has two propellers one on each side the second thruster has 2 fixed pitch propellers in the centre with bollard pull 2 195 n at the stern are no 3 and no 4 thrusters oriented 10 towards the centreline the thruster no 1 no 3 and no 4 are set as azimuth thrusters for this study the configuration of the model is shown in fig 6 the parameters of the rov model are listed in table 2 in the control of rov minerva the commands of motion are in the form of thruster revolutions rpm when the thrusters propellers receive revolution command the corresponding motion of the rov can be achieved then therefore the desired generalized force should be transformed to the rotational speed of shafts i e rpm the relationship between force including positive and negative direction and shaft speed is achieved according to the following equations kajanus 2014 3 f ρ k t d 4 θ n n n 4 n sign f f c rpm where c ρ k t d 4 θ ρ density of water k t thrust coefficient of the propeller d diameter of the propeller n rpm of the shaft θ thrust loss the rotation direction of the shaft of the propeller is related to the force required on the motion of rov with azimuth thrusters the force with direction of a thruster can be obtained by the rotation speed n of the shaft in the positive or negative direction and its azimuth angle the task of the ta system is to find suitable combinations of the thrusts i e rotation speeds in rpm and angles rad for all thrusters usually when the shaft rotates in the positive or negative direction the corresponding forces are not identical due to different kt and θ in two directions labels are employed to identify the direction of the force here c means positive thrust force coefficient while c denotes negative thrust force coefficient respectively these c and c values are used as bounds in two directions respectively to confine the results of the thrusters in the ta routine other parameters of the original minerva for ta remain in this work only 4 degree of freedoms i e surge sway heave and yaw are considered here the configure matrix of these 4 thrusters is listed as eq 5 5 b cos α 1 0 cos α 3 cos α 4 sin α 1 0 sin α 3 sin α 4 0 1 0 0 l 1 x 0 l 3 x sin α 3 l 3 y cos α 3 l 4 x sin α 4 l 4 y cos α 4 one dynamic positioning condition is chosen for illustration the generalized external force is provided in fig 7 the main task of optimization based thrust allocation is to find the history of thrust forces and angles of these 4 thrusters according to optimization purposes 3 1 2 dynamic multiobjective optimization problem for rov in this section the dynamic multiobjective optimization problem dmop for this rov is constructed according to the above analysis the decision variables will be discussed first followed by objectives and constraints according to the main task of thrust allocation i e finding suitable combinations of forces u and angles α of these thrusters the forces and angles will be chosen as decision variables moreover when allocation error is considered either in the objective function or in constraints the slack variables s should be included in the decision variable space usually slack variables are small values the bounds of all these variables are shown in table 3 in terms of objective function construction 2 conflicting characteristic aspects of dps fuel consumption and tear and wear are chosen for the present research purpose 6 min f 1 a n d f 2 f 1 u α s t i 1 m w i u i f 2 u α s t α α 0 t ψ α α 0 where t time u α force and angle vector of the thrusters respectively m number of the thrusters 4 w i fuel consumption mapping related to thrust forces kajanus 2014 the relationship between thrust force and angular velocity is a quadratic function therefore the power consumption of a thruster can be obtained from a cubic function of angular velocity a type of w i u i k i u i 3 2 is adopted by johansen et al 2004 and is also used in this work moreover k i 1 i 1 2 3 and 4 is supposed ψ tear and wear feature mapping of the thrusters in this model the variation magnitude of each azimuth angle compared with its previous status either increasing or decreasing will be calculated therefore the absolute value function abs is used the ψ value should be obtained from practical data however in this example an illustrative virtual value 10 3 diag 111 is supposed due to practical data insufficiency this value is just to illustrate the mapping relationship physical law of angles and objective function f2 nothing to do with the other objective function it is worthy to be noted that the mapping function of this virtual value is quite different from those weights function among different aspects of dps in the previous work e g kajanus 2014 even if they are identical in magnitude α 0 angles of the thrusters in the last time step it should be pointed out that these 2 objectives f 1 and f 2 will be considered independently in dmop solving process in this example the thrust allocation error will be much smaller since the external generalized load is within the capability of the thrust allocation system in this case the allocation error is unnecessary to be considered in objective functions therefore the slack variables will only appear in the equality constraint about generalized force i e 7 s τ b α u where τ the commanded generalized force vector other constraints may include the individual capability of the thrusters and the rate of limits they are listed as u m i n u u m a x α m i n α α m a x δ α m i n α α 0 δ α m a x 8 δ u m i n u u 0 δ u m a x in this example δ u m i n 20 n δ u m a x 20 n δ α m i n 40 and δ α m a x 40 the singularity will often occur for more azimuthal thrusters in the case of some combinations of angles johansen et al 2004 this may lead to failure of thrust allocation therefore this case should be avoided in optimization from the viewpoint of mathematics the configuration matrix b is not a full rank one in this case to avoid singularity an additional constraint must be added then ensuring that b is a full rank matrix i e 9 r a n k b α m where rank the rank of the matrix m 4 here in summary the dynamic multiobjective optimization problem dmop defined in this work is listed as follows objectives eq 6 10 subjected to eq 7 eq 8 and eq 9 the bounds of decision variables are defined in table 3 the main concern in this study is the introduction of multiobjective analysis into the ta field from the viewpoint of the classification of dmop lin et al 2019 dynamic multiobjective thrust allocation dmta is an application of dmop in the marine field with time linkage features in this research dmop and dmta are the same things they can be treated indiscriminately in dmop dmta the decision at each sampling will affect the following prospective behaviours when the next time step begins the optimization method will search suitable combinations of decision variables either free in the decision variables bounds as done in mofepso or starting from an initial guess solution given by the designer as done in traditional approaches qp sqp etc whatever algorithm is selected the physical constraints of thrusts and angles e g input saturation and rate constraints shown as eq 8 should be considered during each iteration step dependencies between 2 adjacent time steps are expressed by the constraint conditions for instance in mofepso when a new thrust or angle is found by the optimization method during updates procedure refers fig 3 this new thrust or angle should not violate the constraints the current solution satisfied previously where the constraints are just defined in eq 8 exactly parameters of the previous status are known for the present time the rate constraints about thrust and angle are the main dependencies between two time steps besides this new thrust or angle should be in the bounds as defined in table 3 if this new value reaches its bounds input saturation will be considered the singularity avoiding condition eq 9 should be satisfied too 3 2 optimization results and discussions suppose the initial status of the rov is u 0 0 0 0 0 and α 0 0 5 0 5 0 5 the sampling interval of the rotation speed of thrust shafts and angles is 0 2s this period is enough for transforming this dmop also dmta into an ordinary static mop during each sampling the parameters of mofepso are given in table 4 in this work the 2 objectives eq 6 will be used as attributes in the topsis procedure that is the dimensionality of the dataset for topsis is 2 before using topsis the relative importance of these 2 attributes will be provided by the designer table 1 different weights will lead to different results several pairs of weights about these two objectives attributes are chosen to study the effects of weights upon the characteristics of thrust allocation in this example usually the main concern of the designer about dps is fuel consumption therefore the weights of f 1 and f 2 can be set as for example 0 9 0 1 during the topsis procedure the history curves of objective space decision variables are shown as fig 8 and fig 9 respectively the pareto fronts at t 20 40 60 80 100 and 120s are provided fig 8 a and the whole history of objective space is also shown fig 8 b c it can be observed the pareto fronts at these sampling points are convex for this pair of weight the relationship between these 2 objectives can be studied from a 2d scatter plot however in the previous weighted sum approach johansen et al 2004 wu et al 2016 their relationships can t be read clearly due to aggregating operations before the optimization process besides the conflicting relationship between these 2 objectives is clearly shown in fig 8 a that is if one wants to reduce fuel consumption the corresponding tear and wear will increase one can t decrease them concurrently due to the intrinsic characteristic of a dmop on the contrary in the weighted sum approach the contribution of each part is cumulative and the conflicting of fuel consumption and tear and wear is not considered the location of the pareto front in the objective space plot will vary in the whole dynamic positioning process fig 8 a besides its shape will change at different time points a complex shape example is listed in fig 10 in which convex and non convex part can be found at t 45s for w 0 2 0 8 at least 3 local areas with concave features i e labelled as d1 d2 and d3 in fig 10 are found the relationship between fuel consumption and tear and wear is complex now and can be learned easily from the scatter plot of the objective space of dmop optimal solutions adjacent to d1 d2 and d3 area can t be found through the traditional weighted sum approach even if one changes weights parametrically this relationship between objectives has been omitted in the weighted sum approach through the weights just before the optimization before carrying out topsis the weights between fuel consumption and tear and wear are defined by the designer that is the preference of the designer depending on one s personal experience the effects of different weights on objectives and decision variables are examined here the effects of weights setting upon 2 objectives are illustrated in fig 11 it can be observed that when the importance of fuel consumption and tear and wear is equal i e w 0 5 0 5 the fuel consumption of the system fig 11 a is the lowest among these weights settings the values of tear and wear are quite relatively smaller compared with fuel consumption characteristics to investigate the difference resulted from these weights clearly a logarithmic coordinate is used for f 2 fig 11 b the effects of different weights upon tear and wear are not obvious it may recall that the physical law of angles and tear and wear ψ is 10 3 diag 111 if the weighted sum method is used to aggregate the two objectives how to ensure the effectiveness of tear and wear in the aggregated objective function will remain to be a problem as the phenomena a larger number annihilates a small number will occur often this result may suggest that to maintain the calculation precision of the weighted sum method for thrust allocation choosing suitable weights among individual aspects of dps is very important for example the allocation error item s t q s has been extensively used as a part of the objective function in the previous work johansen et al 2004 wu et al 2016 how to determine the q value is quite a challenge for the designer a suitable q should ensure that the differences between individual parts of the aggregated functions are not very large in the whole dynamic positioning process the advantage of the dmop method is demonstrated here that this challenge can be solved easily just through independent operations of objectives no evaluation works about the importance of each aspect during optimization model construction is required introducing weights between the objectives attributes in the decision making process will also have important effects on decision variables the history curves of thrusts from 3 pairs of weights are depicted in fig 12 it is observed that roughnesses exist in the history of thrusts this phenomenon is caused by two factors 1 characteristics of mofepso and 2 the nature of ta in each new time step mofepso will begin a completely new population initialization in design space fig 3 part i in other words the new initial status has nothing to do with the previous step status the rov status of the previous step will only be considered as constraints eq 8 rather than a reference for initialization in searching since ta is a time continual procedure different previous step status will give different free space for the next time step the searching and updating procedure will be carried out in the whole decision variable space therefore after iteration quite different solutions may be found roughness or jumping points on the curve will occur then the magnitude of the roughness is confined to those constraints besides mofepso when other meta heuristic algorithms are used to solve the ta problem this kind of roughness of the curves may also occur for example a similar phenomenon existed in the history of thrusts in our previous work li and yang 2019 where a single objective optimization of ta was obtained from 2 newly meta heuristic population based approaches mine blast algorithm mba and its improvement imba in the application of mba and imba for ta a completely new population is generated when a new time step starts too on the contrary the traditional methods e g qp sqp etc jahansen and fossen 2013 are gradient based algorithms when they are utilized in ta and the new time step begins an initial guess solution must be provided by the designer how to give this guess status of the ta system more efficiently is quite a challenging work if this guess status is defined freely in the whole decision variable space the traditional method can t give a guarantee to find the final optimal solutions solutions of traditional methods depend heavily on initial guess solutions i e local optimization points will be found by traditional methods the status in the previous time step is a good choice for the next time step this previous status is an available status which the system just experienced through this mechanism only the adjacent solutions around the previous time step will be found therefore smoothness features can be obtained by traditional methods the effects of varying weights upon thrusts are not large as shown in fig 12 especially for u 2 namely in heave direction this interesting observation can be explained by the constraint condition in this direction according to the definition of slack variables eq 7 and the configure matrix in eq 5 the equation in heave direction can be rewritten as 11 b 3 2 u 2 τ 3 s 3 u 2 is only dependent on τ 3 and s 3 in this example τ 3 is given as external generalized force and has nothing to do with weights between objective functions s 3 will vary when weights change too as shown in fig 13 s 3 is a small decision variable between 1 n and 1 n table 3 therefore according to eq 11 it is observed that 3 curves about u 2 in fig 12 b for different weights are nearly identical in conventional approaches qp sqp etc slack variables are not decision variables they are used in equations about external forces and generated forces by the thrusters they are usually considered as a part of the objective function too johansen et al 2004 they will become smaller along with the ta procedure in this work the bounds of slack variables are clearly defined in table 3 it is noticed that all these 3 slack variables vary in the bounds freely during the entire optimization procedure figs 9 b fig 13 the history curves of 3 azimuth angles are listed in fig 14 the angle variation of thruster no 1 bow resulted from weight difference is little in the whole history after the 80s the angle difference of the port thruster no 3 is becoming larger for the starboard thruster no 4 the noticeable difference will exist from the beginning of the dynamic positioning procedure the results of objective space fig 8 demonstrate the two characteristics of thrust allocation fuel consumption and tear and wear are conflicting in the whole dynamic positioning procedure therefore if one wants to find a solution to the thrust allocation a dmop rather than a dsop dynamic single optimization problem should be constructed the weight concept has been used in previous work johansen and fossen 2013 and this study however the difference is obvious in the previous work weight is used to construct the objective function i e dsop just aggregating several aspects into one final aggregated form through weights this operation is done before optimization problem solving in this study weight is also designed for evaluating the relative importance between objectives attributes however this operation is carried out in topsis where the pareto set has already been found through mofepso in solving this time linkage thrust allocation problem a compromise solution at each time sample must be determined for the next step in fact from the viewpoint of mop the weighted sum method is a priori skill before optimization and many modern multiobjective optimization algorithms e g mofepso in this study are posteriori approaches in which the decision maker s preferences should be given after the optimization procedure coello et al 2007 based on the above analysis a further examination of the objective function construction in the previous work will be provided here and a classification suggestion about this issue is proposed as shown in fig 15 it should be emphasized that two subcategories of the single objective optimization problem sop are contained in this classification i e sop1 and sop2 the selection of sop1 and sop2 branch is based on the judgement about external forces and allocation capability when generalized forces are far beyond the thrust capability only an allocation error is considered sop1 branch the main concern of the designer is just the slack variables now it is obvious the weight q is no longer necessary then i e s norm function is enough rather than qs this is due that the primary objective which is to satisfy the command generalized force can t be satisfied in this case moreover it is worthy to be noted that the slack variables only emerge in the objective function when s are much larger the equality constraint of generalized forces and slack variables i e eq 7 will not be considered in the optimization model now due that generalized forces are too larger than the allocation capability this equality constraint can t be satisfied in any case when the bounds of the slack variables are defined in a narrow range that is to say only a large and virtual force can meet the requirements of this equality equation from the view of practical design if the slack variable in one direction is large enough e g far away from the bounds in table 3 it may suggest that an additional thruster in this direction is needed the commanded force should be provided by this new thruster rather than the virtual larger slack variable on the contrary if external forces are within the capability of the thrust allocation system the sop2 branch is used in other words if this branch is examined the allocation error will not be considered as an objective or an individual part of the objective due to its minor magnitude according to its original definition the slack variables will only appear in the external force constraints eq 7 in this case this equality constraint can be satisfied easily in the bounds of the slack variables in the previous work the objective functions of these two branches have been mixed that is aggregating allocation error sop1 just through q weight with other criteria sop2 to form an aggregated objective function in this operation q is used for matching allocation error with other criteria from the viewpoint of calculation precision in addition to the difficult work of defining q weight the aggregated objective function will also lead to fuzzy physical meaning besides if only an sop is considered in practical application when the generalized force is input into the thrust allocation system this ta should give a judgement first a suitable optimization model i e either sop1 or sop2 branch should be chosen according to the comparison results between generalized force and allocation capability of course this judgement can also be undertaken by the upper level control system commanded generalized forces resulted from the upper level control system can be filtered when they are beyond the capability of the allocation system lessening the analysis load of the ta then in terms of the application of a multiobjective optimization method two parts of fuel consumption resulted from thruster force and moments were tested as 2 conflicting objectives in our previous study li and yang 2019 using the nsga ii deb 2001 approach to find the pareto set however only a one time sample not the whole dynamic positioning procedure was investigated no further decision making procedure was considered there 3 3 data mining results in each time sample many pareto solutions will be found by mofepso and only a compromise solution should be chosen as the initial condition for the next time sample the high dimensional data set can be accumulated through the whole thrust allocation process then to investigate the mutual relationships among objectives and decision variables in the pareto set the som approach with dimensionality features is used here two major purposes of som are 1 investigating the relationships among variables through the output layer and 2 examining the trajectories of variables in the positioning process it is worthy to be noted that som is also a kind of multivariate analysis approach lee and verleysen 2007 the word multivariate may be all aspects considered for example objective functions and decision variables can be regarded as research subjects here the following som analysis results are obtained with the help of a toolbox in the matlab environment som toolbox vesanto 2002 2 examples of som study are provided here the dimensionality of the data set for mining is 10 namely t time thrusts 4 angles 3 and objectives 2 the weights between objectives in these 2 examples are 0 2 0 8 and 0 8 0 2 respectively in example 1 the pareto solutions in each time point 5 points in 1 s are all collected the data set size is 127 425 10 then after network training a 69 height 26 width hexagonal plane of the output layer is generated listed in fig 16 the relationships among all these aspects can be learned from fig 16 1 from the time graph fig 16 1 it is observed that t 80s is a border point in history so do other variables this is the same with ordinary history curves in the above analysis 2 when rov begins a dynamic positioning process 0 t 80s the conflicting characteristics between fuel consumption fig 16 9 and tear and wear fig 16 10 are so obvious the upper part of their graphs when t is in 80 150 s the motion of rov becomes stably gradually the change of these objectives is relatively little just like the trends in fig 8 c 3 the lateral thruster no 1 fig 16 2 has a similar variation trend as the port thruster no 3 fig 16 4 a roughly similar trend can be found between u 2 fig 16 3 and α 3 fig 16 7 in the ordinary analysis one may not take notice of the relationships among different kinds of decision variables the advantage of som is that it can provide an overall visual graph among all variables learning cross kind relationships among variables is possible 4 it can be read that f 1 has a similar variation trend with u 1 and u 3 this may suggest that the correlations between fuel consumption f 1 and u 1 u 3 is stronger than f 1 and other 2 thrust forces u 2 and u 4 on the other hand the connection between the tear and wear feature f 2 of dps and 3 angles is complex when t 80s the final compromise solutions in each time step total 750 samples have also been shown in fig 16 the white lines in the graphs tell the trajectory of each variable in which the start point locates in the middle of the graph ending at the upper left corner the variation trends of high dimensional compromise solutions are displayed through this dimensionality reduction approach it may be noted that the history of objective space in fig 8 c is only 3 dimensional in example 1 all the pareto solutions in the whole dynamic positioning process are used the designer may have more interest in the final compromise solution at each time step som approach can also be applied then in example 2 after topsis operation only 750 compromise points in the whole dataset are left for w 0 8 0 2 therefore the 18 8 panel of som will be formed then listed in fig 17 several characteristics can be learned from fig 17 1 a similar trend still exists between u 1 fig 17 1 and u 3 fig 17 3 when the weight of fuel consumption fig 17 8 increases from 0 2 to 0 8 so does the connection among these 2 variables and fuel consumption f 1 2 the angles of α 1 fig 17 5 and α 3 fig 17 6 have a similar style they are different from those of α 4 fig 17 7 3 in this example a similar cross kind relationship u 1 fig 17 1 and u 3 fig 17 3 versus α 4 fig 17 7 can be identified 4 the variation of tear and wear is smooth in history however the fuel consumption f 1 is more dependent on decision variables 3 4 comparisons with existing results to study the features of the proposed approaches in this work comparisons with existing results are carried out here the ta results are heavily dependent on the physical model i e specifications of the ship and corresponding thrust allocation system e g number and layout of thrusters etc in the above study a virtual rov minerva with 3 azimuth thrusters is utilized for dmop dmta to the best knowledge of the author no existing results with features of multiobjective optimization analysis and subsequent whole history of ta results at the same time are available in the literature for this virtual rov minerva in our previous study li and yang 2019 one of the main research aims was the introduction of meta heuristic algorithms mba and imba into the application of the ship ta field the virtual rov minerva was adopted in that work the history of thrusts and angles was obtained through these 2 algorithms and compared with traditional methods sqp with multistart mechanism further multiobjective optimization of this virtual rov was tested only at a one time step therefore no decision making procedure was required for the next time step and the subsequent whole history of ta results from the multiobjective optimization viewpoint was not studied there this work compares with li and yang 2019 separately in two tasks multiobjective optimization results at a one time point and the whole history of ta results in single objective optimization in task 1 multiobjective optimization results are compared with nsga ii example 3 at t 60s whole ta history i e t 0 150 s is compared with the mba in a single optimization for task 2 example 1 mba is selected for comparison since the slack variables are considered only in that case the generalized external forces and constraints are taken from li and yang 2019 the decision variables and their bounds are the same as that work the objective functions in task 1 and task 2 are consistent with example 3 and example 1 in li and yang 2019 respectively in task 1 the external force is τ 42 82 n 256 00 n 19 04 n 1 50 nm u 0 167 74 23 74 56 23 71 72 n α 0 1 6226 0 9165 2 501 rad respectively the parameters of mofepso are the same as those in table 4 the pareto solutions at this time and comparison with nsga ii are given in fig 18 two parts of fuel consumption are selected as objective functions in example 3 li and yang 2019 two compromise solutions achieved from topsis of this work using different weights are shown as black blocks fig 18 a it is observed that the pareto set of mofepso has better objective functions fig 18 b this means mofepso can find a solution with lower 2 objective functions simultaneously for this multiobjective optimization example at this time in task 2 example 1 in the work of li and yang 2019 is studied and compared with mba the whole fuel consumption is chosen as the objective function j which is composed of 4 parts through the weighted sum method johansen et al 2004 appropriate modifications are adopted in mofepso to solve this single objective problem the updating of the non dominated set is no longer needed fig 3 the second section of part iv in fact in task 2 the function of mofepso is equivalent to its single objective version i e fepso hasanoglu and dolen 2016 the history of the objective function j and the relative difference percent with the mba are listed in fig 19 it is noticed that mofepso with modifications can find lower objective function value in the whole history which means the solution has even lower fuel consumption this is due to the higher searching capability of mofepso in decision variable space the history curves of the thrusts and angles of the thrusters are provided in fig 20 and fig 21 respectively the difference in the objective function is very small fig 19 and the ta results from mofepso here are also very close to those of mba li and yang 2019 it can be observed the history of mofepso is much smoother than those of mba for u1 u3 and u4 similar smoothness in 3 angles can be found in fig 21 too from the above comparisons it is noticed that the searching capability of mofepso in the whole ta procedure is better than that of the mba in this example however the running time of mofepso for 1 ta time step is about 26 8s in this single objective optimization problem while only 10 2s is needed in the mba 3 5 discussions on the complexity of the ta method the ta method in this study includes 3 parts mofepso multiobjective optimization topsis decision making and som data analysis the implementation complexity of the proposed method is investigated here 1 due to the complexity of the ta model especially handling 8 inequality constraints eq 8 and 2 equality constraints i e eq 7 and eq 9 mofepso is adopted here to find the pareto set at each time step mofepso is a kind of multiobjective particle swarm optimization mopso with several specialized operations the complexity of mofepso is raised from its unique constraint handling method the extra calculation load is related to the complexity of constraints directly compared with generic mopso 2 aspects are emphasized in mofepso as follows hasanoglu and dolen 2018 first in the initialization phase the constraint sensitivity calculation involves number of population x number of decision variables member movements and constraint evaluations to find sensitive directions this operation is based on one principal direction at a time thus increasing the computational cost significantly second in the main iteration loop the algorithm complexity comes from activated constraint selection virtual boundary search vbs and constraints priority updating operations selections of ac and updating of constraint priority are only executed on infeasible particles and time cost can be neglected due to just updating several elements of initial arrays therefore the major computation load is contributed by the vbs process constraints will be calculated continuously until a legitimate virtual boundary is found it should be noted that this complex vbs procedure will be performed at each iteration step the total computation time has a direct relation to the number of constraint function evaluations cfes demonstrated numerically for a benchmark problem c14 by hasanoglu dolen 2018 in this work the population size is 200 and the maximum iteration is 500 the numbers of cfe and objective function evaluations ofe in each ta time step are about 118 thousand and 83 thousand respectively 2 decision making is a necessary procedure after the pareto set is found by mofepso topsis is a sophisticated decision making approach the dataset needed in the topsis procedure is generated directly from objective space eq 6 and weights are given by the designer in advance table 1 operations in topsis are just basic matrix calculations the structure of topsis is simple and the time cost can be ignored 3 som is used as an analysis tool to mine useful information about ta results obtained from mofepso and topsis in this work similar to topsis the som approach is also widely used in many fields when the 127 425 10 data set fig 16 is input to train the network about only 10s is needed it is worthy to be noted the trajectory of the ta is shown in fig 16 this may suggest that the som component graphs can be used as a background for monitoring the ta procedure this monitoring function is an important feature of som and is adopted in many industrial fields vesanto 2002 to use this monitoring function so much data of the ta system resulted from various working conditions e g external generalized forces the capability of ta initial thrust and angles etc together with different control strategies should be collected in advance the visualization of ta trajectory in those som graphs in real time is easy however to obtain a robust som is quite a tedious work in this work the simulation is finished on the matlab platform specifications of a personal computer are intel i5 3470 cpu 3 20 ghz 4 0 gb ram with the 64 bit operating system serial computation is used in mofepso this study is an attempt for the potential industrial application of meta heuristic methods in ship ta in this example the time consumption in mofepso and topsis task for 1 ta time step requires approximately 45s when the population size is 200 and the maximum number of iterations is 500 table 4 the proposed approach can t be implemented in the direct control layer of dps in real time without extra help in the last 2 decades many works have been conducted to speed up the execution of heavy computational workload resulted from population based meta heuristic algorithms e g pso through implementing them just on hardware the optimization algorithm can be embedded in the hardware thus the solving speed can increase significantly for instance an efficient hardware core for pso was developed by damaj et al 2020 to run in field programmable gate arrays fpgas platform the corresponding statistical framework was also built taking the features of the optimization algorithm and its implementations into consideration the test of benchmark problems showed the effectiveness of hardware implementation and significant time reduction 23 300 and 1777 improvement ratio of execution times were achieved for elliptic evaluation function and shifted schwefel s function respectively moreover the hardware software co design approach is another alternative method for speeding up the execution of optimization loads for example a design plan was proposed by li et al 2011 where the particle updating accelerator module was executed by hardware updating velocity and position of the particles fitness evaluations are carried out in fpga or soft cored processor evaluating the objective functions 13 benchmark functions from the ieee congress on evolutionary computation cec 2005 and cec 2010 were tested and better performances were observed via the hardware software co design approach furthermore an experiment in shifting sphere function with 32 variables demonstrated that overall execution time reduced from 163 1549s to 13 4673 ms via pure hardware realization a speedup up to 12 115 was obtained this may suggest that if the calculation loads of the present work could be executed on the fpga platform wholly or partly the time consumption might be shortened dramatically it will have the potential to guarantee the real time feature in ta this research direction will be considered in our future work 3 6 summary in the analysis the dynamic positioning process of an rov example is examined the results of mofepso topsis and som analysis are dependent on the initial condition moreover the relative importance of 2 objectives fuel consumption and tear and wear is defined before the topsis operation according to the preferences of the designer i e subjective weight different characteristics of thrust allocation for this rov will emerge for other external generalized forces and different weights setting methods the main concern of the present work is to provide a two phase analysis flowchart for thrust allocation in ship application from the viewpoint of multiobjective optimization decision making and further data analysis the above results demonstrate that those aspects which are taken into consideration in the previous thrust allocation works are conflicting and therefore a dmop also dmta can be constructed and solved by the modern meta heuristic optimization algorithm compared with the conventional and the most popular weighted sum approach in the previous work the proposed analysis procedure in this work extends the application of optimization algorithms in ta and can help the designer to understand the characteristics of thrust allocation from a new viewpoint besides the analysis framework in this study is general other meta heuristic optimization algorithms e g multiobjective evolutionary algorithm moea coello et al 2007 and multiobjective differential evolution mode das et al 2016 other weight setting methods e g entropy method jaynes 1957 ahp ishizaka and nemery 2013 etc and data mining approaches e g correlation clustering härdle simar 2012 etc can all be tested within this framework much hidden information behind the optimization model can be grasped by the designers it may be noted that selecting a suitable mop method for a certain application may need much work due to no free lunch nfl theorems coello et al 2007 that is an algorithm s robustness for all problems can t be assured certainly applying the present approaches in real time is another important research direction 4 conclusions in this study a two phase analysis framework is proposed for thrust allocation in ship application from the viewpoint of multiobjective optimization and decision making furthermore a widely used data mining skill som is employed to find the hidden relationships among objectives and decision variables in the whole dynamic positioning history from the above analysis several conclusions and recommendations for future work are given here 1 the aspects which were considered in the previous work e g fuel consumption and tear and wear characteristics are conflicting in fact the thrust allocation solutions can be obtained through modern multiobjective optimization approaches taking advantage of those meta heuristic algorithms therefore the application of optimization in thrust allocation is extended the drawbacks of the widely used weighted sum method in the previous work can be overcome then 2 a suggestion about objective function construction is provided in terms of discussing of slack variables when external generalized forces are far beyond the thrust capability only an allocation error is considered in the objective function on the contrary the allocation error will be considered just in the constraints about generalized forces 3 the analytical framework proposed here is generally for obtaining the pareto set choosing a final compromise solution and mining useful information among high dimensional data set any other approaches of interest can easily be investigated for applications in the ship field within this framework in future work other criteria can also be chosen as the objective function of dmop dmta depending on the specific application many other modern multiobjective optimization methods could be investigated then the objective weight calculation method e g entropy or combinations of objective weights and subjective weights will be tested in the decision making procedure other data mining skills can also be examined in ship applications implementing modern meta heuristic optimization algorithms on hardware in real time is another important direction for ta study moreover monitoring the dynamic thrust allocation process with the help of som visualization will be a meaningful exploration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the author would like to thank the anonymous reviewers for valuable comments and suggestions which helped to enrich the quality of the work presented in the manuscript 
