index,text
23870,this study investigates the effect of surface currents on wind generated waves in a complex coastal system with narrow fjords the simulations are based on a phase averaged wave model forced with surface currents from a high resolution coastal ocean and fjord circulation model and high resolution winds from a nested atmospheric model wave simulations with and without ocean forcing are evaluated by comparing integrated wave parameters and modelled spectra with observations from five wave buoys the comparison covers three winter seasons 2017 2020 and a case study the wind sea part of the spectrum is better simulated at all locations when using the current forcing at the most sheltered location where wind sea dominated the wave climate the wave height estimates improved by 12 percentage points when including current forcing spectral moments and the shape of the average spectra are also improved at most of the locations when current forcing is applied the effect of wave current interactions was found to be more pronounced at inner locations where the relative difference of spectral bandwidth is up 5 the difference in directional spreading is greater than 5 degrees during strong surface currents and the relative difference in peak frequency is exceeding 10 our results are consequential for narrow deep and sheltered water bodies but are not expected to carry over to shallow water areas keywords wind waves current fjord swan roms wrf 1 introduction predicting wave growth is essential for a range of oceanic and coastal applications such as maritime transport fish farming and ocean engineering nonetheless the quality of wave predictions is highly affected by both atmospheric and ocean forcing while the former generates wind waves the latter modulates the existing wave field the relative wind speed acting on the sea surface is modified by surface current which in turn affects the wave growth according to ardhuin et al 2012 the relative wind effect can explain about 20 40 of the modulation in wave height induced by strong currents off the west coast of france surface currents also change the absolute wave frequency f through the doppler shift spatial variation of surface currents modifies the relative wave frequency σ 2 π f k u c where k and u c are the wavenumber and surface current vectors and causes wave refraction and energy bunching stretching opposing currents can be associated with the occurrence of extreme wave heights i e rogue waves onorato et al 2011 toffoli et al 2015 regions with strong wave current interactions can enhance wave breaking melville et al 2005 romero et al 2017 romero et al 2017 found large modulations of the wave height up to 30 due to wave current interactions at the edge of an upwelling jet off the coast of northern california and the loop current in the gulf of mexico their results showed large variations in wave breaking parameters such as significant slope whitecap coverage and directional spreading with the two last ones being inversely correlated it is well known that large scale wind driven currents such as the gulf stream mapp et al 1985 the kuroshio hwang 2005 and the agulhas current irvine and tilley 1988 affect surface waves in the open ocean significantly ardhuin et al 2017 found that also smaller scale currents 10 100 km significantly affect ocean waves marechal and ardhuin 2021 concluded that incident waves with small directional spreading swell experience stronger wave height gradients in the agulhas region romero et al 2020 found that during low winds the significant wave height in the santa barbara channel can increase by up to 50 80 in specific areas due to current induced refraction however to our knowledge the impact of currents on wind generated waves in much narrower channels e g fjords has not been explored this study aims to quantify the impact of ocean currents on surface waves in fjords fjords are typically long narrow and deep inlets of water the water masses in fjords are often strongly stratified containing three distinguishable water masses i surface brackish water ii intermediate water and iii basin deep water e g saetre 2007 the surface layer often receives freshwater from rivers but this is mixed with the more saline water flowing into the fjord from coastal and offshore regions creating a brackish surface layer the intermediate layer is located between the surface layer and the deep water where the latter is typically bounded by the depth of the sill the circulation in the intermediate layer is dominated by horizontal pressure gradients between coastal and fjord waters with longer time scales than upper layer dynamics tides affect the fjord dynamics at all levels the depth of the surface layer is about 1 10 m depending on the river runoff s strength seasonal variation and the amount of wind driven mixing the circulation in the surface layer is also strongly affected by winds and waves the wave climate is mainly determined by the dominant wind direction and strength the typical duration of low pressure systems and the geometry of the fjord system fetch and width of fjords as many norwegian fjords are long with steep mountainsides they are often exposed to intensified and topographically steered winds the norwegian coastal current flows northwards along the norwegian coast saetre 2007 the current transports low salinity water from the baltic sea and the norwegian rivers to the barents sea it is primarily driven by density gradients garvine 1995 and by the dominant southwesterly winds skagseth et al 2011 and references herein in complex nearshore areas such as the norwegian coast with thousands of islands and narrow channels providing accurate wave forecasts is challenging two norwegian organizations have developed and provide open access operational wave forecasts along the norwegian coast i the norwegian meteorological institute which provides coastal wave forecasts based on the wam model the wamdi group 1988 with 800 m spatial resolution and ii the norwegian coastal administration in cooperation with norce as and barentswatch who have developed a coastal wave forecast system for fairways based on stwave massey et al 2011 with 100 m spatial resolution furevik 2017 none of these operational forecast systems accounts for the impact of surface currents on the waves in the coastal zone and in fjords the imprint of currents on ocean waves in fjord areas has not been quantified mainly due to a lack of appropriate high resolution ocean forcing and observations in these areas remote sensing techniques such as satellites are not reliable due to the land proximity and the observations are mainly limited to point measurements such as wave buoys in 2016 the norwegian public roads administration npra launched one of the largest measurement campaigns of wind wave and current conditions along the norwegian coast the norwegian authorities aim to upgrade the coastal highway route potentially replacing ferries on several fjord crossings with bridges and tunnels the measurement campaigns in the fjords provide the essential data for the design of these large state of the art road projects but also function as advanced met ocean studies in areas where they previously were not possible this study has the overall goal of taking advantage of these unique measurements to improve our understanding of wave current interactions for designing coastal structures and aims at answering the following questions i how important are the ocean currents for the wave modulation in a fjord system ii which mechanisms affect the coastal and fjord waves and iii what is the order of importance of current effects on waves in different fjord locations conditions our study is focused on a deep more than 300 m deep in most places fjord system located on the west coast of norway fig 1 special attention is given to two areas i sulafjorden equipped with buoys a d is a fjord exposed to strong swell from the norwegian sea and ii the fjord cross section near buoy f as shown in fig 1 this paper is organized as follows section 2 presents an overview of the wave model and the wave current interaction theory and section 3 describes the results sections 4 and 5 discuss the results and present our conclusions 2 description of the modelling system the study area is illustrated in fig 1 also described in christakos et al 2020 buoys a b c and d breisundet are located in sulafjorden and buoy f is deployed at the junction between three fjords sulafjorden has an average width of 4 5 km and a length of about 10 km wind sea and swell conditions usually coexist in sulafjorden due to its exposure to the open sea however the inner parts of the fjord system e g location f are characterized by a wave climate with only local wind sea and little or no swell 2 1 the wave model the wave model swan simulating waves nearshore booij et al 1999 ris et al 1999 is a third generation spectral model developed mainly for coastal applications in this analysis the swan cycle iii version 41 20 is implemented for the fjord system the model determines the evolution of the wave action density n e σ e is the wave variance density dictated by the action balance equation 1 n t c x n x c y n y c σ n σ c θ n θ s t o t a l σ here c x and c y are the group velocity vector components in geographical x y space the c σ and c θ represent the propagation in frequency direction σ θ space the term s total is defined in eq 2 as the sum of the individual source terms where s in is energy input generation by wind s ds is the dissipation induced by white capping s nl4 is the nonlinear wave energy transfer due to four way wave quadruplet interactions s nl3 is the three way triad nonlinear interactions active in shallow to intermediate water s fric is the bottom friction and s brk is the depth induced wave breaking 2 s total s in s ds s nl4 s nl3 s fric s brk s nl3 can be ignored in deep water and is switched off 2 1 1 saturation based white capping and wind input we are using the saturation based white capping by alves and banner 2003 which is implemented in swan by van der westhuysen et al 2007 this white capping parameterization is more accurate than the swan default by komen et al 1984 in mixed swell wind sea conditions and was found to perform well in fjord areas in a previous study christakos et al 2021 this white capping function s ds has two parts a non breaking part given by komen et al 1984 and a breaking part s break which is defined as swan team 2017 3 s break σ θ c ds b k b r p 2 tanh k d 2 p 0 4 g k e σ θ here c ds 0 50 1 0 4 is the white capping dissipation parameter g is the acceleration due to gravity and d is the water depth the azimuthally integrated spectral saturation is given by b k e σ k 3 c g where c g is the wave group velocity if b k is under the threshold saturation level b r 1 75 1 0 3 there is no wave breaking but a background dissipation is obtained by p 0 if b k is greater than b r there is breaking and p p 0 p 0 a calibration exponent here p is given as a function of b k in order to obtain a smooth change between these two conditions alves and banner 2003 the wind input s in is a combination of the formulations by komen et al 1984 plant 1982 expressed by yan 1987 4 s in σ θ c 1 u c 2 c 2 u c c 3 cos θ θ w c 4 σ e σ θ where c is the phase velocity θ w is the wind direction and c 1 4 are coefficients given by swan team 2017 the friction velocity u estimate is based on zijlema et al 2012 the package will hereafter be denoted westh 2 1 2 wave current interactions in the swan model the wave current interactions are mainly taken into account in the left side of eq 1 via the change in propagation velocities the propagation velocities in physical and spectral space under the effect of surface currents are given by 5 c x c y c g u c 6 c σ σ d d t u c d c g k u c s and 7 c θ 1 k σ d d m k u c m here s is a coordinate in the wave direction and m is perpendicular to s finally currents also affect the right hand side of eq 1 through the wind input term s in since the wind speed in a frame of reference moving with the currents experiences a relative wind vector difference between wind and surface current vectors 2 2 model set up and boundaries swan was run in non stationary mode with spherical coordinates a 10 minute time step 36 directions and 32 discrete frequencies logarithmically spaced from 0 04 to 1 hz the inner domain with grid resolution 250 m 250 m red rectangular box in fig 1 lower right panel is nested into the outer grid of 1 km 1 km more details in christakos et al 2020 2 2 1 the ocean forcing the ocean surface current forcing is provided by the norkyst800 ocean model system albretsen et al 2011 with a 1 hourly temporal resolution norkyst800 is a high resolution ocean modelling system that covers the whole of the norwegian coast the system predicts current salinity temperature and water level norkyst800 is based on the numerical ocean model roms regional ocean modelling system shchepetkin and mcwilliams 2005 haidvogel et al 2008 with a spatial horizontal resolution of 800 m and 35 vertical levels the surface currents are used to force the wave model and the uppermost vertical level corresponds to a depth 10 20 cm below surface the exact thickness depends on the total water depth as roms applies a terrain following vertical coordinate the main external forcing agents in norkyst800 come from a high resolution atmospheric model arome2 5 km a hydrological runoff model a global tidal model and a large scale ocean model asplin et al 2020 found good agreement between norkyst800 and current observations in coastal and fjord areas particularly in the upper 10 20 m 2 2 2 the wind forcing the atmospheric forcing used for the swan wave model runs is generated by wrf0 5 which is a dynamical downscaling of the era interim reanalysis dee et al 2011 using the advanced research wrf arw skamarock et al 2008 numerical weather prediction model version 3 5 0 more details about wrf0 5 are provided by christakos et al 2020 the wrf0 5 wind fields in the fjord system have a spatial and temporal resolution of 0 5 km and 1 h respectively 2 2 3 the offshore wave boundaries the nora10 hindcast provided the wave conditions at the grid boundaries of the outer swan model domain with 3 hourly temporal resolution information about the spectral nesting and interpolation can be found at breivik et al 2009 the nora10 s wave component is a 10 km 10 km wam model forced by hirlam winds nested inside a 50 km 50 km outer domain forced by era 40 winds reistad et al 2011 this outer domain covers a large part of the north atlantic which provides realistic simulations of low frequency wave e g swell propagation from the open sea to the norwegian coast the hindcast uses analysed fields from the european centre for medium range weather forecasts ecmwf as initial and boundary conditions and has been found to compare well with a similar downscaling of era interim haakenstad et al 2020 2 2 4 the wave simulations to assess the effect of the currents on wave dynamics we have performed two wave simulations the first is a control run with wind forcing hereafter swan and an alternative run with wind and current forcing swanc the wave simulation period includes three winters december january february from december 2017 to february 2020 in addition we performed wave simulations for a selected case with alternative current forcings equal to 2 of the wind forcing or 120 of the norkyst800 current speed these simulations are denoted swan2 w and swan120 c respectively 2 3 observations observations from wave buoys fig 1 are used to assess the performance of different model set ups the measurements include both integrated wave parameters and spectral wave data as well as wind and currents furevik et al 2020 the acoustic measurements of surface currents are obtained at 1 m below the sea surface for the evaluation of model wind speed the observed wind is adjusted to 10 m height u 10 using a logarithmic profile e g christakos et al 2020 2 4 statistical parameters the statistical characteristics of the sea surface can be expressed as spectral moments as follows 8 m n 0 σ n e σ d σ n 1 0 1 where m n is the n th order moment of e σ in this study we estimate the first positive m 1 and negative m 1 moment the former gives more weight to higher frequencies while the latter gives more weight to lower frequencies when we compare to observations these moments were determined by integrating up to the maximum frequency of the observations the significant wave height is estimated from the zeroth order moment as 9 h m 0 4 m 0 the spectral bandwidth longuet higgins 1975 is defined as 10 ν m 0 m 2 m 1 2 1 t m 01 t m 02 2 1 the directional spreading is estimated following kuik et al 1988 as 11 σ θ 2 1 sin θ e σ θ d σ d θ 2 cos θ e σ θ d σ d θ 2 e σ θ d σ d θ 2 the average relative difference rd of a variable χ e g h m 0 is defined as 12 rd χ δ χ χ swan where δ χ χ swan c χ swan is the difference of χ between swanc and swan the temporal mean of χ over the whole simulation period is denoted χ while the mean of the highest five percentiles q 0 95 denoted χ q 0 95 the dimensionless width of a fjord location is calculated as 13 x w g x w u 10 2 here x w is the width distance across the fetch for more details see christakos et al 2021 2 5 error metrics the error metrics used in the present study are the pearson correlation coefficient r which describes how model estimates y i and observations x i are linearly correlated where r 2 ranges between 0 no correlation and 1 perfect linear correlation 14 r i 1 n y i y x i x i 1 n y i y 2 i 1 n x i x 2 the bias is defined as the mean difference between y i and x i 15 bias y i x i the scatter index is defined as the standard deviation of the difference between y i and x i normalized by the mean of x i 16 si 1 n i 1 n y i x i y x 2 x finally the normalized difference bias of h m 0 is defined as 17 nbi h m 0 s w a n c h m 0 o b s h m 0 o b s here h m 0 s w a n c and h m 0 o b s are the modelled and observed significant wave height for the estimation of nbi only h m 0 s w a n c and h m 0 o b s values greater than 0 20 m are considered 3 results 3 1 model evaluation norkyst800 reproduces the dominant current direction well fig 1 with the largest deviations at locations c and f compared to observations the modelled surface current speeds are weaker at all locations the dominant wind direction is well represented but the modelled wind speed is too strong in most parts of the fjord system as illustrated in fig 1 modelled wind and current directions are closely aligned in locations a c and f in location d the current direction is both from east and west as the buoy is located in the centre of the straight where both inflows from the west and outflow from the east occur in the southern and northern part of breisundet respectively the dominant wind direction at d is from the southwest in locations a and b the main current and wind directions are from the south southeast at location c the dominant current and wind directions are from the southeast and south southwest respectively in the innermost location f the dominant directions of both current and wind are from the southeast at all fjord locations both wind and current directions are determined by the axis of the fjord the observed and modelled dominant wave directions agree at all locations not shown at location d a b and c sulafjorden the main wave direction is from the open ocean aligned with the fjord axis northwest fig 1 this indicates i the dominant role of the open sea waves penetrating into sulafjorden and ii the importance of fjord geometry in controlling the wave direction at location f the dominant wave direction is from the southeast also aligned with the fjord axis as seen in fig 2 both swan and swanc show similar overall performance 0 5 percentage points difference at locations exposed or partially exposed to the open sea d a b and c the simulation with current forcing swanc shows an overall better performance in terms of wave height both runs perform best r 0 87 bias 0 16 and si 0 32 at the most exposed locations i e d a and b in locations c both model runs overestimate significantly 60 70 the wave height at the same location swanc shows a slightly improved r and bias and a lower by 5 percentage points overestimation of observed wave heights compared to swan the highest difference between the model simulations is detected at location f where the simulations with surface currents swanc improve the wave estimates by 12 percentage points compared to swan in addition swanc shows a reduction in si from 0 68 to 0 63 bias from 0 13 to 0 11 but also a small decrease in r from 0 81 to 0 80 the average spectrum and the average spectral moments m 1 and m 1 of the overall and the highest quantiles q 0 95 for swan swanc and observations are shown in fig 3 both model runs perform similarly for exposed locations d not shown a and b with swanc providing slightly better estimates for the spectral moments m 1 and m 1 regarding the highest 5 the wind sea part of the spectrum in a and b improves slightly when current forcing is included the average spectrum in location c shows that both simulations have a near identical shape while the simulated energy of the dominant waves around the peak and the spectral moments overestimate ca 2 3 times the observations regarding the highest quantiles q 0 95 at c swanc shows i slightly higher energy of the lowest frequency peak e g swell and ii lower energy of the wind sea part with the peak frequency being shifted to higher frequencies than swan when the wave simulations are compared to observations the high frequency density peak is estimated more accurately by swanc while the low frequency density peak is overestimated by ca 2 times in both simulations with swanc in the most sheltered location f where swell is nearly absent and wind sea dominates the wave climate we observe the highest reduction by ca 20 in q 0 95 of the dominant energy when current forcing is present swanc fitting best the observed spectra swanc also provides the best performance in terms of spectral moments for both the overall average and the highest quantiles 3 2 met ocean climatology winter season based on norkyst800 data from the winter seasons december 2017 february 2020 we visually identify two main patterns of surface currents fig 4 top i along the coastline and ii an outward from inner to outer fjord locations current with a local maximum at the inlet of sulafjorden and at narrow inner fjords e g close to location f both patterns have a similar magnitude with u c 0 2 0 3 m s 1 and u c q 0 95 0 5 0 7 m s 1 similarly the wind conditions are characterized by strong winds along the coast from the southwest and within the fjords with u 10 and u 10 q 0 95 up to 10 m s 1 and 24 m s 1 respectively fig 4 middle the wave climate fig 4 bottom is dominated by offshore waves from the west northwest in areas off the fjord system h m 0 and h m 0 q 0 95 up to 4 m s 1 and 8 m s 1 respectively wave conditions at inner fjord locations are dominated by the local wind sea with wave heights approximately 4 times lower compared to offshore waves 3 3 spatial current effects on fjord waves to identify the most affected areas by the ocean currents the average relative difference between swan and swanc for h m 0 σ p relative peak frequency ν spectral bandwidth and the average cos δ θ p θ p peak wave direction over the fjord system is illustrated in fig 5 the cos δ θ p describes the magnitude of wave refraction where 1 and 0 indicate no and 90 refraction respectively when current forcing is included swanc we observed i a reduction of wave height of up to 15 in the inner fjord locations while at the exposed locations the change is between 2 5 and 5 ii the relative frequency in the fjord locations generally increased when currents were accounted for with the change being up to 15 off the fjord system the use of currents had practically no effect on the relative frequency iii an increase up to 5 of the spectral bandwidth at inner fjord locations and iv weak refraction at inner fjord locations and nearly no refraction off the fjord system including the surface currents have no significant impact on the directional spread on average fig 6 left however the top 5 of the currents fig 6 right are strong enough to modify the spread of the wave field in the fjord system in the exposed areas where the strong outward currents meeting the incoming long and energetic waves swanc shows up to 6 degrees narrower directional width spread than swan at inner fjord locations where surface currents and waves are generally in the same direction δ σ θ is positive up to 6 degrees indicating that the current forcing induces wider directional spread 3 4 inner fjord location focusing on an inner fjord area such as location f where the highest differences between swan and swanc are detected we observe that for most of the time not shown surface currents follow the wave direction resulting in an overall decrease of wave height fig 7 reveals that swanc performs better lower nbi than swan for low to moderate dimensionless width x w where most of the data is observed as it is illustrated by christakos et al 2021 the highest nbi at f for different source term packages is observed for low to moderate dimensionless width 3 5 case wind sea and following currents at inner fjord location to further understand the wave current interactions at the most affected areas location f we perform a case study where strong winds and surface currents have approximately the same direction more specific on january 15 2018 strong winds 15 m s 1 from the southeast generated a high local wind sea christakos et al 2020 at the inner fjords location f figs 8 top right panels and 10 top left panel reveal strong surface currents aligned with the inner fjords axis at january 15 2018 9 utc time series of wind surface currents and integrated wave parameters at location f during the event are presented in fig 8 top both speed and direction of the surface current and wind are in good agreement with observations small differences are detected between swan2 w swanc norkyst800 and observations for both surface current velocity and direction the observed mean wave direction θ ranges from 130 to 150 not shown all simulations predict the wave direction well the modelled surface current direction θ c is in good agreement with observations because of a weak wave refraction induced by the currents the difference in wave direction between swan and swanc is below 10 the observed h m 0 reaches up to ca 1 m the simulations without current forcing strongly overestimated h m 0 but this overestimation is sharply reduced in the simulation forced with the wave following currents similar results are also detected in f p peak frequency furthermore the observed modelled current profile fig 9 indicates the existence of a stratified water column with two layers i an outward surface current and ii an inward current at ca 50 60 m depth the outward surface current is a wind driven current the sharp reduction of wave energy due to the following currents is illustrated in fig 8 bottom the energy of observed dominant waves is ca 50 lower compared to simulations without current forcing swan simulations also under predict the peak frequency including the current forcing improves the estimation of dominant wave energy and peak frequency the energy of the spectral tail above ca 0 35 hz is modelled similarly in all simulations being somewhat higher compared to the observations using the alternative current forcing swan2 w also provides a better estimation of dominant wave energy compared to swan reducing the peak density by 27 increasing the surface current of norkyst800 by 20 swan120 c we observe a reduction of energy of the dominant waves by ca 12 compared to swanc the spatial difference in h m 0 between simulations with and without current forcing and the modelled surface current are presented in fig 10 top on january 15 2018 at 09 utc the highest negative value up to 0 4 m is detected at the cross section of the fjords close to location f where u c 0 3 m s 1 no significant differences in the wave direction are detected between the two simulations in addition the current forcing reduces the relative peak wave period by up to 0 6 s for most of the fjord area near f not shown a snapshot of the deep water source terms s in s ds and s nl4 over the fjord cross section at location f at january 15 2018 at 09 utc is shown in fig 10 bottom the results indicate that the source terms are significantly affected by the presence of surface currents more specific the swanc shows reduced magnitudes by ca 30 in the deep water source terms for the dominant waves and ca 14 higher σ p compared to swan for shorter waves relative frequency greater than 0 25 hz both simulations show minor differences for s in and s ds 4 discussion swan without current forcing provides a good overall model performance in terms of h m 0 and average spectral characteristics in exposed locations where mixed wind sea swell conditions are observed with minor differences compared to swanc with the current forcing in addition accounting for currents have a positive effect on the accuracy of the local wind sea part of the spectrum in these locations the wave climate in the exposed areas to the open sea is dominated by strong swell or and old wind sea from west northwest fig 4 on the other hand the surface current and wind off the fjord system has a dominant direction from the southwest which is near perpendicular to wave direction leading to i a weak doppler shift since k u c 0 ii a weak change in σ due to no significant changes of current field along the same direction c g k u c s 0 iii a weak current induced refraction while there are no significant changes of current field across the wave crest k u c m 0 iv a weak modulation of the dominant waves due to no significant changes in group velocities because the surface current velocities are much lower than the typical swell group velocity for example a wave with a period of 14 s c g 11 m s 1 for deep water under the effect of surface currents of 0 7 m s 1 experiences ca 6 change of absolute group velocity as it was also concluded by christakos et al 2020 simulations with pure wave propagation without wind forcing showed quite similar overall results in the exposed fjord locations revealing the dominant role of boundary offshore waves therefore in the exposed locations the ocean forcing has a secondary role after the quality of boundary waves and wind forcing in contrast to exposed locations swan performs quite poorly at inner locations in these areas both the current section 3 and the wind forcing christakos et al 2020 are essential for more accurate wave estimates more specifically the surface currents and the wind generated waves are nearly aligned following leading to i a maximum doppler shift since k u c k u c 1 ii a change of σ due to changes of the current along the wave direction c g k u c s the following currents induce a negative c g k u c s leading to a reduction of σ eq 6 however energy stretching and a reduced relative wind by the following currents resulted in a higher σ p iii a weak current induced refraction due to some variation of current fields across the wave crest k u c m iv a strong modulation of the dominant waves due to significant changes on group velocities considering that the surface current velocities at inner fjord is about 0 5 m s 1 a typical wave period of young wind sea of 3 5 s with velocity equal to 2 7 m s 1 which corresponds to ca 18 5 increase of absolute group velocity v a ca 3 reduction of wind speed due to the relative wind effect considering a case with relative high wind speed u 10 of about 15 m s 1 and u c of ca 0 5 m s 1 the relative wind speed is about 3 lower than u 10 vi since the wind input eq 4 is a function of inverse wave age u c or u σ g for deep water changes in both σ and u should also be taken into account in case of a following current and a divergent current field the inverse wave age is decreased since both u relative wind effect and σ c g k u c s 0 in eq 6 are decreased the main problem at inner fjord locations is the overestimation of wave energy by the model adding the current forcing reduces the dominant wave energy s estimation by ca 50 when using the westh physics package fig 8 a reduction of similar magnitude is also seen with the other source terms packages not shown this 50 reduction is also in the same order magnitude as changing the source term package from st6 babanin et al 2010 to westh when not accounting for the currents christakos et al 2021 a common engineering approach to achieve more precise wave estimations is the calibration of the wave model for instance tuning the white capping coefficient c ds is widely used when under over prediction of wave energy is observed e g amarouche et al 2019 however at inner fjord locations ignoring the ocean forcing can lead to an over calibration of the wave model as a rule of thumb the surface current induced by wind is about a few percent of the wind e g 2 at open ocean e g fergestad et al 2019 for instance wind speed of 15 m s 1 should induce a fully developed wind driven current of 0 3 m s 1 our sensitivity study indicates that for location f where the currents are restricted by the narrow fjord geometry this simple practice used in swan2 w can outperform swan with no current forcing however swan2 w is not as accurate as swanc where the actual current forcing is used the ocean current in spectral waves models e g swan is usually taken as a surface or depth uniform current and applied homogeneously to all wave components however ocean currents are often vertically sheared to some extent in this case surface waves are not affected only by the current at the surface but rather by a depth weighted current eq 18 in kirby and chen 1989 short kd 1 and long e g swell kd 1 surface waves are affected differently the former mostly feel the surface current while the latter are also affected by below surface currents which are typically not as strong in some areas such as in the mouth of the columbia river the current variation with depth has been shown to be important for accurate surface wave predictions zippel and thomson 2017 in a sheltered fjord area location f where the highest impact of currents on waves is observed we found approximately 5 difference not shown between the surface and the depth weighted current based on the average modelled current profile of fig 9 for the dominant waves 0 2 0 3 hz since the effect of currents is weak at the exposed locations a more elaborate method to estimate the current forcing is not warranted therefore using the surface current is a reasonable approach over our entire study area the presence of currents influences the spectral bandwidth in sheltered inner fjord locations by including current forcing the spectral bandwidth is increased broader spectrum by up to 5 at the majority of the inner locations this is consistent with a reduced wind input because of a lower relative wind speed a wave field in a later stage of the development and energy stretching due to the following current similarly the directional spreading is also affected by the presence of currents with the maximum differences being observed during the highest surface currents in sulafjorden a fjord exposed to the open ocean the opposing currents to long incoming waves e g swell result in energy bunching and a decrease of σ θ while the following currents within the inner fjords lead to energy stretching and increase of σ θ in sulafjorden location c is the one most sheltered from incoming long waves both model simulations show a strong overestimation of the overall wave energy by including current forcing we observed a slight degradation for low frequency waves m 1 during the highest 5 cases this can be explained by the presence of opposing currents to incoming long waves the swell which dominates the wave climate of the open ocean see semedo et al 2014 that leads to energy bunching and consequently to overestimation of the low frequency wave energy christakos et al 2020 showed that increasing the spatial grid resolution improves the results in partly sheltered locations such as c we thus believe that a finer grid 250 m may improve the model performance during long wave propagation at c as presented by christakos et al 2021 the highest nbi at location f for the different source term packages tested is found for low to moderate dimensionless width our results indicate that including current forcing improves the results slightly reducing the nbi for low to moderate dimensionless width however the improvement is limited and other factors such as the quality of wind forcing and white capping wind input formulations may also play a role the horizontal resolution of norkyst800 is considered quite good and in general the model topography is capable of capturing the main current features and providing reliable estimates of the surface current field in the fjord system however even higher resolution is the most obvious way to improve topographically induced currents in narrow fjords our results demonstrate that there is a clear need for more knowledge of wave current interactions and a more realistic description of the surface waves in nearshore areas in this context it is necessary to further develop our advanced numerical prediction systems via a fully coupled ocean wave atmosphere system taking into account the ocean and atmosphere as a unified system finally the presented results can be useful to other fjord systems with similar characteristics i e narrow and deep topography strong stratification and weak bathymetry effects which are typical for most of the fjords around the world e g norway the faroe islands iceland greenland new zealand and chile in addition our results might offer some transferable insights to larger narrow enclosed or semi enclosed water bodies such as the gulf of finland or lake ontario where oceanic swell is absent in larger basins however the surface current can be more complex westerlund et al 2019 and a possible wind wave misalignment caused by slanting fetch donelan et al 1985 pettersson et al 2010 might weaken the effects of the currents our results are not expected to carry over to exposed shallow shorelines where bathymetry plays a key role 5 summary and conclusions wave modelling in complex fjord systems has not received much attention earlier due to lack of observations and the need for very high resolution atmosphere wave and ocean models we have investigated the performance of the saturation based white capping parameterization in the swan model in the presence of currents including current forcing in wave model integration improved the wave field in most locations investigated all locations show improved results of the wind sea part of the spectrum at inner sheltered fjord locations the inclusion of surface currents shows the largest improvement on the wave height estimates with improvements exceeding 10 percentage points in these locations the change in the dominant waves group velocity is of the order of 20 due to currents whereas in outer more exposed locations the change is only a third of that furthermore current forcing based on 2 of modelled wind shows improved results at inner locations and can be used potentially for some cases where the actual current simulations are not available a strong change in wave frequency σ p up to 10 15 at most of the inner fjord locations is also observed when current forcing is included the deep water source terms are affected by the presence of currents in the same order of magnitude a consequence of not applying ocean forcing on fjord wave modelling can be an over calibration of the wave model finally the results indicate that the improvement in model performance is worth the added complexity of using the offline coupled model system for producing operational coastal and fjord wave simulations credit authorship contribution statement konstantinos christakos conceptualization visualization methodology software formal analysis investigation data curation writing original draft writing review editing jan victor björkqvist methodology investigation writing review editing øyvind breivik supervision writing review editing laura tuomi supervision writing review editing birgitte r furevik supervision writing review editing project administration jon albretsen writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we would like to thank the reviewers for their constructive comments that helped in improving the study furthermore we would like to thank victor alari tallinn university of technology for fruitful discussions during the conceptualization of this article the norwegian public roads administration funded the study under the coastal highway route e39 project we are grateful to øyvind byrkjedal kjeller vindteknikk as who provided the wind forcing data wind and wave measurements were available via the thredds service at the norwegian meteorological institute https thredds met no the bathymetry data was provided by emodnet bathymetry consortium 2018 
23870,this study investigates the effect of surface currents on wind generated waves in a complex coastal system with narrow fjords the simulations are based on a phase averaged wave model forced with surface currents from a high resolution coastal ocean and fjord circulation model and high resolution winds from a nested atmospheric model wave simulations with and without ocean forcing are evaluated by comparing integrated wave parameters and modelled spectra with observations from five wave buoys the comparison covers three winter seasons 2017 2020 and a case study the wind sea part of the spectrum is better simulated at all locations when using the current forcing at the most sheltered location where wind sea dominated the wave climate the wave height estimates improved by 12 percentage points when including current forcing spectral moments and the shape of the average spectra are also improved at most of the locations when current forcing is applied the effect of wave current interactions was found to be more pronounced at inner locations where the relative difference of spectral bandwidth is up 5 the difference in directional spreading is greater than 5 degrees during strong surface currents and the relative difference in peak frequency is exceeding 10 our results are consequential for narrow deep and sheltered water bodies but are not expected to carry over to shallow water areas keywords wind waves current fjord swan roms wrf 1 introduction predicting wave growth is essential for a range of oceanic and coastal applications such as maritime transport fish farming and ocean engineering nonetheless the quality of wave predictions is highly affected by both atmospheric and ocean forcing while the former generates wind waves the latter modulates the existing wave field the relative wind speed acting on the sea surface is modified by surface current which in turn affects the wave growth according to ardhuin et al 2012 the relative wind effect can explain about 20 40 of the modulation in wave height induced by strong currents off the west coast of france surface currents also change the absolute wave frequency f through the doppler shift spatial variation of surface currents modifies the relative wave frequency σ 2 π f k u c where k and u c are the wavenumber and surface current vectors and causes wave refraction and energy bunching stretching opposing currents can be associated with the occurrence of extreme wave heights i e rogue waves onorato et al 2011 toffoli et al 2015 regions with strong wave current interactions can enhance wave breaking melville et al 2005 romero et al 2017 romero et al 2017 found large modulations of the wave height up to 30 due to wave current interactions at the edge of an upwelling jet off the coast of northern california and the loop current in the gulf of mexico their results showed large variations in wave breaking parameters such as significant slope whitecap coverage and directional spreading with the two last ones being inversely correlated it is well known that large scale wind driven currents such as the gulf stream mapp et al 1985 the kuroshio hwang 2005 and the agulhas current irvine and tilley 1988 affect surface waves in the open ocean significantly ardhuin et al 2017 found that also smaller scale currents 10 100 km significantly affect ocean waves marechal and ardhuin 2021 concluded that incident waves with small directional spreading swell experience stronger wave height gradients in the agulhas region romero et al 2020 found that during low winds the significant wave height in the santa barbara channel can increase by up to 50 80 in specific areas due to current induced refraction however to our knowledge the impact of currents on wind generated waves in much narrower channels e g fjords has not been explored this study aims to quantify the impact of ocean currents on surface waves in fjords fjords are typically long narrow and deep inlets of water the water masses in fjords are often strongly stratified containing three distinguishable water masses i surface brackish water ii intermediate water and iii basin deep water e g saetre 2007 the surface layer often receives freshwater from rivers but this is mixed with the more saline water flowing into the fjord from coastal and offshore regions creating a brackish surface layer the intermediate layer is located between the surface layer and the deep water where the latter is typically bounded by the depth of the sill the circulation in the intermediate layer is dominated by horizontal pressure gradients between coastal and fjord waters with longer time scales than upper layer dynamics tides affect the fjord dynamics at all levels the depth of the surface layer is about 1 10 m depending on the river runoff s strength seasonal variation and the amount of wind driven mixing the circulation in the surface layer is also strongly affected by winds and waves the wave climate is mainly determined by the dominant wind direction and strength the typical duration of low pressure systems and the geometry of the fjord system fetch and width of fjords as many norwegian fjords are long with steep mountainsides they are often exposed to intensified and topographically steered winds the norwegian coastal current flows northwards along the norwegian coast saetre 2007 the current transports low salinity water from the baltic sea and the norwegian rivers to the barents sea it is primarily driven by density gradients garvine 1995 and by the dominant southwesterly winds skagseth et al 2011 and references herein in complex nearshore areas such as the norwegian coast with thousands of islands and narrow channels providing accurate wave forecasts is challenging two norwegian organizations have developed and provide open access operational wave forecasts along the norwegian coast i the norwegian meteorological institute which provides coastal wave forecasts based on the wam model the wamdi group 1988 with 800 m spatial resolution and ii the norwegian coastal administration in cooperation with norce as and barentswatch who have developed a coastal wave forecast system for fairways based on stwave massey et al 2011 with 100 m spatial resolution furevik 2017 none of these operational forecast systems accounts for the impact of surface currents on the waves in the coastal zone and in fjords the imprint of currents on ocean waves in fjord areas has not been quantified mainly due to a lack of appropriate high resolution ocean forcing and observations in these areas remote sensing techniques such as satellites are not reliable due to the land proximity and the observations are mainly limited to point measurements such as wave buoys in 2016 the norwegian public roads administration npra launched one of the largest measurement campaigns of wind wave and current conditions along the norwegian coast the norwegian authorities aim to upgrade the coastal highway route potentially replacing ferries on several fjord crossings with bridges and tunnels the measurement campaigns in the fjords provide the essential data for the design of these large state of the art road projects but also function as advanced met ocean studies in areas where they previously were not possible this study has the overall goal of taking advantage of these unique measurements to improve our understanding of wave current interactions for designing coastal structures and aims at answering the following questions i how important are the ocean currents for the wave modulation in a fjord system ii which mechanisms affect the coastal and fjord waves and iii what is the order of importance of current effects on waves in different fjord locations conditions our study is focused on a deep more than 300 m deep in most places fjord system located on the west coast of norway fig 1 special attention is given to two areas i sulafjorden equipped with buoys a d is a fjord exposed to strong swell from the norwegian sea and ii the fjord cross section near buoy f as shown in fig 1 this paper is organized as follows section 2 presents an overview of the wave model and the wave current interaction theory and section 3 describes the results sections 4 and 5 discuss the results and present our conclusions 2 description of the modelling system the study area is illustrated in fig 1 also described in christakos et al 2020 buoys a b c and d breisundet are located in sulafjorden and buoy f is deployed at the junction between three fjords sulafjorden has an average width of 4 5 km and a length of about 10 km wind sea and swell conditions usually coexist in sulafjorden due to its exposure to the open sea however the inner parts of the fjord system e g location f are characterized by a wave climate with only local wind sea and little or no swell 2 1 the wave model the wave model swan simulating waves nearshore booij et al 1999 ris et al 1999 is a third generation spectral model developed mainly for coastal applications in this analysis the swan cycle iii version 41 20 is implemented for the fjord system the model determines the evolution of the wave action density n e σ e is the wave variance density dictated by the action balance equation 1 n t c x n x c y n y c σ n σ c θ n θ s t o t a l σ here c x and c y are the group velocity vector components in geographical x y space the c σ and c θ represent the propagation in frequency direction σ θ space the term s total is defined in eq 2 as the sum of the individual source terms where s in is energy input generation by wind s ds is the dissipation induced by white capping s nl4 is the nonlinear wave energy transfer due to four way wave quadruplet interactions s nl3 is the three way triad nonlinear interactions active in shallow to intermediate water s fric is the bottom friction and s brk is the depth induced wave breaking 2 s total s in s ds s nl4 s nl3 s fric s brk s nl3 can be ignored in deep water and is switched off 2 1 1 saturation based white capping and wind input we are using the saturation based white capping by alves and banner 2003 which is implemented in swan by van der westhuysen et al 2007 this white capping parameterization is more accurate than the swan default by komen et al 1984 in mixed swell wind sea conditions and was found to perform well in fjord areas in a previous study christakos et al 2021 this white capping function s ds has two parts a non breaking part given by komen et al 1984 and a breaking part s break which is defined as swan team 2017 3 s break σ θ c ds b k b r p 2 tanh k d 2 p 0 4 g k e σ θ here c ds 0 50 1 0 4 is the white capping dissipation parameter g is the acceleration due to gravity and d is the water depth the azimuthally integrated spectral saturation is given by b k e σ k 3 c g where c g is the wave group velocity if b k is under the threshold saturation level b r 1 75 1 0 3 there is no wave breaking but a background dissipation is obtained by p 0 if b k is greater than b r there is breaking and p p 0 p 0 a calibration exponent here p is given as a function of b k in order to obtain a smooth change between these two conditions alves and banner 2003 the wind input s in is a combination of the formulations by komen et al 1984 plant 1982 expressed by yan 1987 4 s in σ θ c 1 u c 2 c 2 u c c 3 cos θ θ w c 4 σ e σ θ where c is the phase velocity θ w is the wind direction and c 1 4 are coefficients given by swan team 2017 the friction velocity u estimate is based on zijlema et al 2012 the package will hereafter be denoted westh 2 1 2 wave current interactions in the swan model the wave current interactions are mainly taken into account in the left side of eq 1 via the change in propagation velocities the propagation velocities in physical and spectral space under the effect of surface currents are given by 5 c x c y c g u c 6 c σ σ d d t u c d c g k u c s and 7 c θ 1 k σ d d m k u c m here s is a coordinate in the wave direction and m is perpendicular to s finally currents also affect the right hand side of eq 1 through the wind input term s in since the wind speed in a frame of reference moving with the currents experiences a relative wind vector difference between wind and surface current vectors 2 2 model set up and boundaries swan was run in non stationary mode with spherical coordinates a 10 minute time step 36 directions and 32 discrete frequencies logarithmically spaced from 0 04 to 1 hz the inner domain with grid resolution 250 m 250 m red rectangular box in fig 1 lower right panel is nested into the outer grid of 1 km 1 km more details in christakos et al 2020 2 2 1 the ocean forcing the ocean surface current forcing is provided by the norkyst800 ocean model system albretsen et al 2011 with a 1 hourly temporal resolution norkyst800 is a high resolution ocean modelling system that covers the whole of the norwegian coast the system predicts current salinity temperature and water level norkyst800 is based on the numerical ocean model roms regional ocean modelling system shchepetkin and mcwilliams 2005 haidvogel et al 2008 with a spatial horizontal resolution of 800 m and 35 vertical levels the surface currents are used to force the wave model and the uppermost vertical level corresponds to a depth 10 20 cm below surface the exact thickness depends on the total water depth as roms applies a terrain following vertical coordinate the main external forcing agents in norkyst800 come from a high resolution atmospheric model arome2 5 km a hydrological runoff model a global tidal model and a large scale ocean model asplin et al 2020 found good agreement between norkyst800 and current observations in coastal and fjord areas particularly in the upper 10 20 m 2 2 2 the wind forcing the atmospheric forcing used for the swan wave model runs is generated by wrf0 5 which is a dynamical downscaling of the era interim reanalysis dee et al 2011 using the advanced research wrf arw skamarock et al 2008 numerical weather prediction model version 3 5 0 more details about wrf0 5 are provided by christakos et al 2020 the wrf0 5 wind fields in the fjord system have a spatial and temporal resolution of 0 5 km and 1 h respectively 2 2 3 the offshore wave boundaries the nora10 hindcast provided the wave conditions at the grid boundaries of the outer swan model domain with 3 hourly temporal resolution information about the spectral nesting and interpolation can be found at breivik et al 2009 the nora10 s wave component is a 10 km 10 km wam model forced by hirlam winds nested inside a 50 km 50 km outer domain forced by era 40 winds reistad et al 2011 this outer domain covers a large part of the north atlantic which provides realistic simulations of low frequency wave e g swell propagation from the open sea to the norwegian coast the hindcast uses analysed fields from the european centre for medium range weather forecasts ecmwf as initial and boundary conditions and has been found to compare well with a similar downscaling of era interim haakenstad et al 2020 2 2 4 the wave simulations to assess the effect of the currents on wave dynamics we have performed two wave simulations the first is a control run with wind forcing hereafter swan and an alternative run with wind and current forcing swanc the wave simulation period includes three winters december january february from december 2017 to february 2020 in addition we performed wave simulations for a selected case with alternative current forcings equal to 2 of the wind forcing or 120 of the norkyst800 current speed these simulations are denoted swan2 w and swan120 c respectively 2 3 observations observations from wave buoys fig 1 are used to assess the performance of different model set ups the measurements include both integrated wave parameters and spectral wave data as well as wind and currents furevik et al 2020 the acoustic measurements of surface currents are obtained at 1 m below the sea surface for the evaluation of model wind speed the observed wind is adjusted to 10 m height u 10 using a logarithmic profile e g christakos et al 2020 2 4 statistical parameters the statistical characteristics of the sea surface can be expressed as spectral moments as follows 8 m n 0 σ n e σ d σ n 1 0 1 where m n is the n th order moment of e σ in this study we estimate the first positive m 1 and negative m 1 moment the former gives more weight to higher frequencies while the latter gives more weight to lower frequencies when we compare to observations these moments were determined by integrating up to the maximum frequency of the observations the significant wave height is estimated from the zeroth order moment as 9 h m 0 4 m 0 the spectral bandwidth longuet higgins 1975 is defined as 10 ν m 0 m 2 m 1 2 1 t m 01 t m 02 2 1 the directional spreading is estimated following kuik et al 1988 as 11 σ θ 2 1 sin θ e σ θ d σ d θ 2 cos θ e σ θ d σ d θ 2 e σ θ d σ d θ 2 the average relative difference rd of a variable χ e g h m 0 is defined as 12 rd χ δ χ χ swan where δ χ χ swan c χ swan is the difference of χ between swanc and swan the temporal mean of χ over the whole simulation period is denoted χ while the mean of the highest five percentiles q 0 95 denoted χ q 0 95 the dimensionless width of a fjord location is calculated as 13 x w g x w u 10 2 here x w is the width distance across the fetch for more details see christakos et al 2021 2 5 error metrics the error metrics used in the present study are the pearson correlation coefficient r which describes how model estimates y i and observations x i are linearly correlated where r 2 ranges between 0 no correlation and 1 perfect linear correlation 14 r i 1 n y i y x i x i 1 n y i y 2 i 1 n x i x 2 the bias is defined as the mean difference between y i and x i 15 bias y i x i the scatter index is defined as the standard deviation of the difference between y i and x i normalized by the mean of x i 16 si 1 n i 1 n y i x i y x 2 x finally the normalized difference bias of h m 0 is defined as 17 nbi h m 0 s w a n c h m 0 o b s h m 0 o b s here h m 0 s w a n c and h m 0 o b s are the modelled and observed significant wave height for the estimation of nbi only h m 0 s w a n c and h m 0 o b s values greater than 0 20 m are considered 3 results 3 1 model evaluation norkyst800 reproduces the dominant current direction well fig 1 with the largest deviations at locations c and f compared to observations the modelled surface current speeds are weaker at all locations the dominant wind direction is well represented but the modelled wind speed is too strong in most parts of the fjord system as illustrated in fig 1 modelled wind and current directions are closely aligned in locations a c and f in location d the current direction is both from east and west as the buoy is located in the centre of the straight where both inflows from the west and outflow from the east occur in the southern and northern part of breisundet respectively the dominant wind direction at d is from the southwest in locations a and b the main current and wind directions are from the south southeast at location c the dominant current and wind directions are from the southeast and south southwest respectively in the innermost location f the dominant directions of both current and wind are from the southeast at all fjord locations both wind and current directions are determined by the axis of the fjord the observed and modelled dominant wave directions agree at all locations not shown at location d a b and c sulafjorden the main wave direction is from the open ocean aligned with the fjord axis northwest fig 1 this indicates i the dominant role of the open sea waves penetrating into sulafjorden and ii the importance of fjord geometry in controlling the wave direction at location f the dominant wave direction is from the southeast also aligned with the fjord axis as seen in fig 2 both swan and swanc show similar overall performance 0 5 percentage points difference at locations exposed or partially exposed to the open sea d a b and c the simulation with current forcing swanc shows an overall better performance in terms of wave height both runs perform best r 0 87 bias 0 16 and si 0 32 at the most exposed locations i e d a and b in locations c both model runs overestimate significantly 60 70 the wave height at the same location swanc shows a slightly improved r and bias and a lower by 5 percentage points overestimation of observed wave heights compared to swan the highest difference between the model simulations is detected at location f where the simulations with surface currents swanc improve the wave estimates by 12 percentage points compared to swan in addition swanc shows a reduction in si from 0 68 to 0 63 bias from 0 13 to 0 11 but also a small decrease in r from 0 81 to 0 80 the average spectrum and the average spectral moments m 1 and m 1 of the overall and the highest quantiles q 0 95 for swan swanc and observations are shown in fig 3 both model runs perform similarly for exposed locations d not shown a and b with swanc providing slightly better estimates for the spectral moments m 1 and m 1 regarding the highest 5 the wind sea part of the spectrum in a and b improves slightly when current forcing is included the average spectrum in location c shows that both simulations have a near identical shape while the simulated energy of the dominant waves around the peak and the spectral moments overestimate ca 2 3 times the observations regarding the highest quantiles q 0 95 at c swanc shows i slightly higher energy of the lowest frequency peak e g swell and ii lower energy of the wind sea part with the peak frequency being shifted to higher frequencies than swan when the wave simulations are compared to observations the high frequency density peak is estimated more accurately by swanc while the low frequency density peak is overestimated by ca 2 times in both simulations with swanc in the most sheltered location f where swell is nearly absent and wind sea dominates the wave climate we observe the highest reduction by ca 20 in q 0 95 of the dominant energy when current forcing is present swanc fitting best the observed spectra swanc also provides the best performance in terms of spectral moments for both the overall average and the highest quantiles 3 2 met ocean climatology winter season based on norkyst800 data from the winter seasons december 2017 february 2020 we visually identify two main patterns of surface currents fig 4 top i along the coastline and ii an outward from inner to outer fjord locations current with a local maximum at the inlet of sulafjorden and at narrow inner fjords e g close to location f both patterns have a similar magnitude with u c 0 2 0 3 m s 1 and u c q 0 95 0 5 0 7 m s 1 similarly the wind conditions are characterized by strong winds along the coast from the southwest and within the fjords with u 10 and u 10 q 0 95 up to 10 m s 1 and 24 m s 1 respectively fig 4 middle the wave climate fig 4 bottom is dominated by offshore waves from the west northwest in areas off the fjord system h m 0 and h m 0 q 0 95 up to 4 m s 1 and 8 m s 1 respectively wave conditions at inner fjord locations are dominated by the local wind sea with wave heights approximately 4 times lower compared to offshore waves 3 3 spatial current effects on fjord waves to identify the most affected areas by the ocean currents the average relative difference between swan and swanc for h m 0 σ p relative peak frequency ν spectral bandwidth and the average cos δ θ p θ p peak wave direction over the fjord system is illustrated in fig 5 the cos δ θ p describes the magnitude of wave refraction where 1 and 0 indicate no and 90 refraction respectively when current forcing is included swanc we observed i a reduction of wave height of up to 15 in the inner fjord locations while at the exposed locations the change is between 2 5 and 5 ii the relative frequency in the fjord locations generally increased when currents were accounted for with the change being up to 15 off the fjord system the use of currents had practically no effect on the relative frequency iii an increase up to 5 of the spectral bandwidth at inner fjord locations and iv weak refraction at inner fjord locations and nearly no refraction off the fjord system including the surface currents have no significant impact on the directional spread on average fig 6 left however the top 5 of the currents fig 6 right are strong enough to modify the spread of the wave field in the fjord system in the exposed areas where the strong outward currents meeting the incoming long and energetic waves swanc shows up to 6 degrees narrower directional width spread than swan at inner fjord locations where surface currents and waves are generally in the same direction δ σ θ is positive up to 6 degrees indicating that the current forcing induces wider directional spread 3 4 inner fjord location focusing on an inner fjord area such as location f where the highest differences between swan and swanc are detected we observe that for most of the time not shown surface currents follow the wave direction resulting in an overall decrease of wave height fig 7 reveals that swanc performs better lower nbi than swan for low to moderate dimensionless width x w where most of the data is observed as it is illustrated by christakos et al 2021 the highest nbi at f for different source term packages is observed for low to moderate dimensionless width 3 5 case wind sea and following currents at inner fjord location to further understand the wave current interactions at the most affected areas location f we perform a case study where strong winds and surface currents have approximately the same direction more specific on january 15 2018 strong winds 15 m s 1 from the southeast generated a high local wind sea christakos et al 2020 at the inner fjords location f figs 8 top right panels and 10 top left panel reveal strong surface currents aligned with the inner fjords axis at january 15 2018 9 utc time series of wind surface currents and integrated wave parameters at location f during the event are presented in fig 8 top both speed and direction of the surface current and wind are in good agreement with observations small differences are detected between swan2 w swanc norkyst800 and observations for both surface current velocity and direction the observed mean wave direction θ ranges from 130 to 150 not shown all simulations predict the wave direction well the modelled surface current direction θ c is in good agreement with observations because of a weak wave refraction induced by the currents the difference in wave direction between swan and swanc is below 10 the observed h m 0 reaches up to ca 1 m the simulations without current forcing strongly overestimated h m 0 but this overestimation is sharply reduced in the simulation forced with the wave following currents similar results are also detected in f p peak frequency furthermore the observed modelled current profile fig 9 indicates the existence of a stratified water column with two layers i an outward surface current and ii an inward current at ca 50 60 m depth the outward surface current is a wind driven current the sharp reduction of wave energy due to the following currents is illustrated in fig 8 bottom the energy of observed dominant waves is ca 50 lower compared to simulations without current forcing swan simulations also under predict the peak frequency including the current forcing improves the estimation of dominant wave energy and peak frequency the energy of the spectral tail above ca 0 35 hz is modelled similarly in all simulations being somewhat higher compared to the observations using the alternative current forcing swan2 w also provides a better estimation of dominant wave energy compared to swan reducing the peak density by 27 increasing the surface current of norkyst800 by 20 swan120 c we observe a reduction of energy of the dominant waves by ca 12 compared to swanc the spatial difference in h m 0 between simulations with and without current forcing and the modelled surface current are presented in fig 10 top on january 15 2018 at 09 utc the highest negative value up to 0 4 m is detected at the cross section of the fjords close to location f where u c 0 3 m s 1 no significant differences in the wave direction are detected between the two simulations in addition the current forcing reduces the relative peak wave period by up to 0 6 s for most of the fjord area near f not shown a snapshot of the deep water source terms s in s ds and s nl4 over the fjord cross section at location f at january 15 2018 at 09 utc is shown in fig 10 bottom the results indicate that the source terms are significantly affected by the presence of surface currents more specific the swanc shows reduced magnitudes by ca 30 in the deep water source terms for the dominant waves and ca 14 higher σ p compared to swan for shorter waves relative frequency greater than 0 25 hz both simulations show minor differences for s in and s ds 4 discussion swan without current forcing provides a good overall model performance in terms of h m 0 and average spectral characteristics in exposed locations where mixed wind sea swell conditions are observed with minor differences compared to swanc with the current forcing in addition accounting for currents have a positive effect on the accuracy of the local wind sea part of the spectrum in these locations the wave climate in the exposed areas to the open sea is dominated by strong swell or and old wind sea from west northwest fig 4 on the other hand the surface current and wind off the fjord system has a dominant direction from the southwest which is near perpendicular to wave direction leading to i a weak doppler shift since k u c 0 ii a weak change in σ due to no significant changes of current field along the same direction c g k u c s 0 iii a weak current induced refraction while there are no significant changes of current field across the wave crest k u c m 0 iv a weak modulation of the dominant waves due to no significant changes in group velocities because the surface current velocities are much lower than the typical swell group velocity for example a wave with a period of 14 s c g 11 m s 1 for deep water under the effect of surface currents of 0 7 m s 1 experiences ca 6 change of absolute group velocity as it was also concluded by christakos et al 2020 simulations with pure wave propagation without wind forcing showed quite similar overall results in the exposed fjord locations revealing the dominant role of boundary offshore waves therefore in the exposed locations the ocean forcing has a secondary role after the quality of boundary waves and wind forcing in contrast to exposed locations swan performs quite poorly at inner locations in these areas both the current section 3 and the wind forcing christakos et al 2020 are essential for more accurate wave estimates more specifically the surface currents and the wind generated waves are nearly aligned following leading to i a maximum doppler shift since k u c k u c 1 ii a change of σ due to changes of the current along the wave direction c g k u c s the following currents induce a negative c g k u c s leading to a reduction of σ eq 6 however energy stretching and a reduced relative wind by the following currents resulted in a higher σ p iii a weak current induced refraction due to some variation of current fields across the wave crest k u c m iv a strong modulation of the dominant waves due to significant changes on group velocities considering that the surface current velocities at inner fjord is about 0 5 m s 1 a typical wave period of young wind sea of 3 5 s with velocity equal to 2 7 m s 1 which corresponds to ca 18 5 increase of absolute group velocity v a ca 3 reduction of wind speed due to the relative wind effect considering a case with relative high wind speed u 10 of about 15 m s 1 and u c of ca 0 5 m s 1 the relative wind speed is about 3 lower than u 10 vi since the wind input eq 4 is a function of inverse wave age u c or u σ g for deep water changes in both σ and u should also be taken into account in case of a following current and a divergent current field the inverse wave age is decreased since both u relative wind effect and σ c g k u c s 0 in eq 6 are decreased the main problem at inner fjord locations is the overestimation of wave energy by the model adding the current forcing reduces the dominant wave energy s estimation by ca 50 when using the westh physics package fig 8 a reduction of similar magnitude is also seen with the other source terms packages not shown this 50 reduction is also in the same order magnitude as changing the source term package from st6 babanin et al 2010 to westh when not accounting for the currents christakos et al 2021 a common engineering approach to achieve more precise wave estimations is the calibration of the wave model for instance tuning the white capping coefficient c ds is widely used when under over prediction of wave energy is observed e g amarouche et al 2019 however at inner fjord locations ignoring the ocean forcing can lead to an over calibration of the wave model as a rule of thumb the surface current induced by wind is about a few percent of the wind e g 2 at open ocean e g fergestad et al 2019 for instance wind speed of 15 m s 1 should induce a fully developed wind driven current of 0 3 m s 1 our sensitivity study indicates that for location f where the currents are restricted by the narrow fjord geometry this simple practice used in swan2 w can outperform swan with no current forcing however swan2 w is not as accurate as swanc where the actual current forcing is used the ocean current in spectral waves models e g swan is usually taken as a surface or depth uniform current and applied homogeneously to all wave components however ocean currents are often vertically sheared to some extent in this case surface waves are not affected only by the current at the surface but rather by a depth weighted current eq 18 in kirby and chen 1989 short kd 1 and long e g swell kd 1 surface waves are affected differently the former mostly feel the surface current while the latter are also affected by below surface currents which are typically not as strong in some areas such as in the mouth of the columbia river the current variation with depth has been shown to be important for accurate surface wave predictions zippel and thomson 2017 in a sheltered fjord area location f where the highest impact of currents on waves is observed we found approximately 5 difference not shown between the surface and the depth weighted current based on the average modelled current profile of fig 9 for the dominant waves 0 2 0 3 hz since the effect of currents is weak at the exposed locations a more elaborate method to estimate the current forcing is not warranted therefore using the surface current is a reasonable approach over our entire study area the presence of currents influences the spectral bandwidth in sheltered inner fjord locations by including current forcing the spectral bandwidth is increased broader spectrum by up to 5 at the majority of the inner locations this is consistent with a reduced wind input because of a lower relative wind speed a wave field in a later stage of the development and energy stretching due to the following current similarly the directional spreading is also affected by the presence of currents with the maximum differences being observed during the highest surface currents in sulafjorden a fjord exposed to the open ocean the opposing currents to long incoming waves e g swell result in energy bunching and a decrease of σ θ while the following currents within the inner fjords lead to energy stretching and increase of σ θ in sulafjorden location c is the one most sheltered from incoming long waves both model simulations show a strong overestimation of the overall wave energy by including current forcing we observed a slight degradation for low frequency waves m 1 during the highest 5 cases this can be explained by the presence of opposing currents to incoming long waves the swell which dominates the wave climate of the open ocean see semedo et al 2014 that leads to energy bunching and consequently to overestimation of the low frequency wave energy christakos et al 2020 showed that increasing the spatial grid resolution improves the results in partly sheltered locations such as c we thus believe that a finer grid 250 m may improve the model performance during long wave propagation at c as presented by christakos et al 2021 the highest nbi at location f for the different source term packages tested is found for low to moderate dimensionless width our results indicate that including current forcing improves the results slightly reducing the nbi for low to moderate dimensionless width however the improvement is limited and other factors such as the quality of wind forcing and white capping wind input formulations may also play a role the horizontal resolution of norkyst800 is considered quite good and in general the model topography is capable of capturing the main current features and providing reliable estimates of the surface current field in the fjord system however even higher resolution is the most obvious way to improve topographically induced currents in narrow fjords our results demonstrate that there is a clear need for more knowledge of wave current interactions and a more realistic description of the surface waves in nearshore areas in this context it is necessary to further develop our advanced numerical prediction systems via a fully coupled ocean wave atmosphere system taking into account the ocean and atmosphere as a unified system finally the presented results can be useful to other fjord systems with similar characteristics i e narrow and deep topography strong stratification and weak bathymetry effects which are typical for most of the fjords around the world e g norway the faroe islands iceland greenland new zealand and chile in addition our results might offer some transferable insights to larger narrow enclosed or semi enclosed water bodies such as the gulf of finland or lake ontario where oceanic swell is absent in larger basins however the surface current can be more complex westerlund et al 2019 and a possible wind wave misalignment caused by slanting fetch donelan et al 1985 pettersson et al 2010 might weaken the effects of the currents our results are not expected to carry over to exposed shallow shorelines where bathymetry plays a key role 5 summary and conclusions wave modelling in complex fjord systems has not received much attention earlier due to lack of observations and the need for very high resolution atmosphere wave and ocean models we have investigated the performance of the saturation based white capping parameterization in the swan model in the presence of currents including current forcing in wave model integration improved the wave field in most locations investigated all locations show improved results of the wind sea part of the spectrum at inner sheltered fjord locations the inclusion of surface currents shows the largest improvement on the wave height estimates with improvements exceeding 10 percentage points in these locations the change in the dominant waves group velocity is of the order of 20 due to currents whereas in outer more exposed locations the change is only a third of that furthermore current forcing based on 2 of modelled wind shows improved results at inner locations and can be used potentially for some cases where the actual current simulations are not available a strong change in wave frequency σ p up to 10 15 at most of the inner fjord locations is also observed when current forcing is included the deep water source terms are affected by the presence of currents in the same order of magnitude a consequence of not applying ocean forcing on fjord wave modelling can be an over calibration of the wave model finally the results indicate that the improvement in model performance is worth the added complexity of using the offline coupled model system for producing operational coastal and fjord wave simulations credit authorship contribution statement konstantinos christakos conceptualization visualization methodology software formal analysis investigation data curation writing original draft writing review editing jan victor björkqvist methodology investigation writing review editing øyvind breivik supervision writing review editing laura tuomi supervision writing review editing birgitte r furevik supervision writing review editing project administration jon albretsen writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we would like to thank the reviewers for their constructive comments that helped in improving the study furthermore we would like to thank victor alari tallinn university of technology for fruitful discussions during the conceptualization of this article the norwegian public roads administration funded the study under the coastal highway route e39 project we are grateful to øyvind byrkjedal kjeller vindteknikk as who provided the wind forcing data wind and wave measurements were available via the thredds service at the norwegian meteorological institute https thredds met no the bathymetry data was provided by emodnet bathymetry consortium 2018 
23871,the development of a computationally efficient scheme for predicting the global distribution of total water level twl is discussed the ocean model is barotropic has a horizontal grid spacing of 1 12 and is based on the nemo modeling framework it is forced by the gravitational potential and hourly atmospheric fields for 2008 hourly time spacing was required to resolve the s 2 tide in global air pressure and wind the predicted tide in water deeper than 400 m was nudged to tpxo8 observations of tidal elevation or current using a scheme called tidal nudging kodaira et al 2019 the benefit of nudging horizontal velocity in the momentum equation compared to sea level in the continuity equation is discussed tidal nudging is shown to improve tidal predictions of sea level at the coast particularly at the s 2 tidal frequency the predicted radiational s 2 tide in sea level forced solely by the s 2 tide in global air pressure reaches amplitudes exceeding 80 cm decreasing the time spacing of the air pressure forcing from 1 h to 3 h reduces the s 2 amplitude in air pressure by a factor of 0 82 consistent with expectations based on fourier analysis this highlights the importance of using hourly atmospheric forcing when predicting the global sea level response to atmospheric forcing the radiational s 2 tide in sea level is subject to strong nonlinear interaction with the gravitational tide leading to a pronounced attenuation of the radiational s 2 tide the attenuation is explained by an increase in effective bottom friction at the s 2 frequency due to the presence of the gravitational tide four schemes for predicting twl are evaluated to quantify the impact of tidal nudging and nonlinear interaction of tide and surge using twls observed by 304 coastal tide gauges we show it is necessary to include both tidal nudging and nonlinear interaction plans for the further development of an operational flood forecast system for the canadian coast based on the above model are discussed keywords storm surge total water level tidal nudging radiational and gravitational tide nemo 1 introduction coastal flooding poses a major threat to coastal communities worldwide and its adverse impacts are expected to increase over the next century e g ipcc 2014 hallegatte et al 2013 hinkel et al 2014 an effective response to imminent coastal flooding requires a model that can accurately predict total water level twl with lead times of hours to order ten days there is also a need for decadal scale projections of probability distributions of twl and thus flooding risk under plausible climate change scenarios both forecasting and projection applications require ensembles of runs and this increases the need for models that are computationally efficient one of the challenges in developing an accurate model of twl is that the prediction of tide and surge the dominant components of twl for many coastal regions is essentially a global problem furthermore tides and surges at the coast are also influenced by local variations in bathymetry through its effect on harbor and shelf scale resonances waveguides for coastal trapped waves and tide surge interaction this wide range of spatial scales makes the choice of the grid spacing for the model critical although improvements in purely hydrodynamic also referred to as forward global tidal models have been made through the inclusion of self attraction and loading and topographic internal wave drag e g kodaira et al 2016b further improvements are required to improve the parameterization of sub grid scale processes it is well known that the oceanic tide can be excited by the atmospheric tide forced by the thermal effect of radiation mostly at the solar diurnal s 1 and semidiurnal s 2 frequencies e g cartwright 1978 the atmospherically forced oceanic tides will henceforth be referred to as radiational tides munk and cartwright 1966 and denoted by rs1 and rs2 the amplitude of rs1 is relatively small 1 cm in contrast to the amplitude of rs2 which can be 5 10 cm cartwright 1978 similar to the gravitational s 2 tide rs2 is generated primarily over the tropical oceans and has a global response as a result rs2 will be missed in regional flood forecasting systems if it is not included through the open boundary conditions furthermore the atmospheric forcing for the ocean models must have sufficiently high temporal resolution in order to properly resolve rs2 dobslaw and thomas 2005 most operational and research flood forecasting systems are regional e g bernier and thompson 2015 flowerdew et al 2010 werner et al 2009 allen et al 2018 or global but with coarsely resolved 6 hour atmospheric forcing e g carrère and lyard 2003 verlaan et al 2015 the present global study is the first to examine the effect of rs2 on total water level forecasts using atmospheric forcing with a time spacing of one hour coastal flooding is a major concern for canadians on the east coast severe damage to coastal infrastructure and loss of life has been caused by flooding driven by hurricanes and strong winter storms e g bernier and thompson 2015 danard et al 2003 the most recent example is hurricane dorian it made landfall just west of halifax nova scotia in 2019 and generated a surge level of about 1 m at halifax and 1 6 m in northumberland strait resulting in extensive flooding and severe damage to seawalls houses and vessels on the west coast of canada communities are also vulnerable to storm surges in winter and there is growing concern about the possibility of increasing storm frequency danard et al 2003 in the present study we evaluate several schemes for forecasting twl for all of the canadian coastline in this study we will evaluate a global model that resolves important coastal wave guides e g west and east coasts of north america and the response to atmospheric s 2 forcing over the tropics global ocean general circulation models with the capacity of predicting twl have been developed e g schiller and fiedler 2007 müller et al 2010 arbic et al 2010 2012 these earlier studies focused on the effect of tides on ocean circulation or the joint simulation of barotropic and baroclinic tides rather than twl global models developed directly for twl forecasting include the global tide and surge model gtsm developed by verlaan et al 2015 and the adcirc storm tide model developed by pringle et al 2021 both models are barotropic and use unstructured spherical grids to provide a more detailed representation of coastal areas compared to the open ocean the gtsm was used by muis et al 2016 for a global reanalysis of extreme sea levels they only used the surge component of gtsm tides were generated using the data assimilative model known as fes2012 carrère et al 2012 due to the weak performance of gtsm in tidal prediction at that time muis et al 2016 the main goal of the present study is the development of a computationally efficient scheme for accurately predicting the global distribution of twl this leads us to two questions of practical and scientific interest the first question is how can we best predict tides using a model with limited spatial resolution a simple approach would be to directly nudge the modeled tides toward tidal observations e g han et al 2010 fu et al 2021 however this approach is not suitable for twl because the surge component of twl will be suppressed by the nudging in this study we use a modified form of spectral nudging thompson et al 2006 to target specific tidal frequency bands thereby reducing the suppression of the surges following kodaira et al 2019 we refer to this modified technique as tidal nudging the second question is what is the impact of neglecting tide surge interaction e g bernier and thompson 2007 davies and lawrence 1994 horsburgh and wilson 2007 and tide tide interaction on the prediction of twl by a global model forced by hourly air pressure and wind stress the present study uses a 1 12 global barotropic model based on the nucleus for european modeling of the ocean nemo framework madec 2008 the m 2 tide kodaira et al 2016b and surge kodaira et al 2016a components of this model have been separately validated and shown to be in reasonable agreement with global observations of the m 2 tide and surges the model is further modified in the present study by including tidal nudging and extending the southern limit of model grid to allow tidal propagation under ice shelves the evaluation is carried out using hourly observations of twl from a global array of 304 tide gauges for 2008 this year has the most surges exceeding 1 m in the global array of tide gauges since 2000 the structure of the paper is as follows the observations of coastal twl and tidal elevations and currents from the deep ocean are described in section 2 the ocean model and its atmospheric forcing are described in section 3 the tide surge and twl predictions are evaluated in section 4 the nonlinear interaction of rs2 with the gravitational tide is also examined the results are summarized and discussed in the final section 2 observations for model evaluation tidal elevations and currents from a data assimilative model based on egbert and erofeeva 2002 are used for tidal nudging and model evaluation tidal amplitudes and phases for eight tidal constituents m 2 s 2 n 2 k 2 o 1 k 1 p 1 and q 1 were obtained from oregon state university on a global grid with a spacing of 1 30 these data will henceforth be referred to as tpxo8 given the good agreement between tpxo8 and amplitudes and phases calculated from independent observations stammer et al 2014 tpxo8 will henceforth be treated as observations hourly twls observed by a global array of tide gauges were obtained from the university of hawaii sea level centre uhslc caldwell et al 2015 all available data of research quality were downloaded for 2008 stations were excluded if any of the following criteria were met 1 the proportion of missing observations exceeds 90 2 the station is more than 25 km from the nearest ocean model grid point 3 the station is shielded from the open ocean by barrier islands or located far inland on a river 4 the station is on an island too small to be resolved by the model applying the four selection criteria resulted in a global distribution of 304 stations appendix a the global distribution of the 304 tide gauge stations is uneven and this causes difficulty when attempting to plot the global distribution of point statistics such as root mean square error rmse for this reason the 304 stations were reordered taking into account the tendency of extended coastlines to act as wave guides for coastal trapped waves the reordered station codes are listed in appendix a and their locations grouped by 8 subregions are plotted in fig a 1 several of the figures in this study show point statistics such as rmse as a function of station number grouped by subregion 3 the ocean model 3 1 governing equations the model is based on the following depth averaged barotropic momentum equation 1 u t u u f u g 1 α s η η a a 2 u τ s τ b ρ h 1 ρ p a c i w u λ x u o b s u and continuity equation 2 η t h u 0 where u u v is the depth averaged horizontal velocity f is the coriolis parameter multiplied by the upward pointing unit vector η is the sea surface height η a is the gravitational tidal potential a is the horizontal viscosity τ s and τ b are the surface and bottom stress h is total water depth and p a is atmospheric pressure at sea level the coefficients α s and c i w parameterize self attraction and loading and topographic internal wave drag respectively we use the water depth dependent factor α s derived empirically by stepanov and hughes 2004 the coefficient c i w is calculated following the formulation of jayne and st laurent 2001 its global distribution is given by kodaira et al 2016b the last term on the right side of 1 denotes the nudging of the model s current u toward the observed current u o b s given by tpxo8 the angle brackets represent temporal filtering of the nudging term to isolate variability in selected tidal frequency bands kodaira et al 2019 λ x determines the spatially varying strength of the nudging at horizontal position x to allow surges and nonlinear processes that cause tide surge and tide tide interaction e g davies and lawrence 1994 le provost 1991 to evolve freely on the shelf λ was set to zero in water shallower than 400 m in deeper water λ x increased with water depth to a maximum value of 0 05 δ where δ is the baroclinic time step discussed below the global distribution of λ x is shown in fig 1 spatial smoothing ensured a gradual transition of λ x from deep to shallow water the tidal nudging methodology is further discussed in appendix b it is shown that tidal nudging of currents in the momentum equation is preferable to adding a sea level nudging term of the form λ η o b s η to the right side of the continuity equation 2 the governing equations are solved numerically using the nemo modeling framework madec 2008 the model grid is the extended version of a tri polar orca grid referred to as eorca12 it has a nominal resolution of 1 12 at the equator compared to the original version of orca12 the eorca12 grid has been extended southward from 77 s to 85 s in order to allow tidal propagation under antarctic ice shelves such propagation is required for accurate tide predictions throughout the southern ocean and potentially the tropics de kleermaeker et al 2017 sensitivity studies appendix c show that a grid spacing of 1 4 is too coarse to predict tides and surges increasing the resolution to 1 12 gives acceptable tide and surge predictions on a global scale further increasing the resolution to 1 36 yields as expected local improvements in areas with bathymetric features poorly resolved by 1 12 grid however these improvements come at an approximately 16 fold increase in run time given the present interest in extended range ensemble forecasts of twl and decadal scale projections of flooding risk computational efficiency is a major consideration and the rest of the study will focus on results from the 1 12 model the bathymetry is derived from gebco 2014 weatherall et al 2015 the minimum and maximum water depths are set at 10 m and 6000 m over ice cavities in the antarctic ice thickness has been removed and only the water column thickness has been used as the bathymetry data the ice thickness is derived from the bedmap products fretwell et al 2013 and does not change with time in addition the bathymetry in hudson bay and on the labrador and newfoundland shelf was adjusted based on bathymetric data kindly provided by f lyard personal communication this modification was necessary in order to obtain accurate tide predictions for these regions and the adjacent north atlantic the model is 2d barotropic with one single vertical layer representing the water column the model is run with a baroclinic time step of 180 s and a mode splitting procedure is employed to solve the barotropic equations using a time step of 6 s for computational efficiency all unnecessary calls to subroutines related to vertical processes and tracers were removed tidal nudging was applied at every baroclinic time step the quadratic bottom friction was parameterized using a constant drag coefficient of 2 5 1 0 3 to account for the effect of ice cover in the ross and weddell seas atmospheric forcing was turned off over ice cavities and the bottom drag coefficient was doubled to take into account the top friction 3 2 atmospheric forcing gridded fields of atmospheric forcing were obtained from the global deterministic reforecast system gdrs gasset et al 2021 developed by environment and climate change canada eccc the gdrs configurations are closely related to the control member of the operational global ensemble prediction system geps lin et al 2016 at eccc the gdrs is used to produce hourly forecast with a grid spacing of approximately 39 km following bernier and thompson 2007 the magnitude of the wind stress is calculated using c d w w 2 where w is the wind speed and c d is a drag coefficient that equals 1 2 1 0 3 for wind speeds below 8 m s 1 increasing linearly with w for higher wind speeds with a slope of 0 065 1 0 3 for every 1 m s 1 increase in w this drag coefficient formulation is currently used by the regional surge forecast system run operationally by eccc the gdrs runs are renewed every 12 h and the forecast continues for 24 h for each run forecast hours 0 to 5 are discarded to avoid adjustments that result from initialization based on the era interim reanalysis of dee et al 2011 to concatenate the time sequence of gdrs reforecast fields of wind and air pressure temporal blending is applied to forecast hours 6 through 10 as follows 3 b t i β t i a o t i 1 β t i a n t i 6 t i 10 where b t i is the blended forecast for hour t i a o t i and a n t i denote the old and new forecasts at the same time and β t i is the blending coefficient defined by β 6 0 50 β 7 0 35 β 8 0 25 β 9 0 15 β 10 0 05 the forecasts and the blending are performed every 12 h the same blending procedure was used by bernier and thompson 2015 and kodaira et al 2016a the atmospheric forcing has a significant s 2 tide fig 2 the s 2 tide in the gdrs hourly air pressures is strongest in the tropics where it reaches a maximum amplitude of 1 24 hpa in the eastern pacific consistent with observations see figure 8 of dai and wang 1999 this well known semi diurnal variation is due to the thermal effect of solar radiation e g lindzen and chapman 1969 the s 2 tide in the hourly gdrs winds is relatively small near the equator and increases poleward reaching speeds of 0 2 m s 1 in the momentum equation 1 the direct contributions of air pressure and wind are expressed by the terms ρ 1 p a and ρ 1 τ s h respectively following ray and egbert 2004 the scaling of these two terms shows that locally the pressure term is at least two orders of magnitude larger than the wind stress term this suggests that air pressure loading is the primary mechanism for exciting the s 2 tide in the ocean 4 results seven model runs are described and compared in this section each model run starts on november 8 2007 and finishes on december 31 2008 the output was stored hourly to allow for model spin up and also focus on the year 2008 the output for the last 54 days in 2007 was discarded we note that a spin up time of 30 40 days determined mainly by the spin up time of the tidal filter see appendix b should be sufficient for the present study this was confirmed by sensitivity studies using different spin up times to study the dynamical origin of the s 2 signal in the ocean least squares is used to decompose the time varying atmospheric forcing and ocean response at each grid point into a purely sinusoidal component with a period of 12 hours and a residual for sea level at a given grid point the decomposition takes the form 4 η t η t η t similar decompositions can be written for u t p a t and τ s t the first group of runs is subject only to gravitational forcing run t run tn run tn the second group run s run s is atmospherically forced and tidal nudging is set to zero run s is forced by p a t and τ s t the last group of runs run ts run tns allows for tide surge and tide tide interaction in the prediction of twl both with and without tidal nudging the seven runs are summarized in table 1 comparison of these runs both within and between groups allows us to address the following questions what is the impact of tidal nudging in the deep ocean on twl predicted at the coast which variable u or η should be nudged what is the impact of neglecting nonlinear tide surge and tide tide interaction on the prediction of twl to assess model performance at each tide gauge we calculate the root mean square error rmse from the difference of time series of observations and predictions for reference we also calculated the root mean square rms of observations for the same period for each tide gauge to facilitate the comparison with different scales we also use the γ 2 statistic of thompson and sheng 1997 5 γ 2 v a r o m v a r o where v a r denotes variance and o and m denote observation and model simulation respectively small values of γ 2 indicate good model performance if γ 2 1 the model simulations are worse than using the mean of the observations as a predictor 4 1 predicting the tides it was shown in appendix b that tidal nudging in deep water fig 1 improves predictions of m 2 tidal elevation at the coast in this subsection we extend the model evaluation to include the following tidal constituents m 2 s 2 n 2 k 2 o 1 k 1 p 1 and q 1 the harmonic analysis was performed using the t tide package of pawlowicz et al 2002 given a complete hourly record for all of 2008 the tidal package will select 68 tidal constituents given a six month record the tidal analysis will resolve all eight constituents included in the gravitational forcing of the ocean model for this reason we focused this evaluation on 289 out of the 304 tide gauges with at most 50 missing observations for 2008 for the tidal analysis of observed and predicted time series missing values in the observations were also treated as missing in the predictions to provide a global assessment of skill we use box plots fig 3 to present the three quartiles of the error metrics across all 289 stations for a given run and a given tidal constituent box plots of amplitude and phase errors are shown in fig 3a and b comparison of run t and run tn shows that tidal nudging effectively reduces all three quartiles of amplitude errors for m 2 s 2 n 2 and k 1 but increases the three quartiles for o 1 fig 3a the effect of tidal nudging on the amplitudes of k 2 p 1 and q 1 is insignificant the tidal nudging is however more consistent in correcting the phase errors by reducing the three quartiles for all eight constituents fig 3b box plots of rmse and γ 2 taking into account both amplitude and phase errors are further shown in fig 3c and d the tidal nudging reduces the three quartiles of both error metrics for all constituents except for o 1 where the overall effect of tidal nudging is relatively neutral the reductions are largest for the semi diurnal constituents and most dramatic for s 2 where the second quartile for example is reduced by 54 for rmse and 87 for γ 2 one reason for this large drop is that run tn includes the radiational s 2 tide through the nudging to tpxo8 which includes rs2 because it assimilates altimetry data given the twl observations include this rs2 signal nudging to tpxo8 favors run tn over run t at the s 2 tidal frequency individual values of rms rmse and γ 2 for the 289 tide gauges are shown in fig 4 all eight tidal constituents were used to reconstruct the tides the rmse for run tn is mapped in fig 4a and the difference in rmse for run t and run tn is mapped in fig 4b rms rmse and γ 2 are plotted as a function of station code in fig 4c and d the ordering and grouping of the stations is described in appendix a it is encouraging to note that tidal nudging reduces the rmse at 82 of the stations fig 4b and c show relatively large improvements to the northwest of australia 0 21 0 54 m station codes 194 196 and in the gulf of maine 0 15 0 28 m station codes 99 101 where the tidal range is large degradation of skill occurs at 18 of the stations but we note that the degradation is typically less than 0 05 m fig 4d further shows that tidal nudging effectively reduces γ 2 values at most stations regardless of the tidal range γ 2 1 for run tn occurs at 97 of the stations indicating the model has skill large γ 2 values greater than 2 are seen at stations in the baltic sea station codes 111 114 due mainly to the fact that observed tidal signals are very weak there rms 6 cm γ 2 slightly greater than unity is also found for woods hole station code 98 the west coast of florida station codes 83 84 and the eastern side of the strait of malacca station codes 158 160 we speculate that the poor performance of run tn at these stations could be improved by increasing model resolution the performance of the nudged run is comparable to the altimeter constrained fes2012 tidal model muis et al 2016 obtained an arithmetic mean of rmse of 0 15 m based on a multidecadal run of fes2012 the arithmetic mean of rmse for run tn in this study is 0 10 m but it is important to note that the tide gauges and the analysis period used in the present study differ from those of muis et al 2016 4 2 predicting the surges we now examine the response of the ocean to atmospheric forcing both gravitational forcing and tidal nudging are set to zero the initial focus is on the response to p a t i e forcing by air pressure at the s 2 tidal frequency this is followed by an examination of the ocean response to the full atmospheric forcing p a t and τ s t see eq 4 for the decomposition of forcing and response into a component proportional to s 2 and a residual 4 2 1 sea level response to p a and need for hourly forcing the global response of sea level at the s 2 tidal frequency to forcing by the s 2 tide in the hourly air pressure figs 5a or 2 is shown in fig 5b the maximum amplitude 88 cm is found in the bristol channel and the second largest 71 cm in the bay of fundy these values are much larger than the amplitudes predicted by the inverse barometer effect which are everywhere less than 2 cm fig 5a the spatial pattern of the amplitude is similar to that of the gravitational s 2 tide arbic 2005 and both can be explained in terms of excitation of oceanic normal modes by forcing at the s 2 frequency platzman et al 1981 arbic 2005 dobslaw and thomas 2005 compared the response of the global ocean to p a using air pressure forcing calculated from analysis fields defined every 6 h and forecast fields defined every 3 h linear interpolation was used to map the pressure fields to the time step of the ocean model dobslaw and thomas 2005 found a large difference in the ocean response on switching from 3 h to 6 h forcing the main reason is 6 h forcing can only resolve a standing wave in contrast to 3 h forcing which can capture propagation building on the study of dobslaw and thomas 2005 we repeated our calculation of the ocean response to p a with one change we subsampled the hourly gdrs pressure fields to 3 h and then linearly interpolated back to hourly values the results are shown in fig 5c and d the amplitude of p a fig 5c and a for 3 h sampling is similar to the amplitude pattern for 1 h sampling apart from a reduction by a factor of about 0 82 this factor was obtained by regression of the 3 h amplitudes on the 1 h amplitudes the reduction can be explained by considering a sinusoid with a period of 12 h defined in discrete time with a sampling interval of 1 h if the sinusoid is subsampled every 3 h and then linearly interpolated back to hourly values the amplitude of the fourier coefficient at a period of 12 h is reduced by 0 829 for completeness fig 5e and f show the effect of subsampling the hourly p a forcing every 6 h it differs greatly from the response to 1 h and 3 h forcing for the reasons given by dobslaw and thomas 2005 the amplitude of the sea level response to 1 h and 3 h pressure forcing fig 5b and d are as expected quite similar the sea level response to 3 h forcing is reduced by a factor of about 0 75 again based on regression of the 3 h amplitudes on the 1 h amplitudes the reason for the deviation from the theoretical value of 0 829 is presumably due to the effect of model nonlinearities on the ocean response the maximum amplitude is still found in the bristol channel but the value is reduced from 88 cm to 73 cm for completeness we also include the ocean response to 6 h forcing fig 5f 4 2 2 sea level response to hourly forcing by p a τ s and p a τ s we now examine the response to forcing by hourly variations in air pressure and wind stress gravitational forcing and tidal nudging are both set to zero the full tidal signal including s 2 was removed from the 304 observed twl records using the t tide package of pawlowicz et al 2002 the residuals from this tidal analysis are used for model evaluation for the evaluation of the surge predictions we follow kodaira et al 2016a and apply a high pass butterworth filter to the observed residual and predicted sea level time series to suppress variability with periods t p 20 days this was done to exclude low frequency baroclinic variability that cannot be predicted by the barotropic ocean model we first examine run s which is forced by air pressure and wind stress with the s 2 component removed p a τ s to quantify fit we initially focus on γ 2 fig 6d which takes into account both rmse and rms of observations reasonable model skill is found for 161 stations outside the tropics where the three quartiles of γ 2 are 0 24 0 34 and 0 47 tropical stations are defined as stations located between 23 4 north and 23 4 south see table a 1 for latitudes of all stations the model skill for the 143 tropical stations is relatively low with γ 2 close to unity for most stations fig 6d the three quartiles of γ 2 are 0 83 0 98 and 1 11 this is not surprising because surges are small at most tropical island locations fig 6c and model resolution is also an issue we also speculate that higher resolution atmospheric forcing is required to better capture the effect of tropical cyclones at these stations we now focus on run s which is forced by the unmodified atmospheric forcing p a τ s the change in rmse at each tide gauge is mapped in fig 6b the run s predictions includes rs2 and so it is not surprising that rmse increases on replacing p a τ s by p a τ s the largest increases occur in regions with large rs2 fig 5b these regions include the gulf of alaska northwest european shelf strait of malacca northwest coast of australia and new zealand the difference in surge response predicted by run s and run s is illustrated in fig 7 for three tide gauges at cuxhaven on the northwest european shelf the amplitude of the s 2 signal in the run s predictions reaches amplitudes of 0 5 m at nearby brest and taranaki new zealand the amplitudes reach 0 2 m taylor diagrams taylor 2001 for run s and run s are shown in fig 8 we have modified the taylor diagram by adding a line green semi circle in fig 8 that shows for positive correlation the minimum rmse that could be achieved by optimally scaling the predictions i e sliding a point radially to the point of minimum rmse these diagrams confirm that removing the s 2 tide from the atmospheric forcing leads to more accurate surge predictions particularly outside the tropics they also highlight the danger of running a global surge prediction model with uncorrected hourly atmospheric forcing run s 4 2 3 damping of the radiational s 2 tide by the gravitational tide the s 2 amplitudes of sea level calculated using hourly forcing fig 5b agree qualitatively with results from previous studies e g fig 1b of arbic 2005 fig 2 of dobslaw and thomas 2005 fig 5b of williams et al 2018 our amplitudes are however generally larger the discrepancy is explained by the nonlinear interaction of the s 2 radiational and gravitational tide fig 5 is based on atmospheric forcing only in contrast to the results shown in the above mentioned studies which arise from differences in coupled tide surge runs and tide only runs fig 9a and b show the amplitude of s 2 tidal elevation derived from the surge only run run s and the differences between the coupled tide surge run and tide only runs run ts run t the difference in the s 2 amplitude maps fig 9c shows clearly that nonlinear interaction reduces the s 2 amplitudes from the surge only run by order 10 cm in some regions e g southern north sea the patagonia shelf and the ross sea we note however that larger reductions can be found e g up to 80 cm in the bristol channel 53 cm on the patagonia shelf and 28 cm in the strait of malacca it is well known that the quadratic bottom friction term in 1 is an important cause of tide surge and tide tide interaction it is also well known that if a time varying current u t is a linear combination of tidal components then the contribution of u u at a given tidal frequency will be increased by the variability associated with the other tidal components heaps 1978 inoue and garrett 2007 inoue and garrett 2007 showed that minor tidal constituents experience proportionately more friction than the dominant constituents to physically explain the difference in s 2 amplitudes from run s and run ts run t fig 9c we extracted the time varying bottom stress from run s and the difference in bottom stress from run ts and run t at each grid point we then estimated the complex s 2 amplitude of these two time varying vector quantities and used their magnitude as a metric for the strength of bottom stress at the s 2 frequency fig 9d shows the ratio of the metrics for run ts run t and run s this figure shows that the inclusion of gravitational tidal forcing in a global surge model can increase bottom friction at the s 2 frequency by a factor of about 10 in some regions e g southern north sea the patagonia shelf and the ross sea given the similarity of fig 9c and d we conclude that enhancement of bottom friction by the gravitational tide is the major cause of the damping of the radiational s 2 tide in the coupled tide surge run 4 3 predicting total water level we now evaluate four ways of predicting twl based on the model runs listed in table 1 model predictions are compared with observations of hourly twl recorded during 2008 at the 304 stations listed in table a 1 in addition to errors in the atmospheric forcing it is important to note that the observed twls are influenced by factors not captured by the ocean model including i baroclinicity on multiple time scales including its contribution to the low frequency annual and semi annual tides sa and ssa ii semi diurnal and diurnal tidal constituents other than the eight included in the model i e m 2 s 2 n 2 k 2 o 1 k 1 p 1 q 1 iii bay and harbor seiches with periods of several hours caused by small scale variations in coastline and bathymetry these discrepancies motivated us to compare the observed and predicted twl times series in several frequency bands as detailed below an overall evaluation of the four prediction schemes in four frequency bands is given by box plots showing the three quartiles of rmse and γ 2 fig 10a and b two schemes are based on the un nudged form of the tidal model λ 0 everywhere run t run s refers to the sum of separate predictions by the un nudged tidal run run t and the surge run run s run ts includes tide surge interaction table 1 the remaining two schemes are similar to run t run s and run ts but they both use tidal nudging run tn run s and run tns respectively overall run t run s provides the least accurate predictions of twl across all frequency bands based on the three quartiles of rmse and γ 2 fig 10a and b this is to be expected because run t run s does not include tidal nudging section 4 1 or the nonlinear interaction that damps the unrealistically large radiational s 2 tide predicted by run s section 4 2 3 allowing for tide surge interaction run ts leads to a modest reduction of the three quartiles of rmse and γ 2 fig 10a and b the reductions can be much larger on a local scale for example the largest rmse reduction 0 09 m is found at cuxhaven rmse reductions in excess of 0 03 m are found at 12 additional stations all from regions with high radiational s 2 tide fig 5b stations 119 120 on the northwest european shelf 153 156 158 160 from the strait of malacca 8 9 12 13 from alaska and british columbia 39 from the pacific coast of panama fourier analysis shows the difference between run t run s and run ts is dominated by variability with a period of 12 hours this leads us to conclude that the largest reductions in rmse of run ts relative to run t run s is due to gravitational tidal damping of the radiational s 2 tide run tn run s is the sum of the tidally nudged and surge only runs it outperforms run t run s and run ts based on the quartiles of rmse and γ 2 fig 10a and b the improvement is due entirely to nudging the tides toward the tpxo8 tidal observations in deep water section 4 1 one of the issues with run tn run s is that it leads to double counting of the radiational s 2 tide because both run tn and run s contain an rs2 signal another issue is that as with run t run s run tn run s will overestimate rs2 due to lack of gravitational damping we will not discuss this twl prediction scheme further run tns includes tidal nudging and tide surge interaction its quartiles of both rmse and γ 2 are the lowest for all prediction schemes across all four frequency bands the individual rmse values are mapped in fig 11a rmse and γ 2 are also plotted by station code in fig 11b and c they are all listed for each station in table a 1 there is generally good agreement between the observed and predicted twl with the rmse below 0 20 m for 83 of the stations and γ 2 1 for 99 of the stations relatively large γ 2 values are found for woods hole station code 98 and the eastern side of the strait of malacca station codes 158 160 they can be explained by tide prediction errors compare figs 11c and 4d and see discussion in section 4 1 muis et al 2016 reported an arithmetic mean of rmse of 0 17 m for their global tide and surge model reanalysis our arithmetic mean of rmse for run tns is 0 15 m although we caution that the study period and selection of tide gauges differ fig 10c summarizes the relative performance of the four schemes for unfiltered twl times series first group run tns has the lowest rmse or γ 2 for 195 out of the total of 304 tide gauges by way of contrast run t run s has the lowest rmse or γ 2 at only 20 gauges for the semi diurnal frequency band periods between 16 and 9 6 hours run tns has the lowest rmse or γ 2 for 210 gauges this bar graph clearly shows that run tns has the best overall performance 5 summary and conclusions the present study focuses on the development of a computationally efficient scheme for accurately predicting the global distribution of twl two overriding questions were addressed what is the best way to predict tidal elevation at the coast using an operational model with limited spatial resolution what is the impact of neglecting nonlinear tide surge and tide tide interaction the underlying model is based on the nemo modeling framework on the basis of a set of sensitivity runs appendix c we chose a horizontal grid spacing of 1 12 as a compromise between model accuracy and computational efficiency the model was forced by air pressure and wind reforecast fields for 2008 provided by eccc with a time spacing of one hour this relatively high temporal resolution allowed us to resolve the s 2 tide in global air pressure and wind the predicted tide in water deeper than 400 m fig 1 was nudged to tpxo8 observations of tidal elevation or current using a scheme called tidal nudging kodaira et al 2019 the idea is to restrict the nudging to specified tidal bands the width of the nudged frequency bands is controlled by a single parameter κ the approach is conceptually similar to applying a conventional tidal analysis over a sliding window increasing κ is equivalent to reducing the width of the window in contrast to kodaira et al 2019 who nudged η in the continuity equation we nudged u in the momentum equation this resulted in more accurate predictions of u leading to dynamically consistent improvements in η through the continuity equation nudging u also avoids violation of the continuity equation which is a major drawback of nudging η appendix b as expected tidal nudging improves the tidal predictions in deep water where it is applied based on comparisons with independent twl observations made by 304 tide gauges the nudging also improves tidal predictions at the coast more specifically the nudging improves the tidal predictions at 82 of the tide gauges and decreases the arithmetic mean of rmse across all gauges by 23 from 0 13 to 0 10 m the radiational s 2 tide in sea level forced solely by the s 2 tide in global air pressure reached amplitudes exceeding 80 cm in accord with previous studies we found that forcing over the tropics is most effective at exciting the global sea level response at the s 2 frequency decreasing the time spacing of the air pressure forcing from 1 h to 3 h reduces the s 2 amplitude in air pressure by a factor of 0 82 consistent with expectations based on fourier analysis a simple scaling factor does not apply if the temporal resolution is further reduced to 6 hours because the s 2 signal is aliased overall these results highlight the importance of using atmospheric forcing with a time spacing of one hour in order to accurately predict the global sea level response to the atmospheric s 2 tide all of the subsequent runs used hourly atmospheric forcing two surge only runs forced solely by hourly air pressure and wind stress for 2008 were performed the original atmospheric forcing was used for run s atmospheric forcing with its s 2 component removed was used for run s the predicted sea levels from run s and run s were compared with the observed tidal residuals for the 304 tide gauges the best fit was found for run s this is not surprising because tidal analysis of the observed twl removes not only the gravitational s 2 tide but also the radiational s 2 component this has implications for regional surge and twl modeling the radiational s 2 tide will be missed by regional models unless it is correctly represented at the model s open boundaries based on runs with both atmospheric and tidal forcing run ts run tns it was shown that the radiational s 2 tide is subject to strong nonlinear interaction with the gravitational tide the result is a pronounced attenuation of the radiational s 2 tide in large amplitude 0 3 m regions such as the north sea patagonia shelf and the ross sea it was shown that the attenuation can be explained by an increase in effective bottom friction at the s 2 frequency by almost one order of magnitude in regions with large rs2 due to the presence of the gravitational tide four schemes for predicting twl were evaluated run t run s is the sum of separate predictions by the un nudged tidal run and the surge run run ts includes tide surge interaction run tn run s and run tns are of the same form as run t run s and run ts but are tidally nudged based on comparison of model predictions with twls observed by the 304 tide gauges we conclude that run tns provides the most accurate predictions of coastal sea level it benefits from tidal nudging in deep water leading to improved predictions of coastal tides and nonlinear interaction between the radiational and gravitational tide leading to a significant attenuation of the radiational s 2 tide predicted by the surge only model run s the performance of run tns is comparable to the global reanalysis dataset provided by muis et al 2016 in terms of rmse and it compares well with the regional surge forecast system operationally operated by eccc bernier and thompson 2015 we note that the tpxo8 tidal solution should be reliable for prediction given the astronomical forcing can be treated as deterministic on the time scales of interest tpxo8 can also be readily replaced by more accurate tidal solutions as they become available a global twl forecasting system based on the coupled tide surge model run tns is currently undergoing installation for operational use at eccc the system will be used to predict twl with lead times up to 16 days and will replace the regional deterministic system of bernier and thompson 2015 we are also extending this system by including baroclinicity at low computational cost with the goal of improving the forecasts whilst keeping the computational cost sufficiently low to allow for the operational production of ensemble forecasts credit authorship contribution statement pengcheng wang conceptualization methodology software validation formal analysis investigation writing original draft writing review editing visualization natacha b bernier conceptualization methodology resources writing review editing supervision project administration funding acquisition keith r thompson conceptualization methodology formal analysis resources writing review editing tsubasa kodaira methodology software funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank jerome chanut for providing the eorca12 and orca36 grids and bathymetry data krt was supported by national sciences and engineering research council of canada nserc discovery grant rgpin 42414 2013 tk was supported by jsps kakenhi grant number 18k13933 tk also acknowledges financial support through the collaborative research program by the japan society of naval architects and ocean engineers jasnaoe the authors thank two anonymous reviewers for their constructive comments appendix a selection and ordering of tide gauges the locations of the tide gauges included in the present study are plotted in fig a 1 and listed in table a 1 the selection ordering and grouping of the 304 tide gauges are explained in section 2 the table also gives the rms of hourly observations of twl the corresponding rmse and γ 2 for run tns appendix b tidal nudging a computationally efficient method based on kodaira et al 2019 is now described for nudging an ocean model toward tpxo8 observations section 2 in selected tidal frequency bands while allowing the model to evolve freely outside of these bands in the present study the nudging is turned off in water shallower than 400 m fig 1 this allows tide surge and tide tide interaction on the shelf kodaira et al 2019 implemented the method by adding a sea level nudging term of the form λ η o b s η to the right side of the continuity equation 2 however this approach raises concern about violation of mass conservation and possible consequences for the computation of u using the momentum equation 1 in this study we modified the approach to nudge u in the horizontal momentum equation in this appendix we compare the effect of nudging η and u the method is based on a recursive filter that requires only a small increase in computer memory and run time details of the filter and its implementation are given by thompson et al 2006 the filter requires specification of the centers of the tidal frequencies bands to be nudged and a parameter κ that controls the width of the nudged bands the reciprocal of κ is proportional to the e folding spin up time of the filter and so we define t spin κ 1 δ where δ is the model time step the tidal nudging technique is conceptually similar to applying a conventional tidal analysis over a sliding window and increasing κ is equivalent to reducing the window length in addition to κ it is necessary to specify the strength of the nudging λ x possibly as a function of horizontal location x to illustrate the use of the filter and its sensitivity to κ we follow kodaira et al 2019 and apply the filter to a simulated twl record equal to the sum of a tide and surge component fig b 1a the tide is simulated using observed amplitudes and phases of the eight major tidal constituents for halifax station code 102 table a 1 the surge is simulated using an auto regressive model of order 1 with a realistic surge variance taking t spin 14 d allows the tides to be recovered within several cm after about 2t spin 28 d as expected fig b 1b the surges are almost unchanged by the filter after 28 d fig b 1c the sensitivity of the filter to different choices of κ is illustrated in fig b 1d as expected larger κ smaller t spin gives less accurate tides due to tidal leakage from the surge for the present application we found that t spin 14 d gives acceptable results without requiring an excessively long spin up time for the filter b 1 comparison of tidal nudging of sea level and current we now compare three nemo tidal runs subject only to gravitational forcing at the m 2 frequency both τ s and p a are set to zero run t is not nudged run tn is nudged to u in the momentum equation and run tn is nudged to η in the continuity equation table 1 to quantify the effect of the nudging the predictions of m 2 elevation are compared to tpxo8 observations section 2 the error is quantified by the magnitude of the difference in the complex m 2 amplitude z of the observations and the colocated model predictions z o b s z m o d this allows for errors in the timing and amplitude of the predicted tide following katavouta et al 2016 the error in tidal current is quantified by b 1 γ 2 0 p u o b s t u m o d t 2 d t 0 p u o b s t 2 d t where p is the period of m 2 and u o b s t and u m o d t are time varying m 2 tidal current vectors calculated from the observed and modeled tidal amplitudes and phases smaller γ 2 indicates better model performance γ 2 combines errors in timing and also the length of the semi major axis eccentricity and orientation of the predicted tidal current ellipse the left panels of fig b 2 show that both forms of nudging result in significant improvements in m 2 tidal elevation over most of the global ocean the improvements are not confined to the deep water where the nudging is applied fig 1 improvements are also evident over the shelf e g north of australia mozambique channel and weddell sea we note the nudging is not perfect and a slight degradation does occur for example south of alaska for both forms of nudging relatively large errors remain in some regions e g north sea patagonia shelf east china sea hudson strait and hudson bay we speculate higher resolution is required in these regions appendix c overall nudging η is more effective than nudging u this is to be expected because run tn nudges η toward the tpxo8 tidal elevations the right panels of fig b 2 show both forms of nudging improve the predictions of m 2 tidal current the improvements are comparable in the northwest pacific and south atlantic ocean in the south pacific north atlantic and indian ocean nudging u outperforms nudging of η this is to be expected because run tn nudges u toward the tpxo8 tidal currents in addition to the tpxo8 data we use independent coastal sea level observations from the 304 tide gauges table a 1 to evaluate the two forms of nudging the rmse of tidal elevation predicted by run tn and run tn are plotted as a function of station code in fig b 3 the observed and predicted tides are based on the following tidal constituents m 2 s 2 n 2 k 2 o 1 k 1 p 1 and q 1 in order to resolve all eight constituents this evaluation was only applied to 289 out of the 304 tide gauges with at most 50 missing observations for 2008 the rmse is the standard deviation of the difference in the available observed and predicted hourly tides for 2008 in terms of rmse nudging of η and u both give an average rmse of 0 11 m tidal nudging of u is more effective than nudging of η at stations in the gulf of maine station code 99 101 and north of australia station code 194 195 based on the above statistical analysis and the lack of justification for violating the continuity equation we choose to nudge u in the present study appendix c sensitivity to model resolution three orca grids with a spacing of 1 4 orca025 1 12 orca12 and 1 36 orca36 are used to assess the impact of changing the horizontal resolution of the model these three grids have a southern limit of 77 south and exclude ice cavities in the southern ocean in contrast to the extended grid eorca12 used for the main set of runs table 1 the three grid sensitivity runs were all forced by gdrs forecasts of wind and air pressure the gravitational tidal potential was evaluated at the m 2 s 2 o 1 and k 1 tidal frequencies and tidal nudging was turned off the highest resolution bathymetry was interpolated to the coarser 1 4 and 1 12 grids given the high computational cost of running the model on the 1 36 grid approximately 16 and 600 times the cost of the 1 12 and 1 4 grids respectively all three sensitivity runs covered a period of only 120 days to avoid the effect of model spin up the analysis focused on the last 90 days of each run september 19 to december 18 2018 as a result of the shorter analysis period the number of observed twl records available for model evaluation dropped from 304 to 211 figs c 1 and c 2 the t tide package of pawlowicz et al 2002 was used to decompose observed and predicted twl into tides and surges the surges were obtained by removing the full tidal signal from twl and then applying a high pass filter t p 20 days to the tidal residual the tides were reconstructed based on the four constituents m2 s2 o1 and k1 used to force the model we focus first on the accuracy of the predictions of tidal elevation fig c 1 shows the change in rmse with grid spacing at the 211 tide gauges the overall skill in predicting the tide improves significantly when the grid spacing drops from 1 4 to 1 12 top panel the average rmse drops by 0 05 m equivalent to a relative drop of 20 the drop in rmse exceeds 0 30 m in regions with large tides e g gulf of st lawrence and bay of fundy north sea southeast asia and the patagonia shelf decreasing the grid spacing from 1 12 to 1 36 bottom panel leads to a smaller overall reduction of 0 01 m in average rmse although reductions of 0 20 0 60 m occur in the high tide regions mentioned above decreasing grid spacing does not improve the fit at all stations for example the rmse increases by 0 18 m at some gauges from the west coast of canada as the spacing decreases from 1 12 to 1 36 bottom panel the accuracy of the surge predictions as a function of grid spacing is illustrated in fig c 2 overall the average rmse drops by only 4 on reducing the spacing from 1 4 to 1 12 top panel reductions in rmse of several cm are however evident in some regions most notably the east coast of north america reducing the grid spacing from 1 12 to 1 36 bottom panel leads to negligible changes in rmse 1 cm see bottom panel in agreement with bernier and thompson 2015 it is important to note that the evaluation of the surge predictions is being performed at tide gauges exposed to the open ocean section 2 much larger improvements in skill with increasing model resolution are to be expected at locations influenced by local variations in coastline and bathymetry based on the above sensitivity runs we reject the 1 4 grid spacing given its poor performance in predicting both tide and surge given the relatively small increase in skill and 16 fold increase in run time that results from decreasing the grid spacing of 1 12 to 1 36 we will focus on 1 12 this will allow the development of an effective 1 12 ensemble prediction system that can generate a 16 member ensemble of twl predictions for about the same computational cost as a single run of the 1 36 model this system will provide assessments of uncertainty for both operational and climate based applications section 1 including the issuance of probabilistic forecasts of coastal flooding bernier and thompson 2015 
23871,the development of a computationally efficient scheme for predicting the global distribution of total water level twl is discussed the ocean model is barotropic has a horizontal grid spacing of 1 12 and is based on the nemo modeling framework it is forced by the gravitational potential and hourly atmospheric fields for 2008 hourly time spacing was required to resolve the s 2 tide in global air pressure and wind the predicted tide in water deeper than 400 m was nudged to tpxo8 observations of tidal elevation or current using a scheme called tidal nudging kodaira et al 2019 the benefit of nudging horizontal velocity in the momentum equation compared to sea level in the continuity equation is discussed tidal nudging is shown to improve tidal predictions of sea level at the coast particularly at the s 2 tidal frequency the predicted radiational s 2 tide in sea level forced solely by the s 2 tide in global air pressure reaches amplitudes exceeding 80 cm decreasing the time spacing of the air pressure forcing from 1 h to 3 h reduces the s 2 amplitude in air pressure by a factor of 0 82 consistent with expectations based on fourier analysis this highlights the importance of using hourly atmospheric forcing when predicting the global sea level response to atmospheric forcing the radiational s 2 tide in sea level is subject to strong nonlinear interaction with the gravitational tide leading to a pronounced attenuation of the radiational s 2 tide the attenuation is explained by an increase in effective bottom friction at the s 2 frequency due to the presence of the gravitational tide four schemes for predicting twl are evaluated to quantify the impact of tidal nudging and nonlinear interaction of tide and surge using twls observed by 304 coastal tide gauges we show it is necessary to include both tidal nudging and nonlinear interaction plans for the further development of an operational flood forecast system for the canadian coast based on the above model are discussed keywords storm surge total water level tidal nudging radiational and gravitational tide nemo 1 introduction coastal flooding poses a major threat to coastal communities worldwide and its adverse impacts are expected to increase over the next century e g ipcc 2014 hallegatte et al 2013 hinkel et al 2014 an effective response to imminent coastal flooding requires a model that can accurately predict total water level twl with lead times of hours to order ten days there is also a need for decadal scale projections of probability distributions of twl and thus flooding risk under plausible climate change scenarios both forecasting and projection applications require ensembles of runs and this increases the need for models that are computationally efficient one of the challenges in developing an accurate model of twl is that the prediction of tide and surge the dominant components of twl for many coastal regions is essentially a global problem furthermore tides and surges at the coast are also influenced by local variations in bathymetry through its effect on harbor and shelf scale resonances waveguides for coastal trapped waves and tide surge interaction this wide range of spatial scales makes the choice of the grid spacing for the model critical although improvements in purely hydrodynamic also referred to as forward global tidal models have been made through the inclusion of self attraction and loading and topographic internal wave drag e g kodaira et al 2016b further improvements are required to improve the parameterization of sub grid scale processes it is well known that the oceanic tide can be excited by the atmospheric tide forced by the thermal effect of radiation mostly at the solar diurnal s 1 and semidiurnal s 2 frequencies e g cartwright 1978 the atmospherically forced oceanic tides will henceforth be referred to as radiational tides munk and cartwright 1966 and denoted by rs1 and rs2 the amplitude of rs1 is relatively small 1 cm in contrast to the amplitude of rs2 which can be 5 10 cm cartwright 1978 similar to the gravitational s 2 tide rs2 is generated primarily over the tropical oceans and has a global response as a result rs2 will be missed in regional flood forecasting systems if it is not included through the open boundary conditions furthermore the atmospheric forcing for the ocean models must have sufficiently high temporal resolution in order to properly resolve rs2 dobslaw and thomas 2005 most operational and research flood forecasting systems are regional e g bernier and thompson 2015 flowerdew et al 2010 werner et al 2009 allen et al 2018 or global but with coarsely resolved 6 hour atmospheric forcing e g carrère and lyard 2003 verlaan et al 2015 the present global study is the first to examine the effect of rs2 on total water level forecasts using atmospheric forcing with a time spacing of one hour coastal flooding is a major concern for canadians on the east coast severe damage to coastal infrastructure and loss of life has been caused by flooding driven by hurricanes and strong winter storms e g bernier and thompson 2015 danard et al 2003 the most recent example is hurricane dorian it made landfall just west of halifax nova scotia in 2019 and generated a surge level of about 1 m at halifax and 1 6 m in northumberland strait resulting in extensive flooding and severe damage to seawalls houses and vessels on the west coast of canada communities are also vulnerable to storm surges in winter and there is growing concern about the possibility of increasing storm frequency danard et al 2003 in the present study we evaluate several schemes for forecasting twl for all of the canadian coastline in this study we will evaluate a global model that resolves important coastal wave guides e g west and east coasts of north america and the response to atmospheric s 2 forcing over the tropics global ocean general circulation models with the capacity of predicting twl have been developed e g schiller and fiedler 2007 müller et al 2010 arbic et al 2010 2012 these earlier studies focused on the effect of tides on ocean circulation or the joint simulation of barotropic and baroclinic tides rather than twl global models developed directly for twl forecasting include the global tide and surge model gtsm developed by verlaan et al 2015 and the adcirc storm tide model developed by pringle et al 2021 both models are barotropic and use unstructured spherical grids to provide a more detailed representation of coastal areas compared to the open ocean the gtsm was used by muis et al 2016 for a global reanalysis of extreme sea levels they only used the surge component of gtsm tides were generated using the data assimilative model known as fes2012 carrère et al 2012 due to the weak performance of gtsm in tidal prediction at that time muis et al 2016 the main goal of the present study is the development of a computationally efficient scheme for accurately predicting the global distribution of twl this leads us to two questions of practical and scientific interest the first question is how can we best predict tides using a model with limited spatial resolution a simple approach would be to directly nudge the modeled tides toward tidal observations e g han et al 2010 fu et al 2021 however this approach is not suitable for twl because the surge component of twl will be suppressed by the nudging in this study we use a modified form of spectral nudging thompson et al 2006 to target specific tidal frequency bands thereby reducing the suppression of the surges following kodaira et al 2019 we refer to this modified technique as tidal nudging the second question is what is the impact of neglecting tide surge interaction e g bernier and thompson 2007 davies and lawrence 1994 horsburgh and wilson 2007 and tide tide interaction on the prediction of twl by a global model forced by hourly air pressure and wind stress the present study uses a 1 12 global barotropic model based on the nucleus for european modeling of the ocean nemo framework madec 2008 the m 2 tide kodaira et al 2016b and surge kodaira et al 2016a components of this model have been separately validated and shown to be in reasonable agreement with global observations of the m 2 tide and surges the model is further modified in the present study by including tidal nudging and extending the southern limit of model grid to allow tidal propagation under ice shelves the evaluation is carried out using hourly observations of twl from a global array of 304 tide gauges for 2008 this year has the most surges exceeding 1 m in the global array of tide gauges since 2000 the structure of the paper is as follows the observations of coastal twl and tidal elevations and currents from the deep ocean are described in section 2 the ocean model and its atmospheric forcing are described in section 3 the tide surge and twl predictions are evaluated in section 4 the nonlinear interaction of rs2 with the gravitational tide is also examined the results are summarized and discussed in the final section 2 observations for model evaluation tidal elevations and currents from a data assimilative model based on egbert and erofeeva 2002 are used for tidal nudging and model evaluation tidal amplitudes and phases for eight tidal constituents m 2 s 2 n 2 k 2 o 1 k 1 p 1 and q 1 were obtained from oregon state university on a global grid with a spacing of 1 30 these data will henceforth be referred to as tpxo8 given the good agreement between tpxo8 and amplitudes and phases calculated from independent observations stammer et al 2014 tpxo8 will henceforth be treated as observations hourly twls observed by a global array of tide gauges were obtained from the university of hawaii sea level centre uhslc caldwell et al 2015 all available data of research quality were downloaded for 2008 stations were excluded if any of the following criteria were met 1 the proportion of missing observations exceeds 90 2 the station is more than 25 km from the nearest ocean model grid point 3 the station is shielded from the open ocean by barrier islands or located far inland on a river 4 the station is on an island too small to be resolved by the model applying the four selection criteria resulted in a global distribution of 304 stations appendix a the global distribution of the 304 tide gauge stations is uneven and this causes difficulty when attempting to plot the global distribution of point statistics such as root mean square error rmse for this reason the 304 stations were reordered taking into account the tendency of extended coastlines to act as wave guides for coastal trapped waves the reordered station codes are listed in appendix a and their locations grouped by 8 subregions are plotted in fig a 1 several of the figures in this study show point statistics such as rmse as a function of station number grouped by subregion 3 the ocean model 3 1 governing equations the model is based on the following depth averaged barotropic momentum equation 1 u t u u f u g 1 α s η η a a 2 u τ s τ b ρ h 1 ρ p a c i w u λ x u o b s u and continuity equation 2 η t h u 0 where u u v is the depth averaged horizontal velocity f is the coriolis parameter multiplied by the upward pointing unit vector η is the sea surface height η a is the gravitational tidal potential a is the horizontal viscosity τ s and τ b are the surface and bottom stress h is total water depth and p a is atmospheric pressure at sea level the coefficients α s and c i w parameterize self attraction and loading and topographic internal wave drag respectively we use the water depth dependent factor α s derived empirically by stepanov and hughes 2004 the coefficient c i w is calculated following the formulation of jayne and st laurent 2001 its global distribution is given by kodaira et al 2016b the last term on the right side of 1 denotes the nudging of the model s current u toward the observed current u o b s given by tpxo8 the angle brackets represent temporal filtering of the nudging term to isolate variability in selected tidal frequency bands kodaira et al 2019 λ x determines the spatially varying strength of the nudging at horizontal position x to allow surges and nonlinear processes that cause tide surge and tide tide interaction e g davies and lawrence 1994 le provost 1991 to evolve freely on the shelf λ was set to zero in water shallower than 400 m in deeper water λ x increased with water depth to a maximum value of 0 05 δ where δ is the baroclinic time step discussed below the global distribution of λ x is shown in fig 1 spatial smoothing ensured a gradual transition of λ x from deep to shallow water the tidal nudging methodology is further discussed in appendix b it is shown that tidal nudging of currents in the momentum equation is preferable to adding a sea level nudging term of the form λ η o b s η to the right side of the continuity equation 2 the governing equations are solved numerically using the nemo modeling framework madec 2008 the model grid is the extended version of a tri polar orca grid referred to as eorca12 it has a nominal resolution of 1 12 at the equator compared to the original version of orca12 the eorca12 grid has been extended southward from 77 s to 85 s in order to allow tidal propagation under antarctic ice shelves such propagation is required for accurate tide predictions throughout the southern ocean and potentially the tropics de kleermaeker et al 2017 sensitivity studies appendix c show that a grid spacing of 1 4 is too coarse to predict tides and surges increasing the resolution to 1 12 gives acceptable tide and surge predictions on a global scale further increasing the resolution to 1 36 yields as expected local improvements in areas with bathymetric features poorly resolved by 1 12 grid however these improvements come at an approximately 16 fold increase in run time given the present interest in extended range ensemble forecasts of twl and decadal scale projections of flooding risk computational efficiency is a major consideration and the rest of the study will focus on results from the 1 12 model the bathymetry is derived from gebco 2014 weatherall et al 2015 the minimum and maximum water depths are set at 10 m and 6000 m over ice cavities in the antarctic ice thickness has been removed and only the water column thickness has been used as the bathymetry data the ice thickness is derived from the bedmap products fretwell et al 2013 and does not change with time in addition the bathymetry in hudson bay and on the labrador and newfoundland shelf was adjusted based on bathymetric data kindly provided by f lyard personal communication this modification was necessary in order to obtain accurate tide predictions for these regions and the adjacent north atlantic the model is 2d barotropic with one single vertical layer representing the water column the model is run with a baroclinic time step of 180 s and a mode splitting procedure is employed to solve the barotropic equations using a time step of 6 s for computational efficiency all unnecessary calls to subroutines related to vertical processes and tracers were removed tidal nudging was applied at every baroclinic time step the quadratic bottom friction was parameterized using a constant drag coefficient of 2 5 1 0 3 to account for the effect of ice cover in the ross and weddell seas atmospheric forcing was turned off over ice cavities and the bottom drag coefficient was doubled to take into account the top friction 3 2 atmospheric forcing gridded fields of atmospheric forcing were obtained from the global deterministic reforecast system gdrs gasset et al 2021 developed by environment and climate change canada eccc the gdrs configurations are closely related to the control member of the operational global ensemble prediction system geps lin et al 2016 at eccc the gdrs is used to produce hourly forecast with a grid spacing of approximately 39 km following bernier and thompson 2007 the magnitude of the wind stress is calculated using c d w w 2 where w is the wind speed and c d is a drag coefficient that equals 1 2 1 0 3 for wind speeds below 8 m s 1 increasing linearly with w for higher wind speeds with a slope of 0 065 1 0 3 for every 1 m s 1 increase in w this drag coefficient formulation is currently used by the regional surge forecast system run operationally by eccc the gdrs runs are renewed every 12 h and the forecast continues for 24 h for each run forecast hours 0 to 5 are discarded to avoid adjustments that result from initialization based on the era interim reanalysis of dee et al 2011 to concatenate the time sequence of gdrs reforecast fields of wind and air pressure temporal blending is applied to forecast hours 6 through 10 as follows 3 b t i β t i a o t i 1 β t i a n t i 6 t i 10 where b t i is the blended forecast for hour t i a o t i and a n t i denote the old and new forecasts at the same time and β t i is the blending coefficient defined by β 6 0 50 β 7 0 35 β 8 0 25 β 9 0 15 β 10 0 05 the forecasts and the blending are performed every 12 h the same blending procedure was used by bernier and thompson 2015 and kodaira et al 2016a the atmospheric forcing has a significant s 2 tide fig 2 the s 2 tide in the gdrs hourly air pressures is strongest in the tropics where it reaches a maximum amplitude of 1 24 hpa in the eastern pacific consistent with observations see figure 8 of dai and wang 1999 this well known semi diurnal variation is due to the thermal effect of solar radiation e g lindzen and chapman 1969 the s 2 tide in the hourly gdrs winds is relatively small near the equator and increases poleward reaching speeds of 0 2 m s 1 in the momentum equation 1 the direct contributions of air pressure and wind are expressed by the terms ρ 1 p a and ρ 1 τ s h respectively following ray and egbert 2004 the scaling of these two terms shows that locally the pressure term is at least two orders of magnitude larger than the wind stress term this suggests that air pressure loading is the primary mechanism for exciting the s 2 tide in the ocean 4 results seven model runs are described and compared in this section each model run starts on november 8 2007 and finishes on december 31 2008 the output was stored hourly to allow for model spin up and also focus on the year 2008 the output for the last 54 days in 2007 was discarded we note that a spin up time of 30 40 days determined mainly by the spin up time of the tidal filter see appendix b should be sufficient for the present study this was confirmed by sensitivity studies using different spin up times to study the dynamical origin of the s 2 signal in the ocean least squares is used to decompose the time varying atmospheric forcing and ocean response at each grid point into a purely sinusoidal component with a period of 12 hours and a residual for sea level at a given grid point the decomposition takes the form 4 η t η t η t similar decompositions can be written for u t p a t and τ s t the first group of runs is subject only to gravitational forcing run t run tn run tn the second group run s run s is atmospherically forced and tidal nudging is set to zero run s is forced by p a t and τ s t the last group of runs run ts run tns allows for tide surge and tide tide interaction in the prediction of twl both with and without tidal nudging the seven runs are summarized in table 1 comparison of these runs both within and between groups allows us to address the following questions what is the impact of tidal nudging in the deep ocean on twl predicted at the coast which variable u or η should be nudged what is the impact of neglecting nonlinear tide surge and tide tide interaction on the prediction of twl to assess model performance at each tide gauge we calculate the root mean square error rmse from the difference of time series of observations and predictions for reference we also calculated the root mean square rms of observations for the same period for each tide gauge to facilitate the comparison with different scales we also use the γ 2 statistic of thompson and sheng 1997 5 γ 2 v a r o m v a r o where v a r denotes variance and o and m denote observation and model simulation respectively small values of γ 2 indicate good model performance if γ 2 1 the model simulations are worse than using the mean of the observations as a predictor 4 1 predicting the tides it was shown in appendix b that tidal nudging in deep water fig 1 improves predictions of m 2 tidal elevation at the coast in this subsection we extend the model evaluation to include the following tidal constituents m 2 s 2 n 2 k 2 o 1 k 1 p 1 and q 1 the harmonic analysis was performed using the t tide package of pawlowicz et al 2002 given a complete hourly record for all of 2008 the tidal package will select 68 tidal constituents given a six month record the tidal analysis will resolve all eight constituents included in the gravitational forcing of the ocean model for this reason we focused this evaluation on 289 out of the 304 tide gauges with at most 50 missing observations for 2008 for the tidal analysis of observed and predicted time series missing values in the observations were also treated as missing in the predictions to provide a global assessment of skill we use box plots fig 3 to present the three quartiles of the error metrics across all 289 stations for a given run and a given tidal constituent box plots of amplitude and phase errors are shown in fig 3a and b comparison of run t and run tn shows that tidal nudging effectively reduces all three quartiles of amplitude errors for m 2 s 2 n 2 and k 1 but increases the three quartiles for o 1 fig 3a the effect of tidal nudging on the amplitudes of k 2 p 1 and q 1 is insignificant the tidal nudging is however more consistent in correcting the phase errors by reducing the three quartiles for all eight constituents fig 3b box plots of rmse and γ 2 taking into account both amplitude and phase errors are further shown in fig 3c and d the tidal nudging reduces the three quartiles of both error metrics for all constituents except for o 1 where the overall effect of tidal nudging is relatively neutral the reductions are largest for the semi diurnal constituents and most dramatic for s 2 where the second quartile for example is reduced by 54 for rmse and 87 for γ 2 one reason for this large drop is that run tn includes the radiational s 2 tide through the nudging to tpxo8 which includes rs2 because it assimilates altimetry data given the twl observations include this rs2 signal nudging to tpxo8 favors run tn over run t at the s 2 tidal frequency individual values of rms rmse and γ 2 for the 289 tide gauges are shown in fig 4 all eight tidal constituents were used to reconstruct the tides the rmse for run tn is mapped in fig 4a and the difference in rmse for run t and run tn is mapped in fig 4b rms rmse and γ 2 are plotted as a function of station code in fig 4c and d the ordering and grouping of the stations is described in appendix a it is encouraging to note that tidal nudging reduces the rmse at 82 of the stations fig 4b and c show relatively large improvements to the northwest of australia 0 21 0 54 m station codes 194 196 and in the gulf of maine 0 15 0 28 m station codes 99 101 where the tidal range is large degradation of skill occurs at 18 of the stations but we note that the degradation is typically less than 0 05 m fig 4d further shows that tidal nudging effectively reduces γ 2 values at most stations regardless of the tidal range γ 2 1 for run tn occurs at 97 of the stations indicating the model has skill large γ 2 values greater than 2 are seen at stations in the baltic sea station codes 111 114 due mainly to the fact that observed tidal signals are very weak there rms 6 cm γ 2 slightly greater than unity is also found for woods hole station code 98 the west coast of florida station codes 83 84 and the eastern side of the strait of malacca station codes 158 160 we speculate that the poor performance of run tn at these stations could be improved by increasing model resolution the performance of the nudged run is comparable to the altimeter constrained fes2012 tidal model muis et al 2016 obtained an arithmetic mean of rmse of 0 15 m based on a multidecadal run of fes2012 the arithmetic mean of rmse for run tn in this study is 0 10 m but it is important to note that the tide gauges and the analysis period used in the present study differ from those of muis et al 2016 4 2 predicting the surges we now examine the response of the ocean to atmospheric forcing both gravitational forcing and tidal nudging are set to zero the initial focus is on the response to p a t i e forcing by air pressure at the s 2 tidal frequency this is followed by an examination of the ocean response to the full atmospheric forcing p a t and τ s t see eq 4 for the decomposition of forcing and response into a component proportional to s 2 and a residual 4 2 1 sea level response to p a and need for hourly forcing the global response of sea level at the s 2 tidal frequency to forcing by the s 2 tide in the hourly air pressure figs 5a or 2 is shown in fig 5b the maximum amplitude 88 cm is found in the bristol channel and the second largest 71 cm in the bay of fundy these values are much larger than the amplitudes predicted by the inverse barometer effect which are everywhere less than 2 cm fig 5a the spatial pattern of the amplitude is similar to that of the gravitational s 2 tide arbic 2005 and both can be explained in terms of excitation of oceanic normal modes by forcing at the s 2 frequency platzman et al 1981 arbic 2005 dobslaw and thomas 2005 compared the response of the global ocean to p a using air pressure forcing calculated from analysis fields defined every 6 h and forecast fields defined every 3 h linear interpolation was used to map the pressure fields to the time step of the ocean model dobslaw and thomas 2005 found a large difference in the ocean response on switching from 3 h to 6 h forcing the main reason is 6 h forcing can only resolve a standing wave in contrast to 3 h forcing which can capture propagation building on the study of dobslaw and thomas 2005 we repeated our calculation of the ocean response to p a with one change we subsampled the hourly gdrs pressure fields to 3 h and then linearly interpolated back to hourly values the results are shown in fig 5c and d the amplitude of p a fig 5c and a for 3 h sampling is similar to the amplitude pattern for 1 h sampling apart from a reduction by a factor of about 0 82 this factor was obtained by regression of the 3 h amplitudes on the 1 h amplitudes the reduction can be explained by considering a sinusoid with a period of 12 h defined in discrete time with a sampling interval of 1 h if the sinusoid is subsampled every 3 h and then linearly interpolated back to hourly values the amplitude of the fourier coefficient at a period of 12 h is reduced by 0 829 for completeness fig 5e and f show the effect of subsampling the hourly p a forcing every 6 h it differs greatly from the response to 1 h and 3 h forcing for the reasons given by dobslaw and thomas 2005 the amplitude of the sea level response to 1 h and 3 h pressure forcing fig 5b and d are as expected quite similar the sea level response to 3 h forcing is reduced by a factor of about 0 75 again based on regression of the 3 h amplitudes on the 1 h amplitudes the reason for the deviation from the theoretical value of 0 829 is presumably due to the effect of model nonlinearities on the ocean response the maximum amplitude is still found in the bristol channel but the value is reduced from 88 cm to 73 cm for completeness we also include the ocean response to 6 h forcing fig 5f 4 2 2 sea level response to hourly forcing by p a τ s and p a τ s we now examine the response to forcing by hourly variations in air pressure and wind stress gravitational forcing and tidal nudging are both set to zero the full tidal signal including s 2 was removed from the 304 observed twl records using the t tide package of pawlowicz et al 2002 the residuals from this tidal analysis are used for model evaluation for the evaluation of the surge predictions we follow kodaira et al 2016a and apply a high pass butterworth filter to the observed residual and predicted sea level time series to suppress variability with periods t p 20 days this was done to exclude low frequency baroclinic variability that cannot be predicted by the barotropic ocean model we first examine run s which is forced by air pressure and wind stress with the s 2 component removed p a τ s to quantify fit we initially focus on γ 2 fig 6d which takes into account both rmse and rms of observations reasonable model skill is found for 161 stations outside the tropics where the three quartiles of γ 2 are 0 24 0 34 and 0 47 tropical stations are defined as stations located between 23 4 north and 23 4 south see table a 1 for latitudes of all stations the model skill for the 143 tropical stations is relatively low with γ 2 close to unity for most stations fig 6d the three quartiles of γ 2 are 0 83 0 98 and 1 11 this is not surprising because surges are small at most tropical island locations fig 6c and model resolution is also an issue we also speculate that higher resolution atmospheric forcing is required to better capture the effect of tropical cyclones at these stations we now focus on run s which is forced by the unmodified atmospheric forcing p a τ s the change in rmse at each tide gauge is mapped in fig 6b the run s predictions includes rs2 and so it is not surprising that rmse increases on replacing p a τ s by p a τ s the largest increases occur in regions with large rs2 fig 5b these regions include the gulf of alaska northwest european shelf strait of malacca northwest coast of australia and new zealand the difference in surge response predicted by run s and run s is illustrated in fig 7 for three tide gauges at cuxhaven on the northwest european shelf the amplitude of the s 2 signal in the run s predictions reaches amplitudes of 0 5 m at nearby brest and taranaki new zealand the amplitudes reach 0 2 m taylor diagrams taylor 2001 for run s and run s are shown in fig 8 we have modified the taylor diagram by adding a line green semi circle in fig 8 that shows for positive correlation the minimum rmse that could be achieved by optimally scaling the predictions i e sliding a point radially to the point of minimum rmse these diagrams confirm that removing the s 2 tide from the atmospheric forcing leads to more accurate surge predictions particularly outside the tropics they also highlight the danger of running a global surge prediction model with uncorrected hourly atmospheric forcing run s 4 2 3 damping of the radiational s 2 tide by the gravitational tide the s 2 amplitudes of sea level calculated using hourly forcing fig 5b agree qualitatively with results from previous studies e g fig 1b of arbic 2005 fig 2 of dobslaw and thomas 2005 fig 5b of williams et al 2018 our amplitudes are however generally larger the discrepancy is explained by the nonlinear interaction of the s 2 radiational and gravitational tide fig 5 is based on atmospheric forcing only in contrast to the results shown in the above mentioned studies which arise from differences in coupled tide surge runs and tide only runs fig 9a and b show the amplitude of s 2 tidal elevation derived from the surge only run run s and the differences between the coupled tide surge run and tide only runs run ts run t the difference in the s 2 amplitude maps fig 9c shows clearly that nonlinear interaction reduces the s 2 amplitudes from the surge only run by order 10 cm in some regions e g southern north sea the patagonia shelf and the ross sea we note however that larger reductions can be found e g up to 80 cm in the bristol channel 53 cm on the patagonia shelf and 28 cm in the strait of malacca it is well known that the quadratic bottom friction term in 1 is an important cause of tide surge and tide tide interaction it is also well known that if a time varying current u t is a linear combination of tidal components then the contribution of u u at a given tidal frequency will be increased by the variability associated with the other tidal components heaps 1978 inoue and garrett 2007 inoue and garrett 2007 showed that minor tidal constituents experience proportionately more friction than the dominant constituents to physically explain the difference in s 2 amplitudes from run s and run ts run t fig 9c we extracted the time varying bottom stress from run s and the difference in bottom stress from run ts and run t at each grid point we then estimated the complex s 2 amplitude of these two time varying vector quantities and used their magnitude as a metric for the strength of bottom stress at the s 2 frequency fig 9d shows the ratio of the metrics for run ts run t and run s this figure shows that the inclusion of gravitational tidal forcing in a global surge model can increase bottom friction at the s 2 frequency by a factor of about 10 in some regions e g southern north sea the patagonia shelf and the ross sea given the similarity of fig 9c and d we conclude that enhancement of bottom friction by the gravitational tide is the major cause of the damping of the radiational s 2 tide in the coupled tide surge run 4 3 predicting total water level we now evaluate four ways of predicting twl based on the model runs listed in table 1 model predictions are compared with observations of hourly twl recorded during 2008 at the 304 stations listed in table a 1 in addition to errors in the atmospheric forcing it is important to note that the observed twls are influenced by factors not captured by the ocean model including i baroclinicity on multiple time scales including its contribution to the low frequency annual and semi annual tides sa and ssa ii semi diurnal and diurnal tidal constituents other than the eight included in the model i e m 2 s 2 n 2 k 2 o 1 k 1 p 1 q 1 iii bay and harbor seiches with periods of several hours caused by small scale variations in coastline and bathymetry these discrepancies motivated us to compare the observed and predicted twl times series in several frequency bands as detailed below an overall evaluation of the four prediction schemes in four frequency bands is given by box plots showing the three quartiles of rmse and γ 2 fig 10a and b two schemes are based on the un nudged form of the tidal model λ 0 everywhere run t run s refers to the sum of separate predictions by the un nudged tidal run run t and the surge run run s run ts includes tide surge interaction table 1 the remaining two schemes are similar to run t run s and run ts but they both use tidal nudging run tn run s and run tns respectively overall run t run s provides the least accurate predictions of twl across all frequency bands based on the three quartiles of rmse and γ 2 fig 10a and b this is to be expected because run t run s does not include tidal nudging section 4 1 or the nonlinear interaction that damps the unrealistically large radiational s 2 tide predicted by run s section 4 2 3 allowing for tide surge interaction run ts leads to a modest reduction of the three quartiles of rmse and γ 2 fig 10a and b the reductions can be much larger on a local scale for example the largest rmse reduction 0 09 m is found at cuxhaven rmse reductions in excess of 0 03 m are found at 12 additional stations all from regions with high radiational s 2 tide fig 5b stations 119 120 on the northwest european shelf 153 156 158 160 from the strait of malacca 8 9 12 13 from alaska and british columbia 39 from the pacific coast of panama fourier analysis shows the difference between run t run s and run ts is dominated by variability with a period of 12 hours this leads us to conclude that the largest reductions in rmse of run ts relative to run t run s is due to gravitational tidal damping of the radiational s 2 tide run tn run s is the sum of the tidally nudged and surge only runs it outperforms run t run s and run ts based on the quartiles of rmse and γ 2 fig 10a and b the improvement is due entirely to nudging the tides toward the tpxo8 tidal observations in deep water section 4 1 one of the issues with run tn run s is that it leads to double counting of the radiational s 2 tide because both run tn and run s contain an rs2 signal another issue is that as with run t run s run tn run s will overestimate rs2 due to lack of gravitational damping we will not discuss this twl prediction scheme further run tns includes tidal nudging and tide surge interaction its quartiles of both rmse and γ 2 are the lowest for all prediction schemes across all four frequency bands the individual rmse values are mapped in fig 11a rmse and γ 2 are also plotted by station code in fig 11b and c they are all listed for each station in table a 1 there is generally good agreement between the observed and predicted twl with the rmse below 0 20 m for 83 of the stations and γ 2 1 for 99 of the stations relatively large γ 2 values are found for woods hole station code 98 and the eastern side of the strait of malacca station codes 158 160 they can be explained by tide prediction errors compare figs 11c and 4d and see discussion in section 4 1 muis et al 2016 reported an arithmetic mean of rmse of 0 17 m for their global tide and surge model reanalysis our arithmetic mean of rmse for run tns is 0 15 m although we caution that the study period and selection of tide gauges differ fig 10c summarizes the relative performance of the four schemes for unfiltered twl times series first group run tns has the lowest rmse or γ 2 for 195 out of the total of 304 tide gauges by way of contrast run t run s has the lowest rmse or γ 2 at only 20 gauges for the semi diurnal frequency band periods between 16 and 9 6 hours run tns has the lowest rmse or γ 2 for 210 gauges this bar graph clearly shows that run tns has the best overall performance 5 summary and conclusions the present study focuses on the development of a computationally efficient scheme for accurately predicting the global distribution of twl two overriding questions were addressed what is the best way to predict tidal elevation at the coast using an operational model with limited spatial resolution what is the impact of neglecting nonlinear tide surge and tide tide interaction the underlying model is based on the nemo modeling framework on the basis of a set of sensitivity runs appendix c we chose a horizontal grid spacing of 1 12 as a compromise between model accuracy and computational efficiency the model was forced by air pressure and wind reforecast fields for 2008 provided by eccc with a time spacing of one hour this relatively high temporal resolution allowed us to resolve the s 2 tide in global air pressure and wind the predicted tide in water deeper than 400 m fig 1 was nudged to tpxo8 observations of tidal elevation or current using a scheme called tidal nudging kodaira et al 2019 the idea is to restrict the nudging to specified tidal bands the width of the nudged frequency bands is controlled by a single parameter κ the approach is conceptually similar to applying a conventional tidal analysis over a sliding window increasing κ is equivalent to reducing the width of the window in contrast to kodaira et al 2019 who nudged η in the continuity equation we nudged u in the momentum equation this resulted in more accurate predictions of u leading to dynamically consistent improvements in η through the continuity equation nudging u also avoids violation of the continuity equation which is a major drawback of nudging η appendix b as expected tidal nudging improves the tidal predictions in deep water where it is applied based on comparisons with independent twl observations made by 304 tide gauges the nudging also improves tidal predictions at the coast more specifically the nudging improves the tidal predictions at 82 of the tide gauges and decreases the arithmetic mean of rmse across all gauges by 23 from 0 13 to 0 10 m the radiational s 2 tide in sea level forced solely by the s 2 tide in global air pressure reached amplitudes exceeding 80 cm in accord with previous studies we found that forcing over the tropics is most effective at exciting the global sea level response at the s 2 frequency decreasing the time spacing of the air pressure forcing from 1 h to 3 h reduces the s 2 amplitude in air pressure by a factor of 0 82 consistent with expectations based on fourier analysis a simple scaling factor does not apply if the temporal resolution is further reduced to 6 hours because the s 2 signal is aliased overall these results highlight the importance of using atmospheric forcing with a time spacing of one hour in order to accurately predict the global sea level response to the atmospheric s 2 tide all of the subsequent runs used hourly atmospheric forcing two surge only runs forced solely by hourly air pressure and wind stress for 2008 were performed the original atmospheric forcing was used for run s atmospheric forcing with its s 2 component removed was used for run s the predicted sea levels from run s and run s were compared with the observed tidal residuals for the 304 tide gauges the best fit was found for run s this is not surprising because tidal analysis of the observed twl removes not only the gravitational s 2 tide but also the radiational s 2 component this has implications for regional surge and twl modeling the radiational s 2 tide will be missed by regional models unless it is correctly represented at the model s open boundaries based on runs with both atmospheric and tidal forcing run ts run tns it was shown that the radiational s 2 tide is subject to strong nonlinear interaction with the gravitational tide the result is a pronounced attenuation of the radiational s 2 tide in large amplitude 0 3 m regions such as the north sea patagonia shelf and the ross sea it was shown that the attenuation can be explained by an increase in effective bottom friction at the s 2 frequency by almost one order of magnitude in regions with large rs2 due to the presence of the gravitational tide four schemes for predicting twl were evaluated run t run s is the sum of separate predictions by the un nudged tidal run and the surge run run ts includes tide surge interaction run tn run s and run tns are of the same form as run t run s and run ts but are tidally nudged based on comparison of model predictions with twls observed by the 304 tide gauges we conclude that run tns provides the most accurate predictions of coastal sea level it benefits from tidal nudging in deep water leading to improved predictions of coastal tides and nonlinear interaction between the radiational and gravitational tide leading to a significant attenuation of the radiational s 2 tide predicted by the surge only model run s the performance of run tns is comparable to the global reanalysis dataset provided by muis et al 2016 in terms of rmse and it compares well with the regional surge forecast system operationally operated by eccc bernier and thompson 2015 we note that the tpxo8 tidal solution should be reliable for prediction given the astronomical forcing can be treated as deterministic on the time scales of interest tpxo8 can also be readily replaced by more accurate tidal solutions as they become available a global twl forecasting system based on the coupled tide surge model run tns is currently undergoing installation for operational use at eccc the system will be used to predict twl with lead times up to 16 days and will replace the regional deterministic system of bernier and thompson 2015 we are also extending this system by including baroclinicity at low computational cost with the goal of improving the forecasts whilst keeping the computational cost sufficiently low to allow for the operational production of ensemble forecasts credit authorship contribution statement pengcheng wang conceptualization methodology software validation formal analysis investigation writing original draft writing review editing visualization natacha b bernier conceptualization methodology resources writing review editing supervision project administration funding acquisition keith r thompson conceptualization methodology formal analysis resources writing review editing tsubasa kodaira methodology software funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank jerome chanut for providing the eorca12 and orca36 grids and bathymetry data krt was supported by national sciences and engineering research council of canada nserc discovery grant rgpin 42414 2013 tk was supported by jsps kakenhi grant number 18k13933 tk also acknowledges financial support through the collaborative research program by the japan society of naval architects and ocean engineers jasnaoe the authors thank two anonymous reviewers for their constructive comments appendix a selection and ordering of tide gauges the locations of the tide gauges included in the present study are plotted in fig a 1 and listed in table a 1 the selection ordering and grouping of the 304 tide gauges are explained in section 2 the table also gives the rms of hourly observations of twl the corresponding rmse and γ 2 for run tns appendix b tidal nudging a computationally efficient method based on kodaira et al 2019 is now described for nudging an ocean model toward tpxo8 observations section 2 in selected tidal frequency bands while allowing the model to evolve freely outside of these bands in the present study the nudging is turned off in water shallower than 400 m fig 1 this allows tide surge and tide tide interaction on the shelf kodaira et al 2019 implemented the method by adding a sea level nudging term of the form λ η o b s η to the right side of the continuity equation 2 however this approach raises concern about violation of mass conservation and possible consequences for the computation of u using the momentum equation 1 in this study we modified the approach to nudge u in the horizontal momentum equation in this appendix we compare the effect of nudging η and u the method is based on a recursive filter that requires only a small increase in computer memory and run time details of the filter and its implementation are given by thompson et al 2006 the filter requires specification of the centers of the tidal frequencies bands to be nudged and a parameter κ that controls the width of the nudged bands the reciprocal of κ is proportional to the e folding spin up time of the filter and so we define t spin κ 1 δ where δ is the model time step the tidal nudging technique is conceptually similar to applying a conventional tidal analysis over a sliding window and increasing κ is equivalent to reducing the window length in addition to κ it is necessary to specify the strength of the nudging λ x possibly as a function of horizontal location x to illustrate the use of the filter and its sensitivity to κ we follow kodaira et al 2019 and apply the filter to a simulated twl record equal to the sum of a tide and surge component fig b 1a the tide is simulated using observed amplitudes and phases of the eight major tidal constituents for halifax station code 102 table a 1 the surge is simulated using an auto regressive model of order 1 with a realistic surge variance taking t spin 14 d allows the tides to be recovered within several cm after about 2t spin 28 d as expected fig b 1b the surges are almost unchanged by the filter after 28 d fig b 1c the sensitivity of the filter to different choices of κ is illustrated in fig b 1d as expected larger κ smaller t spin gives less accurate tides due to tidal leakage from the surge for the present application we found that t spin 14 d gives acceptable results without requiring an excessively long spin up time for the filter b 1 comparison of tidal nudging of sea level and current we now compare three nemo tidal runs subject only to gravitational forcing at the m 2 frequency both τ s and p a are set to zero run t is not nudged run tn is nudged to u in the momentum equation and run tn is nudged to η in the continuity equation table 1 to quantify the effect of the nudging the predictions of m 2 elevation are compared to tpxo8 observations section 2 the error is quantified by the magnitude of the difference in the complex m 2 amplitude z of the observations and the colocated model predictions z o b s z m o d this allows for errors in the timing and amplitude of the predicted tide following katavouta et al 2016 the error in tidal current is quantified by b 1 γ 2 0 p u o b s t u m o d t 2 d t 0 p u o b s t 2 d t where p is the period of m 2 and u o b s t and u m o d t are time varying m 2 tidal current vectors calculated from the observed and modeled tidal amplitudes and phases smaller γ 2 indicates better model performance γ 2 combines errors in timing and also the length of the semi major axis eccentricity and orientation of the predicted tidal current ellipse the left panels of fig b 2 show that both forms of nudging result in significant improvements in m 2 tidal elevation over most of the global ocean the improvements are not confined to the deep water where the nudging is applied fig 1 improvements are also evident over the shelf e g north of australia mozambique channel and weddell sea we note the nudging is not perfect and a slight degradation does occur for example south of alaska for both forms of nudging relatively large errors remain in some regions e g north sea patagonia shelf east china sea hudson strait and hudson bay we speculate higher resolution is required in these regions appendix c overall nudging η is more effective than nudging u this is to be expected because run tn nudges η toward the tpxo8 tidal elevations the right panels of fig b 2 show both forms of nudging improve the predictions of m 2 tidal current the improvements are comparable in the northwest pacific and south atlantic ocean in the south pacific north atlantic and indian ocean nudging u outperforms nudging of η this is to be expected because run tn nudges u toward the tpxo8 tidal currents in addition to the tpxo8 data we use independent coastal sea level observations from the 304 tide gauges table a 1 to evaluate the two forms of nudging the rmse of tidal elevation predicted by run tn and run tn are plotted as a function of station code in fig b 3 the observed and predicted tides are based on the following tidal constituents m 2 s 2 n 2 k 2 o 1 k 1 p 1 and q 1 in order to resolve all eight constituents this evaluation was only applied to 289 out of the 304 tide gauges with at most 50 missing observations for 2008 the rmse is the standard deviation of the difference in the available observed and predicted hourly tides for 2008 in terms of rmse nudging of η and u both give an average rmse of 0 11 m tidal nudging of u is more effective than nudging of η at stations in the gulf of maine station code 99 101 and north of australia station code 194 195 based on the above statistical analysis and the lack of justification for violating the continuity equation we choose to nudge u in the present study appendix c sensitivity to model resolution three orca grids with a spacing of 1 4 orca025 1 12 orca12 and 1 36 orca36 are used to assess the impact of changing the horizontal resolution of the model these three grids have a southern limit of 77 south and exclude ice cavities in the southern ocean in contrast to the extended grid eorca12 used for the main set of runs table 1 the three grid sensitivity runs were all forced by gdrs forecasts of wind and air pressure the gravitational tidal potential was evaluated at the m 2 s 2 o 1 and k 1 tidal frequencies and tidal nudging was turned off the highest resolution bathymetry was interpolated to the coarser 1 4 and 1 12 grids given the high computational cost of running the model on the 1 36 grid approximately 16 and 600 times the cost of the 1 12 and 1 4 grids respectively all three sensitivity runs covered a period of only 120 days to avoid the effect of model spin up the analysis focused on the last 90 days of each run september 19 to december 18 2018 as a result of the shorter analysis period the number of observed twl records available for model evaluation dropped from 304 to 211 figs c 1 and c 2 the t tide package of pawlowicz et al 2002 was used to decompose observed and predicted twl into tides and surges the surges were obtained by removing the full tidal signal from twl and then applying a high pass filter t p 20 days to the tidal residual the tides were reconstructed based on the four constituents m2 s2 o1 and k1 used to force the model we focus first on the accuracy of the predictions of tidal elevation fig c 1 shows the change in rmse with grid spacing at the 211 tide gauges the overall skill in predicting the tide improves significantly when the grid spacing drops from 1 4 to 1 12 top panel the average rmse drops by 0 05 m equivalent to a relative drop of 20 the drop in rmse exceeds 0 30 m in regions with large tides e g gulf of st lawrence and bay of fundy north sea southeast asia and the patagonia shelf decreasing the grid spacing from 1 12 to 1 36 bottom panel leads to a smaller overall reduction of 0 01 m in average rmse although reductions of 0 20 0 60 m occur in the high tide regions mentioned above decreasing grid spacing does not improve the fit at all stations for example the rmse increases by 0 18 m at some gauges from the west coast of canada as the spacing decreases from 1 12 to 1 36 bottom panel the accuracy of the surge predictions as a function of grid spacing is illustrated in fig c 2 overall the average rmse drops by only 4 on reducing the spacing from 1 4 to 1 12 top panel reductions in rmse of several cm are however evident in some regions most notably the east coast of north america reducing the grid spacing from 1 12 to 1 36 bottom panel leads to negligible changes in rmse 1 cm see bottom panel in agreement with bernier and thompson 2015 it is important to note that the evaluation of the surge predictions is being performed at tide gauges exposed to the open ocean section 2 much larger improvements in skill with increasing model resolution are to be expected at locations influenced by local variations in coastline and bathymetry based on the above sensitivity runs we reject the 1 4 grid spacing given its poor performance in predicting both tide and surge given the relatively small increase in skill and 16 fold increase in run time that results from decreasing the grid spacing of 1 12 to 1 36 we will focus on 1 12 this will allow the development of an effective 1 12 ensemble prediction system that can generate a 16 member ensemble of twl predictions for about the same computational cost as a single run of the 1 36 model this system will provide assessments of uncertainty for both operational and climate based applications section 1 including the issuance of probabilistic forecasts of coastal flooding bernier and thompson 2015 
23872,precipitation affects upper ocean salinity and temperature over a wide range of temporal and spatial scales although the effects of freshwater on the diurnal mixing and formation of barrier layer have been shown in previous studies the impacts of freshwater from the large scale precipitation associated with the madden julian oscillation mjo on the ocean from the western to central eastern pacific are not well understood this study investigates the coupling of precipitation evaporation and salinity p e s and its impact on the upper ocean stratification and momentum on time scales from days to weeks intraseasonal and beyond the unified wave interface coupled model uwin cm is used to simulate multiscale air sea interactions during january july 2018 including multiple mjo events leading up to the onset of the 2018 2019 el niño the atmospheric component of the uwin cm is constrained by reanalysis and reinitialized daily while the ocean component evolves continuously and is fully coupled with the atmosphere the initial and lateral boundary conditions for the atmosphere and ocean are from the ecmwf era5 and hycom global analysis respectively the uwin cm simulation captures the surface winds rainfall and the evolution of the upper ocean compared with in situ and satellite observations to determine the effect of p e s coupling the uwin cm simulation with full p e s coupling is compared with a model experiment in which the p e input to the ocean is set to zero nope the difference between the two increases with time and becomes particularly large during the 3rd mjo event in april 2018 two key results emerge first heavy precipitation and strong winds from the mjo events result in a locally fresher warmer western pacific warm pool with a shallower mixed layer and thicker barrier layer second the fresh warm water mass extends into the central eastern pacific from mid april to late may with up to 0 5 m s 1 eastward currents a well defined salinity density front propagating eastward at about 0 3 m s 1 is located at the leading edge of the warm pool the p e s coupling plays an important role in the eastward extension of the warm pool prior to the onset of el niño in july 2018 keywords air sea interaction precipitation evaporation salinity coupled models pacific ocean 1 introduction the upper ocean is a key player in earth s hydrological cycle around 77 of global precipitation and 85 of evaporation occur over the ocean durack 2015 schanze et al 2010 schmitt 2008 1995 upper ocean salinity is modulated by the net difference of precipitation minus evaporation henceforth p e p e affects upper ocean salinity and stratification on time scales form diurnal to interannual evaporation is always present and it is nearly proportional to the surface wind speed fig 1a and the atmospheric moisture relative to saturation conditions at the air sea interface fairall et al 2003 1996 in contrast precipitation is episodic and is associated with distinct weather systems on time scales from convective 1 h mesoscale and diurnal 1 24 h and synoptic 2 7 days to subseasonal e g the mjo and interannual e g enso regions that frequently experience heavy precipitation such as the western pacific warm pool and the intertropical convergence zone are dominated by positive p e while regions that have little precipitation like the equatorial central and eastern pacific are evaporation dominated fig 1b where p e is positive negative the upper ocean salinity tendency is negative positive and the upper ocean tends to be fresher saltier all else being equal this results in a zonal salinity gradient in the equatorial pacific ocean e g fig 1d the madden julian oscillation mjo is the dominant mode of subseasonal intraseasonal e g 20 90 day atmospheric variability in the tropics madden and julian 1994 1972 1971 zhang 2005 active mjo events are associated with large scale thousands of km eastward propagating convection and enhanced westerly winds near the equator spanning up to 20 000 km hendon and salby 1994 knutson and weickmann 1987 rui and wang 1990 salby and hendon 2002 zhang and hendon 1997 the mjo precipitation is limited to the western pacific warm pool where ssts are sufficient 26 c for sustained deep convection in between the active mjo periods suppressed periods with lighter precipitation and trade wind easterlies occur the mjo affects the upper ocean via momentum fluxes thermal fluxes and fresh water fluxes gautier et al 1998 jones et al 1998 krishnamurti et al 1988 lau and sui 1997 the impact of the mjo on the upper ocean tends to be greatest during the active mjo in pre el niño periods mcphaden et al 2006 seiki et al 2009 zhang and gottschalck 2002 the mjo induces sst warming which often coincides with the pacific warm pool eastward extension wpee prior to onset of el niño as observed by jauregui and chen 2021 the upper ocean response to the mjo can be separated into the local mixed layer response and the remote upper ocean response the local response is determined by a combination of local surface fluxes advection and entrainment at the base of the mixed layer the remote response depends on upper ocean dynamics the mjo westerlies drive a westerly surface current of o 1 m s 1 near the surface referred to as the yoshida wyrtki jet which is discernible up to 100 below the surface and partially cancels the equatorial undercurrent moum et al 2014 wyrtki 1973 yoshida 1959 advection of heat and salt by mixed layer currents plays a significant role in addition to enthalpy fluxes and p e feng et al 2000 fresh salinity pools generated by mjo heavy precipitation can be advected by the yoshida wyrtki jet and affect the mixed layer structure far from where the rain initially occurred you 2002 ocean kelvin waves are another source of possible impacts far from the precipitation and they are believed to be linked to el niño onset gasparin and roemmich 2017 kessler and kleeman 2000 kessler et al 1995 maes et al 2002 vialard et al 2001 zhao et al 2019 though there is some debate as to the importance of kelvin waves compared with more localized advection features related to strong westerly wind events drushka et al 2015 over the tropical pacific an upper ocean structure in which the halocline is located above the thermocline often occurs in this situation the mixed layer depth is determined by the vertical salinity gradient rather than temperature and the layer between the halocline and the thermocline is referred to as a barrier layer godfrey and lindstrom 1989 lukas and lindstrom 1991 sprintall and tomczak 1992 in the presence of a barrier layer the ocean mixed layer is shallower and more sensitive to solar radiation heating and it is shielded from entrainment of cooler water due to mixing at the base of the mixed layer due to the potential for mixed layer warming due to an enhanced barrier layer barrier layers are one factor linked to the onset of el niño maes et al 2006 2002 maes and belamari 2011 in addition to p e forcing subduction of high salinity water from the central pacific beneath the lower salinity warm pool water has been hypothesized to be a factor near the eastern edge of the warm pool lukas and lindstrom 1991 picaut et al 1996 another process thought to be involved is the tilting and shearing of the upper ocean into fresh equatorial jets due to eastward currents and westerly surface winds in the presence of strong horizontal density gradients cronin and mcphaden 2002 roemmich et al 1994 due to limited high density high frequency e g hourly upper ocean observations especially for salinity model simulations can help to clarify the coupled influences between the mjo el niño and the upper ocean stratification some coupled model simulations for the tropical pacific wpee have used mixed layer models shinoda and hendon 1998 and global climate models maes et al 2002 however climate models are not suitable for determining the importance of p e during individual mjo events and onset of el niño events high resolution regional coupled atmosphere and ocean models can better capture the detailed processes affecting the air sea interface and the ocean mixed layer on time scales from hours to months several recent studies have taken this approach for the tropical indian ocean komaromi et al 2019 li et al 2013 shinoda et al 2013 to address these issues direct p e to salinity coupling referred to henceforth as p e s coupling described in section 2 2 has been implemented in the unified wave interface coupled model uwin cm a fully coupled regional model system with atmosphere wave and ocean components chen and curcic 2016 li et al 2019 the coupled model simulation is from january to july 2018 during which multiple mjo events occurred and led up to the onset of the 2018 2019 el niño in july 2018 noaa cpc https origin cpc ncep noaa gov products analysis monitoring ensostuff oni v5 php fig 2 comparisons are made with a model experiment without the p e coupling the remainder of this article is organized as follows section 2 describes the model simulation and data sets used for comparison with the model section 3 describes the evolution of mjo events and related upper ocean variability in observations and the model runs section 4 focuses on the differences between uwin cm and nope finally conclusions are given in section 5 2 observational data and models 2 1 data 2 1 1 satellite data satellite data provide the best spatial and temporal coverage for precipitation surface wind speed and surface oceanographic fields over the pacific ocean remote sensing systems rss has developed the cross calibrated multiplatform ccmp a 6 hourly vector surface wind dataset at quarter degree spatial resolution atlas et al 2011 the ccmp uses era interim analysis as a background first guess and it incorporates wind data from amsr e amsr2 tmi gmi quikscat ascat ssmi ssmis and windsat it also incorporates moored buoy wind data nasa s integrated multi satellite retrievals for gpm imerg product provides near global e g full coverage from 60 s to 60 n half hourly rainfall estimates at 0 1 deg spatial resolution derived from multiple passive microwave and infrared sensors in low earth orbit liu et al 2017 the large scale mean conditions based on these products for the study period are shown in fig 1a b 2 1 2 global ocean forecasting system analysis the global ocean forecasting system gofs 3 1 hycom global analysis metzger et al 2014 is used in this study for two purposes 1 it provides boundary conditions for the ocean model component and 2 it is used for validation of the model surface salinity and upper ocean stratification the gofs 3 1 analysis is produced by the hycom consortium a multi institutional effort sponsored by the national ocean partnership program nopp as part of the u s global ocean data assimilation experiment godae fig 1c and d illustrate the large scale horizontal ocean surface structure from gofs3 1 for the study period gofs 3 1 uses a configuration of hycom version 2 2 99 as a global model at 0 08 spatial resolution and 41 vertical levels there are 14 fixed coordinate z levels within the top 84 m of the ocean and the remainder are hybrid coordinate levels the thickness of the top layer is 0 3 m the global hycom grid is on a mercator projection from 78 64 s to 47 n and north of this it employs an arctic dipole patch where the poles are shifted over land to avoid a singularity at the north pole the spatial resolution resolves mesoscale eddies and is sufficient to directly simulate western boundary currents mesoscale variability and the position and sharpness of ocean fronts the model is forced by the operational us navy global environmental model navgem gofs 3 1 reads in 10 m winds and uses a bulk parameterization to calculate the wind stress using hycom sst top layer temperature and taking into account hycom surface currents and surface pressure unlike uwin cm the gofs is not a coupled model system wind stress and radiative forcing from navgem are used however p e from navgem is not directly used in gofs the thermal fluxes and evaporation feedback to salinity are calculated based on the sst and surface salinity is adjusted to climatology using newtonian relaxation except that relaxation is turned off when the sss differs by more than 0 5 psu from the climatology e g rivers and areas with strong advection shortwave and longwave radiation are forced from navgem using the monthly seawifs chlorophyl climatology for turbidity kara et al 2005a b gofs 3 1 uses the one dimensional k profile parameterization kpp scheme for vertical mixing large et al 1994 to keep the hycom analysis close to observations incremental updating of the hycom state variables is carried out using the operational navy coupled ocean data assimilation ncoda system cummings 2006 cummings and smedstad 2013 the assimilation system is a 3d variational method using the previous 24 h forecast valid at 1200 utc as the first guess with an incremental update window from 0900 utc to 1200 utc the ncoda analysis window is 96 h for in situ profile data and 120 h for satellite altimeter data the gofs 3 1 forecasts are initialized daily at 1200 utc this study uses the first 24 h of each forecast assimilation cycle at 3 h intervals observations included for data assimilation include satellite altimetry satellite estimated sst ship observations argo floats and fixed and drifting buoy observations vertical profiles of temperature and salinity are assimilated from xbts ctds and buoys this data assimilation is also carried out in the ocean component not in the coupled mode 2 2 uwin cm and design of model experiments 2 2 1 model configuration for this study the uwin cm has been configured based on the coupled atmosphere wave ocean modeling framework described by chen et al 2013 and chen and curcic 2016 to reduce computational cost for the long simulations the surface wave component is turned off in this study fig 3 shows the model domains used for this study both the atmosphere and ocean components of the simulation included the tropical pacific and extend to the subtropics the atmosphere component of uwin cm is the version 3 9 weather research and forecasting wrf model powers et al 2017 wrf is run at 12 km spatial resolution and 44 vertical levels it uses the yonsei university ysu boundary layer parameterization hong et al 2006 the new tiedtke cumulus parameterization zhang and wang 2017 and the wrf single moment 5 class wsm5 microphysics hong et al 2004 the ocean component hycom is based on the configuration of gofs 3 1 see section 2 1 2 except that the near surface salinity in hycom is directly coupled with the wrf precipitation rather than using one way forcing and newtonian relaxation for salinity the atmosphere ocean coupling was implemented as follows the atmosphere ran with a time step of 60 s and hycom ran with 240 s 6 min time steps atmosphere and ocean fields were exchanged at each ocean time step 6 min during each exchange the sst and surface currents were passed from the ocean to the atmosphere the wind stress net heat flux shortwave radiation and p ewere passed from the atmosphere to the ocean note that unlike gofs 3 1 the ocean and atmosphere feel consistent surface stress the wind stress τ was calculated in the wrf surface physics module using a parameterization based on coare3 5 edson et al 2013 to reduce the computational demand the modulation of stress by explicitly simulated surface waves described by chen and curcic 2016 is not included in this study as discussed in section 2 1 2 the shortwave radiation flux sw was distributed vertically through the upper ocean based on the monthly seawifs chlorophyl climatology enthalpy fluxes were modified from coare3 5 using the formulation from garratt 1992 radiative fluxes are passed to hycom directly from the wrf radiation schemes in order to study the importance of p e s coupling p e from wrf is passed directly to hycom every coupling time step 240 s the p e s coupling affects salinity in the top ocean layer by diluting concentrating the salt content when p e is positive negative 1 δ s 1 p e δ z s δ t where δ s is the salinity change in psu p e is precipitation minus evaporation in m s 1 s is the salinity in psu δ z is the top layer thickness e g 0 3 m and δ t is the hycom time step 240 s 2 2 2 ocean and atmosphere coupling one major challenge associated with realistic long e g 1 week regional atmosphere ocean coupled simulations is that the atmosphere tends to drift in the interior of the domain due to model errors and intrinsic predictability limits these errors would then be transmitted to the ocean via the coupling resulting in upper ocean errors which then feed back to the atmosphere e g bjerknes feedback bryan et al 1975 clement and seager 1999 deppenmeier et al 2016 liu et al 2016 manabe et al 1975 unfortunately coupled data assimilation is still a topic of research and restarting both components makes detailed dynamical and budget calculations over days to weeks difficult given the main focus of this study is on upper ocean stratification and momentum we use a novel approach in which the atmosphere is re initialized daily with a 12 h spin up period prior to the continuous ocean atmosphere coupling in uwin cm to be kept close to the atmospheric re analysis meanwhile the ocean model is run continuously without re initialization throughout the entire simulations the coupled simulation was carried out in daily cycles as follows the first run cycle was a 36 h coupled run from 0000 utc 21 january to 1200 utc 22 january subsequent run cycles consisted of 12 h uncoupled spin up runs followed by 24 h coupled run cycles for the spin up runs wrf was reinitialized at 0000 utc and constant sst the 12 z sst from the end of the previous coupled cycle was used for the lower boundary condition at ocean points this approach was taken so that the 1200 utc fields from the spin up run would be consistent with the 1200 utc sst then wrf was restarted from the end of the spin up period and coupling with hycom was activated the simulation then ran in atmosphere ocean coupled mode for 24 h for the ocean component hycom was initialized at 0000 utc 21 january and it was run as a continuous simulation coupled with the atmosphere without any reinitializations note that one disadvantage of the simulation approach taken in this study is that the atmospheric fields in the mainline simulation have a discontinuity each day at 1200 utc this precludes detailed dynamical and budget calculations spanning multiple days in the atmosphere though diurnal cycle analysis from 1200 utc to 1200 utc the following day e g diurnal cycle and mesoscale weather systems is still possible 2 3 experiment without p e s coupling nope in order to clarify the impact of p e s coupling an experimental run was conducted using a configuration of uwin cm without p e s coupling referred to as nope for the nope experiment the top ocean layer salinity source sink due to p e eq 1 was set to zero for all coupling times therefore upper ocean salinity was only affected by the hycom internal dynamics and vertical mixing note that the initial conditions reflect p e s coupling as they come from the hycom global analysis system the impact of p e s coupling was most evident 3 months into the runs when the nope experiment had lost the memory of the initial conditions because the nope experiment was run in atmosphere ocean coupled mode and the upper ocean evolved with different sst than uwin cm the surface winds in nope differed somewhat from uwin cm nevertheless the winds in nope were constrained by the daily re initialization of the atmosphere component in the same manner as uwin cm which kept the winds close to uwin cm e g bias of 0 05 m s 1 and standard deviation of 1 2 m s 1 relative to satellite estimates table 1 2 4 mixed layer depth and barrier layer upper ocean stratification is a reflection of atmospheric forcing and internal oceanic dynamics and mixing the influence of the atmosphere is felt throughout the mixed layer tens of meters to over a hundred meters in the tropics the portion of the upper ocean strongly influenced by the atmosphere due to turbulence mixing over days to weeks is referred to as the mixed layer however the entire mixed layer does not experience mixing at all times the portion of the upper ocean experiencing active mixing at a given time is the mixing layer the mixing layer can vary significantly throughout the day in particular with the diurnal cycle while the mixed layer is a time integrated reflection of the mixing layer brainerd and gregg 1995 de boyer montégut et al 2004 the mixing depth determined by the kpp parameterization in hycom is most representative of the mixing layer depth rather than the mixed layer depth as it reflects mixing at a single model time step therefore the mixed layer depth in this study was calculated offline using the hycom model output the threshold method was used to determine the mixed layer depth based on density and the isothermal layer depth from temperature in order to limit the influence of the diurnal cycle the density and temperature differences were taken with respect to the values at 10 m depth de boyer montégut et al 2004 the temperature threshold used is 0 2 c and the density threshold was taken to be the equivalent density based on the conditions at the reference depth de boyer montegut et al 2007 mignot et al 2007 the 0 2 ç equivalent density thresholds were determined independently at each grid point using the thermodynamic equation of seawater 2010 teos 10 finally the barrier layer was determined to be the difference between the isothermal layer and the mixed layer cronin and mcphaden 2002 lukas and lindstrom 1991 sprintall and tomczak 1992 3 observed and simulated conditions 3 1 observed conditions 3 1 1 background mean the large scale atmospheric and upper ocean structure in the pacific ocean tropics during the study period 21 january 21 july 2018 are summarized in this section the surface winds were dominated by the easterly trade winds of 4 6 m s 1 along the equator and up to 8 7 m s 1 east of hawaii fig 1a the strongest equatorial winds were found in the central pacific 6 m s 1 rainfall was concentrated over the western pacific warm pool e g 28 5 c marked by the solid contour in fig 1 the northern hemisphere intertropical convergence zone itcz at 5 10 n 165 e 80 w and the south pacific convergence zone 5 20 s 165 e 135 w fig 1b outside of these major precipitation regions evaporation dominated over precipitation and p e was negative with an absolute value proportional to the wind speed not shown sea surface temperatures were warmest in the western pacific warm pool 30 5 c with a secondary maximum over the eastern north pacific fig 1c there was a relative minimum in sst along the equator in the central and eastern pacific 25 c at 120 w due to upwelling induced by the easterly surface winds sea surface salinity was highest over the subtropical southeast pacific where there was little precipitation fig 1d surface salinity was relatively low over the heavy precipitation regions of the warm pool itcz and spcz along the equator the maximum salinity occurred near the date line where equatorial wind speeds and evaporation reached a maximum fig 1a 3 1 2 interseasonal and intraseasonal variability during the study period a series of intraseasonal wind precipitation events occurred fig 2 during each mjo event heavy precipitation occurred over the warm pool occurs in episodes spanning 2 5 weeks the events are marked mjo1 mjo2 mjo3 and mjo4 in fig 2 identified based on maxima of westerly winds and rainfall the mjo precipitation exhibited eastward propagation and was associated with westerly surface winds the westerly winds exceeded 5 m s 1 occur over the warm pool west of 150 e in mid february mid march to early april and late april during mjo2 mjo3 and mjo4 fig 2b due to the multiple successive mjo events the warm pool experienced predominantly westerly surface winds from the beginning of the study period in late january to 10 may 2018 after 10 may easterlies predominated though there were episodes of heavy rainfall and occasional westerly surface winds during 27 may 15 june and 30 june 20 july fig 2a b east of 170 e heavy rain episodes did not occur and surface winds were predominantly easterly nevertheless scattered rainfall occurred there after 17 july when the warm pool defined using the 28 5 c isotherm extended to east of the date line e g fig 2c the warm pool eastern edge shifted eastward from 170 e to 170 w during the study period fig 2c the inter seasonal eastward extension of the warm pool did not occur steadily in time but rather alternated between brief periods of abrupt eastward propagation followed by stagnation or even slow westward propagation the warm pool edge was close to climatology at the beginning of the study period but it was hundreds of km further east at the end a reflection of the onset of the 2018 el niño based on the noaa oceanic nino index oni noaa national oceanic and atmospheric administration 2021 the inter seasonal eastward extension of the warm pool was greater than what is expected due to the seasonal transition the periods of abrupt eastward propagation were associated with the mjo precipitation and wind events as described by jauregui and chen 2021 additionally within the warm pool sst cooling occurred due to the strong westerly winds and convective downdrafts in heavy precipitation associated with the mjo chen et al 2016 especially during 20 march 10 april and 1 10 may this is a well documented effect of the mjo on the upper ocean the western pacific warm pool is associated with heavy precipitation hence the surface salinity there is relatively low fig 1b d a fresh pool can be identified using the 34 6 psu surface salinity contour cravatte et al 2009 during the study period the eastern edge of the fresh pool edge was generally within a few hundred km of the eastern most mjo precipitation fig 2d since the intraseasonal precipitation events did not propagate as far eastwards in the second half of the period the fresh pool retreated 500 km westward nevertheless relatively fresh water of salinity 34 6 35 0 psu extended from 170 e to near the date line during the study period as the salinity gradient east of the fresh pool became less pronounced while there were periods of precipitation over the equatorial central pacific in late june july fig 2a the eastern portion of the warm pool can become fresher even with relatively weak local forcing from precipitation while the eastern edge of the fresh pool gradually retreated westwards following the inter seasonal trend in the easternmost influence of the mjo and other intraseasonal heavy precipitation events there is little coherence between the heavy precipitation events and surface salinity on the time scales of days weeks in the gofs analysis fig 2d this mainly reflects that the gofs analysis uses salinity relaxation to climatology rather than direct p e input from the navgem a coupled model simulation with fully explicit p e s coupling is better able to depict the relationship between precipitation events and surface salinity 3 2 uwin cm simulation generally the uwin cm simulation captured the mean atmosphere and ocean structure as well as the time evolution of the mjo events marked mjo1 mjo2 mjo3 and mjo4 and the intraseasonal rainfall events during the latter half of the simulation fig 4a b the uwin cm simulation is a realistic depiction of the coupled atmosphere ocean system and the average differences between the model and satellite estimates and gofs analysis over the study period were mainly within the measurement uncertainties of the fields except for wind speed which has a standard deviation difference of 1 5 m s 1 in the warm pool table 1a these errors gradually grew over the first 1 2 weeks of the model simulation then leveled off for the remainder of the run not shown similar to the imerg satellite estimates the uwin cm rainfall was concentrated in intraseasonal heavy rain episodes fig 4a the timing and eastward extent of the events were similar is similar to satellite estimates however the model produced more widespread and persistent moderate rain rates 1 mm h 1 while the imerg rainfall had less coverage but often reached 10 mm h 1 fig 2a despite these differences in instantaneous rain rates the mean rainfall in uwin cm was close to the imerg estimates table 1 surface winds correspond well with the satellite estimates figs 2b and 4b in particular the westerly winds associated with mjo1 mjo2 mjo3 and mjo4 this shows that the atmosphere component winds were effectively constrained by the daily re initialization of the atmosphere component sst in uwin cm evolved similar to observed with a few minor differences the warm pool edge in uwin cm was nearly stationary during 25 march 25 april whereas in observations there was an eastward shift in the warm pool around 3 5 april fig 4c also sst 30 c occurred more often in uwin cm than in the satellite estimates especially between 150 160 e during 21 january to 15 may the surface salinity in uwin cm followed the inter seasonal trend of the fresh pool retreat during the study period as in the gofs analysis however the fresh pool edge was more tightly tied to the eastward extent of the mjo precipitation events in uwin cm the evolution of surface salinity on time scale of days to weeks was significantly different than gofs distinct decreases in surface salinity occurred at longitudes from 145 160 e in uwin cm associated with mjo3 and mjo4 in uwin cm but not in gofs figs 2d and 4d the surface salinity was more directly tied to the mjo in uwin cm than in the gofs analysis 3 3 nope experiment in the nope experiment the atmosphere component was constrained in the same manner as in uwin cm hence the rain and surface winds evolved almost identically figs 4a b and 5a b however there were significant differences in the upper ocean between uwin cm and nope for the mean over the study period salinity deviations from gofs in nope were much larger than uwin cm for the 15 s 15 n band and the warm pool which includes the heavy precipitation regions of the itcz and the western pacific warm pool table 1 fig 1b notably the sst bias in uwin cm compared with gofs was nearly zero however in nope there was a cool negative bias in terms of sst the eastward extension of the warm pool in late june july was less than in uwin cm figs 4c and 5c significant differences in sst also occurred at smaller time and spatial scales as described below in terms of surface salinity the main difference was the collapse of the fresh pool as defined by 34 6 psu salinity in may july note that in january march the evolution of the edge of the fresh pool in nope is similar to uwin cm the differences in surface salinity between uwin cm and nope become most pronounced after 1 march within the fresh pool and 1 april elsewhere fig 6a this indicates that the coupled system maintained some memory of the initial large scale salinity structures for 2 months without the input from p e s coupling however after the accumulative effect of multiple wind precipitation events it is clear that the p e s coupling was essential to maintain the fresh pool the stratification of the western pacific warm pool and the zonal gradient of water density in the equatorial pacific while there was significant ocean eddy and wave variability overall the p e scoupling in uwin cm led to warming of the warm pool up to 0 0 5 and cooling east of the warm pool upwards of 1 c relative to nope fig 6b the westward propagating areas of alternating cooler and warmer sst in uwin cm east of the warm pool in march and april were related to tropical instability waves which propagated westward at slightly different speeds and became out of phase in the nope run compared with uwin cm the sst response was most evident after the mjo wind precipitation event in march mjo3 because salinity is strongly modulated by precipitation the influence of p e s coupling on the inter seasonal trend in sst is tied to the mjo these changes in the sst and associated changes to the sst gradients can in turn feed back to the atmosphere rainfall and surface winds fig 6c d which are consistent with previous studies e g chen et al 2001 while these feedbacks were suppressed by re initializing the atmosphere model daily in this study it shows that p e s coupling does not merely affect the upper ocean salinity locally and that there are remote effects of p e s coupling the remainder of this study focuses on several specific ways in which the influence of p e s coupling occurs due to the memory of the initial conditions which include p e s coupling the impacts of p e s coupling are most evident during the second half of the study period e g 20 april 21 july therefore we focus on the second half this includes mjo4 in april the post mjo period in may and the eastward extension of the warm pool to east of the date line in june july 4 local and remote impact of p e s coupling on the upper ocean 4 1 upper ocean stratification and sst over the warm pool the difference between the uwin cm simulation nope is a metric for the role of the p e s coupling in the uwin cm atmosphere ocean coupled system as shown in fig 6a the direct local influence of p e s coupling is to reduce the upper ocean salinity in the heavy precipitation region which is mainly west of 160 165 e fig 7 illustrates the evolution of surface atmosphere and ocean fields mixed layer and barrier layer structure in uwin cm and nope in the heart of the western pacific warm pool and within the fresh pool this location was directly affected by the westerly winds associated with mjo4 westerly mjo winds occurred through 8 may then the easterly trades returned fig 7a the westerly winds reached a maximum of 7 m s 1 during the mjo event the wind difference between uwin cm and nope were o 0 1 m s 1 table 1 which would not result in significant differences in the wind stress between the runs precipitation associated with the mjo event occurred from 22 april to 11 may fig 7b surface salinity was nearly 0 5 psu lower in uwin cm during and after the mjo passage during many days with heavy rainfall there was a short term drop in salinity of o 0 1 psu in contrast in nope the surface salinity increased somewhat during the mjo event sst is not directly affected by p e s coupling in this study however it can be indirectly impacted through changes in the upper ocean stratification and mixed layer depth sst was mainly within 29 5 c 30 5 c during 20 april 20 may fig 7c in both uwin cm and nope the sst had a small diurnal cycle when wind speeds were 5 m s 1 such as 29 april 2 may and a diurnal amplitude of 0 5 c during lighter winds for example 13 17 may sst decreased 0 5 c during the mjo event in nope from 29 april to 8 may however in uwin cm the sst cooling experienced at this location during the same period was 0 3 c with less cooling in uwin cm the sst was 0 2 c warmer than nope why did sst cool more in nope this is related to the local changes in mixed layer depth and the barrier layer induced by the heavy mjo precipitation fig 7d the mixed layer was 10 20 m shallower in uwin cm compared with nope from 23 april to 14 may which is during the time period where the sst differences became more pronounced fig 7b furthermore while a barrier layer was present in both runs it was much thicker in uwin cm fig 7d e in the presence of a thicker barrier layer it was more difficult to draw the cooler water up from the thermocline via mechanical mixing during period that the upper ocean was subjected to the mjo winds note that the sst differences persisted even in the post mjo period when the barrier layer in uwin cm was nearly eroded and the mixed layer depth was similar in uwin cm and nope e g 14 20 may fig 7b d e with the shallower mixed layer in uwin cm the diurnal insolation could more effectively warm the mixed layer helping to maintain the relatively warmer sst in uwin cm in summary the local impact of p e s coupling over the warm pool is that precipitation lowers the mixed layer stability resulting in a shallower mixed layer and the enhancement of the barrier layer which helps to shield the mixed layer from mechanical wind induced mixing during the high wind 5 m s 1 periods of the mjo 4 2 remote influence of p e s coupling along the salinity front as shown in fig 6a the direct effect of p e s coupling was to freshen the upper ocean where precipitation occurs and to increase the salinity where there was little precipitation and evaporation dominates this increased the zonal salinity gradient in the eastern part of the warm pool east of 160 e it is important to point out that this region did not feel the direct wind and precipitation forcing from the mjo and yet it is where the eastward extension of the warm pool leading up to the 2018 el niño event occurred since the uwin cm was significantly warmer there than nope between 160 e and the eastern edge of the warm pool in may july fig 6b it is clear that p e s coupling had a remote influence there the remote influence of p e scoupling on the eastern portion of the warm pool is illustrated by the time series centered at 0 n 165 e along the salinity front fig 8 this location did not experience westerly winds and heavy precipitation associated with mjo4 rather the area experienced easterly winds from 20 april through 1 june fig 8a despite the dominance of evaporation e g negative p e there was a significant reduction in salinity during 29 april 8 may in both uwin cm and nope fig 8b this reduction in salinity was 0 7 psu in uwin cm and 0 4 psu in nope it was associated with the eastward propagation of the salinity front e g 35 0 psu in uwin cm from 162 e on 13 april to 167 e on 22 may fig 4d 9a 9d and 9g in nope there was no strong sst front passage at this location during the same time period figs 5d 10a d and g prior to the passage of the salinity front uwin cm and nope had similar ssts fig 8c afterwards uwin cm became warmer than nope reaching a difference of 0 5 c on 18 may the eastward propagation of the salinity front coincided with an eastward shift in the warmest water in the core of the western pacific warm pool fig 4c as shown in fig 6b the warmer sst in 160 165 e in uwin cm compared with nope was maintained through the end of the study period 21 july clearly the passage of the salinity front in uwin cm contributed to the large scale eastward shift in the warm pool and the inter seasonal trend of increasing sst in the vicinity of 165 e the eastward propagation of the salinity front in uwin cm was associated with not only the salinity gradient but also an abrupt shift in zonal currents in the mixed layer and mixed layer temperature gradients fig 9 on 20 april the fresh pool edge defined using 34 6 psu was located at 158 e and the leading edge of the salinity front 35 0 psu was at 162 e fig 9a the 34 6 psu water was mainly confined to within the mixed layer the halocline i e 34 6 35 0 psu was located below the mixed layer at this time the warm pool was under the influence of the mjo westerlies which extended to 165 5 e east of the salinity front fig 9a nevertheless zonal currents in the upper 150 m were predominantly directed towards the west in to the mjo westerly winds at up to 0 8 m s 1 the exception was within 159 162 e in the top 20 30 m where eastward currents of 0 1 m s 1 occurred in the mixed layer fig 9b the relatively shallow mixed layer 20 m near the salinity front may have aided in trapping the eastward momentum flux from the atmosphere and shifting the currents to eastward there within the mixed layer a horizontal temperature gradient was also present near the salinity front and the region with the mixed layer eastward currents fig 9c this temperature gradient was between the 30 c water in mixed layer at the core region of the warm pool 146 159 e and the eastern edge of the warm pool 28 5 c at 169 e by 1 may the mjo westerlies had retreated to 159 e however the salinity front had shifted several degrees longitude to the east to 164 e fig 9d additionally the eastward currents at the salinity front had intensified to 0 5 m s 1 and the mixed layer equatorial eastward currents had spread to cover 153 164 5 e over 1000 km fig 9e finally the 30 c water in the core of the warm pool shifted 280 km to the east to 161 5 e though the warm pool edge retreated to 168 e fig 9f on 11 may the easterly trade winds had returned to the warm pool fig 4b the trade winds dominated the warm pool area on 17 may fig 9g nevertheless by 17 may the salinity front eastward zonal currents and the 30 c water of the warm pool had shifted further east eastern edge of 30 c water to 164 e against the trade winds fig 9g h and i the salinity front reached 168 e and the warm pool edge shifted back to 169 e both the salinity gradient and temperature gradient would contribute to setting up a mixed layer density gradient which tends to propagate eastward as a density current this evolution resembles the phenomenon of fresh equatorial jets roemmich et al 1994 meanwhile within 147 159 e in the heart of the warm pool and fresh pool the mixed layer currents had turned back to westward with lingering eastward currents remaining 20 30 m below the mixed layer depth in contrast to uwin cm in nope the zonal salinity gradients are much weaker and a distinct eastward propagating eastward current jet did not occur fig 10 on 20 april nope had higher salinity 34 6 35 0 psu versus 34 2 34 8 psu west of 160 e figs 9a and 10a and a somewhat smaller warm pool figs 9c and 10c the warm pool salinity in nope subsequently increased figs 10d and 10g which is consistent with the overall increasing trend of salinity in nope west of 160 e fig 5d unlike in uwin cm there were no eastward currents at the eastern edge of the warm pool in nope in part because the mixed layer was deeper around 40 50 m fig 10b by 1 may 2018 the westward currents were weakened by the mjo westerly winds and eastward currents occurred over a limited area 157 5 160 1 e at the eastern edge of the mjo westerlies where the mixed layer was relatively shallow 40 m fig 10e by 17 may these mjo induced eastward currents were no longer present fig 10e there was an eastward shift in the 30 c warm pool water in nope to 162 e by 1 may fig 10f however there was no further eastward propagation by 18 may and but it did not result in nearly as much warming near 165 e compared with uwin cm fig 10i the contrasting evolution of uwin cm versus nope near the salinity front is illustrated in terms of difference fields in fig 11 because the salinity front was weaker in nope negative positive salinity differences were seen west east of the uwin cm salinity front location fig 11a e these salinity differences were greatest above the uwin cm mixed layer depth solid black curve though uwin cm was at times fresher than nope well below the mixed layer down to 80 m depth west of the front e g fig 11b and e co located with the salinity differences at the salinity front there were differences in the zonal currents fig 11f j and temperature fig 11k o generally where the salinity difference was negative positive the zonal currents were more eastward westward and the temperatures were warmer cooler these differences were most pronounced within the uwin cm mixed layer the largest fresh salinity anomalies 0 4 psu were located over the warm pool where the heaviest precipitation occurs west of 160 e fig 11a e in contrast the warmest water temperature anomalies 0 5 c were located on the west side of the salinity front with significant cool anomalies 0 4 c on the east side of the front by 17 may 2018 fig 11k o these warm anomalies were displaced 500 800 km east of the largest fresh anomalies over the warm pool this illustrates well the remote thermal response to the p e s coupling over the warm pool the evolution of the mixed layer depth was also very different between uwin cm and nope by the time the mjo westerly winds were retreating on 1 may the nope mixed layer depth 55 m was almost three times as deep as uwin cm 20 m to the west of the salinity front 163 165 e fig 11m later on 17 may there was a sharp drop in the mixed layer depth from 26 m to 60 m at the salinity front in uwin cm within 55 km near 168 e fig 11o in contrast nope produced a more gradual mixed layer deepening from 32 m to 50 m over 420 km 4 3 large scale redistribution and warm pool extension in addition to warming within the heart of the warm pool and near the salinity front in late june july the edge of the warm pool in uwin cm had shifted to 170 w while it was near the date line in nope figs 4d and 5d this was reflected by positive sst differences between uwin cm and nope of several deg c east of the dateline starting at 10 june 175 w is representative of this regime fig 12 this location was dominated by the easterly trade winds and evaporation fig 12a b despite being located well east of the fresh pool salinity front a salinity reduction of 0 3 psu occurred between 16 and 24 june in uwin cm but not in nope fig 12b it is at this time that the uwin cm sst became 0 5 c warmer than nope and the warmer sst persisted in uwin cm through the end of the study period fig 12c a thick barrier layer developed in uwin cm but not in nope fig 12d e which likely helped to maintain the warmer ssts against the mechanical mixing from 5 m s 1 trade winds unlike at 165 e there was no distinct current jet feature that could account for this evolution in uwin cm nevertheless the upper ocean temperature salinity and current structure is significantly different between uwin cm and nope fig 13 the warm sst associated with the eastward warm pool extension in uwin cm was relatively shallow fig 13a meanwhile the zonal salinity gradient was much weaker in nope reflecting the collapse of the fresh pool as defined by 34 6 psu salinity in nope fig 5d significantly there were eastward currents in the mixed layer spanning thousands of km in uwin cm but not in nope fig 13e f these mixed layer currents were in direct opposition to the easterly trade winds fig 13a they were persistent for several weeks in the uwin cm simulation not shown furthermore easterly currents below the mixed layer down to 150 m were generally stronger in uwin cm this suggests a large scale shift in the upper ocean which occurred more prominently in uwin cm than in nope while the specific causes of this are beyond the scope of this study the persistent wide swath of eastward currents in uwin cm would tend to advect the fresher warmer water across the zonal temperature gradients which contributed to the greater eastward extension of the warm pool in uwin cm in good agreement with observations figs 2c and 4c the role of a large scale transition to eastward upper ocean currents in the western pacific has also been emphasized for the 2015 2016 el niño gasparin and roemmich 2016 the scattered precipitation over the central pacific after 17 june may also have contributed to reducing the salinity there these results show that p e s coupling is needed to capture the inter seasonal shift of the warm pool beyond what was expected from climatology in the lead up to the 2018 el niño event 5 summary and conclusions a novel coupled atmosphere ocean modeling approach has been used to study the impact of p e s coupling on the upper ocean structure and stratification and momentum in the tropical western pacific warm pool and in the equatorial central pacific ocean p e s coupling impacts the upper ocean on time scales ranging from 1 h to intraseasonal and inter seasonal and there are both local and remote impacts uwin cm with daily re initialized atmosphere captured well the upper ocean evolution during multiple consecutive mjo events spanning 6 months 21 january 21 july 2018 the impact of p e s coupling was determined by comparing the fully coupled uwin cm with a nope experiment where p e input to the ocean eq 1 was set to zero compared to nope the uwin cm simulation had lower salinity west of 160 165 e where the most mjo precipitation occurred salinity was higher in uwin cm further east in the central pacific where evaporation dominated the most direct impact of p e s coupling is to maintain the large scale western pacific fresh pool and the zonal salinity and density gradients however the impact of p e s coupling is not limited to the local p e effects on surface and mixed layer salinity rather p e s coupling affects the mixed layer in several ways and at multiple temporal and spatial scales which supported the eastward extension of the warm pool during the onset of the 2018 el niño event in uwin cm the difference between the uwin cm and nope simulations were most significant during the latter half of the study period starting with mjo4 figs 4 5 and 6 there were local and rempte impacts of p e coupling on sst in uwin cm which did not occur in nope first locally over the warm pool the mixed layer became 10 20 m shallower during mjo4 and a thick barrier layer developed which shielded the warm pool from cooling due to mjo strong wind events fig 7 additionally there were remote effects as a remote effect near the salinity front the fresh warm water propagated eastward after mjo4 in april in uwin cm as a fresh equatorial jet with eastward currents of 0 5 m s 1 which persisted for weeks after the initial mjo westerly wind forcing carrying the warmer fresher water eastward figs 8 11 finally by late june july a large scale readjustment had occurred throughout the equatorial western and central pacific resulting in a broad swath of eastward currents spanning thousands of km which helped to push the warm pool edge to east of the date line figs 12 and 13 the air sea interaction associated with the p e scoupling has a significant impact on the sst and sst gradient which induced a feedback effect on the atmosphere component s rainfall and surface winds however because the atmosphere is constrained by the reanalysis in this study this feedback may not have been fully realized long range 1 month regional and climate model coupled simulations and or forecasts may face potential challenges if p e s coupling is not well represented or constrained by observations in these models this presents a particular challenge in light of rainfall biases in many atmospheric models it is expected that data assimilation in the coupled model system can help mitigate some of the bias introduced due to the atmospheric model rainfall this requires high temporal and spatial resolution salinity data in the top few meters of the ocean it is expected that the tropical pacific observing system tpos smith et al 2019 will help to improve the analysis and modeling of p e s coupling and its effects on the mjo and enso note that the commonly used method of relaxing surface salinity to climatology may preserve the long term climate but based on the results of this study it would not be sufficient to depict the upper ocean response and atmosphere coupling on sub seasonal time scales such as the mjo events and it would likely be limited in reflecting the inter seasonal shift of the warm pool in the lead up to el niño events this coupled atmosphere ocean modeling study shows that multiscale air sea interactions associated with the mjo and p e s coupling on both localized and large scale zonal current advection may have played an important role in the intraseasonal to interseasonal eastward extension of the warm pool in the 2018 2019 el niño a study is currently under way to further quantify how the warm pool eastward extension occurred leading up to the onset of the 2018 2019 el niño in the uwin cm simulation and observations credit authorship contribution statement brandon w kerns methodology software validation formal analysis visualization data curation writing original draft writing review and editing shuyi s chen supervision of model and data analysis project administration resources funding acquisition writing review and editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank yakelyn r jauregui ajda savarin and dalton kai sasaki of the university of washington for their input during the course of this study two anonymous reviewers comments and suggestions help improve the manuscript this study was supported by the noaa cvp tropical pacific observing system tpos program under the research grant na18oar4310401 it is a part of collaborative project with meghan cronin and dongxiao zhang of noaa pmel microwave oi sst data are produced by remote sensing systems and sponsored by national oceanographic partnership program nopp and the nasa earth science physical oceanography program data are available at www remss com 
23872,precipitation affects upper ocean salinity and temperature over a wide range of temporal and spatial scales although the effects of freshwater on the diurnal mixing and formation of barrier layer have been shown in previous studies the impacts of freshwater from the large scale precipitation associated with the madden julian oscillation mjo on the ocean from the western to central eastern pacific are not well understood this study investigates the coupling of precipitation evaporation and salinity p e s and its impact on the upper ocean stratification and momentum on time scales from days to weeks intraseasonal and beyond the unified wave interface coupled model uwin cm is used to simulate multiscale air sea interactions during january july 2018 including multiple mjo events leading up to the onset of the 2018 2019 el niño the atmospheric component of the uwin cm is constrained by reanalysis and reinitialized daily while the ocean component evolves continuously and is fully coupled with the atmosphere the initial and lateral boundary conditions for the atmosphere and ocean are from the ecmwf era5 and hycom global analysis respectively the uwin cm simulation captures the surface winds rainfall and the evolution of the upper ocean compared with in situ and satellite observations to determine the effect of p e s coupling the uwin cm simulation with full p e s coupling is compared with a model experiment in which the p e input to the ocean is set to zero nope the difference between the two increases with time and becomes particularly large during the 3rd mjo event in april 2018 two key results emerge first heavy precipitation and strong winds from the mjo events result in a locally fresher warmer western pacific warm pool with a shallower mixed layer and thicker barrier layer second the fresh warm water mass extends into the central eastern pacific from mid april to late may with up to 0 5 m s 1 eastward currents a well defined salinity density front propagating eastward at about 0 3 m s 1 is located at the leading edge of the warm pool the p e s coupling plays an important role in the eastward extension of the warm pool prior to the onset of el niño in july 2018 keywords air sea interaction precipitation evaporation salinity coupled models pacific ocean 1 introduction the upper ocean is a key player in earth s hydrological cycle around 77 of global precipitation and 85 of evaporation occur over the ocean durack 2015 schanze et al 2010 schmitt 2008 1995 upper ocean salinity is modulated by the net difference of precipitation minus evaporation henceforth p e p e affects upper ocean salinity and stratification on time scales form diurnal to interannual evaporation is always present and it is nearly proportional to the surface wind speed fig 1a and the atmospheric moisture relative to saturation conditions at the air sea interface fairall et al 2003 1996 in contrast precipitation is episodic and is associated with distinct weather systems on time scales from convective 1 h mesoscale and diurnal 1 24 h and synoptic 2 7 days to subseasonal e g the mjo and interannual e g enso regions that frequently experience heavy precipitation such as the western pacific warm pool and the intertropical convergence zone are dominated by positive p e while regions that have little precipitation like the equatorial central and eastern pacific are evaporation dominated fig 1b where p e is positive negative the upper ocean salinity tendency is negative positive and the upper ocean tends to be fresher saltier all else being equal this results in a zonal salinity gradient in the equatorial pacific ocean e g fig 1d the madden julian oscillation mjo is the dominant mode of subseasonal intraseasonal e g 20 90 day atmospheric variability in the tropics madden and julian 1994 1972 1971 zhang 2005 active mjo events are associated with large scale thousands of km eastward propagating convection and enhanced westerly winds near the equator spanning up to 20 000 km hendon and salby 1994 knutson and weickmann 1987 rui and wang 1990 salby and hendon 2002 zhang and hendon 1997 the mjo precipitation is limited to the western pacific warm pool where ssts are sufficient 26 c for sustained deep convection in between the active mjo periods suppressed periods with lighter precipitation and trade wind easterlies occur the mjo affects the upper ocean via momentum fluxes thermal fluxes and fresh water fluxes gautier et al 1998 jones et al 1998 krishnamurti et al 1988 lau and sui 1997 the impact of the mjo on the upper ocean tends to be greatest during the active mjo in pre el niño periods mcphaden et al 2006 seiki et al 2009 zhang and gottschalck 2002 the mjo induces sst warming which often coincides with the pacific warm pool eastward extension wpee prior to onset of el niño as observed by jauregui and chen 2021 the upper ocean response to the mjo can be separated into the local mixed layer response and the remote upper ocean response the local response is determined by a combination of local surface fluxes advection and entrainment at the base of the mixed layer the remote response depends on upper ocean dynamics the mjo westerlies drive a westerly surface current of o 1 m s 1 near the surface referred to as the yoshida wyrtki jet which is discernible up to 100 below the surface and partially cancels the equatorial undercurrent moum et al 2014 wyrtki 1973 yoshida 1959 advection of heat and salt by mixed layer currents plays a significant role in addition to enthalpy fluxes and p e feng et al 2000 fresh salinity pools generated by mjo heavy precipitation can be advected by the yoshida wyrtki jet and affect the mixed layer structure far from where the rain initially occurred you 2002 ocean kelvin waves are another source of possible impacts far from the precipitation and they are believed to be linked to el niño onset gasparin and roemmich 2017 kessler and kleeman 2000 kessler et al 1995 maes et al 2002 vialard et al 2001 zhao et al 2019 though there is some debate as to the importance of kelvin waves compared with more localized advection features related to strong westerly wind events drushka et al 2015 over the tropical pacific an upper ocean structure in which the halocline is located above the thermocline often occurs in this situation the mixed layer depth is determined by the vertical salinity gradient rather than temperature and the layer between the halocline and the thermocline is referred to as a barrier layer godfrey and lindstrom 1989 lukas and lindstrom 1991 sprintall and tomczak 1992 in the presence of a barrier layer the ocean mixed layer is shallower and more sensitive to solar radiation heating and it is shielded from entrainment of cooler water due to mixing at the base of the mixed layer due to the potential for mixed layer warming due to an enhanced barrier layer barrier layers are one factor linked to the onset of el niño maes et al 2006 2002 maes and belamari 2011 in addition to p e forcing subduction of high salinity water from the central pacific beneath the lower salinity warm pool water has been hypothesized to be a factor near the eastern edge of the warm pool lukas and lindstrom 1991 picaut et al 1996 another process thought to be involved is the tilting and shearing of the upper ocean into fresh equatorial jets due to eastward currents and westerly surface winds in the presence of strong horizontal density gradients cronin and mcphaden 2002 roemmich et al 1994 due to limited high density high frequency e g hourly upper ocean observations especially for salinity model simulations can help to clarify the coupled influences between the mjo el niño and the upper ocean stratification some coupled model simulations for the tropical pacific wpee have used mixed layer models shinoda and hendon 1998 and global climate models maes et al 2002 however climate models are not suitable for determining the importance of p e during individual mjo events and onset of el niño events high resolution regional coupled atmosphere and ocean models can better capture the detailed processes affecting the air sea interface and the ocean mixed layer on time scales from hours to months several recent studies have taken this approach for the tropical indian ocean komaromi et al 2019 li et al 2013 shinoda et al 2013 to address these issues direct p e to salinity coupling referred to henceforth as p e s coupling described in section 2 2 has been implemented in the unified wave interface coupled model uwin cm a fully coupled regional model system with atmosphere wave and ocean components chen and curcic 2016 li et al 2019 the coupled model simulation is from january to july 2018 during which multiple mjo events occurred and led up to the onset of the 2018 2019 el niño in july 2018 noaa cpc https origin cpc ncep noaa gov products analysis monitoring ensostuff oni v5 php fig 2 comparisons are made with a model experiment without the p e coupling the remainder of this article is organized as follows section 2 describes the model simulation and data sets used for comparison with the model section 3 describes the evolution of mjo events and related upper ocean variability in observations and the model runs section 4 focuses on the differences between uwin cm and nope finally conclusions are given in section 5 2 observational data and models 2 1 data 2 1 1 satellite data satellite data provide the best spatial and temporal coverage for precipitation surface wind speed and surface oceanographic fields over the pacific ocean remote sensing systems rss has developed the cross calibrated multiplatform ccmp a 6 hourly vector surface wind dataset at quarter degree spatial resolution atlas et al 2011 the ccmp uses era interim analysis as a background first guess and it incorporates wind data from amsr e amsr2 tmi gmi quikscat ascat ssmi ssmis and windsat it also incorporates moored buoy wind data nasa s integrated multi satellite retrievals for gpm imerg product provides near global e g full coverage from 60 s to 60 n half hourly rainfall estimates at 0 1 deg spatial resolution derived from multiple passive microwave and infrared sensors in low earth orbit liu et al 2017 the large scale mean conditions based on these products for the study period are shown in fig 1a b 2 1 2 global ocean forecasting system analysis the global ocean forecasting system gofs 3 1 hycom global analysis metzger et al 2014 is used in this study for two purposes 1 it provides boundary conditions for the ocean model component and 2 it is used for validation of the model surface salinity and upper ocean stratification the gofs 3 1 analysis is produced by the hycom consortium a multi institutional effort sponsored by the national ocean partnership program nopp as part of the u s global ocean data assimilation experiment godae fig 1c and d illustrate the large scale horizontal ocean surface structure from gofs3 1 for the study period gofs 3 1 uses a configuration of hycom version 2 2 99 as a global model at 0 08 spatial resolution and 41 vertical levels there are 14 fixed coordinate z levels within the top 84 m of the ocean and the remainder are hybrid coordinate levels the thickness of the top layer is 0 3 m the global hycom grid is on a mercator projection from 78 64 s to 47 n and north of this it employs an arctic dipole patch where the poles are shifted over land to avoid a singularity at the north pole the spatial resolution resolves mesoscale eddies and is sufficient to directly simulate western boundary currents mesoscale variability and the position and sharpness of ocean fronts the model is forced by the operational us navy global environmental model navgem gofs 3 1 reads in 10 m winds and uses a bulk parameterization to calculate the wind stress using hycom sst top layer temperature and taking into account hycom surface currents and surface pressure unlike uwin cm the gofs is not a coupled model system wind stress and radiative forcing from navgem are used however p e from navgem is not directly used in gofs the thermal fluxes and evaporation feedback to salinity are calculated based on the sst and surface salinity is adjusted to climatology using newtonian relaxation except that relaxation is turned off when the sss differs by more than 0 5 psu from the climatology e g rivers and areas with strong advection shortwave and longwave radiation are forced from navgem using the monthly seawifs chlorophyl climatology for turbidity kara et al 2005a b gofs 3 1 uses the one dimensional k profile parameterization kpp scheme for vertical mixing large et al 1994 to keep the hycom analysis close to observations incremental updating of the hycom state variables is carried out using the operational navy coupled ocean data assimilation ncoda system cummings 2006 cummings and smedstad 2013 the assimilation system is a 3d variational method using the previous 24 h forecast valid at 1200 utc as the first guess with an incremental update window from 0900 utc to 1200 utc the ncoda analysis window is 96 h for in situ profile data and 120 h for satellite altimeter data the gofs 3 1 forecasts are initialized daily at 1200 utc this study uses the first 24 h of each forecast assimilation cycle at 3 h intervals observations included for data assimilation include satellite altimetry satellite estimated sst ship observations argo floats and fixed and drifting buoy observations vertical profiles of temperature and salinity are assimilated from xbts ctds and buoys this data assimilation is also carried out in the ocean component not in the coupled mode 2 2 uwin cm and design of model experiments 2 2 1 model configuration for this study the uwin cm has been configured based on the coupled atmosphere wave ocean modeling framework described by chen et al 2013 and chen and curcic 2016 to reduce computational cost for the long simulations the surface wave component is turned off in this study fig 3 shows the model domains used for this study both the atmosphere and ocean components of the simulation included the tropical pacific and extend to the subtropics the atmosphere component of uwin cm is the version 3 9 weather research and forecasting wrf model powers et al 2017 wrf is run at 12 km spatial resolution and 44 vertical levels it uses the yonsei university ysu boundary layer parameterization hong et al 2006 the new tiedtke cumulus parameterization zhang and wang 2017 and the wrf single moment 5 class wsm5 microphysics hong et al 2004 the ocean component hycom is based on the configuration of gofs 3 1 see section 2 1 2 except that the near surface salinity in hycom is directly coupled with the wrf precipitation rather than using one way forcing and newtonian relaxation for salinity the atmosphere ocean coupling was implemented as follows the atmosphere ran with a time step of 60 s and hycom ran with 240 s 6 min time steps atmosphere and ocean fields were exchanged at each ocean time step 6 min during each exchange the sst and surface currents were passed from the ocean to the atmosphere the wind stress net heat flux shortwave radiation and p ewere passed from the atmosphere to the ocean note that unlike gofs 3 1 the ocean and atmosphere feel consistent surface stress the wind stress τ was calculated in the wrf surface physics module using a parameterization based on coare3 5 edson et al 2013 to reduce the computational demand the modulation of stress by explicitly simulated surface waves described by chen and curcic 2016 is not included in this study as discussed in section 2 1 2 the shortwave radiation flux sw was distributed vertically through the upper ocean based on the monthly seawifs chlorophyl climatology enthalpy fluxes were modified from coare3 5 using the formulation from garratt 1992 radiative fluxes are passed to hycom directly from the wrf radiation schemes in order to study the importance of p e s coupling p e from wrf is passed directly to hycom every coupling time step 240 s the p e s coupling affects salinity in the top ocean layer by diluting concentrating the salt content when p e is positive negative 1 δ s 1 p e δ z s δ t where δ s is the salinity change in psu p e is precipitation minus evaporation in m s 1 s is the salinity in psu δ z is the top layer thickness e g 0 3 m and δ t is the hycom time step 240 s 2 2 2 ocean and atmosphere coupling one major challenge associated with realistic long e g 1 week regional atmosphere ocean coupled simulations is that the atmosphere tends to drift in the interior of the domain due to model errors and intrinsic predictability limits these errors would then be transmitted to the ocean via the coupling resulting in upper ocean errors which then feed back to the atmosphere e g bjerknes feedback bryan et al 1975 clement and seager 1999 deppenmeier et al 2016 liu et al 2016 manabe et al 1975 unfortunately coupled data assimilation is still a topic of research and restarting both components makes detailed dynamical and budget calculations over days to weeks difficult given the main focus of this study is on upper ocean stratification and momentum we use a novel approach in which the atmosphere is re initialized daily with a 12 h spin up period prior to the continuous ocean atmosphere coupling in uwin cm to be kept close to the atmospheric re analysis meanwhile the ocean model is run continuously without re initialization throughout the entire simulations the coupled simulation was carried out in daily cycles as follows the first run cycle was a 36 h coupled run from 0000 utc 21 january to 1200 utc 22 january subsequent run cycles consisted of 12 h uncoupled spin up runs followed by 24 h coupled run cycles for the spin up runs wrf was reinitialized at 0000 utc and constant sst the 12 z sst from the end of the previous coupled cycle was used for the lower boundary condition at ocean points this approach was taken so that the 1200 utc fields from the spin up run would be consistent with the 1200 utc sst then wrf was restarted from the end of the spin up period and coupling with hycom was activated the simulation then ran in atmosphere ocean coupled mode for 24 h for the ocean component hycom was initialized at 0000 utc 21 january and it was run as a continuous simulation coupled with the atmosphere without any reinitializations note that one disadvantage of the simulation approach taken in this study is that the atmospheric fields in the mainline simulation have a discontinuity each day at 1200 utc this precludes detailed dynamical and budget calculations spanning multiple days in the atmosphere though diurnal cycle analysis from 1200 utc to 1200 utc the following day e g diurnal cycle and mesoscale weather systems is still possible 2 3 experiment without p e s coupling nope in order to clarify the impact of p e s coupling an experimental run was conducted using a configuration of uwin cm without p e s coupling referred to as nope for the nope experiment the top ocean layer salinity source sink due to p e eq 1 was set to zero for all coupling times therefore upper ocean salinity was only affected by the hycom internal dynamics and vertical mixing note that the initial conditions reflect p e s coupling as they come from the hycom global analysis system the impact of p e s coupling was most evident 3 months into the runs when the nope experiment had lost the memory of the initial conditions because the nope experiment was run in atmosphere ocean coupled mode and the upper ocean evolved with different sst than uwin cm the surface winds in nope differed somewhat from uwin cm nevertheless the winds in nope were constrained by the daily re initialization of the atmosphere component in the same manner as uwin cm which kept the winds close to uwin cm e g bias of 0 05 m s 1 and standard deviation of 1 2 m s 1 relative to satellite estimates table 1 2 4 mixed layer depth and barrier layer upper ocean stratification is a reflection of atmospheric forcing and internal oceanic dynamics and mixing the influence of the atmosphere is felt throughout the mixed layer tens of meters to over a hundred meters in the tropics the portion of the upper ocean strongly influenced by the atmosphere due to turbulence mixing over days to weeks is referred to as the mixed layer however the entire mixed layer does not experience mixing at all times the portion of the upper ocean experiencing active mixing at a given time is the mixing layer the mixing layer can vary significantly throughout the day in particular with the diurnal cycle while the mixed layer is a time integrated reflection of the mixing layer brainerd and gregg 1995 de boyer montégut et al 2004 the mixing depth determined by the kpp parameterization in hycom is most representative of the mixing layer depth rather than the mixed layer depth as it reflects mixing at a single model time step therefore the mixed layer depth in this study was calculated offline using the hycom model output the threshold method was used to determine the mixed layer depth based on density and the isothermal layer depth from temperature in order to limit the influence of the diurnal cycle the density and temperature differences were taken with respect to the values at 10 m depth de boyer montégut et al 2004 the temperature threshold used is 0 2 c and the density threshold was taken to be the equivalent density based on the conditions at the reference depth de boyer montegut et al 2007 mignot et al 2007 the 0 2 ç equivalent density thresholds were determined independently at each grid point using the thermodynamic equation of seawater 2010 teos 10 finally the barrier layer was determined to be the difference between the isothermal layer and the mixed layer cronin and mcphaden 2002 lukas and lindstrom 1991 sprintall and tomczak 1992 3 observed and simulated conditions 3 1 observed conditions 3 1 1 background mean the large scale atmospheric and upper ocean structure in the pacific ocean tropics during the study period 21 january 21 july 2018 are summarized in this section the surface winds were dominated by the easterly trade winds of 4 6 m s 1 along the equator and up to 8 7 m s 1 east of hawaii fig 1a the strongest equatorial winds were found in the central pacific 6 m s 1 rainfall was concentrated over the western pacific warm pool e g 28 5 c marked by the solid contour in fig 1 the northern hemisphere intertropical convergence zone itcz at 5 10 n 165 e 80 w and the south pacific convergence zone 5 20 s 165 e 135 w fig 1b outside of these major precipitation regions evaporation dominated over precipitation and p e was negative with an absolute value proportional to the wind speed not shown sea surface temperatures were warmest in the western pacific warm pool 30 5 c with a secondary maximum over the eastern north pacific fig 1c there was a relative minimum in sst along the equator in the central and eastern pacific 25 c at 120 w due to upwelling induced by the easterly surface winds sea surface salinity was highest over the subtropical southeast pacific where there was little precipitation fig 1d surface salinity was relatively low over the heavy precipitation regions of the warm pool itcz and spcz along the equator the maximum salinity occurred near the date line where equatorial wind speeds and evaporation reached a maximum fig 1a 3 1 2 interseasonal and intraseasonal variability during the study period a series of intraseasonal wind precipitation events occurred fig 2 during each mjo event heavy precipitation occurred over the warm pool occurs in episodes spanning 2 5 weeks the events are marked mjo1 mjo2 mjo3 and mjo4 in fig 2 identified based on maxima of westerly winds and rainfall the mjo precipitation exhibited eastward propagation and was associated with westerly surface winds the westerly winds exceeded 5 m s 1 occur over the warm pool west of 150 e in mid february mid march to early april and late april during mjo2 mjo3 and mjo4 fig 2b due to the multiple successive mjo events the warm pool experienced predominantly westerly surface winds from the beginning of the study period in late january to 10 may 2018 after 10 may easterlies predominated though there were episodes of heavy rainfall and occasional westerly surface winds during 27 may 15 june and 30 june 20 july fig 2a b east of 170 e heavy rain episodes did not occur and surface winds were predominantly easterly nevertheless scattered rainfall occurred there after 17 july when the warm pool defined using the 28 5 c isotherm extended to east of the date line e g fig 2c the warm pool eastern edge shifted eastward from 170 e to 170 w during the study period fig 2c the inter seasonal eastward extension of the warm pool did not occur steadily in time but rather alternated between brief periods of abrupt eastward propagation followed by stagnation or even slow westward propagation the warm pool edge was close to climatology at the beginning of the study period but it was hundreds of km further east at the end a reflection of the onset of the 2018 el niño based on the noaa oceanic nino index oni noaa national oceanic and atmospheric administration 2021 the inter seasonal eastward extension of the warm pool was greater than what is expected due to the seasonal transition the periods of abrupt eastward propagation were associated with the mjo precipitation and wind events as described by jauregui and chen 2021 additionally within the warm pool sst cooling occurred due to the strong westerly winds and convective downdrafts in heavy precipitation associated with the mjo chen et al 2016 especially during 20 march 10 april and 1 10 may this is a well documented effect of the mjo on the upper ocean the western pacific warm pool is associated with heavy precipitation hence the surface salinity there is relatively low fig 1b d a fresh pool can be identified using the 34 6 psu surface salinity contour cravatte et al 2009 during the study period the eastern edge of the fresh pool edge was generally within a few hundred km of the eastern most mjo precipitation fig 2d since the intraseasonal precipitation events did not propagate as far eastwards in the second half of the period the fresh pool retreated 500 km westward nevertheless relatively fresh water of salinity 34 6 35 0 psu extended from 170 e to near the date line during the study period as the salinity gradient east of the fresh pool became less pronounced while there were periods of precipitation over the equatorial central pacific in late june july fig 2a the eastern portion of the warm pool can become fresher even with relatively weak local forcing from precipitation while the eastern edge of the fresh pool gradually retreated westwards following the inter seasonal trend in the easternmost influence of the mjo and other intraseasonal heavy precipitation events there is little coherence between the heavy precipitation events and surface salinity on the time scales of days weeks in the gofs analysis fig 2d this mainly reflects that the gofs analysis uses salinity relaxation to climatology rather than direct p e input from the navgem a coupled model simulation with fully explicit p e s coupling is better able to depict the relationship between precipitation events and surface salinity 3 2 uwin cm simulation generally the uwin cm simulation captured the mean atmosphere and ocean structure as well as the time evolution of the mjo events marked mjo1 mjo2 mjo3 and mjo4 and the intraseasonal rainfall events during the latter half of the simulation fig 4a b the uwin cm simulation is a realistic depiction of the coupled atmosphere ocean system and the average differences between the model and satellite estimates and gofs analysis over the study period were mainly within the measurement uncertainties of the fields except for wind speed which has a standard deviation difference of 1 5 m s 1 in the warm pool table 1a these errors gradually grew over the first 1 2 weeks of the model simulation then leveled off for the remainder of the run not shown similar to the imerg satellite estimates the uwin cm rainfall was concentrated in intraseasonal heavy rain episodes fig 4a the timing and eastward extent of the events were similar is similar to satellite estimates however the model produced more widespread and persistent moderate rain rates 1 mm h 1 while the imerg rainfall had less coverage but often reached 10 mm h 1 fig 2a despite these differences in instantaneous rain rates the mean rainfall in uwin cm was close to the imerg estimates table 1 surface winds correspond well with the satellite estimates figs 2b and 4b in particular the westerly winds associated with mjo1 mjo2 mjo3 and mjo4 this shows that the atmosphere component winds were effectively constrained by the daily re initialization of the atmosphere component sst in uwin cm evolved similar to observed with a few minor differences the warm pool edge in uwin cm was nearly stationary during 25 march 25 april whereas in observations there was an eastward shift in the warm pool around 3 5 april fig 4c also sst 30 c occurred more often in uwin cm than in the satellite estimates especially between 150 160 e during 21 january to 15 may the surface salinity in uwin cm followed the inter seasonal trend of the fresh pool retreat during the study period as in the gofs analysis however the fresh pool edge was more tightly tied to the eastward extent of the mjo precipitation events in uwin cm the evolution of surface salinity on time scale of days to weeks was significantly different than gofs distinct decreases in surface salinity occurred at longitudes from 145 160 e in uwin cm associated with mjo3 and mjo4 in uwin cm but not in gofs figs 2d and 4d the surface salinity was more directly tied to the mjo in uwin cm than in the gofs analysis 3 3 nope experiment in the nope experiment the atmosphere component was constrained in the same manner as in uwin cm hence the rain and surface winds evolved almost identically figs 4a b and 5a b however there were significant differences in the upper ocean between uwin cm and nope for the mean over the study period salinity deviations from gofs in nope were much larger than uwin cm for the 15 s 15 n band and the warm pool which includes the heavy precipitation regions of the itcz and the western pacific warm pool table 1 fig 1b notably the sst bias in uwin cm compared with gofs was nearly zero however in nope there was a cool negative bias in terms of sst the eastward extension of the warm pool in late june july was less than in uwin cm figs 4c and 5c significant differences in sst also occurred at smaller time and spatial scales as described below in terms of surface salinity the main difference was the collapse of the fresh pool as defined by 34 6 psu salinity in may july note that in january march the evolution of the edge of the fresh pool in nope is similar to uwin cm the differences in surface salinity between uwin cm and nope become most pronounced after 1 march within the fresh pool and 1 april elsewhere fig 6a this indicates that the coupled system maintained some memory of the initial large scale salinity structures for 2 months without the input from p e s coupling however after the accumulative effect of multiple wind precipitation events it is clear that the p e s coupling was essential to maintain the fresh pool the stratification of the western pacific warm pool and the zonal gradient of water density in the equatorial pacific while there was significant ocean eddy and wave variability overall the p e scoupling in uwin cm led to warming of the warm pool up to 0 0 5 and cooling east of the warm pool upwards of 1 c relative to nope fig 6b the westward propagating areas of alternating cooler and warmer sst in uwin cm east of the warm pool in march and april were related to tropical instability waves which propagated westward at slightly different speeds and became out of phase in the nope run compared with uwin cm the sst response was most evident after the mjo wind precipitation event in march mjo3 because salinity is strongly modulated by precipitation the influence of p e s coupling on the inter seasonal trend in sst is tied to the mjo these changes in the sst and associated changes to the sst gradients can in turn feed back to the atmosphere rainfall and surface winds fig 6c d which are consistent with previous studies e g chen et al 2001 while these feedbacks were suppressed by re initializing the atmosphere model daily in this study it shows that p e s coupling does not merely affect the upper ocean salinity locally and that there are remote effects of p e s coupling the remainder of this study focuses on several specific ways in which the influence of p e s coupling occurs due to the memory of the initial conditions which include p e s coupling the impacts of p e s coupling are most evident during the second half of the study period e g 20 april 21 july therefore we focus on the second half this includes mjo4 in april the post mjo period in may and the eastward extension of the warm pool to east of the date line in june july 4 local and remote impact of p e s coupling on the upper ocean 4 1 upper ocean stratification and sst over the warm pool the difference between the uwin cm simulation nope is a metric for the role of the p e s coupling in the uwin cm atmosphere ocean coupled system as shown in fig 6a the direct local influence of p e s coupling is to reduce the upper ocean salinity in the heavy precipitation region which is mainly west of 160 165 e fig 7 illustrates the evolution of surface atmosphere and ocean fields mixed layer and barrier layer structure in uwin cm and nope in the heart of the western pacific warm pool and within the fresh pool this location was directly affected by the westerly winds associated with mjo4 westerly mjo winds occurred through 8 may then the easterly trades returned fig 7a the westerly winds reached a maximum of 7 m s 1 during the mjo event the wind difference between uwin cm and nope were o 0 1 m s 1 table 1 which would not result in significant differences in the wind stress between the runs precipitation associated with the mjo event occurred from 22 april to 11 may fig 7b surface salinity was nearly 0 5 psu lower in uwin cm during and after the mjo passage during many days with heavy rainfall there was a short term drop in salinity of o 0 1 psu in contrast in nope the surface salinity increased somewhat during the mjo event sst is not directly affected by p e s coupling in this study however it can be indirectly impacted through changes in the upper ocean stratification and mixed layer depth sst was mainly within 29 5 c 30 5 c during 20 april 20 may fig 7c in both uwin cm and nope the sst had a small diurnal cycle when wind speeds were 5 m s 1 such as 29 april 2 may and a diurnal amplitude of 0 5 c during lighter winds for example 13 17 may sst decreased 0 5 c during the mjo event in nope from 29 april to 8 may however in uwin cm the sst cooling experienced at this location during the same period was 0 3 c with less cooling in uwin cm the sst was 0 2 c warmer than nope why did sst cool more in nope this is related to the local changes in mixed layer depth and the barrier layer induced by the heavy mjo precipitation fig 7d the mixed layer was 10 20 m shallower in uwin cm compared with nope from 23 april to 14 may which is during the time period where the sst differences became more pronounced fig 7b furthermore while a barrier layer was present in both runs it was much thicker in uwin cm fig 7d e in the presence of a thicker barrier layer it was more difficult to draw the cooler water up from the thermocline via mechanical mixing during period that the upper ocean was subjected to the mjo winds note that the sst differences persisted even in the post mjo period when the barrier layer in uwin cm was nearly eroded and the mixed layer depth was similar in uwin cm and nope e g 14 20 may fig 7b d e with the shallower mixed layer in uwin cm the diurnal insolation could more effectively warm the mixed layer helping to maintain the relatively warmer sst in uwin cm in summary the local impact of p e s coupling over the warm pool is that precipitation lowers the mixed layer stability resulting in a shallower mixed layer and the enhancement of the barrier layer which helps to shield the mixed layer from mechanical wind induced mixing during the high wind 5 m s 1 periods of the mjo 4 2 remote influence of p e s coupling along the salinity front as shown in fig 6a the direct effect of p e s coupling was to freshen the upper ocean where precipitation occurs and to increase the salinity where there was little precipitation and evaporation dominates this increased the zonal salinity gradient in the eastern part of the warm pool east of 160 e it is important to point out that this region did not feel the direct wind and precipitation forcing from the mjo and yet it is where the eastward extension of the warm pool leading up to the 2018 el niño event occurred since the uwin cm was significantly warmer there than nope between 160 e and the eastern edge of the warm pool in may july fig 6b it is clear that p e s coupling had a remote influence there the remote influence of p e scoupling on the eastern portion of the warm pool is illustrated by the time series centered at 0 n 165 e along the salinity front fig 8 this location did not experience westerly winds and heavy precipitation associated with mjo4 rather the area experienced easterly winds from 20 april through 1 june fig 8a despite the dominance of evaporation e g negative p e there was a significant reduction in salinity during 29 april 8 may in both uwin cm and nope fig 8b this reduction in salinity was 0 7 psu in uwin cm and 0 4 psu in nope it was associated with the eastward propagation of the salinity front e g 35 0 psu in uwin cm from 162 e on 13 april to 167 e on 22 may fig 4d 9a 9d and 9g in nope there was no strong sst front passage at this location during the same time period figs 5d 10a d and g prior to the passage of the salinity front uwin cm and nope had similar ssts fig 8c afterwards uwin cm became warmer than nope reaching a difference of 0 5 c on 18 may the eastward propagation of the salinity front coincided with an eastward shift in the warmest water in the core of the western pacific warm pool fig 4c as shown in fig 6b the warmer sst in 160 165 e in uwin cm compared with nope was maintained through the end of the study period 21 july clearly the passage of the salinity front in uwin cm contributed to the large scale eastward shift in the warm pool and the inter seasonal trend of increasing sst in the vicinity of 165 e the eastward propagation of the salinity front in uwin cm was associated with not only the salinity gradient but also an abrupt shift in zonal currents in the mixed layer and mixed layer temperature gradients fig 9 on 20 april the fresh pool edge defined using 34 6 psu was located at 158 e and the leading edge of the salinity front 35 0 psu was at 162 e fig 9a the 34 6 psu water was mainly confined to within the mixed layer the halocline i e 34 6 35 0 psu was located below the mixed layer at this time the warm pool was under the influence of the mjo westerlies which extended to 165 5 e east of the salinity front fig 9a nevertheless zonal currents in the upper 150 m were predominantly directed towards the west in to the mjo westerly winds at up to 0 8 m s 1 the exception was within 159 162 e in the top 20 30 m where eastward currents of 0 1 m s 1 occurred in the mixed layer fig 9b the relatively shallow mixed layer 20 m near the salinity front may have aided in trapping the eastward momentum flux from the atmosphere and shifting the currents to eastward there within the mixed layer a horizontal temperature gradient was also present near the salinity front and the region with the mixed layer eastward currents fig 9c this temperature gradient was between the 30 c water in mixed layer at the core region of the warm pool 146 159 e and the eastern edge of the warm pool 28 5 c at 169 e by 1 may the mjo westerlies had retreated to 159 e however the salinity front had shifted several degrees longitude to the east to 164 e fig 9d additionally the eastward currents at the salinity front had intensified to 0 5 m s 1 and the mixed layer equatorial eastward currents had spread to cover 153 164 5 e over 1000 km fig 9e finally the 30 c water in the core of the warm pool shifted 280 km to the east to 161 5 e though the warm pool edge retreated to 168 e fig 9f on 11 may the easterly trade winds had returned to the warm pool fig 4b the trade winds dominated the warm pool area on 17 may fig 9g nevertheless by 17 may the salinity front eastward zonal currents and the 30 c water of the warm pool had shifted further east eastern edge of 30 c water to 164 e against the trade winds fig 9g h and i the salinity front reached 168 e and the warm pool edge shifted back to 169 e both the salinity gradient and temperature gradient would contribute to setting up a mixed layer density gradient which tends to propagate eastward as a density current this evolution resembles the phenomenon of fresh equatorial jets roemmich et al 1994 meanwhile within 147 159 e in the heart of the warm pool and fresh pool the mixed layer currents had turned back to westward with lingering eastward currents remaining 20 30 m below the mixed layer depth in contrast to uwin cm in nope the zonal salinity gradients are much weaker and a distinct eastward propagating eastward current jet did not occur fig 10 on 20 april nope had higher salinity 34 6 35 0 psu versus 34 2 34 8 psu west of 160 e figs 9a and 10a and a somewhat smaller warm pool figs 9c and 10c the warm pool salinity in nope subsequently increased figs 10d and 10g which is consistent with the overall increasing trend of salinity in nope west of 160 e fig 5d unlike in uwin cm there were no eastward currents at the eastern edge of the warm pool in nope in part because the mixed layer was deeper around 40 50 m fig 10b by 1 may 2018 the westward currents were weakened by the mjo westerly winds and eastward currents occurred over a limited area 157 5 160 1 e at the eastern edge of the mjo westerlies where the mixed layer was relatively shallow 40 m fig 10e by 17 may these mjo induced eastward currents were no longer present fig 10e there was an eastward shift in the 30 c warm pool water in nope to 162 e by 1 may fig 10f however there was no further eastward propagation by 18 may and but it did not result in nearly as much warming near 165 e compared with uwin cm fig 10i the contrasting evolution of uwin cm versus nope near the salinity front is illustrated in terms of difference fields in fig 11 because the salinity front was weaker in nope negative positive salinity differences were seen west east of the uwin cm salinity front location fig 11a e these salinity differences were greatest above the uwin cm mixed layer depth solid black curve though uwin cm was at times fresher than nope well below the mixed layer down to 80 m depth west of the front e g fig 11b and e co located with the salinity differences at the salinity front there were differences in the zonal currents fig 11f j and temperature fig 11k o generally where the salinity difference was negative positive the zonal currents were more eastward westward and the temperatures were warmer cooler these differences were most pronounced within the uwin cm mixed layer the largest fresh salinity anomalies 0 4 psu were located over the warm pool where the heaviest precipitation occurs west of 160 e fig 11a e in contrast the warmest water temperature anomalies 0 5 c were located on the west side of the salinity front with significant cool anomalies 0 4 c on the east side of the front by 17 may 2018 fig 11k o these warm anomalies were displaced 500 800 km east of the largest fresh anomalies over the warm pool this illustrates well the remote thermal response to the p e s coupling over the warm pool the evolution of the mixed layer depth was also very different between uwin cm and nope by the time the mjo westerly winds were retreating on 1 may the nope mixed layer depth 55 m was almost three times as deep as uwin cm 20 m to the west of the salinity front 163 165 e fig 11m later on 17 may there was a sharp drop in the mixed layer depth from 26 m to 60 m at the salinity front in uwin cm within 55 km near 168 e fig 11o in contrast nope produced a more gradual mixed layer deepening from 32 m to 50 m over 420 km 4 3 large scale redistribution and warm pool extension in addition to warming within the heart of the warm pool and near the salinity front in late june july the edge of the warm pool in uwin cm had shifted to 170 w while it was near the date line in nope figs 4d and 5d this was reflected by positive sst differences between uwin cm and nope of several deg c east of the dateline starting at 10 june 175 w is representative of this regime fig 12 this location was dominated by the easterly trade winds and evaporation fig 12a b despite being located well east of the fresh pool salinity front a salinity reduction of 0 3 psu occurred between 16 and 24 june in uwin cm but not in nope fig 12b it is at this time that the uwin cm sst became 0 5 c warmer than nope and the warmer sst persisted in uwin cm through the end of the study period fig 12c a thick barrier layer developed in uwin cm but not in nope fig 12d e which likely helped to maintain the warmer ssts against the mechanical mixing from 5 m s 1 trade winds unlike at 165 e there was no distinct current jet feature that could account for this evolution in uwin cm nevertheless the upper ocean temperature salinity and current structure is significantly different between uwin cm and nope fig 13 the warm sst associated with the eastward warm pool extension in uwin cm was relatively shallow fig 13a meanwhile the zonal salinity gradient was much weaker in nope reflecting the collapse of the fresh pool as defined by 34 6 psu salinity in nope fig 5d significantly there were eastward currents in the mixed layer spanning thousands of km in uwin cm but not in nope fig 13e f these mixed layer currents were in direct opposition to the easterly trade winds fig 13a they were persistent for several weeks in the uwin cm simulation not shown furthermore easterly currents below the mixed layer down to 150 m were generally stronger in uwin cm this suggests a large scale shift in the upper ocean which occurred more prominently in uwin cm than in nope while the specific causes of this are beyond the scope of this study the persistent wide swath of eastward currents in uwin cm would tend to advect the fresher warmer water across the zonal temperature gradients which contributed to the greater eastward extension of the warm pool in uwin cm in good agreement with observations figs 2c and 4c the role of a large scale transition to eastward upper ocean currents in the western pacific has also been emphasized for the 2015 2016 el niño gasparin and roemmich 2016 the scattered precipitation over the central pacific after 17 june may also have contributed to reducing the salinity there these results show that p e s coupling is needed to capture the inter seasonal shift of the warm pool beyond what was expected from climatology in the lead up to the 2018 el niño event 5 summary and conclusions a novel coupled atmosphere ocean modeling approach has been used to study the impact of p e s coupling on the upper ocean structure and stratification and momentum in the tropical western pacific warm pool and in the equatorial central pacific ocean p e s coupling impacts the upper ocean on time scales ranging from 1 h to intraseasonal and inter seasonal and there are both local and remote impacts uwin cm with daily re initialized atmosphere captured well the upper ocean evolution during multiple consecutive mjo events spanning 6 months 21 january 21 july 2018 the impact of p e s coupling was determined by comparing the fully coupled uwin cm with a nope experiment where p e input to the ocean eq 1 was set to zero compared to nope the uwin cm simulation had lower salinity west of 160 165 e where the most mjo precipitation occurred salinity was higher in uwin cm further east in the central pacific where evaporation dominated the most direct impact of p e s coupling is to maintain the large scale western pacific fresh pool and the zonal salinity and density gradients however the impact of p e s coupling is not limited to the local p e effects on surface and mixed layer salinity rather p e s coupling affects the mixed layer in several ways and at multiple temporal and spatial scales which supported the eastward extension of the warm pool during the onset of the 2018 el niño event in uwin cm the difference between the uwin cm and nope simulations were most significant during the latter half of the study period starting with mjo4 figs 4 5 and 6 there were local and rempte impacts of p e coupling on sst in uwin cm which did not occur in nope first locally over the warm pool the mixed layer became 10 20 m shallower during mjo4 and a thick barrier layer developed which shielded the warm pool from cooling due to mjo strong wind events fig 7 additionally there were remote effects as a remote effect near the salinity front the fresh warm water propagated eastward after mjo4 in april in uwin cm as a fresh equatorial jet with eastward currents of 0 5 m s 1 which persisted for weeks after the initial mjo westerly wind forcing carrying the warmer fresher water eastward figs 8 11 finally by late june july a large scale readjustment had occurred throughout the equatorial western and central pacific resulting in a broad swath of eastward currents spanning thousands of km which helped to push the warm pool edge to east of the date line figs 12 and 13 the air sea interaction associated with the p e scoupling has a significant impact on the sst and sst gradient which induced a feedback effect on the atmosphere component s rainfall and surface winds however because the atmosphere is constrained by the reanalysis in this study this feedback may not have been fully realized long range 1 month regional and climate model coupled simulations and or forecasts may face potential challenges if p e s coupling is not well represented or constrained by observations in these models this presents a particular challenge in light of rainfall biases in many atmospheric models it is expected that data assimilation in the coupled model system can help mitigate some of the bias introduced due to the atmospheric model rainfall this requires high temporal and spatial resolution salinity data in the top few meters of the ocean it is expected that the tropical pacific observing system tpos smith et al 2019 will help to improve the analysis and modeling of p e s coupling and its effects on the mjo and enso note that the commonly used method of relaxing surface salinity to climatology may preserve the long term climate but based on the results of this study it would not be sufficient to depict the upper ocean response and atmosphere coupling on sub seasonal time scales such as the mjo events and it would likely be limited in reflecting the inter seasonal shift of the warm pool in the lead up to el niño events this coupled atmosphere ocean modeling study shows that multiscale air sea interactions associated with the mjo and p e s coupling on both localized and large scale zonal current advection may have played an important role in the intraseasonal to interseasonal eastward extension of the warm pool in the 2018 2019 el niño a study is currently under way to further quantify how the warm pool eastward extension occurred leading up to the onset of the 2018 2019 el niño in the uwin cm simulation and observations credit authorship contribution statement brandon w kerns methodology software validation formal analysis visualization data curation writing original draft writing review and editing shuyi s chen supervision of model and data analysis project administration resources funding acquisition writing review and editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank yakelyn r jauregui ajda savarin and dalton kai sasaki of the university of washington for their input during the course of this study two anonymous reviewers comments and suggestions help improve the manuscript this study was supported by the noaa cvp tropical pacific observing system tpos program under the research grant na18oar4310401 it is a part of collaborative project with meghan cronin and dongxiao zhang of noaa pmel microwave oi sst data are produced by remote sensing systems and sponsored by national oceanographic partnership program nopp and the nasa earth science physical oceanography program data are available at www remss com 
23873,submarine landslides can pose serious tsunami hazard to coastal communities however performing a comprehensive landslide tsunami hazard assessment for a given area is in general difficult in view of the large uncertainty associated with tsunamigenic source parameters which are often only approximately defined based on estimates of the landslide geometry slide material properties and resulting kinematics therefore a probabilistic tsunami hazard analysis ptha should be performed by considering a large number of cases which is computationally demanding here we present an efficient model based on solving the linear mild slope equation with a time dependent source term representing the seafloor motion this approach allows carrying out many computations for a large number of landslide scenarios in a monte carlo mc approach framework at a reduced computational cost compared to other available methods while still providing physically accurate simulations of most landslide tsunami generation and propagation processes to further speed up the mc simulations a database of elementary solutions is first developed for many landslide sources of unit amplitude motion over a small seafloor area within the possible landslide footprint for each unit source the resulting tsunami elevations are computed and saved at many locations of interest in the mc simulations a large number of landslide scenarios are defined by randomly selecting slide parameters within their statistical distributions and each is then simulated for their specific bottom motion using a linear combination of the pre computed unit sources hence each resulting tsunami is quickly computed at the locations of interest by linear superposition the paper presents the model validation against two tests cases and describes its novel methodology to perform multiple landslide tsunami scenarios keywords green s function landslide tsunami linear wave theory monte carlo method probabilistic tsunami hazard analysis 1 introduction tsunamis although of rare occurrence compared to other natural disasters can have devastating consequences for society s increasingly populated coastal areas in order to manage the associated risk coastal tsunami hazard can be assessed by performing a probabilistic tsunami hazard analysis ptha in such analysis probabilistic maps of tsunami intensity metrics such as flow depth or current velocity e g boschetti et al 2020 are developed along the coast based on tsunami sources of various probability of occurrence i e return period which can inform risk mitigation activities ptha methodologies have been applied to many different coastal areas at different scales global scale analyses have been developed to support international disaster risk reduction efforts which can serve as reference for smaller scales analysis e g davies et al 2018 løvholt et al 2014 a large number of regional or local pthas have been carried out since the mapping of tsunami probabilities is very site specific see e g literature review in grezio et al 2017 in general pthas have mainly focused on coseismic tsunami sources however some probabilistic investigations have been carried out for subaerial or submarine landslide sources e g ward 2001 grilli et al 2009 grezio et al 2012 lynett and martinez 2012 watts 2004 maretzki et al 2007 pampell manis et al 2016 submarine landslide tsunami sources are widespread and may dominate tsunami hazard for instance on the break and slope of the wide continental shelf bordering the us east coast ten brink et al 2014 schambach et al 2019 which is the site of the 1929 grand banks tsunami that caused 27 fatalities in newfoundland løvholt et al 2019 and on the slope of the narrow shelf off of the french italian riviera e g ioualalen et al 2010 a submarine landslide tsunami a slump was shown to have been the major source of the devastating papua new guinea 1998 tsunami that caused over 2000 fatalities tappin et al 2008 and a rigid slump on the submerged slopes of mount etna is believed to have been the major source of the 1908 messina earthquake and tsunami the worst natural disaster in modern history in the mediterranean basin responsible for 80000 fatalities schambach et al 2020 more recently many coastal submarine landslides triggered by the earthquake contributed to the over 2000 fatalities caused by the palu 2018 tsunami schambach et al 2021 performing a ptha for landslide tsunamis requires specifying probability distribution functions for key source parameters e g landslide volume velocity submergence depth etc in order to construct a large number of random landslide scenarios a realistic motion must be associated with each landslide scenario thus defined e g grilli et al 2009 and their tsunami generation and propagation computed through numerical modeling based on these simulations for each scenario tsunami intensity metrics e g tsunami amplitude inundation depth current velocity or other are computed along the coastal areas of interest based on these results statistical analyses are finally performed to assess the probability of exceedance of each selected tsunami intensity metric along the coast such results will be increasingly reliable the larger the number of computations based on which the statistical analyses are carried out in view of the large computational demand of pthas only a few types of numerical models can be viable see short review in section 2 to realistically perform tsunami simulations once the landslide sources are defined in the context of performing a ptha of landslide tsunami hazard the present paper proposes a novel numerical model and method to simulate the large number of landslide tsunami scenarios that are required with a reasonable computational costs from the source to the far field the new model is based on the efficient frequency domain numerical solution of the linear mild slope equation mse proposed by bellotti et al 2008 which has been shown to be reasonably accurate for simulating the propagation of tsunamis in the far field the frequency domain solution of the mse is forced by a term representing the seafloor deformation due to the underwater landslide motion cecioni and bellotti 2010b the new ptha tsunami modeling method has two main stages 1 define and compute tsunami impact at nearshore target locations named save points for a large number of elementary unit landslides and 2 linearly superimpose the pre computed unit landslide solutions to rapidly compute tsunami impact metrics at the coastal save points for each scenario as detailed in section 2 the method takes advantage of a green s function approach by defining the elementary landslide sources as having a unit amplitude of motion over a small rectangular seafloor area defined within the possible landslide footprint in the second stage of the method each pre computed unit solution at coastal points of interest is multiplied by the actual magnitude of the seafloor motion for the considered landslide source in each rectangular sub area this second stage comes at a very moderate computational cost and can be efficiently repeated many times to simulate a large number of landslide scenarios the paper is organized as follows section 2 describes the numerical model and methodology section 3 validates the model for two laboratory experiments and in particular the relevance of the decomposition of the landslide area into many sub areas which is as detailed later one of the factors that influences the accuracy and efficiency of the method then in section 4 an example of monte carlo simulation is carried out by evaluating the statistical distribution of the far field tsunamis generated by landslides along the coast of a conical island finally conclusions are given in section 5 2 numerical model and methodology a ptha requires performing a large number of simulations of landslide tsunami generation and propagation for many landslide scenarios hence it is necessary to use a numerical model providing a good compromise between accuracy and computational cost landslide tsunami generation has been simulated using three dimensional 3d models solving navier stokes or euler equations for a specified rigid slide motion or for the coupled motion of deforming slides modeled as dense viscous fluids or granular media e g grilli et al 2002 liu et al 2005 montagna et al 2011 abadie et al 2012 horrillo et al 2013 grilli et al 2019 kim et al 2019 romano et al 2020 zhang et al 2021a b different methods are available to speed up tsunamigenic slide generation such as employing adaptive meshing technology smith et al 2016 or modeling the tsunami generation with a two dimensional 2d model and using the output as a boundary condition for a 3d simulation smith et al 2020 alternatively for granular slides the fluid particle interaction has been investigated coupling computational fluid dynamics and discrete element method cfd dem the cdf dem methods are commonly used to simulate rock slides granular flow in water reservoirs and fluid debris interaction in dam breaks e g zhao and shan 2013 shi et al 2018 zhao et al 2016 shan and zhao 2014 mao et al 2020 park et al 2018 submarine landslide induced waves have also been reproduced using width averaged or 3d potential flow type equations pfe assuming the seafloor deformation as a time dependent bottom boundary e g iwasaki 1987 verriere and lenoir 1992 pelinovsky and poplavsky 1996 grilli and watts 2005 koo and kim 2004 2006 2008 fructus and grue 2007 however pfe are not suitable for subaerial landslides where friction forces and vorticities are significant as such simulations are typically computationally expensive 2d depth averaged models have been used which often provide sufficiently accurate results at limited computational cost when tsunami waves are long compared to the water depth as is typically the case for coseismic tsunamis the non dispersive nonlinear shallow water equations nswe can accurately simulate tsunami propagation in 2d models for landslides tsunamis however frequency dispersion effects usually play an important role and depth averaged dispersive equations e g boussinesq type equations should be used instead e g peregrine 1967 madsen et al 1991 nwogu 1993 wei et al 1995 these equations allow reproducing both nonlinear and dispersive effects to some level of approximation and their complexity grows with the ability to more accurately reproduce such phenomena see kirby 2016 for a review various types of boussinesq equations have been used in 2d landslide tsunami models e g lynett and liu 2002 watts et al 2003 lynett and liu 2005 fuhrman and madsen 2009 similarly the non hydrostatic nswe have been demonstrated to be capable of accurately simulating frequency dispersion and are therefore adequate for modeling landslide tsunami propagation e g ruffini et al 2019 2021 finally more general but more computationally demanding non hydrostatic multi layer models such as nhwave allow to accurately simulate even more strongly dispersive wave trains with full nonlinearity and have been successfully applied to landslide tsunami benchmarks and case studies both rigid and deformable e g ma et al 2012 2013 2015 schambach et al 2019 grilli et al 2019 schambach et al 2020 zhang et al 2021a b schambach et al 2021 a comprehensive literature review of landslide tsunami numerical modeling techniques can be found in yavari and ataie ashtiani 2016 additional references can be found in schambach et al 2019 in the method proposed herein we consider rigid submarine slides or slumps which have been shown to cause worst case scenario tsunamis e g schambach et al 2019 for which tsunami generation and propagation to the far field are simulated with a fully dispersive linear wave model solving the elliptic version of the linear mild slope equation mse bellotti et al 2008 the effects of the landslide geometry and motion are specified in the model using a time dependent source function e g cecioni and bellotti 2010a b the mse is solved in the frequency domain and as suggested by kervella et al 2007 a filter function is used to remove spurious effects of high frequency components the linear mse provides an accurate solution to the landslide tsunami generation and propagation problem when wave amplitudes and seafloor motion are small compared to the local water depth and when the effects of frequency dispersion are more important than those of non linearity for landslide tsunamis this is typically the case away from the shallow water areas nearshore hence to perform a complete propagation of the tsunamis to shore which is important in ptha results of the present model at coastal save points should be used to perform runup calculations such as done in madsen and fuhrman 2008 or used to initialize a coastal inundation model such as funwave shi et al 2012 in which run up calculations would be performed at high resolution see examples of the latter model coupling approach in grilli et al 2012 schambach et al 2019 grilli et al 2019 and schambach et al 2020 2021 this aspect will not be further detailed in this paper and left out for future work in the following the model equations are derived in section 2 1 where the source function is introduced based on an improved and more rigorous approach than in cecioni and bellotti 2010b section 2 2 then shows how the model is applied to build a large number of landslide scenarios using the unit source functions 2 1 model derivation to simulate transient tsunami waves the time dependent linearized wave equation in a 3d cartesian coordinate space x y z is first transformed into a set of elliptic equations in the frequency domain by way of a fourier transform the solutions of these equations are then transformed back to the time domain by way of an inverse fourier transform for waves of surface elevation η x y t generated by a seafloor motion and propagating over a mildly sloping bathymetry fig 1a the water depth can be expressed as 1 h x y t h 0 x y ζ x y t in which h 0 is the water depth and ζ represents the seafloor deformation due to the underwater landslide assumed to be small as compared to the water depth hence ζ h 0 assuming an inviscid fluid with an irrotational motion and linearized free surface and bottom boundary conditions the problem is formulated in terms of the velocity potential ϕ x y z t as follows 2 h 2 ϕ ϕ z z 0 x y z ϕ t t g ϕ z 0 at z 0 ϕ z h h 0 h ϕ ζ t 0 at z h 0 x y in which the first equation is a laplace s equation expressing mass conservation the second equation combines the linearized kinematic and dynamic free surface boundary conditions and the third equation is the kinematic bottom boundary condition additionally g denotes the gravitational acceleration subscript z the partial derivative with respect to z and h x y the horizontal gradient operator finally the linearized dynamic free surface boundary condition yields η 1 g ϕ t this 3d linearized wave boundary value problem is expressed in the frequency domain as 3 h 2 φ φ z z 0 ω 2 φ g φ z 0 at z 0 φ z h h 0 h φ i ω z 0 at z h 0 x y in which i denotes the imaginary number ω the angular frequency and φ x y z ω and z x y ω the fourier transforms of ϕ and ζ respectively for each value of ω the constant depth problem i e for h 0 const can be solved analytically by means of a separation of variables which yields 4 φ x y z ω ψ x y ω f z ω with 5 f z ω cosh k h 0 z cosh k h 0 where k denotes the wavenumber which can be found as a function of the angular frequency and depth by solving the linear dispersion relationship 6 ω 2 g k tanh k h 0 for a mildly sloping seafloor the constant depth solution can be assumed to be locally valid and hence eqs 3 can be restated as 7 h 2 ψ f ψ f z z 0 x y z ω 2 ψ f g ψ f z 0 at z 0 ψ f z h h 0 h ψ f i ω z 0 at z h 0 x y ω using eq 5 we further have 8 φ z z ψ f z z ψ k 2 f k 2 φ the integration over depth of laplace s equation in eqs 3 or 7 yields a 2d wave propagation equation over a mildly sloping seafloor in the horizontal plane x y referred to as the mse multiplying laplace s equation in eqs 3 by f z ω and reusing laplace s equation we find 9 h 0 0 h 2 φ k 2 φ f d z h 0 0 f φ z z φ f z z d z applying green s identity for φ and f we find 10 h 0 0 φ f z z φ z z f d z φ f z f φ z 0 φ f z f φ z h 0 which using the free surface and bottom boundary conditions becomes 11 h 0 0 h 2 φ k 2 φ f d z ω 2 g φ ω 2 g φ f h h 0 h φ h 0 i ω f z h 0 considering that 12 h φ h ψ f ψ h f f h ψ and 13 h 2 φ ψ h 2 f 2 h ψ h f f h 2 ψ eq 11 becomes 14 h 0 0 f 2 h 2 ψ 2 f h f h ψ f ψ h 2 f f 2 k 2 ψ d z f h h 0 ψ h f f h ψ h 0 i ω f z h 0 now the first two terms on the lhs left hand side of eq 14 can be written as 15 h f 2 h ψ f 2 h 2 ψ 2 f h f h ψ and the last term on the rhs right hand side can be written as 16 i ω f z i ω z cosh k h 0 at z h 0 x y reordering eq 14 we find 17 h 0 0 h f 2 h ψ d z ψ h 0 0 f h 2 f d z k 2 ψ h 0 0 f 2 d z f ψ h h 0 h f h 0 f 2 h h 0 h ψ h 0 i ω z cosh k h 0 applying leibniz s rule to the first and last terms on the lhs of eq 17 we find 18 h h 0 0 f 2 h ψ d z k 2 ψ h 0 0 f 2 d z i ω z cosh k h 0 ψ h 0 0 f h 2 f d z f ψ h h 0 h f h 0 terms on the rhs of eq 18 can be shown to be o h h 2 h 2 h hence based on the mild slope approximation h h k h to the first order all the rhs terms can be neglected as compared to the lhs terms yielding 19 h h 0 0 f 2 h ψ d z k 2 ψ h 0 0 f 2 d z i ω z cosh k h 0 performing the depth integration analytically we finally find the modified mse as 20 h c c g h ψ k 2 c c g ψ i ω g z cosh k h 0 in which c ω k denotes the linear wave celerity or phase velocity and 21 c g d ω d k 1 2 c 1 2 k h 0 sinh 2 k h 0 is the group velocity using the linearized dynamic free surface boundary condition eq 20 can also be restated in terms of the free surface elevation in the frequency domain n x y ω as 22 h c c g h n k 2 c c g n ω 2 z cosh k h 0 with n ω g ψ and c c g are computed as a function of frequency and depth using eqs 6 and 21 eq 22 is the modified mse used in the present model in which the rhs term represents the forcing from the landslide induced seafloor motion at frequency ω note that the denominator of the rhs forcing term which depends on the wavenumber k ω grows exponentially with frequency and hence acts as a filter function that makes the forcing from the fourier transformed seafloor motion z ω increasingly small at higher frequency this high frequency filter here does not need to be artificially applied but naturally results from the derivation to solve eq 22 additional boundary conditions are required on lateral boundaries to represent either a no flow condition on impermeable boundaries i e n x 0 or n y 0 or a radiation boundary condition on open boundaries e g n x ω c n see details in bellotti et al 2008 and cecioni and bellotti 2010a b once eq 22 is solved for a large number of frequencies in the meaningful range the solution in the time domain is found by applying an inverse fourier transform as described in the next section 2 2 methodology description to be able to efficiently simulate the large number of landslide tsunami scenarios required to perform a ptha a data base of elementary solutions es is first developed representing tsunamis generated by unit seafloor displacements over small rectangular sub areas covering the seafloor footprint into which the landslides can potentially move the tsunami generated by each landslide scenario in the ptha is then constructed by linear superposition of these es similar to earlier works ward 2001 xu 2007 miranda et al 2014 chen et al 2020 the es can be regarded as pseudo green s functions however here the impulsive point forcing is not at one computational node but over a small sub area in the region where landslides can occur given a grid of l sub areas over the landslide footprint fig 1 with coordinates x l y l l 1 l at their center each es is computed by solving eq 22 for a range of relevant frequencies ω m m 1 m with a source term z u x l y l ω m corresponding to a 1 m unit amplitude uplift of the seafloor over the sub area located at x l y l rather than computing each es over the entire domain x y these are only calculated as n u l x p y p ω m at a set of nearshore save points of interest x p y p p 1 p where surface elevations caused by each landslide scenario will be reconstructed given the space and time dependent seafloor deformation ζ x y t caused by the movement of a landslide scenario the corresponding motion amplitudes z x l y l ω m are computed by a fourier transform for each sub area and relevant frequency ω m as l 1 l 23 z x l y l ω m 0 ζ x l y l t e i ω m t d t in which the numerical time integration is typically limited to t f the landslide duration of motion and the tail of the integral for t t f is expressed analytically for each relevant frequency the mse solution of each landslide scenario at the save points is then found in terms of tsunami amplitudes by linearly superposing each es multiplied by its actual motion amplitude over the landslide area as m 1 m 24 n x p y p ω m l 1 l z x l y l ω m n u l x p y p ω m finally the tsunami surface elevation caused by each landslide scenario is found at the save points in the time domain by an inverse fourier transform of the frequency domain tsunami amplitudes as p 1 p 25 η x p y p t m 1 m n x p y p ω m e i ω m t from the applications we shall see that one of the critical steps in the accuracy of the method is the selection of the number l or size of rectangular sub areas however the finer the discretization of the potential landslide footprint area into sub areas the larger the computational cost as more mses need to be solved for the complete range of relevant frequencies at each save point i e the computational cost c is proportional to l m p a compromise must thus be found in order to ensure the efficiency of the method we will see that another important aspect to consider is the way the sub areas cover the landslide seafloor footprint in the next section the method s accuracy and efficiency are assessed in light of these factors for two different landslide scenarios for which laboratory experiments are available based on these guidance is provided for applying the method to a general ptha case 3 applications in this section the accuracy of the es solution of the mse eq 22 is assessed for two laboratory benchmarks the mse is a class of wave propagation equations which if properly discretized and solved are able to achieve a certain level of accuracy for simulating landslide tsunami generation and propagation hence for each benchmark once this is established for the standard direct solution of the mse the same problem is solved with the es solution which is more efficient but based on additional approximations and results are compared to the standard mse solution used as a reference indeed for a given benchmark with the es method one can achieve at best a small discrepancy with the direct solution of the mse but one cannot be more accurate with respect to the benchmark data since both methods feature the same physics accordingly for each benchmark the effect of the es parameters and discretization in particular the role of the landslide area decomposition into many sub areas on the solution accuracy are assessed by comparing results to those of the standard mse solution directly comparing results to the experimental benchmark data would only mix up different sources of discrepancy from model physics and the new numerical method of solving the mse 3 1 tsunamis generated by a rigid underwater landslide as a first validation benchmark we model the laboratory experiments performed by enet and grilli 2007 which were carried out in the wave tank of the ocean engineering department at the university of rhode island for a rigid gaussian shaped aluminum submarine mass failure smf of elliptical footprint and geometry 26 ζ s x y t 1 ɛ max 0 sech k b x sech k w y ɛ where x y is centered on the landslide initial location and k b 2 c b and k w 2 c w with c acosh 1 ɛ for the experimental geometry we have length b 0 395 m width w 0 680 m a maximum thickness t 0 082 m and ɛ 0 717 the landslide moved down a α 15 plane slope from an initial submergence d at its center causing a tsunami for which time series of surface elevations were measured at 4 wave gauges fig 2 the motion s t of the slide parallel to the slope was inferred from its acceleration s t measured during each experiment using a micro accelerometer embedded at its center of mass based on these measurements and the theory developed by grilli and watts 2005 the landslide center of mass motion was expressed as 27 s t s 0 ln cosh t t 0 for 0 t t f with here t f being the time the landslide impacts the bottom and stops and s 0 u t 2 a 0 and t 0 u t a 0 denoting the characteristic length and time of landslide motion respectively where u t is the terminal slide velocity and a 0 its initial acceleration assuming the smf triggering occurs at t 0 with no initial velocity curve fitted values of these parameters were provided for each experiment see enet and grilli 2007 with the above geometry and motion the seafloor deformation caused by the landslide motion to use in the present model is ζ x y t ζ s x s t cos α y additional details of experiments experimental set up and results can be found in enet and grilli 2007 here we consider the test with the smallest initial submergence depth d 0 061 m which caused the largest measured tsunami and also had the largest nonlinearity a 2 5 m long by 1 m wide numerical domain is used fig 2 which given the symmetry of the problem across the direction of landslide motion x only represents half of the landslide and water domains a radiation boundary condition is specified at x 2 5 m while fully reflective boundary conditions are applied along the shoreline at x 0 the sidewall at y 1 m and on the axis of symmetry at y 0 time series of 10 s duration are computed at p 4 save points collocated with the 4 wave gauges using a δ t 0 01 s time step this results in a total of 1000 time steps corresponding to the same number of frequencies ω m in a complete fourier transform to save computational cost however only m 41 of the lowest angular frequencies ω m 0 8 π hz are used for model validation before using the green s function es method a solution of the mse eq 22 is first computed using a forcing term representing the complete landslide motion in this solution a cartesian grid with a δ x δ y 0 01 m resolution is used over the computational domain which provides at least 10 nodes per wavelength for the shortest wavelength 2 π k 0 097 m corresponding to the highest angular frequency over the landslide initial submergence depth numerical results are compared in fig 3 to experimental data at the 4 wave gauges the best agreement between both is observed at the far field gauge g4 with larger errors observed at the near field gauges this is likely because the mse is a linear and depth integrated model and hence the agreement with the experimental measurements is better in deeper water in the far field where the tsunami amplitude and nonlinearity is smaller than in the near field the agreement between the experimental time series and the standard mse solution is furthermore quantified by calculating the relative error in wave height trough to crest and period from two zero down crossing points for the first wave at each gauge as reported in table 1 other simulations showed that results in fig 3 are the best that can be obtained with the complete mse model for this particular experiment keeping this in mind in the following the evaluation of the green s function based model performance is done with the reference to this direct mse solution since the numerical model is validated by comparison with experiments now the idea is to test the es approach the model based on the proposed green s functions approach is then applied to the same laboratory experiment the seafloor footprint area over which the landslide moves is first decomposed into l rectangular sub areas of dimensions d x d y and the mse equation 22 is solved for each of these assuming a unit amplitude and zero phase seafloor motion z u x l y l ω m 1 m l 1 l for each frequency ω m m 1 m 41 this represents l m solutions of the mse for es to assess the effect of the decomposition five different sizes and numbers l of rectangular sub areas were tested with sub area dimensions in the along x and cross shore y selected as a decreasing fraction of the landslide length b and width w respectively see fig 4 and table 2 note that the sub areas outside the landslide footprint area see fig 4 a b c do not contribute to the solution for each decomposition the tsunami generated at the p 4 wave gauge locations was computed to do so the landslide motion ζ x y t in the laboratory experiment was first computed over the regular discretization δ x δ y 0 01 m used in the general mse method and then transformed to the frequency domain by applying eq 23 based on these results the average value of z x l y l ω m was computed over each rectangular sub area the time series of surface elevations at the 4 wave gauges were then computed for each decomposition using eqs 24 and 25 these results are compared in fig 5 with the standard mse results of fig 3 with the single purpose of numerically investigating how the decomposition into small rectangular sub areas affects the mse solution as anticipated the accuracy of the solution decreases the larger the sub areas dimensions or the smaller l however this effect of sub area dimensions is not as significant as one would have expected and decreasing l mostly causes a small underestimation of the waves amplitude in the far field gauges g2 g3 and g4 even with the coarsest decomposition i e with b 2 by w 2 sub areas case e in fig 4 and table 2 the free surface elevation does not significantly differ from that of the standard mse solution at gauge g1 however in close proximity to the initial landslide location the solution is not reliable for the coarsest decomposition the overall loss of accuracy of the solution due to the decomposition in sub areas is quantified in fig 6 by computing the relative error of the maximum wave height h m a x with respect to the target value at each gauge as expected the highest relative errors occur at gauge g1 and range from 1 8 to 88 4 for decomposition cases a e table 2 the relative errors are lower at the other gauges reaching a maximum of 31 2 at gauge g2 in the coarsest case for the middle size decomposition case c where the landslide area is divided in rectangles of dimension b 5 by w 5 the solution is already quite accurate at the far field gauges with a maximum error of 8 while still being acceptable at the near field gauge g1 with a 9 error 3 2 tsunamis generated by subaerial landslides along the flank of a conical island the second validation benchmark of the proposed method is based on the laboratory experiments carried out by di risio et al 2009b in the basin of the research and experimentation laboratory for coastal defense lic of the technical university of bari a conical island was built out of pvc sheets and installed at the center of the large 50 m by 30 m basin the island radius on the tank bottom was r b 4 45 m its height was h i 1 20 m and its flanks had a 1 3 slope 18 4 fig 7 different water depths were tested for h 0 0 8 m the island radius at the shoreline was r 0 2 07 m the slide model was a rigid body of semi elliptical geometry made of plastic material of width a 0 40 m length b 0 80 m and maximum thickness c 0 05 m the landslide was initially located on the island dry slope at a distance ξ from the undisturbed shoreline and constrained to move down the island flank fig 7a considering a reference frame x y centered on the landslide initial location the semi elliptical footprint is described by 28 ζ s x y c 1 x 2 b 2 2 y 2 a 2 2 where b 2 0 4 m a 2 0 2 m and c 0 05 m are the axes of the semi ellipsoid the seafloor deformation due to the landslide motion ζ x y t is computed as for the first validation benchmark but using the s t motion provided by eq 29 during each test the landslide motion parallel to the slope s t was inferred from s t measured by a micro accelerometer embedded within the slide body these measurements were used to derive the parameters of the theoretical landslide law of motion which by extending eq 27 with a subaerial phase can be expressed during the underwater phase using the same definitions as before as e g watts 1998 29 s t s 0 ln cosh t t i t 0 u i t t i ξ for t i t t f with u i the velocity of the landslide at the time t i when it enters the water and as before s 0 t 0 the characteristic length and time of the slide underwater motion phase in function of the initial acceleration a 0 and terminal velocity u t of the underwater phase values of the slide motion parameters for each test and more details on the landslide kinematics can be found in di risio et al 2009a and romano et al 2016 here we only simulate experiments carried out for a water depth h 0 0 8 m and a slide release distance ξ 0 30 m since the problem is symmetric along the direction of landslide motion x axis only half the landslide geometry and motion footprint area are reproduced in the model moreover to reduce the computational cost results are only computed at wave gauges i e save points located in the tank first quadrant fig 7b radiation boundary conditions are specified at x 15 m x 0 and y 10 m while a fully reflective boundary condition is specified along the axis of symmetry at y 0 the free surface elevations computed at the 7 wave gauges save points marked in fig 7b are compared with measurements for both the standard mse model in which the slide source term is imposed at each computational node and that using the precomputed es to reconstruct the solution both models were run up to t 50 s with a time step δ t 0 04 s to reduce the computational cost only m 72 frequencies were used in the range ω m 0 2 8 π r s in both the standard model and the es method the discretization covered the area of fig 7b with square meshes of δ x δ y 0 04 m which ensures a resolution of at least 20 nodes per wavelength for the shortest wavelength 2 π k 0 796 m fig 8 first compares results of the standard model with measurements the agreement between both is quite good at all gauges for the main wave train at t 17 to 22 s depending on the gauge as before the closest agreement is observed at the far field gauges 16s 19s and 22s and at all gauges the numerical model does not correctly simulate the second wave train which is caused by reflection off the slope the relative errors of the first wave height and period at each gauge with respect to the experimental time series are listed in table 3 this direct mse solution will be used as a reference to assess the accuracy of the es method which is discussed next fig 9 thus shows six decompositions of the slide motion footprint area to use with the es method model table 4 the dimensions d x d y of the rectangular sub areas along the main directions are again expressed as a decreasing fraction of the landslide length b and width a and are also multiples of δ x δ y 0 04 m table 4 note that the last subdivision b 2 by a 2 case f in fig 9 and table 4 although coarser better covers the sliding area than the third fourth and fifth ones c d and e respectively fig 10 compares the free surface elevations computed at the 7 wave gauge locations with the es method model for the six tested decompositions of the sliding area fig 9 and table 4 to those computed with the standard mse model in fig 8 similar to the first benchmark fig 11 shows the relative error of the maximum wave height h m a x computed with the es method with respect to the reference mse solution as before in general in the time series the error increases with a decreasing number l of larger rectangular sub areas at all gauges results of the finest decomposition a are in good agreement with the reference mse solution however here the coarsest decomposition f in fig 9 which as pointed out above better covers the slide motion footprint area yields smaller errors for the maximum wave height than the previous three finer decompositions c e these results indicate that the accuracy of the es method depends not only on the size or number l of rectangular sub areas but also on how well these cover the slide motion footprint area see fig 9 in the es method the magnitude of the source term z x l y l ω m is averaged over each rectangular sub area and hence it is affected by discretization nodes where this magnitude is zero despite its coarseness this causes the solution for the b d x 2 decomposition case f to be more accurate than that of the c e cases which use finer sub areas that do not completely cover the slide motion footprint area 4 probabilistic landslide tsunamis analysis a monte carlo mc analysis is carried out to illustrate how the proposed method can be applied in the framework of a ptha with a focus here on the properties of the far field tsunami waves note that the mse solution could as easily be computed at save points located on the onshore side of the landslide where the largest coastal impact i e runup typically occurs landslide tsunami simulation results show that onshore propagating elevation waves typically arise from the rebound of the initial surface depression created over the landslide by its initial motion see e g schambach et al 2019 in the mc simulations landslide source parameters are randomly selected within their estimated probability distributions to define r landslide scenarios for which the bottom deformation ζ r x y t is computed over their motion footprint area for each of these tsunami elevations η r x p y p t r 1 r are then computed at p save points x p y p using the pre computed green s functions n u l x p y p ω m by applying eqs 23 to 25 the mc methodology is applied in the following to landslides similar to those experimentally tested by di risio et al 2009b for semi ellipsoidal landslides moving down the slope of a conical island to generate the mc scenarios probability distributions are estimated for four parameters governing landslide kinematics i e length b width a maximum thickness c and the release distance from the shore ξ of the landslide with the latter most affecting landslide kinematics here for simplicity these parameters are assumed to be independent in a practical field situation however landslide parameters often have some level of correlation whose effects must be removed before selecting independent random samples of the parameters used in the mc simulations this can be done by applying a standard choleski decomposition to the landslide parameter covariance matrix see pampell manis et al 2016 for details for each mc scenario landslide kinematics is computed using the analytical law of motion of eq 29 parameter distributions are centered on the experimental values specified or measured by di risio et al 2009b and the domain geometry bathymetry that is used in experiments as proposed by grilli et al 2009 the landslide width length and thickness are assumed to be log normally distributed while the release distance follows a normal distribution the statistical parameters mean and standard deviation of each probability distribution function pdf assumed to be independent are listed in table 5 and each pdf is plotted in fig 12 the expected slide motion footprint area is 4 28 m long by 0 44 m wide it is subdivided into l 54 rectangular sub areas 18 by 3 along the x and y directions respectively in the mc simulations r 1000 combinations of the four considered landslide parameters are randomly extracted from their pdfs and their kinematics computed yielding the corresponding seafloor deformations averaged over each sub area as a function of time ζ r x l y l t l 1 l r 1 r these seafloor deformations are then fourier transformed with eq 23 to z r x l y l ω m assuming unit deformations the green s function solutions n u l x p y p ω m are computed with the mse model for each sub area at the p 7 experimental wave gauge locations shown in fig 7b for m 72 relevant frequencies finally combining the es green s functions the surface elevations at the p wave gauges are computed by applying eqs 24 and 25 as η r x p y p t fig 13a shows surface elevations computed for the r 1000 different landslide tsunami scenarios at gauge 22s which is located far from the shoreline fig 7b most time series of surface elevations are distributed around the solution obtained with the experimental values of the landslide parameters the gray bands in fig 13b show various percentiles of the computed free surface elevations for each time step these results illustrate the main advantage of the es method based on pre computed green s functions when considering ptha i e the ability to efficiently compute results for a large number of landslide scenarios using the same set of green s function solutions rather than having to simulate each scenario one by one using the standard mse model the saving in computational time resulting from using the es method in the above example is illustrated in table 6 cpu time spent on the first stage of the green s function method is relative to the construction of the database of l 54 m 72 precomputed es green s function at p 7 gauges while the second stage refers to the computational procedure of randomly sampling r 1000 landslide scenarios and combining the green s function es to build surface elevations at the gauges for each landslide tsunami scenario the total computational procedure for the es method takes 6 11 h of cpu time on the desktop computer used in this project the computational time to perform direct mse solutions for 1000 different landslide tsunami scenarios is calculated as 46 5 h by multiplying by 1000 the cpu time of one mse solution to have a realistic computational time for a single mse solution we averaged the cpu time for 100 direct simulations with different landslide scenarios hence the computational speed up of using the es method instead of the direct mse approach is about 7 6 on a single processor a zero up crossing analysis was carried out on the tsunami time series saved at gauge 22s for each landslide scenario this allowed computing values of the maximum and minimum free surface elevation η m a x and η m i n and estimating their probability distributions these results are presented in fig 14 as histograms approximating log normal distributions having a positive skewness hence these have tails with a few large values that occurred in the numerical sample of 1000 scenarios as highlighted by the red boxes in the figures fig 15 shows log normal distributions fitted to the data for η m a x and η m i n with their 95 confidence intervals kolmogorov smirnov tests were performed with a significance level of 0 05 based on which 95 prediction intervals were constructed also shown in the figures 5 conclusions this research investigated the efficient numerical simulation of tsunamis generated by submarine landslides in the context of performing a probabilistic tsunami hazard analysis ptha which requires modeling many landslide scenarios as part of monte carlo mc simulations in the context of earlier work performed by the authors using the linear mild slope equation mse a novel methodology is developed based on reconstituting tsunami elevations from pre computed green s functions representing elementary solutions es corresponding to unit seafloor motions we show that the new method allows performing a large number of simulations at much more reasonable computational cost than when solving each landslide scenario with the complete mse model the efficiency of the method results mainly from the fact that the same set of es green s functions can be used to recreate the tsunami elevations at save points of interest e g along the coast for many landslide scenarios by simple linear superposition the proposed model can be used in two ways 1 the multiple landslide scenarios are simulated in a given area where landslides can be triggered in order to assess the consequences in terms of tsunami metrics with associated probability of occurrence 2 given an occurred tsunami event with available wave measurements or observations the multiple landslide scenarios simulations allow to reconstruct the generation mechanism after benchmarking the model on two different sets of pre existing laboratory experiments the es method was applied to perform mc simulations and compute 1000 landslide tsunami scenarios occurring on the flanks of a conical island this followed the configuration of the laboratory experiments carried out by di risio et al 2009b the application showed that the proposed methodology had a computational cost much lower by a factor of nearly 8 than the equivalent standard mse model regarding the cpu times reduction when using the es approach instead of the direct mse solution obtained in the presented application of mc landslide tsunami simulations it should be pointed out that no attempt was made at parallelizing these simulations clearly the es model could easily be modified to perform many similar computations in parallel on individual processors of a multi core system e g the computation of each green s function the construction of each landslide scenario which would both greatly reduce the cpu times listed in table 6 and also potentially could increase the factor of 8 speed up resulting from the es method which would likely better parallelize than the direct mse solution the proposed es model and results focused on the tsunami generated in the far field where nonlinear effects are negligible and the benchmarks showed the model performed well in this context the new proposed model appears to be a good candidate for performing efficient simulations of landslide tsunami wave trains the mse solution would be less accurate in the near field where nonlinearity increases but it could be coupled to a more relevant model in the nearshore to this effect such as based on the fully nonlinear boussinesq equations e g wei et al 1995 schambach et al 2019 which would compute the tsunami inundation and runup at the coast credit authorship contribution statement verdiana iorio methodology software validation writing original draft writing review and editing giorgio bellotti conceptualization methodology validation formal analysis writing review and editing supervision claudia cecioni methodology validation writing original draft writing review and editing stephan t grilli methodology formal analysis writing review and editing supervision declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests s t grilli reports financial support was provided by grant cmmi 15 37568 from the us national foundation s t grilli reports financial support was provided by grant na 19 nws4670074 from noaa s national weather service national tsunami hazard mitigation program acknowledgments sg gratefully acknowledges support for part of this work from grant cmmi 15 37568 from the us national foundation and from noaa s national weather service national tsunami hazard mitigation program grant na 19 nws4670074 all authors have read and agreed to the published version of the manuscript 
23873,submarine landslides can pose serious tsunami hazard to coastal communities however performing a comprehensive landslide tsunami hazard assessment for a given area is in general difficult in view of the large uncertainty associated with tsunamigenic source parameters which are often only approximately defined based on estimates of the landslide geometry slide material properties and resulting kinematics therefore a probabilistic tsunami hazard analysis ptha should be performed by considering a large number of cases which is computationally demanding here we present an efficient model based on solving the linear mild slope equation with a time dependent source term representing the seafloor motion this approach allows carrying out many computations for a large number of landslide scenarios in a monte carlo mc approach framework at a reduced computational cost compared to other available methods while still providing physically accurate simulations of most landslide tsunami generation and propagation processes to further speed up the mc simulations a database of elementary solutions is first developed for many landslide sources of unit amplitude motion over a small seafloor area within the possible landslide footprint for each unit source the resulting tsunami elevations are computed and saved at many locations of interest in the mc simulations a large number of landslide scenarios are defined by randomly selecting slide parameters within their statistical distributions and each is then simulated for their specific bottom motion using a linear combination of the pre computed unit sources hence each resulting tsunami is quickly computed at the locations of interest by linear superposition the paper presents the model validation against two tests cases and describes its novel methodology to perform multiple landslide tsunami scenarios keywords green s function landslide tsunami linear wave theory monte carlo method probabilistic tsunami hazard analysis 1 introduction tsunamis although of rare occurrence compared to other natural disasters can have devastating consequences for society s increasingly populated coastal areas in order to manage the associated risk coastal tsunami hazard can be assessed by performing a probabilistic tsunami hazard analysis ptha in such analysis probabilistic maps of tsunami intensity metrics such as flow depth or current velocity e g boschetti et al 2020 are developed along the coast based on tsunami sources of various probability of occurrence i e return period which can inform risk mitigation activities ptha methodologies have been applied to many different coastal areas at different scales global scale analyses have been developed to support international disaster risk reduction efforts which can serve as reference for smaller scales analysis e g davies et al 2018 løvholt et al 2014 a large number of regional or local pthas have been carried out since the mapping of tsunami probabilities is very site specific see e g literature review in grezio et al 2017 in general pthas have mainly focused on coseismic tsunami sources however some probabilistic investigations have been carried out for subaerial or submarine landslide sources e g ward 2001 grilli et al 2009 grezio et al 2012 lynett and martinez 2012 watts 2004 maretzki et al 2007 pampell manis et al 2016 submarine landslide tsunami sources are widespread and may dominate tsunami hazard for instance on the break and slope of the wide continental shelf bordering the us east coast ten brink et al 2014 schambach et al 2019 which is the site of the 1929 grand banks tsunami that caused 27 fatalities in newfoundland løvholt et al 2019 and on the slope of the narrow shelf off of the french italian riviera e g ioualalen et al 2010 a submarine landslide tsunami a slump was shown to have been the major source of the devastating papua new guinea 1998 tsunami that caused over 2000 fatalities tappin et al 2008 and a rigid slump on the submerged slopes of mount etna is believed to have been the major source of the 1908 messina earthquake and tsunami the worst natural disaster in modern history in the mediterranean basin responsible for 80000 fatalities schambach et al 2020 more recently many coastal submarine landslides triggered by the earthquake contributed to the over 2000 fatalities caused by the palu 2018 tsunami schambach et al 2021 performing a ptha for landslide tsunamis requires specifying probability distribution functions for key source parameters e g landslide volume velocity submergence depth etc in order to construct a large number of random landslide scenarios a realistic motion must be associated with each landslide scenario thus defined e g grilli et al 2009 and their tsunami generation and propagation computed through numerical modeling based on these simulations for each scenario tsunami intensity metrics e g tsunami amplitude inundation depth current velocity or other are computed along the coastal areas of interest based on these results statistical analyses are finally performed to assess the probability of exceedance of each selected tsunami intensity metric along the coast such results will be increasingly reliable the larger the number of computations based on which the statistical analyses are carried out in view of the large computational demand of pthas only a few types of numerical models can be viable see short review in section 2 to realistically perform tsunami simulations once the landslide sources are defined in the context of performing a ptha of landslide tsunami hazard the present paper proposes a novel numerical model and method to simulate the large number of landslide tsunami scenarios that are required with a reasonable computational costs from the source to the far field the new model is based on the efficient frequency domain numerical solution of the linear mild slope equation mse proposed by bellotti et al 2008 which has been shown to be reasonably accurate for simulating the propagation of tsunamis in the far field the frequency domain solution of the mse is forced by a term representing the seafloor deformation due to the underwater landslide motion cecioni and bellotti 2010b the new ptha tsunami modeling method has two main stages 1 define and compute tsunami impact at nearshore target locations named save points for a large number of elementary unit landslides and 2 linearly superimpose the pre computed unit landslide solutions to rapidly compute tsunami impact metrics at the coastal save points for each scenario as detailed in section 2 the method takes advantage of a green s function approach by defining the elementary landslide sources as having a unit amplitude of motion over a small rectangular seafloor area defined within the possible landslide footprint in the second stage of the method each pre computed unit solution at coastal points of interest is multiplied by the actual magnitude of the seafloor motion for the considered landslide source in each rectangular sub area this second stage comes at a very moderate computational cost and can be efficiently repeated many times to simulate a large number of landslide scenarios the paper is organized as follows section 2 describes the numerical model and methodology section 3 validates the model for two laboratory experiments and in particular the relevance of the decomposition of the landslide area into many sub areas which is as detailed later one of the factors that influences the accuracy and efficiency of the method then in section 4 an example of monte carlo simulation is carried out by evaluating the statistical distribution of the far field tsunamis generated by landslides along the coast of a conical island finally conclusions are given in section 5 2 numerical model and methodology a ptha requires performing a large number of simulations of landslide tsunami generation and propagation for many landslide scenarios hence it is necessary to use a numerical model providing a good compromise between accuracy and computational cost landslide tsunami generation has been simulated using three dimensional 3d models solving navier stokes or euler equations for a specified rigid slide motion or for the coupled motion of deforming slides modeled as dense viscous fluids or granular media e g grilli et al 2002 liu et al 2005 montagna et al 2011 abadie et al 2012 horrillo et al 2013 grilli et al 2019 kim et al 2019 romano et al 2020 zhang et al 2021a b different methods are available to speed up tsunamigenic slide generation such as employing adaptive meshing technology smith et al 2016 or modeling the tsunami generation with a two dimensional 2d model and using the output as a boundary condition for a 3d simulation smith et al 2020 alternatively for granular slides the fluid particle interaction has been investigated coupling computational fluid dynamics and discrete element method cfd dem the cdf dem methods are commonly used to simulate rock slides granular flow in water reservoirs and fluid debris interaction in dam breaks e g zhao and shan 2013 shi et al 2018 zhao et al 2016 shan and zhao 2014 mao et al 2020 park et al 2018 submarine landslide induced waves have also been reproduced using width averaged or 3d potential flow type equations pfe assuming the seafloor deformation as a time dependent bottom boundary e g iwasaki 1987 verriere and lenoir 1992 pelinovsky and poplavsky 1996 grilli and watts 2005 koo and kim 2004 2006 2008 fructus and grue 2007 however pfe are not suitable for subaerial landslides where friction forces and vorticities are significant as such simulations are typically computationally expensive 2d depth averaged models have been used which often provide sufficiently accurate results at limited computational cost when tsunami waves are long compared to the water depth as is typically the case for coseismic tsunamis the non dispersive nonlinear shallow water equations nswe can accurately simulate tsunami propagation in 2d models for landslides tsunamis however frequency dispersion effects usually play an important role and depth averaged dispersive equations e g boussinesq type equations should be used instead e g peregrine 1967 madsen et al 1991 nwogu 1993 wei et al 1995 these equations allow reproducing both nonlinear and dispersive effects to some level of approximation and their complexity grows with the ability to more accurately reproduce such phenomena see kirby 2016 for a review various types of boussinesq equations have been used in 2d landslide tsunami models e g lynett and liu 2002 watts et al 2003 lynett and liu 2005 fuhrman and madsen 2009 similarly the non hydrostatic nswe have been demonstrated to be capable of accurately simulating frequency dispersion and are therefore adequate for modeling landslide tsunami propagation e g ruffini et al 2019 2021 finally more general but more computationally demanding non hydrostatic multi layer models such as nhwave allow to accurately simulate even more strongly dispersive wave trains with full nonlinearity and have been successfully applied to landslide tsunami benchmarks and case studies both rigid and deformable e g ma et al 2012 2013 2015 schambach et al 2019 grilli et al 2019 schambach et al 2020 zhang et al 2021a b schambach et al 2021 a comprehensive literature review of landslide tsunami numerical modeling techniques can be found in yavari and ataie ashtiani 2016 additional references can be found in schambach et al 2019 in the method proposed herein we consider rigid submarine slides or slumps which have been shown to cause worst case scenario tsunamis e g schambach et al 2019 for which tsunami generation and propagation to the far field are simulated with a fully dispersive linear wave model solving the elliptic version of the linear mild slope equation mse bellotti et al 2008 the effects of the landslide geometry and motion are specified in the model using a time dependent source function e g cecioni and bellotti 2010a b the mse is solved in the frequency domain and as suggested by kervella et al 2007 a filter function is used to remove spurious effects of high frequency components the linear mse provides an accurate solution to the landslide tsunami generation and propagation problem when wave amplitudes and seafloor motion are small compared to the local water depth and when the effects of frequency dispersion are more important than those of non linearity for landslide tsunamis this is typically the case away from the shallow water areas nearshore hence to perform a complete propagation of the tsunamis to shore which is important in ptha results of the present model at coastal save points should be used to perform runup calculations such as done in madsen and fuhrman 2008 or used to initialize a coastal inundation model such as funwave shi et al 2012 in which run up calculations would be performed at high resolution see examples of the latter model coupling approach in grilli et al 2012 schambach et al 2019 grilli et al 2019 and schambach et al 2020 2021 this aspect will not be further detailed in this paper and left out for future work in the following the model equations are derived in section 2 1 where the source function is introduced based on an improved and more rigorous approach than in cecioni and bellotti 2010b section 2 2 then shows how the model is applied to build a large number of landslide scenarios using the unit source functions 2 1 model derivation to simulate transient tsunami waves the time dependent linearized wave equation in a 3d cartesian coordinate space x y z is first transformed into a set of elliptic equations in the frequency domain by way of a fourier transform the solutions of these equations are then transformed back to the time domain by way of an inverse fourier transform for waves of surface elevation η x y t generated by a seafloor motion and propagating over a mildly sloping bathymetry fig 1a the water depth can be expressed as 1 h x y t h 0 x y ζ x y t in which h 0 is the water depth and ζ represents the seafloor deformation due to the underwater landslide assumed to be small as compared to the water depth hence ζ h 0 assuming an inviscid fluid with an irrotational motion and linearized free surface and bottom boundary conditions the problem is formulated in terms of the velocity potential ϕ x y z t as follows 2 h 2 ϕ ϕ z z 0 x y z ϕ t t g ϕ z 0 at z 0 ϕ z h h 0 h ϕ ζ t 0 at z h 0 x y in which the first equation is a laplace s equation expressing mass conservation the second equation combines the linearized kinematic and dynamic free surface boundary conditions and the third equation is the kinematic bottom boundary condition additionally g denotes the gravitational acceleration subscript z the partial derivative with respect to z and h x y the horizontal gradient operator finally the linearized dynamic free surface boundary condition yields η 1 g ϕ t this 3d linearized wave boundary value problem is expressed in the frequency domain as 3 h 2 φ φ z z 0 ω 2 φ g φ z 0 at z 0 φ z h h 0 h φ i ω z 0 at z h 0 x y in which i denotes the imaginary number ω the angular frequency and φ x y z ω and z x y ω the fourier transforms of ϕ and ζ respectively for each value of ω the constant depth problem i e for h 0 const can be solved analytically by means of a separation of variables which yields 4 φ x y z ω ψ x y ω f z ω with 5 f z ω cosh k h 0 z cosh k h 0 where k denotes the wavenumber which can be found as a function of the angular frequency and depth by solving the linear dispersion relationship 6 ω 2 g k tanh k h 0 for a mildly sloping seafloor the constant depth solution can be assumed to be locally valid and hence eqs 3 can be restated as 7 h 2 ψ f ψ f z z 0 x y z ω 2 ψ f g ψ f z 0 at z 0 ψ f z h h 0 h ψ f i ω z 0 at z h 0 x y ω using eq 5 we further have 8 φ z z ψ f z z ψ k 2 f k 2 φ the integration over depth of laplace s equation in eqs 3 or 7 yields a 2d wave propagation equation over a mildly sloping seafloor in the horizontal plane x y referred to as the mse multiplying laplace s equation in eqs 3 by f z ω and reusing laplace s equation we find 9 h 0 0 h 2 φ k 2 φ f d z h 0 0 f φ z z φ f z z d z applying green s identity for φ and f we find 10 h 0 0 φ f z z φ z z f d z φ f z f φ z 0 φ f z f φ z h 0 which using the free surface and bottom boundary conditions becomes 11 h 0 0 h 2 φ k 2 φ f d z ω 2 g φ ω 2 g φ f h h 0 h φ h 0 i ω f z h 0 considering that 12 h φ h ψ f ψ h f f h ψ and 13 h 2 φ ψ h 2 f 2 h ψ h f f h 2 ψ eq 11 becomes 14 h 0 0 f 2 h 2 ψ 2 f h f h ψ f ψ h 2 f f 2 k 2 ψ d z f h h 0 ψ h f f h ψ h 0 i ω f z h 0 now the first two terms on the lhs left hand side of eq 14 can be written as 15 h f 2 h ψ f 2 h 2 ψ 2 f h f h ψ and the last term on the rhs right hand side can be written as 16 i ω f z i ω z cosh k h 0 at z h 0 x y reordering eq 14 we find 17 h 0 0 h f 2 h ψ d z ψ h 0 0 f h 2 f d z k 2 ψ h 0 0 f 2 d z f ψ h h 0 h f h 0 f 2 h h 0 h ψ h 0 i ω z cosh k h 0 applying leibniz s rule to the first and last terms on the lhs of eq 17 we find 18 h h 0 0 f 2 h ψ d z k 2 ψ h 0 0 f 2 d z i ω z cosh k h 0 ψ h 0 0 f h 2 f d z f ψ h h 0 h f h 0 terms on the rhs of eq 18 can be shown to be o h h 2 h 2 h hence based on the mild slope approximation h h k h to the first order all the rhs terms can be neglected as compared to the lhs terms yielding 19 h h 0 0 f 2 h ψ d z k 2 ψ h 0 0 f 2 d z i ω z cosh k h 0 performing the depth integration analytically we finally find the modified mse as 20 h c c g h ψ k 2 c c g ψ i ω g z cosh k h 0 in which c ω k denotes the linear wave celerity or phase velocity and 21 c g d ω d k 1 2 c 1 2 k h 0 sinh 2 k h 0 is the group velocity using the linearized dynamic free surface boundary condition eq 20 can also be restated in terms of the free surface elevation in the frequency domain n x y ω as 22 h c c g h n k 2 c c g n ω 2 z cosh k h 0 with n ω g ψ and c c g are computed as a function of frequency and depth using eqs 6 and 21 eq 22 is the modified mse used in the present model in which the rhs term represents the forcing from the landslide induced seafloor motion at frequency ω note that the denominator of the rhs forcing term which depends on the wavenumber k ω grows exponentially with frequency and hence acts as a filter function that makes the forcing from the fourier transformed seafloor motion z ω increasingly small at higher frequency this high frequency filter here does not need to be artificially applied but naturally results from the derivation to solve eq 22 additional boundary conditions are required on lateral boundaries to represent either a no flow condition on impermeable boundaries i e n x 0 or n y 0 or a radiation boundary condition on open boundaries e g n x ω c n see details in bellotti et al 2008 and cecioni and bellotti 2010a b once eq 22 is solved for a large number of frequencies in the meaningful range the solution in the time domain is found by applying an inverse fourier transform as described in the next section 2 2 methodology description to be able to efficiently simulate the large number of landslide tsunami scenarios required to perform a ptha a data base of elementary solutions es is first developed representing tsunamis generated by unit seafloor displacements over small rectangular sub areas covering the seafloor footprint into which the landslides can potentially move the tsunami generated by each landslide scenario in the ptha is then constructed by linear superposition of these es similar to earlier works ward 2001 xu 2007 miranda et al 2014 chen et al 2020 the es can be regarded as pseudo green s functions however here the impulsive point forcing is not at one computational node but over a small sub area in the region where landslides can occur given a grid of l sub areas over the landslide footprint fig 1 with coordinates x l y l l 1 l at their center each es is computed by solving eq 22 for a range of relevant frequencies ω m m 1 m with a source term z u x l y l ω m corresponding to a 1 m unit amplitude uplift of the seafloor over the sub area located at x l y l rather than computing each es over the entire domain x y these are only calculated as n u l x p y p ω m at a set of nearshore save points of interest x p y p p 1 p where surface elevations caused by each landslide scenario will be reconstructed given the space and time dependent seafloor deformation ζ x y t caused by the movement of a landslide scenario the corresponding motion amplitudes z x l y l ω m are computed by a fourier transform for each sub area and relevant frequency ω m as l 1 l 23 z x l y l ω m 0 ζ x l y l t e i ω m t d t in which the numerical time integration is typically limited to t f the landslide duration of motion and the tail of the integral for t t f is expressed analytically for each relevant frequency the mse solution of each landslide scenario at the save points is then found in terms of tsunami amplitudes by linearly superposing each es multiplied by its actual motion amplitude over the landslide area as m 1 m 24 n x p y p ω m l 1 l z x l y l ω m n u l x p y p ω m finally the tsunami surface elevation caused by each landslide scenario is found at the save points in the time domain by an inverse fourier transform of the frequency domain tsunami amplitudes as p 1 p 25 η x p y p t m 1 m n x p y p ω m e i ω m t from the applications we shall see that one of the critical steps in the accuracy of the method is the selection of the number l or size of rectangular sub areas however the finer the discretization of the potential landslide footprint area into sub areas the larger the computational cost as more mses need to be solved for the complete range of relevant frequencies at each save point i e the computational cost c is proportional to l m p a compromise must thus be found in order to ensure the efficiency of the method we will see that another important aspect to consider is the way the sub areas cover the landslide seafloor footprint in the next section the method s accuracy and efficiency are assessed in light of these factors for two different landslide scenarios for which laboratory experiments are available based on these guidance is provided for applying the method to a general ptha case 3 applications in this section the accuracy of the es solution of the mse eq 22 is assessed for two laboratory benchmarks the mse is a class of wave propagation equations which if properly discretized and solved are able to achieve a certain level of accuracy for simulating landslide tsunami generation and propagation hence for each benchmark once this is established for the standard direct solution of the mse the same problem is solved with the es solution which is more efficient but based on additional approximations and results are compared to the standard mse solution used as a reference indeed for a given benchmark with the es method one can achieve at best a small discrepancy with the direct solution of the mse but one cannot be more accurate with respect to the benchmark data since both methods feature the same physics accordingly for each benchmark the effect of the es parameters and discretization in particular the role of the landslide area decomposition into many sub areas on the solution accuracy are assessed by comparing results to those of the standard mse solution directly comparing results to the experimental benchmark data would only mix up different sources of discrepancy from model physics and the new numerical method of solving the mse 3 1 tsunamis generated by a rigid underwater landslide as a first validation benchmark we model the laboratory experiments performed by enet and grilli 2007 which were carried out in the wave tank of the ocean engineering department at the university of rhode island for a rigid gaussian shaped aluminum submarine mass failure smf of elliptical footprint and geometry 26 ζ s x y t 1 ɛ max 0 sech k b x sech k w y ɛ where x y is centered on the landslide initial location and k b 2 c b and k w 2 c w with c acosh 1 ɛ for the experimental geometry we have length b 0 395 m width w 0 680 m a maximum thickness t 0 082 m and ɛ 0 717 the landslide moved down a α 15 plane slope from an initial submergence d at its center causing a tsunami for which time series of surface elevations were measured at 4 wave gauges fig 2 the motion s t of the slide parallel to the slope was inferred from its acceleration s t measured during each experiment using a micro accelerometer embedded at its center of mass based on these measurements and the theory developed by grilli and watts 2005 the landslide center of mass motion was expressed as 27 s t s 0 ln cosh t t 0 for 0 t t f with here t f being the time the landslide impacts the bottom and stops and s 0 u t 2 a 0 and t 0 u t a 0 denoting the characteristic length and time of landslide motion respectively where u t is the terminal slide velocity and a 0 its initial acceleration assuming the smf triggering occurs at t 0 with no initial velocity curve fitted values of these parameters were provided for each experiment see enet and grilli 2007 with the above geometry and motion the seafloor deformation caused by the landslide motion to use in the present model is ζ x y t ζ s x s t cos α y additional details of experiments experimental set up and results can be found in enet and grilli 2007 here we consider the test with the smallest initial submergence depth d 0 061 m which caused the largest measured tsunami and also had the largest nonlinearity a 2 5 m long by 1 m wide numerical domain is used fig 2 which given the symmetry of the problem across the direction of landslide motion x only represents half of the landslide and water domains a radiation boundary condition is specified at x 2 5 m while fully reflective boundary conditions are applied along the shoreline at x 0 the sidewall at y 1 m and on the axis of symmetry at y 0 time series of 10 s duration are computed at p 4 save points collocated with the 4 wave gauges using a δ t 0 01 s time step this results in a total of 1000 time steps corresponding to the same number of frequencies ω m in a complete fourier transform to save computational cost however only m 41 of the lowest angular frequencies ω m 0 8 π hz are used for model validation before using the green s function es method a solution of the mse eq 22 is first computed using a forcing term representing the complete landslide motion in this solution a cartesian grid with a δ x δ y 0 01 m resolution is used over the computational domain which provides at least 10 nodes per wavelength for the shortest wavelength 2 π k 0 097 m corresponding to the highest angular frequency over the landslide initial submergence depth numerical results are compared in fig 3 to experimental data at the 4 wave gauges the best agreement between both is observed at the far field gauge g4 with larger errors observed at the near field gauges this is likely because the mse is a linear and depth integrated model and hence the agreement with the experimental measurements is better in deeper water in the far field where the tsunami amplitude and nonlinearity is smaller than in the near field the agreement between the experimental time series and the standard mse solution is furthermore quantified by calculating the relative error in wave height trough to crest and period from two zero down crossing points for the first wave at each gauge as reported in table 1 other simulations showed that results in fig 3 are the best that can be obtained with the complete mse model for this particular experiment keeping this in mind in the following the evaluation of the green s function based model performance is done with the reference to this direct mse solution since the numerical model is validated by comparison with experiments now the idea is to test the es approach the model based on the proposed green s functions approach is then applied to the same laboratory experiment the seafloor footprint area over which the landslide moves is first decomposed into l rectangular sub areas of dimensions d x d y and the mse equation 22 is solved for each of these assuming a unit amplitude and zero phase seafloor motion z u x l y l ω m 1 m l 1 l for each frequency ω m m 1 m 41 this represents l m solutions of the mse for es to assess the effect of the decomposition five different sizes and numbers l of rectangular sub areas were tested with sub area dimensions in the along x and cross shore y selected as a decreasing fraction of the landslide length b and width w respectively see fig 4 and table 2 note that the sub areas outside the landslide footprint area see fig 4 a b c do not contribute to the solution for each decomposition the tsunami generated at the p 4 wave gauge locations was computed to do so the landslide motion ζ x y t in the laboratory experiment was first computed over the regular discretization δ x δ y 0 01 m used in the general mse method and then transformed to the frequency domain by applying eq 23 based on these results the average value of z x l y l ω m was computed over each rectangular sub area the time series of surface elevations at the 4 wave gauges were then computed for each decomposition using eqs 24 and 25 these results are compared in fig 5 with the standard mse results of fig 3 with the single purpose of numerically investigating how the decomposition into small rectangular sub areas affects the mse solution as anticipated the accuracy of the solution decreases the larger the sub areas dimensions or the smaller l however this effect of sub area dimensions is not as significant as one would have expected and decreasing l mostly causes a small underestimation of the waves amplitude in the far field gauges g2 g3 and g4 even with the coarsest decomposition i e with b 2 by w 2 sub areas case e in fig 4 and table 2 the free surface elevation does not significantly differ from that of the standard mse solution at gauge g1 however in close proximity to the initial landslide location the solution is not reliable for the coarsest decomposition the overall loss of accuracy of the solution due to the decomposition in sub areas is quantified in fig 6 by computing the relative error of the maximum wave height h m a x with respect to the target value at each gauge as expected the highest relative errors occur at gauge g1 and range from 1 8 to 88 4 for decomposition cases a e table 2 the relative errors are lower at the other gauges reaching a maximum of 31 2 at gauge g2 in the coarsest case for the middle size decomposition case c where the landslide area is divided in rectangles of dimension b 5 by w 5 the solution is already quite accurate at the far field gauges with a maximum error of 8 while still being acceptable at the near field gauge g1 with a 9 error 3 2 tsunamis generated by subaerial landslides along the flank of a conical island the second validation benchmark of the proposed method is based on the laboratory experiments carried out by di risio et al 2009b in the basin of the research and experimentation laboratory for coastal defense lic of the technical university of bari a conical island was built out of pvc sheets and installed at the center of the large 50 m by 30 m basin the island radius on the tank bottom was r b 4 45 m its height was h i 1 20 m and its flanks had a 1 3 slope 18 4 fig 7 different water depths were tested for h 0 0 8 m the island radius at the shoreline was r 0 2 07 m the slide model was a rigid body of semi elliptical geometry made of plastic material of width a 0 40 m length b 0 80 m and maximum thickness c 0 05 m the landslide was initially located on the island dry slope at a distance ξ from the undisturbed shoreline and constrained to move down the island flank fig 7a considering a reference frame x y centered on the landslide initial location the semi elliptical footprint is described by 28 ζ s x y c 1 x 2 b 2 2 y 2 a 2 2 where b 2 0 4 m a 2 0 2 m and c 0 05 m are the axes of the semi ellipsoid the seafloor deformation due to the landslide motion ζ x y t is computed as for the first validation benchmark but using the s t motion provided by eq 29 during each test the landslide motion parallel to the slope s t was inferred from s t measured by a micro accelerometer embedded within the slide body these measurements were used to derive the parameters of the theoretical landslide law of motion which by extending eq 27 with a subaerial phase can be expressed during the underwater phase using the same definitions as before as e g watts 1998 29 s t s 0 ln cosh t t i t 0 u i t t i ξ for t i t t f with u i the velocity of the landslide at the time t i when it enters the water and as before s 0 t 0 the characteristic length and time of the slide underwater motion phase in function of the initial acceleration a 0 and terminal velocity u t of the underwater phase values of the slide motion parameters for each test and more details on the landslide kinematics can be found in di risio et al 2009a and romano et al 2016 here we only simulate experiments carried out for a water depth h 0 0 8 m and a slide release distance ξ 0 30 m since the problem is symmetric along the direction of landslide motion x axis only half the landslide geometry and motion footprint area are reproduced in the model moreover to reduce the computational cost results are only computed at wave gauges i e save points located in the tank first quadrant fig 7b radiation boundary conditions are specified at x 15 m x 0 and y 10 m while a fully reflective boundary condition is specified along the axis of symmetry at y 0 the free surface elevations computed at the 7 wave gauges save points marked in fig 7b are compared with measurements for both the standard mse model in which the slide source term is imposed at each computational node and that using the precomputed es to reconstruct the solution both models were run up to t 50 s with a time step δ t 0 04 s to reduce the computational cost only m 72 frequencies were used in the range ω m 0 2 8 π r s in both the standard model and the es method the discretization covered the area of fig 7b with square meshes of δ x δ y 0 04 m which ensures a resolution of at least 20 nodes per wavelength for the shortest wavelength 2 π k 0 796 m fig 8 first compares results of the standard model with measurements the agreement between both is quite good at all gauges for the main wave train at t 17 to 22 s depending on the gauge as before the closest agreement is observed at the far field gauges 16s 19s and 22s and at all gauges the numerical model does not correctly simulate the second wave train which is caused by reflection off the slope the relative errors of the first wave height and period at each gauge with respect to the experimental time series are listed in table 3 this direct mse solution will be used as a reference to assess the accuracy of the es method which is discussed next fig 9 thus shows six decompositions of the slide motion footprint area to use with the es method model table 4 the dimensions d x d y of the rectangular sub areas along the main directions are again expressed as a decreasing fraction of the landslide length b and width a and are also multiples of δ x δ y 0 04 m table 4 note that the last subdivision b 2 by a 2 case f in fig 9 and table 4 although coarser better covers the sliding area than the third fourth and fifth ones c d and e respectively fig 10 compares the free surface elevations computed at the 7 wave gauge locations with the es method model for the six tested decompositions of the sliding area fig 9 and table 4 to those computed with the standard mse model in fig 8 similar to the first benchmark fig 11 shows the relative error of the maximum wave height h m a x computed with the es method with respect to the reference mse solution as before in general in the time series the error increases with a decreasing number l of larger rectangular sub areas at all gauges results of the finest decomposition a are in good agreement with the reference mse solution however here the coarsest decomposition f in fig 9 which as pointed out above better covers the slide motion footprint area yields smaller errors for the maximum wave height than the previous three finer decompositions c e these results indicate that the accuracy of the es method depends not only on the size or number l of rectangular sub areas but also on how well these cover the slide motion footprint area see fig 9 in the es method the magnitude of the source term z x l y l ω m is averaged over each rectangular sub area and hence it is affected by discretization nodes where this magnitude is zero despite its coarseness this causes the solution for the b d x 2 decomposition case f to be more accurate than that of the c e cases which use finer sub areas that do not completely cover the slide motion footprint area 4 probabilistic landslide tsunamis analysis a monte carlo mc analysis is carried out to illustrate how the proposed method can be applied in the framework of a ptha with a focus here on the properties of the far field tsunami waves note that the mse solution could as easily be computed at save points located on the onshore side of the landslide where the largest coastal impact i e runup typically occurs landslide tsunami simulation results show that onshore propagating elevation waves typically arise from the rebound of the initial surface depression created over the landslide by its initial motion see e g schambach et al 2019 in the mc simulations landslide source parameters are randomly selected within their estimated probability distributions to define r landslide scenarios for which the bottom deformation ζ r x y t is computed over their motion footprint area for each of these tsunami elevations η r x p y p t r 1 r are then computed at p save points x p y p using the pre computed green s functions n u l x p y p ω m by applying eqs 23 to 25 the mc methodology is applied in the following to landslides similar to those experimentally tested by di risio et al 2009b for semi ellipsoidal landslides moving down the slope of a conical island to generate the mc scenarios probability distributions are estimated for four parameters governing landslide kinematics i e length b width a maximum thickness c and the release distance from the shore ξ of the landslide with the latter most affecting landslide kinematics here for simplicity these parameters are assumed to be independent in a practical field situation however landslide parameters often have some level of correlation whose effects must be removed before selecting independent random samples of the parameters used in the mc simulations this can be done by applying a standard choleski decomposition to the landslide parameter covariance matrix see pampell manis et al 2016 for details for each mc scenario landslide kinematics is computed using the analytical law of motion of eq 29 parameter distributions are centered on the experimental values specified or measured by di risio et al 2009b and the domain geometry bathymetry that is used in experiments as proposed by grilli et al 2009 the landslide width length and thickness are assumed to be log normally distributed while the release distance follows a normal distribution the statistical parameters mean and standard deviation of each probability distribution function pdf assumed to be independent are listed in table 5 and each pdf is plotted in fig 12 the expected slide motion footprint area is 4 28 m long by 0 44 m wide it is subdivided into l 54 rectangular sub areas 18 by 3 along the x and y directions respectively in the mc simulations r 1000 combinations of the four considered landslide parameters are randomly extracted from their pdfs and their kinematics computed yielding the corresponding seafloor deformations averaged over each sub area as a function of time ζ r x l y l t l 1 l r 1 r these seafloor deformations are then fourier transformed with eq 23 to z r x l y l ω m assuming unit deformations the green s function solutions n u l x p y p ω m are computed with the mse model for each sub area at the p 7 experimental wave gauge locations shown in fig 7b for m 72 relevant frequencies finally combining the es green s functions the surface elevations at the p wave gauges are computed by applying eqs 24 and 25 as η r x p y p t fig 13a shows surface elevations computed for the r 1000 different landslide tsunami scenarios at gauge 22s which is located far from the shoreline fig 7b most time series of surface elevations are distributed around the solution obtained with the experimental values of the landslide parameters the gray bands in fig 13b show various percentiles of the computed free surface elevations for each time step these results illustrate the main advantage of the es method based on pre computed green s functions when considering ptha i e the ability to efficiently compute results for a large number of landslide scenarios using the same set of green s function solutions rather than having to simulate each scenario one by one using the standard mse model the saving in computational time resulting from using the es method in the above example is illustrated in table 6 cpu time spent on the first stage of the green s function method is relative to the construction of the database of l 54 m 72 precomputed es green s function at p 7 gauges while the second stage refers to the computational procedure of randomly sampling r 1000 landslide scenarios and combining the green s function es to build surface elevations at the gauges for each landslide tsunami scenario the total computational procedure for the es method takes 6 11 h of cpu time on the desktop computer used in this project the computational time to perform direct mse solutions for 1000 different landslide tsunami scenarios is calculated as 46 5 h by multiplying by 1000 the cpu time of one mse solution to have a realistic computational time for a single mse solution we averaged the cpu time for 100 direct simulations with different landslide scenarios hence the computational speed up of using the es method instead of the direct mse approach is about 7 6 on a single processor a zero up crossing analysis was carried out on the tsunami time series saved at gauge 22s for each landslide scenario this allowed computing values of the maximum and minimum free surface elevation η m a x and η m i n and estimating their probability distributions these results are presented in fig 14 as histograms approximating log normal distributions having a positive skewness hence these have tails with a few large values that occurred in the numerical sample of 1000 scenarios as highlighted by the red boxes in the figures fig 15 shows log normal distributions fitted to the data for η m a x and η m i n with their 95 confidence intervals kolmogorov smirnov tests were performed with a significance level of 0 05 based on which 95 prediction intervals were constructed also shown in the figures 5 conclusions this research investigated the efficient numerical simulation of tsunamis generated by submarine landslides in the context of performing a probabilistic tsunami hazard analysis ptha which requires modeling many landslide scenarios as part of monte carlo mc simulations in the context of earlier work performed by the authors using the linear mild slope equation mse a novel methodology is developed based on reconstituting tsunami elevations from pre computed green s functions representing elementary solutions es corresponding to unit seafloor motions we show that the new method allows performing a large number of simulations at much more reasonable computational cost than when solving each landslide scenario with the complete mse model the efficiency of the method results mainly from the fact that the same set of es green s functions can be used to recreate the tsunami elevations at save points of interest e g along the coast for many landslide scenarios by simple linear superposition the proposed model can be used in two ways 1 the multiple landslide scenarios are simulated in a given area where landslides can be triggered in order to assess the consequences in terms of tsunami metrics with associated probability of occurrence 2 given an occurred tsunami event with available wave measurements or observations the multiple landslide scenarios simulations allow to reconstruct the generation mechanism after benchmarking the model on two different sets of pre existing laboratory experiments the es method was applied to perform mc simulations and compute 1000 landslide tsunami scenarios occurring on the flanks of a conical island this followed the configuration of the laboratory experiments carried out by di risio et al 2009b the application showed that the proposed methodology had a computational cost much lower by a factor of nearly 8 than the equivalent standard mse model regarding the cpu times reduction when using the es approach instead of the direct mse solution obtained in the presented application of mc landslide tsunami simulations it should be pointed out that no attempt was made at parallelizing these simulations clearly the es model could easily be modified to perform many similar computations in parallel on individual processors of a multi core system e g the computation of each green s function the construction of each landslide scenario which would both greatly reduce the cpu times listed in table 6 and also potentially could increase the factor of 8 speed up resulting from the es method which would likely better parallelize than the direct mse solution the proposed es model and results focused on the tsunami generated in the far field where nonlinear effects are negligible and the benchmarks showed the model performed well in this context the new proposed model appears to be a good candidate for performing efficient simulations of landslide tsunami wave trains the mse solution would be less accurate in the near field where nonlinearity increases but it could be coupled to a more relevant model in the nearshore to this effect such as based on the fully nonlinear boussinesq equations e g wei et al 1995 schambach et al 2019 which would compute the tsunami inundation and runup at the coast credit authorship contribution statement verdiana iorio methodology software validation writing original draft writing review and editing giorgio bellotti conceptualization methodology validation formal analysis writing review and editing supervision claudia cecioni methodology validation writing original draft writing review and editing stephan t grilli methodology formal analysis writing review and editing supervision declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests s t grilli reports financial support was provided by grant cmmi 15 37568 from the us national foundation s t grilli reports financial support was provided by grant na 19 nws4670074 from noaa s national weather service national tsunami hazard mitigation program acknowledgments sg gratefully acknowledges support for part of this work from grant cmmi 15 37568 from the us national foundation and from noaa s national weather service national tsunami hazard mitigation program grant na 19 nws4670074 all authors have read and agreed to the published version of the manuscript 
23874,the objective of this study is to apply data based models to improve sea level prediction along the southeastern brazilian coast focus is placed on the atmospheric forced low frequency variability 0 3 to 0 03 day 1 which is associated primarily with propagation of coastal trapped waves along the continental shelf and possibly with local wind forcing process based hydrodynamic models that solve complex physical equations to simulate a dynamical system have been traditionally used to predict sea level these models however may present inaccuracies related to their physical formulation numerical approximations unresolved small scale processes model parameterizations or initial and boundary conditions a combined approach using a neural network to update the outputs of a hydrodynamic model hycom in order to correct the errors allows for the integration of all available knowledge to generate more reliable predictions time series of coastal sea level at three stations cananéia ilha fiscal and imbituba and atmospheric data from the cfsr reanalysis were used to train the data based model a novel methodology to preprocess the input data is presented and it was critical to the reduction of predictions errors correlation maps between coastal sea level and the atmospheric forcing were calculated and the areas of highest correlation were defined while a purely data based model is able to match the predictions of the hydrodynamic model for these stations the combined approach goes a step further reducing the errors in 50 for the frequency band of the atmospherically forced sea level variability keywords sea level prediction neural networks data based models process based models coastal trapped waves 1 introduction sea level variations in coastal regions occur at several time scales and are a major concern for coastal management and human activities in general these variations may be related to different phenomena and vary mostly from the regular diurnal and semidiurnal motions associated with astronomical tides which are fairly predictable to seasonal cycles related to warming and cooling of ocean waters or to local effects of variable river discharge pattiaratchi and eliot 2009 low frequency signals at inter annual or longer time scales and slow trends due to climate changes may also be relevant at different locations haigh et al 2014 of particular interest in coastal areas is the significant sea level rise and fall observed to occur at intermediate frequencies 0 3 to 0 03 day 1 corresponding to periods of 3 to 30 days associated with atmospheric forcing ryan and noble 2007 sea level oscillations within this frequency range are generally referred to as meteorological tides residual tides or meteorological residuals pugh and woodworth 2014 and may be caused by changes in atmospheric pressure inverted barometer effect or by the action of local and remote wind forcing among local phenomena the most conspicuous and the one which presents more risks to human lives are storm surges or the sudden rise in coastal sea level during tropical or subtropical storms woodruff et al 2013 remote wind forcing is felt along coastal regions subjected to changes in wind direction due to formation of atmospheric synoptic frontal systems generating sea level signals which propagate along the coast in the form of shelf waves or coastal trapped waves ctw brink 1991 local sea level may also respond both to local and remote forcing and be further influenced by coastline configuration and bathymetry such variations in sea level when combined with low and high tides may impact coastal sediment transport watanabe et al 2018 wave action at the shoreline marcos et al 2019 navigation during extreme low levels at port access channels sztobryn 2003 urban drainage neumann et al 2015 and flooding alfredini et al 2014 among others sea level prediction is therefore critical to planning and mitigating risks in coastal regions the intense maritime activities demand the development of more and more accurate and efficient modeling techniques in particular for the non deterministic atmospheric forced part of the sea level signal traditionally such predictions are performed through process based models which in this case are hydrodynamic numerical ocean or coastal circulation models semtner 1995 veeramony et al 2017 these models have the advantage of explicitly including the relevant physical processes and their forcing and represent a fundamental technology for understanding and predicting natural phenomena errors in the magnitude and phase of propagating phenomena however are expected and generally observed to occur differences between simulated and observed fields which may be large in particular for extreme events are due in part to numerical approximations non linear behavior of the physical system unresolved small scale processes model parameterizations and insufficient or unreliable data muis et al 2016 kurapov et al 2017 etala 2009 you et al 2010 a variety of process based models have been used to make sea level predictions at different time scales the effectiveness of these models is related to the phenomena of interest and to the approximations made in each one of them in this way large scale climate models are useful for predicting long term sea level changes years to decades di luca et al 2016 rajczak and schär 2017 rummukainen 2016 regional models are ideal for short term prediction from a few days to possibly months wakelin et al 2009 and local models to even shorter scales from minutes to a few days zhang et al 2009 local models are generally nested in regional models which in turn may be nested in large scale models from the point of view of an operational forecast system a downscaling from large to local models has proven successful maraldi et al 2013 bricheno et al 2014 mateus et al 2012 a pragmatic data driven approach is an alternative to overcome some of the problems presented by the process based models the so called data based models may be built using different methods such as neural networks decision trees bayesian learning fuzzy logic genetic algorithms etc artificial neural network ann models in particular have been extensively applied to predict storm surges solving the issue of nonlinear relationships kim et al 2016 2019 sztobryn 2003 sahoo and bhaskaran 2019 you and seo 2009 lee 2008 or to predict sea level in general makarynskyy et al 2004 oliveira et al 2009 zhao et al 2019 data based models per se however cannot overcome the recurrent issues associated with inconsistent or missing data in fact these approaches may be complementary process based models are directly interpretable and with high potential for extrapolating beyond what is observed data based models are highly flexible and may reveal unknown patterns the synergy between these two approaches has gained recent attention in the scientific community camps valls et al 2018 muralidhar et al 2018 and has found its place among the efforts directed to sea level prediction herman et al 2007 bajo and umgiesser 2010 using a combination of both models allows for the integration of all available knowledge to generate more accurate babovic et al 2001 hall 2004 and fast krasnopolsky and fox rabinovitz 2006 simulations in the present work such a combined approach is presented connecting a hydrodynamic model with an artificial neural network for the prediction of atmospheric forced sea level along the southeastern brazilian coast of particular interest are the sea level oscillations within the 0 3 to 0 03 day 1 frequency band the so called meteorological tides which are associated primarily with the signal of coastal trapped waves propagating along the shelf with amplitudes on the same order of magnitude as those of the astronomical tides the spatial scale of coastal trapped waves is in the order of hundreds of kilometers and the adequate process based models to simulate and forecast this phenomena are the ocean general circulation models ogcm the main objective of this study is to evaluate the use of the data based model to improve the simulation generated by the process based model the advantage of the combined model is to ensure physical consistency and to apply the neural network to correct that part of the physical processes that is not captured by the hydrodynamical model a recurrent challenge when using machine learning is to find the appropriate set of input data to efficiently train the neural network the present study introduces a systematic approach for the selection procedure in order to find the best combination of input parameters to reduce the mismatch between simulated and observed sea level 2 material and methods 2 1 process based model this study see fig 1 for a schematic representation uses the results produced within the scope of remo oceanographic modeling and observation network a brazilian approach to operational oceanography lima et al 2013 remo hydrodynamic simulation system is based on the hybrid coordinate ocean model hycom bleck 2002 bleck and smith 1990 employing a set of nested model configurations gabioux et al 2014 in order to generate short term forecasts and long term simulations hindcasts of marine currents in the south atlantic ocean for scientific and environmental purposes costa et al 2017 hycom can be included in a class of ocean models generally referred to as ocean general circulation models ogcms employing the full set of hydrodynamic and thermodynamic equations under realistic configurations and forcing aiming to represent the real world in the most accurate possible way with the best available data for geophysical flows i e fluid motions under the influence of earth s rotation or coriolis force its primary feature is the use of hybrid coordinates isopycnal in the ocean interior geopotential in unstratified regions and terrain following in shallow waters which allows for the optimization of the simulation at a large range of scales and phenomena chassignet et al 2003 the simulation considered in the present investigation consists of a 10 year long hindcast 2006 to 2015 focusing on the western south atlantic the model is configured with nominal horizontal resolution of 1 24 degree 4 km and is nested in a 1 12 degree model of the entire atlantic ocean fig 2 the model uses 32 σ 2 potential density referenced to 2000db hybrid layers as vertical coordinates bottom topography is derived from etopo 1 amante and eakins 2009 and atmospheric mechanic and thermodynamic forcings are derived from the 6 hourly climate forecast system reanalysis cfsr fields https rda ucar edu datasets ds093 1 implemented via standard bulk parameterizations the model assimilates daily temperature and salinity profiles roemmich and owens 2000 sea surface temperature sst from ostia http podaac jpl nasa gov and along track sea surface anomaly sla from altimetry www aviso altimetry fr using the tendral statistical assimilation system t sis assimilation is applied only for model depths larger than 200 m results of the 10 year run are provided every three hours for three dimensional fields zonal and meridional velocities temperature and salinity and every hour for surface fields including sea surface height ssh the mass fields temperature salinity and layer thickness used as initial conditions for the 1 24 domain were downscaled from the 1 12 simulation while the initial condition for the 1 12 domain correspond to the january climatology from woa2009 antonov et al 2010 locarnini et al 2010 the 1 12 basin scale simulation was forced at the lateral boundaries via newtonian relaxation to monthly climatological fields from woa2009 plus barotropic fluxes based on the literature peterson and stramma 1991 lutjeharms 2006 2 2 data based model artificial neural networks ann are mathematical models that resemble biological structures and have computational capacity obtained through learning and generalization haykin 2011 inspired by the neurological system anns are constituted by simple and distributed processing units called neurons analogous to a biological organism artificial neural networks ann have been widely used in various fields of ocean and coastal modeling since 1995 when applied to analyze stability of rubble mound breakwaters mase et al 1995 the present study employs a feedforward network with information flowing in the forward direction from the input to the output the ann structure consists of three single layers namely the input hidden and output layers with the use of the back propagation optimization technique for training the levenberg marquardt algorithm is used due to its lower computational cost when compared to several other back propagation algorithms a hyperbolic tangent transfer function and a linear transfer function are implemented in the hidden and output layers respectively the optimization of parameters in each node of the neural network is based on backpropagation training using gradient decent at each iteration the loss function is calculated as the square of the error obtained from the forward propagation of the inputs minus the observations which is then propagated backwards using the derivative of the activation function in order to correct the weights in the input layer simulated sea level from the hycom model and or atmospheric surface pressure and wind speed both zonal and meridional components derived from cfsr are provided in the output layer the sea level response is obtained correlation of determination r2 and the root mean square error rmse indexes are used to evaluate the model performance several tests were done to define the optimal number of neurons in the hidden layer not shown in order to generalize the methodology and generate comparable and replicable results an optimum number of 10 neurons in the hidden layer were chosen for all the data based models described in this study the experiments were done under the environment of intel r core tm i7 9750h cpu 2 60 ghz 6g ram debian 10 64 bits operating system and python 3 7 the proposed network is implemented by tensorflow 2 4 the methodology to choose the most effective set of inputs for each experiment is based on the following steps training several neural networks with only one input each varying from the candidate inputs and selecting as the first input the result with the highest correlation of determination maintaining this first input defined in the previous step training several neural networks with a second input varying from the candidates and selecting as the second input the result with the highest correlation of determination repeating this procedure until the inclusion of new inputs do not improve the correlation of determination 2 3 data two year long 2004 and 2005 time series of hourly ssh were selected for this study at three coastal stations cananéia imbituba and ilha fiscal see fig 3 for location along the brazilian southeastern coast the data was made available from the gloss project merrifield et al 2010 gloss global sea level observing system is a global set of 290 tide gauge stations that provide optimal sampling of the global ocean for a range of oceanographic applications this period was defined after a data quality control check of all available data in order to identify and eliminate years with long intervals without information or with spurious data from this 2 year period the first 18 months were used as the target set for the data based model and the final 6 months as the test set all error analysis statistics were calculated based on this final 6 months a zero phase digital filtering in both the forward and reverse directions with cut off period of 3 days was applied to the ssh data in order to filter out the main components of the astronomical tides and the inertial period which varies from 24 to 30 h within the study sites daily maps of wind velocity zonal and meridional components and atmospheric pressure for the south atlantic were obtained from cfsr climate forecast system reanalysis http rda ucar edu pub cfsr html cfsr is available from 1979 to the present date with horizontal resolution of approximately 38 km saha et al 2010 this data was used as atmospheric forcing for the process based model and as input data for the data based model 2 4 model experiments in order to evaluate the efficiency of the neural network to improve the simulation of coastal sea level the results of three different experiments were compared see fig 4 for a schematic view of each experiment what is called hereafter as experiment 1 e1 actually consists of the low pass filtered ssh simulated by the hydrodynamical model provided by the remo project in experiment 2 e2 the data based model is trained to directly simulate ssh at the three coastal stations considering only the atmospheric data as input in experiment 3 e3 the combined approach is employed and the data based model is trained to simulate ssh considering both the atmospheric data and the simulated sea level from e1 to maximize the efficiency during the training and the simulating phases of the data based model and also to optimize computational costs the amount of atmospheric data used in e2 and e3 had to be substantially reduced in order to reduce the input the cross correlation was computed between the atmospheric forcings and sea surface height for the entire domain the same methodology was performed considering the sea surface residue i e the difference between measured and simulated ssh in this case from e1 the cross correlation measures the similarity between a vector f and shifted lagged copies of a vector g as a function of the lag and can be defined as follows f g n m f m g m n where f m denotes the complex conjugate of f m and n is the displacement also known as lag the maximum value for each cross correlation was calculated with its respective lag maps of maximum correlation and lags were created and a spatial maximum considering an area of points was averaged and displaced by the average lag the result is a time series for each forcing zonal u wind component meridional v wind component and wind pressure the 250 points represent an area of approximately 2 1011m2 circa 4 4 which is sufficient to capture the synoptic scale of the atmospheric forcings in the region to further improve both the model training and the evaluation of the simulated results the sea level signals at the three coastal stations were splitted into low frequency periods longer than 15 days and high frequency periods shorter than or equal to 15 days bands this approach is justified by a well defined spectral gap at 15 days observed for the sea level data at the three coastal stations as presented in the results section four complementary tests were performed a b c and d for both e2 and e3 as defined below and summarized in tables 1 and 2 in tests a and b the definition of the 250 point subset area for the atmospheric data takes into account the correlation between each of the atmospheric variables u component v component and pressure and the observed sea level at the coastal stations in tests c and d however these correlations were computed between the same atmospheric parameters and the ssh residual i e the difference between the observed and the simulated sea level in e1 it is important to notice therefore that while e2 does not include the process based model as an input it takes into account some of its information in the definition of the input data in these two tests in tests a and c correlations are computed with the full signals while in tests b and d correlations are computed for all signals ssh ssh residuals and atmospheric data splitted into the low and high frequency bands fig 5 shows a schematic representation of inputs and targets for experiment 2 and 3 the reduced atmospheric inputs for each test is summarized in table 2 and the target for all experiments is the measured ssh for 18 months the last 6 months are used for calculating statistics 3 results 3 1 sea level and wind data this section presents an analysis of the sea level observations the energy density at different frequency bands is quantified providing a basis for splitting the signal into low and high frequency bands as described in the material and methods section the time lags between the three coastal stations are identified justifying its interpretation as the result of coastal trapped waves propagating along the coast and providing a metric for evaluating the simulated sea levels in the different model experiments areas of maximum correlation with the atmospheric parameters wind and atmospheric pressure are then computed defining the subsets of input data for the data based model sea level data at the three coastal stations show significant energy in the range from 3 to 15 days fig 6 corresponding to the period of coastal trapped waves generally reported in the literature dottori and castro 2009 the maximum semi amplitudes of these waves can reach up to 60 cm in cananéia and imbituba and up to 40 cm in ilha fiscal significant energy levels may also be observed for longer periods also related to propagating signals and in agreement with recent findings freitas et al 2021 a relatively well defined spectral gap is observed at 15 days suggesting the cutoff period adopted for separating the low and high frequency bands as described in the material and methods section the sea level is highly correlated at the three coastal stations for the total signals and for both the high and low frequency bands as presented in table 3 and illustrated in fig 6 for high frequencies correlation of determination between imbituba the southernmost station and cananéia the central station and between cananéia and ilha fiscal the northernmost station are higher than 80 this significant correlation along the coast and the associated negative time lags indicating an equatorward propagation of the sea level signal are in agreement with the expected theoretical behavior of coastal trapped waves propagating along the south american atlantic shelf correlations of determination are lower but still significant for the low frequency band table 3 the larger negative values of the associated time lags indicate slower northward propagating signals at low frequencies while the physical rationale for the different correlation and time lags for the two frequency bands is beyond the scope of this study recognizing this difference and therefore splitting the signal may prove significant for the data based model the areas of maximum correlation between sea level at the three coastal stations and the atmospheric pressure and wind data are shown in fig 7 for the two frequency bands in general terms one can observe maximum correlation areas located southward of the sea level stations with significant overlap for the three stations while this is coherent with the forcing mechanism for the sea level variations i e with cyclogenesis happening within the latitude range from northern argentina to south brazil giving rise to equatorward moving coastal trapped waves along the continental shelf there are also some significant and important differences at one hand the areas of maximum correlation with atmospheric pressure are located over the ocean top panels fig 7 possibly reflecting the mean position of the low pressure centers of the northeastward moving atmospheric frontal systems gan and rao 1991 the reasons for the different locations for the longer and shorter period bands eastward for the former and westward for the latter are not clear at this point and a physical rationale for this behavior is beyond the scope of this work on the other hand the areas of maximum correlation with wind speed are located near the coast mostly over the continental shelf center and lower panels fig 7 this is coherent with observed changes in wind direction over the continental shelf switching from northeast winds during good weather conditions to south southwest winds when under the influence of the western side of the atmospheric cyclones this change in wind direction over the shelf is the primary forcing of the continental trapped waves that influence the sea level along the brazilian coast accordingly higher correlations are found for the along shore component of the wind at latitudes southward from the three coastal stations areas of maximum correlation with zonal winds correspond more closely with the latitude range from the southern imbituba to the northern ilha fiscal stations possibly reflecting some local forcing upon the sea level 3 2 process based model this section presents an analysis of the coastal sea level simulated by the process based model see freitas et al 2021 for a more thorough discussion of the model results and comparisons with observations in general the model captures in a very realistic way the propagation of coastal trapped waves along the continental margin of the south american continent generated mostly by atmospheric frontal systems originated in the latitudes of northern argentinian uruguay and south brazil these waves show high energy levels for the same spectral bands presented in fig 6 with maximum wave height reaching 1 m and along shelf wavelengths of 8000 km the cross correlation analysis between simulated sea level at the three coastal stations is presented in table 4 coefficient of determination and time lags are very similar to observations see table 3 for the high frequency band which is the most energetic part of the total signal for the low frequency band correlations between simulated sea levels are higher than the corresponding values for observations suggesting that the observed signal contains information possibly associated with local forcing that is not captured by the hydrodynamic model the time lags at low frequencies are also higher in the model than in the observations by roughly 40 to 50 indicating a slower northward propagation of the sea level signal in the model those differences in the simulated behavior of the sea level signal might account for a significant part of the uncertainties related to the model simulation a similar cross correlation analysis was performed for the residual i e the difference between the simulated and the observed sea level table 5 as illustrated in fig 8 this residual cannot be attributed only to noise but has a characteristic oscillatory behavior the significant energy levels presented at the same frequency bands as the observed and simulated signals point to a phase error in the simulation which may account for a large part of the model uncertainties the significant correlation between the residual at the three stations indicates that the error is coherent along the coast areas of maximum correlation were computed between the atmospheric forcing fields and simulated sea level residue sea level and measured sea level at the three coastal stations these areas are illustrated for the correlation with cananéia station in fig 9 the general behavior is similar for the other coastal stations regions of maximum correlation with observed and simulated sea level are very similar indicating the quality of the hydrodynamic model to capture the sea level forcing mechanisms for both frequency bands the meridional wind component has always the highest correlation followed by wind pressure and zonal wind component correlation with the residue sea level on the other hand may indicate regions where the model is inaccurate the origin of this inaccuracy is not clear and may be related to the hydrodynamic model the atmospheric model the data assimilation techniques or a combination of different sources regions of maximum correlation with the residues are located very close to the coast for all variables coastal regions are known as complicated regions for atmospheric and oceanographic models since they are transition zones with abrupt changes in topography heat fluxes salinity etc in addition the lag related to the residue maximum correlation is around 3 times larger than that for the sea level signal suggesting that the differences in sea level that occur between simulated and observed data may be related to phenomena that occurred further south and took days to reach the region of interest 3 3 data based model the results for the input selection following the procedure described in the material and methods section are presented in table 6 for the four tests in experiments e1 and e2 for each coastal station the table columns present in decreasing order the inputs that mostly improve the simulated sea level regarding the atmospheric forcing the meridional component of the wind velocity is generally the most significant input reflecting the basic forcing mechanism for the generation of coastal trapped waves in tests b and d in which the forcing signals are splitted into high and low frequency bands the high frequency winds are mostly relevant in e2 data based only model but the low frequency has a larger impact in the combined approach 3d atmospheric pressure appears as the second most significant forcing field while the zonal wind velocity component is only marginally relevant e3 the combined approach differs from e2 the data based only approach basically for using the simulated sea level in e1 as an input for all tests in e3 the simulated sea level sse is always the most relevant input the input selection procedure is based on the most relevant inputs for each station ilha fiscal and cananéia results show that the atmospheric relevance in sea level oscillation are very similar for these two stations however imbituba showed some differences in the selection procedure especially in experiment 3 this station is closer to the area where the coastal trapped waves are generated which can lead to different forcing mechanisms which is corroborated by the results presented in fig 7 showing different areas of influence for imbituba the impact of the data based and combined approaches upon the simulated sea level when compared to the process based model is synthesized in fig 10 which shows the correlation of determination and the rmse between the simulated and observed sea level at each coastal station a few general statements can be advanced based on the patterns that emerge from this figure subject however to exceptions or particular behaviors the data based approach e2 has similar skills compared to the process based approach e1 in simulating sea level at the three locations investigated it is important to notice that the hydrodynamic model however simulates sea level for all grid points along the entire atlantic ocean and not just for a few selected locations notice also that correlations are already high and rmse low for the process based approach but as long as some few locations along the coast are the most significant for practical applications involving sea level modeling these results highlight per se the value of the data based approach the combined approach e3 combining both the process based simulation with the data based model improves the sea level simulation when compared with the process based or the data based only approaches in general the combined approach e3 using the splitted signal into high and low frequencies and using the residual sea level for establishing the areas of maximum correlation between sea level and the atmospheric forcing 3d reaches the highest correlation and the lowest rmse for the simulated sea level the choice among different combinations of input fields may be somewhat dependent upon the location being evaluated in this respect the results in cananéia and ilha fiscal are very similar but differ in some aspects from those in imbituba for instance considering the sea level signal not the residual and splitting the input into high and low frequencies 3b is very efficient for imbituba but does not improve upon e2 in cananéia or in ilha fiscal on the other hand using the residual sea level and the non splitted signals 3c is very successful in cananéia and ilha fiscal but not so much in imbituba despite being very similar the results from cananéia also differed from ilha fiscal in some aspects in cananéia the most efficient test was using a full signal 3c while in ilha fiscal the best result was archive splitting the input in high and low frequencies 3d once more there are some general rules to be followed in order to improve efficiency but those rules do not always apply and the selection procedure should be dependent on the data to be evaluated it is possible that considering longer series and more locations in the analysis could reduce this location dependency and generate more general rules for input selection 4 discussion there is no consensual scientific nomenclature to refer to a combination of process based and data based models some authors consider any combination of observational data and dynamic model as data assimilation moore et al 2019 oddo et al 2016 while others have called this a neural network adapted to physics muralidhar et al 2018 in this study we avoid such a controversy and refer to it as a combined approach a dichotomy between process based models and data based models however is only theoretical in practice dynamic models employ several empirical equations which are based on observational data at the same time there has been a long debate in the scientific community about the use of physical knowledge in data based models davis and marcus 2015 although several authors agree that both extremes generate inaccurate simulations it is not clear what is the optimal combination between them muralidhar et al 2018 while this is still a matter of debate and a subject for many studies there are possibly multiple combinations for different objectives predicting time series is a difficult task due to the risk of overfitting on the dataset using very large inputs with highly correlated variables can lead to overfitting once the model tries to fit a complex function in the past that cannot be extrapolated to the future a very efficient way to avoid this is to use physical knowledge to reduce the input in this study an algorithm was developed based on prior scientific knowledge of the physical dynamics to reduce the inputs of the neural networks improving efficiency and precision in the sea level prediction in the e2 experiment in which only a data based model was used tests not included in this paper performed with the full atmospheric dataset without reducing the input showed overfitting problems when the algorithm for reducing the input was applied however the results improved significantly in the e3 experiment a step further was taken in the combined approach using both the data based and the process based models to improve efficiency and accuracy in this experiment a data based model was used only for the non linear part of the data in this way the network was able to learn more focused on the part where the process based model was unable to solve the opposite of overfitting is underfitting the under adjustment occurs when there is still room for improvement in the train data this can happen for several reasons if the model is not powerful enough is over regulated or has simply not been trained long enough this means that the network has not learned the relevant standards in the training data for this study several tests using different numbers of neurons and layers were performed to avoid underfitting these tests showed that the input selection should have a higher impact on the sea level prediction then the number of neurons and layers this result agrees with kim et al 2016 who found that the selection of a proper input data set is crucial to the success of a neural network to predict storm surges identifying the causes of misleading prediction is a topic of intense debate oberkampf et al 2002 lima et al 2019 lermusiaux et al 2006 strobach and bel 2017 while this is beyond the scope of the present study our results can contribute to the discussion with some pathways to be followed uncertainties in physical models often have multiple sources numerical approximations spatial or temporal resolution forcing fields inadequate parameterizations ignored or misrepresented processes and general simplifications data based models are capable of reducing those uncertainties even without a complete understanding of its sources nevertheless results from such models combined with data analysis can help to indicate some potential sources in this study three possible error sources in sea level prediction have been raised from the analysis of the model results the slower propagation of coastal trapped waves in the model uncertainties in the atmospheric forcing and ignored smaller scale processes considering just the sea level signal propagating along the coast in the frequency band from 0 3 to 0 03 day 1 the first possible source of error seems to be related to the observed and simulated phase lags along the coast wave propagation in the process based model is slower than the observed values for periods longer than 15 days it is uncertain whether the model data differences may be attributed to some local phenomena to oceanic influence upon coastal sea level or to the coastal trapped waves themselves in this last case one can only speculate on the possible roles of bottom friction parameterization for the barotropic modes in shallow waters for wind waves some studies have shown that the bottom friction depends on wave height madsen et al 1988 wolf 1999 soulsby and clarke 2005 the second source of errors in the process based models raised from the results are the atmospheric uncertainties the results show that the experiment 2 sea level improved considerably when atmospheric inputs correlated with the experiment 1 residues were added e2 tests c and d for those tests even if the simulated sea level in e1 was not explicitly used as input e2 improved its prediction using variables that were connected to the residues of e1 one possible explanation still under investigation is that e1 errors are associated with atmospheric forcings atmospheric reanalysis from cfsr shows good agreement with observation with an underestimation of 3 for the upper percentile stopa and cheung 2014 the upper percentile is usually the most critical for sea level once ctw storm surges and wind setup are generated by stronger wind velocities the third possible source of uncertainties in process based models are the ignored smaller scales processes these models are usually linked with a specific scale range of interest and some phenomena are necessarily left behind in this case the so called model errors computed as the differences between model results and in situ data may not be really errors in the sense that the model was never meant to simulate the features responsible for such differences small or short scale processes however may interact or impact processes in longer spatial or time scales and vice versa idier et al 2019 nesting the model in a more refined grid to solve smaller scales may be necessary in particular areas of interest specially for processes that interact at other scales wave setup is an example of this process where breaking wind waves induce sea level elevation at the coast over many wave groups woodworth 2018 in many regions wave set up can contribute up to 20 of the storm surge signal rautenbach et al 2020 marsooli and lin 2018 a coupled wave circulation model system would be needed to improve sea level prediction taking both short scale gravity waves and larger scale ocean and shelf circulation into account in purely process based models staneva et al 2017 similar considerations can be applied to river runoff which may contribute to sea level variability near major rivers and estuaries wijeratne et al 2008 piecuch et al 2018a there are many studies that use neural networks to predict sea level typically these studies focus on extreme sea levels sahoo and bhaskaran 2019 kim et al 2019 chen et al 2012 tseng et al 2007 or have a limited forecast horizon at most 24 h kim et al 2016 french et al 2017 oliveira et al 2009 few studies provide an extended forecast to several days bajo and umgiesser 2010 makarynska and makarynskyy 2008 in the proposed methodology the delays applied to the input variables in the neural network do not place a limit on the forecasting horizon the input variables are the results of hydrodynamic and atmospheric models that usually can provide forecasts for the next 7 days or more the main differences between the results that were presented in this study and an operational forecast for sea level would be the larger uncertainties related to the neural network inputs both the hydrodynamic hycom and the atmospheric cfsr models presented in this study use data assimilation throughout the whole period in an operational forecast system data assimilation is limited to the beginning of the forecast therefore larger uncertainties are likely to occur in those systems assuming that errors are larger for operational predictions it is possible that the proposed methodology can yield even better results once it has even more room to improve this prediction experiments considering the results of operational forecast must be performed to prove this hypothesis 5 conclusions accurate prediction of sea level in coastal regions is an area of immense scientific interest having also direct social and economic implications although sophisticated hydrodynamic models have been applied over time for operational forecast uncertainties may still be significant neural networks emerge as alternative methods for sea level prediction totally ignoring process physics results of sea level considering only data based model experiment 2 were compared with the process based model experiment 1 and showed similar accuracy hydrodynamic models have the advantage of fully understand the physics behind the phenomena but are very computationally expensive comparing to neural networks in the present study a combined approach was implemented applying neural networks to predict that part of the sea level signal that is not fully represented by the hydrodynamic model preprocessing the data taking into account statistical correlations between the desired signal and the physical forcing was shown to be critical to the success of selecting inputs for the neural network a systematic methodology was proposed to select these inputs among a set of possible candidates in the particular case investigated in the present study the proposed methodology significantly improved the sea level prediction as simulated by an operational implementation of the hycom ogcm at three coastal stations situated along the brazilian southeastern coast for the frequency band from 0 3 to 0 03 days 1 this frequency range is associated primarily with propagation of coastal trapped waves along the brazilian continental shelf and possibly with local wind forcing the most suitable process based models to represent generation and propagation of coastal trapped waves are the ocean general circulation model because of the large spatial scale associated with this phenomena the observed sea level however may as well contain signals associated with other phenomena that may or may not be represented in the model the data based model was trained with sea level data from the imbituba cananeia and ilha fiscal stations and with atmospheric fields from the cfsr reanalysis the same fields that forced the hydrodynamic model the proposed methodology considering both process based and data based models were shown to reduce the error between simulated and observed sea level in 20 to 30 depending on the station moreover the correlation of determination increased for all stations showing that not only the absolute values improved but also the variability of the signal this improvement is accomplished even without a complete understanding of the error sources as long as the signals of the different phenomena are captured by the in situ data this methodology has the potential to improve sea level prediction anywhere data is available this conclusion might also be true for any physical process with significant uncertainties credit authorship contribution statement bruno vicente primo de siqueira conceived of the presented idea developed the theory performed the computations investigate coastal trapped waves supervision discussed the results and contributed to the final manuscript afonso de moraes paiva conceived of the presented idea discussed the results and contributed to the final manuscript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors wish to thank all the researchers and students from the physical oceanography laboratory lof of coppe ufrj for a continuous and stimulating discussion this study was financed in part by the coordenação de aperfeiçoamento de pessoal de nível superior brasil capes finance code 001 model results were obtained within the remo oceanographic modeling and observation network project 
23874,the objective of this study is to apply data based models to improve sea level prediction along the southeastern brazilian coast focus is placed on the atmospheric forced low frequency variability 0 3 to 0 03 day 1 which is associated primarily with propagation of coastal trapped waves along the continental shelf and possibly with local wind forcing process based hydrodynamic models that solve complex physical equations to simulate a dynamical system have been traditionally used to predict sea level these models however may present inaccuracies related to their physical formulation numerical approximations unresolved small scale processes model parameterizations or initial and boundary conditions a combined approach using a neural network to update the outputs of a hydrodynamic model hycom in order to correct the errors allows for the integration of all available knowledge to generate more reliable predictions time series of coastal sea level at three stations cananéia ilha fiscal and imbituba and atmospheric data from the cfsr reanalysis were used to train the data based model a novel methodology to preprocess the input data is presented and it was critical to the reduction of predictions errors correlation maps between coastal sea level and the atmospheric forcing were calculated and the areas of highest correlation were defined while a purely data based model is able to match the predictions of the hydrodynamic model for these stations the combined approach goes a step further reducing the errors in 50 for the frequency band of the atmospherically forced sea level variability keywords sea level prediction neural networks data based models process based models coastal trapped waves 1 introduction sea level variations in coastal regions occur at several time scales and are a major concern for coastal management and human activities in general these variations may be related to different phenomena and vary mostly from the regular diurnal and semidiurnal motions associated with astronomical tides which are fairly predictable to seasonal cycles related to warming and cooling of ocean waters or to local effects of variable river discharge pattiaratchi and eliot 2009 low frequency signals at inter annual or longer time scales and slow trends due to climate changes may also be relevant at different locations haigh et al 2014 of particular interest in coastal areas is the significant sea level rise and fall observed to occur at intermediate frequencies 0 3 to 0 03 day 1 corresponding to periods of 3 to 30 days associated with atmospheric forcing ryan and noble 2007 sea level oscillations within this frequency range are generally referred to as meteorological tides residual tides or meteorological residuals pugh and woodworth 2014 and may be caused by changes in atmospheric pressure inverted barometer effect or by the action of local and remote wind forcing among local phenomena the most conspicuous and the one which presents more risks to human lives are storm surges or the sudden rise in coastal sea level during tropical or subtropical storms woodruff et al 2013 remote wind forcing is felt along coastal regions subjected to changes in wind direction due to formation of atmospheric synoptic frontal systems generating sea level signals which propagate along the coast in the form of shelf waves or coastal trapped waves ctw brink 1991 local sea level may also respond both to local and remote forcing and be further influenced by coastline configuration and bathymetry such variations in sea level when combined with low and high tides may impact coastal sediment transport watanabe et al 2018 wave action at the shoreline marcos et al 2019 navigation during extreme low levels at port access channels sztobryn 2003 urban drainage neumann et al 2015 and flooding alfredini et al 2014 among others sea level prediction is therefore critical to planning and mitigating risks in coastal regions the intense maritime activities demand the development of more and more accurate and efficient modeling techniques in particular for the non deterministic atmospheric forced part of the sea level signal traditionally such predictions are performed through process based models which in this case are hydrodynamic numerical ocean or coastal circulation models semtner 1995 veeramony et al 2017 these models have the advantage of explicitly including the relevant physical processes and their forcing and represent a fundamental technology for understanding and predicting natural phenomena errors in the magnitude and phase of propagating phenomena however are expected and generally observed to occur differences between simulated and observed fields which may be large in particular for extreme events are due in part to numerical approximations non linear behavior of the physical system unresolved small scale processes model parameterizations and insufficient or unreliable data muis et al 2016 kurapov et al 2017 etala 2009 you et al 2010 a variety of process based models have been used to make sea level predictions at different time scales the effectiveness of these models is related to the phenomena of interest and to the approximations made in each one of them in this way large scale climate models are useful for predicting long term sea level changes years to decades di luca et al 2016 rajczak and schär 2017 rummukainen 2016 regional models are ideal for short term prediction from a few days to possibly months wakelin et al 2009 and local models to even shorter scales from minutes to a few days zhang et al 2009 local models are generally nested in regional models which in turn may be nested in large scale models from the point of view of an operational forecast system a downscaling from large to local models has proven successful maraldi et al 2013 bricheno et al 2014 mateus et al 2012 a pragmatic data driven approach is an alternative to overcome some of the problems presented by the process based models the so called data based models may be built using different methods such as neural networks decision trees bayesian learning fuzzy logic genetic algorithms etc artificial neural network ann models in particular have been extensively applied to predict storm surges solving the issue of nonlinear relationships kim et al 2016 2019 sztobryn 2003 sahoo and bhaskaran 2019 you and seo 2009 lee 2008 or to predict sea level in general makarynskyy et al 2004 oliveira et al 2009 zhao et al 2019 data based models per se however cannot overcome the recurrent issues associated with inconsistent or missing data in fact these approaches may be complementary process based models are directly interpretable and with high potential for extrapolating beyond what is observed data based models are highly flexible and may reveal unknown patterns the synergy between these two approaches has gained recent attention in the scientific community camps valls et al 2018 muralidhar et al 2018 and has found its place among the efforts directed to sea level prediction herman et al 2007 bajo and umgiesser 2010 using a combination of both models allows for the integration of all available knowledge to generate more accurate babovic et al 2001 hall 2004 and fast krasnopolsky and fox rabinovitz 2006 simulations in the present work such a combined approach is presented connecting a hydrodynamic model with an artificial neural network for the prediction of atmospheric forced sea level along the southeastern brazilian coast of particular interest are the sea level oscillations within the 0 3 to 0 03 day 1 frequency band the so called meteorological tides which are associated primarily with the signal of coastal trapped waves propagating along the shelf with amplitudes on the same order of magnitude as those of the astronomical tides the spatial scale of coastal trapped waves is in the order of hundreds of kilometers and the adequate process based models to simulate and forecast this phenomena are the ocean general circulation models ogcm the main objective of this study is to evaluate the use of the data based model to improve the simulation generated by the process based model the advantage of the combined model is to ensure physical consistency and to apply the neural network to correct that part of the physical processes that is not captured by the hydrodynamical model a recurrent challenge when using machine learning is to find the appropriate set of input data to efficiently train the neural network the present study introduces a systematic approach for the selection procedure in order to find the best combination of input parameters to reduce the mismatch between simulated and observed sea level 2 material and methods 2 1 process based model this study see fig 1 for a schematic representation uses the results produced within the scope of remo oceanographic modeling and observation network a brazilian approach to operational oceanography lima et al 2013 remo hydrodynamic simulation system is based on the hybrid coordinate ocean model hycom bleck 2002 bleck and smith 1990 employing a set of nested model configurations gabioux et al 2014 in order to generate short term forecasts and long term simulations hindcasts of marine currents in the south atlantic ocean for scientific and environmental purposes costa et al 2017 hycom can be included in a class of ocean models generally referred to as ocean general circulation models ogcms employing the full set of hydrodynamic and thermodynamic equations under realistic configurations and forcing aiming to represent the real world in the most accurate possible way with the best available data for geophysical flows i e fluid motions under the influence of earth s rotation or coriolis force its primary feature is the use of hybrid coordinates isopycnal in the ocean interior geopotential in unstratified regions and terrain following in shallow waters which allows for the optimization of the simulation at a large range of scales and phenomena chassignet et al 2003 the simulation considered in the present investigation consists of a 10 year long hindcast 2006 to 2015 focusing on the western south atlantic the model is configured with nominal horizontal resolution of 1 24 degree 4 km and is nested in a 1 12 degree model of the entire atlantic ocean fig 2 the model uses 32 σ 2 potential density referenced to 2000db hybrid layers as vertical coordinates bottom topography is derived from etopo 1 amante and eakins 2009 and atmospheric mechanic and thermodynamic forcings are derived from the 6 hourly climate forecast system reanalysis cfsr fields https rda ucar edu datasets ds093 1 implemented via standard bulk parameterizations the model assimilates daily temperature and salinity profiles roemmich and owens 2000 sea surface temperature sst from ostia http podaac jpl nasa gov and along track sea surface anomaly sla from altimetry www aviso altimetry fr using the tendral statistical assimilation system t sis assimilation is applied only for model depths larger than 200 m results of the 10 year run are provided every three hours for three dimensional fields zonal and meridional velocities temperature and salinity and every hour for surface fields including sea surface height ssh the mass fields temperature salinity and layer thickness used as initial conditions for the 1 24 domain were downscaled from the 1 12 simulation while the initial condition for the 1 12 domain correspond to the january climatology from woa2009 antonov et al 2010 locarnini et al 2010 the 1 12 basin scale simulation was forced at the lateral boundaries via newtonian relaxation to monthly climatological fields from woa2009 plus barotropic fluxes based on the literature peterson and stramma 1991 lutjeharms 2006 2 2 data based model artificial neural networks ann are mathematical models that resemble biological structures and have computational capacity obtained through learning and generalization haykin 2011 inspired by the neurological system anns are constituted by simple and distributed processing units called neurons analogous to a biological organism artificial neural networks ann have been widely used in various fields of ocean and coastal modeling since 1995 when applied to analyze stability of rubble mound breakwaters mase et al 1995 the present study employs a feedforward network with information flowing in the forward direction from the input to the output the ann structure consists of three single layers namely the input hidden and output layers with the use of the back propagation optimization technique for training the levenberg marquardt algorithm is used due to its lower computational cost when compared to several other back propagation algorithms a hyperbolic tangent transfer function and a linear transfer function are implemented in the hidden and output layers respectively the optimization of parameters in each node of the neural network is based on backpropagation training using gradient decent at each iteration the loss function is calculated as the square of the error obtained from the forward propagation of the inputs minus the observations which is then propagated backwards using the derivative of the activation function in order to correct the weights in the input layer simulated sea level from the hycom model and or atmospheric surface pressure and wind speed both zonal and meridional components derived from cfsr are provided in the output layer the sea level response is obtained correlation of determination r2 and the root mean square error rmse indexes are used to evaluate the model performance several tests were done to define the optimal number of neurons in the hidden layer not shown in order to generalize the methodology and generate comparable and replicable results an optimum number of 10 neurons in the hidden layer were chosen for all the data based models described in this study the experiments were done under the environment of intel r core tm i7 9750h cpu 2 60 ghz 6g ram debian 10 64 bits operating system and python 3 7 the proposed network is implemented by tensorflow 2 4 the methodology to choose the most effective set of inputs for each experiment is based on the following steps training several neural networks with only one input each varying from the candidate inputs and selecting as the first input the result with the highest correlation of determination maintaining this first input defined in the previous step training several neural networks with a second input varying from the candidates and selecting as the second input the result with the highest correlation of determination repeating this procedure until the inclusion of new inputs do not improve the correlation of determination 2 3 data two year long 2004 and 2005 time series of hourly ssh were selected for this study at three coastal stations cananéia imbituba and ilha fiscal see fig 3 for location along the brazilian southeastern coast the data was made available from the gloss project merrifield et al 2010 gloss global sea level observing system is a global set of 290 tide gauge stations that provide optimal sampling of the global ocean for a range of oceanographic applications this period was defined after a data quality control check of all available data in order to identify and eliminate years with long intervals without information or with spurious data from this 2 year period the first 18 months were used as the target set for the data based model and the final 6 months as the test set all error analysis statistics were calculated based on this final 6 months a zero phase digital filtering in both the forward and reverse directions with cut off period of 3 days was applied to the ssh data in order to filter out the main components of the astronomical tides and the inertial period which varies from 24 to 30 h within the study sites daily maps of wind velocity zonal and meridional components and atmospheric pressure for the south atlantic were obtained from cfsr climate forecast system reanalysis http rda ucar edu pub cfsr html cfsr is available from 1979 to the present date with horizontal resolution of approximately 38 km saha et al 2010 this data was used as atmospheric forcing for the process based model and as input data for the data based model 2 4 model experiments in order to evaluate the efficiency of the neural network to improve the simulation of coastal sea level the results of three different experiments were compared see fig 4 for a schematic view of each experiment what is called hereafter as experiment 1 e1 actually consists of the low pass filtered ssh simulated by the hydrodynamical model provided by the remo project in experiment 2 e2 the data based model is trained to directly simulate ssh at the three coastal stations considering only the atmospheric data as input in experiment 3 e3 the combined approach is employed and the data based model is trained to simulate ssh considering both the atmospheric data and the simulated sea level from e1 to maximize the efficiency during the training and the simulating phases of the data based model and also to optimize computational costs the amount of atmospheric data used in e2 and e3 had to be substantially reduced in order to reduce the input the cross correlation was computed between the atmospheric forcings and sea surface height for the entire domain the same methodology was performed considering the sea surface residue i e the difference between measured and simulated ssh in this case from e1 the cross correlation measures the similarity between a vector f and shifted lagged copies of a vector g as a function of the lag and can be defined as follows f g n m f m g m n where f m denotes the complex conjugate of f m and n is the displacement also known as lag the maximum value for each cross correlation was calculated with its respective lag maps of maximum correlation and lags were created and a spatial maximum considering an area of points was averaged and displaced by the average lag the result is a time series for each forcing zonal u wind component meridional v wind component and wind pressure the 250 points represent an area of approximately 2 1011m2 circa 4 4 which is sufficient to capture the synoptic scale of the atmospheric forcings in the region to further improve both the model training and the evaluation of the simulated results the sea level signals at the three coastal stations were splitted into low frequency periods longer than 15 days and high frequency periods shorter than or equal to 15 days bands this approach is justified by a well defined spectral gap at 15 days observed for the sea level data at the three coastal stations as presented in the results section four complementary tests were performed a b c and d for both e2 and e3 as defined below and summarized in tables 1 and 2 in tests a and b the definition of the 250 point subset area for the atmospheric data takes into account the correlation between each of the atmospheric variables u component v component and pressure and the observed sea level at the coastal stations in tests c and d however these correlations were computed between the same atmospheric parameters and the ssh residual i e the difference between the observed and the simulated sea level in e1 it is important to notice therefore that while e2 does not include the process based model as an input it takes into account some of its information in the definition of the input data in these two tests in tests a and c correlations are computed with the full signals while in tests b and d correlations are computed for all signals ssh ssh residuals and atmospheric data splitted into the low and high frequency bands fig 5 shows a schematic representation of inputs and targets for experiment 2 and 3 the reduced atmospheric inputs for each test is summarized in table 2 and the target for all experiments is the measured ssh for 18 months the last 6 months are used for calculating statistics 3 results 3 1 sea level and wind data this section presents an analysis of the sea level observations the energy density at different frequency bands is quantified providing a basis for splitting the signal into low and high frequency bands as described in the material and methods section the time lags between the three coastal stations are identified justifying its interpretation as the result of coastal trapped waves propagating along the coast and providing a metric for evaluating the simulated sea levels in the different model experiments areas of maximum correlation with the atmospheric parameters wind and atmospheric pressure are then computed defining the subsets of input data for the data based model sea level data at the three coastal stations show significant energy in the range from 3 to 15 days fig 6 corresponding to the period of coastal trapped waves generally reported in the literature dottori and castro 2009 the maximum semi amplitudes of these waves can reach up to 60 cm in cananéia and imbituba and up to 40 cm in ilha fiscal significant energy levels may also be observed for longer periods also related to propagating signals and in agreement with recent findings freitas et al 2021 a relatively well defined spectral gap is observed at 15 days suggesting the cutoff period adopted for separating the low and high frequency bands as described in the material and methods section the sea level is highly correlated at the three coastal stations for the total signals and for both the high and low frequency bands as presented in table 3 and illustrated in fig 6 for high frequencies correlation of determination between imbituba the southernmost station and cananéia the central station and between cananéia and ilha fiscal the northernmost station are higher than 80 this significant correlation along the coast and the associated negative time lags indicating an equatorward propagation of the sea level signal are in agreement with the expected theoretical behavior of coastal trapped waves propagating along the south american atlantic shelf correlations of determination are lower but still significant for the low frequency band table 3 the larger negative values of the associated time lags indicate slower northward propagating signals at low frequencies while the physical rationale for the different correlation and time lags for the two frequency bands is beyond the scope of this study recognizing this difference and therefore splitting the signal may prove significant for the data based model the areas of maximum correlation between sea level at the three coastal stations and the atmospheric pressure and wind data are shown in fig 7 for the two frequency bands in general terms one can observe maximum correlation areas located southward of the sea level stations with significant overlap for the three stations while this is coherent with the forcing mechanism for the sea level variations i e with cyclogenesis happening within the latitude range from northern argentina to south brazil giving rise to equatorward moving coastal trapped waves along the continental shelf there are also some significant and important differences at one hand the areas of maximum correlation with atmospheric pressure are located over the ocean top panels fig 7 possibly reflecting the mean position of the low pressure centers of the northeastward moving atmospheric frontal systems gan and rao 1991 the reasons for the different locations for the longer and shorter period bands eastward for the former and westward for the latter are not clear at this point and a physical rationale for this behavior is beyond the scope of this work on the other hand the areas of maximum correlation with wind speed are located near the coast mostly over the continental shelf center and lower panels fig 7 this is coherent with observed changes in wind direction over the continental shelf switching from northeast winds during good weather conditions to south southwest winds when under the influence of the western side of the atmospheric cyclones this change in wind direction over the shelf is the primary forcing of the continental trapped waves that influence the sea level along the brazilian coast accordingly higher correlations are found for the along shore component of the wind at latitudes southward from the three coastal stations areas of maximum correlation with zonal winds correspond more closely with the latitude range from the southern imbituba to the northern ilha fiscal stations possibly reflecting some local forcing upon the sea level 3 2 process based model this section presents an analysis of the coastal sea level simulated by the process based model see freitas et al 2021 for a more thorough discussion of the model results and comparisons with observations in general the model captures in a very realistic way the propagation of coastal trapped waves along the continental margin of the south american continent generated mostly by atmospheric frontal systems originated in the latitudes of northern argentinian uruguay and south brazil these waves show high energy levels for the same spectral bands presented in fig 6 with maximum wave height reaching 1 m and along shelf wavelengths of 8000 km the cross correlation analysis between simulated sea level at the three coastal stations is presented in table 4 coefficient of determination and time lags are very similar to observations see table 3 for the high frequency band which is the most energetic part of the total signal for the low frequency band correlations between simulated sea levels are higher than the corresponding values for observations suggesting that the observed signal contains information possibly associated with local forcing that is not captured by the hydrodynamic model the time lags at low frequencies are also higher in the model than in the observations by roughly 40 to 50 indicating a slower northward propagation of the sea level signal in the model those differences in the simulated behavior of the sea level signal might account for a significant part of the uncertainties related to the model simulation a similar cross correlation analysis was performed for the residual i e the difference between the simulated and the observed sea level table 5 as illustrated in fig 8 this residual cannot be attributed only to noise but has a characteristic oscillatory behavior the significant energy levels presented at the same frequency bands as the observed and simulated signals point to a phase error in the simulation which may account for a large part of the model uncertainties the significant correlation between the residual at the three stations indicates that the error is coherent along the coast areas of maximum correlation were computed between the atmospheric forcing fields and simulated sea level residue sea level and measured sea level at the three coastal stations these areas are illustrated for the correlation with cananéia station in fig 9 the general behavior is similar for the other coastal stations regions of maximum correlation with observed and simulated sea level are very similar indicating the quality of the hydrodynamic model to capture the sea level forcing mechanisms for both frequency bands the meridional wind component has always the highest correlation followed by wind pressure and zonal wind component correlation with the residue sea level on the other hand may indicate regions where the model is inaccurate the origin of this inaccuracy is not clear and may be related to the hydrodynamic model the atmospheric model the data assimilation techniques or a combination of different sources regions of maximum correlation with the residues are located very close to the coast for all variables coastal regions are known as complicated regions for atmospheric and oceanographic models since they are transition zones with abrupt changes in topography heat fluxes salinity etc in addition the lag related to the residue maximum correlation is around 3 times larger than that for the sea level signal suggesting that the differences in sea level that occur between simulated and observed data may be related to phenomena that occurred further south and took days to reach the region of interest 3 3 data based model the results for the input selection following the procedure described in the material and methods section are presented in table 6 for the four tests in experiments e1 and e2 for each coastal station the table columns present in decreasing order the inputs that mostly improve the simulated sea level regarding the atmospheric forcing the meridional component of the wind velocity is generally the most significant input reflecting the basic forcing mechanism for the generation of coastal trapped waves in tests b and d in which the forcing signals are splitted into high and low frequency bands the high frequency winds are mostly relevant in e2 data based only model but the low frequency has a larger impact in the combined approach 3d atmospheric pressure appears as the second most significant forcing field while the zonal wind velocity component is only marginally relevant e3 the combined approach differs from e2 the data based only approach basically for using the simulated sea level in e1 as an input for all tests in e3 the simulated sea level sse is always the most relevant input the input selection procedure is based on the most relevant inputs for each station ilha fiscal and cananéia results show that the atmospheric relevance in sea level oscillation are very similar for these two stations however imbituba showed some differences in the selection procedure especially in experiment 3 this station is closer to the area where the coastal trapped waves are generated which can lead to different forcing mechanisms which is corroborated by the results presented in fig 7 showing different areas of influence for imbituba the impact of the data based and combined approaches upon the simulated sea level when compared to the process based model is synthesized in fig 10 which shows the correlation of determination and the rmse between the simulated and observed sea level at each coastal station a few general statements can be advanced based on the patterns that emerge from this figure subject however to exceptions or particular behaviors the data based approach e2 has similar skills compared to the process based approach e1 in simulating sea level at the three locations investigated it is important to notice that the hydrodynamic model however simulates sea level for all grid points along the entire atlantic ocean and not just for a few selected locations notice also that correlations are already high and rmse low for the process based approach but as long as some few locations along the coast are the most significant for practical applications involving sea level modeling these results highlight per se the value of the data based approach the combined approach e3 combining both the process based simulation with the data based model improves the sea level simulation when compared with the process based or the data based only approaches in general the combined approach e3 using the splitted signal into high and low frequencies and using the residual sea level for establishing the areas of maximum correlation between sea level and the atmospheric forcing 3d reaches the highest correlation and the lowest rmse for the simulated sea level the choice among different combinations of input fields may be somewhat dependent upon the location being evaluated in this respect the results in cananéia and ilha fiscal are very similar but differ in some aspects from those in imbituba for instance considering the sea level signal not the residual and splitting the input into high and low frequencies 3b is very efficient for imbituba but does not improve upon e2 in cananéia or in ilha fiscal on the other hand using the residual sea level and the non splitted signals 3c is very successful in cananéia and ilha fiscal but not so much in imbituba despite being very similar the results from cananéia also differed from ilha fiscal in some aspects in cananéia the most efficient test was using a full signal 3c while in ilha fiscal the best result was archive splitting the input in high and low frequencies 3d once more there are some general rules to be followed in order to improve efficiency but those rules do not always apply and the selection procedure should be dependent on the data to be evaluated it is possible that considering longer series and more locations in the analysis could reduce this location dependency and generate more general rules for input selection 4 discussion there is no consensual scientific nomenclature to refer to a combination of process based and data based models some authors consider any combination of observational data and dynamic model as data assimilation moore et al 2019 oddo et al 2016 while others have called this a neural network adapted to physics muralidhar et al 2018 in this study we avoid such a controversy and refer to it as a combined approach a dichotomy between process based models and data based models however is only theoretical in practice dynamic models employ several empirical equations which are based on observational data at the same time there has been a long debate in the scientific community about the use of physical knowledge in data based models davis and marcus 2015 although several authors agree that both extremes generate inaccurate simulations it is not clear what is the optimal combination between them muralidhar et al 2018 while this is still a matter of debate and a subject for many studies there are possibly multiple combinations for different objectives predicting time series is a difficult task due to the risk of overfitting on the dataset using very large inputs with highly correlated variables can lead to overfitting once the model tries to fit a complex function in the past that cannot be extrapolated to the future a very efficient way to avoid this is to use physical knowledge to reduce the input in this study an algorithm was developed based on prior scientific knowledge of the physical dynamics to reduce the inputs of the neural networks improving efficiency and precision in the sea level prediction in the e2 experiment in which only a data based model was used tests not included in this paper performed with the full atmospheric dataset without reducing the input showed overfitting problems when the algorithm for reducing the input was applied however the results improved significantly in the e3 experiment a step further was taken in the combined approach using both the data based and the process based models to improve efficiency and accuracy in this experiment a data based model was used only for the non linear part of the data in this way the network was able to learn more focused on the part where the process based model was unable to solve the opposite of overfitting is underfitting the under adjustment occurs when there is still room for improvement in the train data this can happen for several reasons if the model is not powerful enough is over regulated or has simply not been trained long enough this means that the network has not learned the relevant standards in the training data for this study several tests using different numbers of neurons and layers were performed to avoid underfitting these tests showed that the input selection should have a higher impact on the sea level prediction then the number of neurons and layers this result agrees with kim et al 2016 who found that the selection of a proper input data set is crucial to the success of a neural network to predict storm surges identifying the causes of misleading prediction is a topic of intense debate oberkampf et al 2002 lima et al 2019 lermusiaux et al 2006 strobach and bel 2017 while this is beyond the scope of the present study our results can contribute to the discussion with some pathways to be followed uncertainties in physical models often have multiple sources numerical approximations spatial or temporal resolution forcing fields inadequate parameterizations ignored or misrepresented processes and general simplifications data based models are capable of reducing those uncertainties even without a complete understanding of its sources nevertheless results from such models combined with data analysis can help to indicate some potential sources in this study three possible error sources in sea level prediction have been raised from the analysis of the model results the slower propagation of coastal trapped waves in the model uncertainties in the atmospheric forcing and ignored smaller scale processes considering just the sea level signal propagating along the coast in the frequency band from 0 3 to 0 03 day 1 the first possible source of error seems to be related to the observed and simulated phase lags along the coast wave propagation in the process based model is slower than the observed values for periods longer than 15 days it is uncertain whether the model data differences may be attributed to some local phenomena to oceanic influence upon coastal sea level or to the coastal trapped waves themselves in this last case one can only speculate on the possible roles of bottom friction parameterization for the barotropic modes in shallow waters for wind waves some studies have shown that the bottom friction depends on wave height madsen et al 1988 wolf 1999 soulsby and clarke 2005 the second source of errors in the process based models raised from the results are the atmospheric uncertainties the results show that the experiment 2 sea level improved considerably when atmospheric inputs correlated with the experiment 1 residues were added e2 tests c and d for those tests even if the simulated sea level in e1 was not explicitly used as input e2 improved its prediction using variables that were connected to the residues of e1 one possible explanation still under investigation is that e1 errors are associated with atmospheric forcings atmospheric reanalysis from cfsr shows good agreement with observation with an underestimation of 3 for the upper percentile stopa and cheung 2014 the upper percentile is usually the most critical for sea level once ctw storm surges and wind setup are generated by stronger wind velocities the third possible source of uncertainties in process based models are the ignored smaller scales processes these models are usually linked with a specific scale range of interest and some phenomena are necessarily left behind in this case the so called model errors computed as the differences between model results and in situ data may not be really errors in the sense that the model was never meant to simulate the features responsible for such differences small or short scale processes however may interact or impact processes in longer spatial or time scales and vice versa idier et al 2019 nesting the model in a more refined grid to solve smaller scales may be necessary in particular areas of interest specially for processes that interact at other scales wave setup is an example of this process where breaking wind waves induce sea level elevation at the coast over many wave groups woodworth 2018 in many regions wave set up can contribute up to 20 of the storm surge signal rautenbach et al 2020 marsooli and lin 2018 a coupled wave circulation model system would be needed to improve sea level prediction taking both short scale gravity waves and larger scale ocean and shelf circulation into account in purely process based models staneva et al 2017 similar considerations can be applied to river runoff which may contribute to sea level variability near major rivers and estuaries wijeratne et al 2008 piecuch et al 2018a there are many studies that use neural networks to predict sea level typically these studies focus on extreme sea levels sahoo and bhaskaran 2019 kim et al 2019 chen et al 2012 tseng et al 2007 or have a limited forecast horizon at most 24 h kim et al 2016 french et al 2017 oliveira et al 2009 few studies provide an extended forecast to several days bajo and umgiesser 2010 makarynska and makarynskyy 2008 in the proposed methodology the delays applied to the input variables in the neural network do not place a limit on the forecasting horizon the input variables are the results of hydrodynamic and atmospheric models that usually can provide forecasts for the next 7 days or more the main differences between the results that were presented in this study and an operational forecast for sea level would be the larger uncertainties related to the neural network inputs both the hydrodynamic hycom and the atmospheric cfsr models presented in this study use data assimilation throughout the whole period in an operational forecast system data assimilation is limited to the beginning of the forecast therefore larger uncertainties are likely to occur in those systems assuming that errors are larger for operational predictions it is possible that the proposed methodology can yield even better results once it has even more room to improve this prediction experiments considering the results of operational forecast must be performed to prove this hypothesis 5 conclusions accurate prediction of sea level in coastal regions is an area of immense scientific interest having also direct social and economic implications although sophisticated hydrodynamic models have been applied over time for operational forecast uncertainties may still be significant neural networks emerge as alternative methods for sea level prediction totally ignoring process physics results of sea level considering only data based model experiment 2 were compared with the process based model experiment 1 and showed similar accuracy hydrodynamic models have the advantage of fully understand the physics behind the phenomena but are very computationally expensive comparing to neural networks in the present study a combined approach was implemented applying neural networks to predict that part of the sea level signal that is not fully represented by the hydrodynamic model preprocessing the data taking into account statistical correlations between the desired signal and the physical forcing was shown to be critical to the success of selecting inputs for the neural network a systematic methodology was proposed to select these inputs among a set of possible candidates in the particular case investigated in the present study the proposed methodology significantly improved the sea level prediction as simulated by an operational implementation of the hycom ogcm at three coastal stations situated along the brazilian southeastern coast for the frequency band from 0 3 to 0 03 days 1 this frequency range is associated primarily with propagation of coastal trapped waves along the brazilian continental shelf and possibly with local wind forcing the most suitable process based models to represent generation and propagation of coastal trapped waves are the ocean general circulation model because of the large spatial scale associated with this phenomena the observed sea level however may as well contain signals associated with other phenomena that may or may not be represented in the model the data based model was trained with sea level data from the imbituba cananeia and ilha fiscal stations and with atmospheric fields from the cfsr reanalysis the same fields that forced the hydrodynamic model the proposed methodology considering both process based and data based models were shown to reduce the error between simulated and observed sea level in 20 to 30 depending on the station moreover the correlation of determination increased for all stations showing that not only the absolute values improved but also the variability of the signal this improvement is accomplished even without a complete understanding of the error sources as long as the signals of the different phenomena are captured by the in situ data this methodology has the potential to improve sea level prediction anywhere data is available this conclusion might also be true for any physical process with significant uncertainties credit authorship contribution statement bruno vicente primo de siqueira conceived of the presented idea developed the theory performed the computations investigate coastal trapped waves supervision discussed the results and contributed to the final manuscript afonso de moraes paiva conceived of the presented idea discussed the results and contributed to the final manuscript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors wish to thank all the researchers and students from the physical oceanography laboratory lof of coppe ufrj for a continuous and stimulating discussion this study was financed in part by the coordenação de aperfeiçoamento de pessoal de nível superior brasil capes finance code 001 model results were obtained within the remo oceanographic modeling and observation network project 
