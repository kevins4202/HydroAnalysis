index,text
24025,the present study is concerned with direct numerical simulation dns of turbulent air flow over a waved water surface three dimensional turbulent couette flow is considered in dns as a model of a constant flux layer in the marine atmospheric surface layer two dimensional stationary waves at the water surface are prescribed and assumed to be unaffected by the air flow we consider capillary gravity water surface waves and are interested in the influence of parasitic capillary ripples riding on the carrier energy containing waves on the properties of the air flow the surface waves are prescribed and considered to be stationary the capillaries being in phase with the carrier wave the surface elevations spectra are also prescribed and mimicking stationary capillaries riding on stokes waves observed in a 2d numerical simulation of water surface capillary gravity waves by hung tsai 2009 the bulk air velocity and the carrier water surface waves lengths are considered in our dns in the range of 3 to 5 m s and 3 to 7 cm respectively under these conditions the capillaries are found to be submerged within the viscous sublayer of the atmospheric boundary layer our dns results show that although the flow fields are characterized by instantaneous separations of the boundary layer the ensemble wave phase averaged flow fields are non separating and well predicted by a quasilinear theoretical model we find also that capillaries mitigate the development of coherent horse shoe vortex structures as compared to the no ripples flow case we further use dns results and quasilinear model formulation to parameterize the water surface roughness height in terms of critical layer thickness and the amplitude of a dominant energy containing harmonic of the water surface elevation spectrum keywords direct numerical simulation turbulent wind two dimensional water waves capillary ripples 1 introduction the processes of turbulent exchange between the atmosphere and the ocean directly influence the dynamics of the marine atmospheric boundary layer and climate modeling of these processes is based on parameterization which relates turbulent fluxes with gradients of the mean fields of air temperature and velocity via bulk coefficients these coefficients are dependent on the details of the interaction between wind and surface waves fairall et al 2003 one of many factors complicating this interaction is the presence of capillary ripples on the carrier surface wave longuet higgins 1963 the effects of capillary ripples on the near surface water layer were investigated in details both in laboratory experiments ermakov et al 1986 and numerical simulations hung and tsai 2009 tsai and hung 2010 tsai et al 2013 however until recently there have been no detailed studies in the literature on the effects of capillary ripples on the atmospheric boundary layer the presence of capillary ripples significantly complicates measurements of the air flow parameters in the vicinity of the water surface at heights of the order of 1 mm in laboratory experiments donelan et al 2005 reul et al 1999 troitskaya et al 2011 2014 on the other hand the flow characteristics in this near surface layer define whether the air flow is separating or non separating which is important for theoretical modeling of wind wave interaction since capillary ripples are not resolved in large eddy simulation les their effects on the air flow are usually taken into account by modifying a surface roughness parameter in bulk formulas to evaluate unresolved turbulent stresses at the water surface sullivan et al 2008 however how this effective roughness is related to the surface elevation spectra and the airflow structure in the vicinity of the capillaries remains unclear on the other hand sufficient resolution of the capillaries can be achieved in direct numerical simulation dns dns resolves all physically important flow scales up to the viscous dissipation scale and thus does not require any closure hypothesis in the early studies e g sullivan et al 2000 dns was performed at a relatively low reynolds number based on the wave length λ air bulk velocity u 0 and molecular kinematic viscosity ν re 8800 and wave slope 2πa λ ka 0 1 where a is the wave amplitude yang and shen 2010 investigated the properties of the air flow above water waves by performing dns with slope up to ka 0 25 and re 10 000 a still larger reynolds number re 15 000 and wave slope ka 0 2 was considered in dns by druzhinin et al 2012 however in all these studies the effects of capillary ripples were not considered dns has been used to investigate the dynamics of a deformable air water interface and growth of interfacial waves by lin et al 2008 zonta et al 2015 2016 and campbell et al 2016 deike et al 2016 studied the process of wave breaking and air entrainment breaking water surface waves affected by a turbulent couette air flow was investigated by yang et al 2018 ling et al 2019 performed direct numerical simulation of a two phase gas liquid mixing layer under the absolute instability regime in these studies a two way coupled situation was considered where air and water flow fields developed simultaneously affecting each other in the present study we perform for the first time direct numerical simulation of a turbulent air flow over the water surface and consider surface waves covered with parasitic capillary ripples these parasitic capillary waves with length scales ranging from a few centimeters down to fractions of millimeters can be distributed over the entire surface or trapped on the leading slope of the carrier wave generation of these ripples is related to the non linear dynamics of the carrier capillary gravity wave cgw and was considered in detail by hung and tsai 2009 their results show that in the quasi steady asymptotic state cgw profile consists of a capillary train with an approximately constant number of ripples riding on the dominant gravity wave the results also show that these ripples can be treated as stationary with respect to the carrier surface wave as done in the previous dns studies sullivan et al 2000 yang and shen 2010 druzhinin et al 2012 we assume that the impact of the wind on the waved surface can be neglected during the considered time interval and consider stationary surface waves yang and shen 2009 conducted one way dns and air water coupled simulations and found minor effect of the coupling their conclusion may be used to justify the simplification of using stationary wavy boundary for air flow simulation in the present study we prescribe different surface elevation spectra mimicking the stationary parasitic capillaries observed by hung and tsai 2009 the bulk air velocities and the carrier water surface wave lengths considered in our dns are in the range of 3 to 5 m s and 3 to 7 cm respectively under these conditions the capillaries are found to be submerged within the viscous sublayer of the atmospheric boundary layer we study the effects of the capillaries on the development of coherent horse shoe vortices and instantaneous separations of the boundary layer and compare the dns results for ensemble phase averaged flow fields with predictions of a quasilinear theoretical model we further use the dns results and the quasilinear model formulation to parameterize the water surface roughness height in terms of the critical layer thickness and the amplitude of a dominant energy containing harmonic of the water surface elevation spectrum the paper is organized as follows in section 2 governing equations and numerical method are described section 3 discusses the dns results obtained for both instantaneous and ensemble phase averaged flow fields and the mean profiles the conclusions are given in section 4 2 governing equations and numerical method we perform a direct numerical simulation dns of a turbulent couette flow over a waved water surface the surface elevation consists of a two dimensional stationary carrier wave with amplitude a lengh λ and phase velocity c and parasitic capillaries riding on the carrier wave the scheme of the numerical experiment is similar to the one employed in druzhinin et al 2012 where dns of the turbulent air flow over a periodic stationary wave without ripples was performed cf fig 1 computations are performed in a reference frame moving with velocity c where the lower boundary representing the waved surface is stationary a no slip boundary condition is considered so that the wind flow velocity at this boundary coincides with the velocity in the water wave and is independent of time a cartesian framework is considered where x axis is oriented along the mean wind flow z axis is directed vertically upwards and y axis is transversal to the mean flow and parallel to the wave front the computational domain has sizes l x 6λ l y 4λ and l z λ in the x y and z directions and the air flow is assumed to be periodic in the x and y directions also a no slip boundary condition is prescribed at the upper horizontal plane which is assumed to be moving with bulk velocity u 0 in the x direction this condition provides an external momentum source due to the action of the viscous shear stress which compensates viscous dissipation in the boundary layer and makes the flow statistically stationary the numerical algorithm is based on the integration of full 3d navier stokes equations for an incompressible fluid written in the form cf e g monin and yaglom 1971 1 u i t u i u j x j 1 ρ p x j ν 2 u i x j x j 2 u j x j 0 where u i i 1 2 3 u v w are air velocity components in the cartesian framework x i i 1 2 3 x y z ρ is the air density assumed to be a uniform constant ν is the air kinematic viscosity and p is the pressure dns uses dimensionless variables normalized with wavelength λ and bulk velocity u 0 the pressure is normalized by ρu 0 2 the air flow bulk reynolds number is then based on λ u 0 and ν 3 re u 0 λ ν the water surface elevation z s x is defined implicitly by a conformal mapping relating the cartesian coordinates x y z to curvilinear coordinates ξ y η as 4 x ξ n 1 a n exp k n η sin k n ξ φ n z η n 1 a n exp k n η cos k n ξ φ n where k 1 k 2π λ is the wave number of the carrier wave with amplitude a 1 a and phase φ 1 0 and k n kn a n and φ n n 2 are wavenumbers amplitudes and phases of its higher harmonics due to mapping 4 the waved water surface in cartesian coordinates z s x is transformed into a flat surface η 0 two different cases of surface elevations are considered in dns in one denoted as ap case the amplitudes and phases a n and φ n are prescribed analytically and simulate a carrier stokes wave with imposed parasitic capillary ripples in another referred to as ht case a n and φ n are defined by the coefficients of the fourier transform of the stationary surface elevations obtained in 2d numerical simulation of capillary gravity surface waves by hung and tsai 2009 with spatial periods of the carrier wave λ 5 cm and 7 cm in both ap and ht cases the slope of the carrier wave is close to 0 2 defined by the product of the amplitude and wavenumber of the fundamental harmonic k 1 a 1 2 π a λ fig 2 presents surface elevations considered in the dns runs the corresponding parameters are listed in table 1 in both ap and ht elevation cases they can be distinguished by two characteristic distributions of ripples with respect to the carrier wave crest ripples can be distributed either uniformly over the crest or predominantly on the lee ward side of the crest the uniform stationary ripples distribution was obtained in 2d simulation by hung and tsai 2009 with carrier wavelength λ 5 cm runs ht2 5 in table 1 and the lee ward side distribution was obtained with the carrier wavelength λ 7 cm runs ht6 9 the ripples amplitudes in the stationary distributions obtained by hung and tsai 2009 depended also on the initially prescribed carrier wave slope the elevation types where the ripples are larger runs ht4 5 8 9 are denoted as increased amplitude in table 1 in the ap case we prescribed the amplitudes and phases so as to mimic different ripples distributions obtained by hung and tsai 2009 for example the elevations in runs ap3 4 are similar to the elevations in runs ht2 3 cf fig 2b c and g h consideration of ap ripples allows us to vary their amplitude and ratio of the wave phase velocity vs air flow bulk velocity in particular c u 0 0 05 in cases ap3 5 7 9 cf table 1 varying the ripples amplitude allows us to study its effect on the dynamics of the boundary layer vortex structures unfortunately in the ht cases the reynolds number becomes prohibitively large for c u 0 0 1 in order to elucidate the effects of parasitic capillaries on the air flow topological structure and statistics we also performed dns runs with elevations without ripples in both ap and ht cases runs ap1 2 and ht1 respectively cf fig 2a and f dns was also performed for different wave age parameter c u 0 and bulk reynolds number cf table 1 in the ht case wave ages c u 0 0 1 and c u 0 0 2 were considered whereas the reynolds number re was defined by c u 0 and the carrier wave length λ from the dispersion relation 5 c λg 2 π 2 πσ λ 1 2 where the gravity acceleration g 980 cm s2 and surface tension σ 72 cm3 s2 the wave celerity is defined as c 29 5 cm s for λ 5 cm and c 34 cm s for λ 7 cm thus in runs ht2 5 λ 5 cm the bulk air velocity equals u 0 2 95 m s and in runs ht16 9 λ 7 cm u 0 3 4 m s and the reynolds number eq 3 was evaluated in the range from 4917 to 15 870 for different wave age c u 0 and carrier wave length λ cf table 1 in the ap case two values of the wave age 0 05 and 0 1 were considered and the reynolds number was set to equal 10 000 in all runs then the bulk air velocity and surface wavelength u 0 and λ can be defined from eqs 3 and 5 for the prescribed wave age c u 0 cf table 1 taking into account eq 4 the velocity boundary conditions at the waved surface η 0 in the ap case were prescribed in the form 6 u 1 ξ y 0 c n 1 k n a n cos k n x ξ 0 φ n 1 7 u 2 ξ y 0 0 8 u 3 ξ y 0 u 1 ξ y 0 z ξ z η η 0 eq 8 ensures that the air flow velocity component normal to the water surface u η vanishes at η 0 so that the flow streamline in the x z plane coincides with the boundary profile z s x in the ht case the air velocity at the waved surface was prescribed by numerical data of hung and tsai 2009 at the upper boundary η λ in both ap and ht cases the no slip condition for the wind velocity was prescribed with respect to the plane moving with velocity u 0 c as 9 u 1 ξ y λ u 0 c 10 u 2 ξ y λ 0 11 u 3 ξ y λ 0 it is important to note that in the present study similarly to the earlier studies by sullivan et al 2000 yang and shen 2010 and druzhinin et al 2012 we consider the uncoupled model and stationary surface waves in assessing the validity of simulating turbulent air flow using prescribed wavy boundary conditions yang and shen 2009 performed both uncoupled air flow over stationary stokes wave simulations and air water coupled simulations with a non breaking water surface wave evolving under the impact of the air flow the results show that the coupling does not significantly alter the properties of the air flow as compared to the uncoupled simulation this conclusion justifies the simplification of using stationary wavy boundary for the air flow simulation both in the present study and in the previous studies accordingly the term dns direct numerical simulation used by by sullivan et al 2000 yang and shen 2010 and druzhinin et al 2012 and in the present study refers to the simulation of the air flow via direct numerical solution of the navier stokes equations subject to the solenoidal condition eqs 1 2 without employing any subgrid turbulent model simplifying assumptions are that the impact of the air flow on the surface wave is negligible and the waved water surface remains stationary during the simulation time eqs 1 and 2 were solved in curvilinear coordinates ξ y η related to the cartesian coordinates x y z by the conformal mapping eq 4 the equations were discretized in a rectangular domain with sizes 0 x 6λ 0 y 4λ and 0 z λ by employing a finite difference adams bashforth method of the second order accuracy on a staggered grid consisting of 360 240 180 nodes an additional mapping was employed to compress the grid in the vertical direction near the boundaries in order to resolve the viscous boundary layer druzhinin et al 2012 the poisson equation for the pressure was solved by iterations numerical method of integration of eqs 1 and 2 used in the present study is quite similar to that employed by druzhinin et al 2012 in the latter case we validated our numerical code by comparison with both available laboratory data and dns results by sullivan et al 2000 our dns employed the grid with mesh sizes δx λ 1 60 in the streamwise and spanwise directions whereas in the vertical direction the mesh size increased from δz 1 λ 0 0008 near the walls to δz 2 λ 0 009 in the center of the computational domain when normalized by the wall scale ν u the mesh sizes for the considered re in the ripple free case was found to be δx 6 in the horizontal plane and varying from δz 1 0 3 near the boundaries to about δz 2 3 in the middle of the domain comparable mesh sizes were used in other dns studies of air flow over waved water surfaces for example sullivan et al 2000 employed the grid with meshes in the notations in the present paper δx 10 δz 1 1 δz 2 5 and yang and shen 2010 employed grid meshes δx 6 δz 1 0 4 δz 2 8 5 these meshes are generally regarded as sufficient to resolve fine scale turbulent motions in dns of turbulent boundary layer flows as discussed by moin and mahesh 1998 in order to check the effect of mesh resolution we performed additional dns runs using a finer mesh of 480 320 240 grid nodes i e increased the resolution by 30 and found a negligible difference in the results both for instantaneous flow and mean fields as compared to the mesh with 360 240 180 nodes the air velocity field was initiated as a weakly perturbed laminar couette flow u i ηu 0 δ ix u if i 1 2 3 where u if is a divergence free isotropic homogeneous random field with a modulus amplitude of 0 05u 0 after the initialization the integration of the air flow equations of motion 1 and 2 was firstly performed during the time interval 0 tu 0 λ 200 a detailed study of the dynamics of turbulence spectra and transition from laminar to turbulent regime is beyond the scope of the present dns study and left for a future research after this transient stage a fully developed turbulent flow regime set in and a statistically stationary state was established further at times 200 tu 0 λ 400 a statistical sampling of the flow was performed and instantaneous flow fields were studied 3 numerical results 3 1 instantaneous fields figs 3a and 3b present a vorticity modulus field ω ω i ω i 1 2 obtained in central x z plane at time moment u 0 t λ 400 in dns runs ht1 and ap2 stokes wave without ripples ht4 and ap6 lee ward side ripples with increased amplitude and ht8 and ap8 uniform ripples fig 3a shows the results obtained with ht elevations and fig 3b shows the fields obtained with ap elevations the i th vorticity component is related to the velocity gradient tensor u i x j via 12 ω i ε ijk u i x j where ε ijk is the antisymmetrical tensor and the summation over repeated indices is performed as the figures illustrate in the absence of ripples the instantaneous flow separation and related shedding of vortex structures occur on the windward sides of the wave crests ht1 case the presence of ripples both with lee ward side and uniform distribution near the crests cases ht4 ap6 and ht8 ap8 respectively mitigates both the instantaneous flow separation and vortex shedding in the vicinity of the crests in order to investigate further how the presence of ripples affects the development of vortex structures we evaluated the eigenvalues of the velocity gradient tensor and used its imaginary part λ ci which is also related the enstrophy i e the vorticity square cf zhou et al 1999 to identify the structures fig 4 presents the instantaneous isosurface distributions of λ ci obtained in dns runs ap2 a ap6 b and ap8 c analogous to the respective cases of ripples distribution in ht1 ht4 and ht8 in fig 3a and ap2 ap6 and ap8 in fig 3b in the proximity of the wavy surface within the layer z 100 note that in evaluating λ ci we subtracted the component attributed to the modulation of wave field u i u i to be defined below in eqs 13 and 16 and thus λ ci is directly related to the swirling strength of the vortex structures as revealed in fig 4b the presence of capillary ripples with sufficiently large amplitude apparently retards the formation of coherent vortical structures the retardation effect becomes insignificant as the ripple amplitude decreases as shown in fig 4c in which the ripple amplitude is decreased to half of the maximum amplitude in fig 4b but remains constant throughout the entire carrier wave surface such a trend is also consistent with that revealed by the streamline patterns of phase averaged flows shown below in figs 6 7 the educed vortical structures were further classified into three characteristic types elongated quasi streamwise vortices forward head points downstream and reversed horseshoe vortices to reveal the population and distribution pattern of each vortical structure the accumulated frequencies that a spatial coordinate is occupied by one of the three types of coherent vortical structure are shown in fig 5 the distributions are obtained by processing simulated flow fields at ten independent time instances as observed in fig 5 the population of the three types of coherent vortices all drastically decrease in the presence of increased amplitude capillary ripples fig 5b the effect reduces when the amplitude of the ripples decreases fig 5c thus the general conclusion drawn from the instantaneous flow fields is that parasitic capillaries mitigate vortex shedding and flow separation in the vicinity of wave crests and also retard the formation of coherent vortices as compared to the no ripples cases 3 2 phase averaged fields statistical sampling of the flow was performed in a statistically stationary state of a fully developed turbulent flow during the time interval 200 tu 0 λ 400 at discrete time moments t k k 1 500 with increment t k 1 t k 0 2λ u 0 in the statistical postprocessing analysis we firstly performed phase averaging which is equivalent to averaging over an ensemble of turbulent fluctuations this averaging was performed over y coordinate time and wave length the latter was evaluated as a window averaging and denoted by angular brackets thus for a given field f ξ y η t the phase averaged fields f and f 2 were determined as 13 f ξ η 1 6 n t n y j 1 n y k 1 n t n 0 5 f ξ nλ y j η t k 14 f 2 ξ η 1 6 n t n y j 1 n y k 1 n t n 0 5 f 2 ξ nλ y j η t k where n y 240 n t 500 and 0 ξ 1 the fluctuation or dispersion of field f was further obtained in the form 15 f 2 f 2 f 2 we also introduce rectangular brackets for the mean vertical profile f η obtained by additional averaging of the phase average f ξ η along the streamwise coordinate 16 f η 6 n x k 1 n x 6 f ξ k η where n x 360 statistical characteristics of the air velocity field were obtained by substituting the velocity components u x u y and u z in eqs 5 to 14 instead of f in case of the flux e g u x u z the product u x u z was substituted in eq 14 instead of f 2 and the difference u x u z u x u z was substituted in eq 15 fig 6 a f shows streamline patterns of the phase averaged airflow above surface waves obtained in dns runs ap1 6 cf table 1 the figures show that the streamlines of phase averaged velocity fields are non separating and the streamline patterns are similar to that of the kelvin cat s eye commonly observed in the vicinity of the critical layer cl this is in contrast to the presence of local separation phenomena observed in the instantaneous velocity fields in the vicinity of the wave crests cf fig 3a this feature of the turbulent air flow boundary layer over steep waves was also previously discussed in more detail by druzhinin et al 2012 and troitskaya et al 2014 who showed that local intermittent separation phenomena present in the instantaneous velocity field are eliminated by ensemble i e phase averaging as fig 6b c and e f illustrate the presence of ripples distorts the streamline patterns in the vicinity of the cl in that multiple local patterns with closed streamlines are created whereas the non closed streamlines oscillate the figures also show that with increasing c u 0 the thickness of patterns with the closed streamlines δ significantly increases to be discussed below we compared the results of dns with predictions of a quasi linear approximation model developed for the description of wind wave coupling by jenkins 1992 janssen 1989 and troitskaya et al 2014 this approach assumes that wave induced disturbances in the air flow are considered within the linear approximation and the only non linear effect taken into account is the deformation of the airflow profile due to the momentum flux from the wind to the waves whereas the mean airflow is treated as non separated for more details of the mathematical formulation of the model see troitskaya et al 2014 the friction velocity in the turbulent boundary layer u and the amplitudes and phases of the harmonics the amplitudes and phases a n and φ n of the surface elevation in eq 4 were used as input parameters for the model the model yields vertical mean velocity profile and phase averaged stream function and velocity fields the model prediction for the mean flow streamline patterns for runs ap6 and ht4 are compared with the dns results in fig 7 the figure shows good agreement of model predictions with the numerical results and thus supports the assumption that the dominant nonlinear effect in wind wave coupling the deformation of the mean flow is well captured by the model 3 3 mean profiles rewriting eqs 1 and 2 in curvilinear coordinates and averaging along ξ and integrating over η as described in eq 10 yields the equation of conservation of the momentum flux in the air flow 17 u x u z z η u x 2 1 ρ p z ξ ν u x η u 2 here u is the conventional turbulent air velocity scale the friction velocity eq 17 can be rewritten as follows 18 u x u z z η u x z ξ 1 ρ p z ξ ν u x η u 2 the first term in eq 18 is the flux of the horizontal velocity in transversal direction with respect to lines η const introducing turbulent fluctuations of the velocity components u x u x u x u z u z u z gives from eq 18 19 u x u z z η u x z ξ 1 ρ p z ξ ν u x η u x u z z η u x 2 z ξ u 2 eq 19 can be split into three components of the air momentum flux terms across the coordinate lines η const 20 τ t η τ v η τ w η u 2 where the turbulent momentum flux is defined as 21 τ t η u x u z z η u x 2 z ξ the molecular viscous stress is defined as 22 τ v η ν d u x dη and the wave induced momentum flux is defined as 23 τ w η u x u z z η u x z ξ 1 ρ p z ξ the wave induced momentum flux vanishes with increasing distance from the water surface and the sum of the viscous and turbulent momentum fluxes tends to u 2 while τ w 0 determines the form drag imposed on the air flow by the water surface fig 8a b presents vertical profiles of the mean air velocity and the sum of turbulent and viscous momentum fluxes evaluated from the phase averaged fields obtained in dns runs ap1 10 as described in eqs 17 23 the results obtained for ht elevations are similar and not shown here the profiles are expressed in the dimensionless wall variables defined as follows 24 η η u ν 25 u u x u 26 τ 1 τ w u 2 fig 8c shows the profiles of the effective viscosity the sum of the molecular viscosity and the eddy viscosity also expressed in wall variables the effective viscosity can be evaluated from the mean velocity profile as 27 ν t u 2 d u x dz when written in the dimensionless variables the effective dimensionless viscosity ν t is expressed as a universal function of η 28 ν t f η as fig 8a illustrates in the presence of surface waves the airflow velocity is reduced as compared to the flat surface case this reduction is due to the flux of air momentum to the waves the differences in the profiles obtained for different wave celerity c u 0 are clearly visible the thickness of the jump in the profile of the momentum flux increases for larger ratio c u 0 this agrees with the streamline patterns in fig 6 which also shows that the thickness of the region of closed streamlines i e the thickness of the critical layer cl where the jump of the momentum flux occurs see e g haberman 1972 increases with c u 0 on the other hand as fig 8a and b illustrates the presence of ripples does not affect the velocity and momentum flux profiles this can be explained by the fact that the elevation of the water surface due to ripples is submerged within the viscous sublayer i e at distances η 5 from the water surface cf fig 6 this agrees with the experimental data by clauser 1956 who showed that the surface roughness height does not change if the roughness elements are immersed in the viscous sublayer i e their height does not exceed 5 units in wall variables the same flow feature is also observed in the case of the waves with ht elevations not shown here it is important to note also that since phase velocities of the parasitic capillaries and the carrier gravity wave are equal the height of the cl h or the height of the match layer for both types of waves is the same if we assume that the momentum flux to surface wave results from dynamics of the cl then the magnitude of the product kh where k is the peak wavenumber of either the capillaries or the carrier wave is important and influences wave growth rate as exp kh according to the miles theory for the carrier gravity wave factor kh is small kh 1 and exp kh 1 and thus the carrier wave uptakes momentum on the other hand for the capillaries kh 1 exp kh 1 so that the momentum flux to the capillary waves vanishes and these waves do not affect the airflow velocity profile this paradigm is in line with the predictions of the quasi linear model fig 9 compares the prediction of the quasi linear model with dns results for the average profiles of velocity stress and eddy viscosity obtained in runs ap6 and ht4 the comparison shows that the model reproduces the overall pattern and the integral parameters of the dns profiles in particular the deformation of the velocity profile related to the roughness length as well as the jump of the stress across the cl is well reproduced this can be explained by the fact that shapes of the profiles are formed due to momentum exchange of the mean flow with the fundamental harmonic of the wave induced disturbances which is captured by the quasi linear model note however that the fine details of the profiles are not reproduced correctly due to the effects of the nonlinear interaction between higher harmonics of the wave induced disturbances neglected by the model let us now investigate how the cl thickness related to the thickness of the jump of the momentum flux depends on the governing parameters the cl thickness can be determined from the streamline patterns as a thickness of a separatrix dividing the regions of closed and open streamlines cf maslowe 1986 when estimating the dependence of the cl thickness on the governing parameters we used a schematic dependence of the stream function on the coordinates in the cl in the form maslowe 1986 29 ψ z z c 2 2 d u x dz z z c ca 1 f x here z c is the level where u x c f x 1 is the oscillating shape of the water elevation scaled with the amplitude of the dominant harmonic a 1 it readily follows from eq 29 that the contour lines of function ψ i e the streamlines are closed if 30 z z c 2 ca 1 f x d u x dz z z c then the maximum thickness of the layer where the streamlines are closed is estimated as 31 δ ca 1 d u x dz z z c taking into account the definition of the effective viscosity coefficient and eqs 27 and 28 we find 32 d u x dz u 2 re f z thus eqs 31 and 32 yield 33 δ 2 f δ c u a here δ and a are the cl thickness and amplitude of dominant harmonic expressed in the wall variables fig 10a shows the dependence of δ vs c u a evaluated from the phase averaged streamline patterns obtained in dns as the figure illustrates the dns points collapse and are well described by the best fit function in the form full black line in fig 10a 34 δ 3 8 c u a eqs 29 and 30 show that f δ const that means that the cl is formed at the height where the eddy viscosity is not strongly varying figs 8 and 9 show clearly that the stress jump is created within the viscous sublayer and the lower part of the buffer zone where the eddy viscosity is comparable with the molecular viscosity fig 10b presents the dependence of the dimensionless wave momentum flux at the water surface τ w 0 τ w 0 u 2 1 τ 0 on the amplitude of the dominant harmonic a as the figure illustrates there is a good correlation between these two quantities figs 8a and 9a show that sufficiently far from the wavy surface the velocity profile of the air flow is well described by a logarithmic asymptotics 35 u 1 κ ln η z 0 thus the dimensionless roughness height z 0 can be deduced from eq 21 as follows we use the gradient approximation for the turbulent stress in the form 36 τ ν t du d η the substitution of eq 36 into eqs 35 and 21 yields 37 ν t du d η 1 τ w η integrating eq 37 over η and taking into account of eq 36 gives 38 z 0 c 0 exp 0 τ w η ν t η d η at η δ here c 0 is the roughness height of the smooth surface c 0 0 11 cf monin and yaglom 1971 given the scale of τ w η δ is a function of c u a cf fig 10a and τ w 0 is a function of a cf fig 10b fig 11 compares the quasi linear model prediction for the roughness height z 0 a and the wave momentum flux at the air water interface τ w 0 b vs dns results the comparison reveals that the model underestimates the roughness height by approximately 20 whereas the jump of the momentum flux is reproduced with 3 accuracy thus we conclude that nonlinear interaction between higher harmonics of wave induced disturbances in the air flow neglected by the model may contribute up to 20 to the effective roughness of the waved water surface the correlation between δ and c u a is not pronounced the coefficient of determination equals 0 22 which allows us to express z 0 as a multiple regression function of a and δ fig 12a and b present the dependence of z 0 vs δ and a with the coefficient of determination of the single linear regression dependencies about 0 6 fig 12c shows the results of double regression 39 z 0 β 0 β 1 δ β 2 a where β 0 0 64 0 15 β 1 0 046 0 006 β 2 0 044 0 006 the coefficient of determination increases up to 0 9 the correlation coefficient equals 0 95 the correlation supports our assumption that the contribution of the first harmonic determines both δ and a 4 conclusions we have performed direct numerical simulation dns of turbulent air flow over a waved water surface and studied the influence of parasitic capillary ripples riding on the carrier energy containing surface waves on the properties of the air flow three dimensional turbulent couette flow has been considered in dns as a model of a constant flux layer in the marine atmospheric surface layer two dimensional stationary waves at the water surface have been prescribed and assumed to be unaffected by the air flow the surface elevations spectra have been prescribed and mimicking stationary capillaries riding on stokes waves observed in a 2d numerical simulation of water surface capillary gravity waves by hung and tsai 2009 typical values of air bulk velocity u 0 and the carrier water surface waves length λ in our dns varied in the range of 3 to 5 m s and 3 to 7 cm respectively under these conditions the capillaries were found to be submerged within the viscous sublayer of the atmospheric boundary layer the dns results show that although the flow fields are characterized by instantaneous separations of the boundary layer the ensemble wave phase averaged flow fields are non separating similar non separating mean flow fields were observed in dns of atmospheric boundary air flow over waved water surface without capillary ripples by yang and shen 2010 and druzhinin et al 2012 thus for the considered bulk parameters range the capillaries do not affect significantly the separation of the boundary layer moreover the streamlines patterns of the mean flow fields are well predicted by a quasilinear theoretical model troitskaya et al 2014 which also considers a non separating air flow we found also that the capillaries mitigate the development of coherent horse shoe vortex structures as compared to the no ripples flow case dns results and quasilinear model were used further to parameterize the water surface roughness height in terms of the critical layer thickness δ and the amplitude of a dominant carrier wave harmonic of the water surface elevation a we found that the roughness length and the wave induced air momentum flux are well described by a linear combination in terms of δ and a this agreement indicates that the dominant contribution in the air flow properties belongs to the first harmonic of the surface elevation spectrum present dns considers relatively low wind speed of the order of a few m s and short capillary gravity surface waves with wavelengths 10 cm and thus moderate reynolds number re 16 000 the results indicate that under these conditions the mean flow is non separating and the parasitic capillaries are immersed within the viscous sublayer and thus have little or no effect on the roughness height on the other hand the separation of the mean velocity field may occur and the surface roughness due to ripples may increase considerably at higher wind speeds and or longer surface waves due to a larger reynolds number therefore the obtained results could be only with caution extrapolated to field conditions with higher wind speeds and longer surface waves acknowledgements we are grateful to the anonymous referees for all comments and suggestions this work is supported by the russian taiwanese joint research project through the russia rfbr grant no 16 55 52022 and the taiwan most grant 105 2923 m 002 006 my3 yu t and o d are additionally supported by the rfbr grants nos 17 05 00703 18 05 60299 and by the ministry of education and science of the russian federation task no 0030 2019 0020 the postprocessing procedure and theoretical analysis of numerical data were supported by the grant of the russian science foundation no 19 17 00209 
24025,the present study is concerned with direct numerical simulation dns of turbulent air flow over a waved water surface three dimensional turbulent couette flow is considered in dns as a model of a constant flux layer in the marine atmospheric surface layer two dimensional stationary waves at the water surface are prescribed and assumed to be unaffected by the air flow we consider capillary gravity water surface waves and are interested in the influence of parasitic capillary ripples riding on the carrier energy containing waves on the properties of the air flow the surface waves are prescribed and considered to be stationary the capillaries being in phase with the carrier wave the surface elevations spectra are also prescribed and mimicking stationary capillaries riding on stokes waves observed in a 2d numerical simulation of water surface capillary gravity waves by hung tsai 2009 the bulk air velocity and the carrier water surface waves lengths are considered in our dns in the range of 3 to 5 m s and 3 to 7 cm respectively under these conditions the capillaries are found to be submerged within the viscous sublayer of the atmospheric boundary layer our dns results show that although the flow fields are characterized by instantaneous separations of the boundary layer the ensemble wave phase averaged flow fields are non separating and well predicted by a quasilinear theoretical model we find also that capillaries mitigate the development of coherent horse shoe vortex structures as compared to the no ripples flow case we further use dns results and quasilinear model formulation to parameterize the water surface roughness height in terms of critical layer thickness and the amplitude of a dominant energy containing harmonic of the water surface elevation spectrum keywords direct numerical simulation turbulent wind two dimensional water waves capillary ripples 1 introduction the processes of turbulent exchange between the atmosphere and the ocean directly influence the dynamics of the marine atmospheric boundary layer and climate modeling of these processes is based on parameterization which relates turbulent fluxes with gradients of the mean fields of air temperature and velocity via bulk coefficients these coefficients are dependent on the details of the interaction between wind and surface waves fairall et al 2003 one of many factors complicating this interaction is the presence of capillary ripples on the carrier surface wave longuet higgins 1963 the effects of capillary ripples on the near surface water layer were investigated in details both in laboratory experiments ermakov et al 1986 and numerical simulations hung and tsai 2009 tsai and hung 2010 tsai et al 2013 however until recently there have been no detailed studies in the literature on the effects of capillary ripples on the atmospheric boundary layer the presence of capillary ripples significantly complicates measurements of the air flow parameters in the vicinity of the water surface at heights of the order of 1 mm in laboratory experiments donelan et al 2005 reul et al 1999 troitskaya et al 2011 2014 on the other hand the flow characteristics in this near surface layer define whether the air flow is separating or non separating which is important for theoretical modeling of wind wave interaction since capillary ripples are not resolved in large eddy simulation les their effects on the air flow are usually taken into account by modifying a surface roughness parameter in bulk formulas to evaluate unresolved turbulent stresses at the water surface sullivan et al 2008 however how this effective roughness is related to the surface elevation spectra and the airflow structure in the vicinity of the capillaries remains unclear on the other hand sufficient resolution of the capillaries can be achieved in direct numerical simulation dns dns resolves all physically important flow scales up to the viscous dissipation scale and thus does not require any closure hypothesis in the early studies e g sullivan et al 2000 dns was performed at a relatively low reynolds number based on the wave length λ air bulk velocity u 0 and molecular kinematic viscosity ν re 8800 and wave slope 2πa λ ka 0 1 where a is the wave amplitude yang and shen 2010 investigated the properties of the air flow above water waves by performing dns with slope up to ka 0 25 and re 10 000 a still larger reynolds number re 15 000 and wave slope ka 0 2 was considered in dns by druzhinin et al 2012 however in all these studies the effects of capillary ripples were not considered dns has been used to investigate the dynamics of a deformable air water interface and growth of interfacial waves by lin et al 2008 zonta et al 2015 2016 and campbell et al 2016 deike et al 2016 studied the process of wave breaking and air entrainment breaking water surface waves affected by a turbulent couette air flow was investigated by yang et al 2018 ling et al 2019 performed direct numerical simulation of a two phase gas liquid mixing layer under the absolute instability regime in these studies a two way coupled situation was considered where air and water flow fields developed simultaneously affecting each other in the present study we perform for the first time direct numerical simulation of a turbulent air flow over the water surface and consider surface waves covered with parasitic capillary ripples these parasitic capillary waves with length scales ranging from a few centimeters down to fractions of millimeters can be distributed over the entire surface or trapped on the leading slope of the carrier wave generation of these ripples is related to the non linear dynamics of the carrier capillary gravity wave cgw and was considered in detail by hung and tsai 2009 their results show that in the quasi steady asymptotic state cgw profile consists of a capillary train with an approximately constant number of ripples riding on the dominant gravity wave the results also show that these ripples can be treated as stationary with respect to the carrier surface wave as done in the previous dns studies sullivan et al 2000 yang and shen 2010 druzhinin et al 2012 we assume that the impact of the wind on the waved surface can be neglected during the considered time interval and consider stationary surface waves yang and shen 2009 conducted one way dns and air water coupled simulations and found minor effect of the coupling their conclusion may be used to justify the simplification of using stationary wavy boundary for air flow simulation in the present study we prescribe different surface elevation spectra mimicking the stationary parasitic capillaries observed by hung and tsai 2009 the bulk air velocities and the carrier water surface wave lengths considered in our dns are in the range of 3 to 5 m s and 3 to 7 cm respectively under these conditions the capillaries are found to be submerged within the viscous sublayer of the atmospheric boundary layer we study the effects of the capillaries on the development of coherent horse shoe vortices and instantaneous separations of the boundary layer and compare the dns results for ensemble phase averaged flow fields with predictions of a quasilinear theoretical model we further use the dns results and the quasilinear model formulation to parameterize the water surface roughness height in terms of the critical layer thickness and the amplitude of a dominant energy containing harmonic of the water surface elevation spectrum the paper is organized as follows in section 2 governing equations and numerical method are described section 3 discusses the dns results obtained for both instantaneous and ensemble phase averaged flow fields and the mean profiles the conclusions are given in section 4 2 governing equations and numerical method we perform a direct numerical simulation dns of a turbulent couette flow over a waved water surface the surface elevation consists of a two dimensional stationary carrier wave with amplitude a lengh λ and phase velocity c and parasitic capillaries riding on the carrier wave the scheme of the numerical experiment is similar to the one employed in druzhinin et al 2012 where dns of the turbulent air flow over a periodic stationary wave without ripples was performed cf fig 1 computations are performed in a reference frame moving with velocity c where the lower boundary representing the waved surface is stationary a no slip boundary condition is considered so that the wind flow velocity at this boundary coincides with the velocity in the water wave and is independent of time a cartesian framework is considered where x axis is oriented along the mean wind flow z axis is directed vertically upwards and y axis is transversal to the mean flow and parallel to the wave front the computational domain has sizes l x 6λ l y 4λ and l z λ in the x y and z directions and the air flow is assumed to be periodic in the x and y directions also a no slip boundary condition is prescribed at the upper horizontal plane which is assumed to be moving with bulk velocity u 0 in the x direction this condition provides an external momentum source due to the action of the viscous shear stress which compensates viscous dissipation in the boundary layer and makes the flow statistically stationary the numerical algorithm is based on the integration of full 3d navier stokes equations for an incompressible fluid written in the form cf e g monin and yaglom 1971 1 u i t u i u j x j 1 ρ p x j ν 2 u i x j x j 2 u j x j 0 where u i i 1 2 3 u v w are air velocity components in the cartesian framework x i i 1 2 3 x y z ρ is the air density assumed to be a uniform constant ν is the air kinematic viscosity and p is the pressure dns uses dimensionless variables normalized with wavelength λ and bulk velocity u 0 the pressure is normalized by ρu 0 2 the air flow bulk reynolds number is then based on λ u 0 and ν 3 re u 0 λ ν the water surface elevation z s x is defined implicitly by a conformal mapping relating the cartesian coordinates x y z to curvilinear coordinates ξ y η as 4 x ξ n 1 a n exp k n η sin k n ξ φ n z η n 1 a n exp k n η cos k n ξ φ n where k 1 k 2π λ is the wave number of the carrier wave with amplitude a 1 a and phase φ 1 0 and k n kn a n and φ n n 2 are wavenumbers amplitudes and phases of its higher harmonics due to mapping 4 the waved water surface in cartesian coordinates z s x is transformed into a flat surface η 0 two different cases of surface elevations are considered in dns in one denoted as ap case the amplitudes and phases a n and φ n are prescribed analytically and simulate a carrier stokes wave with imposed parasitic capillary ripples in another referred to as ht case a n and φ n are defined by the coefficients of the fourier transform of the stationary surface elevations obtained in 2d numerical simulation of capillary gravity surface waves by hung and tsai 2009 with spatial periods of the carrier wave λ 5 cm and 7 cm in both ap and ht cases the slope of the carrier wave is close to 0 2 defined by the product of the amplitude and wavenumber of the fundamental harmonic k 1 a 1 2 π a λ fig 2 presents surface elevations considered in the dns runs the corresponding parameters are listed in table 1 in both ap and ht elevation cases they can be distinguished by two characteristic distributions of ripples with respect to the carrier wave crest ripples can be distributed either uniformly over the crest or predominantly on the lee ward side of the crest the uniform stationary ripples distribution was obtained in 2d simulation by hung and tsai 2009 with carrier wavelength λ 5 cm runs ht2 5 in table 1 and the lee ward side distribution was obtained with the carrier wavelength λ 7 cm runs ht6 9 the ripples amplitudes in the stationary distributions obtained by hung and tsai 2009 depended also on the initially prescribed carrier wave slope the elevation types where the ripples are larger runs ht4 5 8 9 are denoted as increased amplitude in table 1 in the ap case we prescribed the amplitudes and phases so as to mimic different ripples distributions obtained by hung and tsai 2009 for example the elevations in runs ap3 4 are similar to the elevations in runs ht2 3 cf fig 2b c and g h consideration of ap ripples allows us to vary their amplitude and ratio of the wave phase velocity vs air flow bulk velocity in particular c u 0 0 05 in cases ap3 5 7 9 cf table 1 varying the ripples amplitude allows us to study its effect on the dynamics of the boundary layer vortex structures unfortunately in the ht cases the reynolds number becomes prohibitively large for c u 0 0 1 in order to elucidate the effects of parasitic capillaries on the air flow topological structure and statistics we also performed dns runs with elevations without ripples in both ap and ht cases runs ap1 2 and ht1 respectively cf fig 2a and f dns was also performed for different wave age parameter c u 0 and bulk reynolds number cf table 1 in the ht case wave ages c u 0 0 1 and c u 0 0 2 were considered whereas the reynolds number re was defined by c u 0 and the carrier wave length λ from the dispersion relation 5 c λg 2 π 2 πσ λ 1 2 where the gravity acceleration g 980 cm s2 and surface tension σ 72 cm3 s2 the wave celerity is defined as c 29 5 cm s for λ 5 cm and c 34 cm s for λ 7 cm thus in runs ht2 5 λ 5 cm the bulk air velocity equals u 0 2 95 m s and in runs ht16 9 λ 7 cm u 0 3 4 m s and the reynolds number eq 3 was evaluated in the range from 4917 to 15 870 for different wave age c u 0 and carrier wave length λ cf table 1 in the ap case two values of the wave age 0 05 and 0 1 were considered and the reynolds number was set to equal 10 000 in all runs then the bulk air velocity and surface wavelength u 0 and λ can be defined from eqs 3 and 5 for the prescribed wave age c u 0 cf table 1 taking into account eq 4 the velocity boundary conditions at the waved surface η 0 in the ap case were prescribed in the form 6 u 1 ξ y 0 c n 1 k n a n cos k n x ξ 0 φ n 1 7 u 2 ξ y 0 0 8 u 3 ξ y 0 u 1 ξ y 0 z ξ z η η 0 eq 8 ensures that the air flow velocity component normal to the water surface u η vanishes at η 0 so that the flow streamline in the x z plane coincides with the boundary profile z s x in the ht case the air velocity at the waved surface was prescribed by numerical data of hung and tsai 2009 at the upper boundary η λ in both ap and ht cases the no slip condition for the wind velocity was prescribed with respect to the plane moving with velocity u 0 c as 9 u 1 ξ y λ u 0 c 10 u 2 ξ y λ 0 11 u 3 ξ y λ 0 it is important to note that in the present study similarly to the earlier studies by sullivan et al 2000 yang and shen 2010 and druzhinin et al 2012 we consider the uncoupled model and stationary surface waves in assessing the validity of simulating turbulent air flow using prescribed wavy boundary conditions yang and shen 2009 performed both uncoupled air flow over stationary stokes wave simulations and air water coupled simulations with a non breaking water surface wave evolving under the impact of the air flow the results show that the coupling does not significantly alter the properties of the air flow as compared to the uncoupled simulation this conclusion justifies the simplification of using stationary wavy boundary for the air flow simulation both in the present study and in the previous studies accordingly the term dns direct numerical simulation used by by sullivan et al 2000 yang and shen 2010 and druzhinin et al 2012 and in the present study refers to the simulation of the air flow via direct numerical solution of the navier stokes equations subject to the solenoidal condition eqs 1 2 without employing any subgrid turbulent model simplifying assumptions are that the impact of the air flow on the surface wave is negligible and the waved water surface remains stationary during the simulation time eqs 1 and 2 were solved in curvilinear coordinates ξ y η related to the cartesian coordinates x y z by the conformal mapping eq 4 the equations were discretized in a rectangular domain with sizes 0 x 6λ 0 y 4λ and 0 z λ by employing a finite difference adams bashforth method of the second order accuracy on a staggered grid consisting of 360 240 180 nodes an additional mapping was employed to compress the grid in the vertical direction near the boundaries in order to resolve the viscous boundary layer druzhinin et al 2012 the poisson equation for the pressure was solved by iterations numerical method of integration of eqs 1 and 2 used in the present study is quite similar to that employed by druzhinin et al 2012 in the latter case we validated our numerical code by comparison with both available laboratory data and dns results by sullivan et al 2000 our dns employed the grid with mesh sizes δx λ 1 60 in the streamwise and spanwise directions whereas in the vertical direction the mesh size increased from δz 1 λ 0 0008 near the walls to δz 2 λ 0 009 in the center of the computational domain when normalized by the wall scale ν u the mesh sizes for the considered re in the ripple free case was found to be δx 6 in the horizontal plane and varying from δz 1 0 3 near the boundaries to about δz 2 3 in the middle of the domain comparable mesh sizes were used in other dns studies of air flow over waved water surfaces for example sullivan et al 2000 employed the grid with meshes in the notations in the present paper δx 10 δz 1 1 δz 2 5 and yang and shen 2010 employed grid meshes δx 6 δz 1 0 4 δz 2 8 5 these meshes are generally regarded as sufficient to resolve fine scale turbulent motions in dns of turbulent boundary layer flows as discussed by moin and mahesh 1998 in order to check the effect of mesh resolution we performed additional dns runs using a finer mesh of 480 320 240 grid nodes i e increased the resolution by 30 and found a negligible difference in the results both for instantaneous flow and mean fields as compared to the mesh with 360 240 180 nodes the air velocity field was initiated as a weakly perturbed laminar couette flow u i ηu 0 δ ix u if i 1 2 3 where u if is a divergence free isotropic homogeneous random field with a modulus amplitude of 0 05u 0 after the initialization the integration of the air flow equations of motion 1 and 2 was firstly performed during the time interval 0 tu 0 λ 200 a detailed study of the dynamics of turbulence spectra and transition from laminar to turbulent regime is beyond the scope of the present dns study and left for a future research after this transient stage a fully developed turbulent flow regime set in and a statistically stationary state was established further at times 200 tu 0 λ 400 a statistical sampling of the flow was performed and instantaneous flow fields were studied 3 numerical results 3 1 instantaneous fields figs 3a and 3b present a vorticity modulus field ω ω i ω i 1 2 obtained in central x z plane at time moment u 0 t λ 400 in dns runs ht1 and ap2 stokes wave without ripples ht4 and ap6 lee ward side ripples with increased amplitude and ht8 and ap8 uniform ripples fig 3a shows the results obtained with ht elevations and fig 3b shows the fields obtained with ap elevations the i th vorticity component is related to the velocity gradient tensor u i x j via 12 ω i ε ijk u i x j where ε ijk is the antisymmetrical tensor and the summation over repeated indices is performed as the figures illustrate in the absence of ripples the instantaneous flow separation and related shedding of vortex structures occur on the windward sides of the wave crests ht1 case the presence of ripples both with lee ward side and uniform distribution near the crests cases ht4 ap6 and ht8 ap8 respectively mitigates both the instantaneous flow separation and vortex shedding in the vicinity of the crests in order to investigate further how the presence of ripples affects the development of vortex structures we evaluated the eigenvalues of the velocity gradient tensor and used its imaginary part λ ci which is also related the enstrophy i e the vorticity square cf zhou et al 1999 to identify the structures fig 4 presents the instantaneous isosurface distributions of λ ci obtained in dns runs ap2 a ap6 b and ap8 c analogous to the respective cases of ripples distribution in ht1 ht4 and ht8 in fig 3a and ap2 ap6 and ap8 in fig 3b in the proximity of the wavy surface within the layer z 100 note that in evaluating λ ci we subtracted the component attributed to the modulation of wave field u i u i to be defined below in eqs 13 and 16 and thus λ ci is directly related to the swirling strength of the vortex structures as revealed in fig 4b the presence of capillary ripples with sufficiently large amplitude apparently retards the formation of coherent vortical structures the retardation effect becomes insignificant as the ripple amplitude decreases as shown in fig 4c in which the ripple amplitude is decreased to half of the maximum amplitude in fig 4b but remains constant throughout the entire carrier wave surface such a trend is also consistent with that revealed by the streamline patterns of phase averaged flows shown below in figs 6 7 the educed vortical structures were further classified into three characteristic types elongated quasi streamwise vortices forward head points downstream and reversed horseshoe vortices to reveal the population and distribution pattern of each vortical structure the accumulated frequencies that a spatial coordinate is occupied by one of the three types of coherent vortical structure are shown in fig 5 the distributions are obtained by processing simulated flow fields at ten independent time instances as observed in fig 5 the population of the three types of coherent vortices all drastically decrease in the presence of increased amplitude capillary ripples fig 5b the effect reduces when the amplitude of the ripples decreases fig 5c thus the general conclusion drawn from the instantaneous flow fields is that parasitic capillaries mitigate vortex shedding and flow separation in the vicinity of wave crests and also retard the formation of coherent vortices as compared to the no ripples cases 3 2 phase averaged fields statistical sampling of the flow was performed in a statistically stationary state of a fully developed turbulent flow during the time interval 200 tu 0 λ 400 at discrete time moments t k k 1 500 with increment t k 1 t k 0 2λ u 0 in the statistical postprocessing analysis we firstly performed phase averaging which is equivalent to averaging over an ensemble of turbulent fluctuations this averaging was performed over y coordinate time and wave length the latter was evaluated as a window averaging and denoted by angular brackets thus for a given field f ξ y η t the phase averaged fields f and f 2 were determined as 13 f ξ η 1 6 n t n y j 1 n y k 1 n t n 0 5 f ξ nλ y j η t k 14 f 2 ξ η 1 6 n t n y j 1 n y k 1 n t n 0 5 f 2 ξ nλ y j η t k where n y 240 n t 500 and 0 ξ 1 the fluctuation or dispersion of field f was further obtained in the form 15 f 2 f 2 f 2 we also introduce rectangular brackets for the mean vertical profile f η obtained by additional averaging of the phase average f ξ η along the streamwise coordinate 16 f η 6 n x k 1 n x 6 f ξ k η where n x 360 statistical characteristics of the air velocity field were obtained by substituting the velocity components u x u y and u z in eqs 5 to 14 instead of f in case of the flux e g u x u z the product u x u z was substituted in eq 14 instead of f 2 and the difference u x u z u x u z was substituted in eq 15 fig 6 a f shows streamline patterns of the phase averaged airflow above surface waves obtained in dns runs ap1 6 cf table 1 the figures show that the streamlines of phase averaged velocity fields are non separating and the streamline patterns are similar to that of the kelvin cat s eye commonly observed in the vicinity of the critical layer cl this is in contrast to the presence of local separation phenomena observed in the instantaneous velocity fields in the vicinity of the wave crests cf fig 3a this feature of the turbulent air flow boundary layer over steep waves was also previously discussed in more detail by druzhinin et al 2012 and troitskaya et al 2014 who showed that local intermittent separation phenomena present in the instantaneous velocity field are eliminated by ensemble i e phase averaging as fig 6b c and e f illustrate the presence of ripples distorts the streamline patterns in the vicinity of the cl in that multiple local patterns with closed streamlines are created whereas the non closed streamlines oscillate the figures also show that with increasing c u 0 the thickness of patterns with the closed streamlines δ significantly increases to be discussed below we compared the results of dns with predictions of a quasi linear approximation model developed for the description of wind wave coupling by jenkins 1992 janssen 1989 and troitskaya et al 2014 this approach assumes that wave induced disturbances in the air flow are considered within the linear approximation and the only non linear effect taken into account is the deformation of the airflow profile due to the momentum flux from the wind to the waves whereas the mean airflow is treated as non separated for more details of the mathematical formulation of the model see troitskaya et al 2014 the friction velocity in the turbulent boundary layer u and the amplitudes and phases of the harmonics the amplitudes and phases a n and φ n of the surface elevation in eq 4 were used as input parameters for the model the model yields vertical mean velocity profile and phase averaged stream function and velocity fields the model prediction for the mean flow streamline patterns for runs ap6 and ht4 are compared with the dns results in fig 7 the figure shows good agreement of model predictions with the numerical results and thus supports the assumption that the dominant nonlinear effect in wind wave coupling the deformation of the mean flow is well captured by the model 3 3 mean profiles rewriting eqs 1 and 2 in curvilinear coordinates and averaging along ξ and integrating over η as described in eq 10 yields the equation of conservation of the momentum flux in the air flow 17 u x u z z η u x 2 1 ρ p z ξ ν u x η u 2 here u is the conventional turbulent air velocity scale the friction velocity eq 17 can be rewritten as follows 18 u x u z z η u x z ξ 1 ρ p z ξ ν u x η u 2 the first term in eq 18 is the flux of the horizontal velocity in transversal direction with respect to lines η const introducing turbulent fluctuations of the velocity components u x u x u x u z u z u z gives from eq 18 19 u x u z z η u x z ξ 1 ρ p z ξ ν u x η u x u z z η u x 2 z ξ u 2 eq 19 can be split into three components of the air momentum flux terms across the coordinate lines η const 20 τ t η τ v η τ w η u 2 where the turbulent momentum flux is defined as 21 τ t η u x u z z η u x 2 z ξ the molecular viscous stress is defined as 22 τ v η ν d u x dη and the wave induced momentum flux is defined as 23 τ w η u x u z z η u x z ξ 1 ρ p z ξ the wave induced momentum flux vanishes with increasing distance from the water surface and the sum of the viscous and turbulent momentum fluxes tends to u 2 while τ w 0 determines the form drag imposed on the air flow by the water surface fig 8a b presents vertical profiles of the mean air velocity and the sum of turbulent and viscous momentum fluxes evaluated from the phase averaged fields obtained in dns runs ap1 10 as described in eqs 17 23 the results obtained for ht elevations are similar and not shown here the profiles are expressed in the dimensionless wall variables defined as follows 24 η η u ν 25 u u x u 26 τ 1 τ w u 2 fig 8c shows the profiles of the effective viscosity the sum of the molecular viscosity and the eddy viscosity also expressed in wall variables the effective viscosity can be evaluated from the mean velocity profile as 27 ν t u 2 d u x dz when written in the dimensionless variables the effective dimensionless viscosity ν t is expressed as a universal function of η 28 ν t f η as fig 8a illustrates in the presence of surface waves the airflow velocity is reduced as compared to the flat surface case this reduction is due to the flux of air momentum to the waves the differences in the profiles obtained for different wave celerity c u 0 are clearly visible the thickness of the jump in the profile of the momentum flux increases for larger ratio c u 0 this agrees with the streamline patterns in fig 6 which also shows that the thickness of the region of closed streamlines i e the thickness of the critical layer cl where the jump of the momentum flux occurs see e g haberman 1972 increases with c u 0 on the other hand as fig 8a and b illustrates the presence of ripples does not affect the velocity and momentum flux profiles this can be explained by the fact that the elevation of the water surface due to ripples is submerged within the viscous sublayer i e at distances η 5 from the water surface cf fig 6 this agrees with the experimental data by clauser 1956 who showed that the surface roughness height does not change if the roughness elements are immersed in the viscous sublayer i e their height does not exceed 5 units in wall variables the same flow feature is also observed in the case of the waves with ht elevations not shown here it is important to note also that since phase velocities of the parasitic capillaries and the carrier gravity wave are equal the height of the cl h or the height of the match layer for both types of waves is the same if we assume that the momentum flux to surface wave results from dynamics of the cl then the magnitude of the product kh where k is the peak wavenumber of either the capillaries or the carrier wave is important and influences wave growth rate as exp kh according to the miles theory for the carrier gravity wave factor kh is small kh 1 and exp kh 1 and thus the carrier wave uptakes momentum on the other hand for the capillaries kh 1 exp kh 1 so that the momentum flux to the capillary waves vanishes and these waves do not affect the airflow velocity profile this paradigm is in line with the predictions of the quasi linear model fig 9 compares the prediction of the quasi linear model with dns results for the average profiles of velocity stress and eddy viscosity obtained in runs ap6 and ht4 the comparison shows that the model reproduces the overall pattern and the integral parameters of the dns profiles in particular the deformation of the velocity profile related to the roughness length as well as the jump of the stress across the cl is well reproduced this can be explained by the fact that shapes of the profiles are formed due to momentum exchange of the mean flow with the fundamental harmonic of the wave induced disturbances which is captured by the quasi linear model note however that the fine details of the profiles are not reproduced correctly due to the effects of the nonlinear interaction between higher harmonics of the wave induced disturbances neglected by the model let us now investigate how the cl thickness related to the thickness of the jump of the momentum flux depends on the governing parameters the cl thickness can be determined from the streamline patterns as a thickness of a separatrix dividing the regions of closed and open streamlines cf maslowe 1986 when estimating the dependence of the cl thickness on the governing parameters we used a schematic dependence of the stream function on the coordinates in the cl in the form maslowe 1986 29 ψ z z c 2 2 d u x dz z z c ca 1 f x here z c is the level where u x c f x 1 is the oscillating shape of the water elevation scaled with the amplitude of the dominant harmonic a 1 it readily follows from eq 29 that the contour lines of function ψ i e the streamlines are closed if 30 z z c 2 ca 1 f x d u x dz z z c then the maximum thickness of the layer where the streamlines are closed is estimated as 31 δ ca 1 d u x dz z z c taking into account the definition of the effective viscosity coefficient and eqs 27 and 28 we find 32 d u x dz u 2 re f z thus eqs 31 and 32 yield 33 δ 2 f δ c u a here δ and a are the cl thickness and amplitude of dominant harmonic expressed in the wall variables fig 10a shows the dependence of δ vs c u a evaluated from the phase averaged streamline patterns obtained in dns as the figure illustrates the dns points collapse and are well described by the best fit function in the form full black line in fig 10a 34 δ 3 8 c u a eqs 29 and 30 show that f δ const that means that the cl is formed at the height where the eddy viscosity is not strongly varying figs 8 and 9 show clearly that the stress jump is created within the viscous sublayer and the lower part of the buffer zone where the eddy viscosity is comparable with the molecular viscosity fig 10b presents the dependence of the dimensionless wave momentum flux at the water surface τ w 0 τ w 0 u 2 1 τ 0 on the amplitude of the dominant harmonic a as the figure illustrates there is a good correlation between these two quantities figs 8a and 9a show that sufficiently far from the wavy surface the velocity profile of the air flow is well described by a logarithmic asymptotics 35 u 1 κ ln η z 0 thus the dimensionless roughness height z 0 can be deduced from eq 21 as follows we use the gradient approximation for the turbulent stress in the form 36 τ ν t du d η the substitution of eq 36 into eqs 35 and 21 yields 37 ν t du d η 1 τ w η integrating eq 37 over η and taking into account of eq 36 gives 38 z 0 c 0 exp 0 τ w η ν t η d η at η δ here c 0 is the roughness height of the smooth surface c 0 0 11 cf monin and yaglom 1971 given the scale of τ w η δ is a function of c u a cf fig 10a and τ w 0 is a function of a cf fig 10b fig 11 compares the quasi linear model prediction for the roughness height z 0 a and the wave momentum flux at the air water interface τ w 0 b vs dns results the comparison reveals that the model underestimates the roughness height by approximately 20 whereas the jump of the momentum flux is reproduced with 3 accuracy thus we conclude that nonlinear interaction between higher harmonics of wave induced disturbances in the air flow neglected by the model may contribute up to 20 to the effective roughness of the waved water surface the correlation between δ and c u a is not pronounced the coefficient of determination equals 0 22 which allows us to express z 0 as a multiple regression function of a and δ fig 12a and b present the dependence of z 0 vs δ and a with the coefficient of determination of the single linear regression dependencies about 0 6 fig 12c shows the results of double regression 39 z 0 β 0 β 1 δ β 2 a where β 0 0 64 0 15 β 1 0 046 0 006 β 2 0 044 0 006 the coefficient of determination increases up to 0 9 the correlation coefficient equals 0 95 the correlation supports our assumption that the contribution of the first harmonic determines both δ and a 4 conclusions we have performed direct numerical simulation dns of turbulent air flow over a waved water surface and studied the influence of parasitic capillary ripples riding on the carrier energy containing surface waves on the properties of the air flow three dimensional turbulent couette flow has been considered in dns as a model of a constant flux layer in the marine atmospheric surface layer two dimensional stationary waves at the water surface have been prescribed and assumed to be unaffected by the air flow the surface elevations spectra have been prescribed and mimicking stationary capillaries riding on stokes waves observed in a 2d numerical simulation of water surface capillary gravity waves by hung and tsai 2009 typical values of air bulk velocity u 0 and the carrier water surface waves length λ in our dns varied in the range of 3 to 5 m s and 3 to 7 cm respectively under these conditions the capillaries were found to be submerged within the viscous sublayer of the atmospheric boundary layer the dns results show that although the flow fields are characterized by instantaneous separations of the boundary layer the ensemble wave phase averaged flow fields are non separating similar non separating mean flow fields were observed in dns of atmospheric boundary air flow over waved water surface without capillary ripples by yang and shen 2010 and druzhinin et al 2012 thus for the considered bulk parameters range the capillaries do not affect significantly the separation of the boundary layer moreover the streamlines patterns of the mean flow fields are well predicted by a quasilinear theoretical model troitskaya et al 2014 which also considers a non separating air flow we found also that the capillaries mitigate the development of coherent horse shoe vortex structures as compared to the no ripples flow case dns results and quasilinear model were used further to parameterize the water surface roughness height in terms of the critical layer thickness δ and the amplitude of a dominant carrier wave harmonic of the water surface elevation a we found that the roughness length and the wave induced air momentum flux are well described by a linear combination in terms of δ and a this agreement indicates that the dominant contribution in the air flow properties belongs to the first harmonic of the surface elevation spectrum present dns considers relatively low wind speed of the order of a few m s and short capillary gravity surface waves with wavelengths 10 cm and thus moderate reynolds number re 16 000 the results indicate that under these conditions the mean flow is non separating and the parasitic capillaries are immersed within the viscous sublayer and thus have little or no effect on the roughness height on the other hand the separation of the mean velocity field may occur and the surface roughness due to ripples may increase considerably at higher wind speeds and or longer surface waves due to a larger reynolds number therefore the obtained results could be only with caution extrapolated to field conditions with higher wind speeds and longer surface waves acknowledgements we are grateful to the anonymous referees for all comments and suggestions this work is supported by the russian taiwanese joint research project through the russia rfbr grant no 16 55 52022 and the taiwan most grant 105 2923 m 002 006 my3 yu t and o d are additionally supported by the rfbr grants nos 17 05 00703 18 05 60299 and by the ministry of education and science of the russian federation task no 0030 2019 0020 the postprocessing procedure and theoretical analysis of numerical data were supported by the grant of the russian science foundation no 19 17 00209 
24026,a pair of 12 5 year july 2002 december 2014 hybrid coordinate ocean model hycom simulations that only differ in the wind stress formulation are used to investigate the effect of ocean surface currents on global monthly eddy kinetic energy eke variation the model results 2004 2014 show that the global monthly mean eke is reduced by 37 from 1 76 ej 1018 j to 1 10 ej after ocean surface currents are included in the wind stress formulation the monthly eke budget indicates that the shear production and buoyancy work are positive energy source and the eddy wind work on the geostrophic currents is negative energy sink in the steady state 2004 2014 for both simulations all of these three terms are reduced in the steady state when the ocean currents are included in the wind stress formulation the global integral of the eke difference budget suggests that the eke reduction is primarily due to the reduction of the buoyancy work followed by the reduction of the wind work on the geostrophic currents and the shear production to our knowledge this is the first study to separate the eddy wind work into the geostrophic and ageostrophic components to investigate the impact of ocean surface currents on global and depth integrated eke via the wind stress formulation using hycom simulations 1 introduction the global ocean circulation can be divided into two parts the time mean flow and an eddy component relative to the time mean flow the global ocean kinetic energy can also be divided into two parts one associated with the time mean flow and the other being the eddy component the eddy kinetic energy eke of the global ocean circulation is important to measure and map because it is much larger than the time mean kinetic energy and is thought to be driving the mean circulation in some high eddy activity regions holland et al 1983 richardson 1983 the eke is mainly contained by mesoscale eddies meanders and rings of the boundary currents and is generated by instabilities of the mean flow and direct surface wind forcing stammer 1997 ferrari and wunsch 2009 2010 which is clearly demonstrated by the domain integral of the eke budget hughes et al 2009 as shown below in tensor notation following the standard reynold decomposition 1 eke t sp bw ε where 2 eke ρ o 2 v u i 2 dv 3 sp ρ o v u i u j u j x i dv 4 bw g v ρ w dv here u i are the components of the velocity vector u ρ o is the density of sea water v is the volume of the global ocean x i are the spatial coordinates g is the gravitational constant ρ is the boussinesq density and w u 3 is the vertical velocity terms with an overbar denote the time average of the variable mean flow and terms with a prime indicate fluctuations eddy components relative to the corresponding time average this implies that u i 0 the advection of eke by the mean flow and the eddy transfer of eke terms vanish in the domain integral as they only move eke around inside of the global ocean there are three terms contributing to the changes of eke sp bw and ε sp the shear production contains nine terms and represents how eddy motions extract kinetic energy from the mean flow through barotropic and kelvin helmholtz instabilities bw the buoyancy work represents how available potential energy in the mean flow converts into eke through baroclinic instability the third term in the r h s of eq 1 ε describes the dissipative processes through sub grid scale turbulence and has a general form of 5 ε ρ o ν s u i u i x j n j ds ρ o ν v u i x j 2 dv after applying surface boundary conditions of no normal flow here ν is the turbulence viscosity and s is the ocean surface bounding v with unit normal n j please note that eq 5 is simplified by assuming ν is constant in our numerical simulations ν is calculated from the k profile parameterization model and is space and time dependent since there are no tides in this study we can simplify kuhlbrodt et al 2007 hughes et al 2009 eq 5 to 6 ε s τ v o ds td where τ is the wind stress vector and v o is the ocean surface current the first r h s term of eq 6 is the eddy wind work τ v o ds on the ocean surface and the second term td ρ o ν v u i x j 2 dv is the sub surface dissipation in the global ocean except at the surface please note that td contains both the global interior turbulence dissipation and the bottom friction since the turbulence viscosity ν which depends on both the resolved shear instability and unresolved shear instability due to the background internal wave field was not saved in our numerical simulations we can only estimate td as a residual from eq 1 as shown in section 3 4 in order to obtain the time evolution of eke the overbar is defined as the monthly average that eliminates the fluctuations while still permitting slow seasonal variations of the mean flow please note that if the overbar terms are calculated as the long term time average eq 1 would become 0 sp bw ε hereafter the kinetic energy associated with eddy flow relative to mean flow is referred to as variability kinetic energy vke wunsch 1998 and the eke is referred to as the kinetic energy associated with eddy flow relative to the monthly mean in the last two decades there are many studies investigating wind stress dependence on the ocean surface currents a new wind stress formulation 7 τ ρ a c d v 10 v o v 10 v o has been shown to be more appropriate than the commonly used wind stress formulation 8 τ ρ a c d v 10 v 10 that assumes v o in eq 7 to be zero here ρ a is the air density c d is the drag coefficient and v 10 is the 10 m atmospheric wind this new wind stress formulation improves ocean numerical simulations pacanowski 1987 luo et al 2005 renault et al 2016b yu et al 2017 reduces ocean surface momentum and heat fluxes kelly et al 2001 dawe and thompson 2006 and surface wind work dawe and thompson 2006 duhaut and straub 2006 zhai and greatbatch 2007 hughes and wilson 2008 xu and scott 2008 and also reduces sverdrup transport in the mid latitude yu et al 2017 furthermore it was shown that the new wind stress formulation reduces surface eke by 10 to 50 zhai and greatbatch 2007 eden and dietze 2009 seo et al 2016 renault et al 2016a renault et al 2016b in different regions of global ocean renault et al 2016a also found that the new wind stress formulation reduces the depth integrated eke by 27 in the california upwelling system there are two pathways direct and indirect via which the eke can be affected by the wind stress formulation eden and dietze 2009 the direct pathway is the eddy wind work the first term in eq 6 while the indirect pathway refers to the changes of sp and bw in eq 1 and td in eq 6 due to the changes of the mean circulation generated by the new wind stress formulation to explain the reduction of surface eke due to the wind stress dependence on the ocean surface currents eden and dietze 2009 analyzed the eke budget in the upper 50 m for their north atlantic model outputs and seo et al 2016 applied the eke budget to their numerical results in the california current system both of these studies suggested that the surface eke reduction is primarily due to the reduced eddy wind work because the reduction of sp and bw is much smaller the ocean surface current v o in eq 7 can be split into geostrophic v g and ageostrophic v ag components thus the eddy wind work input into the global ocean circulation contains both eddy wind work on surface geostrophic currents and ageostrophic currents 9 τ v o τ v g τ v ag the classical theory states that the wind work on ageostrophic currents is fully dissipated through the vertical turbulent dissipation to maintain the ekman spiral in the ekman layer wang and huang 2004 wunsch 1998 stated that wind work on ekman like flow is dissipated within the surface mixed layer and does not directly produce any motions included in the general circulation per se the global eddy wind work on ageostrophic currents is estimated to be 4 15 tw yu et al 2018 much larger than the estimate of the global eddy wind work on geostrophic currents from 0 099 yu et al 2018 to 0 009 hughes and wilson 2008 and 0 039 tw wunsch 1998 thus comparing eddy wind work τ v o ds with sp and bw greatly overlooks the impact of sp and bw and overestimates the effect of eddy wind work on the eke variation in this study we perform the global eke budget analysis using model output from two global hybrid coordinate ocean model hycom simulations to reveal why the global eke integral is reduced by the wind stress dependence of the ocean surface currents this research differs and improves on previous work in that 1 it studies the depth integrated eke instead of the upper ocean eke and thus 2 it compares eddy wind work on geostrophic currents in eq 9 instead of eddy wind work τ v o ds with sp and bw and note also that this study is based on results from global hycom instead of regional model on z eden and dietze 2009 or terrain following vertical levels seo et al 2016 to our knowledge this is the first study to separate the eddy wind work into the geostrophic and ageostrophic components to investigate the impact of ocean surface currents on global and depth integrated eke via the wind stress formulation using hycom simulations this paper is organized as follows section 2 describes the numerical model and experimental configuration model results are presented and analyzed in section 3 which is followed by discussion and conclusions in section 4 2 numerical simulations the two global numerical simulations are performed with hycom a widely used primitive equation general ocean circulation model a detailed description of hycom physics was given by bleck 2002 there is no data assimilation applied to the numerical model in this study there are also no tides or surface waves effect in the simulations either the two hycom global simulations differ only in the wind stress formulation experiment 1 does not include the effect of ocean surface currents in the wind stress formulation eq 8 whereas experiment 2 does eq 7 below hycom is briefly presented with emphasis on the numerical aspects that are relevant to this study the hycom horizontal resolution in this study is 0 08 1 12 5 9 km at the equator and 6 5 km at mid latitudes the grid is uniform cylindrical from 78 64 s 66 s mercator between 66 s 47 n and includes a bipolar patch north of 47 n providing 3 5 km grid spacing at the north pole there are 41 hybrid coordinate layers z sigma and isopycnal vertically with potential density referenced to 2000 m the top vertical layer has a uniform layer thickness of 1 m the initialization state for the two simulations is obtained in a two step process 1 a global hycom simulation is forced according to eq 8 by a 1993 2012 surface forcing climatology obtained from the 0 3125 resolution national centers for environmental prediction ncep climate forecast system reanalysis cfsr saha et al 2010 and run until the basin wide mean kinetic energy has reached statistical equilibrium and 2 it is continued with 1 hourly surface ncep cfsr wind according to eq 8 and thermal forcing from 1993 to june 2002 both simulations used here are initialized from the ocean state at the end of june 2002 from step 2 and run for 12 5 years from july 2002 to the end of 2014 the two simulations used in this study are the same as those used in yu et al 2017 the mean kuroshio transport fig 1 in yu et al 2017 indicates that it takes 18 months for experiment 2 to adjust to the impulse associated with the new wind stress formulation eq 7 to reach to a steady state the same conclusion can be drawn from the global integral of the monthly mean eke relative to the monthly mean currents time series fig 1 the monthly mean eke in experiment 2 line with solid circles decreases dramatically in the first 18 months and varies slowly from 2004 onward thus we focus on results of the last 11 years 2004 to 2014 daily averages of u i and ρ are stored every model day while surface currents and surface stress τ are saved hourly vertical velocity w is a diagnostic variable determined by vertically integrating the continuity equation downward from the surface 3 model results 3 1 comparison with drifter observations fig 2a shows the global near surface mean vke at 15 m derived from quality controlled global drifter program gdp data set niiler 2001 lumpkin and pazos 2007 from 1979 to june 2012 the undrogued data from the gdp data set were removed by a reanalysis of drogue presence lumpkin and johnson 2013 and the quality controlled data were mapped on a 0 5 0 5 longitude latitude grid lumpkin et al 2013 it clearly indicates that high near surface vke concentrates in the vicinity of major western boundary currents the antarctic circumpolar current acc in the southern ocean and the equatorial region the 11 year 2004 to 2014 near surface mean vke relative to the 11 year average currents at 15 m from experiments 1 and 2 are shown in fig 2b and c respectively results from experiment 2 show improvements in both the spatial patterns and the global average the spatial patterns of the two simulated global near surface mean vke are very similar to that revealed by the drifters both show the high vke around the major current systems and equatorial regions the unrealistic excessive agulhas eddy shedding into the south atlantic in experiment 1 fig 2b is a common artifact of the global models barnier et al 2006 thoppil et al 2011 although the exact mechanism remains unknown the disappearance of this excessive eddy shedding in experiment 2 fig 2c which differs to experiment 1 only in wind stress formulation suggests it can be attributed to surface wind stress forcing the average of the global near surface mean vke at 15 m from experiment 1 is 3 3 10 2 m 2 s 2 whereas the average from experiment 2 is 1 9 10 2 m 2 s 2 the difference 1 4 10 2 m 2 s 2 represents a 42 reduction due to the inclusion of ocean surface currents in the wind stress formulation and is in good agreement with previous studies zhai and greatbatch 2007 eden and dietze 2009 seo et al 2016 renault et al 2016a renault et al 2016b the average of the near surface vke from experiment 2 is closer to the observed value of 2 2 10 2 m 2 s 2 and represents 85 of the observation while the result from experiment 1 is 51 more than the observation part of the difference between the numerical simulations fig 2b and c and the gdp data can be explained by the influence of the interannual to decadal variability since the start time and the time duration 34 vs 11 years of the gdp data and numerical simulations are both different 3 2 depth integrated mean vke from 2004 to 2014 similar to the vke at 15 m the depth integrated mean vke from the experiment 2 fig 3b during 2004 2014 is also smaller than that from experiment 1 fig 3a the global sum is 4 58 and 3 04 ej 1018 j in experiment 1 and 2 respectively the difference 1 54 ej indicates a 34 global vke reduction due to the inclusion of ocean surface currents in the wind stress formulation both spatial patterns are similar to that derived from the surface drifters and the correlation is 0 92 between experiment 1 and 2 the global total vke is estimated to be 3 8 ej by wunsch 1998 using current meter moorings data from wunsch 1997 the global total vke in experiment 1 2 is 20 more less than the estimate in wunsch 1998 the vke contains kinetic energy associated with the monthly mean flow variation relative to the 11 year average and the monthly eke fig 1a associated with the eddy motions relative to the slow variation of the monthly mean flow as mentioned in section 1 the vke budget is simply 0 sp bw ε which doesn t show the time evolution of the kinetic energy and thus we focus on the monthly eke in this study obviously the effect of including the ocean surface currents in the wind stress formulation reduces both the vke and eke below we perform the domain eke budget analysis using the monthly mean eke time series fig 1a to study which processes lead to this reduction the overbar terms e g u i in eqs 2 to 6 represent the monthly average calculated from daily average model output and the prime terms e g u i represent the daily fluctuation relative to the monthly average hourly surface stress and currents are first averaged daily and then used in the calculation the average monthly eke during 2004 2014 is 1 10 ej in experiment 2 which is 37 less than the average in experiment 1 1 76 ej fig 1 3 3 shear production buoyancy work and the eddy wind work the spatial patterns of sp bw the eddy wind work on ageostrophic and geostrophic currents in august 2010 are shown as an example in fig 4 the spatial patterns of these terms in experiment 1 fig 4a c e and g are all similar to the ones in experiment 2 fig 4b d f and h for sp bw and eddy wind work on geostrophic currents most of the contributions come from the high mesoscale eddy activity regions the major western boundary currents equatorial region and the acc in the southern ocean the global sum of sp bw and eddy wind work on geostrophic currents is 0 09 0 56 0 02 0 03 0 44 0 07 tw 1012 w in experiment 1 2 respectively for eddy wind work on ageostrophic currents fig 4e and f most of the contributions comes from the southern ocean south of 40 s fig 4e f due to the strong currents driven by strong wind stress in boreal summer the only strong signals in the northern hemisphere are in north atlantic which are generated by major hurricanes danielle and earl in 2010 the global sum is 3 85 and 3 52 tw in experiment 1 and 2 respectively these two values are much larger than the previous estimate of 1 73 tw wang and huang 2004 wang and huang 2004 indicated that they may underestimate the wind work on the ageostrophic currents due to 1 the 45 angle between the wind stress and surface ageostrophic current from the classical ekman theory is more than the observed 5 to 20 angle between wind stress and surface drifter velocity which underestimates the surface ageostrophic current along the wind stress direction and 2 the empirical constant γ used to calculate ekman depth d e d e γ u f where u is the frictional velocity and f is the coriolis parameter is chosen to be 0 5 that is higher than the commonly used values of γ 0 25 0 4 this overestimates the ekman depth and in turn underestimates wind work on the ageostrophic currents as indicated by wang and huang 2004 their eq 14 as shown below 10 w e 1 ρ o d e 1 f f ω n 1 2 t n 2 where ω n and t n are the frequency and magnitude of the nth component of the wind stress respectively previous estimates of the wind work on ageostrophic currents huang et al 2006 von storch et al 2007 von storch et al 2012 based on numerical simulations suffer from a thicker top layer depth 5 to 30 m than used here that underestimates the surface ageostrophic currents due to the vertical average detailed analysis on this aspect can be found in yu et al 2018 the global sum of the four terms above shows that the magnitude of sp and eddy wind work on geostrophic currents is one order of magnitude smaller than bw and two orders of magnitude smaller than the eddy wind work on ageostrophic currents does this mean we should eliminate sp bw and eddy wind work on geostrophic currents from the domain integral of eke analysis 3 4 the eke budget time series of eke t are shown in fig 5a the time series of sp solid lines bw lines with dots eddy wind work on geostrophic currents dash dotted lines eddy wind work on ageostrophic currents lines with squares and td lines with triangles are shown in fig 5b td is calculated as the difference between eke t and the sum of sp bw and the eddy wind work eqs 1 to 6 please note that the scale of y axis in fig 5b from 0 75 to 0 75 is three times larger than the scale beyond the range the smaller terms in fig 5b sp and eddy wind work on geostrophic currents are on the same order as eke t fig 5a thus we should not eliminate any terms from the domain integral of eke analysis all of these terms are important in both experiments sp bw and eddy wind work on ageostrophic currents are generally energy sources and td and eddy wind work on geostrophic currents are the energy sinks the average of sp bw eddy wind work on ageostrophic currents eddy wind work on geostrophic currents and td during 2004 2014 in experiment 1 black lines are 0 04 0 47 3 84 0 03 and 4 32 tw table 1 respectively the corresponding averages in experiment 2 red lines are 0 02 0 39 3 48 0 07 and 3 82 tw table 1 respectively the magnitudes of sp bw eddy wind work on ageostrophic currents and td in the last 11 years 2004 2014 are reduced by 37 17 9 and 12 table 1 respectively when ocean surface currents are included in the surface stress formulation eq 7 the magnitude of the eddy wind work on geostrophic currents on the other hand increases by 130 as mentioned in section 1 the eddy wind work on ageostropchic currents is fully dissipated by the turbulence in the upper ocean mixed layer thus the eddy wind work on ageostrophic currents and td is combined together as ε ag and is also shown in fig 5b line with plus symbols the average of ε ag during 2004 2014 is 0 48 0 34 tw in the same order as bw in experiment 1 2 its magnitude is reduced by 27 when ocean surface currents are included in the surface stress formulation 3 5 budget of eke difference instead of analyzing the eke budget for the individual experiments we now analyze the budget of eke difference between the two experiments to reveal what causes the reduction of the eke 11 eke d t sp d bw d τ v g d ε agd where the subscript d is defined as the difference between experiment 2 and 1 i e 12 eke d eke 2 eke 1 the time series of all five terms in eq 11 are shown in fig 6a the averages of sp d blue line bw d green line and τ v g d during 2004 2014 are negative 0 01 0 08 and 0 04 tw respectively which indicates that they are responsible for the eke reduction when ocean surface currents are included in the wind stress formulation and they are in the same order of magnitude quantitatively the most dominant term is bw d and then τ v g d with sp d the least important the average of ε agd black dashed line in the same period is positive 0 13 tw to balance the budget 3 6 the transition period the surface stress formulation in experiment 2 includes ocean surface currents which is different from how the initialization state was generated thus the simulated global ocean in experiment 2 has to adjust to the impulse associated with the new wind stress formulation through both barotropic and baroclinic adjustments and there exists an obvious downward upward linear trend in bw d ε agd fig 6a from july 2002 to december 2003 the impulse associated with the new wind stress formulation provides an additional energy source for baroclinic instability via the baroclinic adjustments in experiment 2 thus bw in experiment 2 is larger than that in experiment 1 at the beginning of the simulation fig 5b lines with dots and the bw d is positive fig 6a green line the eke in the upper ocean associated with baroclinic instability is transferred down to the abyssal ocean through the nonlinear interaction between the barotropic and baroclinic flow rhines 1979 salmon 1998 haney et al 2001 a time series of the vertical profile of bw d is shown in fig 6b it indicates that the first beam of positive bw d in the upper ocean is transferred downward and reaches abyssal ocean in february 2003 the result of this process is the conversion between the eke associated with baroclinic and barotropic instability haney et al 2001 the bw d and sp d are significantly correlated with a correlation coefficient of 0 24 and the negative correlation agrees with haney et al 2001 barotropic adjustment on the other hand is almost instantaneous the magnitude of td in experiment 2 reduces as compared with experiment 1 at the beginning of the simulation to respond to the eddy wind work reduction fig 5b red line with triangle but the magnitude of td reduction is smaller than the reduction of the eddy wind work on ageostrophic currents at that time and thus the ε ag in experiment 2 fig 5b red line with plus is smaller than that in experiment 1 and the ε agd is negative fig 6a black dashed line as the baroclinic eke is gradually transferred downward the deeper ocean is impacted by the baroclinic adjustments the magnitude of td reduces further and eventually exceeds the reduction of the eddy wind work on ageostrophic currents and ε agd becomes positive from february 2003 fig 6a and when the ocean is fully baroclinically adjusted ε agd becomes the energy source for the budget of the eke difference the dominant process in the transition period is the reduction of wind work on geostrophic currents τ v g d with a global sum of 0 05 tw table 2 the secondary contribution comes from the reduction of buoyancy work bw d 0 02 tw the contribution from the difference of sp is negligible 4 discussion and conclusions in this study we investigate the impact of ocean surface currents on global eke via the wind stress formulation two hycom numerical simulations were run for a 12 5 year period from july 2002 to 2014 with experiment 2 and without experiment 1 ocean currents in the wind stress formulation both numerical simulations are in steady state in the last 11 years 2004 2014 the model results indicate that the average monthly global eke in the steady state is reduced by 37 when ocean currents are included in the surface wind stress formulation a monthly eke budget is performed for both experiments the most dominant terms are eddy wind work on ageostrophic currents τ v ag and the sub surface turbulence dissipation td since the eddy wind work on ageostrophic currents is fully dissipated in the upper ocean mixed layer we combine these two terms as ε ag both eke budgets indicate that the shear production sp and buoyancy work bw are eke sources and the ε ag and the eddy wind work on geostrophic currents τ v g are the eke sink terms in the steady state sp bw and the eddy wind work on geostrophic currents are all reduced by the inclusion of the surface currents into the wind stress formulation and are all responsible for the monthly eke reduction the budget of the monthly eke difference reveals that the primary contribution of eke reduction comes from the reduction of bw followed by the reduction of the eddy wind work on geostrophic currents and sp 4 1 kinetic energy of the mean currents the depth integrated kinetic energy of the mean currents averaged over 2004 2014 is shown in fig 7 strong kinetic energy of the mean currents concentrates in major western boundary currents the acc in the southern ocean and the equatorial currents the global sum is 1 79 and 1 49 ej in experiment 1 fig 7a and 2 fig 7b respectively this represents a 17 reduction due to the inclusion of the surface currents into the wind stress formulation part of this reduction comes from the reduced transport of the western boundary currents when the surface currents are included into the wind stress formulation yu et al 2017 the kinetic energy of the mean currents forms sharp and narrow fine structures along the major current systems while the spatial pattern of vke fig 3 is much smoother and broader this reveals that the main path of the major currents varies little over time the global sum of the kinetic energy of the mean currents is much smaller than the sum of vke both of these points agree well with von storch et al 2012 4 2 why global sum of sp is smaller than bw comparing sp bw and eddy wind work in fig 4 it s clear that sp can be the most dominant term locally the reanalysis results show that only four terms among the nine terms in sp are important which is the same as eden and boning 2002 these four terms are ρ o v u u u x dv ρ o v v v v y dv ρ o v u v u y dv and ρ o v u v v x dv the sum of the first two terms is ρ o v u u v v u x dv after applying mass conservation that is smaller than either of the two individual terms from the left side to the right side of the major current systems both u y and v x change sign and the third and fourth terms above tend to balance across the major current systems thus the global sum of sp is smaller 4 3 how to improve the vke simulation as mentioned in sections 3 1 and 3 2 experiment 2 does a better job in simulating both the surface and total vke than experiment 1 it also indicates that results in experiment 2 underestimate the surface and total vke to achieve an even more realistic simulation one can increase the model resolution the vke in a non data assimilative numerical simulation is generated by the intrinsic instability increasing model resolution in experiment 2 can better resolve the sub mesoscale eddies and thus increase the mean current shear enhance the instability and boost the vke thoppil et al 2011 another method is data assimilation in which the realistic eddies are introduced by assimilating remotely sensed sea surface height data the ocean and the atmosphere are a fully coupled system by comparing results from an uncoupled and coupled ocean atmosphere simulations renault et al 2016a demonstrated that the vke reduction due to the inclusion of surface currents in wind stress formulation is overestimated when not considering the feedback of ocean surface currents on the wind simulations in the atmospheric model the feedback of the ocean surface currents on the wind itself through wind stress opposes the effect of the ocean surface currents on the surface stresses and can partly reenergize the ocean according to renault et al 2016a the fully coupled global ocean atmosphere models should increase the vke in experiment 2 acknowledgments the authors thank the editor and the anonymous reviewers for their input to improve the original manuscript financial support for z yu is provided by karle s research fellowship naval research laboratory dc e j metzger is funded by the 6 1 kuroshio and ryukyu current dynamics project sponsored by the office of naval research under program element 0601135n computer time was provided by the department of defense dod high performance computing modernization program and the simulations were performed on the cray xc30 shepard at the navy dod supercomputing resources center stennis space center ms the output used in the research can be provided upon individual request this is nrl contribution nrl ja 7320 17 3543 it has been approved for public release and distribution is unlimited 
24026,a pair of 12 5 year july 2002 december 2014 hybrid coordinate ocean model hycom simulations that only differ in the wind stress formulation are used to investigate the effect of ocean surface currents on global monthly eddy kinetic energy eke variation the model results 2004 2014 show that the global monthly mean eke is reduced by 37 from 1 76 ej 1018 j to 1 10 ej after ocean surface currents are included in the wind stress formulation the monthly eke budget indicates that the shear production and buoyancy work are positive energy source and the eddy wind work on the geostrophic currents is negative energy sink in the steady state 2004 2014 for both simulations all of these three terms are reduced in the steady state when the ocean currents are included in the wind stress formulation the global integral of the eke difference budget suggests that the eke reduction is primarily due to the reduction of the buoyancy work followed by the reduction of the wind work on the geostrophic currents and the shear production to our knowledge this is the first study to separate the eddy wind work into the geostrophic and ageostrophic components to investigate the impact of ocean surface currents on global and depth integrated eke via the wind stress formulation using hycom simulations 1 introduction the global ocean circulation can be divided into two parts the time mean flow and an eddy component relative to the time mean flow the global ocean kinetic energy can also be divided into two parts one associated with the time mean flow and the other being the eddy component the eddy kinetic energy eke of the global ocean circulation is important to measure and map because it is much larger than the time mean kinetic energy and is thought to be driving the mean circulation in some high eddy activity regions holland et al 1983 richardson 1983 the eke is mainly contained by mesoscale eddies meanders and rings of the boundary currents and is generated by instabilities of the mean flow and direct surface wind forcing stammer 1997 ferrari and wunsch 2009 2010 which is clearly demonstrated by the domain integral of the eke budget hughes et al 2009 as shown below in tensor notation following the standard reynold decomposition 1 eke t sp bw ε where 2 eke ρ o 2 v u i 2 dv 3 sp ρ o v u i u j u j x i dv 4 bw g v ρ w dv here u i are the components of the velocity vector u ρ o is the density of sea water v is the volume of the global ocean x i are the spatial coordinates g is the gravitational constant ρ is the boussinesq density and w u 3 is the vertical velocity terms with an overbar denote the time average of the variable mean flow and terms with a prime indicate fluctuations eddy components relative to the corresponding time average this implies that u i 0 the advection of eke by the mean flow and the eddy transfer of eke terms vanish in the domain integral as they only move eke around inside of the global ocean there are three terms contributing to the changes of eke sp bw and ε sp the shear production contains nine terms and represents how eddy motions extract kinetic energy from the mean flow through barotropic and kelvin helmholtz instabilities bw the buoyancy work represents how available potential energy in the mean flow converts into eke through baroclinic instability the third term in the r h s of eq 1 ε describes the dissipative processes through sub grid scale turbulence and has a general form of 5 ε ρ o ν s u i u i x j n j ds ρ o ν v u i x j 2 dv after applying surface boundary conditions of no normal flow here ν is the turbulence viscosity and s is the ocean surface bounding v with unit normal n j please note that eq 5 is simplified by assuming ν is constant in our numerical simulations ν is calculated from the k profile parameterization model and is space and time dependent since there are no tides in this study we can simplify kuhlbrodt et al 2007 hughes et al 2009 eq 5 to 6 ε s τ v o ds td where τ is the wind stress vector and v o is the ocean surface current the first r h s term of eq 6 is the eddy wind work τ v o ds on the ocean surface and the second term td ρ o ν v u i x j 2 dv is the sub surface dissipation in the global ocean except at the surface please note that td contains both the global interior turbulence dissipation and the bottom friction since the turbulence viscosity ν which depends on both the resolved shear instability and unresolved shear instability due to the background internal wave field was not saved in our numerical simulations we can only estimate td as a residual from eq 1 as shown in section 3 4 in order to obtain the time evolution of eke the overbar is defined as the monthly average that eliminates the fluctuations while still permitting slow seasonal variations of the mean flow please note that if the overbar terms are calculated as the long term time average eq 1 would become 0 sp bw ε hereafter the kinetic energy associated with eddy flow relative to mean flow is referred to as variability kinetic energy vke wunsch 1998 and the eke is referred to as the kinetic energy associated with eddy flow relative to the monthly mean in the last two decades there are many studies investigating wind stress dependence on the ocean surface currents a new wind stress formulation 7 τ ρ a c d v 10 v o v 10 v o has been shown to be more appropriate than the commonly used wind stress formulation 8 τ ρ a c d v 10 v 10 that assumes v o in eq 7 to be zero here ρ a is the air density c d is the drag coefficient and v 10 is the 10 m atmospheric wind this new wind stress formulation improves ocean numerical simulations pacanowski 1987 luo et al 2005 renault et al 2016b yu et al 2017 reduces ocean surface momentum and heat fluxes kelly et al 2001 dawe and thompson 2006 and surface wind work dawe and thompson 2006 duhaut and straub 2006 zhai and greatbatch 2007 hughes and wilson 2008 xu and scott 2008 and also reduces sverdrup transport in the mid latitude yu et al 2017 furthermore it was shown that the new wind stress formulation reduces surface eke by 10 to 50 zhai and greatbatch 2007 eden and dietze 2009 seo et al 2016 renault et al 2016a renault et al 2016b in different regions of global ocean renault et al 2016a also found that the new wind stress formulation reduces the depth integrated eke by 27 in the california upwelling system there are two pathways direct and indirect via which the eke can be affected by the wind stress formulation eden and dietze 2009 the direct pathway is the eddy wind work the first term in eq 6 while the indirect pathway refers to the changes of sp and bw in eq 1 and td in eq 6 due to the changes of the mean circulation generated by the new wind stress formulation to explain the reduction of surface eke due to the wind stress dependence on the ocean surface currents eden and dietze 2009 analyzed the eke budget in the upper 50 m for their north atlantic model outputs and seo et al 2016 applied the eke budget to their numerical results in the california current system both of these studies suggested that the surface eke reduction is primarily due to the reduced eddy wind work because the reduction of sp and bw is much smaller the ocean surface current v o in eq 7 can be split into geostrophic v g and ageostrophic v ag components thus the eddy wind work input into the global ocean circulation contains both eddy wind work on surface geostrophic currents and ageostrophic currents 9 τ v o τ v g τ v ag the classical theory states that the wind work on ageostrophic currents is fully dissipated through the vertical turbulent dissipation to maintain the ekman spiral in the ekman layer wang and huang 2004 wunsch 1998 stated that wind work on ekman like flow is dissipated within the surface mixed layer and does not directly produce any motions included in the general circulation per se the global eddy wind work on ageostrophic currents is estimated to be 4 15 tw yu et al 2018 much larger than the estimate of the global eddy wind work on geostrophic currents from 0 099 yu et al 2018 to 0 009 hughes and wilson 2008 and 0 039 tw wunsch 1998 thus comparing eddy wind work τ v o ds with sp and bw greatly overlooks the impact of sp and bw and overestimates the effect of eddy wind work on the eke variation in this study we perform the global eke budget analysis using model output from two global hybrid coordinate ocean model hycom simulations to reveal why the global eke integral is reduced by the wind stress dependence of the ocean surface currents this research differs and improves on previous work in that 1 it studies the depth integrated eke instead of the upper ocean eke and thus 2 it compares eddy wind work on geostrophic currents in eq 9 instead of eddy wind work τ v o ds with sp and bw and note also that this study is based on results from global hycom instead of regional model on z eden and dietze 2009 or terrain following vertical levels seo et al 2016 to our knowledge this is the first study to separate the eddy wind work into the geostrophic and ageostrophic components to investigate the impact of ocean surface currents on global and depth integrated eke via the wind stress formulation using hycom simulations this paper is organized as follows section 2 describes the numerical model and experimental configuration model results are presented and analyzed in section 3 which is followed by discussion and conclusions in section 4 2 numerical simulations the two global numerical simulations are performed with hycom a widely used primitive equation general ocean circulation model a detailed description of hycom physics was given by bleck 2002 there is no data assimilation applied to the numerical model in this study there are also no tides or surface waves effect in the simulations either the two hycom global simulations differ only in the wind stress formulation experiment 1 does not include the effect of ocean surface currents in the wind stress formulation eq 8 whereas experiment 2 does eq 7 below hycom is briefly presented with emphasis on the numerical aspects that are relevant to this study the hycom horizontal resolution in this study is 0 08 1 12 5 9 km at the equator and 6 5 km at mid latitudes the grid is uniform cylindrical from 78 64 s 66 s mercator between 66 s 47 n and includes a bipolar patch north of 47 n providing 3 5 km grid spacing at the north pole there are 41 hybrid coordinate layers z sigma and isopycnal vertically with potential density referenced to 2000 m the top vertical layer has a uniform layer thickness of 1 m the initialization state for the two simulations is obtained in a two step process 1 a global hycom simulation is forced according to eq 8 by a 1993 2012 surface forcing climatology obtained from the 0 3125 resolution national centers for environmental prediction ncep climate forecast system reanalysis cfsr saha et al 2010 and run until the basin wide mean kinetic energy has reached statistical equilibrium and 2 it is continued with 1 hourly surface ncep cfsr wind according to eq 8 and thermal forcing from 1993 to june 2002 both simulations used here are initialized from the ocean state at the end of june 2002 from step 2 and run for 12 5 years from july 2002 to the end of 2014 the two simulations used in this study are the same as those used in yu et al 2017 the mean kuroshio transport fig 1 in yu et al 2017 indicates that it takes 18 months for experiment 2 to adjust to the impulse associated with the new wind stress formulation eq 7 to reach to a steady state the same conclusion can be drawn from the global integral of the monthly mean eke relative to the monthly mean currents time series fig 1 the monthly mean eke in experiment 2 line with solid circles decreases dramatically in the first 18 months and varies slowly from 2004 onward thus we focus on results of the last 11 years 2004 to 2014 daily averages of u i and ρ are stored every model day while surface currents and surface stress τ are saved hourly vertical velocity w is a diagnostic variable determined by vertically integrating the continuity equation downward from the surface 3 model results 3 1 comparison with drifter observations fig 2a shows the global near surface mean vke at 15 m derived from quality controlled global drifter program gdp data set niiler 2001 lumpkin and pazos 2007 from 1979 to june 2012 the undrogued data from the gdp data set were removed by a reanalysis of drogue presence lumpkin and johnson 2013 and the quality controlled data were mapped on a 0 5 0 5 longitude latitude grid lumpkin et al 2013 it clearly indicates that high near surface vke concentrates in the vicinity of major western boundary currents the antarctic circumpolar current acc in the southern ocean and the equatorial region the 11 year 2004 to 2014 near surface mean vke relative to the 11 year average currents at 15 m from experiments 1 and 2 are shown in fig 2b and c respectively results from experiment 2 show improvements in both the spatial patterns and the global average the spatial patterns of the two simulated global near surface mean vke are very similar to that revealed by the drifters both show the high vke around the major current systems and equatorial regions the unrealistic excessive agulhas eddy shedding into the south atlantic in experiment 1 fig 2b is a common artifact of the global models barnier et al 2006 thoppil et al 2011 although the exact mechanism remains unknown the disappearance of this excessive eddy shedding in experiment 2 fig 2c which differs to experiment 1 only in wind stress formulation suggests it can be attributed to surface wind stress forcing the average of the global near surface mean vke at 15 m from experiment 1 is 3 3 10 2 m 2 s 2 whereas the average from experiment 2 is 1 9 10 2 m 2 s 2 the difference 1 4 10 2 m 2 s 2 represents a 42 reduction due to the inclusion of ocean surface currents in the wind stress formulation and is in good agreement with previous studies zhai and greatbatch 2007 eden and dietze 2009 seo et al 2016 renault et al 2016a renault et al 2016b the average of the near surface vke from experiment 2 is closer to the observed value of 2 2 10 2 m 2 s 2 and represents 85 of the observation while the result from experiment 1 is 51 more than the observation part of the difference between the numerical simulations fig 2b and c and the gdp data can be explained by the influence of the interannual to decadal variability since the start time and the time duration 34 vs 11 years of the gdp data and numerical simulations are both different 3 2 depth integrated mean vke from 2004 to 2014 similar to the vke at 15 m the depth integrated mean vke from the experiment 2 fig 3b during 2004 2014 is also smaller than that from experiment 1 fig 3a the global sum is 4 58 and 3 04 ej 1018 j in experiment 1 and 2 respectively the difference 1 54 ej indicates a 34 global vke reduction due to the inclusion of ocean surface currents in the wind stress formulation both spatial patterns are similar to that derived from the surface drifters and the correlation is 0 92 between experiment 1 and 2 the global total vke is estimated to be 3 8 ej by wunsch 1998 using current meter moorings data from wunsch 1997 the global total vke in experiment 1 2 is 20 more less than the estimate in wunsch 1998 the vke contains kinetic energy associated with the monthly mean flow variation relative to the 11 year average and the monthly eke fig 1a associated with the eddy motions relative to the slow variation of the monthly mean flow as mentioned in section 1 the vke budget is simply 0 sp bw ε which doesn t show the time evolution of the kinetic energy and thus we focus on the monthly eke in this study obviously the effect of including the ocean surface currents in the wind stress formulation reduces both the vke and eke below we perform the domain eke budget analysis using the monthly mean eke time series fig 1a to study which processes lead to this reduction the overbar terms e g u i in eqs 2 to 6 represent the monthly average calculated from daily average model output and the prime terms e g u i represent the daily fluctuation relative to the monthly average hourly surface stress and currents are first averaged daily and then used in the calculation the average monthly eke during 2004 2014 is 1 10 ej in experiment 2 which is 37 less than the average in experiment 1 1 76 ej fig 1 3 3 shear production buoyancy work and the eddy wind work the spatial patterns of sp bw the eddy wind work on ageostrophic and geostrophic currents in august 2010 are shown as an example in fig 4 the spatial patterns of these terms in experiment 1 fig 4a c e and g are all similar to the ones in experiment 2 fig 4b d f and h for sp bw and eddy wind work on geostrophic currents most of the contributions come from the high mesoscale eddy activity regions the major western boundary currents equatorial region and the acc in the southern ocean the global sum of sp bw and eddy wind work on geostrophic currents is 0 09 0 56 0 02 0 03 0 44 0 07 tw 1012 w in experiment 1 2 respectively for eddy wind work on ageostrophic currents fig 4e and f most of the contributions comes from the southern ocean south of 40 s fig 4e f due to the strong currents driven by strong wind stress in boreal summer the only strong signals in the northern hemisphere are in north atlantic which are generated by major hurricanes danielle and earl in 2010 the global sum is 3 85 and 3 52 tw in experiment 1 and 2 respectively these two values are much larger than the previous estimate of 1 73 tw wang and huang 2004 wang and huang 2004 indicated that they may underestimate the wind work on the ageostrophic currents due to 1 the 45 angle between the wind stress and surface ageostrophic current from the classical ekman theory is more than the observed 5 to 20 angle between wind stress and surface drifter velocity which underestimates the surface ageostrophic current along the wind stress direction and 2 the empirical constant γ used to calculate ekman depth d e d e γ u f where u is the frictional velocity and f is the coriolis parameter is chosen to be 0 5 that is higher than the commonly used values of γ 0 25 0 4 this overestimates the ekman depth and in turn underestimates wind work on the ageostrophic currents as indicated by wang and huang 2004 their eq 14 as shown below 10 w e 1 ρ o d e 1 f f ω n 1 2 t n 2 where ω n and t n are the frequency and magnitude of the nth component of the wind stress respectively previous estimates of the wind work on ageostrophic currents huang et al 2006 von storch et al 2007 von storch et al 2012 based on numerical simulations suffer from a thicker top layer depth 5 to 30 m than used here that underestimates the surface ageostrophic currents due to the vertical average detailed analysis on this aspect can be found in yu et al 2018 the global sum of the four terms above shows that the magnitude of sp and eddy wind work on geostrophic currents is one order of magnitude smaller than bw and two orders of magnitude smaller than the eddy wind work on ageostrophic currents does this mean we should eliminate sp bw and eddy wind work on geostrophic currents from the domain integral of eke analysis 3 4 the eke budget time series of eke t are shown in fig 5a the time series of sp solid lines bw lines with dots eddy wind work on geostrophic currents dash dotted lines eddy wind work on ageostrophic currents lines with squares and td lines with triangles are shown in fig 5b td is calculated as the difference between eke t and the sum of sp bw and the eddy wind work eqs 1 to 6 please note that the scale of y axis in fig 5b from 0 75 to 0 75 is three times larger than the scale beyond the range the smaller terms in fig 5b sp and eddy wind work on geostrophic currents are on the same order as eke t fig 5a thus we should not eliminate any terms from the domain integral of eke analysis all of these terms are important in both experiments sp bw and eddy wind work on ageostrophic currents are generally energy sources and td and eddy wind work on geostrophic currents are the energy sinks the average of sp bw eddy wind work on ageostrophic currents eddy wind work on geostrophic currents and td during 2004 2014 in experiment 1 black lines are 0 04 0 47 3 84 0 03 and 4 32 tw table 1 respectively the corresponding averages in experiment 2 red lines are 0 02 0 39 3 48 0 07 and 3 82 tw table 1 respectively the magnitudes of sp bw eddy wind work on ageostrophic currents and td in the last 11 years 2004 2014 are reduced by 37 17 9 and 12 table 1 respectively when ocean surface currents are included in the surface stress formulation eq 7 the magnitude of the eddy wind work on geostrophic currents on the other hand increases by 130 as mentioned in section 1 the eddy wind work on ageostropchic currents is fully dissipated by the turbulence in the upper ocean mixed layer thus the eddy wind work on ageostrophic currents and td is combined together as ε ag and is also shown in fig 5b line with plus symbols the average of ε ag during 2004 2014 is 0 48 0 34 tw in the same order as bw in experiment 1 2 its magnitude is reduced by 27 when ocean surface currents are included in the surface stress formulation 3 5 budget of eke difference instead of analyzing the eke budget for the individual experiments we now analyze the budget of eke difference between the two experiments to reveal what causes the reduction of the eke 11 eke d t sp d bw d τ v g d ε agd where the subscript d is defined as the difference between experiment 2 and 1 i e 12 eke d eke 2 eke 1 the time series of all five terms in eq 11 are shown in fig 6a the averages of sp d blue line bw d green line and τ v g d during 2004 2014 are negative 0 01 0 08 and 0 04 tw respectively which indicates that they are responsible for the eke reduction when ocean surface currents are included in the wind stress formulation and they are in the same order of magnitude quantitatively the most dominant term is bw d and then τ v g d with sp d the least important the average of ε agd black dashed line in the same period is positive 0 13 tw to balance the budget 3 6 the transition period the surface stress formulation in experiment 2 includes ocean surface currents which is different from how the initialization state was generated thus the simulated global ocean in experiment 2 has to adjust to the impulse associated with the new wind stress formulation through both barotropic and baroclinic adjustments and there exists an obvious downward upward linear trend in bw d ε agd fig 6a from july 2002 to december 2003 the impulse associated with the new wind stress formulation provides an additional energy source for baroclinic instability via the baroclinic adjustments in experiment 2 thus bw in experiment 2 is larger than that in experiment 1 at the beginning of the simulation fig 5b lines with dots and the bw d is positive fig 6a green line the eke in the upper ocean associated with baroclinic instability is transferred down to the abyssal ocean through the nonlinear interaction between the barotropic and baroclinic flow rhines 1979 salmon 1998 haney et al 2001 a time series of the vertical profile of bw d is shown in fig 6b it indicates that the first beam of positive bw d in the upper ocean is transferred downward and reaches abyssal ocean in february 2003 the result of this process is the conversion between the eke associated with baroclinic and barotropic instability haney et al 2001 the bw d and sp d are significantly correlated with a correlation coefficient of 0 24 and the negative correlation agrees with haney et al 2001 barotropic adjustment on the other hand is almost instantaneous the magnitude of td in experiment 2 reduces as compared with experiment 1 at the beginning of the simulation to respond to the eddy wind work reduction fig 5b red line with triangle but the magnitude of td reduction is smaller than the reduction of the eddy wind work on ageostrophic currents at that time and thus the ε ag in experiment 2 fig 5b red line with plus is smaller than that in experiment 1 and the ε agd is negative fig 6a black dashed line as the baroclinic eke is gradually transferred downward the deeper ocean is impacted by the baroclinic adjustments the magnitude of td reduces further and eventually exceeds the reduction of the eddy wind work on ageostrophic currents and ε agd becomes positive from february 2003 fig 6a and when the ocean is fully baroclinically adjusted ε agd becomes the energy source for the budget of the eke difference the dominant process in the transition period is the reduction of wind work on geostrophic currents τ v g d with a global sum of 0 05 tw table 2 the secondary contribution comes from the reduction of buoyancy work bw d 0 02 tw the contribution from the difference of sp is negligible 4 discussion and conclusions in this study we investigate the impact of ocean surface currents on global eke via the wind stress formulation two hycom numerical simulations were run for a 12 5 year period from july 2002 to 2014 with experiment 2 and without experiment 1 ocean currents in the wind stress formulation both numerical simulations are in steady state in the last 11 years 2004 2014 the model results indicate that the average monthly global eke in the steady state is reduced by 37 when ocean currents are included in the surface wind stress formulation a monthly eke budget is performed for both experiments the most dominant terms are eddy wind work on ageostrophic currents τ v ag and the sub surface turbulence dissipation td since the eddy wind work on ageostrophic currents is fully dissipated in the upper ocean mixed layer we combine these two terms as ε ag both eke budgets indicate that the shear production sp and buoyancy work bw are eke sources and the ε ag and the eddy wind work on geostrophic currents τ v g are the eke sink terms in the steady state sp bw and the eddy wind work on geostrophic currents are all reduced by the inclusion of the surface currents into the wind stress formulation and are all responsible for the monthly eke reduction the budget of the monthly eke difference reveals that the primary contribution of eke reduction comes from the reduction of bw followed by the reduction of the eddy wind work on geostrophic currents and sp 4 1 kinetic energy of the mean currents the depth integrated kinetic energy of the mean currents averaged over 2004 2014 is shown in fig 7 strong kinetic energy of the mean currents concentrates in major western boundary currents the acc in the southern ocean and the equatorial currents the global sum is 1 79 and 1 49 ej in experiment 1 fig 7a and 2 fig 7b respectively this represents a 17 reduction due to the inclusion of the surface currents into the wind stress formulation part of this reduction comes from the reduced transport of the western boundary currents when the surface currents are included into the wind stress formulation yu et al 2017 the kinetic energy of the mean currents forms sharp and narrow fine structures along the major current systems while the spatial pattern of vke fig 3 is much smoother and broader this reveals that the main path of the major currents varies little over time the global sum of the kinetic energy of the mean currents is much smaller than the sum of vke both of these points agree well with von storch et al 2012 4 2 why global sum of sp is smaller than bw comparing sp bw and eddy wind work in fig 4 it s clear that sp can be the most dominant term locally the reanalysis results show that only four terms among the nine terms in sp are important which is the same as eden and boning 2002 these four terms are ρ o v u u u x dv ρ o v v v v y dv ρ o v u v u y dv and ρ o v u v v x dv the sum of the first two terms is ρ o v u u v v u x dv after applying mass conservation that is smaller than either of the two individual terms from the left side to the right side of the major current systems both u y and v x change sign and the third and fourth terms above tend to balance across the major current systems thus the global sum of sp is smaller 4 3 how to improve the vke simulation as mentioned in sections 3 1 and 3 2 experiment 2 does a better job in simulating both the surface and total vke than experiment 1 it also indicates that results in experiment 2 underestimate the surface and total vke to achieve an even more realistic simulation one can increase the model resolution the vke in a non data assimilative numerical simulation is generated by the intrinsic instability increasing model resolution in experiment 2 can better resolve the sub mesoscale eddies and thus increase the mean current shear enhance the instability and boost the vke thoppil et al 2011 another method is data assimilation in which the realistic eddies are introduced by assimilating remotely sensed sea surface height data the ocean and the atmosphere are a fully coupled system by comparing results from an uncoupled and coupled ocean atmosphere simulations renault et al 2016a demonstrated that the vke reduction due to the inclusion of surface currents in wind stress formulation is overestimated when not considering the feedback of ocean surface currents on the wind simulations in the atmospheric model the feedback of the ocean surface currents on the wind itself through wind stress opposes the effect of the ocean surface currents on the surface stresses and can partly reenergize the ocean according to renault et al 2016a the fully coupled global ocean atmosphere models should increase the vke in experiment 2 acknowledgments the authors thank the editor and the anonymous reviewers for their input to improve the original manuscript financial support for z yu is provided by karle s research fellowship naval research laboratory dc e j metzger is funded by the 6 1 kuroshio and ryukyu current dynamics project sponsored by the office of naval research under program element 0601135n computer time was provided by the department of defense dod high performance computing modernization program and the simulations were performed on the cray xc30 shepard at the navy dod supercomputing resources center stennis space center ms the output used in the research can be provided upon individual request this is nrl contribution nrl ja 7320 17 3543 it has been approved for public release and distribution is unlimited 
24027,in the field of wave model validation the use of super observations is a common strategy to smooth satellite observations and match the simulated spatiotemporal scales an approach based on averaging along track is widely applied because it is straightforward to implement and adjustable however the choice of an appropriate length scale for obtaining the averages can be ambiguous affecting subsequent analyses despite this dilemma no uncertainty for the validation metric is provided when proceeding with wave model validation we show that super observations computed from averaging data points applying an inappropriate length scale can lead to a misrepresentation of the wave field which can introduce errors into the wave model validation modelling the mean of observations as a gaussian process mitigates those errors and reliably identifies outliers by exploiting information hidden in the observational time series moreover the uncertainty accompanying the validation statistic is readily accessible in the gaussian process framework the flexibility of a gaussian process makes it an attractive candidate for the probabilistic validation of wave models with steadily increasing horizontal resolution moreover this approach can be applied to measurements from other platforms e g buoys and other variables e g wind keywords wave model validation super observation gaussian process machine learning 1 introduction satellite altimetry allows one to evaluate the performance of wave models in terms of significant wave height swh multiple satellite missions in the past have created an almost continuous record since 1985 allowing for wave model validation and calibration by measurement platforms zieger et al 2009 abdalla et al 2011 however prior to validation the satellite derived swh undergoes quality control i e outlier removal and is adjusted to match the effective horizontal resolution of the wave model abdalla et al 2013 the resulting values are often called super observations we propose a new and highly flexible approach to compute super observations detect outliers and attain a probabilistic uncertainty measure for subsequently computed validation statistics commonly a super observation is computed by averaging along the satellite track of swh an example of which is shown in fig 2 a as is repeatedly applied and described in recent scientific literature abdalla et al 2011 liu et al 2016 stopa et al 2016 the size of the averaging window length scale is chosen to match the effective model resolution such that values representing similar process scales are compared abdalla et al 2013 another reason for the smoothing is the chaotic nature of the sea state consisting of a superposition of multiple wave fields with different origin and characteristics random phase amplitude model e g holthuijsen 2010 from an eulerian perspective this superposition creates a varying wave field with random realizations scattered around a mean value this mean value can be thought of as the sea state one strives to measure but can rarely observe as one satellite footprint is just a snapshot of the wave field at one point in space and time it is unlikely that it recorded exactly the underlying sea state but rather one random realization smoothing the time series of along track measurements using an appropriate length scale averages out these variations and hopefully arrives at the correct mean averaging will further reduce the effect of random measurement errors inherent to the measuring system a challenge with the described approach is the choice of an appropriate length scale even though guidelines are provided e g by abdalla et al 2011 one has to decide on one specific value for the length scale this is commonly the mean of what might be the range of possible length scales however the most appropriate length scale might vary in space or from domain to domain because it depends on the scale of features the wave model is able to resolve unfortunately in the prevalent approach one can only choose one discrete number of footprints or model grid cells that should be averaged if the correct length scale could be chosen and there is no systematic bias in the data the super observed average swh value is a reliable measure assuming the sample size averaging window size is large enough to be representative of the underlying stochastic process this assumption is challenged by model simulations with increasingly higher horizontal resolution for instance when comparing satellite observations against high resolution model simulations the appropriate number of footprints that should be averaged might reduce to only a few points abdalla et al 2011 chose 11 consecutive valid footprints to form one super observation and saleh abdalla 2018 mentioned a necessary minimum of 7 footprints what if the resolved model scale drops below that value and what if the 11 or 7 values are not representative this becomes increasingly problematic considering an ever greater mismatch between the model resolution and the size and distance of the satellite footprints smaller numbers are already applied e g stopa et al 2016 used a moving average window of 5 values to smooth the satellite track and to match scales a similar problem emerges for the detection of outliers as described e g by young 1999 or zieger et al 2009 outliers are detected based on a block of data points 25 values in zieger et al 2009 which undergoes 2 or 3 passes of quality checks again the block size has to be decided with regard to physical arguments like the spatial scale of geophysical processes which however can vary in space and time the assumption is that the block size should be representative for computing a mean and a standard deviation but small enough to avoid considerable variability as a result of e g storm systems this is not the case if there are strong gradients or regime shifts along the satellite track within the chosen block after a sequence of subjective decisions on the length scale and block size a validation statistic can be computed commonly single numbers are presented e g root mean square error correlation or scatter index however the uncertainty associated with these decisions is not quantified and as such the significance of the validation statistics cannot be realistically assessed propagating and quantifying this uncertainty is one of the primary concerns in the exposition of the approach in this paper in the following we present a flexible alternative approach which allows us to estimate the most likely sea state along the satellite track and thus to create reliable and smooth super observations detecting outliers at the same time moreover our suggested approach can naturally quantify the uncertainty to the desired validation statistic 2 methodology 2 1 data and collocation for producing the results in this paper we used two data sources first output from simulations with the operational wave model arctic wam a version of the wam wave model komen et al 1994 setup with a horizontal resolution of 8 km regridded to 6 25 km the simulations were conducted at the norwegian meteorological institute and are available on the copernicus web server under the product name arctic analysis forecast wav 002 010 1 1 http marine copernicus eu services portfolio access to products option com csw view details product id arctic analysis forecast wav 002 010 second sentinel 3a s3a data obtained from the copernicus web server under the product name wave glo wav l3 swh nrt observations 014 001 2 2 http marine copernicus eu services portfolio access to products option com csw view details product id wave glo wav l3 swh nrt observations 014 001 s3a is a level three satellite altimeter product featuring a 1 hz sampling frequency the wave model is forced with winds from the operational ecmwf ifs at 9 km horizontal resolution and at the boundaries with the operational ecmwf wave model with a horizontal resolution of 14 km a more thorough description is provided on the web site for these copernicus products to obtain a time series from the wave model matching the satellite observations we collocate the s3a footprints to model grid cells fig 1 constraints in space and time determine whether a model grid cell is attributed to a satellite footprint comparable to stopa et al 2016 the time constraint is centered around the model time step and allows s3a values to be chosen if they were recorded within 30 min in space we allow only the collocation of model grid cells which are directly associated with the satellite swath with a maximum distance of 6 km to the footprint this approach results in two time series one for the wave model and one for the satellite observations consisting of the same number of values 2 2 averaging based super observations and outlier detection using data blocks we compute an effective length scale from the horizontal resolution of the atmospheric model by multiplying 9 km by 3 6 grid cells as described in abdalla et al 2011 the wave model has a higher resolution and is thus not the limiting factor our length scale is consequently l 3 9 km 27 km to l 6 9 km 54 km consistent with 3 7 wave model grids and 4 8 consecutive satellite footprints since we need an odd number for a centered moving average window we tested both 5 and 7 satellite footprints for the illustrations we show only results with window size 7 we acknowledge that in practice often independent blocks are used rather than a moving average saleh abdalla 2018 personal communication the independent block estimates are points on the smoothed line resulting from the moving average and as such are implicitly included in our comparison for the sake of illustration and because this is sometimes applied we chose to compare our method against moving average based super observations outlier removal is performed prior to computing super observations this was approached by dividing the time series into smaller blocks of retrieved altimeter swh values and removing values greater than twice the standard deviation from the block mean tobe consistent with the computation of the super observations and the effective model scale we compute outliers based on the same length scale of 7 consecutive observations outliers are additionally detected based on larger block sizes of 11 and 25 values for comparison with abdalla et al 2011 and zieger et al 2009 2 3 super observations and outlier detection with a gaussian process model the description and application of a gaussian process is based on rasmussen and williams 2006 who introduce gaussian processes for machine learning we assume that an unknown stochastic process non stationary in time and space produces a wave field for the short amount of time that the satellite needs to pass over the model region typically some minutes we assume that the stochastic process is stationary this assumption is realistic because the sea state does not noticeably change at the location of the footprints within this amount of time this means that the swh along any trajectory over the wave field is a function of space or similarly travel time of the footprint for any point in space in the wave field there is a true mean value of the sea state around which measurements would scatter due to the chaotic nature of the sea and random measurement errors the true sea state can be thought of as a latent mean function of swh we wish to estimate and subsequently use for validation of the wave model 2 3 1 description of our statistical model from a statistical point of view the swh time series can be described as a mean trend plus error model where the trend is what we are after while the error captures the aggregated effect from measurement error and natural variability in the wave field this model needs to have a flexible enough trend to capture characteristics of the true mean swh such as gradients turning points and local maxima minima here we take an approach where the trend is characterized non parametrically as opposed to parametrically e g linear quadratic etc using a gaussian process gp this assumes that the trend is an unknown smoothly varying function of time that can be estimated from the available data features leaving their imprint on the time series can be e g the spatial extent of weather patterns of different scales wind shadow effects due to topography shelter effects due to land or attenuation effects due to sea ice due to the dependency of the data points much of the necessary information lies in the measured values and their distance to each other denote an observation of mean centered swh at time t by y t we consider the following model 1 y t f t f t ϵ t 2 ϵ t n 0 σ n 2 so that y t f t n f t σ n 2 this model assumes that conditional upon the trend f t the error about this trend is independent gaussian noise with variance σ n 2 where n denotes the total number of time points in the data furthermore the trend itself f t is also assumed to be gaussian but not one that is independent in time values f t and f t will be assumed positively correlated with the strength of correlation decreasing with the temporal separation t t specifically f t is assumed to have zero mean and variance σ s 2 3 f t n 0 σ s 2 and the dependence f t and f t defined by the squared exponential correlation function 4 cor f t f t exp t t 2 2 l 2 this is a gaussian process gp with zero mean variance parameter σ s 2 and length scale parameter l the correlation function is defined in such a way to ensure that the correlation decays with increasing temporal separation and notice that this is squared in the exponential term ensuring a very smooth function f t infinitely differentiable an expected behavior of a wave field the length scale parameter to be estimated from the data controls the amount of smoothness with small l resulting in wiggly looking functions whereas large l result in more slowly varying ones 2 3 2 model estimation notice that the probability distribution for y t is defined conditionally on f t it turns out rasmussen and williams 2006 that the marginal probability distribution for the vector y y 1 y n is a multivariate gaussian distribution y n 0 σ with mean vector zero and covariance matrix σ k σ n 2 i where k is the covariance matrix that results from the gp and i is an n n identity matrix that adds the gaussiannoise the diagonal entries of k are all equal to σ n 2 σ s 2 whereas the off diagonals capture the covariances between all combinations of y t and y t for t t and are defined by 5 y t y t σ s 2 exp t t 2 2 l 2 we can now write down the likelihood of the data as the probability density function of the multivariate gaussian distribution rasmussen and williams 2006 and proceed to maximize it with respect to the parameters σ n 2 σ s 2 and l this will provide optimal point estimates for the three parameters in accordance to likelihood theory the algorithm for computing the latent mean function its variance and the likelihood is described in rasmussen and williams 2006 algorithm 2 1 for computational efficiency we used the scikit learn python package pedregosa et al 2011 for optimization 2 3 3 outlier detection in the gp framework values can be flagged as outliers if they fall outside of the e g 2σ bounds computed in the previous section this can be adjusted according to the desired threshold applying the algorithm described in section 2 4 1 we apply the 2σ threshold to produce a result comparable with the prevalent approach 2 4 uncertainty and probabilistic validation we estimate uncertainties of the validation statistics in two different ways applying parametric bootstrap on the gp model and non parametric bootstrapping on the unprocessed raw observational data both approaches lead to a large number of realizations of super observational time series which can be validated against the wave model time series this results in a distribution of the computed validation statistic rather than a single value 2 4 1 uncertainty estimation for the gp model to quantify and propagate the uncertainty involved in estimating the three parameters σ n σ s and l we use parametric bootstrapping davison and hinkley 1997 this involves simulating data points y t that correspond toplausible realizations of the actual observations y t under the gp model first it is instructive to consider the probability distribution of the trend f t given the model and the data y t denote this as f t y t something that can be interpreted as the best guess of the smooth trend given that we have observed some data it turns out that this distribution is a multivariate gaussian with a mean vector and covariance matrix given in rasmussen and williams 2006 chapter 2 2 the expressions for both the mean and covariance depend on the three model parameters σ n 2 σ s 2 l as well as the data given the estimates of the three parameters obtained in section 2 3 2 this distribution captures two sources of uncertainty the stochastic variability assumed by modelling f t as a gp and the sampling uncertainty in only having observed a finite sample of n data points notice however that this does not include the uncertainty involved in the estimation of the three model parameters in what follows we describe a simulation approach to quantify this appropriately the parametric bootstrapping algorithm is effectively a loop with index i that involves the following steps 1 from the multivariate gaussian distribution of f t y t simulate a realization of the trend f 1 i f n i 2 then simulate n replicate data points from the conditional distribution of y t namely y t i n f t i σ n 2 using the estimate of σ n 2 obtained in section 2 3 2 3 fit the gp model again to the replicate data set y 1 i y n i to obtain new parameter estimates σ n 2 i σ s 2 i and l i 4 using the new estimated parameters compute the trend as the mean of the multivariate gaussian distribution of f t y t to obtain a new realization of the trend f 1 i f n i repeating these steps for a large number of times e g i 1 m with m 1000 will provide m realizations of the trend these realizations are then approximate samples from a distribution that also captures the uncertainty in the estimation of σ n 2 σ s 2 and l the mean of these realizations is still a best estimate of the trend given the data an example of which is shown in fig 4 the variability through the m samples can be expressed by taking e g the 2 5 and 97 5 empirical quantiles as an estimate of the 95 confidence interval in addition the uncertainty expressed by these samples can be propagated as required for example the validation statistic can be computed for each sample yielding a distribution of the validation statistic this distribution will express the uncertainty in having to estimate the trend and also the three model parameters from a sample of data 2 4 2 uncertainty estimation for the raw observational time series the standard non parametric bootstrap efron 1979 samples from the collocated observational time series the observations are chosen above the wave model because we assume the observations to follow a stochastic process whereas the numerical wave model produces deterministic results namely the significant wave height computed from the zeroth order moment of the variance density spectrum e g holthuijsen 2010 moreover the variance is noticeably higher in the un smoothed observations creating a larger spread and should therefore describe the uncertainty more adequately the observational time series is re sampled 1000 times ultimately resulting in a distribution of the validation statistic this provides a sense of uncertainty for the respective measure based on the degree of scattering in the measurement 3 results our study is based on a s3a track around the model time step of 2018 05 02 00 00 utc this is an arbitrary choice and our conclusion is also valid for other time steps nonetheless this track depicts crucial features which will be discussed in the following the chosen s3a track enters our domain in the north atlantic heading toward greenland crosses greenland the arctic and russia and continues from the bering sea to the north pacific fig 2 a the satellite track is obviously divided into two parts where we will call the footprints in the north atlantic track 1 and the footprints in the north pacific track 2 in track 1 the swh increases toward greenland and drops abruptly from ca 5 m to ca 1 m swh within a distance of 380 km this results in a spiky local maximum and a steep gradient in the time series fig 3 a and c the reason for the abrupt changes in swh is the sheltering effect of greenland the winds are mostly from west due to a low pressure system that travels from west to east over greenland fig 2 b waves generated by the low pressure system are stopped by the southern tip of greenland this leads to a short effective fetch and consequently a young wind generated wave field in the irminger sea close to the south eastern greenland coast strong gradients in winds along the southern greenland tip are not rare and are known to the scientific community doyle and shapiro 1999 with significant effect on the hydrography pickart et al 2003 and as evident here the wave field fig 3 a this is therefore a good example for a steep gradient and local maximum in the wave field as these phenomena are not rare and the emerging features need to be accounted for track 2 is characterized by a gradual increase in swh fig 3 b the increase of wave height toward the south is related to the increasing distance between the observation location and the coastline of the kamchatka peninsula under the prevailing westerly winds that occurred around the chosen time step not shown the time series depicts multiple suspicious values that attract attention by their isolated and pronounced deviation from their neighbors fig 3 c the detection of outliers will be elucidated in the following 3 1 outlier detection we focus on track 2 because there are obvious outliers which should be handled correctly by an automated outlier detection algorithm we apply the algorithm described in section 2 2 to detect outliers based on block sizes of 7 11 and 25 consecutive valid values fig 4 a illustrates the difference among super observations derived from different window sizes and the according difference between the catchment area for accepted values shaded area the choice of the block size affects considerably the detection of outliers none of the chosen window sizes detects all of the values that are seemingly erroneous in contrast the gp based 2σ confidence intervals is much smoother fig 4 b and the block size did not have to be chosen manually learning from the entire available time series of satellite observations the excursion of the super observation time series due to the outliers and the according 2σ region are more moderate all values that seem erroneous lie outside the catchment region for acceptable values and can thus be flagged as outliers the aforementioned suspicious values were recorded when the satellite swath passed bering island erroneous recordings are common close to land sea boundaries and near islands due to corrupted wave forms this is why e g young 1999 and zieger et al 2009 use land sea masks for the detection of erroneous recordings however the suspicious footprints in our case were located over sea and several tens of km away from the coastline this means that a land sea mask would not help to detect these error seven if flagging values additionally in the vicinity of land a possible problem for an outlier detection algorithm is non stationarity and non linear behavior in the process that produces the stochastic data therefore zieger et al 2009 assumed that within the block size of 25 values representing a distance of ca 180 km the recordings of the sea state can be considered representative without significant variability due to geophysical processes as illustrated in fig 3 this assumption can frequently be violated depending on the region of interest an example of such a violation is the local maximum close to the southern tip of greenland blue shading in fig 3 c fig 5 zooms in on the local maximum showing a sample of recordings with a block size of 23 values if this block had been chosen to detect outliers the leftmost value would have fallen outside of the catchment area for acceptable values and would have consequently been misinterpreted as an outlier in a time series this behavior is difficult to anticipate and thus not straightforward to employ in an automatic outlier detection algorithm however when using a gp based approach the arc like structure is automatically recognized and the sixth value from the right falls outside the blue shading this seems more intuitive to the eye than the first value from the left 3 2 comparing super observations from both approaches 3 2 1 example a short time series with a local maximum fig 5 b shows super observations derived from the moving averaging approach with different block sizes together with the gp approach if the displayed observations were the only available observations multiple values close to the boundary could not exist based on this block size illustrated in fig 4 a the gp approach however can provide super observations for the entire given observation time period to compare the different approaches for this case the moving average was allowed to borrow information from outside of the given block the choice of the averaging window is crucial for the resulting super observations where the similarity with the gp approach increases with decreasing block size fig 5 b however the smaller the block size the noisier are the super observations and the less representative is the sample size for computing the block average the 2σ area reduces with decreasing block size but depicts more frequent abrupt changes in variance these abrupt changes are challenging to interpret and probably unrealistic as the moving average seems to be more certain close to the local maximum and will be highly influenced by single values 3 2 2 example b longer time series a satellite track with a realistic sample size zoom in over the gray shaded area in fig 3 is shown in fig 6 a where the satellite track is directly compared with the wave model output the average based super observations with a block size of 7 values represent the super observations which one would have chosen according to the commonly applied scale analysis these moving average derived values follow closely the gp based super observations however for the gp based super observations no block size had to be chosen explicitly rather a physically logical range can be given where the estimation of the length scale is a result of a maximum likelihood optimization based on the behavior of the observations the resulting function carries the imprint of the information in the data through the optimal estimation of the trend and the three model parameters the two examples of block sizes illustrate what is intuitively anticipated namely that the larger the block size the smoother the super observations choosing an inappropriate block size of 25 consecutive values irons out important features in the observed wave field choosing the block size of 7 values results in a noisier structure but more variability in the observational time series can be retained the gp approach can model the observations with a very smooth function while retaining the variability in swh such a continuous behavior is expected for a swh field where abrupt changes would only occur on very fine spatial scales under certain circumstances e g modulation of the wave field by bathymetry wave current interactions or sharp changes due to coastlines another advantage of the gp approach is that it can provide information about the uncertainty of the observations and the super observations latent mean function as described in section 2 4 1 each observation and super observation can be seen in context with a desired number of realizations fig 6 b the scatter around the observations illustrates that each observation is just a random realization of what is likely to be the true sea state this makes both the super observations and the observations probabilistic the uncertainty can subsequently be propagated to other applications such as validation purposes 3 3 implications for the validation of wave models to illustrate the applicability and benefits of the gp approach for wave model validation we compute validation statistics commonly included in validation reports the validation statistics are defined in a and are computed based on the time series illustrated in fig 6 when computing a validation statistic from average derived super observations a single value describes the goodness of the wave model compared to an observational reference this approach cannot provide an uncertainty estimate this is problematic because the super observations used for the validation are based on semi subjective decisions which naturally introduce uncertainty different choices would lead to different super observations this uncertainty should be propagated to the validation statistics in order to rigorously quantify the significance of their magnitude we present two attempts to assess the uncertainty in the computed validation statistics sections 2 4 2 and 2 4 1 the resulting distributions for each validation statistic can differ considerably between the approaches fig 7 significant discrepancies are visible for the scatter index and the correlation coefficient while results for the bias are very similar the average based statistics overestimate the quality of the model compared to the raw data with non parametric bootstrapping and the gp approach for deviation based statistics this means a lower value and for the correlation a higher value this behavior results from smoothing the time series as illustrated in the following proposed by murphy 1988 the mean squared error mse can be decomposed as follows 6 mse m o 2 σ m 2 σ o 2 2 σ m σ o r mo where m is the mean of the model time series o is the mean of the observational time series σ m and σ o represent the standard deviation of the model and observational time series super observations or original respectively pearson product moment correlation between the model and observations is denoted by r the validation statistic mse and therefore also rmse a depend directly on the variance within the compared time series and hence the smoother the time series the better the validation statistic the in our case inappropriate window size of 25 therefore generates the best validation scores while validating against the noisy raw s3a data systematically leads to the worst results the non parametric bootstrap method applied to the raw observations can provide a distribution of the validation statistics with a substantial spread fig 7 red histogram the spread reflects the uncertainty based on the noise inherent in the observations it is then possible to choose percentiles to express a probability when comparing however the bootstrap results with the average and gp based results a systematic mismatch becomes visible as indicated above this is due to smoothing the time series but the question emerges whether the values being compared represent the same physical processes in case of using the non averaged values for validation and performing a bootstrap it is not taken into account that the model has a certain effective resolution in this framework the uncertainty and the associated histogram is not representative of the uncertainty of results from averaged or smoothed values essentially two different types of values are compared resulting in an overall underestimated model quality due to the noise in the observations when only using average based results the semi subjective choice of the correct length scale is crucial to producing representative observational values which can be compared to model values on the wave model scale recalling that the chosen length scale is besides being partly subjective also static it is likely that an inappropriate length scale is chosen in some cases at the same time no uncertainty of the derived statistic is available note that one could possibly quantify such uncertainty using relatively advanced parametric bootstrapping davison and hinkley 1997 however this is beyond the scope of this paper where the aim is to illustrate the relative ease with which such uncertainties are obtained from the gp approach the length scales chosen in this manuscript feature a tendency to overestimate the wave model quality likewise an underestimation would be possible in some cases when choosing to small length scales these shortcomings from having to decide on a length scale can be mitigated by using the gp approach if necessary the length scale for the gp approach can be constrained based on physical arguments the optimization of the model parameters signal variance noise variance and length scale are not subject to a subjective decision on a stationary value but are chosen objectively by maximizing the likelihood those parameters are allowed to vary from case to case and are learned each time depending directly on the characteristics of the observations moreover the result is probabilistic and can provide a distribution expressing the uncertainty of the quality of the wave model 4 discussion the chosen example featuring a strong gradient in the wave field due to the sheltering effect of greenland might seem extreme it is not however a single or unusual example as mentioned before a tip jet at the southern tip of greenland is a feature of frequent occurrence e g våge et al 2009 based on measurements from the nasa jpl seawinds scatterometer on board the quick scatterometer quikscat satellite moore and renfrew 2005 stress that the tip jet around greenland leads to surface wind speeds as high as 50 ms 1 with winds over 25 ms 1 occurring approximately 10 to 15 of the time those intense winds have a significant impact on the sea state for a considerable fraction of time when validating the wave model performance in this region especially due to the sheltering effect of land sharp gradients are expected to occur other places in the world oceans when choosing a static block size for outlier detection gradients and regime shifts in the wave field can violate the assumption of stationarity within the chosen block a feature and scale aware length scale as presented here can take this into account as the information is accessible in the observations since each predicted value of the gp model is weighted by the behavior of the neighboring observations across the entire time series the result is less sensitive to outliers while still reproducing the variability of the observational data to the desired degree this is of particular importance as the effective wave model resolution advances to ever finer scales the mismatch between the length scale of the satellite observations and the effective model resolution increases and could result in e g one or only a few satellite measurements per model grid point knowing however that the satellite value is a result of a stochastic process with considerable spread and abrupt changes while the true sea state features smooth transitions a limited number of observations might not be representative of the sea state as model resolution continues to increase this problem needs to be addressed and the gp approach is an attractive candidate an issue with smoothing by using a moving average is that dependence between the errors of single observations are introduced see section 2 2 however when planning to use the super observations for data assimilation into the wave model independence of the errors is desired saleh abdalla 2018 personal communication this is the reason for choosing non overlapping blocks of values as opposed to a moving average it is noteworthy that error dependency can be expected at every physical scale and that therefore even non overlapping blocks cannot ensure independence of errors in general the gp model as formulated here will create a smooth super observational time series without introducing additional error correlation as gaussian noise is only added to the diagonals of the covariance matrix the skill of the gp model to capture the auto correlation inherent in the underlying process while leaving error dependency insignificant is displayed in fig b 8 the gp produced values can therefore be used for both wave model validation and data assimilation not having to divide into independent blocks further results in more super observations available for validation and assimilation the gp model introduced here is motivated by the physical properties of the wave field however as demonstrated in rasmussen and williams 2006 and camps valls et al 2016 there are many ways to adjust the kernel function to the problem at hand our work aims mainly at introducing the gp approach to the field of wave model validation using super observations and presenting inherent advantages for this reason we chose a comparably simple model formulation which serves the understandability of what is going on in the gp model to optimize the performance of the space time evolution one could explore e g the impact of using different kernel functions as well as customize a desired behavior by combing the available kernel functions to imitate the presumed underlying process a full bayesian inference rasmussen and williams 2006 could also be pursued where the kernel function parameters are again parameterized with hyperprior distributions as visible in the fig b 8 despite the overall good performance of our gp model there might be room for tuning e g regarding the auto correlation of the y samples within the first lags and the wiggles in the residuals however it is important to note that neither of these issues wiggles nor the first lags are of statistical significance in future studies especially the impact of adding heteroscedasticity to the gp model could be investigated 5 summary and conclusion we propose a highly flexible approach to compute super observations and detect outliers utilizing a gaussian process we subsequently validate wave model results where our approach allows us to retrieve a probabilistic estimate of the validation statistics there is no need to exactly specify the length scale for the computation of super observations and outlier detection since our super observations and uncertainty bounds are maximum likelihood estimates the data dependence and automated way to fit is scale sensitive and assures flexibility these are characteristics that are important for the validation of high resolution model simulations if needed our approach would even allow the prediction of super observations for a model grid cell along the satellite track interesting e g for the validation of very high resolution simulations or for imputation of missing values the characteristics of the here proposed formulation ensures that no significant additional error correlation is being introduced which is beneficial for using the super observations for data assimilation gaussian processes are getting increasing attention as state of the art tools for regression problems in the field of earth observation data analysis their advantages are discovered and exploited across scientific disciplines camps valls et al 2016 although our work focuses on the computation of super observations from satellite tracks for wave model validation the here formulated gp model can be used just as well for measurements from other platforms e g buoys or other variables like e g wind speed acknowledgement the authors gratefully acknowledge the funding support from the copernicus marine environmental and monitoring service under mercator ocan contract no 60 cmems mfc arctic øyvind breivik acknowledges the support from the cmems service evolution project waveflow we would also like to thank saleh abdalla ecmwf for helpful comments and suggestions at an early stage of this study appendix a equations for the validation statistics variable names and the statistics bias mae and rmse follow the convention from wmo 2010 the computation of the scatter index is adopted from the ecmwf 3 3 https www ecmwfr int en newsletter 150 meteorology twenty one years wave forecast verification x f is the forecast values of the chosen parameter x v is the value to evaluate against ground truth x c is the climatological value of the chosen parameter n is the number of values to be used for verification bias or mean error a 1 bias me 1 n i 1 n x f x v i mean absolute error a 2 mae 1 n i 1 n x f x v i root mean square error a 3 rmse 1 n i 1 n x f x v i 2 pearson product moment correlation coefficient a 4 r f v cov x f x v σ f σ v scatter index a 5 si std x f x v mean x v 100 appendix b auto correlation this section illustrates the empirical auto correlation function acf of the observational time series compared to the acf of artificially generated observations y i produced by our gp model consistent with the rest of this study we produced 1000 artificial observational time series from a parametric bootstrap the residuals were computed by subtracting original observations from all 1000 time series fig b 8 a shows the mean of the empirical auto correlation functions acf of 1000 y samples generated with our gp model black with 95 uncertainty bounds gray from parametric bootstrapping the red line is the acf from the unprocessed measurements depicting a very similar behavior b shows the acf of the residuals where no significant auto correlation is present fig b 8 
24027,in the field of wave model validation the use of super observations is a common strategy to smooth satellite observations and match the simulated spatiotemporal scales an approach based on averaging along track is widely applied because it is straightforward to implement and adjustable however the choice of an appropriate length scale for obtaining the averages can be ambiguous affecting subsequent analyses despite this dilemma no uncertainty for the validation metric is provided when proceeding with wave model validation we show that super observations computed from averaging data points applying an inappropriate length scale can lead to a misrepresentation of the wave field which can introduce errors into the wave model validation modelling the mean of observations as a gaussian process mitigates those errors and reliably identifies outliers by exploiting information hidden in the observational time series moreover the uncertainty accompanying the validation statistic is readily accessible in the gaussian process framework the flexibility of a gaussian process makes it an attractive candidate for the probabilistic validation of wave models with steadily increasing horizontal resolution moreover this approach can be applied to measurements from other platforms e g buoys and other variables e g wind keywords wave model validation super observation gaussian process machine learning 1 introduction satellite altimetry allows one to evaluate the performance of wave models in terms of significant wave height swh multiple satellite missions in the past have created an almost continuous record since 1985 allowing for wave model validation and calibration by measurement platforms zieger et al 2009 abdalla et al 2011 however prior to validation the satellite derived swh undergoes quality control i e outlier removal and is adjusted to match the effective horizontal resolution of the wave model abdalla et al 2013 the resulting values are often called super observations we propose a new and highly flexible approach to compute super observations detect outliers and attain a probabilistic uncertainty measure for subsequently computed validation statistics commonly a super observation is computed by averaging along the satellite track of swh an example of which is shown in fig 2 a as is repeatedly applied and described in recent scientific literature abdalla et al 2011 liu et al 2016 stopa et al 2016 the size of the averaging window length scale is chosen to match the effective model resolution such that values representing similar process scales are compared abdalla et al 2013 another reason for the smoothing is the chaotic nature of the sea state consisting of a superposition of multiple wave fields with different origin and characteristics random phase amplitude model e g holthuijsen 2010 from an eulerian perspective this superposition creates a varying wave field with random realizations scattered around a mean value this mean value can be thought of as the sea state one strives to measure but can rarely observe as one satellite footprint is just a snapshot of the wave field at one point in space and time it is unlikely that it recorded exactly the underlying sea state but rather one random realization smoothing the time series of along track measurements using an appropriate length scale averages out these variations and hopefully arrives at the correct mean averaging will further reduce the effect of random measurement errors inherent to the measuring system a challenge with the described approach is the choice of an appropriate length scale even though guidelines are provided e g by abdalla et al 2011 one has to decide on one specific value for the length scale this is commonly the mean of what might be the range of possible length scales however the most appropriate length scale might vary in space or from domain to domain because it depends on the scale of features the wave model is able to resolve unfortunately in the prevalent approach one can only choose one discrete number of footprints or model grid cells that should be averaged if the correct length scale could be chosen and there is no systematic bias in the data the super observed average swh value is a reliable measure assuming the sample size averaging window size is large enough to be representative of the underlying stochastic process this assumption is challenged by model simulations with increasingly higher horizontal resolution for instance when comparing satellite observations against high resolution model simulations the appropriate number of footprints that should be averaged might reduce to only a few points abdalla et al 2011 chose 11 consecutive valid footprints to form one super observation and saleh abdalla 2018 mentioned a necessary minimum of 7 footprints what if the resolved model scale drops below that value and what if the 11 or 7 values are not representative this becomes increasingly problematic considering an ever greater mismatch between the model resolution and the size and distance of the satellite footprints smaller numbers are already applied e g stopa et al 2016 used a moving average window of 5 values to smooth the satellite track and to match scales a similar problem emerges for the detection of outliers as described e g by young 1999 or zieger et al 2009 outliers are detected based on a block of data points 25 values in zieger et al 2009 which undergoes 2 or 3 passes of quality checks again the block size has to be decided with regard to physical arguments like the spatial scale of geophysical processes which however can vary in space and time the assumption is that the block size should be representative for computing a mean and a standard deviation but small enough to avoid considerable variability as a result of e g storm systems this is not the case if there are strong gradients or regime shifts along the satellite track within the chosen block after a sequence of subjective decisions on the length scale and block size a validation statistic can be computed commonly single numbers are presented e g root mean square error correlation or scatter index however the uncertainty associated with these decisions is not quantified and as such the significance of the validation statistics cannot be realistically assessed propagating and quantifying this uncertainty is one of the primary concerns in the exposition of the approach in this paper in the following we present a flexible alternative approach which allows us to estimate the most likely sea state along the satellite track and thus to create reliable and smooth super observations detecting outliers at the same time moreover our suggested approach can naturally quantify the uncertainty to the desired validation statistic 2 methodology 2 1 data and collocation for producing the results in this paper we used two data sources first output from simulations with the operational wave model arctic wam a version of the wam wave model komen et al 1994 setup with a horizontal resolution of 8 km regridded to 6 25 km the simulations were conducted at the norwegian meteorological institute and are available on the copernicus web server under the product name arctic analysis forecast wav 002 010 1 1 http marine copernicus eu services portfolio access to products option com csw view details product id arctic analysis forecast wav 002 010 second sentinel 3a s3a data obtained from the copernicus web server under the product name wave glo wav l3 swh nrt observations 014 001 2 2 http marine copernicus eu services portfolio access to products option com csw view details product id wave glo wav l3 swh nrt observations 014 001 s3a is a level three satellite altimeter product featuring a 1 hz sampling frequency the wave model is forced with winds from the operational ecmwf ifs at 9 km horizontal resolution and at the boundaries with the operational ecmwf wave model with a horizontal resolution of 14 km a more thorough description is provided on the web site for these copernicus products to obtain a time series from the wave model matching the satellite observations we collocate the s3a footprints to model grid cells fig 1 constraints in space and time determine whether a model grid cell is attributed to a satellite footprint comparable to stopa et al 2016 the time constraint is centered around the model time step and allows s3a values to be chosen if they were recorded within 30 min in space we allow only the collocation of model grid cells which are directly associated with the satellite swath with a maximum distance of 6 km to the footprint this approach results in two time series one for the wave model and one for the satellite observations consisting of the same number of values 2 2 averaging based super observations and outlier detection using data blocks we compute an effective length scale from the horizontal resolution of the atmospheric model by multiplying 9 km by 3 6 grid cells as described in abdalla et al 2011 the wave model has a higher resolution and is thus not the limiting factor our length scale is consequently l 3 9 km 27 km to l 6 9 km 54 km consistent with 3 7 wave model grids and 4 8 consecutive satellite footprints since we need an odd number for a centered moving average window we tested both 5 and 7 satellite footprints for the illustrations we show only results with window size 7 we acknowledge that in practice often independent blocks are used rather than a moving average saleh abdalla 2018 personal communication the independent block estimates are points on the smoothed line resulting from the moving average and as such are implicitly included in our comparison for the sake of illustration and because this is sometimes applied we chose to compare our method against moving average based super observations outlier removal is performed prior to computing super observations this was approached by dividing the time series into smaller blocks of retrieved altimeter swh values and removing values greater than twice the standard deviation from the block mean tobe consistent with the computation of the super observations and the effective model scale we compute outliers based on the same length scale of 7 consecutive observations outliers are additionally detected based on larger block sizes of 11 and 25 values for comparison with abdalla et al 2011 and zieger et al 2009 2 3 super observations and outlier detection with a gaussian process model the description and application of a gaussian process is based on rasmussen and williams 2006 who introduce gaussian processes for machine learning we assume that an unknown stochastic process non stationary in time and space produces a wave field for the short amount of time that the satellite needs to pass over the model region typically some minutes we assume that the stochastic process is stationary this assumption is realistic because the sea state does not noticeably change at the location of the footprints within this amount of time this means that the swh along any trajectory over the wave field is a function of space or similarly travel time of the footprint for any point in space in the wave field there is a true mean value of the sea state around which measurements would scatter due to the chaotic nature of the sea and random measurement errors the true sea state can be thought of as a latent mean function of swh we wish to estimate and subsequently use for validation of the wave model 2 3 1 description of our statistical model from a statistical point of view the swh time series can be described as a mean trend plus error model where the trend is what we are after while the error captures the aggregated effect from measurement error and natural variability in the wave field this model needs to have a flexible enough trend to capture characteristics of the true mean swh such as gradients turning points and local maxima minima here we take an approach where the trend is characterized non parametrically as opposed to parametrically e g linear quadratic etc using a gaussian process gp this assumes that the trend is an unknown smoothly varying function of time that can be estimated from the available data features leaving their imprint on the time series can be e g the spatial extent of weather patterns of different scales wind shadow effects due to topography shelter effects due to land or attenuation effects due to sea ice due to the dependency of the data points much of the necessary information lies in the measured values and their distance to each other denote an observation of mean centered swh at time t by y t we consider the following model 1 y t f t f t ϵ t 2 ϵ t n 0 σ n 2 so that y t f t n f t σ n 2 this model assumes that conditional upon the trend f t the error about this trend is independent gaussian noise with variance σ n 2 where n denotes the total number of time points in the data furthermore the trend itself f t is also assumed to be gaussian but not one that is independent in time values f t and f t will be assumed positively correlated with the strength of correlation decreasing with the temporal separation t t specifically f t is assumed to have zero mean and variance σ s 2 3 f t n 0 σ s 2 and the dependence f t and f t defined by the squared exponential correlation function 4 cor f t f t exp t t 2 2 l 2 this is a gaussian process gp with zero mean variance parameter σ s 2 and length scale parameter l the correlation function is defined in such a way to ensure that the correlation decays with increasing temporal separation and notice that this is squared in the exponential term ensuring a very smooth function f t infinitely differentiable an expected behavior of a wave field the length scale parameter to be estimated from the data controls the amount of smoothness with small l resulting in wiggly looking functions whereas large l result in more slowly varying ones 2 3 2 model estimation notice that the probability distribution for y t is defined conditionally on f t it turns out rasmussen and williams 2006 that the marginal probability distribution for the vector y y 1 y n is a multivariate gaussian distribution y n 0 σ with mean vector zero and covariance matrix σ k σ n 2 i where k is the covariance matrix that results from the gp and i is an n n identity matrix that adds the gaussiannoise the diagonal entries of k are all equal to σ n 2 σ s 2 whereas the off diagonals capture the covariances between all combinations of y t and y t for t t and are defined by 5 y t y t σ s 2 exp t t 2 2 l 2 we can now write down the likelihood of the data as the probability density function of the multivariate gaussian distribution rasmussen and williams 2006 and proceed to maximize it with respect to the parameters σ n 2 σ s 2 and l this will provide optimal point estimates for the three parameters in accordance to likelihood theory the algorithm for computing the latent mean function its variance and the likelihood is described in rasmussen and williams 2006 algorithm 2 1 for computational efficiency we used the scikit learn python package pedregosa et al 2011 for optimization 2 3 3 outlier detection in the gp framework values can be flagged as outliers if they fall outside of the e g 2σ bounds computed in the previous section this can be adjusted according to the desired threshold applying the algorithm described in section 2 4 1 we apply the 2σ threshold to produce a result comparable with the prevalent approach 2 4 uncertainty and probabilistic validation we estimate uncertainties of the validation statistics in two different ways applying parametric bootstrap on the gp model and non parametric bootstrapping on the unprocessed raw observational data both approaches lead to a large number of realizations of super observational time series which can be validated against the wave model time series this results in a distribution of the computed validation statistic rather than a single value 2 4 1 uncertainty estimation for the gp model to quantify and propagate the uncertainty involved in estimating the three parameters σ n σ s and l we use parametric bootstrapping davison and hinkley 1997 this involves simulating data points y t that correspond toplausible realizations of the actual observations y t under the gp model first it is instructive to consider the probability distribution of the trend f t given the model and the data y t denote this as f t y t something that can be interpreted as the best guess of the smooth trend given that we have observed some data it turns out that this distribution is a multivariate gaussian with a mean vector and covariance matrix given in rasmussen and williams 2006 chapter 2 2 the expressions for both the mean and covariance depend on the three model parameters σ n 2 σ s 2 l as well as the data given the estimates of the three parameters obtained in section 2 3 2 this distribution captures two sources of uncertainty the stochastic variability assumed by modelling f t as a gp and the sampling uncertainty in only having observed a finite sample of n data points notice however that this does not include the uncertainty involved in the estimation of the three model parameters in what follows we describe a simulation approach to quantify this appropriately the parametric bootstrapping algorithm is effectively a loop with index i that involves the following steps 1 from the multivariate gaussian distribution of f t y t simulate a realization of the trend f 1 i f n i 2 then simulate n replicate data points from the conditional distribution of y t namely y t i n f t i σ n 2 using the estimate of σ n 2 obtained in section 2 3 2 3 fit the gp model again to the replicate data set y 1 i y n i to obtain new parameter estimates σ n 2 i σ s 2 i and l i 4 using the new estimated parameters compute the trend as the mean of the multivariate gaussian distribution of f t y t to obtain a new realization of the trend f 1 i f n i repeating these steps for a large number of times e g i 1 m with m 1000 will provide m realizations of the trend these realizations are then approximate samples from a distribution that also captures the uncertainty in the estimation of σ n 2 σ s 2 and l the mean of these realizations is still a best estimate of the trend given the data an example of which is shown in fig 4 the variability through the m samples can be expressed by taking e g the 2 5 and 97 5 empirical quantiles as an estimate of the 95 confidence interval in addition the uncertainty expressed by these samples can be propagated as required for example the validation statistic can be computed for each sample yielding a distribution of the validation statistic this distribution will express the uncertainty in having to estimate the trend and also the three model parameters from a sample of data 2 4 2 uncertainty estimation for the raw observational time series the standard non parametric bootstrap efron 1979 samples from the collocated observational time series the observations are chosen above the wave model because we assume the observations to follow a stochastic process whereas the numerical wave model produces deterministic results namely the significant wave height computed from the zeroth order moment of the variance density spectrum e g holthuijsen 2010 moreover the variance is noticeably higher in the un smoothed observations creating a larger spread and should therefore describe the uncertainty more adequately the observational time series is re sampled 1000 times ultimately resulting in a distribution of the validation statistic this provides a sense of uncertainty for the respective measure based on the degree of scattering in the measurement 3 results our study is based on a s3a track around the model time step of 2018 05 02 00 00 utc this is an arbitrary choice and our conclusion is also valid for other time steps nonetheless this track depicts crucial features which will be discussed in the following the chosen s3a track enters our domain in the north atlantic heading toward greenland crosses greenland the arctic and russia and continues from the bering sea to the north pacific fig 2 a the satellite track is obviously divided into two parts where we will call the footprints in the north atlantic track 1 and the footprints in the north pacific track 2 in track 1 the swh increases toward greenland and drops abruptly from ca 5 m to ca 1 m swh within a distance of 380 km this results in a spiky local maximum and a steep gradient in the time series fig 3 a and c the reason for the abrupt changes in swh is the sheltering effect of greenland the winds are mostly from west due to a low pressure system that travels from west to east over greenland fig 2 b waves generated by the low pressure system are stopped by the southern tip of greenland this leads to a short effective fetch and consequently a young wind generated wave field in the irminger sea close to the south eastern greenland coast strong gradients in winds along the southern greenland tip are not rare and are known to the scientific community doyle and shapiro 1999 with significant effect on the hydrography pickart et al 2003 and as evident here the wave field fig 3 a this is therefore a good example for a steep gradient and local maximum in the wave field as these phenomena are not rare and the emerging features need to be accounted for track 2 is characterized by a gradual increase in swh fig 3 b the increase of wave height toward the south is related to the increasing distance between the observation location and the coastline of the kamchatka peninsula under the prevailing westerly winds that occurred around the chosen time step not shown the time series depicts multiple suspicious values that attract attention by their isolated and pronounced deviation from their neighbors fig 3 c the detection of outliers will be elucidated in the following 3 1 outlier detection we focus on track 2 because there are obvious outliers which should be handled correctly by an automated outlier detection algorithm we apply the algorithm described in section 2 2 to detect outliers based on block sizes of 7 11 and 25 consecutive valid values fig 4 a illustrates the difference among super observations derived from different window sizes and the according difference between the catchment area for accepted values shaded area the choice of the block size affects considerably the detection of outliers none of the chosen window sizes detects all of the values that are seemingly erroneous in contrast the gp based 2σ confidence intervals is much smoother fig 4 b and the block size did not have to be chosen manually learning from the entire available time series of satellite observations the excursion of the super observation time series due to the outliers and the according 2σ region are more moderate all values that seem erroneous lie outside the catchment region for acceptable values and can thus be flagged as outliers the aforementioned suspicious values were recorded when the satellite swath passed bering island erroneous recordings are common close to land sea boundaries and near islands due to corrupted wave forms this is why e g young 1999 and zieger et al 2009 use land sea masks for the detection of erroneous recordings however the suspicious footprints in our case were located over sea and several tens of km away from the coastline this means that a land sea mask would not help to detect these error seven if flagging values additionally in the vicinity of land a possible problem for an outlier detection algorithm is non stationarity and non linear behavior in the process that produces the stochastic data therefore zieger et al 2009 assumed that within the block size of 25 values representing a distance of ca 180 km the recordings of the sea state can be considered representative without significant variability due to geophysical processes as illustrated in fig 3 this assumption can frequently be violated depending on the region of interest an example of such a violation is the local maximum close to the southern tip of greenland blue shading in fig 3 c fig 5 zooms in on the local maximum showing a sample of recordings with a block size of 23 values if this block had been chosen to detect outliers the leftmost value would have fallen outside of the catchment area for acceptable values and would have consequently been misinterpreted as an outlier in a time series this behavior is difficult to anticipate and thus not straightforward to employ in an automatic outlier detection algorithm however when using a gp based approach the arc like structure is automatically recognized and the sixth value from the right falls outside the blue shading this seems more intuitive to the eye than the first value from the left 3 2 comparing super observations from both approaches 3 2 1 example a short time series with a local maximum fig 5 b shows super observations derived from the moving averaging approach with different block sizes together with the gp approach if the displayed observations were the only available observations multiple values close to the boundary could not exist based on this block size illustrated in fig 4 a the gp approach however can provide super observations for the entire given observation time period to compare the different approaches for this case the moving average was allowed to borrow information from outside of the given block the choice of the averaging window is crucial for the resulting super observations where the similarity with the gp approach increases with decreasing block size fig 5 b however the smaller the block size the noisier are the super observations and the less representative is the sample size for computing the block average the 2σ area reduces with decreasing block size but depicts more frequent abrupt changes in variance these abrupt changes are challenging to interpret and probably unrealistic as the moving average seems to be more certain close to the local maximum and will be highly influenced by single values 3 2 2 example b longer time series a satellite track with a realistic sample size zoom in over the gray shaded area in fig 3 is shown in fig 6 a where the satellite track is directly compared with the wave model output the average based super observations with a block size of 7 values represent the super observations which one would have chosen according to the commonly applied scale analysis these moving average derived values follow closely the gp based super observations however for the gp based super observations no block size had to be chosen explicitly rather a physically logical range can be given where the estimation of the length scale is a result of a maximum likelihood optimization based on the behavior of the observations the resulting function carries the imprint of the information in the data through the optimal estimation of the trend and the three model parameters the two examples of block sizes illustrate what is intuitively anticipated namely that the larger the block size the smoother the super observations choosing an inappropriate block size of 25 consecutive values irons out important features in the observed wave field choosing the block size of 7 values results in a noisier structure but more variability in the observational time series can be retained the gp approach can model the observations with a very smooth function while retaining the variability in swh such a continuous behavior is expected for a swh field where abrupt changes would only occur on very fine spatial scales under certain circumstances e g modulation of the wave field by bathymetry wave current interactions or sharp changes due to coastlines another advantage of the gp approach is that it can provide information about the uncertainty of the observations and the super observations latent mean function as described in section 2 4 1 each observation and super observation can be seen in context with a desired number of realizations fig 6 b the scatter around the observations illustrates that each observation is just a random realization of what is likely to be the true sea state this makes both the super observations and the observations probabilistic the uncertainty can subsequently be propagated to other applications such as validation purposes 3 3 implications for the validation of wave models to illustrate the applicability and benefits of the gp approach for wave model validation we compute validation statistics commonly included in validation reports the validation statistics are defined in a and are computed based on the time series illustrated in fig 6 when computing a validation statistic from average derived super observations a single value describes the goodness of the wave model compared to an observational reference this approach cannot provide an uncertainty estimate this is problematic because the super observations used for the validation are based on semi subjective decisions which naturally introduce uncertainty different choices would lead to different super observations this uncertainty should be propagated to the validation statistics in order to rigorously quantify the significance of their magnitude we present two attempts to assess the uncertainty in the computed validation statistics sections 2 4 2 and 2 4 1 the resulting distributions for each validation statistic can differ considerably between the approaches fig 7 significant discrepancies are visible for the scatter index and the correlation coefficient while results for the bias are very similar the average based statistics overestimate the quality of the model compared to the raw data with non parametric bootstrapping and the gp approach for deviation based statistics this means a lower value and for the correlation a higher value this behavior results from smoothing the time series as illustrated in the following proposed by murphy 1988 the mean squared error mse can be decomposed as follows 6 mse m o 2 σ m 2 σ o 2 2 σ m σ o r mo where m is the mean of the model time series o is the mean of the observational time series σ m and σ o represent the standard deviation of the model and observational time series super observations or original respectively pearson product moment correlation between the model and observations is denoted by r the validation statistic mse and therefore also rmse a depend directly on the variance within the compared time series and hence the smoother the time series the better the validation statistic the in our case inappropriate window size of 25 therefore generates the best validation scores while validating against the noisy raw s3a data systematically leads to the worst results the non parametric bootstrap method applied to the raw observations can provide a distribution of the validation statistics with a substantial spread fig 7 red histogram the spread reflects the uncertainty based on the noise inherent in the observations it is then possible to choose percentiles to express a probability when comparing however the bootstrap results with the average and gp based results a systematic mismatch becomes visible as indicated above this is due to smoothing the time series but the question emerges whether the values being compared represent the same physical processes in case of using the non averaged values for validation and performing a bootstrap it is not taken into account that the model has a certain effective resolution in this framework the uncertainty and the associated histogram is not representative of the uncertainty of results from averaged or smoothed values essentially two different types of values are compared resulting in an overall underestimated model quality due to the noise in the observations when only using average based results the semi subjective choice of the correct length scale is crucial to producing representative observational values which can be compared to model values on the wave model scale recalling that the chosen length scale is besides being partly subjective also static it is likely that an inappropriate length scale is chosen in some cases at the same time no uncertainty of the derived statistic is available note that one could possibly quantify such uncertainty using relatively advanced parametric bootstrapping davison and hinkley 1997 however this is beyond the scope of this paper where the aim is to illustrate the relative ease with which such uncertainties are obtained from the gp approach the length scales chosen in this manuscript feature a tendency to overestimate the wave model quality likewise an underestimation would be possible in some cases when choosing to small length scales these shortcomings from having to decide on a length scale can be mitigated by using the gp approach if necessary the length scale for the gp approach can be constrained based on physical arguments the optimization of the model parameters signal variance noise variance and length scale are not subject to a subjective decision on a stationary value but are chosen objectively by maximizing the likelihood those parameters are allowed to vary from case to case and are learned each time depending directly on the characteristics of the observations moreover the result is probabilistic and can provide a distribution expressing the uncertainty of the quality of the wave model 4 discussion the chosen example featuring a strong gradient in the wave field due to the sheltering effect of greenland might seem extreme it is not however a single or unusual example as mentioned before a tip jet at the southern tip of greenland is a feature of frequent occurrence e g våge et al 2009 based on measurements from the nasa jpl seawinds scatterometer on board the quick scatterometer quikscat satellite moore and renfrew 2005 stress that the tip jet around greenland leads to surface wind speeds as high as 50 ms 1 with winds over 25 ms 1 occurring approximately 10 to 15 of the time those intense winds have a significant impact on the sea state for a considerable fraction of time when validating the wave model performance in this region especially due to the sheltering effect of land sharp gradients are expected to occur other places in the world oceans when choosing a static block size for outlier detection gradients and regime shifts in the wave field can violate the assumption of stationarity within the chosen block a feature and scale aware length scale as presented here can take this into account as the information is accessible in the observations since each predicted value of the gp model is weighted by the behavior of the neighboring observations across the entire time series the result is less sensitive to outliers while still reproducing the variability of the observational data to the desired degree this is of particular importance as the effective wave model resolution advances to ever finer scales the mismatch between the length scale of the satellite observations and the effective model resolution increases and could result in e g one or only a few satellite measurements per model grid point knowing however that the satellite value is a result of a stochastic process with considerable spread and abrupt changes while the true sea state features smooth transitions a limited number of observations might not be representative of the sea state as model resolution continues to increase this problem needs to be addressed and the gp approach is an attractive candidate an issue with smoothing by using a moving average is that dependence between the errors of single observations are introduced see section 2 2 however when planning to use the super observations for data assimilation into the wave model independence of the errors is desired saleh abdalla 2018 personal communication this is the reason for choosing non overlapping blocks of values as opposed to a moving average it is noteworthy that error dependency can be expected at every physical scale and that therefore even non overlapping blocks cannot ensure independence of errors in general the gp model as formulated here will create a smooth super observational time series without introducing additional error correlation as gaussian noise is only added to the diagonals of the covariance matrix the skill of the gp model to capture the auto correlation inherent in the underlying process while leaving error dependency insignificant is displayed in fig b 8 the gp produced values can therefore be used for both wave model validation and data assimilation not having to divide into independent blocks further results in more super observations available for validation and assimilation the gp model introduced here is motivated by the physical properties of the wave field however as demonstrated in rasmussen and williams 2006 and camps valls et al 2016 there are many ways to adjust the kernel function to the problem at hand our work aims mainly at introducing the gp approach to the field of wave model validation using super observations and presenting inherent advantages for this reason we chose a comparably simple model formulation which serves the understandability of what is going on in the gp model to optimize the performance of the space time evolution one could explore e g the impact of using different kernel functions as well as customize a desired behavior by combing the available kernel functions to imitate the presumed underlying process a full bayesian inference rasmussen and williams 2006 could also be pursued where the kernel function parameters are again parameterized with hyperprior distributions as visible in the fig b 8 despite the overall good performance of our gp model there might be room for tuning e g regarding the auto correlation of the y samples within the first lags and the wiggles in the residuals however it is important to note that neither of these issues wiggles nor the first lags are of statistical significance in future studies especially the impact of adding heteroscedasticity to the gp model could be investigated 5 summary and conclusion we propose a highly flexible approach to compute super observations and detect outliers utilizing a gaussian process we subsequently validate wave model results where our approach allows us to retrieve a probabilistic estimate of the validation statistics there is no need to exactly specify the length scale for the computation of super observations and outlier detection since our super observations and uncertainty bounds are maximum likelihood estimates the data dependence and automated way to fit is scale sensitive and assures flexibility these are characteristics that are important for the validation of high resolution model simulations if needed our approach would even allow the prediction of super observations for a model grid cell along the satellite track interesting e g for the validation of very high resolution simulations or for imputation of missing values the characteristics of the here proposed formulation ensures that no significant additional error correlation is being introduced which is beneficial for using the super observations for data assimilation gaussian processes are getting increasing attention as state of the art tools for regression problems in the field of earth observation data analysis their advantages are discovered and exploited across scientific disciplines camps valls et al 2016 although our work focuses on the computation of super observations from satellite tracks for wave model validation the here formulated gp model can be used just as well for measurements from other platforms e g buoys or other variables like e g wind speed acknowledgement the authors gratefully acknowledge the funding support from the copernicus marine environmental and monitoring service under mercator ocan contract no 60 cmems mfc arctic øyvind breivik acknowledges the support from the cmems service evolution project waveflow we would also like to thank saleh abdalla ecmwf for helpful comments and suggestions at an early stage of this study appendix a equations for the validation statistics variable names and the statistics bias mae and rmse follow the convention from wmo 2010 the computation of the scatter index is adopted from the ecmwf 3 3 https www ecmwfr int en newsletter 150 meteorology twenty one years wave forecast verification x f is the forecast values of the chosen parameter x v is the value to evaluate against ground truth x c is the climatological value of the chosen parameter n is the number of values to be used for verification bias or mean error a 1 bias me 1 n i 1 n x f x v i mean absolute error a 2 mae 1 n i 1 n x f x v i root mean square error a 3 rmse 1 n i 1 n x f x v i 2 pearson product moment correlation coefficient a 4 r f v cov x f x v σ f σ v scatter index a 5 si std x f x v mean x v 100 appendix b auto correlation this section illustrates the empirical auto correlation function acf of the observational time series compared to the acf of artificially generated observations y i produced by our gp model consistent with the rest of this study we produced 1000 artificial observational time series from a parametric bootstrap the residuals were computed by subtracting original observations from all 1000 time series fig b 8 a shows the mean of the empirical auto correlation functions acf of 1000 y samples generated with our gp model black with 95 uncertainty bounds gray from parametric bootstrapping the red line is the acf from the unprocessed measurements depicting a very similar behavior b shows the acf of the residuals where no significant auto correlation is present fig b 8 
24028,this paper introduces the sobol indices approach for global sensitivity analysis sa in the context of marine biogeochemistry such an approach is particularly well suited for ocean biogeochemical models which make use of numerous parameters within large sets of differential equations with complex dependencies this sa allows for a detailed study of the relative influence of a large number of input parameters on output quantities of interest to be chosen it is able to distinguish between direct effects of these parameters and effects due to interaction between two or more parameters although demanding in terms of computation such a tool is now becoming affordable thanks to the development of distributed computing environments an applicative example is presented with the modecogel biogeochemical model and illustrates the advantages of this approach over standard local sa keywords sensitivity analysis sobol indices marine biogeochemistry 1 institute of engineering univ grenoble alpes 1 introduction marine biogeochemical models are now commonly included as modules in complex ocean circulation modeling systems they are thus increasingly used for many applications however the use of these models raises difficult questions especially regarding their tuning they are generally systems of nonlinear ordinary differential equations with each equation expressing the time evolution of a given state variable due to hydrodynamical effects transport and diffusion and to fluxes between the various components of the ecosystem two features of these models are noteworthy first the evaluation of the fluxes involves a wide variety of processes and hence numerous parameters typically several times more than the number of variables secondly the values of these parameters are often quite poorly known in reality the values of the parameters depend on the physical and biogeochemical context while in practice the available reference values were usually estimated only in a particular situation e g during a field experiment or in laboratory experiments not in the actual context of interest the uncertainty of these values is thus generally quite large see for example schartau et al 2017 for a review on the identification of such parameters in this context sensitivity analysis sa i e methods that aim to quantify the relative influence of the inputs on some given outputs in a complex system like a numerical model are a valuable tool indeed they can help better understand the model itself and identify which parameters are most influential and should be calibrated carefully these methods may be divided in two main categories local sensitivity methods that consider the behavior of the solution with respect to small parameter variations and global sensitivity methods that determine the behavior of the solution under parameter perturbations of arbitrary magnitude a common approach is to conduct a few experiments in which the values of parameters vary either one at a time oat or simultaneously e g baklouti et al 2006 druon and le fèvre 1999 kriest et al 2012 some additional techniques are also sometimes used such as linear error propagation omlin et al 2001 or the gaussian emulation machine approach scott et al 2011 which clearly involve global sensitivity analysis another approach defines the sensitivity of the output with regard to the input as the corresponding gradient both input and output variables must of course be continuous real valued quantities this so called gradient based sa thus requires computing gradients this is straightforward for simple cases but challenging in general for instance the gradient of a single output quantity q with regard to a constant parameter p can be approximated by q p α q p α where p is the current value of p and α is taken to be small the computation of this approximate gradient simply requires running the model twice using successively p and p α for parameter p however estimating the gradient can be much more difficult if p is multivariate or non constant e g if p is a space and or time dependent coefficient in such cases the preceding approach of computing growth rates requires n 1 evaluations of the model where n is the dimension of p e g the number of space time grid points if n is large an alternative to computing growth rates is to use the so called adjoint method which provides the exact gradient this approach was used for instance in fennel et al 2001 faugeras et al 2003 and tjiputra et al 2007 however the gradient is computed it is important to understand that gradient based sa is a local method in the sense that the gradient is a local notion computed in the vicinity of the current value of p therefore this gradient which is a way to quantify the influence of p on q can be quite different depending on the value of p chosen this limitation can be avoided by using an approach based on a global sensitivity measure i e an approach that quantifies the influence of p on q taking into account the possible variation of p such a quantification is provided for example by sobol indices which will be introduced in the next section given their global character computing such indices may of course require a huge number of model evaluations which increases with the input space dimension therefore it is usual to first carry out as a preliminary step a screening analysis such as the oat screening approach introduced in morris 1991 a screening procedure aims at fixing the input parameters whose influence on the output is qualified as negligible after a rough exploration of the input parameter space it reduces the input space dimension then in a second step a monte carlo sampling based sensitivity and ranking analysis is run see e g sankar et al 2018 or sobol indices are computed see e g morris et al 2014 wang et al 2018 however given the increases in computational resources we think that performing a direct global sa is now feasible even for a high dimensional input space and that it is time for the scientific community to make computation of sobol indices the first choice particularly when dealing with highly parameterized models in this context the aim of this paper is to introduce the sobol indices approach for global sensitivity analysis and to illustrate its feasibility and its scientific relevance in the context of marine biogeochemistry note however that our focus is to present the methodological tools in the context of a particular example rather than to conduct an in depth physical analysis first the global sa approach and the sobol indices are introduced in section 2 then in section 3 we present the biogeochemical model its many uncertain parameters and the selected output quantities section 4 is devoted to implementation aspects of the sa and section 5 focuses on results that help illustrate the features of this method in particular a comparison with a gradient based local analysis is presented 2 global sensitivity analysis the framework as indicated above the aim of sensitivity analysis is to determine which model inputs are the most influential on some given model outputs in the following a model output y is considered to be a deterministic scalar function of some model inputs x x 1 x d where these inputs belong to a domain δ y y x y x 1 x d with x δ in section 3 we consider various scalar outputs corresponding to different quantities of interest in this paper we adopt the stochastic framework of global sensitivity analysis unlike local sensitivity analysis which analyzes how a small perturbation near an input space value x 0 x 1 0 x d 0 influences the value of the scalar output global sensitivity analysis considers the whole variation range in the input space more precisely each input parameter is considered to be a random variable x j j 1 d where its uncertainty is modeled by some one dimensional probability distribution the output y is then assumed to be a scalar random variable y f x where x x 1 x d with the x i assumed to be independent various sensitivity measures have been proposed in the global framework we focus in this paper on variance based sensitivity measures introduced in sobol 1993 2 1 variance based sensitivity measures in order to quantify the influence of the variations of x j on the variations of y let us consider the conditional expectation e y x j x j it corresponds to the mean value of y over the probability distributions of the x k k j when x j is fixed to x j the corresponding random variable when considering the variations of x j is e y x j and its variance quantifies the influence of x j on the dispersion of y the so called sobol sensitivity indices are obtained by normalizing this variance by the total variance of the output y which is assumed to be finite and non null thus the first order sobol sensitivity index of input parameter x j is defined as 1 s j var e y x j var y it belongs to the interval 0 1 2 2 the sobol decomposition more generally starting from the functional analysis of variance anova decomposition efron and stein 1981 hoeffding 1948 owen 1992 sobol 1993 one can define sensitivity indices of any order r 1 d let us first introduce some notation we assume that f is a real square integrable function u is a subset of 1 d u c stands for its complement its cardinality is denoted by r u and x u represents the random vector with components x j j u the functional anova decomposition then states that y f x can be uniquely decomposed into summands of increasing size 2 y f x u 1 d f u x u where f e y and the other components have zero mean value and are mutually uncorrelated this decomposition eq 2 yields a corresponding decomposition of the variance of the output 3 var y u 1 d u var f u x u for any j 1 d the term var f j x j corresponds to the part of the output variance explained by parameter x j for any j j 1 d j j the term var f j j x j x j corresponds to the part of the output variance explained by combined effects of parameters x j and x j more generally for any u 1 d the term var f u x u corresponds to the part of the output variance explained by combined effects of parameters x j j u then for any u 1 d the sobol index sobol 1993 of order r u associated to the vector x u is defined as 4 s u σ u 2 σ 2 var f u x u var y the main effect of the j th factor is thus measured by s j then the effect due to the specific interaction between the j th and k th factors k j is measured by s j k and so on for higher order indices saltelli et al 2000 corresponding cumulative effects are defined by so called closed sobol indices defined as 5 s u closed v u s v we thus have for instance s j k closed s j s k s j k which means that the closed second order index s j k closed measures the effect of the interactions between parameters x j and x k in addition to the main effect of each of these two parameters for any j 1 d we also define a total sensitivity index s j tot homma and saltelli 1996 to express the overall sensitivity to an input x j as 6 s j tot v 1 d with j v s v we have then for instance in the case where d 3 s 1 tot s 1 s 1 2 s 1 3 s 1 2 3 2 3 estimating the sobol indices for simple models sensitivity analysis can sometimes be done analytically by direct examination of their mathematical expression however this is of course generally not the case for complex models in those cases one evaluates the model for selected values of the input parameters and the resulting output values are used to estimate sensitivity indices of interest for interested readers monte carlo based procedures for the estimation of sobol indices are described in detail in appendix a let us summarize the different strategies we apply in section 5 in section 5 1 we apply the replication procedure introduced in mara and rakoto joseph 2008 and further studied in tissot and prieur 2015 to estimate all first order sobol indices with only two replicated d dimensional latin hypercube samples of size n that is with only 2n model evaluations in section 5 2 we apply the replication procedure introduced in tissot and prieur 2015 to estimate all closed second order sobol indices with only two replicated d dimensional randomized orthogonal arrays of strength 2 and size n that is again with only 2n model evaluations due to constraints in the construction of orthogonal arrays of strength 2 n must be chosen as q 2 with q a prime number greater than or equal to d 1 in section 5 3 we apply the procedure introduced in saltelli 2002 theorem 1 to estimate all first order and total sobol indices with a cost of only d 2 n model evaluations this procedure is based on combinatorial arguments these procedures are implemented in the functions sobolroalhs sobolsalt of the package sensitivity all these strategies are detailed in appendix a a crucial point in the above summary is that the cost in terms of number of model evaluations required to estimate total sobol indices is only linear in the input space dimension d in the following see section 4 we present an implementation using a grid computing environment however even in such a framework the estimation of total sobol indices be expensive if d is large thus depending on the computational resources of the study one could avoid the estimation of these total indices and focus instead on the estimation of all first order and closed second order sobol indices as a first step in the sensitivity analysis 3 description of the ocean biogeochemical model the sa approach is applied to the 1d biogeochemical modecogel model of the ocean mixed layer described in section 3 1 the uncertain input parameters of the model vector x in section 2 are described in section 3 2 and several output quantities y in section 2 are listed in section 3 3 corresponding to key model results whose sensitivity to the input parameters is not obvious 3 1 the modecogel model the model used in this paper is modecogel 1 1 modecogel modèle d ecosystème du gher geohydrodynamics and environment research et du lov laboratoire d océanographie de villefranche sur mer it was developed for investigating the biogeochemical activity in the ligurian sea by lacroix 1998 by coupling a 1d hydrodynamic model of the mixed layer to a 12 component ecosystem model the hydrodynamic model is a 1d version of the gher primitive equations model nihoul and djenidi 1987 the state variables are the horizontal velocity the potential temperature the salinity and the turbulent kinetic energy a full description of the model can be found in lacroix and nival 1998 or lacroix and grégoire 2002 where it is applied to simulate the behavior of the system during the frontal oceanographic campaigns from 1984 to 1988 in the present paper the model is applied to years 2006 2007 and the atmospheric dataset is extracted mainly from the côte d azur meteorological buoy located at the dyfamed station boussole project at hourly frequency marty and chiavérini 2010 the ecosystem model provides a 12 component description of the ecosystem of the ligurian sea see state variables in table 1 a detailed description of this model can be found in lacroix and grégoire 2002 the time evolution of each state variable is governed by the equation 7 c i t adv i diff i sms i with sms i j i flux c j c i where adv i and diff i are advection and diffusion terms governed by the hydrodynamic model and sms i is the source minus sink term summing up the fluxes flux c j c i between the various components of the ecosystem conservation of course imposes that flux c j c i flux c i c j these fluxes can be sorted into several categories primary production secondary production mortality exudation excretion growth of bacteria decomposition of particulate organic matter and nitrification we refer to appendix b for a detailed description of these different processes eq 7 is solved numerically between the sea surface and 405 m depth using a constant vertical discretization 1 m and a constant time step 6 min outputs are saved daily at all depths it is important to note that the mathematical expression of these flux terms contains numerous parameters whose values are not known precisely in the following consistent with the objective of this study we provide only a brief overview of these model parameters with a specific focus on the assumptions that we make regarding their respective uncertainties 3 2 model parameters the biogeochemical fluxes c j c i parameterized in modecogel are summarized in table b 8 appendix b each flux depends on several of the parameters listed in table c 9 appendix c moreover the parameterization of each process as a joint function of the model state and parameters is often complex and nonlinear as a result it is usually impossible for the user to know the sensitivity of the whole system to the parameters a systematic computational approach is thus needed to apply the sa method described in section 2 a probability distribution must be specified for each input parameter this has been done here using the following guidelines in the absence of any reliable information about possible correlations the uncertainties of the various parameters are assumed independent most parameters are constrained to be either positive or negative for consistency with the formulations used to parameterize the processes they are assumed to follow a gamma distribution parameters constrained between 0 and 1 are assumed to follow a beta distribution some parameters are constrained to be larger than 1 their logarithm is assumed to follow a gamma distribution some parameters are not constrained and are assumed to follow a gaussian distribution three different values for standard deviations are used 5 20 50 of the expected value according to the confidence we have in the parameters these values were provided by biogeochemical modelers using a priori knowledge the resulting probability distributions are given in table c 9 appendix c 3 3 quantities of interest the quantities of interest qoi i e the output values y must be defined according to the main scientific objectives of the sensitivity study in the present case for this example we have chosen to focus on characterizing the simulation of phytoplankton concentrations c 3 c 4 and c 5 in table 1 which is at the base of the marine food web as an additional quantity we also introduce chlorophyll concentration noted c 0 which is what is observed by ocean color data and which can be approximately computed from phytoplankton concentrations using a constant chlorophyll to nitrogen ratio α 8 c 0 α c 3 c 4 c 5 since sensitivity analysis applies to scalar output quantities to apply the sa method we need to reduce the time and space variations of c 0 c 3 c 4 and c 5 to some scalar indicators note that the cost of the method is almost independent of the number of these indicators however they must be defined before running the sensitivity study to illustrate the method we thus decided to introduce a range of different qoi characterizing c 0 c 3 c 4 and c 5 without limiting our choice to simple linear diagnostics table 2 summarizes the qoi y ij that we will use in our application the second index j corresponds to the computed diagnostic while the first index i corresponds to the concentration i 0 3 4 5 to which it is applied this set of five diagnostics is meant to characterize i the maximum intensity of the phytoplankton spring bloom at the surface and as a vertical average ii the time at which it occurs and iii the overall average over the whole simulation 4 practical aspects of the sensitivity analysis in this section we provide more details about the numerical implementation of the sensitivity analysis i e the computation of estimates of all first closed second order and total sobol indices 4 1 grid computing environment in most cases the primary cost of the global sensitivity analysis is due to the need for numerous evaluations of the model in our study each model evaluation is short approximately 50 s however 2n evaluations are required to estimate all first order or all closed second order sobol indices and d 2 n evaluations are required to estimate all total sobol indices where n is typically of order 103 106 furthermore we must manage the model s input and output files this problem thus requires specific tools to automatically organize data management and access to computational resources note also that since we have to perform a very large number of model runs our computing environment must include fault tolerance a grid computing environment i e a distributed architecture of computers linked by communication networks and managed by middleware software is particularly well suited for this kind of application in which multiple parallel computations take place independently without the need to communicate intermediate results between processors in our implementation we used computing resources at the university of grenoble 2 2 seehttps ciment ujf grenoble fr wiki pub index php distributed on three sites 10 clusters 6600 cpu cores and 176 gpu cores these resources are connected by a local grid 3 3 https ciment ujf grenoble fr wiki pub index php grid computing associated with several storage nodes distributed among the three sites as close as possible to each supercomputer and managed by the middleware irods 4 4 seeirods org each cluster uses the local resource manager oar 5 5 seeoar imag fr and accesses the full 6600 cpu cores through the middleware cigri 6 6 http ciment ujf grenoble fr cigri dokuwiki doku php which launches embarrassingly parallel jobs on idle processors cigri is able to manage job failures in a smart way which allows the user to submit many small jobs as a final step we also need to transfer many input and result files distributed over different irods resources on a laptop or a computer server of a laboratory this is achieved efficiently using a python script 4 2 implementation of our study as indicated above the modecogel model presented in section 3 includes 74 uncertain input parameters each with an associated probability distribution see table c 9 the global sensitivity analysis is done with the r package sensitivity pujol et al 2017 r 7 7 http cran r project org is a free software environment for statistical computing and graphics the design of the experiments doe and the estimation of the sobol indices and their associated confidence intervals use the functions sobolroalhs and sobolsalt function sobolroalhs which estimates all first order and all closed second order indices is based on the replication procedure briefly described in section 2 3 and detailed in appendix a it makes use of four replicated designs of size n two for first order indices and two for closed second order indices the grid deployment used for the estimation of all first order sobol indices is done as follows see also fig 1 construct two replicated latin hypercube samplings lhs of size n with the sobolroalhs function evaluate the model on the doe in order to minimize the overhead corresponding to the submission of each evaluation and to optimize the use of the best effort mode of the batch manager the model runs are performed one hundred at a time each group of simulations corresponds to 100 different sets of the 74 input parameters and requires an average cpu time of 84 min and a small input and output files of approximately 200 ko for n 106 we thus submitted 20 000 jobs on the computing grid merge the 2n files containing the evaluations of the quantities of interest on the doe treat outliers a small percentage of the model evaluations fail or lead to completely spurious results due to unrealistic combinations of the input parameters the quantities of interest are then set to nan and will be treated as missing values in the computation of sobol indices compute sobol indices using the function sobolroalhs note that the experimental designs and the functions used to compute sobol indices differ for the estimations of closed second order and total indices as detailed in section 2 3 5 results we focus here on the quantities of interest qoi which are summarized in table 3 and described in section 3 once again our aim with this global sensitivity analysis of the modecogel model is not to perform an in depth biogeochemical analysis of the results this is outside the scope of this study but rather to show how these statistical tools provide a better understanding of complex systems involving many parameters 5 1 first order indices the 74 first order sobol indices were estimated for each qoi for different values of the sample size n 103 104 105 and 106 for each index and each value of n both its estimate and a 95 confidence interval are provided these results are plotted on fig 2 for output y 01 namely the maximum surface chlorophyll concentration as expected the size of the 95 confidence interval decreases to zero as n increases and n 106 seems to be a sufficiently large sample size to get accurate estimates size of the 95 confidence interval smaller than 0 01 0 01 which allows a clear ranking of the largest indices only ten parameters have a first order index greater than 0 01 0 01 their values are reported in table 4 quite similar results are actually obtained for the other qois and it appears that only 15 or 9 model parameters have a first order sobol index greater than 0 01 for at least 1 or 6 qois respectively the threshold 0 01 was chosen to guarantee a clear separation between inputs with high and low first order indices this is summarized in fig 3 where these most influential model parameters are clearly visible this mostly highlights the important sensitivity of our qois to the parameterization of excretion for bacteria of grazing and ingestion for mesozooplankton and of the variation of light limitation for phytoplankton this small number of influential parameters may indicate that an efficient reduction of this model could be performed to produce a reduced order model involving many fewer parameters note however that the sum of first order indices is equal to 0 371 this is far less than 1 which clearly indicates that the outputs considered are not simple additive models of the form y f 1 x 1 f d x d there are some interaction effects of the parameters on the qois which motivates the investigation of second order interaction effects 5 2 second order indices as indicated before the sobolroalhs function allows the estimation of closed second order indices at a cost of 2n model evaluations let us recall that the closed second order index corresponding to the j th and k th parameters is defined as 9 s j k closed s j s k s j k and corresponds to the sum of the main and interaction effects due to these two parameters a specificity for the estimation of closed second order indices with the replication procedure is that n has to be chosen equal to q 2 where q d 1 is a prime number denoting the number of levels of the orthogonal array see appendix a for more details a value of q 227 i e 2n 103 058 was necessary to achieve sufficiently accurate estimates of the indices estimates of the d d 1 2 2701 closed second order indices along with their corresponding 95 bootstrap confidence intervals were then computed for each qoi they are displayed in fig 4 for the output y 01 annual maximum of chlorophyll concentration which was already chosen in fig 2 and table 4 it clearly appears that very few of these 2701 indices are significant given the definition eq 9 of the s j k closed most of them obviously correspond to at least one influential parameter listed in table 4 as clearly displayed in fig 5 a using these closed second order index estimates and the previous estimates of first order index we compute consistent estimates of unclosed second order sobol indices s j k with a bootstrap algorithm these indices quantify the fraction of variance of the qoi due to these two parameters that cannot be explained by the sum of the main effect of x i and x j but only by their interaction they are displayed in fig 5b in the particular case of output y 01 new interesting information arises from this plot first it appears that input parameters with strong direct influence i e strong first order indices may or may not have significant interactions with other parameters for instance parameters 36 and 57 see table c 9 related to semi saturation for ingestion by mesz and fraction of grazing used for growth of mesz have weak second order indices conversely parameters 15 and 18 related to variation of light limitation for nanp and to optimal temperature for nanp which already correspond to large first order indices have also strong interactions with many other parameters see fig 6 a secondly some other parameters that have not been noticed yet since they have weak first order indices show strong interactions with numerous other parameters let us mention in particular parameters 8 and 12 related to nh4 semi saturation for picp and to optimal par for nanp see fig 6b these results are summarized in fig 6 recall that the value 0 01 for the threshold in fig 6 was chosen to guarantee a clear separation between inputs with high and small first order indices at this stage the information from the first and second order indices remains incomplete higher order interactions can be expected especially for highly parameterized models like marine biogeochemistry a natural step forward in the study is then to compute total indices 5 3 total order indices the total sobol index s j tot j 1 d defined in eq 6 expresses the overall sensitivity of some qoi to the input x j as mentioned in section 2 and appendix a a competitive procedure to estimate simultaneously all first and total sobol indices was introduced in saltelli 2002 and implemented by the function sobolsalt of the r package sensitivity its cost is however still quite high since it requires d 2 n model evaluations however this linear computational complexity with regard to the input space dimension d cannot be avoided therefore depending on the computational resources available for the study computing such indices is not always affordable although they bring important information since input parameters with a very low value for their total sobol index can be fixed to a nominal value in a calibration procedure a scatter plot of first order and total indices is displayed in fig 7 we observe that the parameters contribute to the total variance primarily through their interactions with other parameters the dots are far above the line y x however the relation between first order and total indices is not linear more precisely parameters having a large main effect generally also contribute to the total variance through their interactions with other parameters fig 8 a nevertheless the relative importance of these interactions may vary significantly for instance parameter 67 temperature variation of excretion for bacteria which corresponds to the largest first order index has a total index smaller than several other parameters with much smaller first order indices on the other hand some parameters with a very small main effect make a non negligible contribution to the total variance via their interactions with other parameters fig 8b this heterogeneous distribution of the relative importance of the first order effect with regard to the total effect is summarized in fig 9 where the ratio s j s j tot is displayed 5 4 comparison with a local analysis the majority of previous sensitivity analyses performed on ocean biogeochemistry models have used local methods such as the gradient method or methods where parameters are varied one at a time it is therefore interesting to compare the results we have just obtained using the global sobol indices method with equivalent results obtained using local methods applied to the same modecogel model we have thus computed the gradients of our qoi with regard to the 74 input parameters the partial derivatives are approximated by 10 y x j x 1 x d y x 1 x j 1 x j α x j 1 x d y x 1 x d α where α is a small value ensuring very good accuracy of the estimate in our case we checked that any value of α between 1 0 3 var x j and 1 0 6 var x j is relevant and leads to the same value for the gradient d 1 i e 75 in our case model runs are required the local character of this gradient appears clearly in eq 10 the gradient is computed for a particular value x 1 x d x 1 x d in our case we choose to compute it for the mean values of the 74 parameters listed in table c 9 i e for x 1 x d e x 1 e x d as can be seen in fig 10 a and in table 5 according to this gradient the two parameters 67 and 66 temperature variation of excretion for bacteria and mesozooplankton respectively have a very strong impact on y 01 the importance of parameter 67 was already noted previously since it corresponds to the largest first order sobol index and to one of the largest total indices however parameter 66 does not appear as one of the most influential parameters from the global sa its ranking is just 12th among first order indices and 73rd of 74 considering total indices conversely several parameters that were clearly highlighted by the global sa do not correspond to large values of the derivative this is the case for instance for parameter 14 variation of light limitation for picophytoplankton its ranking is 3rd considering total indices and 7th considering first order indices but only 21st considering derivatives similar remarks can be made for parameters 30 36 and 57 see table 6 in the same way the local analysis indicates that parameters 15 and 18 variation of light limitation and optimal temperature for nanophytoplankton are ten times less important than parameters 66 and 67 in contrast the total sobol indices show that they are actually more important table 5 in summary the local analysis identifies parameters 66 and 67 as important and only to a much lesser extent a few others however the comparison with sobol indices clearly shows that this is only local information relying only on this local information would lead us to waste effort tuning some parameters and to neglect entirely other important ones a complementary way to look at this local gradient is to compute s j loc var x j var y y x j 2 this local index is non dimensional it can be interpreted as a relative gradient since it could also be written as y x j 2 where y y var y and x j x j var x j are normalized versions of y and x j its interest for our study lies in the fact that in the case of a linear dependency y a 0 a 1 x 1 a d x d and of the independence of input parameters this index is equal to the first order sobol index as can be seen in fig 10b this index indicates that the most and almost only influential parameter is parameter 66 and to a much lesser extent parameter 67 as noted previously this result is contradicted by the global sa this disagreement is a clear illustration of the strongly nonlinear character of the modecogel model 5 5 computational costs the relative computational costs of the different algorithms are displayed in table 7 along with the estimated error related to the sobol indices i e the half length of the 95 bootstrap confidence interval as mentioned earlier the computation of total indices requires a number of model runs proportional to d 2 which is much more than for the evaluation of only first and second order indices moreover the estimation error is inversely proportional to n as is mainly the case in monte carlo methods consistent with the rate of convergence in the central limit theorem note that other designs of experiments such as quasi monte carlo methods are not considered in this paper since we do not assume any mathematical regularity in the underlying model in the present case given the order of magnitude of the indices n 105 appears to be a good compromise between accuracy and computational cost 6 conclusion the added value of sa is primarily to help scientists understanding the behavior of their models and identifying their most influential parameters then as a by product in the context of model tuning it helps focusing optimization effort on these few parameters see for instance the two review papers by oschlies 2006 and dowd et al 2014 and references herein on data assimilation in the context of ocean biogeochemical models in the present work a global sensitivity analysis based on sobol indices is presented in the context of a realistic ocean biogeochemical model without delving into complex physical interpretations the aim of this study is to demonstrate the potential interest of this systematic and mathematically sound approach for such applications this method quantifies the influence of uncertain input parameters on an arbitrary number of output quantities of interest either through their direct effect or through their mutual interactions in the present study which was performed with a full monte carlo method thus avoiding any restrictive hypothesis on the effective dimension of the model or on its regularity we started by computing first and second order indices this highlighted on the one hand the strong influence of some input parameters and of some second order interactions and on the other that some higher order interactions were probably significant total sobol indices were thus computed which provided complementary information note that total indices can also be a helpful source of information for constructing reduced models since they identify parameters whose values could be frozen these results were then compared to those derived using a local oat gradient based sa where each parameter was varied individually around a point in parameter space corresponding to the average it clearly illustrated the fact that a local sa can lead us to focus our attention on non globally relevant parameters and to neglect the influence of globally important ones this comparison also brought out the strongly nonlinear character of the biogeochemical model considered here more generally from a biogeochemical point of view the methods described in this paper can provide a substantial help in the design of the models in the tuning of their complexity and in the understanding of their dependence to uncertainties in the parameters it was shown indeed in our test application that the traditional sensitivity studies based on local methods can lead to misleading conclusions and thus to a misunderstanding of the influence of every individual process on the key results of the simulations accounting for the nonlinear effects and for the interactions between the various processes is needed to decide what must be explicitly resolved by the model and carefully tuned and what can be roughly parameterized until recently this ambition was very difficult to achieve the take home message for further ocean biogeochemical research is that due to the constant increase of computational resources combined with recent advances in estimation procedures for the sensitivity measures it is now possible to perform a global sensitivity analysis based on the computation of sobol indices large sets of input parameters can be considered and indices as expensive as total indices can be feasibly computed by taking advantage of grid computing environments which scale easily to high dimensional applications appendix a estimation procedure for sobol indices in this paper we used a monte carlo based procedure for the estimation of sobol indices sobol 1993 which we describe in detail below let us first introduce some notation let u be a non empty subset of 1 d let x 1 x 1 1 x d 1 and x 2 x 1 2 x d 2 be two independent copies of the input vector x x 1 x d let x 1 i i 1 n be an independent and identically distributed i i d sample of size n of vector x 1 and x 2 i i 1 n be an i i d sample of size n of vector x 2 for any u 1 d we define the d dimensional vector x u x u 1 x u d in the following way for any j u x u j is equal to x j 1 and for any j u c x u j x j 2 the n sample x u i i 1 n is defined in a similar manner and we define the corresponding output variables a 1 y f x 1 y u f x u and y i f x 1 i y u i f x u i it is possible to prove that s u closed cov y y u var y see e g lemma 1 2 in janon et al 2014 based on the above formula we propose the following estimator for s u closed a 2 s closed u n 1 n i 1 n y i y u i 1 n i 1 n y i y u i 2 2 1 n i 1 n y i 2 y u i 2 2 1 n i 1 n y i y u i 2 2 this estimator was first introduced in monod et al 2006 its asymptotic properties are stated in janon et al 2014 propositions 2 2 and 2 5 see also gamboa et al 2016 for further asymptotic and non asymptotic results since s j s j closed see eq 5 we therefore estimate s j with s j n s j n closed recall now the law of total variance which can be found e g in weiss 2006 pages 385 386 a 3 var y var e y x u e var y x u from the definition of total sobol indices we can prove that a 4 s j tot e var y x j c var y from eqs a 3 and a 4 we deduce s j tot 1 s j c closed we thus define the estimator of s j tot as s j n tot 1 s j c n closed these estimators require a large number of model evaluations indeed the estimation of all first order indices actually requires d 1 n evaluations of the model y i y j i i 1 n j 1 d the estimation of all closed second order indices requires d d 1 2 1 n model evaluations of the model y i y j k i i 1 n j k 1 d the monte carlo sample size n is directly related to the accuracy of the estimation via the rate of convergence in the central limit theorem which is of order n see proposition 2 2 in janon et al 2014 to circumvent this linear or quadratic dependence of the cost in terms of number of model evaluations in the input space dimension d the authors in tissot and prieur 2015 proposed a procedure based on replicated latin hypercube sampling lhs e g lemieux 2009 or replicated randomized orthogonal arrays to estimate all first order or all closed second order sobol indices respectively the ideas in tissot and prieur 2015 generalize some pioneer work in mara and rakoto joseph 2008 we refer to tissot and prieur 2015 for a detailed description of the procedure and a rigorous analysis of its asymptotic properties in the present paper we applied the replication procedure to estimate all first order sobol indices in section 5 1 and to estimate all closed second order sobol indices in section 5 2 more precisely the replication procedure in section 5 1 allows us to estimate all the first order sobol indices with only two replicated d dimensional lhs of size n that is with only 2n model evaluations the replication procedure in section 5 2 allows to estimate all closed second order sobol indices with only two replicated d dimensional randomized orthogonal arrays of strength two and size n that is with only 2n model evaluations due to constraints in the construction of orthogonal arrays of strength two n must be chosen as q 2 with q a prime number greater or equal to d 1 note that orthogonal arrays were introduced for the first time in kishen 1942 if higher order interactions are expected in the model of any order greater or equal to three one may be interested in estimating total sobol indices the replication procedure does not adapt to the estimation of total sobol indices mainly because of the constraints in the construction of orthogonal arrays of strength higher or equal to three in saltelli 2002 the authors propose two different procedures both based on combinatorial tricks the first one allows the estimation of all first order and total sobol indices with a cost of d 2 n model evaluations see theorem 1 in saltelli 2002 the second one leads to a double estimate of all first order closed second order and total sobol indices at a cost of 2d 2 n model evaluations see theorem 2 in saltelli 2002 to our knowledge the procedure in saltelli 2002 theorem 1 is the most competitive one if the estimation of total sobol indices is involved see also gilquin et al 2017 it is the one we have applied in section 5 3 appendix b description of biogeochemical fluxes the biogeochemical fluxes c j c i parameterized in modecogel are summarized in table b 8 each flux depends on several parameters which are indicated by referring to the parameter list in table c 9 in appendix c to give an idea of the role of each parameter in modecogel the biogeochemical fluxes are organized into several categories using different colors primary production green is the growth of phytoplankton by photosynthesis in table b 8 this corresponds to all fluxes from nutrients c 1 c 2 to phytoplankton c 3 c 4 c 5 parameters govern the maximum growth rate 1 3 and the dependence on nutrient concentrations 4 10 to solar irradiance 11 16 and to temperature 18 20 secondary production blue is the growth of zooplankton by grazing of phytoplankton or by assimilation of bacteria and particulate organic matters in table b 8 this corresponds to all fluxes to zooplankton c 6 c 7 c 8 parameters govern the ingestion rate 28 33 the dependence on prey concentration 34 36 the efficiency according to the type of prey 37 43 and the fraction actually used for growth 55 59 mortality red of living species including a parameterization of predation by higher trophic levels in table b 8 this corresponds to all fluxes from phytoplankton or zooplankton or bacteria c 3 to c 9 to particulate organic matter c 11 or c 12 parameters govern mortality rates 44 50 and predation 51 53 exudation magenta by phytoplankton in table b 8 this corresponds to all fluxes from phytoplankton c 3 c 4 c 5 to dissolved organic nitrogen c 10 parameters are exudation rates 25 27 excretion pink by zooplankton and bacteria in table b 8 this corresponds to all fluxes from zooplankton or bacteria c 6 to c 9 to ammonium and dissolved organic nitrogen c 2 and c 10 parameters govern excretion rates 60 63 the dependence on temperature 64 67 the tradeoff between ammonium and dissolved organic matter 68 and the excreted fraction of predation 54 growth of bacteria yellow from ammonium and dissolved organic matter in table b 8 this corresponds to all fluxes to bacteria c 9 parameters govern the growth rate 23 24 decomposition of particulate organic matter orange in table b 8 this corresponds to all fluxes from particulate organic matter c 11 or c 12 to dissolved organic nitrogen c 10 parameters are decomposition rates 69 70 nitrification brown in table b 8 this corresponds to the flux from ammonium c 2 to nitrate c 1 the parameter is the nitrification rate 72 table b 8 biogeochemical fluxes from variable c i line i to variable c j column j numbers in the boxes refer to parameter indices given in table c 9 table b 8 appendix c model parameters this table describes the different probability distributions chosen for input parameters table c 9 model parameters x i units are time t in days concentration c in mmoln m3 irradiance i in w m2 and velocity v in m day the notation γ means that the parameter is negative and that its opposite follows a γ distribution table c 9 
24028,this paper introduces the sobol indices approach for global sensitivity analysis sa in the context of marine biogeochemistry such an approach is particularly well suited for ocean biogeochemical models which make use of numerous parameters within large sets of differential equations with complex dependencies this sa allows for a detailed study of the relative influence of a large number of input parameters on output quantities of interest to be chosen it is able to distinguish between direct effects of these parameters and effects due to interaction between two or more parameters although demanding in terms of computation such a tool is now becoming affordable thanks to the development of distributed computing environments an applicative example is presented with the modecogel biogeochemical model and illustrates the advantages of this approach over standard local sa keywords sensitivity analysis sobol indices marine biogeochemistry 1 institute of engineering univ grenoble alpes 1 introduction marine biogeochemical models are now commonly included as modules in complex ocean circulation modeling systems they are thus increasingly used for many applications however the use of these models raises difficult questions especially regarding their tuning they are generally systems of nonlinear ordinary differential equations with each equation expressing the time evolution of a given state variable due to hydrodynamical effects transport and diffusion and to fluxes between the various components of the ecosystem two features of these models are noteworthy first the evaluation of the fluxes involves a wide variety of processes and hence numerous parameters typically several times more than the number of variables secondly the values of these parameters are often quite poorly known in reality the values of the parameters depend on the physical and biogeochemical context while in practice the available reference values were usually estimated only in a particular situation e g during a field experiment or in laboratory experiments not in the actual context of interest the uncertainty of these values is thus generally quite large see for example schartau et al 2017 for a review on the identification of such parameters in this context sensitivity analysis sa i e methods that aim to quantify the relative influence of the inputs on some given outputs in a complex system like a numerical model are a valuable tool indeed they can help better understand the model itself and identify which parameters are most influential and should be calibrated carefully these methods may be divided in two main categories local sensitivity methods that consider the behavior of the solution with respect to small parameter variations and global sensitivity methods that determine the behavior of the solution under parameter perturbations of arbitrary magnitude a common approach is to conduct a few experiments in which the values of parameters vary either one at a time oat or simultaneously e g baklouti et al 2006 druon and le fèvre 1999 kriest et al 2012 some additional techniques are also sometimes used such as linear error propagation omlin et al 2001 or the gaussian emulation machine approach scott et al 2011 which clearly involve global sensitivity analysis another approach defines the sensitivity of the output with regard to the input as the corresponding gradient both input and output variables must of course be continuous real valued quantities this so called gradient based sa thus requires computing gradients this is straightforward for simple cases but challenging in general for instance the gradient of a single output quantity q with regard to a constant parameter p can be approximated by q p α q p α where p is the current value of p and α is taken to be small the computation of this approximate gradient simply requires running the model twice using successively p and p α for parameter p however estimating the gradient can be much more difficult if p is multivariate or non constant e g if p is a space and or time dependent coefficient in such cases the preceding approach of computing growth rates requires n 1 evaluations of the model where n is the dimension of p e g the number of space time grid points if n is large an alternative to computing growth rates is to use the so called adjoint method which provides the exact gradient this approach was used for instance in fennel et al 2001 faugeras et al 2003 and tjiputra et al 2007 however the gradient is computed it is important to understand that gradient based sa is a local method in the sense that the gradient is a local notion computed in the vicinity of the current value of p therefore this gradient which is a way to quantify the influence of p on q can be quite different depending on the value of p chosen this limitation can be avoided by using an approach based on a global sensitivity measure i e an approach that quantifies the influence of p on q taking into account the possible variation of p such a quantification is provided for example by sobol indices which will be introduced in the next section given their global character computing such indices may of course require a huge number of model evaluations which increases with the input space dimension therefore it is usual to first carry out as a preliminary step a screening analysis such as the oat screening approach introduced in morris 1991 a screening procedure aims at fixing the input parameters whose influence on the output is qualified as negligible after a rough exploration of the input parameter space it reduces the input space dimension then in a second step a monte carlo sampling based sensitivity and ranking analysis is run see e g sankar et al 2018 or sobol indices are computed see e g morris et al 2014 wang et al 2018 however given the increases in computational resources we think that performing a direct global sa is now feasible even for a high dimensional input space and that it is time for the scientific community to make computation of sobol indices the first choice particularly when dealing with highly parameterized models in this context the aim of this paper is to introduce the sobol indices approach for global sensitivity analysis and to illustrate its feasibility and its scientific relevance in the context of marine biogeochemistry note however that our focus is to present the methodological tools in the context of a particular example rather than to conduct an in depth physical analysis first the global sa approach and the sobol indices are introduced in section 2 then in section 3 we present the biogeochemical model its many uncertain parameters and the selected output quantities section 4 is devoted to implementation aspects of the sa and section 5 focuses on results that help illustrate the features of this method in particular a comparison with a gradient based local analysis is presented 2 global sensitivity analysis the framework as indicated above the aim of sensitivity analysis is to determine which model inputs are the most influential on some given model outputs in the following a model output y is considered to be a deterministic scalar function of some model inputs x x 1 x d where these inputs belong to a domain δ y y x y x 1 x d with x δ in section 3 we consider various scalar outputs corresponding to different quantities of interest in this paper we adopt the stochastic framework of global sensitivity analysis unlike local sensitivity analysis which analyzes how a small perturbation near an input space value x 0 x 1 0 x d 0 influences the value of the scalar output global sensitivity analysis considers the whole variation range in the input space more precisely each input parameter is considered to be a random variable x j j 1 d where its uncertainty is modeled by some one dimensional probability distribution the output y is then assumed to be a scalar random variable y f x where x x 1 x d with the x i assumed to be independent various sensitivity measures have been proposed in the global framework we focus in this paper on variance based sensitivity measures introduced in sobol 1993 2 1 variance based sensitivity measures in order to quantify the influence of the variations of x j on the variations of y let us consider the conditional expectation e y x j x j it corresponds to the mean value of y over the probability distributions of the x k k j when x j is fixed to x j the corresponding random variable when considering the variations of x j is e y x j and its variance quantifies the influence of x j on the dispersion of y the so called sobol sensitivity indices are obtained by normalizing this variance by the total variance of the output y which is assumed to be finite and non null thus the first order sobol sensitivity index of input parameter x j is defined as 1 s j var e y x j var y it belongs to the interval 0 1 2 2 the sobol decomposition more generally starting from the functional analysis of variance anova decomposition efron and stein 1981 hoeffding 1948 owen 1992 sobol 1993 one can define sensitivity indices of any order r 1 d let us first introduce some notation we assume that f is a real square integrable function u is a subset of 1 d u c stands for its complement its cardinality is denoted by r u and x u represents the random vector with components x j j u the functional anova decomposition then states that y f x can be uniquely decomposed into summands of increasing size 2 y f x u 1 d f u x u where f e y and the other components have zero mean value and are mutually uncorrelated this decomposition eq 2 yields a corresponding decomposition of the variance of the output 3 var y u 1 d u var f u x u for any j 1 d the term var f j x j corresponds to the part of the output variance explained by parameter x j for any j j 1 d j j the term var f j j x j x j corresponds to the part of the output variance explained by combined effects of parameters x j and x j more generally for any u 1 d the term var f u x u corresponds to the part of the output variance explained by combined effects of parameters x j j u then for any u 1 d the sobol index sobol 1993 of order r u associated to the vector x u is defined as 4 s u σ u 2 σ 2 var f u x u var y the main effect of the j th factor is thus measured by s j then the effect due to the specific interaction between the j th and k th factors k j is measured by s j k and so on for higher order indices saltelli et al 2000 corresponding cumulative effects are defined by so called closed sobol indices defined as 5 s u closed v u s v we thus have for instance s j k closed s j s k s j k which means that the closed second order index s j k closed measures the effect of the interactions between parameters x j and x k in addition to the main effect of each of these two parameters for any j 1 d we also define a total sensitivity index s j tot homma and saltelli 1996 to express the overall sensitivity to an input x j as 6 s j tot v 1 d with j v s v we have then for instance in the case where d 3 s 1 tot s 1 s 1 2 s 1 3 s 1 2 3 2 3 estimating the sobol indices for simple models sensitivity analysis can sometimes be done analytically by direct examination of their mathematical expression however this is of course generally not the case for complex models in those cases one evaluates the model for selected values of the input parameters and the resulting output values are used to estimate sensitivity indices of interest for interested readers monte carlo based procedures for the estimation of sobol indices are described in detail in appendix a let us summarize the different strategies we apply in section 5 in section 5 1 we apply the replication procedure introduced in mara and rakoto joseph 2008 and further studied in tissot and prieur 2015 to estimate all first order sobol indices with only two replicated d dimensional latin hypercube samples of size n that is with only 2n model evaluations in section 5 2 we apply the replication procedure introduced in tissot and prieur 2015 to estimate all closed second order sobol indices with only two replicated d dimensional randomized orthogonal arrays of strength 2 and size n that is again with only 2n model evaluations due to constraints in the construction of orthogonal arrays of strength 2 n must be chosen as q 2 with q a prime number greater than or equal to d 1 in section 5 3 we apply the procedure introduced in saltelli 2002 theorem 1 to estimate all first order and total sobol indices with a cost of only d 2 n model evaluations this procedure is based on combinatorial arguments these procedures are implemented in the functions sobolroalhs sobolsalt of the package sensitivity all these strategies are detailed in appendix a a crucial point in the above summary is that the cost in terms of number of model evaluations required to estimate total sobol indices is only linear in the input space dimension d in the following see section 4 we present an implementation using a grid computing environment however even in such a framework the estimation of total sobol indices be expensive if d is large thus depending on the computational resources of the study one could avoid the estimation of these total indices and focus instead on the estimation of all first order and closed second order sobol indices as a first step in the sensitivity analysis 3 description of the ocean biogeochemical model the sa approach is applied to the 1d biogeochemical modecogel model of the ocean mixed layer described in section 3 1 the uncertain input parameters of the model vector x in section 2 are described in section 3 2 and several output quantities y in section 2 are listed in section 3 3 corresponding to key model results whose sensitivity to the input parameters is not obvious 3 1 the modecogel model the model used in this paper is modecogel 1 1 modecogel modèle d ecosystème du gher geohydrodynamics and environment research et du lov laboratoire d océanographie de villefranche sur mer it was developed for investigating the biogeochemical activity in the ligurian sea by lacroix 1998 by coupling a 1d hydrodynamic model of the mixed layer to a 12 component ecosystem model the hydrodynamic model is a 1d version of the gher primitive equations model nihoul and djenidi 1987 the state variables are the horizontal velocity the potential temperature the salinity and the turbulent kinetic energy a full description of the model can be found in lacroix and nival 1998 or lacroix and grégoire 2002 where it is applied to simulate the behavior of the system during the frontal oceanographic campaigns from 1984 to 1988 in the present paper the model is applied to years 2006 2007 and the atmospheric dataset is extracted mainly from the côte d azur meteorological buoy located at the dyfamed station boussole project at hourly frequency marty and chiavérini 2010 the ecosystem model provides a 12 component description of the ecosystem of the ligurian sea see state variables in table 1 a detailed description of this model can be found in lacroix and grégoire 2002 the time evolution of each state variable is governed by the equation 7 c i t adv i diff i sms i with sms i j i flux c j c i where adv i and diff i are advection and diffusion terms governed by the hydrodynamic model and sms i is the source minus sink term summing up the fluxes flux c j c i between the various components of the ecosystem conservation of course imposes that flux c j c i flux c i c j these fluxes can be sorted into several categories primary production secondary production mortality exudation excretion growth of bacteria decomposition of particulate organic matter and nitrification we refer to appendix b for a detailed description of these different processes eq 7 is solved numerically between the sea surface and 405 m depth using a constant vertical discretization 1 m and a constant time step 6 min outputs are saved daily at all depths it is important to note that the mathematical expression of these flux terms contains numerous parameters whose values are not known precisely in the following consistent with the objective of this study we provide only a brief overview of these model parameters with a specific focus on the assumptions that we make regarding their respective uncertainties 3 2 model parameters the biogeochemical fluxes c j c i parameterized in modecogel are summarized in table b 8 appendix b each flux depends on several of the parameters listed in table c 9 appendix c moreover the parameterization of each process as a joint function of the model state and parameters is often complex and nonlinear as a result it is usually impossible for the user to know the sensitivity of the whole system to the parameters a systematic computational approach is thus needed to apply the sa method described in section 2 a probability distribution must be specified for each input parameter this has been done here using the following guidelines in the absence of any reliable information about possible correlations the uncertainties of the various parameters are assumed independent most parameters are constrained to be either positive or negative for consistency with the formulations used to parameterize the processes they are assumed to follow a gamma distribution parameters constrained between 0 and 1 are assumed to follow a beta distribution some parameters are constrained to be larger than 1 their logarithm is assumed to follow a gamma distribution some parameters are not constrained and are assumed to follow a gaussian distribution three different values for standard deviations are used 5 20 50 of the expected value according to the confidence we have in the parameters these values were provided by biogeochemical modelers using a priori knowledge the resulting probability distributions are given in table c 9 appendix c 3 3 quantities of interest the quantities of interest qoi i e the output values y must be defined according to the main scientific objectives of the sensitivity study in the present case for this example we have chosen to focus on characterizing the simulation of phytoplankton concentrations c 3 c 4 and c 5 in table 1 which is at the base of the marine food web as an additional quantity we also introduce chlorophyll concentration noted c 0 which is what is observed by ocean color data and which can be approximately computed from phytoplankton concentrations using a constant chlorophyll to nitrogen ratio α 8 c 0 α c 3 c 4 c 5 since sensitivity analysis applies to scalar output quantities to apply the sa method we need to reduce the time and space variations of c 0 c 3 c 4 and c 5 to some scalar indicators note that the cost of the method is almost independent of the number of these indicators however they must be defined before running the sensitivity study to illustrate the method we thus decided to introduce a range of different qoi characterizing c 0 c 3 c 4 and c 5 without limiting our choice to simple linear diagnostics table 2 summarizes the qoi y ij that we will use in our application the second index j corresponds to the computed diagnostic while the first index i corresponds to the concentration i 0 3 4 5 to which it is applied this set of five diagnostics is meant to characterize i the maximum intensity of the phytoplankton spring bloom at the surface and as a vertical average ii the time at which it occurs and iii the overall average over the whole simulation 4 practical aspects of the sensitivity analysis in this section we provide more details about the numerical implementation of the sensitivity analysis i e the computation of estimates of all first closed second order and total sobol indices 4 1 grid computing environment in most cases the primary cost of the global sensitivity analysis is due to the need for numerous evaluations of the model in our study each model evaluation is short approximately 50 s however 2n evaluations are required to estimate all first order or all closed second order sobol indices and d 2 n evaluations are required to estimate all total sobol indices where n is typically of order 103 106 furthermore we must manage the model s input and output files this problem thus requires specific tools to automatically organize data management and access to computational resources note also that since we have to perform a very large number of model runs our computing environment must include fault tolerance a grid computing environment i e a distributed architecture of computers linked by communication networks and managed by middleware software is particularly well suited for this kind of application in which multiple parallel computations take place independently without the need to communicate intermediate results between processors in our implementation we used computing resources at the university of grenoble 2 2 seehttps ciment ujf grenoble fr wiki pub index php distributed on three sites 10 clusters 6600 cpu cores and 176 gpu cores these resources are connected by a local grid 3 3 https ciment ujf grenoble fr wiki pub index php grid computing associated with several storage nodes distributed among the three sites as close as possible to each supercomputer and managed by the middleware irods 4 4 seeirods org each cluster uses the local resource manager oar 5 5 seeoar imag fr and accesses the full 6600 cpu cores through the middleware cigri 6 6 http ciment ujf grenoble fr cigri dokuwiki doku php which launches embarrassingly parallel jobs on idle processors cigri is able to manage job failures in a smart way which allows the user to submit many small jobs as a final step we also need to transfer many input and result files distributed over different irods resources on a laptop or a computer server of a laboratory this is achieved efficiently using a python script 4 2 implementation of our study as indicated above the modecogel model presented in section 3 includes 74 uncertain input parameters each with an associated probability distribution see table c 9 the global sensitivity analysis is done with the r package sensitivity pujol et al 2017 r 7 7 http cran r project org is a free software environment for statistical computing and graphics the design of the experiments doe and the estimation of the sobol indices and their associated confidence intervals use the functions sobolroalhs and sobolsalt function sobolroalhs which estimates all first order and all closed second order indices is based on the replication procedure briefly described in section 2 3 and detailed in appendix a it makes use of four replicated designs of size n two for first order indices and two for closed second order indices the grid deployment used for the estimation of all first order sobol indices is done as follows see also fig 1 construct two replicated latin hypercube samplings lhs of size n with the sobolroalhs function evaluate the model on the doe in order to minimize the overhead corresponding to the submission of each evaluation and to optimize the use of the best effort mode of the batch manager the model runs are performed one hundred at a time each group of simulations corresponds to 100 different sets of the 74 input parameters and requires an average cpu time of 84 min and a small input and output files of approximately 200 ko for n 106 we thus submitted 20 000 jobs on the computing grid merge the 2n files containing the evaluations of the quantities of interest on the doe treat outliers a small percentage of the model evaluations fail or lead to completely spurious results due to unrealistic combinations of the input parameters the quantities of interest are then set to nan and will be treated as missing values in the computation of sobol indices compute sobol indices using the function sobolroalhs note that the experimental designs and the functions used to compute sobol indices differ for the estimations of closed second order and total indices as detailed in section 2 3 5 results we focus here on the quantities of interest qoi which are summarized in table 3 and described in section 3 once again our aim with this global sensitivity analysis of the modecogel model is not to perform an in depth biogeochemical analysis of the results this is outside the scope of this study but rather to show how these statistical tools provide a better understanding of complex systems involving many parameters 5 1 first order indices the 74 first order sobol indices were estimated for each qoi for different values of the sample size n 103 104 105 and 106 for each index and each value of n both its estimate and a 95 confidence interval are provided these results are plotted on fig 2 for output y 01 namely the maximum surface chlorophyll concentration as expected the size of the 95 confidence interval decreases to zero as n increases and n 106 seems to be a sufficiently large sample size to get accurate estimates size of the 95 confidence interval smaller than 0 01 0 01 which allows a clear ranking of the largest indices only ten parameters have a first order index greater than 0 01 0 01 their values are reported in table 4 quite similar results are actually obtained for the other qois and it appears that only 15 or 9 model parameters have a first order sobol index greater than 0 01 for at least 1 or 6 qois respectively the threshold 0 01 was chosen to guarantee a clear separation between inputs with high and low first order indices this is summarized in fig 3 where these most influential model parameters are clearly visible this mostly highlights the important sensitivity of our qois to the parameterization of excretion for bacteria of grazing and ingestion for mesozooplankton and of the variation of light limitation for phytoplankton this small number of influential parameters may indicate that an efficient reduction of this model could be performed to produce a reduced order model involving many fewer parameters note however that the sum of first order indices is equal to 0 371 this is far less than 1 which clearly indicates that the outputs considered are not simple additive models of the form y f 1 x 1 f d x d there are some interaction effects of the parameters on the qois which motivates the investigation of second order interaction effects 5 2 second order indices as indicated before the sobolroalhs function allows the estimation of closed second order indices at a cost of 2n model evaluations let us recall that the closed second order index corresponding to the j th and k th parameters is defined as 9 s j k closed s j s k s j k and corresponds to the sum of the main and interaction effects due to these two parameters a specificity for the estimation of closed second order indices with the replication procedure is that n has to be chosen equal to q 2 where q d 1 is a prime number denoting the number of levels of the orthogonal array see appendix a for more details a value of q 227 i e 2n 103 058 was necessary to achieve sufficiently accurate estimates of the indices estimates of the d d 1 2 2701 closed second order indices along with their corresponding 95 bootstrap confidence intervals were then computed for each qoi they are displayed in fig 4 for the output y 01 annual maximum of chlorophyll concentration which was already chosen in fig 2 and table 4 it clearly appears that very few of these 2701 indices are significant given the definition eq 9 of the s j k closed most of them obviously correspond to at least one influential parameter listed in table 4 as clearly displayed in fig 5 a using these closed second order index estimates and the previous estimates of first order index we compute consistent estimates of unclosed second order sobol indices s j k with a bootstrap algorithm these indices quantify the fraction of variance of the qoi due to these two parameters that cannot be explained by the sum of the main effect of x i and x j but only by their interaction they are displayed in fig 5b in the particular case of output y 01 new interesting information arises from this plot first it appears that input parameters with strong direct influence i e strong first order indices may or may not have significant interactions with other parameters for instance parameters 36 and 57 see table c 9 related to semi saturation for ingestion by mesz and fraction of grazing used for growth of mesz have weak second order indices conversely parameters 15 and 18 related to variation of light limitation for nanp and to optimal temperature for nanp which already correspond to large first order indices have also strong interactions with many other parameters see fig 6 a secondly some other parameters that have not been noticed yet since they have weak first order indices show strong interactions with numerous other parameters let us mention in particular parameters 8 and 12 related to nh4 semi saturation for picp and to optimal par for nanp see fig 6b these results are summarized in fig 6 recall that the value 0 01 for the threshold in fig 6 was chosen to guarantee a clear separation between inputs with high and small first order indices at this stage the information from the first and second order indices remains incomplete higher order interactions can be expected especially for highly parameterized models like marine biogeochemistry a natural step forward in the study is then to compute total indices 5 3 total order indices the total sobol index s j tot j 1 d defined in eq 6 expresses the overall sensitivity of some qoi to the input x j as mentioned in section 2 and appendix a a competitive procedure to estimate simultaneously all first and total sobol indices was introduced in saltelli 2002 and implemented by the function sobolsalt of the r package sensitivity its cost is however still quite high since it requires d 2 n model evaluations however this linear computational complexity with regard to the input space dimension d cannot be avoided therefore depending on the computational resources available for the study computing such indices is not always affordable although they bring important information since input parameters with a very low value for their total sobol index can be fixed to a nominal value in a calibration procedure a scatter plot of first order and total indices is displayed in fig 7 we observe that the parameters contribute to the total variance primarily through their interactions with other parameters the dots are far above the line y x however the relation between first order and total indices is not linear more precisely parameters having a large main effect generally also contribute to the total variance through their interactions with other parameters fig 8 a nevertheless the relative importance of these interactions may vary significantly for instance parameter 67 temperature variation of excretion for bacteria which corresponds to the largest first order index has a total index smaller than several other parameters with much smaller first order indices on the other hand some parameters with a very small main effect make a non negligible contribution to the total variance via their interactions with other parameters fig 8b this heterogeneous distribution of the relative importance of the first order effect with regard to the total effect is summarized in fig 9 where the ratio s j s j tot is displayed 5 4 comparison with a local analysis the majority of previous sensitivity analyses performed on ocean biogeochemistry models have used local methods such as the gradient method or methods where parameters are varied one at a time it is therefore interesting to compare the results we have just obtained using the global sobol indices method with equivalent results obtained using local methods applied to the same modecogel model we have thus computed the gradients of our qoi with regard to the 74 input parameters the partial derivatives are approximated by 10 y x j x 1 x d y x 1 x j 1 x j α x j 1 x d y x 1 x d α where α is a small value ensuring very good accuracy of the estimate in our case we checked that any value of α between 1 0 3 var x j and 1 0 6 var x j is relevant and leads to the same value for the gradient d 1 i e 75 in our case model runs are required the local character of this gradient appears clearly in eq 10 the gradient is computed for a particular value x 1 x d x 1 x d in our case we choose to compute it for the mean values of the 74 parameters listed in table c 9 i e for x 1 x d e x 1 e x d as can be seen in fig 10 a and in table 5 according to this gradient the two parameters 67 and 66 temperature variation of excretion for bacteria and mesozooplankton respectively have a very strong impact on y 01 the importance of parameter 67 was already noted previously since it corresponds to the largest first order sobol index and to one of the largest total indices however parameter 66 does not appear as one of the most influential parameters from the global sa its ranking is just 12th among first order indices and 73rd of 74 considering total indices conversely several parameters that were clearly highlighted by the global sa do not correspond to large values of the derivative this is the case for instance for parameter 14 variation of light limitation for picophytoplankton its ranking is 3rd considering total indices and 7th considering first order indices but only 21st considering derivatives similar remarks can be made for parameters 30 36 and 57 see table 6 in the same way the local analysis indicates that parameters 15 and 18 variation of light limitation and optimal temperature for nanophytoplankton are ten times less important than parameters 66 and 67 in contrast the total sobol indices show that they are actually more important table 5 in summary the local analysis identifies parameters 66 and 67 as important and only to a much lesser extent a few others however the comparison with sobol indices clearly shows that this is only local information relying only on this local information would lead us to waste effort tuning some parameters and to neglect entirely other important ones a complementary way to look at this local gradient is to compute s j loc var x j var y y x j 2 this local index is non dimensional it can be interpreted as a relative gradient since it could also be written as y x j 2 where y y var y and x j x j var x j are normalized versions of y and x j its interest for our study lies in the fact that in the case of a linear dependency y a 0 a 1 x 1 a d x d and of the independence of input parameters this index is equal to the first order sobol index as can be seen in fig 10b this index indicates that the most and almost only influential parameter is parameter 66 and to a much lesser extent parameter 67 as noted previously this result is contradicted by the global sa this disagreement is a clear illustration of the strongly nonlinear character of the modecogel model 5 5 computational costs the relative computational costs of the different algorithms are displayed in table 7 along with the estimated error related to the sobol indices i e the half length of the 95 bootstrap confidence interval as mentioned earlier the computation of total indices requires a number of model runs proportional to d 2 which is much more than for the evaluation of only first and second order indices moreover the estimation error is inversely proportional to n as is mainly the case in monte carlo methods consistent with the rate of convergence in the central limit theorem note that other designs of experiments such as quasi monte carlo methods are not considered in this paper since we do not assume any mathematical regularity in the underlying model in the present case given the order of magnitude of the indices n 105 appears to be a good compromise between accuracy and computational cost 6 conclusion the added value of sa is primarily to help scientists understanding the behavior of their models and identifying their most influential parameters then as a by product in the context of model tuning it helps focusing optimization effort on these few parameters see for instance the two review papers by oschlies 2006 and dowd et al 2014 and references herein on data assimilation in the context of ocean biogeochemical models in the present work a global sensitivity analysis based on sobol indices is presented in the context of a realistic ocean biogeochemical model without delving into complex physical interpretations the aim of this study is to demonstrate the potential interest of this systematic and mathematically sound approach for such applications this method quantifies the influence of uncertain input parameters on an arbitrary number of output quantities of interest either through their direct effect or through their mutual interactions in the present study which was performed with a full monte carlo method thus avoiding any restrictive hypothesis on the effective dimension of the model or on its regularity we started by computing first and second order indices this highlighted on the one hand the strong influence of some input parameters and of some second order interactions and on the other that some higher order interactions were probably significant total sobol indices were thus computed which provided complementary information note that total indices can also be a helpful source of information for constructing reduced models since they identify parameters whose values could be frozen these results were then compared to those derived using a local oat gradient based sa where each parameter was varied individually around a point in parameter space corresponding to the average it clearly illustrated the fact that a local sa can lead us to focus our attention on non globally relevant parameters and to neglect the influence of globally important ones this comparison also brought out the strongly nonlinear character of the biogeochemical model considered here more generally from a biogeochemical point of view the methods described in this paper can provide a substantial help in the design of the models in the tuning of their complexity and in the understanding of their dependence to uncertainties in the parameters it was shown indeed in our test application that the traditional sensitivity studies based on local methods can lead to misleading conclusions and thus to a misunderstanding of the influence of every individual process on the key results of the simulations accounting for the nonlinear effects and for the interactions between the various processes is needed to decide what must be explicitly resolved by the model and carefully tuned and what can be roughly parameterized until recently this ambition was very difficult to achieve the take home message for further ocean biogeochemical research is that due to the constant increase of computational resources combined with recent advances in estimation procedures for the sensitivity measures it is now possible to perform a global sensitivity analysis based on the computation of sobol indices large sets of input parameters can be considered and indices as expensive as total indices can be feasibly computed by taking advantage of grid computing environments which scale easily to high dimensional applications appendix a estimation procedure for sobol indices in this paper we used a monte carlo based procedure for the estimation of sobol indices sobol 1993 which we describe in detail below let us first introduce some notation let u be a non empty subset of 1 d let x 1 x 1 1 x d 1 and x 2 x 1 2 x d 2 be two independent copies of the input vector x x 1 x d let x 1 i i 1 n be an independent and identically distributed i i d sample of size n of vector x 1 and x 2 i i 1 n be an i i d sample of size n of vector x 2 for any u 1 d we define the d dimensional vector x u x u 1 x u d in the following way for any j u x u j is equal to x j 1 and for any j u c x u j x j 2 the n sample x u i i 1 n is defined in a similar manner and we define the corresponding output variables a 1 y f x 1 y u f x u and y i f x 1 i y u i f x u i it is possible to prove that s u closed cov y y u var y see e g lemma 1 2 in janon et al 2014 based on the above formula we propose the following estimator for s u closed a 2 s closed u n 1 n i 1 n y i y u i 1 n i 1 n y i y u i 2 2 1 n i 1 n y i 2 y u i 2 2 1 n i 1 n y i y u i 2 2 this estimator was first introduced in monod et al 2006 its asymptotic properties are stated in janon et al 2014 propositions 2 2 and 2 5 see also gamboa et al 2016 for further asymptotic and non asymptotic results since s j s j closed see eq 5 we therefore estimate s j with s j n s j n closed recall now the law of total variance which can be found e g in weiss 2006 pages 385 386 a 3 var y var e y x u e var y x u from the definition of total sobol indices we can prove that a 4 s j tot e var y x j c var y from eqs a 3 and a 4 we deduce s j tot 1 s j c closed we thus define the estimator of s j tot as s j n tot 1 s j c n closed these estimators require a large number of model evaluations indeed the estimation of all first order indices actually requires d 1 n evaluations of the model y i y j i i 1 n j 1 d the estimation of all closed second order indices requires d d 1 2 1 n model evaluations of the model y i y j k i i 1 n j k 1 d the monte carlo sample size n is directly related to the accuracy of the estimation via the rate of convergence in the central limit theorem which is of order n see proposition 2 2 in janon et al 2014 to circumvent this linear or quadratic dependence of the cost in terms of number of model evaluations in the input space dimension d the authors in tissot and prieur 2015 proposed a procedure based on replicated latin hypercube sampling lhs e g lemieux 2009 or replicated randomized orthogonal arrays to estimate all first order or all closed second order sobol indices respectively the ideas in tissot and prieur 2015 generalize some pioneer work in mara and rakoto joseph 2008 we refer to tissot and prieur 2015 for a detailed description of the procedure and a rigorous analysis of its asymptotic properties in the present paper we applied the replication procedure to estimate all first order sobol indices in section 5 1 and to estimate all closed second order sobol indices in section 5 2 more precisely the replication procedure in section 5 1 allows us to estimate all the first order sobol indices with only two replicated d dimensional lhs of size n that is with only 2n model evaluations the replication procedure in section 5 2 allows to estimate all closed second order sobol indices with only two replicated d dimensional randomized orthogonal arrays of strength two and size n that is with only 2n model evaluations due to constraints in the construction of orthogonal arrays of strength two n must be chosen as q 2 with q a prime number greater or equal to d 1 note that orthogonal arrays were introduced for the first time in kishen 1942 if higher order interactions are expected in the model of any order greater or equal to three one may be interested in estimating total sobol indices the replication procedure does not adapt to the estimation of total sobol indices mainly because of the constraints in the construction of orthogonal arrays of strength higher or equal to three in saltelli 2002 the authors propose two different procedures both based on combinatorial tricks the first one allows the estimation of all first order and total sobol indices with a cost of d 2 n model evaluations see theorem 1 in saltelli 2002 the second one leads to a double estimate of all first order closed second order and total sobol indices at a cost of 2d 2 n model evaluations see theorem 2 in saltelli 2002 to our knowledge the procedure in saltelli 2002 theorem 1 is the most competitive one if the estimation of total sobol indices is involved see also gilquin et al 2017 it is the one we have applied in section 5 3 appendix b description of biogeochemical fluxes the biogeochemical fluxes c j c i parameterized in modecogel are summarized in table b 8 each flux depends on several parameters which are indicated by referring to the parameter list in table c 9 in appendix c to give an idea of the role of each parameter in modecogel the biogeochemical fluxes are organized into several categories using different colors primary production green is the growth of phytoplankton by photosynthesis in table b 8 this corresponds to all fluxes from nutrients c 1 c 2 to phytoplankton c 3 c 4 c 5 parameters govern the maximum growth rate 1 3 and the dependence on nutrient concentrations 4 10 to solar irradiance 11 16 and to temperature 18 20 secondary production blue is the growth of zooplankton by grazing of phytoplankton or by assimilation of bacteria and particulate organic matters in table b 8 this corresponds to all fluxes to zooplankton c 6 c 7 c 8 parameters govern the ingestion rate 28 33 the dependence on prey concentration 34 36 the efficiency according to the type of prey 37 43 and the fraction actually used for growth 55 59 mortality red of living species including a parameterization of predation by higher trophic levels in table b 8 this corresponds to all fluxes from phytoplankton or zooplankton or bacteria c 3 to c 9 to particulate organic matter c 11 or c 12 parameters govern mortality rates 44 50 and predation 51 53 exudation magenta by phytoplankton in table b 8 this corresponds to all fluxes from phytoplankton c 3 c 4 c 5 to dissolved organic nitrogen c 10 parameters are exudation rates 25 27 excretion pink by zooplankton and bacteria in table b 8 this corresponds to all fluxes from zooplankton or bacteria c 6 to c 9 to ammonium and dissolved organic nitrogen c 2 and c 10 parameters govern excretion rates 60 63 the dependence on temperature 64 67 the tradeoff between ammonium and dissolved organic matter 68 and the excreted fraction of predation 54 growth of bacteria yellow from ammonium and dissolved organic matter in table b 8 this corresponds to all fluxes to bacteria c 9 parameters govern the growth rate 23 24 decomposition of particulate organic matter orange in table b 8 this corresponds to all fluxes from particulate organic matter c 11 or c 12 to dissolved organic nitrogen c 10 parameters are decomposition rates 69 70 nitrification brown in table b 8 this corresponds to the flux from ammonium c 2 to nitrate c 1 the parameter is the nitrification rate 72 table b 8 biogeochemical fluxes from variable c i line i to variable c j column j numbers in the boxes refer to parameter indices given in table c 9 table b 8 appendix c model parameters this table describes the different probability distributions chosen for input parameters table c 9 model parameters x i units are time t in days concentration c in mmoln m3 irradiance i in w m2 and velocity v in m day the notation γ means that the parameter is negative and that its opposite follows a γ distribution table c 9 
24029,eddies caused by island wakes often appear downstream of an island where upwelling currents are coupled with nutrient transport several island wake eddies downstream of the yongle atoll ya huaguang reef hr and yuzhuo reef yr in the xisha archipelago xa are found based on sar and gf 1 satellite images taken on april 14 2009 and may 30 2014 respectively the present study aims to explore the features and mechanisms of spring island wakes based on a high resolution numerical model as well as satellite data our results are 1 the cyclonic wake eddies cwes are surface intensified and introduce a 20 40 m uplift of the isopycnal for the most intense eddies while the anticyclonic wake eddies awes reach a subsurface maximum at a depth of 25 50 m which leads to the weak isopycnal downwelling the cwes are generally more abundant than the awes in different radius classes under different incoming flows which is due to the inertial centrifugal instability ici of the awes 2 in the xa lower sst features observed in the downstream side of the reefs demonstrate the presence of current induced island wakes in the near wakes of ya hr and yr the periodic vorticity generation is mainly caused by shear flow instabilities arising from the side boundaries of the reefs anticyclonic vorticity generation is slightly larger than that of the cyclonic for these three reefs 3 for the submesoscale wake dynamics the barotropic instability is more significant than the baroclinic in the xa strong toroidal vortices of alternating sign which strongly perturb the density were observed as the existence of the ici in the transects of an unstable intense awe but these could hardly be found in a weak awe the unstable awes may have a larger decay of the velocity at their eddy edges and large persistent vorticities at their cores which lead to an increase of the ratio between the core vorticity and the rossby number γ while stable awes have longer lifetimes with nearly constant γ values that are similar to those of the stable cwes keywords island wake numerical simulation sub mesoscale inertial centrifugal instability ici xisha archipelago xa 1 introduction island wakes have been observed and studied intensively for many island areas doty and oguri 1956 arístegui et al 1997 caldeira et al 2002 2005 andrade et al 2014b the island wakes affect their surrounding and downstream environments via the transport and retention of nutrients pollutants and plankton hasegawa et al 2009 they are often accompanied by higher bio productivity hasegawa et al 2008 andrade et al 2014a 2014b and closely associated with fishing activities signorini et al 1999 because of upwelling and turbulent mixing this is called the island mass effect doty and oguri 1956 satellite images have become an important data resource for studies of island wake phenomena barton et al 1998 caldeira et al 2002 caldeira et al 2005 chassignet et al 2007 zheng and zheng 2014 caldeira et al 2014 by using satellite sea surface temperature sst data barton et al 1998 identified cyclonic and anticyclonic eddies produced downstream of the gran canaria island using synthetic aperture radar sar images isoguch et al 2007 observed island wake patterns such as meandering and vortex streets in the lee of isolated islands in addition using both sar and sst images zheng and zheng 2014 analyzed the island induced vortex train generated downstream of green island in the kuroshio region satellite images provide high resolution spatial and temporal surface ocean information but they cannot yield information related to the interior of oceans or even subsurface ocean dynamics klein et al 2019 many studies have aimed to understand the physical processes that occur in the wakes of islands based on high resolution numerical simulations in particular the primitive three dimensional equation model is widely used because of the stratified character of fluid in these areas using the regional ocean modelling system dong et al 2007 studied the idealized case of a cylinder like island in a deep stratified and rotating fluid they found three types of instabilities inertial centrifugal instability ici barotropic instability bti and baroclinic instability bci which led to the generation of strong vorticity in the lee of the island furthermore stegner et al 2010 and lazar et al 2010 performed laboratory experiments and numerical simulations to study the asymmetry of island wakes in deep stratified and rotating fluids they summarized that cyclonic and anticyclonic asymmetry is due to the intrinsic dynamical properties of the flow and are mainly controlled by three dimensionless numbers the island rossby number ro i the burger number bu and the ekman number ek especially for sub mesoscale vortex wakes numerical and experimental results showed that the ici may induce a selective destabilization of anticyclonic vorticity regions kloosterziel and van heijst 1991 mutabazi et al 1992 lazar et al 2013a lazar et al 2013b kloosterziel et al 2007 teinturier et al 2010 most realistic studies use a closer representation of the oceanic bathymetry immersed in a complex representation of the ambient geophysical flows for instance high resolution numerical oceanic models with realistic topography and realistic currents wind and tidal forcing were used to study island wakes in the southern california bight scb the results showed that both current induced and wind induced island wakes exist in the scb caldeira et al 2005 and that much of the enstrophy in the scb is generated in island wakes dong and mcwilliams 2007 recently caldeira and sangrà 2012 found that the actual bathymetry may be very important for eddy generation downstream of the madeira archipelago by considering the influence of multiple islands and the role of the island shelf they found that neighboring islands play an important role in destabilizing the near field wake and that sub inertial instabilities might also act in the near field particularly around steep island shelves island wakes can be generated by both wind and currents which are called wind induced and current induced island wakes respectively caldeira et al 2005 sangrà et al 2007 jiménez et al 2008 the upwelling and mixing of deep colder water causes horizontal current shears behind an island so current induced island wakes are usually accompanied by a lower sst feature located at the downstream side of the island barton et al 2000 caldeira et al 2005 chang et al 2013 by contrast a wind induced vortex is usually coupled to a higher sst because of weaker vertical mixing due to sheltering from the wind on the lee side of a tall island arístegui et al 1994 caldeira et al 2005 the current and wind induced island wakes of a tall island often interact with each other caldeira et al 2005 sangrà et al 2007 jiménez et al 2008 for some islands such as madeira couvelard et al 2012 and hawaii xie et al 2001 jia et al 2011 wind can play an important role in the generation of island wakes the xisha archipelago xa is located in the northwest south china sea scs and is characterized by several reefs and atolls in this area images of several island wake events were captured by satellites on april 14 2009 and may 30 2014 see section 4 however few oceanographic studies have attempted to characterize the island wakes of the xa and thus in situ data related to island wakes are scarce previous studies have shown that the xa is frequently affected by mesoscale eddies i e eddies whose radii are larger than r d 50 km see appendix a nan et al 2011 hwang and chen 2000 however what about the dynamic features of the island wakes is it perhaps related to mesoscale dynamics and which instability mechanism dominates this island wake progress in order to help answer these questions a high resolution numerical simulation coupled with satellite data is needed we employed the unstructured grid finite volume community ocean model fvcom chen et al 2003 chen et al 2006 chen et al 2012 where the dynamics of the currents of the xa were simulated using relaxation nesting boundaries and surface meteorological forcing from january to june during 2009 the present study addresses the following issues in detail a the spatial structure and variability of island wakes in the spring b the mechanism of island vorticity generation and c the intrinsic dynamics of the wake instabilities the remaining sections of this paper are organized as follows in section 2 the oceanographic setting of xa are introduced while in section 3 the data and the design of the numerical simulation the analysis methods as well as the model verification are described in section 4 the three dimensional characteristics and variability of wakes eddies are presented in sections 5 and 6 the dynamic mechanisms of island vorticity generation and wake instability are analyzed and discussed respectively finally in section 7 our conclusions are summarized 2 oceanographic setting the xa is located near the northwest coast of scs see fig 1 we show the xa as the area above the xa continental shelf range from 15 75 to 17 5 n and 110 75 to 113 0 e see fig 1b the archipelago is characterized by several reefs and atolls ye et al 1985 as shown in fig 1 there are three atolls and five reefs in the xa with the huaguang reef hr as the largest one which has a maximum length of 27 3 km and its lagoon has a maximum depth of 27 m xie 1979 the second largest is yuzhuo reef yr which has a maximum length of 14 4 km the area surrounded by the xuande atoll yr and yongle atoll ya is a trough with a depth of 900 m xie 1979 scs is the largest semi enclosed marginal sea in the northwestern pacific ocean the general circulation pattern of the scs is a basin wide cyclonic gyre in winter and an anticyclonic gyre in summer which is dominated by seasonally reversing monsoons that typically blow strongly from the northeast during boreal winter and from the southwest during boreal summer dale 1956 metzger 2003 wang et al 2003 many cyclonic and anticyclonic eddies are embedded in the basin scale circulation which is characterized by a multi eddy structure nan et al 2011 the western boundary current wbc east of vietnam is energetic in summer and it divides into two branches after moving around the southeastern hainan island one branch flows northeastward over the shallower northern shelf along the east coast of hainan island while the other branch flows eastward at 18 n towards the deep basin nan et al 2011 hwang and chen 2000 the xa is located near the eastward branch where anticyclonic circulation is often generated in the summer that is driven by the southwesterly monsoon in general a northeastward current can be observed in the summer and a southwestward current in the winter near the xa area in spring the current is variable and mesoscale eddies are active in this area in 2009 a northeastward current was observed from april to september and variable currents were found in the other months according to the aviso satellite data show that the sst increased from january to july followed by a decrease from july to december with large fluctuations from late august to early september the xa is characterized by a north west south east sst gradient 3 data and methods 3 1 data sets we supplemented our observations with wake induced sea state changes detected by satellite images we used ers sar images with a resolution of 25 m obtained from the tropical and subtropical ocean viewed by ers sar http www ifm zmaw de fileadmin files ers sar sar images provide fine resolution active microwave observations of sea surface roughness which are not affected by cloud cover or the availability of light gaofen 1 gao fen high resolution gf 1 is the first of a series of high resolution optical earth observation cnsa china national space administration beijing china satellites gf 1 has a medium and high spatial resolution and a wide swath imaging capacity it employs a cast 2000 bus which is configured with two 2 m pan 8 m ms camera and a four 16 m ms medium resolution and wide field camera set more details can be found at https directory eoportal org web eoportal satellite missions g gaofen 1 for the model validation in situ data were acquired from three stations around the xa area andrade et al 2014a the xisha subsurface buoy with one upward 75 khz adcp and one downward 150 khz adcp to cover the whole water column located at 17 10 n 110 39 e see fig 1 point a it supplied time sequences of the vertical distribution of velocity from 2008 to 2011 with a sampling frequency of 1 h as the adcps located at a depth of about 500 m the data in the regions close to the surface and adcp are mostly invalid due to the echoes of sound waves being weak in these regions so only the depths of 40 200 m were selected for the validation andrade et al 2014b a tidal gauge station located at 16 84 n 112 33 e see fig 1 point b provided surface elevation time sequences from june 2007 december 2013 with a sampling frequency of 10 min and arístegui et al 1994 the xisha automatic weather station located at yongxing island observed wind dynamics from 2009 to 2011 valid data exist from september to october in 2009 with a sampling frequency of 10 min all the in situ data mentioned above were acquired from the lake watershed science data center national earth system science data sharing infrastructure national science technology infrastructure of china http lake geodata cn moreover the multi scale ultra high resolution sea surface temperature mur sst data are used in the validations the data were globally gridded at 1 km resolution by merging data from modis amsr e and avhrr an objective interpolation technique based on a wavelet decomposition chin et al 1996 was used to process each retrieval data set with respect to its inherent resolution more information can be found at http mur jpl nasa gov data descriptions may also be found at http podaac jpl nasa gov dataset jpl l4uhfnd glob mur the mesoscale eddies which affect the island wakes in the xa were also detected based on the sea surface height ssh and the geostrophic current data obtained from gridded 1 4 1 4 aviso http www aviso oceanobs com it is noteworthy that the real physical resolution of aviso can be much lower only 100 200 km reanalysis data such as the hycom current data and ncep surface forcing were used as model inputs in this study 3 2 numerical model fvcom chen et al 2003 chen et al 2006 chen et al 2012 was used to model the xa area referred to as xa fvcom in the following xa fvcom was run using the mode split solver with a default setup comprised of the modified mellor and yamada level 2 5 my 2 5 mellor 2001 mellor and blumberg 2004 mellor and yamada 1982 and smagorinsky smagorinsky 1963 turbulent closure schemes for vertical and horizontal mixing respectively the bottom stress was calculated by τ b c d ρ 0 u u where τ b is the bottom frictional stress ρ 0 is the water density and u is the current speed the term c d max κ 2 ln z ab z 0 2 0 0025 is the drag coefficient where κ 0 4 is the von karman constant z ab the height above the bottom and z 0 is the bottom roughness parameter etopo1 1 min gridded topography data supported by noaa were used see fig 1b the numerical experiments covered the period from january 1 to june 30 in 2009 three hourly hycom ncoda global reanalysis data with a horizontal resolution of 1 12 5 http hycom org data glbu0pt08 expt 19pt1 chassignet et al 2007 chassignet et al 2003 were used to drive xa fvcom through the relaxation nesting boundary as described and validated by chen et al 2012 four relaxation layers were used with linear relaxation weights of w i 1 to 0 25 from the outer to interior layers see fig 1a in the following equation v comprised the variables needed e g u v salinity and temperature in the boundary zone and their values are given as 1 v boundary i w i v nest i 1 w i v fvcom i where i is counted from the outer edge boundary the boundary nest and fvcom subscripts indicate the forcing values employed to drive the model the nested values obtained from the large domain structured grid hycom and the original values calculated from xa fvcom respectively the domain was discretized using a non overlapping triangular grid in the horizontal direction where the resolution varied from 500 m over the whole xisha continental shelf to 8 8 km at the nesting boundary layers in accordance with the global hycom grid the vertical grid discretization was implemented using a uniform σ coordinate with a total of 80 layers the average depth is around 800 m in the xa area so the vertical grid resolution is 10 m we designed such high resolution for the purpose of capturing the horizontal and vertical structure of the island wakes especially for ya hr and yr the time steps for the internal and external mode were 5 and 2 5 s respectively at the surface xa fvcom was driven by meteorological forcing wind stress net heat flux plus shortwave irradiance in the water column and evaporation precipitation at the sea surface in addition 6 hourly ncep cfsr atmospheric forcing data were used with a horizontal resolution of 0 3125 at the surface the wind imparts momentum to the water amplifies evaporation and contributes to vertical mixing and thus the accuracy of wind data is important the ncep produced wind was compared with the in situ monitoring data obtained from the xisha automatic weather station which is located on yongxing island as shown in fig 2 the ncep produced wind speeds had a similar variation to the in situ wind speeds during september 2009 xa fvcom was initialized with the t s field obtained from global hycom and spun up from zero velocity and undisturbed sea elevation 3 3 eddy detection and tracking the vector geometry based eddy detection algorithm vged nencioli et al 2010 was used to automatically identify the characteristics of the eddies eddy core sign boundary radius trace etc here a vortex is defined as a region containing velocity vectors rotating around a centre with a minimum speed the vortex core can be detected according to this definition eddy boundaries are defined as the outermost closed streamline around the centre across which velocity magnitudes are still increasing in the radial direction in other word the streamline with the maximal tangential velocity these are calculated based on the stream function after eddy boundaries are derived the radius r max of each eddy is computed as the mean distance between the centre of the eddy and all the points defining the boundaries once eddies have been detected at each time step we used the tracking method proposed by nencioli et al 2010 to track them in order to apply vged the unstructured fvcom data were first interpolated in the structured mesh grid with a resolution of 0 005 0 005 the flexibility of vged depends on two parameters a the number of grid points where the current increases and b the dimension of the area used to define the local velocity minimum these parameters set the minimum size of the detectable vortices and allow the algorithm to work with different grid resolutions using the same protocol as nencioli et al 2010 the optimal performances of the algorithm were obtained with a 4 b 3 for our model configuration in other words only eddies with radii 2 25 km can be detected 3 4 estimate of vorticity generation when the vorticity generation is dominated by the bottom stress vortices stretching above the bottom boundary layer yield the following vorticity balance dong and mcwilliams 2007 2 ζ t τ b ρ 0 h where h is the stretching layer thickness the vorticity ζ can be estimated as 3 ζ τ b ρ 0 uh where the relevant time for vorticity advection is δt l u l and u are the respective length and velocity scales associated with a high stress region in the xa however interactions among the bottom stress bottom topography and lateral stress may take place around a reef with a slope to measure the vorticity generation processes we developed an approximate vertical vorticity equation with anisotropic eddy viscosity ν e terms and a baroclinic term vallis 2017 4 ζ t h u h f ζ ν eh 2 ζ ν ev 2 ζ z 1 ρ 2 ρ x p y ρ y p x where the subscript h and v denote horizontal and vertical components respectively f is the coriolis parameter and p is the pressure in this approximation advective terms involving the vertical velocity are neglected since they would enter at o ro2 dong et al 2007 the vorticity generation rate v g of a reef was calculated by integrating eq 4 dong et al 2007 5 v g t ζdxdydz o u n f ζ dl dz v t v f ν eh o h ζ dldz v d 1 ρ 2 ρ x p y ρ y p x dxdydz v b where the right side terms are the circulation tendency v t the advective v f and eddy viscous v d fluxes across the open boundaries and the baroclinic term v b respectively the symbol o denotes a line integral along an open boundary segment in eq 4 the horizontal eddy viscous flux is split into two terms one along the open boundary v d and the other along the reefs v g according to the study of dong et al 2007 v g increases with re for small re and it converges to a value independent of the eddy viscosity for larger re 3 5 eddy kinetic energy budgets some insight into wake instability mechanisms can be gained by considering energy transfer from mean to eddy energy or eddy potential to eddy kinetic energy when the volume integrated conversion of mean kinetic energy to eddy kinetic energy k m k e is positive it implicates bti and when volume integrated conversion of eddy potential energy to eddy kinetic energy p e k e is positive it implicates bci these can be expressed as dong et al 2007 harrison and robinson 1978 6 k m k e u λ u j u λ x j 7 p e k e g ρ 0 ρ w where cartesian tensor notation with summation convention has been used in eq 6 λ 1 2 j 1 2 3 the overbar denotes the averaging operator and departure from this average is written as ϕ ϕ ϕ the term g is gravitational acceleration 3 6 detection of inertial centrifugal instabilities for inviscid and circular vortices the rayleigh criterion kloosterziel and van heijst 1991 mutabazi et al 1992 asserts that all anticyclonic eddy columns are unstable to three dimensional perturbations if somewhere in the flow the rayleigh discriminant is negative namely 8 χ r ζ r f 2 v r r f 0 where ζ r r v r v r is the relative vorticity according to this widely used criterion the stability of a circular anticyclone depends crucially on its velocity or vorticity profile the ratio between the core vorticity ζ 0 f and the ro 9 γ ζ 0 f 1 ro is very sensitive to the vortex profile γ 2 3 3 51 4 for an idealized rankine a parabolic a lamb oseen and a conical vortex respectively the ratio γ is a relevant parameter to detect the signature of an ici in a mean horizontal velocity field lazar et al 2013a lazar et al 2013b it increases with time for an unstable anticyclone and it may reach values up to five for a stable cyclone it keeps constant or slightly decreases down to three for a stratified and viscous vortex a more accurate criterion derived by lazar et al 2013a 2013b was also used see appendix b 3 7 model verification roughly 42 days after the initialization the surface kinetic energy of xa fvcom approached a steady state and started to exhibit fluctuations which suggested the spin up had completed capet et al 2008 to avoid any effects arising from the initial conditions employed in the model we only analyzed the results obtained after march 1 2009 59 days after the initialization the effectiveness of the relaxation nesting boundary in xa fvcom was important for the simulations fig 3a shows the instant surface elevation and velocities obtained by xa fvcom nested in the global hycom on april 14 2009 which shows that the surface elevation and velocities propagated smoothly from the outer boundary to the interior and thus the barotropic and baroclinic currents propagated smoothly from hycom to xa fvcom fig 3b further depicts the mean surface elevation and geostrophic currents obtained by xa fvcom from march to june it shows that the xa area was mainly struck by northeast currents which were located between the cyclonic and anticyclonic mesoscale eddies during these periods xa fvcom was then validated using the in situ and satellite data fig 4a shows that the overall trend in the surface elevations was similar to the in situ monitoring data the root mean square error rmse of the surface elevations is 0 065 m time sequences of the vertical distribution of the daily average horizontal velocity magnitudes in the upper seawater were also compared with the in situ monitoring data as shown in fig 4b the general trend of the velocity was captured by xa fvcom the velocity decreased throughout april 12 27 and may 18 june 7 which suggests that the core of the mesoscale cyclonic eddy may have affected this area and thus the direction of the velocity became complicated the thermocline structures were also validated fig 5a shows that the overall trend in the sst was simulated well compared with the mur data with the rmse 0 38 c furthermore both the mur and xa fvcom data show that the xa is characterized by a north west south east sst gradient figs 5b c the high resolution mur data reveals cold regions behind several reefs atolls ya yr and xuande atoll etc which are likely due to upwelling and mixing caused by strong current induced island wakes see fig 3b these features appear in the same locations in our numerical results the overall good agreement between the simulated results demonstrates that xa fvcom has the capacity to reconstruct the dynamics of mesoscale and sub mesoscale phenomena in the xa 4 three dimensional characteristics and variability of island wakes in spring we focused on three typical reefs ya hr and yr for the reason that andrade et al 2014a these reefs are typical in the xa area and andrade et al 2014b they have a length between 14 and 27 km which are suitable for easily forming sub mesoscale eddies in the xa the first baroclinic deformation radius r d 50 km see appendix a it is larger than most of the radii of the reefs in xa thus sub mesoscale eddies should be expected in their downstream wakes 4 1 horizontal and vertical structure of the island wakes 4 1 1 comparison between the modeled and observed wake eddies the instant horizontal distributions of the island wakes in the xa were successfully captured in the satellite images fig 6a shows a sar image taken on april 14 2009 the sea surface roughness shows that cyclonic wake eddies cwes yr 1 3 and anticyclonic wake eddy awe yr 2 alternately shed off yr the diameters of yr 2 3 are about 18 km and 15 km respectively see fig 6a they are both sub mesoscale eddies with diameters close to the maximal length of yr 14 4 km and smaller than r d along the eastern edge of hr and ya several cwes were also generated for hr the small cwe hr 1 emerged along the eastern edge while hr 2 propagated along the southern edge of ya similarly cwe ya 1 grew along the eastern edge of ya these three eddies are smaller with diameters of about 8 km they propagated northeastwards joined and then affected each other the relative aviso data show that the xa was struck by the northward flow located between the cyclonic and anticyclonic mesoscale eddies west and east of the xa respectively see fig 6c xa fvcom successfully restored the alternate shedding of wake eddies downstream of yr and the cwes generated east of the hr and ya seen in the sar images see fig 3 and fig 6b the gf 1 image taken on may 30 2014 also shows various island wake events see fig 7a in the downstream wakes northern side of hr and panshi yu the cwes hr 2 py 2 and awes hr 1 py 1 were attached to the eastern and western edges respectively which suggests that the eddies were growing a more interesting phenomenon is the growth of the cwes downstream of the eastern edge of ya fig 7a shows two small cwes ya 1 ya 2 generated at the east edge of ya that were following behind a larger cwe ya 3 north of ya ya 3 was about 17 5 km away from the northern edge of ya and the distance between the small adjoining cwes was about 7 6 km it seems that the small cwes were rotating into the larger one similar phenomenon could also be found in the numerical results of dong et al 2007 on the contrary an awe ya 6 as well as small cwes ya 4 5 were found to the west of ya in addition submesoscale eddies were observed as the diameters of cwes awes are between 3 and 15 km 12 16 km the monthly aviso image from may 2014 depicted in fig 7b shows that xa was struck by a northward flow located between the cyclonic and anticyclonic mesoscale eddies west and east of the xa respectively similar mesoscale dynamics and wake eddies could be found in april 2009 from xa fvcom as the distance between ya and hr is about 19 31 km it is so close that eddies generated by ya and hr may interact with each other downstream from our simulation we found two possibilities that could generate the larger cwe seen downstream of ya 1 it was generated along the eastern edge of ya and the subsequent cwes generated at the east edge of ya may be absorbed by this eddy 2 it was generated along the eastern edge of hr and then propagated to the north of ya then the cwes generated at the eastern edge of ya may be absorbed by this eddy the second situation frequently occurred as shown in figs 7c e we can see that the cwe ya 1 generated at the east edge of ya merged into a larger cwe hr 1 hr 1 had been generated at the eastern edge of hr 3 6 days before in the next sections typical wake eddies downstream of ya hr and yr were selected based on the maximum values of the eddy parameters i e sst signal uplift of the isopycnals or lifetimes 4 1 2 wake eddies of yr due to the strong southern incoming flow at the surface with an upstream surface velocity of about 0 7 m s the cwes and awes shed off the yr which can be seen in figs 8a b the corresponding surface vorticity distribution is displayed in fig 14 the vertical sections taken at the centre of cyclone anticyclone at different times are marked as yr 1 2 respectively the vertical temperature and velocities distribution of yr 1 2 are shown in figs 8c d the cwe which has a typical radius r max that decreases from 5 4 to 5 2 km as calculated by vged the same as below is surface intensified and asymmetry in the velocity field the higher velocities 0 2 m s are confined to the upper 40 60 m 140 m to the west east of the core moreover the maximum horizontal velocities are around 0 6 m s 0 8 m s on the west east side of the cwe the strong current existed at the sides of the wake eddies close to the wake boundary in the xa the upper thermocline is located between 18 and 148 m in spring see appendix a therefore the eddy is mainly located in the upper thermocline the uplift of the isopycnals was around 20 23 m the isopycnal of the cwe is associated with the distributions of the vertical velocities while also became asymmetric figs 8c d show that the uplift is greater at the side with lower velocities near the core of the eddy the uplift is greater which suggests a lower pressure and a stronger upwelling here in contrast to the cwe the awe which has a radius r max that decreases from 6 4 to 6 2 km has a subsurface maximum velocity at a depth of about 25 m the maximum horizontal velocities are around 0 8 m s 0 4 m s on the west east side of the awe similar to the cwe the higher velocities of the eddy are confined to the upper 130 m 40 60 m to the west east of the core the colder water near the surface of the core see figs 8a b is due to horizontal transportation for the reason that none obvious uplift was found in the cross section instead an isopycnal downwelling of about 13 m within the anticyclonic core could be found in fig 8d it is noteworthy that the awe is slightly larger than the cwe under the same conditions which suggests the influence of a centrifugal force as is known for mesoscale eddies in geostrophic equilibrium centrifugal force is neglected the scales of the cyclones and anticyclones can be the same however for sub mesoscale eddies a considerable centrifugal force may destroy the equilibrium which leads to an asymmetry between the cwe and awe 4 1 3 wake eddies of ya hr snapshots of sst and cross sections of the cyclone and anticyclone downstream of the ya and hr are shown in fig 9 the cwe has a typical radius r max 8 8 km and it is asymmetric and surface intensified the maximum horizontal velocities of the cwe are around 0 4 m s 0 8 m s along the west east of the core while the higher velocities are confined to the upper 70 m 170 m along the west east of the core the uplift of the isopycnal is around 30 40 m the awe generated by ya has a radius r max 19 0 km see fig 14 the maximum horizontal velocities are around 0 8 m s 0 4 m s where the higher velocities are confined to the upper 150 m 100 m to the west east of the core the eddy is asymmetric and has a subsurface maximum at a depth of around 50 m at the eastern side of the eddy no significant change was observed for the isopycnal for comparison we also plot the cross sections of an awe downstream of the ya see fig 10 which has the longest lifetime according to the vged this awe generated by the weak western incoming flow has a typical radius r max 6 1 km with the maximum horizontal velocities of around 0 3 m s and the higher velocities confined to the upper 50 m the awe is weaker and no significant change was observed for the isopycnal the above model results clearly show the different behavior of the cwes and awes the cwes are surface intensified and introduce a strong uplift of the isopycnal while the awes have a subsurface maximum that lead to the weak isopycnal downwelling or no significant change of isopycnal moreover the awes are generally larger than their counterparts implying the influence of a centrifugal force 4 2 variability of wake eddies in spring the frequency of eddy shedding downstream of the reefs was studied first tidal signal were removed and hence tidal frequencies were not detected here due to the turbulent incoming flow we could only find short time periods with quasiperiodic eddy shedding process caused by the strong northward or northeastward currents we examined the peak periods of the surface current in the west and east of the reefs with frequency spectrum analysis fig 11 shows that both of the peak periods of eddy shedding in the western and eastern of yr are about 1 40 days during the periods of march 19 27 and march 31 april 7 respectively table 1 gives the dominant periods of three reefs and the relative strouhal number st l tv where l t and v are the reef s typical length shedding period and typical current speed respectively the peak periods of eddy shedding for ya hr and yr are between 0 99 and 1 47 days which is slightly smaller than the local inertial period 1 75 days in the xa the strouhal numbers are between 0 13 and 1 00 it appears that some of our results are quite different to the laboratory experiments st 0 2 zdravkovich 1997 it should be noticed that the reefs are irregular and the shape of an island is an important factor controlling wake features moreover the different selected characteristic lengths of irregular islands may lead to different strouhal number ohya et al 1992 norberg 1993 we choose the maximum diameter d max as the characteristic length here larger st numbers imply that eddies are generally shed at higher frequencies in these three reefs high frequency of eddy shedding caused by island topography can also be found in other areas such as the green island liang et al 2013 and the southern california bight dong and mcwilliams 2007 the shedding frequency is highly related to the island scale eddy viscosity and upstream velocity according to williamson and brown 1998 this is quite different from the open ocean case at surface where the peaking is at much longer time period due to the dominating of geostrophic turbulence including sub mesoscale flows yu et al 2019 in order to gain insight into the behavior of the cwes and awes in spring eddies with lifetime longer than 12 h were detected and tracked by vged the locations of eddy generation are depicted in fig 12a it can be seen that most of the eddies are generated downstream of the reefs and atolls such as yr ya and hr etc investigating the maximum size of the detected eddies during their lifetime in xa fvcom shows that their distribution is similar to a gaussian without an inferior tail due to resolution limitations fig 12b most of the cwe radii are between 4 and 6 km while most of the awe radii are between 6 and 9 km further analysis shows that most of the cwe awe radii are between 5 and 6 km 7 8 km 7 8 km 7 8 km and 4 6 km 8 9 km on the downstream side of yr hr and ya respectively indeed the scales of the eddies generated downstream of the irregular reefs are approximately the same as the reefs dimensions considering now cwes versus awes the former are dominant for all radius classes except for the larger ones 10 12 km see fig 12b nevertheless we can see that the cwes are more abundant than the awes under different incoming flows from march 1 to june 30 2009 to further understand these different behaviors the instant evolution of wake eddies are illustrated by the sequential maps of surface vorticity shown in fig 13 and fig 14 for the yr and ya hr systems respectively the boundaries of the coherent eddies detected by vged are also depicted the vged successfully detected the cwes for a longer lifetime but it could only detect awes in their early stages this means that the awes became incoherent and unstable immediately after their generation indeed the small scale disturbances contaminate the anticyclonic core downstream of yr they strongly affect the awe and even completely break it during april 13 16 and april 20 23 fig 13 similar phenomena were found in previous model studies hasegawa et al 2009 dong et al 2007 and this is a signature of an ici fig 14 depicts the evolution of the cwes and awes downstream of ya hr a cwe was generated first which became larger by absorbing the smaller cwes during march 31 april 3 then the awe grew and dominated the downstream area during april 3 5 we can also see many small disturbances in this eddy the vged can detect it only when it became coherent on april 5 5 island vorticity generation 5 1 evident of the current induced wakes the effect of currents and wind on vorticity generation in the island wakes was first examined as is seen in figs 5b c lower sst features are observed at the northeastern side which is the downstream side according to the distribution of the geostrophic current in fig 3b of ya yr and xuande atoll etc seen in the high resolution mur data and xa fvcom results this is a signature of current induced wakes instead of wind induced wakes barton et al 2000 caldeira et al 2005 chang et al 2013 in spring the winds were mainly light with an average wind speed 4 8 m s and variable see fig 2 unlike the madeira island jiménez et al 2008 hawaii archipelago kersale et al 2011 or the southern california bight dong and mcwilliams 2007 where wind stress curl can be generated by the island s mountain tall island and therefore formwind wake eddies in the xa area only large submerged atolls reefs and small islands are present the submerged atolls and reefs seldom form larger wind stress curl though some small islands like yongxing island with a characteristic length 1 95 km and an average altitude 5 m may generate wind stress curl such behavior is beyond the scope of this study therefore larger wind induced wakes are likely seldom observed in the xa 5 2 effects of frictions at bottom and side boundaries the vorticity generation is complex due to the irregular topography seen in fig 1 the distribution of the time averaged bottom stress τ b around ya hr and yr which was obtained from xa fvcom for a time period from march 28 to may 10 when the northward current is strong is depicted in fig 15 generally the bottom stress τ b 0 1 n m2 is larger in shallow areas such as along the edge or in the interior of the reefs however in other areas there are small bottom stress with τ b 0 01 n m2 as an example we estimated the vorticity generation in the high bottom stress areas around hr using eq 3 10 ζ τ b ρ 0 uh 1 9 f 4 6 f where τ b 0 09 0 63 n m2 ρ 0 1022 kg m3 u 0 06 0 4 m s and h 18 8 m for the characteristic scale in the highest bottom stress areas around the western eastern side of hr it can be seen that the vorticity generated by the bottom stress could not be ignored in such small and shallow areas however in the other areas the bottom stress is quite small and it has little influence on the vorticity generation to further interpret this process we examined the hydrographic data around ya hr and yr at april 3 2009 fig 16 generally in the upper layer above 200 m depth shelves with gentle and steep slopes are distributed around the west and east of these reefs respectively subsurface northward along frontal jets positive values in fig 16 were observed over the shelves of ya hr and yr especially reversed along frontal jets negative values in fig 16 were seen over the eastern shelves of yaand yr the jets were generated by non uniform bottom mixing and can be considered as the result of a stratified current passing an island with a shelf slope according to the studies of chapman and lentz 2005 and dong et al 2018 when the jet accompanied by the density front induces a downwelling cross section current it intensifies the front and the jet itself which can be seen on the western side of the reefs when the jet introduces the upwelling cross section circulation it changes the density gradient by transporting dense water lower leading the jet to weaken and even reverse direction chapman and lentz 2005 which is what happens on the eastern side of the reefs this is a baroclinic process which gives rise to the asymmetry between the western and eastern sides of the reefs the above analysis demonstrates that the interactions among the bottom topography stratification bottom stress and lateral stress takes place around a reef with a slope therefore the baroclinic process may contribute to the vorticity generation around the reefs accordingly we adopted eq 5 to evaluate the importance of the vorticity terms including a baroclinic term we restricted the combined integration domain for eq 5 to a rectangle centered on ya hr and yr upon 200 m for the period of march 28 and may 10 since cyclonic anticyclonic vorticity is generated along the eastern western edge of the reefs during this period we separated the model domain into eastern and western halves to distinguish these two opposite signed source regions fig 17 shows time series of the vorticity terms in eq 5 for the western and eastern half domains of hr the eddy viscous fluxes along the side boundary of the reefs v g are mainly affected by instantaneous fluctuations of the circulation tendency v t and the open boundary flux v f meanwhile the baroclinic effect v b and eddy viscous fluxesacross the open boundaries v d are negligible compared with v g similar phenomena were found for yr and ya not shown demonstrating that the vorticity generation is mainly from the side boundaries of the reefs fig 18a c shows a time series of v g for the western and eastern half domains of ya hr and yr respectively their means and standard deviations are shown in table 2 generally positive negative v g was observed along the eastern western edge of the reefs the anticyclonic generation rates are slightly larger than that of the cyclonic rates see table 2 moreover the periodic vorticity generation shows a feature similar to the current dynamics depicted in fig 11 we performed a frequency spectrum analysis of v g and found that the v g values of ya hr and yr have almost the same peak periods as that of the eddy shedding depicted in table 1 for example the peak periods of v g for the eastern half domains of ya hr and yr are about 1 45 day 1 40 day and 1 40 day respectively this further demonstrates that the eddy shedding is strongly related to the vorticity generation around the side boundaries the above analysis also implies that the cyclonic dominance seen in the downstream wakes of ya hr and yr are manifestations of the evolutionary development in the free stream after separation from the reefs boundary layers 6 wake instability 6 1 barotropic and baroclinic instabilities fig 19 shows the horizontal distribution of the vertically integrated upon 200 m energy conversion the period of march 28 and may 10 was analyzed the k m k e distribution is shown in fig 19a the active barotropic conversion is mainly distributed on both sides of the reefs near the reefs there are areas of k m k e 0 west and east of the reef where vorticity generation is large conversion of the opposite sign takes place immediately upstream and downstream of the reefs the cyclonic and anticyclonic regions of the ya hr and yr show the asymmetry in k m k e a weaker k m k e can be observed at the eastern boundary of the ya this likely shows the existence of the panshi yu and hr in the upstream flow which interacts with each other and weaken the mean kinetic energy of the flow among the hr ya and yr integrated over the whole xa area positive conversion around 0 2144 m3 s3 is obtained which implies the importance of bti in the reefs wakes fig 19b shows the p e k e distribution on the eastern side of yr s wakes there is one largest negative region and one weaker negative region for p e k e several diameters northeast of the ya or north of the yr there is also a region of weak negative baroclinic conversion on the downstream side of hr and ya there are also weak negative regions furthermore there are many small positive and negative fragments on the western side of the ya this may be due to small scale turbulence wakes west of ya the negative regions are collocated in the pathway where the dominant cwes emerge and the wake s density anomaly is large see fig 8 and fig 12b that is it is where kinetic energy in the separated flow is converted into potential energy in strong cyclones eddy properties can be affected by the interaction between eddies by bci and ocean convection which can modify the bulk properties of eddies in the surface ocean up to 10 km eddy scales causing a seemingly robust energy inverse cascade that affects larger scale eddies callies and ferrari 2018 nevertheless p e k e is generally smaller than k m k e indicating that bti is the dominant mechanism for eddy generation in the xa area integrated horizontally over the whole xa area the baroclinic conversion is negative around 0 0048 m3 s3 6 2 inertial centrifugal instability we first study the vortexes profiles to illustrate their stability note that deformation eddies or filaments could not be detected by vged and they are not discussed here to detected the vortex profile the relative core vorticity ζ 0 f i e the mean vorticity where r 0 5r max as a function of the ro for many eddies in their initial stage is plotted in fig 20 we get a line with a slop a mm a 0 3 4 which is very close to the lamb oseen vortex profiles which had γ 3 51 we first examined a cwe named yr cwe1 generated at the downstream side of yr on april 20 see fig 13 the time averaged ro 2 1 the velocity and vorticity profiles of the eddy are similar to that of the lamb oseen vortex for its whole lifetime fig 21a b indeed the inertial perturbations have little effect on the change of the cwe profile kloosterziel et al 2007 though both the core vorticity ζ 0 f and ro decreased quickly the ratio γ kept almost constant 3 5 suggesting it is a stable eddy fig 21c lazar et al 2013a it was detected for 4 days intense awes seems to be too unstable to be tracked by vged so the moderate awe was chosen here compared with yr cwe1 yr awe1 with ro 1 0 and generated on april 10 is affected by inertial perturbations it propagates for only 1 3 days the velocity profiles of yr cwe1 kept a similar shape as the lamb oseen eddy before t 18 h but it deformed thereafter fig 21d this clearly shows that the awe starts decaying at the edge with a larger azimuthal velocity and gradually extends to the interior interestingly the core vorticity does not decay much fig 21e this anomalous decay of the mean azimuthal velocity profile is a signature of the growth of inertia that is localized in the unstable annulus at the eddy s edge where χ 0 according to eq 8 similar results were found in numerical simulations kloosterziel and van heijst 1991 and laboratory experiments lazar et al 2013a teinturier et al 2010 the evolution of the core vorticity ζ 0 f ro and the ratio between them are plotted in fig 21f though ζ 0 f generally stayed the same during t 19 31 h ro decreased faster due to the perturbations at the vortex s edge the ratio γ clearly shows two stages a decreased trend from t 0 18 h and an increased trend from t 19 31 h see fig 21f corresponding to a stable state and an unstable state of this eddy respectively we also found several moderate awes which were generated in the downstream side of ya and propagated for more than three days the awe named ya awe2 seen in fig 10 was selected as an example the radius of the awe decreases faster fig 21g however the core vorticity and ro fig 21i does not decay much it implies an evolution of the awe towards a more stable state kloosterziel et al 2007 lazar et al 2013a lazar et al 2013b generally fluctuations of the ratio γ could be seen in fig 21i the time average ratio was γ 3 2 this awe is considered to be stable but the rayleigh discriminant could not exactly determine its stability status under this circumstance to confirm the occurrence of icis we visualize the evolution of the instability with contour plots of the azimuthal vorticity ζ θ z u r w and potential density anomaly σ the azimuthal vorticity is a good diagnostic of the overturning motions intense awe cwe named yr awe0 and yr cwe0 respectively shown in fig 8 and weak awe ya awe2 shown in fig 10 were analyzed for yr awe0 the time average ro 1 6 the strong toroidal vortices rib vortices of alternating sign were first observed in the eastern side of the awe fig 22a but 16 h later the strong toroidal vortices occupied the whole awe including the area of the core fig 22b this means that the ici starts near the eddy edge where is the original unstable region according to eq 8 but it quickly extends to the eddy core by the angular momentum mixing kloosterziel et al 2007 the instability strongly perturbs the density as we see overturns that are due to the action of the strong toroidal vortices the overturns result in gravitational instability producing mixed regions of low stratification and thin regions of intense stratification separating the regions of low stratification see fig 22 similar phenomena were found in earlier studies carnevale et al 2001 kloosterziel et al 2007 this awe is quite unstable as it was detected by vged for less than one day however for yr cwe0 the strong toroidal vortices of alternating sign as well as the overturns were not observed see fig 22 which means that the ici does not affect the interior of the cwe interestingly the weak awe of ya awe2 shows that there are no toroidal vortices of alternating sign and the isopycnal is generally undisturbed by the awe fig 23 the effect of ici was not observed for this awe the studies of lazar et al 2013a 2013b showed that intense stratification and dissipation could stabilize the flow because the perturbations need to work against a stronger potential energy and dissipation diffuses them therefore the ici in weak awe is suppressed it is noteworthy that ya awe2 is much weaker ro 0 8 than yr awe0 furthermore figs 22 23 clearly show an intenser stratification for ya awe2 indeed the stratification parameter s 408 353 in june and april respectively see appendix a the combined effect of dissipation and the vertical stratification significantly stabilizes this awe which was detected by vged for more than three days to determine the stability status of the awes in the xa a more accurate criterion for the stratified and viscous vortices derived by lazar et al 2013a 2013b was applied see appendix b we found in our model results that even the most intense eddies seem to happen in the upper thermoclines see sections 4 1 2 and 4 1 3 this layer is thin α h t r 0 009 0 07 1 for ya hr and ya where h t is the thickness of upper thermocline and r the typical radius of the island and strongly stratified s 386 see appendix a table 3 gives the results when a vertical diapycnal diffusivity κ z 1 6 10 5 m2 s is used it is an average value obtained from the upper layer around the xa in the xa fvcom it can be seen that yr awe1 is unstable while ya awe2 is stable with larger bu values the eddies with larger bu values are more stable according to this criterion meaning stronger vertical stratification could stabilize the eddies which is accordant with the above analysis assuming that the eddy rossby number ro of the far wake eddies scales as the island rossby number r o i v up fr where v up is the velocity of the upstream flow and r is the typical radius of the island in a turbulent ocean we can extend the stability diagram to the wake flow stegner 2014 table 4 gives the threshold for vortex street formation v 1 and cyclone anticyclone asymmetry v 2 for ya hr and yr in the xa as the reefs have irregular shapes the maximum and minimum radii of the reefs and atolls were calculated respectively according to reynolds theory the thresholds of the incident flow velocity v 1 for vortex street formation of ya hr and yr are between 0 07 0 09 m s the horizontal eddy viscosity was estimated as ν e 2 2 10 4 l 1 13 where xtitl is the characteristic length of an island barton 2001 these values are easily exceeded in the xa area the thresholds for cyclone anticyclone asymmetry v 2 are between 0 10 and 0 38 m s if v up v 2 an awe will become unstable and a cyclone anticyclone asymmetry can be observed a reef with a smaller radius and stronger upstream flow can more easily produce a cyclone anticyclone asymmetry in the wake such as yr due to the irregular shape of the reefs any inflow with a different direction may introduce different island wakes as well as cyclone anticyclone asymmetry 7 summary and discussion the spring island wakes in the xa have been characterized in the present study which provide new insights into the spatial and temporal variability of the submesoscale dynamics of this oceanic region we based our analysis on the high resolution numerical model xa fvcom with the finest resolution of 500 m and forced by the ambient geographic current and meteorological forcing satellite images such as sar and gf 1 were needed to identify the island wakes of ya hr and yr xa fvcom was verified and successfully used to simulate the island wakes during march 1 and june 30 in 2009 different behavior of the cwes and awes was observed downstream of the ya hr and yr the cwes are surface intensified and introduce uplift of the isopycnal 20 40 m for the most intense eddies while the awes have a subsurface maximum of about 25 50 m which leads to weak isopycnal downwelling even the most intense eddies seem to be confined to depths of 170 m generally within the upper thermoclines an analysis of the wake variability in spring showed the cyclone anticyclone asymmetry most of the cwe radii are between 4 and 6 km while most of the awe radii are between 6 and 9 km the cwes were more abundant than the awes for all radius classes under different incoming flows carefully study found that small scale disturbances contaminate the anticyclonic core downstream of the yr and ya hr and even completely break it which is a strong signature of ici beside the effect of ici according to the study of roullet and klein 2010 the cyclonic dominance including the eddies and filaments in the upper layers may be also related to the specific boundary regime that includes energetic submesoscales and associated frontogenesis the inhomogeneous vertical stratification may lead to the cyclone anticyclone asymmetry it is interestingly that except for the cyclonic dominance in the upper layers the anticyclonic dominance may be observed in the interior regions roullet and klein 2010 however further study are needed for this problem lower sst features observed at the downstream side of the reefs shows that the island wakes are generally current induced the modelling results show that shear flow instabilities arising from the side boundaries of the reefs instead of the baroclinic process are the main contributors to vorticity generation however subsurface and reversed along frontal jets were found in the anticyclonic and cyclonic zones around a reef with a shelf slope this baroclinic process gives rise to the asymmetry between the cyclonic and anticyclonic sides of the reefs in the vertical direction we calculated the vorticity generation rate v g for the side boundary of the ya hr and yr and found that the anticyclonic generation rates are slightly larger than those of the cyclonic eddies for these three reefs this further implies that the cyclonic dominance seen in the downstream wakes of ya hr and yr are manifestations of the evolutionary development in the free stream finally the wake instabilities were analyzed it showed that the bti is important towards the generation of the reefs wakes the baroclinic conversion on the other hand is mainly negative which is due to the strong cyclonic wake eddies converting kinetic energy into potential energy strong toroidal vortices of alternating sign which strongly perturbs the density and lead to an unstable state were observed as the existence of the ici in the intense awes an unstable awe usually has a shorter lifetime coupled with a larger decay of velocity at the eddy s edge and a large persistent vorticity at the core all of which lead to an increase of γ however for the cwes or weak awes there are no toroidal vortices as well as the overturns such eddies usually has a longer lifetime and a nearly constant γ it is also noteworthy that the multi island effect such as ya hr system and eddy eddy interactions see fig 7 also significantly affect the stability of an eddy in this region as can be seen in section 4 1 5 2 and 6 1 the bci were strongly related to the downwelling upwelling currents existed in the awes and western shelves cwes and eastern shelves the numerical study of callies and ferrari 2018 shows that eddy properties can be affected by the interaction between eddies by bci and ocean convection which can modify the bulk properties of eddies in the surface ocean up to 10 km eddy scales causing a seemingly robust energy inverse cascade that affects larger scale eddies ocean convection can be due to surface buoyancy forcing and thermobaric effect su et al 2016a su et al 2016b su and ingersoll 2016a there are still relevant phenomena such as multi island effects on the generation of island wakes the effects of other current directions on the island wakes the impact of annual and inter annual timescales of island wakes on the surrounding environment and downstream regions and the biological effects of the island wake need further studies through satellite or in situ data such considerations are beyond the scope of this study but they are an interesting topic for future research acknowledgements the authors thank the reviewers for their valuable comments and suggestions we are grateful to the freely available data as follows the hycom ncoda global reanalysis data available at http hycom org data glbu0pt08 expt 19pt1 the sea surface height ssh and the geostrophic current data provided by the aviso available at http www aviso oceanobs com the ers sar images available at http 124 www ifm zmaw de fileadmin files ers sar the mur sst available at http mur jpl nasa gov the authors are grateful for the data support from the south china sea and adjacent seas data center national earth system science data sharing infrastructure national science technology infrastructure of china http ocean geodata cn the authors are also grateful for the gf 1 image provided by the cnsa this study was supported by the national natural science foundation of china grant numbers 41806044 and 41506202 the natural science foundation of guangdong grant numbers 2018a030313316 and 2014a030310287 the strategic priority research program of the chinese academy of sciences grant numbers xda13030304 and xda13030103 the national key research and development program of china grant number 2017yfc1405402 the basic fund of south china institute of environmental sciences mep grant numbers pm zx703 201602 033 and pm zx703 201601 014 and the state key laboratory of tropical oceanography south china sea institute of oceanology chinese academy of sciences project numbers lto1602 lto1509 and ltozz1701 appendix a vertical stratification and the associated first baroclinic deformation radius r d in xa we plot in fig a1 the spring mean temperatures and density profiles obtained in the south of the xa and the corresponding brunt väisälä frequency n g ρ 0 ρ z the most extreme value of n is located about 48 m below the sea surface the upper thermocline is located between 18 and 148 m vertical temperature gradients larger than 0 05 c m are recognized as the thermocline sprintall and tomczak 1992 within this layer the stratification parameter s n f 386 is large this is larger than most of other islands such as madeira s 350 and hawai oahu s 150 200 which are depicted in stegner 2014 s overview the large s values induce a strong stratification regime for deep water wakes in xa the first baroclinic deformation radius r d in xa was calculated according to this vertical stratification the method for estimating r d is the same as that used by caldeira et al 2014 for a continuous stratification σ z the linear eigenmodes and the corresponding deformation radius are given by the equation 11 z f 2 n 2 z z ψ n ψ n r d n 2 where r d n are the deformation radii associated to the baroclinic modes n 1 2 and z ψ n z 0 z ψ n z h 0 the first baroclinic deformation radius corresponding to this spring stratification is about 50 km in the xa this value is in agreement with the climatological value reported by cai et al 2008 and chelton et al 1998 who found r d 50 km from a contour map of r d furthermore the variation percentage of r d found by cai et al 2008 also showed that it changed little during most of the year in the xa according to quasi geostrophic framework mesoscale commonly refers to the horizontal scale of motion that is similar to or larger than r d at which the rossby number is usually much smaller than one su and ingersoll 2016b su et al 2014 in turn sub mesoscale refers to the horizontal scale that is roughly below the r d torres et al 2018 su et al 2018 sasaki et al 2014 we used these definitions to distinguish between mesoscale and sub mesoscale eddies as the radii of the reefs in xa are all smaller than r d the wake eddies of these reefs are generally sub mesoscale appendix b inertical centrifugal instability criterions for stratified and viscous eddies for a stratified and viscous vortex the rayleigh criterion becomes less relevant close to the marginal stability limit where the growth rates are strongly controlled by the vertical dissipation the linear analysis of lazar et al 2013b reveals that the instability is insensitive to the velocity or the vorticity profiles next the analytical marginal stability limit which depends only on three dimensionless parameters ro bu ek was derived for anticyclonic rankine vortex the latter become linearly unstable to inertial modes if the following equation is satisfied 12 1 ek 8 a 0 3 3 bu r o 2 2 ro 1 7 f ro bu where a 0 2 3381 is the first zero of the airy function the vortex rossby number ro ro 0 for anticyclones the burger number bu and the ekman number ek are defined as 13 ro v max f r max 14 bu r d r max 2 15 ek κ z f h c 2 where v max r max are the maximum velocity and the corresponding radius of the vortex κ z is the vertical diffusivity and h c is the thickness of surface current ek indicates the vertical dissipation while bu is equal to the ratio of the kinetic energy to the potential energy 
24029,eddies caused by island wakes often appear downstream of an island where upwelling currents are coupled with nutrient transport several island wake eddies downstream of the yongle atoll ya huaguang reef hr and yuzhuo reef yr in the xisha archipelago xa are found based on sar and gf 1 satellite images taken on april 14 2009 and may 30 2014 respectively the present study aims to explore the features and mechanisms of spring island wakes based on a high resolution numerical model as well as satellite data our results are 1 the cyclonic wake eddies cwes are surface intensified and introduce a 20 40 m uplift of the isopycnal for the most intense eddies while the anticyclonic wake eddies awes reach a subsurface maximum at a depth of 25 50 m which leads to the weak isopycnal downwelling the cwes are generally more abundant than the awes in different radius classes under different incoming flows which is due to the inertial centrifugal instability ici of the awes 2 in the xa lower sst features observed in the downstream side of the reefs demonstrate the presence of current induced island wakes in the near wakes of ya hr and yr the periodic vorticity generation is mainly caused by shear flow instabilities arising from the side boundaries of the reefs anticyclonic vorticity generation is slightly larger than that of the cyclonic for these three reefs 3 for the submesoscale wake dynamics the barotropic instability is more significant than the baroclinic in the xa strong toroidal vortices of alternating sign which strongly perturb the density were observed as the existence of the ici in the transects of an unstable intense awe but these could hardly be found in a weak awe the unstable awes may have a larger decay of the velocity at their eddy edges and large persistent vorticities at their cores which lead to an increase of the ratio between the core vorticity and the rossby number γ while stable awes have longer lifetimes with nearly constant γ values that are similar to those of the stable cwes keywords island wake numerical simulation sub mesoscale inertial centrifugal instability ici xisha archipelago xa 1 introduction island wakes have been observed and studied intensively for many island areas doty and oguri 1956 arístegui et al 1997 caldeira et al 2002 2005 andrade et al 2014b the island wakes affect their surrounding and downstream environments via the transport and retention of nutrients pollutants and plankton hasegawa et al 2009 they are often accompanied by higher bio productivity hasegawa et al 2008 andrade et al 2014a 2014b and closely associated with fishing activities signorini et al 1999 because of upwelling and turbulent mixing this is called the island mass effect doty and oguri 1956 satellite images have become an important data resource for studies of island wake phenomena barton et al 1998 caldeira et al 2002 caldeira et al 2005 chassignet et al 2007 zheng and zheng 2014 caldeira et al 2014 by using satellite sea surface temperature sst data barton et al 1998 identified cyclonic and anticyclonic eddies produced downstream of the gran canaria island using synthetic aperture radar sar images isoguch et al 2007 observed island wake patterns such as meandering and vortex streets in the lee of isolated islands in addition using both sar and sst images zheng and zheng 2014 analyzed the island induced vortex train generated downstream of green island in the kuroshio region satellite images provide high resolution spatial and temporal surface ocean information but they cannot yield information related to the interior of oceans or even subsurface ocean dynamics klein et al 2019 many studies have aimed to understand the physical processes that occur in the wakes of islands based on high resolution numerical simulations in particular the primitive three dimensional equation model is widely used because of the stratified character of fluid in these areas using the regional ocean modelling system dong et al 2007 studied the idealized case of a cylinder like island in a deep stratified and rotating fluid they found three types of instabilities inertial centrifugal instability ici barotropic instability bti and baroclinic instability bci which led to the generation of strong vorticity in the lee of the island furthermore stegner et al 2010 and lazar et al 2010 performed laboratory experiments and numerical simulations to study the asymmetry of island wakes in deep stratified and rotating fluids they summarized that cyclonic and anticyclonic asymmetry is due to the intrinsic dynamical properties of the flow and are mainly controlled by three dimensionless numbers the island rossby number ro i the burger number bu and the ekman number ek especially for sub mesoscale vortex wakes numerical and experimental results showed that the ici may induce a selective destabilization of anticyclonic vorticity regions kloosterziel and van heijst 1991 mutabazi et al 1992 lazar et al 2013a lazar et al 2013b kloosterziel et al 2007 teinturier et al 2010 most realistic studies use a closer representation of the oceanic bathymetry immersed in a complex representation of the ambient geophysical flows for instance high resolution numerical oceanic models with realistic topography and realistic currents wind and tidal forcing were used to study island wakes in the southern california bight scb the results showed that both current induced and wind induced island wakes exist in the scb caldeira et al 2005 and that much of the enstrophy in the scb is generated in island wakes dong and mcwilliams 2007 recently caldeira and sangrà 2012 found that the actual bathymetry may be very important for eddy generation downstream of the madeira archipelago by considering the influence of multiple islands and the role of the island shelf they found that neighboring islands play an important role in destabilizing the near field wake and that sub inertial instabilities might also act in the near field particularly around steep island shelves island wakes can be generated by both wind and currents which are called wind induced and current induced island wakes respectively caldeira et al 2005 sangrà et al 2007 jiménez et al 2008 the upwelling and mixing of deep colder water causes horizontal current shears behind an island so current induced island wakes are usually accompanied by a lower sst feature located at the downstream side of the island barton et al 2000 caldeira et al 2005 chang et al 2013 by contrast a wind induced vortex is usually coupled to a higher sst because of weaker vertical mixing due to sheltering from the wind on the lee side of a tall island arístegui et al 1994 caldeira et al 2005 the current and wind induced island wakes of a tall island often interact with each other caldeira et al 2005 sangrà et al 2007 jiménez et al 2008 for some islands such as madeira couvelard et al 2012 and hawaii xie et al 2001 jia et al 2011 wind can play an important role in the generation of island wakes the xisha archipelago xa is located in the northwest south china sea scs and is characterized by several reefs and atolls in this area images of several island wake events were captured by satellites on april 14 2009 and may 30 2014 see section 4 however few oceanographic studies have attempted to characterize the island wakes of the xa and thus in situ data related to island wakes are scarce previous studies have shown that the xa is frequently affected by mesoscale eddies i e eddies whose radii are larger than r d 50 km see appendix a nan et al 2011 hwang and chen 2000 however what about the dynamic features of the island wakes is it perhaps related to mesoscale dynamics and which instability mechanism dominates this island wake progress in order to help answer these questions a high resolution numerical simulation coupled with satellite data is needed we employed the unstructured grid finite volume community ocean model fvcom chen et al 2003 chen et al 2006 chen et al 2012 where the dynamics of the currents of the xa were simulated using relaxation nesting boundaries and surface meteorological forcing from january to june during 2009 the present study addresses the following issues in detail a the spatial structure and variability of island wakes in the spring b the mechanism of island vorticity generation and c the intrinsic dynamics of the wake instabilities the remaining sections of this paper are organized as follows in section 2 the oceanographic setting of xa are introduced while in section 3 the data and the design of the numerical simulation the analysis methods as well as the model verification are described in section 4 the three dimensional characteristics and variability of wakes eddies are presented in sections 5 and 6 the dynamic mechanisms of island vorticity generation and wake instability are analyzed and discussed respectively finally in section 7 our conclusions are summarized 2 oceanographic setting the xa is located near the northwest coast of scs see fig 1 we show the xa as the area above the xa continental shelf range from 15 75 to 17 5 n and 110 75 to 113 0 e see fig 1b the archipelago is characterized by several reefs and atolls ye et al 1985 as shown in fig 1 there are three atolls and five reefs in the xa with the huaguang reef hr as the largest one which has a maximum length of 27 3 km and its lagoon has a maximum depth of 27 m xie 1979 the second largest is yuzhuo reef yr which has a maximum length of 14 4 km the area surrounded by the xuande atoll yr and yongle atoll ya is a trough with a depth of 900 m xie 1979 scs is the largest semi enclosed marginal sea in the northwestern pacific ocean the general circulation pattern of the scs is a basin wide cyclonic gyre in winter and an anticyclonic gyre in summer which is dominated by seasonally reversing monsoons that typically blow strongly from the northeast during boreal winter and from the southwest during boreal summer dale 1956 metzger 2003 wang et al 2003 many cyclonic and anticyclonic eddies are embedded in the basin scale circulation which is characterized by a multi eddy structure nan et al 2011 the western boundary current wbc east of vietnam is energetic in summer and it divides into two branches after moving around the southeastern hainan island one branch flows northeastward over the shallower northern shelf along the east coast of hainan island while the other branch flows eastward at 18 n towards the deep basin nan et al 2011 hwang and chen 2000 the xa is located near the eastward branch where anticyclonic circulation is often generated in the summer that is driven by the southwesterly monsoon in general a northeastward current can be observed in the summer and a southwestward current in the winter near the xa area in spring the current is variable and mesoscale eddies are active in this area in 2009 a northeastward current was observed from april to september and variable currents were found in the other months according to the aviso satellite data show that the sst increased from january to july followed by a decrease from july to december with large fluctuations from late august to early september the xa is characterized by a north west south east sst gradient 3 data and methods 3 1 data sets we supplemented our observations with wake induced sea state changes detected by satellite images we used ers sar images with a resolution of 25 m obtained from the tropical and subtropical ocean viewed by ers sar http www ifm zmaw de fileadmin files ers sar sar images provide fine resolution active microwave observations of sea surface roughness which are not affected by cloud cover or the availability of light gaofen 1 gao fen high resolution gf 1 is the first of a series of high resolution optical earth observation cnsa china national space administration beijing china satellites gf 1 has a medium and high spatial resolution and a wide swath imaging capacity it employs a cast 2000 bus which is configured with two 2 m pan 8 m ms camera and a four 16 m ms medium resolution and wide field camera set more details can be found at https directory eoportal org web eoportal satellite missions g gaofen 1 for the model validation in situ data were acquired from three stations around the xa area andrade et al 2014a the xisha subsurface buoy with one upward 75 khz adcp and one downward 150 khz adcp to cover the whole water column located at 17 10 n 110 39 e see fig 1 point a it supplied time sequences of the vertical distribution of velocity from 2008 to 2011 with a sampling frequency of 1 h as the adcps located at a depth of about 500 m the data in the regions close to the surface and adcp are mostly invalid due to the echoes of sound waves being weak in these regions so only the depths of 40 200 m were selected for the validation andrade et al 2014b a tidal gauge station located at 16 84 n 112 33 e see fig 1 point b provided surface elevation time sequences from june 2007 december 2013 with a sampling frequency of 10 min and arístegui et al 1994 the xisha automatic weather station located at yongxing island observed wind dynamics from 2009 to 2011 valid data exist from september to october in 2009 with a sampling frequency of 10 min all the in situ data mentioned above were acquired from the lake watershed science data center national earth system science data sharing infrastructure national science technology infrastructure of china http lake geodata cn moreover the multi scale ultra high resolution sea surface temperature mur sst data are used in the validations the data were globally gridded at 1 km resolution by merging data from modis amsr e and avhrr an objective interpolation technique based on a wavelet decomposition chin et al 1996 was used to process each retrieval data set with respect to its inherent resolution more information can be found at http mur jpl nasa gov data descriptions may also be found at http podaac jpl nasa gov dataset jpl l4uhfnd glob mur the mesoscale eddies which affect the island wakes in the xa were also detected based on the sea surface height ssh and the geostrophic current data obtained from gridded 1 4 1 4 aviso http www aviso oceanobs com it is noteworthy that the real physical resolution of aviso can be much lower only 100 200 km reanalysis data such as the hycom current data and ncep surface forcing were used as model inputs in this study 3 2 numerical model fvcom chen et al 2003 chen et al 2006 chen et al 2012 was used to model the xa area referred to as xa fvcom in the following xa fvcom was run using the mode split solver with a default setup comprised of the modified mellor and yamada level 2 5 my 2 5 mellor 2001 mellor and blumberg 2004 mellor and yamada 1982 and smagorinsky smagorinsky 1963 turbulent closure schemes for vertical and horizontal mixing respectively the bottom stress was calculated by τ b c d ρ 0 u u where τ b is the bottom frictional stress ρ 0 is the water density and u is the current speed the term c d max κ 2 ln z ab z 0 2 0 0025 is the drag coefficient where κ 0 4 is the von karman constant z ab the height above the bottom and z 0 is the bottom roughness parameter etopo1 1 min gridded topography data supported by noaa were used see fig 1b the numerical experiments covered the period from january 1 to june 30 in 2009 three hourly hycom ncoda global reanalysis data with a horizontal resolution of 1 12 5 http hycom org data glbu0pt08 expt 19pt1 chassignet et al 2007 chassignet et al 2003 were used to drive xa fvcom through the relaxation nesting boundary as described and validated by chen et al 2012 four relaxation layers were used with linear relaxation weights of w i 1 to 0 25 from the outer to interior layers see fig 1a in the following equation v comprised the variables needed e g u v salinity and temperature in the boundary zone and their values are given as 1 v boundary i w i v nest i 1 w i v fvcom i where i is counted from the outer edge boundary the boundary nest and fvcom subscripts indicate the forcing values employed to drive the model the nested values obtained from the large domain structured grid hycom and the original values calculated from xa fvcom respectively the domain was discretized using a non overlapping triangular grid in the horizontal direction where the resolution varied from 500 m over the whole xisha continental shelf to 8 8 km at the nesting boundary layers in accordance with the global hycom grid the vertical grid discretization was implemented using a uniform σ coordinate with a total of 80 layers the average depth is around 800 m in the xa area so the vertical grid resolution is 10 m we designed such high resolution for the purpose of capturing the horizontal and vertical structure of the island wakes especially for ya hr and yr the time steps for the internal and external mode were 5 and 2 5 s respectively at the surface xa fvcom was driven by meteorological forcing wind stress net heat flux plus shortwave irradiance in the water column and evaporation precipitation at the sea surface in addition 6 hourly ncep cfsr atmospheric forcing data were used with a horizontal resolution of 0 3125 at the surface the wind imparts momentum to the water amplifies evaporation and contributes to vertical mixing and thus the accuracy of wind data is important the ncep produced wind was compared with the in situ monitoring data obtained from the xisha automatic weather station which is located on yongxing island as shown in fig 2 the ncep produced wind speeds had a similar variation to the in situ wind speeds during september 2009 xa fvcom was initialized with the t s field obtained from global hycom and spun up from zero velocity and undisturbed sea elevation 3 3 eddy detection and tracking the vector geometry based eddy detection algorithm vged nencioli et al 2010 was used to automatically identify the characteristics of the eddies eddy core sign boundary radius trace etc here a vortex is defined as a region containing velocity vectors rotating around a centre with a minimum speed the vortex core can be detected according to this definition eddy boundaries are defined as the outermost closed streamline around the centre across which velocity magnitudes are still increasing in the radial direction in other word the streamline with the maximal tangential velocity these are calculated based on the stream function after eddy boundaries are derived the radius r max of each eddy is computed as the mean distance between the centre of the eddy and all the points defining the boundaries once eddies have been detected at each time step we used the tracking method proposed by nencioli et al 2010 to track them in order to apply vged the unstructured fvcom data were first interpolated in the structured mesh grid with a resolution of 0 005 0 005 the flexibility of vged depends on two parameters a the number of grid points where the current increases and b the dimension of the area used to define the local velocity minimum these parameters set the minimum size of the detectable vortices and allow the algorithm to work with different grid resolutions using the same protocol as nencioli et al 2010 the optimal performances of the algorithm were obtained with a 4 b 3 for our model configuration in other words only eddies with radii 2 25 km can be detected 3 4 estimate of vorticity generation when the vorticity generation is dominated by the bottom stress vortices stretching above the bottom boundary layer yield the following vorticity balance dong and mcwilliams 2007 2 ζ t τ b ρ 0 h where h is the stretching layer thickness the vorticity ζ can be estimated as 3 ζ τ b ρ 0 uh where the relevant time for vorticity advection is δt l u l and u are the respective length and velocity scales associated with a high stress region in the xa however interactions among the bottom stress bottom topography and lateral stress may take place around a reef with a slope to measure the vorticity generation processes we developed an approximate vertical vorticity equation with anisotropic eddy viscosity ν e terms and a baroclinic term vallis 2017 4 ζ t h u h f ζ ν eh 2 ζ ν ev 2 ζ z 1 ρ 2 ρ x p y ρ y p x where the subscript h and v denote horizontal and vertical components respectively f is the coriolis parameter and p is the pressure in this approximation advective terms involving the vertical velocity are neglected since they would enter at o ro2 dong et al 2007 the vorticity generation rate v g of a reef was calculated by integrating eq 4 dong et al 2007 5 v g t ζdxdydz o u n f ζ dl dz v t v f ν eh o h ζ dldz v d 1 ρ 2 ρ x p y ρ y p x dxdydz v b where the right side terms are the circulation tendency v t the advective v f and eddy viscous v d fluxes across the open boundaries and the baroclinic term v b respectively the symbol o denotes a line integral along an open boundary segment in eq 4 the horizontal eddy viscous flux is split into two terms one along the open boundary v d and the other along the reefs v g according to the study of dong et al 2007 v g increases with re for small re and it converges to a value independent of the eddy viscosity for larger re 3 5 eddy kinetic energy budgets some insight into wake instability mechanisms can be gained by considering energy transfer from mean to eddy energy or eddy potential to eddy kinetic energy when the volume integrated conversion of mean kinetic energy to eddy kinetic energy k m k e is positive it implicates bti and when volume integrated conversion of eddy potential energy to eddy kinetic energy p e k e is positive it implicates bci these can be expressed as dong et al 2007 harrison and robinson 1978 6 k m k e u λ u j u λ x j 7 p e k e g ρ 0 ρ w where cartesian tensor notation with summation convention has been used in eq 6 λ 1 2 j 1 2 3 the overbar denotes the averaging operator and departure from this average is written as ϕ ϕ ϕ the term g is gravitational acceleration 3 6 detection of inertial centrifugal instabilities for inviscid and circular vortices the rayleigh criterion kloosterziel and van heijst 1991 mutabazi et al 1992 asserts that all anticyclonic eddy columns are unstable to three dimensional perturbations if somewhere in the flow the rayleigh discriminant is negative namely 8 χ r ζ r f 2 v r r f 0 where ζ r r v r v r is the relative vorticity according to this widely used criterion the stability of a circular anticyclone depends crucially on its velocity or vorticity profile the ratio between the core vorticity ζ 0 f and the ro 9 γ ζ 0 f 1 ro is very sensitive to the vortex profile γ 2 3 3 51 4 for an idealized rankine a parabolic a lamb oseen and a conical vortex respectively the ratio γ is a relevant parameter to detect the signature of an ici in a mean horizontal velocity field lazar et al 2013a lazar et al 2013b it increases with time for an unstable anticyclone and it may reach values up to five for a stable cyclone it keeps constant or slightly decreases down to three for a stratified and viscous vortex a more accurate criterion derived by lazar et al 2013a 2013b was also used see appendix b 3 7 model verification roughly 42 days after the initialization the surface kinetic energy of xa fvcom approached a steady state and started to exhibit fluctuations which suggested the spin up had completed capet et al 2008 to avoid any effects arising from the initial conditions employed in the model we only analyzed the results obtained after march 1 2009 59 days after the initialization the effectiveness of the relaxation nesting boundary in xa fvcom was important for the simulations fig 3a shows the instant surface elevation and velocities obtained by xa fvcom nested in the global hycom on april 14 2009 which shows that the surface elevation and velocities propagated smoothly from the outer boundary to the interior and thus the barotropic and baroclinic currents propagated smoothly from hycom to xa fvcom fig 3b further depicts the mean surface elevation and geostrophic currents obtained by xa fvcom from march to june it shows that the xa area was mainly struck by northeast currents which were located between the cyclonic and anticyclonic mesoscale eddies during these periods xa fvcom was then validated using the in situ and satellite data fig 4a shows that the overall trend in the surface elevations was similar to the in situ monitoring data the root mean square error rmse of the surface elevations is 0 065 m time sequences of the vertical distribution of the daily average horizontal velocity magnitudes in the upper seawater were also compared with the in situ monitoring data as shown in fig 4b the general trend of the velocity was captured by xa fvcom the velocity decreased throughout april 12 27 and may 18 june 7 which suggests that the core of the mesoscale cyclonic eddy may have affected this area and thus the direction of the velocity became complicated the thermocline structures were also validated fig 5a shows that the overall trend in the sst was simulated well compared with the mur data with the rmse 0 38 c furthermore both the mur and xa fvcom data show that the xa is characterized by a north west south east sst gradient figs 5b c the high resolution mur data reveals cold regions behind several reefs atolls ya yr and xuande atoll etc which are likely due to upwelling and mixing caused by strong current induced island wakes see fig 3b these features appear in the same locations in our numerical results the overall good agreement between the simulated results demonstrates that xa fvcom has the capacity to reconstruct the dynamics of mesoscale and sub mesoscale phenomena in the xa 4 three dimensional characteristics and variability of island wakes in spring we focused on three typical reefs ya hr and yr for the reason that andrade et al 2014a these reefs are typical in the xa area and andrade et al 2014b they have a length between 14 and 27 km which are suitable for easily forming sub mesoscale eddies in the xa the first baroclinic deformation radius r d 50 km see appendix a it is larger than most of the radii of the reefs in xa thus sub mesoscale eddies should be expected in their downstream wakes 4 1 horizontal and vertical structure of the island wakes 4 1 1 comparison between the modeled and observed wake eddies the instant horizontal distributions of the island wakes in the xa were successfully captured in the satellite images fig 6a shows a sar image taken on april 14 2009 the sea surface roughness shows that cyclonic wake eddies cwes yr 1 3 and anticyclonic wake eddy awe yr 2 alternately shed off yr the diameters of yr 2 3 are about 18 km and 15 km respectively see fig 6a they are both sub mesoscale eddies with diameters close to the maximal length of yr 14 4 km and smaller than r d along the eastern edge of hr and ya several cwes were also generated for hr the small cwe hr 1 emerged along the eastern edge while hr 2 propagated along the southern edge of ya similarly cwe ya 1 grew along the eastern edge of ya these three eddies are smaller with diameters of about 8 km they propagated northeastwards joined and then affected each other the relative aviso data show that the xa was struck by the northward flow located between the cyclonic and anticyclonic mesoscale eddies west and east of the xa respectively see fig 6c xa fvcom successfully restored the alternate shedding of wake eddies downstream of yr and the cwes generated east of the hr and ya seen in the sar images see fig 3 and fig 6b the gf 1 image taken on may 30 2014 also shows various island wake events see fig 7a in the downstream wakes northern side of hr and panshi yu the cwes hr 2 py 2 and awes hr 1 py 1 were attached to the eastern and western edges respectively which suggests that the eddies were growing a more interesting phenomenon is the growth of the cwes downstream of the eastern edge of ya fig 7a shows two small cwes ya 1 ya 2 generated at the east edge of ya that were following behind a larger cwe ya 3 north of ya ya 3 was about 17 5 km away from the northern edge of ya and the distance between the small adjoining cwes was about 7 6 km it seems that the small cwes were rotating into the larger one similar phenomenon could also be found in the numerical results of dong et al 2007 on the contrary an awe ya 6 as well as small cwes ya 4 5 were found to the west of ya in addition submesoscale eddies were observed as the diameters of cwes awes are between 3 and 15 km 12 16 km the monthly aviso image from may 2014 depicted in fig 7b shows that xa was struck by a northward flow located between the cyclonic and anticyclonic mesoscale eddies west and east of the xa respectively similar mesoscale dynamics and wake eddies could be found in april 2009 from xa fvcom as the distance between ya and hr is about 19 31 km it is so close that eddies generated by ya and hr may interact with each other downstream from our simulation we found two possibilities that could generate the larger cwe seen downstream of ya 1 it was generated along the eastern edge of ya and the subsequent cwes generated at the east edge of ya may be absorbed by this eddy 2 it was generated along the eastern edge of hr and then propagated to the north of ya then the cwes generated at the eastern edge of ya may be absorbed by this eddy the second situation frequently occurred as shown in figs 7c e we can see that the cwe ya 1 generated at the east edge of ya merged into a larger cwe hr 1 hr 1 had been generated at the eastern edge of hr 3 6 days before in the next sections typical wake eddies downstream of ya hr and yr were selected based on the maximum values of the eddy parameters i e sst signal uplift of the isopycnals or lifetimes 4 1 2 wake eddies of yr due to the strong southern incoming flow at the surface with an upstream surface velocity of about 0 7 m s the cwes and awes shed off the yr which can be seen in figs 8a b the corresponding surface vorticity distribution is displayed in fig 14 the vertical sections taken at the centre of cyclone anticyclone at different times are marked as yr 1 2 respectively the vertical temperature and velocities distribution of yr 1 2 are shown in figs 8c d the cwe which has a typical radius r max that decreases from 5 4 to 5 2 km as calculated by vged the same as below is surface intensified and asymmetry in the velocity field the higher velocities 0 2 m s are confined to the upper 40 60 m 140 m to the west east of the core moreover the maximum horizontal velocities are around 0 6 m s 0 8 m s on the west east side of the cwe the strong current existed at the sides of the wake eddies close to the wake boundary in the xa the upper thermocline is located between 18 and 148 m in spring see appendix a therefore the eddy is mainly located in the upper thermocline the uplift of the isopycnals was around 20 23 m the isopycnal of the cwe is associated with the distributions of the vertical velocities while also became asymmetric figs 8c d show that the uplift is greater at the side with lower velocities near the core of the eddy the uplift is greater which suggests a lower pressure and a stronger upwelling here in contrast to the cwe the awe which has a radius r max that decreases from 6 4 to 6 2 km has a subsurface maximum velocity at a depth of about 25 m the maximum horizontal velocities are around 0 8 m s 0 4 m s on the west east side of the awe similar to the cwe the higher velocities of the eddy are confined to the upper 130 m 40 60 m to the west east of the core the colder water near the surface of the core see figs 8a b is due to horizontal transportation for the reason that none obvious uplift was found in the cross section instead an isopycnal downwelling of about 13 m within the anticyclonic core could be found in fig 8d it is noteworthy that the awe is slightly larger than the cwe under the same conditions which suggests the influence of a centrifugal force as is known for mesoscale eddies in geostrophic equilibrium centrifugal force is neglected the scales of the cyclones and anticyclones can be the same however for sub mesoscale eddies a considerable centrifugal force may destroy the equilibrium which leads to an asymmetry between the cwe and awe 4 1 3 wake eddies of ya hr snapshots of sst and cross sections of the cyclone and anticyclone downstream of the ya and hr are shown in fig 9 the cwe has a typical radius r max 8 8 km and it is asymmetric and surface intensified the maximum horizontal velocities of the cwe are around 0 4 m s 0 8 m s along the west east of the core while the higher velocities are confined to the upper 70 m 170 m along the west east of the core the uplift of the isopycnal is around 30 40 m the awe generated by ya has a radius r max 19 0 km see fig 14 the maximum horizontal velocities are around 0 8 m s 0 4 m s where the higher velocities are confined to the upper 150 m 100 m to the west east of the core the eddy is asymmetric and has a subsurface maximum at a depth of around 50 m at the eastern side of the eddy no significant change was observed for the isopycnal for comparison we also plot the cross sections of an awe downstream of the ya see fig 10 which has the longest lifetime according to the vged this awe generated by the weak western incoming flow has a typical radius r max 6 1 km with the maximum horizontal velocities of around 0 3 m s and the higher velocities confined to the upper 50 m the awe is weaker and no significant change was observed for the isopycnal the above model results clearly show the different behavior of the cwes and awes the cwes are surface intensified and introduce a strong uplift of the isopycnal while the awes have a subsurface maximum that lead to the weak isopycnal downwelling or no significant change of isopycnal moreover the awes are generally larger than their counterparts implying the influence of a centrifugal force 4 2 variability of wake eddies in spring the frequency of eddy shedding downstream of the reefs was studied first tidal signal were removed and hence tidal frequencies were not detected here due to the turbulent incoming flow we could only find short time periods with quasiperiodic eddy shedding process caused by the strong northward or northeastward currents we examined the peak periods of the surface current in the west and east of the reefs with frequency spectrum analysis fig 11 shows that both of the peak periods of eddy shedding in the western and eastern of yr are about 1 40 days during the periods of march 19 27 and march 31 april 7 respectively table 1 gives the dominant periods of three reefs and the relative strouhal number st l tv where l t and v are the reef s typical length shedding period and typical current speed respectively the peak periods of eddy shedding for ya hr and yr are between 0 99 and 1 47 days which is slightly smaller than the local inertial period 1 75 days in the xa the strouhal numbers are between 0 13 and 1 00 it appears that some of our results are quite different to the laboratory experiments st 0 2 zdravkovich 1997 it should be noticed that the reefs are irregular and the shape of an island is an important factor controlling wake features moreover the different selected characteristic lengths of irregular islands may lead to different strouhal number ohya et al 1992 norberg 1993 we choose the maximum diameter d max as the characteristic length here larger st numbers imply that eddies are generally shed at higher frequencies in these three reefs high frequency of eddy shedding caused by island topography can also be found in other areas such as the green island liang et al 2013 and the southern california bight dong and mcwilliams 2007 the shedding frequency is highly related to the island scale eddy viscosity and upstream velocity according to williamson and brown 1998 this is quite different from the open ocean case at surface where the peaking is at much longer time period due to the dominating of geostrophic turbulence including sub mesoscale flows yu et al 2019 in order to gain insight into the behavior of the cwes and awes in spring eddies with lifetime longer than 12 h were detected and tracked by vged the locations of eddy generation are depicted in fig 12a it can be seen that most of the eddies are generated downstream of the reefs and atolls such as yr ya and hr etc investigating the maximum size of the detected eddies during their lifetime in xa fvcom shows that their distribution is similar to a gaussian without an inferior tail due to resolution limitations fig 12b most of the cwe radii are between 4 and 6 km while most of the awe radii are between 6 and 9 km further analysis shows that most of the cwe awe radii are between 5 and 6 km 7 8 km 7 8 km 7 8 km and 4 6 km 8 9 km on the downstream side of yr hr and ya respectively indeed the scales of the eddies generated downstream of the irregular reefs are approximately the same as the reefs dimensions considering now cwes versus awes the former are dominant for all radius classes except for the larger ones 10 12 km see fig 12b nevertheless we can see that the cwes are more abundant than the awes under different incoming flows from march 1 to june 30 2009 to further understand these different behaviors the instant evolution of wake eddies are illustrated by the sequential maps of surface vorticity shown in fig 13 and fig 14 for the yr and ya hr systems respectively the boundaries of the coherent eddies detected by vged are also depicted the vged successfully detected the cwes for a longer lifetime but it could only detect awes in their early stages this means that the awes became incoherent and unstable immediately after their generation indeed the small scale disturbances contaminate the anticyclonic core downstream of yr they strongly affect the awe and even completely break it during april 13 16 and april 20 23 fig 13 similar phenomena were found in previous model studies hasegawa et al 2009 dong et al 2007 and this is a signature of an ici fig 14 depicts the evolution of the cwes and awes downstream of ya hr a cwe was generated first which became larger by absorbing the smaller cwes during march 31 april 3 then the awe grew and dominated the downstream area during april 3 5 we can also see many small disturbances in this eddy the vged can detect it only when it became coherent on april 5 5 island vorticity generation 5 1 evident of the current induced wakes the effect of currents and wind on vorticity generation in the island wakes was first examined as is seen in figs 5b c lower sst features are observed at the northeastern side which is the downstream side according to the distribution of the geostrophic current in fig 3b of ya yr and xuande atoll etc seen in the high resolution mur data and xa fvcom results this is a signature of current induced wakes instead of wind induced wakes barton et al 2000 caldeira et al 2005 chang et al 2013 in spring the winds were mainly light with an average wind speed 4 8 m s and variable see fig 2 unlike the madeira island jiménez et al 2008 hawaii archipelago kersale et al 2011 or the southern california bight dong and mcwilliams 2007 where wind stress curl can be generated by the island s mountain tall island and therefore formwind wake eddies in the xa area only large submerged atolls reefs and small islands are present the submerged atolls and reefs seldom form larger wind stress curl though some small islands like yongxing island with a characteristic length 1 95 km and an average altitude 5 m may generate wind stress curl such behavior is beyond the scope of this study therefore larger wind induced wakes are likely seldom observed in the xa 5 2 effects of frictions at bottom and side boundaries the vorticity generation is complex due to the irregular topography seen in fig 1 the distribution of the time averaged bottom stress τ b around ya hr and yr which was obtained from xa fvcom for a time period from march 28 to may 10 when the northward current is strong is depicted in fig 15 generally the bottom stress τ b 0 1 n m2 is larger in shallow areas such as along the edge or in the interior of the reefs however in other areas there are small bottom stress with τ b 0 01 n m2 as an example we estimated the vorticity generation in the high bottom stress areas around hr using eq 3 10 ζ τ b ρ 0 uh 1 9 f 4 6 f where τ b 0 09 0 63 n m2 ρ 0 1022 kg m3 u 0 06 0 4 m s and h 18 8 m for the characteristic scale in the highest bottom stress areas around the western eastern side of hr it can be seen that the vorticity generated by the bottom stress could not be ignored in such small and shallow areas however in the other areas the bottom stress is quite small and it has little influence on the vorticity generation to further interpret this process we examined the hydrographic data around ya hr and yr at april 3 2009 fig 16 generally in the upper layer above 200 m depth shelves with gentle and steep slopes are distributed around the west and east of these reefs respectively subsurface northward along frontal jets positive values in fig 16 were observed over the shelves of ya hr and yr especially reversed along frontal jets negative values in fig 16 were seen over the eastern shelves of yaand yr the jets were generated by non uniform bottom mixing and can be considered as the result of a stratified current passing an island with a shelf slope according to the studies of chapman and lentz 2005 and dong et al 2018 when the jet accompanied by the density front induces a downwelling cross section current it intensifies the front and the jet itself which can be seen on the western side of the reefs when the jet introduces the upwelling cross section circulation it changes the density gradient by transporting dense water lower leading the jet to weaken and even reverse direction chapman and lentz 2005 which is what happens on the eastern side of the reefs this is a baroclinic process which gives rise to the asymmetry between the western and eastern sides of the reefs the above analysis demonstrates that the interactions among the bottom topography stratification bottom stress and lateral stress takes place around a reef with a slope therefore the baroclinic process may contribute to the vorticity generation around the reefs accordingly we adopted eq 5 to evaluate the importance of the vorticity terms including a baroclinic term we restricted the combined integration domain for eq 5 to a rectangle centered on ya hr and yr upon 200 m for the period of march 28 and may 10 since cyclonic anticyclonic vorticity is generated along the eastern western edge of the reefs during this period we separated the model domain into eastern and western halves to distinguish these two opposite signed source regions fig 17 shows time series of the vorticity terms in eq 5 for the western and eastern half domains of hr the eddy viscous fluxes along the side boundary of the reefs v g are mainly affected by instantaneous fluctuations of the circulation tendency v t and the open boundary flux v f meanwhile the baroclinic effect v b and eddy viscous fluxesacross the open boundaries v d are negligible compared with v g similar phenomena were found for yr and ya not shown demonstrating that the vorticity generation is mainly from the side boundaries of the reefs fig 18a c shows a time series of v g for the western and eastern half domains of ya hr and yr respectively their means and standard deviations are shown in table 2 generally positive negative v g was observed along the eastern western edge of the reefs the anticyclonic generation rates are slightly larger than that of the cyclonic rates see table 2 moreover the periodic vorticity generation shows a feature similar to the current dynamics depicted in fig 11 we performed a frequency spectrum analysis of v g and found that the v g values of ya hr and yr have almost the same peak periods as that of the eddy shedding depicted in table 1 for example the peak periods of v g for the eastern half domains of ya hr and yr are about 1 45 day 1 40 day and 1 40 day respectively this further demonstrates that the eddy shedding is strongly related to the vorticity generation around the side boundaries the above analysis also implies that the cyclonic dominance seen in the downstream wakes of ya hr and yr are manifestations of the evolutionary development in the free stream after separation from the reefs boundary layers 6 wake instability 6 1 barotropic and baroclinic instabilities fig 19 shows the horizontal distribution of the vertically integrated upon 200 m energy conversion the period of march 28 and may 10 was analyzed the k m k e distribution is shown in fig 19a the active barotropic conversion is mainly distributed on both sides of the reefs near the reefs there are areas of k m k e 0 west and east of the reef where vorticity generation is large conversion of the opposite sign takes place immediately upstream and downstream of the reefs the cyclonic and anticyclonic regions of the ya hr and yr show the asymmetry in k m k e a weaker k m k e can be observed at the eastern boundary of the ya this likely shows the existence of the panshi yu and hr in the upstream flow which interacts with each other and weaken the mean kinetic energy of the flow among the hr ya and yr integrated over the whole xa area positive conversion around 0 2144 m3 s3 is obtained which implies the importance of bti in the reefs wakes fig 19b shows the p e k e distribution on the eastern side of yr s wakes there is one largest negative region and one weaker negative region for p e k e several diameters northeast of the ya or north of the yr there is also a region of weak negative baroclinic conversion on the downstream side of hr and ya there are also weak negative regions furthermore there are many small positive and negative fragments on the western side of the ya this may be due to small scale turbulence wakes west of ya the negative regions are collocated in the pathway where the dominant cwes emerge and the wake s density anomaly is large see fig 8 and fig 12b that is it is where kinetic energy in the separated flow is converted into potential energy in strong cyclones eddy properties can be affected by the interaction between eddies by bci and ocean convection which can modify the bulk properties of eddies in the surface ocean up to 10 km eddy scales causing a seemingly robust energy inverse cascade that affects larger scale eddies callies and ferrari 2018 nevertheless p e k e is generally smaller than k m k e indicating that bti is the dominant mechanism for eddy generation in the xa area integrated horizontally over the whole xa area the baroclinic conversion is negative around 0 0048 m3 s3 6 2 inertial centrifugal instability we first study the vortexes profiles to illustrate their stability note that deformation eddies or filaments could not be detected by vged and they are not discussed here to detected the vortex profile the relative core vorticity ζ 0 f i e the mean vorticity where r 0 5r max as a function of the ro for many eddies in their initial stage is plotted in fig 20 we get a line with a slop a mm a 0 3 4 which is very close to the lamb oseen vortex profiles which had γ 3 51 we first examined a cwe named yr cwe1 generated at the downstream side of yr on april 20 see fig 13 the time averaged ro 2 1 the velocity and vorticity profiles of the eddy are similar to that of the lamb oseen vortex for its whole lifetime fig 21a b indeed the inertial perturbations have little effect on the change of the cwe profile kloosterziel et al 2007 though both the core vorticity ζ 0 f and ro decreased quickly the ratio γ kept almost constant 3 5 suggesting it is a stable eddy fig 21c lazar et al 2013a it was detected for 4 days intense awes seems to be too unstable to be tracked by vged so the moderate awe was chosen here compared with yr cwe1 yr awe1 with ro 1 0 and generated on april 10 is affected by inertial perturbations it propagates for only 1 3 days the velocity profiles of yr cwe1 kept a similar shape as the lamb oseen eddy before t 18 h but it deformed thereafter fig 21d this clearly shows that the awe starts decaying at the edge with a larger azimuthal velocity and gradually extends to the interior interestingly the core vorticity does not decay much fig 21e this anomalous decay of the mean azimuthal velocity profile is a signature of the growth of inertia that is localized in the unstable annulus at the eddy s edge where χ 0 according to eq 8 similar results were found in numerical simulations kloosterziel and van heijst 1991 and laboratory experiments lazar et al 2013a teinturier et al 2010 the evolution of the core vorticity ζ 0 f ro and the ratio between them are plotted in fig 21f though ζ 0 f generally stayed the same during t 19 31 h ro decreased faster due to the perturbations at the vortex s edge the ratio γ clearly shows two stages a decreased trend from t 0 18 h and an increased trend from t 19 31 h see fig 21f corresponding to a stable state and an unstable state of this eddy respectively we also found several moderate awes which were generated in the downstream side of ya and propagated for more than three days the awe named ya awe2 seen in fig 10 was selected as an example the radius of the awe decreases faster fig 21g however the core vorticity and ro fig 21i does not decay much it implies an evolution of the awe towards a more stable state kloosterziel et al 2007 lazar et al 2013a lazar et al 2013b generally fluctuations of the ratio γ could be seen in fig 21i the time average ratio was γ 3 2 this awe is considered to be stable but the rayleigh discriminant could not exactly determine its stability status under this circumstance to confirm the occurrence of icis we visualize the evolution of the instability with contour plots of the azimuthal vorticity ζ θ z u r w and potential density anomaly σ the azimuthal vorticity is a good diagnostic of the overturning motions intense awe cwe named yr awe0 and yr cwe0 respectively shown in fig 8 and weak awe ya awe2 shown in fig 10 were analyzed for yr awe0 the time average ro 1 6 the strong toroidal vortices rib vortices of alternating sign were first observed in the eastern side of the awe fig 22a but 16 h later the strong toroidal vortices occupied the whole awe including the area of the core fig 22b this means that the ici starts near the eddy edge where is the original unstable region according to eq 8 but it quickly extends to the eddy core by the angular momentum mixing kloosterziel et al 2007 the instability strongly perturbs the density as we see overturns that are due to the action of the strong toroidal vortices the overturns result in gravitational instability producing mixed regions of low stratification and thin regions of intense stratification separating the regions of low stratification see fig 22 similar phenomena were found in earlier studies carnevale et al 2001 kloosterziel et al 2007 this awe is quite unstable as it was detected by vged for less than one day however for yr cwe0 the strong toroidal vortices of alternating sign as well as the overturns were not observed see fig 22 which means that the ici does not affect the interior of the cwe interestingly the weak awe of ya awe2 shows that there are no toroidal vortices of alternating sign and the isopycnal is generally undisturbed by the awe fig 23 the effect of ici was not observed for this awe the studies of lazar et al 2013a 2013b showed that intense stratification and dissipation could stabilize the flow because the perturbations need to work against a stronger potential energy and dissipation diffuses them therefore the ici in weak awe is suppressed it is noteworthy that ya awe2 is much weaker ro 0 8 than yr awe0 furthermore figs 22 23 clearly show an intenser stratification for ya awe2 indeed the stratification parameter s 408 353 in june and april respectively see appendix a the combined effect of dissipation and the vertical stratification significantly stabilizes this awe which was detected by vged for more than three days to determine the stability status of the awes in the xa a more accurate criterion for the stratified and viscous vortices derived by lazar et al 2013a 2013b was applied see appendix b we found in our model results that even the most intense eddies seem to happen in the upper thermoclines see sections 4 1 2 and 4 1 3 this layer is thin α h t r 0 009 0 07 1 for ya hr and ya where h t is the thickness of upper thermocline and r the typical radius of the island and strongly stratified s 386 see appendix a table 3 gives the results when a vertical diapycnal diffusivity κ z 1 6 10 5 m2 s is used it is an average value obtained from the upper layer around the xa in the xa fvcom it can be seen that yr awe1 is unstable while ya awe2 is stable with larger bu values the eddies with larger bu values are more stable according to this criterion meaning stronger vertical stratification could stabilize the eddies which is accordant with the above analysis assuming that the eddy rossby number ro of the far wake eddies scales as the island rossby number r o i v up fr where v up is the velocity of the upstream flow and r is the typical radius of the island in a turbulent ocean we can extend the stability diagram to the wake flow stegner 2014 table 4 gives the threshold for vortex street formation v 1 and cyclone anticyclone asymmetry v 2 for ya hr and yr in the xa as the reefs have irregular shapes the maximum and minimum radii of the reefs and atolls were calculated respectively according to reynolds theory the thresholds of the incident flow velocity v 1 for vortex street formation of ya hr and yr are between 0 07 0 09 m s the horizontal eddy viscosity was estimated as ν e 2 2 10 4 l 1 13 where xtitl is the characteristic length of an island barton 2001 these values are easily exceeded in the xa area the thresholds for cyclone anticyclone asymmetry v 2 are between 0 10 and 0 38 m s if v up v 2 an awe will become unstable and a cyclone anticyclone asymmetry can be observed a reef with a smaller radius and stronger upstream flow can more easily produce a cyclone anticyclone asymmetry in the wake such as yr due to the irregular shape of the reefs any inflow with a different direction may introduce different island wakes as well as cyclone anticyclone asymmetry 7 summary and discussion the spring island wakes in the xa have been characterized in the present study which provide new insights into the spatial and temporal variability of the submesoscale dynamics of this oceanic region we based our analysis on the high resolution numerical model xa fvcom with the finest resolution of 500 m and forced by the ambient geographic current and meteorological forcing satellite images such as sar and gf 1 were needed to identify the island wakes of ya hr and yr xa fvcom was verified and successfully used to simulate the island wakes during march 1 and june 30 in 2009 different behavior of the cwes and awes was observed downstream of the ya hr and yr the cwes are surface intensified and introduce uplift of the isopycnal 20 40 m for the most intense eddies while the awes have a subsurface maximum of about 25 50 m which leads to weak isopycnal downwelling even the most intense eddies seem to be confined to depths of 170 m generally within the upper thermoclines an analysis of the wake variability in spring showed the cyclone anticyclone asymmetry most of the cwe radii are between 4 and 6 km while most of the awe radii are between 6 and 9 km the cwes were more abundant than the awes for all radius classes under different incoming flows carefully study found that small scale disturbances contaminate the anticyclonic core downstream of the yr and ya hr and even completely break it which is a strong signature of ici beside the effect of ici according to the study of roullet and klein 2010 the cyclonic dominance including the eddies and filaments in the upper layers may be also related to the specific boundary regime that includes energetic submesoscales and associated frontogenesis the inhomogeneous vertical stratification may lead to the cyclone anticyclone asymmetry it is interestingly that except for the cyclonic dominance in the upper layers the anticyclonic dominance may be observed in the interior regions roullet and klein 2010 however further study are needed for this problem lower sst features observed at the downstream side of the reefs shows that the island wakes are generally current induced the modelling results show that shear flow instabilities arising from the side boundaries of the reefs instead of the baroclinic process are the main contributors to vorticity generation however subsurface and reversed along frontal jets were found in the anticyclonic and cyclonic zones around a reef with a shelf slope this baroclinic process gives rise to the asymmetry between the cyclonic and anticyclonic sides of the reefs in the vertical direction we calculated the vorticity generation rate v g for the side boundary of the ya hr and yr and found that the anticyclonic generation rates are slightly larger than those of the cyclonic eddies for these three reefs this further implies that the cyclonic dominance seen in the downstream wakes of ya hr and yr are manifestations of the evolutionary development in the free stream finally the wake instabilities were analyzed it showed that the bti is important towards the generation of the reefs wakes the baroclinic conversion on the other hand is mainly negative which is due to the strong cyclonic wake eddies converting kinetic energy into potential energy strong toroidal vortices of alternating sign which strongly perturbs the density and lead to an unstable state were observed as the existence of the ici in the intense awes an unstable awe usually has a shorter lifetime coupled with a larger decay of velocity at the eddy s edge and a large persistent vorticity at the core all of which lead to an increase of γ however for the cwes or weak awes there are no toroidal vortices as well as the overturns such eddies usually has a longer lifetime and a nearly constant γ it is also noteworthy that the multi island effect such as ya hr system and eddy eddy interactions see fig 7 also significantly affect the stability of an eddy in this region as can be seen in section 4 1 5 2 and 6 1 the bci were strongly related to the downwelling upwelling currents existed in the awes and western shelves cwes and eastern shelves the numerical study of callies and ferrari 2018 shows that eddy properties can be affected by the interaction between eddies by bci and ocean convection which can modify the bulk properties of eddies in the surface ocean up to 10 km eddy scales causing a seemingly robust energy inverse cascade that affects larger scale eddies ocean convection can be due to surface buoyancy forcing and thermobaric effect su et al 2016a su et al 2016b su and ingersoll 2016a there are still relevant phenomena such as multi island effects on the generation of island wakes the effects of other current directions on the island wakes the impact of annual and inter annual timescales of island wakes on the surrounding environment and downstream regions and the biological effects of the island wake need further studies through satellite or in situ data such considerations are beyond the scope of this study but they are an interesting topic for future research acknowledgements the authors thank the reviewers for their valuable comments and suggestions we are grateful to the freely available data as follows the hycom ncoda global reanalysis data available at http hycom org data glbu0pt08 expt 19pt1 the sea surface height ssh and the geostrophic current data provided by the aviso available at http www aviso oceanobs com the ers sar images available at http 124 www ifm zmaw de fileadmin files ers sar the mur sst available at http mur jpl nasa gov the authors are grateful for the data support from the south china sea and adjacent seas data center national earth system science data sharing infrastructure national science technology infrastructure of china http ocean geodata cn the authors are also grateful for the gf 1 image provided by the cnsa this study was supported by the national natural science foundation of china grant numbers 41806044 and 41506202 the natural science foundation of guangdong grant numbers 2018a030313316 and 2014a030310287 the strategic priority research program of the chinese academy of sciences grant numbers xda13030304 and xda13030103 the national key research and development program of china grant number 2017yfc1405402 the basic fund of south china institute of environmental sciences mep grant numbers pm zx703 201602 033 and pm zx703 201601 014 and the state key laboratory of tropical oceanography south china sea institute of oceanology chinese academy of sciences project numbers lto1602 lto1509 and ltozz1701 appendix a vertical stratification and the associated first baroclinic deformation radius r d in xa we plot in fig a1 the spring mean temperatures and density profiles obtained in the south of the xa and the corresponding brunt väisälä frequency n g ρ 0 ρ z the most extreme value of n is located about 48 m below the sea surface the upper thermocline is located between 18 and 148 m vertical temperature gradients larger than 0 05 c m are recognized as the thermocline sprintall and tomczak 1992 within this layer the stratification parameter s n f 386 is large this is larger than most of other islands such as madeira s 350 and hawai oahu s 150 200 which are depicted in stegner 2014 s overview the large s values induce a strong stratification regime for deep water wakes in xa the first baroclinic deformation radius r d in xa was calculated according to this vertical stratification the method for estimating r d is the same as that used by caldeira et al 2014 for a continuous stratification σ z the linear eigenmodes and the corresponding deformation radius are given by the equation 11 z f 2 n 2 z z ψ n ψ n r d n 2 where r d n are the deformation radii associated to the baroclinic modes n 1 2 and z ψ n z 0 z ψ n z h 0 the first baroclinic deformation radius corresponding to this spring stratification is about 50 km in the xa this value is in agreement with the climatological value reported by cai et al 2008 and chelton et al 1998 who found r d 50 km from a contour map of r d furthermore the variation percentage of r d found by cai et al 2008 also showed that it changed little during most of the year in the xa according to quasi geostrophic framework mesoscale commonly refers to the horizontal scale of motion that is similar to or larger than r d at which the rossby number is usually much smaller than one su and ingersoll 2016b su et al 2014 in turn sub mesoscale refers to the horizontal scale that is roughly below the r d torres et al 2018 su et al 2018 sasaki et al 2014 we used these definitions to distinguish between mesoscale and sub mesoscale eddies as the radii of the reefs in xa are all smaller than r d the wake eddies of these reefs are generally sub mesoscale appendix b inertical centrifugal instability criterions for stratified and viscous eddies for a stratified and viscous vortex the rayleigh criterion becomes less relevant close to the marginal stability limit where the growth rates are strongly controlled by the vertical dissipation the linear analysis of lazar et al 2013b reveals that the instability is insensitive to the velocity or the vorticity profiles next the analytical marginal stability limit which depends only on three dimensionless parameters ro bu ek was derived for anticyclonic rankine vortex the latter become linearly unstable to inertial modes if the following equation is satisfied 12 1 ek 8 a 0 3 3 bu r o 2 2 ro 1 7 f ro bu where a 0 2 3381 is the first zero of the airy function the vortex rossby number ro ro 0 for anticyclones the burger number bu and the ekman number ek are defined as 13 ro v max f r max 14 bu r d r max 2 15 ek κ z f h c 2 where v max r max are the maximum velocity and the corresponding radius of the vortex κ z is the vertical diffusivity and h c is the thickness of surface current ek indicates the vertical dissipation while bu is equal to the ratio of the kinetic energy to the potential energy 
