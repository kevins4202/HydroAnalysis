index,text
20680,this paper focusses on the hydrodynamic performance of an unmanned vehicle system consisting of a remotely operated underwater vehicle rov that has to be launched and recovered autonomously from an autonomous surface vehicles asv the hydrodynamic model of the asv rov coupled system is described in detail and solved numerically the paper seeks to assess the overall performance of the asv rov system including the stability of the asv the rov tidal current capacity and the required power of the launch and recovery winch system the results demonstrate that this asv rov system can complete the launch holding and recovery tasks meeting stability for the given winch power requirements the tidal current capacity of the rov decreases with a larger target water depth the maximum rov umbilical tension is observed during steep wave instances when the rov is in proximity to the asv a down control force is demonstrated to be a suitable solution to limit the maximum tension within the umbilical rated force limits this paper presents the methods and considerations for working towards a fully autonomous asv rov system capable of autonomous inspection and maintenance missions the work will be useful for practitioners and researcher working on autonomous offshore systems keywords unmanned vehicle system analytical model rov asv numerical model winch 1 introduction in an effort to reduce both human risk exposure and cost unmanned surface vehicles usvs offer a possible practical solution generally autonomous vessels can be categorised into autonomous surface vehicles asvs and remotely operated underwater vehicles rovs kumar and kurmi 2018 the application areas of asv have expanded into scientific research roberts and sutton 2006 yan et al 2010 environmental missions švec et al 2014 and ocean resource exploration bertram 2008 pastore and djapic 2010 for example a double hull asv was designed to perform river missions and estuarine scenarios including bathymetry and environmental monitoring ferreira et al 2007 a new asv concept operating in submerged conditions was demonstrated in sea trials successfully implementing larger payloads of 300 kg and a more flexible layout inside the vehicle sager et al 2008 rovs are controlled through a crew or a remote system and are connected with a base station or a vessel by an umbilical which supplies the power and data signal connectivity christ and wernli sr 2011 considering their purpose rovs are categorised into inspection class and intervention class vehicles capocci et al 2017 the intervention class usually has a large mass 200 kg 5 000 kg and can operate in very deep water up to 6 000m but are high cost in most cases shown in table 1 the inspection class rov meets the mission requirements the rated depth of this class device is usually less than 300m owing to its relatively smaller mass the inspection class rov can be manually recovered bruno et al 2015 frost et al 1996 the challenge addressed by this work is to develop a genuinely autonomous couple between the asv and the rov a range of different control methods has been devised and implemented to support rovs directly from an asv autonomously these methods include linear methods such as decoupled control healey and marco 1992 pid control healey and lienard 1993 linear quadratic gaussian control field et al 2000 and nonlinear methods like sliding mode control cristi et al 1990 adaptive control li and lee 2005 in this work asv and rov are connected by the launch and recovery system lars the lars is usually equipped with a tether management system tms in trslic et al 2020 the cage type tms with an rov is translated by lars as a heave motion other systems such as conte et al 2017 are designed without the docking station but are instead equipped with video ray micro rovs to launch and recover the rov directly the coupled effects caused by the lars operations could significantly influence the hydrodynamic performances of both asv and rov sivčev et al 2018 however in the available literature the two systems are usually studied separately for instance chin and lau 2012 determined the hydrodynamic damping of a complex shaped rov by numerical and physical means eidsvik 2015 applies basic empirical coefficients to obtain the hydrodynamic parameters of the rov and this empirical method is tested on the five rovs with different shapes compared with the experimental results it was believed that the empirical method accurately evaluates the added mass of the rov while slightly overestimating its radiation damping julca avila et al 2012 determined the morison s equation inertia and drag coefficients of an rov via a basin test alvarez et al 2009 optimised the hydrodynamic performance of the rov hull when it is near the water surface the coupled effects between the umbilical and rov are discussed in zhu et al 2008 but the influences caused by the asv are not explicitly accounted for in their study the rov is regarded as a 6 dof lumped buoy the umbilical connected with the rov has a constant length 300m without any pay out in speed both physical and numerical results showed that the tidal current could significantly affect the umbilical tension this paper evaluates the hydrodynamic performance of an asv rov system as well as its launch and recovery control strategy a fully nonlinear numerical model based on the potential flow theory is employed to incorporate the coupled effects between the asv the rov and the connecting umbilical the paper is organised as follows section 2 lays out the analytical model of the asv rov coupled system section 3 introduces the asv system and the numerical model used in the case study section 4 presents the hydrodynamic performance results of the asv rov system section 5 discusses the main findings in light of potential industrial applications and further r d requirements section 6 concludes with the main findings and outcomes 2 analytical modelling of the asv rov coupled system 2 1 coordinate systems the asv rov coupled system is represented in four coordinates systems i the global coordinate ii the local coordinates of the asv iii local coordinates of the rov and iv the local coordinate along the umbilical fig 1 the relationship between the global coordinates and the asv rov local coordinates is described in terms of euler angles fossen 1999 for the rov 1 x r o v y r o v z r o v x y z r r o v θ r o v ϕ r o v γ r o v with r r o v θ r o v ϕ r o v γ r o v cos ϕ r o v cos γ r o v cos θ r o v sin γ r o v sin θ r o v sin ϕ r o v cos γ r o v sin θ r o v sin γ r o v cos θ r o v sin ϕ r o v cos γ r o v cos ϕ r o v cos γ r o v cos θ r o v sin γ r o v sin θ r o v sin ϕ r o v cos γ r o v sin θ r o v sin γ r o v cos θ r o v sin ϕ r o v cos γ r o v sin ϕ r o v sin θ r o v cos ϕ r o v cos θ r o v cos ϕ r o v similarly the local coordinate asv is 2 x a s v y a s v z a s v x y z r a s v θ a s v ϕ a s v γ a s v with r a s v θ a s v ϕ a s v γ a s v cos ϕ a s v cos γ a s v cos θ a s v sin γ a s v sin θ a s v sin ϕ a s v cos γ a s v sin θ a s v sin γ a s v cos θ a s v sin ϕ a s v cos γ a s v cos ϕ a s v cos γ a s v cos θ a s v sin γ a s v sin θ r o v sin ϕ r o v cos γ r o v sin θ a s v sin γ a s v cos θ a s v sin ϕ a s v cos γ a s v sin ϕ a s v sin θ a s v cos ϕ a s v cos θ a s v cos ϕ a s v where θ ϕ γ are the pitch roll and yaw angles of asv and rov respectively in the umbilical local coordinate t is the tangent to the umbilical in the direction of paying in out from the winch and b is on the x y plane following the transform method form feng and allen 2004 allows to convert the local coordinate to the global coordinate based on three rotations a a counter clockwise rotation through an angle α about the z axis to bring the x axis into the plane of t and n b a counter clockwise rotation about the new the x axis through π 2 to bring the z axis into coincidence with b c a clockwise rotation about β through b to bring x and y into coincidence with t and n thus the relationship between these two coordinates can be presented as 3 t n b x y z w α β with w α β cos α cos β cos sin β sin α sin α cos β sin α sin β cos α sin β cos β 0 2 2 asv the analytical model of the asv is illustrated in fig 2 owing to the control forces and the umbilical force are nonlinear the governing equations yu et al 2016 are presented under the time domain as follows 4 m m ξ t t h t τ ξ τ d τ k c ξ t f u t f e t where m m is the mass matrix under 6 dofs including the added mass matrix for ω m h t is the retardation function matrix which can be obtained from the convolution integrals of frequency dependent damping matrix h d presented by cummins 1962 greco et al 2009 k is the hydrostatic stiffness matrix c is the control force matrix ξ is the asv s motion equation f u is the umbilical s force matrix and f e is the wave excitation force matrix the hydrodynamic coefficients used in the eq 4 have considered contributions and interactions from all 6 dofs which are calculated by a boundary solver aqwa the hydrostatic stiffness matrix has been added into the control force matrix and is written as k 0 0 0 0 0 0 0 0 ρ g a b 0 0 0 0 0 0 ρ g i 2 ρ g i 1 0 0 0 ρ g i 2 0 0 ρ g i 1 0 0 0 ρ g i 22 i 3 v m g z z 0 ρ g i 12 ρ g i 1 v m g x x 0 ρ g i 21 ρ g i 11 i 3 v m g z z 0 ρ g i 2 v m g y y 0 0 0 0 c c 1 x x 0 0 0 0 c 2 y y 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 where ρ is the water density a b is the heave area of the ship i i is the rotational inertia under the i th degree of freedom dof i i j is the inertia under the i th dof due to the j th dof x y z are the displacements along the x y z direction z 0 is the static draft of the ship x 0 y 0 are the desired holding positions under sway and surge v is the ship s displaced volume c 1 c 2 are the control force coefficients during the time domain calculation if c 1 c 2 are large enough and the time step is sufficiently small the ship will be limited at the desired location f e is the sum of the froude krylov force f f k and the diffraction force f d caused by the incident and diffracted waves respectively falnes and kurniawan 2020 5 f i j i ω ρ s w e t ϕ i x n j d s 6 f d j i ω ρ s w e t ϕ d x n j d s where ω is the wave frequency ϕ i is the incident wave potential ϕ d is the diffraction wave potential 2 3 rov fig 3 presents the analytical model of the 6 dofs rov control forces and moments as a result the rov in this paper is regarded as a 6 dofs buoy the associate mathematical model is presented in fang et al 2007 the thrust control methods of rov were presented in the zhao et al 2020 for the launch stage the rov is firstly driven with full thrusters so that it can quickly reach a depth to prevent it from colliding with the asv then the control method on the x y direction offers a gentle way for the rov s propeller force to increase as a function of its depth to the asv 7 f l x x t a r g e t x r o v k l x l o g 2 z a s v z r o v 8 f l y y t a r g e t y r o v k l y l o g 2 z a s v z r o v when f l x and f l y are larger than the maximum thrust of rov the maximum thrusts will replace them the z direction force f l z includes a constant component c z that permits to approach the target plus a gaussian function around the target allowing the force to increase a lot when approaching the target in order to maintain the rov s depth similar to the f l x and f l y f l z will still be limited by the maximum rov thrust 9 f l z c z k l z 1 5 e z a s v z r o v 2 where x t a r g e t y t a r g e t z t a r g e t are the target coordinates in each direction x a s v y a s v z a s v are the displacement of asv in each direction x r o v y r o v z r o v are the displacements of rov in each direction k l x k l y k l z are the launch control coefficients in each direction during the holding or following stage the control force is calculated as here the current direction is on the x direction and heading to the rov 10 f f o l l o w i n g 0 5 π s r d c r o v v c s 0 75 v a s v x 2 where s r d is the drag area of the rov c r o v is the drag force coefficient on the x direction v c s is the current speed on the surface v a s v x is the velocity of asv in the x direction with this control force the rov can maintain the required distance to the asv under the current and drag force load during the recovery stage the control force is defined as a nonlinear relationship which permits to be low when the rov is far from the recovery target it will become higher limited by the maximum rov thrust when it approaches the target and low again when it reaches the target without breaking the force continuity the force is presented as follows 11 f r x e x a s v x r o v 2 10 k r x x a s v x r o v 12 f r y y a s v y r o v k r y when the rov is far from the asv f r z 0 however if the rov is in close proximity here the distance is less than 10 m to the asv f r z is half the maximum thrust of the propeller to keep the tension on the umbilical preventing a sudden relative motion and consequential snap loads between asv and rov where the k r x k r y is the recovery control coefficients on the x and y directions when the rov is close enough to the asv the f r z will be zero to prevent a collision 2 4 umbilical and winch the umbilical and winch system couples the asv and the rov thus the crucial task is to determine the umbilical dynamics according to ablow and schechter 1983 umbilical dynamics can be generally expressed as 13 a y s b y t q with a 1 0 0 0 0 0 0 1 0 0 v b cos β v n 0 0 1 0 v b sin β v t 0 0 0 1 v n sin β v t cos β 0 0 0 0 0 t t e n s i o n cos β 0 0 0 0 0 0 t t e n s i o n b m u e v t 1 e t t e n s i o n m u 0 0 m u 1 v b ρ s u j b cos β m u 1 v n ρ s u j n e 0 0 0 0 0 0 0 0 0 0 1 e t t e n s i o n 0 0 0 0 1 e t t e n s i o n cos β 0 e m u 1 v b ρ s u j b 1 e t t e n s i o n 0 0 m u 1 m u 1 v n ρ s u j n sin β m u v t cos β 0 e m u 1 v n ρ s u j n 1 e t t e n s i o n 0 m u 1 0 m u 1 v b ρ s u j b sin β m u v t q w u sin β 1 2 ρ d 1 e t t e n s i o n π c t u t u t 0 0 0 1 2 ρ d 1 e t t e n s i o n c n u b u b 2 u n 2 ρ s u j b w u cos β 1 2 ρ d 1 e t t e n s i o n c n u n u b 2 u n 2 ρ s u j n where y is the dynamic vector of the umbilical y s t t t e n s i o n v t v n v d α β t s is the arc length of the cable between the asv and rov t is the time v u v t v n v d t is the umbilical velocity matrix in its local coordinate t t e n s i o n k u δ l k u is the spring coefficient δ l is the deformation of the umbilical m u is the mass per unit length of umbilical s u is the cross sectional area of the unstretched umbilical e is the 1 e s u e is the young s modulus m u 1 denotes m u ρ s u the tidal current speed matrix in the umbilical coordinate is j u j t j n j d t and the relative speed between umbilical and current can be written as v u j u u t u n u d t w u is the m u ρ s u g g is the gravity acceleration to obtain the solution of equation 13 six boundary conditions will be needed the two ends of the umbilical share the pay out in speed and the rov speed respectively thus three boundary conditions are obtained for the rov connection point the rov speed angular speed on the t n b can be denoted as 14 v r o v t n b v r o v t v r o v n v r o v b t 15 ω r o v u r o v p i t c h v r o v r o l l w r o v y a w t according to the 1 and 3 the relationship between rov and umbilical coordinate could be expressed as 16 t n b x r o v y r o v z r o v r r o v t θ r o v ϕ r o v γ r o v w α β in terms of 14 16 the boundary conditions three boundaries of rov connected point could be obtained 17 v r o v c o n n e c t 0 t v r o v t n b ω r o v r r o v r r o v θ r o v ϕ r o v γ r o v w α β here the length of umbilical at this point is considered as 0 r r o v is the distance between the mass centre and the connecting point on the rov at the winch connected point the umbilical speed at b n direction is zero 18 v n w i n c h c o n n e c t s t 0 19 v b w i n c h c o n n e c t s t 0 the last boundary condition is obtained through the dynamic equation of the winch based on newton s law 20 j w i n c h v t w i n c h c o n n e c t s t f d r i v e t t e n s i o n f r e s i s t a n c e r w i n c h where j w i n c h is the moment of inertia of the drum f r e s i s t a n c e is the resistance of the drum r w i n c h is the radius of the drum the six boundary conditions 16 to 20 can be used to solve the equation 13 in the real sea environment the v t w i n c h c o n n e c t s t is always non zero and dependent on the winch control method the boundaries and solutions with a non zero v t w i n c h c o n n e c t s t are described in feng and allen 2004 in this present paper two different methods are used see also fig 4 1 the first method pay out control is to maintain the pay out rate v o u t of the umbilical as a constant value and then to calculate the winch drive force f d r i v e in the umbilical at any time 2 the second method tension control aims to control the tension and to determine the corresponding pay out rate respectively for the pay out control 21 v t w i n c h c o n n e c t s t v o u t as a result the v t w i n c h c o n n e c t s t is 0 the winch drive force is 22 f d r i v e t t e n s i o n f r e s i s t a n c e the resistance of the winch could be presented as 23 f r e s i s t a n c e d d b c o u t v o u t d o u t v o u t 2 where d d b is the winch drive dead band c o u t are the winch drive damping terms for pay out d o u t are the winch drive drag terms for pay out for the tension control method 24 f d r i v e f t arg e t f r e s i s t a n c e where f t a r g e t is the target tension on the umbilical according to equations 6 8 and j w i n c h m w i n c h r w i n c h 2 25 v o u t s t f t arg e t t t e n s i o n m w i n c h r w i n c h t v o u t s 0 0 when the solutions of equation 13 are obtained the umbilical force including tension and drag force can be converted into the global coordinates and used to solve the asv and rov hydrodynamic issues the overall workflow of this coupled model is illustrated in fig 5 3 case study 3 1 system description for this case study two specific sub systems have been selected the l3 harris asv cw7 l3harris 2020 and the falcon rov seaeye 2020 the two are coupled through a winch system installed on the asv the details of this system are illustrated in the following section 3 1 1 asv sub system cw7 is a multi role work class asv which is suitable for offshore tasks such as subsea positioning surveying and environmental monitoring c w 7 integrates a variety of payloads including multibeam ultra short baseline usbl sondes and acoustic doppler current profilers adcp via exchangeable payload frames the details of cw7 can be seen in fig 6 and table 2 3 1 2 rov the modelled rov is pictured in fig 7 and properties are summarised in table 3 properties of the modelled rov the rov is propelled by four vectored thrusters with maximum thrusts of forward 50 kgf lateral 28 kgf and vertical 13 kgf 3 1 3 winch and umbilical the properties of the winch system that is designed to be installed on the asv and the umbilical are summarised in table 4 which lists the physical characteristics of umbilical that is used in the winch system 3 1 4 model illustration an overview of the modelling scope is provided in fig 8 the numerical simulation includes a frequency and a time domain model the hydrodynamic forces of the asv are calculated as the sum of diffraction including excitation and froude krylov forces and radiation forces obtained by aqwa a frequency domain boundary element method solver the simplified cad drawing used as an input for aqwa to calculate the response amplitude operators raos is also shown in fig 8 the physical properties of rovs and umbilical configurations are implemented in a fully coupled nonlinear hydrodynamic time domain model orcaflex to estimate the response forces and loads experienced by the vessel rov and the umbilical cable shown in fig 9 3 1 5 validation this paper draws on data from numerical and operational measurements from field deployments cases are illustrated in fig 10 the environment of the sea trial is not exactly measured but is defined by a jonswap spectrum with a significant wave height h s 0 3 m peak wave period t p is 3s based on the location of the sea trial a motion sensor installed on the cw7 prototype captured the hydrodynamic response in pitch and roll results from both sea trial and numerical model have been converted into the frequency domain via fourier transform allowing a direct comparison fig 11 presents the dominant motions for each case roll for case a pitch for case b and roll and pitch for case c for all cases the spectrum bands of sea trial and simulations are in acceptable agreement while the band for the sea trial is slightly wider this may be caused by the 2nd order wave drifting during the sea trial which is challenging to replicate in the numerical simulations exactly however differences in the amplitude are more significant the effects caused by liquid viscosity can potentially influence the roll amplitude this effect will result in an apparent lower peak roll amplitude during the sea trial fig 11 a and c the pitch response is less sensitive to the viscosity fig 11 b and d a higher peak is observed in the sea trial which may be caused by different incident waves in the sea trial compared to simulations the irregular wave used in the numerical model is similar but due to the stochasticity not identical to the sea trial conditions ideally the asv rov system should be validated our current sea trial data only include the asv roll and pitch motion as a result a stricter validation based on the basin test will be conducted in further research 4 results the numerical cases table 5 include a range of targets and environment conditions for the given asv rov to explore i the rov performance in different tidal current and target scenarios ii the stability of the asv iii umbilical tension and iv the required winch power in all cases the approaching waves and currents have the identical direction which is heading to the asv where h s is the significant wave height t p is the peak wave period fig 12 presents the rov position coordinates to reach a target location of z coordinate 30 m x coordinate 10 m and y coordinate 0 m to reduce computational intensity of the model the incident wave and currents original are heading parallel to the asv besides the y coordinate of rov target in the fig 12 is zero which means the umbilical tension on the y direction is almost 0 too as a result the drift is almost 0 the time series include launch holding and recovery stages the asv s drifting motions are shown in fig 13 4 1 tidal current capacity of falcon tidal capacity i e what is the threshold tidal current the rov is able to overcome to reach its target is the critical parameter for the rov design particular for the launch stage the tidal capacity of falcon launch stage is explored with 30 m 50 m and 150 m water depth the x and y coordinates of target positions are identical 10 m 0 m while the z coordinates are 25 m 45 m and 145 m for each water depth the tidal current is defined by the power law method and its direction is fixed and does not vary with depth the current speed s c varies with the water depth 26 s c s b s f s b z z b z f z b 1 p where s f and s b are the current speeds at the surface and the seabed respectively p is the power law exponent z f is the z coordinate of the still water level z b is the z coordinate of the seabed the falcon tidal current capacity is shown in fig 14 the current heading to the falcon is regarded as an extreme situation the results determine that the current capacity is 1 75 m s during 30 m and 50 m water depth and this capacity will reduce to 1 5 m s when the water depth is 70m and 1 25 m s with 150 m water depth 4 2 stabilities of cw7 4 2 1 response amplitude operator the stability of cw7 in the frequency domain is discussed in terms of its motion rao bonaschi et al 2012 fig 15 shows the raos of cw7 for different wave directions which are identical to that in the sea trial while the velocity of the vessel is set to be zero it can be observed that differences in the peak heave rao between heading 180 and heading 45 are small 0 39 hz and 0 42 hz when the approaching wave direction is 90 the heave rao has the largest discrepancy and offset the wave direction also influences the frequency of the peak heave rao it can be determined that the frequency relating the peak rao is higher under a larger intersection angle between vessel and incident wave the rotation rao pitch or roll rao is quite small for cases with heading 180 or heading 90 the peak pitch rao with heading 90 and roll rao with heading 180 are all below one therefore the rotation rao is only discussed with two incident wave directions similar to the heave rao the wave approaching direction affects both the vessel peak amplitudes and peak frequency in pitch and roll cases 4 2 2 control coefficients the cw7control forces are defined by the control coefficients c 1 c 2 in eq 4 and the drifting distance from the target position this section discusses c 1 c 2 under an extreme wave condition h s 1 82 m t p 4 s and the drifting distance is normalised by the cw7 length and beam respectively fig 16 exhibits the normalised drifting under surge and sway during cases with heading 180 and 90 27 r s u r g e 0 5 d s u r g e p d s u r g e n v e s s e l l e n g t h 28 r s w a y 0 5 d s w a y p d s w a y n v e s s e l b e a m it is shown that when the control coefficient exceeds a specified value here 1000 kn m for surge and 800 kn m for sway vessel drifting will be very small and steadily decreasing towards 0 the normalised maximum control force f n m a x is illustrated in fig 17 29 f n m a x f max v e s s e l w e i g h t the changing trend of f n m a x is similar to the surge and sway drifting when the coefficient is relatively small the f n m a x will be very large 4 3 umbilical and winch 4 3 1 umbilical tension the wave condition is identical to that in section 4 2 2 h s 1 82 m t p 4 s with a 1 m s tidal current fig 18 and fig 19 present the tension on the umbilical during the launch and recovery stages respectively 4 3 2 winch power the winch control strategy employs two control methods based on i maintaining the pay out rate and ii maintaining the tension of the umbilical the average winch power is calculated by p w i n c h 0 t f t e n s i o n t v o u t t d t t fig 20 shows the winch performance with a pay out rate control method p w i n c h increases and converges towards a constant value for higher pay out rates while the umbilical tension decreases significantly if the pay out rate is close to the diving rate of the rov the interaction force between the umbilical and the rov will be reduced leading to both smaller maximum and smaller average tension see fig 20 b considering the maximum allowable tension 0 1 m s pay out rate seems to be the most suitable choice for this particular winch system the winch performance under tension control is presented in fig 21 although the pay out rate has an apparent decrease in increased target tension the winch power still increases 5 discussion this study used a time and frequency domain method to discuss the hydrodynamic performance of the asv rov system with the help of this model several nonlinear factors such as coupled effects between the asv and rov control strategies of the rov and the winch system could be taken into consideration results presented in section 4 demonstrated that these nonlinear coupled factors had a considerable impact on the capability and performance of the asv rov system for the whole asv rov system the results shown in figs 12 and 13 demonstrated the launch and recovery control strategy used in this study is feasible for the chosen system the modelling approach is applicable to assess similar system design and capacity questions when the rov reaches the target position on the x direction the control method can maintain the position of rov on the x direction for different water depths the fluctuation of the rov position caused by the relative motion between the asv and rov always remains at a low level less than 2 of target water depth during the whole launch and recovery phase the drifting of the asv is not significant with a linear control force for the rov its tidal current capacity shows a strong dependency with regards to the target water depth when the target depth of the rov is larger the rov needs a longer umbilical the drag force caused by the tidal current will be more significant leading the current capacity of the rov to decreases this capacity modelling is important to determine the correct rov for a specific site mission target depth for given environmental conditions regarding the asv the frequency of the peak rao depends on the incident wave directions this is believed to be caused by the coupled added mass of the cw7 on the different dofs such as a 12 a 13 etc in the frequency model furthermore the roll rao of the cw7 exhibits the most significant amplitude a possible explanation is that the model used in this study is based on the potential flow theory therefore nonlinear effects caused by the liquid viscosity could not be considered without any basin tests results and these effects are the most significant at the natural roll frequency the results of the asv drifting behaviour show that the large control coefficients effectively the vessel thrusts can reduce both drifting distance and maximum amplitude of the control force f n m a x as described in section 2 the wave load on the cw7 is the sum of the radiation and excitation wave forces the large coefficients will decrease the drifting velocity of the vessel which can decrease the wave radiation force in these cases the control force mainly dominates the wave diffraction forces for the winch system the maximum tension appears before t 100 s for the sudden relative motion between asv and rov caused by the steep wave during the launch stage the maximum tension is still smaller than the maximum allowable tension 3 k n during this period if the time exceeds 100s the umbilical is long enough to buffer these relative motions maintaining the tension amplitude below 1 5 k n see fig 18 for the launch stage the extreme tension also appears when the rov is close to the asv in this strategy a down control force is used to reduce this extreme tension fig 19 compares the tension during cases with non up and down vertical control force the results demonstrate that a down control force is a feasible solution to limit the sudden peak tension the maximum tension amplitude is less than half of max allowable tension 3 k n cases with up and no control force both exceed the umbilical max allow tension 3 k n while still below the breaking tension slight negative tension i e compression can be observed in up and no forces cases which should ideally be avoided to maintain umbilical integrity comparing the two control methods of the winch the tension control allows the rov to reach the target location quicker whilst only requiring slightly higher power the umbilical tension in the tension control also can be limited to a relatively lower level to enhance the stability of the system the tension control seems to be more feasible during the numerical simulation however other practical engineering factors such as the maximum pay out rate and the overall system cost should be considered for the system engineering as well this coupled model and research methods presented in this study have provided some new insights into the asv rov design and application however the range of applicability of the present model should also be stated explicitly here the model is based on the potential flow theory thus the additional hydrodynamic viscous damping of the asv should be quantified through experimental decay tests in the future additionally the rov hydrodynamic coefficients will be changed by asv especially when the rov is close to the asv this paper did not consider this change in current stage a future experiment to quantify the exact coefficients is also required the control method of the rov should be optimised based on the different target position and environmental conditions new control methods e g based on machine learning could be tested and employed when sufficient data from sea trials are obtained anderlini et al 2018 kim and yu 2016 finally more details of the winch such as the damping the mechanical energy loss and the dead band should be taken into consideration to refine the model 6 conclusions this paper evaluated the hydrodynamic performances of an unmanned vessel system for an entire launch and recovery cycle the hydrodynamic time domain model of the asv rov coupled system is described in detail enabling similar design and engineering studies for coupled systems in the presented model different boundary conditions are used to solve the dynamics of the umbilical in order to get winch performance under different control methods the results present a specific the case study for a system including the asv cw7 rov falcon umbilical and winch results of the case study demonstrate the feasibility of the control strategy and system performance key findings include a the tidal current capacity of the rov shows significant dependency on its target depth a lager target depth will lead to a smaller rov current capacity for the falcon its capacity is 1 75 m s during 30 m and 50 m water depth and it will reduce to 1 5 m s when the water depth is 70m it reduces even further to 1 25 m s for the 150 m water depth b during the launch stage the maximum umbilical tension caused by the steep approaching waves appears when the t 100 s once sufficient cable length is paid out the loads are buffered decoupled for the recovery stage the down control force offers a feasible solution to reduce the peak tension caused by the sudden relative motion between asv and rov c by comparing the pay out rate and tension control methods the tension control allows the rov to reach the target faster with a slightly higher power these results demonstrate that the coupled effects between asv and rov significantly influence the whole system stability and capacity additionally the winch exhibits the different tension range and power consumption under two control methods the methods and finding of this study will be able to inform the engineering design and modelling of such coupled systems in order to progress towards autonomous launch and recovery operations credit authorship contribution statement chenyu zhao conceptualization methodology software data curation writing review editing writing philipp thies investigation validation johanning lars writing original draft reviewing editing james cowles writing original draft reviewing editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study has received funding through the project autonomous robotic intervention system for extreme maritime environments arise stage 2 as part of the industry strategy challenge fund isfc funded by innovate u k ukri project reference 104831 the support through orcina through the provision of their orcaflex software also kindly acknowledged the second author would also like to acknowledge funding through the epsrc supergen ore hub ep s000747 1 
20680,this paper focusses on the hydrodynamic performance of an unmanned vehicle system consisting of a remotely operated underwater vehicle rov that has to be launched and recovered autonomously from an autonomous surface vehicles asv the hydrodynamic model of the asv rov coupled system is described in detail and solved numerically the paper seeks to assess the overall performance of the asv rov system including the stability of the asv the rov tidal current capacity and the required power of the launch and recovery winch system the results demonstrate that this asv rov system can complete the launch holding and recovery tasks meeting stability for the given winch power requirements the tidal current capacity of the rov decreases with a larger target water depth the maximum rov umbilical tension is observed during steep wave instances when the rov is in proximity to the asv a down control force is demonstrated to be a suitable solution to limit the maximum tension within the umbilical rated force limits this paper presents the methods and considerations for working towards a fully autonomous asv rov system capable of autonomous inspection and maintenance missions the work will be useful for practitioners and researcher working on autonomous offshore systems keywords unmanned vehicle system analytical model rov asv numerical model winch 1 introduction in an effort to reduce both human risk exposure and cost unmanned surface vehicles usvs offer a possible practical solution generally autonomous vessels can be categorised into autonomous surface vehicles asvs and remotely operated underwater vehicles rovs kumar and kurmi 2018 the application areas of asv have expanded into scientific research roberts and sutton 2006 yan et al 2010 environmental missions švec et al 2014 and ocean resource exploration bertram 2008 pastore and djapic 2010 for example a double hull asv was designed to perform river missions and estuarine scenarios including bathymetry and environmental monitoring ferreira et al 2007 a new asv concept operating in submerged conditions was demonstrated in sea trials successfully implementing larger payloads of 300 kg and a more flexible layout inside the vehicle sager et al 2008 rovs are controlled through a crew or a remote system and are connected with a base station or a vessel by an umbilical which supplies the power and data signal connectivity christ and wernli sr 2011 considering their purpose rovs are categorised into inspection class and intervention class vehicles capocci et al 2017 the intervention class usually has a large mass 200 kg 5 000 kg and can operate in very deep water up to 6 000m but are high cost in most cases shown in table 1 the inspection class rov meets the mission requirements the rated depth of this class device is usually less than 300m owing to its relatively smaller mass the inspection class rov can be manually recovered bruno et al 2015 frost et al 1996 the challenge addressed by this work is to develop a genuinely autonomous couple between the asv and the rov a range of different control methods has been devised and implemented to support rovs directly from an asv autonomously these methods include linear methods such as decoupled control healey and marco 1992 pid control healey and lienard 1993 linear quadratic gaussian control field et al 2000 and nonlinear methods like sliding mode control cristi et al 1990 adaptive control li and lee 2005 in this work asv and rov are connected by the launch and recovery system lars the lars is usually equipped with a tether management system tms in trslic et al 2020 the cage type tms with an rov is translated by lars as a heave motion other systems such as conte et al 2017 are designed without the docking station but are instead equipped with video ray micro rovs to launch and recover the rov directly the coupled effects caused by the lars operations could significantly influence the hydrodynamic performances of both asv and rov sivčev et al 2018 however in the available literature the two systems are usually studied separately for instance chin and lau 2012 determined the hydrodynamic damping of a complex shaped rov by numerical and physical means eidsvik 2015 applies basic empirical coefficients to obtain the hydrodynamic parameters of the rov and this empirical method is tested on the five rovs with different shapes compared with the experimental results it was believed that the empirical method accurately evaluates the added mass of the rov while slightly overestimating its radiation damping julca avila et al 2012 determined the morison s equation inertia and drag coefficients of an rov via a basin test alvarez et al 2009 optimised the hydrodynamic performance of the rov hull when it is near the water surface the coupled effects between the umbilical and rov are discussed in zhu et al 2008 but the influences caused by the asv are not explicitly accounted for in their study the rov is regarded as a 6 dof lumped buoy the umbilical connected with the rov has a constant length 300m without any pay out in speed both physical and numerical results showed that the tidal current could significantly affect the umbilical tension this paper evaluates the hydrodynamic performance of an asv rov system as well as its launch and recovery control strategy a fully nonlinear numerical model based on the potential flow theory is employed to incorporate the coupled effects between the asv the rov and the connecting umbilical the paper is organised as follows section 2 lays out the analytical model of the asv rov coupled system section 3 introduces the asv system and the numerical model used in the case study section 4 presents the hydrodynamic performance results of the asv rov system section 5 discusses the main findings in light of potential industrial applications and further r d requirements section 6 concludes with the main findings and outcomes 2 analytical modelling of the asv rov coupled system 2 1 coordinate systems the asv rov coupled system is represented in four coordinates systems i the global coordinate ii the local coordinates of the asv iii local coordinates of the rov and iv the local coordinate along the umbilical fig 1 the relationship between the global coordinates and the asv rov local coordinates is described in terms of euler angles fossen 1999 for the rov 1 x r o v y r o v z r o v x y z r r o v θ r o v ϕ r o v γ r o v with r r o v θ r o v ϕ r o v γ r o v cos ϕ r o v cos γ r o v cos θ r o v sin γ r o v sin θ r o v sin ϕ r o v cos γ r o v sin θ r o v sin γ r o v cos θ r o v sin ϕ r o v cos γ r o v cos ϕ r o v cos γ r o v cos θ r o v sin γ r o v sin θ r o v sin ϕ r o v cos γ r o v sin θ r o v sin γ r o v cos θ r o v sin ϕ r o v cos γ r o v sin ϕ r o v sin θ r o v cos ϕ r o v cos θ r o v cos ϕ r o v similarly the local coordinate asv is 2 x a s v y a s v z a s v x y z r a s v θ a s v ϕ a s v γ a s v with r a s v θ a s v ϕ a s v γ a s v cos ϕ a s v cos γ a s v cos θ a s v sin γ a s v sin θ a s v sin ϕ a s v cos γ a s v sin θ a s v sin γ a s v cos θ a s v sin ϕ a s v cos γ a s v cos ϕ a s v cos γ a s v cos θ a s v sin γ a s v sin θ r o v sin ϕ r o v cos γ r o v sin θ a s v sin γ a s v cos θ a s v sin ϕ a s v cos γ a s v sin ϕ a s v sin θ a s v cos ϕ a s v cos θ a s v cos ϕ a s v where θ ϕ γ are the pitch roll and yaw angles of asv and rov respectively in the umbilical local coordinate t is the tangent to the umbilical in the direction of paying in out from the winch and b is on the x y plane following the transform method form feng and allen 2004 allows to convert the local coordinate to the global coordinate based on three rotations a a counter clockwise rotation through an angle α about the z axis to bring the x axis into the plane of t and n b a counter clockwise rotation about the new the x axis through π 2 to bring the z axis into coincidence with b c a clockwise rotation about β through b to bring x and y into coincidence with t and n thus the relationship between these two coordinates can be presented as 3 t n b x y z w α β with w α β cos α cos β cos sin β sin α sin α cos β sin α sin β cos α sin β cos β 0 2 2 asv the analytical model of the asv is illustrated in fig 2 owing to the control forces and the umbilical force are nonlinear the governing equations yu et al 2016 are presented under the time domain as follows 4 m m ξ t t h t τ ξ τ d τ k c ξ t f u t f e t where m m is the mass matrix under 6 dofs including the added mass matrix for ω m h t is the retardation function matrix which can be obtained from the convolution integrals of frequency dependent damping matrix h d presented by cummins 1962 greco et al 2009 k is the hydrostatic stiffness matrix c is the control force matrix ξ is the asv s motion equation f u is the umbilical s force matrix and f e is the wave excitation force matrix the hydrodynamic coefficients used in the eq 4 have considered contributions and interactions from all 6 dofs which are calculated by a boundary solver aqwa the hydrostatic stiffness matrix has been added into the control force matrix and is written as k 0 0 0 0 0 0 0 0 ρ g a b 0 0 0 0 0 0 ρ g i 2 ρ g i 1 0 0 0 ρ g i 2 0 0 ρ g i 1 0 0 0 ρ g i 22 i 3 v m g z z 0 ρ g i 12 ρ g i 1 v m g x x 0 ρ g i 21 ρ g i 11 i 3 v m g z z 0 ρ g i 2 v m g y y 0 0 0 0 c c 1 x x 0 0 0 0 c 2 y y 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 where ρ is the water density a b is the heave area of the ship i i is the rotational inertia under the i th degree of freedom dof i i j is the inertia under the i th dof due to the j th dof x y z are the displacements along the x y z direction z 0 is the static draft of the ship x 0 y 0 are the desired holding positions under sway and surge v is the ship s displaced volume c 1 c 2 are the control force coefficients during the time domain calculation if c 1 c 2 are large enough and the time step is sufficiently small the ship will be limited at the desired location f e is the sum of the froude krylov force f f k and the diffraction force f d caused by the incident and diffracted waves respectively falnes and kurniawan 2020 5 f i j i ω ρ s w e t ϕ i x n j d s 6 f d j i ω ρ s w e t ϕ d x n j d s where ω is the wave frequency ϕ i is the incident wave potential ϕ d is the diffraction wave potential 2 3 rov fig 3 presents the analytical model of the 6 dofs rov control forces and moments as a result the rov in this paper is regarded as a 6 dofs buoy the associate mathematical model is presented in fang et al 2007 the thrust control methods of rov were presented in the zhao et al 2020 for the launch stage the rov is firstly driven with full thrusters so that it can quickly reach a depth to prevent it from colliding with the asv then the control method on the x y direction offers a gentle way for the rov s propeller force to increase as a function of its depth to the asv 7 f l x x t a r g e t x r o v k l x l o g 2 z a s v z r o v 8 f l y y t a r g e t y r o v k l y l o g 2 z a s v z r o v when f l x and f l y are larger than the maximum thrust of rov the maximum thrusts will replace them the z direction force f l z includes a constant component c z that permits to approach the target plus a gaussian function around the target allowing the force to increase a lot when approaching the target in order to maintain the rov s depth similar to the f l x and f l y f l z will still be limited by the maximum rov thrust 9 f l z c z k l z 1 5 e z a s v z r o v 2 where x t a r g e t y t a r g e t z t a r g e t are the target coordinates in each direction x a s v y a s v z a s v are the displacement of asv in each direction x r o v y r o v z r o v are the displacements of rov in each direction k l x k l y k l z are the launch control coefficients in each direction during the holding or following stage the control force is calculated as here the current direction is on the x direction and heading to the rov 10 f f o l l o w i n g 0 5 π s r d c r o v v c s 0 75 v a s v x 2 where s r d is the drag area of the rov c r o v is the drag force coefficient on the x direction v c s is the current speed on the surface v a s v x is the velocity of asv in the x direction with this control force the rov can maintain the required distance to the asv under the current and drag force load during the recovery stage the control force is defined as a nonlinear relationship which permits to be low when the rov is far from the recovery target it will become higher limited by the maximum rov thrust when it approaches the target and low again when it reaches the target without breaking the force continuity the force is presented as follows 11 f r x e x a s v x r o v 2 10 k r x x a s v x r o v 12 f r y y a s v y r o v k r y when the rov is far from the asv f r z 0 however if the rov is in close proximity here the distance is less than 10 m to the asv f r z is half the maximum thrust of the propeller to keep the tension on the umbilical preventing a sudden relative motion and consequential snap loads between asv and rov where the k r x k r y is the recovery control coefficients on the x and y directions when the rov is close enough to the asv the f r z will be zero to prevent a collision 2 4 umbilical and winch the umbilical and winch system couples the asv and the rov thus the crucial task is to determine the umbilical dynamics according to ablow and schechter 1983 umbilical dynamics can be generally expressed as 13 a y s b y t q with a 1 0 0 0 0 0 0 1 0 0 v b cos β v n 0 0 1 0 v b sin β v t 0 0 0 1 v n sin β v t cos β 0 0 0 0 0 t t e n s i o n cos β 0 0 0 0 0 0 t t e n s i o n b m u e v t 1 e t t e n s i o n m u 0 0 m u 1 v b ρ s u j b cos β m u 1 v n ρ s u j n e 0 0 0 0 0 0 0 0 0 0 1 e t t e n s i o n 0 0 0 0 1 e t t e n s i o n cos β 0 e m u 1 v b ρ s u j b 1 e t t e n s i o n 0 0 m u 1 m u 1 v n ρ s u j n sin β m u v t cos β 0 e m u 1 v n ρ s u j n 1 e t t e n s i o n 0 m u 1 0 m u 1 v b ρ s u j b sin β m u v t q w u sin β 1 2 ρ d 1 e t t e n s i o n π c t u t u t 0 0 0 1 2 ρ d 1 e t t e n s i o n c n u b u b 2 u n 2 ρ s u j b w u cos β 1 2 ρ d 1 e t t e n s i o n c n u n u b 2 u n 2 ρ s u j n where y is the dynamic vector of the umbilical y s t t t e n s i o n v t v n v d α β t s is the arc length of the cable between the asv and rov t is the time v u v t v n v d t is the umbilical velocity matrix in its local coordinate t t e n s i o n k u δ l k u is the spring coefficient δ l is the deformation of the umbilical m u is the mass per unit length of umbilical s u is the cross sectional area of the unstretched umbilical e is the 1 e s u e is the young s modulus m u 1 denotes m u ρ s u the tidal current speed matrix in the umbilical coordinate is j u j t j n j d t and the relative speed between umbilical and current can be written as v u j u u t u n u d t w u is the m u ρ s u g g is the gravity acceleration to obtain the solution of equation 13 six boundary conditions will be needed the two ends of the umbilical share the pay out in speed and the rov speed respectively thus three boundary conditions are obtained for the rov connection point the rov speed angular speed on the t n b can be denoted as 14 v r o v t n b v r o v t v r o v n v r o v b t 15 ω r o v u r o v p i t c h v r o v r o l l w r o v y a w t according to the 1 and 3 the relationship between rov and umbilical coordinate could be expressed as 16 t n b x r o v y r o v z r o v r r o v t θ r o v ϕ r o v γ r o v w α β in terms of 14 16 the boundary conditions three boundaries of rov connected point could be obtained 17 v r o v c o n n e c t 0 t v r o v t n b ω r o v r r o v r r o v θ r o v ϕ r o v γ r o v w α β here the length of umbilical at this point is considered as 0 r r o v is the distance between the mass centre and the connecting point on the rov at the winch connected point the umbilical speed at b n direction is zero 18 v n w i n c h c o n n e c t s t 0 19 v b w i n c h c o n n e c t s t 0 the last boundary condition is obtained through the dynamic equation of the winch based on newton s law 20 j w i n c h v t w i n c h c o n n e c t s t f d r i v e t t e n s i o n f r e s i s t a n c e r w i n c h where j w i n c h is the moment of inertia of the drum f r e s i s t a n c e is the resistance of the drum r w i n c h is the radius of the drum the six boundary conditions 16 to 20 can be used to solve the equation 13 in the real sea environment the v t w i n c h c o n n e c t s t is always non zero and dependent on the winch control method the boundaries and solutions with a non zero v t w i n c h c o n n e c t s t are described in feng and allen 2004 in this present paper two different methods are used see also fig 4 1 the first method pay out control is to maintain the pay out rate v o u t of the umbilical as a constant value and then to calculate the winch drive force f d r i v e in the umbilical at any time 2 the second method tension control aims to control the tension and to determine the corresponding pay out rate respectively for the pay out control 21 v t w i n c h c o n n e c t s t v o u t as a result the v t w i n c h c o n n e c t s t is 0 the winch drive force is 22 f d r i v e t t e n s i o n f r e s i s t a n c e the resistance of the winch could be presented as 23 f r e s i s t a n c e d d b c o u t v o u t d o u t v o u t 2 where d d b is the winch drive dead band c o u t are the winch drive damping terms for pay out d o u t are the winch drive drag terms for pay out for the tension control method 24 f d r i v e f t arg e t f r e s i s t a n c e where f t a r g e t is the target tension on the umbilical according to equations 6 8 and j w i n c h m w i n c h r w i n c h 2 25 v o u t s t f t arg e t t t e n s i o n m w i n c h r w i n c h t v o u t s 0 0 when the solutions of equation 13 are obtained the umbilical force including tension and drag force can be converted into the global coordinates and used to solve the asv and rov hydrodynamic issues the overall workflow of this coupled model is illustrated in fig 5 3 case study 3 1 system description for this case study two specific sub systems have been selected the l3 harris asv cw7 l3harris 2020 and the falcon rov seaeye 2020 the two are coupled through a winch system installed on the asv the details of this system are illustrated in the following section 3 1 1 asv sub system cw7 is a multi role work class asv which is suitable for offshore tasks such as subsea positioning surveying and environmental monitoring c w 7 integrates a variety of payloads including multibeam ultra short baseline usbl sondes and acoustic doppler current profilers adcp via exchangeable payload frames the details of cw7 can be seen in fig 6 and table 2 3 1 2 rov the modelled rov is pictured in fig 7 and properties are summarised in table 3 properties of the modelled rov the rov is propelled by four vectored thrusters with maximum thrusts of forward 50 kgf lateral 28 kgf and vertical 13 kgf 3 1 3 winch and umbilical the properties of the winch system that is designed to be installed on the asv and the umbilical are summarised in table 4 which lists the physical characteristics of umbilical that is used in the winch system 3 1 4 model illustration an overview of the modelling scope is provided in fig 8 the numerical simulation includes a frequency and a time domain model the hydrodynamic forces of the asv are calculated as the sum of diffraction including excitation and froude krylov forces and radiation forces obtained by aqwa a frequency domain boundary element method solver the simplified cad drawing used as an input for aqwa to calculate the response amplitude operators raos is also shown in fig 8 the physical properties of rovs and umbilical configurations are implemented in a fully coupled nonlinear hydrodynamic time domain model orcaflex to estimate the response forces and loads experienced by the vessel rov and the umbilical cable shown in fig 9 3 1 5 validation this paper draws on data from numerical and operational measurements from field deployments cases are illustrated in fig 10 the environment of the sea trial is not exactly measured but is defined by a jonswap spectrum with a significant wave height h s 0 3 m peak wave period t p is 3s based on the location of the sea trial a motion sensor installed on the cw7 prototype captured the hydrodynamic response in pitch and roll results from both sea trial and numerical model have been converted into the frequency domain via fourier transform allowing a direct comparison fig 11 presents the dominant motions for each case roll for case a pitch for case b and roll and pitch for case c for all cases the spectrum bands of sea trial and simulations are in acceptable agreement while the band for the sea trial is slightly wider this may be caused by the 2nd order wave drifting during the sea trial which is challenging to replicate in the numerical simulations exactly however differences in the amplitude are more significant the effects caused by liquid viscosity can potentially influence the roll amplitude this effect will result in an apparent lower peak roll amplitude during the sea trial fig 11 a and c the pitch response is less sensitive to the viscosity fig 11 b and d a higher peak is observed in the sea trial which may be caused by different incident waves in the sea trial compared to simulations the irregular wave used in the numerical model is similar but due to the stochasticity not identical to the sea trial conditions ideally the asv rov system should be validated our current sea trial data only include the asv roll and pitch motion as a result a stricter validation based on the basin test will be conducted in further research 4 results the numerical cases table 5 include a range of targets and environment conditions for the given asv rov to explore i the rov performance in different tidal current and target scenarios ii the stability of the asv iii umbilical tension and iv the required winch power in all cases the approaching waves and currents have the identical direction which is heading to the asv where h s is the significant wave height t p is the peak wave period fig 12 presents the rov position coordinates to reach a target location of z coordinate 30 m x coordinate 10 m and y coordinate 0 m to reduce computational intensity of the model the incident wave and currents original are heading parallel to the asv besides the y coordinate of rov target in the fig 12 is zero which means the umbilical tension on the y direction is almost 0 too as a result the drift is almost 0 the time series include launch holding and recovery stages the asv s drifting motions are shown in fig 13 4 1 tidal current capacity of falcon tidal capacity i e what is the threshold tidal current the rov is able to overcome to reach its target is the critical parameter for the rov design particular for the launch stage the tidal capacity of falcon launch stage is explored with 30 m 50 m and 150 m water depth the x and y coordinates of target positions are identical 10 m 0 m while the z coordinates are 25 m 45 m and 145 m for each water depth the tidal current is defined by the power law method and its direction is fixed and does not vary with depth the current speed s c varies with the water depth 26 s c s b s f s b z z b z f z b 1 p where s f and s b are the current speeds at the surface and the seabed respectively p is the power law exponent z f is the z coordinate of the still water level z b is the z coordinate of the seabed the falcon tidal current capacity is shown in fig 14 the current heading to the falcon is regarded as an extreme situation the results determine that the current capacity is 1 75 m s during 30 m and 50 m water depth and this capacity will reduce to 1 5 m s when the water depth is 70m and 1 25 m s with 150 m water depth 4 2 stabilities of cw7 4 2 1 response amplitude operator the stability of cw7 in the frequency domain is discussed in terms of its motion rao bonaschi et al 2012 fig 15 shows the raos of cw7 for different wave directions which are identical to that in the sea trial while the velocity of the vessel is set to be zero it can be observed that differences in the peak heave rao between heading 180 and heading 45 are small 0 39 hz and 0 42 hz when the approaching wave direction is 90 the heave rao has the largest discrepancy and offset the wave direction also influences the frequency of the peak heave rao it can be determined that the frequency relating the peak rao is higher under a larger intersection angle between vessel and incident wave the rotation rao pitch or roll rao is quite small for cases with heading 180 or heading 90 the peak pitch rao with heading 90 and roll rao with heading 180 are all below one therefore the rotation rao is only discussed with two incident wave directions similar to the heave rao the wave approaching direction affects both the vessel peak amplitudes and peak frequency in pitch and roll cases 4 2 2 control coefficients the cw7control forces are defined by the control coefficients c 1 c 2 in eq 4 and the drifting distance from the target position this section discusses c 1 c 2 under an extreme wave condition h s 1 82 m t p 4 s and the drifting distance is normalised by the cw7 length and beam respectively fig 16 exhibits the normalised drifting under surge and sway during cases with heading 180 and 90 27 r s u r g e 0 5 d s u r g e p d s u r g e n v e s s e l l e n g t h 28 r s w a y 0 5 d s w a y p d s w a y n v e s s e l b e a m it is shown that when the control coefficient exceeds a specified value here 1000 kn m for surge and 800 kn m for sway vessel drifting will be very small and steadily decreasing towards 0 the normalised maximum control force f n m a x is illustrated in fig 17 29 f n m a x f max v e s s e l w e i g h t the changing trend of f n m a x is similar to the surge and sway drifting when the coefficient is relatively small the f n m a x will be very large 4 3 umbilical and winch 4 3 1 umbilical tension the wave condition is identical to that in section 4 2 2 h s 1 82 m t p 4 s with a 1 m s tidal current fig 18 and fig 19 present the tension on the umbilical during the launch and recovery stages respectively 4 3 2 winch power the winch control strategy employs two control methods based on i maintaining the pay out rate and ii maintaining the tension of the umbilical the average winch power is calculated by p w i n c h 0 t f t e n s i o n t v o u t t d t t fig 20 shows the winch performance with a pay out rate control method p w i n c h increases and converges towards a constant value for higher pay out rates while the umbilical tension decreases significantly if the pay out rate is close to the diving rate of the rov the interaction force between the umbilical and the rov will be reduced leading to both smaller maximum and smaller average tension see fig 20 b considering the maximum allowable tension 0 1 m s pay out rate seems to be the most suitable choice for this particular winch system the winch performance under tension control is presented in fig 21 although the pay out rate has an apparent decrease in increased target tension the winch power still increases 5 discussion this study used a time and frequency domain method to discuss the hydrodynamic performance of the asv rov system with the help of this model several nonlinear factors such as coupled effects between the asv and rov control strategies of the rov and the winch system could be taken into consideration results presented in section 4 demonstrated that these nonlinear coupled factors had a considerable impact on the capability and performance of the asv rov system for the whole asv rov system the results shown in figs 12 and 13 demonstrated the launch and recovery control strategy used in this study is feasible for the chosen system the modelling approach is applicable to assess similar system design and capacity questions when the rov reaches the target position on the x direction the control method can maintain the position of rov on the x direction for different water depths the fluctuation of the rov position caused by the relative motion between the asv and rov always remains at a low level less than 2 of target water depth during the whole launch and recovery phase the drifting of the asv is not significant with a linear control force for the rov its tidal current capacity shows a strong dependency with regards to the target water depth when the target depth of the rov is larger the rov needs a longer umbilical the drag force caused by the tidal current will be more significant leading the current capacity of the rov to decreases this capacity modelling is important to determine the correct rov for a specific site mission target depth for given environmental conditions regarding the asv the frequency of the peak rao depends on the incident wave directions this is believed to be caused by the coupled added mass of the cw7 on the different dofs such as a 12 a 13 etc in the frequency model furthermore the roll rao of the cw7 exhibits the most significant amplitude a possible explanation is that the model used in this study is based on the potential flow theory therefore nonlinear effects caused by the liquid viscosity could not be considered without any basin tests results and these effects are the most significant at the natural roll frequency the results of the asv drifting behaviour show that the large control coefficients effectively the vessel thrusts can reduce both drifting distance and maximum amplitude of the control force f n m a x as described in section 2 the wave load on the cw7 is the sum of the radiation and excitation wave forces the large coefficients will decrease the drifting velocity of the vessel which can decrease the wave radiation force in these cases the control force mainly dominates the wave diffraction forces for the winch system the maximum tension appears before t 100 s for the sudden relative motion between asv and rov caused by the steep wave during the launch stage the maximum tension is still smaller than the maximum allowable tension 3 k n during this period if the time exceeds 100s the umbilical is long enough to buffer these relative motions maintaining the tension amplitude below 1 5 k n see fig 18 for the launch stage the extreme tension also appears when the rov is close to the asv in this strategy a down control force is used to reduce this extreme tension fig 19 compares the tension during cases with non up and down vertical control force the results demonstrate that a down control force is a feasible solution to limit the sudden peak tension the maximum tension amplitude is less than half of max allowable tension 3 k n cases with up and no control force both exceed the umbilical max allow tension 3 k n while still below the breaking tension slight negative tension i e compression can be observed in up and no forces cases which should ideally be avoided to maintain umbilical integrity comparing the two control methods of the winch the tension control allows the rov to reach the target location quicker whilst only requiring slightly higher power the umbilical tension in the tension control also can be limited to a relatively lower level to enhance the stability of the system the tension control seems to be more feasible during the numerical simulation however other practical engineering factors such as the maximum pay out rate and the overall system cost should be considered for the system engineering as well this coupled model and research methods presented in this study have provided some new insights into the asv rov design and application however the range of applicability of the present model should also be stated explicitly here the model is based on the potential flow theory thus the additional hydrodynamic viscous damping of the asv should be quantified through experimental decay tests in the future additionally the rov hydrodynamic coefficients will be changed by asv especially when the rov is close to the asv this paper did not consider this change in current stage a future experiment to quantify the exact coefficients is also required the control method of the rov should be optimised based on the different target position and environmental conditions new control methods e g based on machine learning could be tested and employed when sufficient data from sea trials are obtained anderlini et al 2018 kim and yu 2016 finally more details of the winch such as the damping the mechanical energy loss and the dead band should be taken into consideration to refine the model 6 conclusions this paper evaluated the hydrodynamic performances of an unmanned vessel system for an entire launch and recovery cycle the hydrodynamic time domain model of the asv rov coupled system is described in detail enabling similar design and engineering studies for coupled systems in the presented model different boundary conditions are used to solve the dynamics of the umbilical in order to get winch performance under different control methods the results present a specific the case study for a system including the asv cw7 rov falcon umbilical and winch results of the case study demonstrate the feasibility of the control strategy and system performance key findings include a the tidal current capacity of the rov shows significant dependency on its target depth a lager target depth will lead to a smaller rov current capacity for the falcon its capacity is 1 75 m s during 30 m and 50 m water depth and it will reduce to 1 5 m s when the water depth is 70m it reduces even further to 1 25 m s for the 150 m water depth b during the launch stage the maximum umbilical tension caused by the steep approaching waves appears when the t 100 s once sufficient cable length is paid out the loads are buffered decoupled for the recovery stage the down control force offers a feasible solution to reduce the peak tension caused by the sudden relative motion between asv and rov c by comparing the pay out rate and tension control methods the tension control allows the rov to reach the target faster with a slightly higher power these results demonstrate that the coupled effects between asv and rov significantly influence the whole system stability and capacity additionally the winch exhibits the different tension range and power consumption under two control methods the methods and finding of this study will be able to inform the engineering design and modelling of such coupled systems in order to progress towards autonomous launch and recovery operations credit authorship contribution statement chenyu zhao conceptualization methodology software data curation writing review editing writing philipp thies investigation validation johanning lars writing original draft reviewing editing james cowles writing original draft reviewing editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study has received funding through the project autonomous robotic intervention system for extreme maritime environments arise stage 2 as part of the industry strategy challenge fund isfc funded by innovate u k ukri project reference 104831 the support through orcina through the provision of their orcaflex software also kindly acknowledged the second author would also like to acknowledge funding through the epsrc supergen ore hub ep s000747 1 
20681,since climate change impacts threaten the coastal regions of the north sea consistent sea state time series are essential for building coastal protection or offshore structures vast gaps in buoy data caused by false measurements or maintenance periods require reconstruction and forecasting of ocean waves morphodynamic changes of the ebb tidal delta etd sandbanks exert a huge impact on the local wave climate off the island of norderney germany therefore the objective of this paper is to develop a machine learning model based on long short term memory lstm neural networks for reconstruction and short and long term prediction of nearshore significant wave height swh integrating bathymetric data for the first time time series of sea state and weather data of adjacent buoys as well as bathymetric data of the etd sandbanks from 2004 to 2017 were used and the networks were tuned with bayesian hyperparameter optimization including the bathymetries improved the performance of the lstm for swh reconstruction short and long term predictions by 16 7 7 4 11 7 and 8 8 9 1 in terms of rmse respectively the lstm outperformed deep feed forward neural networks and other state of the art machine learning algorithms with an rmse of 0 069 m a parallel lstm structure p lstm is the proposed method for swh reconstruction keywords long short term memory lstm neural network machine learning wave height prediction forecasting ocean waves bayesian optimization dynamic bathymetries 1 introduction climate change impacts such as sea level rise a possible increase in storm frequency and intensity a possible trend in increasing ocean wave heights and global warming in general will become emerging challenges for coastal regions of the north sea grabemann and weisse 2008 mori et al 2013 vanem and walker 2013 furthermore storm surges are a frequently recurring and well known danger bitner gregersen et al 2018 weisse et al 2012 substantial knowledge of the sea state is therefore essential for building coastal protection or offshore structures and marine operations as well as for feeding numerical and climate models ti et al 2018 wave height is consequently one of the most important wave characteristics for such purposes teich et al 2018 and commonly measured by networks of moored wave buoys time series of such wave buoys typically have gaps due to erroneous measurements or maintenance operations londhe 2008 especially extreme events are often recorded erroneously although they are of great interest in ocean science cavaleri 2009 thus sophisticated tools for reconstructing and predicting ocean wave heights are required especially in coastal areas several complex processes influence the propagation of waves and wave height the morphodynamic change of ebb tidal delta etd sandbanks of the coastal area of norderney germany exerts a huge impact on the local wave climate jörges et al 2021 caused by ebb tidal currents the etd sandbanks are dynamically changing by migration erosion and accretion castelle et al 2007 dallas and barnard 2011 and thus influence the reconstruction and forecast of coastal wave heights by increasing the complexity of the prediction spicer bak et al 2019 the etd sandbanks are also a natural coastal protection by damping the incoming wave height especially for extreme events jörges et al 2021 niemeyer 1979 niemeyer and kaiser 1999 usually numerical models such as simulating waves nearshore swan are used for predicting irregular random waves however they are often expensive in computational costs but precise due to exact physical equations soft computing frameworks as machine learning algorithms can be an alternative in some cases abed elmdoust and kerachian 2012 fernández et al 2015 mahjoobi et al 2008 malekmohamadi et al 2011 mandal and prabaharan 2010 nitsure et al 2012 combinations of numerical modelling and soft computing techniques also exist malekmohamadi et al 2008 puscasu 2014 reikard et al 2011 artificial neural networks ann in particular are widely used nowadays for wave height reconstruction and prediction namely the feed forward neural networks ffnn as a common example deo et al 2001 deo and naidu 1999 law et al 2020 londhe and panchang 2007 peres et al 2015 zamani et al 2008 in the project moses herman et al 2007 time series of spatial wave climate data of the nearshore area of norderney were reconstructed with ffnns for the period 1962 2002 as a result numerical modelling including swan was enhanced by an efficient soft computing method herman et al 2009 berkenbrink and niemeyer 2017 analyzed a changing salinity intrusion due to estuarine waterway deepening in the german bight with ffnn james et al 2018 used ffnn with numerically modeled swan data of monterey bay and reduced the computational time by a factor 1000 compared to the physics based model ann approaches with a genetic algorithm altunkaynak 2013 and evolutionary product unit neural networks epunn durán rosal et al 2016 were also used kumar et al 2017 predicted ocean wave heights with a radial basis function rbf called minimal resource allocation network mran while stefanakos 2016 used the adaptive network based fuzzy inference system anfis furthermore approaches with extreme learning machine elm ali and prasad 2019 kumar et al 2018 and discrete wavelet transforms neural networks deka and prahlada 2012 dixit and londhe 2016 were successfully implemented for wave height forecasting however for sequential data recurrent neural networks rnn anns with feedback connections to neurons from previous time steps lecun et al 2015 are suitable and still used for wave height prediction balas et al 2004 the long short term memory lstm neural network is a specific rnn and was designed by hochreiter and schmidhuber 1997 to handle long term dependencies an lstm decides on its own weather to remember or to forget information gers et al 2000 besides the use for speech and handwriting recognition graves and jaitly 2014 graves et al 2009 machine translation wu et al 2016 image captioning aggarwal 2018 and stock price prediction kim and won 2018 lstms are already used for reconstruction and prediction of time series in various related fields such as wind speed forecasting li et al 2018 sea surface temperature prediction xiao et al 2019 solar irradiance prediction qing and niu 2018 and weather forecasting salman et al 2018 first experiments with lstm neural networks for the reconstruction and prediction of nearshore wave heights with data of the norderney coastal area were quite promising jörges 2018 jörges et al 2020 pirhooshyaran and snyder 2020 first applied a sequence to sequence neural network with lstm encoder and decoder to reconstruct and predict offshore and deep ocean wave heights of the north pacific and north atlantic ocean they achieved a reconstruction r2 of up to 0 81 at a deep ocean buoy position near los angeles fan et al 2020 used lstm neural networks for one and 6 h ahead predictions of offshore and deep ocean significant wave height and combined it with the third generation numerical wave model swan to improve the predictions 6 h ahead predictions were performed with an r2 of up to 0 97 for a deep ocean buoy east of florida kagemoto 2020 satisfactorily predicted water surface wave trains and the motion of a floating body in it with lstm neural networks while ni and ma 2020 applied a lstm neural network for the prediction of polar westerlies wave height with only few measurements available however to the best of our knowledge none of the previous studies have yet considered complex morphodynamic conditions or integrated bathymetric data for the reconstruction or prediction of ocean wave heights with lstm neural networks in addition the lstm has not yet been applied to shallow waters in nearshore areas where morphodynamic influences typically are greater thus the objective of this study was to design an lstm based reconstruction and short and long term prediction model for significant wave height including bathymetric data to overcome the challenge of morphodynamic changes in the nearshore area the reconstruction and short and long term predictions were performed on buoy measurements of neighboring buoys off the norderney coastline separated by the etd sandbanks and wind and water level parameters as well as bathymetric data of the etd sandbanks in a first step a model comparison of several machine learning methods was performed on the nearshore wave data to benchmark the lstm neural network while the proposed method was also validated on well studied offshore buoy measurements off the u s west coast in a second step the impact of including bathymetric data on model performance was investigated by experiments and further feature selections were tested the main contributions of this study are as follows a lstm neural network and an ensemble of parallel lstm networks are presented for reconstruction and short and long term prediction of nearshore wave heights bathymetric data are presented as features to improve wave height reconstruction and prediction for the first time 2 methods 2 1 research area and dataset 2 1 1 research area the research area is located in the nearshore area of the east frisian island of norderney in the german north sea fig 1 the islands juist west and baltrum east are separated from norderney by the tidal inlets norderneyer seegat and wichter ee respectively between the barrier islands high tidal currents are present which activate the sediment transport of the etd and the tidal flats the long term mean high water mhw at gauge norderney riffgat is 1 24 m above the german reference height nhn or the german mean sea level with a mean tidal range of 2 45 m the main wind direction of the research area is southwest fig 1 2 1 2 dataset buoy data of three waverider datawell haarlem the netherlands buoys were provided by the coastal research station of the lower saxony water management coastal defence and nature conservation agency nlwkn norderney table 1 while the two buoys coast ref and coast i are located north of the etd sandbanks the reef arch west and north of norderney the predicted position coast ii is located south of it and directly in front of the norderney beach fig 1 nearshore wave height at buoy coast ii thus is greatly influenced by morphodynamic processes of the etd sandbanks jörges et al 2021 niemeyer 1979 the parameters significant wave height swh mean wave period energy period and mean wave direction were calculated from the energy density spectra of the raw buoy data these data were available in half hourly resolution for the years 2004 2017 without the years 2012 2014 and with many missing values throughout the dataset table 1 fig 2 shows a sample portion of the swh at position coast i besides several data gaps in the annual record top the influence of the tides was significant in the daily record bottom wind data were provided by the german meteorological service deutscher wetterdienst dwd for the station norderney at a resolution of 10 min and water level data by the waterways and shipping administration wsa for the gauge level norderney riffgat at a resolution of 1 min all parameters were averaged to a half hourly resolution morphodynamic changes of the etd sandbanks were obtained by the bathymetries of yearly surveys which were provided by the nlwkn coastal research station and easygsh db due to the huge financial effort and time required additional survey missions by ship were not possible in this challenging area the easygsh db bathymetries and metadata were obtained from the easygsh db portal www easygsh db org hagen et al 2020 and only used after a validation process for years where no measurement data of the nlwkn coastal research station were available fig 3 shows the correlogram of relevant metric parameters significant correlations between the swh of coast ii and the other positions were found r 0 82 and r 0 83 wind speed and water level also showed correlations to the swh at coast ii with r 0 56 and r 0 48 respectively peak wave periods did not show any relevant correlations to the swh at coast ii fig 3 the feature selection was conducted according to these correlations by selecting parameters with r 0 3 to swh at coast ii parameters with low correlation coefficients also can have a high non linear influence the correlogram also provides a better insight into the structure of the dataset the feature parameters significant wave height h m 0 m of the buoys coast ref and coast i wind speed at sea m s wind direction water level m nhn the tidal phase ebb low water flood high water and the morphodynamic shape of the etd sandbanks see 2 2 were used for the reconstruction and prediction of the significant wave height h m 0 at buoy coast ii 2 1 3 data preprocessing as a preprocessing all measurement rows or time steps with at least one missing value nan of any buoy or water level and wind measurement were deleted completely then all features were min max normalized to the interval 0 1 by 1 x n x min x max x min x where x n is the normalized feature value and x the measured feature value the normalization was performed to prevent certain features from having a greater influence on the neurons input by their range alone no further data preprocessing beyond that was done in order to not manipulate the prediction results in any way ali and prasad 2019 the dataset was randomly divided into train 70 and test data 30 for every model setting or model run to obtain robust results by forcing the algorithms to work fully independent of the specific training data all error metrics given in this study see 2 5 refer to the rescaled predictions thus did not underlie the normalization and can easily be interpreted the normalization only refers to the min and max of the training data to ensure the models did not see any information e g the range of the test data during the training process 2 2 morphodynamic influences and bathymetry preprocessing since the etd sandbanks exert a huge and dynamical influence on the sea state damping in the nearshore area of norderney depending on their shape and size the damping effect varies on average by 14 better reconstruction and prediction performances were expected by including the bathymetric data jörges et al 2021 in order to avoid overfitting and to achieve a better generalization of the models a dimension reduction of the bathymetries was carried out for this purpose a one dimensional transect covering the mean etd sandbank line over all years was defined from the two dimensional measurement data fig 1 in this way both a good representation of the yearly etd sandbanks and a lower dimensional dataset by omitting unimportant information were achieved and thus used for data selection due to the different resolutions of the bathymetries the transect was divided into six equidistant sections and the mean values of each sections bottom heights were used as input for the models table 2 this feature engineering process results in a strong dimension reduction and generalization of the bathymetries already with the input data thus the error caused by the bathymetries with only annual resolution was addressed substantial variations in the characteristics of the etd sandbank within the respective years were observed while the mean bottom height of the transect over all bathymetries was 3 68 0 20 m table 2 caused by the huge difference of the measurement intervals between the bathymetries and the sea state data we matched a wave event to the bathymetry corresponding to the same measurement year this led to the greatest accuracy as the ship measurements were usually carried out during the summer month of a year nevertheless strong storm surges can lead to rapid changes of etd sandbanks and inaccuracies in matching the bathymetries to the buoy data wang et al 2012 2 3 long short term memory neural networks lstm neural networks are special rnn able to learn long term dependencies and coping with the vanishing gradient problem gers et al 2000 hochreiter and schmidhuber 1997 pascanu et al 2013 each lstm cell fig 4 consists of four units the forget gate f t input gate i t memory cell state c t and output gate o t at time t defined as 2 f t σ w f h t 1 w f x t 3 i t σ w i h t 1 w i x t 4 c t tanh w c h t 1 w c x t 5 c t f t c t 1 i t c t 6 o t σ w o h t 1 w o x t 7 h t o t tanh c t where x t h t c t w and σ are the input data hidden state temporary cell state weight matrices and sigmoid activation function respectively the operation indicates the hadamard matrix product for matrices with equal dimensions biases are not added explicitly since they can be integrated to the weight matrices the final output y t ˆ w y h t is used in the loss function eq 8 gers et al 2000 hochreiter and schmidhuber 1997 qing and niu 2018 to translate the abstract learned features into the prediction output a fully connected layer was added after the last lstm layer additionally a parallel lstm structure p lstm was designed therefore an additive resampling method similar to pirhooshyaran et al 2020 was performed to split the data for the respective parallel ensemble members the entire dataset was chronologically split into s subsets of equal size then each subset was randomly divided into a training and a test dataset as described above the proposed lstm model was trained independently on each of these training subsets concatenated with the entire training dataset to learn additional functional relations hidden in the entire dataset pirhooshyaran et al 2020 p lstm performance was evaluated on the union of all test subsets by the mean prediction of the parallel ensemble models none of the ensemble models has ever seen this test data during training for s 1 the p lstm structure is the same as the standard lstm structure of this study but trained on twice the set of training data since this leads to no new information we set s 1 with the best results obtained for s 2 the p lstm ensemble method with additive resampling in the background results in the same number of test samples as the other algorithms hence it is comparable to them 2 4 model settings in all computational runs the proposed lstm and p lstm models were always compared to a standard ffnn hastie et al 2009 a random forest rf breiman 2001 a support vector regression svr vapnik 1998 and a multiple linear regression mlr as benchmark methods found in the literature fan et al 2020 pirhooshyaran and snyder 2020 qing and niu 2018 while mlr with least squares fitting is a simple linear model that allows both a good interpretability of how the inputs affect the outputs by considering the β coefficients and low computational costs rf belongs among the more complex supervised machine learning algorithms based on several random decision trees fitted to a dataset the rf algorithm outputs a mean prediction of the ensemble each tree is grown from a random subset of the features which are used as candidates for the best binary split at each node at random by repeated selection with replacement from the training data bagging uncorrelated random trees are created the bootstrap samples left out by selection out of bag samples are used for the calculation of the prediction error breiman 2001 hastie et al 2009 svr is based on the idea of a support vector machine svm applied on regression problems using an ε sensitive loss function makes the svr robust and sparse since it is less affected by noisy inputs vapnik 2000 thus only prediction errors outside a defined ε tube with ε 0 are penalized by the l2 objective function of the coefficient vector data points around the ε tube are called the support vectors another parameter c 0 controls the regularization of the loss function for predictions outside the ε tube both ε and c were set to ε 0 08 and c 1 5 by bayesian hyperparameter optimization see 2 6 non linear functions are approximated with svr by mapping the data points to a higher dimensional feature space using a kernel function awad and khanna 2015 in this study the radial basis function kernel and the python libsvm implementation were used for calculations chang and lin 2021 a model input sequence x x 1 x k in this study consists of the last k values of all input variables x i x 1 x s where s is the number of input features since the measurements were available in half hourly resolution the k 2 last hours were used as input y y 1 y l is the output sequence for the prediction until time step t l where t denotes the current time step in this study predictions were made on the swh of the current time step l 0 the next 3 h l 6 6 h l 12 9 h l 18 and 12 h l 24 which according to the literature is an appropriate interval for short term predictions berbić et al 2017 fan et al 2020 long term predictions were made for an usual range of 24 h ahead l 48 and 48 h ahead l 96 dixit and londhe 2016 pirhooshyaran and snyder 2020 the lookback k on the input sequence was set to 6 for all models thus the last 3 h of all input features were used for the predictions especially the past wind speed and direction the fetch is crucial for the further propagation of the sea state since the development of ocean waves takes a certain time holthuijsen 2007 nitsure et al 2012 every setting consisting of a specific statistical model and the predicted time step l were calculated in an ensemble of three independent runs to cope with random variations in the performance of the training process and the split in training and testing data a robust model can only be assumed if the variation of the error metrics around the mean prediction error is small the neural networks were trained for 100 epochs each all calculations were performed with python 3 8 and tensorflow 2 on an intel xeon gold 6146 cpu 12 core 3 2ghz 64 gb ram and a quadro p1000 gpu 2 5 loss function optimizer and error metrics the loss function l used in the model is the mean squared error mse with an l2 regularization term 8 l x w 1 n i 1 n y ˆ i y i 2 1 2 λ w 2 2 where n is the number of data y ˆ the predicted value y the measured value and λ the tunable regularization parameter for the 2 norm w 2 of the weight matrices w l2 regularization was used to reduce overfitting in the models goodfellow et al 2016 ng 2004 nie et al 2010 the gradient of the loss function is calculated by backpropagation with the adaptive moment estimation adam optimization algorithm kingma and ba 2015 the weights are updated for mini batches of samples x with a tunable size b n of a power of 2 a tunable decay of the tunable learning rate α is used to achieve a more robust convergence of the optimization process as error metrics the root mean squared error rmse the mean absolute error mae the mean arctangent absolute percentage error maape kim and kim 2016 the pearson correlation coefficient r and the coefficient of determination r2 were used in this study 9 r m s e 1 n i 1 n y ˆ i y i 2 10 m a e 1 n i 1 n y ˆ i y i 11 m a a p e 1 n i 1 n arctan y ˆ i y i y i 12 r c o v y ˆ y v a r y ˆ v a r y 13 r 2 1 i 1 n y i ˆ y i 2 i 1 n y i y 2 where c o v x y is the covariance of x y v a r x the variance of x and y the mean of the measured values the rmse eq 9 is equal to the square root of the mse and scale dependent as it has the same dimension as the predicted parameter here m thus an rmse of 0 indicates a perfect fit while the prediction error increases with increasing rmse mae eq 10 is scale dependent but does not penalize large errors as much as mse and rmse r on the other hand is dimensionless with 1 r 1 and can only be used for describing linear correlations kuhn and johnson 2013 maape eq 11 is scale independent and dimensionless overcoming the problem of division by zero or values close to zero kim and kim 2016 2 6 hyperparameter tuning in order to find the best hyperparameters of the proposed model a bayesian hyperparameter optimization was performed on a training dataset bergstra et al 2011 snoek et al 2012 the number of lstm layers number of lstm nodes in each layer activation function mini batch size b learning rate α decay of learning rate α dropout rate between the lstm layers and regularization parameter λ were tuned a number of 50 iterations were performed maximizing the scale independent r2 objective function during the tuning process the bayesian optimization handles the lstm model as a random black box function on the hyperparameters which is expensive to evaluate therefore the algorithm estimates the best hyperparameters with a minimum of objective function evaluations brochu et al 2010 prior a gaussian process is built over the objective functions and best hyperparameters are selected according to their likelihood after evaluating the objective function with those hyperparameters the posterior is built and the next hyperparameters for function evaluation can be determined again cabrera et al 2020 cornejo bueno et al 2018 snoek et al 2012 the partly discrete search domain and the results of the bayesian optimization are shown in table 3 the results of the bayesian hyperparameter search were used for all lstm and p lstm models as well as for all ffnn models to have a comparable architecture 3 results and discussion in a first step the performance of our proposed model for significant wave height reconstruction l 0 short term l 6 12 18 24 and long term l 48 96 prediction was compared to other common statistical and machine learning models both in the nearshore area and on a commonly studied deep ocean buoy dataset in a next step we investigated the improvements of the reconstruction and short and long term prediction models by adding the bathymetries to the training data the test data were not shown to the networks during training in any way also the influence of other feature selections on the model performance was investigated 3 1 model comparison nearshore excluding bathymetry features to evaluate the performance of the proposed lstm and p lstm architecture for the different reconstruction and short and long term prediction settings excluding the bathymetry the models were compared to a two layered deep fully connected ffnn with the same settings for learning rate optimization algorithm batch size and number of neurons as the lstm models as well as a simple single layered fully connected ffnn sl ffnn a svr a rf and a common mlr 3 1 1 reconstruction table 4 gives an overview of the results for the reconstruction task excluding and including bathymetries the unknown swh of buoy coast ii was reconstructed by the known swh of the other buoys and the wind and water level data only by excluding the bathymetries the influence of the etd sandbanks was implicitly considered with the buoy data of coast ii since this position is influenced by those best reconstruction results excluding bathymetry features were achieved with the p lstm and lstm neural networks with rmses of 0 079 and 0 084 m respectively table 4 because the hyperparameter tuning of the ffnn was initialized with the optimal tuning parameters of the lstm and the initial values were among the best results the same hyperparameters allowed a proper comparison of both models the performances of the ffnn and rf and the sl ffnn and svr were quite similar table 4 for all models the scale independent metric r was higher than the scale independent metric r2 and the scale dependent metric rmse higher than the scale dependent metric mae fig 5 shows the results of the reconstruction excluding the bathymetries by comparing measured and predicted values the data points of the two lstms were closest around the bisector although extreme values tended to be slightly underestimated the reconstruction error did not increase further at higher wave heights the ffnn svr and rf showed deviations of the reconstruction with increasing wave height while extreme wave heights were underestimated especially by the rf fig 5 since the regression line solid red line was consistently below the bisector dashed red line all models underestimated the swh on average the mlr distinctly showed the greatest spreading around the bisector and the regression line with increasing wave height and tended to overestimate extreme values fig 5 nevertheless the mlr is easy to interpret compared to the other methods the β coefficients of the mlr provide information about the directional influence of the different input parameters on the prediction for the reconstruction excluding bathymetric data the β coefficient for time step t of h m 0 coast i was highest with 0 457 0 007 and 0 131 0 034 for h m 0 coast ref this corresponds to the correlation of the input parameters which also showed the highest value for h m 0 coast i fig 3 with r 0 96 the correlation between h m 0 coast ref and h m 0 coast i was very high which could explain the low influence of this variable in the mlr a mean β coefficient of 0 322 0 032 was found for the water level of time step t while the general correlation between this variable and h m 0 coast ii was r 0 48 although the correlation between the wind speed and h m 0 coast ii was r 0 56 the β coefficient at time step t for this variable was low at 0 054 0 009 this may be due to the high correlation of r 0 73 between h m 0 coast ref and the wind speed fig 3 a comparison of the reconstructed time series is given in fig 6 the lstm and p lstm dashed green lines showed an overall good fit to the measured data solid grey line a high volatility of the other methods except the ffnn were found for local extreme values fig 7 shows the error of the standardized training and test data during the training process of the lstm and ffnn over the 100 epochs for the reconstruction excluded the bathymetries while the performance on the training and test data were nearly equal for the lstm the ffnn had a significantly worse performance on the test data it was assumed that the lstm learned a better generalization of the time series data due to its recurrent units and various gates while the ffnn showed a slight overfitting gers et al 2000 hyperparameter tuning showed that deeper networks did not increase the test performance but led to an overfitting of the training data 3 1 2 short term prediction not only for the reconstruction but also for the multi step forecasts the performance of the p lstm and lstm were better than those of the other methods the p lstm parallel structure with additive resampling consequently showed a slightly better performance than the non parallelized lstm structure for all short term prediction intervals the performance for the 3 h 6 h 9 h and 12 h ahead forecasts of the significant wave height for buoy coast ii by historical data of the surrounding buoys is given in table 5 as expected the performance of all models became increasingly worse as the prediction interval increased fig 8 shows the logarithmically increasing rmse of the lstm for the different prediction intervals for the prediction task the performance of the rf was better than the svr and except for the 3 h ahead prediction it was better than the ffnn table 5 nevertheless differences between the models could be identified while the r2 of the lstm for the 3 h ahead prediction increased by 4 7 compared to the ffnn by 7 7 compared to the svr and by 5 3 compared to the rf it increased by 10 2 11 2 and 7 8 for the 6 h ahead prediction 13 5 15 8 and 10 9 for the 9 h ahead prediction and by 20 3 21 8 and 13 6 for the 12 h ahead prediction respectively table 5 the error metric of r showed a similar behavior table 5 this indicates that the lstm and p lstm performed better compared to the other machine learning algorithms with increasing forecasting horizon on the other hand the rmse of the ffnn svr and rf was 20 7 31 5 and 23 4 higher than the rmse of the lstm for the 3 h ahead prediction 24 3 25 7 and 19 3 higher for the 6 h ahead prediction 22 7 25 2 and 18 4 for the 9 h ahead prediction and 23 6 25 3 and 17 6 higher for the 12 h ahead prediction respectively table 5 mae showed a similar pattern fig 9 shows the differences between the measured and modeled values for the 12 h ahead prediction excluding bathymetric data the p lstm and lstm showed the narrowest line here as well the ffnn showed a higher variability for extreme values than the rf and a similar scatter plot to the svr differences between the several models were most significant for this forecasting period thus the improvement of the lstm and p lstm for the different predictions in terms of r2 and r increased with increasing forecasting period while the improvement in terms of rmse and mae was equal or decreased with an increasing forecasting period nevertheless it corresponds to the expectation that the lstm and p lstm can bring their power to bear especially with larger forecasting periods this highlights the broad potential of lstms for time series data fan et al 2020 the overall poor performance of the mlr can be explained by considering only linear relations while the data showed a much more complex and non linear pattern since the etd sandbank movements and their non linear influence on the sea state at position coast ii were not considered in this setting a poor performance of the mlr was expected jörges et al 2021 as the variability or standard deviation of the different model runs error metrics was mostly smaller by more than a factor of 100 than the mean value table 4 table 5 it is sufficient to consider the mean value only while variations can be neglected the sl ffnn showed the highest variability especially for longer forecast periods all models except the sl ffnn were robust against the random train test split of the dataset as well as the random initialization of particular parameters in the algorithms 3 1 3 long term prediction since the sl ffnn showed an extreme overfitting in both long term tasks and the ffnn in the 48 h ahead predictions when training over 100 epochs the number of epochs for the long term prediction of these methods was reduced to 10 results of the long term predictions are given in table 5 compared to the swh range of 2 97 m at position coast ii table 1 the maes of 0 173 m at 24 h ahead and 0 209 m at 48 h ahead using the p lstm are still acceptable the maapes for the lstm 0 368 and p lstm 0 359 for the 48 h ahead prediction indicate that the lstms are capable of long term prediction values are similar to the experimental results on some deep ocean buoy positions in pirhooshyaran and snyder 2020 as seen from table 5 the differences between the lstms and the benchmark methods are significant while the differences among the benchmark methods are negligible 3 2 model comparison validation on offshore data 3 2 1 noaa dataset validation of the proposed lstm and p lstm method was performed on a well studied deep ocean buoy dataset from the national oceanic and atmospheric administration noaa https www ndbc noaa gov the three adjacent offshore buoys 46042 46069 and 46025 are located in the pacific ocean off the u s west coast supplementary material section 1 hourly swh data from 2009 to 2010 were used for training and testing respectively for detailed information on the buoys parameters refer to section 2 of the supplementary material as in previous studies cornejo bueno et al 2018 londhe 2008 londhe and panchang 2007 pirhooshyaran and snyder 2020 we reconstructed the swh of buoy 46 069 at time t using information of swh for the last 12 h k 12 to t from the two nearby buoys 46 042 and 46 025 the neural networks only received information about the swh of the two adjacent buoys for the reconstructed time step t while some of the benchmark methods used additional features such as wind speed average wave period air temperature atmospheric pressure and longer lookback times missing data were deleted completely resulting in a total of 3728 data points for training and 4201 for testing the architecture of the lstm and p lstm was optimized for the noaa dataset using bayesian hyperparameter optimization one lstm layer with 125 neurons relu activation function and a final fully connected layer was trained over 30 epochs 3 2 2 experimental results on noaa dataset results of the reconstruction task with our proposed methods and the performance of benchmark methods from the literature are given in table 6 compared to cornejo bueno et al 2018 and pirhooshyaran and snyder 2020 our proposed method original designed for the nearshore area in the east frisian north sea also performed well on deeper and more offshore buoy positions with a mae of 0 2327 m the proposed lstm model achieved the smallest error while the lstm had a smaller rmse the p lstm had a slightly higher r2 overall the performance of the lstm and p lstm was very similar to the performance of the seqtoseq and lstm models in pirhooshyaran and snyder 2020 in addition to the reconstruction of the swh we also performed forecasting for the deep ocean data table 6 while the 3 h ahead prediction came to a mae of 0 239 m the 12 h ahead prediction had a mae of 0 3289 m 3 3 impact of bathymetry features 3 3 1 reconstruction including bathymetry including bathymetric data to the training purpose significantly improved the performance of our proposed lstm frameworks and all other models on the test data table 4 shows the results for the reconstruction with included bathymetric data the mean ensemble rmse of the lstm and p lstm was reduced by 16 7 to 0 070 m and by 12 7 to 0 069 m with included bathymetries respectively the p lstm setting achieved the best accuracy for all experiments and in terms of all error metrics therefore the swh can be predicted with a mae of about 5 cm although the model does not have any historical data on the predicted position south of the etd sandbanks the reconstruction error of the ffnn decreased by 20 6 to an rmse of 0 085 m by including bathymetry features which was the greatest decrease of all models including bathymetry features decreased the rmse of the sl ffnn by 19 2 to 0 101 m of the svr by 6 6 to 0 114 m of the rf by 5 5 to 0 104 m and of the mlr by 2 0 to 0 149 m the performance of the ffnn was better or equal than the performance of the svr and rf for the reconstruction excluding and including bathymetries pirhooshyaran and snyder 2020 mentioned the superior performance of the lstm for swh reconstruction while they also had a very good performance using rf in contrast to our results it turned out that the neural networks could use the additional information on bathymetry best to increase their performance the performances of the p lstm excluding and including the bathymetries for reconstructing swh are compared in fig 10 the data points were significantly closer to the bisector when the bathymetry was included and most extreme values were reconstructed satisfactory the improvements in all error metrics also demonstrate this for example maape decreased by 11 4 and r2 increased by 1 3 for the p lstm the relative improvements in r2 and r were always below those of the other error metrics even by including bathymetric data the measured values were underestimated on average although not as much as can be seen from the solid red line in fig 10 differences in the predicted time series between the p lstm excluding and including the bathymetries for the reconstruction are illustrated in fig 11 although both lines are generally close to each other differences were found especially at local extremes while extreme values were regularly underestimated 3 3 2 prediction including bathymetry by including the bathymetric data to the 3 6 9 and 12 h ahead prediction of the lstm and p lstm the relative reduction of the rmse was about similar for both methods and all time steps resulting in a reduction of the rmses by 7 6 9 5 for the p lstm and 7 4 11 7 for the lstm thus the rmse decreased to 0 096 m 0 124 m 0 145 m and 0 165 m for the p lstm respectively table 5 valid 12 h ahead predictions were still made with the proposed models this time span can be sufficient to initiate practical solutions e g for coastal protection it underlines the good performance of neural networks especially the recurrent lstm neural networks to accurately predict complex time series data with morphodynamic influences among the benchmark methods the ffnn significantly performed best in terms of rmse and maape it improved the rmse by 11 2 for the 3 h ahead prediction and by 8 for the 12 h ahead prediction by including bathymetric data the svr rf and mlr could reduce the rmse by only up to 8 3 2 9 and 1 8 for the short term predictions respectively while the performance of all error metrics of the ffnn was similar or worse than that of the rf by excluding the bathymetries it was better by including the bathymetries for the short term predictions table 5 as seen in fig 12 the data points of the 3 h ahead prediction with included bathymetries were closer around the bisector even with the prediction of extreme events there was no increase in the prediction error of the p lstm with the inclusion of the bathymetries the prediction error of extreme events was lower in the 3 and 6 h ahead forecast of the p lstm by increasing the forecasting interval to 6 h the prediction error became larger as indicated by the more developed bulge around the bisector fig 13 illustrates the comparison between the measured and predicted values of the p lstm including and excluding the bathymetry features for the 9 and 12 h ahead prediction there is a distinctly greater bulge around the bisector as well as a stronger spread of certain predicted values nevertheless with bathymetry included the data points were closer to the bisector even at these prediction intervals the lstm gate units allow the recurrent model to remember long periods while selecting only essential information xiao et al 2019 without these morphodynamic information the models tended to underestimate extreme values figs 12 and 13 the 24 and 48 h ahead long term predictions of swh were also improved by including bathymetric data table 5 rmse and maape of the p lstm were reduced by 10 2 and 9 2 for the 24 h ahead prediction and by 9 8 and 9 5 for the 48 h ahead prediction respectively as a result the long term predictions were improved by a greater percentage in terms of rmse compared to the short term predictions by the p lstm with bathymetry features in general all models in the nearshore area improved their performance by including bathymetric features hence they are highly relevant in reconstructing and predicting swh in the study area 3 3 3 limitations of including bathymetric data the train and test split was randomly selected thus the models and their performances on the test data cannot be transferred or generalized to other areas especially other bathymetries for a better generalization more bathymetric data are necessary for training and learning the etd influence however it can be assumed that the lstm is a suitable method to process even more complex morphodynamic data in order to process 2 dimensional bathymetric data a combined lstm and convolutional neural network cnn could be promising choi et al 2020 used such a framework in a similar context with ocean images instead of bathymetric data in addition a mlr which tends to underfitting and leads to a greater generalization due to its low number of weights consistently showed an improvement by adding bathymetric data indicating a general improvement overall the bathymetric data have improved the reconstruction and prediction accuracy the results showed that the etd sandbanks have a significant influence on the propagation of the waves and the wave height on the island coast which was also found by numerical modelling jörges et al 2021 as the size and shape of the etd sandbanks are constantly changing by morphodynamic effects their influence on local forecast models must be considered in addition to continuous monitoring 3 4 further feature selection analysis while adding bathymetric features significantly improved the performance of all models one should also investigate the influence of other features it must be noted that the best performance was observed with the inclusion of all the above features hence they all contain significant information for the prediction 3 4 1 wind speed and direction even though theoretically the greatest influence is expected from wind speed by including this feature the rmse of the reconstruction was reduced by only 11 4 for the lstm and 14 8 for the p lstm supplementary material section 3 thus the influence of bathymetric features 16 7 for lstm and 12 7 for p lstm in terms of rmse was about similar to the influence of wind speed this may be due to the fact that the swh data of the two other buoy positions are affected significantly by wind speed and thus a fraction of the wind speed information is redundant the influence of the bathymetry however only becomes effective south of the two other buoy positions and is not already hidden within them in any way by reducing the rmse of the reconstruction by 21 3 for the lstm and 21 6 for the p lstm the influence of wind direction was slightly higher than for wind speed and bathymetries supplementary material section 4 the wind direction influences the non linear wave breaking at the etd sandbanks as well as fetch length and wave direction 3 4 2 water level with feature selection excluding only water level and tidal information the best rmse and r2 were 0 132 m and 0 873 for reconstruction with the p lstm respectively supplementary material section 5 since the reduction in rmse for the reconstruction was 47 8 for the lstm and 47 7 for the p lstm the influence of the water level was greater than any other single feature which can be explained by the complex nearshore location of the buoys where tides dominate the wave climate 3 4 3 swh only nearshore vs offshore performance considering only swh for reconstruction and forecast resulted in the worst prediction performance with a reconstruction rmse of 0 175 m and 0 173 m for the lstm and p lstm respectively supplementary material section 6 while the differences between the models in terms of all error metrics are huge in some cases the performances in this case except for mlr were very similar as the regression problem became simpler with less parameters the lstm methods which are optimized for complex problems may have been overfitted thus not only lstm and p lstm had the best performance but also sl ffnn and rf performed quite well in this case the best reconstruction performance on the norderney nearshore dataset was r2 0 781 for the ffnn and maape 0 2 for the p lstm compared to the performance on the deep ocean noaa dataset the scale independent error metrics were worse in the nearshore area since the best performance on the offshore dataset was r2 0 8106 although this is a small difference it must be noted that the distance between the buoy positions is much smaller in the nearshore area this emphasizes that considering swh only in the nearshore area is not a proper method and other features must be considered since the sea state is much more complex bathymetry mainly represented by the etd sandbanks for the research area of this study is a main feature in the nearshore area 4 conclusion this study aimed to reconstruct and multi step forecast swh of the nearshore area of norderney germany based on neighboring moored buoy measurements with the focus set on the model improvements by including bathymetric data on a local scale exact knowledge of nearshore wave conditions considering natural sea state damping by the morphodynamically changing etd sandbanks is essential for coastal protection planning offshore missions and running sea state and climate forecasting models it was found in our experiments that the lstm and p lstm neural networks performed best among other existing benchmark methods such as ffnn svr rf and mlr both for reconstruction and prediction compared to the lstm the rmse of the ffnn was at least 21 the svr 25 the rf 18 and the mlr 28 higher for the reconstruction and short term prediction task to achieve reliable and fair results hyperparameters were tuned using bayesian optimization for all models and reconstruction or prediction intervals an ensemble of three independent model runs was performed all models showed robust results on the test data with respect to the various training sets by including bathymetry features the performance of the proposed lstm and p lstm method in terms of rmse increased by 16 7 to an rmse of 0 07 m and by 12 7 to an rmse of 0 069 m for the reconstruction respectively the short term predictions 3 6 9 and 12 h ahead showed significantly better performance in terms of all error metrics used namely rmse r2 r maape and mae by including the bathymetries compared to other feature selections the improvements were considerable thus our findings highlight the broad potential of lstm neural networks for swh reconstruction and prediction as well as the need to consider bathymetries in morphodynamic changing coastal areas such as the east frisian islands further experiments on well studied deep ocean wave data also showed satisfactory results so the proposed method is not limited to the nearshore area the lstm and p lstm neural networks could satisfactorily predict even extreme values of swh using the bathymetric data those events that are of special interest for coastal protection and marine operations limitations of the presented study are the insufficient availability of bathymetries for training the models nevertheless the presented methods can be used for other data and regions as well using high temporal resolution measurements of a coastal radar may be a promising future way due to the accurate reconstruction and prediction of the proposed model it might also be possible to place the expensive ocean buoys more efficiently or even to drop positions completely results can also be used to verify numerical models and vice versa using additional information regarding the local wave climate such as wave period and wave direction might also be considered in future studies credit authorship contribution statement christoph jörges conceptualization methodology software validation formal analysis data curation writing original draft writing review editing visualization cordula berkenbrink conceptualization resources data curation writing review editing britta stumpe conceptualization writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors thank the coastal research station of the lower saxony water management coastal defence and nature conservation agency nlwkn for providing the buoy measurement data used in this study this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2021 109046 
20681,since climate change impacts threaten the coastal regions of the north sea consistent sea state time series are essential for building coastal protection or offshore structures vast gaps in buoy data caused by false measurements or maintenance periods require reconstruction and forecasting of ocean waves morphodynamic changes of the ebb tidal delta etd sandbanks exert a huge impact on the local wave climate off the island of norderney germany therefore the objective of this paper is to develop a machine learning model based on long short term memory lstm neural networks for reconstruction and short and long term prediction of nearshore significant wave height swh integrating bathymetric data for the first time time series of sea state and weather data of adjacent buoys as well as bathymetric data of the etd sandbanks from 2004 to 2017 were used and the networks were tuned with bayesian hyperparameter optimization including the bathymetries improved the performance of the lstm for swh reconstruction short and long term predictions by 16 7 7 4 11 7 and 8 8 9 1 in terms of rmse respectively the lstm outperformed deep feed forward neural networks and other state of the art machine learning algorithms with an rmse of 0 069 m a parallel lstm structure p lstm is the proposed method for swh reconstruction keywords long short term memory lstm neural network machine learning wave height prediction forecasting ocean waves bayesian optimization dynamic bathymetries 1 introduction climate change impacts such as sea level rise a possible increase in storm frequency and intensity a possible trend in increasing ocean wave heights and global warming in general will become emerging challenges for coastal regions of the north sea grabemann and weisse 2008 mori et al 2013 vanem and walker 2013 furthermore storm surges are a frequently recurring and well known danger bitner gregersen et al 2018 weisse et al 2012 substantial knowledge of the sea state is therefore essential for building coastal protection or offshore structures and marine operations as well as for feeding numerical and climate models ti et al 2018 wave height is consequently one of the most important wave characteristics for such purposes teich et al 2018 and commonly measured by networks of moored wave buoys time series of such wave buoys typically have gaps due to erroneous measurements or maintenance operations londhe 2008 especially extreme events are often recorded erroneously although they are of great interest in ocean science cavaleri 2009 thus sophisticated tools for reconstructing and predicting ocean wave heights are required especially in coastal areas several complex processes influence the propagation of waves and wave height the morphodynamic change of ebb tidal delta etd sandbanks of the coastal area of norderney germany exerts a huge impact on the local wave climate jörges et al 2021 caused by ebb tidal currents the etd sandbanks are dynamically changing by migration erosion and accretion castelle et al 2007 dallas and barnard 2011 and thus influence the reconstruction and forecast of coastal wave heights by increasing the complexity of the prediction spicer bak et al 2019 the etd sandbanks are also a natural coastal protection by damping the incoming wave height especially for extreme events jörges et al 2021 niemeyer 1979 niemeyer and kaiser 1999 usually numerical models such as simulating waves nearshore swan are used for predicting irregular random waves however they are often expensive in computational costs but precise due to exact physical equations soft computing frameworks as machine learning algorithms can be an alternative in some cases abed elmdoust and kerachian 2012 fernández et al 2015 mahjoobi et al 2008 malekmohamadi et al 2011 mandal and prabaharan 2010 nitsure et al 2012 combinations of numerical modelling and soft computing techniques also exist malekmohamadi et al 2008 puscasu 2014 reikard et al 2011 artificial neural networks ann in particular are widely used nowadays for wave height reconstruction and prediction namely the feed forward neural networks ffnn as a common example deo et al 2001 deo and naidu 1999 law et al 2020 londhe and panchang 2007 peres et al 2015 zamani et al 2008 in the project moses herman et al 2007 time series of spatial wave climate data of the nearshore area of norderney were reconstructed with ffnns for the period 1962 2002 as a result numerical modelling including swan was enhanced by an efficient soft computing method herman et al 2009 berkenbrink and niemeyer 2017 analyzed a changing salinity intrusion due to estuarine waterway deepening in the german bight with ffnn james et al 2018 used ffnn with numerically modeled swan data of monterey bay and reduced the computational time by a factor 1000 compared to the physics based model ann approaches with a genetic algorithm altunkaynak 2013 and evolutionary product unit neural networks epunn durán rosal et al 2016 were also used kumar et al 2017 predicted ocean wave heights with a radial basis function rbf called minimal resource allocation network mran while stefanakos 2016 used the adaptive network based fuzzy inference system anfis furthermore approaches with extreme learning machine elm ali and prasad 2019 kumar et al 2018 and discrete wavelet transforms neural networks deka and prahlada 2012 dixit and londhe 2016 were successfully implemented for wave height forecasting however for sequential data recurrent neural networks rnn anns with feedback connections to neurons from previous time steps lecun et al 2015 are suitable and still used for wave height prediction balas et al 2004 the long short term memory lstm neural network is a specific rnn and was designed by hochreiter and schmidhuber 1997 to handle long term dependencies an lstm decides on its own weather to remember or to forget information gers et al 2000 besides the use for speech and handwriting recognition graves and jaitly 2014 graves et al 2009 machine translation wu et al 2016 image captioning aggarwal 2018 and stock price prediction kim and won 2018 lstms are already used for reconstruction and prediction of time series in various related fields such as wind speed forecasting li et al 2018 sea surface temperature prediction xiao et al 2019 solar irradiance prediction qing and niu 2018 and weather forecasting salman et al 2018 first experiments with lstm neural networks for the reconstruction and prediction of nearshore wave heights with data of the norderney coastal area were quite promising jörges 2018 jörges et al 2020 pirhooshyaran and snyder 2020 first applied a sequence to sequence neural network with lstm encoder and decoder to reconstruct and predict offshore and deep ocean wave heights of the north pacific and north atlantic ocean they achieved a reconstruction r2 of up to 0 81 at a deep ocean buoy position near los angeles fan et al 2020 used lstm neural networks for one and 6 h ahead predictions of offshore and deep ocean significant wave height and combined it with the third generation numerical wave model swan to improve the predictions 6 h ahead predictions were performed with an r2 of up to 0 97 for a deep ocean buoy east of florida kagemoto 2020 satisfactorily predicted water surface wave trains and the motion of a floating body in it with lstm neural networks while ni and ma 2020 applied a lstm neural network for the prediction of polar westerlies wave height with only few measurements available however to the best of our knowledge none of the previous studies have yet considered complex morphodynamic conditions or integrated bathymetric data for the reconstruction or prediction of ocean wave heights with lstm neural networks in addition the lstm has not yet been applied to shallow waters in nearshore areas where morphodynamic influences typically are greater thus the objective of this study was to design an lstm based reconstruction and short and long term prediction model for significant wave height including bathymetric data to overcome the challenge of morphodynamic changes in the nearshore area the reconstruction and short and long term predictions were performed on buoy measurements of neighboring buoys off the norderney coastline separated by the etd sandbanks and wind and water level parameters as well as bathymetric data of the etd sandbanks in a first step a model comparison of several machine learning methods was performed on the nearshore wave data to benchmark the lstm neural network while the proposed method was also validated on well studied offshore buoy measurements off the u s west coast in a second step the impact of including bathymetric data on model performance was investigated by experiments and further feature selections were tested the main contributions of this study are as follows a lstm neural network and an ensemble of parallel lstm networks are presented for reconstruction and short and long term prediction of nearshore wave heights bathymetric data are presented as features to improve wave height reconstruction and prediction for the first time 2 methods 2 1 research area and dataset 2 1 1 research area the research area is located in the nearshore area of the east frisian island of norderney in the german north sea fig 1 the islands juist west and baltrum east are separated from norderney by the tidal inlets norderneyer seegat and wichter ee respectively between the barrier islands high tidal currents are present which activate the sediment transport of the etd and the tidal flats the long term mean high water mhw at gauge norderney riffgat is 1 24 m above the german reference height nhn or the german mean sea level with a mean tidal range of 2 45 m the main wind direction of the research area is southwest fig 1 2 1 2 dataset buoy data of three waverider datawell haarlem the netherlands buoys were provided by the coastal research station of the lower saxony water management coastal defence and nature conservation agency nlwkn norderney table 1 while the two buoys coast ref and coast i are located north of the etd sandbanks the reef arch west and north of norderney the predicted position coast ii is located south of it and directly in front of the norderney beach fig 1 nearshore wave height at buoy coast ii thus is greatly influenced by morphodynamic processes of the etd sandbanks jörges et al 2021 niemeyer 1979 the parameters significant wave height swh mean wave period energy period and mean wave direction were calculated from the energy density spectra of the raw buoy data these data were available in half hourly resolution for the years 2004 2017 without the years 2012 2014 and with many missing values throughout the dataset table 1 fig 2 shows a sample portion of the swh at position coast i besides several data gaps in the annual record top the influence of the tides was significant in the daily record bottom wind data were provided by the german meteorological service deutscher wetterdienst dwd for the station norderney at a resolution of 10 min and water level data by the waterways and shipping administration wsa for the gauge level norderney riffgat at a resolution of 1 min all parameters were averaged to a half hourly resolution morphodynamic changes of the etd sandbanks were obtained by the bathymetries of yearly surveys which were provided by the nlwkn coastal research station and easygsh db due to the huge financial effort and time required additional survey missions by ship were not possible in this challenging area the easygsh db bathymetries and metadata were obtained from the easygsh db portal www easygsh db org hagen et al 2020 and only used after a validation process for years where no measurement data of the nlwkn coastal research station were available fig 3 shows the correlogram of relevant metric parameters significant correlations between the swh of coast ii and the other positions were found r 0 82 and r 0 83 wind speed and water level also showed correlations to the swh at coast ii with r 0 56 and r 0 48 respectively peak wave periods did not show any relevant correlations to the swh at coast ii fig 3 the feature selection was conducted according to these correlations by selecting parameters with r 0 3 to swh at coast ii parameters with low correlation coefficients also can have a high non linear influence the correlogram also provides a better insight into the structure of the dataset the feature parameters significant wave height h m 0 m of the buoys coast ref and coast i wind speed at sea m s wind direction water level m nhn the tidal phase ebb low water flood high water and the morphodynamic shape of the etd sandbanks see 2 2 were used for the reconstruction and prediction of the significant wave height h m 0 at buoy coast ii 2 1 3 data preprocessing as a preprocessing all measurement rows or time steps with at least one missing value nan of any buoy or water level and wind measurement were deleted completely then all features were min max normalized to the interval 0 1 by 1 x n x min x max x min x where x n is the normalized feature value and x the measured feature value the normalization was performed to prevent certain features from having a greater influence on the neurons input by their range alone no further data preprocessing beyond that was done in order to not manipulate the prediction results in any way ali and prasad 2019 the dataset was randomly divided into train 70 and test data 30 for every model setting or model run to obtain robust results by forcing the algorithms to work fully independent of the specific training data all error metrics given in this study see 2 5 refer to the rescaled predictions thus did not underlie the normalization and can easily be interpreted the normalization only refers to the min and max of the training data to ensure the models did not see any information e g the range of the test data during the training process 2 2 morphodynamic influences and bathymetry preprocessing since the etd sandbanks exert a huge and dynamical influence on the sea state damping in the nearshore area of norderney depending on their shape and size the damping effect varies on average by 14 better reconstruction and prediction performances were expected by including the bathymetric data jörges et al 2021 in order to avoid overfitting and to achieve a better generalization of the models a dimension reduction of the bathymetries was carried out for this purpose a one dimensional transect covering the mean etd sandbank line over all years was defined from the two dimensional measurement data fig 1 in this way both a good representation of the yearly etd sandbanks and a lower dimensional dataset by omitting unimportant information were achieved and thus used for data selection due to the different resolutions of the bathymetries the transect was divided into six equidistant sections and the mean values of each sections bottom heights were used as input for the models table 2 this feature engineering process results in a strong dimension reduction and generalization of the bathymetries already with the input data thus the error caused by the bathymetries with only annual resolution was addressed substantial variations in the characteristics of the etd sandbank within the respective years were observed while the mean bottom height of the transect over all bathymetries was 3 68 0 20 m table 2 caused by the huge difference of the measurement intervals between the bathymetries and the sea state data we matched a wave event to the bathymetry corresponding to the same measurement year this led to the greatest accuracy as the ship measurements were usually carried out during the summer month of a year nevertheless strong storm surges can lead to rapid changes of etd sandbanks and inaccuracies in matching the bathymetries to the buoy data wang et al 2012 2 3 long short term memory neural networks lstm neural networks are special rnn able to learn long term dependencies and coping with the vanishing gradient problem gers et al 2000 hochreiter and schmidhuber 1997 pascanu et al 2013 each lstm cell fig 4 consists of four units the forget gate f t input gate i t memory cell state c t and output gate o t at time t defined as 2 f t σ w f h t 1 w f x t 3 i t σ w i h t 1 w i x t 4 c t tanh w c h t 1 w c x t 5 c t f t c t 1 i t c t 6 o t σ w o h t 1 w o x t 7 h t o t tanh c t where x t h t c t w and σ are the input data hidden state temporary cell state weight matrices and sigmoid activation function respectively the operation indicates the hadamard matrix product for matrices with equal dimensions biases are not added explicitly since they can be integrated to the weight matrices the final output y t ˆ w y h t is used in the loss function eq 8 gers et al 2000 hochreiter and schmidhuber 1997 qing and niu 2018 to translate the abstract learned features into the prediction output a fully connected layer was added after the last lstm layer additionally a parallel lstm structure p lstm was designed therefore an additive resampling method similar to pirhooshyaran et al 2020 was performed to split the data for the respective parallel ensemble members the entire dataset was chronologically split into s subsets of equal size then each subset was randomly divided into a training and a test dataset as described above the proposed lstm model was trained independently on each of these training subsets concatenated with the entire training dataset to learn additional functional relations hidden in the entire dataset pirhooshyaran et al 2020 p lstm performance was evaluated on the union of all test subsets by the mean prediction of the parallel ensemble models none of the ensemble models has ever seen this test data during training for s 1 the p lstm structure is the same as the standard lstm structure of this study but trained on twice the set of training data since this leads to no new information we set s 1 with the best results obtained for s 2 the p lstm ensemble method with additive resampling in the background results in the same number of test samples as the other algorithms hence it is comparable to them 2 4 model settings in all computational runs the proposed lstm and p lstm models were always compared to a standard ffnn hastie et al 2009 a random forest rf breiman 2001 a support vector regression svr vapnik 1998 and a multiple linear regression mlr as benchmark methods found in the literature fan et al 2020 pirhooshyaran and snyder 2020 qing and niu 2018 while mlr with least squares fitting is a simple linear model that allows both a good interpretability of how the inputs affect the outputs by considering the β coefficients and low computational costs rf belongs among the more complex supervised machine learning algorithms based on several random decision trees fitted to a dataset the rf algorithm outputs a mean prediction of the ensemble each tree is grown from a random subset of the features which are used as candidates for the best binary split at each node at random by repeated selection with replacement from the training data bagging uncorrelated random trees are created the bootstrap samples left out by selection out of bag samples are used for the calculation of the prediction error breiman 2001 hastie et al 2009 svr is based on the idea of a support vector machine svm applied on regression problems using an ε sensitive loss function makes the svr robust and sparse since it is less affected by noisy inputs vapnik 2000 thus only prediction errors outside a defined ε tube with ε 0 are penalized by the l2 objective function of the coefficient vector data points around the ε tube are called the support vectors another parameter c 0 controls the regularization of the loss function for predictions outside the ε tube both ε and c were set to ε 0 08 and c 1 5 by bayesian hyperparameter optimization see 2 6 non linear functions are approximated with svr by mapping the data points to a higher dimensional feature space using a kernel function awad and khanna 2015 in this study the radial basis function kernel and the python libsvm implementation were used for calculations chang and lin 2021 a model input sequence x x 1 x k in this study consists of the last k values of all input variables x i x 1 x s where s is the number of input features since the measurements were available in half hourly resolution the k 2 last hours were used as input y y 1 y l is the output sequence for the prediction until time step t l where t denotes the current time step in this study predictions were made on the swh of the current time step l 0 the next 3 h l 6 6 h l 12 9 h l 18 and 12 h l 24 which according to the literature is an appropriate interval for short term predictions berbić et al 2017 fan et al 2020 long term predictions were made for an usual range of 24 h ahead l 48 and 48 h ahead l 96 dixit and londhe 2016 pirhooshyaran and snyder 2020 the lookback k on the input sequence was set to 6 for all models thus the last 3 h of all input features were used for the predictions especially the past wind speed and direction the fetch is crucial for the further propagation of the sea state since the development of ocean waves takes a certain time holthuijsen 2007 nitsure et al 2012 every setting consisting of a specific statistical model and the predicted time step l were calculated in an ensemble of three independent runs to cope with random variations in the performance of the training process and the split in training and testing data a robust model can only be assumed if the variation of the error metrics around the mean prediction error is small the neural networks were trained for 100 epochs each all calculations were performed with python 3 8 and tensorflow 2 on an intel xeon gold 6146 cpu 12 core 3 2ghz 64 gb ram and a quadro p1000 gpu 2 5 loss function optimizer and error metrics the loss function l used in the model is the mean squared error mse with an l2 regularization term 8 l x w 1 n i 1 n y ˆ i y i 2 1 2 λ w 2 2 where n is the number of data y ˆ the predicted value y the measured value and λ the tunable regularization parameter for the 2 norm w 2 of the weight matrices w l2 regularization was used to reduce overfitting in the models goodfellow et al 2016 ng 2004 nie et al 2010 the gradient of the loss function is calculated by backpropagation with the adaptive moment estimation adam optimization algorithm kingma and ba 2015 the weights are updated for mini batches of samples x with a tunable size b n of a power of 2 a tunable decay of the tunable learning rate α is used to achieve a more robust convergence of the optimization process as error metrics the root mean squared error rmse the mean absolute error mae the mean arctangent absolute percentage error maape kim and kim 2016 the pearson correlation coefficient r and the coefficient of determination r2 were used in this study 9 r m s e 1 n i 1 n y ˆ i y i 2 10 m a e 1 n i 1 n y ˆ i y i 11 m a a p e 1 n i 1 n arctan y ˆ i y i y i 12 r c o v y ˆ y v a r y ˆ v a r y 13 r 2 1 i 1 n y i ˆ y i 2 i 1 n y i y 2 where c o v x y is the covariance of x y v a r x the variance of x and y the mean of the measured values the rmse eq 9 is equal to the square root of the mse and scale dependent as it has the same dimension as the predicted parameter here m thus an rmse of 0 indicates a perfect fit while the prediction error increases with increasing rmse mae eq 10 is scale dependent but does not penalize large errors as much as mse and rmse r on the other hand is dimensionless with 1 r 1 and can only be used for describing linear correlations kuhn and johnson 2013 maape eq 11 is scale independent and dimensionless overcoming the problem of division by zero or values close to zero kim and kim 2016 2 6 hyperparameter tuning in order to find the best hyperparameters of the proposed model a bayesian hyperparameter optimization was performed on a training dataset bergstra et al 2011 snoek et al 2012 the number of lstm layers number of lstm nodes in each layer activation function mini batch size b learning rate α decay of learning rate α dropout rate between the lstm layers and regularization parameter λ were tuned a number of 50 iterations were performed maximizing the scale independent r2 objective function during the tuning process the bayesian optimization handles the lstm model as a random black box function on the hyperparameters which is expensive to evaluate therefore the algorithm estimates the best hyperparameters with a minimum of objective function evaluations brochu et al 2010 prior a gaussian process is built over the objective functions and best hyperparameters are selected according to their likelihood after evaluating the objective function with those hyperparameters the posterior is built and the next hyperparameters for function evaluation can be determined again cabrera et al 2020 cornejo bueno et al 2018 snoek et al 2012 the partly discrete search domain and the results of the bayesian optimization are shown in table 3 the results of the bayesian hyperparameter search were used for all lstm and p lstm models as well as for all ffnn models to have a comparable architecture 3 results and discussion in a first step the performance of our proposed model for significant wave height reconstruction l 0 short term l 6 12 18 24 and long term l 48 96 prediction was compared to other common statistical and machine learning models both in the nearshore area and on a commonly studied deep ocean buoy dataset in a next step we investigated the improvements of the reconstruction and short and long term prediction models by adding the bathymetries to the training data the test data were not shown to the networks during training in any way also the influence of other feature selections on the model performance was investigated 3 1 model comparison nearshore excluding bathymetry features to evaluate the performance of the proposed lstm and p lstm architecture for the different reconstruction and short and long term prediction settings excluding the bathymetry the models were compared to a two layered deep fully connected ffnn with the same settings for learning rate optimization algorithm batch size and number of neurons as the lstm models as well as a simple single layered fully connected ffnn sl ffnn a svr a rf and a common mlr 3 1 1 reconstruction table 4 gives an overview of the results for the reconstruction task excluding and including bathymetries the unknown swh of buoy coast ii was reconstructed by the known swh of the other buoys and the wind and water level data only by excluding the bathymetries the influence of the etd sandbanks was implicitly considered with the buoy data of coast ii since this position is influenced by those best reconstruction results excluding bathymetry features were achieved with the p lstm and lstm neural networks with rmses of 0 079 and 0 084 m respectively table 4 because the hyperparameter tuning of the ffnn was initialized with the optimal tuning parameters of the lstm and the initial values were among the best results the same hyperparameters allowed a proper comparison of both models the performances of the ffnn and rf and the sl ffnn and svr were quite similar table 4 for all models the scale independent metric r was higher than the scale independent metric r2 and the scale dependent metric rmse higher than the scale dependent metric mae fig 5 shows the results of the reconstruction excluding the bathymetries by comparing measured and predicted values the data points of the two lstms were closest around the bisector although extreme values tended to be slightly underestimated the reconstruction error did not increase further at higher wave heights the ffnn svr and rf showed deviations of the reconstruction with increasing wave height while extreme wave heights were underestimated especially by the rf fig 5 since the regression line solid red line was consistently below the bisector dashed red line all models underestimated the swh on average the mlr distinctly showed the greatest spreading around the bisector and the regression line with increasing wave height and tended to overestimate extreme values fig 5 nevertheless the mlr is easy to interpret compared to the other methods the β coefficients of the mlr provide information about the directional influence of the different input parameters on the prediction for the reconstruction excluding bathymetric data the β coefficient for time step t of h m 0 coast i was highest with 0 457 0 007 and 0 131 0 034 for h m 0 coast ref this corresponds to the correlation of the input parameters which also showed the highest value for h m 0 coast i fig 3 with r 0 96 the correlation between h m 0 coast ref and h m 0 coast i was very high which could explain the low influence of this variable in the mlr a mean β coefficient of 0 322 0 032 was found for the water level of time step t while the general correlation between this variable and h m 0 coast ii was r 0 48 although the correlation between the wind speed and h m 0 coast ii was r 0 56 the β coefficient at time step t for this variable was low at 0 054 0 009 this may be due to the high correlation of r 0 73 between h m 0 coast ref and the wind speed fig 3 a comparison of the reconstructed time series is given in fig 6 the lstm and p lstm dashed green lines showed an overall good fit to the measured data solid grey line a high volatility of the other methods except the ffnn were found for local extreme values fig 7 shows the error of the standardized training and test data during the training process of the lstm and ffnn over the 100 epochs for the reconstruction excluded the bathymetries while the performance on the training and test data were nearly equal for the lstm the ffnn had a significantly worse performance on the test data it was assumed that the lstm learned a better generalization of the time series data due to its recurrent units and various gates while the ffnn showed a slight overfitting gers et al 2000 hyperparameter tuning showed that deeper networks did not increase the test performance but led to an overfitting of the training data 3 1 2 short term prediction not only for the reconstruction but also for the multi step forecasts the performance of the p lstm and lstm were better than those of the other methods the p lstm parallel structure with additive resampling consequently showed a slightly better performance than the non parallelized lstm structure for all short term prediction intervals the performance for the 3 h 6 h 9 h and 12 h ahead forecasts of the significant wave height for buoy coast ii by historical data of the surrounding buoys is given in table 5 as expected the performance of all models became increasingly worse as the prediction interval increased fig 8 shows the logarithmically increasing rmse of the lstm for the different prediction intervals for the prediction task the performance of the rf was better than the svr and except for the 3 h ahead prediction it was better than the ffnn table 5 nevertheless differences between the models could be identified while the r2 of the lstm for the 3 h ahead prediction increased by 4 7 compared to the ffnn by 7 7 compared to the svr and by 5 3 compared to the rf it increased by 10 2 11 2 and 7 8 for the 6 h ahead prediction 13 5 15 8 and 10 9 for the 9 h ahead prediction and by 20 3 21 8 and 13 6 for the 12 h ahead prediction respectively table 5 the error metric of r showed a similar behavior table 5 this indicates that the lstm and p lstm performed better compared to the other machine learning algorithms with increasing forecasting horizon on the other hand the rmse of the ffnn svr and rf was 20 7 31 5 and 23 4 higher than the rmse of the lstm for the 3 h ahead prediction 24 3 25 7 and 19 3 higher for the 6 h ahead prediction 22 7 25 2 and 18 4 for the 9 h ahead prediction and 23 6 25 3 and 17 6 higher for the 12 h ahead prediction respectively table 5 mae showed a similar pattern fig 9 shows the differences between the measured and modeled values for the 12 h ahead prediction excluding bathymetric data the p lstm and lstm showed the narrowest line here as well the ffnn showed a higher variability for extreme values than the rf and a similar scatter plot to the svr differences between the several models were most significant for this forecasting period thus the improvement of the lstm and p lstm for the different predictions in terms of r2 and r increased with increasing forecasting period while the improvement in terms of rmse and mae was equal or decreased with an increasing forecasting period nevertheless it corresponds to the expectation that the lstm and p lstm can bring their power to bear especially with larger forecasting periods this highlights the broad potential of lstms for time series data fan et al 2020 the overall poor performance of the mlr can be explained by considering only linear relations while the data showed a much more complex and non linear pattern since the etd sandbank movements and their non linear influence on the sea state at position coast ii were not considered in this setting a poor performance of the mlr was expected jörges et al 2021 as the variability or standard deviation of the different model runs error metrics was mostly smaller by more than a factor of 100 than the mean value table 4 table 5 it is sufficient to consider the mean value only while variations can be neglected the sl ffnn showed the highest variability especially for longer forecast periods all models except the sl ffnn were robust against the random train test split of the dataset as well as the random initialization of particular parameters in the algorithms 3 1 3 long term prediction since the sl ffnn showed an extreme overfitting in both long term tasks and the ffnn in the 48 h ahead predictions when training over 100 epochs the number of epochs for the long term prediction of these methods was reduced to 10 results of the long term predictions are given in table 5 compared to the swh range of 2 97 m at position coast ii table 1 the maes of 0 173 m at 24 h ahead and 0 209 m at 48 h ahead using the p lstm are still acceptable the maapes for the lstm 0 368 and p lstm 0 359 for the 48 h ahead prediction indicate that the lstms are capable of long term prediction values are similar to the experimental results on some deep ocean buoy positions in pirhooshyaran and snyder 2020 as seen from table 5 the differences between the lstms and the benchmark methods are significant while the differences among the benchmark methods are negligible 3 2 model comparison validation on offshore data 3 2 1 noaa dataset validation of the proposed lstm and p lstm method was performed on a well studied deep ocean buoy dataset from the national oceanic and atmospheric administration noaa https www ndbc noaa gov the three adjacent offshore buoys 46042 46069 and 46025 are located in the pacific ocean off the u s west coast supplementary material section 1 hourly swh data from 2009 to 2010 were used for training and testing respectively for detailed information on the buoys parameters refer to section 2 of the supplementary material as in previous studies cornejo bueno et al 2018 londhe 2008 londhe and panchang 2007 pirhooshyaran and snyder 2020 we reconstructed the swh of buoy 46 069 at time t using information of swh for the last 12 h k 12 to t from the two nearby buoys 46 042 and 46 025 the neural networks only received information about the swh of the two adjacent buoys for the reconstructed time step t while some of the benchmark methods used additional features such as wind speed average wave period air temperature atmospheric pressure and longer lookback times missing data were deleted completely resulting in a total of 3728 data points for training and 4201 for testing the architecture of the lstm and p lstm was optimized for the noaa dataset using bayesian hyperparameter optimization one lstm layer with 125 neurons relu activation function and a final fully connected layer was trained over 30 epochs 3 2 2 experimental results on noaa dataset results of the reconstruction task with our proposed methods and the performance of benchmark methods from the literature are given in table 6 compared to cornejo bueno et al 2018 and pirhooshyaran and snyder 2020 our proposed method original designed for the nearshore area in the east frisian north sea also performed well on deeper and more offshore buoy positions with a mae of 0 2327 m the proposed lstm model achieved the smallest error while the lstm had a smaller rmse the p lstm had a slightly higher r2 overall the performance of the lstm and p lstm was very similar to the performance of the seqtoseq and lstm models in pirhooshyaran and snyder 2020 in addition to the reconstruction of the swh we also performed forecasting for the deep ocean data table 6 while the 3 h ahead prediction came to a mae of 0 239 m the 12 h ahead prediction had a mae of 0 3289 m 3 3 impact of bathymetry features 3 3 1 reconstruction including bathymetry including bathymetric data to the training purpose significantly improved the performance of our proposed lstm frameworks and all other models on the test data table 4 shows the results for the reconstruction with included bathymetric data the mean ensemble rmse of the lstm and p lstm was reduced by 16 7 to 0 070 m and by 12 7 to 0 069 m with included bathymetries respectively the p lstm setting achieved the best accuracy for all experiments and in terms of all error metrics therefore the swh can be predicted with a mae of about 5 cm although the model does not have any historical data on the predicted position south of the etd sandbanks the reconstruction error of the ffnn decreased by 20 6 to an rmse of 0 085 m by including bathymetry features which was the greatest decrease of all models including bathymetry features decreased the rmse of the sl ffnn by 19 2 to 0 101 m of the svr by 6 6 to 0 114 m of the rf by 5 5 to 0 104 m and of the mlr by 2 0 to 0 149 m the performance of the ffnn was better or equal than the performance of the svr and rf for the reconstruction excluding and including bathymetries pirhooshyaran and snyder 2020 mentioned the superior performance of the lstm for swh reconstruction while they also had a very good performance using rf in contrast to our results it turned out that the neural networks could use the additional information on bathymetry best to increase their performance the performances of the p lstm excluding and including the bathymetries for reconstructing swh are compared in fig 10 the data points were significantly closer to the bisector when the bathymetry was included and most extreme values were reconstructed satisfactory the improvements in all error metrics also demonstrate this for example maape decreased by 11 4 and r2 increased by 1 3 for the p lstm the relative improvements in r2 and r were always below those of the other error metrics even by including bathymetric data the measured values were underestimated on average although not as much as can be seen from the solid red line in fig 10 differences in the predicted time series between the p lstm excluding and including the bathymetries for the reconstruction are illustrated in fig 11 although both lines are generally close to each other differences were found especially at local extremes while extreme values were regularly underestimated 3 3 2 prediction including bathymetry by including the bathymetric data to the 3 6 9 and 12 h ahead prediction of the lstm and p lstm the relative reduction of the rmse was about similar for both methods and all time steps resulting in a reduction of the rmses by 7 6 9 5 for the p lstm and 7 4 11 7 for the lstm thus the rmse decreased to 0 096 m 0 124 m 0 145 m and 0 165 m for the p lstm respectively table 5 valid 12 h ahead predictions were still made with the proposed models this time span can be sufficient to initiate practical solutions e g for coastal protection it underlines the good performance of neural networks especially the recurrent lstm neural networks to accurately predict complex time series data with morphodynamic influences among the benchmark methods the ffnn significantly performed best in terms of rmse and maape it improved the rmse by 11 2 for the 3 h ahead prediction and by 8 for the 12 h ahead prediction by including bathymetric data the svr rf and mlr could reduce the rmse by only up to 8 3 2 9 and 1 8 for the short term predictions respectively while the performance of all error metrics of the ffnn was similar or worse than that of the rf by excluding the bathymetries it was better by including the bathymetries for the short term predictions table 5 as seen in fig 12 the data points of the 3 h ahead prediction with included bathymetries were closer around the bisector even with the prediction of extreme events there was no increase in the prediction error of the p lstm with the inclusion of the bathymetries the prediction error of extreme events was lower in the 3 and 6 h ahead forecast of the p lstm by increasing the forecasting interval to 6 h the prediction error became larger as indicated by the more developed bulge around the bisector fig 13 illustrates the comparison between the measured and predicted values of the p lstm including and excluding the bathymetry features for the 9 and 12 h ahead prediction there is a distinctly greater bulge around the bisector as well as a stronger spread of certain predicted values nevertheless with bathymetry included the data points were closer to the bisector even at these prediction intervals the lstm gate units allow the recurrent model to remember long periods while selecting only essential information xiao et al 2019 without these morphodynamic information the models tended to underestimate extreme values figs 12 and 13 the 24 and 48 h ahead long term predictions of swh were also improved by including bathymetric data table 5 rmse and maape of the p lstm were reduced by 10 2 and 9 2 for the 24 h ahead prediction and by 9 8 and 9 5 for the 48 h ahead prediction respectively as a result the long term predictions were improved by a greater percentage in terms of rmse compared to the short term predictions by the p lstm with bathymetry features in general all models in the nearshore area improved their performance by including bathymetric features hence they are highly relevant in reconstructing and predicting swh in the study area 3 3 3 limitations of including bathymetric data the train and test split was randomly selected thus the models and their performances on the test data cannot be transferred or generalized to other areas especially other bathymetries for a better generalization more bathymetric data are necessary for training and learning the etd influence however it can be assumed that the lstm is a suitable method to process even more complex morphodynamic data in order to process 2 dimensional bathymetric data a combined lstm and convolutional neural network cnn could be promising choi et al 2020 used such a framework in a similar context with ocean images instead of bathymetric data in addition a mlr which tends to underfitting and leads to a greater generalization due to its low number of weights consistently showed an improvement by adding bathymetric data indicating a general improvement overall the bathymetric data have improved the reconstruction and prediction accuracy the results showed that the etd sandbanks have a significant influence on the propagation of the waves and the wave height on the island coast which was also found by numerical modelling jörges et al 2021 as the size and shape of the etd sandbanks are constantly changing by morphodynamic effects their influence on local forecast models must be considered in addition to continuous monitoring 3 4 further feature selection analysis while adding bathymetric features significantly improved the performance of all models one should also investigate the influence of other features it must be noted that the best performance was observed with the inclusion of all the above features hence they all contain significant information for the prediction 3 4 1 wind speed and direction even though theoretically the greatest influence is expected from wind speed by including this feature the rmse of the reconstruction was reduced by only 11 4 for the lstm and 14 8 for the p lstm supplementary material section 3 thus the influence of bathymetric features 16 7 for lstm and 12 7 for p lstm in terms of rmse was about similar to the influence of wind speed this may be due to the fact that the swh data of the two other buoy positions are affected significantly by wind speed and thus a fraction of the wind speed information is redundant the influence of the bathymetry however only becomes effective south of the two other buoy positions and is not already hidden within them in any way by reducing the rmse of the reconstruction by 21 3 for the lstm and 21 6 for the p lstm the influence of wind direction was slightly higher than for wind speed and bathymetries supplementary material section 4 the wind direction influences the non linear wave breaking at the etd sandbanks as well as fetch length and wave direction 3 4 2 water level with feature selection excluding only water level and tidal information the best rmse and r2 were 0 132 m and 0 873 for reconstruction with the p lstm respectively supplementary material section 5 since the reduction in rmse for the reconstruction was 47 8 for the lstm and 47 7 for the p lstm the influence of the water level was greater than any other single feature which can be explained by the complex nearshore location of the buoys where tides dominate the wave climate 3 4 3 swh only nearshore vs offshore performance considering only swh for reconstruction and forecast resulted in the worst prediction performance with a reconstruction rmse of 0 175 m and 0 173 m for the lstm and p lstm respectively supplementary material section 6 while the differences between the models in terms of all error metrics are huge in some cases the performances in this case except for mlr were very similar as the regression problem became simpler with less parameters the lstm methods which are optimized for complex problems may have been overfitted thus not only lstm and p lstm had the best performance but also sl ffnn and rf performed quite well in this case the best reconstruction performance on the norderney nearshore dataset was r2 0 781 for the ffnn and maape 0 2 for the p lstm compared to the performance on the deep ocean noaa dataset the scale independent error metrics were worse in the nearshore area since the best performance on the offshore dataset was r2 0 8106 although this is a small difference it must be noted that the distance between the buoy positions is much smaller in the nearshore area this emphasizes that considering swh only in the nearshore area is not a proper method and other features must be considered since the sea state is much more complex bathymetry mainly represented by the etd sandbanks for the research area of this study is a main feature in the nearshore area 4 conclusion this study aimed to reconstruct and multi step forecast swh of the nearshore area of norderney germany based on neighboring moored buoy measurements with the focus set on the model improvements by including bathymetric data on a local scale exact knowledge of nearshore wave conditions considering natural sea state damping by the morphodynamically changing etd sandbanks is essential for coastal protection planning offshore missions and running sea state and climate forecasting models it was found in our experiments that the lstm and p lstm neural networks performed best among other existing benchmark methods such as ffnn svr rf and mlr both for reconstruction and prediction compared to the lstm the rmse of the ffnn was at least 21 the svr 25 the rf 18 and the mlr 28 higher for the reconstruction and short term prediction task to achieve reliable and fair results hyperparameters were tuned using bayesian optimization for all models and reconstruction or prediction intervals an ensemble of three independent model runs was performed all models showed robust results on the test data with respect to the various training sets by including bathymetry features the performance of the proposed lstm and p lstm method in terms of rmse increased by 16 7 to an rmse of 0 07 m and by 12 7 to an rmse of 0 069 m for the reconstruction respectively the short term predictions 3 6 9 and 12 h ahead showed significantly better performance in terms of all error metrics used namely rmse r2 r maape and mae by including the bathymetries compared to other feature selections the improvements were considerable thus our findings highlight the broad potential of lstm neural networks for swh reconstruction and prediction as well as the need to consider bathymetries in morphodynamic changing coastal areas such as the east frisian islands further experiments on well studied deep ocean wave data also showed satisfactory results so the proposed method is not limited to the nearshore area the lstm and p lstm neural networks could satisfactorily predict even extreme values of swh using the bathymetric data those events that are of special interest for coastal protection and marine operations limitations of the presented study are the insufficient availability of bathymetries for training the models nevertheless the presented methods can be used for other data and regions as well using high temporal resolution measurements of a coastal radar may be a promising future way due to the accurate reconstruction and prediction of the proposed model it might also be possible to place the expensive ocean buoys more efficiently or even to drop positions completely results can also be used to verify numerical models and vice versa using additional information regarding the local wave climate such as wave period and wave direction might also be considered in future studies credit authorship contribution statement christoph jörges conceptualization methodology software validation formal analysis data curation writing original draft writing review editing visualization cordula berkenbrink conceptualization resources data curation writing review editing britta stumpe conceptualization writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors thank the coastal research station of the lower saxony water management coastal defence and nature conservation agency nlwkn for providing the buoy measurement data used in this study this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2021 109046 
20682,underwater radiated noise from marine ships represents the largest source of anthropogenic noise in oceans the world over representing a substantial and persistent stressor to the health of marine ecosystems the radiated noise from vessels can often be related to their velocity and slowing vessels in critical habitat areas has been shown to reduce the average level of ambient noise in those regions however universal speed limits ignore the significant variation in speed noise behaviour between vessels we investigated the underwater radiated noise signatures and levels from eight coastal ferry vessels each operating at a range of speeds in order to examine the underlying causes of the atypical speed noise correlations the analysis revealed discrete patterns associated with speed ranges suggesting that the increase in noise radiated at low velocities that was observed from some vessels was the result of a change in the regime of the physical mechanism generating the sound propeller induced cavitation is the strongest possible explanation for noise of this type the present results suggest that controllable pitch propellers may be susceptible to changes in cavitation regimes resulting in increased radiated noise when operated under reduced loads a finding that corroborates previous model scale experimental evidence of the same behaviour keywords underwater radiated noise cavitation induced noise field measurement 1 introduction as the world population grows so too does marine vessel traffic in the world s oceans ships represent the largest source of anthropogenic underwater noise hildebrand 2009 and growing shipping activity threatens marine ecosystems where fauna favour sound for sensing and communication clark et al 2009 jensen et al 2009 nowacek et al 2007 in the short term auditory masking from these acoustic disturbances can result in disruption of breeding in animals that use sound during mating and reproduction and disruption of foraging in animals that use sound to detect prey resulting in lower survival rates of at risk marine species when exposure is chronic harwood et al 2016 historically interest in underwater radiated noise urn from ships was primarily military however an increase in academic regulatory and commercial commitment to mitigating underwater noise pollution has resulted in a greatly expanded civilian focused body of research in the past decade most works to date have focused on source modelling bosschers 2018 ianniello et al 2013 ianniello and de bernardis 2015 lafeber et al 2015 testa et al 2018 environmental assessment cominelli et al 2018 or regulatory level management strategies frankel and gabriele 2017 joy et al 2019 while vessel slow downs have been shown to reduce total ambient noise in critical habitat areas joy et al 2019 vessel speed is not universally correlated with increased radiated noise baudin and audoly 2015 hallander et al 2015 more work is required to enable the development of mitigation strategies for radiated noise from particular vessels while source modelling provides the potential for noise mitigation strategies of this type several factors have so far prevented their adoption by fleet operators implementation of numerical noise modelling strategies is inhibited by reliability questions computational expense and the inability for fleet operators to obtain detailed propeller geometry information from manufacturers sea trials relating noise to vessel operation on the other hand are infeasible for most fleet operators as a result it remains challenging to relate underwater radiated noise to specific vessel operating conditions and it therefore also remains challenging to develop mitigation strategies at the level of individual vessels underwater radiated noise from ships is primarily generated by machinery turbulence and cavitation machinery noise is generated by a vessel s on board mechanical systems most notably the drive train vessels with fixed pitch propellers rely on their drive train to control their speed through water and the machinery induced component of radiated noise from these vessels depends on their speed vessels with controllable pitch propellers on the other hand use the pitch of their propellers for speed control they typically operate their propellers and engines at constant revolution rates and machinery noise from these vessels is therefore expected to be speed independent turbulence noise is generated around both the propeller and the hull and therefore depends on both propeller operating conditions and vessel speed through water as a mechanism of sound generation turbulence tends to be much quieter than either machinery or cavitation cavitation noise depends on similar conditions to turbulence noise with the addition of vessel draft since cavitation inception depends on the local static pressure around the propeller because cavitation commonly occurs during typical propeller operation and produces sound of a much greater amplitude than turbulence it is often the dominant source of noise emitted by marine vessels ross 1976 operating under the assumption that cavitation noise dominated the radiated noise signature from all participating vessels propeller operating conditions known to be associated with cavitation noise were the focus of the present work specifically the advance ratio j v a n d slip radio s 1 j d p pitch for controllable pitch cp propellers draft and nominal cavitation index 1 σ n p ref p vapour 0 5 ρ n 2 d 2 were all considered v a n d and p are the propeller advance velocity rotation rate diameter and dimensional pitch respectively this work aims to shed light on the relationships between vessel operating conditions and underwater radiated noise using a comprehensive set of far field acoustic measurements of passenger ferries operating off the west coast of canada the vessels operated commercially while passing by a hydrophone array along a predetermined path facilitating systematic measurements captains operated the vessels at a range of speed settings and recorded detailed vessel operating data which was combined with acoustic measurements 2 materials and methods far field underwater acoustic measurements of eight coastal ferry vessels were collected from vessels operating at varied speed settings while passing through a constricted channel spectral data were acquired with a jasco applied sciences autonomous multichannel acoustic recorder amar g3 vessels travelled a set track passing whose closest point of approach was 160 m from the recorder adherence to the track was confirmed for each measurement using geographic positioning data broadcast by each vessel over the automatic identification system ais measurements were analysed for vessel positions with a 30 azimuth angle centred on the recorder at frequencies ranging from 10 hz to 31 5 khz power spectral densities at the receiver location were computing by sliding 1 s fast fourier transforms ffts with power normalizing hanning windows with a 50 overlap background noise was corrected for using averaged noise levels from a pair of 1 min windows the first 1 min prior to the vessel entering the entrance tunnel to the channel and the second 1 min after the vessel left the exit zone measurements with interference from other vessels high levels of background noise or where the vessel deviated from the prescribed measurement procedure were rejected either automatically based on ais data or manually during a quality control review the spectra analysed throughout the present work are given in terms of radiated noise levels rnl and have been back propagated to a point source located at the gps reported vessel position assuming spherical spreading loss in accordance with ansi standard s12 64 2009 the present data have therefore not been corrected for sea surface or seabed reflections salinity and density gradients or other environmental effects on sound propagation where possible vessels were operated at five different speed settings that are defined qualitatively speeds categorized as full away fa represent the upper end of practical service speeds service speed ss is the typical speed for the route 2 kn reduction r2 and 4 kn reduction r4 are 2 kn and 4 kn slower than service speed respectively and half speed hs is half of service speed while each speed setting represents a desired speed and corresponds to a particular vessel operation setup there is variability within in each setting in terms of both actual vessel speed and other vessel operating conditions table 1 provides a description of the eight vessels for which data were collected five of the eight vessels were fitted with cp propellers which were operated at constant revolution rates and used pitch manipulation for speed control the remaining three vessels were fitted with fixed pitch fp propellers and relied on revolution rate manipulation for speed control vessel 1 was operated with only the aft depending on the travel direction propeller while travelling through the measurement area all other vessels were operated with all propellers powered vessels 5 and 6 as well as 7 and 8 were sister ships with the same design vessel 7 was operated with only three of its four main engines during the test period but operated both propellers and ran at speeds comparable to its sister ship previous analysis has found significant positive correlation between speed and broadband underwater radiated noise for vessels 2 4 and 5 while significant anti correlation between speed and noise was found for vessels 1 and 8 frouin mouy 2018 existing published works have discussed the anti correlation between speed and urn from ships with cp propellers baudin and audoly 2015 hallander et al 2015 however in the present data one vessel vessel 4 that employed a cp showed significant correlation between speed and urn representing a notable departure the expected behaviour all eight vessels studied in the present work use four bladed propellers and as such the number of blades was not considered as a parameter in the analysis blade number affects wake evolution and cavitation patterns felli et al 2008 and the application of any results from the present analysis to propellers with other blade numbers would require careful consideration of the interaction between radiated noise and changes to the wake morphology including the stability of cavitating tip vortices not all information required to assess cavitation noise for each vessel was available to the operator detailed propeller geometry was only available for vessel 1 and that vessel is therefore the primary focus of the present work it was also necessary to estimate the propeller advance velocity from the vessel speed through water however limited information was available to calculate the wake fraction therefore the simple formula of taylor as given in carlton 2007 is adopted in the present work 2 w 0 5 c b 0 05 where c b is the block coefficient of the hull the ratio of volume of the submerged portion of the hull to the product of the length beam and draft as carlton notes in 2007 this formula is simple and convenient but due to advances in hull design since the 1930s it has limited accuracy and should not be considered a reliable tool for design for the purposes of a regression or correlation analysis however the accuracy of the wake fraction estimate is unlikely to be critical in addition to the more commonly used dimensionless quantities a version of the draft normalized on the propeller diameter t d is used in the present analysis for consistency with the pitch and advance ratio as is conventional all diametral pitches p d are specified at 70 of the propeller radius 0 7 r unless otherwise noted experiments have shown that different cavitation regimes result from propellers under different loading conditions and that these unique regimes have different acoustic signatures and relative loudness iverson et al 2018 to account for the different cavitation regimes that occur when the propeller is differently loaded a pair of modified slip quantities referred to hereafter as overslip s o and underslip s u were defined the former quantifies how much more slip the propeller is experiencing that it would under designed conditions while the latter quantifies how much less slip it experiences 3 s o 0 if s s design s s design if s s design s u s s design if s s design 0 if s s design to predict the existence and extent of propeller induced cavitation requires more information than is presented in in the present work including the complete blade geometry and wake shape in many cases it may not be possible to obtain this information in fact even the information considered herein may not be available to the vessel operator the wake fraction depends on the hull form and may be estimated from the stability booklet information but is generally not known the pitch is a part of the propeller design which is generally proprietary information and is in some cases not available to the owner of the vessel as is the case for some of the vessels considered in the present work as such an attempt has been made to construct models without the need for detailed propeller and wake information among the vessels considered in the present work detailed propeller information was only available for the vessel 1 3 analysis 3 1 narrow band rnl trends with vessel speed as a first step in understanding the urn behaviour of the eight vessels broadband levels were examined on a vessel by vessel basis in order to protect the privacy of the vessel operator absolute levels have been normalized on an arbitrary reference the relationship between vessel speed and radiated noise was investigated across the recorded frequency range surface plots of rnl across vessel operating speeds and frequencies are presented in fig 1 vessels 2 4 5 and 6 all showed positive correlations between vessel speed and rnl for most frequencies while vessels 1 3 7 and 8 showed anti correlations for most frequencies however these trends did not hold over the entire frequency range the factors determining the broadband rnl behaviour of a given vessel were not clear from the available data neither observed relationship was associated with a particular propeller layout vessel size or vessel age vessels 1 3 7 and 8 which all showed anti correlation between speed and noise used controllable pitch propellers however another vessel with controllable pitch propellers vessel 4 displayed a positive speed rnl correlation this finding is particularly important from a regulatory perspective while slowdowns have been found to result in net reductions in ambient noise levels from marine vessels macgillivray et al 2019 macgillivray and li 2018 it is clear that not all vessels benefit from speed reduction the distribution of acoustic energy between frequencies was also observed to be vary between operating conditions to better visualise this a selection of single frequency band cross sections of the surfaces presented in fig 1 are shown in fig 2 vessels 1 and 8 show particularly strong spectral shape changes between high and low speed operation which is explored in greater detail in section 3 3 vessel 7 was notably a sister ship to vessel 8 and would be expected to exhibit similar characteristics in terms of radiated noise had a larger range of speeds been captured for measurement low frequency noise tended to follow a different speed trend compared to mid and high frequency noise for all eight vessels suggesting a difference in the source this result is expected where cavitation noise is significant and dominates the mid and high frequency ranges while mechanical noise dominates the low frequency domain a notable exception is blade passing frequency the frequency with which the propeller blades pass through the wake at which tonal noise generation is governed by the hydrodynamic interaction between the propeller blades and the ship s wake 3 2 multivariable linear regression analysis linear regression analysis was used in order to explore the influence of various vessel operating parameters on radiated noise due to the limited information available on vessel design the analysis was limited to vessel 1 in order to mitigate error due to potential mismatches between recorded and real operating conditions measurements that deviated by more than 50 from the travel speed or propeller pitch prescribed by their listed speed setup were excluded from this and all further analysis in following sections this reduced the total number of available measurements for the regression analysis of vessel 1 to 27 to select the parameters used in the regression model of rnl the correlation coefficients of dimensionless operating parameters and each third octave band rnl were examined as shown in fig 3 low frequency noise especially at 20 hz and below was found to be minimally correlated with vessel operation suggesting that it is dominated by mechanical noise the 10 hz band includes the blade passing frequency of 9 3 hz for this vessel and is therefore expected to be dominated by noise from blade passage effects at this frequency rnl was uniquely positively correlated with speed above 20 hz the cavitation index was found to be strongly correlated with rnl while the advance ratio equivalent in this case to speed was found to be strongly anti correlated the anti correlation with advance ratio was expected for this particular vessel since the vessel operated with a constant propeller revolution rate the cavitation number was determined almost entirely by the vessel draft and it was therefore excluded from the regression analysis the observed anti correlation between draft and noise is consistent with propeller induced cavitation noise given that the slip terms were not strongly correlated with rnl and that slip is a linear combination of advance ratio and pitch slip was excluded from the regression analysis a multivariable linear regression was performed for rnl at each third octave band using a total of 27 measurements resulting in 39 regression models of the form 4 t h i r d o c t a v e r n l f c 0 c 1 f c 2 f j c 3 f p d c 4 f t d db the constant value of c 0 is was chosen arbitrarily to allow the c 1 term in each equation to be more comparable in magnitude to the other terms for plotting the resulting model coefficients are plotted against frequency in fig 4 a while the r2 values of each regression are plotted in fig 5 comparing the magnitudes of the regression model coefficients gave some indication as to their influence although care should be taken to note that the range of values for each of the regression values is not the same a comparison of the values of each term in the linear regression using the mean value of each variable from all 27 measurements is given in fig 4b to present a fairer comparison of the influence of each term in the model on the output from this comparison it can be seen that the influence of pitch c 3 and draft c 4 was similar across most frequencies above 30 hz while the constant and advance ratio terms in the model varied more substantially with frequency it is apparent from fig 5 that a regression of the form presented in eqn 3 is not suitable for frequencies below 100 hz above this frequency the trend of each coefficient as shown in fig 4a is characterized by a pair of inflections in the absence of a reliable physical explanation for these trends it was decided that the regressions for individual frequency bands should be combined by fitting a cubic polynomial to each of the regression coefficient trend lines the resultant model is a one equation dedicated model that can predict an rnl spectrum from vessel 1 given a set of operating conditions as inputs comparisons between five experimentally measured spectra and spectra produced by this regression formula are shown in fig 6 the five measurements were chosen as examples because they were representative of five handle settings used in the operation of the vessel not because of the relative goodness or badness of the regression fits the detailed regression model successfully predicts both the general shape of the spectrum and its magnitude for most measurements to check the accuracy of the regression in reproducing the data the mean maximum absolute and rms error in predicted rnl over the applicable range of frequencies was computed for each of the 27 measurements used to generate the regression formula the results are shown in fig 7 where the errors are plotted against the speed through water of the individual measurements the spectrally averaged error is with a single exception within 5 db while some individual frequency bands are over or underestimated by up to 10 db the lack of a clear trend within the error suggests that the regression formula is equally applicable across the entire speed range the regression model that has been generated using this procedure is unlikely to be generalizable since it always predicts an anti correlation relationship between ship speed and radiated noise additionally the model is heavily reliant on the constant offset term in the equation to predict the absolute level of sound which should be expected to vary significantly between vessels based on their designs the frequency specific constant term c 1 varied between frequencies the most of any term in the regression the reason for this behaviour is difficult to determine as the term has no physical meaning but it suggests that the regression fails to represent some important physics for the same reasons it is difficult to generalize the model also provides little insight into the source of the noise 3 3 radiated noise regime analysis based on broadband spectral features the relationships between speed and rnl shown in figs 1 and 2 show evidence of a regime change in acoustic emission between high and low speed operation for vessels 1 and 8 the existence of a pair of discrete acoustic regimes provides an explanation for the shortcomings of the regression analysis since that analysis was predicated on acoustic behaviour varying continuously with cavitation related operating conditions we therefore examined spectral rnl data on a measurement by measurement basis in order to find feature sets defining discrete regimes and compared the spectra to the radiated noise signatures of specific cavitation regimes published in literature in order to find a physical explanation for the observed acoustic behaviour for vessel 1 a common set of features determined to belong to a high speed regime hsr and a low speed regime lsr were observed in all spectra collected from operating speeds above 110 of service speed and below 80 of service speed respectively v 1 1 v 0 8 the corresponding thresholds for vessel 8 were found to be 90 of service speed and 60 of service speed these four sets of measurements were used to define the set of spectral features characterizing each regime fig 8 and fig 9 show the hsr and lsr defining measurements for vessels 1 and 8 an averaged spectrum is also shown for each set of data in order to reduce scatter and make visualization of the spectral features easier the salient features of these regimes are described visually in fig 10 and fig 11 as with the regression analysis measurements that deviated by more than 50 from the travel speed or propeller pitch prescribed by their listed speed setup were excluded from the analysis however given the small number of available measurements in the low speed regimes the speed ranges were checked against the measurements that were excluded even with the larger data set which included six additional members of the low speed regime group in the case of vessel 1 all measurements belonging to one of the defining speed ranges shared these salient features the high speed regimes of each vessel share several spectral features in common in the high and mid frequency ranges including the slope of the logarithmic decay trend above approximately 300 hz a non logarithmic trend from the high tens to low hundreds of hz and a valley not seen at low speeds in a frequency range just below the peak frequency similarly the low speed regimes of the two vessels both show a pair of logarithmic decay trends with a slope reduction around 600 hz the low frequency noise signatures of the two vessels in contrast have little in common given that propeller noise especially cavitation noise tends to dominate the mid and high frequency rnl spectra of ships the most likely cause of the similarity in the behaviour of the two vessels is that each of the two acoustic regimes corresponds to a particular cavitation regime an inverse speed noise correlation would also be expected in the case that radiated noise was dominated by turbulence sound owing to an increase in wake field intensity at decreased vessel speeds however in this case continuous variation with speed would be expected instead of a discreet pair of regimes comparison of the present rnl spectra with acoustic signatures of specific cavitation regimes reported in literature further supported the hypothesis that the acoustic regimes corresponded to cavitation regimes the spectra of the high speed regime are similar to the tip vortex cavitation emission spectra observed in scaled experiments of a controllable pitch propeller discussed in iverson et al 2018 while the low speed regime spectra resemble the pressure side leading edge sheet cavitation observed for reduced pitch operation in those experiments among the measurements that did not belong to one of the defining speed sets some were identifiable as members of one of the two regimes as is the case for the measurements shown in fig 12 which was classified as a belonging to the low speed regime and fig 13 which was classified as belonging to the high speed regime other measurements exhibited a mixture of characteristics from both regimes it was unclear if these measurements were the result of time averaging of signals for which the ships propellers underwent a transition between the two acoustic emission regimes or if they represented another regime or set of regimes entirely for the purposes of this study all acoustic measurements not categorized as belonging to the high or low speed regimes were considered to belong to a transitional regime one example of such a measurement is shown in fig 14 to asses the relationship between the acoustic and presumed cavitation regimes and operating conditions other than speed through water the distribution of acoustic measurements was assessed against draft pitch and cavitation index the results for vessel 1 are shown graphically in fig 15 the spectral features associated with the low speed regime align well with those of the pressure side cavitation regime found experimentally in iverson et al 2018 to be associated with reduced pitch propeller operation the observed connection between pitch and acoustic regime changes is strong evidence that the low speed acoustic regime was associated with pressure side propeller cavitation as expected for a transition from a combination of tip vortex and suction side cavitation to pressure side cavitation there was no indication that the cavitation regime was related to either the draft or the cavitation index 3 4 narrow band spectral features low frequency spectral features revealed distinct regimes associated with speed ranges but little insight into the physical mechanisms resulting in those regimes to investigate the regimes further de trended spectra were examined for the low and high speed regimes of vessels 1 and 8 defined in 3 3 vessels 1 and 8 both employed controllable pitch propellers and their engine and propeller revolution rates were maintained constant across all speed ranges by selecting these vessels for the present analysis engine noise was eliminated as a source candidate for spectral features that change with speed de trending was accomplished by subtracting the baseline as shown in fig 16 which were computed applying shape preserving piecewise cubic interpolation and quadratic fit smoothing the resulting de trended noise spectra show narrow band features of the acoustic regimes in isolation allowing comparison between speeds and vessels the absolute magnitudes of the peaks were not considered because each plot was de trended using a different baseline however the location width and size relative to adjacent peaks are of interest fig 17 presents the de trended noise spectra of vessel 1 and 8 at low and high speed regimes narrow band spectral features at frequencies above 550 hz appear to be independent of vessel type and speed this suggests that the narrow band peaks in the high frequency range come from sources common to all measurements possible sources include common cavitation structures background noise or artifacts from filtering and correction while broad spectral features were found to show discrete changes indicative of acoustic regimes between vessel speeds narrow band features at frequencies above approximately 550 hz were observed to be largely unaffected by vessel operation indicating that frequency binned data are sufficient for analysing the radiated noise regimes of these vessels when the mid and high frequency ranges are of primary interest notable changes in the narrow band spectral features between vessels and between speed regimes for the same vessel were observed for frequencies below 550 hz in order to present a better view of the narrow band spectral features at low frequencies the de trended noise spectra is replotted with a linearly scaled x axis of up to 300 hz in fig 18 peaks with similar widths and locations are likely to be from speed invariant sources the majority of which are expected to be mechanical noise associated with engines the blade passing frequencies of vessels 1 and 8 were 9 3 hz and 13 7 hz respectively and peaks at these frequencies and their first multiples were assumed in this analysis to be associated with the blade passage phenomenon individual narrow band features that change between speed regimes are identified with alphanumeric designations these changing features are likely influenced by changing cavitation and flow features several narrow peaks between 100 and 300 hz labeled 1c 1d 8b 8c 8d and 8e in fig 18 were observed exclusively for the high speed regimes of both vessels although their source is unclear in addition to features that only existed in the rnl spectra of one of the two regimes some features changed in nature between regimes the features labeled 1a and 8a show a change in nature between the low and high speed noise regimes 1a existed as peak at high speed and a valley at low speed operation while 8a behaved in the opposite manner the feature labeled 1b also changed behaviour from a single broad hump at low speed to a collection of 3 humps at high speed the source of these spectral features as well as the cause of their change in behavior between regimes is unclear the de trended rnl spectra from vessel 8 shown in fig 18 is modulated by a frequency of approximately 4 hz this modulation is not an artifact of the de trending process it can be seen in the averaged spectra shown in fig 11 and the individual measurement spectra plotted in fig 9 the same modulation also appears in spectra from measurements of high speed operation of vessel 8 s sister ship vessel 7 since the modulation appeared for a specific acoustic regime of a specific vessel design it is likely a physical feature of the urn from these ships however its cause could not be identified no direct observations of cavitation were made in the present work and it is therefore impossible to definitively relate any spectral features to particular cavitation regimes however clear changes in peak location and structure in the low frequency range between speed regimes corresponding to changes in broadband spectral features do strongly suggest a link between specific features and individual cavitation regimes of particular note was the presence of more pronounced tonal features in the low frequency spectra of the high speed acoustic regime while sharp peaks were absent in the 100 300 hz range for the louder low speed acoustic regime this finding may indicate that a reduction in tonal urn in this frequency range is indicative of a cavitation regime change that results in greater overall acoustic emission however confirmation of such a relationship requires further investigation in addition to the broadband spectral features identified as being related to particular acoustic regimes in section 3 3 these narrow band features could be useful for identifying acoustically undesirable propeller cavitation conditions in real time allowing for active mitigation strategies 4 conclusions underwater radiated noise from eight coastal ferry vessels of various sizes ages and configurations was assessed using acoustic data collected from controlled modified commercial operation the relationship between radiated narrowband noise and the operating conditions of the vessels was investigated with specific focus placed on the propeller and cavitation related parameters speed was observed to be the most common primary determinant of narrow band noise at the majority of frequencies noise was found to be anti correlated with speed for some but not all ships that employed controllable pitch propellers the same trend was not observed for any ships using fixed pitch propellers for vessels that showed anti correlation between speed and radiated noise the quietest operation was seen close to or above their designed service speeds suggesting that an optimal speed range for radiated noise performance may exist for these vessels linear regression analysis provided limited insight into the physical mechanism of this speed noise relationship but existing experimental work lends credence to the hypothesis that the increase in radiated noise at low speeds is the result of a change in propeller induced cavitation regimes regardless of the cause the existence of an optimal speed range for some vessels with controllable pitch propellers is relevant from a regulatory perspective since it implies that speed limits or slowdowns which have been proposed or implemented on occasion for the purpose of reducing radiated noise from vessels may result in increased noise from some vessels further research is needed to discover what design factors in addition to controllable pitch propellers lead to vessels that generate increased radiated noise at low speeds for the pair of vessels that showed the strongest anti correlation between speed and noise levels a clear pair of acoustic regimes associated with high and low speed operation were observed at low frequencies tonal components were identified as unique to the acoustic regime associated with high speed operation potentially representing acoustic markers of a specific cavitation regime broadband features of the spectra associated with these acoustic regimes qualitatively resembled those of the radiated noise from tip vortex cavitation dominated and pressure side cavitation dominated propeller noise observed in previous studies further supporting the hypothesis that this change in acoustic regimes was associated with a change in cavitation regimes a transition between these cavitation regimes would account both for the increased noise at low speeds and the atypical relationship between radiated noise levels and cavitation index this change in cavitation regimes is expected to be correlated with changes in propeller pitch which was observed in the present study while it might be expected that such a change in radiated noise regimes would occur for a large number of vessels with controllable pitch propellers a means for predicting that transition a priori has yet to be identified the present results suggest that further examination of the acoustic regimes of real ships could lead to both predictive empirical models that could be used in vessel design as well as simple tools for real time acoustic identification and mitigation of undesirable cavitation types credit authorship contribution statement duncan mcintyre methodology data curation formal analysis writing original draft writing review editing visualization waltfred lee methodology formal analysis writing original draft héloïse frouin mouy investigation data curation writing review editing david hannay resources conceptualization writing review editing supervision peter oshkai conceptualization writing review editing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national sciences and engineering research council of canada 
20682,underwater radiated noise from marine ships represents the largest source of anthropogenic noise in oceans the world over representing a substantial and persistent stressor to the health of marine ecosystems the radiated noise from vessels can often be related to their velocity and slowing vessels in critical habitat areas has been shown to reduce the average level of ambient noise in those regions however universal speed limits ignore the significant variation in speed noise behaviour between vessels we investigated the underwater radiated noise signatures and levels from eight coastal ferry vessels each operating at a range of speeds in order to examine the underlying causes of the atypical speed noise correlations the analysis revealed discrete patterns associated with speed ranges suggesting that the increase in noise radiated at low velocities that was observed from some vessels was the result of a change in the regime of the physical mechanism generating the sound propeller induced cavitation is the strongest possible explanation for noise of this type the present results suggest that controllable pitch propellers may be susceptible to changes in cavitation regimes resulting in increased radiated noise when operated under reduced loads a finding that corroborates previous model scale experimental evidence of the same behaviour keywords underwater radiated noise cavitation induced noise field measurement 1 introduction as the world population grows so too does marine vessel traffic in the world s oceans ships represent the largest source of anthropogenic underwater noise hildebrand 2009 and growing shipping activity threatens marine ecosystems where fauna favour sound for sensing and communication clark et al 2009 jensen et al 2009 nowacek et al 2007 in the short term auditory masking from these acoustic disturbances can result in disruption of breeding in animals that use sound during mating and reproduction and disruption of foraging in animals that use sound to detect prey resulting in lower survival rates of at risk marine species when exposure is chronic harwood et al 2016 historically interest in underwater radiated noise urn from ships was primarily military however an increase in academic regulatory and commercial commitment to mitigating underwater noise pollution has resulted in a greatly expanded civilian focused body of research in the past decade most works to date have focused on source modelling bosschers 2018 ianniello et al 2013 ianniello and de bernardis 2015 lafeber et al 2015 testa et al 2018 environmental assessment cominelli et al 2018 or regulatory level management strategies frankel and gabriele 2017 joy et al 2019 while vessel slow downs have been shown to reduce total ambient noise in critical habitat areas joy et al 2019 vessel speed is not universally correlated with increased radiated noise baudin and audoly 2015 hallander et al 2015 more work is required to enable the development of mitigation strategies for radiated noise from particular vessels while source modelling provides the potential for noise mitigation strategies of this type several factors have so far prevented their adoption by fleet operators implementation of numerical noise modelling strategies is inhibited by reliability questions computational expense and the inability for fleet operators to obtain detailed propeller geometry information from manufacturers sea trials relating noise to vessel operation on the other hand are infeasible for most fleet operators as a result it remains challenging to relate underwater radiated noise to specific vessel operating conditions and it therefore also remains challenging to develop mitigation strategies at the level of individual vessels underwater radiated noise from ships is primarily generated by machinery turbulence and cavitation machinery noise is generated by a vessel s on board mechanical systems most notably the drive train vessels with fixed pitch propellers rely on their drive train to control their speed through water and the machinery induced component of radiated noise from these vessels depends on their speed vessels with controllable pitch propellers on the other hand use the pitch of their propellers for speed control they typically operate their propellers and engines at constant revolution rates and machinery noise from these vessels is therefore expected to be speed independent turbulence noise is generated around both the propeller and the hull and therefore depends on both propeller operating conditions and vessel speed through water as a mechanism of sound generation turbulence tends to be much quieter than either machinery or cavitation cavitation noise depends on similar conditions to turbulence noise with the addition of vessel draft since cavitation inception depends on the local static pressure around the propeller because cavitation commonly occurs during typical propeller operation and produces sound of a much greater amplitude than turbulence it is often the dominant source of noise emitted by marine vessels ross 1976 operating under the assumption that cavitation noise dominated the radiated noise signature from all participating vessels propeller operating conditions known to be associated with cavitation noise were the focus of the present work specifically the advance ratio j v a n d slip radio s 1 j d p pitch for controllable pitch cp propellers draft and nominal cavitation index 1 σ n p ref p vapour 0 5 ρ n 2 d 2 were all considered v a n d and p are the propeller advance velocity rotation rate diameter and dimensional pitch respectively this work aims to shed light on the relationships between vessel operating conditions and underwater radiated noise using a comprehensive set of far field acoustic measurements of passenger ferries operating off the west coast of canada the vessels operated commercially while passing by a hydrophone array along a predetermined path facilitating systematic measurements captains operated the vessels at a range of speed settings and recorded detailed vessel operating data which was combined with acoustic measurements 2 materials and methods far field underwater acoustic measurements of eight coastal ferry vessels were collected from vessels operating at varied speed settings while passing through a constricted channel spectral data were acquired with a jasco applied sciences autonomous multichannel acoustic recorder amar g3 vessels travelled a set track passing whose closest point of approach was 160 m from the recorder adherence to the track was confirmed for each measurement using geographic positioning data broadcast by each vessel over the automatic identification system ais measurements were analysed for vessel positions with a 30 azimuth angle centred on the recorder at frequencies ranging from 10 hz to 31 5 khz power spectral densities at the receiver location were computing by sliding 1 s fast fourier transforms ffts with power normalizing hanning windows with a 50 overlap background noise was corrected for using averaged noise levels from a pair of 1 min windows the first 1 min prior to the vessel entering the entrance tunnel to the channel and the second 1 min after the vessel left the exit zone measurements with interference from other vessels high levels of background noise or where the vessel deviated from the prescribed measurement procedure were rejected either automatically based on ais data or manually during a quality control review the spectra analysed throughout the present work are given in terms of radiated noise levels rnl and have been back propagated to a point source located at the gps reported vessel position assuming spherical spreading loss in accordance with ansi standard s12 64 2009 the present data have therefore not been corrected for sea surface or seabed reflections salinity and density gradients or other environmental effects on sound propagation where possible vessels were operated at five different speed settings that are defined qualitatively speeds categorized as full away fa represent the upper end of practical service speeds service speed ss is the typical speed for the route 2 kn reduction r2 and 4 kn reduction r4 are 2 kn and 4 kn slower than service speed respectively and half speed hs is half of service speed while each speed setting represents a desired speed and corresponds to a particular vessel operation setup there is variability within in each setting in terms of both actual vessel speed and other vessel operating conditions table 1 provides a description of the eight vessels for which data were collected five of the eight vessels were fitted with cp propellers which were operated at constant revolution rates and used pitch manipulation for speed control the remaining three vessels were fitted with fixed pitch fp propellers and relied on revolution rate manipulation for speed control vessel 1 was operated with only the aft depending on the travel direction propeller while travelling through the measurement area all other vessels were operated with all propellers powered vessels 5 and 6 as well as 7 and 8 were sister ships with the same design vessel 7 was operated with only three of its four main engines during the test period but operated both propellers and ran at speeds comparable to its sister ship previous analysis has found significant positive correlation between speed and broadband underwater radiated noise for vessels 2 4 and 5 while significant anti correlation between speed and noise was found for vessels 1 and 8 frouin mouy 2018 existing published works have discussed the anti correlation between speed and urn from ships with cp propellers baudin and audoly 2015 hallander et al 2015 however in the present data one vessel vessel 4 that employed a cp showed significant correlation between speed and urn representing a notable departure the expected behaviour all eight vessels studied in the present work use four bladed propellers and as such the number of blades was not considered as a parameter in the analysis blade number affects wake evolution and cavitation patterns felli et al 2008 and the application of any results from the present analysis to propellers with other blade numbers would require careful consideration of the interaction between radiated noise and changes to the wake morphology including the stability of cavitating tip vortices not all information required to assess cavitation noise for each vessel was available to the operator detailed propeller geometry was only available for vessel 1 and that vessel is therefore the primary focus of the present work it was also necessary to estimate the propeller advance velocity from the vessel speed through water however limited information was available to calculate the wake fraction therefore the simple formula of taylor as given in carlton 2007 is adopted in the present work 2 w 0 5 c b 0 05 where c b is the block coefficient of the hull the ratio of volume of the submerged portion of the hull to the product of the length beam and draft as carlton notes in 2007 this formula is simple and convenient but due to advances in hull design since the 1930s it has limited accuracy and should not be considered a reliable tool for design for the purposes of a regression or correlation analysis however the accuracy of the wake fraction estimate is unlikely to be critical in addition to the more commonly used dimensionless quantities a version of the draft normalized on the propeller diameter t d is used in the present analysis for consistency with the pitch and advance ratio as is conventional all diametral pitches p d are specified at 70 of the propeller radius 0 7 r unless otherwise noted experiments have shown that different cavitation regimes result from propellers under different loading conditions and that these unique regimes have different acoustic signatures and relative loudness iverson et al 2018 to account for the different cavitation regimes that occur when the propeller is differently loaded a pair of modified slip quantities referred to hereafter as overslip s o and underslip s u were defined the former quantifies how much more slip the propeller is experiencing that it would under designed conditions while the latter quantifies how much less slip it experiences 3 s o 0 if s s design s s design if s s design s u s s design if s s design 0 if s s design to predict the existence and extent of propeller induced cavitation requires more information than is presented in in the present work including the complete blade geometry and wake shape in many cases it may not be possible to obtain this information in fact even the information considered herein may not be available to the vessel operator the wake fraction depends on the hull form and may be estimated from the stability booklet information but is generally not known the pitch is a part of the propeller design which is generally proprietary information and is in some cases not available to the owner of the vessel as is the case for some of the vessels considered in the present work as such an attempt has been made to construct models without the need for detailed propeller and wake information among the vessels considered in the present work detailed propeller information was only available for the vessel 1 3 analysis 3 1 narrow band rnl trends with vessel speed as a first step in understanding the urn behaviour of the eight vessels broadband levels were examined on a vessel by vessel basis in order to protect the privacy of the vessel operator absolute levels have been normalized on an arbitrary reference the relationship between vessel speed and radiated noise was investigated across the recorded frequency range surface plots of rnl across vessel operating speeds and frequencies are presented in fig 1 vessels 2 4 5 and 6 all showed positive correlations between vessel speed and rnl for most frequencies while vessels 1 3 7 and 8 showed anti correlations for most frequencies however these trends did not hold over the entire frequency range the factors determining the broadband rnl behaviour of a given vessel were not clear from the available data neither observed relationship was associated with a particular propeller layout vessel size or vessel age vessels 1 3 7 and 8 which all showed anti correlation between speed and noise used controllable pitch propellers however another vessel with controllable pitch propellers vessel 4 displayed a positive speed rnl correlation this finding is particularly important from a regulatory perspective while slowdowns have been found to result in net reductions in ambient noise levels from marine vessels macgillivray et al 2019 macgillivray and li 2018 it is clear that not all vessels benefit from speed reduction the distribution of acoustic energy between frequencies was also observed to be vary between operating conditions to better visualise this a selection of single frequency band cross sections of the surfaces presented in fig 1 are shown in fig 2 vessels 1 and 8 show particularly strong spectral shape changes between high and low speed operation which is explored in greater detail in section 3 3 vessel 7 was notably a sister ship to vessel 8 and would be expected to exhibit similar characteristics in terms of radiated noise had a larger range of speeds been captured for measurement low frequency noise tended to follow a different speed trend compared to mid and high frequency noise for all eight vessels suggesting a difference in the source this result is expected where cavitation noise is significant and dominates the mid and high frequency ranges while mechanical noise dominates the low frequency domain a notable exception is blade passing frequency the frequency with which the propeller blades pass through the wake at which tonal noise generation is governed by the hydrodynamic interaction between the propeller blades and the ship s wake 3 2 multivariable linear regression analysis linear regression analysis was used in order to explore the influence of various vessel operating parameters on radiated noise due to the limited information available on vessel design the analysis was limited to vessel 1 in order to mitigate error due to potential mismatches between recorded and real operating conditions measurements that deviated by more than 50 from the travel speed or propeller pitch prescribed by their listed speed setup were excluded from this and all further analysis in following sections this reduced the total number of available measurements for the regression analysis of vessel 1 to 27 to select the parameters used in the regression model of rnl the correlation coefficients of dimensionless operating parameters and each third octave band rnl were examined as shown in fig 3 low frequency noise especially at 20 hz and below was found to be minimally correlated with vessel operation suggesting that it is dominated by mechanical noise the 10 hz band includes the blade passing frequency of 9 3 hz for this vessel and is therefore expected to be dominated by noise from blade passage effects at this frequency rnl was uniquely positively correlated with speed above 20 hz the cavitation index was found to be strongly correlated with rnl while the advance ratio equivalent in this case to speed was found to be strongly anti correlated the anti correlation with advance ratio was expected for this particular vessel since the vessel operated with a constant propeller revolution rate the cavitation number was determined almost entirely by the vessel draft and it was therefore excluded from the regression analysis the observed anti correlation between draft and noise is consistent with propeller induced cavitation noise given that the slip terms were not strongly correlated with rnl and that slip is a linear combination of advance ratio and pitch slip was excluded from the regression analysis a multivariable linear regression was performed for rnl at each third octave band using a total of 27 measurements resulting in 39 regression models of the form 4 t h i r d o c t a v e r n l f c 0 c 1 f c 2 f j c 3 f p d c 4 f t d db the constant value of c 0 is was chosen arbitrarily to allow the c 1 term in each equation to be more comparable in magnitude to the other terms for plotting the resulting model coefficients are plotted against frequency in fig 4 a while the r2 values of each regression are plotted in fig 5 comparing the magnitudes of the regression model coefficients gave some indication as to their influence although care should be taken to note that the range of values for each of the regression values is not the same a comparison of the values of each term in the linear regression using the mean value of each variable from all 27 measurements is given in fig 4b to present a fairer comparison of the influence of each term in the model on the output from this comparison it can be seen that the influence of pitch c 3 and draft c 4 was similar across most frequencies above 30 hz while the constant and advance ratio terms in the model varied more substantially with frequency it is apparent from fig 5 that a regression of the form presented in eqn 3 is not suitable for frequencies below 100 hz above this frequency the trend of each coefficient as shown in fig 4a is characterized by a pair of inflections in the absence of a reliable physical explanation for these trends it was decided that the regressions for individual frequency bands should be combined by fitting a cubic polynomial to each of the regression coefficient trend lines the resultant model is a one equation dedicated model that can predict an rnl spectrum from vessel 1 given a set of operating conditions as inputs comparisons between five experimentally measured spectra and spectra produced by this regression formula are shown in fig 6 the five measurements were chosen as examples because they were representative of five handle settings used in the operation of the vessel not because of the relative goodness or badness of the regression fits the detailed regression model successfully predicts both the general shape of the spectrum and its magnitude for most measurements to check the accuracy of the regression in reproducing the data the mean maximum absolute and rms error in predicted rnl over the applicable range of frequencies was computed for each of the 27 measurements used to generate the regression formula the results are shown in fig 7 where the errors are plotted against the speed through water of the individual measurements the spectrally averaged error is with a single exception within 5 db while some individual frequency bands are over or underestimated by up to 10 db the lack of a clear trend within the error suggests that the regression formula is equally applicable across the entire speed range the regression model that has been generated using this procedure is unlikely to be generalizable since it always predicts an anti correlation relationship between ship speed and radiated noise additionally the model is heavily reliant on the constant offset term in the equation to predict the absolute level of sound which should be expected to vary significantly between vessels based on their designs the frequency specific constant term c 1 varied between frequencies the most of any term in the regression the reason for this behaviour is difficult to determine as the term has no physical meaning but it suggests that the regression fails to represent some important physics for the same reasons it is difficult to generalize the model also provides little insight into the source of the noise 3 3 radiated noise regime analysis based on broadband spectral features the relationships between speed and rnl shown in figs 1 and 2 show evidence of a regime change in acoustic emission between high and low speed operation for vessels 1 and 8 the existence of a pair of discrete acoustic regimes provides an explanation for the shortcomings of the regression analysis since that analysis was predicated on acoustic behaviour varying continuously with cavitation related operating conditions we therefore examined spectral rnl data on a measurement by measurement basis in order to find feature sets defining discrete regimes and compared the spectra to the radiated noise signatures of specific cavitation regimes published in literature in order to find a physical explanation for the observed acoustic behaviour for vessel 1 a common set of features determined to belong to a high speed regime hsr and a low speed regime lsr were observed in all spectra collected from operating speeds above 110 of service speed and below 80 of service speed respectively v 1 1 v 0 8 the corresponding thresholds for vessel 8 were found to be 90 of service speed and 60 of service speed these four sets of measurements were used to define the set of spectral features characterizing each regime fig 8 and fig 9 show the hsr and lsr defining measurements for vessels 1 and 8 an averaged spectrum is also shown for each set of data in order to reduce scatter and make visualization of the spectral features easier the salient features of these regimes are described visually in fig 10 and fig 11 as with the regression analysis measurements that deviated by more than 50 from the travel speed or propeller pitch prescribed by their listed speed setup were excluded from the analysis however given the small number of available measurements in the low speed regimes the speed ranges were checked against the measurements that were excluded even with the larger data set which included six additional members of the low speed regime group in the case of vessel 1 all measurements belonging to one of the defining speed ranges shared these salient features the high speed regimes of each vessel share several spectral features in common in the high and mid frequency ranges including the slope of the logarithmic decay trend above approximately 300 hz a non logarithmic trend from the high tens to low hundreds of hz and a valley not seen at low speeds in a frequency range just below the peak frequency similarly the low speed regimes of the two vessels both show a pair of logarithmic decay trends with a slope reduction around 600 hz the low frequency noise signatures of the two vessels in contrast have little in common given that propeller noise especially cavitation noise tends to dominate the mid and high frequency rnl spectra of ships the most likely cause of the similarity in the behaviour of the two vessels is that each of the two acoustic regimes corresponds to a particular cavitation regime an inverse speed noise correlation would also be expected in the case that radiated noise was dominated by turbulence sound owing to an increase in wake field intensity at decreased vessel speeds however in this case continuous variation with speed would be expected instead of a discreet pair of regimes comparison of the present rnl spectra with acoustic signatures of specific cavitation regimes reported in literature further supported the hypothesis that the acoustic regimes corresponded to cavitation regimes the spectra of the high speed regime are similar to the tip vortex cavitation emission spectra observed in scaled experiments of a controllable pitch propeller discussed in iverson et al 2018 while the low speed regime spectra resemble the pressure side leading edge sheet cavitation observed for reduced pitch operation in those experiments among the measurements that did not belong to one of the defining speed sets some were identifiable as members of one of the two regimes as is the case for the measurements shown in fig 12 which was classified as a belonging to the low speed regime and fig 13 which was classified as belonging to the high speed regime other measurements exhibited a mixture of characteristics from both regimes it was unclear if these measurements were the result of time averaging of signals for which the ships propellers underwent a transition between the two acoustic emission regimes or if they represented another regime or set of regimes entirely for the purposes of this study all acoustic measurements not categorized as belonging to the high or low speed regimes were considered to belong to a transitional regime one example of such a measurement is shown in fig 14 to asses the relationship between the acoustic and presumed cavitation regimes and operating conditions other than speed through water the distribution of acoustic measurements was assessed against draft pitch and cavitation index the results for vessel 1 are shown graphically in fig 15 the spectral features associated with the low speed regime align well with those of the pressure side cavitation regime found experimentally in iverson et al 2018 to be associated with reduced pitch propeller operation the observed connection between pitch and acoustic regime changes is strong evidence that the low speed acoustic regime was associated with pressure side propeller cavitation as expected for a transition from a combination of tip vortex and suction side cavitation to pressure side cavitation there was no indication that the cavitation regime was related to either the draft or the cavitation index 3 4 narrow band spectral features low frequency spectral features revealed distinct regimes associated with speed ranges but little insight into the physical mechanisms resulting in those regimes to investigate the regimes further de trended spectra were examined for the low and high speed regimes of vessels 1 and 8 defined in 3 3 vessels 1 and 8 both employed controllable pitch propellers and their engine and propeller revolution rates were maintained constant across all speed ranges by selecting these vessels for the present analysis engine noise was eliminated as a source candidate for spectral features that change with speed de trending was accomplished by subtracting the baseline as shown in fig 16 which were computed applying shape preserving piecewise cubic interpolation and quadratic fit smoothing the resulting de trended noise spectra show narrow band features of the acoustic regimes in isolation allowing comparison between speeds and vessels the absolute magnitudes of the peaks were not considered because each plot was de trended using a different baseline however the location width and size relative to adjacent peaks are of interest fig 17 presents the de trended noise spectra of vessel 1 and 8 at low and high speed regimes narrow band spectral features at frequencies above 550 hz appear to be independent of vessel type and speed this suggests that the narrow band peaks in the high frequency range come from sources common to all measurements possible sources include common cavitation structures background noise or artifacts from filtering and correction while broad spectral features were found to show discrete changes indicative of acoustic regimes between vessel speeds narrow band features at frequencies above approximately 550 hz were observed to be largely unaffected by vessel operation indicating that frequency binned data are sufficient for analysing the radiated noise regimes of these vessels when the mid and high frequency ranges are of primary interest notable changes in the narrow band spectral features between vessels and between speed regimes for the same vessel were observed for frequencies below 550 hz in order to present a better view of the narrow band spectral features at low frequencies the de trended noise spectra is replotted with a linearly scaled x axis of up to 300 hz in fig 18 peaks with similar widths and locations are likely to be from speed invariant sources the majority of which are expected to be mechanical noise associated with engines the blade passing frequencies of vessels 1 and 8 were 9 3 hz and 13 7 hz respectively and peaks at these frequencies and their first multiples were assumed in this analysis to be associated with the blade passage phenomenon individual narrow band features that change between speed regimes are identified with alphanumeric designations these changing features are likely influenced by changing cavitation and flow features several narrow peaks between 100 and 300 hz labeled 1c 1d 8b 8c 8d and 8e in fig 18 were observed exclusively for the high speed regimes of both vessels although their source is unclear in addition to features that only existed in the rnl spectra of one of the two regimes some features changed in nature between regimes the features labeled 1a and 8a show a change in nature between the low and high speed noise regimes 1a existed as peak at high speed and a valley at low speed operation while 8a behaved in the opposite manner the feature labeled 1b also changed behaviour from a single broad hump at low speed to a collection of 3 humps at high speed the source of these spectral features as well as the cause of their change in behavior between regimes is unclear the de trended rnl spectra from vessel 8 shown in fig 18 is modulated by a frequency of approximately 4 hz this modulation is not an artifact of the de trending process it can be seen in the averaged spectra shown in fig 11 and the individual measurement spectra plotted in fig 9 the same modulation also appears in spectra from measurements of high speed operation of vessel 8 s sister ship vessel 7 since the modulation appeared for a specific acoustic regime of a specific vessel design it is likely a physical feature of the urn from these ships however its cause could not be identified no direct observations of cavitation were made in the present work and it is therefore impossible to definitively relate any spectral features to particular cavitation regimes however clear changes in peak location and structure in the low frequency range between speed regimes corresponding to changes in broadband spectral features do strongly suggest a link between specific features and individual cavitation regimes of particular note was the presence of more pronounced tonal features in the low frequency spectra of the high speed acoustic regime while sharp peaks were absent in the 100 300 hz range for the louder low speed acoustic regime this finding may indicate that a reduction in tonal urn in this frequency range is indicative of a cavitation regime change that results in greater overall acoustic emission however confirmation of such a relationship requires further investigation in addition to the broadband spectral features identified as being related to particular acoustic regimes in section 3 3 these narrow band features could be useful for identifying acoustically undesirable propeller cavitation conditions in real time allowing for active mitigation strategies 4 conclusions underwater radiated noise from eight coastal ferry vessels of various sizes ages and configurations was assessed using acoustic data collected from controlled modified commercial operation the relationship between radiated narrowband noise and the operating conditions of the vessels was investigated with specific focus placed on the propeller and cavitation related parameters speed was observed to be the most common primary determinant of narrow band noise at the majority of frequencies noise was found to be anti correlated with speed for some but not all ships that employed controllable pitch propellers the same trend was not observed for any ships using fixed pitch propellers for vessels that showed anti correlation between speed and radiated noise the quietest operation was seen close to or above their designed service speeds suggesting that an optimal speed range for radiated noise performance may exist for these vessels linear regression analysis provided limited insight into the physical mechanism of this speed noise relationship but existing experimental work lends credence to the hypothesis that the increase in radiated noise at low speeds is the result of a change in propeller induced cavitation regimes regardless of the cause the existence of an optimal speed range for some vessels with controllable pitch propellers is relevant from a regulatory perspective since it implies that speed limits or slowdowns which have been proposed or implemented on occasion for the purpose of reducing radiated noise from vessels may result in increased noise from some vessels further research is needed to discover what design factors in addition to controllable pitch propellers lead to vessels that generate increased radiated noise at low speeds for the pair of vessels that showed the strongest anti correlation between speed and noise levels a clear pair of acoustic regimes associated with high and low speed operation were observed at low frequencies tonal components were identified as unique to the acoustic regime associated with high speed operation potentially representing acoustic markers of a specific cavitation regime broadband features of the spectra associated with these acoustic regimes qualitatively resembled those of the radiated noise from tip vortex cavitation dominated and pressure side cavitation dominated propeller noise observed in previous studies further supporting the hypothesis that this change in acoustic regimes was associated with a change in cavitation regimes a transition between these cavitation regimes would account both for the increased noise at low speeds and the atypical relationship between radiated noise levels and cavitation index this change in cavitation regimes is expected to be correlated with changes in propeller pitch which was observed in the present study while it might be expected that such a change in radiated noise regimes would occur for a large number of vessels with controllable pitch propellers a means for predicting that transition a priori has yet to be identified the present results suggest that further examination of the acoustic regimes of real ships could lead to both predictive empirical models that could be used in vessel design as well as simple tools for real time acoustic identification and mitigation of undesirable cavitation types credit authorship contribution statement duncan mcintyre methodology data curation formal analysis writing original draft writing review editing visualization waltfred lee methodology formal analysis writing original draft héloïse frouin mouy investigation data curation writing review editing david hannay resources conceptualization writing review editing supervision peter oshkai conceptualization writing review editing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national sciences and engineering research council of canada 
20683,understanding the dynamics of an fwt floating wind turbine is essential for its design and operation since a truss structure can reduce the wave load resistance on the floating foundation it becomes more popular in industrial applications in this regard knowing the effect of slender members of the truss structure on the motion response characteristics of such an fwt is vital the present work develops a time domain method for modeling the dynamics of a floating truss structure wind turbine with multiple rotors on the deck of the platform a hybrid panel stick model is built up incorporating the potential flow theory to calculate the wave inertia force and a morison strip method to calculate the wave drag force a systematic methodology and the corresponding efficient tool have been developed to deal with the floating trussed structure consisting of a set of slender cylindrical members in arbitrary lengths diameters orientations and locations the morison dynamic solver is incorporated into the time domain solver for the fwt dynamics the proposed model is validated against a model experiment of a semi submersible fwt with a triangular shaped truss structured platform which was carried out in riam research institute for applied mechanics kyushu university good agreements between the simulation results and the experimental data confirm the validity of the developed method further numerical simulations are performed in a set of wind and wave conditions to investigate the effect of wave drag force on the fwt dynamics it is found that without the fluid viscosity resonant responses are excited in the platform motions at frequencies that are close to the natural frequencies of the fwt system via a comparison between the parked conditions and operating conditions of the fwt it is found that in the presence of steady wind the translational surge or sway motion is significantly excited at its resonance frequency this may be attributed to the work done by the wind to the fwt which enhances remarkably the total kinetic energy of the platform and consequently increases the translational surge or sway velocity of the platform at the equilibrium position applying a hybrid panel stick model will be effective in reducing all these non realistic large resonant responses keywords trussed structure slender bracings catenary mooring system viscous damping motion response analysis hybrid model 1 introduction offshore wind turbine offers a promising solution to harnessing the abundant wind resources with the development of technology the offshore wind turbine industry is gradually moving from shallow water to intermediate water and deepwater as one of the three mainstream concepts of the floating foundation to keep stability the semi submersible type has a smaller surge response than the tlp tension leg platform type and a smaller pitch response than the spar type li et al 2011 goupee et al 2014 the installation cost of the mooring system of a semi submersible foundation is also relatively lower than the other types of floating foundations liu et al 2016c as a consequence in the past decade several important configurations of the semi submersible type have been proposed e g the windfloat roddier et al 2010 deepcwind robertson et al 2014 winflo boulluec et al 2013 etc researches have been undertaken on various aspects of the semi submersible concept involving model testing robertson et al 2017 kim et al 2017 li et al 2018 koch et al 2018 numerical modeling and conceptual study bae et al 2014 bayati et al 2014 karimirad and michailides 2015 2016 2016 liu et al 2018 as well as other aspects relevant to the uncertainty analysis the control design and the fatigue prevention etc zhu et al 2016 wang et al 2016 uzunoglu et al 2018 liu et al 2018 typically these semi submersible foundations have three or four columns to provide the main buoyancy force and some other small slender members to support the stiffness of the entire structure an important issue of the semi submersible foundations is the prediction of their motion responses among which the heave response may be of particular concern at a special frequency i e the near zero excitation frequency the wave excitation force can almost disappear at the equilibrium position during the heave motion faltinsen 1993 stated that in beam seas the heave natural frequency should be larger than its near zero excitation frequency this conclusion was later confirmed by newman 1999 newman 1999 also proved that in the long wavelength regime the heave rao response amplitude operator approaches unity at the natural frequencies when using a potential flow based method the semi submersible normally endures remarkable resonant responses the reason lies in that in fact near the boundary layer of the submerged part of the floating structure the wave induced drag force which is a viscous force has not been accounted for as that is usually done in an n s navier stokes equation based solver expected discrepancies can be found in the computation results of the 6 dof degree of freedom motion responses of a fwt floating wind turbine between a potential flow based method and a cfd computational fluid dynamics method nematbakhsh et al 2015 to include the viscous effect the potential flow based method needs to be modified to some extent sarpkaya 2010 investigated the relative dominant wave loading regimes for a circular cylinder which was also listed in benitz et al 2015 and discovered that the wave diffraction theory is only strictly valid for the region of πd l 0 5 in which d is the diameter of the cylinder and l is the wavelength outside of this region the wave drag force needs to be considered other than solving the n s equation which is extremely time consuming and cost expensive an alternative way is to employ a hybrid approach combing the potential flow theory and the morison equation li and yu 2012 a list of numerical methods is given in table 1 which are primarily based on the potential flow theory and the morison equation with the aid of various modeling tools these methods apply different hybrid methodologies for modeling the hydrodynamics of the floating platform taking into consideration where to account for the diffraction radiation effect and where to account for the viscous effect by performing numerical simulations for different concepts of semi submersible fwts almost all of these researches confirmed that inclusion of the morison counterpart as a supplement to the potential flow based methods could result in more reasonable predictions for the dynamic responses of semi submersible fwts especially those having plenty of slender bracings the morison equation can be easily applied to a monopile or spar because of its simple regular geometry however with respect to a complex truss structure with a significant number of braces as shown in fig 1 unlike the braceless type e g karimirad and michailides 2015 2016 one needs to develop a systematic methodology to take into consideration of all geometric specifications i e the diameters lengths orientations and locations of all members it may involve the development of a morison mesh generator and a morison dynamic solver based on the study in liu et al 2015 an appropriate way of hybrid modeling is to apply bem boundary element method for the inertia part of wave force while using the morison method for the drag part on all the members such a way can substantially improve the computation efficiency but avoid double counting the fluid inertia and the wave excitation tran and kim 2015 besides although many of the previous researches studied the effect of viscous wave loading on the floating platform of a fwt in parked status rare research concerns the impact of viscous wave loading on the platform under the circumstance of fwt operation indeed it is crucial to investigate the role that the wave drag force takes in affecting the motion of a fwt in the presence of wind in particular whether wind matters or not in this process and the specific role of wind need to be understood as clearly as possible for this purpose the present work tries to fulfill this gap and answer the above questions the present work focuses on the prediction and analysis of the motion responses of such a complex semi submersible with truss members and the understanding of its associated phenomena a time domain method will be developed to simulate a multi rotor fwt system which involves a newly developed hybrid panel stick method using the strategy mentioned above wake effect from the upstream wind turbine will also be considered using jensen s model jensen 1983 katic et al 1986 following a validation with the experimental model test a systematic investigation using the numerical method will be undertaken to study the role of the wave drag force on the semi submersible fwt with and without the existence of wind conclusions will consequently be drawn based on the preceding analysis 2 the prototype fwt in kyushu university in recent years a multi rotor fwt has been proposed in kyushu university one of the projects in the spotlight in japan in the design a number of slender cylindrical braces are included to reduce the high wave loading and bring down the cost to maximize the absorption of the wind power three wind turbines are installed atop the primary columns of the floating foundation hu et al 2014 liu et al 2016 as a multi purpose floating marine renewable energy system solar panels are simultaneously installed at its large space deck as shown in fig 1 the generated electricity can be used by the surrounding aquaculture farm as well the layout of the mooring system and the definition of the coordinate system are displayed in fig 2 specifications of the prototype are listed in table 2 3 time domain simulation method for a floating offshore wind turbine system 3 1 motion equation of the semisubmersible in time domain in the aforementioned fwt system wave force and wind force are generally the two main external dynamic forces which the system experiences throughout the entire operation lifetime besides as a major source of the restoring force the mooring tension loads can keep the floating system from being drifted away under the action of waves and winds since the members of the structure are of small aspect ratios viscous loading in the form of drag force also serves an important role in restraining the motion response especially in the neighborhood of the resonant periods of the system therefore the motion time history for the integrated floating system can be described by the following equation based on the work of jonkman 2007 1 j 1 6 m i j a i j ξ j t 0 t k i j t τ ξ j τ d τ c i j ξ j t f i w i n d t f i w a v e t f i m o o r i n g t f i v i s c o u s t i 1 6 where m i j c i j are the mass matrix and the restoring matrix of the floating body respectively k i j is the retardation function that can be calculated through the cosine transformation of the damping coefficient b i j ω 2 k i j t 2 π 0 b i j ω cos ω t d ω a i j is the infinite frequency limit of the added mass a i j ω 3 a i j a i j ω 1 ω 0 k i j t sin ω t d t the filon quadrature method xiang 2007 is chosen to compute the fourier integrals with good accuracy the forces at the right hand side of eq 1 correspond to the wind loads the wave excitation loads the mooring tension loads and the viscous loads the hydrodynamic quantities can be solved by a standard frequency domain solver liu et al 2018a 2019 based on the assumption that the fluid is incompressible irrotational and inviscid the hydrodynamic wave excitation loads acting on the floating platform in the time domain can therefore be represented by a convolution of the wave elevation and the non causal impulse response function where the latter is determined by the fourier transform of the wave excitation forces in the frequency domain liu et al 2014 the mooring tension loads are found at each time step by the solution of an extended catenary theory jonkman 2009 via the newton raphson iteration method which is capable of considering the seabed friction to the mooring lines due to the small diameters of the cylindrical structures of the complex platform in comparison to the wavelength it is essential to include a supplemental model to account for the viscous correction for the potential flow theory a morison stick model was therefore formulated in the frequency domain liu et al 2016 and is reformulated here in the time domain section 4 1 and 4 2 3 2 aerodynamics of the multiple rotors the bemt blade element momentum theory which assumes that the blades can be divided into small annular elements that operate aerodynamically as two dimensional airfoils moriarty and hansen 2005 is applied to the aerodynamics computation of each rotor the crucial step of the bemt is to find the axial induction factor and the tangential induction factor via a standard iterative procedure let the thrust load derived respectively from the momentum theory and the blade element theory be equalized the axis induction factor a and the tangential induction factor a can be therefore deduced as follows 4 a 1 1 4 f sin 2 ϕ σ c n 5 a 1 1 4 f sin ϕ cos ϕ σ c t where f is the product of the tip loss factor and the hub loss factor c n and c t are the lift and the drag coefficients of a local blade element ϕ is the local flow angle and σ is the local solidity to compensate for the deficiency when the rotor enters into the turbulent wake state the glauert correction spera 1994 is employed after resolving the distribution of the normal and the tangential loads along the span of blades the total thrust force and the shaft torque are obtained by integrations assuming a linear variation hansen 2015 of the load distribution between neighboring blade elements note that there exist multiple rotors on the deck of the semi submersible floating foundation and the interactions between the rotors can significantly affect the loadings from the wind to reflect this phenomenon efficiently the jensen s wake model jensen 1983 katic et al 1986 also known as the park model is utilized in the present study its empirical equation is based on the conservation of momentum to model a single wake it is valid for the downstream distance approximately above one rotor diameter in the far wake region the wind speed in the wake can be expressed as 6 u w x u 1 1 1 c t b 1 2 k w x d r o t o r 2 where d r o t o r is the rotor diameter k w is the wake decay constant and x is the distance behind the upstream rotor typical values for k w range from 0 04 for offshore barthelmie et al 2009 to 0 075 for onshore cases barthelmie et al 2006 the wake decay constant sets the linear rate of wake expansion with the distance in the streamwise direction the diameter of the wake expansion is therefore given by 7 d w d r o t o r 2 k w x 3 3 modeling of the catenary mooring system in mild sea conditions the mooring line dynamics can often be described by a linearized relationship to the displacement of the floating support platform in general however the mooring system dynamics are not linear instead nonlinearities are generally evident in the force displacement relationships for the semi submersible fwt as shown in fig 1 the application of an appropriate catenary theory is necessary because the traditional catenary theory could not explain the effect of the seabed interaction with a mooring cable in the case it touches the seabed an improved method proposed by jonkman 2009 is used in this work which is capable of accounting for the above issue the analytical model which is given in terms of two unknown variables i e the horizontal and the vertical components of the effective tension in each mooring line at the fairlead is formulated as follows 8 x f f h f v l f v w f h w l n f v f h 1 f v f h 2 f h l e a c b w 2 e a l f v w 2 l f v w f h c b w m a x l f v w f h c b w 0 9 z f f h f v f h w 1 f v f h 2 1 f v w l f h 2 1 e a f v l w l 2 2 where x f and z f are respectively the horizontal and vertical coordinates of the fairlead position relative to the anchor f h and f v are the horizontal and vertical components of the effective tension in the mooring line at the fairlead w is the mass of the mooring line per unit length l is the total unstretched mooring line length c b is the drag coefficient of seabed static friction and ea is the sectional stiffness of the mooring line it is worth noting that equations 8 and 9 should be solved iteratively in the local coordinate system via the newton raphson method etc 3 4 solution of the time domain motion equation several numerical integration methods can solve a differential equation of the second order in the time domain such as the newmark beta scheme wikipedia 2020a adams moulton scheme wikiversity 2020 adams bashforth scheme wikiversity 2020 and runge kutta scheme wikipedia 2020b herein the fourth order runge kutta scheme is selected to find the solution of eq 1 as it can acquire as more as enough accuracy ran 2000 li and teng 2002 let us consider the time domain motion equation in the form of ξ q t ξ ξ i e 10 q t ξ t ξ t m a 1 0 t k t τ ξ τ d τ c ξ t f w i n d t f w a v e t f m o o r i n g t f v i s c o u s t where a letter in bold represents a matrix and represents a vector the solutions at each time step can be found via the fourth order runge kutta scheme as the following 11 ξ t δ t ξ t δ t ξ t δ t q 1 q 2 q 3 6 12 ξ t δ t ξ t q 1 2 q 2 2 q 3 q 4 6 where 13 q 1 δ t q t ξ t ξ t 14 q 2 δ t q t δ t 2 ξ t δ t ξ t 2 ξ t q 1 2 15 q 3 δ t q t δ t 2 ξ t δ t ξ t 2 δ t q 1 4 ξ t q 2 2 16 q 4 δ t q t δ t ξ t δ t ξ t δ t q 2 2 ξ t q 3 4 a morison stick method for modeling floating truss structures in time domain 4 1 theory formulation and numerical implementation of the morison stick method the viscous effect plays an important role in the dynamic response of such a semi submersible since the diameters of the slender braces are small in comparison to the wavelengths in a typical sea condition a morison type method is necessary to be employed in combination with the potential flow theory based on the conclusion of liu et al 2016 an appropriate hybrid approach can apply a morison method in the calculation of the wave drag force and a potential flow theory based method in the calculation of the platform inertia force such a combination can lead to the high accuracy of prediction this concept will be applied as well to the present time domain method following leblanc et al 1993 the wave drag force upon a cylindrical member can be obtained via the integration along its length i e 17 f d 1 2 ρ c d s e d m e m v r t v r t d l where c d d m e m and l are respectively the drag coefficient the diameter and the length of a cylindrical member ρ is the water density v r t is the absolute value of v r t which is the transverse component of the wave body relative velocity v r besides s and e represent the start and the end of a cylindrical member respectively the wave body relative velocity v r is the difference between the wave particle velocity v w and the motion velocity of a floating structure v m i e 18 v r v w v m it is easy to know the floating structure motion at the centroid of a morison element can be calculated as 19 v m ξ 1 ξ 2 ξ 3 t ξ 4 ξ 5 ξ 6 t r p v g where ξ i i 1 6 represents the platform motion velocity in the ith dof r x x g y y g z z g t represents the position vector of the morison element in the body fixed system the superscript t means transpose of the vector v g ξ 1 ξ 2 ξ 3 ξ 4 ξ 5 ξ 6 t is the platform velocity vector at the gravity center of the floating structure and p stands for the following translational to rotational transformation matrix 20 p 1 0 0 0 1 0 0 0 1 0 z z g y y g z z g 0 x x g y y g x x g 0 based on the principle of the double vector product the transverse component v t of a velocity vector v can be expressed by 21 v t l v l v v l l t v where l l x l y l z is the unit vector along the axial direction of the cylindrical member to which the morison element belongs and t is the axial to transverse transformation matrix that is calculated by 22 t i l l t 1 l x 2 l x l y l x l z l y l x 1 l y 2 l y l z l z l x l z l y 1 l z 2 where i stands for the 3 order identity matrix taking into consideration simultaneously eq 18 22 the transverse component of the relative water velocity can be expressed by 23 v r t t v w tp v g and the wave drag force upon a segment of a cylindrical member can be written as 24 f d i j 1 2 ρ c d i d m e m i δ l i j t i j v w i j t i j p i j v g t i j v w i j t i j p i j v g 25 m d i j r i j 1 2 ρ c d i d m e m i δ l i j t i j v w i j t i j p i j v g t i j v w i j t i j p i j v g where the superscripts i j stand for the jth morison segment of the ith cylindrical member therefore the viscous force at the right hand side of eq 1 can be finally deduced in the following form 26 f v i s c o u s t i 1 n m e m j 1 n s e g i p i j t f d i j where n m e m represents the number of all cylindrical members and n s e g i represents the number of morison segments on the ith cylindrical member upon each tubular member the local incident wave kinematics as mentioned in section 4 2 is used to calculate its quadratic wave drag force in either a regular wave or irregular waves by the morison dynamic solver the vector f v i s c o u s is then calculated at every time step with the present displacement and the motion velocity of the floating structure after that by resolving the time domain motion equation eq 10 the displacement and the motion velocity of the floating structure can be updated for the calculation at the next time step in respect of the numerical implementation of the wave drag model a morison stick mesh generator is specially developed to generate the stick mesh as shown in fig 3 the hybrid mesh is created for the immersed part of the floating structure under the mean water level the number of morison segments on each of the cylindrical members can be set at the users discretion in advance in the stick mesh generator the location and affiliation of each morison segment on each of the cylindrical members the equivalent cross section diameter the axis length the axis direction and the drag coefficients c d of each cylindrical member are recorded into the generated stick mesh as an input file to the time domain solver 4 2 fluid kinematics of incident waves in regular and irregular waves considering an airy wave transmitting with a small amplitude a and an angular frequency w in the water with a finite depth of h the incident wave potential for this regular wave at any position x y z can be described by 27 φ x y z t re i g a ω cosh k z h cosh k h e i k x cos β y sin β i ω t where β is the wave heading angle measured from the positive x direction and k is the wavenumber by taking the derivative with respect to the spatial variables the wave particle velocity in the space can be deduced as 28 u x y z t φ x g k a cos β ω cosh k z h cosh k h cos k x cos β y sin β ω t 29 v x y z t φ y g k a sin β ω cosh k z h cosh k h cos k x cos β y sin β ω t 30 w x y z t φ z g k a ω sinh k z h cosh k h sin k x cos β y sin β ω t where u v and w represent the fluid velocity v w in x y and z direction respectively in irregular waves the above three components can be finally derived as 31 u x y z t i 1 n g k i a i cos β ω i cosh k i z h cosh k i h cos k i x cos β y sin β ω i t ε i 32 v x y z t i 1 n g k i a i sin β ω i cosh k i z h cosh k i h cos k i x cos β y sin β ω i t ε i 33 w x y z t i 1 n g k i a i ω i sinh k i z h cosh k i h sin k i x cos β y sin β ω i t ε i where the subscript i represents the ith frequency component ε i is a random phase uniformly distributed between 0 and 2 π the ith component of wave amplitude a i can be calculated from 34 a i ω i 2 s ω i δ ω i where δ ω i is the bandwidth of the discretized wave angular frequency and s ω i represents the local power spectrum of irregular waves at a specific site e g jonswap joint north sea wave observation project spectrum and p m pierson moskowitz spectrum etc note that for the deepwater case the ratio of two hyperbolic functions degrades to the exponential function e k z in eq 27 30 and e k i z in eq 31 33 5 validation of the time domain hybrid panel stick method a model experiment was carried out in the towing tank 65 m length 5 m width and 7 m depth of riam kyushu university the purpose of the experiment was to check the hydrodynamic performance of the platform and provide a benchmark database for the validation of the numerical code the platform test model was of 1 50 scale with a displacement of 0 01693 m3 each catenary mooring line in the model experiment was substituted by a spring that had an equivalent stiffness to the linearized stiffness of the mooring line all the springs were anchored to a movable steel frame which was specifically set for the arrangement of the mooring layout fig 4 two high speed digital cameras ditect has l1 1280 1024 pixel 50fps are set aside the towing tank three yellow spherical markers are placed atop the rotor plate for the motion capturing during the experiment before the tank test the camera system was calibrated by a cubic steel frame with eight spherical markers respectively set at its vertices the positions of the eight markers in the user defined coordinate system and two photos of the cubic steel frame from the respective view of each camera were input to the dippmotionpro3d software that was used for processing the camera recorded videos when the tank test started the wind and the waves could be generated and therefore caused the floating platform to oscillate the platform motion was captured via the movements of the three markers respectively by the two monitoring cameras after completing the tank test the dippmotionpro3d software was used to analyze the videos and calculate the motion time histories of the three markers thereby any point on the floating platform could be calculated based on its relative position to the three markers to validate the preceding hybrid panel stick time domain method the wind was not taken into consideration in either the experiment or the numerical model the experimental conditions of incident regular waves are given in table 3 in the numerical model the wavelengths of the incident regular waves range from 0 05l to 7 0l l is the characteristic length of the triangular platform and the time step is t 100 t is the wave period the numerical results of the present time domain method are compared with the frequency domain results and the experiment in fig 5 and fig 6 for the fairness between the numerical models in the frequency domain model only the incident waves are considered for the wave kinematics to be consistent with eq 27 30 of the time domain model this means that the wave field is considered not to have been disturbed by the diffracted waves in general good agreements can be found between the simulation results and the experiment data however an exception occurs in the heave motion that the experimental data are a bit lower than the numerical simulations when λ l 5 0 while the latter two tend to approach unity with the increase of λ l newman 1999 proved theoretically that in the long wavelength regime the heave rao should approach unity which in general agrees with the numerical results in figs 5 b and figure 6 c moreover the discrepancies between the frequency domain and the time domain results for the heave motion prove the sensitivity of numerical models within this resonant region when wave heading is 90 deg the platform is mainly excited in the sway direction therefore the motion rao in surge is small and the respective measuring error using the experimental facility is larger which is acceptable and within expectation 6 results and discussion 6 1 load cases of the simulations in order to analyze the effect of the wave drag force on the motion response of the fwt with numerous truss members numerical simulations are thereby performed based on the developed time domain method simulations for the fwt in parked status and operating status are carried out separately to discover different phenomena and reveal different mechanisms the load cases are shown in table 4 for the subsequent analysis for the wind conditions wind speeds at the rated case v wind 11 4 m s and an above rated case v wind 15 2 m s have been considered in the above rated case the wind turbine applies a collective blade pitch controller in respect of the wave conditions unidirectional irregular waves with spectrums in jonswap type are considered as shown in fig 7 simulated spectrums are evaluated from the simulated wave dynamics based on eq 27 which are found to be in good agreement with the theoretical spectrums in addition for the convenience of the analysis natural frequencies of the fwt system can be evaluated beforehand with the assist of a commercial bem software such as wamit lee 1995 hydrostar chen 2004 etc or an open source bem solver hams liu 2019 in combination with an open source mooring solver map masciola et al 2013a 2013b 2013b and its python wrapper masciola 2015 liu et al 2018b which are listed in table 5 based on a heave free decay test performed by cfd in openfoam gao et al 2019 2021 the heave natural period can be calculated from fig 8 as 17 44 s which is very much close to the heave natural period from the present method i e 2π 0 36 17 45 s 6 2 motion response of the floating wind turbine in parked status since the wave drag force acting as a certain kind of viscous wave damping upon an fwt platform is purely hydrodynamic priority is first given to the motion response of the proposed fwt when it is in parked conditions there is no wind in still air but only waves for simplicity misalignment between waves and wind has not been considered i e waves and wind always inflow from the same direction responses of the fwt system are simulated using the aforementioned time domain method before the numerical simulation a convergence test is performed against the time step as shown in fig 9 it is found that the size of the time step has little influence on the time history results therefore a time step of 0 5 s is chosen for each simulation with a simulation time of 2048 s 2 to the power of n n is an integer for the sake of the subsequent spectral analysis using fft fast fourier transform method time series of the platform motions in 6 dof modes are shown in figs 10 and 11 respectively for the wind wave directions in 0 deg and 90 deg as shown in fig 10 since the waves incident from 0 deg toward the positive x direction the platform basically displaces in surge heave and pitch modes fig 10 a e and i particularly e and i show that the amplitude of the platform motion response is decreased due to the existence of the viscous effect the averaged response amplitudes of heave and pitch motions are significantly decreased by 57 85 and 13 92 also with the inclusion of the fluid viscosity the coupling between different motion dofs is likely to be enhanced as can be observed from fig 10 g and k based on the dat2spec subroutine of the wafo wave analysis for fatigue and oceanography open source toolbox brodtkorb et al 2000 spectral analysis is performed on the motion response time series in each mode it is seen that in surge heave and pitch a pure potential flow model without any viscosity leads to a resonant response in correspondence to the natural frequency of the fwt system in that mode while applying a hybrid panel stick model can be effective to include the fluid viscosity and hence reduce the fictitious energy of the resonant response fig 10 b f and j show that the surge the heave and the pitch resonances occur at respectively ω 0 0644 rad s ω 0 3528 rad s and ω 0 2761 rad s which are close to respectively the surge natural frequency ω 0 07 rad s the heave natural frequency ω 0 36 rad s and the pitch natural frequency ω 0 32 rad s as displayed in table 5 moreover figs 10 e and 6 i show that the wave drag force reduces the mean amplitude of the motion time series in heave and pitch respectively in addition to the resonant responses there exists another wave induced response that is excited by the irregular waves the peak frequency of which corresponding to the peak frequency of the incident wave spectrum fig 10 b f and j show that the wave drag force slightly reduces the peak of the wave induced response since the wave incidents from 0 deg the sway the roll and the yaw motions are reasonably in extremely small magnitudes in fig 10 g the existence of viscous damping likely increases the magnitude of the roll motion that is because without viscous damping the roll motion should be almost zero in contrast with the existence of viscous damping which can be viewed as an equivalent to a damping matrix the roll motion is slightly disturbed by the motions in other modes such as heave etc however since the values are almost negligible it is hard to draw significant conclusions based on these limited results and should be considered further fig 11 shows the motion time series of the fwt when the waves incident from the 90 deg direction the platform displaces basically in sway heave roll and yaw while the pitch motion is strongly coupled with the heave motion as shown in fig 11 c e g i and k fig 11 a shows that the surge motion is also affected by enhancing the motion response of the resonant frequency component fig 11 d f h and j show that the sway the heave the roll and the pitch resonances occur at respectively ω 0 0644 rad s ω 0 3497 rad s ω 0 2761 rad s and ω 0 2761 rad s which are close to respectively the sway natural frequency ω 0 07 rad s the heave natural frequency ω 0 36 rad s the roll natural frequency ω 0 32 rad s and the pitch natural frequency ω 0 32 rad s as displayed in table 5 with the existence of the fluid viscosity the resonances are effectively reduced which can be known from the red line simulation results with the wave viscous damping moreover similar to that has been found in fig 10 the viscous wave effect decreases slightly the peak of the wave induced response excited by the irregular waves with a jonswap spectrum as shown in fig 11 d f h j and l worth noting is that the presence of the fluid viscosity is likely to enhance the coupling between the motions in different dofs which can be observed from the resonant response energy of the yaw response spectrum as shown in fig 11 l 6 3 motion response of the floating wind turbine in operation after knowing the motion response characteristics of the fwt in the still air condition it is interesting to know what the characteristics will be like if the wind is involved as well in this section therefore simulations are performed for the fwt when it is in operation to give a clear explanation turbulent winds and misalignments between wind and waves are not considered here in other words the wind steadily comes from the same direction as the waves each of the simulations lasts for 2048 s with a time step of 0 5 s time series of the platform motions in 6 dof modes are shown in figs 12 and 13 respectively for the wind wave directions in 0 deg and 90 deg fig 12 shows the platform motion time histories and the spectral analysis when the waves and the wind come from the positive x direction similar to fig 10 the platform displaces in surge heave and pitch as shown in fig 12 a e and i it is found that in general the motion amplitudes in almost all the dofs have been decreased by the inclusion of the fluid viscosity in the presence of wind again the same resonant frequencies are obtained with the aid of the wafo toolbox which are in coincidence with the natural frequencies in table 5 worth noting is that the resonance in the surge motion without the fluid viscosity can be excited prominently in the presence of the wind that is to say the one component of the surge motion which consists of an infinite set of components with different frequencies with a frequency equivalent to that of the surge resonance ω 0 0644 rad s is particularly excited due to the existence of the wind this phenomenon can be confirmed again by the spectral analysis of the pitch motion time series as given in fig 12 j in comparison to fig 10 j i e the case without wind there is an additional distinctive resonant response with a peak at the surge resonance frequency ω 0 0644 rad s it can be known for sure that this peak is induced by the resonant response of the surge motion since the pitch and the surge motions are strongly coupled however in the presence of the fluid viscosity the surge resonant response diminishes and the pitch resonant response is also significantly reduced as shown in fig 10 b and j the reason why the steady wind excites the surge resonance can be explained as below 1 in the still air condition as shown in fig 10 a the equilibrium position of the platform motion is set at the origin of the ground based global coordinate system starting from the equilibrium position the platform moves with an initial velocity which is induced by the waves 2 in the presence of the steady wind the equilibrium position of the platform surge motion changes to a place having a distance 2 5 m in the present case as shown in fig 12 a from the origin resulting from the new balance between the actions of the wind thrust force the wave excitation force and the mooring restoring force the work that the wind has done to the fwt along the 2 5 m distance increases the total kinetic energy of the platform remarkably and therefore increases the surge velocity of the platform at the equilibrium position 3 without the existence of wave viscous damping much larger than the wave radiation damping at the platform resonant frequency the amplitude of the platform surge motion can increase to a considerable value in reality the existence of wave viscous damping reduces the amplitude of the platform motion significantly fig 13 shows the motion time series of the fwt when the waves and the wind come from the 90 deg direction similar to fig 11 the platform displaces basically in sway heave roll and yaw as well as pitch that is induced by the coupled heave motion as shown in fig 13 c e g k and i fig 13 a shows that the surge motion is affected as well by enhancing the motion response of the resonant frequency component again the translational sway motion with the assumption of no fluid viscosity is excited particularly at the sway resonant frequency ω 0 0644 rad s which is close to the natural frequency ω 0 07 rad s of the fwt system in the sway mode as shown in fig 13 c and d the reason for the excitation of the sway resonant response is analogous to that of the surge in fig 12 a and b as a consequence a resonance at the sway resonant frequency ω 0 0644 rad s is also excited in the platform roll motion which can be confirmed from fig 13 g and h it is because of the strong coupling between the platform sway motion and the roll motion with the existence of the fluid viscosity the amplitudes of these platform motion time series are effectively decreased as well as the resonant response peaks in their spectrums 7 conclusions this paper presents a time domain method for modeling the dynamics of an fwt with multiple rotors on the deck of a semi submersible floating platform it is particularly noticed that the floating foundation is a truss structure consisting of many slender braces such slim members can bring a significant effect of the viscous wave damping which is caused by the wave drag force upon those members a systematic methodology of modeling such a floating truss structure is established based on the proposed time domain hybrid panel stick method combining the potential flow theory for large diameter structures with the morison strip method for small diameter structures in the meantime an efficient tool has been developed to deal with a set of slender cylindrical members in arbitrary lengths diameters orientations and locations the tool includes a stick mesh generator and a morison dynamic solver the morison dynamic solver has been incorporated into the time domain solver for the fwt dynamics the developed methodology and software are then applied to an fwt developed in kyushu university it is validated with an experiment in regular waves in the wave tank of riam kyushu university the simulation results agree with the experimental data confirming the validity of the developed method for the fwt further numerical simulations are carried out under a set of wind and wave conditions comparisons are made between the parked wind turbine and the operating wind turbine and between simulations with and without the viscous damping it is found that in all cases of conditions without consideration of the wave drag force the platform has a resonant response occurring at the resonant frequency of each dof the resonant frequencies are close to the natural frequencies of the fwt system with moorings in addition to the resonant response the wave induced response is always excited whose peak frequency coincides with that of the incident wave spectrum however in the presence of viscous damping the peak value of wave induced response can be slightly reduced with the effect of viscous damping which the morison dynamic solver evaluates the resonant response of each dof can be suppressed it means that the energy of resonant response dissipates with the fluid viscosity in the presence of steady wind the translational surge or sway motion can be significantly excited at its resonance frequency in comparison to the case when the wind turbine is parked it is mainly due to the work that the wind has done to the fwt which enhances remarkably the total kinetic energy of the platform and therefore increases the translational velocity of the platform in the surge or sway dof at the equilibrium position an additional resonant response due to the sway or surge resonance is excited in the rotational platform motion of the roll or pitch dof it can be attributed to the strong couplings between the sway and the roll motions and between the surge and the pitch motions these findings are believed to be of great importance to the design and operation of such fwt systems funding the first author is also grateful to the financial support from the open research fund grant number lp1815 of the state key laboratory of coastal and offshore engineering sklcoe of dalian university of technology the overseas collaborative research program grant number pjt 8 of the japan society of naval architects and ocean engineers jasnaoe and the grant in aid for early career scientists jsps kakenhi grant number jp18k13939 credit authorship contribution statement yingyi liu methodology software formal analysis writing original draft visualization investigation writing review editing changhong hu conceptualization investigation writing review editing project administration makoto sueyoshi conceptualization experiment validation investigation shigeo yoshida investigation writing review editing hidetsugu iwashita experiment investigation writing review editing masashi kashiwagi experiment writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the authors thank the anonymous referees for their constructive comments during the revision process nomenclature bem boundary element method bemt blade element momentum theory cfd computational fluid dynamics dof degree of freedom fwt floating wind turbine hams hydrodynamic analysis of marine structures jonswap joint north sea wave observation project map mooring analysis program msl mean sea level n s navier stokes p m pierson moskowitz rao response amplitude operator riam research institute for applied mechanics tlp tension leg platform wafo wave analysis for fatigue and oceanography winflo wind turbine with innovative design for floating lightweight offshore 
20683,understanding the dynamics of an fwt floating wind turbine is essential for its design and operation since a truss structure can reduce the wave load resistance on the floating foundation it becomes more popular in industrial applications in this regard knowing the effect of slender members of the truss structure on the motion response characteristics of such an fwt is vital the present work develops a time domain method for modeling the dynamics of a floating truss structure wind turbine with multiple rotors on the deck of the platform a hybrid panel stick model is built up incorporating the potential flow theory to calculate the wave inertia force and a morison strip method to calculate the wave drag force a systematic methodology and the corresponding efficient tool have been developed to deal with the floating trussed structure consisting of a set of slender cylindrical members in arbitrary lengths diameters orientations and locations the morison dynamic solver is incorporated into the time domain solver for the fwt dynamics the proposed model is validated against a model experiment of a semi submersible fwt with a triangular shaped truss structured platform which was carried out in riam research institute for applied mechanics kyushu university good agreements between the simulation results and the experimental data confirm the validity of the developed method further numerical simulations are performed in a set of wind and wave conditions to investigate the effect of wave drag force on the fwt dynamics it is found that without the fluid viscosity resonant responses are excited in the platform motions at frequencies that are close to the natural frequencies of the fwt system via a comparison between the parked conditions and operating conditions of the fwt it is found that in the presence of steady wind the translational surge or sway motion is significantly excited at its resonance frequency this may be attributed to the work done by the wind to the fwt which enhances remarkably the total kinetic energy of the platform and consequently increases the translational surge or sway velocity of the platform at the equilibrium position applying a hybrid panel stick model will be effective in reducing all these non realistic large resonant responses keywords trussed structure slender bracings catenary mooring system viscous damping motion response analysis hybrid model 1 introduction offshore wind turbine offers a promising solution to harnessing the abundant wind resources with the development of technology the offshore wind turbine industry is gradually moving from shallow water to intermediate water and deepwater as one of the three mainstream concepts of the floating foundation to keep stability the semi submersible type has a smaller surge response than the tlp tension leg platform type and a smaller pitch response than the spar type li et al 2011 goupee et al 2014 the installation cost of the mooring system of a semi submersible foundation is also relatively lower than the other types of floating foundations liu et al 2016c as a consequence in the past decade several important configurations of the semi submersible type have been proposed e g the windfloat roddier et al 2010 deepcwind robertson et al 2014 winflo boulluec et al 2013 etc researches have been undertaken on various aspects of the semi submersible concept involving model testing robertson et al 2017 kim et al 2017 li et al 2018 koch et al 2018 numerical modeling and conceptual study bae et al 2014 bayati et al 2014 karimirad and michailides 2015 2016 2016 liu et al 2018 as well as other aspects relevant to the uncertainty analysis the control design and the fatigue prevention etc zhu et al 2016 wang et al 2016 uzunoglu et al 2018 liu et al 2018 typically these semi submersible foundations have three or four columns to provide the main buoyancy force and some other small slender members to support the stiffness of the entire structure an important issue of the semi submersible foundations is the prediction of their motion responses among which the heave response may be of particular concern at a special frequency i e the near zero excitation frequency the wave excitation force can almost disappear at the equilibrium position during the heave motion faltinsen 1993 stated that in beam seas the heave natural frequency should be larger than its near zero excitation frequency this conclusion was later confirmed by newman 1999 newman 1999 also proved that in the long wavelength regime the heave rao response amplitude operator approaches unity at the natural frequencies when using a potential flow based method the semi submersible normally endures remarkable resonant responses the reason lies in that in fact near the boundary layer of the submerged part of the floating structure the wave induced drag force which is a viscous force has not been accounted for as that is usually done in an n s navier stokes equation based solver expected discrepancies can be found in the computation results of the 6 dof degree of freedom motion responses of a fwt floating wind turbine between a potential flow based method and a cfd computational fluid dynamics method nematbakhsh et al 2015 to include the viscous effect the potential flow based method needs to be modified to some extent sarpkaya 2010 investigated the relative dominant wave loading regimes for a circular cylinder which was also listed in benitz et al 2015 and discovered that the wave diffraction theory is only strictly valid for the region of πd l 0 5 in which d is the diameter of the cylinder and l is the wavelength outside of this region the wave drag force needs to be considered other than solving the n s equation which is extremely time consuming and cost expensive an alternative way is to employ a hybrid approach combing the potential flow theory and the morison equation li and yu 2012 a list of numerical methods is given in table 1 which are primarily based on the potential flow theory and the morison equation with the aid of various modeling tools these methods apply different hybrid methodologies for modeling the hydrodynamics of the floating platform taking into consideration where to account for the diffraction radiation effect and where to account for the viscous effect by performing numerical simulations for different concepts of semi submersible fwts almost all of these researches confirmed that inclusion of the morison counterpart as a supplement to the potential flow based methods could result in more reasonable predictions for the dynamic responses of semi submersible fwts especially those having plenty of slender bracings the morison equation can be easily applied to a monopile or spar because of its simple regular geometry however with respect to a complex truss structure with a significant number of braces as shown in fig 1 unlike the braceless type e g karimirad and michailides 2015 2016 one needs to develop a systematic methodology to take into consideration of all geometric specifications i e the diameters lengths orientations and locations of all members it may involve the development of a morison mesh generator and a morison dynamic solver based on the study in liu et al 2015 an appropriate way of hybrid modeling is to apply bem boundary element method for the inertia part of wave force while using the morison method for the drag part on all the members such a way can substantially improve the computation efficiency but avoid double counting the fluid inertia and the wave excitation tran and kim 2015 besides although many of the previous researches studied the effect of viscous wave loading on the floating platform of a fwt in parked status rare research concerns the impact of viscous wave loading on the platform under the circumstance of fwt operation indeed it is crucial to investigate the role that the wave drag force takes in affecting the motion of a fwt in the presence of wind in particular whether wind matters or not in this process and the specific role of wind need to be understood as clearly as possible for this purpose the present work tries to fulfill this gap and answer the above questions the present work focuses on the prediction and analysis of the motion responses of such a complex semi submersible with truss members and the understanding of its associated phenomena a time domain method will be developed to simulate a multi rotor fwt system which involves a newly developed hybrid panel stick method using the strategy mentioned above wake effect from the upstream wind turbine will also be considered using jensen s model jensen 1983 katic et al 1986 following a validation with the experimental model test a systematic investigation using the numerical method will be undertaken to study the role of the wave drag force on the semi submersible fwt with and without the existence of wind conclusions will consequently be drawn based on the preceding analysis 2 the prototype fwt in kyushu university in recent years a multi rotor fwt has been proposed in kyushu university one of the projects in the spotlight in japan in the design a number of slender cylindrical braces are included to reduce the high wave loading and bring down the cost to maximize the absorption of the wind power three wind turbines are installed atop the primary columns of the floating foundation hu et al 2014 liu et al 2016 as a multi purpose floating marine renewable energy system solar panels are simultaneously installed at its large space deck as shown in fig 1 the generated electricity can be used by the surrounding aquaculture farm as well the layout of the mooring system and the definition of the coordinate system are displayed in fig 2 specifications of the prototype are listed in table 2 3 time domain simulation method for a floating offshore wind turbine system 3 1 motion equation of the semisubmersible in time domain in the aforementioned fwt system wave force and wind force are generally the two main external dynamic forces which the system experiences throughout the entire operation lifetime besides as a major source of the restoring force the mooring tension loads can keep the floating system from being drifted away under the action of waves and winds since the members of the structure are of small aspect ratios viscous loading in the form of drag force also serves an important role in restraining the motion response especially in the neighborhood of the resonant periods of the system therefore the motion time history for the integrated floating system can be described by the following equation based on the work of jonkman 2007 1 j 1 6 m i j a i j ξ j t 0 t k i j t τ ξ j τ d τ c i j ξ j t f i w i n d t f i w a v e t f i m o o r i n g t f i v i s c o u s t i 1 6 where m i j c i j are the mass matrix and the restoring matrix of the floating body respectively k i j is the retardation function that can be calculated through the cosine transformation of the damping coefficient b i j ω 2 k i j t 2 π 0 b i j ω cos ω t d ω a i j is the infinite frequency limit of the added mass a i j ω 3 a i j a i j ω 1 ω 0 k i j t sin ω t d t the filon quadrature method xiang 2007 is chosen to compute the fourier integrals with good accuracy the forces at the right hand side of eq 1 correspond to the wind loads the wave excitation loads the mooring tension loads and the viscous loads the hydrodynamic quantities can be solved by a standard frequency domain solver liu et al 2018a 2019 based on the assumption that the fluid is incompressible irrotational and inviscid the hydrodynamic wave excitation loads acting on the floating platform in the time domain can therefore be represented by a convolution of the wave elevation and the non causal impulse response function where the latter is determined by the fourier transform of the wave excitation forces in the frequency domain liu et al 2014 the mooring tension loads are found at each time step by the solution of an extended catenary theory jonkman 2009 via the newton raphson iteration method which is capable of considering the seabed friction to the mooring lines due to the small diameters of the cylindrical structures of the complex platform in comparison to the wavelength it is essential to include a supplemental model to account for the viscous correction for the potential flow theory a morison stick model was therefore formulated in the frequency domain liu et al 2016 and is reformulated here in the time domain section 4 1 and 4 2 3 2 aerodynamics of the multiple rotors the bemt blade element momentum theory which assumes that the blades can be divided into small annular elements that operate aerodynamically as two dimensional airfoils moriarty and hansen 2005 is applied to the aerodynamics computation of each rotor the crucial step of the bemt is to find the axial induction factor and the tangential induction factor via a standard iterative procedure let the thrust load derived respectively from the momentum theory and the blade element theory be equalized the axis induction factor a and the tangential induction factor a can be therefore deduced as follows 4 a 1 1 4 f sin 2 ϕ σ c n 5 a 1 1 4 f sin ϕ cos ϕ σ c t where f is the product of the tip loss factor and the hub loss factor c n and c t are the lift and the drag coefficients of a local blade element ϕ is the local flow angle and σ is the local solidity to compensate for the deficiency when the rotor enters into the turbulent wake state the glauert correction spera 1994 is employed after resolving the distribution of the normal and the tangential loads along the span of blades the total thrust force and the shaft torque are obtained by integrations assuming a linear variation hansen 2015 of the load distribution between neighboring blade elements note that there exist multiple rotors on the deck of the semi submersible floating foundation and the interactions between the rotors can significantly affect the loadings from the wind to reflect this phenomenon efficiently the jensen s wake model jensen 1983 katic et al 1986 also known as the park model is utilized in the present study its empirical equation is based on the conservation of momentum to model a single wake it is valid for the downstream distance approximately above one rotor diameter in the far wake region the wind speed in the wake can be expressed as 6 u w x u 1 1 1 c t b 1 2 k w x d r o t o r 2 where d r o t o r is the rotor diameter k w is the wake decay constant and x is the distance behind the upstream rotor typical values for k w range from 0 04 for offshore barthelmie et al 2009 to 0 075 for onshore cases barthelmie et al 2006 the wake decay constant sets the linear rate of wake expansion with the distance in the streamwise direction the diameter of the wake expansion is therefore given by 7 d w d r o t o r 2 k w x 3 3 modeling of the catenary mooring system in mild sea conditions the mooring line dynamics can often be described by a linearized relationship to the displacement of the floating support platform in general however the mooring system dynamics are not linear instead nonlinearities are generally evident in the force displacement relationships for the semi submersible fwt as shown in fig 1 the application of an appropriate catenary theory is necessary because the traditional catenary theory could not explain the effect of the seabed interaction with a mooring cable in the case it touches the seabed an improved method proposed by jonkman 2009 is used in this work which is capable of accounting for the above issue the analytical model which is given in terms of two unknown variables i e the horizontal and the vertical components of the effective tension in each mooring line at the fairlead is formulated as follows 8 x f f h f v l f v w f h w l n f v f h 1 f v f h 2 f h l e a c b w 2 e a l f v w 2 l f v w f h c b w m a x l f v w f h c b w 0 9 z f f h f v f h w 1 f v f h 2 1 f v w l f h 2 1 e a f v l w l 2 2 where x f and z f are respectively the horizontal and vertical coordinates of the fairlead position relative to the anchor f h and f v are the horizontal and vertical components of the effective tension in the mooring line at the fairlead w is the mass of the mooring line per unit length l is the total unstretched mooring line length c b is the drag coefficient of seabed static friction and ea is the sectional stiffness of the mooring line it is worth noting that equations 8 and 9 should be solved iteratively in the local coordinate system via the newton raphson method etc 3 4 solution of the time domain motion equation several numerical integration methods can solve a differential equation of the second order in the time domain such as the newmark beta scheme wikipedia 2020a adams moulton scheme wikiversity 2020 adams bashforth scheme wikiversity 2020 and runge kutta scheme wikipedia 2020b herein the fourth order runge kutta scheme is selected to find the solution of eq 1 as it can acquire as more as enough accuracy ran 2000 li and teng 2002 let us consider the time domain motion equation in the form of ξ q t ξ ξ i e 10 q t ξ t ξ t m a 1 0 t k t τ ξ τ d τ c ξ t f w i n d t f w a v e t f m o o r i n g t f v i s c o u s t where a letter in bold represents a matrix and represents a vector the solutions at each time step can be found via the fourth order runge kutta scheme as the following 11 ξ t δ t ξ t δ t ξ t δ t q 1 q 2 q 3 6 12 ξ t δ t ξ t q 1 2 q 2 2 q 3 q 4 6 where 13 q 1 δ t q t ξ t ξ t 14 q 2 δ t q t δ t 2 ξ t δ t ξ t 2 ξ t q 1 2 15 q 3 δ t q t δ t 2 ξ t δ t ξ t 2 δ t q 1 4 ξ t q 2 2 16 q 4 δ t q t δ t ξ t δ t ξ t δ t q 2 2 ξ t q 3 4 a morison stick method for modeling floating truss structures in time domain 4 1 theory formulation and numerical implementation of the morison stick method the viscous effect plays an important role in the dynamic response of such a semi submersible since the diameters of the slender braces are small in comparison to the wavelengths in a typical sea condition a morison type method is necessary to be employed in combination with the potential flow theory based on the conclusion of liu et al 2016 an appropriate hybrid approach can apply a morison method in the calculation of the wave drag force and a potential flow theory based method in the calculation of the platform inertia force such a combination can lead to the high accuracy of prediction this concept will be applied as well to the present time domain method following leblanc et al 1993 the wave drag force upon a cylindrical member can be obtained via the integration along its length i e 17 f d 1 2 ρ c d s e d m e m v r t v r t d l where c d d m e m and l are respectively the drag coefficient the diameter and the length of a cylindrical member ρ is the water density v r t is the absolute value of v r t which is the transverse component of the wave body relative velocity v r besides s and e represent the start and the end of a cylindrical member respectively the wave body relative velocity v r is the difference between the wave particle velocity v w and the motion velocity of a floating structure v m i e 18 v r v w v m it is easy to know the floating structure motion at the centroid of a morison element can be calculated as 19 v m ξ 1 ξ 2 ξ 3 t ξ 4 ξ 5 ξ 6 t r p v g where ξ i i 1 6 represents the platform motion velocity in the ith dof r x x g y y g z z g t represents the position vector of the morison element in the body fixed system the superscript t means transpose of the vector v g ξ 1 ξ 2 ξ 3 ξ 4 ξ 5 ξ 6 t is the platform velocity vector at the gravity center of the floating structure and p stands for the following translational to rotational transformation matrix 20 p 1 0 0 0 1 0 0 0 1 0 z z g y y g z z g 0 x x g y y g x x g 0 based on the principle of the double vector product the transverse component v t of a velocity vector v can be expressed by 21 v t l v l v v l l t v where l l x l y l z is the unit vector along the axial direction of the cylindrical member to which the morison element belongs and t is the axial to transverse transformation matrix that is calculated by 22 t i l l t 1 l x 2 l x l y l x l z l y l x 1 l y 2 l y l z l z l x l z l y 1 l z 2 where i stands for the 3 order identity matrix taking into consideration simultaneously eq 18 22 the transverse component of the relative water velocity can be expressed by 23 v r t t v w tp v g and the wave drag force upon a segment of a cylindrical member can be written as 24 f d i j 1 2 ρ c d i d m e m i δ l i j t i j v w i j t i j p i j v g t i j v w i j t i j p i j v g 25 m d i j r i j 1 2 ρ c d i d m e m i δ l i j t i j v w i j t i j p i j v g t i j v w i j t i j p i j v g where the superscripts i j stand for the jth morison segment of the ith cylindrical member therefore the viscous force at the right hand side of eq 1 can be finally deduced in the following form 26 f v i s c o u s t i 1 n m e m j 1 n s e g i p i j t f d i j where n m e m represents the number of all cylindrical members and n s e g i represents the number of morison segments on the ith cylindrical member upon each tubular member the local incident wave kinematics as mentioned in section 4 2 is used to calculate its quadratic wave drag force in either a regular wave or irregular waves by the morison dynamic solver the vector f v i s c o u s is then calculated at every time step with the present displacement and the motion velocity of the floating structure after that by resolving the time domain motion equation eq 10 the displacement and the motion velocity of the floating structure can be updated for the calculation at the next time step in respect of the numerical implementation of the wave drag model a morison stick mesh generator is specially developed to generate the stick mesh as shown in fig 3 the hybrid mesh is created for the immersed part of the floating structure under the mean water level the number of morison segments on each of the cylindrical members can be set at the users discretion in advance in the stick mesh generator the location and affiliation of each morison segment on each of the cylindrical members the equivalent cross section diameter the axis length the axis direction and the drag coefficients c d of each cylindrical member are recorded into the generated stick mesh as an input file to the time domain solver 4 2 fluid kinematics of incident waves in regular and irregular waves considering an airy wave transmitting with a small amplitude a and an angular frequency w in the water with a finite depth of h the incident wave potential for this regular wave at any position x y z can be described by 27 φ x y z t re i g a ω cosh k z h cosh k h e i k x cos β y sin β i ω t where β is the wave heading angle measured from the positive x direction and k is the wavenumber by taking the derivative with respect to the spatial variables the wave particle velocity in the space can be deduced as 28 u x y z t φ x g k a cos β ω cosh k z h cosh k h cos k x cos β y sin β ω t 29 v x y z t φ y g k a sin β ω cosh k z h cosh k h cos k x cos β y sin β ω t 30 w x y z t φ z g k a ω sinh k z h cosh k h sin k x cos β y sin β ω t where u v and w represent the fluid velocity v w in x y and z direction respectively in irregular waves the above three components can be finally derived as 31 u x y z t i 1 n g k i a i cos β ω i cosh k i z h cosh k i h cos k i x cos β y sin β ω i t ε i 32 v x y z t i 1 n g k i a i sin β ω i cosh k i z h cosh k i h cos k i x cos β y sin β ω i t ε i 33 w x y z t i 1 n g k i a i ω i sinh k i z h cosh k i h sin k i x cos β y sin β ω i t ε i where the subscript i represents the ith frequency component ε i is a random phase uniformly distributed between 0 and 2 π the ith component of wave amplitude a i can be calculated from 34 a i ω i 2 s ω i δ ω i where δ ω i is the bandwidth of the discretized wave angular frequency and s ω i represents the local power spectrum of irregular waves at a specific site e g jonswap joint north sea wave observation project spectrum and p m pierson moskowitz spectrum etc note that for the deepwater case the ratio of two hyperbolic functions degrades to the exponential function e k z in eq 27 30 and e k i z in eq 31 33 5 validation of the time domain hybrid panel stick method a model experiment was carried out in the towing tank 65 m length 5 m width and 7 m depth of riam kyushu university the purpose of the experiment was to check the hydrodynamic performance of the platform and provide a benchmark database for the validation of the numerical code the platform test model was of 1 50 scale with a displacement of 0 01693 m3 each catenary mooring line in the model experiment was substituted by a spring that had an equivalent stiffness to the linearized stiffness of the mooring line all the springs were anchored to a movable steel frame which was specifically set for the arrangement of the mooring layout fig 4 two high speed digital cameras ditect has l1 1280 1024 pixel 50fps are set aside the towing tank three yellow spherical markers are placed atop the rotor plate for the motion capturing during the experiment before the tank test the camera system was calibrated by a cubic steel frame with eight spherical markers respectively set at its vertices the positions of the eight markers in the user defined coordinate system and two photos of the cubic steel frame from the respective view of each camera were input to the dippmotionpro3d software that was used for processing the camera recorded videos when the tank test started the wind and the waves could be generated and therefore caused the floating platform to oscillate the platform motion was captured via the movements of the three markers respectively by the two monitoring cameras after completing the tank test the dippmotionpro3d software was used to analyze the videos and calculate the motion time histories of the three markers thereby any point on the floating platform could be calculated based on its relative position to the three markers to validate the preceding hybrid panel stick time domain method the wind was not taken into consideration in either the experiment or the numerical model the experimental conditions of incident regular waves are given in table 3 in the numerical model the wavelengths of the incident regular waves range from 0 05l to 7 0l l is the characteristic length of the triangular platform and the time step is t 100 t is the wave period the numerical results of the present time domain method are compared with the frequency domain results and the experiment in fig 5 and fig 6 for the fairness between the numerical models in the frequency domain model only the incident waves are considered for the wave kinematics to be consistent with eq 27 30 of the time domain model this means that the wave field is considered not to have been disturbed by the diffracted waves in general good agreements can be found between the simulation results and the experiment data however an exception occurs in the heave motion that the experimental data are a bit lower than the numerical simulations when λ l 5 0 while the latter two tend to approach unity with the increase of λ l newman 1999 proved theoretically that in the long wavelength regime the heave rao should approach unity which in general agrees with the numerical results in figs 5 b and figure 6 c moreover the discrepancies between the frequency domain and the time domain results for the heave motion prove the sensitivity of numerical models within this resonant region when wave heading is 90 deg the platform is mainly excited in the sway direction therefore the motion rao in surge is small and the respective measuring error using the experimental facility is larger which is acceptable and within expectation 6 results and discussion 6 1 load cases of the simulations in order to analyze the effect of the wave drag force on the motion response of the fwt with numerous truss members numerical simulations are thereby performed based on the developed time domain method simulations for the fwt in parked status and operating status are carried out separately to discover different phenomena and reveal different mechanisms the load cases are shown in table 4 for the subsequent analysis for the wind conditions wind speeds at the rated case v wind 11 4 m s and an above rated case v wind 15 2 m s have been considered in the above rated case the wind turbine applies a collective blade pitch controller in respect of the wave conditions unidirectional irregular waves with spectrums in jonswap type are considered as shown in fig 7 simulated spectrums are evaluated from the simulated wave dynamics based on eq 27 which are found to be in good agreement with the theoretical spectrums in addition for the convenience of the analysis natural frequencies of the fwt system can be evaluated beforehand with the assist of a commercial bem software such as wamit lee 1995 hydrostar chen 2004 etc or an open source bem solver hams liu 2019 in combination with an open source mooring solver map masciola et al 2013a 2013b 2013b and its python wrapper masciola 2015 liu et al 2018b which are listed in table 5 based on a heave free decay test performed by cfd in openfoam gao et al 2019 2021 the heave natural period can be calculated from fig 8 as 17 44 s which is very much close to the heave natural period from the present method i e 2π 0 36 17 45 s 6 2 motion response of the floating wind turbine in parked status since the wave drag force acting as a certain kind of viscous wave damping upon an fwt platform is purely hydrodynamic priority is first given to the motion response of the proposed fwt when it is in parked conditions there is no wind in still air but only waves for simplicity misalignment between waves and wind has not been considered i e waves and wind always inflow from the same direction responses of the fwt system are simulated using the aforementioned time domain method before the numerical simulation a convergence test is performed against the time step as shown in fig 9 it is found that the size of the time step has little influence on the time history results therefore a time step of 0 5 s is chosen for each simulation with a simulation time of 2048 s 2 to the power of n n is an integer for the sake of the subsequent spectral analysis using fft fast fourier transform method time series of the platform motions in 6 dof modes are shown in figs 10 and 11 respectively for the wind wave directions in 0 deg and 90 deg as shown in fig 10 since the waves incident from 0 deg toward the positive x direction the platform basically displaces in surge heave and pitch modes fig 10 a e and i particularly e and i show that the amplitude of the platform motion response is decreased due to the existence of the viscous effect the averaged response amplitudes of heave and pitch motions are significantly decreased by 57 85 and 13 92 also with the inclusion of the fluid viscosity the coupling between different motion dofs is likely to be enhanced as can be observed from fig 10 g and k based on the dat2spec subroutine of the wafo wave analysis for fatigue and oceanography open source toolbox brodtkorb et al 2000 spectral analysis is performed on the motion response time series in each mode it is seen that in surge heave and pitch a pure potential flow model without any viscosity leads to a resonant response in correspondence to the natural frequency of the fwt system in that mode while applying a hybrid panel stick model can be effective to include the fluid viscosity and hence reduce the fictitious energy of the resonant response fig 10 b f and j show that the surge the heave and the pitch resonances occur at respectively ω 0 0644 rad s ω 0 3528 rad s and ω 0 2761 rad s which are close to respectively the surge natural frequency ω 0 07 rad s the heave natural frequency ω 0 36 rad s and the pitch natural frequency ω 0 32 rad s as displayed in table 5 moreover figs 10 e and 6 i show that the wave drag force reduces the mean amplitude of the motion time series in heave and pitch respectively in addition to the resonant responses there exists another wave induced response that is excited by the irregular waves the peak frequency of which corresponding to the peak frequency of the incident wave spectrum fig 10 b f and j show that the wave drag force slightly reduces the peak of the wave induced response since the wave incidents from 0 deg the sway the roll and the yaw motions are reasonably in extremely small magnitudes in fig 10 g the existence of viscous damping likely increases the magnitude of the roll motion that is because without viscous damping the roll motion should be almost zero in contrast with the existence of viscous damping which can be viewed as an equivalent to a damping matrix the roll motion is slightly disturbed by the motions in other modes such as heave etc however since the values are almost negligible it is hard to draw significant conclusions based on these limited results and should be considered further fig 11 shows the motion time series of the fwt when the waves incident from the 90 deg direction the platform displaces basically in sway heave roll and yaw while the pitch motion is strongly coupled with the heave motion as shown in fig 11 c e g i and k fig 11 a shows that the surge motion is also affected by enhancing the motion response of the resonant frequency component fig 11 d f h and j show that the sway the heave the roll and the pitch resonances occur at respectively ω 0 0644 rad s ω 0 3497 rad s ω 0 2761 rad s and ω 0 2761 rad s which are close to respectively the sway natural frequency ω 0 07 rad s the heave natural frequency ω 0 36 rad s the roll natural frequency ω 0 32 rad s and the pitch natural frequency ω 0 32 rad s as displayed in table 5 with the existence of the fluid viscosity the resonances are effectively reduced which can be known from the red line simulation results with the wave viscous damping moreover similar to that has been found in fig 10 the viscous wave effect decreases slightly the peak of the wave induced response excited by the irregular waves with a jonswap spectrum as shown in fig 11 d f h j and l worth noting is that the presence of the fluid viscosity is likely to enhance the coupling between the motions in different dofs which can be observed from the resonant response energy of the yaw response spectrum as shown in fig 11 l 6 3 motion response of the floating wind turbine in operation after knowing the motion response characteristics of the fwt in the still air condition it is interesting to know what the characteristics will be like if the wind is involved as well in this section therefore simulations are performed for the fwt when it is in operation to give a clear explanation turbulent winds and misalignments between wind and waves are not considered here in other words the wind steadily comes from the same direction as the waves each of the simulations lasts for 2048 s with a time step of 0 5 s time series of the platform motions in 6 dof modes are shown in figs 12 and 13 respectively for the wind wave directions in 0 deg and 90 deg fig 12 shows the platform motion time histories and the spectral analysis when the waves and the wind come from the positive x direction similar to fig 10 the platform displaces in surge heave and pitch as shown in fig 12 a e and i it is found that in general the motion amplitudes in almost all the dofs have been decreased by the inclusion of the fluid viscosity in the presence of wind again the same resonant frequencies are obtained with the aid of the wafo toolbox which are in coincidence with the natural frequencies in table 5 worth noting is that the resonance in the surge motion without the fluid viscosity can be excited prominently in the presence of the wind that is to say the one component of the surge motion which consists of an infinite set of components with different frequencies with a frequency equivalent to that of the surge resonance ω 0 0644 rad s is particularly excited due to the existence of the wind this phenomenon can be confirmed again by the spectral analysis of the pitch motion time series as given in fig 12 j in comparison to fig 10 j i e the case without wind there is an additional distinctive resonant response with a peak at the surge resonance frequency ω 0 0644 rad s it can be known for sure that this peak is induced by the resonant response of the surge motion since the pitch and the surge motions are strongly coupled however in the presence of the fluid viscosity the surge resonant response diminishes and the pitch resonant response is also significantly reduced as shown in fig 10 b and j the reason why the steady wind excites the surge resonance can be explained as below 1 in the still air condition as shown in fig 10 a the equilibrium position of the platform motion is set at the origin of the ground based global coordinate system starting from the equilibrium position the platform moves with an initial velocity which is induced by the waves 2 in the presence of the steady wind the equilibrium position of the platform surge motion changes to a place having a distance 2 5 m in the present case as shown in fig 12 a from the origin resulting from the new balance between the actions of the wind thrust force the wave excitation force and the mooring restoring force the work that the wind has done to the fwt along the 2 5 m distance increases the total kinetic energy of the platform remarkably and therefore increases the surge velocity of the platform at the equilibrium position 3 without the existence of wave viscous damping much larger than the wave radiation damping at the platform resonant frequency the amplitude of the platform surge motion can increase to a considerable value in reality the existence of wave viscous damping reduces the amplitude of the platform motion significantly fig 13 shows the motion time series of the fwt when the waves and the wind come from the 90 deg direction similar to fig 11 the platform displaces basically in sway heave roll and yaw as well as pitch that is induced by the coupled heave motion as shown in fig 13 c e g k and i fig 13 a shows that the surge motion is affected as well by enhancing the motion response of the resonant frequency component again the translational sway motion with the assumption of no fluid viscosity is excited particularly at the sway resonant frequency ω 0 0644 rad s which is close to the natural frequency ω 0 07 rad s of the fwt system in the sway mode as shown in fig 13 c and d the reason for the excitation of the sway resonant response is analogous to that of the surge in fig 12 a and b as a consequence a resonance at the sway resonant frequency ω 0 0644 rad s is also excited in the platform roll motion which can be confirmed from fig 13 g and h it is because of the strong coupling between the platform sway motion and the roll motion with the existence of the fluid viscosity the amplitudes of these platform motion time series are effectively decreased as well as the resonant response peaks in their spectrums 7 conclusions this paper presents a time domain method for modeling the dynamics of an fwt with multiple rotors on the deck of a semi submersible floating platform it is particularly noticed that the floating foundation is a truss structure consisting of many slender braces such slim members can bring a significant effect of the viscous wave damping which is caused by the wave drag force upon those members a systematic methodology of modeling such a floating truss structure is established based on the proposed time domain hybrid panel stick method combining the potential flow theory for large diameter structures with the morison strip method for small diameter structures in the meantime an efficient tool has been developed to deal with a set of slender cylindrical members in arbitrary lengths diameters orientations and locations the tool includes a stick mesh generator and a morison dynamic solver the morison dynamic solver has been incorporated into the time domain solver for the fwt dynamics the developed methodology and software are then applied to an fwt developed in kyushu university it is validated with an experiment in regular waves in the wave tank of riam kyushu university the simulation results agree with the experimental data confirming the validity of the developed method for the fwt further numerical simulations are carried out under a set of wind and wave conditions comparisons are made between the parked wind turbine and the operating wind turbine and between simulations with and without the viscous damping it is found that in all cases of conditions without consideration of the wave drag force the platform has a resonant response occurring at the resonant frequency of each dof the resonant frequencies are close to the natural frequencies of the fwt system with moorings in addition to the resonant response the wave induced response is always excited whose peak frequency coincides with that of the incident wave spectrum however in the presence of viscous damping the peak value of wave induced response can be slightly reduced with the effect of viscous damping which the morison dynamic solver evaluates the resonant response of each dof can be suppressed it means that the energy of resonant response dissipates with the fluid viscosity in the presence of steady wind the translational surge or sway motion can be significantly excited at its resonance frequency in comparison to the case when the wind turbine is parked it is mainly due to the work that the wind has done to the fwt which enhances remarkably the total kinetic energy of the platform and therefore increases the translational velocity of the platform in the surge or sway dof at the equilibrium position an additional resonant response due to the sway or surge resonance is excited in the rotational platform motion of the roll or pitch dof it can be attributed to the strong couplings between the sway and the roll motions and between the surge and the pitch motions these findings are believed to be of great importance to the design and operation of such fwt systems funding the first author is also grateful to the financial support from the open research fund grant number lp1815 of the state key laboratory of coastal and offshore engineering sklcoe of dalian university of technology the overseas collaborative research program grant number pjt 8 of the japan society of naval architects and ocean engineers jasnaoe and the grant in aid for early career scientists jsps kakenhi grant number jp18k13939 credit authorship contribution statement yingyi liu methodology software formal analysis writing original draft visualization investigation writing review editing changhong hu conceptualization investigation writing review editing project administration makoto sueyoshi conceptualization experiment validation investigation shigeo yoshida investigation writing review editing hidetsugu iwashita experiment investigation writing review editing masashi kashiwagi experiment writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the authors thank the anonymous referees for their constructive comments during the revision process nomenclature bem boundary element method bemt blade element momentum theory cfd computational fluid dynamics dof degree of freedom fwt floating wind turbine hams hydrodynamic analysis of marine structures jonswap joint north sea wave observation project map mooring analysis program msl mean sea level n s navier stokes p m pierson moskowitz rao response amplitude operator riam research institute for applied mechanics tlp tension leg platform wafo wave analysis for fatigue and oceanography winflo wind turbine with innovative design for floating lightweight offshore 
20684,the numerical method for self propulsion sp point prediction is an essential part of ship hydrodynamics however comprehensive investigations on different cfd sp model characteristics are rare especially for the high performance waterjet propelled trimarans this paper proposes four types of overset mesh based cfd sp numerical models on a waterjet propelled trimaran model two pid controlled free running sp models with without a moving background and two surge fixed sp models with without the propulsor pid controller the urans cfd simulations are conducted by following the verification and validation v v procedure to investigate the four sp models characteristics the four computed model sp points agree well with the experimental result and both the finest grid relative errors are within 1 5 a comprehensive comparison of the consumed computing resources surge freedom control strategy simulation scheme v v result simulated flow field simulation accuracy and calculation efficiency of the four sp models are analyzed both the pid controlled free running sp model with a moving background and the pid controlled surge fixed sp model show advantages in terms of computing resource consumption propulsor control strategy accuracy and efficiency in particular compared with the conventional fixed sp model the computational efficiency could be promoted up to 150 and the time consumption could decrease up to 60 furthermore the pid controlled free running cfd model with moving background shows its advantages and potential in directly simulating the ship s real time motion in various complex environments keywords self propulsion waterjet propelled trimaran free running pid controller urans cfd verification validation 1 introduction the ittc international towing tank conference proposed the practical guidelines for ship self propulsion cfd ittc 2014 according to the propeller rotation control approach two sp point calculation methods are recommended the interpolation method and the use of a controller the interpolation method the so called british method bertram 2012 obtains the hull resistance curve and propeller thrust curve by applying multiple propeller revolutions and the intersection of the two fitting curves is the sp point using a controller method controls the propeller revolution with the hull speed or force as the error term such that the sp point is obtained through the adaptive pi controller in a single simulation meanwhile according to the ship s horizontal freedom two cfd models can be applied a surge fixed model and a free running model the first model limits the ship s horizontal freedom and relatively realizes the ship s traveling by inputting the ship speed at the inlet in contrast by releasing the ship s surge freedom the free running model could realistically simulate ship motions moreover according to the background domain s freedom the free running model can be further divided into two models a region fixed model and a region moving model fig 1 demonstrates the two free running models with the overset grid the region fixed model has a towing tank like fixed background domain with enough length to simulate real time ship traveling to obtain the sp point however one pitfall of the method is that the grid numbers increase leading to a heightened computational consumption the second model s background domain is consistent with the conventional calculation domain and the background moves synchronously with the ship in the horizontal plane so that the ship moves freely without limitation and the sp point can be obtained with fewer computing resources in the early research on ship cfd self propulsion despite using the interpolation fitting approach the british method was widely applied in numerical simulations and the results were in good agreement with the experiments liu et al 2008 used the reynolds similarity to research the self propulsion performance of a 1 20 scaled 80 m cargo ship where the sp point was calculated from the intersection point of the hull resistance curve and thrust curve and the computed hull resistance of fr 0 179 0 251 was within an error of 3 0 choi et al 2009 proposed a computational prediction for ship speed performance by analyzing resistance and self propulsion computational results where the self propulsion point was obtained from two propeller rotative speeds based on the british method and the value was lower than the experimental value by 3 09 ge et al 2012 and wu et al 2013 researched the cfd standard kcs model and conducted barehull propeller open water and british method based self propulsion simulations to predict the full scale sp point and power performance and the predicted sp point received satisfactory results in which the error was less than 1 at both the model and full scale lee et al 2019 employed computational tools to predict the power increase and propulsion performances in waves of kvlcc2 where four propeller rotating speeds were adopted to obtain the calm water sp point for the propulsor controller applied in ship surge fixed sp simulations castro et al 2011 performed full scale self propulsion computations of the kcs container ship with the direct discretization of the propeller a dynamic overset approach was used which allowed an arbitrary rotational speed of the propeller during the computation the self propulsion point was obtained using a controller to modify the propeller rps until the target speed was maintained and the final converged rps error was approximately 1 27 at the model scale and 2 80 at the full scale the pi controller is not only used to accurately assess the jbc model s propulsion performance bakica et al 2019 but also applied in the penalty of hull and propeller fouling on ship self propulsion performance research song et al 2020 where the obtained accurate sp point enhanced the simulation reliability of the biofouling s effect on the fully appended kcs container ship the free running simulation model contains two kinds of grids non overset grids and overset grids in recent non overset grid based self propulsion research wu et al 2019a 2019b used a physical like method to simulate auv self propulsion and docking processes based on the multi block mesh moving mesh and dynamic layer method the differences in the self propulsion velocity wake fraction and thrust deduction factor compared with mrf multiple reference frames are 2 6 3 7 and 6 8 respectively the overset grid based free running model is usually coupled with the propulsor controller the in house code cfdship iowa developed by iowa institute of hydraulic research iihr can perform the propulsor controlled free running simulation huang huang et al 2008 bhushan bhushan et al 2009 carrica et al 2008 2010 2013 and many other researchers of iihr have made a series of significant contributions to cfd self propulsion and maneuverability based on the free running numerical model where the model has been comprehensively verified and validated in addition wang wang et al 2017 wang and wan 2020 conducted direct free running simulations of self propulsion coarse keeping and stopping based on the naoe foam sjtu numerical solver feng et al 2020 used hust ship an in house urans cfd code to perform the free running computations of kcs with different propulsion models which indicated that the modified oum osaka university method body force method has a higher accuracy than other body force models compared with the discretized propeller model and the experimental data cfd self propulsion computations on waterjet propelled trimarans have recently been reported by many researchers in studies adopting the conventional stationary computation domain guo et al 2020a obtained the self propulsion point of a trimaran by changing the impeller rotational speed three times until the horizontal force was balanced and then conducted a cfd based multiobjective optimization for the waterjet propelled trimaran guo et al 2020b compared to the original shape the total resistance thrust torque and power consumption of the optimized trimaran at self propulsion decreased by 3 85 increased by 6 38 increased by 1 73 and decreased by 10 39 respectively based on the self propulsion trimaran model jiang et al jiang and ding 2021 and gong et al 2021 studied the hull waterjet interaction characteristic of a planing trimaran and the dynamics scale effects of the stabilizer fins on the waterjet propelled trimaran respectively in the pid controlled free running trimaran aspect zhang et al 2019 2021 recently performed cfd self propulsion simulations and on a waterjet propelled trimaran model where the model was validated through a hybrid method and free running model test indicating that the proposed free running trimaran model appended with the pid controller and body force method is applicable for performance evaluation simulation with real time speed changes in a complex ocean environment as noticed from the literature review the cfd sp model is the critical foundation for the research of propulsion performance hull propeller interaction sea keeping and maneuverability coupling different revolution control methods and different surge freedom could form various sp models however existing research mostly relies on one of these models and there is seldom a comprehensive comparative study to research their advantages disadvantages and characteristics after the ittc released the practical guidelines for ship self propulsion cfd many cfd based studies using propeller controllers or free running models began to emerge where research is rarely associated with high performance waterjet propelled trimarans the current paper intends to bridge this gap in the research and provides a few references for related research based on cfd by conducting a comprehensive comparative study on different types of sp models based on the existing waterjet propelled free running trimaran model this paper is organized as follows the methodology of the current study is explained in section 2 including the rans equations propulsor pid controller used for finding the sp point and the verification and validation v v procedure the free running model test and four different cfd sp models are presented in section 3 finally the v v process wave pattern attitude capture area and nozzle discharge of waterjet self propulsion characteristics are presented in section 4 while comprehensive and comparative conclusions are presented in section 5 2 cfd numerical method 2 1 rans equations the viscous flow cfd numerical simulation is based on the rans reynolds averaged navier stokes equations in the present research the mass conservation continuity equation and the momentum conservation governing equation of an incompressible fluid are as follows 1 u i x i 0 2 u i t x j u i u j 1 ρ p x i ν x j u i x j u j x i τ i j x j f s ρ where ρ p ν and f s represent the fluid density average pressure kinematic viscosity coefficient and source term respectively u i and x i x j are the velocity vector and coordinate vector of the tensor representation in the cartesian coordinate system respectively where i j 1 2 3 and τ i j u i u j is the second order tensor form of the reynolds stress term which needs to be calculated by the turbulent transport equation the two equation turbulence model realizable k ε is used to solve the reynolds stress term of the rans equations in this paper 2 2 body force method and pid controller when the actual propeller geometric model is used in simulations ittc 2014 recommends the propeller rotating at 0 5 2 0 per time step under the restriction of the courant friedrichs lewy cfl condition to better simulate the actual effect of the propeller which is time consuming based on the body force method bfm using the virtual disk model to simulate the propeller hull interaction can save considerable computational resources bfm has been widely used in the propulsion model of ship self propulsion and cfd maneuverability simulations broglia et al 2013 sakamoto et al 2013 jin et al 2019 the virtual disk model assumes that the propeller s thrust and torque are uniformly distributed along the axial direction in a real propeller based virtual cylindrical disk by applying the propeller s characteristic performance curves which can be obtained from open water tests or numerical calculations to the virtual disk region the propeller can be effectively simulated under a reasonable accuracy the present sp simulations adopt the bfm based virtual disk model for the time savings and lower computational cost in a free running sp simulation the thrust of the propulsor i e propeller or jet pump drives the ship to move forward and the total resistance causes the ship to slow down to maintain a forward speed the pid controller coupled with a directional and speed feedback controller can meet the requirement for controlling the propeller revolution and then the target hull speed can be achieved taking the waterjet propelled trimaran model as an example the pid controller equation of the sp model with the velocity difference or the total force difference as the error term is expressed as follows zhang et al 2021 3 n p e i 0 t e d t d d e d t 4 n p v v 0 v n i v i 2 n t 2 v 0 v i v i 1 δ t 2 d v a v f r e e r u n n i n g m o d e l p f r h i t n e t i i f i 2 n t r h i r h i 1 t n e t i t n e t i 1 δ t 2 d f a f f i x e d m o d e l in the above two formulas n is the propulsor revolution with units of rpm r min or rps r s each coefficient subscript v and f represent the corresponding coefficient of velocity difference and force difference respectively while p i and d are the corresponding proportional term integral term and differential term coefficients respectively the specific values are set according to the different conditions of the research object a is the acceleration of the proportional deviation term v 0 v i and v n are the target vessel speed the speed at simulated time steps i and the current speed at the simulated time steps n t respectively r h i and t net i represent the hull resistance and the waterjet net thrust at the simulated time steps i 2 3 verification and validation v v procedure of cfd uncertainty analysis verification and validation ittc 2008 play an essential vital role in cfd simulations and many researchers have made tremendous remarkable contributions to the uncertainty analysis method generalized richardson extrapolation re is an important method for cfd grid analysis based on which roache 1994 proposed uniform grid studies by using the grid convergence index gci and celik and karatekin 1997 reported nonuniform grid distribution research through numerical experiments both uniform and nonuniform grids have been verified in cfd applications then a factor of safety fs method for both a grid spacing and time step uncertainty estimation was developed by xing and stern 2010 the fs method removes two unreasonably small uncertainty deficiencies of the gci and correction factor cf methods and evaluates different error estimations using the effectivity index after validating the fs method through the statistical analysis of 25 samples with different sizes xing and stern further applied this method to ship hydrodynamics uncertainty analysis moreover eça and hoekstra 2014 proposed a procedure for the numerical error uncertainty estimation of a numerical solution that accepts the practical limitations in grid density where the required so called asymptotic range data are not sufficient this numerical uncertainty procedure was validated through a series of numerical applications including 2 d manufactured solutions flow over a flat plate flow over a backward facing step and the flow around a tanker which provides a practical approach for the cfd uncertainty analysis in recent ship cfd uncertainty research mancini and de luca have performed a series of remarkable works in v v processes on planing hulls mancini 2015 de luca et al 2016 roll decay of the dtmb 5415 hull mancini et al 2018 and the dynamics of the planing hull in regular waves tavakoli et al 2020 which provides a comprehensive method for ship cfd uncertainty analysis the cfd simulation uncertainty u sn in the v v process is estimated by solving the grid uncertainty u g the iterative uncertainty u i the time step uncertainty u t and the other parameter uncertainty u p the influence of u p is usually not considered 5 u s n u g 2 u t 2 u i 2 u p 2 the comparison error e and the validation uncertainty u v are defined by the test value d and the test uncertainty u d as follows 6 e d s 7 u v u d 2 u s n 2 taking the calculation method of the grid uncertainty u g as an example where the uncertainty u t is also determined by referring to the following process for the uniformly refined trimmed volume grids in the star ccm platform a generalized definition method could be adopted for the refinement ratio r g which is defined as the ratio related to the total volume grid number 8 r g n f i n e n m e d i u m 1 3 o r n m e d i u m n c o a r s e 1 3 where n is the total volume grid number with different mesh densities generally at least three different sets of grids should be set up to verify the grid convergence s 1 s 2 and s 3 represent the fine medium and coarse grid numerical simulation results the convergence ratio of the numerical simulation can be obtained as follows 9 r g ε 21 ε 32 s 2 s 1 s 3 s 2 for the value of the convergence ratio r g there are four possible distributions as follows i 0 r g 1 monotonic convergence mc ii r g 0 r g 1 oscillatory convergence oc iii r g 1 monotonic divergence md iv r g 0 r g 1 oscillatory divergence od for the case of divergence iii and iv the numerical calculation results are in an unstable state and the grid uncertainty evaluation cannot be conducted for the oscillation convergence of case ii the grid uncertainty is calculated by using the maximum value s u and the minimum value s l of the oscillation based on the numerical calculation results 10 u g 1 2 s u s l for the monotonic convergence of case i the generalized richardson extrapolation method is applied to evaluate the levels of the numerical calculation accuracy and the estimated order of accuracy p g and the asymmetric measurement distance c g is as follows 11 p g ln 1 r g ln r g 12 c g r g p g 1 r g p e s t 1 in the formula the theoretical order of accuracy p est 2 the uncertainty u g of the final numerical calculation grid can be obtained from the following formula 13 u g c g ε 21 r g p g 1 1 c g ε 21 r g p g 1 similarly for the time step uncertainty u t the time step refinement ratio r t is determined by dividing the larger time step by the smaller time step furthermore the remaining uncertainty parameters are calculated referring to eqs 9 13 by replacing the subscript g with t notable is the theoretical order of accuracy p est 1 in the temporal uncertainty for the simulation result that enters a steady periodic fluctuation convergence the iteration uncertainty u i can be estimated as follows 14 u i 1 2 s u s l s u and s l represent the maximum and minimum values of the simulation results in a stable fluctuation period respectively 3 experimental model test and cfd numerical models 3 1 barehull resistance model test the research target is a trimaran model reinforced with glass fiber that is propelled by three sets of waterjets in the main hull stern the main dimensions of the ship are listed in table 1 the experimental model test contains two parts the barehull resistance model test and the free running model test for the former one the experiment is conducted in the towing tank of the china ship scientific research center cssrc which is 470 m 14 m 7 m with a maximum towing speed of 15 m s fig 2 a b shows the prepared trimaran geometry model where three intake duct openings are covered with plates to prevent water entry fig 2 c demonstrates the towed trimaran model in the towing tank after removing the towing force the measured barehull resistance is obtained as 14 64 n at fr 0 30 which corresponds to the free running model test velocity 3 2 free running self propulsion model test the waterjet propelled free running trimaran model is employed as the target vessel for comparative research on the cfd sp model as the free running model test cannot add the traditional towing force on the hull the sp point obtained from the experiment is the model scale point and the following sp simulations are both performed based on this sp point the trimaran model contains three sets of waterjet propulsors and the corresponding power systems remote control equipment and monitoring measurement equipment the signal acquisition and conversion system on the bow deck three 22 2 v dc batteries remote signal receivers and batteries voltage converters and circuit boards in the midship brushless motors and nozzles steering mechanism waterjet propulsors at stern etc as demonstrated in fig 3 a the free running sp model tests are conducted in a lake with calm open water where the target ship velocity is 1 88 m s corresponding to fr 0 30 during the straightforward test the trimaran model is controlled remotely at the zero waterjet nozzle angle real time measured velocity is transmitted wirelessly and automatically collected by a computer the ship model is accelerated by smoothly increasing the rotor revolution until the velocity reaches and maintains the target value of 1 88 m s then the corresponding rotor revolution is recorded as the model sp point after several repeated travels the average revolution is obtained as 7920 rpm fig 3 b c shows the model release moment and the test performance process 3 3 waterjet propulsor the waterjet propulsor used in the present experiment is an existing propulsive device used for other ship types before after evaluating the capability of the thruster and the thrust requirement of the trimaran we applied this existed suitable waterjet propulsor on the ship fig 4 a b demonstrate the waterjet rotor and stator assembly details where the rotor diameter equals 4 9 cm in the present cfd simulations to reduce the computational cost the body force model is applied as displayed in fig 4 c the stator is reserved for rotational flow rectification and the waterjet rotor is assumed to be a type of traditional individual propeller in the waterjet duct hydrodynamic performance curves including k t 10k q and η as shown in fig 4 d are applied in the rotor virtual disk region 3 4 self propulsion cfd numerical models four different cfd numerical models for self propulsion are presented in the present work fig 5 shows the conceptual diagrams of the four models and table 2 lists the main characteristics of the corresponding model the detailed description is as follows i sp1 the so called free running numerical model this ship model has the capability to travel freely without moving limitations due to the vessel s background domain moving simultaneously with the vessel the waterjet rotor is automatically controlled by a pid controller with the velocity difference as the proportional term and the body force method based virtual disk model is applied in the rotational region to simulate the waterjet rotor s effect thus the numerical simulation only needs a single run to achieve the sp point using the sp1 model ii sp2 the free running numerical model with the fixed background the surge freedom propulsor controller and required simulation times are the same as those of the sp1 model but the fixed background domain length should be sufficiently large to obtain a stable simulation result iii sp3 the fixed model with a propulsor controller this model has a surge fixed vessel and a fixed background domain and the propulsor is controlled by a pid controller using the resistance thrust difference as the proportional term the sp3 model also only needs a single run to get converge iv sp4 the conventional fixed model freedom of the vessel and background domain is the same as sp3 and the propulsor revolution is a fixed number in order to obtain the sp point through interpolation at least three simulations are required 4 results of the self propulsion numerical simulation 4 1 v v procedure of the free running sp1 model 4 1 1 simulation model of sp1 the computational background domain of the waterjet propelled free running numerical model sp1 is shown in fig 6 a overset grid technology and the region moving method are used to simulate the ship motion the realizable k ε turbulence model is used in the numerical simulation and the near wall flow field is solved by the double layer full y method the volume of fluid vof method is applied to capture the free surface the inlet velocity boundary conditions are set for the inlet side up and bottom boundary the pressure outlet condition is set for outlet and the eom euler overlay method based wave forcing boundary is applied in the inlet side and outlet boundaries for the wave absorption where the wave forcing lengths are both set to 1 0l pp mesh refinement strategies are applied around the ship hull and the traveling wave amplitude direction for the grid generation the prism layer thickness is set as 1 0 cm with a growth factor of 1 414 to ensure that the hull surface y value at the calculated speed is less than 100 by varying the basic mesh size three sets of grids fine medium and coarse are generated for the v v procedure as displayed in fig 6 b d the three density grid numbers are 3416 k 1966k and 1211 k and the average refinement ratio r g is 1 19 the recommended time step ratio r t 1 414 is applied in the time step uncertainty u t analysis where three time steps of 0 01 s 1 414 0 01 s and 0 02 s are used the simulation schemes for the v v procedure of the sp1 model are shown in table 3 4 1 2 grid uncertainty ug of sp1 the time step is 0 01 s for the grid uncertainty analysis the rotor revolution forward speed hull resistance and waterjet thrust are monitored during the self propulsion process for the free running numerical model the simulation should begin with a specified minor rpm to produce the integration and differentiation term and then the pid controller should be applied to the virtual disk the pid coefficient terms p n i n and d n are set as 1 5e5 1 5e5 and 8 0e2 respectively fig 7 shows the rotor revolution hull speed hull resistance and gross thrust convergence process varying with the simulation time we can see that the increased resistance rapidly reduces the hull speed after starting the simulations with the pid controller the rotor rpm is automatically adjusted to a maximum speed at a simulation time of 0 10 0 12 s the rpm is gradually reduced and the hull speed is gradually increased the rotor rpm hull speed hull resistance and gross thrust reach the equilibrium line of fluctuation within 4 s and then steadily fluctuate slightly at 10 s the ship wave pattern converges slowly compared to the above physical quantities and the wave pattern has been stabilized when time 10 s the results of the grid uncertainty are listed in table 4 the sp point s rotor revolution in the coarse medium and fine grids increases monotonically showing a monotonic convergence trend with relative errors of 0 57 0 69 and 1 26 respectively and the corresponding r g 0 45 the calculated grid uncertainty u g is equal to 2 28 d and the absolute values of each grid s relative errors are smaller than the values of the grid uncertainty which means that the three grids both show good agreement with the experimental results 4 1 3 time step uncertainty ut of sp1 the time step uncertainty research adopted the above fine grid scheme and three time steps in table 2 are applied for the numerical simulation the convergence curves of the rotor revolution hull speed hull resistance and gross thrust are shown in fig 8 where the stable fluctuation of different curves of the same physical quantity have very little difference by following the same analysis process as in grid uncertainty we can obtain the time uncertainty analysis results as shown in table 5 as the time step decreases from 0 02 s to 0 01 s the calculated rpm decreases slightly with a monotonic convergence trend and the relative error is within 1 55 the calculated time step uncertainty u t 0 29 d is one order smaller than u g 2 28 d which means that time step uncertainty is the minor term in the total uncertainty evaluation 4 1 4 iteration uncertainty ui of sp1 the iteration uncertainty u i is analyzed by using the numerical simulation results of the rotor rpm with fine mesh as shown in fig 9 the rpm curve converged in 10 s the periodic fluctuation value of the rpm curve is distributed between 8010 and 8030 within 9 5 10 0 s referencing from eq 14 the iteration uncertainty u i could be computed as 0 13 d which shows the same order of magnitude as u t and is one order of magnitude smaller than u g 4 1 5 numerical simulation uncertainty usn and the total uncertainty uv of sp1 based on the above grid uncertainty u g the time step uncertainty u t the iteration uncertainty u i of the numerical simulation and the experimental uncertainty u d the numerical simulation uncertainty u sn and the total uncertainty u v can be calculated from eq 5 and eq 7 respectively the experimental uncertainty u d of the free running model test is estimated according to the reference value of 5 d the results show that the orders of magnitude of u t and u i are smaller than that of u g as shown in table 6 below under the condition of considering or ignoring u t and u i the numerical simulation uncertainty u sn are 2 30 d and 2 28 d respectively which means the influence of u t and u i on u sn and u v is less than 0 02 d and the influence of the time step and iteration can be ignored compared with the grid influence in the present research the total uncertainty u v 5 50 d has the same order of magnitude as the grid uncertainty u g 2 28 d while the relative error of the fine mesh is 1 26 we can obtain 0 e u v which indicates that the revolution result of the sp1 model is validated at the 5 50 u v level 4 2 v v procedure of the free running sp2 model the background domain of the free running sp2 model is fixed and the longitudinal length is larger than that of the sp1 by referencing the sp1 model s traveling distance of 10 s the longitudinal length of the sp2 model is expanded to 7 5l pp fig 10 a so that the trimaran can move enough distance to reach the convergence state the propulsor pid controller adopts the same settings as the free running sp1 model in the grid uncertainty analysis the same basic mesh size and refinement strategies are used for grid generation and the grid numbers of the fine medium and coarse mesh are 5793 k 3032 k and 1649 k respectively as shown in fig 10 b d the time step is set as 0 01 s the same as the grid uncertainty analysis of the sp1 model variation curves of physical quantities such as rotor rpm forward speed and hull resistance of model sp2 are shown in fig 11 a c the changing trend of each curve is similar to that of the corresponding physical quantities of the sp1 model in fig 7 because the trimarans of the two models have the same characteristics of surge freedom propulsor controller and virtual disk model as shown in table 7 the revolution convergence values of fine medium and coarse density grids are 8025 rpm 7948 rpm and 7961 rpm respectively and the relative errors are 1 33 0 35 and 0 52 respectively for the fine grid simulation results the iteration uncertainty u i is 0 58 d by referencing the upper and lower limits of the speed fluctuation in fig 11 d however the convergence ratio of the sp2 model is computed as 5 29 which indicates that the numerical results of different density grids exhibit oscillatory divergence and the grid uncertainty result cannot be evaluated according to the v v procedure considering the rpm relative difference between the three density grid simulation results and the experimental value is within 1 5 the fine grid simulation result is selected for comparison with the other sp models the total uncertainty u v is represented as a missing term that could not be evaluated 4 3 v v procedure of the fixed sp3 model in the fixed sp3 model with a propulsor controller the computational domain three density grids and the time step are consistent with those of the sp1 model by fixing the surging freedom and setting the inlet boundary velocity to 1 88 m s corresponding to the speed fr 0 30 we can apply the resistance thrust difference as the control target of the proportional term for the propulsor controller in eq 4 then the rotor revolution is automatically controlled by the force difference based pid controller the coefficient terms p f i f and d f are set as 50 350 and 0 5 respectively and the model scale sp point can be obtained in one time simulation after stable convergence of the simulation the simulation time is set as 10 s according to model sp1 in section 3 2 fig 12 a shows that the three rpm curves obtain the same changing trend and almost overlap the revolution increases rapidly from the initial stage to 8000 rpm within 0 3 s then slows down and gradually approaches the convergence state the three curves maintain the convergence state with a slight horizontal fluctuation after 3 s during the initial 0 3 s the revolution characteristics of the sp3 model has an apparently different compared with those of the former two sp models in figs 7 a 8 a and 11 a where the revolution curves reach a considerable peak value at the initial adaptive stage this difference is related to the relative size of the pid controller coefficients when coefficient i is significantly larger than coefficient p i f 7p f in the sp3 model the influence of the proportional term in automatic adjustment decreases leading to a smooth adaptive process the coefficients p and i used in the free running sp model are the same p n i n in the sp1 and sp2 models and the automatic adjustment range of the proportion term is more extensive than that of the fixed sp3 model so the adaptive process of the target rpm curve shows more intense characteristics at the initial stage the balancing process of hull resistance and net thrust and the gross thrust variation are displayed in fig 12 b and c respectively the net thrust is directly related to the rotor revolution showing a consistent trend on the time scale and the hull resistance and net thrust are in a stable fluctuation state after 3 s from the local enlarged drawing of 8 10 s in fig 12 b the hull resistance curve is smooth and stable in the range of 14 5 15 5 n under the three grid densities while the net thrust curve fluctuates around the corresponding resistance curve in a small range under the adaptive adjustment thus the difference r h t net oscillates slightly near the equilibrium point zero and converges the fine medium and coarse grids converge to 8034 rpm 7964 rpm and 8072 rpm with the relative errors of 1 92 0 56 and 1 44 respectively as listed in table 8 as the convergence ratio is 0 65 showing oscillatory convergence the grid uncertainty should be computed from eq 10 the grid uncertainty is calculated as 0 68 d by taking the medium grid result 7964 rpm as the minimum value and the coarse grid result 8072 rpm as the maximum the fine mesh revolution fluctuates between 8019 rpm and 8049 rpm as shown in fig 12 d and the iteration uncertainty is 0 19 d according to eq 14 by ignoring the time step uncertainty the numerical uncertainty u sn can be obtained as 0 71 d and the total uncertainty u v is 5 05 d for the fine mesh result the relative error e 1 44 and 0 e u v and the numerical simulation results of the sp3 model are validated at the level of u v 5 05 d table 9 4 4 v v procedure of the fixed sp4 model the fixed sp4 model is consistent with the fixed sp3 model except for the propulsor controller the computational domain the three density grids the time step surge freedom and boundary conditions the sp point can be obtained by manually adjusting a series of waterjet rotor revolutions where three revolutions 7000 rpm 8000 rpm and 9000 rpm are applied in the simulation referencing the former sp models convergence time the sp4 model simulation lasts for 10 s at each rotor revolution to obtain the hull resistance and net thrust then the sp point could be computed by fitting the resistance and net thrust curve to intercept the intersection point when the hull resistance is equal to the waterjet net thrust the time history curves of the hull resistance r h and the waterjet net thrust t net under different density grids are displayed in fig 13 which indicates that the stability of the net thrust curve is significantly affected by the grid density when the rotor is 8000 rpm under the coarse grid the net thrust has a noticeable oscillation at the equilibrium position and the fluctuation amplitude accounts for 3 2 of the mean rpm value as shown in fig 13 a with the grid s refinement the net thrust oscillation apparently drops and the fluctuation amplitude is reduced to 1 3 as shown in fig 13 b and c at the same time it can be observed that when rpm 8000 both the net thrust curve of the coarse grid and the fine grid are below the hull resistance curve and vice versa for the medium grid which indicates that with the grid refines the computed sp point is under an oscillation fluctuation condition as shown in fig 13 d by taking the average value of the net thrust curve and the hull resistance at the three rpms curve fitting is performed on the r h rpm and t net rpm values to obtain the intersection point sp point of two curves of the corresponding grid density the intercepted sp points are listed in table 10 where the convergence ratio r g 0 59 indicates that the numerical simulation results belong to the case of oscillation convergence and the corresponding grid uncertainty is calculated as 0 92 d according to eq 10 ignoring the influence of u t and u i in the sp4 model simulation the grid uncertainty u g and the numerical uncertainty u sn are equal to 0 92 d and the total uncertainty u v 5 08 d the fine grid result e is 1 45 which is less than u v indicating that the numerical simulation result is reasonable and the validation of the sp4 model is achieved at the 5 08 u v level see table 11 4 5 wave patterns and ship attitudes the trimaran and its traveling waves of the four sp models in the self propulsion process are presented in fig 14 where the figures of the sp4 model are from an additional simulation and the results are under the computed 8035rpm sp point of sp4 model xoy is the global coordinate system horizontal plane and o is the origin ship wave patterns of five key moments 0 s 2 5 s 5 0 s 7 5 s and 10 0 s are compared allowing the background domain range and surge freedom characteristics listed in table 2 to be understood more intuitively we can see that the trimaran in two free running models sp1 and sp2 moves forward along the x axis and in the other two fixed models sp3 and sp4 both the background domain and vessel remain stationary in the surge direction at time 2 5s the two prominent crests after the stern have been generated in the sp1 model however only the first crest could be apparently observed for the other models and the second crest is still growing the wave pattern convergence speed is mainly referenced to the propulsor revolution and the relative velocity between the ship and fluid the maximum revolution of the sp1 model is more than 11 000 rpm in the initial adaptive stage fig 7 a while that of the sp2 model is approximately 10 400 rpm fig 11 a which accelerates the trimaran model of sp1 and advances faster and the ship wave patterns form earlier by applying smoother speed control in sp3 and a fixed value 8035 rpm in sp4 the interaction of the hull waterjet incoming flow will be relatively moderate and the generation process of ship waves will take more time under the fixed state notably at the end time 10 s the stern waves of the sp2 model have four prominent crests and the other three models have only three the enlarged contour of fig 15 demonstrates more details of the stern wave system in which the third wave crest of the sp2 model is more noticeable and located backwards compared to the other simulation results this phenomenon results from the eom based wave forcing absorbing boundary the other three sp models adopt the same calculation domain in fig 6 a and the wave forcing length is 1 0l pp on the outlet boundary as shown in fig 15 the forcing inner boundary is marked in the sp1 sp3 and sp4 models and the third wave crest is located in the wave forcing zone thus the current fvm cfd wave height is forced towards the calm water height zero from the forcing inner boundary to the outlet boundary however the sp2 model adopts the background with the a length of 7 5l pp while the trimaran travels for 10 s ship model is far from the wave forcing zone and the stern waves maintain complete wave system dispersion patterns the first wave crest detail is shown in fig 15 the wave trough after the stern transom nozzle jet flow and the first complete diffusion wave simulated by the four models are in good agreement the slight revolution fluctuation near the sp point slightly impacts the high speed nozzle jet flow uniformity however the wave crest region formed by jet spray interaction is under a dynamic change state and a slight difference in the first stern wave crest between the four models is reasonable similar to the comparison results of the wave patterns the heave and pitch of different trimaran models show the same trend at different times as shown in fig 16 at times of 0 5 s the heave and pitch fluctuate and the sp4 model with a fixed rpm has the largest oscillation amplitude but within a reasonable range after 7 5 s the heave tends to be maintained at approximately 1 4l pp 10 3 and the pitch angle tends to approach 0 25 deg in general there is no significant difference in the attitude changes among the four sp models 4 6 capture area and nozzle discharge of the waterjet performance the capture area and nozzle discharge of the waterjet duct are displayed in figs 17 and 18 the central waterjet duct s capture area is a semielliptical shape and the other two side capture areas are inclined due to the influence of the main hull s round bilge both sp models obtain a similar velocity distribution which is visualized using the ratio of the velocity magnitude to the target vessel speed and each sp model s mean inlet velocity ratio ivr is listed in table 12 where the value range is 0 7865 0 0035 with a slight maximum discrepancy of 0 89 the velocity distribution of four waterjet duct sections are compared the rotor section s1 stator section s2 stator tip section s3 and nozzle discharge section s4 which is generated and visualized using the ratio of the velocity magnitude to the target vessel speed fig 18 for the waterjet duct flow the water climbs up to the waterjet pump region from the duct intake is accelerated by the rotational waterjet rotor and then passes through the stator for flow straightening finally through the acceleration of the vena contracta the flow reaches the maximum speed and ejects from the nozzle discharge the velocity distributions at sections s1 s4 sections indicate the gradual acceleration process of the fluid flow in the waterjet duct either the left central and right ducts of a single sp model or the same sections of different sp models the velocity distributions show satisfactory consistency the nozzle velocity ratio nvr of the s4 section which is the vital parameter in the waterjet thrust calculation shows a maximum discrepancy of 0 75 among the four sp models eslamdoost et al 2014 determined that the gross thrust has an intensive sensitivity in nvr where a mere 1 differential of nvr could lead to a 4 difference in the gross thrust in this paper the computed ivr and nvr with a 0 89 and 0 75 discrepancies maintain that the computed gross thrust differential is less than 2 as listed in table 12 taking the experimental barehull resistance of the towing tank model test r bh 14 64 n as a reference the thrust deduction fraction t 1 r bh t g could be calculated and both the four models received a negative t distributed at approximately 0 042 0 010 4 7 computational efficiency the cpu used in the present cfd simulations is a 12 core 3 8 ghz processor the four sp models require approximately 11 1 h 22 2 h 9 7 h and 27 8 h of computational time to obtain the converged sp point under the corresponding fine grid scheme the fixed sp3 model with the pid controller has the lowest calculation time of 9 7 h while the conventional fixed model sp4 costs the longest time of 27 8 h to obtain the sp point compared with the sp3 model the sp1 model adopts the region moving method in the background domain which will increase the resolution during the overlapped grid interpolation and the total computational cost is 11 1 h due to the lengthened background domain the sp2 model has a grid number approximately 1 7 times than that of the other models and the overall time consumption is doubled compared with model sp1 taking the most time consuming model sp4 as the basic reference the four sp models relative calculation efficiencies can be calculated as 2 50 1 25 2 87 and 1 00 and the time saving percentages are 60 20 and 65 for sp1 sp2 and sp3 model respectively 4 8 comprehensive comparison and discussion a brief comparison between the four sp models is listed in table 13 the corresponding comprehensive comparison radar map is formed by combining the characteristics and simulation results of the four sp models as demonstrated in fig 19 where the free running sp1 model shows comprehensive advantages in terms of the computational domain surge freedom control strategy simulation scheme verification validation accuracy and efficiency the main differences between the four sp models focus on the computational region surge freedom and revolution control strategy the effect of each factor could be summarized as follows 4 8 1 computational region effect the computational domain effect could reference from the comparison of sp1 and sp2 models for the sp1 model after each iteration the background domain moves forward synchronously with the ship and the mesh ranges of the ship motion domain and the background domain are unchanged for the latter model the ship motion domain mesh is interpolated with the new background domain after each iteration and the interpolation results are affected by the grid distribution and the overall length of the background domain the above differences lead to different results of the two models in the v v procedure and the sp4 grids get diverged which is only the result of the current unified grid refinement strategy after expanding the computational domain and improving grid distribution suitable grids for the sp4 model can be generated to receive the grid converge besides there are some differences in the stern wave patterns between the two models which is related to the size of the computational domain and the forcing wave distance at the pressure outlet as mentioned in section 4 5 under the same grid refinement strategy the grid number is positively related to the size of the computational domain and the computational efficiency of sp1 is nearly 50 higher than that of sp2 4 8 2 surge freedom effect the influence of surge freedom can be compared from sp1 and sp3 models in each iteration the longitudinal displacement of the ship motion domain increases the complexity and computation cost of the overset grids interpolation and the former model takes a little more time than the latter in computational time cost simultaneously it also has a partial impact on the results of the two kinds of calculations although both sp1 and sp3 receive convergence results the final sp point difference between them is about 0 2 the results show that surge freedom has no effect on the macroscopic physical results and the free surface wave patterns distribution and the hull attitude curve of the two models are consistent after convergence 4 8 3 revolution control strategy effect the controller effect could reference from the comparison of sp3 and sp4 models when other conditions and parameters are consistent the self adapted rpm of sp3 is close to the interpolation value obtained by sp4 and the oscillation of rpm convergence curve of sp3 is less than 0 2 which makes the difference between the two in v v and wave patterns results little the oscillation of hull force and motion curves of sp4 are slightly larger than sp3 which is related the controller itself by using a controller the fluctuation and oscillation range of each curve will be reduced in sp3 the most advantage of using a controller is that the required sp point can be obtained just in a single simulation which brings nearly three times computational efficiency improvement under the same number of grids 5 conclusion coupling different propeller control methods and different surge freedom conditions four fixed and free running cfd sp models two pid controlled free running sp models with without a moving background sp1 and sp2 and two fixed sp models with without a propulsor controller sp3 and sp4 were proposed on a waterjet propelled trimaran model urans cfd simulations for the four sp models were conducted under the guidance of the v v procedure the model characteristics v v results flow details and waterjet performance were comprehensively compared researched and analyzed the main conclusions are presented below 1 the v v results of the four sp numerical models on the waterjet propelled trimaran show that the sp1 sp3 and sp4 models converge and are validated with a total uncertainty within 5 50 d although the sp2 model is temporarily not validated due to grid divergence all four fine grid computed sp points agree well with the experimental result with a difference under 1 5 and show the same accuracy level 2 the sp2 model has more complete stern wave system dispersion patterns than the other three sp models mainly associated with the computation domain range and the wave absorbing length the sp4 model with a fixed rpm has the largest oscillation amplitude in the attitude convergence process but shows the same trend as the other models the calculated differences in ivr and nvr are 0 89 and 0 75 respectively making the calculated discrepancy waterjet gross thrust under 2 3 for the present trimaran sp simulations using a propeller controller the sp3 fixed model decreases the computing time by 65 compared with the conventional sp4 fixed model extending the background domain length the sp2 free running model could simulate real time ship traveling compared with the sp3 fixed model but increase the computing time cost by 1 3 times by simultaneously applying the ship s horizontal motion to the background domain the sp1 free running model could simulate real time ship traveling without moving limitations under the conventional computational domain and save 50 more time than the sp2 model 4 the pid controlled free running sp1 model shows comprehensive advantages especially in terms of computing accuracy efficiency convergence speed stability and extensibility compared to the conventional fixed sp4 model which indicates its potential in directly simulating the shipl s real time motion in various complex environments future work includes the comparative research on velocity effects ship form effects and wave effects on the proposed fixed and free running models adopting the pid controlled free running model to evaluate the maneuverability performance of waterjet propelled trimaran is also in progress credit author statement lei zhang conceptualization methodology computation validation and analysis original draft writing review and editing resources supervision yuanhui wei analysis review and editing yusi deng analysis review and editing han yin analysis review and editing yi zhang analysis review and editing yuchen shang methodology computation validation and analysis review and editing jianing zhang review and editing resources supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was financially supported by the high tech ship research project of ministry of industry and information technology of china no miit 2017 614 national and international scientific and technological cooperation special projects of china 2013dfa80760 and the fundamental research funds for the central universities 3132019320 3132019001 
20684,the numerical method for self propulsion sp point prediction is an essential part of ship hydrodynamics however comprehensive investigations on different cfd sp model characteristics are rare especially for the high performance waterjet propelled trimarans this paper proposes four types of overset mesh based cfd sp numerical models on a waterjet propelled trimaran model two pid controlled free running sp models with without a moving background and two surge fixed sp models with without the propulsor pid controller the urans cfd simulations are conducted by following the verification and validation v v procedure to investigate the four sp models characteristics the four computed model sp points agree well with the experimental result and both the finest grid relative errors are within 1 5 a comprehensive comparison of the consumed computing resources surge freedom control strategy simulation scheme v v result simulated flow field simulation accuracy and calculation efficiency of the four sp models are analyzed both the pid controlled free running sp model with a moving background and the pid controlled surge fixed sp model show advantages in terms of computing resource consumption propulsor control strategy accuracy and efficiency in particular compared with the conventional fixed sp model the computational efficiency could be promoted up to 150 and the time consumption could decrease up to 60 furthermore the pid controlled free running cfd model with moving background shows its advantages and potential in directly simulating the ship s real time motion in various complex environments keywords self propulsion waterjet propelled trimaran free running pid controller urans cfd verification validation 1 introduction the ittc international towing tank conference proposed the practical guidelines for ship self propulsion cfd ittc 2014 according to the propeller rotation control approach two sp point calculation methods are recommended the interpolation method and the use of a controller the interpolation method the so called british method bertram 2012 obtains the hull resistance curve and propeller thrust curve by applying multiple propeller revolutions and the intersection of the two fitting curves is the sp point using a controller method controls the propeller revolution with the hull speed or force as the error term such that the sp point is obtained through the adaptive pi controller in a single simulation meanwhile according to the ship s horizontal freedom two cfd models can be applied a surge fixed model and a free running model the first model limits the ship s horizontal freedom and relatively realizes the ship s traveling by inputting the ship speed at the inlet in contrast by releasing the ship s surge freedom the free running model could realistically simulate ship motions moreover according to the background domain s freedom the free running model can be further divided into two models a region fixed model and a region moving model fig 1 demonstrates the two free running models with the overset grid the region fixed model has a towing tank like fixed background domain with enough length to simulate real time ship traveling to obtain the sp point however one pitfall of the method is that the grid numbers increase leading to a heightened computational consumption the second model s background domain is consistent with the conventional calculation domain and the background moves synchronously with the ship in the horizontal plane so that the ship moves freely without limitation and the sp point can be obtained with fewer computing resources in the early research on ship cfd self propulsion despite using the interpolation fitting approach the british method was widely applied in numerical simulations and the results were in good agreement with the experiments liu et al 2008 used the reynolds similarity to research the self propulsion performance of a 1 20 scaled 80 m cargo ship where the sp point was calculated from the intersection point of the hull resistance curve and thrust curve and the computed hull resistance of fr 0 179 0 251 was within an error of 3 0 choi et al 2009 proposed a computational prediction for ship speed performance by analyzing resistance and self propulsion computational results where the self propulsion point was obtained from two propeller rotative speeds based on the british method and the value was lower than the experimental value by 3 09 ge et al 2012 and wu et al 2013 researched the cfd standard kcs model and conducted barehull propeller open water and british method based self propulsion simulations to predict the full scale sp point and power performance and the predicted sp point received satisfactory results in which the error was less than 1 at both the model and full scale lee et al 2019 employed computational tools to predict the power increase and propulsion performances in waves of kvlcc2 where four propeller rotating speeds were adopted to obtain the calm water sp point for the propulsor controller applied in ship surge fixed sp simulations castro et al 2011 performed full scale self propulsion computations of the kcs container ship with the direct discretization of the propeller a dynamic overset approach was used which allowed an arbitrary rotational speed of the propeller during the computation the self propulsion point was obtained using a controller to modify the propeller rps until the target speed was maintained and the final converged rps error was approximately 1 27 at the model scale and 2 80 at the full scale the pi controller is not only used to accurately assess the jbc model s propulsion performance bakica et al 2019 but also applied in the penalty of hull and propeller fouling on ship self propulsion performance research song et al 2020 where the obtained accurate sp point enhanced the simulation reliability of the biofouling s effect on the fully appended kcs container ship the free running simulation model contains two kinds of grids non overset grids and overset grids in recent non overset grid based self propulsion research wu et al 2019a 2019b used a physical like method to simulate auv self propulsion and docking processes based on the multi block mesh moving mesh and dynamic layer method the differences in the self propulsion velocity wake fraction and thrust deduction factor compared with mrf multiple reference frames are 2 6 3 7 and 6 8 respectively the overset grid based free running model is usually coupled with the propulsor controller the in house code cfdship iowa developed by iowa institute of hydraulic research iihr can perform the propulsor controlled free running simulation huang huang et al 2008 bhushan bhushan et al 2009 carrica et al 2008 2010 2013 and many other researchers of iihr have made a series of significant contributions to cfd self propulsion and maneuverability based on the free running numerical model where the model has been comprehensively verified and validated in addition wang wang et al 2017 wang and wan 2020 conducted direct free running simulations of self propulsion coarse keeping and stopping based on the naoe foam sjtu numerical solver feng et al 2020 used hust ship an in house urans cfd code to perform the free running computations of kcs with different propulsion models which indicated that the modified oum osaka university method body force method has a higher accuracy than other body force models compared with the discretized propeller model and the experimental data cfd self propulsion computations on waterjet propelled trimarans have recently been reported by many researchers in studies adopting the conventional stationary computation domain guo et al 2020a obtained the self propulsion point of a trimaran by changing the impeller rotational speed three times until the horizontal force was balanced and then conducted a cfd based multiobjective optimization for the waterjet propelled trimaran guo et al 2020b compared to the original shape the total resistance thrust torque and power consumption of the optimized trimaran at self propulsion decreased by 3 85 increased by 6 38 increased by 1 73 and decreased by 10 39 respectively based on the self propulsion trimaran model jiang et al jiang and ding 2021 and gong et al 2021 studied the hull waterjet interaction characteristic of a planing trimaran and the dynamics scale effects of the stabilizer fins on the waterjet propelled trimaran respectively in the pid controlled free running trimaran aspect zhang et al 2019 2021 recently performed cfd self propulsion simulations and on a waterjet propelled trimaran model where the model was validated through a hybrid method and free running model test indicating that the proposed free running trimaran model appended with the pid controller and body force method is applicable for performance evaluation simulation with real time speed changes in a complex ocean environment as noticed from the literature review the cfd sp model is the critical foundation for the research of propulsion performance hull propeller interaction sea keeping and maneuverability coupling different revolution control methods and different surge freedom could form various sp models however existing research mostly relies on one of these models and there is seldom a comprehensive comparative study to research their advantages disadvantages and characteristics after the ittc released the practical guidelines for ship self propulsion cfd many cfd based studies using propeller controllers or free running models began to emerge where research is rarely associated with high performance waterjet propelled trimarans the current paper intends to bridge this gap in the research and provides a few references for related research based on cfd by conducting a comprehensive comparative study on different types of sp models based on the existing waterjet propelled free running trimaran model this paper is organized as follows the methodology of the current study is explained in section 2 including the rans equations propulsor pid controller used for finding the sp point and the verification and validation v v procedure the free running model test and four different cfd sp models are presented in section 3 finally the v v process wave pattern attitude capture area and nozzle discharge of waterjet self propulsion characteristics are presented in section 4 while comprehensive and comparative conclusions are presented in section 5 2 cfd numerical method 2 1 rans equations the viscous flow cfd numerical simulation is based on the rans reynolds averaged navier stokes equations in the present research the mass conservation continuity equation and the momentum conservation governing equation of an incompressible fluid are as follows 1 u i x i 0 2 u i t x j u i u j 1 ρ p x i ν x j u i x j u j x i τ i j x j f s ρ where ρ p ν and f s represent the fluid density average pressure kinematic viscosity coefficient and source term respectively u i and x i x j are the velocity vector and coordinate vector of the tensor representation in the cartesian coordinate system respectively where i j 1 2 3 and τ i j u i u j is the second order tensor form of the reynolds stress term which needs to be calculated by the turbulent transport equation the two equation turbulence model realizable k ε is used to solve the reynolds stress term of the rans equations in this paper 2 2 body force method and pid controller when the actual propeller geometric model is used in simulations ittc 2014 recommends the propeller rotating at 0 5 2 0 per time step under the restriction of the courant friedrichs lewy cfl condition to better simulate the actual effect of the propeller which is time consuming based on the body force method bfm using the virtual disk model to simulate the propeller hull interaction can save considerable computational resources bfm has been widely used in the propulsion model of ship self propulsion and cfd maneuverability simulations broglia et al 2013 sakamoto et al 2013 jin et al 2019 the virtual disk model assumes that the propeller s thrust and torque are uniformly distributed along the axial direction in a real propeller based virtual cylindrical disk by applying the propeller s characteristic performance curves which can be obtained from open water tests or numerical calculations to the virtual disk region the propeller can be effectively simulated under a reasonable accuracy the present sp simulations adopt the bfm based virtual disk model for the time savings and lower computational cost in a free running sp simulation the thrust of the propulsor i e propeller or jet pump drives the ship to move forward and the total resistance causes the ship to slow down to maintain a forward speed the pid controller coupled with a directional and speed feedback controller can meet the requirement for controlling the propeller revolution and then the target hull speed can be achieved taking the waterjet propelled trimaran model as an example the pid controller equation of the sp model with the velocity difference or the total force difference as the error term is expressed as follows zhang et al 2021 3 n p e i 0 t e d t d d e d t 4 n p v v 0 v n i v i 2 n t 2 v 0 v i v i 1 δ t 2 d v a v f r e e r u n n i n g m o d e l p f r h i t n e t i i f i 2 n t r h i r h i 1 t n e t i t n e t i 1 δ t 2 d f a f f i x e d m o d e l in the above two formulas n is the propulsor revolution with units of rpm r min or rps r s each coefficient subscript v and f represent the corresponding coefficient of velocity difference and force difference respectively while p i and d are the corresponding proportional term integral term and differential term coefficients respectively the specific values are set according to the different conditions of the research object a is the acceleration of the proportional deviation term v 0 v i and v n are the target vessel speed the speed at simulated time steps i and the current speed at the simulated time steps n t respectively r h i and t net i represent the hull resistance and the waterjet net thrust at the simulated time steps i 2 3 verification and validation v v procedure of cfd uncertainty analysis verification and validation ittc 2008 play an essential vital role in cfd simulations and many researchers have made tremendous remarkable contributions to the uncertainty analysis method generalized richardson extrapolation re is an important method for cfd grid analysis based on which roache 1994 proposed uniform grid studies by using the grid convergence index gci and celik and karatekin 1997 reported nonuniform grid distribution research through numerical experiments both uniform and nonuniform grids have been verified in cfd applications then a factor of safety fs method for both a grid spacing and time step uncertainty estimation was developed by xing and stern 2010 the fs method removes two unreasonably small uncertainty deficiencies of the gci and correction factor cf methods and evaluates different error estimations using the effectivity index after validating the fs method through the statistical analysis of 25 samples with different sizes xing and stern further applied this method to ship hydrodynamics uncertainty analysis moreover eça and hoekstra 2014 proposed a procedure for the numerical error uncertainty estimation of a numerical solution that accepts the practical limitations in grid density where the required so called asymptotic range data are not sufficient this numerical uncertainty procedure was validated through a series of numerical applications including 2 d manufactured solutions flow over a flat plate flow over a backward facing step and the flow around a tanker which provides a practical approach for the cfd uncertainty analysis in recent ship cfd uncertainty research mancini and de luca have performed a series of remarkable works in v v processes on planing hulls mancini 2015 de luca et al 2016 roll decay of the dtmb 5415 hull mancini et al 2018 and the dynamics of the planing hull in regular waves tavakoli et al 2020 which provides a comprehensive method for ship cfd uncertainty analysis the cfd simulation uncertainty u sn in the v v process is estimated by solving the grid uncertainty u g the iterative uncertainty u i the time step uncertainty u t and the other parameter uncertainty u p the influence of u p is usually not considered 5 u s n u g 2 u t 2 u i 2 u p 2 the comparison error e and the validation uncertainty u v are defined by the test value d and the test uncertainty u d as follows 6 e d s 7 u v u d 2 u s n 2 taking the calculation method of the grid uncertainty u g as an example where the uncertainty u t is also determined by referring to the following process for the uniformly refined trimmed volume grids in the star ccm platform a generalized definition method could be adopted for the refinement ratio r g which is defined as the ratio related to the total volume grid number 8 r g n f i n e n m e d i u m 1 3 o r n m e d i u m n c o a r s e 1 3 where n is the total volume grid number with different mesh densities generally at least three different sets of grids should be set up to verify the grid convergence s 1 s 2 and s 3 represent the fine medium and coarse grid numerical simulation results the convergence ratio of the numerical simulation can be obtained as follows 9 r g ε 21 ε 32 s 2 s 1 s 3 s 2 for the value of the convergence ratio r g there are four possible distributions as follows i 0 r g 1 monotonic convergence mc ii r g 0 r g 1 oscillatory convergence oc iii r g 1 monotonic divergence md iv r g 0 r g 1 oscillatory divergence od for the case of divergence iii and iv the numerical calculation results are in an unstable state and the grid uncertainty evaluation cannot be conducted for the oscillation convergence of case ii the grid uncertainty is calculated by using the maximum value s u and the minimum value s l of the oscillation based on the numerical calculation results 10 u g 1 2 s u s l for the monotonic convergence of case i the generalized richardson extrapolation method is applied to evaluate the levels of the numerical calculation accuracy and the estimated order of accuracy p g and the asymmetric measurement distance c g is as follows 11 p g ln 1 r g ln r g 12 c g r g p g 1 r g p e s t 1 in the formula the theoretical order of accuracy p est 2 the uncertainty u g of the final numerical calculation grid can be obtained from the following formula 13 u g c g ε 21 r g p g 1 1 c g ε 21 r g p g 1 similarly for the time step uncertainty u t the time step refinement ratio r t is determined by dividing the larger time step by the smaller time step furthermore the remaining uncertainty parameters are calculated referring to eqs 9 13 by replacing the subscript g with t notable is the theoretical order of accuracy p est 1 in the temporal uncertainty for the simulation result that enters a steady periodic fluctuation convergence the iteration uncertainty u i can be estimated as follows 14 u i 1 2 s u s l s u and s l represent the maximum and minimum values of the simulation results in a stable fluctuation period respectively 3 experimental model test and cfd numerical models 3 1 barehull resistance model test the research target is a trimaran model reinforced with glass fiber that is propelled by three sets of waterjets in the main hull stern the main dimensions of the ship are listed in table 1 the experimental model test contains two parts the barehull resistance model test and the free running model test for the former one the experiment is conducted in the towing tank of the china ship scientific research center cssrc which is 470 m 14 m 7 m with a maximum towing speed of 15 m s fig 2 a b shows the prepared trimaran geometry model where three intake duct openings are covered with plates to prevent water entry fig 2 c demonstrates the towed trimaran model in the towing tank after removing the towing force the measured barehull resistance is obtained as 14 64 n at fr 0 30 which corresponds to the free running model test velocity 3 2 free running self propulsion model test the waterjet propelled free running trimaran model is employed as the target vessel for comparative research on the cfd sp model as the free running model test cannot add the traditional towing force on the hull the sp point obtained from the experiment is the model scale point and the following sp simulations are both performed based on this sp point the trimaran model contains three sets of waterjet propulsors and the corresponding power systems remote control equipment and monitoring measurement equipment the signal acquisition and conversion system on the bow deck three 22 2 v dc batteries remote signal receivers and batteries voltage converters and circuit boards in the midship brushless motors and nozzles steering mechanism waterjet propulsors at stern etc as demonstrated in fig 3 a the free running sp model tests are conducted in a lake with calm open water where the target ship velocity is 1 88 m s corresponding to fr 0 30 during the straightforward test the trimaran model is controlled remotely at the zero waterjet nozzle angle real time measured velocity is transmitted wirelessly and automatically collected by a computer the ship model is accelerated by smoothly increasing the rotor revolution until the velocity reaches and maintains the target value of 1 88 m s then the corresponding rotor revolution is recorded as the model sp point after several repeated travels the average revolution is obtained as 7920 rpm fig 3 b c shows the model release moment and the test performance process 3 3 waterjet propulsor the waterjet propulsor used in the present experiment is an existing propulsive device used for other ship types before after evaluating the capability of the thruster and the thrust requirement of the trimaran we applied this existed suitable waterjet propulsor on the ship fig 4 a b demonstrate the waterjet rotor and stator assembly details where the rotor diameter equals 4 9 cm in the present cfd simulations to reduce the computational cost the body force model is applied as displayed in fig 4 c the stator is reserved for rotational flow rectification and the waterjet rotor is assumed to be a type of traditional individual propeller in the waterjet duct hydrodynamic performance curves including k t 10k q and η as shown in fig 4 d are applied in the rotor virtual disk region 3 4 self propulsion cfd numerical models four different cfd numerical models for self propulsion are presented in the present work fig 5 shows the conceptual diagrams of the four models and table 2 lists the main characteristics of the corresponding model the detailed description is as follows i sp1 the so called free running numerical model this ship model has the capability to travel freely without moving limitations due to the vessel s background domain moving simultaneously with the vessel the waterjet rotor is automatically controlled by a pid controller with the velocity difference as the proportional term and the body force method based virtual disk model is applied in the rotational region to simulate the waterjet rotor s effect thus the numerical simulation only needs a single run to achieve the sp point using the sp1 model ii sp2 the free running numerical model with the fixed background the surge freedom propulsor controller and required simulation times are the same as those of the sp1 model but the fixed background domain length should be sufficiently large to obtain a stable simulation result iii sp3 the fixed model with a propulsor controller this model has a surge fixed vessel and a fixed background domain and the propulsor is controlled by a pid controller using the resistance thrust difference as the proportional term the sp3 model also only needs a single run to get converge iv sp4 the conventional fixed model freedom of the vessel and background domain is the same as sp3 and the propulsor revolution is a fixed number in order to obtain the sp point through interpolation at least three simulations are required 4 results of the self propulsion numerical simulation 4 1 v v procedure of the free running sp1 model 4 1 1 simulation model of sp1 the computational background domain of the waterjet propelled free running numerical model sp1 is shown in fig 6 a overset grid technology and the region moving method are used to simulate the ship motion the realizable k ε turbulence model is used in the numerical simulation and the near wall flow field is solved by the double layer full y method the volume of fluid vof method is applied to capture the free surface the inlet velocity boundary conditions are set for the inlet side up and bottom boundary the pressure outlet condition is set for outlet and the eom euler overlay method based wave forcing boundary is applied in the inlet side and outlet boundaries for the wave absorption where the wave forcing lengths are both set to 1 0l pp mesh refinement strategies are applied around the ship hull and the traveling wave amplitude direction for the grid generation the prism layer thickness is set as 1 0 cm with a growth factor of 1 414 to ensure that the hull surface y value at the calculated speed is less than 100 by varying the basic mesh size three sets of grids fine medium and coarse are generated for the v v procedure as displayed in fig 6 b d the three density grid numbers are 3416 k 1966k and 1211 k and the average refinement ratio r g is 1 19 the recommended time step ratio r t 1 414 is applied in the time step uncertainty u t analysis where three time steps of 0 01 s 1 414 0 01 s and 0 02 s are used the simulation schemes for the v v procedure of the sp1 model are shown in table 3 4 1 2 grid uncertainty ug of sp1 the time step is 0 01 s for the grid uncertainty analysis the rotor revolution forward speed hull resistance and waterjet thrust are monitored during the self propulsion process for the free running numerical model the simulation should begin with a specified minor rpm to produce the integration and differentiation term and then the pid controller should be applied to the virtual disk the pid coefficient terms p n i n and d n are set as 1 5e5 1 5e5 and 8 0e2 respectively fig 7 shows the rotor revolution hull speed hull resistance and gross thrust convergence process varying with the simulation time we can see that the increased resistance rapidly reduces the hull speed after starting the simulations with the pid controller the rotor rpm is automatically adjusted to a maximum speed at a simulation time of 0 10 0 12 s the rpm is gradually reduced and the hull speed is gradually increased the rotor rpm hull speed hull resistance and gross thrust reach the equilibrium line of fluctuation within 4 s and then steadily fluctuate slightly at 10 s the ship wave pattern converges slowly compared to the above physical quantities and the wave pattern has been stabilized when time 10 s the results of the grid uncertainty are listed in table 4 the sp point s rotor revolution in the coarse medium and fine grids increases monotonically showing a monotonic convergence trend with relative errors of 0 57 0 69 and 1 26 respectively and the corresponding r g 0 45 the calculated grid uncertainty u g is equal to 2 28 d and the absolute values of each grid s relative errors are smaller than the values of the grid uncertainty which means that the three grids both show good agreement with the experimental results 4 1 3 time step uncertainty ut of sp1 the time step uncertainty research adopted the above fine grid scheme and three time steps in table 2 are applied for the numerical simulation the convergence curves of the rotor revolution hull speed hull resistance and gross thrust are shown in fig 8 where the stable fluctuation of different curves of the same physical quantity have very little difference by following the same analysis process as in grid uncertainty we can obtain the time uncertainty analysis results as shown in table 5 as the time step decreases from 0 02 s to 0 01 s the calculated rpm decreases slightly with a monotonic convergence trend and the relative error is within 1 55 the calculated time step uncertainty u t 0 29 d is one order smaller than u g 2 28 d which means that time step uncertainty is the minor term in the total uncertainty evaluation 4 1 4 iteration uncertainty ui of sp1 the iteration uncertainty u i is analyzed by using the numerical simulation results of the rotor rpm with fine mesh as shown in fig 9 the rpm curve converged in 10 s the periodic fluctuation value of the rpm curve is distributed between 8010 and 8030 within 9 5 10 0 s referencing from eq 14 the iteration uncertainty u i could be computed as 0 13 d which shows the same order of magnitude as u t and is one order of magnitude smaller than u g 4 1 5 numerical simulation uncertainty usn and the total uncertainty uv of sp1 based on the above grid uncertainty u g the time step uncertainty u t the iteration uncertainty u i of the numerical simulation and the experimental uncertainty u d the numerical simulation uncertainty u sn and the total uncertainty u v can be calculated from eq 5 and eq 7 respectively the experimental uncertainty u d of the free running model test is estimated according to the reference value of 5 d the results show that the orders of magnitude of u t and u i are smaller than that of u g as shown in table 6 below under the condition of considering or ignoring u t and u i the numerical simulation uncertainty u sn are 2 30 d and 2 28 d respectively which means the influence of u t and u i on u sn and u v is less than 0 02 d and the influence of the time step and iteration can be ignored compared with the grid influence in the present research the total uncertainty u v 5 50 d has the same order of magnitude as the grid uncertainty u g 2 28 d while the relative error of the fine mesh is 1 26 we can obtain 0 e u v which indicates that the revolution result of the sp1 model is validated at the 5 50 u v level 4 2 v v procedure of the free running sp2 model the background domain of the free running sp2 model is fixed and the longitudinal length is larger than that of the sp1 by referencing the sp1 model s traveling distance of 10 s the longitudinal length of the sp2 model is expanded to 7 5l pp fig 10 a so that the trimaran can move enough distance to reach the convergence state the propulsor pid controller adopts the same settings as the free running sp1 model in the grid uncertainty analysis the same basic mesh size and refinement strategies are used for grid generation and the grid numbers of the fine medium and coarse mesh are 5793 k 3032 k and 1649 k respectively as shown in fig 10 b d the time step is set as 0 01 s the same as the grid uncertainty analysis of the sp1 model variation curves of physical quantities such as rotor rpm forward speed and hull resistance of model sp2 are shown in fig 11 a c the changing trend of each curve is similar to that of the corresponding physical quantities of the sp1 model in fig 7 because the trimarans of the two models have the same characteristics of surge freedom propulsor controller and virtual disk model as shown in table 7 the revolution convergence values of fine medium and coarse density grids are 8025 rpm 7948 rpm and 7961 rpm respectively and the relative errors are 1 33 0 35 and 0 52 respectively for the fine grid simulation results the iteration uncertainty u i is 0 58 d by referencing the upper and lower limits of the speed fluctuation in fig 11 d however the convergence ratio of the sp2 model is computed as 5 29 which indicates that the numerical results of different density grids exhibit oscillatory divergence and the grid uncertainty result cannot be evaluated according to the v v procedure considering the rpm relative difference between the three density grid simulation results and the experimental value is within 1 5 the fine grid simulation result is selected for comparison with the other sp models the total uncertainty u v is represented as a missing term that could not be evaluated 4 3 v v procedure of the fixed sp3 model in the fixed sp3 model with a propulsor controller the computational domain three density grids and the time step are consistent with those of the sp1 model by fixing the surging freedom and setting the inlet boundary velocity to 1 88 m s corresponding to the speed fr 0 30 we can apply the resistance thrust difference as the control target of the proportional term for the propulsor controller in eq 4 then the rotor revolution is automatically controlled by the force difference based pid controller the coefficient terms p f i f and d f are set as 50 350 and 0 5 respectively and the model scale sp point can be obtained in one time simulation after stable convergence of the simulation the simulation time is set as 10 s according to model sp1 in section 3 2 fig 12 a shows that the three rpm curves obtain the same changing trend and almost overlap the revolution increases rapidly from the initial stage to 8000 rpm within 0 3 s then slows down and gradually approaches the convergence state the three curves maintain the convergence state with a slight horizontal fluctuation after 3 s during the initial 0 3 s the revolution characteristics of the sp3 model has an apparently different compared with those of the former two sp models in figs 7 a 8 a and 11 a where the revolution curves reach a considerable peak value at the initial adaptive stage this difference is related to the relative size of the pid controller coefficients when coefficient i is significantly larger than coefficient p i f 7p f in the sp3 model the influence of the proportional term in automatic adjustment decreases leading to a smooth adaptive process the coefficients p and i used in the free running sp model are the same p n i n in the sp1 and sp2 models and the automatic adjustment range of the proportion term is more extensive than that of the fixed sp3 model so the adaptive process of the target rpm curve shows more intense characteristics at the initial stage the balancing process of hull resistance and net thrust and the gross thrust variation are displayed in fig 12 b and c respectively the net thrust is directly related to the rotor revolution showing a consistent trend on the time scale and the hull resistance and net thrust are in a stable fluctuation state after 3 s from the local enlarged drawing of 8 10 s in fig 12 b the hull resistance curve is smooth and stable in the range of 14 5 15 5 n under the three grid densities while the net thrust curve fluctuates around the corresponding resistance curve in a small range under the adaptive adjustment thus the difference r h t net oscillates slightly near the equilibrium point zero and converges the fine medium and coarse grids converge to 8034 rpm 7964 rpm and 8072 rpm with the relative errors of 1 92 0 56 and 1 44 respectively as listed in table 8 as the convergence ratio is 0 65 showing oscillatory convergence the grid uncertainty should be computed from eq 10 the grid uncertainty is calculated as 0 68 d by taking the medium grid result 7964 rpm as the minimum value and the coarse grid result 8072 rpm as the maximum the fine mesh revolution fluctuates between 8019 rpm and 8049 rpm as shown in fig 12 d and the iteration uncertainty is 0 19 d according to eq 14 by ignoring the time step uncertainty the numerical uncertainty u sn can be obtained as 0 71 d and the total uncertainty u v is 5 05 d for the fine mesh result the relative error e 1 44 and 0 e u v and the numerical simulation results of the sp3 model are validated at the level of u v 5 05 d table 9 4 4 v v procedure of the fixed sp4 model the fixed sp4 model is consistent with the fixed sp3 model except for the propulsor controller the computational domain the three density grids the time step surge freedom and boundary conditions the sp point can be obtained by manually adjusting a series of waterjet rotor revolutions where three revolutions 7000 rpm 8000 rpm and 9000 rpm are applied in the simulation referencing the former sp models convergence time the sp4 model simulation lasts for 10 s at each rotor revolution to obtain the hull resistance and net thrust then the sp point could be computed by fitting the resistance and net thrust curve to intercept the intersection point when the hull resistance is equal to the waterjet net thrust the time history curves of the hull resistance r h and the waterjet net thrust t net under different density grids are displayed in fig 13 which indicates that the stability of the net thrust curve is significantly affected by the grid density when the rotor is 8000 rpm under the coarse grid the net thrust has a noticeable oscillation at the equilibrium position and the fluctuation amplitude accounts for 3 2 of the mean rpm value as shown in fig 13 a with the grid s refinement the net thrust oscillation apparently drops and the fluctuation amplitude is reduced to 1 3 as shown in fig 13 b and c at the same time it can be observed that when rpm 8000 both the net thrust curve of the coarse grid and the fine grid are below the hull resistance curve and vice versa for the medium grid which indicates that with the grid refines the computed sp point is under an oscillation fluctuation condition as shown in fig 13 d by taking the average value of the net thrust curve and the hull resistance at the three rpms curve fitting is performed on the r h rpm and t net rpm values to obtain the intersection point sp point of two curves of the corresponding grid density the intercepted sp points are listed in table 10 where the convergence ratio r g 0 59 indicates that the numerical simulation results belong to the case of oscillation convergence and the corresponding grid uncertainty is calculated as 0 92 d according to eq 10 ignoring the influence of u t and u i in the sp4 model simulation the grid uncertainty u g and the numerical uncertainty u sn are equal to 0 92 d and the total uncertainty u v 5 08 d the fine grid result e is 1 45 which is less than u v indicating that the numerical simulation result is reasonable and the validation of the sp4 model is achieved at the 5 08 u v level see table 11 4 5 wave patterns and ship attitudes the trimaran and its traveling waves of the four sp models in the self propulsion process are presented in fig 14 where the figures of the sp4 model are from an additional simulation and the results are under the computed 8035rpm sp point of sp4 model xoy is the global coordinate system horizontal plane and o is the origin ship wave patterns of five key moments 0 s 2 5 s 5 0 s 7 5 s and 10 0 s are compared allowing the background domain range and surge freedom characteristics listed in table 2 to be understood more intuitively we can see that the trimaran in two free running models sp1 and sp2 moves forward along the x axis and in the other two fixed models sp3 and sp4 both the background domain and vessel remain stationary in the surge direction at time 2 5s the two prominent crests after the stern have been generated in the sp1 model however only the first crest could be apparently observed for the other models and the second crest is still growing the wave pattern convergence speed is mainly referenced to the propulsor revolution and the relative velocity between the ship and fluid the maximum revolution of the sp1 model is more than 11 000 rpm in the initial adaptive stage fig 7 a while that of the sp2 model is approximately 10 400 rpm fig 11 a which accelerates the trimaran model of sp1 and advances faster and the ship wave patterns form earlier by applying smoother speed control in sp3 and a fixed value 8035 rpm in sp4 the interaction of the hull waterjet incoming flow will be relatively moderate and the generation process of ship waves will take more time under the fixed state notably at the end time 10 s the stern waves of the sp2 model have four prominent crests and the other three models have only three the enlarged contour of fig 15 demonstrates more details of the stern wave system in which the third wave crest of the sp2 model is more noticeable and located backwards compared to the other simulation results this phenomenon results from the eom based wave forcing absorbing boundary the other three sp models adopt the same calculation domain in fig 6 a and the wave forcing length is 1 0l pp on the outlet boundary as shown in fig 15 the forcing inner boundary is marked in the sp1 sp3 and sp4 models and the third wave crest is located in the wave forcing zone thus the current fvm cfd wave height is forced towards the calm water height zero from the forcing inner boundary to the outlet boundary however the sp2 model adopts the background with the a length of 7 5l pp while the trimaran travels for 10 s ship model is far from the wave forcing zone and the stern waves maintain complete wave system dispersion patterns the first wave crest detail is shown in fig 15 the wave trough after the stern transom nozzle jet flow and the first complete diffusion wave simulated by the four models are in good agreement the slight revolution fluctuation near the sp point slightly impacts the high speed nozzle jet flow uniformity however the wave crest region formed by jet spray interaction is under a dynamic change state and a slight difference in the first stern wave crest between the four models is reasonable similar to the comparison results of the wave patterns the heave and pitch of different trimaran models show the same trend at different times as shown in fig 16 at times of 0 5 s the heave and pitch fluctuate and the sp4 model with a fixed rpm has the largest oscillation amplitude but within a reasonable range after 7 5 s the heave tends to be maintained at approximately 1 4l pp 10 3 and the pitch angle tends to approach 0 25 deg in general there is no significant difference in the attitude changes among the four sp models 4 6 capture area and nozzle discharge of the waterjet performance the capture area and nozzle discharge of the waterjet duct are displayed in figs 17 and 18 the central waterjet duct s capture area is a semielliptical shape and the other two side capture areas are inclined due to the influence of the main hull s round bilge both sp models obtain a similar velocity distribution which is visualized using the ratio of the velocity magnitude to the target vessel speed and each sp model s mean inlet velocity ratio ivr is listed in table 12 where the value range is 0 7865 0 0035 with a slight maximum discrepancy of 0 89 the velocity distribution of four waterjet duct sections are compared the rotor section s1 stator section s2 stator tip section s3 and nozzle discharge section s4 which is generated and visualized using the ratio of the velocity magnitude to the target vessel speed fig 18 for the waterjet duct flow the water climbs up to the waterjet pump region from the duct intake is accelerated by the rotational waterjet rotor and then passes through the stator for flow straightening finally through the acceleration of the vena contracta the flow reaches the maximum speed and ejects from the nozzle discharge the velocity distributions at sections s1 s4 sections indicate the gradual acceleration process of the fluid flow in the waterjet duct either the left central and right ducts of a single sp model or the same sections of different sp models the velocity distributions show satisfactory consistency the nozzle velocity ratio nvr of the s4 section which is the vital parameter in the waterjet thrust calculation shows a maximum discrepancy of 0 75 among the four sp models eslamdoost et al 2014 determined that the gross thrust has an intensive sensitivity in nvr where a mere 1 differential of nvr could lead to a 4 difference in the gross thrust in this paper the computed ivr and nvr with a 0 89 and 0 75 discrepancies maintain that the computed gross thrust differential is less than 2 as listed in table 12 taking the experimental barehull resistance of the towing tank model test r bh 14 64 n as a reference the thrust deduction fraction t 1 r bh t g could be calculated and both the four models received a negative t distributed at approximately 0 042 0 010 4 7 computational efficiency the cpu used in the present cfd simulations is a 12 core 3 8 ghz processor the four sp models require approximately 11 1 h 22 2 h 9 7 h and 27 8 h of computational time to obtain the converged sp point under the corresponding fine grid scheme the fixed sp3 model with the pid controller has the lowest calculation time of 9 7 h while the conventional fixed model sp4 costs the longest time of 27 8 h to obtain the sp point compared with the sp3 model the sp1 model adopts the region moving method in the background domain which will increase the resolution during the overlapped grid interpolation and the total computational cost is 11 1 h due to the lengthened background domain the sp2 model has a grid number approximately 1 7 times than that of the other models and the overall time consumption is doubled compared with model sp1 taking the most time consuming model sp4 as the basic reference the four sp models relative calculation efficiencies can be calculated as 2 50 1 25 2 87 and 1 00 and the time saving percentages are 60 20 and 65 for sp1 sp2 and sp3 model respectively 4 8 comprehensive comparison and discussion a brief comparison between the four sp models is listed in table 13 the corresponding comprehensive comparison radar map is formed by combining the characteristics and simulation results of the four sp models as demonstrated in fig 19 where the free running sp1 model shows comprehensive advantages in terms of the computational domain surge freedom control strategy simulation scheme verification validation accuracy and efficiency the main differences between the four sp models focus on the computational region surge freedom and revolution control strategy the effect of each factor could be summarized as follows 4 8 1 computational region effect the computational domain effect could reference from the comparison of sp1 and sp2 models for the sp1 model after each iteration the background domain moves forward synchronously with the ship and the mesh ranges of the ship motion domain and the background domain are unchanged for the latter model the ship motion domain mesh is interpolated with the new background domain after each iteration and the interpolation results are affected by the grid distribution and the overall length of the background domain the above differences lead to different results of the two models in the v v procedure and the sp4 grids get diverged which is only the result of the current unified grid refinement strategy after expanding the computational domain and improving grid distribution suitable grids for the sp4 model can be generated to receive the grid converge besides there are some differences in the stern wave patterns between the two models which is related to the size of the computational domain and the forcing wave distance at the pressure outlet as mentioned in section 4 5 under the same grid refinement strategy the grid number is positively related to the size of the computational domain and the computational efficiency of sp1 is nearly 50 higher than that of sp2 4 8 2 surge freedom effect the influence of surge freedom can be compared from sp1 and sp3 models in each iteration the longitudinal displacement of the ship motion domain increases the complexity and computation cost of the overset grids interpolation and the former model takes a little more time than the latter in computational time cost simultaneously it also has a partial impact on the results of the two kinds of calculations although both sp1 and sp3 receive convergence results the final sp point difference between them is about 0 2 the results show that surge freedom has no effect on the macroscopic physical results and the free surface wave patterns distribution and the hull attitude curve of the two models are consistent after convergence 4 8 3 revolution control strategy effect the controller effect could reference from the comparison of sp3 and sp4 models when other conditions and parameters are consistent the self adapted rpm of sp3 is close to the interpolation value obtained by sp4 and the oscillation of rpm convergence curve of sp3 is less than 0 2 which makes the difference between the two in v v and wave patterns results little the oscillation of hull force and motion curves of sp4 are slightly larger than sp3 which is related the controller itself by using a controller the fluctuation and oscillation range of each curve will be reduced in sp3 the most advantage of using a controller is that the required sp point can be obtained just in a single simulation which brings nearly three times computational efficiency improvement under the same number of grids 5 conclusion coupling different propeller control methods and different surge freedom conditions four fixed and free running cfd sp models two pid controlled free running sp models with without a moving background sp1 and sp2 and two fixed sp models with without a propulsor controller sp3 and sp4 were proposed on a waterjet propelled trimaran model urans cfd simulations for the four sp models were conducted under the guidance of the v v procedure the model characteristics v v results flow details and waterjet performance were comprehensively compared researched and analyzed the main conclusions are presented below 1 the v v results of the four sp numerical models on the waterjet propelled trimaran show that the sp1 sp3 and sp4 models converge and are validated with a total uncertainty within 5 50 d although the sp2 model is temporarily not validated due to grid divergence all four fine grid computed sp points agree well with the experimental result with a difference under 1 5 and show the same accuracy level 2 the sp2 model has more complete stern wave system dispersion patterns than the other three sp models mainly associated with the computation domain range and the wave absorbing length the sp4 model with a fixed rpm has the largest oscillation amplitude in the attitude convergence process but shows the same trend as the other models the calculated differences in ivr and nvr are 0 89 and 0 75 respectively making the calculated discrepancy waterjet gross thrust under 2 3 for the present trimaran sp simulations using a propeller controller the sp3 fixed model decreases the computing time by 65 compared with the conventional sp4 fixed model extending the background domain length the sp2 free running model could simulate real time ship traveling compared with the sp3 fixed model but increase the computing time cost by 1 3 times by simultaneously applying the ship s horizontal motion to the background domain the sp1 free running model could simulate real time ship traveling without moving limitations under the conventional computational domain and save 50 more time than the sp2 model 4 the pid controlled free running sp1 model shows comprehensive advantages especially in terms of computing accuracy efficiency convergence speed stability and extensibility compared to the conventional fixed sp4 model which indicates its potential in directly simulating the shipl s real time motion in various complex environments future work includes the comparative research on velocity effects ship form effects and wave effects on the proposed fixed and free running models adopting the pid controlled free running model to evaluate the maneuverability performance of waterjet propelled trimaran is also in progress credit author statement lei zhang conceptualization methodology computation validation and analysis original draft writing review and editing resources supervision yuanhui wei analysis review and editing yusi deng analysis review and editing han yin analysis review and editing yi zhang analysis review and editing yuchen shang methodology computation validation and analysis review and editing jianing zhang review and editing resources supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was financially supported by the high tech ship research project of ministry of industry and information technology of china no miit 2017 614 national and international scientific and technological cooperation special projects of china 2013dfa80760 and the fundamental research funds for the central universities 3132019320 3132019001 
