index,text
445,the discrete fracture model dfm has been widely used to describe the flow problems in fractured media in low permeability media with conductive fractures embedded in there is large capillary pressure contrast between fracture and matrix it may cause very sharp changes of physical quantities near the matrix fracture interface which makes it difficult to calculate the matrix fracture transfer flux accurately in the traditional dfm in this article mathematical analysis for the flow characteristics near the matrix fracture interface is present three flow patterns can be distinguished for the two phase steady flow across the matrix fracture interface under the assumption of negligible capillary pressure in fracture the analytical solutions for the three different patterns are derived and then employed to construct an alternative numerical scheme of calculating matrix fracture transfer flow rate numerical examples show that the calculated results of the proposed model are in agreement with the reference solution it indicates that the proposed model can overcome the difficulty of accurately predicting the matrix fracture transfer flux in the traditional numerical scheme and then dramatically improve the computational accuracy for the two phase flow in low permeability reservoirs with conductive fractures keywords low permeability fractured porous media two phase flow discrete fracture model capillary end effect 1 introduction fractures are present in many subsurface systems and can strongly influence and even dominate fluid flow and transport behavior for example artificial fracturing technique has become an important measure for stimulation in low permeability reservoirs daneshy 1978 warpinski 1991 in hydrological applications involving low permeability formations fractures provide the most plausible pathways to the biosphere for nuclear waste buried at depth painter and cvetkovic 2005 maryška et al 2005 for karst geology the presence of fractures affects the flow paths in the medium and should be accurately accounted for in the numerical models bauer et al 2003 huang et al 2013 popov et al 2009 romanov et al 2002 when designing enhanced geothermal systems it is also necessary to understand the response of fractures to the coupled hydrological processes as it contributes to the occurrence of seismicity ghassemi and zhou 2011 shaik et al 2011 the ability to model and simulate the multiphase dynamics in fractured system is of utmost importance to the development of co2 storage which can be combined with enhanced oil recovery in fractured reservoirs ahmed and li 2019 march et al 2018 nooraiepour et al 2017 in order to accurately predict the fluid flow behaviors in these kinds of fractured media it is necessary to develop a highly efficient numerical simulation method for this matrix fracture coupled system the dual porosity model barenblatt and zheltov 1960 warren and root 1963 kazemi et al 1976 lim and aziz 1995 noetinger and estebenet 2000 has been widely used for the reservoir with well developed fracture system however this model is not suitable to describe large scale conductive fractures shahraeeni et al 2015 cordero et al 2019 abbasi et al 2018 the single porosity model is employed by early scholars to simulate conductive fractures in which very fine grids are required to calculate the flow in matrix fracture coupled system therefore it is difficult to be applied in engineering due to its high demand for computing power to improve the efficiency the discrete fracture model dfm bogdanov et al 2003 kim and deo 1999 reichenberger et al 2006 tunc et al 2012 sandve et al 2012 fumagalli and keilegavlen 2019 nœtinger 2015 flemisch et al 2018 is then developed in recent years in which fractures are modeled as interfaces of co dimension one the dfm was initially introduced by noorishad and baca et al baca et al 1984 noorishad and mehran 1982 to simulate single phase flow slough and karimi fard et al slough et al 1999 slough et al 1999 karimi fard et al 2003 extended the dfm to multiphase flow simulation different from the original dfm for single phase flow the discrete variables including pressure and saturation are defined respectively for fracture and matrix fracture and matrix are coupled through the transfer term between them thus calculating the transfer term accurately is very important and has been investigated for a long time karimi fard et al karimi fard et al 2003 suggested that the interface mobility should take its value from upstream when calculating the matrix fracture m f transfer flux but this method is hard to describe the saturation jump across the interface brenner et al 2018 monteagudo et al monteagudo and firoozabadi 2004 monteagudo and firoozabadi 2007 assumed that each phase pressure in fracture was equal to its value at the interface and phase saturations in matrix and fracture were calculated with the help of continuity condition of the capillary pressure this assumption is not suitable for the cases where the fracture is filled with non wetting phase brenner et al 2018 or the fracture capillary pressure is zero hoteit and firoozabadi 2008 brenner et al brenner et al 2018 aghili et al 2019 brenner et al 2013 brenner et al 2016 brenner et al 2016 proposed the linear and nonlinear transmission conditions to simulate the flow in fractures acting either as barriers or drains in the case of the fractures acting as drains their model provides basically the same solutions as the ones obtained by the continuous pressure model proposed by monteagudo et al for different types of rock the capillary pressure curves are different which will have a serious impact on reservoir numerical simulation ding et al 2016 wang et al 2006 in the core experiment the capillary pressure exists in the core while it can be ignored outside the core the capillary pressure discontinuity at the outlet of core may occur and the capillary end effect arises this effect creates wetting phase layer near the outlet with residual non wetting phase saturation which enhances the hydraulic resistance for non wetting phase flow and is known as water blocking assuming that water phase saturation is 1 at the outlet end of the water wet core a saturation distribution equation near the outlet end was established hadley g and handy l 1956 then the way to correct the errors in the relative permeability measurements considering the capillary end effect has been proposed huang and honarpour 1998 virnovsky et al 1995 in the recent based on the analytical equations of one dimensional radial flow considering the capillary end effect an alternative numerical well model for low permeability gas reservoir is constructed which can predict the gas and water productions accurately at different grid scales yao et al 2019 there is strong capillary pressure contrast between matrix and fracture in low permeability reservoirs which results in complex flow conditions at the matrix fracture interface and creates difficulty in calculation of the m f transfer flux according to our analysis there are three flow patterns for the two phase flow across the matrix fracture interface the first both two phase fluids flow from matrix to fracture the second only non wetting phase flow from matrix to fracture the last both two phases flow from fracture to matrix in the first flow pattern the pressure difference between matrix and fracture can overcome the capillary end effect the wetting phase saturation at the matrix fracture interface remains 1 due to the continuity condition of the capillary pressure which results in the divergence of the non wetting phase pressure gradient in the second flow pattern the pressure difference between matrix and fracture cannot overcome the capillary end effect so only the non wetting phase can flow across the matrix fracture interface in the third flow pattern the pressure in matrix is less than that in fracture so both two phase fluids can flow from fracture to matrix the two phase flow characters in the neighborhood of the matrix fracture interface are analyzed in this article based upon the analytical solution of one dimensional two phase steady flow near the interface in matrix a novel algorithm of calculating the transfer flow rate is established the proposed algorithm can eliminate the uncontrollable numerical dissipation in the traditional method caused by the divergence of pressure and saturation gradient and therefore it can provide more accurate results even without refining the meshes numerical examples are performed to test the accuracy and efficiency of the proposed numerical scheme it is shown that the proposed scheme in coarse grids can provide accurate solutions this article is organized as follows the mathematical model is present in section 2 and the traditional discrete model is introduced in section 3 respectively the proposed algorithm for calculating the matrix fracture transfer flow rate is proposed in section 4 in section 5 numerical examples are provided to illustrate the accuracy and efficiency of the proposed numerical scheme conclusions are drawn in section 6 2 mathematical model in this article we consider incompressible two phase wetting phase and non wetting phase flow in the 2d matrix fracture coupled system in single porosity model the mass conservation equation of α phase α n represents non wetting phase and α w represents wetting phase both in matrix and fracture can be written as 1 ϕ β s α β t u α β 0 β m or f where the subscript β m or f represents the variables in matrix or in fracture respectively ϕ s α and u α are porosity phase saturation and velocity respectively in dfm matrix zone and fracture zone are distinguished strictly fractures are embedded in matrix and both sides of fracture can be seemed as the boundary of matrix in 2d system fractures in dfm are seemed as one dimensional since their lengths are much larger than their widths therefore for matrix the calculated matrix fracture transfer flow rate acts as matrix boundary condition but for fracture the transfer flow rate is treated as a source term thus the mass conservation equation in fracture can be written as 2 ϕ f s α f t u α f x f q α f the source term q α f represents the transfer flow rate between matrix and fracture it can be calculated by 3 q α f u α m 1 n 1 u α m 2 n 2 d f where n is unit external normal vector of m f interface the superscripts 1 and 2 represent the two sides of fracture respectively df is the width of fracture in dfm the mass conservation equation in matrix can be still written by eq 1 with β m according to the generalized darcy s law the multi phase velocity in fracture and matrix of dfm can be described by the following equations 4 u α f k f λ α f p α f x f 5 u α m k m λ α m p α m where p α is the α phase pressure k is absolute permeability and λα k rα μα is α phase relative mobility defined as the ratio of relative permeability to viscosity the saturation satisfies the following constraint 6 s w β s n β 1 β m or f and phase pressures satisfy the following capillary pressure relationship 7 p c β s w p n β p w β this article will discuss the calculation of the transfer flow rate q α f when performing numerical simulation 3 traditional discrete model the cell centered finite volume scheme with two point flux approximation is employed in single porosity model and dfm details of this numerical scheme can be found in tunc et al 2012 karimi fard et al 2003 hamon et al 2018 hægland et al 2009 the simulation domain is discretized into n control volumes use the symbol i and j to represent the relevant control volumes and the symbol ωβ β m or f to represent the set of all control volumes in the matrix or fracture medium choose non wetting phase pressure pn and wetting phase saturation sw as the primary variables the discrete equation of the control volume i can be written as 8 ϕ i β δ v i s α i n 1 s α i n δ t j a d j i ω β f α i j β j a d j i j ω β q α i j m f 0 i ω β where s α i represents the α phase saturation of the control volume i δvi is the measure of control volume i adj i is the set of neighbors of control volume of i f α i j β is the α phase numerical volumetric flow rate across the interface γ ij between the two control volumes i and j belonging to the same medium ωβ q α i j m f is the corresponding numerical volumetric flow rate across the interface γ ij where the two control volumes i and j belonging to the different media ωβ one belonging matrix and the other belonging to fracture this discrete equation can be applied to both single porosity model and dfm the fluxes f α i j β and q α i j m f can both be expressed as the functions of the two adjacent discrete pressure difference δp α ij p α i p α j the discrete wetting phase saturation s w i and s w j for the flux f α i j β inside the same medium β m or f the following traditional algorithm is adopted 9 f α i j β k β λ α i j u p δ p α i j d i j d j i a i j where dij and dji represent the distances from the discrete pressure points p α i and p α j to the interface γ ij respectively λ n i j u p is the non wetting phase mobility of upstream grid and aij is the measure of γ ij for the matrix fracture transfer flow rate q α i j m f the traditional method uses a similar algorithm as 9 assuming i ω m and j ω f since dji dij the phase transfer flow rate is directly calculated by 10 q α i j m f k m λ α i j u p δ p α i j d i j a i j however in low permeability reservoirs due to the large contrast between the capillary pressures in matrix and fracture physical quantities may change rapidly near the matrix fracture interface thus the algorithm 10 of calculating q α i j m f in the traditional discrete method cannot calculate the m f transfer flow rate accurately an alternative numerical scheme will be proposed in this article to replace 10 for calculating the m f transfer flux rate the proposed numerical scheme is based upon the analysis of the flow characteristics near the m f interface the specifics of this method will be introduced in the next section 4 modified discrete model in this section we will propose an alternative algorithm of calculating the m f transfer flow rate based upon the one dimensional steady state analytical solution near the m f interface considering the fact that the capillary pressure in fracture is usually much smaller than that in matrix we investigate an ideal model with negligible capillary pressure in fracture for the sake of simplicity we define s as the normalized wetting phase saturation 11 s 1 s w c 1 s w c s n r where snr is the residual non wetting phase saturation and swc is the irreducible wetting phase saturation for the two adjacent control volume i and j suppose i ω m and j ω f the discrete non wetting phase pressures of the grid cells i and j are denoted as pi and pj respectively see fig a 1 in appendix the non wetting phase pressure difference and the capillary pressure difference of these two adjacent grids are denoted as δp pi pj and δ p c p c m s i p c f s j respectively because the capillary pressure curves in matrix and fracture are different there are two saturations at the m f interface γ ij s γ m at the matrix side and s γ f at the fracture side in this article the analytical solution for the one dimensional steady flow is utilized to calculate the m f transfer flow rate this steady flow assumption is suitable for the case where the transient effect is not significant near the m f interface under the steady flow assumption the transfer flow rates of wetting and non wetting phase are given by 12 q w i j k m λ w m d p d x d p c m d x a i j 13 q n i j k m λ n m d p d x a i j where q denotes the volume flow rate x denotes the normal direction perpendicular to m f interface aij is the measure of the interface γ ij dividing the eq 13 by the eq 12 we have 14 d p λ w m d p c m d s λ w m λ n m θ d s where θ q w ij q n ij represents the ratio of wetting phase transfer flow rate to non wetting phase transfer flow rate substituting the relation 14 into the eq 13 we can obtain 15 q n i j d x d p c m d s k m λ w m λ n m a i j λ w m θ λ n m d s according to the size relationship between the pressure difference δp and the capillary pressure difference δpc on the adjacent matrix and fracture cells in appendix it is shown that three patterns crossing the m f interface can be distinguished under the following assumptions ① the flow across the interface is assumed to be steady ② the capillary pressure curves satisfy p c β 0 and p c β 1 0 β m or f ③ under a given value of the normalized wetting phase saturation the capillary pressure in fracture is assumed to be negligible compared to that in matrix based upon the characteristics of these three flow patterns the transfer flow rates across the m f interface can be calculated respectively which is the core of the proposed numerical algorithm it is briefly introduced as follows a both two phase fluids flow from matrix into fracture δp δpc 0 notice that δpc is always above zero since the capillary pressure in fracture is assumed to be negligible when the non wetting phase pressure difference is bigger than the capillary pressure difference δp δpc 0 both two phases can flow from matrix to fracture in appendix we prove that s γ m 1 for this case under the condition of negligible capillary pressure in fracture see a 13 this phenomenon is known as capillary end effect caused by the strong capillary pressure contrast between matrix and fracture huang and honarpour 1998 virnovsky et al 1995 pø et al 2017 because the non wetting phase velocity is not zero while its saturation is zero at the m f interface the non wetting phase pressure gradient diverges at the interface integrating 14 and considering the interface condition s γ m 1 we have 16 δ p s i 1 λ w m d p c m d s λ w m λ n m θ d s in the eq 16 there is only one unknown variable the ratio of wetting and non wetting phase transfer flow rates q for the given curves of capillary pressure p c m and relative mobility λ α m after getting δp and si the value of θ can be calculated by using the newton raphson iteration method substituting the calculated θ and s γ m 1 into 15 the non wetting phase transfer flow rate across m f interface can be calculated directly by 17 q n i j k m a i j d i j s i 1 d p c m d s λ w m λ n m λ w m θ λ n m d s utilizing the definition of θ the wetting phase transfer flow rate across m f interface is 18 q w i j θ q n i j b only non wetting phase flow from the matrix to the fracture 0 δp δpc when the non wetting phase pressure difference is smaller than the capillary pressure difference 0 δp δpc only non wetting phase can flow from matrix to fracture in appendix we prove that q w ij 0 and θ 0 substituting this relation into 14 we have 19 d p d p c m d s d s integrating 19 we get 20 δ p p c m s i p c m s γ m utilizing the relation 20 the interface saturation s γ m at the matrix side can be calculated out substituting θ 0 and the calculated s γ m into 15 the non wetting phase transfer flow rate can be calculated directly by 21 q n i j k m a i j d i j s i s γ m d p c m d s λ n m d s c both two phase fluids flow from the fracture to the matrix δp 0 when the phase pressures in fracture are bigger than those in matrix δp 0 both two phases will flow from fracture to matrix in appendix it is shown that the ratio of the phase transfer flow rate is equal to the mobility ratio of the upstream i e the fracture side that is 22 θ λ w f s j λ n f s j integrating 14 we can obtain 23 δ p s i s γ m λ w m d p c m d s λ w m λ n m θ d s since the value of θ can be determined by the relation 22 there is only one unknown variable s γ m in the eq 23 which can be solved with the newton raphson iteration method then the non wetting phase transfer flow rate can be calculated directly by 24 q n i j k m a i j d i j s i s γ m d p c m d s λ w m λ n m λ w m θ λ n m d s utilizing the definition of the wetting phase transfer flow rate is 25 q w i j θ q n i j the relations 17 and 18 for the first case 20 and 21 for the second case 24 and 25 for the third case actually provide a new algorithm to calculate the phase transfer rate across the m f interface they can be used to replace the relation 10 in the traditional discrete model and by this approach we propose an alternative discrete fracture model due to the strong capillary pressure contrast between matrix and fracture there are three different flow patterns across the m f interface both two phases flowing from matrix to fracture only non wetting phase flowing from matrix to fracture and both two phases flowing from fracture to matrix the properties of the different flow patterns have the strong influence upon the calculations of the m f transfer flow rate it has already been known that the non wetting phase pressure gradient and the saturation gradient will diverge near the m f interface when both two phases flow from matrix to fracture huang and honarpour 1998 virnovsky et al 1995 pø et al 2017 actually the traditional model described by 10 coming from one kind of simple discretization of the generalized darcy s law 12 and 13 is based upon taylor expansion therefore in the traditional numerical scheme subdividing meshes sufficiently is inevitably required near the m f interface where the pressure and saturation gradients may diverge in this article the m f transfer flow rate is calculated based upon the local analytical solution near the m f interface which can naturally overcome the difficulties existing in the traditional numerical scheme 5 numerical examples in order to verify the proposed model several numerical tests are performed without the loss of generality the wetting and non wetting phase in these tests are supposed to be water and oil respectively the simulation results from the proposed dfm are compared with the traditional one as well as the reference solution where enough refined grids are used in single porosity model both in matrix and fracture numerical tests show that the proposed dfm is much more efficient than the traditional one and can provide accurate results even on coarse grids 5 1 example 1 as shown in fig 1 a a horizontal fracture with 0 5 m long and 2 5 mm wide is embedded in the rectangular region of 1 m 0 5 m the permeability in matrix and in fracture are set as km 1 md and kf 10 d respectively the right end of the fracture is just the outlet the capillary pressure in fracture is negligible the other relevant parameters values needed for accomplishing the numerical simulation are shown in table 1 the meshing of the three models the traditional dfm the proposed dfm and the single porosity model are shown in fig 1 b and c fig 1 b shows the meshing scheme for both the traditional dfm and the proposed dfm where the matrix is divided into nx ny cells and the fracture is treated as one dimensional and divided into nx 2 cells correspondingly in order to provide a reference solution the single porosity model is employed under enough refined cells both in matrix and fracture as shown in fig 1 c the cells in the fracture and adjacent to the fracture are enough refined to provide the reference solution in this example we first divide the whole domain into 20 40 cells and then each cell in the fracture or adjacent to the fracture is refined to 10 cells in the direction perpendicular to the fracture with equi dimensional discretization this solution is used as the reference one since no differences can be detected among the grid systems with nx ny 20 20 20 40 and 40 40 the transfer flow rate across m f interface in this single porosity model is calculated following the traditional approach the solution under these refined cells can be seemed as the reference one since no difference can be detected under more refinements the calculation under the grid refinement where each cell in the fracture or adjacent to the fracture is refined to 20 cells in the direction perpendicular to the fracture with equi dimensional discretization is also performed little difference can be observed between the calculated results under the refinements of 10 cells and 20 cells three different boundary conditions for matrix medium are assigned in order to test the accuracy of the proposed model under different flow patterns shown in fig 2 case 1 both two phase fluids flow from matrix into fracture the boundary condition of this case is shown in fig 2 a where the upper and lower boundary pressures are set as 1 2 mpa and no flow conditions are imposed at the left and right boundaries of the matrix the pressure at the right end of the fracture where is the outlet is set as 1 0 mpa the initial water saturation in the matrix is 0 5 and the initial water saturation in the fracture is 0 01 water is injected from the upper and lower boundaries and the two phase fluids will flow out only from the right end of the fracture fig 3 shows the variations of the total water and oil flux from the matrix to the fracture and the average water saturation in the fracture with time two grid systems for dfm are used to perform the simulation the coarse grid system with nx ny 20 20 and the fine grid system with nx ny 20 40 it can be seen that the proposed model provides consistent results with the reference one both in coarse and fine grids however the traditional dfm underestimates the water flux transferring from the matrix to the fracture see fig 3a and correspondingly it also underestimates the water saturation inside the fracture see fig 3c the calculated water saturation field in the matrix at t 8 64 104 s is presented in fig 4 using grid system 20 40 for dfm in the proposed numerical scheme after getting the m f flux the saturation field near the interface can be reconstructed according to the analytical solution by using the eq 15 i e the proposed dfm can provide the flow details near the m f interface fig 4b shows that the reconstructed field is coincident with the reference one this is one of the advantages of the proposed dfm it can be seen that the reconstructed field from the proposed dfm is consistent with the reference one see fig 4b and c in contrast the water saturation distribution near the m f interface cannot be fully described by the traditional dfm see fig 4a due to the divergence of the non wetting phase pressure gradient and saturation gradient near the m f interface the traditional dfm can converge to the reference solution only under sufficient subdivision but this problem is out of control since it is difficult to estimate the suitable grid size the comparison in the computational costs of each employed method is presented in table 2 it can be seen that the computational cost of the proposed method is close to the traditional dfm under the same grid size case 2 only oil phase flow from matrix into fracture in this case water is injected from the left boundary and both two phase fluids will flow out from the right end of the fracture the boundary condition of matrix medium is shown in fig 2 b where the left boundary pressure is 1 1 mpa and no flow conditions are imposed at the other three boundaries the outlet pressure at the right end of the fracture is 1 0 mpa both the initial water saturations in fracture and matrix are set as 0 2 fig 5 shows the variations of the total water and oil flux from the matrix to the fracture and the average water saturation in the fracture with time from fig 5 we can see that the water transfer flow rate is actually zero in this case while the traditional dfm provides incorrect calculation results where the water phase is predicted to flow from the fracture into the matrix correspondingly the oil transfer flow rate has been greatly overestimated by the traditional dfm see fig 5b as the consequence the traditional dfm underestimates the water saturation in the fracture in contrast the proposed dfm can capture the characteristics of fluid flows accurately and therefore provide the correct results in agreement to the reference one the accuracy of the proposed model is also indicated by the reconstructed saturation field as shown in fig 6 the comparison in the computational costs of each employed method for this case is presented in table 3 case 3 both two phase fluids flow from fracture into matrix in this case oil is injected into the fracture from the right boundary so that the fluids in the matrix are displaced and flow out from the open left boundary the pressure at the right end of the fracture which is the flow inlet is set as 1 1 mpa the boundary condition of matrix medium is shown in fig 2 c where the left boundary pressure is 1 0 mpa and no flow conditions are imposed at the other matrix boundaries the initial water saturations both in the matrix and the fracture are set as 0 3 fig 7 shows the variation of the total phase transfer flux and the average water saturation in the fracture with time fig 8 shows the matrix saturation field calculated from the three models at t 8 64 104 s table 4 shows the computational costs of each employed method the simulation results confirm the accuracy of the proposed method 5 2 example 2 in the second example a horizontal fracture with 0 6 m long and 2 5 mm wide is embedded in the middle of the rectangular matrix of 1 m 0 5 m as shown in fig 9 a the pressure is set as 2 0 mpa and 1 0 mpa at the left and right boundaries respectively no flow conditions are imposed at the upper and lower boundaries the reservoir is initially fully oil saturated and water is injected from the left boundary other parameters are the same as in example 1 the meshing for the reference model and the dfm is shown in fig 9 b and c similar to example 1 fig 10 shows the variation of the calculated average saturation in the fracture with time fig 11 shows the calculated water saturation distribution in the matrix at t 2 5 105s the traditional dfm still greatly underestimates the water phase saturation in the fracture since the m f interface transfer flux cannot be calculated accurately under the coarse grids when the pressure and saturation vary sharply near the m f interface in contrast in the proposed dfm the m f interface transfer flux can be calculated accurately and the saturation field is consistent with the reference one 5 3 example 3 in this example we perform the field scale simulation for two phase flow as shown in fig 12 a the simulation domain is a 100 m 100 m square reservoir with two fractures embedded in the size of one fracture is 30 m 1 cm and the other one is 60m 1cm the permeability in matrix and in fracture are set as km 1md and kf 103d respectively other relevant parameters are the same as in table 1 two injection wells and two production wells locate at the four corners of the domain the initial water saturation is 0 01 all over the field the water injection rate for each injection well is 1 m2 day the meshing schemes in the dfm and in the single porosity model are shown in fig 12 b and c respectively both in the traditional dfm and the proposed dfm 40 40 cells are used to calculate the flow in matrix in the single porosity model each cell in the fracture or adjacent to the fracture is refined to 10 cells in the direction perpendicular to the fracture with equi dimensional discretization the solution under these refined cells can be seemed as the reference one the calculated water saturation distributions in the matrix from the three methods are compared in fig 13 the results of the proposed dfm are consistent with the reference one while the traditional dfm cannot provide the accurate results near the fracture in fig 14 the water cut curves of the production wells are plotted for all the three models it can be observed that the traditional dfm underestimates the water cut and predicts a later water breakthrough time while the proposed method can provide the calculation results as accurately as the reference one 6 conclusion and discussion discrete fracture models are widely applied in simulating fluid flow in matrix fracture coupled system due to the strong capillary pressure contrast in matrix and in fracture there are complex flow characteristics at the matrix fracture interface and the physical quantities may change rapidly near the m f interface this phenomenon has an important impact on the non wetting phase or gas production in low permeability reservoirs where conductive fractures play a significant role the traditional dfm encountered great challenges in calculating the matrix fracture transfer flux brenner et al 2018 monteagudo and firoozabadi 2004 monteagudo and firoozabadi 2007 since the capillary pressure in fracture is usually much smaller than the capillary pressure in matrix the case with negligible capillary pressure in fracture is investigated in this article it is also assumed that the transient effect can be neglected near the matrix fracture interface in our study case the mathematical analysis is then performed and it shows that there are three flow patterns near the m f interface both two phase fluids flowing from matrix to fracture only non wetting phase flowing from matrix to fracture and both two phase fluids flowing from fracture to matrix conclusions can be summarized as follows 1 when the pressure difference between matrix and fracture can overcome the capillary end effect both two phase fluids will flow from matrix to fracture and wetting phase saturation rapidly rises to 1 at the matrix side of interface which causes the divergences of non wetting phase pressure gradient and phase saturation gradients for this case if the traditional discrete methods are employed the computational grids need to be refined dramatically to provide an accurate result in the proposed model the m f transfer flow rate is calculated based upon the analytical solution which overcomes the problem of the pressure and saturation gradient divergences at the interface so accurate calculation results can be obtained even without mesh subdivision 2 when matrix pressure is higher than fracture pressure but the pressure difference cannot overcome the capillary end effect the calculated wetting phase velocity in the traditional numerical scheme may be unbounded li and tchelepi 2015 the mathematical analysis in this article indicates that the m f transfer flow rate of the wetting phase can be ignored so the proposed model automatically avoids this problem 3 when fracture pressure is higher than matrix pressure both two phase fluids will flow from fracture to matrix it is found that the ratio of the wetting phase velocity to non wetting phase velocity at the m f interface is equal to the ratio of the wetting phase mobility to the non wetting phase mobility in fracture with the use of this interface condition the m f transfer flow rate ding et al 2016 wang et al 2006 can be calculated accurately in recent years we have developed a novel method based on local analytical solutions to deal with the pressure gradient divergence problem in the medium with the heterogeneous permeability distribution liu and wang 2013 wang et al 2014 zheng et al 2017 following this idea we propose an alternative numerical method for calculating the m f transfer flow rate based on the analytical solution this is the main objective of this article since the approximate analytical solution is employed in the proposed dfm it can describe the flow characteristics near the matrix fracture interface better and calculate the m f transfer flow rate more accurately the numerical results show that the traditional dfm underestimates the wetting phase saturation in fracture which leads to underestimated water cut however the proposed dfm is much more accurate and its results are consistent with the reference one it needs to be mentioned that the proposed algorithm is based on the assumption of steady flow near the matrix fracture interface in practical the time variation of phase saturation is important only when the saturation frontier reaches the matrix fracture interface or when imbibition takes place between matrix and fracture our proposed algorithm focuses on the field scale flow in the area with sparsely distributed conductive fractures the pressure difference imposed on outer boundary is the only reason that causes the flow since the interfaces distribute sparsely in space and the time that the frontiers stay at the interfaces is short the cumulative effect of the frontier is not obvious during the whole process of water flooding on the other hand the counter current imbibition effect is a typical interface phenomenon where the non wetting phase fluid and wetting phase fluid flow in opposite direction it is almost not affected by the outer boundary condition when fractures distribute sparsely in the simulation area the cumulative effect of imbibition is limited and can also be neglected based upon the reasons above the assumption of steady flow near the matrix fracture interface is suitable for the cases studied in this paper if the transient effect is too significant to be neglected for instance in the dual porosity media with well connected fractures it needs more care when applying the proposed algorithm the proposed algorithm can also be extended to simulate the system with the fractures having arbitrary directions though we only consider the case where the fracture direction is parallel to the mesh line in this article another important problem for the practical applications is to extend the proposed method to the 3d case when fractures described as 2d planes in 3d space are orthogonal to mesh surface the 3d problem could be simplified to a quasi 2d one thus for this case the proposed algorithm in this article can be extended directly for more general cases it is necessary to reconstruct a grid system including the fractures with arbitrary directions which makes the problem much more complicated in principle the proposed algorithm can be applied to a general 3d case but the implementation will be very complicated the relevant issue is under research credit authorship contribution statement xiao hong wang conceptualization methodology supervision lu li methodology investigation data curation writing original draft min wang data curation validation zhi feng liu investigation writing original draft an feng shi validation acknowledgment this work is supported by the national natural science foundation of china no 11572315 appendix matrix fracture interface conditions for determining the m f transfer flow rate the main purpose of this appendix is to present the interface conditions required for the coupling of matrix and fracture in the dfm in low permeability reservoirs the capillary end effect has a significant effect on the flow near the m f interface this article focuses on the influence of the difference of capillary pressure curves in matrix and fracture upon the m f transfer flow rate for the sake of simplicity we consider the case with negligible capillary pressure in fracture since it is usually much smaller than the capillary pressure in matrix the flow in normal direction across m f interface is investigated which can be seemed as one dimensional steady state flow as mentioned in the main text the flow is assumed to be steady under these assumptions three flow patterns can be distinguished and their respective m f interface conditions are derived the analyses will be present in the following as shown in fig a 1 we set the m f interface as the coordinate origin and the direction from matrix to fracture as the positive direction the governing equations of the one dimensional two phase steady flow are a 1 q w k β λ w β a i j d p β d x d p c β d x c o n s t w a 2 q n k β λ n β a i j d p β d x c o n s t n where β m or f represents quantities in matrix or in fracture p and p c β represent the non wetting phase pressure and capillary pressure respectively λ w β and λ n β represent the relative wetting phase and non wetting phase mobilities respectively the relative mobilities and capillary pressure satisfy the following relations a 3 d λ w β d s 0 d λ n β d s 0 λ w β 0 0 λ n β 1 0 a 4 d p c β d s 0 p c β 1 0 p c β 0 furthermore the capillary pressure also satisfies the following constraint to avoid unphysical results brenner et al 2013 hamon et al 2018 li and tchelepi 2015 cancès 2009 wang and tchelepi 2013 a 5 lim s 0 λ w β λ n β λ w β λ n β d p c β d s 0 and lim s 1 λ w β λ n β λ w β λ n β d p c β d s 0 since the capillary pressure in fracture is usually far less than the capillary pressure in matrix we consider the case of negligible capillary pressure in fracture we assume that the capillary pressure curve in fracture is a 6 p c f ε p c m and then let ε 0 according to the capillary pressure continuity condition at the m f interface we have a 7 lim ε 0 s γ m 1 if lim ε 0 s γ f 0 and a 8 lim ε 0 s γ f 0 if lim ε 0 s γ m 1 the relation a 7 holds because that if lim ε 0 s γ f 0 the capillary pressure at fracture side interface is zero when ε 0 according to the capillary pressure continuity condition the capillary pressure at matrix side interface will also be zero considering the condition p c β 1 0 in a 4 then we have lim ε 0 s γ m 1 the relation a 8 holds because that if lim ε 0 s γ m 1 the capillary pressure at matrix side interface is above zero whenε 0 according to the capillary pressure continuity condition p c m s γ m p c f s γ f the condition p c β 0 and the relation a 6 p c f ε p c m it can be obtained that lim ε 0 s γ f 0 combining eqs a 1 and a 2 one has a 9 d p c β d s k β λ w β λ n β a i j q n λ w β q w λ n β d s d x β m or f integrating a 9 from any position in the fracture to x dji one can obtain a 10 s x s j d p c f d s k f λ w f λ n f a i j q n λ w f q w λ n f d s d j i x from a 5 it can be obtained easily that a 11 lim ε 0 d p c f d s λ w f λ n f 0 s 0 1 as a corollary of a 11 we have a 12 lim ε 0 s a s b d p c f d s λ w f λ n f d s 0 s a s b 0 1 denote δp p si p sj and δ p c p c m s i p c f s j three flow patterns can be distinguished according to the relationship between the pressure difference δp and the capillary pressure difference δpc a 1 both two phase fluids flow from matrix into fracture δp δpc 0 from eqs a 1 and a 2 under the condition δp δpc 0 one can obtain qw 0 and qn 0 if lim ε 0 s γ f 0 from eqs a 1 and a 2 we have lim ε 0 d p c f d x x 0 lim ε 0 q n a i j k f λ n f s γ f q w a i j k f λ w f s γ f and lim ε 0 d s d x x 0 0 these two results are contradictory since d p c f d s 0 therefore it can be concluded that lim ε 0 s γ f 0 according to a 7 one can obtain a 13 lim ε 0 s γ m 1 the relation a 13 is well known as capillary end effect considering lim ε 0 k r n s γ m 0 it can be concluded that lim ε 0 d s d x x 0 it indicates that the saturation near the matrix side interface changes sharply a 2 only non wetting phase flow from matrix into fracture 0 δp δpc from eqs a 1 and a 2 under the condition 0 δp δpc one can obtain qw 0 and qn 0 furthermore we will prove a 14 lim ε 0 q w 0 proof since qw 0 and qn 0 from a 9 we have d s d x x 0 0 considering the fact that the wetting phase and non wetting phase mobility are respectively the increasing and decreasing functions we have a 15 k f d j i x 1 s x s j d p c f d s λ w f λ n f a i j q n λ w f q w λ n f d s q n λ w f s x q w λ n f s j s x s j d p c f d s λ w f λ n f a i j d s 0 x 0 so a 16 k f d j i x s x s j d p c f d s λ w f λ n f a i j d s q n λ w f s x q w λ n f s j 0 x 0 according to a 12 we have lim ε 0 k f d j i x s x s j d p c f d s λ w f λ n f a i j d s 0 so a 17 lim ε 0 q n λ w f s x q w λ n f s j 0 since qn 0 and lim ε 0 q n λ w f s x 0 one can obtain lim ε 0 λ w f s x 0 it implies lim ε 0 q w 0 end proof as a by product we also have a 18 s x 0 when x 0 d j i the relation a 18 is easy to be understood since water can t flow from matrix into fracture there will be no water in fracture under steady state a 3 both two phase fluids flow from fracture into matrix δp 0 under this condition from eqs a1 and a2 we have qw 0 and qn 0 that is both non wetting phase and wetting phase flow from fracture into matrix if lim ε 0 s γ m 1 then lim ε 0 d p c m d x x 0 q n a i j k m λ n m s γ m q w a i j k m λ w m s γ m which implies d s d x x 0 0 it contradicts with the fact that non wetting phase saturation is non negative thus according to a 8 it can be obtained a 19 lim ε 0 s γ f 0 then q n λ w f s x q w λ n f s x q n λ w f s j q w λ n f s j if s x sj and q n λ w f s x q w λ n f s x q n λ w f s j q w λ n f s j if s x sj so for either s x sj or s x sj it can be obtained a 20 k f d j i x 1 s x s j d p c f d s λ w f λ n f a i j q n λ w f q w λ n f d s q n λ w f s j q w λ n f s j s x s j d p c f d s k f λ w f λ n f a i j d s 0 that is a 21 k f d j i x s x s j d p c f d s λ w f λ n f a i j d s q n λ w f s j q w λ n f s j 0 utilizing the relation a 12 one can obtain lim ε 0 q n λ w f s j q w λ n f s j 0 so a 22 lim ε 0 q w q n λ w f s j λ n f s j therefore when the pressure in fracture is higher than that in matrix both two phase fluids will flow from fracture into matrix and the phase velocity ratio is equal to the phase mobility ratio in fracture in summary there are three kinds of m f interface conditions corresponding to the three flow patterns for the steady flow with negligible capillary pressure in fracture ① when the pressure difference between matrix and fracture can overcome the capillary end effect the two phase fluids will both flow from matrix to fracture and the wetting phase saturation at matrix side interface is 1 a 23 s γ m 1 ② when the non wetting phase pressure in matrix is higher than in fracture but the pressure difference between cannot overcome the capillary pressure effect only the non wetting phase will flow from matrix to fracture and the wetting phase transfer flux rate is 0 a 24 q w 0 ③ when the non wetting phase pressure in matrix is lower than in fracture both the two phase fluids will flow from fracture to matrix and the phase velocity ratio is just the relative mobility ratio in the fracture a 25 q w q n λ w f s j λ n f s j 
445,the discrete fracture model dfm has been widely used to describe the flow problems in fractured media in low permeability media with conductive fractures embedded in there is large capillary pressure contrast between fracture and matrix it may cause very sharp changes of physical quantities near the matrix fracture interface which makes it difficult to calculate the matrix fracture transfer flux accurately in the traditional dfm in this article mathematical analysis for the flow characteristics near the matrix fracture interface is present three flow patterns can be distinguished for the two phase steady flow across the matrix fracture interface under the assumption of negligible capillary pressure in fracture the analytical solutions for the three different patterns are derived and then employed to construct an alternative numerical scheme of calculating matrix fracture transfer flow rate numerical examples show that the calculated results of the proposed model are in agreement with the reference solution it indicates that the proposed model can overcome the difficulty of accurately predicting the matrix fracture transfer flux in the traditional numerical scheme and then dramatically improve the computational accuracy for the two phase flow in low permeability reservoirs with conductive fractures keywords low permeability fractured porous media two phase flow discrete fracture model capillary end effect 1 introduction fractures are present in many subsurface systems and can strongly influence and even dominate fluid flow and transport behavior for example artificial fracturing technique has become an important measure for stimulation in low permeability reservoirs daneshy 1978 warpinski 1991 in hydrological applications involving low permeability formations fractures provide the most plausible pathways to the biosphere for nuclear waste buried at depth painter and cvetkovic 2005 maryška et al 2005 for karst geology the presence of fractures affects the flow paths in the medium and should be accurately accounted for in the numerical models bauer et al 2003 huang et al 2013 popov et al 2009 romanov et al 2002 when designing enhanced geothermal systems it is also necessary to understand the response of fractures to the coupled hydrological processes as it contributes to the occurrence of seismicity ghassemi and zhou 2011 shaik et al 2011 the ability to model and simulate the multiphase dynamics in fractured system is of utmost importance to the development of co2 storage which can be combined with enhanced oil recovery in fractured reservoirs ahmed and li 2019 march et al 2018 nooraiepour et al 2017 in order to accurately predict the fluid flow behaviors in these kinds of fractured media it is necessary to develop a highly efficient numerical simulation method for this matrix fracture coupled system the dual porosity model barenblatt and zheltov 1960 warren and root 1963 kazemi et al 1976 lim and aziz 1995 noetinger and estebenet 2000 has been widely used for the reservoir with well developed fracture system however this model is not suitable to describe large scale conductive fractures shahraeeni et al 2015 cordero et al 2019 abbasi et al 2018 the single porosity model is employed by early scholars to simulate conductive fractures in which very fine grids are required to calculate the flow in matrix fracture coupled system therefore it is difficult to be applied in engineering due to its high demand for computing power to improve the efficiency the discrete fracture model dfm bogdanov et al 2003 kim and deo 1999 reichenberger et al 2006 tunc et al 2012 sandve et al 2012 fumagalli and keilegavlen 2019 nœtinger 2015 flemisch et al 2018 is then developed in recent years in which fractures are modeled as interfaces of co dimension one the dfm was initially introduced by noorishad and baca et al baca et al 1984 noorishad and mehran 1982 to simulate single phase flow slough and karimi fard et al slough et al 1999 slough et al 1999 karimi fard et al 2003 extended the dfm to multiphase flow simulation different from the original dfm for single phase flow the discrete variables including pressure and saturation are defined respectively for fracture and matrix fracture and matrix are coupled through the transfer term between them thus calculating the transfer term accurately is very important and has been investigated for a long time karimi fard et al karimi fard et al 2003 suggested that the interface mobility should take its value from upstream when calculating the matrix fracture m f transfer flux but this method is hard to describe the saturation jump across the interface brenner et al 2018 monteagudo et al monteagudo and firoozabadi 2004 monteagudo and firoozabadi 2007 assumed that each phase pressure in fracture was equal to its value at the interface and phase saturations in matrix and fracture were calculated with the help of continuity condition of the capillary pressure this assumption is not suitable for the cases where the fracture is filled with non wetting phase brenner et al 2018 or the fracture capillary pressure is zero hoteit and firoozabadi 2008 brenner et al brenner et al 2018 aghili et al 2019 brenner et al 2013 brenner et al 2016 brenner et al 2016 proposed the linear and nonlinear transmission conditions to simulate the flow in fractures acting either as barriers or drains in the case of the fractures acting as drains their model provides basically the same solutions as the ones obtained by the continuous pressure model proposed by monteagudo et al for different types of rock the capillary pressure curves are different which will have a serious impact on reservoir numerical simulation ding et al 2016 wang et al 2006 in the core experiment the capillary pressure exists in the core while it can be ignored outside the core the capillary pressure discontinuity at the outlet of core may occur and the capillary end effect arises this effect creates wetting phase layer near the outlet with residual non wetting phase saturation which enhances the hydraulic resistance for non wetting phase flow and is known as water blocking assuming that water phase saturation is 1 at the outlet end of the water wet core a saturation distribution equation near the outlet end was established hadley g and handy l 1956 then the way to correct the errors in the relative permeability measurements considering the capillary end effect has been proposed huang and honarpour 1998 virnovsky et al 1995 in the recent based on the analytical equations of one dimensional radial flow considering the capillary end effect an alternative numerical well model for low permeability gas reservoir is constructed which can predict the gas and water productions accurately at different grid scales yao et al 2019 there is strong capillary pressure contrast between matrix and fracture in low permeability reservoirs which results in complex flow conditions at the matrix fracture interface and creates difficulty in calculation of the m f transfer flux according to our analysis there are three flow patterns for the two phase flow across the matrix fracture interface the first both two phase fluids flow from matrix to fracture the second only non wetting phase flow from matrix to fracture the last both two phases flow from fracture to matrix in the first flow pattern the pressure difference between matrix and fracture can overcome the capillary end effect the wetting phase saturation at the matrix fracture interface remains 1 due to the continuity condition of the capillary pressure which results in the divergence of the non wetting phase pressure gradient in the second flow pattern the pressure difference between matrix and fracture cannot overcome the capillary end effect so only the non wetting phase can flow across the matrix fracture interface in the third flow pattern the pressure in matrix is less than that in fracture so both two phase fluids can flow from fracture to matrix the two phase flow characters in the neighborhood of the matrix fracture interface are analyzed in this article based upon the analytical solution of one dimensional two phase steady flow near the interface in matrix a novel algorithm of calculating the transfer flow rate is established the proposed algorithm can eliminate the uncontrollable numerical dissipation in the traditional method caused by the divergence of pressure and saturation gradient and therefore it can provide more accurate results even without refining the meshes numerical examples are performed to test the accuracy and efficiency of the proposed numerical scheme it is shown that the proposed scheme in coarse grids can provide accurate solutions this article is organized as follows the mathematical model is present in section 2 and the traditional discrete model is introduced in section 3 respectively the proposed algorithm for calculating the matrix fracture transfer flow rate is proposed in section 4 in section 5 numerical examples are provided to illustrate the accuracy and efficiency of the proposed numerical scheme conclusions are drawn in section 6 2 mathematical model in this article we consider incompressible two phase wetting phase and non wetting phase flow in the 2d matrix fracture coupled system in single porosity model the mass conservation equation of α phase α n represents non wetting phase and α w represents wetting phase both in matrix and fracture can be written as 1 ϕ β s α β t u α β 0 β m or f where the subscript β m or f represents the variables in matrix or in fracture respectively ϕ s α and u α are porosity phase saturation and velocity respectively in dfm matrix zone and fracture zone are distinguished strictly fractures are embedded in matrix and both sides of fracture can be seemed as the boundary of matrix in 2d system fractures in dfm are seemed as one dimensional since their lengths are much larger than their widths therefore for matrix the calculated matrix fracture transfer flow rate acts as matrix boundary condition but for fracture the transfer flow rate is treated as a source term thus the mass conservation equation in fracture can be written as 2 ϕ f s α f t u α f x f q α f the source term q α f represents the transfer flow rate between matrix and fracture it can be calculated by 3 q α f u α m 1 n 1 u α m 2 n 2 d f where n is unit external normal vector of m f interface the superscripts 1 and 2 represent the two sides of fracture respectively df is the width of fracture in dfm the mass conservation equation in matrix can be still written by eq 1 with β m according to the generalized darcy s law the multi phase velocity in fracture and matrix of dfm can be described by the following equations 4 u α f k f λ α f p α f x f 5 u α m k m λ α m p α m where p α is the α phase pressure k is absolute permeability and λα k rα μα is α phase relative mobility defined as the ratio of relative permeability to viscosity the saturation satisfies the following constraint 6 s w β s n β 1 β m or f and phase pressures satisfy the following capillary pressure relationship 7 p c β s w p n β p w β this article will discuss the calculation of the transfer flow rate q α f when performing numerical simulation 3 traditional discrete model the cell centered finite volume scheme with two point flux approximation is employed in single porosity model and dfm details of this numerical scheme can be found in tunc et al 2012 karimi fard et al 2003 hamon et al 2018 hægland et al 2009 the simulation domain is discretized into n control volumes use the symbol i and j to represent the relevant control volumes and the symbol ωβ β m or f to represent the set of all control volumes in the matrix or fracture medium choose non wetting phase pressure pn and wetting phase saturation sw as the primary variables the discrete equation of the control volume i can be written as 8 ϕ i β δ v i s α i n 1 s α i n δ t j a d j i ω β f α i j β j a d j i j ω β q α i j m f 0 i ω β where s α i represents the α phase saturation of the control volume i δvi is the measure of control volume i adj i is the set of neighbors of control volume of i f α i j β is the α phase numerical volumetric flow rate across the interface γ ij between the two control volumes i and j belonging to the same medium ωβ q α i j m f is the corresponding numerical volumetric flow rate across the interface γ ij where the two control volumes i and j belonging to the different media ωβ one belonging matrix and the other belonging to fracture this discrete equation can be applied to both single porosity model and dfm the fluxes f α i j β and q α i j m f can both be expressed as the functions of the two adjacent discrete pressure difference δp α ij p α i p α j the discrete wetting phase saturation s w i and s w j for the flux f α i j β inside the same medium β m or f the following traditional algorithm is adopted 9 f α i j β k β λ α i j u p δ p α i j d i j d j i a i j where dij and dji represent the distances from the discrete pressure points p α i and p α j to the interface γ ij respectively λ n i j u p is the non wetting phase mobility of upstream grid and aij is the measure of γ ij for the matrix fracture transfer flow rate q α i j m f the traditional method uses a similar algorithm as 9 assuming i ω m and j ω f since dji dij the phase transfer flow rate is directly calculated by 10 q α i j m f k m λ α i j u p δ p α i j d i j a i j however in low permeability reservoirs due to the large contrast between the capillary pressures in matrix and fracture physical quantities may change rapidly near the matrix fracture interface thus the algorithm 10 of calculating q α i j m f in the traditional discrete method cannot calculate the m f transfer flow rate accurately an alternative numerical scheme will be proposed in this article to replace 10 for calculating the m f transfer flux rate the proposed numerical scheme is based upon the analysis of the flow characteristics near the m f interface the specifics of this method will be introduced in the next section 4 modified discrete model in this section we will propose an alternative algorithm of calculating the m f transfer flow rate based upon the one dimensional steady state analytical solution near the m f interface considering the fact that the capillary pressure in fracture is usually much smaller than that in matrix we investigate an ideal model with negligible capillary pressure in fracture for the sake of simplicity we define s as the normalized wetting phase saturation 11 s 1 s w c 1 s w c s n r where snr is the residual non wetting phase saturation and swc is the irreducible wetting phase saturation for the two adjacent control volume i and j suppose i ω m and j ω f the discrete non wetting phase pressures of the grid cells i and j are denoted as pi and pj respectively see fig a 1 in appendix the non wetting phase pressure difference and the capillary pressure difference of these two adjacent grids are denoted as δp pi pj and δ p c p c m s i p c f s j respectively because the capillary pressure curves in matrix and fracture are different there are two saturations at the m f interface γ ij s γ m at the matrix side and s γ f at the fracture side in this article the analytical solution for the one dimensional steady flow is utilized to calculate the m f transfer flow rate this steady flow assumption is suitable for the case where the transient effect is not significant near the m f interface under the steady flow assumption the transfer flow rates of wetting and non wetting phase are given by 12 q w i j k m λ w m d p d x d p c m d x a i j 13 q n i j k m λ n m d p d x a i j where q denotes the volume flow rate x denotes the normal direction perpendicular to m f interface aij is the measure of the interface γ ij dividing the eq 13 by the eq 12 we have 14 d p λ w m d p c m d s λ w m λ n m θ d s where θ q w ij q n ij represents the ratio of wetting phase transfer flow rate to non wetting phase transfer flow rate substituting the relation 14 into the eq 13 we can obtain 15 q n i j d x d p c m d s k m λ w m λ n m a i j λ w m θ λ n m d s according to the size relationship between the pressure difference δp and the capillary pressure difference δpc on the adjacent matrix and fracture cells in appendix it is shown that three patterns crossing the m f interface can be distinguished under the following assumptions ① the flow across the interface is assumed to be steady ② the capillary pressure curves satisfy p c β 0 and p c β 1 0 β m or f ③ under a given value of the normalized wetting phase saturation the capillary pressure in fracture is assumed to be negligible compared to that in matrix based upon the characteristics of these three flow patterns the transfer flow rates across the m f interface can be calculated respectively which is the core of the proposed numerical algorithm it is briefly introduced as follows a both two phase fluids flow from matrix into fracture δp δpc 0 notice that δpc is always above zero since the capillary pressure in fracture is assumed to be negligible when the non wetting phase pressure difference is bigger than the capillary pressure difference δp δpc 0 both two phases can flow from matrix to fracture in appendix we prove that s γ m 1 for this case under the condition of negligible capillary pressure in fracture see a 13 this phenomenon is known as capillary end effect caused by the strong capillary pressure contrast between matrix and fracture huang and honarpour 1998 virnovsky et al 1995 pø et al 2017 because the non wetting phase velocity is not zero while its saturation is zero at the m f interface the non wetting phase pressure gradient diverges at the interface integrating 14 and considering the interface condition s γ m 1 we have 16 δ p s i 1 λ w m d p c m d s λ w m λ n m θ d s in the eq 16 there is only one unknown variable the ratio of wetting and non wetting phase transfer flow rates q for the given curves of capillary pressure p c m and relative mobility λ α m after getting δp and si the value of θ can be calculated by using the newton raphson iteration method substituting the calculated θ and s γ m 1 into 15 the non wetting phase transfer flow rate across m f interface can be calculated directly by 17 q n i j k m a i j d i j s i 1 d p c m d s λ w m λ n m λ w m θ λ n m d s utilizing the definition of θ the wetting phase transfer flow rate across m f interface is 18 q w i j θ q n i j b only non wetting phase flow from the matrix to the fracture 0 δp δpc when the non wetting phase pressure difference is smaller than the capillary pressure difference 0 δp δpc only non wetting phase can flow from matrix to fracture in appendix we prove that q w ij 0 and θ 0 substituting this relation into 14 we have 19 d p d p c m d s d s integrating 19 we get 20 δ p p c m s i p c m s γ m utilizing the relation 20 the interface saturation s γ m at the matrix side can be calculated out substituting θ 0 and the calculated s γ m into 15 the non wetting phase transfer flow rate can be calculated directly by 21 q n i j k m a i j d i j s i s γ m d p c m d s λ n m d s c both two phase fluids flow from the fracture to the matrix δp 0 when the phase pressures in fracture are bigger than those in matrix δp 0 both two phases will flow from fracture to matrix in appendix it is shown that the ratio of the phase transfer flow rate is equal to the mobility ratio of the upstream i e the fracture side that is 22 θ λ w f s j λ n f s j integrating 14 we can obtain 23 δ p s i s γ m λ w m d p c m d s λ w m λ n m θ d s since the value of θ can be determined by the relation 22 there is only one unknown variable s γ m in the eq 23 which can be solved with the newton raphson iteration method then the non wetting phase transfer flow rate can be calculated directly by 24 q n i j k m a i j d i j s i s γ m d p c m d s λ w m λ n m λ w m θ λ n m d s utilizing the definition of the wetting phase transfer flow rate is 25 q w i j θ q n i j the relations 17 and 18 for the first case 20 and 21 for the second case 24 and 25 for the third case actually provide a new algorithm to calculate the phase transfer rate across the m f interface they can be used to replace the relation 10 in the traditional discrete model and by this approach we propose an alternative discrete fracture model due to the strong capillary pressure contrast between matrix and fracture there are three different flow patterns across the m f interface both two phases flowing from matrix to fracture only non wetting phase flowing from matrix to fracture and both two phases flowing from fracture to matrix the properties of the different flow patterns have the strong influence upon the calculations of the m f transfer flow rate it has already been known that the non wetting phase pressure gradient and the saturation gradient will diverge near the m f interface when both two phases flow from matrix to fracture huang and honarpour 1998 virnovsky et al 1995 pø et al 2017 actually the traditional model described by 10 coming from one kind of simple discretization of the generalized darcy s law 12 and 13 is based upon taylor expansion therefore in the traditional numerical scheme subdividing meshes sufficiently is inevitably required near the m f interface where the pressure and saturation gradients may diverge in this article the m f transfer flow rate is calculated based upon the local analytical solution near the m f interface which can naturally overcome the difficulties existing in the traditional numerical scheme 5 numerical examples in order to verify the proposed model several numerical tests are performed without the loss of generality the wetting and non wetting phase in these tests are supposed to be water and oil respectively the simulation results from the proposed dfm are compared with the traditional one as well as the reference solution where enough refined grids are used in single porosity model both in matrix and fracture numerical tests show that the proposed dfm is much more efficient than the traditional one and can provide accurate results even on coarse grids 5 1 example 1 as shown in fig 1 a a horizontal fracture with 0 5 m long and 2 5 mm wide is embedded in the rectangular region of 1 m 0 5 m the permeability in matrix and in fracture are set as km 1 md and kf 10 d respectively the right end of the fracture is just the outlet the capillary pressure in fracture is negligible the other relevant parameters values needed for accomplishing the numerical simulation are shown in table 1 the meshing of the three models the traditional dfm the proposed dfm and the single porosity model are shown in fig 1 b and c fig 1 b shows the meshing scheme for both the traditional dfm and the proposed dfm where the matrix is divided into nx ny cells and the fracture is treated as one dimensional and divided into nx 2 cells correspondingly in order to provide a reference solution the single porosity model is employed under enough refined cells both in matrix and fracture as shown in fig 1 c the cells in the fracture and adjacent to the fracture are enough refined to provide the reference solution in this example we first divide the whole domain into 20 40 cells and then each cell in the fracture or adjacent to the fracture is refined to 10 cells in the direction perpendicular to the fracture with equi dimensional discretization this solution is used as the reference one since no differences can be detected among the grid systems with nx ny 20 20 20 40 and 40 40 the transfer flow rate across m f interface in this single porosity model is calculated following the traditional approach the solution under these refined cells can be seemed as the reference one since no difference can be detected under more refinements the calculation under the grid refinement where each cell in the fracture or adjacent to the fracture is refined to 20 cells in the direction perpendicular to the fracture with equi dimensional discretization is also performed little difference can be observed between the calculated results under the refinements of 10 cells and 20 cells three different boundary conditions for matrix medium are assigned in order to test the accuracy of the proposed model under different flow patterns shown in fig 2 case 1 both two phase fluids flow from matrix into fracture the boundary condition of this case is shown in fig 2 a where the upper and lower boundary pressures are set as 1 2 mpa and no flow conditions are imposed at the left and right boundaries of the matrix the pressure at the right end of the fracture where is the outlet is set as 1 0 mpa the initial water saturation in the matrix is 0 5 and the initial water saturation in the fracture is 0 01 water is injected from the upper and lower boundaries and the two phase fluids will flow out only from the right end of the fracture fig 3 shows the variations of the total water and oil flux from the matrix to the fracture and the average water saturation in the fracture with time two grid systems for dfm are used to perform the simulation the coarse grid system with nx ny 20 20 and the fine grid system with nx ny 20 40 it can be seen that the proposed model provides consistent results with the reference one both in coarse and fine grids however the traditional dfm underestimates the water flux transferring from the matrix to the fracture see fig 3a and correspondingly it also underestimates the water saturation inside the fracture see fig 3c the calculated water saturation field in the matrix at t 8 64 104 s is presented in fig 4 using grid system 20 40 for dfm in the proposed numerical scheme after getting the m f flux the saturation field near the interface can be reconstructed according to the analytical solution by using the eq 15 i e the proposed dfm can provide the flow details near the m f interface fig 4b shows that the reconstructed field is coincident with the reference one this is one of the advantages of the proposed dfm it can be seen that the reconstructed field from the proposed dfm is consistent with the reference one see fig 4b and c in contrast the water saturation distribution near the m f interface cannot be fully described by the traditional dfm see fig 4a due to the divergence of the non wetting phase pressure gradient and saturation gradient near the m f interface the traditional dfm can converge to the reference solution only under sufficient subdivision but this problem is out of control since it is difficult to estimate the suitable grid size the comparison in the computational costs of each employed method is presented in table 2 it can be seen that the computational cost of the proposed method is close to the traditional dfm under the same grid size case 2 only oil phase flow from matrix into fracture in this case water is injected from the left boundary and both two phase fluids will flow out from the right end of the fracture the boundary condition of matrix medium is shown in fig 2 b where the left boundary pressure is 1 1 mpa and no flow conditions are imposed at the other three boundaries the outlet pressure at the right end of the fracture is 1 0 mpa both the initial water saturations in fracture and matrix are set as 0 2 fig 5 shows the variations of the total water and oil flux from the matrix to the fracture and the average water saturation in the fracture with time from fig 5 we can see that the water transfer flow rate is actually zero in this case while the traditional dfm provides incorrect calculation results where the water phase is predicted to flow from the fracture into the matrix correspondingly the oil transfer flow rate has been greatly overestimated by the traditional dfm see fig 5b as the consequence the traditional dfm underestimates the water saturation in the fracture in contrast the proposed dfm can capture the characteristics of fluid flows accurately and therefore provide the correct results in agreement to the reference one the accuracy of the proposed model is also indicated by the reconstructed saturation field as shown in fig 6 the comparison in the computational costs of each employed method for this case is presented in table 3 case 3 both two phase fluids flow from fracture into matrix in this case oil is injected into the fracture from the right boundary so that the fluids in the matrix are displaced and flow out from the open left boundary the pressure at the right end of the fracture which is the flow inlet is set as 1 1 mpa the boundary condition of matrix medium is shown in fig 2 c where the left boundary pressure is 1 0 mpa and no flow conditions are imposed at the other matrix boundaries the initial water saturations both in the matrix and the fracture are set as 0 3 fig 7 shows the variation of the total phase transfer flux and the average water saturation in the fracture with time fig 8 shows the matrix saturation field calculated from the three models at t 8 64 104 s table 4 shows the computational costs of each employed method the simulation results confirm the accuracy of the proposed method 5 2 example 2 in the second example a horizontal fracture with 0 6 m long and 2 5 mm wide is embedded in the middle of the rectangular matrix of 1 m 0 5 m as shown in fig 9 a the pressure is set as 2 0 mpa and 1 0 mpa at the left and right boundaries respectively no flow conditions are imposed at the upper and lower boundaries the reservoir is initially fully oil saturated and water is injected from the left boundary other parameters are the same as in example 1 the meshing for the reference model and the dfm is shown in fig 9 b and c similar to example 1 fig 10 shows the variation of the calculated average saturation in the fracture with time fig 11 shows the calculated water saturation distribution in the matrix at t 2 5 105s the traditional dfm still greatly underestimates the water phase saturation in the fracture since the m f interface transfer flux cannot be calculated accurately under the coarse grids when the pressure and saturation vary sharply near the m f interface in contrast in the proposed dfm the m f interface transfer flux can be calculated accurately and the saturation field is consistent with the reference one 5 3 example 3 in this example we perform the field scale simulation for two phase flow as shown in fig 12 a the simulation domain is a 100 m 100 m square reservoir with two fractures embedded in the size of one fracture is 30 m 1 cm and the other one is 60m 1cm the permeability in matrix and in fracture are set as km 1md and kf 103d respectively other relevant parameters are the same as in table 1 two injection wells and two production wells locate at the four corners of the domain the initial water saturation is 0 01 all over the field the water injection rate for each injection well is 1 m2 day the meshing schemes in the dfm and in the single porosity model are shown in fig 12 b and c respectively both in the traditional dfm and the proposed dfm 40 40 cells are used to calculate the flow in matrix in the single porosity model each cell in the fracture or adjacent to the fracture is refined to 10 cells in the direction perpendicular to the fracture with equi dimensional discretization the solution under these refined cells can be seemed as the reference one the calculated water saturation distributions in the matrix from the three methods are compared in fig 13 the results of the proposed dfm are consistent with the reference one while the traditional dfm cannot provide the accurate results near the fracture in fig 14 the water cut curves of the production wells are plotted for all the three models it can be observed that the traditional dfm underestimates the water cut and predicts a later water breakthrough time while the proposed method can provide the calculation results as accurately as the reference one 6 conclusion and discussion discrete fracture models are widely applied in simulating fluid flow in matrix fracture coupled system due to the strong capillary pressure contrast in matrix and in fracture there are complex flow characteristics at the matrix fracture interface and the physical quantities may change rapidly near the m f interface this phenomenon has an important impact on the non wetting phase or gas production in low permeability reservoirs where conductive fractures play a significant role the traditional dfm encountered great challenges in calculating the matrix fracture transfer flux brenner et al 2018 monteagudo and firoozabadi 2004 monteagudo and firoozabadi 2007 since the capillary pressure in fracture is usually much smaller than the capillary pressure in matrix the case with negligible capillary pressure in fracture is investigated in this article it is also assumed that the transient effect can be neglected near the matrix fracture interface in our study case the mathematical analysis is then performed and it shows that there are three flow patterns near the m f interface both two phase fluids flowing from matrix to fracture only non wetting phase flowing from matrix to fracture and both two phase fluids flowing from fracture to matrix conclusions can be summarized as follows 1 when the pressure difference between matrix and fracture can overcome the capillary end effect both two phase fluids will flow from matrix to fracture and wetting phase saturation rapidly rises to 1 at the matrix side of interface which causes the divergences of non wetting phase pressure gradient and phase saturation gradients for this case if the traditional discrete methods are employed the computational grids need to be refined dramatically to provide an accurate result in the proposed model the m f transfer flow rate is calculated based upon the analytical solution which overcomes the problem of the pressure and saturation gradient divergences at the interface so accurate calculation results can be obtained even without mesh subdivision 2 when matrix pressure is higher than fracture pressure but the pressure difference cannot overcome the capillary end effect the calculated wetting phase velocity in the traditional numerical scheme may be unbounded li and tchelepi 2015 the mathematical analysis in this article indicates that the m f transfer flow rate of the wetting phase can be ignored so the proposed model automatically avoids this problem 3 when fracture pressure is higher than matrix pressure both two phase fluids will flow from fracture to matrix it is found that the ratio of the wetting phase velocity to non wetting phase velocity at the m f interface is equal to the ratio of the wetting phase mobility to the non wetting phase mobility in fracture with the use of this interface condition the m f transfer flow rate ding et al 2016 wang et al 2006 can be calculated accurately in recent years we have developed a novel method based on local analytical solutions to deal with the pressure gradient divergence problem in the medium with the heterogeneous permeability distribution liu and wang 2013 wang et al 2014 zheng et al 2017 following this idea we propose an alternative numerical method for calculating the m f transfer flow rate based on the analytical solution this is the main objective of this article since the approximate analytical solution is employed in the proposed dfm it can describe the flow characteristics near the matrix fracture interface better and calculate the m f transfer flow rate more accurately the numerical results show that the traditional dfm underestimates the wetting phase saturation in fracture which leads to underestimated water cut however the proposed dfm is much more accurate and its results are consistent with the reference one it needs to be mentioned that the proposed algorithm is based on the assumption of steady flow near the matrix fracture interface in practical the time variation of phase saturation is important only when the saturation frontier reaches the matrix fracture interface or when imbibition takes place between matrix and fracture our proposed algorithm focuses on the field scale flow in the area with sparsely distributed conductive fractures the pressure difference imposed on outer boundary is the only reason that causes the flow since the interfaces distribute sparsely in space and the time that the frontiers stay at the interfaces is short the cumulative effect of the frontier is not obvious during the whole process of water flooding on the other hand the counter current imbibition effect is a typical interface phenomenon where the non wetting phase fluid and wetting phase fluid flow in opposite direction it is almost not affected by the outer boundary condition when fractures distribute sparsely in the simulation area the cumulative effect of imbibition is limited and can also be neglected based upon the reasons above the assumption of steady flow near the matrix fracture interface is suitable for the cases studied in this paper if the transient effect is too significant to be neglected for instance in the dual porosity media with well connected fractures it needs more care when applying the proposed algorithm the proposed algorithm can also be extended to simulate the system with the fractures having arbitrary directions though we only consider the case where the fracture direction is parallel to the mesh line in this article another important problem for the practical applications is to extend the proposed method to the 3d case when fractures described as 2d planes in 3d space are orthogonal to mesh surface the 3d problem could be simplified to a quasi 2d one thus for this case the proposed algorithm in this article can be extended directly for more general cases it is necessary to reconstruct a grid system including the fractures with arbitrary directions which makes the problem much more complicated in principle the proposed algorithm can be applied to a general 3d case but the implementation will be very complicated the relevant issue is under research credit authorship contribution statement xiao hong wang conceptualization methodology supervision lu li methodology investigation data curation writing original draft min wang data curation validation zhi feng liu investigation writing original draft an feng shi validation acknowledgment this work is supported by the national natural science foundation of china no 11572315 appendix matrix fracture interface conditions for determining the m f transfer flow rate the main purpose of this appendix is to present the interface conditions required for the coupling of matrix and fracture in the dfm in low permeability reservoirs the capillary end effect has a significant effect on the flow near the m f interface this article focuses on the influence of the difference of capillary pressure curves in matrix and fracture upon the m f transfer flow rate for the sake of simplicity we consider the case with negligible capillary pressure in fracture since it is usually much smaller than the capillary pressure in matrix the flow in normal direction across m f interface is investigated which can be seemed as one dimensional steady state flow as mentioned in the main text the flow is assumed to be steady under these assumptions three flow patterns can be distinguished and their respective m f interface conditions are derived the analyses will be present in the following as shown in fig a 1 we set the m f interface as the coordinate origin and the direction from matrix to fracture as the positive direction the governing equations of the one dimensional two phase steady flow are a 1 q w k β λ w β a i j d p β d x d p c β d x c o n s t w a 2 q n k β λ n β a i j d p β d x c o n s t n where β m or f represents quantities in matrix or in fracture p and p c β represent the non wetting phase pressure and capillary pressure respectively λ w β and λ n β represent the relative wetting phase and non wetting phase mobilities respectively the relative mobilities and capillary pressure satisfy the following relations a 3 d λ w β d s 0 d λ n β d s 0 λ w β 0 0 λ n β 1 0 a 4 d p c β d s 0 p c β 1 0 p c β 0 furthermore the capillary pressure also satisfies the following constraint to avoid unphysical results brenner et al 2013 hamon et al 2018 li and tchelepi 2015 cancès 2009 wang and tchelepi 2013 a 5 lim s 0 λ w β λ n β λ w β λ n β d p c β d s 0 and lim s 1 λ w β λ n β λ w β λ n β d p c β d s 0 since the capillary pressure in fracture is usually far less than the capillary pressure in matrix we consider the case of negligible capillary pressure in fracture we assume that the capillary pressure curve in fracture is a 6 p c f ε p c m and then let ε 0 according to the capillary pressure continuity condition at the m f interface we have a 7 lim ε 0 s γ m 1 if lim ε 0 s γ f 0 and a 8 lim ε 0 s γ f 0 if lim ε 0 s γ m 1 the relation a 7 holds because that if lim ε 0 s γ f 0 the capillary pressure at fracture side interface is zero when ε 0 according to the capillary pressure continuity condition the capillary pressure at matrix side interface will also be zero considering the condition p c β 1 0 in a 4 then we have lim ε 0 s γ m 1 the relation a 8 holds because that if lim ε 0 s γ m 1 the capillary pressure at matrix side interface is above zero whenε 0 according to the capillary pressure continuity condition p c m s γ m p c f s γ f the condition p c β 0 and the relation a 6 p c f ε p c m it can be obtained that lim ε 0 s γ f 0 combining eqs a 1 and a 2 one has a 9 d p c β d s k β λ w β λ n β a i j q n λ w β q w λ n β d s d x β m or f integrating a 9 from any position in the fracture to x dji one can obtain a 10 s x s j d p c f d s k f λ w f λ n f a i j q n λ w f q w λ n f d s d j i x from a 5 it can be obtained easily that a 11 lim ε 0 d p c f d s λ w f λ n f 0 s 0 1 as a corollary of a 11 we have a 12 lim ε 0 s a s b d p c f d s λ w f λ n f d s 0 s a s b 0 1 denote δp p si p sj and δ p c p c m s i p c f s j three flow patterns can be distinguished according to the relationship between the pressure difference δp and the capillary pressure difference δpc a 1 both two phase fluids flow from matrix into fracture δp δpc 0 from eqs a 1 and a 2 under the condition δp δpc 0 one can obtain qw 0 and qn 0 if lim ε 0 s γ f 0 from eqs a 1 and a 2 we have lim ε 0 d p c f d x x 0 lim ε 0 q n a i j k f λ n f s γ f q w a i j k f λ w f s γ f and lim ε 0 d s d x x 0 0 these two results are contradictory since d p c f d s 0 therefore it can be concluded that lim ε 0 s γ f 0 according to a 7 one can obtain a 13 lim ε 0 s γ m 1 the relation a 13 is well known as capillary end effect considering lim ε 0 k r n s γ m 0 it can be concluded that lim ε 0 d s d x x 0 it indicates that the saturation near the matrix side interface changes sharply a 2 only non wetting phase flow from matrix into fracture 0 δp δpc from eqs a 1 and a 2 under the condition 0 δp δpc one can obtain qw 0 and qn 0 furthermore we will prove a 14 lim ε 0 q w 0 proof since qw 0 and qn 0 from a 9 we have d s d x x 0 0 considering the fact that the wetting phase and non wetting phase mobility are respectively the increasing and decreasing functions we have a 15 k f d j i x 1 s x s j d p c f d s λ w f λ n f a i j q n λ w f q w λ n f d s q n λ w f s x q w λ n f s j s x s j d p c f d s λ w f λ n f a i j d s 0 x 0 so a 16 k f d j i x s x s j d p c f d s λ w f λ n f a i j d s q n λ w f s x q w λ n f s j 0 x 0 according to a 12 we have lim ε 0 k f d j i x s x s j d p c f d s λ w f λ n f a i j d s 0 so a 17 lim ε 0 q n λ w f s x q w λ n f s j 0 since qn 0 and lim ε 0 q n λ w f s x 0 one can obtain lim ε 0 λ w f s x 0 it implies lim ε 0 q w 0 end proof as a by product we also have a 18 s x 0 when x 0 d j i the relation a 18 is easy to be understood since water can t flow from matrix into fracture there will be no water in fracture under steady state a 3 both two phase fluids flow from fracture into matrix δp 0 under this condition from eqs a1 and a2 we have qw 0 and qn 0 that is both non wetting phase and wetting phase flow from fracture into matrix if lim ε 0 s γ m 1 then lim ε 0 d p c m d x x 0 q n a i j k m λ n m s γ m q w a i j k m λ w m s γ m which implies d s d x x 0 0 it contradicts with the fact that non wetting phase saturation is non negative thus according to a 8 it can be obtained a 19 lim ε 0 s γ f 0 then q n λ w f s x q w λ n f s x q n λ w f s j q w λ n f s j if s x sj and q n λ w f s x q w λ n f s x q n λ w f s j q w λ n f s j if s x sj so for either s x sj or s x sj it can be obtained a 20 k f d j i x 1 s x s j d p c f d s λ w f λ n f a i j q n λ w f q w λ n f d s q n λ w f s j q w λ n f s j s x s j d p c f d s k f λ w f λ n f a i j d s 0 that is a 21 k f d j i x s x s j d p c f d s λ w f λ n f a i j d s q n λ w f s j q w λ n f s j 0 utilizing the relation a 12 one can obtain lim ε 0 q n λ w f s j q w λ n f s j 0 so a 22 lim ε 0 q w q n λ w f s j λ n f s j therefore when the pressure in fracture is higher than that in matrix both two phase fluids will flow from fracture into matrix and the phase velocity ratio is equal to the phase mobility ratio in fracture in summary there are three kinds of m f interface conditions corresponding to the three flow patterns for the steady flow with negligible capillary pressure in fracture ① when the pressure difference between matrix and fracture can overcome the capillary end effect the two phase fluids will both flow from matrix to fracture and the wetting phase saturation at matrix side interface is 1 a 23 s γ m 1 ② when the non wetting phase pressure in matrix is higher than in fracture but the pressure difference between cannot overcome the capillary pressure effect only the non wetting phase will flow from matrix to fracture and the wetting phase transfer flux rate is 0 a 24 q w 0 ③ when the non wetting phase pressure in matrix is lower than in fracture both the two phase fluids will flow from fracture to matrix and the phase velocity ratio is just the relative mobility ratio in the fracture a 25 q w q n λ w f s j λ n f s j 
446,the effective conductivity of heterogeneous aquifers kefu relates the mean flux to the mean head gradient in mean uniform natural gradient flow while kefu depends on the hydraulic conductivity k statistical moments kg the geometric mean and σ y 2 the logconductivity variance for a given structure model it is not a local property for strongly nonuniform well flow in hydraulic tomography flow to a short well segment which is considered here can be approximated by that toward a source in a three dimensional heterogeneous medium we investigate the equivalent conductivity keq which unlike kefu is a measurable property directly related to the head h or its mean and the discharge the dependence of keq on k statistics and distance r from the source is determined for steady source flow in a formation of random stationary and statistically isotropic k for the first time keq is derived by numerical simulations for σ y 2 4 the derivation of the transition of keq from the local exact value for r i 1 i is the integral scale to kefu for r i 1 is one of the main results of the study application to a synthetic example of hydraulic tomography to derive kg σ y 2 and i from h measurements demonstrates the promise of the method and calls for its further development and validation keywords effective hydraulic conductivity characterization of aquifer hydraulic properties hydraulic tomography heterogeneous aquifers source flow well flow 1 introduction and background steady flow of water takes place in a heterogeneous aquifer of spatially variable conductivity k x the latter is characterized by a correlation scale i while the formation size is of order l with i l the flow obeys locally darcy s law q k h where q is the flux and h is the pressure head in many applications the interest is in the upscaled variables q and h which are space averages over volumes of scale ℓ such that i ℓ l the simplest case is of flow uniform in the mean of constant h j as created by applying constant heads on vertical boundaries of the formation the effective conductivity in uniform flow is defined by q k e f u j with ℓ sufficiently large to render kefu independent of ℓ the derivation of the dependence of kefu which is generally a tensor on the structure of the spatial variable k is the object of a large body of literature due to the interest in the topic in various branches of physics and engineering e g composite materials see for instance comprehensive monographs by milton 2002 and torquato 2002 in the hydrological context reviews were provided by wen and gmez hernndez 1996 renard and de marsily 1997 and sanchez vila et al 2006 the wide application of kefu to flows which are not uniform in the mean stems from the fact that the scale characterizing the spatial change of h is much larger than ℓ in other words the heterogeneous formation can be replaced by a homogeneous one of effective properties and the equation of flow for the upscaled variables can be solved for various boundary conditions various techniques were employed in order to relate kefu to the spatial structure of k such as volume averaging e g dykaar and kitanidis 1992 quintard and whitaker 1998 wood et al 2003 whitaker 1999 or coarse graining e g attinger 2003 here we adopt the stochastic approach y ln k is modeled as a stationary random space function characterized by its univariate pdf f y of mean y ln k g and variance σ y 2 where kg is the geometric mean next the spatial structure is quantified by the two point covariance c y σ y 2 ρ y ξ where ρy is the assumed isotropic autocorrelation of finite integral scale i and ξ is the lag vector between two points for many sedimentary formations field measurements by samples or flowmeters and more recently by dpil technology e g liu et al 2009 have determined that f y is approximately normal see e g freeze 1975 fiori et al 2015 however a complete statistical characterization of y requires the knowledge of multi point moments beyond the covariance cy since generally field data are not sufficient to identify such moments it is common to model y as multi gaussian mvn multivariate normal which we assume here as well in this case the y spatial structure is completely determined by c y σ y 2 ρ y furthermore for simplicity we adopt the common exponential ρ y exp ξ i autocovariance function model under these assumptions the y statistics are completely defined by three parameters kg σ y 2 and i in the stochastic framework the effective conductivity is defined by q k e f u h under ergodic conditions statistical and space averages can be exchanged many studies have been devoted to deriving kefu kg as function of σ y 2 see e g renard and de marsily 1997 for a comprehensive review on early studies and jankovic et al 2013 for a recent contribution dealing with highly heterogeneous formations a first order approximation in σ y 2 led to k e f u k g 1 σ y 2 6 for the mvn it was found that the effective conductivity is approximated quite accurately by the matheron landau conjecture landau and lifshitz 1960 matheron 1967 k e f u k g exp σ y 2 6 see zarlenga et al 2018 fig 1 while flows can be approximated as uniform in the mean for those driven by a natural gradient there are important hydrological applications namely well flows which are strongly nonuniform the applicability of the effective conductivity concept to such flows has been investigated more recently primarily for fully penetrating wells while the problem of nonuniform flow through heterogeneous media has been addressed in the literature in different contexts we refer here only to previous works which are relevant to source flow in random heterogeneous aquifers and to cross flow tomography it was found that kefu is generally not a valid approximation e g indelman and abramovich 1994 and alternative concepts like the equivalent conductivity keq were introduced the effective conductivity in well flow was in fact shown to be nonlocal and therefore not amenable to identification from measurements in the field in contrast the equivalent conductivity see sect 2 3 has the advantage of being the common parameter depending on measured head which is used in practice attempts to relate the mean head h x to the structural properties of the heterogeneous medium k g σ y 2 i were carried out by first order approximation in σ y 2 and by numerical simulations e g desbarats 1994 indelman et al 1996 firmani et al 2006 the keq concept is of interest also in hydraulic tomography by which water is injected or pumped along short intervals e g by using packers of the well while h is measured by pressure transducers along observation piezometers gottlieb and dietrich 1995 a wealth of interest arose around inversion methodologies able to properly handle the inherently mathematically ill posed problem of inferring the hydraulic conductivity from head measurements e g liu et al 2002 illman et al 2008 cardiff et al 2013 illman et al 2008 castagna and bellin 2009 castagna et al 2011 here we focus on the analysis of the information that can be extracted from the head measured at a given distance from a pumping or injecting well which is at the foundation of cross well hydraulic tomography in a cross well setup pumping is performed from a small portion of the well screen isolated by packers and head is measured by pressure transducers in one or more small portions of a piezometer also isolated by packers with this configuration several tests can be conducted by pumping from different elevations in several wells thereby providing data useful for inference of hydraulic property variations data can be collected both in transient and steady state condition and in the present work we start by analyzing the steady state case the main objective of the present study is therefore the analysis of steady flow driven by a point like source in heterogeneous porous formations and in particular the derivation of the equivalent conductivity keq for that configuration as previously discussed we focus here on isotropic conductivity fields which represents a first step toward a more comprehensive analysis we surmise that the analysis of keq for flow driven by a source can be important toward the identification of the structural parameters of the aquifer in the following we analyze the problem i analytically after employing the first order approximation formally valid for σ y 2 1 recapitulating previous results and introducing new ones and ii numerically by accurate simulations for σ y 2 4 2 definitions of effective and equivalent conductivities 2 1 mathematical statement the basic local equations are 1 q q δ x 0 q k h where q is the water discharge at the point source located at x 0 and δ x is the three dimensional dirac delta the boundary condition is of imposed head h 0 at the distance r r r x from the point source of strength q negative for pumping the head h x is therefore negative and its absolute value is equal to the drawdown at x for a homogeneous medium of conductivity k 0 the exact solution of eq 1 with the above boundary conditions is freeze and cherry 1979 2 h r q 4 π k 0 1 r 1 r in the numerical simulations the source is necessarily of finite size and therefore cautions should be adopted in interpreting the numerical solutions with eq 2 a condition at the source that approximates what is actually imposed numerically is that of a sphere of radius rw centered at r 0 with a superficial flow q w q a w where a w 4 π r w 2 is the external surface of the sphere with this condition the solution of the flow eq 1 in a homogeneous medium is again given by eq 2 for a point source but limited to rw r r the apparent well radius rw is obtained as described in section 3 2 in a heterogeneous medium of random k x both h and q k h are random in particular for the isotropic ρy assumed here q r q 4 π r 2 while h is a function of r solely 2 2 effective conductivity the salient question is whether the relationship q r k e f d h d r with an effective conductivity kef depending only on the structure applies to source flow unlike the case of mean uniform flow this topic was investigated more recently the most relevant results belong to the pioneering work of indelman 2001 and indelman and abramovich 1994 thus for a distribution of sources in an unbounded domain it was found that q is related to h by a convolution in space i e the dependence is nonlocal but with the fourier transform of the kernel depending only on the structure the explicit form of the kernel was obtained approximately at first order in σ y 2 this nonlocal definition of kef renders it of little use in applications however the asymptotic values which are local could be determined by indelman and abramovich 1994 as follows in the neighborhood of the source k e f k g 1 σ y 2 2 which is the first order approximation of the harmonic mean kh k g exp σ y 2 2 in contrast k e f k g 1 σ y 2 6 for r i which is the first order approximation of kefu the same results were derived by a heuristic argument by dagan 1989 by observing that most dissipation occurs in the vicinity of the source in which k is approximately constant and equal to its random value at the origin k 0 thus for r i d h d r q 4 π r 2 1 k 0 qr kh a similar argument applies at large r i the flow becomes slowly varying at the i scale and kef kefu a similar transition from the harmonic mean kh to the kefu was shown to prevail in a stratified formation and unsaturated flow by first order approximation foa by severino and coppola 2012 2 3 equivalent conductivity this measure of the conductive properties of the aquifer was proposed by indelman et al 1996 for fully penetrating wells generalizing a definition by matheron 1967 the latter considered flow generated by a head drop applied to the boundaries of a cylindrical domain and defined keq as the conductivity of a homogeneous medium which conveys the same discharge as the heterogeneous one the definition we adopted in the past for well flow and extended here to source flow is as follows k e q h at r is the conductivity of a homogeneous aquifer for which the drawdown at r is the same as h the mean drawdown prevailing in the heterogeneous aquifer thus 3 k e q h r q 4 π h 1 r 1 r notice that according to the adopted sign convention both q and h are negative for pumping thereby k e q h is positive the analogy with kefu is clear the knowledge of k e q h allows to derive the mean head for a given discharge q or the associated qr however unlike kefu the equivalent k e q h depends not only on the structure k g σ y 2 i but also on r in the present study we also consider the alternative definition 4 k e q h x q 4 π h x 1 r 1 r r x which is the conductivity of a homogeneous aquifer for which the head depending only on the distance r from the source is the same as the random measured one h x while the definition of k e q h 3 implies deriving first the mean head h r from measurements k e q h 4 relies directly on the local random h x and is subjected to higher uncertainty however the latter is quantified by the variance of k e q h which is derived for the first time in the present study in words k e q h is the conductivity of a homogeneous aquifer for which the random head at a point of coordinate x is the same as the one prevailing in the heterogeneous one thus k e q h it is precisely the value attributed to k by a naive observer whose only information is the given q and the measured h at a point of coordinate x unlike k e q h 3 k e q h x 4 is random and characterized by its moments k e q h σ k e q which are functions of r by using the same heuristic arguments as in the previous section we can determine the asymptotic behavior of the equivalent conductivities assuming again that in the neighborhood of the source the aquifer behaves like a homogeneous one of conductivity k 0 k 0 we get h q 4 π k 0 1 r and therefore h q 4 π k h 1 r while 1 h 4 π r q k a where ka k g exp σ y 2 2 is the arithmetic mean it follows therefore that for r i k e q h k h while k e q h k a and c v k e q h σ k e q k e q h exp σ y 2 1 1 2 for large r i 1 we expect the flow to behave like a uniform one with k e q h and k e q h tending to kefu and c v k e q h 0 we are now in the position to define in detail and in quantitative terms the aims of the paper i to derive the dependence of k e q h k g k e q h k g and c v k e q h upon r r i by foa first order approximation in σ y 2 and numerical simulations hereinafter ns ii to delimit the magnitude of the transition zone from the near field asymptotic values at r r w 1 to those pertaining to uniform flow for r 1 and iii to illustrate the possible application to identifying the structural parameters kg σ y 2 and i by a cross well hydraulic tomography setup 3 derivation of k e q h k g k e q h k g and c v k e q h 3 1 first order approximation foa solving the equations of flow 1 approximately by an expansion of h in a perturbation series in σy is a well established technique see monographs by dagan 1989 gelhar 1993 rubin 2003 we will present here a few results relevant to our topic solely thus with h h 0 h 1 h 2 where h 0 o 1 h 1 o σ y h 2 o σ y 2 at first order h h 0 h 2 and σ h 2 h 1 2 the solutions are obtained by substituting k k g 1 y y 2 in 1 where y y y and solving for terms of same order with h 0 the solution in an homogeneous medium of conductivity kg we have for source flow 5 h 0 q 4 π k g 1 r 1 r for r w r r the first order approximation h 2 for an exponential covariance was obtained by indelman 2001 eq 29 in an analytical form as follows 6 h 2 σ y 2 h 0 ψ 1 2 ψ 1 3 2 3 r 6 r 2 6 exp r r 1 r 2 6 ei r with the limits ψ 1 for r 0 and ψ 1 3 for r similar expressions were derived by severino 2011a severino et al 2019 and dagan and lessoff 2007 for the condition of given head at r r w they are needed for solving flow for a well of large length which is not considered here substitution of h h 0 h 2 given by eqs 5 and 6 into 3 and expanding leads to the first order approximation of k e q h 7 k e q h k g 1 σ y 2 ψ 1 2 given the form of eq 6 it is seen that k e q h k g 1 σ y 2 2 for r 0 and k e q h k g 1 σ y 2 6 for r 1 respectively as discussed in the previous section the dependence of k e q h k g 7 upon r is depicted in fig 1 for a few values of σ y 2 in a similar manner substitution of h into k e q h 4 and expanding at first order leads to 8 k e q h k g 1 σ y 2 ψ 1 2 σ h 2 h 0 2 σ k e q 2 k g 2 σ h 2 h 0 2 unlike ψ 6 the computation of σ h 2 h 1 2 could not be carried out analytically severino 2011a expressed it in terms of a few quadratures which make its computation quite difficult some simplifications were obtained for fully penetrating wells by severino 2011b 3 2 numerical simulations ns while the foa led to analytical solutions it is limited to weak heterogeneity and the range of validity of σ y 2 value is unknown a priori generally this could be established by comparing with ns thus as it was shown by zarlenga et al 2018 fig 1 the foa of kefu is quite robust for isotropic formations being accurate for say σ y 2 2 a much less robust result was found to prevail for the the effective vertical conductivity of anisotropic formations it is therefore of major interest to solve numerically the source flow problem we present here the ns for source flow for σ y 2 4 values which cover the cases of many sedimentary aquifers see e g rubin 2003 however the numerical solution for flow driven by a source poses challenging problems due to the strong spatial variability of the piezometric field determined by the source and the crucial importance of the k field near the source itself such issues are more difficult to address than other still challenging problems like e g flow in a fully penetrating pumping well in heterogeneous formations the problem of assigning block scale conductivity that upscales unresolved fine scale variability is a topic widely addressed in the reservoir engineering literature e g durlofsky et al 2000 karimi fard and durlofsky 2012 in the present paper we adopt a very dense numerical discretization 16 grid nodes per integral scale which does not require upscaling bellin et al 1992 firmani et al 2006 flow was solved in a spherical domain of radius r 20 i by using modflow 2005 harbaugh 2005 which implements a widely used finite volume numerical scheme with a regular grid of spacing δ x i 0 0625 i i 1 2 3 along the three coordinate directions the spherical domain was obtained by trimming a cube of size equal to 20 0625 i around the cells at a distance r 20 i from the center the total number of cells was then n 17155325 the flow eq 1 was solved in dimensionless form with the integral scale i and kg as length and conductivity scales respectively a source of unitary dimensionless discharge q k g i 2 1 was placed at the center of the domain and zero drawdown h 0 was assigned to all the cells delineating the external surface of the spherical computational domain a python code was developed to manage the simulations and the post processing calculations on the numerically computed heads which took advantage of the flopy python package bakker et al 2016 to create the modflow input files and read the heads from the binary output file while the accuracy of numerical models of groundwater flow in presence of sources sinks is still a matter of debate see e g alecsa et al 2020 upton et al 2019 louwyck et al 2012 langevin 2008 the accuracy and robustness of our method was tested by i comparison of the head with the analytical solution for the homogeneous case ii comparison with the first order solution for mean head and low heterogeneity σ y 2 0 2 iii verification that the mass balance error was below 0 005 of the total flow in each realization and iv verification of the convergence of the monte carlo scheme for the first two moments of piezometric head the statistics of the relevant quantities were obtained by averaging over m c 1000 monte carlo realizations of a multi gaussian random field y of constant mean y 0 given variance σ y 2 and isotropic exponential covariance function generated by hydrogen bellin and rubin 1996 taking advantage of the fact that the surfaces of statistical stationarity are spheres centered at r 0 the four values of the statistics at the same distance along the four cardinal directions in the horizontal plane crossing the source were averaged thereby accelerating convergence this has been done upon verification that for a given σ y 2 the numerically computed statistics are the same at all cells with distance r from the source considering the finite volume scheme adopted in modflow 2005 the flux imposed to the central cell is distributed among the 6 external surfaces depending on the hydraulic conductivity of the adjacent cells in homogeneous domain the flux is the same for each of the 6 external surfaces as described above this configuration could be approximated by considering a finite spherical source whose radius rw depends on the cell s size we computed rw by inverting the analytical solution 2 after replacing h r with h r w h 0 where h 0 is the head at the cell at the domain s center obtained numerically in a homogeneous domain with k x k g thus 9 r w 1 1 r 4 π k g h 0 q with our numerical setup r w 0 0197 i δ x i 0 0625 i i 1 2 3 eq 9 is in line with the estimate provided by peaceman 1983 in a two dimensional setup for a fully penetrating well given that rw δxi the analytical solution 4 can be used to compute k e q h by approximating the head h x with the numerical head of the cell with center at x 10 k e q h x q 4 π h x 1 r 1 r r w r r where r x r w is the distance of the center x of the computational cell from the center of the domain at r r w eq 10 is applied by replacing r with rw and h r with the numerical head at the central cell finally k e q h is obtained by replacing into equation 10 h r with h r obtained by averaging over the mc monte carlo realizations 4 results and discussion we depict in fig 1 the dependence of k e q h k g upon r r i for a few values of σ y 2 both by the ns and the foa the latter obey the requirement k e q h k g k h k g exp σ y 2 2 and 1 σ y 2 2 respectively for r 0 subsequently k e q h k g grows with r in a transition zone until it levels off at k e q h k g k e f u k g an exact solution for the latter is unfortunately not available and for the sake of comparison we employ here the solution for kefu based on the matheron landau conjecture i e k e q h k g k e f u k g exp σ y 2 6 the solution is indicated in fig 1 by the big squares which at first order is equal to 1 σ y 2 6 it is seen that the matheron landau solution is a good approximation for σ y 2 2 the foa departs from the ns for say σ y 2 0 5 but it is quite close to it for all σ y 2 for the asymptotic uniform flow approximation as already found by zarlenga et al 2018 and discussed above we remark that the foa for keq seems less robust than what was found for other cases like flow uniform in the mean this will be further illustrated in the next figures the apparent rapid deterioration of foa with σ y 2 is likely caused by two factors i the high sensitivity of flow on k within a very small region near the source that makes the problem highly non linear and ii the expansion of h 1 in the expressions for keq that converges slowly than a direct expansion of h a major result achieved by the ns is the value of r t r r t r i at the transition to uniform flow value it grows from r t r 0 5 for σ y 2 0 2 to r t r 1 for σ y 2 4 the foa overestimates the radius of the transition point with increasing σ y 2 thus the mean head behaves like one pertaining to uniform gradient unexpectedly close to the source this is an encouraging finding for identification of kefu from h measurements on the other hand identification of i becomes problematic for measurements in this zone a compact representation by the dimensionless coefficient λ which is practically independent of σ y 2 was proposed for a fully penetrating well by indelman et al 1996 based on the foa in the present case it becomes 11 λ r k eq h k efu k h k efu with the limits λ 1 r 0 and λ 0 r r t r in fig 2 we represent λ r based on the ns as well as the foa the latter is a fair approximation of the numerical results especially in the vicinity of the source it is seen that transition occurs to λ 0 at r t r 0 8 for the ns while for the foa r t r 1 6 indeed the ns results are relatively close each other and can be approximated quite accurately by the unique λ exp 6 r the application of this simple result to identification of statistical parameters from h measurements will be illustrated in section 5 moving to the derivation of the random k e q h moments an intermediate step toward computation of k e q h by the foa 8 was the calculation of σ h 2 the head variance as already mentioned its determination by the foa is fraught with difficulties we have represented in fig 3 the ns based dimensionless σ h 2 σ y 2 h 0 2 which is independent of σ y 2 for the foa it is seen that indeed the results become close for σ y 2 0 5 while σ h 2 depends in a highly nonlinear fashion on σ y 2 0 5 a somewhat unexpected result is that σ h 2 σ y 2 h 0 2 is close to zero for r 0 6 thus ergodicity for h i e h h is achieved quite close to the source which is again a result of important practical implications next we have represented in fig 4 the dependence of k e q h k g on r based on the ns similarly to fig 1 we can discern the existence of two zones the inner one in which k e q h k g k a k g exp σ y 2 2 at r 0 drops to kefu kg for r t r 0 2 σ y 2 0 2 and r t r 0 3 σ y 2 4 and then levels off in the outer zone the foa result is based on eq 8 in which we have substituted the ns based values of σ h 2 σ y 2 h 0 2 for σ y 2 0 2 fig 3 it is seen that the foa result differs significantly from the ones based on ns for σ y 2 1 subsequently we represent in fig 5 the dependence of the coefficient of variation divided by σy c v k e q h σ y σ k e q k e q h σ y upon r it is seen that the ns lead to a practically unique curve the impact of σy being filtered out the foa graph which is quite close to the ns is underlain by eq 8 in which σ h 2 is based on the ns for σ y 2 0 2 fig 3 it is seen that c v k e q h σ y drops quickly from the asymptotic value of unity that corresponds to the foa from section 3 1 c v k e q h σ k e q k e q h exp σ y 2 1 1 2 which at first order is equal to σy at r 0 to c v k e q h σ y 0 08 for r 1 and to 0 02 for r 3 a topic of interest in applications is the impact of conditioning of h by its measured value hw equal to h 0 of the numerical solution at rw assuming that h is multi gaussian consistent with foa it is easy to check e g dagan 1989 that the mean head conditioned on hw denoted as h r c is given by the simple expression 12 h r c h r ρ h r w r σ h r σ h r w h w h r w where ρh rw r is the autocorrelation of hydraulic head at the source and at a generic location r while the variance σ h 2 was previously discussed we represent in fig 6 the ns based covariance between h rw and h r it is seen that the impact of σ y 2 is filtered out and that of the measured head is limited to r i 1 since the ratio σh r σh rw is typically very small see fig 3 inspection of expression 12 and the results presented here suggest that the impact of conditioning at the source on h r is also very small this result is of definite interest for potential applications and confirms the findings by castagna and bellin 2009 in the inversion of a synthetic cross well hydraulic tomography example 5 application illustration identification of geostatistical parameters we envision here a simple inverse procedure for the inference of relevant geostatistical parameters of y namely kg σ y 2 and i the procedure is based on a set of point like sources along the vertical which is similar to hydraulic tomography configuration we emphasize that what is given here is a proof of concept based on a synthetic experiment and with limited number of measurements while a more thorough validation is needed before applying the proposed methodology to full scale experimental data this example suffices to show the potential merits of the proposed approach the setup consists of two vertical wells located at horizontal distance δ each well has nw point like sources along it at at equal distance δ z thereby totalizing 2nw points water is pumped at rate q in one of the sources and after reaching steady flow piezometric head is measured in all sources providing a set of 2nw hydraulic heads at the 2nw relative distances ri of the sources from the pumping one the procedure is repeated for all the sources providing a set of 2nw 2 head values each of them characterized by a distance from the pumping source that have generated it then the head values characterized by the same distance ri are averaged to provide an approximation to the mean head h i at all the possible distances among the emitting and receiving elements the averaged heads are then introduced into 3 to calculate geometric mean k e q h for each distance ri and the resulting set of values is fitted by expression 11 the fitting provides the three parameters kg σ y 2 i on which the terms λ kefu and kh appearing in 11 depend for λ we have employed the expression λ exp 6 r i i as discussed in the previous section we emphasize that the type of data needed for the procedure is similar to the one obtained in a hydraulic tomography experiment hence it can provide estimates of the main statistical parameters of y ln k with a different procedure from the one commonly used in tomography but employing a similar set of data it should be mentioned that indelman 2001 envisioned an inference methodology based on data collected in a single well in a configuration called well dipole and with emitters and receivers on same well by the foa however such a procedure is prone to lead to highly uncertain identified parameters in view of the results obtained here for the more comprehensive cross well configuration the procedure is illustrated by assuming a conductivity field similar to the one of borden site e g sudicky 1986 with representative values the geostatistical parameters k g 10 4 m s σ y 2 0 5 and the equivalent i 4 m the assumed distances between wells and sources are δ 6 m and δ z 1 m respectively the head at the wells are calculated by numerical simulations along the scheme previously discussed in section 3 2 in order to provide an assessment of the uncertainty of the estimates a monte carlo procedure was performed generating 400 independent realizations of the pumping scheme three different number of sources per each of the two wells were adopted with n w 3 5 7 the same exercise was carried out for the more heterogeneous scenario σ y 2 1 in the attempt to test the foa analytical solution beyond its expected range of validity the results are displayed in table 1 where both the mean and standard deviation sd of the ratio between inferred and input geostatistical parameters are given the tilde indicates the inferred parameter it is seen that the proposed inversion methodology provides realistic estimates of the geostatistical parameters in particular the inference of kg is the most robust with a relatively low sd in all cases increasing the number of wells nw leads to a general decrease of the sd as expected the parameter inference is prone to more uncertainty for the other parameters σ y 2 and i for which the sd is generally large it is seen that the inference of i is the most problematic with an apparent systematic overestimation of around 1 25 and a significant sd this confirms what found by similar approaches for the parameters inference from aquifer tests e g firmani et al 2006 in any case the method seems to adequately capture the magnitude of the parameters although the procedure needs further verification and refinements it is promising showing the potential usefulness of simplified solutions for obtaining keq of point like sources in heterogeneous formations that is the main objective of the present work 6 summary and conclusions identification of aquifer conductivity k based on measurements of the head h is a well established procedure e g by pumping tests by fully or partially penetrating wells the straightforward procedure is to use the solution of the direct problem which relates h to k and to derive the latter by a best fit between computed and measured h traditionally the aquifer is regarded as homogeneous and for the common heterogeneous ones k is regarded as representing kefu the effective conductivity in mean uniform natural gradient flow recently the hydraulic tomography procedure has been forwarded e g gottlieb and dietrich 1995 water is pumped injected through short segments along the well e g by using packers and h is measured by pressure transducers along piezometers at a few distances the inversion procedure advanced in the past to identify k distribution in space see e g liu et al 2002 illman et al 2008 cardiff et al 2009 was to cast the flow equations in a numerical form with h and k the values at nodes subsequently the measured h values are used in order to identify k by a best fit by optimization algorithms here we adopt the stochastic approach e g indelman et al 1996 fiori et al 1998 castagna and bellin 2009 chen et al 2019 the y ln k field is modeled as a multi gaussian stationary random field which is characterized by kg σ y 2 and the integral scale i for the assumed isotropic structure then the aim is to identify the parameters and primarily kefu from measured h values as a first step we consider here the steady flow from a source to model the emitters in the tomographic setup whereas a vast body of literature was devoted to deriving the relationship between kefu kg and σ y 2 the more recent developments for the source strongly nonuniform flow e g indelman and abramovich 1994 have determined that a local kef depending on the statistical moments does not exist instead we use here the concept of keq which is defined as k of a homogeneous medium which leads to the same observed h or the average h as the heterogeneous one keq depends on the structure as well as the distance r from the source while attempts were made in the past to derive the dependence of keq kg on r r i by a foa first order approximation in σ y 2 the main contribution of the paper is its numerical computation for a few values of 0 2 σ y 2 4 the main result of the study as revealed for instance by figs 1 2 is that keq kg defined with the aid of h has the localized value kh kg the harmonic mean near the source it grows monotonously in a transition zone of radius r t r and then it levels off at kefu kg the transition zone is smaller r t r 0 7 then the one determined by foa which improves the chances to identify kefu kg in practice on one hand but makes the one of i more difficult on the other besides keq kg we derived the head variance as well as the autocorrelation between the head near the source and at arbitrary r which can be also used for identification purposes last a proof of the concept toward application to hydraulic tomography is illustrated by a synthetic example flow is caused by an arrow of n w 3 5 7 of sources along a line and h is computed at a equal number of stations along an observation well numerical solutions are achieved by generating 400 realizations for values of σ y 2 0 5 1 i 4 m the results for the identified parameters k g σ y 2 i achieved by best fit of keq are displayed in table 1 it reveals that the mean values of the parameters as compared with the input values are identified quite accurately for k g k g and σ y 2 σ y 2 and with an error of around 25 for i i however while the uncertainty as expressed by the standard deviation of the estimate is quite large of the order of the mean for σ y 2 σ y 2 and i i it is relatively small for k g k g while these results are obtained for a synthetic particular case they are encouraging and suggest that the proposed stochastic hydraulic tomography should be pursued by further investigations it is suggested that future work shall consider for instance statistically anisotropic aquifers impact of boundaries influence of conditioning by the measured h and or k and unsteady flow however the acid test shall be provided by comparison with field tests declaration of competing interests the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments ab and af acknowledge funding from the italian ministry of education university and research miur in the frame of the departments of excellence initiative 2018 2022 granted to dicam of the university of trento ab and the dept of engineering of roma tre university af supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2020 103632 appendix a supplementary materials supplementary data s1 supplementary raw research data this is open data under the cc by license http creativecommons org licenses by 4 0 supplementary data s1 
446,the effective conductivity of heterogeneous aquifers kefu relates the mean flux to the mean head gradient in mean uniform natural gradient flow while kefu depends on the hydraulic conductivity k statistical moments kg the geometric mean and σ y 2 the logconductivity variance for a given structure model it is not a local property for strongly nonuniform well flow in hydraulic tomography flow to a short well segment which is considered here can be approximated by that toward a source in a three dimensional heterogeneous medium we investigate the equivalent conductivity keq which unlike kefu is a measurable property directly related to the head h or its mean and the discharge the dependence of keq on k statistics and distance r from the source is determined for steady source flow in a formation of random stationary and statistically isotropic k for the first time keq is derived by numerical simulations for σ y 2 4 the derivation of the transition of keq from the local exact value for r i 1 i is the integral scale to kefu for r i 1 is one of the main results of the study application to a synthetic example of hydraulic tomography to derive kg σ y 2 and i from h measurements demonstrates the promise of the method and calls for its further development and validation keywords effective hydraulic conductivity characterization of aquifer hydraulic properties hydraulic tomography heterogeneous aquifers source flow well flow 1 introduction and background steady flow of water takes place in a heterogeneous aquifer of spatially variable conductivity k x the latter is characterized by a correlation scale i while the formation size is of order l with i l the flow obeys locally darcy s law q k h where q is the flux and h is the pressure head in many applications the interest is in the upscaled variables q and h which are space averages over volumes of scale ℓ such that i ℓ l the simplest case is of flow uniform in the mean of constant h j as created by applying constant heads on vertical boundaries of the formation the effective conductivity in uniform flow is defined by q k e f u j with ℓ sufficiently large to render kefu independent of ℓ the derivation of the dependence of kefu which is generally a tensor on the structure of the spatial variable k is the object of a large body of literature due to the interest in the topic in various branches of physics and engineering e g composite materials see for instance comprehensive monographs by milton 2002 and torquato 2002 in the hydrological context reviews were provided by wen and gmez hernndez 1996 renard and de marsily 1997 and sanchez vila et al 2006 the wide application of kefu to flows which are not uniform in the mean stems from the fact that the scale characterizing the spatial change of h is much larger than ℓ in other words the heterogeneous formation can be replaced by a homogeneous one of effective properties and the equation of flow for the upscaled variables can be solved for various boundary conditions various techniques were employed in order to relate kefu to the spatial structure of k such as volume averaging e g dykaar and kitanidis 1992 quintard and whitaker 1998 wood et al 2003 whitaker 1999 or coarse graining e g attinger 2003 here we adopt the stochastic approach y ln k is modeled as a stationary random space function characterized by its univariate pdf f y of mean y ln k g and variance σ y 2 where kg is the geometric mean next the spatial structure is quantified by the two point covariance c y σ y 2 ρ y ξ where ρy is the assumed isotropic autocorrelation of finite integral scale i and ξ is the lag vector between two points for many sedimentary formations field measurements by samples or flowmeters and more recently by dpil technology e g liu et al 2009 have determined that f y is approximately normal see e g freeze 1975 fiori et al 2015 however a complete statistical characterization of y requires the knowledge of multi point moments beyond the covariance cy since generally field data are not sufficient to identify such moments it is common to model y as multi gaussian mvn multivariate normal which we assume here as well in this case the y spatial structure is completely determined by c y σ y 2 ρ y furthermore for simplicity we adopt the common exponential ρ y exp ξ i autocovariance function model under these assumptions the y statistics are completely defined by three parameters kg σ y 2 and i in the stochastic framework the effective conductivity is defined by q k e f u h under ergodic conditions statistical and space averages can be exchanged many studies have been devoted to deriving kefu kg as function of σ y 2 see e g renard and de marsily 1997 for a comprehensive review on early studies and jankovic et al 2013 for a recent contribution dealing with highly heterogeneous formations a first order approximation in σ y 2 led to k e f u k g 1 σ y 2 6 for the mvn it was found that the effective conductivity is approximated quite accurately by the matheron landau conjecture landau and lifshitz 1960 matheron 1967 k e f u k g exp σ y 2 6 see zarlenga et al 2018 fig 1 while flows can be approximated as uniform in the mean for those driven by a natural gradient there are important hydrological applications namely well flows which are strongly nonuniform the applicability of the effective conductivity concept to such flows has been investigated more recently primarily for fully penetrating wells while the problem of nonuniform flow through heterogeneous media has been addressed in the literature in different contexts we refer here only to previous works which are relevant to source flow in random heterogeneous aquifers and to cross flow tomography it was found that kefu is generally not a valid approximation e g indelman and abramovich 1994 and alternative concepts like the equivalent conductivity keq were introduced the effective conductivity in well flow was in fact shown to be nonlocal and therefore not amenable to identification from measurements in the field in contrast the equivalent conductivity see sect 2 3 has the advantage of being the common parameter depending on measured head which is used in practice attempts to relate the mean head h x to the structural properties of the heterogeneous medium k g σ y 2 i were carried out by first order approximation in σ y 2 and by numerical simulations e g desbarats 1994 indelman et al 1996 firmani et al 2006 the keq concept is of interest also in hydraulic tomography by which water is injected or pumped along short intervals e g by using packers of the well while h is measured by pressure transducers along observation piezometers gottlieb and dietrich 1995 a wealth of interest arose around inversion methodologies able to properly handle the inherently mathematically ill posed problem of inferring the hydraulic conductivity from head measurements e g liu et al 2002 illman et al 2008 cardiff et al 2013 illman et al 2008 castagna and bellin 2009 castagna et al 2011 here we focus on the analysis of the information that can be extracted from the head measured at a given distance from a pumping or injecting well which is at the foundation of cross well hydraulic tomography in a cross well setup pumping is performed from a small portion of the well screen isolated by packers and head is measured by pressure transducers in one or more small portions of a piezometer also isolated by packers with this configuration several tests can be conducted by pumping from different elevations in several wells thereby providing data useful for inference of hydraulic property variations data can be collected both in transient and steady state condition and in the present work we start by analyzing the steady state case the main objective of the present study is therefore the analysis of steady flow driven by a point like source in heterogeneous porous formations and in particular the derivation of the equivalent conductivity keq for that configuration as previously discussed we focus here on isotropic conductivity fields which represents a first step toward a more comprehensive analysis we surmise that the analysis of keq for flow driven by a source can be important toward the identification of the structural parameters of the aquifer in the following we analyze the problem i analytically after employing the first order approximation formally valid for σ y 2 1 recapitulating previous results and introducing new ones and ii numerically by accurate simulations for σ y 2 4 2 definitions of effective and equivalent conductivities 2 1 mathematical statement the basic local equations are 1 q q δ x 0 q k h where q is the water discharge at the point source located at x 0 and δ x is the three dimensional dirac delta the boundary condition is of imposed head h 0 at the distance r r r x from the point source of strength q negative for pumping the head h x is therefore negative and its absolute value is equal to the drawdown at x for a homogeneous medium of conductivity k 0 the exact solution of eq 1 with the above boundary conditions is freeze and cherry 1979 2 h r q 4 π k 0 1 r 1 r in the numerical simulations the source is necessarily of finite size and therefore cautions should be adopted in interpreting the numerical solutions with eq 2 a condition at the source that approximates what is actually imposed numerically is that of a sphere of radius rw centered at r 0 with a superficial flow q w q a w where a w 4 π r w 2 is the external surface of the sphere with this condition the solution of the flow eq 1 in a homogeneous medium is again given by eq 2 for a point source but limited to rw r r the apparent well radius rw is obtained as described in section 3 2 in a heterogeneous medium of random k x both h and q k h are random in particular for the isotropic ρy assumed here q r q 4 π r 2 while h is a function of r solely 2 2 effective conductivity the salient question is whether the relationship q r k e f d h d r with an effective conductivity kef depending only on the structure applies to source flow unlike the case of mean uniform flow this topic was investigated more recently the most relevant results belong to the pioneering work of indelman 2001 and indelman and abramovich 1994 thus for a distribution of sources in an unbounded domain it was found that q is related to h by a convolution in space i e the dependence is nonlocal but with the fourier transform of the kernel depending only on the structure the explicit form of the kernel was obtained approximately at first order in σ y 2 this nonlocal definition of kef renders it of little use in applications however the asymptotic values which are local could be determined by indelman and abramovich 1994 as follows in the neighborhood of the source k e f k g 1 σ y 2 2 which is the first order approximation of the harmonic mean kh k g exp σ y 2 2 in contrast k e f k g 1 σ y 2 6 for r i which is the first order approximation of kefu the same results were derived by a heuristic argument by dagan 1989 by observing that most dissipation occurs in the vicinity of the source in which k is approximately constant and equal to its random value at the origin k 0 thus for r i d h d r q 4 π r 2 1 k 0 qr kh a similar argument applies at large r i the flow becomes slowly varying at the i scale and kef kefu a similar transition from the harmonic mean kh to the kefu was shown to prevail in a stratified formation and unsaturated flow by first order approximation foa by severino and coppola 2012 2 3 equivalent conductivity this measure of the conductive properties of the aquifer was proposed by indelman et al 1996 for fully penetrating wells generalizing a definition by matheron 1967 the latter considered flow generated by a head drop applied to the boundaries of a cylindrical domain and defined keq as the conductivity of a homogeneous medium which conveys the same discharge as the heterogeneous one the definition we adopted in the past for well flow and extended here to source flow is as follows k e q h at r is the conductivity of a homogeneous aquifer for which the drawdown at r is the same as h the mean drawdown prevailing in the heterogeneous aquifer thus 3 k e q h r q 4 π h 1 r 1 r notice that according to the adopted sign convention both q and h are negative for pumping thereby k e q h is positive the analogy with kefu is clear the knowledge of k e q h allows to derive the mean head for a given discharge q or the associated qr however unlike kefu the equivalent k e q h depends not only on the structure k g σ y 2 i but also on r in the present study we also consider the alternative definition 4 k e q h x q 4 π h x 1 r 1 r r x which is the conductivity of a homogeneous aquifer for which the head depending only on the distance r from the source is the same as the random measured one h x while the definition of k e q h 3 implies deriving first the mean head h r from measurements k e q h 4 relies directly on the local random h x and is subjected to higher uncertainty however the latter is quantified by the variance of k e q h which is derived for the first time in the present study in words k e q h is the conductivity of a homogeneous aquifer for which the random head at a point of coordinate x is the same as the one prevailing in the heterogeneous one thus k e q h it is precisely the value attributed to k by a naive observer whose only information is the given q and the measured h at a point of coordinate x unlike k e q h 3 k e q h x 4 is random and characterized by its moments k e q h σ k e q which are functions of r by using the same heuristic arguments as in the previous section we can determine the asymptotic behavior of the equivalent conductivities assuming again that in the neighborhood of the source the aquifer behaves like a homogeneous one of conductivity k 0 k 0 we get h q 4 π k 0 1 r and therefore h q 4 π k h 1 r while 1 h 4 π r q k a where ka k g exp σ y 2 2 is the arithmetic mean it follows therefore that for r i k e q h k h while k e q h k a and c v k e q h σ k e q k e q h exp σ y 2 1 1 2 for large r i 1 we expect the flow to behave like a uniform one with k e q h and k e q h tending to kefu and c v k e q h 0 we are now in the position to define in detail and in quantitative terms the aims of the paper i to derive the dependence of k e q h k g k e q h k g and c v k e q h upon r r i by foa first order approximation in σ y 2 and numerical simulations hereinafter ns ii to delimit the magnitude of the transition zone from the near field asymptotic values at r r w 1 to those pertaining to uniform flow for r 1 and iii to illustrate the possible application to identifying the structural parameters kg σ y 2 and i by a cross well hydraulic tomography setup 3 derivation of k e q h k g k e q h k g and c v k e q h 3 1 first order approximation foa solving the equations of flow 1 approximately by an expansion of h in a perturbation series in σy is a well established technique see monographs by dagan 1989 gelhar 1993 rubin 2003 we will present here a few results relevant to our topic solely thus with h h 0 h 1 h 2 where h 0 o 1 h 1 o σ y h 2 o σ y 2 at first order h h 0 h 2 and σ h 2 h 1 2 the solutions are obtained by substituting k k g 1 y y 2 in 1 where y y y and solving for terms of same order with h 0 the solution in an homogeneous medium of conductivity kg we have for source flow 5 h 0 q 4 π k g 1 r 1 r for r w r r the first order approximation h 2 for an exponential covariance was obtained by indelman 2001 eq 29 in an analytical form as follows 6 h 2 σ y 2 h 0 ψ 1 2 ψ 1 3 2 3 r 6 r 2 6 exp r r 1 r 2 6 ei r with the limits ψ 1 for r 0 and ψ 1 3 for r similar expressions were derived by severino 2011a severino et al 2019 and dagan and lessoff 2007 for the condition of given head at r r w they are needed for solving flow for a well of large length which is not considered here substitution of h h 0 h 2 given by eqs 5 and 6 into 3 and expanding leads to the first order approximation of k e q h 7 k e q h k g 1 σ y 2 ψ 1 2 given the form of eq 6 it is seen that k e q h k g 1 σ y 2 2 for r 0 and k e q h k g 1 σ y 2 6 for r 1 respectively as discussed in the previous section the dependence of k e q h k g 7 upon r is depicted in fig 1 for a few values of σ y 2 in a similar manner substitution of h into k e q h 4 and expanding at first order leads to 8 k e q h k g 1 σ y 2 ψ 1 2 σ h 2 h 0 2 σ k e q 2 k g 2 σ h 2 h 0 2 unlike ψ 6 the computation of σ h 2 h 1 2 could not be carried out analytically severino 2011a expressed it in terms of a few quadratures which make its computation quite difficult some simplifications were obtained for fully penetrating wells by severino 2011b 3 2 numerical simulations ns while the foa led to analytical solutions it is limited to weak heterogeneity and the range of validity of σ y 2 value is unknown a priori generally this could be established by comparing with ns thus as it was shown by zarlenga et al 2018 fig 1 the foa of kefu is quite robust for isotropic formations being accurate for say σ y 2 2 a much less robust result was found to prevail for the the effective vertical conductivity of anisotropic formations it is therefore of major interest to solve numerically the source flow problem we present here the ns for source flow for σ y 2 4 values which cover the cases of many sedimentary aquifers see e g rubin 2003 however the numerical solution for flow driven by a source poses challenging problems due to the strong spatial variability of the piezometric field determined by the source and the crucial importance of the k field near the source itself such issues are more difficult to address than other still challenging problems like e g flow in a fully penetrating pumping well in heterogeneous formations the problem of assigning block scale conductivity that upscales unresolved fine scale variability is a topic widely addressed in the reservoir engineering literature e g durlofsky et al 2000 karimi fard and durlofsky 2012 in the present paper we adopt a very dense numerical discretization 16 grid nodes per integral scale which does not require upscaling bellin et al 1992 firmani et al 2006 flow was solved in a spherical domain of radius r 20 i by using modflow 2005 harbaugh 2005 which implements a widely used finite volume numerical scheme with a regular grid of spacing δ x i 0 0625 i i 1 2 3 along the three coordinate directions the spherical domain was obtained by trimming a cube of size equal to 20 0625 i around the cells at a distance r 20 i from the center the total number of cells was then n 17155325 the flow eq 1 was solved in dimensionless form with the integral scale i and kg as length and conductivity scales respectively a source of unitary dimensionless discharge q k g i 2 1 was placed at the center of the domain and zero drawdown h 0 was assigned to all the cells delineating the external surface of the spherical computational domain a python code was developed to manage the simulations and the post processing calculations on the numerically computed heads which took advantage of the flopy python package bakker et al 2016 to create the modflow input files and read the heads from the binary output file while the accuracy of numerical models of groundwater flow in presence of sources sinks is still a matter of debate see e g alecsa et al 2020 upton et al 2019 louwyck et al 2012 langevin 2008 the accuracy and robustness of our method was tested by i comparison of the head with the analytical solution for the homogeneous case ii comparison with the first order solution for mean head and low heterogeneity σ y 2 0 2 iii verification that the mass balance error was below 0 005 of the total flow in each realization and iv verification of the convergence of the monte carlo scheme for the first two moments of piezometric head the statistics of the relevant quantities were obtained by averaging over m c 1000 monte carlo realizations of a multi gaussian random field y of constant mean y 0 given variance σ y 2 and isotropic exponential covariance function generated by hydrogen bellin and rubin 1996 taking advantage of the fact that the surfaces of statistical stationarity are spheres centered at r 0 the four values of the statistics at the same distance along the four cardinal directions in the horizontal plane crossing the source were averaged thereby accelerating convergence this has been done upon verification that for a given σ y 2 the numerically computed statistics are the same at all cells with distance r from the source considering the finite volume scheme adopted in modflow 2005 the flux imposed to the central cell is distributed among the 6 external surfaces depending on the hydraulic conductivity of the adjacent cells in homogeneous domain the flux is the same for each of the 6 external surfaces as described above this configuration could be approximated by considering a finite spherical source whose radius rw depends on the cell s size we computed rw by inverting the analytical solution 2 after replacing h r with h r w h 0 where h 0 is the head at the cell at the domain s center obtained numerically in a homogeneous domain with k x k g thus 9 r w 1 1 r 4 π k g h 0 q with our numerical setup r w 0 0197 i δ x i 0 0625 i i 1 2 3 eq 9 is in line with the estimate provided by peaceman 1983 in a two dimensional setup for a fully penetrating well given that rw δxi the analytical solution 4 can be used to compute k e q h by approximating the head h x with the numerical head of the cell with center at x 10 k e q h x q 4 π h x 1 r 1 r r w r r where r x r w is the distance of the center x of the computational cell from the center of the domain at r r w eq 10 is applied by replacing r with rw and h r with the numerical head at the central cell finally k e q h is obtained by replacing into equation 10 h r with h r obtained by averaging over the mc monte carlo realizations 4 results and discussion we depict in fig 1 the dependence of k e q h k g upon r r i for a few values of σ y 2 both by the ns and the foa the latter obey the requirement k e q h k g k h k g exp σ y 2 2 and 1 σ y 2 2 respectively for r 0 subsequently k e q h k g grows with r in a transition zone until it levels off at k e q h k g k e f u k g an exact solution for the latter is unfortunately not available and for the sake of comparison we employ here the solution for kefu based on the matheron landau conjecture i e k e q h k g k e f u k g exp σ y 2 6 the solution is indicated in fig 1 by the big squares which at first order is equal to 1 σ y 2 6 it is seen that the matheron landau solution is a good approximation for σ y 2 2 the foa departs from the ns for say σ y 2 0 5 but it is quite close to it for all σ y 2 for the asymptotic uniform flow approximation as already found by zarlenga et al 2018 and discussed above we remark that the foa for keq seems less robust than what was found for other cases like flow uniform in the mean this will be further illustrated in the next figures the apparent rapid deterioration of foa with σ y 2 is likely caused by two factors i the high sensitivity of flow on k within a very small region near the source that makes the problem highly non linear and ii the expansion of h 1 in the expressions for keq that converges slowly than a direct expansion of h a major result achieved by the ns is the value of r t r r t r i at the transition to uniform flow value it grows from r t r 0 5 for σ y 2 0 2 to r t r 1 for σ y 2 4 the foa overestimates the radius of the transition point with increasing σ y 2 thus the mean head behaves like one pertaining to uniform gradient unexpectedly close to the source this is an encouraging finding for identification of kefu from h measurements on the other hand identification of i becomes problematic for measurements in this zone a compact representation by the dimensionless coefficient λ which is practically independent of σ y 2 was proposed for a fully penetrating well by indelman et al 1996 based on the foa in the present case it becomes 11 λ r k eq h k efu k h k efu with the limits λ 1 r 0 and λ 0 r r t r in fig 2 we represent λ r based on the ns as well as the foa the latter is a fair approximation of the numerical results especially in the vicinity of the source it is seen that transition occurs to λ 0 at r t r 0 8 for the ns while for the foa r t r 1 6 indeed the ns results are relatively close each other and can be approximated quite accurately by the unique λ exp 6 r the application of this simple result to identification of statistical parameters from h measurements will be illustrated in section 5 moving to the derivation of the random k e q h moments an intermediate step toward computation of k e q h by the foa 8 was the calculation of σ h 2 the head variance as already mentioned its determination by the foa is fraught with difficulties we have represented in fig 3 the ns based dimensionless σ h 2 σ y 2 h 0 2 which is independent of σ y 2 for the foa it is seen that indeed the results become close for σ y 2 0 5 while σ h 2 depends in a highly nonlinear fashion on σ y 2 0 5 a somewhat unexpected result is that σ h 2 σ y 2 h 0 2 is close to zero for r 0 6 thus ergodicity for h i e h h is achieved quite close to the source which is again a result of important practical implications next we have represented in fig 4 the dependence of k e q h k g on r based on the ns similarly to fig 1 we can discern the existence of two zones the inner one in which k e q h k g k a k g exp σ y 2 2 at r 0 drops to kefu kg for r t r 0 2 σ y 2 0 2 and r t r 0 3 σ y 2 4 and then levels off in the outer zone the foa result is based on eq 8 in which we have substituted the ns based values of σ h 2 σ y 2 h 0 2 for σ y 2 0 2 fig 3 it is seen that the foa result differs significantly from the ones based on ns for σ y 2 1 subsequently we represent in fig 5 the dependence of the coefficient of variation divided by σy c v k e q h σ y σ k e q k e q h σ y upon r it is seen that the ns lead to a practically unique curve the impact of σy being filtered out the foa graph which is quite close to the ns is underlain by eq 8 in which σ h 2 is based on the ns for σ y 2 0 2 fig 3 it is seen that c v k e q h σ y drops quickly from the asymptotic value of unity that corresponds to the foa from section 3 1 c v k e q h σ k e q k e q h exp σ y 2 1 1 2 which at first order is equal to σy at r 0 to c v k e q h σ y 0 08 for r 1 and to 0 02 for r 3 a topic of interest in applications is the impact of conditioning of h by its measured value hw equal to h 0 of the numerical solution at rw assuming that h is multi gaussian consistent with foa it is easy to check e g dagan 1989 that the mean head conditioned on hw denoted as h r c is given by the simple expression 12 h r c h r ρ h r w r σ h r σ h r w h w h r w where ρh rw r is the autocorrelation of hydraulic head at the source and at a generic location r while the variance σ h 2 was previously discussed we represent in fig 6 the ns based covariance between h rw and h r it is seen that the impact of σ y 2 is filtered out and that of the measured head is limited to r i 1 since the ratio σh r σh rw is typically very small see fig 3 inspection of expression 12 and the results presented here suggest that the impact of conditioning at the source on h r is also very small this result is of definite interest for potential applications and confirms the findings by castagna and bellin 2009 in the inversion of a synthetic cross well hydraulic tomography example 5 application illustration identification of geostatistical parameters we envision here a simple inverse procedure for the inference of relevant geostatistical parameters of y namely kg σ y 2 and i the procedure is based on a set of point like sources along the vertical which is similar to hydraulic tomography configuration we emphasize that what is given here is a proof of concept based on a synthetic experiment and with limited number of measurements while a more thorough validation is needed before applying the proposed methodology to full scale experimental data this example suffices to show the potential merits of the proposed approach the setup consists of two vertical wells located at horizontal distance δ each well has nw point like sources along it at at equal distance δ z thereby totalizing 2nw points water is pumped at rate q in one of the sources and after reaching steady flow piezometric head is measured in all sources providing a set of 2nw hydraulic heads at the 2nw relative distances ri of the sources from the pumping one the procedure is repeated for all the sources providing a set of 2nw 2 head values each of them characterized by a distance from the pumping source that have generated it then the head values characterized by the same distance ri are averaged to provide an approximation to the mean head h i at all the possible distances among the emitting and receiving elements the averaged heads are then introduced into 3 to calculate geometric mean k e q h for each distance ri and the resulting set of values is fitted by expression 11 the fitting provides the three parameters kg σ y 2 i on which the terms λ kefu and kh appearing in 11 depend for λ we have employed the expression λ exp 6 r i i as discussed in the previous section we emphasize that the type of data needed for the procedure is similar to the one obtained in a hydraulic tomography experiment hence it can provide estimates of the main statistical parameters of y ln k with a different procedure from the one commonly used in tomography but employing a similar set of data it should be mentioned that indelman 2001 envisioned an inference methodology based on data collected in a single well in a configuration called well dipole and with emitters and receivers on same well by the foa however such a procedure is prone to lead to highly uncertain identified parameters in view of the results obtained here for the more comprehensive cross well configuration the procedure is illustrated by assuming a conductivity field similar to the one of borden site e g sudicky 1986 with representative values the geostatistical parameters k g 10 4 m s σ y 2 0 5 and the equivalent i 4 m the assumed distances between wells and sources are δ 6 m and δ z 1 m respectively the head at the wells are calculated by numerical simulations along the scheme previously discussed in section 3 2 in order to provide an assessment of the uncertainty of the estimates a monte carlo procedure was performed generating 400 independent realizations of the pumping scheme three different number of sources per each of the two wells were adopted with n w 3 5 7 the same exercise was carried out for the more heterogeneous scenario σ y 2 1 in the attempt to test the foa analytical solution beyond its expected range of validity the results are displayed in table 1 where both the mean and standard deviation sd of the ratio between inferred and input geostatistical parameters are given the tilde indicates the inferred parameter it is seen that the proposed inversion methodology provides realistic estimates of the geostatistical parameters in particular the inference of kg is the most robust with a relatively low sd in all cases increasing the number of wells nw leads to a general decrease of the sd as expected the parameter inference is prone to more uncertainty for the other parameters σ y 2 and i for which the sd is generally large it is seen that the inference of i is the most problematic with an apparent systematic overestimation of around 1 25 and a significant sd this confirms what found by similar approaches for the parameters inference from aquifer tests e g firmani et al 2006 in any case the method seems to adequately capture the magnitude of the parameters although the procedure needs further verification and refinements it is promising showing the potential usefulness of simplified solutions for obtaining keq of point like sources in heterogeneous formations that is the main objective of the present work 6 summary and conclusions identification of aquifer conductivity k based on measurements of the head h is a well established procedure e g by pumping tests by fully or partially penetrating wells the straightforward procedure is to use the solution of the direct problem which relates h to k and to derive the latter by a best fit between computed and measured h traditionally the aquifer is regarded as homogeneous and for the common heterogeneous ones k is regarded as representing kefu the effective conductivity in mean uniform natural gradient flow recently the hydraulic tomography procedure has been forwarded e g gottlieb and dietrich 1995 water is pumped injected through short segments along the well e g by using packers and h is measured by pressure transducers along piezometers at a few distances the inversion procedure advanced in the past to identify k distribution in space see e g liu et al 2002 illman et al 2008 cardiff et al 2009 was to cast the flow equations in a numerical form with h and k the values at nodes subsequently the measured h values are used in order to identify k by a best fit by optimization algorithms here we adopt the stochastic approach e g indelman et al 1996 fiori et al 1998 castagna and bellin 2009 chen et al 2019 the y ln k field is modeled as a multi gaussian stationary random field which is characterized by kg σ y 2 and the integral scale i for the assumed isotropic structure then the aim is to identify the parameters and primarily kefu from measured h values as a first step we consider here the steady flow from a source to model the emitters in the tomographic setup whereas a vast body of literature was devoted to deriving the relationship between kefu kg and σ y 2 the more recent developments for the source strongly nonuniform flow e g indelman and abramovich 1994 have determined that a local kef depending on the statistical moments does not exist instead we use here the concept of keq which is defined as k of a homogeneous medium which leads to the same observed h or the average h as the heterogeneous one keq depends on the structure as well as the distance r from the source while attempts were made in the past to derive the dependence of keq kg on r r i by a foa first order approximation in σ y 2 the main contribution of the paper is its numerical computation for a few values of 0 2 σ y 2 4 the main result of the study as revealed for instance by figs 1 2 is that keq kg defined with the aid of h has the localized value kh kg the harmonic mean near the source it grows monotonously in a transition zone of radius r t r and then it levels off at kefu kg the transition zone is smaller r t r 0 7 then the one determined by foa which improves the chances to identify kefu kg in practice on one hand but makes the one of i more difficult on the other besides keq kg we derived the head variance as well as the autocorrelation between the head near the source and at arbitrary r which can be also used for identification purposes last a proof of the concept toward application to hydraulic tomography is illustrated by a synthetic example flow is caused by an arrow of n w 3 5 7 of sources along a line and h is computed at a equal number of stations along an observation well numerical solutions are achieved by generating 400 realizations for values of σ y 2 0 5 1 i 4 m the results for the identified parameters k g σ y 2 i achieved by best fit of keq are displayed in table 1 it reveals that the mean values of the parameters as compared with the input values are identified quite accurately for k g k g and σ y 2 σ y 2 and with an error of around 25 for i i however while the uncertainty as expressed by the standard deviation of the estimate is quite large of the order of the mean for σ y 2 σ y 2 and i i it is relatively small for k g k g while these results are obtained for a synthetic particular case they are encouraging and suggest that the proposed stochastic hydraulic tomography should be pursued by further investigations it is suggested that future work shall consider for instance statistically anisotropic aquifers impact of boundaries influence of conditioning by the measured h and or k and unsteady flow however the acid test shall be provided by comparison with field tests declaration of competing interests the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments ab and af acknowledge funding from the italian ministry of education university and research miur in the frame of the departments of excellence initiative 2018 2022 granted to dicam of the university of trento ab and the dept of engineering of roma tre university af supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2020 103632 appendix a supplementary materials supplementary data s1 supplementary raw research data this is open data under the cc by license http creativecommons org licenses by 4 0 supplementary data s1 
447,this study investigates the effect of heterogeneity on co2 brine two phase flow behavior and capillary trapping at the field scale a model based on macroscopic invasion percolation is developed to simulate co2 migration and trapping in strongly heterogeneous systems with bimodal permeability distributions stochastic simulations are performed on heterogeneous permeability fields generated by considering both transition probability based lithofacies distribution and multi gaussian random fields representative of characteristics often encountered in relevant sedimentary basins the heterogeneity cases of different lithofacies proportions are designed such that they share the same ensemble mean of upscaled permeability over the simulation domain we find that the co2 spreading and trapping is strongly influenced by the heterogeneity the ensemble means of sweep efficiency and domain average co2 saturation after primary drainage show a slight decrease with decreasing sandstone proportion p 1 from 1 0 to 0 6 but a much steeper decline when p 1 further decreases to 0 4 the upscaled two phase flow properties such as the relative permeabilities are also influenced by the lithofacies proportion residual or capillary trapping and its uncertainty is shown to be dependent on the heterogeneity and the choice of trapping models our findings have broad implications within the context of co2 sequestration as the gas spreading and entrapment are the fundamental processes leading to long term storage security keywords geological sequestration capillary trapping macroscopic invasion percolation heterogeneity numerical modeling 1 introduction geological storage of carbon dioxide in saline aquifers is commonly considered as one of the viable techniques to mitigate the impact of co2 emission on the climate ipcc 2005 co2 storage takes place via several trapping mechanisms namely structural trapping residual trapping dissolution trapping and geochemical trapping ipcc 2005 ampomah et al 2016 these trapping mechanisms span different temporal and spatial scales residual or capillary trapping among these mechanisms has been regarded as an important contributor to co2 immobilization krevor et al 2011 rahman et al 2016 zhang et al 2011 within a timespan of several decades this key mechanism relies on capillary forces to immobilize the supercritical co2 phase while laboratory experiments of two phase flow in reservoir rocks at the core scale have been successful in quantifying residual trapping rahman et al 2016 zhang et al 2011 pentland et al 2011 the obtained trapping efficiency does not give a full picture of residual trapping at the field scale mainly due to the inherent heterogeneity across multiple scales in properties of geological formations flow of injected supercritical co2 and the resident brine in the formation rocks constitutes a two phase flow system where the co2 and the brine usually are the non wetting and wetting fluids respectively during co2 injection the brine is displaced giving rise to a drainage process due to the buoyancy effect the co2 plume rises up and forms a pancake shape below a low permeability layer usually a caprock szulczewski et al 2012 huppert and neufeld 2014 after the injection ceases imbibition starts to take place leaving part of the free phase co2 immobilized as a result of capillary actions leading to residual trapping the amount of the supercritical phase trapping by this mechanism depends on a number of formation properties gershenzon et al 2015 soltanian et al 2019 amooie et al 2017 amooie et al 2017 such as intrinsic permeability wettability relative permeability functions capillary pressure functions hysteresis and heterogeneity of the above properties as well as operational factors such as injection pressure amount and strategy herring et al 2016 joodaki et al 2017 ruspini et al 2017 recent reviews of capillary trapping and issues influencing it are given by krevor et al krevor et al 2015 and rasmusson et al rasmusson et al 2018 residual trapping involves two phase flow processes across a range of spatial scales from the pore to the reservoir scale at scales from pore to core experimental studies using microfluidic flow and core flooding as well as numerical simulations have been performed rahman et al 2016 zhang et al 2011 pentland et al 2011 pini and benson 2017 basirat et al 2017 hu et al 2018 at the reservoir scale field testing techniques for quantifying residual trapping are being developed consisting of dedicated sequences of hydraulic thermal and tracer tests zhang et al 2011 rasmusson et al 2014 niemi et al 2018 as well as geophysical techniques saito et al 2006 arts et al 2008 ivandic et al 2015 these techniques have even been implemented at selected field sites especially at frio usa hovorka et al 2006 otway australia laforce et al 2014 and heletz israel niemi et al 2018 field experiments are however expensive and extensive to carry out and by necessity provide site specific information therefore supporting analyses from modeling studies will provide valuable and to some extent more generic information residual trapping of co2 and the preceding co2 migration driven by injection pressure or buoyancy are strongly affected by geological heterogeneity joodaki et al 2017 lengler et al 2010 trevisan et al 2017 doughty and pruess 2004 flett et al 2007 saadatpoor et al 2010 han et al 2010 shamshiri and jafarpour 2012 tian et al 2016 ambrose et al 2008 in numerical modeling of co2 storage the effect of heterogeneity in the hydraulic property i e permeability is usually taken into account by using geostatistical approaches based on multi gaussian fields with different covariance functions doughty and pruess 2004 tian et al 2017 while such an approach is capable of qualitatively capturing some typical features of the process a full understanding may require modeling with a more detailed description of the small scale permeability variability which may have been ignored due to limited grid resolution lengler et al 2010 large uncertainty exists in predictions of co2 migration and trapping tian et al 2017 this issue becomes even more pronounced as hydraulic properties of geological layers are heterogeneous at multiple length scales gershenzon et al 2015 ringrose et al 2008 yang et al 2013 trevisan et al 2015 tidwell and wilson 2000 ni et al 2019 in the presence of spatially varying properties the effective parameters at the large scale can deviate substantially from those at the small scale spatial variability can thus lead to uncertainty in estimates of the storage properties such as injectivity and capacity lengler et al 2010 tian et al 2017 given the fact that in practical applications the sampled part of the rock layers is often only a very small fraction of the formation reservoir under consideration storage formations are usually composed of sedimentary rocks one therefore expects both a spatial distribution of the depositional facies and hydraulic conductivity variability within the facies gershenzon et al 2015 lengler et al 2010 trevisan et al 2017 such variability in hydraulic properties should ideally be described by a bimodal or multimodal statistical distribution depending on the number of depositional facies yang et al 2013 previous works have investigated the effect of bimodal or multimodal heterogeneity on the flow and transport in the porous media e g 11 12 however it remains to be fully understood how the parameters in bimodal or multimodal distributions influence co2 migration and trapping the overall objective of this work is to systematically investigate the effect of heterogeneity on co2 brine two phase flow behavior and capillary trapping for this purpose we develop a modeling methodology based on macroscopic invasion percolation to simulate co2 migration and trapping in strongly heterogeneous systems with bimodal permeability distributions by adopting transition probability based geostatistics stochastic permeability fields are generated in such a way that all heterogeneity cases are equivalent in the mean upscaled permeability we then study the effect of lithofacies proportions and distributions on spreading and residual trapping of co2 using monte carlo stochastic simulations indication of the lithofacies proportions can be determined from borehole data it should be pointed out that it is important to maintain the mean permeability constant in order to make the results comparable this is also the property that is usually easy to measure with simple in situ well tests from the borehole 2 methods in this section we first describe the model used for simulating the co2 injection transport and trapping in heterogeneous formations section 2 1 this is followed by the description of the upscaled properties to be investigated section 2 2 next the simulation cases of various heterogeneities represented by transition probability based geostatistics including how the local properties of the heterogeneous fields are determined section 2 3 and the actual simulation scenarios section 2 4 2 1 modeling two phase flow in highly heterogeneous formations with macroscopic invasion percolation model a number of methods have been developed to simulate co2 migration and trapping at various spatial and temporal scales with the goals related to both theoretical questions and practical issues of site screening operational management capacity estimation and risk assessment niemi et al 2017 often it is computationally restrictive to model co2 brine two phase flow in a strongly heterogeneous medium with a high resolution using numerical simulators based on solving two phase flow partial differential equations here we use an alternative approach based on macroscopic invasion percolation ip yang et al 2013 kueper and mcwhorter 1992 yortsos et al 1993 ioannidis et al 1996 the macroscopic ip algorithm belongs to a class of statistical interface growth models which do not require the global solution of continuum two phase flow partial differential equations we focus on co2 migration and trapping in low velocity regions such as those away from the injection wellbore and especially after the injection ceases macroscopic invasion percolation is different from the original invasion percolation model wilkinson and willemsen 1983 while in the latter approach each site or bond is assigned a microscale pore or pore throat dimensions in the former each site is assigned a local permeability porosity and capillary pressure saturation function another important difference is that macroscopic invasion percolation allows for bi continua of fluids in each site node kueper and mcwhorter 1992 application of invasion percolation approaches requires a low flow rate with the capillary effects dominating over the viscous effects such capillary dominated flow condition can be achieved in the limit of small 10 7 capillary number nca µnv σ where v is the darcy velocity µn is the viscosity of the supercritical co2 and σ is the interfacial tension lenormand et al 1988 given that we focus on long term migration and trapping after the injection phase capillary dominated flow condition is usually met yang et al 2013 the model developed here is based on our previous work yang et al 2013 with slight modification here we provide a brief description the model simulates fluid fluid displacement on a 2d domain ω starting with a fully saturated with brine initial condition primary drainage is simulated by allowing the supercritical co2 to invade the domain from a boundary at a specified external pressure difference pex i e equivalent to capillary pressure at the scale of whole domain at each step the supercritical co2 may invade available cells i e cells that are neighboring to the invaded ones provided that the pressures satisfy the following condition 1 p e x 1 τ max i f p e x p e n i p e n where p en is the capillary entry pressure of a candidate cell under evaluation f denotes the set of all available cells at the front and p en i denotes the capillary entry pressure of cell number i in set f the parameter τ is introduced to allow for multiple sites to be invaded simultaneously at each step when τ 0 only the cell next to the front with the minimum capillary entry pressure is invaded and thus the model reduces to the classical invasion percolation algorithm when τ 1 all available cells next to the front with entry pressure below the external pressure are invaded here τ is offset to 0 4 a value determined from a previous study with a detailed comparison with the continuum two phase flow models yang et al 2013 having invaded a cell the non wetting phase co2 continues to invade the neighboring cells as long as the invading criterion eq 1 is met the invaded cells can be determined after finishing a sweep of the entire domain then the local saturations of the invaded cells are computed using the following equation brooks and corey 1964 2 s e p e x p e n γ where γ is the brooks corey pore size distribution parameter and se is an effective wetting fluid saturation se sw swr 1 swr with s w being the local wetting phase saturation after primary drainage and s wr the local irreducible wetting saturation it is assumed that s wr is a known parameter the local co2 saturation s n i or initial nonwetting phase saturation after primary drainage is calculated as s n i 1 s w note that here the capillary pressure saturation relation can also be replaced by functions of other types such as a van genuchten function after primary drainage we compute the imbibition step to obtain the trapped non wetting phase saturation for each cell s n r here we determine the locally trapped co2 saturation using the ordinary percolation approach ioannidis et al 1996 which assumes that all cells are accessible to the wetting phase during imbibition this is different from the more complex approach recently proposed by nooruddin blunt nooruddin and blunt 2018 which checks connectivity of cells for the imbibition step assuming that when a cell becomes surrounded by the cells of negligible nonwetting phase relative permeability the cell loses connectivity with its current nonwetting phase considered as trapped no matter how high the saturation is without consideration of the connectivity we evaluate the co2 trapping using the widely used the land land 1968 and spiteri trapping models spiteri et al 2008 3 s n r s n i 1 γ s n i s n r α s n i β s n i 2 where γ is the land land 1968 trapping parameter and α and β are empirical parameters in spiteri et al spiteri et al 2008 these parameters can be determined from laboratory experiments krevor et al 2012 the average trapped non wetting phase saturation over the entire domain ω s n r is 4 s n r ω ϕ s n i ω ϕ the macroscopic invasion percolation model is implemented using an efficient binary tree algorithm to allow for a large number of simulations with stochastically generated permeability fields conventional algorithms traverse the entire domain at each invasion step to identify the available interface sites and then to find the most favorable available site this is computationally wasteful since only a small change occurs at the interface at each time step knackstedt et al 2000 this problem can be solved by storing the interface sites in a dynamic list sorted in ascending order according to the capillary entry pressure knackstedt et al 2000 masson and pride 2014 this dynamic list can be updated efficiently by insertion and deletion operations while maintaining the order at each time step here dynamic updating is implemented by adopting a binary search tree data structure to store the list allowing the insertion and deletion operations to be performed in ln n time with n being the size of the list knackstedt et al 2000 masson and pride 2014 2 2 breakthrough pressure effective permeability and upscaled relative permeability using the macroscopic invasion percolation model described above we can also obtain the breakthrough pressure p bt i e the critical external pressure needed for the non wetting phase to reach the outlet boundary to do this the invasion at each step is set to occur at only the cell with the smallest entry pressure along the invading front this is equivalent to assigning the parameter τ 1 in the simulations the set of invaded cells at breakthrough is denoted c the breakthrough pressure is then the minimum entry pressure of set c 5 p b t min i c p e n i the superscript i is the cell index in set c the breakthrough pressure can be understood as an upscaled capillary entry pressure for a heterogeneous domain the effective permeability for a heterogeneous field can be obtained numerically by solving the single phase darcy based flow equation over the domain for an arbitrary pressure gradient 6 k μ n p 0 where p is the pressure field to be solved and k is the local permeability this is done in advance of the co2 invasion simulations the viscosity µn is set to 5 25 10 5 pa s corresponding to the viscosity of supercritical co2 at representative reservoir conditions note that permeability is a tensor but here we focus only on the direction along the main displacement the effective permeability k eff is calculated by 7 k e f f q μ n l a p i n l e t p o u t l e t where p inlet and p outlet are the specified inlet and outlet pressures respectively a is the cross section area l is the length of the domain and q is the integrated volumetric flow rate for the cross section obtained from the solutions of pressure and velocity fields the upscaled relative permeability can also be computed for a given saturation field and local hydraulic properties in this study we calculate the upscaled end point relative permeability i e at the end of primary drainage for the non wetting phase using the single phase flow averaging method eichel et al 2005 that is the wetting phase is assumed to be stationary for the calculation of upscaled non wetting phase relative permeability the end point relative permeability to the wetting phase can be computed similarly but will not be presented here we impose a given pressure gradient along the main displacement direction and then numerically solve the pressure equation for the non wetting phase only 8 k k r n μ n p 0 where krn is the local relative permeability calculated using the local saturations as brooks and corey 1964 9 k r n 1 s e 2 1 s e 1 2 γ the upscaled end point relative permeability k r n e the ratio between the effective permeability at the end point saturation and that at the saturated case is calculated by 10 k r n e 1 k e f f q μ n l a p i n l e t p o u t l e t here q is the obtained volumetric flow rate similar as defined above from solving eq 8 2 3 local properties we consider two lithofacies materials namely sandstone and siltstone in the two dimensional heterogeneous domains 50 m 100 m due to spatial arrangement of the facies and the random distribution of hydraulic properties within each facies the permeability follows a bimodal distribution we adopt the method of lu and zhang lu and zhang 2002 for generating the multimodal heterogeneous media first a hundred markovian random fields of the lithofacies with specified proportions p 1 p 2 and mean lengths l 1 l 2 are generated using transitional probability geostatistical software t progs developed by carle and fogg carle and fogg 1996 the mean lengths are parameters that are roughly analogous to range in variogram modeling a mean length in the vertical direction corresponds to a mean thickness of a lithofacies lu and zhang lu and zhang 2002 showed that the transition rate matrix r follows this format 11 r 1 l 1 1 l 1 p 1 p 2 l 1 p 1 p 2 l 1 then for each lithofacies a hundred realizations of two dimensional multi gaussian fields with specified correlation lengths are generated using hydro gen a public domain random field generator bellin and rubin 1996 finally composite bimodal heterogeneous fields are generated through combination of each markovian indicator field with the multi gaussian fields for the two lithofacies after generating the permeability fields we scale the local capillary entry pressure using reference values from the literature according to the leverett scaling leverett 1941 12 p e n σ k ϕ 1 2 2 4 simulation scenarios simulation scenarios are designed with the objective of studying gas migration and capillary trapping in the presence of bimodal heterogeneities we focus on the effect of material proportions on capillary trapping capacity and effective two phase flow properties such as breakthrough pressure effective permeability and upscaled relative permeability at the field scale we consider five cases each with 100 heterogeneous fields each field has 400 200 grids it should be emphasized that these permeability fields are generated in such a way that the mean effective upscaled permeability keff over the 100 realizations is the same keff 1 26 10 13 m2 for all five cases of different sandstone proportions fig 1 shows four example realizations of heterogeneous permeability fields the histograms of permeability for these individual example fields are shown in fig 2 with decreasing sandstone proportion increasing siltstone percentage the permeability distribution is more and more skewed when p 1 0 4 p 2 0 6 two peaks are clearly visible fluid displacement in the horizontal x y plane is simulated with a specified external pressure pex 10000 pa given the mean effective permeability 1 26 10 13 m2 and the interfacial tension 0 036 n m the capillary number nca corresponding to the imposed hydraulic gradient 0 01 is on the order of 10 9 which is consistent with the capillary dominated regime the main displacement direction is along the x axis the transverse boundaries are assigned impermeable conditions gravity effects are not considered which is reasonable for the far end of the co2 plume migration the simulations of primary drainage are run until all available sites satisfying the invasion criterion are invaded the calculation of co2 trapping uses the saturation distribution obtained through the primary drainage simulations as initial co2 saturations the statistical parameters used for producing the random permeability fields are listed in table 1 with the different cases table 2 lists the local scale reference parameters which are roughly based on laboratory experiments krevor et al 2012 al yaseri et al 2017 scuderi et al 2015 for simplicity the porosity is assumed to be 0 2 uniformly for both lithofacies the parameters for calculating co2 trapping are obtained from an experimental study krevor et al 2012 two different well established models are used to describe the relation between the trapped final co2 saturation and the initial co2 saturation the relationships with the two models and for the two lithofacies studied here are shown in fig 3 3 results 3 1 breakthrough pressure leverett scaling relationship is often used to collapse the often scattered capillary pressure saturation data obtained for samples of different porosity and permeability and using different fluids to a master curve this relationship makes it convenient in continuum two phase flow numerical simulations in a heterogeneous reservoir here our mip model assumes that leverett scaling eq 12 is valid at the local scale i e the local entry pressure is spatially varying and scaled with the spatially varying permeability one of the goals is to check whether the upscaled entry pressure based on the breakthrough pressure as described above and the effective permeability of the heterogeneous domain also follow the scaling rule to achieve this goal we compute the effective permeability k eff and the breakthrough pressure p bt for the heterogeneous fields using the method described in section 2 fig 4 shows that generally p bt increases with decreasing k eff or increasing 1 k eff for all sandstone proportions from 0 4 to 1 0 visual inspection shows that the smaller the sandstone proportion the larger the scatter of breakthrough pressure data the simulation data are fitted with a linear relationship between p bt and 1 k eff relative residuals of the fitting defined as the ratio between euclidian norms of the fit residual and the p bt data are 0 06 0 07 0 13 and 0 18 for sandstone proportions of 1 0 0 8 0 6 and 0 4 respectively for large sandstone proportions p 1 0 8 the leverett scaling seems to work well also for the upscaled systems the relative residual increases with sandstone proportion with the value for the case p 1 0 4 is three times of that for p 1 1 0 this suggests that application of the leverett scaling relationship for numerical simulations may bring much larger uncertainties for heterogeneous systems with stronger bimodality in permeability distribution 3 2 co2 saturation at the end of primary drainage fig 5 presents the co2 saturation s n i fields after primary drainage for four example realizations corresponding to four different sandstone proportions within the invaded regions co2 saturation is higher for cells with higher permeability lower entry pressure qualitatively as p 1 decreases the total co2 mass is more and more concentrated in high permeability channels the sweep efficiency defined as the number of cells swept by co2 normalized by the total number of cells in the domain is 0 70 0 67 0 55 and 0 48 for the four example simulations shown in fig 5 the ensemble average arithmetical mean of 100 realizations of sweep efficiency shows a clear dependence on the sandstone proportion being 0 69 0 66 0 59 and 0 38 for p 1 1 0 0 8 0 6 and 0 4 respectively the domain average co2 saturation s n i ω ϕ s n i ω ϕ after primary drainage for all different sandstone proportions are shown in fig 6 it can be seen that for p 1 0 6 the median value of s n i 0 37 0 38 does not vary with p 1 significantly but for p 1 0 4 the median value of s n i over 100 simulations decreases substantially to about 0 27 the inter realization variability of s n i is also much larger when p 1 0 4 and 0 5 than the other cases for instance when p 1 0 4 the standard deviation of s n i for the 100 realization sample is 0 10 which is significantly higher than the standard deviation 0 04 for p 1 1 0 3 3 end point relative permeability the end point relative permeability at the end of primary drainage k r n e is computed because it is an important parameter for large scale numerical simulations especially when hysteresis constitutive relationships are used fig 7 shows the arithmetic mean and standard deviation of k r n e over 100 simulations for each of the five sandstone proportions similarly to s n i for p 1 0 6 the ensemble mean of k r n e arithmetic average of 100 realizations does not vary with p 1 significantly vary between 0 33 and 0 35 but for p 1 0 6 the ensemble average drops considerably the arithmetic mean of k r n e is 0 19 and 0 13 for p 1 0 5 and 0 4 respectively this result indicates that the upscaled relative permeability is not affected by the sandstone proportion above 0 6 and that there is a transition in the flow connectivity between p 1 0 6 and p 1 0 5 this will be further explained in the discussion section 3 4 residual trapping of co2 after primary drainage the co2 saturation s n i distribution and its upscaled value s n i are obtained see section 3 2 the large scale imbibition process produces residual capillary trapping of co2 assuming imbibition is an ordinary percolation process ioannidis et al 1996 we calculate the local residual trapping using both the land land 1968 and the spiteri et al spiteri et al 2008 models we focus on the impact of bimodal heterogeneity on residual trapping of co2 for appropriate comparison the five cases of sandstone proportions have the same ensemble average of effective permeability geometric mean of 100 realizations fig 8 presents four example fields of trapped co2 saturation s n r obtained by using the spiteri et al spiteri et al 2008 model based on the initial co2 saturation s n i after primary drainage for the five cases of sandstone proportions given that the parameters for residual trapping in sandstone produce a monotonically increasing relationship between s n r and s n i see fig 3 and that most of the co2 phase is in the sandstone the cells with higher initial co2 saturation get also higher trapped saturation this leads to trapped saturation fields that resembles the initial co2 saturation fields the trapped co2 mass is distributed mostly in the sandstone decreasing the sandstone proportion results in higher local trapped saturation values but the domain average trapped co2 saturation generally decreases with decreasing p 1 for example s n r 0 28 0 27 0 23 and 0 19 respectively for p 1 1 0 0 8 0 6 and 0 4 for the four examples shown in fig 8 the domain average trapped co2 saturation for all simulations of different sandstone proportions are shown in fig 9 the trapped co2 saturations are calculated both using the spiteri et al spiteri et al 2008 function and using the land land 1968 function generally the ensemble mean s n r of 100 realizations decreases with decreasing sandstone proportion however only a slight decrease of s n r about 10 is observed when p 1 decreases from 1 0 to 0 6 a significantly larger drop occurs as p 1 further decreases to 0 5 and 0 4 where s n r 0 17 and 0 15 respectively for the calculation based on the spiteri et al model the results based on the spiteri et al and the land trapping models are similar but the land trapping model generally produces less residual trapping by 12 13 which is due to the fact that in our study the local s n r is smaller in the land model than in the spiteri et al model for sandstone see fig 3 uncertainty in the trapped saturation s n r is also influenced by the sandstone proportion for p 1 0 8 the standard deviation of s n r over one hundred stochastic simulations is relatively small 0 03 when p 1 decreases 0 6 the standard deviation of s n r increases to 0 044 for p 1 0 4 the standard deviation is largest 0 064 of the five cases 4 discussion as in other subsurface multi phase problems such as oil gas recovery in petroleum reservoirs and unsaturated flow in the vadose zone multi scale heterogeneity imposes significant challenges for predictive modeling of carbon dioxide migration and trapping in applications of geological sequestration in this study we consider heterogeneity that results both from lithofacies scale rock type distribution and from fine scale variability within the facies this type of heterogeneity can lead to multi modal distributions of hydraulic properties which are important for the flow behavior but have been under examined for multi phase flow in the subsurface gershenzon et al 2015 trevisan et al 2017 yang et al 2013 to tackle this issue we combine transition probability based markovian indicator random fields and multi gaussian random fields to generate bimodal distributions of permeability and of capillary entry pressure an efficient model based on macroscopic invasion percolation is developed to investigate the effect of heterogeneity on the co2 migration and trapping this methodology enables monte carlo simulations which would have been impractical when employing the conventional approaches based on solving the continuum scale two phase flow equations e g tough2 eco2n this approach also allows for investigation of uncertainties for different cases through computing the ensemble statistics our results show that the relative proportions of lithofacies significantly affect the co2 migration and residual trapping we consider five cases of lithofacies proportions for the sandstone siltstone combination each with 100 equally probable random permeability fields it should be emphasized that these cases are designed to have the same value for the ensemble mean of effective permeability this is done by slightly adjusting the geostatistical parameters namely the categorical means μ 1 and μ 2 and categorical standard deviations σ 1 and σ 2 by forcing the same ensemble mean of effective permeability we exclude the possible effect resulting from difference in the upscaled absolute permeability of the entire heterogeneous domain we find that generally the ensemble means of sweep efficiency and domain averaged co2 saturation at the end of primary drainage show a decreasing trend with decreasing sandstone proportion fig 5 6 in other words the higher the proportion of sandstone the higher the co2 saturation at the end of the drainage the trend however is not linear and there is a change in the behavior trend at p 1 0 6 when p 1 decreases from 1 0 to 0 6 only a slight decrease in co2 saturation in the two ensemble means is seen when p 1 further decreases to 0 5 and 0 4 a drastic decline is observed this kind of critical behavior at p 1 0 6 can be explained by the connectedness of the sandstone material from the inlet to the outlet of the domain as quantified by the percolation threshold criteria according to percolation theory stauffer and aharony 2018 a proportion p 1 of 0 6 is just above the theoretical critical threshold 0 593 in 2d for the sandstone to span the domain therefore for cases with p 1 0 6 all the sandstone material remains well connected and are easily accessible to the invading co2 whereas for p 1 0 5 and 0 4 the high permeability sandstone forms isolated regions surrounded by the relatively low permeability siltstone causing the invading co2 to ignore some of the sandstone inclusions the considerably smaller end point relative permeability k r n e at p 1 0 4 fig 7 can also be explained by the fact that the invading co2 will inevitably flow through part of siltstone which has a lower permeability than the sandstone the results also show that the variability in domain averaged saturation as can be quantified by the inter realization variability in s n i is significantly larger for p 1 0 4 and 0 5 than for p 1 0 6 for instance the difference in s n i between 25th and 75th percentiles is 0 159 for p 1 0 4 and 0 025 for p 1 0 6 see fig 6 the large variability in s n i for p 1 0 4 and 0 5 is attributed to two effects 1 that the sandstone as the minor part of the domain in the case of small proportion becomes the discontinuous lithofacies in the form of inclusions and 2 the randomness in accessibility of the sandstone by the co2 due to the random spatial arrangement of the sandstone inclusions in the stochastic realizations with respect to the co2 migration pathways substantial uncertainty arises in the percentage of sandstone material accessed by the invading co2 the domain averaged trapped co2 saturation s n r is shown to be influenced by the lithofacies proportion and the trapping model selected fig 8 9 similar to the initial co2 saturation at the end of primary drainage the ensemble mean of s n r decreases substantially as p 1 decreases from 0 6 to 0 4 this is in agreement with flett et al flett et al 2007 who investigated sandstone shale binary systems but did not consider fine scale heterogeneity within lithofacies though in addition the inter realization variability is significantly larger in the case of p 1 0 4 this is attributed to the uncertainty in s n i discussed above the simulations also indicate that the domain averaged trapped co2 saturation s n r is dependent on the chosen trapping model even though we have used two models derived from the same experimental data krevor et al 2012 our results evidently demonstrate that both the multi scale heterogeneity and the choice of empirical trapping models can induce considerable uncertainty in residual trapping of co2 the order of magnitude of the difference between the cases p 1 1 0 and p 1 0 4 i e about 0 1 is similar to what has been observed when comparing residual trapping saturation as determined from field experiments to those determined form laboratory data joodaki et al 2020 our results are also used to examine the applicability of the commonly used leverett scaling relationship in numerical simulation of multiphase flow through heterogeneous media we show that even if the leverett scaling holds locally for the permeability capillary pressure relation it is not necessarily a good representation of the link between upscaled permeability and capillary entry pressure especially when the sandstone proportion is small 0 4 this result is consistent with previous works leverett s original work leverett 1941 demonstrated that the scaling is satisfactory on four clean sands but not on two clayey sands then brown brown 1951 has shown that the j function is only suitable for scaling core samples with similar lithology recent experimental studies ni et al 2019 krevor et al 2012 have also clearly shown that the capillary pressure curves are similar for the same rock type and different between different rock types here our numerical modeling has provided a quantitative approach for evaluating the appropriateness of the leverett scaling in rock formations of varying lithofacies proportions it should be pointed out that our work has some limitations firstly we consider flow problems in 2d while actual reservoirs are all 3d in reality cubic lattices have a higher coordination number 6 and a lower site percolation threshold 0 312 than 2d square lattices nooruddin and blunt 2018 one would expect the 2d results to differ from 3d percolation results it is thus of interest to compare simulation results between 2d and 3d however this is computationally challenging the main difficulty is not in performing the invasion percolation simulations but in stochastic generation of a large number of sufficiently high resolution bimodal permeability distributions in 3d that are consistent with the geostatistical approach section 2 3 thus this comparison cannot yet be done nevertheless we expect the 2d results and 3d results to show the same qualitative trend in terms of the effect of lithofacies proportion on e g end point relative permeability and residual trapping even though the corresponding values would differ between 2d and 3d for example it is reasonable to speculate that in 3d the sharp change in ensemble mean end point relative permeability and residual trapping as p 1 decreases could occur at p 1 around 0 31 secondly gravity plays a critical role in co2 migration and trapping at the field scale but the gravity effects are ignored in this study even though they can be accounted for trivially in the ip model this can be done by adding a coordinate dependent pressure term to the stochastically generated entry pressure p en our work here focuses on the effect of bimodal heterogeneity from core to block scale on large scale flow and trapping properties laboratory measurements of residual trapping parameters are often used in field scale numerical simulations the scale effects in the transition from core to basin scale is often overlooked one of the important points we want to make in this study is that the macroscale residual trapping properties may differ significantly from the core scale measurements obtained in the laboratory our results can thus be used to inform the basin scale numerical models which will eventually take into account the gravity effects 5 conclusions to sum up we have studied the effect of heterogeneity on co2 brine two phase flow behavior and capillary trapping in the field scale a modeling methodology based on macroscopic invasion percolation has been developed to simulate co2 migration and trapping in strongly heterogeneous systems with bimodal permeability distributions stochastic simulations of co2 migration and trapping are performed on heterogeneous permeability fields generated by considering both transition probability based lithofacies distribution and multi gaussian random fields the heterogeneity cases are designed so that they have the same ensemble mean of upscaled permeability to allow a proper comparison of the results we find that the co2 spreading and trapping is strongly influenced by the heterogeneity in particular the conclusions are summarized as follows 1 the ensemble means of sweep efficiency and domain average co2 saturation at the end of primary drainage co2 injection show a slight decrease with decreasing sandstone proportion p 1 from 1 0 to 0 6 but a much sharper decline when p 1 further decreases to 0 4 this is mainly attributable to dependence of the connectedness of the sandstone material on the lithofacies proportion 2 the upscaled two phase hydraulic properties are dependent on the lithofacies proportion the leverett scaling relationship between upscaled permeability and capillary entry pressure may not be applicable especially when the sandstone proportion is small p 1 0 4 3 the amount of residual trapping decreases on average with decreasing sandstone proportion both the multi scale heterogeneity and the choice of empirical trapping models can induce considerable uncertainty in residual trapping of co2 our findings in this work have broad implications within the context of co2 sequestration as the gas spreading and entrapment are the fundamental processes leading to long term storage security the results presented here can be used to give guidance concerning the effect of different material fractions on residual trapping in situ future work will be devoted to quantifying uncertainty in co2 trapping at the reservoir basin scale yang et al 2015 tian et al 2016 cavanagh and haszeldine 2014 influenced both by heterogeneity across multiple spatial scales and by operational parameters credit authorship contribution statement zhibing yang conceptualization methodology software investigation formal analysis writing original draft yi feng chen conceptualization resources writing review editing auli niemi conceptualization supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work was supported by the national natural science foundation of china grant number 41877203 and 51925906 and the swedish energy agency grant no 43526 1 
447,this study investigates the effect of heterogeneity on co2 brine two phase flow behavior and capillary trapping at the field scale a model based on macroscopic invasion percolation is developed to simulate co2 migration and trapping in strongly heterogeneous systems with bimodal permeability distributions stochastic simulations are performed on heterogeneous permeability fields generated by considering both transition probability based lithofacies distribution and multi gaussian random fields representative of characteristics often encountered in relevant sedimentary basins the heterogeneity cases of different lithofacies proportions are designed such that they share the same ensemble mean of upscaled permeability over the simulation domain we find that the co2 spreading and trapping is strongly influenced by the heterogeneity the ensemble means of sweep efficiency and domain average co2 saturation after primary drainage show a slight decrease with decreasing sandstone proportion p 1 from 1 0 to 0 6 but a much steeper decline when p 1 further decreases to 0 4 the upscaled two phase flow properties such as the relative permeabilities are also influenced by the lithofacies proportion residual or capillary trapping and its uncertainty is shown to be dependent on the heterogeneity and the choice of trapping models our findings have broad implications within the context of co2 sequestration as the gas spreading and entrapment are the fundamental processes leading to long term storage security keywords geological sequestration capillary trapping macroscopic invasion percolation heterogeneity numerical modeling 1 introduction geological storage of carbon dioxide in saline aquifers is commonly considered as one of the viable techniques to mitigate the impact of co2 emission on the climate ipcc 2005 co2 storage takes place via several trapping mechanisms namely structural trapping residual trapping dissolution trapping and geochemical trapping ipcc 2005 ampomah et al 2016 these trapping mechanisms span different temporal and spatial scales residual or capillary trapping among these mechanisms has been regarded as an important contributor to co2 immobilization krevor et al 2011 rahman et al 2016 zhang et al 2011 within a timespan of several decades this key mechanism relies on capillary forces to immobilize the supercritical co2 phase while laboratory experiments of two phase flow in reservoir rocks at the core scale have been successful in quantifying residual trapping rahman et al 2016 zhang et al 2011 pentland et al 2011 the obtained trapping efficiency does not give a full picture of residual trapping at the field scale mainly due to the inherent heterogeneity across multiple scales in properties of geological formations flow of injected supercritical co2 and the resident brine in the formation rocks constitutes a two phase flow system where the co2 and the brine usually are the non wetting and wetting fluids respectively during co2 injection the brine is displaced giving rise to a drainage process due to the buoyancy effect the co2 plume rises up and forms a pancake shape below a low permeability layer usually a caprock szulczewski et al 2012 huppert and neufeld 2014 after the injection ceases imbibition starts to take place leaving part of the free phase co2 immobilized as a result of capillary actions leading to residual trapping the amount of the supercritical phase trapping by this mechanism depends on a number of formation properties gershenzon et al 2015 soltanian et al 2019 amooie et al 2017 amooie et al 2017 such as intrinsic permeability wettability relative permeability functions capillary pressure functions hysteresis and heterogeneity of the above properties as well as operational factors such as injection pressure amount and strategy herring et al 2016 joodaki et al 2017 ruspini et al 2017 recent reviews of capillary trapping and issues influencing it are given by krevor et al krevor et al 2015 and rasmusson et al rasmusson et al 2018 residual trapping involves two phase flow processes across a range of spatial scales from the pore to the reservoir scale at scales from pore to core experimental studies using microfluidic flow and core flooding as well as numerical simulations have been performed rahman et al 2016 zhang et al 2011 pentland et al 2011 pini and benson 2017 basirat et al 2017 hu et al 2018 at the reservoir scale field testing techniques for quantifying residual trapping are being developed consisting of dedicated sequences of hydraulic thermal and tracer tests zhang et al 2011 rasmusson et al 2014 niemi et al 2018 as well as geophysical techniques saito et al 2006 arts et al 2008 ivandic et al 2015 these techniques have even been implemented at selected field sites especially at frio usa hovorka et al 2006 otway australia laforce et al 2014 and heletz israel niemi et al 2018 field experiments are however expensive and extensive to carry out and by necessity provide site specific information therefore supporting analyses from modeling studies will provide valuable and to some extent more generic information residual trapping of co2 and the preceding co2 migration driven by injection pressure or buoyancy are strongly affected by geological heterogeneity joodaki et al 2017 lengler et al 2010 trevisan et al 2017 doughty and pruess 2004 flett et al 2007 saadatpoor et al 2010 han et al 2010 shamshiri and jafarpour 2012 tian et al 2016 ambrose et al 2008 in numerical modeling of co2 storage the effect of heterogeneity in the hydraulic property i e permeability is usually taken into account by using geostatistical approaches based on multi gaussian fields with different covariance functions doughty and pruess 2004 tian et al 2017 while such an approach is capable of qualitatively capturing some typical features of the process a full understanding may require modeling with a more detailed description of the small scale permeability variability which may have been ignored due to limited grid resolution lengler et al 2010 large uncertainty exists in predictions of co2 migration and trapping tian et al 2017 this issue becomes even more pronounced as hydraulic properties of geological layers are heterogeneous at multiple length scales gershenzon et al 2015 ringrose et al 2008 yang et al 2013 trevisan et al 2015 tidwell and wilson 2000 ni et al 2019 in the presence of spatially varying properties the effective parameters at the large scale can deviate substantially from those at the small scale spatial variability can thus lead to uncertainty in estimates of the storage properties such as injectivity and capacity lengler et al 2010 tian et al 2017 given the fact that in practical applications the sampled part of the rock layers is often only a very small fraction of the formation reservoir under consideration storage formations are usually composed of sedimentary rocks one therefore expects both a spatial distribution of the depositional facies and hydraulic conductivity variability within the facies gershenzon et al 2015 lengler et al 2010 trevisan et al 2017 such variability in hydraulic properties should ideally be described by a bimodal or multimodal statistical distribution depending on the number of depositional facies yang et al 2013 previous works have investigated the effect of bimodal or multimodal heterogeneity on the flow and transport in the porous media e g 11 12 however it remains to be fully understood how the parameters in bimodal or multimodal distributions influence co2 migration and trapping the overall objective of this work is to systematically investigate the effect of heterogeneity on co2 brine two phase flow behavior and capillary trapping for this purpose we develop a modeling methodology based on macroscopic invasion percolation to simulate co2 migration and trapping in strongly heterogeneous systems with bimodal permeability distributions by adopting transition probability based geostatistics stochastic permeability fields are generated in such a way that all heterogeneity cases are equivalent in the mean upscaled permeability we then study the effect of lithofacies proportions and distributions on spreading and residual trapping of co2 using monte carlo stochastic simulations indication of the lithofacies proportions can be determined from borehole data it should be pointed out that it is important to maintain the mean permeability constant in order to make the results comparable this is also the property that is usually easy to measure with simple in situ well tests from the borehole 2 methods in this section we first describe the model used for simulating the co2 injection transport and trapping in heterogeneous formations section 2 1 this is followed by the description of the upscaled properties to be investigated section 2 2 next the simulation cases of various heterogeneities represented by transition probability based geostatistics including how the local properties of the heterogeneous fields are determined section 2 3 and the actual simulation scenarios section 2 4 2 1 modeling two phase flow in highly heterogeneous formations with macroscopic invasion percolation model a number of methods have been developed to simulate co2 migration and trapping at various spatial and temporal scales with the goals related to both theoretical questions and practical issues of site screening operational management capacity estimation and risk assessment niemi et al 2017 often it is computationally restrictive to model co2 brine two phase flow in a strongly heterogeneous medium with a high resolution using numerical simulators based on solving two phase flow partial differential equations here we use an alternative approach based on macroscopic invasion percolation ip yang et al 2013 kueper and mcwhorter 1992 yortsos et al 1993 ioannidis et al 1996 the macroscopic ip algorithm belongs to a class of statistical interface growth models which do not require the global solution of continuum two phase flow partial differential equations we focus on co2 migration and trapping in low velocity regions such as those away from the injection wellbore and especially after the injection ceases macroscopic invasion percolation is different from the original invasion percolation model wilkinson and willemsen 1983 while in the latter approach each site or bond is assigned a microscale pore or pore throat dimensions in the former each site is assigned a local permeability porosity and capillary pressure saturation function another important difference is that macroscopic invasion percolation allows for bi continua of fluids in each site node kueper and mcwhorter 1992 application of invasion percolation approaches requires a low flow rate with the capillary effects dominating over the viscous effects such capillary dominated flow condition can be achieved in the limit of small 10 7 capillary number nca µnv σ where v is the darcy velocity µn is the viscosity of the supercritical co2 and σ is the interfacial tension lenormand et al 1988 given that we focus on long term migration and trapping after the injection phase capillary dominated flow condition is usually met yang et al 2013 the model developed here is based on our previous work yang et al 2013 with slight modification here we provide a brief description the model simulates fluid fluid displacement on a 2d domain ω starting with a fully saturated with brine initial condition primary drainage is simulated by allowing the supercritical co2 to invade the domain from a boundary at a specified external pressure difference pex i e equivalent to capillary pressure at the scale of whole domain at each step the supercritical co2 may invade available cells i e cells that are neighboring to the invaded ones provided that the pressures satisfy the following condition 1 p e x 1 τ max i f p e x p e n i p e n where p en is the capillary entry pressure of a candidate cell under evaluation f denotes the set of all available cells at the front and p en i denotes the capillary entry pressure of cell number i in set f the parameter τ is introduced to allow for multiple sites to be invaded simultaneously at each step when τ 0 only the cell next to the front with the minimum capillary entry pressure is invaded and thus the model reduces to the classical invasion percolation algorithm when τ 1 all available cells next to the front with entry pressure below the external pressure are invaded here τ is offset to 0 4 a value determined from a previous study with a detailed comparison with the continuum two phase flow models yang et al 2013 having invaded a cell the non wetting phase co2 continues to invade the neighboring cells as long as the invading criterion eq 1 is met the invaded cells can be determined after finishing a sweep of the entire domain then the local saturations of the invaded cells are computed using the following equation brooks and corey 1964 2 s e p e x p e n γ where γ is the brooks corey pore size distribution parameter and se is an effective wetting fluid saturation se sw swr 1 swr with s w being the local wetting phase saturation after primary drainage and s wr the local irreducible wetting saturation it is assumed that s wr is a known parameter the local co2 saturation s n i or initial nonwetting phase saturation after primary drainage is calculated as s n i 1 s w note that here the capillary pressure saturation relation can also be replaced by functions of other types such as a van genuchten function after primary drainage we compute the imbibition step to obtain the trapped non wetting phase saturation for each cell s n r here we determine the locally trapped co2 saturation using the ordinary percolation approach ioannidis et al 1996 which assumes that all cells are accessible to the wetting phase during imbibition this is different from the more complex approach recently proposed by nooruddin blunt nooruddin and blunt 2018 which checks connectivity of cells for the imbibition step assuming that when a cell becomes surrounded by the cells of negligible nonwetting phase relative permeability the cell loses connectivity with its current nonwetting phase considered as trapped no matter how high the saturation is without consideration of the connectivity we evaluate the co2 trapping using the widely used the land land 1968 and spiteri trapping models spiteri et al 2008 3 s n r s n i 1 γ s n i s n r α s n i β s n i 2 where γ is the land land 1968 trapping parameter and α and β are empirical parameters in spiteri et al spiteri et al 2008 these parameters can be determined from laboratory experiments krevor et al 2012 the average trapped non wetting phase saturation over the entire domain ω s n r is 4 s n r ω ϕ s n i ω ϕ the macroscopic invasion percolation model is implemented using an efficient binary tree algorithm to allow for a large number of simulations with stochastically generated permeability fields conventional algorithms traverse the entire domain at each invasion step to identify the available interface sites and then to find the most favorable available site this is computationally wasteful since only a small change occurs at the interface at each time step knackstedt et al 2000 this problem can be solved by storing the interface sites in a dynamic list sorted in ascending order according to the capillary entry pressure knackstedt et al 2000 masson and pride 2014 this dynamic list can be updated efficiently by insertion and deletion operations while maintaining the order at each time step here dynamic updating is implemented by adopting a binary search tree data structure to store the list allowing the insertion and deletion operations to be performed in ln n time with n being the size of the list knackstedt et al 2000 masson and pride 2014 2 2 breakthrough pressure effective permeability and upscaled relative permeability using the macroscopic invasion percolation model described above we can also obtain the breakthrough pressure p bt i e the critical external pressure needed for the non wetting phase to reach the outlet boundary to do this the invasion at each step is set to occur at only the cell with the smallest entry pressure along the invading front this is equivalent to assigning the parameter τ 1 in the simulations the set of invaded cells at breakthrough is denoted c the breakthrough pressure is then the minimum entry pressure of set c 5 p b t min i c p e n i the superscript i is the cell index in set c the breakthrough pressure can be understood as an upscaled capillary entry pressure for a heterogeneous domain the effective permeability for a heterogeneous field can be obtained numerically by solving the single phase darcy based flow equation over the domain for an arbitrary pressure gradient 6 k μ n p 0 where p is the pressure field to be solved and k is the local permeability this is done in advance of the co2 invasion simulations the viscosity µn is set to 5 25 10 5 pa s corresponding to the viscosity of supercritical co2 at representative reservoir conditions note that permeability is a tensor but here we focus only on the direction along the main displacement the effective permeability k eff is calculated by 7 k e f f q μ n l a p i n l e t p o u t l e t where p inlet and p outlet are the specified inlet and outlet pressures respectively a is the cross section area l is the length of the domain and q is the integrated volumetric flow rate for the cross section obtained from the solutions of pressure and velocity fields the upscaled relative permeability can also be computed for a given saturation field and local hydraulic properties in this study we calculate the upscaled end point relative permeability i e at the end of primary drainage for the non wetting phase using the single phase flow averaging method eichel et al 2005 that is the wetting phase is assumed to be stationary for the calculation of upscaled non wetting phase relative permeability the end point relative permeability to the wetting phase can be computed similarly but will not be presented here we impose a given pressure gradient along the main displacement direction and then numerically solve the pressure equation for the non wetting phase only 8 k k r n μ n p 0 where krn is the local relative permeability calculated using the local saturations as brooks and corey 1964 9 k r n 1 s e 2 1 s e 1 2 γ the upscaled end point relative permeability k r n e the ratio between the effective permeability at the end point saturation and that at the saturated case is calculated by 10 k r n e 1 k e f f q μ n l a p i n l e t p o u t l e t here q is the obtained volumetric flow rate similar as defined above from solving eq 8 2 3 local properties we consider two lithofacies materials namely sandstone and siltstone in the two dimensional heterogeneous domains 50 m 100 m due to spatial arrangement of the facies and the random distribution of hydraulic properties within each facies the permeability follows a bimodal distribution we adopt the method of lu and zhang lu and zhang 2002 for generating the multimodal heterogeneous media first a hundred markovian random fields of the lithofacies with specified proportions p 1 p 2 and mean lengths l 1 l 2 are generated using transitional probability geostatistical software t progs developed by carle and fogg carle and fogg 1996 the mean lengths are parameters that are roughly analogous to range in variogram modeling a mean length in the vertical direction corresponds to a mean thickness of a lithofacies lu and zhang lu and zhang 2002 showed that the transition rate matrix r follows this format 11 r 1 l 1 1 l 1 p 1 p 2 l 1 p 1 p 2 l 1 then for each lithofacies a hundred realizations of two dimensional multi gaussian fields with specified correlation lengths are generated using hydro gen a public domain random field generator bellin and rubin 1996 finally composite bimodal heterogeneous fields are generated through combination of each markovian indicator field with the multi gaussian fields for the two lithofacies after generating the permeability fields we scale the local capillary entry pressure using reference values from the literature according to the leverett scaling leverett 1941 12 p e n σ k ϕ 1 2 2 4 simulation scenarios simulation scenarios are designed with the objective of studying gas migration and capillary trapping in the presence of bimodal heterogeneities we focus on the effect of material proportions on capillary trapping capacity and effective two phase flow properties such as breakthrough pressure effective permeability and upscaled relative permeability at the field scale we consider five cases each with 100 heterogeneous fields each field has 400 200 grids it should be emphasized that these permeability fields are generated in such a way that the mean effective upscaled permeability keff over the 100 realizations is the same keff 1 26 10 13 m2 for all five cases of different sandstone proportions fig 1 shows four example realizations of heterogeneous permeability fields the histograms of permeability for these individual example fields are shown in fig 2 with decreasing sandstone proportion increasing siltstone percentage the permeability distribution is more and more skewed when p 1 0 4 p 2 0 6 two peaks are clearly visible fluid displacement in the horizontal x y plane is simulated with a specified external pressure pex 10000 pa given the mean effective permeability 1 26 10 13 m2 and the interfacial tension 0 036 n m the capillary number nca corresponding to the imposed hydraulic gradient 0 01 is on the order of 10 9 which is consistent with the capillary dominated regime the main displacement direction is along the x axis the transverse boundaries are assigned impermeable conditions gravity effects are not considered which is reasonable for the far end of the co2 plume migration the simulations of primary drainage are run until all available sites satisfying the invasion criterion are invaded the calculation of co2 trapping uses the saturation distribution obtained through the primary drainage simulations as initial co2 saturations the statistical parameters used for producing the random permeability fields are listed in table 1 with the different cases table 2 lists the local scale reference parameters which are roughly based on laboratory experiments krevor et al 2012 al yaseri et al 2017 scuderi et al 2015 for simplicity the porosity is assumed to be 0 2 uniformly for both lithofacies the parameters for calculating co2 trapping are obtained from an experimental study krevor et al 2012 two different well established models are used to describe the relation between the trapped final co2 saturation and the initial co2 saturation the relationships with the two models and for the two lithofacies studied here are shown in fig 3 3 results 3 1 breakthrough pressure leverett scaling relationship is often used to collapse the often scattered capillary pressure saturation data obtained for samples of different porosity and permeability and using different fluids to a master curve this relationship makes it convenient in continuum two phase flow numerical simulations in a heterogeneous reservoir here our mip model assumes that leverett scaling eq 12 is valid at the local scale i e the local entry pressure is spatially varying and scaled with the spatially varying permeability one of the goals is to check whether the upscaled entry pressure based on the breakthrough pressure as described above and the effective permeability of the heterogeneous domain also follow the scaling rule to achieve this goal we compute the effective permeability k eff and the breakthrough pressure p bt for the heterogeneous fields using the method described in section 2 fig 4 shows that generally p bt increases with decreasing k eff or increasing 1 k eff for all sandstone proportions from 0 4 to 1 0 visual inspection shows that the smaller the sandstone proportion the larger the scatter of breakthrough pressure data the simulation data are fitted with a linear relationship between p bt and 1 k eff relative residuals of the fitting defined as the ratio between euclidian norms of the fit residual and the p bt data are 0 06 0 07 0 13 and 0 18 for sandstone proportions of 1 0 0 8 0 6 and 0 4 respectively for large sandstone proportions p 1 0 8 the leverett scaling seems to work well also for the upscaled systems the relative residual increases with sandstone proportion with the value for the case p 1 0 4 is three times of that for p 1 1 0 this suggests that application of the leverett scaling relationship for numerical simulations may bring much larger uncertainties for heterogeneous systems with stronger bimodality in permeability distribution 3 2 co2 saturation at the end of primary drainage fig 5 presents the co2 saturation s n i fields after primary drainage for four example realizations corresponding to four different sandstone proportions within the invaded regions co2 saturation is higher for cells with higher permeability lower entry pressure qualitatively as p 1 decreases the total co2 mass is more and more concentrated in high permeability channels the sweep efficiency defined as the number of cells swept by co2 normalized by the total number of cells in the domain is 0 70 0 67 0 55 and 0 48 for the four example simulations shown in fig 5 the ensemble average arithmetical mean of 100 realizations of sweep efficiency shows a clear dependence on the sandstone proportion being 0 69 0 66 0 59 and 0 38 for p 1 1 0 0 8 0 6 and 0 4 respectively the domain average co2 saturation s n i ω ϕ s n i ω ϕ after primary drainage for all different sandstone proportions are shown in fig 6 it can be seen that for p 1 0 6 the median value of s n i 0 37 0 38 does not vary with p 1 significantly but for p 1 0 4 the median value of s n i over 100 simulations decreases substantially to about 0 27 the inter realization variability of s n i is also much larger when p 1 0 4 and 0 5 than the other cases for instance when p 1 0 4 the standard deviation of s n i for the 100 realization sample is 0 10 which is significantly higher than the standard deviation 0 04 for p 1 1 0 3 3 end point relative permeability the end point relative permeability at the end of primary drainage k r n e is computed because it is an important parameter for large scale numerical simulations especially when hysteresis constitutive relationships are used fig 7 shows the arithmetic mean and standard deviation of k r n e over 100 simulations for each of the five sandstone proportions similarly to s n i for p 1 0 6 the ensemble mean of k r n e arithmetic average of 100 realizations does not vary with p 1 significantly vary between 0 33 and 0 35 but for p 1 0 6 the ensemble average drops considerably the arithmetic mean of k r n e is 0 19 and 0 13 for p 1 0 5 and 0 4 respectively this result indicates that the upscaled relative permeability is not affected by the sandstone proportion above 0 6 and that there is a transition in the flow connectivity between p 1 0 6 and p 1 0 5 this will be further explained in the discussion section 3 4 residual trapping of co2 after primary drainage the co2 saturation s n i distribution and its upscaled value s n i are obtained see section 3 2 the large scale imbibition process produces residual capillary trapping of co2 assuming imbibition is an ordinary percolation process ioannidis et al 1996 we calculate the local residual trapping using both the land land 1968 and the spiteri et al spiteri et al 2008 models we focus on the impact of bimodal heterogeneity on residual trapping of co2 for appropriate comparison the five cases of sandstone proportions have the same ensemble average of effective permeability geometric mean of 100 realizations fig 8 presents four example fields of trapped co2 saturation s n r obtained by using the spiteri et al spiteri et al 2008 model based on the initial co2 saturation s n i after primary drainage for the five cases of sandstone proportions given that the parameters for residual trapping in sandstone produce a monotonically increasing relationship between s n r and s n i see fig 3 and that most of the co2 phase is in the sandstone the cells with higher initial co2 saturation get also higher trapped saturation this leads to trapped saturation fields that resembles the initial co2 saturation fields the trapped co2 mass is distributed mostly in the sandstone decreasing the sandstone proportion results in higher local trapped saturation values but the domain average trapped co2 saturation generally decreases with decreasing p 1 for example s n r 0 28 0 27 0 23 and 0 19 respectively for p 1 1 0 0 8 0 6 and 0 4 for the four examples shown in fig 8 the domain average trapped co2 saturation for all simulations of different sandstone proportions are shown in fig 9 the trapped co2 saturations are calculated both using the spiteri et al spiteri et al 2008 function and using the land land 1968 function generally the ensemble mean s n r of 100 realizations decreases with decreasing sandstone proportion however only a slight decrease of s n r about 10 is observed when p 1 decreases from 1 0 to 0 6 a significantly larger drop occurs as p 1 further decreases to 0 5 and 0 4 where s n r 0 17 and 0 15 respectively for the calculation based on the spiteri et al model the results based on the spiteri et al and the land trapping models are similar but the land trapping model generally produces less residual trapping by 12 13 which is due to the fact that in our study the local s n r is smaller in the land model than in the spiteri et al model for sandstone see fig 3 uncertainty in the trapped saturation s n r is also influenced by the sandstone proportion for p 1 0 8 the standard deviation of s n r over one hundred stochastic simulations is relatively small 0 03 when p 1 decreases 0 6 the standard deviation of s n r increases to 0 044 for p 1 0 4 the standard deviation is largest 0 064 of the five cases 4 discussion as in other subsurface multi phase problems such as oil gas recovery in petroleum reservoirs and unsaturated flow in the vadose zone multi scale heterogeneity imposes significant challenges for predictive modeling of carbon dioxide migration and trapping in applications of geological sequestration in this study we consider heterogeneity that results both from lithofacies scale rock type distribution and from fine scale variability within the facies this type of heterogeneity can lead to multi modal distributions of hydraulic properties which are important for the flow behavior but have been under examined for multi phase flow in the subsurface gershenzon et al 2015 trevisan et al 2017 yang et al 2013 to tackle this issue we combine transition probability based markovian indicator random fields and multi gaussian random fields to generate bimodal distributions of permeability and of capillary entry pressure an efficient model based on macroscopic invasion percolation is developed to investigate the effect of heterogeneity on the co2 migration and trapping this methodology enables monte carlo simulations which would have been impractical when employing the conventional approaches based on solving the continuum scale two phase flow equations e g tough2 eco2n this approach also allows for investigation of uncertainties for different cases through computing the ensemble statistics our results show that the relative proportions of lithofacies significantly affect the co2 migration and residual trapping we consider five cases of lithofacies proportions for the sandstone siltstone combination each with 100 equally probable random permeability fields it should be emphasized that these cases are designed to have the same value for the ensemble mean of effective permeability this is done by slightly adjusting the geostatistical parameters namely the categorical means μ 1 and μ 2 and categorical standard deviations σ 1 and σ 2 by forcing the same ensemble mean of effective permeability we exclude the possible effect resulting from difference in the upscaled absolute permeability of the entire heterogeneous domain we find that generally the ensemble means of sweep efficiency and domain averaged co2 saturation at the end of primary drainage show a decreasing trend with decreasing sandstone proportion fig 5 6 in other words the higher the proportion of sandstone the higher the co2 saturation at the end of the drainage the trend however is not linear and there is a change in the behavior trend at p 1 0 6 when p 1 decreases from 1 0 to 0 6 only a slight decrease in co2 saturation in the two ensemble means is seen when p 1 further decreases to 0 5 and 0 4 a drastic decline is observed this kind of critical behavior at p 1 0 6 can be explained by the connectedness of the sandstone material from the inlet to the outlet of the domain as quantified by the percolation threshold criteria according to percolation theory stauffer and aharony 2018 a proportion p 1 of 0 6 is just above the theoretical critical threshold 0 593 in 2d for the sandstone to span the domain therefore for cases with p 1 0 6 all the sandstone material remains well connected and are easily accessible to the invading co2 whereas for p 1 0 5 and 0 4 the high permeability sandstone forms isolated regions surrounded by the relatively low permeability siltstone causing the invading co2 to ignore some of the sandstone inclusions the considerably smaller end point relative permeability k r n e at p 1 0 4 fig 7 can also be explained by the fact that the invading co2 will inevitably flow through part of siltstone which has a lower permeability than the sandstone the results also show that the variability in domain averaged saturation as can be quantified by the inter realization variability in s n i is significantly larger for p 1 0 4 and 0 5 than for p 1 0 6 for instance the difference in s n i between 25th and 75th percentiles is 0 159 for p 1 0 4 and 0 025 for p 1 0 6 see fig 6 the large variability in s n i for p 1 0 4 and 0 5 is attributed to two effects 1 that the sandstone as the minor part of the domain in the case of small proportion becomes the discontinuous lithofacies in the form of inclusions and 2 the randomness in accessibility of the sandstone by the co2 due to the random spatial arrangement of the sandstone inclusions in the stochastic realizations with respect to the co2 migration pathways substantial uncertainty arises in the percentage of sandstone material accessed by the invading co2 the domain averaged trapped co2 saturation s n r is shown to be influenced by the lithofacies proportion and the trapping model selected fig 8 9 similar to the initial co2 saturation at the end of primary drainage the ensemble mean of s n r decreases substantially as p 1 decreases from 0 6 to 0 4 this is in agreement with flett et al flett et al 2007 who investigated sandstone shale binary systems but did not consider fine scale heterogeneity within lithofacies though in addition the inter realization variability is significantly larger in the case of p 1 0 4 this is attributed to the uncertainty in s n i discussed above the simulations also indicate that the domain averaged trapped co2 saturation s n r is dependent on the chosen trapping model even though we have used two models derived from the same experimental data krevor et al 2012 our results evidently demonstrate that both the multi scale heterogeneity and the choice of empirical trapping models can induce considerable uncertainty in residual trapping of co2 the order of magnitude of the difference between the cases p 1 1 0 and p 1 0 4 i e about 0 1 is similar to what has been observed when comparing residual trapping saturation as determined from field experiments to those determined form laboratory data joodaki et al 2020 our results are also used to examine the applicability of the commonly used leverett scaling relationship in numerical simulation of multiphase flow through heterogeneous media we show that even if the leverett scaling holds locally for the permeability capillary pressure relation it is not necessarily a good representation of the link between upscaled permeability and capillary entry pressure especially when the sandstone proportion is small 0 4 this result is consistent with previous works leverett s original work leverett 1941 demonstrated that the scaling is satisfactory on four clean sands but not on two clayey sands then brown brown 1951 has shown that the j function is only suitable for scaling core samples with similar lithology recent experimental studies ni et al 2019 krevor et al 2012 have also clearly shown that the capillary pressure curves are similar for the same rock type and different between different rock types here our numerical modeling has provided a quantitative approach for evaluating the appropriateness of the leverett scaling in rock formations of varying lithofacies proportions it should be pointed out that our work has some limitations firstly we consider flow problems in 2d while actual reservoirs are all 3d in reality cubic lattices have a higher coordination number 6 and a lower site percolation threshold 0 312 than 2d square lattices nooruddin and blunt 2018 one would expect the 2d results to differ from 3d percolation results it is thus of interest to compare simulation results between 2d and 3d however this is computationally challenging the main difficulty is not in performing the invasion percolation simulations but in stochastic generation of a large number of sufficiently high resolution bimodal permeability distributions in 3d that are consistent with the geostatistical approach section 2 3 thus this comparison cannot yet be done nevertheless we expect the 2d results and 3d results to show the same qualitative trend in terms of the effect of lithofacies proportion on e g end point relative permeability and residual trapping even though the corresponding values would differ between 2d and 3d for example it is reasonable to speculate that in 3d the sharp change in ensemble mean end point relative permeability and residual trapping as p 1 decreases could occur at p 1 around 0 31 secondly gravity plays a critical role in co2 migration and trapping at the field scale but the gravity effects are ignored in this study even though they can be accounted for trivially in the ip model this can be done by adding a coordinate dependent pressure term to the stochastically generated entry pressure p en our work here focuses on the effect of bimodal heterogeneity from core to block scale on large scale flow and trapping properties laboratory measurements of residual trapping parameters are often used in field scale numerical simulations the scale effects in the transition from core to basin scale is often overlooked one of the important points we want to make in this study is that the macroscale residual trapping properties may differ significantly from the core scale measurements obtained in the laboratory our results can thus be used to inform the basin scale numerical models which will eventually take into account the gravity effects 5 conclusions to sum up we have studied the effect of heterogeneity on co2 brine two phase flow behavior and capillary trapping in the field scale a modeling methodology based on macroscopic invasion percolation has been developed to simulate co2 migration and trapping in strongly heterogeneous systems with bimodal permeability distributions stochastic simulations of co2 migration and trapping are performed on heterogeneous permeability fields generated by considering both transition probability based lithofacies distribution and multi gaussian random fields the heterogeneity cases are designed so that they have the same ensemble mean of upscaled permeability to allow a proper comparison of the results we find that the co2 spreading and trapping is strongly influenced by the heterogeneity in particular the conclusions are summarized as follows 1 the ensemble means of sweep efficiency and domain average co2 saturation at the end of primary drainage co2 injection show a slight decrease with decreasing sandstone proportion p 1 from 1 0 to 0 6 but a much sharper decline when p 1 further decreases to 0 4 this is mainly attributable to dependence of the connectedness of the sandstone material on the lithofacies proportion 2 the upscaled two phase hydraulic properties are dependent on the lithofacies proportion the leverett scaling relationship between upscaled permeability and capillary entry pressure may not be applicable especially when the sandstone proportion is small p 1 0 4 3 the amount of residual trapping decreases on average with decreasing sandstone proportion both the multi scale heterogeneity and the choice of empirical trapping models can induce considerable uncertainty in residual trapping of co2 our findings in this work have broad implications within the context of co2 sequestration as the gas spreading and entrapment are the fundamental processes leading to long term storage security the results presented here can be used to give guidance concerning the effect of different material fractions on residual trapping in situ future work will be devoted to quantifying uncertainty in co2 trapping at the reservoir basin scale yang et al 2015 tian et al 2016 cavanagh and haszeldine 2014 influenced both by heterogeneity across multiple spatial scales and by operational parameters credit authorship contribution statement zhibing yang conceptualization methodology software investigation formal analysis writing original draft yi feng chen conceptualization resources writing review editing auli niemi conceptualization supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work was supported by the national natural science foundation of china grant number 41877203 and 51925906 and the swedish energy agency grant no 43526 1 
448,geologic boundaries juxtaposing fine against coarse grained rock have a profound impact on multiphase flow giving rise to a spectrum of non linear flow behaviors ranging from capillary filtration capillary holdup and the formation of transient vapour locks to spontaneous imbibition although these discontinuities tend to be small scale features their impact is felt on the large scale where they are challenging to model with regard to both spatial discretization and dynamic flow simulation we develop a new numerical scheme to handle jump discontinuities in pressure and saturation embedding boundaries into a hybrid fe fvm model of immiscible two phase flow in porous media the integration of interface conditions is an extension of the discontinuous finite element finite volume method dfefvm a unique feature of it is that saturation at the interface is computed locally without constructing a system of equations and in contrast with other schemes it offers sufficient degrees of freedom to accommodate disequilibrium in pressure a range of test cases including gravity capillary pressure and material discontinuities are presented to verify validate and show the effectiveness of the new simulation method keywords two phase flow heterogeneous media material interfaces capillary trapping dfefvm 1 introduction multiphase flow through porous soils sedimentary rocks or volcaniclastics forms an integral part of a wide range of processes occurring in different geologic settings such as infiltration of the vadose zone geothermal circulation biogenic methanogenesis or secondary hydrocarbon migration these processes occur on vastly different time and length scales the length scale affects the balance between the driving forces while capillary forces tend to dominate on the pore scale viscous and gravitational forces determine flow on the km scale notwithstanding dynamic km scale capillary barriers are well documented in the engineering literature e g watts 1987 and are related to the interplay of geologic heterogeneity with wettability and saturation this interplay gives rise to rich flow patterns and sharp saturation discontinuities collocated at material interfaces as illustrated in a photograph of an outcrop of fractured sandstone that was infiltrated by water draining from overlying soil fig 1 beyond variation of the external conditions flow can become episodic and varying discontinuously over time thus multiphase flow across a coarse fine material interface can come to a halt when the non wetting phase collects upstream of it yet remaining at a pressure that is below the entry pressure of the fine grained layer this process has been termed vapour lock and benzing and shook 1996 studied its dynamics in the laboratory they showed that in the presence of gravity the build up of buoyant non wetting phase below horizontal interfaces may eventually break the lock dynamic seal leading to a sudden fluid discharge that only ends when the accumulation has drained and the process can repeat in addition to such relaxation oscillations spontaneous imbibition of a fine grained layer saturated with non wetting phase will occur when this layer is brought in contact with the wetting phase as this happens the spontaneous pressure drop that ensues when water enters the fine grained layer it causes rapid displacement of the non wetting phase from the layer both the formation and breakdown of a vapour lock and the spontaneous imbibition into a water wet non wetting phase saturated layer are material interface processes posing modelling challenges because they locally perturb system behavior in a nonlinear fashion such perturbations induce spatio temporal discontinuities in pressure and saturation requiring additional degrees of freedom to capture them while a vapour lock exists at a capillary barrier fluid pressure is decoupled across it and flows parallel to the interface can evolve independently on either side this state will persist until the capillary entry pressure of barrier is exceeded flow occurs and the pressure discontinuity disappears again it follows that a realistic model of this process will need to be able to deal with such temporal jump discontinuities in pressure and saturation as well as their toggle switch control of fluid flow notably geologic porous media are full of capillary interfaces with intricate shapes difficult to resolve already at the level of geometric modelling capturing the dynamics of multiphase flow in such heterogeneous rock sequences provides a formidable modelling and upscaling challenge kueper et al 1989 dawe et al 1992 krause et al 2009 and shi et al 2011 introducing a new numeric method for the simulation of such interface dynamics is the subject of this article the described behavior of capillary interfaces has already been subjected of considerable analysis on the basis of which a new numeric model can be built van duijn et al 1995 proposed a semi analytic model including interface conditions to represent the effect of the capillary entry pressure correa and firoozabadi 1996 studied gas oil gravity drainage concluding that capillary pressure contrasts promote instabilities in the system other studies have attempted to treat interface transfer numerically classic finite difference approaches only consider transfer along the grid axes and zero dimensional transfer functions are used in the modelling of fracture matrix transfer in dual continua models see review in gilman 2003 finite volume fv and finite element fe methods and combinations thereof permit the use of unstructured meshes for the discrete representation of material interfaces cordes and kinzelbach 1992 and geiger et al 2004 without specific provisions these methods cannot describe jump discontinuities in pressure and or saturation because in the fem dependent variables are continuous across element interfaces in the fvm interfaces can only be resolved using transmissibility multipliers thus dependent variable discontinuities are smeared across interfaces to study this behavior helmig and huber 1998 compared a fully upwind galerkin method with standard galerkin and petrov galerkin methods while the standard galerkin method is not even locally conservative the petrov galerkin method can create nonphysical results the fully upwind galerkin method provides reasonable results but the jump discontinuity of saturation at the material interface gives way to a sharp gradient to resolve the jump discontinuity correctly bastian 1999 and niessner et al 2004 introduced additional degrees of freedom at the interface nodes however this approach does not guarantee mass conservation when flow occurs at an angle to the interface cancés et al 2009 study the convergence of finite volume scheme which takes account the effect of capillary pressure discontinuity wolff et al 2012 and bazrafkan et al 2014 use cell centred finite volume method for two phase flow but discontinuities in capillary pressure are not represented on cell centred multi point flux approximation framework cvd mpfa friis et al 2008 ahmed et al 2019 formulate capillary flux approximation which implies van duijn de neef condition van duijn et al 1995 hoteit and firoozabadi 2008 successfully combined the mixed finite element approach with the discontinuous galerkin method dgm capturing the saturation discontinuity in a mass conservative scheme ern et al 2010 and bastian 2014 subsequently pioneered the fully discontinous galerkin method in the dgm each node carries multiple saturation values as a result of this increase in the degrees of freedom the method requires much more computational resources than competing finite element finite volume methods fefvm kim and deo 1999 geiger et al 2004 and nick and matthäi 2007 in these hybrid methods the rock is represented by a finite element mesh which conforms to material interfaces see fig 2 a porosity permeability and relative permeability are treated as piecewise constant within each element while pressure and saturation are discretized as piecewise linear on the finite element nodes therefore undesirable smearing effects occurs between heterogeneous regions nick and matthäi 2011a improve this fefvm by introducing interface elements see fig 2 b where nodes coincide with material interfaces they are replicated as many times as different materials are joint with one another at this location thus the mesh is split along internal boundaries and then reconnected by interface elements these lightweight elements act as a proxy which controls the mesh connectivity this node centred finite volume finite element discretization with embedded discontinuities dfefvm can capture both pressure and saturation discontinuities precisely all cited studies show that when capillary entry pressure is not considered the interface condition of van duijn et al 1995 is not satisfied here we extend the dfefvm by an interface coupling algorithm that manages to reproduce the complex toggle switch behavior discussed above it will be shown that as a consequence pressure and saturation are no longer artificially continuous nor smeared across the interface respectively the scheme has been developed with large capillary pressure contrasts between layers in mind and the coupling algorithm for the disjointed mesh satisfies the interface conditions without any flux averaging part of the concept is a local time stepping control framework to manage localize and capture quick changes of physical variables across the interface we show that this scheme is locally conservative and interface conditions are satisfied at all times this paper is organized as follows we first review the interface conditions and governing equations for slightly compressible immiscible two phase flow in porous media with material interfaces in detail second we introduce the new numerical treatment of interface fluxes and decoupling coupling behavior third a range of test cases is presented and discussed for model verification and validation with results from a recent physical experiment involving the flow of supercritical co2 through a laminated drill core that was monitored real time with x ray tomography 2 methodology for simplicity the new scheme is described here only for incompressible immiscible two phase flow in heterogeneous porous media 2 1 governing equation similar to durlofsky 1993 and helmig 1997 we use implicit pressure explicit saturation impes to perform an operator splitting solving the elliptic parabolic pressure equation with the fem and the hyperbolic transport equation with the fvm the system of equations is solved in a sequential manner the total pressure equation elliptic is solved by fem then the total velocity vt is computed from the gradient of total pressure by darcy s law after that the transport equation is used to update saturation with the appearance of material interfaces additional effort is required to achieve correct flow variable values at the material interface we use the interface condition of van duijn et al 1995 to solve the saturation on either side of the interfaces 2 1 1 pressure equation the transport process is described by the well know system of equations 1a ϕ s w t v w q w 1b ϕ s n t v n q n 1c p c s w p n p w 1d s w s n 1 here v α qα and sα are the velocity volume flow rate and saturation of phase α α n w pc sw and ϕ are the capillary pressure function and porosity of reservoir rock respectively for slow viscous flow the phase velocity can be computed directly from the phase pressure gradient by applying the multiphase flow form of darcy s law 2 v α k λ α p α ρ α g k indicates the permeability tensor of medium g is the gravitational acceleration and ρα is the phase density phase mobility λα is defined as the ratio of the relative permeability krα sw and viscosity μα of phase α 3 λ α k r α μ α among many approaches to solve system of eq 1 such as impes fully implicit method fi and sequential chen et al 2006 lie 2016 we opt impes because of its simplicity in implementation and robustness for solving two phase flow despite its restriction on time step with impes the pressure and saturation equations are treated separately and solved sequentially since we are interested primarily in flow at the meter scale and below we employ the global pressure formulation which was originally proposed by chavent and jaffre 1986 4 p p w 1 s n r s w f n d p c d s w ζ d ζ snr refers to the residual saturation of non wetting phase and fn is the non wetting phase fractional flow 5 f n λ n λ n λ w λ n λ the double exponential integration technique takahasi and mori 1974 is used to compute the integral term in eq 4 efficiently accordingly phase pressure can be recovered adding eqs 1a and 1b to get the elliptic pressure equation 6 k λ t p λ n ρ n λ w ρ w g q n q w q t on an unstructured grid this elliptic equation can be solved using the standard finite element method on a domain comprised of ne isoparametric elements integration of eq 6 yields 7 i n e ω e n t k λ t n d ω p i n e γ e n t n q s d γ γ e n t n q t d γ ω e n t k g n λ n ρ n λ w ρ w d ω which can be written as a system of linear algebraic equations 8 a p b 2 1 2 saturation transport equation the saturation equation for the non wetting phase written in a fractional flow form is 9 ϕ s n t f n v t λ k p c λ k ρ w ρ n g q n where λ is the mobility product defined as 10 λ λ n λ w λ n λ w the finite volume method is used to solve this eq 9 for finite volumes constructed from nj facets surrounding each finite element node i the non wetting phase saturation is updated by using the explicit upwind scheme 11 s n i t δ t s n i t δ t δ v j n j f j ω q n d ω the flux over the facet j is evaluated at each facet integration point 12 f j γ j v j t a j n j d γ f j u p v t j λ j u p k p c ρ w ρ n g a j n j finite volumes at the region boundaries are truncated therefore a volume flux compensation term is required to achieve correct saturation values at where there is a flux across a boundary that term is computed similar to the flux over finite volume facets but the fractional flow and mobility values are evaluated at the boundary nodes instead of using an up winding technique 13 c j i f j i v t j λ j i k p c ρ w ρ n g a j n j the saturation at the boundary is updated by introducing the additional term 14 s n i t δ t s n i t δ t δ v j n j f j ω q n d ω j n j c j i in the next section we will show how the compensation term ci is used to compute saturation at material interfaces 2 2 treatment of interface conditions because the elements on the opposite side of the material interface do not share nodes we need to couple the pressure and saturation variables while the dfefvm discretization allows discontinuities by treating these nodes and elements as internal mesh boundaries the operators needed to evaluate boundary fluxes are standard fe surface integrals which are evaluated on these mesh entities two conditions need to be imposed consider a domain which is composed of two media r i and r ii and p d i p d i i defining the critical saturation value s w as p c i s w p d i i the first condition concerns the continuity of each phase flux over the interface as there is no mass added lost in this process the fluxes transferred across the interface must balance 15 f α i f α i i described as extended pressure condition by van duijn and de neef 1998 the second condition relates to the continuity of capillary pressure over the interface the capillary pressure is continuous across the interface only if there is a pair of interface saturations s w i s w i i satisfying s w s w i fig 3 a otherwise there are no feasible saturation values at the interface that make capillary continuous fig 3 b in this case the s w i i jumps to 1 and p c i i p d thus saturation is always discontinuous across the interface except when the two capillary curves are identical the second condition can be rewritten as 16 s w i i p c i i 1 p c i s w i if s w i s w 1 otherwise 2 2 1 coupling pressure to solve the pressure equation we select from the multiplicated nodes those that belong to the adjacent region with the lowest capillary entry pressure the other nodes at the same location are treated as shown in fig 2 b whether there is flow across the material interface determines the coupling between multiplicated nodes if there is no fluid exchanged over the interfaces there is no need to couple pressure values because the nodal pressure values evolve independently when fluid moves across the interface we also modify the diagonal terms of the conductance matrix a and the load vector b in eq 8 as demonstrated by nick and matthäi 2011b this amounts to a strong coupling between nodes and forces pressures to be equal the algorithm for coupling pressure of duplicated nodes corresponding to row i and j in the matrix a and the vector b is briefly described in the following manner because of the strong discontinuity in the dfefvm the terms a i j and a j i equal to zero this algorithm can be extended readily to couple pressure of multiplicated nodes at interfaces 2 2 2 coupling transport similar to the pressure system of equations the presence or absence of flow across a material interface determines how saturation values are coupled before breakthrough the interface acts as a no flow boundary therefore nodal saturation only depends on element internal neighbour nodes during transfer across the interface if the saturation s α t δ t at the interface node is known the saturation on the opposite side node is computed from the interface condition 16 the compensation flux c i s n t δ t for finite volumes which connect to this node is evaluated straightforwardly by eq 14 to guarantee local mass conservation the total flux exchanged among surrounding facets of multiplicated nodes must equal to zero 17 r s n t δ t i n c i s n t δ t 0 eq 17 is nonlinear so an iterative method is required to find the saturation value on each side of the interface in order to guarantee robustness as well as execution speed the iterative methods such as brent 1971 and chandrupatla 1997 are used these methods do not require to compute the derivative and utilize the inverse quadratic interpolation whenever possible resulting in super linear convergence rates they allow the saturation values at the interface nodes to be updated locally and simultaneously without any further post processing or averaging processes 3 test cases and applications we have applied the new interface coupling scheme to a series of one two and three dimensional models first we verify the code by comparing the numerical result with the semi analytical solution second the infiltration of dnapl into a high permeability lens with different entry pressure test cases is conducted the purpose of the test case is to verify that the scheme handles the interface condition correctly for both equilibrium and non equilibrium capillary pressure cases next a heuristic model of a fault offsetting a layered rock sequence is solved finally we simulate a 3d drill core model which is flooded with supercritical co2 all the cases are simulated with a second order accurate in space upwind scheme the absolute flux residual value for convergence of the brent solver is set to 10 14 the new dfefvm scheme has been implemented on the basis of the csmp application programmer interface that is co developed by an originators groups of universities including ethz imperial college london and the university of melbourne e g yapparova et al 2017 3 1 verification with van duijn de neef solution the new extended dfefvm method is verified with the semi analytical solution of van duijn and de neef 1998 derived for a one dimensional domain of length 0 4 consisting of two different materials which share an interface the left side is initially fully saturated by wetting phase and the right side is fully saturated by non wetting phase normalized fluid and media properties are shown in table 2 the hysteresis of capillary pressure and relative permeability is ignored the brook corey model is used because it can represent a capillary entry pressure for the non wetting phase which is a function of the pore size distribution in the medium 18a k r w s e 2 3 λ λ 18b k r n 1 s e 2 1 s e 2 λ λ 19a p c x p d x s e 1 λ 19b p d x σ ϕ k x the effective saturation se is computed as in helmig 1997 20 s e s w s w r 1 s w r s n r in the absence of external forces gravity and viscous capillary pressure is the only driving force as a result phase redistribution is controlled by the capillary pressure discrepancy across the interface and total velocity equals to zero this process is reproduced by the semi analytical and our numerical methods on a mesh of 120 uniform elements starting with the same material properties in the whole model case a we increase the permeability and entry pressure contrast of materials on the left side and the right side case b and c the results for three test cases at three different time steps t 1 2 and 3 are depicted in fig 4 case a the material properties of two sub domains are identical with k l k r 10 3 and p d l p d r 10 the saturation profile and capillary profile are smooth over the interface sw 0 52 fig 4 a shows that the numerical solution fits with the semi analytical solution case b permeability of the right region is reduced to k r 6 4 10 4 and its entry pressure is increased to p d r 12 5 the critical wetting phase saturation computed by condition 16 is s w 0 64 the wetting phase saturations on either side of the interface are different with s w l 0 39 and s w r 0 78 the critical saturation lies between s w r and s w l hence the capillary pressure still is continuous p r s w r 0 39 p l s w l 0 78 16 01 fig 4 b shows that the numerical results are in good agreement with the semi analytical solution case c the property contrast is increased by changing the entry pressure and normalized permeability of the right region to p d r 20 and k r 2 5 10 4 the critical saturation value now is s w 0 25 as can be seen in fig 4 c capillary equilibrium could not be established and the water saturation on the right side jumps to 1 again the numerical solution is in good agreement with the semi analytical solution and without any additional relaxation 3 2 infiltration of dnapl into a high entry pressure lens this test case simulates a physical experiment which was described by bastian and helmig 1999 the model in this test case is built of a low permeability lens embedded in a homogeneous high permeability host rock the geometry and boundary conditions are illustrated in fig 5 and material properties are introduced in table 3 top and bottom are no flow boundaries except a small window where dnapl is injected at a rate of 0 075 kg m2 s at the left and right boundary hydrostatic pressure is applied two different values of entry pressure of the lens are explored to illustrate its effect on two phase flow three mesh configurations are generated to demonstrate the capability of the scheme to reproduce the physical behavior at different levels of resolution and to assert the computation cost in case a a small entry pressure value of p d 2 1163 5 pa is assigned to the lens and the critical saturation of the non wetting phase computed from eq 16 is s n 0 63 in case b we increase the entry pressure of the lens to p d 2 1466 1 pa and the critical saturation changes to s n 0 76 the final step of two cases are shown in fig 6 all three mesh configurations yield similar results the dnapl saturation profile is measured at the central line of the model at different time steps fig 7 in case a the non wetting phase reaches the lens at t 720 s as explained in section 1 the flow of the non wetting phase is deflected by the interface and moves to the left and right sides of the lens dnapl starts accumulating and capillary pressure builds up the scheme predicts accurately the breakthrough values in all three mesh configurations when dnapl reaches the lower interface the scheme also successfully captures the capillary end effect hadley and handy 1956 huang and honarpour 1998 the dnapl saturation at the lower interface of the lens suddenly drops to non wetting phase residual saturation while on the other side of the interface this value remains smaller than the critical one high entry pressure in case b shows its strong impact on the flow pattern and completely prevents dnapl from entering the lens in two cases the numerical results fit with experiment data first order and second order upwind schemes show similar behaviors of flow at the interfaces in the plateau region in the brooks corey capillary pressure curve capillary pressure is less sensitive to saturation therefore a small discrepancy of saturation at the upper interface predicted by the two methods is amplified at the top of the lens capillary pressure equilibrium is likely maintained when non wetting phase enters less permeable material for flow in the opposite direction the continuity of capillary pressure is not guaranteed the average iteration count needed to compute the saturation at the interface in the three meshes with respect to case a are indicated in fig 8 as can be seen the count increases when the dnapl reaches the material interface all models predict the breakthrough time very closely and have similar profiles case b highlights the strong effect of entry pressure on two phase flow since the critical saturation is not achieved the dnapl cannot enter the lens consequently it reaches the bottom side earlier and accumulates more in comparison with case a fig 7 shows the saturation profile of the two cases after 5400 seconds the cpu times of the new scheme and typical fefvm are obtained on a 2 2 ghz x86 cpu and represented on table 5 when the lens has high entry pressure where only the pressure equation is coupled in the new scheme modelling the discontinuities adds extra computational cost this increase is comparable with the performance measures obtained by the work of nick and matthäi 2011b coupling transport equation at the material interface with regards to low entry pressure lens however does not contribute as high cpu time as the coupling pressure equation 3 3 analysis of buoyancy driven flow across multiple material interfaces to demonstrate the ability of the new scheme to simulate more geometrically challenging models and perform correctly in the presence of buoyancy forces a two dimensional model of a cross section of a faulted rock sequence was simulated this model is based on the section presented in nick and matthäi 2011b and contains multiple interfaces the model is used to simulate the rise of co2 up through the footwall of an impermeable fault cutting a storage horizon the geometry and material properties are shown in fig 9 and table 6 initially the model is fully saturated by water then co2 is injected with the rate q n 6 25 10 5 m 3 s 1 through a window of 0 2 m at the bottom fig 10 shows the expected accumulation of co2 below the capillary barrier between rt1 and rt4 similar to infiltration in the dnapl case the new scheme is tvd and gives plausible saturation values that satisfy the interface condition at any time step at time step t 1200 s co2 reaches the rt1 rt4 interface and starts pooling at the interface because of that the flow direction changes from upward to the right the flow velocity becomes very small then the accumulation of co2 in this area gives way to buoyancy force the flow velocity increases dramatically as co2 migrates along with the interface to the right at time step t 1615s breakthrough occurs at the intersection point of three interfaces rt1 rt2 rt1 rt4 and rt2 rt4 since the entry pressure of rt2 is far higher than rt4 and rt1 co2 breaks through rt1 rt4 interface the flow at breakthrough accelerates and co2 enters rt4 rapidly at the same time the diffusion of co2 on the rt4 side of the rt1 rt4 interface triggers breakthrough and broadens the breached area this increase in contrast reduces the velocity of the flow these phenomena repeat when co2 moves from rt3 to rt1 at t 3075 s at rt4 rt1 and rt1 rt3 interfaces the capillary end effect is clearly visible however along with the interface with rt2 on the right both phases move upward quickly maintaining high flux rate of co2 and capillary pressure is continuous as the main flow occurs near the interfaces with rt2 on the right the flow velocity becomes small in other regions as a consequence co2 saturation drops on the right of the rt1 rt4 interface fig 10 d while co2 on the rt4 side moves upward by buoyancy its supply from rt1 diminishes and the capillary barrier is reestablished besides capturing the breakthrough event the new interface scheme reproduces the repeated capillary trapping by the interfaces i e the toggle switch behavior seen in the laboratory see benzing and shook 1996 fig 11 illustrates the striking difference in the saturation profile computed by a fefvm model without discontinuities and the reported scheme in the beginning the schemes yield very similar profiles however as soon as co2 reaches the material interfaces the fefvm fails to reproduce the jump discontinuity 3 4 simulation of water flooding of a heterogeneous medium in this test case we observe the effect of entry pressure contrasts on the imbibition process a two dimensional horizontal model fig 12 is composed of rectangular low permeability lenses embedded in a high permeability water wet rock initially this system is saturated with oil non wetting phase then freshwater wetting phase is injected from the left side rate of 6 m3 day table 7 provides fluid and rock properties fig 13 a d show the saturation of the domain after 2 5 days 5 days 7 5 days and 10 days as can be seen when the water reaches the fine grained lenses spontaneous imbibition occurs the oil is displaced from the lenses by the water and capillary pressure in the lenses suddenly drops to entry pressure level during this displacement capillary pressure is in equilibrium the oil saturation in front of these lenses is reduced since the oil is displaced to the right similar to the previous cases dynamic resealing occurs when the flow moves parallel to the lenses because of the non wetting phase lock flow velocity in flooded lenses is small and oil leaks slowly into country rock mainly by capillary diffusion the sharp jump of oil saturation is clearly visible 3 5 simulation of the flow of supercritical co2 through a laminated core a 3d core sample consisting of four different rock types from poorly to well sorted are stacked in 13 parallel laminations fig 14 saturation functions are determined by network modelling øren et al 2019 fig 15 shows the capillary and relative permeability curves and table 8 provides further properties of rocks and fluids a numeric flow experiment was conducted applying a pressure difference of 5kpa between top and bottom boundaries of the specimen the sides of the sample are no flow boundaries and the bottom face is assigned a constant co2 saturation fig 16 shows the saturation of co2 at different time steps capillary trapping and breakthrough phenomena are successfully reproduced by our scheme at time step t 20s the interface between rt4 and rt2 displays an accumulation of co2 then breakthrough occurs at the rear of the sample after a short build up period similarly to the previous simulation cases the capillary end effect is seen in many interfaces however it does not occur at the interface between rt3 and rt4 the small difference of their entry pressure and the strong flow rate causes the co2 flux at this interface to be relatively high as a result the first of the extended pressure conditions is valid capillary equilibrium persists even though co2 enters a coarse grain layer rt4 from a finer grain layer rt3 the repetition of the saturation profile at interfaces demonstrates the consistency of our algorithm 4 discussion the dfefvm has great potential for simulating two phase flow in porous media with discontinuities nick and matthäi 2011b nick and matthäi 2011a because flow domains can be modelled accurately using a minimal number degree of freedoms however nick and matthäi 2011a did not yet demonstrate the strong effects of these discontinuities when capillary pressure involved the current study achieves this by integrating the interface conditions of van duijn and de neef 1998 within the dfefvm nick and matthäi 2011b use the averaged perpendicular velocity to material interfaces to update saturation this method is efficient in terms of computation however it does not show realistic results when the flow meets the interfaces at a small angle and the method of niessner et al 2004 requires the flow to be perpendicular to the interface these issues are resolved in our scheme similarly to chavent and jaffre 1986 and ahmed et al 2017 this study employs the global pressure formulation where pressure is always defined whether a phase exists or not this formulation therefore circumvents the assumption that the domain is initially saturated by wetting phase as in bastian 1999 and niessner et al 2004 while many numerical schemes assume phase pressure continuity across the interface helmig 1997 reichenberger et al 2006 bastian 2014 hoteit and firoozabadi 2008 and ahmed et al 2019 physical experiments show a pressure drop when capillary blockage occurs see benzing and shook 1996 and shosa and cathles 2001 in a system with strong coupling between pressure and saturation modelling the discontinuities of pressures and saturation are equivalently important experiments also show that the transition between breakthrough and sealing of an interface occurs rapidly and these quick events can change the flow pattern therefore a locally time adaptive explicit transport scheme is more suitable than an implicit one in comparison with a fully implicit method our scheme suffers from a time step constraint above results highlight the benefit of using very fine elements at the interfaces and they show that velocity at the breakthrough of the interfaces is many orders of magnitude higher than other regions the coincidence of this high speed flow with small finite volumes implies that very small time steps are required which slows down the whole simulation nick and matthäi 2011a to alleviate this effect the idea of the interface treatment which was introduced in section 2 2 could be combined with the discrete event simulation des technique des updates only a small number of fv cells at any one time while excluding slow flowing cells from computations shao et al 2019 5 conclusion in this work we present a capillary interface coupling scheme for immiscible two phase flow and transport in heterogeneous porous media taking account discontinuities of material properties this scheme is based on impes entails a global pressure formulation and extends the finite element finite volume method with embedded discontinuities by coupling decoupling of variables at material interfaces this is achieved in three steps a observe the physical state of flow at the material interface b couple decouple pressure by modifying the conductance matrix and load vector and c couple decouple saturation by applying interface conditions these coupling decoupling processes are performed locally without affecting the global system of equations we demonstrate the new scheme with a range of test cases for one two and three dimensional models with complex features such as multiple rock laminations or mutually intersecting objects the results show that physical phenomena such as vapour lock breakthrough capillary end effect and resealing are correctly captured even with a relatively coarse mesh our proposed first order and second order scheme also is locally conservative and van dujin and de neef s conditions are always satisfied declaration of competing interests none credit authorship contribution statement l k tran conceptualization methodology software writing original draft j c kim software s k matthäi supervision software writing review editing acknowledgments the authors wish to acknowledge the financial assistance provided through the australian national low emissions coal research and development anlec r d 7 1115 0258 anlec r d is supported by coal21 ltd and the australian government through the clean energy initiative supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2020 103636 appendix a supplementary materials supplementary data s1 supplementary raw research data this is open data under the cc by license http creativecommons org licenses by 4 0 supplementary data s1 
448,geologic boundaries juxtaposing fine against coarse grained rock have a profound impact on multiphase flow giving rise to a spectrum of non linear flow behaviors ranging from capillary filtration capillary holdup and the formation of transient vapour locks to spontaneous imbibition although these discontinuities tend to be small scale features their impact is felt on the large scale where they are challenging to model with regard to both spatial discretization and dynamic flow simulation we develop a new numerical scheme to handle jump discontinuities in pressure and saturation embedding boundaries into a hybrid fe fvm model of immiscible two phase flow in porous media the integration of interface conditions is an extension of the discontinuous finite element finite volume method dfefvm a unique feature of it is that saturation at the interface is computed locally without constructing a system of equations and in contrast with other schemes it offers sufficient degrees of freedom to accommodate disequilibrium in pressure a range of test cases including gravity capillary pressure and material discontinuities are presented to verify validate and show the effectiveness of the new simulation method keywords two phase flow heterogeneous media material interfaces capillary trapping dfefvm 1 introduction multiphase flow through porous soils sedimentary rocks or volcaniclastics forms an integral part of a wide range of processes occurring in different geologic settings such as infiltration of the vadose zone geothermal circulation biogenic methanogenesis or secondary hydrocarbon migration these processes occur on vastly different time and length scales the length scale affects the balance between the driving forces while capillary forces tend to dominate on the pore scale viscous and gravitational forces determine flow on the km scale notwithstanding dynamic km scale capillary barriers are well documented in the engineering literature e g watts 1987 and are related to the interplay of geologic heterogeneity with wettability and saturation this interplay gives rise to rich flow patterns and sharp saturation discontinuities collocated at material interfaces as illustrated in a photograph of an outcrop of fractured sandstone that was infiltrated by water draining from overlying soil fig 1 beyond variation of the external conditions flow can become episodic and varying discontinuously over time thus multiphase flow across a coarse fine material interface can come to a halt when the non wetting phase collects upstream of it yet remaining at a pressure that is below the entry pressure of the fine grained layer this process has been termed vapour lock and benzing and shook 1996 studied its dynamics in the laboratory they showed that in the presence of gravity the build up of buoyant non wetting phase below horizontal interfaces may eventually break the lock dynamic seal leading to a sudden fluid discharge that only ends when the accumulation has drained and the process can repeat in addition to such relaxation oscillations spontaneous imbibition of a fine grained layer saturated with non wetting phase will occur when this layer is brought in contact with the wetting phase as this happens the spontaneous pressure drop that ensues when water enters the fine grained layer it causes rapid displacement of the non wetting phase from the layer both the formation and breakdown of a vapour lock and the spontaneous imbibition into a water wet non wetting phase saturated layer are material interface processes posing modelling challenges because they locally perturb system behavior in a nonlinear fashion such perturbations induce spatio temporal discontinuities in pressure and saturation requiring additional degrees of freedom to capture them while a vapour lock exists at a capillary barrier fluid pressure is decoupled across it and flows parallel to the interface can evolve independently on either side this state will persist until the capillary entry pressure of barrier is exceeded flow occurs and the pressure discontinuity disappears again it follows that a realistic model of this process will need to be able to deal with such temporal jump discontinuities in pressure and saturation as well as their toggle switch control of fluid flow notably geologic porous media are full of capillary interfaces with intricate shapes difficult to resolve already at the level of geometric modelling capturing the dynamics of multiphase flow in such heterogeneous rock sequences provides a formidable modelling and upscaling challenge kueper et al 1989 dawe et al 1992 krause et al 2009 and shi et al 2011 introducing a new numeric method for the simulation of such interface dynamics is the subject of this article the described behavior of capillary interfaces has already been subjected of considerable analysis on the basis of which a new numeric model can be built van duijn et al 1995 proposed a semi analytic model including interface conditions to represent the effect of the capillary entry pressure correa and firoozabadi 1996 studied gas oil gravity drainage concluding that capillary pressure contrasts promote instabilities in the system other studies have attempted to treat interface transfer numerically classic finite difference approaches only consider transfer along the grid axes and zero dimensional transfer functions are used in the modelling of fracture matrix transfer in dual continua models see review in gilman 2003 finite volume fv and finite element fe methods and combinations thereof permit the use of unstructured meshes for the discrete representation of material interfaces cordes and kinzelbach 1992 and geiger et al 2004 without specific provisions these methods cannot describe jump discontinuities in pressure and or saturation because in the fem dependent variables are continuous across element interfaces in the fvm interfaces can only be resolved using transmissibility multipliers thus dependent variable discontinuities are smeared across interfaces to study this behavior helmig and huber 1998 compared a fully upwind galerkin method with standard galerkin and petrov galerkin methods while the standard galerkin method is not even locally conservative the petrov galerkin method can create nonphysical results the fully upwind galerkin method provides reasonable results but the jump discontinuity of saturation at the material interface gives way to a sharp gradient to resolve the jump discontinuity correctly bastian 1999 and niessner et al 2004 introduced additional degrees of freedom at the interface nodes however this approach does not guarantee mass conservation when flow occurs at an angle to the interface cancés et al 2009 study the convergence of finite volume scheme which takes account the effect of capillary pressure discontinuity wolff et al 2012 and bazrafkan et al 2014 use cell centred finite volume method for two phase flow but discontinuities in capillary pressure are not represented on cell centred multi point flux approximation framework cvd mpfa friis et al 2008 ahmed et al 2019 formulate capillary flux approximation which implies van duijn de neef condition van duijn et al 1995 hoteit and firoozabadi 2008 successfully combined the mixed finite element approach with the discontinuous galerkin method dgm capturing the saturation discontinuity in a mass conservative scheme ern et al 2010 and bastian 2014 subsequently pioneered the fully discontinous galerkin method in the dgm each node carries multiple saturation values as a result of this increase in the degrees of freedom the method requires much more computational resources than competing finite element finite volume methods fefvm kim and deo 1999 geiger et al 2004 and nick and matthäi 2007 in these hybrid methods the rock is represented by a finite element mesh which conforms to material interfaces see fig 2 a porosity permeability and relative permeability are treated as piecewise constant within each element while pressure and saturation are discretized as piecewise linear on the finite element nodes therefore undesirable smearing effects occurs between heterogeneous regions nick and matthäi 2011a improve this fefvm by introducing interface elements see fig 2 b where nodes coincide with material interfaces they are replicated as many times as different materials are joint with one another at this location thus the mesh is split along internal boundaries and then reconnected by interface elements these lightweight elements act as a proxy which controls the mesh connectivity this node centred finite volume finite element discretization with embedded discontinuities dfefvm can capture both pressure and saturation discontinuities precisely all cited studies show that when capillary entry pressure is not considered the interface condition of van duijn et al 1995 is not satisfied here we extend the dfefvm by an interface coupling algorithm that manages to reproduce the complex toggle switch behavior discussed above it will be shown that as a consequence pressure and saturation are no longer artificially continuous nor smeared across the interface respectively the scheme has been developed with large capillary pressure contrasts between layers in mind and the coupling algorithm for the disjointed mesh satisfies the interface conditions without any flux averaging part of the concept is a local time stepping control framework to manage localize and capture quick changes of physical variables across the interface we show that this scheme is locally conservative and interface conditions are satisfied at all times this paper is organized as follows we first review the interface conditions and governing equations for slightly compressible immiscible two phase flow in porous media with material interfaces in detail second we introduce the new numerical treatment of interface fluxes and decoupling coupling behavior third a range of test cases is presented and discussed for model verification and validation with results from a recent physical experiment involving the flow of supercritical co2 through a laminated drill core that was monitored real time with x ray tomography 2 methodology for simplicity the new scheme is described here only for incompressible immiscible two phase flow in heterogeneous porous media 2 1 governing equation similar to durlofsky 1993 and helmig 1997 we use implicit pressure explicit saturation impes to perform an operator splitting solving the elliptic parabolic pressure equation with the fem and the hyperbolic transport equation with the fvm the system of equations is solved in a sequential manner the total pressure equation elliptic is solved by fem then the total velocity vt is computed from the gradient of total pressure by darcy s law after that the transport equation is used to update saturation with the appearance of material interfaces additional effort is required to achieve correct flow variable values at the material interface we use the interface condition of van duijn et al 1995 to solve the saturation on either side of the interfaces 2 1 1 pressure equation the transport process is described by the well know system of equations 1a ϕ s w t v w q w 1b ϕ s n t v n q n 1c p c s w p n p w 1d s w s n 1 here v α qα and sα are the velocity volume flow rate and saturation of phase α α n w pc sw and ϕ are the capillary pressure function and porosity of reservoir rock respectively for slow viscous flow the phase velocity can be computed directly from the phase pressure gradient by applying the multiphase flow form of darcy s law 2 v α k λ α p α ρ α g k indicates the permeability tensor of medium g is the gravitational acceleration and ρα is the phase density phase mobility λα is defined as the ratio of the relative permeability krα sw and viscosity μα of phase α 3 λ α k r α μ α among many approaches to solve system of eq 1 such as impes fully implicit method fi and sequential chen et al 2006 lie 2016 we opt impes because of its simplicity in implementation and robustness for solving two phase flow despite its restriction on time step with impes the pressure and saturation equations are treated separately and solved sequentially since we are interested primarily in flow at the meter scale and below we employ the global pressure formulation which was originally proposed by chavent and jaffre 1986 4 p p w 1 s n r s w f n d p c d s w ζ d ζ snr refers to the residual saturation of non wetting phase and fn is the non wetting phase fractional flow 5 f n λ n λ n λ w λ n λ the double exponential integration technique takahasi and mori 1974 is used to compute the integral term in eq 4 efficiently accordingly phase pressure can be recovered adding eqs 1a and 1b to get the elliptic pressure equation 6 k λ t p λ n ρ n λ w ρ w g q n q w q t on an unstructured grid this elliptic equation can be solved using the standard finite element method on a domain comprised of ne isoparametric elements integration of eq 6 yields 7 i n e ω e n t k λ t n d ω p i n e γ e n t n q s d γ γ e n t n q t d γ ω e n t k g n λ n ρ n λ w ρ w d ω which can be written as a system of linear algebraic equations 8 a p b 2 1 2 saturation transport equation the saturation equation for the non wetting phase written in a fractional flow form is 9 ϕ s n t f n v t λ k p c λ k ρ w ρ n g q n where λ is the mobility product defined as 10 λ λ n λ w λ n λ w the finite volume method is used to solve this eq 9 for finite volumes constructed from nj facets surrounding each finite element node i the non wetting phase saturation is updated by using the explicit upwind scheme 11 s n i t δ t s n i t δ t δ v j n j f j ω q n d ω the flux over the facet j is evaluated at each facet integration point 12 f j γ j v j t a j n j d γ f j u p v t j λ j u p k p c ρ w ρ n g a j n j finite volumes at the region boundaries are truncated therefore a volume flux compensation term is required to achieve correct saturation values at where there is a flux across a boundary that term is computed similar to the flux over finite volume facets but the fractional flow and mobility values are evaluated at the boundary nodes instead of using an up winding technique 13 c j i f j i v t j λ j i k p c ρ w ρ n g a j n j the saturation at the boundary is updated by introducing the additional term 14 s n i t δ t s n i t δ t δ v j n j f j ω q n d ω j n j c j i in the next section we will show how the compensation term ci is used to compute saturation at material interfaces 2 2 treatment of interface conditions because the elements on the opposite side of the material interface do not share nodes we need to couple the pressure and saturation variables while the dfefvm discretization allows discontinuities by treating these nodes and elements as internal mesh boundaries the operators needed to evaluate boundary fluxes are standard fe surface integrals which are evaluated on these mesh entities two conditions need to be imposed consider a domain which is composed of two media r i and r ii and p d i p d i i defining the critical saturation value s w as p c i s w p d i i the first condition concerns the continuity of each phase flux over the interface as there is no mass added lost in this process the fluxes transferred across the interface must balance 15 f α i f α i i described as extended pressure condition by van duijn and de neef 1998 the second condition relates to the continuity of capillary pressure over the interface the capillary pressure is continuous across the interface only if there is a pair of interface saturations s w i s w i i satisfying s w s w i fig 3 a otherwise there are no feasible saturation values at the interface that make capillary continuous fig 3 b in this case the s w i i jumps to 1 and p c i i p d thus saturation is always discontinuous across the interface except when the two capillary curves are identical the second condition can be rewritten as 16 s w i i p c i i 1 p c i s w i if s w i s w 1 otherwise 2 2 1 coupling pressure to solve the pressure equation we select from the multiplicated nodes those that belong to the adjacent region with the lowest capillary entry pressure the other nodes at the same location are treated as shown in fig 2 b whether there is flow across the material interface determines the coupling between multiplicated nodes if there is no fluid exchanged over the interfaces there is no need to couple pressure values because the nodal pressure values evolve independently when fluid moves across the interface we also modify the diagonal terms of the conductance matrix a and the load vector b in eq 8 as demonstrated by nick and matthäi 2011b this amounts to a strong coupling between nodes and forces pressures to be equal the algorithm for coupling pressure of duplicated nodes corresponding to row i and j in the matrix a and the vector b is briefly described in the following manner because of the strong discontinuity in the dfefvm the terms a i j and a j i equal to zero this algorithm can be extended readily to couple pressure of multiplicated nodes at interfaces 2 2 2 coupling transport similar to the pressure system of equations the presence or absence of flow across a material interface determines how saturation values are coupled before breakthrough the interface acts as a no flow boundary therefore nodal saturation only depends on element internal neighbour nodes during transfer across the interface if the saturation s α t δ t at the interface node is known the saturation on the opposite side node is computed from the interface condition 16 the compensation flux c i s n t δ t for finite volumes which connect to this node is evaluated straightforwardly by eq 14 to guarantee local mass conservation the total flux exchanged among surrounding facets of multiplicated nodes must equal to zero 17 r s n t δ t i n c i s n t δ t 0 eq 17 is nonlinear so an iterative method is required to find the saturation value on each side of the interface in order to guarantee robustness as well as execution speed the iterative methods such as brent 1971 and chandrupatla 1997 are used these methods do not require to compute the derivative and utilize the inverse quadratic interpolation whenever possible resulting in super linear convergence rates they allow the saturation values at the interface nodes to be updated locally and simultaneously without any further post processing or averaging processes 3 test cases and applications we have applied the new interface coupling scheme to a series of one two and three dimensional models first we verify the code by comparing the numerical result with the semi analytical solution second the infiltration of dnapl into a high permeability lens with different entry pressure test cases is conducted the purpose of the test case is to verify that the scheme handles the interface condition correctly for both equilibrium and non equilibrium capillary pressure cases next a heuristic model of a fault offsetting a layered rock sequence is solved finally we simulate a 3d drill core model which is flooded with supercritical co2 all the cases are simulated with a second order accurate in space upwind scheme the absolute flux residual value for convergence of the brent solver is set to 10 14 the new dfefvm scheme has been implemented on the basis of the csmp application programmer interface that is co developed by an originators groups of universities including ethz imperial college london and the university of melbourne e g yapparova et al 2017 3 1 verification with van duijn de neef solution the new extended dfefvm method is verified with the semi analytical solution of van duijn and de neef 1998 derived for a one dimensional domain of length 0 4 consisting of two different materials which share an interface the left side is initially fully saturated by wetting phase and the right side is fully saturated by non wetting phase normalized fluid and media properties are shown in table 2 the hysteresis of capillary pressure and relative permeability is ignored the brook corey model is used because it can represent a capillary entry pressure for the non wetting phase which is a function of the pore size distribution in the medium 18a k r w s e 2 3 λ λ 18b k r n 1 s e 2 1 s e 2 λ λ 19a p c x p d x s e 1 λ 19b p d x σ ϕ k x the effective saturation se is computed as in helmig 1997 20 s e s w s w r 1 s w r s n r in the absence of external forces gravity and viscous capillary pressure is the only driving force as a result phase redistribution is controlled by the capillary pressure discrepancy across the interface and total velocity equals to zero this process is reproduced by the semi analytical and our numerical methods on a mesh of 120 uniform elements starting with the same material properties in the whole model case a we increase the permeability and entry pressure contrast of materials on the left side and the right side case b and c the results for three test cases at three different time steps t 1 2 and 3 are depicted in fig 4 case a the material properties of two sub domains are identical with k l k r 10 3 and p d l p d r 10 the saturation profile and capillary profile are smooth over the interface sw 0 52 fig 4 a shows that the numerical solution fits with the semi analytical solution case b permeability of the right region is reduced to k r 6 4 10 4 and its entry pressure is increased to p d r 12 5 the critical wetting phase saturation computed by condition 16 is s w 0 64 the wetting phase saturations on either side of the interface are different with s w l 0 39 and s w r 0 78 the critical saturation lies between s w r and s w l hence the capillary pressure still is continuous p r s w r 0 39 p l s w l 0 78 16 01 fig 4 b shows that the numerical results are in good agreement with the semi analytical solution case c the property contrast is increased by changing the entry pressure and normalized permeability of the right region to p d r 20 and k r 2 5 10 4 the critical saturation value now is s w 0 25 as can be seen in fig 4 c capillary equilibrium could not be established and the water saturation on the right side jumps to 1 again the numerical solution is in good agreement with the semi analytical solution and without any additional relaxation 3 2 infiltration of dnapl into a high entry pressure lens this test case simulates a physical experiment which was described by bastian and helmig 1999 the model in this test case is built of a low permeability lens embedded in a homogeneous high permeability host rock the geometry and boundary conditions are illustrated in fig 5 and material properties are introduced in table 3 top and bottom are no flow boundaries except a small window where dnapl is injected at a rate of 0 075 kg m2 s at the left and right boundary hydrostatic pressure is applied two different values of entry pressure of the lens are explored to illustrate its effect on two phase flow three mesh configurations are generated to demonstrate the capability of the scheme to reproduce the physical behavior at different levels of resolution and to assert the computation cost in case a a small entry pressure value of p d 2 1163 5 pa is assigned to the lens and the critical saturation of the non wetting phase computed from eq 16 is s n 0 63 in case b we increase the entry pressure of the lens to p d 2 1466 1 pa and the critical saturation changes to s n 0 76 the final step of two cases are shown in fig 6 all three mesh configurations yield similar results the dnapl saturation profile is measured at the central line of the model at different time steps fig 7 in case a the non wetting phase reaches the lens at t 720 s as explained in section 1 the flow of the non wetting phase is deflected by the interface and moves to the left and right sides of the lens dnapl starts accumulating and capillary pressure builds up the scheme predicts accurately the breakthrough values in all three mesh configurations when dnapl reaches the lower interface the scheme also successfully captures the capillary end effect hadley and handy 1956 huang and honarpour 1998 the dnapl saturation at the lower interface of the lens suddenly drops to non wetting phase residual saturation while on the other side of the interface this value remains smaller than the critical one high entry pressure in case b shows its strong impact on the flow pattern and completely prevents dnapl from entering the lens in two cases the numerical results fit with experiment data first order and second order upwind schemes show similar behaviors of flow at the interfaces in the plateau region in the brooks corey capillary pressure curve capillary pressure is less sensitive to saturation therefore a small discrepancy of saturation at the upper interface predicted by the two methods is amplified at the top of the lens capillary pressure equilibrium is likely maintained when non wetting phase enters less permeable material for flow in the opposite direction the continuity of capillary pressure is not guaranteed the average iteration count needed to compute the saturation at the interface in the three meshes with respect to case a are indicated in fig 8 as can be seen the count increases when the dnapl reaches the material interface all models predict the breakthrough time very closely and have similar profiles case b highlights the strong effect of entry pressure on two phase flow since the critical saturation is not achieved the dnapl cannot enter the lens consequently it reaches the bottom side earlier and accumulates more in comparison with case a fig 7 shows the saturation profile of the two cases after 5400 seconds the cpu times of the new scheme and typical fefvm are obtained on a 2 2 ghz x86 cpu and represented on table 5 when the lens has high entry pressure where only the pressure equation is coupled in the new scheme modelling the discontinuities adds extra computational cost this increase is comparable with the performance measures obtained by the work of nick and matthäi 2011b coupling transport equation at the material interface with regards to low entry pressure lens however does not contribute as high cpu time as the coupling pressure equation 3 3 analysis of buoyancy driven flow across multiple material interfaces to demonstrate the ability of the new scheme to simulate more geometrically challenging models and perform correctly in the presence of buoyancy forces a two dimensional model of a cross section of a faulted rock sequence was simulated this model is based on the section presented in nick and matthäi 2011b and contains multiple interfaces the model is used to simulate the rise of co2 up through the footwall of an impermeable fault cutting a storage horizon the geometry and material properties are shown in fig 9 and table 6 initially the model is fully saturated by water then co2 is injected with the rate q n 6 25 10 5 m 3 s 1 through a window of 0 2 m at the bottom fig 10 shows the expected accumulation of co2 below the capillary barrier between rt1 and rt4 similar to infiltration in the dnapl case the new scheme is tvd and gives plausible saturation values that satisfy the interface condition at any time step at time step t 1200 s co2 reaches the rt1 rt4 interface and starts pooling at the interface because of that the flow direction changes from upward to the right the flow velocity becomes very small then the accumulation of co2 in this area gives way to buoyancy force the flow velocity increases dramatically as co2 migrates along with the interface to the right at time step t 1615s breakthrough occurs at the intersection point of three interfaces rt1 rt2 rt1 rt4 and rt2 rt4 since the entry pressure of rt2 is far higher than rt4 and rt1 co2 breaks through rt1 rt4 interface the flow at breakthrough accelerates and co2 enters rt4 rapidly at the same time the diffusion of co2 on the rt4 side of the rt1 rt4 interface triggers breakthrough and broadens the breached area this increase in contrast reduces the velocity of the flow these phenomena repeat when co2 moves from rt3 to rt1 at t 3075 s at rt4 rt1 and rt1 rt3 interfaces the capillary end effect is clearly visible however along with the interface with rt2 on the right both phases move upward quickly maintaining high flux rate of co2 and capillary pressure is continuous as the main flow occurs near the interfaces with rt2 on the right the flow velocity becomes small in other regions as a consequence co2 saturation drops on the right of the rt1 rt4 interface fig 10 d while co2 on the rt4 side moves upward by buoyancy its supply from rt1 diminishes and the capillary barrier is reestablished besides capturing the breakthrough event the new interface scheme reproduces the repeated capillary trapping by the interfaces i e the toggle switch behavior seen in the laboratory see benzing and shook 1996 fig 11 illustrates the striking difference in the saturation profile computed by a fefvm model without discontinuities and the reported scheme in the beginning the schemes yield very similar profiles however as soon as co2 reaches the material interfaces the fefvm fails to reproduce the jump discontinuity 3 4 simulation of water flooding of a heterogeneous medium in this test case we observe the effect of entry pressure contrasts on the imbibition process a two dimensional horizontal model fig 12 is composed of rectangular low permeability lenses embedded in a high permeability water wet rock initially this system is saturated with oil non wetting phase then freshwater wetting phase is injected from the left side rate of 6 m3 day table 7 provides fluid and rock properties fig 13 a d show the saturation of the domain after 2 5 days 5 days 7 5 days and 10 days as can be seen when the water reaches the fine grained lenses spontaneous imbibition occurs the oil is displaced from the lenses by the water and capillary pressure in the lenses suddenly drops to entry pressure level during this displacement capillary pressure is in equilibrium the oil saturation in front of these lenses is reduced since the oil is displaced to the right similar to the previous cases dynamic resealing occurs when the flow moves parallel to the lenses because of the non wetting phase lock flow velocity in flooded lenses is small and oil leaks slowly into country rock mainly by capillary diffusion the sharp jump of oil saturation is clearly visible 3 5 simulation of the flow of supercritical co2 through a laminated core a 3d core sample consisting of four different rock types from poorly to well sorted are stacked in 13 parallel laminations fig 14 saturation functions are determined by network modelling øren et al 2019 fig 15 shows the capillary and relative permeability curves and table 8 provides further properties of rocks and fluids a numeric flow experiment was conducted applying a pressure difference of 5kpa between top and bottom boundaries of the specimen the sides of the sample are no flow boundaries and the bottom face is assigned a constant co2 saturation fig 16 shows the saturation of co2 at different time steps capillary trapping and breakthrough phenomena are successfully reproduced by our scheme at time step t 20s the interface between rt4 and rt2 displays an accumulation of co2 then breakthrough occurs at the rear of the sample after a short build up period similarly to the previous simulation cases the capillary end effect is seen in many interfaces however it does not occur at the interface between rt3 and rt4 the small difference of their entry pressure and the strong flow rate causes the co2 flux at this interface to be relatively high as a result the first of the extended pressure conditions is valid capillary equilibrium persists even though co2 enters a coarse grain layer rt4 from a finer grain layer rt3 the repetition of the saturation profile at interfaces demonstrates the consistency of our algorithm 4 discussion the dfefvm has great potential for simulating two phase flow in porous media with discontinuities nick and matthäi 2011b nick and matthäi 2011a because flow domains can be modelled accurately using a minimal number degree of freedoms however nick and matthäi 2011a did not yet demonstrate the strong effects of these discontinuities when capillary pressure involved the current study achieves this by integrating the interface conditions of van duijn and de neef 1998 within the dfefvm nick and matthäi 2011b use the averaged perpendicular velocity to material interfaces to update saturation this method is efficient in terms of computation however it does not show realistic results when the flow meets the interfaces at a small angle and the method of niessner et al 2004 requires the flow to be perpendicular to the interface these issues are resolved in our scheme similarly to chavent and jaffre 1986 and ahmed et al 2017 this study employs the global pressure formulation where pressure is always defined whether a phase exists or not this formulation therefore circumvents the assumption that the domain is initially saturated by wetting phase as in bastian 1999 and niessner et al 2004 while many numerical schemes assume phase pressure continuity across the interface helmig 1997 reichenberger et al 2006 bastian 2014 hoteit and firoozabadi 2008 and ahmed et al 2019 physical experiments show a pressure drop when capillary blockage occurs see benzing and shook 1996 and shosa and cathles 2001 in a system with strong coupling between pressure and saturation modelling the discontinuities of pressures and saturation are equivalently important experiments also show that the transition between breakthrough and sealing of an interface occurs rapidly and these quick events can change the flow pattern therefore a locally time adaptive explicit transport scheme is more suitable than an implicit one in comparison with a fully implicit method our scheme suffers from a time step constraint above results highlight the benefit of using very fine elements at the interfaces and they show that velocity at the breakthrough of the interfaces is many orders of magnitude higher than other regions the coincidence of this high speed flow with small finite volumes implies that very small time steps are required which slows down the whole simulation nick and matthäi 2011a to alleviate this effect the idea of the interface treatment which was introduced in section 2 2 could be combined with the discrete event simulation des technique des updates only a small number of fv cells at any one time while excluding slow flowing cells from computations shao et al 2019 5 conclusion in this work we present a capillary interface coupling scheme for immiscible two phase flow and transport in heterogeneous porous media taking account discontinuities of material properties this scheme is based on impes entails a global pressure formulation and extends the finite element finite volume method with embedded discontinuities by coupling decoupling of variables at material interfaces this is achieved in three steps a observe the physical state of flow at the material interface b couple decouple pressure by modifying the conductance matrix and load vector and c couple decouple saturation by applying interface conditions these coupling decoupling processes are performed locally without affecting the global system of equations we demonstrate the new scheme with a range of test cases for one two and three dimensional models with complex features such as multiple rock laminations or mutually intersecting objects the results show that physical phenomena such as vapour lock breakthrough capillary end effect and resealing are correctly captured even with a relatively coarse mesh our proposed first order and second order scheme also is locally conservative and van dujin and de neef s conditions are always satisfied declaration of competing interests none credit authorship contribution statement l k tran conceptualization methodology software writing original draft j c kim software s k matthäi supervision software writing review editing acknowledgments the authors wish to acknowledge the financial assistance provided through the australian national low emissions coal research and development anlec r d 7 1115 0258 anlec r d is supported by coal21 ltd and the australian government through the clean energy initiative supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2020 103636 appendix a supplementary materials supplementary data s1 supplementary raw research data this is open data under the cc by license http creativecommons org licenses by 4 0 supplementary data s1 
449,this paper presents analytical solutions for pumping from a poroelastic confined aquifer where the combined effects of a finite thickness skin zone and the wellbore storage are fully incorporated the pumping induced axisymmetric stress plane strain deformation and pore pressure are derived in the laplace transform domain time domain solutions are obtained using the stehfest inversion algorithm numerical examples are presented to investigate the effects of hydromechanical coupling and poroelasticity on the hydraulic drawdown at the pumping well and at an observation well the results show that traditional methods substantially underestimate the drawdown at the pumping well in a low permeability hard rock compared with the drawdown predicted using the fully coupled poroelastic theory the difference becomes more pronounced when a finite thickness positive skin is present with a permeability that is lower than the permeability of the formation for finite radius pumping wells with storage the effects of poroelasticity on drawdown are masked by the effects associated with wellbore storage keywords poroelasticity wellbore skin wellbore storage pumping test confined aquifer nomenclature α biot coefficient ε rr radial strain ε kk bulk strain ζ increment of fluid content µf pore fluid viscosity ml 1t 1 ν u undrained poisson s ratio σ ij total stress m l 1 t 2 σ rr radial stress m l 1 t 2 σzz axial stress m l 1 t 2 c hydraulic diffusivity l2 t 1 p excess pore pressure m l 1 t 2 r radial distance from the axis of the pumping well l r s radius of skin zone l s h hydraulic drawdown l u r radial displacement l c w wellbore storage coefficient l2 g shear modulus m l 1 t 2 i 0 modified bessel function of the first kind of order zero k 1 modified bessel function of second kind of first order k f bulk modulus of fluid m l 1 t 2 k v drained vertical bulk modulus m l 1 t 2 n total number of terms in the stehfest series q volumetric pumping rate l3t 1 superscript dimensionless variable εij strain components ε θθ hoop strain εzz axial strain κ mobility m 1 l3 t ν drained poisson s ratio ρf mass density of the fluid m l 3 σ kk bulk stress m l 1 t 2 σ θθ hoop stress m l 1 t 2 ϕ porosity k intrinsic permeability l2 p w pressure at the wellbore m l 1 t 2 r c radius of well casing l r w radius of pumping well l s laplace transform variable t time t b skempton s coefficient e young s modulus m l 1 t 2 h t heaviside function i 1 modified bessel function of the first kind of first order k 0 modified bessel function of second kind of order zero k b bulk modulus of fluid saturated rock m l 1 t 2 k s bulk modulus of solid m l 1 t 2 m biot modulus m l 1 t 2 ss specific storage l 1 subscript 1 2 skin zone formation zone 1 introduction pumping tests in confined aquifers are widely used to estimate hydraulic properties e g hydraulic conductivity and specific storage of aquifers for a wide range of applications from groundwater extraction to potential site evaluation for nuclear waste disposal a pumping test typically involves pumping a well at a carefully controlled rate for a period to create a measurable pressure perturbation in the formation and to measure the rate of flow at the well and the drawdown in observation wells located at different distances from the pumping well yeh and chang 2013 interpretation and analysis of the drawdown data collected during a pumping test is largely based on fitting type curves generated from available analytical solutions since the seminal work by theis 1935 which produced an analytical solution for drawdown induced by a fully penetrating well of infinitesimal radius pumping water at a constant rate from an infinite homogeneous confined aquifer a variety of analytical solutions have been developed to address pumping tests under different well and aquifer configurations chen 1984 cassiani et al 1999 chang and chen 2002 yang et al 2006 yeh and chang 2013 in particular several researchers have focused on the effects of a finite well radius moench 1997 yang et al 2006 wellbore storage park and zhan 2002 razminia et al 2016 li et al 2018 the skin zone chang and chen 2002 pasandi et al 2008 razminia et al 2015 feng and zhan 2016 and the permeability anisotropy mathias and butler 2007 on transient flow behavior for example hantush 1964 developed an analytical solution for constant rate pumping in confined aquifers by taking into consideration the effects of a finite well radius papadopulos and cooper 1967 extended the hantush 1964 solution by accounting for wellbore storage for a fully penetrating well in addition to the storage and radius of the pumping well the induced drawdown at a control well can also be strongly influenced by a skin zone which is conceptualized as the surrounding zone of a well with reduced enhanced permeability resulting from drilling or completion operations yeh and chang 2013 a negative positive skin refers to a skin zone with a permeability that is larger smaller than the permeability of the formation zone in petroleum engineering applications wellbore skin factors are commonly introduced to quantify the skin effect on fluid flow without modeling skin zone explicitly dejam et al 2013 the nondimensional skin factor is defined as yeh and chang 2013 1 s f k 2 k 1 1 ln r s r w where k 2 and k 1 are the hydraulic conductivities of the formation and skin zone respectively and rs and rw are the skin zone radius and wellbore radius measured from the axis of the well respectively according to novakowski 1989 the thickness i e the difference between rs and rw of the skin zone may range from a few millimeters to several meters skin zones that develop during the well drilling because of drilling mud and or rock flour invasion have lower permeability than the formation and are defined as a positive skin conversely negative skin zones with permeability higher than the formation develop when the drilling method induces substantial spalling and fracturing of the borehole wall butler 1988 investigated the problem of a well of infinitesimal radius with a finite thickness skin zone subject to a constant rate pumping by treating the well as a point force and found that the drawdown during a pumping test can be considered to consist of two components that are dependent and independent of near well properties novakowski 1989 solved the problem of a fully penetrating well subjected to a constant rate pumping in a confined aquifer accounting simultaneously for finite wellbore radius finite thickness skin zone and wellbore storage yeh et al 2003 derived the closed form time domain solution of the drawdown for a pumping test in a confined aquifer in terms of an improper integral which included the effects of a finite wellbore radius and finite thickness skin zone by accounting for the wellbore storage effect and the skin effect using the lumped skin factor eq 1 dejam et al 2013 investigated the behavior of transient pressure at a partially penetrating well in a naturally fractured reservoir and applied it to generate type curves to analyze the pressure of wellbores with a gas cap razminia et al 2016 examined the transient pressure in a fractal reservoir by taking into consideration both the wellbore storage and skin effects the aforementioned solutions were all developed using the traditional groundwater flow conceptual model which does not include the poroelastic effects associated with a pumping test the pumping induced horizontal deformation of an aquifer is well documented and recognized hsieh and cooley 1995 hsieh 1996 berg et al 2011 burbey 1999 2003 yin et al 2007 sneed et al 2018 but it remains a common assumption in groundwater theory that solid grains are incompressible and horizontal deformation of an aquifer is thought to have a negligible effect on pressure transience wang 2000 de simone and carrera 2017 fan et al 2019 although computed values of the hydraulic properties of aquifers using models based on groundwater flow theory yield significant insights into the physics controlling the feedback and interaction between well parameters and aquifer configurations using traditional models to interpret pumping tests can lead to erroneous outcomes for cases with strong poroelastic effects berg et al 2011 ding et al 2019 fan et al 2016 2020 fan and parashar 2019 poroelastic effects are thought to play a prominent role in low permeability hard rocks which are systems of interest for a variety of applications in subsurface hydrogeology such as nuclear waste storage tsang et al 2015 belmokhtar et al 2016 enhanced geothermal systems koh et al 2011 ghassemi and zhou 2011 fan and parashar 2019 and geological carbon sequestration wu et al 2010 de simone and carrera 2017 accurate and reliable hydraulic characterization of low permeability hard rocks is essential for assessing its long term performance for various applications tsang et al 2015 strong hydromechanical coupling occurs in these rocks when the system is subjected to high pumping rates and therefore taking into account the poroelastic effect may help obtain more accurate estimates of the subsurface properties the poroelastic effect for a well under a constant rate of discharge has been studied more extensively in petroleum engineering than in hydrology for instance cheng 2016 presented the analytical solution for fluid extraction from a poroelastic reservoir at a constant rate abousleiman and chen 2010 derived the poroelastic solution for an inclined borehole subjected to a finite length fluid flux mehrabian and abousleiman 2013 developed the fundamental poroelastic solutions for a wellbore under partial angular fluid flux and normal tractions chen 2019 further extended the solution of abousleiman and chen 2010 by developing three dimensional analytical solutions for an arbitrarily inclined wellbore subjected to a fluid discharge of finite length these analytical poroelastic solutions abousleiman and chen 2010 mehrabian and abousleiman 2013 cheng 2016 chen 2019 addressed the hydromechanical coupling associated with wells pumping at a constant rate without accounting for the effects of skin zone and wellbore storage to the best knowledge of the authors analytical solutions accounting for poroelastic effects in a system with a finite radius well that consider the wellbore storage and skin zone effects have not yet been reported the purpose of this paper is threefold 1 to derive new analytical solutions for a pumping test that simultaneously accounts for poroelastic effect wellbore storage and finite wellbore skin zone 2 to compare this new solution with transient solutions obtained from existing simpler analytical methods and 3 to determine the conditions under which the drawdown solutions obtained are reasonably accurate and reliable without incorporating the poroelastic effect we used laplace transform to solve the governing equations in plane strain poroelasticity and explored the effects of wellbore storage skin zone types thickness and poroelastic deformation on the temporal spatial evolution of drawdown in the pumping well and in the aquifer the results presented in this paper are expected to provide useful guidance for observation well placement and to help practitioners better interpret the pumping test results the analytical solutions derived in this paper may serve as a benchmark for validating numerical models and methods in poroelasticity 2 mathematical formulation 2 1 statement of the problem consider a fully penetrating pumping well of radius rw with a skin zone of radius rs embedded in a homogeneous isotropic poroelastic confined aquifer fig 1 at time zero pumping starts at a constant volumetric rate q from the pumping well the key assumptions underlying the poroelastic formulation for the aforementioned system are as follows 1 the aquifer is homogeneous and isotropic 2 the pumped aquifer is horizontal and of infinite extent 3 the aquifer is poroelastic and follows the classical biot theory 4 the skin zone and the formation have the same mechanical properties but different hydraulic properties and 5 the screen interval of the pumping well spans the thickness of the aquifer and the plane strain condition prevails in the horizontal plane within the classical framework of biot poroelasticity fluid flow is assumed to follow darcy s law wang 2000 we note that this simplified assumption may not be valid in ultratight low permeability media particularly when the hydraulic gradient is very small neuzil 1986 dejam et al 2017 the fourth assumption is justified based on observations that the skin zones develop mainly due to drilling and completion practices which result in an altered permeability in a region surrounding a wellbore without significant changes in the mechanical properties nowakowski 1989 because the length of the screen interval of the pumping well is much larger than the well diameter and the flux and traction boundary conditions do not vary along the wellbore axis the plain strain condition is assumed for the plain strain condition the constitutive equations in polar coordinate systems which express the total stresses σ ij and pore pressure p in terms of strains ε ij and increment of fluid content ζ are as follows wang 2000 cheng 2016 2 σ r r 2 g ε r r 2 g ν u 1 2 ν u ε k k α m ς 3 σ θ θ 2 g ε θ θ 2 g ν u 1 2 ν u ε k k α m ς 4 σ z z 2 g ν u 1 2 ν u ε k k α m ς 5 p m ς α ε k k where σ rr σθθ and σ zz are the radial hoop and axial stresses respectively ε rr εθθ and ε zz are the radial hoop and axial strains respectively and ε kk is the bulk strain the material constants given above are the shear modulus g the undrained poisson s ratio νu the biot coefficient α and the biot modulus m the biot coefficient α is a ratio signifying the fluid volume change induced by the bulk volume change under drained conditions wang 2000 for the axial symmetry case the strain components are related to the displacement by 6 ε r r u r r ε θ θ u r r ε z z 0 where ur is the radial displacement the bulk strain is given by 7 ε k k u r r u r r 1 r r r u r for a fully saturated rock without any fluid sources or sinks the conservation of fluid mass yields 8 ς t c 2 ς equivalently eq 8 can be written as green and wang 1990 9 t p b 3 σ k k c 2 p b 3 σ k k in the above b is the skempton s coefficient which is defined as the ratio of the induced pore pressure to the change of bulk stress under undrained conditions wang 2000 c is the hydraulic diffusivity which is defined as c ρ f g k μ s s and ss is the specific storage given by green and wang 1990 wang 1993 10 s s ρ f g ϕ 1 k f 1 k s α k v 1 4 g 3 k s where ρ f is the fluid density g is the gravitational acceleration k is permeability μ is the fluid dynamic viscosity ϕ is the porosity kf and ks are the bulk modulus for fluids and solids respectively and kv is the drained vertical bulk modulus wang 2000 which can be expressed in terms of the bulk modulus kb and shear modulus g of the matrix as follows 11 k v k b 4 3 g the equilibrium equation which describes the system under the influence of radial and hoop stresses is given by 12 σ r r r σ r r σ θ θ r 0 substituting the constitutive eqs 2 3 and strain displacement relations 6 and 7 into the equilibrium eq 12 yields the governing equation for displacement 13 2 g 1 ν u 1 2 ν u 2 u r r 2 1 r u r r u r r 2 α m ς r eq 13 can be rearranged into 14 ε k k r α m 1 2 ν u 2 g 1 ν u ς r the initial conditions that describe the system before the onset of pumping are expressed by equating the excess pore pressure increment of fluid content radial stress and radial displacement to zero 15 p 1 r 0 p 2 r 0 0 16 ς 1 r 0 ς 2 r 0 0 17 σ r 1 r 0 σ r 2 r 0 0 18 u r 1 r 0 u r 2 r 0 0 where the subscripts 1 and 2 refer to the skin zone rw r rs and the formation zone rs r respectively the boundary conditions are specified below at the far field 19 p 2 0 0 ς 2 0 0 σ r 2 0 0 u r 2 0 0 at the borehole surface 20 σ r 1 r w t p 1 r w t h t 21 2 π r w b k 1 μ p 1 r r r w c w ρ f g p 1 t r r w q h t where h t is the heaviside function p 1 is the time dependent fluid pressure required to pump at a constant rate q from the wellbore this is an implicit initial boundary value problem because p 1 is unknown a priori the wellbore storage coefficient is c w π r c 2 novakowski 1989 where rc is the radius of the well casing at the interface between the skin and formation zone r rs the continuity of the pore pressure fluid flux radial displacement and radial stress leads to 22 p 1 r s t p 2 r s t 23 κ 1 p 1 r r s t κ 2 p 2 r r s t 24 u r 1 r s t u r 2 r s t 25 σ r 1 r s t σ r 2 r s t in eq 23 κ 1 k 1 μ and κ 2 k 2 μ are the mobility of the skin zone and formation respectively 2 2 analytical solutions in the laplace domain analytical solutions were derived in the laplace domain appendix a provides the detailed derivations in the skin zone the laplace domain solutions for pore pressure radial hoop and axial stresses and displacement are 26 p 1 1 s q μ 2 π r w b k 1 s c 1 ψ 2 i 0 r s c 1 ψ 1 k 0 r s c 1 ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 27 σ r r 1 1 s q μ 2 π r w b k 1 s c 1 2 η ψ 1 f 1 r s c 1 2 η ψ 2 f 2 r s c 1 f 3 r w 2 r 2 ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 28 σ θ θ 1 1 s q μ 2 π r w b k 1 s c 1 2 η ψ 1 f 1 r s c 1 2 η ψ 2 f 2 r s c 1 f 3 r w 2 r 2 2 η f 4 ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 29 σ z z 1 1 s q μ 2 π r w b k 1 s c 1 2 η f 4 ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 30 u r 1 1 g s q μ 2 π r w b k 1 s c 1 η ψ 1 f 1 s c 1 η ψ 2 f 2 s c 1 f 3 r w 2 2 r ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 where the tilde represents the laplace transform s is the transform variable i 0 and i 1 are the modified bessel function of the first kind of order zero and first order respectively and k 0 and k 1 are the modified bessel function of the second kind of order zero and first order respectively functions ψ1 ψ2 and ψ3 are given by 31 ψ 1 k 2 k 1 c 1 c 2 i 0 r s s c 1 k 1 r s s c 2 i 1 r s s c 1 k 0 r s s c 2 32 ψ 2 k 1 r s s c 1 k 0 r s s c 2 k 2 k 1 c 1 c 2 k 0 r s s c 1 k 1 r s s c 2 and 33 ψ 3 c w s 2 π r w b ρ g k 1 μ s c 1 ψ 2 i 0 r w s c 1 ψ 1 k 0 r w s c 1 functions f 1 f 4 are defined as 34 f 1 k 1 r s c 1 r w r k 1 r w s c 1 35 f 2 r w r i 1 r w s c 1 i 1 r s c 1 36 f 3 ψ 2 i 0 r w s c 1 ψ 1 k 0 r w s c 1 37 f 4 ψ 2 i 0 r s c 1 ψ 1 k 0 r s c 1 in the formation zone the laplace domain solutions for pore pressure radial hoop and axial stresses and displacement are given by 38 p 2 1 s q μ 2 π r w b k 1 s c 1 k 0 r s c 2 ψ 2 i 0 r s s c 1 ψ 1 k 0 r s s c 1 k 0 r s s c 2 ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 39 σ r r 2 1 s q μ 2 π r w b k 1 s c 1 1 ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 2 η r s c 2 f 5 f 8 k 0 r s s c 2 2 η ψ 2 r s c 1 f 6 2 η ψ 1 r s c 1 f 7 r w 2 r 2 f 3 40 σ θ θ 2 1 s q μ 2 π r w b k 1 s c 1 1 ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 r w 2 r 2 f 3 2 η f 8 f 5 r s c 2 k 0 r s c 2 r s c 2 k 0 r s s c 2 2 η ψ 2 r s c 1 f 6 2 η ψ 1 r s c 1 f 7 41 σ z z 2 1 s q μ 2 π r w b k 1 s c 1 k 0 r s c 2 k 0 r s s c 2 2 η f 8 ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 42 u r 2 1 s g q μ 2 π r w b k 1 s c 1 1 ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 r w 2 2 r f 3 η f 5 f 8 s c 2 k 0 r s s c 2 η s c 1 ψ 2 f 6 η s c 1 ψ 1 f 7 where functions f 5 f 8 are defined as 43 f 5 k 1 r s c 2 r s r k 1 r s s c 2 44 f 6 r w r i 1 r w s c 1 r s r i 1 r s s c 1 45 f 7 r s r k 1 r s s c 1 r w r k 1 r w s c 1 46 f 8 ψ 2 i 0 r s s c 1 ψ 1 k 0 r s s c 1 2 3 dimensionless solutions dimensionless solutions were determined using the following nondimensional variables from novakowski 1989 and yeh et al 2003 c c 2 c 1 k k 2 k 1 c w c w 2 π r w 2 b s s 2 ρ r r w ρ s r s r w t c 2 t r w 2 β r w s c 2 ξ r s c 2 p p 2 π b κ 2 q σ r r 2 π b κ 2 σ r r q σ θ θ 2 π b κ 2 σ θ θ q σ z z 2 π b κ 2 σ z z q and u r 2 π g b κ 2 u r q r w where t is the dimensionless time c w is a dimensionless measure of the wellbore storage ρ is the dimensionless radial distance from the pumping well ρ s is the dimensionless skin thickness σ r r σ θ θ and σ z z are dimensionless radial hoop and axial stresses respectively u r is dimensionless radial displacement and p is dimensionless pore pressure change the hydraulic drawdown sh is related to the pore pressure drop p through 47 s h p ρ f g the dimensionless drawdown and its gradient are respectively defined as 48 s h 2 π b k 2 s h q 49 s h ρ s h ρ the laplace domain solutions for dimensionless variables obtained by nondimensionalizing the solutions presented in the previous section are given below in the skin zone 50 p 1 s h 1 1 s k β c ψ 2 i 0 ρ β c ψ 1 k 0 ρ β c ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 51 s h 1 ρ 1 s k ψ 2 i 1 ρ β c ψ 1 k 1 ρ β c ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 52 σ r r 1 1 s k β c 1 ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 2 η ψ 1 f 1 ρ β c 2 η ψ 2 f 2 ρ β c 1 ρ 2 f 3 53 σ θ θ 1 1 s k β c 1 ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 2 η ψ 1 f 1 ρ β c 2 η ψ 2 f 2 ρ β c 1 ρ 2 f 3 2 η f 4 54 σ z z 1 1 s k β c 2 η f 4 ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 55 u r 1 1 s k β c 1 ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 η ψ 1 f 1 β c η ψ 2 f 2 β c 1 2 ρ f 3 where 56 ψ 1 k c i 0 ρ s β c k 1 ρ s β i 1 ρ s β c k 0 ρ s β 57 ψ 2 k 1 ρ s β c k 0 ρ s β k c k 0 ρ s β c k 1 ρ s β 58 ψ 3 c w β k c ψ 2 i 0 β c ψ 1 k 0 β c 59 f 1 k 1 ρ β c k 1 β c ρ 60 f 2 i 1 β c ρ i 1 ρ β c 61 f 3 ψ 2 i 0 β c ψ 1 k 0 β c 62 f 4 ψ 2 i 0 ρ β c ψ 1 k 0 ρ β c in the formation zone 63 p 2 s h 2 1 s k β c k 0 ρ β ψ 2 i 0 ρ s β c ψ 1 k 0 ρ s β c k 0 ρ s β ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 64 s h 2 ρ 1 s k c k 1 ρ β ψ 2 i 0 ρ s β c ψ 1 k 0 ρ s β c k 0 ρ s β ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 65 σ r r 2 1 s k β c 1 ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 2 η ρ β f 5 f 8 k 0 ρ s β 2 η ψ 2 f 6 ρ β c 2 η ψ 1 f 7 ρ β c f 3 ρ 2 66 σ θ θ 2 1 s k β c 1 ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 f 3 ρ 2 2 η ρ β f 8 f 5 ρ β k 0 ρ β k 0 ρ s β 2 η ψ 2 ρ β c f 6 2 η ψ 1 ρ β c f 7 67 σ z z 2 1 s k β c 2 η k 0 ρ β ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 f 8 k 0 ρ s β 68 u r 2 1 s k β c 1 ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 1 2 ρ f 3 η f 5 f 8 β k 0 ρ s β η ψ 2 β c f 6 η ψ 1 β c f 7 where 69 f 5 k 1 ρ β ρ s k 1 ρ s β ρ 70 f 6 i 1 β c ρ ρ s i 1 ρ s β c ρ 71 f 7 k 1 ρ s β c ρ s ρ k 1 β c ρ 72 f 8 ψ 2 i 0 ρ s β c ψ 1 k 0 ρ s β c 3 comparison with existing analytical solutions verification of the analytical solutions derived above was performed by comparing them to existing solutions in groundwater and poroelastic literature 3 1 comparison with analytical solutions in groundwater theory replacing the specific storage defined in eq 10 with the specific storage used in the groundwater flow model eq 87 avoids the poroelastic effects and therefore eqs 50 and 63 can be reduced to the solutions of novakowski 1989 when and the pumping well has a finite diameter but negligibly small storage setting c w 0 reduces eqs 50 and 63 to 73 s h 1 1 s k β c ψ 2 i 0 ρ β c ψ 1 k 0 ρ β c ψ 1 k 1 β c ψ 2 i 1 β c and 74 s h 2 1 s k β c k 0 ρ β ψ 2 i 0 ρ s β c ψ 1 k 0 ρ s β c k 0 ρ s β ψ 1 k 1 β c ψ 2 i 1 β c respectively which agree with the solutions of yeh et al 2003 when the fully penetrating pumping well has storage but lacks skin zone setting c 1 k 1 and ρ s 1 reduces eq 63 to 75 s h 2 1 s 1 β k 0 ρ β k 1 β β c w k 0 β which is identical to eq 2 of papadopulos and cooper 1967 when the pumping well has an infinitesimal radius and a finite thickness skin zone setting β 0 and using lim x 0 x k 1 x 1 reduces eqs 50 and 63 to 76 s h 1 k s k 0 ρ β c ψ 2 ψ 1 i 0 ρ β c and 77 s h 2 1 s k ρ s β c k 0 ρ β ψ 1 respectively which are consistent with eqs 16 and 17 of butler 1988 when the skin zone is absent the two equations further reduce to 78 s h 2 k 0 ρ β s which is the laplace transform of the theis solution theis 1935 3 2 comparison with analytical solutions in poroelastic theory when the pumping well has a finite radius and no skin zone but negligibly small storage in a uniform aquifer setting c w 0 c 1 k 1 and ρ s 1 reduces eq 63 to 79 s h 2 1 s 1 β k 0 ρ β k 1 β which is in agreement with eq 7 645 of cheng 2016 eqs 52 and 65 reduce to 80 σ r r 1 σ r r 2 1 s 2 η ρ β 2 k 1 ρ β k 1 β 1 ρ 1 s 1 ρ 2 β k 0 β k 1 β eqs 53 and 66 reduce to 81 σ θ θ 1 σ θ θ 2 1 s 1 ρ 2 β k 0 β k 1 β 2 η s k 1 ρ β ρ β 2 k 1 β 1 ρ 2 β 2 k 0 ρ β β k 1 β from eqs 79 to 81 we can get the terzaghi s effective radial and hoop stresses as follows 82 σ r r 1 s 2 η ρ β 2 k 1 ρ β k 1 β 1 ρ 1 s 1 ρ 2 β k 0 β k 1 β 1 s 1 β k 0 ρ β k 1 β 83 σ θ θ 1 s 1 ρ 2 β k 0 β k 1 β 2 η s k 1 ρ β ρ β 2 k 1 β 1 ρ 2 β 2 k 0 ρ β β k 1 β 1 s 1 β k 0 ρ β k 1 β eqs 82 and 83 agree with eqs 7 734 and 7 735 of cheng 2016 respectively 4 results and discussion to obtain the solutions in the time domain we carried out an inverse laplace transform using the stehfest algorithm stehfest 1970 because of its computational efficiency and accuracy which is given by 84 f t ln 2 t i 1 n v i f ln 2 t i where 85 v i 1 i n 2 k i 1 2 min i n 2 k n 2 2 k n 2 k k k 1 i k 2 k i we use n 10 in our numerical inversion the main challenges in the numerical inversion of the laplace transform lie in the singularity of the modified bessel function of first kind of zero order and first order at a very large s the following asymptotic expansions are used for a large s abramowitz and stegun 1964 86 i 0 s exp s 2 π s 1 1 8 s 9 128 s 2 i 1 s exp s 2 π s 1 3 8 s 15 128 s 2 in the numerical examples considered here sandstone and marble are used as two representative materials for illustrative purposes these two rocks represent systems with widely different hydromechanical properties sandstone aquifers are prominently featured in groundwater resources studies whereas the study of marble reservoirs is more useful for applications in which low permeability is encountered or is desired such as studying enhanced geothermal systems nuclear waste repositories or carbon sequestration methods table 1 lists the hydromechanical properties of berea sandstone and tennessee marble as reported in wang 2000 and cheng 2016 we focused on the effects of poroelastic coupling on the transient drawdown behavior a parametric study was performed to investigate the sensitivity of drawdown to variations in physical parameters including skin type skin thickness and wellbore storage 4 1 effects of poroelasticity before we explore the effects of poroelastic deformation on the transient drawdown it is instructive to compare the fully coupled poroelastic formulations to the uncoupled groundwater flow theory the governing equation for transient flow widely used in conventional groundwater theory is yeh and chang 2013 87 2 s h s s k s h t where sh is the drawdown in the aquifer ss is the specific storage coefficient and k is the hydraulic conductivity hydraulic conductivity k is related to permeability k by k ρ f g k μ under the assumption of constant vertical stress and uniaxial deformation the specific storage in classical groundwater theory is given as jacob 1940 88 s s ρ g 1 k v ϕ k f in the jacob s equation for specific storage that is commonly used in groundwater flow theory solid grains are assumed incompressible which results in a higher specific storage than the storage calculated using eq 10 in poroelasticity therefore the uncoupled groundwater theory overestimates the specific storage and consequently underestimates the hydraulic diffusivity and predicts a lower drawdown compared with the coupled poroelasticity under identical pumping test conditions the second key difference between groundwater theory and poroelasticity can be observed by comparing eqs 9 and 87 in poroelasticity the linear combination of pore pressure and mean stress follows the diffusion equation mathematically the rate of changes in mean stress with respect to time is equivalent to a fluid source in groundwater theory however hydraulic drawdown and therefore pore pressure change satisfies a homogeneous diffusion equation to separate the effect of poroelastic deformation from wellbore storage and skin zone we use the following parameters c w 0 c 1 and k 1 figs 2 a and b show a comparison of the dimensionless drawdown predicted using groundwater theory and coupled poroelasticity as a function of radial distance from the pumping well at various nondimensional times for sandstone and marble respectively at a given time hydraulic drawdown decreases monotonically with increasing distance from the pumping well at the pumping well drawdown increases steadily with increasing time the general trends of the radial distribution of drawdown are similar for sandstone and marble and groundwater theory is seen to underestimate the drawdown at the pumping well for sandstone the drawdown distribution obtained from poroelasticity is slightly higher than that obtained from groundwater theory at the same time for marble the observed difference in drawdown distribution is significantly higher this phenomenon can be explained by examining the difference in specific storage in eqs 10 and 88 and noting the contribution of volumetric deformation to the changes in pore pressure for marble the calculated specific storage using jacob s eq 88 is 75 larger than the specific storage calculated using eq 10 which incorporated poroelasticity for sandstone the difference is approximately 8 therefore for marble groundwater theory overestimates specific storage and significantly underestimates the hydraulic diffusivity leading to a smaller magnitude and slower evolution of drawdown furthermore eq 5 indicates that pore pressure changes drawdowns come from two sources 1 fluid released from storage and 2 volumetric deformation of the matrix due to the skempton effect the groundwater theory underestimates the drawdown without capturing pumping induced volumetric deformation the sharp difference in drawdown prediction for marble highlights the significance of including poroelasticity in estimating hydraulic parameters based on pumping test conducted in low permeable aquifers and reservoirs using the same parameters as those used in figs 2 3 a and 3b show the influence of poroelasticity on the radial distribution of the nondimensional drawdown gradient at different normalized times for sandstone and marble respectively the nondimensional drawdown analysis provides a general hydrodynamic conceptual framework to represent the transient evolution of the shape of the pressure front pulse that diffuses throughout an aquifer during pumping barker 1988 ferroud et al 2019 it is evident that at a given location the drawdown gradient deceases with increasing time at a given time drawdown gradient decreases steadily with increases in the radial distance from the pumping well as expected the drawdown gradient for sandstone is marginally sensitive to poroelastic deformation for marble groundwater theory underestimates the drawdown gradient slightly at the beginning of the pumping test and the differences increases with increasing time 4 2 effects of skin types to examine the effects of skin types on aquifer response temporal evolution of dimensionless drawdown distributions are shown in figs 4 and 5 at the pumping well ρ 1 and at a hypothetical observation well located at ρ 100 for conditions described by ρ s 3 c w 0 with k ranging from 0 1 to 10 note that k 1 represents the case of a homogeneous formation whereas k 0 1 and k 10 represent the negative and positive skin zone respectively the pumping well with a positive skin zone has a remarkably larger drawdown than those without a skin zone or with a negative skin zone this can be explained by observing that in the case of a positive skin the permeability of the skin zone is smaller than the permeability of the formation it also takes longer to compensate for the diffusion induced pressure loss to maintain a constant pumping rate at the wellbore for a negative skin pore pressure diffuses quickly from the formation to the wellbore and so a small drawdown pore pressure decrease is observed at the pumping well drawdown is more affected by the positive skin than by the negative skin especially in the vicinity of the pumping well at the observation well ρ 100 the skin effect is negligible as seen by a nearly complete overlap of drawdown curves for the three k values in fig 5 for sandstone the magnitude of drawdown at the wellbore predicted from groundwater theory is close to that predicted from poroelasticity for marble the magnitude of drawdown at the pumping well obtained from groundwater theory is smaller than that obtained from poroelasticity and the difference is more pronounced at early pumping time t 30 at the observation well the magnitude of poroelasticity based drawdown is significantly greater than that predicted from groundwater theory at a long pumping time t 1000 for example at t 10 000 the drawdown at ρ 100 from poroelasticity is approximately 36 greater than that predicted from groundwater theory 4 3 effects of skin thickness to investigate the sensitivity of drawdown to a pumping test in a well with variable skin thickness we studied a well with positive skin k 10 of variable thickness ρ s 1 3 and 10 and plotted the evolution of drawdown at the pumping well ρ 1 and at the observation well ρ 100 in figs 6 and 7 respectively note that ρ s 1 denotes the case of a pumping well without a skin zone it is evident from fig 6 that the drawdown at the pumping well increases with the increasing thickness of the positive skin zone a positive skin means a lower permeability in the skin zone than in the formation and therefore a thicker positive skin means that groundwater replenishment into the well takes longer through the skin zone at the observation well ρ 100 the drawdowns are not sensitive to the thickness of the skin zone which suggests that skin zone properties type and thickness play a minor role in far field drawdowns 4 4 effects of wellbore storage to investigate the effects of wellbore storage on aquifer performance in response to pumping tests from wells with different storage we measured the drawdowns at the pumping well ρ 1 and at the observation well ρ 100 figs 8 and 9 show the pumping and observation well drawdowns corresponding wellbore storage based on the following physical parameters ρ s 3 k 10 and c 10 there are two noteworthy features first wellbore storage delays the migration of groundwater from the formation to the well increasing wellbore storage results in an appreciable decrease in drawdown at the pumping well and at the observation well which can be seen by comparing the extent of the vertical axes in figs 8 and 9 to those of fig 4 through 7 second poroelastic effect is largely masked by the wellbore storage effect so the drawdown predicted at the pumping well using groundwater theory is indistinguishable from drawdown associated with poroelasticity this condition is applicable to both sandstone and marble and it is more pronounced in the vicinity of the pumping well 4 5 pumping induced stress changes for illustrative purposes fig 10 shows the pumping induced radial hoop and axial stresses as functions of radial distance at various dimensionless times for marble with the following physical parameters ρ s 3 k 10 and c w 2 2 10 4 it is evident that poroelastic stresses develop significantly in the skin zone especially at early time at a given time induced stresses drop sharply with increasing distance from the pumping well at a given location compressive hoop stress and tensile radial axial stress progressively increase with time the axial stress exhibits a sharp change in slope at the interface of the skin zone with the formation set at ρ 3 in these examples the magnitude of axial stress is comparatively smaller than the magnitude of radial and hoop stresses but the axial stress decreases more slowly with respect to distance resulting in appreciable values of axial stress far away from the pumping well at late times the hoop stress is directly related to the borehole integrity i e when the terzaghi effective hoop stress at the borehole wall reaches the tensile strength of the rock matrix tensile fracture initiates at the borehole wall and breakdown occurs eq 53 and fig 10b can therefore be used to set the upper bound limits for pumping rates which would generate measurable pressure drawdowns without causing wellbore breakdown 5 conclusions this paper derives analytical solutions for transient flow to a finite radius well in a poroelastic confined aquifer that is subjected to a constant rate pumping the solutions presented herein which unify the groundwater solutions of novakowski 1989 and the poroelasticity solutions of cheng 2016 simultaneously account for the effects and interactions of a finite thickness skin zone wellbore storage and poroelastic deformation on hydraulic drawdown in the pumping well and in the observation wells for a uniform aquifer and a finite radius well without storage the presented laplace domain solutions have been shown to reduce to the cheng 2016 solution when the combined effects of wellbore storage and finite thickness skin zone are significant but poroelastic effect is not strong our solutions agree with those presented in novakowski 1989 therefore the following conclusions can be drawn from this study 1 for constant rate pumping tests conducted in low permeable confined hard rocks groundwater theory significantly underestimates the hydraulic drawdown in the pumping well compared with the drawdown predicted from poroelasticity especially when a positive skin is present hydraulic drawdowns in far field observation wells are sensitive to poroelastic effects for high permeable rocks there is a slight difference between the drawdowns predicted from classic groundwater theory and poroelasticity 2 under otherwise same conditions a wellbore with a positive skin undergoes greater drawdowns than wellbores with a negative skin or without any skin the well skin zone has a negligibly small effect on far field drawdowns 3 wellbore storage significantly delays drawdowns at the pumping well and tends to mask the poroelastic effect in the vicinity of the pumping well the solutions developed in this paper can be used to investigate the effects of poroelastic deformation skin zone properties and wellbore storage on the drawdown distribution in the pumping well as well as in the observation wells this information provides useful guidance to practitioners to analyze and interpret pumping tests determine the optimal placement of observation wells and set appropriate well operation parameters to ensure wellbore integrity credit authorship contribution statement zhiqiang fan conceptualization methodology validation formal analysis writing original draft writing review editing rishi parashar writing review editing declaration of competing interest the authors declare that they have no conflict of interest acknowledgments we thank the associate editor nicole daman and five anonymous reviewers for their helpful comments that greatly improved the paper the first author would like to acknowledge the support from nell j redfield foundation the maki endowment and the desert research institute appendix a derivation of eqs 26 46 applying the laplace transform of governing eq 8 for fluid variation ζ in the skin zone with respect to time t yields a 1 d 2 ς 1 d r 2 1 r d ς 1 d r s c 1 ς 1 0 the general solution of a 1 is a 2 ς 1 r s a 1 r s i 0 r s c 1 a 2 r s k 0 r s c 1 where a 1 and a 2 are two integration constants applying the laplace transform to eq 13 and integrating the result in a 3 ε k k 1 r s η g s 1 ς 1 r s 2 a 3 where η α 1 2 ν 2 1 ν and s 1 1 ν u 1 2 ν m 1 ν 1 2 ν u are two poroelastic constants and a 3 is an integration constant substituting and integrating eq 7 into the above equation gives a 4 u r 1 1 r η g s 1 r ς 1 d r a 3 r a 4 r η g s 1 a 1 i 1 r s c 1 s c 1 η g s 1 a 2 k 1 r s c 1 s c 1 a 3 r a 4 r where a 4 is an integration constant using eq 6 we can get the laplace transform of strain components then the skin zone stress components pore pressure and fluid flux in the laplace domain are given by a 5 σ r r 1 2 η s 1 a 1 i 1 r s c 1 r s c 1 2 η s 1 a 2 k 1 r s c 1 r s c 1 2 g 1 2 ν u a 3 2 g r 2 a 4 a 6 σ θ θ 1 2 η s 1 a 1 i 1 r s c 1 r s c 1 i 0 r s c 1 2 η s 1 a 2 k 1 r s c 1 r s c 1 k 0 r s c 1 2 g 1 2 ν u a 3 2 g r 2 a 4 a 7 σ z z 1 2 η s 1 a 1 i 0 r s c 1 2 η s 1 a 2 k 0 r s c 1 4 g ν u 1 2 ν u a 3 a 8 p 1 a 1 i 0 r s c 1 s 1 a 2 k 0 r s c 1 s 1 2 α m a 3 a 9 q r 1 a 1 k 1 μ s c 1 i 1 r s c 1 s 1 a 2 k 1 μ s c 1 k 1 r s c 1 s 1 similarly we get the laplace transform of stress pore pressure displacement and variation of fluid in the formation as follows a 10 ς 2 r s b 1 r s i 0 r s c 2 b 2 r s k 0 r s c 2 a 11 σ r r 2 2 η s 2 b 1 i 1 r s c 2 r s c 2 2 η s 2 b 2 k 1 r s c 2 r s c 2 2 g 1 2 ν u b 3 2 g r 2 b 4 a 12 σ θ θ 2 2 η s 2 b 1 i 1 r s c 2 r s c 2 i 0 r s c 2 2 η s 2 b 2 k 1 r s c 2 r s c 2 k 0 r s c 2 2 g 1 2 ν u b 3 2 g r 2 b 4 a 13 σ zz 2 2 η s 2 b 1 i 0 r s c 2 2 η s 2 b 2 k 0 r s c 2 4 g ν u 1 2 ν u b 3 a 14 p 2 1 s 2 b 1 i 0 r s c 2 1 s 2 b 2 k 0 r s c 2 2 α m b 3 a 15 q r 2 b 1 k 2 μ s c 2 i 1 r s c 2 s 2 b 2 k 2 μ s c 2 k 1 r s c 2 s 2 where b 1 b 4 are constants to de determined by the boundary conditions and continuity conditions at the skin formation interface the boundary condition 19 requires that a 16 b 1 b 3 0 application of the laplace transform to the boundary conditions at the wellbore 20 21 using equations a 5 and a 8 yields a 17 2 η s 1 a 1 i 1 r w s c 1 r w s c 1 2 η s 1 a 2 k 1 r w s c 1 r w s c 1 2 g 1 2 ν u a 3 2 g r w 2 a 4 a 1 i 0 r w s c 1 s 1 a 2 k 0 r w s c 1 s 1 2 α m a 3 a 18 2 π r w b k 1 μ a 1 s 1 s c 1 i 1 r w s c 1 a 2 s 1 s c 1 k 1 r w s c 1 c w s ρ f g a 1 s 1 i 0 r w s c 1 a 2 s 1 k 0 r w s c 1 2 α m a 3 q s at the interface between the skin zone and formation zone the continuity of radial displacement radial stress pore pressure and fluid flux requires that a 19 η g s 1 a 1 i 1 r s s c 1 s c 1 η g s 1 a 2 k 1 r s s c 1 s c 1 a 3 r s a 4 r s η g s 2 b 2 k 1 r s s c 2 s c 2 b 4 r s a 20 2 η s 1 a 1 i 1 r s s c 1 r s s c 1 2 η s 1 a 2 k 1 r s s c 1 r s s c 1 2 g 1 2 ν u a 3 2 g r s 2 a 4 2 η s 2 b 2 k 1 r s s c 2 r s s c 2 2 g r s 2 b 4 a 21 a 1 i 0 r s s c 1 s 1 a 2 k 0 r s s c 1 s 1 2 α m a 3 b 2 k 0 r s s c 2 s 2 a 22 a 1 k 1 μ s c 1 i 1 r s s c 1 s 1 a 2 k 1 μ s c 1 k 1 r s s c 1 s 1 b 2 k 2 μ k 1 r s s c 2 s 2 eqs a 17 to a 22 are solved simultaneously to determine the remaining constants a 1 to a 4 b 2 and b 4 which are then substituted back into eqs a 5 to a 15 to get the laplace domain solutions for stress pore pressure and displacement in the skin zone and formation zone 
449,this paper presents analytical solutions for pumping from a poroelastic confined aquifer where the combined effects of a finite thickness skin zone and the wellbore storage are fully incorporated the pumping induced axisymmetric stress plane strain deformation and pore pressure are derived in the laplace transform domain time domain solutions are obtained using the stehfest inversion algorithm numerical examples are presented to investigate the effects of hydromechanical coupling and poroelasticity on the hydraulic drawdown at the pumping well and at an observation well the results show that traditional methods substantially underestimate the drawdown at the pumping well in a low permeability hard rock compared with the drawdown predicted using the fully coupled poroelastic theory the difference becomes more pronounced when a finite thickness positive skin is present with a permeability that is lower than the permeability of the formation for finite radius pumping wells with storage the effects of poroelasticity on drawdown are masked by the effects associated with wellbore storage keywords poroelasticity wellbore skin wellbore storage pumping test confined aquifer nomenclature α biot coefficient ε rr radial strain ε kk bulk strain ζ increment of fluid content µf pore fluid viscosity ml 1t 1 ν u undrained poisson s ratio σ ij total stress m l 1 t 2 σ rr radial stress m l 1 t 2 σzz axial stress m l 1 t 2 c hydraulic diffusivity l2 t 1 p excess pore pressure m l 1 t 2 r radial distance from the axis of the pumping well l r s radius of skin zone l s h hydraulic drawdown l u r radial displacement l c w wellbore storage coefficient l2 g shear modulus m l 1 t 2 i 0 modified bessel function of the first kind of order zero k 1 modified bessel function of second kind of first order k f bulk modulus of fluid m l 1 t 2 k v drained vertical bulk modulus m l 1 t 2 n total number of terms in the stehfest series q volumetric pumping rate l3t 1 superscript dimensionless variable εij strain components ε θθ hoop strain εzz axial strain κ mobility m 1 l3 t ν drained poisson s ratio ρf mass density of the fluid m l 3 σ kk bulk stress m l 1 t 2 σ θθ hoop stress m l 1 t 2 ϕ porosity k intrinsic permeability l2 p w pressure at the wellbore m l 1 t 2 r c radius of well casing l r w radius of pumping well l s laplace transform variable t time t b skempton s coefficient e young s modulus m l 1 t 2 h t heaviside function i 1 modified bessel function of the first kind of first order k 0 modified bessel function of second kind of order zero k b bulk modulus of fluid saturated rock m l 1 t 2 k s bulk modulus of solid m l 1 t 2 m biot modulus m l 1 t 2 ss specific storage l 1 subscript 1 2 skin zone formation zone 1 introduction pumping tests in confined aquifers are widely used to estimate hydraulic properties e g hydraulic conductivity and specific storage of aquifers for a wide range of applications from groundwater extraction to potential site evaluation for nuclear waste disposal a pumping test typically involves pumping a well at a carefully controlled rate for a period to create a measurable pressure perturbation in the formation and to measure the rate of flow at the well and the drawdown in observation wells located at different distances from the pumping well yeh and chang 2013 interpretation and analysis of the drawdown data collected during a pumping test is largely based on fitting type curves generated from available analytical solutions since the seminal work by theis 1935 which produced an analytical solution for drawdown induced by a fully penetrating well of infinitesimal radius pumping water at a constant rate from an infinite homogeneous confined aquifer a variety of analytical solutions have been developed to address pumping tests under different well and aquifer configurations chen 1984 cassiani et al 1999 chang and chen 2002 yang et al 2006 yeh and chang 2013 in particular several researchers have focused on the effects of a finite well radius moench 1997 yang et al 2006 wellbore storage park and zhan 2002 razminia et al 2016 li et al 2018 the skin zone chang and chen 2002 pasandi et al 2008 razminia et al 2015 feng and zhan 2016 and the permeability anisotropy mathias and butler 2007 on transient flow behavior for example hantush 1964 developed an analytical solution for constant rate pumping in confined aquifers by taking into consideration the effects of a finite well radius papadopulos and cooper 1967 extended the hantush 1964 solution by accounting for wellbore storage for a fully penetrating well in addition to the storage and radius of the pumping well the induced drawdown at a control well can also be strongly influenced by a skin zone which is conceptualized as the surrounding zone of a well with reduced enhanced permeability resulting from drilling or completion operations yeh and chang 2013 a negative positive skin refers to a skin zone with a permeability that is larger smaller than the permeability of the formation zone in petroleum engineering applications wellbore skin factors are commonly introduced to quantify the skin effect on fluid flow without modeling skin zone explicitly dejam et al 2013 the nondimensional skin factor is defined as yeh and chang 2013 1 s f k 2 k 1 1 ln r s r w where k 2 and k 1 are the hydraulic conductivities of the formation and skin zone respectively and rs and rw are the skin zone radius and wellbore radius measured from the axis of the well respectively according to novakowski 1989 the thickness i e the difference between rs and rw of the skin zone may range from a few millimeters to several meters skin zones that develop during the well drilling because of drilling mud and or rock flour invasion have lower permeability than the formation and are defined as a positive skin conversely negative skin zones with permeability higher than the formation develop when the drilling method induces substantial spalling and fracturing of the borehole wall butler 1988 investigated the problem of a well of infinitesimal radius with a finite thickness skin zone subject to a constant rate pumping by treating the well as a point force and found that the drawdown during a pumping test can be considered to consist of two components that are dependent and independent of near well properties novakowski 1989 solved the problem of a fully penetrating well subjected to a constant rate pumping in a confined aquifer accounting simultaneously for finite wellbore radius finite thickness skin zone and wellbore storage yeh et al 2003 derived the closed form time domain solution of the drawdown for a pumping test in a confined aquifer in terms of an improper integral which included the effects of a finite wellbore radius and finite thickness skin zone by accounting for the wellbore storage effect and the skin effect using the lumped skin factor eq 1 dejam et al 2013 investigated the behavior of transient pressure at a partially penetrating well in a naturally fractured reservoir and applied it to generate type curves to analyze the pressure of wellbores with a gas cap razminia et al 2016 examined the transient pressure in a fractal reservoir by taking into consideration both the wellbore storage and skin effects the aforementioned solutions were all developed using the traditional groundwater flow conceptual model which does not include the poroelastic effects associated with a pumping test the pumping induced horizontal deformation of an aquifer is well documented and recognized hsieh and cooley 1995 hsieh 1996 berg et al 2011 burbey 1999 2003 yin et al 2007 sneed et al 2018 but it remains a common assumption in groundwater theory that solid grains are incompressible and horizontal deformation of an aquifer is thought to have a negligible effect on pressure transience wang 2000 de simone and carrera 2017 fan et al 2019 although computed values of the hydraulic properties of aquifers using models based on groundwater flow theory yield significant insights into the physics controlling the feedback and interaction between well parameters and aquifer configurations using traditional models to interpret pumping tests can lead to erroneous outcomes for cases with strong poroelastic effects berg et al 2011 ding et al 2019 fan et al 2016 2020 fan and parashar 2019 poroelastic effects are thought to play a prominent role in low permeability hard rocks which are systems of interest for a variety of applications in subsurface hydrogeology such as nuclear waste storage tsang et al 2015 belmokhtar et al 2016 enhanced geothermal systems koh et al 2011 ghassemi and zhou 2011 fan and parashar 2019 and geological carbon sequestration wu et al 2010 de simone and carrera 2017 accurate and reliable hydraulic characterization of low permeability hard rocks is essential for assessing its long term performance for various applications tsang et al 2015 strong hydromechanical coupling occurs in these rocks when the system is subjected to high pumping rates and therefore taking into account the poroelastic effect may help obtain more accurate estimates of the subsurface properties the poroelastic effect for a well under a constant rate of discharge has been studied more extensively in petroleum engineering than in hydrology for instance cheng 2016 presented the analytical solution for fluid extraction from a poroelastic reservoir at a constant rate abousleiman and chen 2010 derived the poroelastic solution for an inclined borehole subjected to a finite length fluid flux mehrabian and abousleiman 2013 developed the fundamental poroelastic solutions for a wellbore under partial angular fluid flux and normal tractions chen 2019 further extended the solution of abousleiman and chen 2010 by developing three dimensional analytical solutions for an arbitrarily inclined wellbore subjected to a fluid discharge of finite length these analytical poroelastic solutions abousleiman and chen 2010 mehrabian and abousleiman 2013 cheng 2016 chen 2019 addressed the hydromechanical coupling associated with wells pumping at a constant rate without accounting for the effects of skin zone and wellbore storage to the best knowledge of the authors analytical solutions accounting for poroelastic effects in a system with a finite radius well that consider the wellbore storage and skin zone effects have not yet been reported the purpose of this paper is threefold 1 to derive new analytical solutions for a pumping test that simultaneously accounts for poroelastic effect wellbore storage and finite wellbore skin zone 2 to compare this new solution with transient solutions obtained from existing simpler analytical methods and 3 to determine the conditions under which the drawdown solutions obtained are reasonably accurate and reliable without incorporating the poroelastic effect we used laplace transform to solve the governing equations in plane strain poroelasticity and explored the effects of wellbore storage skin zone types thickness and poroelastic deformation on the temporal spatial evolution of drawdown in the pumping well and in the aquifer the results presented in this paper are expected to provide useful guidance for observation well placement and to help practitioners better interpret the pumping test results the analytical solutions derived in this paper may serve as a benchmark for validating numerical models and methods in poroelasticity 2 mathematical formulation 2 1 statement of the problem consider a fully penetrating pumping well of radius rw with a skin zone of radius rs embedded in a homogeneous isotropic poroelastic confined aquifer fig 1 at time zero pumping starts at a constant volumetric rate q from the pumping well the key assumptions underlying the poroelastic formulation for the aforementioned system are as follows 1 the aquifer is homogeneous and isotropic 2 the pumped aquifer is horizontal and of infinite extent 3 the aquifer is poroelastic and follows the classical biot theory 4 the skin zone and the formation have the same mechanical properties but different hydraulic properties and 5 the screen interval of the pumping well spans the thickness of the aquifer and the plane strain condition prevails in the horizontal plane within the classical framework of biot poroelasticity fluid flow is assumed to follow darcy s law wang 2000 we note that this simplified assumption may not be valid in ultratight low permeability media particularly when the hydraulic gradient is very small neuzil 1986 dejam et al 2017 the fourth assumption is justified based on observations that the skin zones develop mainly due to drilling and completion practices which result in an altered permeability in a region surrounding a wellbore without significant changes in the mechanical properties nowakowski 1989 because the length of the screen interval of the pumping well is much larger than the well diameter and the flux and traction boundary conditions do not vary along the wellbore axis the plain strain condition is assumed for the plain strain condition the constitutive equations in polar coordinate systems which express the total stresses σ ij and pore pressure p in terms of strains ε ij and increment of fluid content ζ are as follows wang 2000 cheng 2016 2 σ r r 2 g ε r r 2 g ν u 1 2 ν u ε k k α m ς 3 σ θ θ 2 g ε θ θ 2 g ν u 1 2 ν u ε k k α m ς 4 σ z z 2 g ν u 1 2 ν u ε k k α m ς 5 p m ς α ε k k where σ rr σθθ and σ zz are the radial hoop and axial stresses respectively ε rr εθθ and ε zz are the radial hoop and axial strains respectively and ε kk is the bulk strain the material constants given above are the shear modulus g the undrained poisson s ratio νu the biot coefficient α and the biot modulus m the biot coefficient α is a ratio signifying the fluid volume change induced by the bulk volume change under drained conditions wang 2000 for the axial symmetry case the strain components are related to the displacement by 6 ε r r u r r ε θ θ u r r ε z z 0 where ur is the radial displacement the bulk strain is given by 7 ε k k u r r u r r 1 r r r u r for a fully saturated rock without any fluid sources or sinks the conservation of fluid mass yields 8 ς t c 2 ς equivalently eq 8 can be written as green and wang 1990 9 t p b 3 σ k k c 2 p b 3 σ k k in the above b is the skempton s coefficient which is defined as the ratio of the induced pore pressure to the change of bulk stress under undrained conditions wang 2000 c is the hydraulic diffusivity which is defined as c ρ f g k μ s s and ss is the specific storage given by green and wang 1990 wang 1993 10 s s ρ f g ϕ 1 k f 1 k s α k v 1 4 g 3 k s where ρ f is the fluid density g is the gravitational acceleration k is permeability μ is the fluid dynamic viscosity ϕ is the porosity kf and ks are the bulk modulus for fluids and solids respectively and kv is the drained vertical bulk modulus wang 2000 which can be expressed in terms of the bulk modulus kb and shear modulus g of the matrix as follows 11 k v k b 4 3 g the equilibrium equation which describes the system under the influence of radial and hoop stresses is given by 12 σ r r r σ r r σ θ θ r 0 substituting the constitutive eqs 2 3 and strain displacement relations 6 and 7 into the equilibrium eq 12 yields the governing equation for displacement 13 2 g 1 ν u 1 2 ν u 2 u r r 2 1 r u r r u r r 2 α m ς r eq 13 can be rearranged into 14 ε k k r α m 1 2 ν u 2 g 1 ν u ς r the initial conditions that describe the system before the onset of pumping are expressed by equating the excess pore pressure increment of fluid content radial stress and radial displacement to zero 15 p 1 r 0 p 2 r 0 0 16 ς 1 r 0 ς 2 r 0 0 17 σ r 1 r 0 σ r 2 r 0 0 18 u r 1 r 0 u r 2 r 0 0 where the subscripts 1 and 2 refer to the skin zone rw r rs and the formation zone rs r respectively the boundary conditions are specified below at the far field 19 p 2 0 0 ς 2 0 0 σ r 2 0 0 u r 2 0 0 at the borehole surface 20 σ r 1 r w t p 1 r w t h t 21 2 π r w b k 1 μ p 1 r r r w c w ρ f g p 1 t r r w q h t where h t is the heaviside function p 1 is the time dependent fluid pressure required to pump at a constant rate q from the wellbore this is an implicit initial boundary value problem because p 1 is unknown a priori the wellbore storage coefficient is c w π r c 2 novakowski 1989 where rc is the radius of the well casing at the interface between the skin and formation zone r rs the continuity of the pore pressure fluid flux radial displacement and radial stress leads to 22 p 1 r s t p 2 r s t 23 κ 1 p 1 r r s t κ 2 p 2 r r s t 24 u r 1 r s t u r 2 r s t 25 σ r 1 r s t σ r 2 r s t in eq 23 κ 1 k 1 μ and κ 2 k 2 μ are the mobility of the skin zone and formation respectively 2 2 analytical solutions in the laplace domain analytical solutions were derived in the laplace domain appendix a provides the detailed derivations in the skin zone the laplace domain solutions for pore pressure radial hoop and axial stresses and displacement are 26 p 1 1 s q μ 2 π r w b k 1 s c 1 ψ 2 i 0 r s c 1 ψ 1 k 0 r s c 1 ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 27 σ r r 1 1 s q μ 2 π r w b k 1 s c 1 2 η ψ 1 f 1 r s c 1 2 η ψ 2 f 2 r s c 1 f 3 r w 2 r 2 ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 28 σ θ θ 1 1 s q μ 2 π r w b k 1 s c 1 2 η ψ 1 f 1 r s c 1 2 η ψ 2 f 2 r s c 1 f 3 r w 2 r 2 2 η f 4 ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 29 σ z z 1 1 s q μ 2 π r w b k 1 s c 1 2 η f 4 ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 30 u r 1 1 g s q μ 2 π r w b k 1 s c 1 η ψ 1 f 1 s c 1 η ψ 2 f 2 s c 1 f 3 r w 2 2 r ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 where the tilde represents the laplace transform s is the transform variable i 0 and i 1 are the modified bessel function of the first kind of order zero and first order respectively and k 0 and k 1 are the modified bessel function of the second kind of order zero and first order respectively functions ψ1 ψ2 and ψ3 are given by 31 ψ 1 k 2 k 1 c 1 c 2 i 0 r s s c 1 k 1 r s s c 2 i 1 r s s c 1 k 0 r s s c 2 32 ψ 2 k 1 r s s c 1 k 0 r s s c 2 k 2 k 1 c 1 c 2 k 0 r s s c 1 k 1 r s s c 2 and 33 ψ 3 c w s 2 π r w b ρ g k 1 μ s c 1 ψ 2 i 0 r w s c 1 ψ 1 k 0 r w s c 1 functions f 1 f 4 are defined as 34 f 1 k 1 r s c 1 r w r k 1 r w s c 1 35 f 2 r w r i 1 r w s c 1 i 1 r s c 1 36 f 3 ψ 2 i 0 r w s c 1 ψ 1 k 0 r w s c 1 37 f 4 ψ 2 i 0 r s c 1 ψ 1 k 0 r s c 1 in the formation zone the laplace domain solutions for pore pressure radial hoop and axial stresses and displacement are given by 38 p 2 1 s q μ 2 π r w b k 1 s c 1 k 0 r s c 2 ψ 2 i 0 r s s c 1 ψ 1 k 0 r s s c 1 k 0 r s s c 2 ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 39 σ r r 2 1 s q μ 2 π r w b k 1 s c 1 1 ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 2 η r s c 2 f 5 f 8 k 0 r s s c 2 2 η ψ 2 r s c 1 f 6 2 η ψ 1 r s c 1 f 7 r w 2 r 2 f 3 40 σ θ θ 2 1 s q μ 2 π r w b k 1 s c 1 1 ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 r w 2 r 2 f 3 2 η f 8 f 5 r s c 2 k 0 r s c 2 r s c 2 k 0 r s s c 2 2 η ψ 2 r s c 1 f 6 2 η ψ 1 r s c 1 f 7 41 σ z z 2 1 s q μ 2 π r w b k 1 s c 1 k 0 r s c 2 k 0 r s s c 2 2 η f 8 ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 42 u r 2 1 s g q μ 2 π r w b k 1 s c 1 1 ψ 1 k 1 r w s c 1 ψ 2 i 1 r w s c 1 ψ 3 r w 2 2 r f 3 η f 5 f 8 s c 2 k 0 r s s c 2 η s c 1 ψ 2 f 6 η s c 1 ψ 1 f 7 where functions f 5 f 8 are defined as 43 f 5 k 1 r s c 2 r s r k 1 r s s c 2 44 f 6 r w r i 1 r w s c 1 r s r i 1 r s s c 1 45 f 7 r s r k 1 r s s c 1 r w r k 1 r w s c 1 46 f 8 ψ 2 i 0 r s s c 1 ψ 1 k 0 r s s c 1 2 3 dimensionless solutions dimensionless solutions were determined using the following nondimensional variables from novakowski 1989 and yeh et al 2003 c c 2 c 1 k k 2 k 1 c w c w 2 π r w 2 b s s 2 ρ r r w ρ s r s r w t c 2 t r w 2 β r w s c 2 ξ r s c 2 p p 2 π b κ 2 q σ r r 2 π b κ 2 σ r r q σ θ θ 2 π b κ 2 σ θ θ q σ z z 2 π b κ 2 σ z z q and u r 2 π g b κ 2 u r q r w where t is the dimensionless time c w is a dimensionless measure of the wellbore storage ρ is the dimensionless radial distance from the pumping well ρ s is the dimensionless skin thickness σ r r σ θ θ and σ z z are dimensionless radial hoop and axial stresses respectively u r is dimensionless radial displacement and p is dimensionless pore pressure change the hydraulic drawdown sh is related to the pore pressure drop p through 47 s h p ρ f g the dimensionless drawdown and its gradient are respectively defined as 48 s h 2 π b k 2 s h q 49 s h ρ s h ρ the laplace domain solutions for dimensionless variables obtained by nondimensionalizing the solutions presented in the previous section are given below in the skin zone 50 p 1 s h 1 1 s k β c ψ 2 i 0 ρ β c ψ 1 k 0 ρ β c ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 51 s h 1 ρ 1 s k ψ 2 i 1 ρ β c ψ 1 k 1 ρ β c ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 52 σ r r 1 1 s k β c 1 ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 2 η ψ 1 f 1 ρ β c 2 η ψ 2 f 2 ρ β c 1 ρ 2 f 3 53 σ θ θ 1 1 s k β c 1 ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 2 η ψ 1 f 1 ρ β c 2 η ψ 2 f 2 ρ β c 1 ρ 2 f 3 2 η f 4 54 σ z z 1 1 s k β c 2 η f 4 ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 55 u r 1 1 s k β c 1 ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 η ψ 1 f 1 β c η ψ 2 f 2 β c 1 2 ρ f 3 where 56 ψ 1 k c i 0 ρ s β c k 1 ρ s β i 1 ρ s β c k 0 ρ s β 57 ψ 2 k 1 ρ s β c k 0 ρ s β k c k 0 ρ s β c k 1 ρ s β 58 ψ 3 c w β k c ψ 2 i 0 β c ψ 1 k 0 β c 59 f 1 k 1 ρ β c k 1 β c ρ 60 f 2 i 1 β c ρ i 1 ρ β c 61 f 3 ψ 2 i 0 β c ψ 1 k 0 β c 62 f 4 ψ 2 i 0 ρ β c ψ 1 k 0 ρ β c in the formation zone 63 p 2 s h 2 1 s k β c k 0 ρ β ψ 2 i 0 ρ s β c ψ 1 k 0 ρ s β c k 0 ρ s β ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 64 s h 2 ρ 1 s k c k 1 ρ β ψ 2 i 0 ρ s β c ψ 1 k 0 ρ s β c k 0 ρ s β ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 65 σ r r 2 1 s k β c 1 ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 2 η ρ β f 5 f 8 k 0 ρ s β 2 η ψ 2 f 6 ρ β c 2 η ψ 1 f 7 ρ β c f 3 ρ 2 66 σ θ θ 2 1 s k β c 1 ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 f 3 ρ 2 2 η ρ β f 8 f 5 ρ β k 0 ρ β k 0 ρ s β 2 η ψ 2 ρ β c f 6 2 η ψ 1 ρ β c f 7 67 σ z z 2 1 s k β c 2 η k 0 ρ β ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 f 8 k 0 ρ s β 68 u r 2 1 s k β c 1 ψ 1 k 1 β c ψ 2 i 1 β c ψ 3 1 2 ρ f 3 η f 5 f 8 β k 0 ρ s β η ψ 2 β c f 6 η ψ 1 β c f 7 where 69 f 5 k 1 ρ β ρ s k 1 ρ s β ρ 70 f 6 i 1 β c ρ ρ s i 1 ρ s β c ρ 71 f 7 k 1 ρ s β c ρ s ρ k 1 β c ρ 72 f 8 ψ 2 i 0 ρ s β c ψ 1 k 0 ρ s β c 3 comparison with existing analytical solutions verification of the analytical solutions derived above was performed by comparing them to existing solutions in groundwater and poroelastic literature 3 1 comparison with analytical solutions in groundwater theory replacing the specific storage defined in eq 10 with the specific storage used in the groundwater flow model eq 87 avoids the poroelastic effects and therefore eqs 50 and 63 can be reduced to the solutions of novakowski 1989 when and the pumping well has a finite diameter but negligibly small storage setting c w 0 reduces eqs 50 and 63 to 73 s h 1 1 s k β c ψ 2 i 0 ρ β c ψ 1 k 0 ρ β c ψ 1 k 1 β c ψ 2 i 1 β c and 74 s h 2 1 s k β c k 0 ρ β ψ 2 i 0 ρ s β c ψ 1 k 0 ρ s β c k 0 ρ s β ψ 1 k 1 β c ψ 2 i 1 β c respectively which agree with the solutions of yeh et al 2003 when the fully penetrating pumping well has storage but lacks skin zone setting c 1 k 1 and ρ s 1 reduces eq 63 to 75 s h 2 1 s 1 β k 0 ρ β k 1 β β c w k 0 β which is identical to eq 2 of papadopulos and cooper 1967 when the pumping well has an infinitesimal radius and a finite thickness skin zone setting β 0 and using lim x 0 x k 1 x 1 reduces eqs 50 and 63 to 76 s h 1 k s k 0 ρ β c ψ 2 ψ 1 i 0 ρ β c and 77 s h 2 1 s k ρ s β c k 0 ρ β ψ 1 respectively which are consistent with eqs 16 and 17 of butler 1988 when the skin zone is absent the two equations further reduce to 78 s h 2 k 0 ρ β s which is the laplace transform of the theis solution theis 1935 3 2 comparison with analytical solutions in poroelastic theory when the pumping well has a finite radius and no skin zone but negligibly small storage in a uniform aquifer setting c w 0 c 1 k 1 and ρ s 1 reduces eq 63 to 79 s h 2 1 s 1 β k 0 ρ β k 1 β which is in agreement with eq 7 645 of cheng 2016 eqs 52 and 65 reduce to 80 σ r r 1 σ r r 2 1 s 2 η ρ β 2 k 1 ρ β k 1 β 1 ρ 1 s 1 ρ 2 β k 0 β k 1 β eqs 53 and 66 reduce to 81 σ θ θ 1 σ θ θ 2 1 s 1 ρ 2 β k 0 β k 1 β 2 η s k 1 ρ β ρ β 2 k 1 β 1 ρ 2 β 2 k 0 ρ β β k 1 β from eqs 79 to 81 we can get the terzaghi s effective radial and hoop stresses as follows 82 σ r r 1 s 2 η ρ β 2 k 1 ρ β k 1 β 1 ρ 1 s 1 ρ 2 β k 0 β k 1 β 1 s 1 β k 0 ρ β k 1 β 83 σ θ θ 1 s 1 ρ 2 β k 0 β k 1 β 2 η s k 1 ρ β ρ β 2 k 1 β 1 ρ 2 β 2 k 0 ρ β β k 1 β 1 s 1 β k 0 ρ β k 1 β eqs 82 and 83 agree with eqs 7 734 and 7 735 of cheng 2016 respectively 4 results and discussion to obtain the solutions in the time domain we carried out an inverse laplace transform using the stehfest algorithm stehfest 1970 because of its computational efficiency and accuracy which is given by 84 f t ln 2 t i 1 n v i f ln 2 t i where 85 v i 1 i n 2 k i 1 2 min i n 2 k n 2 2 k n 2 k k k 1 i k 2 k i we use n 10 in our numerical inversion the main challenges in the numerical inversion of the laplace transform lie in the singularity of the modified bessel function of first kind of zero order and first order at a very large s the following asymptotic expansions are used for a large s abramowitz and stegun 1964 86 i 0 s exp s 2 π s 1 1 8 s 9 128 s 2 i 1 s exp s 2 π s 1 3 8 s 15 128 s 2 in the numerical examples considered here sandstone and marble are used as two representative materials for illustrative purposes these two rocks represent systems with widely different hydromechanical properties sandstone aquifers are prominently featured in groundwater resources studies whereas the study of marble reservoirs is more useful for applications in which low permeability is encountered or is desired such as studying enhanced geothermal systems nuclear waste repositories or carbon sequestration methods table 1 lists the hydromechanical properties of berea sandstone and tennessee marble as reported in wang 2000 and cheng 2016 we focused on the effects of poroelastic coupling on the transient drawdown behavior a parametric study was performed to investigate the sensitivity of drawdown to variations in physical parameters including skin type skin thickness and wellbore storage 4 1 effects of poroelasticity before we explore the effects of poroelastic deformation on the transient drawdown it is instructive to compare the fully coupled poroelastic formulations to the uncoupled groundwater flow theory the governing equation for transient flow widely used in conventional groundwater theory is yeh and chang 2013 87 2 s h s s k s h t where sh is the drawdown in the aquifer ss is the specific storage coefficient and k is the hydraulic conductivity hydraulic conductivity k is related to permeability k by k ρ f g k μ under the assumption of constant vertical stress and uniaxial deformation the specific storage in classical groundwater theory is given as jacob 1940 88 s s ρ g 1 k v ϕ k f in the jacob s equation for specific storage that is commonly used in groundwater flow theory solid grains are assumed incompressible which results in a higher specific storage than the storage calculated using eq 10 in poroelasticity therefore the uncoupled groundwater theory overestimates the specific storage and consequently underestimates the hydraulic diffusivity and predicts a lower drawdown compared with the coupled poroelasticity under identical pumping test conditions the second key difference between groundwater theory and poroelasticity can be observed by comparing eqs 9 and 87 in poroelasticity the linear combination of pore pressure and mean stress follows the diffusion equation mathematically the rate of changes in mean stress with respect to time is equivalent to a fluid source in groundwater theory however hydraulic drawdown and therefore pore pressure change satisfies a homogeneous diffusion equation to separate the effect of poroelastic deformation from wellbore storage and skin zone we use the following parameters c w 0 c 1 and k 1 figs 2 a and b show a comparison of the dimensionless drawdown predicted using groundwater theory and coupled poroelasticity as a function of radial distance from the pumping well at various nondimensional times for sandstone and marble respectively at a given time hydraulic drawdown decreases monotonically with increasing distance from the pumping well at the pumping well drawdown increases steadily with increasing time the general trends of the radial distribution of drawdown are similar for sandstone and marble and groundwater theory is seen to underestimate the drawdown at the pumping well for sandstone the drawdown distribution obtained from poroelasticity is slightly higher than that obtained from groundwater theory at the same time for marble the observed difference in drawdown distribution is significantly higher this phenomenon can be explained by examining the difference in specific storage in eqs 10 and 88 and noting the contribution of volumetric deformation to the changes in pore pressure for marble the calculated specific storage using jacob s eq 88 is 75 larger than the specific storage calculated using eq 10 which incorporated poroelasticity for sandstone the difference is approximately 8 therefore for marble groundwater theory overestimates specific storage and significantly underestimates the hydraulic diffusivity leading to a smaller magnitude and slower evolution of drawdown furthermore eq 5 indicates that pore pressure changes drawdowns come from two sources 1 fluid released from storage and 2 volumetric deformation of the matrix due to the skempton effect the groundwater theory underestimates the drawdown without capturing pumping induced volumetric deformation the sharp difference in drawdown prediction for marble highlights the significance of including poroelasticity in estimating hydraulic parameters based on pumping test conducted in low permeable aquifers and reservoirs using the same parameters as those used in figs 2 3 a and 3b show the influence of poroelasticity on the radial distribution of the nondimensional drawdown gradient at different normalized times for sandstone and marble respectively the nondimensional drawdown analysis provides a general hydrodynamic conceptual framework to represent the transient evolution of the shape of the pressure front pulse that diffuses throughout an aquifer during pumping barker 1988 ferroud et al 2019 it is evident that at a given location the drawdown gradient deceases with increasing time at a given time drawdown gradient decreases steadily with increases in the radial distance from the pumping well as expected the drawdown gradient for sandstone is marginally sensitive to poroelastic deformation for marble groundwater theory underestimates the drawdown gradient slightly at the beginning of the pumping test and the differences increases with increasing time 4 2 effects of skin types to examine the effects of skin types on aquifer response temporal evolution of dimensionless drawdown distributions are shown in figs 4 and 5 at the pumping well ρ 1 and at a hypothetical observation well located at ρ 100 for conditions described by ρ s 3 c w 0 with k ranging from 0 1 to 10 note that k 1 represents the case of a homogeneous formation whereas k 0 1 and k 10 represent the negative and positive skin zone respectively the pumping well with a positive skin zone has a remarkably larger drawdown than those without a skin zone or with a negative skin zone this can be explained by observing that in the case of a positive skin the permeability of the skin zone is smaller than the permeability of the formation it also takes longer to compensate for the diffusion induced pressure loss to maintain a constant pumping rate at the wellbore for a negative skin pore pressure diffuses quickly from the formation to the wellbore and so a small drawdown pore pressure decrease is observed at the pumping well drawdown is more affected by the positive skin than by the negative skin especially in the vicinity of the pumping well at the observation well ρ 100 the skin effect is negligible as seen by a nearly complete overlap of drawdown curves for the three k values in fig 5 for sandstone the magnitude of drawdown at the wellbore predicted from groundwater theory is close to that predicted from poroelasticity for marble the magnitude of drawdown at the pumping well obtained from groundwater theory is smaller than that obtained from poroelasticity and the difference is more pronounced at early pumping time t 30 at the observation well the magnitude of poroelasticity based drawdown is significantly greater than that predicted from groundwater theory at a long pumping time t 1000 for example at t 10 000 the drawdown at ρ 100 from poroelasticity is approximately 36 greater than that predicted from groundwater theory 4 3 effects of skin thickness to investigate the sensitivity of drawdown to a pumping test in a well with variable skin thickness we studied a well with positive skin k 10 of variable thickness ρ s 1 3 and 10 and plotted the evolution of drawdown at the pumping well ρ 1 and at the observation well ρ 100 in figs 6 and 7 respectively note that ρ s 1 denotes the case of a pumping well without a skin zone it is evident from fig 6 that the drawdown at the pumping well increases with the increasing thickness of the positive skin zone a positive skin means a lower permeability in the skin zone than in the formation and therefore a thicker positive skin means that groundwater replenishment into the well takes longer through the skin zone at the observation well ρ 100 the drawdowns are not sensitive to the thickness of the skin zone which suggests that skin zone properties type and thickness play a minor role in far field drawdowns 4 4 effects of wellbore storage to investigate the effects of wellbore storage on aquifer performance in response to pumping tests from wells with different storage we measured the drawdowns at the pumping well ρ 1 and at the observation well ρ 100 figs 8 and 9 show the pumping and observation well drawdowns corresponding wellbore storage based on the following physical parameters ρ s 3 k 10 and c 10 there are two noteworthy features first wellbore storage delays the migration of groundwater from the formation to the well increasing wellbore storage results in an appreciable decrease in drawdown at the pumping well and at the observation well which can be seen by comparing the extent of the vertical axes in figs 8 and 9 to those of fig 4 through 7 second poroelastic effect is largely masked by the wellbore storage effect so the drawdown predicted at the pumping well using groundwater theory is indistinguishable from drawdown associated with poroelasticity this condition is applicable to both sandstone and marble and it is more pronounced in the vicinity of the pumping well 4 5 pumping induced stress changes for illustrative purposes fig 10 shows the pumping induced radial hoop and axial stresses as functions of radial distance at various dimensionless times for marble with the following physical parameters ρ s 3 k 10 and c w 2 2 10 4 it is evident that poroelastic stresses develop significantly in the skin zone especially at early time at a given time induced stresses drop sharply with increasing distance from the pumping well at a given location compressive hoop stress and tensile radial axial stress progressively increase with time the axial stress exhibits a sharp change in slope at the interface of the skin zone with the formation set at ρ 3 in these examples the magnitude of axial stress is comparatively smaller than the magnitude of radial and hoop stresses but the axial stress decreases more slowly with respect to distance resulting in appreciable values of axial stress far away from the pumping well at late times the hoop stress is directly related to the borehole integrity i e when the terzaghi effective hoop stress at the borehole wall reaches the tensile strength of the rock matrix tensile fracture initiates at the borehole wall and breakdown occurs eq 53 and fig 10b can therefore be used to set the upper bound limits for pumping rates which would generate measurable pressure drawdowns without causing wellbore breakdown 5 conclusions this paper derives analytical solutions for transient flow to a finite radius well in a poroelastic confined aquifer that is subjected to a constant rate pumping the solutions presented herein which unify the groundwater solutions of novakowski 1989 and the poroelasticity solutions of cheng 2016 simultaneously account for the effects and interactions of a finite thickness skin zone wellbore storage and poroelastic deformation on hydraulic drawdown in the pumping well and in the observation wells for a uniform aquifer and a finite radius well without storage the presented laplace domain solutions have been shown to reduce to the cheng 2016 solution when the combined effects of wellbore storage and finite thickness skin zone are significant but poroelastic effect is not strong our solutions agree with those presented in novakowski 1989 therefore the following conclusions can be drawn from this study 1 for constant rate pumping tests conducted in low permeable confined hard rocks groundwater theory significantly underestimates the hydraulic drawdown in the pumping well compared with the drawdown predicted from poroelasticity especially when a positive skin is present hydraulic drawdowns in far field observation wells are sensitive to poroelastic effects for high permeable rocks there is a slight difference between the drawdowns predicted from classic groundwater theory and poroelasticity 2 under otherwise same conditions a wellbore with a positive skin undergoes greater drawdowns than wellbores with a negative skin or without any skin the well skin zone has a negligibly small effect on far field drawdowns 3 wellbore storage significantly delays drawdowns at the pumping well and tends to mask the poroelastic effect in the vicinity of the pumping well the solutions developed in this paper can be used to investigate the effects of poroelastic deformation skin zone properties and wellbore storage on the drawdown distribution in the pumping well as well as in the observation wells this information provides useful guidance to practitioners to analyze and interpret pumping tests determine the optimal placement of observation wells and set appropriate well operation parameters to ensure wellbore integrity credit authorship contribution statement zhiqiang fan conceptualization methodology validation formal analysis writing original draft writing review editing rishi parashar writing review editing declaration of competing interest the authors declare that they have no conflict of interest acknowledgments we thank the associate editor nicole daman and five anonymous reviewers for their helpful comments that greatly improved the paper the first author would like to acknowledge the support from nell j redfield foundation the maki endowment and the desert research institute appendix a derivation of eqs 26 46 applying the laplace transform of governing eq 8 for fluid variation ζ in the skin zone with respect to time t yields a 1 d 2 ς 1 d r 2 1 r d ς 1 d r s c 1 ς 1 0 the general solution of a 1 is a 2 ς 1 r s a 1 r s i 0 r s c 1 a 2 r s k 0 r s c 1 where a 1 and a 2 are two integration constants applying the laplace transform to eq 13 and integrating the result in a 3 ε k k 1 r s η g s 1 ς 1 r s 2 a 3 where η α 1 2 ν 2 1 ν and s 1 1 ν u 1 2 ν m 1 ν 1 2 ν u are two poroelastic constants and a 3 is an integration constant substituting and integrating eq 7 into the above equation gives a 4 u r 1 1 r η g s 1 r ς 1 d r a 3 r a 4 r η g s 1 a 1 i 1 r s c 1 s c 1 η g s 1 a 2 k 1 r s c 1 s c 1 a 3 r a 4 r where a 4 is an integration constant using eq 6 we can get the laplace transform of strain components then the skin zone stress components pore pressure and fluid flux in the laplace domain are given by a 5 σ r r 1 2 η s 1 a 1 i 1 r s c 1 r s c 1 2 η s 1 a 2 k 1 r s c 1 r s c 1 2 g 1 2 ν u a 3 2 g r 2 a 4 a 6 σ θ θ 1 2 η s 1 a 1 i 1 r s c 1 r s c 1 i 0 r s c 1 2 η s 1 a 2 k 1 r s c 1 r s c 1 k 0 r s c 1 2 g 1 2 ν u a 3 2 g r 2 a 4 a 7 σ z z 1 2 η s 1 a 1 i 0 r s c 1 2 η s 1 a 2 k 0 r s c 1 4 g ν u 1 2 ν u a 3 a 8 p 1 a 1 i 0 r s c 1 s 1 a 2 k 0 r s c 1 s 1 2 α m a 3 a 9 q r 1 a 1 k 1 μ s c 1 i 1 r s c 1 s 1 a 2 k 1 μ s c 1 k 1 r s c 1 s 1 similarly we get the laplace transform of stress pore pressure displacement and variation of fluid in the formation as follows a 10 ς 2 r s b 1 r s i 0 r s c 2 b 2 r s k 0 r s c 2 a 11 σ r r 2 2 η s 2 b 1 i 1 r s c 2 r s c 2 2 η s 2 b 2 k 1 r s c 2 r s c 2 2 g 1 2 ν u b 3 2 g r 2 b 4 a 12 σ θ θ 2 2 η s 2 b 1 i 1 r s c 2 r s c 2 i 0 r s c 2 2 η s 2 b 2 k 1 r s c 2 r s c 2 k 0 r s c 2 2 g 1 2 ν u b 3 2 g r 2 b 4 a 13 σ zz 2 2 η s 2 b 1 i 0 r s c 2 2 η s 2 b 2 k 0 r s c 2 4 g ν u 1 2 ν u b 3 a 14 p 2 1 s 2 b 1 i 0 r s c 2 1 s 2 b 2 k 0 r s c 2 2 α m b 3 a 15 q r 2 b 1 k 2 μ s c 2 i 1 r s c 2 s 2 b 2 k 2 μ s c 2 k 1 r s c 2 s 2 where b 1 b 4 are constants to de determined by the boundary conditions and continuity conditions at the skin formation interface the boundary condition 19 requires that a 16 b 1 b 3 0 application of the laplace transform to the boundary conditions at the wellbore 20 21 using equations a 5 and a 8 yields a 17 2 η s 1 a 1 i 1 r w s c 1 r w s c 1 2 η s 1 a 2 k 1 r w s c 1 r w s c 1 2 g 1 2 ν u a 3 2 g r w 2 a 4 a 1 i 0 r w s c 1 s 1 a 2 k 0 r w s c 1 s 1 2 α m a 3 a 18 2 π r w b k 1 μ a 1 s 1 s c 1 i 1 r w s c 1 a 2 s 1 s c 1 k 1 r w s c 1 c w s ρ f g a 1 s 1 i 0 r w s c 1 a 2 s 1 k 0 r w s c 1 2 α m a 3 q s at the interface between the skin zone and formation zone the continuity of radial displacement radial stress pore pressure and fluid flux requires that a 19 η g s 1 a 1 i 1 r s s c 1 s c 1 η g s 1 a 2 k 1 r s s c 1 s c 1 a 3 r s a 4 r s η g s 2 b 2 k 1 r s s c 2 s c 2 b 4 r s a 20 2 η s 1 a 1 i 1 r s s c 1 r s s c 1 2 η s 1 a 2 k 1 r s s c 1 r s s c 1 2 g 1 2 ν u a 3 2 g r s 2 a 4 2 η s 2 b 2 k 1 r s s c 2 r s s c 2 2 g r s 2 b 4 a 21 a 1 i 0 r s s c 1 s 1 a 2 k 0 r s s c 1 s 1 2 α m a 3 b 2 k 0 r s s c 2 s 2 a 22 a 1 k 1 μ s c 1 i 1 r s s c 1 s 1 a 2 k 1 μ s c 1 k 1 r s s c 1 s 1 b 2 k 2 μ k 1 r s s c 2 s 2 eqs a 17 to a 22 are solved simultaneously to determine the remaining constants a 1 to a 4 b 2 and b 4 which are then substituted back into eqs a 5 to a 15 to get the laplace domain solutions for stress pore pressure and displacement in the skin zone and formation zone 
