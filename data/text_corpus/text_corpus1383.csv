index,text
6915,in this paper a novel laplace transform boundary element model for pumping tests in irregularly shaped double porosity aquifers is presented the aquifer could be associated with various boundary conditions such as the general robin boundary conditions or even the mixed boundary conditions with no flow boundary on one side and constant head boundary on the other side the derived solution has analytical characteristics since it is obtained through the green s function method within the domain unlike traditional numerical methods the proposed solution using the laplace transform boundary element method does not require discretization in spatial and temporal dimensions in this study boundary integral equation using green s second theorem and the fundamental solution of green function for dual porosity models are given a boundary element matrix in laplace space is established which allow us to consider irregularly shaped boundary the drawdown and flux on the boundary can be obtained through solving the boundary element matrix by gauss s elimination method the final solution for wellbore drawdown is evaluated using numerical laplace inversion algorithm of stehfest 1970 many previous solutions for transient flow in finite single porosity aquifers with no flow outer boundary condition are shown to be special cases of the present solution furthermore the solution with a mixed outer boundary condition is used to investigate the effect of important parameters of aquifers on wellbore drawdown including fracture storage coefficient inter porosity flow coefficient from matrix to fissures boundary shape boundary location and interference of multiple wells keywords double porosity medium boundary element irregularly shaped boundary wellbore drawdown green s function 1 introduction the concept of dual porosity was proposed by barenblatt et al 1960 there are two methods to describe inter porosity flow behavior between the fissures and the matrix one is based on the assumption of pseudo steady state flow warren and root 1963 and the other approach is based on the assumption of transient flow kazemi 1969 boulton and streltsova 1977 double porosity models has been studied by scholars for several decades in both groundwater and petroleum literatures warren and root 1963 kazemi 1969 gringarten and ramey 1973 boulton and streltsova 1977 bourdet and gringarten 1980 moench 1984 hamm and bidaux 1996 lods and gouze 2004 slimani and tiab 2008 biryukov and kuchuk 2012 jia et al 2013 kuhlman et al 2015 warren and root 1963 presented a laplace transform drawdown solution for pumping tests kazemi 1969 presented a numerical solution considering parallel matrix slabs using finite difference technique bourdet and gringarten 1980 and moench 1984 developed a dual porosity model considering wellbore storage and skin factor hamm and bidaux 1996 also proposed dual porosity models with fractal geometry and the analytical solutions are obtained using laplace transform method lods and gouze 2004 presented the software for well test analysis in fractured media slimani and tiab 2008 biryukov and kuchuk 2012 and jia et al 2013 presented different analytical models with warren and root double porosity mechanism recently kuhlman et al 2015 showed the effects of different boundary conditions at the outer edge of the domain for a double porosity problem in addition the effect of outer boundary on groundwater flow cannot be ignored in the literatures of groundwater researches most of them does not take account of the effect of the boundary shape by assuming the aquifer is associated with infinite extent or just consider the simple regular boundary shape such as circular shaped boundary muskat 1946 neuman 1972 1974 zhan et al 2001 yang and yeh 2002 muskat 1946 presented various analytical solutions in finite aquifers with circular shaped boundary under different outer boundary conditions such as a constant head boundary condition neuman 1972 1974 presented new mathematical models in unconfined aquifers considering delayed response of the water table and delayed gravity response respectively zhan et al 2001 presented a direct method to solve the boundary problem of flow to a horizontal well in anisotropic confined aquifers and derived a closed form analytical solution yang and yeh 2002 provided an analytical solution of the wellbore flow rate for the constant head test performed in an infinite extent aquifer some authors have also obtained analytical and semi analytical solutions in two zone or three zone radial confined aquifers with finite extent chu and grader 1991 1999 yeh et al 2003 pasandi et al 2008 wang et al 2012 lin et al 2016 although these scholars have tried to consider the influence of outer boundary on the wellbore drawdown and flow rate they have not considered the effect of the irregular boundary shape by using conventional analytical methods in the real world the boundary shape of an aquifer cannot be strictly circular or rectangular kuo et al 1994 utilized the image well method to predict the drawdown distribution in aquifers with irregularly shaped boundaries huang and yeh 2016 presented an analytical approach to estimate drawdown induced by well extraction in a heterogeneous confined aquifer with an irregular outer boundary the transient solution of a heterogeneous confined aquifer was also approximately obtained by using image well method recently wang et al 2018 presented a semi analytical model for pumping tests in finite heterogeneous confined aquifers with arbitrarily shaped boundary using boundary element method however this model can only be used in a conventional porous medium this solution cannot be applied when the natural fractures exists in the porous media the objective of this paper is to present a novel laplace transform boundary element model to quantify the transient behavior of hydraulic head in naturally fractured aquifers with double porosity characteristics three features in this proposed method have made it different from the previous ones first a double porosity governing equation for drawdown has been established to take account of the natural fractures second both boundary integral equation and the fundamental solution of green function for double porosity model has been provided third the boundary condition can be dirichlet neumann or robin type in this research a general boundary element matrix is established in laplace space which allow us to consider complex boundary shape the drawdown and flux on the boundary can be obtained through solving the boundary element matrix the final solution for wellbore drawdown is evaluated using the well known numerical laplace inversion algorithm of stehfest 1970 2 methodology 2 1 mathematical model we assume a horizontal isotropic double porosity finite confined aquifer with a uniform thickness multiple pumping wells and an irregularly shaped boundary the water flows into the pumping wells only through the natural fractures with a constant rate q and the pumping well fully penetrates the aquifer the flow domain is two dimensional and the pumping well has a finite radius r w by using the double porosity concept the flow in fractured porous media can be described by the following equations warren and root 1963 moench 1984 1 1 k f h f α k m h m h f ε 1 m q w ε b δ x x w ε δ y y w ε s sf h f t ω 1 2 α k m h f h m s sm h m t ω where the operator x y δ is dirac delta function and a one dimensional dirac delta function is defined by eqs 1 2 and 1 3 1 3 δ x x w ε 0 x x w ε x x w ε δ y y w ε 0 y y w ε y y w ε where h is the hydraulic head l k is the hydraulic conductivity lt 1 s sf and s sm is the specific storage capacity in the fractures and matrix l 1 α is the shape factor with dimensions of inverse area l 2 t is the time t m is well number b is aquifer thickness l x w y w is the well location x y is the coordinate of any point q w is pumping rate per unit of volume l3t 1 the superscript f represents fracture and m represents matrix the flow equations can be recast in a form more suitable for analysis of a pumping test when it is assumed that the well fully penetrates the aquifer and the aquifer is initially with a constant hydraulic head h 0 l in the fractures and matrix with a uniform thickness b l according to eq 1 the drawdown equation in the fissures and matrix can be expressed as 2 1 t s f i 1 m q wi δ x x wi δ y y wi s f s f t s m s m t ω 2 2 α bk m s f s m s m s m t ω where s f h 0 h f is drawdown in the fissures l s m h 0 h m drawdown in the rock matrix l s f s sf b overall aquifer storage coefficient of the fissures s m s sm b overall aquifer storage coefficient of the rock matrix t k f b overall aquifer transmissivity l2t 1 the drawdown for both fissures and matrix before pumping could be considered as zero and the initial condition can be given as 3 s f x y 0 s m x y 0 0 the outer condition at irregularly shaped boundary γ could be specified as robin type lin et al 2016 4 σ 1 s f σ 2 s f n σ 3 at γ where σ 1 σ 2 σ 3 are coefficients of robin type condition the reason to use the robin type boundary is that robin boundary condition is a linear combination of dirichlet and neumann conditions in eq 4 if σ 2 0 the robin condition can reduce to dirichlet condition and if σ 1 0 the robin condition can reduce to neumann condition in some cases the boundary is permeable with a weak recharge phenomenon where robin condition can be suitable to be applied to facilitate the expression of solution the following dimensionless definitions are used s fd 4 π ts f q r s md 4 π ts m q r x d x r w y d y r w x dwi x wi r w y dwi y wi r w t d tt s f s m r w 2 q dwi q wi q r ω s f s f s m λ α k m k f r w 2 where the subscript d represents a dimensionless symbol and q r represents reference flow rate l3t 1 sfd is dimensionless drawdown of fissures and smd is dimensionless drawdown of matrix xd yd is the dimensionless coordinate of any point xdwi ydwi is the dimensionless coordinate of ith well td is dimensionless time qdwi is dimensionless wellbore flow rate of ith well ω is fracture storage coefficient λ is inter porosity flow coefficient from matrix to fissures according to the definition of the above dimensionless variables dimensionless drawdown and boundary conditions in fractures and matrix can be expressed as 5 2 s fd ε 1 m 4 π q dw ε δ x d x dw ε δ y d y dw ε ω s fd t d 1 ω s md t d ω 6 λ s fd s md 1 ω s md t ω initial condition of eq 3 becomes 7 s fd x y 0 s md x y 0 0 out boundary condition becomes 8 α 1 s fd β 1 s fd n γ 1 at γ where α 1 σ 1 β 1 σ 2 r w and γ 1 4 π t σ 3 q r these equations from eqs 5 8 constitute the fundamental equations in double porosity aquifers 2 2 boundary integral equation take laplace transform to eqs 5 8 with respect to t d we can obtain the following system of equations 9 2 s fd τ f τ s fd ε 1 m 4 π q dw ε τ δ x d x dw ε δ y d y dw ε ω 10 s md λ 1 ω τ λ s fd ω where τ is the laplace transform parameter in respect to dimensionless time s md is dimensionless drawdown of matrix in laplace domain and s fd is dimensionless drawdown of fissures f τ is defined as 11 f τ 1 ω ω τ λ 1 ω τ λ outer boundary condition of eq 8 becomes 12 α 1 s fd β 1 s fd n γ 1 τ at γ note when ω 1 f τ 1 then eqs 7 and 12 become the flow problems in irregularly shaped homogenous aquifers and eq 9 in the text can be rewritten in a compact form as 13 ψ s fd ε 1 m 4 π q dw ε τ δ x d x dw ε δ y d y dw ε ω where 14 ψ 2 τ f τ 2 x d 2 2 y d 2 τ f τ is called as modified helmholtz operator in order to transform the solution in the domain ω to the boundary γ and obtain the boundary integral equation we also need to establish the auxiliary equation of green s function for eq 9 and the free space green function g for operator ψ satisfies the following equation 15 ψ g δ x d x dw ε δ y d y dw ε ω where g x d y d x d y d τ is green s function in the laplace space it is defined as the drawdown at x d y d due to a source of unit strength at coordinates x d y d according to green s secondary identity it gives 16 ω s fd ψ g g ψ s fd d ω γ s fd g n g s fd n d γ the domain integration problem can be translated into the boundary integration problem liggett and liu 1979 now substituting eq 16 into eqs 13 and 15 we can have 17 s fd m τ 4 π τ ε 1 m q dw ε ψ m τ γ g s fd n s fd g n d γ where 18 ψ m τ ω g m m τ d ω m x d y d m x d y d the two dimensional free space green s function with double porosity in the laplace domain could be given through solving the eq 15 19 g 1 2 π k 0 r d 1 ω ω τ λ 1 ω τ λ τ and 20 r d x d x d 2 y d y d 2 where k 0 is zero order bessel function rd represents the distance from the source point to the point the detailed derivation has been presented in appendix a of supplementary file 2 3 discretization and implementation into linear segments eq 17 can be solved for the unknown boundary condition by choosing finite number of node points mj j 1 2 3 n on the γ as shown in fig 1 a linear interpolating function for laplace space drawdown and flux normal derivative of drawdown on a boundary element is used to establish matrix now we need to discretize the aquifer boundaries into linear segments j 1 2 3 n as shown in fig 1 for this discretized aquifer eq 17 becomes see fig 2 21 s fd m τ 4 π τ ε 1 m q dw ε ψ m τ j 1 n γ j g s fd n s fd g n d γ over a small element γ j between a pair of node points mj and mj 1 the laplace space drawdown and its normal derivatives are expressed as 22 s fd n 1 ξ s fdj n 2 ξ s fdj 1 1 ξ 1 23 s fd n n 1 ξ s fdj n n 2 ξ s fdj 1 n 1 ξ 1 where n 1 ξ and n 2 ξ are called as interpolating functions the definition of these functions can be in appendix b of supplementary file now substituting eqs 22 and 23 into eq 21 we have 24 θ i 2 π s fdi m τ 4 π τ ε 1 m q dw ε ψ m τ j 1 n s fdj n γ j n 1 ξ g d γ j 1 n s fdj 1 n γ j n 2 ξ g d γ j 1 n s fdj γ j n 1 ξ g n d γ j 1 n s fdj 1 γ j n 2 ξ g n d γ where θ i is internal angle between two boundary elements at the boundary elements nodes θ i π due to linear segment liggett and liu 1979 at any interior of the aquifer domain θ 2 π as shown in fig 1 a the boundary is associated with a counter clockwise direction so that the targeted domain is always on the left when an observer is walking along the boundary let 25 h ij 1 γ j n 1 ξ g n d γ 26 h ij 2 γ j n 2 ξ g n d γ 27 q ij 1 γ j n 1 ξ g d γ 28 q ij 2 γ j n 2 ξ g d γ the evaluation of boundary integrals in eqs 25 28 can be found in the appendix b of supplementary file substituting eqs 25 28 into eq 24 we have 29 θ i 2 π s fdi m τ 4 π τ ε 1 m q dw ε ψ m τ j 1 n q ij 1 s fdj n j 1 n q ij 2 s fdj 1 n j 1 n h ij 1 s fdj j 1 n h ij 2 s fdj 1 rearrange eq 29 we can have 30 θ i 2 π s fdi m τ j 1 n h ij 1 s fdj j 1 n h ij 2 s fdj 1 j 1 n q ij 1 s fdj n j 1 n q ij 2 s fdj 1 n 4 π τ ε 1 m q dw ε ψ m τ 0 the expansion of the second and third terms on the left of the eq 30 gives 31 j 1 n h ij 1 s fdj h ij 2 s fdj 1 h in 2 h i 1 1 s fd 1 h i 1 2 h i 2 1 s fd 2 h ij 1 2 h ij 1 s fdj h in 1 2 h in 1 s fdn similarly 32 j 1 n q ij 1 s fdj n q ij 2 s fdj 1 n q in 2 q i 1 1 s fd 1 n q i 1 2 q i 2 1 s fd 2 n q ij 1 2 q ij 1 s fdj n q in 1 2 q in 1 s fdn n let 33 h ij h ij 1 2 h ij 1 j 1 h in 2 h i 1 1 j 1 q ij q ij 1 2 q ij 1 j 1 q in 2 q i 1 1 j 1 substituting eq 33 into eq 30 we have 34 θ i 2 π s fdi m τ j 1 n h ij s fdj j 1 n q ij s fdj n 4 π τ ε 1 m q dw ε ψ m τ 0 for the purpose of conciseness we set 35 a ij θ i 2 π δ ij h ij 36 b ij q ij 37 c i ε 4 π τ ψ m i m ε s 38 q fdj s fdj n and kronecker delta function is defined as 39 δ ij 1 i j 0 i j where q fdj is the flux of jth boundary element representing the gradient of drawdown substituting the eqs 35 39 into the eq 34 yields 40 j 1 n a ij s fdj j 1 n b ij q fdj ε 1 m c i ε q dw ε 0 eq 40 can also be written as in a matrix form 41 a s fd b q fd c q dw 0 where a and b are both n n matrix c is a n m matrix s fd and q fd are n element vectors and 0 is a n element zero vector and q dw is m element vector they can be explicitly written as a a 11 a 12 a 1 n a 21 a 22 a 2 n a n 1 a n 2 a nn s fd s fd 1 s fd 2 s fdn b b 11 b 12 b 1 n b 21 b 22 b 2 n b n 1 b n 2 b nn q fd q fd 1 q fd 2 q fdn c c 11 c 12 c 1 m c 21 c 22 c 2 m c n 1 c n 2 c nm q dw q fdw 1 q fdw 2 q fdwm eq 41 with green function in eq 19 is a general form of linear equation in finite double porosity confined aquifer with irregularly shaped boundary 2 4 drawdown solution under different boundary conditions with irregularly shaped boundary 2 4 1 solution for constant rate test at a robin boundary condition the reason to use the robin type boundary is that robin boundary condition is a linear combination of dirichlet and neumann conditions fig 1 shows a double porosity aquifer with irregular shaped boundaries to ensure the targeted aquifer domain is always on the left when an observer is walking along the boundary the boundary γ is in the counterclockwise direction the boundary γ has n nodes according to eq 41 boundary elements equations on γ can be expressed as 42 a s fd b q fd c q dw 0 for the constant rate conditions q 1 dw known in m well locations of ω 1 eq 42 can be expressed as 43 a s fd b q fd c q dw with robin type outer boundary condition in eq 11 we have 44 α 1 s fd β 1 q fd γ 1 τ eqs 43 44 constitute the linear equations of the system where a b are n n matrix α 1 is n n diagonal matrix of element α 1 and β 1 is n n diagonal matrix of element c is n m matrix s fd q fd are n vector q dw is m vector combining eqs 43 and 44 yields the following matrix equation 45 a b α 1 β 1 s fd q fd c 1 q dw γ 1 τ there are n n unknowns and n n equations in eq 45 which can be solved by using gauss elimination method by solving matrix eq 45 unknown drawdown and flux at the interface are obtained substituting flux and drawdown at the boundaries into eq 24 the drawdown solution with robin conditions in irregularly shaped double porosity aquifers can be obtained and the flow in real time domain can be computed by using stehfest 1970 inversion algorithm 2 4 2 solution for constant rate test at a mixed boundary condition the mixed boundary can appear for a pumping well near a meandering stream therefore it is possible that half of the boundary is constant head and the other half is constant flux or zero flow rate fig 1 b shows the plan view of an irregularly shaped aquifer with discretized boundaries γ γ a γ b for constant rate conditions the pumping wells are operated at specified flow rate q dw given that the flux on the cross section γ a of the aquifer boundary containing n a boundary element is prescribed as q fd a q fd known whereas the rest section γ b containing n b boundary element is maintained at the drawdown s fd b s fd known such that γ a γ b γ γ a γ b and n a n b n where n is the total number of aquifer boundary elements then the unknown boundary drawdown s fd a and flow rate q fd b at sections γ a and γ b of the boundary need to be determined according to eq 41 by taking the prescribed boundary data into account we have 46 a a s fd a b b q fd b a b s fd known b a q fd known c q dw or in matrix form 47 a a b b s fd a q fd b a b b a c s fd known q fd known q dw where 48 a a a 11 a 12 a 1 n a a 21 a 22 a 2 n a a n 1 a n 2 a nn a b b b 1 n a 1 b 1 n a 2 b 1 n a n b b 2 n a 1 b 2 n a 2 b 2 n a n b b n n a 1 b n n a 2 b n n a n b 49 a b a 1 n a 1 a 1 n a 2 a 1 n a n b a 2 n a 1 a 2 n a 2 a 2 n a n b a n n a 1 a n n a 2 a n n a n b b a b 11 b 12 b 1 n a b 21 b 22 b 2 n a b n 1 b n 2 b nn a there are n unknowns and nequations in eq 47 which can be solved by using gauss elimination method by solving matrix eq 47 unknown drawdown and flux at the interface are obtained once the drawdown and flux are obtained substituting flux and drawdown at the boundaries into eq 24 the drawdown solution with mixed conditions in irregularly shaped double porosity aquifers can be obtained and the flow in real time domain can be computed by using stehfest 1970 inversion algorithm we propose to use stehfest 1970 algorithm to numerically calculate the inverse laplace transform for two reasons first stehfest 1970 algorithm is a simple algorithm that can be easily programmed second this algorithm has been found to be sufficiently robust and accurate in groundwater flow problems moench 1995 zhan and zlotnik 2002 the review and application of this algorithm can be found in many literatures zhan et al 2009a b kuhlman 2013 therefore stehfest inverse laplace transform algorithm is also adopted in this study and the number of terms n used is 8 3 results and discussion in this section we analyze the effects of some important aquifer parameters on drawdown curves using the presented bem model which includes irregularly shaped boundary well location double porosity parameters inter porosity flow coefficient and fracture storage coefficient a mixed boundary condition as presented in section 2 4b and interference between multiple wells 3 1 validation of the presented bem model the major advantage of the boundary element method is that it can handle arbitrarily shaped boundaries by using solutions with analytical characteristics most of the previous solutions assume that boundaries of aquifer are circular rectangular or infinitely large muskat 1946 neuman 1972 1974 chu and grader 1991 1999 zhan et al 2001 yang and yeh 2002 yeh et al 2003 pasandi et al 2008 their solutions are widely used to analyze the results of pumping test in groundwater aquifers however in real hydrogeological conditions the boundary is not with such an ideal shape therefore we are presenting a new bem solution in double porosity aquifers with natural fractures to extend the application in this section to validate the presented bem we select a previous analytical solution with no flow boundary in a single porosity aquifer wang 2006 fig 3 shows the validation results of our solution by comparing our solutions with the analytical solutions developed in wang 2006 for the comparative purpose the boundary is set to be circular in the bem solution the radius of the circle is 28 18 that the ω value is set to be 1 to represent the homogeneous condition it can be found that the dimensionless drawdown curves obtained by our solution agree very well with the previous analytical solution which validates the accuracy of the present bem solution in addition to investigate the effect of boundary shape on dimensionless drawdown we compare the drawdown curves of irregularly shaped boundary with those of circularly shaped boundary perimeters for circular and irregularly shaped boundaries are both 176 97 fig 3 shows that the dimensionless drawdown curves tend to overlap with each other under the circular irregular shaped boundaries when td 100 after t d 100 when the pressure depression cone reaches to the boundary the drawdown curve starts deviating from the one with circular boundary and the drawdown curve with irregular boundary is the higher than that with the circular boundary this result indicates that the drawdown curve can be affected by the boundary shape profoundly in the stage of pseudo steady state 3 2 comparison with the finite element solution using presented bem model fig 4 shows the comparison results between finite element solution and presented bem solution the finite element solution is obtained using commercial software comsol the pde module is used to obtain high resolution solutions and the eqs 5 8 are inputted into the pde module triangular meshes are used in the software and the number of grids is 1184 multi frontal massively parallel sparse direct solver is used to solve the equations and memory allocation factor is set to 1 2 within our simulation fig 4 a shows the effect of number of boundary elements on computational accuracy in circular aquifers and the corresponding comparison results with a finite element solution the dimensionless radius of outer boundary red is set to 10 and 30 respectively a closed boundary with no flux for α1 0 β1 1 γ1 0 is used within the simulation inter porosity flow coefficient is set to 0 01 the coordinate of well location is 0 0 the fracture storage coefficient is set to 1 number of nodes n for bem model is set to 4 10 and 20 respectively as shown in fig 4 a as the number of nodes increases the result of the boundary element solution is getting closer and closer to the finite element results when the number of nodes is 10 the error is very small when the number of nodes is 20 the two solutions almost coincide therefore the number of 20 nodes is used in the simulation of this study the number of nodes is far less than the number of finite element meshes although the analytical solution presented in section 3 1 can be used to validate the presented solution for the case of circular boundary it cannot be used to validate the presented solution for the case of irregular boundary however a high resolution solution can be formed by the finite element method to validate bem solution with irregularly shaped boundary fig 4 b shows comparison between a finite element solution and presented bem solution the node coordinates used to form the irregularly shaped boundary are listed in table 1 the 20 nodes are used in the bem simulation inter porosity flow coefficient is set to 0 01 the coordinate of well location is 0 0 the fracture storage coefficient is set to 1 it can be found that the dimensionless drawdown curve obtained by our solutions agrees very well with that finite element solution which validates the accuracy of the present bem solution 3 3 the effect of double porosity parameters on dimensionless drawdown the double porosity parameters are very important factors describing the flow behavior between the fissures and matrix mainly including inter porosity coefficient λ and storage coefficient ω according to the definition of the fracture storage coefficient in the above dimensionless definitions ω is positively proportional to fracture storage coefficient of aquifers but is negatively proportional to the total storage coefficient of aquifers matrix fractures therefore ω reflects storage ability of the fluids in the natural fractures fig 5 a shows that the effect of fracture storage coefficient on dimensionless drawdown with irregularly shaped boundary in double porosity aquifers and it is a closed boundary with no flux for α 1 0 β 1 1 γ 1 0 perimeter for the irregularly shaped boundary is 176 97 and inter porosity flow coefficient is set to 0 001 the coordinate of well location is 0 0 the different fracture storage coefficients are set to 0 01 0 1 and 1 respectively as shown in the figure the effect of fracture storage coefficient on dimensionless drawdown could be divided into two stages in the early and middle time when t d 1000 the smaller the fracture storage is the larger the drawdown value after td 1000 the larger the fracture storage is the larger the drawdown value however the drawdown affected by fracture storage coefficient is not obvious in the large time when considering double porosity characteristics of aquifers e g ω 0 01 and 0 1 the derivative curves in fig 5a show when td 10 the curve becomes v shaped with the increase of storage coefficient the v shaped curve gradually disappeared according to the definition of inter porosity flow coefficient in the above dimensionless definitions inter porosity flow coefficient λ is positively proportional to hydraulic conductivity of matrix and but is negatively proportional to hydraulic conductivity of fracture therefore a larger λ reflect stronger flow exchange from matrix to fractures fig 5 b shows that the effect of inter porosity flow coefficient on dimensionless drawdown with irregularly shaped boundary in double porosity aquifers and it is also a closed boundary with no flux for α 1 0 β 1 1 γ 1 0 perimeter for the irregularly shaped boundary is 176 97 and the fracture storage coefficient is set to 0 01 the coordinate of well location is 0 0 the different inter porosity flow coefficients are set to 0 0001 0 0005 and 0 001 respectively as shown in the figure the dimensionless drawdown curves tend to overlap with each other under the circular irregular shaped boundaries when td 10 after td 10 it can be found that a smaller λ value leads to larger head depletion this is attributed to the fact that a smaller λ value means weaker flow ability from matrix to fractures so that matrix cannot supply enough fluids into the natural fractures to reduce the head depletion the variation of the derivative curve is very significant the time for the appearance of the v curve has increased and the derivative curve becomes higher as inter porosity flow coefficient is reduced the v shaped curve represents the supplement from matrix to fissures 3 4 the effect of different boundary conditions on dimensionless drawdown hydrogeological conditions can lead to different boundary conditions although kuhlman et al 2015 have presented a double porosity model with different boundary conditions but it is limited to a circular domain concentric with the constant flux or constant head pumping well under certain hydrogeological conditions the boundary conditions could be constant flux constant head or a mixed condition between constant flux and constant head fig 6 shows that the effect of different boundary conditions on dimensionless drawdown with irregularly shaped boundary in double porosity aquifers and it could be a zero flux boundary for α 1 0 β 1 1 γ 1 0 a zero drawdown outer boundary for α 1 1 β 1 0 γ 1 0 or a mixed two boundary conditions as show in fig 1 b perimeter for the irregularly shaped boundary is 176 97 the fracture storage coefficient is set to 0 01 and inter porosity flow coefficient is set to 0 001 the coordinate of well location is 0 0 as shown in fig 6 the dimensionless drawdown curves tend to overlap with each other under all boundary conditions when td 1 after td 1 the drawdown is the highest with zero flux outer boundary and is the lowest with zero drawdown outer boundary due to the recharge across the constant head outer boundary the drawdown with a mixed boundary condition is lower than that with zero flux outer boundary however due to the influence of zero flux in the half boundary drawdown with a mixed outer boundary condition is higher than that with zero drawdown outer boundary in the late time when td 500 wellbore drawdown can be seriously influenced by zero flux outer boundary the v shaped derivative curve is the widest and longest for zero drawdown outer boundary in the late time the curve for zero flux outer boundary continues to rise and the curves for zero drawdown and mixed outer boundary will go down rapidly 3 5 the effect of well location and multiple wells interference on dimensionless drawdown fig 7 a shows that the effect of well location on dimensionless drawdown with irregularly shaped boundary in double porosity aquifers a mixed boundary condition is given where a zero flux boundary on the curve γa for α 1 0 β 1 1 γ 1 0 and a zero drawdown boundary on the curve γb for α 1 1 β 1 0 γ 1 0 perimeter for the irregularly shaped boundary is 176 97 the fracture storage coefficient is set to 0 01 and inter porosity flow coefficient is set to 0 001 different well locations at the coordinates are set to 0 0 8 8 and 8 8 respectively fig 7 a shows that the dimensionless drawdown curves tend to overlap under the different well locations when t d 1 when t d 1 the drawdown curve for well location 8 8 near the zero flux boundary is the highest and the curve for well location 8 8 near the zero drawdown boundary is the lowest this result demonstrates that the closer the well position is to the zero flux boundary the higher the drawdown is in contrast the closer the well position is to the zero drawdown boundary the lower the drawdown is the drawdown can be seriously affected by the well locations hence it may be necessary to be taken into account in pumping tests in a finite confined aquifer all derivatives for different well locations show v shaped curve which represents the supplement from matrix to fissures when the well is near the zero drawdown boundary the derivative curve is the lowest when the well is near the zero flux boundary the derivative curve is the highest fig 7 b shows that the effect of well interference on dimensionless drawdown with irregularly shaped boundary in double porosity aquifers similarly a mixed boundary condition is given where a zero flux boundary on the curve γa for α 1 0 β 1 1 γ 1 0 and a zero drawdown boundary on the curve γb for α 1 1 β 1 0 γ 1 0 perimeter for the irregularly shaped boundary is still 176 97 the fracture storage coefficient is set to 0 01 and inter porosity flow coefficient is set to 0 001 the observation well w1 is located at the coordinate 0 0 the interference well w2 is located at the coordinate 8 8 and the interference well w3 is located at the coordinate 8 8 the drawdown curve is obtained from the observation well w1 as shown in the figure the drawdown is the lowest when one well w1 is pumping in the double porosity aquifer and the drawdown is the highest when three wells w1 w2 w3 are pumping at the same time in the double porosity aquifers the boundary effect is not obvious in this case therefore well interference is also considered as an important factor during the process of pumping tests all derivatives for different well number show v shaped curve which represents the supplement from matrix to fissures when there is a single well located at the aquifers the derivative curve is the lowest as the well number increases the derivative value will increases in the late time all the derivative curves for different well number will go down rapidly 3 6 advantages of the presented bem model in numerical methods such as finite element method numerical grid to characterize the aquifer is required to be established in the first step sufficiently large grid size is usually required to reduce the truncation error and enhance the simulation accuracy huge grid numbers may cause heavy computational burden which may require large computer memory and storage space in some cases when dealing with complex problems if the boundary shape changes the numerical mesh also needs to be changed accordingly for each update which may result in even more computational burden and may make the numerical simulation infeasible to perform unlike finite element method the laplace transform bem eliminates the truncation error and has the same order of accuracy as the analytical method if the property variation is not considered the laplace transform bem does not require discretization both in spatial and temporal dimensions to obtain the solution to describe the transient flow behavior in the aquifer in addition since numerical approximation is only required on the boundaries it greatly reduces computational burden it is very convenient to update when the shape of the boundary is changed one limitation that restrict the wide application of this method is that the green function must exist for a specified problem for the problem stated here it is suitable to analyze the pumping test results by using the laplace transform boundary element method 4 conclusions this work presents a novel laplace transform bem model for pumping tests in double porosity aquifers with natural fractures by using the boundary element theory and green function method the presented model allows one to consider irregularly shaped boundaries under zero flux zero draw or mixed boundary conditions using gauss elimination method the final boundary elements matrix can be solved free space green s function and its derivative in double porosity aquifers are used to form the general solution the following conclusions can be drawn 1 the present solution in a simplified form has been validated by comparing it with an analytical solution with the circular boundaries in a single porosity confined aquifer under a zero flux boundary condition 2 the result implies that the drawdown curve with double porosity behavior can be affected by the boundary shape mainly during the stage of pseudo steady state 3 the drawdown affected by fracture storage coefficient is not obvious in the large time when considering double porosity characteristics of aquifers it can be found that a smaller inter porosity flow coefficient leads to larger head depletion in middle and late time 4 due to the recharge across constant head outer boundary the drawdown with a mixed boundary condition is lower than that with zero flux outer boundary however due to the influence of zero flux in the half boundary drawdown with a mixed outer boundary condition is higher than that with zero drawdown outer boundary 5 the drawdown in double porosity aquifers can be seriously affected by the well locations and multiple wells interference hence it may be necessary to be taken into account in pumping tests in a finite double porosity aquifer with natural fractures acknowledgements this work is funded by china postdoctoral science foundation grant no 2017m620527 the science foundation of china university of petroleum beijing grant no 2462014yjrc038 and national science and technology major project grant no 2016zx05037003 and 2017zx05032004 002 we declare that we have no conflict of interest appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j jhydrol 2018 06 027 appendix a supplementary data supplementary data 1 
6915,in this paper a novel laplace transform boundary element model for pumping tests in irregularly shaped double porosity aquifers is presented the aquifer could be associated with various boundary conditions such as the general robin boundary conditions or even the mixed boundary conditions with no flow boundary on one side and constant head boundary on the other side the derived solution has analytical characteristics since it is obtained through the green s function method within the domain unlike traditional numerical methods the proposed solution using the laplace transform boundary element method does not require discretization in spatial and temporal dimensions in this study boundary integral equation using green s second theorem and the fundamental solution of green function for dual porosity models are given a boundary element matrix in laplace space is established which allow us to consider irregularly shaped boundary the drawdown and flux on the boundary can be obtained through solving the boundary element matrix by gauss s elimination method the final solution for wellbore drawdown is evaluated using numerical laplace inversion algorithm of stehfest 1970 many previous solutions for transient flow in finite single porosity aquifers with no flow outer boundary condition are shown to be special cases of the present solution furthermore the solution with a mixed outer boundary condition is used to investigate the effect of important parameters of aquifers on wellbore drawdown including fracture storage coefficient inter porosity flow coefficient from matrix to fissures boundary shape boundary location and interference of multiple wells keywords double porosity medium boundary element irregularly shaped boundary wellbore drawdown green s function 1 introduction the concept of dual porosity was proposed by barenblatt et al 1960 there are two methods to describe inter porosity flow behavior between the fissures and the matrix one is based on the assumption of pseudo steady state flow warren and root 1963 and the other approach is based on the assumption of transient flow kazemi 1969 boulton and streltsova 1977 double porosity models has been studied by scholars for several decades in both groundwater and petroleum literatures warren and root 1963 kazemi 1969 gringarten and ramey 1973 boulton and streltsova 1977 bourdet and gringarten 1980 moench 1984 hamm and bidaux 1996 lods and gouze 2004 slimani and tiab 2008 biryukov and kuchuk 2012 jia et al 2013 kuhlman et al 2015 warren and root 1963 presented a laplace transform drawdown solution for pumping tests kazemi 1969 presented a numerical solution considering parallel matrix slabs using finite difference technique bourdet and gringarten 1980 and moench 1984 developed a dual porosity model considering wellbore storage and skin factor hamm and bidaux 1996 also proposed dual porosity models with fractal geometry and the analytical solutions are obtained using laplace transform method lods and gouze 2004 presented the software for well test analysis in fractured media slimani and tiab 2008 biryukov and kuchuk 2012 and jia et al 2013 presented different analytical models with warren and root double porosity mechanism recently kuhlman et al 2015 showed the effects of different boundary conditions at the outer edge of the domain for a double porosity problem in addition the effect of outer boundary on groundwater flow cannot be ignored in the literatures of groundwater researches most of them does not take account of the effect of the boundary shape by assuming the aquifer is associated with infinite extent or just consider the simple regular boundary shape such as circular shaped boundary muskat 1946 neuman 1972 1974 zhan et al 2001 yang and yeh 2002 muskat 1946 presented various analytical solutions in finite aquifers with circular shaped boundary under different outer boundary conditions such as a constant head boundary condition neuman 1972 1974 presented new mathematical models in unconfined aquifers considering delayed response of the water table and delayed gravity response respectively zhan et al 2001 presented a direct method to solve the boundary problem of flow to a horizontal well in anisotropic confined aquifers and derived a closed form analytical solution yang and yeh 2002 provided an analytical solution of the wellbore flow rate for the constant head test performed in an infinite extent aquifer some authors have also obtained analytical and semi analytical solutions in two zone or three zone radial confined aquifers with finite extent chu and grader 1991 1999 yeh et al 2003 pasandi et al 2008 wang et al 2012 lin et al 2016 although these scholars have tried to consider the influence of outer boundary on the wellbore drawdown and flow rate they have not considered the effect of the irregular boundary shape by using conventional analytical methods in the real world the boundary shape of an aquifer cannot be strictly circular or rectangular kuo et al 1994 utilized the image well method to predict the drawdown distribution in aquifers with irregularly shaped boundaries huang and yeh 2016 presented an analytical approach to estimate drawdown induced by well extraction in a heterogeneous confined aquifer with an irregular outer boundary the transient solution of a heterogeneous confined aquifer was also approximately obtained by using image well method recently wang et al 2018 presented a semi analytical model for pumping tests in finite heterogeneous confined aquifers with arbitrarily shaped boundary using boundary element method however this model can only be used in a conventional porous medium this solution cannot be applied when the natural fractures exists in the porous media the objective of this paper is to present a novel laplace transform boundary element model to quantify the transient behavior of hydraulic head in naturally fractured aquifers with double porosity characteristics three features in this proposed method have made it different from the previous ones first a double porosity governing equation for drawdown has been established to take account of the natural fractures second both boundary integral equation and the fundamental solution of green function for double porosity model has been provided third the boundary condition can be dirichlet neumann or robin type in this research a general boundary element matrix is established in laplace space which allow us to consider complex boundary shape the drawdown and flux on the boundary can be obtained through solving the boundary element matrix the final solution for wellbore drawdown is evaluated using the well known numerical laplace inversion algorithm of stehfest 1970 2 methodology 2 1 mathematical model we assume a horizontal isotropic double porosity finite confined aquifer with a uniform thickness multiple pumping wells and an irregularly shaped boundary the water flows into the pumping wells only through the natural fractures with a constant rate q and the pumping well fully penetrates the aquifer the flow domain is two dimensional and the pumping well has a finite radius r w by using the double porosity concept the flow in fractured porous media can be described by the following equations warren and root 1963 moench 1984 1 1 k f h f α k m h m h f ε 1 m q w ε b δ x x w ε δ y y w ε s sf h f t ω 1 2 α k m h f h m s sm h m t ω where the operator x y δ is dirac delta function and a one dimensional dirac delta function is defined by eqs 1 2 and 1 3 1 3 δ x x w ε 0 x x w ε x x w ε δ y y w ε 0 y y w ε y y w ε where h is the hydraulic head l k is the hydraulic conductivity lt 1 s sf and s sm is the specific storage capacity in the fractures and matrix l 1 α is the shape factor with dimensions of inverse area l 2 t is the time t m is well number b is aquifer thickness l x w y w is the well location x y is the coordinate of any point q w is pumping rate per unit of volume l3t 1 the superscript f represents fracture and m represents matrix the flow equations can be recast in a form more suitable for analysis of a pumping test when it is assumed that the well fully penetrates the aquifer and the aquifer is initially with a constant hydraulic head h 0 l in the fractures and matrix with a uniform thickness b l according to eq 1 the drawdown equation in the fissures and matrix can be expressed as 2 1 t s f i 1 m q wi δ x x wi δ y y wi s f s f t s m s m t ω 2 2 α bk m s f s m s m s m t ω where s f h 0 h f is drawdown in the fissures l s m h 0 h m drawdown in the rock matrix l s f s sf b overall aquifer storage coefficient of the fissures s m s sm b overall aquifer storage coefficient of the rock matrix t k f b overall aquifer transmissivity l2t 1 the drawdown for both fissures and matrix before pumping could be considered as zero and the initial condition can be given as 3 s f x y 0 s m x y 0 0 the outer condition at irregularly shaped boundary γ could be specified as robin type lin et al 2016 4 σ 1 s f σ 2 s f n σ 3 at γ where σ 1 σ 2 σ 3 are coefficients of robin type condition the reason to use the robin type boundary is that robin boundary condition is a linear combination of dirichlet and neumann conditions in eq 4 if σ 2 0 the robin condition can reduce to dirichlet condition and if σ 1 0 the robin condition can reduce to neumann condition in some cases the boundary is permeable with a weak recharge phenomenon where robin condition can be suitable to be applied to facilitate the expression of solution the following dimensionless definitions are used s fd 4 π ts f q r s md 4 π ts m q r x d x r w y d y r w x dwi x wi r w y dwi y wi r w t d tt s f s m r w 2 q dwi q wi q r ω s f s f s m λ α k m k f r w 2 where the subscript d represents a dimensionless symbol and q r represents reference flow rate l3t 1 sfd is dimensionless drawdown of fissures and smd is dimensionless drawdown of matrix xd yd is the dimensionless coordinate of any point xdwi ydwi is the dimensionless coordinate of ith well td is dimensionless time qdwi is dimensionless wellbore flow rate of ith well ω is fracture storage coefficient λ is inter porosity flow coefficient from matrix to fissures according to the definition of the above dimensionless variables dimensionless drawdown and boundary conditions in fractures and matrix can be expressed as 5 2 s fd ε 1 m 4 π q dw ε δ x d x dw ε δ y d y dw ε ω s fd t d 1 ω s md t d ω 6 λ s fd s md 1 ω s md t ω initial condition of eq 3 becomes 7 s fd x y 0 s md x y 0 0 out boundary condition becomes 8 α 1 s fd β 1 s fd n γ 1 at γ where α 1 σ 1 β 1 σ 2 r w and γ 1 4 π t σ 3 q r these equations from eqs 5 8 constitute the fundamental equations in double porosity aquifers 2 2 boundary integral equation take laplace transform to eqs 5 8 with respect to t d we can obtain the following system of equations 9 2 s fd τ f τ s fd ε 1 m 4 π q dw ε τ δ x d x dw ε δ y d y dw ε ω 10 s md λ 1 ω τ λ s fd ω where τ is the laplace transform parameter in respect to dimensionless time s md is dimensionless drawdown of matrix in laplace domain and s fd is dimensionless drawdown of fissures f τ is defined as 11 f τ 1 ω ω τ λ 1 ω τ λ outer boundary condition of eq 8 becomes 12 α 1 s fd β 1 s fd n γ 1 τ at γ note when ω 1 f τ 1 then eqs 7 and 12 become the flow problems in irregularly shaped homogenous aquifers and eq 9 in the text can be rewritten in a compact form as 13 ψ s fd ε 1 m 4 π q dw ε τ δ x d x dw ε δ y d y dw ε ω where 14 ψ 2 τ f τ 2 x d 2 2 y d 2 τ f τ is called as modified helmholtz operator in order to transform the solution in the domain ω to the boundary γ and obtain the boundary integral equation we also need to establish the auxiliary equation of green s function for eq 9 and the free space green function g for operator ψ satisfies the following equation 15 ψ g δ x d x dw ε δ y d y dw ε ω where g x d y d x d y d τ is green s function in the laplace space it is defined as the drawdown at x d y d due to a source of unit strength at coordinates x d y d according to green s secondary identity it gives 16 ω s fd ψ g g ψ s fd d ω γ s fd g n g s fd n d γ the domain integration problem can be translated into the boundary integration problem liggett and liu 1979 now substituting eq 16 into eqs 13 and 15 we can have 17 s fd m τ 4 π τ ε 1 m q dw ε ψ m τ γ g s fd n s fd g n d γ where 18 ψ m τ ω g m m τ d ω m x d y d m x d y d the two dimensional free space green s function with double porosity in the laplace domain could be given through solving the eq 15 19 g 1 2 π k 0 r d 1 ω ω τ λ 1 ω τ λ τ and 20 r d x d x d 2 y d y d 2 where k 0 is zero order bessel function rd represents the distance from the source point to the point the detailed derivation has been presented in appendix a of supplementary file 2 3 discretization and implementation into linear segments eq 17 can be solved for the unknown boundary condition by choosing finite number of node points mj j 1 2 3 n on the γ as shown in fig 1 a linear interpolating function for laplace space drawdown and flux normal derivative of drawdown on a boundary element is used to establish matrix now we need to discretize the aquifer boundaries into linear segments j 1 2 3 n as shown in fig 1 for this discretized aquifer eq 17 becomes see fig 2 21 s fd m τ 4 π τ ε 1 m q dw ε ψ m τ j 1 n γ j g s fd n s fd g n d γ over a small element γ j between a pair of node points mj and mj 1 the laplace space drawdown and its normal derivatives are expressed as 22 s fd n 1 ξ s fdj n 2 ξ s fdj 1 1 ξ 1 23 s fd n n 1 ξ s fdj n n 2 ξ s fdj 1 n 1 ξ 1 where n 1 ξ and n 2 ξ are called as interpolating functions the definition of these functions can be in appendix b of supplementary file now substituting eqs 22 and 23 into eq 21 we have 24 θ i 2 π s fdi m τ 4 π τ ε 1 m q dw ε ψ m τ j 1 n s fdj n γ j n 1 ξ g d γ j 1 n s fdj 1 n γ j n 2 ξ g d γ j 1 n s fdj γ j n 1 ξ g n d γ j 1 n s fdj 1 γ j n 2 ξ g n d γ where θ i is internal angle between two boundary elements at the boundary elements nodes θ i π due to linear segment liggett and liu 1979 at any interior of the aquifer domain θ 2 π as shown in fig 1 a the boundary is associated with a counter clockwise direction so that the targeted domain is always on the left when an observer is walking along the boundary let 25 h ij 1 γ j n 1 ξ g n d γ 26 h ij 2 γ j n 2 ξ g n d γ 27 q ij 1 γ j n 1 ξ g d γ 28 q ij 2 γ j n 2 ξ g d γ the evaluation of boundary integrals in eqs 25 28 can be found in the appendix b of supplementary file substituting eqs 25 28 into eq 24 we have 29 θ i 2 π s fdi m τ 4 π τ ε 1 m q dw ε ψ m τ j 1 n q ij 1 s fdj n j 1 n q ij 2 s fdj 1 n j 1 n h ij 1 s fdj j 1 n h ij 2 s fdj 1 rearrange eq 29 we can have 30 θ i 2 π s fdi m τ j 1 n h ij 1 s fdj j 1 n h ij 2 s fdj 1 j 1 n q ij 1 s fdj n j 1 n q ij 2 s fdj 1 n 4 π τ ε 1 m q dw ε ψ m τ 0 the expansion of the second and third terms on the left of the eq 30 gives 31 j 1 n h ij 1 s fdj h ij 2 s fdj 1 h in 2 h i 1 1 s fd 1 h i 1 2 h i 2 1 s fd 2 h ij 1 2 h ij 1 s fdj h in 1 2 h in 1 s fdn similarly 32 j 1 n q ij 1 s fdj n q ij 2 s fdj 1 n q in 2 q i 1 1 s fd 1 n q i 1 2 q i 2 1 s fd 2 n q ij 1 2 q ij 1 s fdj n q in 1 2 q in 1 s fdn n let 33 h ij h ij 1 2 h ij 1 j 1 h in 2 h i 1 1 j 1 q ij q ij 1 2 q ij 1 j 1 q in 2 q i 1 1 j 1 substituting eq 33 into eq 30 we have 34 θ i 2 π s fdi m τ j 1 n h ij s fdj j 1 n q ij s fdj n 4 π τ ε 1 m q dw ε ψ m τ 0 for the purpose of conciseness we set 35 a ij θ i 2 π δ ij h ij 36 b ij q ij 37 c i ε 4 π τ ψ m i m ε s 38 q fdj s fdj n and kronecker delta function is defined as 39 δ ij 1 i j 0 i j where q fdj is the flux of jth boundary element representing the gradient of drawdown substituting the eqs 35 39 into the eq 34 yields 40 j 1 n a ij s fdj j 1 n b ij q fdj ε 1 m c i ε q dw ε 0 eq 40 can also be written as in a matrix form 41 a s fd b q fd c q dw 0 where a and b are both n n matrix c is a n m matrix s fd and q fd are n element vectors and 0 is a n element zero vector and q dw is m element vector they can be explicitly written as a a 11 a 12 a 1 n a 21 a 22 a 2 n a n 1 a n 2 a nn s fd s fd 1 s fd 2 s fdn b b 11 b 12 b 1 n b 21 b 22 b 2 n b n 1 b n 2 b nn q fd q fd 1 q fd 2 q fdn c c 11 c 12 c 1 m c 21 c 22 c 2 m c n 1 c n 2 c nm q dw q fdw 1 q fdw 2 q fdwm eq 41 with green function in eq 19 is a general form of linear equation in finite double porosity confined aquifer with irregularly shaped boundary 2 4 drawdown solution under different boundary conditions with irregularly shaped boundary 2 4 1 solution for constant rate test at a robin boundary condition the reason to use the robin type boundary is that robin boundary condition is a linear combination of dirichlet and neumann conditions fig 1 shows a double porosity aquifer with irregular shaped boundaries to ensure the targeted aquifer domain is always on the left when an observer is walking along the boundary the boundary γ is in the counterclockwise direction the boundary γ has n nodes according to eq 41 boundary elements equations on γ can be expressed as 42 a s fd b q fd c q dw 0 for the constant rate conditions q 1 dw known in m well locations of ω 1 eq 42 can be expressed as 43 a s fd b q fd c q dw with robin type outer boundary condition in eq 11 we have 44 α 1 s fd β 1 q fd γ 1 τ eqs 43 44 constitute the linear equations of the system where a b are n n matrix α 1 is n n diagonal matrix of element α 1 and β 1 is n n diagonal matrix of element c is n m matrix s fd q fd are n vector q dw is m vector combining eqs 43 and 44 yields the following matrix equation 45 a b α 1 β 1 s fd q fd c 1 q dw γ 1 τ there are n n unknowns and n n equations in eq 45 which can be solved by using gauss elimination method by solving matrix eq 45 unknown drawdown and flux at the interface are obtained substituting flux and drawdown at the boundaries into eq 24 the drawdown solution with robin conditions in irregularly shaped double porosity aquifers can be obtained and the flow in real time domain can be computed by using stehfest 1970 inversion algorithm 2 4 2 solution for constant rate test at a mixed boundary condition the mixed boundary can appear for a pumping well near a meandering stream therefore it is possible that half of the boundary is constant head and the other half is constant flux or zero flow rate fig 1 b shows the plan view of an irregularly shaped aquifer with discretized boundaries γ γ a γ b for constant rate conditions the pumping wells are operated at specified flow rate q dw given that the flux on the cross section γ a of the aquifer boundary containing n a boundary element is prescribed as q fd a q fd known whereas the rest section γ b containing n b boundary element is maintained at the drawdown s fd b s fd known such that γ a γ b γ γ a γ b and n a n b n where n is the total number of aquifer boundary elements then the unknown boundary drawdown s fd a and flow rate q fd b at sections γ a and γ b of the boundary need to be determined according to eq 41 by taking the prescribed boundary data into account we have 46 a a s fd a b b q fd b a b s fd known b a q fd known c q dw or in matrix form 47 a a b b s fd a q fd b a b b a c s fd known q fd known q dw where 48 a a a 11 a 12 a 1 n a a 21 a 22 a 2 n a a n 1 a n 2 a nn a b b b 1 n a 1 b 1 n a 2 b 1 n a n b b 2 n a 1 b 2 n a 2 b 2 n a n b b n n a 1 b n n a 2 b n n a n b 49 a b a 1 n a 1 a 1 n a 2 a 1 n a n b a 2 n a 1 a 2 n a 2 a 2 n a n b a n n a 1 a n n a 2 a n n a n b b a b 11 b 12 b 1 n a b 21 b 22 b 2 n a b n 1 b n 2 b nn a there are n unknowns and nequations in eq 47 which can be solved by using gauss elimination method by solving matrix eq 47 unknown drawdown and flux at the interface are obtained once the drawdown and flux are obtained substituting flux and drawdown at the boundaries into eq 24 the drawdown solution with mixed conditions in irregularly shaped double porosity aquifers can be obtained and the flow in real time domain can be computed by using stehfest 1970 inversion algorithm we propose to use stehfest 1970 algorithm to numerically calculate the inverse laplace transform for two reasons first stehfest 1970 algorithm is a simple algorithm that can be easily programmed second this algorithm has been found to be sufficiently robust and accurate in groundwater flow problems moench 1995 zhan and zlotnik 2002 the review and application of this algorithm can be found in many literatures zhan et al 2009a b kuhlman 2013 therefore stehfest inverse laplace transform algorithm is also adopted in this study and the number of terms n used is 8 3 results and discussion in this section we analyze the effects of some important aquifer parameters on drawdown curves using the presented bem model which includes irregularly shaped boundary well location double porosity parameters inter porosity flow coefficient and fracture storage coefficient a mixed boundary condition as presented in section 2 4b and interference between multiple wells 3 1 validation of the presented bem model the major advantage of the boundary element method is that it can handle arbitrarily shaped boundaries by using solutions with analytical characteristics most of the previous solutions assume that boundaries of aquifer are circular rectangular or infinitely large muskat 1946 neuman 1972 1974 chu and grader 1991 1999 zhan et al 2001 yang and yeh 2002 yeh et al 2003 pasandi et al 2008 their solutions are widely used to analyze the results of pumping test in groundwater aquifers however in real hydrogeological conditions the boundary is not with such an ideal shape therefore we are presenting a new bem solution in double porosity aquifers with natural fractures to extend the application in this section to validate the presented bem we select a previous analytical solution with no flow boundary in a single porosity aquifer wang 2006 fig 3 shows the validation results of our solution by comparing our solutions with the analytical solutions developed in wang 2006 for the comparative purpose the boundary is set to be circular in the bem solution the radius of the circle is 28 18 that the ω value is set to be 1 to represent the homogeneous condition it can be found that the dimensionless drawdown curves obtained by our solution agree very well with the previous analytical solution which validates the accuracy of the present bem solution in addition to investigate the effect of boundary shape on dimensionless drawdown we compare the drawdown curves of irregularly shaped boundary with those of circularly shaped boundary perimeters for circular and irregularly shaped boundaries are both 176 97 fig 3 shows that the dimensionless drawdown curves tend to overlap with each other under the circular irregular shaped boundaries when td 100 after t d 100 when the pressure depression cone reaches to the boundary the drawdown curve starts deviating from the one with circular boundary and the drawdown curve with irregular boundary is the higher than that with the circular boundary this result indicates that the drawdown curve can be affected by the boundary shape profoundly in the stage of pseudo steady state 3 2 comparison with the finite element solution using presented bem model fig 4 shows the comparison results between finite element solution and presented bem solution the finite element solution is obtained using commercial software comsol the pde module is used to obtain high resolution solutions and the eqs 5 8 are inputted into the pde module triangular meshes are used in the software and the number of grids is 1184 multi frontal massively parallel sparse direct solver is used to solve the equations and memory allocation factor is set to 1 2 within our simulation fig 4 a shows the effect of number of boundary elements on computational accuracy in circular aquifers and the corresponding comparison results with a finite element solution the dimensionless radius of outer boundary red is set to 10 and 30 respectively a closed boundary with no flux for α1 0 β1 1 γ1 0 is used within the simulation inter porosity flow coefficient is set to 0 01 the coordinate of well location is 0 0 the fracture storage coefficient is set to 1 number of nodes n for bem model is set to 4 10 and 20 respectively as shown in fig 4 a as the number of nodes increases the result of the boundary element solution is getting closer and closer to the finite element results when the number of nodes is 10 the error is very small when the number of nodes is 20 the two solutions almost coincide therefore the number of 20 nodes is used in the simulation of this study the number of nodes is far less than the number of finite element meshes although the analytical solution presented in section 3 1 can be used to validate the presented solution for the case of circular boundary it cannot be used to validate the presented solution for the case of irregular boundary however a high resolution solution can be formed by the finite element method to validate bem solution with irregularly shaped boundary fig 4 b shows comparison between a finite element solution and presented bem solution the node coordinates used to form the irregularly shaped boundary are listed in table 1 the 20 nodes are used in the bem simulation inter porosity flow coefficient is set to 0 01 the coordinate of well location is 0 0 the fracture storage coefficient is set to 1 it can be found that the dimensionless drawdown curve obtained by our solutions agrees very well with that finite element solution which validates the accuracy of the present bem solution 3 3 the effect of double porosity parameters on dimensionless drawdown the double porosity parameters are very important factors describing the flow behavior between the fissures and matrix mainly including inter porosity coefficient λ and storage coefficient ω according to the definition of the fracture storage coefficient in the above dimensionless definitions ω is positively proportional to fracture storage coefficient of aquifers but is negatively proportional to the total storage coefficient of aquifers matrix fractures therefore ω reflects storage ability of the fluids in the natural fractures fig 5 a shows that the effect of fracture storage coefficient on dimensionless drawdown with irregularly shaped boundary in double porosity aquifers and it is a closed boundary with no flux for α 1 0 β 1 1 γ 1 0 perimeter for the irregularly shaped boundary is 176 97 and inter porosity flow coefficient is set to 0 001 the coordinate of well location is 0 0 the different fracture storage coefficients are set to 0 01 0 1 and 1 respectively as shown in the figure the effect of fracture storage coefficient on dimensionless drawdown could be divided into two stages in the early and middle time when t d 1000 the smaller the fracture storage is the larger the drawdown value after td 1000 the larger the fracture storage is the larger the drawdown value however the drawdown affected by fracture storage coefficient is not obvious in the large time when considering double porosity characteristics of aquifers e g ω 0 01 and 0 1 the derivative curves in fig 5a show when td 10 the curve becomes v shaped with the increase of storage coefficient the v shaped curve gradually disappeared according to the definition of inter porosity flow coefficient in the above dimensionless definitions inter porosity flow coefficient λ is positively proportional to hydraulic conductivity of matrix and but is negatively proportional to hydraulic conductivity of fracture therefore a larger λ reflect stronger flow exchange from matrix to fractures fig 5 b shows that the effect of inter porosity flow coefficient on dimensionless drawdown with irregularly shaped boundary in double porosity aquifers and it is also a closed boundary with no flux for α 1 0 β 1 1 γ 1 0 perimeter for the irregularly shaped boundary is 176 97 and the fracture storage coefficient is set to 0 01 the coordinate of well location is 0 0 the different inter porosity flow coefficients are set to 0 0001 0 0005 and 0 001 respectively as shown in the figure the dimensionless drawdown curves tend to overlap with each other under the circular irregular shaped boundaries when td 10 after td 10 it can be found that a smaller λ value leads to larger head depletion this is attributed to the fact that a smaller λ value means weaker flow ability from matrix to fractures so that matrix cannot supply enough fluids into the natural fractures to reduce the head depletion the variation of the derivative curve is very significant the time for the appearance of the v curve has increased and the derivative curve becomes higher as inter porosity flow coefficient is reduced the v shaped curve represents the supplement from matrix to fissures 3 4 the effect of different boundary conditions on dimensionless drawdown hydrogeological conditions can lead to different boundary conditions although kuhlman et al 2015 have presented a double porosity model with different boundary conditions but it is limited to a circular domain concentric with the constant flux or constant head pumping well under certain hydrogeological conditions the boundary conditions could be constant flux constant head or a mixed condition between constant flux and constant head fig 6 shows that the effect of different boundary conditions on dimensionless drawdown with irregularly shaped boundary in double porosity aquifers and it could be a zero flux boundary for α 1 0 β 1 1 γ 1 0 a zero drawdown outer boundary for α 1 1 β 1 0 γ 1 0 or a mixed two boundary conditions as show in fig 1 b perimeter for the irregularly shaped boundary is 176 97 the fracture storage coefficient is set to 0 01 and inter porosity flow coefficient is set to 0 001 the coordinate of well location is 0 0 as shown in fig 6 the dimensionless drawdown curves tend to overlap with each other under all boundary conditions when td 1 after td 1 the drawdown is the highest with zero flux outer boundary and is the lowest with zero drawdown outer boundary due to the recharge across the constant head outer boundary the drawdown with a mixed boundary condition is lower than that with zero flux outer boundary however due to the influence of zero flux in the half boundary drawdown with a mixed outer boundary condition is higher than that with zero drawdown outer boundary in the late time when td 500 wellbore drawdown can be seriously influenced by zero flux outer boundary the v shaped derivative curve is the widest and longest for zero drawdown outer boundary in the late time the curve for zero flux outer boundary continues to rise and the curves for zero drawdown and mixed outer boundary will go down rapidly 3 5 the effect of well location and multiple wells interference on dimensionless drawdown fig 7 a shows that the effect of well location on dimensionless drawdown with irregularly shaped boundary in double porosity aquifers a mixed boundary condition is given where a zero flux boundary on the curve γa for α 1 0 β 1 1 γ 1 0 and a zero drawdown boundary on the curve γb for α 1 1 β 1 0 γ 1 0 perimeter for the irregularly shaped boundary is 176 97 the fracture storage coefficient is set to 0 01 and inter porosity flow coefficient is set to 0 001 different well locations at the coordinates are set to 0 0 8 8 and 8 8 respectively fig 7 a shows that the dimensionless drawdown curves tend to overlap under the different well locations when t d 1 when t d 1 the drawdown curve for well location 8 8 near the zero flux boundary is the highest and the curve for well location 8 8 near the zero drawdown boundary is the lowest this result demonstrates that the closer the well position is to the zero flux boundary the higher the drawdown is in contrast the closer the well position is to the zero drawdown boundary the lower the drawdown is the drawdown can be seriously affected by the well locations hence it may be necessary to be taken into account in pumping tests in a finite confined aquifer all derivatives for different well locations show v shaped curve which represents the supplement from matrix to fissures when the well is near the zero drawdown boundary the derivative curve is the lowest when the well is near the zero flux boundary the derivative curve is the highest fig 7 b shows that the effect of well interference on dimensionless drawdown with irregularly shaped boundary in double porosity aquifers similarly a mixed boundary condition is given where a zero flux boundary on the curve γa for α 1 0 β 1 1 γ 1 0 and a zero drawdown boundary on the curve γb for α 1 1 β 1 0 γ 1 0 perimeter for the irregularly shaped boundary is still 176 97 the fracture storage coefficient is set to 0 01 and inter porosity flow coefficient is set to 0 001 the observation well w1 is located at the coordinate 0 0 the interference well w2 is located at the coordinate 8 8 and the interference well w3 is located at the coordinate 8 8 the drawdown curve is obtained from the observation well w1 as shown in the figure the drawdown is the lowest when one well w1 is pumping in the double porosity aquifer and the drawdown is the highest when three wells w1 w2 w3 are pumping at the same time in the double porosity aquifers the boundary effect is not obvious in this case therefore well interference is also considered as an important factor during the process of pumping tests all derivatives for different well number show v shaped curve which represents the supplement from matrix to fissures when there is a single well located at the aquifers the derivative curve is the lowest as the well number increases the derivative value will increases in the late time all the derivative curves for different well number will go down rapidly 3 6 advantages of the presented bem model in numerical methods such as finite element method numerical grid to characterize the aquifer is required to be established in the first step sufficiently large grid size is usually required to reduce the truncation error and enhance the simulation accuracy huge grid numbers may cause heavy computational burden which may require large computer memory and storage space in some cases when dealing with complex problems if the boundary shape changes the numerical mesh also needs to be changed accordingly for each update which may result in even more computational burden and may make the numerical simulation infeasible to perform unlike finite element method the laplace transform bem eliminates the truncation error and has the same order of accuracy as the analytical method if the property variation is not considered the laplace transform bem does not require discretization both in spatial and temporal dimensions to obtain the solution to describe the transient flow behavior in the aquifer in addition since numerical approximation is only required on the boundaries it greatly reduces computational burden it is very convenient to update when the shape of the boundary is changed one limitation that restrict the wide application of this method is that the green function must exist for a specified problem for the problem stated here it is suitable to analyze the pumping test results by using the laplace transform boundary element method 4 conclusions this work presents a novel laplace transform bem model for pumping tests in double porosity aquifers with natural fractures by using the boundary element theory and green function method the presented model allows one to consider irregularly shaped boundaries under zero flux zero draw or mixed boundary conditions using gauss elimination method the final boundary elements matrix can be solved free space green s function and its derivative in double porosity aquifers are used to form the general solution the following conclusions can be drawn 1 the present solution in a simplified form has been validated by comparing it with an analytical solution with the circular boundaries in a single porosity confined aquifer under a zero flux boundary condition 2 the result implies that the drawdown curve with double porosity behavior can be affected by the boundary shape mainly during the stage of pseudo steady state 3 the drawdown affected by fracture storage coefficient is not obvious in the large time when considering double porosity characteristics of aquifers it can be found that a smaller inter porosity flow coefficient leads to larger head depletion in middle and late time 4 due to the recharge across constant head outer boundary the drawdown with a mixed boundary condition is lower than that with zero flux outer boundary however due to the influence of zero flux in the half boundary drawdown with a mixed outer boundary condition is higher than that with zero drawdown outer boundary 5 the drawdown in double porosity aquifers can be seriously affected by the well locations and multiple wells interference hence it may be necessary to be taken into account in pumping tests in a finite double porosity aquifer with natural fractures acknowledgements this work is funded by china postdoctoral science foundation grant no 2017m620527 the science foundation of china university of petroleum beijing grant no 2462014yjrc038 and national science and technology major project grant no 2016zx05037003 and 2017zx05032004 002 we declare that we have no conflict of interest appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j jhydrol 2018 06 027 appendix a supplementary data supplementary data 1 
6916,short term studies have found that stormwater biofiltration systems also known as bioretention systems or raingardens are very effective in reducing heavy metal concentrations however their long term treatment performance as well as the spatial and temporal accumulation of metals within these systems remain uncertain this paper reports on a large scale field study that assessed the changes over time of cadmium cd copper cu lead pb and zinc zn levels in biofilters varying in age design and catchment characteristics the survey incorporated 29 biofilters in 2006 7 and 49 biofilters in 2014 15 located in three major australian cities melbourne brisbane and sydney noting that these results are influenced by having just one industrial site with 25 filters measured at that site catchment characteristics were significantly correlated with metal accumulation rates biofilters in catchments with current or past industrial activities had elevated heavy metal concentrations in the filter media zinc concentrations in the surface 0 100 mm exceed both soil quality and ecological guidelines in contrast heavy metal concentrations in residential catchments are unlikely to ever reach levels that exceed soil quality guidelines for human health although zinc concentrations approach ecological guideline criteria keywords stormwater bioretention stormwater biofilters rain gardens heavy metals media plants 1 introduction the detrimental impacts of uncontrolled urban stormwater discharges are well documented paul and meyer 2001 walsh et al 2005 in order to mitigate these impacts approaches such as water sensitive urban design wsud zhang and guo 2014 are increasingly being adopted biofiltration systems also known as bioretention systems biofilters and rain gardens are a popular stormwater treatment technology that use vegetated soil or sand based filters to attenuate flows reduce runoff volumes and improve water quality davis et al 2009 hatt et al 2009 through sedimentation filtration sorption biological uptake and evapotranspiration wadzuk et al 2014 non vegetated stormwater filters often simple sand filters are also used however they are far less popular than vegetated systems as they are more prone to clogging and consequently reduced infiltration rate urbonas 1999 valtanen et al 2017 short term laboratory scale studies of biofilter treatment performance have demonstrated effective reductions of heavy metal concentrations from stormwater for example davis et al 2003 observed that mean outflow concentrations of cu were mostly 5 μg l and always 2 and 25 μg l for pb and zn respectively which equates to 92 reductions relative to inflow concentrations these findings were confirmed by hatt et al 2008 who also reported that heavy metal removal occurred primarily in the surface layers of non vegetated filter media moreover up to 72 of dissolved metals were removed by the first 7 cm of filter media the removal rate of zn was 4 565 0 70 mg kg trenouth and gharabaghi 2015 sun and davis 2007 investigated the fate of heavy metals in laboratory scale bioretention systems and showed that 88 97 of input metals were removed by the filter media and 0 5 3 3 were taken up by plants field studies have also demonstrated effective metal removal a monitoring study of a biofiltration system showed that the median zn concentration decreased from 659 µg l in the inflow to 29 µg l in the outflow while cu decreased from 37 µg l to 23 µg l trowsdale and simcock 2011 the authors found a direct correlation between the total suspended solids tss and heavy metals concentrations in the outflow except for dissolved cu which tended to increase in the outflow relative to the inflow in two events the biofiltration system removed particulate cu effectively but elevated dissolved cu in the outflow resulted in an increase in total cu additionally the largest outflow volumes of water from the bioretention system contained the highest load of dissolved cu suggesting that there was a link between the flushing of dissolved cu and the flow volume the particle size of sediment in stormwater influences the efficacy of heavy metal removal due to the greater surface area per unit mass of fine particles heavy metals accumulated more effectively on fines li et al 2013 many studies presented that total suspended solids tss and heavy metal concentrations in stormwater runoff are influenced by weather characteristics such as rainfall ph intensity duration and the number of antecedent dry days he et al 2001 pennington and webster brown 2008 wicke et al 2010 wang et al 2017 the particulate fraction of heavy metals is removed by sedimentation and filtration processes davis et al 2009 egemose et al 2015 and thus is likely to be retained in the top layers of the filter media for the operational life of the biofilter the end of which is reported to be triggered by surface clogging li and davis 2008 le coustumer et al 2012 sorption processes facilitated by biofilters are also an important removal mechanism as a considerable fraction of heavy metals in stormwater can be dissolved dean et al 2005 maniquiz redillas and kim 2016 for example in the study of dean et al 2005 divalent ionic forms of cd and zn dominated the dissolved species however cu was mostly correlated with carbonate species or dissolved organic matter dom and pb was mainly correlated with dom previous researchers have speculated that plants do not play an important part in the metal removal process and media with a high adsorption capacity is the key to effective biofiltration performance see for example read et al 2008 davis et al 2001a investigated heavy metal removal by vegetated biofiltration systems and found that concentrations of cu pb and zn in plants increased by factors of 6 3 77 and 8 1 respectively compared to the initial metal concentrations in the plant tissues which represented less than 5 of the influent metal load in comparison 20 10 and 34 of the input loads of cu pb and zn respectively were retained by the mulch and there was low affiliation between metals and the soil despite the acknowledged importance of sorption for heavy metal removal it remains unknown whether the metal sorption capacity of the filter media will become exhausted within the expected operating life of biofilters given the expectation that heavy metals will accumulate in biofilter media over time it is possible that concentrations within the media may eventually exceed locally specified values for ecological and or human protection i e leading to a classification as trade waste few studies that deal with the long term issues related to the accumulation and possible leaching of heavy metals in stormwater biofilters a laboratory study hatt et al 2011 that used accelerated dosing of non vegetated filters to mimic 30 years of operation found that zn breakthrough occurred first and that this could happen after 2 and up to 15 years into a filter s operational life depending on the system design and loadings the absence of plants and use of dissolved metals in this study meant results were likely conservative and a very simplified version of biofilters which are complex bio physical systems this paper presents the results of a study that investigated the accumulation and migration of heavy metals over eight years within a large number of stormwater biofilters located in three australian cities melbourne brisbane and sydney there are two distinct objectives of the work 1 to determine if and where heavy metals accumulate in stormwater biofilter media and 2 to assess the influence of catchment and biofilter design characteristics on the accumulation of heavy metals to our knowledge this is the first field study to comprehensively assess heavy metal accumulation in biofilters over a long period of time the biofilters in this study were not exposed to de icing salts did not incorporate a saturated zone and had media with a low organic matter content 5 w w a surface mulch of stones gravel or organic matter mainly wood chips was present in some nine systems but not all devices the systems were located within three different climatic zones sydney and melbourne have temperate climates winter dominated rainfall and annual evapotranspiration 600 700 500 600 mm respectively while brisbane is sub tropical summer rainfall and dry winter with annual evapotranspiration 800 900 mm bom 2005 2 methods 2 1 study sites two field surveys were conducted to assess heavy metal concentrations in biofilters in three australian cities melbourne long term average annual precipitation aap 650 mm brisbane aap 1200 mm and sydney aap 1175 mm bom 2009 the first in 2006 07 and the second in 2014 15 fourteen sites eight in melbourne four in brisbane and two in sydney were included in the survey and between 1 and 25 biofilters were sampled at each site in total 29 and 49 biofilters were sampled in 2006 07 and 2014 15 respectively the systems collectively represented a broad range of catchment and biofilter design characteristics table 1 all biofilters were receiving stormwater vegetated some with multiple plant species and contained either a sandy loam or loamy sand filter medium as no inflow data for the systems in the field were available the annual volume of water received by each biofilter was estimated using a simple rainfall runoff model in music ewater crc 2011 assuming an initial loss of 1 mm from impervious areas and that the systems received negligible runoff from pervious areas the contributing catchment of each site was characterised according to development type urban density and current and past land use table 1 development type was classified as either greenfield previously undeveloped land renewal re development of an urban area or retrofit biofilters installed in existing urban areas with no other changes to the catchment the urban density was defined as low medium or high according to the dominant housing type detached semi detached flat unit apartment abs 2006 land use was classified according to the main land use in the most recent 10 years current and in the preceding 90 years 2 2 sampling and analysis for each biofilter filter media samples were collected into acid washed plastic containers from the surface 0 2 cm and subsurface 13 15 cm where there was surface mulch fallen leaf litter organic mulch inorganic mulch this was scraped back to the visible sand soil media in order to collect a spatially representative sample the following sampling protocol was adopted i for biofilters with a surface area less than 10 m2 one surface and one subsurface sample was collected ii for systems in the range 10 50 m2 three spatially distributed surface and three subsurface sub samples were collected one of which was located near the system inlet iii for systems with a surface area greater than 50 m2 one extra sub sample was collected for every additional 100 m2 the filter media samples collected in the 2006 07 survey were acid digested and analysed for cd cu pb and zn by inductively coupled plasma optical emission spectrophotometer icp oes using standard methods and quality assurance procedures with detection limits of cd 0 9 mg kg cu 0 3 mg kg pb 1 mg kg zn 2 mg kg in the 2014 15 survey filter media samples were acid digested and analysed according to usepa method 6020 by using inductively coupled plasma mass spectrophotometer icp ms usepa 1998 with detection limits of cd 0 2 mg kg cu 5 mg kg pb 5 mg kg zn 5 mg kg boxplots were used to evaluate the overall accumulation of heavy metals determine the spatial and temporal variation in heavy metal concentrations and to assess the influence of catchment characteristics on heavy metal accumulation in the biofilters since data were non normally distributed the kruskal wallis test was used to test the statistical significance of these relationships significance at p 0 05 relationships between biofilter design and heavy metal accumulation were assessed using regression finally the level of accumulated metals were compared to australian soil quality guidelines nepc 1999 and the victorian environment protection authority s criteria for classification of wastes epa 2007 3 results and discussion 3 1 levels of accumulated heavy metals as shown in fig 1 irrespective of age biofilter design or catchment characteristics the ranges of surface concentrations of heavy metals were cd 0 2 2 5 mg kg cu 3 290 mg kg pb 1 310 mg kg and zn 11 3900 mg kg while subsurface concentrations ranged from cd 0 2 6 mg kg cu 5 110 mg kg pb 5 480 mg kg and zn 5 3200 mg kg table 2 heavy metal concentrations were generally higher at the surface compared to subsurface samples fig 1 p 0 01 for cd cu and zn indicating that metals are primarily trapped in the 0 2 cm of filter media and do not tend to migrate to 13 15 cm into the media profile this is consistent with the findings of previous studies e g davis et al 2001 hatt et al 2008 muthanna et al 2007 which observed that metals tended to be concentrated in the top 5 10 cm followed by a rapid decrease in concentration with increasing depth at 11 of 19 biofilters where three or more surface samples were collected heavy metal concentrations decreased with increasing distance from the inlet fig 2 only cu and zn concentrations are shown for brevity in some biofilters 5 of the 19 biofilters heavy metal concentrations were higher in the middle than at the inlet suggesting that the pathway of stormwater across the biofilter surface was not always uniform in other words if stormwater follows a preferential pathway to the outlet or does not regularly cover the entire system cross section from the inlet to the outlet concentrations may be more heterogeneous between sampling locations it should be noted however that it was not always possible to collect samples from immediately adjacent to the inlet due to high plant density or the presence of stones nevertheless there were some instances 7 biofilters where heavy metal concentrations were low very close to the inlet compared to other positions we hypothesise that sediments may be carried further into the biofilter before depositing on the surface or higher inflows may scour previously deposited sediment resulting in lower metal concentrations these results are consistent with jones and davis 2013 fig 2 shows that the concentrations of heavy metals in two of the biofilters cremorne 5 and cremorne 12 were much higher in the outlet compared to the inlet that was sampled at these biofilters the outlet was located in close proximity to a secondary inlet point 3 2 influence of time on heavy metal concentrations fig 3 presents the ranges of heavy metal concentrations observed in both surveys at four representative of the patterns observed across all fourteen sites at most sites e g alleyne av vic and cremorne st vic saturn cr qld and wolseley gr nsw the median concentrations of cu pb and zn did not change or slightly increased between 2006 7 and 2014 15 fig 3 the p values were 0 05 for all metals except cu and zn in wolseley gr were 0 01 both of these trends are somewhat surprising based on observations from the first survey which showed that some metal concentrations were extremely high zn concentration reached 2390 mg kg after only three years of operation furthermore it was expected that significant accumulation of heavy metals in the filter media would have occurred during the eight years between the first and second surveys it is possible that the unchanged level of heavy metals in the filter media was due to plant uptake of metals lomandra longifolia which was present at both sites has previously been shown to be a promising plant species for phytoremediation of soils contaminated with cd cu pb and zn chaudhry et al 1998 hayes et al 2003 further investigation is required to confirm this cadmium concentrations decreased at five sites p 0 05 and remained unchanged at the remaining nine sites fig 3 cd is considered one of the most mobile heavy metals in soil plant systems and is readily taken up by plants lehocky et al 2000 however this result was possibly due to plant uptake although it may be an artefact of the lower detection limit in 2014 15 0 2 mg kg compared with 0 9 mg kg in the 2006 07 survey as many samples were close to the detection limit the sources of cd in the stormwater runoff are mainly from wet and dry deposition building siding and roof materials and automobiles brake wear davis et al 2001 3 3 influence of catchment and biofilter characteristics on heavy metal concentrations catchment characteristics were correlated with surface heavy metal concentrations in biofilters fig 4 results are only shown for cu and zn for brevity relative to greenfield developments heavy metal concentrations were significantly higher in retrofitted biofilters for cd cu pb and zn p 0 02 in the first survey and for cd cu pb and zn p 0 045 in the second survey and in urban renewal situations for cd cu and pb p 0 03 in 2006 7 and for cd pb and zn p 0 03 in 2014 15 the concentrations in biofilters in low urban density catchments were significantly lower than those in high urban density catchments p 0 03 in 2006 7 p 0 00 in 2014 15 for cd cu pb and zn this may be an artefact as all the low density catchments were residential while 25 of the 30 high density sites contained industrial commercial activity nevertheless cd cu and pb concentrations were also significantly lower in low density catchments than medium density areas p 0 03 for cu and zn and p 0 00 for cd and pb in 2014 15 current land use was also correlated with heavy metal accumulation in 2006 7 biofilters in catchments with industrial activity contained higher concentrations of cd cu pb and zn than those within residential or commercial catchments p 0 02 however zn did not show a significant variance between industrial and commercial catchments this same trend was also observed in the 2014 15 survey past land use was also correlated with metal concentrations biofilters in catchments whose past land use was urban were more contaminated relative to systems with past non urban use for cd cu pb and zn p 0 00 in 2014 15 the high zn concentrations in the retrofit high urban density and industrial catchments are likely due to the high number of automobiles buildings siding and roofing materials there were no significant relationships between biofilter characteristics age surface area and the ratio of the biofilter catchment size and heavy metal concentrations fig 5 results are only shown for cu for brevity 3 4 comparison of biofilter heavy metal concentrations to soil quality guidelines table 3 compares the 50th and 95th percentile concentrations of heavy metals in the 49 biofilters surveyed to australian soil quality guidelines nepc 1999 and the victorian environment protection authority s criteria for classification of wastes epa 2007 the 2006 7 data are not presented because it is the current levels of heavy metals that are critical for assessment these soil quality guideline values are not trigger points for remediation measures to be undertaken in fact they indicate the need for investigation into the risk of adverse impacts on human health or ecosystems at the time of sampling all heavy metal concentrations complied with the health based guidelines and all cd and pb concentrations were below the ecological and prescribed waste guidelines however the 95th percentile cu concentration and 50th and 95th percentile zn concentrations exceeded the concentrations prescribed in the ecological guidelines table 3 in 2014 15 three sites and six biofilters had surface soils exceeding the 100 mg kg ecological investigation value for cu five of which were aged 11 years and the sixth was aged nine years and is located in a commercial and high urban density area bourke st the primary function of biofilters is to retain pollutants from stormwater to protect downstream ecosystems therefore an ecological guideline normally applied to receiving environments may not be an appropriate standard for an engineered treatment system nevertheless some biofilters are designed to have multiple objectives one of which may be habitat provision in which case ecological trigger values are certainly relevant for such systems the asset owner must therefore be prepared to implement an appropriate maintenance regime i e more frequent removal and replacement of the surface layer of filter media and or organic mulch to satisfy ecological guidelines in addition both cu and zn concentrations in biofilters in high urban density and or industrial commercial catchments exceeded the thresholds in the prescribed waste guidelines and the media is therefore classified as category c contaminated material table 3 materials classified as category b or c must be disposed of to a licensed landfill using a certified transport system which would substantially increase the cost to reset or decommission a biofilter in 2006 7 when all but one of 14 biofilters were aged 3 years 12 exceeded the eil for zinc in 2014 15 an additional 2 of these resampled biofilters now aged 9 16 years exceeded the eil level of 200 mg kg mean results from all 49 filters were skewed as only eight of the 27 most contaminated filters i e those in cremorne street were surveyed in 2006 7 while 25 of the 27 were sampled in 2014 15 however the primary function of biofilters is to retain pollutants from stormwater to protect downstream ecosystems therefore an ecological guideline normally applied to receiving environments may not be an appropriate standard to apply for an engineered treatment system nevertheless some biofilters are designed to have multiple objectives one of which may be habitat provision in which case ecological trigger values are certainly relevant for such systems the asset owner must therefore be prepared to implement an appropriate maintenance regime i e more frequent removal and replacement of the surface layer of filter media to satisfy ecological guidelines cu concentrations did not exceed the eil in the first survey 2006 7 in any of the young biofiltration systems in 2014 15 three sites and six biofilters had surface soils exceeding the 100 mg kg ecological value these systems were aged between 9 11 years and located in industrial and or commercial and high urban density areas cremorne and bourke st except one in a residential area saturn cr these results indicate that while it is possible heavy metal concentrations will become an issue in some systems depending on catchment characteristics for most systems it will be clogging rather than metal accumulation that will determine the time for rectification works or decommissioning lindsey et al 1992 found that 31 of the surveyed infiltration systems unfortunately not biofilters were considered to be clogged after four years of operation in practical terms this means it is unlikely that heavy metals will accumulate to levels of concern with respect to human health and prescribed waste category b if there are regular maintenance works to manage surface clogging e g removal and replacement of the surface layer of filter media since heavy metals are concentrated at the top 10 cm of biofilters hatt et al 2008 jones davis 2013 any such maintenance activities will remove most accumulated heavy metals 4 conclusion heavy metals primarily accumulated in the surface layers 0 2 cm of biofiltration systems and concentrations decreased with increasing distance from the inlet and from the filter media surface heavy metal concentrations accumulated in the top 2 cm of the media were within the following ranges cd 0 2 2 5 mg kg cu 3 290 mg kg pb 1 310 mg kg and zn 11 3900 mg kg contrary to our expectation that heavy metal concentrations in the filter media increased between 2006 7 and 2014 15 no significant increases were observed in concentrations of cu pb or zn over the period while cd concentrations decreased it is possible that this is an artefact of a lower detection limit or due to plant uptake of metals although further investigation is required to confirm this most heavy metal concentrations were below the australian soil quality guidelines for ecological cd 3 cu 100 pb 600 and zn 200 mg kg and human health cd 40 cu 2000 pb 600 and zn 14000 mg kg however zn concentrations in many biofilters meant that the filter media would be classified as category c cd 3 cu 100 pb 300 and zn 200 mg kg contaminated material according to victorian guidelines and would thus require special disposal finally it was found that the metals were more likely to accumulate in biofilters treating catchments that are high density or contain current or past industrial activity relative to low density or residential catchments a finding that should be accounted for in design or managed using a more frequent maintenance regime particularly where biofilters also have an ecological objective noting that these results are influenced by having just one industrial site with 25 filters measured at that site however it is not possible to use characteristics of the biofilter itself to evaluate metal accumulation the results from this long term and rather large scale field study suggest that stormwater biofilters could have a longer functional lifespan than previously thought at least with respect to metal accumulation acknowledgments this work was undertaken as part of the facility for advancing water biofiltration s research program funded by the victorian government s science technology and innovation grant scheme melbourne water and the higher committee for education development in iraq hced the authors thank richard williamson bonnie glaister and peter poelsma from monash university australia and justin lewis from melbourne water for their assistance with the field work 
6916,short term studies have found that stormwater biofiltration systems also known as bioretention systems or raingardens are very effective in reducing heavy metal concentrations however their long term treatment performance as well as the spatial and temporal accumulation of metals within these systems remain uncertain this paper reports on a large scale field study that assessed the changes over time of cadmium cd copper cu lead pb and zinc zn levels in biofilters varying in age design and catchment characteristics the survey incorporated 29 biofilters in 2006 7 and 49 biofilters in 2014 15 located in three major australian cities melbourne brisbane and sydney noting that these results are influenced by having just one industrial site with 25 filters measured at that site catchment characteristics were significantly correlated with metal accumulation rates biofilters in catchments with current or past industrial activities had elevated heavy metal concentrations in the filter media zinc concentrations in the surface 0 100 mm exceed both soil quality and ecological guidelines in contrast heavy metal concentrations in residential catchments are unlikely to ever reach levels that exceed soil quality guidelines for human health although zinc concentrations approach ecological guideline criteria keywords stormwater bioretention stormwater biofilters rain gardens heavy metals media plants 1 introduction the detrimental impacts of uncontrolled urban stormwater discharges are well documented paul and meyer 2001 walsh et al 2005 in order to mitigate these impacts approaches such as water sensitive urban design wsud zhang and guo 2014 are increasingly being adopted biofiltration systems also known as bioretention systems biofilters and rain gardens are a popular stormwater treatment technology that use vegetated soil or sand based filters to attenuate flows reduce runoff volumes and improve water quality davis et al 2009 hatt et al 2009 through sedimentation filtration sorption biological uptake and evapotranspiration wadzuk et al 2014 non vegetated stormwater filters often simple sand filters are also used however they are far less popular than vegetated systems as they are more prone to clogging and consequently reduced infiltration rate urbonas 1999 valtanen et al 2017 short term laboratory scale studies of biofilter treatment performance have demonstrated effective reductions of heavy metal concentrations from stormwater for example davis et al 2003 observed that mean outflow concentrations of cu were mostly 5 μg l and always 2 and 25 μg l for pb and zn respectively which equates to 92 reductions relative to inflow concentrations these findings were confirmed by hatt et al 2008 who also reported that heavy metal removal occurred primarily in the surface layers of non vegetated filter media moreover up to 72 of dissolved metals were removed by the first 7 cm of filter media the removal rate of zn was 4 565 0 70 mg kg trenouth and gharabaghi 2015 sun and davis 2007 investigated the fate of heavy metals in laboratory scale bioretention systems and showed that 88 97 of input metals were removed by the filter media and 0 5 3 3 were taken up by plants field studies have also demonstrated effective metal removal a monitoring study of a biofiltration system showed that the median zn concentration decreased from 659 µg l in the inflow to 29 µg l in the outflow while cu decreased from 37 µg l to 23 µg l trowsdale and simcock 2011 the authors found a direct correlation between the total suspended solids tss and heavy metals concentrations in the outflow except for dissolved cu which tended to increase in the outflow relative to the inflow in two events the biofiltration system removed particulate cu effectively but elevated dissolved cu in the outflow resulted in an increase in total cu additionally the largest outflow volumes of water from the bioretention system contained the highest load of dissolved cu suggesting that there was a link between the flushing of dissolved cu and the flow volume the particle size of sediment in stormwater influences the efficacy of heavy metal removal due to the greater surface area per unit mass of fine particles heavy metals accumulated more effectively on fines li et al 2013 many studies presented that total suspended solids tss and heavy metal concentrations in stormwater runoff are influenced by weather characteristics such as rainfall ph intensity duration and the number of antecedent dry days he et al 2001 pennington and webster brown 2008 wicke et al 2010 wang et al 2017 the particulate fraction of heavy metals is removed by sedimentation and filtration processes davis et al 2009 egemose et al 2015 and thus is likely to be retained in the top layers of the filter media for the operational life of the biofilter the end of which is reported to be triggered by surface clogging li and davis 2008 le coustumer et al 2012 sorption processes facilitated by biofilters are also an important removal mechanism as a considerable fraction of heavy metals in stormwater can be dissolved dean et al 2005 maniquiz redillas and kim 2016 for example in the study of dean et al 2005 divalent ionic forms of cd and zn dominated the dissolved species however cu was mostly correlated with carbonate species or dissolved organic matter dom and pb was mainly correlated with dom previous researchers have speculated that plants do not play an important part in the metal removal process and media with a high adsorption capacity is the key to effective biofiltration performance see for example read et al 2008 davis et al 2001a investigated heavy metal removal by vegetated biofiltration systems and found that concentrations of cu pb and zn in plants increased by factors of 6 3 77 and 8 1 respectively compared to the initial metal concentrations in the plant tissues which represented less than 5 of the influent metal load in comparison 20 10 and 34 of the input loads of cu pb and zn respectively were retained by the mulch and there was low affiliation between metals and the soil despite the acknowledged importance of sorption for heavy metal removal it remains unknown whether the metal sorption capacity of the filter media will become exhausted within the expected operating life of biofilters given the expectation that heavy metals will accumulate in biofilter media over time it is possible that concentrations within the media may eventually exceed locally specified values for ecological and or human protection i e leading to a classification as trade waste few studies that deal with the long term issues related to the accumulation and possible leaching of heavy metals in stormwater biofilters a laboratory study hatt et al 2011 that used accelerated dosing of non vegetated filters to mimic 30 years of operation found that zn breakthrough occurred first and that this could happen after 2 and up to 15 years into a filter s operational life depending on the system design and loadings the absence of plants and use of dissolved metals in this study meant results were likely conservative and a very simplified version of biofilters which are complex bio physical systems this paper presents the results of a study that investigated the accumulation and migration of heavy metals over eight years within a large number of stormwater biofilters located in three australian cities melbourne brisbane and sydney there are two distinct objectives of the work 1 to determine if and where heavy metals accumulate in stormwater biofilter media and 2 to assess the influence of catchment and biofilter design characteristics on the accumulation of heavy metals to our knowledge this is the first field study to comprehensively assess heavy metal accumulation in biofilters over a long period of time the biofilters in this study were not exposed to de icing salts did not incorporate a saturated zone and had media with a low organic matter content 5 w w a surface mulch of stones gravel or organic matter mainly wood chips was present in some nine systems but not all devices the systems were located within three different climatic zones sydney and melbourne have temperate climates winter dominated rainfall and annual evapotranspiration 600 700 500 600 mm respectively while brisbane is sub tropical summer rainfall and dry winter with annual evapotranspiration 800 900 mm bom 2005 2 methods 2 1 study sites two field surveys were conducted to assess heavy metal concentrations in biofilters in three australian cities melbourne long term average annual precipitation aap 650 mm brisbane aap 1200 mm and sydney aap 1175 mm bom 2009 the first in 2006 07 and the second in 2014 15 fourteen sites eight in melbourne four in brisbane and two in sydney were included in the survey and between 1 and 25 biofilters were sampled at each site in total 29 and 49 biofilters were sampled in 2006 07 and 2014 15 respectively the systems collectively represented a broad range of catchment and biofilter design characteristics table 1 all biofilters were receiving stormwater vegetated some with multiple plant species and contained either a sandy loam or loamy sand filter medium as no inflow data for the systems in the field were available the annual volume of water received by each biofilter was estimated using a simple rainfall runoff model in music ewater crc 2011 assuming an initial loss of 1 mm from impervious areas and that the systems received negligible runoff from pervious areas the contributing catchment of each site was characterised according to development type urban density and current and past land use table 1 development type was classified as either greenfield previously undeveloped land renewal re development of an urban area or retrofit biofilters installed in existing urban areas with no other changes to the catchment the urban density was defined as low medium or high according to the dominant housing type detached semi detached flat unit apartment abs 2006 land use was classified according to the main land use in the most recent 10 years current and in the preceding 90 years 2 2 sampling and analysis for each biofilter filter media samples were collected into acid washed plastic containers from the surface 0 2 cm and subsurface 13 15 cm where there was surface mulch fallen leaf litter organic mulch inorganic mulch this was scraped back to the visible sand soil media in order to collect a spatially representative sample the following sampling protocol was adopted i for biofilters with a surface area less than 10 m2 one surface and one subsurface sample was collected ii for systems in the range 10 50 m2 three spatially distributed surface and three subsurface sub samples were collected one of which was located near the system inlet iii for systems with a surface area greater than 50 m2 one extra sub sample was collected for every additional 100 m2 the filter media samples collected in the 2006 07 survey were acid digested and analysed for cd cu pb and zn by inductively coupled plasma optical emission spectrophotometer icp oes using standard methods and quality assurance procedures with detection limits of cd 0 9 mg kg cu 0 3 mg kg pb 1 mg kg zn 2 mg kg in the 2014 15 survey filter media samples were acid digested and analysed according to usepa method 6020 by using inductively coupled plasma mass spectrophotometer icp ms usepa 1998 with detection limits of cd 0 2 mg kg cu 5 mg kg pb 5 mg kg zn 5 mg kg boxplots were used to evaluate the overall accumulation of heavy metals determine the spatial and temporal variation in heavy metal concentrations and to assess the influence of catchment characteristics on heavy metal accumulation in the biofilters since data were non normally distributed the kruskal wallis test was used to test the statistical significance of these relationships significance at p 0 05 relationships between biofilter design and heavy metal accumulation were assessed using regression finally the level of accumulated metals were compared to australian soil quality guidelines nepc 1999 and the victorian environment protection authority s criteria for classification of wastes epa 2007 3 results and discussion 3 1 levels of accumulated heavy metals as shown in fig 1 irrespective of age biofilter design or catchment characteristics the ranges of surface concentrations of heavy metals were cd 0 2 2 5 mg kg cu 3 290 mg kg pb 1 310 mg kg and zn 11 3900 mg kg while subsurface concentrations ranged from cd 0 2 6 mg kg cu 5 110 mg kg pb 5 480 mg kg and zn 5 3200 mg kg table 2 heavy metal concentrations were generally higher at the surface compared to subsurface samples fig 1 p 0 01 for cd cu and zn indicating that metals are primarily trapped in the 0 2 cm of filter media and do not tend to migrate to 13 15 cm into the media profile this is consistent with the findings of previous studies e g davis et al 2001 hatt et al 2008 muthanna et al 2007 which observed that metals tended to be concentrated in the top 5 10 cm followed by a rapid decrease in concentration with increasing depth at 11 of 19 biofilters where three or more surface samples were collected heavy metal concentrations decreased with increasing distance from the inlet fig 2 only cu and zn concentrations are shown for brevity in some biofilters 5 of the 19 biofilters heavy metal concentrations were higher in the middle than at the inlet suggesting that the pathway of stormwater across the biofilter surface was not always uniform in other words if stormwater follows a preferential pathway to the outlet or does not regularly cover the entire system cross section from the inlet to the outlet concentrations may be more heterogeneous between sampling locations it should be noted however that it was not always possible to collect samples from immediately adjacent to the inlet due to high plant density or the presence of stones nevertheless there were some instances 7 biofilters where heavy metal concentrations were low very close to the inlet compared to other positions we hypothesise that sediments may be carried further into the biofilter before depositing on the surface or higher inflows may scour previously deposited sediment resulting in lower metal concentrations these results are consistent with jones and davis 2013 fig 2 shows that the concentrations of heavy metals in two of the biofilters cremorne 5 and cremorne 12 were much higher in the outlet compared to the inlet that was sampled at these biofilters the outlet was located in close proximity to a secondary inlet point 3 2 influence of time on heavy metal concentrations fig 3 presents the ranges of heavy metal concentrations observed in both surveys at four representative of the patterns observed across all fourteen sites at most sites e g alleyne av vic and cremorne st vic saturn cr qld and wolseley gr nsw the median concentrations of cu pb and zn did not change or slightly increased between 2006 7 and 2014 15 fig 3 the p values were 0 05 for all metals except cu and zn in wolseley gr were 0 01 both of these trends are somewhat surprising based on observations from the first survey which showed that some metal concentrations were extremely high zn concentration reached 2390 mg kg after only three years of operation furthermore it was expected that significant accumulation of heavy metals in the filter media would have occurred during the eight years between the first and second surveys it is possible that the unchanged level of heavy metals in the filter media was due to plant uptake of metals lomandra longifolia which was present at both sites has previously been shown to be a promising plant species for phytoremediation of soils contaminated with cd cu pb and zn chaudhry et al 1998 hayes et al 2003 further investigation is required to confirm this cadmium concentrations decreased at five sites p 0 05 and remained unchanged at the remaining nine sites fig 3 cd is considered one of the most mobile heavy metals in soil plant systems and is readily taken up by plants lehocky et al 2000 however this result was possibly due to plant uptake although it may be an artefact of the lower detection limit in 2014 15 0 2 mg kg compared with 0 9 mg kg in the 2006 07 survey as many samples were close to the detection limit the sources of cd in the stormwater runoff are mainly from wet and dry deposition building siding and roof materials and automobiles brake wear davis et al 2001 3 3 influence of catchment and biofilter characteristics on heavy metal concentrations catchment characteristics were correlated with surface heavy metal concentrations in biofilters fig 4 results are only shown for cu and zn for brevity relative to greenfield developments heavy metal concentrations were significantly higher in retrofitted biofilters for cd cu pb and zn p 0 02 in the first survey and for cd cu pb and zn p 0 045 in the second survey and in urban renewal situations for cd cu and pb p 0 03 in 2006 7 and for cd pb and zn p 0 03 in 2014 15 the concentrations in biofilters in low urban density catchments were significantly lower than those in high urban density catchments p 0 03 in 2006 7 p 0 00 in 2014 15 for cd cu pb and zn this may be an artefact as all the low density catchments were residential while 25 of the 30 high density sites contained industrial commercial activity nevertheless cd cu and pb concentrations were also significantly lower in low density catchments than medium density areas p 0 03 for cu and zn and p 0 00 for cd and pb in 2014 15 current land use was also correlated with heavy metal accumulation in 2006 7 biofilters in catchments with industrial activity contained higher concentrations of cd cu pb and zn than those within residential or commercial catchments p 0 02 however zn did not show a significant variance between industrial and commercial catchments this same trend was also observed in the 2014 15 survey past land use was also correlated with metal concentrations biofilters in catchments whose past land use was urban were more contaminated relative to systems with past non urban use for cd cu pb and zn p 0 00 in 2014 15 the high zn concentrations in the retrofit high urban density and industrial catchments are likely due to the high number of automobiles buildings siding and roofing materials there were no significant relationships between biofilter characteristics age surface area and the ratio of the biofilter catchment size and heavy metal concentrations fig 5 results are only shown for cu for brevity 3 4 comparison of biofilter heavy metal concentrations to soil quality guidelines table 3 compares the 50th and 95th percentile concentrations of heavy metals in the 49 biofilters surveyed to australian soil quality guidelines nepc 1999 and the victorian environment protection authority s criteria for classification of wastes epa 2007 the 2006 7 data are not presented because it is the current levels of heavy metals that are critical for assessment these soil quality guideline values are not trigger points for remediation measures to be undertaken in fact they indicate the need for investigation into the risk of adverse impacts on human health or ecosystems at the time of sampling all heavy metal concentrations complied with the health based guidelines and all cd and pb concentrations were below the ecological and prescribed waste guidelines however the 95th percentile cu concentration and 50th and 95th percentile zn concentrations exceeded the concentrations prescribed in the ecological guidelines table 3 in 2014 15 three sites and six biofilters had surface soils exceeding the 100 mg kg ecological investigation value for cu five of which were aged 11 years and the sixth was aged nine years and is located in a commercial and high urban density area bourke st the primary function of biofilters is to retain pollutants from stormwater to protect downstream ecosystems therefore an ecological guideline normally applied to receiving environments may not be an appropriate standard for an engineered treatment system nevertheless some biofilters are designed to have multiple objectives one of which may be habitat provision in which case ecological trigger values are certainly relevant for such systems the asset owner must therefore be prepared to implement an appropriate maintenance regime i e more frequent removal and replacement of the surface layer of filter media and or organic mulch to satisfy ecological guidelines in addition both cu and zn concentrations in biofilters in high urban density and or industrial commercial catchments exceeded the thresholds in the prescribed waste guidelines and the media is therefore classified as category c contaminated material table 3 materials classified as category b or c must be disposed of to a licensed landfill using a certified transport system which would substantially increase the cost to reset or decommission a biofilter in 2006 7 when all but one of 14 biofilters were aged 3 years 12 exceeded the eil for zinc in 2014 15 an additional 2 of these resampled biofilters now aged 9 16 years exceeded the eil level of 200 mg kg mean results from all 49 filters were skewed as only eight of the 27 most contaminated filters i e those in cremorne street were surveyed in 2006 7 while 25 of the 27 were sampled in 2014 15 however the primary function of biofilters is to retain pollutants from stormwater to protect downstream ecosystems therefore an ecological guideline normally applied to receiving environments may not be an appropriate standard to apply for an engineered treatment system nevertheless some biofilters are designed to have multiple objectives one of which may be habitat provision in which case ecological trigger values are certainly relevant for such systems the asset owner must therefore be prepared to implement an appropriate maintenance regime i e more frequent removal and replacement of the surface layer of filter media to satisfy ecological guidelines cu concentrations did not exceed the eil in the first survey 2006 7 in any of the young biofiltration systems in 2014 15 three sites and six biofilters had surface soils exceeding the 100 mg kg ecological value these systems were aged between 9 11 years and located in industrial and or commercial and high urban density areas cremorne and bourke st except one in a residential area saturn cr these results indicate that while it is possible heavy metal concentrations will become an issue in some systems depending on catchment characteristics for most systems it will be clogging rather than metal accumulation that will determine the time for rectification works or decommissioning lindsey et al 1992 found that 31 of the surveyed infiltration systems unfortunately not biofilters were considered to be clogged after four years of operation in practical terms this means it is unlikely that heavy metals will accumulate to levels of concern with respect to human health and prescribed waste category b if there are regular maintenance works to manage surface clogging e g removal and replacement of the surface layer of filter media since heavy metals are concentrated at the top 10 cm of biofilters hatt et al 2008 jones davis 2013 any such maintenance activities will remove most accumulated heavy metals 4 conclusion heavy metals primarily accumulated in the surface layers 0 2 cm of biofiltration systems and concentrations decreased with increasing distance from the inlet and from the filter media surface heavy metal concentrations accumulated in the top 2 cm of the media were within the following ranges cd 0 2 2 5 mg kg cu 3 290 mg kg pb 1 310 mg kg and zn 11 3900 mg kg contrary to our expectation that heavy metal concentrations in the filter media increased between 2006 7 and 2014 15 no significant increases were observed in concentrations of cu pb or zn over the period while cd concentrations decreased it is possible that this is an artefact of a lower detection limit or due to plant uptake of metals although further investigation is required to confirm this most heavy metal concentrations were below the australian soil quality guidelines for ecological cd 3 cu 100 pb 600 and zn 200 mg kg and human health cd 40 cu 2000 pb 600 and zn 14000 mg kg however zn concentrations in many biofilters meant that the filter media would be classified as category c cd 3 cu 100 pb 300 and zn 200 mg kg contaminated material according to victorian guidelines and would thus require special disposal finally it was found that the metals were more likely to accumulate in biofilters treating catchments that are high density or contain current or past industrial activity relative to low density or residential catchments a finding that should be accounted for in design or managed using a more frequent maintenance regime particularly where biofilters also have an ecological objective noting that these results are influenced by having just one industrial site with 25 filters measured at that site however it is not possible to use characteristics of the biofilter itself to evaluate metal accumulation the results from this long term and rather large scale field study suggest that stormwater biofilters could have a longer functional lifespan than previously thought at least with respect to metal accumulation acknowledgments this work was undertaken as part of the facility for advancing water biofiltration s research program funded by the victorian government s science technology and innovation grant scheme melbourne water and the higher committee for education development in iraq hced the authors thank richard williamson bonnie glaister and peter poelsma from monash university australia and justin lewis from melbourne water for their assistance with the field work 
6917,the surface energy balance system sebs algorithm very well captures the spatio temporal actual evapotranspiration aet variability which is relevant to compute crop water requirement cwr of commercial farms during the dry season considering this a study was conducted in the arid and semi arid parts of middle awash in ethiopia using reflectance and radiance satellite datasets of both moderate resolution imaging spectroradiometer modis and landsat s operational land imager oli sensors the sebs model e derived aet was compared with the cwr computed from ground observed meteorological datasets the results revealed that the amount of aet over the study area was dependent on temperature surface radiative property moisture content and crop development stage the aet derived from satellite datasets was strongly related to the ground computed cwr over the irrigated sugarcane and cotton fields the study revealed that the technique could be of great help during irrigation management water conservation and allocation hence we recommend decision makers of the commercial farms to further explore the use of this technique to properly manage and schedule their irrigation keywords actual evapotranspiration crop water requirement modis remote sensing surface energy balance 1 introduction crop water requirement cwr can be spatially and temporally analyzed from datasets generated from space alexandridis et al 2009 el shirbeny et al 2014 kamble et al 2013 nouri et al 2013 de teixeira 2009 remotely sensed imageries record the instantaneous electromagnetic property of the surface at different portion of the spectrum from point to global scale bastiaanssen et al 1998a su 2002 these sensor based datasets could be used to improve spatio temporal actual evapotranspiration aet estimation computing aet in space and time is significant for crop water consumptive use crop water stress irrigation performance analysis hydrology and climate allen et al 1998 2005 2007 ayenew 2003 bastiaanssen 1995 1999 bastiaanssen et al 1998a b kustas and norman 1996 su 2002 application of irrigation water to crops depends on the consumptive use or demand of crops the demand of crops can be analyzed using different approaches such as cwr computation or water balance analysis and field observation soil and plants analysis of field observed datasets on large area is expensive and time consuming because it has to be checked regularly on a bigger area for tactical decisions cwr computation allen et al 1998 is usually made on a single station that does not capture spatial variability here the assumption is that the result obtained on the single station can be reliably scaled up to unobserved area halaidege plain is within middle awash sub basin masb a pioneer of modern large scale irrigation activity in ethiopia the area is dominantly arid large sugarcane and cotton irrigation farms are located within this sub basin the farms are managed or owned by either government private investors or farmer small landholders the increase in population size coupled with the limited fresh water resource mainly from the river awash awulachew et al 2005 2007 created different socio economic and political problems the ministry of water irrigation and electricity mowie of ethiopia has identified 560 potential irrigation sites with 3 7 million hectares over the major river basins of ethiopia and irrigation consumes large portion of fresh water awulachew et al 2007 evapotranspiration et is a combined loss of water from the surface evaporation and plants transpiration in the form of vapor to the atmosphere dingman 2002 eto is et from the reference surface not short of water allen et al 1998 however aet is the actual et from heterogeneous surface su 2002 et is one important variable in the computation of cwr et can be directly measured in the field using lysimeters or it can be estimated using several empirical based approaches allen et al 1998 lysimeters are expensive and point observation on the other hand estimation of et from empirical approaches requires sufficient number of meteorological stations and good quality data in masb there are limited meteorological stations that cover the whole area to capture variability of cwr recent advances in remote sensing enable estimation of different land surface parameters covering large areas bastiaanssen et al 1998a chen et al 2013a su 2002 there are different types of algorithms available to estimate surface energy fluxes using combined remote sensing and ground based observations e g surface energy balance algorithm for land sebal by bastiaanssen et al 1998a b two source energy balance tseb by norman et al 1995 soil vegetation atmosphere transfer svat by calvet et al 1998 mapping evapotranspiration at high resolution and with internalized calibration metric by allen et al 2007 and surface energy balance system sebs by su 2002 among these algorithms the sebs algorithm has been formulated to compute aet in space and time from spectral bands of satellite image and few ground datasets it applies the basic principle of surface energy balance furthermore sebs has wide scope of observing the surface and the atmosphere energy interaction and it uses spatially distributed roughness height estimation that none of the other algorithm consider the algorithm has been validated at different scale in different part of the world chen et al 2013a b 2014 su 2002 su et al 2003a b su and mccabe 2005 kwast et al 2009 however this has not been tested in one of the hottest places on earth the afar region of ethiopia where there are many commercial farming activities considering this we set out to assess the spatial and temporal variability of aet over the halaidege plain relevant for cwr analysis using remotely sensed datasets and ground based observed meteorological stations in addition we set out to statistically compare and relate ground and space based aet values under different land cover types in the study area 2 materials and methods 2 1 study area description 2 1 1 location halaidege plain fig 1 is the most commercially important agricultural area in ethiopia it is located at the central part of main ethiopian rift valley geographically it lies between 8 51 10 32 north latitude and 39 17 40 7 east longitude with an approximate area of 23 729 km2 within awash basin ethiopia the lowland part of the study area is plain with level slope however the highland part has dominantly a steep slope the study area elevation ranges from 534 m a s l to 3707 m a s l these wide area cover and variable topography exhibit spatio temporally variable surface and environment in the study area there are two major lakes namely lake beseka and lake yardi 2 1 2 climate the mean annual rainfall in the study area varied from 430 mm at gewane station lowland plain to 1050 mm at debrebirhan highland station the mean monthly temperature for the lowland is approximately 34 c and 13 5 c for the highland agro ecologically the lowland part of the study area is classified as arid while the highland part of the study area is dominated by tepid moist mid highland there are three seasons in the study area these are locally called bega ondj belg fmam and kiremt jjas bega season is cold windy and humid on the other hand the belg season is slightly hot with short duration rains kiremt is the wettest season this study was conducted during bega season starting from october to january and during the first months of belg february during 2014 15 2 1 3 land use land cover the dominant land cover in the area is bare land with exposed rocks in addition water body sugarcane cotton shrub and forest are also available the awash river is the source of irrigation water to grow sugarcane cotton and different fruit trees the moisture from the fractured hot springs around gewane district wereda specifically at meteka site is covered by marsh grassland which is locally known as filla and water body throughout the year 2 2 input datasets satellite sensors historical meteorological field observed crop data and different ancillary geographic information system gis datasets were used to compute aet and cwr covering the whole study area the moderate resolution imaging spectroradiometer modis s terra s collection 5 21 h 8 v level 1b calibrated radiance raw images with 36 bands mod021km with the reference geo location level 1a product mod03a from land process distributed active archive center lpdaac http lpdaac usgs gov with total of 3848 images were processed as an input in sebs algorithm for spatio temporal aet computation sebs requires cloud free images therefore jouybari and aghamohamadnia 2013 method were applied to select cloud free images and 12 level 1b cloud free images during october november december january and february months were selected these months were in dry seasons over the study area the images selected in day of year doy dates were 289 16 10 2014 303 30 10 2014 307 03 11 2014 339 05 12 2014 349 15 12 2014 355 21 12 2014 362 28 12 2014 006 06 01 2015 017 17 01 2015 026 26 01 2015 033 02 02 2015 and 035 04 02 2015 therefore a total of 24 images of both level 1a and b were used as an input for analysis from these selected images visible nir and thermal spectral bands were preprocessed four landsat s 8 operational land imager oli sensor tiles with 30 m spatial resolution were downloaded from http glovis usgs gov to classify land cover for the study area the path and rows were p168 r43 p167 r53 p168 r54 and p167 r54 the scene at 325 doy november 21 2014 was selected because of less cloud cover six digital elevation model dem tiles with 30 m spatial resolution were downloaded from the shuttle radar topography mission srtm s in geotiff file format from https lta cr usgs gov the complete dem of the area was prepared after mosaicking this was later resized to the boundary of the study area at field level more than 450 ground control points gcp s where collected using hand held global positioning system gps in addition crop data such as vegetation height cover type growing stage phenology cropping pattern and method of irrigation were recorded modern era retrospective analysis for research and applications merra is national aeronautics and space administration nasa s atmospheric data reanalysis for the satellite era using a new version of the goddard earth observing system geos data assimilation system das version 5 it is significant for hydrological analysis over data scarce catchment fuka et al 2013 rienecker et al 2008 therefore the 2d merra datasets in 2 3 longitude by 1 2 latitude from goddard earth science data information and services center ges disc at http disc sci gsfc nasa gov mdisc starting from 1985 to 2015 were downloaded for air temperature at 2 and 10 m wind speed and direction at 2 and 10 m specific humidity and surface pressure parameters in total there are 32 meteorological observing stations which are administered by ethiopia national meteorological agency enma are within or within a distant of 20 km of the study area fig 2 among these stations only five stations have daily recorded data namely gewane meteka metehara awash 40 werer debrebrihan and gelemso for these stations a 30 years 1985 2015 sunshine hours wind speed maximum temperature and minimum temperature precipitation relative humidity and pan evaporation only gewane and metehara station datasets were obtained these input datasets quality was first checked and the data gaps were filled using the merra datasets in addition before using the datasets the quality of the data were checked by considering the world meteorological organization wmo standards using matlab software mainly for data bounds and discontinuities ndbc 2009 the meteorological stations are not found within the commercial farms they are located near the farms within a distance of 5 km 2 3 actual evapotranspiration computation aet was computed from satellite datasets using the sebs algorithm from reflectance and radiance bands of modis and observed ground meteorological datasets sebs uses spectral bands from the satellite sensor the sensor should have visible near infrared nir and thermal spectral bands to compute atmospheric turbulent fluxes in space and time sebs uses bulk atmospheric similarity bas theory for planetary boundary layer pbl scaling and monin obukhov atmospheric surface layer asl similarity for surface layer scaling these enables the model to be useful to compute aet under all atmospheric stability from local to regional scale su 2002 2005 su et al 2003 the equations and details about sebs algorithm are well explained su 2002 2005 the simplified energy balance equation used in sebs algorithm can be expressed in linear equation as 2 1 rn h go λ et where rn is net radiation go is soil heat flux h is sensible heat flux and λ et is latent heat of evapotranspiration while net radiation is the vector difference of net incoming and net outgoing radiation which is given by the equation iqbal 1983 2 2 rn 1 α r sdw ε r ldw ε σ t o 4 where rs dw is the downward shortwave radiation rs up is the upward shortwave radiation rl dw is downward long wave radiation from the sky and rluw is upward longwave radiation α is surface albedo ε the emissivity of the surface σ the stefan boltzmann constant equals to 5 67 10 8 to is surface radiative temperature measured from the sensor sebs computes evaporative fraction based on the consideration of cases at limiting condition under the dry limit the latent heat flux becomes near to zero due to the limitation of moisture i e 2 3 λ edry rn go hdry 0 2 4 hdry rn go in addition at the wet limit λet takes place at a potential rate only limited by the available energy while sensible heat flux is at minimum then the relative evaporation is computed as 2 5 λ r 1 h hwet hdry hwet the equation to compute actual h and λe is given as a function of evaporation fraction as 2 6 h 1 λ rn g λ e λ rn g 2 4 crop water requirement computation cwr is the amount of water required to compensate the evapotranspiration loss from the cropped field allen et al 1998 this study computes cwr by adopting the allen et al 1998 method which is by multiplying the reference evapotranspiration by the crop coefficient kc kc is affected by soil type climate crop growth stage and crop type which include albedo crop height leaf and stomata allen et al 1998 the values for different crop development stage for different crop types were taken from food and agriculture organization fao crop water requirement guideline reference et eto for different doy was computed using hargreaves and samani 1985 method which is given by the equation 2 7 et o 0 0023 t mean 17 8 t max t min 0 5 r a where tmean is the mean daily air temperature tmax and tmin are the maximum and the minimum air temperature in degree celsius respectively and ra is extraterrestrial radiation in mm day cwr for the major crops sugarcane cotton and reed swamp of the study area were computed using eto result crop phenologies for the selected crops of the study area were collected then the dominant development stage kc value is applied from a table by allen et al 1998 table 1 shows the kc value applied for different crop type and ground weather stations used to compute cwr 2 5 statistical evaluation the agreement between the sebs model derived cwr and the ground meteorological datasets based observed cwr was assessed using root mean square of error rmse and mean absolute deviation mad as used by chen et al 2013a b 2014 jiang and islam 1999 and su 2002 rmse is a frequently used measure of the differences between values predicted by a model or an estimator and the values actually observed 3 results and discussions 3 1 computation of aet using sebs 3 1 1 land surface temperature lst generally the arid lowland part of the study area had high lst than the highland and the study area during both bega and belg seasons during bega high lst was computed over the rift floor and very minimum lst over the highland and the escarpment part of the study area fig 3 however during the end of bega and the beginning of belg during february lst was high over the lowland and the escarpment part of the study area and low over the highland part of the study area furthermore moist areas had low lst than the moisture deficit areas because of these vegetated and wet areas such as well irrigated fields wetlands and water bodies had low lst than exposed volcanic rock and barren lands during both seasons lst fig 3 was spatio temporally variable over the study area but also within land cover type and growth stage these were observed on both lakes yardi and beseka and over the different crop cover sugarcane and cotton the edges of lake beseka around the northern western and southeastern part of the lake were hotter than the center of the lake this can be for two reasons the temperature differences due to hot subsurface streams that recharge the lake and the land surface impact on the edges of the lake however while moving to the center of the lake stable temperature gradients were formed by attaining thermodynamic stability over the irrigation schemes such as on the sugarcane farms the variability of lst was due to the irrigation condition irrigated and non irrigated variety and the difference in development stage eg ratoon crop lst generally had an inverse relationship with normalized difference vegetation index ndvi with the exception of water bodies fig 4 on the water bodies the value of ndvi is less than zero thus lst had a minimum value on the contrary lst and ndvi had inverse relationship over the other land cover types this was well noted on the cotton crop fields cotton was at its mid stage of development with high ndvi value during the survey bega season at doy of 289 cotton farm had ndvi value of 0 6 and lst of 30 4 c during the end of bega and beginning of belg season cotton transforms to late season of developmental stage during this stage e g at doy of 06 january 6 the value of ndvi for cotton farm was 0 3 and lst of 37 3 c 3 1 2 latent heat flux lhf the amount of energy used for aet varied among locations and land cover types fig 5 the moist parts of the study area such as water bodies swamps and well irrigated sugarcane farms use the dominant amount of net radiation energy as latent heat flux however the barren quaternary sediment and volcanic tuff part of the plain had less latent heat flux and high soil and sensible heat flux the values of lhf over the study area were limited by the surface moisture content and total amount of net radiation energy in addition water holding capacity and energy exchange property of the surface determines lhf values of the land covers of the study area ayenew 2003 chen et al 2013a b 2014 su 2005 the lake yardi fresh water0 had the mean albedo value of 0 044 while the saline and acidic lake beseka water had 0 01 lhf value these variations in surface radiative property created variability in lhf air temperature around lake yardi is comparatively higher than lake beseka hence based on most conventional open water evaporation estimation method lake yardi would evaporate at higher rate than lake beseka due to temperature variation however lhf is greater over lake beseka than yardi this is because of high albedo value over lake yardi hence much of the incoming shortwave radiation is reflected back the highest albedo was observed over the dry barren quaternary sediment and volcanic tuff covered part of the middle valley around melka jilo melka werer and gewane towns figs 1 and 2 in addition the sugarcane farms at metehara and deho and cotton farms had also higher mean albedo value greater than 0 17 albedo was generally lower over the water bodies 3 1 3 actual evapotranspiration aet fig 6 was spatio temporally variable over the study area due to differences in moisture content of the surface and energy exchange property of the different land cover furthermore aet was also spatio temporally variable within the same land cover type due to the variations within a cover ayenew 2003 su 2002 2005 generally the moist parts over the arid lowland part of the study area had high aet than the deficit areas hence the water bodies the reed swamp the well irrigated and mid stage sugarcane and cotton crop had the maximum aet on the other hand the dry barren and exposed volcanic rock cover part of the plain had limited moisture resulting in low aet in the study area fig 7 this variability could be attributed to the moisture availability and atmospheric moisture demand there is high atmospheric moisture demand over the arid lowland part of the study area hence the moist areas over the lowland part of the study area can supply the required amount of moisture to the high atmospheric demand therefore there will be high aet over these locations on the contrary the moisture deficit sections within the lowland with limited moisture and high atmospheric demand is regarded as dry or hot pixels that yield low aet aet over the cotton field was variable in space and time fig 6 cotton farms at gewane buremedaytu amibara and awash 7 wereda of afar region were at mid stage of development during october and november during this period cotton requires high volume of water this implies a high aet record on the other hand during january and february late stage of development cotton consumes less water implying a low aet record the spatio temporal variable aet fig 6 from remotely sensed imagery over the two lakes beseka and yardi indicated that lhf is not only dependent on air temperature but also by radiative property of the surface and the atmosphere ayenew 2003 chen et al 2013a b 2014 su 2002 2005 in addition aet is dependent on the development stage of the crop allen et al 1998 therefore a conventional catchment level aet computational method which uses point stations mainly air temperature as the major determining parameter and assumes uniform distribution of aet over a land cover should be used with care especially for heterogeneous types of landscape seasonally the beginning of bega season following the wettest kiremt season had high aet however belg following bega has low aet and starts to increase to the beginning of the following kiremt main rainy season aet over the study area was maximum during october and november and had a minimum value during the mid of bega during december fig 7 in addition there was a change in aet value over the cotton development stage fig 7 large volume of water is lost from the surface of the study area to the atmosphere through aet fig 8 however the quantities were variable among land cover types large volumes of water were lost through aet from the water bodies and the reed swamps parts of the study area the maximum volume of water were computed during the beginning of bega at 289 doy october 16 which was approximately 86 61 million meter cube mmc day the minimum volume of aet was computed during the end of bega at doy of 362 december 28 which is approximately 38 62 mmc day seasonally the maximum volume was lost during bega season in line to this it should be noted that the role of awash river riparian vegetation in the evapotranspiration is significant seasonally flooded areas should be evaluated with care although flooding was not observed during the survey from the land covers the maximum volume of water was lost as aet from the water bodies and the wetlands at doy of 289 of 2014 which were approximately 1 17 mmc day and 1 10 mmc day respectively sugarcane and cotton farms of the study area also consume large volume of water thus aet was the maximum however the value of aet over the cotton crop decreased with the transformation of development stage fig 9 3 2 crop water requirement cwr the arid lowland meteka gewane awash 40 and werer part of the study area had the maximum eto while the western highlands and upper valley debrebrihan shola gebeya and tarmaber had the lowest eto this was mainly due to differences in the daily temperature low in the highlands and high in the lowlands in addition eto had shown inverse relationship with elevation over the study area fig 10 a the maximum eto 7 23 mm day was computed at 289 doy october 16 over the lowland part of the study area gewane station the lowest eto 2 99 mm day was computed over the western highland part of the study area around debrebrihan fig 10 b at 06 doy january 6 3 3 comparison between station based et and sebs s aet 3 3 1 sebs s aet versus eto the values of eto and aet were almost identical during the beginning of bega season however during the end of bega season and belg season the gap between eto and aet gets wider this is because eto is et from the reference surface not short of water allen et al 1998 during bega on doy of 289 october 16 the surface was rich in moisture that could respond to the atmospheric demand because of this at 289 doy the aet derived from the sebs model had similarity with the observed weather data based eto computation on the contrary the middle of bega and the beginning of belg seasons the surface has minimum moisture that limits the aet demand however high temperature values increased the eto fig 11 a 3 3 2 sebs s aet vs aet from meteorological stations there was statistically insignificant difference between the meteorological station data aetg derived aet and sebs derived aets over sugarcane and cotton field during the selected doys table 2 there was a statistical mean difference of 0 08 mm day over the cotton fields and 0 32 mm day over the sugarcane field the mad and sd values were low over the sugarcane farm than the cotton fields table 2 this is because of the developmental stage difference during the study period the sugarcane had full canopy cover during the whole study time however cotton was at its mid stage of development during the beginning of bega and at late stage of development during the end of bega and belg season these variations in development stage generate deviation from the mean value for this reason sugarcane has less deviation from the mean than cotton the comparison between the sebs estimated cwr and observed weather data based cwr computation on sugarcane cotton and wetland had a mean square of error mse of 0 17 0 25 and 0 33 mm day respectively in addition there was statistically insignificant difference between the two methods table 3 3 3 2 1 sebs s estimated aet vs cwr from the stations over sugarcane field the sugarcane farms of metehara and deho sugarcane factory consume large volume of water per day fig 11 d the rmse value of 0 41 mm day and mad value of 0 39 mm day table 3 indicates that meteorological station based cwr computations for sugarcane allen et al 1998 and aet derived from sebs su 2002 for the different doy over the two irrigation schemes fig 11 d have statistically insignificant difference furthermore fig 11 e shows the two computational methods direct linear relationship with statistical correlation over sugarcane farm thus for such study site cwr can be reliably computed from remotely sensed imageries 3 3 2 2 sebs s estimated aet vs cwr from the stations over the cotton field high water demand at mid stage of development and less demand at late stage was observed over the lowland arid cotton field fig 11 b the rmse value of 0 50 mm day and mad value of 0 46 mm day table 3 showed that ground meteorological stations derived cwr allen et al 1998 has statistically insignificant difference with sebs derived aet su 2002 over the arid lowland cotton field part of the study area moreover the two methods estimate the development stage transformation with insignificant difference fig 11 b furthermore the two computational methods have direct linear relationship with high statistical correlation fig 11 c 3 3 2 3 sebs s estimated aet vs cwr from the stations over the wetland the cwr estimated from allen et al 1998 and aet from sebs su 2002 over the reed swamp covered with typha domingenesis had shown insignificant statistical difference fig 11 f 4 conclusions in this research we tested sebs model and demonstrated the applicability of using satellite datasets to compute crop water requirements cwr on large commercial farms over one of the hottest places on earth the afar region including some semi arid areas in ethiopia there is a strong relationship between satellite derived and ground based cwr computed results this revealed the performance of sebs to estimate spatio temporal aet cwr and turbulent heat fluxes over the arid semi arid data scarce and heterogeneous landscape of the study area hence cwr over the irrigated fields of the study area was effectively computed from spectral bands of satellite images at different spatial and temporal resolution in addition the study has shown that aet is dependent on air temperature surface radiative property and land cover or biophysical condition furthermore aet was variable in space and time among different land covers the results of the study gave a special focus on the irrigated land commercial farms thus further research is required to implement sebs algorithm over the heterogeneous barren surfaces and highland part of the study area despite the difficulty and the cost to acquire high spatial and temporal resolution images and shortage of academics on the field we recommend on the use of satellite images for cwr computation to alleviate extreme data scarcity and heterogeneity of the environment for sustainable water resource management acknowledgements we would like to acknowledge the afar design and supervision works enterprise afdswe semera afar ethiopia who financially supported this work in addition we thank the ethiopian national meteorological agency enma mekelle university and afar bureau of water resources development for providing input datasets during the analysis 
6917,the surface energy balance system sebs algorithm very well captures the spatio temporal actual evapotranspiration aet variability which is relevant to compute crop water requirement cwr of commercial farms during the dry season considering this a study was conducted in the arid and semi arid parts of middle awash in ethiopia using reflectance and radiance satellite datasets of both moderate resolution imaging spectroradiometer modis and landsat s operational land imager oli sensors the sebs model e derived aet was compared with the cwr computed from ground observed meteorological datasets the results revealed that the amount of aet over the study area was dependent on temperature surface radiative property moisture content and crop development stage the aet derived from satellite datasets was strongly related to the ground computed cwr over the irrigated sugarcane and cotton fields the study revealed that the technique could be of great help during irrigation management water conservation and allocation hence we recommend decision makers of the commercial farms to further explore the use of this technique to properly manage and schedule their irrigation keywords actual evapotranspiration crop water requirement modis remote sensing surface energy balance 1 introduction crop water requirement cwr can be spatially and temporally analyzed from datasets generated from space alexandridis et al 2009 el shirbeny et al 2014 kamble et al 2013 nouri et al 2013 de teixeira 2009 remotely sensed imageries record the instantaneous electromagnetic property of the surface at different portion of the spectrum from point to global scale bastiaanssen et al 1998a su 2002 these sensor based datasets could be used to improve spatio temporal actual evapotranspiration aet estimation computing aet in space and time is significant for crop water consumptive use crop water stress irrigation performance analysis hydrology and climate allen et al 1998 2005 2007 ayenew 2003 bastiaanssen 1995 1999 bastiaanssen et al 1998a b kustas and norman 1996 su 2002 application of irrigation water to crops depends on the consumptive use or demand of crops the demand of crops can be analyzed using different approaches such as cwr computation or water balance analysis and field observation soil and plants analysis of field observed datasets on large area is expensive and time consuming because it has to be checked regularly on a bigger area for tactical decisions cwr computation allen et al 1998 is usually made on a single station that does not capture spatial variability here the assumption is that the result obtained on the single station can be reliably scaled up to unobserved area halaidege plain is within middle awash sub basin masb a pioneer of modern large scale irrigation activity in ethiopia the area is dominantly arid large sugarcane and cotton irrigation farms are located within this sub basin the farms are managed or owned by either government private investors or farmer small landholders the increase in population size coupled with the limited fresh water resource mainly from the river awash awulachew et al 2005 2007 created different socio economic and political problems the ministry of water irrigation and electricity mowie of ethiopia has identified 560 potential irrigation sites with 3 7 million hectares over the major river basins of ethiopia and irrigation consumes large portion of fresh water awulachew et al 2007 evapotranspiration et is a combined loss of water from the surface evaporation and plants transpiration in the form of vapor to the atmosphere dingman 2002 eto is et from the reference surface not short of water allen et al 1998 however aet is the actual et from heterogeneous surface su 2002 et is one important variable in the computation of cwr et can be directly measured in the field using lysimeters or it can be estimated using several empirical based approaches allen et al 1998 lysimeters are expensive and point observation on the other hand estimation of et from empirical approaches requires sufficient number of meteorological stations and good quality data in masb there are limited meteorological stations that cover the whole area to capture variability of cwr recent advances in remote sensing enable estimation of different land surface parameters covering large areas bastiaanssen et al 1998a chen et al 2013a su 2002 there are different types of algorithms available to estimate surface energy fluxes using combined remote sensing and ground based observations e g surface energy balance algorithm for land sebal by bastiaanssen et al 1998a b two source energy balance tseb by norman et al 1995 soil vegetation atmosphere transfer svat by calvet et al 1998 mapping evapotranspiration at high resolution and with internalized calibration metric by allen et al 2007 and surface energy balance system sebs by su 2002 among these algorithms the sebs algorithm has been formulated to compute aet in space and time from spectral bands of satellite image and few ground datasets it applies the basic principle of surface energy balance furthermore sebs has wide scope of observing the surface and the atmosphere energy interaction and it uses spatially distributed roughness height estimation that none of the other algorithm consider the algorithm has been validated at different scale in different part of the world chen et al 2013a b 2014 su 2002 su et al 2003a b su and mccabe 2005 kwast et al 2009 however this has not been tested in one of the hottest places on earth the afar region of ethiopia where there are many commercial farming activities considering this we set out to assess the spatial and temporal variability of aet over the halaidege plain relevant for cwr analysis using remotely sensed datasets and ground based observed meteorological stations in addition we set out to statistically compare and relate ground and space based aet values under different land cover types in the study area 2 materials and methods 2 1 study area description 2 1 1 location halaidege plain fig 1 is the most commercially important agricultural area in ethiopia it is located at the central part of main ethiopian rift valley geographically it lies between 8 51 10 32 north latitude and 39 17 40 7 east longitude with an approximate area of 23 729 km2 within awash basin ethiopia the lowland part of the study area is plain with level slope however the highland part has dominantly a steep slope the study area elevation ranges from 534 m a s l to 3707 m a s l these wide area cover and variable topography exhibit spatio temporally variable surface and environment in the study area there are two major lakes namely lake beseka and lake yardi 2 1 2 climate the mean annual rainfall in the study area varied from 430 mm at gewane station lowland plain to 1050 mm at debrebirhan highland station the mean monthly temperature for the lowland is approximately 34 c and 13 5 c for the highland agro ecologically the lowland part of the study area is classified as arid while the highland part of the study area is dominated by tepid moist mid highland there are three seasons in the study area these are locally called bega ondj belg fmam and kiremt jjas bega season is cold windy and humid on the other hand the belg season is slightly hot with short duration rains kiremt is the wettest season this study was conducted during bega season starting from october to january and during the first months of belg february during 2014 15 2 1 3 land use land cover the dominant land cover in the area is bare land with exposed rocks in addition water body sugarcane cotton shrub and forest are also available the awash river is the source of irrigation water to grow sugarcane cotton and different fruit trees the moisture from the fractured hot springs around gewane district wereda specifically at meteka site is covered by marsh grassland which is locally known as filla and water body throughout the year 2 2 input datasets satellite sensors historical meteorological field observed crop data and different ancillary geographic information system gis datasets were used to compute aet and cwr covering the whole study area the moderate resolution imaging spectroradiometer modis s terra s collection 5 21 h 8 v level 1b calibrated radiance raw images with 36 bands mod021km with the reference geo location level 1a product mod03a from land process distributed active archive center lpdaac http lpdaac usgs gov with total of 3848 images were processed as an input in sebs algorithm for spatio temporal aet computation sebs requires cloud free images therefore jouybari and aghamohamadnia 2013 method were applied to select cloud free images and 12 level 1b cloud free images during october november december january and february months were selected these months were in dry seasons over the study area the images selected in day of year doy dates were 289 16 10 2014 303 30 10 2014 307 03 11 2014 339 05 12 2014 349 15 12 2014 355 21 12 2014 362 28 12 2014 006 06 01 2015 017 17 01 2015 026 26 01 2015 033 02 02 2015 and 035 04 02 2015 therefore a total of 24 images of both level 1a and b were used as an input for analysis from these selected images visible nir and thermal spectral bands were preprocessed four landsat s 8 operational land imager oli sensor tiles with 30 m spatial resolution were downloaded from http glovis usgs gov to classify land cover for the study area the path and rows were p168 r43 p167 r53 p168 r54 and p167 r54 the scene at 325 doy november 21 2014 was selected because of less cloud cover six digital elevation model dem tiles with 30 m spatial resolution were downloaded from the shuttle radar topography mission srtm s in geotiff file format from https lta cr usgs gov the complete dem of the area was prepared after mosaicking this was later resized to the boundary of the study area at field level more than 450 ground control points gcp s where collected using hand held global positioning system gps in addition crop data such as vegetation height cover type growing stage phenology cropping pattern and method of irrigation were recorded modern era retrospective analysis for research and applications merra is national aeronautics and space administration nasa s atmospheric data reanalysis for the satellite era using a new version of the goddard earth observing system geos data assimilation system das version 5 it is significant for hydrological analysis over data scarce catchment fuka et al 2013 rienecker et al 2008 therefore the 2d merra datasets in 2 3 longitude by 1 2 latitude from goddard earth science data information and services center ges disc at http disc sci gsfc nasa gov mdisc starting from 1985 to 2015 were downloaded for air temperature at 2 and 10 m wind speed and direction at 2 and 10 m specific humidity and surface pressure parameters in total there are 32 meteorological observing stations which are administered by ethiopia national meteorological agency enma are within or within a distant of 20 km of the study area fig 2 among these stations only five stations have daily recorded data namely gewane meteka metehara awash 40 werer debrebrihan and gelemso for these stations a 30 years 1985 2015 sunshine hours wind speed maximum temperature and minimum temperature precipitation relative humidity and pan evaporation only gewane and metehara station datasets were obtained these input datasets quality was first checked and the data gaps were filled using the merra datasets in addition before using the datasets the quality of the data were checked by considering the world meteorological organization wmo standards using matlab software mainly for data bounds and discontinuities ndbc 2009 the meteorological stations are not found within the commercial farms they are located near the farms within a distance of 5 km 2 3 actual evapotranspiration computation aet was computed from satellite datasets using the sebs algorithm from reflectance and radiance bands of modis and observed ground meteorological datasets sebs uses spectral bands from the satellite sensor the sensor should have visible near infrared nir and thermal spectral bands to compute atmospheric turbulent fluxes in space and time sebs uses bulk atmospheric similarity bas theory for planetary boundary layer pbl scaling and monin obukhov atmospheric surface layer asl similarity for surface layer scaling these enables the model to be useful to compute aet under all atmospheric stability from local to regional scale su 2002 2005 su et al 2003 the equations and details about sebs algorithm are well explained su 2002 2005 the simplified energy balance equation used in sebs algorithm can be expressed in linear equation as 2 1 rn h go λ et where rn is net radiation go is soil heat flux h is sensible heat flux and λ et is latent heat of evapotranspiration while net radiation is the vector difference of net incoming and net outgoing radiation which is given by the equation iqbal 1983 2 2 rn 1 α r sdw ε r ldw ε σ t o 4 where rs dw is the downward shortwave radiation rs up is the upward shortwave radiation rl dw is downward long wave radiation from the sky and rluw is upward longwave radiation α is surface albedo ε the emissivity of the surface σ the stefan boltzmann constant equals to 5 67 10 8 to is surface radiative temperature measured from the sensor sebs computes evaporative fraction based on the consideration of cases at limiting condition under the dry limit the latent heat flux becomes near to zero due to the limitation of moisture i e 2 3 λ edry rn go hdry 0 2 4 hdry rn go in addition at the wet limit λet takes place at a potential rate only limited by the available energy while sensible heat flux is at minimum then the relative evaporation is computed as 2 5 λ r 1 h hwet hdry hwet the equation to compute actual h and λe is given as a function of evaporation fraction as 2 6 h 1 λ rn g λ e λ rn g 2 4 crop water requirement computation cwr is the amount of water required to compensate the evapotranspiration loss from the cropped field allen et al 1998 this study computes cwr by adopting the allen et al 1998 method which is by multiplying the reference evapotranspiration by the crop coefficient kc kc is affected by soil type climate crop growth stage and crop type which include albedo crop height leaf and stomata allen et al 1998 the values for different crop development stage for different crop types were taken from food and agriculture organization fao crop water requirement guideline reference et eto for different doy was computed using hargreaves and samani 1985 method which is given by the equation 2 7 et o 0 0023 t mean 17 8 t max t min 0 5 r a where tmean is the mean daily air temperature tmax and tmin are the maximum and the minimum air temperature in degree celsius respectively and ra is extraterrestrial radiation in mm day cwr for the major crops sugarcane cotton and reed swamp of the study area were computed using eto result crop phenologies for the selected crops of the study area were collected then the dominant development stage kc value is applied from a table by allen et al 1998 table 1 shows the kc value applied for different crop type and ground weather stations used to compute cwr 2 5 statistical evaluation the agreement between the sebs model derived cwr and the ground meteorological datasets based observed cwr was assessed using root mean square of error rmse and mean absolute deviation mad as used by chen et al 2013a b 2014 jiang and islam 1999 and su 2002 rmse is a frequently used measure of the differences between values predicted by a model or an estimator and the values actually observed 3 results and discussions 3 1 computation of aet using sebs 3 1 1 land surface temperature lst generally the arid lowland part of the study area had high lst than the highland and the study area during both bega and belg seasons during bega high lst was computed over the rift floor and very minimum lst over the highland and the escarpment part of the study area fig 3 however during the end of bega and the beginning of belg during february lst was high over the lowland and the escarpment part of the study area and low over the highland part of the study area furthermore moist areas had low lst than the moisture deficit areas because of these vegetated and wet areas such as well irrigated fields wetlands and water bodies had low lst than exposed volcanic rock and barren lands during both seasons lst fig 3 was spatio temporally variable over the study area but also within land cover type and growth stage these were observed on both lakes yardi and beseka and over the different crop cover sugarcane and cotton the edges of lake beseka around the northern western and southeastern part of the lake were hotter than the center of the lake this can be for two reasons the temperature differences due to hot subsurface streams that recharge the lake and the land surface impact on the edges of the lake however while moving to the center of the lake stable temperature gradients were formed by attaining thermodynamic stability over the irrigation schemes such as on the sugarcane farms the variability of lst was due to the irrigation condition irrigated and non irrigated variety and the difference in development stage eg ratoon crop lst generally had an inverse relationship with normalized difference vegetation index ndvi with the exception of water bodies fig 4 on the water bodies the value of ndvi is less than zero thus lst had a minimum value on the contrary lst and ndvi had inverse relationship over the other land cover types this was well noted on the cotton crop fields cotton was at its mid stage of development with high ndvi value during the survey bega season at doy of 289 cotton farm had ndvi value of 0 6 and lst of 30 4 c during the end of bega and beginning of belg season cotton transforms to late season of developmental stage during this stage e g at doy of 06 january 6 the value of ndvi for cotton farm was 0 3 and lst of 37 3 c 3 1 2 latent heat flux lhf the amount of energy used for aet varied among locations and land cover types fig 5 the moist parts of the study area such as water bodies swamps and well irrigated sugarcane farms use the dominant amount of net radiation energy as latent heat flux however the barren quaternary sediment and volcanic tuff part of the plain had less latent heat flux and high soil and sensible heat flux the values of lhf over the study area were limited by the surface moisture content and total amount of net radiation energy in addition water holding capacity and energy exchange property of the surface determines lhf values of the land covers of the study area ayenew 2003 chen et al 2013a b 2014 su 2005 the lake yardi fresh water0 had the mean albedo value of 0 044 while the saline and acidic lake beseka water had 0 01 lhf value these variations in surface radiative property created variability in lhf air temperature around lake yardi is comparatively higher than lake beseka hence based on most conventional open water evaporation estimation method lake yardi would evaporate at higher rate than lake beseka due to temperature variation however lhf is greater over lake beseka than yardi this is because of high albedo value over lake yardi hence much of the incoming shortwave radiation is reflected back the highest albedo was observed over the dry barren quaternary sediment and volcanic tuff covered part of the middle valley around melka jilo melka werer and gewane towns figs 1 and 2 in addition the sugarcane farms at metehara and deho and cotton farms had also higher mean albedo value greater than 0 17 albedo was generally lower over the water bodies 3 1 3 actual evapotranspiration aet fig 6 was spatio temporally variable over the study area due to differences in moisture content of the surface and energy exchange property of the different land cover furthermore aet was also spatio temporally variable within the same land cover type due to the variations within a cover ayenew 2003 su 2002 2005 generally the moist parts over the arid lowland part of the study area had high aet than the deficit areas hence the water bodies the reed swamp the well irrigated and mid stage sugarcane and cotton crop had the maximum aet on the other hand the dry barren and exposed volcanic rock cover part of the plain had limited moisture resulting in low aet in the study area fig 7 this variability could be attributed to the moisture availability and atmospheric moisture demand there is high atmospheric moisture demand over the arid lowland part of the study area hence the moist areas over the lowland part of the study area can supply the required amount of moisture to the high atmospheric demand therefore there will be high aet over these locations on the contrary the moisture deficit sections within the lowland with limited moisture and high atmospheric demand is regarded as dry or hot pixels that yield low aet aet over the cotton field was variable in space and time fig 6 cotton farms at gewane buremedaytu amibara and awash 7 wereda of afar region were at mid stage of development during october and november during this period cotton requires high volume of water this implies a high aet record on the other hand during january and february late stage of development cotton consumes less water implying a low aet record the spatio temporal variable aet fig 6 from remotely sensed imagery over the two lakes beseka and yardi indicated that lhf is not only dependent on air temperature but also by radiative property of the surface and the atmosphere ayenew 2003 chen et al 2013a b 2014 su 2002 2005 in addition aet is dependent on the development stage of the crop allen et al 1998 therefore a conventional catchment level aet computational method which uses point stations mainly air temperature as the major determining parameter and assumes uniform distribution of aet over a land cover should be used with care especially for heterogeneous types of landscape seasonally the beginning of bega season following the wettest kiremt season had high aet however belg following bega has low aet and starts to increase to the beginning of the following kiremt main rainy season aet over the study area was maximum during october and november and had a minimum value during the mid of bega during december fig 7 in addition there was a change in aet value over the cotton development stage fig 7 large volume of water is lost from the surface of the study area to the atmosphere through aet fig 8 however the quantities were variable among land cover types large volumes of water were lost through aet from the water bodies and the reed swamps parts of the study area the maximum volume of water were computed during the beginning of bega at 289 doy october 16 which was approximately 86 61 million meter cube mmc day the minimum volume of aet was computed during the end of bega at doy of 362 december 28 which is approximately 38 62 mmc day seasonally the maximum volume was lost during bega season in line to this it should be noted that the role of awash river riparian vegetation in the evapotranspiration is significant seasonally flooded areas should be evaluated with care although flooding was not observed during the survey from the land covers the maximum volume of water was lost as aet from the water bodies and the wetlands at doy of 289 of 2014 which were approximately 1 17 mmc day and 1 10 mmc day respectively sugarcane and cotton farms of the study area also consume large volume of water thus aet was the maximum however the value of aet over the cotton crop decreased with the transformation of development stage fig 9 3 2 crop water requirement cwr the arid lowland meteka gewane awash 40 and werer part of the study area had the maximum eto while the western highlands and upper valley debrebrihan shola gebeya and tarmaber had the lowest eto this was mainly due to differences in the daily temperature low in the highlands and high in the lowlands in addition eto had shown inverse relationship with elevation over the study area fig 10 a the maximum eto 7 23 mm day was computed at 289 doy october 16 over the lowland part of the study area gewane station the lowest eto 2 99 mm day was computed over the western highland part of the study area around debrebrihan fig 10 b at 06 doy january 6 3 3 comparison between station based et and sebs s aet 3 3 1 sebs s aet versus eto the values of eto and aet were almost identical during the beginning of bega season however during the end of bega season and belg season the gap between eto and aet gets wider this is because eto is et from the reference surface not short of water allen et al 1998 during bega on doy of 289 october 16 the surface was rich in moisture that could respond to the atmospheric demand because of this at 289 doy the aet derived from the sebs model had similarity with the observed weather data based eto computation on the contrary the middle of bega and the beginning of belg seasons the surface has minimum moisture that limits the aet demand however high temperature values increased the eto fig 11 a 3 3 2 sebs s aet vs aet from meteorological stations there was statistically insignificant difference between the meteorological station data aetg derived aet and sebs derived aets over sugarcane and cotton field during the selected doys table 2 there was a statistical mean difference of 0 08 mm day over the cotton fields and 0 32 mm day over the sugarcane field the mad and sd values were low over the sugarcane farm than the cotton fields table 2 this is because of the developmental stage difference during the study period the sugarcane had full canopy cover during the whole study time however cotton was at its mid stage of development during the beginning of bega and at late stage of development during the end of bega and belg season these variations in development stage generate deviation from the mean value for this reason sugarcane has less deviation from the mean than cotton the comparison between the sebs estimated cwr and observed weather data based cwr computation on sugarcane cotton and wetland had a mean square of error mse of 0 17 0 25 and 0 33 mm day respectively in addition there was statistically insignificant difference between the two methods table 3 3 3 2 1 sebs s estimated aet vs cwr from the stations over sugarcane field the sugarcane farms of metehara and deho sugarcane factory consume large volume of water per day fig 11 d the rmse value of 0 41 mm day and mad value of 0 39 mm day table 3 indicates that meteorological station based cwr computations for sugarcane allen et al 1998 and aet derived from sebs su 2002 for the different doy over the two irrigation schemes fig 11 d have statistically insignificant difference furthermore fig 11 e shows the two computational methods direct linear relationship with statistical correlation over sugarcane farm thus for such study site cwr can be reliably computed from remotely sensed imageries 3 3 2 2 sebs s estimated aet vs cwr from the stations over the cotton field high water demand at mid stage of development and less demand at late stage was observed over the lowland arid cotton field fig 11 b the rmse value of 0 50 mm day and mad value of 0 46 mm day table 3 showed that ground meteorological stations derived cwr allen et al 1998 has statistically insignificant difference with sebs derived aet su 2002 over the arid lowland cotton field part of the study area moreover the two methods estimate the development stage transformation with insignificant difference fig 11 b furthermore the two computational methods have direct linear relationship with high statistical correlation fig 11 c 3 3 2 3 sebs s estimated aet vs cwr from the stations over the wetland the cwr estimated from allen et al 1998 and aet from sebs su 2002 over the reed swamp covered with typha domingenesis had shown insignificant statistical difference fig 11 f 4 conclusions in this research we tested sebs model and demonstrated the applicability of using satellite datasets to compute crop water requirements cwr on large commercial farms over one of the hottest places on earth the afar region including some semi arid areas in ethiopia there is a strong relationship between satellite derived and ground based cwr computed results this revealed the performance of sebs to estimate spatio temporal aet cwr and turbulent heat fluxes over the arid semi arid data scarce and heterogeneous landscape of the study area hence cwr over the irrigated fields of the study area was effectively computed from spectral bands of satellite images at different spatial and temporal resolution in addition the study has shown that aet is dependent on air temperature surface radiative property and land cover or biophysical condition furthermore aet was variable in space and time among different land covers the results of the study gave a special focus on the irrigated land commercial farms thus further research is required to implement sebs algorithm over the heterogeneous barren surfaces and highland part of the study area despite the difficulty and the cost to acquire high spatial and temporal resolution images and shortage of academics on the field we recommend on the use of satellite images for cwr computation to alleviate extreme data scarcity and heterogeneity of the environment for sustainable water resource management acknowledgements we would like to acknowledge the afar design and supervision works enterprise afdswe semera afar ethiopia who financially supported this work in addition we thank the ethiopian national meteorological agency enma mekelle university and afar bureau of water resources development for providing input datasets during the analysis 
6918,while the application of neural networks for groundwater level forecasting in general has been investigated by many authors the use of nonlinear autoregressive networks with exogenous inputs narx is relatively new for this work narx were applied to obtain groundwater level forecasts for several wells in southwest germany wells in porous fractured and karst aquifers were investigated and forecasts of lead times up to half a year were conducted for both influenced e g nearby pumping and uninfluenced wells precipitation and temperature were chosen as predictors which makes the selected approach easily transferable since both parameters are widely available and simple to measure input and feedback delays were determined by applying stl time series decomposition on the data and using auto and cross correlation functions on the remainders to determine significant time lags coefficient of determination relative root mean squared error and nash sutcliffe efficiency were used to evaluate forecasts the model selection was based on an out of sample validation on rolling basis the results are promising and indicate an outstanding suitability of narx for groundwater level predictions with such a small set of inputs in all three aquifer types keywords groundwater levels forecasting neural networks narx germany 1 introduction groundwater is a vital resource and an important source of freshwater worldwide it is generally cleaner and more readily available than other drinking water resources and more than 2 billion people depend on groundwater for drinking water supplies mackay et al 2015 morris et al 2003 it is therefore essential to develop sustainable water resources management measures to ensure drinking water supply within a region accurate and reliable forecasts of groundwater levels play a decisive role as these forecasts provide essential information about the quantitative groundwater conditions of an aquifer in addition to the importance for drinking water supply further applications for groundwater level predictions are conceivable this includes planning groundwater extractions for industrial purposes such as cooling or agricultural irrigation guzman et al 2017 barzegar et al 2017 as well as the use as a raw material for the food industry moreover sensitive ecosystems such as wetlands can be protected and the risk and impact of groundwater extremes such as subsidence or groundwater flooding can be reduced mackay et al 2015 kisi et al 2017 common practice in modelling groundwater variables is the application of numerical models which use physical relationships to describe a certain area asce 2000 these kinds of models require lots of data and the development application and maintenance is time consuming and expensive e g anderson et al 2015 bear and cheng 2010 however artificial neural networks anns are an alternative data driven approach which has been widely used for forecasting water resource variables within the last decade e g maier et al 2010 they imitate the behaviour of the human brain and are able to learn relationships between variables by applying special training algorithms on available data this ability makes anns a valuable tool for studying complex scenarios which are difficult to describe with conventional methods especially if the outcome is more important than an exact understanding of the involved processes or if only few system knowledge exists daliakopoulos et al 2005 samarasinghe 2006 the ability to capture system dynamics and nonlinearities makes anns exceptionally adequate for the investigation of hydrological systems which usually have distinctive spatio temporal variabilities asce 2000 although various model architectures are used extensively in hydrology maier et al 2010 feedforward and recurrent networks are the most common asce 2000 anns have been applied in a large number of studies focused on the prediction of water resource variables e g discharge or water level in river systems maier et al 2010 also a significant number of studies used anns to predict groundwater levels e g coulibaly et al 2001a coppola et al 2003 daliakopoulos et al 2005 lallahem et al 2005 nayak et al 2006 mohammadi 2008 sreekanth et al 2009 yoon et al 2011 adamowski and chan 2011 trichakis et al 2011 taormina et al 2012 chitsazan et al 2015 jha and sahoo 2015 khalil et al 2015 chang et al 2016 sahoo et al 2017 gorgij et al 2017 kisi et al 2017 barzegar et al 2017 most authors used feedforward networks whereas the use of narx models for groundwater level prediction e g izady et al 2013 chang et al 2016 guzman et al 2017 is not very common izady et al 2013 investigated feedforward network and narx performance for groundwater level prediction in an alluvial plain in iran by comparing validation period results they found a clear superiority of narx compared to static neural networks guzman et al 2017 used narx models to investigate an alluvial aquifer in the usa and compared different training algorithms for performing daily groundwater level forecasts with promising results chang et al 2016 applied narx models in combination with self organizing maps som for regional mean groundwater level forecasting in an alluvial fan in taiwan the main goal of this study is to examine the suitability of nonlinear autoregressive networks with exogenous input narx in short and mid term forecasting from one week up to six months of groundwater levels for three different types of aquifers namely porous fractured and karst aquifers additionally the effects of external influences like nearby groundwater extractions which are known to effect groundwater levels on forecasting performance is examined in advance all time series are decomposed to determine relevant neural network modelling parameters only few input parameters are used which are moreover widely and easily available thus the selected approach is relatively simple and easily transferrable on various observation wells with diverse characteristics therefore our approach is potentially applicable to any area with sufficient groundwater level precipitation and temperature data records and may help to derive water availability in drinking water supply and irrigation requirements for agriculture as well as to demarcate potential land subsidence zones due to extremely low groundwater levels associated with drought and or groundwater production in addition the delimitation of potential areas of exceptional high groundwater levels in the context of infrastructure buildings and agricultural land use and the development of appropriate prevention and adaptation strategies can be simplified furthermore this work combines stl time series decomposition with narx models in a novel way and applies this methodology to different aquifer types and wells with varying influences by external factors to forecast groundwater levels up to 26 weeks ahead 2 study area and materials all examined wells are located in southwest germany in the states of hesse baden wurttemberg and bavaria six wells have been chosen two for each investigated aquifer type porous fractured and karst one uninfluenced and one influenced by groundwater abstraction each an overview of all wells and their key features is given by table 1 fig 1 shows their locations for all wells except ka2 weekly groundwater level records were available as well as additional daily climate data for precipitation p and temperature t from nearby climate stations both input parameters are easily and widely available which is an essential requirement to develop a straightforward and easily transferable methodology additional information especially for locally influencing factors like water abstractions rates are often not available or only procurable with greater effort another problem arises when it comes to real forecasting because climate variables p t are usually forecasted by national meteorological services in adequate quality whereas other variables are not available for the future pa1 and pa2 are both located near the city of karlsruhe baden wurttemberg in the upper rhine graben urg a cenozoic continental rift structure which is more than 300 km long n s and on average 40 km wide e w geyer et al 2011 henningsen and katzung 2011 around karlsruhe the uppermost quaternary sediments show a thickness of about 50 m and consist of a mixture of sand and gravel from the black forest and from alpine areas ellwanger 2011 near the eastern urg boundary the mainly filled ancient river system of the kinzig murg rinne is located where fine grained sediments locally form hydraulically effective separation layers eisbacher and fielitz 2010 this causes partly confined conditions in the otherwise unconfined upper aquifer gudera 2007 both wells pa1 and pa2 are located in forest areas south of karlsruhe well pa1 is not influenced by any factors which are known to have an effect on groundwater levels like groundwater extraction or rivers this applies since the rhine river is situated about 6 km downstream which virtually eliminates the possibility of influencing water levels pa2 is located near a row of wells which have been in use for drinking water supply of the city of karlsruhe since the late 19th century the groundwater level is therefore strongly influenced by the groundwater extractions nearby weekly groundwater level records for both sites are available online using the free data and map service of the environmental state office of baden wurttemberg http udo lubw baden wuerttemberg de furthermore daily climate data precipitation and temperature of station 02522 were used which is provided free of charge by the german meteorological service dwd ftp ftp cdc dwd de pub cdc site fa1 is located near the city of bad hersfeld hesse in the middle of a small district called sorga the area is known as the fulda werra bergland which mainly consists of silicatic and sulfatic layers of the lower and middle buntsandstein lower triassic the lower buntsandstein layers form a fractured aquifer with low permeability whereas moderate permeabilities can be found in the middle buntsandstein faults and depressed rifts also cause local zones with high permeability in both the lower and middle buntsandstein lfu 2007a ludwig 2013 around fa1 rocks of the volpriehausen succession of the middle buntsandstein crop out bgr 2007 there are no known influences with an effect on groundwater levels for well fa1 site fa2 is located in rodenbach a municipality in the main kinzig district 20 km east of frankfurt am main the area is part of the mid german crystalline high which formed during the variscan orogeny devonian to permian the predominant rocks are granite and gneiss of the crystalline basement thews 1996 lfu 2007b they form a fractured aquifer with low permeability and water mostly flows through tension joints lfu 2007b occasionally local granular weathering rock covers which act as porous aquifers as well as slight covering by loess and other quaternary gravel and sands can be found lfu 2007b thews 1996 the predominant hydrogeological conditions are known as crystalline vorspessart with rotliegend of eastern wetterau hlnug 2017 lfu 2007b in the east and the south this area is overlain by a non conformable sedimentary cover of permian age lfu 2007b ludwig 2013 this cover also forms a fractured aquifer with higher permeabilities compared to the basement but often fractures are filled up with clayey weathering products ludwig 2013 well fa2 is located in the permian rotliegend overlain by a fluviatile sedimentary cover of the pleistocene bgr 2007 the groundwater level of well fa2 is most likely influenced by several factors this is assumed because the groundwater level records lack a typical annual periodicity and show therefore quite unusual water level fluctuations though no obvious measurement errors can be detected during the 1970 s several significant groundwater level lows can be observed which have ceased around 1990 this indicates most likely an influence of groundwater abstraction moreover fa2 is located in the middle of the village and is surrounded by private water extraction wells scattered within a radius of about 5 km as well as a waterworks of the kreiswerke main kinzig gmbh with a distance of little more than 2 km built around 1960 weekly groundwater level records for both wells fa1 and fa2 are available online using the free web service of the environmental state office of hesse gruschu hessen de also daily climate data precipitation and temperature of stations 2171 near fa1 and 2480 near fa2 were used which again are provided free of charge by the german meteorological service although sites ka1 and ka2 are separated by about 100 km both areas are hydrogeologically located in the late jurassic which is the largest karst aquifer in southwest germany in local lithostratigraphy the name malm denotes rocks of this time span limestone of late jurassic age is mostly micritic usually clayey to marly and alternating with layers of marlstone geyer et al 2011 around ka1 in the area of oberschwaben baden wurrtemberg the largest thickness of the malm reaches 500 m or more whereas around ka2 only thicknesses of 250 m or less are common geyer et al 2011 the groundwater level of well ka1 is presumed to be unaffected by external influences in contrast to the groundwater level of well ka2 which is used for groundwater extraction itself kgg 2012 the influence of the danube river which is only 2 km away from ka2 is probably weak especially compared to the water extraction in the well itself although it cannot be completely excluded the uppermost layers in the area of ka2 are already part of the south german molasse basin bgr 2007 but due to its depth 180 m b g the relevant aquifer is the malm karst aquifer gkd 2013 however studies in the region showed that there can be a vertical exchange between the shallow alluvial aquifer which is influenced by the danube river levels and the deep malm aquifer through the semi permeable molasse layers ohmer et al 2017 weekly groundwater level records for well ka1 are available online using the free data and map service of the lubw http udo lubw baden wuerttemberg de daily groundwater level records for well ka2 can be found free of charge using the web service of the gkd department of the environmental state office of bavaria http www gkd bayern de also daily climate data precipitation and temperature of stations 2074 near ka1 and 982 near ka2 were used which again are provided for free by the german meteorological service 3 methodology fig 2 summarizes the applied methodological approach of this study climate data namely precipitation p and temperature t were selected as input parameters and act as substitutes for groundwater recharge and evapotranspiration which should be important influencing parameters for groundwater levels though groundwater levels might also be influenced by other parameters or effects e g vertical interaction between aquifers and lateral inflow for uninfluenced wells as well as abstraction rates or water levels of nearby surface water for influenced wells those are either not monitored regularly or hard to measure at all therefore it should be examined if the applied approach of using only p and t as easily measurable input parameters is feasible and if the link between these parameters is strong enough to be captured by the neural network for not only uninfluenced but also influenced wells as well as for different aquifer types furthermore usually satisfactory historical records as well as relatively reliable forecasts by national weather services like the german meteorological service dwd are available in germany for p and t in the case of promising results this allows an application on real future data target data are always the respective groundwater level record data after gathering input and target data a specific dataset is created for each observation well this includes the aggregation of daily climate data to obtain weekly temporal resolution precipitation values are summed up weekly for temperature measurements the arithmetic mean is applied in case of ka2 gundremmingen daily groundwater level records were aggregated by selecting every seventh value to ensure comparability of the forecasting results the selected time spans of data for all observation wells and climate data sets are chosen to show only minor data gaps almost every gap concerns groundwater level time series because gaps were few and very small max 4 values missing values were interpolated linearly in case of missing precipitation values zero was assumed and temperature values were also interpolated the next sections explain the following steps shown in fig 2 and provide information on the theoretical background these steps include stl time series decomposition and determination of relevant modelling parameters id fd by cross and auto correlation of remainder time series as well as the narx training and forecasting procedure the complete workflow is also presented exemplary for one specific well at the beginning of section 4 3 1 artificial neural networks just like their biological role models anns consist of single neurons which are arranged and connected in a particular manner asce 2000 which is defined by their architecture during a learning process data is presented to the network and special training algorithms try to fit the target data by modifying the weights of the connections between the neurons simple predefined functions e g linear or sigmoid known as transfer functions determine the calculations which are performed within the neurons while processing the data the graded nonlinear response of sigmoid transfer functions enables the ann to capture nonlinear relationships within the training data samarasinghe 2006 a simple and most commonly used artificial neural network is the multi layer perceptron mlp which is assigned to the so called feedforward networks ffn such ffns are composed of several layers namely one input layer one to any number of hidden layers hl and one output layer a distinctive feature is that the arrangement of connections between the layers allows information flow only forward towards the output layer networks which use feedback connections enabling information flow lateral or backwards within the network are called recurrent neural networks rnn asce 2000 nonlinear autoregressive networks with exogenous input narx are a special type of rnns which use a global feedback connection between output and input layer fig 3a this makes them especially suitable for modelling nonlinear systems beale et al 2016 lin et al 1996 narx can be described as a combination of a neural network and a linear arx model autoregressive model with exogenous input which is a common tool for time series analysis beale et al 2016 the neural network in this case is used to enable the arx structure to capture nonlinearities izady et al 2013 in general narx converge faster and have better generalization ability than other recurrent networks lin et al 1998 which is related to the fact that they can keep information two to three times longer than standard recurrent neural networks lin et al 1996 they are often used for nonlinear time series prediction or nonlinear filtering tasks beale et al 2016 although rnns suffer from difficulties in mapping long term dependencies problem of vanishing gradients narx usually provide better results than conventional rnns lin et al 1995 1996 typically narx feed the output back towards the input layer samarasinghe 2006 hence the next output value is not only regressed on the independent input signals but also on the previous output signals moghaddamnia et al 2009 izady et al 2013 this is called closed loop setup and is normally used for multi step prediction fig 3 a beale et al 2016 to improve training results narx can be trained in an open loop setup fig 3b in this case the true output which is the observed target time series is presented as an input instead of feeding back the estimated output closed loop beale et al 2016 presenting the target instead of network outputs is more accurate makes training much more efficient and usually almost perfect training fit can be reached moghaddamnia et al 2009 another advantage is the standard feedforward architecture of the neural network without feedback connections which makes training simpler because learning algorithms do not have to be adjusted to the dynamic nature of the network beale et al 2016 typically narx are trained in open loop setup and are used in closed loop setup for multi step prediction tasks beale et al 2016 fig 3 shows that narx also contain delays for input input delays id and feedback time series feedback delays fd which serve as a short time memory within the network menezes and barreto 2008 these delays represent vectors which every signal must pass through thus each signal passing the delays is available as an input to the following unit for as many time steps equal to the length of the vector beale et al 2016 determining input and feedback delays is sometimes crucial in this study time series decomposition and correlation functions were applied to specify significant delays the levenberg marquardt lm training algorithm was chosen to train the narx in open loop setup lm is a fast and reliable second order local method adamowski and chan 2011 which combines advantages of steepest descent first order and gauss newton second order methods samarasinghe 2006 this results in higher calculation speed than the former and improved stability compared to the latter samarasinghe 2006 its general weight update for epoch n 1 can be expressed by yu and wilamowski 2011 1 w n 1 w n h n λ i 1 j n r n it applies that w is the weight vector n the epoch h stands for hessian matrix λ is a variable scalar i is the identity matrix j represents the jacobian matrix and r is the residual error vector the use of the jacobian matrix as well as the diagonal term λi which guarantees the hessian matrix to be positive definite reduces computational costs significantly compared to other second order methods yu and wilamowski 2011 further many authors applied the lm algorithm successfully for ann training in hydrological forecasting e g maier and dandy 1998 2000 daliakopoulos et al 2005 coulibaly et al 2000a b 2001a b to determine narx structure the training procedure is repeated several times on models with different numbers of hidden neurons the maximum number of hidden neurons hn which was tested is given by eq 2 wanas et al 1998 and depends on the number of training samples available n 2 hn log n matlab neural network toolbox mathworks inc 2016 was used to create and simulate narx models 3 2 time series decomposition determining delay vectors for input and feedback is crucial for narx performance ideally delays include all significant lags and are as small as possible to minimize network size avoiding decreased calculation speed higher tendency for overfitting and additional minima on the error surface maier et al 2010 therefore input and target time series were decomposed using the stl algorithm seasonal trend decomposition procedure based on loess cleveland et al 1990 decomposition is necessary to minimize influence of trend and seasonal component on auto and cross correlations of input and target time series since time series with similar trend and periodicity are highly auto correlated and thus tend to show strong cross correlations yule 1926 granger and newbold 1974 aldrich 1995 after removing trend and seasonal components from the original time series the resulting component is called remainder investigating detrended and deseasonalized remainders helps to detect anomalous signals which are of particular interest in terms of cross correlations liesch and ohmer 2016 the loess window sizes for seasonal and trend extraction are chosen to remove auto correlation in the remainder time series especially for groundwater level records this can often only be achieved by removing almost the whole signal which is undesirable however auto correlations of remainder time series were minimized to achieve auto correlation of nearest past lags only by auto correlating the remainders of the target time series and also cross correlating them with each input time series remainders significant lags are detected the time series decomposition was done using the r software r development core team 2017 3 3 validation modified out of sample oos evaluation namely on rolling basis was chosen for this study bergmeir and benítez 2012 out of sample evaluation is common practice in time series forecasting but it only uses one part of the data for evaluation and also errors are computed only once in standard oos the last part of the time series approx 10 15 is left out in the training dataset and is used to test the generalization ability of the network bergmeir and benítez 2012 maier et al 2010 to reduce error variance by using oos on rolling basis the error is calculated on several parts of the data with a rolling origin of the test dataset in this study at least the first half of the original data was used for model building while the next 10 served as test set for error calculation in the following the test set was incorporated into the training data and the next 10 became the new test set until 90 of the original data was used for training each time the model was completely built anew to avoid double usage of data for training and testing purposes thus overall the error was calculated five times on five differing parts of the data and subsequently simply averaged bergmeir and benítez 2012 bergmeir et al 2014 this procedure was repeated for several numbers of neurons in the hidden layer and the hidden layer size with the best validation performance was chosen to perform forecasts it is worth to notice that for model building the training data set is additionally divided into three subsets which enables the software to perform early stopping during the open loop training and thus to effectively avoid overfitting 3 4 performance criteria to evaluate observed against predicted values several error indices were used coefficient of determination r2 root mean squared error rmse relative root mean squared error rmser and the nash sutcliffe criterion nash the coefficient of determination investigates the correlation between predicted and observed values it ranges from zero to one with one showing a perfect fit and zero indicating no statistical correlation r2 is defined as the squared value of the bravais pearson correlation coefficient and is calculated according to eq 3 krause et al 2005 it applies that o i is the observed value o the mean of the observed values p i the forecasted value p the mean of the forecasted values and n the number of samples available 3 r 2 i 1 n o i o p i p i 1 n o i o 2 i 1 n p i p 2 2 the root mean squared error calculates the error variance independently from sample size relative rmse helps to assess absolute rmse values and makes comparison of different wells easier values as low as possible are best for rmse and rmser which are given by khalil et al 2015 4 rmse i 1 n o i p i 2 n 5 rmser i 1 n o i p i o i 2 n 100 the nash sutcliffe criterion nash is well established in estimating forecast accuracy of hydrological models krause et al 2005 nash ranges from to 1 perfect fit with values below zero indicating that the mean observed value is a better predictor than the forecasting model krause et al 2005 it is calculated as follows bennett et al 2013 6 nash 1 1 n i 1 n o i p i 2 1 m i 1 m o i o 2 note that for the calculation of the denominator in eq 6 the complete time series of length m has been used not only the n samples of the according prediction time span this reduces information loss and represents more adequately the variance of the whole data set 4 results and discussion table 2 summarizes modelling parameters of the best performing narx models for each observation well as well as corresponding oos validation error values section 3 3 all best performing models were selected by comparing their unique combination of calculated error values parallel to a visual evaluation of the corresponding graphs it turned out that lowest rmse rmser and highest nash values mostly occurred together for a specific hidden layer size whereas the best r2 value did not follow this pattern strictly model selection was therefore mainly but not exclusively based on rmse r and nash values this applies for example for well pa1 where the selected model exceptionally even has the lowest r2 value overall it was decided on a case by case basis which model was considered the best performing one all selected site specific models were subsequently used to perform forecasts 1 4 12 and 26 steps ahead the investigated prediction periods are randomly selected by simply corresponding to the end of the data set of the respective well the corresponding error measure results are presented in table 3 all results are discussed in detail in the following sections 4 1 porous aquifer the methodological approach shown and explained in fig 2 and section 3 is illustrated exemplary in the following for porous aquifer well pa1 the procedure is analogous for every observation well examined in this study fig 4 shows the stl decomposition for groundwater level gwl fig 4a precipitation p fig 4b and temperature t fig 4c from top to bottom the original time series seasonal component trend component and remainders are displayed in each diagram key parameters for applying the stl algorithm are the spans in lags of the loess windows for seasonal and trend extraction for seasonal extraction the span of 52 lags equals one year was selected whereas the span for trend extraction was modified in a way that the auto correlation of the remainder time series was as small as possible fig 4d shows the auto correlation function of the gwl remainder fig 4e the p gwl remainder cross correlation and fig 4f the t gwl remainder cross correlation based on these diagrams feedback delays were determined to be a vector of 1 to 5 fd 1 5 and input delays a vector of 1 to 3 id 1 3 selection of significant input lags for pa1 is mainly based on p gwl cross correlation because t gwl cross correlation does not reveal significant lags anyway this does not allow conclusions to be drawn regarding the suitability of t as input parameter since the omission of t significantly worsens training fit and forecasting accuracy the stl decomposition and correlation function diagrams of every single observation well dataset can be found in the electronic supplementary material of this study esm the best oos validation result for well pa1 was found using four hidden neurons in fig 5 the dependency of calculated oos validation error results on the size of the hidden layer is exemplary shown for well pa1 the exact error values for oos validation with four hidden neurons can be found in table 2 as fig 5 illustrates it is important to consider all error indices for model selection at once high coefficients of determination are not necessarily accompanied by low root mean squared errors or high nash sutcliffe values in this case the best performing model even shows the lowest of all r2 values other hidden layer sizes with promising error values partly showed pointless oscillations or were discarded due to partly strong deviations fig 6 shows the oos validation procedure on rolling basis for a narx model with four hidden neurons using pa1 data as already explained section 3 3 at least 50 of the dataset is used for model building the following 10 steps of data serve for error calculation it is meaningless to investigate or even calculate error values for the model building part of the time series as it is common practice for other types of anns e g mlp due to the open loop setup for optimized training the green curve in fig 6 almost perfectly fits the observed data blue therefore the errors table 2 are calculated and averaged on the red curve sections of fig 6 according to the oos validation procedure overall the predicted values red fit the target data blue dashed fairly good especially considering the length of the tested intervals which include several years this timespan exceeds usual groundwater forecasting periods by a multiple the figures corresponding to fig 6 for all other observations wells listed in table 2 can be found in the electronic esm a detailed investigation of the oos validation sections shown in fig 6 is presented in fig 7 for each section both observed and predicted data and their residuals are displayed as well as the associated scatter plot it is obvious that the residuals are biased by showing mean values above or below zero however the selected oos validation procedure which includes several retraining steps for each new section makes the bias difficult to assess because every retraining changes the model and thus also changes the bias in amount and or algebraic signs the oos procedure thus is more an assessment of the potential power of the architecture and the structure of the narx model than it is an assessment of a very specific already trained model residual means for well pa1 range between 0 0425 first oos section and 0 2608 third oos section which is acceptably low considering the overall variation of pa1 which is more than 2 m for all five sections significant auto correlation of the residuals can be observed which means that the model still shows clear scope for improvement this was to be expected as the chosen approach with its limited number of input parameters still provides room for improvement hence this demonstrates that the potential power of the approach is limited even when good fit is reached for a certain period the scatterplots clearly illustrate that the narx model underestimates high groundwater levels overestimates low ones and therefore has some shortcomings in predicting extreme events however the length of the oos sections which exceed common prediction timespan lengths by a multiple again relativizes these findings a real assessment of the model strength for shorter prediction periods needs to be assessed separately which is therefore done in the following figures analogously to fig 7 for all other wells can be found in the esm the selected narx model is used to perform groundwater level forecasting for lead times lt of 1 week 1 month 4 weeks 3 months 12 weeks and half a year 26 weeks the results are shown in table 3 and fig 8 no coefficient of determination can be computed for lead time 1 because it is only a one step ahead prediction the remaining r2 values and the nash sutcliffe coefficients express that the predicted values fit the target data quite well the root mean squared errors show the high quality of the forecast although an overestimation for longer lead times lt 26 can be detected in fig 8 also indicated by a lower corresponding nash value it can also be seen that even the trend reversal of may 2008 which is assumed to be caused by simple yearly periodicity can be reproduced for well pa2 karlsruhe a narx model with seven hidden neurons input delays 1 4 and feedback delays 1 7 was selected based on the oos validation procedure the oos validation procedure can be reconstructed using the detailed graphs in the electronic supplementary material best oos validation results can be found in table 2 table 3 and fig 9 present the short and mid term forecasting results forecast accuracy for small lead times is acceptable fig 9a and b but gets worse for longer lt fig 9c and d this is expressed best by increasing rmse r values and by the corresponding prediction graphs even though the model shows high correlations for lt 12 and 26 the groundwater trend is clearly underestimated this is plausible because pa2 is strongly influenced by nearby groundwater extractions which have not been used to forecast groundwater levels for two reasons first for real forecasts no future groundwater extraction data would be available and second robustness of narx against such influences should be tested narx obviously are not able to compensate this external groundwater extraction by using only precipitation and temperature as input parameters high nash sutcliffe coefficients for all lead times can be explained by the total groundwater level range of pa2 which is about 4 5 m and the low overall time series data mean value of about 110 3 m asl especially the latter is responsible for high nash values comp eq 6 of the investigated sections considering the results of both wells pa1 and pa2 of the porous aquifer the forecasts seem to be promising for uninfluenced wells strongly influenced wells should be avoided in applying forecasts using only p and t as predictors for both observations wells pa1 and pa2 the root mean squared error seems most reliable to evaluate short term forecast accuracy the longer the lead times the more meaningful the coefficient of determination and the nash sutcliffe criterion all should be considered in combination with each other especially for lt 12 and lt 26 additional visual evaluation of the graphs is necessary to ensure adequate judgement of forecast accuracy 4 2 fractured aquifer for fractured aquifer and uninfluenced well fa1 sorga a narx model with two hidden neurons input delays 1 4 and feedback delays 1 6 was selected tab 2 and again the oos validation procedure of the selected model can be followed using the detailed graphs in the esm the gwl curve shows an almost linear downtrend during 2015 fig 10 such linear trends occur regularly during spring and summer and seem to be characteristic for well fa1 r2 improves for longer lead times probably because the overall downtrend is captured accurately table 3 variations seem to be more difficult to predict as the peak of the target data in dec 15 jan 16 shows fig 10 again high nash values imply very good fit of the forecasts for influenced fractured aquifer well fa2 niederrodenbach a narx model with eight hidden neurons input delays 1 7 and feedback delays 1 7 was applied table 2 as with all other wells the oos validation procedure and more information on the model power can be found using the detailed graphs in the esm forecasting results can be found in table 3 and fig 11 again the results are promising and the overall prediction target tendency is captured error indices consistently show very good values and are close to the results of uninfluenced well fa1 anyway it should be noted that the yearly variation of the groundwater level for fa1 in fig 11 is almost double the fa2 variation in fig 10 but the overall time series data variation differs only little again the root mean squared error seems most informative for smaller lead times the longer the lead times the more important the coefficient of determination gets for evaluation of accuracy the nash sutcliffe criterion values seem to give a more general description of the predictive power of the model the good forecast accuracy of fa2 may result because external influences are not as distinct as they are for pa2 and ka2 which both are located directly next to water extractions here the influence seems to be on a larger scale concerning more the overall water balance than local groundwater levels further investigations are necessary to draw more detailed conclusions and maybe to identify some grade of influence on which narx models begin to fail 4 3 karst aquifer a narx model with hidden layer size 3 input delays 1 6 and feedback delays 1 7 was found to be most suitable for forecasting groundwater levels of uninfluenced karst aquifer well ka1 neufra table 2 to follow the oos validation process please check the detailed graphs in the esm compared to the examined wells in porous and fractured aquifers the groundwater level variation is about four times higher still forecast errors indicate high accuracy tab 3 which is verified by the red prediction curves in fig 12 even though the absolute rmse seems high compared to pa1 pa2 fa1 and fa2 the very low rmser better describes the forecast accuracy it is not clear if the model seems to overestimate prediction values for longer lead times because the deviation consistently occurs during around the turn of the year 2015 2016 the deviation could also be due to an incorrectly captured relationship between input and output variables nevertheless the model still yields highly acceptable forecasts the low r2 value for lt 12 demonstrates a weakness of this specific error index which shows an extremely low value due to opposing trends in between the single data points of the predicted data compared to the observed data the high nash values 0 96 for all lead times more adequately represent the predictive power of the narx model for well ka2 gundremmingen a narx model with two hidden neurons input delays 1 2 and feedback delays 1 1 was selected for insights into the oos validation procedure and more detailed information regarding the model power the graphs in the esm can be addressed feedback delays are at minimum value because no relationship was detected of successive groundwater level values by auto correlating the gwl remainder time series accordingly forecast results do not seem to be reasonable table 3 fig 13 this agrees with results of pa2 forecasting where strong external influences groundwater extractions also prevented good generalization ability although forecasting one week results in good accuracy it can be seen that with increasing lead time the ka2 narx model does not reproduce any variations or trends more or less an average value is produced which explains relative low rmse and rmser as well as the decreasing nash values this coincides with the auto and cross correlation analyses which have been performed earlier none of them revealed statistically significant lags the good results for lt 1 thus may also be coincidence it is obvious that in general without additional visual evaluation of the graphs no robust judgement of forecast accuracy can be made by simply assessing the error indices furthermore only few years were available for training due to its properties it might be doubted though that longer records would improve accuracy significantly further due to a lack of data regarding flow rates or water levels of the danube river it remains unclear which external factors contribute to the water levels of ka2 to which extent 4 4 comparative discussion other authors e g coulibaly et al 2001a daliakopoulos et al 2005 lallahem et al 2005 nayak et al 2006 mohammadi 2008 sreekanth et al 2009 yoon et al 2011 adamowski and chan 2011 trichakis et al 2011 taormina et al 2012 chitsazan et al 2015 khalil et al 2015 chang et al 2016 also found that artificial neural networks in general are exceptionally well suited to predict groundwater levels for different geological settings the particular suitability of narx for groundwater prediction in porous aquifers which was also found by izady et al 2013 and guzman et al 2017 can be confirmed by the results of this study additionally also for fractured and karstic environments promising results were obtained several authors stated that it is even possible to reproduce complicated scenarios like transient groundwater level conditions in a complex multi layered groundwater system e g coppola et al 2003 the more complex the scenario the more input parameters were used to reach sufficient forecast accuracy such complex scenarios correspond with the so called influenced wells of this study the inclusion of additional information like pumping rates from wells nearby or water levels of surrounding observation wells may improve forecast accuracy substantially but also would mean a multiple effort in advance of applying the method this shows the limits as well the advantages of the applied approach which only uses easily and widely available data and is therefore relatively easy to apply on uninfluenced wells in a variety of hydrogeolocigal conditions 5 conclusions the suitability of nonlinear autoregressive networks with exogenous input narx in short and mid term forecasting from one day up to six months of groundwater levels for three different types of aquifers namely porous fractured and karst aquifers has been examined in this study additionally the effects of external influences on forecasting performance which are known to cause groundwater level variations were investigated the study area is located in southwest germany in the states of hesse baden wurttemberg and bavaria six observation wells have been chosen two for each investigated aquifer type one uninfluenced and one influenced each fundamental assumption of the approach is that the dynamics of the wells to be investigated are strongly influenced by groundwater recharge and evapotranspiration the widely and easily available climatic parameters temperature and precipitation were selected as substitutes for these parameters and served as input to the narx models which makes the method simply transferable to almost every area this advantage is at the same time a clear limitation since the inclusion of further input parameters in terms of transferability and applicability is not reasonable thus only selected wells are suited for the application of our approach all input and target time series were decomposed using the stl algorithm to detect significant time lags and determine input and feedback delays needed for narx application a modified out of sample validation on rolling basis approach was applied to evaluate the performance this evaluation method is necessary due to the inherent properties of narx but still has scope for improvement since repeated retraining steps make the evaluation of the model power difficult compared to the results of studies using ann architectures other than narx e g daliakopoulos et al 2005 lallahem 2005 adamowski and chan 2011 khalil et al 2015 the results of this study show that narx are remarkably well suited to perform groundwater predictions for uninfluenced observation wells in all aquifer types even though the number of input parameters is limited furthermore the method is easily applicable due to its simple input parameters however the results for influenced observation wells are not quite as clear by using only two climatic input parameters p t narx models are not capable of adequately mapping groundwater levels if strong external influencing factors are reflected in the characteristics of a hydrograph this applies in particular to porous and karst aquifers where strong forecast deviations can be observed especially for longer lead times on the other hand in fractured aquifer observation wells reliable results were also obtained for an influenced well but at the same time this was influenced to a lesser extent the inclusion of additional inputs can considerably improve the forecast accuracy but also leads to a higher effort in the application of the method and would contradict the goal of developing an easily transferable methodology by including only data that are widely available in order to draw more detailed conclusions further investigations on additional wells in all aquifer types especially in fractured media must be carried out this can also help to distinguish more sharply whether a well has to be classified as influenced or not and whether the methodology can be applied the oos validation process shows that all models are biased and have auto correlated residuals which makes it clear that the models still need to be adjusted and can be significantly improved the root mean squared error seems to be the most suitable error index to evaluate forecast accuracy the longer the lead times the more important the coefficient of determination gets both should be considered in combination with each other for longer lead times 3 months the nash sutcliffe criterion appears to be a good indicator in terms of model selection but does not provide detailed information when it comes to accuracy evaluation issues on a high resolution level nevertheless it gives a more general insight in the predictive power of the model acknowledgement we would like to thank the reviewers for their useful comments that helped to improve the paper appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j jhydrol 2018 01 045 appendix a supplementary data supplementary figure 1 detailed evaluation of oos validation sections for well fa1 supplementary figure 10 training and out of sample validation procedure on rolling basis for well pa2 using narx with seven hidden nodes training green is performed open loop testing is performed in closed loop setup errors are averaged on all test sections red to obtain overall errors supplementary figure 11 stl decomposition for groundwater level a precipitation b and temperature c of well fa1 from top to bottom the original time series seasonal component trend component and remainders are displayed further the auto correlation function of the gwlremainder d cross correlation of p remainder and gwl remainder e and cross correlation of t remainder and gwl remainder f time series are shown the blue dashed line indicates the confidence limit supplementary figure 12 stl decomposition for groundwater level a precipitation b and temperature c of well fa2 from top to bottom the original time series seasonal component trend component and remainders are displayed further the auto correlation function of the gwlremainder d cross correlation of p remainder and gwl remainder e and cross correlation of t remainder and gwl remainder f time series are shown the blue dashed line indicates the confidence limit supplementary figure 13 stl decomposition for groundwater level a precipitation b and temperature c of well ka1 from top to bottom the original time series seasonal component trend component and remainders are displayed further the auto correlation function of the gwlremainder d cross correlation of p remainder and gwl remainder e and cross correlation of t remainder and gwl remainder f time series are shown the blue dashed line indicates the confidence limit supplementary figure 14 stl decomposition for groundwater level a precipitation b and temperature c of well ka2 from top to bottom the original time series seasonal component trend component and remainders are displayed further the auto correlation function of the gwlremainder d cross correlation of p remainder and gwl remainder e and cross correlation of t remainder and gwl remainder f time series are shown the blue dashed line indicates the confidence limit supplementary figure 15 stl decomposition for groundwater level a precipitation b and temperature c of well pa2 from top to bottom the original time series seasonal component trend component and remainders are displayed further the auto correlation function of the gwlremainder d cross correlation of p remainder and gwl remainder e and cross correlation of t remainder and gwl remainder f time series are shown the blue dashed line indicates the confidence limit supplementary figure 2 detailed evaluation of oos validation sections for well fa2 supplementary figure 3 detailed evaluation of oos validation sections for well ka1 supplementary figure 4 detailed evaluation of oos validation sections for well ka2 supplementary figure 5 detailed evaluation of oos validation sections for well pa2 supplementary figure 6 training and out of sample validation procedure on rolling basis for well fa1 using narx with two hidden nodes training green is performed open loop testing is performed in closed loop setup errors are averaged on all test sections red to obtain overall errors supplementary figure 7 training and out of sample validation procedure on rolling basis for well fa2 using narx with eight hidden nodes training green is performed open loop testing is performed in closed loop setup errors are averaged on all test sections red to obtain overall errors supplementary figure 8 training and out of sample validation procedure on rolling basis for well ka1 using narx with three hidden nodes training green is performed open loop testing is performed in closed loop setup errors are averaged on all test sections red to obtain overall errors supplementary figure 9 training and out of sample validation procedure on rolling basis for well ka2 using narx with two hidden nodes training green is performed open loop testing is performed in closed loop setup errors are averaged on all test sections red to obtain overall errors 
6918,while the application of neural networks for groundwater level forecasting in general has been investigated by many authors the use of nonlinear autoregressive networks with exogenous inputs narx is relatively new for this work narx were applied to obtain groundwater level forecasts for several wells in southwest germany wells in porous fractured and karst aquifers were investigated and forecasts of lead times up to half a year were conducted for both influenced e g nearby pumping and uninfluenced wells precipitation and temperature were chosen as predictors which makes the selected approach easily transferable since both parameters are widely available and simple to measure input and feedback delays were determined by applying stl time series decomposition on the data and using auto and cross correlation functions on the remainders to determine significant time lags coefficient of determination relative root mean squared error and nash sutcliffe efficiency were used to evaluate forecasts the model selection was based on an out of sample validation on rolling basis the results are promising and indicate an outstanding suitability of narx for groundwater level predictions with such a small set of inputs in all three aquifer types keywords groundwater levels forecasting neural networks narx germany 1 introduction groundwater is a vital resource and an important source of freshwater worldwide it is generally cleaner and more readily available than other drinking water resources and more than 2 billion people depend on groundwater for drinking water supplies mackay et al 2015 morris et al 2003 it is therefore essential to develop sustainable water resources management measures to ensure drinking water supply within a region accurate and reliable forecasts of groundwater levels play a decisive role as these forecasts provide essential information about the quantitative groundwater conditions of an aquifer in addition to the importance for drinking water supply further applications for groundwater level predictions are conceivable this includes planning groundwater extractions for industrial purposes such as cooling or agricultural irrigation guzman et al 2017 barzegar et al 2017 as well as the use as a raw material for the food industry moreover sensitive ecosystems such as wetlands can be protected and the risk and impact of groundwater extremes such as subsidence or groundwater flooding can be reduced mackay et al 2015 kisi et al 2017 common practice in modelling groundwater variables is the application of numerical models which use physical relationships to describe a certain area asce 2000 these kinds of models require lots of data and the development application and maintenance is time consuming and expensive e g anderson et al 2015 bear and cheng 2010 however artificial neural networks anns are an alternative data driven approach which has been widely used for forecasting water resource variables within the last decade e g maier et al 2010 they imitate the behaviour of the human brain and are able to learn relationships between variables by applying special training algorithms on available data this ability makes anns a valuable tool for studying complex scenarios which are difficult to describe with conventional methods especially if the outcome is more important than an exact understanding of the involved processes or if only few system knowledge exists daliakopoulos et al 2005 samarasinghe 2006 the ability to capture system dynamics and nonlinearities makes anns exceptionally adequate for the investigation of hydrological systems which usually have distinctive spatio temporal variabilities asce 2000 although various model architectures are used extensively in hydrology maier et al 2010 feedforward and recurrent networks are the most common asce 2000 anns have been applied in a large number of studies focused on the prediction of water resource variables e g discharge or water level in river systems maier et al 2010 also a significant number of studies used anns to predict groundwater levels e g coulibaly et al 2001a coppola et al 2003 daliakopoulos et al 2005 lallahem et al 2005 nayak et al 2006 mohammadi 2008 sreekanth et al 2009 yoon et al 2011 adamowski and chan 2011 trichakis et al 2011 taormina et al 2012 chitsazan et al 2015 jha and sahoo 2015 khalil et al 2015 chang et al 2016 sahoo et al 2017 gorgij et al 2017 kisi et al 2017 barzegar et al 2017 most authors used feedforward networks whereas the use of narx models for groundwater level prediction e g izady et al 2013 chang et al 2016 guzman et al 2017 is not very common izady et al 2013 investigated feedforward network and narx performance for groundwater level prediction in an alluvial plain in iran by comparing validation period results they found a clear superiority of narx compared to static neural networks guzman et al 2017 used narx models to investigate an alluvial aquifer in the usa and compared different training algorithms for performing daily groundwater level forecasts with promising results chang et al 2016 applied narx models in combination with self organizing maps som for regional mean groundwater level forecasting in an alluvial fan in taiwan the main goal of this study is to examine the suitability of nonlinear autoregressive networks with exogenous input narx in short and mid term forecasting from one week up to six months of groundwater levels for three different types of aquifers namely porous fractured and karst aquifers additionally the effects of external influences like nearby groundwater extractions which are known to effect groundwater levels on forecasting performance is examined in advance all time series are decomposed to determine relevant neural network modelling parameters only few input parameters are used which are moreover widely and easily available thus the selected approach is relatively simple and easily transferrable on various observation wells with diverse characteristics therefore our approach is potentially applicable to any area with sufficient groundwater level precipitation and temperature data records and may help to derive water availability in drinking water supply and irrigation requirements for agriculture as well as to demarcate potential land subsidence zones due to extremely low groundwater levels associated with drought and or groundwater production in addition the delimitation of potential areas of exceptional high groundwater levels in the context of infrastructure buildings and agricultural land use and the development of appropriate prevention and adaptation strategies can be simplified furthermore this work combines stl time series decomposition with narx models in a novel way and applies this methodology to different aquifer types and wells with varying influences by external factors to forecast groundwater levels up to 26 weeks ahead 2 study area and materials all examined wells are located in southwest germany in the states of hesse baden wurttemberg and bavaria six wells have been chosen two for each investigated aquifer type porous fractured and karst one uninfluenced and one influenced by groundwater abstraction each an overview of all wells and their key features is given by table 1 fig 1 shows their locations for all wells except ka2 weekly groundwater level records were available as well as additional daily climate data for precipitation p and temperature t from nearby climate stations both input parameters are easily and widely available which is an essential requirement to develop a straightforward and easily transferable methodology additional information especially for locally influencing factors like water abstractions rates are often not available or only procurable with greater effort another problem arises when it comes to real forecasting because climate variables p t are usually forecasted by national meteorological services in adequate quality whereas other variables are not available for the future pa1 and pa2 are both located near the city of karlsruhe baden wurttemberg in the upper rhine graben urg a cenozoic continental rift structure which is more than 300 km long n s and on average 40 km wide e w geyer et al 2011 henningsen and katzung 2011 around karlsruhe the uppermost quaternary sediments show a thickness of about 50 m and consist of a mixture of sand and gravel from the black forest and from alpine areas ellwanger 2011 near the eastern urg boundary the mainly filled ancient river system of the kinzig murg rinne is located where fine grained sediments locally form hydraulically effective separation layers eisbacher and fielitz 2010 this causes partly confined conditions in the otherwise unconfined upper aquifer gudera 2007 both wells pa1 and pa2 are located in forest areas south of karlsruhe well pa1 is not influenced by any factors which are known to have an effect on groundwater levels like groundwater extraction or rivers this applies since the rhine river is situated about 6 km downstream which virtually eliminates the possibility of influencing water levels pa2 is located near a row of wells which have been in use for drinking water supply of the city of karlsruhe since the late 19th century the groundwater level is therefore strongly influenced by the groundwater extractions nearby weekly groundwater level records for both sites are available online using the free data and map service of the environmental state office of baden wurttemberg http udo lubw baden wuerttemberg de furthermore daily climate data precipitation and temperature of station 02522 were used which is provided free of charge by the german meteorological service dwd ftp ftp cdc dwd de pub cdc site fa1 is located near the city of bad hersfeld hesse in the middle of a small district called sorga the area is known as the fulda werra bergland which mainly consists of silicatic and sulfatic layers of the lower and middle buntsandstein lower triassic the lower buntsandstein layers form a fractured aquifer with low permeability whereas moderate permeabilities can be found in the middle buntsandstein faults and depressed rifts also cause local zones with high permeability in both the lower and middle buntsandstein lfu 2007a ludwig 2013 around fa1 rocks of the volpriehausen succession of the middle buntsandstein crop out bgr 2007 there are no known influences with an effect on groundwater levels for well fa1 site fa2 is located in rodenbach a municipality in the main kinzig district 20 km east of frankfurt am main the area is part of the mid german crystalline high which formed during the variscan orogeny devonian to permian the predominant rocks are granite and gneiss of the crystalline basement thews 1996 lfu 2007b they form a fractured aquifer with low permeability and water mostly flows through tension joints lfu 2007b occasionally local granular weathering rock covers which act as porous aquifers as well as slight covering by loess and other quaternary gravel and sands can be found lfu 2007b thews 1996 the predominant hydrogeological conditions are known as crystalline vorspessart with rotliegend of eastern wetterau hlnug 2017 lfu 2007b in the east and the south this area is overlain by a non conformable sedimentary cover of permian age lfu 2007b ludwig 2013 this cover also forms a fractured aquifer with higher permeabilities compared to the basement but often fractures are filled up with clayey weathering products ludwig 2013 well fa2 is located in the permian rotliegend overlain by a fluviatile sedimentary cover of the pleistocene bgr 2007 the groundwater level of well fa2 is most likely influenced by several factors this is assumed because the groundwater level records lack a typical annual periodicity and show therefore quite unusual water level fluctuations though no obvious measurement errors can be detected during the 1970 s several significant groundwater level lows can be observed which have ceased around 1990 this indicates most likely an influence of groundwater abstraction moreover fa2 is located in the middle of the village and is surrounded by private water extraction wells scattered within a radius of about 5 km as well as a waterworks of the kreiswerke main kinzig gmbh with a distance of little more than 2 km built around 1960 weekly groundwater level records for both wells fa1 and fa2 are available online using the free web service of the environmental state office of hesse gruschu hessen de also daily climate data precipitation and temperature of stations 2171 near fa1 and 2480 near fa2 were used which again are provided free of charge by the german meteorological service although sites ka1 and ka2 are separated by about 100 km both areas are hydrogeologically located in the late jurassic which is the largest karst aquifer in southwest germany in local lithostratigraphy the name malm denotes rocks of this time span limestone of late jurassic age is mostly micritic usually clayey to marly and alternating with layers of marlstone geyer et al 2011 around ka1 in the area of oberschwaben baden wurrtemberg the largest thickness of the malm reaches 500 m or more whereas around ka2 only thicknesses of 250 m or less are common geyer et al 2011 the groundwater level of well ka1 is presumed to be unaffected by external influences in contrast to the groundwater level of well ka2 which is used for groundwater extraction itself kgg 2012 the influence of the danube river which is only 2 km away from ka2 is probably weak especially compared to the water extraction in the well itself although it cannot be completely excluded the uppermost layers in the area of ka2 are already part of the south german molasse basin bgr 2007 but due to its depth 180 m b g the relevant aquifer is the malm karst aquifer gkd 2013 however studies in the region showed that there can be a vertical exchange between the shallow alluvial aquifer which is influenced by the danube river levels and the deep malm aquifer through the semi permeable molasse layers ohmer et al 2017 weekly groundwater level records for well ka1 are available online using the free data and map service of the lubw http udo lubw baden wuerttemberg de daily groundwater level records for well ka2 can be found free of charge using the web service of the gkd department of the environmental state office of bavaria http www gkd bayern de also daily climate data precipitation and temperature of stations 2074 near ka1 and 982 near ka2 were used which again are provided for free by the german meteorological service 3 methodology fig 2 summarizes the applied methodological approach of this study climate data namely precipitation p and temperature t were selected as input parameters and act as substitutes for groundwater recharge and evapotranspiration which should be important influencing parameters for groundwater levels though groundwater levels might also be influenced by other parameters or effects e g vertical interaction between aquifers and lateral inflow for uninfluenced wells as well as abstraction rates or water levels of nearby surface water for influenced wells those are either not monitored regularly or hard to measure at all therefore it should be examined if the applied approach of using only p and t as easily measurable input parameters is feasible and if the link between these parameters is strong enough to be captured by the neural network for not only uninfluenced but also influenced wells as well as for different aquifer types furthermore usually satisfactory historical records as well as relatively reliable forecasts by national weather services like the german meteorological service dwd are available in germany for p and t in the case of promising results this allows an application on real future data target data are always the respective groundwater level record data after gathering input and target data a specific dataset is created for each observation well this includes the aggregation of daily climate data to obtain weekly temporal resolution precipitation values are summed up weekly for temperature measurements the arithmetic mean is applied in case of ka2 gundremmingen daily groundwater level records were aggregated by selecting every seventh value to ensure comparability of the forecasting results the selected time spans of data for all observation wells and climate data sets are chosen to show only minor data gaps almost every gap concerns groundwater level time series because gaps were few and very small max 4 values missing values were interpolated linearly in case of missing precipitation values zero was assumed and temperature values were also interpolated the next sections explain the following steps shown in fig 2 and provide information on the theoretical background these steps include stl time series decomposition and determination of relevant modelling parameters id fd by cross and auto correlation of remainder time series as well as the narx training and forecasting procedure the complete workflow is also presented exemplary for one specific well at the beginning of section 4 3 1 artificial neural networks just like their biological role models anns consist of single neurons which are arranged and connected in a particular manner asce 2000 which is defined by their architecture during a learning process data is presented to the network and special training algorithms try to fit the target data by modifying the weights of the connections between the neurons simple predefined functions e g linear or sigmoid known as transfer functions determine the calculations which are performed within the neurons while processing the data the graded nonlinear response of sigmoid transfer functions enables the ann to capture nonlinear relationships within the training data samarasinghe 2006 a simple and most commonly used artificial neural network is the multi layer perceptron mlp which is assigned to the so called feedforward networks ffn such ffns are composed of several layers namely one input layer one to any number of hidden layers hl and one output layer a distinctive feature is that the arrangement of connections between the layers allows information flow only forward towards the output layer networks which use feedback connections enabling information flow lateral or backwards within the network are called recurrent neural networks rnn asce 2000 nonlinear autoregressive networks with exogenous input narx are a special type of rnns which use a global feedback connection between output and input layer fig 3a this makes them especially suitable for modelling nonlinear systems beale et al 2016 lin et al 1996 narx can be described as a combination of a neural network and a linear arx model autoregressive model with exogenous input which is a common tool for time series analysis beale et al 2016 the neural network in this case is used to enable the arx structure to capture nonlinearities izady et al 2013 in general narx converge faster and have better generalization ability than other recurrent networks lin et al 1998 which is related to the fact that they can keep information two to three times longer than standard recurrent neural networks lin et al 1996 they are often used for nonlinear time series prediction or nonlinear filtering tasks beale et al 2016 although rnns suffer from difficulties in mapping long term dependencies problem of vanishing gradients narx usually provide better results than conventional rnns lin et al 1995 1996 typically narx feed the output back towards the input layer samarasinghe 2006 hence the next output value is not only regressed on the independent input signals but also on the previous output signals moghaddamnia et al 2009 izady et al 2013 this is called closed loop setup and is normally used for multi step prediction fig 3 a beale et al 2016 to improve training results narx can be trained in an open loop setup fig 3b in this case the true output which is the observed target time series is presented as an input instead of feeding back the estimated output closed loop beale et al 2016 presenting the target instead of network outputs is more accurate makes training much more efficient and usually almost perfect training fit can be reached moghaddamnia et al 2009 another advantage is the standard feedforward architecture of the neural network without feedback connections which makes training simpler because learning algorithms do not have to be adjusted to the dynamic nature of the network beale et al 2016 typically narx are trained in open loop setup and are used in closed loop setup for multi step prediction tasks beale et al 2016 fig 3 shows that narx also contain delays for input input delays id and feedback time series feedback delays fd which serve as a short time memory within the network menezes and barreto 2008 these delays represent vectors which every signal must pass through thus each signal passing the delays is available as an input to the following unit for as many time steps equal to the length of the vector beale et al 2016 determining input and feedback delays is sometimes crucial in this study time series decomposition and correlation functions were applied to specify significant delays the levenberg marquardt lm training algorithm was chosen to train the narx in open loop setup lm is a fast and reliable second order local method adamowski and chan 2011 which combines advantages of steepest descent first order and gauss newton second order methods samarasinghe 2006 this results in higher calculation speed than the former and improved stability compared to the latter samarasinghe 2006 its general weight update for epoch n 1 can be expressed by yu and wilamowski 2011 1 w n 1 w n h n λ i 1 j n r n it applies that w is the weight vector n the epoch h stands for hessian matrix λ is a variable scalar i is the identity matrix j represents the jacobian matrix and r is the residual error vector the use of the jacobian matrix as well as the diagonal term λi which guarantees the hessian matrix to be positive definite reduces computational costs significantly compared to other second order methods yu and wilamowski 2011 further many authors applied the lm algorithm successfully for ann training in hydrological forecasting e g maier and dandy 1998 2000 daliakopoulos et al 2005 coulibaly et al 2000a b 2001a b to determine narx structure the training procedure is repeated several times on models with different numbers of hidden neurons the maximum number of hidden neurons hn which was tested is given by eq 2 wanas et al 1998 and depends on the number of training samples available n 2 hn log n matlab neural network toolbox mathworks inc 2016 was used to create and simulate narx models 3 2 time series decomposition determining delay vectors for input and feedback is crucial for narx performance ideally delays include all significant lags and are as small as possible to minimize network size avoiding decreased calculation speed higher tendency for overfitting and additional minima on the error surface maier et al 2010 therefore input and target time series were decomposed using the stl algorithm seasonal trend decomposition procedure based on loess cleveland et al 1990 decomposition is necessary to minimize influence of trend and seasonal component on auto and cross correlations of input and target time series since time series with similar trend and periodicity are highly auto correlated and thus tend to show strong cross correlations yule 1926 granger and newbold 1974 aldrich 1995 after removing trend and seasonal components from the original time series the resulting component is called remainder investigating detrended and deseasonalized remainders helps to detect anomalous signals which are of particular interest in terms of cross correlations liesch and ohmer 2016 the loess window sizes for seasonal and trend extraction are chosen to remove auto correlation in the remainder time series especially for groundwater level records this can often only be achieved by removing almost the whole signal which is undesirable however auto correlations of remainder time series were minimized to achieve auto correlation of nearest past lags only by auto correlating the remainders of the target time series and also cross correlating them with each input time series remainders significant lags are detected the time series decomposition was done using the r software r development core team 2017 3 3 validation modified out of sample oos evaluation namely on rolling basis was chosen for this study bergmeir and benítez 2012 out of sample evaluation is common practice in time series forecasting but it only uses one part of the data for evaluation and also errors are computed only once in standard oos the last part of the time series approx 10 15 is left out in the training dataset and is used to test the generalization ability of the network bergmeir and benítez 2012 maier et al 2010 to reduce error variance by using oos on rolling basis the error is calculated on several parts of the data with a rolling origin of the test dataset in this study at least the first half of the original data was used for model building while the next 10 served as test set for error calculation in the following the test set was incorporated into the training data and the next 10 became the new test set until 90 of the original data was used for training each time the model was completely built anew to avoid double usage of data for training and testing purposes thus overall the error was calculated five times on five differing parts of the data and subsequently simply averaged bergmeir and benítez 2012 bergmeir et al 2014 this procedure was repeated for several numbers of neurons in the hidden layer and the hidden layer size with the best validation performance was chosen to perform forecasts it is worth to notice that for model building the training data set is additionally divided into three subsets which enables the software to perform early stopping during the open loop training and thus to effectively avoid overfitting 3 4 performance criteria to evaluate observed against predicted values several error indices were used coefficient of determination r2 root mean squared error rmse relative root mean squared error rmser and the nash sutcliffe criterion nash the coefficient of determination investigates the correlation between predicted and observed values it ranges from zero to one with one showing a perfect fit and zero indicating no statistical correlation r2 is defined as the squared value of the bravais pearson correlation coefficient and is calculated according to eq 3 krause et al 2005 it applies that o i is the observed value o the mean of the observed values p i the forecasted value p the mean of the forecasted values and n the number of samples available 3 r 2 i 1 n o i o p i p i 1 n o i o 2 i 1 n p i p 2 2 the root mean squared error calculates the error variance independently from sample size relative rmse helps to assess absolute rmse values and makes comparison of different wells easier values as low as possible are best for rmse and rmser which are given by khalil et al 2015 4 rmse i 1 n o i p i 2 n 5 rmser i 1 n o i p i o i 2 n 100 the nash sutcliffe criterion nash is well established in estimating forecast accuracy of hydrological models krause et al 2005 nash ranges from to 1 perfect fit with values below zero indicating that the mean observed value is a better predictor than the forecasting model krause et al 2005 it is calculated as follows bennett et al 2013 6 nash 1 1 n i 1 n o i p i 2 1 m i 1 m o i o 2 note that for the calculation of the denominator in eq 6 the complete time series of length m has been used not only the n samples of the according prediction time span this reduces information loss and represents more adequately the variance of the whole data set 4 results and discussion table 2 summarizes modelling parameters of the best performing narx models for each observation well as well as corresponding oos validation error values section 3 3 all best performing models were selected by comparing their unique combination of calculated error values parallel to a visual evaluation of the corresponding graphs it turned out that lowest rmse rmser and highest nash values mostly occurred together for a specific hidden layer size whereas the best r2 value did not follow this pattern strictly model selection was therefore mainly but not exclusively based on rmse r and nash values this applies for example for well pa1 where the selected model exceptionally even has the lowest r2 value overall it was decided on a case by case basis which model was considered the best performing one all selected site specific models were subsequently used to perform forecasts 1 4 12 and 26 steps ahead the investigated prediction periods are randomly selected by simply corresponding to the end of the data set of the respective well the corresponding error measure results are presented in table 3 all results are discussed in detail in the following sections 4 1 porous aquifer the methodological approach shown and explained in fig 2 and section 3 is illustrated exemplary in the following for porous aquifer well pa1 the procedure is analogous for every observation well examined in this study fig 4 shows the stl decomposition for groundwater level gwl fig 4a precipitation p fig 4b and temperature t fig 4c from top to bottom the original time series seasonal component trend component and remainders are displayed in each diagram key parameters for applying the stl algorithm are the spans in lags of the loess windows for seasonal and trend extraction for seasonal extraction the span of 52 lags equals one year was selected whereas the span for trend extraction was modified in a way that the auto correlation of the remainder time series was as small as possible fig 4d shows the auto correlation function of the gwl remainder fig 4e the p gwl remainder cross correlation and fig 4f the t gwl remainder cross correlation based on these diagrams feedback delays were determined to be a vector of 1 to 5 fd 1 5 and input delays a vector of 1 to 3 id 1 3 selection of significant input lags for pa1 is mainly based on p gwl cross correlation because t gwl cross correlation does not reveal significant lags anyway this does not allow conclusions to be drawn regarding the suitability of t as input parameter since the omission of t significantly worsens training fit and forecasting accuracy the stl decomposition and correlation function diagrams of every single observation well dataset can be found in the electronic supplementary material of this study esm the best oos validation result for well pa1 was found using four hidden neurons in fig 5 the dependency of calculated oos validation error results on the size of the hidden layer is exemplary shown for well pa1 the exact error values for oos validation with four hidden neurons can be found in table 2 as fig 5 illustrates it is important to consider all error indices for model selection at once high coefficients of determination are not necessarily accompanied by low root mean squared errors or high nash sutcliffe values in this case the best performing model even shows the lowest of all r2 values other hidden layer sizes with promising error values partly showed pointless oscillations or were discarded due to partly strong deviations fig 6 shows the oos validation procedure on rolling basis for a narx model with four hidden neurons using pa1 data as already explained section 3 3 at least 50 of the dataset is used for model building the following 10 steps of data serve for error calculation it is meaningless to investigate or even calculate error values for the model building part of the time series as it is common practice for other types of anns e g mlp due to the open loop setup for optimized training the green curve in fig 6 almost perfectly fits the observed data blue therefore the errors table 2 are calculated and averaged on the red curve sections of fig 6 according to the oos validation procedure overall the predicted values red fit the target data blue dashed fairly good especially considering the length of the tested intervals which include several years this timespan exceeds usual groundwater forecasting periods by a multiple the figures corresponding to fig 6 for all other observations wells listed in table 2 can be found in the electronic esm a detailed investigation of the oos validation sections shown in fig 6 is presented in fig 7 for each section both observed and predicted data and their residuals are displayed as well as the associated scatter plot it is obvious that the residuals are biased by showing mean values above or below zero however the selected oos validation procedure which includes several retraining steps for each new section makes the bias difficult to assess because every retraining changes the model and thus also changes the bias in amount and or algebraic signs the oos procedure thus is more an assessment of the potential power of the architecture and the structure of the narx model than it is an assessment of a very specific already trained model residual means for well pa1 range between 0 0425 first oos section and 0 2608 third oos section which is acceptably low considering the overall variation of pa1 which is more than 2 m for all five sections significant auto correlation of the residuals can be observed which means that the model still shows clear scope for improvement this was to be expected as the chosen approach with its limited number of input parameters still provides room for improvement hence this demonstrates that the potential power of the approach is limited even when good fit is reached for a certain period the scatterplots clearly illustrate that the narx model underestimates high groundwater levels overestimates low ones and therefore has some shortcomings in predicting extreme events however the length of the oos sections which exceed common prediction timespan lengths by a multiple again relativizes these findings a real assessment of the model strength for shorter prediction periods needs to be assessed separately which is therefore done in the following figures analogously to fig 7 for all other wells can be found in the esm the selected narx model is used to perform groundwater level forecasting for lead times lt of 1 week 1 month 4 weeks 3 months 12 weeks and half a year 26 weeks the results are shown in table 3 and fig 8 no coefficient of determination can be computed for lead time 1 because it is only a one step ahead prediction the remaining r2 values and the nash sutcliffe coefficients express that the predicted values fit the target data quite well the root mean squared errors show the high quality of the forecast although an overestimation for longer lead times lt 26 can be detected in fig 8 also indicated by a lower corresponding nash value it can also be seen that even the trend reversal of may 2008 which is assumed to be caused by simple yearly periodicity can be reproduced for well pa2 karlsruhe a narx model with seven hidden neurons input delays 1 4 and feedback delays 1 7 was selected based on the oos validation procedure the oos validation procedure can be reconstructed using the detailed graphs in the electronic supplementary material best oos validation results can be found in table 2 table 3 and fig 9 present the short and mid term forecasting results forecast accuracy for small lead times is acceptable fig 9a and b but gets worse for longer lt fig 9c and d this is expressed best by increasing rmse r values and by the corresponding prediction graphs even though the model shows high correlations for lt 12 and 26 the groundwater trend is clearly underestimated this is plausible because pa2 is strongly influenced by nearby groundwater extractions which have not been used to forecast groundwater levels for two reasons first for real forecasts no future groundwater extraction data would be available and second robustness of narx against such influences should be tested narx obviously are not able to compensate this external groundwater extraction by using only precipitation and temperature as input parameters high nash sutcliffe coefficients for all lead times can be explained by the total groundwater level range of pa2 which is about 4 5 m and the low overall time series data mean value of about 110 3 m asl especially the latter is responsible for high nash values comp eq 6 of the investigated sections considering the results of both wells pa1 and pa2 of the porous aquifer the forecasts seem to be promising for uninfluenced wells strongly influenced wells should be avoided in applying forecasts using only p and t as predictors for both observations wells pa1 and pa2 the root mean squared error seems most reliable to evaluate short term forecast accuracy the longer the lead times the more meaningful the coefficient of determination and the nash sutcliffe criterion all should be considered in combination with each other especially for lt 12 and lt 26 additional visual evaluation of the graphs is necessary to ensure adequate judgement of forecast accuracy 4 2 fractured aquifer for fractured aquifer and uninfluenced well fa1 sorga a narx model with two hidden neurons input delays 1 4 and feedback delays 1 6 was selected tab 2 and again the oos validation procedure of the selected model can be followed using the detailed graphs in the esm the gwl curve shows an almost linear downtrend during 2015 fig 10 such linear trends occur regularly during spring and summer and seem to be characteristic for well fa1 r2 improves for longer lead times probably because the overall downtrend is captured accurately table 3 variations seem to be more difficult to predict as the peak of the target data in dec 15 jan 16 shows fig 10 again high nash values imply very good fit of the forecasts for influenced fractured aquifer well fa2 niederrodenbach a narx model with eight hidden neurons input delays 1 7 and feedback delays 1 7 was applied table 2 as with all other wells the oos validation procedure and more information on the model power can be found using the detailed graphs in the esm forecasting results can be found in table 3 and fig 11 again the results are promising and the overall prediction target tendency is captured error indices consistently show very good values and are close to the results of uninfluenced well fa1 anyway it should be noted that the yearly variation of the groundwater level for fa1 in fig 11 is almost double the fa2 variation in fig 10 but the overall time series data variation differs only little again the root mean squared error seems most informative for smaller lead times the longer the lead times the more important the coefficient of determination gets for evaluation of accuracy the nash sutcliffe criterion values seem to give a more general description of the predictive power of the model the good forecast accuracy of fa2 may result because external influences are not as distinct as they are for pa2 and ka2 which both are located directly next to water extractions here the influence seems to be on a larger scale concerning more the overall water balance than local groundwater levels further investigations are necessary to draw more detailed conclusions and maybe to identify some grade of influence on which narx models begin to fail 4 3 karst aquifer a narx model with hidden layer size 3 input delays 1 6 and feedback delays 1 7 was found to be most suitable for forecasting groundwater levels of uninfluenced karst aquifer well ka1 neufra table 2 to follow the oos validation process please check the detailed graphs in the esm compared to the examined wells in porous and fractured aquifers the groundwater level variation is about four times higher still forecast errors indicate high accuracy tab 3 which is verified by the red prediction curves in fig 12 even though the absolute rmse seems high compared to pa1 pa2 fa1 and fa2 the very low rmser better describes the forecast accuracy it is not clear if the model seems to overestimate prediction values for longer lead times because the deviation consistently occurs during around the turn of the year 2015 2016 the deviation could also be due to an incorrectly captured relationship between input and output variables nevertheless the model still yields highly acceptable forecasts the low r2 value for lt 12 demonstrates a weakness of this specific error index which shows an extremely low value due to opposing trends in between the single data points of the predicted data compared to the observed data the high nash values 0 96 for all lead times more adequately represent the predictive power of the narx model for well ka2 gundremmingen a narx model with two hidden neurons input delays 1 2 and feedback delays 1 1 was selected for insights into the oos validation procedure and more detailed information regarding the model power the graphs in the esm can be addressed feedback delays are at minimum value because no relationship was detected of successive groundwater level values by auto correlating the gwl remainder time series accordingly forecast results do not seem to be reasonable table 3 fig 13 this agrees with results of pa2 forecasting where strong external influences groundwater extractions also prevented good generalization ability although forecasting one week results in good accuracy it can be seen that with increasing lead time the ka2 narx model does not reproduce any variations or trends more or less an average value is produced which explains relative low rmse and rmser as well as the decreasing nash values this coincides with the auto and cross correlation analyses which have been performed earlier none of them revealed statistically significant lags the good results for lt 1 thus may also be coincidence it is obvious that in general without additional visual evaluation of the graphs no robust judgement of forecast accuracy can be made by simply assessing the error indices furthermore only few years were available for training due to its properties it might be doubted though that longer records would improve accuracy significantly further due to a lack of data regarding flow rates or water levels of the danube river it remains unclear which external factors contribute to the water levels of ka2 to which extent 4 4 comparative discussion other authors e g coulibaly et al 2001a daliakopoulos et al 2005 lallahem et al 2005 nayak et al 2006 mohammadi 2008 sreekanth et al 2009 yoon et al 2011 adamowski and chan 2011 trichakis et al 2011 taormina et al 2012 chitsazan et al 2015 khalil et al 2015 chang et al 2016 also found that artificial neural networks in general are exceptionally well suited to predict groundwater levels for different geological settings the particular suitability of narx for groundwater prediction in porous aquifers which was also found by izady et al 2013 and guzman et al 2017 can be confirmed by the results of this study additionally also for fractured and karstic environments promising results were obtained several authors stated that it is even possible to reproduce complicated scenarios like transient groundwater level conditions in a complex multi layered groundwater system e g coppola et al 2003 the more complex the scenario the more input parameters were used to reach sufficient forecast accuracy such complex scenarios correspond with the so called influenced wells of this study the inclusion of additional information like pumping rates from wells nearby or water levels of surrounding observation wells may improve forecast accuracy substantially but also would mean a multiple effort in advance of applying the method this shows the limits as well the advantages of the applied approach which only uses easily and widely available data and is therefore relatively easy to apply on uninfluenced wells in a variety of hydrogeolocigal conditions 5 conclusions the suitability of nonlinear autoregressive networks with exogenous input narx in short and mid term forecasting from one day up to six months of groundwater levels for three different types of aquifers namely porous fractured and karst aquifers has been examined in this study additionally the effects of external influences on forecasting performance which are known to cause groundwater level variations were investigated the study area is located in southwest germany in the states of hesse baden wurttemberg and bavaria six observation wells have been chosen two for each investigated aquifer type one uninfluenced and one influenced each fundamental assumption of the approach is that the dynamics of the wells to be investigated are strongly influenced by groundwater recharge and evapotranspiration the widely and easily available climatic parameters temperature and precipitation were selected as substitutes for these parameters and served as input to the narx models which makes the method simply transferable to almost every area this advantage is at the same time a clear limitation since the inclusion of further input parameters in terms of transferability and applicability is not reasonable thus only selected wells are suited for the application of our approach all input and target time series were decomposed using the stl algorithm to detect significant time lags and determine input and feedback delays needed for narx application a modified out of sample validation on rolling basis approach was applied to evaluate the performance this evaluation method is necessary due to the inherent properties of narx but still has scope for improvement since repeated retraining steps make the evaluation of the model power difficult compared to the results of studies using ann architectures other than narx e g daliakopoulos et al 2005 lallahem 2005 adamowski and chan 2011 khalil et al 2015 the results of this study show that narx are remarkably well suited to perform groundwater predictions for uninfluenced observation wells in all aquifer types even though the number of input parameters is limited furthermore the method is easily applicable due to its simple input parameters however the results for influenced observation wells are not quite as clear by using only two climatic input parameters p t narx models are not capable of adequately mapping groundwater levels if strong external influencing factors are reflected in the characteristics of a hydrograph this applies in particular to porous and karst aquifers where strong forecast deviations can be observed especially for longer lead times on the other hand in fractured aquifer observation wells reliable results were also obtained for an influenced well but at the same time this was influenced to a lesser extent the inclusion of additional inputs can considerably improve the forecast accuracy but also leads to a higher effort in the application of the method and would contradict the goal of developing an easily transferable methodology by including only data that are widely available in order to draw more detailed conclusions further investigations on additional wells in all aquifer types especially in fractured media must be carried out this can also help to distinguish more sharply whether a well has to be classified as influenced or not and whether the methodology can be applied the oos validation process shows that all models are biased and have auto correlated residuals which makes it clear that the models still need to be adjusted and can be significantly improved the root mean squared error seems to be the most suitable error index to evaluate forecast accuracy the longer the lead times the more important the coefficient of determination gets both should be considered in combination with each other for longer lead times 3 months the nash sutcliffe criterion appears to be a good indicator in terms of model selection but does not provide detailed information when it comes to accuracy evaluation issues on a high resolution level nevertheless it gives a more general insight in the predictive power of the model acknowledgement we would like to thank the reviewers for their useful comments that helped to improve the paper appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j jhydrol 2018 01 045 appendix a supplementary data supplementary figure 1 detailed evaluation of oos validation sections for well fa1 supplementary figure 10 training and out of sample validation procedure on rolling basis for well pa2 using narx with seven hidden nodes training green is performed open loop testing is performed in closed loop setup errors are averaged on all test sections red to obtain overall errors supplementary figure 11 stl decomposition for groundwater level a precipitation b and temperature c of well fa1 from top to bottom the original time series seasonal component trend component and remainders are displayed further the auto correlation function of the gwlremainder d cross correlation of p remainder and gwl remainder e and cross correlation of t remainder and gwl remainder f time series are shown the blue dashed line indicates the confidence limit supplementary figure 12 stl decomposition for groundwater level a precipitation b and temperature c of well fa2 from top to bottom the original time series seasonal component trend component and remainders are displayed further the auto correlation function of the gwlremainder d cross correlation of p remainder and gwl remainder e and cross correlation of t remainder and gwl remainder f time series are shown the blue dashed line indicates the confidence limit supplementary figure 13 stl decomposition for groundwater level a precipitation b and temperature c of well ka1 from top to bottom the original time series seasonal component trend component and remainders are displayed further the auto correlation function of the gwlremainder d cross correlation of p remainder and gwl remainder e and cross correlation of t remainder and gwl remainder f time series are shown the blue dashed line indicates the confidence limit supplementary figure 14 stl decomposition for groundwater level a precipitation b and temperature c of well ka2 from top to bottom the original time series seasonal component trend component and remainders are displayed further the auto correlation function of the gwlremainder d cross correlation of p remainder and gwl remainder e and cross correlation of t remainder and gwl remainder f time series are shown the blue dashed line indicates the confidence limit supplementary figure 15 stl decomposition for groundwater level a precipitation b and temperature c of well pa2 from top to bottom the original time series seasonal component trend component and remainders are displayed further the auto correlation function of the gwlremainder d cross correlation of p remainder and gwl remainder e and cross correlation of t remainder and gwl remainder f time series are shown the blue dashed line indicates the confidence limit supplementary figure 2 detailed evaluation of oos validation sections for well fa2 supplementary figure 3 detailed evaluation of oos validation sections for well ka1 supplementary figure 4 detailed evaluation of oos validation sections for well ka2 supplementary figure 5 detailed evaluation of oos validation sections for well pa2 supplementary figure 6 training and out of sample validation procedure on rolling basis for well fa1 using narx with two hidden nodes training green is performed open loop testing is performed in closed loop setup errors are averaged on all test sections red to obtain overall errors supplementary figure 7 training and out of sample validation procedure on rolling basis for well fa2 using narx with eight hidden nodes training green is performed open loop testing is performed in closed loop setup errors are averaged on all test sections red to obtain overall errors supplementary figure 8 training and out of sample validation procedure on rolling basis for well ka1 using narx with three hidden nodes training green is performed open loop testing is performed in closed loop setup errors are averaged on all test sections red to obtain overall errors supplementary figure 9 training and out of sample validation procedure on rolling basis for well ka2 using narx with two hidden nodes training green is performed open loop testing is performed in closed loop setup errors are averaged on all test sections red to obtain overall errors 
6919,the ensemble kalman filter enkf has been widely applied to assimilate dynamic data such as hydraulic head in geologic models for improved predictions over the past decade it has various advantages such as the capability of handling multiple sources of uncertainty and ease of coupling with forward simulators involving complex physics however it is not reliable for updating models that are characterized by curvilinear structures such as in fluvial deposits where high permeability conduits play a dominant role for solute transport several methods have been proposed to handle non gaussian aspects in the enkf for instance the enkf has been coupled with the normal score transform ns enkf for data assimilation in non multi gaussian distributed conductivity fields and this approach has been applied in a number of studies as an alternative to the enkf the iterative ensemble smoother es has been proposed for data assimilation where all the data at all time steps are integrated into geologic models together instead of the sequential data integration of the enkf the es therefore has much less computational cost than the enkf this work coupled the normal score transform and ensemble smoother ns es for data assimilation in non multi gaussian distributed conductivity fields the algorithm is compared to the ns enkf and evaluated in a synthetic bimodal aquifer the results show that 1 the ns es is able to reproduce the curvilinear structures of the reference field and the performance of updated models using the ns es is improved in terms of flow and transport predictions and 2 the ns es can obtain results comparable to the ns enkf for characterization of non multi gaussian conductivities and has the advantage of less computational cost keywords iterative ensemble smoother ensemble kalman filter groundwater modeling geostatistics non gaussianity 1 introduction data assimilation has been widely applied to make it practical for complex groundwater models to incorporate huge amounts of observed data that have become available from advances in sensor technologies specifically groundwater models with initial guesses of parameters and boundary conditions can be solved numerically but simulated state variables such as hydraulic head and concentration might not match field observations from sensors data assimilation is a process to match the simulated state variables with those observations through calibrating the unknown parameters at unsampled locations thus improving the predictive capability of groundwater models zhou et al 2014 over the last decade the ensemble kalman filter enkf an ensemble based real time data assimilation method was first proposed by evensen 2003 as an improvement of the extended kalman filter unlike the extended kalman filter where the covariance between the parameters and state variables is calculated and propagated with time through a linear transfer function kalman 1960 and where the groundwater flow equation is approximated linearly by a taylor series expansion the covariance is approximately computed through an ensemble of parameters and the correspondingly simulated state variables in the enkf advantages of the enkf include 1 computational efficiency without explicit calculation of the adjoint sensitivity matrix 2 the flexibility to couple with forward simulators 3 the capability to jointly calibrate multiple unknown parameters and 4 real time on line data assimilation hendricks franssen and kinzelbach 2009 it has been applied extensively in multidisciplinary fields such as petroleum engineering and groundwater studies for example the enkf was used to calibrate a range of aquifer parameters conductivities e g chen and zhang 2006 crestani et al 2013 panzeri et al 2015 crestani et al 2015 porosity li et al 2012b conductivity tensors li et al 2012c dispersivities liu et al 2008 river bed conductivity kurtz et al 2014 and specific storage hendricks franssen et al 2011 li et al 2017 the potential state data applied for calibrating parameters mentioned above include hydraulic head concentration surface deformation solute travel time deduced from tracer tests and temperature the enkf would provide the best performance depending on the parameters and or state variables analyzed in each single case although the enkf has been widely applied for assimilating observed measurements in hydrogeology a number of studies have been pursued to deal with the non multi gaussian conductivity field e g zhou et al 2011 hu et al 2013 khodabakhshi and jafarpour 2013 li et al 2015 it is well known that the enkf has an optimal solution if the transfer function is linear and parameters follow a multi gaussian distribution however the groundwater equation is non linear and the conductivity field essentially has a non multi gaussian distribution anderson 2001 for instance the multiple point statistics mps method is becoming popular for modeling fluvial deposits and fractured reservoirs where preferred flow conduits play a dominant role in contaminant plume migration strebelle 2002 compared to traditional two point statistics the mps method has the ability to model curvilinear structures that are observed from a conceptual model i e the training image the challenge is how the enkf can be applied effectively for the non multi gaussian conductivities that are modeled by the mps zhou et al 2011 proposed to transform the non multi gaussian conductivities to gaussian by using a normal score procedure deutsch and journel 1998 before updating via the enkf this approach is termed as the well known ns enkf and has been applied in a range of studies for assimilating data in non multi gaussian settings e g schöniger et al 2012 li et al 2012a nejadi et al 2012 crestani et al 2013 tang et al 2015 xu and gómez hernández 2016 zovi et al 2017 hu et al 2013 introduced updating the probability field that is used to draw the conductivities in the mps using the enkf khodabakhshi and jafarpour 2013 proposed a probability conditioning method where the conductivity field is obtained by updating the dynamic data using the enkf and then the averaging of updated conductivities is used as secondary conditioning data for regenerating the conductivity fields in the mps li et al 2015 compared the enkf to an mps oriented data assimilation method and highlighted the importance of preserving curvilinear structures in groundwater flow and transport modeling as an alternative to the enkf the iterative ensemble smoother es has been proposed for assimilating state data with much less computational cost skjervheim et al 2011 unlike the enkf where the data are sequentially integrated into the groundwater models with the advance of time steps all the data at all time steps are combined together and assimilated into the groundwater model in the es because no recurring groundwater modeling is needed it has much less computational cost compared to the enkf the es has gained much less attention in groundwater work although many studies in petroleum applications exist e g chen and oliver 2012 bailey and baù 2010 applied the es for data assimilation in groundwater flow modeling in order to improve the method and to avoid the impact of strong non linearity of the transfer function an iterative es was proposed in which the same set of data is used continuously to refine the parameters chang et al 2017 coupled the iterative es with a surrogate model for flow data assimilation in a subsurface system it is worth noting that the iterative es works best for the multi gaussian conductivity fields as the enkf in this work the normal score method deutsch and journel 1998 is coupled for the first time with the iterative es for better modeling of the non multi gaussian conductivity field this borrows computational efficiency from the es and leverages the capability of the normal score transform for handling the non gaussian character of fluvial deposits the coupled ns es approach is compared to the previously developed ns enkf by zhou et al 2011 a synthetic example is used to demonstrate the effectiveness and robustness of the proposed ns es characterization of non multi gaussian conductivity and flow and transport predictions are gauged in the example 2 methodology 2 1 groundwater flow equation combining mass conservation and darcy s laws the forward groundwater flow model in an incompressible or slightly compressible saturated aquifer can be written as bear 1972 1 k h s s h t q where is the divergence operator x y z is the gradient operator x y z t k is hydraulic conductivity lt 1 h is hydraulic head l s s is specific storage l 1 t is time t and q is a source or sink t 1 2 2 ns enkf and ns es the ns enkf was first proposed by zhou et al 2011 for handling the non gaussian aspects of the enkf because the enkf is based on two point statistics i e covariance and it has an optimal solution for dealing with the multi gaussian conductivity field it can not handle curvilinear structures that are based on multiple point statistics and featured with non gaussian behavior to do this zhou et al 2011 introduced the normal score procedure in the enkf in this approach the non gaussian parameters and state variables are both transformed to gaussian via the normal score transform and then the enkf is applied to the transformed variables for updating with measurements the variables after updating are transformed back as the input for the forward simulator for integrating the data at the next time step or for predicting the states in the future if no further data are available regarding the es for coupling with the ns the framework is the same as the ns enkf the only difference is in how the data are integrated into the models which has a substantial impact on the computational cost in the ns es all the data at all time steps are transformed into gaussian with the normal score procedure and then the es is applied for estimating parameters in the ns enkf the data are sequentially integrated into models the ns enkf and ns es can be described as the following steps 1 initialization both methods use ensemble models to approximate the correlation between parameters and state variables these initial ensemble models are generated through geostatistical methods e g deutsch and journel 1998 strebelle 2002 hard data e g measured conductivity and secondary data such as sand probability can be conditioned in geostatistical simulations we assume that the scale of measurements is consistent with the grid size of the numerical model if not an upscaling procedure might be needed to reconcile these two scales li et al 2011 2 normal score function the log conductivity local conditional distribution function is built at each grid cells by using the ensemble models from the previous step the local normal score transfer function ϕ is constructed as well details for the normal score transfer function were given by deutsch and journel 1998 3 forecast forecast in the ns enkf the transient groundwater flow equation is solved from time t k 1 to t k for each model it can be described as 2 y k f x k 1 y k 1 where x k 1 and y k 1 denote the hydraulic conductivity and the piezometric head at time t k 1 y k means the simulated hydraulic head and f represents the groundwater flow model given boundary conditions sources and sinks forecast in the ns es the transient groundwater flow equation is solved from time t 0 to t k for each model it can be written as 3 y 1 y k f x 0 y 0 where x 0 is the initial guess of hydraulic conductivity and y 0 indicates the initial hydraulic head for the transient simulation and y 1 y k are the simulated heads from time t 1 to t k 4 normal score function build the local conditional distribution of head from the simulated heads of ensemble models and the normal score transform functions φ accordingly 5 update parameters using the observations y 1 o y k o transform the conductivity x from initial models simulated heads y and observations y o through normal score functions 4 x ϕ x y φ y y o φ y o estimate parameters in the ns enkf build the joint state vector φ which includes the transformed parameters and the transformed hydraulic heads based on the forward modeling using eq 2 for the realization i at time k this can be written as 5 φ i k x 1 x 2 x n t y 1 y 2 y n t i k where n denotes the number of grid cells for the groundwater model the joint state vector is updated by using the observation data y k o recall that the transformed observations y k o will be applied 6 φ k u φ k f g k y k o h φ k f where φ k u is the joint vector ensemble at time k and φ k f is the vector ensemble with the forecasted states and is an observation error with zero mean and covariance r g k is the kalman gain and can be written as 7 g k c x y k o c y k o y k o r 1 where c x y k o is the cross covariance between the transformed parameters and the transformed observations at time t k and c y k o y k o is the auto covariance between the transformed observations at time t k if the number of observations is m c x y k o and c y k o y k o have a size of n m and of m m respectively the covariances can be approximately calculated as 8 c x y o k j 1 n e x x y k o y k o t n e c y o k y o k j 1 n e y k o y k o y k o y k o t n e where n e denotes the number of realizations in the ensemble and x and y k o are the mean of x and y k o over the ensemble respectively estimate parameters in the ns es build the joint state vector φ which includes the transformed parameters and the transformed state variables for all the time steps on the basis of the forward modeling using eq 3 for the realization i this can be written as 9 φ i x 1 x 2 x t y 1 y 2 y n 1 t y y 2 y n 2 t y 1 y 2 y n k t i update the joint state vector using observations y o all the observations at all the time steps are transformed and included in y o 10 φ u φ f g y o h φ f where the kalman gain g is calculated as 11 g c x y o c y o y o r 1 in which c x y o is the cross covariance between the transformed parameters and the transformed observations at all the time steps with a size of n m k and c y o y o is the auto covariance between the transformed observations at all the time steps with a size of m k m k the detailed equations for calculating covariances are shown in eq 8 6 back transform the updated parameters 12 x ϕ 1 x 7 go back to step 3 until all the data from the remaining time steps are assimilated in the ns enkf for the ns es the program ends here but if the iterative version is applied go back to step 2 until a good match is achieved in terms of hydraulic heads as other iterative methods such as gradient based method zhou et al 2014 if the mismatch between simulated heads and observed values is lower than the defined threshold i e termination criterion a stable solution has been reached in other words the termination criterion is satisfied and then stop data assimilation this mechanism has been applied in the iterative es emerick and reynolds 2013 although both the ns enkf and the ns es update parameters and state variables only the parameters are used for predictions this means that the groundwater models need to re run from the very beginning for either assimilating the data of the next time step or for predicting states in the future the main reason is that the updated state variables might not be consistent with the updated parameters in terms of the underlying physics e g mass balance equation here also because the ns enkf must be re run in the model for assimilating data at each time step its computational cost is much greater than the ns es where all the data at all time steps are combined and assimilated together 3 an example a hypothetical aquifer mimicking field fluvial deposits will be used to demonstrate the proposed method in this case we only take the uncertainty of hydraulic conductivity into consideration for the sake of simplicity although other parameters such as porosity specific storage and boundary conditions might be unknown in the field as well this example has been used for demonstration of the capability of the ns enkf for data assimilation in a non multi gaussian distributed conductivity field li et al 2012a 3 1 problem set up the aquifer has a size of 300 m 240 m 10 m and is discretized into 100 columns by 80 rows by 1 layer a reference hydraulic conductivity field is generated through two steps at first the reference field is assumed to be composed of sand and silt or clay facies and modeled with an mps method developed by strebelle 2002 using the training image shown in fig 1 a the training image is a conceptual model of the target aquifer where sandy channels represent preferred flow conduits and are embedded in fine grained silt or clay floodplain deposits with low permeabilities then each of the facies is populated with continuous log conductivity values that are generated by sequential gaussian simulation through gslib deutsch and journel 1998 the log conductivity of the reference field and its histogram are presented in fig 1 b and c it is evident that the log conductivities have a bimodal distribution typical of fluvial deposits the assembled hydraulic conductivity shows preferred conduits as the training image that are of particular important for solute transport migration the aquifer model has no flow boundaries in the north and south a constant head boundary at the western edge and a prescribed flow rate of 270 5 m 3 d along the eastern edge the flow is distributed along the eastern boundary depending on conductances specific storage is assumed to be constant and equals 0 003 m 1 the initial head is 0 m over the domain the total simulation time is 500 days and discretized into 100 time steps with a geometric ratio of 1 05 modflow is used to solve the transient groundwater flow equation anderman et al 2002 the simulated head data from the first 60 time steps will be used as the conditioning data in the ns enkf and the ns es the well locations are shown in fig 1 d 3 2 assessment criteria three metrics will be used to evaluate the results these already have been used in other studies for assessing the results of data assimilation e g chen and zhang 2006 hendricks franssen and kinzelbach 2009 zhou et al 2011 zhang et al 2015 root mean square error rmse which can be used to measure the accuracy of estimation 13 rmse x 1 n i 1 n x ref i x i 2 1 2 where x i is log conductivity at location i x i represents its ensemble mean value at node i x ref i is the reference log conductivity value at location i and n is the number of nodes a better characterization of log conductivity is reached if the values for rems are small average ensemble spread aes aes can be used to gauge the precision of the estimation in other words it measures the uncertainty of ensemble realizations 14 aes x 1 n i 1 n σ x i 2 1 2 where σ x i 2 is the ensemble variance at location i connectivity the preferred flow conduits i e connectivity strongly affect flow and transport behavior e g wen and gómez hernández 1998 we applied the connectivity function defined by pardo igúzquiza and dowd 2003 to evaluate the connectivity in this approach the probability that two points are connected is computed the result is a function of distance that gives the probability that two points in the same facies are connected 3 3 results fig 2 displays the ensemble mean and ensemble variance of the calibrated log conductivities using the ns enkf and the ns es as we expected the ensemble mean and ensemble variance tend to be constant when no data are conditioned although each individual realization shows the strong heterogeneity of the reference in fig 1b the averaging of greater and smaller conductivities through the ensemble results in a constant value over the domain also the ensemble variance is a maximum if no data are considered in other words this represents the greatest uncertainty in terms of aquifer conductivity when the head data are integrated into the model through the ns enkf and the ns es the ensemble mean maps exhibit spatial patterns that are similar to the reference field in fig 1b recall that these channels play a critical role in flow and solute transport as demonstrated in studies e g davis 1986 zinn and harvey 2003 the ensemble variance is considerably reduced which means that the uncertainty is minimized given the data also the conductivities at the boundaries of channels have a larger variance i e uncertainty than those within the channels with only secondary data such as hydraulic head it is possible to fully characterize the curvilinear structures using the ns enkf and ns es besides the qualitative analyses of log conductivity through visualization we also quantitatively calculate the rmse and aes as shown in table 1 they show a great consistency with the previous ensemble mean and ensemble variance maps of log conductivity both the rmse i e accuracy and aes i e bias are significantly reduced indicating the importance of hydraulic head in data assimilation the connectivity with distance for different cases is displayed in fig 3 it is evident that the connectivity is mostly reduced with an increase of distance for the reference field this is consistent with visual observation of the reference log conductivity field in fig 1b for the case where no data are conditioned the connectivity has the greatest uncertainty and the ensemble mean of connectivity deviates from the reference as well for the cases of the ns enkf and ns es the ensemble spread of connectivities is reduced and their ensemble mean is close to the reference connectivity this means that the connectivity after updating conductivity using head data has a better estimation in terms of accuracy and precision fig 4 shows the hydraulic head predictions for observation well 25 the greatest uncertainty of conductivity surely results in the maximum uncertainty of simulated head if no data are conditioned as is the case of prior when head data are used to calibrate the conductivity through the ns enkf and the ns es the simulated heads are close to the heads from the reference field this is consistent with the characterization of conductivity and its connectivity note that only the heads from the first 60 time steps i e 67 days are used for the conditioning in both cases we conclude that both approaches achieve comparable results in terms of aquifer characterization and flow predictions but the ns es requires much less computational cost than the ns enkf because all the data from all time steps are assimilated together without the need to run the computationally expensive forward simulator recurringly our main purpose here is to see if the iterative ns es works for the characterization of non gaussian conductivity field and to compare its performance with the one using the ns enkf the convergence issue of the iterative es has been extensively discussed in other papers e g chen and oliver 2012 emerick and reynolds 2013 zhang et al 2014 for example emerick and reynolds 2013 show the mismatch between observations and simulated values converges when the number of iteration is larger using a synthetic reservoir example in other words increasing the number of data assimilation improved data matches and consequently increased the computational cost as well in their example four data assimilations result in a good match of water data how the converge changes with the number of iterations in groundwater modeling is beyond of scope of the paper and will be investigated in the future 3 4 transport predictions a transport experiment is conducted to test the predictive ability of the updated conductivity using hydraulic head data via the ns enkf and the ns es the boundary conditions for groundwater flow are the same as the previous flow modeling example porosity is set as constant and equal to 0 3 everywhere a vertical line source of contaminant is instantaneously released upstream close to the western boundary x 19 5 m a control plane located downstream near the eastern boundary x 290 m is used to record particle travel times the random walk particle tracking code rw3d fernàndez garcia et al 2005 is used to solve the transport equation in this approach the evolution in time of each particle is composed of a deterministic component from the local velocity for advection and a superposed brownian motion for dispersion also a constant displacement scheme is employed for decreasing computational effort in particle random walk modeling wen and gómez hernández 1996 the integrated breakthrough curves of normalized concentration at the control plane are computed and compared with the prior one and the reference breakthrough curves fig 5 it is clear that if hydraulic conductivity is not characterized well as in the case of prior the largest uncertainty for the simulated concentration is observed for both the ns enkf and the ns es the uncertainty of concentration is significantly reduced because of the hydraulic head data also the reference concentration is well represented by the ensemble mean and more importantly it is contained within the 90 confidence interval 4 conclusion the ensemble kalman filter has been applied in a wide range of disciplines for assimilating observation data because of its advantages such as real time data assimilation and ease of coupling with forward simulators the enkf has an optimal solution for multi gaussian distributed parameters and state variables and for the linear transfer function for porous and or fractured media however conductivity is in essence not multi gaussian distributed and the groundwater flow equation is not linear after updating the non multi gaussian conductivity using the standard enkf the histogram of conductivity tends to be gaussian and the inherent curvilinear structures that are critical for flow and transport migration can deteriorate li et al 2015 to handle non gaussian aspects in the enkf the ns enkf was proposed by zhou et al 2011 in which parameters and states are transformed to gaussian through a normal score procedure and after updating using the enkf they are transformed back for feeding forward simulators and for assimilating data at the next time step this approach has been used in a number of studies in the fields of petroleum engineering and hydrogeology as an alternative to the enkf the iterative ensemble smoother is becoming popular for data assimilation particularly in the petroleum field because it can assimilate all the data at all time steps and does not need to run recurringly forward simulators therefore it has a much less computational cost compared to the standard enkf this paper presents a novel approach for data assimilation in the non multi gaussian distributed conductivity field in this approach we borrowed the computational efficiency of the es for data assimilation and used the capability of the normal score transform for dealing with non gaussian aspects the coupled ns es was demonstrated in a synthetic example where the reference conductivity was generated through an mps procedure and its preferred flow conduits would have a significant impact on the flow and transport migrations the results were evaluated by the quality of aquifer characterization including connectivity and predictions of flow and transport to demonstrate its effectiveness and robustness we also compared the proposed ns es to the ns enkf using the same example the results show that 1 the ns es has the ability to reproduce the curvilinear structures of the reference field i e connectivity using hydraulic head data and the flow and transport predictions are improved after head data are conditioned 2 the ns es can achieve comparable results to the ns enkf for characterization of non multi gaussian conductivity fields and has the advantage of much less computational cost these findings show that the ns es is an effective and efficient approach for data assimilation in non multi gaussian conductivity fields acknowledgements the first author acknowledges the financial support of the south dakota board of regents through a competitive research grant the authors also wish to thank the two anonymous reviewers for their comments which substantially helped to improve the final version of the manuscript 
6919,the ensemble kalman filter enkf has been widely applied to assimilate dynamic data such as hydraulic head in geologic models for improved predictions over the past decade it has various advantages such as the capability of handling multiple sources of uncertainty and ease of coupling with forward simulators involving complex physics however it is not reliable for updating models that are characterized by curvilinear structures such as in fluvial deposits where high permeability conduits play a dominant role for solute transport several methods have been proposed to handle non gaussian aspects in the enkf for instance the enkf has been coupled with the normal score transform ns enkf for data assimilation in non multi gaussian distributed conductivity fields and this approach has been applied in a number of studies as an alternative to the enkf the iterative ensemble smoother es has been proposed for data assimilation where all the data at all time steps are integrated into geologic models together instead of the sequential data integration of the enkf the es therefore has much less computational cost than the enkf this work coupled the normal score transform and ensemble smoother ns es for data assimilation in non multi gaussian distributed conductivity fields the algorithm is compared to the ns enkf and evaluated in a synthetic bimodal aquifer the results show that 1 the ns es is able to reproduce the curvilinear structures of the reference field and the performance of updated models using the ns es is improved in terms of flow and transport predictions and 2 the ns es can obtain results comparable to the ns enkf for characterization of non multi gaussian conductivities and has the advantage of less computational cost keywords iterative ensemble smoother ensemble kalman filter groundwater modeling geostatistics non gaussianity 1 introduction data assimilation has been widely applied to make it practical for complex groundwater models to incorporate huge amounts of observed data that have become available from advances in sensor technologies specifically groundwater models with initial guesses of parameters and boundary conditions can be solved numerically but simulated state variables such as hydraulic head and concentration might not match field observations from sensors data assimilation is a process to match the simulated state variables with those observations through calibrating the unknown parameters at unsampled locations thus improving the predictive capability of groundwater models zhou et al 2014 over the last decade the ensemble kalman filter enkf an ensemble based real time data assimilation method was first proposed by evensen 2003 as an improvement of the extended kalman filter unlike the extended kalman filter where the covariance between the parameters and state variables is calculated and propagated with time through a linear transfer function kalman 1960 and where the groundwater flow equation is approximated linearly by a taylor series expansion the covariance is approximately computed through an ensemble of parameters and the correspondingly simulated state variables in the enkf advantages of the enkf include 1 computational efficiency without explicit calculation of the adjoint sensitivity matrix 2 the flexibility to couple with forward simulators 3 the capability to jointly calibrate multiple unknown parameters and 4 real time on line data assimilation hendricks franssen and kinzelbach 2009 it has been applied extensively in multidisciplinary fields such as petroleum engineering and groundwater studies for example the enkf was used to calibrate a range of aquifer parameters conductivities e g chen and zhang 2006 crestani et al 2013 panzeri et al 2015 crestani et al 2015 porosity li et al 2012b conductivity tensors li et al 2012c dispersivities liu et al 2008 river bed conductivity kurtz et al 2014 and specific storage hendricks franssen et al 2011 li et al 2017 the potential state data applied for calibrating parameters mentioned above include hydraulic head concentration surface deformation solute travel time deduced from tracer tests and temperature the enkf would provide the best performance depending on the parameters and or state variables analyzed in each single case although the enkf has been widely applied for assimilating observed measurements in hydrogeology a number of studies have been pursued to deal with the non multi gaussian conductivity field e g zhou et al 2011 hu et al 2013 khodabakhshi and jafarpour 2013 li et al 2015 it is well known that the enkf has an optimal solution if the transfer function is linear and parameters follow a multi gaussian distribution however the groundwater equation is non linear and the conductivity field essentially has a non multi gaussian distribution anderson 2001 for instance the multiple point statistics mps method is becoming popular for modeling fluvial deposits and fractured reservoirs where preferred flow conduits play a dominant role in contaminant plume migration strebelle 2002 compared to traditional two point statistics the mps method has the ability to model curvilinear structures that are observed from a conceptual model i e the training image the challenge is how the enkf can be applied effectively for the non multi gaussian conductivities that are modeled by the mps zhou et al 2011 proposed to transform the non multi gaussian conductivities to gaussian by using a normal score procedure deutsch and journel 1998 before updating via the enkf this approach is termed as the well known ns enkf and has been applied in a range of studies for assimilating data in non multi gaussian settings e g schöniger et al 2012 li et al 2012a nejadi et al 2012 crestani et al 2013 tang et al 2015 xu and gómez hernández 2016 zovi et al 2017 hu et al 2013 introduced updating the probability field that is used to draw the conductivities in the mps using the enkf khodabakhshi and jafarpour 2013 proposed a probability conditioning method where the conductivity field is obtained by updating the dynamic data using the enkf and then the averaging of updated conductivities is used as secondary conditioning data for regenerating the conductivity fields in the mps li et al 2015 compared the enkf to an mps oriented data assimilation method and highlighted the importance of preserving curvilinear structures in groundwater flow and transport modeling as an alternative to the enkf the iterative ensemble smoother es has been proposed for assimilating state data with much less computational cost skjervheim et al 2011 unlike the enkf where the data are sequentially integrated into the groundwater models with the advance of time steps all the data at all time steps are combined together and assimilated into the groundwater model in the es because no recurring groundwater modeling is needed it has much less computational cost compared to the enkf the es has gained much less attention in groundwater work although many studies in petroleum applications exist e g chen and oliver 2012 bailey and baù 2010 applied the es for data assimilation in groundwater flow modeling in order to improve the method and to avoid the impact of strong non linearity of the transfer function an iterative es was proposed in which the same set of data is used continuously to refine the parameters chang et al 2017 coupled the iterative es with a surrogate model for flow data assimilation in a subsurface system it is worth noting that the iterative es works best for the multi gaussian conductivity fields as the enkf in this work the normal score method deutsch and journel 1998 is coupled for the first time with the iterative es for better modeling of the non multi gaussian conductivity field this borrows computational efficiency from the es and leverages the capability of the normal score transform for handling the non gaussian character of fluvial deposits the coupled ns es approach is compared to the previously developed ns enkf by zhou et al 2011 a synthetic example is used to demonstrate the effectiveness and robustness of the proposed ns es characterization of non multi gaussian conductivity and flow and transport predictions are gauged in the example 2 methodology 2 1 groundwater flow equation combining mass conservation and darcy s laws the forward groundwater flow model in an incompressible or slightly compressible saturated aquifer can be written as bear 1972 1 k h s s h t q where is the divergence operator x y z is the gradient operator x y z t k is hydraulic conductivity lt 1 h is hydraulic head l s s is specific storage l 1 t is time t and q is a source or sink t 1 2 2 ns enkf and ns es the ns enkf was first proposed by zhou et al 2011 for handling the non gaussian aspects of the enkf because the enkf is based on two point statistics i e covariance and it has an optimal solution for dealing with the multi gaussian conductivity field it can not handle curvilinear structures that are based on multiple point statistics and featured with non gaussian behavior to do this zhou et al 2011 introduced the normal score procedure in the enkf in this approach the non gaussian parameters and state variables are both transformed to gaussian via the normal score transform and then the enkf is applied to the transformed variables for updating with measurements the variables after updating are transformed back as the input for the forward simulator for integrating the data at the next time step or for predicting the states in the future if no further data are available regarding the es for coupling with the ns the framework is the same as the ns enkf the only difference is in how the data are integrated into the models which has a substantial impact on the computational cost in the ns es all the data at all time steps are transformed into gaussian with the normal score procedure and then the es is applied for estimating parameters in the ns enkf the data are sequentially integrated into models the ns enkf and ns es can be described as the following steps 1 initialization both methods use ensemble models to approximate the correlation between parameters and state variables these initial ensemble models are generated through geostatistical methods e g deutsch and journel 1998 strebelle 2002 hard data e g measured conductivity and secondary data such as sand probability can be conditioned in geostatistical simulations we assume that the scale of measurements is consistent with the grid size of the numerical model if not an upscaling procedure might be needed to reconcile these two scales li et al 2011 2 normal score function the log conductivity local conditional distribution function is built at each grid cells by using the ensemble models from the previous step the local normal score transfer function ϕ is constructed as well details for the normal score transfer function were given by deutsch and journel 1998 3 forecast forecast in the ns enkf the transient groundwater flow equation is solved from time t k 1 to t k for each model it can be described as 2 y k f x k 1 y k 1 where x k 1 and y k 1 denote the hydraulic conductivity and the piezometric head at time t k 1 y k means the simulated hydraulic head and f represents the groundwater flow model given boundary conditions sources and sinks forecast in the ns es the transient groundwater flow equation is solved from time t 0 to t k for each model it can be written as 3 y 1 y k f x 0 y 0 where x 0 is the initial guess of hydraulic conductivity and y 0 indicates the initial hydraulic head for the transient simulation and y 1 y k are the simulated heads from time t 1 to t k 4 normal score function build the local conditional distribution of head from the simulated heads of ensemble models and the normal score transform functions φ accordingly 5 update parameters using the observations y 1 o y k o transform the conductivity x from initial models simulated heads y and observations y o through normal score functions 4 x ϕ x y φ y y o φ y o estimate parameters in the ns enkf build the joint state vector φ which includes the transformed parameters and the transformed hydraulic heads based on the forward modeling using eq 2 for the realization i at time k this can be written as 5 φ i k x 1 x 2 x n t y 1 y 2 y n t i k where n denotes the number of grid cells for the groundwater model the joint state vector is updated by using the observation data y k o recall that the transformed observations y k o will be applied 6 φ k u φ k f g k y k o h φ k f where φ k u is the joint vector ensemble at time k and φ k f is the vector ensemble with the forecasted states and is an observation error with zero mean and covariance r g k is the kalman gain and can be written as 7 g k c x y k o c y k o y k o r 1 where c x y k o is the cross covariance between the transformed parameters and the transformed observations at time t k and c y k o y k o is the auto covariance between the transformed observations at time t k if the number of observations is m c x y k o and c y k o y k o have a size of n m and of m m respectively the covariances can be approximately calculated as 8 c x y o k j 1 n e x x y k o y k o t n e c y o k y o k j 1 n e y k o y k o y k o y k o t n e where n e denotes the number of realizations in the ensemble and x and y k o are the mean of x and y k o over the ensemble respectively estimate parameters in the ns es build the joint state vector φ which includes the transformed parameters and the transformed state variables for all the time steps on the basis of the forward modeling using eq 3 for the realization i this can be written as 9 φ i x 1 x 2 x t y 1 y 2 y n 1 t y y 2 y n 2 t y 1 y 2 y n k t i update the joint state vector using observations y o all the observations at all the time steps are transformed and included in y o 10 φ u φ f g y o h φ f where the kalman gain g is calculated as 11 g c x y o c y o y o r 1 in which c x y o is the cross covariance between the transformed parameters and the transformed observations at all the time steps with a size of n m k and c y o y o is the auto covariance between the transformed observations at all the time steps with a size of m k m k the detailed equations for calculating covariances are shown in eq 8 6 back transform the updated parameters 12 x ϕ 1 x 7 go back to step 3 until all the data from the remaining time steps are assimilated in the ns enkf for the ns es the program ends here but if the iterative version is applied go back to step 2 until a good match is achieved in terms of hydraulic heads as other iterative methods such as gradient based method zhou et al 2014 if the mismatch between simulated heads and observed values is lower than the defined threshold i e termination criterion a stable solution has been reached in other words the termination criterion is satisfied and then stop data assimilation this mechanism has been applied in the iterative es emerick and reynolds 2013 although both the ns enkf and the ns es update parameters and state variables only the parameters are used for predictions this means that the groundwater models need to re run from the very beginning for either assimilating the data of the next time step or for predicting states in the future the main reason is that the updated state variables might not be consistent with the updated parameters in terms of the underlying physics e g mass balance equation here also because the ns enkf must be re run in the model for assimilating data at each time step its computational cost is much greater than the ns es where all the data at all time steps are combined and assimilated together 3 an example a hypothetical aquifer mimicking field fluvial deposits will be used to demonstrate the proposed method in this case we only take the uncertainty of hydraulic conductivity into consideration for the sake of simplicity although other parameters such as porosity specific storage and boundary conditions might be unknown in the field as well this example has been used for demonstration of the capability of the ns enkf for data assimilation in a non multi gaussian distributed conductivity field li et al 2012a 3 1 problem set up the aquifer has a size of 300 m 240 m 10 m and is discretized into 100 columns by 80 rows by 1 layer a reference hydraulic conductivity field is generated through two steps at first the reference field is assumed to be composed of sand and silt or clay facies and modeled with an mps method developed by strebelle 2002 using the training image shown in fig 1 a the training image is a conceptual model of the target aquifer where sandy channels represent preferred flow conduits and are embedded in fine grained silt or clay floodplain deposits with low permeabilities then each of the facies is populated with continuous log conductivity values that are generated by sequential gaussian simulation through gslib deutsch and journel 1998 the log conductivity of the reference field and its histogram are presented in fig 1 b and c it is evident that the log conductivities have a bimodal distribution typical of fluvial deposits the assembled hydraulic conductivity shows preferred conduits as the training image that are of particular important for solute transport migration the aquifer model has no flow boundaries in the north and south a constant head boundary at the western edge and a prescribed flow rate of 270 5 m 3 d along the eastern edge the flow is distributed along the eastern boundary depending on conductances specific storage is assumed to be constant and equals 0 003 m 1 the initial head is 0 m over the domain the total simulation time is 500 days and discretized into 100 time steps with a geometric ratio of 1 05 modflow is used to solve the transient groundwater flow equation anderman et al 2002 the simulated head data from the first 60 time steps will be used as the conditioning data in the ns enkf and the ns es the well locations are shown in fig 1 d 3 2 assessment criteria three metrics will be used to evaluate the results these already have been used in other studies for assessing the results of data assimilation e g chen and zhang 2006 hendricks franssen and kinzelbach 2009 zhou et al 2011 zhang et al 2015 root mean square error rmse which can be used to measure the accuracy of estimation 13 rmse x 1 n i 1 n x ref i x i 2 1 2 where x i is log conductivity at location i x i represents its ensemble mean value at node i x ref i is the reference log conductivity value at location i and n is the number of nodes a better characterization of log conductivity is reached if the values for rems are small average ensemble spread aes aes can be used to gauge the precision of the estimation in other words it measures the uncertainty of ensemble realizations 14 aes x 1 n i 1 n σ x i 2 1 2 where σ x i 2 is the ensemble variance at location i connectivity the preferred flow conduits i e connectivity strongly affect flow and transport behavior e g wen and gómez hernández 1998 we applied the connectivity function defined by pardo igúzquiza and dowd 2003 to evaluate the connectivity in this approach the probability that two points are connected is computed the result is a function of distance that gives the probability that two points in the same facies are connected 3 3 results fig 2 displays the ensemble mean and ensemble variance of the calibrated log conductivities using the ns enkf and the ns es as we expected the ensemble mean and ensemble variance tend to be constant when no data are conditioned although each individual realization shows the strong heterogeneity of the reference in fig 1b the averaging of greater and smaller conductivities through the ensemble results in a constant value over the domain also the ensemble variance is a maximum if no data are considered in other words this represents the greatest uncertainty in terms of aquifer conductivity when the head data are integrated into the model through the ns enkf and the ns es the ensemble mean maps exhibit spatial patterns that are similar to the reference field in fig 1b recall that these channels play a critical role in flow and solute transport as demonstrated in studies e g davis 1986 zinn and harvey 2003 the ensemble variance is considerably reduced which means that the uncertainty is minimized given the data also the conductivities at the boundaries of channels have a larger variance i e uncertainty than those within the channels with only secondary data such as hydraulic head it is possible to fully characterize the curvilinear structures using the ns enkf and ns es besides the qualitative analyses of log conductivity through visualization we also quantitatively calculate the rmse and aes as shown in table 1 they show a great consistency with the previous ensemble mean and ensemble variance maps of log conductivity both the rmse i e accuracy and aes i e bias are significantly reduced indicating the importance of hydraulic head in data assimilation the connectivity with distance for different cases is displayed in fig 3 it is evident that the connectivity is mostly reduced with an increase of distance for the reference field this is consistent with visual observation of the reference log conductivity field in fig 1b for the case where no data are conditioned the connectivity has the greatest uncertainty and the ensemble mean of connectivity deviates from the reference as well for the cases of the ns enkf and ns es the ensemble spread of connectivities is reduced and their ensemble mean is close to the reference connectivity this means that the connectivity after updating conductivity using head data has a better estimation in terms of accuracy and precision fig 4 shows the hydraulic head predictions for observation well 25 the greatest uncertainty of conductivity surely results in the maximum uncertainty of simulated head if no data are conditioned as is the case of prior when head data are used to calibrate the conductivity through the ns enkf and the ns es the simulated heads are close to the heads from the reference field this is consistent with the characterization of conductivity and its connectivity note that only the heads from the first 60 time steps i e 67 days are used for the conditioning in both cases we conclude that both approaches achieve comparable results in terms of aquifer characterization and flow predictions but the ns es requires much less computational cost than the ns enkf because all the data from all time steps are assimilated together without the need to run the computationally expensive forward simulator recurringly our main purpose here is to see if the iterative ns es works for the characterization of non gaussian conductivity field and to compare its performance with the one using the ns enkf the convergence issue of the iterative es has been extensively discussed in other papers e g chen and oliver 2012 emerick and reynolds 2013 zhang et al 2014 for example emerick and reynolds 2013 show the mismatch between observations and simulated values converges when the number of iteration is larger using a synthetic reservoir example in other words increasing the number of data assimilation improved data matches and consequently increased the computational cost as well in their example four data assimilations result in a good match of water data how the converge changes with the number of iterations in groundwater modeling is beyond of scope of the paper and will be investigated in the future 3 4 transport predictions a transport experiment is conducted to test the predictive ability of the updated conductivity using hydraulic head data via the ns enkf and the ns es the boundary conditions for groundwater flow are the same as the previous flow modeling example porosity is set as constant and equal to 0 3 everywhere a vertical line source of contaminant is instantaneously released upstream close to the western boundary x 19 5 m a control plane located downstream near the eastern boundary x 290 m is used to record particle travel times the random walk particle tracking code rw3d fernàndez garcia et al 2005 is used to solve the transport equation in this approach the evolution in time of each particle is composed of a deterministic component from the local velocity for advection and a superposed brownian motion for dispersion also a constant displacement scheme is employed for decreasing computational effort in particle random walk modeling wen and gómez hernández 1996 the integrated breakthrough curves of normalized concentration at the control plane are computed and compared with the prior one and the reference breakthrough curves fig 5 it is clear that if hydraulic conductivity is not characterized well as in the case of prior the largest uncertainty for the simulated concentration is observed for both the ns enkf and the ns es the uncertainty of concentration is significantly reduced because of the hydraulic head data also the reference concentration is well represented by the ensemble mean and more importantly it is contained within the 90 confidence interval 4 conclusion the ensemble kalman filter has been applied in a wide range of disciplines for assimilating observation data because of its advantages such as real time data assimilation and ease of coupling with forward simulators the enkf has an optimal solution for multi gaussian distributed parameters and state variables and for the linear transfer function for porous and or fractured media however conductivity is in essence not multi gaussian distributed and the groundwater flow equation is not linear after updating the non multi gaussian conductivity using the standard enkf the histogram of conductivity tends to be gaussian and the inherent curvilinear structures that are critical for flow and transport migration can deteriorate li et al 2015 to handle non gaussian aspects in the enkf the ns enkf was proposed by zhou et al 2011 in which parameters and states are transformed to gaussian through a normal score procedure and after updating using the enkf they are transformed back for feeding forward simulators and for assimilating data at the next time step this approach has been used in a number of studies in the fields of petroleum engineering and hydrogeology as an alternative to the enkf the iterative ensemble smoother is becoming popular for data assimilation particularly in the petroleum field because it can assimilate all the data at all time steps and does not need to run recurringly forward simulators therefore it has a much less computational cost compared to the standard enkf this paper presents a novel approach for data assimilation in the non multi gaussian distributed conductivity field in this approach we borrowed the computational efficiency of the es for data assimilation and used the capability of the normal score transform for dealing with non gaussian aspects the coupled ns es was demonstrated in a synthetic example where the reference conductivity was generated through an mps procedure and its preferred flow conduits would have a significant impact on the flow and transport migrations the results were evaluated by the quality of aquifer characterization including connectivity and predictions of flow and transport to demonstrate its effectiveness and robustness we also compared the proposed ns es to the ns enkf using the same example the results show that 1 the ns es has the ability to reproduce the curvilinear structures of the reference field i e connectivity using hydraulic head data and the flow and transport predictions are improved after head data are conditioned 2 the ns es can achieve comparable results to the ns enkf for characterization of non multi gaussian conductivity fields and has the advantage of much less computational cost these findings show that the ns es is an effective and efficient approach for data assimilation in non multi gaussian conductivity fields acknowledgements the first author acknowledges the financial support of the south dakota board of regents through a competitive research grant the authors also wish to thank the two anonymous reviewers for their comments which substantially helped to improve the final version of the manuscript 
