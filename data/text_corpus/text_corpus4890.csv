index,text
24450,gross primary productivity gpp is the total amount of carbon absorbed by green plants through photosynthesis as an important part of the global carbon cycle photosynthesis is the process of converting solar energy into chemical energy therefore accurate estimation of gpp is important for understanding the regional and global carbon flux variations based on the flux data of spring maize under drip irrigation in northwest china during 2014 2018 this study compared and evaluated the simulation accuracy of several models for estimating gpp under different growing seasons and environmental conditions and optimized the rectangular hyperbolic rh model the results showed that none of these models consistently had the highest simulation accuracy over a 5 year period the total gpp simulated by the light response photosynthetic models was closer to the observed value than the light use efficiency lue model and stomatal conductance models under different growing stages and environmental conditions the simulation accuracy of different models was different 1 rh model had the best simulation effect when the maize was completely covered i e lai 2 but stomatal conductance photosynthesis transpiration coupling smpt sb model had the best simulation effect in the early growing stage 2 when the soil water content was high rh model has the best simulation effect on the contrary the simulation effect of the non rectangular hyperbolic n rh model was slightly better than other models 3 the lue model has a strong dependence on light conditions therefore when rn 100 all the other 8 models except the lue model could well simulate gpp when rn 100 the rh model had the best simulation effect 4 when vpd 1 5 the simulation accuracy of rh model was the highest when vpd 1 5 smpt sb had the best simulation effect to obtain parameters in the models more quickly and accurately we improved the rh model by establishing the relationship between maximum photosynthetic rate pmax and leaf area index lai initial quantum efficiency α and lai and obtained the rh lai model compared with the rh model the simulation accuracy of the improved rh lai model was improved and the reliability of the rh lai model was verified in other sites therefore the research results showed that in the regions with fewer observation indexes we can use the rh lai model with a simple structure and convenient calculation to calculate the daily gpp by integrating it on the time scale keywords gross primary production drip irrigated light use efficiency model light response photosynthetic model stomatal conductance model 1 introduction gross primary productivity gpp is an important indicator of vegetation s ability to fix co2 from the atmosphere and it is also an important component of the global material and energy cycle accurate estimation of gpp is critical to understanding the regional and global variations of carbon flux after decades of development eddy covariance technology has become the main technology to observe water heat carbon flux and provided the best method to measure net ecosystem exchange on the ecosystem scale net ecosystem exchange can be used to calculate gpp by modeling the respiration of the ecosystem this method has become the main method to calculate gpp due to the limited observation range of the eddy covariance system the gross primary productivity can not be directly observed on a regional or global scale therefore the model simulation has become the main method to predict the gpp of the terrestrial ecosystem so far many gpp prediction models have been proposed by researchers around the world the light use efficiency lue model can simulate the spatio temporal dynamic variation of the gross primary productivity monteith 1977 running et al 2000 in the light use efficiency model the gross primary productivity is the equation of photosynthetically active radiation par the proportion of par absorbed by the plant canopy fapar and the light use efficiency lue wang et al 2012 the model is based on two hypotheses one is that the gpp of the ecosystem is directly related to the par absorbed by the plant canopy second the light use efficiency is limited by the environmental factor running et al 2004 zhang et al 2015 the lue model has been widely used in the simulation of gpp the lue model is often used to calculate gpp on large scale wu et al 2012 based on the light use efficiency model many researchers have proposed new gpp estimation models and methods for ground survey and satellite remote sensing data potter et al 1993 xiao et al 2004 yuan et al 2007 wu et al 2012 compared the effects of different vegetation indexes on gpp in the maize field by using the lue model the photosynthetic rate of plants is closely related to environmental factors especially photosynthetically active radiation the relation between plant photosynthetic rate and photon flux density in the light response photosynthetic curve at present the research of light response model has made great progress and the commonly used light response photosynthetic models mainly includes the rectangular hyperbolic model baly 1935 kirschbaum and farquhar 1987 non rectangular hyperbolic model prioul and chartier 1977 rectangular hyperbolic correction model ye 2007 exponential curve model bassman and zwier 1991 and quadratic polynomial model duan et al 2010 the light response curve of leaf photosynthesis and its simulation is important to study the interaction between plant photosynthesis and environmental factors also it is critical to effectively simulate canopy photosynthesis and predict vegetation productivity yuan et al 2007 the light response photosynthetic model can reflect the maximum photosynthetic rate and apparent quantum efficiency of plants but the parameters obtained by different models often have obvious differences the stoma is an important way for plants to exchange water and carbon with the atmosphere in terrestrial ecosystems plants balance and optimize the relationship between photosynthesis and transpiration rate by regulating stomatal conductance the stomatal conductance photosynthesis transpiration coupling model smpt sb model regards the diffusion of co2 and h2o through stoma of leaves as a comprehensive physical and physiological phenomenon yu et al 2003 and introduces the internal conductance of co2 which effectively improves the practicability of the water carbon coupling model the model has high accuracy in the simulation of maize soybean and trees yu et al 2003 yu et al 2004 ren et al 2004 improved the parameters in the model and established a photosynthesis transpiration coupling model of the ecosystem on the canopy scale in the absence of water stress this model has high accuracy in the simulation of the photosynthetic rate on the canopy scale zhang et al 2013 conducted a water carbon coupling simulation on summer maize at leaf and canopy scales by smpt sb model and the results showed that the canopy scale photosynthesis estimated by the model was in good agreement with the measured values the ball berry leuning bbl model is developed based on the linear relationship between stomatal conductance and net photosynthetic rate leuning 1995 the optimal stomatal conductance osc model is a model of stoma conductance mechanism developed by using ball berry s semi empirical model as a reference based on the optimal stomatal behavior theory the parameters of the model have important biological significance from the perspective of the mechanism according to the optimal stomatal behavior theory stomatal optimal behavior is to maximize photosynthetic carbon fixation and minimize transpiration in a certain period cowan and farquhar 1977 the jarvis model is a fully empirical multiplicative model based on the relationship between stomatal conductance and environmental factors which can not only simulate the stomatal conductance at leaf scale but also at canopy scale tan et al 2019 bai et al 2019 xu et al 2019 in practical application the jarvis model can be used to simulate stomatal conductance and then the bbl model and osc model can be used to solve the photosynthetic rate of plants in reverse and then the photosynthetic rate of plants can be obtained in our study we simulated the gpp of spring maize under drip irrigation in the arid region of northwest china from 2014 to 2018 through several models and compared the results with the observed gpp to evaluate the accuracy of the simulation of models the main purposes of our study are 1 to evaluate the accuracy of different models in simulating gpp 2 to study the applicability of different models in different growing stages and different environmental conditions 3 introduce crop growth function to improve the light response photosynthetic model 2 models 2 1 lue model due to its clear mechanism and simple structure the light use efficiency model is widely used in the estimation of vegetation productivity over large areas behrenfeld et al 2001 this model only needs the meteorological data as the model input and the fundamental methodology of gpp estimation is based on monteith s 1972 equation monteith 1972 1 g p p l u e f a p a r p a r where gpp μmol co2 m 2 s 1 represents the absorbed co2 lue is the light use efficiency μmol co2 umol 1 photons par is photosynthetically active radiation μmol photons m 2 s 1 and f a p a r represents the fraction of absorbed par there was a close correlation between the lai and f a p a r of different vegetation types for this reason f a p a r was calculated based on lai observations and light extinction coefficient k 0 68 allen et al 1964 ruimy et al 1999 2 f a p a r 0 95 1 e k l a i the lue model employs down regulating scalars ranging from 0 1 to characterize the effect of temperature f t and water stress f w on the lue as yuan et al 2007 3 l u e l u e m a x f t f w where luemax is the maximum light use efficiency luemax used in the calculation of the showing results was obtained based on the observed data in 2014 f t was calculated at each time step as in the terrestrial ecosystem model raich et al 1991 as 4 f t t t m i n t t m a x t t m i n t t m a x t t o p t 2 where t is the air temperature and tmin tmax and topt represent the minimum maximum and optimum temperatures for photosynthesis c respectively the latent heat le w m 2 and sensible heat h w m 2 were used to account for the effect of water stress on photosynthesis as yuan et al 2007 5 f w l e l e h 2 2 light response photosynthetic model 2 2 1 rectangular hyperbolic model rh model the rh model was proposed by baly in 1935 baly 1935 which has the advantages of a few parameters and high simulation accuracy the mathematical expression of the rectangular hyperbolic model is as follows 6 g p p α p a r p max α p a r p max where α μmol co2 μmol 1 photons is the slope of the light response curve of plant photosynthesis at i 0 also known as the initial quantum efficiency and pmax μmol co2 m 2 s 1 is the maximum photosynthetic rate other symbols have the same meaning as equation 1 2 2 2 non rectangular hyperbolic model n rh model the expression of the n rh model thornley 1976 is 7 g p p α p a r p m a x α p a r p m a x 2 4 θ α p a r p m a x 2 θ where θ is the convexity of the curve the greater the convexity the greater the bending degree of the curve and the value range is 0 1 other symbols have the same meaning as equation 6 2 2 3 rectangular hyperbolic correction r rh model a rectangular hyperbolic correction model of plant photosynthetic response to light ye 2007 8 g p p α 1 β p a r 1 γ p a r p a r where gpp α pmax and par are defined as equation 6 β is the photoinhibition coefficient γ is the light saturation coefficient 2 2 4 exponential curve exp model the mathematical expression of the exponential model is as follows bassman and zwier 1991 9 g p p p m a x 1 e α p a r p m a x where gpp α pmax and par are defined as equation 6 2 2 5 quadratic polynomial qua model the mathematical expression of the quadratic polynomial equation is as follows duan et al 2010 10 g p p a p a r 2 b p a r c where gpp and par are defined as equation 6 a b and c are experience parameters 2 3 stomatal conductance model 2 3 1 stomatal conductance photosynthesis transpiration coupling smpt sb model the smpt sb model can be expressed as yu et al 2003 11 g p p c a γ 1 1 56 a 1 f d s r a 1 37 r b w r i c where gpp is the photosynthetic rate at canopy scale μmol m 2 s 1 ca is the ambient co2 concentration μmol mol 1 γ is co2 compensation point without dark respiration μmol mol 1 a1 is the constant we calculated that a1 is equal to 3 85 by using 2014 data f d s is the response of stomatal conductance to humidity ra is aerodynamic resistance m2 s mol 1 rbw is the boundary layer resistance m2 s mol 1 ric is the canopy conductance for co2 m2 s mol 1 co2 compensation point without dark respiration γ for c3 plants can be written as brooks and farquhar 1985 12 γ c 3 42 7 1 68 t 25 0 012 t 25 2 where t is air temperature c and for c4 plants woodward and smith 1994 the γ is 13 γ 0 1 γ c 3 f d s can be written as 14 f d s h s where hs is relative humidity aerodynamic resistance ra can be expressed as 15 r a 2 24 1 0 2 z m d z o m in z h d z o h k 2 u z where 2 24 10 2 is the coefficient that goes from s m 1 to m2 s mol 1 boundary layer resistance rbw can be expressed as 16 r b w 2 24 10 2 100 α 2 l w u h 1 2 1 e α 2 where α is the attenuation coefficient of wind speed in the canopy α 3 l is the leaf area index w is leaves wide m uh is the speed at the height of the canopy m s 1 2 3 2 ball berry leuning bbl model based on the linear relationship between photosynthetic rate and stomatal conductance leuning proposed the bbl model in 1995 leuning 1995 and its form is as follows 17 g s g 0 g 1 a c a γ 1 v p d v p d 0 therefore the mathematical expression to calculate photosynthesis is 18 a g s g 0 g 1 c a γ 1 v p d v p d 0 where a is the net photosynthesis rate at leaf scale μmol m 2 s 1 gs is actual stomatal conductance g0 is the stomatal conductance to h2o at zero photosynthesis leuning 1995 tuzet et al 2003 and g0 takes 0 in this study ji et al 2017 g 1 is a fitted parameter vpd0 is a characteristic parameter reflecting the response of stomatal to vapor pressure deficit ca is ambient co2 concentration γ is the co2 compensation point of photosynthesis and it takes 6 5 μmol mol 1 for soybean and maize ji et al 2017 according to the measured a ci response curve to scale leaf level photosynthesis to canopy level photosynthesis an approach suggested by sellers et al 1992 was used to describe the relationship between canopy photosynthesis gpp and leaf level photosynthesis a wang et al 2016 19 g p p a 1 exp k l a i k 2 3 3 optimal stomatal conductance osc model the osc model has combined the biophysical and biochemical processes of transpiration and photosynthesis and is different from phenomenological empirical approaches the form of the osc model is as follows 20 g s g 0 1 6 1 g 1 v p d p a c a therefore the mathematical expression to calculate photosynthesis is 21 a g s g 0 1 6 1 g 1 v p d p c a 22 g 1 3 γ λ 1 6 where a ca gs and g0 have similar meaning with that of the bbl model lin et al 2012 de kauwe et al 2013 heroult et al 2013 p is average atmospheric pressure g1 in the osc model depends on the marginal water cost of carbon gain λ ji et al 2017 and λ is defined from physiological significance as follows 23 λ e g s a g s where e and a are leaf transpiration rate and net photosynthesis rate e gs and a gs are the sensitivity of stomatal conductance to transpiration rate and photosynthetic rate respectively it shows that λ is difficult to obtain directly from the environmental factors so it is obtained by fitting the model λ in the osc model takes λmax and it takes 4204 mol h2o mol 1 co2 for maize ji et al 2017 the gpp was calculated according to equation 19 which promoted leaf scale photosynthesis to canopy scale 3 materials and methods 3 1 site description the experiment was conducted in shiyanghe experimental station which is located in wuwei city gansu province china this area is located at the eastern end of the hexi corridor the annual average temperature is 8 c the annual average cumulative temperature is more than 3550 c and the average sunshine hours are more than 3000 h li et al 2018 the water resource is scarce the annual average pan evaporation is more than 2000 mm while the average rainfall over the years is only 164 mm and the groundwater table is 40 50 m below the ground surface li et al 2015 the soil texture at 0 0 8 meters deep is silty loam li et al 2015 the average soil dry bulk is 1 52 g cm 3 and the average field capacity is 0 32 m3 m 3 the width and interval of the plastic mulches were 1 2 m and 0 4 m respectively and 4 seed rows and 2 drip lines were covered emitters were located every 0 3 m along the drip line and the discharge rate was 3 2 l h 1 he et al 2018 the irrigation times were 7 8 8 7 and 8 times in each growing season from 2014 to 2018 and the total irrigation amount was 350 400 426 8 368 3 and 421 9 mm respectively the irrigation source is groundwater 3 2 the measurements of carbon flux environmental factors and leaf area index lai the experimental observation area is 400 m long and 200 m wide and the eddy covariance system is located in the center of the experimental area which can meet the requirements of the wind wave the eddy covariance system consisted of an open path infrared gas analyzer ec150 campbell scientifc inc usa and a three dimensional anemometer csat3 campbell scientifc inc usa both installed at a height of 3 m above the ground air temperature ta and relative humidity rh were measured by a temperature and humidity probe at 3 m hmp155a csi usa photosynthetic active radiation par were measured with a hobo automatic weather station onset computer corporation usa soil moisture probes cs616 campbell scientific inc usa were installed to monitor the variations in the soil temperature and soil water content swc respectively at depths of 20 cm 40 cm 60 cm 80 cm and 100 cm at the same time the soil moisture content of each soil layer was measured by the drying method and the soil moisture content measured by the soil moisture sensor was calibrated by manual sampling every 7 10 days according to the calculation principle of the eddy covariance technique the net ecosystem exchange nee is directly observed by the instrument the observed value of gpp used in this paper is calculated by nee and ecosystem respiration er half hour nee was gap filled and separated into half hour re and gpp using standard procedures and then converted into 24 hour daily averages the data processing process mainly includes 1 the data with a frequency of 10 hz was converted into data with a frequency of 30min by loggernet software 2 to reduce the heterogeneity of vegetation on the underlying surface and the errors caused by instrument installation eddy pro software li cor usa was used to carry out the coordinate rotation density correction and stationariness test on the data in the case of weak turbulence the flux measured by the eddy covariance system can not reflect the real exchange of the underlying surface well the frictional wind speed u of air can be used as a criterion to judge the strength of air turbulence in other words only when the frictional wind speed is greater than a certain threshold the co2 flux data measured in this period can be regarded as credible this threshold is called the critical frictional wind speed since the stability of atmospheric conditions at night reduced the quality of the data we use the frictional wind speed to process the data according to the average test method we eliminated the night data when the frictional wind speed was less than the critical frictional wind speed form 2014 to 2018 the critical friction wind speeds were 0 15 m s 1 0 15 m s 1 0 20 m s 1 0 18 m s 1 and 0 12 m s 1 respectively 3 to achieve the continuity and integrity of the data interpolation is carried out data gaps caused by turbulent flux or instrument failure are divided into the short gap 2 h and the long gap 2 h gao et al 2017 the former was filled by linear interpolation while the latter was filled by statistical and empirical models baldocchi 2003 the michaelis menten equation michaelis and menten 1913 was used for the daytime data gaps 24 n e e e r α p a r p m a x p m a x m a x the van t hoff equation was used for nighttime data gaps collatz et al 1991 25 e r e r r e f e x p b t s t r e f where erref is the reference er at 10 c b is the regression parameter ts is the surface temperature and tref is the reference surface temperature at 10 c the difference between the nee and the calculated er is gpp 26 g p p e r n e e the leaf surface area was measured every seven to ten days from the seedling stage to crop harvest in the field we chose six different locations with nine representative plants at each site a measuring tape minimum scale mm was used to measure the length and width of each leaf the lai of the maize leaves can then be obtained using the following formula eq 1 guo et al 2019 27 l a i 0 74 i 1 n l i w i d s where lai is the leaf area index of maize 0 74 is the empirical constant li is the length of leaf i wi is the width of leaf i and d and s are the distance between two rows and the space between two plants respectively 3 3 parameter fitting and accuracy evaluation in order to obtain a set of relatively stable parameter values from the first day of emergence we took 15 days as a window and slid once every 5 days to fit the parameters so that a set of parameters were obtained every 5 days then linear interpolation was carried out using the parameters obtained every 5 days so that the dynamic parameters changing with the development of maize were obtained the 2014 observation data were used to fit the model parameters and the observation data from 2015 to 2018 were used to verify the model prediction accuracy decision coefficient r2 root mean square error rmse and relative mean bias error mbe was used to evaluate the accuracy 28 r 2 i 1 n o i o s i s i 1 n o i o 2 i 1 n s i s 2 2 29 r m s e 1 n i 1 n s i o i 2 30 m b e 1 n i 1 n s i o i 1 n i 1 n o i where si and oi are the simulated and observed values respectively s and o are the mean simulated and observed values n is the number of samples the three indexes represent the average degree of the relative degree of regression contribution absolute error and the relative mean bias error between the simulated and measured values 4 results 4 1 comparisons of the several models in estimating gpp to evaluate the simulation accuracy of the different models we compared gpp simulated by the nine models with the observed gpp fig 1 showed the comparison of maize gpp estimated by the nine models gppm and that measured by eddy covariance gppec during the growing season of 2014 2018 except for 2014 the lue model underestimated the trend of maize gpp in other years fig 1 a the average underestimation of gpp by the lue model was 15 5 year r2 was 0 81 mbe was 16 and rmse was 3 16 g c m 2 d 1 table 1 this indicated that the results simulated by the lue model were significantly lower than that observed by the eddy covariance system during the whole growing period compared with the lue model results simulated by light response photosynthetic models were larger than observed gpp values fig 2 b f the rh model underestimated gpp by an average of 12 r2 by 0 80 mbe by 3 and rmse by 2 78 g c m 2 d 1 these results showed that the rh method had better reliability than the lue model and simulated gpp table 1 except for 2015 the n rh model overestimated the gpp trend in maize fields in the other four years fig 2 c from the overall analysis the n rh model underestimated gpp by an average of 10 5 year r2 of 0 76 mbe of 2 and rmse of 2 92 g c m 2 d 1 table 1 r rh model showed the same pattern as the n rh model the average underestimation of gpp by the r rh model was 2 r2 was 0 78 mbe was 9 and rmse was 3 40 g c m 2 d 1 exp model and qua model underestimated gpp by 10 and 2 r2 by 0 77 and 0 74 mbe by 5 and 3 and rmse by 3 19 and 2 85g c m 2 d 1 respectively compared with the lue model and light response photosynthetic models stomatal conductance models had a poor simulation effect fig 2 g i the smpt sb model underestimated gpp by 28 5 year r2 by 0 83 mbe by 17 and rmse by 3 25g c m 2 d 1 table 1 the overall analysis of the 5 year results showed that bbl and osc models underestimated gpp by 24 and 38 r2 by 0 80 and 0 64 mbe by 11 and 11 and rmse by 2 92 and 3 75g c m 2 d 1 respectively in terms of the overall simulation accuracy the nine models had little difference in the simulation of gpp of the maize field under drip irrigation in the arid areas of northwest china and the simulation accuracy was relatively high however from the perspective of variation the different models still had some room for improvement in the accurate simulation of seasonal variation fig 2 showed the seasonal variation of gpp simulated by 9 models during the growing period of maize although each model could well simulate the daily variation of gpp there were some differences in the simulated values fig 2 the simulated values of the lue model were close to the observed values in the early and late growing stage of maize but it was underestimated in the middle growing stage rainy weather rh model could simulate gpp well in the middle growing stage but overestimate gpp in the early growth stage and later growth stage the gpp simulated by n rh model was significantly higher than the measured value in the middle period except for 2015 and the r rh model exp model and qua models showed the same variations smpt sb model underestimated gpp during the whole growth period of maize while bbl model s simulated values were higher than the measured value in the early growth period and significantly lower than the measured values in the middle growth period osc model was the worst at simulating the seasonal variation of gpp especially in the middle and late stage of maize growth therefore the nine models showed a certain difference under different growth stages and weather conditions of maize in simulating the seasonal variation of maize gpp 4 2 the accuracy of total gpp modeling by the several models in order to test the accuracy of these models in simulating the total amount of gpp our study compared and analyzed the total simulated gpp and the observed gpp the accuracy of each model was inconsistent in different years table 2 in 2014 the total gpp was 1115 53 g c m 2 and the value of simulation ranges from 1206 43 to 1479 65 g c m 2 among which the smpt sb model simulated the most closely while the osc model had the largest difference in 2015 the simulation value of smpt sb model was the closest to the observed value 1704 02 g c m 2 while the simulation effect of osc model was the worst in 2016 the r rh model had the largest simulation effect while the bbl model had the worst in 2017 the observed gpp value was 1068 65 g c m 2 the model simulation range was 772 19 1558 74 g c m 2 and the simulated value of lue model was 903 97 g c m 2 which was the closest to the measured value in 2018 smpt sb model s simulation value was the smallest only 982 38 g c m 2 qua model s simulation value was the largest 1501 96 g c m 2 and bbl model s simulation value was the closest to the observed value which was 1221 99 g c m 2 to sum up from the total amount of simulated gpp in the whole growth period the smpt sb model in 2014 was close to the observed value qua model in 2015 r rh model in 2016 lue model in 2017 and exp model in 2018 on the average of 5 years the simulated values of the photosynthetic response model were closer to the observed values than the other four models 4 3 applicability of the models under different conditions in order to analyze the applicability of different models under different conditions the accuracy of the nine models was analyzed according to different crop growth conditions lai soil moisture conditions f θ net radiation rn and saturation vapor pressure difference vpd leaf area index lai is an important indicator of plant growth which is closely related to the biological characteristics and environmental conditions of plants since the water saving irrigation technology with drip irrigation under film mulch was adopted in the experimental area the original water infiltration process has been changed which has a significant impact on the growth of crops net radiation reflects the amount of energy received by the leaves which is not only related to geographical location and weather conditions but also inseparable from the growth status of the crop the difference in saturation vapor pressure reflects the degree of dryness of the air which is closely related to air temperature and relative humidity and directly affects the status of plant stoma thus controlling the physiological processes such as transpiration and photosynthesis of plants the applicability of simulation under different conditions is fully considered which provides the research foundation for the improvement of the model 4 3 1 comparison of several methods in estimating maize gpp at different growth stages in the early stage of crop growth the leaf area index lai was small and the photosynthetic capacity of crops was weak so the plants were vulnerable to environmental variation according to the growing process of lai the crop growth process was divided into two parts namely lai 2 and lai 2 fig 3 the overall analysis of 2014 2018 data showed that when lai 2 the smpt sb model had the best simulation effect with r2 being 0 80 rmse was 1 73g c m 2 d 1 and e was 0 95 when lai 2 the simulated value of the rh model was the closest to the observed value r2 and e were the highest among the 9 models and rmse was the minimum fig 4 when lai 2 the simulated values of the lue model bbl model and osc model were significantly different from the observed values which respectively underestimated the gpp of maize field by 25 36 and 25 the light response photosynthetic models could simulate more than 92 of gpp while the smpt sb model underestimated the gpp by 14 fig 4 when lai 2 lue model underestimated 15 of maize field gpp rh model n rh model r rh model exp model and qua model respectively 21 24 13 11 and 26 of gpp smpt sb model underestimated 33 of gpp bbl model underestimated 35 of gpp osc model had the poor simulation effect and 60 of gpp was underestimated 4 3 2 comparison of several methods in estimating maize gpp at different environmental conditions soil moisture condition is one of the most important factors affecting crop growth and development plastic mulching can not only reduce soil evaporation but also increase soil temperature and promote crop growth however drip irrigation is different from traditional irrigation it adopts a small amount and multiple irrigation methods to make water slowly and evenly infiltrate into the soil which can maintain the soil structure and form an appropriate soil water fertilizer and heat environment in order to analyze the simulation effects of the models under different soil moisture conditions we divide soil moisture into two levels according to the normalized soil moisture f θ f θ 0 6 and f θ 0 6 31 f θ θ θ w θ s θ w where θ is soil water content θw is soil withering coefficient θs is the saturated moisture content when f θ 0 6 the simulation effect of the models was generally better than that of f θ 0 6 which indicated that when the proportion of available water in the soil was low the simulation effect of gpp was better when f θ 0 6 the accuracy of the light response photosynthetic models was not significantly different in the simulation of gpp the simulated gpp was only less than 10 lower than the observed value and the nash efficiency coefficient was all greater than 0 8 among them the simulation effect of the n rh model was slightly better than that of other models and the rmse was 2 67 g c m 2 d 1 when f θ 0 6 the simulation effect of the rh model was significantly higher than that of the other 8 models r2 was 0 73 rmse was 2 88 g c m 2 d 1 and nash efficiency coefficient was 0 72 fig 4 net radiation rn is divided into two grades rn 100 and rn 100 and the performance of different models under different weather conditions was analyzed when rn 100 all the other 8 models could well simulate spring corn gpp except the lue model nash efficiency coefficient was greater than 0 9 and rmse of rh model was the smallest only 2 58 g c m 2 d 1 when rn 100 the maximum r2 of the smpt sb model was 0 83 but the rmse of the rh model was the smallest among the 9 models only 2 85 and the value of e was the highest 0 81 fig 4 through the analysis of various models under different vpd conditions it was concluded that the performance of different models under different vpd conditions was not consistent from the perspective of r2 alone the simulation effect of lue n rh smpt sb and bbl models at vpd 1 5 was worse than that at vpd 1 5 from the perspective of rmse the values of lue and smpt sb models were not significantly different in the two cases and the rmse values of the other 7 models were smaller when vpd 1 5 on the whole rh simulation was the best when vpd 1 5 smpt sb had the best simulation effect when vpd 1 5 4 4 the improvement of rh model by introducing crop growth function when the light response photosynthetic models were used to simulate the gpp of maize field in the above paper the parameters were obtained by reverse derivation through the observation data in 2014 and the calculation process was quite complicated the photosynthesis of crops is not only related to environmental factors but also closely related to the growing status of crops based on pmax α and lai data obtained in 2014 the relationship between pmax and lai as well as between α and lai was established fig 5 pmax and lai showed a significant linear correlation and pmax increased with the increase of lai the relationship between α and lai was a quadratic polynomial and the specific expression was as follows 32 p m a x r 2 0 72 p 0 001 33 α 0 007 0 02 l a i 0 002 l a i 2 r 2 0 75 p 0 001 34 l a i l a i m 1 exp a 1 a 2 t a 3 t 2 where laim a1 a2 and a3 are parameters t is time 0 t 1 the simulated lai could better reflect the variation of spring maize lai fig 6 the r2 of the simulated effects from 2014 to 2018 were 0 95 0 93 0 99 0 96 and 0 97 respectively by substituting equation 35 into equation 33 and equation 34 pmax and α of the whole growth period of spring maize could be obtained the rh model which introduced the crop growth function was named the rh lai model the r2 of the improved rh lai model was improved in 2014 2015 and 2018 table 3 the r2 of rh model simulation results was 0 80 after the introduction of lai the r2 of the rh lai model was 0 83 with an increase of 0 03 the analysis results showed that the mbe of the simulation results of the rh lai model was not significantly different from that of the rh model compared with the rh model the rmse value was smaller and the overall results of 2014 2018 were 3 34 g c m 2 d 1 and 2 91g c m 2 d 1 respectively for rh and rh lai model simulation results to verify the efficiency of the rh lai model in different environments we selected another maize field site for verification the site is located in the north of our experimental area and is irrigated by traditional border irrigation by comparing the observed gpp and simulated results the rh lai model was confirmed to be able to better simulate the seasonal variation of gpp fig 7 the simulation effect of the rh lai model was good in the early growth stage of maize after maize entered the rapid growth stage the simulated results were slightly lower than the observed values the maximum value of gpp simulated by the model was equal to the observed value but at the end of growth the simulated results were higher than the observed value from the overall simulation result the r2 of three years was above 0 80 the rmse varied from 1 41 to 2 97 g c m 2 and the error between the total simulated gpp and the observed value was controlled within 8 5 discussion in this study we simulated the gpp values of maize under drip irrigation in the arid region of northwest china from 2014 to 2018 through several typical models and the simulation accuracy under different conditions was evaluated there were some differences in the simulation effects of different models in different years these models were not consistent under the influence of environmental factors in the light use efficiency model the light use efficiency is the key parameter that affects the gpp simulation therefore the accuracy of the light use efficiency directly affects the simulated effect of gpp however since lue cannot be measured directly it is difficult to accurately calculate lue wang et al 2020 light use efficiency is significantly limited by plant species and different ecological environments such as radiation temperature soil water content co2 concentration air humidity etc which can change the physiological and biochemical processes in plants thus affecting the progress of photosynthesis poni et al 2009 garbulsky et al 2011 research has found that when the temperature rises from 6 c to 18 c the light use efficiency of medicago sativa increases by 160 brown et al 2006 mccallum et al 2013 found that adding temperature into the lue model could improve the simulation accuracy of the model in cold regions with low temperatures chen et al 2009 also found that the daily light use efficiency was mainly affected by absorbed photosynthetically active radiation daily minimum temperature and water vapor pressure difference in cloudy weather the effect of diffuse radiation on the photosynthesis of crops cannot be ignored studies have shown that adding a cloudiness index to the lue model can improve the simulation accuracy of the model wang et al 2015 the simulation of the light response photosynthetic model is one of the important methods to study photosynthetic physiology and ecology of plants li et al 2019 through the physiological parameters in the light responsive photosynthetic model researchers can determine the operating status photosynthetic capacity and photosynthetic efficiency of the plant and evaluate the influence of environmental factors on them ye and yu 2008 xia et al 2014 biophysical factors can influence plant growth and metabolism especially photosynthesis many studies have shown that photosynthetic parameters vary with biophysical factors based on observational data the researchers found that in the n rh model the maximum photosynthetic rate increases with air temperature and decreases with the temperature above 30 c berry and björkman 1980 greer and weedon 2012 ren et al 2018 found that the maximum photosynthetic rate in the r rh model was significantly positively correlated with relative humidity rh soil moisture content also has a certain influence on the parameters of the light response photosynthetic model ge et al 2012 lang et al 2013 xia et al 2014 li et al 2019 qiao et al 2020 accurate estimation of canopy stomatal conductance is very important when using the stomatal conductance model to simulate canopy photosynthesis canopy stomatal conductance is strongly influenced by plant physiological status and environmental factors photosynthetically active radiation water vapor pressure deficit temperature soil moisture etc du et al 2018 xu et al 2021 vpd is considered to be a major limiting factor in determining plant gas exchange grossiord et al 2020 high vpd caused decreases in canopy conductance higher vpd is generally detrimental to plant productivity pasqualotto et al 2021 radiation is another important factor regulating canopy stomatal conductance previous studies have shown that canopy stomatal conductance increases with increasing radiation reaching an optimal level and then remains stable with increasing radiation komatsu et al 2012 xu et al 2021 some studies have shown that the increase of temperature leads to the increase of daily canopy stomatal conductance barron et al 2010 harris et al 2004 found that soil moisture was the main controlling factor affecting canopy conductance at seasonal and annual scales 6 conclusions based on the flux data of spring maize under drip irrigation in the arid areas of northwest china during 2014 2018 this study compared and evaluated several models for estimating the gross primary productivity of ecosystems under different growing and environmental conditions the results showed that the values of the light response photosynthetic models rh n rh r rh exp and qua were higher than the observed values and the lue model smpt sb model bbl model and osc model were underestimated in the simulated maize field gpp meanwhile the total gpp simulated by the light response photosynthetic model was closer to the observed value than the other four models however considering the applicability of the models under different circumstances the smpt sb model performed better when lai was low when lai 2 rh model was best when soil moisture was low n rh model had a better simulation effect otherwise it was rh model when rn 100 all the other 8 models except lue model could well simulate gpp when rn 100 the accuracy of the simulation rh model was the highest when vpd 1 5 rh simulation was the best otherwise the smpt sb model had the best simulation effect the rh model was improved by establishing the relationship between pmax and lai and between α and lai which improved the accuracy of gpp simulation in the maize field therefore the research results showed that in the regions with fewer observation indexes we could use the rh lai model with a simple structure and convenient calculation to calculate the daily gpp by integrating it on the time scale credit authorship contribution statement hui guo data curation methodology writing original draft sien li conceptualization resources writing review editing funding acquisition shaozhong kang supervision writing review editing taisheng du writing review editing wenfeng liu writing review editing ling tong writing review editing xinmei hao writing review editing risheng ding writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that cdocould have appeared to influence the work reported in this paper acknowledgments we greatly appreciate the careful and precise reviews by anonymous reviewers they paid great efforts on improving the manuscript and study this work was financially supported by the chinese national natural science fund 51879262 51725904 51790530 
24450,gross primary productivity gpp is the total amount of carbon absorbed by green plants through photosynthesis as an important part of the global carbon cycle photosynthesis is the process of converting solar energy into chemical energy therefore accurate estimation of gpp is important for understanding the regional and global carbon flux variations based on the flux data of spring maize under drip irrigation in northwest china during 2014 2018 this study compared and evaluated the simulation accuracy of several models for estimating gpp under different growing seasons and environmental conditions and optimized the rectangular hyperbolic rh model the results showed that none of these models consistently had the highest simulation accuracy over a 5 year period the total gpp simulated by the light response photosynthetic models was closer to the observed value than the light use efficiency lue model and stomatal conductance models under different growing stages and environmental conditions the simulation accuracy of different models was different 1 rh model had the best simulation effect when the maize was completely covered i e lai 2 but stomatal conductance photosynthesis transpiration coupling smpt sb model had the best simulation effect in the early growing stage 2 when the soil water content was high rh model has the best simulation effect on the contrary the simulation effect of the non rectangular hyperbolic n rh model was slightly better than other models 3 the lue model has a strong dependence on light conditions therefore when rn 100 all the other 8 models except the lue model could well simulate gpp when rn 100 the rh model had the best simulation effect 4 when vpd 1 5 the simulation accuracy of rh model was the highest when vpd 1 5 smpt sb had the best simulation effect to obtain parameters in the models more quickly and accurately we improved the rh model by establishing the relationship between maximum photosynthetic rate pmax and leaf area index lai initial quantum efficiency α and lai and obtained the rh lai model compared with the rh model the simulation accuracy of the improved rh lai model was improved and the reliability of the rh lai model was verified in other sites therefore the research results showed that in the regions with fewer observation indexes we can use the rh lai model with a simple structure and convenient calculation to calculate the daily gpp by integrating it on the time scale keywords gross primary production drip irrigated light use efficiency model light response photosynthetic model stomatal conductance model 1 introduction gross primary productivity gpp is an important indicator of vegetation s ability to fix co2 from the atmosphere and it is also an important component of the global material and energy cycle accurate estimation of gpp is critical to understanding the regional and global variations of carbon flux after decades of development eddy covariance technology has become the main technology to observe water heat carbon flux and provided the best method to measure net ecosystem exchange on the ecosystem scale net ecosystem exchange can be used to calculate gpp by modeling the respiration of the ecosystem this method has become the main method to calculate gpp due to the limited observation range of the eddy covariance system the gross primary productivity can not be directly observed on a regional or global scale therefore the model simulation has become the main method to predict the gpp of the terrestrial ecosystem so far many gpp prediction models have been proposed by researchers around the world the light use efficiency lue model can simulate the spatio temporal dynamic variation of the gross primary productivity monteith 1977 running et al 2000 in the light use efficiency model the gross primary productivity is the equation of photosynthetically active radiation par the proportion of par absorbed by the plant canopy fapar and the light use efficiency lue wang et al 2012 the model is based on two hypotheses one is that the gpp of the ecosystem is directly related to the par absorbed by the plant canopy second the light use efficiency is limited by the environmental factor running et al 2004 zhang et al 2015 the lue model has been widely used in the simulation of gpp the lue model is often used to calculate gpp on large scale wu et al 2012 based on the light use efficiency model many researchers have proposed new gpp estimation models and methods for ground survey and satellite remote sensing data potter et al 1993 xiao et al 2004 yuan et al 2007 wu et al 2012 compared the effects of different vegetation indexes on gpp in the maize field by using the lue model the photosynthetic rate of plants is closely related to environmental factors especially photosynthetically active radiation the relation between plant photosynthetic rate and photon flux density in the light response photosynthetic curve at present the research of light response model has made great progress and the commonly used light response photosynthetic models mainly includes the rectangular hyperbolic model baly 1935 kirschbaum and farquhar 1987 non rectangular hyperbolic model prioul and chartier 1977 rectangular hyperbolic correction model ye 2007 exponential curve model bassman and zwier 1991 and quadratic polynomial model duan et al 2010 the light response curve of leaf photosynthesis and its simulation is important to study the interaction between plant photosynthesis and environmental factors also it is critical to effectively simulate canopy photosynthesis and predict vegetation productivity yuan et al 2007 the light response photosynthetic model can reflect the maximum photosynthetic rate and apparent quantum efficiency of plants but the parameters obtained by different models often have obvious differences the stoma is an important way for plants to exchange water and carbon with the atmosphere in terrestrial ecosystems plants balance and optimize the relationship between photosynthesis and transpiration rate by regulating stomatal conductance the stomatal conductance photosynthesis transpiration coupling model smpt sb model regards the diffusion of co2 and h2o through stoma of leaves as a comprehensive physical and physiological phenomenon yu et al 2003 and introduces the internal conductance of co2 which effectively improves the practicability of the water carbon coupling model the model has high accuracy in the simulation of maize soybean and trees yu et al 2003 yu et al 2004 ren et al 2004 improved the parameters in the model and established a photosynthesis transpiration coupling model of the ecosystem on the canopy scale in the absence of water stress this model has high accuracy in the simulation of the photosynthetic rate on the canopy scale zhang et al 2013 conducted a water carbon coupling simulation on summer maize at leaf and canopy scales by smpt sb model and the results showed that the canopy scale photosynthesis estimated by the model was in good agreement with the measured values the ball berry leuning bbl model is developed based on the linear relationship between stomatal conductance and net photosynthetic rate leuning 1995 the optimal stomatal conductance osc model is a model of stoma conductance mechanism developed by using ball berry s semi empirical model as a reference based on the optimal stomatal behavior theory the parameters of the model have important biological significance from the perspective of the mechanism according to the optimal stomatal behavior theory stomatal optimal behavior is to maximize photosynthetic carbon fixation and minimize transpiration in a certain period cowan and farquhar 1977 the jarvis model is a fully empirical multiplicative model based on the relationship between stomatal conductance and environmental factors which can not only simulate the stomatal conductance at leaf scale but also at canopy scale tan et al 2019 bai et al 2019 xu et al 2019 in practical application the jarvis model can be used to simulate stomatal conductance and then the bbl model and osc model can be used to solve the photosynthetic rate of plants in reverse and then the photosynthetic rate of plants can be obtained in our study we simulated the gpp of spring maize under drip irrigation in the arid region of northwest china from 2014 to 2018 through several models and compared the results with the observed gpp to evaluate the accuracy of the simulation of models the main purposes of our study are 1 to evaluate the accuracy of different models in simulating gpp 2 to study the applicability of different models in different growing stages and different environmental conditions 3 introduce crop growth function to improve the light response photosynthetic model 2 models 2 1 lue model due to its clear mechanism and simple structure the light use efficiency model is widely used in the estimation of vegetation productivity over large areas behrenfeld et al 2001 this model only needs the meteorological data as the model input and the fundamental methodology of gpp estimation is based on monteith s 1972 equation monteith 1972 1 g p p l u e f a p a r p a r where gpp μmol co2 m 2 s 1 represents the absorbed co2 lue is the light use efficiency μmol co2 umol 1 photons par is photosynthetically active radiation μmol photons m 2 s 1 and f a p a r represents the fraction of absorbed par there was a close correlation between the lai and f a p a r of different vegetation types for this reason f a p a r was calculated based on lai observations and light extinction coefficient k 0 68 allen et al 1964 ruimy et al 1999 2 f a p a r 0 95 1 e k l a i the lue model employs down regulating scalars ranging from 0 1 to characterize the effect of temperature f t and water stress f w on the lue as yuan et al 2007 3 l u e l u e m a x f t f w where luemax is the maximum light use efficiency luemax used in the calculation of the showing results was obtained based on the observed data in 2014 f t was calculated at each time step as in the terrestrial ecosystem model raich et al 1991 as 4 f t t t m i n t t m a x t t m i n t t m a x t t o p t 2 where t is the air temperature and tmin tmax and topt represent the minimum maximum and optimum temperatures for photosynthesis c respectively the latent heat le w m 2 and sensible heat h w m 2 were used to account for the effect of water stress on photosynthesis as yuan et al 2007 5 f w l e l e h 2 2 light response photosynthetic model 2 2 1 rectangular hyperbolic model rh model the rh model was proposed by baly in 1935 baly 1935 which has the advantages of a few parameters and high simulation accuracy the mathematical expression of the rectangular hyperbolic model is as follows 6 g p p α p a r p max α p a r p max where α μmol co2 μmol 1 photons is the slope of the light response curve of plant photosynthesis at i 0 also known as the initial quantum efficiency and pmax μmol co2 m 2 s 1 is the maximum photosynthetic rate other symbols have the same meaning as equation 1 2 2 2 non rectangular hyperbolic model n rh model the expression of the n rh model thornley 1976 is 7 g p p α p a r p m a x α p a r p m a x 2 4 θ α p a r p m a x 2 θ where θ is the convexity of the curve the greater the convexity the greater the bending degree of the curve and the value range is 0 1 other symbols have the same meaning as equation 6 2 2 3 rectangular hyperbolic correction r rh model a rectangular hyperbolic correction model of plant photosynthetic response to light ye 2007 8 g p p α 1 β p a r 1 γ p a r p a r where gpp α pmax and par are defined as equation 6 β is the photoinhibition coefficient γ is the light saturation coefficient 2 2 4 exponential curve exp model the mathematical expression of the exponential model is as follows bassman and zwier 1991 9 g p p p m a x 1 e α p a r p m a x where gpp α pmax and par are defined as equation 6 2 2 5 quadratic polynomial qua model the mathematical expression of the quadratic polynomial equation is as follows duan et al 2010 10 g p p a p a r 2 b p a r c where gpp and par are defined as equation 6 a b and c are experience parameters 2 3 stomatal conductance model 2 3 1 stomatal conductance photosynthesis transpiration coupling smpt sb model the smpt sb model can be expressed as yu et al 2003 11 g p p c a γ 1 1 56 a 1 f d s r a 1 37 r b w r i c where gpp is the photosynthetic rate at canopy scale μmol m 2 s 1 ca is the ambient co2 concentration μmol mol 1 γ is co2 compensation point without dark respiration μmol mol 1 a1 is the constant we calculated that a1 is equal to 3 85 by using 2014 data f d s is the response of stomatal conductance to humidity ra is aerodynamic resistance m2 s mol 1 rbw is the boundary layer resistance m2 s mol 1 ric is the canopy conductance for co2 m2 s mol 1 co2 compensation point without dark respiration γ for c3 plants can be written as brooks and farquhar 1985 12 γ c 3 42 7 1 68 t 25 0 012 t 25 2 where t is air temperature c and for c4 plants woodward and smith 1994 the γ is 13 γ 0 1 γ c 3 f d s can be written as 14 f d s h s where hs is relative humidity aerodynamic resistance ra can be expressed as 15 r a 2 24 1 0 2 z m d z o m in z h d z o h k 2 u z where 2 24 10 2 is the coefficient that goes from s m 1 to m2 s mol 1 boundary layer resistance rbw can be expressed as 16 r b w 2 24 10 2 100 α 2 l w u h 1 2 1 e α 2 where α is the attenuation coefficient of wind speed in the canopy α 3 l is the leaf area index w is leaves wide m uh is the speed at the height of the canopy m s 1 2 3 2 ball berry leuning bbl model based on the linear relationship between photosynthetic rate and stomatal conductance leuning proposed the bbl model in 1995 leuning 1995 and its form is as follows 17 g s g 0 g 1 a c a γ 1 v p d v p d 0 therefore the mathematical expression to calculate photosynthesis is 18 a g s g 0 g 1 c a γ 1 v p d v p d 0 where a is the net photosynthesis rate at leaf scale μmol m 2 s 1 gs is actual stomatal conductance g0 is the stomatal conductance to h2o at zero photosynthesis leuning 1995 tuzet et al 2003 and g0 takes 0 in this study ji et al 2017 g 1 is a fitted parameter vpd0 is a characteristic parameter reflecting the response of stomatal to vapor pressure deficit ca is ambient co2 concentration γ is the co2 compensation point of photosynthesis and it takes 6 5 μmol mol 1 for soybean and maize ji et al 2017 according to the measured a ci response curve to scale leaf level photosynthesis to canopy level photosynthesis an approach suggested by sellers et al 1992 was used to describe the relationship between canopy photosynthesis gpp and leaf level photosynthesis a wang et al 2016 19 g p p a 1 exp k l a i k 2 3 3 optimal stomatal conductance osc model the osc model has combined the biophysical and biochemical processes of transpiration and photosynthesis and is different from phenomenological empirical approaches the form of the osc model is as follows 20 g s g 0 1 6 1 g 1 v p d p a c a therefore the mathematical expression to calculate photosynthesis is 21 a g s g 0 1 6 1 g 1 v p d p c a 22 g 1 3 γ λ 1 6 where a ca gs and g0 have similar meaning with that of the bbl model lin et al 2012 de kauwe et al 2013 heroult et al 2013 p is average atmospheric pressure g1 in the osc model depends on the marginal water cost of carbon gain λ ji et al 2017 and λ is defined from physiological significance as follows 23 λ e g s a g s where e and a are leaf transpiration rate and net photosynthesis rate e gs and a gs are the sensitivity of stomatal conductance to transpiration rate and photosynthetic rate respectively it shows that λ is difficult to obtain directly from the environmental factors so it is obtained by fitting the model λ in the osc model takes λmax and it takes 4204 mol h2o mol 1 co2 for maize ji et al 2017 the gpp was calculated according to equation 19 which promoted leaf scale photosynthesis to canopy scale 3 materials and methods 3 1 site description the experiment was conducted in shiyanghe experimental station which is located in wuwei city gansu province china this area is located at the eastern end of the hexi corridor the annual average temperature is 8 c the annual average cumulative temperature is more than 3550 c and the average sunshine hours are more than 3000 h li et al 2018 the water resource is scarce the annual average pan evaporation is more than 2000 mm while the average rainfall over the years is only 164 mm and the groundwater table is 40 50 m below the ground surface li et al 2015 the soil texture at 0 0 8 meters deep is silty loam li et al 2015 the average soil dry bulk is 1 52 g cm 3 and the average field capacity is 0 32 m3 m 3 the width and interval of the plastic mulches were 1 2 m and 0 4 m respectively and 4 seed rows and 2 drip lines were covered emitters were located every 0 3 m along the drip line and the discharge rate was 3 2 l h 1 he et al 2018 the irrigation times were 7 8 8 7 and 8 times in each growing season from 2014 to 2018 and the total irrigation amount was 350 400 426 8 368 3 and 421 9 mm respectively the irrigation source is groundwater 3 2 the measurements of carbon flux environmental factors and leaf area index lai the experimental observation area is 400 m long and 200 m wide and the eddy covariance system is located in the center of the experimental area which can meet the requirements of the wind wave the eddy covariance system consisted of an open path infrared gas analyzer ec150 campbell scientifc inc usa and a three dimensional anemometer csat3 campbell scientifc inc usa both installed at a height of 3 m above the ground air temperature ta and relative humidity rh were measured by a temperature and humidity probe at 3 m hmp155a csi usa photosynthetic active radiation par were measured with a hobo automatic weather station onset computer corporation usa soil moisture probes cs616 campbell scientific inc usa were installed to monitor the variations in the soil temperature and soil water content swc respectively at depths of 20 cm 40 cm 60 cm 80 cm and 100 cm at the same time the soil moisture content of each soil layer was measured by the drying method and the soil moisture content measured by the soil moisture sensor was calibrated by manual sampling every 7 10 days according to the calculation principle of the eddy covariance technique the net ecosystem exchange nee is directly observed by the instrument the observed value of gpp used in this paper is calculated by nee and ecosystem respiration er half hour nee was gap filled and separated into half hour re and gpp using standard procedures and then converted into 24 hour daily averages the data processing process mainly includes 1 the data with a frequency of 10 hz was converted into data with a frequency of 30min by loggernet software 2 to reduce the heterogeneity of vegetation on the underlying surface and the errors caused by instrument installation eddy pro software li cor usa was used to carry out the coordinate rotation density correction and stationariness test on the data in the case of weak turbulence the flux measured by the eddy covariance system can not reflect the real exchange of the underlying surface well the frictional wind speed u of air can be used as a criterion to judge the strength of air turbulence in other words only when the frictional wind speed is greater than a certain threshold the co2 flux data measured in this period can be regarded as credible this threshold is called the critical frictional wind speed since the stability of atmospheric conditions at night reduced the quality of the data we use the frictional wind speed to process the data according to the average test method we eliminated the night data when the frictional wind speed was less than the critical frictional wind speed form 2014 to 2018 the critical friction wind speeds were 0 15 m s 1 0 15 m s 1 0 20 m s 1 0 18 m s 1 and 0 12 m s 1 respectively 3 to achieve the continuity and integrity of the data interpolation is carried out data gaps caused by turbulent flux or instrument failure are divided into the short gap 2 h and the long gap 2 h gao et al 2017 the former was filled by linear interpolation while the latter was filled by statistical and empirical models baldocchi 2003 the michaelis menten equation michaelis and menten 1913 was used for the daytime data gaps 24 n e e e r α p a r p m a x p m a x m a x the van t hoff equation was used for nighttime data gaps collatz et al 1991 25 e r e r r e f e x p b t s t r e f where erref is the reference er at 10 c b is the regression parameter ts is the surface temperature and tref is the reference surface temperature at 10 c the difference between the nee and the calculated er is gpp 26 g p p e r n e e the leaf surface area was measured every seven to ten days from the seedling stage to crop harvest in the field we chose six different locations with nine representative plants at each site a measuring tape minimum scale mm was used to measure the length and width of each leaf the lai of the maize leaves can then be obtained using the following formula eq 1 guo et al 2019 27 l a i 0 74 i 1 n l i w i d s where lai is the leaf area index of maize 0 74 is the empirical constant li is the length of leaf i wi is the width of leaf i and d and s are the distance between two rows and the space between two plants respectively 3 3 parameter fitting and accuracy evaluation in order to obtain a set of relatively stable parameter values from the first day of emergence we took 15 days as a window and slid once every 5 days to fit the parameters so that a set of parameters were obtained every 5 days then linear interpolation was carried out using the parameters obtained every 5 days so that the dynamic parameters changing with the development of maize were obtained the 2014 observation data were used to fit the model parameters and the observation data from 2015 to 2018 were used to verify the model prediction accuracy decision coefficient r2 root mean square error rmse and relative mean bias error mbe was used to evaluate the accuracy 28 r 2 i 1 n o i o s i s i 1 n o i o 2 i 1 n s i s 2 2 29 r m s e 1 n i 1 n s i o i 2 30 m b e 1 n i 1 n s i o i 1 n i 1 n o i where si and oi are the simulated and observed values respectively s and o are the mean simulated and observed values n is the number of samples the three indexes represent the average degree of the relative degree of regression contribution absolute error and the relative mean bias error between the simulated and measured values 4 results 4 1 comparisons of the several models in estimating gpp to evaluate the simulation accuracy of the different models we compared gpp simulated by the nine models with the observed gpp fig 1 showed the comparison of maize gpp estimated by the nine models gppm and that measured by eddy covariance gppec during the growing season of 2014 2018 except for 2014 the lue model underestimated the trend of maize gpp in other years fig 1 a the average underestimation of gpp by the lue model was 15 5 year r2 was 0 81 mbe was 16 and rmse was 3 16 g c m 2 d 1 table 1 this indicated that the results simulated by the lue model were significantly lower than that observed by the eddy covariance system during the whole growing period compared with the lue model results simulated by light response photosynthetic models were larger than observed gpp values fig 2 b f the rh model underestimated gpp by an average of 12 r2 by 0 80 mbe by 3 and rmse by 2 78 g c m 2 d 1 these results showed that the rh method had better reliability than the lue model and simulated gpp table 1 except for 2015 the n rh model overestimated the gpp trend in maize fields in the other four years fig 2 c from the overall analysis the n rh model underestimated gpp by an average of 10 5 year r2 of 0 76 mbe of 2 and rmse of 2 92 g c m 2 d 1 table 1 r rh model showed the same pattern as the n rh model the average underestimation of gpp by the r rh model was 2 r2 was 0 78 mbe was 9 and rmse was 3 40 g c m 2 d 1 exp model and qua model underestimated gpp by 10 and 2 r2 by 0 77 and 0 74 mbe by 5 and 3 and rmse by 3 19 and 2 85g c m 2 d 1 respectively compared with the lue model and light response photosynthetic models stomatal conductance models had a poor simulation effect fig 2 g i the smpt sb model underestimated gpp by 28 5 year r2 by 0 83 mbe by 17 and rmse by 3 25g c m 2 d 1 table 1 the overall analysis of the 5 year results showed that bbl and osc models underestimated gpp by 24 and 38 r2 by 0 80 and 0 64 mbe by 11 and 11 and rmse by 2 92 and 3 75g c m 2 d 1 respectively in terms of the overall simulation accuracy the nine models had little difference in the simulation of gpp of the maize field under drip irrigation in the arid areas of northwest china and the simulation accuracy was relatively high however from the perspective of variation the different models still had some room for improvement in the accurate simulation of seasonal variation fig 2 showed the seasonal variation of gpp simulated by 9 models during the growing period of maize although each model could well simulate the daily variation of gpp there were some differences in the simulated values fig 2 the simulated values of the lue model were close to the observed values in the early and late growing stage of maize but it was underestimated in the middle growing stage rainy weather rh model could simulate gpp well in the middle growing stage but overestimate gpp in the early growth stage and later growth stage the gpp simulated by n rh model was significantly higher than the measured value in the middle period except for 2015 and the r rh model exp model and qua models showed the same variations smpt sb model underestimated gpp during the whole growth period of maize while bbl model s simulated values were higher than the measured value in the early growth period and significantly lower than the measured values in the middle growth period osc model was the worst at simulating the seasonal variation of gpp especially in the middle and late stage of maize growth therefore the nine models showed a certain difference under different growth stages and weather conditions of maize in simulating the seasonal variation of maize gpp 4 2 the accuracy of total gpp modeling by the several models in order to test the accuracy of these models in simulating the total amount of gpp our study compared and analyzed the total simulated gpp and the observed gpp the accuracy of each model was inconsistent in different years table 2 in 2014 the total gpp was 1115 53 g c m 2 and the value of simulation ranges from 1206 43 to 1479 65 g c m 2 among which the smpt sb model simulated the most closely while the osc model had the largest difference in 2015 the simulation value of smpt sb model was the closest to the observed value 1704 02 g c m 2 while the simulation effect of osc model was the worst in 2016 the r rh model had the largest simulation effect while the bbl model had the worst in 2017 the observed gpp value was 1068 65 g c m 2 the model simulation range was 772 19 1558 74 g c m 2 and the simulated value of lue model was 903 97 g c m 2 which was the closest to the measured value in 2018 smpt sb model s simulation value was the smallest only 982 38 g c m 2 qua model s simulation value was the largest 1501 96 g c m 2 and bbl model s simulation value was the closest to the observed value which was 1221 99 g c m 2 to sum up from the total amount of simulated gpp in the whole growth period the smpt sb model in 2014 was close to the observed value qua model in 2015 r rh model in 2016 lue model in 2017 and exp model in 2018 on the average of 5 years the simulated values of the photosynthetic response model were closer to the observed values than the other four models 4 3 applicability of the models under different conditions in order to analyze the applicability of different models under different conditions the accuracy of the nine models was analyzed according to different crop growth conditions lai soil moisture conditions f θ net radiation rn and saturation vapor pressure difference vpd leaf area index lai is an important indicator of plant growth which is closely related to the biological characteristics and environmental conditions of plants since the water saving irrigation technology with drip irrigation under film mulch was adopted in the experimental area the original water infiltration process has been changed which has a significant impact on the growth of crops net radiation reflects the amount of energy received by the leaves which is not only related to geographical location and weather conditions but also inseparable from the growth status of the crop the difference in saturation vapor pressure reflects the degree of dryness of the air which is closely related to air temperature and relative humidity and directly affects the status of plant stoma thus controlling the physiological processes such as transpiration and photosynthesis of plants the applicability of simulation under different conditions is fully considered which provides the research foundation for the improvement of the model 4 3 1 comparison of several methods in estimating maize gpp at different growth stages in the early stage of crop growth the leaf area index lai was small and the photosynthetic capacity of crops was weak so the plants were vulnerable to environmental variation according to the growing process of lai the crop growth process was divided into two parts namely lai 2 and lai 2 fig 3 the overall analysis of 2014 2018 data showed that when lai 2 the smpt sb model had the best simulation effect with r2 being 0 80 rmse was 1 73g c m 2 d 1 and e was 0 95 when lai 2 the simulated value of the rh model was the closest to the observed value r2 and e were the highest among the 9 models and rmse was the minimum fig 4 when lai 2 the simulated values of the lue model bbl model and osc model were significantly different from the observed values which respectively underestimated the gpp of maize field by 25 36 and 25 the light response photosynthetic models could simulate more than 92 of gpp while the smpt sb model underestimated the gpp by 14 fig 4 when lai 2 lue model underestimated 15 of maize field gpp rh model n rh model r rh model exp model and qua model respectively 21 24 13 11 and 26 of gpp smpt sb model underestimated 33 of gpp bbl model underestimated 35 of gpp osc model had the poor simulation effect and 60 of gpp was underestimated 4 3 2 comparison of several methods in estimating maize gpp at different environmental conditions soil moisture condition is one of the most important factors affecting crop growth and development plastic mulching can not only reduce soil evaporation but also increase soil temperature and promote crop growth however drip irrigation is different from traditional irrigation it adopts a small amount and multiple irrigation methods to make water slowly and evenly infiltrate into the soil which can maintain the soil structure and form an appropriate soil water fertilizer and heat environment in order to analyze the simulation effects of the models under different soil moisture conditions we divide soil moisture into two levels according to the normalized soil moisture f θ f θ 0 6 and f θ 0 6 31 f θ θ θ w θ s θ w where θ is soil water content θw is soil withering coefficient θs is the saturated moisture content when f θ 0 6 the simulation effect of the models was generally better than that of f θ 0 6 which indicated that when the proportion of available water in the soil was low the simulation effect of gpp was better when f θ 0 6 the accuracy of the light response photosynthetic models was not significantly different in the simulation of gpp the simulated gpp was only less than 10 lower than the observed value and the nash efficiency coefficient was all greater than 0 8 among them the simulation effect of the n rh model was slightly better than that of other models and the rmse was 2 67 g c m 2 d 1 when f θ 0 6 the simulation effect of the rh model was significantly higher than that of the other 8 models r2 was 0 73 rmse was 2 88 g c m 2 d 1 and nash efficiency coefficient was 0 72 fig 4 net radiation rn is divided into two grades rn 100 and rn 100 and the performance of different models under different weather conditions was analyzed when rn 100 all the other 8 models could well simulate spring corn gpp except the lue model nash efficiency coefficient was greater than 0 9 and rmse of rh model was the smallest only 2 58 g c m 2 d 1 when rn 100 the maximum r2 of the smpt sb model was 0 83 but the rmse of the rh model was the smallest among the 9 models only 2 85 and the value of e was the highest 0 81 fig 4 through the analysis of various models under different vpd conditions it was concluded that the performance of different models under different vpd conditions was not consistent from the perspective of r2 alone the simulation effect of lue n rh smpt sb and bbl models at vpd 1 5 was worse than that at vpd 1 5 from the perspective of rmse the values of lue and smpt sb models were not significantly different in the two cases and the rmse values of the other 7 models were smaller when vpd 1 5 on the whole rh simulation was the best when vpd 1 5 smpt sb had the best simulation effect when vpd 1 5 4 4 the improvement of rh model by introducing crop growth function when the light response photosynthetic models were used to simulate the gpp of maize field in the above paper the parameters were obtained by reverse derivation through the observation data in 2014 and the calculation process was quite complicated the photosynthesis of crops is not only related to environmental factors but also closely related to the growing status of crops based on pmax α and lai data obtained in 2014 the relationship between pmax and lai as well as between α and lai was established fig 5 pmax and lai showed a significant linear correlation and pmax increased with the increase of lai the relationship between α and lai was a quadratic polynomial and the specific expression was as follows 32 p m a x r 2 0 72 p 0 001 33 α 0 007 0 02 l a i 0 002 l a i 2 r 2 0 75 p 0 001 34 l a i l a i m 1 exp a 1 a 2 t a 3 t 2 where laim a1 a2 and a3 are parameters t is time 0 t 1 the simulated lai could better reflect the variation of spring maize lai fig 6 the r2 of the simulated effects from 2014 to 2018 were 0 95 0 93 0 99 0 96 and 0 97 respectively by substituting equation 35 into equation 33 and equation 34 pmax and α of the whole growth period of spring maize could be obtained the rh model which introduced the crop growth function was named the rh lai model the r2 of the improved rh lai model was improved in 2014 2015 and 2018 table 3 the r2 of rh model simulation results was 0 80 after the introduction of lai the r2 of the rh lai model was 0 83 with an increase of 0 03 the analysis results showed that the mbe of the simulation results of the rh lai model was not significantly different from that of the rh model compared with the rh model the rmse value was smaller and the overall results of 2014 2018 were 3 34 g c m 2 d 1 and 2 91g c m 2 d 1 respectively for rh and rh lai model simulation results to verify the efficiency of the rh lai model in different environments we selected another maize field site for verification the site is located in the north of our experimental area and is irrigated by traditional border irrigation by comparing the observed gpp and simulated results the rh lai model was confirmed to be able to better simulate the seasonal variation of gpp fig 7 the simulation effect of the rh lai model was good in the early growth stage of maize after maize entered the rapid growth stage the simulated results were slightly lower than the observed values the maximum value of gpp simulated by the model was equal to the observed value but at the end of growth the simulated results were higher than the observed value from the overall simulation result the r2 of three years was above 0 80 the rmse varied from 1 41 to 2 97 g c m 2 and the error between the total simulated gpp and the observed value was controlled within 8 5 discussion in this study we simulated the gpp values of maize under drip irrigation in the arid region of northwest china from 2014 to 2018 through several typical models and the simulation accuracy under different conditions was evaluated there were some differences in the simulation effects of different models in different years these models were not consistent under the influence of environmental factors in the light use efficiency model the light use efficiency is the key parameter that affects the gpp simulation therefore the accuracy of the light use efficiency directly affects the simulated effect of gpp however since lue cannot be measured directly it is difficult to accurately calculate lue wang et al 2020 light use efficiency is significantly limited by plant species and different ecological environments such as radiation temperature soil water content co2 concentration air humidity etc which can change the physiological and biochemical processes in plants thus affecting the progress of photosynthesis poni et al 2009 garbulsky et al 2011 research has found that when the temperature rises from 6 c to 18 c the light use efficiency of medicago sativa increases by 160 brown et al 2006 mccallum et al 2013 found that adding temperature into the lue model could improve the simulation accuracy of the model in cold regions with low temperatures chen et al 2009 also found that the daily light use efficiency was mainly affected by absorbed photosynthetically active radiation daily minimum temperature and water vapor pressure difference in cloudy weather the effect of diffuse radiation on the photosynthesis of crops cannot be ignored studies have shown that adding a cloudiness index to the lue model can improve the simulation accuracy of the model wang et al 2015 the simulation of the light response photosynthetic model is one of the important methods to study photosynthetic physiology and ecology of plants li et al 2019 through the physiological parameters in the light responsive photosynthetic model researchers can determine the operating status photosynthetic capacity and photosynthetic efficiency of the plant and evaluate the influence of environmental factors on them ye and yu 2008 xia et al 2014 biophysical factors can influence plant growth and metabolism especially photosynthesis many studies have shown that photosynthetic parameters vary with biophysical factors based on observational data the researchers found that in the n rh model the maximum photosynthetic rate increases with air temperature and decreases with the temperature above 30 c berry and björkman 1980 greer and weedon 2012 ren et al 2018 found that the maximum photosynthetic rate in the r rh model was significantly positively correlated with relative humidity rh soil moisture content also has a certain influence on the parameters of the light response photosynthetic model ge et al 2012 lang et al 2013 xia et al 2014 li et al 2019 qiao et al 2020 accurate estimation of canopy stomatal conductance is very important when using the stomatal conductance model to simulate canopy photosynthesis canopy stomatal conductance is strongly influenced by plant physiological status and environmental factors photosynthetically active radiation water vapor pressure deficit temperature soil moisture etc du et al 2018 xu et al 2021 vpd is considered to be a major limiting factor in determining plant gas exchange grossiord et al 2020 high vpd caused decreases in canopy conductance higher vpd is generally detrimental to plant productivity pasqualotto et al 2021 radiation is another important factor regulating canopy stomatal conductance previous studies have shown that canopy stomatal conductance increases with increasing radiation reaching an optimal level and then remains stable with increasing radiation komatsu et al 2012 xu et al 2021 some studies have shown that the increase of temperature leads to the increase of daily canopy stomatal conductance barron et al 2010 harris et al 2004 found that soil moisture was the main controlling factor affecting canopy conductance at seasonal and annual scales 6 conclusions based on the flux data of spring maize under drip irrigation in the arid areas of northwest china during 2014 2018 this study compared and evaluated several models for estimating the gross primary productivity of ecosystems under different growing and environmental conditions the results showed that the values of the light response photosynthetic models rh n rh r rh exp and qua were higher than the observed values and the lue model smpt sb model bbl model and osc model were underestimated in the simulated maize field gpp meanwhile the total gpp simulated by the light response photosynthetic model was closer to the observed value than the other four models however considering the applicability of the models under different circumstances the smpt sb model performed better when lai was low when lai 2 rh model was best when soil moisture was low n rh model had a better simulation effect otherwise it was rh model when rn 100 all the other 8 models except lue model could well simulate gpp when rn 100 the accuracy of the simulation rh model was the highest when vpd 1 5 rh simulation was the best otherwise the smpt sb model had the best simulation effect the rh model was improved by establishing the relationship between pmax and lai and between α and lai which improved the accuracy of gpp simulation in the maize field therefore the research results showed that in the regions with fewer observation indexes we could use the rh lai model with a simple structure and convenient calculation to calculate the daily gpp by integrating it on the time scale credit authorship contribution statement hui guo data curation methodology writing original draft sien li conceptualization resources writing review editing funding acquisition shaozhong kang supervision writing review editing taisheng du writing review editing wenfeng liu writing review editing ling tong writing review editing xinmei hao writing review editing risheng ding writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that cdocould have appeared to influence the work reported in this paper acknowledgments we greatly appreciate the careful and precise reviews by anonymous reviewers they paid great efforts on improving the manuscript and study this work was financially supported by the chinese national natural science fund 51879262 51725904 51790530 
24451,in this work the dynamics of a differential equation system which models pest control in a plant by means of a biocontrol agent is analyzed it is assumed that the plant biocontrol agent relationship is commensalism the biocontrol agent pest relationship is that of predator prey and the pest is a specialist the impact of a biocontrol agent on the pest is measured in particular conditions for pest eradication and for species coexistence are shown some of the results show somewhat paradoxically that it is the low initial levels of the biocontrol agent and not the high levels that lead to a greater recovery of the plant population indeed for a certain parameter region the system present simultaneously two positive equilibrium points numerical analysis shows that the one with the highest population level of the plant is the ω limit of those trajectories starting at points with smaller population level of the biocontrol agent than those tending to the other stable equilibrium point keywords commensalism prey predator biocontrol agent pest eradication 1 introduction one of the problems that agriculture very often faces is to control the pests that occur in crops plant diseases are caused by various microorganisms including bacteria fungi nematodes protozoa and viruses tjamos et al 1992 shoda 2000 fungal pathogens are one of the major causative agents of plant diseases which can infect most plant parts including roots stems leaves flowers and fruits de silva et al 2019 agriculture becomes sustainable through reduction or elimination of agrochemicals which can be divided in two large groups chemical fertilizers and pesticides yudelman et al 1998 carvalho 2006 weller et al 2014 however intensive use of chemicals has adverse effects such as reduction of beneficial soil microorganisms contamination of environment and water resources and development of resistant pathogens which have led to environmental and human health problems singh 2014 lenteren 1995 verger and boobis 2013 one effective alternative crop management strategy is integrated crop management icm which is defined as the economical production of high quality crops giving priority to ecological safe methods of crop cultivation minimizing the undesirable side effects and use of crop protection products oerke 2006 icm is a combination of agrochemicals organic fertilizers biological control and improved soil and water management which leads to sustainable agriculture carvalho 2006 oerke 2006 suryanarayanan et al 2018 biocontrol is a tool to control plant pathogens with minimal impact to the environment waard et al 1993 vinale et al 2008 larran et al 2016 it involves manipulation of existing natural enemies in the environment to increase their effectiveness and thus slow the growth of the pest population and reduce crop yield losses lenteren 1987 lenteren and dent 1995 for example in horticulture and forest industries trichoderma koningiopsis mb2 has been used to control boxwood blight caused by calonectria pseudonaviculata kong and hong 2017 in greenhouses where tomatoes and cucumbers are grown the parasitoid encarsia formosa has been used to control the whitefly pest trialeurodes vaporariorum boukadida and michelakis 1994 pang et al 2009 in the citrus industry the predatory vedalia ladybird beetle rodolia cardinalis has long been used to control the cottony cushion scale pest icerya purchasi caltagirone and doutt 1989 kindlmann and dixon 2003 in vitro studies have shown that trichoderma virens and trichoderma harzianum can be used as biocontrol agent for cacao plant pest caused by the moniliophthora roreri reyes figueroa et al 2016 one of the most interesting aspects of mathematical modeling is to provide models that help estimate and predict population densities barclay 1982 barlow et al 1996 plant pest interactions with integrated control methods have been modeled and investigated in attempts to identify factors that stabilize such interactions recently continuous predator prey models of integrated pest management have been developed and investigated tang et al 2008 tang and cheke 2008 in these studies several biologically desirable solutions including a pest eradication periodic solution and positive periodic solutions were obtained analytically these results can help to design a control strategy such as deciding the dosage and frequency of insecticide applications as well as the preferred timings and densities for releasing natural enemies tang et al 2008 in bezerra et al 2021 the authors studied an interaction between the sugarcane borer and its larval parasite cotesia flavipes which is modeled by a host parasitoid system the study which considered an influence of seasonal variation on the dynamics of the system indicated that this variation generates chaotic dynamics in the system on the other hand some trichoderma spp rhizosphere competent strains have been shown to have direct effects on plants increasing their growth potential and nutrient uptake fertilizer use efficiency percentage and rate of seed germination and stimulation of plant defenses against biotic and abiotic damage shoresh et al 2010 hermosa et al 2012 therefore it is important to analyze dynamics of the interaction of a biocontrol agent with a pest considering commensalism between the biocontrol agent and the plant in which the plant benefits directly in this work we analyze dynamics of a differential equation system which models the interaction of three populations plant pest and biocontrol agent with population densities x y z respectively we assume that the pest predates the plant with a lotka volterra functional response and the relationship between the plant and the biocontrol agent is commensalism in the literature to the best of our knowledge models that include a commensalism between a biocontrol agent and host plant have not been analyzed in the model it is assumed there is a direct interaction between the biocontrol agent and the pest an example that does not satisfy the hypothesis is when the pest attacks the aerial part of the plant and the biocontrol agent is naturally found in the roots a common practice in the case of trichoderma spp is to spray it on the aerial part of the plant when the pest is on the leaves cordo et al 2007 explicitly we study the following differential equation system 1 x r 1 x 1 x k 1 β 1 z α x y b c y z h 1 y γ x y b c y z μ y ν y z h 2 z r 2 z 1 z k 2 β 2 y h 3 where r 1 is the plant intrinsic growth rate α is the predation rate of pest on plant k 1 and k 2 are the carrying capacities of plant and the biocontrol agent respectively the mortality rate of the pest is μ ν is the predation rate of the biocontrol agent on the pest r 2 is the biocontrol agent s intrinsic growth rate β 1 is the change rate of the carrying capacity of the plant due to its commensalism with the biocontrol agent β 2 is the change rate of the carrying capacity of the biocontrol agent due to pest predation c measures the interference of the biocontrol agent in plant predation γ is the conversion rate of consumed plant biomass into pest biomass b is the half saturation constant for biological reasons we consider that all parameters in system 1 are positive and the dynamics are analyzed in the positive octant which we denoted by ω 2 local analysis of the model of plant pest biocontrol agent in this section we analyze the local stability of equilibrium points of system 1 the system presents the following trivial equilibrium points p 0 0 0 0 p 1 k 1 0 0 p 2 0 0 k 2 p 3 k 1 k 2 β 1 0 k 2 and p 4 b μ γ b r 1 γ k 1 b μ α γ k 1 0 among these equilibrium points the most important from the biological point of view is p 3 since its stability implies the eradication of the pest now we determine the coexistent equilibrium points ceps of system 1 that is an equilibrium point with positive coordinates solving equation h 3 0 with respect to z and solving equation h 2 0 with respect to x in 1 we obtain 2 x b c y k 2 β 2 y ν k 2 β 2 y μ γ and z k 2 β 2 y substituting x and z in the expression for h 1 we obtain the polynomial 3 q y a y 5 b y 4 c y 3 d y 2 e y f whose coefficients are depicted in appendix a the coefficients a and b are always positive then if c 0 d 0 e 0 and f 0 polynomial q y has not positive roots on the other hand it follows from 2 that for each positive root y 0 of the polynomial q y system 1 exhibits a cep thus all ceps of system 1 are of the form 4 p b c y 0 k 2 β 2 y 0 ν k 2 β 2 y 0 μ γ y 0 k 2 β 2 y 0 by descartes rule system 1 has a unique cep p ˆ if the coefficients of q y have a unique sign change let us suppose that the polynomial q y has a positive root y 0 solving the equation q y 0 0 for α we have 5 α r 1 b c y 0 k 2 y 0 β 2 k 1 γ b μ k 2 y 0 β 2 b ν β 1 γ c y 0 μ k 2 ν y 0 β 2 ν y 0 k 1 β 1 k 2 y 0 β 2 γ which must be positive if we now assume that q y has another positive root y 1 with α as in 5 and solving for μ in the equation q y 1 0 we obtain 6 μ n 1 d 1 which must be positive with n 1 and d 1 defined in appendix a with these assignments the polynomial q y becomes 7 q y 1 d 2 y y 0 y y 1 q 3 y where 8 q 3 y a 3 y 3 a 2 y 2 a 1 y a 0 coefficients a i for i 0 3 and d 2 are defined in appendix a since the expressions of q y in 3 and 7 are equals if d 2 is positive then a 3 and a 2 are positive proposition 2 1 if d 2 a 0 and a 1 are positive then q 3 y does not have positive roots and system 1 has only two ceps if we now assume that q y has another positive root y 2 taking α and μ as in 5 and 6 and solving q y 2 0 for γ we obtain γ n 2 d 3 which must be positive with n 2 and d 3 defined in appendix a with these assignments polynomial 3 reduce and becomes 9 q y 1 d 3 y y 0 y y 1 y y 2 q 2 y where 10 q 2 y b 2 y 2 b 1 y b 0 with coefficients b i and d 3 defined in appendix a since the expressions of q y in 3 and 9 are equals if d 3 is positive then b 2 and b 1 are positive proposition 2 2 if d 3 is positive then system 1 has three ceps if b 0 0 or four ceps if b 0 0 2 1 local stability the jacobian matrix of system 1 is j r 1 y α b c y z 2 r 1 x k 1 z β 1 b x α b c y z 2 x α c y 2 b c y z 2 r 1 β 1 x k 1 z β 1 2 y γ b c y z b γ x b c y z 2 μ ν z y c γ x y b c y z 2 ν 0 r 2 β 2 z 2 k β 2 y 2 r 2 2 r 2 z k 2 β 2 y for system 1 p 0 p 1 p 2 and p 4 are saddle points since the eigenvalues of j p 0 j p 1 j p 2 and j p 4 are r 1 μ r 2 r 1 γ k 1 b μ b r 2 r 1 μ ν k 2 r 2 and b r 1 μ 2 γ k 1 r b r 1 μ 2 γ k 1 r r 2 respectively where r b 2 r 1 2 μ 2 4 r 1 μ γ k 1 γ k 1 b μ 2 γ k 1 proposition 2 3 the equilibrium point p 3 k 1 k 2 β 1 0 k 2 of system 1 is locally asymptotically stable if μ ν k 2 k 1 k 2 β 1 γ b proof the eigenvalues corresponding to j p 3 are 11 λ 1 r 1 λ 2 γ k 1 β 1 k 2 b μ ν k 2 b λ 3 r 2 if μ ν k 2 k 1 k 2 β 1 γ b then γ k 1 β 1 k 2 b μ ν k 2 0 consequently λ 2 0 and the three eigenvalues are real and negative hence p 3 is locally asymptotically stable in particular if all the coefficients of q y are positive system 1 does not have a cep and numerical simulations show the global stability of p 3 the above proposition gives conditions under which a small pest population cannot successfully invade the plant population indeed the pest population becomes extinct if the ratio between the potential maximum mortality rate of pest population μ ν k 2 and the potential maximum carrying capacity of the plant population k 1 k 2 β 1 is greater than the benefit that pest receives from the consumed plant biomass that is a relatively inefficient pest low conversion rate of the biomass consumed is driven to extinction by 3 descartes rule and proposition 2 3 we obtain the following result proposition 2 4 p 3 is locally asymptotically stable if only if system 1 has four two or no ceps for p the characteristic polynomial of j p can be written as 12 p λ λ 3 c 1 λ 2 c 2 λ c 3 where coefficients c 1 c 2 and c 3 are in appendix a applying the routh hurwitz theorem to polynomial 12 we get the following result proposition 2 5 if α c 2 c 3 and c 1 c 2 c 3 are positive then p is locally asymptotically stable 3 bifurcation analysis 3 1 bifurcations at trivial points the eigenvalues of j p 1 are r 1 r 2 and γ k 1 b μ b thus if b γ k 1 μ b ˆ 1 then j p 1 has a unique zero eigenvalue using sotomayor s theorem perko 2006 we obtain the following result whose proof is included in appendix b proposition 3 1 system 1 has a transcritical bifurcation at p 1 with respect to parameter b for the bifurcation value b b ˆ 1 it follows from proposition 3 1 that even in the absence of the biocontrol agent the pest is eradicated if b b ˆ 1 since k 1 b μ γ and consequently the stable manifold at p 1 is x y plane therefore any solution starting in this plane asymptotically tends to the point k 1 0 0 on the other hand if b b ˆ 1 both pest and plant coexist in the absence of the biocontrol agent because the stable manifold of p 4 is the x y plane notice that in this case the equilibrium population size of plant decreases as the profit rate γ b increases in the same way if b γ k 1 β 1 k 2 k 2 ν μ b ˆ 2 then j p 3 has a unique zero eigenvalue see 11 let n ˆ r 1 β 1 β 2 γ μ c k 2 r 1 μ 2 α μ 2 k 1 r 1 β 2 γ ν 2 c k 2 2 r 1 μ ν 2 k 2 α μ ν c k 2 3 r 1 ν 2 k 2 2 α ν 2 by sotomayor s theorem we have the following result see appendix c proposition 3 2 system 1 has a transcritical bifurcation at p 3 if n ˆ 0 or a pitchfork bifurcation if n ˆ 0 with respect to parameter b for the bifurcation value b b ˆ 2 this bifurcation is generated when p 3 exchanges its stability with a cep in fact if b b ˆ 2 then p 3 is locally asymptotically stable hence the pest is eradicated when b is large but for small values of b there is coexistence remark 3 3 if ν β 1 μ k 1 then b ˆ 1 b ˆ 2 and n ˆ 0 therefore system 1 has a simultaneous transcritical bifurcation at p 1 and p 3 for the bifurcation value b b ˆ 1 3 2 bifurcation at a cep if we assume that polynomial q y has at least one positive root y 0 then system 1 has at least one cep p let α be defined as in 5 and 13 μ ˆ 1 b c y 0 2 β 2 k 1 β 1 k 2 y 0 β 2 2 γ n 6 ν b c y 0 k 2 y 0 β 2 b c y 0 k 2 y 0 β 2 n 7 with n 6 and n 7 defined in appendix a if μ μ ˆ 1 then c 3 0 in 12 using mathematica we verify that constant c 2 in 12 is always positive hence j p has a unique zero eigenvalue therefore system 1 does not present a bogdanov takens bifurcation in parameter μ the proof of following result uses sotomayor s theorem see appendix e and m 1 m 2 and m 3 are given in appendix d proposition 3 4 let α μ be defined as in 5 and there exist parameter values for system 1 such that m 1 0 if m 2 0 then the system has a transcritical bifurcation at p if m 2 0 and m 3 0 then the system has a pitchfork bifurcation at p in parameter μ with bifurcation value μ μ ˆ 1 details of the proof of the following result is found in appendix f proposition 3 5 system 1 does not present a hopf bifurcation at p with respect to parameters r 1 and r 2 corollary 3 6 system 1 does not present a bautin bifurcation in p with respect to parameters r 1 and r 2 to show that system 1 has a saddle node bifurcation let 14 α 324305 136 2212 c 1 8 μ ν 544 553 b 587 324305 1088 and r 2 k 1 r 1 k 2 β 1 β 2 γ 1 using the central manifold theory carr 1981 the following result is obtained whose proof is found in appendix g proposition 3 7 if the parameters of system 1 take the values assigned in 14 then it presents a saddle node bifurcation at p 5 689 324305 2212 1 2 3 5 with bifurcation parameter μ and bifurcation value μ 544 553 following the same reasoning used in the proof of proposition 3 7 we obtained the following result proposition 3 8 if the parameters of system 1 take the values assigned in 14 and μ 1 0934 it presents a saddle node bifurcation at p 0 5465 0 7864 1 7864 with bifurcation parameter μ and bifurcation value μ 1 0934 4 numerical simulation example 1 let α μ 32833 1075871744 μ 1080127359 17731772481536 c 1 128 k 2 1 128 ν 1 256 β 1 1 64 μ 1 0021 y 0 1 2 and the other parameters are equal to 1 in system 1 this system has one cep p 1 0060 0 5 0 5078 and j p has a unique zero eigenvalue in this case the constants of proposition 3 4 are m 1 1 0098 and m 2 0 0081 then system 1 has a transcritical bifurcation at μ 1 0021 see fig 1 example 2 let α μ 90647035 30526608 243 392 μ ν 2606372 9461691 k 2 3 8 β 2 2 k 1 16 y 0 1 μ 0 0617 and the other parameters are equal to 1 in system 1 this system has one cep p 2 4162 1 2 375 and j p has a unique zero eigenvalue the constants of proposition 3 4 are m 1 92 0156 m 2 0 and m 3 1 7445 1 0 9 then system 1 has a pitchfork bifurcation at μ ˆ 1 0 0617 see fig 2 example 3 suppose that all the parameters of system 1 are equal to 1 except α 324305 136 2212 b 587 324305 1088 c 1 8 ν 544 553 and μ 0 9827 in this case system 1 has a unique cep p 0 8211 1 0260 2 0260 which is locally asymptotically stable because the eigenvalues of j p are λ 1 2 2 0176 1 4710 i and λ 3 0 0382 if μ μ ˆ 1 544 553 0 9837 system 1 has two ceps p 1 0 8197 1 0248 2 0248 and p 2 0 2702 0 5 1 5 since eigenvalues of j p 1 are λ 1 2 2 0173 1 4704 i and λ 3 0 0380 p 1 is locally asymptotically stable since the eigenvalues of j p 2 are λ 1 2 1 6034 1 1729 i and λ 3 0 then p 2 is a non hyperbolic equilibrium point moreover if μ 0 9847 system 1 has three ceps p 1 0 8184 1 0236 2 0236 p 2 0 2790 0 5119 1 5119 and p 3 0 2623 0 4889 1 4889 the eigenvalues of j p 1 are λ 1 2 2 0170 1 4698 i and λ 3 0 0378 then p 1 is locally asymptotically stable since eigenvalues of j p 2 are λ 1 2 1 6163 1 1813 i and λ 3 0 0023 p 2 is unstable the eigenvalues of j p 3 are λ 1 2 1 5920 1 1650 i and λ 3 0 0025 therefore p 3 is locally asymptotically stable and system 1 presents bistability see fig 3 this shows that if μ μ ˆ 1 system 1 has a unique cep when μ μ ˆ 1 the non hyperbolic equilibrium point p 2 appears which bifurcates into two ceps p 2 and p 3 one is locally asymptotically stable while the other one is unstable if μ μ ˆ 1 this is an example of the saddle node bifurcation cf proposition 3 7 see fig 4 example 4 let r 1 1 r 2 1 b 26 c 1 2 μ 304084676876153138548035 1115875117601778934218752 ν 1 65536 α 653221101227550959539105734507 9141248963393773029120016384 β 1 1 3 β 2 111391 512 γ 1 k 1 5 and k 2 6 system 1 has four ceps p 1 15 0006 0 5 114 78 p 2 43 5134 1 0859 242 2590 p 3 24 6037 0 75 169 17 and p 4 7 0892 0 0017 6 3665 the ceps p 1 and p 2 are locally asymptotically stable because the eigenvalues of j p 1 and j p 2 are 0 7357 0 4407 i 0 0192 and 0 8616 0 5815 i 0 0147 respectively on the other hand p 3 and p 4 are unstable since the eigenvalues of j p 3 and j p 4 are 0 8022 0 5318 i 0 0085 and 0 9994 0 0681 i 0 0033 respectively moreover p 3 7 0 6 is locally asymptotically stable because the eigenvalues of j p 3 are 1 1 0 0034 and system 1 has tristability see fig 5 from the point of view of pest control it is appropriate to investigate the attraction domain of each stable equilibrium point in example 4 for this we set initial conditions at x 0 26 y 0 2 and z 0 is varied in the interval 0 1000 in order to observe the influence that the density of the biocontrol agent has on the ω limit numerical simulations show that if z 0 0 40 the solutions have p 2 43 5134 1 0859 242 2590 as the ω limit hence although the pest is not eradicated the final density of the plant is considerably higher than its initial density on the other hand if z 0 40 then the ω limit of the solutions is p 1 15 0006 0 5 114 78 this shows that both plant population density and pest density decrease if agent biocontrol density is high enough however the pest population is eradicated if its initial density is low indeed numerical simulations show that there exist l 1 and l 2 positive real numbers such that if y 0 0 l 1 the solutions have p 3 7 0 6 as the ω limit whenever x 0 is not too large moreover the ω limit of the solutions is p 2 for certain initial conditions of plant and agent biocontrol density and y 0 in l 1 l 2 if y 0 l 2 then the ω limit is p 1 this result show somewhat paradoxically that it is the low initial levels of the biocontrol agent and not the high levels that lead to a greater recovery of the plant population these behaviors are explained by the relatively large value of β 2 the change the carrying capacity of the biocontrol agent due to predation on the pest since the x and z coordinates of the cep 4 depend on β 2 a large value of β 2 implies a high growth of x and z consequently we can have ceps with high densities of x and z that keep the density of y low variations in parameter β 2 contribute to the emergence of new ceps fig 6 finally the presence of the biocontrol agent contributes to the coexistence of the three populations regardless of the density of the pest in particular if the initial density of the pest is low the solution converges to the equilibrium that has an increase in the initial density of plants otherwise if the initial density of the pest is high the solution converges to the equilibrium that has a decrease in the initial density of plants discussion and conclusions results of the quantitative review showed that biocontrol agents significantly reduced pest abundance by 130 compared to control groups increased parasitism 139 and increased overall pest mortality 159 compared to targets not exposed to biocontrol agents effects on pest mortality tended to be stronger for parasitoids than predators although reductions caused in pest abundance were much stronger when predators were used as biocontrol agents stiling and cornelissen 2005 there exist many generalist predators in agricultural cropping systems that help control some plagues or vectors as for instance whiteflies kheirodin et al 2020 the generalist predator mite a swirskii is widely used against pests of pepper plants such as thrips and whiteflies the latter being a vector of broad mites experiments with a swirskii on single sweet pepper plants in a greenhouse compartment showed successful control of broad mites van maanen et al 2010 in general according to symondson et al 2002 generalist predators are effective when they have a a fast colonizing ability b temporal persistence that allows the predator to maintain its numbers when pest populations decline and c opportunistic feeding habits that allow the predator to rapidly exploit a food resource especially attacks by resurgent pests ehler 1990 it is important to point out that even in cases where the biocontrol agent is not naturally located in the place affected by the pest it can be relocated in such a way that it has a negative effect on the pest such is the case of trichoderma spp which is sprayed it on the aerial part of the plant when the pest is on the leaves cordo et al 2007 martínez et al 2013 in this work we consider that the biocontrol agent is a generalist predator of the pest moreover in the model we assume that the biocontrol agent benefits the plant in its carrying capacity and activates its defense mechanisms in the presence of the pest a biocontrol that satisfies these hypotheses is trichoderma spp for example trichoderma asperellum can be used to reduce fusarium wilt and promote both plant growth and nutrient uptake in commercial tomato production li et al 2018 the chrysophanol is a secondary metabolite of trichoderma harzianum it assisted cabbage growth and promoted resistance against b cinerea then it is involved in stimulating plant growth and photosynthesis and in eliciting host defense responses during the colonization of t harzianum liu et al 2016 on the other hand electron microscopy of ultrathin sections from trichoderma treated roots revealed penetration of trichoderma into the roots restricted mainly to the epidermis and outer cortex strengthening of the epidermal and cortical cell walls was observed as was the deposition of newly formed barriers providing evidence that t harzianum induce systemic resistance mechanisms in cucumber plants yedidia et al 1999 furthermore the studies carried out to date have reported that trichoderma is capable of controlling insect pest indirectly through the activation of systemic plant defensive responses the attraction of natural enemies or the parasitism of insect symbiotic microorganisms poveda 2021 hence the mathematical analysis of our model could help to understand the dynamical properties of interactions as the above mentioned below we summarize some of the main dynamical features of plant pest biocontrol agent interactions based on model 1 the dynamic behavior of system 1 is described from the dynamics around the equilibrium points it has at most five trivial equilibrium points of which four are unstable and only p 3 k 1 k 2 β 1 0 k 2 can be locally asymptotically stable this occurs if γ k 1 β 1 k 2 b μ ν k 2 this gives conditions under which a small pest population cannot successfully invade the plant population notice that the last inequality is consistent with item b described in symondson et al 2002 indeed the pest population becomes extinct if the ratio between the potential maximum mortality rate of pest population μ ν k 2 and the potential maximum carrying capacity of the plant population k 1 k 2 β 1 is greater than the benefit that pest receives from the consumed plant biomass that is a relatively inefficient pest is driven to extinction we obtain from proposition 3 1 that even in the absence of the biocontrol agent the pest is eradicated if b b ˆ 1 since k 1 b μ γ and consequently any solution starting in the plant pest plane asymptotically tends to the point k 1 0 0 on the other hand if system 1 has an even number of ceps then p 3 is locally asymptotically stable in particular if there are no ceps then p 3 is locally asymptotically stable and numerical simulations show that p 3 is globally asymptotically stable therefore the eradication of the pest is guaranteed if system 1 has an odd number of ceps then p 3 is unstable in particular if there is a unique cep p ˆ and it is locally asymptotically stable numerical simulations show that p ˆ is globally asymptotically stable we obtain conditions that guarantee the existence of the four ceps and observe numerically that at most two can be locally asymptotically stable therefore the system has tristability see example 4 in this case the eradication of the pest depends on the initial conditions the numerical simulations show that there are conditions under which the plant population density increases despite the presence of the pest in addition the results show somewhat paradoxically that it is the low initial levels of the biocontrol agent and not the high levels that lead to a greater recovery of the plant population this behavior is explained by how the biocontrol agent benefits from the pest parameter β 2 since the x and z coordinates of the cep 4 depend on β 2 large values of β 2 allow for high densities of x and z which keep the density of y low moreover variations in parameter β 2 contribute to the emergence of new ceps fig 6 this paradoxical behavior has been observed when a generalist predator is used as biocontrol agent for example m pygmaeus is used as biocontrol agent of whiteflies in tomato plants a significantly higher proportion of aborted flowers and fruits was registered in greenhouses with higher m pygmaeus numbers moreover yield was also lower in greenhouses with higher biocontrol agent populations sanchez et al 2018 in summary in the absence of the biological control agent eradication of the pest occurs only when the mortality rate of the pest is greater than the benefit of consuming the plant if this is not the case and the pest has a more efficient behavior then it is necessary to introduce a biocontrol agent if the aim is to eliminate the pest then the steady states p 3 must be stable thus the efficiency of the biocontrol agent depends on its ability to make the point p 3 stable when analyzing the stability of this point we can see that it is necessary to have a balance between the rate of predation of the biocontrol agent and the benefit it provides to the plant for instance if the carrying capacity of the plant and the benefit received by the pest are large enough then the biocontrol agent fails to eradicate the pest credit authorship contribution statement maría fernanda jiménez conceptualization methodology formal analysis writing original draft software gamaliel blé conceptualization methodology formal analysis supervision writing review editing manuel falconi conceptualization methodology formal analysis supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the first author thank conacyt mexico for the scholarship granted we thank to papiit in116018 and papiit ia203922 the authors would also like to thank the referees for their helpful suggestions and recommendations to improve this work appendix a assignment variables coefficients of polynomial 3 a β 2 3 c 2 ν r 1 γ b β 2 2 c 2 r 1 3 k 2 ν μ γ c β 2 c r 1 2 b β 2 ν β 1 β 2 γ c k 2 3 k 2 ν 2 μ γ d α β 1 β 2 γ β 2 c r 1 4 b k 2 ν 2 b μ γ k 1 2 β 1 k 2 c 2 k 2 2 r 1 k 2 ν μ γ e b 2 β 2 ν r 1 c k 2 r 1 γ k 1 β 1 γ k 2 2 b k 2 ν 2 b μ b β 1 β 2 γ r 1 α γ k 1 α β 1 γ k 2 γ f b r 1 b μ ν k 2 γ k 1 k 2 β 1 γ variables for assignment 6 n 1 b k 1 β 1 k 2 y 0 β 2 k 1 β 1 k 2 y 1 β 2 γ b 2 k 1 k 2 β 1 k 2 y 0 β 2 k 2 y 1 β 2 ν 2 b c y 0 y 1 β 2 2 k 1 k 2 k 1 y 0 y 1 β 2 β 1 k 2 y 0 β 2 k 2 y 1 β 2 ν c y 0 y 1 β 2 k 1 β 1 k 2 y 0 β 2 k 1 β 1 k 2 y 1 β 2 γ c β 1 k 2 y 0 β 2 k 2 y 1 β 2 k 2 2 2 k 2 y 0 y 1 β 2 y 0 2 y 0 y 1 y 1 2 β 2 2 k 1 k 2 3 3 k 2 2 y 0 y 1 β 2 3 k 2 y 0 2 y 0 y 1 y 1 2 β 2 2 y 0 y 1 y 0 2 y 1 2 β 2 3 ν d 1 b 2 k 1 β 1 k 2 y 0 y 1 β 2 c 2 y 0 y 1 β 1 k 2 y 0 β 2 k 2 y 1 β 2 k 2 y 0 y 1 β 2 k 1 k 2 2 2 k 2 y 0 y 1 β 2 y 0 2 y 0 y 1 y 1 2 β 2 2 2 b c k 1 y 0 y 1 β 2 coefficients of polynomial 8 a 0 b b 2 β 1 β 2 2 β 1 γ b ν b c β 2 k 1 2 γ k 1 y 0 y 1 β 1 β 2 γ 2 b k 1 k 2 y 0 y 1 β 2 ν β 1 k 2 y 0 β 2 k 2 y 1 β 2 β 1 γ 2 b ν c 2 k 1 2 k 2 2 2 k 2 y 0 y 1 β 2 y 0 2 y 0 y 1 y 1 2 β 2 2 γ k 1 β 1 2 k 2 3 4 k 2 2 y 0 y 1 β 2 2 k 2 y 0 y 1 2 β 2 2 y 0 y 1 y 0 y 1 β 2 3 γ b k 1 β 2 k 2 y 0 y 1 β 2 k 2 y 0 y 1 y 0 2 y 1 2 β 2 ν β 1 k 2 y 0 β 2 k 2 y 1 β 2 k 2 β 1 k 2 y 0 y 1 β 2 γ b β 2 k 2 y 0 y 1 y 0 2 y 0 y 1 y 1 2 β 2 ν a 1 c β 2 2 b 3 β 2 k 1 β 1 k 2 y 0 y 1 β 2 ν b 2 β 1 β 2 k 1 β 1 k 2 y 0 y 1 β 2 γ c k 2 2 k 1 k 2 β 1 k 2 y 0 y 1 2 k 1 3 k 2 β 1 β 2 k 1 y 0 2 3 y 0 y 1 y 1 2 3 k 2 y 0 2 y 0 y 1 y 1 2 β 1 β 2 2 y 0 y 1 y 0 2 y 1 2 β 1 β 2 3 ν b c k 1 2 2 k 2 y 0 y 1 β 2 γ k 1 β 1 4 k 2 2 4 k 2 y 0 y 1 β 2 y 0 2 4 y 0 y 1 y 1 2 β 2 2 γ 2 c k 1 y 0 y 1 β 2 2 k 2 y 0 y 1 y 0 2 y 1 2 β 2 ν β 1 k 2 β 2 k 2 y 1 β 2 β 1 2 k 2 y 0 y 1 β 2 γ 2 c k 2 y 0 y 1 β 2 ν c 2 y 0 y 1 k 1 k 2 β 1 k 1 β 2 2 k 2 y 0 y 1 β 2 γ k 2 y 0 β 2 k 2 y 1 β 2 β 1 β 2 γ c k 2 y 0 β 2 k 2 y 1 β 2 ν a 2 c 2 β 2 2 b k 1 β 1 k 2 y 0 β 2 k 1 β 1 k 2 y 1 β 2 γ b 2 2 k 2 k 1 k 2 β 1 y 0 y 1 k 1 3 k 2 β 1 β 2 y 0 2 y 0 y 1 y 1 2 β 1 β 2 2 ν 2 b c y 0 y 1 β 2 k 1 k 2 β 1 k 2 y 0 β 2 k 2 y 1 β 2 ν c y 0 y 1 β 2 k 1 β 1 k 2 y 0 β 2 k 1 β 1 k 2 y 1 β 2 γ c β 1 k 2 y 0 β 2 k 2 y 1 β 2 2 k 2 2 2 k 2 y 0 y 1 β 2 y 0 y 1 β 2 2 k 1 2 k 2 3 4 k 2 2 y 0 y 1 β 2 2 k 2 y 0 y 1 2 β 2 2 y 0 y 1 y 0 y 1 β 2 3 ν a 3 c 2 β 2 3 2 b c k 1 y 0 y 1 β 2 b 2 k 1 β 1 k 2 y 0 y 1 β 2 c 2 y 0 y 1 β 1 k 2 y 0 β 2 k 2 y 1 β 2 k 2 y 0 y 1 β 2 k 1 k 2 2 2 k 2 y 0 y 1 β 2 y 0 2 y 0 y 1 y 1 2 β 2 2 ν and d 2 b 2 k 1 c 2 k 1 k 2 2 y 0 y 1 b 2 k 2 β 1 c 2 k 2 3 y 0 y 1 β 1 2 b c k 1 y 0 y 1 β 2 2 c 2 k 1 k 2 y 0 2 y 1 β 2 2 c 2 k 1 k 2 y 0 y 1 2 β 2 b 2 y 0 β 1 β 2 b 2 y 1 β 1 β 2 2 c 2 k 2 2 y 0 2 y 1 β 1 β 2 2 c 2 k 2 2 y 0 y 1 2 β 1 β 2 c 2 k 1 y 0 3 y 1 β 2 2 c 2 k 1 y 0 2 y 1 2 β 2 2 c 2 k 1 y 0 y 1 3 β 2 2 c 2 k 2 y 0 3 y 1 β 1 β 2 2 3 c 2 k 2 y 0 2 y 1 2 β 1 β 2 2 c 2 k 2 y 0 y 1 3 β 1 β 2 2 c 2 y 0 3 y 1 2 β 1 β 2 3 c 2 y 0 2 y 1 3 β 1 β 2 3 γ assignments of γ n 2 d 3 n 2 β 2 b 4 β 1 β 2 2 b 3 c k 2 k 1 k 2 β 1 y 0 y 1 y 2 k 1 k 2 β 1 β 2 y 1 y 2 y 0 y 1 y 2 β 1 β 2 2 2 b c 3 y 0 y 1 y 2 β 2 k 2 3 β 1 k 2 y 0 y 1 y 2 k 1 k 2 β 1 β 2 k 1 y 0 2 y 1 2 y 2 2 k 2 y 0 y 1 y 0 y 1 y 2 β 1 β 2 2 y 0 y 1 y 2 β 1 β 2 3 b 2 c 2 k 2 2 y 0 y 1 y 2 k 1 k 2 β 1 k 2 2 k 1 y 0 2 y 0 y 1 y 1 2 y 0 y 1 y 2 y 2 2 k 2 2 y 0 2 3 y 0 y 1 2 y 1 2 3 y 0 y 1 y 2 2 y 2 2 β 1 β 2 k 1 y 0 3 y 0 2 y 1 y 2 y 1 y 2 y 1 2 y 2 2 y 0 y 1 2 3 y 1 y 2 y 2 2 k 2 y 0 3 3 y 0 2 y 1 y 2 y 1 y 2 3 3 y 0 y 1 2 y 1 y 2 y 2 2 β 1 β 2 2 y 0 3 y 1 y 2 y 0 y 1 y 2 y 1 2 y 2 2 y 0 2 y 1 2 y 1 y 2 y 2 2 y 1 y 2 y 1 2 y 1 y 2 y 2 2 β 1 β 2 3 c 4 y 0 y 1 y 2 β 1 k 2 y 0 β 2 k 2 y 1 β 2 k 2 y 2 β 2 k 2 2 k 2 y 0 y 1 y 2 β 2 y 0 y 1 y 0 y 1 y 2 β 2 2 k 1 k 2 4 2 k 2 3 y 0 y 1 y 2 β 2 k 2 2 y 0 2 4 y 0 y 1 y 1 2 4 y 0 y 1 y 2 y 2 2 β 2 2 2 k 2 y 0 y 1 y 0 y 2 y 1 y 2 β 2 3 y 0 2 y 1 2 y 0 y 1 y 0 y 1 y 2 y 0 2 y 0 y 1 y 1 2 y 2 2 β 2 4 ν d 3 b 3 β 1 2 β 2 2 c 3 y 0 y 1 y 2 β 2 2 k 2 k 1 k 2 β 1 2 k 1 k 2 β 1 y 0 y 1 y 2 k 1 k 2 β 1 2 β 2 y 1 y 2 y 0 y 1 y 2 β 1 k 1 k 2 β 1 β 2 2 y 0 y 1 y 2 β 1 2 β 2 3 b 2 c β 2 k 1 2 k 1 y 0 y 1 y 2 β 1 β 2 β 1 2 k 2 2 k 2 y 0 y 1 y 2 β 2 y 0 y 1 y 0 y 1 y 2 β 2 2 b c 2 β 1 2 k 2 y 0 β 2 k 2 y 1 β 2 k 2 y 2 β 2 k 2 y 0 y 1 y 2 β 2 k 1 2 k 2 2 2 k 2 y 0 y 1 y 2 β 2 y 0 2 y 0 y 1 y 1 2 y 0 y 1 y 2 y 2 2 β 2 2 k 1 β 1 2 k 2 3 4 k 2 2 y 0 y 1 y 2 β 2 2 k 2 y 0 y 1 y 2 2 β 2 2 y 0 y 1 y 0 y 1 y 0 2 4 y 0 y 1 y 1 2 y 2 y 0 y 1 y 2 2 β 2 3 coefficients of polynomial 9 b 0 b b 3 β 1 2 β 2 3 b 2 c β 2 2 2 k 1 2 4 k 1 k 2 β 1 3 k 2 2 β 1 2 y 0 y 1 y 2 β 1 k 1 3 k 2 β 1 β 2 y 0 2 y 1 2 y 1 y 2 y 2 2 y 0 y 1 y 2 β 1 2 β 2 2 b c 2 β 2 β 1 2 k 2 y 0 β 2 k 2 y 1 β 2 k 2 y 2 β 2 3 k 2 y 0 y 1 y 2 β 2 k 1 2 k 2 2 y 0 2 y 0 y 1 y 1 2 y 0 y 1 y 2 y 2 2 β 2 2 k 1 β 1 4 k 2 3 4 k 2 2 y 0 y 1 y 2 β 2 6 k 2 y 0 y 1 y 0 y 1 y 2 β 2 2 y 0 y 1 y 0 y 1 y 0 2 4 y 0 y 1 y 1 2 y 2 y 0 y 1 y 2 2 β 2 3 c 3 k 1 k 2 β 1 β 1 k 2 y 0 β 2 k 2 y 1 β 2 k 2 y 2 β 2 k 2 2 k 2 y 0 y 1 y 2 β 2 y 0 y 1 y 0 y 1 y 2 β 2 2 k 1 k 2 4 2 k 2 3 y 0 y 1 y 2 β 2 k 2 2 y 0 2 4 y 0 y 1 y 1 2 4 y 0 y 1 y 2 y 2 2 β 2 2 2 k 2 y 0 y 1 y 0 y 2 y 1 y 2 β 2 3 y 0 2 y 1 2 y 0 y 1 y 0 y 1 y 2 y 0 2 y 0 y 1 y 1 2 y 2 2 β 2 4 b 1 c β 2 b 3 β 1 β 2 2 k 1 3 k 2 β 1 y 0 y 1 y 2 β 1 β 2 b 2 c β 2 4 k 2 2 β 1 k 1 k 2 β 1 y 0 y 1 y 2 k 1 k 2 β 1 k 1 5 k 2 β 1 β 2 β 1 k 1 y 0 2 4 y 0 y 1 y 1 2 4 y 0 y 1 y 2 y 2 2 k 2 y 0 2 6 y 0 y 1 y 1 2 6 y 0 y 1 y 2 y 2 2 β 1 β 2 2 y 0 2 y 1 y 2 y 1 y 2 y 1 y 2 y 0 y 1 2 4 y 1 y 2 y 2 2 β 1 2 β 2 3 c 3 y 0 y 1 y 2 k 1 k 2 β 1 β 2 2 β 1 k 2 y 0 β 2 k 2 y 1 β 2 k 2 y 2 β 2 k 1 3 k 2 2 2 k 2 y 0 y 1 y 2 β 2 y 0 y 1 y 0 y 1 y 2 β 2 2 b c 2 β 1 2 k 2 y 0 β 2 k 2 y 1 β 2 k 2 y 2 β 2 2 k 2 2 2 k 2 y 0 y 1 y 2 β 2 y 0 y 1 y 0 y 1 y 2 β 2 2 k 1 2 2 k 2 3 4 k 2 2 y 0 y 1 y 2 β 2 2 k 2 y 0 y 1 y 2 2 β 2 2 y 0 y 1 y 0 y 1 y 0 2 4 y 0 y 1 y 1 2 y 2 y 0 y 1 y 2 2 β 2 3 k 1 β 1 4 k 2 4 8 k 2 3 y 0 y 1 y 2 β 2 k 2 2 4 y 0 2 11 y 0 y 1 4 y 1 2 11 y 0 y 1 y 2 4 y 2 2 β 2 2 4 k 2 y 0 y 1 y 0 y 1 y 0 2 4 y 0 y 1 y 1 2 y 2 y 0 y 1 y 2 2 β 2 3 y 0 2 y 1 2 4 y 0 y 1 y 0 y 1 y 2 y 0 2 4 y 0 y 1 y 1 2 y 2 2 β 2 4 b 2 c β 2 2 b 3 β 1 2 β 2 2 c 3 y 0 y 1 y 2 β 2 2 k 2 k 1 k 2 β 1 2 k 1 k 2 β 1 y 0 y 1 y 2 k 1 k 2 β 1 2 β 2 y 1 y 2 y 0 y 1 y 2 β 1 k 1 k 2 β 1 β 2 2 y 0 y 1 y 2 β 1 2 β 2 3 b 2 c β 2 k 1 2 k 1 y 0 y 1 y 2 β 1 β 2 β 1 2 k 2 2 k 2 y 0 y 1 y 2 β 2 y 0 y 1 y 0 y 1 y 2 β 2 2 b c 2 β 1 2 k 2 y 0 β 2 k 2 y 1 β 2 k 2 y 2 β 2 k 2 y 0 y 1 y 2 β 2 k 1 2 k 2 2 2 k 2 y 0 y 1 y 2 β 2 y 0 2 y 0 y 1 y 1 2 y 0 y 1 y 2 y 2 2 β 2 2 k 1 β 1 2 k 2 3 4 k 2 2 y 0 y 1 y 2 β 2 2 k 2 y 0 y 1 y 2 2 β 2 2 y 0 y 1 y 0 y 1 y 0 2 4 y 0 y 1 y 1 2 y 2 y 0 y 1 y 2 2 β 2 3 coefficients of polynomial 12 c 1 n 3 b c y 0 k 2 y 0 β 2 k 1 β 1 k 2 y 0 β 2 γ c 2 n 4 b c y 0 k 2 y 0 β 2 k 1 β 1 k 2 y 0 β 2 γ c 3 n 5 b c y 0 k 2 y 0 β 2 k 1 β 1 k 2 y 0 β 2 2 γ n 3 b 2 r 1 μ k 2 y 0 β 2 ν b k 1 r 2 γ k 2 y 0 β 2 r 2 β 1 γ 2 c r 1 y 0 μ k 2 ν y 0 β 2 ν c y 0 k 2 y 0 β 2 k 1 γ r 2 μ k 2 ν y 0 β 2 ν k 2 y 0 β 2 r 2 β 1 γ c r 1 y 0 β 1 γ μ k 2 ν y 0 β 2 ν n 4 b 2 r 1 r 2 μ k 2 y 0 β 2 ν μ k 2 y 0 β 2 ν c y 0 c r 1 y 0 k 2 y 0 β 2 2 r 2 μ k 2 ν y 0 β 2 ν μ k 2 y 0 β 2 ν r 2 k 1 β 1 k 2 y 0 β 2 γ k 2 2 y 0 β 2 μ k 2 y 0 β 2 k 2 3 y 0 β 2 ν b 2 c r 1 r 2 y 0 k 2 y 0 β 2 μ k 2 y 0 β 2 ν k 1 β 1 k 2 y 0 β 2 γ r 2 y 0 β 2 ν r 1 μ k 2 ν y 0 β 2 ν n 5 r 1 r 2 μ k 2 y 0 β 2 ν b 2 β 1 k 2 2 y 0 β 2 μ β 1 k 2 y 0 β 2 2 ν k 1 μ k 2 ν b k 1 2 γ β 1 k 2 y 0 β 2 2 β 1 γ 2 c y 0 2 β 2 ν 2 k 1 k 2 β 1 γ y 0 β 1 β 2 γ c y 0 2 β 2 μ 2 c y 0 2 β 2 k 2 y 0 β 2 ν c y 0 2 k 1 2 β 2 γ β 1 k 2 y 0 β 2 2 β 1 β 2 γ c k 2 2 y 0 β 2 μ c k 2 y 0 β 2 k 2 3 y 0 β 2 ν k 1 k 2 y 0 β 2 2 β 1 β 2 γ c k 2 3 y 0 β 2 μ c k 2 y 0 β 2 k 2 4 y 0 β 2 ν variables for assignment 13 n 6 b k 1 k 2 β 1 k 2 y 0 β 2 2 c y 0 k 2 y 0 β 2 β 1 k 2 y 0 β 2 k 2 3 y 0 β 2 k 1 k 2 4 y 0 β 2 n 7 b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 appendix b proof of proposition 3 1 the vector field of system 1 can be written as f x y z b r 1 x 1 x k 1 β 1 z α x y b c y z γ x y b c y z μ y ν y z r 2 z 1 z k 2 β 2 y the jacobian matrix of f x y z b is j r 1 y α b c y z 2 r 1 x k 1 z β 1 b x α b c y z 2 x α c y 2 b c y z 2 r 1 β 1 x k 1 z β 1 2 y γ b c y z b γ x b c y z 2 μ ν z y c γ x y b c y z 2 ν 0 r 2 β 2 z 2 k β 2 y 2 r 2 2 r 2 z k 2 β 2 y let all system parameters be fixed except b since j p 1 b ˆ 1 r 1 α μ γ r 1 β 1 0 0 0 0 0 r 2 the eigenvalues of j p 1 b ˆ 1 are λ 1 r 1 λ 2 0 and λ 3 r 2 to prove that system 1 presents a transcritical bifurcation at p 1 we will use sotomayor s theorem to this end we calculate v w which are the right and left eigenvectors associated with the eigenvalue λ 2 0 respectively v α μ r 1 γ 1 0 and w 0 1 0 differentiating f x y b with respect to bifurcation parameter b we obtain f b x y z b α x y b c y z 2 γ x y b c y z 2 0 thus 15 w t f b p 1 b ˆ 1 0 furthermore since d f b p 1 b ˆ 1 v α μ 2 k 1 γ 2 μ 2 k 1 γ 0 it follows that 16 w t d f b p 1 b ˆ 1 v 0 1 0 α μ 2 k 1 γ 2 μ 2 k 1 γ 0 μ 2 k 1 γ 0 and since d 2 f p 1 b ˆ 1 v v 0 2 α μ 2 r 1 k 1 γ 0 then 17 w t d 2 f p 1 b ˆ 1 v v 2 α μ 2 r 1 k 1 γ 0 therefore 15 16 and 17 satisfy the conditions of sotomayor s theorem appendix c proof of proposition 3 2 let f x y z b be as defined in proposition 3 1 let all system parameters be fixed with the exception of b then the jacobian matrix of f x y z b at p 3 is j p 3 b ˆ 2 r 1 α μ k 2 ν γ r 1 β 1 0 0 0 0 r 2 β 2 r 2 the eigenvalues of j p 3 b ˆ 2 are λ 1 r 1 λ 2 0 and λ 3 r 2 the right and left eigenvectors associated with the eigenvalue λ 2 0 are v β 1 α μ k 2 ν r 1 β 2 γ 1 β 2 1 and w 0 1 0 respectively differentiating f x y b with respect to bifurcation parameter b we obtain f b x y z b α x y b c y z 2 γ x y b c y z 2 0 hence 18 w t f b p 3 b ˆ 2 0 now we will obtain the expression for w t d f b p 3 b ˆ 2 v since d f b p 3 b ˆ 2 v α μ k 2 ν 2 k 1 k 2 β 1 β 2 γ 2 μ k 2 ν 2 k 1 k 2 β 1 β 2 γ 0 it follows that 19 w t d f b p 3 b ˆ 2 v 0 1 0 α μ k 2 ν 2 k 1 k 2 β 1 β 2 γ 2 μ k 2 ν 2 k 1 k 2 β 1 β 2 γ 0 μ k 2 ν 2 k 1 k 2 β 1 β 2 γ 0 next we obtain the expression for w t d 2 f p 3 b ˆ 2 v v since d 2 f p 3 b ˆ 2 v v 2 α μ k 2 ν β 1 β 2 γ c k 2 μ k 2 ν k 1 k 2 β 1 β 2 2 γ 2 2 n ˆ r 1 k 1 k 2 β 1 β 2 2 γ 0 it follows that 20 w t d 2 f p 3 b ˆ 2 v v 2 n ˆ r 1 k 1 k 2 β 1 β 2 2 γ if n ˆ 0 then w t d 2 f b p 3 b ˆ 2 v v 0 therefore 18 19 and 20 satisfy the conditions for transcritical bifurcation according to sotomayor s theorem finally we will obtain the expression for w t d 3 f p 3 b ˆ 2 v v v since d 3 f p 3 b ˆ 2 v v v 6 α μ k 2 ν 2 s ˆ 1 r 1 k 1 k 2 β 1 2 β 2 3 γ 3 6 c μ k 2 ν 2 s ˆ 2 r 1 k 1 k 2 β 1 2 β 2 3 γ 2 0 where s ˆ 1 c k 1 r 1 β 2 γ α β 1 β 2 γ c 2 k 2 2 r 1 μ k 2 ν c k 2 2 r 1 β 1 β 2 γ α μ k 2 ν s ˆ 2 k 1 r 1 β 2 γ k 2 2 r 1 β 1 β 2 γ c k 2 r 1 μ k 2 ν α μ k 2 ν it follows that 21 w t d 3 f p 3 b ˆ 2 v v v 6 c μ k 2 ν 2 s ˆ 2 r 1 k 1 k 2 β 1 2 β 2 3 γ 2 if n ˆ 0 then s ˆ 2 0 hence w t d 3 f p 3 b ˆ 2 v v v 0 therefore p 3 has a pitchfork bifurcation according to sotomayor s theorem appendix d assignment of proposition 3 4 m 1 b k 1 c k 1 k 2 y 0 b k 2 β 1 c k 2 2 y 0 β 1 3 c k 1 y 0 2 β 2 2 b y 0 β 1 β 2 3 c k 2 y 0 2 β 1 β 2 2 c y 0 3 β 1 β 2 2 m 2 2 y 0 γ 2 r 1 b 2 β 1 β 2 c 2 k 1 y 0 3 β 2 2 b c k 2 k 1 k 2 β 1 3 y 0 k 1 k 2 β 1 β 2 3 y 0 2 β 1 β 2 2 b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 b β 1 β 2 c β 1 k 2 y 0 β 2 2 c k 1 k 2 2 y 0 β 2 γ β 2 b c y 0 k 2 y 0 β 2 2 ν b c y 0 2 β 2 k 1 β 1 k 2 y 0 β 2 γ y 0 β 2 b c y 0 k 2 y 0 β 2 2 ν c β 2 b c y 0 k 2 y 0 β 2 b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 b c y 0 2 β 2 k 1 β 1 k 2 y 0 β 2 2 γ k 2 b c k 2 y 0 k 1 k 2 β 1 y 0 4 c k 2 y 0 k 1 k 2 β 1 b 3 k 1 5 k 2 β 1 β 2 y 0 2 5 b β 1 c y 0 5 k 1 6 k 2 β 1 β 2 2 3 c y 0 4 β 1 β 2 3 b c y 0 k 2 y 0 β 2 ν r 1 b c y 0 2 β 2 k 1 β 1 k 2 y 0 β 2 γ r 1 y 0 β 2 b c y 0 k 2 y 0 β 2 2 ν m 3 6 β 2 b c y 0 k 2 y 0 β 2 b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 γ 3 r 1 y 0 b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 b c y 0 2 β 2 2 c k 1 k 1 k 2 β 1 b β 1 2 β 2 γ b c k 2 b c k 2 y 0 k 1 k 2 β 1 b b 2 β 1 5 c 2 k 2 y 0 2 k 1 k 2 β 1 b c y 0 4 k 1 5 k 2 β 1 β 2 b c y 0 2 8 b β 1 c y 0 10 k 1 9 k 2 β 1 β 2 2 c 2 y 0 4 2 c k 1 y 0 7 b β 1 β 2 3 b c y 0 k 2 y 0 β 2 ν b β 1 β 2 c β 1 k 2 y 0 β 2 2 c k 1 k 2 2 y 0 β 2 γ β 2 b c y 0 k 2 y 0 β 2 2 ν c b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 r 1 b c y 0 2 β 2 k 1 β 1 k 2 y 0 β 2 γ r 1 y 0 β 2 b c y 0 k 2 y 0 β 2 2 ν b c y 0 2 β 2 2 k 1 β 1 k 2 y 0 β 2 2 γ b c y 0 k 2 y 0 β 2 b c y 0 k 2 2 k 1 k 2 β 1 5 k 2 y 0 k 1 k 2 β 1 β 2 y 0 2 10 k 1 11 k 2 β 1 β 2 2 8 y 0 3 β 1 β 2 3 c 2 y 0 5 β 2 3 2 k 1 β 1 k 2 y 0 β 2 b 2 k 1 k 2 4 y 0 β 2 β 1 k 2 2 6 k 2 y 0 β 2 7 y 0 2 β 2 2 ν appendix e proof of proposition 3 4 the vector field of system 1 can be written as f x y z μ r 1 x 1 x k 1 β 1 z α x y b c y z γ x y b c y z μ y ν y z r 2 z 1 z k 2 β 2 y let all system parameters be fixed with the exception of μ then the jacobian matrix j p μ has a unique zero eigenvalue when μ μ ˆ 1 the right and left eigenvectors associated with the zero eigenvalue are respectively v v 1 v 2 v 2 and w w 1 w 2 w 3 where v 1 c k 2 2 y 0 β 2 b c y 0 2 β 2 k 1 β 1 k 2 y 0 β 2 2 γ β 2 b c y 0 k 2 y 0 β 2 2 c k 1 y 0 2 β 2 b k 1 β 1 k 2 2 y 0 β 2 ν v 2 b c y 0 k 2 y 0 β 2 b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 γ v 3 β 2 b c y 0 k 2 y 0 β 2 b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 γ w 1 y 0 b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 γ 2 w 2 b c y 0 k 2 y 0 β 2 r 1 b c y 0 2 β 2 k 1 β 1 k 2 y 0 β 2 γ r 1 y 0 β 2 b c y 0 k 2 y 0 β 2 2 ν w 3 n 8 r 2 b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 n 8 r 1 y 0 k 1 β 1 k 2 y 0 β 2 b c y 0 2 β 2 k 1 β 1 k 2 y 0 β 2 γ y 0 β 2 b c y 0 k 2 y 0 β 2 2 ν c y 0 k 1 β 1 k 2 y 0 β 2 γ c 2 y 0 2 k 2 y 0 β 2 2 ν b β 1 γ b ν differentiating f x y μ with respect to bifurcation parameter μ we obtain f μ x y z μ r 1 x y b c y 0 k 2 y 0 β 2 b c y 0 k 2 y 0 β 2 y 0 b c y z k 1 β 1 k 2 y 0 β 2 γ y 0 thus 22 w t f μ p μ ˆ 1 0 and 23 w t d f μ p μ ˆ 1 v γ ν r 1 y 0 β 2 b c k 2 y 0 c y 0 2 β 2 3 m 1 k 1 k 2 β 1 y 0 β 1 β 2 since m 1 0 it follows that w t d f μ p μ ˆ 1 v 0 moreover we have 24 w t d 2 f p μ ˆ 1 v v m 2 by 22 and 23 if m 2 0 then p has a transcritical bifurcation according to sotomayor s theorem finally we have w t d 3 f p μ ˆ 1 v v v m 3 by 22 and 23 if m 2 0 and m 3 0 then p has a pitchfork bifurcation according to sotomayor s theorem appendix f proof of proposition 3 5 let us assume that the system presents a hopf bifurcation at point p since the characteristic polynomial of j p given in 12 is p 1 λ λ 3 c 1 λ 2 c 2 λ c 3 which can be written as p 2 λ λ ε λ 2 w 2 λ 3 ε λ 2 w 2 λ w 2 ε where ε c 1 and c 3 c 1 c 2 0 we have 25 c 3 c 1 c 2 s 0 r 1 2 s 1 r 1 s 2 b c k 2 y 0 c y 0 2 β 2 2 k 1 k 2 β 1 y 0 β 1 β 2 2 γ 2 where s 0 b c y 0 k 2 y 0 β 2 2 μ k 2 y 0 β 2 ν 2 b k 1 γ k 2 y 0 β 2 2 c r 2 y 0 β 1 γ b 2 r 2 μ k 2 y 0 β 2 ν c 2 y 0 2 k 2 y 0 β 2 2 r 2 μ k 2 y 0 β 2 ν s 1 γ μ k 2 y 0 β 2 ν b 3 r 2 k 1 r 2 k 2 β 1 r 2 y 0 β 2 ν y 0 β 1 β 2 r 2 μ y 0 β 2 ν b 2 c y 0 k 1 3 k 2 r 2 2 3 r 2 2 y 0 β 2 2 k 2 r 2 μ r 2 y 0 β 2 μ k 2 μ 2 y 0 β 2 μ 2 k 2 y 0 β 2 r 2 2 k 2 y 0 β 2 2 k 2 y 0 β 2 μ ν k 2 y 0 β 2 3 ν 2 β 1 3 k 2 2 r 2 2 6 k 2 r 2 2 y 0 β 2 3 r 2 2 y 0 2 β 2 2 2 k 2 2 r 2 μ 6 k 2 r 2 y 0 β 2 μ 4 r 2 y 0 2 β 2 2 μ k 2 2 μ 2 2 k 2 y 0 β 2 μ 2 y 0 2 β 2 2 μ 2 2 k 2 y 0 β 2 2 r 2 k 2 2 y 0 β 2 k 2 y 0 β 2 μ ν k 2 y 0 β 2 4 ν 2 c 2 y 0 3 k 2 y 0 β 2 r 2 β 2 k 1 β 1 k 2 y 0 β 2 2 γ c k 2 y 0 β 2 β 1 k 2 y 0 β 2 2 r 2 μ k 2 ν y 0 β 2 ν 2 k 1 k 2 r 2 2 r 2 2 y 0 β 2 2 k 2 r 2 μ r 2 y 0 β 2 μ k 2 μ 2 y 0 β 2 μ 2 k 2 y 0 β 2 2 k 2 r 2 μ y 0 β 2 r 2 2 μ ν k 2 y 0 β 2 3 ν 2 b c y 0 k 1 β 1 k 2 y 0 β 2 2 γ r 2 y 0 β 2 k 2 y 0 β 2 μ k 2 ν y 0 β 2 ν c r 2 y 0 k 2 y 0 β 2 β 1 k 2 y 0 β 2 3 k 2 r 2 3 r 2 y 0 β 2 4 k 2 μ 5 y 0 β 2 μ k 2 y 0 β 2 4 k 2 5 y 0 β 2 ν k 1 4 k 2 2 ν y 0 β 2 3 r 2 2 μ 2 y 0 β 2 ν k 2 3 r 2 4 μ 6 y 0 β 2 ν s 2 r 2 y 0 k 1 β 1 k 2 y 0 β 2 2 γ 2 c k 2 2 y 0 β 2 μ b β 2 ν c k 2 y 0 β 2 k 2 3 y 0 β 2 ν b r 2 c y 0 k 2 y 0 β 2 r 2 μ k 2 ν y 0 β 2 ν we observe that s 2 is negative and using mathematica we obtain that s 0 and s 1 are also negative by descartes rule we have that the polynomial s 0 r 1 2 s 1 r 1 s 2 does not have positive roots however this is a contradiction to the fact that c 3 c 1 c 2 0 since the system s parameters must be positive therefore system 1 does not present a hopf bifurcation at p in the same way if in the expression 25 the numerator is considered a function of r 2 we conclude that system 1 does not have a hopf bifurcation in p with respect to parameter r 2 appendix g proof of proposition 3 7 to analyze system 1 we rescale it so it becomes the following topologically equivalent polynomial system x x 1 y 0 1288 y z 0 1288 0 1288 z x 0 1288 y z y 1 5677 0 5677 z z y 0 9837 y 1 y 1 z 0 1288 y z 8 1323 x z 0 1288 y 1 z 0 1288 z 1 y z z 1 z 0 1288 y z 2 transferring the equilibrium point p to the origin we obtain the following conjugate system y 1 j y 1 f 2 y 1 o y 1 3 where 26 j 4 6441 3 3972 0 3 3972 4 6441 0 0 0 0 y 1 y 11 y 12 y 13 and f 2 f 1 f 2 f 3 with f 1 9 0914 y 11 y 12 3 9421 y 11 2 5 7828 y 12 2 18 7972 y 11 y 13 11 2878 y 12 y 13 2 1696 y 13 2 f 2 1 7875 y 11 2 17 1649 y 11 y 12 13 0055 y 12 2 15 3194 y 11 y 13 17 9106 y 12 y 13 3 7862 y 13 2 f 3 0 3407 y 11 2 0 8496 y 11 y 12 0 2433 y 12 2 0 5711 y 11 y 13 0 0291 y 12 y 13 0 1888 y 13 2 as the linear part of the system 26 has a zero eigenvalue we will analyze its dynamics using the central manifold theory carr 1981 let c 0 p 4 6441 3 3972 3 3972 4 6441 f f 3 o y 1 3 and g f 1 o y 1 3 f 2 o y 1 3 we make h y 13 α 1 y 13 α 2 y 13 in order to eliminate the quadratic terms of the following equation 27 d h y 13 c y 13 f h y 13 y 13 p h y 13 g h y 13 y 13 0 which is equivalent to solving the following system 28 2 1696 4 6441 α 1 3 3972 α 2 0 3 7862 3 3972 α 1 4 6441 α 2 0 the solution to this system is α 1 0 6928 and α 2 0 3085 so that h y 13 0 6928 y 13 2 0 3085 y 13 2 thus system 26 restricted to the central manifold is y 13 0 1888 y 13 2 o y 13 3 by the non hyperbolic equilibrium point classification theorem perko 2006 system 26 has a saddle node bifurcation at the origin since this system was obtained with the assignment of μ given in 13 we conclude that system 1 has a saddle node bifurcation at μ 544 553 
24451,in this work the dynamics of a differential equation system which models pest control in a plant by means of a biocontrol agent is analyzed it is assumed that the plant biocontrol agent relationship is commensalism the biocontrol agent pest relationship is that of predator prey and the pest is a specialist the impact of a biocontrol agent on the pest is measured in particular conditions for pest eradication and for species coexistence are shown some of the results show somewhat paradoxically that it is the low initial levels of the biocontrol agent and not the high levels that lead to a greater recovery of the plant population indeed for a certain parameter region the system present simultaneously two positive equilibrium points numerical analysis shows that the one with the highest population level of the plant is the ω limit of those trajectories starting at points with smaller population level of the biocontrol agent than those tending to the other stable equilibrium point keywords commensalism prey predator biocontrol agent pest eradication 1 introduction one of the problems that agriculture very often faces is to control the pests that occur in crops plant diseases are caused by various microorganisms including bacteria fungi nematodes protozoa and viruses tjamos et al 1992 shoda 2000 fungal pathogens are one of the major causative agents of plant diseases which can infect most plant parts including roots stems leaves flowers and fruits de silva et al 2019 agriculture becomes sustainable through reduction or elimination of agrochemicals which can be divided in two large groups chemical fertilizers and pesticides yudelman et al 1998 carvalho 2006 weller et al 2014 however intensive use of chemicals has adverse effects such as reduction of beneficial soil microorganisms contamination of environment and water resources and development of resistant pathogens which have led to environmental and human health problems singh 2014 lenteren 1995 verger and boobis 2013 one effective alternative crop management strategy is integrated crop management icm which is defined as the economical production of high quality crops giving priority to ecological safe methods of crop cultivation minimizing the undesirable side effects and use of crop protection products oerke 2006 icm is a combination of agrochemicals organic fertilizers biological control and improved soil and water management which leads to sustainable agriculture carvalho 2006 oerke 2006 suryanarayanan et al 2018 biocontrol is a tool to control plant pathogens with minimal impact to the environment waard et al 1993 vinale et al 2008 larran et al 2016 it involves manipulation of existing natural enemies in the environment to increase their effectiveness and thus slow the growth of the pest population and reduce crop yield losses lenteren 1987 lenteren and dent 1995 for example in horticulture and forest industries trichoderma koningiopsis mb2 has been used to control boxwood blight caused by calonectria pseudonaviculata kong and hong 2017 in greenhouses where tomatoes and cucumbers are grown the parasitoid encarsia formosa has been used to control the whitefly pest trialeurodes vaporariorum boukadida and michelakis 1994 pang et al 2009 in the citrus industry the predatory vedalia ladybird beetle rodolia cardinalis has long been used to control the cottony cushion scale pest icerya purchasi caltagirone and doutt 1989 kindlmann and dixon 2003 in vitro studies have shown that trichoderma virens and trichoderma harzianum can be used as biocontrol agent for cacao plant pest caused by the moniliophthora roreri reyes figueroa et al 2016 one of the most interesting aspects of mathematical modeling is to provide models that help estimate and predict population densities barclay 1982 barlow et al 1996 plant pest interactions with integrated control methods have been modeled and investigated in attempts to identify factors that stabilize such interactions recently continuous predator prey models of integrated pest management have been developed and investigated tang et al 2008 tang and cheke 2008 in these studies several biologically desirable solutions including a pest eradication periodic solution and positive periodic solutions were obtained analytically these results can help to design a control strategy such as deciding the dosage and frequency of insecticide applications as well as the preferred timings and densities for releasing natural enemies tang et al 2008 in bezerra et al 2021 the authors studied an interaction between the sugarcane borer and its larval parasite cotesia flavipes which is modeled by a host parasitoid system the study which considered an influence of seasonal variation on the dynamics of the system indicated that this variation generates chaotic dynamics in the system on the other hand some trichoderma spp rhizosphere competent strains have been shown to have direct effects on plants increasing their growth potential and nutrient uptake fertilizer use efficiency percentage and rate of seed germination and stimulation of plant defenses against biotic and abiotic damage shoresh et al 2010 hermosa et al 2012 therefore it is important to analyze dynamics of the interaction of a biocontrol agent with a pest considering commensalism between the biocontrol agent and the plant in which the plant benefits directly in this work we analyze dynamics of a differential equation system which models the interaction of three populations plant pest and biocontrol agent with population densities x y z respectively we assume that the pest predates the plant with a lotka volterra functional response and the relationship between the plant and the biocontrol agent is commensalism in the literature to the best of our knowledge models that include a commensalism between a biocontrol agent and host plant have not been analyzed in the model it is assumed there is a direct interaction between the biocontrol agent and the pest an example that does not satisfy the hypothesis is when the pest attacks the aerial part of the plant and the biocontrol agent is naturally found in the roots a common practice in the case of trichoderma spp is to spray it on the aerial part of the plant when the pest is on the leaves cordo et al 2007 explicitly we study the following differential equation system 1 x r 1 x 1 x k 1 β 1 z α x y b c y z h 1 y γ x y b c y z μ y ν y z h 2 z r 2 z 1 z k 2 β 2 y h 3 where r 1 is the plant intrinsic growth rate α is the predation rate of pest on plant k 1 and k 2 are the carrying capacities of plant and the biocontrol agent respectively the mortality rate of the pest is μ ν is the predation rate of the biocontrol agent on the pest r 2 is the biocontrol agent s intrinsic growth rate β 1 is the change rate of the carrying capacity of the plant due to its commensalism with the biocontrol agent β 2 is the change rate of the carrying capacity of the biocontrol agent due to pest predation c measures the interference of the biocontrol agent in plant predation γ is the conversion rate of consumed plant biomass into pest biomass b is the half saturation constant for biological reasons we consider that all parameters in system 1 are positive and the dynamics are analyzed in the positive octant which we denoted by ω 2 local analysis of the model of plant pest biocontrol agent in this section we analyze the local stability of equilibrium points of system 1 the system presents the following trivial equilibrium points p 0 0 0 0 p 1 k 1 0 0 p 2 0 0 k 2 p 3 k 1 k 2 β 1 0 k 2 and p 4 b μ γ b r 1 γ k 1 b μ α γ k 1 0 among these equilibrium points the most important from the biological point of view is p 3 since its stability implies the eradication of the pest now we determine the coexistent equilibrium points ceps of system 1 that is an equilibrium point with positive coordinates solving equation h 3 0 with respect to z and solving equation h 2 0 with respect to x in 1 we obtain 2 x b c y k 2 β 2 y ν k 2 β 2 y μ γ and z k 2 β 2 y substituting x and z in the expression for h 1 we obtain the polynomial 3 q y a y 5 b y 4 c y 3 d y 2 e y f whose coefficients are depicted in appendix a the coefficients a and b are always positive then if c 0 d 0 e 0 and f 0 polynomial q y has not positive roots on the other hand it follows from 2 that for each positive root y 0 of the polynomial q y system 1 exhibits a cep thus all ceps of system 1 are of the form 4 p b c y 0 k 2 β 2 y 0 ν k 2 β 2 y 0 μ γ y 0 k 2 β 2 y 0 by descartes rule system 1 has a unique cep p ˆ if the coefficients of q y have a unique sign change let us suppose that the polynomial q y has a positive root y 0 solving the equation q y 0 0 for α we have 5 α r 1 b c y 0 k 2 y 0 β 2 k 1 γ b μ k 2 y 0 β 2 b ν β 1 γ c y 0 μ k 2 ν y 0 β 2 ν y 0 k 1 β 1 k 2 y 0 β 2 γ which must be positive if we now assume that q y has another positive root y 1 with α as in 5 and solving for μ in the equation q y 1 0 we obtain 6 μ n 1 d 1 which must be positive with n 1 and d 1 defined in appendix a with these assignments the polynomial q y becomes 7 q y 1 d 2 y y 0 y y 1 q 3 y where 8 q 3 y a 3 y 3 a 2 y 2 a 1 y a 0 coefficients a i for i 0 3 and d 2 are defined in appendix a since the expressions of q y in 3 and 7 are equals if d 2 is positive then a 3 and a 2 are positive proposition 2 1 if d 2 a 0 and a 1 are positive then q 3 y does not have positive roots and system 1 has only two ceps if we now assume that q y has another positive root y 2 taking α and μ as in 5 and 6 and solving q y 2 0 for γ we obtain γ n 2 d 3 which must be positive with n 2 and d 3 defined in appendix a with these assignments polynomial 3 reduce and becomes 9 q y 1 d 3 y y 0 y y 1 y y 2 q 2 y where 10 q 2 y b 2 y 2 b 1 y b 0 with coefficients b i and d 3 defined in appendix a since the expressions of q y in 3 and 9 are equals if d 3 is positive then b 2 and b 1 are positive proposition 2 2 if d 3 is positive then system 1 has three ceps if b 0 0 or four ceps if b 0 0 2 1 local stability the jacobian matrix of system 1 is j r 1 y α b c y z 2 r 1 x k 1 z β 1 b x α b c y z 2 x α c y 2 b c y z 2 r 1 β 1 x k 1 z β 1 2 y γ b c y z b γ x b c y z 2 μ ν z y c γ x y b c y z 2 ν 0 r 2 β 2 z 2 k β 2 y 2 r 2 2 r 2 z k 2 β 2 y for system 1 p 0 p 1 p 2 and p 4 are saddle points since the eigenvalues of j p 0 j p 1 j p 2 and j p 4 are r 1 μ r 2 r 1 γ k 1 b μ b r 2 r 1 μ ν k 2 r 2 and b r 1 μ 2 γ k 1 r b r 1 μ 2 γ k 1 r r 2 respectively where r b 2 r 1 2 μ 2 4 r 1 μ γ k 1 γ k 1 b μ 2 γ k 1 proposition 2 3 the equilibrium point p 3 k 1 k 2 β 1 0 k 2 of system 1 is locally asymptotically stable if μ ν k 2 k 1 k 2 β 1 γ b proof the eigenvalues corresponding to j p 3 are 11 λ 1 r 1 λ 2 γ k 1 β 1 k 2 b μ ν k 2 b λ 3 r 2 if μ ν k 2 k 1 k 2 β 1 γ b then γ k 1 β 1 k 2 b μ ν k 2 0 consequently λ 2 0 and the three eigenvalues are real and negative hence p 3 is locally asymptotically stable in particular if all the coefficients of q y are positive system 1 does not have a cep and numerical simulations show the global stability of p 3 the above proposition gives conditions under which a small pest population cannot successfully invade the plant population indeed the pest population becomes extinct if the ratio between the potential maximum mortality rate of pest population μ ν k 2 and the potential maximum carrying capacity of the plant population k 1 k 2 β 1 is greater than the benefit that pest receives from the consumed plant biomass that is a relatively inefficient pest low conversion rate of the biomass consumed is driven to extinction by 3 descartes rule and proposition 2 3 we obtain the following result proposition 2 4 p 3 is locally asymptotically stable if only if system 1 has four two or no ceps for p the characteristic polynomial of j p can be written as 12 p λ λ 3 c 1 λ 2 c 2 λ c 3 where coefficients c 1 c 2 and c 3 are in appendix a applying the routh hurwitz theorem to polynomial 12 we get the following result proposition 2 5 if α c 2 c 3 and c 1 c 2 c 3 are positive then p is locally asymptotically stable 3 bifurcation analysis 3 1 bifurcations at trivial points the eigenvalues of j p 1 are r 1 r 2 and γ k 1 b μ b thus if b γ k 1 μ b ˆ 1 then j p 1 has a unique zero eigenvalue using sotomayor s theorem perko 2006 we obtain the following result whose proof is included in appendix b proposition 3 1 system 1 has a transcritical bifurcation at p 1 with respect to parameter b for the bifurcation value b b ˆ 1 it follows from proposition 3 1 that even in the absence of the biocontrol agent the pest is eradicated if b b ˆ 1 since k 1 b μ γ and consequently the stable manifold at p 1 is x y plane therefore any solution starting in this plane asymptotically tends to the point k 1 0 0 on the other hand if b b ˆ 1 both pest and plant coexist in the absence of the biocontrol agent because the stable manifold of p 4 is the x y plane notice that in this case the equilibrium population size of plant decreases as the profit rate γ b increases in the same way if b γ k 1 β 1 k 2 k 2 ν μ b ˆ 2 then j p 3 has a unique zero eigenvalue see 11 let n ˆ r 1 β 1 β 2 γ μ c k 2 r 1 μ 2 α μ 2 k 1 r 1 β 2 γ ν 2 c k 2 2 r 1 μ ν 2 k 2 α μ ν c k 2 3 r 1 ν 2 k 2 2 α ν 2 by sotomayor s theorem we have the following result see appendix c proposition 3 2 system 1 has a transcritical bifurcation at p 3 if n ˆ 0 or a pitchfork bifurcation if n ˆ 0 with respect to parameter b for the bifurcation value b b ˆ 2 this bifurcation is generated when p 3 exchanges its stability with a cep in fact if b b ˆ 2 then p 3 is locally asymptotically stable hence the pest is eradicated when b is large but for small values of b there is coexistence remark 3 3 if ν β 1 μ k 1 then b ˆ 1 b ˆ 2 and n ˆ 0 therefore system 1 has a simultaneous transcritical bifurcation at p 1 and p 3 for the bifurcation value b b ˆ 1 3 2 bifurcation at a cep if we assume that polynomial q y has at least one positive root y 0 then system 1 has at least one cep p let α be defined as in 5 and 13 μ ˆ 1 b c y 0 2 β 2 k 1 β 1 k 2 y 0 β 2 2 γ n 6 ν b c y 0 k 2 y 0 β 2 b c y 0 k 2 y 0 β 2 n 7 with n 6 and n 7 defined in appendix a if μ μ ˆ 1 then c 3 0 in 12 using mathematica we verify that constant c 2 in 12 is always positive hence j p has a unique zero eigenvalue therefore system 1 does not present a bogdanov takens bifurcation in parameter μ the proof of following result uses sotomayor s theorem see appendix e and m 1 m 2 and m 3 are given in appendix d proposition 3 4 let α μ be defined as in 5 and there exist parameter values for system 1 such that m 1 0 if m 2 0 then the system has a transcritical bifurcation at p if m 2 0 and m 3 0 then the system has a pitchfork bifurcation at p in parameter μ with bifurcation value μ μ ˆ 1 details of the proof of the following result is found in appendix f proposition 3 5 system 1 does not present a hopf bifurcation at p with respect to parameters r 1 and r 2 corollary 3 6 system 1 does not present a bautin bifurcation in p with respect to parameters r 1 and r 2 to show that system 1 has a saddle node bifurcation let 14 α 324305 136 2212 c 1 8 μ ν 544 553 b 587 324305 1088 and r 2 k 1 r 1 k 2 β 1 β 2 γ 1 using the central manifold theory carr 1981 the following result is obtained whose proof is found in appendix g proposition 3 7 if the parameters of system 1 take the values assigned in 14 then it presents a saddle node bifurcation at p 5 689 324305 2212 1 2 3 5 with bifurcation parameter μ and bifurcation value μ 544 553 following the same reasoning used in the proof of proposition 3 7 we obtained the following result proposition 3 8 if the parameters of system 1 take the values assigned in 14 and μ 1 0934 it presents a saddle node bifurcation at p 0 5465 0 7864 1 7864 with bifurcation parameter μ and bifurcation value μ 1 0934 4 numerical simulation example 1 let α μ 32833 1075871744 μ 1080127359 17731772481536 c 1 128 k 2 1 128 ν 1 256 β 1 1 64 μ 1 0021 y 0 1 2 and the other parameters are equal to 1 in system 1 this system has one cep p 1 0060 0 5 0 5078 and j p has a unique zero eigenvalue in this case the constants of proposition 3 4 are m 1 1 0098 and m 2 0 0081 then system 1 has a transcritical bifurcation at μ 1 0021 see fig 1 example 2 let α μ 90647035 30526608 243 392 μ ν 2606372 9461691 k 2 3 8 β 2 2 k 1 16 y 0 1 μ 0 0617 and the other parameters are equal to 1 in system 1 this system has one cep p 2 4162 1 2 375 and j p has a unique zero eigenvalue the constants of proposition 3 4 are m 1 92 0156 m 2 0 and m 3 1 7445 1 0 9 then system 1 has a pitchfork bifurcation at μ ˆ 1 0 0617 see fig 2 example 3 suppose that all the parameters of system 1 are equal to 1 except α 324305 136 2212 b 587 324305 1088 c 1 8 ν 544 553 and μ 0 9827 in this case system 1 has a unique cep p 0 8211 1 0260 2 0260 which is locally asymptotically stable because the eigenvalues of j p are λ 1 2 2 0176 1 4710 i and λ 3 0 0382 if μ μ ˆ 1 544 553 0 9837 system 1 has two ceps p 1 0 8197 1 0248 2 0248 and p 2 0 2702 0 5 1 5 since eigenvalues of j p 1 are λ 1 2 2 0173 1 4704 i and λ 3 0 0380 p 1 is locally asymptotically stable since the eigenvalues of j p 2 are λ 1 2 1 6034 1 1729 i and λ 3 0 then p 2 is a non hyperbolic equilibrium point moreover if μ 0 9847 system 1 has three ceps p 1 0 8184 1 0236 2 0236 p 2 0 2790 0 5119 1 5119 and p 3 0 2623 0 4889 1 4889 the eigenvalues of j p 1 are λ 1 2 2 0170 1 4698 i and λ 3 0 0378 then p 1 is locally asymptotically stable since eigenvalues of j p 2 are λ 1 2 1 6163 1 1813 i and λ 3 0 0023 p 2 is unstable the eigenvalues of j p 3 are λ 1 2 1 5920 1 1650 i and λ 3 0 0025 therefore p 3 is locally asymptotically stable and system 1 presents bistability see fig 3 this shows that if μ μ ˆ 1 system 1 has a unique cep when μ μ ˆ 1 the non hyperbolic equilibrium point p 2 appears which bifurcates into two ceps p 2 and p 3 one is locally asymptotically stable while the other one is unstable if μ μ ˆ 1 this is an example of the saddle node bifurcation cf proposition 3 7 see fig 4 example 4 let r 1 1 r 2 1 b 26 c 1 2 μ 304084676876153138548035 1115875117601778934218752 ν 1 65536 α 653221101227550959539105734507 9141248963393773029120016384 β 1 1 3 β 2 111391 512 γ 1 k 1 5 and k 2 6 system 1 has four ceps p 1 15 0006 0 5 114 78 p 2 43 5134 1 0859 242 2590 p 3 24 6037 0 75 169 17 and p 4 7 0892 0 0017 6 3665 the ceps p 1 and p 2 are locally asymptotically stable because the eigenvalues of j p 1 and j p 2 are 0 7357 0 4407 i 0 0192 and 0 8616 0 5815 i 0 0147 respectively on the other hand p 3 and p 4 are unstable since the eigenvalues of j p 3 and j p 4 are 0 8022 0 5318 i 0 0085 and 0 9994 0 0681 i 0 0033 respectively moreover p 3 7 0 6 is locally asymptotically stable because the eigenvalues of j p 3 are 1 1 0 0034 and system 1 has tristability see fig 5 from the point of view of pest control it is appropriate to investigate the attraction domain of each stable equilibrium point in example 4 for this we set initial conditions at x 0 26 y 0 2 and z 0 is varied in the interval 0 1000 in order to observe the influence that the density of the biocontrol agent has on the ω limit numerical simulations show that if z 0 0 40 the solutions have p 2 43 5134 1 0859 242 2590 as the ω limit hence although the pest is not eradicated the final density of the plant is considerably higher than its initial density on the other hand if z 0 40 then the ω limit of the solutions is p 1 15 0006 0 5 114 78 this shows that both plant population density and pest density decrease if agent biocontrol density is high enough however the pest population is eradicated if its initial density is low indeed numerical simulations show that there exist l 1 and l 2 positive real numbers such that if y 0 0 l 1 the solutions have p 3 7 0 6 as the ω limit whenever x 0 is not too large moreover the ω limit of the solutions is p 2 for certain initial conditions of plant and agent biocontrol density and y 0 in l 1 l 2 if y 0 l 2 then the ω limit is p 1 this result show somewhat paradoxically that it is the low initial levels of the biocontrol agent and not the high levels that lead to a greater recovery of the plant population these behaviors are explained by the relatively large value of β 2 the change the carrying capacity of the biocontrol agent due to predation on the pest since the x and z coordinates of the cep 4 depend on β 2 a large value of β 2 implies a high growth of x and z consequently we can have ceps with high densities of x and z that keep the density of y low variations in parameter β 2 contribute to the emergence of new ceps fig 6 finally the presence of the biocontrol agent contributes to the coexistence of the three populations regardless of the density of the pest in particular if the initial density of the pest is low the solution converges to the equilibrium that has an increase in the initial density of plants otherwise if the initial density of the pest is high the solution converges to the equilibrium that has a decrease in the initial density of plants discussion and conclusions results of the quantitative review showed that biocontrol agents significantly reduced pest abundance by 130 compared to control groups increased parasitism 139 and increased overall pest mortality 159 compared to targets not exposed to biocontrol agents effects on pest mortality tended to be stronger for parasitoids than predators although reductions caused in pest abundance were much stronger when predators were used as biocontrol agents stiling and cornelissen 2005 there exist many generalist predators in agricultural cropping systems that help control some plagues or vectors as for instance whiteflies kheirodin et al 2020 the generalist predator mite a swirskii is widely used against pests of pepper plants such as thrips and whiteflies the latter being a vector of broad mites experiments with a swirskii on single sweet pepper plants in a greenhouse compartment showed successful control of broad mites van maanen et al 2010 in general according to symondson et al 2002 generalist predators are effective when they have a a fast colonizing ability b temporal persistence that allows the predator to maintain its numbers when pest populations decline and c opportunistic feeding habits that allow the predator to rapidly exploit a food resource especially attacks by resurgent pests ehler 1990 it is important to point out that even in cases where the biocontrol agent is not naturally located in the place affected by the pest it can be relocated in such a way that it has a negative effect on the pest such is the case of trichoderma spp which is sprayed it on the aerial part of the plant when the pest is on the leaves cordo et al 2007 martínez et al 2013 in this work we consider that the biocontrol agent is a generalist predator of the pest moreover in the model we assume that the biocontrol agent benefits the plant in its carrying capacity and activates its defense mechanisms in the presence of the pest a biocontrol that satisfies these hypotheses is trichoderma spp for example trichoderma asperellum can be used to reduce fusarium wilt and promote both plant growth and nutrient uptake in commercial tomato production li et al 2018 the chrysophanol is a secondary metabolite of trichoderma harzianum it assisted cabbage growth and promoted resistance against b cinerea then it is involved in stimulating plant growth and photosynthesis and in eliciting host defense responses during the colonization of t harzianum liu et al 2016 on the other hand electron microscopy of ultrathin sections from trichoderma treated roots revealed penetration of trichoderma into the roots restricted mainly to the epidermis and outer cortex strengthening of the epidermal and cortical cell walls was observed as was the deposition of newly formed barriers providing evidence that t harzianum induce systemic resistance mechanisms in cucumber plants yedidia et al 1999 furthermore the studies carried out to date have reported that trichoderma is capable of controlling insect pest indirectly through the activation of systemic plant defensive responses the attraction of natural enemies or the parasitism of insect symbiotic microorganisms poveda 2021 hence the mathematical analysis of our model could help to understand the dynamical properties of interactions as the above mentioned below we summarize some of the main dynamical features of plant pest biocontrol agent interactions based on model 1 the dynamic behavior of system 1 is described from the dynamics around the equilibrium points it has at most five trivial equilibrium points of which four are unstable and only p 3 k 1 k 2 β 1 0 k 2 can be locally asymptotically stable this occurs if γ k 1 β 1 k 2 b μ ν k 2 this gives conditions under which a small pest population cannot successfully invade the plant population notice that the last inequality is consistent with item b described in symondson et al 2002 indeed the pest population becomes extinct if the ratio between the potential maximum mortality rate of pest population μ ν k 2 and the potential maximum carrying capacity of the plant population k 1 k 2 β 1 is greater than the benefit that pest receives from the consumed plant biomass that is a relatively inefficient pest is driven to extinction we obtain from proposition 3 1 that even in the absence of the biocontrol agent the pest is eradicated if b b ˆ 1 since k 1 b μ γ and consequently any solution starting in the plant pest plane asymptotically tends to the point k 1 0 0 on the other hand if system 1 has an even number of ceps then p 3 is locally asymptotically stable in particular if there are no ceps then p 3 is locally asymptotically stable and numerical simulations show that p 3 is globally asymptotically stable therefore the eradication of the pest is guaranteed if system 1 has an odd number of ceps then p 3 is unstable in particular if there is a unique cep p ˆ and it is locally asymptotically stable numerical simulations show that p ˆ is globally asymptotically stable we obtain conditions that guarantee the existence of the four ceps and observe numerically that at most two can be locally asymptotically stable therefore the system has tristability see example 4 in this case the eradication of the pest depends on the initial conditions the numerical simulations show that there are conditions under which the plant population density increases despite the presence of the pest in addition the results show somewhat paradoxically that it is the low initial levels of the biocontrol agent and not the high levels that lead to a greater recovery of the plant population this behavior is explained by how the biocontrol agent benefits from the pest parameter β 2 since the x and z coordinates of the cep 4 depend on β 2 large values of β 2 allow for high densities of x and z which keep the density of y low moreover variations in parameter β 2 contribute to the emergence of new ceps fig 6 this paradoxical behavior has been observed when a generalist predator is used as biocontrol agent for example m pygmaeus is used as biocontrol agent of whiteflies in tomato plants a significantly higher proportion of aborted flowers and fruits was registered in greenhouses with higher m pygmaeus numbers moreover yield was also lower in greenhouses with higher biocontrol agent populations sanchez et al 2018 in summary in the absence of the biological control agent eradication of the pest occurs only when the mortality rate of the pest is greater than the benefit of consuming the plant if this is not the case and the pest has a more efficient behavior then it is necessary to introduce a biocontrol agent if the aim is to eliminate the pest then the steady states p 3 must be stable thus the efficiency of the biocontrol agent depends on its ability to make the point p 3 stable when analyzing the stability of this point we can see that it is necessary to have a balance between the rate of predation of the biocontrol agent and the benefit it provides to the plant for instance if the carrying capacity of the plant and the benefit received by the pest are large enough then the biocontrol agent fails to eradicate the pest credit authorship contribution statement maría fernanda jiménez conceptualization methodology formal analysis writing original draft software gamaliel blé conceptualization methodology formal analysis supervision writing review editing manuel falconi conceptualization methodology formal analysis supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the first author thank conacyt mexico for the scholarship granted we thank to papiit in116018 and papiit ia203922 the authors would also like to thank the referees for their helpful suggestions and recommendations to improve this work appendix a assignment variables coefficients of polynomial 3 a β 2 3 c 2 ν r 1 γ b β 2 2 c 2 r 1 3 k 2 ν μ γ c β 2 c r 1 2 b β 2 ν β 1 β 2 γ c k 2 3 k 2 ν 2 μ γ d α β 1 β 2 γ β 2 c r 1 4 b k 2 ν 2 b μ γ k 1 2 β 1 k 2 c 2 k 2 2 r 1 k 2 ν μ γ e b 2 β 2 ν r 1 c k 2 r 1 γ k 1 β 1 γ k 2 2 b k 2 ν 2 b μ b β 1 β 2 γ r 1 α γ k 1 α β 1 γ k 2 γ f b r 1 b μ ν k 2 γ k 1 k 2 β 1 γ variables for assignment 6 n 1 b k 1 β 1 k 2 y 0 β 2 k 1 β 1 k 2 y 1 β 2 γ b 2 k 1 k 2 β 1 k 2 y 0 β 2 k 2 y 1 β 2 ν 2 b c y 0 y 1 β 2 2 k 1 k 2 k 1 y 0 y 1 β 2 β 1 k 2 y 0 β 2 k 2 y 1 β 2 ν c y 0 y 1 β 2 k 1 β 1 k 2 y 0 β 2 k 1 β 1 k 2 y 1 β 2 γ c β 1 k 2 y 0 β 2 k 2 y 1 β 2 k 2 2 2 k 2 y 0 y 1 β 2 y 0 2 y 0 y 1 y 1 2 β 2 2 k 1 k 2 3 3 k 2 2 y 0 y 1 β 2 3 k 2 y 0 2 y 0 y 1 y 1 2 β 2 2 y 0 y 1 y 0 2 y 1 2 β 2 3 ν d 1 b 2 k 1 β 1 k 2 y 0 y 1 β 2 c 2 y 0 y 1 β 1 k 2 y 0 β 2 k 2 y 1 β 2 k 2 y 0 y 1 β 2 k 1 k 2 2 2 k 2 y 0 y 1 β 2 y 0 2 y 0 y 1 y 1 2 β 2 2 2 b c k 1 y 0 y 1 β 2 coefficients of polynomial 8 a 0 b b 2 β 1 β 2 2 β 1 γ b ν b c β 2 k 1 2 γ k 1 y 0 y 1 β 1 β 2 γ 2 b k 1 k 2 y 0 y 1 β 2 ν β 1 k 2 y 0 β 2 k 2 y 1 β 2 β 1 γ 2 b ν c 2 k 1 2 k 2 2 2 k 2 y 0 y 1 β 2 y 0 2 y 0 y 1 y 1 2 β 2 2 γ k 1 β 1 2 k 2 3 4 k 2 2 y 0 y 1 β 2 2 k 2 y 0 y 1 2 β 2 2 y 0 y 1 y 0 y 1 β 2 3 γ b k 1 β 2 k 2 y 0 y 1 β 2 k 2 y 0 y 1 y 0 2 y 1 2 β 2 ν β 1 k 2 y 0 β 2 k 2 y 1 β 2 k 2 β 1 k 2 y 0 y 1 β 2 γ b β 2 k 2 y 0 y 1 y 0 2 y 0 y 1 y 1 2 β 2 ν a 1 c β 2 2 b 3 β 2 k 1 β 1 k 2 y 0 y 1 β 2 ν b 2 β 1 β 2 k 1 β 1 k 2 y 0 y 1 β 2 γ c k 2 2 k 1 k 2 β 1 k 2 y 0 y 1 2 k 1 3 k 2 β 1 β 2 k 1 y 0 2 3 y 0 y 1 y 1 2 3 k 2 y 0 2 y 0 y 1 y 1 2 β 1 β 2 2 y 0 y 1 y 0 2 y 1 2 β 1 β 2 3 ν b c k 1 2 2 k 2 y 0 y 1 β 2 γ k 1 β 1 4 k 2 2 4 k 2 y 0 y 1 β 2 y 0 2 4 y 0 y 1 y 1 2 β 2 2 γ 2 c k 1 y 0 y 1 β 2 2 k 2 y 0 y 1 y 0 2 y 1 2 β 2 ν β 1 k 2 β 2 k 2 y 1 β 2 β 1 2 k 2 y 0 y 1 β 2 γ 2 c k 2 y 0 y 1 β 2 ν c 2 y 0 y 1 k 1 k 2 β 1 k 1 β 2 2 k 2 y 0 y 1 β 2 γ k 2 y 0 β 2 k 2 y 1 β 2 β 1 β 2 γ c k 2 y 0 β 2 k 2 y 1 β 2 ν a 2 c 2 β 2 2 b k 1 β 1 k 2 y 0 β 2 k 1 β 1 k 2 y 1 β 2 γ b 2 2 k 2 k 1 k 2 β 1 y 0 y 1 k 1 3 k 2 β 1 β 2 y 0 2 y 0 y 1 y 1 2 β 1 β 2 2 ν 2 b c y 0 y 1 β 2 k 1 k 2 β 1 k 2 y 0 β 2 k 2 y 1 β 2 ν c y 0 y 1 β 2 k 1 β 1 k 2 y 0 β 2 k 1 β 1 k 2 y 1 β 2 γ c β 1 k 2 y 0 β 2 k 2 y 1 β 2 2 k 2 2 2 k 2 y 0 y 1 β 2 y 0 y 1 β 2 2 k 1 2 k 2 3 4 k 2 2 y 0 y 1 β 2 2 k 2 y 0 y 1 2 β 2 2 y 0 y 1 y 0 y 1 β 2 3 ν a 3 c 2 β 2 3 2 b c k 1 y 0 y 1 β 2 b 2 k 1 β 1 k 2 y 0 y 1 β 2 c 2 y 0 y 1 β 1 k 2 y 0 β 2 k 2 y 1 β 2 k 2 y 0 y 1 β 2 k 1 k 2 2 2 k 2 y 0 y 1 β 2 y 0 2 y 0 y 1 y 1 2 β 2 2 ν and d 2 b 2 k 1 c 2 k 1 k 2 2 y 0 y 1 b 2 k 2 β 1 c 2 k 2 3 y 0 y 1 β 1 2 b c k 1 y 0 y 1 β 2 2 c 2 k 1 k 2 y 0 2 y 1 β 2 2 c 2 k 1 k 2 y 0 y 1 2 β 2 b 2 y 0 β 1 β 2 b 2 y 1 β 1 β 2 2 c 2 k 2 2 y 0 2 y 1 β 1 β 2 2 c 2 k 2 2 y 0 y 1 2 β 1 β 2 c 2 k 1 y 0 3 y 1 β 2 2 c 2 k 1 y 0 2 y 1 2 β 2 2 c 2 k 1 y 0 y 1 3 β 2 2 c 2 k 2 y 0 3 y 1 β 1 β 2 2 3 c 2 k 2 y 0 2 y 1 2 β 1 β 2 2 c 2 k 2 y 0 y 1 3 β 1 β 2 2 c 2 y 0 3 y 1 2 β 1 β 2 3 c 2 y 0 2 y 1 3 β 1 β 2 3 γ assignments of γ n 2 d 3 n 2 β 2 b 4 β 1 β 2 2 b 3 c k 2 k 1 k 2 β 1 y 0 y 1 y 2 k 1 k 2 β 1 β 2 y 1 y 2 y 0 y 1 y 2 β 1 β 2 2 2 b c 3 y 0 y 1 y 2 β 2 k 2 3 β 1 k 2 y 0 y 1 y 2 k 1 k 2 β 1 β 2 k 1 y 0 2 y 1 2 y 2 2 k 2 y 0 y 1 y 0 y 1 y 2 β 1 β 2 2 y 0 y 1 y 2 β 1 β 2 3 b 2 c 2 k 2 2 y 0 y 1 y 2 k 1 k 2 β 1 k 2 2 k 1 y 0 2 y 0 y 1 y 1 2 y 0 y 1 y 2 y 2 2 k 2 2 y 0 2 3 y 0 y 1 2 y 1 2 3 y 0 y 1 y 2 2 y 2 2 β 1 β 2 k 1 y 0 3 y 0 2 y 1 y 2 y 1 y 2 y 1 2 y 2 2 y 0 y 1 2 3 y 1 y 2 y 2 2 k 2 y 0 3 3 y 0 2 y 1 y 2 y 1 y 2 3 3 y 0 y 1 2 y 1 y 2 y 2 2 β 1 β 2 2 y 0 3 y 1 y 2 y 0 y 1 y 2 y 1 2 y 2 2 y 0 2 y 1 2 y 1 y 2 y 2 2 y 1 y 2 y 1 2 y 1 y 2 y 2 2 β 1 β 2 3 c 4 y 0 y 1 y 2 β 1 k 2 y 0 β 2 k 2 y 1 β 2 k 2 y 2 β 2 k 2 2 k 2 y 0 y 1 y 2 β 2 y 0 y 1 y 0 y 1 y 2 β 2 2 k 1 k 2 4 2 k 2 3 y 0 y 1 y 2 β 2 k 2 2 y 0 2 4 y 0 y 1 y 1 2 4 y 0 y 1 y 2 y 2 2 β 2 2 2 k 2 y 0 y 1 y 0 y 2 y 1 y 2 β 2 3 y 0 2 y 1 2 y 0 y 1 y 0 y 1 y 2 y 0 2 y 0 y 1 y 1 2 y 2 2 β 2 4 ν d 3 b 3 β 1 2 β 2 2 c 3 y 0 y 1 y 2 β 2 2 k 2 k 1 k 2 β 1 2 k 1 k 2 β 1 y 0 y 1 y 2 k 1 k 2 β 1 2 β 2 y 1 y 2 y 0 y 1 y 2 β 1 k 1 k 2 β 1 β 2 2 y 0 y 1 y 2 β 1 2 β 2 3 b 2 c β 2 k 1 2 k 1 y 0 y 1 y 2 β 1 β 2 β 1 2 k 2 2 k 2 y 0 y 1 y 2 β 2 y 0 y 1 y 0 y 1 y 2 β 2 2 b c 2 β 1 2 k 2 y 0 β 2 k 2 y 1 β 2 k 2 y 2 β 2 k 2 y 0 y 1 y 2 β 2 k 1 2 k 2 2 2 k 2 y 0 y 1 y 2 β 2 y 0 2 y 0 y 1 y 1 2 y 0 y 1 y 2 y 2 2 β 2 2 k 1 β 1 2 k 2 3 4 k 2 2 y 0 y 1 y 2 β 2 2 k 2 y 0 y 1 y 2 2 β 2 2 y 0 y 1 y 0 y 1 y 0 2 4 y 0 y 1 y 1 2 y 2 y 0 y 1 y 2 2 β 2 3 coefficients of polynomial 9 b 0 b b 3 β 1 2 β 2 3 b 2 c β 2 2 2 k 1 2 4 k 1 k 2 β 1 3 k 2 2 β 1 2 y 0 y 1 y 2 β 1 k 1 3 k 2 β 1 β 2 y 0 2 y 1 2 y 1 y 2 y 2 2 y 0 y 1 y 2 β 1 2 β 2 2 b c 2 β 2 β 1 2 k 2 y 0 β 2 k 2 y 1 β 2 k 2 y 2 β 2 3 k 2 y 0 y 1 y 2 β 2 k 1 2 k 2 2 y 0 2 y 0 y 1 y 1 2 y 0 y 1 y 2 y 2 2 β 2 2 k 1 β 1 4 k 2 3 4 k 2 2 y 0 y 1 y 2 β 2 6 k 2 y 0 y 1 y 0 y 1 y 2 β 2 2 y 0 y 1 y 0 y 1 y 0 2 4 y 0 y 1 y 1 2 y 2 y 0 y 1 y 2 2 β 2 3 c 3 k 1 k 2 β 1 β 1 k 2 y 0 β 2 k 2 y 1 β 2 k 2 y 2 β 2 k 2 2 k 2 y 0 y 1 y 2 β 2 y 0 y 1 y 0 y 1 y 2 β 2 2 k 1 k 2 4 2 k 2 3 y 0 y 1 y 2 β 2 k 2 2 y 0 2 4 y 0 y 1 y 1 2 4 y 0 y 1 y 2 y 2 2 β 2 2 2 k 2 y 0 y 1 y 0 y 2 y 1 y 2 β 2 3 y 0 2 y 1 2 y 0 y 1 y 0 y 1 y 2 y 0 2 y 0 y 1 y 1 2 y 2 2 β 2 4 b 1 c β 2 b 3 β 1 β 2 2 k 1 3 k 2 β 1 y 0 y 1 y 2 β 1 β 2 b 2 c β 2 4 k 2 2 β 1 k 1 k 2 β 1 y 0 y 1 y 2 k 1 k 2 β 1 k 1 5 k 2 β 1 β 2 β 1 k 1 y 0 2 4 y 0 y 1 y 1 2 4 y 0 y 1 y 2 y 2 2 k 2 y 0 2 6 y 0 y 1 y 1 2 6 y 0 y 1 y 2 y 2 2 β 1 β 2 2 y 0 2 y 1 y 2 y 1 y 2 y 1 y 2 y 0 y 1 2 4 y 1 y 2 y 2 2 β 1 2 β 2 3 c 3 y 0 y 1 y 2 k 1 k 2 β 1 β 2 2 β 1 k 2 y 0 β 2 k 2 y 1 β 2 k 2 y 2 β 2 k 1 3 k 2 2 2 k 2 y 0 y 1 y 2 β 2 y 0 y 1 y 0 y 1 y 2 β 2 2 b c 2 β 1 2 k 2 y 0 β 2 k 2 y 1 β 2 k 2 y 2 β 2 2 k 2 2 2 k 2 y 0 y 1 y 2 β 2 y 0 y 1 y 0 y 1 y 2 β 2 2 k 1 2 2 k 2 3 4 k 2 2 y 0 y 1 y 2 β 2 2 k 2 y 0 y 1 y 2 2 β 2 2 y 0 y 1 y 0 y 1 y 0 2 4 y 0 y 1 y 1 2 y 2 y 0 y 1 y 2 2 β 2 3 k 1 β 1 4 k 2 4 8 k 2 3 y 0 y 1 y 2 β 2 k 2 2 4 y 0 2 11 y 0 y 1 4 y 1 2 11 y 0 y 1 y 2 4 y 2 2 β 2 2 4 k 2 y 0 y 1 y 0 y 1 y 0 2 4 y 0 y 1 y 1 2 y 2 y 0 y 1 y 2 2 β 2 3 y 0 2 y 1 2 4 y 0 y 1 y 0 y 1 y 2 y 0 2 4 y 0 y 1 y 1 2 y 2 2 β 2 4 b 2 c β 2 2 b 3 β 1 2 β 2 2 c 3 y 0 y 1 y 2 β 2 2 k 2 k 1 k 2 β 1 2 k 1 k 2 β 1 y 0 y 1 y 2 k 1 k 2 β 1 2 β 2 y 1 y 2 y 0 y 1 y 2 β 1 k 1 k 2 β 1 β 2 2 y 0 y 1 y 2 β 1 2 β 2 3 b 2 c β 2 k 1 2 k 1 y 0 y 1 y 2 β 1 β 2 β 1 2 k 2 2 k 2 y 0 y 1 y 2 β 2 y 0 y 1 y 0 y 1 y 2 β 2 2 b c 2 β 1 2 k 2 y 0 β 2 k 2 y 1 β 2 k 2 y 2 β 2 k 2 y 0 y 1 y 2 β 2 k 1 2 k 2 2 2 k 2 y 0 y 1 y 2 β 2 y 0 2 y 0 y 1 y 1 2 y 0 y 1 y 2 y 2 2 β 2 2 k 1 β 1 2 k 2 3 4 k 2 2 y 0 y 1 y 2 β 2 2 k 2 y 0 y 1 y 2 2 β 2 2 y 0 y 1 y 0 y 1 y 0 2 4 y 0 y 1 y 1 2 y 2 y 0 y 1 y 2 2 β 2 3 coefficients of polynomial 12 c 1 n 3 b c y 0 k 2 y 0 β 2 k 1 β 1 k 2 y 0 β 2 γ c 2 n 4 b c y 0 k 2 y 0 β 2 k 1 β 1 k 2 y 0 β 2 γ c 3 n 5 b c y 0 k 2 y 0 β 2 k 1 β 1 k 2 y 0 β 2 2 γ n 3 b 2 r 1 μ k 2 y 0 β 2 ν b k 1 r 2 γ k 2 y 0 β 2 r 2 β 1 γ 2 c r 1 y 0 μ k 2 ν y 0 β 2 ν c y 0 k 2 y 0 β 2 k 1 γ r 2 μ k 2 ν y 0 β 2 ν k 2 y 0 β 2 r 2 β 1 γ c r 1 y 0 β 1 γ μ k 2 ν y 0 β 2 ν n 4 b 2 r 1 r 2 μ k 2 y 0 β 2 ν μ k 2 y 0 β 2 ν c y 0 c r 1 y 0 k 2 y 0 β 2 2 r 2 μ k 2 ν y 0 β 2 ν μ k 2 y 0 β 2 ν r 2 k 1 β 1 k 2 y 0 β 2 γ k 2 2 y 0 β 2 μ k 2 y 0 β 2 k 2 3 y 0 β 2 ν b 2 c r 1 r 2 y 0 k 2 y 0 β 2 μ k 2 y 0 β 2 ν k 1 β 1 k 2 y 0 β 2 γ r 2 y 0 β 2 ν r 1 μ k 2 ν y 0 β 2 ν n 5 r 1 r 2 μ k 2 y 0 β 2 ν b 2 β 1 k 2 2 y 0 β 2 μ β 1 k 2 y 0 β 2 2 ν k 1 μ k 2 ν b k 1 2 γ β 1 k 2 y 0 β 2 2 β 1 γ 2 c y 0 2 β 2 ν 2 k 1 k 2 β 1 γ y 0 β 1 β 2 γ c y 0 2 β 2 μ 2 c y 0 2 β 2 k 2 y 0 β 2 ν c y 0 2 k 1 2 β 2 γ β 1 k 2 y 0 β 2 2 β 1 β 2 γ c k 2 2 y 0 β 2 μ c k 2 y 0 β 2 k 2 3 y 0 β 2 ν k 1 k 2 y 0 β 2 2 β 1 β 2 γ c k 2 3 y 0 β 2 μ c k 2 y 0 β 2 k 2 4 y 0 β 2 ν variables for assignment 13 n 6 b k 1 k 2 β 1 k 2 y 0 β 2 2 c y 0 k 2 y 0 β 2 β 1 k 2 y 0 β 2 k 2 3 y 0 β 2 k 1 k 2 4 y 0 β 2 n 7 b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 appendix b proof of proposition 3 1 the vector field of system 1 can be written as f x y z b r 1 x 1 x k 1 β 1 z α x y b c y z γ x y b c y z μ y ν y z r 2 z 1 z k 2 β 2 y the jacobian matrix of f x y z b is j r 1 y α b c y z 2 r 1 x k 1 z β 1 b x α b c y z 2 x α c y 2 b c y z 2 r 1 β 1 x k 1 z β 1 2 y γ b c y z b γ x b c y z 2 μ ν z y c γ x y b c y z 2 ν 0 r 2 β 2 z 2 k β 2 y 2 r 2 2 r 2 z k 2 β 2 y let all system parameters be fixed except b since j p 1 b ˆ 1 r 1 α μ γ r 1 β 1 0 0 0 0 0 r 2 the eigenvalues of j p 1 b ˆ 1 are λ 1 r 1 λ 2 0 and λ 3 r 2 to prove that system 1 presents a transcritical bifurcation at p 1 we will use sotomayor s theorem to this end we calculate v w which are the right and left eigenvectors associated with the eigenvalue λ 2 0 respectively v α μ r 1 γ 1 0 and w 0 1 0 differentiating f x y b with respect to bifurcation parameter b we obtain f b x y z b α x y b c y z 2 γ x y b c y z 2 0 thus 15 w t f b p 1 b ˆ 1 0 furthermore since d f b p 1 b ˆ 1 v α μ 2 k 1 γ 2 μ 2 k 1 γ 0 it follows that 16 w t d f b p 1 b ˆ 1 v 0 1 0 α μ 2 k 1 γ 2 μ 2 k 1 γ 0 μ 2 k 1 γ 0 and since d 2 f p 1 b ˆ 1 v v 0 2 α μ 2 r 1 k 1 γ 0 then 17 w t d 2 f p 1 b ˆ 1 v v 2 α μ 2 r 1 k 1 γ 0 therefore 15 16 and 17 satisfy the conditions of sotomayor s theorem appendix c proof of proposition 3 2 let f x y z b be as defined in proposition 3 1 let all system parameters be fixed with the exception of b then the jacobian matrix of f x y z b at p 3 is j p 3 b ˆ 2 r 1 α μ k 2 ν γ r 1 β 1 0 0 0 0 r 2 β 2 r 2 the eigenvalues of j p 3 b ˆ 2 are λ 1 r 1 λ 2 0 and λ 3 r 2 the right and left eigenvectors associated with the eigenvalue λ 2 0 are v β 1 α μ k 2 ν r 1 β 2 γ 1 β 2 1 and w 0 1 0 respectively differentiating f x y b with respect to bifurcation parameter b we obtain f b x y z b α x y b c y z 2 γ x y b c y z 2 0 hence 18 w t f b p 3 b ˆ 2 0 now we will obtain the expression for w t d f b p 3 b ˆ 2 v since d f b p 3 b ˆ 2 v α μ k 2 ν 2 k 1 k 2 β 1 β 2 γ 2 μ k 2 ν 2 k 1 k 2 β 1 β 2 γ 0 it follows that 19 w t d f b p 3 b ˆ 2 v 0 1 0 α μ k 2 ν 2 k 1 k 2 β 1 β 2 γ 2 μ k 2 ν 2 k 1 k 2 β 1 β 2 γ 0 μ k 2 ν 2 k 1 k 2 β 1 β 2 γ 0 next we obtain the expression for w t d 2 f p 3 b ˆ 2 v v since d 2 f p 3 b ˆ 2 v v 2 α μ k 2 ν β 1 β 2 γ c k 2 μ k 2 ν k 1 k 2 β 1 β 2 2 γ 2 2 n ˆ r 1 k 1 k 2 β 1 β 2 2 γ 0 it follows that 20 w t d 2 f p 3 b ˆ 2 v v 2 n ˆ r 1 k 1 k 2 β 1 β 2 2 γ if n ˆ 0 then w t d 2 f b p 3 b ˆ 2 v v 0 therefore 18 19 and 20 satisfy the conditions for transcritical bifurcation according to sotomayor s theorem finally we will obtain the expression for w t d 3 f p 3 b ˆ 2 v v v since d 3 f p 3 b ˆ 2 v v v 6 α μ k 2 ν 2 s ˆ 1 r 1 k 1 k 2 β 1 2 β 2 3 γ 3 6 c μ k 2 ν 2 s ˆ 2 r 1 k 1 k 2 β 1 2 β 2 3 γ 2 0 where s ˆ 1 c k 1 r 1 β 2 γ α β 1 β 2 γ c 2 k 2 2 r 1 μ k 2 ν c k 2 2 r 1 β 1 β 2 γ α μ k 2 ν s ˆ 2 k 1 r 1 β 2 γ k 2 2 r 1 β 1 β 2 γ c k 2 r 1 μ k 2 ν α μ k 2 ν it follows that 21 w t d 3 f p 3 b ˆ 2 v v v 6 c μ k 2 ν 2 s ˆ 2 r 1 k 1 k 2 β 1 2 β 2 3 γ 2 if n ˆ 0 then s ˆ 2 0 hence w t d 3 f p 3 b ˆ 2 v v v 0 therefore p 3 has a pitchfork bifurcation according to sotomayor s theorem appendix d assignment of proposition 3 4 m 1 b k 1 c k 1 k 2 y 0 b k 2 β 1 c k 2 2 y 0 β 1 3 c k 1 y 0 2 β 2 2 b y 0 β 1 β 2 3 c k 2 y 0 2 β 1 β 2 2 c y 0 3 β 1 β 2 2 m 2 2 y 0 γ 2 r 1 b 2 β 1 β 2 c 2 k 1 y 0 3 β 2 2 b c k 2 k 1 k 2 β 1 3 y 0 k 1 k 2 β 1 β 2 3 y 0 2 β 1 β 2 2 b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 b β 1 β 2 c β 1 k 2 y 0 β 2 2 c k 1 k 2 2 y 0 β 2 γ β 2 b c y 0 k 2 y 0 β 2 2 ν b c y 0 2 β 2 k 1 β 1 k 2 y 0 β 2 γ y 0 β 2 b c y 0 k 2 y 0 β 2 2 ν c β 2 b c y 0 k 2 y 0 β 2 b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 b c y 0 2 β 2 k 1 β 1 k 2 y 0 β 2 2 γ k 2 b c k 2 y 0 k 1 k 2 β 1 y 0 4 c k 2 y 0 k 1 k 2 β 1 b 3 k 1 5 k 2 β 1 β 2 y 0 2 5 b β 1 c y 0 5 k 1 6 k 2 β 1 β 2 2 3 c y 0 4 β 1 β 2 3 b c y 0 k 2 y 0 β 2 ν r 1 b c y 0 2 β 2 k 1 β 1 k 2 y 0 β 2 γ r 1 y 0 β 2 b c y 0 k 2 y 0 β 2 2 ν m 3 6 β 2 b c y 0 k 2 y 0 β 2 b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 γ 3 r 1 y 0 b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 b c y 0 2 β 2 2 c k 1 k 1 k 2 β 1 b β 1 2 β 2 γ b c k 2 b c k 2 y 0 k 1 k 2 β 1 b b 2 β 1 5 c 2 k 2 y 0 2 k 1 k 2 β 1 b c y 0 4 k 1 5 k 2 β 1 β 2 b c y 0 2 8 b β 1 c y 0 10 k 1 9 k 2 β 1 β 2 2 c 2 y 0 4 2 c k 1 y 0 7 b β 1 β 2 3 b c y 0 k 2 y 0 β 2 ν b β 1 β 2 c β 1 k 2 y 0 β 2 2 c k 1 k 2 2 y 0 β 2 γ β 2 b c y 0 k 2 y 0 β 2 2 ν c b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 r 1 b c y 0 2 β 2 k 1 β 1 k 2 y 0 β 2 γ r 1 y 0 β 2 b c y 0 k 2 y 0 β 2 2 ν b c y 0 2 β 2 2 k 1 β 1 k 2 y 0 β 2 2 γ b c y 0 k 2 y 0 β 2 b c y 0 k 2 2 k 1 k 2 β 1 5 k 2 y 0 k 1 k 2 β 1 β 2 y 0 2 10 k 1 11 k 2 β 1 β 2 2 8 y 0 3 β 1 β 2 3 c 2 y 0 5 β 2 3 2 k 1 β 1 k 2 y 0 β 2 b 2 k 1 k 2 4 y 0 β 2 β 1 k 2 2 6 k 2 y 0 β 2 7 y 0 2 β 2 2 ν appendix e proof of proposition 3 4 the vector field of system 1 can be written as f x y z μ r 1 x 1 x k 1 β 1 z α x y b c y z γ x y b c y z μ y ν y z r 2 z 1 z k 2 β 2 y let all system parameters be fixed with the exception of μ then the jacobian matrix j p μ has a unique zero eigenvalue when μ μ ˆ 1 the right and left eigenvectors associated with the zero eigenvalue are respectively v v 1 v 2 v 2 and w w 1 w 2 w 3 where v 1 c k 2 2 y 0 β 2 b c y 0 2 β 2 k 1 β 1 k 2 y 0 β 2 2 γ β 2 b c y 0 k 2 y 0 β 2 2 c k 1 y 0 2 β 2 b k 1 β 1 k 2 2 y 0 β 2 ν v 2 b c y 0 k 2 y 0 β 2 b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 γ v 3 β 2 b c y 0 k 2 y 0 β 2 b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 γ w 1 y 0 b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 γ 2 w 2 b c y 0 k 2 y 0 β 2 r 1 b c y 0 2 β 2 k 1 β 1 k 2 y 0 β 2 γ r 1 y 0 β 2 b c y 0 k 2 y 0 β 2 2 ν w 3 n 8 r 2 b k 1 β 1 k 2 2 y 0 β 2 c y 0 β 1 k 2 y 0 β 2 k 2 2 y 0 β 2 k 1 k 2 3 y 0 β 2 n 8 r 1 y 0 k 1 β 1 k 2 y 0 β 2 b c y 0 2 β 2 k 1 β 1 k 2 y 0 β 2 γ y 0 β 2 b c y 0 k 2 y 0 β 2 2 ν c y 0 k 1 β 1 k 2 y 0 β 2 γ c 2 y 0 2 k 2 y 0 β 2 2 ν b β 1 γ b ν differentiating f x y μ with respect to bifurcation parameter μ we obtain f μ x y z μ r 1 x y b c y 0 k 2 y 0 β 2 b c y 0 k 2 y 0 β 2 y 0 b c y z k 1 β 1 k 2 y 0 β 2 γ y 0 thus 22 w t f μ p μ ˆ 1 0 and 23 w t d f μ p μ ˆ 1 v γ ν r 1 y 0 β 2 b c k 2 y 0 c y 0 2 β 2 3 m 1 k 1 k 2 β 1 y 0 β 1 β 2 since m 1 0 it follows that w t d f μ p μ ˆ 1 v 0 moreover we have 24 w t d 2 f p μ ˆ 1 v v m 2 by 22 and 23 if m 2 0 then p has a transcritical bifurcation according to sotomayor s theorem finally we have w t d 3 f p μ ˆ 1 v v v m 3 by 22 and 23 if m 2 0 and m 3 0 then p has a pitchfork bifurcation according to sotomayor s theorem appendix f proof of proposition 3 5 let us assume that the system presents a hopf bifurcation at point p since the characteristic polynomial of j p given in 12 is p 1 λ λ 3 c 1 λ 2 c 2 λ c 3 which can be written as p 2 λ λ ε λ 2 w 2 λ 3 ε λ 2 w 2 λ w 2 ε where ε c 1 and c 3 c 1 c 2 0 we have 25 c 3 c 1 c 2 s 0 r 1 2 s 1 r 1 s 2 b c k 2 y 0 c y 0 2 β 2 2 k 1 k 2 β 1 y 0 β 1 β 2 2 γ 2 where s 0 b c y 0 k 2 y 0 β 2 2 μ k 2 y 0 β 2 ν 2 b k 1 γ k 2 y 0 β 2 2 c r 2 y 0 β 1 γ b 2 r 2 μ k 2 y 0 β 2 ν c 2 y 0 2 k 2 y 0 β 2 2 r 2 μ k 2 y 0 β 2 ν s 1 γ μ k 2 y 0 β 2 ν b 3 r 2 k 1 r 2 k 2 β 1 r 2 y 0 β 2 ν y 0 β 1 β 2 r 2 μ y 0 β 2 ν b 2 c y 0 k 1 3 k 2 r 2 2 3 r 2 2 y 0 β 2 2 k 2 r 2 μ r 2 y 0 β 2 μ k 2 μ 2 y 0 β 2 μ 2 k 2 y 0 β 2 r 2 2 k 2 y 0 β 2 2 k 2 y 0 β 2 μ ν k 2 y 0 β 2 3 ν 2 β 1 3 k 2 2 r 2 2 6 k 2 r 2 2 y 0 β 2 3 r 2 2 y 0 2 β 2 2 2 k 2 2 r 2 μ 6 k 2 r 2 y 0 β 2 μ 4 r 2 y 0 2 β 2 2 μ k 2 2 μ 2 2 k 2 y 0 β 2 μ 2 y 0 2 β 2 2 μ 2 2 k 2 y 0 β 2 2 r 2 k 2 2 y 0 β 2 k 2 y 0 β 2 μ ν k 2 y 0 β 2 4 ν 2 c 2 y 0 3 k 2 y 0 β 2 r 2 β 2 k 1 β 1 k 2 y 0 β 2 2 γ c k 2 y 0 β 2 β 1 k 2 y 0 β 2 2 r 2 μ k 2 ν y 0 β 2 ν 2 k 1 k 2 r 2 2 r 2 2 y 0 β 2 2 k 2 r 2 μ r 2 y 0 β 2 μ k 2 μ 2 y 0 β 2 μ 2 k 2 y 0 β 2 2 k 2 r 2 μ y 0 β 2 r 2 2 μ ν k 2 y 0 β 2 3 ν 2 b c y 0 k 1 β 1 k 2 y 0 β 2 2 γ r 2 y 0 β 2 k 2 y 0 β 2 μ k 2 ν y 0 β 2 ν c r 2 y 0 k 2 y 0 β 2 β 1 k 2 y 0 β 2 3 k 2 r 2 3 r 2 y 0 β 2 4 k 2 μ 5 y 0 β 2 μ k 2 y 0 β 2 4 k 2 5 y 0 β 2 ν k 1 4 k 2 2 ν y 0 β 2 3 r 2 2 μ 2 y 0 β 2 ν k 2 3 r 2 4 μ 6 y 0 β 2 ν s 2 r 2 y 0 k 1 β 1 k 2 y 0 β 2 2 γ 2 c k 2 2 y 0 β 2 μ b β 2 ν c k 2 y 0 β 2 k 2 3 y 0 β 2 ν b r 2 c y 0 k 2 y 0 β 2 r 2 μ k 2 ν y 0 β 2 ν we observe that s 2 is negative and using mathematica we obtain that s 0 and s 1 are also negative by descartes rule we have that the polynomial s 0 r 1 2 s 1 r 1 s 2 does not have positive roots however this is a contradiction to the fact that c 3 c 1 c 2 0 since the system s parameters must be positive therefore system 1 does not present a hopf bifurcation at p in the same way if in the expression 25 the numerator is considered a function of r 2 we conclude that system 1 does not have a hopf bifurcation in p with respect to parameter r 2 appendix g proof of proposition 3 7 to analyze system 1 we rescale it so it becomes the following topologically equivalent polynomial system x x 1 y 0 1288 y z 0 1288 0 1288 z x 0 1288 y z y 1 5677 0 5677 z z y 0 9837 y 1 y 1 z 0 1288 y z 8 1323 x z 0 1288 y 1 z 0 1288 z 1 y z z 1 z 0 1288 y z 2 transferring the equilibrium point p to the origin we obtain the following conjugate system y 1 j y 1 f 2 y 1 o y 1 3 where 26 j 4 6441 3 3972 0 3 3972 4 6441 0 0 0 0 y 1 y 11 y 12 y 13 and f 2 f 1 f 2 f 3 with f 1 9 0914 y 11 y 12 3 9421 y 11 2 5 7828 y 12 2 18 7972 y 11 y 13 11 2878 y 12 y 13 2 1696 y 13 2 f 2 1 7875 y 11 2 17 1649 y 11 y 12 13 0055 y 12 2 15 3194 y 11 y 13 17 9106 y 12 y 13 3 7862 y 13 2 f 3 0 3407 y 11 2 0 8496 y 11 y 12 0 2433 y 12 2 0 5711 y 11 y 13 0 0291 y 12 y 13 0 1888 y 13 2 as the linear part of the system 26 has a zero eigenvalue we will analyze its dynamics using the central manifold theory carr 1981 let c 0 p 4 6441 3 3972 3 3972 4 6441 f f 3 o y 1 3 and g f 1 o y 1 3 f 2 o y 1 3 we make h y 13 α 1 y 13 α 2 y 13 in order to eliminate the quadratic terms of the following equation 27 d h y 13 c y 13 f h y 13 y 13 p h y 13 g h y 13 y 13 0 which is equivalent to solving the following system 28 2 1696 4 6441 α 1 3 3972 α 2 0 3 7862 3 3972 α 1 4 6441 α 2 0 the solution to this system is α 1 0 6928 and α 2 0 3085 so that h y 13 0 6928 y 13 2 0 3085 y 13 2 thus system 26 restricted to the central manifold is y 13 0 1888 y 13 2 o y 13 3 by the non hyperbolic equilibrium point classification theorem perko 2006 system 26 has a saddle node bifurcation at the origin since this system was obtained with the assignment of μ given in 13 we conclude that system 1 has a saddle node bifurcation at μ 544 553 
24452,in this paper we studied the brown planthopper bph infestation on rice under the effects of monsoon using a two time scales stage structured predator prey model we divided the bph population into two distinct stages mature and juvenile owing to the significant biological differences between the two we considered a heterogeneous environment composed of two adjacent rice fields using the two time scales we reduced the model into an aggregated model with smaller dimensions and topological equivalent the positivity and boundedness of the model s solution were established we conducted the dynamical analysis of the bph rice ecosystem through the local and global stability of the model s equilibria moreover the effects of rice fields area and monsoon were analyzed using hopf bifurcation theory we performed numerical simulations to illustrate the theoretical results finally we provided some emergence discussions from the ecological perspective to give useful information for preventing and managing bph on rice keywords brown planthopper monsoon factor predator prey model aggregated method stability analysis hopf bifurcation 1 introduction in recent decades science and technology have revolutionized agriculture throughout the world the applications of mathematical biology models to simulate the relationships in agriculture have achieved remarkable attention especially in the predator prey ecology drechsler and settele 2001 maiti et al 2008 mondal et al 2019 rafikov and silveira 2014 sarkar et al 2018 it also contributes to simulation and testing of insect pest control methods maiti et al 2006 saha and samanta 2020 rice is a major staple and economically important crop for southeast asian countries therefore preventing diseases and pest infestations in rice is of significant importance brown planthopper bph is the most dangerous pest that infects rice by causing an outbreak of hopper burn when the density of bph per unit area grows exponentially and bphs spread over the entire area the question arises as to how to control bph s growth and the interactions with rice for this reason the bph and rice system has been a focus of both experimental and theoretical research as a predator prey ecology using different approaches such as equation based model ebm khor and chua 1986 thuy et al 2019 vattikuti et al 2019 agent based model abm linh et al 2016 nguyen et al 2011 and machine learning lakmal et al 2019 thakur et al 2020 nguyen et al 2011 analyzed the effects of weather on the growth and invasion of bph at various locations and times using real data into an agent based system in linh et al 2016 linh et al used abm to simulate the effects of natural enemies on the growth and dispersal of bph in rice fields however building the abm requires a huge amount of real data and high computer processing power therefore ebm still attracts many experts to choose as a research direction although it is less intuitive than abm khor and chua 1986 developed a mathematical model using ebm based ordinary differential equations odes to simulate the growth of bph divided into five age periods however their model did not study the impact of bph infestation in rice fields in 2019 vattikuti et al 2019 built linear and non linear models to describe growth rates of bph life stages as a function of temperature and gave estimates of bioclimatic thresholds under effects of temperature thuy et al 2019 proposed an odes model with the stage structured and the rapid dispersion of bph across two rice fields this model was elementary because it assumed the dispersion is proportional to the population density with the ratio remaining constant in this paper we use ebm to construct a predator prey model to investigate the effect of the monsoon on the relationship between bph and rice the stage structure hypothesis is used in the bph population with two stages juvenile and mature only mature bph extracts nutrition from rice and spreads across fields stage structured predator prey has also gained the attention of researchers because dynamics incorporating stage structure presume more intricate population dynamics than those without these factors jia et al 2017 kaushik and banerjee 2021 we simulated a heterogeneous environment consisting of two fields having the same maximum carrying capacities of rice and the dispersal of mature bph served as the connection between them in practice the dispersion usually happens in a much faster than the growth of bph leading to two different time scales a fast scale for the dispersal and a slow scale for the natural growth and predation on each local field in mchich et al 2007 nguyen ngoc et al 2012 and thuy et al 2019 these authors also studied the fast dispersion of a predator prey model in a two patch environment moreover southeast asian countries are located mainly in the humid tropical belt where the effect of monsoons is evident and prominent the monsoon winds often blow strongly in one direction along with the behavior of bph is dispersed and diffuses depending on the wind thus we consider the dispersion direction of mature bph from the first to the second field during monsoon the effect of wind on many aspects of brown planthopper dispersal has been studied in nguyen et al 2011 the authors simulated dispersal with wind factors in different seasons the time for long winged mature bph to follow the wind direction and spread to other plots is from 5 to 7 days in huynh et al 2021 the rules for two wind directions southwest and northeast were used in eight cases to find out the appropriate light trap location in the wind direction the rest of this paper is organized as follows in section 2 the mathematical model with ecological assumptions and the meaning of parameters are described section 3 derives the positivity and boundedness of solutions and presents the reduced model after using the aggregation method in section 4 the stability analysis of the equilibrium points and hopf bifurcation is established section 5 is devoted to illustrating some numerical simulations of our theoretical results concerning some crucial parameters finally we give some discussions and the biological significance of our analytical findings in section 6 2 model formulation let n i donate population density of rice p i j and p i a donate the population density of the juvenile and the mature bph in field i in which i 1 2 for rice we consider that the rice population density increases in the absence of bph followed by the logistic law with r i are the intrinsic growth rate of rice in field i and k is the carrying capacity of both fields functional response is the intake rate of the predator as a function of food prey density following c s holling it is generally classified into three types which are called holling s type i ii and iii see dawes and souza 2013 type i functional response assumes a linear increase in intake rate with prey density the linear increase assumes that the time needed by the predator to hunt the prey is negligible or that consuming food does not interfere with searching for prey this is entirely consistent with the rice and bph system where bph often appears later and almost does not take time to find food therefore we select holling type i functional response for the bph rice relationship with an intake predation rate a i in the field i for bph we assume both juvenile and mature have a natural amount of death represented by the mortality rate d i j of the juvenile stage and d i a of the mature stage in the field i since only the mature can eat and reproduce there is a conversion rate e i from the amount of energy eaten for reproduction in the field i on the contrary the juvenile can grow to mature so we consider that after the accumulation period the juvenile bph is transformed to mature with the constant rate α i in field i about the fast dispersal of the mature bph we assume the dispersion under the impact of the monsoon and depend on the population density in the starting field furthermore by the one direction property of monsoon so there is a particular direction assume that it is from field 1 to field 2 in which the effect of monsoon is represented by a first order function of the mature bph density in field 1 with two parameters m 0 and m 1 the remaining dispersal direction has a dispersion rate m the parameter ɛ represents the ratio between two time scales multiplied into expressions of the slow process fig 1 gives a visualization of the bph rice system we study from the above assumptions we formulate a mathematical model for the bph rice system as follows 2 1 d n 1 d τ ɛ r 1 n 1 1 n 1 k a 1 n 1 p 1 a d n 2 d τ ɛ r 2 n 2 1 n 2 k a 2 n 2 p 2 a d p 1 a d τ ɛ d 1 a p 1 a α 1 p 1 j m p 2 a m 0 m 1 p 1 a p 1 a d p 2 a d τ ɛ d 2 a p 2 a α 2 p 2 j m 0 m 1 p 1 a p 1 a m p 2 a d p 1 j d τ ɛ d 1 j p 1 j α 1 p 1 j e 1 a 1 n 1 p 1 a d p 2 j d τ ɛ d 2 j p 2 j α 2 p 2 j e 2 a 2 n 2 p 2 a where τ and t is the fast and slow time scale with t ɛ τ the complete model subjects to the initial conditions n i 0 0 p i a 0 0 p i j 0 0 i 1 2 we call this system the complete model to distinguish it from the aggregated model in section 3 the definition brief of variables and parameters in the model are shown in table 1 3 positivity boundedness and aggregated model in this section we concentrate on analyzing the positivity and boundedness of the complete model after that it is devoted to the construction of the aggregated model 3 1 positivity and boundedness theorem 3 1 all the solutions of the complete model which start in r 6 are always positive and bounded proof we begin by proving the positive properties of the solution let the right hand equations of model 2 1 are f i n 1 n 2 p 1 a p 2 a p 1 j p 2 j i 1 6 define the non negative cone k x n 1 n 2 p 1 a p 2 a p 1 j p 2 j r 6 x 0 obviously n 1 0 n 2 0 p 1 a 0 p 2 a 0 p 1 j 0 p 2 j 0 k furthermore if n 1 0 n 2 0 p 1 a 0 p 2 a 0 p 1 j 0 p 2 j 0 we have f 1 0 n 2 p 1 a p 2 a p 1 j p 2 j 0 0 f 2 n 1 0 p 1 a p 2 a p 1 j p 2 j 0 0 f 3 n 1 n 2 0 p 2 a p 1 j p 2 j ɛ α 1 p 1 j m p 2 a 0 f 4 n 1 n 2 p 1 a 0 p 1 j p 2 j ɛ α 2 p 2 j m 0 m 1 p 1 a p 1 a 0 f 5 n 1 n 2 p 1 a p 2 a 0 p 2 j ɛ e 1 a 1 n 1 p 1 a 0 f 6 n 1 n 2 p 1 a p 2 a p 1 j 0 ɛ e 2 a 2 n 2 p 2 a 0 therefore by using theorem in efendiev and eberl 2007 we obtain n 1 t n 2 t p 1 a t p 2 a t p 1 j t p 2 j t k with t ɛ τ and t r thus the solutions remain in the r 6 now we prove the bounded properties from the first two equations of model 2 1 by using the non negative of the state variables we obtain d n 1 d τ ɛ r 1 n 1 1 n 1 k d n 2 d τ ɛ r 2 n 2 1 n 2 k then using the standard results for ordinary differential inequalities we have lim t sup n 1 t k lim t sup n 2 t k n 1 k n 2 k with t ɛ τ let s t e 1 n 1 t e 2 n 2 t p 1 a t p 2 a t p 1 j t p 2 j t along the equations of model 2 1 we get d s d t e 1 r 1 n 1 1 n 1 k e 2 r 2 n 2 1 n 2 k d 1 a p 1 a d 2 a p 2 a d 1 j p 1 j d 2 j p 2 j d s d t σ s e 1 r 1 n 1 1 n 1 k e 2 r 2 n 2 1 n 2 k d 1 a σ p 1 a d 2 a σ p 2 a d 1 j σ p 1 j d 2 j σ p 2 j σ e 1 n 1 e 2 n 2 choose σ min d 1 a d 2 a d 1 j d 2 j we have d s d t σ s e 1 r 1 n 1 1 n 1 k e 2 r 2 n 2 1 n 2 k σ e 1 n 1 e 2 n 2 e 1 r 1 e 2 r 2 e 1 σ e 2 σ k putting m e 1 r 1 e 2 r 2 e 1 σ e 2 σ k and using a lemma in differential equations inequalities birkhoff and rota 1978 we obtain 0 s t m σ s 0 e σ t when t we get 0 s t m σ hence all the solutions of the model 2 1 are bounded theorem 3 2 for any given initial value in r 6 the complete model 2 1 has a unique positive solution proof let the right hand equations of model 2 1 are f i n 1 n 2 p 1 a p 2 a p 1 j p 2 j i 1 6 the first partial derivatives of f i with respect to all variables are exist and bounded when n 1 n 2 p 1 a p 2 a p 1 j p 2 j are positive and bounded is easy checked thus there is a unique positive solution of 2 1 3 2 the aggregated model this subsection is devoted to the construction of the aggregated model because the complete model used two time scales we can apply the aggregated method see auger and rafae 2000 and auger et al 2000 to reduce the dimension of the model and obtain a less complex model the key of this method is to accentuate the variables in the slow time scale it is easily seen that the total density of mature bph in both fields is not affected by the fast dispersal and it fluctuates in a slow time scale when it only depends on the competition process between bph and rice for this we define p a p 1 a p 2 a the model 2 1 becomes 3 1 d p 1 a d τ m p a p 1 a m 0 m 1 p 1 a p 1 a ɛ d 1 a p 1 a α 1 p 1 j d p a d τ ɛ d 1 a p 1 a d 2 a p a p 1 a α 1 p 1 j α 2 p 2 j d n 1 d τ ɛ r 1 n 1 1 n 1 k a 1 n 1 p 1 a d n 2 d τ ɛ r 2 n 2 1 n 2 k a 2 n 2 p a p 1 a d p 1 j d τ ɛ d 1 j p 1 j α 1 p 1 j e 1 a 1 n 1 p 1 a d p 2 j d τ ɛ d 2 j p 2 j α 2 p 2 j e 2 a 2 n 2 p a p 1 a now system 3 1 has five slow time scale variables n 1 n 2 p a p 1 j p 2 j and a fast time scale variable p 1 a for ɛ 0 after some calculation we obtain representation of p 1 a depend on slow time scale variables 3 2 p 1 a μ 1 μ 1 2 μ 2 p a where μ 1 m 0 m 2 m 1 and μ 2 m m 1 coming back to the complete model 2 1 we substitute the representation 3 2 and add the variable of the total mature bph population density we get a aggregated model when using only one slow time scale t as follows 3 3 d n 1 d t n 1 r 1 1 n 1 k a 1 μ 1 μ 1 2 μ 2 p a d n 2 d t n 2 r 2 1 n 2 k a 2 μ 1 2 μ 2 p a μ 1 p a d p a d t d 1 a d 2 a μ 1 μ 1 2 μ 2 p a d 2 a p a α 1 p 1 j α 2 p 2 j d p 1 j d t d 1 j α 1 p 1 j e 1 a 1 n 1 μ 1 2 μ 2 p a μ 1 d p 2 j d t d 2 j α 2 p 2 j e 2 a 2 n 2 p a μ 1 μ 1 2 μ 2 p a remark 3 1 this aggregated model is an ɛ approximation of the restriction of the complete model to this invariant five dimensional set the restricted dynamic can be approximated by a taylor expansion with respect to the small parameter ɛ see mchich et al 2007 when ɛ is small enough and the aggregated model dynamic is structurally stable then the aggregated model dynamic provides a good alternative to the complete model trajectories behavior fig 2 shows the behavior of the rice densities in field 1 of both models with the same initial conditions and parameter values as ɛ changes and gets a small value it can be found the similarity in the value of the solution while the time scale goes on the infinitive from now we use the aggregated model 3 3 to study the behavior of the complete model 2 1 4 stability analysis 4 1 existence of equilibrium points in this subsection we study the existence of equilibrium of the aggregated model model 3 3 has the following equilibrium point the trivial equilibrium e 0 0 0 0 0 0 always exists corresponding to the case that rice and bph disappear together on both fields two equilibrium points e 1 k 0 0 0 0 and e 2 0 k 0 0 0 always exist corresponding to the case that bph disappear on both fields and rice grows to the maximum capacity on one field the bph free equilibrium e 3 k k 0 0 0 always exists corresponding to the case that only rice grows to the maximum capacity on both fields this is the ideal equilibrium point the equilibrium e 4 n 1 0 p a p 1 j 0 corresponds to the case that rice and the juvenile bph disappear on field 2 where n 1 k k a 1 r 1 μ 1 μ 1 2 μ 2 p a p 1 j e 1 a 1 n 1 d 1 j α 1 μ 1 2 μ 2 p a μ 1 p a μ 2 h 2 2 μ 1 d 2 a h 2 2 μ 1 h 1 d 2 a μ 2 h 1 2 with h 1 k e 1 a 1 2 α 1 r 1 d 1 j α 1 and h 2 k e 1 a 1 α 1 d 1 j α 1 d 1 a d 2 a the equilibrium e 5 0 n 2 p a 0 p 2 j corresponds to the case that rice and the juvenile bph disappear on field 1 where n 2 k k a 2 r 2 μ 1 2 μ 2 p a μ 1 p a p 2 j e 2 a 2 n 2 d 2 j α 2 p a μ 1 μ 1 2 μ 2 p a and p a p a is positive solution of the following equation d 1 a d 2 a μ 1 μ 1 2 μ 2 p a k e 2 a 2 α 2 d 2 j α 2 p a μ 1 μ 1 2 μ 2 p a d 2 a p a k e 2 a 2 2 α 2 r 2 d 2 j α 2 p a μ 1 μ 1 2 μ 2 p a 2 0 the equilibrium e 6 n 1 n 2 p a p 1 j p 2 j corresponds to the case that rice and the bph co exist on both fields where n 1 k k a 1 r 1 μ 1 μ 1 2 μ 2 p a n 2 k k a 2 r 2 μ 1 2 μ 2 p a μ 1 p a p 1 j e 1 a 1 n 1 d 1 j α 1 μ 1 2 μ 2 p a μ 1 p 2 j e 2 a 2 n 2 d 2 j α 2 p a μ 1 μ 1 2 μ 2 p a and p a p a is positive solution of the following equation d 1 a d 2 a μ 1 μ 1 2 μ 2 p a d 2 a p a k e 1 a 1 α 1 d 1 j α 1 μ 1 2 μ 2 p a μ 1 k e 1 a 1 2 α 1 r 1 d 1 j α 1 μ 1 μ 1 2 μ 2 p a 2 k e 2 a 2 α 2 d 2 j α 2 p a μ 1 μ 1 2 μ 2 p a k e 2 a 2 2 α 2 r 2 d 2 j α 2 p a μ 1 μ 1 2 μ 2 p a 2 0 4 2 local stability in this subsection we establish the local stability of all equilibrium points by using the first lyapunov method in combination with the routh hurwitz criterion see kuznetsov 1998 theorem 4 1 three equilibrium points on the axis e 0 e 1 e 2 are always unstable proof let us first prove the theorem for the equilibrium e 0 the jacobian matrix of model 3 3 at e 0 is given by j e 0 r 1 0 0 0 0 0 r 2 0 0 0 0 0 d α 1 α 2 0 0 0 d 1 a α 1 0 0 0 0 0 d 2 a α 2 where d d 1 a μ 2 2 μ 1 d 2 a 1 μ 2 2 μ 1 the characteristic equation of this jacobian matrix with the eigenvalue λ is r 1 λ r 2 λ d λ d 1 a α 1 λ d 2 a α 2 λ 0 it is easy to see that there is an eigenvalue λ r 1 0 thus using the first lyapunov method so e 0 is always unstable similar arguments apply to the case of equilibrium e 1 and e 2 hence theorem 4 1 is proved theorem 4 2 let the following inequalities hold d 1 a μ 2 2 μ 1 d 2 a 1 μ 2 2 μ 1 k e 1 a 1 α 1 d 1 j α 1 μ 2 2 μ 1 k e 2 a 2 α 2 d 2 j α 2 1 μ 2 2 μ 1 then the bph free equilibrium e 3 is locally asymptotically stable proof the jacobian matrix of model 3 3 at e 3 is given j e 3 r 1 0 k a 1 μ 2 2 μ 1 0 0 0 r 2 k a 2 1 μ 2 2 μ 1 0 0 0 0 d α 1 α 2 0 0 k e 1 a 1 μ 2 2 μ 1 d 1 0 0 0 k e 2 a 2 1 μ 2 2 μ 1 0 d 2 where d d 1 a μ 2 2 μ 1 d 2 a 1 μ 2 2 μ 1 d 1 d 1 j α 1 d 2 d 2 j α 2 f 1 k e 1 a 1 α 1 μ 2 2 μ 1 f 2 k e 2 a 2 α 2 1 μ 2 2 μ 1 the characteristic equation of this jacobian matrix is r 1 λ r 2 λ d λ d 1 λ d 2 λ f 1 d 2 λ f 2 d 1 λ 0 clearly r 1 0 and r 2 0 so this equation reduces to λ 3 s 1 λ 2 s 2 λ s 3 0 where s 1 d d 1 d 2 s 2 d d 1 d d 2 d 1 d 2 f 1 f 2 s 3 d d 1 d 2 f 1 d 2 f 2 d 1 because s 1 0 using routh hurwitz criterion necessary and sufficient conditions for locally asymptotically stable of e 3 is s 3 0 s 1 s 2 s 3 simplify the condition is only s 3 0 this is also the inequalities in theorem 4 2 hence this theorem is proved theorem 4 3 equilibrium e 4 is local asymptotically stable if a 0 0 a 3 0 and a 1 a 2 a 3 where a 0 a 1 a 2 a 3 are the coefficients of λ in the characteristic equation of the variational matrix of e 4 as follow a 0 λ λ d 2 j α 2 λ 3 a 1 λ 2 a 2 λ a 3 0 proof the jacobian matrix of model 3 3 at e 4 is given j e 4 j 11 0 a 1 n 1 μ 2 2 μ 1 2 μ 2 p a 0 0 0 j 22 0 0 0 0 0 j 33 α 1 α 2 j 41 0 e 1 a 1 n 1 μ 2 2 μ 1 2 μ 2 p a d 1 j α 1 0 0 j 52 0 0 d 2 j α 2 where j 11 r 1 a 1 μ 1 μ 1 2 μ 2 p a j 22 r 2 a 2 μ 1 2 μ 2 p a μ 1 p a j 33 d 1 a μ 2 2 μ 1 2 μ 2 p a d 2 a 1 μ 2 2 μ 1 2 μ 2 p a j 41 e 1 a 1 μ 1 2 μ 2 p a μ 1 j 52 e 2 a 2 p a μ 1 μ 1 2 μ 2 p a the characteristic equation of this jacobian matrix is j 22 λ d 2 j α 2 λ λ 3 a 1 λ 2 a 2 λ a 3 0 where a 1 j 11 j 33 d 1 j α 1 a 2 j 33 d 1 j α 1 e 1 a 1 α 1 n 1 μ 2 2 μ 1 2 μ 2 p a j 11 j 33 d 1 j α 1 a 3 j 11 j 33 d 1 j α 1 e 1 a 1 α 1 n 1 μ 2 j 11 2 μ 1 2 μ 2 p a e 1 a 1 2 α 1 n 1 μ 2 μ 1 2 μ 2 p a μ 1 2 μ 1 2 μ 2 p a clearly d 2 j α 2 0 a 1 0 and set a 0 j 22 by using routh hurwitz criterion necessary and sufficient conditions for locally asymptotically stable of e 4 is a 0 0 a 3 0 and a 1 a 2 a 3 hence theorem 4 3 is proved theorem 4 4 equilibrium e 5 is local asymptotically stable if b 0 0 b 3 0 and b 1 b 2 b 3 where b 0 b 1 b 2 b 3 are the coefficients of λ in the characteristic equation of the variational matrix of e 5 as follow b 0 λ λ d 1 j α 1 λ 3 b 1 λ 2 b 2 λ b 3 0 theorem 4 5 equilibrium e 6 is local asymptotically stable if i c i 0 i 1 2 3 4 5 ii c 1 c 2 c 3 iii c 1 c 2 c 3 c 3 2 c 1 2 c 4 c 1 c 5 0 iv c 3 c 4 c 2 c 5 c 1 c 2 c 3 c 1 c 4 c 5 2 where c 1 c 2 c 3 c 4 c 5 are the coefficients of λ in the characteristic equation of the variational matrix of e 6 as follow λ 5 c 1 λ 4 c 2 λ 3 c 3 λ 2 c 4 λ c 5 0 proof the detailed proof can be found in appendix 4 3 global stability we devote this subsection for the global asymptotic stability of the ideal equilibrium e 3 by using the second lyapunov method see kuznetsov 1998 theorem 4 6 if the following conditions are satisfied 4 1 k e 1 a 1 α 1 d 1 j α 1 d 1 a k e 2 a 2 α 2 d 2 j α 2 d 2 a then the predator free equilibrium point e 3 is globally asymptotically stable in r 5 proof we first construct a lyapunov function v v n 1 n 2 p a p 1 j p 2 j as follow v k e 1 α 1 d 1 j α 1 n 1 k 1 ln n 1 k k e 2 α 2 d 2 j α 2 n 2 k 1 ln n 2 k p a α 1 d 1 j α 1 p 1 j α 2 d 2 j α 2 p 2 j it is easy to check that v 0 for all n 1 0 n 2 0 p a 0 p 1 j 0 p 2 j 0 and v 0 if and only if n 1 n 2 k p a p 1 j p 2 j 0 taking the derivative of v function we get v e 1 α 1 n 1 k d 1 j α 1 n 1 n 1 e 2 α 2 n 2 k d 2 j α 2 n 2 n 2 p a α 1 d 1 j α 1 p 1 j α 2 d 2 j α 2 p 2 j e 1 α 1 n 1 k 2 d 1 j α 1 k e 2 α 2 n 2 k 2 d 2 j α 2 k k e 1 a 1 α 1 d 1 j α 1 d 1 a μ 2 m p a μ k e 2 a 2 α 2 d 2 j α 2 d 2 a p a μ μ 2 m p a obviously when conditions 4 1 hold then v 0 and v 0 if and only if n 1 n 2 k p a p 1 j p 2 j 0 or k e 1 a 1 α 1 d 1 j α 1 d 1 a k e 2 a 2 α 2 d 2 j α 2 d 2 a while that the set u n 1 n 2 p a p 1 j p 2 j n 1 k n 2 k has only one invariant subset u k k 0 0 0 using the second lyapunov method and lasalle s invariance principle see in kuznetsov 1998 we obtain that e 3 k k 0 0 0 is globally asymptotically stable hence this theorem is proved remark 4 1 from the conditions 4 1 in theorem 4 6 we can easily see that no dispersal parameters appeared such as μ 1 or μ 2 it means that there is a case where the dispersion factor or the monsoon factor does not affect the global condition of the ideal equilibrium e 3 on the other hand in all parameters of these conditions the maximum carrying capacity k corresponds to the field area factor in practice is the object that people can most easily control and modify rewriting these conditions we obtain the condition of k for the global stability of e 3 as follow k min d 1 a d 1 j α 1 e 1 a 1 α 1 d 2 a d 2 j α 2 e 2 a 2 α 2 remark 4 2 we re write the conditions 4 1 in the following way 4 2 k e 1 a 1 α 1 d 1 a d 1 j α 1 k e 2 a 2 α 2 d 2 a d 2 j α 2 we call g i k e i a i α i and d i d i a d i j α i are the growth and death function of bph in field i and i 1 2 respectively if g 1 d 1 and g 2 d 2 then the global stability condition of e 3 is satisfied this condition means that when the energy that bph eat from rice or the growth rate of bph is lower than the mortality rate in both fields the bph will die and disappear as an inevitable consequence then the rice will have enough conditions to grow to its maximum capacity 4 4 hopf bifurcation in this subsection we present and prove the hopf bifurcation result of the model 3 3 at the equilibrium e 4 taking the maximum carrying capacity k as bifurcation parameter we choose k because the reason was mentioned in remark 4 1 according to theorem 4 3 we consider the characteristic equation of e 4 has a form a 0 λ λ d 2 j α 2 λ 3 a 1 λ 2 a 2 λ a 3 0 with the bifurcation parameter k we define f k a 1 k a 2 k a 3 k theorem 4 7 if these exists k k such that a 2 k 0 a 3 k 0 f k 0 f k 0 then the model exhibits hopf bifurcation at k k or these is a limit cycle around the equilibrium e 4 proof when a 0 0 then the characteristic equation can reduce to 4 3 λ 3 a 1 λ 2 a 2 λ a 3 0 we can obtain a critical value k k such that a 2 k 0 a 3 k 0 and f k 0 now we will verify the hopf bifurcation condition f k 0 substituting λ u i v into eq 4 3 we get u 3 3 u v 2 3 u 2 v v 3 i a 1 u 2 2 u v i v 2 a 2 u i v a 3 0 separating real and imaginary parts we have 4 4 u 3 3 u v 2 a 1 u 2 v 2 a 2 u a 3 0 4 5 3 u 2 v 2 2 a 1 u a 2 0 substituting the value of v 2 from 4 5 in 4 4 we get 8 u 3 8 a 1 u 2 2 a 1 2 a 2 u a 1 a 2 a 3 0 noticing that u k 0 differentiating with respect to k and putting k k we have d r e λ d k k k d u d k k k a 3 k a 1 a 2 k a 2 a 1 k 2 a 1 2 k a 3 k 0 since a 3 k a 1 a 2 k a 2 a 1 k or f k 0 and hence the theorem is proved remark 4 3 the results of theorem 4 7 are also true and can be applied to other parameters as bifurcation parameter in the model such as m 0 m 1 and m moreover due to the equilibrium e 5 is the symmetrical case of e 4 so the hopf bifurcation result for e 5 is also obtained by applying similar arguments of e 4 5 numerical simulation in this section we preview numerical simulations to illustrate the theoretical results in previous sections 5 1 the model stability we take the parameter values in parameter sets 5 1 5 2 and 5 3 some parameter values are referenced from research information about bph population parameters in win et al 2011 such as transform rate of juvenile or death rate of bph for the parameter set 5 1 the model 3 3 has a global stable equilibrium point e 3 20 20 0 0 0 in fig 3 5 1 r 1 0 1 r 2 0 08 k 20 a 1 0 15 a 2 0 1 α 1 0 37 α 2 0 38 d 1 a 0 18 d 2 a 0 15 d 1 j 0 07 d 2 j 0 08 e 1 0 067 e 2 0 068 m 0 0 3 m 1 0 1 m 0 2 when we slight increase maximum capacity of rice k and intake rate a 1 a 2 with the parameter set 5 2 the model changes its behavior and we get a local stable equilibrium point e 6 28 0482 5 8286 0 5729 0 1875 0 0609 in fig 4 at this time the bph population begins to grow but the number is still low the rice now could not grow to the maximum capacity moreover the monsoon blows the mature bph from field 1 to field 2 so the rice in field 2 grows worse than the other n 2 n 1 5 2 r 1 0 1 r 2 0 08 k 50 a 1 0 2 a 2 0 2 α 1 0 37 α 2 0 38 d 1 a 0 18 d 2 a 0 15 d 1 j 0 07 d 2 j 0 08 e 1 0 067 e 2 0 068 m 0 0 3 m 1 0 1 m 0 2 taking k 80 and set intake rate of bph of field 1 a 1 much greater than field 2 a 2 in the parameter set 5 3 we obtain the stability behavior of equilibrium point e 5 0 46 6816 0 5409 0 0 2299 in fig 5 when the damage level of bph in field 1 calculated by intake rate is greater the rice here still grows in the early period but this growth does not last and eventually the rice is destroyed it also leads to the disappearance of the bph juvenile in this field 5 3 r 1 0 1 r 2 0 08 k 80 a 1 0 5 a 2 0 1 α 1 0 37 α 2 0 38 d 1 a 0 18 d 2 a 0 15 d 1 j 0 07 d 2 j 0 08 e 1 0 067 e 2 0 068 m 0 0 3 m 1 0 1 m 0 2 in contrast to e 5 for the parameter set 5 4 we get the stability case of e 4 23 9679 0 3 1453 1 1344 0 in fig 6 in the parameter set we choose the intake rate of bph in field 2 a 2 greater than field 1 a 1 increase the growth rate of rice in field 1 and the reproduction rate of mature bph e 1 e 2 to make bph populations easier to grow under the effect of monsoon to prevent the mature from spreading from field 2 to field 1 combined with the harmful level of bph in field 2 increase the rice n 2 cannot grow even in the early period and is quickly destroyed the monsoon seems to have accelerated the disappearance of rice in field 2 5 4 r 1 0 2 r 2 0 08 k 50 a 1 0 1 a 2 0 4 α 1 0 37 α 2 0 38 d 1 a 0 1 d 2 a 0 15 d 1 j 0 07 d 2 j 0 08 e 1 0 2 e 2 0 2 m 0 0 3 m 1 0 1 m 0 2 for the parameter sets 5 2 5 3 and 5 4 the model 3 3 is only local stable at equilibrium points however if we fix the parameter values and vary the initial values then the numerical simulations show that the stability of the model does not change in fig 7 a when we change initial conditions of n 1 and p a there is only one equilibrium point e 4 similarly in case of equilibrium points e 5 in fig 7 b and e 6 in fig 7 c we also simulate with some parameter sets and obtain the same results in figs 8 and 9 it means that the global stable conditions of the equilibrium points e 4 e 5 e 6 can be the same as their local stable conditions 5 2 the effect of the carrying capacity factor taking the parameter set 5 1 if we change the values of k the equilibrium point at which the model is stable will change as shown in fig 10 a first the model is stable at equilibrium point e 3 as k increases the model becomes stable at e 6 and finally at e 4 when the capacity value k or the area of the field is small the rice can quickly reach the maximum capacity thereby overwhelming the growth of the bph population and not allowing it to survive e 3 however the rice no longer has a fast enough growth rate when only the field area increases it is a condition for the bph population to reproduce and maintain on the rice plant e 6 the continuous expansion of the field area the survival of bph combined with the influence of the monsoon eventually leads to the loss of rice in field 2 e 4 we also perform a simulation with different parameters set and give the same result as shown in fig 10 b the question is when bph has completely damaged a field how will the field area affect the rice growth in the remaining field we evaluate the effect of the carrying capacity the field area on the stability of the model through the hopf bifurcation of parameter k in the case of equilibrium point e 4 taking the parameter set 5 4 with the bifurcation parameter k we calculate the critical value k 2486 7502 the model is stable at e 4 when k k in fig 11 and unstable when k k in fig 12 for k k the model 3 3 undergoes a hopf bifurcation at this equilibrium point we have simulated the model with 100 000 time steps while k varies from 1800 to 4000 and get the maximum and minimum population density variables fig 13 shows the hopf bifurcation diagram of rice field 1 n 1 and mature bph p a respect to k it is obvious that if k exceeds the critical value k then the behavior of n 1 and p a changes from stable focus to unstable and it oscillates between the two branches of maximum and minimum values it means that when the field area is expanded the instability in the environment also increases leading to the bph rice system no longer maintaining stability from the parameter set 5 4 we decrease the growth rate of rice in field 1 and obtain a new parameter set with this set and using theorem 4 7 we find that there is no satisfactory critical value k when we increase k from 50 to 2000 the model s behavior is showed in fig 14 and the stability at e 4 is maintained although the maximum capacity increases significantly the rice density achieved and the growth of bph in field 1 varies little this may be due to the influence of other factors such as the slow growth of rice or the continuous attack of hoppers that inhibited the rice growth from increasing linearly compared to the area of the field therefore farming on large plots of land will be effective and suitable if we choose short term high yielding rice varieties it is completely consistent with reality in addition an advantage in expanding farming is that the growth and damage of bph do not increase strongly when we ensure other parameters of bph are kept the same 5 3 the effect of the monsoon factor we evaluate the effect of the monsoon factor through the dispersal parameters taking the parameter set 5 4 we change m 0 from 0 3 to 1 the model maintains stability at point e 4 and the population densities are shown in fig 15 a there is not any critical value of m 0 satisfying theorem 4 7 so the hopf bifurcation does not occur with k fixed at 50 when we increase the monsoon force from field 1 to field 2 the rice in field 1 very quickly approaches the maximum capacity of the environment at the same time it makes the bph population in field 1 also close to 0 we also get the same result in fig 15 b when only m 0 varies from 0 1 to 1 in contrast if increasing m the rice yield in field 1 decreases significantly compared to the maximum capacity in fig 15 c the bph population are quite stable and no longer in sharp decline from that we can see that the increasing influence of monsoon blowing from field 1 to field 2 has promoted the growth capacity of paddy field 1 and suppressed the growth of bph in this field the effect of monsoon on the stability of the system is shown more clearly through the hopf bifurcation for the bifurcation parameter m 0 we have a bifurcation diagram in fig 16 a it is observed that e 4 is local stable when m 0 m 0 and becomes unstable when m 0 m 0 and model undergoes a hopf bifurcation around e 4 at the critical value m 0 is 0 2299 we also find another critical value m 0 is 0 0512 at which the model undergoes a hopf bifurcation from stable at e 4 if m 0 m 0 and unstable if m 0 m 0 furthermore fig 16 a shows that there is a value of m 0 through which the model transitions from stable around e 4 to a limited cycle around e 6 taking m 0 0 02 we have a time evolution diagram of model such as fig 17 the model tends to converge towards e 4 at first however after that it is attracted to the cycle limit around e 6 for the bifurcation parameter m 1 the bifurcation diagram is presented in fig 16 b the critical value m 1 is 0 1040 in the downward direction of m 1 passing through the value of m 1 the model changes from stable around e 4 to unstable for the bifurcation parameter m the bifurcation diagram is presented in fig 18 the critical value of m is 0 5175 through which the model changes from stable around e 4 with m 0 5175 to unstable with m 0 5175 those figures show the opposite effect on the stability of model at e 4 of the parameters m 0 and m 1 relative to m if the effect of monsoon is stronger or m 0 m 1 increase and m decrease there are more mature bph migrating to field 2 and the rice in this field is also quickly destroyed moreover the monsoon also limits the spread of bph back to field 1 thereby maintaining the stability of rice and native bph population in field 1 this is a reasonable description of ecological stability in the system as well 6 discussion and conclusion in this paper we studied the interaction between bph and rice considering monsoon as the major factor we constructed the proposed predator prey model on two time scales with stage structure in the bph population the considered environment is heterogeneous consisting of two rice fields and the growth of rice on each rice field is expressed by the logistic functional response there are two stages in the bph population the juvenile and the mature in which only mature bph can eat rice and fast disperse between two rice fields holling s type i functional response was used for the predation of bph the dispersal of bph from field 1 to field 2 occurs under the effect of the monsoon winds we take advantage of these time scales to reduce the dimension of the complete model and proceed to the analysis of the aggregated model the positivity and boundedness of all solutions were derived then we presented the formulas of six equilibrium corresponding to the significant situations of the behavior model and their stability analysis from theorem 4 6 we found a case with sufficient conditions for the global stability of the ideal equilibrium e 3 where no dispersal parameters appear it means that we could eliminate bph and achieve maximum capacity rice growth by fulfilling the necessary conditions of field area and natural mortality of bph see remarks 4 1 and 4 2 moreover this could help farmers avoid frequent rice field visits because they do not have to worry about the bph dispersion and the influence of the monsoon in addition the effect of maximum carrying capacity k and dispersal parameters m 0 m 1 and m were explained as k increases the equilibrium point the system is stable at also changes from the ideal equilibrium e 3 to e 6 and back to e 4 the field area is expanded the rice cannot overwhelm the reproduction of bph especially for rice with a slow growth rate the attack of bph may lead to the complete destruction of rice in one field this expansion also helps increase rice production but that increase may not be much for long term rice varieties see fig 14 for the bifurcation case of k the model remains stable until k exceeds a critical value then it becomes unstable and the bifurcation is visible see fig 13 when we expand the field area the instability in the environment also increases therefore the bph rice system cannot maintain its stability the presence of the monsoon factor is represented through dispersal parameters particularly m 0 and m 1 according to hopf bifurcation diagram in the case equilibrium e 4 see figs 16 and 18 we can observe the opposite influence of m 0 m 1 versus m when the monsoon effect becomes stronger m 0 and m 1 increase more mature bph are blown to field 2 the rice in field 1 has better growing conditions thus the stability of e 4 is retained on the contrary when m increases the dispersion direction from field 2 to field 1 may prevail hence the amount of foreign bph on field 1 also increases leading to the disturbance in the bph population on this field and the model at equilibrium e 4 becomes unstable to summarize the effects of the monsoon factor in the bph and rice system are significant for the model s stability we provided a comprehensive analysis of the interaction between bph and rice fields as well as evaluated the monsoon effect thus our proposed model improves on the previous research in thuy et al 2019 in fact the bph infestation in rice fields is influenced by many factors such as temperature and humidity moreover pesticides are a significant factor that impacts the bph rice interaction therefore further research can be conducted by adding these factors to our proposed model finally our research results may give helpful information for preventing and managing bph in rice fields credit authorship contribution statement anh duc nguyen methodology writing review editing software visualization validation dung ngoc do writing original draft formal analysis visualization hung duc nguyen writing original draft formal analysis thuy phuong nguyen supervision conceptualization methodology writing review editing validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is funded by hanoi university of science and technology hust vietnam under grant number t2020 pc 305 we would like to thank hust for financial support we also thank the anonymous reviewers for their careful reading of our manuscript and their many insightful comments and suggestions appendix locally stability of co exist equilibrium in this appendix we show all the detailed proof of theorem 4 5 the jacobian matrix of model 3 3 at e 6 is given j e 6 as follows j 11 0 a 1 n 1 μ 2 2 μ 1 2 μ 2 p a 0 0 0 j 22 a 2 n 2 1 μ 2 2 μ 1 2 μ 2 p a 0 0 0 0 j 33 α 1 α 2 j 41 0 e 1 a 1 n 1 μ 2 2 μ 1 2 μ 2 p a d 1 j α 1 0 0 j 52 e 2 a 2 n 2 1 μ 2 2 μ 1 2 μ 2 p a 0 d 2 j α 2 where j 11 r 1 a 1 μ 1 μ 1 2 μ 2 p a j 22 r 2 a 2 μ 1 2 μ 2 p a μ 1 p a j 33 d 1 a μ 2 2 μ 1 2 μ 2 p a d 2 a 1 μ 2 2 μ 1 2 μ 2 p a j 41 e 1 a 1 μ 1 2 μ 2 p a μ 1 j 52 e 2 a 2 p a μ 1 μ 1 2 μ 2 p a set d 1 d 1 j α 1 d 2 d 2 j α 2 and p μ 1 2 μ 2 p a by using dodgson method see armend 2012 we have j e 6 λ i 1 t t 1 t 2 t 3 t 4 1 t t 1 t 4 t 2 t 3 where t j 22 λ a 2 n 2 1 μ 2 2 p 0 0 j 33 λ α 1 0 e 1 a 1 n 1 μ 2 2 p d 1 λ j 22 λ j 33 λ d 1 λ e 1 a 1 α 1 n 1 μ 2 2 p t 1 j 11 λ 0 a 1 n 1 μ 2 2 p 0 0 j 22 λ a 2 n 2 1 μ 2 2 p 0 0 0 j 33 λ α 1 e 1 a 1 p μ 1 0 e 1 a 1 n 1 m 2 p d 1 λ j 11 λ t e 1 a 1 2 α 1 n 1 p μ 1 j 22 λ μ 2 2 p t 2 0 a 1 n 1 μ 2 2 p 0 0 j 22 λ a 2 n 2 1 μ 2 2 p 0 0 0 j 33 λ α 1 α 2 0 e 1 a 1 n 1 μ 2 2 p d 1 λ 0 j 22 λ a 1 n 1 μ 2 2 p d 1 λ α 2 t 3 0 j 22 λ a 2 n 2 1 μ 2 2 p 0 0 0 j 33 λ α 1 e 1 a 1 p μ 1 0 e 1 a 1 n 1 μ 2 2 p d 1 λ 0 e 2 a 2 p a μ 1 p e 2 a 2 n 2 1 μ 2 2 p 0 e 1 a 1 α 1 p μ 1 e 2 a 2 n 2 1 μ 2 2 p j 22 λ t 4 j 22 λ a 2 n 2 1 μ 2 2 p 0 0 0 j 33 λ α 1 α 2 0 e 1 a 1 n 1 μ 2 2 p d 1 λ 0 e 2 a 2 p a μ 1 p e 2 a 2 n 2 1 μ 2 2 p 0 d 2 λ d 2 λ t e 2 a 2 α 2 n 2 1 μ 2 2 p j 22 λ d 1 λ by some calculations we get that j e λ i λ j 11 λ j 22 λ d 1 λ d 2 λ j 33 λ j 11 λ j 22 λ d 2 e 1 a 1 α 1 n 1 μ 2 2 p λ j 11 λ j 22 λ d 1 e 2 a 2 α 2 n 2 1 μ 2 2 p λ j 22 λ d 2 e 1 a 1 2 α 1 n 1 p μ 1 μ 2 2 p λ j 11 λ d 1 e 2 a 2 2 α 2 n 2 p a μ 1 p 1 μ 2 2 p λ 5 c 1 λ 4 c 2 λ 3 c 3 λ 2 c 4 λ c 5 where c 1 j 11 j 22 d 1 d 2 j 33 c 2 j 11 j 22 d 1 d 2 j 11 d 1 j 22 d 2 j 11 d 2 j 22 d 1 j 33 j 11 j 33 j 22 j 33 d 1 j 33 d 2 e 1 a 1 α 1 n 1 μ 2 2 p e 2 a 2 α 2 n 2 1 μ 2 2 p c 3 d 1 d 2 j 11 d 1 d 2 j 22 j 11 j 22 d 1 j 11 j 22 d 2 j 33 j 11 j 22 j 33 j 11 d 1 j 33 j 11 d 2 j 33 j 22 d 1 j 33 j 22 d 2 j 33 d 1 d 2 j 11 j 22 d 2 e 1 a 1 α 1 n 1 μ 2 2 p j 11 j 22 d 1 e 2 a 2 α 2 n 2 1 μ 2 2 p e 1 a 1 2 α 1 n 1 p μ 1 μ 2 2 p e 2 a 2 2 α 2 n 2 p a μ 1 p 1 μ 2 2 p c 4 j 11 j 22 d 1 d 2 j 33 d 1 d 2 j 11 j 22 j 33 j 11 j 22 d 1 d 2 e 1 a 1 α 1 n 1 μ 2 2 p d 2 j 11 d 2 j 22 j 11 j 22 e 2 a 2 α 2 n 2 1 μ 2 2 p d 1 j 11 d 1 j 22 j 11 j 22 j 22 d 2 e 1 a 1 2 α 1 n 1 p μ 1 μ 2 2 p j 11 d 1 e 2 a 2 2 α 2 n 2 p a μ 1 p 1 μ 2 2 p c 5 j 11 j 22 d 1 d 2 j 33 j 11 j 22 d 2 e 1 a 1 α 1 n 1 μ 2 2 p j 11 j 22 d 1 e 2 a 2 α 2 n 2 1 μ 2 2 p j 22 d 2 e 1 a 1 2 α 1 n 1 p μ 1 μ 2 2 p j 11 d 1 e 2 a 2 2 α 2 n 2 p a μ 1 p 1 μ 2 2 p by using routh hurwitz criterion necessary and sufficient conditions for locally asymptotically stable of e 6 is i c i 0 i 1 2 3 4 5 ii c 1 c 2 c 3 iii c 1 c 2 c 3 c 3 2 c 1 2 c 4 c 1 c 5 0 iv c 3 c 4 c 2 c 5 c 1 c 2 c 3 c 1 c 4 c 5 2 hence theorem 4 5 is proved 
24452,in this paper we studied the brown planthopper bph infestation on rice under the effects of monsoon using a two time scales stage structured predator prey model we divided the bph population into two distinct stages mature and juvenile owing to the significant biological differences between the two we considered a heterogeneous environment composed of two adjacent rice fields using the two time scales we reduced the model into an aggregated model with smaller dimensions and topological equivalent the positivity and boundedness of the model s solution were established we conducted the dynamical analysis of the bph rice ecosystem through the local and global stability of the model s equilibria moreover the effects of rice fields area and monsoon were analyzed using hopf bifurcation theory we performed numerical simulations to illustrate the theoretical results finally we provided some emergence discussions from the ecological perspective to give useful information for preventing and managing bph on rice keywords brown planthopper monsoon factor predator prey model aggregated method stability analysis hopf bifurcation 1 introduction in recent decades science and technology have revolutionized agriculture throughout the world the applications of mathematical biology models to simulate the relationships in agriculture have achieved remarkable attention especially in the predator prey ecology drechsler and settele 2001 maiti et al 2008 mondal et al 2019 rafikov and silveira 2014 sarkar et al 2018 it also contributes to simulation and testing of insect pest control methods maiti et al 2006 saha and samanta 2020 rice is a major staple and economically important crop for southeast asian countries therefore preventing diseases and pest infestations in rice is of significant importance brown planthopper bph is the most dangerous pest that infects rice by causing an outbreak of hopper burn when the density of bph per unit area grows exponentially and bphs spread over the entire area the question arises as to how to control bph s growth and the interactions with rice for this reason the bph and rice system has been a focus of both experimental and theoretical research as a predator prey ecology using different approaches such as equation based model ebm khor and chua 1986 thuy et al 2019 vattikuti et al 2019 agent based model abm linh et al 2016 nguyen et al 2011 and machine learning lakmal et al 2019 thakur et al 2020 nguyen et al 2011 analyzed the effects of weather on the growth and invasion of bph at various locations and times using real data into an agent based system in linh et al 2016 linh et al used abm to simulate the effects of natural enemies on the growth and dispersal of bph in rice fields however building the abm requires a huge amount of real data and high computer processing power therefore ebm still attracts many experts to choose as a research direction although it is less intuitive than abm khor and chua 1986 developed a mathematical model using ebm based ordinary differential equations odes to simulate the growth of bph divided into five age periods however their model did not study the impact of bph infestation in rice fields in 2019 vattikuti et al 2019 built linear and non linear models to describe growth rates of bph life stages as a function of temperature and gave estimates of bioclimatic thresholds under effects of temperature thuy et al 2019 proposed an odes model with the stage structured and the rapid dispersion of bph across two rice fields this model was elementary because it assumed the dispersion is proportional to the population density with the ratio remaining constant in this paper we use ebm to construct a predator prey model to investigate the effect of the monsoon on the relationship between bph and rice the stage structure hypothesis is used in the bph population with two stages juvenile and mature only mature bph extracts nutrition from rice and spreads across fields stage structured predator prey has also gained the attention of researchers because dynamics incorporating stage structure presume more intricate population dynamics than those without these factors jia et al 2017 kaushik and banerjee 2021 we simulated a heterogeneous environment consisting of two fields having the same maximum carrying capacities of rice and the dispersal of mature bph served as the connection between them in practice the dispersion usually happens in a much faster than the growth of bph leading to two different time scales a fast scale for the dispersal and a slow scale for the natural growth and predation on each local field in mchich et al 2007 nguyen ngoc et al 2012 and thuy et al 2019 these authors also studied the fast dispersion of a predator prey model in a two patch environment moreover southeast asian countries are located mainly in the humid tropical belt where the effect of monsoons is evident and prominent the monsoon winds often blow strongly in one direction along with the behavior of bph is dispersed and diffuses depending on the wind thus we consider the dispersion direction of mature bph from the first to the second field during monsoon the effect of wind on many aspects of brown planthopper dispersal has been studied in nguyen et al 2011 the authors simulated dispersal with wind factors in different seasons the time for long winged mature bph to follow the wind direction and spread to other plots is from 5 to 7 days in huynh et al 2021 the rules for two wind directions southwest and northeast were used in eight cases to find out the appropriate light trap location in the wind direction the rest of this paper is organized as follows in section 2 the mathematical model with ecological assumptions and the meaning of parameters are described section 3 derives the positivity and boundedness of solutions and presents the reduced model after using the aggregation method in section 4 the stability analysis of the equilibrium points and hopf bifurcation is established section 5 is devoted to illustrating some numerical simulations of our theoretical results concerning some crucial parameters finally we give some discussions and the biological significance of our analytical findings in section 6 2 model formulation let n i donate population density of rice p i j and p i a donate the population density of the juvenile and the mature bph in field i in which i 1 2 for rice we consider that the rice population density increases in the absence of bph followed by the logistic law with r i are the intrinsic growth rate of rice in field i and k is the carrying capacity of both fields functional response is the intake rate of the predator as a function of food prey density following c s holling it is generally classified into three types which are called holling s type i ii and iii see dawes and souza 2013 type i functional response assumes a linear increase in intake rate with prey density the linear increase assumes that the time needed by the predator to hunt the prey is negligible or that consuming food does not interfere with searching for prey this is entirely consistent with the rice and bph system where bph often appears later and almost does not take time to find food therefore we select holling type i functional response for the bph rice relationship with an intake predation rate a i in the field i for bph we assume both juvenile and mature have a natural amount of death represented by the mortality rate d i j of the juvenile stage and d i a of the mature stage in the field i since only the mature can eat and reproduce there is a conversion rate e i from the amount of energy eaten for reproduction in the field i on the contrary the juvenile can grow to mature so we consider that after the accumulation period the juvenile bph is transformed to mature with the constant rate α i in field i about the fast dispersal of the mature bph we assume the dispersion under the impact of the monsoon and depend on the population density in the starting field furthermore by the one direction property of monsoon so there is a particular direction assume that it is from field 1 to field 2 in which the effect of monsoon is represented by a first order function of the mature bph density in field 1 with two parameters m 0 and m 1 the remaining dispersal direction has a dispersion rate m the parameter ɛ represents the ratio between two time scales multiplied into expressions of the slow process fig 1 gives a visualization of the bph rice system we study from the above assumptions we formulate a mathematical model for the bph rice system as follows 2 1 d n 1 d τ ɛ r 1 n 1 1 n 1 k a 1 n 1 p 1 a d n 2 d τ ɛ r 2 n 2 1 n 2 k a 2 n 2 p 2 a d p 1 a d τ ɛ d 1 a p 1 a α 1 p 1 j m p 2 a m 0 m 1 p 1 a p 1 a d p 2 a d τ ɛ d 2 a p 2 a α 2 p 2 j m 0 m 1 p 1 a p 1 a m p 2 a d p 1 j d τ ɛ d 1 j p 1 j α 1 p 1 j e 1 a 1 n 1 p 1 a d p 2 j d τ ɛ d 2 j p 2 j α 2 p 2 j e 2 a 2 n 2 p 2 a where τ and t is the fast and slow time scale with t ɛ τ the complete model subjects to the initial conditions n i 0 0 p i a 0 0 p i j 0 0 i 1 2 we call this system the complete model to distinguish it from the aggregated model in section 3 the definition brief of variables and parameters in the model are shown in table 1 3 positivity boundedness and aggregated model in this section we concentrate on analyzing the positivity and boundedness of the complete model after that it is devoted to the construction of the aggregated model 3 1 positivity and boundedness theorem 3 1 all the solutions of the complete model which start in r 6 are always positive and bounded proof we begin by proving the positive properties of the solution let the right hand equations of model 2 1 are f i n 1 n 2 p 1 a p 2 a p 1 j p 2 j i 1 6 define the non negative cone k x n 1 n 2 p 1 a p 2 a p 1 j p 2 j r 6 x 0 obviously n 1 0 n 2 0 p 1 a 0 p 2 a 0 p 1 j 0 p 2 j 0 k furthermore if n 1 0 n 2 0 p 1 a 0 p 2 a 0 p 1 j 0 p 2 j 0 we have f 1 0 n 2 p 1 a p 2 a p 1 j p 2 j 0 0 f 2 n 1 0 p 1 a p 2 a p 1 j p 2 j 0 0 f 3 n 1 n 2 0 p 2 a p 1 j p 2 j ɛ α 1 p 1 j m p 2 a 0 f 4 n 1 n 2 p 1 a 0 p 1 j p 2 j ɛ α 2 p 2 j m 0 m 1 p 1 a p 1 a 0 f 5 n 1 n 2 p 1 a p 2 a 0 p 2 j ɛ e 1 a 1 n 1 p 1 a 0 f 6 n 1 n 2 p 1 a p 2 a p 1 j 0 ɛ e 2 a 2 n 2 p 2 a 0 therefore by using theorem in efendiev and eberl 2007 we obtain n 1 t n 2 t p 1 a t p 2 a t p 1 j t p 2 j t k with t ɛ τ and t r thus the solutions remain in the r 6 now we prove the bounded properties from the first two equations of model 2 1 by using the non negative of the state variables we obtain d n 1 d τ ɛ r 1 n 1 1 n 1 k d n 2 d τ ɛ r 2 n 2 1 n 2 k then using the standard results for ordinary differential inequalities we have lim t sup n 1 t k lim t sup n 2 t k n 1 k n 2 k with t ɛ τ let s t e 1 n 1 t e 2 n 2 t p 1 a t p 2 a t p 1 j t p 2 j t along the equations of model 2 1 we get d s d t e 1 r 1 n 1 1 n 1 k e 2 r 2 n 2 1 n 2 k d 1 a p 1 a d 2 a p 2 a d 1 j p 1 j d 2 j p 2 j d s d t σ s e 1 r 1 n 1 1 n 1 k e 2 r 2 n 2 1 n 2 k d 1 a σ p 1 a d 2 a σ p 2 a d 1 j σ p 1 j d 2 j σ p 2 j σ e 1 n 1 e 2 n 2 choose σ min d 1 a d 2 a d 1 j d 2 j we have d s d t σ s e 1 r 1 n 1 1 n 1 k e 2 r 2 n 2 1 n 2 k σ e 1 n 1 e 2 n 2 e 1 r 1 e 2 r 2 e 1 σ e 2 σ k putting m e 1 r 1 e 2 r 2 e 1 σ e 2 σ k and using a lemma in differential equations inequalities birkhoff and rota 1978 we obtain 0 s t m σ s 0 e σ t when t we get 0 s t m σ hence all the solutions of the model 2 1 are bounded theorem 3 2 for any given initial value in r 6 the complete model 2 1 has a unique positive solution proof let the right hand equations of model 2 1 are f i n 1 n 2 p 1 a p 2 a p 1 j p 2 j i 1 6 the first partial derivatives of f i with respect to all variables are exist and bounded when n 1 n 2 p 1 a p 2 a p 1 j p 2 j are positive and bounded is easy checked thus there is a unique positive solution of 2 1 3 2 the aggregated model this subsection is devoted to the construction of the aggregated model because the complete model used two time scales we can apply the aggregated method see auger and rafae 2000 and auger et al 2000 to reduce the dimension of the model and obtain a less complex model the key of this method is to accentuate the variables in the slow time scale it is easily seen that the total density of mature bph in both fields is not affected by the fast dispersal and it fluctuates in a slow time scale when it only depends on the competition process between bph and rice for this we define p a p 1 a p 2 a the model 2 1 becomes 3 1 d p 1 a d τ m p a p 1 a m 0 m 1 p 1 a p 1 a ɛ d 1 a p 1 a α 1 p 1 j d p a d τ ɛ d 1 a p 1 a d 2 a p a p 1 a α 1 p 1 j α 2 p 2 j d n 1 d τ ɛ r 1 n 1 1 n 1 k a 1 n 1 p 1 a d n 2 d τ ɛ r 2 n 2 1 n 2 k a 2 n 2 p a p 1 a d p 1 j d τ ɛ d 1 j p 1 j α 1 p 1 j e 1 a 1 n 1 p 1 a d p 2 j d τ ɛ d 2 j p 2 j α 2 p 2 j e 2 a 2 n 2 p a p 1 a now system 3 1 has five slow time scale variables n 1 n 2 p a p 1 j p 2 j and a fast time scale variable p 1 a for ɛ 0 after some calculation we obtain representation of p 1 a depend on slow time scale variables 3 2 p 1 a μ 1 μ 1 2 μ 2 p a where μ 1 m 0 m 2 m 1 and μ 2 m m 1 coming back to the complete model 2 1 we substitute the representation 3 2 and add the variable of the total mature bph population density we get a aggregated model when using only one slow time scale t as follows 3 3 d n 1 d t n 1 r 1 1 n 1 k a 1 μ 1 μ 1 2 μ 2 p a d n 2 d t n 2 r 2 1 n 2 k a 2 μ 1 2 μ 2 p a μ 1 p a d p a d t d 1 a d 2 a μ 1 μ 1 2 μ 2 p a d 2 a p a α 1 p 1 j α 2 p 2 j d p 1 j d t d 1 j α 1 p 1 j e 1 a 1 n 1 μ 1 2 μ 2 p a μ 1 d p 2 j d t d 2 j α 2 p 2 j e 2 a 2 n 2 p a μ 1 μ 1 2 μ 2 p a remark 3 1 this aggregated model is an ɛ approximation of the restriction of the complete model to this invariant five dimensional set the restricted dynamic can be approximated by a taylor expansion with respect to the small parameter ɛ see mchich et al 2007 when ɛ is small enough and the aggregated model dynamic is structurally stable then the aggregated model dynamic provides a good alternative to the complete model trajectories behavior fig 2 shows the behavior of the rice densities in field 1 of both models with the same initial conditions and parameter values as ɛ changes and gets a small value it can be found the similarity in the value of the solution while the time scale goes on the infinitive from now we use the aggregated model 3 3 to study the behavior of the complete model 2 1 4 stability analysis 4 1 existence of equilibrium points in this subsection we study the existence of equilibrium of the aggregated model model 3 3 has the following equilibrium point the trivial equilibrium e 0 0 0 0 0 0 always exists corresponding to the case that rice and bph disappear together on both fields two equilibrium points e 1 k 0 0 0 0 and e 2 0 k 0 0 0 always exist corresponding to the case that bph disappear on both fields and rice grows to the maximum capacity on one field the bph free equilibrium e 3 k k 0 0 0 always exists corresponding to the case that only rice grows to the maximum capacity on both fields this is the ideal equilibrium point the equilibrium e 4 n 1 0 p a p 1 j 0 corresponds to the case that rice and the juvenile bph disappear on field 2 where n 1 k k a 1 r 1 μ 1 μ 1 2 μ 2 p a p 1 j e 1 a 1 n 1 d 1 j α 1 μ 1 2 μ 2 p a μ 1 p a μ 2 h 2 2 μ 1 d 2 a h 2 2 μ 1 h 1 d 2 a μ 2 h 1 2 with h 1 k e 1 a 1 2 α 1 r 1 d 1 j α 1 and h 2 k e 1 a 1 α 1 d 1 j α 1 d 1 a d 2 a the equilibrium e 5 0 n 2 p a 0 p 2 j corresponds to the case that rice and the juvenile bph disappear on field 1 where n 2 k k a 2 r 2 μ 1 2 μ 2 p a μ 1 p a p 2 j e 2 a 2 n 2 d 2 j α 2 p a μ 1 μ 1 2 μ 2 p a and p a p a is positive solution of the following equation d 1 a d 2 a μ 1 μ 1 2 μ 2 p a k e 2 a 2 α 2 d 2 j α 2 p a μ 1 μ 1 2 μ 2 p a d 2 a p a k e 2 a 2 2 α 2 r 2 d 2 j α 2 p a μ 1 μ 1 2 μ 2 p a 2 0 the equilibrium e 6 n 1 n 2 p a p 1 j p 2 j corresponds to the case that rice and the bph co exist on both fields where n 1 k k a 1 r 1 μ 1 μ 1 2 μ 2 p a n 2 k k a 2 r 2 μ 1 2 μ 2 p a μ 1 p a p 1 j e 1 a 1 n 1 d 1 j α 1 μ 1 2 μ 2 p a μ 1 p 2 j e 2 a 2 n 2 d 2 j α 2 p a μ 1 μ 1 2 μ 2 p a and p a p a is positive solution of the following equation d 1 a d 2 a μ 1 μ 1 2 μ 2 p a d 2 a p a k e 1 a 1 α 1 d 1 j α 1 μ 1 2 μ 2 p a μ 1 k e 1 a 1 2 α 1 r 1 d 1 j α 1 μ 1 μ 1 2 μ 2 p a 2 k e 2 a 2 α 2 d 2 j α 2 p a μ 1 μ 1 2 μ 2 p a k e 2 a 2 2 α 2 r 2 d 2 j α 2 p a μ 1 μ 1 2 μ 2 p a 2 0 4 2 local stability in this subsection we establish the local stability of all equilibrium points by using the first lyapunov method in combination with the routh hurwitz criterion see kuznetsov 1998 theorem 4 1 three equilibrium points on the axis e 0 e 1 e 2 are always unstable proof let us first prove the theorem for the equilibrium e 0 the jacobian matrix of model 3 3 at e 0 is given by j e 0 r 1 0 0 0 0 0 r 2 0 0 0 0 0 d α 1 α 2 0 0 0 d 1 a α 1 0 0 0 0 0 d 2 a α 2 where d d 1 a μ 2 2 μ 1 d 2 a 1 μ 2 2 μ 1 the characteristic equation of this jacobian matrix with the eigenvalue λ is r 1 λ r 2 λ d λ d 1 a α 1 λ d 2 a α 2 λ 0 it is easy to see that there is an eigenvalue λ r 1 0 thus using the first lyapunov method so e 0 is always unstable similar arguments apply to the case of equilibrium e 1 and e 2 hence theorem 4 1 is proved theorem 4 2 let the following inequalities hold d 1 a μ 2 2 μ 1 d 2 a 1 μ 2 2 μ 1 k e 1 a 1 α 1 d 1 j α 1 μ 2 2 μ 1 k e 2 a 2 α 2 d 2 j α 2 1 μ 2 2 μ 1 then the bph free equilibrium e 3 is locally asymptotically stable proof the jacobian matrix of model 3 3 at e 3 is given j e 3 r 1 0 k a 1 μ 2 2 μ 1 0 0 0 r 2 k a 2 1 μ 2 2 μ 1 0 0 0 0 d α 1 α 2 0 0 k e 1 a 1 μ 2 2 μ 1 d 1 0 0 0 k e 2 a 2 1 μ 2 2 μ 1 0 d 2 where d d 1 a μ 2 2 μ 1 d 2 a 1 μ 2 2 μ 1 d 1 d 1 j α 1 d 2 d 2 j α 2 f 1 k e 1 a 1 α 1 μ 2 2 μ 1 f 2 k e 2 a 2 α 2 1 μ 2 2 μ 1 the characteristic equation of this jacobian matrix is r 1 λ r 2 λ d λ d 1 λ d 2 λ f 1 d 2 λ f 2 d 1 λ 0 clearly r 1 0 and r 2 0 so this equation reduces to λ 3 s 1 λ 2 s 2 λ s 3 0 where s 1 d d 1 d 2 s 2 d d 1 d d 2 d 1 d 2 f 1 f 2 s 3 d d 1 d 2 f 1 d 2 f 2 d 1 because s 1 0 using routh hurwitz criterion necessary and sufficient conditions for locally asymptotically stable of e 3 is s 3 0 s 1 s 2 s 3 simplify the condition is only s 3 0 this is also the inequalities in theorem 4 2 hence this theorem is proved theorem 4 3 equilibrium e 4 is local asymptotically stable if a 0 0 a 3 0 and a 1 a 2 a 3 where a 0 a 1 a 2 a 3 are the coefficients of λ in the characteristic equation of the variational matrix of e 4 as follow a 0 λ λ d 2 j α 2 λ 3 a 1 λ 2 a 2 λ a 3 0 proof the jacobian matrix of model 3 3 at e 4 is given j e 4 j 11 0 a 1 n 1 μ 2 2 μ 1 2 μ 2 p a 0 0 0 j 22 0 0 0 0 0 j 33 α 1 α 2 j 41 0 e 1 a 1 n 1 μ 2 2 μ 1 2 μ 2 p a d 1 j α 1 0 0 j 52 0 0 d 2 j α 2 where j 11 r 1 a 1 μ 1 μ 1 2 μ 2 p a j 22 r 2 a 2 μ 1 2 μ 2 p a μ 1 p a j 33 d 1 a μ 2 2 μ 1 2 μ 2 p a d 2 a 1 μ 2 2 μ 1 2 μ 2 p a j 41 e 1 a 1 μ 1 2 μ 2 p a μ 1 j 52 e 2 a 2 p a μ 1 μ 1 2 μ 2 p a the characteristic equation of this jacobian matrix is j 22 λ d 2 j α 2 λ λ 3 a 1 λ 2 a 2 λ a 3 0 where a 1 j 11 j 33 d 1 j α 1 a 2 j 33 d 1 j α 1 e 1 a 1 α 1 n 1 μ 2 2 μ 1 2 μ 2 p a j 11 j 33 d 1 j α 1 a 3 j 11 j 33 d 1 j α 1 e 1 a 1 α 1 n 1 μ 2 j 11 2 μ 1 2 μ 2 p a e 1 a 1 2 α 1 n 1 μ 2 μ 1 2 μ 2 p a μ 1 2 μ 1 2 μ 2 p a clearly d 2 j α 2 0 a 1 0 and set a 0 j 22 by using routh hurwitz criterion necessary and sufficient conditions for locally asymptotically stable of e 4 is a 0 0 a 3 0 and a 1 a 2 a 3 hence theorem 4 3 is proved theorem 4 4 equilibrium e 5 is local asymptotically stable if b 0 0 b 3 0 and b 1 b 2 b 3 where b 0 b 1 b 2 b 3 are the coefficients of λ in the characteristic equation of the variational matrix of e 5 as follow b 0 λ λ d 1 j α 1 λ 3 b 1 λ 2 b 2 λ b 3 0 theorem 4 5 equilibrium e 6 is local asymptotically stable if i c i 0 i 1 2 3 4 5 ii c 1 c 2 c 3 iii c 1 c 2 c 3 c 3 2 c 1 2 c 4 c 1 c 5 0 iv c 3 c 4 c 2 c 5 c 1 c 2 c 3 c 1 c 4 c 5 2 where c 1 c 2 c 3 c 4 c 5 are the coefficients of λ in the characteristic equation of the variational matrix of e 6 as follow λ 5 c 1 λ 4 c 2 λ 3 c 3 λ 2 c 4 λ c 5 0 proof the detailed proof can be found in appendix 4 3 global stability we devote this subsection for the global asymptotic stability of the ideal equilibrium e 3 by using the second lyapunov method see kuznetsov 1998 theorem 4 6 if the following conditions are satisfied 4 1 k e 1 a 1 α 1 d 1 j α 1 d 1 a k e 2 a 2 α 2 d 2 j α 2 d 2 a then the predator free equilibrium point e 3 is globally asymptotically stable in r 5 proof we first construct a lyapunov function v v n 1 n 2 p a p 1 j p 2 j as follow v k e 1 α 1 d 1 j α 1 n 1 k 1 ln n 1 k k e 2 α 2 d 2 j α 2 n 2 k 1 ln n 2 k p a α 1 d 1 j α 1 p 1 j α 2 d 2 j α 2 p 2 j it is easy to check that v 0 for all n 1 0 n 2 0 p a 0 p 1 j 0 p 2 j 0 and v 0 if and only if n 1 n 2 k p a p 1 j p 2 j 0 taking the derivative of v function we get v e 1 α 1 n 1 k d 1 j α 1 n 1 n 1 e 2 α 2 n 2 k d 2 j α 2 n 2 n 2 p a α 1 d 1 j α 1 p 1 j α 2 d 2 j α 2 p 2 j e 1 α 1 n 1 k 2 d 1 j α 1 k e 2 α 2 n 2 k 2 d 2 j α 2 k k e 1 a 1 α 1 d 1 j α 1 d 1 a μ 2 m p a μ k e 2 a 2 α 2 d 2 j α 2 d 2 a p a μ μ 2 m p a obviously when conditions 4 1 hold then v 0 and v 0 if and only if n 1 n 2 k p a p 1 j p 2 j 0 or k e 1 a 1 α 1 d 1 j α 1 d 1 a k e 2 a 2 α 2 d 2 j α 2 d 2 a while that the set u n 1 n 2 p a p 1 j p 2 j n 1 k n 2 k has only one invariant subset u k k 0 0 0 using the second lyapunov method and lasalle s invariance principle see in kuznetsov 1998 we obtain that e 3 k k 0 0 0 is globally asymptotically stable hence this theorem is proved remark 4 1 from the conditions 4 1 in theorem 4 6 we can easily see that no dispersal parameters appeared such as μ 1 or μ 2 it means that there is a case where the dispersion factor or the monsoon factor does not affect the global condition of the ideal equilibrium e 3 on the other hand in all parameters of these conditions the maximum carrying capacity k corresponds to the field area factor in practice is the object that people can most easily control and modify rewriting these conditions we obtain the condition of k for the global stability of e 3 as follow k min d 1 a d 1 j α 1 e 1 a 1 α 1 d 2 a d 2 j α 2 e 2 a 2 α 2 remark 4 2 we re write the conditions 4 1 in the following way 4 2 k e 1 a 1 α 1 d 1 a d 1 j α 1 k e 2 a 2 α 2 d 2 a d 2 j α 2 we call g i k e i a i α i and d i d i a d i j α i are the growth and death function of bph in field i and i 1 2 respectively if g 1 d 1 and g 2 d 2 then the global stability condition of e 3 is satisfied this condition means that when the energy that bph eat from rice or the growth rate of bph is lower than the mortality rate in both fields the bph will die and disappear as an inevitable consequence then the rice will have enough conditions to grow to its maximum capacity 4 4 hopf bifurcation in this subsection we present and prove the hopf bifurcation result of the model 3 3 at the equilibrium e 4 taking the maximum carrying capacity k as bifurcation parameter we choose k because the reason was mentioned in remark 4 1 according to theorem 4 3 we consider the characteristic equation of e 4 has a form a 0 λ λ d 2 j α 2 λ 3 a 1 λ 2 a 2 λ a 3 0 with the bifurcation parameter k we define f k a 1 k a 2 k a 3 k theorem 4 7 if these exists k k such that a 2 k 0 a 3 k 0 f k 0 f k 0 then the model exhibits hopf bifurcation at k k or these is a limit cycle around the equilibrium e 4 proof when a 0 0 then the characteristic equation can reduce to 4 3 λ 3 a 1 λ 2 a 2 λ a 3 0 we can obtain a critical value k k such that a 2 k 0 a 3 k 0 and f k 0 now we will verify the hopf bifurcation condition f k 0 substituting λ u i v into eq 4 3 we get u 3 3 u v 2 3 u 2 v v 3 i a 1 u 2 2 u v i v 2 a 2 u i v a 3 0 separating real and imaginary parts we have 4 4 u 3 3 u v 2 a 1 u 2 v 2 a 2 u a 3 0 4 5 3 u 2 v 2 2 a 1 u a 2 0 substituting the value of v 2 from 4 5 in 4 4 we get 8 u 3 8 a 1 u 2 2 a 1 2 a 2 u a 1 a 2 a 3 0 noticing that u k 0 differentiating with respect to k and putting k k we have d r e λ d k k k d u d k k k a 3 k a 1 a 2 k a 2 a 1 k 2 a 1 2 k a 3 k 0 since a 3 k a 1 a 2 k a 2 a 1 k or f k 0 and hence the theorem is proved remark 4 3 the results of theorem 4 7 are also true and can be applied to other parameters as bifurcation parameter in the model such as m 0 m 1 and m moreover due to the equilibrium e 5 is the symmetrical case of e 4 so the hopf bifurcation result for e 5 is also obtained by applying similar arguments of e 4 5 numerical simulation in this section we preview numerical simulations to illustrate the theoretical results in previous sections 5 1 the model stability we take the parameter values in parameter sets 5 1 5 2 and 5 3 some parameter values are referenced from research information about bph population parameters in win et al 2011 such as transform rate of juvenile or death rate of bph for the parameter set 5 1 the model 3 3 has a global stable equilibrium point e 3 20 20 0 0 0 in fig 3 5 1 r 1 0 1 r 2 0 08 k 20 a 1 0 15 a 2 0 1 α 1 0 37 α 2 0 38 d 1 a 0 18 d 2 a 0 15 d 1 j 0 07 d 2 j 0 08 e 1 0 067 e 2 0 068 m 0 0 3 m 1 0 1 m 0 2 when we slight increase maximum capacity of rice k and intake rate a 1 a 2 with the parameter set 5 2 the model changes its behavior and we get a local stable equilibrium point e 6 28 0482 5 8286 0 5729 0 1875 0 0609 in fig 4 at this time the bph population begins to grow but the number is still low the rice now could not grow to the maximum capacity moreover the monsoon blows the mature bph from field 1 to field 2 so the rice in field 2 grows worse than the other n 2 n 1 5 2 r 1 0 1 r 2 0 08 k 50 a 1 0 2 a 2 0 2 α 1 0 37 α 2 0 38 d 1 a 0 18 d 2 a 0 15 d 1 j 0 07 d 2 j 0 08 e 1 0 067 e 2 0 068 m 0 0 3 m 1 0 1 m 0 2 taking k 80 and set intake rate of bph of field 1 a 1 much greater than field 2 a 2 in the parameter set 5 3 we obtain the stability behavior of equilibrium point e 5 0 46 6816 0 5409 0 0 2299 in fig 5 when the damage level of bph in field 1 calculated by intake rate is greater the rice here still grows in the early period but this growth does not last and eventually the rice is destroyed it also leads to the disappearance of the bph juvenile in this field 5 3 r 1 0 1 r 2 0 08 k 80 a 1 0 5 a 2 0 1 α 1 0 37 α 2 0 38 d 1 a 0 18 d 2 a 0 15 d 1 j 0 07 d 2 j 0 08 e 1 0 067 e 2 0 068 m 0 0 3 m 1 0 1 m 0 2 in contrast to e 5 for the parameter set 5 4 we get the stability case of e 4 23 9679 0 3 1453 1 1344 0 in fig 6 in the parameter set we choose the intake rate of bph in field 2 a 2 greater than field 1 a 1 increase the growth rate of rice in field 1 and the reproduction rate of mature bph e 1 e 2 to make bph populations easier to grow under the effect of monsoon to prevent the mature from spreading from field 2 to field 1 combined with the harmful level of bph in field 2 increase the rice n 2 cannot grow even in the early period and is quickly destroyed the monsoon seems to have accelerated the disappearance of rice in field 2 5 4 r 1 0 2 r 2 0 08 k 50 a 1 0 1 a 2 0 4 α 1 0 37 α 2 0 38 d 1 a 0 1 d 2 a 0 15 d 1 j 0 07 d 2 j 0 08 e 1 0 2 e 2 0 2 m 0 0 3 m 1 0 1 m 0 2 for the parameter sets 5 2 5 3 and 5 4 the model 3 3 is only local stable at equilibrium points however if we fix the parameter values and vary the initial values then the numerical simulations show that the stability of the model does not change in fig 7 a when we change initial conditions of n 1 and p a there is only one equilibrium point e 4 similarly in case of equilibrium points e 5 in fig 7 b and e 6 in fig 7 c we also simulate with some parameter sets and obtain the same results in figs 8 and 9 it means that the global stable conditions of the equilibrium points e 4 e 5 e 6 can be the same as their local stable conditions 5 2 the effect of the carrying capacity factor taking the parameter set 5 1 if we change the values of k the equilibrium point at which the model is stable will change as shown in fig 10 a first the model is stable at equilibrium point e 3 as k increases the model becomes stable at e 6 and finally at e 4 when the capacity value k or the area of the field is small the rice can quickly reach the maximum capacity thereby overwhelming the growth of the bph population and not allowing it to survive e 3 however the rice no longer has a fast enough growth rate when only the field area increases it is a condition for the bph population to reproduce and maintain on the rice plant e 6 the continuous expansion of the field area the survival of bph combined with the influence of the monsoon eventually leads to the loss of rice in field 2 e 4 we also perform a simulation with different parameters set and give the same result as shown in fig 10 b the question is when bph has completely damaged a field how will the field area affect the rice growth in the remaining field we evaluate the effect of the carrying capacity the field area on the stability of the model through the hopf bifurcation of parameter k in the case of equilibrium point e 4 taking the parameter set 5 4 with the bifurcation parameter k we calculate the critical value k 2486 7502 the model is stable at e 4 when k k in fig 11 and unstable when k k in fig 12 for k k the model 3 3 undergoes a hopf bifurcation at this equilibrium point we have simulated the model with 100 000 time steps while k varies from 1800 to 4000 and get the maximum and minimum population density variables fig 13 shows the hopf bifurcation diagram of rice field 1 n 1 and mature bph p a respect to k it is obvious that if k exceeds the critical value k then the behavior of n 1 and p a changes from stable focus to unstable and it oscillates between the two branches of maximum and minimum values it means that when the field area is expanded the instability in the environment also increases leading to the bph rice system no longer maintaining stability from the parameter set 5 4 we decrease the growth rate of rice in field 1 and obtain a new parameter set with this set and using theorem 4 7 we find that there is no satisfactory critical value k when we increase k from 50 to 2000 the model s behavior is showed in fig 14 and the stability at e 4 is maintained although the maximum capacity increases significantly the rice density achieved and the growth of bph in field 1 varies little this may be due to the influence of other factors such as the slow growth of rice or the continuous attack of hoppers that inhibited the rice growth from increasing linearly compared to the area of the field therefore farming on large plots of land will be effective and suitable if we choose short term high yielding rice varieties it is completely consistent with reality in addition an advantage in expanding farming is that the growth and damage of bph do not increase strongly when we ensure other parameters of bph are kept the same 5 3 the effect of the monsoon factor we evaluate the effect of the monsoon factor through the dispersal parameters taking the parameter set 5 4 we change m 0 from 0 3 to 1 the model maintains stability at point e 4 and the population densities are shown in fig 15 a there is not any critical value of m 0 satisfying theorem 4 7 so the hopf bifurcation does not occur with k fixed at 50 when we increase the monsoon force from field 1 to field 2 the rice in field 1 very quickly approaches the maximum capacity of the environment at the same time it makes the bph population in field 1 also close to 0 we also get the same result in fig 15 b when only m 0 varies from 0 1 to 1 in contrast if increasing m the rice yield in field 1 decreases significantly compared to the maximum capacity in fig 15 c the bph population are quite stable and no longer in sharp decline from that we can see that the increasing influence of monsoon blowing from field 1 to field 2 has promoted the growth capacity of paddy field 1 and suppressed the growth of bph in this field the effect of monsoon on the stability of the system is shown more clearly through the hopf bifurcation for the bifurcation parameter m 0 we have a bifurcation diagram in fig 16 a it is observed that e 4 is local stable when m 0 m 0 and becomes unstable when m 0 m 0 and model undergoes a hopf bifurcation around e 4 at the critical value m 0 is 0 2299 we also find another critical value m 0 is 0 0512 at which the model undergoes a hopf bifurcation from stable at e 4 if m 0 m 0 and unstable if m 0 m 0 furthermore fig 16 a shows that there is a value of m 0 through which the model transitions from stable around e 4 to a limited cycle around e 6 taking m 0 0 02 we have a time evolution diagram of model such as fig 17 the model tends to converge towards e 4 at first however after that it is attracted to the cycle limit around e 6 for the bifurcation parameter m 1 the bifurcation diagram is presented in fig 16 b the critical value m 1 is 0 1040 in the downward direction of m 1 passing through the value of m 1 the model changes from stable around e 4 to unstable for the bifurcation parameter m the bifurcation diagram is presented in fig 18 the critical value of m is 0 5175 through which the model changes from stable around e 4 with m 0 5175 to unstable with m 0 5175 those figures show the opposite effect on the stability of model at e 4 of the parameters m 0 and m 1 relative to m if the effect of monsoon is stronger or m 0 m 1 increase and m decrease there are more mature bph migrating to field 2 and the rice in this field is also quickly destroyed moreover the monsoon also limits the spread of bph back to field 1 thereby maintaining the stability of rice and native bph population in field 1 this is a reasonable description of ecological stability in the system as well 6 discussion and conclusion in this paper we studied the interaction between bph and rice considering monsoon as the major factor we constructed the proposed predator prey model on two time scales with stage structure in the bph population the considered environment is heterogeneous consisting of two rice fields and the growth of rice on each rice field is expressed by the logistic functional response there are two stages in the bph population the juvenile and the mature in which only mature bph can eat rice and fast disperse between two rice fields holling s type i functional response was used for the predation of bph the dispersal of bph from field 1 to field 2 occurs under the effect of the monsoon winds we take advantage of these time scales to reduce the dimension of the complete model and proceed to the analysis of the aggregated model the positivity and boundedness of all solutions were derived then we presented the formulas of six equilibrium corresponding to the significant situations of the behavior model and their stability analysis from theorem 4 6 we found a case with sufficient conditions for the global stability of the ideal equilibrium e 3 where no dispersal parameters appear it means that we could eliminate bph and achieve maximum capacity rice growth by fulfilling the necessary conditions of field area and natural mortality of bph see remarks 4 1 and 4 2 moreover this could help farmers avoid frequent rice field visits because they do not have to worry about the bph dispersion and the influence of the monsoon in addition the effect of maximum carrying capacity k and dispersal parameters m 0 m 1 and m were explained as k increases the equilibrium point the system is stable at also changes from the ideal equilibrium e 3 to e 6 and back to e 4 the field area is expanded the rice cannot overwhelm the reproduction of bph especially for rice with a slow growth rate the attack of bph may lead to the complete destruction of rice in one field this expansion also helps increase rice production but that increase may not be much for long term rice varieties see fig 14 for the bifurcation case of k the model remains stable until k exceeds a critical value then it becomes unstable and the bifurcation is visible see fig 13 when we expand the field area the instability in the environment also increases therefore the bph rice system cannot maintain its stability the presence of the monsoon factor is represented through dispersal parameters particularly m 0 and m 1 according to hopf bifurcation diagram in the case equilibrium e 4 see figs 16 and 18 we can observe the opposite influence of m 0 m 1 versus m when the monsoon effect becomes stronger m 0 and m 1 increase more mature bph are blown to field 2 the rice in field 1 has better growing conditions thus the stability of e 4 is retained on the contrary when m increases the dispersion direction from field 2 to field 1 may prevail hence the amount of foreign bph on field 1 also increases leading to the disturbance in the bph population on this field and the model at equilibrium e 4 becomes unstable to summarize the effects of the monsoon factor in the bph and rice system are significant for the model s stability we provided a comprehensive analysis of the interaction between bph and rice fields as well as evaluated the monsoon effect thus our proposed model improves on the previous research in thuy et al 2019 in fact the bph infestation in rice fields is influenced by many factors such as temperature and humidity moreover pesticides are a significant factor that impacts the bph rice interaction therefore further research can be conducted by adding these factors to our proposed model finally our research results may give helpful information for preventing and managing bph in rice fields credit authorship contribution statement anh duc nguyen methodology writing review editing software visualization validation dung ngoc do writing original draft formal analysis visualization hung duc nguyen writing original draft formal analysis thuy phuong nguyen supervision conceptualization methodology writing review editing validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is funded by hanoi university of science and technology hust vietnam under grant number t2020 pc 305 we would like to thank hust for financial support we also thank the anonymous reviewers for their careful reading of our manuscript and their many insightful comments and suggestions appendix locally stability of co exist equilibrium in this appendix we show all the detailed proof of theorem 4 5 the jacobian matrix of model 3 3 at e 6 is given j e 6 as follows j 11 0 a 1 n 1 μ 2 2 μ 1 2 μ 2 p a 0 0 0 j 22 a 2 n 2 1 μ 2 2 μ 1 2 μ 2 p a 0 0 0 0 j 33 α 1 α 2 j 41 0 e 1 a 1 n 1 μ 2 2 μ 1 2 μ 2 p a d 1 j α 1 0 0 j 52 e 2 a 2 n 2 1 μ 2 2 μ 1 2 μ 2 p a 0 d 2 j α 2 where j 11 r 1 a 1 μ 1 μ 1 2 μ 2 p a j 22 r 2 a 2 μ 1 2 μ 2 p a μ 1 p a j 33 d 1 a μ 2 2 μ 1 2 μ 2 p a d 2 a 1 μ 2 2 μ 1 2 μ 2 p a j 41 e 1 a 1 μ 1 2 μ 2 p a μ 1 j 52 e 2 a 2 p a μ 1 μ 1 2 μ 2 p a set d 1 d 1 j α 1 d 2 d 2 j α 2 and p μ 1 2 μ 2 p a by using dodgson method see armend 2012 we have j e 6 λ i 1 t t 1 t 2 t 3 t 4 1 t t 1 t 4 t 2 t 3 where t j 22 λ a 2 n 2 1 μ 2 2 p 0 0 j 33 λ α 1 0 e 1 a 1 n 1 μ 2 2 p d 1 λ j 22 λ j 33 λ d 1 λ e 1 a 1 α 1 n 1 μ 2 2 p t 1 j 11 λ 0 a 1 n 1 μ 2 2 p 0 0 j 22 λ a 2 n 2 1 μ 2 2 p 0 0 0 j 33 λ α 1 e 1 a 1 p μ 1 0 e 1 a 1 n 1 m 2 p d 1 λ j 11 λ t e 1 a 1 2 α 1 n 1 p μ 1 j 22 λ μ 2 2 p t 2 0 a 1 n 1 μ 2 2 p 0 0 j 22 λ a 2 n 2 1 μ 2 2 p 0 0 0 j 33 λ α 1 α 2 0 e 1 a 1 n 1 μ 2 2 p d 1 λ 0 j 22 λ a 1 n 1 μ 2 2 p d 1 λ α 2 t 3 0 j 22 λ a 2 n 2 1 μ 2 2 p 0 0 0 j 33 λ α 1 e 1 a 1 p μ 1 0 e 1 a 1 n 1 μ 2 2 p d 1 λ 0 e 2 a 2 p a μ 1 p e 2 a 2 n 2 1 μ 2 2 p 0 e 1 a 1 α 1 p μ 1 e 2 a 2 n 2 1 μ 2 2 p j 22 λ t 4 j 22 λ a 2 n 2 1 μ 2 2 p 0 0 0 j 33 λ α 1 α 2 0 e 1 a 1 n 1 μ 2 2 p d 1 λ 0 e 2 a 2 p a μ 1 p e 2 a 2 n 2 1 μ 2 2 p 0 d 2 λ d 2 λ t e 2 a 2 α 2 n 2 1 μ 2 2 p j 22 λ d 1 λ by some calculations we get that j e λ i λ j 11 λ j 22 λ d 1 λ d 2 λ j 33 λ j 11 λ j 22 λ d 2 e 1 a 1 α 1 n 1 μ 2 2 p λ j 11 λ j 22 λ d 1 e 2 a 2 α 2 n 2 1 μ 2 2 p λ j 22 λ d 2 e 1 a 1 2 α 1 n 1 p μ 1 μ 2 2 p λ j 11 λ d 1 e 2 a 2 2 α 2 n 2 p a μ 1 p 1 μ 2 2 p λ 5 c 1 λ 4 c 2 λ 3 c 3 λ 2 c 4 λ c 5 where c 1 j 11 j 22 d 1 d 2 j 33 c 2 j 11 j 22 d 1 d 2 j 11 d 1 j 22 d 2 j 11 d 2 j 22 d 1 j 33 j 11 j 33 j 22 j 33 d 1 j 33 d 2 e 1 a 1 α 1 n 1 μ 2 2 p e 2 a 2 α 2 n 2 1 μ 2 2 p c 3 d 1 d 2 j 11 d 1 d 2 j 22 j 11 j 22 d 1 j 11 j 22 d 2 j 33 j 11 j 22 j 33 j 11 d 1 j 33 j 11 d 2 j 33 j 22 d 1 j 33 j 22 d 2 j 33 d 1 d 2 j 11 j 22 d 2 e 1 a 1 α 1 n 1 μ 2 2 p j 11 j 22 d 1 e 2 a 2 α 2 n 2 1 μ 2 2 p e 1 a 1 2 α 1 n 1 p μ 1 μ 2 2 p e 2 a 2 2 α 2 n 2 p a μ 1 p 1 μ 2 2 p c 4 j 11 j 22 d 1 d 2 j 33 d 1 d 2 j 11 j 22 j 33 j 11 j 22 d 1 d 2 e 1 a 1 α 1 n 1 μ 2 2 p d 2 j 11 d 2 j 22 j 11 j 22 e 2 a 2 α 2 n 2 1 μ 2 2 p d 1 j 11 d 1 j 22 j 11 j 22 j 22 d 2 e 1 a 1 2 α 1 n 1 p μ 1 μ 2 2 p j 11 d 1 e 2 a 2 2 α 2 n 2 p a μ 1 p 1 μ 2 2 p c 5 j 11 j 22 d 1 d 2 j 33 j 11 j 22 d 2 e 1 a 1 α 1 n 1 μ 2 2 p j 11 j 22 d 1 e 2 a 2 α 2 n 2 1 μ 2 2 p j 22 d 2 e 1 a 1 2 α 1 n 1 p μ 1 μ 2 2 p j 11 d 1 e 2 a 2 2 α 2 n 2 p a μ 1 p 1 μ 2 2 p by using routh hurwitz criterion necessary and sufficient conditions for locally asymptotically stable of e 6 is i c i 0 i 1 2 3 4 5 ii c 1 c 2 c 3 iii c 1 c 2 c 3 c 3 2 c 1 2 c 4 c 1 c 5 0 iv c 3 c 4 c 2 c 5 c 1 c 2 c 3 c 1 c 4 c 5 2 hence theorem 4 5 is proved 
24453,community based natural resource management cbnrm has the potential to conserve resources while simultaneously empowering traditionally marginalized communities because classical equation based modeling methods fail to capture the complexity of cbnrm agent based modeling abm has emerged as a useful method for modeling these systems in this paper we begin with a careful evaluation and sensitivity analysis of an existing abm of community forest management that incorporates cheating and enforcement which we call the cheating and enforcement model our results reveal several emergent behaviors of the model that are paradoxical or inconsistent with real world expectations we then introduce the monitoring and sanctioning model which makes several modifications to the cheating and enforcement mechanisms of the original abm analyzing this new model we see that it does not exhibit several of the more unusual behaviors of the original model and reveals surprising consistency with real world cbnrm systems finally we discuss some limitations of this new model and potential areas of further improvement keywords tragedy of the commons common pool resources evaludation of agent based models sensitivity analysis social ecological systems endogenous institutions 1 introduction since the 1980s community based natural resource management cbnrm has become widely accepted as an effective method of resource conservation both in the literature and on the ground dressler et al 2010 unfortunately while cbnrm offers a promising solution to resource depletion the very nature of cbnrm makes it difficult to implement on a large scale this management strategy focuses on enabling individual communities to form regulations that are compatible with their community and ecosystem since each community and ecosystem is unique a system that is successful in one community may be ineffective elsewhere therefore while there have been many case studies of cbnrm e g ostrom 1990 sudtongkong and webb 2008 there is limited consensus on the general traits that make a community management system successful cox et al 2010 similarly cbnrm applies to social ecological systems that involve interactions within human communities and between humans and the natural environment social ecological systems are complex and often non linear systems that are difficult to describe using classical equation based modeling hence while statistical analyses including logistic regression chi squared tests for independence and qualitative comparative analysis have helped identify patterns in community management success e g chhatre and agrawal 2008 gibson et al 2005 nath 2018 persha et al 2011 van laerhoven 2010 it is difficult to determine specific factors that influence the success or failure of a cbnrm system and to describe the precise mechanisms of influence agent based modeling abm offers an alternative method of exploring and understanding cbnrm systems from deangelis and grimm 2014 agent based modeling is a population and community modeling approach that allows for a high degree of complexity of individuals and of interactions among individuals individual based models simulate populations or systems of populations as being composed of discrete individual organisms by modeling individual agents who follow probabilistic rules abms allow for heterogeneous populations stochastic interactions and complex non linear systems exactly the traits of cbnrm systems that make them difficult to model while some abms of cbnrm have been used to suggest specific management policies for individual communities e g campo et al 2009 castella et al 2005 dumrongrojwatthana et al 2011 zellner et al 2012 most works to date have applied abms to study the general dynamics underlying community management systems e g agrawal et al 2013 bravo 2011 vallino 2014 understanding these dynamics may help to identify key ecological and social factors that tip a cbnrm system toward success or failure while these models offer insight into cbnrm this remains an emerging field and many of the models contain unjustified assumptions and have not been carefully analyzed in this article we conduct an in depth analysis of a model of cbnrm that we call the cheating and enforcement model c e model this model is described in vallino 2014 and is an extension of a model of cbnrm first introduced in bravo 2011 our analysis reveals several emergent behaviors of the model that are paradoxical or inconsistent with real world expectations we then explore the precise mechanisms that produce these unexpected behaviors and introduce a new model with modifications to the enforcement mechanism in the c e model which we call the monitoring and sanctioning model m s model we begin in section 2 with a brief introduction to community based natural resource management and current methods for modeling these systems in section 3 we give a complete description of the three agent based models of community forest management that we discuss in this paper the endogenous institution bravo 2011 cheating and enforcement vallino 2014 and monitoring and sanctioning models our description follows the odd overview design concepts details protocol in section 4 we briefly explore typical outcomes of the endogenous institution model and in section 5 we conduct a thorough analysis of the cheating and enforcement model to learn how the model parameters impact large scale behaviors during this process we identify key implementation errors in the model code discover several unexpected emergent behaviors and identify the specific mechanisms that explain these emergent behaviors one key finding is that the enforcement mechanism in this model which removes agents that violate community rules overwhelms the importance of the rules in section 6 we discuss how the results of the previous section informed our development of the monitoring and sanctioning model that modifies the cheating and enforcement mechanisms of the c e model we then conduct a sensitivity analysis of this new model and analyze the emergent behaviors in the m s model we see a strong positive correlation between the strictness of the community rules and conservation of the resource as predicted by the cbnrm literature in fact our results suggest that the formation of endogenous institutions can have a greater impact on model resource conservation than the environmental attitudes of the agents in the model additionally in contrast to the c e model in simulations of communities with similar rules we see increased monitoring and sanctioning improve resource conservation thus the new model appears to independently confirm insights from the cbnrm literature that were not explicitly used to develop the model finally in section 7 we discuss some limitations of this work and suggest areas for potential improvement and further exploration 2 background common pool resources cprs are resources with finite limits that are utilized by several independent users if there are no regulations to manage a cpr selfish use of the resource frequently leads to resource depletion often called a tragedy of the commons hardin 1968 common methods to prevent resource depletion include government regulations or privatization however these methods often do not consider local context or lead to inequitable resource access ostrom 1990 community based natural resource management cbnrm is an alternative method of resource conservation that allows cpr users to determine how to manage the resource case studies have shown that communities can successfully employ cbnrm and in some cases cbnrm actually proves more successful than government led regulations ostrom 1990 sudtongkong and webb 2008 nevertheless cbnrm is not always effective dressler et al 2010 elinor ostrom s seminal work in 1990 established eight design principles for cbnrm success in 2010 cox conducted a large literature review of empirical case studies and confirmed the importance of ostrom s principles for cbnrm systems around the world cox et al 2010 statistical analyses of datasets containing cbnrm case studies have also confirmed many of ostrom s principles such as the importance of local monitoring and enforcement of community resource management rules chhatre and agrawal 2008 gibson et al 2005 and illuminated other factors that may influence cbnrm success such as resource size dependence on the resource for commercial livelihood leadership organization and social capital nath 2018 persha et al 2011 van laerhoven 2010 while the statistical analyses mentioned above have provided valuable insight into the factors that affect cbnrm success they are limited by the small sample size of case studies relative to the large number of explanatory variables one particularly promising means for overcoming this limitation is the use of agent based models abms as defined in the introduction agent based modeling is a population and community modeling approach that allows for a high degree of complexity of individuals and of interactions among individuals individual based models simulate populations or systems of populations as being composed of discrete individual organisms deangelis and grimm 2014 in contrast to traditional modeling approaches that focus solely on replicating the macro level behavior of a system abms are constructed based on micro scale interactions thus they are particularly well suited for realistic representation of complex social ecological systems schlüter et al 2019 abms allow one to simulate experiments that are impractical to conduct e g studying cpr health over centuries or contain variables that would be difficult to control e g deadman et al 2000 schill et al 2016 these simulations often reveal emergent behaviors of the system collective behaviors and patterns that appear often through unobvious means from the accumulation of small interactions macaulay 2017 agent based modeling of community based natural resource management has the potential to deliver key insights into the functioning of community management systems for example abms have already been used to learn about the dynamics within communities implementing cbnrm agrawal et al 2013 ghorbani and bravo 2016 pérez and janssen 2015 and to suggest management policies for individual communities campo et al 2009 castella et al 2005 dumrongrojwatthana et al 2011 zellner et al 2012 they have also been used to study the role of institutions in managing common pool resources as well as how various ecological and social factors influence cbnrm success bravo 2011 deadman et al 2000 schill et al 2016 vallino 2014 however in order to draw robust conclusions from these models greater verification of model implementation and validation of model outputs is required at present few model outputs have been validated with real world observations and even fewer have been corroborated to determine whether outputs can successfully predict observations that were not used in model development there also have been few sensitivity analyses to determine how changes in parameters and differences in rule mechanisms influence emergent behaviors schulze et al 2017 recently there have been a number of works aimed at addressing these issues for instance arifin and madey 2015 makes the case for the importance of reproducible modeling and contains an overview of some of the recent methods developed for verifying validating and reproducing agent based models others have emphasized the need to analyze and improve existing models for example in thiele et al 2014 the authors argue that more effort should be directed toward analyzing existing models for robustness and making appropriate modifications to these models rather than toward new model development still others have undertaken the task of replicating and testing existing agent based models and developing standards for model replication donkin et al 2017 zhang and robinson 2021 with these considerations in mind in section 5 we apply augusiak et al s method of abm evaludation augusiak et al 2014 a comprehensive outline for evaluating and validating abms to the agent based model of vallino 2014 we then use the results of this analysis to inform the development of our own modified monitoring and sanctioning model which we analyze in section 6 3 model descriptions with the odd protocol in this work we discuss three different models of community based natural resource management the endogenous institution model ei model the cheating and enforcement model c e model and the monitoring and sanctioning model m s model the endogenous institution model bravo 2011 includes an endogenous institution i e a community management system which sets rules for how the community members may utilize the resource and assumes that all members always obey community rules in reality there are usually community members who violate the resource use rules thus the cheating and enforcement model of vallino 2014 builds on the endogenous institution model by introducing cheating and institutional methods to prevent cheating in section 5 we conduct a careful analysis of the c e model and discover several conceptual issues with the design of the model the outcome of this analysis informs our development of the monitoring and sanctioning model which includes mechanisms for cheating and enforcement that better represent actual community management systems although we develop the m s model based on the results of the next section for clarity we will describe both the c e model and the m s model together in this section as extensions of the ei model our description follows the odd overview design concepts details protocol grimm et al 2006 2010 2020 the ei model is described in bravo 2011 without using the odd protocol so we have adapted the description in that work the ei model is described in black text throughout the c e and m s models are extensions of the ei model and inherit all of its features thus unless stated otherwise black text can also be assumed to apply to these models we describe additional features unique to the c e model with additional features unique to the m s model with and additional features common to both the c e and m s models with all three of the models are implemented in netlogo see fig 2 below for a picture of the simulation environment and the code for each is available at https github com mayalapp cbnrm abm models and analysis 3 1 purpose and patterns the purpose of the endogenous institution model is to illustrate how endogenous institutions and individual beliefs about resource conservation can prevent resource depletion and increase individual payoffs in common pool resource management problems the model is expected to reproduce the following patterns observed in the empirical cpr literature that communities that are able to will form endogenous institutions that stronger institutions lead to greater resource conservation and individual payoffs and that communities that value resource conservation will form stronger institutions or or 3 2 entities state variables and scales the model is set in a forest environment which is structured as a toroidal 50 50 grid the model proceeds in discrete time steps called ticks and every 10 ticks of the simulation is called a period the model includes the following entities patches each of the 2500 grid cells in the simulation environment is a patch which represents a small patch of the forest the state variable trees of each patch represents the number of trees growing on that patch tables 5 and 6 loggers loggers are agents in the simulation that represent individuals in the community that exploit the resources of the environment by logging trees located on patches tables 7 and 8 institution there is a single institution entity which tracks the development of the community rules for forest management and updates the rules based on the beliefs of the loggers tables 9 and 10 observer there is a single observer entity which controls the simulation environment and the global variables tables 11 and 12 the rest of the state variables and parameters of the model are described in the tables indicated above in appendix as this is an abstract model of a common pool resource the forest area and the timescale of the simulation do not have a literal interpretation despite the use of forestry terminology e g forest loggers trees this model can be viewed as an abstract representation of any common pool resource 3 3 process overview and scheduling each simulation proceeds for a predefined number of ticks during each tick the following actions occur in the following order the order in which the patch and logger entities update their state variables is randomized on each tick 1 tree growth patches execute the tree growth submodel by growing trees based on the number of trees on the patch and on neighboring patches section 3 7 1 2 logger tick actions loggers execute the logger tick actions submodel in which they may log move as described under the log move and submodels in section 3 7 2 if a tick represents the end of a period then the following additional actions occur 3 compute satisfaction loggers execute the compute satisfaction submodel to determine whether they are satisfied based on their recent payoffs and adjust their views about how the forest should be logged accordingly section 3 7 3 4 institution change the institution entity executes the institution change submodel to determine whether there are enough unsatisfied loggers to meet the threshold for changing the institution and updates current institution accordingly section 3 7 4 5 observer updates the observer updates the model outputs section 3 7 5 6 replace logger the observer entity replaces one logger in the simulation section 3 7 6 7 logger updates loggers execute the logger updates submodel to reset certain state variables for the next period section 3 7 7 a diagram of the process overview and scheduling is depicted in fig 1 3 4 design concepts this section describes the models at a conceptual level using the 11 design concepts of the odd protocol 3 4 1 basic principles the basic principle of the endogenous institution model is that the formation of endogenous institutions in an open access resource environment can prevent a tragedy of the commons hardin 1968 in which rational agents acting in their own interests deplete the resource from bravo 2011 the core of the model is the formalization of the beliefs or mental models that agents hold regarding the desirable state of the resource and the best way to achieve it the model dynamics can give insight into the relationships between agent beliefs the institutions formed and resource conservation 3 4 2 emergence the most important outcomes of the endogenous institution model are the final institution the level of biomass the distribution of agent beliefs at equilibrium and agent payoffs these outcomes emerge from the initial distribution of logger beliefs and the decisions loggers make about whether to change the institution during the simulation 3 4 3 adaptation logger agent movement logging and cheating are all adaptive behaviors if loggers are on a patch that can legally be logged then they will log that patch at the end of each tick if they have not logged then loggers decide which patch to move to based on the number of trees on neighboring patches if there is any patch that can legally be logged then the logger will move randomly to one of these patches otherwise the logger will move randomly to any patch all of these actions are described in more detail in the description of the logger tick actions submodel in section 3 7 2 at the end of each period loggers decide whether to adjust their minimal cut which is the number of trees they believe should be on a patch before it is logged they adjust this based on their reference trees which reflects their beliefs about how much biomass should be in the forest as described in the compute satisfaction submodel in section 3 7 3 3 4 4 objective the loggers do not engage in any direct objective seeking behaviors though many logger behaviors are based on implicit predictions about what will lead to greater payoffs 3 4 5 learning at the end of each period in the replace logger submodel section 3 7 6 the logger with the lowest payoff in the previous period is replaced by a new logger that has the same reference trees payoff as the logger with the highest payoff in the previous round this indicates that the new loggers in the simulation have learned by imitating the most successful loggers in the simulation 3 4 6 prediction many logger agent behaviors are based on implicit predictions about what will lead to greater individual payoffs and increased biomass in the forest loggers adjust their minimal cut based on recent payoffs and the amount of biomass available as described in the compute satisfaction submodel in section 3 7 3 this reflects their implicit prediction that if current institution was set to their minimal cut this would lead to what they deem an acceptable level of biomass in the forest based on the static state variable reference trees 3 4 7 sensing logger agents are able to perfectly sense the number of trees of neighboring patches the current institution governing the rules of logging the total number of patches in the environment and the number of living patches those with trees 0 in the simulation environment the institution agent can sense the number of initial loggers as well as the number of unsatisfied loggers at the end of each period and the minimal cut of every logger in the simulation 3 4 8 interaction patches interact with neighboring patches through reseeding an empty patch is reseeded based on the number of neighboring patches that are living as described in the tree growth submodel in section 3 7 1 logger agents interact with patches by logging the trees of a patch this also represents a mediated interaction between loggers since trees logged by one logger are unavailable for other loggers loggers interact directly with one another by holding meetings when the number of unsatisfied loggers at the end of a period exceeds 2 3 initial loggers the loggers meet and current institution is set to the mean minimal cut of all loggers 3 4 9 stochasticity stochasticity is used in initialization to determine the location of loggers the number of trees on each patch and the value of reference trees for each logger as described in section 3 5 during the simulation the order in which loggers and patches update their traits is determined randomly at each tick stochasticity is also used in the following ways to represent the unpredictability and heterogeneity inherent in a social ecological system more details are given in the descriptions of the relevant submodels tree growth the probability that a non living patch will reseed is determined randomly based on the number of neighboring patches that are living logger tick actions when loggers move they move randomly to a neighboring patch that can be logged or if none is available randomly to any neighboring patch compute satisfaction when loggers experience a decreased payoff they become unsatisfied with a probability based on their old payoff and new payoff eq 2 when loggers become unsatisfied and raise or lower their minimal cut they do so by a randomly selected number of trees replace logger the new logger in the simulation is placed on a new patch at random 3 4 10 collectives the models do not include any collectives 3 4 11 observations as noted in the purposes and patterns the endogenous institution model is designed to illustrate how endogenous institutions and individual beliefs about resource conservation affect resource depletion and individual payoffs in order to observe these relationships the observer entity exports data at the end of each period when it executes the observer updates submodel this includes data about the institution current institution and data about logger beliefs mean minimal cut mean reference trees unsatisfied note that the mean reference trees can evolve throughout the simulation due to the replace logger submodel which accounts for new loggers adapting the traits of successful loggers in order to monitor resource conservation the outputs also include living patches the number of patches with trees 0 and biomass the total number of trees on all patches the model also exports the mean payoff of all of the loggers in the most recent period 3 5 initialization the initial state of the model can be varied as part of simulation experiments to assess the effects of different initial conditions at the start of each simulation the environment is initialized as a 50 50 grid and the observer or global parameters of the model from table 11 are set note that the global parameters include the number of logger agents in the simulation initial loggers the institution state variable current institution is set to 0 the number of trees on each patch is determined by randomly selecting an integer greater than or equal to 0 but less than b m a x 2 and then adding b m a x 2 1 to this number next each logger is placed on a random patch and the minimal cut payoff and old payoff for each logger is set to 0 each logger has payoff satisfaction set to 1 to indicate that all of the loggers are satisfied at the start of the simulation next the reference trees for each logger is set by drawing a random number from a normal distribution with mean reference threshold and standard deviation 0 25 this number represents the proportion of patches the logger believes should be living in the forest and this number is multiplied by the number of patches 2500 to determine each logger s reference trees 3 6 input data the model does not use input data to represent time varying processes 3 7 submodels this section contains a detailed description of each of the submodels in the ei c e and m s models 3 7 1 tree growth the forest grows throughout the simulation and all patches with t r e e s 0 are considered alive at each tick empty patches grow trees with probability 1 p g r o w t h p r o b n 1 9 where n is the number of adjacent or diagonally adjacent patches that are alive this represents trees propagating from adjacent patches to the empty patch when this occurs the value of t r e e s for that patch is set to 1 next all living patches with t r e e s b m a x increase trees by growth rate 3 7 2 logger tick actions at each tick loggers start by decreasing their payoff by cost this represents the cost of living next if the logger is on a patch with t r e e s minimal cut they will log the patch see the log submodel below if a logger is on a patch with t r e e s minimal cut then in the ei model the logger will move see the move submodel below fig 3 shows a diagram representing the actions loggers perform in the logger tick actions submodel with differences between the ei c e and m s models highlighted log to log a logger increases payoff by the value of trees for their current patch the trees for that patch is then set to zero i e the logger cuts down all of the trees on that patch move to move a logger will first determine if there are any patches in their neighborhood all patches within a 5 5 square centered at the location of the logger with t r e e s minimal cut if so they will randomly select one of these patches and move to that patch if there are no patches with t r e e s minimal cut within their neighborhood the logger will move to a random patch within their neighborhood 3 7 3 compute satisfaction in this submodel loggers determine whether they are satisfied with their payoff from the period and update their beliefs about the best way to log the forest if a logger experiences a decrease in their payoff between periods then they may become unsatisfied next if a logger has payoff old payoff then the logger s payoff satisfaction is set to 0 with probability 2 q old payoff p a y o f f p a y o f f old payoff the loggers that have just had payoff satisfaction set to 0 then adjust their minimal cut when a logger has living patches reference trees their minimal cut increases by x u 0 9 and when living patches reference trees their minimal cut decreases by x u 0 9 if there are fewer living patches in the forest than the logger believes is appropriate the logger attributes the decreased payoff to depletion of the forest and increases their minimal cut in contrast if there are more living patches in the forest than the logger believes is appropriate the logger attributes the decreased payoff to not logging enough and they decrease their minimal cut in the ei model payoff satisfaction is computed at the end of a period and is then used to determine which loggers update minimal cut and if the institution will change in the institution change submodel it is then reset to 1 for all loggers in the logger updates submodel see section 3 7 7 however in the c e and m s models payoff satisfaction is also used in the subsequent period to determine if a logger will cheat thus payoff satisfaction cannot be reset until the next period is complete this was the source of the error in the original coding of the c e model described in section 5 2 1 3 7 4 institution change the institution entity executes the institution change submodel to determine whether there are enough unsatisfied loggers to meet the threshold for changing the institution and updates current institution accordingly the value of current institution starts at 0 indicating that any living patch may be logged at the beginning of the simulation in this model loggers are considered unsatisfied if either payoff satisfaction 0 or 3 minimal cut current institution tolerance threshold as noted in the cheat submodel in section 3 7 2 the second condition accounts for loggers becoming dissatisfied when current institution deviates too much from their personal views on what patches should be available to log the unsatisfied state variable of the institution agent tracks the number of unsatisfied loggers in a simulation if at the end of a period 4 u n s a t i s f i e d 2 3 initial loggers then the loggers meet and the current institution is set to the mean minimal cut of all loggers since minimal cut is a logger s belief about how much biomass there should be on a patch before the patch can be logged the mean minimal cut of the community represents a compromise among community members regarding how much biomass should be present for a patch to be logged this mechanism implicitly gives all loggers equal weight in the decision making process note that current institution may increase or decrease and both are seen in simulations as a result of this process 3 7 5 observer updates as described in section 3 4 11 the observer exports data about logger beliefs payoffs and the state of the forest this includes current institution living patches biomass mean payoff of all loggers mean minimal cut of all loggers mean reference trees of all loggers unsatisfied and 3 7 6 replace logger the end of each period also allows for a selection process among the loggers the logger with the lowest payoff is replaced by a copy of the logger with the highest payoff the new logger now has the same reference trees payoff as the most successful logger the new logger is placed on a random patch and their minimal cut is set to zero this selection process can be interpreted as either imitation unsuccessful loggers adopting the behavior of successful loggers or a market mechanism unsuccessful loggers being replaced by new entrants into the market in the first interpretation there is no new logger but rather reference trees is a dynamic rather than static state variable for each logger 3 7 7 logger updates the payoff variables are reset for the next period every logger sets old payoff equal to the current value of payoff and then payoff is set to 0 ei only each logger has payoff satisfaction set to 1 4 model results and discussion endogenous institution model since the cheating and enforcement model is an extension of the endogneous institution model before we begin our analysis of the c e model in section 5 it will be useful to explore some of the typical outcomes of the ei model the endogenous institution model is analyzed in bravo 2011 in that work it is compared to an even simpler open access model of common pool resource management in which there is no communication among agents and hence no institution as expected simulations with this open access model almost always result in a tragedy of the commons in which the forest resource is all but eliminated in contrast in bravo 2011 the results of 50 simulations of the endogenous institution model under the base parameters described in section 5 3 are reported and on average 26 3 of the initial biomass remains at the end of the simulations while this is only about a quarter of the original biomass in the forest it indicates that the endogenous institution does prevent complete forest depletion in addition the average of the loggers minimal cut and reference trees do not decrease to zero indicating that loggers are still interested in forest preservation and have not all adopted a purely selfish strategy at the end of the simulation a replication of a single run of the endogenous institution model is shown in fig 4 in fig 4c we see that biomass declines initially but then increases and appears to reach an equilibrium at around 30 of the original biomass level this occurs around the same time as the change in current institution fig 4a which suggests that the institution is essential to halting biomass decline similar to the original results in bravo 2011 we find the average minimal cut and reference trees do not decrease to zero in this example run however as we discuss further in section 5 3 1 for all loggers minimal cut is near either 0 or b m a x we note at this point that in a stochastic agent based models it is often impossible to guarantee that a simulation has truly reached a steady state that is a point beyond which all of the parameters are guaranteed to vary only within a narrow range for example in the endogenous institution model we may observe a simulation where the biomass hovers around 30 of the original biomass level for several thousand ticks but there is always some non zero probability that in the next few ticks no empty patches will grow and all of the biomass will be removed nevertheless often in situations like this where a model appears qualitatively to have reached a steady state the parameters will not deviate much from their current values therefore in practice we can stop a simulation at this point and analyze the outcome of the simulation thus for convenience and following similar assumptions made in bravo 2011 and vallino 2014 in this paper we will refer to this pseudo steady state as the steady state of the model similarly we will call the percent of the initial biomass remaining at the end of a simulation final biomass b m f and the value of current institution at the end of a simulation final institution c i f 5 model results and discussion cheating and enforcement model as discussed previously many abms for community resource management have not been well validated before we introduce a new model of cheating in community management systems we first analyze the c e model as currently implemented to identify areas for improvement as mentioned earlier our methodology is inspired by augusiak et al s method of abm evaludation this is a five step cyclical process for continually revising and refining an abm to improve congruity between model emergent behaviors and reality the five steps are 1 conceptual model evaluation reviewing the conceptual decisions and assumptions behind abm rules to determine whether they accurately represent agent and environment behavior 2 model implementation verification reviewing model code to ensure all rules are implemented as they have been described 3 model output verification analyzing emergent behaviors and other model outputs to determine whether they follow real world expectations as well as assessing how much calibration was required to allow model outputs to successfully match these expectations 4 model analysis conducting sensitivity analysis and determining how emergent behaviors evolve through the simulation process to ensure a thorough understanding of model dynamics 5 model output corroboration comparing model outputs to patterns and data that were not used during model conception or were unknown prior to model conception this step checks to see if the model can independently corroborate new findings augusiak et al 2014 here we apply the evaludation process to the c e model to understand the precise mechanisms that explain the model s emergent behaviors we begin by analyzing the decisions and assumptions behind the c e model in section 5 1 step 1 and identifying some key errors in its implementation in section 5 2 step 2 because of the interconnectedness of steps 3 5 of the evaludation process we then present the results of these steps together in section 5 specifically we use our analysis to identify some of the noteworthy and paradoxical behaviors of the model steps 3 and 4 and discuss how each of these outputs compares to real world patterns in community management systems step 5 it is the analysis in this section that informs our development of the monitoring and sanctioning model which for convenience we described alongside the ei and c e models using the odd protocol in section 3 all netlogo models code to run simulations and code to reproduce figures and analysis can be found at https github com mayalapp cbnrm abm models and analysis 5 1 conceptual evaluation of the c e model in order to model the dynamics of a real world system agent based models often consist of dozens of rules and state variables the complexity of these systems ensures that almost any abm has an unlimited number of modifications one could make to try to improve the model this is especially true when the model is designed to represent complex human behaviors with this in mind in this section we propose three modifications to the rules of the c e model in order to better reflect the real world dynamics of a community management system 5 1 1 the enforcement mechanism in the c e model loggers who are caught cheating are removed from the model entirely this implies that cheaters are expelled from the community and cease to access the common pool resource however typically sanctions for cheating in a community management system include reprimands fines or in severe cases suspension of access to the common pool resource even when privileges are suspended the community cannot guarantee the logger will abide by the suspension in fact those ostracized from the community are likely to completely ignore cbnrm rules and log whenever they see fit thus to better represent community management systems it would make sense to implement graduated sanctions determining the punishment for cheaters based on the severity and or frequency of the violation ostrom 1990 an even more compelling reason for modifying this rule is that it completely overpowers many other c e model parameters for example as we show later in this section in almost all simulations of this model the biomass remaining at the end of the simulation is determined almost entirely by the number of loggers removed through the enforcement mechanism 5 1 2 logger movement in the c e model loggers only move at the end of each tick if they have not logged during that tick therefore if a logger logs on tick t then on tick t 1 they are inevitably located on an empty patch and cannot log there is no reason that a logger should wait to find a new patch of forest we can address this and simplify the rules by simply having every logger move at the end or the beginning of each tick 5 1 3 logger dissatisfaction we would expect a logger s payoff satisfaction to depend on their payoff satisfaction from the previous period for example if a logger is unsatisfied in period p because their payoff is decreasing and their payoff continues to decrease in period p 1 we would expect them to remain unsatisfied in the next period as currently implemented loggers whose payoff continues to decrease in period p 1 are only unsatisfied with probability q see eq 2 regardless of their previous payoff satisfaction 5 2 implementation verification of the c e model while attempting to understand some model behaviors we identified what we believe to be three coding errors in the implementation of the c e model code given in vallino 2018 the first two of these errors affect the cheating mechanism and as we explore later in this section lead to very different outcomes than if the model was coded as described in vallino 2014 we have corrected these two errors so the code matches the description of the c e model that we give in section 3 since they have such a dramatic impact on the outcomes of the model 5 2 1 not all loggers who should have cheated actually did cheat in the original description of the c e model it is stated that all unsatisfied loggers cheat but this is not how cheating was coded in the model loggers that are unsatisfied are loggers with payoff satisfactions 0 or minimal cut c u r r e n t institution tolerance threshold loggers with payoff satisfaction 0 did not cheat in the model as coded at the end of each period each logger s minimal cut and payoff satisfaction were updated according to the model rules however all loggers payoff satisfaction were subsequently reset to 1 before progressing to the next period thus when determining if a logger would cheat loggers that should have had payoff satisfaction 0 were not included and so did not cheat 5 2 2 some loggers who were caught cheating had not actually cheated as originally coded the model treated unsatisfied loggers as cheaters even if they were placed on an empty patch thus some loggers were caught and removed from the model despite the fact that they did not log any trees or violate the rules of the endogenous institution 5 2 3 there was no evolution of loggers in the description of the c e model from vallino 2014 at the end of each period when a logger is replaced there is a 1 chance that the new logger has a trait mutation this mutation is supposed to represent new entrants with innovative values we believe the intention was for the reference trees trait of the new logger to be chosen at random since this is the similar mutation described for the ei model in bravo 2011 however there is no mutation mechanism implemented in the netlogo version of the ei model from bravo 2011 or in the netlogo version of the c e model vallino 2018 we have opted not to include this mechanism in the model descriptions since it is not in the original netlogo version of the ei model or the c e model moreover it seems very unlikely that it would make much difference to the simulation outcomes since on average it would affect only one logger every 1000 ticks however we will discuss possible implications of some version of an evolutionary mechanism when analyzing the emergent behaviors of the c e and m s models 5 3 emergent behaviors in the c e model in this section we present the results of steps 3 5 of the evaludation process and describe emergent behaviors in the c e model and the mechanisms by which they evolve our approach to understanding these behaviors is to conduct a one factor at a time oat sensitivity analysis across a wide range of parameters this is done by varying one parameter at a time while holding all other parameters at base values we perform our simulations with the c e model after correcting the implementation errors mentioned above in sections 5 2 1 and 5 2 2 without these corrections the simulations do not reveal much since an institution fails to form in all but 2 5 of simulations this is primarily due to the error from section 5 2 2 which allows for loggers to cheat at the beginning of the simulation when current institution 0 as a result unsatisfied loggers are rapidly removed in the first few periods of each simulation and once 1 3 of the original loggers are removed it is impossible for an institution to ever form to facilitate comparison across the models we use the set of parameters tested in bravo 2011 for the endogenous institution model as our base values table 1 for the additional parameter of the c e model enforcement level we use 50 as the base value monitoring level 0 5 one parameter that we hold fixed throughout all simulations is tolerance threshold in bravo 2011 and vallino 2014 this parameter was allowed to be either low 1 3 b m a x or high 2 3 b m a x however we have observed that simulations with low tolerance threshold often fail to reach a steady state instead current institution and in response the amount of biomass changes constantly throughout the simulation this makes it difficult to discuss the final outcomes of these simulations thus we run all simulations with high tolerance threshold where this phenomenon does not occur we discuss the reasons for this difference in detail at the end of section 5 3 1 in vallino 2014 only a few different parameter sets were tested for the cheating and enforcement model moreover only the outcome of a single run of the model was reported for each parameter set as these abms are stochastic in our sensitivity analysis we run 50 simulations for each parameter set to generate a distribution of outcomes as we show a fixed choice of parameters can produce a great deal of variance in the final outcomes of the models in the works introducing these models simulations were run for 20 000 ticks to ensure the system had reached a steady state however in order to facilitate a large scale study across a broad range of parameters we reduce the computational time by letting each simulation run for only 2 000 ticks in almost all instances this appears sufficient to allow all of the variables of interest to reach an equilibrium exceptions to this such as when the number of initial loggers is very large are discussed later in this section below we discuss four emergent behaviors that we observe in simulations of the c e model the first two of these are not necessarily problematic but are consequences of the rules of the original endogenous institution model pertaining to the replacement mechanism and how loggers update minimal cut the latter two are paradoxical emergent behaviors that raise serious doubts about whether we can learn anything from this model as we will see these are consequences of the model s enforcement mechanism which is to entirely remove any loggers who are caught cheating from a simulation 5 3 1 minimal cut polarization as discussed for most parameter choices each simulation eventually reaches a steady state a point beyond which the state variables of interest vary only within a very narrow range this steady state leads to a phenomenon we call minimal cut polarization as an example consider the simulation depicted in fig 4 even though this is a simulation under the endogenous institution model i e there is no cheating it will be useful to illustrate our point since minimal cut polarization occurs in both the endogenous institution model and the c e model shortly after the last change of current institution in the 17th period the percentage of the initial biomass remaining appears to reach an equilibrium value around 30 living patches similarly appears to reach equilibrium around this point both values deviate only slightly even if the simulation is allowed to continue beyond what is shown in the figure analyzing the percent of biomass remaining at the end of each period from 200 through 2000 the mean of this value is 31 1 and the standard deviation is only 2 7 this suggests that biomass and living patches have reached an equilibrium in the endogenous institution model every logger logs the patch they are on if and only if trees current institution consequently if current institution biomass and living patches are in equilibrium the expected payoff of each logger is the same in each period inevitably then each logger will randomly experience periods with higher and lower payoffs and consequently will for some periods have payoff satisfaction 0 as this occurs if a logger has reference trees greater than the equilibrium value of living patches each time they have payoff satisfaction 0 they will continually raise their minimal cut until it reaches b m a x whereas if a logger has reference trees less than the equilibrium value of living patches they will lower their minimal cut until it reaches zero shown in fig 5 is the number of loggers with a high minimal cut over 9 10 b m a x or a low minimal cut less than 1 10 b m a x for the simulation depicted in fig 4 notice that after 30 periods almost every logger has a high or low minimal cut almost all loggers that are not polarized those with minimal cut that is neither high nor low are loggers that have entered the simulation through the selection mechanism within the last 30 periods this is because these loggers start with minimal cut 0 and if they have a high reference trees it takes time for their minimal cut to increase until it has reached a high minimal cut level in fig 5 loggers that have been around for more than 30 periods and that are not polarized are shown in light purple and account for at most 6 of all loggers in a given period the observed minimal cut polarization helps to explain why some simulations with tolerance threshold 1 3 b m a x fail to reach a steady state consider a simulation of the endogenous institution model with low tolerance threshold since current institution dictates logger behavior the simulation may appear to reach a steady state where current institution and biomass percentage remain constant for several periods due to minimal cut polarization each logger will have their minimal cut approach either 0 or b m a x now consider the following scenario that may evolve under these circumstances suppose that 0 current institution 1 3 b m a x and that eventually 2 3 of loggers have minimal cut near 0 then current institution will decrease until 0 current institution 1 3 b m a x as a result more biomass is removed and so the amount of biomass decreases thus the new equilibrium value of living patches falls below reference trees for many loggers therefore some of these loggers begin to increase minimal cut to b m a x since it must be that b m a x current institution 1 3 b m a x eventually 2 3 of loggers have minimal cut near b m a x thus current institution increases until b m a x current institution 1 3 b m a x then of course biomass and living patches will increase causing some loggers to begin lowering their minimal cut and starting the cycle over again just such a scenario is depicted in fig 6 we can see that current institution oscillates preventing the simulation from reaching a steady state the value of current institution and hence the biomass percentage is much more stable if tolerance threshold 2 3 b m a x since once current institution is in 1 3 b m a x 2 3 b m a x it is impossible for any logger to have minimal cut current institution tolerance threshold 5 3 2 eventually all loggers are identical as referenced when describing minimal cut polarization simulations of both the endogenous institution model and the c e model often reach a point where the current institution is in 1 3 b m a x 2 3 b m a x and the observer state variables are approximately constant at this point all loggers will decide whether to log or cheat based only on the current institution and their recent payoffs consequently minimal cut and reference trees no longer have any relation to logger payoffs therefore every logger is equally likely to be replaced or replicated at the end of each period without a mutation mechanism see section 5 2 3 this is essentially a moran process of neutral mutation moran 1958 if this process is allowed to continue eventually the reference trees of one logger will fixate so that every logger remaining in the simulation has the exact same value for reference trees as a result the mean reference trees at the end of the simulation must be interpreted carefully consider for example the outcome of the simulation of the endogenous institution model reported in vallino 2014 table 2 in which the final average reference trees for all loggers is 0 72 since initially each logger s reference trees is drawn at random from a normal distribution with mean 0 5 and standard deviation 0 25 it is practically certain that the initial average reference trees was less than 0 72 this implies that the average reference trees has increased through the simulation thus it is tempting to conclude that having a high reference trees that is being more environmentally minded confers a selective advantage but this is not the case the final reference trees in this simulation is essentially a randomly chosen value from the reference trees of the loggers at the beginning of the simulation once all the loggers have the same reference trees minimal cut polarization will cause all loggers minimal cut to tend toward the same value as well either 0 or b m a x and all loggers will have the same value of minimal cut and reference trees we note that it does generally take a long time for one logger to fixate in the model sometimes more than 10 000 periods in our simulations with base parameters however since this occurs when minimal cut and reference trees have ceased to be informative about whether loggers will log or cheat it is not necessary to run the model this long to observe other outputs reach an equilibrium e g current institution living patches and biomass 5 3 3 cheating increases final biomass the enforcement mechanism causes a number of paradoxical final outcomes for one the more loggers that cheat throughout a simulation the better the health of the forest measured in terms of b m f the final biomass in bravo 2011 the endogenous institution model which does not allow loggers to cheat was shown to retain an average of 26 3 of forest biomass we would expect introducing logger cheating to decrease b m f as cheating is detrimental to resource conservation instead we find that for the c e model the mean b m f under base parameters given in table 1 increases to 124 i e there are more trees at the end of the simulation than during simulation initialization the increase in final biomass is explained entirely by the removal of cheaters this can be observed by watching the trajectory of a single simulation with a high number of initial loggers in such a simulation biomass plummets immediately and the number of loggers begins to decline biomass remains near zero until the number of loggers reaches a low level and then biomass jumps back up to a well above the original forest biomass level even when we attempt to overwhelm the forest with 1000 loggers biomass eventually recovers if the simulation is allowed to run long enough so that nearly all loggers are removed from the model this is shown in fig 7 note that this is one of the instances in which the simulation must be run for much longer than 2000 ticks in order for the parameters to reach equilibrium this behavior does not follow empirical observations community management systems do not usually suspend the privileges of a majority of users and a depleted forest is unlikely to regenerate without substantial reforestation efforts 5 3 4 the enforcement mechanism makes the endogenous institution irrelevant the results of the sensitivity analysis show that the enforcement mechanism is so severe that it renders most of the other aspects of the model irrelevant as shown in fig 8 every simulation with m o n i t o r i n g l e v e l 0 ends with more biomass than was present at the start of the simulation i e b m f 100 gibson et al find that cbnrm with more monitoring and sanctioning generally have healthier forests gibson et al 2005 and these findings are supported throughout the cbnrm literature cox et al 2010 van laerhoven 2010 thus we would expect a relationship between the specific monitoring level and b m f while it appears this might be the case in fig 8 the significance of this relationship disappears when we condition on the percentage of loggers remaining in the simulation to investigate this more formally we construct a linear model of b m f as a function of loggers remaining the final value of current institution c i f and monitoring level for the simulations in which monitoring level 0 the results shown in table 2 suggest that neither monitoring level nor c i f significantly impact b m f in these simulations instead it is clear that the dominant factor in each simulation is the percentage of loggers remaining in fact there is almost perfect negative correlation between b m f and the percentage of loggers remaining at the end of a simulation ρ 0 993 6 model results and discussion monitoring and sanctioning model in section 5 we outlined the conceptual drawbacks of removing all cheaters from the cheating and enforcement model and identified implementation errors in the model code given these limitations in this section we explore a model with new mechanisms for cheating and enforcement that better represent actual community management systems this is the monitoring and sanctioning m s model that is described in section 3 the m s model inherits all of the entities rules and processes of the c e model but with the revised enforcement mechanisms described in section 3 7 2 notably this means that the m s model does not incorporate any of the modifications proposed in sections section 5 1 2 or 5 1 3 this allows us to directly assess the impact of the revised enforcement mechanism by comparing outcomes of the c e and m s models the errors discussed in sections 5 2 1 and 5 2 2 have been corrected for both models as described in the m s model we introduce a new dynamic logger state variable prob cheat p c which is the probability a logger will cheat if they are unsatisfied each logger starts with p c i n i t i a l p r o b c h e a t and this value is updated independently for each logger as the simulation progresses loggers that are unsatisfied must weigh the consequences of cheating versus not cheating to determine if they should follow institutionrules we assume the probability a logger will cheat depends on the logger s perception of both how likely they are to be caught and the repercussions if they are caught thus each time a logger cheats they update prob cheat according to eq 3 a specific example illustrating how loggers update their beliefs based on recent experience with cheating is given in example 6 1 example 6 1 consider a simulation of the m s model in which i n i t i a l p r o b c h e a t m o n i t o r i n g l e v e l s a n c t i o n l e v e l 1 2 suppose that logger a cheats twice and is caught the second time whereas logger b cheats twice and is caught the first time after logger a cheats and is not caught p c a 1 2 1 1 2 1 2 3 4 after logger a cheats and is caught p c a 3 4 3 4 1 2 3 8 on the other hand after logger b is caught p c b 1 2 1 2 1 2 1 4 however when logger b cheats again and is not caught p c b 1 4 1 1 4 1 2 5 8 although both loggers have cheated twice and have been caught once since logger a was caught and sanctioned more recently p c a p c b 6 1 analysis of the monitoring and sanctioning model we introduce the m s model primarily to improve the conceptual validity of the c e model and to address some of the paradoxical emergent behaviors seen in that model see section 5 we are particularly interested in realistically modeling rule violation and sanctioning in order to reveal the importance of endogenous institutions monitoring and sanctioning in resource conservation to evaluate how well this goal is achieved we again conduct an oat sensitivity analysis the base parameter values and tested values are the same as in table 1 except for initial loggers and the new parameters specific to the m s model the new base parameters and tested parameters are given in table 3 6 1 1 the importance of endogenous institutions in our sensitivity analysis of the c e model most simulations ended with very few loggers because those who were caught cheating were removed from the simulation as a result the final biomass b m f was almost always above 100 the original biomass and so as discussed in section 5 3 4 the final institution c i f did not have a significant impact on b m f in the m s model we now see a strong positive correlation between c i f and b m f under base parameters the correlation between c i f and b m f is ρ 0 774 this indicates that model communities that form a stricter set of rules governing forest logging are more successful at conserving the forest and communities that fail to form adequate rules fail to conserve the forest the positive correlation between c i f and b m f extends to almost all parameter sets tested ρ 0 736 when including all simulation runs fig 9 the notable exceptions are in simulations in which i n i t i a l l o g g e r s is either 60 or 80 in these cases there are simply not enough loggers to deplete the forest and so current institution is irrelevant if we exclude these simulation runs the correlation between c i f and b m f is ρ 0 891 6 1 2 the importance of monitoring and sanctioning one of the main limitations of the c e model was that the enforcement level parameter had no discernible impact on biomass preservation studies have shown that monitoring and sanctioning to enforce community management regulations improve resource conservation cox et al 2010 gibson et al 2005 van laerhoven 2010 this effect is now clearly seen in the m s model to demonstrate this visually in fig 10a we depict just those simulations with monitoring level equal to 0 2 or 0 8 and in fig 10b we depict just those simulations with sanction level equal to 0 2 or 0 8 it is clear from both that for a given value of the final institution c i f higher monitoring or higher sanctioning lead to higher final biomass b m f to compare to our previous regression analysis for the c e model we again construct a linear model this time of b m f as a function of c i f monitoring level and sanction level we use all of the simulations in which the monitoring level and sanction level level are varied while the other parameters are held at base values we do not include the number of loggers remaining since in the m s model no loggers are removed we see now that both monitoring level and sanction level significantly impact b m f see table 4 this also shows that in contrast to the results of section 5 3 3 more cheating as a result of lower sanctions actually decreases biomass as we would expect 6 1 3 results with more dynamic loggers in order to facilitate comparison between the two models when introducing the m s model we only revised the enforcement mechanism of the c e model with the implementation errors corrected however in sections 5 1 2 and 5 1 3 we discussed further reasonable modifications that we could make to try to better capture the behavior of real agents thus we also explored behaviors of the m s model after making these modifications logger movement every logger simply moves once during each tick at the beginning of the tick logger dissatisfaction loggers with p a y o f f old payoff maintain the same payoff satisfaction as in the previous period these small changes result in more dynamic loggers for one they have the potential to log during every tick whereas in the original coding of the m s model a logger that logs in one tick will be located on an empty patch and be unable to log on the next tick they are also more likely to be dissatisfied meaning that they are more likely to change minimal cut cheat and collectively to reach the threshold for changing current institution with these changes we still observe the phenomena discussed in sections 6 1 1 and 6 1 2 but we also observe an even more dramatic illustration of the importance of endogenous institutions recall that reference threshold is a measure of the environmentalism level of the community we might expect any increase in reference threshold to result in an increase in b m f indicating that communities with higher environmentalism levels are better at conserving the forest however a brief inspection of fig 11 shows that this is not the case the reason for this is revealed by considering the number of times the community has met in order to change current institution when a community has low levels of environmentalism r e f e r e n c e t h r e s h o l d 3 they usually meet 1 2 times consequently c i f and therefore b m f which is highly correlated with c i f in the m s model remains low when a community has high levels of environmentalism r e f e r e n c e t h r e s h o l d 6 the community sets a high current institution early in the simulation however because of this they then do not meet again or meet only once more early in the simulation as a result the community fails to increase current institution and the simulation ends with a relatively low c i f in contrast when a community has a moderate level of environmentalism 3 r e f e r e n c e t h r e s h o l d 6 they usually meet at least three times this leads to a high c i f and hence a high b m f these results align with ostrom s findings that consistent meetings are an important component of cbnrm success although there is not a perfect correlation between reference trees and b m f in this model the trend lines in fig 11 uncover a strong relationship between these variables when we condition on the number of meetings within the simulation thus in the m s model while a community s tendency to prioritize environmentalism can influence conservation success the endogenous institution is even more significant than the predisposition of the community 6 2 shortcomings of the monitoring and sanctioning model while the m s model seems to avoid some of the more paradoxical emergent behaviors of the c e model unusual behaviors remain and there are undoubtedly further ways to improve the m s model that would bring outcomes even closer in line with observed community management systems first we note that the rules for updating minimal cut and the replacement mechanism in the m s model are still those inherited from the original endogenous institution model consequently we still see the phenomenon of minimal cut polarization from section 5 3 1 while not necessarily unrealistic this is a noteworthy phenomenon as it helps to explain some of the other outcomes we observe we also continue to see that all loggers eventually have identical reference trees the one static logger state variable as described in section 5 3 2 in an actual common pool resource environment we would expect competitive individuals to continue to adopt innovative ideas and logging behaviors this is a strong argument for implementing the evolutionary mechanism described in bravo 2011 or an even more aggressive version of this mechanism there is also still some oddity in the movement of loggers inherited from the ei and c e models recall that in the move submodel section 3 7 2 a logger will randomly select a neighboring patch to move to from among those patches with trees current institution if no such neighboring patch exists then the logger will simply move to a random neighboring patch it would seem preferable to model logging as a strict objective seeking behavior in which loggers always move to the patch with the greatest number of trees even better may be to specify that the loggers move to a neighboring patch with the greatest number of trees that is not occupied by another logger otherwise even in a simulation with abundant biomass multiple loggers may move to the same patch with trees current institution and then only the first logger to execute the logger tick actions submodel will be able to log the patch another unusual phenomenon in the m s model is that in certain simulations it is the more environmental loggers that are more likely to cheat this is a result of the rules for cheating inherited from the c e model consider for example the cluster of simulations in fig 9 in which c i f 4 and b m f 9 in these simulations c i f 1 3 b m a x 20 3 during such a simulation any logger may cheat due to decreased payoff between rounds however the loggers with the highest values of reference trees will also cheat due to dissatisfaction with the current institution this is again due to minimal cut polarization the loggers with the highest values of reference trees will have their minimal cut approach b m a x so that eventually minimal cut current institution t o l e r a n c e t h r e s h o l d 2 3 b m a x at which point they may cheat it seems strange to have the most environmentally conscious loggers be the ones violating the rules of the endogenous institution while this can perhaps be justified by arguing that the community based management system loses credibility in the eyes of a logger when the rules are too lax it would also make sense to modify this rule so that loggers only cheat when they are on a patch with minimal cut t r e e s current institution that is to modify the rules so that loggers may ignore the institution but not their own personal beliefs about how loggers should behave finally using eq 2 for the probability that a logger that has experienced reduced payoff between periods will become unsatisfied causes some very unusual outcomes in both the c e and m s model to illustrate consider a simulation in which the c o s t which is paid during each of the 10 ticks in a period is equal to 5 if a logger logs 51 trees during one period and 50 trees during the next period then old payoff 1 n e w p a y o f f 0 and the logger will have payoff satisfaction set to 0 with probability 1 according to eq 2 but now suppose that current institution 0 so that there are no rules governing the community and as a result there is very little biomass remaining in the simulation if a logger in this simulation is able to log 1 tree during one period and 0 trees during the next period then old payoff 49 n e w p a y o f f 50 and the logger will only have payoff satisfaction set to 0 with probability 1 99 strangely this means that once the amount of biomass in a simulation is extremely low loggers are very unlikely to be unsatisfied and therefore very unlikely to increase minimal cut still we might think that the loggers will slowly raise minimal cut so that eventually 2 3 of the loggers will have m i n i m a l c u t c u r r e n t i n s t i t u t i o n t o l e r a n c e t h r e s h o l d this would raise current institution reduce logging and possibly allow biomass to recover but the replacement mechanism in the model replaces one of the loggers each period with a new logger with minimal cut 0 thus loggers do not remain in the simulation long enough for loggers with m i n i m a l c u t c u r r e n t i n s t i t u t i o n t o l e r a n c e t h r e s h o l d the scenario above hints at why an institution fails to form in many simulations even though there is very little biomass for example in the simulations represented by the cluster of points near the origin in fig 9 while our proposed modification to payoff satisfaction in section 6 1 3 makes intuitive sense it does not address this issue it is still odd that loggers in a completely depleted forest would be only occasionally unsatisfied and as a result that they would fail to form an endogenous institution a reasonable approach for resolving this issue may be to simply follow occam s razor and assume that any time a logger experiences a reduced payoff or a payoff below a certain threshold they will become unsatisfied 7 conclusion agent based modeling offers a promising method to learn about the dynamic interactions within community management systems and to provide insight into how such dynamics impact resource conservation still in order to interpret the results of these models and draw meaningful conclusions these models must be rigorously evaluated in our sensitivity analysis of the cheating and enforcement model of vallino 2014 we find that in many simulations the enforcement mechanism removes almost all loggers from the simulation which is not an accurate representation of the enforcement procedures found in real world cbnrm additionally the implementation of cheating and enforcement in this model leads to counter intuitive emergent behaviors for example the endogenous institution and rule enforcement do not significantly impact biomass and communities that experience more cheating actually end with higher levels of biomass in fact we find that the number of loggers remaining at the end of a simulation overpowers all other factors one might analyze in the model we discovered the issues with the original cheating and enforcement model through the process of evaludation this process sheds light on ways in which some of these issues might have been avoided during the initial model development in step 1 of the evaludation process section 5 1 we identified some conceptual issues with the model while it is possible to make reasonable arguments for these modeling decisions it is unclear how these decisions were made or if they were necessary to produce certain outcomes for example is there a compelling reason why loggers that experience a decreased payoff should not always be unsatisfied a simpler more robust model might have resulted from developing the model according to the trace framework grimm et al 2014 in which progressively more complex versions of a model are rigorously tested during development and the analysis documented at each step as just one example this framework of model development may have resulted in a simpler mechanism of logger dissatisfaction or at least have made clear the necessity of the current version similarly in step 2 of the evaludation process we identified key errors in the model implementation section 5 2 it is not surprising that there might be coding errors in the implementation of a complex agent based model however we believe that describing the models using the odd overview design concepts details protocol would have greatly reduced the likelihood of errors the odd protocol is well designed to reveal any ways in which the implementation of a model differs from its conceptual design another way to avoid these errors may be to follow the advice of chanda and miller 2018 and to replicate models from the description this process is likely to reveal inconsistencies or ambiguities in the original description and may help to avoid errors being inherited from earlier models as was the case with the lack of an evolutionary mechanism we discussed in section 5 2 3 in steps 3 5 of the evaludation process we examined the c e model output conducted a thorough sensitivity analysis and attempted to corroborate the findings with known patterns and data our analysis shows why it is not enough to simply verify the output of the model as in step 3 of the evaludation process or even to confirm that the output matches expectations as in step 5 for example if we run a simulation of the c e model with no monitoring and then again with a moderate level of monitoring we may conclude that increasing monitoring increases final biomass which is an emergent behavior in line with expectations and known patterns however when we conduct a sensitivity analysis by conducting thousands of simulations over a range of parameters we see that these patterns are not generally observed instead as the regression analysis in table 2 shows once monitoring level 0 the effect of monitoring is entirely explained by the number of loggers we believe this analysis also shows that it is important to observe multiple outputs when considering emergent phenomena even if they are not the primary outputs being modeled in this example the number of loggers was not the primary variable of interest but it explained the effect we observed likewise observing the distribution of minimal cut in fig 5 lead us to conjecture outcomes like that observed in fig 6 in order to improve upon the c e model we proposed a new monitoring and sanctioning model that offered a new set of rules to model logger cheating and institutionenforcement we believe these modifications make the abm more realistic and in closer alignment with ostrom s design principles in addition we repeated the latter steps of the evaludation process with this model by conducting a sensitivity analysis and analyzing emergent behaviors we observe that over a wide range of parameters the institution rules have a direct impact on forest biomass levels leading to a positive correlation between the strictness of institution rules and forest conservation also in contrast to the c e model conditional on final institution increases in monitoring and or sanctioning increase the final biomass thus the model exhibits behaviors more closely in line with the cbnrm literature on real world systems while these results are promising there are still many potential modifications one could make to the m s model to better reflect real world cbnrm systems one potential change is to introduce more agent heterogeneity for example not all individuals respond identically to sanctioning so it may be logical to have each logger have their own randomized sanction level trait additionally in a real cbnrm individuals who have recently been caught cheating may be subjected to increased monitoring which would suggest that loggers could also have their own monitoring level trait that would increase when they are caught cheating finally a logger s probability of cheating could be based on their perception of how fair the institution is thus a logger s prob cheat could be influenced by the number of cheaters in the community as well as how often those cheaters are caught in addition to modifying the model itself one might also expand the breadth of analysis for the m s model during our analysis we focused almost exclusively on biomass levels as a measure of a cbnrm success however social sustainability is just as important as ecological sustainability for cbnrm success in their explorations of the original abms on which the m s model is based vallino and bravo incorporated logger payoff into their analysis similarly in their model of common pool resource use perez and janssen examined both resource health and the proportion of cooperative community members pérez and janssen 2015 future work should provide further analysis of the economic and social indicators in model communities finally we note that one obstacle that we encountered during our analysis was precisely defining when a simulation had reached a steady state as the abms we study are stochastic and have many model outputs random fluctuations in output values are always possible and even if one output appears to reach an equilibrium this is no guarantee that the entire simulation has reached a steady state in our analysis this determination was made qualitatively likewise we found it difficult to evaluate the conceptual foundations of the models without an agreed upon understanding of the time scale of the simulations for example whether it makes sense to have an agent remain in the simulation for thousands of periods or to change the institution every period depends on whether a period corresponds to one day or one year therefore for more consistent analysis we believe it is necessary to develop a principled way to determine when an abm of cbnrm has reached a steady state and to specify a precise time scale in order to calibrate the traits of the agents and the environment credit authorship contribution statement maya lapp conceptualization methodology formal analysis writing original draft writing review editing visualization colby long conceptualization methodology formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix parameters and state variables of the model entities see tables 5 6 7 8 9 10 11 and 12 
24453,community based natural resource management cbnrm has the potential to conserve resources while simultaneously empowering traditionally marginalized communities because classical equation based modeling methods fail to capture the complexity of cbnrm agent based modeling abm has emerged as a useful method for modeling these systems in this paper we begin with a careful evaluation and sensitivity analysis of an existing abm of community forest management that incorporates cheating and enforcement which we call the cheating and enforcement model our results reveal several emergent behaviors of the model that are paradoxical or inconsistent with real world expectations we then introduce the monitoring and sanctioning model which makes several modifications to the cheating and enforcement mechanisms of the original abm analyzing this new model we see that it does not exhibit several of the more unusual behaviors of the original model and reveals surprising consistency with real world cbnrm systems finally we discuss some limitations of this new model and potential areas of further improvement keywords tragedy of the commons common pool resources evaludation of agent based models sensitivity analysis social ecological systems endogenous institutions 1 introduction since the 1980s community based natural resource management cbnrm has become widely accepted as an effective method of resource conservation both in the literature and on the ground dressler et al 2010 unfortunately while cbnrm offers a promising solution to resource depletion the very nature of cbnrm makes it difficult to implement on a large scale this management strategy focuses on enabling individual communities to form regulations that are compatible with their community and ecosystem since each community and ecosystem is unique a system that is successful in one community may be ineffective elsewhere therefore while there have been many case studies of cbnrm e g ostrom 1990 sudtongkong and webb 2008 there is limited consensus on the general traits that make a community management system successful cox et al 2010 similarly cbnrm applies to social ecological systems that involve interactions within human communities and between humans and the natural environment social ecological systems are complex and often non linear systems that are difficult to describe using classical equation based modeling hence while statistical analyses including logistic regression chi squared tests for independence and qualitative comparative analysis have helped identify patterns in community management success e g chhatre and agrawal 2008 gibson et al 2005 nath 2018 persha et al 2011 van laerhoven 2010 it is difficult to determine specific factors that influence the success or failure of a cbnrm system and to describe the precise mechanisms of influence agent based modeling abm offers an alternative method of exploring and understanding cbnrm systems from deangelis and grimm 2014 agent based modeling is a population and community modeling approach that allows for a high degree of complexity of individuals and of interactions among individuals individual based models simulate populations or systems of populations as being composed of discrete individual organisms by modeling individual agents who follow probabilistic rules abms allow for heterogeneous populations stochastic interactions and complex non linear systems exactly the traits of cbnrm systems that make them difficult to model while some abms of cbnrm have been used to suggest specific management policies for individual communities e g campo et al 2009 castella et al 2005 dumrongrojwatthana et al 2011 zellner et al 2012 most works to date have applied abms to study the general dynamics underlying community management systems e g agrawal et al 2013 bravo 2011 vallino 2014 understanding these dynamics may help to identify key ecological and social factors that tip a cbnrm system toward success or failure while these models offer insight into cbnrm this remains an emerging field and many of the models contain unjustified assumptions and have not been carefully analyzed in this article we conduct an in depth analysis of a model of cbnrm that we call the cheating and enforcement model c e model this model is described in vallino 2014 and is an extension of a model of cbnrm first introduced in bravo 2011 our analysis reveals several emergent behaviors of the model that are paradoxical or inconsistent with real world expectations we then explore the precise mechanisms that produce these unexpected behaviors and introduce a new model with modifications to the enforcement mechanism in the c e model which we call the monitoring and sanctioning model m s model we begin in section 2 with a brief introduction to community based natural resource management and current methods for modeling these systems in section 3 we give a complete description of the three agent based models of community forest management that we discuss in this paper the endogenous institution bravo 2011 cheating and enforcement vallino 2014 and monitoring and sanctioning models our description follows the odd overview design concepts details protocol in section 4 we briefly explore typical outcomes of the endogenous institution model and in section 5 we conduct a thorough analysis of the cheating and enforcement model to learn how the model parameters impact large scale behaviors during this process we identify key implementation errors in the model code discover several unexpected emergent behaviors and identify the specific mechanisms that explain these emergent behaviors one key finding is that the enforcement mechanism in this model which removes agents that violate community rules overwhelms the importance of the rules in section 6 we discuss how the results of the previous section informed our development of the monitoring and sanctioning model that modifies the cheating and enforcement mechanisms of the c e model we then conduct a sensitivity analysis of this new model and analyze the emergent behaviors in the m s model we see a strong positive correlation between the strictness of the community rules and conservation of the resource as predicted by the cbnrm literature in fact our results suggest that the formation of endogenous institutions can have a greater impact on model resource conservation than the environmental attitudes of the agents in the model additionally in contrast to the c e model in simulations of communities with similar rules we see increased monitoring and sanctioning improve resource conservation thus the new model appears to independently confirm insights from the cbnrm literature that were not explicitly used to develop the model finally in section 7 we discuss some limitations of this work and suggest areas for potential improvement and further exploration 2 background common pool resources cprs are resources with finite limits that are utilized by several independent users if there are no regulations to manage a cpr selfish use of the resource frequently leads to resource depletion often called a tragedy of the commons hardin 1968 common methods to prevent resource depletion include government regulations or privatization however these methods often do not consider local context or lead to inequitable resource access ostrom 1990 community based natural resource management cbnrm is an alternative method of resource conservation that allows cpr users to determine how to manage the resource case studies have shown that communities can successfully employ cbnrm and in some cases cbnrm actually proves more successful than government led regulations ostrom 1990 sudtongkong and webb 2008 nevertheless cbnrm is not always effective dressler et al 2010 elinor ostrom s seminal work in 1990 established eight design principles for cbnrm success in 2010 cox conducted a large literature review of empirical case studies and confirmed the importance of ostrom s principles for cbnrm systems around the world cox et al 2010 statistical analyses of datasets containing cbnrm case studies have also confirmed many of ostrom s principles such as the importance of local monitoring and enforcement of community resource management rules chhatre and agrawal 2008 gibson et al 2005 and illuminated other factors that may influence cbnrm success such as resource size dependence on the resource for commercial livelihood leadership organization and social capital nath 2018 persha et al 2011 van laerhoven 2010 while the statistical analyses mentioned above have provided valuable insight into the factors that affect cbnrm success they are limited by the small sample size of case studies relative to the large number of explanatory variables one particularly promising means for overcoming this limitation is the use of agent based models abms as defined in the introduction agent based modeling is a population and community modeling approach that allows for a high degree of complexity of individuals and of interactions among individuals individual based models simulate populations or systems of populations as being composed of discrete individual organisms deangelis and grimm 2014 in contrast to traditional modeling approaches that focus solely on replicating the macro level behavior of a system abms are constructed based on micro scale interactions thus they are particularly well suited for realistic representation of complex social ecological systems schlüter et al 2019 abms allow one to simulate experiments that are impractical to conduct e g studying cpr health over centuries or contain variables that would be difficult to control e g deadman et al 2000 schill et al 2016 these simulations often reveal emergent behaviors of the system collective behaviors and patterns that appear often through unobvious means from the accumulation of small interactions macaulay 2017 agent based modeling of community based natural resource management has the potential to deliver key insights into the functioning of community management systems for example abms have already been used to learn about the dynamics within communities implementing cbnrm agrawal et al 2013 ghorbani and bravo 2016 pérez and janssen 2015 and to suggest management policies for individual communities campo et al 2009 castella et al 2005 dumrongrojwatthana et al 2011 zellner et al 2012 they have also been used to study the role of institutions in managing common pool resources as well as how various ecological and social factors influence cbnrm success bravo 2011 deadman et al 2000 schill et al 2016 vallino 2014 however in order to draw robust conclusions from these models greater verification of model implementation and validation of model outputs is required at present few model outputs have been validated with real world observations and even fewer have been corroborated to determine whether outputs can successfully predict observations that were not used in model development there also have been few sensitivity analyses to determine how changes in parameters and differences in rule mechanisms influence emergent behaviors schulze et al 2017 recently there have been a number of works aimed at addressing these issues for instance arifin and madey 2015 makes the case for the importance of reproducible modeling and contains an overview of some of the recent methods developed for verifying validating and reproducing agent based models others have emphasized the need to analyze and improve existing models for example in thiele et al 2014 the authors argue that more effort should be directed toward analyzing existing models for robustness and making appropriate modifications to these models rather than toward new model development still others have undertaken the task of replicating and testing existing agent based models and developing standards for model replication donkin et al 2017 zhang and robinson 2021 with these considerations in mind in section 5 we apply augusiak et al s method of abm evaludation augusiak et al 2014 a comprehensive outline for evaluating and validating abms to the agent based model of vallino 2014 we then use the results of this analysis to inform the development of our own modified monitoring and sanctioning model which we analyze in section 6 3 model descriptions with the odd protocol in this work we discuss three different models of community based natural resource management the endogenous institution model ei model the cheating and enforcement model c e model and the monitoring and sanctioning model m s model the endogenous institution model bravo 2011 includes an endogenous institution i e a community management system which sets rules for how the community members may utilize the resource and assumes that all members always obey community rules in reality there are usually community members who violate the resource use rules thus the cheating and enforcement model of vallino 2014 builds on the endogenous institution model by introducing cheating and institutional methods to prevent cheating in section 5 we conduct a careful analysis of the c e model and discover several conceptual issues with the design of the model the outcome of this analysis informs our development of the monitoring and sanctioning model which includes mechanisms for cheating and enforcement that better represent actual community management systems although we develop the m s model based on the results of the next section for clarity we will describe both the c e model and the m s model together in this section as extensions of the ei model our description follows the odd overview design concepts details protocol grimm et al 2006 2010 2020 the ei model is described in bravo 2011 without using the odd protocol so we have adapted the description in that work the ei model is described in black text throughout the c e and m s models are extensions of the ei model and inherit all of its features thus unless stated otherwise black text can also be assumed to apply to these models we describe additional features unique to the c e model with additional features unique to the m s model with and additional features common to both the c e and m s models with all three of the models are implemented in netlogo see fig 2 below for a picture of the simulation environment and the code for each is available at https github com mayalapp cbnrm abm models and analysis 3 1 purpose and patterns the purpose of the endogenous institution model is to illustrate how endogenous institutions and individual beliefs about resource conservation can prevent resource depletion and increase individual payoffs in common pool resource management problems the model is expected to reproduce the following patterns observed in the empirical cpr literature that communities that are able to will form endogenous institutions that stronger institutions lead to greater resource conservation and individual payoffs and that communities that value resource conservation will form stronger institutions or or 3 2 entities state variables and scales the model is set in a forest environment which is structured as a toroidal 50 50 grid the model proceeds in discrete time steps called ticks and every 10 ticks of the simulation is called a period the model includes the following entities patches each of the 2500 grid cells in the simulation environment is a patch which represents a small patch of the forest the state variable trees of each patch represents the number of trees growing on that patch tables 5 and 6 loggers loggers are agents in the simulation that represent individuals in the community that exploit the resources of the environment by logging trees located on patches tables 7 and 8 institution there is a single institution entity which tracks the development of the community rules for forest management and updates the rules based on the beliefs of the loggers tables 9 and 10 observer there is a single observer entity which controls the simulation environment and the global variables tables 11 and 12 the rest of the state variables and parameters of the model are described in the tables indicated above in appendix as this is an abstract model of a common pool resource the forest area and the timescale of the simulation do not have a literal interpretation despite the use of forestry terminology e g forest loggers trees this model can be viewed as an abstract representation of any common pool resource 3 3 process overview and scheduling each simulation proceeds for a predefined number of ticks during each tick the following actions occur in the following order the order in which the patch and logger entities update their state variables is randomized on each tick 1 tree growth patches execute the tree growth submodel by growing trees based on the number of trees on the patch and on neighboring patches section 3 7 1 2 logger tick actions loggers execute the logger tick actions submodel in which they may log move as described under the log move and submodels in section 3 7 2 if a tick represents the end of a period then the following additional actions occur 3 compute satisfaction loggers execute the compute satisfaction submodel to determine whether they are satisfied based on their recent payoffs and adjust their views about how the forest should be logged accordingly section 3 7 3 4 institution change the institution entity executes the institution change submodel to determine whether there are enough unsatisfied loggers to meet the threshold for changing the institution and updates current institution accordingly section 3 7 4 5 observer updates the observer updates the model outputs section 3 7 5 6 replace logger the observer entity replaces one logger in the simulation section 3 7 6 7 logger updates loggers execute the logger updates submodel to reset certain state variables for the next period section 3 7 7 a diagram of the process overview and scheduling is depicted in fig 1 3 4 design concepts this section describes the models at a conceptual level using the 11 design concepts of the odd protocol 3 4 1 basic principles the basic principle of the endogenous institution model is that the formation of endogenous institutions in an open access resource environment can prevent a tragedy of the commons hardin 1968 in which rational agents acting in their own interests deplete the resource from bravo 2011 the core of the model is the formalization of the beliefs or mental models that agents hold regarding the desirable state of the resource and the best way to achieve it the model dynamics can give insight into the relationships between agent beliefs the institutions formed and resource conservation 3 4 2 emergence the most important outcomes of the endogenous institution model are the final institution the level of biomass the distribution of agent beliefs at equilibrium and agent payoffs these outcomes emerge from the initial distribution of logger beliefs and the decisions loggers make about whether to change the institution during the simulation 3 4 3 adaptation logger agent movement logging and cheating are all adaptive behaviors if loggers are on a patch that can legally be logged then they will log that patch at the end of each tick if they have not logged then loggers decide which patch to move to based on the number of trees on neighboring patches if there is any patch that can legally be logged then the logger will move randomly to one of these patches otherwise the logger will move randomly to any patch all of these actions are described in more detail in the description of the logger tick actions submodel in section 3 7 2 at the end of each period loggers decide whether to adjust their minimal cut which is the number of trees they believe should be on a patch before it is logged they adjust this based on their reference trees which reflects their beliefs about how much biomass should be in the forest as described in the compute satisfaction submodel in section 3 7 3 3 4 4 objective the loggers do not engage in any direct objective seeking behaviors though many logger behaviors are based on implicit predictions about what will lead to greater payoffs 3 4 5 learning at the end of each period in the replace logger submodel section 3 7 6 the logger with the lowest payoff in the previous period is replaced by a new logger that has the same reference trees payoff as the logger with the highest payoff in the previous round this indicates that the new loggers in the simulation have learned by imitating the most successful loggers in the simulation 3 4 6 prediction many logger agent behaviors are based on implicit predictions about what will lead to greater individual payoffs and increased biomass in the forest loggers adjust their minimal cut based on recent payoffs and the amount of biomass available as described in the compute satisfaction submodel in section 3 7 3 this reflects their implicit prediction that if current institution was set to their minimal cut this would lead to what they deem an acceptable level of biomass in the forest based on the static state variable reference trees 3 4 7 sensing logger agents are able to perfectly sense the number of trees of neighboring patches the current institution governing the rules of logging the total number of patches in the environment and the number of living patches those with trees 0 in the simulation environment the institution agent can sense the number of initial loggers as well as the number of unsatisfied loggers at the end of each period and the minimal cut of every logger in the simulation 3 4 8 interaction patches interact with neighboring patches through reseeding an empty patch is reseeded based on the number of neighboring patches that are living as described in the tree growth submodel in section 3 7 1 logger agents interact with patches by logging the trees of a patch this also represents a mediated interaction between loggers since trees logged by one logger are unavailable for other loggers loggers interact directly with one another by holding meetings when the number of unsatisfied loggers at the end of a period exceeds 2 3 initial loggers the loggers meet and current institution is set to the mean minimal cut of all loggers 3 4 9 stochasticity stochasticity is used in initialization to determine the location of loggers the number of trees on each patch and the value of reference trees for each logger as described in section 3 5 during the simulation the order in which loggers and patches update their traits is determined randomly at each tick stochasticity is also used in the following ways to represent the unpredictability and heterogeneity inherent in a social ecological system more details are given in the descriptions of the relevant submodels tree growth the probability that a non living patch will reseed is determined randomly based on the number of neighboring patches that are living logger tick actions when loggers move they move randomly to a neighboring patch that can be logged or if none is available randomly to any neighboring patch compute satisfaction when loggers experience a decreased payoff they become unsatisfied with a probability based on their old payoff and new payoff eq 2 when loggers become unsatisfied and raise or lower their minimal cut they do so by a randomly selected number of trees replace logger the new logger in the simulation is placed on a new patch at random 3 4 10 collectives the models do not include any collectives 3 4 11 observations as noted in the purposes and patterns the endogenous institution model is designed to illustrate how endogenous institutions and individual beliefs about resource conservation affect resource depletion and individual payoffs in order to observe these relationships the observer entity exports data at the end of each period when it executes the observer updates submodel this includes data about the institution current institution and data about logger beliefs mean minimal cut mean reference trees unsatisfied note that the mean reference trees can evolve throughout the simulation due to the replace logger submodel which accounts for new loggers adapting the traits of successful loggers in order to monitor resource conservation the outputs also include living patches the number of patches with trees 0 and biomass the total number of trees on all patches the model also exports the mean payoff of all of the loggers in the most recent period 3 5 initialization the initial state of the model can be varied as part of simulation experiments to assess the effects of different initial conditions at the start of each simulation the environment is initialized as a 50 50 grid and the observer or global parameters of the model from table 11 are set note that the global parameters include the number of logger agents in the simulation initial loggers the institution state variable current institution is set to 0 the number of trees on each patch is determined by randomly selecting an integer greater than or equal to 0 but less than b m a x 2 and then adding b m a x 2 1 to this number next each logger is placed on a random patch and the minimal cut payoff and old payoff for each logger is set to 0 each logger has payoff satisfaction set to 1 to indicate that all of the loggers are satisfied at the start of the simulation next the reference trees for each logger is set by drawing a random number from a normal distribution with mean reference threshold and standard deviation 0 25 this number represents the proportion of patches the logger believes should be living in the forest and this number is multiplied by the number of patches 2500 to determine each logger s reference trees 3 6 input data the model does not use input data to represent time varying processes 3 7 submodels this section contains a detailed description of each of the submodels in the ei c e and m s models 3 7 1 tree growth the forest grows throughout the simulation and all patches with t r e e s 0 are considered alive at each tick empty patches grow trees with probability 1 p g r o w t h p r o b n 1 9 where n is the number of adjacent or diagonally adjacent patches that are alive this represents trees propagating from adjacent patches to the empty patch when this occurs the value of t r e e s for that patch is set to 1 next all living patches with t r e e s b m a x increase trees by growth rate 3 7 2 logger tick actions at each tick loggers start by decreasing their payoff by cost this represents the cost of living next if the logger is on a patch with t r e e s minimal cut they will log the patch see the log submodel below if a logger is on a patch with t r e e s minimal cut then in the ei model the logger will move see the move submodel below fig 3 shows a diagram representing the actions loggers perform in the logger tick actions submodel with differences between the ei c e and m s models highlighted log to log a logger increases payoff by the value of trees for their current patch the trees for that patch is then set to zero i e the logger cuts down all of the trees on that patch move to move a logger will first determine if there are any patches in their neighborhood all patches within a 5 5 square centered at the location of the logger with t r e e s minimal cut if so they will randomly select one of these patches and move to that patch if there are no patches with t r e e s minimal cut within their neighborhood the logger will move to a random patch within their neighborhood 3 7 3 compute satisfaction in this submodel loggers determine whether they are satisfied with their payoff from the period and update their beliefs about the best way to log the forest if a logger experiences a decrease in their payoff between periods then they may become unsatisfied next if a logger has payoff old payoff then the logger s payoff satisfaction is set to 0 with probability 2 q old payoff p a y o f f p a y o f f old payoff the loggers that have just had payoff satisfaction set to 0 then adjust their minimal cut when a logger has living patches reference trees their minimal cut increases by x u 0 9 and when living patches reference trees their minimal cut decreases by x u 0 9 if there are fewer living patches in the forest than the logger believes is appropriate the logger attributes the decreased payoff to depletion of the forest and increases their minimal cut in contrast if there are more living patches in the forest than the logger believes is appropriate the logger attributes the decreased payoff to not logging enough and they decrease their minimal cut in the ei model payoff satisfaction is computed at the end of a period and is then used to determine which loggers update minimal cut and if the institution will change in the institution change submodel it is then reset to 1 for all loggers in the logger updates submodel see section 3 7 7 however in the c e and m s models payoff satisfaction is also used in the subsequent period to determine if a logger will cheat thus payoff satisfaction cannot be reset until the next period is complete this was the source of the error in the original coding of the c e model described in section 5 2 1 3 7 4 institution change the institution entity executes the institution change submodel to determine whether there are enough unsatisfied loggers to meet the threshold for changing the institution and updates current institution accordingly the value of current institution starts at 0 indicating that any living patch may be logged at the beginning of the simulation in this model loggers are considered unsatisfied if either payoff satisfaction 0 or 3 minimal cut current institution tolerance threshold as noted in the cheat submodel in section 3 7 2 the second condition accounts for loggers becoming dissatisfied when current institution deviates too much from their personal views on what patches should be available to log the unsatisfied state variable of the institution agent tracks the number of unsatisfied loggers in a simulation if at the end of a period 4 u n s a t i s f i e d 2 3 initial loggers then the loggers meet and the current institution is set to the mean minimal cut of all loggers since minimal cut is a logger s belief about how much biomass there should be on a patch before the patch can be logged the mean minimal cut of the community represents a compromise among community members regarding how much biomass should be present for a patch to be logged this mechanism implicitly gives all loggers equal weight in the decision making process note that current institution may increase or decrease and both are seen in simulations as a result of this process 3 7 5 observer updates as described in section 3 4 11 the observer exports data about logger beliefs payoffs and the state of the forest this includes current institution living patches biomass mean payoff of all loggers mean minimal cut of all loggers mean reference trees of all loggers unsatisfied and 3 7 6 replace logger the end of each period also allows for a selection process among the loggers the logger with the lowest payoff is replaced by a copy of the logger with the highest payoff the new logger now has the same reference trees payoff as the most successful logger the new logger is placed on a random patch and their minimal cut is set to zero this selection process can be interpreted as either imitation unsuccessful loggers adopting the behavior of successful loggers or a market mechanism unsuccessful loggers being replaced by new entrants into the market in the first interpretation there is no new logger but rather reference trees is a dynamic rather than static state variable for each logger 3 7 7 logger updates the payoff variables are reset for the next period every logger sets old payoff equal to the current value of payoff and then payoff is set to 0 ei only each logger has payoff satisfaction set to 1 4 model results and discussion endogenous institution model since the cheating and enforcement model is an extension of the endogneous institution model before we begin our analysis of the c e model in section 5 it will be useful to explore some of the typical outcomes of the ei model the endogenous institution model is analyzed in bravo 2011 in that work it is compared to an even simpler open access model of common pool resource management in which there is no communication among agents and hence no institution as expected simulations with this open access model almost always result in a tragedy of the commons in which the forest resource is all but eliminated in contrast in bravo 2011 the results of 50 simulations of the endogenous institution model under the base parameters described in section 5 3 are reported and on average 26 3 of the initial biomass remains at the end of the simulations while this is only about a quarter of the original biomass in the forest it indicates that the endogenous institution does prevent complete forest depletion in addition the average of the loggers minimal cut and reference trees do not decrease to zero indicating that loggers are still interested in forest preservation and have not all adopted a purely selfish strategy at the end of the simulation a replication of a single run of the endogenous institution model is shown in fig 4 in fig 4c we see that biomass declines initially but then increases and appears to reach an equilibrium at around 30 of the original biomass level this occurs around the same time as the change in current institution fig 4a which suggests that the institution is essential to halting biomass decline similar to the original results in bravo 2011 we find the average minimal cut and reference trees do not decrease to zero in this example run however as we discuss further in section 5 3 1 for all loggers minimal cut is near either 0 or b m a x we note at this point that in a stochastic agent based models it is often impossible to guarantee that a simulation has truly reached a steady state that is a point beyond which all of the parameters are guaranteed to vary only within a narrow range for example in the endogenous institution model we may observe a simulation where the biomass hovers around 30 of the original biomass level for several thousand ticks but there is always some non zero probability that in the next few ticks no empty patches will grow and all of the biomass will be removed nevertheless often in situations like this where a model appears qualitatively to have reached a steady state the parameters will not deviate much from their current values therefore in practice we can stop a simulation at this point and analyze the outcome of the simulation thus for convenience and following similar assumptions made in bravo 2011 and vallino 2014 in this paper we will refer to this pseudo steady state as the steady state of the model similarly we will call the percent of the initial biomass remaining at the end of a simulation final biomass b m f and the value of current institution at the end of a simulation final institution c i f 5 model results and discussion cheating and enforcement model as discussed previously many abms for community resource management have not been well validated before we introduce a new model of cheating in community management systems we first analyze the c e model as currently implemented to identify areas for improvement as mentioned earlier our methodology is inspired by augusiak et al s method of abm evaludation this is a five step cyclical process for continually revising and refining an abm to improve congruity between model emergent behaviors and reality the five steps are 1 conceptual model evaluation reviewing the conceptual decisions and assumptions behind abm rules to determine whether they accurately represent agent and environment behavior 2 model implementation verification reviewing model code to ensure all rules are implemented as they have been described 3 model output verification analyzing emergent behaviors and other model outputs to determine whether they follow real world expectations as well as assessing how much calibration was required to allow model outputs to successfully match these expectations 4 model analysis conducting sensitivity analysis and determining how emergent behaviors evolve through the simulation process to ensure a thorough understanding of model dynamics 5 model output corroboration comparing model outputs to patterns and data that were not used during model conception or were unknown prior to model conception this step checks to see if the model can independently corroborate new findings augusiak et al 2014 here we apply the evaludation process to the c e model to understand the precise mechanisms that explain the model s emergent behaviors we begin by analyzing the decisions and assumptions behind the c e model in section 5 1 step 1 and identifying some key errors in its implementation in section 5 2 step 2 because of the interconnectedness of steps 3 5 of the evaludation process we then present the results of these steps together in section 5 specifically we use our analysis to identify some of the noteworthy and paradoxical behaviors of the model steps 3 and 4 and discuss how each of these outputs compares to real world patterns in community management systems step 5 it is the analysis in this section that informs our development of the monitoring and sanctioning model which for convenience we described alongside the ei and c e models using the odd protocol in section 3 all netlogo models code to run simulations and code to reproduce figures and analysis can be found at https github com mayalapp cbnrm abm models and analysis 5 1 conceptual evaluation of the c e model in order to model the dynamics of a real world system agent based models often consist of dozens of rules and state variables the complexity of these systems ensures that almost any abm has an unlimited number of modifications one could make to try to improve the model this is especially true when the model is designed to represent complex human behaviors with this in mind in this section we propose three modifications to the rules of the c e model in order to better reflect the real world dynamics of a community management system 5 1 1 the enforcement mechanism in the c e model loggers who are caught cheating are removed from the model entirely this implies that cheaters are expelled from the community and cease to access the common pool resource however typically sanctions for cheating in a community management system include reprimands fines or in severe cases suspension of access to the common pool resource even when privileges are suspended the community cannot guarantee the logger will abide by the suspension in fact those ostracized from the community are likely to completely ignore cbnrm rules and log whenever they see fit thus to better represent community management systems it would make sense to implement graduated sanctions determining the punishment for cheaters based on the severity and or frequency of the violation ostrom 1990 an even more compelling reason for modifying this rule is that it completely overpowers many other c e model parameters for example as we show later in this section in almost all simulations of this model the biomass remaining at the end of the simulation is determined almost entirely by the number of loggers removed through the enforcement mechanism 5 1 2 logger movement in the c e model loggers only move at the end of each tick if they have not logged during that tick therefore if a logger logs on tick t then on tick t 1 they are inevitably located on an empty patch and cannot log there is no reason that a logger should wait to find a new patch of forest we can address this and simplify the rules by simply having every logger move at the end or the beginning of each tick 5 1 3 logger dissatisfaction we would expect a logger s payoff satisfaction to depend on their payoff satisfaction from the previous period for example if a logger is unsatisfied in period p because their payoff is decreasing and their payoff continues to decrease in period p 1 we would expect them to remain unsatisfied in the next period as currently implemented loggers whose payoff continues to decrease in period p 1 are only unsatisfied with probability q see eq 2 regardless of their previous payoff satisfaction 5 2 implementation verification of the c e model while attempting to understand some model behaviors we identified what we believe to be three coding errors in the implementation of the c e model code given in vallino 2018 the first two of these errors affect the cheating mechanism and as we explore later in this section lead to very different outcomes than if the model was coded as described in vallino 2014 we have corrected these two errors so the code matches the description of the c e model that we give in section 3 since they have such a dramatic impact on the outcomes of the model 5 2 1 not all loggers who should have cheated actually did cheat in the original description of the c e model it is stated that all unsatisfied loggers cheat but this is not how cheating was coded in the model loggers that are unsatisfied are loggers with payoff satisfactions 0 or minimal cut c u r r e n t institution tolerance threshold loggers with payoff satisfaction 0 did not cheat in the model as coded at the end of each period each logger s minimal cut and payoff satisfaction were updated according to the model rules however all loggers payoff satisfaction were subsequently reset to 1 before progressing to the next period thus when determining if a logger would cheat loggers that should have had payoff satisfaction 0 were not included and so did not cheat 5 2 2 some loggers who were caught cheating had not actually cheated as originally coded the model treated unsatisfied loggers as cheaters even if they were placed on an empty patch thus some loggers were caught and removed from the model despite the fact that they did not log any trees or violate the rules of the endogenous institution 5 2 3 there was no evolution of loggers in the description of the c e model from vallino 2014 at the end of each period when a logger is replaced there is a 1 chance that the new logger has a trait mutation this mutation is supposed to represent new entrants with innovative values we believe the intention was for the reference trees trait of the new logger to be chosen at random since this is the similar mutation described for the ei model in bravo 2011 however there is no mutation mechanism implemented in the netlogo version of the ei model from bravo 2011 or in the netlogo version of the c e model vallino 2018 we have opted not to include this mechanism in the model descriptions since it is not in the original netlogo version of the ei model or the c e model moreover it seems very unlikely that it would make much difference to the simulation outcomes since on average it would affect only one logger every 1000 ticks however we will discuss possible implications of some version of an evolutionary mechanism when analyzing the emergent behaviors of the c e and m s models 5 3 emergent behaviors in the c e model in this section we present the results of steps 3 5 of the evaludation process and describe emergent behaviors in the c e model and the mechanisms by which they evolve our approach to understanding these behaviors is to conduct a one factor at a time oat sensitivity analysis across a wide range of parameters this is done by varying one parameter at a time while holding all other parameters at base values we perform our simulations with the c e model after correcting the implementation errors mentioned above in sections 5 2 1 and 5 2 2 without these corrections the simulations do not reveal much since an institution fails to form in all but 2 5 of simulations this is primarily due to the error from section 5 2 2 which allows for loggers to cheat at the beginning of the simulation when current institution 0 as a result unsatisfied loggers are rapidly removed in the first few periods of each simulation and once 1 3 of the original loggers are removed it is impossible for an institution to ever form to facilitate comparison across the models we use the set of parameters tested in bravo 2011 for the endogenous institution model as our base values table 1 for the additional parameter of the c e model enforcement level we use 50 as the base value monitoring level 0 5 one parameter that we hold fixed throughout all simulations is tolerance threshold in bravo 2011 and vallino 2014 this parameter was allowed to be either low 1 3 b m a x or high 2 3 b m a x however we have observed that simulations with low tolerance threshold often fail to reach a steady state instead current institution and in response the amount of biomass changes constantly throughout the simulation this makes it difficult to discuss the final outcomes of these simulations thus we run all simulations with high tolerance threshold where this phenomenon does not occur we discuss the reasons for this difference in detail at the end of section 5 3 1 in vallino 2014 only a few different parameter sets were tested for the cheating and enforcement model moreover only the outcome of a single run of the model was reported for each parameter set as these abms are stochastic in our sensitivity analysis we run 50 simulations for each parameter set to generate a distribution of outcomes as we show a fixed choice of parameters can produce a great deal of variance in the final outcomes of the models in the works introducing these models simulations were run for 20 000 ticks to ensure the system had reached a steady state however in order to facilitate a large scale study across a broad range of parameters we reduce the computational time by letting each simulation run for only 2 000 ticks in almost all instances this appears sufficient to allow all of the variables of interest to reach an equilibrium exceptions to this such as when the number of initial loggers is very large are discussed later in this section below we discuss four emergent behaviors that we observe in simulations of the c e model the first two of these are not necessarily problematic but are consequences of the rules of the original endogenous institution model pertaining to the replacement mechanism and how loggers update minimal cut the latter two are paradoxical emergent behaviors that raise serious doubts about whether we can learn anything from this model as we will see these are consequences of the model s enforcement mechanism which is to entirely remove any loggers who are caught cheating from a simulation 5 3 1 minimal cut polarization as discussed for most parameter choices each simulation eventually reaches a steady state a point beyond which the state variables of interest vary only within a very narrow range this steady state leads to a phenomenon we call minimal cut polarization as an example consider the simulation depicted in fig 4 even though this is a simulation under the endogenous institution model i e there is no cheating it will be useful to illustrate our point since minimal cut polarization occurs in both the endogenous institution model and the c e model shortly after the last change of current institution in the 17th period the percentage of the initial biomass remaining appears to reach an equilibrium value around 30 living patches similarly appears to reach equilibrium around this point both values deviate only slightly even if the simulation is allowed to continue beyond what is shown in the figure analyzing the percent of biomass remaining at the end of each period from 200 through 2000 the mean of this value is 31 1 and the standard deviation is only 2 7 this suggests that biomass and living patches have reached an equilibrium in the endogenous institution model every logger logs the patch they are on if and only if trees current institution consequently if current institution biomass and living patches are in equilibrium the expected payoff of each logger is the same in each period inevitably then each logger will randomly experience periods with higher and lower payoffs and consequently will for some periods have payoff satisfaction 0 as this occurs if a logger has reference trees greater than the equilibrium value of living patches each time they have payoff satisfaction 0 they will continually raise their minimal cut until it reaches b m a x whereas if a logger has reference trees less than the equilibrium value of living patches they will lower their minimal cut until it reaches zero shown in fig 5 is the number of loggers with a high minimal cut over 9 10 b m a x or a low minimal cut less than 1 10 b m a x for the simulation depicted in fig 4 notice that after 30 periods almost every logger has a high or low minimal cut almost all loggers that are not polarized those with minimal cut that is neither high nor low are loggers that have entered the simulation through the selection mechanism within the last 30 periods this is because these loggers start with minimal cut 0 and if they have a high reference trees it takes time for their minimal cut to increase until it has reached a high minimal cut level in fig 5 loggers that have been around for more than 30 periods and that are not polarized are shown in light purple and account for at most 6 of all loggers in a given period the observed minimal cut polarization helps to explain why some simulations with tolerance threshold 1 3 b m a x fail to reach a steady state consider a simulation of the endogenous institution model with low tolerance threshold since current institution dictates logger behavior the simulation may appear to reach a steady state where current institution and biomass percentage remain constant for several periods due to minimal cut polarization each logger will have their minimal cut approach either 0 or b m a x now consider the following scenario that may evolve under these circumstances suppose that 0 current institution 1 3 b m a x and that eventually 2 3 of loggers have minimal cut near 0 then current institution will decrease until 0 current institution 1 3 b m a x as a result more biomass is removed and so the amount of biomass decreases thus the new equilibrium value of living patches falls below reference trees for many loggers therefore some of these loggers begin to increase minimal cut to b m a x since it must be that b m a x current institution 1 3 b m a x eventually 2 3 of loggers have minimal cut near b m a x thus current institution increases until b m a x current institution 1 3 b m a x then of course biomass and living patches will increase causing some loggers to begin lowering their minimal cut and starting the cycle over again just such a scenario is depicted in fig 6 we can see that current institution oscillates preventing the simulation from reaching a steady state the value of current institution and hence the biomass percentage is much more stable if tolerance threshold 2 3 b m a x since once current institution is in 1 3 b m a x 2 3 b m a x it is impossible for any logger to have minimal cut current institution tolerance threshold 5 3 2 eventually all loggers are identical as referenced when describing minimal cut polarization simulations of both the endogenous institution model and the c e model often reach a point where the current institution is in 1 3 b m a x 2 3 b m a x and the observer state variables are approximately constant at this point all loggers will decide whether to log or cheat based only on the current institution and their recent payoffs consequently minimal cut and reference trees no longer have any relation to logger payoffs therefore every logger is equally likely to be replaced or replicated at the end of each period without a mutation mechanism see section 5 2 3 this is essentially a moran process of neutral mutation moran 1958 if this process is allowed to continue eventually the reference trees of one logger will fixate so that every logger remaining in the simulation has the exact same value for reference trees as a result the mean reference trees at the end of the simulation must be interpreted carefully consider for example the outcome of the simulation of the endogenous institution model reported in vallino 2014 table 2 in which the final average reference trees for all loggers is 0 72 since initially each logger s reference trees is drawn at random from a normal distribution with mean 0 5 and standard deviation 0 25 it is practically certain that the initial average reference trees was less than 0 72 this implies that the average reference trees has increased through the simulation thus it is tempting to conclude that having a high reference trees that is being more environmentally minded confers a selective advantage but this is not the case the final reference trees in this simulation is essentially a randomly chosen value from the reference trees of the loggers at the beginning of the simulation once all the loggers have the same reference trees minimal cut polarization will cause all loggers minimal cut to tend toward the same value as well either 0 or b m a x and all loggers will have the same value of minimal cut and reference trees we note that it does generally take a long time for one logger to fixate in the model sometimes more than 10 000 periods in our simulations with base parameters however since this occurs when minimal cut and reference trees have ceased to be informative about whether loggers will log or cheat it is not necessary to run the model this long to observe other outputs reach an equilibrium e g current institution living patches and biomass 5 3 3 cheating increases final biomass the enforcement mechanism causes a number of paradoxical final outcomes for one the more loggers that cheat throughout a simulation the better the health of the forest measured in terms of b m f the final biomass in bravo 2011 the endogenous institution model which does not allow loggers to cheat was shown to retain an average of 26 3 of forest biomass we would expect introducing logger cheating to decrease b m f as cheating is detrimental to resource conservation instead we find that for the c e model the mean b m f under base parameters given in table 1 increases to 124 i e there are more trees at the end of the simulation than during simulation initialization the increase in final biomass is explained entirely by the removal of cheaters this can be observed by watching the trajectory of a single simulation with a high number of initial loggers in such a simulation biomass plummets immediately and the number of loggers begins to decline biomass remains near zero until the number of loggers reaches a low level and then biomass jumps back up to a well above the original forest biomass level even when we attempt to overwhelm the forest with 1000 loggers biomass eventually recovers if the simulation is allowed to run long enough so that nearly all loggers are removed from the model this is shown in fig 7 note that this is one of the instances in which the simulation must be run for much longer than 2000 ticks in order for the parameters to reach equilibrium this behavior does not follow empirical observations community management systems do not usually suspend the privileges of a majority of users and a depleted forest is unlikely to regenerate without substantial reforestation efforts 5 3 4 the enforcement mechanism makes the endogenous institution irrelevant the results of the sensitivity analysis show that the enforcement mechanism is so severe that it renders most of the other aspects of the model irrelevant as shown in fig 8 every simulation with m o n i t o r i n g l e v e l 0 ends with more biomass than was present at the start of the simulation i e b m f 100 gibson et al find that cbnrm with more monitoring and sanctioning generally have healthier forests gibson et al 2005 and these findings are supported throughout the cbnrm literature cox et al 2010 van laerhoven 2010 thus we would expect a relationship between the specific monitoring level and b m f while it appears this might be the case in fig 8 the significance of this relationship disappears when we condition on the percentage of loggers remaining in the simulation to investigate this more formally we construct a linear model of b m f as a function of loggers remaining the final value of current institution c i f and monitoring level for the simulations in which monitoring level 0 the results shown in table 2 suggest that neither monitoring level nor c i f significantly impact b m f in these simulations instead it is clear that the dominant factor in each simulation is the percentage of loggers remaining in fact there is almost perfect negative correlation between b m f and the percentage of loggers remaining at the end of a simulation ρ 0 993 6 model results and discussion monitoring and sanctioning model in section 5 we outlined the conceptual drawbacks of removing all cheaters from the cheating and enforcement model and identified implementation errors in the model code given these limitations in this section we explore a model with new mechanisms for cheating and enforcement that better represent actual community management systems this is the monitoring and sanctioning m s model that is described in section 3 the m s model inherits all of the entities rules and processes of the c e model but with the revised enforcement mechanisms described in section 3 7 2 notably this means that the m s model does not incorporate any of the modifications proposed in sections section 5 1 2 or 5 1 3 this allows us to directly assess the impact of the revised enforcement mechanism by comparing outcomes of the c e and m s models the errors discussed in sections 5 2 1 and 5 2 2 have been corrected for both models as described in the m s model we introduce a new dynamic logger state variable prob cheat p c which is the probability a logger will cheat if they are unsatisfied each logger starts with p c i n i t i a l p r o b c h e a t and this value is updated independently for each logger as the simulation progresses loggers that are unsatisfied must weigh the consequences of cheating versus not cheating to determine if they should follow institutionrules we assume the probability a logger will cheat depends on the logger s perception of both how likely they are to be caught and the repercussions if they are caught thus each time a logger cheats they update prob cheat according to eq 3 a specific example illustrating how loggers update their beliefs based on recent experience with cheating is given in example 6 1 example 6 1 consider a simulation of the m s model in which i n i t i a l p r o b c h e a t m o n i t o r i n g l e v e l s a n c t i o n l e v e l 1 2 suppose that logger a cheats twice and is caught the second time whereas logger b cheats twice and is caught the first time after logger a cheats and is not caught p c a 1 2 1 1 2 1 2 3 4 after logger a cheats and is caught p c a 3 4 3 4 1 2 3 8 on the other hand after logger b is caught p c b 1 2 1 2 1 2 1 4 however when logger b cheats again and is not caught p c b 1 4 1 1 4 1 2 5 8 although both loggers have cheated twice and have been caught once since logger a was caught and sanctioned more recently p c a p c b 6 1 analysis of the monitoring and sanctioning model we introduce the m s model primarily to improve the conceptual validity of the c e model and to address some of the paradoxical emergent behaviors seen in that model see section 5 we are particularly interested in realistically modeling rule violation and sanctioning in order to reveal the importance of endogenous institutions monitoring and sanctioning in resource conservation to evaluate how well this goal is achieved we again conduct an oat sensitivity analysis the base parameter values and tested values are the same as in table 1 except for initial loggers and the new parameters specific to the m s model the new base parameters and tested parameters are given in table 3 6 1 1 the importance of endogenous institutions in our sensitivity analysis of the c e model most simulations ended with very few loggers because those who were caught cheating were removed from the simulation as a result the final biomass b m f was almost always above 100 the original biomass and so as discussed in section 5 3 4 the final institution c i f did not have a significant impact on b m f in the m s model we now see a strong positive correlation between c i f and b m f under base parameters the correlation between c i f and b m f is ρ 0 774 this indicates that model communities that form a stricter set of rules governing forest logging are more successful at conserving the forest and communities that fail to form adequate rules fail to conserve the forest the positive correlation between c i f and b m f extends to almost all parameter sets tested ρ 0 736 when including all simulation runs fig 9 the notable exceptions are in simulations in which i n i t i a l l o g g e r s is either 60 or 80 in these cases there are simply not enough loggers to deplete the forest and so current institution is irrelevant if we exclude these simulation runs the correlation between c i f and b m f is ρ 0 891 6 1 2 the importance of monitoring and sanctioning one of the main limitations of the c e model was that the enforcement level parameter had no discernible impact on biomass preservation studies have shown that monitoring and sanctioning to enforce community management regulations improve resource conservation cox et al 2010 gibson et al 2005 van laerhoven 2010 this effect is now clearly seen in the m s model to demonstrate this visually in fig 10a we depict just those simulations with monitoring level equal to 0 2 or 0 8 and in fig 10b we depict just those simulations with sanction level equal to 0 2 or 0 8 it is clear from both that for a given value of the final institution c i f higher monitoring or higher sanctioning lead to higher final biomass b m f to compare to our previous regression analysis for the c e model we again construct a linear model this time of b m f as a function of c i f monitoring level and sanction level we use all of the simulations in which the monitoring level and sanction level level are varied while the other parameters are held at base values we do not include the number of loggers remaining since in the m s model no loggers are removed we see now that both monitoring level and sanction level significantly impact b m f see table 4 this also shows that in contrast to the results of section 5 3 3 more cheating as a result of lower sanctions actually decreases biomass as we would expect 6 1 3 results with more dynamic loggers in order to facilitate comparison between the two models when introducing the m s model we only revised the enforcement mechanism of the c e model with the implementation errors corrected however in sections 5 1 2 and 5 1 3 we discussed further reasonable modifications that we could make to try to better capture the behavior of real agents thus we also explored behaviors of the m s model after making these modifications logger movement every logger simply moves once during each tick at the beginning of the tick logger dissatisfaction loggers with p a y o f f old payoff maintain the same payoff satisfaction as in the previous period these small changes result in more dynamic loggers for one they have the potential to log during every tick whereas in the original coding of the m s model a logger that logs in one tick will be located on an empty patch and be unable to log on the next tick they are also more likely to be dissatisfied meaning that they are more likely to change minimal cut cheat and collectively to reach the threshold for changing current institution with these changes we still observe the phenomena discussed in sections 6 1 1 and 6 1 2 but we also observe an even more dramatic illustration of the importance of endogenous institutions recall that reference threshold is a measure of the environmentalism level of the community we might expect any increase in reference threshold to result in an increase in b m f indicating that communities with higher environmentalism levels are better at conserving the forest however a brief inspection of fig 11 shows that this is not the case the reason for this is revealed by considering the number of times the community has met in order to change current institution when a community has low levels of environmentalism r e f e r e n c e t h r e s h o l d 3 they usually meet 1 2 times consequently c i f and therefore b m f which is highly correlated with c i f in the m s model remains low when a community has high levels of environmentalism r e f e r e n c e t h r e s h o l d 6 the community sets a high current institution early in the simulation however because of this they then do not meet again or meet only once more early in the simulation as a result the community fails to increase current institution and the simulation ends with a relatively low c i f in contrast when a community has a moderate level of environmentalism 3 r e f e r e n c e t h r e s h o l d 6 they usually meet at least three times this leads to a high c i f and hence a high b m f these results align with ostrom s findings that consistent meetings are an important component of cbnrm success although there is not a perfect correlation between reference trees and b m f in this model the trend lines in fig 11 uncover a strong relationship between these variables when we condition on the number of meetings within the simulation thus in the m s model while a community s tendency to prioritize environmentalism can influence conservation success the endogenous institution is even more significant than the predisposition of the community 6 2 shortcomings of the monitoring and sanctioning model while the m s model seems to avoid some of the more paradoxical emergent behaviors of the c e model unusual behaviors remain and there are undoubtedly further ways to improve the m s model that would bring outcomes even closer in line with observed community management systems first we note that the rules for updating minimal cut and the replacement mechanism in the m s model are still those inherited from the original endogenous institution model consequently we still see the phenomenon of minimal cut polarization from section 5 3 1 while not necessarily unrealistic this is a noteworthy phenomenon as it helps to explain some of the other outcomes we observe we also continue to see that all loggers eventually have identical reference trees the one static logger state variable as described in section 5 3 2 in an actual common pool resource environment we would expect competitive individuals to continue to adopt innovative ideas and logging behaviors this is a strong argument for implementing the evolutionary mechanism described in bravo 2011 or an even more aggressive version of this mechanism there is also still some oddity in the movement of loggers inherited from the ei and c e models recall that in the move submodel section 3 7 2 a logger will randomly select a neighboring patch to move to from among those patches with trees current institution if no such neighboring patch exists then the logger will simply move to a random neighboring patch it would seem preferable to model logging as a strict objective seeking behavior in which loggers always move to the patch with the greatest number of trees even better may be to specify that the loggers move to a neighboring patch with the greatest number of trees that is not occupied by another logger otherwise even in a simulation with abundant biomass multiple loggers may move to the same patch with trees current institution and then only the first logger to execute the logger tick actions submodel will be able to log the patch another unusual phenomenon in the m s model is that in certain simulations it is the more environmental loggers that are more likely to cheat this is a result of the rules for cheating inherited from the c e model consider for example the cluster of simulations in fig 9 in which c i f 4 and b m f 9 in these simulations c i f 1 3 b m a x 20 3 during such a simulation any logger may cheat due to decreased payoff between rounds however the loggers with the highest values of reference trees will also cheat due to dissatisfaction with the current institution this is again due to minimal cut polarization the loggers with the highest values of reference trees will have their minimal cut approach b m a x so that eventually minimal cut current institution t o l e r a n c e t h r e s h o l d 2 3 b m a x at which point they may cheat it seems strange to have the most environmentally conscious loggers be the ones violating the rules of the endogenous institution while this can perhaps be justified by arguing that the community based management system loses credibility in the eyes of a logger when the rules are too lax it would also make sense to modify this rule so that loggers only cheat when they are on a patch with minimal cut t r e e s current institution that is to modify the rules so that loggers may ignore the institution but not their own personal beliefs about how loggers should behave finally using eq 2 for the probability that a logger that has experienced reduced payoff between periods will become unsatisfied causes some very unusual outcomes in both the c e and m s model to illustrate consider a simulation in which the c o s t which is paid during each of the 10 ticks in a period is equal to 5 if a logger logs 51 trees during one period and 50 trees during the next period then old payoff 1 n e w p a y o f f 0 and the logger will have payoff satisfaction set to 0 with probability 1 according to eq 2 but now suppose that current institution 0 so that there are no rules governing the community and as a result there is very little biomass remaining in the simulation if a logger in this simulation is able to log 1 tree during one period and 0 trees during the next period then old payoff 49 n e w p a y o f f 50 and the logger will only have payoff satisfaction set to 0 with probability 1 99 strangely this means that once the amount of biomass in a simulation is extremely low loggers are very unlikely to be unsatisfied and therefore very unlikely to increase minimal cut still we might think that the loggers will slowly raise minimal cut so that eventually 2 3 of the loggers will have m i n i m a l c u t c u r r e n t i n s t i t u t i o n t o l e r a n c e t h r e s h o l d this would raise current institution reduce logging and possibly allow biomass to recover but the replacement mechanism in the model replaces one of the loggers each period with a new logger with minimal cut 0 thus loggers do not remain in the simulation long enough for loggers with m i n i m a l c u t c u r r e n t i n s t i t u t i o n t o l e r a n c e t h r e s h o l d the scenario above hints at why an institution fails to form in many simulations even though there is very little biomass for example in the simulations represented by the cluster of points near the origin in fig 9 while our proposed modification to payoff satisfaction in section 6 1 3 makes intuitive sense it does not address this issue it is still odd that loggers in a completely depleted forest would be only occasionally unsatisfied and as a result that they would fail to form an endogenous institution a reasonable approach for resolving this issue may be to simply follow occam s razor and assume that any time a logger experiences a reduced payoff or a payoff below a certain threshold they will become unsatisfied 7 conclusion agent based modeling offers a promising method to learn about the dynamic interactions within community management systems and to provide insight into how such dynamics impact resource conservation still in order to interpret the results of these models and draw meaningful conclusions these models must be rigorously evaluated in our sensitivity analysis of the cheating and enforcement model of vallino 2014 we find that in many simulations the enforcement mechanism removes almost all loggers from the simulation which is not an accurate representation of the enforcement procedures found in real world cbnrm additionally the implementation of cheating and enforcement in this model leads to counter intuitive emergent behaviors for example the endogenous institution and rule enforcement do not significantly impact biomass and communities that experience more cheating actually end with higher levels of biomass in fact we find that the number of loggers remaining at the end of a simulation overpowers all other factors one might analyze in the model we discovered the issues with the original cheating and enforcement model through the process of evaludation this process sheds light on ways in which some of these issues might have been avoided during the initial model development in step 1 of the evaludation process section 5 1 we identified some conceptual issues with the model while it is possible to make reasonable arguments for these modeling decisions it is unclear how these decisions were made or if they were necessary to produce certain outcomes for example is there a compelling reason why loggers that experience a decreased payoff should not always be unsatisfied a simpler more robust model might have resulted from developing the model according to the trace framework grimm et al 2014 in which progressively more complex versions of a model are rigorously tested during development and the analysis documented at each step as just one example this framework of model development may have resulted in a simpler mechanism of logger dissatisfaction or at least have made clear the necessity of the current version similarly in step 2 of the evaludation process we identified key errors in the model implementation section 5 2 it is not surprising that there might be coding errors in the implementation of a complex agent based model however we believe that describing the models using the odd overview design concepts details protocol would have greatly reduced the likelihood of errors the odd protocol is well designed to reveal any ways in which the implementation of a model differs from its conceptual design another way to avoid these errors may be to follow the advice of chanda and miller 2018 and to replicate models from the description this process is likely to reveal inconsistencies or ambiguities in the original description and may help to avoid errors being inherited from earlier models as was the case with the lack of an evolutionary mechanism we discussed in section 5 2 3 in steps 3 5 of the evaludation process we examined the c e model output conducted a thorough sensitivity analysis and attempted to corroborate the findings with known patterns and data our analysis shows why it is not enough to simply verify the output of the model as in step 3 of the evaludation process or even to confirm that the output matches expectations as in step 5 for example if we run a simulation of the c e model with no monitoring and then again with a moderate level of monitoring we may conclude that increasing monitoring increases final biomass which is an emergent behavior in line with expectations and known patterns however when we conduct a sensitivity analysis by conducting thousands of simulations over a range of parameters we see that these patterns are not generally observed instead as the regression analysis in table 2 shows once monitoring level 0 the effect of monitoring is entirely explained by the number of loggers we believe this analysis also shows that it is important to observe multiple outputs when considering emergent phenomena even if they are not the primary outputs being modeled in this example the number of loggers was not the primary variable of interest but it explained the effect we observed likewise observing the distribution of minimal cut in fig 5 lead us to conjecture outcomes like that observed in fig 6 in order to improve upon the c e model we proposed a new monitoring and sanctioning model that offered a new set of rules to model logger cheating and institutionenforcement we believe these modifications make the abm more realistic and in closer alignment with ostrom s design principles in addition we repeated the latter steps of the evaludation process with this model by conducting a sensitivity analysis and analyzing emergent behaviors we observe that over a wide range of parameters the institution rules have a direct impact on forest biomass levels leading to a positive correlation between the strictness of institution rules and forest conservation also in contrast to the c e model conditional on final institution increases in monitoring and or sanctioning increase the final biomass thus the model exhibits behaviors more closely in line with the cbnrm literature on real world systems while these results are promising there are still many potential modifications one could make to the m s model to better reflect real world cbnrm systems one potential change is to introduce more agent heterogeneity for example not all individuals respond identically to sanctioning so it may be logical to have each logger have their own randomized sanction level trait additionally in a real cbnrm individuals who have recently been caught cheating may be subjected to increased monitoring which would suggest that loggers could also have their own monitoring level trait that would increase when they are caught cheating finally a logger s probability of cheating could be based on their perception of how fair the institution is thus a logger s prob cheat could be influenced by the number of cheaters in the community as well as how often those cheaters are caught in addition to modifying the model itself one might also expand the breadth of analysis for the m s model during our analysis we focused almost exclusively on biomass levels as a measure of a cbnrm success however social sustainability is just as important as ecological sustainability for cbnrm success in their explorations of the original abms on which the m s model is based vallino and bravo incorporated logger payoff into their analysis similarly in their model of common pool resource use perez and janssen examined both resource health and the proportion of cooperative community members pérez and janssen 2015 future work should provide further analysis of the economic and social indicators in model communities finally we note that one obstacle that we encountered during our analysis was precisely defining when a simulation had reached a steady state as the abms we study are stochastic and have many model outputs random fluctuations in output values are always possible and even if one output appears to reach an equilibrium this is no guarantee that the entire simulation has reached a steady state in our analysis this determination was made qualitatively likewise we found it difficult to evaluate the conceptual foundations of the models without an agreed upon understanding of the time scale of the simulations for example whether it makes sense to have an agent remain in the simulation for thousands of periods or to change the institution every period depends on whether a period corresponds to one day or one year therefore for more consistent analysis we believe it is necessary to develop a principled way to determine when an abm of cbnrm has reached a steady state and to specify a precise time scale in order to calibrate the traits of the agents and the environment credit authorship contribution statement maya lapp conceptualization methodology formal analysis writing original draft writing review editing visualization colby long conceptualization methodology formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix parameters and state variables of the model entities see tables 5 6 7 8 9 10 11 and 12 
24454,in animal communication signals can arise endogenously or in response to cues such as signals by conspecifics when one signal serves dual functions such as in birds that use the same song for mate attraction and territorial defense the underlying reason for a vocalization cannot be determined without direct observations and even then may be hard to discern we present an inhomogeneous self exciting point process model to estimate the underlying reasons for why an individual initiates a signal in our application of these models endogenous signals are assumed to arise at a constant rate but each signal can also instigate self excite additional signals by conspecific individuals when applied to bullfrog rana catesbeiana calls and ovenbird seiurus aurocapilla songs our model performs as well as a homogeneous point process model typically used to describe count data while providing additional detail on the underlying motivations for signals although we apply the models to acoustic signals our model can be applied to any self exciting process and can be extended to include spatiotemporal dynamics in signals keywords acoustic signals self exciting point process inhomogeneous point process model singing behavior song function 1 introduction the evolution of reliable signals in animal communication is governed by fitness benefits accrued by signalers and receivers smith and harper 2003 searcy and nowicki 2005 wells and schwartz 2007 for example the role of acoustic signals in resource acquisition and defense has long been assumed with early ecologists taking it for granted that bird song and other signals are used in mate attraction and territory defense e g howard 1920 tinbergen 1939 nice 1941 as since confirmed by decades of research countersinging chorusing and other aggressive vocal responses are used by songbirds smith 1959 heckenlively 1967 wasserman 1977 yasukawa 1981 anurans wells 1977 gerhardt 1992 orthopterans schatral et al 1984 and primates cowlishaw 1992 among others in territory establishment and defense acoustic signals are also associated with mate attraction leftwich and ritchison 2000 morris et al 2002 wells and schwartz 2007 proppe and ritchison 2008 lohr et al 2013 mate guarding diniz et al 2018 and pair bond maintenance whittingham et al 1997 ham et al 2017 species also use acoustic signals for other functions such as predator deterrence e g pereyra and morton 2010 or as a warning to alert other individuals of predator presence e g halkin 1997 park et al 2004 broadly speaking acoustic signals can be grouped into three classes based on the cause and subject of the signal 1 those that arise endogenously such as widely broadcast bird songs to attract a mate or advertisement calls in anurans 2 those that arise in response to a signal by a different individual such as countersinging or chorusing to defend territorial boundaries and 3 those that arise due to a stimulus external to both the signaler and receiver such as presence of a predator smith and harper 1995 we will focus on the first two classes since they involve only intraspecific interactions searcy and nowicki 2005 and they rely on self reporting instead of information external to the signaler and receiver making them relatively predictable based on the evolutionary history of the system that led to these signals being reliable smith and harper 1995 for example one can predict how frequently a male songbird should sing to attract a mate or to defend territorial boundaries based on costs and benefits of the signal but it is harder to predict the occurrence of alarm calls without knowing whether or not there is a cue i e a nearby predator when the underlying reasons for an acoustic signal are known it is possible to model and predict not only the pattern of signals e g dawson and efford 2009 but also the patterns of behavior associated with the signals e g byers 2007 upham mills et al 2020 for species with multi signal repertoires where signal types are associated with specific behaviors ascertaining the underlying reason for a signal can be done by linking signals to observed behaviors for example observations of songbirds have been used to determine which song types or elements e g buzzes trills are linked to territoriality and which to mate attraction trillo and vehrencamp 2005 proppe and ritchison 2008 lohr et al 2013 similarly some anurans alter the frequency with which they combine call types e g whines chucks to attract females when perceived predation risk is high bosch et al 2000 when a signal type is used for multiple behaviors however the reason for any given signal requires direct observation of the individual at the time it occurs leftwich and ritchison 2000 to make behavioral inferences for species with such signals or for which the functional role is unknown researchers either need detailed field observations which may be impossible to obtain and are often subject to detection bias and observation error or a modeling framework that partitions the underlying behavioral processes and estimates their parameters separately to break behavioral patterns into their component parts researchers can use a class of self exciting point process models hawkes 1971 a specific case of an inhomogeneous point process in situations where the history of the process predicts future events these methods have been used in a wide variety of settings such as to understand the occurrence of earthquakes e g türkyilmaz et al 2013 fox et al 2016 infectious disease transmission and outbreaks e g meyer et al 2012 kim et al 2019 schoenberg et al 2019 or the behavior of financial market traders e g hewlett 2006 bowsher 2007 chavez demoulin and mcgill 2012 bacry et al 2015 here we present a self exciting point process model that can be used to estimate whether a given signal arises unprompted or in response to a conspecific signal we illustrate the model using case studies of intraspecific signals in frogs and songbirds and demonstrate how the models can be used to test hypotheses about underlying reasons for signals 2 materials and methods 2 1 model self exciting point process models hawkes 1971 are used to model counting events that arise from an inconsistent rate that varies with the history of events models in this class assume some intrinsic background rate of event occurrence and that when an event occurs it incites or self excites additional occurrences of that event for example an earthquake triggers aftershocks that are spatially and temporally linked vere jones 1970 and buyer behavior in stock markets is influenced by other buyers decisions hewlett 2006 depending on the nature of the process generating the events however over time the self exciting nature of the process declines and additional event occurrences cease until a new instance of the event hawkes 1971 classical self exciting point process models hawkes 1971 and their extensions treat time as a continuous process and estimate the instantaneous rate of events in many systems it is more feasible to treat time as discrete and to only consider the influence of events in previous time bins for example although biological processes operate in continuous time data measurements and analysis are often done in discrete time due to logistical constraints in recording observations kass et al 2011 in such cases the true distribution of the data is assumed to arise from a continuous process but the observed data are not thus researchers often create time bins that are sufficiently small to only capture either 0 or 1 signals and model the observed data using a discrete time logistic approximation these types of extensions of the general class of self exciting point process models make fitting the models more feasible for a broad range of biological processes with different observational challenges that make continuous time recordings difficult or impossible in our model fig 1 we treat time as discrete with sufficiently small time bins to only include either 0 or 1 observed signals due to observation error and limitations of data measurement see below for recording details we assume the true distribution of signals arises from a poisson process and more than one simultaneous signal can occur in a time bin but cannot be distinguished thus the occurrence of one or more signals at time t arises from a poisson process with a variable rate λ t eq 1 that describes the overall rate of signals in the system this rate λ t in turn depends on an intrinsic background rate of the signal process μ and a conditional intensity at time t γ t based on the history of signals prior to t eq 2 the background rate μ is assumed to be constant and is modeled with uninformative priors eqs 4 8 in situations where data could inform μ additional parameters and covariates could be used to estimate it the conditional intensity γ t is modeled as a function of individual motivation to respond to a signal the self excitement parameter α based on memory of the history of signals η t which decays at an exponential rate based on the memory kernel β eq 3 we specified an exponential rate of decay based on models of animal forgetting that assume exponential decay in memory and response to signals speed 2000 however alternative specifications of the memory kernel could be used the self excitement parameter α and memory kernel β are drawn from uninformative gamma distributions that have been truncated at arbitrary maxima that represent biologically implausible scenarios eqs 9 and 10 the history of the process ηt is a vector of time differences between the current time t and event occurrences in previous time steps leading up to time t i e ηt t t i t we restrict the history based on the memory m of the process where m is a constant that is determined based on biological assumptions of the system thus t i is indexed starting from i t m for all times t m times t m are indexed starting from i 1 by setting a limit on the maximum memory m of the process this restricts the window of previous events that can influence signals at the current time step t signals from all previous time bins could be modeled but the inclusion of this cutoff reduces computational intensity by fixing the influence of signals outside the memory to zero rather than estimating many infinitesimally small values 1 y t pois λ t 2 λ t μ γ t 3 γ t i t i m t i t e β η t i t 4 μ gamma k θ 5 k x 2 σ 2 6 θ x σ 2 7 x unif 0 100 8 σ unif 0 100 9 α gamma 0 0001 0 0001 0 0001 1 10 β gamma 0 0001 0 0001 0 0001 5 the underlying processes governing when events occur μ and γ t correspond to the first two classes of behavior described earlier a background level of signals such as those used to attract a mate and responsive signals such as countersinging the background rate μ arises endogenously with no influence of previous signals from conspecifics it could however be modeled based on environmental factors that influence mate attraction in systems where these factors are hypothesized or known the conditional intensity γ t depends on the history of the process representing signals by conspecifics that increase the probability that an individual responds with a new signal that does not arise endogenously by separating these processes self exciting point process models hawkes 1971 let us make predictions about factors that affect behavioral processes and understand why signals occur when they do and for what reasons this ability sets them apart from homogenous point process models which are commonly used to describe count data such as songs e g byers 2007 upham mills et al 2020 that do not distinguish the underlying reasons for a signal 2 2 applications of the model to empirical case studies to illustrate use of our model we applied it to two acoustic signal datasets the first dataset consists of times when american bullfrogs rana catesbeiana initiated calls in a single pond in eastern connecticut usa during the 2006 and 2007 breeding seasons calls were collected with an autonomous continually recording unit placed nightly in a new randomly selected position around the 135 m perimeter of the study pond and each call was automatically detected with the song scope bioacoustics software version 2 4 ingranat 2007 2009 see herrick et al 2018 for detailed data collection methods for the second dataset we sampled singing behavior of male ovenbirds seiurus aurocapilla using autonomous recording units in 15 connecticut forest fragments ranging in size from 19 to 1014 ha during the 2017 and 2019 breeding seasons within each forest fragment observers made 3 7 recordings mean 5 81 sd 1 04 at different points within the fragment each separated from every other point by several hundred meters due to habitat heterogeneity within forest fragments not all points included ovenbirds and these recordings were not included in this study the recordings are repeated samples of the same forest fragment on the same day but include different individual birds each recording began with a human voice interruption that reset the process ensuring that the first signal recorded was endogenous and not influenced by previous signals recordings lasted eight minutes thus variation in rates of signals over the course of the day were not a concern within each recording the start time of every ovenbird song from each recording was manually transcribed and measured to the nearest 0 5 second to produce a discrete time series of songs in time bins of 0 5 s if two songs were initiated simultaneously we could not detect this in the recording and thus each time bin consisted of either a 0 or 1 indicating if a signal was initiated we measured all signals captured by the recording device however there may be edge effects zhuang et al 2004 introduced by individuals that were vocalizing outside the range of the recording device and that influenced signals by individuals which we did detect we analyzed data from each forest fragment separately because each site is physically separated from the others by sufficient distance to represent independent groups of ovenbirds during the breeding season 2 3 model performance and applications to test model performance we compared predictive ability of the self exciting point process models to that of homogenous point process models for each time series we fit both models in a hierarchical framework with uninformative priors in r 3 5 1 r core team 2018 using r2jags 0 6 1 su and yajima 2015 and simulated time series with the estimated parameters see appendix a for code we ran three mcmc chains and assessed convergence using the potential scale reduction factor r with a cutoff of 1 1 gelman and rubin 1992 brooks and gelman 1998 as a benchmark to compare performance of our model and the homogenous model we assessed correspondence between the simulated time series from each model and the observed time series we calculated the mean and 90 credible intervals for the difference in total number of estimated vocalizations in the simulated time series from each model compared to the observed vocalizations the unique features of our model can be used to test hypotheses about the underlying causes of signals for example large forest patches represent high quality habitat for forest interior songbirds such as ovenbirds resulting in higher densities porneluzi et al 1993 and thus greater motivation for territorial males to respond to the songs of neighbors leftwich and ritchison 2000 to demonstrate this potential application of the model we fit generalized linear models with a gamma response distribution and identity link to the background rate of singing μ which must always be positive and is assumed to be nonzero in response to time in the breeding season x for both large forests and small forests eqs 11 and 12 with uniformative priors eqs 13 15 note that although the background rate of singing μ is shared between these models and the model described earlier the parameters α β k and covariate x are distinct and symbols are only recycled for consistency with conventions 11 μ gamma k k e p 12 p α β x 13 α n 0 0 0001 14 β n 0 0 0001 15 k unif 0 500 3 results there were no differences in the total number of vocalizations predicted by our model and homogenous models for either bullfrogs or ovenbirds fig 2 a d both models over and under predicted total vocalizations at similar rates fig 2e with slight underestimates on average mean differences in the number of bullfrog calls predicted and observed was 1 05 calls se 0 11 for our model and 0 83 calls se 0 18 for homogenous models for ovenbird songs averaged across all sites the mean difference was 0 66 songs se 0 02 for our model and 0 58 songs se 0 03 for the homogenous models our models show that the mean proportion of the overall signaling rate explained by conditional intensity i e countersinging in response to conspecifics was 0 55 se 6 59e 04 for bullfrog calls and ranged from 0 02 to 0 59 for ovenbird songs depending on site with an overall average across all sites of 0 33 se 3 95e 04 this proportion is based on the relative weight at each time step t of the background rate of singing and the conditional intensity based on the history of signals leading up to time t our analyses suggest a decline in the background rate μ of singing in larger forest fragments over the course of the breeding season fig 3 with an estimated slope of 0 04 μ ha 90 ci 0 05 0 03 the background rate μ remains constant in smaller fragments throughout the breeding season however with an estimated slope of 0 01 μ ha and a credible interval that overlaps zero 90 ci 0 03 0 02 indicating no directional effect of time in the breeding season within smaller forest fragments 4 discussion the primary strength of our model is its ability to partition the processes generating acoustic signals into those that arise endogenously measured as the background rate and those that arise in response to conspecific signals measured as the conditional intensity this partitioning enables researchers to make predictions about environmental factors that affect these separate classes of signals which can help identify tradeoffs that govern when animals expend energy to emit different types of signals in our bird song case study for example we were able to determine how the extent to which songs are used for territory establishment and mate attraction i e the background rate of singing change over the course of the breeding season in high quality large forests and low quality small forests breeding habitat parameter outputs of the model could also be used to determine when bird singing shifts from one purpose to another over time or if males in habitats with low resource availability allocate more time to countersinging than males in areas with high resource availability our models can distinguish between unprompted singing and responses to conspecific signals e g territory defense which provides substantial improvements over simple homogenous point process models in our ability to make behavioral inferences from acoustic signal datasets that our model performed similarly to the homogenous point process model suggests that there is no performance cost associated with these gains in interpretation determining the proper form of the memory kernel is critical for model interpretation self exciting point process models are sensitive to misspecification which can result in biased estimates of the magnitude and timescale of influence of self excitement on the process reinhart and greenhouse 2018 thus it is important to consider the biology of the system when specifying the memory kernel we implemented an exponential memory kernel because animal forgetting is assumed to decay exponentially based on experimental studies speed 2000 however this may not be a good assumption for many questions for example responses that arise from linked network interactions such as the spread of infectious disease within a wild population meyer and held 2014 or long lasting neuron memory kauer and malenka 2007 may be better modeled with a power law decay function similarly spread of signals within a socially complex system e g non human primates may be better modeled with a power law decay function due to the strong ties between individuals sueur et al 2011 researchers adapting the model should consider alternative specifications of the memory kernel appropriate to their system including those which include a spatial component in our case study we extended the model to test hypotheses about the effects of forest size and time in the breeding season on the rate of background singing many extensions are possible depending on what additional information researchers have about the system and what hypotheses are being tested because our model can be fit in a hierarchical structure and all components are modular it can be adapted to a wide range of behaviors hypotheses about what influences those behaviors and systems with vastly different characteristics for example where pairing status is known and mate attraction can be ruled out for signals produced by paired males i e no extra pair mate attraction one could incorporate this information into the background singing rate μ to more precisely estimate the probability that any given song is a response to a conspecific signal similarly some environmental factors can be allowed to influence only the background rate of singing or only the conditional intensity depending on the biology of the system being modeled we did not test any hypotheses with the bullfrog call data however this second case study demonstrates that the models are flexible and can be applied to systems with orders of magnitude more acoustic signals per time period than our bird case study the models could also be extended to incorporate information about the spatial structure of signals our model assumes that all individuals within the area being sampled are equally likely to respond to all others however this is unlikely to be an accurate assumption simpson 1985 for example individuals may have higher motivation to respond to close neighbors than to distant neighbors or to strangers rather than to known neighbors galeotti and pavan 1993 in our case study we were unable to identify the spatial history of signals because all recordings were done from a single point and we were thus unable to account for edge effects introduced by individuals signaling from outside the range of the recording unit when the spatial arrangement of individual songs is known however the spatial history of signals could be incorporated into the models reinhart 2018 in many animal systems the location of each signal could be determined through arrays of recording units mennill et al 2012 or if individuals are highly territorial and territory boundaries are mapped through other means such as visual surveys in these cases where the spatial history of signals is known alternative specifications of the memory kernel that include both a time decay and a spatial decay can be used to predict not only when and why a signal would occur but also where in the landscape our model is only one of many inhomogeneous point process models that could be used to analyze behavioral signal patterns the value of our modeling approach is in the simplicity of the framework that relies only on the signals themselves to make behavioral inferences though contextual data can improve inferences based on the models and be used to test hypotheses about the underlying processes generating the signals this simple framework can easily incorporate additional information about a system to improve inferences about the underlying reasons for signals although we have only applied the models to acoustic data they could be applied to any class of animal communication that is initiated both endogenously and in response to others for example the models could be applied to displays in lekking species e g gibson and bradbury 1985 or to any type of coordinated visual display e g buck and buck 1968 because self exciting point process models provide a means for separating signal patterns into different behavioral components they provide an opportunity to study behavioral trade offs and factors influencing when and why animals signal and countersignal funding this work was supported by the great hollow nature preserve and ecological research center the goldring field research fund at uconn funded by the goldring family foundation and the national science foundation grant number deb 1557086 oia 2019528 data accessibility all data code to fit the models and test model fit are archived at https doi org 10 5281 zenodo 6377992 grames et al 2022 credit authorship contribution statement eliza m grames conceptualization methodology software validation formal analysis data curation writing original draft visualization funding acquisition piper l stepule methodology investigation data curation writing review editing susan z herrick resources data curation writing review editing benjamin t ranelli conceptualization writing review editing chris s elphick conceptualization resources writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank two anonymous reviewers sam apgar colin carlson andrew stillman morgan tingley and the uconn ornithology group for helpful comments on earlier versions of this manuscript we are grateful to great hollow nature preserve and ecological research center the goldring family foundation the university of connecticut s natural resources conservation academy and the national science foundation for funding to support this project we also thank the association of field ornithologists and wilson ornithological society for conference travel funding to support emg to discuss this work supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2022 109965 appendix a supplementary materials image application 1 
24454,in animal communication signals can arise endogenously or in response to cues such as signals by conspecifics when one signal serves dual functions such as in birds that use the same song for mate attraction and territorial defense the underlying reason for a vocalization cannot be determined without direct observations and even then may be hard to discern we present an inhomogeneous self exciting point process model to estimate the underlying reasons for why an individual initiates a signal in our application of these models endogenous signals are assumed to arise at a constant rate but each signal can also instigate self excite additional signals by conspecific individuals when applied to bullfrog rana catesbeiana calls and ovenbird seiurus aurocapilla songs our model performs as well as a homogeneous point process model typically used to describe count data while providing additional detail on the underlying motivations for signals although we apply the models to acoustic signals our model can be applied to any self exciting process and can be extended to include spatiotemporal dynamics in signals keywords acoustic signals self exciting point process inhomogeneous point process model singing behavior song function 1 introduction the evolution of reliable signals in animal communication is governed by fitness benefits accrued by signalers and receivers smith and harper 2003 searcy and nowicki 2005 wells and schwartz 2007 for example the role of acoustic signals in resource acquisition and defense has long been assumed with early ecologists taking it for granted that bird song and other signals are used in mate attraction and territory defense e g howard 1920 tinbergen 1939 nice 1941 as since confirmed by decades of research countersinging chorusing and other aggressive vocal responses are used by songbirds smith 1959 heckenlively 1967 wasserman 1977 yasukawa 1981 anurans wells 1977 gerhardt 1992 orthopterans schatral et al 1984 and primates cowlishaw 1992 among others in territory establishment and defense acoustic signals are also associated with mate attraction leftwich and ritchison 2000 morris et al 2002 wells and schwartz 2007 proppe and ritchison 2008 lohr et al 2013 mate guarding diniz et al 2018 and pair bond maintenance whittingham et al 1997 ham et al 2017 species also use acoustic signals for other functions such as predator deterrence e g pereyra and morton 2010 or as a warning to alert other individuals of predator presence e g halkin 1997 park et al 2004 broadly speaking acoustic signals can be grouped into three classes based on the cause and subject of the signal 1 those that arise endogenously such as widely broadcast bird songs to attract a mate or advertisement calls in anurans 2 those that arise in response to a signal by a different individual such as countersinging or chorusing to defend territorial boundaries and 3 those that arise due to a stimulus external to both the signaler and receiver such as presence of a predator smith and harper 1995 we will focus on the first two classes since they involve only intraspecific interactions searcy and nowicki 2005 and they rely on self reporting instead of information external to the signaler and receiver making them relatively predictable based on the evolutionary history of the system that led to these signals being reliable smith and harper 1995 for example one can predict how frequently a male songbird should sing to attract a mate or to defend territorial boundaries based on costs and benefits of the signal but it is harder to predict the occurrence of alarm calls without knowing whether or not there is a cue i e a nearby predator when the underlying reasons for an acoustic signal are known it is possible to model and predict not only the pattern of signals e g dawson and efford 2009 but also the patterns of behavior associated with the signals e g byers 2007 upham mills et al 2020 for species with multi signal repertoires where signal types are associated with specific behaviors ascertaining the underlying reason for a signal can be done by linking signals to observed behaviors for example observations of songbirds have been used to determine which song types or elements e g buzzes trills are linked to territoriality and which to mate attraction trillo and vehrencamp 2005 proppe and ritchison 2008 lohr et al 2013 similarly some anurans alter the frequency with which they combine call types e g whines chucks to attract females when perceived predation risk is high bosch et al 2000 when a signal type is used for multiple behaviors however the reason for any given signal requires direct observation of the individual at the time it occurs leftwich and ritchison 2000 to make behavioral inferences for species with such signals or for which the functional role is unknown researchers either need detailed field observations which may be impossible to obtain and are often subject to detection bias and observation error or a modeling framework that partitions the underlying behavioral processes and estimates their parameters separately to break behavioral patterns into their component parts researchers can use a class of self exciting point process models hawkes 1971 a specific case of an inhomogeneous point process in situations where the history of the process predicts future events these methods have been used in a wide variety of settings such as to understand the occurrence of earthquakes e g türkyilmaz et al 2013 fox et al 2016 infectious disease transmission and outbreaks e g meyer et al 2012 kim et al 2019 schoenberg et al 2019 or the behavior of financial market traders e g hewlett 2006 bowsher 2007 chavez demoulin and mcgill 2012 bacry et al 2015 here we present a self exciting point process model that can be used to estimate whether a given signal arises unprompted or in response to a conspecific signal we illustrate the model using case studies of intraspecific signals in frogs and songbirds and demonstrate how the models can be used to test hypotheses about underlying reasons for signals 2 materials and methods 2 1 model self exciting point process models hawkes 1971 are used to model counting events that arise from an inconsistent rate that varies with the history of events models in this class assume some intrinsic background rate of event occurrence and that when an event occurs it incites or self excites additional occurrences of that event for example an earthquake triggers aftershocks that are spatially and temporally linked vere jones 1970 and buyer behavior in stock markets is influenced by other buyers decisions hewlett 2006 depending on the nature of the process generating the events however over time the self exciting nature of the process declines and additional event occurrences cease until a new instance of the event hawkes 1971 classical self exciting point process models hawkes 1971 and their extensions treat time as a continuous process and estimate the instantaneous rate of events in many systems it is more feasible to treat time as discrete and to only consider the influence of events in previous time bins for example although biological processes operate in continuous time data measurements and analysis are often done in discrete time due to logistical constraints in recording observations kass et al 2011 in such cases the true distribution of the data is assumed to arise from a continuous process but the observed data are not thus researchers often create time bins that are sufficiently small to only capture either 0 or 1 signals and model the observed data using a discrete time logistic approximation these types of extensions of the general class of self exciting point process models make fitting the models more feasible for a broad range of biological processes with different observational challenges that make continuous time recordings difficult or impossible in our model fig 1 we treat time as discrete with sufficiently small time bins to only include either 0 or 1 observed signals due to observation error and limitations of data measurement see below for recording details we assume the true distribution of signals arises from a poisson process and more than one simultaneous signal can occur in a time bin but cannot be distinguished thus the occurrence of one or more signals at time t arises from a poisson process with a variable rate λ t eq 1 that describes the overall rate of signals in the system this rate λ t in turn depends on an intrinsic background rate of the signal process μ and a conditional intensity at time t γ t based on the history of signals prior to t eq 2 the background rate μ is assumed to be constant and is modeled with uninformative priors eqs 4 8 in situations where data could inform μ additional parameters and covariates could be used to estimate it the conditional intensity γ t is modeled as a function of individual motivation to respond to a signal the self excitement parameter α based on memory of the history of signals η t which decays at an exponential rate based on the memory kernel β eq 3 we specified an exponential rate of decay based on models of animal forgetting that assume exponential decay in memory and response to signals speed 2000 however alternative specifications of the memory kernel could be used the self excitement parameter α and memory kernel β are drawn from uninformative gamma distributions that have been truncated at arbitrary maxima that represent biologically implausible scenarios eqs 9 and 10 the history of the process ηt is a vector of time differences between the current time t and event occurrences in previous time steps leading up to time t i e ηt t t i t we restrict the history based on the memory m of the process where m is a constant that is determined based on biological assumptions of the system thus t i is indexed starting from i t m for all times t m times t m are indexed starting from i 1 by setting a limit on the maximum memory m of the process this restricts the window of previous events that can influence signals at the current time step t signals from all previous time bins could be modeled but the inclusion of this cutoff reduces computational intensity by fixing the influence of signals outside the memory to zero rather than estimating many infinitesimally small values 1 y t pois λ t 2 λ t μ γ t 3 γ t i t i m t i t e β η t i t 4 μ gamma k θ 5 k x 2 σ 2 6 θ x σ 2 7 x unif 0 100 8 σ unif 0 100 9 α gamma 0 0001 0 0001 0 0001 1 10 β gamma 0 0001 0 0001 0 0001 5 the underlying processes governing when events occur μ and γ t correspond to the first two classes of behavior described earlier a background level of signals such as those used to attract a mate and responsive signals such as countersinging the background rate μ arises endogenously with no influence of previous signals from conspecifics it could however be modeled based on environmental factors that influence mate attraction in systems where these factors are hypothesized or known the conditional intensity γ t depends on the history of the process representing signals by conspecifics that increase the probability that an individual responds with a new signal that does not arise endogenously by separating these processes self exciting point process models hawkes 1971 let us make predictions about factors that affect behavioral processes and understand why signals occur when they do and for what reasons this ability sets them apart from homogenous point process models which are commonly used to describe count data such as songs e g byers 2007 upham mills et al 2020 that do not distinguish the underlying reasons for a signal 2 2 applications of the model to empirical case studies to illustrate use of our model we applied it to two acoustic signal datasets the first dataset consists of times when american bullfrogs rana catesbeiana initiated calls in a single pond in eastern connecticut usa during the 2006 and 2007 breeding seasons calls were collected with an autonomous continually recording unit placed nightly in a new randomly selected position around the 135 m perimeter of the study pond and each call was automatically detected with the song scope bioacoustics software version 2 4 ingranat 2007 2009 see herrick et al 2018 for detailed data collection methods for the second dataset we sampled singing behavior of male ovenbirds seiurus aurocapilla using autonomous recording units in 15 connecticut forest fragments ranging in size from 19 to 1014 ha during the 2017 and 2019 breeding seasons within each forest fragment observers made 3 7 recordings mean 5 81 sd 1 04 at different points within the fragment each separated from every other point by several hundred meters due to habitat heterogeneity within forest fragments not all points included ovenbirds and these recordings were not included in this study the recordings are repeated samples of the same forest fragment on the same day but include different individual birds each recording began with a human voice interruption that reset the process ensuring that the first signal recorded was endogenous and not influenced by previous signals recordings lasted eight minutes thus variation in rates of signals over the course of the day were not a concern within each recording the start time of every ovenbird song from each recording was manually transcribed and measured to the nearest 0 5 second to produce a discrete time series of songs in time bins of 0 5 s if two songs were initiated simultaneously we could not detect this in the recording and thus each time bin consisted of either a 0 or 1 indicating if a signal was initiated we measured all signals captured by the recording device however there may be edge effects zhuang et al 2004 introduced by individuals that were vocalizing outside the range of the recording device and that influenced signals by individuals which we did detect we analyzed data from each forest fragment separately because each site is physically separated from the others by sufficient distance to represent independent groups of ovenbirds during the breeding season 2 3 model performance and applications to test model performance we compared predictive ability of the self exciting point process models to that of homogenous point process models for each time series we fit both models in a hierarchical framework with uninformative priors in r 3 5 1 r core team 2018 using r2jags 0 6 1 su and yajima 2015 and simulated time series with the estimated parameters see appendix a for code we ran three mcmc chains and assessed convergence using the potential scale reduction factor r with a cutoff of 1 1 gelman and rubin 1992 brooks and gelman 1998 as a benchmark to compare performance of our model and the homogenous model we assessed correspondence between the simulated time series from each model and the observed time series we calculated the mean and 90 credible intervals for the difference in total number of estimated vocalizations in the simulated time series from each model compared to the observed vocalizations the unique features of our model can be used to test hypotheses about the underlying causes of signals for example large forest patches represent high quality habitat for forest interior songbirds such as ovenbirds resulting in higher densities porneluzi et al 1993 and thus greater motivation for territorial males to respond to the songs of neighbors leftwich and ritchison 2000 to demonstrate this potential application of the model we fit generalized linear models with a gamma response distribution and identity link to the background rate of singing μ which must always be positive and is assumed to be nonzero in response to time in the breeding season x for both large forests and small forests eqs 11 and 12 with uniformative priors eqs 13 15 note that although the background rate of singing μ is shared between these models and the model described earlier the parameters α β k and covariate x are distinct and symbols are only recycled for consistency with conventions 11 μ gamma k k e p 12 p α β x 13 α n 0 0 0001 14 β n 0 0 0001 15 k unif 0 500 3 results there were no differences in the total number of vocalizations predicted by our model and homogenous models for either bullfrogs or ovenbirds fig 2 a d both models over and under predicted total vocalizations at similar rates fig 2e with slight underestimates on average mean differences in the number of bullfrog calls predicted and observed was 1 05 calls se 0 11 for our model and 0 83 calls se 0 18 for homogenous models for ovenbird songs averaged across all sites the mean difference was 0 66 songs se 0 02 for our model and 0 58 songs se 0 03 for the homogenous models our models show that the mean proportion of the overall signaling rate explained by conditional intensity i e countersinging in response to conspecifics was 0 55 se 6 59e 04 for bullfrog calls and ranged from 0 02 to 0 59 for ovenbird songs depending on site with an overall average across all sites of 0 33 se 3 95e 04 this proportion is based on the relative weight at each time step t of the background rate of singing and the conditional intensity based on the history of signals leading up to time t our analyses suggest a decline in the background rate μ of singing in larger forest fragments over the course of the breeding season fig 3 with an estimated slope of 0 04 μ ha 90 ci 0 05 0 03 the background rate μ remains constant in smaller fragments throughout the breeding season however with an estimated slope of 0 01 μ ha and a credible interval that overlaps zero 90 ci 0 03 0 02 indicating no directional effect of time in the breeding season within smaller forest fragments 4 discussion the primary strength of our model is its ability to partition the processes generating acoustic signals into those that arise endogenously measured as the background rate and those that arise in response to conspecific signals measured as the conditional intensity this partitioning enables researchers to make predictions about environmental factors that affect these separate classes of signals which can help identify tradeoffs that govern when animals expend energy to emit different types of signals in our bird song case study for example we were able to determine how the extent to which songs are used for territory establishment and mate attraction i e the background rate of singing change over the course of the breeding season in high quality large forests and low quality small forests breeding habitat parameter outputs of the model could also be used to determine when bird singing shifts from one purpose to another over time or if males in habitats with low resource availability allocate more time to countersinging than males in areas with high resource availability our models can distinguish between unprompted singing and responses to conspecific signals e g territory defense which provides substantial improvements over simple homogenous point process models in our ability to make behavioral inferences from acoustic signal datasets that our model performed similarly to the homogenous point process model suggests that there is no performance cost associated with these gains in interpretation determining the proper form of the memory kernel is critical for model interpretation self exciting point process models are sensitive to misspecification which can result in biased estimates of the magnitude and timescale of influence of self excitement on the process reinhart and greenhouse 2018 thus it is important to consider the biology of the system when specifying the memory kernel we implemented an exponential memory kernel because animal forgetting is assumed to decay exponentially based on experimental studies speed 2000 however this may not be a good assumption for many questions for example responses that arise from linked network interactions such as the spread of infectious disease within a wild population meyer and held 2014 or long lasting neuron memory kauer and malenka 2007 may be better modeled with a power law decay function similarly spread of signals within a socially complex system e g non human primates may be better modeled with a power law decay function due to the strong ties between individuals sueur et al 2011 researchers adapting the model should consider alternative specifications of the memory kernel appropriate to their system including those which include a spatial component in our case study we extended the model to test hypotheses about the effects of forest size and time in the breeding season on the rate of background singing many extensions are possible depending on what additional information researchers have about the system and what hypotheses are being tested because our model can be fit in a hierarchical structure and all components are modular it can be adapted to a wide range of behaviors hypotheses about what influences those behaviors and systems with vastly different characteristics for example where pairing status is known and mate attraction can be ruled out for signals produced by paired males i e no extra pair mate attraction one could incorporate this information into the background singing rate μ to more precisely estimate the probability that any given song is a response to a conspecific signal similarly some environmental factors can be allowed to influence only the background rate of singing or only the conditional intensity depending on the biology of the system being modeled we did not test any hypotheses with the bullfrog call data however this second case study demonstrates that the models are flexible and can be applied to systems with orders of magnitude more acoustic signals per time period than our bird case study the models could also be extended to incorporate information about the spatial structure of signals our model assumes that all individuals within the area being sampled are equally likely to respond to all others however this is unlikely to be an accurate assumption simpson 1985 for example individuals may have higher motivation to respond to close neighbors than to distant neighbors or to strangers rather than to known neighbors galeotti and pavan 1993 in our case study we were unable to identify the spatial history of signals because all recordings were done from a single point and we were thus unable to account for edge effects introduced by individuals signaling from outside the range of the recording unit when the spatial arrangement of individual songs is known however the spatial history of signals could be incorporated into the models reinhart 2018 in many animal systems the location of each signal could be determined through arrays of recording units mennill et al 2012 or if individuals are highly territorial and territory boundaries are mapped through other means such as visual surveys in these cases where the spatial history of signals is known alternative specifications of the memory kernel that include both a time decay and a spatial decay can be used to predict not only when and why a signal would occur but also where in the landscape our model is only one of many inhomogeneous point process models that could be used to analyze behavioral signal patterns the value of our modeling approach is in the simplicity of the framework that relies only on the signals themselves to make behavioral inferences though contextual data can improve inferences based on the models and be used to test hypotheses about the underlying processes generating the signals this simple framework can easily incorporate additional information about a system to improve inferences about the underlying reasons for signals although we have only applied the models to acoustic data they could be applied to any class of animal communication that is initiated both endogenously and in response to others for example the models could be applied to displays in lekking species e g gibson and bradbury 1985 or to any type of coordinated visual display e g buck and buck 1968 because self exciting point process models provide a means for separating signal patterns into different behavioral components they provide an opportunity to study behavioral trade offs and factors influencing when and why animals signal and countersignal funding this work was supported by the great hollow nature preserve and ecological research center the goldring field research fund at uconn funded by the goldring family foundation and the national science foundation grant number deb 1557086 oia 2019528 data accessibility all data code to fit the models and test model fit are archived at https doi org 10 5281 zenodo 6377992 grames et al 2022 credit authorship contribution statement eliza m grames conceptualization methodology software validation formal analysis data curation writing original draft visualization funding acquisition piper l stepule methodology investigation data curation writing review editing susan z herrick resources data curation writing review editing benjamin t ranelli conceptualization writing review editing chris s elphick conceptualization resources writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank two anonymous reviewers sam apgar colin carlson andrew stillman morgan tingley and the uconn ornithology group for helpful comments on earlier versions of this manuscript we are grateful to great hollow nature preserve and ecological research center the goldring family foundation the university of connecticut s natural resources conservation academy and the national science foundation for funding to support this project we also thank the association of field ornithologists and wilson ornithological society for conference travel funding to support emg to discuss this work supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2022 109965 appendix a supplementary materials image application 1 
