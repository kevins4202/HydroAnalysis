index,text
20625,this paper presents a finite time velocity observed based adaptive output feedback trajectory tracking formation control for underactuated unmanned underwater vehicles uuvs with prescribed transient performance for realistic dynamical uuv model we assume that the mass and damping matrices are off diagonal and only partial information about hydrodynamics is known and we simultaneously consider the problems of input saturation unmeasured velocity external disturbance and prescribed performance to design formation controller for this purpose a leader follower pattern is employed where each follower tracks its reference trajectory defined by the leader position and predetermined formation without requirement of leader velocity moreover a finite time velocity observer is constructed by utilizing only position and attitude information in a short time for increasing the robustness where the estimates are substituted for unmeasured velocities in output feedback then to guarantee that all output states do not violate prescribed transient performances a proper error system is established by non logarithmic error transformation function based on these designs an output feedback adaptive formation scheme is proposed where neural networks are utilized for identifying lumped nonlinear terms composed of uncertain hydrodynamics and external disturbances and auxiliary variables and their additional control terms are presented to handle input saturation and underactuated problems simultaneously using lyapunov stability theorem it is proved that all closed loop signals are uniformly ultimately bounded uub and tracking errors can be guaranteed within prescribed performance bounds simulation results demonstrate effectiveness of the proposed formation control scheme keywords unmanned underwater vehicle leader follower finite time velocity observer transient prescribed performance output feedback trajectory tracking 1 introduce the trajectory tracking problem of unmanned underwater vehicles uuvs has aroused more compelling interest in ocean engineering over the past decades including marine environment monitoring underwater topograph explorating hydrological date collection and marine rescue sahoo et al 2019 in order to exhibit its greater efficiency in contrast to a single one formation control for multiple uuvs has been more constructive in the real tracking applications wu et al 2020 saback et al 2020 sarda and dhanak 2019 aimed at achieving expected fomation pattern various remarkable results have been proposed i e leader follower pattern cui et al 2010 wang et al 2020a b virtual structure makavita et al 2019 beard et al 2001 behavior based strategy liang et al 2020a b balch et al 1998 and artificial potential field method fiorelli et al 2006 in particalar leader follower has achieved a significant theoretical formalization due to the simplicity and reliability cui et al 2010 wang et al 2019a b 2020 qi and cai 2018 liu et al 2019 which is essentially to ensure that all followers track the orientation and distance of a real or virtuel leader with prescribed offset however accurate tracking control of uuvs is a major challenge in real oceanic engineering and application since full knowledge of uuv dynamic model cannot be exactly obtained due to its inherent properties i e high nonlinearities and parameter perturbations therefore the control approach designed for tracking control should be able to alleviate the adverse effects caused by uncertainties in this respect numerous control techniques have been proposed including adaptive control makavita et al 2019 antonelli et al 2003 fuzzy control sahu and subudhi 2018 sliding mode control qiao and zhang 2019 2020 dynamic surface control wang et al 2019a b neural network nn lu et al 2018 park 2015 model predictive control saback et al 2020 li et al 2017 data driven control peng et al 2019a b extended state observer eso peng et al 2019a b and lyapunov direct function liu and chen 2020 these results have been reported to achieve robustness against uncertainties and where nn based technique has been becoming one of the most promising tools to compensate for uncertain terms cui et al 2010 wang et al 2020a b lu et al 2018 park 2015 peng et al 2019a 2019b unfortunately some of the aforementioned studies only consider the case that the uuv is fully actuated in practice most torpedo like uuvs are underactuated cui et al 2010 liu et al 2019 which generally have three freedom degrees but only two control signals i e surge force and yaw moment are available for control design it is clear that an underactuated uuv invariably suffers from variations in sway direction thereby resulting in non integral constraints in addition an accompanied problem of input saturation may be easily triggered due to its restricted physical actuators li et al 2019 omid and khoshnam 2020 therefore comparing with control approaches involving with fully actuated uuvs complicated uncertainty to underactuated uuvs has attracted a considerable amount of attentions on attempting to design high performance tracking control approaches because of the design simplification and ease of implementation several traditional approaches such as local linearization and input output decoupling have been employed to design tracking controllers fossen 1994 however it has already been pointed in bechlioulis et al 2017 that closed loop performance is poor an alternative approach involved with backstepping technique cui et al 2010 which however suffered from an explosion of complexity problem caused by repeated differentiations peng et al 2017a b to end this dynamic surface control dsc techniques i e neural dsc li et al 2019 and fuzzy dsc liang et al 2020a b were reported for uncertainties of underactuated uuv in the aim of handling uncertainties a neural based adaptive robust formation control strategy was proposed in peng et al 2011 in the presence of unknown hydrodynamic damping an adaptive neural based leader following formation controller was presented for multiple uuvs park 2015 it was worthwhile mentioning that a novel approach angle method to track any reference paths i e curve path and straight path was introduced into control input to solve underactuation which only required the position information unlike the approach angle only suitable for case of straight path but requiring both position and velocity information in lionel and didik 2007 based on previous works a robust sliding mode formation control strategy of underactuated uuv was presented by utilizing backstepping adaptive neural network and dsc technique but its obtained results should hold an important assumption that the sway velocity was passive bounded wang et al 2020a b it is noted that all aforementioned results are obtained under an assumption that the exact full state information including the linear and angular velocities in body fixed reference frame and the positions and attitude in inertial reference frame is available for feedback control design however velocity information may not be readily acquired due to the considering equipment cost and the risk of sensors damage even if it can be acquired certain signal noises will be brought therefore it is necessary to design an output feedback control and some control schemes have been reported for nonlinear system based on observers chen et al 2020 li et al 2015 peng et al 2017a b in order to recover unavailable velocity high gain observers chen et al 2020 were commonly developed with only position and yaw angle information whereas uncertainties cannot be estimated a backstepping based observer li et al 2015 was designed to reconstruct velocity but all parameters were required to be known moreover a echo state network based observer peng et al 2017a b was designed to simultaneously identify the unmeasured velocities and uncertainties but its convergence was not assured among the above results existing observers are mostly infinite time qu et al 2020 accordingly a finite time velocity observer involved with output feedback tracking control for underactuated uuv formation is still an open issue besides output feedback tracking control some works can only guarantee uniformly ultimate boundedness while the transient performance such as convergence rate maximum overshoot or steady error bounds was not fully considered from a practical perspective transient performance can not only improve control performance but also ensure safety when vehicles influence by external disturbances induced by oceanic waves currents and tides therefore it is necessary to satisfy requirements of prescribed transient state and steady state performance to end this a remarkable prescribed performance was originally proposed for nonlinear system bechlioulis and rovithakis 2008 which can guarantee that all errors converge to a prescribed arbitrary small residual set while transient performance and overshoot are smaller than a sufficiently small preassigned constant this method has been efficiently utilized in several applications i e robots spacecraft and visual servo for the tracking control of underwater vehicle with prescribed performance a control scheme with prescribed performance for underactuated uuvs was firstly proposed by bechlioulis et al 2017 in omid and khoshnam 2018 a neural network based tracking control with prescribed performance was investigated to design a full state feedback controller for underactuated autonomous underwater vehicles auvs in liu et al 2020 an adaptive thruster fault tracking control problem was addressed with prescribed transient performance in addition dai et al 2018 had developed a full state feedback platoon formation controller using the benefit of prescribed performance to improve convergence rate finite time performance function wang et al 2021 and non logarithmic piecewise error mapping function li et al 2020 have also been introduced into tracking control problem apparently all aforementioned works are essentially a path following problem where the reference path is generated by a virtual point with an independent variable rather than the more difficult trajectory tracking since the controller requires to drive the uuv reaching and tracking a time varying trajectory on time jia et al 2019 moreover it is turned out that these controllers are all based on an assumption that off diagonal terms in mass and damping matrices of underactuated uuv are zero indeed this restrictive assumption is not tenable the reason is that most underactuated uuvs are not a semi submerged sphere therefore yaw moment control effects directly on sway dynamics which results in the difficulty in control design in order to overcome this problem do et al 2005 firstly proposed a nonlinear coordinate transformation with diagonal form to relax this restrictive assumption furthermore based on the coordinate transformation with diagonal form containment control and formation control design sung and bong 2015 can be achieved although all these works benefit from the above assumption it also requires accurate model parameters on hydrodynamic damping in general viscous hydrodynamic damping of uuv is mainly caused by potential damping possible skin friction wave drift damping vortex shedding damping and lifting forces different damping terms can be divided into both linear and nonlinear damping fossen 2011 the linear damping coefficients i e potential damping and possible skin friction can be calculated by semi exprical method or computation programs however nonlinear damping coefficients such as wave drift damping vortex shedding damping and lifting forces are difficult to acquire in most cases due to their nonlinear characteristics jia et al 2019 therefore discrepancies between the nominal and actual model are utilized to design the controller with only partial information chen et al 2020 motivated by aforementioned observations challenges on accurate control for uuv are mainly derived from uncertainties i e parameter perturbation input saturation underactuated constricts and prescribed transient and steady state performance as well as external disturbance to our best knowledge there is no work on accommodating these issues simultaneously in leader follower formation tracking control for underactuated uuvs therefore a finite time velocity observed based adaptive output feedback formation tracking controller is investigated to achieve trajectory tracking while ensuring the prescribed transient and steady state performance on output tracking errors for a more general case we design this controller under the assumption that mass and hydrodynamic terms are off diagonal and prior information on hydrodynamics is partial uncertain meanwhile velocity information is unmeasurable main contributions of this paper are summarized as follows 1 in contrast to existing results cui et al 2010 dennis et al 2019 li et al 2020 wang et al 2020a 2020b the proposed formation control scheme based on leader follower only relies on both positions and orientations available to track both straight line path and curve line path where required velocities for output feedback control designing are recovered by using finite time velocity observer rather than the most commonly used infinite time high gain observers chen et al 2020 it is more convenient to implement this in practice 2 in order to achieve the tracking with prescribed transient performance despite the presence of parameter uncertainty and external disturbances a novel output feedback trajectory tracking formation controller with prescribed performance for underactuated uuvs is firstly developed where tracking errors in transformed coordinate can be guaranteed to satisfy prescribed transient and steady state behaviors i e convergence rate and maximum overshoot by means of the non logarithmic error transformation functions 3 simultaneously increasing greatly robustness against input saturation and underactuated constricts and discarding the assumption that sway velocity is passive bounded in previous works wang et al 2019a b 2020 omid and khoshnam 2018 jia et al 2019 three auxiliary virtual variables and their additional control terms are designed based on filter backstepping and adaptive neural network and all of which are incorporated into the proposed output feedback tracking controller moreover all closed loop signals are uniformly ultimately bounded within the given prescribed performance bounds the reminder of this paper is organized as follows section 2 introduces the preliminaries and problem formulation section 3 details the adaptive robust output feedback control design section 4 gives main results section 5 illustrates simulation experiments finally section 6 concludes this paper and discusses the future work 2 preliminaries and problem formulation 2 1 preliminaries proposition 1 ryan 1991 for a general initial value problem 1 ω t f ω t ω 0 ω 0 ω 0 r m ω t r m where f ω t is a continuous function on r m if the solution for 1 is bounded then t lemma 1 wen et al 2018 consider a smooth function v t and its initial state v 0 is bounded if there exists an inequality v t 2 μ v c holding with c 0 and μ 0 for any time this inequality can be obtained 2 v t v 0 c 2 μ exp μ t c 2 μ lemma 2 khalil 2002 young inequality is expressed for any positive a b r 3 ab k p p a p 1 q k q b q where k 0 p 1 q 1 p 1 q 1 1 lemma 3 shtessel et al 2007 consider a nonlinear system x t f x t 4 x 0 z 0 x 1 z 0 ϖ 0 l 1 n 1 x 0 n n 1 sgn x 0 x 1 z 1 x 2 z 1 ϖ 1 l 1 n x 1 x 0 n 1 n sgn x 1 x 0 x n 1 z n 1 x n z n 1 ϖ n 1 l 1 2 x n 1 x n 2 1 2 sgn x n 1 x n 2 x n z n l l z n ϖ n l sgn x n x n 1 where ϖ i i 0 1 m and l are positive constants hence the original system x t f x t is finite time stable by aiding of setting suitable ϖ i 0 and l 0 remark 1 due to the expensive cost and simplifying mechanism velocity measuring instruments may not be equipped on uuv body and velocity information is unavailable for designing output feedback control such that lemma 3 can be employed to design a nonlinear finite time velocity observer for estimating unmeasurable velocities 2 2 modeling uuv formation system consider a leader follower formation system consisting of n underactuated uuvs with index set n 1 2 n to accurately illustrate the motion of each uuv earth fixed frame e and body fixed frame b are formulated in fig 1 the kinematic and dynamic model of the i th uuv is provided as do and pan 2009 fossen 2011 5 η i j ψ i ν i m i ν i c i ν i ν i d i ν i ν i δ i τ w i where η i x i y i ψ i t ℝ 3 is a vector of position x i y i and yaw angle ψ i 0 2 π in earth fixed frame respectively ν i u i v i r i t ℝ 3 is a velocity vector in surge u i sway v i and yaw r i in body fixed frame w i w ui w vi w ri t denotes the external unknown disturbances j ψ i ℝ 3 3 is the rotation matrix and μ i ℝ 3 3 c i ℝ 3 3 and d i ℝ 3 3 are the non diagonal inertia matrix coriolis matrix and damping matrix respectively all of which are given by 6a j ψ i cos ψ i sin ψ i 0 sin ψ i cos ψ i 0 0 0 1 6b μ i m 11 i 0 0 0 m 22 i m 23 i 0 m 23 i m 33 i 6c c i 0 0 m 22 i v i m 23 i r i 0 0 m 11 i u i m 22 i v i m 23 r i m 11 i u i 0 6d d i d 11 u i 0 0 0 d 22 v i r i d 23 v i r i 0 d 32 v i r i d 33 v i r i where m 11 i m i x u i m 22 i m i y v i m 23 i m i x gi y r i m 33 i i zi n r i d 11 u i x ui x ui ui u i d 22 v i r i y vi y vi vi v i y ri vi r i d 23 v i r i y ri y vi ri r i y ri ri r i d 32 v i r i n vi n vi vi v i n ri vi r i d 33 v i r i n ri n vi ri v i n ri ri r i here m i denotes the mass of uuv x gi is the center of gravity in body fixed frame and i zi is the moment of inertia with respect to yaw x u i y v i y r i and n r i are the added masses x ui x ui ui y vi y vi vi y ri vi y vi ri y ri ri n vi n ri n vi vi n ri vi n vi ri and n ri ri are the hydrodynamic derivatives τ i τ u i 0 τ r i t ℝ 3 denotes the control input vector consisting of surge force τ u i and yaw moment τ r i suffering from the unmodelled dynamics and parametric perturbations the precise modeling on hydrodynamic is difficult to be obtained such that the dynamics matrices can be divided into the nominal part and shift part jia et al 2019 chen et al 2020 i e m i m i δ m i c i c i δ c i and d i d i δ d i where i represents the nominal parameter and δ i describes a shifted difference between real and nominal parameters therefore the dynamics 5 can be formatted 7 μ i ν i c i ν i ν i d i ν i ν i δ i τ d i where d i δ μ i ν i δ c i ν i ν i δ d i ν i ν i w i and the kinematic model for the i th uuv can be formulated as 8 x i u i c o s ψ i v i s i n ψ i y i u i s i n ψ i v i c o s ψ i ψ i r i assumption 1 the unknown disturbance w i w ui w vi w ri t and its derivative are bounded and satisfy the following condition 9 w i t w i where w i is unknown positive constant assumption 2 the control input τ i is determined by saturation function δ τ i δ τ u i 0 δ τ r i t ℝ 3 as follows 10 δ τ j i τ j i max i f τ j i τ j i max τ j i i f τ j i min τ j i τ j i max τ j i min i f τ j i τ j i min j u r where τ j i max and τ j i min are upper and lower bounds of control forces or moments respectively in addition a dead zero function χ i χ u i 0 χ v i τ i δ τ i is defined to express mismatch between the control with saturation and without saturation hence saturation control in 5 can be given by δ τ i τ i χ i remark 2 the partial information about underactuated uuv in 7 are available in nominal part which can be utilized for control design purpose unlike the previous works either considering full prior knowledge do and pan 2005 or without any prior knowledge wang et al 2017 on model parameters the two cases are both not real from a practical point of view moreover shift part between normal and actual model can be approximated by nns 2 3 coordinate transformation most like torpedo uuvs are not submerged sphere bechlioulis et al 2017 so mass matrices μ i cannot be assumed as diagonal due to its non diagonal item m 23 i this means that the yaw moment τ r can influence directly on sway dynamics in 5 in such case it is difficult to formulate the control design therefore we introduce a coordinate transformation do and pan 2005 to make the non diagonal mass matrices as a diagonal form 11 x i x i ξ i s i n ψ i y i y i ξ i c o s ψ i v i v ri ξ i r i where ξ i m 23 i m 22 i then the uuv mathematical model can be rewritten as 12 x i u i c o s ψ i v i s i n ψ i y i u i s i n ψ i v i c o s ψ i ψ i r i 13 u i φ ui ϕ ui τ ui χ ui m 11 i v i φ vi ϕ vi ψ i φ ri ϕ ri τ ri χ ri δ i where φ u i m 22 i m 11 i v ri r i m 23 i m 11 i r i 2 d 23 i u r i m 11 i u ri φ v i m 11 i m 22 i u ri r i d 22 i v r i r i m 22 i v r i d 23 i v r i r i m 22 i r i φ r i 1 δ i m 11 i m 22 i m 22 i m 22 i u ri v ri m 11 i m 23 i m 22 i m 23 i u ri r i m 22 i d 33 i v ri r i r i d 32 i v ri r i v ri m 23 i d 23 i v ri r i r i d 22 i v ri r i v ri ϕ ui d ui m 11 i ϕ vi d vi m 22 i ϕ ri m 23 i d vi m 22 i d ri δ i δ i m 22 i m 33 i m 23 i m 23 i j u v r i 1 2 n in addition we define η i x i y i ψ i t and ν i u i v i r i t assumption 3 we assume that v i u i v i r i t is bounded due to saturated control input 10 and m i is known so φ u i φ v i φ v i are lipschitz with respect to velocity v i u i v i r i t and ϕ ui ϕ vi ϕ ri are bounded and unknown chen et al 2020 remark 3 the m i c i and d i can be calculated using semi empirical methods or hydrodynamic computation programs however φ u i φ v i φ v i and ϕ ui ϕ vi ϕ ri involved with the nonlinear damping terms are difficult to obtain accurately and if such inaccurate information is utilized it may lead to undesired performance park 2015 such that we will design the controller without nonlinear damping matrix information remark 4 the coordinate transformation in 1 is equivalent to moving the frame b forward a short distance ε i m 23 m 22 in surge direction such that diagonal forms 12 and 13 derived from 5 can be achieved 2 4 rbf neural networks due to the good approximation rbf nns are employed to address estimating uncertain hydrodynamic damping terms in this paper we use the following rbf nns to approximate a continuous smooth function h z r q r 14 h z w t θ z where input vector z ω r q weighting vector w r n n denotes the number of neurons and θ z θ 1 z θ 2 z θ n z r n is a nonlinear activation vector which is given by 15 θ i z exp z c i t z c i σ i 2 i 1 2 n where c i and σ i are the center and width of the i th gaussian function respectively it has been proved that the aforesaid rbf nns can approximate any continuous function h z over a compact set ω z r q to any arbitrary degree of accuracy as 16 h z w t θ z ε z z ω r q where ε z is a bounded approximation error satisfying ε ε and the unknown constant ε 0 is for all z ω z and w is an optimal weight vector and it is defined as 17 w arg min w r n sup z ω z h z w t θ z it is noted that both w and ε are unknown constants which are only used for analytical propose for real scenarios an estimation w is used for practical approximation instead of the w hence an estimation of h z can be given by 18 h z w t θ z where w can be estimated online by designing adaptive law assumption 4 the w is bounded i e w w where w is a positive constant assumption 5 ge and wang 2002 for w w and w w w an error can be formulated by 19 w t θ z w t θ z w t θ z and then following inequalities can hold 20a χ w t w t χ 2 w 2 w 2 20b θ i z c i where χ and c i are positive constants 2 5 problem formulation the objective of this paper is to design an adaptive output feedback formation controller for n underactuated uuvs such that each vehicle can track a desired leader with the prescribed performance while the tracking errors are confirmed to the predefined performance bounds in the presence of model uncertainties and external disturbances let η l x l y l ψ l t and η i r x i r y i r ψ i r t be the desired leader and reference trajectory of the i th follower respectively as illustrated in fig 1 the predefined desired distance d if and angle ϕ i f are introduced to illustrate the relative position between η l and η i r which is formulated as follows 21 x ir x l d if c o s ψ l ϕ if y ir y l d if s i n ψ l ϕ if ψ ir ψ l where x l x l ξ l c o s ψ l y l y l ξ l s i n ψ l define the transformed positions and yaw error 22 x ei x i x ir y ei y i y ir ψ ei ψ i ψ ai where ψ a i is an approach angle to track desired leader for the i th uuv formulated as park 2015 23 ψ a i atan y e i x e i tanh h 2 a 0 ψ l 1 tanh h 2 a 0 where a 0 is a positive constant and h x ei 2 y ei 2 assumption 6 the η i x i y i ψ i t is available and ν i u i v i r i t is unmeasured assumption 7 the leader position η l x l y l ψ l t is bounded and available only for followers who are within communicating region assumption 8 the time varying unknown ψ a i is bounded such that ψ a i ψ a i where ψ a i is positive constant remark 5 as stated in assumptions 1 2 3 6 7 and 8 model uncertainty and external disturbance and their bounds are unknown in this paper the most commonly used methods such as function approximators and adaptive techniques for uuv need great computation and time for estimating uncertainties and their bounds especially for unmeasured ν i u i v i r i t 3 adaptive robust output feedback control design the section is devoted to designing the adaptive robust output feedback control scheme for the leader following formation 3 1 finite time velocity observer in practical application uuv position η x y ψ t can be readily measured via sonars whereas its velocity ν u v r t may be unmeasured due to the expensive cost of measured devices i e doppler velocity log dvl and inertial navigation system ins to identify the velocity for output feedback control design we develop a finite time velocity observer to exactly estimate the velocity by aiding of only position information hence observer for the i th uuv is constructed based on kinematics 5 as follows 24 η i z 0 i z 0 i ϖ 1 i l i 1 2 η i η i 1 2 sgn η i η i j ν i j ν i ϖ 2 i l i sgn j ν i z 0 i where ϖ 1 i 0 and ϖ 2 i 0 are designing observer coefficients l i diag l ui l vi l ri ℝ 3 is gain with l ui 0 l vi 0 l ri 0 and η i and ν i are the estimations for η i and ν i respectively consider observation errors between estimation and true value as 25 ε i η η i η i ε i ν j ν i j ν i taking the derivative of 25 along 24 we have 26 ε i η ϖ 1 i l i 1 2 η i η i 1 2 sgn η i η i j ν i j ν i ϖ 1 i l i 1 2 ε i η 1 2 sgn ε i η ε i ν ε i ν ϖ 2 i l i sgn ϖ 1 i l i 1 2 ε i η 1 2 sgn ε i η j ν i ϖ 2 i l i sgn ε i ν ε i η d d applying the lemma 3 it is indicated from 26 that velocity observation error ε i ν can be ensured to converge to zero within a finite time i e existing 0 t such that 27 ε i ν t ε i ν t ε e ν t t 28 u t u t v t v t r t r t t t where ε e ν 0 hence we can conclude that ν i can be accurately estimated by observers ν i remark 6 to facilitate the output feedback controller designing we replace an unmeasurable velocity ν u v r t with its estimations ν u v r t provided by the observer 24 furthermore this observer can simultaneously guarantee greater convergence and stronger anti disturbance and all errors can exactly converge to zero within a short time rather than existing methods can only achieve a convergence without considering the time 3 2 prescribed performance control in the presence of input saturation and unknown disturbance transient overshoot and convergence rate of tracking errors are easily triggered to violate a prescribed boundness to avoid such serious accidents we introduce a prescribed performance control ppc to strictly guarantee all tracking errors converging within a predefined region that is bounded by decaying time function consider a tracking error vector e i x ei y ei ψ ei t ℝ 3 and mathematical ppc is stated as 29 α i 1 ρ i 1 x ei t β i 1 ρ i 1 t 0 α i 2 ρ i 1 y ei t β i 2 ρ i 1 t 0 α i 3 ρ i 1 ψ ei t β i 3 ρ i 1 t 0 where 0 α i j β i j 1 are prescribed scale parameters i 1 2 n j 1 2 3 and ρ i j t ℝ ℝ is defined as predefined bounded function 30 ρ i j t ρ i j 0 ρ i j exp l i j t ρ i j i 1 2 n j 1 2 3 where ρ i j 0 ρ i j and l ij are strictly positive constants ρ i j 0 ρ i j and ρ i j t l i j ρ i j 0 ρ i j furthermore this statement with a case of ρ ij t 20 2 exp 0 005 t 2 is illustrated in fig 2 remark 7 the ρ ij i 1 2 n j 1 2 3 is smooth positive decreasing and bounded function satisfying lim x ρ ij t ρ i j 0 the l ij represents the minimum convergence rate for e i and ρ i j describes the maximum allowable size of e i at steady state furthermore the maximum overshot is prescribed less than α j ρ ij 0 if e i 0 0 or less than β j ρ ij 0 if e i 0 0 which may even become zero by setting α i j 0 or β i j 0 respectively such that e i can be imposed performance bounds by elaborately selecting parameters however it is a major challenge to ensure that 30 is always satisfied hence an error transformation is defined to achieve the system incorporated with the performance constraints 29 as follows 31 x ei t ρ i 1 t s i 1 e xi y ei t ρ i 2 t s i 2 e yi ψ ei t ρ i 3 t s i 3 e ψ i where e i e xi e yi e ψ i t ℝ 3 is the transformed error vector and s ij is defined as strictly monotonically increasing functions 32 s i 1 e xi β i 1 exp e xi α i 1 exp e xi exp e xi exp e xi s i 2 e yi β i 2 exp e yi α i 2 exp e yi exp e yi exp e yi s i 3 e ψ i β i 3 exp e ψ i α i 3 exp e ψ i exp e ψ i exp e ψ i where i 1 2 n j 1 2 3 α i j s ij β i j then we can obtain 33 e xi t s i 1 1 x ei t ρ i 1 t 1 2 ln α i 1 z i 1 β i 1 z i i 1 e yi t s i 2 1 y ei t ρ i 2 t 1 2 ln α i 2 z i 2 β i 2 z i 2 e ψ i t s i 3 1 ψ ei t ρ i 3 t 1 2 ln α i 3 z i 3 β i 3 z i 3 where s ij 1 is essentially a mapping α i j β i j in addition the aforesaid transformation function is illustrated with α i j β i j 1 in the fig 3 meanwhile taking the time derivatives of transformed error in 33 and yielding 34a e xi t 1 2 1 α i 1 z i 1 1 β i 1 z i 1 z i 1 ϱ i 1 ρ i 1 x ei x ei ρ i 1 ρ i 1 34b e yi t 1 2 1 α i 2 z i 2 1 β i 2 z i 2 z i 2 ϱ i 2 ρ i 2 y ei y ei ρ i 2 ρ i 2 34c e ψ i t 1 2 1 α i 3 z i 3 1 β i 3 z i 3 z i 3 ϱ i 3 ρ i 3 ψ ei ψ ei ρ i 3 ρ i 3 where ϱ ij 1 2 ρ ij 1 α j z ij 1 β j z ij z i 1 x ei ρ i 1 z i 2 y ei ρ i 2 z i 3 ψ ei ρ i 3 and existing z ij 1 j 1 2 3 assumption 9 the tracking errors satisfy α i 1 ρ i 1 0 x ei 0 β i 1 ρ i 1 0 α i 2 ρ i 2 0 y ei 0 β i 2 ρ i 2 0 and α i 3 ρ i 3 0 ψ ei 0 β i 3 ρ i 3 0 when t 0 lemma 4 consider the tracking error vector e i t x ei y ei ψ ei t satisfying assumption 9 and the transformed error 34 the prescribed transient performance satisfying 29 can be guaranteed for all t 0 when e i e xi e yi e ψ i t is bounded from 31 and 34 proof due to bounded e i e xi e yi e ψ i t we assume that it should satisfy with unknown constant vectors i e e i and e i such that 35 e i e i e i t 0 employing the inverse transformation s ij 1 into 35 we can obtain 36 s i 1 e xi ρ i 1 t x ei t s i 1 e xi ρ i 1 t t 0 s i 2 e yi ρ i 2 t y ei t s i 2 e yi ρ i 2 t t 0 s i 3 e ψ i ρ i 3 t ψ ei t s i 3 e ψ i ρ i 3 t t 0 owing to the properties of α i j β i j we can obtain 37 α i 1 ρ i 1 t x ei t β i 1 ρ i 1 t α i 2 ρ i 2 t y ei t β i 2 ρ i 2 t α i 3 ρ i 3 t ψ ei t β i 3 ρ i 3 t moreover due to the positive and decreasing ρ i j t prescribed performance of the corresponding tracking errors can be guaranteed within boundness 38 ω ij e i ℝ x ei t ρ i 1 y ei t ρ i 1 ψ ei t ρ i 3 therefore it proves that prescribed transient performance can be satisfied for all t 0 the proof is completed here 3 3 filter backstepping for virtual velocity design to stabilize the transformed tracking errors 30 we employ the filter backstepping technique to design the appropriate virtual velocities in this subsection the virtual velocity γ i γ i 1 γ i 2 γ i 3 t for observed velocity ν i u i v i r i t is designed by 39a γ i 1 l i 1 e x i cos ψ i l i 1 e y i sin ψ i u l cos ψ i ψ l v l cos ψ i ψ l d i l ϕ i l r l s i n ϕ i l ψ l ψ i d i l c o s ϕ i l ψ l ψ i 39b γ i 2 l i 1 e x i sin ψ i l i 1 e y i cos ψ i u l cos ψ i ψ l v l cos ψ i ψ l d i l ϕ i l r l s i n ϕ i l ψ l ψ i d i l c o s ϕ i l ψ l ψ i 39c γ i 3 l i 2 e ψ i ψ ˆ a i where l i 1 and l i 2 are positive constants and u l v l and r l provided by velocitey observers are estimates of u l v l and r l respectively moreover ψ ˆ a i is an unknown time varying estimate of ψ a i provided by designing observer as ψ ˆ a i μ i l i 3 ψ e i and μ i l i 3 r i μ i l i 3 ψ ei where l i 3 is positive constant it is noticed that derivatives of observed u l v l and r l are unavailable for output feedback according to the assumption 7 which can lead to an explosion of complexity problem due to the repeated differentiations of virtual velocity control signals to avoid this problem in backstepping procedure dsc design is introduced i e let γ i pass through a first order filter in following design 40 ζ ij ς ij ς ij γ ij ς ij 0 γ ij 0 i 1 2 n j 1 2 3 where ς i ς i 1 ς i 2 ς i 3 t is a filtered virtual control input vector and ζ j ζ i 1 ζ i 2 ζ i 3 t 0 is the designing time parameter it can eliminate the analytic computation of γ i define the filter error vector as 41 ε i ς i γ i where ε i 1 ς i 1 γ i 1 ε i 2 ς i 2 γ i 2 and ε i 3 ς i 3 γ i 3 from the 40 and 41 we have the derivative of ε i as 42 ε i ε i ζ i j γ i define the first order new errors between filtered virtual and actual velocities as 43a s i 1 u i ς i 1 π i 1 tanh θ i 1 43b s i 2 v i ς i 2 π i 2 tanh θ i 2 43c s i 3 r i ς i 3 π i 3 tanh θ i 3 where ν i u i v i r i t can be estimated by the finite time velocity observer and θ i 1 θ i 2 and θ i 3 are the auxiliary control terms given by park et al 2017 44a θ i 1 cosh 2 θ i 1 ℓ i 1 θ i 1 χ u i m 11 i π i 1 44b θ i 2 cosh 2 θ i 2 φ v i l i 4 s i 1 l i 4 s i 2 l i 4 s i 3 w i 2 t θ i 2 z x e i sin ψ i y e i cos ψ i π i 2 44c θ i 3 cosh 2 θ i 3 ℓ i 2 θ i 1 m 22 i χ r i δ π i 3 where π i 1 π i 2 and π i 3 are positive constants and l i 4 ℓ i 1 and ℓ i 2 are positive constants taking the time derivatives of s i 1 s i 2 and s i 3 along 44 we have 45a s i 1 φ ui ϕ ui ς i 1 ℓ i 1 θ i 1 τ ui m 11 i 45b s i 2 ϕ vi ς i 2 l i 4 s i 1 l i 4 s i 2 l i 4 s i 3 w i 2 t θ i 2 z x ei sin ψ i y ei cos ψ i 45c s i 3 φ ri ϕ ri ς i 3 ℓ i 2 θ i 1 m 22 i τ ri δ remark 8 the auxiliary control terms θ i 1 and θ i 3 are proposed to compensate input saturation and θ i 2 is proposed to handle the underactuation of uuv which can relax the assumption that the sway velocity is passive bounded wang et al 2019a b 2020 omid and khoshnam 2018 jia et al 2019 3 4 neural network based output feedback controller the output feedback control signals for leader follower formation are designed as follows 46 τ u i m 11 i φ u i ℓ i 1 θ i 1 l i 4 s i 1 l i 4 s i 2 w i 1 t θ i 1 z ς i 1 x e i sin ψ i y e i cos ψ i τ r i δ φ r i ℓ i 2 θ i 3 l i 4 s i 2 l i 4 s i 3 w i 3 t θ i 3 z ς i 3 ψ e i m 22 i with the adaptive law 47 w ij γ ij θ i z s ij o i w ij j 1 2 3 where o i is positive control parameter substituting 46 and 47 into 45 yields 48 s i 1 l i 4 s i 1 l i 4 s i 2 w i 1 t θ i 1 z x ei sin ψ i y ei cos ψ i ε i 1 s i 2 l i 4 s i 1 l i 4 s i 2 l i 3 s i 3 w i 2 t θ i 2 z x ei sin ψ i y ei cos ψ i ε i 2 s i 3 l i 4 s i 2 l i 4 s i 3 w i 3 t θ i 3 z ψ ei ε i 3 where w ij t w ij t w ij t ϕ u i w i 1 t θ i 1 z ε i 1 ϕ v i w i 2 t θ i 2 z ε i 2 ϕ r i w i 3 t θ i 3 z ε i 3 taking the time derivatives both sides of 22 along the solutions of 12 as follows 49 x ei u i c o s ψ i v i s i n ψ i u l c o s ψ l v l s i n ψ l d il c o s ψ l ϕ il d lf r l ϕ il s i n ψ l ϕ il y ei u i s i n ψ i v i c o s ψ i u l s i n ψ l v l c o s ψ l d il s i n ψ l ϕ il d ll r l ϕ il c o s ψ l ϕ il ψ ei r i ψ ai substituting 43 into 49 yields 50 x ei s i 1 ε i 1 γ i 1 π i 1 t a n h θ i 1 c o s ψ i s i 2 ε i 2 γ i 2 π i 2 t a n h θ i 2 s i n ψ i u l c o s ψ l v l s i n ψ l d il c o s ψ l ϕ il d lf r l ϕ il s i n ψ l ϕ il y ei s i 1 ε i 1 γ i 1 π i 1 t a n h θ i 1 s i n ψ i s i 2 ε i 2 γ i 2 π i 2 t a n h θ i 2 c o s ψ i u l s i n ψ l v l c o s ψ l d il s i n ψ l ϕ il d lf r l ϕ il c o s ψ l ϕ il ψ ei s i 3 ε i 3 γ i 3 π i 3 t a n h θ i 3 ψ ai and substituting 50 and into 34 yields 51 e xi t ϱ i 1 s i 1 c o s ψ i s i 2 s i n ψ i ε i 1 c o s ψ i ε i 2 s i n ψ i l i 1 e x i g i 1 e yi t ϱ i 2 s i 1 s i n ψ i s i 2 c o s ψ i ε i 1 s i n ψ i ε i 2 c o s ψ i l i 1 e y i g i 2 e ψ i t ϱ i 3 s i 3 ε i 3 l i 2 e ψ i g i 3 where g i 1 π i 1 t a n h θ i 1 c o s ψ i π i 2 t a n h θ i 2 s i n ψ i z i 1 ρ i 1 g i 2 π i 1 t a n h θ i 1 s i n ψ i π i 2 t a n h θ i 2 c o s ψ i z i 2 ρ i 2 g i 3 ψ ˆ ai π i 3 t a n h θ i 3 ψ ai z i 3 ρ i 3 remark 9 due to the t a n h θ i 1 1 t a n h θ i 2 1 s i n ψ i 1 c o s ψ i 1 z ij 1 and ρ i j t l i j ρ i j 0 ρ i j j 1 2 3 it is implied that g ij is bounded such that g i 1 g i 1 g i 2 g i 2 g i 3 g i 3 4 main results in this section we summarize the main results of this paper in the following theorem theorem 1 consider the underactuated uuv model 7 in leader following tracking system 22 and 23 with external disturbances 9 and input saturation 10 and suppose that assumptions 1 3 and 6 8 are satisfied if the error transformed function is applied by 33 the finite time velocity observer is calculated by 24 the filter backstepping velocity controller is designed by 44 and the output feedback controller for leader following formation is updated by 46 with adaptive law given by 47 then the output feedback controller can guarantee the following statements i the x ei y ei and ψ e i can be guaranteed within the given prescribed performance bound ρ i j ii all control signals of the closed loop system remain bounded proof consider the following lyapunov function candidate for the i th uuv as 52 v i v 1 i v 2 i v 3 i v 4 i v 5 i where v 1 i 1 2 ϱ i 1 e xi 2 1 2 ϱ i 2 e yi 2 1 2 ϱ i 3 e ψ i 2 v 2 i 1 2 x ei 2 1 2 y ei 2 1 2 ψ ei 2 v 3 i 1 2 s i 1 2 1 2 s i 2 2 1 2 s i 3 2 v 4 i 1 2 ε i 1 2 1 2 ε i 2 2 1 2 ε i 3 2 v 5 i 1 2 w i 1 t γ i 1 1 w i 1 1 2 w i 2 t γ i 2 1 w i 2 1 2 w i 3 t γ i 3 1 w i 3 step1 substituting 51 into the time derivative of v 1 i we have 53 v 1 i 1 ϱ i 1 e xi e xi 1 ϱ i 2 e yi e yi 1 ϱ i 3 e ψ i e ψ i l i 1 e xi 2 l i 1 e yi 2 l i 2 e ψ i 2 e xi s i 1 c o s ψ i s i 2 s i n ψ i e xi ε i 1 c o s ψ i ε i 2 s i n ψ i e xi g i 1 e yi s i 1 s i n ψ i s i 2 c o s ψ i e yi ε i 1 s i n ψ i ε i 2 c o s ψ i e yi g i 2 e ψ i s i 3 e ψ i ε i 3 e ψ i g i 3 l i 1 e xi 2 l i 1 e yi 2 l i 2 e ψ i 2 e xi s i 1 e xi s i 2 e xi ε i 1 e xi ε i 2 e xi g i 1 e yi s i 1 e yi s i 2 e yi ε i 1 e yi ε i 2 e yi g i 2 e ψ i s i 3 e ψ i ε i 3 e ψ i g i 3 where j 1 2 3 by aiding of the lemma 2 v 1 i can be represented as 54 v 1 i l i 1 5 2 e xi 2 l i 1 5 2 e yi 2 l i 2 3 2 e ψ i 2 s i 1 2 s i 2 2 1 2 s i 3 2 ε i 1 2 ε i 2 2 1 2 ε i 3 2 1 2 j 1 3 g ij 2 recalling the remark 9 existing g i 1 g i 1 g i 2 g i 2 and g i 3 g i 3 we can obtain 55 v 1 i l i 1 5 2 e xi 2 l i 1 5 2 e yi 2 l i 2 3 2 e ψ i 2 s i 1 2 s i 2 2 1 2 s i 3 2 ε i 1 2 ε i 2 2 1 2 ε i 3 2 1 2 j 1 3 g ij 2 step2 substituting 50 into the time derivative of v 2 i we have 56 v 2 i x ei x ei y ei y ei ψ ei ψ ei x ei s i 1 ε i 1 γ i 1 π i 1 t a n h θ i 1 c o s ψ i s i 2 ε i 2 γ i 2 π i 2 t a n h θ i 2 s i n ψ i u l c o s ψ l v l s i n ψ l d il c o s ψ l ϕ il d lf r l ϕ il s i n ψ l ϕ il y ei s i 1 ε i 1 γ i 1 π i 1 t a n h θ i 1 s i n ψ i s i 2 ε i 2 γ i 2 π i 2 t a n h θ i 2 c o s ψ i u l s i n ψ l v l c o s ψ l d il s i n ψ l ϕ il d lf r l ϕ il c o s ψ l ϕ il ψ ei s i 3 ε i 3 γ i 3 π i 3 t a n h θ i 3 ψ ai l i 1 x ei 2 l i 1 y ei 2 l i 2 ψ ei 2 s i 1 x ei s i 2 x ei s i 1 y ei s i 2 y ei s i 3 ψ ei ε i 1 x ei π i 1 x ei ε i 2 x ei π i 2 x ei ε i 1 y ei π i 1 y ei ε i 2 y ei π i 2 y ei ψ ei ε i 3 π i 3 ψ ei ψ ei ψ ai by aiding of lemma 2 v 2 i can be represented as 57 v 2 i l i 1 3 x ei 2 l i 1 3 y ei 2 l i 2 2 ψ ei 2 s i 1 2 s i 2 2 1 2 s i 3 2 ε i 1 2 ε i 2 2 1 2 ε i 3 2 π i 1 2 π i 2 2 1 2 π i 3 2 1 2 ψ ai 2 applying the assumption 8 existing ψ a i ψ a i such that 57 can be represented as 58 v 2 i l i 1 3 x ei 2 l i 1 3 y ei 2 l i 2 2 ψ ei 2 s i 1 2 s i 2 2 1 2 s i 3 2 ε i 1 2 ε i 2 2 1 2 ε i 3 2 π i 1 2 π i 2 2 1 2 π i 3 2 1 2 ψ a i 2 step3 substituting 48 into the time derivative of v 3 i we have 59 v 3 i s i 1 l i 4 s i 1 l i 4 s i 2 w i 1 t θ i 1 z x ei sin ψ i y ei cos ψ i ε i 1 s i 2 l i 4 s i 1 l i 4 s i 2 l i 3 s i 3 w i 2 t θ i 2 z x ei sin ψ i y ei cos ψ i ε i 2 s i 3 l i 4 s i 2 l i 4 s i 3 w i 3 t θ i 3 z ψ ei ε i 3 l i 4 s i 1 2 l i 4 s i 2 2 l i 4 s i 3 2 s i 1 w i 1 t θ i 1 z s i 1 x ei sin ψ i s i 1 y ei cos ψ i s i 1 ε i 1 s i 2 w i 2 t θ i 2 z s i 2 x ei sin ψ i s i 2 y ei cos ψ i s i 2 ε i 2 s i 3 w i 3 t θ i 3 z s i 3 ψ ei s i 3 ε i 3 l i 4 s i 1 2 l i 4 s i 2 2 l i 4 s i 3 2 s i 1 w i 1 t θ i 1 z s i 2 w i 2 t θ i 2 z s i 3 w i 3 t θ i 3 z s i 1 x ei s i 1 y ei s i 2 x ei s i 2 y ei s i 3 ψ ei s i 1 ε i 1 s i 2 ε i 2 s i 3 ε i 3 by aiding of lemma 2 v 3 i can be represented as 60 v 3 i l i 4 3 2 s i 1 2 l i 4 3 2 s i 2 2 l i 4 1 s i 3 2 j 1 3 s ij w ij t θ i z x ei 2 y ei 2 1 2 ψ ei 2 1 2 j 1 3 ε ij 2 due to the existing inequality ε ε v 3 i can be rewritten as 61 v 3 i l i 4 3 2 s i 1 2 l i 4 3 2 s i 2 2 l i 4 1 s i 3 2 j 1 3 s ij w ij t θ i z x ei 2 y ei 2 1 2 ψ ei 2 1 2 j 1 3 ε ij 2 step4 substituting 42 into the time derivative of v 4 i we have 62 v 4 i ε i 1 ς i 1 γ i 1 ε i 2 ς i 2 γ i 2 ε i 3 ς i 3 γ i 3 j 1 3 ε ij 2 ζ ij ε i 1 γ i 1 ε i 2 γ i 2 ε i 3 γ i 3 j 1 3 ε ij 2 ζ ij ε i 1 γ i 1 ε i 2 γ i 2 ε i 3 γ i 3 by aiding of lemma 2 v 4 i can be represented as 63 v 4 i j 1 3 1 ζ ij γ ij 2 2 ε ij 2 3 2 it is noted that the derivative of γ i γ i 1 γ i 2 γ i 3 t given by 41 can be represented as ϒ i ϒ i 1 ϒ i 2 ϒ i 3 γ i ϒ i 1 γ i 1 e ix e iy s i 1 x ei y ei s i 2 s i 3 ε i 1 ε i 2 ε i 3 η l η l d il d il d il ϕ il ϕ il ϕ il ϒ i 2 γ i 2 e ix e iy x ei y ei s i 1 s i 2 s i 3 ε i 1 ε i 2 ε i 3 η l η l d il d il d il ϕ il ϕ il ϕ il ϒ i 3 γ i 3 e ψ i ψ ei s i 3 ε i 3 ψ ai where ϒ i 1 ϒ i 2 and ϒ i 3 are all continuous functions swaroop et al 2000 furthermore applying the assumptions 6 and 7 ϒ i has the maximum ϒ im on π i 1 π i 2 where π i 1 η l 2 η l 2 d il 2 d il 2 d il 2 ϕ il 2 ϕ il 2 ϕ il 2 α 0 α 0 0 π i 2 e ix e iy e ψ i x ei y ei ψ ei s i 1 s i 2 s i 3 ε i 1 ε i 2 ε i 3 v β 0 β 0 0 thus we can obtain 64 v 4 i j 1 3 1 ζ ij ϒ ij m 2 2 ε ij 2 3 2 choosing 1 ζ i 1 1 2 ϒ i 1 m 2 ζ i 1 1 ζ i 2 1 2 ϒ i 2 m 2 ζ i 2 1 ζ i 3 1 2 ϒ i 3 m 2 ζ i 3 64 can be rewritten as 65 v 4 i j 1 3 ε ij 2 ζ ij 3 2 where ζ ij is positive constant step5 substituting adaptive law 47 into the time derivative of v 5 i we can obtain 67 v 5 i w i 1 t γ i 1 1 w i 1 w i 2 t γ i 2 1 w i 2 w i 3 t γ i 3 1 w i 3 j 1 3 s ij w ij t θ i z j 1 3 o i w ij t w ij by aiding of the assumptions 4 and 5 we can obtain 68 v 5 i j 1 3 s ij w ij t θ i z j 1 3 o i w ij 2 j 1 3 o i w ij 2 then substituting 55 58 61 65 and 68 into the time derivative of v i we have 69 v i l i 1 5 2 e xi 2 e yi 2 l i 2 3 2 e ψ i 2 l i 1 4 x ei 2 y ei 2 l i 2 5 2 ψ ei 2 l i 4 7 2 s i 1 2 s i 2 2 l i 4 2 s i 3 2 ζ i 1 1 ε i 1 2 ζ i 2 1 ε i 2 2 ζ i 3 1 2 ε i 3 2 j 1 3 o i w ij 2 1 2 j 1 3 g ij 2 1 2 j 1 3 ε ij 2 π i 1 2 π i 2 2 1 2 π i 3 2 1 2 ψ a i 2 j 1 3 o i w ij 2 3 2 now let us consider the lyapunov function candidate for leader following formation as follows 70 v i 1 n v 1 i v 2 i v 3 i v 4 i v 5 i substituting 69 into the time derivative of 70 we have 71 v 2 μ v c where μ min l i 1 5 2 l i 2 3 2 l i 1 4 l i 2 5 2 l i 4 7 2 l i 4 2 ζ i 1 1 ζ i 2 1 ζ i 3 1 2 min o i λ max γ ij 1 c 1 2 i 1 n j 1 3 g ij 2 j 1 3 ε ij 2 2 j 1 3 o i w ij 2 i 1 n π i 1 2 π i 2 2 1 2 π i 3 2 1 2 ψ a i 2 3 n 2 with the designing parameters satisfying 72 l i 1 4 l i 2 5 2 l i 4 7 2 ζ i 1 1 ζ i 2 1 ζ i 3 1 2 where λ max denotes the maximum eigenvalues integrating 71 over 0 t yields 73 0 v t c 2 μ v 0 c 2 μ e 2 μ t from the inequality 73 it is clearly indicated that v t is uniformly ultimately bounded for all v 0 β 0 on 0 t and by aiding of the proposition 1 then t therefore we can draw a conclusion that tracking errors x ei y ei ψ ei transformed errors e ix e iy e ψ i s i 1 s i 2 s i 3 filtered errors ε i 1 ε i 2 ε i 3 and rbfnn weighting errors w i 1 w i 2 w i 3 are all bounded furthermore it can be concluded from 29 and 33 that tracking errors x ei y ei ψ ei satisfy the prescribed transient performance without violating any ρ i j for all t 0 thus all error signals of closed loop system remain bounded and converge within ρ i j the proof is completed 5 simulation experiment in this section numerical simulations are provided to demonstrate performance of the designed control scheme for underactuated uuvs consider a formation system consisting of two followers and one leader the dynamics of each underactuated uuv is adopted from chen et al 2020 and the nominal parameters are given as follows i m 11 i 141 85 m 22 i 191 75 m 33 i 15 6 m 12 i m 21 i m 13 i m 31 i 0 ii c 13 i v r 191 75 v 5 7 r c 23 i u 141 85 u c 31 i v r 191 75 v 5 7 r c 32 i u 141 85 u and c 11 i c 12 i c 21 i c 22 i c 33 i 0 iii d 11 i u 45 6 67 26 u 10 u 2 d 22 i v r 29 54 73 85 v 15 r d 23 i v r 2 5 2 v 10 71 r d 32 i v r 2 4 13 v 0 2 r d 33 i v r 5 59 10 71 r 0 07 r and d 12 i d 21 i d 13 i d 31 i 0 for the leader follower formation the predefined desired distance d if and angle ϕ i f of two followers are set as 5 m 2 π 3 r a d and 5 m 4 π 3 r a d respectively in addition all uuvs are affected by time varying disturbance d o t in the earth frame as 74 d o t 1 0 25 s i n 0 08 t 0 5 π 0 05 s i n 0 04 t 0 125 π 1 0 15 s i n 0 04 t 0 5 π 0 05 s i n 0 04 t 0 125 π 0 1 s i n 0 5 t 0 2 π such that w t acting on uuv in the body frame can be represented as w t j ψ d o t for the finite time velocities observer the parameters are selected as ϖ 1 i 0 2 ϖ 2 i 0 02 and l ui l vi l ri 200 for the predefined performance functions following parameters are selected as ρ i 1 0 ρ i 2 0 20 ρ i 1 ρ i 2 2 ρ i 3 0 3 ρ i 3 π 9 l i 1 l i 2 0 005 and l i 3 0 02 the parameters of virtual filter are chosen as ζ i 1 ζ i 2 ζ i 3 0 2 to estimate uncertain terms rbf networks are employed there are 256 neuron nodes for each θ i z where z u i v i r i ς i 1 ς i 2 ς i 3 e ix e iy e i ψ ε i 1 ε i 2 ε i 3 t is the input vector of output feedback controller the gain matrices are defined as γ i 1 γ i 2 γ i 3 20 i 12 12 and the initial weights are randomly given in the range of 1 1 the centers c i are evenly placed in 1 5 1 5 1 1 1 1 1 5 1 5 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 the widths are chosen as σ i 5 the control parameters and gains of adaptive nn output feedback are chosen as π i 1 20 π i 2 30 π i 3 20 l i 1 5 l i 2 3 l i 3 2 l i 4 4 ζ i 1 2 ζ i 2 2 ζ i 3 1 θ i 1 0 0 θ i 2 0 0 θ i 3 0 0 5 1 closed loop performance in order to demonstrate the arbitrary time varying leader follower formation achieved by the proposed control scheme we carry out the following two cases i e straight line and curve line in the closed loop performance case1 the trajectory of the leader is defined as straight line using the following velocities 0 t u l 1 2 m s v l 0 m s r l 0 rad s the initial condition of leader is defined as η l 0 0 m 0 m 0 r a d t the initial conditions of two followers are defined as η 1 10 m 22 5 m 0 r a d t ν 1 0 m s 0 m s 0 r a d s t and η 2 10 m 2 5 m 0 r a d t ν 2 0 m s 0 m s 0 r a d s t case2 the trajectory of the leader is defined as curve line using the following velocities i 0 t 10 u l 1 2 m s v l 0 m s r l 0 rad s ii 10 t 20 u l s i n π t 20 m s v l 0 m s r l 0 rad s iii 20 t 50 u l 1 m s v l 0 m s r l 0 1 c o s π t 20 rad s and iv 50 t 100 u l 1 m s v l 0 m s r l 0 rad s the initial condition of leader is defined as η l 0 0 m 0 m 0 r a d t the initial conditions of two followers are defined as η 1 10 m 10 m 0 r a d t ν 1 0 m s 0 m s 0 r a d s t and η 2 10 m 10 m 0 r a d t ν 2 0 m s 0 m s 0 r a d s t respectively the simulation results are illustrated in figs 4 18 figs 4 6 show that the leader trajectory can be tracked under the proposed output feedback controller which indicates that the leader follower formation is well established in both straight line and curve line as depitcted in figs 6 12 output tracking errors can not only satisfy the prescribed performance bounds but also converge to a small value close to zero under model uncertainties and external disturbances it is observed that the proposed scheme is robust enough against uncertainties and disturbances besides figs 12 and 13 exhibit velocity observation errors which converge to the neighborhood of origin within a short time period thereby verifying the fact that the designed observer is effective figs 14 16 show the filter errors for virtual velocity design of backstepping all of which remain bounded with good convergence furthermore fig 16 shows norm of neural weights provided by adaptive update law 47 for two cases all of which are bounded the fast responses during the initial phase wtih transitory oscillations and finite time convergent nns are accounted for by its stronger capability to capture the lumped nonlinear terms composed of model uncertainties and external disturbance in 7 it is also evident that the formulated nn adaptive controller can provide optimal solutions for surge force and yaw moment within the finite time finally fig 17 demonstrates corresponding control inputs including surge force τ u and yaw moment τ r therefore from all above results it is implied that the proposed scheme is effective in achieving desired leader following formation in spite of the imposed uncertainties and disturbances 5 2 comparative results to further demonstrate advantages of our approach comparison simulations are conducted by using adaptive cooperative formation controller acfc lu et al 2018 for comparison simulations studies are conducted between two types of controllers with the same control parameters and initial states as previous two cases simulation results are shown in figs 18 20 it is observed that the proposed scheme can provide the satisfied transient and steady performance of the tracking errors in which performance constraints are never violated the prescribed bounds however the controller in lu et al 2018 clearly fails to satisfy the prescribed bounds and provides low convergence furthermore detailed comparisons of these two methods are summarized in table 1 in which integral absolute error iae defined as 0 t e i d τ integral time absolute error itae defined as 0 t t e i d τ and the integral of square error isa defined as 0 t τ u i 2 d τ and 0 t τ r i 2 d τ are introduced to evaluate transient performance steady state performance and control energy where e i e xi e yi e ψ i t from table 1 it is evident that the proposed method achieves a better dynamic performance in comparison to the acfc as it guarantees the lower iae and itae with the smaller control energy consumption isa consequently by incorporating finite time velocity observer prescribed transient performance and filter backstepping technique in output feedback controller design we conclude that the proposed scheme provides the better performances in the presence of model uncertainties unmeasured velocity external disturbance and prescribed performance remark 10 the control parameters have some effects on stability and performance i l i 1 and l i 2 are associated with the convergence of transformed errors e i e xi e yi e ψ i t l i 3 is related to estimating a time varying approach angle for tracking straight path and curve path and l i 4 should be selected sufficient large to ensure the close loop system ii π i 1 and π i 3 are related to compensated effects of saturated inputs and π i 2 influences the underactuated problem iii ϖ 1 i ϖ 2 i l ui l vi and l ri are parameters for the finite time velocity observer where ϖ 1 i and ϖ 2 i should be selected as small as possible while l ui l vi and l ri are chosen larger enough thereby achieving a small estimation error 6 conclusion this paper presented an adaptive output feedback trajectory tracking formation control scheme for underactuated uuvs with prescribed transient performance in the presence of model uncertainties and external disturbances to reflect realistic situation we considered that mass and damping matrices were off diagonal and only partial information about hydrodynamics was known to design controller with unknown velocites a finite time velocity observer was exactly constructed by aiding of only position information rbf nns were used to idenfity the lumped nonlinear terms composed of model uncertainies and external disturbances the prescribed transient performance functions were introduced to guarantee that all tracking errors were bounded within prescribed constraints in transformed coordinate stability analysis showed that uniformly ultimately boundness of all close loop signals were guraranteed simulation results demonstrated outperforming performance of the proposed control scheme for future work it is of interest to investigate avoiding obstacle and preserving connection with prescribed performance in leader following formation control of underactuated uuvs declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors acknowledge the financial support from the national natural science foundation of china under grant 11404205 natural sciencefoundation of shaanxi under grant 2019jq 026 and fundamental research funds for central universities under grant gk202103014 and gk201803023 and authors would like to thank all reviewers and editors who provided extensive invaluable comments and suggestions 
20625,this paper presents a finite time velocity observed based adaptive output feedback trajectory tracking formation control for underactuated unmanned underwater vehicles uuvs with prescribed transient performance for realistic dynamical uuv model we assume that the mass and damping matrices are off diagonal and only partial information about hydrodynamics is known and we simultaneously consider the problems of input saturation unmeasured velocity external disturbance and prescribed performance to design formation controller for this purpose a leader follower pattern is employed where each follower tracks its reference trajectory defined by the leader position and predetermined formation without requirement of leader velocity moreover a finite time velocity observer is constructed by utilizing only position and attitude information in a short time for increasing the robustness where the estimates are substituted for unmeasured velocities in output feedback then to guarantee that all output states do not violate prescribed transient performances a proper error system is established by non logarithmic error transformation function based on these designs an output feedback adaptive formation scheme is proposed where neural networks are utilized for identifying lumped nonlinear terms composed of uncertain hydrodynamics and external disturbances and auxiliary variables and their additional control terms are presented to handle input saturation and underactuated problems simultaneously using lyapunov stability theorem it is proved that all closed loop signals are uniformly ultimately bounded uub and tracking errors can be guaranteed within prescribed performance bounds simulation results demonstrate effectiveness of the proposed formation control scheme keywords unmanned underwater vehicle leader follower finite time velocity observer transient prescribed performance output feedback trajectory tracking 1 introduce the trajectory tracking problem of unmanned underwater vehicles uuvs has aroused more compelling interest in ocean engineering over the past decades including marine environment monitoring underwater topograph explorating hydrological date collection and marine rescue sahoo et al 2019 in order to exhibit its greater efficiency in contrast to a single one formation control for multiple uuvs has been more constructive in the real tracking applications wu et al 2020 saback et al 2020 sarda and dhanak 2019 aimed at achieving expected fomation pattern various remarkable results have been proposed i e leader follower pattern cui et al 2010 wang et al 2020a b virtual structure makavita et al 2019 beard et al 2001 behavior based strategy liang et al 2020a b balch et al 1998 and artificial potential field method fiorelli et al 2006 in particalar leader follower has achieved a significant theoretical formalization due to the simplicity and reliability cui et al 2010 wang et al 2019a b 2020 qi and cai 2018 liu et al 2019 which is essentially to ensure that all followers track the orientation and distance of a real or virtuel leader with prescribed offset however accurate tracking control of uuvs is a major challenge in real oceanic engineering and application since full knowledge of uuv dynamic model cannot be exactly obtained due to its inherent properties i e high nonlinearities and parameter perturbations therefore the control approach designed for tracking control should be able to alleviate the adverse effects caused by uncertainties in this respect numerous control techniques have been proposed including adaptive control makavita et al 2019 antonelli et al 2003 fuzzy control sahu and subudhi 2018 sliding mode control qiao and zhang 2019 2020 dynamic surface control wang et al 2019a b neural network nn lu et al 2018 park 2015 model predictive control saback et al 2020 li et al 2017 data driven control peng et al 2019a b extended state observer eso peng et al 2019a b and lyapunov direct function liu and chen 2020 these results have been reported to achieve robustness against uncertainties and where nn based technique has been becoming one of the most promising tools to compensate for uncertain terms cui et al 2010 wang et al 2020a b lu et al 2018 park 2015 peng et al 2019a 2019b unfortunately some of the aforementioned studies only consider the case that the uuv is fully actuated in practice most torpedo like uuvs are underactuated cui et al 2010 liu et al 2019 which generally have three freedom degrees but only two control signals i e surge force and yaw moment are available for control design it is clear that an underactuated uuv invariably suffers from variations in sway direction thereby resulting in non integral constraints in addition an accompanied problem of input saturation may be easily triggered due to its restricted physical actuators li et al 2019 omid and khoshnam 2020 therefore comparing with control approaches involving with fully actuated uuvs complicated uncertainty to underactuated uuvs has attracted a considerable amount of attentions on attempting to design high performance tracking control approaches because of the design simplification and ease of implementation several traditional approaches such as local linearization and input output decoupling have been employed to design tracking controllers fossen 1994 however it has already been pointed in bechlioulis et al 2017 that closed loop performance is poor an alternative approach involved with backstepping technique cui et al 2010 which however suffered from an explosion of complexity problem caused by repeated differentiations peng et al 2017a b to end this dynamic surface control dsc techniques i e neural dsc li et al 2019 and fuzzy dsc liang et al 2020a b were reported for uncertainties of underactuated uuv in the aim of handling uncertainties a neural based adaptive robust formation control strategy was proposed in peng et al 2011 in the presence of unknown hydrodynamic damping an adaptive neural based leader following formation controller was presented for multiple uuvs park 2015 it was worthwhile mentioning that a novel approach angle method to track any reference paths i e curve path and straight path was introduced into control input to solve underactuation which only required the position information unlike the approach angle only suitable for case of straight path but requiring both position and velocity information in lionel and didik 2007 based on previous works a robust sliding mode formation control strategy of underactuated uuv was presented by utilizing backstepping adaptive neural network and dsc technique but its obtained results should hold an important assumption that the sway velocity was passive bounded wang et al 2020a b it is noted that all aforementioned results are obtained under an assumption that the exact full state information including the linear and angular velocities in body fixed reference frame and the positions and attitude in inertial reference frame is available for feedback control design however velocity information may not be readily acquired due to the considering equipment cost and the risk of sensors damage even if it can be acquired certain signal noises will be brought therefore it is necessary to design an output feedback control and some control schemes have been reported for nonlinear system based on observers chen et al 2020 li et al 2015 peng et al 2017a b in order to recover unavailable velocity high gain observers chen et al 2020 were commonly developed with only position and yaw angle information whereas uncertainties cannot be estimated a backstepping based observer li et al 2015 was designed to reconstruct velocity but all parameters were required to be known moreover a echo state network based observer peng et al 2017a b was designed to simultaneously identify the unmeasured velocities and uncertainties but its convergence was not assured among the above results existing observers are mostly infinite time qu et al 2020 accordingly a finite time velocity observer involved with output feedback tracking control for underactuated uuv formation is still an open issue besides output feedback tracking control some works can only guarantee uniformly ultimate boundedness while the transient performance such as convergence rate maximum overshoot or steady error bounds was not fully considered from a practical perspective transient performance can not only improve control performance but also ensure safety when vehicles influence by external disturbances induced by oceanic waves currents and tides therefore it is necessary to satisfy requirements of prescribed transient state and steady state performance to end this a remarkable prescribed performance was originally proposed for nonlinear system bechlioulis and rovithakis 2008 which can guarantee that all errors converge to a prescribed arbitrary small residual set while transient performance and overshoot are smaller than a sufficiently small preassigned constant this method has been efficiently utilized in several applications i e robots spacecraft and visual servo for the tracking control of underwater vehicle with prescribed performance a control scheme with prescribed performance for underactuated uuvs was firstly proposed by bechlioulis et al 2017 in omid and khoshnam 2018 a neural network based tracking control with prescribed performance was investigated to design a full state feedback controller for underactuated autonomous underwater vehicles auvs in liu et al 2020 an adaptive thruster fault tracking control problem was addressed with prescribed transient performance in addition dai et al 2018 had developed a full state feedback platoon formation controller using the benefit of prescribed performance to improve convergence rate finite time performance function wang et al 2021 and non logarithmic piecewise error mapping function li et al 2020 have also been introduced into tracking control problem apparently all aforementioned works are essentially a path following problem where the reference path is generated by a virtual point with an independent variable rather than the more difficult trajectory tracking since the controller requires to drive the uuv reaching and tracking a time varying trajectory on time jia et al 2019 moreover it is turned out that these controllers are all based on an assumption that off diagonal terms in mass and damping matrices of underactuated uuv are zero indeed this restrictive assumption is not tenable the reason is that most underactuated uuvs are not a semi submerged sphere therefore yaw moment control effects directly on sway dynamics which results in the difficulty in control design in order to overcome this problem do et al 2005 firstly proposed a nonlinear coordinate transformation with diagonal form to relax this restrictive assumption furthermore based on the coordinate transformation with diagonal form containment control and formation control design sung and bong 2015 can be achieved although all these works benefit from the above assumption it also requires accurate model parameters on hydrodynamic damping in general viscous hydrodynamic damping of uuv is mainly caused by potential damping possible skin friction wave drift damping vortex shedding damping and lifting forces different damping terms can be divided into both linear and nonlinear damping fossen 2011 the linear damping coefficients i e potential damping and possible skin friction can be calculated by semi exprical method or computation programs however nonlinear damping coefficients such as wave drift damping vortex shedding damping and lifting forces are difficult to acquire in most cases due to their nonlinear characteristics jia et al 2019 therefore discrepancies between the nominal and actual model are utilized to design the controller with only partial information chen et al 2020 motivated by aforementioned observations challenges on accurate control for uuv are mainly derived from uncertainties i e parameter perturbation input saturation underactuated constricts and prescribed transient and steady state performance as well as external disturbance to our best knowledge there is no work on accommodating these issues simultaneously in leader follower formation tracking control for underactuated uuvs therefore a finite time velocity observed based adaptive output feedback formation tracking controller is investigated to achieve trajectory tracking while ensuring the prescribed transient and steady state performance on output tracking errors for a more general case we design this controller under the assumption that mass and hydrodynamic terms are off diagonal and prior information on hydrodynamics is partial uncertain meanwhile velocity information is unmeasurable main contributions of this paper are summarized as follows 1 in contrast to existing results cui et al 2010 dennis et al 2019 li et al 2020 wang et al 2020a 2020b the proposed formation control scheme based on leader follower only relies on both positions and orientations available to track both straight line path and curve line path where required velocities for output feedback control designing are recovered by using finite time velocity observer rather than the most commonly used infinite time high gain observers chen et al 2020 it is more convenient to implement this in practice 2 in order to achieve the tracking with prescribed transient performance despite the presence of parameter uncertainty and external disturbances a novel output feedback trajectory tracking formation controller with prescribed performance for underactuated uuvs is firstly developed where tracking errors in transformed coordinate can be guaranteed to satisfy prescribed transient and steady state behaviors i e convergence rate and maximum overshoot by means of the non logarithmic error transformation functions 3 simultaneously increasing greatly robustness against input saturation and underactuated constricts and discarding the assumption that sway velocity is passive bounded in previous works wang et al 2019a b 2020 omid and khoshnam 2018 jia et al 2019 three auxiliary virtual variables and their additional control terms are designed based on filter backstepping and adaptive neural network and all of which are incorporated into the proposed output feedback tracking controller moreover all closed loop signals are uniformly ultimately bounded within the given prescribed performance bounds the reminder of this paper is organized as follows section 2 introduces the preliminaries and problem formulation section 3 details the adaptive robust output feedback control design section 4 gives main results section 5 illustrates simulation experiments finally section 6 concludes this paper and discusses the future work 2 preliminaries and problem formulation 2 1 preliminaries proposition 1 ryan 1991 for a general initial value problem 1 ω t f ω t ω 0 ω 0 ω 0 r m ω t r m where f ω t is a continuous function on r m if the solution for 1 is bounded then t lemma 1 wen et al 2018 consider a smooth function v t and its initial state v 0 is bounded if there exists an inequality v t 2 μ v c holding with c 0 and μ 0 for any time this inequality can be obtained 2 v t v 0 c 2 μ exp μ t c 2 μ lemma 2 khalil 2002 young inequality is expressed for any positive a b r 3 ab k p p a p 1 q k q b q where k 0 p 1 q 1 p 1 q 1 1 lemma 3 shtessel et al 2007 consider a nonlinear system x t f x t 4 x 0 z 0 x 1 z 0 ϖ 0 l 1 n 1 x 0 n n 1 sgn x 0 x 1 z 1 x 2 z 1 ϖ 1 l 1 n x 1 x 0 n 1 n sgn x 1 x 0 x n 1 z n 1 x n z n 1 ϖ n 1 l 1 2 x n 1 x n 2 1 2 sgn x n 1 x n 2 x n z n l l z n ϖ n l sgn x n x n 1 where ϖ i i 0 1 m and l are positive constants hence the original system x t f x t is finite time stable by aiding of setting suitable ϖ i 0 and l 0 remark 1 due to the expensive cost and simplifying mechanism velocity measuring instruments may not be equipped on uuv body and velocity information is unavailable for designing output feedback control such that lemma 3 can be employed to design a nonlinear finite time velocity observer for estimating unmeasurable velocities 2 2 modeling uuv formation system consider a leader follower formation system consisting of n underactuated uuvs with index set n 1 2 n to accurately illustrate the motion of each uuv earth fixed frame e and body fixed frame b are formulated in fig 1 the kinematic and dynamic model of the i th uuv is provided as do and pan 2009 fossen 2011 5 η i j ψ i ν i m i ν i c i ν i ν i d i ν i ν i δ i τ w i where η i x i y i ψ i t ℝ 3 is a vector of position x i y i and yaw angle ψ i 0 2 π in earth fixed frame respectively ν i u i v i r i t ℝ 3 is a velocity vector in surge u i sway v i and yaw r i in body fixed frame w i w ui w vi w ri t denotes the external unknown disturbances j ψ i ℝ 3 3 is the rotation matrix and μ i ℝ 3 3 c i ℝ 3 3 and d i ℝ 3 3 are the non diagonal inertia matrix coriolis matrix and damping matrix respectively all of which are given by 6a j ψ i cos ψ i sin ψ i 0 sin ψ i cos ψ i 0 0 0 1 6b μ i m 11 i 0 0 0 m 22 i m 23 i 0 m 23 i m 33 i 6c c i 0 0 m 22 i v i m 23 i r i 0 0 m 11 i u i m 22 i v i m 23 r i m 11 i u i 0 6d d i d 11 u i 0 0 0 d 22 v i r i d 23 v i r i 0 d 32 v i r i d 33 v i r i where m 11 i m i x u i m 22 i m i y v i m 23 i m i x gi y r i m 33 i i zi n r i d 11 u i x ui x ui ui u i d 22 v i r i y vi y vi vi v i y ri vi r i d 23 v i r i y ri y vi ri r i y ri ri r i d 32 v i r i n vi n vi vi v i n ri vi r i d 33 v i r i n ri n vi ri v i n ri ri r i here m i denotes the mass of uuv x gi is the center of gravity in body fixed frame and i zi is the moment of inertia with respect to yaw x u i y v i y r i and n r i are the added masses x ui x ui ui y vi y vi vi y ri vi y vi ri y ri ri n vi n ri n vi vi n ri vi n vi ri and n ri ri are the hydrodynamic derivatives τ i τ u i 0 τ r i t ℝ 3 denotes the control input vector consisting of surge force τ u i and yaw moment τ r i suffering from the unmodelled dynamics and parametric perturbations the precise modeling on hydrodynamic is difficult to be obtained such that the dynamics matrices can be divided into the nominal part and shift part jia et al 2019 chen et al 2020 i e m i m i δ m i c i c i δ c i and d i d i δ d i where i represents the nominal parameter and δ i describes a shifted difference between real and nominal parameters therefore the dynamics 5 can be formatted 7 μ i ν i c i ν i ν i d i ν i ν i δ i τ d i where d i δ μ i ν i δ c i ν i ν i δ d i ν i ν i w i and the kinematic model for the i th uuv can be formulated as 8 x i u i c o s ψ i v i s i n ψ i y i u i s i n ψ i v i c o s ψ i ψ i r i assumption 1 the unknown disturbance w i w ui w vi w ri t and its derivative are bounded and satisfy the following condition 9 w i t w i where w i is unknown positive constant assumption 2 the control input τ i is determined by saturation function δ τ i δ τ u i 0 δ τ r i t ℝ 3 as follows 10 δ τ j i τ j i max i f τ j i τ j i max τ j i i f τ j i min τ j i τ j i max τ j i min i f τ j i τ j i min j u r where τ j i max and τ j i min are upper and lower bounds of control forces or moments respectively in addition a dead zero function χ i χ u i 0 χ v i τ i δ τ i is defined to express mismatch between the control with saturation and without saturation hence saturation control in 5 can be given by δ τ i τ i χ i remark 2 the partial information about underactuated uuv in 7 are available in nominal part which can be utilized for control design purpose unlike the previous works either considering full prior knowledge do and pan 2005 or without any prior knowledge wang et al 2017 on model parameters the two cases are both not real from a practical point of view moreover shift part between normal and actual model can be approximated by nns 2 3 coordinate transformation most like torpedo uuvs are not submerged sphere bechlioulis et al 2017 so mass matrices μ i cannot be assumed as diagonal due to its non diagonal item m 23 i this means that the yaw moment τ r can influence directly on sway dynamics in 5 in such case it is difficult to formulate the control design therefore we introduce a coordinate transformation do and pan 2005 to make the non diagonal mass matrices as a diagonal form 11 x i x i ξ i s i n ψ i y i y i ξ i c o s ψ i v i v ri ξ i r i where ξ i m 23 i m 22 i then the uuv mathematical model can be rewritten as 12 x i u i c o s ψ i v i s i n ψ i y i u i s i n ψ i v i c o s ψ i ψ i r i 13 u i φ ui ϕ ui τ ui χ ui m 11 i v i φ vi ϕ vi ψ i φ ri ϕ ri τ ri χ ri δ i where φ u i m 22 i m 11 i v ri r i m 23 i m 11 i r i 2 d 23 i u r i m 11 i u ri φ v i m 11 i m 22 i u ri r i d 22 i v r i r i m 22 i v r i d 23 i v r i r i m 22 i r i φ r i 1 δ i m 11 i m 22 i m 22 i m 22 i u ri v ri m 11 i m 23 i m 22 i m 23 i u ri r i m 22 i d 33 i v ri r i r i d 32 i v ri r i v ri m 23 i d 23 i v ri r i r i d 22 i v ri r i v ri ϕ ui d ui m 11 i ϕ vi d vi m 22 i ϕ ri m 23 i d vi m 22 i d ri δ i δ i m 22 i m 33 i m 23 i m 23 i j u v r i 1 2 n in addition we define η i x i y i ψ i t and ν i u i v i r i t assumption 3 we assume that v i u i v i r i t is bounded due to saturated control input 10 and m i is known so φ u i φ v i φ v i are lipschitz with respect to velocity v i u i v i r i t and ϕ ui ϕ vi ϕ ri are bounded and unknown chen et al 2020 remark 3 the m i c i and d i can be calculated using semi empirical methods or hydrodynamic computation programs however φ u i φ v i φ v i and ϕ ui ϕ vi ϕ ri involved with the nonlinear damping terms are difficult to obtain accurately and if such inaccurate information is utilized it may lead to undesired performance park 2015 such that we will design the controller without nonlinear damping matrix information remark 4 the coordinate transformation in 1 is equivalent to moving the frame b forward a short distance ε i m 23 m 22 in surge direction such that diagonal forms 12 and 13 derived from 5 can be achieved 2 4 rbf neural networks due to the good approximation rbf nns are employed to address estimating uncertain hydrodynamic damping terms in this paper we use the following rbf nns to approximate a continuous smooth function h z r q r 14 h z w t θ z where input vector z ω r q weighting vector w r n n denotes the number of neurons and θ z θ 1 z θ 2 z θ n z r n is a nonlinear activation vector which is given by 15 θ i z exp z c i t z c i σ i 2 i 1 2 n where c i and σ i are the center and width of the i th gaussian function respectively it has been proved that the aforesaid rbf nns can approximate any continuous function h z over a compact set ω z r q to any arbitrary degree of accuracy as 16 h z w t θ z ε z z ω r q where ε z is a bounded approximation error satisfying ε ε and the unknown constant ε 0 is for all z ω z and w is an optimal weight vector and it is defined as 17 w arg min w r n sup z ω z h z w t θ z it is noted that both w and ε are unknown constants which are only used for analytical propose for real scenarios an estimation w is used for practical approximation instead of the w hence an estimation of h z can be given by 18 h z w t θ z where w can be estimated online by designing adaptive law assumption 4 the w is bounded i e w w where w is a positive constant assumption 5 ge and wang 2002 for w w and w w w an error can be formulated by 19 w t θ z w t θ z w t θ z and then following inequalities can hold 20a χ w t w t χ 2 w 2 w 2 20b θ i z c i where χ and c i are positive constants 2 5 problem formulation the objective of this paper is to design an adaptive output feedback formation controller for n underactuated uuvs such that each vehicle can track a desired leader with the prescribed performance while the tracking errors are confirmed to the predefined performance bounds in the presence of model uncertainties and external disturbances let η l x l y l ψ l t and η i r x i r y i r ψ i r t be the desired leader and reference trajectory of the i th follower respectively as illustrated in fig 1 the predefined desired distance d if and angle ϕ i f are introduced to illustrate the relative position between η l and η i r which is formulated as follows 21 x ir x l d if c o s ψ l ϕ if y ir y l d if s i n ψ l ϕ if ψ ir ψ l where x l x l ξ l c o s ψ l y l y l ξ l s i n ψ l define the transformed positions and yaw error 22 x ei x i x ir y ei y i y ir ψ ei ψ i ψ ai where ψ a i is an approach angle to track desired leader for the i th uuv formulated as park 2015 23 ψ a i atan y e i x e i tanh h 2 a 0 ψ l 1 tanh h 2 a 0 where a 0 is a positive constant and h x ei 2 y ei 2 assumption 6 the η i x i y i ψ i t is available and ν i u i v i r i t is unmeasured assumption 7 the leader position η l x l y l ψ l t is bounded and available only for followers who are within communicating region assumption 8 the time varying unknown ψ a i is bounded such that ψ a i ψ a i where ψ a i is positive constant remark 5 as stated in assumptions 1 2 3 6 7 and 8 model uncertainty and external disturbance and their bounds are unknown in this paper the most commonly used methods such as function approximators and adaptive techniques for uuv need great computation and time for estimating uncertainties and their bounds especially for unmeasured ν i u i v i r i t 3 adaptive robust output feedback control design the section is devoted to designing the adaptive robust output feedback control scheme for the leader following formation 3 1 finite time velocity observer in practical application uuv position η x y ψ t can be readily measured via sonars whereas its velocity ν u v r t may be unmeasured due to the expensive cost of measured devices i e doppler velocity log dvl and inertial navigation system ins to identify the velocity for output feedback control design we develop a finite time velocity observer to exactly estimate the velocity by aiding of only position information hence observer for the i th uuv is constructed based on kinematics 5 as follows 24 η i z 0 i z 0 i ϖ 1 i l i 1 2 η i η i 1 2 sgn η i η i j ν i j ν i ϖ 2 i l i sgn j ν i z 0 i where ϖ 1 i 0 and ϖ 2 i 0 are designing observer coefficients l i diag l ui l vi l ri ℝ 3 is gain with l ui 0 l vi 0 l ri 0 and η i and ν i are the estimations for η i and ν i respectively consider observation errors between estimation and true value as 25 ε i η η i η i ε i ν j ν i j ν i taking the derivative of 25 along 24 we have 26 ε i η ϖ 1 i l i 1 2 η i η i 1 2 sgn η i η i j ν i j ν i ϖ 1 i l i 1 2 ε i η 1 2 sgn ε i η ε i ν ε i ν ϖ 2 i l i sgn ϖ 1 i l i 1 2 ε i η 1 2 sgn ε i η j ν i ϖ 2 i l i sgn ε i ν ε i η d d applying the lemma 3 it is indicated from 26 that velocity observation error ε i ν can be ensured to converge to zero within a finite time i e existing 0 t such that 27 ε i ν t ε i ν t ε e ν t t 28 u t u t v t v t r t r t t t where ε e ν 0 hence we can conclude that ν i can be accurately estimated by observers ν i remark 6 to facilitate the output feedback controller designing we replace an unmeasurable velocity ν u v r t with its estimations ν u v r t provided by the observer 24 furthermore this observer can simultaneously guarantee greater convergence and stronger anti disturbance and all errors can exactly converge to zero within a short time rather than existing methods can only achieve a convergence without considering the time 3 2 prescribed performance control in the presence of input saturation and unknown disturbance transient overshoot and convergence rate of tracking errors are easily triggered to violate a prescribed boundness to avoid such serious accidents we introduce a prescribed performance control ppc to strictly guarantee all tracking errors converging within a predefined region that is bounded by decaying time function consider a tracking error vector e i x ei y ei ψ ei t ℝ 3 and mathematical ppc is stated as 29 α i 1 ρ i 1 x ei t β i 1 ρ i 1 t 0 α i 2 ρ i 1 y ei t β i 2 ρ i 1 t 0 α i 3 ρ i 1 ψ ei t β i 3 ρ i 1 t 0 where 0 α i j β i j 1 are prescribed scale parameters i 1 2 n j 1 2 3 and ρ i j t ℝ ℝ is defined as predefined bounded function 30 ρ i j t ρ i j 0 ρ i j exp l i j t ρ i j i 1 2 n j 1 2 3 where ρ i j 0 ρ i j and l ij are strictly positive constants ρ i j 0 ρ i j and ρ i j t l i j ρ i j 0 ρ i j furthermore this statement with a case of ρ ij t 20 2 exp 0 005 t 2 is illustrated in fig 2 remark 7 the ρ ij i 1 2 n j 1 2 3 is smooth positive decreasing and bounded function satisfying lim x ρ ij t ρ i j 0 the l ij represents the minimum convergence rate for e i and ρ i j describes the maximum allowable size of e i at steady state furthermore the maximum overshot is prescribed less than α j ρ ij 0 if e i 0 0 or less than β j ρ ij 0 if e i 0 0 which may even become zero by setting α i j 0 or β i j 0 respectively such that e i can be imposed performance bounds by elaborately selecting parameters however it is a major challenge to ensure that 30 is always satisfied hence an error transformation is defined to achieve the system incorporated with the performance constraints 29 as follows 31 x ei t ρ i 1 t s i 1 e xi y ei t ρ i 2 t s i 2 e yi ψ ei t ρ i 3 t s i 3 e ψ i where e i e xi e yi e ψ i t ℝ 3 is the transformed error vector and s ij is defined as strictly monotonically increasing functions 32 s i 1 e xi β i 1 exp e xi α i 1 exp e xi exp e xi exp e xi s i 2 e yi β i 2 exp e yi α i 2 exp e yi exp e yi exp e yi s i 3 e ψ i β i 3 exp e ψ i α i 3 exp e ψ i exp e ψ i exp e ψ i where i 1 2 n j 1 2 3 α i j s ij β i j then we can obtain 33 e xi t s i 1 1 x ei t ρ i 1 t 1 2 ln α i 1 z i 1 β i 1 z i i 1 e yi t s i 2 1 y ei t ρ i 2 t 1 2 ln α i 2 z i 2 β i 2 z i 2 e ψ i t s i 3 1 ψ ei t ρ i 3 t 1 2 ln α i 3 z i 3 β i 3 z i 3 where s ij 1 is essentially a mapping α i j β i j in addition the aforesaid transformation function is illustrated with α i j β i j 1 in the fig 3 meanwhile taking the time derivatives of transformed error in 33 and yielding 34a e xi t 1 2 1 α i 1 z i 1 1 β i 1 z i 1 z i 1 ϱ i 1 ρ i 1 x ei x ei ρ i 1 ρ i 1 34b e yi t 1 2 1 α i 2 z i 2 1 β i 2 z i 2 z i 2 ϱ i 2 ρ i 2 y ei y ei ρ i 2 ρ i 2 34c e ψ i t 1 2 1 α i 3 z i 3 1 β i 3 z i 3 z i 3 ϱ i 3 ρ i 3 ψ ei ψ ei ρ i 3 ρ i 3 where ϱ ij 1 2 ρ ij 1 α j z ij 1 β j z ij z i 1 x ei ρ i 1 z i 2 y ei ρ i 2 z i 3 ψ ei ρ i 3 and existing z ij 1 j 1 2 3 assumption 9 the tracking errors satisfy α i 1 ρ i 1 0 x ei 0 β i 1 ρ i 1 0 α i 2 ρ i 2 0 y ei 0 β i 2 ρ i 2 0 and α i 3 ρ i 3 0 ψ ei 0 β i 3 ρ i 3 0 when t 0 lemma 4 consider the tracking error vector e i t x ei y ei ψ ei t satisfying assumption 9 and the transformed error 34 the prescribed transient performance satisfying 29 can be guaranteed for all t 0 when e i e xi e yi e ψ i t is bounded from 31 and 34 proof due to bounded e i e xi e yi e ψ i t we assume that it should satisfy with unknown constant vectors i e e i and e i such that 35 e i e i e i t 0 employing the inverse transformation s ij 1 into 35 we can obtain 36 s i 1 e xi ρ i 1 t x ei t s i 1 e xi ρ i 1 t t 0 s i 2 e yi ρ i 2 t y ei t s i 2 e yi ρ i 2 t t 0 s i 3 e ψ i ρ i 3 t ψ ei t s i 3 e ψ i ρ i 3 t t 0 owing to the properties of α i j β i j we can obtain 37 α i 1 ρ i 1 t x ei t β i 1 ρ i 1 t α i 2 ρ i 2 t y ei t β i 2 ρ i 2 t α i 3 ρ i 3 t ψ ei t β i 3 ρ i 3 t moreover due to the positive and decreasing ρ i j t prescribed performance of the corresponding tracking errors can be guaranteed within boundness 38 ω ij e i ℝ x ei t ρ i 1 y ei t ρ i 1 ψ ei t ρ i 3 therefore it proves that prescribed transient performance can be satisfied for all t 0 the proof is completed here 3 3 filter backstepping for virtual velocity design to stabilize the transformed tracking errors 30 we employ the filter backstepping technique to design the appropriate virtual velocities in this subsection the virtual velocity γ i γ i 1 γ i 2 γ i 3 t for observed velocity ν i u i v i r i t is designed by 39a γ i 1 l i 1 e x i cos ψ i l i 1 e y i sin ψ i u l cos ψ i ψ l v l cos ψ i ψ l d i l ϕ i l r l s i n ϕ i l ψ l ψ i d i l c o s ϕ i l ψ l ψ i 39b γ i 2 l i 1 e x i sin ψ i l i 1 e y i cos ψ i u l cos ψ i ψ l v l cos ψ i ψ l d i l ϕ i l r l s i n ϕ i l ψ l ψ i d i l c o s ϕ i l ψ l ψ i 39c γ i 3 l i 2 e ψ i ψ ˆ a i where l i 1 and l i 2 are positive constants and u l v l and r l provided by velocitey observers are estimates of u l v l and r l respectively moreover ψ ˆ a i is an unknown time varying estimate of ψ a i provided by designing observer as ψ ˆ a i μ i l i 3 ψ e i and μ i l i 3 r i μ i l i 3 ψ ei where l i 3 is positive constant it is noticed that derivatives of observed u l v l and r l are unavailable for output feedback according to the assumption 7 which can lead to an explosion of complexity problem due to the repeated differentiations of virtual velocity control signals to avoid this problem in backstepping procedure dsc design is introduced i e let γ i pass through a first order filter in following design 40 ζ ij ς ij ς ij γ ij ς ij 0 γ ij 0 i 1 2 n j 1 2 3 where ς i ς i 1 ς i 2 ς i 3 t is a filtered virtual control input vector and ζ j ζ i 1 ζ i 2 ζ i 3 t 0 is the designing time parameter it can eliminate the analytic computation of γ i define the filter error vector as 41 ε i ς i γ i where ε i 1 ς i 1 γ i 1 ε i 2 ς i 2 γ i 2 and ε i 3 ς i 3 γ i 3 from the 40 and 41 we have the derivative of ε i as 42 ε i ε i ζ i j γ i define the first order new errors between filtered virtual and actual velocities as 43a s i 1 u i ς i 1 π i 1 tanh θ i 1 43b s i 2 v i ς i 2 π i 2 tanh θ i 2 43c s i 3 r i ς i 3 π i 3 tanh θ i 3 where ν i u i v i r i t can be estimated by the finite time velocity observer and θ i 1 θ i 2 and θ i 3 are the auxiliary control terms given by park et al 2017 44a θ i 1 cosh 2 θ i 1 ℓ i 1 θ i 1 χ u i m 11 i π i 1 44b θ i 2 cosh 2 θ i 2 φ v i l i 4 s i 1 l i 4 s i 2 l i 4 s i 3 w i 2 t θ i 2 z x e i sin ψ i y e i cos ψ i π i 2 44c θ i 3 cosh 2 θ i 3 ℓ i 2 θ i 1 m 22 i χ r i δ π i 3 where π i 1 π i 2 and π i 3 are positive constants and l i 4 ℓ i 1 and ℓ i 2 are positive constants taking the time derivatives of s i 1 s i 2 and s i 3 along 44 we have 45a s i 1 φ ui ϕ ui ς i 1 ℓ i 1 θ i 1 τ ui m 11 i 45b s i 2 ϕ vi ς i 2 l i 4 s i 1 l i 4 s i 2 l i 4 s i 3 w i 2 t θ i 2 z x ei sin ψ i y ei cos ψ i 45c s i 3 φ ri ϕ ri ς i 3 ℓ i 2 θ i 1 m 22 i τ ri δ remark 8 the auxiliary control terms θ i 1 and θ i 3 are proposed to compensate input saturation and θ i 2 is proposed to handle the underactuation of uuv which can relax the assumption that the sway velocity is passive bounded wang et al 2019a b 2020 omid and khoshnam 2018 jia et al 2019 3 4 neural network based output feedback controller the output feedback control signals for leader follower formation are designed as follows 46 τ u i m 11 i φ u i ℓ i 1 θ i 1 l i 4 s i 1 l i 4 s i 2 w i 1 t θ i 1 z ς i 1 x e i sin ψ i y e i cos ψ i τ r i δ φ r i ℓ i 2 θ i 3 l i 4 s i 2 l i 4 s i 3 w i 3 t θ i 3 z ς i 3 ψ e i m 22 i with the adaptive law 47 w ij γ ij θ i z s ij o i w ij j 1 2 3 where o i is positive control parameter substituting 46 and 47 into 45 yields 48 s i 1 l i 4 s i 1 l i 4 s i 2 w i 1 t θ i 1 z x ei sin ψ i y ei cos ψ i ε i 1 s i 2 l i 4 s i 1 l i 4 s i 2 l i 3 s i 3 w i 2 t θ i 2 z x ei sin ψ i y ei cos ψ i ε i 2 s i 3 l i 4 s i 2 l i 4 s i 3 w i 3 t θ i 3 z ψ ei ε i 3 where w ij t w ij t w ij t ϕ u i w i 1 t θ i 1 z ε i 1 ϕ v i w i 2 t θ i 2 z ε i 2 ϕ r i w i 3 t θ i 3 z ε i 3 taking the time derivatives both sides of 22 along the solutions of 12 as follows 49 x ei u i c o s ψ i v i s i n ψ i u l c o s ψ l v l s i n ψ l d il c o s ψ l ϕ il d lf r l ϕ il s i n ψ l ϕ il y ei u i s i n ψ i v i c o s ψ i u l s i n ψ l v l c o s ψ l d il s i n ψ l ϕ il d ll r l ϕ il c o s ψ l ϕ il ψ ei r i ψ ai substituting 43 into 49 yields 50 x ei s i 1 ε i 1 γ i 1 π i 1 t a n h θ i 1 c o s ψ i s i 2 ε i 2 γ i 2 π i 2 t a n h θ i 2 s i n ψ i u l c o s ψ l v l s i n ψ l d il c o s ψ l ϕ il d lf r l ϕ il s i n ψ l ϕ il y ei s i 1 ε i 1 γ i 1 π i 1 t a n h θ i 1 s i n ψ i s i 2 ε i 2 γ i 2 π i 2 t a n h θ i 2 c o s ψ i u l s i n ψ l v l c o s ψ l d il s i n ψ l ϕ il d lf r l ϕ il c o s ψ l ϕ il ψ ei s i 3 ε i 3 γ i 3 π i 3 t a n h θ i 3 ψ ai and substituting 50 and into 34 yields 51 e xi t ϱ i 1 s i 1 c o s ψ i s i 2 s i n ψ i ε i 1 c o s ψ i ε i 2 s i n ψ i l i 1 e x i g i 1 e yi t ϱ i 2 s i 1 s i n ψ i s i 2 c o s ψ i ε i 1 s i n ψ i ε i 2 c o s ψ i l i 1 e y i g i 2 e ψ i t ϱ i 3 s i 3 ε i 3 l i 2 e ψ i g i 3 where g i 1 π i 1 t a n h θ i 1 c o s ψ i π i 2 t a n h θ i 2 s i n ψ i z i 1 ρ i 1 g i 2 π i 1 t a n h θ i 1 s i n ψ i π i 2 t a n h θ i 2 c o s ψ i z i 2 ρ i 2 g i 3 ψ ˆ ai π i 3 t a n h θ i 3 ψ ai z i 3 ρ i 3 remark 9 due to the t a n h θ i 1 1 t a n h θ i 2 1 s i n ψ i 1 c o s ψ i 1 z ij 1 and ρ i j t l i j ρ i j 0 ρ i j j 1 2 3 it is implied that g ij is bounded such that g i 1 g i 1 g i 2 g i 2 g i 3 g i 3 4 main results in this section we summarize the main results of this paper in the following theorem theorem 1 consider the underactuated uuv model 7 in leader following tracking system 22 and 23 with external disturbances 9 and input saturation 10 and suppose that assumptions 1 3 and 6 8 are satisfied if the error transformed function is applied by 33 the finite time velocity observer is calculated by 24 the filter backstepping velocity controller is designed by 44 and the output feedback controller for leader following formation is updated by 46 with adaptive law given by 47 then the output feedback controller can guarantee the following statements i the x ei y ei and ψ e i can be guaranteed within the given prescribed performance bound ρ i j ii all control signals of the closed loop system remain bounded proof consider the following lyapunov function candidate for the i th uuv as 52 v i v 1 i v 2 i v 3 i v 4 i v 5 i where v 1 i 1 2 ϱ i 1 e xi 2 1 2 ϱ i 2 e yi 2 1 2 ϱ i 3 e ψ i 2 v 2 i 1 2 x ei 2 1 2 y ei 2 1 2 ψ ei 2 v 3 i 1 2 s i 1 2 1 2 s i 2 2 1 2 s i 3 2 v 4 i 1 2 ε i 1 2 1 2 ε i 2 2 1 2 ε i 3 2 v 5 i 1 2 w i 1 t γ i 1 1 w i 1 1 2 w i 2 t γ i 2 1 w i 2 1 2 w i 3 t γ i 3 1 w i 3 step1 substituting 51 into the time derivative of v 1 i we have 53 v 1 i 1 ϱ i 1 e xi e xi 1 ϱ i 2 e yi e yi 1 ϱ i 3 e ψ i e ψ i l i 1 e xi 2 l i 1 e yi 2 l i 2 e ψ i 2 e xi s i 1 c o s ψ i s i 2 s i n ψ i e xi ε i 1 c o s ψ i ε i 2 s i n ψ i e xi g i 1 e yi s i 1 s i n ψ i s i 2 c o s ψ i e yi ε i 1 s i n ψ i ε i 2 c o s ψ i e yi g i 2 e ψ i s i 3 e ψ i ε i 3 e ψ i g i 3 l i 1 e xi 2 l i 1 e yi 2 l i 2 e ψ i 2 e xi s i 1 e xi s i 2 e xi ε i 1 e xi ε i 2 e xi g i 1 e yi s i 1 e yi s i 2 e yi ε i 1 e yi ε i 2 e yi g i 2 e ψ i s i 3 e ψ i ε i 3 e ψ i g i 3 where j 1 2 3 by aiding of the lemma 2 v 1 i can be represented as 54 v 1 i l i 1 5 2 e xi 2 l i 1 5 2 e yi 2 l i 2 3 2 e ψ i 2 s i 1 2 s i 2 2 1 2 s i 3 2 ε i 1 2 ε i 2 2 1 2 ε i 3 2 1 2 j 1 3 g ij 2 recalling the remark 9 existing g i 1 g i 1 g i 2 g i 2 and g i 3 g i 3 we can obtain 55 v 1 i l i 1 5 2 e xi 2 l i 1 5 2 e yi 2 l i 2 3 2 e ψ i 2 s i 1 2 s i 2 2 1 2 s i 3 2 ε i 1 2 ε i 2 2 1 2 ε i 3 2 1 2 j 1 3 g ij 2 step2 substituting 50 into the time derivative of v 2 i we have 56 v 2 i x ei x ei y ei y ei ψ ei ψ ei x ei s i 1 ε i 1 γ i 1 π i 1 t a n h θ i 1 c o s ψ i s i 2 ε i 2 γ i 2 π i 2 t a n h θ i 2 s i n ψ i u l c o s ψ l v l s i n ψ l d il c o s ψ l ϕ il d lf r l ϕ il s i n ψ l ϕ il y ei s i 1 ε i 1 γ i 1 π i 1 t a n h θ i 1 s i n ψ i s i 2 ε i 2 γ i 2 π i 2 t a n h θ i 2 c o s ψ i u l s i n ψ l v l c o s ψ l d il s i n ψ l ϕ il d lf r l ϕ il c o s ψ l ϕ il ψ ei s i 3 ε i 3 γ i 3 π i 3 t a n h θ i 3 ψ ai l i 1 x ei 2 l i 1 y ei 2 l i 2 ψ ei 2 s i 1 x ei s i 2 x ei s i 1 y ei s i 2 y ei s i 3 ψ ei ε i 1 x ei π i 1 x ei ε i 2 x ei π i 2 x ei ε i 1 y ei π i 1 y ei ε i 2 y ei π i 2 y ei ψ ei ε i 3 π i 3 ψ ei ψ ei ψ ai by aiding of lemma 2 v 2 i can be represented as 57 v 2 i l i 1 3 x ei 2 l i 1 3 y ei 2 l i 2 2 ψ ei 2 s i 1 2 s i 2 2 1 2 s i 3 2 ε i 1 2 ε i 2 2 1 2 ε i 3 2 π i 1 2 π i 2 2 1 2 π i 3 2 1 2 ψ ai 2 applying the assumption 8 existing ψ a i ψ a i such that 57 can be represented as 58 v 2 i l i 1 3 x ei 2 l i 1 3 y ei 2 l i 2 2 ψ ei 2 s i 1 2 s i 2 2 1 2 s i 3 2 ε i 1 2 ε i 2 2 1 2 ε i 3 2 π i 1 2 π i 2 2 1 2 π i 3 2 1 2 ψ a i 2 step3 substituting 48 into the time derivative of v 3 i we have 59 v 3 i s i 1 l i 4 s i 1 l i 4 s i 2 w i 1 t θ i 1 z x ei sin ψ i y ei cos ψ i ε i 1 s i 2 l i 4 s i 1 l i 4 s i 2 l i 3 s i 3 w i 2 t θ i 2 z x ei sin ψ i y ei cos ψ i ε i 2 s i 3 l i 4 s i 2 l i 4 s i 3 w i 3 t θ i 3 z ψ ei ε i 3 l i 4 s i 1 2 l i 4 s i 2 2 l i 4 s i 3 2 s i 1 w i 1 t θ i 1 z s i 1 x ei sin ψ i s i 1 y ei cos ψ i s i 1 ε i 1 s i 2 w i 2 t θ i 2 z s i 2 x ei sin ψ i s i 2 y ei cos ψ i s i 2 ε i 2 s i 3 w i 3 t θ i 3 z s i 3 ψ ei s i 3 ε i 3 l i 4 s i 1 2 l i 4 s i 2 2 l i 4 s i 3 2 s i 1 w i 1 t θ i 1 z s i 2 w i 2 t θ i 2 z s i 3 w i 3 t θ i 3 z s i 1 x ei s i 1 y ei s i 2 x ei s i 2 y ei s i 3 ψ ei s i 1 ε i 1 s i 2 ε i 2 s i 3 ε i 3 by aiding of lemma 2 v 3 i can be represented as 60 v 3 i l i 4 3 2 s i 1 2 l i 4 3 2 s i 2 2 l i 4 1 s i 3 2 j 1 3 s ij w ij t θ i z x ei 2 y ei 2 1 2 ψ ei 2 1 2 j 1 3 ε ij 2 due to the existing inequality ε ε v 3 i can be rewritten as 61 v 3 i l i 4 3 2 s i 1 2 l i 4 3 2 s i 2 2 l i 4 1 s i 3 2 j 1 3 s ij w ij t θ i z x ei 2 y ei 2 1 2 ψ ei 2 1 2 j 1 3 ε ij 2 step4 substituting 42 into the time derivative of v 4 i we have 62 v 4 i ε i 1 ς i 1 γ i 1 ε i 2 ς i 2 γ i 2 ε i 3 ς i 3 γ i 3 j 1 3 ε ij 2 ζ ij ε i 1 γ i 1 ε i 2 γ i 2 ε i 3 γ i 3 j 1 3 ε ij 2 ζ ij ε i 1 γ i 1 ε i 2 γ i 2 ε i 3 γ i 3 by aiding of lemma 2 v 4 i can be represented as 63 v 4 i j 1 3 1 ζ ij γ ij 2 2 ε ij 2 3 2 it is noted that the derivative of γ i γ i 1 γ i 2 γ i 3 t given by 41 can be represented as ϒ i ϒ i 1 ϒ i 2 ϒ i 3 γ i ϒ i 1 γ i 1 e ix e iy s i 1 x ei y ei s i 2 s i 3 ε i 1 ε i 2 ε i 3 η l η l d il d il d il ϕ il ϕ il ϕ il ϒ i 2 γ i 2 e ix e iy x ei y ei s i 1 s i 2 s i 3 ε i 1 ε i 2 ε i 3 η l η l d il d il d il ϕ il ϕ il ϕ il ϒ i 3 γ i 3 e ψ i ψ ei s i 3 ε i 3 ψ ai where ϒ i 1 ϒ i 2 and ϒ i 3 are all continuous functions swaroop et al 2000 furthermore applying the assumptions 6 and 7 ϒ i has the maximum ϒ im on π i 1 π i 2 where π i 1 η l 2 η l 2 d il 2 d il 2 d il 2 ϕ il 2 ϕ il 2 ϕ il 2 α 0 α 0 0 π i 2 e ix e iy e ψ i x ei y ei ψ ei s i 1 s i 2 s i 3 ε i 1 ε i 2 ε i 3 v β 0 β 0 0 thus we can obtain 64 v 4 i j 1 3 1 ζ ij ϒ ij m 2 2 ε ij 2 3 2 choosing 1 ζ i 1 1 2 ϒ i 1 m 2 ζ i 1 1 ζ i 2 1 2 ϒ i 2 m 2 ζ i 2 1 ζ i 3 1 2 ϒ i 3 m 2 ζ i 3 64 can be rewritten as 65 v 4 i j 1 3 ε ij 2 ζ ij 3 2 where ζ ij is positive constant step5 substituting adaptive law 47 into the time derivative of v 5 i we can obtain 67 v 5 i w i 1 t γ i 1 1 w i 1 w i 2 t γ i 2 1 w i 2 w i 3 t γ i 3 1 w i 3 j 1 3 s ij w ij t θ i z j 1 3 o i w ij t w ij by aiding of the assumptions 4 and 5 we can obtain 68 v 5 i j 1 3 s ij w ij t θ i z j 1 3 o i w ij 2 j 1 3 o i w ij 2 then substituting 55 58 61 65 and 68 into the time derivative of v i we have 69 v i l i 1 5 2 e xi 2 e yi 2 l i 2 3 2 e ψ i 2 l i 1 4 x ei 2 y ei 2 l i 2 5 2 ψ ei 2 l i 4 7 2 s i 1 2 s i 2 2 l i 4 2 s i 3 2 ζ i 1 1 ε i 1 2 ζ i 2 1 ε i 2 2 ζ i 3 1 2 ε i 3 2 j 1 3 o i w ij 2 1 2 j 1 3 g ij 2 1 2 j 1 3 ε ij 2 π i 1 2 π i 2 2 1 2 π i 3 2 1 2 ψ a i 2 j 1 3 o i w ij 2 3 2 now let us consider the lyapunov function candidate for leader following formation as follows 70 v i 1 n v 1 i v 2 i v 3 i v 4 i v 5 i substituting 69 into the time derivative of 70 we have 71 v 2 μ v c where μ min l i 1 5 2 l i 2 3 2 l i 1 4 l i 2 5 2 l i 4 7 2 l i 4 2 ζ i 1 1 ζ i 2 1 ζ i 3 1 2 min o i λ max γ ij 1 c 1 2 i 1 n j 1 3 g ij 2 j 1 3 ε ij 2 2 j 1 3 o i w ij 2 i 1 n π i 1 2 π i 2 2 1 2 π i 3 2 1 2 ψ a i 2 3 n 2 with the designing parameters satisfying 72 l i 1 4 l i 2 5 2 l i 4 7 2 ζ i 1 1 ζ i 2 1 ζ i 3 1 2 where λ max denotes the maximum eigenvalues integrating 71 over 0 t yields 73 0 v t c 2 μ v 0 c 2 μ e 2 μ t from the inequality 73 it is clearly indicated that v t is uniformly ultimately bounded for all v 0 β 0 on 0 t and by aiding of the proposition 1 then t therefore we can draw a conclusion that tracking errors x ei y ei ψ ei transformed errors e ix e iy e ψ i s i 1 s i 2 s i 3 filtered errors ε i 1 ε i 2 ε i 3 and rbfnn weighting errors w i 1 w i 2 w i 3 are all bounded furthermore it can be concluded from 29 and 33 that tracking errors x ei y ei ψ ei satisfy the prescribed transient performance without violating any ρ i j for all t 0 thus all error signals of closed loop system remain bounded and converge within ρ i j the proof is completed 5 simulation experiment in this section numerical simulations are provided to demonstrate performance of the designed control scheme for underactuated uuvs consider a formation system consisting of two followers and one leader the dynamics of each underactuated uuv is adopted from chen et al 2020 and the nominal parameters are given as follows i m 11 i 141 85 m 22 i 191 75 m 33 i 15 6 m 12 i m 21 i m 13 i m 31 i 0 ii c 13 i v r 191 75 v 5 7 r c 23 i u 141 85 u c 31 i v r 191 75 v 5 7 r c 32 i u 141 85 u and c 11 i c 12 i c 21 i c 22 i c 33 i 0 iii d 11 i u 45 6 67 26 u 10 u 2 d 22 i v r 29 54 73 85 v 15 r d 23 i v r 2 5 2 v 10 71 r d 32 i v r 2 4 13 v 0 2 r d 33 i v r 5 59 10 71 r 0 07 r and d 12 i d 21 i d 13 i d 31 i 0 for the leader follower formation the predefined desired distance d if and angle ϕ i f of two followers are set as 5 m 2 π 3 r a d and 5 m 4 π 3 r a d respectively in addition all uuvs are affected by time varying disturbance d o t in the earth frame as 74 d o t 1 0 25 s i n 0 08 t 0 5 π 0 05 s i n 0 04 t 0 125 π 1 0 15 s i n 0 04 t 0 5 π 0 05 s i n 0 04 t 0 125 π 0 1 s i n 0 5 t 0 2 π such that w t acting on uuv in the body frame can be represented as w t j ψ d o t for the finite time velocities observer the parameters are selected as ϖ 1 i 0 2 ϖ 2 i 0 02 and l ui l vi l ri 200 for the predefined performance functions following parameters are selected as ρ i 1 0 ρ i 2 0 20 ρ i 1 ρ i 2 2 ρ i 3 0 3 ρ i 3 π 9 l i 1 l i 2 0 005 and l i 3 0 02 the parameters of virtual filter are chosen as ζ i 1 ζ i 2 ζ i 3 0 2 to estimate uncertain terms rbf networks are employed there are 256 neuron nodes for each θ i z where z u i v i r i ς i 1 ς i 2 ς i 3 e ix e iy e i ψ ε i 1 ε i 2 ε i 3 t is the input vector of output feedback controller the gain matrices are defined as γ i 1 γ i 2 γ i 3 20 i 12 12 and the initial weights are randomly given in the range of 1 1 the centers c i are evenly placed in 1 5 1 5 1 1 1 1 1 5 1 5 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 the widths are chosen as σ i 5 the control parameters and gains of adaptive nn output feedback are chosen as π i 1 20 π i 2 30 π i 3 20 l i 1 5 l i 2 3 l i 3 2 l i 4 4 ζ i 1 2 ζ i 2 2 ζ i 3 1 θ i 1 0 0 θ i 2 0 0 θ i 3 0 0 5 1 closed loop performance in order to demonstrate the arbitrary time varying leader follower formation achieved by the proposed control scheme we carry out the following two cases i e straight line and curve line in the closed loop performance case1 the trajectory of the leader is defined as straight line using the following velocities 0 t u l 1 2 m s v l 0 m s r l 0 rad s the initial condition of leader is defined as η l 0 0 m 0 m 0 r a d t the initial conditions of two followers are defined as η 1 10 m 22 5 m 0 r a d t ν 1 0 m s 0 m s 0 r a d s t and η 2 10 m 2 5 m 0 r a d t ν 2 0 m s 0 m s 0 r a d s t case2 the trajectory of the leader is defined as curve line using the following velocities i 0 t 10 u l 1 2 m s v l 0 m s r l 0 rad s ii 10 t 20 u l s i n π t 20 m s v l 0 m s r l 0 rad s iii 20 t 50 u l 1 m s v l 0 m s r l 0 1 c o s π t 20 rad s and iv 50 t 100 u l 1 m s v l 0 m s r l 0 rad s the initial condition of leader is defined as η l 0 0 m 0 m 0 r a d t the initial conditions of two followers are defined as η 1 10 m 10 m 0 r a d t ν 1 0 m s 0 m s 0 r a d s t and η 2 10 m 10 m 0 r a d t ν 2 0 m s 0 m s 0 r a d s t respectively the simulation results are illustrated in figs 4 18 figs 4 6 show that the leader trajectory can be tracked under the proposed output feedback controller which indicates that the leader follower formation is well established in both straight line and curve line as depitcted in figs 6 12 output tracking errors can not only satisfy the prescribed performance bounds but also converge to a small value close to zero under model uncertainties and external disturbances it is observed that the proposed scheme is robust enough against uncertainties and disturbances besides figs 12 and 13 exhibit velocity observation errors which converge to the neighborhood of origin within a short time period thereby verifying the fact that the designed observer is effective figs 14 16 show the filter errors for virtual velocity design of backstepping all of which remain bounded with good convergence furthermore fig 16 shows norm of neural weights provided by adaptive update law 47 for two cases all of which are bounded the fast responses during the initial phase wtih transitory oscillations and finite time convergent nns are accounted for by its stronger capability to capture the lumped nonlinear terms composed of model uncertainties and external disturbance in 7 it is also evident that the formulated nn adaptive controller can provide optimal solutions for surge force and yaw moment within the finite time finally fig 17 demonstrates corresponding control inputs including surge force τ u and yaw moment τ r therefore from all above results it is implied that the proposed scheme is effective in achieving desired leader following formation in spite of the imposed uncertainties and disturbances 5 2 comparative results to further demonstrate advantages of our approach comparison simulations are conducted by using adaptive cooperative formation controller acfc lu et al 2018 for comparison simulations studies are conducted between two types of controllers with the same control parameters and initial states as previous two cases simulation results are shown in figs 18 20 it is observed that the proposed scheme can provide the satisfied transient and steady performance of the tracking errors in which performance constraints are never violated the prescribed bounds however the controller in lu et al 2018 clearly fails to satisfy the prescribed bounds and provides low convergence furthermore detailed comparisons of these two methods are summarized in table 1 in which integral absolute error iae defined as 0 t e i d τ integral time absolute error itae defined as 0 t t e i d τ and the integral of square error isa defined as 0 t τ u i 2 d τ and 0 t τ r i 2 d τ are introduced to evaluate transient performance steady state performance and control energy where e i e xi e yi e ψ i t from table 1 it is evident that the proposed method achieves a better dynamic performance in comparison to the acfc as it guarantees the lower iae and itae with the smaller control energy consumption isa consequently by incorporating finite time velocity observer prescribed transient performance and filter backstepping technique in output feedback controller design we conclude that the proposed scheme provides the better performances in the presence of model uncertainties unmeasured velocity external disturbance and prescribed performance remark 10 the control parameters have some effects on stability and performance i l i 1 and l i 2 are associated with the convergence of transformed errors e i e xi e yi e ψ i t l i 3 is related to estimating a time varying approach angle for tracking straight path and curve path and l i 4 should be selected sufficient large to ensure the close loop system ii π i 1 and π i 3 are related to compensated effects of saturated inputs and π i 2 influences the underactuated problem iii ϖ 1 i ϖ 2 i l ui l vi and l ri are parameters for the finite time velocity observer where ϖ 1 i and ϖ 2 i should be selected as small as possible while l ui l vi and l ri are chosen larger enough thereby achieving a small estimation error 6 conclusion this paper presented an adaptive output feedback trajectory tracking formation control scheme for underactuated uuvs with prescribed transient performance in the presence of model uncertainties and external disturbances to reflect realistic situation we considered that mass and damping matrices were off diagonal and only partial information about hydrodynamics was known to design controller with unknown velocites a finite time velocity observer was exactly constructed by aiding of only position information rbf nns were used to idenfity the lumped nonlinear terms composed of model uncertainies and external disturbances the prescribed transient performance functions were introduced to guarantee that all tracking errors were bounded within prescribed constraints in transformed coordinate stability analysis showed that uniformly ultimately boundness of all close loop signals were guraranteed simulation results demonstrated outperforming performance of the proposed control scheme for future work it is of interest to investigate avoiding obstacle and preserving connection with prescribed performance in leader following formation control of underactuated uuvs declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors acknowledge the financial support from the national natural science foundation of china under grant 11404205 natural sciencefoundation of shaanxi under grant 2019jq 026 and fundamental research funds for central universities under grant gk202103014 and gk201803023 and authors would like to thank all reviewers and editors who provided extensive invaluable comments and suggestions 
20626,a fuel combustion mechanism was developed based on a multi component surrogate fuel composed of n tetradecane toluene methylcyclohexane mch and ethanol the four most common components of real diesel fuel a decoupling methodology was used to develop the new surrogate fuel mechanism the developed surrogate fuel model includes 97 species and 386 reactions the accuracy of new mechanism was obtained by comparing with experiment data in shock tube counterflow configuration and marine engine the comparison results of the simulations and experiment were shown in this paper for ignition delay times idt the deviations of calculations were within accepting error for n tetradecane toluene methylcyclohexane and ethanol respectively the laminar flame speed was an important parameter to validate the accuracy of the mechanism the variation trends were the same as the experimental results the revised mechanism was coupled with computational fluid dynamic cfd to simulate the combustion of a marine engine the influence of surrogate fuel components ratios were investigated based on the cfd model the prediction results well coincided with the experimental results of in cylinder pressure of the marine engine however the ratios of components in the surrogate fuel have large effect on the formation of nox emissions especially the content of n tetradecane the results suggest that the multi component surrogate fuel mechanism is suitable for simulating the diesel combustion keywords surrogate fuel multi component mechanism emissions combustion marine diesel engine 1 introduction ocean transport is the most important mode of transport in international trade the ocean pollution has drawn extensive attention as main power source in ocean transport marine engine pollution has been widely valued park et al 2015 yu et al 2018 various methods had been studied to reduce emissions including exhaust gas recirculation egr dual fuel engine humid air motors hams and miller cycle cfd simulation is an effective means of comprehensively evaluating the performance of these methods alshorman et al 2021 sui et al 2019 the chemical reaction kinetic mechanism is an important path to control the combustion paths for reducing emissions stoumpos et al 2018 wang et al 2019 single component surrogate fuels mechanism has often been used in cfd models of marine engines to reduce the calculation time and save the cost pham et al 2021 studied the influence of injection strategies on combustion and emission characteristics of a dual fuel marine engine the n heptane ch4 were used as surrogate fuel of diesel natural gas lamas et al 2019 researched the effect of injection strategies on performance of marine engine the n heptane mechanism of ra et al ra and reitz 2008 was used as surrogate fuel of marine diesel fuels lu et al lu and geng 2020 researched the performance and emissions of marine diesel engine under different gravity conditions the n heptane mechanism was used in cfd model sun et al 2017a studied the effect of egr on nox emissions of marine engine at different injection times the n tetradecane surrogate fuel model was used in cfd simulations it was found that the egr method can reduce nox emissions lower the limited value of tier iii requirement zhou et al 2017 investigated the potential of miller cycle and fuel injection strategies in reducing n 2017a ox emissions of marine engines using the n heptane mechanism to describe the diesel combustion process the reaction mechanism included 49 species and 207 reactions diesel fuel is composed of numerous and complex of components including alkanes alkenes aromatic hydrocarbons and other compounds wang et al 2019 lin and chen 2006 the single component mechanism can be used in cfd model to describe the combustion and emissions of marine engine however it has large deviation in predicted combustion paths and formation and oxidation of emissions due to alkane mechanism cannot reproduce the combustion characteristics of other components more researchers developed all kinds of multi component surrogate fuels mechanism to improve the accuracy of simulations fang et al 2020 developed 24 6 n dodecane and 75 4 decalin by mole fraction as surrogate fuel of diesel the present mechanism can predicted performance and emissions of diesel engine accurately li et al 2020 developed an n heptane toluene mechanism as surrogate fuel of diesel the mechanism was coupled with n butanol mechanism to research the combustion process of diesel blended fuels the finally mechanism was used in cfd can simulation the combustion process of engine with different fuels accurately bai et al 2020 developed a three component mechanism for diesel the selection criteria of components was based on the physical and chemical properties of fuels the n hexadecane hxn iso cetane and 1 methylnaphthalene components were selected the mechanism was optimized and validated against with tested data at different conditions wang et al wang and chen 2017 used a four component mechanism comprising 1 2 4 trimethylbenzene trans decalin heptamethylnonane and n hexadecane to simulate the properties of diesel fuel important thermophysical and chemical data were used to validate the developed surrogate fuel huang et al 2019 developed a multi component mechanism for diesel the n heptane n butylbenzene and mch were selected as fundamental components the mechanism of multi component mechanism were coupled with pah mechanism the new mechanism was optimized using many methods the prediction performance of diesel engine agreed well coincided with experimental results above all the multi component surrogate fuels had been widely used in cfd simulation of diesel engine the species of surrogate fuels have directly influence on the combustion and emissions characteristics of real fuels it is necessary to choose the species of surrogate fuel based on the physicochemical property of real fuels multi component surrogate fuel of marine diesel fuels has been researched recently wu et al 2021a proposed four component surrogate fuel of marine diesel fuel the surrogate fuels included 17 3 n hexadecane 5 93 2 2 4 4 6 8 8 heptamethylnonane 30 decalin and 46 77 1 methylnaphthalene by mole fraction xia et al 2020 proposed six component surrogate fuel including n hexadecane n octadecane iso cetane decalin toluene and 1 methylnaphthalen the surrogate fuel can be used to emulate the spray characteristics in marine engine which was validated by test however the mechanism of six component surrogate fuel was not proposed the number of elementary reactions increases with carbon number of components so a small scale surrogate fuel is necessary for simulation due to the large stroke of marine engine the relatively little research has focused on multi component surrogate fuels for marine diesel engine in this study n tetradecane toluene mch and ethanol were selected as components based on the chemical properties of real diesel fuels first a multi component mechanism was developed using a decoupling methodology then the new mechanism was validated with measured results in experiment finally a suitable multi component surrogate fuel was proposed by comparing the influence of components ratio on the in cylinder pressure and nox emissions of marine engine this paper provides an available surrogate fuel mechanism for marine diesel fuel it can be coupled with cfd simulation to research the combustion and emissions in marine engine 2 surrogate fuel mechanism development 2 1 components of diesel surrogate fuel the chemical compositions of diesel fuels were measured using ftir spectra hsgcms gcms and pygcms the main chemical classes are shown in table 1 alkane cycloparaffin aromatic and alcohol species were present in diesel fuel the mass fraction of alkanes 64 19 was found to be largest the more and consisted largely of macromolecules of ten or more carbons cycloparaffins with a mass fraction of 10 85 were second in abundance and were therefore chosen as a component of the surrogate fuel the mass fraction of alcohols was third highest at 9 06 followed by aromatics at 7 31 aromatics are soot precursors and have a strong influence on soot formation and emissions sun et al 2019 all four classes of components are necessary in a surrogate fuel for diesel combustion simulations a commonly used diesel surrogate n tetradecane was selected as reference fuel sun et al 2017b mch which contains approximately 1 3 by mass of cycloparaffins was used as the cycloparaffin component of the surrogate fuel tian et al 2021 toluene has often been used as a component of diesel surrogate fuels because its reaction mechanism has been widely studied and validated for this reason toluene was selected as the aromatic component of the surrogate fuel gail et al 2021 while alcohol macromolecules were found in diesel fuel their reaction mechanisms are not well understood or validated because of the difficulty of measuring experimental data such as ignition delay times the reaction paths of macromolecules are similar to those of small molecules of the same class zhang and mani sarathy 2021 ethanol was therefore chosen as the alcohol component of the diesel surrogate fuel the surrogate diesel fuel was a mixture of n tetradecane mch toluene and ethanol 2 2 diesel surrogate model development a convenient and accurate decoupling methodology was used to develop the four component surrogate fuel skeletal mechanism wu et al 2021b chang et al 2013 the skeletal surrogate fuel mechanism was divided into three blocks in fig 1 the pyrolysis reactions of each component were used as one block to predict the low temperature oxidation processes the high temperature reactions i e the reactions of h2 co c1 were used for the prediction of flame speed and formation and oxidation in emissions data on the reactions of h2 co c1 were obtained from the results of klippenstein et al 2011 the third block was the oxidation of c2 c3 species this block has a close relationship with the output composition pure n tetradecane surrogate fuel has been used in cfd simulation to research the performance of marine engines sun et al 2016 subsequently a two component mechanism c14h30 and c7h8 was developed to investigate the influences of aromatics on the combustion performance of marine engines sun et al 2018 in this work two component mechanism was applied as a reference mechanism to develop a multi component surrogate fuel the sub mechanisms of mch and ethanol were coupled with the n tetradecane toluene mechanism to develop a four component surrogate fuel mechanism the mch mechanism was obtained from the results of chang et al 2015 the low temperature reaction pathways contain dehydrogenation reactions mch mchr the arrow represents mch was oxidized to mchr iso alkyl radical oxidation reactions mchr mch2oo isomerization reactions mch2oo mchooh secondary oxidation reactions mchooh moochooh and self pyrolysis reactions the sub mechanisms of mch and n tetradecane were quite similar as shown in fig 1 the sub mechanism of ethanol was obtained from ra et al ra and reitz 2011 the sub mechanism of ethanol n tetradecane toluene and mch were connected to form the pyrolysis parts in multi component surrogate fuel then it was coupled with h2 co c1 and c2 c3 sub mechanism by decoupling method to develop multi component surrogate fuel the final mechanism includes 97 species and 386 reactions 2 3 diesel surrogate model optimization the reaction rate constants of elementary reactions were estimated and optimized by comparing with experimental data fig 2 displays the calibration process for the four component surrogate fuel mechanism the calibration process can be summarized as follows 1 the kinetic parameters of the four component surrogate fuel mechanism were obtained from the references the reaction rate constants for sub mechanisms n tetradecane toluene mch ethanol were optimized with experimental data the idts were validated under wide conditions a temperature sensitivity analysis was applied to reparametrize the reaction rate constants of the sub mechanisms 2 the values of flame speed were also compared for simulation and experiment the errors of reaction rate constants were further decreasing by sensitivity analysis between the simulation and experiment the revised method was the same as step 1 the revised mechanism was then compared with the experimental laminar flame speed step 1 and step 2 were repeated iteratively until the calculated data using the four component mechanism agreed with the tested data for both the idts and the laminar flame speeds 3 the resulting mechanism was coupled in cfd simulations to compare with experimentally measured in cylinder pressures and emissions the reaction rate constants were further optimized to reduce the errors between simulations and experimental results and the revised mechanism was validated once more as in step 1 and step 2 4 steps 1 2 and 3 were repeated until the calculated results using the four component surrogate fuel agreed with the tested data 3 model validation the accuracy of surrogate fuel mechanism was evaluated by comparing experimental results in shock tube in counter flow configuration and from an actual marine diesel engine the parameters of idts laminar flame speeds in cylinder pressures and nox emissions were compared to reduce errors within acceptable limits the cfd model of marine engine was developed to research the effect of component ratios on combustion and emission 3 1 validation of ignition delay times the idt is an important parameter to evaluate the accuracy of surrogate fuel mechanism the idts of new mechanism were simulated in closed homogeneous constant volume reactor model which was defined as the time required for the mixture temperature to increase to 400 k above the initial temperature the idts of four components were evaluated under different equivalence ratios pressure and temperature conditions the idt of n tetradecane was first compared with experimental value shen et al 2009 and detailed mechanism simulations westbrook et al 2009 fig 3 shows the compared results of the calculation and experimental data under various conditions the different equivalence ratios 0 5 1 0 and pressures 14 40 atm were studied according to the conditions of experiment the predictions of the four component mechanism were found to be consistent with the tested value the measured results using the new surrogate fuel were more accurate than the simulation results using the detailed model although some deviations occurred at low temperatures the newly developed mechanism and the published mechanism westbrook et al behaved similarly in general the newly developed surrogate fuel mechanism reliably predicted the idts of n tetradecane the toluene idts were validated with measured value davidson et al 2005 pitz et al 2001 and simulations of published reduced mechanism wang et al 2012 fig 4 shows the compared results between simulations and experiments the idts accuracy of surrogate fueles were studied under different equivalence ratios 0 5 1 0 and pressures 9 0 50 0 atm the predictions of the four component mechanism were consistent with the experimental results though there were some deviations at low equivalence ratio and pressure however the results of simulations were almost identical for the new and reduced mechanism and the predictions by the newly developed mechanism being closer to the experimental data at an equivalence ratio of 1 0 this demonstrates that the four component mechanism can be used to predict the idts of toluene the idts of mch based on the four component surrogate fuel mechanism were validated with measured data chang et al 2015 fig 5 shows comparisons of the idts for mch at different pressures and temperatures respectively the idts decreased with increasing pressure the predictions of the four component mechanism were consistent with the measured results the results show that the developed surrogate fuel can predict the idts of mch accurately the idts of ethanol were validated with measured results dunphy and simmie 1991 cancino et al 2010 over wider ranges of temperature pressure 3 3 50 bar and equivalence ratio 0 5 2 0 which are shown in fig 6 the results show that the equivalence ratio has less influence on idt in the low pressure regime fig 6 a the simulation results could be coincided with experimental data at low temperatures very well some deviations occurred at low equivalence ratios 0 5 1 0 and high temperatures 1100 1300 k overall the ignition delay times of toluene were reproduced well by the newly developed four component mechanism a temperature sensitivity analysis was researched for n tetradecane toluene mch and ethanol at a pressure of 50 0 atm equivalence ratio of 1 0 and temperatures of 850 k and 1200 k fig 7 shows the top ten reactions with the highest sensitivity coefficients for the four components the idt was dominated by fuel species reactions but the reactions were different at low and high temperatures for example the reaction r6 c14h29 c2h4 c12h25 it shows c14h29 was break up into c2h4 and c12h25 had a large sensitivity coefficient only at 850 k for n tetradecane as shown in fig 7 a for toluene the reaction r146 h o2 o oh had a large sensitivity coefficient only at 1200 k as shown in fig 7 b the results display that reaction r163 h2o2 2oh and r168 h2o2 ohho2 h2o play important roles in the idts of n tetradecane mch and ethanol the sensitivity coefficient of r163 was positive while that of r168 was negative the opposite effect was found for r168 and r163 according to the special elementary reactions the reaction rates were adjusted for components respectively so the idts results of components mechanism were satisfactorily reproduced 3 2 validation of laminar flame speed the laminar flame speed is also an important measure of the accuracy of surrogate fuel mechanism that reflects fundamental information the premix module was used in the simulations the laminar flame speeds were compared between the simulation and measured results for each pure component fig 8 shows comparisons of laminar flame speeds for n tetradecane toluene mch and ethanol fig 8 a shows the validation results for n tetradecane between simulation and experimental data li et al 2013 the laminar flame speed increases with higher temperature and has a peak at an equivalence ratio of 1 1 the simulated trends in the laminar flame speed were consistent with the experimental data though a small discrepancy occurred at high equivalence ratio and temperature the errors were in the accepted range in general the predicted results are obtained in very good conformation with the tested data the validation results for toluene are shown in fig 8 b at pressures ranging from 1 0 atm to 3 0 atm hui and sung 2013 the trends of laminar flame speed decreased with increasing pressure the changing trend was a parabolic function of the equivalence ratio with a maximum at an equivalence ratio of approximately 1 1 the simulated laminar flame speeds were in very good conformation with the measured data with slight discrepancies at lower equivalence ratios the errors of predicted results were in the acceptable range due to the uncertainties of experiment the validation results for mch are shown in fig 8 c at pressures from 1 0 atm to 5 0 atm wu et al 2012 the changing trends of laminar flame speed decreased with increasing pressure as was the case for toluene the value increased as the equivalence ratio was increased from 0 8 to 1 1 the laminar flame speed was not calculated for the higher equivalence ratios at a pressure of 5 0 atm conditions due to the lack of experimental data it has also clearly a parabolic function of the equivalence ratio at pressures of 1 0 atm and 2 0 atm the simulated results were in very good conformation with the measured data with slight discrepancies at equivalence ratio of 1 0 and pressure of 5 0 atm in general the errors of predicted results were in the acceptable range the mechanism can be used to reflect the flame speed of mch the validation results for ethanol are shown in fig 8 d at temperatures of 380 k and 450 k hinton 2014 the laminar flame speed increased with temperature as it did for n tetradecane and had a maximum value at an equivalence ratio of approximately 1 1 the changing has no relationship with the temperature the overall predictions using the four component mechanism showed reasonable agreement with the experimental results considering the uncertainties in the experimental data the temperature sensitivity analysis was carried out for n tetradecane toluene mch and ethanol at a pressure of 1 0 atm and equivalence ratio of 1 1 fig 9 shows the top ten reactions with the highest sensitivity coefficients for four components temperatures of 400 k and 440 k were chosen for n tetradecane because of the range of experimental data available fig 9 a while the other components were studied at temperatures of 350 k and 400 k the laminar flame speeds of the four components were sensitive primarily to c0 c1 reactions for example reaction r146 h o2 o oh had the highest sensitivity coefficient for four components however fuel specific reactions only influenced the laminar flame speed of toluene as shown in fig 9 b while c2 c3 reactions had lesser effects on the laminar flame speeds of all four components note that the top ten reactions were almost the same at the different temperatures studied which was not the case for the idt temperature sensitivity analysis the laminar flame speed for n tetradecane toluene mch and ethanol can be accurately displayed by adjusting the c0 c1 mechanism reactions 3 3 validation of marine engine combustion the purpose of developed surrogate fuel mechanism is to apply it in the cfd simulation the chemical reaction mechanism is coupled with the combustion model to research the combustion path of fuels and the formation of emissions products the cfd model of marine engine is a necessary method to validate the applicability of developed surrogate fuel mechanism the main parameters of marine engine are shown in table 2 fig 10 shows the cfd structure of real marine engine the main sub models were found in reference gail et al 2021 the detailed chemical kinetics model sage was used as a combustion model the newly developed mechanism was coupled with the sage combustion model to simulate the combustion of fuels the n tetradecane toluene ethanol and mch were used as evaporate species the mole fractions of evaporating species needed to set in the spray model which has a direct effect on the combustion and emission results in simulation a suitable ratio of components should be researched to provide accurate surrogate fuel of marine diesel fuel the detailed compositions of surrogate fuels were shown in table 3 the ratio of surrogate fuel s1 was set according to the measured ratio of species in diesel fuels the ratio of surrogate fuel s2 was set according to the cetane number cn and lower heating value lhv of real diesel the cn and lhv of s1 are 52 71 and 41 29 the cn and lhv of real fuel are 52 4 and 42 76 the lev of s3 is 42 11 which is closer to measured value than the value of s2 the simulated in cylinder pressure and nox emissions using three different surrogate fuels were compared with experimental data in this paper fig 11 shows the comparison results between experiment and simulation the results showed that simulated in cylinder pressures were in good agreement with experimental data a small difference was found at the start of the combustion phase the comparisons of key parameters are displayed in table 4 the simulated ignition delay time was shorter than the experimental result this is primarily because most of the macromolecules in diesel were not selected as components of the surrogate fuel the maximum in cylinder pressure was 5 0 bar lower than the measured value the maximum combustion pressure using surrogate s3 is closer to the experimental data compared with results using s1 and s2 the simulated results using surrogate s2 have maximum errors in brake power however the errors were in accepted range in general the simulation model predicted the combustion characteristics of the marine diesel engine well experimental and simulated nox emissions are compared in fig 12 the predicted nox emissions using surrogate s1was 0 86 g kwh higher than the experimental value the error is maximum between simulated results of using surrogate s2 and experiment the ratios of four components in surrogate fuel affect the formation of intermediate components such as oxygen atom the oxygen atom is the main species for the formation of nox due to the main elementary reaction o n2 no n the surrogate fuel s1 was proposed as surrogate fuel of marine diesel fuels by comparing the errors of three kinds of surrogate fuels the newly developed surrogate fuel mechanism is capable of reproducing the experimental in cylinder pressure and emissions of marine engines however the ratio and species of components affect the formation and oxidation of nox and soot the predicted ability of soot for developed surrogate fuel needs to be validated in the future due to the lack of experimental data 4 conclusions the surrogate fuel mechanism of marine diesel fuels was researched to improve the combustion path and reduce emission the developed multi component surrogate fuel mechanism includes four components n tetradecane toluene mch and ethanol the mechanism was validated with measured results in shock tube counterflow configuration and marine engine the key parameters were compared between simulation and experiment including idts flame speeds in cylinder pressure and emissions the main conclusions are as follows 1 the four components are chosen as surrogate fuel based on the measured mass fractions of different chemical species in real marine diesel fuel the multi component surrogate fuel mechanism is developed using the decoupling method the sensitivity analysis and path analysis methods are used to optimize the rate constants of key reactions in mechanism 2 the developed surrogate mechanism is extensively validated against experimental data of ignition delay times in shock tubes laminar flame speeds in counterflow configuration for each pure component it is shown that the simulation results agree reasonably well with the experimental data over a wide range of operation conditions 3 the multi component mechanism is coupled with the combustion model in the cfd simulation three kinds of surrogate fuels are researched on the effect of performance in marine diesel engine the experimental combustion characteristics as well as the nox emissions of marine diesel engine are all reasonably reproduced by the surrogate fuel s1 in conclusion the 64 19 n tetradecane 15 9 toluene 10 85 mch and 9 06 ethanol by mass fraction surrogate fuel is proposed as surrogate fuel of marine diesel engine credit authorship contribution statement xiuxiu sun methodology software data curation writing original draft preparation mengmeng wang resources methodology analysis incecik atilla conceptualization visualization investigation shizhe feng supervision writing review editing funding acquisition zhixiong li conceptualization writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by science and technology research project of higher education in hebei province no bj2021018 and funds for central universities of china 201912036 201941008 nomenclature abbreviation cn cetane number cfd computational fluid dynamic egr exhaust gas recirculation hxn n hexadecane hmn heptamethylnonane idts ignition delay times lhv lower heating value mch methylcyclohexane pah polycyclic aromatic hydrocarbon 
20626,a fuel combustion mechanism was developed based on a multi component surrogate fuel composed of n tetradecane toluene methylcyclohexane mch and ethanol the four most common components of real diesel fuel a decoupling methodology was used to develop the new surrogate fuel mechanism the developed surrogate fuel model includes 97 species and 386 reactions the accuracy of new mechanism was obtained by comparing with experiment data in shock tube counterflow configuration and marine engine the comparison results of the simulations and experiment were shown in this paper for ignition delay times idt the deviations of calculations were within accepting error for n tetradecane toluene methylcyclohexane and ethanol respectively the laminar flame speed was an important parameter to validate the accuracy of the mechanism the variation trends were the same as the experimental results the revised mechanism was coupled with computational fluid dynamic cfd to simulate the combustion of a marine engine the influence of surrogate fuel components ratios were investigated based on the cfd model the prediction results well coincided with the experimental results of in cylinder pressure of the marine engine however the ratios of components in the surrogate fuel have large effect on the formation of nox emissions especially the content of n tetradecane the results suggest that the multi component surrogate fuel mechanism is suitable for simulating the diesel combustion keywords surrogate fuel multi component mechanism emissions combustion marine diesel engine 1 introduction ocean transport is the most important mode of transport in international trade the ocean pollution has drawn extensive attention as main power source in ocean transport marine engine pollution has been widely valued park et al 2015 yu et al 2018 various methods had been studied to reduce emissions including exhaust gas recirculation egr dual fuel engine humid air motors hams and miller cycle cfd simulation is an effective means of comprehensively evaluating the performance of these methods alshorman et al 2021 sui et al 2019 the chemical reaction kinetic mechanism is an important path to control the combustion paths for reducing emissions stoumpos et al 2018 wang et al 2019 single component surrogate fuels mechanism has often been used in cfd models of marine engines to reduce the calculation time and save the cost pham et al 2021 studied the influence of injection strategies on combustion and emission characteristics of a dual fuel marine engine the n heptane ch4 were used as surrogate fuel of diesel natural gas lamas et al 2019 researched the effect of injection strategies on performance of marine engine the n heptane mechanism of ra et al ra and reitz 2008 was used as surrogate fuel of marine diesel fuels lu et al lu and geng 2020 researched the performance and emissions of marine diesel engine under different gravity conditions the n heptane mechanism was used in cfd model sun et al 2017a studied the effect of egr on nox emissions of marine engine at different injection times the n tetradecane surrogate fuel model was used in cfd simulations it was found that the egr method can reduce nox emissions lower the limited value of tier iii requirement zhou et al 2017 investigated the potential of miller cycle and fuel injection strategies in reducing n 2017a ox emissions of marine engines using the n heptane mechanism to describe the diesel combustion process the reaction mechanism included 49 species and 207 reactions diesel fuel is composed of numerous and complex of components including alkanes alkenes aromatic hydrocarbons and other compounds wang et al 2019 lin and chen 2006 the single component mechanism can be used in cfd model to describe the combustion and emissions of marine engine however it has large deviation in predicted combustion paths and formation and oxidation of emissions due to alkane mechanism cannot reproduce the combustion characteristics of other components more researchers developed all kinds of multi component surrogate fuels mechanism to improve the accuracy of simulations fang et al 2020 developed 24 6 n dodecane and 75 4 decalin by mole fraction as surrogate fuel of diesel the present mechanism can predicted performance and emissions of diesel engine accurately li et al 2020 developed an n heptane toluene mechanism as surrogate fuel of diesel the mechanism was coupled with n butanol mechanism to research the combustion process of diesel blended fuels the finally mechanism was used in cfd can simulation the combustion process of engine with different fuels accurately bai et al 2020 developed a three component mechanism for diesel the selection criteria of components was based on the physical and chemical properties of fuels the n hexadecane hxn iso cetane and 1 methylnaphthalene components were selected the mechanism was optimized and validated against with tested data at different conditions wang et al wang and chen 2017 used a four component mechanism comprising 1 2 4 trimethylbenzene trans decalin heptamethylnonane and n hexadecane to simulate the properties of diesel fuel important thermophysical and chemical data were used to validate the developed surrogate fuel huang et al 2019 developed a multi component mechanism for diesel the n heptane n butylbenzene and mch were selected as fundamental components the mechanism of multi component mechanism were coupled with pah mechanism the new mechanism was optimized using many methods the prediction performance of diesel engine agreed well coincided with experimental results above all the multi component surrogate fuels had been widely used in cfd simulation of diesel engine the species of surrogate fuels have directly influence on the combustion and emissions characteristics of real fuels it is necessary to choose the species of surrogate fuel based on the physicochemical property of real fuels multi component surrogate fuel of marine diesel fuels has been researched recently wu et al 2021a proposed four component surrogate fuel of marine diesel fuel the surrogate fuels included 17 3 n hexadecane 5 93 2 2 4 4 6 8 8 heptamethylnonane 30 decalin and 46 77 1 methylnaphthalene by mole fraction xia et al 2020 proposed six component surrogate fuel including n hexadecane n octadecane iso cetane decalin toluene and 1 methylnaphthalen the surrogate fuel can be used to emulate the spray characteristics in marine engine which was validated by test however the mechanism of six component surrogate fuel was not proposed the number of elementary reactions increases with carbon number of components so a small scale surrogate fuel is necessary for simulation due to the large stroke of marine engine the relatively little research has focused on multi component surrogate fuels for marine diesel engine in this study n tetradecane toluene mch and ethanol were selected as components based on the chemical properties of real diesel fuels first a multi component mechanism was developed using a decoupling methodology then the new mechanism was validated with measured results in experiment finally a suitable multi component surrogate fuel was proposed by comparing the influence of components ratio on the in cylinder pressure and nox emissions of marine engine this paper provides an available surrogate fuel mechanism for marine diesel fuel it can be coupled with cfd simulation to research the combustion and emissions in marine engine 2 surrogate fuel mechanism development 2 1 components of diesel surrogate fuel the chemical compositions of diesel fuels were measured using ftir spectra hsgcms gcms and pygcms the main chemical classes are shown in table 1 alkane cycloparaffin aromatic and alcohol species were present in diesel fuel the mass fraction of alkanes 64 19 was found to be largest the more and consisted largely of macromolecules of ten or more carbons cycloparaffins with a mass fraction of 10 85 were second in abundance and were therefore chosen as a component of the surrogate fuel the mass fraction of alcohols was third highest at 9 06 followed by aromatics at 7 31 aromatics are soot precursors and have a strong influence on soot formation and emissions sun et al 2019 all four classes of components are necessary in a surrogate fuel for diesel combustion simulations a commonly used diesel surrogate n tetradecane was selected as reference fuel sun et al 2017b mch which contains approximately 1 3 by mass of cycloparaffins was used as the cycloparaffin component of the surrogate fuel tian et al 2021 toluene has often been used as a component of diesel surrogate fuels because its reaction mechanism has been widely studied and validated for this reason toluene was selected as the aromatic component of the surrogate fuel gail et al 2021 while alcohol macromolecules were found in diesel fuel their reaction mechanisms are not well understood or validated because of the difficulty of measuring experimental data such as ignition delay times the reaction paths of macromolecules are similar to those of small molecules of the same class zhang and mani sarathy 2021 ethanol was therefore chosen as the alcohol component of the diesel surrogate fuel the surrogate diesel fuel was a mixture of n tetradecane mch toluene and ethanol 2 2 diesel surrogate model development a convenient and accurate decoupling methodology was used to develop the four component surrogate fuel skeletal mechanism wu et al 2021b chang et al 2013 the skeletal surrogate fuel mechanism was divided into three blocks in fig 1 the pyrolysis reactions of each component were used as one block to predict the low temperature oxidation processes the high temperature reactions i e the reactions of h2 co c1 were used for the prediction of flame speed and formation and oxidation in emissions data on the reactions of h2 co c1 were obtained from the results of klippenstein et al 2011 the third block was the oxidation of c2 c3 species this block has a close relationship with the output composition pure n tetradecane surrogate fuel has been used in cfd simulation to research the performance of marine engines sun et al 2016 subsequently a two component mechanism c14h30 and c7h8 was developed to investigate the influences of aromatics on the combustion performance of marine engines sun et al 2018 in this work two component mechanism was applied as a reference mechanism to develop a multi component surrogate fuel the sub mechanisms of mch and ethanol were coupled with the n tetradecane toluene mechanism to develop a four component surrogate fuel mechanism the mch mechanism was obtained from the results of chang et al 2015 the low temperature reaction pathways contain dehydrogenation reactions mch mchr the arrow represents mch was oxidized to mchr iso alkyl radical oxidation reactions mchr mch2oo isomerization reactions mch2oo mchooh secondary oxidation reactions mchooh moochooh and self pyrolysis reactions the sub mechanisms of mch and n tetradecane were quite similar as shown in fig 1 the sub mechanism of ethanol was obtained from ra et al ra and reitz 2011 the sub mechanism of ethanol n tetradecane toluene and mch were connected to form the pyrolysis parts in multi component surrogate fuel then it was coupled with h2 co c1 and c2 c3 sub mechanism by decoupling method to develop multi component surrogate fuel the final mechanism includes 97 species and 386 reactions 2 3 diesel surrogate model optimization the reaction rate constants of elementary reactions were estimated and optimized by comparing with experimental data fig 2 displays the calibration process for the four component surrogate fuel mechanism the calibration process can be summarized as follows 1 the kinetic parameters of the four component surrogate fuel mechanism were obtained from the references the reaction rate constants for sub mechanisms n tetradecane toluene mch ethanol were optimized with experimental data the idts were validated under wide conditions a temperature sensitivity analysis was applied to reparametrize the reaction rate constants of the sub mechanisms 2 the values of flame speed were also compared for simulation and experiment the errors of reaction rate constants were further decreasing by sensitivity analysis between the simulation and experiment the revised method was the same as step 1 the revised mechanism was then compared with the experimental laminar flame speed step 1 and step 2 were repeated iteratively until the calculated data using the four component mechanism agreed with the tested data for both the idts and the laminar flame speeds 3 the resulting mechanism was coupled in cfd simulations to compare with experimentally measured in cylinder pressures and emissions the reaction rate constants were further optimized to reduce the errors between simulations and experimental results and the revised mechanism was validated once more as in step 1 and step 2 4 steps 1 2 and 3 were repeated until the calculated results using the four component surrogate fuel agreed with the tested data 3 model validation the accuracy of surrogate fuel mechanism was evaluated by comparing experimental results in shock tube in counter flow configuration and from an actual marine diesel engine the parameters of idts laminar flame speeds in cylinder pressures and nox emissions were compared to reduce errors within acceptable limits the cfd model of marine engine was developed to research the effect of component ratios on combustion and emission 3 1 validation of ignition delay times the idt is an important parameter to evaluate the accuracy of surrogate fuel mechanism the idts of new mechanism were simulated in closed homogeneous constant volume reactor model which was defined as the time required for the mixture temperature to increase to 400 k above the initial temperature the idts of four components were evaluated under different equivalence ratios pressure and temperature conditions the idt of n tetradecane was first compared with experimental value shen et al 2009 and detailed mechanism simulations westbrook et al 2009 fig 3 shows the compared results of the calculation and experimental data under various conditions the different equivalence ratios 0 5 1 0 and pressures 14 40 atm were studied according to the conditions of experiment the predictions of the four component mechanism were found to be consistent with the tested value the measured results using the new surrogate fuel were more accurate than the simulation results using the detailed model although some deviations occurred at low temperatures the newly developed mechanism and the published mechanism westbrook et al behaved similarly in general the newly developed surrogate fuel mechanism reliably predicted the idts of n tetradecane the toluene idts were validated with measured value davidson et al 2005 pitz et al 2001 and simulations of published reduced mechanism wang et al 2012 fig 4 shows the compared results between simulations and experiments the idts accuracy of surrogate fueles were studied under different equivalence ratios 0 5 1 0 and pressures 9 0 50 0 atm the predictions of the four component mechanism were consistent with the experimental results though there were some deviations at low equivalence ratio and pressure however the results of simulations were almost identical for the new and reduced mechanism and the predictions by the newly developed mechanism being closer to the experimental data at an equivalence ratio of 1 0 this demonstrates that the four component mechanism can be used to predict the idts of toluene the idts of mch based on the four component surrogate fuel mechanism were validated with measured data chang et al 2015 fig 5 shows comparisons of the idts for mch at different pressures and temperatures respectively the idts decreased with increasing pressure the predictions of the four component mechanism were consistent with the measured results the results show that the developed surrogate fuel can predict the idts of mch accurately the idts of ethanol were validated with measured results dunphy and simmie 1991 cancino et al 2010 over wider ranges of temperature pressure 3 3 50 bar and equivalence ratio 0 5 2 0 which are shown in fig 6 the results show that the equivalence ratio has less influence on idt in the low pressure regime fig 6 a the simulation results could be coincided with experimental data at low temperatures very well some deviations occurred at low equivalence ratios 0 5 1 0 and high temperatures 1100 1300 k overall the ignition delay times of toluene were reproduced well by the newly developed four component mechanism a temperature sensitivity analysis was researched for n tetradecane toluene mch and ethanol at a pressure of 50 0 atm equivalence ratio of 1 0 and temperatures of 850 k and 1200 k fig 7 shows the top ten reactions with the highest sensitivity coefficients for the four components the idt was dominated by fuel species reactions but the reactions were different at low and high temperatures for example the reaction r6 c14h29 c2h4 c12h25 it shows c14h29 was break up into c2h4 and c12h25 had a large sensitivity coefficient only at 850 k for n tetradecane as shown in fig 7 a for toluene the reaction r146 h o2 o oh had a large sensitivity coefficient only at 1200 k as shown in fig 7 b the results display that reaction r163 h2o2 2oh and r168 h2o2 ohho2 h2o play important roles in the idts of n tetradecane mch and ethanol the sensitivity coefficient of r163 was positive while that of r168 was negative the opposite effect was found for r168 and r163 according to the special elementary reactions the reaction rates were adjusted for components respectively so the idts results of components mechanism were satisfactorily reproduced 3 2 validation of laminar flame speed the laminar flame speed is also an important measure of the accuracy of surrogate fuel mechanism that reflects fundamental information the premix module was used in the simulations the laminar flame speeds were compared between the simulation and measured results for each pure component fig 8 shows comparisons of laminar flame speeds for n tetradecane toluene mch and ethanol fig 8 a shows the validation results for n tetradecane between simulation and experimental data li et al 2013 the laminar flame speed increases with higher temperature and has a peak at an equivalence ratio of 1 1 the simulated trends in the laminar flame speed were consistent with the experimental data though a small discrepancy occurred at high equivalence ratio and temperature the errors were in the accepted range in general the predicted results are obtained in very good conformation with the tested data the validation results for toluene are shown in fig 8 b at pressures ranging from 1 0 atm to 3 0 atm hui and sung 2013 the trends of laminar flame speed decreased with increasing pressure the changing trend was a parabolic function of the equivalence ratio with a maximum at an equivalence ratio of approximately 1 1 the simulated laminar flame speeds were in very good conformation with the measured data with slight discrepancies at lower equivalence ratios the errors of predicted results were in the acceptable range due to the uncertainties of experiment the validation results for mch are shown in fig 8 c at pressures from 1 0 atm to 5 0 atm wu et al 2012 the changing trends of laminar flame speed decreased with increasing pressure as was the case for toluene the value increased as the equivalence ratio was increased from 0 8 to 1 1 the laminar flame speed was not calculated for the higher equivalence ratios at a pressure of 5 0 atm conditions due to the lack of experimental data it has also clearly a parabolic function of the equivalence ratio at pressures of 1 0 atm and 2 0 atm the simulated results were in very good conformation with the measured data with slight discrepancies at equivalence ratio of 1 0 and pressure of 5 0 atm in general the errors of predicted results were in the acceptable range the mechanism can be used to reflect the flame speed of mch the validation results for ethanol are shown in fig 8 d at temperatures of 380 k and 450 k hinton 2014 the laminar flame speed increased with temperature as it did for n tetradecane and had a maximum value at an equivalence ratio of approximately 1 1 the changing has no relationship with the temperature the overall predictions using the four component mechanism showed reasonable agreement with the experimental results considering the uncertainties in the experimental data the temperature sensitivity analysis was carried out for n tetradecane toluene mch and ethanol at a pressure of 1 0 atm and equivalence ratio of 1 1 fig 9 shows the top ten reactions with the highest sensitivity coefficients for four components temperatures of 400 k and 440 k were chosen for n tetradecane because of the range of experimental data available fig 9 a while the other components were studied at temperatures of 350 k and 400 k the laminar flame speeds of the four components were sensitive primarily to c0 c1 reactions for example reaction r146 h o2 o oh had the highest sensitivity coefficient for four components however fuel specific reactions only influenced the laminar flame speed of toluene as shown in fig 9 b while c2 c3 reactions had lesser effects on the laminar flame speeds of all four components note that the top ten reactions were almost the same at the different temperatures studied which was not the case for the idt temperature sensitivity analysis the laminar flame speed for n tetradecane toluene mch and ethanol can be accurately displayed by adjusting the c0 c1 mechanism reactions 3 3 validation of marine engine combustion the purpose of developed surrogate fuel mechanism is to apply it in the cfd simulation the chemical reaction mechanism is coupled with the combustion model to research the combustion path of fuels and the formation of emissions products the cfd model of marine engine is a necessary method to validate the applicability of developed surrogate fuel mechanism the main parameters of marine engine are shown in table 2 fig 10 shows the cfd structure of real marine engine the main sub models were found in reference gail et al 2021 the detailed chemical kinetics model sage was used as a combustion model the newly developed mechanism was coupled with the sage combustion model to simulate the combustion of fuels the n tetradecane toluene ethanol and mch were used as evaporate species the mole fractions of evaporating species needed to set in the spray model which has a direct effect on the combustion and emission results in simulation a suitable ratio of components should be researched to provide accurate surrogate fuel of marine diesel fuel the detailed compositions of surrogate fuels were shown in table 3 the ratio of surrogate fuel s1 was set according to the measured ratio of species in diesel fuels the ratio of surrogate fuel s2 was set according to the cetane number cn and lower heating value lhv of real diesel the cn and lhv of s1 are 52 71 and 41 29 the cn and lhv of real fuel are 52 4 and 42 76 the lev of s3 is 42 11 which is closer to measured value than the value of s2 the simulated in cylinder pressure and nox emissions using three different surrogate fuels were compared with experimental data in this paper fig 11 shows the comparison results between experiment and simulation the results showed that simulated in cylinder pressures were in good agreement with experimental data a small difference was found at the start of the combustion phase the comparisons of key parameters are displayed in table 4 the simulated ignition delay time was shorter than the experimental result this is primarily because most of the macromolecules in diesel were not selected as components of the surrogate fuel the maximum in cylinder pressure was 5 0 bar lower than the measured value the maximum combustion pressure using surrogate s3 is closer to the experimental data compared with results using s1 and s2 the simulated results using surrogate s2 have maximum errors in brake power however the errors were in accepted range in general the simulation model predicted the combustion characteristics of the marine diesel engine well experimental and simulated nox emissions are compared in fig 12 the predicted nox emissions using surrogate s1was 0 86 g kwh higher than the experimental value the error is maximum between simulated results of using surrogate s2 and experiment the ratios of four components in surrogate fuel affect the formation of intermediate components such as oxygen atom the oxygen atom is the main species for the formation of nox due to the main elementary reaction o n2 no n the surrogate fuel s1 was proposed as surrogate fuel of marine diesel fuels by comparing the errors of three kinds of surrogate fuels the newly developed surrogate fuel mechanism is capable of reproducing the experimental in cylinder pressure and emissions of marine engines however the ratio and species of components affect the formation and oxidation of nox and soot the predicted ability of soot for developed surrogate fuel needs to be validated in the future due to the lack of experimental data 4 conclusions the surrogate fuel mechanism of marine diesel fuels was researched to improve the combustion path and reduce emission the developed multi component surrogate fuel mechanism includes four components n tetradecane toluene mch and ethanol the mechanism was validated with measured results in shock tube counterflow configuration and marine engine the key parameters were compared between simulation and experiment including idts flame speeds in cylinder pressure and emissions the main conclusions are as follows 1 the four components are chosen as surrogate fuel based on the measured mass fractions of different chemical species in real marine diesel fuel the multi component surrogate fuel mechanism is developed using the decoupling method the sensitivity analysis and path analysis methods are used to optimize the rate constants of key reactions in mechanism 2 the developed surrogate mechanism is extensively validated against experimental data of ignition delay times in shock tubes laminar flame speeds in counterflow configuration for each pure component it is shown that the simulation results agree reasonably well with the experimental data over a wide range of operation conditions 3 the multi component mechanism is coupled with the combustion model in the cfd simulation three kinds of surrogate fuels are researched on the effect of performance in marine diesel engine the experimental combustion characteristics as well as the nox emissions of marine diesel engine are all reasonably reproduced by the surrogate fuel s1 in conclusion the 64 19 n tetradecane 15 9 toluene 10 85 mch and 9 06 ethanol by mass fraction surrogate fuel is proposed as surrogate fuel of marine diesel engine credit authorship contribution statement xiuxiu sun methodology software data curation writing original draft preparation mengmeng wang resources methodology analysis incecik atilla conceptualization visualization investigation shizhe feng supervision writing review editing funding acquisition zhixiong li conceptualization writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by science and technology research project of higher education in hebei province no bj2021018 and funds for central universities of china 201912036 201941008 nomenclature abbreviation cn cetane number cfd computational fluid dynamic egr exhaust gas recirculation hxn n hexadecane hmn heptamethylnonane idts ignition delay times lhv lower heating value mch methylcyclohexane pah polycyclic aromatic hydrocarbon 
20627,this paper investigates a practical fixed time formation control strategy for underactuated autonomous surface vessels with unknown dynamics based on event triggered mechanism to deal with the leader follower configuration without the information of leader velocity the virtual vessel is designed to track the leader at desired bearing and distance a concise adaptive law is developed to compensate the adverse effect of the unknown time varying functions and unstructured uncertainty furthermore the event triggered mechanism is introduced to facilitate the smart triggering of control inputs different from most of the existing works the proposed controller is with merits of smaller computation load and less energy consumption theoretical analysis proves that under the presented algorithm all the tracking errors in the closed loop system can converge to the neighborhood of origin within fixed time settling meanwhile the convergence time is independent with the initial states of the system finally numerical examples are presented to demonstrate the feasibility and superiority of the proposed algorithm keywords autonomous surface vessels leader follower formation control fixed time control event triggered control 1 introduction with the development of ocean engineering technology autonomous surface vessels asvs have been widely adopted in marine tasks e g maritime patrol surveillance ocean resource surveys maritime search and rescue in such scenarios multiple asvs are usually employed to execute the same mission simultaneously due to the urgency of tasks formation control of multiple asvs is with advantages of strong fault tolerance high working efficiency and strong flexibility there are several approaches to achieve formation control of asvs e g behavior based approach balch and arkin 1999 topology based approach huang et al 2019 yu et al 2021a virtual structure beard et al 2001 sadowska et al 2011 leader follower consolini et al 2008 yu and chen 2020a and so on among them the leader follower is preferred by researchers due to its simplicity and reliability in practical implementation in fact the leader follower formation control problem is related to design tracking controllers to drive a group of followers to track reference positions at desired bearing and distance from leader compared with full actuated surface vessels the main problem in the design of formation controller for underactuated vessel is that the number of actuators usually equipped with main propeller and rudder is fewer than the degrees of freedom since the dynamics of such underactuated model is nonintegrable it cannot not be transformed into a driftless form this presents a serious challenge to controller design for underactuated vessels in order to overcome the challenge a variety of approaches breivik et al 2008 do 2012 yu et al 2021b have been developed for formation control of underactuated vessels in fahimi 2007 a sliding mode controller was proposed for underactuated unmanned surface vessels usvs to achieve arbitrary formation in sun et al 2018 the result was extended to a more general case where nonlinear terms was considered in ship dynamics by introducing virtual vehicles an improved leader follower strategy was designed for underactuated followers to track reference paths without the need of leader velocity cui et al 2010 to decrease the distance error more smoothly a novel approach angle was proposed for followers to track the desired position in park 2015 meanwhile the neural network term was embedded into the formation controller to enhance the system robustness to implement different formation scenarios a swarm control scheme was designed for self organized system and then the transition strategy was developed to smooth the formation change in yu et al 2020 yu and chen 2020b although the desired geometric pattern is achieved under aforementioned works only asymptotic stability of closed loop system is obtained to further improve the tracking performance some resultful finite time controllers were derived in ai and yu 2019 and qin et al 2019 in hou et al 2019 the authors investigated the path following problem where the usv could track a straight line path with input saturation in jin 2016 a finite time formation control scheme that stabilize the leader follower formation with actuator faults was proposed where tan type barrier lyapunov function was incorporated to meet the los range and angle constraint more recently the idea of fixed time control algorithm provides efficient method to achieve fast convergence while independent of initial conditions in cruz zavala et al 2011 a uniform robust exact differentiator ured was proposed for double integral system high degree correction term was introduced to acquire uniform convergence property this is the precursor to the concept of fixed time control soon afterwards rigorous analysis for fixed time stability of chain integrator was presented in polyakov et al 2015 required convergence time was predefined by tuning control parameters in jin 2019 the problem of tracking control for multi input and multi output mimo nonlinear systems has been studied with the introduction of the adaptive estimation technique tracking errors were converged to the neighborhood of origin in fixed time however these results cannot be directly applied to the leader follower formation control of underactuated surface vehicles besides how to reduce the energy consumption of the actuator is a very important consideration in practice most asvs are designed to adjust their actuators at periodic intervals so that they will always track the reference path and maintain reasonable accuracy nevertheless such time triggered mechanism may result in unnecessary consumption of energy and abrasion of actuators hence more attention have been paid to the event triggered control of unmanned systems zhang et al 2020 tallapragada and chopra 2013 for trajectory tracking control of full actuated surface vessels a event triggered based guidance controller was presented to program the desired trajectory in jiao and wang 2016 where the amount of computation and communication was reduced effectively considering the bounded disturbance and input constraint a event triggered model predictive control law was proposed for underactuated underwater vehicles in liu et al 2017 furthermore sufficient conditions were presented to verify the stability of the closed loop system to avoid repetitive execution of actuators the event triggered mechanism was embedded into the propeller and the rudder of underactuated vessels and the so called zeno behavior was excluded in deng et al 2019 although the event triggered based control has great potential value to practical engineering few applications in the field of marine cybernetics are considered motivated by above observations we propose a novel event triggered fixed time leader follower formation controller for multiple underactuated asvs the main contributions of this work can be summarized as follows 1 an improved velocity regulator is designed for the virtual vessels to assist the tracking control of followers using only relative position the upper bound of the leader velocity is estimated by the concise adaptive law 2 a novel robust practical fixed time formation controller is proposed for multiple underactuated asvs with unknown time varying functions unstructured uncertainty and unknown control input gain theoretical analysis illustrates that all the signals in the closed loop system are fixed time practical stable and the settling time is independent with initial states of the system 3 by fusion of the dynamic surface technique dsc and event triggered mechanism both analytic derivatives of the virtual controller and continuous update of control signals are avoided that could dramatically save the computation load of onboard processor and energy consumption of actuators the rest of this paper is organized as follows in section 2 the problem formulation and preliminaries are presented then the leader follower formation control scheme and main result are included in section 3 numerical simulation is conducted in section 4 section 5 concludes the paper 2 problem formulation and preliminaries throughout this paper denotes the absolute operator of a scalar is the euclidean norm of a vector λ min denotes the minimum eigenvalue of the matrix ˆ where ˆ is the estimation value of 2 1 mathematical model of the underactuated asv in this paper the kinematic model of the follower asv can be described as follows 1 η t r ψ t υ t where η t x t y t ψ t is the position vector x t y t is the coordinate of ship and ψ t is the yaw angle in the earth fixed frame υ u t v t r t is the velocity vector u t v t r t denote the surge velocity sway velocity and yaw angle velocity of ship in the body fixed frame respectively r ψ t is the rotation matrix with the form of r ψ t cos ψ t sin ψ t 0 sin ψ t cos ψ t 0 0 0 1 the general form of the dynamic model can be described as 2 u t θ u t f u υ t t g u υ t t t u t d w u t v t θ v t f v υ t t d w v t r t θ r t f r υ t t g r υ t t t r t d w r t where θ u t ℛ n u θ v t ℛ n v θ r t ℛ n r are unknown time varying functions with respect to n u n v n r dimensions f u ℛ n u f v ℛ n v f r ℛ n r are known smooth functions t u t t r t are two control inputs in surge and yaw directions with nonzero uncertain control gain g u g r d w u t d w v t d w r t are unstructured uncertainty such as environmental disturbance measurement noise etc for leader follower formation control we define the position vector of the leader as η l t x l t y l t ψ l t and the velocity vector as υ l t u l t v l t r l t the bearing angle from the leader to follower is denoted as λ t the distance between the leader and follower is denoted as ρ t x l t x t 2 y l t y t 2 assumption 1 the sway velocity of the underactuated vessel is passive bounded meanwhile the velocity vector of the leader υ l t is bounded by the unknown constant v m remark 1 the general form of the underactuated model 1 2 are similar to that in jihong et al 2008 jin 2016 it provides a more universal mathematical formulation for underactuated marine surface vehicles the dynamic formulation of underactuated ships presented in literatures do et al 2002 ghommam et al 2010 can also be converted into the form of 2 furthermore the unknown time varying functions f u f v f r and the uncertain gain functions g u g r are also considered in this work which is more accord with practical engineering assumption 2 the uncertain control gain g u g r are bounded and positive definite such that g u g u g u g r g r g r where g u g u g r g r are unknown constants assumption 3 the unstructured uncertainty d w u t d w v t d w r t are bounded by positive unknown constants such that d w u t d w u max d w v t d w v max d w r t d w r max the fixed time control objective is to propose a leader follower controller such that 1 the virtual vessel can track the corresponding reference path without the need for leader velocity 2 both the unknown time varying functions and unstructured uncertainty can be addressed by the proposed algorithm 3 all the tracking errors can converge to a small neighborhood of origin with fixed time convergence rate meanwhile the settling time is independent with the initial states the following lemmas are presented to facilitate the discussion of the main result 2 2 some important lemmas lemma 1 polyakov et al 2015 for the dynamical system x t f t x x 0 0 where x ℛ n and f ℛ ℛ n ℛ n and suppose the origin is an equilibrium point if there exists a positive definite function v x and for positive real numbers μ 1 μ 2 α β γ with α γ 0 1 β γ 1 such that 3 v x μ 1 v x α μ 2 v x β γ ϱ then the origin x 0 of the system is practically fixed time stable the settling time t f can be estimated by following inequality 4 t f 1 μ 1 γ ϖ γ 1 α γ 1 μ 2 γ ϖ γ β γ 1 remark 2 motivated by jin 2019 in the following design process all the parameters in eq 3 are selected as γ 1 α 3 4 β 2 lemma 2 chen et al 2019 for ϕ ϑ ℛ and any real numbers p 0 q 0 ζ 0 the following inequality holds ϕ p ϑ q p p q ζ ϕ p q q p q ζ p q ϑ p q lemma 3 wang and lin 2015 for any x ℛ and any constant ε 0 we have 5 0 x x 2 x 2 ε 2 ε lemma 4 jihong et al 2008 for any δ 0 there exists a smooth function φ such that φ 0 0 and for ξ ℛ we have 6 ξ ξ φ ξ δ 3 controller design as shown in fig 1 the detail formation control can be described in next two subsections first a concise adaptive velocity regulator is presented for virtual vessels to build virtual geometric formation with no need of the leader velocity second a novel practical fixed time controller is designed for followers to track reference paths generated by virtual vessels by fusion of dsc technique and event triggered mechanism the so called explosion of complexity phenomenon and continuous update of control signals are avoided furthermore a novel bounded adaptation technique is employed to address the unknown time varying functions and unstructured uncertainty 3 1 formation set up in this subsection the virtual vessel is introduced to track the reference position at desired bearing and distance from the leader define the position vectors of the virtual vessel and reference position as η v η r their kinematics are subject to eq 1 in the earth fixed frame η r can be derived as 7 η r η l r ψ l l where l ρ d cos λ d ρ d sin λ d 0 is the desired offset vector define the error vector η e e 1 e 2 e 3 between the virtual vessel and reference position 8 η e η r η v to ensure that the virtual vessel is capable of tracking the reference position with fixed time settling the velocity regulator is designed as 9 υ v r ψ v k 1 sig η e 1 2 k 2 η e 3 v ˆ m tanh η e σ where k 1 ℛ 3 3 k 2 ℛ 3 3 are positive design matrixes sig η e 1 2 sign η e η e 1 2 the corresponding adaptive law is chosen as 10 v ˆ m γ 1 η e tanh η e σ k 3 v ˆ m k 4 v ˆ m 3 where k 3 ℛ 3 3 k 4 ℛ 3 3 are positive design matrixes γ 1 0 is a design constant consider the following lyapunov function candidate 11 v 1 1 2 η e η e 1 2 γ v m 2 differentiating 11 and substituting 9 10 into it 12 v 1 η e r ψ l υ r r ψ v υ v v m v ˆ m η e v m η e k 1 sig η e 1 2 k 2 η e 3 v ˆ m tanh η e σ v m η e tanh η e σ k 3 v ˆ m k 4 v ˆ m 3 k 1 η e 3 2 k 2 η e 4 0 2785 σ v m k 3 2 v m 2 3 4 k 3 2 v m 2 3 4 k 3 v m v ˆ m k 4 v m v ˆ m 3 for the term k 3 v m v ˆ m we have 13 k 3 v m v ˆ m k 3 2 v m 2 k 3 2 v m 2 according to lemma 2 let ϕ 1 ϑ k 3 2 v m 2 p 1 4 q 3 4 ζ e 3 ln 3 4 we have 14 k 3 2 v m 2 3 4 π k 3 2 v m 2 where π 1 4 e 3 ln 3 4 substituting 13 14 into 12 we have 15 v 1 k 1 η e 3 2 k 2 η e 4 k 3 2 v m 2 3 4 k 4 v m v ˆ m 3 k 3 2 v m 2 0 2785 σ v m since k 4 v m v ˆ m 3 k 4 v m v m 3 3 k 4 v m 2 v m 2 3 k 4 v m 3 v m k 4 v m 4 by utilizing young s inequality we have 16 k 4 v m v m 3 3 k 4 v m 2 v m 2 k 4 4 v m 4 3 k 4 v m 3 v m 9 k 4 ϵ 4 3 4 v m 4 3 k 4 4 ϵ 4 v m 4 then 17 k 4 v m v ˆ m 3 9 k 4 ϵ 4 3 4 k 4 v m 4 3 k 4 4 ϵ 4 k 4 4 v m 4 substituting 17 into 15 18 v 1 k 1 η e 3 2 k 2 η e 4 k 3 2 v m 2 3 4 k 4 9 k 4 ϵ 4 3 4 v m 4 ϱ 1 where ϱ 1 k 3 2 v m 2 3 k 4 4 ϵ 4 k 4 4 v m 4 0 2785 σ v m 3 2 formation control this subsection proposes a robust practical fixed time formation tracking algorithm for followers to track virtual vessels to address the so called explosion of complexity the dsc technique is employed to avoid the analytical derivatives of virtual controller a bounded adaptation law is developed to compensate the unknown time varying functions and unstructured uncertainty furthermore the event triggered mechanism is utilized to reduce unnecessary execution of actuators the design of the formation controller is divided into two steps step 1 define tracking errors between the virtual vessel and the follower as follows 19 x e y e ψ e r ψ x v x y v y ψ d ψ where x v y v is the position of the virtual vessel ψ d denotes the azimuth angle from follower relative to the virtual vessel 20 ψ d 0 5 1 sgn x e sgn y e π arctan y e x e the time derivative of 19 is 21 x e u u v cos ψ e r y e y e v u v sin ψ e r x e ψ e r r d where u v is the surge velocity of the virtual vessel and ψ d r d for u ψ e select the corresponding controller as α u α ψ e as 22 α u k x 1 sig x e 1 2 k x 2 x e 3 u v cos ψ e α ψ e atan k y 1 sig y e 1 2 k y 2 y e 3 v u v 2 y e 4 u v where k x 1 0 k x 2 0 k y 1 0 k y 2 0 are all design constants to avoid repeated differentiation of the virtual controller α u α ψ e first order filters are introduced based on dsc technique 23 τ u β u sig α u β u 1 2 sig α u β u 3 β u 0 α u 0 τ ψ e β ψ e sig α ψ e β ψ e 1 2 sig α ψ e β ψ e 3 β ψ e 0 α ψ e 0 where τ u τ ψ e are time constants β u β ψ e are outputs of the dsc define q u α u β u q ψ e α ψ e β ψ e u e u β u ψ e ψ e β ψ e we have 24 x e α u u v cos ψ e r y e q u u e y e v u v sin α ψ e ψ y r x e where ψ y cos ψ e q ψ e 1 sin α ψ e sin ψ e q ψ e cos α ψ e and it is easy to achieve that ψ y is bounded since β ψ e cannot be involved in the controller design of step 2 directly we introduce the dsc for the ψ e subsystem in eq 21 define q r α r β r r e r β r where α r is the virtual controller to be designed β r the output of the dsc τ r is the time constant 25 τ r β r sig α r β r 1 2 sig α r β r 3 β r 0 α r 0 differentiating ψ e with respect to time 26 ψ e r d α r q r r e β ψ e the virtual controller α r is selected as 27 α r k ψ 1 sig ψ e 1 2 k ψ 2 ψ e 3 r d β ψ e in the light of 23 and 25 let i u ψ e r 28 q i q i q i α i β i q i α i 1 τ i q i 3 2 1 τ i q i 4 the term q i α i can be transformed into 29 q i α i 2 ϵ 3 2 3 α i q i 3 2 1 3 ϵ 3 substituting 29 into 28 30 q i q i 1 τ i 2 ϵ 3 2 3 α i 3 2 q i 3 2 1 τ i q i 4 consider the second lyapunov function candidate 31 v 2 1 2 x e 2 1 2 y e 2 1 2 ψ e 2 1 2 q u 2 1 2 q ψ e 2 1 2 q r 2 taking time derivative of v 2 32 v 2 x e x e y e y e ψ e ψ e q u q u q ψ e q ψ e q r q r substituting 22 24 26 27 30 into 32 we have 33 v 2 k x 1 x e 3 2 k x 2 x e 4 k y 1 y e 3 2 k y 2 y e 4 k ψ 1 ψ e 3 2 k ψ 2 ψ e 4 x e q u x e u e ψ y 2 ψ e q r ψ e r e i u r ψ e 1 τ i 2 ϵ 3 2 3 α i 3 2 q i 3 2 i u r ψ e 1 τ i q i 4 k x 1 4 ϵ 3 2 3 x e 3 2 k x 2 x e 4 k y 1 y e 3 2 k y 2 y e 4 k ψ 1 4 ϵ 3 2 3 ψ e 3 2 k ψ 2 ψ e 4 i u r ψ e 1 τ i 2 ϵ 3 2 3 α i 3 2 q i 3 2 i u r 1 τ i ϵ 4 3 4 ϵ 3 q i 4 1 τ ψ e q ψ e 4 ϵ 4 3 4 ϵ 3 u e 4 r e 4 ϱ 2 where ϱ 2 ψ y 2 1 3 ϵ 7 step 2 according to 2 take the time derivative of u e r e 34 u e θ u f u g u t u d w u β u r e θ r f r g r t r d w r β r to reduce the frequency of the execution of actuators we introduce an event triggered mechanism with relative threshold garcia and antsaklis 2011 the actual control inputs can be designed as 35 ω i 1 b i i e t i 2 g i e 2 t i 2 ε i 2 i u r t i k i 1 sig i e 1 2 k i 2 i e 3 β i θ ˆ i f i d ˆ i max ϕ i e where k i 1 0 k i 2 0 are design constants and ϕ i e satisfies lemma 4 furthermore t t k i t k 1 i t i satisfying 36 t i t ω i t k i t t k i t k 1 i i u r where t k i is the triggering instant of the actuator and the control input will remain unchanged during the time interval t t k i t k 1 i the event triggered condition is set to 37 e i t ω i t t i t t k 1 i inf t t k i e i t b i t i d i i u r where threshold b i t i d i and b i d i are design parameters satisfying 0 b i 1 d i 0 consider the above event triggered condition the control signal will be updated as long as the condition is violated i e e i t b i t i d i is always satisfied therefore the following two cases should be discussed case 1 for t i t 0 we have b i t i d i ω i t t i t b i t i d i then eq 38 can be derived 38 ω i t t i t ρ i b i t i d i ρ i 1 1 case 2 for t i t 0 we have b i t i d i ω i t t i t b i t i d i then eq 39 can be derived 39 ω i t t i t ρ i b i t i d i ρ i 1 1 consider the case 1 and case 2 we have 40 ω i t t i t ρ 1 i b i t i ρ 2 i d i with ρ 1 i ρ 2 i ρ i t i t 0 ρ 1 i ρ 2 i ρ i t i t 0 eq 40 can be rewritten as 41 ω i t 1 ρ 1 i b i t i ρ 2 i d i i u r 42 t i ω i 1 ρ 1 i b i ρ 2 i d i 1 ρ 1 i b i i u r for the unknown function θ i and unstructured uncertainty d w i the corresponding adaptive laws are designed as 43 θ ˆ i γ i 1 i e f i σ i 1 θ ˆ i σ i 2 γ i 1 θ ˆ i 3 d ˆ w i max γ i 2 i e ϕ i e σ i 3 d ˆ w i max σ i 4 γ i 2 d ˆ w i max 3 where γ i 1 0 γ i 2 0 σ i 1 0 σ i 2 0 σ i 3 0 σ i 4 0 are design constants select the following lyapunov function candidate 44 v 3 1 2 u e 2 1 2 r e 2 1 2 γ u 1 θ u 2 1 2 γ r 1 θ r 2 1 2 γ u 2 d u max 2 1 2 γ r 2 d r max 2 differentiating v 3 with respect to time and substituting 34 41 into it 45 v 3 i u r i e θ i f i g i ω i 1 ρ 1 i b i ρ 2 i d i 1 ρ 1 i b i d w i β i i u r 1 γ i 1 θ i θ ˆ i 1 γ i 2 d w i max d ˆ w i max since ρ 1 i 1 1 ρ 2 i 1 1 i u r the following inequalities can be derived 46 i e ω i 1 ρ 1 i b i i e ω i 1 b i ρ 2 i d i 1 ρ 1 i b i d i 1 b i on account of lemma 3 assumption 2 and eq 43 the term i e g i ω i 1 ρ 1 i b i can be expressed as 47 i e g i ω i 1 ρ 1 i b i 1 1 b i i e g i 1 b i i e t i 2 g i i e 2 t i 2 ε i 2 i e 2 t i 2 i e 2 t i 2 ε i 2 ε i i e t i substituting 35 46 47 into 45 48 v 3 i e θ i f i ε i i e t i i e g i ρ 2 i d i 1 ρ 1 i b i i e d w i i e β i i u r i e f i θ i σ i 1 γ i 1 θ ˆ i θ i σ i 2 γ i 1 2 θ ˆ i 3 θ i i u r i e ϕ i e d w i max σ i 3 γ i 2 d ˆ w i max d w i max σ i 4 γ i 2 2 i u r i e θ i f i i e ϕ i e d w i max d w i max δ i ε i k i 1 i e 3 2 k i 2 i e 4 i e g ρ 2 i d i 1 ρ 1 i b i i u r i e f i θ i σ i 1 γ i 1 θ ˆ i θ i σ i 2 γ i 1 2 θ ˆ i 3 θ i i u r i e ϕ i e d w i max σ i 3 γ i 2 d ˆ w i max d w i max σ i 4 γ i 2 2 i u r k i 1 2 ϵ 3 2 3 g i d i 1 b i 3 2 i e 3 2 i u r k i 2 i e 4 i u r σ i 1 γ i 1 θ i θ ˆ i i u r σ i 2 γ i 1 2 θ i θ ˆ i 3 i u r σ i 3 γ i 2 d w i max d ˆ w i max i u r σ i 4 γ i 2 2 d w i max d ˆ w i max 3 i u r d w i max δ i ε i 2 3 ϵ 3 similar to 17 we have 49 i u r σ i 2 γ i 1 2 θ i θ ˆ i 3 i u r 9 σ i 2 ϵ 4 3 4 γ i 1 2 σ i 2 γ i 1 2 θ i 4 i u r 3 σ i 2 4 ϵ 4 γ i 1 2 σ i 2 γ i 1 2 θ i 4 i u r σ i 4 γ i 2 2 d w i max d ˆ w i max 3 i u r 9 σ i 4 ϵ 4 3 4 γ i 2 2 σ i 4 γ i 2 2 d w i max 4 i u r 3 σ i 4 4 ϵ 4 γ i 2 2 σ i 4 γ i 2 2 d w i max 4 then we wave 50 v 3 i u r k i 1 2 ϵ 3 2 3 g i d i 1 b i 3 2 i e 3 2 i u r k i 2 i e 4 i u r σ i 1 2 γ i 1 θ i 2 3 4 i u r σ i 2 γ i 1 2 9 σ i 2 ϵ 4 3 4 γ i 1 2 θ i 4 i u r σ i 3 2 γ i 2 d w i max 2 3 4 i u r σ i 4 γ i 2 2 9 σ i 4 ϵ 4 3 4 γ i 2 2 d w i max 4 ϱ 3 where ϱ 3 i u r 3 σ i 2 4 ϵ 4 γ i 1 2 σ i 2 γ i 1 2 θ i 4 i u r 3 σ i 4 4 ϵ 4 γ i 2 2 σ i 4 γ i 2 2 d w i max 4 d w u max δ u d w r max δ r 2 3 ϵ 3 ε u ε r 3 3 main result theorem 1 consider the leader follower formation control for follower asvs 1 2 with assumptions 1 3 if we chose the adaptive velocity regulator 9 10 for virtual vessels the virtual controllers 22 27 the event triggered controllers 35 with bounded adaptive law 38 for followers then all the signals in the closed loop system are satisfied as being practical fixed time stability proof construct the overall lyapunov function candidate as 51 v v 1 v 2 v 3 differentiating v and substituting 18 33 and 47 into it 52 v k 1 η e 2 3 4 k 2 η e 2 2 k 3 2 3 4 v m 2 3 4 k 4 9 k 4 ϵ 4 3 4 v m 2 2 k x 1 4 ϵ 3 2 3 x e 2 3 4 k x 2 x e 2 2 k y 1 y e 2 3 4 k y 2 y e 2 2 k ψ 1 4 ϵ 3 2 3 ψ e 2 3 4 k ψ 2 ψ e 2 2 i u ψ e r 1 τ i 2 ϵ 3 2 3 α i 3 2 q i 2 3 4 i u r 1 τ i ϵ 4 3 4 ϵ 3 q i 2 2 1 τ ψ e q ψ e 2 2 k u 1 2 ϵ 3 2 3 g u d u 1 b u 3 2 ϵ 4 3 4 ϵ 3 u e 2 3 4 k r 1 2 ϵ 3 2 3 g r d r 1 b r 3 2 ϵ 4 3 4 ϵ 3 r e 2 3 4 i u r k i 2 i e 2 2 i u r σ i 1 3 4 1 2 γ i 1 θ i 2 3 4 i u r 4 σ i 2 9 σ i 2 ϵ 4 3 1 2 γ i 1 2 θ i 2 2 i u r σ i 3 3 4 1 2 γ i 2 d w i max 2 3 4 i u r 4 σ i 4 9 σ i 4 ϵ 4 3 1 2 γ i 2 2 d w i max 2 2 ϱ where ϱ ϱ 1 ϱ 2 ϱ 3 to preserve the stability of the closed loop system the design parameters should be tuned appropriately k 4 a v 9 k 4 ϵ 4 3 4 k x 1 a x 1 4 ϵ 3 2 3 k ψ 1 a ψ 1 4 ϵ 3 2 3 k ψ 2 a ψ 2 ϵ 4 3 4 ϵ 3 1 τ i a q i 1 2 ϵ 3 2 3 α i 3 2 1 τ i a q i 2 ϵ 4 3 4 ϵ 3 k u 1 a u 1 2 ϵ 3 2 3 g u d u 1 b u 3 2 ϵ 4 3 4 ϵ 3 k r 1 a r 1 2 ϵ 3 2 3 g r d r 1 b r 3 2 4 σ i 2 a θ i 9 σ i 2 ϵ 4 3 4 σ i 4 a d i 9 σ i 4 ϵ 4 3 where a v a x 1 a ψ 1 a ψ 2 a q i 1 a q i 2 a u 1 a r 1 a θ i a d i are all positive constants according to lemma 1 we have 53 v μ 1 v 3 4 μ 2 v 2 ϱ where μ 1 min λ min k 1 λ min k 3 a x 1 k y 1 a ψ 1 a q i 1 a u 1 a r 1 σ i 1 σ i 3 μ 2 min λ min k 2 λ min a v k x 2 k y 2 a ψ 2 a q i 2 1 τ ψ e k i 2 a θ i a d i from 50 it is easy to obtain that v μ 1 v 3 4 when v 2 ϱ μ 2 thus v is bounded and η e v m x e y e ψ e q u q r u e r e are bounded too as a result x y ψ u v r are all bounded then all the signals in the closed loop system can converge to an arbitrary small neighborhood of the origin with settling time t f 1 4 ϖ μ 1 1 ϖ μ 2 in addition we will prove that the zeno behavior can be excluded by the proposed algorithm it indicates that there exists t 0 such that t k 1 i t k i t k z using eq 37 we have d d t e i e i sgn e i ω i from 40 we learn that ω i is a differentiable function and ω i is a bounded compounded function therefore ω i ς i ς i ℛ furthermore it follows from e i t k i 0 and lim t t k 1 i e i t d i that t ς i d i hence the zeno behavior of the proposed algorithm can be excluded 4 numerical simulations in this section numerical simulations are conducted to verify the effectiveness and superiority of the proposed algorithm the formation system which consist of leader and followers is considered the dynamical equation of the underactuated surface vessel used in skjetne and øyvind smogeli 2004 is directly applied as the control plant for each follower the physical model based mathematical model is introduced to construct the marine environmental disturbance the sea wind and the irregular wind generated waves the jonswap wave spectrums fossen 2011 is introduced to generate the time varying waves spectrums with sixth level sea state the average velocity of wind v wind 15 7 m s the wind direction ψ wind 160 the 3d view of the waves is shown in fig 2 for the purpose to illustrate the performance of the closed loop system one leader and four followers are considered to build the desired formation the geometric formation is constructed as a straight line the leader follower configuration is selected as ρ d 1 ρ d 2 10 m ρ d 3 ρ d 4 5 m λ d 1 λ d 3 π 2 rad λ d 2 λ d 4 π 2 rad the initial condition of the leader is set to η l 0 m 0 m π 3 rad υ l 0 m s 0 m s 0 rad s the yaw angle velocity of the leader is set to r l 0 rad s when t 30 s and r l π 30 rad s for 30 s t 80 s the initial condition of virtual vessel is set to η v 1 12 m 2 m 0 rad υ v 1 0 m s 0 m s 0 rad s η v 2 12 m 3 m 0 rad υ v 2 0 m s 0 m s 0 rad s η v 3 6 m 0 m 0 rad υ v 3 0 m s 0 m s 0 rad s η v 4 6 m 2 m 0 rad υ v 4 0 m s 0 m s 0 rad s for followers the initial condition is set to η 1 12 m 2 m π 3 rad υ 1 0 m s 0 m s 0 rad s η 2 12 m 3 m π 6 rad υ 2 0 m s 0 m s 0 rad s η 3 6 m 2 m π 3 rad υ 3 0 m s 0 m s 0 rad s η 4 6 m 3 m π 6 rad υ 4 0 m s 0 m s 0 rad s time constants of dsc are selected as τ u τ r τ ψ e 0 01 s the main design parameters of the proposed algorithm are illustrated in table 1 simulation results are depicted in figs 3 10 fig 3 shows the formation tracking result we can learn that four followers started at random positions are able to track the reference paths and build the desired formation under the proposed algorithm from fig 4 we can easily verify that the position error between the virtual vessel and the reference paths can converge to small neighborhood of the origin adaptive parameters of the virtual vessel velocities are presented in fig 5 fig 6 illustrates the position error and yaw angle error of the followers under different initial conditions we can learn that the error states of followers are capable to converge to the small neighborhood of origin with fixed time settling fig 7 presents the velocities of the followers respectively fig 8 shows the control inputs of the followers both the transient response and the steady state response of the proposed controller achieve the satisfactory closed loop performance corresponding parameter adaptation result are shown in fig 9 fig 10 shows the triggering instants of control signals the continuous execution of actuators is avoided and thus the energy consumption is reduced 5 conclusions in this paper a robust practical fixed time controller is proposed for multiple underactuated asvs to achieve the leader follower formation control a velocity regulator is presented for virtual vessels to assist the tracking control of followers the bounded adaptation technique is developed to eliminate adverse effect of the unknown time varying functions and unstructured uncertainty furthermore the event triggered mechanism is embedded in the controller to reduce the unnecessary execution of actuators by utilizing the lyapunov theory it is proved that all error signals in the closed loop system can converge into a small neighborhood near the origin with fixed time convergence rate the algorithm is with advantages of small computation load and low energy consumption that could facilitate the implementation of the proposed algorithm in ocean engineering in the future the inter vehicle communication will be considered in the proposed frame work especially communication delay and failures effects as well as the decentralized leader follower control credit authorship contribution statement chenfeng huang controller design software writing original draft xianku zhang conceptualization editing supervision guoqing zhang investigation methodology yingjie deng writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is partially supported by the national natural science foundation of china no 51679024 51909018 the fundamental research funds for the central university china no 3132019501 3132019502 the national high technology research and development program of china no 2015aa016404 the university 111 project of china no b08046 the doctoral innovation program of dalian maritime university china no bscxxm001 the authors wold like to thank anonymous reviewers for their valuable comments to improve the quality of this article 
20627,this paper investigates a practical fixed time formation control strategy for underactuated autonomous surface vessels with unknown dynamics based on event triggered mechanism to deal with the leader follower configuration without the information of leader velocity the virtual vessel is designed to track the leader at desired bearing and distance a concise adaptive law is developed to compensate the adverse effect of the unknown time varying functions and unstructured uncertainty furthermore the event triggered mechanism is introduced to facilitate the smart triggering of control inputs different from most of the existing works the proposed controller is with merits of smaller computation load and less energy consumption theoretical analysis proves that under the presented algorithm all the tracking errors in the closed loop system can converge to the neighborhood of origin within fixed time settling meanwhile the convergence time is independent with the initial states of the system finally numerical examples are presented to demonstrate the feasibility and superiority of the proposed algorithm keywords autonomous surface vessels leader follower formation control fixed time control event triggered control 1 introduction with the development of ocean engineering technology autonomous surface vessels asvs have been widely adopted in marine tasks e g maritime patrol surveillance ocean resource surveys maritime search and rescue in such scenarios multiple asvs are usually employed to execute the same mission simultaneously due to the urgency of tasks formation control of multiple asvs is with advantages of strong fault tolerance high working efficiency and strong flexibility there are several approaches to achieve formation control of asvs e g behavior based approach balch and arkin 1999 topology based approach huang et al 2019 yu et al 2021a virtual structure beard et al 2001 sadowska et al 2011 leader follower consolini et al 2008 yu and chen 2020a and so on among them the leader follower is preferred by researchers due to its simplicity and reliability in practical implementation in fact the leader follower formation control problem is related to design tracking controllers to drive a group of followers to track reference positions at desired bearing and distance from leader compared with full actuated surface vessels the main problem in the design of formation controller for underactuated vessel is that the number of actuators usually equipped with main propeller and rudder is fewer than the degrees of freedom since the dynamics of such underactuated model is nonintegrable it cannot not be transformed into a driftless form this presents a serious challenge to controller design for underactuated vessels in order to overcome the challenge a variety of approaches breivik et al 2008 do 2012 yu et al 2021b have been developed for formation control of underactuated vessels in fahimi 2007 a sliding mode controller was proposed for underactuated unmanned surface vessels usvs to achieve arbitrary formation in sun et al 2018 the result was extended to a more general case where nonlinear terms was considered in ship dynamics by introducing virtual vehicles an improved leader follower strategy was designed for underactuated followers to track reference paths without the need of leader velocity cui et al 2010 to decrease the distance error more smoothly a novel approach angle was proposed for followers to track the desired position in park 2015 meanwhile the neural network term was embedded into the formation controller to enhance the system robustness to implement different formation scenarios a swarm control scheme was designed for self organized system and then the transition strategy was developed to smooth the formation change in yu et al 2020 yu and chen 2020b although the desired geometric pattern is achieved under aforementioned works only asymptotic stability of closed loop system is obtained to further improve the tracking performance some resultful finite time controllers were derived in ai and yu 2019 and qin et al 2019 in hou et al 2019 the authors investigated the path following problem where the usv could track a straight line path with input saturation in jin 2016 a finite time formation control scheme that stabilize the leader follower formation with actuator faults was proposed where tan type barrier lyapunov function was incorporated to meet the los range and angle constraint more recently the idea of fixed time control algorithm provides efficient method to achieve fast convergence while independent of initial conditions in cruz zavala et al 2011 a uniform robust exact differentiator ured was proposed for double integral system high degree correction term was introduced to acquire uniform convergence property this is the precursor to the concept of fixed time control soon afterwards rigorous analysis for fixed time stability of chain integrator was presented in polyakov et al 2015 required convergence time was predefined by tuning control parameters in jin 2019 the problem of tracking control for multi input and multi output mimo nonlinear systems has been studied with the introduction of the adaptive estimation technique tracking errors were converged to the neighborhood of origin in fixed time however these results cannot be directly applied to the leader follower formation control of underactuated surface vehicles besides how to reduce the energy consumption of the actuator is a very important consideration in practice most asvs are designed to adjust their actuators at periodic intervals so that they will always track the reference path and maintain reasonable accuracy nevertheless such time triggered mechanism may result in unnecessary consumption of energy and abrasion of actuators hence more attention have been paid to the event triggered control of unmanned systems zhang et al 2020 tallapragada and chopra 2013 for trajectory tracking control of full actuated surface vessels a event triggered based guidance controller was presented to program the desired trajectory in jiao and wang 2016 where the amount of computation and communication was reduced effectively considering the bounded disturbance and input constraint a event triggered model predictive control law was proposed for underactuated underwater vehicles in liu et al 2017 furthermore sufficient conditions were presented to verify the stability of the closed loop system to avoid repetitive execution of actuators the event triggered mechanism was embedded into the propeller and the rudder of underactuated vessels and the so called zeno behavior was excluded in deng et al 2019 although the event triggered based control has great potential value to practical engineering few applications in the field of marine cybernetics are considered motivated by above observations we propose a novel event triggered fixed time leader follower formation controller for multiple underactuated asvs the main contributions of this work can be summarized as follows 1 an improved velocity regulator is designed for the virtual vessels to assist the tracking control of followers using only relative position the upper bound of the leader velocity is estimated by the concise adaptive law 2 a novel robust practical fixed time formation controller is proposed for multiple underactuated asvs with unknown time varying functions unstructured uncertainty and unknown control input gain theoretical analysis illustrates that all the signals in the closed loop system are fixed time practical stable and the settling time is independent with initial states of the system 3 by fusion of the dynamic surface technique dsc and event triggered mechanism both analytic derivatives of the virtual controller and continuous update of control signals are avoided that could dramatically save the computation load of onboard processor and energy consumption of actuators the rest of this paper is organized as follows in section 2 the problem formulation and preliminaries are presented then the leader follower formation control scheme and main result are included in section 3 numerical simulation is conducted in section 4 section 5 concludes the paper 2 problem formulation and preliminaries throughout this paper denotes the absolute operator of a scalar is the euclidean norm of a vector λ min denotes the minimum eigenvalue of the matrix ˆ where ˆ is the estimation value of 2 1 mathematical model of the underactuated asv in this paper the kinematic model of the follower asv can be described as follows 1 η t r ψ t υ t where η t x t y t ψ t is the position vector x t y t is the coordinate of ship and ψ t is the yaw angle in the earth fixed frame υ u t v t r t is the velocity vector u t v t r t denote the surge velocity sway velocity and yaw angle velocity of ship in the body fixed frame respectively r ψ t is the rotation matrix with the form of r ψ t cos ψ t sin ψ t 0 sin ψ t cos ψ t 0 0 0 1 the general form of the dynamic model can be described as 2 u t θ u t f u υ t t g u υ t t t u t d w u t v t θ v t f v υ t t d w v t r t θ r t f r υ t t g r υ t t t r t d w r t where θ u t ℛ n u θ v t ℛ n v θ r t ℛ n r are unknown time varying functions with respect to n u n v n r dimensions f u ℛ n u f v ℛ n v f r ℛ n r are known smooth functions t u t t r t are two control inputs in surge and yaw directions with nonzero uncertain control gain g u g r d w u t d w v t d w r t are unstructured uncertainty such as environmental disturbance measurement noise etc for leader follower formation control we define the position vector of the leader as η l t x l t y l t ψ l t and the velocity vector as υ l t u l t v l t r l t the bearing angle from the leader to follower is denoted as λ t the distance between the leader and follower is denoted as ρ t x l t x t 2 y l t y t 2 assumption 1 the sway velocity of the underactuated vessel is passive bounded meanwhile the velocity vector of the leader υ l t is bounded by the unknown constant v m remark 1 the general form of the underactuated model 1 2 are similar to that in jihong et al 2008 jin 2016 it provides a more universal mathematical formulation for underactuated marine surface vehicles the dynamic formulation of underactuated ships presented in literatures do et al 2002 ghommam et al 2010 can also be converted into the form of 2 furthermore the unknown time varying functions f u f v f r and the uncertain gain functions g u g r are also considered in this work which is more accord with practical engineering assumption 2 the uncertain control gain g u g r are bounded and positive definite such that g u g u g u g r g r g r where g u g u g r g r are unknown constants assumption 3 the unstructured uncertainty d w u t d w v t d w r t are bounded by positive unknown constants such that d w u t d w u max d w v t d w v max d w r t d w r max the fixed time control objective is to propose a leader follower controller such that 1 the virtual vessel can track the corresponding reference path without the need for leader velocity 2 both the unknown time varying functions and unstructured uncertainty can be addressed by the proposed algorithm 3 all the tracking errors can converge to a small neighborhood of origin with fixed time convergence rate meanwhile the settling time is independent with the initial states the following lemmas are presented to facilitate the discussion of the main result 2 2 some important lemmas lemma 1 polyakov et al 2015 for the dynamical system x t f t x x 0 0 where x ℛ n and f ℛ ℛ n ℛ n and suppose the origin is an equilibrium point if there exists a positive definite function v x and for positive real numbers μ 1 μ 2 α β γ with α γ 0 1 β γ 1 such that 3 v x μ 1 v x α μ 2 v x β γ ϱ then the origin x 0 of the system is practically fixed time stable the settling time t f can be estimated by following inequality 4 t f 1 μ 1 γ ϖ γ 1 α γ 1 μ 2 γ ϖ γ β γ 1 remark 2 motivated by jin 2019 in the following design process all the parameters in eq 3 are selected as γ 1 α 3 4 β 2 lemma 2 chen et al 2019 for ϕ ϑ ℛ and any real numbers p 0 q 0 ζ 0 the following inequality holds ϕ p ϑ q p p q ζ ϕ p q q p q ζ p q ϑ p q lemma 3 wang and lin 2015 for any x ℛ and any constant ε 0 we have 5 0 x x 2 x 2 ε 2 ε lemma 4 jihong et al 2008 for any δ 0 there exists a smooth function φ such that φ 0 0 and for ξ ℛ we have 6 ξ ξ φ ξ δ 3 controller design as shown in fig 1 the detail formation control can be described in next two subsections first a concise adaptive velocity regulator is presented for virtual vessels to build virtual geometric formation with no need of the leader velocity second a novel practical fixed time controller is designed for followers to track reference paths generated by virtual vessels by fusion of dsc technique and event triggered mechanism the so called explosion of complexity phenomenon and continuous update of control signals are avoided furthermore a novel bounded adaptation technique is employed to address the unknown time varying functions and unstructured uncertainty 3 1 formation set up in this subsection the virtual vessel is introduced to track the reference position at desired bearing and distance from the leader define the position vectors of the virtual vessel and reference position as η v η r their kinematics are subject to eq 1 in the earth fixed frame η r can be derived as 7 η r η l r ψ l l where l ρ d cos λ d ρ d sin λ d 0 is the desired offset vector define the error vector η e e 1 e 2 e 3 between the virtual vessel and reference position 8 η e η r η v to ensure that the virtual vessel is capable of tracking the reference position with fixed time settling the velocity regulator is designed as 9 υ v r ψ v k 1 sig η e 1 2 k 2 η e 3 v ˆ m tanh η e σ where k 1 ℛ 3 3 k 2 ℛ 3 3 are positive design matrixes sig η e 1 2 sign η e η e 1 2 the corresponding adaptive law is chosen as 10 v ˆ m γ 1 η e tanh η e σ k 3 v ˆ m k 4 v ˆ m 3 where k 3 ℛ 3 3 k 4 ℛ 3 3 are positive design matrixes γ 1 0 is a design constant consider the following lyapunov function candidate 11 v 1 1 2 η e η e 1 2 γ v m 2 differentiating 11 and substituting 9 10 into it 12 v 1 η e r ψ l υ r r ψ v υ v v m v ˆ m η e v m η e k 1 sig η e 1 2 k 2 η e 3 v ˆ m tanh η e σ v m η e tanh η e σ k 3 v ˆ m k 4 v ˆ m 3 k 1 η e 3 2 k 2 η e 4 0 2785 σ v m k 3 2 v m 2 3 4 k 3 2 v m 2 3 4 k 3 v m v ˆ m k 4 v m v ˆ m 3 for the term k 3 v m v ˆ m we have 13 k 3 v m v ˆ m k 3 2 v m 2 k 3 2 v m 2 according to lemma 2 let ϕ 1 ϑ k 3 2 v m 2 p 1 4 q 3 4 ζ e 3 ln 3 4 we have 14 k 3 2 v m 2 3 4 π k 3 2 v m 2 where π 1 4 e 3 ln 3 4 substituting 13 14 into 12 we have 15 v 1 k 1 η e 3 2 k 2 η e 4 k 3 2 v m 2 3 4 k 4 v m v ˆ m 3 k 3 2 v m 2 0 2785 σ v m since k 4 v m v ˆ m 3 k 4 v m v m 3 3 k 4 v m 2 v m 2 3 k 4 v m 3 v m k 4 v m 4 by utilizing young s inequality we have 16 k 4 v m v m 3 3 k 4 v m 2 v m 2 k 4 4 v m 4 3 k 4 v m 3 v m 9 k 4 ϵ 4 3 4 v m 4 3 k 4 4 ϵ 4 v m 4 then 17 k 4 v m v ˆ m 3 9 k 4 ϵ 4 3 4 k 4 v m 4 3 k 4 4 ϵ 4 k 4 4 v m 4 substituting 17 into 15 18 v 1 k 1 η e 3 2 k 2 η e 4 k 3 2 v m 2 3 4 k 4 9 k 4 ϵ 4 3 4 v m 4 ϱ 1 where ϱ 1 k 3 2 v m 2 3 k 4 4 ϵ 4 k 4 4 v m 4 0 2785 σ v m 3 2 formation control this subsection proposes a robust practical fixed time formation tracking algorithm for followers to track virtual vessels to address the so called explosion of complexity the dsc technique is employed to avoid the analytical derivatives of virtual controller a bounded adaptation law is developed to compensate the unknown time varying functions and unstructured uncertainty furthermore the event triggered mechanism is utilized to reduce unnecessary execution of actuators the design of the formation controller is divided into two steps step 1 define tracking errors between the virtual vessel and the follower as follows 19 x e y e ψ e r ψ x v x y v y ψ d ψ where x v y v is the position of the virtual vessel ψ d denotes the azimuth angle from follower relative to the virtual vessel 20 ψ d 0 5 1 sgn x e sgn y e π arctan y e x e the time derivative of 19 is 21 x e u u v cos ψ e r y e y e v u v sin ψ e r x e ψ e r r d where u v is the surge velocity of the virtual vessel and ψ d r d for u ψ e select the corresponding controller as α u α ψ e as 22 α u k x 1 sig x e 1 2 k x 2 x e 3 u v cos ψ e α ψ e atan k y 1 sig y e 1 2 k y 2 y e 3 v u v 2 y e 4 u v where k x 1 0 k x 2 0 k y 1 0 k y 2 0 are all design constants to avoid repeated differentiation of the virtual controller α u α ψ e first order filters are introduced based on dsc technique 23 τ u β u sig α u β u 1 2 sig α u β u 3 β u 0 α u 0 τ ψ e β ψ e sig α ψ e β ψ e 1 2 sig α ψ e β ψ e 3 β ψ e 0 α ψ e 0 where τ u τ ψ e are time constants β u β ψ e are outputs of the dsc define q u α u β u q ψ e α ψ e β ψ e u e u β u ψ e ψ e β ψ e we have 24 x e α u u v cos ψ e r y e q u u e y e v u v sin α ψ e ψ y r x e where ψ y cos ψ e q ψ e 1 sin α ψ e sin ψ e q ψ e cos α ψ e and it is easy to achieve that ψ y is bounded since β ψ e cannot be involved in the controller design of step 2 directly we introduce the dsc for the ψ e subsystem in eq 21 define q r α r β r r e r β r where α r is the virtual controller to be designed β r the output of the dsc τ r is the time constant 25 τ r β r sig α r β r 1 2 sig α r β r 3 β r 0 α r 0 differentiating ψ e with respect to time 26 ψ e r d α r q r r e β ψ e the virtual controller α r is selected as 27 α r k ψ 1 sig ψ e 1 2 k ψ 2 ψ e 3 r d β ψ e in the light of 23 and 25 let i u ψ e r 28 q i q i q i α i β i q i α i 1 τ i q i 3 2 1 τ i q i 4 the term q i α i can be transformed into 29 q i α i 2 ϵ 3 2 3 α i q i 3 2 1 3 ϵ 3 substituting 29 into 28 30 q i q i 1 τ i 2 ϵ 3 2 3 α i 3 2 q i 3 2 1 τ i q i 4 consider the second lyapunov function candidate 31 v 2 1 2 x e 2 1 2 y e 2 1 2 ψ e 2 1 2 q u 2 1 2 q ψ e 2 1 2 q r 2 taking time derivative of v 2 32 v 2 x e x e y e y e ψ e ψ e q u q u q ψ e q ψ e q r q r substituting 22 24 26 27 30 into 32 we have 33 v 2 k x 1 x e 3 2 k x 2 x e 4 k y 1 y e 3 2 k y 2 y e 4 k ψ 1 ψ e 3 2 k ψ 2 ψ e 4 x e q u x e u e ψ y 2 ψ e q r ψ e r e i u r ψ e 1 τ i 2 ϵ 3 2 3 α i 3 2 q i 3 2 i u r ψ e 1 τ i q i 4 k x 1 4 ϵ 3 2 3 x e 3 2 k x 2 x e 4 k y 1 y e 3 2 k y 2 y e 4 k ψ 1 4 ϵ 3 2 3 ψ e 3 2 k ψ 2 ψ e 4 i u r ψ e 1 τ i 2 ϵ 3 2 3 α i 3 2 q i 3 2 i u r 1 τ i ϵ 4 3 4 ϵ 3 q i 4 1 τ ψ e q ψ e 4 ϵ 4 3 4 ϵ 3 u e 4 r e 4 ϱ 2 where ϱ 2 ψ y 2 1 3 ϵ 7 step 2 according to 2 take the time derivative of u e r e 34 u e θ u f u g u t u d w u β u r e θ r f r g r t r d w r β r to reduce the frequency of the execution of actuators we introduce an event triggered mechanism with relative threshold garcia and antsaklis 2011 the actual control inputs can be designed as 35 ω i 1 b i i e t i 2 g i e 2 t i 2 ε i 2 i u r t i k i 1 sig i e 1 2 k i 2 i e 3 β i θ ˆ i f i d ˆ i max ϕ i e where k i 1 0 k i 2 0 are design constants and ϕ i e satisfies lemma 4 furthermore t t k i t k 1 i t i satisfying 36 t i t ω i t k i t t k i t k 1 i i u r where t k i is the triggering instant of the actuator and the control input will remain unchanged during the time interval t t k i t k 1 i the event triggered condition is set to 37 e i t ω i t t i t t k 1 i inf t t k i e i t b i t i d i i u r where threshold b i t i d i and b i d i are design parameters satisfying 0 b i 1 d i 0 consider the above event triggered condition the control signal will be updated as long as the condition is violated i e e i t b i t i d i is always satisfied therefore the following two cases should be discussed case 1 for t i t 0 we have b i t i d i ω i t t i t b i t i d i then eq 38 can be derived 38 ω i t t i t ρ i b i t i d i ρ i 1 1 case 2 for t i t 0 we have b i t i d i ω i t t i t b i t i d i then eq 39 can be derived 39 ω i t t i t ρ i b i t i d i ρ i 1 1 consider the case 1 and case 2 we have 40 ω i t t i t ρ 1 i b i t i ρ 2 i d i with ρ 1 i ρ 2 i ρ i t i t 0 ρ 1 i ρ 2 i ρ i t i t 0 eq 40 can be rewritten as 41 ω i t 1 ρ 1 i b i t i ρ 2 i d i i u r 42 t i ω i 1 ρ 1 i b i ρ 2 i d i 1 ρ 1 i b i i u r for the unknown function θ i and unstructured uncertainty d w i the corresponding adaptive laws are designed as 43 θ ˆ i γ i 1 i e f i σ i 1 θ ˆ i σ i 2 γ i 1 θ ˆ i 3 d ˆ w i max γ i 2 i e ϕ i e σ i 3 d ˆ w i max σ i 4 γ i 2 d ˆ w i max 3 where γ i 1 0 γ i 2 0 σ i 1 0 σ i 2 0 σ i 3 0 σ i 4 0 are design constants select the following lyapunov function candidate 44 v 3 1 2 u e 2 1 2 r e 2 1 2 γ u 1 θ u 2 1 2 γ r 1 θ r 2 1 2 γ u 2 d u max 2 1 2 γ r 2 d r max 2 differentiating v 3 with respect to time and substituting 34 41 into it 45 v 3 i u r i e θ i f i g i ω i 1 ρ 1 i b i ρ 2 i d i 1 ρ 1 i b i d w i β i i u r 1 γ i 1 θ i θ ˆ i 1 γ i 2 d w i max d ˆ w i max since ρ 1 i 1 1 ρ 2 i 1 1 i u r the following inequalities can be derived 46 i e ω i 1 ρ 1 i b i i e ω i 1 b i ρ 2 i d i 1 ρ 1 i b i d i 1 b i on account of lemma 3 assumption 2 and eq 43 the term i e g i ω i 1 ρ 1 i b i can be expressed as 47 i e g i ω i 1 ρ 1 i b i 1 1 b i i e g i 1 b i i e t i 2 g i i e 2 t i 2 ε i 2 i e 2 t i 2 i e 2 t i 2 ε i 2 ε i i e t i substituting 35 46 47 into 45 48 v 3 i e θ i f i ε i i e t i i e g i ρ 2 i d i 1 ρ 1 i b i i e d w i i e β i i u r i e f i θ i σ i 1 γ i 1 θ ˆ i θ i σ i 2 γ i 1 2 θ ˆ i 3 θ i i u r i e ϕ i e d w i max σ i 3 γ i 2 d ˆ w i max d w i max σ i 4 γ i 2 2 i u r i e θ i f i i e ϕ i e d w i max d w i max δ i ε i k i 1 i e 3 2 k i 2 i e 4 i e g ρ 2 i d i 1 ρ 1 i b i i u r i e f i θ i σ i 1 γ i 1 θ ˆ i θ i σ i 2 γ i 1 2 θ ˆ i 3 θ i i u r i e ϕ i e d w i max σ i 3 γ i 2 d ˆ w i max d w i max σ i 4 γ i 2 2 i u r k i 1 2 ϵ 3 2 3 g i d i 1 b i 3 2 i e 3 2 i u r k i 2 i e 4 i u r σ i 1 γ i 1 θ i θ ˆ i i u r σ i 2 γ i 1 2 θ i θ ˆ i 3 i u r σ i 3 γ i 2 d w i max d ˆ w i max i u r σ i 4 γ i 2 2 d w i max d ˆ w i max 3 i u r d w i max δ i ε i 2 3 ϵ 3 similar to 17 we have 49 i u r σ i 2 γ i 1 2 θ i θ ˆ i 3 i u r 9 σ i 2 ϵ 4 3 4 γ i 1 2 σ i 2 γ i 1 2 θ i 4 i u r 3 σ i 2 4 ϵ 4 γ i 1 2 σ i 2 γ i 1 2 θ i 4 i u r σ i 4 γ i 2 2 d w i max d ˆ w i max 3 i u r 9 σ i 4 ϵ 4 3 4 γ i 2 2 σ i 4 γ i 2 2 d w i max 4 i u r 3 σ i 4 4 ϵ 4 γ i 2 2 σ i 4 γ i 2 2 d w i max 4 then we wave 50 v 3 i u r k i 1 2 ϵ 3 2 3 g i d i 1 b i 3 2 i e 3 2 i u r k i 2 i e 4 i u r σ i 1 2 γ i 1 θ i 2 3 4 i u r σ i 2 γ i 1 2 9 σ i 2 ϵ 4 3 4 γ i 1 2 θ i 4 i u r σ i 3 2 γ i 2 d w i max 2 3 4 i u r σ i 4 γ i 2 2 9 σ i 4 ϵ 4 3 4 γ i 2 2 d w i max 4 ϱ 3 where ϱ 3 i u r 3 σ i 2 4 ϵ 4 γ i 1 2 σ i 2 γ i 1 2 θ i 4 i u r 3 σ i 4 4 ϵ 4 γ i 2 2 σ i 4 γ i 2 2 d w i max 4 d w u max δ u d w r max δ r 2 3 ϵ 3 ε u ε r 3 3 main result theorem 1 consider the leader follower formation control for follower asvs 1 2 with assumptions 1 3 if we chose the adaptive velocity regulator 9 10 for virtual vessels the virtual controllers 22 27 the event triggered controllers 35 with bounded adaptive law 38 for followers then all the signals in the closed loop system are satisfied as being practical fixed time stability proof construct the overall lyapunov function candidate as 51 v v 1 v 2 v 3 differentiating v and substituting 18 33 and 47 into it 52 v k 1 η e 2 3 4 k 2 η e 2 2 k 3 2 3 4 v m 2 3 4 k 4 9 k 4 ϵ 4 3 4 v m 2 2 k x 1 4 ϵ 3 2 3 x e 2 3 4 k x 2 x e 2 2 k y 1 y e 2 3 4 k y 2 y e 2 2 k ψ 1 4 ϵ 3 2 3 ψ e 2 3 4 k ψ 2 ψ e 2 2 i u ψ e r 1 τ i 2 ϵ 3 2 3 α i 3 2 q i 2 3 4 i u r 1 τ i ϵ 4 3 4 ϵ 3 q i 2 2 1 τ ψ e q ψ e 2 2 k u 1 2 ϵ 3 2 3 g u d u 1 b u 3 2 ϵ 4 3 4 ϵ 3 u e 2 3 4 k r 1 2 ϵ 3 2 3 g r d r 1 b r 3 2 ϵ 4 3 4 ϵ 3 r e 2 3 4 i u r k i 2 i e 2 2 i u r σ i 1 3 4 1 2 γ i 1 θ i 2 3 4 i u r 4 σ i 2 9 σ i 2 ϵ 4 3 1 2 γ i 1 2 θ i 2 2 i u r σ i 3 3 4 1 2 γ i 2 d w i max 2 3 4 i u r 4 σ i 4 9 σ i 4 ϵ 4 3 1 2 γ i 2 2 d w i max 2 2 ϱ where ϱ ϱ 1 ϱ 2 ϱ 3 to preserve the stability of the closed loop system the design parameters should be tuned appropriately k 4 a v 9 k 4 ϵ 4 3 4 k x 1 a x 1 4 ϵ 3 2 3 k ψ 1 a ψ 1 4 ϵ 3 2 3 k ψ 2 a ψ 2 ϵ 4 3 4 ϵ 3 1 τ i a q i 1 2 ϵ 3 2 3 α i 3 2 1 τ i a q i 2 ϵ 4 3 4 ϵ 3 k u 1 a u 1 2 ϵ 3 2 3 g u d u 1 b u 3 2 ϵ 4 3 4 ϵ 3 k r 1 a r 1 2 ϵ 3 2 3 g r d r 1 b r 3 2 4 σ i 2 a θ i 9 σ i 2 ϵ 4 3 4 σ i 4 a d i 9 σ i 4 ϵ 4 3 where a v a x 1 a ψ 1 a ψ 2 a q i 1 a q i 2 a u 1 a r 1 a θ i a d i are all positive constants according to lemma 1 we have 53 v μ 1 v 3 4 μ 2 v 2 ϱ where μ 1 min λ min k 1 λ min k 3 a x 1 k y 1 a ψ 1 a q i 1 a u 1 a r 1 σ i 1 σ i 3 μ 2 min λ min k 2 λ min a v k x 2 k y 2 a ψ 2 a q i 2 1 τ ψ e k i 2 a θ i a d i from 50 it is easy to obtain that v μ 1 v 3 4 when v 2 ϱ μ 2 thus v is bounded and η e v m x e y e ψ e q u q r u e r e are bounded too as a result x y ψ u v r are all bounded then all the signals in the closed loop system can converge to an arbitrary small neighborhood of the origin with settling time t f 1 4 ϖ μ 1 1 ϖ μ 2 in addition we will prove that the zeno behavior can be excluded by the proposed algorithm it indicates that there exists t 0 such that t k 1 i t k i t k z using eq 37 we have d d t e i e i sgn e i ω i from 40 we learn that ω i is a differentiable function and ω i is a bounded compounded function therefore ω i ς i ς i ℛ furthermore it follows from e i t k i 0 and lim t t k 1 i e i t d i that t ς i d i hence the zeno behavior of the proposed algorithm can be excluded 4 numerical simulations in this section numerical simulations are conducted to verify the effectiveness and superiority of the proposed algorithm the formation system which consist of leader and followers is considered the dynamical equation of the underactuated surface vessel used in skjetne and øyvind smogeli 2004 is directly applied as the control plant for each follower the physical model based mathematical model is introduced to construct the marine environmental disturbance the sea wind and the irregular wind generated waves the jonswap wave spectrums fossen 2011 is introduced to generate the time varying waves spectrums with sixth level sea state the average velocity of wind v wind 15 7 m s the wind direction ψ wind 160 the 3d view of the waves is shown in fig 2 for the purpose to illustrate the performance of the closed loop system one leader and four followers are considered to build the desired formation the geometric formation is constructed as a straight line the leader follower configuration is selected as ρ d 1 ρ d 2 10 m ρ d 3 ρ d 4 5 m λ d 1 λ d 3 π 2 rad λ d 2 λ d 4 π 2 rad the initial condition of the leader is set to η l 0 m 0 m π 3 rad υ l 0 m s 0 m s 0 rad s the yaw angle velocity of the leader is set to r l 0 rad s when t 30 s and r l π 30 rad s for 30 s t 80 s the initial condition of virtual vessel is set to η v 1 12 m 2 m 0 rad υ v 1 0 m s 0 m s 0 rad s η v 2 12 m 3 m 0 rad υ v 2 0 m s 0 m s 0 rad s η v 3 6 m 0 m 0 rad υ v 3 0 m s 0 m s 0 rad s η v 4 6 m 2 m 0 rad υ v 4 0 m s 0 m s 0 rad s for followers the initial condition is set to η 1 12 m 2 m π 3 rad υ 1 0 m s 0 m s 0 rad s η 2 12 m 3 m π 6 rad υ 2 0 m s 0 m s 0 rad s η 3 6 m 2 m π 3 rad υ 3 0 m s 0 m s 0 rad s η 4 6 m 3 m π 6 rad υ 4 0 m s 0 m s 0 rad s time constants of dsc are selected as τ u τ r τ ψ e 0 01 s the main design parameters of the proposed algorithm are illustrated in table 1 simulation results are depicted in figs 3 10 fig 3 shows the formation tracking result we can learn that four followers started at random positions are able to track the reference paths and build the desired formation under the proposed algorithm from fig 4 we can easily verify that the position error between the virtual vessel and the reference paths can converge to small neighborhood of the origin adaptive parameters of the virtual vessel velocities are presented in fig 5 fig 6 illustrates the position error and yaw angle error of the followers under different initial conditions we can learn that the error states of followers are capable to converge to the small neighborhood of origin with fixed time settling fig 7 presents the velocities of the followers respectively fig 8 shows the control inputs of the followers both the transient response and the steady state response of the proposed controller achieve the satisfactory closed loop performance corresponding parameter adaptation result are shown in fig 9 fig 10 shows the triggering instants of control signals the continuous execution of actuators is avoided and thus the energy consumption is reduced 5 conclusions in this paper a robust practical fixed time controller is proposed for multiple underactuated asvs to achieve the leader follower formation control a velocity regulator is presented for virtual vessels to assist the tracking control of followers the bounded adaptation technique is developed to eliminate adverse effect of the unknown time varying functions and unstructured uncertainty furthermore the event triggered mechanism is embedded in the controller to reduce the unnecessary execution of actuators by utilizing the lyapunov theory it is proved that all error signals in the closed loop system can converge into a small neighborhood near the origin with fixed time convergence rate the algorithm is with advantages of small computation load and low energy consumption that could facilitate the implementation of the proposed algorithm in ocean engineering in the future the inter vehicle communication will be considered in the proposed frame work especially communication delay and failures effects as well as the decentralized leader follower control credit authorship contribution statement chenfeng huang controller design software writing original draft xianku zhang conceptualization editing supervision guoqing zhang investigation methodology yingjie deng writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is partially supported by the national natural science foundation of china no 51679024 51909018 the fundamental research funds for the central university china no 3132019501 3132019502 the national high technology research and development program of china no 2015aa016404 the university 111 project of china no b08046 the doctoral innovation program of dalian maritime university china no bscxxm001 the authors wold like to thank anonymous reviewers for their valuable comments to improve the quality of this article 
20628,this study proposed a fault diagnosis method based on deep learning and attention mechanism for autonomous underwater vehicle auv firstly a data attention mechanism is proposed to introduce dynamic weighting coefficients of monitoring variables to realize dynamic decorrelation then the automatic feature engineering is realized by a bi directional gated recurrent unit gru network to acquire the time dynamic characteristics of monitoring variables finally fault detection is implemented via multi layer perceptron mlp with respect to fault identification this study embeds a spatial attention mechanism in the fault detection network to capture the semantic relationship between monitoring variables and faults and fault identification result can be obtained by parsing this semantic relationship we present a new loss function and training strategy for cooperation between the fault detection and identification tasks the proposed method is validated on the monitoring data of qianlong 2 auv obtained during the mission in the south china sea which shows the effectiveness and superiority of the method graphical abstract keywords autonomous underwater vehicle fault diagnosis attention mechanism deep learning nomenclature abbreviations am fd attention mechanism based fault diagnosis auv autonomous underwater vehicle bigru bi directional gated recurrent unit ch4 methane cnn convolutional neural network ctd conductivity temperature depth measuring system daq data acquisition dm depth measuring device dvl doppler velocity log ec electromagnetic compass em electrical measurement far false alarm rate fdr fault detection rate g good gps global positioning system gru gated recurrent unit imu inertial measurement unit knn k nearest neighbor lstm long short term memory network mlp multi layer perceptron ng not good nn neural network rf random forest rnn recurrent neural network svm support vector machine usbl ultra short baseline xgboost extreme gradient boosting symbols a t attention matrix a t t attention c inter representation d input sequence d data in input sequence d backward input sequence d forward input sequence d i n p u t input data matrix g feature g r a d task gradient h encoder hidden state h backward hidden state of gru h forward hidden state of gru l loss l proportion of loss relative to initialization l 1 cross entropy loss l 2 global loss l 3 local loss l 4 sparsity loss l g r a d loss gradient n number of monitoring variables o backward score in data attention mechanism o forward score in data attention mechanism p prediction r task optimization degree s decoder hidden state s monitoring window length s a spatial attention w socre in spatial attention mechanism w e i g h t weight matrix x number of features for each sample y true value y ˆ estimated value α weight in spatial attention mechanism β backward weight in data attention mechanism β forward weight in data attention mechanism γ optimization coefficient λ penalty coefficient of sparse term in oscarmax ϕ historical data ω constraint in oscarmax ω learnable parameter 1 introduction autonomous underwater vehicle auv works in the complex ocean environment as the mission becomes more complicated and longer security is one of the most important issues in its operation brito et al 2010 fault diagnosis is one of the basic technologies to ensure the safety of auv therefore research of fault diagnosis technology is of great significance to improve the safety and reliability of auv xiang et al 2017 in general the fault detection and diagnosis approach for auv can be classified into two types data driven and model driven chu et al 2020 model driven algorithms require the modeling of diagnostic objects a common strategy is to rely entirely on empirical knowledge such as fault tree analysis tan 2005 however empirical knowledge is difficult to describe the actual object completely so a scheme combining data for modeling emerged pugi et al 2018 accurately designs the response model of the propeller and then a redundant and reconfigurable propulsion system is proposed to improve the motion ability of the underwater vehicle qiao and zhang 2017 proposed an adaptive non singular integral terminal sliding mode control scheme for trajectory tracking of autonomous underwater vehicles with dynamic uncertainties and time varying external disturbances qing et al 2018 proposed a robust optimal sliding mode control approach based on a linear quadratic regulator model the auv in a vertical plane meng et al 2020 designed the sliding mode observers and applied it to fault reconstruction of underwater thrusters fault detection correctness depends on model accuracy due to the data noise external interference and other factors an accurate model is difficult to obtain chi et al 2020 in addition the model driven approach requires the modeling of diagnostic objects which limits the generality of the method when the diagnostic object is a complex system it will become a difficult task to model the diagnostic object and the accuracy of the established model is difficult to meet the diagnostic accuracy the data driven methods do not require modeling diagnostic object which makes the data driven methods highly general guo et al 2019 extracts the features of auv monitoring data to detect the fault of resource exploration system qin et al 2019 employed neural network nn to estimate and compensate the general disturbances consisting of model uncertainties external disturbances and thruster faults machine learning is a typical data driven method which is widely used as a solution to fault diagnosis and has achieved good results in this field researchers have actively explored the application of different machine learning algorithms in different fault diagnosis scenarios such as support vector machine svm ming jun et al 2014 random forest rf liu et al 2019 extreme gradient boosting xgboost zhang et al 2018 k nearest neighbor knn sarmadi and karamodin 2020 and other algorithms with the increasing complexity of auv and missions fault diagnosis methods are faced with larger data volume more data types and more complex data relationships recent deep learning algorithms have demonstrated promising results yielded significant diagnostic accuracy yan et al 2020 qin et al 2018 proposed a fault diagnosis method based on a predictive model using the long short term memory network lstm the trained network can be used to establish the motion model of auv by fitting the sensor system lin et al 2019 proposed a recurrent neural network rnn with convolution to improve the autonomous ability and intelligence of obstacle avoidance planning montazeri et al 2014 applied multi layer perceptron mlp and adaline to design the adaptive filter which estimates the state of the plant in each sample time sans muntadas et al 2019 used a convolutional neural network cnn to create an end to end solution from an image to a control signal however the above fault diagnosis methods do not deal well with the time dynamic and strong correlation characteristics in auv data in fault diagnosis methods for auv more attention is paid to fault detection and less attention is paid to fault identification in the above cited deep learning methods fault identification is not involved qin et al 2018 lin et al 2019 montazeri et al 2014 sans muntadas et al 2019 for auvs underwater missions are time consuming and expensive in fault modes such as sensor interference auv can continue to perform the mission in other failure modes such as propeller damage auv must terminate the mission immediately and float up to reduce the loss therefore fault identification is essential for auv to perform missions efficiently zhang et al 2015 raanan et al 2018 applied an online bayesian nonparametric topic modeling technique to auv sensor data then used a nearest neighbor classifier for fault detection and diagnosis their results showed that the proposed method can accurately identify and characterize patterns that correspond to various states of the auv liu et al 2017 proposed an auv thruster fault identification method based on fractal feature and multiresolution wavelet decomposition fault identification is realized by establishing a fault sample library of fractal features however it is difficult to identify fault because of black box internal structures of deep learning network doshi velez and kim 2017 in order to identify fault in a deep learning network we develop a spatial attention mechanism to capture the semantic relationship in this study a deep learning method is proposed for fault diagnosis including fault detection and fault identification for fault detection in order to reduce the impact of the strong coupling relationship between systems a data attention mechanism is proposed which introduces dynamic weighting coefficients of monitoring variables to realize dynamic data decorrelation then automatic feature engineering is realized by using a bi directional gru bigru network to acquire the features of monitoring variables finally we use mlp to implement fault detection for fault identification we embed a spatial attention mechanism in the fault detection network to capture the semantic relationship between monitoring variables and faults in order to improve the identification accuracy weight initialization and sparse activation function are used to improve the spatial attention mechanism base on the above we present a new loss function and training strategy to balance fault detection and fault identification tasks a fault diagnosis method based on deep learning and attention mechanism is proposed and applied to qianlong 2 auv the main innovative research works of this paper includes 1 for fault detection we develop a data attention mechanism to decorrelate data dynamically and take advantage of the strong coupling relationship between qianlong 2 auv systems 2 for fault identification we develop a spatial attention mechanism to capture the semantic relationship between monitoring variables and faults and fault identification result can be obtained by parsing this semantic relationship 3 in order to realize fault detection and fault identification in the same network we propose a new loss function and a new training strategy for the cooperation between the two tasks the remainder of this paper is outlined as follows section 2 describes qianlong 2 auv analyzes the data and fault mode section 3 presents a deep learning method based on attention mechanism for fault diagnosis including fault detection fault identification and training strategy section 4 provides the experimental results on qianlong 2 auv to demonstrate the performance of proposed methods section 5 presents a brief conclusion for this paper 2 qianlong 2 auv the qianlong 2 auv is a 4500 m class auv which is 3 5 m long 1 5 m high and weighs 1 5 tones it has a biomimetic appearance that looks like a small yellow fish as shown in fig 1 the qianlong 2 auv is equipped with four main propellers mounted on the steering gears and a lateral auxiliary thruster which makes the vehicle more flexible in performing exploration tasks for submarine resources xu et al 2019 qianlong 2 auv integrates motion system resource exploration system communication system etc each system includes a large number of equipment and sensors the coupling relationship between system equipment and sensors is complex therefore the action of auv will affect multiple monitoring variables at the same time and the monitoring data of the navigation process has strong correlation characteristics fig 1 shows the physical location of some hardware devices fig 2 shows the system architecture and data interaction among data acquisition daq system control system and execution system daq system interacts with control system through data bus and control command is transmitted to execution system through control bus daq system includes resource exploration system vehicle sensing system navigation sensing system and other parts the specific functions of each sensor are shown in the data acquisition system in fig 2 some sensors set available for the qianlong 2 auv includes inertial measurement unit imu ultra short baseline usbl electromagnetic compass ec electrical measurement em depth measuring device dm global positioning system gps doppler velocity log dvl conductivity temperature depth measuring system ctd in order to ensure the normal operation of daq system and enhance the availability of data we have carried out preliminary processing on the original monitoring data the preliminary processing initiates with the form handling of data data is tabulated in the appropriate form for the next steps of the methodology next the data are synchronized using linear interpolation cheliotis et al 2019 it is an especially important process when using similarity based imputation approaches as the daq sensors do not have exactly the same sampling rate we select 55 monitoring variables are selected for fault diagnosis under the guidance of experts and list all the monitoring variables in table 1 v1 v32 and v48 v55 are the direct measurements of sensors v34 v41 are the attitude variables after the measurements are processed v47 is the navigation variable after the measurements are processed and v42 v46 are the control variables as for the vehicle variables taking v34 as an example it is a high confidence altitude combined with v5 v33 hydrological conditions during navigation and sensor drift interference the fault of qianlong 2 auv inevitably involves multiple monitoring variables such as the fault motor stalling which involves motion monitoring variables motion control variables and posture variables moreover in some cases the fault will not appear alone such as motor stalling and battery abnormal these two faults often occur at the same time motor stalling will cause battery abnormal and battery abnormal can also cause motor stalling it is difficult to accurately analyze the initial cause of the fault in this study we use the monitoring data of auv to diagnose the fault table 2 lists several faults direct and related variables of qianlong 2 auv such as the fault bow left motor stall direct variables are bow left motor speed and bow left motor speed setting related variables are other motor speed speed setting and posture variables 3 proposed method a deep learning method based on attention mechanism is proposed for fault diagnosis with application in qianlong 2 auv the execution flow of the proposed method is shown in fig 3 the method is divided into offline modeling and online diagnosis the execution steps of the method are as follows offline modeling step 1 get historical data and divide historical data into input data and label data step 2 use data attention mechanism for decorrelating data dynamically step 3 use bigru for automatic feature engineering and data feature coding step 4 use spatial attention mechanism for capturing the semantic relationship between monitoring variables and faults implement fault identification by parsing semantic relationships step 5 use mlp for fault detection from features step 6 use historical input data and label train the diagnosis model online diagnosis step 1 embed the diagnosis model into auv system step 2 get real time data stream step 3 use trained model to obtain the fault detection and fault diagnosis results 3 1 fault detection as shown in fig 4 the fault detection algorithm consists of a bigru network for feature coding a data attention mechanism for data decorrelation and an mlp to detect fault from features we use a gru network cho et al 2014 to implement automatic feature engineering in automatic feature engineering gru reads input sample as eq 1 into a fixed length representation vector c d is the data matrix where t is the length of a data sample and n is the number of monitoring variables d t is the relevant information of the monitoring variable sequence at time t as eq 2 1 d input d 1 d t 1 d t d t 1 d t r n t 2 d t d t 1 d t 2 d t n t r n since it encodes the input series of each time step in an orderly manner the hidden state is constantly updated according to the following equation 3 h t g h t 1 d t where g represents a gru h t r n is a hidden state at time t and n denotes the number of hidden nodes after gru reads the end of the input sequence d t the last hidden state will be the summary c of the whole input sample d input c h t one disadvantage of traditional gru is that it only reads temporal information in a single direction the strong time correlation of auv data shows that whether the temporal information is fully utilized determines the fault diagnosis ability of the algorithm there is no reason not to use bidirectional temporal information to overcome the limitations of the regular grus the bidirectional gru network schuster and paliwal 2002 is employed to process the input information in the forward and backward directions as shown in fig 5 in the bigru network gru reads the forward and the backward temporal information at the same time to calculate the forward and the backward hiding state similar to eq 3 the bigru network calculates the hidden state according to eq 4 4 h t g t h t 1 d t h t g t h t 1 d t each input sequence d input is represented by connecting the hidden state of the forward gru and the hidden state of the backward gru as eq 5 which summarizes the previous and future information of d input 5 h t h t t h t t t because of the coupling relationship between auv systems equipment and sensors there is a strong correlation among auv monitoring variables we propose a data attention mechanism to emphasize the correlation between different monitoring variables the basic principle is to obtain the general correlation between variables through learning and use this general correlation to decorrelate the monitoring variables the dry data with no general correlation or residual correlation the difference between the sample correlation and the general correlation will be highlighted which will help us to carry out fault detection in monitoring variable time series the weight is adaptively assigned to each monitoring variable refer to the historical data set φ t τ historical data set φ t τ records the values of n monitoring variables in the past τ time step denoted as 6 φ t τ ϕ t 1 ϕ t 2 ϕ t n r τ n in which 7 ϕ t j d t 1 j d t 2 j d t τ j t r τ represents the previous time series corresponding to the monitoring variable j next multiply the value corresponding to each monitoring variable by its weight affected by the bidirectional gru network the input sequence d t is the sum of the forward input sequence d t and the backward input sequence d t as eq 8 8 d t d t d t r n the forward and backward input sequences are calculated as follows 9 d t β t 1 d t 1 β t 2 d t 2 β t n d t n t d t β t 1 d t 1 β t 2 d t 2 β t n d t n t where β t j and β t j represent weights of monitoring variable j in the forward and backward directions and can be respectively computed as follows 10 β t j exp o t j k 1 n exp o t j β t j exp o t j k 1 n exp o t j in which 11 o t j s c o r e h t 1 ϕ t j o t j s c o r e h t 1 ϕ t j are built by the soft attention model s c o r e the proposed data attention mechanism is calculated by considering the hidden states and the previous time series of each variable the weights obtained by data attention mechanisms reflect the dynamic data correlation between different monitoring variables across t time steps we use mlp montazeri et al 2014 to detect fault from features the basic unit of the mlp network is the perceptron which is the basis of neural network technology it has the ability of linear non linear fitting prediction the mlp developed by it has the ability of universal approximation the task is to complete the final classification through attention distribution and features 3 2 fault identification as shown in fig 6 the fault identification algorithm includes a spatial attention mechanism to capture the semantics relationship between monitoring variables and faults an attention parsing and visualization method to analyze the semantics relationship and optimization methods for spatial attention mechanism in order to model the semantic relationship between monitoring variables and faults we use a spatial attention mechanism and then we can obtain fault identification in the fault detection algorithm we extract the features of auv data and detect fault mode by the data features in the fault identification algorithm the features of auv data are processed by spatial attention mechanism to get a new inter representation c the new inter representation c depends on the representation sequence h which contains the information of the entire input sequence the weighted sum of these representations can be calculated as follow 12 c t k 1 n α t k h t k in which the subscript t is the diagnosis time α is the weight which is a probability that the variable k is aligned with the fault detection result it is computed as follow 13 α t k exp w t k k 1 n exp w t k being similar to data attention mechanism the attention mechanism w t k is calculated by 14 w t k s c o r e s h t k where s is the decoder hidden state in the fault diagnosis algorithm s is a scalar because the target sequence has only g good or ng not good two states and the length is one the output of spatial attention mechanism to each monitoring window d t is an attention distribution vector as eq 15 15 α t α t 1 α t 2 α t n the output is an attention distribution matrix for the whole auv data d input as eq 16 16 α α 1 t α 2 t α t t t for fault identification spatial attention which can provide support is expected but after the establishment of the model the attention distribution matrix is not well interpretable for engineers to solve this problem various methods are used to optimize spatial attention to ensure that attention is suitable for fault identification we improve spatial attention mechanism by weight initialization method and sparse activation function some experiments on a simple data set of 10 10 are carried out for illustration and fig 7 shows the visualization results of different attention distribution matrices fig 7 a shows that the attention distribution vectors on ng samples are discrete while the attention on g samples are almost uniform fig 7 b shows that the attention distribution vectors on g samples are discrete fig 7 c shows that the attention distribution vectors on all samples are discrete it is reasonable that the attention distribution vectors are discrete on g or ng samples according to the theory of attention mechanism the former can be interpreted as these variables can predict this sample as label g and the latter can be interpreted as those variables can predict that sample as label ng but considering the requirement for fault identification we pay more attention to the samples with label ng and think that the situation like a and c is expected and the situation like b is of no value we observe the s c o r e output of some samples with uniform attention distribution and find the output is all close to 0 this means that attention is independent of features which is unacceptable the initial algorithm uses the random method to initialize the network weight and we use the xavier initialization method to initialize xavier initialization is an initialization method proposed by glorot and bengio 2010 to solve the problem of random initialization as shown in formula 17 17 weight u 6 n j n j 1 6 n j n j 1 p x j p y j where weight is the weight matrix u is the uniform distribution j is the network layer number x j is the layer input y j is the layer output that weight obeys u makes x j and y j obey the same distribution the principle of this method is to make the input and output obey the same distribution as much as possible in spatial attention mechanism the input is features extracted by bigru which must not be uniformly distributed using the xavier initialization method we can avoid the uniform distribution of the output in fig 7 c the attention distribution vector is not sparse that is the algorithm thinks that almost all variables and fault labels are related this result is a lack of value the algorithm uses softmax as the activation function of attention mechanism such as eq 10 softmax maps the input into the 0 1 interval linearly and makes the sum of outputs 1 the sparse activation function can control that the attention distribution vector of each sample is sparse which makes the algorithm find out the variables with higher importance we use oscarmax proposed by niculae and blondel 2017 as the activation function it encourages variables with the same attention to merge into clusters regardless of position in the sequence which results in mapping as eq 18 18 ω 1 2 y 2 2 λ i j max y i y j where the right part is the sparse term λ is the penalty coefficient of sparse term the larger λ is the more sparse ω is i and j are the position number fig 7 c and d show the difference in attention distribution when softmax and oscarmax are used as activation functions using oscarmax instead of softmax can achieve the sparse distribution vector 3 3 training strategy in order to optimize spatial attention it is necessary to describe the attention quantitatively based on the attention distribution vector and matrix we define three indexes to quantify attention to quantify the global performance of attention that is the ability to identify the overall fault by attention distribution matrix we propose g l o b a l the fault of time adjacent samples should be similar from a global perspective the attention distribution of samples should be gradual we use the similarity between adjacent samples to quantify the global performance of attention to quantify the attention performance of each sample that is the ability to identify fault of each sample by attention distribution vector we propose l o c a l the attention distribution of a sample should be discrete we use the discrete degree of the attention distribution vector to quantify the attention performance of each sample to quantify the sparsity of attention we use s p a r s i t y attention should be concentrated on several variables even if all variables are affected by the fault the algorithm should be able to find the most relevant variable for fault identification we pay more attention to samples with label ng so the calculation of attention indexes focuses on ng samples ignores g samples the useful attention to fault identification should be that the distribution vectors of adjacent samples have high similarity the distribution vectors of samples are discrete and sparse the calculation method of index g l o b a l refer to eq 19 19 g l o b a l i 2 m dist a t i a t i 1 p i p i 1 i 2 m p i p i 1 where i is the sample number m is the total number of samples at is the attention distribution vector of a sample dist is the distance between two vectors and p is the predicted result of the sample take 1 for ng and 0 for g the calculation method of index l o c a l refer to eq 20 20 l o c a l i 1 m σ a t i p i i 1 m p i where σ at is the standard deviation of at the calculation method of index s p a r s i t y refer to eq 21 21 s p a r s i t y i 1 m g θ a t i p i i 1 m p i where g θ is the number of elements greater than θ in the vector θ is the attention threshold of the variable in the fault diagnosis of qianlong 2 auv engineers think that when θ is about 20 the fault identification result is the best these three attention indexes are helpful to quantitatively compare the attention distribution matrix the useful attention distribution should be low g l o b a l high l o c a l and low s p a r s i t y fig 7 a b and c are the attention distribution matrix of multiple runs of the same data which show that the algorithm is not consistent when running multiple times moreover the algorithm does not learn in the direction of enhancing the ability of fault identification we add the attention indexes to the loss function to control the model learning along the direction of fault identification ability enhancement we have three attention indexes g l o b a l l o c a l and s p a r s i t y we use these indexes to calculate the g l o b a l term l o c a l term and s p a r s i t y term of the loss function with the cross entropy loss function to optimize the detection capability there are four loss function terms as fig 8 22 l 1 y log y ˆ 1 y log 1 y ˆ 23 l 2 g l o b a l l 3 l o c a l l 4 s p a r s i t y fig 9 illustrates the cooperation relationship between fault identification algorithm and fault detection algorithm spatial attention mechanism reads features of decorrelation auv data processed by data attention mechanism output spatial attention to mlp to help detect faults output spatial attention to the attention parsing module to realize fault identification the fault detection task has the detection loss function and the fault identification task has the attention loss function these two tasks cooperate to get the training gradient which is learned by all learnable networks the optimization of the four loss terms is mutual restriction and influence attention loss will affect the convergence of detection loss function and fault identification task will affect the learning rate and performance of fault detection task in order to solve the problem of mutual restriction caused by multi tasks and multi loss multi task learning mtl is used to balance different loss and tasks loss function of multi tasks refer to eq 24 24 l t ω i t l i t chen et al 2018 proposed gradnorm a multi task balancing method gradnorm s solution is to use ω i as a learnable parameter the idea of gradnorm is that without considering the learning rate the gradient of each task should be close to the average value as far as possible so that the learning rate of the task with insufficient learning can be increased the gradient of t a s k i at time t 25 g r a d i t ω i t l i t 2 average gradient of all tasks 26 g r a d i t e t a s k g r a d i t the proportion of loss relative to initialization is defined as optimization degree 27 l i t l i t l i 0 a ratio value is defined to measure the optimization degree of t a s k i relative to all tasks the higher the value the less optimization degree relative to other tasks 28 r i t l i t e t a s k l i t finally a loss function is defined as optimization objective function of ω i 29 l g r a d t ω i t i g i t g i t r i t γ 1 we initialize ω i to 1 which is ω i 0 1 we take γ as 1 5 refer to chen et al 2018 the overall network structure is shown in fig 10 4 experiments in order to verify the effectiveness of this new fault diagnosis algorithm in this section the monitoring data of qianlong 2 auv obtained during the mission in the south china sea are used to verify the proposed method during the sea trial dm interference fault motor stall fault motor speed feedback error fault ctd not on fault battery voltage fault and other faults occurred the purpose of this experiment is to detect these faults and provide fault correlation variables so as to identify faults it should be noted that although the experiment is based on historical data offline the data collected are real therefore the proposed scheme can be transplanted to qianlong 2 auv for online detection we selected three segments of real data and one segment of simulation data three segments of real data are segment 1 segment 2 and segment 3 with the label of g ng a segment of simulated data is segment 4 it is obtained by adding simulated faults based on real fault free data with g ng labels and marked fault variables data collection of monitoring variables is carried out every second in this experiment the data are preprocessed by the method of standardization and sliding window the length of the sliding window is 60 and the step is 5 in this paper the proposed fault diagnosis method based on attention mechanism is referred to as am fd 4 1 performance of fault detection we compare the detection performance of am fd simulation online diagnosis with the offline diagnosis results of traditional fault detection methods svm rf knn lstm mlp and cnn fault detection rate fdr false alarm rate far and f1 are used to measure the fault detection ability fdr is the correct classification rate of the sample labeled ng while far is the wrong classification rate of another sample f1 is called balanced score which is defined as the harmonic mean of fdr and recall rate 1 far table 3 shows the performance of am fd and different fault detection methods for these four segments in the table bold values are the best of all methods am fd can get the best performance in most cases f1 is always the best fdr and far are sometimes slightly worse than other algorithms am fd processes the strong coupling relationship between systems by the data attention mechanism making better use of the correlation information among variables the bigru network was used for data feature coding including forward and backward temporal information semantic relationships among variables and faults are derived by a spatial attention mechanism that not only serves to parse for identification results but also coordinates features for fault detection by mlp am fd svm mlp and cnn are implemented through tensorflow cpu version with the same training parameters svm rf and knn are implemented by sk learn machine learning library the training parameters and structure parameters of all algorithms are shown in table 4 other parameters use the default parameters of the library in the experiment we ensure that the proposed algorithm has the same training parameters and similar structure with other algorithms so as to test the general superiority of the proposed algorithm we also give the test time of each algorithm here under the same training parameters the test time of am fd is higher than that of other deep learning algorithms but the sample diagnosis time is still much less than the sampling period in addition it must be pointed out that only the am fd algorithm proposed can identify fault for all samples and a single sample rf and other classification and regression tree algorithms can only provide the importance for variables of all samples 4 2 verification of fault identification am fd can mark the important variables related to the fault through attention distribution and the specific fault can be identified from the important variables because the real data does not contain specific fault labels and does not mark fault variables in order to verify the fault identification results of am fd on qianlong 2 auv we add simulated faults to the real fault free data the experiment of am fd on the simulation data segment 4 it is obtained by adding simulated faults on the basis of real fault free data including dm interference bow left motor stall bow left motor speed feedback error ctd not on and battery voltage reduction the simulated added fault cannot simulate the strong correlation of multi variables in the actual fault so we only change the direct variables of the fault the significance of the simulation experiment is to verify that am fd can find the direct fault variables fig 11 a shows the fault addition in this experiment we add 5 faults with g ng labels and marked fault variables to the real fault free data fig 11 b is the attention matrix visualization of the output of spatial attention mechanism in am fd it is obvious that attention is divided into five time periods which coincides with figure a figure b shows the variables that the method focuses on for each fault sample fig 12 is the bar charts of cumulative attention distribution of the five faults on each variable from which we can clearly see the attention on specific variables the red variables are the direct variables for this fault shown in table 2 am fd marks the direct variables and related variables in each fault section it can also be seen from fig 12 that v41 has high attention in different faults the variable v41 is the target value of auv speed almost all auv faults are related to this variable as can be seen from a variables that am fd pays the most attention to in the dm interference fault section are v4 and v5 which is consistent with adding fault variables manually in other words through the visualization of the attention distribution matrix it can be found that fault variables of the first fault period are v4 and v5 from which it can be inferred that the dm interference fault occurred in this period and fault identification is realized table 5 shows the recognition rate of several fault variables by am fd only the variables listed in table 5 are considered and the fault can be accurately identified in most cases combined with figs 10 and 11 for fault identification a better recognition effect can be obtained the lowest recognition rate is 0 845 for v4 in the first fault period combined with figs 11 b and 12 b it is still easy to analyze the occurrence of dm interference fault in this period without confusion it can be seen from sections 4 1 and 4 2 that am fd completes the fault diagnosis task well and effectively balances the two subtasks of fault detection and fault identification the application of am fd in qianlong 2 auv can improve the reliability and safety of navigation 5 conclusion in this paper a deep learning fault diagnosis method based on attention mechanism is proposed which is applied to qianlong 2 auv experimental results on qianlong 2 auv during the mission in the south china sea verify the effectiveness of the proposed method which can detect and identify the faults that occurred during the mission and improve the reliability effectively we will optimize the algorithm implementation to reduce the time cost of the proposed method this work can also be extended to other auvs firstly the navigation data of another auv is analyzed to adjust the network structure parameters of the algorithm then the auv data is used for training this network finally by integrating the algorithm into the auv online fault diagnosis can be realized however because proposed method is a supervised deep learning method it will not take effect without learning enough data with label in future research we will try to develop semi supervised fault diagnosis methods for auv credit authorship contribution statement shaoxuan xia software validation writing original draft writing review editing xiaofeng zhou term conceptualization supervision project administration funding acquisition haibo shi resources supervision shuai li writing review editing visualization investigation chunhui xu validation data curation investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this project is supported by nation key r d program of china 2018yfc0308205 
20628,this study proposed a fault diagnosis method based on deep learning and attention mechanism for autonomous underwater vehicle auv firstly a data attention mechanism is proposed to introduce dynamic weighting coefficients of monitoring variables to realize dynamic decorrelation then the automatic feature engineering is realized by a bi directional gated recurrent unit gru network to acquire the time dynamic characteristics of monitoring variables finally fault detection is implemented via multi layer perceptron mlp with respect to fault identification this study embeds a spatial attention mechanism in the fault detection network to capture the semantic relationship between monitoring variables and faults and fault identification result can be obtained by parsing this semantic relationship we present a new loss function and training strategy for cooperation between the fault detection and identification tasks the proposed method is validated on the monitoring data of qianlong 2 auv obtained during the mission in the south china sea which shows the effectiveness and superiority of the method graphical abstract keywords autonomous underwater vehicle fault diagnosis attention mechanism deep learning nomenclature abbreviations am fd attention mechanism based fault diagnosis auv autonomous underwater vehicle bigru bi directional gated recurrent unit ch4 methane cnn convolutional neural network ctd conductivity temperature depth measuring system daq data acquisition dm depth measuring device dvl doppler velocity log ec electromagnetic compass em electrical measurement far false alarm rate fdr fault detection rate g good gps global positioning system gru gated recurrent unit imu inertial measurement unit knn k nearest neighbor lstm long short term memory network mlp multi layer perceptron ng not good nn neural network rf random forest rnn recurrent neural network svm support vector machine usbl ultra short baseline xgboost extreme gradient boosting symbols a t attention matrix a t t attention c inter representation d input sequence d data in input sequence d backward input sequence d forward input sequence d i n p u t input data matrix g feature g r a d task gradient h encoder hidden state h backward hidden state of gru h forward hidden state of gru l loss l proportion of loss relative to initialization l 1 cross entropy loss l 2 global loss l 3 local loss l 4 sparsity loss l g r a d loss gradient n number of monitoring variables o backward score in data attention mechanism o forward score in data attention mechanism p prediction r task optimization degree s decoder hidden state s monitoring window length s a spatial attention w socre in spatial attention mechanism w e i g h t weight matrix x number of features for each sample y true value y ˆ estimated value α weight in spatial attention mechanism β backward weight in data attention mechanism β forward weight in data attention mechanism γ optimization coefficient λ penalty coefficient of sparse term in oscarmax ϕ historical data ω constraint in oscarmax ω learnable parameter 1 introduction autonomous underwater vehicle auv works in the complex ocean environment as the mission becomes more complicated and longer security is one of the most important issues in its operation brito et al 2010 fault diagnosis is one of the basic technologies to ensure the safety of auv therefore research of fault diagnosis technology is of great significance to improve the safety and reliability of auv xiang et al 2017 in general the fault detection and diagnosis approach for auv can be classified into two types data driven and model driven chu et al 2020 model driven algorithms require the modeling of diagnostic objects a common strategy is to rely entirely on empirical knowledge such as fault tree analysis tan 2005 however empirical knowledge is difficult to describe the actual object completely so a scheme combining data for modeling emerged pugi et al 2018 accurately designs the response model of the propeller and then a redundant and reconfigurable propulsion system is proposed to improve the motion ability of the underwater vehicle qiao and zhang 2017 proposed an adaptive non singular integral terminal sliding mode control scheme for trajectory tracking of autonomous underwater vehicles with dynamic uncertainties and time varying external disturbances qing et al 2018 proposed a robust optimal sliding mode control approach based on a linear quadratic regulator model the auv in a vertical plane meng et al 2020 designed the sliding mode observers and applied it to fault reconstruction of underwater thrusters fault detection correctness depends on model accuracy due to the data noise external interference and other factors an accurate model is difficult to obtain chi et al 2020 in addition the model driven approach requires the modeling of diagnostic objects which limits the generality of the method when the diagnostic object is a complex system it will become a difficult task to model the diagnostic object and the accuracy of the established model is difficult to meet the diagnostic accuracy the data driven methods do not require modeling diagnostic object which makes the data driven methods highly general guo et al 2019 extracts the features of auv monitoring data to detect the fault of resource exploration system qin et al 2019 employed neural network nn to estimate and compensate the general disturbances consisting of model uncertainties external disturbances and thruster faults machine learning is a typical data driven method which is widely used as a solution to fault diagnosis and has achieved good results in this field researchers have actively explored the application of different machine learning algorithms in different fault diagnosis scenarios such as support vector machine svm ming jun et al 2014 random forest rf liu et al 2019 extreme gradient boosting xgboost zhang et al 2018 k nearest neighbor knn sarmadi and karamodin 2020 and other algorithms with the increasing complexity of auv and missions fault diagnosis methods are faced with larger data volume more data types and more complex data relationships recent deep learning algorithms have demonstrated promising results yielded significant diagnostic accuracy yan et al 2020 qin et al 2018 proposed a fault diagnosis method based on a predictive model using the long short term memory network lstm the trained network can be used to establish the motion model of auv by fitting the sensor system lin et al 2019 proposed a recurrent neural network rnn with convolution to improve the autonomous ability and intelligence of obstacle avoidance planning montazeri et al 2014 applied multi layer perceptron mlp and adaline to design the adaptive filter which estimates the state of the plant in each sample time sans muntadas et al 2019 used a convolutional neural network cnn to create an end to end solution from an image to a control signal however the above fault diagnosis methods do not deal well with the time dynamic and strong correlation characteristics in auv data in fault diagnosis methods for auv more attention is paid to fault detection and less attention is paid to fault identification in the above cited deep learning methods fault identification is not involved qin et al 2018 lin et al 2019 montazeri et al 2014 sans muntadas et al 2019 for auvs underwater missions are time consuming and expensive in fault modes such as sensor interference auv can continue to perform the mission in other failure modes such as propeller damage auv must terminate the mission immediately and float up to reduce the loss therefore fault identification is essential for auv to perform missions efficiently zhang et al 2015 raanan et al 2018 applied an online bayesian nonparametric topic modeling technique to auv sensor data then used a nearest neighbor classifier for fault detection and diagnosis their results showed that the proposed method can accurately identify and characterize patterns that correspond to various states of the auv liu et al 2017 proposed an auv thruster fault identification method based on fractal feature and multiresolution wavelet decomposition fault identification is realized by establishing a fault sample library of fractal features however it is difficult to identify fault because of black box internal structures of deep learning network doshi velez and kim 2017 in order to identify fault in a deep learning network we develop a spatial attention mechanism to capture the semantic relationship in this study a deep learning method is proposed for fault diagnosis including fault detection and fault identification for fault detection in order to reduce the impact of the strong coupling relationship between systems a data attention mechanism is proposed which introduces dynamic weighting coefficients of monitoring variables to realize dynamic data decorrelation then automatic feature engineering is realized by using a bi directional gru bigru network to acquire the features of monitoring variables finally we use mlp to implement fault detection for fault identification we embed a spatial attention mechanism in the fault detection network to capture the semantic relationship between monitoring variables and faults in order to improve the identification accuracy weight initialization and sparse activation function are used to improve the spatial attention mechanism base on the above we present a new loss function and training strategy to balance fault detection and fault identification tasks a fault diagnosis method based on deep learning and attention mechanism is proposed and applied to qianlong 2 auv the main innovative research works of this paper includes 1 for fault detection we develop a data attention mechanism to decorrelate data dynamically and take advantage of the strong coupling relationship between qianlong 2 auv systems 2 for fault identification we develop a spatial attention mechanism to capture the semantic relationship between monitoring variables and faults and fault identification result can be obtained by parsing this semantic relationship 3 in order to realize fault detection and fault identification in the same network we propose a new loss function and a new training strategy for the cooperation between the two tasks the remainder of this paper is outlined as follows section 2 describes qianlong 2 auv analyzes the data and fault mode section 3 presents a deep learning method based on attention mechanism for fault diagnosis including fault detection fault identification and training strategy section 4 provides the experimental results on qianlong 2 auv to demonstrate the performance of proposed methods section 5 presents a brief conclusion for this paper 2 qianlong 2 auv the qianlong 2 auv is a 4500 m class auv which is 3 5 m long 1 5 m high and weighs 1 5 tones it has a biomimetic appearance that looks like a small yellow fish as shown in fig 1 the qianlong 2 auv is equipped with four main propellers mounted on the steering gears and a lateral auxiliary thruster which makes the vehicle more flexible in performing exploration tasks for submarine resources xu et al 2019 qianlong 2 auv integrates motion system resource exploration system communication system etc each system includes a large number of equipment and sensors the coupling relationship between system equipment and sensors is complex therefore the action of auv will affect multiple monitoring variables at the same time and the monitoring data of the navigation process has strong correlation characteristics fig 1 shows the physical location of some hardware devices fig 2 shows the system architecture and data interaction among data acquisition daq system control system and execution system daq system interacts with control system through data bus and control command is transmitted to execution system through control bus daq system includes resource exploration system vehicle sensing system navigation sensing system and other parts the specific functions of each sensor are shown in the data acquisition system in fig 2 some sensors set available for the qianlong 2 auv includes inertial measurement unit imu ultra short baseline usbl electromagnetic compass ec electrical measurement em depth measuring device dm global positioning system gps doppler velocity log dvl conductivity temperature depth measuring system ctd in order to ensure the normal operation of daq system and enhance the availability of data we have carried out preliminary processing on the original monitoring data the preliminary processing initiates with the form handling of data data is tabulated in the appropriate form for the next steps of the methodology next the data are synchronized using linear interpolation cheliotis et al 2019 it is an especially important process when using similarity based imputation approaches as the daq sensors do not have exactly the same sampling rate we select 55 monitoring variables are selected for fault diagnosis under the guidance of experts and list all the monitoring variables in table 1 v1 v32 and v48 v55 are the direct measurements of sensors v34 v41 are the attitude variables after the measurements are processed v47 is the navigation variable after the measurements are processed and v42 v46 are the control variables as for the vehicle variables taking v34 as an example it is a high confidence altitude combined with v5 v33 hydrological conditions during navigation and sensor drift interference the fault of qianlong 2 auv inevitably involves multiple monitoring variables such as the fault motor stalling which involves motion monitoring variables motion control variables and posture variables moreover in some cases the fault will not appear alone such as motor stalling and battery abnormal these two faults often occur at the same time motor stalling will cause battery abnormal and battery abnormal can also cause motor stalling it is difficult to accurately analyze the initial cause of the fault in this study we use the monitoring data of auv to diagnose the fault table 2 lists several faults direct and related variables of qianlong 2 auv such as the fault bow left motor stall direct variables are bow left motor speed and bow left motor speed setting related variables are other motor speed speed setting and posture variables 3 proposed method a deep learning method based on attention mechanism is proposed for fault diagnosis with application in qianlong 2 auv the execution flow of the proposed method is shown in fig 3 the method is divided into offline modeling and online diagnosis the execution steps of the method are as follows offline modeling step 1 get historical data and divide historical data into input data and label data step 2 use data attention mechanism for decorrelating data dynamically step 3 use bigru for automatic feature engineering and data feature coding step 4 use spatial attention mechanism for capturing the semantic relationship between monitoring variables and faults implement fault identification by parsing semantic relationships step 5 use mlp for fault detection from features step 6 use historical input data and label train the diagnosis model online diagnosis step 1 embed the diagnosis model into auv system step 2 get real time data stream step 3 use trained model to obtain the fault detection and fault diagnosis results 3 1 fault detection as shown in fig 4 the fault detection algorithm consists of a bigru network for feature coding a data attention mechanism for data decorrelation and an mlp to detect fault from features we use a gru network cho et al 2014 to implement automatic feature engineering in automatic feature engineering gru reads input sample as eq 1 into a fixed length representation vector c d is the data matrix where t is the length of a data sample and n is the number of monitoring variables d t is the relevant information of the monitoring variable sequence at time t as eq 2 1 d input d 1 d t 1 d t d t 1 d t r n t 2 d t d t 1 d t 2 d t n t r n since it encodes the input series of each time step in an orderly manner the hidden state is constantly updated according to the following equation 3 h t g h t 1 d t where g represents a gru h t r n is a hidden state at time t and n denotes the number of hidden nodes after gru reads the end of the input sequence d t the last hidden state will be the summary c of the whole input sample d input c h t one disadvantage of traditional gru is that it only reads temporal information in a single direction the strong time correlation of auv data shows that whether the temporal information is fully utilized determines the fault diagnosis ability of the algorithm there is no reason not to use bidirectional temporal information to overcome the limitations of the regular grus the bidirectional gru network schuster and paliwal 2002 is employed to process the input information in the forward and backward directions as shown in fig 5 in the bigru network gru reads the forward and the backward temporal information at the same time to calculate the forward and the backward hiding state similar to eq 3 the bigru network calculates the hidden state according to eq 4 4 h t g t h t 1 d t h t g t h t 1 d t each input sequence d input is represented by connecting the hidden state of the forward gru and the hidden state of the backward gru as eq 5 which summarizes the previous and future information of d input 5 h t h t t h t t t because of the coupling relationship between auv systems equipment and sensors there is a strong correlation among auv monitoring variables we propose a data attention mechanism to emphasize the correlation between different monitoring variables the basic principle is to obtain the general correlation between variables through learning and use this general correlation to decorrelate the monitoring variables the dry data with no general correlation or residual correlation the difference between the sample correlation and the general correlation will be highlighted which will help us to carry out fault detection in monitoring variable time series the weight is adaptively assigned to each monitoring variable refer to the historical data set φ t τ historical data set φ t τ records the values of n monitoring variables in the past τ time step denoted as 6 φ t τ ϕ t 1 ϕ t 2 ϕ t n r τ n in which 7 ϕ t j d t 1 j d t 2 j d t τ j t r τ represents the previous time series corresponding to the monitoring variable j next multiply the value corresponding to each monitoring variable by its weight affected by the bidirectional gru network the input sequence d t is the sum of the forward input sequence d t and the backward input sequence d t as eq 8 8 d t d t d t r n the forward and backward input sequences are calculated as follows 9 d t β t 1 d t 1 β t 2 d t 2 β t n d t n t d t β t 1 d t 1 β t 2 d t 2 β t n d t n t where β t j and β t j represent weights of monitoring variable j in the forward and backward directions and can be respectively computed as follows 10 β t j exp o t j k 1 n exp o t j β t j exp o t j k 1 n exp o t j in which 11 o t j s c o r e h t 1 ϕ t j o t j s c o r e h t 1 ϕ t j are built by the soft attention model s c o r e the proposed data attention mechanism is calculated by considering the hidden states and the previous time series of each variable the weights obtained by data attention mechanisms reflect the dynamic data correlation between different monitoring variables across t time steps we use mlp montazeri et al 2014 to detect fault from features the basic unit of the mlp network is the perceptron which is the basis of neural network technology it has the ability of linear non linear fitting prediction the mlp developed by it has the ability of universal approximation the task is to complete the final classification through attention distribution and features 3 2 fault identification as shown in fig 6 the fault identification algorithm includes a spatial attention mechanism to capture the semantics relationship between monitoring variables and faults an attention parsing and visualization method to analyze the semantics relationship and optimization methods for spatial attention mechanism in order to model the semantic relationship between monitoring variables and faults we use a spatial attention mechanism and then we can obtain fault identification in the fault detection algorithm we extract the features of auv data and detect fault mode by the data features in the fault identification algorithm the features of auv data are processed by spatial attention mechanism to get a new inter representation c the new inter representation c depends on the representation sequence h which contains the information of the entire input sequence the weighted sum of these representations can be calculated as follow 12 c t k 1 n α t k h t k in which the subscript t is the diagnosis time α is the weight which is a probability that the variable k is aligned with the fault detection result it is computed as follow 13 α t k exp w t k k 1 n exp w t k being similar to data attention mechanism the attention mechanism w t k is calculated by 14 w t k s c o r e s h t k where s is the decoder hidden state in the fault diagnosis algorithm s is a scalar because the target sequence has only g good or ng not good two states and the length is one the output of spatial attention mechanism to each monitoring window d t is an attention distribution vector as eq 15 15 α t α t 1 α t 2 α t n the output is an attention distribution matrix for the whole auv data d input as eq 16 16 α α 1 t α 2 t α t t t for fault identification spatial attention which can provide support is expected but after the establishment of the model the attention distribution matrix is not well interpretable for engineers to solve this problem various methods are used to optimize spatial attention to ensure that attention is suitable for fault identification we improve spatial attention mechanism by weight initialization method and sparse activation function some experiments on a simple data set of 10 10 are carried out for illustration and fig 7 shows the visualization results of different attention distribution matrices fig 7 a shows that the attention distribution vectors on ng samples are discrete while the attention on g samples are almost uniform fig 7 b shows that the attention distribution vectors on g samples are discrete fig 7 c shows that the attention distribution vectors on all samples are discrete it is reasonable that the attention distribution vectors are discrete on g or ng samples according to the theory of attention mechanism the former can be interpreted as these variables can predict this sample as label g and the latter can be interpreted as those variables can predict that sample as label ng but considering the requirement for fault identification we pay more attention to the samples with label ng and think that the situation like a and c is expected and the situation like b is of no value we observe the s c o r e output of some samples with uniform attention distribution and find the output is all close to 0 this means that attention is independent of features which is unacceptable the initial algorithm uses the random method to initialize the network weight and we use the xavier initialization method to initialize xavier initialization is an initialization method proposed by glorot and bengio 2010 to solve the problem of random initialization as shown in formula 17 17 weight u 6 n j n j 1 6 n j n j 1 p x j p y j where weight is the weight matrix u is the uniform distribution j is the network layer number x j is the layer input y j is the layer output that weight obeys u makes x j and y j obey the same distribution the principle of this method is to make the input and output obey the same distribution as much as possible in spatial attention mechanism the input is features extracted by bigru which must not be uniformly distributed using the xavier initialization method we can avoid the uniform distribution of the output in fig 7 c the attention distribution vector is not sparse that is the algorithm thinks that almost all variables and fault labels are related this result is a lack of value the algorithm uses softmax as the activation function of attention mechanism such as eq 10 softmax maps the input into the 0 1 interval linearly and makes the sum of outputs 1 the sparse activation function can control that the attention distribution vector of each sample is sparse which makes the algorithm find out the variables with higher importance we use oscarmax proposed by niculae and blondel 2017 as the activation function it encourages variables with the same attention to merge into clusters regardless of position in the sequence which results in mapping as eq 18 18 ω 1 2 y 2 2 λ i j max y i y j where the right part is the sparse term λ is the penalty coefficient of sparse term the larger λ is the more sparse ω is i and j are the position number fig 7 c and d show the difference in attention distribution when softmax and oscarmax are used as activation functions using oscarmax instead of softmax can achieve the sparse distribution vector 3 3 training strategy in order to optimize spatial attention it is necessary to describe the attention quantitatively based on the attention distribution vector and matrix we define three indexes to quantify attention to quantify the global performance of attention that is the ability to identify the overall fault by attention distribution matrix we propose g l o b a l the fault of time adjacent samples should be similar from a global perspective the attention distribution of samples should be gradual we use the similarity between adjacent samples to quantify the global performance of attention to quantify the attention performance of each sample that is the ability to identify fault of each sample by attention distribution vector we propose l o c a l the attention distribution of a sample should be discrete we use the discrete degree of the attention distribution vector to quantify the attention performance of each sample to quantify the sparsity of attention we use s p a r s i t y attention should be concentrated on several variables even if all variables are affected by the fault the algorithm should be able to find the most relevant variable for fault identification we pay more attention to samples with label ng so the calculation of attention indexes focuses on ng samples ignores g samples the useful attention to fault identification should be that the distribution vectors of adjacent samples have high similarity the distribution vectors of samples are discrete and sparse the calculation method of index g l o b a l refer to eq 19 19 g l o b a l i 2 m dist a t i a t i 1 p i p i 1 i 2 m p i p i 1 where i is the sample number m is the total number of samples at is the attention distribution vector of a sample dist is the distance between two vectors and p is the predicted result of the sample take 1 for ng and 0 for g the calculation method of index l o c a l refer to eq 20 20 l o c a l i 1 m σ a t i p i i 1 m p i where σ at is the standard deviation of at the calculation method of index s p a r s i t y refer to eq 21 21 s p a r s i t y i 1 m g θ a t i p i i 1 m p i where g θ is the number of elements greater than θ in the vector θ is the attention threshold of the variable in the fault diagnosis of qianlong 2 auv engineers think that when θ is about 20 the fault identification result is the best these three attention indexes are helpful to quantitatively compare the attention distribution matrix the useful attention distribution should be low g l o b a l high l o c a l and low s p a r s i t y fig 7 a b and c are the attention distribution matrix of multiple runs of the same data which show that the algorithm is not consistent when running multiple times moreover the algorithm does not learn in the direction of enhancing the ability of fault identification we add the attention indexes to the loss function to control the model learning along the direction of fault identification ability enhancement we have three attention indexes g l o b a l l o c a l and s p a r s i t y we use these indexes to calculate the g l o b a l term l o c a l term and s p a r s i t y term of the loss function with the cross entropy loss function to optimize the detection capability there are four loss function terms as fig 8 22 l 1 y log y ˆ 1 y log 1 y ˆ 23 l 2 g l o b a l l 3 l o c a l l 4 s p a r s i t y fig 9 illustrates the cooperation relationship between fault identification algorithm and fault detection algorithm spatial attention mechanism reads features of decorrelation auv data processed by data attention mechanism output spatial attention to mlp to help detect faults output spatial attention to the attention parsing module to realize fault identification the fault detection task has the detection loss function and the fault identification task has the attention loss function these two tasks cooperate to get the training gradient which is learned by all learnable networks the optimization of the four loss terms is mutual restriction and influence attention loss will affect the convergence of detection loss function and fault identification task will affect the learning rate and performance of fault detection task in order to solve the problem of mutual restriction caused by multi tasks and multi loss multi task learning mtl is used to balance different loss and tasks loss function of multi tasks refer to eq 24 24 l t ω i t l i t chen et al 2018 proposed gradnorm a multi task balancing method gradnorm s solution is to use ω i as a learnable parameter the idea of gradnorm is that without considering the learning rate the gradient of each task should be close to the average value as far as possible so that the learning rate of the task with insufficient learning can be increased the gradient of t a s k i at time t 25 g r a d i t ω i t l i t 2 average gradient of all tasks 26 g r a d i t e t a s k g r a d i t the proportion of loss relative to initialization is defined as optimization degree 27 l i t l i t l i 0 a ratio value is defined to measure the optimization degree of t a s k i relative to all tasks the higher the value the less optimization degree relative to other tasks 28 r i t l i t e t a s k l i t finally a loss function is defined as optimization objective function of ω i 29 l g r a d t ω i t i g i t g i t r i t γ 1 we initialize ω i to 1 which is ω i 0 1 we take γ as 1 5 refer to chen et al 2018 the overall network structure is shown in fig 10 4 experiments in order to verify the effectiveness of this new fault diagnosis algorithm in this section the monitoring data of qianlong 2 auv obtained during the mission in the south china sea are used to verify the proposed method during the sea trial dm interference fault motor stall fault motor speed feedback error fault ctd not on fault battery voltage fault and other faults occurred the purpose of this experiment is to detect these faults and provide fault correlation variables so as to identify faults it should be noted that although the experiment is based on historical data offline the data collected are real therefore the proposed scheme can be transplanted to qianlong 2 auv for online detection we selected three segments of real data and one segment of simulation data three segments of real data are segment 1 segment 2 and segment 3 with the label of g ng a segment of simulated data is segment 4 it is obtained by adding simulated faults based on real fault free data with g ng labels and marked fault variables data collection of monitoring variables is carried out every second in this experiment the data are preprocessed by the method of standardization and sliding window the length of the sliding window is 60 and the step is 5 in this paper the proposed fault diagnosis method based on attention mechanism is referred to as am fd 4 1 performance of fault detection we compare the detection performance of am fd simulation online diagnosis with the offline diagnosis results of traditional fault detection methods svm rf knn lstm mlp and cnn fault detection rate fdr false alarm rate far and f1 are used to measure the fault detection ability fdr is the correct classification rate of the sample labeled ng while far is the wrong classification rate of another sample f1 is called balanced score which is defined as the harmonic mean of fdr and recall rate 1 far table 3 shows the performance of am fd and different fault detection methods for these four segments in the table bold values are the best of all methods am fd can get the best performance in most cases f1 is always the best fdr and far are sometimes slightly worse than other algorithms am fd processes the strong coupling relationship between systems by the data attention mechanism making better use of the correlation information among variables the bigru network was used for data feature coding including forward and backward temporal information semantic relationships among variables and faults are derived by a spatial attention mechanism that not only serves to parse for identification results but also coordinates features for fault detection by mlp am fd svm mlp and cnn are implemented through tensorflow cpu version with the same training parameters svm rf and knn are implemented by sk learn machine learning library the training parameters and structure parameters of all algorithms are shown in table 4 other parameters use the default parameters of the library in the experiment we ensure that the proposed algorithm has the same training parameters and similar structure with other algorithms so as to test the general superiority of the proposed algorithm we also give the test time of each algorithm here under the same training parameters the test time of am fd is higher than that of other deep learning algorithms but the sample diagnosis time is still much less than the sampling period in addition it must be pointed out that only the am fd algorithm proposed can identify fault for all samples and a single sample rf and other classification and regression tree algorithms can only provide the importance for variables of all samples 4 2 verification of fault identification am fd can mark the important variables related to the fault through attention distribution and the specific fault can be identified from the important variables because the real data does not contain specific fault labels and does not mark fault variables in order to verify the fault identification results of am fd on qianlong 2 auv we add simulated faults to the real fault free data the experiment of am fd on the simulation data segment 4 it is obtained by adding simulated faults on the basis of real fault free data including dm interference bow left motor stall bow left motor speed feedback error ctd not on and battery voltage reduction the simulated added fault cannot simulate the strong correlation of multi variables in the actual fault so we only change the direct variables of the fault the significance of the simulation experiment is to verify that am fd can find the direct fault variables fig 11 a shows the fault addition in this experiment we add 5 faults with g ng labels and marked fault variables to the real fault free data fig 11 b is the attention matrix visualization of the output of spatial attention mechanism in am fd it is obvious that attention is divided into five time periods which coincides with figure a figure b shows the variables that the method focuses on for each fault sample fig 12 is the bar charts of cumulative attention distribution of the five faults on each variable from which we can clearly see the attention on specific variables the red variables are the direct variables for this fault shown in table 2 am fd marks the direct variables and related variables in each fault section it can also be seen from fig 12 that v41 has high attention in different faults the variable v41 is the target value of auv speed almost all auv faults are related to this variable as can be seen from a variables that am fd pays the most attention to in the dm interference fault section are v4 and v5 which is consistent with adding fault variables manually in other words through the visualization of the attention distribution matrix it can be found that fault variables of the first fault period are v4 and v5 from which it can be inferred that the dm interference fault occurred in this period and fault identification is realized table 5 shows the recognition rate of several fault variables by am fd only the variables listed in table 5 are considered and the fault can be accurately identified in most cases combined with figs 10 and 11 for fault identification a better recognition effect can be obtained the lowest recognition rate is 0 845 for v4 in the first fault period combined with figs 11 b and 12 b it is still easy to analyze the occurrence of dm interference fault in this period without confusion it can be seen from sections 4 1 and 4 2 that am fd completes the fault diagnosis task well and effectively balances the two subtasks of fault detection and fault identification the application of am fd in qianlong 2 auv can improve the reliability and safety of navigation 5 conclusion in this paper a deep learning fault diagnosis method based on attention mechanism is proposed which is applied to qianlong 2 auv experimental results on qianlong 2 auv during the mission in the south china sea verify the effectiveness of the proposed method which can detect and identify the faults that occurred during the mission and improve the reliability effectively we will optimize the algorithm implementation to reduce the time cost of the proposed method this work can also be extended to other auvs firstly the navigation data of another auv is analyzed to adjust the network structure parameters of the algorithm then the auv data is used for training this network finally by integrating the algorithm into the auv online fault diagnosis can be realized however because proposed method is a supervised deep learning method it will not take effect without learning enough data with label in future research we will try to develop semi supervised fault diagnosis methods for auv credit authorship contribution statement shaoxuan xia software validation writing original draft writing review editing xiaofeng zhou term conceptualization supervision project administration funding acquisition haibo shi resources supervision shuai li writing review editing visualization investigation chunhui xu validation data curation investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this project is supported by nation key r d program of china 2018yfc0308205 
20629,an improved interpolating element free galerkin iiefg method coupled with modified dirichlet to neumann mdtn boundary condition is presented in this paper for use in computing underwater acoustic radiation in the scheme of the iiefg mdtn approach the improved interpolating moving least square technology is employed to construct the shape function with the aim of improving the interpolation accuracy and the mdtn boundary condition is used to meet the sommerfeld radiation condition required at infinity and remove the difficulties arisen as the truncated dtn boundary condition is employed in computation it is the key feature of this weak form meshfree method that no connectivity of nodes or mesh is required for acoustic field variable interpolations while the prediction accuracy is significantly improved the factors including the size of the influence domain shape parameters and the number of terms used in the mdtn map which affect the performance of this proposed method are studied numerically typical numerical examples are presented to test the properties of the iiefg mdtn approach the results indicate the devised method is outstanding to cope with underwater acoustic radiation prediction and can achieve higher accuracy and faster convergency compared to the finite element method graphical abstract keywords weak form meshfree underwater acoustic radiation 1 introduction underwater acoustic problems have been a quite active research field in recent decades however many of them cannot be analytically solved therefore various numerical approaches or technologies have been devised for solving the underwater acoustic problems with complex geometry shape boundary element method bem and finite element method fem are still two dominant numerical methods in computing underwater acoustic radiation bem that employs the free space green s function as the fundamental solution and automatically satisfies the sommerfeld radiation condition is an effective tool for solving the acoustic problems in unbounded domain in bem a boundary discretization is only required thus a d 1 dimensional problem is obtained compared to the original d dimensional one ciskowski and brebbia 2005 thompson 2006 kirkup 2007 liu et al 2017 however because the fundamental solution is nonlocal support the system matrices are non symmetric and non sparse which significantly increases the storage requirement and the processing time kirkup 2007 as a result the computational advantage acquired by dimension reduction is offset to the yielded matrices in addition there is non uniqueness problem i e standard bem fails at the critical frequencies as the weak singular boundary integrals occur kirkup 2007 liu et al 2017 wu 2000 marburg and nolte 2008 to ensure the uniqueness the burton miller and the combined helmholtz integral equation formulation chief approaches have been devised to remove the difficulty kirkup 2007 thompson 2006 wu 2000 marburg 2016 in the burton miller approach the original integral formulations are modified with their normal derivatives to theoretically preclude the non unique solutions marburg 2016 but the introduced various orders of singular integrals corresponding to green s function have to be mathematically treated with high computational cost in the chief approach the additional integral formulations make solutions vanish at these chief points and are combined with the original ones thus the fictitious results can be eliminated from the true ones however how to effectively determine the limit of stability and appropriately select chief points is still a challenge in this approach thompson 2006 the application of the acoustic bem is significantly moved owing to great progresses in the development of bem achieved during the past few decades marburg 2018 for example the computational cost is dramatically reduced with the use of the fast multipole bem gong et al 2017 a more detailed discussion of bem can be found in the kirkup 2019 the acoustic bem is still in the process of being improved fem that is a general purpose computational tool has been an effective approach for large problems because of sparse discretized system equations and is being increasingly employed for acoustic problems ihlenburg 1998 kaltenbacher 2018 however exterior acoustic problems in the unbounded domain cannot be directly solved with the use of standard fem special techniques have to be required standard fem remains two crucial challenges thompson 2006 chai et al 2016a the first one is how to deal with unbounded domain and meet the sommerfeld radiation condition at infinity to ensure acoustic wave travelling outward how to diminish the so called numerical dispersion error that increases dramatically with acoustic wave number is the second challenge first of all in acoustic fem unbounded domain must be truncated with artificial boundary in order to obtain a finite computational domain then the required non reflecting boundary condition including dirichlet to neumann dtn boundary condition perfectly matched layer infinite element techniques and absorbing boundary condition needs to be applied on the artificial boundary to ensure that all the acoustic waves travel outward without spurious reflection from the artificial boundary thompson 2006 ihlenburg 1998 xu et al 2017 bhuddi et al 2015 in two dimensional exterior acoustic problems the mapped infinite elements with r 1 2 decay have been proposed to correct decay of outgoing waves and the corresponding numerical integration scheme is devised zienkiewicz et al 1985 an advantage of employing these improved mapped infinite elements is that the artificial movement of the origin is not required compared to the infinite elements with exponential decay and any damper element much more accurate solutions can be produced using these types of infinite elements how to accurately achieve oscillating wave solutions at high wave number is a crucial difficulty for fem hu et al 2017 xu et al 2019 compared to the original model the stiffness of the discretized model in standard fem always behaves stiffer thus refining mesh is not an effective way to diminish the numerical dispersion error liu and zhang 2013 to handle this issue in recent years some novel approaches based on the smoothing techniques or meshfree approaches have been proposed to soften the overly stiff property of the fe model in advanced fem field a novel weakened weakform based on g space theory is devised to deal with the partial differential equations in solid mechanics problems liu and zhang 2013 several excellent approaches that are based on the gradient smoothing techniques and the w2 form have been proposed for acoustic problems and solid mechanics such as the hybrid smoothed finite element method hs fem chai et al 2016a b the meshfree cell based smoothed alpha radial point interpolation method cs α rpim liu et al 2013 the edge based smoothed finite element method es fem li et al 2017 the stable node based smoothed finite element method sns fem chai et al 2016c and the superconvergent alpha finite element method chai et al 2017 thus a properly softened system stiffness can be obtained with the help of these approaches or techniques consequently numerical accuracy is significantly improved dtn boundary condition is an exact nonlocal boundary condition ihlenburg 1998 keller and givoli 1989 in which the dirichlet datum is related to the neumann datum through the integral operator it has been shown that compared to the local non reflecting boundary conditions the nonlocal boundary condition is more useful in many situations a detailed comparison between the nonlocal and local boundary conditions can be found in the givoli and patlashenko 1998 however the infinite series in the formulation of the boundary condition is truncated after a finite number of terms for use in computation leading to the infinite real eigenvalues of the exterior acoustic problem grote and keller 1995 giljohann and bittner 1998 hsiao et al 2011 geng et al 2017 as a consequence the problem will have no solution or an non unique one when the square of the wave number is such an eigenvalue therefore the truncated dtn condition is no longer exact although the effect of the eigenvalues can be removed by employing enough terms a very large number of terms that may include much more terms than actually be necessary to achieve desired accuracy is required when high acoustic wave number is encountered or large radius of the artificial boundary is employed grote and keller 1995 giljohann and bittner 1998 li and yuan 2020 which results in a large overhead in computation to eliminate the difficulties that arise when the dtn condition is truncated a modified dtn mdtn boundary condition is proposed which is determined based on the dtn map by adding a local differential operator and simultaneously subtracting the contribution of the operator from the standard dtn map grote and keller 1995 this modified version is exact for low modes included in the kernel of the integral operator and an approximate non reflecting boundary condition is induced by the local operator for high modes not included in the kernel oberai et al 1998 koyama 2009 a key property of the modified version is that for any number of terms included the solution of the resulting problem is unique oberai et al 1998 furthermore compared to the standard truncated version an advantage of the modified version is that better accuracy can be achieved using small values of the number of the terms grote and keller 1995 since it is not known in advance how many terms must be included to achieve a desired accuracy the mdtn boundary condition has been employed in practical computation grote and kirsch 2004 and used to resolve other problems ofir and givoli 2015 in the field of numerical simulations meshfree methods which are devised to eliminate several difficulties associated with reliance on mesh to form the variable interpolation or approximation are relatively new approaches compared with mesh based methods liu and gu 2005 in recent years meshfree methods have gained significant popularity and major successes have been obtained in employing these approaches for treating certain challenging numerical and engineering problems in meshfree methods problem domain and its boundary are represented with the use of arbitrarily distributed nodes a set of nodes inside the support domain of the calculating point are selected to construct the shape functions connectivity of nodes or mesh is not used for variable interpolation or approximation liu and gu 2005 therefore the performance of the meshfree methods is almost not influenced by the irregularity of the nodes according to the formulation procedures liu and gu 2005 meshfree methods generally fall into three categories meshfree strong form methods such as the meshfree collocation method abbasbandy et al 2012 dehghan and shokri 2008 meshfree weak form methods such as the element free galerkin efg method belytschko et al 1994 1995 peng et al 2011 zhang et al 2013 and meshfree weak strong mws form methods liu and gu 2004 liu et al 2004 gu and liu 2005 the radial basis function rbf method the moving least squares approximation mlsa and the partition of unity method are commonly employed in meshfree methods to construct the shape functions liu and gu 2005 meshfree strong form methods are truly meshfree approaches mesh is not required for both the variable interpolation or approximation and numerical integration simple algorithm and computational efficiency are key advantages of these methods but it has been shown that these methods are often inaccurate unstable and not robust for the kinds of problems with derivative boundary conditions liu and gu 2005 meshfree weak form methods in which sets of global or local background cells are employed for numerical integration and a weaker consistency on the approximate function is required can usually generate a much stabler set of discretized system equations and give much better accuracy compared to the strong form ones liu and gu 2005 efg method that has higher accuracy and convergency than fem which employs mlsa to construct the shape function in the global galerkin weak form lancaster and salkauskas 1981 belytschko et al 1994 has been successfully and widely applied to a lot of problems such as plate and shell structure problems linear and nonlinear elastic problems electromagnetic field problems fracture and crack growth problems and so on liu and gu 2005 due to the use of galerkin formulation to yield well behaved and stable discretized global system equations and the use of mlsa to achieve excellent stability in shape function construction belytschko et al 1996 because the mlsa shape function does not possess the kronecker delta function property the essential boundary conditions cannot be enforced as directly and easily as in standard fem based on mlsa the interpolating moving least squares imls method is established with the use of singular weight functions lancaster and salkauskas 1981 the imls shape function satisfies the property of the kronecker delta function thus the essential boundary conditions can be directly enforced however the weight functions used in imls method are singular at nodes sun et al 2013 some difficulties are caused to calculate the derivatives of the approximation functions as a result inverse operation of the singular matrix is significantly complicated several methods have been devised to remove the drawbacks in imls method cai et al 2010 sun et al 2013 zhuang et al 2014 amiri et al 2014 among these methods an outstanding method is the improved interpolating moving least squares iimls method sun et al 2013 the iimls shape function possesses the property of the kronecker delta function with the use of nonsingular weight function employed in mlsa in addition less unknown coefficients in the trial function of iimls method need to solved compared to mlsa consequently the shape function can be formed using fewer nodes it has been indicated that improved interpolating efg iiefg method that employs iimls method to construct the shape function can achieve better accuracy than efg method for the identical node distribution wu and xiang 2018 in meshfree global weak form methods global background cells have to be generated for numerical integration therefore these meshfree methods are not the pure meshfree approaches in order to avoid using global background cells a meshless local petrov galerkin mlpg method based on local weak form is developed atluri and zhu 1998 based on mlpg method some variant versions are devised liu and gu 2001a b liu et al 2002 in this local weak form numerical integration is performed over a corresponding local domain of field node only a local cell is generated without the use of global background cell the mlpg formulation is quite similar to the strong form scheme the corresponding implementation procedure is as simple as the meshfree strong form methods consequently mlpg method can be said a pure meshfree method in mlpg method the shape functions are constructed by using mlsa as in efg scheme thus special techniques are required to enforce the essential boundary conditions liu and gu 2005 it should be indicated that these advantages of local weak form methods are obtained with some cost in mlpg method additional parameters are introduced and the resulting system matrix is generally asymmetric thus the sizes of local quadrature domains and the test function must be carefully selected due to the additional parameters besides that compared to efg the mlpg method are computationally more expensive due to the non symmetric matrix liu and gu 2005 with the purpose of improving the accuracy and efficiency of solution in two dimensional elasticity and linear elastic fracture mechanics the integrated local mesh free ilmf method is developed to remove the difficulties with nodal integration oliveira et al 2019 it has been indicated that application of the ilmf method the sizes of the nodal compact support and the local integration domain of each node directly determine the accuracy and the efficiency of the model respectively oliveira et al 2019 based on genetic algorithms the two parameters can be automatically obtained using a multi objective optimization process santana et al 2020 thus the reliability and the robustness of this meshfree local method have been significantly improved besides these domain type meshfree methods boundary type meshfree methods in which only the boundaries of the problem domain are represented by a set of nodes have been developed for coping with lots of challenging issues liu and gu 2005 such as that boundary meshfree methods have been applied to solve 2d nonlinear problems in these methods the size of compact should be usually determined in advance by numerical experiments and the boundary of the problem domain cannot be automatically discretized to completely automate the discretization process of the boundary mesh free methods and optimally determine the corresponding parameters a multi objective optimization strategy that can automatically generate pareto optimal nodal arrangements and compact supports of the meshfree discretization is developed araújo et al 2021 with the help of the devised scheme the solution accuracy the stability and efficiency of this boundary meshfree method are significantly improved the meshfree local weak form methods and the boundary type meshfree methods are still in the process of being improved efg method has been applied to interior acoustic problems and can produce accurate results bouillard and suleaub 1998 suleau et al 2000 kireeva et al 2006 wenterodt and estorff 2011 shojaei et al 2016 however as any other numerical method efg method also has disadvantages because a set of distributed nodes and background cells must be generated to represent problem domain perform variable approximation and achieve integral operation which makes computation quite expensive and is even practically impossible for underwater acoustic problems with semi infinite or infinite domain efg method cannot be directly applied to these kinds of exterior acoustic problems considering the advantages of the iiefg method and the mdtn boundary condition as described previously it is great interesting to combine iiefg method with mdtn boundary condition for underwater acoustic radiation computation with the aim of making use of their advantages while evading disadvantages the present paper is outlined as follows the fundamental theory is presented in section 2 in section 3 the mdtn boundary condition is described the formulation of the present method is given in section 4 in section 5 the factors that affect the performance of this present method are studied numerically and simulations are carried out to test the performance and applicability of the iiefg mdtn method finally conclusions including future developments are given in section 6 2 underwater acoustic radiation problem in unbounded domain the acoustic pressure p x t generated by a rigid object immersed in unbounded domain v with homogeneous isotropic medium can be described as follows 1 2 p x t 1 c 2 2 p x t t 2 0 where c is sound speed in acoustic medium and 2 represents the laplace operator in time harmonic problems p x t p x e i ω t where p x represents the complex amplitude of the acoustic pressure ω denotes the angular frequency and i 2 1 thus the following helmholtz equation is obtained 2 2 p x k 2 p x 0 x v where k ω c is acoustic wavenumber assuming the surface of the radiator can be decomposed into dirichlet boundary γ d and neumann boundary γ n where γ d γ n γ and γ d γ n 0 they are given as follows 3 p p d on γ d p x n b i k ρ c v x on γ n where p d and v x represent the given pressure on γ d and the prescribed normal velocity on γ n respectively ρ is density of the medium and n b denotes the outward normal to the boundary considering wave propagation in unbounded domain the sommerfeld radiation condition should be met to ensure that all waves at infinity are outgoing described as ihlenburg 1998 kaltenbacher 2018 4 p o r β p r i k p o r β for r where r is the distance from the origin and β 1 2 and 1 for 2 dimensional and 3 dimensional cases respectively here it should be noted that p r i k p o r β when p x t p x e i ω t in general only the second expression in the above equation that is equivalent to p n i k p 0 at infinity is given ihlenburg 1998 3 the modified dirichlet to neumann boundary condition to solve this problem numerically a finite computational domain v i which is bounded internally by γ and externally by the artificial boundary γ r that is often a circle or sphere of radius r for 2 dimensional or 3 dimensional case respectively is defined as depicted in fig 1 then the boundary condition p x n m p x is imposed on γ r where the operator m that relates the dirichlet datum p to the neumann datum p n on γ r is called dirichlet to neumann dtn map thus the following equivalent problems are yielded 5 2 p x k 2 p x 0 in v i p p d on γ d p x n b i k ρ c v x on γ n p x n m p x on γ r 6 2 p x k 2 p x 0 in v o p p r θ on γ r p r i k p o r β for r here a briefing for the formulation of the dtn boundary condition is described in this section for the sake of completeness detailed discussion of the formulation is presented in the keller and givoli 1989 in two dimensions the analytical solution of eqs 6 is given in polar coordinates r θ as 7 p r θ 1 π n 0 0 2 π h n 1 k r h n 1 k r cos n θ θ p r θ d θ where p r θ represents the acoustic pressure on γ r h n 1 is the hankel function of the first kind of order n and the prime after the sum indicates that a factor of 1 2 multiples the term with n 0 then by differentiating the above equation with respect to r and setting r r the following equation can be obtained 8 p r θ n r r m p r θ n 0 0 2 π m n θ θ p r θ d θ with 9 m n θ θ k π h n 1 k r h n 1 k r cos n θ θ where the prime on the function denotes a derivative with respect to the argument kr here m n θ θ is the dtn kernel and can be expanded in the form 10 m n θ θ k π h n 1 k r h n 1 k r cos n θ cos n θ sin n θ sin n θ the infinite series in eq 8 must be approximated for use in computation by truncating the infinite series after a finite value n here m n is used to denote the truncated dtn map then eq 8 is replaced by 11 p r θ n r r m n p r θ n 0 n 0 2 π m n θ θ p r θ d θ therefore the truncated dtn boundary condition is no longer exact as mentioned previously the main drawback is that the unique solvability of the problem is ruined by the truncation when n is not sufficiently large to remove the difficulties and improve the computation accuracy the mdtn boundary condition is devised to ensure the unique solvability for all n grote and keller 1995 it is determined from the dtn map by adding and subtracting b p r θ on the right side of eq 8 simultaneously including the subtracted term in the sum and then truncating m b which is expressed as 12 p r θ n r r m m n p r θ m n b n p r θ b p r θ where m m n denotes the mdtn map and b represents a local differential operator the detailed discussion of the mdtn boundary condition is given in the grote and keller 1995 in this paper the following local differential operator is considered 13 b p r θ i k 1 2 r p r θ thus the mdtn boundary condition is yielded as 14 p r θ n r r i k 1 2 r p r θ 1 π n 0 n k h n 1 k r h n 1 k r i k 1 2 r 0 2 π cos n θ θ p r θ d θ 4 the formulation of the present meshfree method 4 1 forming the shape function in computational domain v i system equations are established by employing the iiefg method p h x is used to denote the trial function of the acoustic pressure p x applying the weighted residual formulation and the green s formula to the domain v i yields the following weak form equation 15 v i w x p h x d v k 2 v i w x p h x d v γ r w x m m n p h x d γ i k ρ c γ n w x v x d γ where w x denotes the weighting function assuming that the domain v i is represented using arbitrarily distributed nodes as seen in fig 1 the acoustic pressure at any point in v i can be interpolated by using the field node pressure the shape function of acoustic pressure that is formed using iimls is presented in this subsection from the given basis functions p 1 x 1 p 2 x p m x a set of new local basis is formed in order to make the shape function satisfy kronecker delta function property with the use of nonsingular weight functions sun et al 2013 in general complete monomial functions are most widely selected as the given bases liu and gu 2005 for a calculation or quadrature point x v i the new local basis is determined as 16 b l x x p l x i 1 n v x x i p l x i l 1 2 m where x and x i i 1 2 n denote point and field nodes respectively inside the support domain ω s of quadrature or calculating point x and v x x i is expressed as sun et al 2013 17 v x x i ζ x x i j 1 n ζ x x j with 18 ζ x x i j i x x j 2 j i x i x j 2 obviously v x i satisfies v x i x j δ i j and 19 i 1 n v x x i 1 x ω s in the meantime performing the same transformation to the acoustic pressure p x yields 20 p x x p x i 1 n v x x i p x i then based on mlsa and with the use of the new bases a local approximation of p x x can be achieved as 21 p x x l 1 m b l x x a l x where a l x l 1 2 m denote unknown coefficients substituting p 1 x 1 into eq 16 and considering eq 19 yield 22 b 1 x x 1 i 1 n v x x i 0 thus p x x can be expressed as 23 p x x l 2 m b l x x a l x from eq 23 it can be observed that less unknown coefficients are included in the trial function of the iimls method compared to mlsa consequently fewer nodes can be employed in the support domain and less order of the inverse matrix is achieved compared to the mlsa the unknown coefficients a l x l 2 3 m can be solved by minimizing the following weighted discrete l 2 norm 24 j i 1 n w x x i p x x i p x x i 2 v x p d x a x p t w x v x p d x a x p where w x x i denotes the weight function that is only available in the influence domain of field node x i v x represents an n n matrix with its row determined as 25 v t x v x x 1 v x x n and 26 p t p x 1 p x n 27 d x b 2 x x 1 b m x x 1 b 2 x x n b m x x n n m 1 28 a x t a 2 x a m x 29 w x diag w x x 1 w x x n the stationarity of j with respect to a x yields 30 j a x 2 d t x w x d x a x d t x w x e v x p 0 where e denotes an n n identity matrix then eq 30 is directly solved to obtain a x 31 a x d t x w x d x a x 1 d t x w x e v x b x p substituting eq 31 into eq 23 yields 32 p x x l 2 m b l x x a l x b t x x a 1 x b x p where b x x b 2 x x b 3 x x b m x x t from eqs 20 and 32 a global interpolating expression of the acoustic pressure p x can be written as 33 p h x i 1 n n i x p x i n t x p where the shape function vector n t x n 1 x n n x is expressed as 34 n t x v t x b t x a 1 x b x with b t x b 2 x b 3 x b m x and 35 b l x p l x i 1 n v x x i p l x i l 2 m from v x i x j δ i j b l x j satisfies that 36 b l x j p l x j i 1 n v x j x i p l x i p l x j p l x j 0 thus b t x j is determined as 37 b t x j b 2 x j b 3 x j b m x j 0 1 m 1 consequently n t x j is calculated as 38 n t x j v t x j b t x j a 1 x j b x j v t x j hence 39 n i x j v x j x i δ j i eq 39 shows that the kronecker delta function property is satisfied with the use of nonsingular weight function that is employed in mlsa as a consequence the difficulties encountered in the imls method are removed in eq 24 the weight function w x x i should possess several properties such as w x x i 0 outside the influence domain w x x i 0 within the influence domain w x x i is sufficiently smooth and w x x i monotonically decreases from the quadrature or calculating point x the cubic spline function w1 the quartic spline function w2 and the exponential function w3 are the most commonly employed which are defined as 40 w1 w x x i 2 3 4 r i 2 4 r i 3 r i 0 5 4 3 4 r i 4 r i 2 4 3 r i 3 0 5 r i 1 0 r i 1 41 w2 w x x i 1 6 r i 2 8 r i 3 3 r i 4 r i 1 0 r i 1 42 w3 w x x i e r i α r i 1 0 r i 1 where α represents a constant of the shape parameter r i x x i r w and r w denotes the radius of the influence domain ω f of a field node x i influence domain is a local domain for a field node that it has an influence upon in general the center of the influence domain is the field node if the influence domains of the nodes cover the calculating point these nodes are located in the support domain of this point and used to construct shape functions for this point as seen in fig 2 circle influence domain for 2d problem is employed for simplicity in following studies according to the suggestion liu and gu 2005 r w is determined as r w α s d where α s denotes the dimensionless size of the influence domain of the field node x i and d represents the nodal spacing near this field node in the meshfree global weak form method for a class of problems α s can be obtained by performing numerical experiments and is crucial to computational accuracy 4 2 forming the discrete system equation considering that the weighting function w x has the same form with the shape function n x in iiefg method eq 15 can be rewritten as 43 v i n x n t x p d v k 2 v i n x n t x p d v γ r n x m m n n t x p d γ i k ρ c γ n n x v x d γ then the discretized version of eq 43 can be obtained in the following matrix form 44 k k 2 m k b p f with 45 k i j v i n i x n j x d v 46 m i j v i n i x n j x d v 47 f i i k ρ c γ n n i x v x d γ 48 k i j b γ r n i x m m n n j x d γ i k 1 2 r γ r n i x n j x d γ n 0 n γ n γ r n i x c n x d γ γ r n j x c n t x d γ where the indexes of nodes i and j in above equations are based on the global numbering system p denotes the vector of the acoustic pressure values to be solved and 49 γ n 1 π r k h n 1 k r h n 1 k r i k 1 2 r 50 c n x cos n θ sin n θ it can be observed that the effect of the mdtn map on the standard meshfree formulation is the inclusion of k b in eq 44 note that k i j 0 and m i j 0 only when the nodes i and j simultaneously belong to the support domain of at least one quadrature point liu and gu 2005 otherwise k i j and m i j vanish the locality of the shape function makes the matrices k and m banded however k i j b is nonzero even for nodes i and j on γ r that do not simultaneously belong to any support domain due to the non local character of the mdtn map it has been shown that the computational effort in using the dtn boundary condition is insignificant for large problems keller and givoli 1989 after having obtained the values of the acoustic pressures along the artificial boundary solution at any field point outside the artificial boundary can be determined with the help of eq 7 5 numerical examples several numerical examples are conducted in this section to examine the performance of the proposed method for underwater acoustic radiation problems the available values of the dimensionless size and the shape parameter are first determined for the following studies by numerical experiments using a submerged infinitely long cylinder with the analytical solutions then the property of this method is studied acoustic radiations from a sector of an infinitely long hollow cylinder and a designed 2d submarine like structure are employed to further verify the performance of the proposed method 5 1 radiation from a submerged infinitely long cylinder in this subsection acoustic radiations radiated by a submerged infinitely long cylinder of radius a 0 25 m are studied as shown in fig 3 the acoustic medium is water with density ρ 1000 kg m 3 and speed of sound c 1500 m s a circular artificial boundary of r 0 5 m is centered at origin the circumferential dirichlet boundary condition on the wet surface of the cylinder r a is given as p θ cos n θ the normalized analytical solution of the problem is expressed as 51 p r θ h n 1 k r h n 1 k a cos n θ in the following the circumferential modes are considered to analyze the property of the proposed method including the dimensionless size the shape parameter the number of terms employed in the mdtn map the accuracy the convergence property and the computing efficiency in this paper ϵ real and ϵ imag represent the root mean square norms of the relative errors of the real and imaginary components of the computed acoustic pressures respectively which are given by 52 ϵ real 1 l i 1 l real p i exact p i nume real p i exact 100 2 53 ϵ imag 1 l i 1 l imag p i exact p i nume imag p i exact 100 2 where p i exact and p i nume denote the analytical and the numerical solutions of the acoustic pressure at field node x i respectively 5 1 1 factors affecting accuracy the dimensionless size α s should be pre determined for a class of benchmark problems the available values of α s are usually achieved by implementing numerical experiments liu and gu 2005 to investigate the effect of α s on the accuracy of the iiefg mdtn method complete polynomial basis of order 2 are employed to form the shape function an average nodal spacing d 0 023 m with irregularly distributed nodes is used and 496 quadratic elements are selected as background cells for quadrature as shown in fig 4 the acoustic wave number satisfies k a π 2 such that the radius of the cylinder exactly equals to one wavelength considering the shape function n x c l v if w x x i c l v 5 gauss legendre integration points in each direction of the global background cell are employed to ensure the calculation accuracy for the system matrix coefficients for the second and third circumferential modes n 1 2 ϵ real and ϵ imag on the artificial boundary against α s with δ α s 0 1 are depicted in figs 5 and 6 respectively where α 0 35 in w3 and n 7 in mdtn map are used it is observed from the figures that the errors change with the dimensionless size α s the accuracy of the predicted results is remarkably affected by α s therefore the dimensionless size must be carefully determined to give good accuracy the results show that the error of the computed results is acceptable at 1 8 α s 3 the accuracy would degrade if α s 1 8 or α s 3 for small values of α s 1 8 the influence domain is too small consequently not enough nodes are included in the support domain of the calculating point to perform the acoustic pressure function interpolation as a result the smoothness of iimls shape functions reduces conversely for large values of α s 3 the influence domain is too big the iimls shape function become too smooth thus the local properties of the acoustic pressure field variable cannot be realized in addition due to too the big influence domain the computational cost will remarkably increase therefore to keep a balance between the accuracy and the computational cost α s 2 is recommended for the present method in this paper the shape parameter α in w3 can significantly affect the performance and accuracy of the iimls shape functions used in the proposed method therefore it must be determined carefully the effect of α on accuracy of this method is studied the error against α with δ α 0 1 is computed at k a π 2 for three circumferential modes and depicted in fig 7 the results show that the shape parameter α has a remarkable influence on the accuracy it is observed that α in the range of 0 3 0 6 can achieve acceptable accuracy the error for α 0 2 significantly increases with the erroneous results obtained due to too large conditioned a x according to the results α 0 3 is preferred and employed in the following studies to test the accuracy of mdtn boundary condition both mdtn and dtn conditions are truncated at n and the error obtained by using two boundary conditions is compared at k 4 π for different values of n where the third circumferential mode is employed the error versus n is plotted in fig 8 as shown in fig 8 for all the values of n the error in using the truncated dtn condition is larger than that using the modified version for small values of n the error of the dtn condition remains relative large due to the spurious eigenmodes the lowest value of the error can be achieved for the given average nodal spacing only when n is large enough such that the dtn condition captures the key harmonic modes present in the solution although well posedness is ensured by setting n k r for the dtn condition the desired accuracy cannot be guaranteed for a given average nodal spacing in addition it is usually not known in advance how many series must be included to achieve an acceptable accuracy however the error corresponding to mdtn condition quickly reaches its lowest value even for small values of n 3 that is much smaller than k r 6 28 this is an advantage of mdtn condition compared to dtn condition n 6 is employed in the following studies 5 1 2 accuracy of the acoustic field in order to further test accuracy of this devised method frequency response functions of the third and fourth circumferential modes are illustrated in figs 9 and 10 respectively where the solutions are sampled on the artificial boundary with polar angle θ π 14 the polar plots of different circumferential modes n 4 5 6 7 for k a π 2 are presented in fig 11 where p presents the acoustic pressure amplitude from the results given in figs 9 and 10 it can be observed that the computed results agree well with the exact solution in the total wave number range these results depicted in fig 11 show that a good agreement between the computed results by the proposed method and the analytical data is achieved compared to w1 and w2 w3 provides slightly better accurate results 5 1 3 convergence study the convergence property of this proposed method is numerically investigated using four average nodal spacings d 0 011 0 020 0 032 and 0 043 at k 2 π the prediction error along the artificial boundary as a function of the average nodal spacing d is depicted in fig 12 for the third circumferential mode the numerical result from conventional fem is also depicted for the purpose of comparison for both fem and the proposed method the identical configuration is employed where complete polynomial basis of order 2 quadratic finite elements and the same number of regularly distributed nodes are employed the convergence curves show that this proposed method behaves better than fem in convergence property this is because the iimls shape functions achieve higher interpolation accuracy compared to the fem shape functions it should be indicated that the convergence of the iiefg mdtn method and the fem scheme is investigated with the use of regularly field nodes if irregularly distributed nodes are employed the iiefg mdtn method will have much better convergence than the conventional fem scheme from the curves the convergent process corresponding to w1 is not stable when smaller nodal spacing is used although the accuracy is still acceptable see table 1 when w2 and w3 are employed the present method possesses steady convergence this is because that w1 which possesses a continuity of only 2nd order has lower continuity compared to w2 and w3 however w2 possesses 3nd order continuity and w3 is continuous at all orders within the interior of the support domain due to its continues derivatives of all orders within the support domain therefore w2 and w3 can theoretically obtain relative stable convergence compared to w1 the other possible reason is that the dimensionless size cannot match well with w1 until now no successful rigorous techniques or methods exist for theoretically achieving the best value of the dimensionless size its available values can be only determined by numerical experiments a more detailed study is needed to determine the optimal value of the dimensionless size 5 1 4 efficiency study the computational efficiency of the devised method is investigated here four average nodal spacings employed in previous subsection and the third circumferential mode are used again all the programs are executed in the same software and hardware intel r xeon r w 2255 cpu 3 7 ghz and ram 64gb environments the cpu time versus the average nodal spacing at k 2 π is present in fig 13 a where w3 is employed obviously compared to fem the proposed method requires more computational cost when the same node configuration is used the prime reason is that the iimls shape functions must be reformed for the field nodes within support domain of a quadrature point but in fem the fe shape functions of an element that covers the quadrature point are already predetermined before calculation in addition the bandwidth of the system matrices corresponding to the proposed method is generally larger than the fem one because of more node information used to assemble the system matrices in the present method a successful numerical method should achieve high accuracy at a low computational expense to perform a fair assessment of the computational efficiency the computational cost should be considered together with the accuracy the computational costs of the two methods for the same accuracy level are obtained fig 13 b shows the cpu time versus the numerical error corresponding to the real component of the acoustic pressure clearly the proposed method needs much less cpu time than the fem hence the present method is more efficient than fem as the accuracy is taken into consideration for instance when the error log 10 ϵ r e a l 0 243 the computational cost of the proposed method is about 57 of the fem consequently the proposed method actually behaves better than fem in computational efficiency 5 2 radiation from a sector of a submerged cylinder now a more complicated acoustic radiation from a submerged infinite cylinder with constant inhomogeneous value on an arc φ θ φ φ π 6 and vanishing elsewhere is investigated to further test the performance of the devised method the identical size previously used is employed here as shown in fig 14 where the related parameters and average nodal spacing are the same as the previous problem the normalized analytical solution is expressed as 54 p r θ 2 π n 0 sin n φ n h n 1 k r h n 1 k a cos n θ the frequency response function on the sampled node that is previously used is illustrated in fig 15 here three wave numbers k 2 π 4 π 8 π are selected to investigate the distribution of the predicted results along the artificial boundary the distributions are plotted in figs 16 18 as depicted in these figures it is observed that the numerical solutions obtained from the proposed method are closed to the exact data in the total wave numbers the predicted acoustic pressures deviate slightly from the exact results in high wave numbers in addition w3 can achieve more accuracy result than w1 and w2 5 3 radiation from a submarine shaped structure when a submarine is crewing in certain speed the radiated noise level needs to be assessed enemy sonar is far away from the detected object in the proposed method the radiated acoustic pressure at far field point can be obtained with the help of eq 7 after having exactly computed the solutions along the artificial boundary in this section a realistic underwater acoustic radiation prediction of a 2d submarine shaped structure that is immersed in water with density ρ 1000 kg m 3 and speed of sound c 1500 m s is investigated the shape and the length of which are shown in fig 19 in fact the vibration mode corresponding to both the tail and the front hull of the submarine which depends on the analysis frequency should be considered when the submarine noise is predicted qi et al 2019a b for simplicity only the vibration in the stern due to the engine that is located in the stern of this 2d submarine is considered thus the main noise is from the stern a neumann boundary with vibration velocity of v n 1 0 5 m s is imposed on the stern a circular of r 50 m is employed as the artificial boundary which is centered at the origin two observation points a and b which have polar angles θ 0 π 2 respectively and located on the artificial boundary are employed the computational domain is represented with the use of 10 841 nodes and 10 545 bilinear quadrilateral elements as the analytical solution of the problem does not exist a reference solution can be determined from fem employing a fine mesh 179 005 nodes 177 820 quadrilateral elements first the distribution of the acoustic pressure along the artificial boundary is investigated at 100 hz 200 hz and 300 hz these values of the acoustic pressure computed by the proposed method with the exponential function w3 as the weight function and fem together with the reference are presented in figs 20 22 as shown in these figures both the proposed method and fem can provide good results at low frequency f 100 hz with the increase of the frequencies the iiefg mdtn results do not deviated much from the reference data however the fem results depart from the reference results dramatically especially the results at f 300 hz the frequency responses of the observation points are studied to further validate the performance of the devised method the investigation is made from 10 hz to 400 hz with the increment of 1 0 hz the numerical results of the present method and fem together with the reference frequency response are depicted in figs 23 and 24 for the observation points a and b respectively from the results the devised method can provide more accurate results than fem in the frequency range in addition the present method can still provide acceptable results at high frequencies however the fem can no longer achieve good accuracy hence the devised method can generally behave better in realistic underwater acoustic radiation predicting and is less sensitive to the computation frequency 6 conclusions the improved interpolating element free galerkin method combined with modified dirichlet to neumann mdtn boundary condition is devised for underwater acoustic radiation computing in this paper numerical examples are performed to study the performance of the proposed method the following major conclusions can be summarized as following 1 the iiefg mdtn method works stably for underwater acoustic radiation prediction in unbounded domain and can provide acceptable numerical results 2 compared with fem the devised method can provide more accurate solutions and behaves better in convergence property in addition the proposed method is less sensitive to the computation frequency 3 for the same configuration the proposed method requires more computational cost than fem due to meshfree shape function construction however the present method is actually more effective than fem when better accuracy level is taken into consideration 4 the accuracy of w3 employed as the weight function is slightly better compared to w1 and w2 when w1 is used the convergent process is not stable because of the dimensionless size not matching with w1 a theoretical analysis of determining its best value still needs to be addressed 5 inspired by the multi objective optimization strategy mentioned before study on automatically determining the values of the dimensionless size and the parameter and generating the meshfree discretization will continue in future research credit authorship contribution statement shaowei wu conceptualization methodology software data curation writing original draft yang xiang conceptualization methodology bao liu data curation guangnian li data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national natural science foundation of china grant no 51909016 the natural science foundation of chongqing china grant no cstc2020jcyj msxmx0070 the science and technology research program of chongqing municipal education commission china grant no kjqn201900705 and the key laboratory of marine power engineering technology wuhan university of technology china ministry of transport china grant no klmpet2019 04 
20629,an improved interpolating element free galerkin iiefg method coupled with modified dirichlet to neumann mdtn boundary condition is presented in this paper for use in computing underwater acoustic radiation in the scheme of the iiefg mdtn approach the improved interpolating moving least square technology is employed to construct the shape function with the aim of improving the interpolation accuracy and the mdtn boundary condition is used to meet the sommerfeld radiation condition required at infinity and remove the difficulties arisen as the truncated dtn boundary condition is employed in computation it is the key feature of this weak form meshfree method that no connectivity of nodes or mesh is required for acoustic field variable interpolations while the prediction accuracy is significantly improved the factors including the size of the influence domain shape parameters and the number of terms used in the mdtn map which affect the performance of this proposed method are studied numerically typical numerical examples are presented to test the properties of the iiefg mdtn approach the results indicate the devised method is outstanding to cope with underwater acoustic radiation prediction and can achieve higher accuracy and faster convergency compared to the finite element method graphical abstract keywords weak form meshfree underwater acoustic radiation 1 introduction underwater acoustic problems have been a quite active research field in recent decades however many of them cannot be analytically solved therefore various numerical approaches or technologies have been devised for solving the underwater acoustic problems with complex geometry shape boundary element method bem and finite element method fem are still two dominant numerical methods in computing underwater acoustic radiation bem that employs the free space green s function as the fundamental solution and automatically satisfies the sommerfeld radiation condition is an effective tool for solving the acoustic problems in unbounded domain in bem a boundary discretization is only required thus a d 1 dimensional problem is obtained compared to the original d dimensional one ciskowski and brebbia 2005 thompson 2006 kirkup 2007 liu et al 2017 however because the fundamental solution is nonlocal support the system matrices are non symmetric and non sparse which significantly increases the storage requirement and the processing time kirkup 2007 as a result the computational advantage acquired by dimension reduction is offset to the yielded matrices in addition there is non uniqueness problem i e standard bem fails at the critical frequencies as the weak singular boundary integrals occur kirkup 2007 liu et al 2017 wu 2000 marburg and nolte 2008 to ensure the uniqueness the burton miller and the combined helmholtz integral equation formulation chief approaches have been devised to remove the difficulty kirkup 2007 thompson 2006 wu 2000 marburg 2016 in the burton miller approach the original integral formulations are modified with their normal derivatives to theoretically preclude the non unique solutions marburg 2016 but the introduced various orders of singular integrals corresponding to green s function have to be mathematically treated with high computational cost in the chief approach the additional integral formulations make solutions vanish at these chief points and are combined with the original ones thus the fictitious results can be eliminated from the true ones however how to effectively determine the limit of stability and appropriately select chief points is still a challenge in this approach thompson 2006 the application of the acoustic bem is significantly moved owing to great progresses in the development of bem achieved during the past few decades marburg 2018 for example the computational cost is dramatically reduced with the use of the fast multipole bem gong et al 2017 a more detailed discussion of bem can be found in the kirkup 2019 the acoustic bem is still in the process of being improved fem that is a general purpose computational tool has been an effective approach for large problems because of sparse discretized system equations and is being increasingly employed for acoustic problems ihlenburg 1998 kaltenbacher 2018 however exterior acoustic problems in the unbounded domain cannot be directly solved with the use of standard fem special techniques have to be required standard fem remains two crucial challenges thompson 2006 chai et al 2016a the first one is how to deal with unbounded domain and meet the sommerfeld radiation condition at infinity to ensure acoustic wave travelling outward how to diminish the so called numerical dispersion error that increases dramatically with acoustic wave number is the second challenge first of all in acoustic fem unbounded domain must be truncated with artificial boundary in order to obtain a finite computational domain then the required non reflecting boundary condition including dirichlet to neumann dtn boundary condition perfectly matched layer infinite element techniques and absorbing boundary condition needs to be applied on the artificial boundary to ensure that all the acoustic waves travel outward without spurious reflection from the artificial boundary thompson 2006 ihlenburg 1998 xu et al 2017 bhuddi et al 2015 in two dimensional exterior acoustic problems the mapped infinite elements with r 1 2 decay have been proposed to correct decay of outgoing waves and the corresponding numerical integration scheme is devised zienkiewicz et al 1985 an advantage of employing these improved mapped infinite elements is that the artificial movement of the origin is not required compared to the infinite elements with exponential decay and any damper element much more accurate solutions can be produced using these types of infinite elements how to accurately achieve oscillating wave solutions at high wave number is a crucial difficulty for fem hu et al 2017 xu et al 2019 compared to the original model the stiffness of the discretized model in standard fem always behaves stiffer thus refining mesh is not an effective way to diminish the numerical dispersion error liu and zhang 2013 to handle this issue in recent years some novel approaches based on the smoothing techniques or meshfree approaches have been proposed to soften the overly stiff property of the fe model in advanced fem field a novel weakened weakform based on g space theory is devised to deal with the partial differential equations in solid mechanics problems liu and zhang 2013 several excellent approaches that are based on the gradient smoothing techniques and the w2 form have been proposed for acoustic problems and solid mechanics such as the hybrid smoothed finite element method hs fem chai et al 2016a b the meshfree cell based smoothed alpha radial point interpolation method cs α rpim liu et al 2013 the edge based smoothed finite element method es fem li et al 2017 the stable node based smoothed finite element method sns fem chai et al 2016c and the superconvergent alpha finite element method chai et al 2017 thus a properly softened system stiffness can be obtained with the help of these approaches or techniques consequently numerical accuracy is significantly improved dtn boundary condition is an exact nonlocal boundary condition ihlenburg 1998 keller and givoli 1989 in which the dirichlet datum is related to the neumann datum through the integral operator it has been shown that compared to the local non reflecting boundary conditions the nonlocal boundary condition is more useful in many situations a detailed comparison between the nonlocal and local boundary conditions can be found in the givoli and patlashenko 1998 however the infinite series in the formulation of the boundary condition is truncated after a finite number of terms for use in computation leading to the infinite real eigenvalues of the exterior acoustic problem grote and keller 1995 giljohann and bittner 1998 hsiao et al 2011 geng et al 2017 as a consequence the problem will have no solution or an non unique one when the square of the wave number is such an eigenvalue therefore the truncated dtn condition is no longer exact although the effect of the eigenvalues can be removed by employing enough terms a very large number of terms that may include much more terms than actually be necessary to achieve desired accuracy is required when high acoustic wave number is encountered or large radius of the artificial boundary is employed grote and keller 1995 giljohann and bittner 1998 li and yuan 2020 which results in a large overhead in computation to eliminate the difficulties that arise when the dtn condition is truncated a modified dtn mdtn boundary condition is proposed which is determined based on the dtn map by adding a local differential operator and simultaneously subtracting the contribution of the operator from the standard dtn map grote and keller 1995 this modified version is exact for low modes included in the kernel of the integral operator and an approximate non reflecting boundary condition is induced by the local operator for high modes not included in the kernel oberai et al 1998 koyama 2009 a key property of the modified version is that for any number of terms included the solution of the resulting problem is unique oberai et al 1998 furthermore compared to the standard truncated version an advantage of the modified version is that better accuracy can be achieved using small values of the number of the terms grote and keller 1995 since it is not known in advance how many terms must be included to achieve a desired accuracy the mdtn boundary condition has been employed in practical computation grote and kirsch 2004 and used to resolve other problems ofir and givoli 2015 in the field of numerical simulations meshfree methods which are devised to eliminate several difficulties associated with reliance on mesh to form the variable interpolation or approximation are relatively new approaches compared with mesh based methods liu and gu 2005 in recent years meshfree methods have gained significant popularity and major successes have been obtained in employing these approaches for treating certain challenging numerical and engineering problems in meshfree methods problem domain and its boundary are represented with the use of arbitrarily distributed nodes a set of nodes inside the support domain of the calculating point are selected to construct the shape functions connectivity of nodes or mesh is not used for variable interpolation or approximation liu and gu 2005 therefore the performance of the meshfree methods is almost not influenced by the irregularity of the nodes according to the formulation procedures liu and gu 2005 meshfree methods generally fall into three categories meshfree strong form methods such as the meshfree collocation method abbasbandy et al 2012 dehghan and shokri 2008 meshfree weak form methods such as the element free galerkin efg method belytschko et al 1994 1995 peng et al 2011 zhang et al 2013 and meshfree weak strong mws form methods liu and gu 2004 liu et al 2004 gu and liu 2005 the radial basis function rbf method the moving least squares approximation mlsa and the partition of unity method are commonly employed in meshfree methods to construct the shape functions liu and gu 2005 meshfree strong form methods are truly meshfree approaches mesh is not required for both the variable interpolation or approximation and numerical integration simple algorithm and computational efficiency are key advantages of these methods but it has been shown that these methods are often inaccurate unstable and not robust for the kinds of problems with derivative boundary conditions liu and gu 2005 meshfree weak form methods in which sets of global or local background cells are employed for numerical integration and a weaker consistency on the approximate function is required can usually generate a much stabler set of discretized system equations and give much better accuracy compared to the strong form ones liu and gu 2005 efg method that has higher accuracy and convergency than fem which employs mlsa to construct the shape function in the global galerkin weak form lancaster and salkauskas 1981 belytschko et al 1994 has been successfully and widely applied to a lot of problems such as plate and shell structure problems linear and nonlinear elastic problems electromagnetic field problems fracture and crack growth problems and so on liu and gu 2005 due to the use of galerkin formulation to yield well behaved and stable discretized global system equations and the use of mlsa to achieve excellent stability in shape function construction belytschko et al 1996 because the mlsa shape function does not possess the kronecker delta function property the essential boundary conditions cannot be enforced as directly and easily as in standard fem based on mlsa the interpolating moving least squares imls method is established with the use of singular weight functions lancaster and salkauskas 1981 the imls shape function satisfies the property of the kronecker delta function thus the essential boundary conditions can be directly enforced however the weight functions used in imls method are singular at nodes sun et al 2013 some difficulties are caused to calculate the derivatives of the approximation functions as a result inverse operation of the singular matrix is significantly complicated several methods have been devised to remove the drawbacks in imls method cai et al 2010 sun et al 2013 zhuang et al 2014 amiri et al 2014 among these methods an outstanding method is the improved interpolating moving least squares iimls method sun et al 2013 the iimls shape function possesses the property of the kronecker delta function with the use of nonsingular weight function employed in mlsa in addition less unknown coefficients in the trial function of iimls method need to solved compared to mlsa consequently the shape function can be formed using fewer nodes it has been indicated that improved interpolating efg iiefg method that employs iimls method to construct the shape function can achieve better accuracy than efg method for the identical node distribution wu and xiang 2018 in meshfree global weak form methods global background cells have to be generated for numerical integration therefore these meshfree methods are not the pure meshfree approaches in order to avoid using global background cells a meshless local petrov galerkin mlpg method based on local weak form is developed atluri and zhu 1998 based on mlpg method some variant versions are devised liu and gu 2001a b liu et al 2002 in this local weak form numerical integration is performed over a corresponding local domain of field node only a local cell is generated without the use of global background cell the mlpg formulation is quite similar to the strong form scheme the corresponding implementation procedure is as simple as the meshfree strong form methods consequently mlpg method can be said a pure meshfree method in mlpg method the shape functions are constructed by using mlsa as in efg scheme thus special techniques are required to enforce the essential boundary conditions liu and gu 2005 it should be indicated that these advantages of local weak form methods are obtained with some cost in mlpg method additional parameters are introduced and the resulting system matrix is generally asymmetric thus the sizes of local quadrature domains and the test function must be carefully selected due to the additional parameters besides that compared to efg the mlpg method are computationally more expensive due to the non symmetric matrix liu and gu 2005 with the purpose of improving the accuracy and efficiency of solution in two dimensional elasticity and linear elastic fracture mechanics the integrated local mesh free ilmf method is developed to remove the difficulties with nodal integration oliveira et al 2019 it has been indicated that application of the ilmf method the sizes of the nodal compact support and the local integration domain of each node directly determine the accuracy and the efficiency of the model respectively oliveira et al 2019 based on genetic algorithms the two parameters can be automatically obtained using a multi objective optimization process santana et al 2020 thus the reliability and the robustness of this meshfree local method have been significantly improved besides these domain type meshfree methods boundary type meshfree methods in which only the boundaries of the problem domain are represented by a set of nodes have been developed for coping with lots of challenging issues liu and gu 2005 such as that boundary meshfree methods have been applied to solve 2d nonlinear problems in these methods the size of compact should be usually determined in advance by numerical experiments and the boundary of the problem domain cannot be automatically discretized to completely automate the discretization process of the boundary mesh free methods and optimally determine the corresponding parameters a multi objective optimization strategy that can automatically generate pareto optimal nodal arrangements and compact supports of the meshfree discretization is developed araújo et al 2021 with the help of the devised scheme the solution accuracy the stability and efficiency of this boundary meshfree method are significantly improved the meshfree local weak form methods and the boundary type meshfree methods are still in the process of being improved efg method has been applied to interior acoustic problems and can produce accurate results bouillard and suleaub 1998 suleau et al 2000 kireeva et al 2006 wenterodt and estorff 2011 shojaei et al 2016 however as any other numerical method efg method also has disadvantages because a set of distributed nodes and background cells must be generated to represent problem domain perform variable approximation and achieve integral operation which makes computation quite expensive and is even practically impossible for underwater acoustic problems with semi infinite or infinite domain efg method cannot be directly applied to these kinds of exterior acoustic problems considering the advantages of the iiefg method and the mdtn boundary condition as described previously it is great interesting to combine iiefg method with mdtn boundary condition for underwater acoustic radiation computation with the aim of making use of their advantages while evading disadvantages the present paper is outlined as follows the fundamental theory is presented in section 2 in section 3 the mdtn boundary condition is described the formulation of the present method is given in section 4 in section 5 the factors that affect the performance of this present method are studied numerically and simulations are carried out to test the performance and applicability of the iiefg mdtn method finally conclusions including future developments are given in section 6 2 underwater acoustic radiation problem in unbounded domain the acoustic pressure p x t generated by a rigid object immersed in unbounded domain v with homogeneous isotropic medium can be described as follows 1 2 p x t 1 c 2 2 p x t t 2 0 where c is sound speed in acoustic medium and 2 represents the laplace operator in time harmonic problems p x t p x e i ω t where p x represents the complex amplitude of the acoustic pressure ω denotes the angular frequency and i 2 1 thus the following helmholtz equation is obtained 2 2 p x k 2 p x 0 x v where k ω c is acoustic wavenumber assuming the surface of the radiator can be decomposed into dirichlet boundary γ d and neumann boundary γ n where γ d γ n γ and γ d γ n 0 they are given as follows 3 p p d on γ d p x n b i k ρ c v x on γ n where p d and v x represent the given pressure on γ d and the prescribed normal velocity on γ n respectively ρ is density of the medium and n b denotes the outward normal to the boundary considering wave propagation in unbounded domain the sommerfeld radiation condition should be met to ensure that all waves at infinity are outgoing described as ihlenburg 1998 kaltenbacher 2018 4 p o r β p r i k p o r β for r where r is the distance from the origin and β 1 2 and 1 for 2 dimensional and 3 dimensional cases respectively here it should be noted that p r i k p o r β when p x t p x e i ω t in general only the second expression in the above equation that is equivalent to p n i k p 0 at infinity is given ihlenburg 1998 3 the modified dirichlet to neumann boundary condition to solve this problem numerically a finite computational domain v i which is bounded internally by γ and externally by the artificial boundary γ r that is often a circle or sphere of radius r for 2 dimensional or 3 dimensional case respectively is defined as depicted in fig 1 then the boundary condition p x n m p x is imposed on γ r where the operator m that relates the dirichlet datum p to the neumann datum p n on γ r is called dirichlet to neumann dtn map thus the following equivalent problems are yielded 5 2 p x k 2 p x 0 in v i p p d on γ d p x n b i k ρ c v x on γ n p x n m p x on γ r 6 2 p x k 2 p x 0 in v o p p r θ on γ r p r i k p o r β for r here a briefing for the formulation of the dtn boundary condition is described in this section for the sake of completeness detailed discussion of the formulation is presented in the keller and givoli 1989 in two dimensions the analytical solution of eqs 6 is given in polar coordinates r θ as 7 p r θ 1 π n 0 0 2 π h n 1 k r h n 1 k r cos n θ θ p r θ d θ where p r θ represents the acoustic pressure on γ r h n 1 is the hankel function of the first kind of order n and the prime after the sum indicates that a factor of 1 2 multiples the term with n 0 then by differentiating the above equation with respect to r and setting r r the following equation can be obtained 8 p r θ n r r m p r θ n 0 0 2 π m n θ θ p r θ d θ with 9 m n θ θ k π h n 1 k r h n 1 k r cos n θ θ where the prime on the function denotes a derivative with respect to the argument kr here m n θ θ is the dtn kernel and can be expanded in the form 10 m n θ θ k π h n 1 k r h n 1 k r cos n θ cos n θ sin n θ sin n θ the infinite series in eq 8 must be approximated for use in computation by truncating the infinite series after a finite value n here m n is used to denote the truncated dtn map then eq 8 is replaced by 11 p r θ n r r m n p r θ n 0 n 0 2 π m n θ θ p r θ d θ therefore the truncated dtn boundary condition is no longer exact as mentioned previously the main drawback is that the unique solvability of the problem is ruined by the truncation when n is not sufficiently large to remove the difficulties and improve the computation accuracy the mdtn boundary condition is devised to ensure the unique solvability for all n grote and keller 1995 it is determined from the dtn map by adding and subtracting b p r θ on the right side of eq 8 simultaneously including the subtracted term in the sum and then truncating m b which is expressed as 12 p r θ n r r m m n p r θ m n b n p r θ b p r θ where m m n denotes the mdtn map and b represents a local differential operator the detailed discussion of the mdtn boundary condition is given in the grote and keller 1995 in this paper the following local differential operator is considered 13 b p r θ i k 1 2 r p r θ thus the mdtn boundary condition is yielded as 14 p r θ n r r i k 1 2 r p r θ 1 π n 0 n k h n 1 k r h n 1 k r i k 1 2 r 0 2 π cos n θ θ p r θ d θ 4 the formulation of the present meshfree method 4 1 forming the shape function in computational domain v i system equations are established by employing the iiefg method p h x is used to denote the trial function of the acoustic pressure p x applying the weighted residual formulation and the green s formula to the domain v i yields the following weak form equation 15 v i w x p h x d v k 2 v i w x p h x d v γ r w x m m n p h x d γ i k ρ c γ n w x v x d γ where w x denotes the weighting function assuming that the domain v i is represented using arbitrarily distributed nodes as seen in fig 1 the acoustic pressure at any point in v i can be interpolated by using the field node pressure the shape function of acoustic pressure that is formed using iimls is presented in this subsection from the given basis functions p 1 x 1 p 2 x p m x a set of new local basis is formed in order to make the shape function satisfy kronecker delta function property with the use of nonsingular weight functions sun et al 2013 in general complete monomial functions are most widely selected as the given bases liu and gu 2005 for a calculation or quadrature point x v i the new local basis is determined as 16 b l x x p l x i 1 n v x x i p l x i l 1 2 m where x and x i i 1 2 n denote point and field nodes respectively inside the support domain ω s of quadrature or calculating point x and v x x i is expressed as sun et al 2013 17 v x x i ζ x x i j 1 n ζ x x j with 18 ζ x x i j i x x j 2 j i x i x j 2 obviously v x i satisfies v x i x j δ i j and 19 i 1 n v x x i 1 x ω s in the meantime performing the same transformation to the acoustic pressure p x yields 20 p x x p x i 1 n v x x i p x i then based on mlsa and with the use of the new bases a local approximation of p x x can be achieved as 21 p x x l 1 m b l x x a l x where a l x l 1 2 m denote unknown coefficients substituting p 1 x 1 into eq 16 and considering eq 19 yield 22 b 1 x x 1 i 1 n v x x i 0 thus p x x can be expressed as 23 p x x l 2 m b l x x a l x from eq 23 it can be observed that less unknown coefficients are included in the trial function of the iimls method compared to mlsa consequently fewer nodes can be employed in the support domain and less order of the inverse matrix is achieved compared to the mlsa the unknown coefficients a l x l 2 3 m can be solved by minimizing the following weighted discrete l 2 norm 24 j i 1 n w x x i p x x i p x x i 2 v x p d x a x p t w x v x p d x a x p where w x x i denotes the weight function that is only available in the influence domain of field node x i v x represents an n n matrix with its row determined as 25 v t x v x x 1 v x x n and 26 p t p x 1 p x n 27 d x b 2 x x 1 b m x x 1 b 2 x x n b m x x n n m 1 28 a x t a 2 x a m x 29 w x diag w x x 1 w x x n the stationarity of j with respect to a x yields 30 j a x 2 d t x w x d x a x d t x w x e v x p 0 where e denotes an n n identity matrix then eq 30 is directly solved to obtain a x 31 a x d t x w x d x a x 1 d t x w x e v x b x p substituting eq 31 into eq 23 yields 32 p x x l 2 m b l x x a l x b t x x a 1 x b x p where b x x b 2 x x b 3 x x b m x x t from eqs 20 and 32 a global interpolating expression of the acoustic pressure p x can be written as 33 p h x i 1 n n i x p x i n t x p where the shape function vector n t x n 1 x n n x is expressed as 34 n t x v t x b t x a 1 x b x with b t x b 2 x b 3 x b m x and 35 b l x p l x i 1 n v x x i p l x i l 2 m from v x i x j δ i j b l x j satisfies that 36 b l x j p l x j i 1 n v x j x i p l x i p l x j p l x j 0 thus b t x j is determined as 37 b t x j b 2 x j b 3 x j b m x j 0 1 m 1 consequently n t x j is calculated as 38 n t x j v t x j b t x j a 1 x j b x j v t x j hence 39 n i x j v x j x i δ j i eq 39 shows that the kronecker delta function property is satisfied with the use of nonsingular weight function that is employed in mlsa as a consequence the difficulties encountered in the imls method are removed in eq 24 the weight function w x x i should possess several properties such as w x x i 0 outside the influence domain w x x i 0 within the influence domain w x x i is sufficiently smooth and w x x i monotonically decreases from the quadrature or calculating point x the cubic spline function w1 the quartic spline function w2 and the exponential function w3 are the most commonly employed which are defined as 40 w1 w x x i 2 3 4 r i 2 4 r i 3 r i 0 5 4 3 4 r i 4 r i 2 4 3 r i 3 0 5 r i 1 0 r i 1 41 w2 w x x i 1 6 r i 2 8 r i 3 3 r i 4 r i 1 0 r i 1 42 w3 w x x i e r i α r i 1 0 r i 1 where α represents a constant of the shape parameter r i x x i r w and r w denotes the radius of the influence domain ω f of a field node x i influence domain is a local domain for a field node that it has an influence upon in general the center of the influence domain is the field node if the influence domains of the nodes cover the calculating point these nodes are located in the support domain of this point and used to construct shape functions for this point as seen in fig 2 circle influence domain for 2d problem is employed for simplicity in following studies according to the suggestion liu and gu 2005 r w is determined as r w α s d where α s denotes the dimensionless size of the influence domain of the field node x i and d represents the nodal spacing near this field node in the meshfree global weak form method for a class of problems α s can be obtained by performing numerical experiments and is crucial to computational accuracy 4 2 forming the discrete system equation considering that the weighting function w x has the same form with the shape function n x in iiefg method eq 15 can be rewritten as 43 v i n x n t x p d v k 2 v i n x n t x p d v γ r n x m m n n t x p d γ i k ρ c γ n n x v x d γ then the discretized version of eq 43 can be obtained in the following matrix form 44 k k 2 m k b p f with 45 k i j v i n i x n j x d v 46 m i j v i n i x n j x d v 47 f i i k ρ c γ n n i x v x d γ 48 k i j b γ r n i x m m n n j x d γ i k 1 2 r γ r n i x n j x d γ n 0 n γ n γ r n i x c n x d γ γ r n j x c n t x d γ where the indexes of nodes i and j in above equations are based on the global numbering system p denotes the vector of the acoustic pressure values to be solved and 49 γ n 1 π r k h n 1 k r h n 1 k r i k 1 2 r 50 c n x cos n θ sin n θ it can be observed that the effect of the mdtn map on the standard meshfree formulation is the inclusion of k b in eq 44 note that k i j 0 and m i j 0 only when the nodes i and j simultaneously belong to the support domain of at least one quadrature point liu and gu 2005 otherwise k i j and m i j vanish the locality of the shape function makes the matrices k and m banded however k i j b is nonzero even for nodes i and j on γ r that do not simultaneously belong to any support domain due to the non local character of the mdtn map it has been shown that the computational effort in using the dtn boundary condition is insignificant for large problems keller and givoli 1989 after having obtained the values of the acoustic pressures along the artificial boundary solution at any field point outside the artificial boundary can be determined with the help of eq 7 5 numerical examples several numerical examples are conducted in this section to examine the performance of the proposed method for underwater acoustic radiation problems the available values of the dimensionless size and the shape parameter are first determined for the following studies by numerical experiments using a submerged infinitely long cylinder with the analytical solutions then the property of this method is studied acoustic radiations from a sector of an infinitely long hollow cylinder and a designed 2d submarine like structure are employed to further verify the performance of the proposed method 5 1 radiation from a submerged infinitely long cylinder in this subsection acoustic radiations radiated by a submerged infinitely long cylinder of radius a 0 25 m are studied as shown in fig 3 the acoustic medium is water with density ρ 1000 kg m 3 and speed of sound c 1500 m s a circular artificial boundary of r 0 5 m is centered at origin the circumferential dirichlet boundary condition on the wet surface of the cylinder r a is given as p θ cos n θ the normalized analytical solution of the problem is expressed as 51 p r θ h n 1 k r h n 1 k a cos n θ in the following the circumferential modes are considered to analyze the property of the proposed method including the dimensionless size the shape parameter the number of terms employed in the mdtn map the accuracy the convergence property and the computing efficiency in this paper ϵ real and ϵ imag represent the root mean square norms of the relative errors of the real and imaginary components of the computed acoustic pressures respectively which are given by 52 ϵ real 1 l i 1 l real p i exact p i nume real p i exact 100 2 53 ϵ imag 1 l i 1 l imag p i exact p i nume imag p i exact 100 2 where p i exact and p i nume denote the analytical and the numerical solutions of the acoustic pressure at field node x i respectively 5 1 1 factors affecting accuracy the dimensionless size α s should be pre determined for a class of benchmark problems the available values of α s are usually achieved by implementing numerical experiments liu and gu 2005 to investigate the effect of α s on the accuracy of the iiefg mdtn method complete polynomial basis of order 2 are employed to form the shape function an average nodal spacing d 0 023 m with irregularly distributed nodes is used and 496 quadratic elements are selected as background cells for quadrature as shown in fig 4 the acoustic wave number satisfies k a π 2 such that the radius of the cylinder exactly equals to one wavelength considering the shape function n x c l v if w x x i c l v 5 gauss legendre integration points in each direction of the global background cell are employed to ensure the calculation accuracy for the system matrix coefficients for the second and third circumferential modes n 1 2 ϵ real and ϵ imag on the artificial boundary against α s with δ α s 0 1 are depicted in figs 5 and 6 respectively where α 0 35 in w3 and n 7 in mdtn map are used it is observed from the figures that the errors change with the dimensionless size α s the accuracy of the predicted results is remarkably affected by α s therefore the dimensionless size must be carefully determined to give good accuracy the results show that the error of the computed results is acceptable at 1 8 α s 3 the accuracy would degrade if α s 1 8 or α s 3 for small values of α s 1 8 the influence domain is too small consequently not enough nodes are included in the support domain of the calculating point to perform the acoustic pressure function interpolation as a result the smoothness of iimls shape functions reduces conversely for large values of α s 3 the influence domain is too big the iimls shape function become too smooth thus the local properties of the acoustic pressure field variable cannot be realized in addition due to too the big influence domain the computational cost will remarkably increase therefore to keep a balance between the accuracy and the computational cost α s 2 is recommended for the present method in this paper the shape parameter α in w3 can significantly affect the performance and accuracy of the iimls shape functions used in the proposed method therefore it must be determined carefully the effect of α on accuracy of this method is studied the error against α with δ α 0 1 is computed at k a π 2 for three circumferential modes and depicted in fig 7 the results show that the shape parameter α has a remarkable influence on the accuracy it is observed that α in the range of 0 3 0 6 can achieve acceptable accuracy the error for α 0 2 significantly increases with the erroneous results obtained due to too large conditioned a x according to the results α 0 3 is preferred and employed in the following studies to test the accuracy of mdtn boundary condition both mdtn and dtn conditions are truncated at n and the error obtained by using two boundary conditions is compared at k 4 π for different values of n where the third circumferential mode is employed the error versus n is plotted in fig 8 as shown in fig 8 for all the values of n the error in using the truncated dtn condition is larger than that using the modified version for small values of n the error of the dtn condition remains relative large due to the spurious eigenmodes the lowest value of the error can be achieved for the given average nodal spacing only when n is large enough such that the dtn condition captures the key harmonic modes present in the solution although well posedness is ensured by setting n k r for the dtn condition the desired accuracy cannot be guaranteed for a given average nodal spacing in addition it is usually not known in advance how many series must be included to achieve an acceptable accuracy however the error corresponding to mdtn condition quickly reaches its lowest value even for small values of n 3 that is much smaller than k r 6 28 this is an advantage of mdtn condition compared to dtn condition n 6 is employed in the following studies 5 1 2 accuracy of the acoustic field in order to further test accuracy of this devised method frequency response functions of the third and fourth circumferential modes are illustrated in figs 9 and 10 respectively where the solutions are sampled on the artificial boundary with polar angle θ π 14 the polar plots of different circumferential modes n 4 5 6 7 for k a π 2 are presented in fig 11 where p presents the acoustic pressure amplitude from the results given in figs 9 and 10 it can be observed that the computed results agree well with the exact solution in the total wave number range these results depicted in fig 11 show that a good agreement between the computed results by the proposed method and the analytical data is achieved compared to w1 and w2 w3 provides slightly better accurate results 5 1 3 convergence study the convergence property of this proposed method is numerically investigated using four average nodal spacings d 0 011 0 020 0 032 and 0 043 at k 2 π the prediction error along the artificial boundary as a function of the average nodal spacing d is depicted in fig 12 for the third circumferential mode the numerical result from conventional fem is also depicted for the purpose of comparison for both fem and the proposed method the identical configuration is employed where complete polynomial basis of order 2 quadratic finite elements and the same number of regularly distributed nodes are employed the convergence curves show that this proposed method behaves better than fem in convergence property this is because the iimls shape functions achieve higher interpolation accuracy compared to the fem shape functions it should be indicated that the convergence of the iiefg mdtn method and the fem scheme is investigated with the use of regularly field nodes if irregularly distributed nodes are employed the iiefg mdtn method will have much better convergence than the conventional fem scheme from the curves the convergent process corresponding to w1 is not stable when smaller nodal spacing is used although the accuracy is still acceptable see table 1 when w2 and w3 are employed the present method possesses steady convergence this is because that w1 which possesses a continuity of only 2nd order has lower continuity compared to w2 and w3 however w2 possesses 3nd order continuity and w3 is continuous at all orders within the interior of the support domain due to its continues derivatives of all orders within the support domain therefore w2 and w3 can theoretically obtain relative stable convergence compared to w1 the other possible reason is that the dimensionless size cannot match well with w1 until now no successful rigorous techniques or methods exist for theoretically achieving the best value of the dimensionless size its available values can be only determined by numerical experiments a more detailed study is needed to determine the optimal value of the dimensionless size 5 1 4 efficiency study the computational efficiency of the devised method is investigated here four average nodal spacings employed in previous subsection and the third circumferential mode are used again all the programs are executed in the same software and hardware intel r xeon r w 2255 cpu 3 7 ghz and ram 64gb environments the cpu time versus the average nodal spacing at k 2 π is present in fig 13 a where w3 is employed obviously compared to fem the proposed method requires more computational cost when the same node configuration is used the prime reason is that the iimls shape functions must be reformed for the field nodes within support domain of a quadrature point but in fem the fe shape functions of an element that covers the quadrature point are already predetermined before calculation in addition the bandwidth of the system matrices corresponding to the proposed method is generally larger than the fem one because of more node information used to assemble the system matrices in the present method a successful numerical method should achieve high accuracy at a low computational expense to perform a fair assessment of the computational efficiency the computational cost should be considered together with the accuracy the computational costs of the two methods for the same accuracy level are obtained fig 13 b shows the cpu time versus the numerical error corresponding to the real component of the acoustic pressure clearly the proposed method needs much less cpu time than the fem hence the present method is more efficient than fem as the accuracy is taken into consideration for instance when the error log 10 ϵ r e a l 0 243 the computational cost of the proposed method is about 57 of the fem consequently the proposed method actually behaves better than fem in computational efficiency 5 2 radiation from a sector of a submerged cylinder now a more complicated acoustic radiation from a submerged infinite cylinder with constant inhomogeneous value on an arc φ θ φ φ π 6 and vanishing elsewhere is investigated to further test the performance of the devised method the identical size previously used is employed here as shown in fig 14 where the related parameters and average nodal spacing are the same as the previous problem the normalized analytical solution is expressed as 54 p r θ 2 π n 0 sin n φ n h n 1 k r h n 1 k a cos n θ the frequency response function on the sampled node that is previously used is illustrated in fig 15 here three wave numbers k 2 π 4 π 8 π are selected to investigate the distribution of the predicted results along the artificial boundary the distributions are plotted in figs 16 18 as depicted in these figures it is observed that the numerical solutions obtained from the proposed method are closed to the exact data in the total wave numbers the predicted acoustic pressures deviate slightly from the exact results in high wave numbers in addition w3 can achieve more accuracy result than w1 and w2 5 3 radiation from a submarine shaped structure when a submarine is crewing in certain speed the radiated noise level needs to be assessed enemy sonar is far away from the detected object in the proposed method the radiated acoustic pressure at far field point can be obtained with the help of eq 7 after having exactly computed the solutions along the artificial boundary in this section a realistic underwater acoustic radiation prediction of a 2d submarine shaped structure that is immersed in water with density ρ 1000 kg m 3 and speed of sound c 1500 m s is investigated the shape and the length of which are shown in fig 19 in fact the vibration mode corresponding to both the tail and the front hull of the submarine which depends on the analysis frequency should be considered when the submarine noise is predicted qi et al 2019a b for simplicity only the vibration in the stern due to the engine that is located in the stern of this 2d submarine is considered thus the main noise is from the stern a neumann boundary with vibration velocity of v n 1 0 5 m s is imposed on the stern a circular of r 50 m is employed as the artificial boundary which is centered at the origin two observation points a and b which have polar angles θ 0 π 2 respectively and located on the artificial boundary are employed the computational domain is represented with the use of 10 841 nodes and 10 545 bilinear quadrilateral elements as the analytical solution of the problem does not exist a reference solution can be determined from fem employing a fine mesh 179 005 nodes 177 820 quadrilateral elements first the distribution of the acoustic pressure along the artificial boundary is investigated at 100 hz 200 hz and 300 hz these values of the acoustic pressure computed by the proposed method with the exponential function w3 as the weight function and fem together with the reference are presented in figs 20 22 as shown in these figures both the proposed method and fem can provide good results at low frequency f 100 hz with the increase of the frequencies the iiefg mdtn results do not deviated much from the reference data however the fem results depart from the reference results dramatically especially the results at f 300 hz the frequency responses of the observation points are studied to further validate the performance of the devised method the investigation is made from 10 hz to 400 hz with the increment of 1 0 hz the numerical results of the present method and fem together with the reference frequency response are depicted in figs 23 and 24 for the observation points a and b respectively from the results the devised method can provide more accurate results than fem in the frequency range in addition the present method can still provide acceptable results at high frequencies however the fem can no longer achieve good accuracy hence the devised method can generally behave better in realistic underwater acoustic radiation predicting and is less sensitive to the computation frequency 6 conclusions the improved interpolating element free galerkin method combined with modified dirichlet to neumann mdtn boundary condition is devised for underwater acoustic radiation computing in this paper numerical examples are performed to study the performance of the proposed method the following major conclusions can be summarized as following 1 the iiefg mdtn method works stably for underwater acoustic radiation prediction in unbounded domain and can provide acceptable numerical results 2 compared with fem the devised method can provide more accurate solutions and behaves better in convergence property in addition the proposed method is less sensitive to the computation frequency 3 for the same configuration the proposed method requires more computational cost than fem due to meshfree shape function construction however the present method is actually more effective than fem when better accuracy level is taken into consideration 4 the accuracy of w3 employed as the weight function is slightly better compared to w1 and w2 when w1 is used the convergent process is not stable because of the dimensionless size not matching with w1 a theoretical analysis of determining its best value still needs to be addressed 5 inspired by the multi objective optimization strategy mentioned before study on automatically determining the values of the dimensionless size and the parameter and generating the meshfree discretization will continue in future research credit authorship contribution statement shaowei wu conceptualization methodology software data curation writing original draft yang xiang conceptualization methodology bao liu data curation guangnian li data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national natural science foundation of china grant no 51909016 the natural science foundation of chongqing china grant no cstc2020jcyj msxmx0070 the science and technology research program of chongqing municipal education commission china grant no kjqn201900705 and the key laboratory of marine power engineering technology wuhan university of technology china ministry of transport china grant no klmpet2019 04 
