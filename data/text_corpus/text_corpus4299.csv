index,text
21495,a series of 1 50 model tests are conducted to study the motion responses and energy harvesting performance of a novel dual chamber floating oscillating water column device moored by three flexible mooring systems in regular and irregular waves this novel energy conversion device consists of one traditional oscillating water column chamber and one backward bend duct buoy chamber the mooring systems include one modified catenary anchor leg mooring concept and two compact mooring systems designed for station keeping of this specific floating device strong nonlinearities of mooring tension are found especially in the low wave period sea conditions it is also found that the surge and yaw motion has significant differences when the device moored by the different mooring systems the pitch and heave natural periods are derived from their responses amplitude operator curves the performance of spectral methods in mooring fatigue damage estimation depends on mooring configuration and material it is seen that the attached clump weights affect the fatigue damage of the compact mooring rope it has been found that the novel device shows good performance in energy harvesting within broad range of wave periods and the influence of mooring configuration on energy conversion performance depends on the wave height keywords dual chamber floating owc modified catenary anchor leg mooring compact mooring system energy conversion efficiency mooring dynamics mooring fatigue damage 1 introduction sustainable energy has been an objective in the recent decades to deal with the problem of air pollution and energy crisis the solar and wind energy have been widely exploited in many countries in addition to these two renewable energy resources the wave energy also shows a large potential and it is getting more and more attention clément et al 2002 the wave energy converters wecs can capture energy up to 90 of the time while only 20 30 percent for wind and solar power drew et al 2009 the portuguese continental coast has rich wave resource rusu et al 2011 silva et al 2015 for example the aguçadoura has an average wave power of 40 kw m in winter silva et al 2018 besides some portuguese islands have been studied for target deployment site of wave energy harvesting such as azores islands rusu and guedes soares 2012b and madeira islands rusu et al 2008 rusu and guedes soares 2012a a variety of wec concepts have been developed for wave energy capturing and these devices can be categorized into three classes including the oscillating water columns owc overtopping devices and wave activated devices falcão 2010 guedes soares et al 2012 stationary owcs are the first generation of commercialized devices and have been developed for several decades evans 1978 an extensive review of owc development and turbine technology can be found in falcão 2015 falcão and henriques 2019 in addition to device performance evaluation on specified site lópez et al 2019 and intra annual variability of device performance lópez et al 2020 the improvement of energy conversion efficiency is another concerned issue in this context many strategies have been proposed to increase owc device energy harvesting performance rezanejad et al 2013 applied the eigenfunction expansion approach and boundary element method bem to study the influence of stepped bottom on energy conversion efficiency of stationary owc devices it was found that installing a step outside the chamber can increase the device efficiency the stepped bottom owc device was further studied experimentally and numerical by computational fluid dynamics cfd rezanejad et al 2019 it was found that the attached step helps to improve device efficiency owing to the similar effect to dual mass oscillatory system rezanejad and guedes soares 2018 experimental tests and numerical simulations based on cfd were conducted to investigate an onshore owc device with a horizontal bottom plate deng et al 2019 it was found that the length of the horizontal bottom plate has certain effect on wave energy capturing and adopting a relatively long horizontal bottom plate helps to improve the device efficiency the influence of the dimensions of the surging lip wall on hydrodynamic properties of an onshore owc device was studied based on linear wave theory deng et al 2020 it was shown that the energy capturing frequency range was broadened by installing the surging lip wall the dual chamber design is another technology used to improve owc device efficiency the significant improvement of hydrodynamic performance was found by adding an additional chamber to the single chamber owc device and the maximum improvement of capture width ratio could be 140 elhanafi et al 2018 in addition to improve energy conversion efficiency the dual chamber design also helps to increase effective frequency bandwidth ning et al 2019 a dual chamber owc sharing one air turbine was studied by two dimensional higher order boundary element method in ning et al 2017 it was found that by installing a barrier wall inside the chamber could improve the owc hydrodynamic performance when the device operates in high frequency waves however the improvement is limited a cylindrical dual chamber owc device was proposed and numerical studied in ning et al 2018 a bimodal efficiency curve was found based on the numerical simulations which indicates that the energy capturing frequency range is broadened this cylindrical dual chamber owc device was further experimentally studied ning et al 2020 based on the experiment data it was found that the deep inner chamber design helps to broaden the device efficiency frequency bandwidth while the outer chamber draft needs to be shallow in order to increase efficiency a owc design that takes the advantage of stepped bottom and dual chamber can be found in rezanejad et al 2015 by comparing the results of other type owcs it was found that efficiency of this device was improved considerably for wide range wave frequency compared to the stationary owcs the floating devices are more attractive since the wave energy density in open sea is much higher than in nearshore zones besides it was found the energy harvesting performance of floating owc was improved compared to the case when the device was fixed elhanafi et al 2017 a spar type owc concept was proposed and optimized to maximum energy capturing performance falcão et al 2012 gomes et al 2012 the effects of side walls on spar buoy owc energy capturing performance in wave channel was numerical and experimental studied gomes et al 2016 it illustrates that the wall effects amplify the capture width and viscous drag force could reduce device efficiency significantly in fact scale effects also need to considered with great care a numerical and experimental study was carried out to investigate a spar buoy owc moored by slack mooring gomes et al 2020 showing that parametric resonance need to be considered which would induce considerable discrepancies in numerical simulations the spar buoy owc array was further studied by applying experimental correia da fonseca et al 2016 and numerical oikonomou et al 2020 approaches the bem was applied to study the influence of device geometry and wave direction on fowc energy conversion efficiency rezanejad and guedes soares 2015 2014 another special floating owc fowc the backward bent duct buoy bbdb concept was first presented by yoshio masuda in 1987 to improve the energy absorption performance masuda et al 1987 an extensive review of bbdb owc is found in portillo et al 2019 the bbdb devices are installed with horizontal portion of the duct oriented backward from the incident waves so that the reverse drift motions can be observed hong et al 2004 imai et al 2009 mccormick and sheehan 1992 the bbdb is one of the best wecs concepts owing to its high efficiency lee et al 2013 wu et al 2018 and low cost of mooring nagata et al 2008 the effects of mooring configuration on the motion responses and energy conversion of a bbdb was numerically analyzed zaroudi et al 2015 and the mooring stiffness matrix was calculated by the catenary equation method the hydrodynamic performance of a bbdb device was numerically simulated by the boundary element method bem sheng 2019a and the optimization research which aims to improve bbdb device energy conversion efficiency was also conducted sheng 2019b the mooring system is the key component of floating sutures it is strongly associated to the low frequency motion responses and safety of floating structures generally the mooring system should be designed not interfere with the device energy production cost effective small footprint and high safety xu et al 2019c the mooring system design for wec is a great challenge especially for large dimensional devices which is commonly seen in fowc design the catenary and taut mooring lines are two generally used configurations with different working principles the catenary chain line provides restoring force to the top floating structure by the weight of the suspended segments while restoring force of taut mooring line comes from line axial stretching however for large dimensional floating wecs fwecs which operate in shallow water water as compared to deepwater offshore oil and gas exploitation activities both of these two mooring configurations have some disadvantages for catenary mooring line the catenary effect is weakened in shallow water since the suspend length is limited in other word the length of the segment laid down on the seabed needs to be long enough to prevent it from being fully lifted up which is strictly forbidden for this concept as a consequence the catenary mooring line for fwecs is extremely long and with large diameter chain which increases footprint as well as cost significantly for taut mooring line with large axial stiffness material large tension peaks can frequently occur because a small movement could induce large stretching for taut mooring line in shallow water however the soft mooring rope nylon shows good performance in reducing peak tension pham et al 2019 the mooring system for large fowc should be flexible enough to prevent the large dynamic loads which could threaten system safety the hybrid mooring system ji and yuan 2015 xu et al 2019a 2018a 2018b yuan et al 2014 which was first proposed for station keeping of deepwater offshore structures has been validated and shows good performance in wec application xu et al 2018c xu and guedes soares 2020 in addition it was stated that the catenary anchor leg mooring calm or the single anchor leg mooring salm are the two most favorable solutions for large dimension wec station keeping thomsen et al 2017 2016 the mooring fatigue damage estimated is one of the crucial steps in the mooring system design process the s n and t n curve in conjunction with rainflow counting technique matsuishi and endo 1968 is the most popular method for mooring fatigue analysis xu et al 2019b xu and guedes soares 2020 yang et al 2017 2016 it is time consuming in the application of time domain rainflow counting method despite its high accuracy while the spectral methods may provide an alternative solution owing to their high efficiency among a variety of frequency domain methods the dirlik formula may be the most famous one for structural fatigue estimation dirlik 1985 its accuracy in the application of offshore structures was validated in yeter et al 2015 besides the tovo benasciutti approach is another well known wideband method benasciutti and tovo 2006 2005 tovo 2002 the performance of different spectral methods in mooring chain fatigue damage analysis is found in xue and chen 2018 however the study of spectral methods for estimating fatigue damage of synthetic mooring ropes of fwecs has not been carried out yet in the previous research studies it is seen that the dual chamber owc is an attractive device in wave energy harvesting which helps to improve energy conversion efficiency and broadens the energy capturing frequency range in this study a novel dual chamber fowc consisting of a fore owc and a rear bbdb chamber is analyzed the hydrodynamic performance of this novel device is comprehensively studied in regular and irregular wave model tests the mooring system design for large dimensional fowc device is a big challenge and related studies are rarely seen in the literature besides the influence of the mooring configuration on the hydrodynamic performance of large dimensional fowc device has not been seen in this study three flexible mooring systems including a modified calm and two compact mooring systems are designed the performance of the mooring systems as well as their influence on fowc motion responses and energy production are experimentally studied furthermore two wide band spectral methods are applied to study the fatigue damage of fowc mooring ropes by comparing to the results of rainflow counting technique the performance of these two spectral methods in the evaluations of fatigue damage of different mooring materials are investigated 2 model description and experimental set up 2 1 floating oscillating water column a novel dual chamber fowc is designed for energy conversion rezanejad and guedes soares 2019 xu et al 2020 and the 1 50 schematic model is depicted in fig 1 a which shows the fore owc chamber faced up to the incident wave the rear chamber is backward from the incident waves which interacts with the incident wave indirectly and has the identical wave absorption mechanism to the bbdb hence it will be noted as the bbdb hereafter on the top of these two chambers the specified air turbines are installed for extracting maximum energy from waves since the resonance frequencies of these two chambers are different however it is difficult to introduce a power take off pto mechanism during the hydrodynamic model tests it is cumbersome to conduct hydrodynamic model tests with pto considered besides to scale down the pto mechanism in the physical model is troublesome payne et al 2008 in this study an orifice plate is used to simulate the nonlinear air turbine pto damping and this technique has been widely applied in modelling pto damping during physical tests elhanafi et al 2017 ning et al 2020 2019 2018 in this scenario the orifice plays the role to model the air flow passing through the impulse turbines and the pressure difference is proportional to the square value of the air volume flux passing through the orifice in this work the circular orifice diameters of owc and bbdb top caps are 4 2 cm and 5 9 cm respectively fig 1 b shows the physical model of the fowc which was built in plexiglas material with a plate thickness of 1 cm the length of the fowc model is 1 24 m and the width and height are equal to 1 m and 0 6 m respectively two buoyancy chambers were designed to provide enough buoyancy to the model and the width of fore and rear buoyancy chambers are 15 cm 33 cm respectively as seen in fig 1 b the black rubber plates were placed inside the buoyancy chambers to keep the device floating at the desired draft without trim the weights of ballast in the fore real chamber are equal to 1 67 kg and 3 3 kg respectively the displacement of model is 80 kg and the draft is equal to 31 cm the coordinate of gravity centre is 0 5 cm 0 cm 29 8 cm where the origin of the coordinate system of the model is shown in fig 1 and the base line of z axis is located in the bottom of the model the main parameters of the model and full scale fowc are included in table 1 and the prototype of fowc is scaled down based on froude similitude rule the l owc and l bbdb denote the length of the owc and bbdb chambers respectively and δ is the draft δ means displacement furthermore the quantitative relations between prototype and model are given in table 2 where λ is the model scale 50 is adopted in this study γ is the ratio between sea water density and fresh water density which is equal to 1 025 and the subscript m and s denote model and full scale respectively the model results can then be transformed to full scale easily 2 2 mooring systems design two novel compact mooring configurations are designed and tested for the large dimensional energy conversion device and their sketches are shown in fig 2 it is seen in fig 2 a that the compact mooring leg is similar to the salm system the difference is an additional bottom side mooring leg is installed on the submerged mooring buoy the bottom side mooring leg plays the role to avoid the large excursion of floating device and keeps the top segment as taut to reduce the slack stretch scenarios both of these two phenomena could endanger system safety obviously this design has the merits of salm e g small footprint cost effective high flexibility besides the floating device excursion and extreme mooring loads are reduced significantly however unlike the salm double mooring legs are installed on both sides of floating device the two mooring leg present more redundancy and this compact mooring design is competent for large dimensional floating wec array in the following study the compact mooring configuration in fig 2 a is denoted as comp it is seen that the comp shows various advantages in the application of large dimensional floating wec station keeping in shallow and intermediate water however the top mooring segment may suffer snap loads in survival sea condition due the sudden slack taut events which give rise to tremendous spike tension and mooring fatigue damage xu et al 2018c xu and guedes soares 2020 in view of this a clump weight is attached on the top segment to provide additional load on fairlead and prevent the top segment from being slack the distance from the connect point of clump mass to the anchor buoy is 50 cm this design is called compw hereafter and the sketch of compw is given in fig 2 b the compact mooring leg is composed by nylon rope due to its high compliance as this material is highly recommended in the wec station keeping application wang et al 2019 weller et al 2015 xu et al 2019c the nominal diameter of the nylon rope is 3 mm and the weight per unit length in air is 4 1 g m as shown in fig 2 the length of top segment is 95 cm and the length of side vertical segment is 35 cm and 20 cm respectively the mooring radius is 1 3 m and two mooring legs are symmetrically arranged with azimuth angle setting as 0 the coordinates of 1 mooring fairlead is 10 cm 0 cm 45 8 cm where the original of coordinate system is seen in fig 1 a prior to conducting model tests the pretension of mooring rope needs to be adjusted carefully which is determined as 3 95 n and 7 16 n for comp and compw respectively fig 3 shows the clump mass and buoy models for model tests the weight of clump mass is 528 g the diameter and height of buoy is 0 39 m and 0 25 m respectively and the displacement is 6 kg the snapshots of comp during the model tests is shown in fig 3 c in addition to the compact mooring systems a novel catenary mooring system is also designed and tested this mooring system adopts the design idea of calm however some differences can be found the floating buoys are connected to the port and starboard of floating device not to the bow not to interfere with the energy conversion besides this novel design adopts two mooring buoys to keep the opening of fowc alignment with the incident wave as much as possible in the following study this mooring system is described as cat fig 4 shows the mooring lines arrangement of cat where it is seen that the mooring system consists of eight chains two hawsers and two mooring buoys which are symmetrically arranged each buoy is moored by four chains the azimuth angles of these chains are 0 45 90 and 180 respectively the hawser is made by polyester and used to connect mooring buoy to the fowc the nominal diameter of the mooring chain is 4 mm the total length of each mooring chain is 6 5 m with mooring radius setting as 6 m the weight per unit length in air of chain is 5 3 kg m the length of polyester hawser is 0 5 m its nominal diameter is 3 mm and per unit length in air is 6 5 g m the properties of mooring buoy have already been described in comp design and its draft is determined as 22 cm by adjusting proper ballast the pretension of hawser and chain was set as 0 51 n and 3 88 n respectively 2 3 experimental set up the 1 50 hydrodynamic model tests have been carried out at the wave basin of the university of porto where the length width and depth of the basin is 28 m 12 m and 1 2 m respectively the wave basin is equipped with a multifunctional wavemaker which is able to generate regular and irregular wave conditions on the opposite end a dissipative beach absorbs the incident wave the model tests were conducted according to the froude similitude rule only the head sea tests were conducted in this study fig 5 shows the experimental set up totally ten wave probes with sampling frequency setting as 40 hz were installed to measure wave elevations during model tests where the details of the arrangement are depicted in fig 5 a the deployment of cat in the model tests is shown in fig 5 b the water depth was set at 0 8 m two wave probes and two air pressure sensors were installed in the owc and bbdb chamber to measure wave elevations and air pressure inside these two chambers and the sampling frequency was set as 20 hz as shown in fig 2 two futek lsb210 load sensors were installed on the top end of compact mooring lines to record mooring tension time series and the sampling frequency of 20 hz was selected during model tests as for the cat system one of the load sensors was installed on the starboard fairlead and the other one was installed on the top end of 1 mooring chain which is one of the most loaded moorings in the head sea tests a qualisys optical motion tracking system was used to measure six degree of freedom motion responses of fowc and its sampling frequency was set as 50 hz 3 analysis methodologies 3 1 hydrodynamic performance analysis the central difference method is applied to obtain wave elevation velocities in the chambers 1 v z η i 1 η i 1 2 t s where η is the wave elevations measured by wave probes t s is the times step by noticing that the effects of air compressibility phenomenon on air volume flux calculation is small falcão and henriques 2019 2014 the instantaneous air volume rate q through the orifice is estimated by the wave elevation velocities inside chamber 2 q t v z t l b where l and b are the length and width respectively of the corresponding chamber then the instantaneous extracted pneumatic power can be evaluated 3 p t δ p t q t where δp t is the instantaneous air pressure difference in the chamber which is measured by the air pressure sensor the time averaged extracted pneumatic energy is expressed as rezanejad et al 2017 4 p e 1 t d 0 t d p t d t finally the energy conversion efficiency is determined as 5 ξ p e p w where p w is the mean incident wave energy power on fowc for the regular wave it is calculated as falnes 2002 6 p w 1 2 ρ g a 2 c g a 7 c g ω 2 k 1 2 k h sinh 2 k h where a is incident wave amplitude ρ is the water density c g is the wave group velocity k is the wave number which is calculated by the wave dispersion relation 8 w 2 g k tanh k d where d is the water depth as for the random waves the mean incident random wave energy power p rw on fowc is calculated as falnes 2002 9 p r w a ρ g 0 s ω c g ω d ω where s ω is the wave spectrum density 3 2 mooring fatigue analysis the t n curve is a convenient method for estimating mooring rope fatigue damage which is recommended by the api design codes american petroleum institute 2014 2005 the studies of applying t n curve to investigate mooring fatigue damage based on model tests can be found in xu and guedes soares 2020 according to american petroleum institute 2014 2005 the t n curve is defined as 10 n r m k where n is the number of cycles r is ratio of tension range to reference minimum breaking load mbl k and m are the intercept and slope parameters respectively these parameters are determined based on experimental results recently a series of model tests have been conducted to study the fatigue properties of nylon and polyester ropes for floating wind turbines chevillotte et al 2020 3 2 1 time domain method the time domain method is the most rigorous one in the implementation of t n curve approach to estimated mooring fatigue damage the load cycles are counted directly from mooring tension time series several load cycle counting approaches are available mainly including the rainflow counting range counting peak counting and the level crossing counting it was validated that the rainflow counting technique is that most accurate one for structural fatigue damage analysis marsh et al 2016 in this study the rainflow counting technique is applied to obtain mooring load cycles from measured mooring tension time series after removing the transient part then by applying the t n curve approach the mooring fatigue damage can be estimated according to the linear miner s rule 11 d i 1 n c n i n i where n i is the actual number of normalize tension range r i during the loading process n i is number of r i leads to mooring failure 3 2 2 frequency spectral methods the dirlik s formula is the well known empirical estimation of fatigue damage caused by gaussian broadband load process a hybrid exponential and two rayleigh distributions is utilized to approximate the rainflow amplitude probabilistic density dirlik 1985 12 f r f c d k r 1 σ x h 1 q e z q h 2 z c 2 e z 2 2 c 2 h 3 z e z 2 2 where z r σ x is the normalized amplitude r is the normalized rainflow load cycle amplitude ratio of rainflow load cycle amplitude to the mbl σ x is the significant value of normalized mooring tension ratio of mooring tension to the mbl the other parameters are defined as 13 h 1 2 x m α 2 2 1 α 2 2 h 2 1 α 2 h 1 h 1 2 1 c h 3 1 h 1 h 2 q 1 25 α 2 h 3 h 2 c h 1 x m λ 1 λ 0 λ 2 λ 4 c α 2 x m h 1 2 1 α 2 h 1 h 1 2 where λ m is the spectral moments of the normalized mooring tension process x t 14 λ m 0 ω m s x ω d ω and α 2 is the bandwidth parameter 15 α 2 λ 2 λ 0 λ 4 subsequently the expected damage rate estimated by dirlik s formula is derived 16 d d r v p k 2 σ x m h 1 q m γ 1 m 2 m 2 γ 1 m 2 h 2 c m h 3 according to eq 12 the exceedance probability of rainflow loading amplitude is expressed as benasciutti and tovo 2006 17 f r f c d k r h 1 e z q h 2 e z 2 2 c 2 h 3 e z 2 2 in addition to the dirlik approach the tovo benasciutti method is another spectral approach widely used for structural fatigue analysis the details of this approach can be found in dirlik 1985 mršnik et al 2013 however it needs to bear in mind that the mooring tension should be normalized in the implementation of t n curve approach as described in the application of dirlik s formula 4 results and discussions regular wave and irregular wave model tests have been conducted to study the hydrodynamic performance of different systems for the regular wave tests totally six wave periods were studied i e t 1 2s 1 4s 1 6s 1 8s 2 0s 2 2s additionally two wave heights h 0 04 m 0 08 m were considered in order to study the influence of wave heights on system dynamics in other words twelve regular wave tests were carried out for each system the random waves were simulated from the jonswap spectra with the peak period setting as t p 1 2s 1 4s 1 6s 1 8s the identical significant wave height h s and peak enhance factor γ were used i e h s 0 04 m γ 3 3 fig 6 presents the snap shots of different system models in the wave basin 4 1 regular wave results 4 1 1 motion responses the fowc motion response characteristics moored by different mooring systems are investigated to compare the influence of the mooring system on fowc low frequency motion responses clearly the surge and yaw motion responses in the wave condition with t 1 2s h 0 08 m are shown in fig 7 from fig 7 a it is clearly seen that the fowc drifts to a constant position under the mean drift wave force the cat has the maximum excursion since its horizontal restoring force are much smaller than the compact mooring systems the difference of drift displacement between comp and compw is negligible showing that the installed clumped weight has limited effect on mooring surge stiffness the apparent low frequency oscillations can be found in the surge motion responses due to small surge stiffness and small period wave excitation forces it indicates that the fowc behaves freely and its energy conversion activities are not affected by the mooring systems besides the fowc also oscillates in each wave period with the propagation of wave trains however the surge motion is dominated by the low frequency motion response large low frequency yaw motion can be found in cat and the wave frequency component is ignorable it is observed that compact mooring systems show better performance in restricting fowc yaw motion responses than cat for a further discussion of fowc motion responses the motion raos under different wave heights are displayed in figs 8 10 it is seen that the peak of surge raos occurs in t 1 6s and the value is around 1 1 however it is necessary to notice that this value is not the natural surge period of fowc by checking figs 9 and 10 it can be observed that the wave period has significant effect on heave and pitch motion responses the heave and pitch raos increase considerably with the wave period until the peaks appear which arises at 2s and 1 8s respectively this indicates that the natural heave period is equal to 2s and the natural pitch period is close to 1 8s checking the results of different systems it is found that the mooring system has certain effect on motion responses furthermore the influence depends on the wave height for instance the surge and pitch motion of cat are slightly greater than the compact systems in most wave conditions when the wave height is small however compared with cat the motion amplitudes of the fowc in these three degree of freedoms are increased when it is moored by comp once the wave period exceeds 1 6s and h 0 08 m the comparisons of motion raos in small and large wave conditions illustrate that the motion nonlinearities are negligible when wave period is small however the differences are noticeable when t exceeds 1 6s it can be seen that the pitch raos in the small wave height conditions h 0 04 m are greater than in large ones h 0 08 m while the contrary result is found in the heave motion raos 4 1 2 energy conversion performance as described in section 3 1 the wave elevation inside the chambers and air pressure differences determine the absorbed energy directly to study the hydrodynamic performance of different systems the wave elevations as well as air pressure in owc and bbdb in a specified sea state t 1 6s h 0 04 m are compared in fig 11 and only 10s data are plotted to show the results clearly it is observed that wave elevations in the owc chamber of the cat model are slightly greater than the system with compact mooring as for the bbdb chamber the wave elevation differences are negligible between these three systems an opposite result can be observed in δp i e there s no significant difference in the δpowc while the air pressure in the bbdb chamber of cat is the greatest among these three systems comparing the wave elevations inside these two chambers carefully it is found that the amplitude of η owc is slightly greater than η bbdb this is the reason why the resonance period of the owc is different from the bbdb in the following the wave elevation raos ratio of amplitude of wave elevation in the chamber to the incident wave amplitude are derived and given in fig 12 the notable difference between peak period of wave elevations in owc and bbdb can be seen by comparing fig 12 a with b which is 1 6s and 2s respectively besides if fig 12 is compared with fig 8 an interesting phenomenon is found it is that the peak period of wave elevations in owc is equal to the surge raos peak period furthermore the wave elevation peak period of the bbdd and the natural heave period of the fowc is identical and they are close to the natural pitch period this indicates that the heave and pitch motion responses play an important role in wave energy conversion of bbdb the influence of mooring system on wave elevations in owc is clear and depends on wave height it is seen that the wave elevation amplitudes in owc with cat are greater than the other two compact mooring systems for all tested cases when wave heights are small h 0 04 however in the large wave height conditions the η owc raos of comp are greater than cat in some specified wave periods t 1 2s 1 8s and 2s while the wave elevation raos in owc of compw are smaller than the other two systems except of the peak value where it can be observed that the peak value of compw is the greatest as for the wave elevations in bbdb the effect of mooring system is limited especially in the large wave height sea conditions since the influence of the mooring stiffness on heave and pitch motions are limited the influence of wave height on wave elevation raos inside the chambers is obvious showing that the wave elevation raos are reduced with the increase of wave height regardless of the mooring system this is because of the wave elevation in the chambers are mitigated due to the growth of viscous damping in large wave height the instantaneous pneumatic extracted energy by owc and bbdb are calculated according to eq 3 consequently their sum is the total energy produced by the fowc system to demonstrate the energy variations clearly 10s data of instant produced energy in a typical wave condition t 1 6s h 0 04 m are plotted in fig 13 it is observed that the small peak and large peak occur alternately in the extracted energy time series of owc where the small peak and large peak are around 2 5w 3 5w respectively however this phenomenon is not identified in the energy production of bbdb where it is seen that the peak values are similar and greater than 3w this implies that the bbdb shows better energy conversion efficiency than owc in this wave condition besides it can be seen that the mooring system has limited effect on energy production the differences of energy conversion times series of different systems are small if the results are carefully checked it can be observed that the cat produces slightly greater energy than the compact mooring systems both in the owc and bbdb while the energy production of comp and compw is similar the energy conversion efficiency is derived according to eq 5 to evaluate the energy production performance of this device moored by different mooring systems figs 14 and 15 shows the energy conversion efficiencies of owc and bbdb respectively and their sum are the total efficiency of fowc which is shown in fig 16 in the small wave height condition the influence of wave period on energy conversion efficiency of owc and bbdb is similar where two peaks can be seen in the efficiency curves one occurs at 1 2s and the other one appears at 1 6s this is because the resonance period of these two chambers is different besides it indicates that the hydrodynamic mutual interaction between two chambers help to improve the energy conversion efficiency even their natural periods are different by further checking the energy conversion efficiency curves in small wave heights it is found that the efficiency of owc for the cat system is slightly higher than the bbdb when the wave period is smaller than 1 4s once the wave period exceeds 1 6s it can be found that the efficiency of bbdb is much greater than owc the efficiency of owc reduces dramatically and the bbdb plays the dominant role in abstracting energy this could be the reason that the natural period of owc and bbdb is close to 1 2s and 1 6s respectively fortunately the resonance period of conventional owc device can be roughly estimated as evans and porter 1995 18 t n 2 π l g where l is average length of the chamber of the owc device that the water column has reciprocity motions inside this formula has been derived by implementing simplified hydrostatic equilibrium equations therefore it only provides a rough approximation the natural period of owc and bbdb is estimated as 1 39s and 1 75s respectively according to eq 18 which validates the assumption above furthermore it is seen that the owc and bbdb of cat has greater efficiency than compact systems when the wave period is in the range of 1 2s 1 6s however when the wave period is greater than 1 6s the influence of mooring systems on owc energy conversion is negligible while the bbdb of comp is even more efficient than cat especially when t 1 8s an interesting phenomenon can be observed with the increase of wave height the compact mooring systems are found to be superior to cat in energy absorption when h 0 08 m it is seen that both the owc and bbdb of compact mooring systems shows better hydrodynamic performance than cat in most of wave conditions besides the efficiency difference of owc between systems with compact moorings is negligible expect for the case when t 1 2s in small wave height where the compw is more efficient than comp as for the bbdb the compw produces more energy than comp in t 1 2s 1 4s especially when t 1 2s but it is less efficient than comp in t 1 6s 1 8s comparing the efficiency curves of owc and bbdb with the surge and heave raos curves in figs 8 and 9 it is observed that the influences of wave height and wave period on owc and bbdb hydrodynamic performance are similar to their influences on surge and pitch motion respectively this validates the assumption that the performance of owc is corrected with the surge motion while the heave and pitch motion is more related to the bbdb the overall efficiency of the fowc device moored by different mooring systems is plotted in fig 16 it is seen that this novel dual chamber device exhibits excellent performance in harvesting wave energy its efficiency is over 39 in a broad range of wave period 1 2s 1 8s no matter which mooring system is adopted in other words the device is capable to capture wave energy with efficiency over 39 when wave periods varying between 8 5s and 12 7s in the porotype according to the froude similarity criterion which covers most of the energetic sea states in the portuguese islands rusu and guedes soares 2012a rusu and guedes soares 2012b besides even the lowest efficiency of this device is close to 20 which indicates that the device is able to harvest energy in all tested waves states owing to the different resonance peaks of owc and bbdbd as well as their hydrodynamic mutual interaction the device operates in high efficiency between 1 2s and 1 4s the normally seen phenomenon in the other floating wec design that there is a significant reduction of energy harvesting performance when the wave period is away from the resonance period is avoided in the present concept in the small wave height the cat is the preferable design option as its energy conversion efficiency is greater than the compact systems in most wave conditions especially when the t 1 2s the efficiency of cat is almost 50 higher than compact systems however the compact systems are found to be more efficient than cat in all large wave height conditions except when t 1 4s if comparing the energy conversion efficiency of cat in different wave heights it is seen the efficiency of the device is reduced considerable in most of the major energy capture wave period zone 1 2s 1 8s with the increase of wave height part of the reason could be the viscous damping which increases with the wave height besides as seen in fig 7 b the fowc shows great yaw motion in large wave height when it is moored by cat it indicates that the energy conversion performance is highly affected by the yaw motion since the opening of device is in large difference to the propagation of incident wave during the model tests in contrast to the cat the efficiency of compact systems is improved with the wave height over all tested wave period range especially in the major energy capture wave period zone 1 2s 1 8s as a consequence the compact systems show better energy harvesting performance than cat in large wave height sea conditions the overall efficiency curves of comp and compw are close in both wave heights except when the wave period is equal to 1 2s where the difference becomes clearly visible and compw is efficient than comp this implies that the compw is preferable design to comp in terms of energy production 4 1 3 mooring tensions the hawser and chain tension raos are presented in fig 17 where it is found that the hawser has great tension raos in the low period wave conditions 1 2s and 1 4s while the tension rao of the chain increase with the wave periods the explanation is that the fowc has great low frequency motion in the small wave period sea conditions in the contrast the surge motion of the mooring buoy which is limited due to the relative large mooring restoring force as a consequence the hawser is close to taut in small wave periods and even a small motion on the top end of rope could induce large dynamic tension the chain tension is closely related to the surge motion of buoy this could be the reason that in the tested wave period range the buoy surge motion increases with the wave period since the surge response is the typical low frequency motion consequently the chain tension amplitude in large wave period is always greater than the one in small wave period the mooring tension nonlinearities can be clearly observed in fig 17 which shows significant differences between tension raos in different wave heights the main difference is found in the hawser tension raos in small wave period where the values in large wave heights could be several times the results in small wave height this difference is mainly caused by the line stretching as well as the material nonlinearity as the wave period increases the differences of tension raos in different wave heights are mitigated the mooring tension raos of compact mooring systems shown in fig 18 allows the study of the influence of clump weights on rope dynamics by comparing the results of comp against the ones of compw since the mooring ropes of compact mooring system are symmetrically arranged only the results of 1 mooring are shown it is clearly seen that the corresponding mooring tension amplitude of compw is smaller than comp in almost all tested wave conditions this indicates that the attached clump weight plays a positive role in reducing mooring tension amplitude part of the reason is that the motion of clump weight plays the role to dissipate energy which helps to reduce mooring tension xu et al 2018b the clump weight also helps to reduce the surge motion of the fowc owing to the increased restoring force in addition to these two aspects the slack taut scenario is prevented to some extent since the clump weight helps to keep the mooring rope under tension consequently the tension amplitude of compw is smaller than comp despite that the clump weight generates greater pretension the mooring tension nonlinearities can also be observed in compact mooring ropes it is seen that the tension raos in large wave height tests are several times the corresponding ones measured in small wave height tests this explains that the mooring stretching in harsh sea condition give rise to large mooring dynamics furthermore in the large wave tests it is seen that the variation of the corresponding compact mooring tension and device s energy conversion efficiency to wave period is similar this implies that the motion responses of fowc have significant influence on energy abstracting activities which validates the assumptions made above 4 2 irregular wave results the random waves were simulated from the jonswap spectra and the generated wave spectra need to be calibrated for model tests the corresponding calibrations are shown in the appendix where it is seen that the generated wave spectra are in good agreement with the target ones the hs 0 04 m for all wave spectra this indicates that generated random waves are qualified for hydrodynamic model tests 4 2 1 motion responses to help a good understanding of the horizontal motion responses of fowc moored by different mooring systems the trajectories of fowc in random waves with tp 1 4s are plotted in fig 19 it is seen that the fowc moves in a wide range when it is moored by cat due to the fact the cat is very flexible and the restoring force provided to fowc is limited in contrast to cat the horizontal motion responses of fowc are well confined by compact mooring systems figs 20 22 shows the three main motion responses of fowc moored by different mooring systems in a specified sea condition for studying the effect of mooring configuration on motion responses to show results clearly only 30s data are plotted spectral analysis is conducted to study the characteristics of motion responses carefully in fig 20 it is seen that the cat has the largest surge response due to the fact the cat provides the smallest restoring force to fowc among these mooring systems the difference of surge motion between compact systems is not clear the surge motion shows clear low frequency property which can be seen both in the time series and the spectral density the surge spectral peaks of cat comp and compw arise in 55s 36s and 35s respectively which are also the natural surge periods the natural surge period of compw is slightly greater than copm since the attached clump weights increase mooring system restoring force the heave and pitch motion responses of these studied systems are similar it is seen that the responses of cat are slightly greater than compact mooring systems if checking the figures carefully this is because the mooring stiffness in these two degrees of freedom is limited compared to the hydrostatic stiffness of fowc according to the spectral analysis results it is seen that the heave and pitch motions are dominated by the wave frequency components significant spectral densities are found in the wave frequency regions and notable spectral peaks occur close to the wave peak period besides low frequency spectral peaks can also be found in heave and pitch spectra which indicates that low frequency motion has some influence on heave and pitch responses to directly compare the responses of the fowc moored by different mooring systems the statistics of motion responses in all tested random waves are given in tables 3 6 it is observed that the main difference of motion response between different systems is the surge motion since the system surge restoring force is provided mooring systems while the fowc hydrostatic stiffness plays significant role in heave and pitch motions as a consequence under the effect of mean drift wave force the fowc is first drift to constant position and this excursion of cat is much greater than compact systems then it exhibits more strenuous responses in surge the heave motions of these systems are very close in random waves and the pitch motion of cat is slightly greater than compact systems in all tested random waves this result is consistent with the observation in regular waves 4 2 2 energy conversion performance prior to calculating the absorbed energy the wave elevations inside the chambers and pressure differences need to be checked carefully fig 23 compares the wave elevation and air pressure time series in owc and bbdb of fowc moored by different mooring systems in a typical sea state only 30s data are plotted to compare the results clearly it is observed that wave elevations and air pressures in the chambers of the different systems are very close this implies that the influence of the mooring system on fowc energy production is small however if checking the results carefully it can still be found that the wave elevations and air pressures of cat are slightly greater than compact systems besides it is seen that the air pressure inside owc and bbdb chambers between 215s and 223s are very small which is close to zero especially for the results of the owc it could be the reason that the wave elevations inside the chamber are not large enough to induce the pressure differences during this time period spectral analysis is conducted to study the wave elevations inside chambers carefully and the results are displayed in fig 24 a prominent peak occurring near the wave peak period is found in the spectral densities of wave elevations in owc and the cat has greatest spectral peak it indicates the wave elevations in owc of cat is larger than the compact systems in addition to the spectral peak close to the wave peak period another two peaks are found close to two and three times to the wave peak frequency this implies that the high order wave forces can also affect the wave elevations inside chambers the configurations of wave elevations spectra in bbdb are similar to owc except that additional spectral peaks appear on 9 95 9 91rad s which may be caused by sloshing in the bbdb the wave elevations inside the chambers of fowc in different wave conditions are evaluated by raos of the ratio of significant values ratio of significant wave height in the chambers to the hs and the results are shown in fig 25 it is observed that the variations of wave elevation amplitudes inside the chambers to wave period in random waves are similar to the results in regular waves that is the peak period of η owc is 1 6s and the η bbdb increases with the wave peak period in the tested sea conditions however the normalized wave elevation amplitudes in irregular wave are smaller than the results of regular wave in the corresponding sea conditions the results of water elevation inside the chambers show that the η owc and η bbdb of cat are greater than the values of compact systems in almost all tested sea conditions however the differences of wave elevations in bbdb between different systems are smaller than owc this finding is in accordance with the results in small wave height regular wave tests if checked carefully it is observed that the η owc and η bbdb of comp are slightly greater than compw except of the η bbdb in the sea condition with tp 1 2s to understand better the energy absorption activities of owc and bbdb the instantaneous extracted pneumatic power time series of the different chambers as well as the total system are plotted in fig 26 it is found that the duration of low energy absorption is considerably long 215s 223s and this phenomenon in owc is more notable than bbdd this is explained that the wave elevations inside chambers are not large enough to induce air pressure differences which can be validated in fig 23 the influence of mooring configuration on the extracted pneumatic power cannot be clearly identified from the time series and the time averaged extracted pneumatic energy need to be calculated to evaluate the performance of different system clearly the energy conversion efficiency of different systems in irregular waves are compared in fig 27 differently from the results in regular wave tests only one peak is found in the energy conversion efficiency curve of owc and bbdb the energy conversion efficiency peak is found in 1 4s and 1 6s for owc and bbdb which is close to the corresponding estimated natural periods by comparing the corresponding results in fig 27 a with fig 27 b it is found that the bbdb is more efficient than owc in energy production and this finding is suitable for all systems in fig 27 c it is seen that the fowc has the best energy production performance when tp 1 6s and the cat is superior to the compact systems in capturing energy this observation is consistent with the results of small wave height regular wave test as shown in fig 16 it is found that the energy conversion efficiency in irregular waves is reduced compared to the values in regular waves for most of tested sea conditions which is commonly seen in the floating wec mainly in short crested and multidirectional seas the most notable cases are tp 1 2s 1 6s for instance where it is found that the energy capturing efficiency of cat is reduced from 57 6 to 27 8 72 5 49 5 in these two periods part of the reason has been described above that the wave elevations inside the chambers are small due to small amplitude elevations of incident random waves besides the random waves include various components for the wave components that occur with the period less than 1 2s and greater than 1 6s the efficiency of the device is reduced significantly which is displayed in fig 16 as a consequence there is a considerable reduction in the energy absorption efficiency of the device in random waves within these two wave periods however the device still maintains high energy conversion efficiency in random waves it can be found that the efficiency is over 40 in the wave peak period between 1 4s and 1 8s for all systems even the lowest efficiency is greater than 25 this indicates that the device is well designed and shows favorable energy harvesting performance in most of the energetic sea states in the portuguese islands overall the energy conversion efficiency of the fowc is improved when it is moored by cat compared to the compact systems while the greatest differences are found in tp 1 4s and 1 6s where the efficiency of cat is observed to be around 4 5 and 3 greater than the compact systems besides it is seen that the energy conversion performance of compact systems is similar no significant difference between them can be found the comp is slightly efficient than compw in wave condition with wave period is equal to 1 8s while an adverse result is found when tp 1 2s 4 2 3 mooring fatigue analysis to have an overall impression of the dynamic characteristics of the chain and hawser tension the mooring tension time series in a specified sea state tp 1 4s is shown in fig 28 it is seen that the chain tension varies gently during the model tests in contrast a dramatic variation of hawser tension can be found several spike tension peaks are seen in the mooring tension time series this explains that the hawser tension is strongly associated to the fowc surge motion responses as seen in fig 20 a fowc shows intense surge response when it is moored by cat due to limited restoring force consequently the hawser tension varies significantly with fowc motion response besides the snap events could occur when the hawser undergoes prominent slack taut scenario according to the mooring tension spectra both wave frequency and low frequency components can be found however the mooring tension is dominated by the low frequency one it is seen that a prominent peak occurs in the frequency closes to the natural surge frequency of the fowc this shows that the fowc surge motion has significant influence on mooring tensions furthermore it is observed that the chain tension spectral density is much smaller than the hawser which illustrates that the hawser dynamic tension is much greater than the chain the mooring tension time series of comp are plotted against compw to study the influence of the attached clump weights on the rope dynamic tensions since the two mooring legs of compact mooring systems are symmetrically arranged only the results of 1 mooring are shown and the corresponding 30s data are plotted in fig 29 a to compare the results clearly it is seen that the mooring tension time series curve of compw is above the one of comp because compw has greater pretension than copw due to the effect of attached clump weight however in the mooring tension time series it can be clearly seen that the dynamic tension of compw is smaller than comp and this observation can be clearly identified in the comparison of mooring tension spectral densities where it is seen that the mooring tension spectral density is reduced significantly with the clump weights attached the reason that has been given in the regular wave analysis is because the attached clump weights help to reduce surge excursion of fowc as well as rope stretching the mooring tension statistics in all tested random waves are shown in tables 7 10 it is seen that the maximum tensions of the corresponding mooring rope in different sea states are close which indicates that the influence of wave peak period on extreme mooring tension is small for this device the minimum tension of the hawser is zero or close to zero for all tested sea conditions which is caused by a sudden slack scenario of the hawser during the model tests by checking the tension standard deviations it is concluded that the compact mooring tensions are most sensitive to the wave elevations especially for the comp while the chain tension shows the lowest variability this is because the compact mooring adopts the taut configuration and a small axial motion could induce large dynamic tensions johanning et al 2007 the variation of chain tension is limited in small wave height conditions since the major tension comes from the weight of the lifted up segment furthermore it is also necessary to notice that the dynamic tension of the hawser is considerable due to the slack stretching phenomena by comparing the mooring tension statistics of the compact mooring systems it is seen that maximum tensions of compw is slightly greater than comp despite of the mean tensions of comp are much smaller than compw this is explained because the attached clump weights help to reduce mooring dynamic tensions which can be validated in the comparisons of standard deviations of compact mooring tension as well as in fig 29 the 2 mooring tensions are slightly greater than 1 mooring which is because the initial conditions of these two moorings cannot be identical during the installation such as mooring length anchor positon and these differences will give rise to the differences of mooring tensions consequently furthermore by checking the kurtosis and skewness it is found the chain tensions are close to gaussian process kurtosis 3 skewness 0 while the hawser tension as well compact mooring tensions are not gaussian this implies that the spectral methods are able to present precise estimation of the chain fatigue damage since they are implemented based on gaussian assumption the rainflow counting technique is applied in conjunction with t n curve approach to study mooring fatigue damage the k and m values in the t n curve of the chain are determined to be 1000 and 3 according to api rp 2sk american petroleum institute 2005 as for the polyester k 7 5 and m 9 is adopted american petroleum institute 2014 the t n curve parameters are not found in the design codes and these two parameters are fitted by least squares method according to the experimental data in ridge et al 2010 prior to estimating mooring fatigue damage the measured mooring tensions are transferred to full scale based on the froude similitude rule the mbl of each material is then estimated based on corresponding nominal diameters in full scale xu et al 2019c which are equal to 12 000 kn 5 600 kn and 5 000 kn for chain hawser and nylon rope respectively to study the difference of fatigue damage between compact mooring ropes the expected damage rates of compact mooring ropes are shown in fig 30 where the expected damage rates are calculated by applying the rainflow counting rfc technique in time domain it is clearly seen that the fatigue damage of compw ropes are significantly lower than for comp ropes this indicates that the attached clump weight helps to reduce mooring fatigue damage considerably owing to the fact that the clump weight plays a role in reducing mooring dynamic tensions by comparing the fatigue damage of mooring ropes in the same mooring systems it can be found that the 1 mooring suffers greater damage than 2 mooring and the reason causing this difference has been stated in the above discussions furthermore it is observed that the wave peak period has a certain influence on mooring fatigue damage almost all compact mooring ropes suffer the greatest fatigue damage when the fowc operates in the wave condition with tp 1 6s i e the peak period of surge raos in the tested wave period range this implies that the surge motion is closely related to mooring fatigue damage the spectral approaches are applied to study mooring fatigue damage fig 31 presents the comparisons of exceedance probability of normalized rainflow tension amplitude in a specified sea condition to check the performance of dirlik approach as well as tovo benasciutti method in mooring fatigue estimation since the dynamic properties of 1 and 2 mooring in the compact mooring systems are similar only the results of 1 mooring are discussed it is seen that the exceedance probability of the chain rainflow tension amplitude is well predicted by the spectral approaches the empirical exceedance probabilities are well distributed along the predicted curves it indicates that both of these two spectral methods are able to present good estimations to chain fatigue damage as for the synthetic fibre ropes it is found that the spectral methods fail to produce good estimations of the exceedance probabilities of the normalized rainflow tension amplitude in the tail and the greatest discrepancy is found in the compact mooring ropes this would induce the discrepancies in mooring fatigue damage estimation when applying the spectral methods the spectral methods show different performances in estimating mooring fatigue damage for different mooring materials it is explained that the implementation of spectral methods is based on the gaussian assumption the chain tension follows gaussian process while the statistic characteristics of synthetic rope tensions are different to gaussian according to the results in tables 5 8 the expected mooring fatigue damage rate estimated by spectral methods in all tested sea conditions are compared to the rfc results and the comparisons are shown in fig 32 it is seen that the spectral methods present good estimations to chain fatigue damage in all sea conditions as expected the results are in good agreement to the rfc fatigue damage the differences between rfc mooring fatigue damage and corresponding results of spectral methods can be observed in all synthetic fibre rope cases due to the fact that the gaussian assumptions are not satisfied besides it is seen that the degree of discrepancies is related to the wave peak periods however the synthetic fibre rope fatigue damage estimated by the discussed spectral methods are still acceptable as the discrepancies are small it is also seen that the fatigue damage of synthetic fibre rope is much more sensitive to wave peak period than chain damage the influence of clump weight on nylon rope fatigue damage is clear it can be seen that the fatigue damage of compact mooring rope is reduced considerably in all tested cases with clump weight attached 5 conclusions the results have shown that in the small wave height the cat is the preferable mooring option in terms of energy absorption it can be seen that the device energy conversion efficiency is greater than the compact systems in most of wave conditions however the efficiency of fowc is improved in large wave heights when it is moored by a compact mooring system as a consequence the device is more efficient by adopting the compact mooring design in most of large wave height sea conditions the efficiency difference between comp and compw is negligible while the most significant difference is found in wave period is equal to 1 2s where it is found that compw is slightly more efficient than comp overall this novel device shows excellent performance in energy capturing it is capable to capture wave energy with efficiency over 39 when wave periods varying between 8 5s and 12 7s in the porotype according to the froude similarity criterion which covers most of the energetic sea states in the portuguese islands mooring tensions show great nonlinearities the tension raos in large wave height are much greater than small wave height on the corresponding wave period especially for the small wave period tests where the mooring tension raos are several times to the results in small wave height besides the tension nonlinearity of hawser and nylon ropes is greater than chain the main reason is the viscoelastic and viscoplastic characteristics of synthetic fibre rope which increase the nonlinearities of mooring tensions as a consequence the linear mooring tension raos fail to capture mooring dynamics precisely generally the chain tension raos increase with wave period while an opposite result is found in the compact mooring ropes the chain tensions are close to gaussian processes in all tested random waves while the synthetic fibre rope tension statistics do not follow gaussian the wave peak period influences mooring fatigue damage to certain extent almost all the compact mooring ropes suffer the greatest damage when wave peak period is equal to 1 6s owing to the effects of clump weight the fatigue damage of mooring rope of compw is reduced considerably compared to comp the fatigue damage of catenary chain needs to be taken care which is greater than that of polyester hawser and the nylon mooring rope of compw the spectral methods present very precise estimations to chain fatigue damage which are in good agreement with rainflow counting results the differences between synthetic fibre rope fatigue damage estimated by spectral methods and rainflow counting approach can be seen however the differences are small overall both the dirlik approach and tovo benasciutti method present reasonable estimations of mooring fatigue damage in small wave height sea conditions where the results of these two methods are similar in general this novel dual chamber fowc shows efficient energy conversion performance in a broad range of wave periods covering the most probable sea states in the portuguese coastal zone it is anticipated that the device efficiency can be further improved by applying control strategy to pto in terms of energy conversion the cat is the preferable mooring design for fowc in small wave height sea conditions however it is necessary to notice that the large excursions may cause to the risk of collision with other offshore structures furthermore the snap events in the hawser require great care especially in harsh sea condition in large wave heights the device moored by compact mooring system shows better energy conversion performance overall the compw is superior to comp the efficiency of these two systems are similar while a significant reduction of mooring fatigue damage can be found in compw furthermore it has been validated that these three novel mooring system designs are flexible enough and it is anticipated that they can also show good performance in the application for other large dimensional wec devices credit authorship contribution statement sheng xu methodology formal analysis writing original draft k rezanejad methodology formal analysis writing original draft j f m gadelho methodology formal analysis shan wang methodology writing review editing c guedes soares writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was financially supported by the project opwec optimizing wave energy converters with reference p2020 ptdc mar tec 6984 2014 funded by national funds through fct fundação para a ciencia e a tecnologia the work contributes to the strategic research plan of the centre for marine technology and ocean engineering centec which is financed by the portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uidb uidp 00134 2020 the third author has been funded by the university of lisbon instituto superior técnico and centec within a phd grant the authors are grateful to profs francisco taveira pinto and paulo rosa santos for their generous support and flexibility in making the experimental facilities available for this work the scientific support provided by mr daniel ruben da silva pinto clemente and mr miguel hinostroza to perform the laboratory tests are highly appreciated appendix validation of the generated jonswap time series fig a 1random wave calibration tp 1 2s hs 0 04m a wave elevations b wave spectrum fig a 2random wave calibration tp 1 4s hs 0 04m a wave elevations b wave spectrum fig a 3random wave calibration tp 1 6s hs 0 04m a wave elevations b wave spectrum fig a 4random wave calibration tp 1 8s hs 0 04m a wave elevations b wave spectrum 
21495,a series of 1 50 model tests are conducted to study the motion responses and energy harvesting performance of a novel dual chamber floating oscillating water column device moored by three flexible mooring systems in regular and irregular waves this novel energy conversion device consists of one traditional oscillating water column chamber and one backward bend duct buoy chamber the mooring systems include one modified catenary anchor leg mooring concept and two compact mooring systems designed for station keeping of this specific floating device strong nonlinearities of mooring tension are found especially in the low wave period sea conditions it is also found that the surge and yaw motion has significant differences when the device moored by the different mooring systems the pitch and heave natural periods are derived from their responses amplitude operator curves the performance of spectral methods in mooring fatigue damage estimation depends on mooring configuration and material it is seen that the attached clump weights affect the fatigue damage of the compact mooring rope it has been found that the novel device shows good performance in energy harvesting within broad range of wave periods and the influence of mooring configuration on energy conversion performance depends on the wave height keywords dual chamber floating owc modified catenary anchor leg mooring compact mooring system energy conversion efficiency mooring dynamics mooring fatigue damage 1 introduction sustainable energy has been an objective in the recent decades to deal with the problem of air pollution and energy crisis the solar and wind energy have been widely exploited in many countries in addition to these two renewable energy resources the wave energy also shows a large potential and it is getting more and more attention clément et al 2002 the wave energy converters wecs can capture energy up to 90 of the time while only 20 30 percent for wind and solar power drew et al 2009 the portuguese continental coast has rich wave resource rusu et al 2011 silva et al 2015 for example the aguçadoura has an average wave power of 40 kw m in winter silva et al 2018 besides some portuguese islands have been studied for target deployment site of wave energy harvesting such as azores islands rusu and guedes soares 2012b and madeira islands rusu et al 2008 rusu and guedes soares 2012a a variety of wec concepts have been developed for wave energy capturing and these devices can be categorized into three classes including the oscillating water columns owc overtopping devices and wave activated devices falcão 2010 guedes soares et al 2012 stationary owcs are the first generation of commercialized devices and have been developed for several decades evans 1978 an extensive review of owc development and turbine technology can be found in falcão 2015 falcão and henriques 2019 in addition to device performance evaluation on specified site lópez et al 2019 and intra annual variability of device performance lópez et al 2020 the improvement of energy conversion efficiency is another concerned issue in this context many strategies have been proposed to increase owc device energy harvesting performance rezanejad et al 2013 applied the eigenfunction expansion approach and boundary element method bem to study the influence of stepped bottom on energy conversion efficiency of stationary owc devices it was found that installing a step outside the chamber can increase the device efficiency the stepped bottom owc device was further studied experimentally and numerical by computational fluid dynamics cfd rezanejad et al 2019 it was found that the attached step helps to improve device efficiency owing to the similar effect to dual mass oscillatory system rezanejad and guedes soares 2018 experimental tests and numerical simulations based on cfd were conducted to investigate an onshore owc device with a horizontal bottom plate deng et al 2019 it was found that the length of the horizontal bottom plate has certain effect on wave energy capturing and adopting a relatively long horizontal bottom plate helps to improve the device efficiency the influence of the dimensions of the surging lip wall on hydrodynamic properties of an onshore owc device was studied based on linear wave theory deng et al 2020 it was shown that the energy capturing frequency range was broadened by installing the surging lip wall the dual chamber design is another technology used to improve owc device efficiency the significant improvement of hydrodynamic performance was found by adding an additional chamber to the single chamber owc device and the maximum improvement of capture width ratio could be 140 elhanafi et al 2018 in addition to improve energy conversion efficiency the dual chamber design also helps to increase effective frequency bandwidth ning et al 2019 a dual chamber owc sharing one air turbine was studied by two dimensional higher order boundary element method in ning et al 2017 it was found that by installing a barrier wall inside the chamber could improve the owc hydrodynamic performance when the device operates in high frequency waves however the improvement is limited a cylindrical dual chamber owc device was proposed and numerical studied in ning et al 2018 a bimodal efficiency curve was found based on the numerical simulations which indicates that the energy capturing frequency range is broadened this cylindrical dual chamber owc device was further experimentally studied ning et al 2020 based on the experiment data it was found that the deep inner chamber design helps to broaden the device efficiency frequency bandwidth while the outer chamber draft needs to be shallow in order to increase efficiency a owc design that takes the advantage of stepped bottom and dual chamber can be found in rezanejad et al 2015 by comparing the results of other type owcs it was found that efficiency of this device was improved considerably for wide range wave frequency compared to the stationary owcs the floating devices are more attractive since the wave energy density in open sea is much higher than in nearshore zones besides it was found the energy harvesting performance of floating owc was improved compared to the case when the device was fixed elhanafi et al 2017 a spar type owc concept was proposed and optimized to maximum energy capturing performance falcão et al 2012 gomes et al 2012 the effects of side walls on spar buoy owc energy capturing performance in wave channel was numerical and experimental studied gomes et al 2016 it illustrates that the wall effects amplify the capture width and viscous drag force could reduce device efficiency significantly in fact scale effects also need to considered with great care a numerical and experimental study was carried out to investigate a spar buoy owc moored by slack mooring gomes et al 2020 showing that parametric resonance need to be considered which would induce considerable discrepancies in numerical simulations the spar buoy owc array was further studied by applying experimental correia da fonseca et al 2016 and numerical oikonomou et al 2020 approaches the bem was applied to study the influence of device geometry and wave direction on fowc energy conversion efficiency rezanejad and guedes soares 2015 2014 another special floating owc fowc the backward bent duct buoy bbdb concept was first presented by yoshio masuda in 1987 to improve the energy absorption performance masuda et al 1987 an extensive review of bbdb owc is found in portillo et al 2019 the bbdb devices are installed with horizontal portion of the duct oriented backward from the incident waves so that the reverse drift motions can be observed hong et al 2004 imai et al 2009 mccormick and sheehan 1992 the bbdb is one of the best wecs concepts owing to its high efficiency lee et al 2013 wu et al 2018 and low cost of mooring nagata et al 2008 the effects of mooring configuration on the motion responses and energy conversion of a bbdb was numerically analyzed zaroudi et al 2015 and the mooring stiffness matrix was calculated by the catenary equation method the hydrodynamic performance of a bbdb device was numerically simulated by the boundary element method bem sheng 2019a and the optimization research which aims to improve bbdb device energy conversion efficiency was also conducted sheng 2019b the mooring system is the key component of floating sutures it is strongly associated to the low frequency motion responses and safety of floating structures generally the mooring system should be designed not interfere with the device energy production cost effective small footprint and high safety xu et al 2019c the mooring system design for wec is a great challenge especially for large dimensional devices which is commonly seen in fowc design the catenary and taut mooring lines are two generally used configurations with different working principles the catenary chain line provides restoring force to the top floating structure by the weight of the suspended segments while restoring force of taut mooring line comes from line axial stretching however for large dimensional floating wecs fwecs which operate in shallow water water as compared to deepwater offshore oil and gas exploitation activities both of these two mooring configurations have some disadvantages for catenary mooring line the catenary effect is weakened in shallow water since the suspend length is limited in other word the length of the segment laid down on the seabed needs to be long enough to prevent it from being fully lifted up which is strictly forbidden for this concept as a consequence the catenary mooring line for fwecs is extremely long and with large diameter chain which increases footprint as well as cost significantly for taut mooring line with large axial stiffness material large tension peaks can frequently occur because a small movement could induce large stretching for taut mooring line in shallow water however the soft mooring rope nylon shows good performance in reducing peak tension pham et al 2019 the mooring system for large fowc should be flexible enough to prevent the large dynamic loads which could threaten system safety the hybrid mooring system ji and yuan 2015 xu et al 2019a 2018a 2018b yuan et al 2014 which was first proposed for station keeping of deepwater offshore structures has been validated and shows good performance in wec application xu et al 2018c xu and guedes soares 2020 in addition it was stated that the catenary anchor leg mooring calm or the single anchor leg mooring salm are the two most favorable solutions for large dimension wec station keeping thomsen et al 2017 2016 the mooring fatigue damage estimated is one of the crucial steps in the mooring system design process the s n and t n curve in conjunction with rainflow counting technique matsuishi and endo 1968 is the most popular method for mooring fatigue analysis xu et al 2019b xu and guedes soares 2020 yang et al 2017 2016 it is time consuming in the application of time domain rainflow counting method despite its high accuracy while the spectral methods may provide an alternative solution owing to their high efficiency among a variety of frequency domain methods the dirlik formula may be the most famous one for structural fatigue estimation dirlik 1985 its accuracy in the application of offshore structures was validated in yeter et al 2015 besides the tovo benasciutti approach is another well known wideband method benasciutti and tovo 2006 2005 tovo 2002 the performance of different spectral methods in mooring chain fatigue damage analysis is found in xue and chen 2018 however the study of spectral methods for estimating fatigue damage of synthetic mooring ropes of fwecs has not been carried out yet in the previous research studies it is seen that the dual chamber owc is an attractive device in wave energy harvesting which helps to improve energy conversion efficiency and broadens the energy capturing frequency range in this study a novel dual chamber fowc consisting of a fore owc and a rear bbdb chamber is analyzed the hydrodynamic performance of this novel device is comprehensively studied in regular and irregular wave model tests the mooring system design for large dimensional fowc device is a big challenge and related studies are rarely seen in the literature besides the influence of the mooring configuration on the hydrodynamic performance of large dimensional fowc device has not been seen in this study three flexible mooring systems including a modified calm and two compact mooring systems are designed the performance of the mooring systems as well as their influence on fowc motion responses and energy production are experimentally studied furthermore two wide band spectral methods are applied to study the fatigue damage of fowc mooring ropes by comparing to the results of rainflow counting technique the performance of these two spectral methods in the evaluations of fatigue damage of different mooring materials are investigated 2 model description and experimental set up 2 1 floating oscillating water column a novel dual chamber fowc is designed for energy conversion rezanejad and guedes soares 2019 xu et al 2020 and the 1 50 schematic model is depicted in fig 1 a which shows the fore owc chamber faced up to the incident wave the rear chamber is backward from the incident waves which interacts with the incident wave indirectly and has the identical wave absorption mechanism to the bbdb hence it will be noted as the bbdb hereafter on the top of these two chambers the specified air turbines are installed for extracting maximum energy from waves since the resonance frequencies of these two chambers are different however it is difficult to introduce a power take off pto mechanism during the hydrodynamic model tests it is cumbersome to conduct hydrodynamic model tests with pto considered besides to scale down the pto mechanism in the physical model is troublesome payne et al 2008 in this study an orifice plate is used to simulate the nonlinear air turbine pto damping and this technique has been widely applied in modelling pto damping during physical tests elhanafi et al 2017 ning et al 2020 2019 2018 in this scenario the orifice plays the role to model the air flow passing through the impulse turbines and the pressure difference is proportional to the square value of the air volume flux passing through the orifice in this work the circular orifice diameters of owc and bbdb top caps are 4 2 cm and 5 9 cm respectively fig 1 b shows the physical model of the fowc which was built in plexiglas material with a plate thickness of 1 cm the length of the fowc model is 1 24 m and the width and height are equal to 1 m and 0 6 m respectively two buoyancy chambers were designed to provide enough buoyancy to the model and the width of fore and rear buoyancy chambers are 15 cm 33 cm respectively as seen in fig 1 b the black rubber plates were placed inside the buoyancy chambers to keep the device floating at the desired draft without trim the weights of ballast in the fore real chamber are equal to 1 67 kg and 3 3 kg respectively the displacement of model is 80 kg and the draft is equal to 31 cm the coordinate of gravity centre is 0 5 cm 0 cm 29 8 cm where the origin of the coordinate system of the model is shown in fig 1 and the base line of z axis is located in the bottom of the model the main parameters of the model and full scale fowc are included in table 1 and the prototype of fowc is scaled down based on froude similitude rule the l owc and l bbdb denote the length of the owc and bbdb chambers respectively and δ is the draft δ means displacement furthermore the quantitative relations between prototype and model are given in table 2 where λ is the model scale 50 is adopted in this study γ is the ratio between sea water density and fresh water density which is equal to 1 025 and the subscript m and s denote model and full scale respectively the model results can then be transformed to full scale easily 2 2 mooring systems design two novel compact mooring configurations are designed and tested for the large dimensional energy conversion device and their sketches are shown in fig 2 it is seen in fig 2 a that the compact mooring leg is similar to the salm system the difference is an additional bottom side mooring leg is installed on the submerged mooring buoy the bottom side mooring leg plays the role to avoid the large excursion of floating device and keeps the top segment as taut to reduce the slack stretch scenarios both of these two phenomena could endanger system safety obviously this design has the merits of salm e g small footprint cost effective high flexibility besides the floating device excursion and extreme mooring loads are reduced significantly however unlike the salm double mooring legs are installed on both sides of floating device the two mooring leg present more redundancy and this compact mooring design is competent for large dimensional floating wec array in the following study the compact mooring configuration in fig 2 a is denoted as comp it is seen that the comp shows various advantages in the application of large dimensional floating wec station keeping in shallow and intermediate water however the top mooring segment may suffer snap loads in survival sea condition due the sudden slack taut events which give rise to tremendous spike tension and mooring fatigue damage xu et al 2018c xu and guedes soares 2020 in view of this a clump weight is attached on the top segment to provide additional load on fairlead and prevent the top segment from being slack the distance from the connect point of clump mass to the anchor buoy is 50 cm this design is called compw hereafter and the sketch of compw is given in fig 2 b the compact mooring leg is composed by nylon rope due to its high compliance as this material is highly recommended in the wec station keeping application wang et al 2019 weller et al 2015 xu et al 2019c the nominal diameter of the nylon rope is 3 mm and the weight per unit length in air is 4 1 g m as shown in fig 2 the length of top segment is 95 cm and the length of side vertical segment is 35 cm and 20 cm respectively the mooring radius is 1 3 m and two mooring legs are symmetrically arranged with azimuth angle setting as 0 the coordinates of 1 mooring fairlead is 10 cm 0 cm 45 8 cm where the original of coordinate system is seen in fig 1 a prior to conducting model tests the pretension of mooring rope needs to be adjusted carefully which is determined as 3 95 n and 7 16 n for comp and compw respectively fig 3 shows the clump mass and buoy models for model tests the weight of clump mass is 528 g the diameter and height of buoy is 0 39 m and 0 25 m respectively and the displacement is 6 kg the snapshots of comp during the model tests is shown in fig 3 c in addition to the compact mooring systems a novel catenary mooring system is also designed and tested this mooring system adopts the design idea of calm however some differences can be found the floating buoys are connected to the port and starboard of floating device not to the bow not to interfere with the energy conversion besides this novel design adopts two mooring buoys to keep the opening of fowc alignment with the incident wave as much as possible in the following study this mooring system is described as cat fig 4 shows the mooring lines arrangement of cat where it is seen that the mooring system consists of eight chains two hawsers and two mooring buoys which are symmetrically arranged each buoy is moored by four chains the azimuth angles of these chains are 0 45 90 and 180 respectively the hawser is made by polyester and used to connect mooring buoy to the fowc the nominal diameter of the mooring chain is 4 mm the total length of each mooring chain is 6 5 m with mooring radius setting as 6 m the weight per unit length in air of chain is 5 3 kg m the length of polyester hawser is 0 5 m its nominal diameter is 3 mm and per unit length in air is 6 5 g m the properties of mooring buoy have already been described in comp design and its draft is determined as 22 cm by adjusting proper ballast the pretension of hawser and chain was set as 0 51 n and 3 88 n respectively 2 3 experimental set up the 1 50 hydrodynamic model tests have been carried out at the wave basin of the university of porto where the length width and depth of the basin is 28 m 12 m and 1 2 m respectively the wave basin is equipped with a multifunctional wavemaker which is able to generate regular and irregular wave conditions on the opposite end a dissipative beach absorbs the incident wave the model tests were conducted according to the froude similitude rule only the head sea tests were conducted in this study fig 5 shows the experimental set up totally ten wave probes with sampling frequency setting as 40 hz were installed to measure wave elevations during model tests where the details of the arrangement are depicted in fig 5 a the deployment of cat in the model tests is shown in fig 5 b the water depth was set at 0 8 m two wave probes and two air pressure sensors were installed in the owc and bbdb chamber to measure wave elevations and air pressure inside these two chambers and the sampling frequency was set as 20 hz as shown in fig 2 two futek lsb210 load sensors were installed on the top end of compact mooring lines to record mooring tension time series and the sampling frequency of 20 hz was selected during model tests as for the cat system one of the load sensors was installed on the starboard fairlead and the other one was installed on the top end of 1 mooring chain which is one of the most loaded moorings in the head sea tests a qualisys optical motion tracking system was used to measure six degree of freedom motion responses of fowc and its sampling frequency was set as 50 hz 3 analysis methodologies 3 1 hydrodynamic performance analysis the central difference method is applied to obtain wave elevation velocities in the chambers 1 v z η i 1 η i 1 2 t s where η is the wave elevations measured by wave probes t s is the times step by noticing that the effects of air compressibility phenomenon on air volume flux calculation is small falcão and henriques 2019 2014 the instantaneous air volume rate q through the orifice is estimated by the wave elevation velocities inside chamber 2 q t v z t l b where l and b are the length and width respectively of the corresponding chamber then the instantaneous extracted pneumatic power can be evaluated 3 p t δ p t q t where δp t is the instantaneous air pressure difference in the chamber which is measured by the air pressure sensor the time averaged extracted pneumatic energy is expressed as rezanejad et al 2017 4 p e 1 t d 0 t d p t d t finally the energy conversion efficiency is determined as 5 ξ p e p w where p w is the mean incident wave energy power on fowc for the regular wave it is calculated as falnes 2002 6 p w 1 2 ρ g a 2 c g a 7 c g ω 2 k 1 2 k h sinh 2 k h where a is incident wave amplitude ρ is the water density c g is the wave group velocity k is the wave number which is calculated by the wave dispersion relation 8 w 2 g k tanh k d where d is the water depth as for the random waves the mean incident random wave energy power p rw on fowc is calculated as falnes 2002 9 p r w a ρ g 0 s ω c g ω d ω where s ω is the wave spectrum density 3 2 mooring fatigue analysis the t n curve is a convenient method for estimating mooring rope fatigue damage which is recommended by the api design codes american petroleum institute 2014 2005 the studies of applying t n curve to investigate mooring fatigue damage based on model tests can be found in xu and guedes soares 2020 according to american petroleum institute 2014 2005 the t n curve is defined as 10 n r m k where n is the number of cycles r is ratio of tension range to reference minimum breaking load mbl k and m are the intercept and slope parameters respectively these parameters are determined based on experimental results recently a series of model tests have been conducted to study the fatigue properties of nylon and polyester ropes for floating wind turbines chevillotte et al 2020 3 2 1 time domain method the time domain method is the most rigorous one in the implementation of t n curve approach to estimated mooring fatigue damage the load cycles are counted directly from mooring tension time series several load cycle counting approaches are available mainly including the rainflow counting range counting peak counting and the level crossing counting it was validated that the rainflow counting technique is that most accurate one for structural fatigue damage analysis marsh et al 2016 in this study the rainflow counting technique is applied to obtain mooring load cycles from measured mooring tension time series after removing the transient part then by applying the t n curve approach the mooring fatigue damage can be estimated according to the linear miner s rule 11 d i 1 n c n i n i where n i is the actual number of normalize tension range r i during the loading process n i is number of r i leads to mooring failure 3 2 2 frequency spectral methods the dirlik s formula is the well known empirical estimation of fatigue damage caused by gaussian broadband load process a hybrid exponential and two rayleigh distributions is utilized to approximate the rainflow amplitude probabilistic density dirlik 1985 12 f r f c d k r 1 σ x h 1 q e z q h 2 z c 2 e z 2 2 c 2 h 3 z e z 2 2 where z r σ x is the normalized amplitude r is the normalized rainflow load cycle amplitude ratio of rainflow load cycle amplitude to the mbl σ x is the significant value of normalized mooring tension ratio of mooring tension to the mbl the other parameters are defined as 13 h 1 2 x m α 2 2 1 α 2 2 h 2 1 α 2 h 1 h 1 2 1 c h 3 1 h 1 h 2 q 1 25 α 2 h 3 h 2 c h 1 x m λ 1 λ 0 λ 2 λ 4 c α 2 x m h 1 2 1 α 2 h 1 h 1 2 where λ m is the spectral moments of the normalized mooring tension process x t 14 λ m 0 ω m s x ω d ω and α 2 is the bandwidth parameter 15 α 2 λ 2 λ 0 λ 4 subsequently the expected damage rate estimated by dirlik s formula is derived 16 d d r v p k 2 σ x m h 1 q m γ 1 m 2 m 2 γ 1 m 2 h 2 c m h 3 according to eq 12 the exceedance probability of rainflow loading amplitude is expressed as benasciutti and tovo 2006 17 f r f c d k r h 1 e z q h 2 e z 2 2 c 2 h 3 e z 2 2 in addition to the dirlik approach the tovo benasciutti method is another spectral approach widely used for structural fatigue analysis the details of this approach can be found in dirlik 1985 mršnik et al 2013 however it needs to bear in mind that the mooring tension should be normalized in the implementation of t n curve approach as described in the application of dirlik s formula 4 results and discussions regular wave and irregular wave model tests have been conducted to study the hydrodynamic performance of different systems for the regular wave tests totally six wave periods were studied i e t 1 2s 1 4s 1 6s 1 8s 2 0s 2 2s additionally two wave heights h 0 04 m 0 08 m were considered in order to study the influence of wave heights on system dynamics in other words twelve regular wave tests were carried out for each system the random waves were simulated from the jonswap spectra with the peak period setting as t p 1 2s 1 4s 1 6s 1 8s the identical significant wave height h s and peak enhance factor γ were used i e h s 0 04 m γ 3 3 fig 6 presents the snap shots of different system models in the wave basin 4 1 regular wave results 4 1 1 motion responses the fowc motion response characteristics moored by different mooring systems are investigated to compare the influence of the mooring system on fowc low frequency motion responses clearly the surge and yaw motion responses in the wave condition with t 1 2s h 0 08 m are shown in fig 7 from fig 7 a it is clearly seen that the fowc drifts to a constant position under the mean drift wave force the cat has the maximum excursion since its horizontal restoring force are much smaller than the compact mooring systems the difference of drift displacement between comp and compw is negligible showing that the installed clumped weight has limited effect on mooring surge stiffness the apparent low frequency oscillations can be found in the surge motion responses due to small surge stiffness and small period wave excitation forces it indicates that the fowc behaves freely and its energy conversion activities are not affected by the mooring systems besides the fowc also oscillates in each wave period with the propagation of wave trains however the surge motion is dominated by the low frequency motion response large low frequency yaw motion can be found in cat and the wave frequency component is ignorable it is observed that compact mooring systems show better performance in restricting fowc yaw motion responses than cat for a further discussion of fowc motion responses the motion raos under different wave heights are displayed in figs 8 10 it is seen that the peak of surge raos occurs in t 1 6s and the value is around 1 1 however it is necessary to notice that this value is not the natural surge period of fowc by checking figs 9 and 10 it can be observed that the wave period has significant effect on heave and pitch motion responses the heave and pitch raos increase considerably with the wave period until the peaks appear which arises at 2s and 1 8s respectively this indicates that the natural heave period is equal to 2s and the natural pitch period is close to 1 8s checking the results of different systems it is found that the mooring system has certain effect on motion responses furthermore the influence depends on the wave height for instance the surge and pitch motion of cat are slightly greater than the compact systems in most wave conditions when the wave height is small however compared with cat the motion amplitudes of the fowc in these three degree of freedoms are increased when it is moored by comp once the wave period exceeds 1 6s and h 0 08 m the comparisons of motion raos in small and large wave conditions illustrate that the motion nonlinearities are negligible when wave period is small however the differences are noticeable when t exceeds 1 6s it can be seen that the pitch raos in the small wave height conditions h 0 04 m are greater than in large ones h 0 08 m while the contrary result is found in the heave motion raos 4 1 2 energy conversion performance as described in section 3 1 the wave elevation inside the chambers and air pressure differences determine the absorbed energy directly to study the hydrodynamic performance of different systems the wave elevations as well as air pressure in owc and bbdb in a specified sea state t 1 6s h 0 04 m are compared in fig 11 and only 10s data are plotted to show the results clearly it is observed that wave elevations in the owc chamber of the cat model are slightly greater than the system with compact mooring as for the bbdb chamber the wave elevation differences are negligible between these three systems an opposite result can be observed in δp i e there s no significant difference in the δpowc while the air pressure in the bbdb chamber of cat is the greatest among these three systems comparing the wave elevations inside these two chambers carefully it is found that the amplitude of η owc is slightly greater than η bbdb this is the reason why the resonance period of the owc is different from the bbdb in the following the wave elevation raos ratio of amplitude of wave elevation in the chamber to the incident wave amplitude are derived and given in fig 12 the notable difference between peak period of wave elevations in owc and bbdb can be seen by comparing fig 12 a with b which is 1 6s and 2s respectively besides if fig 12 is compared with fig 8 an interesting phenomenon is found it is that the peak period of wave elevations in owc is equal to the surge raos peak period furthermore the wave elevation peak period of the bbdd and the natural heave period of the fowc is identical and they are close to the natural pitch period this indicates that the heave and pitch motion responses play an important role in wave energy conversion of bbdb the influence of mooring system on wave elevations in owc is clear and depends on wave height it is seen that the wave elevation amplitudes in owc with cat are greater than the other two compact mooring systems for all tested cases when wave heights are small h 0 04 however in the large wave height conditions the η owc raos of comp are greater than cat in some specified wave periods t 1 2s 1 8s and 2s while the wave elevation raos in owc of compw are smaller than the other two systems except of the peak value where it can be observed that the peak value of compw is the greatest as for the wave elevations in bbdb the effect of mooring system is limited especially in the large wave height sea conditions since the influence of the mooring stiffness on heave and pitch motions are limited the influence of wave height on wave elevation raos inside the chambers is obvious showing that the wave elevation raos are reduced with the increase of wave height regardless of the mooring system this is because of the wave elevation in the chambers are mitigated due to the growth of viscous damping in large wave height the instantaneous pneumatic extracted energy by owc and bbdb are calculated according to eq 3 consequently their sum is the total energy produced by the fowc system to demonstrate the energy variations clearly 10s data of instant produced energy in a typical wave condition t 1 6s h 0 04 m are plotted in fig 13 it is observed that the small peak and large peak occur alternately in the extracted energy time series of owc where the small peak and large peak are around 2 5w 3 5w respectively however this phenomenon is not identified in the energy production of bbdb where it is seen that the peak values are similar and greater than 3w this implies that the bbdb shows better energy conversion efficiency than owc in this wave condition besides it can be seen that the mooring system has limited effect on energy production the differences of energy conversion times series of different systems are small if the results are carefully checked it can be observed that the cat produces slightly greater energy than the compact mooring systems both in the owc and bbdb while the energy production of comp and compw is similar the energy conversion efficiency is derived according to eq 5 to evaluate the energy production performance of this device moored by different mooring systems figs 14 and 15 shows the energy conversion efficiencies of owc and bbdb respectively and their sum are the total efficiency of fowc which is shown in fig 16 in the small wave height condition the influence of wave period on energy conversion efficiency of owc and bbdb is similar where two peaks can be seen in the efficiency curves one occurs at 1 2s and the other one appears at 1 6s this is because the resonance period of these two chambers is different besides it indicates that the hydrodynamic mutual interaction between two chambers help to improve the energy conversion efficiency even their natural periods are different by further checking the energy conversion efficiency curves in small wave heights it is found that the efficiency of owc for the cat system is slightly higher than the bbdb when the wave period is smaller than 1 4s once the wave period exceeds 1 6s it can be found that the efficiency of bbdb is much greater than owc the efficiency of owc reduces dramatically and the bbdb plays the dominant role in abstracting energy this could be the reason that the natural period of owc and bbdb is close to 1 2s and 1 6s respectively fortunately the resonance period of conventional owc device can be roughly estimated as evans and porter 1995 18 t n 2 π l g where l is average length of the chamber of the owc device that the water column has reciprocity motions inside this formula has been derived by implementing simplified hydrostatic equilibrium equations therefore it only provides a rough approximation the natural period of owc and bbdb is estimated as 1 39s and 1 75s respectively according to eq 18 which validates the assumption above furthermore it is seen that the owc and bbdb of cat has greater efficiency than compact systems when the wave period is in the range of 1 2s 1 6s however when the wave period is greater than 1 6s the influence of mooring systems on owc energy conversion is negligible while the bbdb of comp is even more efficient than cat especially when t 1 8s an interesting phenomenon can be observed with the increase of wave height the compact mooring systems are found to be superior to cat in energy absorption when h 0 08 m it is seen that both the owc and bbdb of compact mooring systems shows better hydrodynamic performance than cat in most of wave conditions besides the efficiency difference of owc between systems with compact moorings is negligible expect for the case when t 1 2s in small wave height where the compw is more efficient than comp as for the bbdb the compw produces more energy than comp in t 1 2s 1 4s especially when t 1 2s but it is less efficient than comp in t 1 6s 1 8s comparing the efficiency curves of owc and bbdb with the surge and heave raos curves in figs 8 and 9 it is observed that the influences of wave height and wave period on owc and bbdb hydrodynamic performance are similar to their influences on surge and pitch motion respectively this validates the assumption that the performance of owc is corrected with the surge motion while the heave and pitch motion is more related to the bbdb the overall efficiency of the fowc device moored by different mooring systems is plotted in fig 16 it is seen that this novel dual chamber device exhibits excellent performance in harvesting wave energy its efficiency is over 39 in a broad range of wave period 1 2s 1 8s no matter which mooring system is adopted in other words the device is capable to capture wave energy with efficiency over 39 when wave periods varying between 8 5s and 12 7s in the porotype according to the froude similarity criterion which covers most of the energetic sea states in the portuguese islands rusu and guedes soares 2012a rusu and guedes soares 2012b besides even the lowest efficiency of this device is close to 20 which indicates that the device is able to harvest energy in all tested waves states owing to the different resonance peaks of owc and bbdbd as well as their hydrodynamic mutual interaction the device operates in high efficiency between 1 2s and 1 4s the normally seen phenomenon in the other floating wec design that there is a significant reduction of energy harvesting performance when the wave period is away from the resonance period is avoided in the present concept in the small wave height the cat is the preferable design option as its energy conversion efficiency is greater than the compact systems in most wave conditions especially when the t 1 2s the efficiency of cat is almost 50 higher than compact systems however the compact systems are found to be more efficient than cat in all large wave height conditions except when t 1 4s if comparing the energy conversion efficiency of cat in different wave heights it is seen the efficiency of the device is reduced considerable in most of the major energy capture wave period zone 1 2s 1 8s with the increase of wave height part of the reason could be the viscous damping which increases with the wave height besides as seen in fig 7 b the fowc shows great yaw motion in large wave height when it is moored by cat it indicates that the energy conversion performance is highly affected by the yaw motion since the opening of device is in large difference to the propagation of incident wave during the model tests in contrast to the cat the efficiency of compact systems is improved with the wave height over all tested wave period range especially in the major energy capture wave period zone 1 2s 1 8s as a consequence the compact systems show better energy harvesting performance than cat in large wave height sea conditions the overall efficiency curves of comp and compw are close in both wave heights except when the wave period is equal to 1 2s where the difference becomes clearly visible and compw is efficient than comp this implies that the compw is preferable design to comp in terms of energy production 4 1 3 mooring tensions the hawser and chain tension raos are presented in fig 17 where it is found that the hawser has great tension raos in the low period wave conditions 1 2s and 1 4s while the tension rao of the chain increase with the wave periods the explanation is that the fowc has great low frequency motion in the small wave period sea conditions in the contrast the surge motion of the mooring buoy which is limited due to the relative large mooring restoring force as a consequence the hawser is close to taut in small wave periods and even a small motion on the top end of rope could induce large dynamic tension the chain tension is closely related to the surge motion of buoy this could be the reason that in the tested wave period range the buoy surge motion increases with the wave period since the surge response is the typical low frequency motion consequently the chain tension amplitude in large wave period is always greater than the one in small wave period the mooring tension nonlinearities can be clearly observed in fig 17 which shows significant differences between tension raos in different wave heights the main difference is found in the hawser tension raos in small wave period where the values in large wave heights could be several times the results in small wave height this difference is mainly caused by the line stretching as well as the material nonlinearity as the wave period increases the differences of tension raos in different wave heights are mitigated the mooring tension raos of compact mooring systems shown in fig 18 allows the study of the influence of clump weights on rope dynamics by comparing the results of comp against the ones of compw since the mooring ropes of compact mooring system are symmetrically arranged only the results of 1 mooring are shown it is clearly seen that the corresponding mooring tension amplitude of compw is smaller than comp in almost all tested wave conditions this indicates that the attached clump weight plays a positive role in reducing mooring tension amplitude part of the reason is that the motion of clump weight plays the role to dissipate energy which helps to reduce mooring tension xu et al 2018b the clump weight also helps to reduce the surge motion of the fowc owing to the increased restoring force in addition to these two aspects the slack taut scenario is prevented to some extent since the clump weight helps to keep the mooring rope under tension consequently the tension amplitude of compw is smaller than comp despite that the clump weight generates greater pretension the mooring tension nonlinearities can also be observed in compact mooring ropes it is seen that the tension raos in large wave height tests are several times the corresponding ones measured in small wave height tests this explains that the mooring stretching in harsh sea condition give rise to large mooring dynamics furthermore in the large wave tests it is seen that the variation of the corresponding compact mooring tension and device s energy conversion efficiency to wave period is similar this implies that the motion responses of fowc have significant influence on energy abstracting activities which validates the assumptions made above 4 2 irregular wave results the random waves were simulated from the jonswap spectra and the generated wave spectra need to be calibrated for model tests the corresponding calibrations are shown in the appendix where it is seen that the generated wave spectra are in good agreement with the target ones the hs 0 04 m for all wave spectra this indicates that generated random waves are qualified for hydrodynamic model tests 4 2 1 motion responses to help a good understanding of the horizontal motion responses of fowc moored by different mooring systems the trajectories of fowc in random waves with tp 1 4s are plotted in fig 19 it is seen that the fowc moves in a wide range when it is moored by cat due to the fact the cat is very flexible and the restoring force provided to fowc is limited in contrast to cat the horizontal motion responses of fowc are well confined by compact mooring systems figs 20 22 shows the three main motion responses of fowc moored by different mooring systems in a specified sea condition for studying the effect of mooring configuration on motion responses to show results clearly only 30s data are plotted spectral analysis is conducted to study the characteristics of motion responses carefully in fig 20 it is seen that the cat has the largest surge response due to the fact the cat provides the smallest restoring force to fowc among these mooring systems the difference of surge motion between compact systems is not clear the surge motion shows clear low frequency property which can be seen both in the time series and the spectral density the surge spectral peaks of cat comp and compw arise in 55s 36s and 35s respectively which are also the natural surge periods the natural surge period of compw is slightly greater than copm since the attached clump weights increase mooring system restoring force the heave and pitch motion responses of these studied systems are similar it is seen that the responses of cat are slightly greater than compact mooring systems if checking the figures carefully this is because the mooring stiffness in these two degrees of freedom is limited compared to the hydrostatic stiffness of fowc according to the spectral analysis results it is seen that the heave and pitch motions are dominated by the wave frequency components significant spectral densities are found in the wave frequency regions and notable spectral peaks occur close to the wave peak period besides low frequency spectral peaks can also be found in heave and pitch spectra which indicates that low frequency motion has some influence on heave and pitch responses to directly compare the responses of the fowc moored by different mooring systems the statistics of motion responses in all tested random waves are given in tables 3 6 it is observed that the main difference of motion response between different systems is the surge motion since the system surge restoring force is provided mooring systems while the fowc hydrostatic stiffness plays significant role in heave and pitch motions as a consequence under the effect of mean drift wave force the fowc is first drift to constant position and this excursion of cat is much greater than compact systems then it exhibits more strenuous responses in surge the heave motions of these systems are very close in random waves and the pitch motion of cat is slightly greater than compact systems in all tested random waves this result is consistent with the observation in regular waves 4 2 2 energy conversion performance prior to calculating the absorbed energy the wave elevations inside the chambers and pressure differences need to be checked carefully fig 23 compares the wave elevation and air pressure time series in owc and bbdb of fowc moored by different mooring systems in a typical sea state only 30s data are plotted to compare the results clearly it is observed that wave elevations and air pressures in the chambers of the different systems are very close this implies that the influence of the mooring system on fowc energy production is small however if checking the results carefully it can still be found that the wave elevations and air pressures of cat are slightly greater than compact systems besides it is seen that the air pressure inside owc and bbdb chambers between 215s and 223s are very small which is close to zero especially for the results of the owc it could be the reason that the wave elevations inside the chamber are not large enough to induce the pressure differences during this time period spectral analysis is conducted to study the wave elevations inside chambers carefully and the results are displayed in fig 24 a prominent peak occurring near the wave peak period is found in the spectral densities of wave elevations in owc and the cat has greatest spectral peak it indicates the wave elevations in owc of cat is larger than the compact systems in addition to the spectral peak close to the wave peak period another two peaks are found close to two and three times to the wave peak frequency this implies that the high order wave forces can also affect the wave elevations inside chambers the configurations of wave elevations spectra in bbdb are similar to owc except that additional spectral peaks appear on 9 95 9 91rad s which may be caused by sloshing in the bbdb the wave elevations inside the chambers of fowc in different wave conditions are evaluated by raos of the ratio of significant values ratio of significant wave height in the chambers to the hs and the results are shown in fig 25 it is observed that the variations of wave elevation amplitudes inside the chambers to wave period in random waves are similar to the results in regular waves that is the peak period of η owc is 1 6s and the η bbdb increases with the wave peak period in the tested sea conditions however the normalized wave elevation amplitudes in irregular wave are smaller than the results of regular wave in the corresponding sea conditions the results of water elevation inside the chambers show that the η owc and η bbdb of cat are greater than the values of compact systems in almost all tested sea conditions however the differences of wave elevations in bbdb between different systems are smaller than owc this finding is in accordance with the results in small wave height regular wave tests if checked carefully it is observed that the η owc and η bbdb of comp are slightly greater than compw except of the η bbdb in the sea condition with tp 1 2s to understand better the energy absorption activities of owc and bbdb the instantaneous extracted pneumatic power time series of the different chambers as well as the total system are plotted in fig 26 it is found that the duration of low energy absorption is considerably long 215s 223s and this phenomenon in owc is more notable than bbdd this is explained that the wave elevations inside chambers are not large enough to induce air pressure differences which can be validated in fig 23 the influence of mooring configuration on the extracted pneumatic power cannot be clearly identified from the time series and the time averaged extracted pneumatic energy need to be calculated to evaluate the performance of different system clearly the energy conversion efficiency of different systems in irregular waves are compared in fig 27 differently from the results in regular wave tests only one peak is found in the energy conversion efficiency curve of owc and bbdb the energy conversion efficiency peak is found in 1 4s and 1 6s for owc and bbdb which is close to the corresponding estimated natural periods by comparing the corresponding results in fig 27 a with fig 27 b it is found that the bbdb is more efficient than owc in energy production and this finding is suitable for all systems in fig 27 c it is seen that the fowc has the best energy production performance when tp 1 6s and the cat is superior to the compact systems in capturing energy this observation is consistent with the results of small wave height regular wave test as shown in fig 16 it is found that the energy conversion efficiency in irregular waves is reduced compared to the values in regular waves for most of tested sea conditions which is commonly seen in the floating wec mainly in short crested and multidirectional seas the most notable cases are tp 1 2s 1 6s for instance where it is found that the energy capturing efficiency of cat is reduced from 57 6 to 27 8 72 5 49 5 in these two periods part of the reason has been described above that the wave elevations inside the chambers are small due to small amplitude elevations of incident random waves besides the random waves include various components for the wave components that occur with the period less than 1 2s and greater than 1 6s the efficiency of the device is reduced significantly which is displayed in fig 16 as a consequence there is a considerable reduction in the energy absorption efficiency of the device in random waves within these two wave periods however the device still maintains high energy conversion efficiency in random waves it can be found that the efficiency is over 40 in the wave peak period between 1 4s and 1 8s for all systems even the lowest efficiency is greater than 25 this indicates that the device is well designed and shows favorable energy harvesting performance in most of the energetic sea states in the portuguese islands overall the energy conversion efficiency of the fowc is improved when it is moored by cat compared to the compact systems while the greatest differences are found in tp 1 4s and 1 6s where the efficiency of cat is observed to be around 4 5 and 3 greater than the compact systems besides it is seen that the energy conversion performance of compact systems is similar no significant difference between them can be found the comp is slightly efficient than compw in wave condition with wave period is equal to 1 8s while an adverse result is found when tp 1 2s 4 2 3 mooring fatigue analysis to have an overall impression of the dynamic characteristics of the chain and hawser tension the mooring tension time series in a specified sea state tp 1 4s is shown in fig 28 it is seen that the chain tension varies gently during the model tests in contrast a dramatic variation of hawser tension can be found several spike tension peaks are seen in the mooring tension time series this explains that the hawser tension is strongly associated to the fowc surge motion responses as seen in fig 20 a fowc shows intense surge response when it is moored by cat due to limited restoring force consequently the hawser tension varies significantly with fowc motion response besides the snap events could occur when the hawser undergoes prominent slack taut scenario according to the mooring tension spectra both wave frequency and low frequency components can be found however the mooring tension is dominated by the low frequency one it is seen that a prominent peak occurs in the frequency closes to the natural surge frequency of the fowc this shows that the fowc surge motion has significant influence on mooring tensions furthermore it is observed that the chain tension spectral density is much smaller than the hawser which illustrates that the hawser dynamic tension is much greater than the chain the mooring tension time series of comp are plotted against compw to study the influence of the attached clump weights on the rope dynamic tensions since the two mooring legs of compact mooring systems are symmetrically arranged only the results of 1 mooring are shown and the corresponding 30s data are plotted in fig 29 a to compare the results clearly it is seen that the mooring tension time series curve of compw is above the one of comp because compw has greater pretension than copw due to the effect of attached clump weight however in the mooring tension time series it can be clearly seen that the dynamic tension of compw is smaller than comp and this observation can be clearly identified in the comparison of mooring tension spectral densities where it is seen that the mooring tension spectral density is reduced significantly with the clump weights attached the reason that has been given in the regular wave analysis is because the attached clump weights help to reduce surge excursion of fowc as well as rope stretching the mooring tension statistics in all tested random waves are shown in tables 7 10 it is seen that the maximum tensions of the corresponding mooring rope in different sea states are close which indicates that the influence of wave peak period on extreme mooring tension is small for this device the minimum tension of the hawser is zero or close to zero for all tested sea conditions which is caused by a sudden slack scenario of the hawser during the model tests by checking the tension standard deviations it is concluded that the compact mooring tensions are most sensitive to the wave elevations especially for the comp while the chain tension shows the lowest variability this is because the compact mooring adopts the taut configuration and a small axial motion could induce large dynamic tensions johanning et al 2007 the variation of chain tension is limited in small wave height conditions since the major tension comes from the weight of the lifted up segment furthermore it is also necessary to notice that the dynamic tension of the hawser is considerable due to the slack stretching phenomena by comparing the mooring tension statistics of the compact mooring systems it is seen that maximum tensions of compw is slightly greater than comp despite of the mean tensions of comp are much smaller than compw this is explained because the attached clump weights help to reduce mooring dynamic tensions which can be validated in the comparisons of standard deviations of compact mooring tension as well as in fig 29 the 2 mooring tensions are slightly greater than 1 mooring which is because the initial conditions of these two moorings cannot be identical during the installation such as mooring length anchor positon and these differences will give rise to the differences of mooring tensions consequently furthermore by checking the kurtosis and skewness it is found the chain tensions are close to gaussian process kurtosis 3 skewness 0 while the hawser tension as well compact mooring tensions are not gaussian this implies that the spectral methods are able to present precise estimation of the chain fatigue damage since they are implemented based on gaussian assumption the rainflow counting technique is applied in conjunction with t n curve approach to study mooring fatigue damage the k and m values in the t n curve of the chain are determined to be 1000 and 3 according to api rp 2sk american petroleum institute 2005 as for the polyester k 7 5 and m 9 is adopted american petroleum institute 2014 the t n curve parameters are not found in the design codes and these two parameters are fitted by least squares method according to the experimental data in ridge et al 2010 prior to estimating mooring fatigue damage the measured mooring tensions are transferred to full scale based on the froude similitude rule the mbl of each material is then estimated based on corresponding nominal diameters in full scale xu et al 2019c which are equal to 12 000 kn 5 600 kn and 5 000 kn for chain hawser and nylon rope respectively to study the difference of fatigue damage between compact mooring ropes the expected damage rates of compact mooring ropes are shown in fig 30 where the expected damage rates are calculated by applying the rainflow counting rfc technique in time domain it is clearly seen that the fatigue damage of compw ropes are significantly lower than for comp ropes this indicates that the attached clump weight helps to reduce mooring fatigue damage considerably owing to the fact that the clump weight plays a role in reducing mooring dynamic tensions by comparing the fatigue damage of mooring ropes in the same mooring systems it can be found that the 1 mooring suffers greater damage than 2 mooring and the reason causing this difference has been stated in the above discussions furthermore it is observed that the wave peak period has a certain influence on mooring fatigue damage almost all compact mooring ropes suffer the greatest fatigue damage when the fowc operates in the wave condition with tp 1 6s i e the peak period of surge raos in the tested wave period range this implies that the surge motion is closely related to mooring fatigue damage the spectral approaches are applied to study mooring fatigue damage fig 31 presents the comparisons of exceedance probability of normalized rainflow tension amplitude in a specified sea condition to check the performance of dirlik approach as well as tovo benasciutti method in mooring fatigue estimation since the dynamic properties of 1 and 2 mooring in the compact mooring systems are similar only the results of 1 mooring are discussed it is seen that the exceedance probability of the chain rainflow tension amplitude is well predicted by the spectral approaches the empirical exceedance probabilities are well distributed along the predicted curves it indicates that both of these two spectral methods are able to present good estimations to chain fatigue damage as for the synthetic fibre ropes it is found that the spectral methods fail to produce good estimations of the exceedance probabilities of the normalized rainflow tension amplitude in the tail and the greatest discrepancy is found in the compact mooring ropes this would induce the discrepancies in mooring fatigue damage estimation when applying the spectral methods the spectral methods show different performances in estimating mooring fatigue damage for different mooring materials it is explained that the implementation of spectral methods is based on the gaussian assumption the chain tension follows gaussian process while the statistic characteristics of synthetic rope tensions are different to gaussian according to the results in tables 5 8 the expected mooring fatigue damage rate estimated by spectral methods in all tested sea conditions are compared to the rfc results and the comparisons are shown in fig 32 it is seen that the spectral methods present good estimations to chain fatigue damage in all sea conditions as expected the results are in good agreement to the rfc fatigue damage the differences between rfc mooring fatigue damage and corresponding results of spectral methods can be observed in all synthetic fibre rope cases due to the fact that the gaussian assumptions are not satisfied besides it is seen that the degree of discrepancies is related to the wave peak periods however the synthetic fibre rope fatigue damage estimated by the discussed spectral methods are still acceptable as the discrepancies are small it is also seen that the fatigue damage of synthetic fibre rope is much more sensitive to wave peak period than chain damage the influence of clump weight on nylon rope fatigue damage is clear it can be seen that the fatigue damage of compact mooring rope is reduced considerably in all tested cases with clump weight attached 5 conclusions the results have shown that in the small wave height the cat is the preferable mooring option in terms of energy absorption it can be seen that the device energy conversion efficiency is greater than the compact systems in most of wave conditions however the efficiency of fowc is improved in large wave heights when it is moored by a compact mooring system as a consequence the device is more efficient by adopting the compact mooring design in most of large wave height sea conditions the efficiency difference between comp and compw is negligible while the most significant difference is found in wave period is equal to 1 2s where it is found that compw is slightly more efficient than comp overall this novel device shows excellent performance in energy capturing it is capable to capture wave energy with efficiency over 39 when wave periods varying between 8 5s and 12 7s in the porotype according to the froude similarity criterion which covers most of the energetic sea states in the portuguese islands mooring tensions show great nonlinearities the tension raos in large wave height are much greater than small wave height on the corresponding wave period especially for the small wave period tests where the mooring tension raos are several times to the results in small wave height besides the tension nonlinearity of hawser and nylon ropes is greater than chain the main reason is the viscoelastic and viscoplastic characteristics of synthetic fibre rope which increase the nonlinearities of mooring tensions as a consequence the linear mooring tension raos fail to capture mooring dynamics precisely generally the chain tension raos increase with wave period while an opposite result is found in the compact mooring ropes the chain tensions are close to gaussian processes in all tested random waves while the synthetic fibre rope tension statistics do not follow gaussian the wave peak period influences mooring fatigue damage to certain extent almost all the compact mooring ropes suffer the greatest damage when wave peak period is equal to 1 6s owing to the effects of clump weight the fatigue damage of mooring rope of compw is reduced considerably compared to comp the fatigue damage of catenary chain needs to be taken care which is greater than that of polyester hawser and the nylon mooring rope of compw the spectral methods present very precise estimations to chain fatigue damage which are in good agreement with rainflow counting results the differences between synthetic fibre rope fatigue damage estimated by spectral methods and rainflow counting approach can be seen however the differences are small overall both the dirlik approach and tovo benasciutti method present reasonable estimations of mooring fatigue damage in small wave height sea conditions where the results of these two methods are similar in general this novel dual chamber fowc shows efficient energy conversion performance in a broad range of wave periods covering the most probable sea states in the portuguese coastal zone it is anticipated that the device efficiency can be further improved by applying control strategy to pto in terms of energy conversion the cat is the preferable mooring design for fowc in small wave height sea conditions however it is necessary to notice that the large excursions may cause to the risk of collision with other offshore structures furthermore the snap events in the hawser require great care especially in harsh sea condition in large wave heights the device moored by compact mooring system shows better energy conversion performance overall the compw is superior to comp the efficiency of these two systems are similar while a significant reduction of mooring fatigue damage can be found in compw furthermore it has been validated that these three novel mooring system designs are flexible enough and it is anticipated that they can also show good performance in the application for other large dimensional wec devices credit authorship contribution statement sheng xu methodology formal analysis writing original draft k rezanejad methodology formal analysis writing original draft j f m gadelho methodology formal analysis shan wang methodology writing review editing c guedes soares writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was financially supported by the project opwec optimizing wave energy converters with reference p2020 ptdc mar tec 6984 2014 funded by national funds through fct fundação para a ciencia e a tecnologia the work contributes to the strategic research plan of the centre for marine technology and ocean engineering centec which is financed by the portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uidb uidp 00134 2020 the third author has been funded by the university of lisbon instituto superior técnico and centec within a phd grant the authors are grateful to profs francisco taveira pinto and paulo rosa santos for their generous support and flexibility in making the experimental facilities available for this work the scientific support provided by mr daniel ruben da silva pinto clemente and mr miguel hinostroza to perform the laboratory tests are highly appreciated appendix validation of the generated jonswap time series fig a 1random wave calibration tp 1 2s hs 0 04m a wave elevations b wave spectrum fig a 2random wave calibration tp 1 4s hs 0 04m a wave elevations b wave spectrum fig a 3random wave calibration tp 1 6s hs 0 04m a wave elevations b wave spectrum fig a 4random wave calibration tp 1 8s hs 0 04m a wave elevations b wave spectrum 
21496,this work investigates the adaptive synchronization for the surface vessels with disturbances and saturated thruster dynamics the vessel movement model becomes the three order equation with mismatched disturbances due to the inclusion of saturated thruster dynamics the marine disturbances are described as the multiple harmonic disturbances with unknown frequencies unknown amplitudes and unknown phases by fusions of the nonlinear observer and the adaptive technique the marine disturbance estimation and rejection are transformed into the adaptive problem the auxiliary dynamic filter generates the state vectors to represent the filtered versions of the non achievable portions of the vessel s positions and velocities the state vectors on line correct the control errors for avoiding disturbance rejection performance compromise under thruster saturation the synchronization controller is derived via the adaptive command filtered backstepping the surface vessel closed loop control system is guaranteed stable the adaptive synchronization scheme is validated by simulations with comparisons in different cases keywords surface vessel synchronization tracking disturbance observer saturated thruster dynamics adaptive command filtered backstepping 1 introduction surface vessel synchronization operation is mainly conducted for the underway replenishment where materials are transferred from the supply vessel to the main vessel while both vessels are moving peng et al 2019 kyrkjebø 2007 the synchronization operations are required for the vessels in the case that they are impractical to return to the base for replenishing materials the marine environmental disturbances are difficult to determine due to the variation and the unpredictability of marine factors such as waves currents and wind zhang et al 2020 to facilitate the synchronization operations the robustness and the adaptability of the synchronization control system is significant the automatic motion control system installed on the surface vessels should possess the capability to process time varying unknown disturbances ma et al 2019 accordingly the disturbance rejection design is necessary for the surface vessel s synchronization control system with the advances of advanced control theories the surface vessel s synchronization studies have been spurred during the past two decades in kyrkjebø and pettersen 2003 the nonlinear synchronous navigation for the supply vessel was studied for the first time where the nonlinear control scheme enables the supply vessel to synchronously navigate along with the main vessel in ding et al a synchronization output feedback control scheme was given by means of the observer backstepping approach for the vessel synchronous navigation in kyrkjebø and pettersen a supply vessel synchronous navigation control scheme was proposed where marine time varying disturbances are neglected and hence the robustness against marine environmental disturbances is limited a distributed coordination control scheme based on a virtual leader was further proposed for the multiple vessel coordinated path tracking problem under unknown disturbances in the parametric form in fu et al 2013 where the adaptive update laws were injected to address unknown parameters of the disturbance equation for the networked surface vessels with communication delays faults disturbances and jamming attacks an event triggering communication approach enhances the networked control robustness ma et al 2020 for the underactuated vessels with uncertain dynamic nonlinearity and bound unknown disturbances the formation control scheme was designed through integrating neural networks with the adaptive backstepping in peng et al 2011 as well as the adaptive dynamic surface control in peng et al 2013 respectively an identification and learning control scheme was designed for the vessels in dai et al 2012 where the learning control based on adaptive neural networks was injected into the adaptive backstepping to address vessel dynamics uncertainties and marine disturbances in peng et al 2011 2013 dai et al 2012 the marine disturbances are attenuated through injecting the exactly known disturbance bound into the control design such that the control system has the conservatism fortunately the disturbance rejection techniques such as the robust nonlinear control with the disturbance observers chen et al 2016 yao et al 2020 chen et al 2015a cao and zhao 2017 and the extended state observers xia et al 2014 peng and wang 2018 yang et al 2020 2018 offer the low conservatism against counteracting disturbances the disturbance observer was given in ohishi et al 1987 for the linear systems where the disturbance observer achieves the disturbance estimation for constant disturbances the disturbance observer was further introduced into the nonlinear systems to achieve the disturbance estimation for bounded time varying disturbances recently the disturbance observer based control schemes have been applied in practical applications yang et al 2014 chen et al 2015b li et al 2015b wang et al 2019 further research on the surface vessel synchronization with time varying disturbance estimations is significant the thruster saturation is the potential effect for the marine vessels inherently induced by thruster physical limitations in donaire and perez 2012 the marine dynamic positioning scheme was designed for the surface vessels utilizing the integral action together with the anti windup compensator in the port hamiltonian framework where the constant disturbances are addressed under time varying disturbances and multiplicative noises the takagi sugeno fuzzy based dynamic positioning controller for the surface vessels was provided in chang et al 2010 where the linear matrix inequality is introduced to obtain appropriate design parameters under thruster saturation effects an adaptive vessel trajectory tracking control scheme was given under multiple constraints in zheng et al 2018 where the barrier lyapunov function and the hyperbolic tangent function were adopted to deal with the asymmetric input and output constraints respectively to improve the robustness of marine control system an adaptive neural network based regulation scheme was presented for the surface vessels in hu et al 2018 where adaptive neural networks approximate vessel uncertain dynamics the auxiliary system reduces the saturation effects and the robustifying term enhances the control robustness in chang et al 2010 zheng et al 2018 hu et al 2018 the unknown time varying disturbances are viewed as norm bounded signals and counteracted by means of the robust attenuation shen et al 2018 instead of the disturbance rejection which are relatively conservative and require unnecessary energy to overcome this drawback a robust dynamic positioning approach was given in du et al 2016 through integrating the disturbance observer and the auxiliary dynamic system with the robust dynamic surface control technique where the state vector of auxiliary dynamic system directly modifies the control signals to attenuate the saturation effects more recently some saturation attenuation techniques have been applied into different control plants bai et al 2020 li et al 2015a 2016 chen et al 2011 sun and zheng 2018 it should be noted that the aforementioned works neglected the thruster dynamics the thruster dynamics are equivalently represented by the first order equation the vessel movement model becomes the three order equation with mismatched disturbances due to the inclusion of saturated thruster dynamics in particular the saturated thruster dynamics would corrupt the disturbance estimation and rejection performance therefore it puts the challenge for the marine vessel synchronization to achieve the disturbance rejection and thrust saturation compensation simultaneously especially under harsh environmental conditions in the light of the aforementioned challenge this work is motivated to design an adaptive synchronization tracking scheme for the surface vessels under marine disturbances and saturated thruster dynamics a parametric uncertain linear exogenous system is employed to express unknown harmonic marine disturbances which is transformed into the multivariate regression model by using coordinate changes with the aid of the nonlinear observer estimating regressor the disturbance estimation and rejection are achieved by utilizing the adaptive technique furthermore the auxiliary dynamic filter generates the state vectors to on line correct the control errors for preventing saturation effects from corrupting the disturbance estimation and rejection performance the adaptive synchronization tracking problem for the marine vessels is then solved by using the adaptive command filtered backstepping the main contributions of the work are listed as follows the marine disturbances are decomposed into the multiple harmonic signals with unknown frequencies amplitudes and phases the disturbance estimation and rejection are achieved by the adaptive technique such that the control system is less conservative and the adaptability is enhanced under saturated thruster dynamics effects an auxiliary dynamic filter generates the state vectors to on line correct the control errors for avoiding disturbance rejection compromise such that the vessel thrusters work in acceptable ranges and are robust to harsh environmental conditions the remaining parts are summarized as follows section 2 describes surface vessel movement model and the control objective section 3 details the adaptive synchronization design procedure section 4 presents simulations and comparisons section 5 gathers concluding remarks and future research 2 problem formulation 2 1 surface vessel movement modeling to describe the surface vessel synchronization the coordinate frames are depicted in fig 1 kyrkjebø 2007 the supply vessel s s synchronously navigates along with the main vessel s m the north east frame x 0 o 0 y 0 is the inertial frame with the origin o 0 as the set point on the earth s surface the axis o 0 x 0 directs to the north and the o 0 y 0 directs to the east respectively the vessel fixed frames x s o s y s and x m o m y m are fixed on the supply vessel and the main vessel respectively for the left and right symmetrical vessels the frame origins o s and o m are located at the gravity centers of the supply vessel and the main vessel respectively the axes o s x s and o m x m point forward from the aft to the fore of the vessel the axes o s y s and o m y m direct to the vessel s right starboard the planes x 0 y 0 in the north east frame as well as the planes x s y s and x m y m in the vessel fixed frames are horizontal to the water surface the surface vessel movement model for the supply vessel yang et al 2014 is 1 η s j ψ s ν s 2 m s ν s c s ν s ν s d s ν s ν s τ s t d s t where the vector η s x s y s ψ s t describes the supply vessel s north east position x s y s and heading ψ s the vector ν s u s v s r s t describes the supply vessel s surge velocity u s sway velocity v s and yaw rate r s and the rotation matrix j ψ s r 3 3 transforms the coordinates from the vessel fixed to the north east frames by 3 j ψ s cos ψ s sin ψ s 0 sin ψ s cos ψ s 0 0 0 1 such that j ψ s so 3 j ψ s r 3 3 j ψ s j t ψ s i 3 3 det j ψ s 1 herein the notation so 3 denotes the special orthogonal group of three order m s r 3 3 is the positive definite and symmetric inertia matrix which includes the hydrodynamics added mass due to the vessel s accelerations c s ν s r 3 3 denotes the coriolis and centripetal matrix and d s ν s r 3 3 denotes the damping matrix respectively d s t d s 1 t d s 2 t d s 3 t t represents time varying disturbance forces and moment induced by marine factors such as waves wind and currents τ s t τ s 1 t τ s 2 t τ s 3 t t represents actual control forces and moment experience obtained from full scale experiments indicates that the equivalent saturated thruster dynamics are represented by the following equation sørensen et al 1996 4 τ s a t r τ s a t r sat τ c herein 5 a t r d i a g 1 t t r 1 1 t t r 2 1 t t r 3 with t t r 1 t t r 2 and t t r 3 as equivalent thruster time constants in surge sway and yaw and sat τ c sat τ c 1 sat τ c 2 sat τ c 3 t as the saturation function vector the commanded control signals are subject to saturation constraints due to the physical limitation of thrusters i e du et al 2016 6 sat τ c i τ i max if τ c i τ i max τ c i if τ i min τ c i τ i max i 1 2 3 τ i min if τ c i τ i min with τ c t τ c 1 t τ c 2 t τ c 3 t t as the commanded control vector calculated by the tracking controller as well as τ i max and τ i min as the equivalent maximum and the minimum thruster saturation limits here notate δ τ s sat τ c τ c as the control deviation vector as such the vessel movement model becomes the three order equation with mismatched disturbances due to the inclusion of saturated thruster dynamics 2 2 reference trajectory for realizing the vessel synchronous navigation the reference trajectory η r is defined as kyrkjebø 2007 7 η r η m j ψ m l where η r x r y r ψ r t defines the reference trajectory and η m x m y m ψ m t defines the main vessel s position and heading vector herein 8 j ψ m cos ψ m sin ψ m 0 sin ψ m cos ψ m 0 0 0 1 l l m cos γ m l m sin γ m 0 where l m denotes the distance between the reference trajectory and the gravity center of the main vessel and γ m denotes the angle of the connection line between the reference trajectory and the gravity center of the main vessel relative to the main vessel s bow direction as illustrated in fig 1 as such the synchronous navigation problem between the supply and the main vessels is converted into the synchronization tracking of the supply vessel along with the reference trajectory η r control objective this work develops an adaptive synchronization tracking control scheme with disturbance rejection and thrust saturation compensation capabilities for the surface vessel movement model 1 6 under marine disturbances and saturated thruster dynamics such that the supply vessel closed loop control system is stable and the supply vessel tracks the reference trajectory thereby achieving the synchronous navigation along with the main vessel with the main vessel with adjustable small errors 3 adaptive synchronization tracking design the adaptive synchronous tracking design builds on the adaptive disturbance estimation the auxiliary dynamic filter and the adaptive command filtered backstepping the adaptive laws incorporating projection operators together with the observer achieve the disturbance estimation then the auxiliary dynamic filter generates the filtered versions of the non achievable portions of vessel s positions and velocities which are employed to prevent the saturation effects from corrupting the disturbance estimation and rejection performance based on the fusion of the adaptive command filtered backstepping the adaptive synchronization tracking control law is derived fig 2 shows the schematic of the vessel synchronous tracking control system 3 1 marine disturbance representation the marine disturbances due to the unpredictable environment are decomposed as the multiple harmonic superpositions hu et al 2020a 9 d s i t j 1 q a i j sin ω i j t ι i j i 1 2 3 with unknown amplitudes a i j unknown frequencies ω i j and unknown phases ι i j i 1 2 3 j 1 2 q respectively here the value q represents the number of harmonic components remark 1 the marine disturbances are decomposed into the different sinusoidal components by means of the fourier analysis furthermore the marine disturbances are difficult to identify therefore the disturbance amplitudes frequencies and phases are unknown the marine harmonic disturbances 9 are expressed as the output vector of the parametric uncertain exogenous system hu et al 2020b as 10 ξ w ξ 11 d s v ξ where ξ r 6 q denotes the state vector the coefficient matrices w r 6 q 6 q and v r 3 6 q are w w 1 w 2 w 3 6 q 6 q v v 1 v 2 v 3 3 6 q with w i r 2 q 2 q and v i r 1 2 q as w i 0 ω i 1 ω i 1 0 0 ω i q ω i q 0 2 q 2 q v i 1 0 1 0 1 0 1 2 q herein the eigenvalues of the matrix w i are located on the imaginary axis the coefficient matrices w and v are assumed to be unknown and are only required for the analytical purpose lemma 1 hu et al 2019 let π r 6 q 6 q and λ r 6 q 3 being design matrices with π λ being controllable and π being hurwitz then there exists a nonsingular solution t r 6 q 6 q of the sylvester matrix equation t w π t λ v based on the sylvester matrix equation the exogenous system 10 11 is transformed into the unknown disturbance input canonical model as 12 γ π γ λ d s 13 d s θ t γ where the state vector γ depends on the state vector ξ in 10 11 by the coordinate change γ t ξ the regression matrix θ θ 1 θ 2 θ 3 r 6 q 3 is the unknown parameter matrix with θ i r 6 q i 1 2 3 as the column vectors proof along the solutions of 10 and 11 and the sylvester matrix equation t w π t λ v the time derivative of the coordinate change γ t ξ is 14 γ π t λ v ξ π γ λ d s substituting ξ t 1 γ into 11 obtains 15 d s v t 1 γ θ t γ where θ v t 1 t hence the parametric uncertain exogenous system 10 11 is transformed into the unknown disturbance input canonical model 12 13 remark 2 by means of the parametric uncertain exogenous system 10 11 the marine harmonic disturbances are described as the output vector of the linear canonical model 12 13 where the disturbances are converted into the parameterized form d s θ t γ as such the disturbance estimation and rejection are transformed into the adaptive problem 3 2 adaptive command filtered backstepping design define the following three coordinate changes 16 z 1 η s η r ζ 1 17 z 2 ν s β 1 1 ζ 2 18 z 3 τ s β 2 1 ζ 3 where β 1 1 β 2 1 r 3 are filtered virtual stabilizing function vectors to be designed later and ζ 1 ζ 2 ζ 3 r 3 are produced by the auxiliary dynamic filter 19 ζ 1 k 1 ζ 1 j ψ s ζ 2 20 ζ 2 m s 1 k 2 ζ 2 m s 1 ζ 3 21 ζ 3 a t r k 3 ζ 3 a t r δ τ s where k 1 k 1 t and k 2 k 2 t are 3 3 positive definite design matrices remark 3 it is noted from the auxiliary dynamic filter 19 21 that the state vectors ζ 1 ζ 2 and ζ 3 represent the filtered versions of non achievable portions of position η s velocity ν s and control vector τ s of the vessel induced by δ τ s the state vectors ζ 1 ζ 2 and ζ 3 are introduced to on line correct the control errors z 1 z 2 and z 3 for preventing the presence of thruster saturation effects from corrupting the adaptive disturbance rejection performance the adaptive backstepping synchronization design is presented in the following step 1 by fusions of 1 7 and 19 the time derivative of the error vector 16 is 22 z 1 j ψ s ν s j ψ m ν m j ψ m l k 1 ζ 1 j ψ s ζ 2 where ν m u m v m r m t defines the main vessel s velocity vector and 23 j ψ m cos ψ m sin ψ m 0 sin ψ m cos ψ m 0 0 0 1 0 r m 0 r m 0 0 0 0 0 j ψ m s r m with s r m 0 r m 0 r m 0 0 0 0 0 in term of 23 eq 22 becomes 24 z 1 j ψ s ν s j ψ m ν m j ψ m s r m l k 1 ζ 1 j ψ s ζ 2 design the virtual stabilizing function vector ϱ 1 as 25 ϱ 1 j t ψ s k 1 z 1 k 1 ζ 1 j ψ m ν m j ψ m s r m l let ϱ 1 pass through the command filter 26 to obtain β 1 1 26 β 1 1 ω 1 β 1 2 β 1 2 2 ς 1 ω 1 β 1 2 ω 1 β 1 1 ϱ 1 herein the initial conditions are set as β 1 1 0 ϱ 1 0 and β 1 2 0 o 3 1 then there exist ω 1 0 and ς 1 0 1 such that β 1 1 ϱ 1 β 1 1 β 1 1 and β 1 1 are bounded as detailed in yu et al 2015 introduce the compensating filter 27 to offset the filter error β 1 1 ϱ 1 and then define the compensated tracking error ϑ 1 as follows 27 ξ 1 k 1 ξ 1 j ψ s β 1 1 ϱ 1 j ψ s ξ 2 28 ϑ 1 z 1 ξ 1 in the light of 24 j ψ s j t ψ s i 3 3 17 and 25 it is obtained that 29 z 1 j ψ s ϱ 1 j ψ s β 1 1 ϱ 1 j ψ s ν s β 1 1 j ψ m ν m j ψ m s r m l k 1 ζ 1 j ψ s ζ 2 k 1 z 1 j ψ s β 1 1 ϱ 1 j ψ s z 2 step 2 using 2 and 20 the derivative of the error vector 17 is derived as 30 z 2 m s 1 τ s d s f s ν s ν s m s β 1 1 k 2 ζ 2 ζ 3 where f s ν s c s ν s d s ν s represents vessel nonlinear dynamics noticing that marine harmonic disturbances are expressed as the output vector of the linear canonical model described by 12 13 the nonlinear observer is established to estimate the unknown regressor γ in 12 13 as follows 31 γ ˆ β n ν s 32 β π β π n n m s 1 f s ν s ν s n m s 1 τ s where γ ˆ r 6 q is the estimation vector of the unknown regressor γ in 12 13 and β r 6 q is the auxiliary vector here the design matrix n r 6 q 3 is given by n m s 1 λ define the estimation error vector 33 γ γ ˆ γ based on 2 12 and 31 32 the time derivative of 33 is 34 γ π β π n n m s 1 f s ν s ν s n m s 1 τ s n m s 1 f s ν s ν s n m s 1 τ s λ d s π γ λ d s π β n ν s γ π γ remark 4 note that the matrix π is specified to be hurwitz in 34 the estimation error vector γ exponentially decays substituting γ γ ˆ γ into 13 obtains 35 d s θ t γ ˆ θ t γ remark 5 it is obtained from the disturbance parametric representation 35 that the uncertainties of marine disturbances are lumped into the parametric uncertainty of θ design the virtual stabilizing function vector ϱ 2 as 36 ϱ 2 j t ψ s ϑ 1 k 2 z 2 f s ν s ν s m s β 1 1 θ ˆ t γ ˆ k 2 ζ 2 where θ ˆ θ ˆ 1 θ ˆ 2 θ ˆ 3 r 6 q 3 is the parameter matrix with θ ˆ i r 6 q i 1 2 3 as the column vectors to be on line updated later let ϱ 2 pass through the command filter 37 to obtain β 2 1 37 β 2 1 ω 2 β 2 2 β 2 2 2 ς 2 ω 2 β 2 2 ω 2 β 2 1 ϱ 2 herein the design parameters ω 2 0 and ς 2 0 1 and the initial conditions are set as β 2 1 0 ϱ 2 0 and β 2 2 0 o 3 1 introduce the compensating filter 38 to offset the filter error β 2 1 ϱ 2 and then define the compensated tracking error ϑ 2 as follows 38 ξ 2 m s 1 k 2 ξ 2 β 2 1 ϱ 2 39 ϑ 2 z 2 ξ 2 to update the adaptive parameter matrix θ ˆ θ ˆ 1 θ ˆ 2 θ ˆ 3 in 36 the adaptive laws are designed incorporating projection operators for preventing the parameter drifts as follows 40 θ ˆ i γ i proj ϑ 2 i γ ˆ θ ˆ i i 1 2 3 where γ i γ i t is 6 q 6 q positive definite design matrix and proj denotes the projection operator detailed in appendix a in the light of 18 and 30 35 and 36 it is obtained that 41 m s z 2 f s ν s ν s ϱ 2 β 2 1 ϱ 2 τ s β 2 1 θ t γ ˆ θ t γ m s β 1 1 k 2 ζ 2 ζ 3 k 2 z 2 j ψ s ϑ 1 θ t γ ˆ θ t γ β 2 1 ϱ 2 z 3 where θ θ ˆ θ remark 6 the mismatched harmonic disturbances are on line estimated from the adaptive laws 40 together with the observer 31 32 by θ ˆ t γ ˆ θ ˆ 1 t γ ˆ θ ˆ 2 t γ ˆ θ ˆ 3 t γ ˆ t in the adaptive command filtered backstepping framework the adaptive laws 40 combined with the observer 31 32 constitute the adaptive disturbance observer the surface vessel synchronization tracking controller has the disturbance rejection capability step 3 based on 4 and 21 and δ τ s sat τ c τ c the time derivative of the error vector 18 is 42 z 3 a t r τ s a t r τ c δ τ s β 2 1 a t r k 3 ζ 3 a t r δ τ s design the adaptive command tracking controller as 43 τ c k 3 z 3 τ s ϑ 2 a t r 1 β 2 1 k 3 ζ 3 in the light of 42 and 43 it follows that 44 z 3 a t r k 3 z 3 ϑ 2 remark 7 due to the inclusion of saturated thruster dynamics the vessel movement model becomes the three order equation the traditional adaptive backstepping takes repeated derivations ϱ 1 and ϱ 2 of virtual stabilizing function vectors yang et al 2014 the repeated derivations are avoided due to the command filters 26 and 37 furthermore the filter errors β 1 1 ϱ 1 and β 2 1 ϱ 2 are eliminated by utilizing the compensating filters 27 and 38 the computational burden is reduced with the adaptive command filtered backstepping remark 8 under the saturated thruster dynamics the disturbance rejection performance is ensured by fusions of the adaptive estimation technique and the auxiliary dynamic filter in combination with the adaptive command filtered backstepping the disturbance estimation and rejection are transformed into the adaptive problem the auxiliary dynamic filter generates the state vectors as the filtered versions of the non achievable portions of vessel s positions and velocities due to thruster saturation effects the state vectors then on line correct the control errors for preventing the saturation effects from corrupting the disturbance estimation and rejection performance 3 3 supply vessel closed loop stability analysis theorem 1 consider the surface vessel movement model 1 6 with nonlinear coriolis and damping terms subject to saturated thruster dynamics under unknown marine disturbances by designing the adaptive command tracking controller 43 with the virtual stabilizing function vectors 25 and 36 the adaptive laws 40 the nonlinear observer 31 32 and the auxiliary dynamic filter 19 21 the supply vessel synchronization tracking closed loop control system is uniformly ultimately stable the supply vessel tracks the reference trajectory thereby achieving the synchronous navigation along with the main vessel with adjustable small errors proof from 28 29 38 39 41 44 and letting ϑ 3 z 3 the error dynamics are 45 ϑ 1 k 1 ϑ 1 j ψ s ϑ 2 46 ϑ 2 m s 1 k 2 ϑ 2 j ψ s ϑ 1 θ t γ ˆ θ t γ ϑ 3 47 ϑ 3 a t r k 3 ϑ 3 ϑ 2 for the error dynamics 45 47 the following control lyapunov function is selected 48 v c 1 2 ϑ 1 t ϑ 1 1 2 ϑ 2 t m s ϑ 2 1 2 ϑ 3 t a t r 1 ϑ 3 1 2 i 1 3 θ i t γ i 1 θ i γ t q γ herein the positive definite matrix q r 6 q 6 q belongs to the solution of the matrix equation 49 π t q q t π θ θ t along the trajectories of 40 45 47 and 49 the derivative of 48 is given as 50 v c ϑ 1 t k 1 ϑ 1 ϑ 2 t k 2 ϑ 2 ϑ 3 t k 3 ϑ 3 ϑ 2 t θ t γ ˆ ϑ 2 t θ t γ i 1 3 θ i t proj ϑ 2 i γ ˆ θ ˆ i γ t π t q q π γ ϑ 1 t k 1 ϑ 1 ϑ 2 t k 2 ϑ 2 ϑ 3 t k 3 ϑ 3 ϑ 2 t θ t γ γ t θ θ t γ it follows from the young s inequality that 51 ϑ 2 t θ t γ 1 4 ϑ 2 t ϑ 2 γ t θ θ t γ by using 51 eq 50 becomes 52 v c ϑ 1 t k 1 ϑ 1 ϑ 2 t k 2 1 4 i 3 3 ϑ 2 ϑ 3 t k 3 ϑ 3 κ ϑ 1 2 ϑ 2 2 ϑ 3 2 herein κ min λ min k 1 λ min k 2 1 4 i 3 3 λ min k 3 with λ min denoting the minimum eigenvalue the design matrix k 2 is required to satisfy λ min k 2 1 4 it is indicated from 48 and 52 that the time derivative v c is negative semi definite hence the control lyapunov function v c is uniformly ultimately bounded this implies that ϑ 1 ϑ 2 ϑ 3 γ and θ i i 1 2 3 are bounded signals furthermore the control signal τ s is always bounded under saturated thruster dynamics 4 and the disturbance d s in 9 is bounded integrating 52 on 0 t then 53 0 t ϑ 1 ħ 2 ϑ 2 ħ 2 ϑ 3 ħ 2 d ħ 1 κ v c 0 v c t this implies that 54 lim t 0 t ϑ 1 ħ 2 ϑ 2 ħ 2 ϑ 3 ħ 2 d ħ 1 κ v c 0 from 54 the 2 norm ϑ 1 is square integrable it is proved theoretically by barbalat lemma in appendix b that 55 lim t ϑ 1 lim t η s η r ζ 1 ξ 1 0 to further obtain the convergence regions of ζ 1 and ξ 1 the auxiliary control lyapunov function is provided as 56 v ζ 1 2 ζ 1 t ζ 1 1 2 ζ 2 t m s ζ 2 1 2 ζ 3 t a t r 1 ζ 3 1 2 ξ 1 t ξ 1 1 2 ξ 2 t m s ξ 2 along the trajectories of 19 21 27 38 det j ψ s 1 and young s inequality the time derivative v ζ is 57 v ζ ζ 1 t k 1 1 2 i 3 3 ζ 1 ζ 2 t k 2 i 3 3 ζ 2 ζ 3 t k 3 i 3 3 ζ 3 ξ 1 t k 1 i 3 3 ξ 1 ξ 2 t k 2 i 3 3 ξ 2 1 2 δ τ s 2 1 2 β 1 1 ϱ 1 2 1 2 β 2 1 ϱ 2 2 2 μ v ζ c herein μ min λ min k 1 i 3 3 λ min k 2 i 3 3 λ min k 3 i 3 3 and c 1 2 sup t 0 δ τ s 2 1 2 sup t 0 β 1 1 ϱ 1 2 1 2 sup t 0 β 2 1 ϱ 2 2 it is indicated from 57 that 58 ζ 1 c μ 2 v ζ 0 c 2 α e 2 μ t 59 ξ 1 c μ 2 v ζ 0 c 2 μ e 2 μ t it is concluded from 55 58 and 59 that the synchronization tracking error settles within the compact set ω η s η r δ η δ η 2 c μ it is indicated from the expressions of the notations c and μ that the surface vessel s position tracking error is able to be adjusted small through artfully setting design parameters satisfying λ min k 1 1 λ min k 2 1 and λ min k 3 1 this means that the supply vessel tracks the reference trajectory thereby achieving the synchronous navigation along with the main vessel with adjustable small errors this completes the proof 4 illustrative simulations with comparisons 4 1 proposed adaptive synchronization control evaluation the proposed adaptive synchronization tracking control scheme is evaluated numerically on a typical fully actuated supply vessel the equivalent thruster saturation limits are given in table 1 the fully actuated supply vessel s inertia matrix coriolis and centripetal matrix and damping matrix liu et al 2018 are summarized in box i see eqs 60 66 given in box i to evaluate the robustness and adaptability of the adaptive synchronization tracking control scheme the simulations are conducted on the supply vessel in different disturbance cases disturbance case 1 the marine disturbances as the superposition of harmonic components are set by d s t j t ψ s 5 26 1 0 4 sin 0 02 t 7 89 1 0 4 sin 0 04 t 1 052 1 0 5 sin 0 02 t π 6 1 315 1 0 5 sin 0 03 t 1 578 1 0 5 sin 0 09 t π 3 2 104 1 0 5 sin 0 01 t furthermore to simulate the marine environment the surface vessel s wave frequency oscillatoric motion components are fossen 2011 67 x w y w ψ w t h w s w h w s w h w s w 180 π t with the gaussian white noise w and the wave transfer function h s as 68 h w s 2 ς 0 ω 0 σ w s s 2 2 ς 0 ω 0 s ω 0 2 where ς 0 denotes the damping coefficient ω 0 denotes the dominating wave frequency as well as σ w denotes the constant describing wave intensities these parameters are set as ς 0 0 1 ω 0 0 8 and σ w 0 5 furthermore the sensor measurement noises are set as the gaussian white noises with the standard deviations 0 05 m 0 05 m and 0 1 18 0 π rad in the north position the east position as well as the heading respectively the equivalent thruster time constants are t t r 1 t t r 2 t t r 3 5 s in surge sway and yaw respectively the initial conditions are set as η 0 0 m 250 m 0 ν 0 0 m s 0 m s 0 s ζ 1 0 ζ 2 0 ζ 3 0 o 3 1 ξ 1 0 ξ 2 0 o 3 1 γ ˆ 0 o 12 1 β 0 o 12 1 θ ˆ 1 0 θ ˆ 2 0 θ ˆ 3 0 o 12 1 the command filter parameters are set as ω 1 1 5 ω 2 1 7 ς 1 ς 2 0 9 the design parameters of the adaptive laws are γ 1 γ 2 γ 3 1 0 7 i 12 12 the design parameters of the observer and the controller are specified as π d i a g 0 41 0 42 0 43 0 44 0 35 0 36 0 37 0 38 0 45 0 46 0 47 0 48 λ 1 0 0 1 0 0 1 0 0 1 0 0 0 1 0 0 1 0 0 1 0 0 1 0 0 0 1 0 0 1 0 0 1 0 0 1 n λ m s and k 1 d i a g 0 9 0 9 0 2 k 2 d i a g 6 1 0 5 1 1 1 0 6 2 1 0 9 k 3 d i a g 0 2 0 2 0 2 simulation results in the disturbance case 1 under the adaptive synchronization tracking control are provided with the solid lines in fig 3 a 3 e the quantitative performance indices are given in table 2 where the mean errors in north east and yaw are defined in 69 71 it is shown from figs 3 a and 3 b that the supply vessel tracks the reference trajectory implying that the synchronous navigation between the supply and the main vessels is realized table 2 demonstrates the satisfactory tracking performance of the surface vessel it is observed from fig 3 c that the vessel s velocities u in surge v in sway and r in yaw are bounded it is illustrated from fig 3 d that the commanded control signals sat τ c 1 sat τ c 2 and sat τ c 3 are reasonable within the acceptable ranges of thruster working conditions it is clearly obtained from fig 3 e that the adaptive laws 40 together with the observer 31 32 provide the online estimations θ ˆ 1 t γ ˆ θ ˆ 2 t γ ˆ θ ˆ 3 t γ ˆ for marine harmonic disturbances d s 1 t d s 2 t and d s 3 t acting on the supply vessel 69 mean error in north 1 3000 0 3000 x t x d d t 70 mean error in east 1 3000 0 3000 y t y d d t 71 mean error in yaw 1 3000 0 3000 ψ t ψ d 180 π d t disturbance case 2 the marine environmental condition becomes harsh through enlarging disturbances as follows d s t 3 j t ψ s 5 26 1 0 4 sin 0 02 t 7 89 1 0 4 sin 0 04 t 1 052 1 0 5 sin 0 02 t π 6 1 315 1 0 5 sin 0 03 t 1 578 1 0 5 sin 0 09 t π 3 2 104 1 0 5 sin 0 01 t the initial conditions the command filter parameters as well as the observer and the controller design parameters are adopted as same as the counterparts specified in the disturbance case 1 this means that the adaptive synchronization tracking control remains identical in different cases simulation results in the disturbance case 2 under the adaptive synchronization tracking control are provided with the solid lines in fig 4 a 4 e the control performance indices are given in table 2 it is observed from fig 3 a 3 e 4 a 4 e and table 2 that the designed adaptive synchronization tracking controller still exhibits the satisfactory control performance in the disturbance case 2 in particular it is concluded from fig 4 e that the adaptive disturbance estimation performance is still satisfactory especially under the effects of saturated thruster dynamics 4 2 comparison with existing adaptive synchronization control to illustrate the superiority of the adaptive synchronization tracking scheme the comparisons between the designed adaptive synchronization tracking controller and the following existing robust adaptive synchronization control 72 85 are presented define the following coordinate changes 72 z c 1 η s η r 73 z c 2 ν s β c 1 1 74 z c 3 τ s β c 2 1 design the virtual stabilizing function vectors as 75 ϱ c 1 j t ψ s k 1 z c 1 j ψ m ν m j ψ m s r m l 76 ϱ c 2 j t ψ s ϑ c 1 k 2 z c 2 f s ν s ν s m s β c 1 1 θ ˆ c m t γ ˆ c m let ϱ c 1 and ϱ c 2 pass through the command filters 77 and 78 respectively 77 β c 1 1 ω 1 β c 1 2 β c 1 2 2 ς 1 ω 1 β c 1 2 ω 1 β c 1 1 ϱ c 1 78 β c 2 1 ω 2 β c 2 2 β c 2 2 2 ς 2 ω 2 β c 2 2 ω 2 β c 2 1 ϱ c 2 introduce the compensating filters to reduce the effects of the filter errors 79 ξ c 1 k 1 ξ c 1 j ψ s β c 1 1 ϱ c 1 j ψ s ξ c 2 80 ξ c 2 m s 1 k 2 ξ c 2 β c 2 1 ϱ c 2 the existing auxiliary dynamic filter generates the state vector χ c to directly modify the control signals as follows du et al 2016 81 χ c k χ χ c i 1 3 z c 2 i δ τ s c i 0 5 δ τ s c t δ τ s c χ c χ c δ τ s c χ c ε 0 3 1 χ c ε furthermore the nonlinear observer 82 83 and the adaptive laws 84 incorporating the projection operators are designed then the existing adaptive command tracking controller 85 is presented 82 γ ˆ c m β c m n ν s 83 β c m π β c m π n n m s 1 f s ν s ν s n m s 1 τ s 84 θ ˆ c m i γ i proj ϑ c 2 i γ ˆ c m θ ˆ c m i i 1 2 3 85 τ c m k 3 z c 3 τ s ϑ c 2 a t r 1 β c 2 1 k ħ χ where ϑ c i z c i ξ c i i 1 2 for the existing auxiliary dynamic filter the corresponding parameters are selected as k χ d i a g 5 0 5 0 5 0 and k ħ d i a g 1 0 1 0 1 0 to ensure fairness of comparison the other design parameters are as same as the counterparts of the proposed adaptive synchronization control scheme simulation comparison results under the existing synchronization control based on the auxiliary dynamic filter 81 in the disturbance cases 1 and 2 are provided with the dashed lines in figs 3 a 3 d 3 f and figs 4 a 4 d 4 f respectively furthermore the control performance indices in the disturbance cases 1 and 2 are provided in table 2 it is clearly observed from figs 3 a 4 a and table 2 that the existing adaptive synchronization control achieves the acceptable control performance in the disturbance case 1 however it results in the unacceptable control performance in the disturbance case 2 it is illustrated from fig 4 d that the commanded control signals sat τ c m 1 sat τ c m 2 and sat τ c m 3 reach saturation limits and are unsatisfactory in the disturbance case 2 it is obviously shown from fig 4 f that the performance of the existing disturbance observer 82 84 is destroyed in the presence of saturated thruster dynamics in summary the proposed adaptive synchronization control scheme achieves the disturbance rejection and the thruster saturation compensation simultaneously the marine time varying disturbance estimation performance is satisfactory in the presence of saturated thruster dynamics this is attributed that the disturbance estimation and rejection are transformed into the adaptive problem the auxiliary dynamic filter generates the state vectors as the filtered versions of the non achievable portions of the vessel s positions and velocities due to saturated thruster dynamics these state vectors on line correct the control errors for preventing the saturation effects from corrupting the adaptive disturbance estimation and rejection performance therefore the designed adaptive synchronization scheme is superior and practical 5 conclusions under the saturated thruster dynamics the adaptive synchronization scheme has been presented for the surface vessels through artfully transforming the disturbance estimation and rejection into the adaptive problem the adaptive techniques together with the observer achieve the disturbance estimation the auxiliary dynamic filter generates the state vectors as the filtered versions of non achievable portions of the vessel s positions and velocities due to the saturated thruster dynamics the state vectors on line correct the control errors for preventing the saturation effects from corrupting the adaptive disturbance estimation and rejection performance the theoretical analysis and comparative simulations demonstrate that the supply vessel tracks the reference trajectory under the adaptive synchronization tracking controller thereby achieving the synchronous navigation with the main vessel future research work will focus on alleviating the requirement on main vessel velocities and including vessel dynamic uncertainties credit authorship contribution statement xin hu conceptualization methodology software validation formal analysis investigation resources writing original draft writing review editing xinjiang wei writing review editing guibing zhu resources defeng wu resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported partly by the national natural science foundation of china under grants 61903174 61973149 61803195 61903092 partly by the natural science foundation of shandong province china under grant zr2019pf006 and partly by the outstanding youth innovation team project of shandong higher education institution china under grand 2019kjn017 appendix a projection operator a projection operator proj w θ ˆ a is defined by 86 proj w θ ˆ a w if p θ ˆ a 0 w if p θ ˆ a 0 and p θ ˆ a θ ˆ a t w 0 w p θ ˆ a p θ ˆ a p θ ˆ a t p θ ˆ a 2 w otherwise herein p θ ˆ a θ ˆ a 2 r ω 2 ε 2 2 ε r ω with ε being an arbitrary positive real if θ ˆ a 0 is bounded the property θ a t proj w θ ˆ a θ a t w θ a θ ˆ a θ a holds appendix b barbalat s lemma for a vector signal ħ t r m if 0 ħ t 2 d t c 1 and sup t 0 ħ t 2 c 2 for positive constants c 1 and c 2 then lim t ħ t 0 
21496,this work investigates the adaptive synchronization for the surface vessels with disturbances and saturated thruster dynamics the vessel movement model becomes the three order equation with mismatched disturbances due to the inclusion of saturated thruster dynamics the marine disturbances are described as the multiple harmonic disturbances with unknown frequencies unknown amplitudes and unknown phases by fusions of the nonlinear observer and the adaptive technique the marine disturbance estimation and rejection are transformed into the adaptive problem the auxiliary dynamic filter generates the state vectors to represent the filtered versions of the non achievable portions of the vessel s positions and velocities the state vectors on line correct the control errors for avoiding disturbance rejection performance compromise under thruster saturation the synchronization controller is derived via the adaptive command filtered backstepping the surface vessel closed loop control system is guaranteed stable the adaptive synchronization scheme is validated by simulations with comparisons in different cases keywords surface vessel synchronization tracking disturbance observer saturated thruster dynamics adaptive command filtered backstepping 1 introduction surface vessel synchronization operation is mainly conducted for the underway replenishment where materials are transferred from the supply vessel to the main vessel while both vessels are moving peng et al 2019 kyrkjebø 2007 the synchronization operations are required for the vessels in the case that they are impractical to return to the base for replenishing materials the marine environmental disturbances are difficult to determine due to the variation and the unpredictability of marine factors such as waves currents and wind zhang et al 2020 to facilitate the synchronization operations the robustness and the adaptability of the synchronization control system is significant the automatic motion control system installed on the surface vessels should possess the capability to process time varying unknown disturbances ma et al 2019 accordingly the disturbance rejection design is necessary for the surface vessel s synchronization control system with the advances of advanced control theories the surface vessel s synchronization studies have been spurred during the past two decades in kyrkjebø and pettersen 2003 the nonlinear synchronous navigation for the supply vessel was studied for the first time where the nonlinear control scheme enables the supply vessel to synchronously navigate along with the main vessel in ding et al a synchronization output feedback control scheme was given by means of the observer backstepping approach for the vessel synchronous navigation in kyrkjebø and pettersen a supply vessel synchronous navigation control scheme was proposed where marine time varying disturbances are neglected and hence the robustness against marine environmental disturbances is limited a distributed coordination control scheme based on a virtual leader was further proposed for the multiple vessel coordinated path tracking problem under unknown disturbances in the parametric form in fu et al 2013 where the adaptive update laws were injected to address unknown parameters of the disturbance equation for the networked surface vessels with communication delays faults disturbances and jamming attacks an event triggering communication approach enhances the networked control robustness ma et al 2020 for the underactuated vessels with uncertain dynamic nonlinearity and bound unknown disturbances the formation control scheme was designed through integrating neural networks with the adaptive backstepping in peng et al 2011 as well as the adaptive dynamic surface control in peng et al 2013 respectively an identification and learning control scheme was designed for the vessels in dai et al 2012 where the learning control based on adaptive neural networks was injected into the adaptive backstepping to address vessel dynamics uncertainties and marine disturbances in peng et al 2011 2013 dai et al 2012 the marine disturbances are attenuated through injecting the exactly known disturbance bound into the control design such that the control system has the conservatism fortunately the disturbance rejection techniques such as the robust nonlinear control with the disturbance observers chen et al 2016 yao et al 2020 chen et al 2015a cao and zhao 2017 and the extended state observers xia et al 2014 peng and wang 2018 yang et al 2020 2018 offer the low conservatism against counteracting disturbances the disturbance observer was given in ohishi et al 1987 for the linear systems where the disturbance observer achieves the disturbance estimation for constant disturbances the disturbance observer was further introduced into the nonlinear systems to achieve the disturbance estimation for bounded time varying disturbances recently the disturbance observer based control schemes have been applied in practical applications yang et al 2014 chen et al 2015b li et al 2015b wang et al 2019 further research on the surface vessel synchronization with time varying disturbance estimations is significant the thruster saturation is the potential effect for the marine vessels inherently induced by thruster physical limitations in donaire and perez 2012 the marine dynamic positioning scheme was designed for the surface vessels utilizing the integral action together with the anti windup compensator in the port hamiltonian framework where the constant disturbances are addressed under time varying disturbances and multiplicative noises the takagi sugeno fuzzy based dynamic positioning controller for the surface vessels was provided in chang et al 2010 where the linear matrix inequality is introduced to obtain appropriate design parameters under thruster saturation effects an adaptive vessel trajectory tracking control scheme was given under multiple constraints in zheng et al 2018 where the barrier lyapunov function and the hyperbolic tangent function were adopted to deal with the asymmetric input and output constraints respectively to improve the robustness of marine control system an adaptive neural network based regulation scheme was presented for the surface vessels in hu et al 2018 where adaptive neural networks approximate vessel uncertain dynamics the auxiliary system reduces the saturation effects and the robustifying term enhances the control robustness in chang et al 2010 zheng et al 2018 hu et al 2018 the unknown time varying disturbances are viewed as norm bounded signals and counteracted by means of the robust attenuation shen et al 2018 instead of the disturbance rejection which are relatively conservative and require unnecessary energy to overcome this drawback a robust dynamic positioning approach was given in du et al 2016 through integrating the disturbance observer and the auxiliary dynamic system with the robust dynamic surface control technique where the state vector of auxiliary dynamic system directly modifies the control signals to attenuate the saturation effects more recently some saturation attenuation techniques have been applied into different control plants bai et al 2020 li et al 2015a 2016 chen et al 2011 sun and zheng 2018 it should be noted that the aforementioned works neglected the thruster dynamics the thruster dynamics are equivalently represented by the first order equation the vessel movement model becomes the three order equation with mismatched disturbances due to the inclusion of saturated thruster dynamics in particular the saturated thruster dynamics would corrupt the disturbance estimation and rejection performance therefore it puts the challenge for the marine vessel synchronization to achieve the disturbance rejection and thrust saturation compensation simultaneously especially under harsh environmental conditions in the light of the aforementioned challenge this work is motivated to design an adaptive synchronization tracking scheme for the surface vessels under marine disturbances and saturated thruster dynamics a parametric uncertain linear exogenous system is employed to express unknown harmonic marine disturbances which is transformed into the multivariate regression model by using coordinate changes with the aid of the nonlinear observer estimating regressor the disturbance estimation and rejection are achieved by utilizing the adaptive technique furthermore the auxiliary dynamic filter generates the state vectors to on line correct the control errors for preventing saturation effects from corrupting the disturbance estimation and rejection performance the adaptive synchronization tracking problem for the marine vessels is then solved by using the adaptive command filtered backstepping the main contributions of the work are listed as follows the marine disturbances are decomposed into the multiple harmonic signals with unknown frequencies amplitudes and phases the disturbance estimation and rejection are achieved by the adaptive technique such that the control system is less conservative and the adaptability is enhanced under saturated thruster dynamics effects an auxiliary dynamic filter generates the state vectors to on line correct the control errors for avoiding disturbance rejection compromise such that the vessel thrusters work in acceptable ranges and are robust to harsh environmental conditions the remaining parts are summarized as follows section 2 describes surface vessel movement model and the control objective section 3 details the adaptive synchronization design procedure section 4 presents simulations and comparisons section 5 gathers concluding remarks and future research 2 problem formulation 2 1 surface vessel movement modeling to describe the surface vessel synchronization the coordinate frames are depicted in fig 1 kyrkjebø 2007 the supply vessel s s synchronously navigates along with the main vessel s m the north east frame x 0 o 0 y 0 is the inertial frame with the origin o 0 as the set point on the earth s surface the axis o 0 x 0 directs to the north and the o 0 y 0 directs to the east respectively the vessel fixed frames x s o s y s and x m o m y m are fixed on the supply vessel and the main vessel respectively for the left and right symmetrical vessels the frame origins o s and o m are located at the gravity centers of the supply vessel and the main vessel respectively the axes o s x s and o m x m point forward from the aft to the fore of the vessel the axes o s y s and o m y m direct to the vessel s right starboard the planes x 0 y 0 in the north east frame as well as the planes x s y s and x m y m in the vessel fixed frames are horizontal to the water surface the surface vessel movement model for the supply vessel yang et al 2014 is 1 η s j ψ s ν s 2 m s ν s c s ν s ν s d s ν s ν s τ s t d s t where the vector η s x s y s ψ s t describes the supply vessel s north east position x s y s and heading ψ s the vector ν s u s v s r s t describes the supply vessel s surge velocity u s sway velocity v s and yaw rate r s and the rotation matrix j ψ s r 3 3 transforms the coordinates from the vessel fixed to the north east frames by 3 j ψ s cos ψ s sin ψ s 0 sin ψ s cos ψ s 0 0 0 1 such that j ψ s so 3 j ψ s r 3 3 j ψ s j t ψ s i 3 3 det j ψ s 1 herein the notation so 3 denotes the special orthogonal group of three order m s r 3 3 is the positive definite and symmetric inertia matrix which includes the hydrodynamics added mass due to the vessel s accelerations c s ν s r 3 3 denotes the coriolis and centripetal matrix and d s ν s r 3 3 denotes the damping matrix respectively d s t d s 1 t d s 2 t d s 3 t t represents time varying disturbance forces and moment induced by marine factors such as waves wind and currents τ s t τ s 1 t τ s 2 t τ s 3 t t represents actual control forces and moment experience obtained from full scale experiments indicates that the equivalent saturated thruster dynamics are represented by the following equation sørensen et al 1996 4 τ s a t r τ s a t r sat τ c herein 5 a t r d i a g 1 t t r 1 1 t t r 2 1 t t r 3 with t t r 1 t t r 2 and t t r 3 as equivalent thruster time constants in surge sway and yaw and sat τ c sat τ c 1 sat τ c 2 sat τ c 3 t as the saturation function vector the commanded control signals are subject to saturation constraints due to the physical limitation of thrusters i e du et al 2016 6 sat τ c i τ i max if τ c i τ i max τ c i if τ i min τ c i τ i max i 1 2 3 τ i min if τ c i τ i min with τ c t τ c 1 t τ c 2 t τ c 3 t t as the commanded control vector calculated by the tracking controller as well as τ i max and τ i min as the equivalent maximum and the minimum thruster saturation limits here notate δ τ s sat τ c τ c as the control deviation vector as such the vessel movement model becomes the three order equation with mismatched disturbances due to the inclusion of saturated thruster dynamics 2 2 reference trajectory for realizing the vessel synchronous navigation the reference trajectory η r is defined as kyrkjebø 2007 7 η r η m j ψ m l where η r x r y r ψ r t defines the reference trajectory and η m x m y m ψ m t defines the main vessel s position and heading vector herein 8 j ψ m cos ψ m sin ψ m 0 sin ψ m cos ψ m 0 0 0 1 l l m cos γ m l m sin γ m 0 where l m denotes the distance between the reference trajectory and the gravity center of the main vessel and γ m denotes the angle of the connection line between the reference trajectory and the gravity center of the main vessel relative to the main vessel s bow direction as illustrated in fig 1 as such the synchronous navigation problem between the supply and the main vessels is converted into the synchronization tracking of the supply vessel along with the reference trajectory η r control objective this work develops an adaptive synchronization tracking control scheme with disturbance rejection and thrust saturation compensation capabilities for the surface vessel movement model 1 6 under marine disturbances and saturated thruster dynamics such that the supply vessel closed loop control system is stable and the supply vessel tracks the reference trajectory thereby achieving the synchronous navigation along with the main vessel with the main vessel with adjustable small errors 3 adaptive synchronization tracking design the adaptive synchronous tracking design builds on the adaptive disturbance estimation the auxiliary dynamic filter and the adaptive command filtered backstepping the adaptive laws incorporating projection operators together with the observer achieve the disturbance estimation then the auxiliary dynamic filter generates the filtered versions of the non achievable portions of vessel s positions and velocities which are employed to prevent the saturation effects from corrupting the disturbance estimation and rejection performance based on the fusion of the adaptive command filtered backstepping the adaptive synchronization tracking control law is derived fig 2 shows the schematic of the vessel synchronous tracking control system 3 1 marine disturbance representation the marine disturbances due to the unpredictable environment are decomposed as the multiple harmonic superpositions hu et al 2020a 9 d s i t j 1 q a i j sin ω i j t ι i j i 1 2 3 with unknown amplitudes a i j unknown frequencies ω i j and unknown phases ι i j i 1 2 3 j 1 2 q respectively here the value q represents the number of harmonic components remark 1 the marine disturbances are decomposed into the different sinusoidal components by means of the fourier analysis furthermore the marine disturbances are difficult to identify therefore the disturbance amplitudes frequencies and phases are unknown the marine harmonic disturbances 9 are expressed as the output vector of the parametric uncertain exogenous system hu et al 2020b as 10 ξ w ξ 11 d s v ξ where ξ r 6 q denotes the state vector the coefficient matrices w r 6 q 6 q and v r 3 6 q are w w 1 w 2 w 3 6 q 6 q v v 1 v 2 v 3 3 6 q with w i r 2 q 2 q and v i r 1 2 q as w i 0 ω i 1 ω i 1 0 0 ω i q ω i q 0 2 q 2 q v i 1 0 1 0 1 0 1 2 q herein the eigenvalues of the matrix w i are located on the imaginary axis the coefficient matrices w and v are assumed to be unknown and are only required for the analytical purpose lemma 1 hu et al 2019 let π r 6 q 6 q and λ r 6 q 3 being design matrices with π λ being controllable and π being hurwitz then there exists a nonsingular solution t r 6 q 6 q of the sylvester matrix equation t w π t λ v based on the sylvester matrix equation the exogenous system 10 11 is transformed into the unknown disturbance input canonical model as 12 γ π γ λ d s 13 d s θ t γ where the state vector γ depends on the state vector ξ in 10 11 by the coordinate change γ t ξ the regression matrix θ θ 1 θ 2 θ 3 r 6 q 3 is the unknown parameter matrix with θ i r 6 q i 1 2 3 as the column vectors proof along the solutions of 10 and 11 and the sylvester matrix equation t w π t λ v the time derivative of the coordinate change γ t ξ is 14 γ π t λ v ξ π γ λ d s substituting ξ t 1 γ into 11 obtains 15 d s v t 1 γ θ t γ where θ v t 1 t hence the parametric uncertain exogenous system 10 11 is transformed into the unknown disturbance input canonical model 12 13 remark 2 by means of the parametric uncertain exogenous system 10 11 the marine harmonic disturbances are described as the output vector of the linear canonical model 12 13 where the disturbances are converted into the parameterized form d s θ t γ as such the disturbance estimation and rejection are transformed into the adaptive problem 3 2 adaptive command filtered backstepping design define the following three coordinate changes 16 z 1 η s η r ζ 1 17 z 2 ν s β 1 1 ζ 2 18 z 3 τ s β 2 1 ζ 3 where β 1 1 β 2 1 r 3 are filtered virtual stabilizing function vectors to be designed later and ζ 1 ζ 2 ζ 3 r 3 are produced by the auxiliary dynamic filter 19 ζ 1 k 1 ζ 1 j ψ s ζ 2 20 ζ 2 m s 1 k 2 ζ 2 m s 1 ζ 3 21 ζ 3 a t r k 3 ζ 3 a t r δ τ s where k 1 k 1 t and k 2 k 2 t are 3 3 positive definite design matrices remark 3 it is noted from the auxiliary dynamic filter 19 21 that the state vectors ζ 1 ζ 2 and ζ 3 represent the filtered versions of non achievable portions of position η s velocity ν s and control vector τ s of the vessel induced by δ τ s the state vectors ζ 1 ζ 2 and ζ 3 are introduced to on line correct the control errors z 1 z 2 and z 3 for preventing the presence of thruster saturation effects from corrupting the adaptive disturbance rejection performance the adaptive backstepping synchronization design is presented in the following step 1 by fusions of 1 7 and 19 the time derivative of the error vector 16 is 22 z 1 j ψ s ν s j ψ m ν m j ψ m l k 1 ζ 1 j ψ s ζ 2 where ν m u m v m r m t defines the main vessel s velocity vector and 23 j ψ m cos ψ m sin ψ m 0 sin ψ m cos ψ m 0 0 0 1 0 r m 0 r m 0 0 0 0 0 j ψ m s r m with s r m 0 r m 0 r m 0 0 0 0 0 in term of 23 eq 22 becomes 24 z 1 j ψ s ν s j ψ m ν m j ψ m s r m l k 1 ζ 1 j ψ s ζ 2 design the virtual stabilizing function vector ϱ 1 as 25 ϱ 1 j t ψ s k 1 z 1 k 1 ζ 1 j ψ m ν m j ψ m s r m l let ϱ 1 pass through the command filter 26 to obtain β 1 1 26 β 1 1 ω 1 β 1 2 β 1 2 2 ς 1 ω 1 β 1 2 ω 1 β 1 1 ϱ 1 herein the initial conditions are set as β 1 1 0 ϱ 1 0 and β 1 2 0 o 3 1 then there exist ω 1 0 and ς 1 0 1 such that β 1 1 ϱ 1 β 1 1 β 1 1 and β 1 1 are bounded as detailed in yu et al 2015 introduce the compensating filter 27 to offset the filter error β 1 1 ϱ 1 and then define the compensated tracking error ϑ 1 as follows 27 ξ 1 k 1 ξ 1 j ψ s β 1 1 ϱ 1 j ψ s ξ 2 28 ϑ 1 z 1 ξ 1 in the light of 24 j ψ s j t ψ s i 3 3 17 and 25 it is obtained that 29 z 1 j ψ s ϱ 1 j ψ s β 1 1 ϱ 1 j ψ s ν s β 1 1 j ψ m ν m j ψ m s r m l k 1 ζ 1 j ψ s ζ 2 k 1 z 1 j ψ s β 1 1 ϱ 1 j ψ s z 2 step 2 using 2 and 20 the derivative of the error vector 17 is derived as 30 z 2 m s 1 τ s d s f s ν s ν s m s β 1 1 k 2 ζ 2 ζ 3 where f s ν s c s ν s d s ν s represents vessel nonlinear dynamics noticing that marine harmonic disturbances are expressed as the output vector of the linear canonical model described by 12 13 the nonlinear observer is established to estimate the unknown regressor γ in 12 13 as follows 31 γ ˆ β n ν s 32 β π β π n n m s 1 f s ν s ν s n m s 1 τ s where γ ˆ r 6 q is the estimation vector of the unknown regressor γ in 12 13 and β r 6 q is the auxiliary vector here the design matrix n r 6 q 3 is given by n m s 1 λ define the estimation error vector 33 γ γ ˆ γ based on 2 12 and 31 32 the time derivative of 33 is 34 γ π β π n n m s 1 f s ν s ν s n m s 1 τ s n m s 1 f s ν s ν s n m s 1 τ s λ d s π γ λ d s π β n ν s γ π γ remark 4 note that the matrix π is specified to be hurwitz in 34 the estimation error vector γ exponentially decays substituting γ γ ˆ γ into 13 obtains 35 d s θ t γ ˆ θ t γ remark 5 it is obtained from the disturbance parametric representation 35 that the uncertainties of marine disturbances are lumped into the parametric uncertainty of θ design the virtual stabilizing function vector ϱ 2 as 36 ϱ 2 j t ψ s ϑ 1 k 2 z 2 f s ν s ν s m s β 1 1 θ ˆ t γ ˆ k 2 ζ 2 where θ ˆ θ ˆ 1 θ ˆ 2 θ ˆ 3 r 6 q 3 is the parameter matrix with θ ˆ i r 6 q i 1 2 3 as the column vectors to be on line updated later let ϱ 2 pass through the command filter 37 to obtain β 2 1 37 β 2 1 ω 2 β 2 2 β 2 2 2 ς 2 ω 2 β 2 2 ω 2 β 2 1 ϱ 2 herein the design parameters ω 2 0 and ς 2 0 1 and the initial conditions are set as β 2 1 0 ϱ 2 0 and β 2 2 0 o 3 1 introduce the compensating filter 38 to offset the filter error β 2 1 ϱ 2 and then define the compensated tracking error ϑ 2 as follows 38 ξ 2 m s 1 k 2 ξ 2 β 2 1 ϱ 2 39 ϑ 2 z 2 ξ 2 to update the adaptive parameter matrix θ ˆ θ ˆ 1 θ ˆ 2 θ ˆ 3 in 36 the adaptive laws are designed incorporating projection operators for preventing the parameter drifts as follows 40 θ ˆ i γ i proj ϑ 2 i γ ˆ θ ˆ i i 1 2 3 where γ i γ i t is 6 q 6 q positive definite design matrix and proj denotes the projection operator detailed in appendix a in the light of 18 and 30 35 and 36 it is obtained that 41 m s z 2 f s ν s ν s ϱ 2 β 2 1 ϱ 2 τ s β 2 1 θ t γ ˆ θ t γ m s β 1 1 k 2 ζ 2 ζ 3 k 2 z 2 j ψ s ϑ 1 θ t γ ˆ θ t γ β 2 1 ϱ 2 z 3 where θ θ ˆ θ remark 6 the mismatched harmonic disturbances are on line estimated from the adaptive laws 40 together with the observer 31 32 by θ ˆ t γ ˆ θ ˆ 1 t γ ˆ θ ˆ 2 t γ ˆ θ ˆ 3 t γ ˆ t in the adaptive command filtered backstepping framework the adaptive laws 40 combined with the observer 31 32 constitute the adaptive disturbance observer the surface vessel synchronization tracking controller has the disturbance rejection capability step 3 based on 4 and 21 and δ τ s sat τ c τ c the time derivative of the error vector 18 is 42 z 3 a t r τ s a t r τ c δ τ s β 2 1 a t r k 3 ζ 3 a t r δ τ s design the adaptive command tracking controller as 43 τ c k 3 z 3 τ s ϑ 2 a t r 1 β 2 1 k 3 ζ 3 in the light of 42 and 43 it follows that 44 z 3 a t r k 3 z 3 ϑ 2 remark 7 due to the inclusion of saturated thruster dynamics the vessel movement model becomes the three order equation the traditional adaptive backstepping takes repeated derivations ϱ 1 and ϱ 2 of virtual stabilizing function vectors yang et al 2014 the repeated derivations are avoided due to the command filters 26 and 37 furthermore the filter errors β 1 1 ϱ 1 and β 2 1 ϱ 2 are eliminated by utilizing the compensating filters 27 and 38 the computational burden is reduced with the adaptive command filtered backstepping remark 8 under the saturated thruster dynamics the disturbance rejection performance is ensured by fusions of the adaptive estimation technique and the auxiliary dynamic filter in combination with the adaptive command filtered backstepping the disturbance estimation and rejection are transformed into the adaptive problem the auxiliary dynamic filter generates the state vectors as the filtered versions of the non achievable portions of vessel s positions and velocities due to thruster saturation effects the state vectors then on line correct the control errors for preventing the saturation effects from corrupting the disturbance estimation and rejection performance 3 3 supply vessel closed loop stability analysis theorem 1 consider the surface vessel movement model 1 6 with nonlinear coriolis and damping terms subject to saturated thruster dynamics under unknown marine disturbances by designing the adaptive command tracking controller 43 with the virtual stabilizing function vectors 25 and 36 the adaptive laws 40 the nonlinear observer 31 32 and the auxiliary dynamic filter 19 21 the supply vessel synchronization tracking closed loop control system is uniformly ultimately stable the supply vessel tracks the reference trajectory thereby achieving the synchronous navigation along with the main vessel with adjustable small errors proof from 28 29 38 39 41 44 and letting ϑ 3 z 3 the error dynamics are 45 ϑ 1 k 1 ϑ 1 j ψ s ϑ 2 46 ϑ 2 m s 1 k 2 ϑ 2 j ψ s ϑ 1 θ t γ ˆ θ t γ ϑ 3 47 ϑ 3 a t r k 3 ϑ 3 ϑ 2 for the error dynamics 45 47 the following control lyapunov function is selected 48 v c 1 2 ϑ 1 t ϑ 1 1 2 ϑ 2 t m s ϑ 2 1 2 ϑ 3 t a t r 1 ϑ 3 1 2 i 1 3 θ i t γ i 1 θ i γ t q γ herein the positive definite matrix q r 6 q 6 q belongs to the solution of the matrix equation 49 π t q q t π θ θ t along the trajectories of 40 45 47 and 49 the derivative of 48 is given as 50 v c ϑ 1 t k 1 ϑ 1 ϑ 2 t k 2 ϑ 2 ϑ 3 t k 3 ϑ 3 ϑ 2 t θ t γ ˆ ϑ 2 t θ t γ i 1 3 θ i t proj ϑ 2 i γ ˆ θ ˆ i γ t π t q q π γ ϑ 1 t k 1 ϑ 1 ϑ 2 t k 2 ϑ 2 ϑ 3 t k 3 ϑ 3 ϑ 2 t θ t γ γ t θ θ t γ it follows from the young s inequality that 51 ϑ 2 t θ t γ 1 4 ϑ 2 t ϑ 2 γ t θ θ t γ by using 51 eq 50 becomes 52 v c ϑ 1 t k 1 ϑ 1 ϑ 2 t k 2 1 4 i 3 3 ϑ 2 ϑ 3 t k 3 ϑ 3 κ ϑ 1 2 ϑ 2 2 ϑ 3 2 herein κ min λ min k 1 λ min k 2 1 4 i 3 3 λ min k 3 with λ min denoting the minimum eigenvalue the design matrix k 2 is required to satisfy λ min k 2 1 4 it is indicated from 48 and 52 that the time derivative v c is negative semi definite hence the control lyapunov function v c is uniformly ultimately bounded this implies that ϑ 1 ϑ 2 ϑ 3 γ and θ i i 1 2 3 are bounded signals furthermore the control signal τ s is always bounded under saturated thruster dynamics 4 and the disturbance d s in 9 is bounded integrating 52 on 0 t then 53 0 t ϑ 1 ħ 2 ϑ 2 ħ 2 ϑ 3 ħ 2 d ħ 1 κ v c 0 v c t this implies that 54 lim t 0 t ϑ 1 ħ 2 ϑ 2 ħ 2 ϑ 3 ħ 2 d ħ 1 κ v c 0 from 54 the 2 norm ϑ 1 is square integrable it is proved theoretically by barbalat lemma in appendix b that 55 lim t ϑ 1 lim t η s η r ζ 1 ξ 1 0 to further obtain the convergence regions of ζ 1 and ξ 1 the auxiliary control lyapunov function is provided as 56 v ζ 1 2 ζ 1 t ζ 1 1 2 ζ 2 t m s ζ 2 1 2 ζ 3 t a t r 1 ζ 3 1 2 ξ 1 t ξ 1 1 2 ξ 2 t m s ξ 2 along the trajectories of 19 21 27 38 det j ψ s 1 and young s inequality the time derivative v ζ is 57 v ζ ζ 1 t k 1 1 2 i 3 3 ζ 1 ζ 2 t k 2 i 3 3 ζ 2 ζ 3 t k 3 i 3 3 ζ 3 ξ 1 t k 1 i 3 3 ξ 1 ξ 2 t k 2 i 3 3 ξ 2 1 2 δ τ s 2 1 2 β 1 1 ϱ 1 2 1 2 β 2 1 ϱ 2 2 2 μ v ζ c herein μ min λ min k 1 i 3 3 λ min k 2 i 3 3 λ min k 3 i 3 3 and c 1 2 sup t 0 δ τ s 2 1 2 sup t 0 β 1 1 ϱ 1 2 1 2 sup t 0 β 2 1 ϱ 2 2 it is indicated from 57 that 58 ζ 1 c μ 2 v ζ 0 c 2 α e 2 μ t 59 ξ 1 c μ 2 v ζ 0 c 2 μ e 2 μ t it is concluded from 55 58 and 59 that the synchronization tracking error settles within the compact set ω η s η r δ η δ η 2 c μ it is indicated from the expressions of the notations c and μ that the surface vessel s position tracking error is able to be adjusted small through artfully setting design parameters satisfying λ min k 1 1 λ min k 2 1 and λ min k 3 1 this means that the supply vessel tracks the reference trajectory thereby achieving the synchronous navigation along with the main vessel with adjustable small errors this completes the proof 4 illustrative simulations with comparisons 4 1 proposed adaptive synchronization control evaluation the proposed adaptive synchronization tracking control scheme is evaluated numerically on a typical fully actuated supply vessel the equivalent thruster saturation limits are given in table 1 the fully actuated supply vessel s inertia matrix coriolis and centripetal matrix and damping matrix liu et al 2018 are summarized in box i see eqs 60 66 given in box i to evaluate the robustness and adaptability of the adaptive synchronization tracking control scheme the simulations are conducted on the supply vessel in different disturbance cases disturbance case 1 the marine disturbances as the superposition of harmonic components are set by d s t j t ψ s 5 26 1 0 4 sin 0 02 t 7 89 1 0 4 sin 0 04 t 1 052 1 0 5 sin 0 02 t π 6 1 315 1 0 5 sin 0 03 t 1 578 1 0 5 sin 0 09 t π 3 2 104 1 0 5 sin 0 01 t furthermore to simulate the marine environment the surface vessel s wave frequency oscillatoric motion components are fossen 2011 67 x w y w ψ w t h w s w h w s w h w s w 180 π t with the gaussian white noise w and the wave transfer function h s as 68 h w s 2 ς 0 ω 0 σ w s s 2 2 ς 0 ω 0 s ω 0 2 where ς 0 denotes the damping coefficient ω 0 denotes the dominating wave frequency as well as σ w denotes the constant describing wave intensities these parameters are set as ς 0 0 1 ω 0 0 8 and σ w 0 5 furthermore the sensor measurement noises are set as the gaussian white noises with the standard deviations 0 05 m 0 05 m and 0 1 18 0 π rad in the north position the east position as well as the heading respectively the equivalent thruster time constants are t t r 1 t t r 2 t t r 3 5 s in surge sway and yaw respectively the initial conditions are set as η 0 0 m 250 m 0 ν 0 0 m s 0 m s 0 s ζ 1 0 ζ 2 0 ζ 3 0 o 3 1 ξ 1 0 ξ 2 0 o 3 1 γ ˆ 0 o 12 1 β 0 o 12 1 θ ˆ 1 0 θ ˆ 2 0 θ ˆ 3 0 o 12 1 the command filter parameters are set as ω 1 1 5 ω 2 1 7 ς 1 ς 2 0 9 the design parameters of the adaptive laws are γ 1 γ 2 γ 3 1 0 7 i 12 12 the design parameters of the observer and the controller are specified as π d i a g 0 41 0 42 0 43 0 44 0 35 0 36 0 37 0 38 0 45 0 46 0 47 0 48 λ 1 0 0 1 0 0 1 0 0 1 0 0 0 1 0 0 1 0 0 1 0 0 1 0 0 0 1 0 0 1 0 0 1 0 0 1 n λ m s and k 1 d i a g 0 9 0 9 0 2 k 2 d i a g 6 1 0 5 1 1 1 0 6 2 1 0 9 k 3 d i a g 0 2 0 2 0 2 simulation results in the disturbance case 1 under the adaptive synchronization tracking control are provided with the solid lines in fig 3 a 3 e the quantitative performance indices are given in table 2 where the mean errors in north east and yaw are defined in 69 71 it is shown from figs 3 a and 3 b that the supply vessel tracks the reference trajectory implying that the synchronous navigation between the supply and the main vessels is realized table 2 demonstrates the satisfactory tracking performance of the surface vessel it is observed from fig 3 c that the vessel s velocities u in surge v in sway and r in yaw are bounded it is illustrated from fig 3 d that the commanded control signals sat τ c 1 sat τ c 2 and sat τ c 3 are reasonable within the acceptable ranges of thruster working conditions it is clearly obtained from fig 3 e that the adaptive laws 40 together with the observer 31 32 provide the online estimations θ ˆ 1 t γ ˆ θ ˆ 2 t γ ˆ θ ˆ 3 t γ ˆ for marine harmonic disturbances d s 1 t d s 2 t and d s 3 t acting on the supply vessel 69 mean error in north 1 3000 0 3000 x t x d d t 70 mean error in east 1 3000 0 3000 y t y d d t 71 mean error in yaw 1 3000 0 3000 ψ t ψ d 180 π d t disturbance case 2 the marine environmental condition becomes harsh through enlarging disturbances as follows d s t 3 j t ψ s 5 26 1 0 4 sin 0 02 t 7 89 1 0 4 sin 0 04 t 1 052 1 0 5 sin 0 02 t π 6 1 315 1 0 5 sin 0 03 t 1 578 1 0 5 sin 0 09 t π 3 2 104 1 0 5 sin 0 01 t the initial conditions the command filter parameters as well as the observer and the controller design parameters are adopted as same as the counterparts specified in the disturbance case 1 this means that the adaptive synchronization tracking control remains identical in different cases simulation results in the disturbance case 2 under the adaptive synchronization tracking control are provided with the solid lines in fig 4 a 4 e the control performance indices are given in table 2 it is observed from fig 3 a 3 e 4 a 4 e and table 2 that the designed adaptive synchronization tracking controller still exhibits the satisfactory control performance in the disturbance case 2 in particular it is concluded from fig 4 e that the adaptive disturbance estimation performance is still satisfactory especially under the effects of saturated thruster dynamics 4 2 comparison with existing adaptive synchronization control to illustrate the superiority of the adaptive synchronization tracking scheme the comparisons between the designed adaptive synchronization tracking controller and the following existing robust adaptive synchronization control 72 85 are presented define the following coordinate changes 72 z c 1 η s η r 73 z c 2 ν s β c 1 1 74 z c 3 τ s β c 2 1 design the virtual stabilizing function vectors as 75 ϱ c 1 j t ψ s k 1 z c 1 j ψ m ν m j ψ m s r m l 76 ϱ c 2 j t ψ s ϑ c 1 k 2 z c 2 f s ν s ν s m s β c 1 1 θ ˆ c m t γ ˆ c m let ϱ c 1 and ϱ c 2 pass through the command filters 77 and 78 respectively 77 β c 1 1 ω 1 β c 1 2 β c 1 2 2 ς 1 ω 1 β c 1 2 ω 1 β c 1 1 ϱ c 1 78 β c 2 1 ω 2 β c 2 2 β c 2 2 2 ς 2 ω 2 β c 2 2 ω 2 β c 2 1 ϱ c 2 introduce the compensating filters to reduce the effects of the filter errors 79 ξ c 1 k 1 ξ c 1 j ψ s β c 1 1 ϱ c 1 j ψ s ξ c 2 80 ξ c 2 m s 1 k 2 ξ c 2 β c 2 1 ϱ c 2 the existing auxiliary dynamic filter generates the state vector χ c to directly modify the control signals as follows du et al 2016 81 χ c k χ χ c i 1 3 z c 2 i δ τ s c i 0 5 δ τ s c t δ τ s c χ c χ c δ τ s c χ c ε 0 3 1 χ c ε furthermore the nonlinear observer 82 83 and the adaptive laws 84 incorporating the projection operators are designed then the existing adaptive command tracking controller 85 is presented 82 γ ˆ c m β c m n ν s 83 β c m π β c m π n n m s 1 f s ν s ν s n m s 1 τ s 84 θ ˆ c m i γ i proj ϑ c 2 i γ ˆ c m θ ˆ c m i i 1 2 3 85 τ c m k 3 z c 3 τ s ϑ c 2 a t r 1 β c 2 1 k ħ χ where ϑ c i z c i ξ c i i 1 2 for the existing auxiliary dynamic filter the corresponding parameters are selected as k χ d i a g 5 0 5 0 5 0 and k ħ d i a g 1 0 1 0 1 0 to ensure fairness of comparison the other design parameters are as same as the counterparts of the proposed adaptive synchronization control scheme simulation comparison results under the existing synchronization control based on the auxiliary dynamic filter 81 in the disturbance cases 1 and 2 are provided with the dashed lines in figs 3 a 3 d 3 f and figs 4 a 4 d 4 f respectively furthermore the control performance indices in the disturbance cases 1 and 2 are provided in table 2 it is clearly observed from figs 3 a 4 a and table 2 that the existing adaptive synchronization control achieves the acceptable control performance in the disturbance case 1 however it results in the unacceptable control performance in the disturbance case 2 it is illustrated from fig 4 d that the commanded control signals sat τ c m 1 sat τ c m 2 and sat τ c m 3 reach saturation limits and are unsatisfactory in the disturbance case 2 it is obviously shown from fig 4 f that the performance of the existing disturbance observer 82 84 is destroyed in the presence of saturated thruster dynamics in summary the proposed adaptive synchronization control scheme achieves the disturbance rejection and the thruster saturation compensation simultaneously the marine time varying disturbance estimation performance is satisfactory in the presence of saturated thruster dynamics this is attributed that the disturbance estimation and rejection are transformed into the adaptive problem the auxiliary dynamic filter generates the state vectors as the filtered versions of the non achievable portions of the vessel s positions and velocities due to saturated thruster dynamics these state vectors on line correct the control errors for preventing the saturation effects from corrupting the adaptive disturbance estimation and rejection performance therefore the designed adaptive synchronization scheme is superior and practical 5 conclusions under the saturated thruster dynamics the adaptive synchronization scheme has been presented for the surface vessels through artfully transforming the disturbance estimation and rejection into the adaptive problem the adaptive techniques together with the observer achieve the disturbance estimation the auxiliary dynamic filter generates the state vectors as the filtered versions of non achievable portions of the vessel s positions and velocities due to the saturated thruster dynamics the state vectors on line correct the control errors for preventing the saturation effects from corrupting the adaptive disturbance estimation and rejection performance the theoretical analysis and comparative simulations demonstrate that the supply vessel tracks the reference trajectory under the adaptive synchronization tracking controller thereby achieving the synchronous navigation with the main vessel future research work will focus on alleviating the requirement on main vessel velocities and including vessel dynamic uncertainties credit authorship contribution statement xin hu conceptualization methodology software validation formal analysis investigation resources writing original draft writing review editing xinjiang wei writing review editing guibing zhu resources defeng wu resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported partly by the national natural science foundation of china under grants 61903174 61973149 61803195 61903092 partly by the natural science foundation of shandong province china under grant zr2019pf006 and partly by the outstanding youth innovation team project of shandong higher education institution china under grand 2019kjn017 appendix a projection operator a projection operator proj w θ ˆ a is defined by 86 proj w θ ˆ a w if p θ ˆ a 0 w if p θ ˆ a 0 and p θ ˆ a θ ˆ a t w 0 w p θ ˆ a p θ ˆ a p θ ˆ a t p θ ˆ a 2 w otherwise herein p θ ˆ a θ ˆ a 2 r ω 2 ε 2 2 ε r ω with ε being an arbitrary positive real if θ ˆ a 0 is bounded the property θ a t proj w θ ˆ a θ a t w θ a θ ˆ a θ a holds appendix b barbalat s lemma for a vector signal ħ t r m if 0 ħ t 2 d t c 1 and sup t 0 ħ t 2 c 2 for positive constants c 1 and c 2 then lim t ħ t 0 
21497,an opportunistic maintenance policy for offshore wind farms jichuan kang methodology formal analysis visualization writing original draft a b c c guedes soares writing review editing supervision a c a centre for marine technology and ocean engineering centec instituto superior técnico universidade de lisboa lisbon portugal centre for marine technology and ocean engineering centec instituto superior técnico universidade de lisboa lisbon portugal centre for marine technology and ocean engineering centec instituto superior tecnico universidade de lisboa lisbon portugal b college of shipbuilding engineering harbin engineering university harbin china college of shipbuilding engineering harbin engineering university harbin china college of shipbuilding engineering harbin engineering university harbin china c international joint laboratory of naval architecture and offshore technology between harbin engineering university and the university of lisbon harbin 150001 china international joint laboratory of naval architecture and offshore technology between harbin engineering university and the university of lisbon harbin 150001 china heu ul international joint laboratory of naval architecture and offshore technology harbin china corresponding author centre for marine technology and ocean engineering centec instituto superior técnico universidade de lisboa lisbon portugal centre for marine technology and ocean engineering centec instituto superior técnico universidade de lisboa lisbon portugal an opportunistic maintenance policy for offshore wind farms is introduced considering imperfect maintenance and the weather window effect each wind turbine is regarded as a multi component system divided into several assemblies when one unit fails or reaches its critical degradation state there is an opportunity to implement preventive maintenance for the others reducing the losses of accidental failures on the basis of the rolling horizon approach the system condition is updated after the completion of a maintenance activity by selecting the optimized maintenance combination at every opportunity the maintenance plan over the mission period is finalized the uncertainty of maintenance effectiveness and the costs of the time waiting for a weather window are also considered failure information is collected from existing literature to accomplish the calculations calculated results indicate that the proposed approach is beneficial to save the maintenance expenditure of offshore wind farms keywords opportunistic maintenance offshore wind farm weather condition imperfect maintenance 1 introduction offshore wind turbines owt have several advantages compared with onshore ones however the complex and varied marine environment has brought great challenges to the transportation installation and operation of the equipment offshore wind farms started with fixed support structures in relatively shallow water depth close to coast but have been expanding to deeper water and larger distances from coast diaz and guedes soares 2020 the present tendency is to see the transition to floating wind turbines concepts uzunoglu et al 2016 the systems are subject to various types of external and internal damages resulting from the system deterioration and harsh marine environment kang et al 2019b for an owt whose design life can be considered as 20 years the operation and maintenance o m costs represent about 25 30 of the overall energy generation cost or 75 90 of the investment costs when considering the lifetime márquez et al 2012 castro santos et al 2016 2020a b this can be explained by insufficient accessibility due to the unpredictable weather and the remote location more failures than the onshore ones owing to the marine environment extra inventory expense as specific vessels and technicians are needed previous literature reported attempts to minimize the offshore wind farm o m costs besnard et al 2012 proposed a calculation model for the cost based optimization and selection of a maintenance support organization for an offshore wind farm taking into account the location of the maintenance accommodation the number of repairmen and the use of helicopters costa et al 2015 identified the most representative failures of wind farms and then presented an innovative way to analyse wind farm o m according to weather dalgic et al 2015 introduced an optimization method of offshore wind farms o m aims at minimum failure loss and maximum power production considering the weather conditions failure features of different system components and different choices of transfer vessels santos et al 2015a 2018 2019 introduced generalized stochastic petri nets gspn to model the maintenance activities of an owt considering the logistics and weather conditions constraints santos et al 2014 the results proved that the presented gspn method is a feasible solution for o m optimization in terms of multi component systems such as owts an inspection or maintenance activity of one component provides an early preventive maintenance pm opportunity to the others santos et al 2015a the advantage of opportunistic maintenance om includes 1 combined maintenance activities can share the setup cost which is significant for owts 2 the downtime can also be shared as long as the maintenance resources including vessels technicians and tools are sufficient however when the advanced maintenance date leads to the loss of components remaining useful life rul the pm should not be performed the om optimization aims to identify the best maintenance date and combination improving the system economy sarker and faiz 2016 formulated a multi level opportunistic pm policy the overall maintenance expenditure is a function of the number of age groups for components calculated results demonstrated that the presented approach was effective to cut down the maintenance expenditure of owts abdollahzadeh et al 2016 introduced a multi objective om optimization method considering the stochastic behaviour of wind and limited maintenance resources the availability of the presented method is proved by comparative analysis lu et al 2017 provided a maintenance grouping optimization method for owt electrical and electronic system considering pm opportunities the maintenance planning which can be changed with time can be updated based on short term information the results showed that o m expenditure can be significantly saved by selecting the best repair time and components combination however the implementation of an om strategy also faces challenges in practice maintenance activities cannot often recover the system back to the as good as new status and it is difficult to implement all the ideal repair activities because of limited maintenance resources ding and tian 2012 proposed an om policy that introduced various imperfect maintenance thresholds for a malfunction turbine and a functional turbine belsak and flasker 2007 introduced a method of detecting cracks in the tooth of gears considering vibration signals monitoring and time frequency analysis the availability of the presented approach in maintenance policy making is demonstrated by the reliability of identifying the failure mode the presented policy demonstrated the influence of maintenance uncertainty as a significant maintenance constraint the influence of weather has attracted increasing attention in recent years generally a maintenance decision making process usually depends on static thresholds in order to ensure the process more feasible to the particular environmental conditions erguido et al 2017 introduced dynamic reliability thresholds which varied based on the weather conditions for opportunistic maintenance model the proposed approach showed better performance on saving the life cycle cost of a wind farm compared to the conventional one scheu et al 2012 presented an approach to model both wave and wind conditions for offshore sites have been using discrete finite state markov theory aiming to simulate the operational process of offshore wind farms and to assist the maintenance decision making in the current study an opportunistic strategy is introduced to minimize the maintenance cost for offshore wind farms considering degradation process the maintenance effectiveness uncertainty and the waiting time caused by the changeable marine environment sobral et al 2019 sobral and guedes soares 2019 owts suffer harsh marine environment therefore the deterioration of components is notable and maintenance activities are not always perfect ding and tian 2011 in this paper the rolling horizon approach is employed to renew the maintenance schedule based on the operating data meanwhile the uncertainty of maintenance effectiveness is considered by introducing two parameter age reduction factors and the extra downtime results from changeable marine weather is also addressed the rest of this paper is divided into four sections the description of the owt system and its failure model are described in section 2 the proposed opportunistic maintenance model is developed in section 3 section 4 performs a case study to investigate the accuracy and feasibility of the presented maintenance strategy the conclusions and further works are summarized in section 5 2 owt system and failure model description 2 1 owt system description an owt can be divided into several subsystems based on different functions bagbanci et al 2012 fig 1 presents the schematic structure of the owt components carroll et al 2016 collected and analysed the failure rate repair time and maintenance cost of owt the statistical data are based on 350 owts which are between 3 and 10 years old and from between 5 and 10 wind farms throughout europe the results reveal that pitch system and power system have the highest failure rates and gearbox has the highest average cost per failure the downtime of gearbox and rotor bhardwaj et al 2019 li et al 2019 faulstich et al 2011 are the longest which can be explained by the high installation position and weight this study focuses on these four crucial sub systems i e pitch system power system gearbox and rotor rotor and power system are integrations of several major components which should be studied respectively therefore the rotor was divided into blades and rotor hub and the power system is divided into generator converter and transformer 2 2 failure model description owts are subject to wind wave and current loads year after year hence when describing the failure model of the system the degradation phenomena cannot be ignored the external cumulative shocks and internal material ageing are the two main factors that derive the degradation process santos et al 2016 according to le and andrews 2016 the failure of owts follows a weibull distribution t is the time to failure α and β are two parameters of weibull distribution the distribution function f t and probability density f t can be described by 1 f t pr t t 1 e t α β for t 0 and 2 f t d d t f t β α t α e t α β for t 0 the corresponding survivor function is 3 r t pr t 0 e t α β for t 0 the function of failure rate can be derived as 4 λ t f t r t β α t α β 1 for t 0 where α is the scale parameter and β represents the shape parameter in terms of the failure model for imperfect maintenance malik 1979 first introduced age reduction factor to model imperfect maintenance assume that t i and λ i t represent the pm period and failure rate before the i th maintenance activity the failure rate after the i th recovery should be λ i t a i t i t 0 t i 1 where a i 0 a i 1 is the age reduction factor indicating that when the repair process is not perfect the system condition will be improved after each repair but it will never return to the original functional state nakagawa 1988 proposed a different failure model in which the failure rate after the i th maintenance action is b i λ i t t 0 t i 1 where b i b i 1 denotes failure rate increase factor in this model the system will return to as good as new state after repair but fails faster than before lin et al 2000 presented a hybrid model that combines age reduction factor and failure rate increase factor it can be described by 5 λ i 1 t b i λ i t a i t i t 0 t i 1 in eq 4 a i 0 a i 1 represents age reduction factor and b i b i 1 represents failure rate increase factor the maintenance effect is better when bi is close to 1 and a i is close to 0 t i is the i th maintenance interval the hybrid model illustrated in fig 2 can comprehensively consider the variation of failure rate and reliability during each maintenance cycle in practice the values of a i and b i are usually random and uncertain this study assumes that in the actual work the probability distribution of a i and b i follows a gaussian distribution monte carlo simulation method is implemented to conduct a random sampling to convert the uncertainty of a i and b i into the estimated maintenance state 3 methodology the downtime of owt brings an opportunity to joint maintenance activities this section proposes a maintenance method that aims to take advantage of the opportunity to determine the optimized maintenance plan aiming to obtain the minimum long term operational expenditure 3 1 assumptions the om method proposed in this study is based on the following assumptions 1 owt is regarded as a multi component system consisting of n independent units a binary model is applied to describe the condition of each unit which means that the components are either in a functional or failure state 2 the components might fail randomly anytime and will be minimally repaired 3 in an offshore wind farm with m identical owts the time consumption from one owt to another is negligible for the maintenance technicians 3 2 dynamic reliability threshold calculation according to the om strategy the maintenance decision for each component can be concluded in one of the three situations scenario 1 a corrective maintenance cm is performed when a random malfunction happens scenario 2 whenever the degradation reaches a predetermined critical condition the component is repaired by pm scenario 3 if a cm or pm is implemented on one component an om plan will be determined by choosing the optimized combination to minimize the expenditure according to eqs 1 4 the following equations can be derived 6 f t d d t f t d d t 1 r t r t and 7 λ t f t r t r t r t d d t ln r t since r 0 1 then 8 0 δ t m i j λ m i j t d t ln r m i j t where 0 δ t m i j λ m i j t d t represents the cumulative failure risk of component i of owt m in maintenance cycle j implying that the number of corrective repairs for component i in each maintenance cycle is equal to ln r m i j t which is considered as the pm threshold 3 3 preliminary planning since the number of cm during δt mi j is ln r m i j t assuming the maintenance times for component i of owt m during mission period is n i the average maintenance cost per unit time of this component is defined as follows 9 e c m i n m i c 0 c c m m i c d m i w t τ m i j ln r m i j t c p m m i c d m i τ m i j j 1 n i δ t m i j w t τ m i j where τ mi j is the pm duration and τ mi j is the cm duration τ mi j consists of repair time and travel time and τ mi j is usually longer than τ mi j because cm requires extra logistic time resulting in more downtime losses the influence of changeable marine environment is considered in the presented model in eq 9 w t is the waiting time for an appropriate sea condition that satisfies the requirement for offshore operation c cm mi is the cm cost including the recover expense and the downtime losses c pm mi and c d mi represent the imperfect pm expense and unit downtime losses respectively c pm mi is related to σ mi j γ mi j and c pm mi which can be evaluated as 10 c p m m i 1 σ m i j 2 1 γ m i j 2 c p m m i the individual optimal r mi j t can be obtained by minimizing e c m i the obtaining of threshold r mi j t is the basis of the presented approach all the time points of preliminary maintenance planning have been clarified by eqs 6 10 3 4 economic profit formulations for the owt m when units k and i are jointly repaired the corresponding cost reduction can be evaluated as 11 c s m i m k j c 0 c d m i m k j c m m i m k j c p m i m k j where c d m i m k j is the downtime cost reduction resulting from the joint maintenance which can be defined as 12 c d m i m k j c d m i τ m i m k min when the component i is recovered in advance the unexpected failures would be reduced the cost saving for the decline of random malfunctions is c m m i m k j which can be expressed as 13 c m m i m k m j ln r m i j t ln r m i k t c c m m i after 1 p m is performed in advance every planned maintenance time should be rearranged assuming t m i j represents the previous maintenance time and t m i j represents the latest one the overall time switch should be 14 δ t m i k j 1 m δ t m i j δ t m i j m min n m i n m i however the substantial rul is wasted when the unit is repaired in advance and the penalty cost is 15 c p m i m k j e c m i δ t m i k the cost savings can be achieved based on eqs 11 15 3 5 maintenance activity grouping in terms of a multi component system the components maintenance activities can be regarded as a finite set φ when a maintenance opportunity appears each maintenance combination φ 1 φ 2 φ l is a sub collection of φ satisfying 16 φ p φ q p q φ 1 φ 2 φ l φ the size of φ explodes as the number of element rises making the solution process extremely complicated when cm or planned pm is performed on components r r 1 n all the om combinations can be identified and the expense preservation should be 17 c φ l i φ l c s m i m r j i r the om combination corresponding to the maximum c φ l can be identified as the optimized solution 3 6 maintenance execution and rolling horizon update for wind farm if t mi 1 is the j th maintenance execution time of owt m m 1 2 m unit i i 1 2 n the following equations can be established 18 t m i 1 t b e g i n δ t m i 1 and 19 t m i j t m i j 1 δ t m i j 1 w t j 1 where t begin is the initial time which is generally set as 0 δt mi 1 is the interval of the first pm activity and w t is the waiting time for a weather window after completing a maintenance activity the failure rate of corresponding component is renewed based on eq 5 and the updated system condition becomes the input information for the planning of next maintenance cycle according to assumptions 1 and 3 there are m n components in the entire wind farm the objective function is to maximise the overall cost savings during mission time t mission which is 20 m a x c g l t t 1 t m i s s i o n i g l t k 1 k i m n c s i k j t 1 t m i s s i o n i g l t k 1 k i m n c 0 c d i τ i k min ln r i j t ln r i k t c c m i e c i δ t i k based on the previous steps and eq 20 the optimized maintenance plan within the mission period is identified 4 results and analysis in this section the maintenance schedule of each component the cost savings corresponding to different setup cost and the proportion of maintenance costs will be calculated and discussion based on the proposed policy and input information the wind farm level analysis will also be completed 4 1 input information carroll et al 2016 collected the failure and maintenance information of owts from the operational data of 1768 turbine years the owts are aged between 3 and 10 years old a period that the failure rate is relatively constant according to the bathtub curve the capacity is around 3 mw and the rotor diameter is around 100 m some owt component parameters are also listed in zhang et al 2019 these two papers are the basis of the input information in table 1 which summarizes the properties of the owt components and cost parameters of the target offshore wind farms in terms of downtime cost assuming the capacity of analysed owts is 3 mw and the electricity tariff is 0 1 therefore the financial loss caused by system unavailability is c d i 3000 24 0 1 7200 d le and andrews 2016 presented the specific vessels for different types of repairs and typical cost for a shift demonstrating that the cost of crew transfer vessels is about 5000 7000 and the cost of jack up vessels is about 15 000 40 000 based on the above information and current exchange rate the average fixed cost is 30 000 in table 1 table 2 shows the parameters of the failure models according to santos et al 2015a b the o m of offshore wind farms is affected by weather and sea conditions such as wind speed wind direction and effective wave height at sea the effective wave height is the most important factor determining the accessibility of offshore operation scheu et al 2012 therefore this section develops a weather window model with wave height as a marine environmental factor the significant wave heights hs less than 3 5 m are considered as the operational environmental conditions martins et al 2015a b studied the wave height data in the north atlantic portuguese waters during the winter months december january february the results are listed in table 3 demonstrating the waiting time for a weather window corresponding to different significant wave heights the categories of logistic time and travel time for a weather window corresponding to different maintenance level are presented in table 4 according to le and andrews 2016 4 2 results and discussion on owts level the rolling horizon approach is adapted to optimize the maintenance planning for a single owt during the mission period assuming that the critical operation wave height is 3 m and the values of the parameters a 0 01 and b 1 01 detailed maintenance schedule and cost savings in the first calendar year are presented in table 5 the outcomes demonstrated that the maintenance costs are significantly reduced through the presented strategy according to table 5 the owt is repaired 8 times in the first year including 8 times of pm and 18 times of om the largest cost saving happens on the 158th day when 80 000 are preserved and om activities are implemented on the 311th day only one pm activity is performed and c g 1 is zero in fig 3 the planning results for 3 years are demonstrated considering different imperfect maintenance parameters initially the maintenance combinations of these four cases are similar with the increase of time more maintenance activities happen in the imperfect scenarios it can be concluded that the intervals are shorter when the maintenance effectiveness is worse it can also be found that the maintenance frequency is proportional to the failure rate since pm and om activities generally cannot be perfect in recovering the owts to as good as new state the imperfect scenarios are more practical and accurate table 6 summarizes the detailed pm and om maintenance times of perfect and imperfect scenarios the horizontal axis represents calendar time and vertical axis represents different components the entire bar represents for the condition monitoring period in which the green area indicates that the component operates normally blue line shows that opportunistic maintenance is implemented in current time in the same time point pm must has been carried out in other component due to which the general maintenance resources can be shared the red line expresses that preventative maintenance is conducted into the component before its fault the cost saving results corresponding to different maintenance strategies and cases are presented in table 7 the outcomes demonstrate that the proportion of cost savings remains relatively stable but decreases slightly when maintenance effectiveness is getting worse in terms of the maintenance costs compared with case 1 the expenditure in case 4 significantly rises indicating that the maintenance effectiveness will remarkably influence the economic efficiency 4 3 results and discussion on offshore wind farm level in this section the presented method is extended to determine the o m planning and identify the effect of maintenance uncertainty for an offshore wind farm during the mission period an example of an offshore wind farm with 10 owts is addressed to demonstrate the advantages of the presented maintenance strategy and the effects of maintenance uncertainty assuming the imperfect maintenance factors follow a gaussian distribution a n 0 01 0 0022 b n 1 01 0 0022 fig 4 shows the maintenance schedule of two owts under the proposed algorithm and the corresponding proportion of costs and cost savings are plotted in fig 5 and fig 6 respectively fig 4 demonstrates that the maintenance frequency is slightly decreased when two owts are repaired together the explanation is that a more extended use of a maintenance opportunity will be achieved when the amount of owts increases fig 5 indicates that pitch system and generator are the two largest contributors to costs one reason is these two units have the highest probability of failure in the entire system another reason is the maintenance costs of pitch system and generator are relatively larger leading to a higher proportion of overall costs in fig 6 generator ranks on the top in terms of cost savings followed by pitch system gearbox and rotor blade the results are in conformity with the maintenance schedule since these four components occupy most of the om according to fig 4 table 8 lists the maintenance cost information considering different amount of owts the results of proportion of cost savings show that the benefit of om strategy increases with the amount of owts indicating the average cost of each owt is reduced through the proposed method 4 4 comparison with other studies table 9 performs a comparison analysis of five representative studies and the current paper nguyen and chou 2018 divided the owt into six assemblies and developed their degradation models based on two parameter weibull distribution the proposed grouping maintenance schedule saved 4 56 in comparison to the baseline schedule xie et al 2019 implemented a three parameter weibull distribution to describe system degradation the results showed that the failure rate short term prediction of the three parameter weibull model was superior to the two parameter weibull model when the fault data were limited improving the cost savings to 10 zhang et al 2019 introduced a dynamic opportunistic maintenance strategy taking into account the influence of weather window and inventory management in this research when the wind speed is high the maintenance decision tends to concentrate on restoring the owt and starting to function as soon as possible in order to generate more power conversely when the wind speed is low the decision making algorithm tends to carry out joint maintenance the o m cost for the presented method showed a decline of 18 3 the above three studies belong to risk based maintenance rbm strategy condition based maintenance cbm is an extended approach to maintenance using systematic data from condition monitoring to decide when to make maintenance interventions different simulation models are available to model and optimize the plans as for example the one of barata et al 2002 an application to owt is given in kang et al 2020 a review of applications in wind turbines can be found in kang et al 2019a in terms of cbm strategy both of lu et al 2018 and zhou and yin 2019 used ann predictive model to evaluate the remaining useful life of the components based on the condition assessment results the optimized maintenance decisions can be determined improving the cost savings to 31 5 and 32 46 it is worth noting that zhou and yin 2019 addressed influence of maintenance lead time which includes the time required to assemble the maintenance team arrange the spare parts prepare the specific equipment and travel to the offshore site in terms of the percentage of cost savings compare with tbm the om strategy in this paper ranks first with the percent of 41 9 which demonstrates the validity in owt maintenance cost control it can be concluded that 1 the cost saving rates of cbm are generally higher than rbm resulting from a more accurate assessment of the real time state of the system 2 the more interference factors weather window inventory management etc are considered the more cost savings are achieved demonstrating the necessity of research on maintenance strategy 5 conclusions this paper investigates the om strategy for offshore wind energy taking into account the uncertainty of imperfect maintenance and the influence of changeable marine environment the optimized maintenance schedule and the information on maintenance costs are determined based on the proposed method calculated results demonstrate that the om strategy can significantly reduce the costs compared with separate periodic maintenance when maintenance effectiveness is getting worse the maintenance expenditure and frequency are rising and the proportion of cost savings remains relatively stable but slightly decreases at the wind farm level the maintenance frequency decreases and the proportion of cost savings rises when several owts are repaired together since a more efficient use of a maintenance opportunity will be achieved when the amount of owts increases pitch system and generator are the two largest contributors to maintenance cost due to their high failure rates and repair expenditures meanwhile they are also the top two components in terms of cost savings since they represent more maintenance opportunities than the others it can be concluded that the developed model provides an economically efficient method of offshore wind farm maintenance planning credit authorship contribution statement jichuan kang methodology formal analysis visualization writing original draft c guedes soares writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this study was performed within the project arcwind adaptation and implementation of floating wind energy conversion technology for the atlantic region which is co financed by the european regional development fund through the interreg atlantic area programme under contract eapa 344 2016 this work contributes to the strategic research plan of the centre for marine technology and ocean engineering centec which is financed by the portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uidb uidp 00134 2020 
21497,an opportunistic maintenance policy for offshore wind farms jichuan kang methodology formal analysis visualization writing original draft a b c c guedes soares writing review editing supervision a c a centre for marine technology and ocean engineering centec instituto superior técnico universidade de lisboa lisbon portugal centre for marine technology and ocean engineering centec instituto superior técnico universidade de lisboa lisbon portugal centre for marine technology and ocean engineering centec instituto superior tecnico universidade de lisboa lisbon portugal b college of shipbuilding engineering harbin engineering university harbin china college of shipbuilding engineering harbin engineering university harbin china college of shipbuilding engineering harbin engineering university harbin china c international joint laboratory of naval architecture and offshore technology between harbin engineering university and the university of lisbon harbin 150001 china international joint laboratory of naval architecture and offshore technology between harbin engineering university and the university of lisbon harbin 150001 china heu ul international joint laboratory of naval architecture and offshore technology harbin china corresponding author centre for marine technology and ocean engineering centec instituto superior técnico universidade de lisboa lisbon portugal centre for marine technology and ocean engineering centec instituto superior técnico universidade de lisboa lisbon portugal an opportunistic maintenance policy for offshore wind farms is introduced considering imperfect maintenance and the weather window effect each wind turbine is regarded as a multi component system divided into several assemblies when one unit fails or reaches its critical degradation state there is an opportunity to implement preventive maintenance for the others reducing the losses of accidental failures on the basis of the rolling horizon approach the system condition is updated after the completion of a maintenance activity by selecting the optimized maintenance combination at every opportunity the maintenance plan over the mission period is finalized the uncertainty of maintenance effectiveness and the costs of the time waiting for a weather window are also considered failure information is collected from existing literature to accomplish the calculations calculated results indicate that the proposed approach is beneficial to save the maintenance expenditure of offshore wind farms keywords opportunistic maintenance offshore wind farm weather condition imperfect maintenance 1 introduction offshore wind turbines owt have several advantages compared with onshore ones however the complex and varied marine environment has brought great challenges to the transportation installation and operation of the equipment offshore wind farms started with fixed support structures in relatively shallow water depth close to coast but have been expanding to deeper water and larger distances from coast diaz and guedes soares 2020 the present tendency is to see the transition to floating wind turbines concepts uzunoglu et al 2016 the systems are subject to various types of external and internal damages resulting from the system deterioration and harsh marine environment kang et al 2019b for an owt whose design life can be considered as 20 years the operation and maintenance o m costs represent about 25 30 of the overall energy generation cost or 75 90 of the investment costs when considering the lifetime márquez et al 2012 castro santos et al 2016 2020a b this can be explained by insufficient accessibility due to the unpredictable weather and the remote location more failures than the onshore ones owing to the marine environment extra inventory expense as specific vessels and technicians are needed previous literature reported attempts to minimize the offshore wind farm o m costs besnard et al 2012 proposed a calculation model for the cost based optimization and selection of a maintenance support organization for an offshore wind farm taking into account the location of the maintenance accommodation the number of repairmen and the use of helicopters costa et al 2015 identified the most representative failures of wind farms and then presented an innovative way to analyse wind farm o m according to weather dalgic et al 2015 introduced an optimization method of offshore wind farms o m aims at minimum failure loss and maximum power production considering the weather conditions failure features of different system components and different choices of transfer vessels santos et al 2015a 2018 2019 introduced generalized stochastic petri nets gspn to model the maintenance activities of an owt considering the logistics and weather conditions constraints santos et al 2014 the results proved that the presented gspn method is a feasible solution for o m optimization in terms of multi component systems such as owts an inspection or maintenance activity of one component provides an early preventive maintenance pm opportunity to the others santos et al 2015a the advantage of opportunistic maintenance om includes 1 combined maintenance activities can share the setup cost which is significant for owts 2 the downtime can also be shared as long as the maintenance resources including vessels technicians and tools are sufficient however when the advanced maintenance date leads to the loss of components remaining useful life rul the pm should not be performed the om optimization aims to identify the best maintenance date and combination improving the system economy sarker and faiz 2016 formulated a multi level opportunistic pm policy the overall maintenance expenditure is a function of the number of age groups for components calculated results demonstrated that the presented approach was effective to cut down the maintenance expenditure of owts abdollahzadeh et al 2016 introduced a multi objective om optimization method considering the stochastic behaviour of wind and limited maintenance resources the availability of the presented method is proved by comparative analysis lu et al 2017 provided a maintenance grouping optimization method for owt electrical and electronic system considering pm opportunities the maintenance planning which can be changed with time can be updated based on short term information the results showed that o m expenditure can be significantly saved by selecting the best repair time and components combination however the implementation of an om strategy also faces challenges in practice maintenance activities cannot often recover the system back to the as good as new status and it is difficult to implement all the ideal repair activities because of limited maintenance resources ding and tian 2012 proposed an om policy that introduced various imperfect maintenance thresholds for a malfunction turbine and a functional turbine belsak and flasker 2007 introduced a method of detecting cracks in the tooth of gears considering vibration signals monitoring and time frequency analysis the availability of the presented approach in maintenance policy making is demonstrated by the reliability of identifying the failure mode the presented policy demonstrated the influence of maintenance uncertainty as a significant maintenance constraint the influence of weather has attracted increasing attention in recent years generally a maintenance decision making process usually depends on static thresholds in order to ensure the process more feasible to the particular environmental conditions erguido et al 2017 introduced dynamic reliability thresholds which varied based on the weather conditions for opportunistic maintenance model the proposed approach showed better performance on saving the life cycle cost of a wind farm compared to the conventional one scheu et al 2012 presented an approach to model both wave and wind conditions for offshore sites have been using discrete finite state markov theory aiming to simulate the operational process of offshore wind farms and to assist the maintenance decision making in the current study an opportunistic strategy is introduced to minimize the maintenance cost for offshore wind farms considering degradation process the maintenance effectiveness uncertainty and the waiting time caused by the changeable marine environment sobral et al 2019 sobral and guedes soares 2019 owts suffer harsh marine environment therefore the deterioration of components is notable and maintenance activities are not always perfect ding and tian 2011 in this paper the rolling horizon approach is employed to renew the maintenance schedule based on the operating data meanwhile the uncertainty of maintenance effectiveness is considered by introducing two parameter age reduction factors and the extra downtime results from changeable marine weather is also addressed the rest of this paper is divided into four sections the description of the owt system and its failure model are described in section 2 the proposed opportunistic maintenance model is developed in section 3 section 4 performs a case study to investigate the accuracy and feasibility of the presented maintenance strategy the conclusions and further works are summarized in section 5 2 owt system and failure model description 2 1 owt system description an owt can be divided into several subsystems based on different functions bagbanci et al 2012 fig 1 presents the schematic structure of the owt components carroll et al 2016 collected and analysed the failure rate repair time and maintenance cost of owt the statistical data are based on 350 owts which are between 3 and 10 years old and from between 5 and 10 wind farms throughout europe the results reveal that pitch system and power system have the highest failure rates and gearbox has the highest average cost per failure the downtime of gearbox and rotor bhardwaj et al 2019 li et al 2019 faulstich et al 2011 are the longest which can be explained by the high installation position and weight this study focuses on these four crucial sub systems i e pitch system power system gearbox and rotor rotor and power system are integrations of several major components which should be studied respectively therefore the rotor was divided into blades and rotor hub and the power system is divided into generator converter and transformer 2 2 failure model description owts are subject to wind wave and current loads year after year hence when describing the failure model of the system the degradation phenomena cannot be ignored the external cumulative shocks and internal material ageing are the two main factors that derive the degradation process santos et al 2016 according to le and andrews 2016 the failure of owts follows a weibull distribution t is the time to failure α and β are two parameters of weibull distribution the distribution function f t and probability density f t can be described by 1 f t pr t t 1 e t α β for t 0 and 2 f t d d t f t β α t α e t α β for t 0 the corresponding survivor function is 3 r t pr t 0 e t α β for t 0 the function of failure rate can be derived as 4 λ t f t r t β α t α β 1 for t 0 where α is the scale parameter and β represents the shape parameter in terms of the failure model for imperfect maintenance malik 1979 first introduced age reduction factor to model imperfect maintenance assume that t i and λ i t represent the pm period and failure rate before the i th maintenance activity the failure rate after the i th recovery should be λ i t a i t i t 0 t i 1 where a i 0 a i 1 is the age reduction factor indicating that when the repair process is not perfect the system condition will be improved after each repair but it will never return to the original functional state nakagawa 1988 proposed a different failure model in which the failure rate after the i th maintenance action is b i λ i t t 0 t i 1 where b i b i 1 denotes failure rate increase factor in this model the system will return to as good as new state after repair but fails faster than before lin et al 2000 presented a hybrid model that combines age reduction factor and failure rate increase factor it can be described by 5 λ i 1 t b i λ i t a i t i t 0 t i 1 in eq 4 a i 0 a i 1 represents age reduction factor and b i b i 1 represents failure rate increase factor the maintenance effect is better when bi is close to 1 and a i is close to 0 t i is the i th maintenance interval the hybrid model illustrated in fig 2 can comprehensively consider the variation of failure rate and reliability during each maintenance cycle in practice the values of a i and b i are usually random and uncertain this study assumes that in the actual work the probability distribution of a i and b i follows a gaussian distribution monte carlo simulation method is implemented to conduct a random sampling to convert the uncertainty of a i and b i into the estimated maintenance state 3 methodology the downtime of owt brings an opportunity to joint maintenance activities this section proposes a maintenance method that aims to take advantage of the opportunity to determine the optimized maintenance plan aiming to obtain the minimum long term operational expenditure 3 1 assumptions the om method proposed in this study is based on the following assumptions 1 owt is regarded as a multi component system consisting of n independent units a binary model is applied to describe the condition of each unit which means that the components are either in a functional or failure state 2 the components might fail randomly anytime and will be minimally repaired 3 in an offshore wind farm with m identical owts the time consumption from one owt to another is negligible for the maintenance technicians 3 2 dynamic reliability threshold calculation according to the om strategy the maintenance decision for each component can be concluded in one of the three situations scenario 1 a corrective maintenance cm is performed when a random malfunction happens scenario 2 whenever the degradation reaches a predetermined critical condition the component is repaired by pm scenario 3 if a cm or pm is implemented on one component an om plan will be determined by choosing the optimized combination to minimize the expenditure according to eqs 1 4 the following equations can be derived 6 f t d d t f t d d t 1 r t r t and 7 λ t f t r t r t r t d d t ln r t since r 0 1 then 8 0 δ t m i j λ m i j t d t ln r m i j t where 0 δ t m i j λ m i j t d t represents the cumulative failure risk of component i of owt m in maintenance cycle j implying that the number of corrective repairs for component i in each maintenance cycle is equal to ln r m i j t which is considered as the pm threshold 3 3 preliminary planning since the number of cm during δt mi j is ln r m i j t assuming the maintenance times for component i of owt m during mission period is n i the average maintenance cost per unit time of this component is defined as follows 9 e c m i n m i c 0 c c m m i c d m i w t τ m i j ln r m i j t c p m m i c d m i τ m i j j 1 n i δ t m i j w t τ m i j where τ mi j is the pm duration and τ mi j is the cm duration τ mi j consists of repair time and travel time and τ mi j is usually longer than τ mi j because cm requires extra logistic time resulting in more downtime losses the influence of changeable marine environment is considered in the presented model in eq 9 w t is the waiting time for an appropriate sea condition that satisfies the requirement for offshore operation c cm mi is the cm cost including the recover expense and the downtime losses c pm mi and c d mi represent the imperfect pm expense and unit downtime losses respectively c pm mi is related to σ mi j γ mi j and c pm mi which can be evaluated as 10 c p m m i 1 σ m i j 2 1 γ m i j 2 c p m m i the individual optimal r mi j t can be obtained by minimizing e c m i the obtaining of threshold r mi j t is the basis of the presented approach all the time points of preliminary maintenance planning have been clarified by eqs 6 10 3 4 economic profit formulations for the owt m when units k and i are jointly repaired the corresponding cost reduction can be evaluated as 11 c s m i m k j c 0 c d m i m k j c m m i m k j c p m i m k j where c d m i m k j is the downtime cost reduction resulting from the joint maintenance which can be defined as 12 c d m i m k j c d m i τ m i m k min when the component i is recovered in advance the unexpected failures would be reduced the cost saving for the decline of random malfunctions is c m m i m k j which can be expressed as 13 c m m i m k m j ln r m i j t ln r m i k t c c m m i after 1 p m is performed in advance every planned maintenance time should be rearranged assuming t m i j represents the previous maintenance time and t m i j represents the latest one the overall time switch should be 14 δ t m i k j 1 m δ t m i j δ t m i j m min n m i n m i however the substantial rul is wasted when the unit is repaired in advance and the penalty cost is 15 c p m i m k j e c m i δ t m i k the cost savings can be achieved based on eqs 11 15 3 5 maintenance activity grouping in terms of a multi component system the components maintenance activities can be regarded as a finite set φ when a maintenance opportunity appears each maintenance combination φ 1 φ 2 φ l is a sub collection of φ satisfying 16 φ p φ q p q φ 1 φ 2 φ l φ the size of φ explodes as the number of element rises making the solution process extremely complicated when cm or planned pm is performed on components r r 1 n all the om combinations can be identified and the expense preservation should be 17 c φ l i φ l c s m i m r j i r the om combination corresponding to the maximum c φ l can be identified as the optimized solution 3 6 maintenance execution and rolling horizon update for wind farm if t mi 1 is the j th maintenance execution time of owt m m 1 2 m unit i i 1 2 n the following equations can be established 18 t m i 1 t b e g i n δ t m i 1 and 19 t m i j t m i j 1 δ t m i j 1 w t j 1 where t begin is the initial time which is generally set as 0 δt mi 1 is the interval of the first pm activity and w t is the waiting time for a weather window after completing a maintenance activity the failure rate of corresponding component is renewed based on eq 5 and the updated system condition becomes the input information for the planning of next maintenance cycle according to assumptions 1 and 3 there are m n components in the entire wind farm the objective function is to maximise the overall cost savings during mission time t mission which is 20 m a x c g l t t 1 t m i s s i o n i g l t k 1 k i m n c s i k j t 1 t m i s s i o n i g l t k 1 k i m n c 0 c d i τ i k min ln r i j t ln r i k t c c m i e c i δ t i k based on the previous steps and eq 20 the optimized maintenance plan within the mission period is identified 4 results and analysis in this section the maintenance schedule of each component the cost savings corresponding to different setup cost and the proportion of maintenance costs will be calculated and discussion based on the proposed policy and input information the wind farm level analysis will also be completed 4 1 input information carroll et al 2016 collected the failure and maintenance information of owts from the operational data of 1768 turbine years the owts are aged between 3 and 10 years old a period that the failure rate is relatively constant according to the bathtub curve the capacity is around 3 mw and the rotor diameter is around 100 m some owt component parameters are also listed in zhang et al 2019 these two papers are the basis of the input information in table 1 which summarizes the properties of the owt components and cost parameters of the target offshore wind farms in terms of downtime cost assuming the capacity of analysed owts is 3 mw and the electricity tariff is 0 1 therefore the financial loss caused by system unavailability is c d i 3000 24 0 1 7200 d le and andrews 2016 presented the specific vessels for different types of repairs and typical cost for a shift demonstrating that the cost of crew transfer vessels is about 5000 7000 and the cost of jack up vessels is about 15 000 40 000 based on the above information and current exchange rate the average fixed cost is 30 000 in table 1 table 2 shows the parameters of the failure models according to santos et al 2015a b the o m of offshore wind farms is affected by weather and sea conditions such as wind speed wind direction and effective wave height at sea the effective wave height is the most important factor determining the accessibility of offshore operation scheu et al 2012 therefore this section develops a weather window model with wave height as a marine environmental factor the significant wave heights hs less than 3 5 m are considered as the operational environmental conditions martins et al 2015a b studied the wave height data in the north atlantic portuguese waters during the winter months december january february the results are listed in table 3 demonstrating the waiting time for a weather window corresponding to different significant wave heights the categories of logistic time and travel time for a weather window corresponding to different maintenance level are presented in table 4 according to le and andrews 2016 4 2 results and discussion on owts level the rolling horizon approach is adapted to optimize the maintenance planning for a single owt during the mission period assuming that the critical operation wave height is 3 m and the values of the parameters a 0 01 and b 1 01 detailed maintenance schedule and cost savings in the first calendar year are presented in table 5 the outcomes demonstrated that the maintenance costs are significantly reduced through the presented strategy according to table 5 the owt is repaired 8 times in the first year including 8 times of pm and 18 times of om the largest cost saving happens on the 158th day when 80 000 are preserved and om activities are implemented on the 311th day only one pm activity is performed and c g 1 is zero in fig 3 the planning results for 3 years are demonstrated considering different imperfect maintenance parameters initially the maintenance combinations of these four cases are similar with the increase of time more maintenance activities happen in the imperfect scenarios it can be concluded that the intervals are shorter when the maintenance effectiveness is worse it can also be found that the maintenance frequency is proportional to the failure rate since pm and om activities generally cannot be perfect in recovering the owts to as good as new state the imperfect scenarios are more practical and accurate table 6 summarizes the detailed pm and om maintenance times of perfect and imperfect scenarios the horizontal axis represents calendar time and vertical axis represents different components the entire bar represents for the condition monitoring period in which the green area indicates that the component operates normally blue line shows that opportunistic maintenance is implemented in current time in the same time point pm must has been carried out in other component due to which the general maintenance resources can be shared the red line expresses that preventative maintenance is conducted into the component before its fault the cost saving results corresponding to different maintenance strategies and cases are presented in table 7 the outcomes demonstrate that the proportion of cost savings remains relatively stable but decreases slightly when maintenance effectiveness is getting worse in terms of the maintenance costs compared with case 1 the expenditure in case 4 significantly rises indicating that the maintenance effectiveness will remarkably influence the economic efficiency 4 3 results and discussion on offshore wind farm level in this section the presented method is extended to determine the o m planning and identify the effect of maintenance uncertainty for an offshore wind farm during the mission period an example of an offshore wind farm with 10 owts is addressed to demonstrate the advantages of the presented maintenance strategy and the effects of maintenance uncertainty assuming the imperfect maintenance factors follow a gaussian distribution a n 0 01 0 0022 b n 1 01 0 0022 fig 4 shows the maintenance schedule of two owts under the proposed algorithm and the corresponding proportion of costs and cost savings are plotted in fig 5 and fig 6 respectively fig 4 demonstrates that the maintenance frequency is slightly decreased when two owts are repaired together the explanation is that a more extended use of a maintenance opportunity will be achieved when the amount of owts increases fig 5 indicates that pitch system and generator are the two largest contributors to costs one reason is these two units have the highest probability of failure in the entire system another reason is the maintenance costs of pitch system and generator are relatively larger leading to a higher proportion of overall costs in fig 6 generator ranks on the top in terms of cost savings followed by pitch system gearbox and rotor blade the results are in conformity with the maintenance schedule since these four components occupy most of the om according to fig 4 table 8 lists the maintenance cost information considering different amount of owts the results of proportion of cost savings show that the benefit of om strategy increases with the amount of owts indicating the average cost of each owt is reduced through the proposed method 4 4 comparison with other studies table 9 performs a comparison analysis of five representative studies and the current paper nguyen and chou 2018 divided the owt into six assemblies and developed their degradation models based on two parameter weibull distribution the proposed grouping maintenance schedule saved 4 56 in comparison to the baseline schedule xie et al 2019 implemented a three parameter weibull distribution to describe system degradation the results showed that the failure rate short term prediction of the three parameter weibull model was superior to the two parameter weibull model when the fault data were limited improving the cost savings to 10 zhang et al 2019 introduced a dynamic opportunistic maintenance strategy taking into account the influence of weather window and inventory management in this research when the wind speed is high the maintenance decision tends to concentrate on restoring the owt and starting to function as soon as possible in order to generate more power conversely when the wind speed is low the decision making algorithm tends to carry out joint maintenance the o m cost for the presented method showed a decline of 18 3 the above three studies belong to risk based maintenance rbm strategy condition based maintenance cbm is an extended approach to maintenance using systematic data from condition monitoring to decide when to make maintenance interventions different simulation models are available to model and optimize the plans as for example the one of barata et al 2002 an application to owt is given in kang et al 2020 a review of applications in wind turbines can be found in kang et al 2019a in terms of cbm strategy both of lu et al 2018 and zhou and yin 2019 used ann predictive model to evaluate the remaining useful life of the components based on the condition assessment results the optimized maintenance decisions can be determined improving the cost savings to 31 5 and 32 46 it is worth noting that zhou and yin 2019 addressed influence of maintenance lead time which includes the time required to assemble the maintenance team arrange the spare parts prepare the specific equipment and travel to the offshore site in terms of the percentage of cost savings compare with tbm the om strategy in this paper ranks first with the percent of 41 9 which demonstrates the validity in owt maintenance cost control it can be concluded that 1 the cost saving rates of cbm are generally higher than rbm resulting from a more accurate assessment of the real time state of the system 2 the more interference factors weather window inventory management etc are considered the more cost savings are achieved demonstrating the necessity of research on maintenance strategy 5 conclusions this paper investigates the om strategy for offshore wind energy taking into account the uncertainty of imperfect maintenance and the influence of changeable marine environment the optimized maintenance schedule and the information on maintenance costs are determined based on the proposed method calculated results demonstrate that the om strategy can significantly reduce the costs compared with separate periodic maintenance when maintenance effectiveness is getting worse the maintenance expenditure and frequency are rising and the proportion of cost savings remains relatively stable but slightly decreases at the wind farm level the maintenance frequency decreases and the proportion of cost savings rises when several owts are repaired together since a more efficient use of a maintenance opportunity will be achieved when the amount of owts increases pitch system and generator are the two largest contributors to maintenance cost due to their high failure rates and repair expenditures meanwhile they are also the top two components in terms of cost savings since they represent more maintenance opportunities than the others it can be concluded that the developed model provides an economically efficient method of offshore wind farm maintenance planning credit authorship contribution statement jichuan kang methodology formal analysis visualization writing original draft c guedes soares writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this study was performed within the project arcwind adaptation and implementation of floating wind energy conversion technology for the atlantic region which is co financed by the european regional development fund through the interreg atlantic area programme under contract eapa 344 2016 this work contributes to the strategic research plan of the centre for marine technology and ocean engineering centec which is financed by the portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uidb uidp 00134 2020 
21498,this paper presents a novel approach to tackle simultaneously short and long term energy flux prediction specifically at 6 h 12 h 24 h and 48 h time horizons the methodology proposed is based on the multi task learning paradigm in order to solve the four problems with a single model we consider multi task evolutionary artificial neural networks mteann with four outputs one for each time prediction horizon for this purpose three buoys located at the gulf of alaska are considered measurements collected by these buoys are used to obtain the target values of energy flux whereas only reanalysis data are used as input values allowing the applicability to other locations the performance of three different basis functions sigmoidal unit radial basis function and product unit are compared against some popular state of the art approaches such as extreme learning machines and support vector regressors the results show that mteann methodology using sigmoidal units in the hidden layer and a linear output achieves the best performance in this way the multi task methodology is an excellent and lower complexity approach for energy flux prediction at both short and long term prediction time horizons furthermore the results also confirm that reanalysis data is enough for describing well the problem tackled keywords wave energy flux prediction marine energy multi task machine learning evolutionary artificial neural networks reanalysis data 1 introduction in the last decades there has been an increase in the carbon dioxide levels and in consequence the global mean temperatures have also risen according to the special report regarding global warming done by the intergovernmental panel on climate change ipcc hoegh guldberg et al 2018 the surface temperatures are increasing by about 0 2 c per decade the ongoing rise of the average temperature of the earth is leading to wildfires the expansion of deserts or more intense storms among others council et al 2012 therefore the interest in renewable and eco friendly energy sources such as solar wind tides and waves is in continuous growth ellabban et al 2014 although solar and wind are considered the most popular alternative sources of energy they have the setback of not being constantly available due to the intermittent nature of wind and sun on the other hand tides and waves not only benefit from being always in movement but they also can be used in many parts of the world including oceans or big seas furthermore given that the energy storage systems are a major challenge palmer and floyd 2020 and that around 40 of the world s population live within 100 km of the coast the wave and tidal renewable energies allow for a cost effective transmission of electricity esteban and leary 2012 waves exhibit a stochastic nature due to the influence of a great number of environmental elements therefore they cannot be predicted straightforwardly as tides due to this stochastic behaviour the reliability and confidence of wave energy generation need to be predicted beforehand in order to develop an stable source of energy for the generation of electricity from wave energy wave energy converters wecs falcão 2010 aderinto and li 2018 are applied in order to transform the kinetic energy directly generated by the waves into electricity falnes and kurniawan 2020 to model the behaviour of wave energy the two most important parameters are the significant wave height h s and the wave energy flux f e which have been widely studied in the literature from different perspectives nitsure et al 2012 physical models ibarra berastegi et al 2015 statistical models lin et al 2020 or by the application of machine learning ml techniques cuadra et al 2016 among others focusing on ml approaches some of the first works published were those of deo and naidu 1998 and deo et al 2001 which consisted in real time forecasting of h s by using artificial neural network ann models later the ann methodology has been validated by some other authors such as castro et al 2014 who applied ann models to predict the wave energy resource in the northern coast of spain hadadpour et al 2014 focused on forecasting the wave energy over horizons from 1 to 12 hours in the southern part of the caspian sea support vector regressors svrs have also been used for h s forecasting leading to competitive results mahjoobi and mosabbeb 2009 duan et al 2016 another approach was proposed by cornejo bueno et al 2016b who developed a grouping genetic algorithm applied to extreme learning machines elms to predict both h s and f e in this work a feature selection is carried out to select the most relevant features for the regressor machine more recent works used an ensemble of elms for the prediction of h s in 10 stations of varying terrains from gulf of mexico brazil and korean region kumar et al 2018 ali and prasad 2019 also applied elms coupled with an improved complete ensemble empirical mode decomposition method using adaptive noise to predict h s in the eastern coastal zones of australia cornejo bueno et al 2018 considered a regression genetic fuzzy system known as fruler for the prediction of h s and f e in one buoy of the west coast of the usa using measurements from other two neighbour buoys with respect to the sort of data used fernández et al 2015 proposed the use of meteorological data obtained from ncep ncar reanalysis project and applied several ordinal classifiers for the prediction of both h s and f e on the other hand salcedo sanz et al 2015 and cornejo bueno et al 2016a used features extracted from x band radar images as input variables whereas choi et al 2020 used only raw ocean images to estimate real time h s using svr and 2d and 3d deep learning approaches ml techniques have also been used for forecast water level in lakes at various horizons in kisi et al 2015 the models were developed using svm coupled with firefly algorithm fa the fa was applied to estimate the optimal svm parameters in shiri et al 2016 the authors used the popular elm whose results were compared with genetic programming and anns despite the hard work done in h s and f e prediction there is not up to the knowledge of the authors any previous study analysing the short and long term energy flux prediction simultaneously considering ml algorithms and reanalysis data for developing accurate flux of energy prediction models this is the main motivation to carry out this study in order to accomplish this goal two architectures of multi task anns are optimised by applying an evolutionary algorithm specifically the ann models have four outputs the first two ones for short term prediction 6 h and 12 h and the second two for long term prediction 24 h and 48 h the purpose of the evolutionary algorithm is to optimise the structure of the anns proposed for the problem tackled the methodology proposed performs flux of energy prediction using reanalysis variables as input data that is no observed data is required what improves its applicability to other sites on the other hand simultaneous energy flux prediction at different time horizons establishes a relationship between all of them that can be exploited to obtain a single model to better solve all the prediction time horizons in this sense multi task learning mtl caruana 1997 is a ml technique that exploits such relationship taking advantage of the latent information when performing related tasks simultaneously maurer et al 2016 dorado moreno et al 2020 hence the model can infer such information to improve its performance consequently the methodology proposed in this study exhibits the following novelties 1 a mtl approach is presented with the objective of short and long term energy flux prediction simultaneously four types of multi task evolutionary artificial neural networks mteann are developed and studied 2 given that the methodology only uses reanalysis variables as input data it could be extended to other locations 3 a comprehensive comparison against some state of the art regression techniques elm and svr among others is presented 4 a single mteann performs all the different time prediction horizons 6 h 12 h 24 h and 48 h being less complex when compared against the literature techniques 5 moreover mteann methodology exhibits the advantage of requiring just one model with less connections in comparison to the sum of the connections of four independent single task models only performing one time prediction horizon the rest of the paper is organised as follows in section 2 a detailed description of the data used and the preprocessing steps applied is presented section 3 describes the methodology proposed for the energy flux prediction problem the performance of the different mteann models and the comparison against the state of the art techniques are studied and analysed in section 4 section 5 discusses the results achieved according to the best model finally section 6 gives some concluding remarks for closing the paper 2 data description and processing this section introduces the data used in this study which have been obtained from the following two well known sources of information national data buoy center ndbc national data buoy center 2020 maintains a network of buoys deployed in coastal and offshore waters around oceans and seas such buoys are equipped with assorted sensors to collect real time marine meteorological and oceanographic observations including significant wave height average wave period or sea level pressure among others national center for atmospheric research ncar kalnay et al 1996 kistler et al 2001 provides a global 2 5 2 5 grid of reanalysis data of meteorological variables e g pressure air temperature relative humidity etc which are obtained by means of a climate model that assimilates weather observations collected from different sources specifically to carry out this study hourly collected measurements of three buoys and 4 times daily values of seven reanalysis variables have been selected during years 2015 to 2018 in that way all input variables will be obtained from reanalysis data whereas the output variables will be obtained from observed data collected by sensors installed in each buoy the following subsections describe in detail such data 2 1 buoys measurements the buoys subject to research are located in the gulf of alaska as shown in fig 1 this region has a high frequency and variability regarding occurrence of storms and as a consequence it is a zone of intense wave generation in this sense three buoys have been selected according to their proximity and depth of water buoy 46001 llnr 984 ndbc station 46001 2020 western gulf of alaska 175 nm se of kodiak ak geographical location 56 232n 147 949w buoy 46066 llnr 984 1 ndbc station 46066 2020 south kodiak 310 nm ssw of kodiak ak geographical location 52 765n 155 009w buoy 46085 llnr 984 15 ndbc station 46085 2020 central gulf of alaska 265 nm west of cape ommaney ak geographical location 55 883n 142 482w although the flux of energy f e is not directly measured by the buoys sensors it can be calculated from two wave parameters measured by the buoys the significant wave height h s and the average wave period t e in this way for the three selected buoys the f e of each time instant has been obtained using the following equation 1 f e 0 49 h s 2 t e where f e is measured in kilowatts per metre h s is measured in metres and t e is measured in seconds due to h s is a kind of average wave height f e is defined in eq 1 as an average energy flux nevertheless for simplicity it will be referred as flux of energy given that the goal of this study is to predict the flux of energy generated by the waves at different time prediction horizons only such buoy measurement will be considered when obtaining the datasets 2 2 reanalysis data grid with respect to the reanalysis data used in this study seven variables have been considered shown in table 1 the reasons behind the selection of these reanalysis variables are two firstly to have a good characterisation of wind and secondly to take advantage of the contribution of weather factors that exert on it on the one hand waves and consequently flux of energy are generated with the action of wind in this sense air temperature pressure omega vertical velocity and the south north and west east components of wind speed have been selected as appropriate descriptive variables of the wind in a given zone fernández et al 2015 dorado moreno et al 2017 ibarra berastegi et al 2015 on the other hand atmospheric processes play an important role when tackling environmental modelling because they provide useful information to better understand the formation and evolution of cyclones storms and other related phenomena in this way and given that the three buoys under study are located at the gulf of alaska precipitable water content is a key component to find patterns that could lead to severe weather events campmany et al 2010 wang et al 2018 choy et al 2013 furthermore relative humidity provides additional information about the occurrence of deep convection siingh et al 2014 given that the nnrp web page provides a global 2 5 2 5 grid for each reanalysis variable the four closest geographical points reanalysis nodes to each buoy have been selected in that way each reanalysis file includes the data of one meteorological variable for each reanalysis node that surrounds the buoy for the selected years 2015 to 2018 for a better understanding in fig 2 an approximate representation of the four reanalysis nodes around the geographical location of the buoy 46001 is shown as a result three one for each buoy reanalysis data grids have been considered as described in table 2 finally the reanalysis data have been obtained with the minimum temporal resolution available that is 4 times daily 00 h 06 h 12 h and 18 h 2 3 obtaining the datasets firstly a preprocessing task has been performed to recover the values of the measurements not recorded by the buoys note that such missing values were insignificant due to only the h s and t e variables have been used to calculate the flux of energy and because of the data integration process that is explained below after that to create the dataset of each buoy including the reanalysis variables and the flux of energy a data integration process or matching has been carried out to merge both sources of information taking into account that the buoys measurements were hourly collected from 00 50 h to 23 50 h and that the reanalysis data is available every 6 hours 00 h 06 h 12 h and 18 h the matching has been performed every 6 hours with the nearest buoy measurement discarding the remaining ones as a result of the matching for each instance both the value of each reanalysis variable and the value of the flux of energy correspond to the same time instant specifically for the first instance such values refer to 2015 01 01 00 00 h for the second one to 2015 01 01 06 00 h 6 h and so on until 2018 12 31 18 00 h in this way the values for each instance and time prediction horizon of the flux of energy 6 h 12 h 24 h and 48 h are taken from one two four and eight instances in advance respectively it is worth mentioning that instances from 2018 12 30 00 00 h to 2018 12 31 18 00 h required energy flow values calculated from 2019 01 01 00 00 h to 2019 01 02 18 00 h to fully accomplish the time prediction horizons besides given that the reanalysis data grid of each buoy is composed of 4 reanalysis nodes see table 2 the values for each reanalysis variable have been calculated as a weighted mean according to the distance from each reanalysis node to the location of the buoy to calculate the distance the haversine equation also known as the great circle distance de smith et al 2009 has been applied 2 d p 0 p j arccos sin l a t 0 sin l a t j cos l o n 0 l o n j cos l a t 0 cos l a t j where p 0 is the geographical location of the buoy p j is the location of each reanalysis node and l a t and l o n are the latitude and longitude of the points respectively once the distances are calculated they are inverted and normalised as follows 3 w i d p 0 p i j 1 n d p 0 p j i 1 n where w i is the weight of the data from the i th reanalysis node these weights will be used to obtain a final value for the input variable as a weighted average of the four values from the surrounding reanalysis nodes in this way the closest reanalysis nodes to the buoy will provide more information than the rest of the nodes which are farther note that this weighting process takes advantage from the information provided by the 4 reanalysis nodes without increasing neither the computational cost nor the complexity of the models trained on this data as a result of the whole process described one dataset has been obtained for each buoy containing 5844 instances years 2015 to 2018 in turn each dataset consists of 7 input variables one for each weighted reanalysis variable and 4 output variables one for each time prediction horizon of the flux of energy flux energy 6 h ahead 12 h ahead 24 h ahead and 48 h ahead 3 methodology evolutionary artificial neural networks in this section the artificial neural networks ann models used in this paper are introduced along with the different type of basis functions considered besides the evolutionary algorithm used to evolve the anns is also described in detail 3 1 artificial neural networks anns bishop et al 1995 exhibit features such as learning and adaptation universal approximation abilities or feasibility for hardware implementation among others making them particularly attractive for modelling many non linear real world problems in fact they have become a widely used kind of non linear models owing to the competitive results obtained in a huge variety of classification and regression problems although many different types of neural network architectures have been used the most popular is the multilayer perceptron mlp bishop et al 1995 which consists of one input layer at least one hidden layer and one output layer as mentioned above the goal of this study is to design anns able to predict flux of energy at four different time prediction horizons simultaneously that is 6 h 12 h 24 h and 48 h therefore the problem is tackled following the multi task regression paradigm that is formally defined as follows 4 d x i y i 6 h y i 12 h y i 24 h y i 48 h i 1 2 n where d is the dataset used x i is a vector that contains the seven input weighted reanalysis variables y i 6 h y i 12 h y i 24 h and y i 48 h are the flux of energy at each time prediction horizon and n is the number of instances in order to perform this task a neural network model with four linear outputs is considered regardless the hidden layer type the ann output is given by the following expression 5 f q x w β β q 0 j 1 m β q j b j x w j q 1 q where b j x w j represents the non linear transformations performed by the basis function of each hidden neuron on the input vector x t x 1 x 2 x d being d its length and considering the element b 0 x w j 1 as bias β q t β q 0 β q 1 β q 2 β q m are the weights from linear combination estimated from the data including bias β q 0 w j t w j 1 w j 2 w j d represents the parameters associated to each basis function m is the number of basis functions used to minimise some defined error function and q is the number of outputs of the problem q 4 in our case for the problem tackled as it has been described in section 2 the input layer of the neural network model is composed of 7 neurons one for each input variable whereas the output layer is composed of 4 neurons one for each time prediction horizon of the flux of energy 6 h 12 h 24 h and 48 h concerning the neurons of the hidden layer the following three basis functions will be analysed because of being the most widely used in the state of the art sigmoidal unit su lippmann 1989 can be considered as the most common basis function used sigmoidal neural networks or mlps can approximate any continuous function accurately however they can get trapped in local minimum frequently during the training phase according to the notation described above su basis function is expressed as follows 6 b j x w j 1 1 e w j 0 i 1 d w j i x i j 1 m w j 0 being the bias product unit pu martínez estudillo et al 2008 basis function is an alternative to su and it provides multiplicative neurons instead of additives ones pu based neural networks are able to represent strong interactions between input variables though their training is more complicated because small changes in weights may cause large changes in the total error surface according to the notation used pu basis function is given by the following expression 7 b j x w j i 1 d x i w j i j 1 m where w j t w j 1 w j 2 w j d not considering bias w j 0 in the inputs radial basis function rbf billings and zheng 1995 is a kernel function whereas pu an su are projection functions therefore rbf provides local behaviour for each neuron due to that each one is placed in distinct region of search space reducing the number of local minima according to the notation followed rbf basis function is represented as follows 8 b j x w j e 1 2 i 1 d x i c j i 2 r j j 1 m where w j r j c j including the radium r j and the centroid c j of the gaussian basis function of the j th hidden neuron the topology of the artificial neural networks considered is represented in fig 3 where each of this three types of basis functions can be used for the hidden layer even though most anns use linear functions in the output layer as described in eq 5 for this study the performance of pus in the output layer will be also evaluated specifically an ann composed of sus in the hidden layer and pus in the output layer is proposed the motivation behind this architecture is that pus are multiplicative functions able to infer the properties of an universal approximator schmitt 2002 in this sense this topology can exploit the interactions between the outputs of the hidden layer therefore although the difficulty in the training step can be harder they can result in better performance up to now and to the best of our knowledge this is the first work considering such approach in flux of energy prediction when using pu in the output layer the ann output is defined as follows 9 f q x w β j 1 m b j x w j β q j q 1 q 3 2 evolutionary algorithms given the non linearity of neural networks the error surface exhibits high convolution and many local minima as a consequence the estimation of the parameters and structure of anns results in a very hard and complex task yao 1999 the most widely used method to train neural networks is back propagation though it falls in local optima often as an alternative evolutionary algorithms eas ser et al 2019 were proposed as an efficient search method able to discover regions in the error surface where competitive solutions are located therefore the use of an ea to evolve anns is justified to determine an appropriate structure and training the weights in this study the algorithm proposed in martínez estudillo et al 2008 has been considered and it is described in algorithm 1 the algorithm begins the search generating an initial random population of neural networks after that the individuals are evaluated and ranked according to the mean squared error mse see eq 10 and in each iteration the worst 10 of the population is replaced by the best 10 of the population next all neural networks are evolved by means of parametric and structural mutations on the one hand parametric mutation involves updating the weights of the neural network but not the structure for su pu and rbf neurons it is done by adding a gaussian noise from a normal distribution with 0 mean and a variance which is decremented throughout the evolutionary process on the other hand structural mutation allows exploring different structures with regards the connections between neurons and the number of nodes of the networks in that sense five types of structural mutations are applied add link delete link add neuron delete neuron and neuron fusion crossover is not used because it is considered inefficient for evolving neural networks angeline et al 1994 the characteristics of the algorithm make it to fall into the category of evolutionary programming ep it has proved to be very efficient regardless of the initial search conditions achieving competitive solutions without using gradients during evolutionary process both structure and weights of the anns are optimised considering the mse defined as follows 10 m s e x w β 1 q q 1 q 1 n i 1 n y i q f q x w β 2 where f q x w β represents the ann output previously defined y i q is the observed flux of energy for the instance i at the time prediction horizon q q is the number of outputs of the problem q 4 in our case and n is the number of instances in this way four different types of multi task evolutionary artificial neural networks will be studied and they will be referred according to their architecture that is the basis function used in the hidden layer and in the output layer in that sense su li pu li and rbf li refer to the evolved models considering each basis function in the hidden layer su pu and rbf respectively and linear li output whereas su pu refers to su in the hidden layer and pu in the output layer the standard error of prediction sep will also be considered in order to compare the performance of mteanns this is a relative error that is expressed as a percentage and it has the advantage of being dimensionless it is described as follows 11 s e p x w β 100 y m s e x w β being y the average of all outputs of all instances in dataset 4 experimental settings and results in this section we explain the experimental settings used for the different mteanns considered furthermore the results achieved by these models and an extensive comparison against some state of the art regression techniques are also presented 4 1 experimental settings as previously described in section 2 the original datasets are divided into two different sets the first three years 2015 2017 for training the models 4384 instances whereas the last year 2018 is used for testing 1460 instances the mteanns have been trained using the following parameters the algorithm has been run 30 times using 5000 generations and a population size of 600 the number of nodes and links to be created or deleted falls in the ranges 1 5 and 1 7 respectively furthermore the number of hidden nodes for the pu li is initialised in the range 1 3 due to its simplicity in the case of su li and su pu as they need a higher number of hidden nodes this number is initialised in the range 1 10 finally in the case of rbf li it varies in the range 1 2 regarding the weights between input and hidden layer they are initialised in the range 10 10 for su li su pu and pu li whereas for rbf li they are initialised in the range 0 1 0 9 finally the weights between the hidden and output layer are all initialised in the range 10 10 before the application of the mteann models the input variables have been scaled to the range 0 1 0 9 2 2 further information of the parameters considered can be found in martínez estudillo et al 2006 hervás et al 2007 and fernandez caballero et al 2010 whereas more information regarding the ann models can be obtained from bishop et al 1995 furthermore we have carried out an extensive comparison against several state of the art techniques widely used for the energy flux prediction support vector regressor svr vapnik 2013 linear regression linearreg bishop 2006 ridge regression ridgereg bishop 2006 lasso regression lassoreg friedman et al 2010 elasticnet zou and hastie 2005 and extreme learning machines elm huang et al 2006 note that the first three techniques are standard regressors which can still be applied to multi output problems whereas the last three regressors can be adapted to multi task learning and we have considered the corresponding version the main difference between these two groups of models is that standard regressors can be applied to multi output problem predicting two or more numerical values given an input pattern without sharing the inferred structure i e a different model is built for each output on the other hand multi task methods take advantage from inferring a common representation from the related tasks in this case the energy flux prediction at different time horizons i e one model is able to tackle simultaneously all the tasks given their deterministic nature all these techniques have been run once except elm which has been run 30 times to provide a fair and robust comparison to the remaining techniques moreover in order to establish a fair and robust comparison of the methods the parameters of such techniques have been selected using a 10 fold cross validation over the training set the best configuration is the one achieving the lowest mse specifically to adjust the kernel width svr uses the range 1 0 3 1 0 2 1 0 3 ridgereg lassoreg and elasticnet use the range 1 0 3 1 0 2 1 0 3 to fit the regularisation parameter and in the case of elasticnet the range 0 10 0 50 0 70 0 90 0 95 0 99 1 00 is used for the ratio of the l1 penalisation weight finally for elm rbf units are used in the hidden layer with a varying number of neurons chosen in the range 10 20 60 4 2 results the results achieved using the experimental settings in section 4 1 are presented in table 3 in terms of mse sep and number of links c o n n given that all the mteann and elm techniques have been run 30 times the results are expressed as their mean and standard deviation sd m e a n s d as can be seen this table 3 is divided into three parts one for each buoy considered in the study 46001 46066 and 46085 respectively furthermore in order to provide a fair comparison the mse and sep values have been presented in two ways for every output 6 h 12 h 24 h and 48 h and in average terms which is the average of the values for every output from table 3 we can see that mteann models achieve the best performance in terms of mse specifically for buoys 46001 and 46085 su li is the one obtaining the best results in average whereas for buoy 46066 pu li achieves the best results although the differences with the results achieved by su li are negligible regarding sep su li also achieves the best values for the buoys 46001 and 46085 whereas for 46066 elm obtains the best performance being su li the second one furthermore it is worth mentioning that most of mteann models are stable i e the standard deviation values are considerably small finally regarding the number of connections rbf li is the most simple model achieving competitive results whereas pu li is the second one on the other hand even though su li achieves the best performance it is worthy of mention that the results achieved by rbf li and pu li demonstrate that these models are also an excellent approach especially due to the small number of connections used moreover table 4 shows the results in terms of mse sep and c o n n for the best models selected according to the best value of average mse which is the metric used for the optimisation step table 4 includes the results obtained by the deterministic techniques considered and it is also divided into three different parts showing each part the results for the different buoys 46001 46066 and 46085 respectively as can be seen in table 4 su li is also achieving the best values in terms of mse with average values of 1042 08 1163 62 and 1004 12 for the buoys 46001 46066 and 46085 respectively moreover regarding sep values su li also achieves the best values for buoys 46001 and 46085 110 83 and 100 83 respectively whereas for buoy 46066 elm obtains the best results 90 48 besides regarding the number of connections standard regressions models are the simplest ones but if we only consider the complex models i e mteann svr and elm it can be seen that mteanns use fewer number of links in comparison against svr and elm although su pu do not stand out by its average results it is worthy of mention that it achieves the second best results for both mse and sep for the buoys 46001 and 46085 and competitive results for the buoy 46066 in terms of mse as can be seen su pu best models have obtained a good performance although its average results are slightly worse the reason of such behaviour is that small changes in the weights exponents of the pu basis function cause large changes in the outputs of the neural network which makes su pu model unstable to train when compared to the other mteanns considered therefore the use of mteann models is justified due to they achieve the best and the second best values in terms of both mse and sep for most of the buoys furthermore the performance obtained by the mteann best models is considerably better than the one obtained for the state of the art methods considered summarising su li structure does not only achieve competitive results in average terms but also obtains competitive values for the best models in terms of both mse and sep using a small number of connections in addition the proposed mteann methodology has been compared against the same methodology but using a single task scheme i e eanns predicting only one time prediction horizon in this sense the performance of su li model has been compared to four single task models that predict the flux of energy at 6 h 12 h 24 h and 48 h respectively which are referred as su li st to train such models the same parameter values described in section 4 1 have been considered though using 3000 generations because of single task scheme is less demanding the results obtained are shown in table 5 concerning mean values we can observe that the multi task model su li model achieves better average mse and sep results in all buoys than the four single task models denoted as su li st besides su li model also obtains the best mse and sep results in each time prediction horizon except for the 6 h time prediction horizon of the buoy 46066 it can be checked that the differences in performance increase from 12 h onward being higher in long term predictions specially for buoys 46066 24 h and 48 h and 46085 48 h demonstrating that mteann models benefit from the short term prediction time horizons regarding best models values su li model also achieves the best average performance for each buoy su li st models get best results for 6 h time prediction horizon of all buoys however for 12 h 24 h buoys 46001 and 46066 and 48 h all buoys time prediction horizons su li model takes advantage of related tasks resulting in more accurate models these results confirm that considering a multi task model for related energy flux prediction tasks reduces the average error and almost all individual errors this is due to the fact that multi task paradigm is able to benefit from what is learnt in a given task to improve the error in other related tasks moreover given that mteann methodology requires only one model and less connections in comparison to the four single task models their implementation is easier and even achieves a better performance therefore it can be considered more efficient for the problem tackled 5 discussion the main objective of this paper was to find a model able to accurately predict the energy flux for three buoys located in the gulf of alaska at four different time prediction horizons 6 h 12 h 24 h and 48 h in this way we have found that su li model is able to achieve competitive results in comparison against the most popular techniques in the state of the art furthermore not only is this model able to achieve the best performance in terms of both mse and sep but also it is composed by a small number of links in comparison to other models of similar complexity such as svr or elm regarding the results of the best models in table 4 the su li model achieves the best performance in terms of mse for all the buoys and the best results in sep for two of the three buoys with a small number of connections less complexity in order to demonstrate the robustness and stability of this model the distribution of the results for the 30 executions shown in table 3 is graphically presented in fig 4 considering both performance measures mse a and sep b we can appreciate that the models developed are stable for all the buoys having a small standard deviation and exhibiting only a few runs that could be considered as outliers most of them for the buoy 46066 fig 5 shows the performance of the su li a svr b and elm c models for the buoy 46085 considering only one of the outputs prediction horizon 6 h and the first 1000 test samples for visualisation purposes in these figures the difference in performance can be appreciated between the best method su li and two of the most popular techniques in the state of the art svr and elm svr achieves the lowest performance not being able to predict the highest values of energy flux regarding elm and su li both seem to correctly estimate most of the low values of energy flux however the main difference lies in the estimation of the high values where su li achieves a better performance as can be seen between the 200th and 400th test samples moreover fig 6 shows the scatter plots for the prediction of energy flux at the time prediction horizon of 24 h for the su li a svr b and elm c models considering the buoy 46001 we have chosen this time prediction horizon to demonstrate that mteanns are able to obtain a competitive performance also in the long term prediction specifically it can be seen that as happened in fig 5 svr is only able to correctly estimate low values of energy flux nevertheless su li and elm are able to estimate more adequately also the high values of energy flux being su li specially better for those in the range from 100 to 200 kw m so far the analysis has been focused on the ability of the models to predict the energy flux at short term and long term however it is worthy to discuss the performance of the models from the time prediction horizon point of view in this sense table 6 shows the average of each lead time for the three stations note that the average column includes the mean and sd of the stochastic models which have been run 30 times whereas the best column includes errors of both stochastic and deterministic models of table 4 as can be concluded from table 6 the best results are achieved for the 6 h time prediction horizon the error increasing for higher lead times the lowest values for both mse and sep are achieved for the 6 h time prediction horizon whereas the highest values are obtained for the 48 h time prediction horizon furthermore in order to provide a graphical comparison of the different time prediction horizons figs 7 8 9 and 10 show the predictions achieved for the buoy 46066 by the best model su li and the two main state of the art models in the literature svr and elm for the prediction horizons 6 h 12 h 24 h and 48 h respectively for the three first prediction horizons 6 h 12 h and 24 h it can be seen that in general elm and su li models achieve satisfactory results although those from su li are slightly better as expected the results for the long term prediction horizon 48 h are less accurate but the models are able to follow the general behaviour of the energy flux 6 conclusions in this paper we have analysed the performance of four different types of multi task evolutionary artificial neural networks mteann in the field of marine energy flux prediction specifically observed data from three buoys located in the gulf of alaska have been considered in order to measure the energy flux whereas seven variables from reanalysis data have been used as input variables therefore the prediction of the energy flux is performed only considering reanalysis data avoiding missing data problems and allowing the applicability to other locations moreover the target values have been taken at 4 different time prediction horizons 6 h 12 h 24 h and 48 h with the main goal of predicting not only short term values but also long term ones the principal objective of this paper was to obtain a multi task model achieving competitive results with lower complexity i e simple models with a small number of connections in this sense mteanns using different sort of basis functions product units pus sigmoidal units sus and radial basis functions rbfs have been tested resulting in the combination of sus in the hidden layer with linear units in the output layer su li the one that achieves the best results for the three buoys considered in addition rbf li and pu li approaches also achieve competitive results benefiting also from its low complexity concerning the su pu approach the best models have obtained a good performance although the average results of the 30 runs are slightly worse less stability furthermore these mteann models have been compared against several state of the art approaches including the popular support vector regressors svr and extreme learning machines elm which have been proved to be competitive for the problem tackled yet obtaining worse results than su li therefore we have shown that the proposed approaches are able to solve the problem with a high level of accuracy demonstrating that mteann models are an excellent approach for the prediction of energy flux at both short and long term time prediction horizons finally the results obtained also demonstrated that the proposed methodology achieve accurate energy flux predictions using reanalysis data as input without requiring additional observed data during the test phase as future research it will be interesting to broaden the study including buoys from other locations and to test hybrid models able to take advantage of the combination of different basis functions credit authorship contribution statement david guijo rubio methodology validation formal analysis investigation writing original draft visualization antonio m gómez orellana methodology software validation investigation data curation writing original draft pedro a gutiérrez conceptualization software formal analysis writing review editing césar hervás martínez conceptualization resources supervision project administration funding acquisition acknowledgements this research has been partially supported by the ministerio de economía industria y competitividad of spain ref tin2017 85887 c2 1 p and the fondo europeo de desarrollo regional feder y de la consejería de economía conocimiento empresas y universidad de la junta de andalucía ref uco 1261651 d guijo rubio s research has been supported by the fpu predoctoral program from spanish ministry of science innovations and universities grant ref fpu16 02128 declaration of competing interest no author associated with this paper has disclosed any potential or pertinent conflicts which may be perceived to have impending conflict with this work for full disclosure statements refer to https doi org 10 1016 j oceaneng 2020 108089 
21498,this paper presents a novel approach to tackle simultaneously short and long term energy flux prediction specifically at 6 h 12 h 24 h and 48 h time horizons the methodology proposed is based on the multi task learning paradigm in order to solve the four problems with a single model we consider multi task evolutionary artificial neural networks mteann with four outputs one for each time prediction horizon for this purpose three buoys located at the gulf of alaska are considered measurements collected by these buoys are used to obtain the target values of energy flux whereas only reanalysis data are used as input values allowing the applicability to other locations the performance of three different basis functions sigmoidal unit radial basis function and product unit are compared against some popular state of the art approaches such as extreme learning machines and support vector regressors the results show that mteann methodology using sigmoidal units in the hidden layer and a linear output achieves the best performance in this way the multi task methodology is an excellent and lower complexity approach for energy flux prediction at both short and long term prediction time horizons furthermore the results also confirm that reanalysis data is enough for describing well the problem tackled keywords wave energy flux prediction marine energy multi task machine learning evolutionary artificial neural networks reanalysis data 1 introduction in the last decades there has been an increase in the carbon dioxide levels and in consequence the global mean temperatures have also risen according to the special report regarding global warming done by the intergovernmental panel on climate change ipcc hoegh guldberg et al 2018 the surface temperatures are increasing by about 0 2 c per decade the ongoing rise of the average temperature of the earth is leading to wildfires the expansion of deserts or more intense storms among others council et al 2012 therefore the interest in renewable and eco friendly energy sources such as solar wind tides and waves is in continuous growth ellabban et al 2014 although solar and wind are considered the most popular alternative sources of energy they have the setback of not being constantly available due to the intermittent nature of wind and sun on the other hand tides and waves not only benefit from being always in movement but they also can be used in many parts of the world including oceans or big seas furthermore given that the energy storage systems are a major challenge palmer and floyd 2020 and that around 40 of the world s population live within 100 km of the coast the wave and tidal renewable energies allow for a cost effective transmission of electricity esteban and leary 2012 waves exhibit a stochastic nature due to the influence of a great number of environmental elements therefore they cannot be predicted straightforwardly as tides due to this stochastic behaviour the reliability and confidence of wave energy generation need to be predicted beforehand in order to develop an stable source of energy for the generation of electricity from wave energy wave energy converters wecs falcão 2010 aderinto and li 2018 are applied in order to transform the kinetic energy directly generated by the waves into electricity falnes and kurniawan 2020 to model the behaviour of wave energy the two most important parameters are the significant wave height h s and the wave energy flux f e which have been widely studied in the literature from different perspectives nitsure et al 2012 physical models ibarra berastegi et al 2015 statistical models lin et al 2020 or by the application of machine learning ml techniques cuadra et al 2016 among others focusing on ml approaches some of the first works published were those of deo and naidu 1998 and deo et al 2001 which consisted in real time forecasting of h s by using artificial neural network ann models later the ann methodology has been validated by some other authors such as castro et al 2014 who applied ann models to predict the wave energy resource in the northern coast of spain hadadpour et al 2014 focused on forecasting the wave energy over horizons from 1 to 12 hours in the southern part of the caspian sea support vector regressors svrs have also been used for h s forecasting leading to competitive results mahjoobi and mosabbeb 2009 duan et al 2016 another approach was proposed by cornejo bueno et al 2016b who developed a grouping genetic algorithm applied to extreme learning machines elms to predict both h s and f e in this work a feature selection is carried out to select the most relevant features for the regressor machine more recent works used an ensemble of elms for the prediction of h s in 10 stations of varying terrains from gulf of mexico brazil and korean region kumar et al 2018 ali and prasad 2019 also applied elms coupled with an improved complete ensemble empirical mode decomposition method using adaptive noise to predict h s in the eastern coastal zones of australia cornejo bueno et al 2018 considered a regression genetic fuzzy system known as fruler for the prediction of h s and f e in one buoy of the west coast of the usa using measurements from other two neighbour buoys with respect to the sort of data used fernández et al 2015 proposed the use of meteorological data obtained from ncep ncar reanalysis project and applied several ordinal classifiers for the prediction of both h s and f e on the other hand salcedo sanz et al 2015 and cornejo bueno et al 2016a used features extracted from x band radar images as input variables whereas choi et al 2020 used only raw ocean images to estimate real time h s using svr and 2d and 3d deep learning approaches ml techniques have also been used for forecast water level in lakes at various horizons in kisi et al 2015 the models were developed using svm coupled with firefly algorithm fa the fa was applied to estimate the optimal svm parameters in shiri et al 2016 the authors used the popular elm whose results were compared with genetic programming and anns despite the hard work done in h s and f e prediction there is not up to the knowledge of the authors any previous study analysing the short and long term energy flux prediction simultaneously considering ml algorithms and reanalysis data for developing accurate flux of energy prediction models this is the main motivation to carry out this study in order to accomplish this goal two architectures of multi task anns are optimised by applying an evolutionary algorithm specifically the ann models have four outputs the first two ones for short term prediction 6 h and 12 h and the second two for long term prediction 24 h and 48 h the purpose of the evolutionary algorithm is to optimise the structure of the anns proposed for the problem tackled the methodology proposed performs flux of energy prediction using reanalysis variables as input data that is no observed data is required what improves its applicability to other sites on the other hand simultaneous energy flux prediction at different time horizons establishes a relationship between all of them that can be exploited to obtain a single model to better solve all the prediction time horizons in this sense multi task learning mtl caruana 1997 is a ml technique that exploits such relationship taking advantage of the latent information when performing related tasks simultaneously maurer et al 2016 dorado moreno et al 2020 hence the model can infer such information to improve its performance consequently the methodology proposed in this study exhibits the following novelties 1 a mtl approach is presented with the objective of short and long term energy flux prediction simultaneously four types of multi task evolutionary artificial neural networks mteann are developed and studied 2 given that the methodology only uses reanalysis variables as input data it could be extended to other locations 3 a comprehensive comparison against some state of the art regression techniques elm and svr among others is presented 4 a single mteann performs all the different time prediction horizons 6 h 12 h 24 h and 48 h being less complex when compared against the literature techniques 5 moreover mteann methodology exhibits the advantage of requiring just one model with less connections in comparison to the sum of the connections of four independent single task models only performing one time prediction horizon the rest of the paper is organised as follows in section 2 a detailed description of the data used and the preprocessing steps applied is presented section 3 describes the methodology proposed for the energy flux prediction problem the performance of the different mteann models and the comparison against the state of the art techniques are studied and analysed in section 4 section 5 discusses the results achieved according to the best model finally section 6 gives some concluding remarks for closing the paper 2 data description and processing this section introduces the data used in this study which have been obtained from the following two well known sources of information national data buoy center ndbc national data buoy center 2020 maintains a network of buoys deployed in coastal and offshore waters around oceans and seas such buoys are equipped with assorted sensors to collect real time marine meteorological and oceanographic observations including significant wave height average wave period or sea level pressure among others national center for atmospheric research ncar kalnay et al 1996 kistler et al 2001 provides a global 2 5 2 5 grid of reanalysis data of meteorological variables e g pressure air temperature relative humidity etc which are obtained by means of a climate model that assimilates weather observations collected from different sources specifically to carry out this study hourly collected measurements of three buoys and 4 times daily values of seven reanalysis variables have been selected during years 2015 to 2018 in that way all input variables will be obtained from reanalysis data whereas the output variables will be obtained from observed data collected by sensors installed in each buoy the following subsections describe in detail such data 2 1 buoys measurements the buoys subject to research are located in the gulf of alaska as shown in fig 1 this region has a high frequency and variability regarding occurrence of storms and as a consequence it is a zone of intense wave generation in this sense three buoys have been selected according to their proximity and depth of water buoy 46001 llnr 984 ndbc station 46001 2020 western gulf of alaska 175 nm se of kodiak ak geographical location 56 232n 147 949w buoy 46066 llnr 984 1 ndbc station 46066 2020 south kodiak 310 nm ssw of kodiak ak geographical location 52 765n 155 009w buoy 46085 llnr 984 15 ndbc station 46085 2020 central gulf of alaska 265 nm west of cape ommaney ak geographical location 55 883n 142 482w although the flux of energy f e is not directly measured by the buoys sensors it can be calculated from two wave parameters measured by the buoys the significant wave height h s and the average wave period t e in this way for the three selected buoys the f e of each time instant has been obtained using the following equation 1 f e 0 49 h s 2 t e where f e is measured in kilowatts per metre h s is measured in metres and t e is measured in seconds due to h s is a kind of average wave height f e is defined in eq 1 as an average energy flux nevertheless for simplicity it will be referred as flux of energy given that the goal of this study is to predict the flux of energy generated by the waves at different time prediction horizons only such buoy measurement will be considered when obtaining the datasets 2 2 reanalysis data grid with respect to the reanalysis data used in this study seven variables have been considered shown in table 1 the reasons behind the selection of these reanalysis variables are two firstly to have a good characterisation of wind and secondly to take advantage of the contribution of weather factors that exert on it on the one hand waves and consequently flux of energy are generated with the action of wind in this sense air temperature pressure omega vertical velocity and the south north and west east components of wind speed have been selected as appropriate descriptive variables of the wind in a given zone fernández et al 2015 dorado moreno et al 2017 ibarra berastegi et al 2015 on the other hand atmospheric processes play an important role when tackling environmental modelling because they provide useful information to better understand the formation and evolution of cyclones storms and other related phenomena in this way and given that the three buoys under study are located at the gulf of alaska precipitable water content is a key component to find patterns that could lead to severe weather events campmany et al 2010 wang et al 2018 choy et al 2013 furthermore relative humidity provides additional information about the occurrence of deep convection siingh et al 2014 given that the nnrp web page provides a global 2 5 2 5 grid for each reanalysis variable the four closest geographical points reanalysis nodes to each buoy have been selected in that way each reanalysis file includes the data of one meteorological variable for each reanalysis node that surrounds the buoy for the selected years 2015 to 2018 for a better understanding in fig 2 an approximate representation of the four reanalysis nodes around the geographical location of the buoy 46001 is shown as a result three one for each buoy reanalysis data grids have been considered as described in table 2 finally the reanalysis data have been obtained with the minimum temporal resolution available that is 4 times daily 00 h 06 h 12 h and 18 h 2 3 obtaining the datasets firstly a preprocessing task has been performed to recover the values of the measurements not recorded by the buoys note that such missing values were insignificant due to only the h s and t e variables have been used to calculate the flux of energy and because of the data integration process that is explained below after that to create the dataset of each buoy including the reanalysis variables and the flux of energy a data integration process or matching has been carried out to merge both sources of information taking into account that the buoys measurements were hourly collected from 00 50 h to 23 50 h and that the reanalysis data is available every 6 hours 00 h 06 h 12 h and 18 h the matching has been performed every 6 hours with the nearest buoy measurement discarding the remaining ones as a result of the matching for each instance both the value of each reanalysis variable and the value of the flux of energy correspond to the same time instant specifically for the first instance such values refer to 2015 01 01 00 00 h for the second one to 2015 01 01 06 00 h 6 h and so on until 2018 12 31 18 00 h in this way the values for each instance and time prediction horizon of the flux of energy 6 h 12 h 24 h and 48 h are taken from one two four and eight instances in advance respectively it is worth mentioning that instances from 2018 12 30 00 00 h to 2018 12 31 18 00 h required energy flow values calculated from 2019 01 01 00 00 h to 2019 01 02 18 00 h to fully accomplish the time prediction horizons besides given that the reanalysis data grid of each buoy is composed of 4 reanalysis nodes see table 2 the values for each reanalysis variable have been calculated as a weighted mean according to the distance from each reanalysis node to the location of the buoy to calculate the distance the haversine equation also known as the great circle distance de smith et al 2009 has been applied 2 d p 0 p j arccos sin l a t 0 sin l a t j cos l o n 0 l o n j cos l a t 0 cos l a t j where p 0 is the geographical location of the buoy p j is the location of each reanalysis node and l a t and l o n are the latitude and longitude of the points respectively once the distances are calculated they are inverted and normalised as follows 3 w i d p 0 p i j 1 n d p 0 p j i 1 n where w i is the weight of the data from the i th reanalysis node these weights will be used to obtain a final value for the input variable as a weighted average of the four values from the surrounding reanalysis nodes in this way the closest reanalysis nodes to the buoy will provide more information than the rest of the nodes which are farther note that this weighting process takes advantage from the information provided by the 4 reanalysis nodes without increasing neither the computational cost nor the complexity of the models trained on this data as a result of the whole process described one dataset has been obtained for each buoy containing 5844 instances years 2015 to 2018 in turn each dataset consists of 7 input variables one for each weighted reanalysis variable and 4 output variables one for each time prediction horizon of the flux of energy flux energy 6 h ahead 12 h ahead 24 h ahead and 48 h ahead 3 methodology evolutionary artificial neural networks in this section the artificial neural networks ann models used in this paper are introduced along with the different type of basis functions considered besides the evolutionary algorithm used to evolve the anns is also described in detail 3 1 artificial neural networks anns bishop et al 1995 exhibit features such as learning and adaptation universal approximation abilities or feasibility for hardware implementation among others making them particularly attractive for modelling many non linear real world problems in fact they have become a widely used kind of non linear models owing to the competitive results obtained in a huge variety of classification and regression problems although many different types of neural network architectures have been used the most popular is the multilayer perceptron mlp bishop et al 1995 which consists of one input layer at least one hidden layer and one output layer as mentioned above the goal of this study is to design anns able to predict flux of energy at four different time prediction horizons simultaneously that is 6 h 12 h 24 h and 48 h therefore the problem is tackled following the multi task regression paradigm that is formally defined as follows 4 d x i y i 6 h y i 12 h y i 24 h y i 48 h i 1 2 n where d is the dataset used x i is a vector that contains the seven input weighted reanalysis variables y i 6 h y i 12 h y i 24 h and y i 48 h are the flux of energy at each time prediction horizon and n is the number of instances in order to perform this task a neural network model with four linear outputs is considered regardless the hidden layer type the ann output is given by the following expression 5 f q x w β β q 0 j 1 m β q j b j x w j q 1 q where b j x w j represents the non linear transformations performed by the basis function of each hidden neuron on the input vector x t x 1 x 2 x d being d its length and considering the element b 0 x w j 1 as bias β q t β q 0 β q 1 β q 2 β q m are the weights from linear combination estimated from the data including bias β q 0 w j t w j 1 w j 2 w j d represents the parameters associated to each basis function m is the number of basis functions used to minimise some defined error function and q is the number of outputs of the problem q 4 in our case for the problem tackled as it has been described in section 2 the input layer of the neural network model is composed of 7 neurons one for each input variable whereas the output layer is composed of 4 neurons one for each time prediction horizon of the flux of energy 6 h 12 h 24 h and 48 h concerning the neurons of the hidden layer the following three basis functions will be analysed because of being the most widely used in the state of the art sigmoidal unit su lippmann 1989 can be considered as the most common basis function used sigmoidal neural networks or mlps can approximate any continuous function accurately however they can get trapped in local minimum frequently during the training phase according to the notation described above su basis function is expressed as follows 6 b j x w j 1 1 e w j 0 i 1 d w j i x i j 1 m w j 0 being the bias product unit pu martínez estudillo et al 2008 basis function is an alternative to su and it provides multiplicative neurons instead of additives ones pu based neural networks are able to represent strong interactions between input variables though their training is more complicated because small changes in weights may cause large changes in the total error surface according to the notation used pu basis function is given by the following expression 7 b j x w j i 1 d x i w j i j 1 m where w j t w j 1 w j 2 w j d not considering bias w j 0 in the inputs radial basis function rbf billings and zheng 1995 is a kernel function whereas pu an su are projection functions therefore rbf provides local behaviour for each neuron due to that each one is placed in distinct region of search space reducing the number of local minima according to the notation followed rbf basis function is represented as follows 8 b j x w j e 1 2 i 1 d x i c j i 2 r j j 1 m where w j r j c j including the radium r j and the centroid c j of the gaussian basis function of the j th hidden neuron the topology of the artificial neural networks considered is represented in fig 3 where each of this three types of basis functions can be used for the hidden layer even though most anns use linear functions in the output layer as described in eq 5 for this study the performance of pus in the output layer will be also evaluated specifically an ann composed of sus in the hidden layer and pus in the output layer is proposed the motivation behind this architecture is that pus are multiplicative functions able to infer the properties of an universal approximator schmitt 2002 in this sense this topology can exploit the interactions between the outputs of the hidden layer therefore although the difficulty in the training step can be harder they can result in better performance up to now and to the best of our knowledge this is the first work considering such approach in flux of energy prediction when using pu in the output layer the ann output is defined as follows 9 f q x w β j 1 m b j x w j β q j q 1 q 3 2 evolutionary algorithms given the non linearity of neural networks the error surface exhibits high convolution and many local minima as a consequence the estimation of the parameters and structure of anns results in a very hard and complex task yao 1999 the most widely used method to train neural networks is back propagation though it falls in local optima often as an alternative evolutionary algorithms eas ser et al 2019 were proposed as an efficient search method able to discover regions in the error surface where competitive solutions are located therefore the use of an ea to evolve anns is justified to determine an appropriate structure and training the weights in this study the algorithm proposed in martínez estudillo et al 2008 has been considered and it is described in algorithm 1 the algorithm begins the search generating an initial random population of neural networks after that the individuals are evaluated and ranked according to the mean squared error mse see eq 10 and in each iteration the worst 10 of the population is replaced by the best 10 of the population next all neural networks are evolved by means of parametric and structural mutations on the one hand parametric mutation involves updating the weights of the neural network but not the structure for su pu and rbf neurons it is done by adding a gaussian noise from a normal distribution with 0 mean and a variance which is decremented throughout the evolutionary process on the other hand structural mutation allows exploring different structures with regards the connections between neurons and the number of nodes of the networks in that sense five types of structural mutations are applied add link delete link add neuron delete neuron and neuron fusion crossover is not used because it is considered inefficient for evolving neural networks angeline et al 1994 the characteristics of the algorithm make it to fall into the category of evolutionary programming ep it has proved to be very efficient regardless of the initial search conditions achieving competitive solutions without using gradients during evolutionary process both structure and weights of the anns are optimised considering the mse defined as follows 10 m s e x w β 1 q q 1 q 1 n i 1 n y i q f q x w β 2 where f q x w β represents the ann output previously defined y i q is the observed flux of energy for the instance i at the time prediction horizon q q is the number of outputs of the problem q 4 in our case and n is the number of instances in this way four different types of multi task evolutionary artificial neural networks will be studied and they will be referred according to their architecture that is the basis function used in the hidden layer and in the output layer in that sense su li pu li and rbf li refer to the evolved models considering each basis function in the hidden layer su pu and rbf respectively and linear li output whereas su pu refers to su in the hidden layer and pu in the output layer the standard error of prediction sep will also be considered in order to compare the performance of mteanns this is a relative error that is expressed as a percentage and it has the advantage of being dimensionless it is described as follows 11 s e p x w β 100 y m s e x w β being y the average of all outputs of all instances in dataset 4 experimental settings and results in this section we explain the experimental settings used for the different mteanns considered furthermore the results achieved by these models and an extensive comparison against some state of the art regression techniques are also presented 4 1 experimental settings as previously described in section 2 the original datasets are divided into two different sets the first three years 2015 2017 for training the models 4384 instances whereas the last year 2018 is used for testing 1460 instances the mteanns have been trained using the following parameters the algorithm has been run 30 times using 5000 generations and a population size of 600 the number of nodes and links to be created or deleted falls in the ranges 1 5 and 1 7 respectively furthermore the number of hidden nodes for the pu li is initialised in the range 1 3 due to its simplicity in the case of su li and su pu as they need a higher number of hidden nodes this number is initialised in the range 1 10 finally in the case of rbf li it varies in the range 1 2 regarding the weights between input and hidden layer they are initialised in the range 10 10 for su li su pu and pu li whereas for rbf li they are initialised in the range 0 1 0 9 finally the weights between the hidden and output layer are all initialised in the range 10 10 before the application of the mteann models the input variables have been scaled to the range 0 1 0 9 2 2 further information of the parameters considered can be found in martínez estudillo et al 2006 hervás et al 2007 and fernandez caballero et al 2010 whereas more information regarding the ann models can be obtained from bishop et al 1995 furthermore we have carried out an extensive comparison against several state of the art techniques widely used for the energy flux prediction support vector regressor svr vapnik 2013 linear regression linearreg bishop 2006 ridge regression ridgereg bishop 2006 lasso regression lassoreg friedman et al 2010 elasticnet zou and hastie 2005 and extreme learning machines elm huang et al 2006 note that the first three techniques are standard regressors which can still be applied to multi output problems whereas the last three regressors can be adapted to multi task learning and we have considered the corresponding version the main difference between these two groups of models is that standard regressors can be applied to multi output problem predicting two or more numerical values given an input pattern without sharing the inferred structure i e a different model is built for each output on the other hand multi task methods take advantage from inferring a common representation from the related tasks in this case the energy flux prediction at different time horizons i e one model is able to tackle simultaneously all the tasks given their deterministic nature all these techniques have been run once except elm which has been run 30 times to provide a fair and robust comparison to the remaining techniques moreover in order to establish a fair and robust comparison of the methods the parameters of such techniques have been selected using a 10 fold cross validation over the training set the best configuration is the one achieving the lowest mse specifically to adjust the kernel width svr uses the range 1 0 3 1 0 2 1 0 3 ridgereg lassoreg and elasticnet use the range 1 0 3 1 0 2 1 0 3 to fit the regularisation parameter and in the case of elasticnet the range 0 10 0 50 0 70 0 90 0 95 0 99 1 00 is used for the ratio of the l1 penalisation weight finally for elm rbf units are used in the hidden layer with a varying number of neurons chosen in the range 10 20 60 4 2 results the results achieved using the experimental settings in section 4 1 are presented in table 3 in terms of mse sep and number of links c o n n given that all the mteann and elm techniques have been run 30 times the results are expressed as their mean and standard deviation sd m e a n s d as can be seen this table 3 is divided into three parts one for each buoy considered in the study 46001 46066 and 46085 respectively furthermore in order to provide a fair comparison the mse and sep values have been presented in two ways for every output 6 h 12 h 24 h and 48 h and in average terms which is the average of the values for every output from table 3 we can see that mteann models achieve the best performance in terms of mse specifically for buoys 46001 and 46085 su li is the one obtaining the best results in average whereas for buoy 46066 pu li achieves the best results although the differences with the results achieved by su li are negligible regarding sep su li also achieves the best values for the buoys 46001 and 46085 whereas for 46066 elm obtains the best performance being su li the second one furthermore it is worth mentioning that most of mteann models are stable i e the standard deviation values are considerably small finally regarding the number of connections rbf li is the most simple model achieving competitive results whereas pu li is the second one on the other hand even though su li achieves the best performance it is worthy of mention that the results achieved by rbf li and pu li demonstrate that these models are also an excellent approach especially due to the small number of connections used moreover table 4 shows the results in terms of mse sep and c o n n for the best models selected according to the best value of average mse which is the metric used for the optimisation step table 4 includes the results obtained by the deterministic techniques considered and it is also divided into three different parts showing each part the results for the different buoys 46001 46066 and 46085 respectively as can be seen in table 4 su li is also achieving the best values in terms of mse with average values of 1042 08 1163 62 and 1004 12 for the buoys 46001 46066 and 46085 respectively moreover regarding sep values su li also achieves the best values for buoys 46001 and 46085 110 83 and 100 83 respectively whereas for buoy 46066 elm obtains the best results 90 48 besides regarding the number of connections standard regressions models are the simplest ones but if we only consider the complex models i e mteann svr and elm it can be seen that mteanns use fewer number of links in comparison against svr and elm although su pu do not stand out by its average results it is worthy of mention that it achieves the second best results for both mse and sep for the buoys 46001 and 46085 and competitive results for the buoy 46066 in terms of mse as can be seen su pu best models have obtained a good performance although its average results are slightly worse the reason of such behaviour is that small changes in the weights exponents of the pu basis function cause large changes in the outputs of the neural network which makes su pu model unstable to train when compared to the other mteanns considered therefore the use of mteann models is justified due to they achieve the best and the second best values in terms of both mse and sep for most of the buoys furthermore the performance obtained by the mteann best models is considerably better than the one obtained for the state of the art methods considered summarising su li structure does not only achieve competitive results in average terms but also obtains competitive values for the best models in terms of both mse and sep using a small number of connections in addition the proposed mteann methodology has been compared against the same methodology but using a single task scheme i e eanns predicting only one time prediction horizon in this sense the performance of su li model has been compared to four single task models that predict the flux of energy at 6 h 12 h 24 h and 48 h respectively which are referred as su li st to train such models the same parameter values described in section 4 1 have been considered though using 3000 generations because of single task scheme is less demanding the results obtained are shown in table 5 concerning mean values we can observe that the multi task model su li model achieves better average mse and sep results in all buoys than the four single task models denoted as su li st besides su li model also obtains the best mse and sep results in each time prediction horizon except for the 6 h time prediction horizon of the buoy 46066 it can be checked that the differences in performance increase from 12 h onward being higher in long term predictions specially for buoys 46066 24 h and 48 h and 46085 48 h demonstrating that mteann models benefit from the short term prediction time horizons regarding best models values su li model also achieves the best average performance for each buoy su li st models get best results for 6 h time prediction horizon of all buoys however for 12 h 24 h buoys 46001 and 46066 and 48 h all buoys time prediction horizons su li model takes advantage of related tasks resulting in more accurate models these results confirm that considering a multi task model for related energy flux prediction tasks reduces the average error and almost all individual errors this is due to the fact that multi task paradigm is able to benefit from what is learnt in a given task to improve the error in other related tasks moreover given that mteann methodology requires only one model and less connections in comparison to the four single task models their implementation is easier and even achieves a better performance therefore it can be considered more efficient for the problem tackled 5 discussion the main objective of this paper was to find a model able to accurately predict the energy flux for three buoys located in the gulf of alaska at four different time prediction horizons 6 h 12 h 24 h and 48 h in this way we have found that su li model is able to achieve competitive results in comparison against the most popular techniques in the state of the art furthermore not only is this model able to achieve the best performance in terms of both mse and sep but also it is composed by a small number of links in comparison to other models of similar complexity such as svr or elm regarding the results of the best models in table 4 the su li model achieves the best performance in terms of mse for all the buoys and the best results in sep for two of the three buoys with a small number of connections less complexity in order to demonstrate the robustness and stability of this model the distribution of the results for the 30 executions shown in table 3 is graphically presented in fig 4 considering both performance measures mse a and sep b we can appreciate that the models developed are stable for all the buoys having a small standard deviation and exhibiting only a few runs that could be considered as outliers most of them for the buoy 46066 fig 5 shows the performance of the su li a svr b and elm c models for the buoy 46085 considering only one of the outputs prediction horizon 6 h and the first 1000 test samples for visualisation purposes in these figures the difference in performance can be appreciated between the best method su li and two of the most popular techniques in the state of the art svr and elm svr achieves the lowest performance not being able to predict the highest values of energy flux regarding elm and su li both seem to correctly estimate most of the low values of energy flux however the main difference lies in the estimation of the high values where su li achieves a better performance as can be seen between the 200th and 400th test samples moreover fig 6 shows the scatter plots for the prediction of energy flux at the time prediction horizon of 24 h for the su li a svr b and elm c models considering the buoy 46001 we have chosen this time prediction horizon to demonstrate that mteanns are able to obtain a competitive performance also in the long term prediction specifically it can be seen that as happened in fig 5 svr is only able to correctly estimate low values of energy flux nevertheless su li and elm are able to estimate more adequately also the high values of energy flux being su li specially better for those in the range from 100 to 200 kw m so far the analysis has been focused on the ability of the models to predict the energy flux at short term and long term however it is worthy to discuss the performance of the models from the time prediction horizon point of view in this sense table 6 shows the average of each lead time for the three stations note that the average column includes the mean and sd of the stochastic models which have been run 30 times whereas the best column includes errors of both stochastic and deterministic models of table 4 as can be concluded from table 6 the best results are achieved for the 6 h time prediction horizon the error increasing for higher lead times the lowest values for both mse and sep are achieved for the 6 h time prediction horizon whereas the highest values are obtained for the 48 h time prediction horizon furthermore in order to provide a graphical comparison of the different time prediction horizons figs 7 8 9 and 10 show the predictions achieved for the buoy 46066 by the best model su li and the two main state of the art models in the literature svr and elm for the prediction horizons 6 h 12 h 24 h and 48 h respectively for the three first prediction horizons 6 h 12 h and 24 h it can be seen that in general elm and su li models achieve satisfactory results although those from su li are slightly better as expected the results for the long term prediction horizon 48 h are less accurate but the models are able to follow the general behaviour of the energy flux 6 conclusions in this paper we have analysed the performance of four different types of multi task evolutionary artificial neural networks mteann in the field of marine energy flux prediction specifically observed data from three buoys located in the gulf of alaska have been considered in order to measure the energy flux whereas seven variables from reanalysis data have been used as input variables therefore the prediction of the energy flux is performed only considering reanalysis data avoiding missing data problems and allowing the applicability to other locations moreover the target values have been taken at 4 different time prediction horizons 6 h 12 h 24 h and 48 h with the main goal of predicting not only short term values but also long term ones the principal objective of this paper was to obtain a multi task model achieving competitive results with lower complexity i e simple models with a small number of connections in this sense mteanns using different sort of basis functions product units pus sigmoidal units sus and radial basis functions rbfs have been tested resulting in the combination of sus in the hidden layer with linear units in the output layer su li the one that achieves the best results for the three buoys considered in addition rbf li and pu li approaches also achieve competitive results benefiting also from its low complexity concerning the su pu approach the best models have obtained a good performance although the average results of the 30 runs are slightly worse less stability furthermore these mteann models have been compared against several state of the art approaches including the popular support vector regressors svr and extreme learning machines elm which have been proved to be competitive for the problem tackled yet obtaining worse results than su li therefore we have shown that the proposed approaches are able to solve the problem with a high level of accuracy demonstrating that mteann models are an excellent approach for the prediction of energy flux at both short and long term time prediction horizons finally the results obtained also demonstrated that the proposed methodology achieve accurate energy flux predictions using reanalysis data as input without requiring additional observed data during the test phase as future research it will be interesting to broaden the study including buoys from other locations and to test hybrid models able to take advantage of the combination of different basis functions credit authorship contribution statement david guijo rubio methodology validation formal analysis investigation writing original draft visualization antonio m gómez orellana methodology software validation investigation data curation writing original draft pedro a gutiérrez conceptualization software formal analysis writing review editing césar hervás martínez conceptualization resources supervision project administration funding acquisition acknowledgements this research has been partially supported by the ministerio de economía industria y competitividad of spain ref tin2017 85887 c2 1 p and the fondo europeo de desarrollo regional feder y de la consejería de economía conocimiento empresas y universidad de la junta de andalucía ref uco 1261651 d guijo rubio s research has been supported by the fpu predoctoral program from spanish ministry of science innovations and universities grant ref fpu16 02128 declaration of competing interest no author associated with this paper has disclosed any potential or pertinent conflicts which may be perceived to have impending conflict with this work for full disclosure statements refer to https doi org 10 1016 j oceaneng 2020 108089 
21499,the multi uuv unmanned underwater vehicle path tracking control methods in the cases of communication delay and packet loss under sampled data discrete time collection are studied in this paper respectively firstly the second order affine form of uuv s nonlinear dynamic equations is given and by using feedback linearization and direct discretization method the motion equations are transformed to sampled discrete time dynamics secondly the path tracking controllers of multi uuv based on the virtual leader are proposed in two cases the sufficient conditions for the convergence of multi uuv path tracking are given and analyzed by using the matrix theory and shuler theory respectively finally the simulation experiments are presented to prove the effectiveness of the controller each uuv in the multi uuv system can track the desired trajectories in the expected formation keywords multi uuv path tracking sampled data communication delay packet losses 1 introduction in recent years as the advantages of flexible delivery and lower cost uuvs are used in various underwater exploration investigation observation or other tasks yuh 2000 sariel et al 2008 repoulias and papadopoulos 2007 the path tracking ability of multiple uuvs is an important technical prerequisite for underwater tasks such as surveying and searching uuvs use their sensors to collect the data of status information and by using the results of the designed controller which input into the executing agency to complete the specified complex tasks however when the search and detection area becomes larger one single uuv cannot complete the mission quickly because of its physical limits fiorelli et al 2004 zhu et al 2013 the status information between each vehicle exchange through sonars all vehicles in the multi uuv system by using the path tracking controller designed in this paper after receive the position and velocity of other uuvs can achieve accurate path tracking the information transmitted by the sonar may be affected in the situation of communication delay and packet losses it means instant messaging cannot be satisfied therefore to guarantee that the multiple uuvs keep the formation and track the desired path in the extreme underwater environment the path tracking control method for the multi uuv system under sampled data delays and packet losses conditions needs to be studied the early literature and researches are devoted to studying path tracking and trajectory tracking guo et al 2003 li and pan 2005 lapierre and soetanto 2007 ghommam and saad 2014 joe et al 2014 in which the research subject is almost about single uuv however the missions of multiple uuvs cannot be accomplished by using the above control methods vicsek model vicsek et al 1995 may be the first model studied in the multi agent system each agent obtains its neighbors information to keep the same heading and the literature jadbabaie et al 2003 gives a theoretical explanation then the theoretical study of the multi agent system for a single integration system emerged and the proposed cooperative controller can guarantee the consensus of agents under different communication conditions hatano and mesbahi 2005 porfiri and stilwell 2007 huang 2010 in order to improve the usability of consensus control of complex systems the double integrator dynamics model can solve the practical control problems of multiple agents zhang and tian 2009 hu and lin 2010 peng et al 2015 there are some researches about the path tracking problem in multiple agents jia et al 2007 sabattini et al 2013 to solve the tracking problem in the multi uuv system some different approaches are adopted to complete tracking missions in many past works such as distributed adaptive control neural network approximation distributed formation learning control qi 2014 zhao et al 2017a 2017b yuan et al 2017 and so on the information sent by sonars is sampled data so the continuous time based control methods may not be applied well in the discrete time condition cui et al 2010 hu et al 2015 chen and ho 2016 lots of current research has focused on the consensus of multi agent under the time delay condition papachristodoulou et al 2010 yu and wang 2010 wang et al 2015 zhu and jiang 2015 the control input will be affected if the information is not received in time caused by environmental disturbances therefore we need to study the path tracking control method for the multi uuv under sampled data delays and packet losses conditions as the information of transmission data is not continuous data the continuous time model of uuv must be transformed to a discrete time model therefore the sampled discrete time dynamics is given using the second order affine form of uuv s nonlinear dynamic model which is transformed by feedback linearization method the information of position and velocity is transmitted independently the purpose is to reduce the data volume for every exchange of communication the position and velocity of each uuv are calculated by using the designed controller and transmitted to the other uuvs then the driving force and torque of actuators can actuate the uuvs to complete the tracking mission which are obtained combing the dynamic equations the contribution of this paper is virtual leader based path tracking control laws under the conditions of communication delay and packet losses in the previous work yan et al 2019 the results for coordinated control of leader following multiple auvs under switching topologies and communication delays are presented however when the communication conditions become extreme such as communication distance becomes longer agents may not receive the information for some time so the communication packet losses will exist in the multi agent system this paper extends the work by designing the controllers considering the sampled data delays and communication packet losses in a fixed communication structure the proposed controller is also suitable under switching topologies which is proved in our future work for this purpose the discrete time dynamic equations of the multi uuv system are proposed afterward combing with graph theory the controllers are designed the derived method guarantees the tracking trajectories and velocity of uuvs in the multi agent system converge to the desired value the following sections are arranged as follows the dynamics of the uuv based on the body fixed coordinate and earth fixed coordinate is established in sections ⅱ in section ⅲ path tracking controllers based on the virtual leader are proposed in two cases for the first case of bounded delay sufficient conditions are given and analyzed using the matrix theory for the other case of packet losses the shuler theory is used to prove the consistency and the conditions for the convergence of multi uuv path tracking are given the simulation experiments are designed to illustrate the effectiveness of the controller in section ⅳ finally the conclusions are drawn in section ⅴ 2 preliminaries and problem formulation 2 1 graph theory notions communication topologies are one of the important techniques to describe the transformation information between each uuv if n is the number of agents in the multi agent system the directed graph can be represented as g v e the set of points v 1 2 n and the set of edges e i j i j v v v represent the number of vertices and form of information transmitted from the nodes to the nodes respectively the set of points n i j ν is defined as the set of neighbor nodes near the node i where i j e the elements of adjacency matrix a a i j r n n are denoted as a i j 1 and a i i 0 otherwise when i j e the in degree matrix d d i a g d 1 d 2 d i is denoted as d i j 1 n a i j represents the in degree of the node in the communication topology the weighted laplacian matrix is defined as 1 l i j k 1 k i n σ i k a i k j i σ i j a i j j i where σ i j i j v is the weighted value the directional path is defined as a sequence of a series of edges i 1 i 2 i 2 i 3 in a directed graph g ν ε the node i is called the parent node if a directed edge is from node i to node j and the node j is the child node if all nodes except the root node with an in degree of 1 and the root node is a vertex with an in degree of 0 the directed tree is called a directed graph the spanning tree of a graph is defined as a directed tree in which all nodes are connected that means that if the topological graph has a spanning tree at least one vertex has a directed path leading to all nodes 2 2 the model of uuv the dynamic model of uuv has six degrees of freedom and the dynamics is established based on the body fixed coordinate and earth fixed coordinate since uuv s roll motion has less influence on lateral motion the roll velocity of uuv is ignored in this paper the nonlinear coupled continuous time dynamics of uuv is represented as 2 η j η v m v c v v d v v g η τ where vector η x y z θ ϕ t ℝ 5 represents the position and the euler angle state of uuv and vector v u v w q r t ℝ 5 represents the velocity state of uuv the jacobian transformation matrix j η j 1 η 1 0 0 j 2 η 2 converts body fixed coordinate to earth fixed coordinate the matrix j 1 η 1 and j 2 η 2 are defined as 3 j 1 η 1 cos ψ cos θ sin ψ cos ψ sin θ cos ψ sin ψ cos ψ sin ψ sin θ sin θ 0 cos ψ 4 j 2 η 2 1 0 0 1 cos θ the matrices m c v and d v represent the inertia matrix the coriolis centripetal matrix and the damping matrix respectively the vector g η represents force and moment caused by the effect of gravity and buoyancy τ is the control input of forces and moments the type of uuv is used torpedo type which means the structure is symmetrical in the horizontal and vertical planes so the inertia matrix is symmetric and the coriolis centripetal matrix is antisymmetric the center of gravity and buoyancy is designed to coincide with simplifying calculation which can be ignored the above parameters can be referred to fossen 1994 2011 the continuous time model of uuv is represented as 5 η v i 0 0 m 1 j η v w v v 0 m 1 γ ξ u τ to simplify equation 5 the model can be written as a second order affine form 6 ξ p ξ q ξ u τ μ r ξ where ξ η t v t t p ξ i 0 0 m 1 j η v w v v p i ξ t i 1 2 10 q ξ 0 m 1 γ ξ q i j ξ 10 10 i j 1 2 10 r ξ η lemma 1 as the nonlinear affine system of formula 12 if the system can be feedback linearized the following conditions must be satisfied 1 the input and output dimensions of the system are the same 2 the system has relative degree ρ 1 ρ 2 ρ p 3 the sum of relative order and the dimension of the system are the same combining equation 6 and using the properties of lie derivative we can find the matrix γ ξ expressed as follows 7 γ ξ l q i l p r j ξ q 6 1 cos ψ cos θ q 7 2 sin ψ q 8 3 cos ψ sin θ q 6 1 sin ψ cos θ q 7 2 cos ψ q 8 3 sin ψ sin θ q 6 1 sin θ 0 q 8 3 cos θ 0 0 q 9 3 0 q 10 2 cos θ 0 q 8 4 cos ψ sin θ q 7 5 sin ψ q 8 4 sin ψ sin θ q 7 5 cos ψ q 8 4 cos θ 0 q 9 4 0 0 q 10 5 cos θ the matrix γ ξ is nonsingular according to equation 7 the relative degree of the system is equal to ten which satisfies condition 3 in lemma 1 the dynamic model of uuv can be written as 8 x i v i v i u i where x i r i 1 ξ r i 2 ξ r i 3 ξ r i 4 ξ r i 5 ξ t ℝ 5 v i l p r i 1 ξ l p r i 2 ξ l p r i 3 ξ l p r i 4 ξ l p r i 5 ξ t ℝ 5 u i t ξ γ ξ u τ ℝ 5 t ξ l p 2 r 1 ξ l p 2 r 2 ξ l p 2 r 3 ξ l p 2 r 4 ξ l p 2 r 5 ξ t according to the above transformation steps the control framework of the coordination system is shown in fig 1 s i is define similarly in equation 10 x d is the desired path for the multi uuv system the specific description of the control framework can be found in yan et al 2019 section 3 1 2 3 basic definitions and lemmas definition 1 wolfowitz 1963 if a random matrix m ℝ n n has an eigenvalue λ 1 1 with the algebraic multiplicity is 1 and the absolute value of other eigenvalues of the random matrix is less than 1 λ i 1 then m is called the sia matrix the sia matrix has the following properties lim k m k 1 γ τ where γ ℝ n is the left eigenvector definition 2 all uuvs in the multi agent system converge to desired trajectory if the following equations are satisfied lim t x i t x d t 0 i v lim t v i t v d t 0 i v where x i t is the position of uuv x d t is the desired trajectory v i t is the velocity of uuv v d t is the velocity of virtual leader uuv definition 3 wang et al 1994 if each element in the matrix belongs to a certain interval the matrix is called an interval matrix and can be expressed as u i u min u max ℝ n n u i u u i j n n u i j min u i j u i j max where u min u i j min n n ℝ n n u max u i j max n n ℝ n n lemma 2 wolfowitz 1963 if the finite set s 1 s 2 s k is a set of sia matrices the matrix product of s i j s i j 1 s i 1 for each sequence s i 1 s i 2 s i j is also a sia matrix there will exist a vector γ τ which is satisfied lim j s i j s i j 1 s i 1 1 γ τ lemma 3 liao et al 1998 an interval matrix u i u min u max is schur stable if and only if the finitely subinterval matrices u i min u i max u min u max 1 i k satisfies the following conditions 1 φ δ u i φ δ u i 0 2 1 p i 1 2 φ u i 0 where φ u max u 1 u δ u i 1 2 u i max u i min u i 0 1 2 u i max u i min 2 u i 0 is schur stable and there exists a positive definite matrix p p t which is satisfied the equation u i 0 t p i u i 0 p i i 0 3 the subinterval matrices of u can be complete decomposition which means the interval matrix u u min u max can be decompose into u u i min u i max i 1 2 n where u min u max i 1 k u i min u i max 3 main result 3 1 path tracking controller with bounded communication time varying delay in general communication of uuvs is affected by the actual environment so the information cannot be transmitted to other uuvs in time which means the control input will delay as the information is sampled data the continuous time model needs to be transformed into a discrete time model using the direct discretization method the discrete time dynamics of uuv considered bounded the communication delay is represented as franklin et al 2001 9 x i k 1 x i k t v i k t τ i j k 2 2 u i k v i k 1 v i k t τ i j k u i k where i 1 2 n k is the discrete time index t is the sampling period τ i j k is the bounded communication delay which means that t τ i j k τ 0 τ 0 is positive constant x i k ℝ 5 v i k ℝ 5 respectively represent the vector of position and velocity of the i th uuv at t k t u i k ℝ 5 represents the control input based on zero order hold the path tracking controller based on virtual leader is designed as at t k t k 1 t 10 u i k β 1 j n i p σ i j k a i j k x i k x j k s i s j d i p k x i k x d k s i s d β 2 j n i p λ i j k b i j k v i k v j k d i v k v i k v d k where β 1 k 2 t τ i j k 2 α 1 k β 2 k 2 t τ i j k 2 α 2 k α 1 α 2 represent the gain of controller related to position and velocity of uuv respectively x d k represents the desired path which means it also represents the trajectory of the virtual leader v d k represents the velocity of the virtual leader s i is the position of uuvi in the multi uuv formation s d is the position of the virtual leader in the formation a i j k b i j k are the elements of adjacency matrix related to the position and velocity topology respectively d i p k d i v k are the elements of adjacency matrix related to the position and velocity topology between the virtual leader and the other uuv respectively σ i j t 0 λ i j t 0 represent weighting factors chosen form any finite sets the position vector and velocity vector relative with the virtual leader are defined as x ˆ i k x i k x d k s i s d and v ˆ i k v i k v d k to simplify the dynamic model of the multi uuv system the discrete time state of multiple uuv system is defined as 11 x t k x ˆ 1 k t x ˆ 2 k t x ˆ n k t v t k v ˆ 1 k t v ˆ 2 k t v ˆ n k t where x t k ℝ 5 n v t k ℝ 5 n define the matrix l l i j k ℝ n n where l i j k 2 t τ i j k l i j k i j l i j k j 1 j i n l i j k i j combining equations 9 and 10 the dynamic equation of multiple uuvs system can be defined as 12 x τ k 1 v τ k 1 i n i 5 l p d p α 1 i 5 t i n i 5 l v d v α 2 i 5 l p d p α 1 i 5 i n l v d v α 2 i 5 x τ k v τ k where l p l v are the laplacian matrices of the directed graph related with position and velocity of multiple uuv system at t k t k 1 t respectively d p and d v are the laplacian matrices of the directed graph of position and velocity between the virtual leader and each uuv in the multiple uuvs system at t k t k 1 t respectively denotes the kronecker product as equation 12 the matrix l is a time varying matrix however the structure of the laplacian matrix associated with communication topology which has a spanning tree is invariant therefore equation 12 can be simplified to the following form 13 x τ k 1 v τ k 1 i 5 n l p k α 1 t i 5 n l v k α 2 l p k α 1 i n 5 l v k α 2 x τ k v τ k where i 5 n i n i 5 l p k α p l p d p α 1 i 5 l v k α v l v d v α 2 i 5 l p k k 1 l p d p α 1 i 5 l v k k 2 l v d v α 2 i 5 after iteration the state equation of multiple uuvs system is represented as 14 x τ k 1 v τ k 1 n ˆ k x τ 0 v τ 0 n ˆ k 1 n ˆ k 2 n ˆ k 3 n ˆ k 4 x τ 0 v τ 0 where h ˆ k i 0 k h k according to the properties of the kronecker product the matrix n ˆ k can be represented as 15 n ˆ k h ˆ k 1 i 5 h ˆ k 2 i 5 h ˆ k 3 i 5 h ˆ k 4 i 5 h ˆ k 1 h ˆ k 2 h ˆ k 3 h ˆ k 4 i 5 where n k i h k i i 5 h ˆ k i 0 k h k h k 1 i n α 1 l p d p h k 2 t i n α 2 l v d v h k 3 α 1 l p d p h k 4 i n α 2 l v d v lemma 4 assume that the laplacian matrix l k is corresponding to communication graph g k which has a directed spanning tree and there exist α p α v and period t such that following conditions are satisfied 1 the matrix h k 1 t i n h k 4 t i n are non negative matrices with positive diagonal entries 2 the matrix h k 2 h k 3 t i n are non negative matrices 3 s 1 then all rows of h ˆ k i i 1 2 3 4 are same as k the detailed proofs are represented in ren 2010 lemma 5 if there exist parameters α p α v and period t and the matrix h ˆ k 1 h ˆ k 2 h ˆ k 3 h ˆ k 4 all have the same line as k then the multiple uuvs can converge to the desired trajectory proof combining equations 14 and 15 the multi uuv system can be represented as 16 x k 1 v k 1 h ˆ k 1 i 5 h ˆ k 2 i 5 h ˆ k 3 i 5 h ˆ k 4 i 5 x 0 v 0 h ˆ k 1 i 5 x 0 h ˆ k 2 i 5 v 0 h ˆ k 3 i 5 x 0 h ˆ k 4 i 5 v 0 let the matrix ψ i k h ˆ k i i 5 ℝ 5 n 5 n i 1 2 3 4 as ψ i k ψ 1 i t ψ 2 i t ψ 5 n i t t where ψ s i t ℝ 1 5 n if all rows of the matrix h ˆ k i are the same when k then 17 ψ s i k ψ l i k where l s 5 l s 1 2 5 n i 1 2 3 4 so the state vectors in equation 11 can be represented as 18 x ˆ 1 k 1 x ˆ 2 k 1 x ˆ n k 1 v ˆ 1 k 1 v ˆ 2 k 1 v ˆ n k 1 as k we can have 19 x 1 k s 1 x 2 k s 2 x n k s n x d k v 1 k v 2 k v n k v d k according to definition 2 the uuvs in the multi agent system can all converge to desired trajectory the lemma has been proved theorem 1 assume that the directed graph associated with the multiple uuv system has a directed spanning tree the parameters α p α v and period t satisfy the conditions as following then each uuv in the multi uuv system can converge to the desired path 1 α 1 t τ 0 2 d p max 1 α 2 1 t τ 0 2 d v max 1 2 t 1 2 proof define the system matrix m k at t k as 20 m k i 5 n l p k α 1 t i 5 n l v k α 2 l p k α 1 i n 5 l v k α 2 if each uuv in the multi uuv system converge to the desired path all rows of the matrices m ˆ k 1 m ˆ k 2 m ˆ k 3 and m ˆ k 4 must be the same at k 21 m k m k 1 m 0 m ˆ k 1 m ˆ k 2 m ˆ k 3 m ˆ k 4 according to lemma 5 the above conditions are equivalently satisfied if all rows of the matrices h k 1 m h k 2 m h k 3 m and h k 4 m are the same 22 h m k h m k 1 h m 0 h ˆ k 1 m h ˆ k 2 m h ˆ k 3 m h ˆ k 4 m where 23 h m k h k 1 m h k 2 m h k 3 m h k 4 m i n α 1 l p k t i n α 2 l v k α 1 l p k i n α 2 l v k decompose the matrix h m k to two matrices r m k and s as 24 h m k r m k s where r m k i 5 n l p k α 1 t i n t i 5 n l v k α 2 t i n l p k α 1 i n 5 l v k α 2 t i n h k 1 m t i n h k 2 m h k 3 m t i n h k 4 m t i n s t i n 0 t i n t i n the infinite norm of the matrix s is less than 1 based on the condition 2 in the theorem as the definition of l k the largest in degree d max of l k can satisfy d max τ 0 d max 1 2 so the condition 1 is satisfied and the conditions 1 2 in lemma 4 can be satisfied therefore if the directed graph of the multiple uuvs system has a directed spanning tree each matrix r m k is sia combining the lemma 2 there exists a vector γ that 25 r m k r m k 1 r m 0 1 γ τ τ k by combining lemma 4 the theorem can be proved 3 2 path tracking controller with communic ation packet losses when the underwater environment becomes extreme or the formation distance of uuvs is getting farther the information exchange between each uuvs will be seriously affected it will cause communication packet losses therefore we need to discuss the issue of formation control in this situation since the uuv s information is digitally sampled the delay can be quantized and expressed as a multiple of the sampling period several assumptions are given as follows assumption 1 ghabcheloo et al 2009 the communication delays can be quantized and must be a multiple of the fundamental delay time φ which is a small positive value so the delay τ i j k can be represented as 26 τ i j k q φ where i j 0 1 2 n k ℝ assumption 2 the communication delay τ i j k is satisfied t τ i j k τ 0 at a ratio p which is the success ratio of communication between uuvs definition 4 if the communication between uuvs fails that means the information between uuvs is not received and not satisfied t τ i j k τ 0 then the communication delay τ i j k is called packet losses for any ε 0 1 there exists an integer h which satisfies 1 1 p h ε if ε is close to 1 enough it means that communication is successful at least one time during h periods assumption 3 the multiple uuvs system have a spanning tree for the union of the communication topologies in n q periods in order to reduce the communication pressure the communication topology of multiple uuvs system in this article is a structure with the in degree of 1 and also the same in the two situations which means each uuv only receives information from one vehicle there is communication between uuvi and uuvj uuvj can receive uuvi s information in the multiple uuvs system assume that the communication in the interval k k 1 is successful according to assumption 1 and assumption 2 there is a positive integer n s that satisfies 1 n s n q and uuvi successfully receives the information of uuvj in k n s 1 k n s defined τ j i k s as the communication delay during the period k n s 1 k n s since the multiple uuvs system s communication in degree is 1 the control input of uuvj in the interval k n s 1 k n s is 27 u j i k υ 1 c j i k x i k x j k s i s j υ 2 c i j k v i k v j k where υ 1 and υ 2 are controller gain c j i k equals to 0 if t k n s 1 t t k n s 1 τ j i k s c j i k 1 at t k n s 1 τ j i k s t t k n s otherwise let υ 1 k s 1 t τ j i k s α 1 k and υ 2 k s 1 t τ j i k s α 2 k at the interval k k n s define t s 1 n s 1 t then the discrete dynamic equations of uuvi and uuvj can be expressed as follows 28 x i k n s i 5 x i k n s t i 5 v i k v i k n s i 5 v i k x j k n s υ 1 k s i 5 x i k 1 υ 1 k s i 5 x j k υ 2 k s t i 5 v i k n s t υ 2 k s t s i 5 v j k v j k n s i 5 x i k i 5 x j k t s i 5 v i k 2 t s i 5 v j k define the discrete equation of the state deviation between uuvi and uuvj at time k and k n s as 29 x i j e d 1 1 υ 1 k s i 5 x i j e d n s t υ 2 k s t s i 5 v i j e d v i j e d 1 i 5 x i j e d 2 t s i 5 v i j e d where x i j e d x j k x i k v i j e d v j k v i k indicate the status error d is the number of successful communications theorem 2 if the assumption 2 holds and the discrete equation 29 is stable then each uuv in the multi uuvs system can converge to the desired path in the case of communication packet loss proof set the communication information that is tranferred from uuv i to uuv j if the multi uuv error system 29 is stable 30 lim d x i j d 0 lim d v i j d 0 where j n i n i n i is the set of uuv that can receive uuv i s information according to equation 30 there exist an integer d i j and an arbitrary small positive number ε i j and when d d i j we have 31 x i j d 1 ε i j v i j d 1 ε i j set d i max d i j ε i min ε i j j n i when d d i such that 32 x i j d 1 ε i v i j d 1 ε i when ε i is small enough u j i k 0 similar to the above analysis for arbitrary p n j there exists d d j such that 33 x j p d 1 ε j v j p d 1 ε j combining the equations 32 and 33 when d max d i d j yields 34 x j p d 1 ε i ε j v j p d 1 ε i ε j therefore the state deviation between uuv i and uuv p in the multiple uuvs system can also be arbitrarily small the status of any vehicle in a multiple uuvs system can be consensus that means each uuv in the multi uuvs system can converge to the desired path the state matrix of the state deviation equation of the system 29 can be expressed as s n s i 5 where s n s is represented as follows 35 s n s 1 υ 1 k s n s t υ 2 k s t s 1 2 t s 1 t τ j i k s 2 n s t t τ j i k s 2 1 n s 1 t 1 1 n s 1 t according to the properties of the kronecker product if s n s is schur stable then s n s i 5 is also stable for each fixed n s n 1 2 n q the interval matrix s n s min n s max n is expressed as an interval matrix 36 s min n 1 t 2 n t t 2 1 n 1 t 1 1 n 1 t s max n 1 τ 0 2 n t τ 0 2 1 n 1 t 1 1 n 1 t when n is a fixed value we can use lemma 3 to determine the schur stability of the interval matrix s n however n is a variable we need to judge the schur stability of the interval matrix s n according to the following lemma lemma 6 for the discrete system shown in equation 29 if the interval matrix of equation 36 is schur stable for each fixed n s 1 2 n q the discrete system is schur stable proof according to lemma 3 if 35 is schur stable for arbitrary n s n 1 2 n q then there are finite subinterval matrices that can be completely decomposed by their subintervals 37 s n s s min n s max n n 1 n q s min n s max n then it can be derived as 38 n 1 n q s min n s max n i 1 k 1 s min 1 i s max 1 i i 1 k 2 s min 2 i s max 2 i i 1 k n q s min n q i s max n q i for arbitrary n 1 2 n q every subinterval matrix s min n i s min n i i 1 2 k n q satisfies the condition of lemma 3 so the matrix s n s can be completely decomposed into a finite number of subinterval matrices each subinterval matrix satisfies the conditions of lemma 3 that is when the matrix is schur stable the system matrix is also stable to schur lemma 7 zhang et al 2006 for the discrete system shown in 39 let f ℝ n n d ℝ n m if and only if there exist a matrix w ℝ m n and a symmetric positive definite matrix v ℝ n n and scalars ω i j 0 i j 1 2 n ν i j 0 i 1 2 n j 1 2 m satisfy the inequality of formula 40 the system is stable and its control rate is k wv 1 39 x k 1 f min f max x k d min d max u k u k k x k 40 v v f 0 t w t d 0 t v d w d f 0 v d 0 w v σ 0 0 v d t 0 λ w d t 0 δ 0 where the matrix λ is a diagonal matrix composed of elements ω i j the matrix δ is a diagonal matrix composed of elements v ij and the definitions of matrix f 0 d 0 are consistent with lemma 3 matrix v d v v n w d w w n matrix σ i j 1 n ω i j δ f i j 2 e i e i t i 1 n j 1 m ν i j δ d i j 2 e i e i t lemma 8 for the interval system matrix f min f max d min d max of 39 if there exists the matrix w and v that make the finite number of subinterval system matrices f min i f max i d min i d max i 1 i k satisfy the conditions of lemma 7 and the interval system matrix can be completely decomposed which means that if d t d min i d max i then f t f min i f max i 1 i k at any time instant t the interval system matrix is stable the complete decomposition can be denoted as 41 f min f max i 1 k f min i f max i d min d max i 1 k d min i d max i proof since the subinterval matrix f min i f max i and d min i d max i is stable the feedback control gain k wv 1 is used for i 1 2 k according to lemma 7 the interval matrix f min i f max i d min i d max i k is stable therefore the interval system 67 is stable represent multiple uuvs system as follows 42 x i k v i k m i 5 x i k v i k n i 5 u i k where m 0 1 0 0 n 0 1 the controller adopts the structure of 10 and k α 1 α 2 i 5 theorem 3 if multiple uuvs system satisfy assumption 1 2 and there is a control gain k can make f n d n k satisfy lemma 7 for each n 1 2 n q multiple uuv systems can be schur stable under the condition that packet loss exists in the communication proof for the system 42 the interval system matrix in lemma 7 can be expressed as 43 f min f max e n m t d min d max e n 1 n t 0 t τ i j k s e m t n d t where n 1 2 n q since f n d n k satisfies the lemma 7 the system 43 is stable that means the multiple uuvs system 42 is also stable therefore according to theorem 3 we can use the condition of matrix inequality in lemma 7 to calculate the controller parameters α 1 and α 2 to ensure the multiple uuv system schur stable that means each uuv in the multi uuvs system can converge to the desired path 4 simulation the simulation experiments are divided into two parts to prove the correctness of the path tracking controller proposed under the cases of bounded communication delay and packet losses in this section the topology structures of position and velocity in this paper are the same which is presented in fig 2 the underlying graph is connected and static the dashed line with an arrow means the transformation direction of the information between two vehicles that means the communication graph is directed according to fig 2 the adjacency matrix of the followers in the multi uuv system is given as follows a 0 0 1 1 0 0 0 0 0 0 0 0 1 1 0 0 1 0 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 the first case is that the information exchange between multiple uuvs has bounded time delay the initial value of x i 0 is distributed in the interval 90 100 randomly y i 0 and z i 0 are distributed in the interval 0 10 and 10 0 randomly i 0 1 8 θ i 0 and ψ i 0 of the followers uuvs are in the interval 0 06 π 0 06 π and 0 π respectively u i 0 i 1 8 takes form the interval 0 0 5 randomly the velocity of virtual leader takes 0 6 m s and other initial values of the multiple uuvs system are zero the path tracking controller s parameters are chosen as α 1 0 024 α 2 0 87 and τ 0 0 1 s t 0 5 s each vehicle in the multiple uuvs system is distributed over 8 vertices of a cube with side length 20 the positions of each uuv are coordinates s 1 20 20 20 0 0 s 2 20 20 20 0 0 s 3 20 20 20 0 0 s 4 20 20 20 0 0 s 5 20 20 20 0 0 s 6 20 20 20 0 0 s 7 20 20 20 0 0 s 5 20 20 20 0 0 the desired path is a helical curve and it expressed as x t 100 cos 0 01 π t y t 100 sin 0 01 π t z t 0 056 t figs 3 5 show the position of multi uuv in longitudinal transverse and vertical direction each uuv can track the desired path in the fixed formation designed in the simulation figs 6 7 show that the attitude states of all uuvs θ and ψ can converge to a fixed value the velocity states of multi uuv are shown in fig 8 12 where u i for each i 1 8 can converge to the velocity of the virtual leader and the other velocity v k w k q k r k of each uuv can also converge to a fixed value that guarantees the path tracking mission in fig 13 the three dimensional trajectories of the multiple uuvs system show that all uuvs can keep the formation in 8 vertices of a cube and track the desired path the second case is that the information exchanged under the situation of communication packet losses the simulation curve and the initial value of multiple uuvs are the same as the first case the path tracking controller s parameters are also chosen the same value in the first simulation the position and attitude states of multiple uuvs can also converge but it takes more time to stabilization comparing with the first case in fig 14 18 the position states converge to the desired helical curve and the attitude states converge to a fixed value the states of velocity u q r shown in fig 19 22 and 23 all converge to a fixed value over 500 s and the curves have larger overshoot value compared with the first case fig 20 shows that the velocity v converges to the velocity of the virtual leader but the value is chattering at the desired value and the state w has less chattering in fig 21 fig 24 shows the multiple uuvs system can follow the desired curve and stay in the formation with a random initial value in the situation of packet losses 5 conclusions the path tracking controller based on a virtual leader for multi uuv under sampled data delays and packet losses is designed for that purpose we transfer the continuous time nonlinear model of uuv into a discrete time model we analyze the sufficient conditions for the controller under the case of bounded communication delay by using the matrix theory then the consistency under the conditions of packet loss is proved by the shuler theory and the conditions for the convergence of multi uuv path tracking are given in the last part the simulation proves the effectiveness of the path tracking controller proposed in this paper each uuv in the multi uuv system can converge to the desired trajectories in a specified formation position the designed controller in this paper can also be applied under switching topologies condition which is proved in our future work not only that our future work is also focusing on uncertainties in communication such as mutual interference of communication information asynchronous information therefore we need to design a more robust controller as the accurate nonlinear dynamics of the uuv is difficult to obtain we also consider the uncertainty problem in the model transformation credit authorship contribution statement zheping yan formal analysis analysis and or interpretation of data zewen yang conceptualization writing original draft conception and design of study revising the manuscript critically for important intellectual content xiaoli pan funding acquisition acquisition of data jiajia zhou writing original draft drafting the manuscript di wu conceptualization conception and design of study declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
21499,the multi uuv unmanned underwater vehicle path tracking control methods in the cases of communication delay and packet loss under sampled data discrete time collection are studied in this paper respectively firstly the second order affine form of uuv s nonlinear dynamic equations is given and by using feedback linearization and direct discretization method the motion equations are transformed to sampled discrete time dynamics secondly the path tracking controllers of multi uuv based on the virtual leader are proposed in two cases the sufficient conditions for the convergence of multi uuv path tracking are given and analyzed by using the matrix theory and shuler theory respectively finally the simulation experiments are presented to prove the effectiveness of the controller each uuv in the multi uuv system can track the desired trajectories in the expected formation keywords multi uuv path tracking sampled data communication delay packet losses 1 introduction in recent years as the advantages of flexible delivery and lower cost uuvs are used in various underwater exploration investigation observation or other tasks yuh 2000 sariel et al 2008 repoulias and papadopoulos 2007 the path tracking ability of multiple uuvs is an important technical prerequisite for underwater tasks such as surveying and searching uuvs use their sensors to collect the data of status information and by using the results of the designed controller which input into the executing agency to complete the specified complex tasks however when the search and detection area becomes larger one single uuv cannot complete the mission quickly because of its physical limits fiorelli et al 2004 zhu et al 2013 the status information between each vehicle exchange through sonars all vehicles in the multi uuv system by using the path tracking controller designed in this paper after receive the position and velocity of other uuvs can achieve accurate path tracking the information transmitted by the sonar may be affected in the situation of communication delay and packet losses it means instant messaging cannot be satisfied therefore to guarantee that the multiple uuvs keep the formation and track the desired path in the extreme underwater environment the path tracking control method for the multi uuv system under sampled data delays and packet losses conditions needs to be studied the early literature and researches are devoted to studying path tracking and trajectory tracking guo et al 2003 li and pan 2005 lapierre and soetanto 2007 ghommam and saad 2014 joe et al 2014 in which the research subject is almost about single uuv however the missions of multiple uuvs cannot be accomplished by using the above control methods vicsek model vicsek et al 1995 may be the first model studied in the multi agent system each agent obtains its neighbors information to keep the same heading and the literature jadbabaie et al 2003 gives a theoretical explanation then the theoretical study of the multi agent system for a single integration system emerged and the proposed cooperative controller can guarantee the consensus of agents under different communication conditions hatano and mesbahi 2005 porfiri and stilwell 2007 huang 2010 in order to improve the usability of consensus control of complex systems the double integrator dynamics model can solve the practical control problems of multiple agents zhang and tian 2009 hu and lin 2010 peng et al 2015 there are some researches about the path tracking problem in multiple agents jia et al 2007 sabattini et al 2013 to solve the tracking problem in the multi uuv system some different approaches are adopted to complete tracking missions in many past works such as distributed adaptive control neural network approximation distributed formation learning control qi 2014 zhao et al 2017a 2017b yuan et al 2017 and so on the information sent by sonars is sampled data so the continuous time based control methods may not be applied well in the discrete time condition cui et al 2010 hu et al 2015 chen and ho 2016 lots of current research has focused on the consensus of multi agent under the time delay condition papachristodoulou et al 2010 yu and wang 2010 wang et al 2015 zhu and jiang 2015 the control input will be affected if the information is not received in time caused by environmental disturbances therefore we need to study the path tracking control method for the multi uuv under sampled data delays and packet losses conditions as the information of transmission data is not continuous data the continuous time model of uuv must be transformed to a discrete time model therefore the sampled discrete time dynamics is given using the second order affine form of uuv s nonlinear dynamic model which is transformed by feedback linearization method the information of position and velocity is transmitted independently the purpose is to reduce the data volume for every exchange of communication the position and velocity of each uuv are calculated by using the designed controller and transmitted to the other uuvs then the driving force and torque of actuators can actuate the uuvs to complete the tracking mission which are obtained combing the dynamic equations the contribution of this paper is virtual leader based path tracking control laws under the conditions of communication delay and packet losses in the previous work yan et al 2019 the results for coordinated control of leader following multiple auvs under switching topologies and communication delays are presented however when the communication conditions become extreme such as communication distance becomes longer agents may not receive the information for some time so the communication packet losses will exist in the multi agent system this paper extends the work by designing the controllers considering the sampled data delays and communication packet losses in a fixed communication structure the proposed controller is also suitable under switching topologies which is proved in our future work for this purpose the discrete time dynamic equations of the multi uuv system are proposed afterward combing with graph theory the controllers are designed the derived method guarantees the tracking trajectories and velocity of uuvs in the multi agent system converge to the desired value the following sections are arranged as follows the dynamics of the uuv based on the body fixed coordinate and earth fixed coordinate is established in sections ⅱ in section ⅲ path tracking controllers based on the virtual leader are proposed in two cases for the first case of bounded delay sufficient conditions are given and analyzed using the matrix theory for the other case of packet losses the shuler theory is used to prove the consistency and the conditions for the convergence of multi uuv path tracking are given the simulation experiments are designed to illustrate the effectiveness of the controller in section ⅳ finally the conclusions are drawn in section ⅴ 2 preliminaries and problem formulation 2 1 graph theory notions communication topologies are one of the important techniques to describe the transformation information between each uuv if n is the number of agents in the multi agent system the directed graph can be represented as g v e the set of points v 1 2 n and the set of edges e i j i j v v v represent the number of vertices and form of information transmitted from the nodes to the nodes respectively the set of points n i j ν is defined as the set of neighbor nodes near the node i where i j e the elements of adjacency matrix a a i j r n n are denoted as a i j 1 and a i i 0 otherwise when i j e the in degree matrix d d i a g d 1 d 2 d i is denoted as d i j 1 n a i j represents the in degree of the node in the communication topology the weighted laplacian matrix is defined as 1 l i j k 1 k i n σ i k a i k j i σ i j a i j j i where σ i j i j v is the weighted value the directional path is defined as a sequence of a series of edges i 1 i 2 i 2 i 3 in a directed graph g ν ε the node i is called the parent node if a directed edge is from node i to node j and the node j is the child node if all nodes except the root node with an in degree of 1 and the root node is a vertex with an in degree of 0 the directed tree is called a directed graph the spanning tree of a graph is defined as a directed tree in which all nodes are connected that means that if the topological graph has a spanning tree at least one vertex has a directed path leading to all nodes 2 2 the model of uuv the dynamic model of uuv has six degrees of freedom and the dynamics is established based on the body fixed coordinate and earth fixed coordinate since uuv s roll motion has less influence on lateral motion the roll velocity of uuv is ignored in this paper the nonlinear coupled continuous time dynamics of uuv is represented as 2 η j η v m v c v v d v v g η τ where vector η x y z θ ϕ t ℝ 5 represents the position and the euler angle state of uuv and vector v u v w q r t ℝ 5 represents the velocity state of uuv the jacobian transformation matrix j η j 1 η 1 0 0 j 2 η 2 converts body fixed coordinate to earth fixed coordinate the matrix j 1 η 1 and j 2 η 2 are defined as 3 j 1 η 1 cos ψ cos θ sin ψ cos ψ sin θ cos ψ sin ψ cos ψ sin ψ sin θ sin θ 0 cos ψ 4 j 2 η 2 1 0 0 1 cos θ the matrices m c v and d v represent the inertia matrix the coriolis centripetal matrix and the damping matrix respectively the vector g η represents force and moment caused by the effect of gravity and buoyancy τ is the control input of forces and moments the type of uuv is used torpedo type which means the structure is symmetrical in the horizontal and vertical planes so the inertia matrix is symmetric and the coriolis centripetal matrix is antisymmetric the center of gravity and buoyancy is designed to coincide with simplifying calculation which can be ignored the above parameters can be referred to fossen 1994 2011 the continuous time model of uuv is represented as 5 η v i 0 0 m 1 j η v w v v 0 m 1 γ ξ u τ to simplify equation 5 the model can be written as a second order affine form 6 ξ p ξ q ξ u τ μ r ξ where ξ η t v t t p ξ i 0 0 m 1 j η v w v v p i ξ t i 1 2 10 q ξ 0 m 1 γ ξ q i j ξ 10 10 i j 1 2 10 r ξ η lemma 1 as the nonlinear affine system of formula 12 if the system can be feedback linearized the following conditions must be satisfied 1 the input and output dimensions of the system are the same 2 the system has relative degree ρ 1 ρ 2 ρ p 3 the sum of relative order and the dimension of the system are the same combining equation 6 and using the properties of lie derivative we can find the matrix γ ξ expressed as follows 7 γ ξ l q i l p r j ξ q 6 1 cos ψ cos θ q 7 2 sin ψ q 8 3 cos ψ sin θ q 6 1 sin ψ cos θ q 7 2 cos ψ q 8 3 sin ψ sin θ q 6 1 sin θ 0 q 8 3 cos θ 0 0 q 9 3 0 q 10 2 cos θ 0 q 8 4 cos ψ sin θ q 7 5 sin ψ q 8 4 sin ψ sin θ q 7 5 cos ψ q 8 4 cos θ 0 q 9 4 0 0 q 10 5 cos θ the matrix γ ξ is nonsingular according to equation 7 the relative degree of the system is equal to ten which satisfies condition 3 in lemma 1 the dynamic model of uuv can be written as 8 x i v i v i u i where x i r i 1 ξ r i 2 ξ r i 3 ξ r i 4 ξ r i 5 ξ t ℝ 5 v i l p r i 1 ξ l p r i 2 ξ l p r i 3 ξ l p r i 4 ξ l p r i 5 ξ t ℝ 5 u i t ξ γ ξ u τ ℝ 5 t ξ l p 2 r 1 ξ l p 2 r 2 ξ l p 2 r 3 ξ l p 2 r 4 ξ l p 2 r 5 ξ t according to the above transformation steps the control framework of the coordination system is shown in fig 1 s i is define similarly in equation 10 x d is the desired path for the multi uuv system the specific description of the control framework can be found in yan et al 2019 section 3 1 2 3 basic definitions and lemmas definition 1 wolfowitz 1963 if a random matrix m ℝ n n has an eigenvalue λ 1 1 with the algebraic multiplicity is 1 and the absolute value of other eigenvalues of the random matrix is less than 1 λ i 1 then m is called the sia matrix the sia matrix has the following properties lim k m k 1 γ τ where γ ℝ n is the left eigenvector definition 2 all uuvs in the multi agent system converge to desired trajectory if the following equations are satisfied lim t x i t x d t 0 i v lim t v i t v d t 0 i v where x i t is the position of uuv x d t is the desired trajectory v i t is the velocity of uuv v d t is the velocity of virtual leader uuv definition 3 wang et al 1994 if each element in the matrix belongs to a certain interval the matrix is called an interval matrix and can be expressed as u i u min u max ℝ n n u i u u i j n n u i j min u i j u i j max where u min u i j min n n ℝ n n u max u i j max n n ℝ n n lemma 2 wolfowitz 1963 if the finite set s 1 s 2 s k is a set of sia matrices the matrix product of s i j s i j 1 s i 1 for each sequence s i 1 s i 2 s i j is also a sia matrix there will exist a vector γ τ which is satisfied lim j s i j s i j 1 s i 1 1 γ τ lemma 3 liao et al 1998 an interval matrix u i u min u max is schur stable if and only if the finitely subinterval matrices u i min u i max u min u max 1 i k satisfies the following conditions 1 φ δ u i φ δ u i 0 2 1 p i 1 2 φ u i 0 where φ u max u 1 u δ u i 1 2 u i max u i min u i 0 1 2 u i max u i min 2 u i 0 is schur stable and there exists a positive definite matrix p p t which is satisfied the equation u i 0 t p i u i 0 p i i 0 3 the subinterval matrices of u can be complete decomposition which means the interval matrix u u min u max can be decompose into u u i min u i max i 1 2 n where u min u max i 1 k u i min u i max 3 main result 3 1 path tracking controller with bounded communication time varying delay in general communication of uuvs is affected by the actual environment so the information cannot be transmitted to other uuvs in time which means the control input will delay as the information is sampled data the continuous time model needs to be transformed into a discrete time model using the direct discretization method the discrete time dynamics of uuv considered bounded the communication delay is represented as franklin et al 2001 9 x i k 1 x i k t v i k t τ i j k 2 2 u i k v i k 1 v i k t τ i j k u i k where i 1 2 n k is the discrete time index t is the sampling period τ i j k is the bounded communication delay which means that t τ i j k τ 0 τ 0 is positive constant x i k ℝ 5 v i k ℝ 5 respectively represent the vector of position and velocity of the i th uuv at t k t u i k ℝ 5 represents the control input based on zero order hold the path tracking controller based on virtual leader is designed as at t k t k 1 t 10 u i k β 1 j n i p σ i j k a i j k x i k x j k s i s j d i p k x i k x d k s i s d β 2 j n i p λ i j k b i j k v i k v j k d i v k v i k v d k where β 1 k 2 t τ i j k 2 α 1 k β 2 k 2 t τ i j k 2 α 2 k α 1 α 2 represent the gain of controller related to position and velocity of uuv respectively x d k represents the desired path which means it also represents the trajectory of the virtual leader v d k represents the velocity of the virtual leader s i is the position of uuvi in the multi uuv formation s d is the position of the virtual leader in the formation a i j k b i j k are the elements of adjacency matrix related to the position and velocity topology respectively d i p k d i v k are the elements of adjacency matrix related to the position and velocity topology between the virtual leader and the other uuv respectively σ i j t 0 λ i j t 0 represent weighting factors chosen form any finite sets the position vector and velocity vector relative with the virtual leader are defined as x ˆ i k x i k x d k s i s d and v ˆ i k v i k v d k to simplify the dynamic model of the multi uuv system the discrete time state of multiple uuv system is defined as 11 x t k x ˆ 1 k t x ˆ 2 k t x ˆ n k t v t k v ˆ 1 k t v ˆ 2 k t v ˆ n k t where x t k ℝ 5 n v t k ℝ 5 n define the matrix l l i j k ℝ n n where l i j k 2 t τ i j k l i j k i j l i j k j 1 j i n l i j k i j combining equations 9 and 10 the dynamic equation of multiple uuvs system can be defined as 12 x τ k 1 v τ k 1 i n i 5 l p d p α 1 i 5 t i n i 5 l v d v α 2 i 5 l p d p α 1 i 5 i n l v d v α 2 i 5 x τ k v τ k where l p l v are the laplacian matrices of the directed graph related with position and velocity of multiple uuv system at t k t k 1 t respectively d p and d v are the laplacian matrices of the directed graph of position and velocity between the virtual leader and each uuv in the multiple uuvs system at t k t k 1 t respectively denotes the kronecker product as equation 12 the matrix l is a time varying matrix however the structure of the laplacian matrix associated with communication topology which has a spanning tree is invariant therefore equation 12 can be simplified to the following form 13 x τ k 1 v τ k 1 i 5 n l p k α 1 t i 5 n l v k α 2 l p k α 1 i n 5 l v k α 2 x τ k v τ k where i 5 n i n i 5 l p k α p l p d p α 1 i 5 l v k α v l v d v α 2 i 5 l p k k 1 l p d p α 1 i 5 l v k k 2 l v d v α 2 i 5 after iteration the state equation of multiple uuvs system is represented as 14 x τ k 1 v τ k 1 n ˆ k x τ 0 v τ 0 n ˆ k 1 n ˆ k 2 n ˆ k 3 n ˆ k 4 x τ 0 v τ 0 where h ˆ k i 0 k h k according to the properties of the kronecker product the matrix n ˆ k can be represented as 15 n ˆ k h ˆ k 1 i 5 h ˆ k 2 i 5 h ˆ k 3 i 5 h ˆ k 4 i 5 h ˆ k 1 h ˆ k 2 h ˆ k 3 h ˆ k 4 i 5 where n k i h k i i 5 h ˆ k i 0 k h k h k 1 i n α 1 l p d p h k 2 t i n α 2 l v d v h k 3 α 1 l p d p h k 4 i n α 2 l v d v lemma 4 assume that the laplacian matrix l k is corresponding to communication graph g k which has a directed spanning tree and there exist α p α v and period t such that following conditions are satisfied 1 the matrix h k 1 t i n h k 4 t i n are non negative matrices with positive diagonal entries 2 the matrix h k 2 h k 3 t i n are non negative matrices 3 s 1 then all rows of h ˆ k i i 1 2 3 4 are same as k the detailed proofs are represented in ren 2010 lemma 5 if there exist parameters α p α v and period t and the matrix h ˆ k 1 h ˆ k 2 h ˆ k 3 h ˆ k 4 all have the same line as k then the multiple uuvs can converge to the desired trajectory proof combining equations 14 and 15 the multi uuv system can be represented as 16 x k 1 v k 1 h ˆ k 1 i 5 h ˆ k 2 i 5 h ˆ k 3 i 5 h ˆ k 4 i 5 x 0 v 0 h ˆ k 1 i 5 x 0 h ˆ k 2 i 5 v 0 h ˆ k 3 i 5 x 0 h ˆ k 4 i 5 v 0 let the matrix ψ i k h ˆ k i i 5 ℝ 5 n 5 n i 1 2 3 4 as ψ i k ψ 1 i t ψ 2 i t ψ 5 n i t t where ψ s i t ℝ 1 5 n if all rows of the matrix h ˆ k i are the same when k then 17 ψ s i k ψ l i k where l s 5 l s 1 2 5 n i 1 2 3 4 so the state vectors in equation 11 can be represented as 18 x ˆ 1 k 1 x ˆ 2 k 1 x ˆ n k 1 v ˆ 1 k 1 v ˆ 2 k 1 v ˆ n k 1 as k we can have 19 x 1 k s 1 x 2 k s 2 x n k s n x d k v 1 k v 2 k v n k v d k according to definition 2 the uuvs in the multi agent system can all converge to desired trajectory the lemma has been proved theorem 1 assume that the directed graph associated with the multiple uuv system has a directed spanning tree the parameters α p α v and period t satisfy the conditions as following then each uuv in the multi uuv system can converge to the desired path 1 α 1 t τ 0 2 d p max 1 α 2 1 t τ 0 2 d v max 1 2 t 1 2 proof define the system matrix m k at t k as 20 m k i 5 n l p k α 1 t i 5 n l v k α 2 l p k α 1 i n 5 l v k α 2 if each uuv in the multi uuv system converge to the desired path all rows of the matrices m ˆ k 1 m ˆ k 2 m ˆ k 3 and m ˆ k 4 must be the same at k 21 m k m k 1 m 0 m ˆ k 1 m ˆ k 2 m ˆ k 3 m ˆ k 4 according to lemma 5 the above conditions are equivalently satisfied if all rows of the matrices h k 1 m h k 2 m h k 3 m and h k 4 m are the same 22 h m k h m k 1 h m 0 h ˆ k 1 m h ˆ k 2 m h ˆ k 3 m h ˆ k 4 m where 23 h m k h k 1 m h k 2 m h k 3 m h k 4 m i n α 1 l p k t i n α 2 l v k α 1 l p k i n α 2 l v k decompose the matrix h m k to two matrices r m k and s as 24 h m k r m k s where r m k i 5 n l p k α 1 t i n t i 5 n l v k α 2 t i n l p k α 1 i n 5 l v k α 2 t i n h k 1 m t i n h k 2 m h k 3 m t i n h k 4 m t i n s t i n 0 t i n t i n the infinite norm of the matrix s is less than 1 based on the condition 2 in the theorem as the definition of l k the largest in degree d max of l k can satisfy d max τ 0 d max 1 2 so the condition 1 is satisfied and the conditions 1 2 in lemma 4 can be satisfied therefore if the directed graph of the multiple uuvs system has a directed spanning tree each matrix r m k is sia combining the lemma 2 there exists a vector γ that 25 r m k r m k 1 r m 0 1 γ τ τ k by combining lemma 4 the theorem can be proved 3 2 path tracking controller with communic ation packet losses when the underwater environment becomes extreme or the formation distance of uuvs is getting farther the information exchange between each uuvs will be seriously affected it will cause communication packet losses therefore we need to discuss the issue of formation control in this situation since the uuv s information is digitally sampled the delay can be quantized and expressed as a multiple of the sampling period several assumptions are given as follows assumption 1 ghabcheloo et al 2009 the communication delays can be quantized and must be a multiple of the fundamental delay time φ which is a small positive value so the delay τ i j k can be represented as 26 τ i j k q φ where i j 0 1 2 n k ℝ assumption 2 the communication delay τ i j k is satisfied t τ i j k τ 0 at a ratio p which is the success ratio of communication between uuvs definition 4 if the communication between uuvs fails that means the information between uuvs is not received and not satisfied t τ i j k τ 0 then the communication delay τ i j k is called packet losses for any ε 0 1 there exists an integer h which satisfies 1 1 p h ε if ε is close to 1 enough it means that communication is successful at least one time during h periods assumption 3 the multiple uuvs system have a spanning tree for the union of the communication topologies in n q periods in order to reduce the communication pressure the communication topology of multiple uuvs system in this article is a structure with the in degree of 1 and also the same in the two situations which means each uuv only receives information from one vehicle there is communication between uuvi and uuvj uuvj can receive uuvi s information in the multiple uuvs system assume that the communication in the interval k k 1 is successful according to assumption 1 and assumption 2 there is a positive integer n s that satisfies 1 n s n q and uuvi successfully receives the information of uuvj in k n s 1 k n s defined τ j i k s as the communication delay during the period k n s 1 k n s since the multiple uuvs system s communication in degree is 1 the control input of uuvj in the interval k n s 1 k n s is 27 u j i k υ 1 c j i k x i k x j k s i s j υ 2 c i j k v i k v j k where υ 1 and υ 2 are controller gain c j i k equals to 0 if t k n s 1 t t k n s 1 τ j i k s c j i k 1 at t k n s 1 τ j i k s t t k n s otherwise let υ 1 k s 1 t τ j i k s α 1 k and υ 2 k s 1 t τ j i k s α 2 k at the interval k k n s define t s 1 n s 1 t then the discrete dynamic equations of uuvi and uuvj can be expressed as follows 28 x i k n s i 5 x i k n s t i 5 v i k v i k n s i 5 v i k x j k n s υ 1 k s i 5 x i k 1 υ 1 k s i 5 x j k υ 2 k s t i 5 v i k n s t υ 2 k s t s i 5 v j k v j k n s i 5 x i k i 5 x j k t s i 5 v i k 2 t s i 5 v j k define the discrete equation of the state deviation between uuvi and uuvj at time k and k n s as 29 x i j e d 1 1 υ 1 k s i 5 x i j e d n s t υ 2 k s t s i 5 v i j e d v i j e d 1 i 5 x i j e d 2 t s i 5 v i j e d where x i j e d x j k x i k v i j e d v j k v i k indicate the status error d is the number of successful communications theorem 2 if the assumption 2 holds and the discrete equation 29 is stable then each uuv in the multi uuvs system can converge to the desired path in the case of communication packet loss proof set the communication information that is tranferred from uuv i to uuv j if the multi uuv error system 29 is stable 30 lim d x i j d 0 lim d v i j d 0 where j n i n i n i is the set of uuv that can receive uuv i s information according to equation 30 there exist an integer d i j and an arbitrary small positive number ε i j and when d d i j we have 31 x i j d 1 ε i j v i j d 1 ε i j set d i max d i j ε i min ε i j j n i when d d i such that 32 x i j d 1 ε i v i j d 1 ε i when ε i is small enough u j i k 0 similar to the above analysis for arbitrary p n j there exists d d j such that 33 x j p d 1 ε j v j p d 1 ε j combining the equations 32 and 33 when d max d i d j yields 34 x j p d 1 ε i ε j v j p d 1 ε i ε j therefore the state deviation between uuv i and uuv p in the multiple uuvs system can also be arbitrarily small the status of any vehicle in a multiple uuvs system can be consensus that means each uuv in the multi uuvs system can converge to the desired path the state matrix of the state deviation equation of the system 29 can be expressed as s n s i 5 where s n s is represented as follows 35 s n s 1 υ 1 k s n s t υ 2 k s t s 1 2 t s 1 t τ j i k s 2 n s t t τ j i k s 2 1 n s 1 t 1 1 n s 1 t according to the properties of the kronecker product if s n s is schur stable then s n s i 5 is also stable for each fixed n s n 1 2 n q the interval matrix s n s min n s max n is expressed as an interval matrix 36 s min n 1 t 2 n t t 2 1 n 1 t 1 1 n 1 t s max n 1 τ 0 2 n t τ 0 2 1 n 1 t 1 1 n 1 t when n is a fixed value we can use lemma 3 to determine the schur stability of the interval matrix s n however n is a variable we need to judge the schur stability of the interval matrix s n according to the following lemma lemma 6 for the discrete system shown in equation 29 if the interval matrix of equation 36 is schur stable for each fixed n s 1 2 n q the discrete system is schur stable proof according to lemma 3 if 35 is schur stable for arbitrary n s n 1 2 n q then there are finite subinterval matrices that can be completely decomposed by their subintervals 37 s n s s min n s max n n 1 n q s min n s max n then it can be derived as 38 n 1 n q s min n s max n i 1 k 1 s min 1 i s max 1 i i 1 k 2 s min 2 i s max 2 i i 1 k n q s min n q i s max n q i for arbitrary n 1 2 n q every subinterval matrix s min n i s min n i i 1 2 k n q satisfies the condition of lemma 3 so the matrix s n s can be completely decomposed into a finite number of subinterval matrices each subinterval matrix satisfies the conditions of lemma 3 that is when the matrix is schur stable the system matrix is also stable to schur lemma 7 zhang et al 2006 for the discrete system shown in 39 let f ℝ n n d ℝ n m if and only if there exist a matrix w ℝ m n and a symmetric positive definite matrix v ℝ n n and scalars ω i j 0 i j 1 2 n ν i j 0 i 1 2 n j 1 2 m satisfy the inequality of formula 40 the system is stable and its control rate is k wv 1 39 x k 1 f min f max x k d min d max u k u k k x k 40 v v f 0 t w t d 0 t v d w d f 0 v d 0 w v σ 0 0 v d t 0 λ w d t 0 δ 0 where the matrix λ is a diagonal matrix composed of elements ω i j the matrix δ is a diagonal matrix composed of elements v ij and the definitions of matrix f 0 d 0 are consistent with lemma 3 matrix v d v v n w d w w n matrix σ i j 1 n ω i j δ f i j 2 e i e i t i 1 n j 1 m ν i j δ d i j 2 e i e i t lemma 8 for the interval system matrix f min f max d min d max of 39 if there exists the matrix w and v that make the finite number of subinterval system matrices f min i f max i d min i d max i 1 i k satisfy the conditions of lemma 7 and the interval system matrix can be completely decomposed which means that if d t d min i d max i then f t f min i f max i 1 i k at any time instant t the interval system matrix is stable the complete decomposition can be denoted as 41 f min f max i 1 k f min i f max i d min d max i 1 k d min i d max i proof since the subinterval matrix f min i f max i and d min i d max i is stable the feedback control gain k wv 1 is used for i 1 2 k according to lemma 7 the interval matrix f min i f max i d min i d max i k is stable therefore the interval system 67 is stable represent multiple uuvs system as follows 42 x i k v i k m i 5 x i k v i k n i 5 u i k where m 0 1 0 0 n 0 1 the controller adopts the structure of 10 and k α 1 α 2 i 5 theorem 3 if multiple uuvs system satisfy assumption 1 2 and there is a control gain k can make f n d n k satisfy lemma 7 for each n 1 2 n q multiple uuv systems can be schur stable under the condition that packet loss exists in the communication proof for the system 42 the interval system matrix in lemma 7 can be expressed as 43 f min f max e n m t d min d max e n 1 n t 0 t τ i j k s e m t n d t where n 1 2 n q since f n d n k satisfies the lemma 7 the system 43 is stable that means the multiple uuvs system 42 is also stable therefore according to theorem 3 we can use the condition of matrix inequality in lemma 7 to calculate the controller parameters α 1 and α 2 to ensure the multiple uuv system schur stable that means each uuv in the multi uuvs system can converge to the desired path 4 simulation the simulation experiments are divided into two parts to prove the correctness of the path tracking controller proposed under the cases of bounded communication delay and packet losses in this section the topology structures of position and velocity in this paper are the same which is presented in fig 2 the underlying graph is connected and static the dashed line with an arrow means the transformation direction of the information between two vehicles that means the communication graph is directed according to fig 2 the adjacency matrix of the followers in the multi uuv system is given as follows a 0 0 1 1 0 0 0 0 0 0 0 0 1 1 0 0 1 0 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 the first case is that the information exchange between multiple uuvs has bounded time delay the initial value of x i 0 is distributed in the interval 90 100 randomly y i 0 and z i 0 are distributed in the interval 0 10 and 10 0 randomly i 0 1 8 θ i 0 and ψ i 0 of the followers uuvs are in the interval 0 06 π 0 06 π and 0 π respectively u i 0 i 1 8 takes form the interval 0 0 5 randomly the velocity of virtual leader takes 0 6 m s and other initial values of the multiple uuvs system are zero the path tracking controller s parameters are chosen as α 1 0 024 α 2 0 87 and τ 0 0 1 s t 0 5 s each vehicle in the multiple uuvs system is distributed over 8 vertices of a cube with side length 20 the positions of each uuv are coordinates s 1 20 20 20 0 0 s 2 20 20 20 0 0 s 3 20 20 20 0 0 s 4 20 20 20 0 0 s 5 20 20 20 0 0 s 6 20 20 20 0 0 s 7 20 20 20 0 0 s 5 20 20 20 0 0 the desired path is a helical curve and it expressed as x t 100 cos 0 01 π t y t 100 sin 0 01 π t z t 0 056 t figs 3 5 show the position of multi uuv in longitudinal transverse and vertical direction each uuv can track the desired path in the fixed formation designed in the simulation figs 6 7 show that the attitude states of all uuvs θ and ψ can converge to a fixed value the velocity states of multi uuv are shown in fig 8 12 where u i for each i 1 8 can converge to the velocity of the virtual leader and the other velocity v k w k q k r k of each uuv can also converge to a fixed value that guarantees the path tracking mission in fig 13 the three dimensional trajectories of the multiple uuvs system show that all uuvs can keep the formation in 8 vertices of a cube and track the desired path the second case is that the information exchanged under the situation of communication packet losses the simulation curve and the initial value of multiple uuvs are the same as the first case the path tracking controller s parameters are also chosen the same value in the first simulation the position and attitude states of multiple uuvs can also converge but it takes more time to stabilization comparing with the first case in fig 14 18 the position states converge to the desired helical curve and the attitude states converge to a fixed value the states of velocity u q r shown in fig 19 22 and 23 all converge to a fixed value over 500 s and the curves have larger overshoot value compared with the first case fig 20 shows that the velocity v converges to the velocity of the virtual leader but the value is chattering at the desired value and the state w has less chattering in fig 21 fig 24 shows the multiple uuvs system can follow the desired curve and stay in the formation with a random initial value in the situation of packet losses 5 conclusions the path tracking controller based on a virtual leader for multi uuv under sampled data delays and packet losses is designed for that purpose we transfer the continuous time nonlinear model of uuv into a discrete time model we analyze the sufficient conditions for the controller under the case of bounded communication delay by using the matrix theory then the consistency under the conditions of packet loss is proved by the shuler theory and the conditions for the convergence of multi uuv path tracking are given in the last part the simulation proves the effectiveness of the path tracking controller proposed in this paper each uuv in the multi uuv system can converge to the desired trajectories in a specified formation position the designed controller in this paper can also be applied under switching topologies condition which is proved in our future work not only that our future work is also focusing on uncertainties in communication such as mutual interference of communication information asynchronous information therefore we need to design a more robust controller as the accurate nonlinear dynamics of the uuv is difficult to obtain we also consider the uncertainty problem in the model transformation credit authorship contribution statement zheping yan formal analysis analysis and or interpretation of data zewen yang conceptualization writing original draft conception and design of study revising the manuscript critically for important intellectual content xiaoli pan funding acquisition acquisition of data jiajia zhou writing original draft drafting the manuscript di wu conceptualization conception and design of study declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
