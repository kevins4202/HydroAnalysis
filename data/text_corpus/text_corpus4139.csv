index,text
20695,deployment of multiple unmanned agent systems to perform missions in a collaborative manner has become a research hotspot in recent years and the same is true for multiple unmanned surface vehicles usvs therefore this present paper mainly focuses on the coordination control for multiple usvs in the dynamic maritime environment approach used in this paper is principally the behavior based method which is useful to guide the unmanned agent system in an unknown or dynamically changing environment the hybrid behavior based hb method combining the null space based behavioral nsb approach and behaviors complied with the international regulations for preventing collisions at sea colregs is proposed to achieve the coordination control of multiple usvs using the hb method all aspects of the coordination control problem including the rendezvous issue formation keeping and collision avoidance of both static and dynamic obstacles can be accomplished at the same time furthermore the kalman filter kf algorithm is incorporated into the proposed hb method to compensation for navigation information of other traffic ships in the dynamic environment so that a more practical coordination control for multiple usvs in the realistic applications can be achieved through the verification by numerical simulations the proposed hb method can effectively achieve the coordination control for multiple usvs in the dynamic environment keywords unmanned surface vehicles usvs coordination control behavior based method null space based behavioral nsb approach kalman filter kf colregs 1 introduction with continuous development and prosperity of the advanced unmanned platforms in recent decades the unmanned surface vehicle usv as a type of unmanned system has been widely used in many fields to support demanding and complex tasks such as pollution monitoring environmental surveying maritime rescue and so on liu et al 2016 zereik et al 2018 tan et al 2020a furthermore the deployment of multi usv to perform missions in coordination and cooperation also has long been of great interest to many researchers compared with a single usv the coordinated execution of tasks by multiple usvs exhibits several advantages in improving system fault tolerance and robustness reducing operational costs and increasing the success rate of task completion coordination control which includes rendezvous formation obstacle avoidance is employed to achieve the system level coordination for a multi agent system mas feng et al 2020 coordination control has been widely used in many fields such as mobile robot luo et al 2017 guan et al 2012 dong et al 2015 and unmanned aerial vehicle uav wang and mcdonald 2020 carli et al 2020 bandala et al 2014 its application on usvs is also a hot research topic in recent years coordination control in the usv field mainly includes not only cooperative control of homogeneous usvs wang et al 2020 lu et al 2018 liang et al 2019a 2019b 2020a 2020b singh et al 2020 mina et al 2019 2020 bibuli et al 2018 but also coordinated control between usvs and other intelligent agents shao et al 2019 wu et al 2020 cho et al 2020 vu et al 2020 in cao et al 2018 the consensus algorithm is used to coordinate the velocities and headings of a team of usvs liu et al 2017a employs the virtual leader structure combined with the second order consensus protocol to derive the distributed formation control law of multi usvs a cooperative defense strategy by a fleet of usvs is proposed in wu et al 2017 and a behavior based fuzzy logic control law is presented in nantogma et al 2019 to achieve the cooperative target protection by multiple usvs coordinated navigation and control strategies of usv and auv through the acoustic communication are shown in hu et al 2017 and vasilijević et al 2017 respectively aforementioned papers only involve the consensus problem and the formation control of multi agents however the rendezvous issue and the obstacle avoidance are not solved at the same time an interesting topic of swarm finding is presented in tan et al 2020b which can be seen as a rendezvous issue the proposed swarm finding algorithm uses the artificial potential field apf method to attract usvs to the center of their belonging swarm so that the formation of multi usvs can be formed quickly and accurately in addition a null space based behavioral nsb method is used in arrichiello et al 2006 to address the formation control of underactuated surface vessels the nsb method is a typical approach dealing with the distributed formation control problem and is well studied in robotics antonelli et al 2008 2009 2013 liang and li 2010 ahmad et al 2014 however its application on usvs is relatively few in fan et al 2019 based on the nsb approach the target reaching behavior is designed to tackle the rendezvous issue the collision avoidance behavior is used to deal with the obstacle avoidance and the cooperative formation behavior is employed to achieve the formation keeping of multi usvs however only obstacle avoidance between usvs and the static obstacle is involved but dynamic collision avoidance that needs to comply with the international regulations for preventing collisions at sea colregs does not take into account in the paper simultaneously the uncertainty of the usv model owing to the environmental disturbances is also not mentioned moreover the real time navigation information of other moving ships is used in the cooperative defense and the cooperative target protection presented in wu et al 2017 and nantogma et al 2019 which is not realistic in the maritime environment in the actual navigation the automatic identification system ais as a widely used navaids is mainly utilized to receive the navigation states from other ships and broadcasts own navigation information at regular time intervals so the data receiving process of the ais transmission consists of two stages i e the data receiving point and the waiting period at the data receiving point the usv can obtain the quasi real time navigation states of other ships however no information can be received during the waiting period in the light of the before mentioned problem how to use a method to achieve the rendezvous issue formation keeping and obstacle avoidance for multiple usvs at the same time taking into account of the model uncertainty and the feature of the ais broadcasting mechanism is the main focus of this paper therefore a hybrid behavior based hb method is proposed herein to achieve the coordination control of multiple usvs based on the nsb method a series of behaviors are given to guide usvs to converge to the desired center of the formation to perform obstacle avoidance and to maintain the formation respectively meanwhile in order to accomplish the dynamic collision avoidance in compliance with the colregs several behaviors are designed properly to guide usvs to make correct avoidance maneuvers in the dynamic maritime environment in order to make the method more suitable for the practical maritime application the kalman filter kf approach is incorporated to predict the trajectories of other obstacle ships so the problem that no information can be received during the waiting period of the ais transmission is solved besides the usv motion model including the uncertainty owing to the environmental disturbances is used in this paper the remainder of this paper is organized as follows after this introduction main contributions are given in section 2 afterwards the usv motion model including the uncertainty terms principles of ais fundamentals of the kf algorithm and the proposed hybrid behavior based hb method are detailed respectively in section 3 section 4 shows the numerical simulation results to validate the effectiveness of the proposed method finally conclusions are drawn in section 5 to summarize the work in the overall paper 2 main contributions the main contributions of the paper are three fold firstly in order to achieve the coordination control for multiple usvs a hybrid behavior based hb method combining behaviors designed based on the nsb approach and behaviors complied with the colregs is proposed using the hb method all aspects of the coordination control problem which are the rendezvous issue formation keeping and collision avoidance of both static and dynamic obstacles are achieved simultaneously secondly under the effect of the formation keeping behavior in the hb method all usvs are attracted to the target center of the formation which is seen as a virtual usv tracking the planned path of the entire whole formation using the los guidance law therefore path following of all usvs can be accomplished while maintaining the formation without the need to individually control each usv to track the planned path lastly in order to enable the usv to perceive the existences of other obstacle ships during the waiting period of the ais transmission kalman filter kf algorithm is incorporated into the hb method to predict states of other ships based on their previous ais information incorporating the kf method can compensate for the unavailable ais data when usv performs the dynamic collision avoidance so a more suitable coordination control method can be obtained for the practical applications 3 materials and methods in this section we first show the usv planar motion model in three degree of freedom 3 dof which is the basis of the coordination control for multiple usvs principles of ais and fundamentals of kalman filter algorithm used in this paper are described subsequently then algorithms of the proposed hybrid behavior based method are presented 3 1 usv motion model with uncertainties owing to external environment interference caused by wind waves and currents in addition to the change of usv s own navigation states during the voyage there are uncertainties in the usv motion model specifically speaking under the influence aforementioned hydrodynamic performance of the usv may change in the process of navigation which reflects in the usv motion model as the model parameters perturbation in other word hydrodynamic parameters such as additional mass coefficients and damping coefficients may change within a certain range to take into consideration of aforesaid uncertainties in the process of coordination control for multiple usvs motion model with uncertainties is given as follows considering n homogeneous or heterogeneous usvs to perform tasks in coordination based on fossen 2011 3 dof motion model of the ith usv moving on the horizontal plane considering parameters perturbation but ignoring heave pitch and roll motion is given as 1 η i j η i v i m ˆ i m i v i c ˆ i v i c i v i v i d ˆ i v i d i v i v i τ i τ i e where subscript i denotes the ith usv in the coordination control η i x i y i ψ i t is the vector where p i x i y i t and ψ i are the position vector and the heading angle defined in the inertial coordinate system oe xeye v i u i v i r i t is the velocity vector in which u i u i v i t and r i are the linear velocity vector and the angular velocity given in the body fixed reference frame ob xbyb of the usv these two coordinate systems are shown in fig 1 j η i represents the euler angle rotation matrix of the ith usv 2 j η i cos ψ i sin ψ i 0 sin ψ i cos ψ i 0 0 0 1 m i denotes the inertia mass matrix c i v i is the coriolis centripetal matrix and d i v i represents the damping matrix these three matrixes are in the form as follows 3 m i m i x i u 0 0 0 m i y i v y i r 0 n i v i i z z n i r m 11 0 0 0 m 22 m 23 0 m 23 m 33 c i v i 0 0 m i v i y i v v i y i r r i 0 0 m i u i x i u u i m i v i y i v v i y i r r i m i u i x i u u i 0 0 0 m 22 v i m 23 r i 0 0 m 11 u i m 22 v i m 23 r m 11 u i 0 d i v i x i u x i u i u u i 0 0 0 y i v y i v i v v i y i r i v r i y i r y i v i r v i 0 n i v n i v i v v i n i r i v r i n i r n i v i r v i n i r i r r i d 11 0 0 0 d 22 d 23 0 d 32 d 33 where m i is the mass of the ith usv and i i z z is its moment of inertia in yaw direction values such as x i u y i v n i r etc are all hydrodynamic parameters that may change owing to the influence of environmental disturbances therefore in eq 1 estimations representing the nominal values of the above three matrixes such as m ˆ i and corresponding perturbation terms such as m i m i m ˆ i are adopted to represent the uncertainties described before in the usv motion model and τ i τ i u 0 τ i r t denotes the thrust vector τ i e ξ i u ξ i v ξ i r t is the vector of environmental disturbances caused by wind waves and currents which is given as follows tan et al 2020a 4 ξ iu h s w iu s ξ iv h s w iv s ξ ir h s w ir s where h s is a second order transfer function and terms w iu s w iv s w ir s are defined as 5 w s n 0 σ ξ 2 which is a zero mean gaussian white noise to model the uncertainties 3 2 principles of ais automatic identification system ais is a widely used navigation aid system that is applied to the maritime safety and communication between ship and shore or between different ships it is a broadcasting mechanism that can receive the navigation information from other vessels and meanwhile broadcasts own ship s states at a certain time interval the time interval varies with types of the ais and navigation states of vessels assuming that all ships in maritime voyages are equipped with ais as shown in fig 2 the own usv can receive the navigation states from others when they broadcast at their own intervals however no data can be received during the time intervals so the own usv cannot perceive their existences therefore there are two stages in the ais broadcasting process for the own usv namely the data receiving point and the waiting period when the usv sails at sea it cannot obtain the navigation information of other vessels through ais during the waiting period moreover at the broadcasting point the data received by the ais has signal noise in order to compensate for the received obstacle ship s navigation information the kalman filter algorithm is used in this paper 3 3 fundamentals of kalman filter algorithm kalman filter kf algorithm is a state estimation algorithm that is widely used in communication navigation guidance control and other fields it is an optimal recursive data processing algorithm with two processes i e the prediction process and the update process as shown in fig 3 given values such as the initial state x ˆ 0 and the associated covariance matrix p 0 system state x ˆ t t 1 for the next time step t and the corresponding system covariance matrix p t t 1 are estimated recursively using values at current step t 1 in the prediction process the prediction made by the kf algorithm can be calculated in the form as 6 x ˆ t t 1 a t x ˆ t 1 t 1 b t u t 7 p t t 1 a t p t 1 t 1 a t t q t where a t is the state transition matrix b t denotes the control input matrix and u t is the control input q t represents transition noise in this process in order to improve the estimation accuracy the kf gain k t which is used to update the system state and the covariance matrix for time step t in the second process is calculated as follows 8 k t p t t 1 h t t h t p t t 1 h t t r t 1 where h t is the measurement matrix and r t is the measurement noise then in the update process state x ˆ t t and the associated covariance matrix p t t which are treated as the optimal estimations of the system for time step t and will be passed back to the prediction process as new inputs for the next time step t 1 are updated on the basis of the kf gain k t and the measurement z t to filter the measurement noise this process is shown as follows 9 x ˆ t t x ˆ t t 1 k t z t h t x ˆ t t 1 10 p t t i k t h t p t t 1 using the kf algorithm other obstacle ships navigation states can be estimated 3 4 states estimated by kf algorithm for usv as described beforehand during the waiting period between two data receiving points the usv cannot perceive states of the other ship that is hazardous to the navigation safety so in order to improve the control precision of the usv the prediction of the kf algorithm is used to estimate the states of obstacle ships when the ais data is unavailable and the update process is employed to filter the signal noise of the obtained ais information and corrects the state estimations when the usv is at the data receiving point so the usv can be aware of the obstacle ship at any time since it was first perceived by the usv the process of the states predicted by kf algorithm for the usv is shown in fig 4 the system state vector of the usv in the process of using the kf algorithm for the states prediction is given as follows 11 x t x y ψ u v t on the basis of constant velocity model cvm liu et al 2017b eq 6 in the prediction process of the kf algorithm can be rewritten as 12 x t 1 a t x t q t here state transition matrix a t and transition noise q t are given in the form as 13 a t 1 0 0 δ t 0 0 1 0 0 δ t 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 14 q t n 0 q where δ t is the iteration time step of the kf algorithm and 15 q diag 0 5 δ t 2 0 5 δ t 2 δ t δ t δ t σ q 2 in order to interact with other obstacle ships and to avoid collisions usvs need to know their positions and headings so the measurement z t is defined as 16 z t x y ψ t and the measurement equation is expressed as 17 z t h t x t r t where the measurement matrix h t and the measurement noise r t are given as 18 h t 1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 19 r t n 0 σ r 2 in the light of the state transition equation 12 and the measurement equation 17 states of other obstacle ships can be estimated using the kf algorithm for the usv 3 5 hybrid behavior based method 3 5 1 null space based behavioral theory behavior based method which is motivated by natural collective phenomena liang et al 2020c is an effective and useful approach to guide the multi agent system mas in an unknown or dynamic environment arkin 1998 it has a quick response to the changing environment so that it has a high flexibility pang et al 2019 null space based behavioral nsb method is a type of behavior based method which is proposed by antonelli and chiaverini in 2003 antonelli and chiaverini 2003 given a matrix a the null space of a used in the nsb method is defined according to chen et al 2007 in the form as 20 null a x ℝ n a x 0 the nsb method is a task priority approach it decomposes the entire task space into a hierarchical behavior structure in which multiple behaviors have different priorities the low priority behaviors are mapped to the null space of the high priority behaviors so that low priority behaviors can be performed partially while completing the high priority behaviors behavior with the highest priority can be always fulfilled however lower priority behaviors will be executed only when they do not conflict with higher priority behaviors therefore the nsb method can make full use of null space to complete other secondary behaviors on the premise that the primary behavior is fully accomplished based on the aforesaid characteristics the nsb method has been widely utilized in mobile robots ahmad et al 2014 antonelli et al 2008 2009 chen et al 2016 for the coordination control of multi usvs there are multiple behaviors that need to be performed to complete the entire task so in the nsb method the task function σ i to be controlled for the performing of the ith behavior is given as 21 σ i f i p i take the differential of eq 21 22 σ i f i p i p i p i j p i ν where ν p i x i y i t is the linear velocity vector defined in the inertial coordinate system oe xeye and j p i is the jacobian matrix of the σ i in order to obtain the reference motion for the usv from the desired values of each task function we have to invert the kinematic relationship of eq 22 23 ν i d j p i σ i d here j p i j t p i j p i j t p i 1 is the corresponding pseudo inverse matrix of j p i consider n behaviors to be executed with different priorities here it is assumed that the subscript 1 represents the highest priority and the remaining subscripts represent the lower priority in turn the final desired velocity of the usv considering all behaviors in the coordination control is defined as follows 24 ν d ν 1 d i 1 n 1 null ν i d ν i 1 d where null ν i d 1 i i j p i j p i denotes the null space of the expected velocity generated by the behavior with priority i which is mapping to the highest behavior by mapping the lower priority behaviors onto the null space of higher priority behaviors in eq 24 the reference motion for the usv is obtained mainly based on the behavior of the highest priority and at the same time partially completing the lower priority behaviors that do not conflict with the higher priority behaviors 3 5 2 null space based behaviors in the coordination control for multiple usvs in the coordination control for multiple usvs using the nsb method the entire task space is decomposed into three elementary behaviors keep the entire formation avoid collisions between usvs in the formation and with static obstacles in the maritime environment in this section the corresponding behaviors are presented 1 formation keeping behavior the formation keeping behavior is used to converge each usv to the target center of the formation and keep a desired distance deviation from it by controlling the distance deviation the usv formation is maintained moreover the target center of the formation which is seen as the virtual usv tracks the desired path of the formation using the los algorithm tan et al 2020b so that the path following of all usvs can also be achieved we take the coordinate of the formation s target center as p t x t y t t 25 σ 1 f 1 p 1 t p i t p n t p 1 p t p i p t p n p t t where n is the number of usvs to be controlled and p i t p i p t x i x t 2 y i y t 2 is the actual distance deviation between each usv and the formation s target center take the derivative of both sides of eq 25 we get 26 σ 1 j 1 p 1 t p i t p n t ν 1 here j 1 p 1 t p i t p n t is the jacobian matrix of the σ 1 in the form as 27 j 1 p 1 t p i t p n t x 1 x t p 1 p t y 1 y t p 1 p t x i x t p i p t y i y t p i p t x n x t p n p t y n y t p n p t the expected velocity of the formation keeping behavior is defined as 28 ν 1 d j 1 p 1 t p i t p n t λ 1 σ d σ 1 where j 1 p 1 t p i t p n t is the pseudo inverse matrix σ d is the desired deviation for the formation keeping and λ 1 is a gain coefﬁcient matrix 2 internal collision avoidance behavior internal collision avoidance behavior is used to keep relatively safe distances between usvs in the formation so that the navigation safety is guaranteed the task function is defined as 29 σ 2 f 2 p 2 1 p 3 1 p 3 2 p 4 2 p n n 2 p n n 1 p 2 p 1 p 3 p 1 p 3 p 2 p 4 p 2 p n p n 2 p n p n 1 t here we adopt a hierarchical structure to deal with the internal collision avoidance for multiple usvs we divide them into different avoidance levels according to their kinetic characteristics the better the dynamics the higher the level when there are internal collision risks higher level usvs will treat lower level usvs as obstacles and take corresponding internal obstacle avoidance behaviors this strategy will reduce the control complexity of the collision avoidance for multiple usvs deriving eq 29 with respect to time gives 30 σ 2 j 2 p 2 1 p 3 1 p 3 2 p 4 2 p n n 2 p n n 1 ν 2 where j 2 p 2 1 p 3 1 p 3 2 p 4 2 p n n 2 p n n 1 is the jacobian matrix of the σ 2 and the expected velocity of the internal collision avoidance behavior is defined as 31 ν 2 d j 2 p 2 1 p 3 1 p 3 2 p 4 2 p n n 2 p n n 1 λ 2 d s a f e i n p j p i here j 2 p 2 1 p 3 1 p 3 2 p 4 2 p n n 2 p n n 1 is the pseudo inverse matrix d s a f e i n is the minimum safe distance between two usvs and λ 2 is the gain coefﬁcient matrix 3 external collision avoidance behavior during the navigation process of usvs not only the internal collision avoidance needs to be considered but also the collision avoidance between the usv and the external static obstacle similar to the internal collision avoidance behavior we define the task function here in the form as 32 σ 3 f 3 p 1 o p 2 o p n o p 1 p o p 2 p o p n p o t where p o x o y o t is the position vector of the static obstacle in the maritime environment take the differential of eq 32 gives 33 σ 3 j 3 p 1 o p 2 o p n o ν 3 where j 3 p 1 o p 2 o p n o is the jacobian matrix of the σ 3 and the desired velocity of the external collision avoidance behavior is defined as follows 34 ν 3 d j 3 p 1 o p 2 o p n o λ 3 d s a f e o u t p i p o here j 3 p 1 o p 2 o p n o is the pseudo inverse matrix d s a f e o u t is the minimum safe distance between the usv and the external static obstacle λ 3 is the gain coefﬁcient matrix 4 overall desired velocity for three behaviors given by the nsb method we take the internal collision avoidance behavior as the highest priority the external collision avoidance behavior as the secondary priority and the formation keeping behavior as the third priority so the overall desired velocity vector of the nsb method is given according to eq 24 as 35 ν d nsb ν 2 d i j 2 j 2 ν 3 d i j 3 j 3 ν 1 d where ν d nsb is the desired linear velocity vector defined in the inertial coordinate system oe xeye however in order to control the motion of usvs ν d nsb should be transformed to the velocity vector in the body fixed reference frame ob xbyb of the usv using the euler angle rotation matrix j η i so the final desired velocity vector is obtained in the form as 36 ν d nsb u 1 d v 1 d u i d v i d u n d v n d t where u i d and v i d represent desired surge and sway velocities in the body fixed frame of the ith usv ultimately the expected overall speed and heading angle for each usv are given as follows 37 u i d nsb u i d 2 v i d 2 ψ i d n s b arctan 2 v i d u i d 3 5 3 hybrid behavior based method in the case of encountering with other obstacle ships the dynamic collision avoidance in compliance with the colregs should also be performed by the usv therefore some behaviors complied with the colregs are incorporated to the nsb method aforesaid to enhance the navigation safety of multi usvs in the dynamic environment so we call it the hybrid behavior based hb method based on this method usvs can accomplish dynamic collision avoidance as required by the colregs while achieving the coordination control colregs are maritime traffic rules that all vessels sailing at sea must abide by which include 41 rules to ensure the navigation safety of vessels tan et al 2020a among these rules there are 5 rules i e rules 13 17 involving the relevant requirements of dynamic collision avoidance in different encountering situations therefore in order to judge the encountering situations the encountering model of the usv and the other obstacle ship os is established in fig 5 value α i o s as shown in fig 5 is the key to judge the encountering situations set the position vector of os as p o s x o s y o s t the heading angle as ψ o s and the velocity vector as u o s u o s v o s t all navigation information of os can be estimated by the kf algorithm aforesaid and the value α i o s which is defined as the relative azimuth angle between the ith usv and the other os is in the form as 38 α i o s arctan 2 y i y o s x i x o s ψ i according to rules 13 17 of the colregs the encountering situations are divided into four categories on the basis of α i o s as follows 39 head on α i o s 0 15 345 360 crossing from right α i o s 15 112 5 crossing from left α i o s 247 5 345 overtaking α i o s 112 5 247 5 in the light of the requirements of dynamic collision avoidance described by the colregs corresponding behaviors in four encountering situations are designed in table 1 here the stand on vessel means according to the colregs the vessel that has the other on its portside shall keep its course and speed δ ψ δ ψ 1 δ ψ 2 t is the variation in the expected heading angle in which δ ψ 1 and δ ψ 2 are chosen manually based on the proposed hb method when there is no dynamic collision risk motion states of the usv are only determined by the nsb method however when the usv may collide with other obstacle ships the usv s states are determined by both the nsb method and the dynamic collision avoidance behaviors simultaneously so the coordination control of multiple usvs and the dynamic collision avoidance prescribed by the colregs can be achieved at the same time the detail of the coordination control algorithm for multiple usvs is described here with flow chart shown in fig 6 1 the algorithm first initializes navigation states of all usvs and avoidance levels according to their kinetic characteristics 2 the virtual usv which is the formation s target center tracks the planned path of the formation using los algorithm then each usv in the formation adopts the formation keeping behavior to converge to the virtual usv and to maintain a desired distance from it as the virtual usv follows the desired path under the effect of the formation keeping behavior the rendezvous issue the formation keeping and the path following of the whole formation can be achieved at the same time 3 the internal collision risk exists when distance between usvs is smaller than the minimum safe distance d s a f e i n and each usv judges the avoidance levels of its own and other usvs if the level of the usv itself is higher than that of other usv it will treat the other as an obstacle and takes internal collision avoidance behavior according to their positions otherwise it will not adopt the corresponding behavior 4 for every static obstacle in the detection range of the usv there is a static collision risk if the distance between them is less than minimum safe distance d s a f e o u t and the usv will take external collision avoidance behavior to avoid the static obstacle 5 as for the dynamic collision avoidance suppose that the navigation states of other obstacle ships are obtained by the ais during the waiting period the ais data is unavailable so the kf based prediction process is used to estimate the states of obstacle ships and when the ais information can be obtained at the data receiving point the kf algorithm is employed to update the estimation based on the kf algorithm the navigation states of other obstacle ships can always be available for usvs to determine whether there is a dynamic collision risk and to judge the encountering situations then suitable dynamic collision avoidance behaviors can be adopted to avoid obstacle ships 6 if the dynamic collision risk does not exist motion states of each usv are updated in the light of the nsb method using eq 37 otherwise the usv s motion states according to table 1 are determined by both nsb method and behaviors complied with the colregs 7 afterwards the algorithm will determine whether the final goal point of the formation has been reached if it has not the algorithm will jump back to step 2 and continues to run until the formation reaches the goal point 4 simulation results and discussions in this section three numerical simulations which include 3 6 and 9 usvs as well as one static obstacle and two dynamic obstacle ships are performed to validate the effectiveness of the proposed hybrid behavior based hb method planned path of multiple usvs used in simulations are given by six waypoints shown in fig 7 homogeneous usvs with different levels are utilized in this section and corresponding parameters are listed in table 2 and on the basis of usv s kinetic characteristics variations in the expected heading angle of behaviors complied with the colregs are set as 15 and 30 respectively there are two moving obstacle ships marked as os1 obstacle ship 1 and os2 obstacle ship 2 departing from start points at 300 200 and 100 1100 separately broadcasting mechanism of class a ais is simulated in this section to provide multiple usvs with navigation information of these two obstacle ships according to the states of two obstacle ships time intervals of ais are set as 2s and 3s 4 1 simulation of three usvs for simplicity in this subsection three usvs are used firstly to verify the effectiveness of the proposed hb method they are assumed to be divided into three avoidance levels and marked as usv1 usv2 and usv3 in order from low level to high level usv with the higher level will treat the lower level usv as an obstacle and takes the internal collision avoidance behaviors the hierarchical structure of three usvs is shown in fig 8 and their initial states are listed in table 3 trajectories of three usvs and two obstacle ships are shown in fig 9 the virtual leader usv which is the target center of the usv formation tracks the panned path using los law other actual usvs follow the leader usv according to the formation keeping behavior of the nsb method so that the path following of the whole formation can be achieved while maintaining the formation positions of obstacle ships are obtained by ais at fixed time intervals prescribed in table 2 in order to see the coordination control of usvs more clearly three detailed subplots are shown in fig 10 which include the dynamic collision avoidance in the case of crossing from right the avoidance of static obstacle and the dynamic collision avoidance in the scene of head on in fig 10 a which is at time t 50s in the simulation the os1 is crossing from the right side of the usv formation trajectory of the os1 represented by the black solid line is obtained according to positions from ais which have signal noise in order to enable usvs to perceive other obstacle ships during the time intervals and filter the noise of the ais data the kf algorithm is used to make a prediction of the os s positions when the ais data is not available and updates the information to improve the accuracy of the dynamic collision avoidance predicted positions and updated positions of os1 are represented by cyan and magenta signs in fig 10 a it can be seen that except for the initial stage of the simulation and positions where the os1 s navigation state changes significantly estimations obtained by the kf algorithm are generally consistent with positions received by ais and errors between the kf based estimation and the actual position of os1 are shown in fig 11 a at about 5s in the initial stage of the simulation there is a clear error in x axis and during the stage of 15 25s when the motion state of os1 changes significantly maximum error occurs in y axis however errors decrease when the kf algorithm is employed iteratively and small errors are obtained during the stage of 30 40s where usvs and os1 are in the encountering situation estimation errors are around 0 m in this process so that the dynamic collision avoidance has a good accuracy using positions estimated by the kf algorithm three usvs all turn right to bypass the os1 on its stern and follow the virtual leader usv so that a stable formation is maintained simultaneously fig 10 b shows the process of usvs avoiding static obstacle three usvs avoid the obstacle safely while maintaining the formation after the virtual usv the shortest distance between usv and the static obstacle is 26 31 m as shown in fig 10 c is the scenario of head on it can be seen that positions estimated by the kf algorithm are in a good consistency with positions received by the ais because the os2 is in a constant navigation state estimation errors are shown in fig 11 b and all usvs perform correct dynamic collision avoidance behaviors specified by the colregs distances between three usvs in the formation are shown in fig 12 based on the hierarchical structure of usvs shown in fig 8 internal collision avoidance of the nsb method can be achieved easily between usvs and distances between them are all greater than 20 m which is set as the minimum safe distance d s a f e i n in the simulation so the safe sailing without internal collision between usvs can be guaranteed time history curves of velocities and heading angles of three usvs are shown in fig 13 during this process movements of all usvs are in a good consistency based on the proposed hb method usvs can sail safely from start points to goal points without colliding with each other and obstacles meanwhile dynamic collision avoidance complied with the colregs is also achieved and a stable formation is formed following the virtual leader usv to track the planned path therefore coordination control of three usvs is accomplished effectively in this simulation 4 2 simulation of six usvs in this subsection to further validate the effect of the proposed hb method in the coordination control for multiple usvs six usvs are used to form a formation with the hierarchical structure shown in fig 14 and their initial states are listed in table 4 trajectories of six usvs and two obstacle ships are shown in fig 15 three detailed subplots are shown in fig 16 in order to see the coordination control of six usvs more clearly moreover estimation errors of the kf algorithm are shown in fig 17 it can be seen that the process of the coordination control of six usvs is similar to that in the case of three usvs estimation errors of the kf algorithm as shown in fig 17 a keep in a low level when usvs encounter with os1 during the simulation time of 25 40s so usvs can perform dynamic collision avoidance accurately based on the estimated positions to avoid the os1 which are crossing from the right side of the formation as shown in fig 16 b six usvs under the effect of the hb method follow the virtual usv to track the desired path while maintaining safe distances to the static obstacle and the shortest distance between usv and the static obstacle is about 19 4 m as shown in fig 16 c is the encountering situation of head on where usvs and os2 sail towards each other based on the estimated positions of os2 obtained by the kf algorithm when there are collision risks five usvs turn right to pass the os2 on its portside as prescribed by the colregs however the usv2 which is far away from the os2 does not need to take dynamic collision maneuvers but makes the similar behavior to maintain the entire formation under the effect of the formation keeping in order to see the effectiveness of the internal collision avoidance of the proposed hb method the time history curve of the shortest distance between usvs is shown in fig 18 however there are 15 curves of distances between six usvs for simplicity the shortest distance curve is presented here during the whole process of this simulation under the effect of the hb method all distances between usvs are greater than the minimum safe distance set as 20 m in the present paper therefore the navigation safety between six usvs can also be guaranteed velocities and heading angles of usvs are shown in fig 19 it can be seen that similar to the situation of three usvs motion states of six usvs are also in a good consistency furthermore as the number of usvs increases to six based on the proposed hb method a stable formation of six usvs is maintained on the premise that the collision avoidance of static obstacle and moving obstacle ships are accomplished meanwhile the path following of the whole formation is also achieved by tracking the virtual leader usv we can say that the coordination control of six usvs is also realized effectively in this subsection 4 3 simulation of nine usvs to further verify the proposed hb method with the increasing number of usvs in the formation simulation of nine usvs with different levels similar to the hierarchical structure aforesaid are performed in this subsection these nine usvs include six usvs used in the second simulation aforementioned and three new added usvs whose initial states are listed in table 5 trajectories of nine usvs and two obstacle ships are shown in fig 20 and three detailed subplots are shown in fig 21 respectively in fig 21 a there are three usvs that is usv7 usv8 and usv9 performing the dynamic collision avoidance to turn right to bypass the os1 on its stern under the situation of crossing from right the remainders do not have the collision risks but perform similar behaviors under the effect of the nsb method after the avoidance of the os1 nine usvs track the virtual leader usv to sail along the planned path however the formation becomes a little loose which is reflected in the increase in the longest distance between usvs shown in fig 23 similar to the other two simulations collision avoidance between usv and static obstacle has a good effectiveness which can be seen from fig 21 b and the shortest distance between usv and the static obstacle is about 15 14 m after avoiding the static obstacle the formation becomes looser and the longest distance between usvs increases to about 140 m it is because among the three behaviors of the nsb method the formation keeping behavior has the lowest priority so the formation becomes loose under the effect of the internal collision avoidance behavior to ensure the navigation safety of nine usvs as shown in fig 21 c under the situation of head on six usvs turn right to pass the os2 on its portside while the remaining three usvs do not perform the needed dynamic collision avoidance behaviors because they are far away from the os2 and there are no collision risks at the same time internal collision avoidance is also accomplished during this process estimation errors along x and y axis of the kf algorithm are also shown in fig 22 and time history curves of the shortest distance and longest distance between usvs are presented in fig 23 to show the effect of internal collision avoidance and the separation of usvs similar to the first two simulations the shortest distance between usvs is mainly greater than the minimum safe distance whereas during the period of 190 200s the distance is temporarily lower than 20 m it is when usvs meet the os2 under the situation of head on distances between usvs are reduced due to the avoidance of the obstacle ship but under the effect of the hb method usvs perform the internal collision avoidance behaviors autonomously so the shortest distance is restored to a level greater than 20 m after 200s in addition with the increase in number of usvs the longest distance between usvs increases after avoiding the os1 and the static obstacle respectively it is because that for the proposed hb method the formation keeping behavior has the lowest priority among the nsb method and the dynamic collision avoidance behavior so in order to ensure the navigation safety of usvs when they encounter with the static obstacle or other moving ships the formation becomes looser to increase the spaces between usvs for the collision avoidance therefore as the number of usvs increases the complexity of the coordination control for multiple usvs also increases especially for the formation keeping on the basis of achieving the collision avoidance time history curves of speeds and heading angles of usvs are given in fig 24 although there are nine usvs the navigation states of usvs are also in the good consistency in generally the coordination control of nine usvs using the proposed hb method has a good effectiveness however the formation keeping of multiple usvs needs to be improved further 5 conclusions in this present paper coordination control of multiple usvs is studied and a hybrid behavior based hb method is proposed to be more specific the null space based behavioral nsb method and the dynamic collision avoidance behaviors complied with the colregs are combined to achieve the coordination control for multiple usvs four behaviors designed according to requirements of the colregs are incorporated to three behaviors defined based on the nsb method to generate the hb method using the hb method the rendezvous issue formation keeping and collision avoidance of both static and dynamic obstacles can be accomplished at the same time furthermore in order to make the method more suitable for the practical maritime application kalman filter kf algorithm is also incorporated to compensate for the navigation information received by the ais and to filter the signal noise three numerical simulations are performed to validate the effectiveness of the proposed hb method in coordination control for multiple usvs it can be seen from simulations results that based on the hb method multiple usvs can maintain a relatively stable formation while following the desired path sailing from the start point to the goal point without colliding with each other as well as static obstacle or other moving ships however as the increase in number of usvs the complexity of the coordination control also increases and the formation becomes looser after the avoidance of obstacles future studies will focus on the improvement of the coordination control using the proposed method when the number of usvs increases significantly especially for the formation keeping issue we plan to introduce the consensus protocols into the proposed hb method to improve the consistency of the usv movement simultaneously the coordination control method will be verified with real boats in the realistic environment to further enhance the reliability and the effectiveness of the proposed method acknowledgment this work was financially supported by the national natural science foundation of china grant numbers 52071100 51409054 and 51509055 at the same time we gratefully acknowledge the editor in chief the associate editor and the anonymous referees for their helpful comments and suggestions credit authorship contribution statement guoge tan conceptualization methodology software writing original draft writing review editing jiayuan zhuang validation funding acquisition writing review editing jin zou supervision project administration lei wan supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20695,deployment of multiple unmanned agent systems to perform missions in a collaborative manner has become a research hotspot in recent years and the same is true for multiple unmanned surface vehicles usvs therefore this present paper mainly focuses on the coordination control for multiple usvs in the dynamic maritime environment approach used in this paper is principally the behavior based method which is useful to guide the unmanned agent system in an unknown or dynamically changing environment the hybrid behavior based hb method combining the null space based behavioral nsb approach and behaviors complied with the international regulations for preventing collisions at sea colregs is proposed to achieve the coordination control of multiple usvs using the hb method all aspects of the coordination control problem including the rendezvous issue formation keeping and collision avoidance of both static and dynamic obstacles can be accomplished at the same time furthermore the kalman filter kf algorithm is incorporated into the proposed hb method to compensation for navigation information of other traffic ships in the dynamic environment so that a more practical coordination control for multiple usvs in the realistic applications can be achieved through the verification by numerical simulations the proposed hb method can effectively achieve the coordination control for multiple usvs in the dynamic environment keywords unmanned surface vehicles usvs coordination control behavior based method null space based behavioral nsb approach kalman filter kf colregs 1 introduction with continuous development and prosperity of the advanced unmanned platforms in recent decades the unmanned surface vehicle usv as a type of unmanned system has been widely used in many fields to support demanding and complex tasks such as pollution monitoring environmental surveying maritime rescue and so on liu et al 2016 zereik et al 2018 tan et al 2020a furthermore the deployment of multi usv to perform missions in coordination and cooperation also has long been of great interest to many researchers compared with a single usv the coordinated execution of tasks by multiple usvs exhibits several advantages in improving system fault tolerance and robustness reducing operational costs and increasing the success rate of task completion coordination control which includes rendezvous formation obstacle avoidance is employed to achieve the system level coordination for a multi agent system mas feng et al 2020 coordination control has been widely used in many fields such as mobile robot luo et al 2017 guan et al 2012 dong et al 2015 and unmanned aerial vehicle uav wang and mcdonald 2020 carli et al 2020 bandala et al 2014 its application on usvs is also a hot research topic in recent years coordination control in the usv field mainly includes not only cooperative control of homogeneous usvs wang et al 2020 lu et al 2018 liang et al 2019a 2019b 2020a 2020b singh et al 2020 mina et al 2019 2020 bibuli et al 2018 but also coordinated control between usvs and other intelligent agents shao et al 2019 wu et al 2020 cho et al 2020 vu et al 2020 in cao et al 2018 the consensus algorithm is used to coordinate the velocities and headings of a team of usvs liu et al 2017a employs the virtual leader structure combined with the second order consensus protocol to derive the distributed formation control law of multi usvs a cooperative defense strategy by a fleet of usvs is proposed in wu et al 2017 and a behavior based fuzzy logic control law is presented in nantogma et al 2019 to achieve the cooperative target protection by multiple usvs coordinated navigation and control strategies of usv and auv through the acoustic communication are shown in hu et al 2017 and vasilijević et al 2017 respectively aforementioned papers only involve the consensus problem and the formation control of multi agents however the rendezvous issue and the obstacle avoidance are not solved at the same time an interesting topic of swarm finding is presented in tan et al 2020b which can be seen as a rendezvous issue the proposed swarm finding algorithm uses the artificial potential field apf method to attract usvs to the center of their belonging swarm so that the formation of multi usvs can be formed quickly and accurately in addition a null space based behavioral nsb method is used in arrichiello et al 2006 to address the formation control of underactuated surface vessels the nsb method is a typical approach dealing with the distributed formation control problem and is well studied in robotics antonelli et al 2008 2009 2013 liang and li 2010 ahmad et al 2014 however its application on usvs is relatively few in fan et al 2019 based on the nsb approach the target reaching behavior is designed to tackle the rendezvous issue the collision avoidance behavior is used to deal with the obstacle avoidance and the cooperative formation behavior is employed to achieve the formation keeping of multi usvs however only obstacle avoidance between usvs and the static obstacle is involved but dynamic collision avoidance that needs to comply with the international regulations for preventing collisions at sea colregs does not take into account in the paper simultaneously the uncertainty of the usv model owing to the environmental disturbances is also not mentioned moreover the real time navigation information of other moving ships is used in the cooperative defense and the cooperative target protection presented in wu et al 2017 and nantogma et al 2019 which is not realistic in the maritime environment in the actual navigation the automatic identification system ais as a widely used navaids is mainly utilized to receive the navigation states from other ships and broadcasts own navigation information at regular time intervals so the data receiving process of the ais transmission consists of two stages i e the data receiving point and the waiting period at the data receiving point the usv can obtain the quasi real time navigation states of other ships however no information can be received during the waiting period in the light of the before mentioned problem how to use a method to achieve the rendezvous issue formation keeping and obstacle avoidance for multiple usvs at the same time taking into account of the model uncertainty and the feature of the ais broadcasting mechanism is the main focus of this paper therefore a hybrid behavior based hb method is proposed herein to achieve the coordination control of multiple usvs based on the nsb method a series of behaviors are given to guide usvs to converge to the desired center of the formation to perform obstacle avoidance and to maintain the formation respectively meanwhile in order to accomplish the dynamic collision avoidance in compliance with the colregs several behaviors are designed properly to guide usvs to make correct avoidance maneuvers in the dynamic maritime environment in order to make the method more suitable for the practical maritime application the kalman filter kf approach is incorporated to predict the trajectories of other obstacle ships so the problem that no information can be received during the waiting period of the ais transmission is solved besides the usv motion model including the uncertainty owing to the environmental disturbances is used in this paper the remainder of this paper is organized as follows after this introduction main contributions are given in section 2 afterwards the usv motion model including the uncertainty terms principles of ais fundamentals of the kf algorithm and the proposed hybrid behavior based hb method are detailed respectively in section 3 section 4 shows the numerical simulation results to validate the effectiveness of the proposed method finally conclusions are drawn in section 5 to summarize the work in the overall paper 2 main contributions the main contributions of the paper are three fold firstly in order to achieve the coordination control for multiple usvs a hybrid behavior based hb method combining behaviors designed based on the nsb approach and behaviors complied with the colregs is proposed using the hb method all aspects of the coordination control problem which are the rendezvous issue formation keeping and collision avoidance of both static and dynamic obstacles are achieved simultaneously secondly under the effect of the formation keeping behavior in the hb method all usvs are attracted to the target center of the formation which is seen as a virtual usv tracking the planned path of the entire whole formation using the los guidance law therefore path following of all usvs can be accomplished while maintaining the formation without the need to individually control each usv to track the planned path lastly in order to enable the usv to perceive the existences of other obstacle ships during the waiting period of the ais transmission kalman filter kf algorithm is incorporated into the hb method to predict states of other ships based on their previous ais information incorporating the kf method can compensate for the unavailable ais data when usv performs the dynamic collision avoidance so a more suitable coordination control method can be obtained for the practical applications 3 materials and methods in this section we first show the usv planar motion model in three degree of freedom 3 dof which is the basis of the coordination control for multiple usvs principles of ais and fundamentals of kalman filter algorithm used in this paper are described subsequently then algorithms of the proposed hybrid behavior based method are presented 3 1 usv motion model with uncertainties owing to external environment interference caused by wind waves and currents in addition to the change of usv s own navigation states during the voyage there are uncertainties in the usv motion model specifically speaking under the influence aforementioned hydrodynamic performance of the usv may change in the process of navigation which reflects in the usv motion model as the model parameters perturbation in other word hydrodynamic parameters such as additional mass coefficients and damping coefficients may change within a certain range to take into consideration of aforesaid uncertainties in the process of coordination control for multiple usvs motion model with uncertainties is given as follows considering n homogeneous or heterogeneous usvs to perform tasks in coordination based on fossen 2011 3 dof motion model of the ith usv moving on the horizontal plane considering parameters perturbation but ignoring heave pitch and roll motion is given as 1 η i j η i v i m ˆ i m i v i c ˆ i v i c i v i v i d ˆ i v i d i v i v i τ i τ i e where subscript i denotes the ith usv in the coordination control η i x i y i ψ i t is the vector where p i x i y i t and ψ i are the position vector and the heading angle defined in the inertial coordinate system oe xeye v i u i v i r i t is the velocity vector in which u i u i v i t and r i are the linear velocity vector and the angular velocity given in the body fixed reference frame ob xbyb of the usv these two coordinate systems are shown in fig 1 j η i represents the euler angle rotation matrix of the ith usv 2 j η i cos ψ i sin ψ i 0 sin ψ i cos ψ i 0 0 0 1 m i denotes the inertia mass matrix c i v i is the coriolis centripetal matrix and d i v i represents the damping matrix these three matrixes are in the form as follows 3 m i m i x i u 0 0 0 m i y i v y i r 0 n i v i i z z n i r m 11 0 0 0 m 22 m 23 0 m 23 m 33 c i v i 0 0 m i v i y i v v i y i r r i 0 0 m i u i x i u u i m i v i y i v v i y i r r i m i u i x i u u i 0 0 0 m 22 v i m 23 r i 0 0 m 11 u i m 22 v i m 23 r m 11 u i 0 d i v i x i u x i u i u u i 0 0 0 y i v y i v i v v i y i r i v r i y i r y i v i r v i 0 n i v n i v i v v i n i r i v r i n i r n i v i r v i n i r i r r i d 11 0 0 0 d 22 d 23 0 d 32 d 33 where m i is the mass of the ith usv and i i z z is its moment of inertia in yaw direction values such as x i u y i v n i r etc are all hydrodynamic parameters that may change owing to the influence of environmental disturbances therefore in eq 1 estimations representing the nominal values of the above three matrixes such as m ˆ i and corresponding perturbation terms such as m i m i m ˆ i are adopted to represent the uncertainties described before in the usv motion model and τ i τ i u 0 τ i r t denotes the thrust vector τ i e ξ i u ξ i v ξ i r t is the vector of environmental disturbances caused by wind waves and currents which is given as follows tan et al 2020a 4 ξ iu h s w iu s ξ iv h s w iv s ξ ir h s w ir s where h s is a second order transfer function and terms w iu s w iv s w ir s are defined as 5 w s n 0 σ ξ 2 which is a zero mean gaussian white noise to model the uncertainties 3 2 principles of ais automatic identification system ais is a widely used navigation aid system that is applied to the maritime safety and communication between ship and shore or between different ships it is a broadcasting mechanism that can receive the navigation information from other vessels and meanwhile broadcasts own ship s states at a certain time interval the time interval varies with types of the ais and navigation states of vessels assuming that all ships in maritime voyages are equipped with ais as shown in fig 2 the own usv can receive the navigation states from others when they broadcast at their own intervals however no data can be received during the time intervals so the own usv cannot perceive their existences therefore there are two stages in the ais broadcasting process for the own usv namely the data receiving point and the waiting period when the usv sails at sea it cannot obtain the navigation information of other vessels through ais during the waiting period moreover at the broadcasting point the data received by the ais has signal noise in order to compensate for the received obstacle ship s navigation information the kalman filter algorithm is used in this paper 3 3 fundamentals of kalman filter algorithm kalman filter kf algorithm is a state estimation algorithm that is widely used in communication navigation guidance control and other fields it is an optimal recursive data processing algorithm with two processes i e the prediction process and the update process as shown in fig 3 given values such as the initial state x ˆ 0 and the associated covariance matrix p 0 system state x ˆ t t 1 for the next time step t and the corresponding system covariance matrix p t t 1 are estimated recursively using values at current step t 1 in the prediction process the prediction made by the kf algorithm can be calculated in the form as 6 x ˆ t t 1 a t x ˆ t 1 t 1 b t u t 7 p t t 1 a t p t 1 t 1 a t t q t where a t is the state transition matrix b t denotes the control input matrix and u t is the control input q t represents transition noise in this process in order to improve the estimation accuracy the kf gain k t which is used to update the system state and the covariance matrix for time step t in the second process is calculated as follows 8 k t p t t 1 h t t h t p t t 1 h t t r t 1 where h t is the measurement matrix and r t is the measurement noise then in the update process state x ˆ t t and the associated covariance matrix p t t which are treated as the optimal estimations of the system for time step t and will be passed back to the prediction process as new inputs for the next time step t 1 are updated on the basis of the kf gain k t and the measurement z t to filter the measurement noise this process is shown as follows 9 x ˆ t t x ˆ t t 1 k t z t h t x ˆ t t 1 10 p t t i k t h t p t t 1 using the kf algorithm other obstacle ships navigation states can be estimated 3 4 states estimated by kf algorithm for usv as described beforehand during the waiting period between two data receiving points the usv cannot perceive states of the other ship that is hazardous to the navigation safety so in order to improve the control precision of the usv the prediction of the kf algorithm is used to estimate the states of obstacle ships when the ais data is unavailable and the update process is employed to filter the signal noise of the obtained ais information and corrects the state estimations when the usv is at the data receiving point so the usv can be aware of the obstacle ship at any time since it was first perceived by the usv the process of the states predicted by kf algorithm for the usv is shown in fig 4 the system state vector of the usv in the process of using the kf algorithm for the states prediction is given as follows 11 x t x y ψ u v t on the basis of constant velocity model cvm liu et al 2017b eq 6 in the prediction process of the kf algorithm can be rewritten as 12 x t 1 a t x t q t here state transition matrix a t and transition noise q t are given in the form as 13 a t 1 0 0 δ t 0 0 1 0 0 δ t 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 14 q t n 0 q where δ t is the iteration time step of the kf algorithm and 15 q diag 0 5 δ t 2 0 5 δ t 2 δ t δ t δ t σ q 2 in order to interact with other obstacle ships and to avoid collisions usvs need to know their positions and headings so the measurement z t is defined as 16 z t x y ψ t and the measurement equation is expressed as 17 z t h t x t r t where the measurement matrix h t and the measurement noise r t are given as 18 h t 1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 19 r t n 0 σ r 2 in the light of the state transition equation 12 and the measurement equation 17 states of other obstacle ships can be estimated using the kf algorithm for the usv 3 5 hybrid behavior based method 3 5 1 null space based behavioral theory behavior based method which is motivated by natural collective phenomena liang et al 2020c is an effective and useful approach to guide the multi agent system mas in an unknown or dynamic environment arkin 1998 it has a quick response to the changing environment so that it has a high flexibility pang et al 2019 null space based behavioral nsb method is a type of behavior based method which is proposed by antonelli and chiaverini in 2003 antonelli and chiaverini 2003 given a matrix a the null space of a used in the nsb method is defined according to chen et al 2007 in the form as 20 null a x ℝ n a x 0 the nsb method is a task priority approach it decomposes the entire task space into a hierarchical behavior structure in which multiple behaviors have different priorities the low priority behaviors are mapped to the null space of the high priority behaviors so that low priority behaviors can be performed partially while completing the high priority behaviors behavior with the highest priority can be always fulfilled however lower priority behaviors will be executed only when they do not conflict with higher priority behaviors therefore the nsb method can make full use of null space to complete other secondary behaviors on the premise that the primary behavior is fully accomplished based on the aforesaid characteristics the nsb method has been widely utilized in mobile robots ahmad et al 2014 antonelli et al 2008 2009 chen et al 2016 for the coordination control of multi usvs there are multiple behaviors that need to be performed to complete the entire task so in the nsb method the task function σ i to be controlled for the performing of the ith behavior is given as 21 σ i f i p i take the differential of eq 21 22 σ i f i p i p i p i j p i ν where ν p i x i y i t is the linear velocity vector defined in the inertial coordinate system oe xeye and j p i is the jacobian matrix of the σ i in order to obtain the reference motion for the usv from the desired values of each task function we have to invert the kinematic relationship of eq 22 23 ν i d j p i σ i d here j p i j t p i j p i j t p i 1 is the corresponding pseudo inverse matrix of j p i consider n behaviors to be executed with different priorities here it is assumed that the subscript 1 represents the highest priority and the remaining subscripts represent the lower priority in turn the final desired velocity of the usv considering all behaviors in the coordination control is defined as follows 24 ν d ν 1 d i 1 n 1 null ν i d ν i 1 d where null ν i d 1 i i j p i j p i denotes the null space of the expected velocity generated by the behavior with priority i which is mapping to the highest behavior by mapping the lower priority behaviors onto the null space of higher priority behaviors in eq 24 the reference motion for the usv is obtained mainly based on the behavior of the highest priority and at the same time partially completing the lower priority behaviors that do not conflict with the higher priority behaviors 3 5 2 null space based behaviors in the coordination control for multiple usvs in the coordination control for multiple usvs using the nsb method the entire task space is decomposed into three elementary behaviors keep the entire formation avoid collisions between usvs in the formation and with static obstacles in the maritime environment in this section the corresponding behaviors are presented 1 formation keeping behavior the formation keeping behavior is used to converge each usv to the target center of the formation and keep a desired distance deviation from it by controlling the distance deviation the usv formation is maintained moreover the target center of the formation which is seen as the virtual usv tracks the desired path of the formation using the los algorithm tan et al 2020b so that the path following of all usvs can also be achieved we take the coordinate of the formation s target center as p t x t y t t 25 σ 1 f 1 p 1 t p i t p n t p 1 p t p i p t p n p t t where n is the number of usvs to be controlled and p i t p i p t x i x t 2 y i y t 2 is the actual distance deviation between each usv and the formation s target center take the derivative of both sides of eq 25 we get 26 σ 1 j 1 p 1 t p i t p n t ν 1 here j 1 p 1 t p i t p n t is the jacobian matrix of the σ 1 in the form as 27 j 1 p 1 t p i t p n t x 1 x t p 1 p t y 1 y t p 1 p t x i x t p i p t y i y t p i p t x n x t p n p t y n y t p n p t the expected velocity of the formation keeping behavior is defined as 28 ν 1 d j 1 p 1 t p i t p n t λ 1 σ d σ 1 where j 1 p 1 t p i t p n t is the pseudo inverse matrix σ d is the desired deviation for the formation keeping and λ 1 is a gain coefﬁcient matrix 2 internal collision avoidance behavior internal collision avoidance behavior is used to keep relatively safe distances between usvs in the formation so that the navigation safety is guaranteed the task function is defined as 29 σ 2 f 2 p 2 1 p 3 1 p 3 2 p 4 2 p n n 2 p n n 1 p 2 p 1 p 3 p 1 p 3 p 2 p 4 p 2 p n p n 2 p n p n 1 t here we adopt a hierarchical structure to deal with the internal collision avoidance for multiple usvs we divide them into different avoidance levels according to their kinetic characteristics the better the dynamics the higher the level when there are internal collision risks higher level usvs will treat lower level usvs as obstacles and take corresponding internal obstacle avoidance behaviors this strategy will reduce the control complexity of the collision avoidance for multiple usvs deriving eq 29 with respect to time gives 30 σ 2 j 2 p 2 1 p 3 1 p 3 2 p 4 2 p n n 2 p n n 1 ν 2 where j 2 p 2 1 p 3 1 p 3 2 p 4 2 p n n 2 p n n 1 is the jacobian matrix of the σ 2 and the expected velocity of the internal collision avoidance behavior is defined as 31 ν 2 d j 2 p 2 1 p 3 1 p 3 2 p 4 2 p n n 2 p n n 1 λ 2 d s a f e i n p j p i here j 2 p 2 1 p 3 1 p 3 2 p 4 2 p n n 2 p n n 1 is the pseudo inverse matrix d s a f e i n is the minimum safe distance between two usvs and λ 2 is the gain coefﬁcient matrix 3 external collision avoidance behavior during the navigation process of usvs not only the internal collision avoidance needs to be considered but also the collision avoidance between the usv and the external static obstacle similar to the internal collision avoidance behavior we define the task function here in the form as 32 σ 3 f 3 p 1 o p 2 o p n o p 1 p o p 2 p o p n p o t where p o x o y o t is the position vector of the static obstacle in the maritime environment take the differential of eq 32 gives 33 σ 3 j 3 p 1 o p 2 o p n o ν 3 where j 3 p 1 o p 2 o p n o is the jacobian matrix of the σ 3 and the desired velocity of the external collision avoidance behavior is defined as follows 34 ν 3 d j 3 p 1 o p 2 o p n o λ 3 d s a f e o u t p i p o here j 3 p 1 o p 2 o p n o is the pseudo inverse matrix d s a f e o u t is the minimum safe distance between the usv and the external static obstacle λ 3 is the gain coefﬁcient matrix 4 overall desired velocity for three behaviors given by the nsb method we take the internal collision avoidance behavior as the highest priority the external collision avoidance behavior as the secondary priority and the formation keeping behavior as the third priority so the overall desired velocity vector of the nsb method is given according to eq 24 as 35 ν d nsb ν 2 d i j 2 j 2 ν 3 d i j 3 j 3 ν 1 d where ν d nsb is the desired linear velocity vector defined in the inertial coordinate system oe xeye however in order to control the motion of usvs ν d nsb should be transformed to the velocity vector in the body fixed reference frame ob xbyb of the usv using the euler angle rotation matrix j η i so the final desired velocity vector is obtained in the form as 36 ν d nsb u 1 d v 1 d u i d v i d u n d v n d t where u i d and v i d represent desired surge and sway velocities in the body fixed frame of the ith usv ultimately the expected overall speed and heading angle for each usv are given as follows 37 u i d nsb u i d 2 v i d 2 ψ i d n s b arctan 2 v i d u i d 3 5 3 hybrid behavior based method in the case of encountering with other obstacle ships the dynamic collision avoidance in compliance with the colregs should also be performed by the usv therefore some behaviors complied with the colregs are incorporated to the nsb method aforesaid to enhance the navigation safety of multi usvs in the dynamic environment so we call it the hybrid behavior based hb method based on this method usvs can accomplish dynamic collision avoidance as required by the colregs while achieving the coordination control colregs are maritime traffic rules that all vessels sailing at sea must abide by which include 41 rules to ensure the navigation safety of vessels tan et al 2020a among these rules there are 5 rules i e rules 13 17 involving the relevant requirements of dynamic collision avoidance in different encountering situations therefore in order to judge the encountering situations the encountering model of the usv and the other obstacle ship os is established in fig 5 value α i o s as shown in fig 5 is the key to judge the encountering situations set the position vector of os as p o s x o s y o s t the heading angle as ψ o s and the velocity vector as u o s u o s v o s t all navigation information of os can be estimated by the kf algorithm aforesaid and the value α i o s which is defined as the relative azimuth angle between the ith usv and the other os is in the form as 38 α i o s arctan 2 y i y o s x i x o s ψ i according to rules 13 17 of the colregs the encountering situations are divided into four categories on the basis of α i o s as follows 39 head on α i o s 0 15 345 360 crossing from right α i o s 15 112 5 crossing from left α i o s 247 5 345 overtaking α i o s 112 5 247 5 in the light of the requirements of dynamic collision avoidance described by the colregs corresponding behaviors in four encountering situations are designed in table 1 here the stand on vessel means according to the colregs the vessel that has the other on its portside shall keep its course and speed δ ψ δ ψ 1 δ ψ 2 t is the variation in the expected heading angle in which δ ψ 1 and δ ψ 2 are chosen manually based on the proposed hb method when there is no dynamic collision risk motion states of the usv are only determined by the nsb method however when the usv may collide with other obstacle ships the usv s states are determined by both the nsb method and the dynamic collision avoidance behaviors simultaneously so the coordination control of multiple usvs and the dynamic collision avoidance prescribed by the colregs can be achieved at the same time the detail of the coordination control algorithm for multiple usvs is described here with flow chart shown in fig 6 1 the algorithm first initializes navigation states of all usvs and avoidance levels according to their kinetic characteristics 2 the virtual usv which is the formation s target center tracks the planned path of the formation using los algorithm then each usv in the formation adopts the formation keeping behavior to converge to the virtual usv and to maintain a desired distance from it as the virtual usv follows the desired path under the effect of the formation keeping behavior the rendezvous issue the formation keeping and the path following of the whole formation can be achieved at the same time 3 the internal collision risk exists when distance between usvs is smaller than the minimum safe distance d s a f e i n and each usv judges the avoidance levels of its own and other usvs if the level of the usv itself is higher than that of other usv it will treat the other as an obstacle and takes internal collision avoidance behavior according to their positions otherwise it will not adopt the corresponding behavior 4 for every static obstacle in the detection range of the usv there is a static collision risk if the distance between them is less than minimum safe distance d s a f e o u t and the usv will take external collision avoidance behavior to avoid the static obstacle 5 as for the dynamic collision avoidance suppose that the navigation states of other obstacle ships are obtained by the ais during the waiting period the ais data is unavailable so the kf based prediction process is used to estimate the states of obstacle ships and when the ais information can be obtained at the data receiving point the kf algorithm is employed to update the estimation based on the kf algorithm the navigation states of other obstacle ships can always be available for usvs to determine whether there is a dynamic collision risk and to judge the encountering situations then suitable dynamic collision avoidance behaviors can be adopted to avoid obstacle ships 6 if the dynamic collision risk does not exist motion states of each usv are updated in the light of the nsb method using eq 37 otherwise the usv s motion states according to table 1 are determined by both nsb method and behaviors complied with the colregs 7 afterwards the algorithm will determine whether the final goal point of the formation has been reached if it has not the algorithm will jump back to step 2 and continues to run until the formation reaches the goal point 4 simulation results and discussions in this section three numerical simulations which include 3 6 and 9 usvs as well as one static obstacle and two dynamic obstacle ships are performed to validate the effectiveness of the proposed hybrid behavior based hb method planned path of multiple usvs used in simulations are given by six waypoints shown in fig 7 homogeneous usvs with different levels are utilized in this section and corresponding parameters are listed in table 2 and on the basis of usv s kinetic characteristics variations in the expected heading angle of behaviors complied with the colregs are set as 15 and 30 respectively there are two moving obstacle ships marked as os1 obstacle ship 1 and os2 obstacle ship 2 departing from start points at 300 200 and 100 1100 separately broadcasting mechanism of class a ais is simulated in this section to provide multiple usvs with navigation information of these two obstacle ships according to the states of two obstacle ships time intervals of ais are set as 2s and 3s 4 1 simulation of three usvs for simplicity in this subsection three usvs are used firstly to verify the effectiveness of the proposed hb method they are assumed to be divided into three avoidance levels and marked as usv1 usv2 and usv3 in order from low level to high level usv with the higher level will treat the lower level usv as an obstacle and takes the internal collision avoidance behaviors the hierarchical structure of three usvs is shown in fig 8 and their initial states are listed in table 3 trajectories of three usvs and two obstacle ships are shown in fig 9 the virtual leader usv which is the target center of the usv formation tracks the panned path using los law other actual usvs follow the leader usv according to the formation keeping behavior of the nsb method so that the path following of the whole formation can be achieved while maintaining the formation positions of obstacle ships are obtained by ais at fixed time intervals prescribed in table 2 in order to see the coordination control of usvs more clearly three detailed subplots are shown in fig 10 which include the dynamic collision avoidance in the case of crossing from right the avoidance of static obstacle and the dynamic collision avoidance in the scene of head on in fig 10 a which is at time t 50s in the simulation the os1 is crossing from the right side of the usv formation trajectory of the os1 represented by the black solid line is obtained according to positions from ais which have signal noise in order to enable usvs to perceive other obstacle ships during the time intervals and filter the noise of the ais data the kf algorithm is used to make a prediction of the os s positions when the ais data is not available and updates the information to improve the accuracy of the dynamic collision avoidance predicted positions and updated positions of os1 are represented by cyan and magenta signs in fig 10 a it can be seen that except for the initial stage of the simulation and positions where the os1 s navigation state changes significantly estimations obtained by the kf algorithm are generally consistent with positions received by ais and errors between the kf based estimation and the actual position of os1 are shown in fig 11 a at about 5s in the initial stage of the simulation there is a clear error in x axis and during the stage of 15 25s when the motion state of os1 changes significantly maximum error occurs in y axis however errors decrease when the kf algorithm is employed iteratively and small errors are obtained during the stage of 30 40s where usvs and os1 are in the encountering situation estimation errors are around 0 m in this process so that the dynamic collision avoidance has a good accuracy using positions estimated by the kf algorithm three usvs all turn right to bypass the os1 on its stern and follow the virtual leader usv so that a stable formation is maintained simultaneously fig 10 b shows the process of usvs avoiding static obstacle three usvs avoid the obstacle safely while maintaining the formation after the virtual usv the shortest distance between usv and the static obstacle is 26 31 m as shown in fig 10 c is the scenario of head on it can be seen that positions estimated by the kf algorithm are in a good consistency with positions received by the ais because the os2 is in a constant navigation state estimation errors are shown in fig 11 b and all usvs perform correct dynamic collision avoidance behaviors specified by the colregs distances between three usvs in the formation are shown in fig 12 based on the hierarchical structure of usvs shown in fig 8 internal collision avoidance of the nsb method can be achieved easily between usvs and distances between them are all greater than 20 m which is set as the minimum safe distance d s a f e i n in the simulation so the safe sailing without internal collision between usvs can be guaranteed time history curves of velocities and heading angles of three usvs are shown in fig 13 during this process movements of all usvs are in a good consistency based on the proposed hb method usvs can sail safely from start points to goal points without colliding with each other and obstacles meanwhile dynamic collision avoidance complied with the colregs is also achieved and a stable formation is formed following the virtual leader usv to track the planned path therefore coordination control of three usvs is accomplished effectively in this simulation 4 2 simulation of six usvs in this subsection to further validate the effect of the proposed hb method in the coordination control for multiple usvs six usvs are used to form a formation with the hierarchical structure shown in fig 14 and their initial states are listed in table 4 trajectories of six usvs and two obstacle ships are shown in fig 15 three detailed subplots are shown in fig 16 in order to see the coordination control of six usvs more clearly moreover estimation errors of the kf algorithm are shown in fig 17 it can be seen that the process of the coordination control of six usvs is similar to that in the case of three usvs estimation errors of the kf algorithm as shown in fig 17 a keep in a low level when usvs encounter with os1 during the simulation time of 25 40s so usvs can perform dynamic collision avoidance accurately based on the estimated positions to avoid the os1 which are crossing from the right side of the formation as shown in fig 16 b six usvs under the effect of the hb method follow the virtual usv to track the desired path while maintaining safe distances to the static obstacle and the shortest distance between usv and the static obstacle is about 19 4 m as shown in fig 16 c is the encountering situation of head on where usvs and os2 sail towards each other based on the estimated positions of os2 obtained by the kf algorithm when there are collision risks five usvs turn right to pass the os2 on its portside as prescribed by the colregs however the usv2 which is far away from the os2 does not need to take dynamic collision maneuvers but makes the similar behavior to maintain the entire formation under the effect of the formation keeping in order to see the effectiveness of the internal collision avoidance of the proposed hb method the time history curve of the shortest distance between usvs is shown in fig 18 however there are 15 curves of distances between six usvs for simplicity the shortest distance curve is presented here during the whole process of this simulation under the effect of the hb method all distances between usvs are greater than the minimum safe distance set as 20 m in the present paper therefore the navigation safety between six usvs can also be guaranteed velocities and heading angles of usvs are shown in fig 19 it can be seen that similar to the situation of three usvs motion states of six usvs are also in a good consistency furthermore as the number of usvs increases to six based on the proposed hb method a stable formation of six usvs is maintained on the premise that the collision avoidance of static obstacle and moving obstacle ships are accomplished meanwhile the path following of the whole formation is also achieved by tracking the virtual leader usv we can say that the coordination control of six usvs is also realized effectively in this subsection 4 3 simulation of nine usvs to further verify the proposed hb method with the increasing number of usvs in the formation simulation of nine usvs with different levels similar to the hierarchical structure aforesaid are performed in this subsection these nine usvs include six usvs used in the second simulation aforementioned and three new added usvs whose initial states are listed in table 5 trajectories of nine usvs and two obstacle ships are shown in fig 20 and three detailed subplots are shown in fig 21 respectively in fig 21 a there are three usvs that is usv7 usv8 and usv9 performing the dynamic collision avoidance to turn right to bypass the os1 on its stern under the situation of crossing from right the remainders do not have the collision risks but perform similar behaviors under the effect of the nsb method after the avoidance of the os1 nine usvs track the virtual leader usv to sail along the planned path however the formation becomes a little loose which is reflected in the increase in the longest distance between usvs shown in fig 23 similar to the other two simulations collision avoidance between usv and static obstacle has a good effectiveness which can be seen from fig 21 b and the shortest distance between usv and the static obstacle is about 15 14 m after avoiding the static obstacle the formation becomes looser and the longest distance between usvs increases to about 140 m it is because among the three behaviors of the nsb method the formation keeping behavior has the lowest priority so the formation becomes loose under the effect of the internal collision avoidance behavior to ensure the navigation safety of nine usvs as shown in fig 21 c under the situation of head on six usvs turn right to pass the os2 on its portside while the remaining three usvs do not perform the needed dynamic collision avoidance behaviors because they are far away from the os2 and there are no collision risks at the same time internal collision avoidance is also accomplished during this process estimation errors along x and y axis of the kf algorithm are also shown in fig 22 and time history curves of the shortest distance and longest distance between usvs are presented in fig 23 to show the effect of internal collision avoidance and the separation of usvs similar to the first two simulations the shortest distance between usvs is mainly greater than the minimum safe distance whereas during the period of 190 200s the distance is temporarily lower than 20 m it is when usvs meet the os2 under the situation of head on distances between usvs are reduced due to the avoidance of the obstacle ship but under the effect of the hb method usvs perform the internal collision avoidance behaviors autonomously so the shortest distance is restored to a level greater than 20 m after 200s in addition with the increase in number of usvs the longest distance between usvs increases after avoiding the os1 and the static obstacle respectively it is because that for the proposed hb method the formation keeping behavior has the lowest priority among the nsb method and the dynamic collision avoidance behavior so in order to ensure the navigation safety of usvs when they encounter with the static obstacle or other moving ships the formation becomes looser to increase the spaces between usvs for the collision avoidance therefore as the number of usvs increases the complexity of the coordination control for multiple usvs also increases especially for the formation keeping on the basis of achieving the collision avoidance time history curves of speeds and heading angles of usvs are given in fig 24 although there are nine usvs the navigation states of usvs are also in the good consistency in generally the coordination control of nine usvs using the proposed hb method has a good effectiveness however the formation keeping of multiple usvs needs to be improved further 5 conclusions in this present paper coordination control of multiple usvs is studied and a hybrid behavior based hb method is proposed to be more specific the null space based behavioral nsb method and the dynamic collision avoidance behaviors complied with the colregs are combined to achieve the coordination control for multiple usvs four behaviors designed according to requirements of the colregs are incorporated to three behaviors defined based on the nsb method to generate the hb method using the hb method the rendezvous issue formation keeping and collision avoidance of both static and dynamic obstacles can be accomplished at the same time furthermore in order to make the method more suitable for the practical maritime application kalman filter kf algorithm is also incorporated to compensate for the navigation information received by the ais and to filter the signal noise three numerical simulations are performed to validate the effectiveness of the proposed hb method in coordination control for multiple usvs it can be seen from simulations results that based on the hb method multiple usvs can maintain a relatively stable formation while following the desired path sailing from the start point to the goal point without colliding with each other as well as static obstacle or other moving ships however as the increase in number of usvs the complexity of the coordination control also increases and the formation becomes looser after the avoidance of obstacles future studies will focus on the improvement of the coordination control using the proposed method when the number of usvs increases significantly especially for the formation keeping issue we plan to introduce the consensus protocols into the proposed hb method to improve the consistency of the usv movement simultaneously the coordination control method will be verified with real boats in the realistic environment to further enhance the reliability and the effectiveness of the proposed method acknowledgment this work was financially supported by the national natural science foundation of china grant numbers 52071100 51409054 and 51509055 at the same time we gratefully acknowledge the editor in chief the associate editor and the anonymous referees for their helpful comments and suggestions credit authorship contribution statement guoge tan conceptualization methodology software writing original draft writing review editing jiayuan zhuang validation funding acquisition writing review editing jin zou supervision project administration lei wan supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20696,the cavitation instability between two side by side cylinders at a constant reynolds number of 64 000 and four typical cavitation numbers σ 1 5 2 0 2 5 and 3 0 are investigated in this study large eddy simulation les method and zwart gerber belamri cavitation model are used to capture the dynamic and unsteady cavitation behaviors the results show that cavities around circular cylinders mainly originate in the free shear layers and can roughly be divided into band like cavities and clump like cavities when cavitation occurs the transition of shear layers is brought forward and the bi stable regime is no longer existing based on the vorticity equation the vortex dilatation is mainly concentrated in the shear layers of the two cylinders while the vortex stretching is concentrated in both shear layers and wakes the reynolds shear stress in spanwise for the down cylinder is significantly suppressed due to the interference effects while it is free from this suppression when cavitation occurs it follows that the interference effects of the two side by side cylinders could be weakened when cavitation occurs besides the mean drag coefficients will increase dramatically when cavitation occurs while the mean lift coefficients are little influenced keywords cavitation instability two side by side circular cylinders wake interference 1 introduction cavitation is a phenomenon that vapor cavities appear in an initially homogeneous liquid medium under certain conditions xu et al 2015 as a common phenomenon in hydrodynamic cavitation occurs in various hydraulic systems such as pumps turbines marine propellers underwater projectiles etc the unsteady nature of cavitation often leads to undesirable features wang et al 2001 including noise vibration power loss and erosion all these intrinsic characteristics have become the crucial problems to restrain the development of engineering devices therefore a comprehensive and detailed understanding of the physical mechanism of cavitation instability is necessary huang et al 2013 and this phenomenon continues to be an active research area brandner et al 2010 since cavitation was firstly observed numerous aspects of the physical mechanisms have been extensively studied over a hundred years christopherbrennen and brennen 1995 and great progress has been achieved concerning cavitation instability especially for cloud cavitation huang et al 2014 and zhao et al 2016 point out that cloud cavitation usually experiences the formation detachment and collapse processes and it behaves quasi periodic obviously though different types of cavities may occur for different hydrofoils foeth et al 2008 foeth et al 2006 have designed a twist hydrofoil and investigated the three dimensional unsteady characteristics of cavitation in detail it has been suggested that cavitating flow has highly three dimensional properties and is usually coupled with the vortical flow besides owing to the significant effects of cloud cavitation detachment or shedding on the flow field the shedding mechanism also has been received extensive attention brennen christopherbrennen and brennen 1995 argued that the coherent nature of cloud cavitation is due to natural instabilities or externally imposed ﬂow ﬂuctuations based on the origin of the cavitation unsteadiness franc 2001 proposed two main classes of instabilities intrinsic instabilities and system instabilities as for the intrinsic instabilities it results from the cavity itself for instance the well known re entrant jet instability and shock wave are two main classical intrinsic instabilities based on the parameter σ 2 α where σ is the cavitation number and α is the angle of hydrofoil attack arndt et al 2000 concluded that re entrant jet is responsible for cavity collapse for σ 2 α 4 while shock wave dominates the collapse at lower values on the other hand the system instabilities refer to the unsteady behaviors come from the interaction between the cavity and other cavities as in the case of a turbomachinery or other components of the hydraulic system callenaere et al 2001 cavitation surge when the constraint of the cavity tunnel is considered is a typical example of system instability considering the case in turbomachinery when cavity appears on one given blade it may also interact with the other cavities attached on the other blades according to the operating conditions rotating cavitation observed in inducers is a typical case in point tsujimoto 1995 apparently the interaction between various cavities significantly affects the cavity instabilities and this system instability is a much more common case in practice however most of the available literature is based on a single structure body regardless of a blunt body or streamlined body whereas practical engineer machinery is usually a multiple structure body little attention seems to have been given in the past to the cavitation interference performance though hydrofoils have the advantage of a geometry closer to the practical applications encountered in turbomachinery the geometry parameters such as attack angle are entangled with some critical cavitation parameters like the cavity thickness and the pressure gradient at closure which brings many difficulties and challenges callenaere et al 2001 for the study we planned it is better to control variadic parameters as simple as possible with the simplest geometry an infinitely long circular cylinder is a well rounded two dimensional bluff body compared with hydrofoil a circular cylinder has a uniform configuration that the curvature is constant along the wall the constant curvature of a circular cylinder makes the boundary layer separation which has an important effect on cavitation inception and development being determined solely by viscous effect wykes 1978 besides the characteristics of flow around a single circular cylinder and the interference effects of multiple cylinders for various arrangements have been studied extensively for single phase flow because of their wide engineering applications zdravkovich 1977 consequently exploring the characteristics of cavitating flow around two infinitely long cylinders close to each other could be an alternative to study the system cavitation instability under the interference effects as a fundamental research two side by side arrangement circular cylinders are chosen to be the present study model as for single phase flow around circular the flow regimes can be categorized as subcritical 300 re 3 105 critical 3 105 re 3 5 105 and supercritical re 3 5 105 corresponding to the flow wakes transition trw free shear layer transition trsl and boundary layer transition trbl respectively achenbach 1972 the extensive research findings regarding the flow around two side by side circular cylinders have also improved our understanding of the interference effects of the flow fields it is now well established that different center to center spacing ratios t d correspond to different flow regimes zhang and zhou 2001 when t d is less than 1 2 the two cylinders act like a single bluff body the shear layers only roll up at the free stream sides to form a single vortex street when t d 2 2 two coupled vortex streets appear either antiphase or in phase modes for t d 1 2 2 2 the flow regime is called bi stable regime with the gap flow between two cylinders is biased toward one side or the other forming one narrow wake nw mode and one wide wake ww mode the interference effects of intermediate spacing ratios t d 1 2 2 2 are relatively evident compared with large spacing ratios t d 2 2 and unlike the small spacing ratios t d 1 2 each cylinder can also behave its individual flow dynamics characteristics therefore an intermediate spacing ratio t d 1 5 is chosen to study the characteristics of cavitating flow around two side by side circular cylinders with the emphasis on the interference effects on the cavitation instability according to our literature survey there are relatively fewer studies considering cavitating flows around circular cylinders wykes 1978 carried out a set of detailed experiments to investigate viscous effects on cavitation types of cavitation inception occurring on the cylindrical test body with the reynolds number re mainly in 1 105 8 5 105 balachandar ramamurthy balachandar and ramamurthy 1999 examined the effect of cavitation on the base pressure coefficient gnanaskandan gnanaskandan and mahesh 2016 studied the near wake characteristics of cavitating flow over a circular cylinder at two low reynolds number re 200 and 3900 and found that cavitation significantly influence the evolution of pressure boundary layer and loads on the cylinder surface the effects of blockage factor on the cavitation zone and drag coefficients are studied by shalnev 1965 for an re range of 0 62 106 1 68 106 in the range of 1 105 re 8 5 105 ramamurthy and bhaskaran 1977 also experimented to determine the effects of wall interference on the drag and vortex shedding characteristics of cavitating circular cylinders the results show that the drag coefficient increases due to wall interference effects when partial cavitation conditions prevail the noise characteristics associated with cavity collapse were investigated in supercritical flow regime re 3 8 105 by s a fry fry 1984 following fry 1984 pankaj kumar kumar et al 2017 detected the cavitation inception through cavitation induced noise and presented cavitating structures in the near wake region through high speed imaging at subcritical flow reynolds number of 64 000 based on a review of the cavitating flow past a circular cylinder it could be found that most studies to date have examined the critical and supercritical flow regimes while there have few investigations in the upper subcritical flow region 20 000 re 200 000 in which some special observations could be found such as the phase drift szepessystefan 1994 and the organization of flow regimes maekawa and mizuno 1967 the effects of cavitation on the relevant phenomenon need to be explained step by step therefore the present study builds on the experimental work by pankaj kumar kumar et al 2017 of cavitating flow around a single circular cylinder at re 64 000 we extend our studies to explore the cavitation characteristics under the condition of interference effects between two blunt bodies firstly a side by side arrangement t d 1 5 circular cylinders model was established les turbulence approach in conjunction with zwart gerber belamri cavitation model was employed to capture certain mechanisms of cavitation we used the vof technique to track the interface between the liquid and vapor phases simulation results are compared with the experimental data kumar et al 2017 in detail then the unsteady cavitation behaviors around the two cylinders and cavity vortex interactions are analyzed finally the fluid forces acted on the cylinders are discussed 2 mathematical method 2 1 governing equations in the present study the governing equations for the multiphase flow namely the volume fraction of vapor conservation mass and navier stokes momentum conservation equations for a newtonian fluid can be written in the following forms 1 ρ v α v t ρ v α v u i x i m r e r c 2 ρ m t ρ m u i x i 0 3 ρ m u i t ρ m u i u j x j p x i x j μ m u i x j u j x i where i and j are cartesian tensor indices α v is the vapor volume fraction r e and r c are the mass transfer source terms connected to the vaporization and condensation processes respectively t u j p and x j represent time velocities mixture pressure and spatial coordinates respectively the mixture density ρ m and the laminar viscosity μ m are 4 ρ m α v ρ v 1 α v ρ l μ m α v μ v 1 α v μ l 5 where ρ l μ l are the liquid density and liquid viscosity it is well known that the turbulence effects should have significant impacts on the cavitating behaviors hence choosing an appropriate turbulent model is a key step to numerical calculation as xinping long et al 2018 gavaises et al 2015 egerer et al 2016 reviewed large eddy simulation has become increasingly applied in cavitation numerical study ji et al 2017 and it has been verified and validated in predicting complex cavitating flow the les turbulence approach is based on the filtered time dependent navier stokes equations the les equations can be obtained by applying a favre filtering 6 ρ m t ρ m u i x i 0 7 ρ m u i t ρ m u i u j x j p x i x j μ m u i x j u j x i τ i j x j where the sub grid scale stress tensor τ i j is defined as 8 τ i j ρ u i u j u i u j the sub grid scale stress can be modeled by the smagorinsky eddy viscosity model 9 τ i j 1 3 τ k k δ i j 2 μ t s i j where μ t is the sub grid scale turbulence viscosity and it is modeled by 10 μ t ρ l s 2 s 11 s 2 s i j s i j 12 s i j 1 2 u i x j u j x i where s i j is the rate of strain tensor l s is the mixing length and it can be computed by 13 l s min κ d c s v 1 3 where κ is the von kármán constant d is the distance to the closest wall c s is the smagorinsky constant and v is the volume of the local grid 2 2 physical cavitation model in the present paper the zwart gerber belamri cavitation models are adopted zwart et al 2004 which was used and validated to capture the characteristics of the cavitation widely during the evaporation and condensation processes the mass transfer is defined as equation 1 by neglecting the second order terms and the surface tension force the rayleigh plesset equation describing the single bubble dynamics can be simplified as 14 d r b dt 2 3 p v p ρ l where r b is the bubble radius p v is the saturated vapor pressure and p is the local liquid pressure the rate of change of the bubble m b can be calculated as 15 d m b dt ρ v d v b dt ρ v d dt 4 3 π r b 3 4 π ρ v r b 2 2 3 p v p ρ l where v b is the bubble volume and ρ v is the vapor density for zwart gerber belamri model all the bubbles in a system are assumed to have the same size the vapor volume fraction α v is given by 16 α v n b 4 3 π r b 3 where n b is the bubble number density and r b is the bubble radius thus the zwart gerber belamri model is expressed as follows if p pv 17 r e f vap 3 α nuc 1 α v ρ v r b 2 3 p v p ρ l if p pv 18 r c f cond 3 α v ρ v r b 2 3 p p v ρ l where f cond and f vap are empirical constant α nuc is the volume fraction of the nucleation site the parameters are r b 1 10 6 m and α nuc 5 10 4 the evaporation and condensation coefficients are f vap 50 and f cond 0 01 respectively 2 3 simulation setups as shown in fig 1 both of the computational domain and the imposed boundary conditions are illustrated the two side by side arrangement circular cylinders with a diameter of 10 mm are placed at the center of the water tunnel the present cases were based on the experiment of a closed recirculating water tunnel kumar et al 2017 the test section is 65 mm 65 mm in cross section and 200 mm in length a uniform velocity of 6 4 m s is specified at the inlet so that the reynolds number based on cylinder diameter is fixed at 64 000 the outlet pressure is set as reference pressure to adjust the different cavitation numbers no slip conditions are applied on the two circular cylinder walls both of which are assumed smooth note that the top and bottom as well as the other two sides of the water tunnel are all specified as symmetry boundary conditions to eliminate the influence of blockage which has been proved to be a significant factor for cavitation ramamurthy and bhaskaran 1977 only for the validation case they are specified as no slip wall conditions to keep consistent with the kumar kumar et al 2017 experiment setup other details of the water tunnel are given in kumar et al 2017 the fluid properties and some key parameters are given in table 1 the most two relevant non dimensionless parameters reynolds number re and cavitation number σ are given as follows 19 r e ρ u d μ 20 σ p p v 1 2 ρ u 2 where ρ u d and μ are density flow velocity the diameter of the cylinder and fluid viscosity respectively p v and p are the vapor pressure and the outlet pressure fig 2 shows the mesh of the computational domain a special grid refinement is applied at the walls of two cylinders to better resolve the boundary layer flow structures and the mesh in the vicinity of the two cylinders is also refined to capture the cavities and vortical structures in the shear layers and near wakes for a typical case at σ 1 5 the mean value of y is 2 6 though y 1 should be satisfied along the cylinders to fully resolved the turbulent boundary layer for the les turbulent model it is difficult to fulfill in cavitating flow because of the wide of density value in cavitation areas the total nodes are about 5 8 million the whole simulations were conducted base on the cfd code ansys fluent the time dependent governing equations are discretized in both the time and space domains the details of the employed discretization scheme are provided in table 2 a steady non cavitating flow simulation results were used as the initial flow field of the transient cavitating flow then the transient solver and the cavitation model were activated for the cavitating flow simulations the time step was set as δ t 1 10 4 which guarantees the mean value of cfl 0 9 and the maximum value of cfl 2 3 the cfl value was defined with the streamwise length of the mesh used in the present study 2 4 validation to validate the suitability of the numerical method in predicting cavitation flow around a single circular cylinder is simulated firstly the numerical results are compared with the experimental results of kumar kumar et al 2017 two typical cases the cavitating flow at σ 1 86 and non cavitating flow at re 64 000 was carefully validated fig 3 compares the mean pressure coefficient c p distribution along the circumference of the cylinder to the experimental data available in the literature kumar et al 2017 fig 4 presents the instantaneous cavitation morphology simulation result and experimental result based on kumar s uncertainty estimation the uncertainties in estimating re cavitation number σ and coefficient of pressure c p were determined to be 1 2 83 and 2 83 respectively kumar et al 2017 the differences between the real flow conditions and the simulation setups can lead to a slight discrepancy between the numerical results and experimental results in fig 3 it should be noted that there also exist some differences for cavitation morphology in fig 4 some small vapor bubbles and filaments downstream of the cylinder were not captured due to the limitations of the les approach and computational resource however we mainly focus on the interference effects on the dynamic characteristics of the large cavitation structures hence a compromise between flow details and computational cost was made besides the threshold value of vapor fraction α0 which reflects the internal structure of cavitating flow can also greatly affect the cavitation morphology the vapor fraction in the vaporized areas varies in the range 0 1 with bubbles of various sizes from a few μm to a few mm and they are affected not only by the periodic vapor cloud shedding but also by high frequency fluctuations coutier delgosha et al 2007 therefore it is very difficult to precisely estimate the vapor fraction in the vaporized areas no matter for experiment or simulation which can also lead to the discrepancy between the numerical and experimental results for cavitation morphology the threshold values of vapor fraction α0 used in fig 4 and later sections in this article just indicate the large scale cavitation structures hence some different threshold values are also employed to demonstrate the large cavitation structures clearly to validate the unsteady cavity dynamics further the frequency spectrum of the time series data of numerical vapor volume fraction and experimental greyscale intensity representing the cavitation level at two different locations p and q marked in fig 4 are compared in fig 5 the peak frequency of the numerical results f 248 hz for p and f 249 hz for q agree quite well with the peak in the greyscale intensity spectrum for the experimental results f 250 hz for both p and q besides the power spectrum density psd of the drag coefficient of the cylinder is also analyzed to evaluate the effectiveness of the employed numerical approach to capture the inertial scales of the flow field as shown in fig 6 the slope of the line enveloping the peaks in the inertial subrange follows the kolmogorov s 5 3 power spectrum law therefore the simulation scheme employed is reasonably reliable in predicting bluff body cavitation 3 numerical results and discussions 3 1 cavitation patterns fig 7 compares the mean void fraction for different cavitation number σ 1 5 σ 2 0 and 2 5 to display the difference of the cavity at various cavitation number clearly the cavity shape is represented by the vapor volume fraction α v 0 2 iso surface it should be noted that the cavity regions represented by α v 0 2 are just indicating some vapor bubbles because of low vapor volume fraction rather than the glossy and vapor filled regions like the sheet cavity occurs on hydrofoil as shown in fig 7 the cavities can roughly be divided into two regions i e band like cavities attached on the upper and lower walls of cylinders and clump like cavities behind the cylinders in the wake the attached band like cavities behave two dimensionality while the wake cavities behave obvious three dimensionality cavitation mainly occurs downstream of the cylinder within the wake for σ 2 5 and the extent of the detached cavitated region increased in an upstream direction and attach to the cylinder with σ decreasing sequentially which is in agreement with wykes s experimental results wykes 1978 checking the band like cavity regions in detail it could be found that the locations of cavity detachment points are similar at the corresponding region for the different cavitation numbers while they are quite different between inner cavity regions and outer cavity regions attached on the cylinders in outer cavity regions the cavity detachment occurs near θ 66 in comparison with the inner cavity region which takes places around θ 84 in the inner cavity this asymmetric detachment can be attributed to the interference effects of the shear layers between two cylinders besides it could be seen that the cavities roughly detach tangentially to the solid wall in the zoomed in which is a necessary condition for cavity detachment based on the villat armstrong criterion xu et al 2015 however this tangential detachment may also be attributed to the omission of surface tension in the present simulation as the surface tension could force the cavity to bend locally fig 8 illustrates the locations of cavity detachment points and boundary layers separation points mean velocity vectors are plotted over the mean pressure gradient contour along streamwise x direction c p m x c pm is the mean pressure coefficients for a cavitating flow and b non cavitating flow the purple lines in the inner cavity region are void fraction contour at α0 0 2 obviously the boundary layers separation points are downstream behind the cavity detachment points which is just contrary to the experimental data brandner et al 2010 that cavity detachment points move behind the separation points a similar observation was also reported in pendar and roohi 2018 gnanaskandan and mahesh 2016 for the homogeneous mixture model employed in the present study cavitation occurs once the local pressure drops below the vapor pressure however in real flows the liquids can sustain absolute pressures lower than the vapor pressure at the operating temperature and even negative pressures xu et al 2015 as a result the cavity detachment point may shift behind the separation point it can also be seen from fig 8 that the high adverse pressure gradient regions c p m x 250 are significantly different for various cavitation numbers with the decreasing of cavitation number the areas of high adverse pressure gradient regions and the maximum values of adverse pressure gradient decline the high adverse pressure gradient tends to prevent the cavity from extending significantly when the local pressure drops xu et al 2015 therefore the band like cavities seem more stable at higher cavitation numbers than that at the lower cavitation number which could also be proved in the following fig 9 to explore the transient characteristics of the cavitation in detail several typical snapshots of the three cavitation numbers are displayed in fig 9 as for the circular cylinders the overall cavity structures do not behave apparent periodicity like that of the hydrofoil therefore these typical instants i ii iii iv are depicted in the time history of the lift coefficients the cavity shape is represented by the vapor volume fraction α v 0 6 iso surface for all the three cavitation numbers the formation development and collapse processes are concentrated in the free shear layers 2 3d downstream of the cylinders at this subcritical reynolds number re 64 000 which are similar to the cavitating flow around a single circular cylinder kumar et al 2017 these characteristics can confidently be related to the shear layer behaviors of the fully wetted flow in theory by applying the divergence operator to the n s equations the pressure poisson equation can be deduced 21 δ p ρ ω 2 s 2 2 ρ q where ω is the vorticity tensor s is the strain rate tensor q is the certain quantity defined in section 3 2 2 the present numerical simulation results as seen in fig 11 show that the vorticity plays a dominant role compared with the strain rate tensor in the shear layers as a result the pressure level drops in the core of these shear layer vortices and the shear layers become the most potential areas of cavitation at σ 2 5 the leading edge of the cavity is band like attached along the spanwise of the cylinder with quasi periodical formation and breakup as shown in fig 7 the cavity lengths are too small and the adverse pressure gradient is relatively high as depicted in fig 8 therefore the band like cavity is relatively stable in streamwise as for the spanwise quasi periodical instability can be ascribed to the three dimensionality of the flow field wyke s wykes 1978 experiments show that the attached band like cavities are many microbubbles and they will degenerate to spot or lump at some instants due to the three dimensionality as the cavitation number σ decreases σ 2 and σ 1 5 the cavities behind the two cylinders become more complex different from the slender bodies when the boundary layers separate from the cylinder wall it gives rise to free shear layers and wakes where various kinds of vortices form develop and interact with each other morkovin 1964 all these vortices will become the cavitation sites once the core pressure drops under the saturated vapor pressure therefore the complex cavitation morphology is directly associated with the vorticity dynamics which will be discussed in detail in section 3 2 3 2 cavitation and vortex interactions 3 2 1 free shear layers fig 10 displays the typical instantaneous spanwise vorticity ω z iso surface ω z 4000 and ω z 5000 for different cavitation numbers which could highlight the shear layers of the two cylinders the most evident characteristic of the four flows is that the shear layers remain laminar for about 3d downstream for non cavitating flow yielding almost two dimensional shear layers both up the cylinder and down the cylinder however the shear layers soon breakup about 1d downstream for the other three cavitating flows σ 1 5 σ 2 σ 2 5 besides a narrow wake pattern nw and a wide wake ww pattern can also be observed in non cavitating flow σ 3 which is referred to bi stable regime or biased flow pattern the gap flow is relatively stable at both sides and deflects rather randomly from one side to the other as long as any perturbations occur such as inconsistency shedding of vortices from the two cylinders when cavitation occurs the high density gradient and the large pressure impulsion during collapse etc are all intense perturbations which could significantly affect the shear layers resulting in the breakup of shear layers therefore this bi stable regime is no longer existing once the cavitation occurs as the interference effects of two cylinders are mainly achieved by the interactions between the shear layers when cavitation occurs it can make the two dimensional shear layers breakup earlier and weaken the interference effects between two cylinders 3 2 2 effect on shedding vortex structures the interaction between the shedding cavities and the vortices motion could be visualized by synchronizing the evolution of cavitation and vortex structure with q criterion 39 in fig 11 which is a well known identification method of vortex and defined by the following equation in incompressible flow q 1 2 ω 2 s 2 21 where ω is the vorticity tensor s is the strain rate tensor q has a direct physical interpretation that the flow field is dominated by the vorticity when q 0 while it is dominated by the strain when q 0 which reflects the relative strength of the rotation and deformation of a fluid element xu et al 2018 as shown in fig 11 the cavitating flow behaves intensely vortical nature and a wide range of length scales as pointed out by morkovin 1964 the subcritical reynolds number re 64000 is in the upper subcritical flow regime trsl3 re 20 000 200 000 during which the shear layers will transition to turbulent flow under the effect of cavitation discussed above in section 3 2 1 the shear layers break up quickly once it detaches from the cylinder the chaotic turbulent structures in the wake are found to be dominated by the three dimensional streamwise vortices which implies the shear layers have transitioned to the turbulent regime during the whole process it can also be seen that the vortices in the wake of the two cylinders and the cavities present a strong interdependence the previous analysis suggests that the presence of cavitation leads to a misalignment of the vortex core position depending on the criteria used to better understand these behaviors the following vorticity transport equation can give as 22 d ω d t ω u ω u ρ m p ρ m 2 1 r e 2 ω the lhs of this equation denotes the rate of change of vorticity ω there are four terms on rhs describing the influence of vortex stretching dilatation baroclinic torque and dissipation respectively fig 12 shows their contributions to vorticity transport at various cavitation numbers at one typical instant the last diffusion term 1 r e 2 ω is not shown due to its much smaller effect on vorticity transport the first term on the right hand ω u is vortex stretching term which represents the enhancement of vorticity due to stretching the second term ω u is vortex dilatation term representing the expansion effects on the vorticity field the third term ρ m p ρ m 2 is called baroclinic torque term which results in a generation of vorticity because of misaligned the gradient of pressure from the gradient of density in a fluid in non cavitating flow vortex dilatation term and baroclinic torque term are both zeroes because of the constant density during a cavity shedding event baroclinic torque would produce or strengthen the vorticity provided the density gradients are not aligned with the pressure gradient as shown in fig 12 the impacted zone due to the baroclinic torque expands with the decrease of cavitation number it can also be seen in fig 9 that the cavity shedding and collapse occupy more areas for σ 1 5 and σ 2 0 though the baroclinic torque term also plays a necessary role in cavitating flows the stretching term and the dilatation term are most dominant for vorticity transport as the level magnitude of the baroclinic term is much smaller than the others in fig 12 similar phenomena in the cavitating flow around hydrofoil are also reported by ji et al correction ji et al 2014 it is well known that the vortex stretching term is the most significant mechanism in turbulent dynamics which is responsible for the turbulence energy cascade as the vortex stretching term is the only effective factor before cavitation inception the vortex stretching contour for non cavitating is also shown in fig 13 comparing two different cases it could be found that the vortex stretching in cavitating flow and non cavitating flow are of the same order of magnitude because the vortex stretching mainly occurs in the high velocity gradients area the vortex stretching as well as tilting and turning concentrates in the shear layers as well as near wakes of the two cylinders note that the vortex stretching term is just a change behavior of vorticity under the effect of velocity gradient rather than a source term of vorticity like baroclinic torque term using eqs 1 2 and 4 the relationship between cavity mass transfer rate and the velocity divergence can easily be obtained as follows 23 m r e r c ρ l ρ v ρ l ρ v u the vortex dilatation as depicted in fig 12 is related to the mass transfer of cavitation i e vaporization processes will weaken the vorticity ω u and the condensation process directly leads to the strengthening of vorticity in more detail the vortex dilatation is concentrated in the shear layers of the two cylinders where the cavities grow and shrink periodically compared with the vortex stretching effect the main difference between the two dominant transport terms vortex stretching and vortex dilation can be concluded the vortex stretching is directly dependent on the strong velocity gradient cavities affect the vortex stretching by changing the velocity field nearby and only have indirect effects on the contrary the inception development and collapse of cavities are directly responsible for the vortex dilation 3 3 turbulence features fig 14 shows the spanwise characteristics of reynolds shear stress u w u 0 2 in the near wake of two side by side cylinders at different cavitation numbers the single cylinder s reynolds shear stress evolution is also presented in fig 15 for comparison x d is the streamwise distance apart from the center of the cylinders it can be seen from fig 14 that the turbulence characteristics of the near wake of side by side cylinders show a significant difference when cavitation occurs for non cavitation the reynolds shear stress increases firstly and then decreases which is consistent with the results of xiang qiu et al 2017 besides the reynolds shear stress does not present any symmetry due to the interference between two cylinders as discussed above on the contrary when cavitation occurs the reynolds shear stress increases at shear layers regions around z d 0 25 1 25 gradually as the x d increases the reynolds shear stress remains self similar roughly for σ 2 5 and σ 2 0 when x d 1 5 2 5 while it increases significantly for σ 1 5 when x d 2 5 combined with the discussion 3 2 2 it can be expected that the larger areas that cavities occupy will cause the corresponding turbulent intensity to increase comparing the non cavitation at σ 3 0 with the other three cavitation cases it can be found that the reynolds shear stress in spanwise for the down cylinder is significantly suppressed due to the interference effects while it is free from this suppression when cavitation occurs to sum up cavitation tends to make the reynolds shear stress anti symmetry with respect to z d 0 in other words the average value of turbulence fluctuation momentum flux tends to be consistent behind the two cylinders when cavitation occurs these anti symmetry distributions are similar to that of a single cylinder qualitatively as shown in fig 15 which suggests that each cylinder forms a relatively independent single vortex street downstream therefore the conclusion can be drawn that the interference effects on the turbulence fluctuations between the two side by side cylinders could be weakened when cavitation occurs 3 4 fluid forces as demonstrated in 3 1 1 cavitation mainly occurs in shear layers with the band like cavities periodic formation and breakup along the spanwise of the cylinders it can be inferred that the fluid forces acting on the two cylinders are certainly affected by this cavitation behavior to analyze the fluid forces acting on the cylinders the dimensionless coefficients cl cd and c pm can be defined as below 24 c l f l 1 2 ρ u 2 d h 25 c d f d 1 2 ρ u 2 d h 26 c p m p m p r e f 1 2 ρ u 2 where f l and f d are lift and drag forces respectively h is the spanwise length of the cylinder p m is the mean static pressure and p ref is the reference pressure of undisturbed point upstream fig 16 shows the mean drag and lift coefficients of the two cylinders for different cavitation numbers cd up and cl up represent the upper cylinder drag and lift coefficients respectively while the drag and lift coefficients of the bottom cylinder are represented by cd down and cl down shown in fig 1 it can be seen from the figure that cavitation has more effects on drag coefficients than on lift coefficients in the case of drag coefficients the values of cd increase significantly when cavitation occurs fig 17 illustrates the mean pressure coefficients distribution along the circumferential direction on the mid plane of the cylinder wall for clarity only the mean pressure coefficients of the down cylinder are shown as it is similar to that of the up cylinder as seen in fig 17 the mean pressure coefficients of the leeward side experience an apparent decline about 56 while it remains fairly unchanged once cavitation occurs therefore it can be expected that the resultant force in streamwise i e the drag force will increase note that under this side by side arrangement t d 1 5 two values of cd cd up 1 08 nw mode cd down 0 90 ww mode are separated at σ 3 non cavitating due to the biased flow pattern as discussed in 3 2 1 which is consistent with the result of alam et al 2003 with the decrease of the cavitation number this difference between the magnitude of cd for nw and ww modes becomes smaller and smaller from this point of view it can also prove that the interference effects between two side by side cylinders are weakened once the cavitation occurs as for the lift coefficients the magnitude of cl roughly remains unchanged with the opposite direction and behaves as a repulsive outward direction force between two cylinders which can also easily be conjectured from fig 17 under this side by side arrangement t d 1 5 this repulsive effect due to the inward movement of stagnations is also consistent with the previous investigations by alam et al 2003 in conclusion the mean drag coefficients will increase dramatically when cavitation occurs while the mean lift coefficients are little influenced 4 conclusions the unsteady cavitating flow around two side by side circular cylinders at a reynolds number of 64 000 were numerically investigated three typical cavitation cases at σ 1 5 σ 2 σ 2 5 and non cavitation case at σ 3 were compared with each other in details the main conclusions can be drawn as follows 1 cavities around circular cylinders can roughly be divided into two regions band like cavities attached on the cylinder walls and clump like cavities behind the cylinders they mainly originate in the free shear layers and concentrate in 2 3d downstream at subcritical re 64 000 2 when cavitation occurs the transition of shear layers is brought forward and the bi stable regime is no longer existing which weakens the interference effects between two cylinders significantly based on the vorticity equation the vortex dilatation is mainly concentrated in the shear layers of the two cylinders while the vortex stretching is concentrated in both shear layers and wakes due to the high velocity gradient 3 the interference effects on the turbulence fluctuations between the two side by side cylinders could be weakened when cavitation occurs furthermore the reynolds shear stress in spanwise for the down cylinder is significantly suppressed due to the interference effects while it is free from this suppression when cavitation occurs 4 the mean drag coefficients will increase dramatically when cavitation occurs while the mean lift coefficients are little influenced credit authorship contribution statement longlong yan conceptualization methodology software data curation writing original draft bo gao supervision resources dan ni funding acquisition ning zhang funding acquisition wenjie zhou funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors gratefully acknowledge the financial support of the national science foundation of china 51576090 51706087 51706086 a project funded by six talent peaks project in jiangsu province kthy 060 the key research and development program of zhenjiang grant no gy2018023 the project funded by china postdoctoral science foundation grant no 2018m642177 
20696,the cavitation instability between two side by side cylinders at a constant reynolds number of 64 000 and four typical cavitation numbers σ 1 5 2 0 2 5 and 3 0 are investigated in this study large eddy simulation les method and zwart gerber belamri cavitation model are used to capture the dynamic and unsteady cavitation behaviors the results show that cavities around circular cylinders mainly originate in the free shear layers and can roughly be divided into band like cavities and clump like cavities when cavitation occurs the transition of shear layers is brought forward and the bi stable regime is no longer existing based on the vorticity equation the vortex dilatation is mainly concentrated in the shear layers of the two cylinders while the vortex stretching is concentrated in both shear layers and wakes the reynolds shear stress in spanwise for the down cylinder is significantly suppressed due to the interference effects while it is free from this suppression when cavitation occurs it follows that the interference effects of the two side by side cylinders could be weakened when cavitation occurs besides the mean drag coefficients will increase dramatically when cavitation occurs while the mean lift coefficients are little influenced keywords cavitation instability two side by side circular cylinders wake interference 1 introduction cavitation is a phenomenon that vapor cavities appear in an initially homogeneous liquid medium under certain conditions xu et al 2015 as a common phenomenon in hydrodynamic cavitation occurs in various hydraulic systems such as pumps turbines marine propellers underwater projectiles etc the unsteady nature of cavitation often leads to undesirable features wang et al 2001 including noise vibration power loss and erosion all these intrinsic characteristics have become the crucial problems to restrain the development of engineering devices therefore a comprehensive and detailed understanding of the physical mechanism of cavitation instability is necessary huang et al 2013 and this phenomenon continues to be an active research area brandner et al 2010 since cavitation was firstly observed numerous aspects of the physical mechanisms have been extensively studied over a hundred years christopherbrennen and brennen 1995 and great progress has been achieved concerning cavitation instability especially for cloud cavitation huang et al 2014 and zhao et al 2016 point out that cloud cavitation usually experiences the formation detachment and collapse processes and it behaves quasi periodic obviously though different types of cavities may occur for different hydrofoils foeth et al 2008 foeth et al 2006 have designed a twist hydrofoil and investigated the three dimensional unsteady characteristics of cavitation in detail it has been suggested that cavitating flow has highly three dimensional properties and is usually coupled with the vortical flow besides owing to the significant effects of cloud cavitation detachment or shedding on the flow field the shedding mechanism also has been received extensive attention brennen christopherbrennen and brennen 1995 argued that the coherent nature of cloud cavitation is due to natural instabilities or externally imposed ﬂow ﬂuctuations based on the origin of the cavitation unsteadiness franc 2001 proposed two main classes of instabilities intrinsic instabilities and system instabilities as for the intrinsic instabilities it results from the cavity itself for instance the well known re entrant jet instability and shock wave are two main classical intrinsic instabilities based on the parameter σ 2 α where σ is the cavitation number and α is the angle of hydrofoil attack arndt et al 2000 concluded that re entrant jet is responsible for cavity collapse for σ 2 α 4 while shock wave dominates the collapse at lower values on the other hand the system instabilities refer to the unsteady behaviors come from the interaction between the cavity and other cavities as in the case of a turbomachinery or other components of the hydraulic system callenaere et al 2001 cavitation surge when the constraint of the cavity tunnel is considered is a typical example of system instability considering the case in turbomachinery when cavity appears on one given blade it may also interact with the other cavities attached on the other blades according to the operating conditions rotating cavitation observed in inducers is a typical case in point tsujimoto 1995 apparently the interaction between various cavities significantly affects the cavity instabilities and this system instability is a much more common case in practice however most of the available literature is based on a single structure body regardless of a blunt body or streamlined body whereas practical engineer machinery is usually a multiple structure body little attention seems to have been given in the past to the cavitation interference performance though hydrofoils have the advantage of a geometry closer to the practical applications encountered in turbomachinery the geometry parameters such as attack angle are entangled with some critical cavitation parameters like the cavity thickness and the pressure gradient at closure which brings many difficulties and challenges callenaere et al 2001 for the study we planned it is better to control variadic parameters as simple as possible with the simplest geometry an infinitely long circular cylinder is a well rounded two dimensional bluff body compared with hydrofoil a circular cylinder has a uniform configuration that the curvature is constant along the wall the constant curvature of a circular cylinder makes the boundary layer separation which has an important effect on cavitation inception and development being determined solely by viscous effect wykes 1978 besides the characteristics of flow around a single circular cylinder and the interference effects of multiple cylinders for various arrangements have been studied extensively for single phase flow because of their wide engineering applications zdravkovich 1977 consequently exploring the characteristics of cavitating flow around two infinitely long cylinders close to each other could be an alternative to study the system cavitation instability under the interference effects as a fundamental research two side by side arrangement circular cylinders are chosen to be the present study model as for single phase flow around circular the flow regimes can be categorized as subcritical 300 re 3 105 critical 3 105 re 3 5 105 and supercritical re 3 5 105 corresponding to the flow wakes transition trw free shear layer transition trsl and boundary layer transition trbl respectively achenbach 1972 the extensive research findings regarding the flow around two side by side circular cylinders have also improved our understanding of the interference effects of the flow fields it is now well established that different center to center spacing ratios t d correspond to different flow regimes zhang and zhou 2001 when t d is less than 1 2 the two cylinders act like a single bluff body the shear layers only roll up at the free stream sides to form a single vortex street when t d 2 2 two coupled vortex streets appear either antiphase or in phase modes for t d 1 2 2 2 the flow regime is called bi stable regime with the gap flow between two cylinders is biased toward one side or the other forming one narrow wake nw mode and one wide wake ww mode the interference effects of intermediate spacing ratios t d 1 2 2 2 are relatively evident compared with large spacing ratios t d 2 2 and unlike the small spacing ratios t d 1 2 each cylinder can also behave its individual flow dynamics characteristics therefore an intermediate spacing ratio t d 1 5 is chosen to study the characteristics of cavitating flow around two side by side circular cylinders with the emphasis on the interference effects on the cavitation instability according to our literature survey there are relatively fewer studies considering cavitating flows around circular cylinders wykes 1978 carried out a set of detailed experiments to investigate viscous effects on cavitation types of cavitation inception occurring on the cylindrical test body with the reynolds number re mainly in 1 105 8 5 105 balachandar ramamurthy balachandar and ramamurthy 1999 examined the effect of cavitation on the base pressure coefficient gnanaskandan gnanaskandan and mahesh 2016 studied the near wake characteristics of cavitating flow over a circular cylinder at two low reynolds number re 200 and 3900 and found that cavitation significantly influence the evolution of pressure boundary layer and loads on the cylinder surface the effects of blockage factor on the cavitation zone and drag coefficients are studied by shalnev 1965 for an re range of 0 62 106 1 68 106 in the range of 1 105 re 8 5 105 ramamurthy and bhaskaran 1977 also experimented to determine the effects of wall interference on the drag and vortex shedding characteristics of cavitating circular cylinders the results show that the drag coefficient increases due to wall interference effects when partial cavitation conditions prevail the noise characteristics associated with cavity collapse were investigated in supercritical flow regime re 3 8 105 by s a fry fry 1984 following fry 1984 pankaj kumar kumar et al 2017 detected the cavitation inception through cavitation induced noise and presented cavitating structures in the near wake region through high speed imaging at subcritical flow reynolds number of 64 000 based on a review of the cavitating flow past a circular cylinder it could be found that most studies to date have examined the critical and supercritical flow regimes while there have few investigations in the upper subcritical flow region 20 000 re 200 000 in which some special observations could be found such as the phase drift szepessystefan 1994 and the organization of flow regimes maekawa and mizuno 1967 the effects of cavitation on the relevant phenomenon need to be explained step by step therefore the present study builds on the experimental work by pankaj kumar kumar et al 2017 of cavitating flow around a single circular cylinder at re 64 000 we extend our studies to explore the cavitation characteristics under the condition of interference effects between two blunt bodies firstly a side by side arrangement t d 1 5 circular cylinders model was established les turbulence approach in conjunction with zwart gerber belamri cavitation model was employed to capture certain mechanisms of cavitation we used the vof technique to track the interface between the liquid and vapor phases simulation results are compared with the experimental data kumar et al 2017 in detail then the unsteady cavitation behaviors around the two cylinders and cavity vortex interactions are analyzed finally the fluid forces acted on the cylinders are discussed 2 mathematical method 2 1 governing equations in the present study the governing equations for the multiphase flow namely the volume fraction of vapor conservation mass and navier stokes momentum conservation equations for a newtonian fluid can be written in the following forms 1 ρ v α v t ρ v α v u i x i m r e r c 2 ρ m t ρ m u i x i 0 3 ρ m u i t ρ m u i u j x j p x i x j μ m u i x j u j x i where i and j are cartesian tensor indices α v is the vapor volume fraction r e and r c are the mass transfer source terms connected to the vaporization and condensation processes respectively t u j p and x j represent time velocities mixture pressure and spatial coordinates respectively the mixture density ρ m and the laminar viscosity μ m are 4 ρ m α v ρ v 1 α v ρ l μ m α v μ v 1 α v μ l 5 where ρ l μ l are the liquid density and liquid viscosity it is well known that the turbulence effects should have significant impacts on the cavitating behaviors hence choosing an appropriate turbulent model is a key step to numerical calculation as xinping long et al 2018 gavaises et al 2015 egerer et al 2016 reviewed large eddy simulation has become increasingly applied in cavitation numerical study ji et al 2017 and it has been verified and validated in predicting complex cavitating flow the les turbulence approach is based on the filtered time dependent navier stokes equations the les equations can be obtained by applying a favre filtering 6 ρ m t ρ m u i x i 0 7 ρ m u i t ρ m u i u j x j p x i x j μ m u i x j u j x i τ i j x j where the sub grid scale stress tensor τ i j is defined as 8 τ i j ρ u i u j u i u j the sub grid scale stress can be modeled by the smagorinsky eddy viscosity model 9 τ i j 1 3 τ k k δ i j 2 μ t s i j where μ t is the sub grid scale turbulence viscosity and it is modeled by 10 μ t ρ l s 2 s 11 s 2 s i j s i j 12 s i j 1 2 u i x j u j x i where s i j is the rate of strain tensor l s is the mixing length and it can be computed by 13 l s min κ d c s v 1 3 where κ is the von kármán constant d is the distance to the closest wall c s is the smagorinsky constant and v is the volume of the local grid 2 2 physical cavitation model in the present paper the zwart gerber belamri cavitation models are adopted zwart et al 2004 which was used and validated to capture the characteristics of the cavitation widely during the evaporation and condensation processes the mass transfer is defined as equation 1 by neglecting the second order terms and the surface tension force the rayleigh plesset equation describing the single bubble dynamics can be simplified as 14 d r b dt 2 3 p v p ρ l where r b is the bubble radius p v is the saturated vapor pressure and p is the local liquid pressure the rate of change of the bubble m b can be calculated as 15 d m b dt ρ v d v b dt ρ v d dt 4 3 π r b 3 4 π ρ v r b 2 2 3 p v p ρ l where v b is the bubble volume and ρ v is the vapor density for zwart gerber belamri model all the bubbles in a system are assumed to have the same size the vapor volume fraction α v is given by 16 α v n b 4 3 π r b 3 where n b is the bubble number density and r b is the bubble radius thus the zwart gerber belamri model is expressed as follows if p pv 17 r e f vap 3 α nuc 1 α v ρ v r b 2 3 p v p ρ l if p pv 18 r c f cond 3 α v ρ v r b 2 3 p p v ρ l where f cond and f vap are empirical constant α nuc is the volume fraction of the nucleation site the parameters are r b 1 10 6 m and α nuc 5 10 4 the evaporation and condensation coefficients are f vap 50 and f cond 0 01 respectively 2 3 simulation setups as shown in fig 1 both of the computational domain and the imposed boundary conditions are illustrated the two side by side arrangement circular cylinders with a diameter of 10 mm are placed at the center of the water tunnel the present cases were based on the experiment of a closed recirculating water tunnel kumar et al 2017 the test section is 65 mm 65 mm in cross section and 200 mm in length a uniform velocity of 6 4 m s is specified at the inlet so that the reynolds number based on cylinder diameter is fixed at 64 000 the outlet pressure is set as reference pressure to adjust the different cavitation numbers no slip conditions are applied on the two circular cylinder walls both of which are assumed smooth note that the top and bottom as well as the other two sides of the water tunnel are all specified as symmetry boundary conditions to eliminate the influence of blockage which has been proved to be a significant factor for cavitation ramamurthy and bhaskaran 1977 only for the validation case they are specified as no slip wall conditions to keep consistent with the kumar kumar et al 2017 experiment setup other details of the water tunnel are given in kumar et al 2017 the fluid properties and some key parameters are given in table 1 the most two relevant non dimensionless parameters reynolds number re and cavitation number σ are given as follows 19 r e ρ u d μ 20 σ p p v 1 2 ρ u 2 where ρ u d and μ are density flow velocity the diameter of the cylinder and fluid viscosity respectively p v and p are the vapor pressure and the outlet pressure fig 2 shows the mesh of the computational domain a special grid refinement is applied at the walls of two cylinders to better resolve the boundary layer flow structures and the mesh in the vicinity of the two cylinders is also refined to capture the cavities and vortical structures in the shear layers and near wakes for a typical case at σ 1 5 the mean value of y is 2 6 though y 1 should be satisfied along the cylinders to fully resolved the turbulent boundary layer for the les turbulent model it is difficult to fulfill in cavitating flow because of the wide of density value in cavitation areas the total nodes are about 5 8 million the whole simulations were conducted base on the cfd code ansys fluent the time dependent governing equations are discretized in both the time and space domains the details of the employed discretization scheme are provided in table 2 a steady non cavitating flow simulation results were used as the initial flow field of the transient cavitating flow then the transient solver and the cavitation model were activated for the cavitating flow simulations the time step was set as δ t 1 10 4 which guarantees the mean value of cfl 0 9 and the maximum value of cfl 2 3 the cfl value was defined with the streamwise length of the mesh used in the present study 2 4 validation to validate the suitability of the numerical method in predicting cavitation flow around a single circular cylinder is simulated firstly the numerical results are compared with the experimental results of kumar kumar et al 2017 two typical cases the cavitating flow at σ 1 86 and non cavitating flow at re 64 000 was carefully validated fig 3 compares the mean pressure coefficient c p distribution along the circumference of the cylinder to the experimental data available in the literature kumar et al 2017 fig 4 presents the instantaneous cavitation morphology simulation result and experimental result based on kumar s uncertainty estimation the uncertainties in estimating re cavitation number σ and coefficient of pressure c p were determined to be 1 2 83 and 2 83 respectively kumar et al 2017 the differences between the real flow conditions and the simulation setups can lead to a slight discrepancy between the numerical results and experimental results in fig 3 it should be noted that there also exist some differences for cavitation morphology in fig 4 some small vapor bubbles and filaments downstream of the cylinder were not captured due to the limitations of the les approach and computational resource however we mainly focus on the interference effects on the dynamic characteristics of the large cavitation structures hence a compromise between flow details and computational cost was made besides the threshold value of vapor fraction α0 which reflects the internal structure of cavitating flow can also greatly affect the cavitation morphology the vapor fraction in the vaporized areas varies in the range 0 1 with bubbles of various sizes from a few μm to a few mm and they are affected not only by the periodic vapor cloud shedding but also by high frequency fluctuations coutier delgosha et al 2007 therefore it is very difficult to precisely estimate the vapor fraction in the vaporized areas no matter for experiment or simulation which can also lead to the discrepancy between the numerical and experimental results for cavitation morphology the threshold values of vapor fraction α0 used in fig 4 and later sections in this article just indicate the large scale cavitation structures hence some different threshold values are also employed to demonstrate the large cavitation structures clearly to validate the unsteady cavity dynamics further the frequency spectrum of the time series data of numerical vapor volume fraction and experimental greyscale intensity representing the cavitation level at two different locations p and q marked in fig 4 are compared in fig 5 the peak frequency of the numerical results f 248 hz for p and f 249 hz for q agree quite well with the peak in the greyscale intensity spectrum for the experimental results f 250 hz for both p and q besides the power spectrum density psd of the drag coefficient of the cylinder is also analyzed to evaluate the effectiveness of the employed numerical approach to capture the inertial scales of the flow field as shown in fig 6 the slope of the line enveloping the peaks in the inertial subrange follows the kolmogorov s 5 3 power spectrum law therefore the simulation scheme employed is reasonably reliable in predicting bluff body cavitation 3 numerical results and discussions 3 1 cavitation patterns fig 7 compares the mean void fraction for different cavitation number σ 1 5 σ 2 0 and 2 5 to display the difference of the cavity at various cavitation number clearly the cavity shape is represented by the vapor volume fraction α v 0 2 iso surface it should be noted that the cavity regions represented by α v 0 2 are just indicating some vapor bubbles because of low vapor volume fraction rather than the glossy and vapor filled regions like the sheet cavity occurs on hydrofoil as shown in fig 7 the cavities can roughly be divided into two regions i e band like cavities attached on the upper and lower walls of cylinders and clump like cavities behind the cylinders in the wake the attached band like cavities behave two dimensionality while the wake cavities behave obvious three dimensionality cavitation mainly occurs downstream of the cylinder within the wake for σ 2 5 and the extent of the detached cavitated region increased in an upstream direction and attach to the cylinder with σ decreasing sequentially which is in agreement with wykes s experimental results wykes 1978 checking the band like cavity regions in detail it could be found that the locations of cavity detachment points are similar at the corresponding region for the different cavitation numbers while they are quite different between inner cavity regions and outer cavity regions attached on the cylinders in outer cavity regions the cavity detachment occurs near θ 66 in comparison with the inner cavity region which takes places around θ 84 in the inner cavity this asymmetric detachment can be attributed to the interference effects of the shear layers between two cylinders besides it could be seen that the cavities roughly detach tangentially to the solid wall in the zoomed in which is a necessary condition for cavity detachment based on the villat armstrong criterion xu et al 2015 however this tangential detachment may also be attributed to the omission of surface tension in the present simulation as the surface tension could force the cavity to bend locally fig 8 illustrates the locations of cavity detachment points and boundary layers separation points mean velocity vectors are plotted over the mean pressure gradient contour along streamwise x direction c p m x c pm is the mean pressure coefficients for a cavitating flow and b non cavitating flow the purple lines in the inner cavity region are void fraction contour at α0 0 2 obviously the boundary layers separation points are downstream behind the cavity detachment points which is just contrary to the experimental data brandner et al 2010 that cavity detachment points move behind the separation points a similar observation was also reported in pendar and roohi 2018 gnanaskandan and mahesh 2016 for the homogeneous mixture model employed in the present study cavitation occurs once the local pressure drops below the vapor pressure however in real flows the liquids can sustain absolute pressures lower than the vapor pressure at the operating temperature and even negative pressures xu et al 2015 as a result the cavity detachment point may shift behind the separation point it can also be seen from fig 8 that the high adverse pressure gradient regions c p m x 250 are significantly different for various cavitation numbers with the decreasing of cavitation number the areas of high adverse pressure gradient regions and the maximum values of adverse pressure gradient decline the high adverse pressure gradient tends to prevent the cavity from extending significantly when the local pressure drops xu et al 2015 therefore the band like cavities seem more stable at higher cavitation numbers than that at the lower cavitation number which could also be proved in the following fig 9 to explore the transient characteristics of the cavitation in detail several typical snapshots of the three cavitation numbers are displayed in fig 9 as for the circular cylinders the overall cavity structures do not behave apparent periodicity like that of the hydrofoil therefore these typical instants i ii iii iv are depicted in the time history of the lift coefficients the cavity shape is represented by the vapor volume fraction α v 0 6 iso surface for all the three cavitation numbers the formation development and collapse processes are concentrated in the free shear layers 2 3d downstream of the cylinders at this subcritical reynolds number re 64 000 which are similar to the cavitating flow around a single circular cylinder kumar et al 2017 these characteristics can confidently be related to the shear layer behaviors of the fully wetted flow in theory by applying the divergence operator to the n s equations the pressure poisson equation can be deduced 21 δ p ρ ω 2 s 2 2 ρ q where ω is the vorticity tensor s is the strain rate tensor q is the certain quantity defined in section 3 2 2 the present numerical simulation results as seen in fig 11 show that the vorticity plays a dominant role compared with the strain rate tensor in the shear layers as a result the pressure level drops in the core of these shear layer vortices and the shear layers become the most potential areas of cavitation at σ 2 5 the leading edge of the cavity is band like attached along the spanwise of the cylinder with quasi periodical formation and breakup as shown in fig 7 the cavity lengths are too small and the adverse pressure gradient is relatively high as depicted in fig 8 therefore the band like cavity is relatively stable in streamwise as for the spanwise quasi periodical instability can be ascribed to the three dimensionality of the flow field wyke s wykes 1978 experiments show that the attached band like cavities are many microbubbles and they will degenerate to spot or lump at some instants due to the three dimensionality as the cavitation number σ decreases σ 2 and σ 1 5 the cavities behind the two cylinders become more complex different from the slender bodies when the boundary layers separate from the cylinder wall it gives rise to free shear layers and wakes where various kinds of vortices form develop and interact with each other morkovin 1964 all these vortices will become the cavitation sites once the core pressure drops under the saturated vapor pressure therefore the complex cavitation morphology is directly associated with the vorticity dynamics which will be discussed in detail in section 3 2 3 2 cavitation and vortex interactions 3 2 1 free shear layers fig 10 displays the typical instantaneous spanwise vorticity ω z iso surface ω z 4000 and ω z 5000 for different cavitation numbers which could highlight the shear layers of the two cylinders the most evident characteristic of the four flows is that the shear layers remain laminar for about 3d downstream for non cavitating flow yielding almost two dimensional shear layers both up the cylinder and down the cylinder however the shear layers soon breakup about 1d downstream for the other three cavitating flows σ 1 5 σ 2 σ 2 5 besides a narrow wake pattern nw and a wide wake ww pattern can also be observed in non cavitating flow σ 3 which is referred to bi stable regime or biased flow pattern the gap flow is relatively stable at both sides and deflects rather randomly from one side to the other as long as any perturbations occur such as inconsistency shedding of vortices from the two cylinders when cavitation occurs the high density gradient and the large pressure impulsion during collapse etc are all intense perturbations which could significantly affect the shear layers resulting in the breakup of shear layers therefore this bi stable regime is no longer existing once the cavitation occurs as the interference effects of two cylinders are mainly achieved by the interactions between the shear layers when cavitation occurs it can make the two dimensional shear layers breakup earlier and weaken the interference effects between two cylinders 3 2 2 effect on shedding vortex structures the interaction between the shedding cavities and the vortices motion could be visualized by synchronizing the evolution of cavitation and vortex structure with q criterion 39 in fig 11 which is a well known identification method of vortex and defined by the following equation in incompressible flow q 1 2 ω 2 s 2 21 where ω is the vorticity tensor s is the strain rate tensor q has a direct physical interpretation that the flow field is dominated by the vorticity when q 0 while it is dominated by the strain when q 0 which reflects the relative strength of the rotation and deformation of a fluid element xu et al 2018 as shown in fig 11 the cavitating flow behaves intensely vortical nature and a wide range of length scales as pointed out by morkovin 1964 the subcritical reynolds number re 64000 is in the upper subcritical flow regime trsl3 re 20 000 200 000 during which the shear layers will transition to turbulent flow under the effect of cavitation discussed above in section 3 2 1 the shear layers break up quickly once it detaches from the cylinder the chaotic turbulent structures in the wake are found to be dominated by the three dimensional streamwise vortices which implies the shear layers have transitioned to the turbulent regime during the whole process it can also be seen that the vortices in the wake of the two cylinders and the cavities present a strong interdependence the previous analysis suggests that the presence of cavitation leads to a misalignment of the vortex core position depending on the criteria used to better understand these behaviors the following vorticity transport equation can give as 22 d ω d t ω u ω u ρ m p ρ m 2 1 r e 2 ω the lhs of this equation denotes the rate of change of vorticity ω there are four terms on rhs describing the influence of vortex stretching dilatation baroclinic torque and dissipation respectively fig 12 shows their contributions to vorticity transport at various cavitation numbers at one typical instant the last diffusion term 1 r e 2 ω is not shown due to its much smaller effect on vorticity transport the first term on the right hand ω u is vortex stretching term which represents the enhancement of vorticity due to stretching the second term ω u is vortex dilatation term representing the expansion effects on the vorticity field the third term ρ m p ρ m 2 is called baroclinic torque term which results in a generation of vorticity because of misaligned the gradient of pressure from the gradient of density in a fluid in non cavitating flow vortex dilatation term and baroclinic torque term are both zeroes because of the constant density during a cavity shedding event baroclinic torque would produce or strengthen the vorticity provided the density gradients are not aligned with the pressure gradient as shown in fig 12 the impacted zone due to the baroclinic torque expands with the decrease of cavitation number it can also be seen in fig 9 that the cavity shedding and collapse occupy more areas for σ 1 5 and σ 2 0 though the baroclinic torque term also plays a necessary role in cavitating flows the stretching term and the dilatation term are most dominant for vorticity transport as the level magnitude of the baroclinic term is much smaller than the others in fig 12 similar phenomena in the cavitating flow around hydrofoil are also reported by ji et al correction ji et al 2014 it is well known that the vortex stretching term is the most significant mechanism in turbulent dynamics which is responsible for the turbulence energy cascade as the vortex stretching term is the only effective factor before cavitation inception the vortex stretching contour for non cavitating is also shown in fig 13 comparing two different cases it could be found that the vortex stretching in cavitating flow and non cavitating flow are of the same order of magnitude because the vortex stretching mainly occurs in the high velocity gradients area the vortex stretching as well as tilting and turning concentrates in the shear layers as well as near wakes of the two cylinders note that the vortex stretching term is just a change behavior of vorticity under the effect of velocity gradient rather than a source term of vorticity like baroclinic torque term using eqs 1 2 and 4 the relationship between cavity mass transfer rate and the velocity divergence can easily be obtained as follows 23 m r e r c ρ l ρ v ρ l ρ v u the vortex dilatation as depicted in fig 12 is related to the mass transfer of cavitation i e vaporization processes will weaken the vorticity ω u and the condensation process directly leads to the strengthening of vorticity in more detail the vortex dilatation is concentrated in the shear layers of the two cylinders where the cavities grow and shrink periodically compared with the vortex stretching effect the main difference between the two dominant transport terms vortex stretching and vortex dilation can be concluded the vortex stretching is directly dependent on the strong velocity gradient cavities affect the vortex stretching by changing the velocity field nearby and only have indirect effects on the contrary the inception development and collapse of cavities are directly responsible for the vortex dilation 3 3 turbulence features fig 14 shows the spanwise characteristics of reynolds shear stress u w u 0 2 in the near wake of two side by side cylinders at different cavitation numbers the single cylinder s reynolds shear stress evolution is also presented in fig 15 for comparison x d is the streamwise distance apart from the center of the cylinders it can be seen from fig 14 that the turbulence characteristics of the near wake of side by side cylinders show a significant difference when cavitation occurs for non cavitation the reynolds shear stress increases firstly and then decreases which is consistent with the results of xiang qiu et al 2017 besides the reynolds shear stress does not present any symmetry due to the interference between two cylinders as discussed above on the contrary when cavitation occurs the reynolds shear stress increases at shear layers regions around z d 0 25 1 25 gradually as the x d increases the reynolds shear stress remains self similar roughly for σ 2 5 and σ 2 0 when x d 1 5 2 5 while it increases significantly for σ 1 5 when x d 2 5 combined with the discussion 3 2 2 it can be expected that the larger areas that cavities occupy will cause the corresponding turbulent intensity to increase comparing the non cavitation at σ 3 0 with the other three cavitation cases it can be found that the reynolds shear stress in spanwise for the down cylinder is significantly suppressed due to the interference effects while it is free from this suppression when cavitation occurs to sum up cavitation tends to make the reynolds shear stress anti symmetry with respect to z d 0 in other words the average value of turbulence fluctuation momentum flux tends to be consistent behind the two cylinders when cavitation occurs these anti symmetry distributions are similar to that of a single cylinder qualitatively as shown in fig 15 which suggests that each cylinder forms a relatively independent single vortex street downstream therefore the conclusion can be drawn that the interference effects on the turbulence fluctuations between the two side by side cylinders could be weakened when cavitation occurs 3 4 fluid forces as demonstrated in 3 1 1 cavitation mainly occurs in shear layers with the band like cavities periodic formation and breakup along the spanwise of the cylinders it can be inferred that the fluid forces acting on the two cylinders are certainly affected by this cavitation behavior to analyze the fluid forces acting on the cylinders the dimensionless coefficients cl cd and c pm can be defined as below 24 c l f l 1 2 ρ u 2 d h 25 c d f d 1 2 ρ u 2 d h 26 c p m p m p r e f 1 2 ρ u 2 where f l and f d are lift and drag forces respectively h is the spanwise length of the cylinder p m is the mean static pressure and p ref is the reference pressure of undisturbed point upstream fig 16 shows the mean drag and lift coefficients of the two cylinders for different cavitation numbers cd up and cl up represent the upper cylinder drag and lift coefficients respectively while the drag and lift coefficients of the bottom cylinder are represented by cd down and cl down shown in fig 1 it can be seen from the figure that cavitation has more effects on drag coefficients than on lift coefficients in the case of drag coefficients the values of cd increase significantly when cavitation occurs fig 17 illustrates the mean pressure coefficients distribution along the circumferential direction on the mid plane of the cylinder wall for clarity only the mean pressure coefficients of the down cylinder are shown as it is similar to that of the up cylinder as seen in fig 17 the mean pressure coefficients of the leeward side experience an apparent decline about 56 while it remains fairly unchanged once cavitation occurs therefore it can be expected that the resultant force in streamwise i e the drag force will increase note that under this side by side arrangement t d 1 5 two values of cd cd up 1 08 nw mode cd down 0 90 ww mode are separated at σ 3 non cavitating due to the biased flow pattern as discussed in 3 2 1 which is consistent with the result of alam et al 2003 with the decrease of the cavitation number this difference between the magnitude of cd for nw and ww modes becomes smaller and smaller from this point of view it can also prove that the interference effects between two side by side cylinders are weakened once the cavitation occurs as for the lift coefficients the magnitude of cl roughly remains unchanged with the opposite direction and behaves as a repulsive outward direction force between two cylinders which can also easily be conjectured from fig 17 under this side by side arrangement t d 1 5 this repulsive effect due to the inward movement of stagnations is also consistent with the previous investigations by alam et al 2003 in conclusion the mean drag coefficients will increase dramatically when cavitation occurs while the mean lift coefficients are little influenced 4 conclusions the unsteady cavitating flow around two side by side circular cylinders at a reynolds number of 64 000 were numerically investigated three typical cavitation cases at σ 1 5 σ 2 σ 2 5 and non cavitation case at σ 3 were compared with each other in details the main conclusions can be drawn as follows 1 cavities around circular cylinders can roughly be divided into two regions band like cavities attached on the cylinder walls and clump like cavities behind the cylinders they mainly originate in the free shear layers and concentrate in 2 3d downstream at subcritical re 64 000 2 when cavitation occurs the transition of shear layers is brought forward and the bi stable regime is no longer existing which weakens the interference effects between two cylinders significantly based on the vorticity equation the vortex dilatation is mainly concentrated in the shear layers of the two cylinders while the vortex stretching is concentrated in both shear layers and wakes due to the high velocity gradient 3 the interference effects on the turbulence fluctuations between the two side by side cylinders could be weakened when cavitation occurs furthermore the reynolds shear stress in spanwise for the down cylinder is significantly suppressed due to the interference effects while it is free from this suppression when cavitation occurs 4 the mean drag coefficients will increase dramatically when cavitation occurs while the mean lift coefficients are little influenced credit authorship contribution statement longlong yan conceptualization methodology software data curation writing original draft bo gao supervision resources dan ni funding acquisition ning zhang funding acquisition wenjie zhou funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors gratefully acknowledge the financial support of the national science foundation of china 51576090 51706087 51706086 a project funded by six talent peaks project in jiangsu province kthy 060 the key research and development program of zhenjiang grant no gy2018023 the project funded by china postdoctoral science foundation grant no 2018m642177 
20697,the auv must be capable of fault diagnosis if it is to perform tasks in complex environments without human assistance however the current fault diagnosis methods for auv lack of manual experience and accuracy leading to the lack of fault handling capacity different from the traditional model based fault diagnosis we propose a new model free fault diagnosis method characterized by a deep learning based algorithm which is a new sequence convolutional neural network seqcnn that learns the patterns between state data and fault type more specifically the proposed seqcnn aims to extract global feature and local feature from state data and classify the extracted information into different fault types and can convert two stage diagnosis mode into a single stage one compared to the traditional model based diagnosis it can significantly reduce the time consuming burden simplify the diagnosis procedure and improve the efficiency the effectiveness of seqcnn was validated by a practical experiment on a small quadrotor auv haizhe the results indicate that the proposed seqcnn can solve the problem of fault detection and fault isolation in single stage diagnosis mode and that its accuracy is far superior to that of other deep learning diagnosis algorithms keywords fault diagnosis autonomous underwater vehicles auvs convolutional neural network cnn model free global feature 1 introduction in the past few decades due to their long range high precision navigation and the ability to operate autonomously in the deep sea autonomous underwater vehicles auvs have been widely used in marine applications such as offshore oil gas exploration and development oceanographic survey deep sea sampling environmental assessment submarine cable pipeline inspection to perform missions in complicated and unpredictable environments without human assistance the auv must have fault diagnosis capabilities that can detect and isolate faults which could result in mission failure or even loss of auv the study on the fault diagnosis of auv is of interest to many scholars however the fault diagnosis methods in the existing literature lack of manual experience and accuracy leading to the lack of fault handling capacity by summarizing the existing research results fault diagnosis includes fault detection fault isolation and fault identification fault detection is used to detect whether there is a fault in the system fault isolation is to determine the type of fault and the exact location where the fault occurs fault identification is to further determine the amplitude and time varying characteristics of the fault fault detection is essential for any system fault isolation is almost equally important and fault identification although useful might not be worth extra effort gertler 1998 therefore most fault diagnosis systems only consist of fault detection and isolation also referred to as fdi systems by referring to the literature where the researches on fault diagnosis technology of auv which mainly focus on actuator fault and sensor fault the fault diagnosis methodology can be divided into three categories as follows 1 1 rule based diagnosis the rule based diagnosis system is an early trial solution whose core idea is to convert the knowledge mastered by engineers operators and maintenance personnel into diagnosis rules the prior information required for diagnosis comes from these rules this method does not need to establish an accurate dynamic model of auv and is convenient to establish rules in computer language in the form of if then statements these rules are also referred to as shallow knowledge because they are acquired through the external observation of auv rather than integrating their internal mechanisms hamilton et al 2007 ranganathan et al proposed an expert system for fault detection for auvs via integrating an artificial neural network ann and a fuzzy rule based expert system the ann is used to detect faults and then the expert system takes measures to reduce the impact of faults like fault tolerant control ranganathan et al 2001 in order to enhance the situational awareness e miguelañez et al introduced a semantic based framework which provided the core architecture for knowledge representation in auvs the framework combines expert positioning with observational data acquired during the mission to detect failures and provide solutions miguelañez et al 2011 yu zheng et al designed an on line diagnostic expert system with an inference engine based on a finite state machine for large scale autonomous unmanned submarines l aus and completed tests in several physical simulations zheng et al 2018 the main advantage of rule based diagnosis is fast execution time miguelañez et al 2011 however this method has certain limitations 1 the knowledge rule base is dependent on human experiences 2 when multiple faults occur simultaneously it is challenging to isolate faults hansen 1988 3 the set of conditions describing a particular fault needs to closely match the observed symptoms otherwise it is hard to make a definitive diagnosis hamilton et al 2007 1 2 model based diagnosis the model based diagnosis method uses a model built from the detailed in depth knowledge preferably from first principles of the system hamilton et al 2007 the structure and parameters of the model are the main elements of this method a precise mathematical model of the system is a key condition to ensure the ability of the model based diagnosis pettersson et al generally an explicit model of a device could be created based on the structure of the system and the physical or other laws that govern its behavior hamilton et al 2007 for example motion models are often based on dynamic equations based on the created model it is assumed that both auv and the model produce the same output with the same input while the auv works well the deviation between the predicted value of the model and the actual value is observed to determine whether a fault has occurred the model based fault diagnosis typically involves two stages 1 fault detection generating deviation information by comparing the predicted value of the model with the actual observed value in the normal state the deviation is close to zero specific methods include parameter estimation monitoring parameters alessandri et al 1998 alessandri et al 1999 observer based methods estimating unknown variables lu et al 2015 su and chen 2019 and parity space methods eliminating unknown variables patton and chen 1991 ding et al 1999 2 fault isolation also known as fault localization aiming at the system s faulty component traditionally there are two methods for fault isolation structural residuals and directional residuals travé massuyès 2014 hamilton et al 2007 in the structural residual residuals are sensitive to some defects and insensitive to others in the directional residual the residual vector is oriented in a specific direction for each fault in recent years methods based on machine learning have also been successfully applied xiang et al 2017 shumsky et al designed a set of nonlinear diagnostic observers as the predictive model of auv s thruster by comparing actual behaviors with model behaviors the residual information was obtained and then analyzed to solve the fdi problem shumsky et al 2010 daqi zhu et al proposed an observer based fault detection method for magnetic coupling underwater thrusters they designed a local recurrent neural network to construct the state space equation so as to improve the accuracy of the predictive model chu et al 2020 the model based fault diagnosis is effective under the assumption of precise model and ideal environment and can be used for diagnosis without human experience in practical application however it is often nearly impossible to establish such a precise model of auv in the underwater environment giving rise to the insufficient accuracy of fault diagnosis 1 3 data driven diagnosis in the case that the predictive model is hard to establish the data driven fault diagnosis method has become another research focus in this field jiang et al 2018 jiang and yin 2019 the data driven method assumes that there is an unknown pattern between the input and output of the system such pattern can be learned or fitted from a large amount of training data in general the predictive model also referred to as deep learning model is established by using deep learning technology in recent years with the rapid development of artificial intelligence technology deep learning technology have achieved remarkable results in many fields such as computer vision krizhevsky et al 2012 speech recognition graves et al 2013 and natural language processing vaswani et al 2017 a large number of studies have shown that deep learning models have strong nonlinear fitting capabilities ogunmolu et al 2016 wang 2017 considerable research efforts have been made on using deep learning model to solve the problem of auv modeling liu et al proposed the fault diagnosis method based on fca cmac credit assignment based fuzzy cerebellar model articulation controllers neural network to obtain online learning capacity for the underwater thrusters liu et al 2011 zhang et al investigated a fuzzy weighted support vector domain method which effectively solved the problem of low classification accuracy caused by the sparse and uneven distribution of fault samples in the process of multi fault mode classification the method can diagnose the faults of thrusters or sensors but cannot determine the risk level of the entire auv system zhang et al 2014 in nascimento and valdenegro toro 2018 nascimento presented an evaluation of recurrent neural networks rnns for a data driven fault diagnosis scheme for underwater thrusters with empirical data the nominal behavior of the thruster was modeled by using the control input voltage rotational speed and current signals however the deep learning modeling for auv has always been a difficult process because of the complex nonlinear dynamics of auv fossen 2002 the data driven method tries to solve the problem of auv modeling with the nonlinear fitting ability of the neural network although the deep learning model has better performance the entire diagnosis mode is still a two stage diagnosis mode fault detection and fault isolation besides the deep learning model requires lots of data for training the design of data driven diagnosis system will become more complicated and time consuming we believe that deep learning model has more powerful capabilities and can replace traditional diagnosis mode in this paper we address the above issues by using a model free fault diagnosis scheme fig 1 shows two basic principles of fault diagnosis before we introduce the proposed method in detail following definitions need to be firstly explained 1 state data all available data recorded by auv over a certain period of time including sensor data control signals etc these data can reflect the behavior of auv during this period 2 fault type a description of auv s status including whether a fault occurs the severity of the fault and the source of the fault different fault types indicate that auv is in different status in the left of fig 1 the model based fault diagnosis establishes a model based estimator based on the input and output of auv in data driven fault diagnosis the deep learning model acts as the estimator the residual information is calculated according to the output of the model and the observed behavior to determine whether a fault has occurred the residual implies the possibility of a fault fault isolation requires additional analysis to extract the information needed to locate the source of the fault in contrast the model free fault diagnosis does not require such an estimator which is also the essential difference between the two diagnosis methods this paper proposes a model free fault diagnosis framework as shown in the right of fig 1 inspired by the data driven strategy the diagnosis model can learn the potential pattern between state data and fault type from training data finally the trained model can predict fault type by analyzing state data of auv the obvious feature of model free scheme is that no predictive model is used in the fault diagnosis pettersson et al 2007 fault type is determined by analyzing state data of auv the model free fault diagnosis does not involve the architecture and dynamic mechanism of auv but focuses on learning patterns between state data and fault type according to the best of author s knowledge the model free techniques have not yet been applied to the fault diagnosis of auv the model free scheme assumes that there is a correlation between state data and fault type in fact this hypothesis is also consistent with a large number of experimental data more specifically state data records the behavior information of auv when different faults occur the auv generates different responses which can be observed from its behavior for example when the propeller is damaged the propeller will lose thrust causing auv to changing its attitude similarly when the depth sensor becomes abnormal the measured depth value will deviate from the true value causing the auv to adjust its depth by utilizing the model free strategy and deep learning technique we propose a new fault diagnosis algorithm for auv which is called as sequence convolutional neural network seqcnn to extract information from state data seqcnn uses multiple convolution kernels of different sizes to better extract features from state data the extracted features are used to predict fault type the predictive results of seqcnn can simultaneously solve the problem of fault detection and fault isolation since fault type includes the localization of fault source in addition the proposed method does not use the model of auv since the model free method only incorporates knowledge about the correlation between the behavior of auv and fault type the main contributions of this paper are summarized as follows 1 we propose a new model free fault diagnosis method characterized by a deep learning based algorithm according to the best of author s knowledge it is the first time to invent such a model free fault diagnosis scheme for auv compared to the traditional deep learning diagnosis the proposed method can diagnose without auv modeling which requires less time 2 a new sequence convolutional neural network seqcnn that learns the patterns between state data and fault type is proposed the proposed seqcnn can convert the two stage mode required in the traditional model based diagnosis into a single stage one which can significantly simplify the diagnosis procedure and improve the efficiency 3 the effectiveness of seqcnn was validated by a practical experiment on a small quadrotor auv haizhe the results indicated that the proposed seqcnn can solve the problem of fault detection and fault isolation in the single stage mode and that its accuracy was far superior to that of other deep learning diagnosis algorithms the rest of this paper is organized as follows section 2 briefly introduces the basic structure of haizhe section 3 elaborates the architecture and diagnosis process of the proposed algorithm the experimental setup data collection and data pre processing are given in section 4 section 5 demonstrates the experimental results of seqcnn rnn and lstm and presents the discussion section 6 summarizes the conclusions and future work 2 prototype overview this section describes a small quadrotor auv used in the laboratory called haizhe its primary purpose is to investigate and monitor the environment of inland waters such as lakes reservoirs the available state data of haizhe is also described fig 2 presents the haizhe auv prototype improved by the authors laboratory unlike the traditional torpedo type auvs haizhe is a quadrotor like vehicle this design is inspired by quadrotor unmanned aerial vehicles uavs the most distinguishing feature of haizhe is its small mass only 3 kg and flexibility although the number and types of sensors and actuators onboard are very limited it can perform some simple underwater tasks such as underwater observation and environmental assessment haizhe is also installed with motors propellers depth sensor satellite positioning device nine axis inertial measurement unit imu and control cabin which are the necessary modules for general auvs state data of auv can be easily collected from the sensors and actuators these data contain the voltage control signals depth angular velocity acceleration and attitude which can also be easily obtained from most auvs therefore this auv is suitable for the experiment of fault diagnosis the state data available in haizhe as shown in fig 3 is generated from the battery control unit depth sensor and nine axis imu the functions of each module are demonstrated as follows battery providing energy for haizhe its voltage value will also affect the working status of auv control unit making sure that the components work as expected in haizhe the control signals affect the motor speed by changing the duty ratio of the pwm wave the four motors are independently controlled depth gauge measuring the pressure value and calculating the depth value according to the formula provided in the sensor s datasheet nine axis imu measuring the euler angle pitch roll yaw angular velocity and acceleration it should be emphasized that the values measured by the imu is in the body coordinate frame they can be converted into the north east down coordinate frame through a rotation matrix sabet et al 2018 3 method 3 1 diagnosis process as we mentioned above the proposed method is not subject to the specific architecture of auv and the diagnosis process can be applied to almost all auvs the diagnosis process mainly includes pre processing off line training and on line diagnosis as shown in fig 4 1 pre processing module including sequence length handling data normalization and further data processing 2 off line training learning the parameters of diagnosis model from the historical datasets 3 on line diagnosis using the trained model to predict fault type more specifically the historical datasets contain many training samples each of which includes state data and its corresponding fault type these samples are used for model training when the datasets are ready it is followed by the pre processing module the samples fix the sequence length by clipping or padding where necessary state data is then appropriately normalized this paper employs 0 1 normalization for each feature and converted into dimensionless values so that different features can be compared and weighted note that the pre processing module is also used for current state data data normalization can improve both training and prediction speed during off line training an optimization algorithm is used to continuously adjust the parameters of the model so that the predicted value will be continuously closer to the true value to eventually obtain the optimal model the architecture of the model will be introduced in section 3 2 for on line diagnosis auv will load the optimal model to predict fault type from current state data since the real fault type of auv is also known in the experiment the prediction accuracy can be calculated according to the real fault type and the predicted fault type of the model 3 2 model the design of seqcnn is inspired by collobert et al 2011 kim 2014 the seqcnn takes the state data of auv as the input in wang et al 2009 nascimento and valdenegro toro 2018 considering some faults that do not happen abruptly but accumulate over time gradually leading to performance degradation of the affected components the authors used the recurrent neural network rnn to predict the current state by analyzing the state data of auv however rnn has the problem of gradient disappearance or gradient explosion when learning long term sequence data bengio et al 1994 although it alleviates the problem hochreiter and schmidhuber 1997 the long short term memory lstm cell cannot be computed in parallel which reduces the computational efficiency in ince et al 2016 abdeljaber et al 2017 pan et al 2018 zhang et al 2018 the researchers presented one dimensional 1 d convolutional neural networks cnn to analyze 1 d time series data their works prove that 1 d cnn can be applied to 1 d signal analysis and exhibits good performance in terms of bearing fault diagnosis structural damage detection and motor fault detection in contrast we design a 2 d cnn to process state data because the state data processed in this paper is a 2 d matrix where each column represents a 1 d signal fig 5 shows the architecture of the proposed seqcnn which includes input convolutional layer pooling layer and fully connected layer the input is an n k matrix where n represents the length of the sequence k represents the dimension of the feature and each row represents state data recorded at a certain time let x i r k be the k dimensional vector corresponding to the t i time step in the sequence similarly let f j t r n be the n dimensional vector corresponding to the f j feature over time the seqcnn calculates the features of the input using two approaches one of which is to extract higher dimensional local feature through convolution operation and the other is to extract global feature through simple statistics the specific calculation process is as follows 1 global feature this is a simple mathematical statistics for each feature in the time dimension so as to introduce some prior information the experimental results in section 5 can prove that global feature is helpful to improve the prediction accuracy of the seqcnn the formulas are shown below 1 m a x f j m a x f 1 j f 2 j f n j 2 m i n f j m i n f 1 j f 2 j f n j 3 r a n g e f j m a x f j m i n f j 4 m e a n f j i 1 n f i j n 5 v a r f j i 1 n f i j m e a n f j 2 n 6 s t d v a r f j v a r f j besides global feature also includes the displacement of auv in the geodetic coordinate system the acceleration in the frame coordinate system can be converted into the geodetic coordinate system by using the rotation matrix then the displacement can be obtained by quadratic integration of the acceleration for a short period the accumulated error is acceptable 2 local feature a sequence of length n padded where necessary is represented as 7 x 1 n x 1 x 2 x n where is the concatenation operator generally let x i i j refer to the concatenation of vectors x i x i 1 x i j a convolution operation involves a convolution kernel w r h k which is applied to a window of h vectors to produce a new feature for example a feature c i is generated from a window of vectors x i i h 1 by 8 c i f w x i i h 1 b c o n v where w is an h k weight matrix which means that w contains h k parameters to be estimated x i i h 1 is also an h k matrix the operator is the dot product between the kernel and the sub matrix a sum over element wise multiplications we add b c o n v r as a bias term and f as an activation function similarly this kernel is applied to each possible window of vectors in the sequence x 1 h x 2 h 1 x n h 1 n to produce feature map 9 c c 1 c 2 c n h 1 where c r n h 1 by designing the size and number of kernel different feature vectors can be extracted to form the output of the convolutional layer for example multiple kernel with the same window size can be used to learn complementary features from the same windows and multiple kinds of kernel with different window sizes can be used to extract abstract features from information of different window sizes then a pooling layer is used after the convolution layer it is worth noting that the dimension of the feature map produced by different kernels may vary as a function of the kernel size the pooling layer extracts a scalar from each feature map and concatenates them into a fixed length vector named local feature there are two common strategies described as follows globalmaxpooling boureau et al 2010 take the maximum value c ˆ max c as the feature corresponding to the particular filter globalaveragepooling lin et al 2014 take the average value c m e a n c as the feature corresponding to the particular filter both of these two strategies are useful for dealing with variable sequence lengths from the description of these two strategies it can be seen that globalmaxpooling only focuses on the most important feature maximum value in the feature map while globalaveragepooling can integrate the information of each feature average value in the feature map finally the seqcnn concatenates the global feature and local feature together to form a single feature vector and then feeds through a fully connected softmax layer whose output is the probability distribution over labels we also employ dropout hinton et al 2012 at the softmax layer for regularization this method enhances the generalization ability of the seqcnn by randomly setting values in the weight matrix to zero 10 x c o n c a t e g l o b a l f e a t u r e l o c a l f e a t u r e 11 r bernoulli p 12 x x c o n c a t e r 13 z w x t b f c 14 p softmax z where x c o n c a t e r 1 n f e a t u r e bernoulli function will randomly generate a vector r with probability coefficients p where each element is 0 or 1 taking 0 means that the neuron is temporarily inactive and taking 1 means that the neuron is active the operation is element wise w r n c l a s s n f e a t u r e and b f c r n c l a s s are parameters to be trained n c l a s s represents the number of the classes of the labels in training datasets z is a n c l a s s dimensional vector z 1 z 2 z n c l a s s the output p has the same dimension with z p i is a score for i th label with respect to the task of interest this score can be interpreted as a conditional label probability by using a softmax function 15 p i e z i j 1 n c l a s s e z j 3 3 training the proposed seqcnn is trained by minimizing a cross entropy loss over the training set and using adam algorithm kingma and ba 2014 to update the parameters let θ denote all the trainable parameters of the seqcnn the network can be trained by minimizing the following cross entropy loss with respect to θ 16 θ arg min θ j θ 17 j θ x y t i 1 k y i log p i 18 y i 0 y i 1 y i 19 p i p i x θ i 1 k p i 1 where t is the training set k is the number of labels x represents an input data and y represents the corresponding fault type p i is a conditional probability which is computed from the seqcnn as we mentioned above seqcnn applies softmax layer to obtain the probability distribution over labels given an input example x y we set five fault types in the experiment k 5 and each fault type can be represented by a specific number such as 1 refers to type 1 2 refers to type 2 accordingly the output of the seqcnn is a 5 dimensional vector and p i represents the i th dimensional value for the input example x y if the network with parameters θ outputs a probability distribution over labels p 0 1 0 4 0 2 0 1 0 2 and the true label y 2 then we can obtain the loss j x y θ 0 log 0 1 1 log 0 4 0 log 0 2 0 log 0 1 0 log 0 2 0 3979 although p 2 0 4 is the max value in p and the predicted label is 2 same as the true label the probability is not good enough we expect the output of seqcnn will be p e x p e c t e d 0 1 0 0 0 and the loss will be j x y θ e x p e c t e d log 1 0 therefore if we can find appropriate parameters θ to obtain smaller loss value the seqcnn has a better performance in this paper we use adam algorithm to find such parameters and the detailed process of updating parameters is shown below then the well known back propagation algorithm le cun 1986 rumelhart et al 1986 can calculate gradients using the chain rule given the derivatives with respect to its outputs each layer can independently calculate derivatives with respect to its inputs and trainable parameters as proposed by bottou and gallinari 1990 this is a mature technology currently commonly used deep learning frameworks such as tensorflow pytorch can realize the back propagation of gradients according to the forward calculation process designed by researchers as a result researchers can focus on the structural design of neural networks 4 experiment in order to verify the effectiveness of the proposed seqcnn algorithm the experiment was carried out by using haizhe several different models were tested using the same data and their performances are compared in this section 4 1 experimental setup fault is often accompanied by loss or damage and data acquisition is challenging when the auv is in a faulty state we set five common fault types under laboratory conditions including normal state slight damage to the propeller severe damage to the propeller failure of the depth sensor and load increase as shown in fig 6 in order to introduce the experiment clearly necessary experimental instructions are given as follows in the experiment haizhe had only one fault type at the same time and there was no multi failure concurrency in practice one significant fault often leads to something worse therefore once a fault occurs in the auv measures should be timely taken to avoid the occurrence of multiple faults the fault of depth sensor was not the hardware damage but artificially added a bias item when reading the pressure value which made the calculated depth value deviate from the true value for example when the true depth was 0 5 m the depth calculated by the sensor was 0 6 m haizhe sailed underwater for 10 20 s each time the state data recorded in the experiment was used as a data sample for further processing 4 2 data collection fig 7 shows a complete data collection test of the haizhe auv firstly the fault type was set and recorded for the haizhe then the initializer was executed to check whether each component could work properly or not after that haizhe executed the main program and turned on the function of data recording and then haizhe began sailing underwater it is worth noting that different behavioral responses would be generated under the influence of different fault types but the main program did not change after completing the main program haizhe would stop data recording and automatically rose to the surface finally the file system of haizhe would save the state data as a text file also called a data sample for each fault type haizhe was tested several times for each time haizhe ran the same program and sailed underwater for 10 20 s to ensure that state data was long enough the state data recorded in each test were then used as a data sample and the corresponding fault type was the true label of the data sample all the data samples constitute the final dataset the training dataset and the test dataset obtained through random stratified sampling the test dataset accounted for 20 of the total dataset the specific number is shown in table 1 the training dataset will be used for model training while the test dataset will be used to verify its effectiveness 4 3 pre processing pre processing is an essential procedure which directly determines the input of the seqcnn the whole procedure includes sequence length processing data normalization and further feature processing which are specifically described as follows sequence length processing setting a fixed size sequence length if the original sequence length is insufficient it will be padded by repeating the last moment state data if the original sequence length is too long the tail data will be clipped the sequence length was set to 196 in the experiment feature processing using the duty ratio of the pwm wave to calculate the average voltage and effective voltage of the motor data normalization each feature is mapped to the interval 0 1 by using the 0 1 normalization method this method can speed up the gradient descent and improve the convergence speed of the model a matrix of 196 17 was obtained from each state data where the number 196 represented the sequence length and 17 represented the dimension of feature including duty ratio depth value voltage average voltage effective voltage three axis attitude angle angular velocity and acceleration in the body coordinate system three axis acceleration in the geodetic coordinate system the matrix was used as the input of the proposed seqcnn 4 4 hyperparameters and training the hyperparameters of the seqcnn were set as follows relu glorot et al was employed as the activation function f the kernel size h were 3 5 7 20 with 64 64 128 16 feature maps respectively the globalaveragepooling was utilized in pooling layer the dropout rate was 0 4 the learning rate 0 001 and the batch size 128 these hyperparameters were determined via k fold cross validation k was set to 5 in this paper on the training set and the specific process is listed as follows 1 evenly divide the original training set into five sub datasets 2 choose one sub dataset as the validation set and the remaining four sub datasets as the training set 3 use four sub datasets to train the model and then calculate the diagnosis accuracy of the model on the validation set 4 repeat 2 and 3 for five times and a different sub dataset will be chosen as the verification set in each time 5 calculate the average accuracy from five verification sets to evaluate the diagnosis performance of the model 6 adjust the hyperparameters of the model and repeat 2 3 4 and 5 choose a set of hyperparameters that will make the model have the best diagnosis performance in the 5 fold cross validation it is impossible to test all the possible combinations of hyperparameters in our experience the performance of the model was significantly affected by adjusting the dropout rate and the size or number of convolution kernels 4 5 model variations in order to verify the performance of seqcnn six different models were established three of which were with global feature while another three were without global feature seqcnn std a model with the same architecture as shown in fig 5 seqcnn no glb same as above but do not use global feature rnn std a model using the recurrent neural network rnn to extract local feature from input and then concatenate global feature rnn no glb same as above but do not use global feature lstm std a model using the long short term memory lstm to extract local feature from input and then concatenate global feature lstm no glb same as above but do not use global feature each model was trained with the same training set and the optimal hyperparameters were set to eliminate the influence of other randomness as much as possible their prediction accuracy was compared using the same test set the prediction accuracy of different models in the training set and test set is illustrated in fig 8 the parameters of models were initialized randomly in each epoch the training set was passed into models for training the backpropagation algorithm was then used to update the parameters 5 results and discussion the results of diagnosis accuracy are shown in table 2 the accuracy of seqcnn was the best in the test set more specifically the maximum value of seqcnn std that is with global feature was 97 96 compared to that of lstm std 88 16 and rnn std 86 94 while for those without global feature the maximum value of seqcnn no glb was 94 29 compared to that of lstm no glb 65 31 and rnn no glb 37 96 it is obvious that the accuracy of the seqcnn model is far superior to the lstm and rnn model whether global feature is used or not implying the powerful capability of the seqcnn algorithm in the sequence data processing the results also indicate that it is practicable to predict fault type by analyzing state data furthermore by comparing the performances of the models using global feature with those that do not we can see that the global feature is helpful to improve the prediction accuracy one possible reason is that global feature contains effective information which helps the model to make correct predictions on test samples interestingly for the accuracy improvement global feature contributes the most to the rnn model while it contributes the least to the seqcnn model therefore the effective information in local feature can be considered comparable to global feature in the seqcnn model we could also find that the performance of the lstm was better than that of the rnn the same finding was also reported by bengio et al 1994 hochreiter and schmidhuber 1997 a possible explanation for this might be that gradient disappearance or gradient explosion would occur when the rnn updated parameters using the backpropagation algorithm as the sequence length increased the results show that the proposed model free fault diagnosis scheme with the designed seqcnn is more feasible for modeling the correlation between state data and fault type than the rnn and the lstm moreover the analysis of sequence data by the network using convolution is proved to be effective furthermore it is easier for users to train the diagnosis system by telling fault type instead of compiling a complex predictive model in computer language 6 conclusion a model free fault diagnosis scheme with a new diagnosis algorithm seqcnn was proposed in this paper the proposed seqcnn is based on deep learning technique and learns patterns between state data and fault type the proposed scheme completes the diagnosis in the single stage mode using the correlation between state data and fault type rather than the model of auv which can reduce the time consuming burden significantly simplify the diagnosis procedure and improve the efficiency more importantly the proposed seqcnn is more accurate than other algorithms and its effectiveness was experimentally verified there is some further work to be done on the proposed method it seems impossible to set up all fault types under experimental conditions however a possible solution to this problem is to use existing life long learning techniques thrun 1994 allowing the system to continue to learn new fault types we will investigate the diagnosis method that combines the model based and model free approaches because of their complementary advantages besides multiple auvs have received considerable attention in recent years han et al 2020 in a multi auv mission lots of auvs are composed into a cooperative system with leaderless or leader follower mode li and wang 2013 although some effective research efforts have been made on control system design such as formation control yang et al 2019 cui et al 2010 and cooperative control shen et al 2014 cui et al 2016 only a few papers have addressed the fault problems in multiple auv systems chen and ho 2016 kadiyam et al 2020 therefore it is highly desirable to develop fault diagnosis method for multiple auv systems credit authorship contribution statement daxiong ji conceptualization methodology software xin yao data curation writing original draft preparation shuo li investigation yuangui tang supervision yu tian validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the national key research and development program of china 2016yfc0300801 and the basic public welfare research plan of zhejiang province china lgf20e090004 
20697,the auv must be capable of fault diagnosis if it is to perform tasks in complex environments without human assistance however the current fault diagnosis methods for auv lack of manual experience and accuracy leading to the lack of fault handling capacity different from the traditional model based fault diagnosis we propose a new model free fault diagnosis method characterized by a deep learning based algorithm which is a new sequence convolutional neural network seqcnn that learns the patterns between state data and fault type more specifically the proposed seqcnn aims to extract global feature and local feature from state data and classify the extracted information into different fault types and can convert two stage diagnosis mode into a single stage one compared to the traditional model based diagnosis it can significantly reduce the time consuming burden simplify the diagnosis procedure and improve the efficiency the effectiveness of seqcnn was validated by a practical experiment on a small quadrotor auv haizhe the results indicate that the proposed seqcnn can solve the problem of fault detection and fault isolation in single stage diagnosis mode and that its accuracy is far superior to that of other deep learning diagnosis algorithms keywords fault diagnosis autonomous underwater vehicles auvs convolutional neural network cnn model free global feature 1 introduction in the past few decades due to their long range high precision navigation and the ability to operate autonomously in the deep sea autonomous underwater vehicles auvs have been widely used in marine applications such as offshore oil gas exploration and development oceanographic survey deep sea sampling environmental assessment submarine cable pipeline inspection to perform missions in complicated and unpredictable environments without human assistance the auv must have fault diagnosis capabilities that can detect and isolate faults which could result in mission failure or even loss of auv the study on the fault diagnosis of auv is of interest to many scholars however the fault diagnosis methods in the existing literature lack of manual experience and accuracy leading to the lack of fault handling capacity by summarizing the existing research results fault diagnosis includes fault detection fault isolation and fault identification fault detection is used to detect whether there is a fault in the system fault isolation is to determine the type of fault and the exact location where the fault occurs fault identification is to further determine the amplitude and time varying characteristics of the fault fault detection is essential for any system fault isolation is almost equally important and fault identification although useful might not be worth extra effort gertler 1998 therefore most fault diagnosis systems only consist of fault detection and isolation also referred to as fdi systems by referring to the literature where the researches on fault diagnosis technology of auv which mainly focus on actuator fault and sensor fault the fault diagnosis methodology can be divided into three categories as follows 1 1 rule based diagnosis the rule based diagnosis system is an early trial solution whose core idea is to convert the knowledge mastered by engineers operators and maintenance personnel into diagnosis rules the prior information required for diagnosis comes from these rules this method does not need to establish an accurate dynamic model of auv and is convenient to establish rules in computer language in the form of if then statements these rules are also referred to as shallow knowledge because they are acquired through the external observation of auv rather than integrating their internal mechanisms hamilton et al 2007 ranganathan et al proposed an expert system for fault detection for auvs via integrating an artificial neural network ann and a fuzzy rule based expert system the ann is used to detect faults and then the expert system takes measures to reduce the impact of faults like fault tolerant control ranganathan et al 2001 in order to enhance the situational awareness e miguelañez et al introduced a semantic based framework which provided the core architecture for knowledge representation in auvs the framework combines expert positioning with observational data acquired during the mission to detect failures and provide solutions miguelañez et al 2011 yu zheng et al designed an on line diagnostic expert system with an inference engine based on a finite state machine for large scale autonomous unmanned submarines l aus and completed tests in several physical simulations zheng et al 2018 the main advantage of rule based diagnosis is fast execution time miguelañez et al 2011 however this method has certain limitations 1 the knowledge rule base is dependent on human experiences 2 when multiple faults occur simultaneously it is challenging to isolate faults hansen 1988 3 the set of conditions describing a particular fault needs to closely match the observed symptoms otherwise it is hard to make a definitive diagnosis hamilton et al 2007 1 2 model based diagnosis the model based diagnosis method uses a model built from the detailed in depth knowledge preferably from first principles of the system hamilton et al 2007 the structure and parameters of the model are the main elements of this method a precise mathematical model of the system is a key condition to ensure the ability of the model based diagnosis pettersson et al generally an explicit model of a device could be created based on the structure of the system and the physical or other laws that govern its behavior hamilton et al 2007 for example motion models are often based on dynamic equations based on the created model it is assumed that both auv and the model produce the same output with the same input while the auv works well the deviation between the predicted value of the model and the actual value is observed to determine whether a fault has occurred the model based fault diagnosis typically involves two stages 1 fault detection generating deviation information by comparing the predicted value of the model with the actual observed value in the normal state the deviation is close to zero specific methods include parameter estimation monitoring parameters alessandri et al 1998 alessandri et al 1999 observer based methods estimating unknown variables lu et al 2015 su and chen 2019 and parity space methods eliminating unknown variables patton and chen 1991 ding et al 1999 2 fault isolation also known as fault localization aiming at the system s faulty component traditionally there are two methods for fault isolation structural residuals and directional residuals travé massuyès 2014 hamilton et al 2007 in the structural residual residuals are sensitive to some defects and insensitive to others in the directional residual the residual vector is oriented in a specific direction for each fault in recent years methods based on machine learning have also been successfully applied xiang et al 2017 shumsky et al designed a set of nonlinear diagnostic observers as the predictive model of auv s thruster by comparing actual behaviors with model behaviors the residual information was obtained and then analyzed to solve the fdi problem shumsky et al 2010 daqi zhu et al proposed an observer based fault detection method for magnetic coupling underwater thrusters they designed a local recurrent neural network to construct the state space equation so as to improve the accuracy of the predictive model chu et al 2020 the model based fault diagnosis is effective under the assumption of precise model and ideal environment and can be used for diagnosis without human experience in practical application however it is often nearly impossible to establish such a precise model of auv in the underwater environment giving rise to the insufficient accuracy of fault diagnosis 1 3 data driven diagnosis in the case that the predictive model is hard to establish the data driven fault diagnosis method has become another research focus in this field jiang et al 2018 jiang and yin 2019 the data driven method assumes that there is an unknown pattern between the input and output of the system such pattern can be learned or fitted from a large amount of training data in general the predictive model also referred to as deep learning model is established by using deep learning technology in recent years with the rapid development of artificial intelligence technology deep learning technology have achieved remarkable results in many fields such as computer vision krizhevsky et al 2012 speech recognition graves et al 2013 and natural language processing vaswani et al 2017 a large number of studies have shown that deep learning models have strong nonlinear fitting capabilities ogunmolu et al 2016 wang 2017 considerable research efforts have been made on using deep learning model to solve the problem of auv modeling liu et al proposed the fault diagnosis method based on fca cmac credit assignment based fuzzy cerebellar model articulation controllers neural network to obtain online learning capacity for the underwater thrusters liu et al 2011 zhang et al investigated a fuzzy weighted support vector domain method which effectively solved the problem of low classification accuracy caused by the sparse and uneven distribution of fault samples in the process of multi fault mode classification the method can diagnose the faults of thrusters or sensors but cannot determine the risk level of the entire auv system zhang et al 2014 in nascimento and valdenegro toro 2018 nascimento presented an evaluation of recurrent neural networks rnns for a data driven fault diagnosis scheme for underwater thrusters with empirical data the nominal behavior of the thruster was modeled by using the control input voltage rotational speed and current signals however the deep learning modeling for auv has always been a difficult process because of the complex nonlinear dynamics of auv fossen 2002 the data driven method tries to solve the problem of auv modeling with the nonlinear fitting ability of the neural network although the deep learning model has better performance the entire diagnosis mode is still a two stage diagnosis mode fault detection and fault isolation besides the deep learning model requires lots of data for training the design of data driven diagnosis system will become more complicated and time consuming we believe that deep learning model has more powerful capabilities and can replace traditional diagnosis mode in this paper we address the above issues by using a model free fault diagnosis scheme fig 1 shows two basic principles of fault diagnosis before we introduce the proposed method in detail following definitions need to be firstly explained 1 state data all available data recorded by auv over a certain period of time including sensor data control signals etc these data can reflect the behavior of auv during this period 2 fault type a description of auv s status including whether a fault occurs the severity of the fault and the source of the fault different fault types indicate that auv is in different status in the left of fig 1 the model based fault diagnosis establishes a model based estimator based on the input and output of auv in data driven fault diagnosis the deep learning model acts as the estimator the residual information is calculated according to the output of the model and the observed behavior to determine whether a fault has occurred the residual implies the possibility of a fault fault isolation requires additional analysis to extract the information needed to locate the source of the fault in contrast the model free fault diagnosis does not require such an estimator which is also the essential difference between the two diagnosis methods this paper proposes a model free fault diagnosis framework as shown in the right of fig 1 inspired by the data driven strategy the diagnosis model can learn the potential pattern between state data and fault type from training data finally the trained model can predict fault type by analyzing state data of auv the obvious feature of model free scheme is that no predictive model is used in the fault diagnosis pettersson et al 2007 fault type is determined by analyzing state data of auv the model free fault diagnosis does not involve the architecture and dynamic mechanism of auv but focuses on learning patterns between state data and fault type according to the best of author s knowledge the model free techniques have not yet been applied to the fault diagnosis of auv the model free scheme assumes that there is a correlation between state data and fault type in fact this hypothesis is also consistent with a large number of experimental data more specifically state data records the behavior information of auv when different faults occur the auv generates different responses which can be observed from its behavior for example when the propeller is damaged the propeller will lose thrust causing auv to changing its attitude similarly when the depth sensor becomes abnormal the measured depth value will deviate from the true value causing the auv to adjust its depth by utilizing the model free strategy and deep learning technique we propose a new fault diagnosis algorithm for auv which is called as sequence convolutional neural network seqcnn to extract information from state data seqcnn uses multiple convolution kernels of different sizes to better extract features from state data the extracted features are used to predict fault type the predictive results of seqcnn can simultaneously solve the problem of fault detection and fault isolation since fault type includes the localization of fault source in addition the proposed method does not use the model of auv since the model free method only incorporates knowledge about the correlation between the behavior of auv and fault type the main contributions of this paper are summarized as follows 1 we propose a new model free fault diagnosis method characterized by a deep learning based algorithm according to the best of author s knowledge it is the first time to invent such a model free fault diagnosis scheme for auv compared to the traditional deep learning diagnosis the proposed method can diagnose without auv modeling which requires less time 2 a new sequence convolutional neural network seqcnn that learns the patterns between state data and fault type is proposed the proposed seqcnn can convert the two stage mode required in the traditional model based diagnosis into a single stage one which can significantly simplify the diagnosis procedure and improve the efficiency 3 the effectiveness of seqcnn was validated by a practical experiment on a small quadrotor auv haizhe the results indicated that the proposed seqcnn can solve the problem of fault detection and fault isolation in the single stage mode and that its accuracy was far superior to that of other deep learning diagnosis algorithms the rest of this paper is organized as follows section 2 briefly introduces the basic structure of haizhe section 3 elaborates the architecture and diagnosis process of the proposed algorithm the experimental setup data collection and data pre processing are given in section 4 section 5 demonstrates the experimental results of seqcnn rnn and lstm and presents the discussion section 6 summarizes the conclusions and future work 2 prototype overview this section describes a small quadrotor auv used in the laboratory called haizhe its primary purpose is to investigate and monitor the environment of inland waters such as lakes reservoirs the available state data of haizhe is also described fig 2 presents the haizhe auv prototype improved by the authors laboratory unlike the traditional torpedo type auvs haizhe is a quadrotor like vehicle this design is inspired by quadrotor unmanned aerial vehicles uavs the most distinguishing feature of haizhe is its small mass only 3 kg and flexibility although the number and types of sensors and actuators onboard are very limited it can perform some simple underwater tasks such as underwater observation and environmental assessment haizhe is also installed with motors propellers depth sensor satellite positioning device nine axis inertial measurement unit imu and control cabin which are the necessary modules for general auvs state data of auv can be easily collected from the sensors and actuators these data contain the voltage control signals depth angular velocity acceleration and attitude which can also be easily obtained from most auvs therefore this auv is suitable for the experiment of fault diagnosis the state data available in haizhe as shown in fig 3 is generated from the battery control unit depth sensor and nine axis imu the functions of each module are demonstrated as follows battery providing energy for haizhe its voltage value will also affect the working status of auv control unit making sure that the components work as expected in haizhe the control signals affect the motor speed by changing the duty ratio of the pwm wave the four motors are independently controlled depth gauge measuring the pressure value and calculating the depth value according to the formula provided in the sensor s datasheet nine axis imu measuring the euler angle pitch roll yaw angular velocity and acceleration it should be emphasized that the values measured by the imu is in the body coordinate frame they can be converted into the north east down coordinate frame through a rotation matrix sabet et al 2018 3 method 3 1 diagnosis process as we mentioned above the proposed method is not subject to the specific architecture of auv and the diagnosis process can be applied to almost all auvs the diagnosis process mainly includes pre processing off line training and on line diagnosis as shown in fig 4 1 pre processing module including sequence length handling data normalization and further data processing 2 off line training learning the parameters of diagnosis model from the historical datasets 3 on line diagnosis using the trained model to predict fault type more specifically the historical datasets contain many training samples each of which includes state data and its corresponding fault type these samples are used for model training when the datasets are ready it is followed by the pre processing module the samples fix the sequence length by clipping or padding where necessary state data is then appropriately normalized this paper employs 0 1 normalization for each feature and converted into dimensionless values so that different features can be compared and weighted note that the pre processing module is also used for current state data data normalization can improve both training and prediction speed during off line training an optimization algorithm is used to continuously adjust the parameters of the model so that the predicted value will be continuously closer to the true value to eventually obtain the optimal model the architecture of the model will be introduced in section 3 2 for on line diagnosis auv will load the optimal model to predict fault type from current state data since the real fault type of auv is also known in the experiment the prediction accuracy can be calculated according to the real fault type and the predicted fault type of the model 3 2 model the design of seqcnn is inspired by collobert et al 2011 kim 2014 the seqcnn takes the state data of auv as the input in wang et al 2009 nascimento and valdenegro toro 2018 considering some faults that do not happen abruptly but accumulate over time gradually leading to performance degradation of the affected components the authors used the recurrent neural network rnn to predict the current state by analyzing the state data of auv however rnn has the problem of gradient disappearance or gradient explosion when learning long term sequence data bengio et al 1994 although it alleviates the problem hochreiter and schmidhuber 1997 the long short term memory lstm cell cannot be computed in parallel which reduces the computational efficiency in ince et al 2016 abdeljaber et al 2017 pan et al 2018 zhang et al 2018 the researchers presented one dimensional 1 d convolutional neural networks cnn to analyze 1 d time series data their works prove that 1 d cnn can be applied to 1 d signal analysis and exhibits good performance in terms of bearing fault diagnosis structural damage detection and motor fault detection in contrast we design a 2 d cnn to process state data because the state data processed in this paper is a 2 d matrix where each column represents a 1 d signal fig 5 shows the architecture of the proposed seqcnn which includes input convolutional layer pooling layer and fully connected layer the input is an n k matrix where n represents the length of the sequence k represents the dimension of the feature and each row represents state data recorded at a certain time let x i r k be the k dimensional vector corresponding to the t i time step in the sequence similarly let f j t r n be the n dimensional vector corresponding to the f j feature over time the seqcnn calculates the features of the input using two approaches one of which is to extract higher dimensional local feature through convolution operation and the other is to extract global feature through simple statistics the specific calculation process is as follows 1 global feature this is a simple mathematical statistics for each feature in the time dimension so as to introduce some prior information the experimental results in section 5 can prove that global feature is helpful to improve the prediction accuracy of the seqcnn the formulas are shown below 1 m a x f j m a x f 1 j f 2 j f n j 2 m i n f j m i n f 1 j f 2 j f n j 3 r a n g e f j m a x f j m i n f j 4 m e a n f j i 1 n f i j n 5 v a r f j i 1 n f i j m e a n f j 2 n 6 s t d v a r f j v a r f j besides global feature also includes the displacement of auv in the geodetic coordinate system the acceleration in the frame coordinate system can be converted into the geodetic coordinate system by using the rotation matrix then the displacement can be obtained by quadratic integration of the acceleration for a short period the accumulated error is acceptable 2 local feature a sequence of length n padded where necessary is represented as 7 x 1 n x 1 x 2 x n where is the concatenation operator generally let x i i j refer to the concatenation of vectors x i x i 1 x i j a convolution operation involves a convolution kernel w r h k which is applied to a window of h vectors to produce a new feature for example a feature c i is generated from a window of vectors x i i h 1 by 8 c i f w x i i h 1 b c o n v where w is an h k weight matrix which means that w contains h k parameters to be estimated x i i h 1 is also an h k matrix the operator is the dot product between the kernel and the sub matrix a sum over element wise multiplications we add b c o n v r as a bias term and f as an activation function similarly this kernel is applied to each possible window of vectors in the sequence x 1 h x 2 h 1 x n h 1 n to produce feature map 9 c c 1 c 2 c n h 1 where c r n h 1 by designing the size and number of kernel different feature vectors can be extracted to form the output of the convolutional layer for example multiple kernel with the same window size can be used to learn complementary features from the same windows and multiple kinds of kernel with different window sizes can be used to extract abstract features from information of different window sizes then a pooling layer is used after the convolution layer it is worth noting that the dimension of the feature map produced by different kernels may vary as a function of the kernel size the pooling layer extracts a scalar from each feature map and concatenates them into a fixed length vector named local feature there are two common strategies described as follows globalmaxpooling boureau et al 2010 take the maximum value c ˆ max c as the feature corresponding to the particular filter globalaveragepooling lin et al 2014 take the average value c m e a n c as the feature corresponding to the particular filter both of these two strategies are useful for dealing with variable sequence lengths from the description of these two strategies it can be seen that globalmaxpooling only focuses on the most important feature maximum value in the feature map while globalaveragepooling can integrate the information of each feature average value in the feature map finally the seqcnn concatenates the global feature and local feature together to form a single feature vector and then feeds through a fully connected softmax layer whose output is the probability distribution over labels we also employ dropout hinton et al 2012 at the softmax layer for regularization this method enhances the generalization ability of the seqcnn by randomly setting values in the weight matrix to zero 10 x c o n c a t e g l o b a l f e a t u r e l o c a l f e a t u r e 11 r bernoulli p 12 x x c o n c a t e r 13 z w x t b f c 14 p softmax z where x c o n c a t e r 1 n f e a t u r e bernoulli function will randomly generate a vector r with probability coefficients p where each element is 0 or 1 taking 0 means that the neuron is temporarily inactive and taking 1 means that the neuron is active the operation is element wise w r n c l a s s n f e a t u r e and b f c r n c l a s s are parameters to be trained n c l a s s represents the number of the classes of the labels in training datasets z is a n c l a s s dimensional vector z 1 z 2 z n c l a s s the output p has the same dimension with z p i is a score for i th label with respect to the task of interest this score can be interpreted as a conditional label probability by using a softmax function 15 p i e z i j 1 n c l a s s e z j 3 3 training the proposed seqcnn is trained by minimizing a cross entropy loss over the training set and using adam algorithm kingma and ba 2014 to update the parameters let θ denote all the trainable parameters of the seqcnn the network can be trained by minimizing the following cross entropy loss with respect to θ 16 θ arg min θ j θ 17 j θ x y t i 1 k y i log p i 18 y i 0 y i 1 y i 19 p i p i x θ i 1 k p i 1 where t is the training set k is the number of labels x represents an input data and y represents the corresponding fault type p i is a conditional probability which is computed from the seqcnn as we mentioned above seqcnn applies softmax layer to obtain the probability distribution over labels given an input example x y we set five fault types in the experiment k 5 and each fault type can be represented by a specific number such as 1 refers to type 1 2 refers to type 2 accordingly the output of the seqcnn is a 5 dimensional vector and p i represents the i th dimensional value for the input example x y if the network with parameters θ outputs a probability distribution over labels p 0 1 0 4 0 2 0 1 0 2 and the true label y 2 then we can obtain the loss j x y θ 0 log 0 1 1 log 0 4 0 log 0 2 0 log 0 1 0 log 0 2 0 3979 although p 2 0 4 is the max value in p and the predicted label is 2 same as the true label the probability is not good enough we expect the output of seqcnn will be p e x p e c t e d 0 1 0 0 0 and the loss will be j x y θ e x p e c t e d log 1 0 therefore if we can find appropriate parameters θ to obtain smaller loss value the seqcnn has a better performance in this paper we use adam algorithm to find such parameters and the detailed process of updating parameters is shown below then the well known back propagation algorithm le cun 1986 rumelhart et al 1986 can calculate gradients using the chain rule given the derivatives with respect to its outputs each layer can independently calculate derivatives with respect to its inputs and trainable parameters as proposed by bottou and gallinari 1990 this is a mature technology currently commonly used deep learning frameworks such as tensorflow pytorch can realize the back propagation of gradients according to the forward calculation process designed by researchers as a result researchers can focus on the structural design of neural networks 4 experiment in order to verify the effectiveness of the proposed seqcnn algorithm the experiment was carried out by using haizhe several different models were tested using the same data and their performances are compared in this section 4 1 experimental setup fault is often accompanied by loss or damage and data acquisition is challenging when the auv is in a faulty state we set five common fault types under laboratory conditions including normal state slight damage to the propeller severe damage to the propeller failure of the depth sensor and load increase as shown in fig 6 in order to introduce the experiment clearly necessary experimental instructions are given as follows in the experiment haizhe had only one fault type at the same time and there was no multi failure concurrency in practice one significant fault often leads to something worse therefore once a fault occurs in the auv measures should be timely taken to avoid the occurrence of multiple faults the fault of depth sensor was not the hardware damage but artificially added a bias item when reading the pressure value which made the calculated depth value deviate from the true value for example when the true depth was 0 5 m the depth calculated by the sensor was 0 6 m haizhe sailed underwater for 10 20 s each time the state data recorded in the experiment was used as a data sample for further processing 4 2 data collection fig 7 shows a complete data collection test of the haizhe auv firstly the fault type was set and recorded for the haizhe then the initializer was executed to check whether each component could work properly or not after that haizhe executed the main program and turned on the function of data recording and then haizhe began sailing underwater it is worth noting that different behavioral responses would be generated under the influence of different fault types but the main program did not change after completing the main program haizhe would stop data recording and automatically rose to the surface finally the file system of haizhe would save the state data as a text file also called a data sample for each fault type haizhe was tested several times for each time haizhe ran the same program and sailed underwater for 10 20 s to ensure that state data was long enough the state data recorded in each test were then used as a data sample and the corresponding fault type was the true label of the data sample all the data samples constitute the final dataset the training dataset and the test dataset obtained through random stratified sampling the test dataset accounted for 20 of the total dataset the specific number is shown in table 1 the training dataset will be used for model training while the test dataset will be used to verify its effectiveness 4 3 pre processing pre processing is an essential procedure which directly determines the input of the seqcnn the whole procedure includes sequence length processing data normalization and further feature processing which are specifically described as follows sequence length processing setting a fixed size sequence length if the original sequence length is insufficient it will be padded by repeating the last moment state data if the original sequence length is too long the tail data will be clipped the sequence length was set to 196 in the experiment feature processing using the duty ratio of the pwm wave to calculate the average voltage and effective voltage of the motor data normalization each feature is mapped to the interval 0 1 by using the 0 1 normalization method this method can speed up the gradient descent and improve the convergence speed of the model a matrix of 196 17 was obtained from each state data where the number 196 represented the sequence length and 17 represented the dimension of feature including duty ratio depth value voltage average voltage effective voltage three axis attitude angle angular velocity and acceleration in the body coordinate system three axis acceleration in the geodetic coordinate system the matrix was used as the input of the proposed seqcnn 4 4 hyperparameters and training the hyperparameters of the seqcnn were set as follows relu glorot et al was employed as the activation function f the kernel size h were 3 5 7 20 with 64 64 128 16 feature maps respectively the globalaveragepooling was utilized in pooling layer the dropout rate was 0 4 the learning rate 0 001 and the batch size 128 these hyperparameters were determined via k fold cross validation k was set to 5 in this paper on the training set and the specific process is listed as follows 1 evenly divide the original training set into five sub datasets 2 choose one sub dataset as the validation set and the remaining four sub datasets as the training set 3 use four sub datasets to train the model and then calculate the diagnosis accuracy of the model on the validation set 4 repeat 2 and 3 for five times and a different sub dataset will be chosen as the verification set in each time 5 calculate the average accuracy from five verification sets to evaluate the diagnosis performance of the model 6 adjust the hyperparameters of the model and repeat 2 3 4 and 5 choose a set of hyperparameters that will make the model have the best diagnosis performance in the 5 fold cross validation it is impossible to test all the possible combinations of hyperparameters in our experience the performance of the model was significantly affected by adjusting the dropout rate and the size or number of convolution kernels 4 5 model variations in order to verify the performance of seqcnn six different models were established three of which were with global feature while another three were without global feature seqcnn std a model with the same architecture as shown in fig 5 seqcnn no glb same as above but do not use global feature rnn std a model using the recurrent neural network rnn to extract local feature from input and then concatenate global feature rnn no glb same as above but do not use global feature lstm std a model using the long short term memory lstm to extract local feature from input and then concatenate global feature lstm no glb same as above but do not use global feature each model was trained with the same training set and the optimal hyperparameters were set to eliminate the influence of other randomness as much as possible their prediction accuracy was compared using the same test set the prediction accuracy of different models in the training set and test set is illustrated in fig 8 the parameters of models were initialized randomly in each epoch the training set was passed into models for training the backpropagation algorithm was then used to update the parameters 5 results and discussion the results of diagnosis accuracy are shown in table 2 the accuracy of seqcnn was the best in the test set more specifically the maximum value of seqcnn std that is with global feature was 97 96 compared to that of lstm std 88 16 and rnn std 86 94 while for those without global feature the maximum value of seqcnn no glb was 94 29 compared to that of lstm no glb 65 31 and rnn no glb 37 96 it is obvious that the accuracy of the seqcnn model is far superior to the lstm and rnn model whether global feature is used or not implying the powerful capability of the seqcnn algorithm in the sequence data processing the results also indicate that it is practicable to predict fault type by analyzing state data furthermore by comparing the performances of the models using global feature with those that do not we can see that the global feature is helpful to improve the prediction accuracy one possible reason is that global feature contains effective information which helps the model to make correct predictions on test samples interestingly for the accuracy improvement global feature contributes the most to the rnn model while it contributes the least to the seqcnn model therefore the effective information in local feature can be considered comparable to global feature in the seqcnn model we could also find that the performance of the lstm was better than that of the rnn the same finding was also reported by bengio et al 1994 hochreiter and schmidhuber 1997 a possible explanation for this might be that gradient disappearance or gradient explosion would occur when the rnn updated parameters using the backpropagation algorithm as the sequence length increased the results show that the proposed model free fault diagnosis scheme with the designed seqcnn is more feasible for modeling the correlation between state data and fault type than the rnn and the lstm moreover the analysis of sequence data by the network using convolution is proved to be effective furthermore it is easier for users to train the diagnosis system by telling fault type instead of compiling a complex predictive model in computer language 6 conclusion a model free fault diagnosis scheme with a new diagnosis algorithm seqcnn was proposed in this paper the proposed seqcnn is based on deep learning technique and learns patterns between state data and fault type the proposed scheme completes the diagnosis in the single stage mode using the correlation between state data and fault type rather than the model of auv which can reduce the time consuming burden significantly simplify the diagnosis procedure and improve the efficiency more importantly the proposed seqcnn is more accurate than other algorithms and its effectiveness was experimentally verified there is some further work to be done on the proposed method it seems impossible to set up all fault types under experimental conditions however a possible solution to this problem is to use existing life long learning techniques thrun 1994 allowing the system to continue to learn new fault types we will investigate the diagnosis method that combines the model based and model free approaches because of their complementary advantages besides multiple auvs have received considerable attention in recent years han et al 2020 in a multi auv mission lots of auvs are composed into a cooperative system with leaderless or leader follower mode li and wang 2013 although some effective research efforts have been made on control system design such as formation control yang et al 2019 cui et al 2010 and cooperative control shen et al 2014 cui et al 2016 only a few papers have addressed the fault problems in multiple auv systems chen and ho 2016 kadiyam et al 2020 therefore it is highly desirable to develop fault diagnosis method for multiple auv systems credit authorship contribution statement daxiong ji conceptualization methodology software xin yao data curation writing original draft preparation shuo li investigation yuangui tang supervision yu tian validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the national key research and development program of china 2016yfc0300801 and the basic public welfare research plan of zhejiang province china lgf20e090004 
20698,this paper focus on the trajectory tracking of autonomous underwater vehicles auvs in complex ocean environments a novel lyapunov based model predictive control lmpc framework is designed for auv which improves the performance of trajectory tracking through online optimization by incorporating salient features of lyapunov based nonlinear backstepping control the contraction constraint is constructed to ensure the closed loop stability within this framework the actual limitation of executor saturation could be clearly considered next the recursive feasibility and closed loop stability of the lmpc based control are rigorously proved also the guaranteed region of attraction roa is clearly described finally the simulation results demonstrate the feasibility and robustness of the designed lmpc trajectory tracking method keywords autonomous underwater vehicle model predictive control trajectory tracking nonlinear backstepping control 1 introduction auv plays an important role in ocean research it can navigate autonomously and remotely and can carry different functional modules through online perception information processing and mission reconstruction auv could adapt to the complex underwater environment and complete the given tasks autonomously yu et al 2019 which has attracted more and more attention from academic circles trajectory tracking is the basis for auv to complete the given task but is by no means an easy task highly coupled and nonlinear system dynamics as well as complex underwater environments are problems faced by controller designers scholars from all over the world have conducted a lot of research on the trajectory tracking of auv the main methods include backstepping control sliding mode control robust control fuzzy control model predictive control and adaptive control method when the desired trajectory can be locally linearized classical linear control techniques such as pid and lqr can solve the trajectory tracking problem fossen 2002 however linear control techniques are no longer being effective when the desired trajectory is a spatial curve therefore nonlinear control methods are usually used to design tracking controllers the combination of lyapunov method and backstepping control has become the main control method this method gradually simplifies the complex control system design and has good robustness sun et al 2014 xia et al 2015 however the backstepping control itself cannot resolve external disturbances and system parameter uncertainty due to the invariance of parameter perturbation and external disturbance cheng et al 2007 sliding mode control has become another main method for auv trajectory tracking the second order sliding mode controller designed by valenciaga et al 2014 based on sta spuper twisting algorithm in 2014 can effectively solve the problem of nonlinear bounded disturbances caused by environmental disturbances such as ocean currents and waves in 2019 van et al further used neural network learning to approximate system uncertainty and considered online learning weights as system states van 2019 in order to effectively eliminate high frequency chattering and ensure that the system state reaches the expected value in a specified limited time qiao et al 2017 designed a non singular terminal sliding mode controller for the 6 dof auv in 2017 which ensured that the auv could achieve accurate trajectory tracking control under the full actuated configuration system constraints such as speed and thrust limits are unavoidable in practical applications and should be taken into account when designing the controller model predictive control mpc method performs well in dealing with control problems with multiple constraints multiple variables and uncertainty and provides a powerful control framework for solving control problems xi et al 2013 li et al 2016 in 2017 shen et al proposed a scheme of receding horizon control for the planning and tracking of the plane trajectory of auv and gave the stability conditions of auv trajectory tracking control based on model prediction shen et al 2017 some researchers heshmati alamdari et al 2020a nikou et al 2018 2021 use the tube based mpc framework for control design and part of the control design is the backstepping control design more specifically robust nmpc with guaranteed feasibility and convergence has been designed and verified via experimental studies for auv in constrained environments heshmati alamdari et al 2020b however the control input obtained by mpc by solving the optimization problem is an implicit function of the control system which brings challenges to the analysis of the closed loop stability of nonlinear systems mpc uses a limited prediction horizon but the scheme optimality does not represent closed loop stability to ensure the stability of closed loop commonly used stability methods include infinite time horizon method muske et al 1993 terminal equality constraint mayne and michalska 1990 michalska and mayne 1993 and so on mayne and scokaert 1999 kothare and morari 2000 for constrained nonlinear problems the finite time domain method is difficult to optimize for solution the terminal equation constraint increases the computational effort for online optimization while ensuring stability since stability is an important property of the control system it is necessary to devise a method to ensure closed loop stability of trajectory tracking control in view of the above problems this paper investigates the trajectory tracking control of fully actuated 5 dof auv in complex ocean environments to provide robustness and adaptability a double closed loop nonlinear model predictive controller composed of an inner speed loop and an outer position loop is designed based on the previous research yan et al 2020 inspired by the work in shen et al 2017 a novel lyapunov based model predictive control lmpc framework is designed for auv which improves the performance of trajectory tracking through online optimization the main advantage of the designed method is that the contraction constraint is constructed by combining double closed loop mpc with the lyapunov based backstepping technique which ensures the closed loop stability of the controller the designed lmpc control method avoids the local linearization required by traditional model predictive control christofides et al 2011 in addition the closed loop stability and recursive feasibility of the lmpc based control are rigorously proved and the guaranteed region of attraction roa is clearly described the difference between the designed method and others is that the dynamical couplings and the external disturbance velocity are directly taken into account the simulation results demonstrate the feasibility of the designed lmpc trajectory tracking method the rest of this paper is arranged as follows the mathematical model of the fully actuated auv under external disturbances is developed in section2 section 3 presents the lyapunov based nonlinear model predicting the controller design and the construction of the contraction constraint section 4 introduces the recursive feasibility analysis and strict stability analysis of the entire closed loop system simulation results and conclusions are given in sections 5 and 6 respectively 2 auv model two coordinate systems are introduced to describe the motion of auv as shown in fig 1 the origin of the motion coordinate system o x y z is defined at the center of gravity of the vehicle the fixed coordinate system e ξ η ζ is selected to be a fixed point on the earth which describes the global information of the vehicle movement consider the fully actuated auv in the literatures fossen 2011 yan et al 2020 and the matrix form of the mathematical model expression of the auv is as follows 1 η j η ν 2 m ν c ν ν d ν ν g η τ the rotation matrix j η denotes the transformation from the motion coordinate system to the fixed coordinate system which is 3 j η cos ψ cos θ sin ψ sin θ cos ψ 0 0 sin ψ cos θ cos ψ sin θ sin ψ 0 0 sin θ 0 cos θ 0 0 0 0 0 1 0 0 0 0 0 1 cos θ η ξ η ζ θ ψ denotes the position coordinates in the fixed coordinate system e ξ η ζ ν u v w q r denotes the velocities in the motion coordinate system o x y z m denotes the inertia matrix including the added mass which is written as 4 m m x u 0 0 0 0 0 m y v 0 0 0 0 0 m z w 0 0 0 0 0 i y m q 0 0 0 0 0 i z n r the coriolis and centripetal matrix c v is given by 5 c v 0 0 0 m w z w w m v y v v 0 0 0 0 m u x u u 0 0 0 m u x u u 0 m w z w w 0 m u x u u 0 0 m v y v v m u x u u 0 0 0 d v d i a g x u y v z w m q n r d i a g x u u u y v v v z w w w m q q q n r r r is the hydrodynamic damping matrix g η 0 0 0 ρ g v g m l sin θ 0 t denotes the vector of restoring forces and moments τ τ u τ v τ w τ q τ r t represents the input forces and moments 3 lyapunov based mpc trajectory tracking controller this article focuses on the auv trajectory tracking problem in complex ocean environments the main control task is to drive the auv to accurately track any time varying reference trajectory in three dimensional space the closed loop system includes inner loop and outer loop the outer loop position controller uses output feedback of the system to design the expected velocity that is to guaranteed the convergence of the auv position tracking error the inner loop velocity controller uses actual control input of the system to perform that the driving velocity of the auv gradually converges to the desired driver instruction so as to guaranteed the convergence of the auv velocity tracking error yan 2020 firstly consider a desired trajectory y d ξ d η d ζ d θ d ψ d t which defines the pose information of the auv in three dimensional space and the velocity satisfies v d ξ d 2 η d 2 the pitch and yaw angles are defined as θ d atan 2 ζ d v t ψ d atan 2 η d ξ d it is easy to prove that the desired trajectory y d is smooth and bounded shen 2017 therefore the proposition 1 is given as follows proposition 1 the desired trajectory y d ξ d η d ζ d θ d ψ d t together with its derivatives is smooth and bounded satisfying that y d t y d y d t y d 1 y d t y d 2 for some positive numbers y d y d 1 y d 2 3 1 outer loop mpc based controller the kinematic model for the auv can be established by 1 6 x 1 j η ν f x 1 u 1 where the state is defined as x 1 ξ η ζ θ ψ t and the control as u 1 u v w q r t then the mpc formulation for the auv outer loop controller can be established as follows 7 min u ˆ 1 s h j 1 0 t p x 1 s q 1 2 u ˆ 1 s r 1 2 d s x 1 t p p 1 2 s t x ˆ 1 s f 1 x ˆ 1 s u ˆ 1 s x ˆ 1 0 x 1 t 0 u ˆ 1 s u 1 max v 1 x 1 f x ˆ 1 0 u ˆ 1 0 v 1 x 1 f x ˆ 1 0 l 1 x ˆ 1 0 where x ˆ 1 s is the predicted state with respect to the predictive control u ˆ 1 s evolving from x ˆ 1 0 using the system model x 1 x ˆ 1 y d is the error state s h denotes the family of functions characterized by the sampling period h and t p n h is the prediction horizon the weighting matrices q 1 r 1 and p 1 are positive definite as we all know the optimal solution cannot automatically guarantee the stability of the closed loop system due to the finite prediction horizon to guarantee this characteristic complex offline design should be carried out for nonlinear systems the region of attraction roa will be defined implicitly by taking the standard mpc method to solve the above problems the nonlinear backstepping control law based on lyapunov will be adopted and the following contraction constraint will be added to the original mpc to express the outer loop controller problem 8 v 1 x 1 f x ˆ 1 0 u ˆ 1 0 v 1 x 1 f x ˆ 1 0 l 1 x ˆ 1 0 where l 1 is the subsidiary lyapunov based nonlinear control law and v 1 is the corresponding lyapunov function the contraction constraint 8 can prove that the outer loop controller inherits the stability of the state feedback control l 1 and the guaranteed roa can be explicitly expressed furthermore the outer loop controller will automatically perform the best control performance that respects the physical limitation of the system due to the optimization procedure the details of constructing contraction constraint 8 will be given in section 3 3 3 2 inner loop mpc based controller the dynamic model for the auv can be established by 2 9 x 2 m 1 τ c d ν r g f x 2 u 2 where ν r ν ν e d ν e d is the ocean current velocity ν c or random disturbance velocity ν r d the state is defined as x 2 u v w q r t and the control as u 2 τ u τ v τ w τ q τ r t then the mpc formulation for the auv inner loop controller can be established as follows 10 min u ˆ 2 s h j 2 0 t p x 2 s q 2 2 u ˆ 2 s r 2 2 d s x 2 t p p 2 2 s t x ˆ 2 s f 2 x ˆ 2 s u ˆ 2 s x ˆ 2 0 x 2 t 0 u ˆ 2 s u 2 max v 2 x 2 f x ˆ 2 0 u ˆ 2 0 v 2 x 2 f x ˆ 2 0 l 2 x ˆ 2 0 where x ˆ 2 s is the predicted state with respect to the predictive control input u ˆ 2 s evolving from x ˆ 2 0 using the system model x 2 x ˆ 2 v d is the error state v d is derived by the inner loop controller s h denotes the family of functions characterized by the sampling period h and t p n h is the prediction horizon the weighting matrices q 2 r 2 and p 2 are positive definite similarly the following contraction constraint will also be added to the inner loop controller 11 v 2 x 2 f x ˆ 2 0 u ˆ 2 0 v 2 x 2 f x ˆ 2 0 l 2 x ˆ 2 0 where l 2 is the subsidiary lyapunov based nonlinear control law and v 2 is the corresponding lyapunov function the details of constructing contraction constraint 11 will be given in next section the lmpc trajectory tracking control will be performed in the receding horizon and the whole control algorithm is summarized in algorithm 1 algorithm 1 image 1 remark 1 in algorithm 1 the suboptimal solution is acceptable for the nonlinear mpc algorithm the iterative methods can be used to ensure that 7 and 10 are locally optimal at the same time limit the number of iterations to perform real time control it is easily to make trade off by specifying the maximum number of iterations without destroying the stability of tracking control 3 3 contraction constraints construction to construct the contraction constraints in 8 and 11 it is necessary to find the state feedback controller and the corresponding lyapunov function for the trajectory tracking of the auv the non linear controller based on lyapunov can be designed by backstepping control method firstly the contraction constraint of the inner loop controller is constructed consider the following lyapunov function 12 v 1 1 2 η t k 1 η where k 1 k 1 t 0 is a specified control gain matrix and η η y d then the time derivative of v 1 becomes 13 v 1 η t k 1 η η t k 1 j v y d therefore select the following control law 14 v j 1 y d k p η where k p k p t 0 is a specified control gain matrix the 13 becomes the following formula 15 v 1 η t k 1 k p η since v 1 0 then by standard lyapunov arguments the closed loop system under 14 is globally asymptotically stable with respect to the equilibrium η v 0 0 therefore the detailed expression of the contraction constraint 8 corresponding to 14 is 16 η t 0 k 1 j η 0 v 0 y d 0 η t 0 k 1 k p η 0 next the contraction constraint of the outer loop controller is constructed consider the following lyapunov function 17 v 2 1 2 v t k 2 v where k 2 k 2 t 0 is a specified control gain matrix and v v r v d then the time derivative of v 2 becomes 18 v 2 v t k 2 v v t k 2 m 1 c v r d v r g τ v d therefore select the following control law 19 τ m v d c v r d v r g m k d v where k d k d t 0 is user specified control gain matrix the 18 becomes the following formula 20 v 2 v t k 2 k d v since v 2 0 then by standard lyapunov arguments the closed loop system under 19 is globally asymptotically stable with respect to the equilibrium v τ 0 0 therefore the detailed expression of the contraction constraint 8 corresponding to 19 is 21 v t 0 k 2 m 1 c v r 0 d v r 0 g η 0 τ 0 v d 0 v t 0 k 2 k d v 0 4 stability analysis in the previous section contraction constraints are constructed using the lyapunov based backstepping technique in this section the closed loop stability and recursive feasibility will be analyzed under algorithm 1 theorem 1 the control gain matrices are chosen as k p d i a g k p i positive definite let k p max k p i denote the largest element in k p suppose proposition 1 can hold for l 1 x 1 v x 1 if the following relation can be satisfied 22 1 2 2 y d 1 k p η 0 2 v max then the outer loop mpc based controller 7 admits recursive feasibility i e l 1 x ˆ 1 t u 1 max for all t 0 proof consider the given the current system state x 1 t l 1 x ˆ 1 is always feasible for outer loop controller 7 if l 1 x ˆ 1 u 1 max can be satisfied since v 1 0 we have η t 2 η 0 2 considering that η η 2 we have η η 2 η 0 2 according to the actual situation the trim angle θ is constrained i e 0 θ π 4 j 1 η max cos ψ cos θ sin ψ cos θ sin θ sin θ cos ψ sin θ sin ψ cos θ 1 2 1 2 2 taking infinity norm on both sides of 14 together with proposition 1 we have 23 v x ˆ 1 1 2 2 y d 1 k p η 0 2 then v x ˆ 1 v max can hold we can guarantee that l 1 x ˆ 1 t u 1 max satisfied all the time the proof of theorem 1 is completed assumption 1 the external disturbance velocity v e d is bounded satisfying that v e d v e d for the positive number v e d theorem 2 the control gain matrices are chosen as k d d i a g k d i positive definite let k d max k d i denote the largest element in k d suppose proposition 1 and assumption 1 can hold and combine 23 for l 2 x 2 τ x 2 if the following relation can be satisfied 24 m v d c d v r g m k d v 0 2 τ max with v d 2 2 h y d 1 k p η 0 2 and v r 1 2 2 y d 1 k p η 0 2 v e d then the inner loop mpc based controller 9 admits recursive feasibility i e l 2 x ˆ 2 t u 2 max for all t 0 proof consider the given the current system state x 2 t τ x ˆ 2 is always feasible for inner loop controller 9 if l 2 x ˆ 2 u 2 max can be satisfied the initial matrix is symmetric positive definite and upper bounded 0 m m t i m and the restoring force g η is bounded g η g fossen 2002 by definition and combine 23 we have v d v v t h v t h then taking infinity norm on v d the following can hold 25 v d v v t h v t h 1 h v t h v t 2 h v x ˆ 1 v d where v d 2 2 h y d 1 k p η 0 2 v r can be obtained in the same way taking infinity norm on 5 and substituting 23 we have 26 c v r c 2 2 m y d 1 k p η 0 2 2 v e d m d v can be obtained in the same way 27 d v r d d 1 1 2 2 y d 1 k p η 0 2 v e d d 2 where d 1 max x u y v z w m q n r and d 2 max x u u y v v z w w m q q n r r taking infinity norm on both sides of 19 together with proposition 1 we have 28 τ x ˆ 2 m v d c d v r g m k d v 0 2 then τ x ˆ 2 τ max can hold we can guarantee that l 2 x ˆ 2 t u 2 max satisfied all the time the proof of theorem 2 is completed theorem 3 suppose proposition 1 and assumption 1 can hold then the system under theorem 1 is asymptotically stable with the equilibrium η v 0 0 theorem 2 is asymptotically stable with the equilibrium v τ 0 0 i e the auv will track the desired trajectory y d with the lmpc trajectory tracking control proof since the lyapunov function v 1 x in 12 by converse lyapunov theorems khalil 1996 there exist functions γ i i 1 2 3 these functions belong to class k and satisfy the following inequalities 29 γ 1 x 1 v 1 x 1 γ 2 x 1 30 v 1 x 1 f x 1 l 1 x 1 γ 3 x 1 the optimal solution κ 1 s will be implemented and combine 16 we have 31 v 1 x 1 f x 1 u 1 x 1 v 1 x 1 f x 1 l 1 x 1 γ 3 x 1 by the lyapunov theorems khalil 1996 the following conclusion can be drawn that the outer loop mpc based controller under theorem 1 is asymptotically stable in the region of attraction ℝ 1 32 x 1 x 1 ℝ 1 n 22 the same can be obtained the inner loop mpc based controller under theorem 2 is asymptotically stable in the region of attraction ℝ 2 33 x 2 x 2 ℝ 2 n 24 furthermore x 1 and x 2 can be enlarged by reducing the value of the control gains k p and k d respectively theorem 4 consider the fully actuated auv with the kinematics in 1 and dynamics in 2 suppose proposition 1 and assumption 1 can hold if the outer loop controller is given in 7 and the inner loop controller is given in 10 and the contraction constraints are constructed by 16 and 21 then the overall closed loop system is proved to be asymptotically stable proof the controller consists of an inner loop controller and an outer loop controller so the stability analysis of the overall closed loop system should be proved using a unified lyapunov function consider the following lyapunov function as 34 v 3 1 2 η t k 1 η 1 2 v t k 2 v selecting control laws 14 and 19 the time derivative of v 3 becomes 35 v 3 η t k 1 η v t k 2 v η t k 1 j v y d v t k 2 m 1 c v r d v r g τ v d η t k 1 k p η v t k 2 k d v 0 we can conclude that the overall closed loop system is proved to be asymptotically stable 5 simulation results the simulations of the auv tracking control are given in this section which proves the effectiveness and robustness of the designed lmpc controller all the parameters related to the auv are based on pettersen s research pettersen et al 1999 the desired trajectory is a spiral diving trajectory to test the auv tracking control as shown in 34 and the initial state of the auv is 0 5 0 0 0 t 36 ξ d 10 sin 0 03 t η d 10 cos 0 03 t ζ d 0 05 t the relevant parameters of the lmpc controller are as follows sampling period h 0 2 s prediction horizon t p 5 h weighting matrices q 1 q 2 d i a g 10 3 10 3 10 3 10 3 10 3 r 1 r 2 d i a g 1 1 1 1 1 p 1 p 2 d i a g 1 1 1 1 1 and the limit of each propeller is 500 n the control gains k p d i a g 1 1 1 1 1 k d d i a g 1 1 1 1 1 k 1 k 2 d i a g 1 1 1 1 1 to solve lmpc problems 7 and 10 numerically the problems are discretized first and then the corresponding karush kuhn tucker conditions are solved by sequential quadratic programming method 5 1 trajectory tracking performance without external disturbances the auv tracking results are shown in figs 2 4 the red curve is the simulated auv trajectories with the proposed lmpc control and the blue curve is the auv trajectories using terminal sliding mode control tsmc while the black curve is the desired trajectory it can be seen from the figure that lmpc and tsmc make auv track desired trajectory well which verifies the closed loop stability but the lmpc controller has faster convergence than the tsmc controller the main reason is to ensure a large region of attraction by choosing a small control gain matrices k p and k d meanwhile online optimization improves the tracking control performance the control input signals of the auv are shown in fig 5 it can be seen from the figure that the lmpc controller converges as quickly as possible while complying with the physical limit of the propellers at the beginning of tracking in other words the magnitude of the control commands is within the expected allowable range 5 2 trajectory tracking performance with external disturbances because the implementation of receding horizon introduces feedback into the closed loop system the lmpc control method is robust to uncertainties and disturbances to test the robustness of the lmpc and tsmc the trajectory tracking control of auv will be carried out under the current and random disturbance both types of disturbances are defined in fixed coordinate system e ξ η ζ the ocean current disturbance is defined as follows 37 u c 0 15 m s v c 0 15 m s the random disturbance is defined as follows 38 u r d 0 2 r a n d 1 m s v r d 0 2 r a n d 1 m s where r a n d 1 is a normal distribution noise signal with 0 mean and 1 variance the trajectories tracking with ocean current results are displayed in figs 6 9 as shown in the figures the lmpc tracking control still drive the auv well to the desired trajectory while the tsmc tracking control exists larger tracking errors the lmpc method uses online optimization to arrange appropriate control gain to compensate disturbances while tsmc lacks such flexibility therefore lmpc can improve the robustness of the auv trajectory tracking control the simulation results for auv tracking control with random disturbance are provided through figs 10 13 similar observations can be made the proposed lmpc tracking control has faster convergence to the desired trajectory than the tsmc controller and the control input commands are always feasible for the auv system 6 conclusion in this paper a novel lmpc based method for the autonomous underwater vehicle trajectory tracking is designed the contraction constraints are constructed using the lyapunov based backstepping technique the online optimization of mpc and the nonlinear backstepping stepping control based on lyapunov are combined to improve control performance and robustness the closed loop stability and recursive feasibility of the lmpc based control are rigorously proved and the guaranteed region of attraction roa is clearly described the simulation results demonstrate the feasibility of the designed lmpc trajectory tracking method in the next work plan experiments will be performed to verify the designed algorithm and we will further study the advanced control method and integrate its advantages into mpc method to improve the closed loop characteristics of the auv credit authorship contribution statement peng gong methodology simulation writing original draft writing review editing zheping yan conceptualization funding acquisition writing review editing wei zhang visualization investigation supervision jialing tang writing review editing supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by national natural science foundation of china the funding number is no 52071102 no 51679057 no 51609046 the province science fund for distinguished young scholars the funding number is no j2016jq0052 the ph d student research and innovation fund of the fundamental research funds for the central universities the funding number is no 3072020gip0410 
20698,this paper focus on the trajectory tracking of autonomous underwater vehicles auvs in complex ocean environments a novel lyapunov based model predictive control lmpc framework is designed for auv which improves the performance of trajectory tracking through online optimization by incorporating salient features of lyapunov based nonlinear backstepping control the contraction constraint is constructed to ensure the closed loop stability within this framework the actual limitation of executor saturation could be clearly considered next the recursive feasibility and closed loop stability of the lmpc based control are rigorously proved also the guaranteed region of attraction roa is clearly described finally the simulation results demonstrate the feasibility and robustness of the designed lmpc trajectory tracking method keywords autonomous underwater vehicle model predictive control trajectory tracking nonlinear backstepping control 1 introduction auv plays an important role in ocean research it can navigate autonomously and remotely and can carry different functional modules through online perception information processing and mission reconstruction auv could adapt to the complex underwater environment and complete the given tasks autonomously yu et al 2019 which has attracted more and more attention from academic circles trajectory tracking is the basis for auv to complete the given task but is by no means an easy task highly coupled and nonlinear system dynamics as well as complex underwater environments are problems faced by controller designers scholars from all over the world have conducted a lot of research on the trajectory tracking of auv the main methods include backstepping control sliding mode control robust control fuzzy control model predictive control and adaptive control method when the desired trajectory can be locally linearized classical linear control techniques such as pid and lqr can solve the trajectory tracking problem fossen 2002 however linear control techniques are no longer being effective when the desired trajectory is a spatial curve therefore nonlinear control methods are usually used to design tracking controllers the combination of lyapunov method and backstepping control has become the main control method this method gradually simplifies the complex control system design and has good robustness sun et al 2014 xia et al 2015 however the backstepping control itself cannot resolve external disturbances and system parameter uncertainty due to the invariance of parameter perturbation and external disturbance cheng et al 2007 sliding mode control has become another main method for auv trajectory tracking the second order sliding mode controller designed by valenciaga et al 2014 based on sta spuper twisting algorithm in 2014 can effectively solve the problem of nonlinear bounded disturbances caused by environmental disturbances such as ocean currents and waves in 2019 van et al further used neural network learning to approximate system uncertainty and considered online learning weights as system states van 2019 in order to effectively eliminate high frequency chattering and ensure that the system state reaches the expected value in a specified limited time qiao et al 2017 designed a non singular terminal sliding mode controller for the 6 dof auv in 2017 which ensured that the auv could achieve accurate trajectory tracking control under the full actuated configuration system constraints such as speed and thrust limits are unavoidable in practical applications and should be taken into account when designing the controller model predictive control mpc method performs well in dealing with control problems with multiple constraints multiple variables and uncertainty and provides a powerful control framework for solving control problems xi et al 2013 li et al 2016 in 2017 shen et al proposed a scheme of receding horizon control for the planning and tracking of the plane trajectory of auv and gave the stability conditions of auv trajectory tracking control based on model prediction shen et al 2017 some researchers heshmati alamdari et al 2020a nikou et al 2018 2021 use the tube based mpc framework for control design and part of the control design is the backstepping control design more specifically robust nmpc with guaranteed feasibility and convergence has been designed and verified via experimental studies for auv in constrained environments heshmati alamdari et al 2020b however the control input obtained by mpc by solving the optimization problem is an implicit function of the control system which brings challenges to the analysis of the closed loop stability of nonlinear systems mpc uses a limited prediction horizon but the scheme optimality does not represent closed loop stability to ensure the stability of closed loop commonly used stability methods include infinite time horizon method muske et al 1993 terminal equality constraint mayne and michalska 1990 michalska and mayne 1993 and so on mayne and scokaert 1999 kothare and morari 2000 for constrained nonlinear problems the finite time domain method is difficult to optimize for solution the terminal equation constraint increases the computational effort for online optimization while ensuring stability since stability is an important property of the control system it is necessary to devise a method to ensure closed loop stability of trajectory tracking control in view of the above problems this paper investigates the trajectory tracking control of fully actuated 5 dof auv in complex ocean environments to provide robustness and adaptability a double closed loop nonlinear model predictive controller composed of an inner speed loop and an outer position loop is designed based on the previous research yan et al 2020 inspired by the work in shen et al 2017 a novel lyapunov based model predictive control lmpc framework is designed for auv which improves the performance of trajectory tracking through online optimization the main advantage of the designed method is that the contraction constraint is constructed by combining double closed loop mpc with the lyapunov based backstepping technique which ensures the closed loop stability of the controller the designed lmpc control method avoids the local linearization required by traditional model predictive control christofides et al 2011 in addition the closed loop stability and recursive feasibility of the lmpc based control are rigorously proved and the guaranteed region of attraction roa is clearly described the difference between the designed method and others is that the dynamical couplings and the external disturbance velocity are directly taken into account the simulation results demonstrate the feasibility of the designed lmpc trajectory tracking method the rest of this paper is arranged as follows the mathematical model of the fully actuated auv under external disturbances is developed in section2 section 3 presents the lyapunov based nonlinear model predicting the controller design and the construction of the contraction constraint section 4 introduces the recursive feasibility analysis and strict stability analysis of the entire closed loop system simulation results and conclusions are given in sections 5 and 6 respectively 2 auv model two coordinate systems are introduced to describe the motion of auv as shown in fig 1 the origin of the motion coordinate system o x y z is defined at the center of gravity of the vehicle the fixed coordinate system e ξ η ζ is selected to be a fixed point on the earth which describes the global information of the vehicle movement consider the fully actuated auv in the literatures fossen 2011 yan et al 2020 and the matrix form of the mathematical model expression of the auv is as follows 1 η j η ν 2 m ν c ν ν d ν ν g η τ the rotation matrix j η denotes the transformation from the motion coordinate system to the fixed coordinate system which is 3 j η cos ψ cos θ sin ψ sin θ cos ψ 0 0 sin ψ cos θ cos ψ sin θ sin ψ 0 0 sin θ 0 cos θ 0 0 0 0 0 1 0 0 0 0 0 1 cos θ η ξ η ζ θ ψ denotes the position coordinates in the fixed coordinate system e ξ η ζ ν u v w q r denotes the velocities in the motion coordinate system o x y z m denotes the inertia matrix including the added mass which is written as 4 m m x u 0 0 0 0 0 m y v 0 0 0 0 0 m z w 0 0 0 0 0 i y m q 0 0 0 0 0 i z n r the coriolis and centripetal matrix c v is given by 5 c v 0 0 0 m w z w w m v y v v 0 0 0 0 m u x u u 0 0 0 m u x u u 0 m w z w w 0 m u x u u 0 0 m v y v v m u x u u 0 0 0 d v d i a g x u y v z w m q n r d i a g x u u u y v v v z w w w m q q q n r r r is the hydrodynamic damping matrix g η 0 0 0 ρ g v g m l sin θ 0 t denotes the vector of restoring forces and moments τ τ u τ v τ w τ q τ r t represents the input forces and moments 3 lyapunov based mpc trajectory tracking controller this article focuses on the auv trajectory tracking problem in complex ocean environments the main control task is to drive the auv to accurately track any time varying reference trajectory in three dimensional space the closed loop system includes inner loop and outer loop the outer loop position controller uses output feedback of the system to design the expected velocity that is to guaranteed the convergence of the auv position tracking error the inner loop velocity controller uses actual control input of the system to perform that the driving velocity of the auv gradually converges to the desired driver instruction so as to guaranteed the convergence of the auv velocity tracking error yan 2020 firstly consider a desired trajectory y d ξ d η d ζ d θ d ψ d t which defines the pose information of the auv in three dimensional space and the velocity satisfies v d ξ d 2 η d 2 the pitch and yaw angles are defined as θ d atan 2 ζ d v t ψ d atan 2 η d ξ d it is easy to prove that the desired trajectory y d is smooth and bounded shen 2017 therefore the proposition 1 is given as follows proposition 1 the desired trajectory y d ξ d η d ζ d θ d ψ d t together with its derivatives is smooth and bounded satisfying that y d t y d y d t y d 1 y d t y d 2 for some positive numbers y d y d 1 y d 2 3 1 outer loop mpc based controller the kinematic model for the auv can be established by 1 6 x 1 j η ν f x 1 u 1 where the state is defined as x 1 ξ η ζ θ ψ t and the control as u 1 u v w q r t then the mpc formulation for the auv outer loop controller can be established as follows 7 min u ˆ 1 s h j 1 0 t p x 1 s q 1 2 u ˆ 1 s r 1 2 d s x 1 t p p 1 2 s t x ˆ 1 s f 1 x ˆ 1 s u ˆ 1 s x ˆ 1 0 x 1 t 0 u ˆ 1 s u 1 max v 1 x 1 f x ˆ 1 0 u ˆ 1 0 v 1 x 1 f x ˆ 1 0 l 1 x ˆ 1 0 where x ˆ 1 s is the predicted state with respect to the predictive control u ˆ 1 s evolving from x ˆ 1 0 using the system model x 1 x ˆ 1 y d is the error state s h denotes the family of functions characterized by the sampling period h and t p n h is the prediction horizon the weighting matrices q 1 r 1 and p 1 are positive definite as we all know the optimal solution cannot automatically guarantee the stability of the closed loop system due to the finite prediction horizon to guarantee this characteristic complex offline design should be carried out for nonlinear systems the region of attraction roa will be defined implicitly by taking the standard mpc method to solve the above problems the nonlinear backstepping control law based on lyapunov will be adopted and the following contraction constraint will be added to the original mpc to express the outer loop controller problem 8 v 1 x 1 f x ˆ 1 0 u ˆ 1 0 v 1 x 1 f x ˆ 1 0 l 1 x ˆ 1 0 where l 1 is the subsidiary lyapunov based nonlinear control law and v 1 is the corresponding lyapunov function the contraction constraint 8 can prove that the outer loop controller inherits the stability of the state feedback control l 1 and the guaranteed roa can be explicitly expressed furthermore the outer loop controller will automatically perform the best control performance that respects the physical limitation of the system due to the optimization procedure the details of constructing contraction constraint 8 will be given in section 3 3 3 2 inner loop mpc based controller the dynamic model for the auv can be established by 2 9 x 2 m 1 τ c d ν r g f x 2 u 2 where ν r ν ν e d ν e d is the ocean current velocity ν c or random disturbance velocity ν r d the state is defined as x 2 u v w q r t and the control as u 2 τ u τ v τ w τ q τ r t then the mpc formulation for the auv inner loop controller can be established as follows 10 min u ˆ 2 s h j 2 0 t p x 2 s q 2 2 u ˆ 2 s r 2 2 d s x 2 t p p 2 2 s t x ˆ 2 s f 2 x ˆ 2 s u ˆ 2 s x ˆ 2 0 x 2 t 0 u ˆ 2 s u 2 max v 2 x 2 f x ˆ 2 0 u ˆ 2 0 v 2 x 2 f x ˆ 2 0 l 2 x ˆ 2 0 where x ˆ 2 s is the predicted state with respect to the predictive control input u ˆ 2 s evolving from x ˆ 2 0 using the system model x 2 x ˆ 2 v d is the error state v d is derived by the inner loop controller s h denotes the family of functions characterized by the sampling period h and t p n h is the prediction horizon the weighting matrices q 2 r 2 and p 2 are positive definite similarly the following contraction constraint will also be added to the inner loop controller 11 v 2 x 2 f x ˆ 2 0 u ˆ 2 0 v 2 x 2 f x ˆ 2 0 l 2 x ˆ 2 0 where l 2 is the subsidiary lyapunov based nonlinear control law and v 2 is the corresponding lyapunov function the details of constructing contraction constraint 11 will be given in next section the lmpc trajectory tracking control will be performed in the receding horizon and the whole control algorithm is summarized in algorithm 1 algorithm 1 image 1 remark 1 in algorithm 1 the suboptimal solution is acceptable for the nonlinear mpc algorithm the iterative methods can be used to ensure that 7 and 10 are locally optimal at the same time limit the number of iterations to perform real time control it is easily to make trade off by specifying the maximum number of iterations without destroying the stability of tracking control 3 3 contraction constraints construction to construct the contraction constraints in 8 and 11 it is necessary to find the state feedback controller and the corresponding lyapunov function for the trajectory tracking of the auv the non linear controller based on lyapunov can be designed by backstepping control method firstly the contraction constraint of the inner loop controller is constructed consider the following lyapunov function 12 v 1 1 2 η t k 1 η where k 1 k 1 t 0 is a specified control gain matrix and η η y d then the time derivative of v 1 becomes 13 v 1 η t k 1 η η t k 1 j v y d therefore select the following control law 14 v j 1 y d k p η where k p k p t 0 is a specified control gain matrix the 13 becomes the following formula 15 v 1 η t k 1 k p η since v 1 0 then by standard lyapunov arguments the closed loop system under 14 is globally asymptotically stable with respect to the equilibrium η v 0 0 therefore the detailed expression of the contraction constraint 8 corresponding to 14 is 16 η t 0 k 1 j η 0 v 0 y d 0 η t 0 k 1 k p η 0 next the contraction constraint of the outer loop controller is constructed consider the following lyapunov function 17 v 2 1 2 v t k 2 v where k 2 k 2 t 0 is a specified control gain matrix and v v r v d then the time derivative of v 2 becomes 18 v 2 v t k 2 v v t k 2 m 1 c v r d v r g τ v d therefore select the following control law 19 τ m v d c v r d v r g m k d v where k d k d t 0 is user specified control gain matrix the 18 becomes the following formula 20 v 2 v t k 2 k d v since v 2 0 then by standard lyapunov arguments the closed loop system under 19 is globally asymptotically stable with respect to the equilibrium v τ 0 0 therefore the detailed expression of the contraction constraint 8 corresponding to 19 is 21 v t 0 k 2 m 1 c v r 0 d v r 0 g η 0 τ 0 v d 0 v t 0 k 2 k d v 0 4 stability analysis in the previous section contraction constraints are constructed using the lyapunov based backstepping technique in this section the closed loop stability and recursive feasibility will be analyzed under algorithm 1 theorem 1 the control gain matrices are chosen as k p d i a g k p i positive definite let k p max k p i denote the largest element in k p suppose proposition 1 can hold for l 1 x 1 v x 1 if the following relation can be satisfied 22 1 2 2 y d 1 k p η 0 2 v max then the outer loop mpc based controller 7 admits recursive feasibility i e l 1 x ˆ 1 t u 1 max for all t 0 proof consider the given the current system state x 1 t l 1 x ˆ 1 is always feasible for outer loop controller 7 if l 1 x ˆ 1 u 1 max can be satisfied since v 1 0 we have η t 2 η 0 2 considering that η η 2 we have η η 2 η 0 2 according to the actual situation the trim angle θ is constrained i e 0 θ π 4 j 1 η max cos ψ cos θ sin ψ cos θ sin θ sin θ cos ψ sin θ sin ψ cos θ 1 2 1 2 2 taking infinity norm on both sides of 14 together with proposition 1 we have 23 v x ˆ 1 1 2 2 y d 1 k p η 0 2 then v x ˆ 1 v max can hold we can guarantee that l 1 x ˆ 1 t u 1 max satisfied all the time the proof of theorem 1 is completed assumption 1 the external disturbance velocity v e d is bounded satisfying that v e d v e d for the positive number v e d theorem 2 the control gain matrices are chosen as k d d i a g k d i positive definite let k d max k d i denote the largest element in k d suppose proposition 1 and assumption 1 can hold and combine 23 for l 2 x 2 τ x 2 if the following relation can be satisfied 24 m v d c d v r g m k d v 0 2 τ max with v d 2 2 h y d 1 k p η 0 2 and v r 1 2 2 y d 1 k p η 0 2 v e d then the inner loop mpc based controller 9 admits recursive feasibility i e l 2 x ˆ 2 t u 2 max for all t 0 proof consider the given the current system state x 2 t τ x ˆ 2 is always feasible for inner loop controller 9 if l 2 x ˆ 2 u 2 max can be satisfied the initial matrix is symmetric positive definite and upper bounded 0 m m t i m and the restoring force g η is bounded g η g fossen 2002 by definition and combine 23 we have v d v v t h v t h then taking infinity norm on v d the following can hold 25 v d v v t h v t h 1 h v t h v t 2 h v x ˆ 1 v d where v d 2 2 h y d 1 k p η 0 2 v r can be obtained in the same way taking infinity norm on 5 and substituting 23 we have 26 c v r c 2 2 m y d 1 k p η 0 2 2 v e d m d v can be obtained in the same way 27 d v r d d 1 1 2 2 y d 1 k p η 0 2 v e d d 2 where d 1 max x u y v z w m q n r and d 2 max x u u y v v z w w m q q n r r taking infinity norm on both sides of 19 together with proposition 1 we have 28 τ x ˆ 2 m v d c d v r g m k d v 0 2 then τ x ˆ 2 τ max can hold we can guarantee that l 2 x ˆ 2 t u 2 max satisfied all the time the proof of theorem 2 is completed theorem 3 suppose proposition 1 and assumption 1 can hold then the system under theorem 1 is asymptotically stable with the equilibrium η v 0 0 theorem 2 is asymptotically stable with the equilibrium v τ 0 0 i e the auv will track the desired trajectory y d with the lmpc trajectory tracking control proof since the lyapunov function v 1 x in 12 by converse lyapunov theorems khalil 1996 there exist functions γ i i 1 2 3 these functions belong to class k and satisfy the following inequalities 29 γ 1 x 1 v 1 x 1 γ 2 x 1 30 v 1 x 1 f x 1 l 1 x 1 γ 3 x 1 the optimal solution κ 1 s will be implemented and combine 16 we have 31 v 1 x 1 f x 1 u 1 x 1 v 1 x 1 f x 1 l 1 x 1 γ 3 x 1 by the lyapunov theorems khalil 1996 the following conclusion can be drawn that the outer loop mpc based controller under theorem 1 is asymptotically stable in the region of attraction ℝ 1 32 x 1 x 1 ℝ 1 n 22 the same can be obtained the inner loop mpc based controller under theorem 2 is asymptotically stable in the region of attraction ℝ 2 33 x 2 x 2 ℝ 2 n 24 furthermore x 1 and x 2 can be enlarged by reducing the value of the control gains k p and k d respectively theorem 4 consider the fully actuated auv with the kinematics in 1 and dynamics in 2 suppose proposition 1 and assumption 1 can hold if the outer loop controller is given in 7 and the inner loop controller is given in 10 and the contraction constraints are constructed by 16 and 21 then the overall closed loop system is proved to be asymptotically stable proof the controller consists of an inner loop controller and an outer loop controller so the stability analysis of the overall closed loop system should be proved using a unified lyapunov function consider the following lyapunov function as 34 v 3 1 2 η t k 1 η 1 2 v t k 2 v selecting control laws 14 and 19 the time derivative of v 3 becomes 35 v 3 η t k 1 η v t k 2 v η t k 1 j v y d v t k 2 m 1 c v r d v r g τ v d η t k 1 k p η v t k 2 k d v 0 we can conclude that the overall closed loop system is proved to be asymptotically stable 5 simulation results the simulations of the auv tracking control are given in this section which proves the effectiveness and robustness of the designed lmpc controller all the parameters related to the auv are based on pettersen s research pettersen et al 1999 the desired trajectory is a spiral diving trajectory to test the auv tracking control as shown in 34 and the initial state of the auv is 0 5 0 0 0 t 36 ξ d 10 sin 0 03 t η d 10 cos 0 03 t ζ d 0 05 t the relevant parameters of the lmpc controller are as follows sampling period h 0 2 s prediction horizon t p 5 h weighting matrices q 1 q 2 d i a g 10 3 10 3 10 3 10 3 10 3 r 1 r 2 d i a g 1 1 1 1 1 p 1 p 2 d i a g 1 1 1 1 1 and the limit of each propeller is 500 n the control gains k p d i a g 1 1 1 1 1 k d d i a g 1 1 1 1 1 k 1 k 2 d i a g 1 1 1 1 1 to solve lmpc problems 7 and 10 numerically the problems are discretized first and then the corresponding karush kuhn tucker conditions are solved by sequential quadratic programming method 5 1 trajectory tracking performance without external disturbances the auv tracking results are shown in figs 2 4 the red curve is the simulated auv trajectories with the proposed lmpc control and the blue curve is the auv trajectories using terminal sliding mode control tsmc while the black curve is the desired trajectory it can be seen from the figure that lmpc and tsmc make auv track desired trajectory well which verifies the closed loop stability but the lmpc controller has faster convergence than the tsmc controller the main reason is to ensure a large region of attraction by choosing a small control gain matrices k p and k d meanwhile online optimization improves the tracking control performance the control input signals of the auv are shown in fig 5 it can be seen from the figure that the lmpc controller converges as quickly as possible while complying with the physical limit of the propellers at the beginning of tracking in other words the magnitude of the control commands is within the expected allowable range 5 2 trajectory tracking performance with external disturbances because the implementation of receding horizon introduces feedback into the closed loop system the lmpc control method is robust to uncertainties and disturbances to test the robustness of the lmpc and tsmc the trajectory tracking control of auv will be carried out under the current and random disturbance both types of disturbances are defined in fixed coordinate system e ξ η ζ the ocean current disturbance is defined as follows 37 u c 0 15 m s v c 0 15 m s the random disturbance is defined as follows 38 u r d 0 2 r a n d 1 m s v r d 0 2 r a n d 1 m s where r a n d 1 is a normal distribution noise signal with 0 mean and 1 variance the trajectories tracking with ocean current results are displayed in figs 6 9 as shown in the figures the lmpc tracking control still drive the auv well to the desired trajectory while the tsmc tracking control exists larger tracking errors the lmpc method uses online optimization to arrange appropriate control gain to compensate disturbances while tsmc lacks such flexibility therefore lmpc can improve the robustness of the auv trajectory tracking control the simulation results for auv tracking control with random disturbance are provided through figs 10 13 similar observations can be made the proposed lmpc tracking control has faster convergence to the desired trajectory than the tsmc controller and the control input commands are always feasible for the auv system 6 conclusion in this paper a novel lmpc based method for the autonomous underwater vehicle trajectory tracking is designed the contraction constraints are constructed using the lyapunov based backstepping technique the online optimization of mpc and the nonlinear backstepping stepping control based on lyapunov are combined to improve control performance and robustness the closed loop stability and recursive feasibility of the lmpc based control are rigorously proved and the guaranteed region of attraction roa is clearly described the simulation results demonstrate the feasibility of the designed lmpc trajectory tracking method in the next work plan experiments will be performed to verify the designed algorithm and we will further study the advanced control method and integrate its advantages into mpc method to improve the closed loop characteristics of the auv credit authorship contribution statement peng gong methodology simulation writing original draft writing review editing zheping yan conceptualization funding acquisition writing review editing wei zhang visualization investigation supervision jialing tang writing review editing supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by national natural science foundation of china the funding number is no 52071102 no 51679057 no 51609046 the province science fund for distinguished young scholars the funding number is no j2016jq0052 the ph d student research and innovation fund of the fundamental research funds for the central universities the funding number is no 3072020gip0410 
20699,the aim of this study is to evaluate higher order diffraction forces on vertical circular cylinders by using an author developed three dimensional fully nonlinear numerical wave tank nwt the nonlinear nwt is based on the potential theory boundary element method and mixed eulerian lagrangian mel approach the acceleration potential method is used to calculate the hydrodynamic pressure accurately the artificial damping zone is adopted to prevent reflected waves from bodies and side walls the least square gradient reconstruction method and the thin plate spline method are applied to evaluate the spatial derivatives of physical quantities and updated locations of interpolation points the third order stokes monochromatic or bichromatic waves are inputted as incident wave boundary condition from the nonlinear nwt simulations with fft first order second order and third order diffraction forces are simultaneously calculated and the results are systematically compared with published experimental and perturbation based numerical results the sensitivity of the nonlinear nwt results with the respective orders of stokes monochromatic or bichromatic input waves is also investigated the increase of third order sum frequency force in shallow water long wave is noticed keywords numerical wave tank diffraction force bichromatic wave fully nonlinear wave body interaction acceleration potential third order stokes wave 1 introduction cylindrical members are frequently used in many offshore platforms such as spar tension leg platform tlp and semi submersible as well as for various coastal structures moreover many wind turbines and marine hydro kinetic energy devices are supported by a mono pile or a series of columns therefore nonlinear wave loads on such structures are of increasing interest in particular the mono pile wind turbine is typically very tall and its elastic resonant responses can occur by a series of high order wave loads in this regard precise nonlinear hydrodynamic analysis is needed in the design of such structures numerous researches for estimating nonlinear wave loads on cylindrical structures have been conducted during the past four decades molin 1979 introduced a theoretical background regarding how to calculate second order wave force kim and you 1989 1990 calculated the second order wave loads on axisymmetric bodies by using the ring source boundary element method a similar study was also conducted by chau and eatock taylor 1992 liu et al 1995 and choi et al 2000 carried out a second order frequency domain analysis based on the higher order boundary element method hobem they compared the results with the results of kim and yue 1989 for verification bai and teng 2013 solved the first and second order diffraction radiation problems of a cylindrical floating body by using the second order time domain analysis on the other hand malenica and molin 1995 solved boundary value problems for third order wave diffraction forces on a bottom mounted vertical cylinder including comparison with experiments teng and kato 2002 also calculated the triple frequency wave load on a cylindrical structure by using ring source boundary integral equation method in which numerical results were presented for bottom mounted and truncated vertical circular cylinders the relevant third order boundary value problems are already very complicated and it appears that there is little merit in pursuing perturbation method higher than third order instead more direct fully nonlinear simulation methods can be employed which is now more feasible with the increasingly higher performance of computers in this regard there have been several efforts to solve fully nonlinear nwts in time domain the fully nonlinear nwt can do numerical simulations similar to physical wave tank experiments when potential theory is used the mixed eulerian lagrangian mel method is typically applied to trace lagrangian the instantaneous fully nonlinear free surface and solve eulerian the corresponding boundary value problem at each time step the fully nonlinear nwt can calculate the total nonlinear wave load including all higher order force components at once unlike the step by step perturbation method celebi et al 1998 solved the diffraction problem of cylindrical structures by applying a fully nonlinear nwt using desingularized integral equation method bai and eatock taylor 2007 2009 solved the fully nonlinear nwt with fixed and floating bodies by using hobem and unstructured mesh system however they presented the calculated higher order diffraction forces only for monochromatic wave case zhou et al 2015 applied the nonlinear decomposition method to the three dimensional fully nonlinear nwt to reduce the size of the fluid domain and the number of collocation points their double frequency wave loads were validated by comparing with the published perturbation based results several authors developed 3d fully nonlinear nwt based on hobem because it is more straightforward to evaluate the spatial derivatives of physical quantities although it also faces a potential problem of multiple normal vectors at the intersection nodes on the other hand kim and koo 2019 have developed cpm based 3d fully nonlinear nwt by applying the least square gradient reconstruction method lsgr which is a well known numerical scheme in cfd computational fluid dynamics field the cpm based nwt can avoid the multi value boundary conditions at corners while maintaining the accuracy of spatial derivatives due to lsgr kim and koo 2019 solved the hydrodynamics of a cylindrical heaving buoy wave energy converter through a three dimensional fully nonlinear nwt which was validated by comparing the total and second order forces with the results of previous studies however in the open literature the systematic comparisons of fully nonlinear nwt results with third order perturbation results are hard to find which is included in the present paper the fully nonlinear nwts can also be developed by cfd approach such as park et al 1999 openfoam chen et al 2014 sun et al 2017 the relevant development of which is not detailed here in this study the author developed potential theory based three dimensional fully nonlinear nwt was used to calculate the mean double frequency and triple frequency wave loads on stationary truncated and bottom mounted vertical cylinders since the fully nonlinear nwt is based on bem similar results can also be produced for arbitrary 3d body geometries for the fully nonlinear nwt the mel re gridding lsgr and acceleration potential method were used in time domain the acceleration potential method to evaluate the time derivative of the velocity potential in time marching scheme significantly increased the accuracy of dynamic pressure calculation although the computational time is significantly more than that of perturbation theory based frequency domain analysis it saves a considerable amount of computational time compared to the viscous numerical wave tank by cfd approach the demerit of the potential based fully nonlinear nwt compared to viscous nwt is that it cannot continue after wave overturning and breaking while the perturbation theory is very complicated at higher order the formulas for the fully nonlinear nwt are simpler and straightforward to obtain higher order wave loads in this study the wave frequency double frequency and triple frequency wave loads were produced simultaneously by the fourier analysis of total wave load obtained from fully nonlinear nwt simulation the nonlinear wave run up around the structure and hydrodynamic pressure distribution along the body surface were also estimated and compared with those of perturbation theory moreover the various combinations of sum frequency wave loads at second and third orders due to bi chromatic incident waves were also evaluated 2 mathematical formulation 2 1 boundary integral equation and boundary condition it is assumed that the fluid in the calculation domain is non viscous irrotational and incompressible then the laplace equation is satisfied in the calculation domain which can be expressed as a boundary integral equation according to the green s second identity 1 2 ϕ 0 2 α ϕ s g ϕ n ϕ g n d s where α denotes solid angle and g is the green function which can be expressed by rankine source satisfying the governing equation in the calculation domain in this study the bottom surface is flat and can be expressed by the image method and the nwt is symmetrical with respect to the x axis so the green function can be described as eqs 3 and 4 3 g 1 r 1 1 r 2 1 r 3 1 r 4 4 r 1 x x i 2 y y i 2 z z i 2 r 2 x x i 2 y y i 2 z z i 2 h 2 r 3 x x i 2 y y i 2 z z i 2 r 4 x x i 2 y y i 2 z z i 2 h 2 where x y z and x i y i z i are locations of a field point and a source point respectively the symbol h denotes water depth when the distance between a field point and a source point is large the multipole expansion method is applied to evaluate the surface integral of the green function more details are given in kim and koo 2019 based on the semi lagrangian approach v 0 0 η of mel method the kinematic and dynamic nonlinear free surface conditions can be expressed as eqs 5 and 6 5 δ η δ t ϕ z ϕ x η x ϕ y η y on s f 6 δ ϕ δ t g η 1 2 ϕ 2 δ η δ t ϕ z on s f where η and s f are wave elevation and boundary surface of free surface at the input boundary s i n the velocity profile of stokes third order wave was fed as nonlinear incident wave 7 ϕ n n x ϕ x i 1 n w n x g a i k i ω i cosh k i z h cosh k i h cos k i x ω i t n x 3 4 a i 2 ω i k i cosh 2 k i z h sinh 4 k i h cos 2 k i x ω i t n x 3 64 a i 3 k i 2 ω i 11 2 cosh 2 k i h cosh 3 k i z h sinh 7 k i h cos 3 k i x ω i t on s in where g a i k i and ω i are the gravitational acceleration wave amplitude wave number and wave angular frequency respectively the symbol n w is the number of wave frequencies in this study monochromatic and bichromatic waves were considered in the monochromatic wave condition n w becomes 1 and for bichromatic waves it becomes 2 the boundary conditions on side walls and a fixed structure are impenetrable boundary condition 8 ϕ n 0 on s b and s w a l l where s b and s w a l l are the surfaces of a structure and side walls fig 1 shows the overview of three dimensional 3d numerical wave tank it shows that the incident wave is generated from the incident wave boundary located on the left wall and the incident wave propagates in the x direction and then passes through a fixed structure and propagates further downstream toward the right wall during this process the interaction between the structure and the incident wave occurs to generate various orders of hydrodynamic wave loads acting on the structure 2 2 artificial damping zone kim et al 2014 conducted the parametric study of types of artificial damping terms and shapes of spatial ramp function for damping coefficients in this study ϕ n η type artificial damping terms and mildly growing spatial shape function were considered similar to kim et al 2014 frontal damping zone side damping zone and end damping zone were applied especially in the frontal damping zone and side damping zone the difference between actual free surface and prescribed incident wave is to be dissipated so that the inputted stokes wave can be preserved while dissipating reflected waves from the body and re reflected waves from outer walls as given in eqs 10 and 11 9 a δ η δ t ϕ z ϕ x η x ϕ y η y μ e 2 η on s f e 9 b δ ϕ δ t g η 1 2 ϕ 2 δ η δ t ϕ z μ e 1 ϕ n on s f e 10 a δ η δ t ϕ z ϕ x η x ϕ y η y μ f 2 η η on s f e 10 b δ ϕ δ t g η 1 2 ϕ 2 δ η δ t ϕ z μ f 1 ϕ n ϕ n on s f f 11 a δ η δ t ϕ z ϕ x η x ϕ y η y κ 1 μ s 2 η η on s f s 11 b δ ϕ δ t g η 1 2 ϕ 2 δ η δ t ϕ z κ 1 μ s 1 ϕ n ϕ n on s f s 12 μ s μ 0 1 cos π 2 l s l d where μ e 1 μ e 2 μ f 1 μ f 2 μ s 1 and μ s 2 are artificial damping coefficients for end damping zone numerical beach frontal damping zone and side damping zone with the relation μ 2 k μ 1 the symbols η and ϕ n are the elevation and normal derivative of velocity potential of prescribed reference wave e g stokes high order incident wave the variable κ 1 is a switch function to operate side artificial damping zone when the input wave is reached at each point the shape function of artificial damping coefficients can be expressed as eq 12 μ 0 l s and l d are magnitude of artificial damping coefficient distance between the starting point and field point located in artificial damping zone and length of each artificial damping zone in this study the length of all artificial damping zones is set to be the same as one wavelength more details can be found in kim and koo 2019 2 3 excitation force the excitation force acting on a fixed body can be obtained by integrating the nonlinear bernoulli pressure over the instantaneous wetted body surface 13 f i s b ρ ϕ t 1 2 ϕ 2 g z n d s where ρ and n are water density and normal vector of each panel in the mel based nwt simulation the time derivative of the velocity potential causes serious numerical and stability problems as a remedy of the problem the so called acceleration potential method is adopted in this paper for which numerical time derivatives are not necessary this means that a separate boundary value problem for the acceleration field is solved to obtain the acceleration potential time derivative of velocity potential directly at each time step in particular the formulation for the acceleration potential for fixed bodies are simpler than that of floating bodies field kim and koo 2019 the boundary condition of a fixed structure is expressed by the impenetrable boundary condition 2 ϕ x t 0 and the free surface and incident wave boundary conditions are expressed by equations 14 and 15 14 ϕ t g η 1 2 ϕ 2 on s f 15 2 ϕ n t n x 2 ϕ x t i 1 n w n x g a i k i cosh k i z h cosh k i h sin k i x ω i t 3 2 ω 2 a i 2 k cosh 2 k i z h sinh 4 k i h sin 2 k i x ω i t 9 64 ω i 2 k i 2 a i 3 11 2 cosh z k i h sinh 7 k i h cosh 3 k i z h sin 3 k i x ω i t on s i n based on these boundary conditions by solving the boundary value problem for the acceleration field the time derivative of the velocity potential the first term of equation 13 can be calculated in addition in order to calculate the second term of equation 13 the least square gradient reconstruction method was applied this method is widely used in the field of cfd and is described in detail in author s previous paper kim and koo 2019 re gridding was done at every time step to accommodate the instantaneous wetted body surface and smaller elements near the free surface to enhance accuracy 2 4 thin plate spline as time marches the physical location of the collocation node on the free surface changes due to these changes nonlinear free surface boundary conditions should be applied at the instantaneous free surface at each time step for this an interpolation method is required according to an arbitrary mesh shape in this study the thin plate spline method was applied thin plate spline can be expressed as a radial basis function and radial basis kernel φ r as follows 16 φ r r 2 log r if r 0 α s if r 0 where r and α s are the distance between control points and smoothing parameter for simple interpolation for arbitrary meshes α s is set to zero here if α s is bigger than zero it is to be the smoothing method based on eq 16 the three dimensional interpolation can be done by eq 17 keller and borkowski 2019 17 f x y i 1 n λ i φ r i d 00 d 10 x d 01 y where λ i d 00 d 10 and d 01 are the thin plate spline parameters it can be evaluated by applying the information of control points as 18 18 α s φ r 12 φ r 13 φ r 1 n 1 x 1 y 1 φ r 21 α s φ r 22 φ r 2 n 1 x 2 y 2 φ r n 1 φ r n 2 φ r n 2 α s 1 x n y n 1 1 1 1 0 0 0 x 1 x 2 x 3 x n 0 0 0 y 1 y 2 y 3 y n 0 0 0 λ 1 λ 2 λ n d 00 d 10 d 01 z 1 z 2 z n 0 0 0 where r i j is distance between the i th control point and the j th control point by solving eq 18 the thin plate parameters can be obtained and then through eq 17 the thin plate spline value at arbitrary point can be calculated in order to verify the accuracy of the interpolation method the following analytically prescribed free surface elevation is used at control points 19 η x y cos k x 1 2 sin 2 k x x g 2 y y g 2 where x g and y g mean the x and y coordinates of the center of gravity of the structure the first cosine term in eq 19 represents the incident wave elevation and the second term represents the diffracted wave by the structure fig 2 shows the result calculated by the thin plate spline and the given values the two results are almost identical the corresponding root mean square rms error calculated by eq 20 is 0 011 20 ε 1 n i 1 n p i p i 2 where n p i and p i denote the number of interpolation points the i th interpolated point by the thin plate spline method and the known value based on this it is confirmed that the interpolation through the thin plate spline method is very effective and accurate 2 5 additional numerical schemes in this study additional numerical schemes are adopted for stable and robust numerical simulation in order to eliminate unwanted transient waves due to the sudden generation of incident waves the following ramp function was applied here the ramp period t r a m p was set to twice the incident wave period 21 r a m p t 1 for t t r a m p 1 cos π 2 t t r a m p for t t r a m p also in order to prevent the non physical saw tooth instability occurring on the free surface during time marching with nonlinear wave two dimensional least square polynomial smoothing was applied to the arbitrary two dimensional mesh budin 1973 the two dimensional quadratic polynomials for smoothing can be built by using 25 neighbor points located around an arbitrary point 22 y a 1 a 2 v a 3 v 2 a 4 w a 5 v w a 6 v 2 w a 7 w 2 a 8 v w 2 a 9 v 2 w 2 where v and w denote the differences of the x and y coordinates between a target point and a neighbor point smoothing parameters such as a 1 a 2 a 3 a 9 can be evaluated by applying least square method then smoothed values can be obtained by solving eq 22 the scheme is very effective for arbitrary mesh system if the distance between neighboring points is constant it can become a kind of savitzky golay filters savitzky and golay 1964 along with the schemes above the runge kutta 4th order method was used as a time marching scheme and the gmres method which is the well known iterative solver was applied to solve the linear systems of equations saad and shcultz 1986 in addition to calculate the spatial derivatives of various physical quantities the least square gradient reconstruction method was applied more detailed description of the numerical schemes is given in kim and koo 2019 3 numerical results and discussions in this study the wave loads on the cylindrical structure were calculated by applying the third order stokes wave as input to the numerical wave tank for illustration a vertical circular cylinder of radius r 1 0 m and draft d 1 0 m was used fig 3 shows the mesh system of the entire numerical wave tank with the truncated and bottom fixed cylinders in the case of the bottom mounted structure the water depth is equal to the draft of the cylinder for the truncated cylinder the water depth was set to 3 0 m the free surface panels are arranged so that there is smooth transition from inner circular to outer rectangular boundaries the size of the panel closest to the structure was set to be the same as that of the structure and gradually increased as it is away from the structure the x axis length of nwt is set to be 2 5 times wavelength and the structure is located at the mid length the half breath is 2 0 times wavelength from the x axis the length of each artificial damping zone is one wavelength in front of all the end and side walls as shown in fig 1 the same nwt domain was also used with linear incident wave and linearized free surface condition at mean water level to produce the corresponding linear results when comparisons are made the time step was 1 90 of the wave period and the simulation was performed for 10 times of wave period based on kim and koo 2019 3 1 convergence test fig 4 shows four different mesh systems used for the convergence test as mentioned earlier the size of the mesh around the structure increases as it is away from the structure mesh 1 is the coarsest mesh system around the structure and mesh size is gradually decreased from mesh 1 to mesh 4 the mesh numbers of four different mesh systems are 3736 4208 4800 and 5488 respectively they are all connected to the outer domain meshes of the same size for the convergence test wave run up at two points θ π rad front point and θ 0 rad rear point as fig 1 and horizontal wave load on the structure from the four different meshes were compared in fig 5 as the size of the meshes decreases mesh 1 mesh 4 the convergent results are obtained i e there is no difference between mesh 3 and mesh 4 therefore with the mesh 3 system all numerical simulations were performed from this point on the mesh system warrants more than 20 panels per wave length which is more than the typical for linear quantity calculations fig 6 shows the horizontal wave loads on a bottom mounted vertical cylinder from the linear and nonlinear nwt simulations the crest of the nonlinear force signal is higher and the trough shallower than those of linear one although their phases remain almost the same in fig 6 b the wave load signals are decomposed into each frequency components by applying the fast fourier transform fft the x axis is dimensionless wave frequency and the y axis is dimensionless force magnitude normalized by ρ g a r 2 at the original wave frequency there is no difference between linear and nonlinear simulations however from the nonlinear nwt the mean and double frequency loads are generated which are second order contributions in the case of nonlinear nwt the triple frequency wave load can also be observed although its magnitude is very small as demonstrated in this example in the fully nonlinear nwt simulation all the higher order components can be produced simultaneously by using fft fig 7 shows the free surface snapshots at 6 27 t and 6 71 t of a fully nonlinear nwt simulation for a bottom mounted cylindrical structure in fig 7 the incident wave was generated from the southwest wave maker boundary and then the generated waves propagated toward the structure and deformed by it subsequently the incident and diffracted ring waves coexist in the downstream artificial damping zone it is clearly seen that the waves are sufficiently dissipated with no reflection from it in the upstream and side damping zones the artificial damping was applied only to the difference between the actual and incident waves so that only the incident wave can exist there which is actually the case judging from the figure 3 2 wave run up and hydrodynamic pressure on the body surface through the fully nonlinear nwt with fixed vertical cylinders the nonlinear wave run up and hydrodynamic pressure at the body surface can be captured and they are compared with published experimental data fig 8 shows the wave frequency and double frequency components of wave run up in the infinite depth condition for a vertical cylinder of radius 8 m and draft 24 m the present fully nonlinear nwt results were compared with cfd and second order diffraction results by sun et al 2016 and the experimental results by nam et al 2008 two incident wave periods 7 and 9 s were considered in the figure θ means the azimuth angle from the front θ π rad to the rear θ 0 rad as fig 1 the present nwt results are generally in good agreement with nam et al s experimental results and sun et al s cfd and perturbation results even the agreement of the second order double frequency component which is usually a small quantity is reasonably good at both wave periods the wave frequency run up has maximum at the front but the second order double frequency run up is maximized near the side around θ 0 4 π rad fig 9 presents the hydrodynamic pressure distribution along the depth at both front and rear positions the present fully nonlinear nwt results are compared with the experimental results by neelamani et al 1989 and the linear solution by maccamy and fuchs 1954 the experiments were conducted for a bottom mounted vertical cylinder of radius 0 2 m and draft 2 5 m nine pressure transducers were applied in the z axis direction the maximum values of the hydrodynamic pressures were compared at both weather side θ π rad and lee side θ 0 rad the experimental results of neelamani et al 1989 and the present fully nonlinear nwt results are generally in good agreement the weather side hydrodynamic pressure is significantly larger than the lee side one near the free surface both in the measured and simulated results 3 3 wave loads by a monochromatic incident wave in the present mel method the instantaneous free surface was traced at each time step and the physical quantities were integrated over the corresponding instantaneous wetted body surface fig 10 compares the second order horizontal mean and double frequency wave loads on a bottom mounted cylinder radius r 1 m water depth h 1 m by applying the developed fully nonlinear nwt and fft the results were compared with the published results of kim and yue 1989 both forces were non dimensionalized by ρ g a 2 r because they are proportional to the wave amplitude squared the two results show good agreement proving that the present nwt simulations produce good accuracy even for the small second order quantities fig 11 shows the wave loads on another bottom mounted vertical cylinder at various wave frequencies the ratio of draft to radius d r is 10 in the figure first order wave frequency component f x ω second order mean f x 0 and double frequency f x 2 ω components and the third order triple frequency f x 3 ω component are presented the first order and second order components were compared with the results from the commercial frequency domain analysis program wamit v 6 1s wamit 2011 the third order triple frequency component normalized by wave amplitude cubed was compared with the semi analytic solution by malenica and molin 1995 they all show good agreements in particular that kind of high quality comparison between the third order diffraction theory and fully nonlinear nwt simulation is hard to find in the open literature this shows that the well developed fully nonlinear nwt simulation can produce a series of higher harmonic wave forces with similar accuracies of perturbation theory however the perturbation theory becomes unbearably complex as orders increase beyond three on the other hand all the higher harmonic forces can simultaneously be obtained from the single time domain simulation using a nonlinear nwt as mentioned earlier there is artificial damping zone in front of the input boundary which dissipates only the difference between the actual free surface and input incident wave here stokes third order wave so that the applied incident wave can be preserved while the reflected waves from the body can be dissipated judging from the excellent comparison of the third order forces it can indirectly be confirmed that the applied artificial damping scheme actually works well fig 12 shows the horizontal and vertical wave loads acting on a truncated vertical cylinder the cylinder has draft to radius ratio d r of 1 0 and water depth to radius ratio h r of 10 0 the first order wave frequency and second order mean and double frequency horizontal and vertical wave forces are compared in fig 12a and b with those of commercial program wamit wamit 2011 the third order triple frequency forces fig 12 c are also compared with those from the frequency domain analysis by teng and kato 2002 the present fully nonlinear nwt results are generally in good agreement with the other independently computed results with regard to the third order forces on the truncated cylinder although their general trends are close the agreement in magnitude is worse than fig 11 bottom mounted cylinder but which result is more correct is not clear since the third order perturbation theory itself also contains several numerical difficulties such as high order derivatives on the body surface including corners in the present fully nonlinear nwt simulation third order stokes wave was fed at the input boundary but can evolve according to the applied fully nonlinear free surface condition before reaching the body surface the third order diffraction force results are very rare in the open literature in this regard let us investigate more on the third order wave loads fig 13 shows the third order triple frequency horizontal and vertical wave loads on the truncated vertical cylinder radius 1m draft 1m with varying water depths of 3 m 5 m and 10 m third order stokes wave of a 0 1m was fed at the input boundary for the considered wave frequencies the corresponding range of wave steepness wave height to wave length ratio is 1 120 1 25 in both horizontal and vertical wave loads the effect of water depth is small in high frequency region k r 0 3 for horizontal and k r 0 6 for vertical forces however in the low frequency region both the horizontal and vertical forces increase significantly with decreasing water depth for instance when k r 0 2 0 3 the horizontal and vertical loads at h 3m are about three times larger than those at h 10 m which implies that third order forces can play more important role under shallow and long wave condition it was also checked that even the shallow water conditions satisfied the ursell number criterion of stokes third order wave theory fig 14 shows the hydrodynamic pressure at the bottom center of the truncated cylinder for water depths of 3m 5m and 10m the first order wave frequency component the second order mean and double frequency components and the third order triple frequency component are presented all the components are increased as water depth becomes shallower the increase of the first order component is small while showing larger increments as the order increases and water depth decreases the overall trend of the triple frequency hydrodynamic pressure is similar to that of the triple frequency vertical force fig 13 c it is of particular interest that there exists stronger nonlinearity or high order components in shallower water case despite smaller wave steepness e g 1 120 than the deeper water cases e g 1 25 since wave heights remain the same in the presented results of figs 13 and 14 we also examine the sensitivity of the figs 13 and 14 results by keeping the same wave slope as h λ 1 35 for all wave frequencies the results are additionally given for h r 3 in figs 13 and 14 we can see that the general trends look similar even in this case fig 15 shows the vertical distribution of hydrodynamic pressure on the weather and lee side of a truncated cylinder with 3m water depth the time series and maximum nonlinear hydrodynamic pressures are compared with linear ones in addition double frequency and triple frequency pressure components are also presented the hydrodynamic pressure on the weather side is generally larger than that on the lee side mainly due to larger wave run up it is of particular interest to note that the second order double frequency pressure field at the weather side decays very slowly with depth in shorter waves due to the influence of reflected waves there this novel phenomenon was first noticed by kim and yue 1989 and later by newman 2005 by using the second order diffraction theory the present fully nonlinear nwt simulation successfully recovers the same phenomenon figs 16 and 17 show the global picture of wave elevation around the structure and the corresponding time series at two specific measurement points the wave inputs are the same as fig 15 both in linear and nonlinear simulations the maximum free surface fluctuation occurs in front of the structure and minimum fluctuation at the back of the structure interestingly the maximum amplitude of second order double frequency and third order triple frequency wave elevations are detected at θ 70 backward side to see in more detail the time series of wave elevation at two different measurement points are shown in fig 17 the first measurement point is near the front of the structure and the second point is at θ 70 although the wave elevation at measurement point 1 is larger than that at measurement point 2 the corresponding time series reveal higher nonlinearity near point 2 as predicted by fig 16 tables 1 and 2 show the respective order components of the horizontal and vertical wave loads of a truncated cylinder according to the type of incident wave inputted for the nwt various types of incident waves can be inputted after being inputted the fully nonlinear free surface condition is applied and accordingly it is to evolve as nonlinear incident waves however the transition needs certain time and distance therefore if the inputted incident wave is already close to the nonlinear wave we can obtain higher quality results to test the sensitivity of high order forces with varying input waves linear wave stokes second order wave and stokes third order wave are respectively fed into the nwt and the results are compared in tables 1 3 the difference in the tables means the discrepancy with respect to the case of stokes third order incident wave first tables 1 2 are for the truncated vertical cylinder of d r 1 and h r 10 in the case of first order wave frequency component the results almost remain the same regardless of the type of incident wave however in the case of second order double frequency and third order triple frequency wave loads the maximal differences are up to 8 when the linear wave is inputted when stokes second order wave is inputted the difference is reduced to less than 1 based on this it is seen that to obtain reasonably accurate triple frequency wave load at least stokes second order wave needs to be inputted next table 3 shows the similar sensitivity for horizontal wave load on bottom mounted vertical cylinder d r 1 and h r 1 compared to tables 1 2 the water depth is reduced by 10 times as was observed in the previous figures we expect higher nonlinearities so larger difference in this kind of shallow water again for the first order wave frequency components the differences remain almost unchanged however the differences in double frequency wave load are significantly increased ranging from 4 to 53 when the linear wave is inputted similarly the maximum difference of 41 can be seen in the triple frequency wave load when the linear wave is inputted in this kind of shallow water case the larger the wavelength the higher order incident wave needs to be inputted when stokes second order wave is inputted the overall accuracy is already significantly improved showing differences less than 4 the above tables are for the relatively moderate nonlinear wave cases as wave steepness is increased further the merit of higher order wave input is to appear more clearly 3 4 wave loads by a bichromatic incident wave potential theory based nwt like actual physical wave maker has freedom to generate various types of input waves including random waves to observe the nonlinear interaction between two regular waves of different frequencies and its effects on the nonlinear diffraction a bichromatic incident wave was also inputted at the input boundary the resulting diffraction wave loads acting on the bottom mounted and truncated cylinders were analyzed fig 18 shows the wave load acting on the bottom mounted cylinder r h 1m when various combinations of bichromatic incident waves are applied fig 18 shows a the time series data of the nonlinear wave load and b the corresponding discrete force spectrum by fourier transform the enlarged figure is also given to see the small magnitudes of second and third order components for this simulation two stokes third waves of different frequencies were inputted it is seen that various frequency components of the wave load exist such as two wave frequency components at first order two double frequency and mean components and sum and difference frequency components at second order and two triple frequency components and four combinations of sum and difference frequencies at third order the time step was 1 90 of the smaller wave period and the simulation was performed for 60 times of smaller wave period since the pattern of the nonlinear force signal is well maintained we can say that the wave reflections from the damping zones are minimal table 4 shows 14 different combinations of input bichromatic waves considered here for the bottom mounted vertical cylinder the amplitudes of the two incident waves were 0 025 m fig 19 shows the resulting second order and third order sum frequency wave loads for the 14 different combinations of input bichromatic waves the results of second order sum frequency wave loads are compared with the result of kim and yue 1990 by using ring source distribution reasonably good agreement can be seen even for the small magnitudes of the second order quantity for all combinations of bichromatic waves as far as authors know there is no comparable published data associated with third order sum frequency wave loads as constituent wave frequencies increase third order sum frequency wave loads increase in particular the normalized third order wave loads are larger than 4 which means that the third order sum frequency wave loads may play a role for high frequency resonances in this kind of shallow water next fig 20 shows the similar plots for the truncated cylinder r 1m d 1m and h 10m in much deeper water the considered frequency combinations are given in table 5 the amplitude of the two incident waves was 0 025 m figs 20 21 present the horizontal and vertical second order sum frequency force components and third order sum frequency force components in the bichromatic waves since authors cannot find any published results for this case the second order sum frequency wave loads were compared against the independently calculated results by using the commercial frequency domain second order diffraction panel program wamit the present nwt results are generally consistent with the wamit results as for the third order sum frequency forces there exists no published result to compare with interestingly in figs 20 21 second order vertical and third order horizontal forces decrease as frequency differences increase but different trend for the other forces all the presented comparisons so far clearly demonstrated that the present fully nonlinear nwt simultaneously produced all the high order results with reasonably good accuracy both for monochromatic and bichromatic waves in this paper all the results were presented for truncated and bottom mounted vertical cylinders however since the 3d nwt can handle arbitrary 3d bodies the similar results can also be produced and analyzed for them in an analogous manner for all the data presented up to this point the range of kc keulegan carpenter number is 0 3 0 5 i e potential theory is valid and viscous drag force is negligible the range of ursell number is 0 003 12 8 i e stokes 3rd order wave is valid even for shallow and long wave cases 4 conclusions in this study a potential theory and boundary element method based fully nonlinear nwt was developed to solve nonlinear diffraction problems for stationary structures the developed nonlinear nwt was based on the mel mixed eulerian lagrangian approach and acceleration potential method the regriding at each time step was done by thin plate spline interpolation method and smoothing scheme was used to prevent potential saw tooth instability on the free surface the spatial derivatives of various physical quantities were calculated by applying the least square gradient reconstruction method to ensure open sea conditions by dissipating unwanted reflected waves an artificial damping zone was imposed at the outer regions of all sides convergence tests with decreasing panel size were performed so that the converged high order quantities can be obtained with reasonable accuracy a series of nonlinear simulations were conducted for fixed truncated and bottom mounted vertical circular cylinders and the results were compared with published experimental results and independently calculated results by high order diffraction method to estimate the accuracy of the respective order quantities the discrete amplitude spectrum was obtained through fft from simulated time series the fully nonlinear nwt reliably estimated the first order wave frequency second order mean and double frequency and third order triple frequency wave loads simultaneously the nonlinear wave run up and pressure distribution were also well compared against published experimental results the increase of third order force for smaller water depth to wave length ratio was noticeable with more shallow water nonlinear effects since the perturbation theory above second order is already very complicated there is no merit other than less computational time compared to the direct nonlinear nwt simulation in time domain the sensitivity of the respective order wave loads with linear second order and third order stokes input waves was also presented and the importance of the use of high order stokes incident wave in relatively shallow water depth was underscored the novel phenomenon of slow decay of second order double frequency pressure with depth at the weather side in short waves was recovered by the present fully nonlinear nwt simulation finally the nonlinear nwt simulations for bichromatic incident waves were also conducted and the results compared well against published second order diffraction theory credit authorship contribution statement sung jae kim investigation calculation formal analysis writing original draft moo hyun kim conceptualization investigation writing review editing weoncheol koo supervision funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this research was supported by the motie ministry of trade industry and energy in korea under the fostering global talents for innovative growth program p0008750 supervised by the korea institute for advancement of technology kiat this work was also partly supported by the national research foundation of korea nrf grant funded by the korea government msit no 2017r1a5a1014883 no 2018r1d1a1b07040677 
20699,the aim of this study is to evaluate higher order diffraction forces on vertical circular cylinders by using an author developed three dimensional fully nonlinear numerical wave tank nwt the nonlinear nwt is based on the potential theory boundary element method and mixed eulerian lagrangian mel approach the acceleration potential method is used to calculate the hydrodynamic pressure accurately the artificial damping zone is adopted to prevent reflected waves from bodies and side walls the least square gradient reconstruction method and the thin plate spline method are applied to evaluate the spatial derivatives of physical quantities and updated locations of interpolation points the third order stokes monochromatic or bichromatic waves are inputted as incident wave boundary condition from the nonlinear nwt simulations with fft first order second order and third order diffraction forces are simultaneously calculated and the results are systematically compared with published experimental and perturbation based numerical results the sensitivity of the nonlinear nwt results with the respective orders of stokes monochromatic or bichromatic input waves is also investigated the increase of third order sum frequency force in shallow water long wave is noticed keywords numerical wave tank diffraction force bichromatic wave fully nonlinear wave body interaction acceleration potential third order stokes wave 1 introduction cylindrical members are frequently used in many offshore platforms such as spar tension leg platform tlp and semi submersible as well as for various coastal structures moreover many wind turbines and marine hydro kinetic energy devices are supported by a mono pile or a series of columns therefore nonlinear wave loads on such structures are of increasing interest in particular the mono pile wind turbine is typically very tall and its elastic resonant responses can occur by a series of high order wave loads in this regard precise nonlinear hydrodynamic analysis is needed in the design of such structures numerous researches for estimating nonlinear wave loads on cylindrical structures have been conducted during the past four decades molin 1979 introduced a theoretical background regarding how to calculate second order wave force kim and you 1989 1990 calculated the second order wave loads on axisymmetric bodies by using the ring source boundary element method a similar study was also conducted by chau and eatock taylor 1992 liu et al 1995 and choi et al 2000 carried out a second order frequency domain analysis based on the higher order boundary element method hobem they compared the results with the results of kim and yue 1989 for verification bai and teng 2013 solved the first and second order diffraction radiation problems of a cylindrical floating body by using the second order time domain analysis on the other hand malenica and molin 1995 solved boundary value problems for third order wave diffraction forces on a bottom mounted vertical cylinder including comparison with experiments teng and kato 2002 also calculated the triple frequency wave load on a cylindrical structure by using ring source boundary integral equation method in which numerical results were presented for bottom mounted and truncated vertical circular cylinders the relevant third order boundary value problems are already very complicated and it appears that there is little merit in pursuing perturbation method higher than third order instead more direct fully nonlinear simulation methods can be employed which is now more feasible with the increasingly higher performance of computers in this regard there have been several efforts to solve fully nonlinear nwts in time domain the fully nonlinear nwt can do numerical simulations similar to physical wave tank experiments when potential theory is used the mixed eulerian lagrangian mel method is typically applied to trace lagrangian the instantaneous fully nonlinear free surface and solve eulerian the corresponding boundary value problem at each time step the fully nonlinear nwt can calculate the total nonlinear wave load including all higher order force components at once unlike the step by step perturbation method celebi et al 1998 solved the diffraction problem of cylindrical structures by applying a fully nonlinear nwt using desingularized integral equation method bai and eatock taylor 2007 2009 solved the fully nonlinear nwt with fixed and floating bodies by using hobem and unstructured mesh system however they presented the calculated higher order diffraction forces only for monochromatic wave case zhou et al 2015 applied the nonlinear decomposition method to the three dimensional fully nonlinear nwt to reduce the size of the fluid domain and the number of collocation points their double frequency wave loads were validated by comparing with the published perturbation based results several authors developed 3d fully nonlinear nwt based on hobem because it is more straightforward to evaluate the spatial derivatives of physical quantities although it also faces a potential problem of multiple normal vectors at the intersection nodes on the other hand kim and koo 2019 have developed cpm based 3d fully nonlinear nwt by applying the least square gradient reconstruction method lsgr which is a well known numerical scheme in cfd computational fluid dynamics field the cpm based nwt can avoid the multi value boundary conditions at corners while maintaining the accuracy of spatial derivatives due to lsgr kim and koo 2019 solved the hydrodynamics of a cylindrical heaving buoy wave energy converter through a three dimensional fully nonlinear nwt which was validated by comparing the total and second order forces with the results of previous studies however in the open literature the systematic comparisons of fully nonlinear nwt results with third order perturbation results are hard to find which is included in the present paper the fully nonlinear nwts can also be developed by cfd approach such as park et al 1999 openfoam chen et al 2014 sun et al 2017 the relevant development of which is not detailed here in this study the author developed potential theory based three dimensional fully nonlinear nwt was used to calculate the mean double frequency and triple frequency wave loads on stationary truncated and bottom mounted vertical cylinders since the fully nonlinear nwt is based on bem similar results can also be produced for arbitrary 3d body geometries for the fully nonlinear nwt the mel re gridding lsgr and acceleration potential method were used in time domain the acceleration potential method to evaluate the time derivative of the velocity potential in time marching scheme significantly increased the accuracy of dynamic pressure calculation although the computational time is significantly more than that of perturbation theory based frequency domain analysis it saves a considerable amount of computational time compared to the viscous numerical wave tank by cfd approach the demerit of the potential based fully nonlinear nwt compared to viscous nwt is that it cannot continue after wave overturning and breaking while the perturbation theory is very complicated at higher order the formulas for the fully nonlinear nwt are simpler and straightforward to obtain higher order wave loads in this study the wave frequency double frequency and triple frequency wave loads were produced simultaneously by the fourier analysis of total wave load obtained from fully nonlinear nwt simulation the nonlinear wave run up around the structure and hydrodynamic pressure distribution along the body surface were also estimated and compared with those of perturbation theory moreover the various combinations of sum frequency wave loads at second and third orders due to bi chromatic incident waves were also evaluated 2 mathematical formulation 2 1 boundary integral equation and boundary condition it is assumed that the fluid in the calculation domain is non viscous irrotational and incompressible then the laplace equation is satisfied in the calculation domain which can be expressed as a boundary integral equation according to the green s second identity 1 2 ϕ 0 2 α ϕ s g ϕ n ϕ g n d s where α denotes solid angle and g is the green function which can be expressed by rankine source satisfying the governing equation in the calculation domain in this study the bottom surface is flat and can be expressed by the image method and the nwt is symmetrical with respect to the x axis so the green function can be described as eqs 3 and 4 3 g 1 r 1 1 r 2 1 r 3 1 r 4 4 r 1 x x i 2 y y i 2 z z i 2 r 2 x x i 2 y y i 2 z z i 2 h 2 r 3 x x i 2 y y i 2 z z i 2 r 4 x x i 2 y y i 2 z z i 2 h 2 where x y z and x i y i z i are locations of a field point and a source point respectively the symbol h denotes water depth when the distance between a field point and a source point is large the multipole expansion method is applied to evaluate the surface integral of the green function more details are given in kim and koo 2019 based on the semi lagrangian approach v 0 0 η of mel method the kinematic and dynamic nonlinear free surface conditions can be expressed as eqs 5 and 6 5 δ η δ t ϕ z ϕ x η x ϕ y η y on s f 6 δ ϕ δ t g η 1 2 ϕ 2 δ η δ t ϕ z on s f where η and s f are wave elevation and boundary surface of free surface at the input boundary s i n the velocity profile of stokes third order wave was fed as nonlinear incident wave 7 ϕ n n x ϕ x i 1 n w n x g a i k i ω i cosh k i z h cosh k i h cos k i x ω i t n x 3 4 a i 2 ω i k i cosh 2 k i z h sinh 4 k i h cos 2 k i x ω i t n x 3 64 a i 3 k i 2 ω i 11 2 cosh 2 k i h cosh 3 k i z h sinh 7 k i h cos 3 k i x ω i t on s in where g a i k i and ω i are the gravitational acceleration wave amplitude wave number and wave angular frequency respectively the symbol n w is the number of wave frequencies in this study monochromatic and bichromatic waves were considered in the monochromatic wave condition n w becomes 1 and for bichromatic waves it becomes 2 the boundary conditions on side walls and a fixed structure are impenetrable boundary condition 8 ϕ n 0 on s b and s w a l l where s b and s w a l l are the surfaces of a structure and side walls fig 1 shows the overview of three dimensional 3d numerical wave tank it shows that the incident wave is generated from the incident wave boundary located on the left wall and the incident wave propagates in the x direction and then passes through a fixed structure and propagates further downstream toward the right wall during this process the interaction between the structure and the incident wave occurs to generate various orders of hydrodynamic wave loads acting on the structure 2 2 artificial damping zone kim et al 2014 conducted the parametric study of types of artificial damping terms and shapes of spatial ramp function for damping coefficients in this study ϕ n η type artificial damping terms and mildly growing spatial shape function were considered similar to kim et al 2014 frontal damping zone side damping zone and end damping zone were applied especially in the frontal damping zone and side damping zone the difference between actual free surface and prescribed incident wave is to be dissipated so that the inputted stokes wave can be preserved while dissipating reflected waves from the body and re reflected waves from outer walls as given in eqs 10 and 11 9 a δ η δ t ϕ z ϕ x η x ϕ y η y μ e 2 η on s f e 9 b δ ϕ δ t g η 1 2 ϕ 2 δ η δ t ϕ z μ e 1 ϕ n on s f e 10 a δ η δ t ϕ z ϕ x η x ϕ y η y μ f 2 η η on s f e 10 b δ ϕ δ t g η 1 2 ϕ 2 δ η δ t ϕ z μ f 1 ϕ n ϕ n on s f f 11 a δ η δ t ϕ z ϕ x η x ϕ y η y κ 1 μ s 2 η η on s f s 11 b δ ϕ δ t g η 1 2 ϕ 2 δ η δ t ϕ z κ 1 μ s 1 ϕ n ϕ n on s f s 12 μ s μ 0 1 cos π 2 l s l d where μ e 1 μ e 2 μ f 1 μ f 2 μ s 1 and μ s 2 are artificial damping coefficients for end damping zone numerical beach frontal damping zone and side damping zone with the relation μ 2 k μ 1 the symbols η and ϕ n are the elevation and normal derivative of velocity potential of prescribed reference wave e g stokes high order incident wave the variable κ 1 is a switch function to operate side artificial damping zone when the input wave is reached at each point the shape function of artificial damping coefficients can be expressed as eq 12 μ 0 l s and l d are magnitude of artificial damping coefficient distance between the starting point and field point located in artificial damping zone and length of each artificial damping zone in this study the length of all artificial damping zones is set to be the same as one wavelength more details can be found in kim and koo 2019 2 3 excitation force the excitation force acting on a fixed body can be obtained by integrating the nonlinear bernoulli pressure over the instantaneous wetted body surface 13 f i s b ρ ϕ t 1 2 ϕ 2 g z n d s where ρ and n are water density and normal vector of each panel in the mel based nwt simulation the time derivative of the velocity potential causes serious numerical and stability problems as a remedy of the problem the so called acceleration potential method is adopted in this paper for which numerical time derivatives are not necessary this means that a separate boundary value problem for the acceleration field is solved to obtain the acceleration potential time derivative of velocity potential directly at each time step in particular the formulation for the acceleration potential for fixed bodies are simpler than that of floating bodies field kim and koo 2019 the boundary condition of a fixed structure is expressed by the impenetrable boundary condition 2 ϕ x t 0 and the free surface and incident wave boundary conditions are expressed by equations 14 and 15 14 ϕ t g η 1 2 ϕ 2 on s f 15 2 ϕ n t n x 2 ϕ x t i 1 n w n x g a i k i cosh k i z h cosh k i h sin k i x ω i t 3 2 ω 2 a i 2 k cosh 2 k i z h sinh 4 k i h sin 2 k i x ω i t 9 64 ω i 2 k i 2 a i 3 11 2 cosh z k i h sinh 7 k i h cosh 3 k i z h sin 3 k i x ω i t on s i n based on these boundary conditions by solving the boundary value problem for the acceleration field the time derivative of the velocity potential the first term of equation 13 can be calculated in addition in order to calculate the second term of equation 13 the least square gradient reconstruction method was applied this method is widely used in the field of cfd and is described in detail in author s previous paper kim and koo 2019 re gridding was done at every time step to accommodate the instantaneous wetted body surface and smaller elements near the free surface to enhance accuracy 2 4 thin plate spline as time marches the physical location of the collocation node on the free surface changes due to these changes nonlinear free surface boundary conditions should be applied at the instantaneous free surface at each time step for this an interpolation method is required according to an arbitrary mesh shape in this study the thin plate spline method was applied thin plate spline can be expressed as a radial basis function and radial basis kernel φ r as follows 16 φ r r 2 log r if r 0 α s if r 0 where r and α s are the distance between control points and smoothing parameter for simple interpolation for arbitrary meshes α s is set to zero here if α s is bigger than zero it is to be the smoothing method based on eq 16 the three dimensional interpolation can be done by eq 17 keller and borkowski 2019 17 f x y i 1 n λ i φ r i d 00 d 10 x d 01 y where λ i d 00 d 10 and d 01 are the thin plate spline parameters it can be evaluated by applying the information of control points as 18 18 α s φ r 12 φ r 13 φ r 1 n 1 x 1 y 1 φ r 21 α s φ r 22 φ r 2 n 1 x 2 y 2 φ r n 1 φ r n 2 φ r n 2 α s 1 x n y n 1 1 1 1 0 0 0 x 1 x 2 x 3 x n 0 0 0 y 1 y 2 y 3 y n 0 0 0 λ 1 λ 2 λ n d 00 d 10 d 01 z 1 z 2 z n 0 0 0 where r i j is distance between the i th control point and the j th control point by solving eq 18 the thin plate parameters can be obtained and then through eq 17 the thin plate spline value at arbitrary point can be calculated in order to verify the accuracy of the interpolation method the following analytically prescribed free surface elevation is used at control points 19 η x y cos k x 1 2 sin 2 k x x g 2 y y g 2 where x g and y g mean the x and y coordinates of the center of gravity of the structure the first cosine term in eq 19 represents the incident wave elevation and the second term represents the diffracted wave by the structure fig 2 shows the result calculated by the thin plate spline and the given values the two results are almost identical the corresponding root mean square rms error calculated by eq 20 is 0 011 20 ε 1 n i 1 n p i p i 2 where n p i and p i denote the number of interpolation points the i th interpolated point by the thin plate spline method and the known value based on this it is confirmed that the interpolation through the thin plate spline method is very effective and accurate 2 5 additional numerical schemes in this study additional numerical schemes are adopted for stable and robust numerical simulation in order to eliminate unwanted transient waves due to the sudden generation of incident waves the following ramp function was applied here the ramp period t r a m p was set to twice the incident wave period 21 r a m p t 1 for t t r a m p 1 cos π 2 t t r a m p for t t r a m p also in order to prevent the non physical saw tooth instability occurring on the free surface during time marching with nonlinear wave two dimensional least square polynomial smoothing was applied to the arbitrary two dimensional mesh budin 1973 the two dimensional quadratic polynomials for smoothing can be built by using 25 neighbor points located around an arbitrary point 22 y a 1 a 2 v a 3 v 2 a 4 w a 5 v w a 6 v 2 w a 7 w 2 a 8 v w 2 a 9 v 2 w 2 where v and w denote the differences of the x and y coordinates between a target point and a neighbor point smoothing parameters such as a 1 a 2 a 3 a 9 can be evaluated by applying least square method then smoothed values can be obtained by solving eq 22 the scheme is very effective for arbitrary mesh system if the distance between neighboring points is constant it can become a kind of savitzky golay filters savitzky and golay 1964 along with the schemes above the runge kutta 4th order method was used as a time marching scheme and the gmres method which is the well known iterative solver was applied to solve the linear systems of equations saad and shcultz 1986 in addition to calculate the spatial derivatives of various physical quantities the least square gradient reconstruction method was applied more detailed description of the numerical schemes is given in kim and koo 2019 3 numerical results and discussions in this study the wave loads on the cylindrical structure were calculated by applying the third order stokes wave as input to the numerical wave tank for illustration a vertical circular cylinder of radius r 1 0 m and draft d 1 0 m was used fig 3 shows the mesh system of the entire numerical wave tank with the truncated and bottom fixed cylinders in the case of the bottom mounted structure the water depth is equal to the draft of the cylinder for the truncated cylinder the water depth was set to 3 0 m the free surface panels are arranged so that there is smooth transition from inner circular to outer rectangular boundaries the size of the panel closest to the structure was set to be the same as that of the structure and gradually increased as it is away from the structure the x axis length of nwt is set to be 2 5 times wavelength and the structure is located at the mid length the half breath is 2 0 times wavelength from the x axis the length of each artificial damping zone is one wavelength in front of all the end and side walls as shown in fig 1 the same nwt domain was also used with linear incident wave and linearized free surface condition at mean water level to produce the corresponding linear results when comparisons are made the time step was 1 90 of the wave period and the simulation was performed for 10 times of wave period based on kim and koo 2019 3 1 convergence test fig 4 shows four different mesh systems used for the convergence test as mentioned earlier the size of the mesh around the structure increases as it is away from the structure mesh 1 is the coarsest mesh system around the structure and mesh size is gradually decreased from mesh 1 to mesh 4 the mesh numbers of four different mesh systems are 3736 4208 4800 and 5488 respectively they are all connected to the outer domain meshes of the same size for the convergence test wave run up at two points θ π rad front point and θ 0 rad rear point as fig 1 and horizontal wave load on the structure from the four different meshes were compared in fig 5 as the size of the meshes decreases mesh 1 mesh 4 the convergent results are obtained i e there is no difference between mesh 3 and mesh 4 therefore with the mesh 3 system all numerical simulations were performed from this point on the mesh system warrants more than 20 panels per wave length which is more than the typical for linear quantity calculations fig 6 shows the horizontal wave loads on a bottom mounted vertical cylinder from the linear and nonlinear nwt simulations the crest of the nonlinear force signal is higher and the trough shallower than those of linear one although their phases remain almost the same in fig 6 b the wave load signals are decomposed into each frequency components by applying the fast fourier transform fft the x axis is dimensionless wave frequency and the y axis is dimensionless force magnitude normalized by ρ g a r 2 at the original wave frequency there is no difference between linear and nonlinear simulations however from the nonlinear nwt the mean and double frequency loads are generated which are second order contributions in the case of nonlinear nwt the triple frequency wave load can also be observed although its magnitude is very small as demonstrated in this example in the fully nonlinear nwt simulation all the higher order components can be produced simultaneously by using fft fig 7 shows the free surface snapshots at 6 27 t and 6 71 t of a fully nonlinear nwt simulation for a bottom mounted cylindrical structure in fig 7 the incident wave was generated from the southwest wave maker boundary and then the generated waves propagated toward the structure and deformed by it subsequently the incident and diffracted ring waves coexist in the downstream artificial damping zone it is clearly seen that the waves are sufficiently dissipated with no reflection from it in the upstream and side damping zones the artificial damping was applied only to the difference between the actual and incident waves so that only the incident wave can exist there which is actually the case judging from the figure 3 2 wave run up and hydrodynamic pressure on the body surface through the fully nonlinear nwt with fixed vertical cylinders the nonlinear wave run up and hydrodynamic pressure at the body surface can be captured and they are compared with published experimental data fig 8 shows the wave frequency and double frequency components of wave run up in the infinite depth condition for a vertical cylinder of radius 8 m and draft 24 m the present fully nonlinear nwt results were compared with cfd and second order diffraction results by sun et al 2016 and the experimental results by nam et al 2008 two incident wave periods 7 and 9 s were considered in the figure θ means the azimuth angle from the front θ π rad to the rear θ 0 rad as fig 1 the present nwt results are generally in good agreement with nam et al s experimental results and sun et al s cfd and perturbation results even the agreement of the second order double frequency component which is usually a small quantity is reasonably good at both wave periods the wave frequency run up has maximum at the front but the second order double frequency run up is maximized near the side around θ 0 4 π rad fig 9 presents the hydrodynamic pressure distribution along the depth at both front and rear positions the present fully nonlinear nwt results are compared with the experimental results by neelamani et al 1989 and the linear solution by maccamy and fuchs 1954 the experiments were conducted for a bottom mounted vertical cylinder of radius 0 2 m and draft 2 5 m nine pressure transducers were applied in the z axis direction the maximum values of the hydrodynamic pressures were compared at both weather side θ π rad and lee side θ 0 rad the experimental results of neelamani et al 1989 and the present fully nonlinear nwt results are generally in good agreement the weather side hydrodynamic pressure is significantly larger than the lee side one near the free surface both in the measured and simulated results 3 3 wave loads by a monochromatic incident wave in the present mel method the instantaneous free surface was traced at each time step and the physical quantities were integrated over the corresponding instantaneous wetted body surface fig 10 compares the second order horizontal mean and double frequency wave loads on a bottom mounted cylinder radius r 1 m water depth h 1 m by applying the developed fully nonlinear nwt and fft the results were compared with the published results of kim and yue 1989 both forces were non dimensionalized by ρ g a 2 r because they are proportional to the wave amplitude squared the two results show good agreement proving that the present nwt simulations produce good accuracy even for the small second order quantities fig 11 shows the wave loads on another bottom mounted vertical cylinder at various wave frequencies the ratio of draft to radius d r is 10 in the figure first order wave frequency component f x ω second order mean f x 0 and double frequency f x 2 ω components and the third order triple frequency f x 3 ω component are presented the first order and second order components were compared with the results from the commercial frequency domain analysis program wamit v 6 1s wamit 2011 the third order triple frequency component normalized by wave amplitude cubed was compared with the semi analytic solution by malenica and molin 1995 they all show good agreements in particular that kind of high quality comparison between the third order diffraction theory and fully nonlinear nwt simulation is hard to find in the open literature this shows that the well developed fully nonlinear nwt simulation can produce a series of higher harmonic wave forces with similar accuracies of perturbation theory however the perturbation theory becomes unbearably complex as orders increase beyond three on the other hand all the higher harmonic forces can simultaneously be obtained from the single time domain simulation using a nonlinear nwt as mentioned earlier there is artificial damping zone in front of the input boundary which dissipates only the difference between the actual free surface and input incident wave here stokes third order wave so that the applied incident wave can be preserved while the reflected waves from the body can be dissipated judging from the excellent comparison of the third order forces it can indirectly be confirmed that the applied artificial damping scheme actually works well fig 12 shows the horizontal and vertical wave loads acting on a truncated vertical cylinder the cylinder has draft to radius ratio d r of 1 0 and water depth to radius ratio h r of 10 0 the first order wave frequency and second order mean and double frequency horizontal and vertical wave forces are compared in fig 12a and b with those of commercial program wamit wamit 2011 the third order triple frequency forces fig 12 c are also compared with those from the frequency domain analysis by teng and kato 2002 the present fully nonlinear nwt results are generally in good agreement with the other independently computed results with regard to the third order forces on the truncated cylinder although their general trends are close the agreement in magnitude is worse than fig 11 bottom mounted cylinder but which result is more correct is not clear since the third order perturbation theory itself also contains several numerical difficulties such as high order derivatives on the body surface including corners in the present fully nonlinear nwt simulation third order stokes wave was fed at the input boundary but can evolve according to the applied fully nonlinear free surface condition before reaching the body surface the third order diffraction force results are very rare in the open literature in this regard let us investigate more on the third order wave loads fig 13 shows the third order triple frequency horizontal and vertical wave loads on the truncated vertical cylinder radius 1m draft 1m with varying water depths of 3 m 5 m and 10 m third order stokes wave of a 0 1m was fed at the input boundary for the considered wave frequencies the corresponding range of wave steepness wave height to wave length ratio is 1 120 1 25 in both horizontal and vertical wave loads the effect of water depth is small in high frequency region k r 0 3 for horizontal and k r 0 6 for vertical forces however in the low frequency region both the horizontal and vertical forces increase significantly with decreasing water depth for instance when k r 0 2 0 3 the horizontal and vertical loads at h 3m are about three times larger than those at h 10 m which implies that third order forces can play more important role under shallow and long wave condition it was also checked that even the shallow water conditions satisfied the ursell number criterion of stokes third order wave theory fig 14 shows the hydrodynamic pressure at the bottom center of the truncated cylinder for water depths of 3m 5m and 10m the first order wave frequency component the second order mean and double frequency components and the third order triple frequency component are presented all the components are increased as water depth becomes shallower the increase of the first order component is small while showing larger increments as the order increases and water depth decreases the overall trend of the triple frequency hydrodynamic pressure is similar to that of the triple frequency vertical force fig 13 c it is of particular interest that there exists stronger nonlinearity or high order components in shallower water case despite smaller wave steepness e g 1 120 than the deeper water cases e g 1 25 since wave heights remain the same in the presented results of figs 13 and 14 we also examine the sensitivity of the figs 13 and 14 results by keeping the same wave slope as h λ 1 35 for all wave frequencies the results are additionally given for h r 3 in figs 13 and 14 we can see that the general trends look similar even in this case fig 15 shows the vertical distribution of hydrodynamic pressure on the weather and lee side of a truncated cylinder with 3m water depth the time series and maximum nonlinear hydrodynamic pressures are compared with linear ones in addition double frequency and triple frequency pressure components are also presented the hydrodynamic pressure on the weather side is generally larger than that on the lee side mainly due to larger wave run up it is of particular interest to note that the second order double frequency pressure field at the weather side decays very slowly with depth in shorter waves due to the influence of reflected waves there this novel phenomenon was first noticed by kim and yue 1989 and later by newman 2005 by using the second order diffraction theory the present fully nonlinear nwt simulation successfully recovers the same phenomenon figs 16 and 17 show the global picture of wave elevation around the structure and the corresponding time series at two specific measurement points the wave inputs are the same as fig 15 both in linear and nonlinear simulations the maximum free surface fluctuation occurs in front of the structure and minimum fluctuation at the back of the structure interestingly the maximum amplitude of second order double frequency and third order triple frequency wave elevations are detected at θ 70 backward side to see in more detail the time series of wave elevation at two different measurement points are shown in fig 17 the first measurement point is near the front of the structure and the second point is at θ 70 although the wave elevation at measurement point 1 is larger than that at measurement point 2 the corresponding time series reveal higher nonlinearity near point 2 as predicted by fig 16 tables 1 and 2 show the respective order components of the horizontal and vertical wave loads of a truncated cylinder according to the type of incident wave inputted for the nwt various types of incident waves can be inputted after being inputted the fully nonlinear free surface condition is applied and accordingly it is to evolve as nonlinear incident waves however the transition needs certain time and distance therefore if the inputted incident wave is already close to the nonlinear wave we can obtain higher quality results to test the sensitivity of high order forces with varying input waves linear wave stokes second order wave and stokes third order wave are respectively fed into the nwt and the results are compared in tables 1 3 the difference in the tables means the discrepancy with respect to the case of stokes third order incident wave first tables 1 2 are for the truncated vertical cylinder of d r 1 and h r 10 in the case of first order wave frequency component the results almost remain the same regardless of the type of incident wave however in the case of second order double frequency and third order triple frequency wave loads the maximal differences are up to 8 when the linear wave is inputted when stokes second order wave is inputted the difference is reduced to less than 1 based on this it is seen that to obtain reasonably accurate triple frequency wave load at least stokes second order wave needs to be inputted next table 3 shows the similar sensitivity for horizontal wave load on bottom mounted vertical cylinder d r 1 and h r 1 compared to tables 1 2 the water depth is reduced by 10 times as was observed in the previous figures we expect higher nonlinearities so larger difference in this kind of shallow water again for the first order wave frequency components the differences remain almost unchanged however the differences in double frequency wave load are significantly increased ranging from 4 to 53 when the linear wave is inputted similarly the maximum difference of 41 can be seen in the triple frequency wave load when the linear wave is inputted in this kind of shallow water case the larger the wavelength the higher order incident wave needs to be inputted when stokes second order wave is inputted the overall accuracy is already significantly improved showing differences less than 4 the above tables are for the relatively moderate nonlinear wave cases as wave steepness is increased further the merit of higher order wave input is to appear more clearly 3 4 wave loads by a bichromatic incident wave potential theory based nwt like actual physical wave maker has freedom to generate various types of input waves including random waves to observe the nonlinear interaction between two regular waves of different frequencies and its effects on the nonlinear diffraction a bichromatic incident wave was also inputted at the input boundary the resulting diffraction wave loads acting on the bottom mounted and truncated cylinders were analyzed fig 18 shows the wave load acting on the bottom mounted cylinder r h 1m when various combinations of bichromatic incident waves are applied fig 18 shows a the time series data of the nonlinear wave load and b the corresponding discrete force spectrum by fourier transform the enlarged figure is also given to see the small magnitudes of second and third order components for this simulation two stokes third waves of different frequencies were inputted it is seen that various frequency components of the wave load exist such as two wave frequency components at first order two double frequency and mean components and sum and difference frequency components at second order and two triple frequency components and four combinations of sum and difference frequencies at third order the time step was 1 90 of the smaller wave period and the simulation was performed for 60 times of smaller wave period since the pattern of the nonlinear force signal is well maintained we can say that the wave reflections from the damping zones are minimal table 4 shows 14 different combinations of input bichromatic waves considered here for the bottom mounted vertical cylinder the amplitudes of the two incident waves were 0 025 m fig 19 shows the resulting second order and third order sum frequency wave loads for the 14 different combinations of input bichromatic waves the results of second order sum frequency wave loads are compared with the result of kim and yue 1990 by using ring source distribution reasonably good agreement can be seen even for the small magnitudes of the second order quantity for all combinations of bichromatic waves as far as authors know there is no comparable published data associated with third order sum frequency wave loads as constituent wave frequencies increase third order sum frequency wave loads increase in particular the normalized third order wave loads are larger than 4 which means that the third order sum frequency wave loads may play a role for high frequency resonances in this kind of shallow water next fig 20 shows the similar plots for the truncated cylinder r 1m d 1m and h 10m in much deeper water the considered frequency combinations are given in table 5 the amplitude of the two incident waves was 0 025 m figs 20 21 present the horizontal and vertical second order sum frequency force components and third order sum frequency force components in the bichromatic waves since authors cannot find any published results for this case the second order sum frequency wave loads were compared against the independently calculated results by using the commercial frequency domain second order diffraction panel program wamit the present nwt results are generally consistent with the wamit results as for the third order sum frequency forces there exists no published result to compare with interestingly in figs 20 21 second order vertical and third order horizontal forces decrease as frequency differences increase but different trend for the other forces all the presented comparisons so far clearly demonstrated that the present fully nonlinear nwt simultaneously produced all the high order results with reasonably good accuracy both for monochromatic and bichromatic waves in this paper all the results were presented for truncated and bottom mounted vertical cylinders however since the 3d nwt can handle arbitrary 3d bodies the similar results can also be produced and analyzed for them in an analogous manner for all the data presented up to this point the range of kc keulegan carpenter number is 0 3 0 5 i e potential theory is valid and viscous drag force is negligible the range of ursell number is 0 003 12 8 i e stokes 3rd order wave is valid even for shallow and long wave cases 4 conclusions in this study a potential theory and boundary element method based fully nonlinear nwt was developed to solve nonlinear diffraction problems for stationary structures the developed nonlinear nwt was based on the mel mixed eulerian lagrangian approach and acceleration potential method the regriding at each time step was done by thin plate spline interpolation method and smoothing scheme was used to prevent potential saw tooth instability on the free surface the spatial derivatives of various physical quantities were calculated by applying the least square gradient reconstruction method to ensure open sea conditions by dissipating unwanted reflected waves an artificial damping zone was imposed at the outer regions of all sides convergence tests with decreasing panel size were performed so that the converged high order quantities can be obtained with reasonable accuracy a series of nonlinear simulations were conducted for fixed truncated and bottom mounted vertical circular cylinders and the results were compared with published experimental results and independently calculated results by high order diffraction method to estimate the accuracy of the respective order quantities the discrete amplitude spectrum was obtained through fft from simulated time series the fully nonlinear nwt reliably estimated the first order wave frequency second order mean and double frequency and third order triple frequency wave loads simultaneously the nonlinear wave run up and pressure distribution were also well compared against published experimental results the increase of third order force for smaller water depth to wave length ratio was noticeable with more shallow water nonlinear effects since the perturbation theory above second order is already very complicated there is no merit other than less computational time compared to the direct nonlinear nwt simulation in time domain the sensitivity of the respective order wave loads with linear second order and third order stokes input waves was also presented and the importance of the use of high order stokes incident wave in relatively shallow water depth was underscored the novel phenomenon of slow decay of second order double frequency pressure with depth at the weather side in short waves was recovered by the present fully nonlinear nwt simulation finally the nonlinear nwt simulations for bichromatic incident waves were also conducted and the results compared well against published second order diffraction theory credit authorship contribution statement sung jae kim investigation calculation formal analysis writing original draft moo hyun kim conceptualization investigation writing review editing weoncheol koo supervision funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this research was supported by the motie ministry of trade industry and energy in korea under the fostering global talents for innovative growth program p0008750 supervised by the korea institute for advancement of technology kiat this work was also partly supported by the national research foundation of korea nrf grant funded by the korea government msit no 2017r1a5a1014883 no 2018r1d1a1b07040677 
