index,text
21740,this study proposes a deep deterministic policy gradient algorithm based on optimized sample pools and average motion critic network osam ddpg to realize the path following control of autonomous underwater vehicles auvs the ideas of optimizing the sampling mode and the evaluation of motion are proposed to improve the efficiency of algorithm osam ddpg is used to train the force to state mapping of an auv s dynamical model to realize its control in the simulation test the osam ddpg algorithm only needs some episodes to obtain the complete control strategy based on the experience gained from the training the problems of various paths following in the interference environment can be addressed and the results demonstrate that the effect of path following control based on osam ddpg is better than s plane keywords auv path following control deep deterministic policy gradient sample pools average motion critic 1 introduction as an unmanned underwater equipment autonomous underwater vehicles auvs have received increasing attention and have been applied in military and civil fields they also play an important role in the development of marine resources and marine environmental protection zhang et al 2018 an auv is a nonlinear system yu et al 2017a meanwhile the underwater environment is complex and dynamic and the movement of auvs is easily disturbed by water flow and other factors therefore the quality of the auv automatic control method is directly related to whether the auv can successfully complete tasks and affects the safety performance of the auv the development of science and technology has led to an increasing number of control methods being applied in the auv field such as pid yin et al 2019 s plane sun et al 2013 adaptive tabataba i nasab et al 2019 qu et al 2020 active disturbance rejection adrc huang et al 2018 ibraheem 2020 sliding mode liang et al 2016 dai et al 2020 backstepping cho et al 2019 quiroz and cuellar 2019 and intelligent guo et al 2019 elhaki and shojaei 2020 xiang et al 2017 controllers pid controller yin et al 2019 performs well but it is a linear controller so the control effect on complex auv system is not stable sliding mode controller liang et al 2016 dai et al 2020 has good robustness however because of lacking self learning and self adaptation sliding mode controller must take a long time to enter the sliding surface to make control poor performance when auv works in a large range at the same time the sliding mode controller has a flutter problem adrc huang et al 2018 ibraheem 2020 is widely used in unmanned aerial vehicles uavs but it is not effective in resisting current interference underwater the backstepping algorithm cho et al 2019 quiroz and cuellar 2019 mainly focuses on the design of the controller but ignores the problem of control stability it also has the problem of dimensional explosion the adaptive controller tabataba i nasab et al 2019 qu et al 2020 can realize autonomous correction but it requires a precise mathematical model of the control object at the same time the closed loop system is required to have strong suppression ability to various disturbances and low sensitivity to parameter changes in the actual working environment the system robustness is poor in view of the problems such as unstable control poor robustness lack of anti interference ability and the need for accurate mathematical model the improved reinforcement learning algorithm is adopted as the controller to realize auv control this method can improve the control stability robustness and anti interference ability of auv through training and learning unlike the controller designed by humans the controller obtained through learning can adapt to data and improve accordingly at present some researches have carried out the design of reinforcement learning controller anusha n et al nagabandi et al 2017 used a model based method of deep reinforcement learning with only 17 min of training samples to make a six legged robot follow the required linear trajectory successfully however the range of its training environment is small the navigation path is short and its training results are only applicable to the following of target points runsheng y et al yu et al 2017b used the drl method to train an auv to track a path and compared it with the pid control method however in the process of training they designed the reward value according to the relative position between the robot and the target path consequently the system is only applicable to the currently trained path retraining is extremely time consuming when new paths must be tracked mariano p et al de paula et al 2015 proposed a path following control method for auvs based on adaptive reinforcement learning based on the continuous interaction with nonstationary environments this method realized the adaptive control of auvs and obtained good simulation test results however this work only conducted a preliminary study on the algorithm only a set of simulation tests was performed and results were imperfect el fakdi a et al el fakdi et al 2005 proposed an online control method based on reinforcement learning this method used the direct strategy search method of reinforcement learning to learn the internal state mapping of some behaviors however the control result of the simulation test indicated a large oscillation shi w et al shi et al 2018 proposed an mpq dpg algorithm to investigate trajectory tracking problem for a class of autonomous underwater vehicles auvs the algorithm could achieve high level tracking control accuracy of auvs and stable learning by applying a hybrid actors critics architecture where multiple actors and critics were trained to learn a deterministic policy and action value function respectively the effectiveness and generality of the mpq dpg algorithm were verified by the application on auv with two different reference trajectories however the random experience extraction method in the algorithm made agent fall into the local optimal based on the above research it can be found that ddpg algorithm is applied to continuous motion control which has good robustness and adaptability and does not need to spend a lot of time to adjust parameters however there are still the following problems in the application of underwater vehicles 1 the training experience only applicable to the current environment however dynamic underwater environment is characterized by complex and variable multiple interfering factors and large scope it is difficult to consider all the disturbances in the underwater environment 2 there are errors in the dynamical modeling of auv leading to the fact that the experience obtained from training in the simulation environment may not be able to control the auv movement in practice effectively 3 in the training process of neural network ddpg adopts the method of random sampling resulting in low utilization rate of samples so that the training falls into the local optimal 4 in ddpg the evaluation of motion in the critic network is holistic while the motion control of auv is 6 degrees of freedom dof and some actions have no effect or side effect as a result there is little difference between the state value function of optimal and non optimal actions so that the learning efficiency of the algorithm is low considering the above problems this study proposes a ddpg algorithm based on optimized sample pools and average motion critic network osam ddpg to realize the path following control of an auv to solve the first and second problems this study takes the dynamical model of an auv with fuzzy hydrodynamic parameters as the environment the force and torque acting on the auv are obtained by using the osam ddpg method the velocity and angular velocity of the auv are calculated using the kinematics and dynamics model the auv control is realized by training the mapping of forces and states meanwhile the random interference force model is added in the training process to simulate the dynamic underwater environment to train a ddpg based control system with anti interference ability to solve the third and fourth problems this study improves the conventional ddpg algorithm by optimizing the sampling mode and the evaluation of motion the efficiency and general applicability of the algorithm are improved by the above methods compared with other control algorithms using the improved reinforcement learning algorithm as the controller of auv does not require accurate auv mathematical model and has the advantages of anti interference good stability and high robustness the remainder of this paper is organized as follows in the second chapter the designed auv path following control system is presented the fuzzy dynamic model of auv is established and the path following strategy is discussed in chapter 3 osam ddpg is designed and compared with ddpg a path following controller based on the osam ddpg algorithm is presented and its stability is proven in chapter 4 the path following control simulation tests are discussed and compared with the s plane control chapter 5 concludes the study 2 path following control system the design process of the path following controller is as follows first the desired velocity desired path and current position of the auv are considered as inputs of the system then the target instructions such as the target velocity heading angle pitch angle are solved in accordance with the path following strategy on the basis of the training experience the target commands are mapped to the control force required by auv movement the control force acts as an auv model and outputs the actual motion parameters the difference between them and the target instruction for the control system the control system regulates the difference value near 0 to achieve the path following goal the flow chart is shown in fig 1 on the basis of the above path following process design three tasks namely path following strategy design osam ddpg control algorithm design and training and auv fuzzy model construction must be completed 2 1 fuzzy model of auv the controller design requires an accurate mathematical model which directly affects control quality on the one hand an extremely complex mathematical model will complicate the control system and deteriorate the overall performance and is not conducive to engineering implementation on the other hand an extremely simple mathematical model cannot reflect the motion characteristics of the system and might decrease control precision therefore a suitable mathematical model is crucial in this work an auv controlled by rudders and a propeller is taken as the actual physical model as shown in fig 2 the auv is 1 46 m long and weighs 45 kg cfd is used to calculate the hydrodynamic coefficients of the auv to establish the dynamic model the coordinate system of the auv is divided into the geodetic and auv coordinate systems as shown in fig 3 the hydrodynamic formula of the auv is established as follow sun et al 2016 1 m v c v v d v v g η τ g 0 where m is the inertia coefficient matrix of the system that can satisfy μ m r b m a 0 m r b is the inertia matrix of the carrier that can satisfy m r b m r b t 0 and m r b 0 m a is the added mass coefficient matrix that can satisfy m a m a t 0 c v is the coriolis force coefficient matrix that can satisfy c a v c a t v d v is the viscous hydrodynamic coefficient matrix that can satisfy d v 0 x d v x t x 0 τ is the control input vector g 0 is the static load vector which is set to 0 to facilitate the study and g η is the restoring force torque vector the values of some hydrodynamic coefficients are shown in table 1 given the accuracy of the auv model and the fineness of meshing the hydrodynamic coefficient calculated by the cfd is not very accurate this result makes the learning experience not necessarily applicable to real auvs after using the osam ddpg algorithm to train the model therefore some important hydrodynamic coefficients are added with an error of 10 to blur the auv hydrodynamic parameters during the training process these hydrodynamic coefficients are randomly selected within a range of 10 error thus making the training experience universally applicable remark 1 compared with the training method of a fixed model this method solves the problem of the learning experience being inapplicable to real auvs because of the perturbation of the hydrodynamic coefficient compared with the model free training method it solves the limitation of high sample complexity and reduces the training time 2 2 path following strategy the auv planning system calculates the target instructions such as the target velocity and heading and sends them to the control system the control system controls the auv to navigate according to the target instructions to complete the path following task the planning system completes the calculation of the target instruction through the path following strategy the details are as follows on the horizontal plane the auv planning system uses formulas 2 and 3 to calculate the target heading angle 2 ψ ˆ ψ arctan y 2 y 1 x 2 x 1 x 1 x 2 ψ arctan y 2 y 1 x 2 x 1 π x 1 x 2 π 2 x 1 x 2 and y 1 y 2 π 2 x 1 x 2 and y 1 y 2 0 x 1 x 2 and y 1 y 2 formula 2 calculates the target heading angle in the process of point following ψ ˆ is the target heading angle ψ is the current heading angle x 1 y 1 is the current position of the auv in the geodetic coordinate system and x 2 y 2 is the first node coordinate of the auv in the geodetic coordinate system the calculation formula of the target heading in the straight following process is as follows 3 ψ ˆ ψ l e c 10 π 6 η in the straight path planning process l e c is the distance between the current position of the auv and the connection between the previous node and the current target node η is the angle between the line connecting the previous target point and the current target node and the horizontal axis in the curve path planning process l e c is the distance between the auv s current position and the tangent line of the curve η is the angle between the line connecting the current tangent point to the next step and the horizontal axis other target instructions are lateral vertical velocities and heel angle of auv v ˆ 0 ω ˆ 0 ϕ ˆ 0 during the path following on horizontal plane the target pitch angle is θ ˆ 0 during the path following on the vertical plane formulas 4 and 5 are used to calculate the target pitch angle 4 θ ˆ θ l e c 10 π 12 θ p where θ ˆ is the target pitch angle θ is the current pitch angle θ p is the angle between the target path and its horizontal projection 5 θ p arccos a b a b a δ x δ y δ z is the slope of the target path or the slope of the path tangent b δ x δ y 0 is the projection of vector a onto the horizontal plane where δ x δ y δ z are the error of position in the direction of the three dimensional coordinate 3 auv control strategy with osam ddpg 3 1 osam ddpg algorithm ddpg lillicrap et al 2016 is a deep reinforcement learning algorithm that combines actor critic peters and schaal 2008 and dqn mnih et al 2015 the concept is to apply the memory banks in the dqn structure and the idea of two neural networks with the same structure but different frequencies of parameter update on actor critic meanwhile the deterministic idea is used to change the method of random screening at the continuous motion interval with the original actor critic and only one motion value is produced at the continuous interval this study proposes the osam ddpg to solve the questions 3 and 4 mentioned in section1 3 1 1 average motion critic network the critic network in ddpg algorithm only evaluates the overall actions performance however there are 6 dof outputs which are coupled with each other in the control system of auv the critic network does not evaluate the actions in each dimension so the difference between the state value of the optimal and non optimal actions is small resulting in low learning efficiency of the algorithm this study proposes to establish the average motion critic network to solve this problem osam ddpg algorithm is divided into two parts main net and target net as shown in fig 4 each part includes an actornet and six criticnets the actornet outputs actions of 6 dof and the criticnet evaluates each action considering a standard reinforcement learning rl problem a finite markov decision process mdp which comprises a current state s t an action space a t a reward function r and the next state s t 1 is established take the absolute value of the difference between the actual motion state of auv and the target state as the system reward 6 r δ u δ v δ ω δ ϕ δ θ δ ψ where δ u u u ˆ δ v v v ˆ δ ω ω ω ˆ δ ϕ ϕ ϕ ˆ δ θ θ θ ˆ δ ψ ψ ψ ˆ extract data from the experience pool for learning input the 6 dof actions a t form s t a t r s t 1 into six critic networks of main net and each critic network calculates the value function of each action respectively by bellman equation 7 q π s t i a t i e r t s t 1 e r s t i a t i γ e a t 1 π q π s t 1 i a t 1 i where i is between 1 and 6 if the target policy is deterministic we can describe it as a function μ s a and avoid the inner expectation 8 q μ s t i a t i e r t s t 1 e r s t i a t i γ q μ s t 1 i μ s t 1 i get the average q value q s t a t 9 q μ s t a t 1 6 i 1 6 q μ s t i a t i according to q learning watkins and dayan 1992 considering function approximators parameterized by θ q the loss function is 10 l q r γ max a q s t 1 μ s t 1 θ q q s t a t θ q train the neural network to minimize the loss function so that the actual q value tends to the target q value on basis of policy gradient a parameterized actor function μ s θ μ which specifies the current policy by deterministically mapping states to a specific action is maintained the parameters of the motion estimation network are updated by following function 11 θ μ j 1 n t θ μ q s a θ q s s t a μ s t θ μ 1 n t a q s a θ q s s t a μ s t θ μ μ s θ μ s s t 3 1 2 optimize sample pools in ddpg algorithm the network samples randomly from the buffer for training the buffer is finite in size in which s t a t r s t 1 is stored and sampled randomly according to the exploration strategy however due to the limited of sampling space size and the general learning effect of samples in the early stage the learning rate will slow down in the later stage and the behavior cannot be significantly improved making the control range of the controller unstable therefore in the second stage of learning the sample space should be increased to get better samples so as to obtain more control experience before that the bisimulation is showed as following definition 1 the bisimulation givan et al 2003 if e s s is the relationship of bisimulation then for s 1 s 2 s 1 a a r s 1 a r s 2 a 2 a a c s e t c p t s 1 a t c p t s 2 a where the equivalent set of states s with respect to e is denoted by s e p t s 1 a represents the probability that the system takes an action a and moves to the next state at time t in the process of mdp if the two states satisfy the bisimulation relationship it can be denoted as s 1 s 2 lemma 1 bisimulation metric ferns et al 2004 d is defined as the set of metrics on the state set s and let d d for s 1 s 2 s define g d s 1 s 2 max a a d a s 1 s 2 γ t k d p s 1 a p s 2 a where 0 γ 1 d a s 1 s 2 r s 1 a r s 2 a t k d is the kantorovich metric gibbs and su 2002 which is defined by the following linear program max i 1 s i 1 s p s i q s i u i subject to i j u i u j d s i s j i 0 u i 1 on basis of the above questions this study constructed two sample spaces besides the original sample space d 0 namely high error sample space d 1 and diversity sample space d 2 in the space d 1 the temporal difference td error is used as the heuristic information to sort samples in the sample space so as to improve the probability of selecting samples with large error and the bisimulation measurement method is used to measure the distance between samples in d 2 during the algorithm learning process the training samples will be selected in proportion from the d 1 and the d 2 respectively so as to give consideration to the diversity and value of samples during the process of training the sample s t a t r s t 1 is put into d 0 td error of the action function is calculated as shown in formula 10 when the td error is larger than a threshold value it indicates that the sample has a great influence on the change of the action value function and it can be considered that the modified sample has high value thus the sample is put in d 1 when the samples in d 1 are sufficient the training samples are not only selected from d 0 but from d 0 and d 1 respectively in a certain proportion meanwhile algorithm 1 is used to calculate the distance between samples in d 0 low similarity samples are put into d 2 to ensure the diversity of selected samples after that samples from d 1 and d 2 are selected respectively in a certain proportion for learning the distance between samples is calculated by algorithm 1 the larger the distance the lower the similarity of samples algorithm 1 distance measurement algorithm between states remark 2 compared with the traditional ddpg algorithm osam ddpg selects samples from the diversity sample pool and the high error sample pool respectively in proportion so as to improve the utilization efficiency of samples and the convergence performance of the algorithm in addition osam ddpg algorithm adopts the way of multiple critic networks to improve the difference between actions so as to improve the efficiency of the algorithm 3 2 osam ddpg controller the idea of the osam ddpg controller is that the action in the reinforcement learning barto 1998 algorithm corresponds to the thrust and torque of the auv and the state in the algorithm corresponds to the velocity and angular velocity of the auv the algorithm is learned to realize the mapping relationship between force and state the application of osam ddpg in auv control requires the establishment of a critic q s t a t θ q and an actor μ s t θ μ neural network structure θ q and θ μ are the weight parameters of the network two neural networks namely the target and prediction networks are created in each of the structures then the output of osam ddpg is regarded as the force τ of the control system which regulates the movement of the auv the osam ddpg control system can be regarded as a mapping from the current auv state to the force combined with function a μ s t θ μ the force can be expressed as 12 τ μ s t θ μ the auv s states is mainly reflected in velocity and attitude angles 13 v u v ω ψ ϕ θ ψ where u v ω are the longitudinal lateral and vertical velocities of the auv ϕ θ ψ are the heel pitch and heading angles of auv therefore 14 τ μ s t μ v t ψ t formula 14 indicates the osam ddpg controller whose inputs are velocities and attitude angles of the auv and whose outputs are the control forces in accordance with the parameter update formula of the osam ddpg algorithm the above mapping relationship is completed and the weight coefficients of neural networks are updated remark 3 at present research on ddpg based tracking control is based on path design in physical environment such as article 16 and article 17 making the training strategy only applicable to the current environment in this study the auv dynamics model is regarded as an environmental to design controller it is not limited to a single environment the auv only needs to be trained once and the control strategy obtained is suitable for most underwater environments 3 3 stability analysis this section proves the stability of the osam ddpg control system before analyzing the stability some assumptions are introduced following assumption 1 the computer cpu computation speed is much faster than the environment state transition speed s t t θ μ t assumption 2 according to the movement law of auvs when the auv state velocity or heading is less than the target state positive force action acceleration is required when the auv state velocity or heading is greater than the target state a counteracting force action is required to decelerate when s t s t 0 a t 0 when s t s t 0 a t 0 lemma 2 asymptotic stability chiang and thorp 2010 let d r n be a region containing the origin f x be the system defined on d and f 0 0 for system x f x if there is a continuous differentiable positive definite function v x such that v x is negative then the system is asymptotic stability lim t x t t 0 x 0 x e 0 theorem 1 consider system 1 the controller 14 and the iterative strategy 10 and 11 under the assumption 1 and 2 according to lemma 2 auv dynamic system can be stabilized when it reaches the target state under any initial condition and the tracking error converges to 0 proof from the dynamic formula of auv and the mapping of the osam ddpg algorithm from action to state formulas 1 and 12 the following formula can be obtained 15 m s t c s t s t d s t s t g η τ μ s t θ μ where d s t is not a singular matrix and the matrix is invertible b s t is set to be the d s t 1 so 16 s t b s t μ s t θ μ m s t c s t s t g η generally the auv is in the neutral state that is its own gravity and buoyancy are equal meanwhile the center of gravity of the auv coincides with the center of buoyancy therefore the g term is omitted taking the derivative with respect to t 17 d s t d t b s t s t s t t g 1 b s t g 2 where 18 g 1 μ s t θ μ m s t c s t s t g η 19 g 2 μ s t θ μ s t s t t μ s t θ μ θ μ θ μ t m s t t c s t s t s t t c s t s t t according to assumption 1 s t t θ μ t thus s t t is ignored 20 d s t d t b s t μ s t θ μ θ μ t the stability of the osam ddpg control system is proven by the lyapunov theorem park sanghyuk et al 2007 the positive definite function is established as 21 v s t 1 2 s t s t 2 and differentiated as 22 d v d t s t s t d s t d t s t s t b s t μ s t θ μ θ μ t since actor function q is a cumulative function of time its partial derivative with respect to t is greater than 0 23 q s a θ q t q s a θ q s s t q s a θ q a μ s θ μ θ μ θ μ t q s a θ q a μ s θ μ θ μ θ μ t α 0 substitute formula 23 into formula 22 24 d v d t s t s t b s t α a q s t a θ q according to formula 10 25 ς l q 2 r s t a t γ 1 q s t a t θ q 2 which is differentiated 26 ς a t 2 r s t a t γ 1 q s t a t θ q h where 27 h r s t a t a t γ 1 q s t a t θ q a t given that the loss function has a minimum ς a t can be 0 thus 28 r s t a t a t 1 γ q s t a t θ q a t in combination with formula 24 29 d v d t s t s t b s t α 1 γ r s t a t a t in accordance with the reward value obtained by the auv s action the reward value function is established as follows 30 r s t a t λ s a t s t λ a t 2 t s t where λ is a positive coefficient therefore 31 v t s t s t b s t α 1 γ 2 a t t λ s t s t a t ϒ where ϒ b s t α 1 γ 2 t λ in formula 31 α 0 λ 0 1 γ 0 b s t d s t 1 and d s t is the viscous hydrodynamic coefficient matrix that is d s t 0 x d s t x t x 0 thus ϒ 0 according to assumption 2 when s t s t 0 a t 0 when s t s t 0 a t 0 therefore v s t 0 and it is negative definite by the lyapunov theorem auv dynamic system can be stabilized when it reaches the target state under any initial condition the system is stable since v s t is positive definite and v s t is negative definite according to the lemma 2 the system is asymptotically stable so tracking error of the system converges to 0 3 4 simulation training the osam ddpg algorithm is used as the controller of the auv path following system the states and the differences between the current and target states of the auv are taken as the inputs and the outputs are the thrust and steering moment the system randomly generates the target states the auv s velocities and attitude angles are obtained using the outputs of the algorithm to push the auv dynamic model the errors are obtained by comparing with the target states and the training system makes the navigation error of the auv approach 0 in addition the horizontal interference force is generated randomly during system training and the range of interference force is 500 500 n such that the control system obtained a certain anti interference ability the controller training process is as follows algorithm 2 the controller training process auv control simulation system was built according to algorithm 2 and then ddpg and osam ddpg algorithms were used to train auv control the results are shown in fig 5 the abscissa represents the episodes of training whereas the ordinate represents the total reward of each episode a total of 10 000 episodes are created during simulation training each training episode is updated with 500 steps although the learning curves of both osam ddpg and ddpg algorithm converges to a satisfactory value the learning process of osam ddpg performs more stable and it can be seen form fig 5 that osam ddpg is more effective than conventional ddpg the control range of velocity 0 m s to 1 m s the control range of heading angle 180 180 and the control range of pitch angle 45 45 can be obtained through training fig 5 shows that when the reward value converges to 40 60 the training is successful remark 4 note that the training that rewards excessively or poorly is a failure the auv gains a positive reward when it reaches the target state but is only successful when it maintains the motion state in the target state for 50 steps therefore if the auv fails to reach the target state then the reward value will be very small when the auv reaches the target state intermittently the reward value will be large but is not considered successful 4 simulation experiments the auv dynamics kinematics and visual environment models are established and the osam ddpg controller is trained after the training the optimal control strategy is obtained and the velocity heading and pitch of the auv can be controlled by the controller then the simulation results of the s plane controller are compared the simulation experiments of the linear circular and curve paths are completed by using the path following strategy 4 1 comparison of osam ddpg and s plane control s plane control sun et al 2013 learns from the pid method based on fuzzy control fig 6 is the control surface of the s plane method which expresses the relationship between deviation deviation rate and control force the algorithm is expressed as follows 32 u i 2 0 1 0 exp k i 1 e i k i 2 e i 1 0 δ u i f i k i u i where i is the i degree of freedom e i and e i are the control error and its derivative u i is the object of control k i1 and k i2 are the control parameters f i is the control force k i is the maximum force or torque δ u i corresponds to the magnitude of the interference force the s plane and osam ddpg control methods are used to control auv navigation at a constant velocity of 0 8 m s and a heading angle of π 12 at the horizontal plane with constant instantaneous and periodic interference in different stages simulation test results are shown in fig 7 during the first stage of auv navigation a lateral 3000 n sudden force is applied at 250 s and the duration is 10s table 2 shows the mean absolute error mae and maximum absolute error maxe of auv s velocities and heading angles under the control of two methods results indicate that the velocity and heading of the auv under the control of s plane and osam ddpg are greatly deviated when instantaneous force is applied after the force disappears the auv under both controllers can be restored to target command navigation however the auv s movement errors under osam ddpg controller are smaller than that under s plane controller the osam ddpg controller can control auv stability to the target instruction during interference although the auv cannot directly return to the target state due to the extremely large instantaneous interference force offset can be minimized after disturbance force disappears the auv quickly returns to the target state in the second stage of auv navigation process the force of 300 n in the direction of e η in the geodetic coordinate system is added table 3 shows the mae and maxe of auv s velocities and heading angles under the control of two methods test results show that the s plane and osam ddpg controllers have a certain deviation in velocity following however according to table 3 the max velocity deviation of the osam ddpg controller is obviously smaller than that of the s plane controller in terms of heading following the s plane controller controls the heading of the auv with obvious oscillation the heading errors of the auv approaches 0 in the osam ddpg controller during the third stage of auv navigation a periodic interference of 300 sin 0 01 π t n is applied table 4 shows the mae and maxe of auv s velocities and heading angles under the control of two methods experimental results show that the osam ddpg control effect is obviously better than that of the s plane according to table 4 and fig 7 under the control of the osam ddpg controller the velocity and heading oscillations of the auv are obviously smaller and the auv can navigate well according to the target instructions the above simulation test indicates that under the condition of unchanged parameters the control effect of the osam ddpg controller in the case of various disturbances is obviously better than that of the s plane controller 4 2 the path following in horizontal plane the comb scan circular and curve paths were established in the simulation environment to realize the various path following the comb scan path nodes were 10 50 10 350 150 350 150 50 300 50 300 350 450 350 450 50 the initial point of the auv was 0 0 the initial velocity was 0 m s and the target velocity was 0 8 m s during auv navigation the external force of 150n in the e η direction in the geodetic coordinate system was applied the results are shown in fig 8 table 5 shows the mae and maxe of auv s velocities heading angles and following errors of the comb path following after 500s results show that under the action of additional constant interference force the auv s velocity and heading fluctuate to some extent during navigation but can still track the target path well although the velocity of the auv would fluctuate slightly during turning so that the auv would deviate from the target path the maxe is 12 6116m due to the influence of rudder force the osam ddpg can quickly control the auv recovery to the target path the control errors are within a reasonable range the circular path was established with the center at 300 200 and a diameter of 100m the initial point of the auv was 50 350 the initial velocity was 0 m s and the target velocity was 0 8 m s during auv navigation an instantaneous force of 5000 n was applied at 1100s and the duration was 15s the results are shown in fig 9 table 6 shows the mae and maxe of auv s velocities heading angles and following errors of the circular path following after 750s results show that the auv can track the circular target path well with the osam ddpg controller under the action of large instantaneous disturbance force the auv will deviate from the path the maxe is 3 8928m and the motion parameters will be offset accordingly however after the force disappears the auv can quickly recover to the target command and target path the control errors are within a reasonable range the curve path s function was y 50 sin 0 02 x 200 150 x 450 the initial point of the auv was 50 350 the initial velocity was 0 m s and the target velocity was 0 8 m s the cyclic force of f 300 sin 0 01 π t was applied the results are shown in fig 10 table 7 shows the mae and maxe of auv s velocities heading angles and following errors of the curve path following after 500s results indicate that the auv can track the curve path with the control of the osam ddpg controller the motion states of the auv will oscillate near the target instruction influenced by periodic interference force as shown in table 7 and fig 10 but the amplitude of oscillation is acceptable according to the above simulation test when auv navigates in the horizontal plane osam ddpg can control auv to achieve straight or curve path tracking well and the controller can control the auv to resist different interferences 4 3 3d path following a 3d environment model was established and the 3d path following simulation test was performed a 3d straight target path was established in the simulation environment 33 x 100 5 k y 150 2 k z 200 6 k 0 k 100 the initial point of the auv was 100 100 100 the initial velocity was 0 m s and the target velocity was 0 8 m s the results are shown in fig 11 table 8 shows the mae and maxe of auv s velocities heading angles pitch angles and following errors of the 3d straight path following after 750s results show that when the 2d path is extended to 3d the osam ddpg controller can also control the auv s straight path following well the auv s velocity heading angle and pitch angle can achieve the target command quickly the control errors are within a reasonable range given that the following strategy is toward the target path the auv can track the target straight smoothly the 3d curve path was established in the simulation environment and the path curve function was 34 x 100 cos k y 100 sin k z 100 k 0 k 6 π the initial point of the auv was 0 0 0 the initial velocity was 0 m s and the target velocity was 0 8 m s the results are shown in fig 12 table 9 shows the mae and maxe of auv s velocities heading angles pitch angles and following errors of the 3d curve path following after 1500s results indicate that the osam ddpg control algorithm performs well in the 3d path curve following under the following strategy and the control algorithm the auv can gradually approach the target path and then track the target path the max following error is 0 4m the following error in fig 12e increases initially because the auv must adjust the heading in the initial stage to achieve the effect of approaching the target path simulation test results indicate that the controller designed in this study can control the velocity heading and pitch angle of the auv simultaneously and can control the auv well to achieve the target command the controller can be applied to the underwater 3d motion of auvs 5 conclusion in this study osam ddpg algorithm is proposed to realize the auv path following control simulation training indicates that the osam ddpg is more effective than conventional ddpg the dynamical model of auvs is taken as the environment and the mapping relationship between force and state is trained the algorithm can be applied to all kinds of tasks with the experience gained from only one successful training simulation test results indicate that the anti interference ability of the osam ddpg controller is better than that of the s plane controller compared with other controllers mentioned in this paper the proposed control algorithm does not require an accurate model of auv the control stability and robustness of auv are improved by learning and training at the same time interference is considered in the training process which improves the anti interference ability of the controller credit authorship contribution statement yushan sun data curation funding acquisition resources xiangrui ran formal analysis methodology writing original draft writing review editing guocheng zhang conceptualization data curation software xiangbin wang software hao xu software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the work was supported in part by the china national natural science foundation nos 51779057 51709061 the equipment pre research project project number 41412030201 
21740,this study proposes a deep deterministic policy gradient algorithm based on optimized sample pools and average motion critic network osam ddpg to realize the path following control of autonomous underwater vehicles auvs the ideas of optimizing the sampling mode and the evaluation of motion are proposed to improve the efficiency of algorithm osam ddpg is used to train the force to state mapping of an auv s dynamical model to realize its control in the simulation test the osam ddpg algorithm only needs some episodes to obtain the complete control strategy based on the experience gained from the training the problems of various paths following in the interference environment can be addressed and the results demonstrate that the effect of path following control based on osam ddpg is better than s plane keywords auv path following control deep deterministic policy gradient sample pools average motion critic 1 introduction as an unmanned underwater equipment autonomous underwater vehicles auvs have received increasing attention and have been applied in military and civil fields they also play an important role in the development of marine resources and marine environmental protection zhang et al 2018 an auv is a nonlinear system yu et al 2017a meanwhile the underwater environment is complex and dynamic and the movement of auvs is easily disturbed by water flow and other factors therefore the quality of the auv automatic control method is directly related to whether the auv can successfully complete tasks and affects the safety performance of the auv the development of science and technology has led to an increasing number of control methods being applied in the auv field such as pid yin et al 2019 s plane sun et al 2013 adaptive tabataba i nasab et al 2019 qu et al 2020 active disturbance rejection adrc huang et al 2018 ibraheem 2020 sliding mode liang et al 2016 dai et al 2020 backstepping cho et al 2019 quiroz and cuellar 2019 and intelligent guo et al 2019 elhaki and shojaei 2020 xiang et al 2017 controllers pid controller yin et al 2019 performs well but it is a linear controller so the control effect on complex auv system is not stable sliding mode controller liang et al 2016 dai et al 2020 has good robustness however because of lacking self learning and self adaptation sliding mode controller must take a long time to enter the sliding surface to make control poor performance when auv works in a large range at the same time the sliding mode controller has a flutter problem adrc huang et al 2018 ibraheem 2020 is widely used in unmanned aerial vehicles uavs but it is not effective in resisting current interference underwater the backstepping algorithm cho et al 2019 quiroz and cuellar 2019 mainly focuses on the design of the controller but ignores the problem of control stability it also has the problem of dimensional explosion the adaptive controller tabataba i nasab et al 2019 qu et al 2020 can realize autonomous correction but it requires a precise mathematical model of the control object at the same time the closed loop system is required to have strong suppression ability to various disturbances and low sensitivity to parameter changes in the actual working environment the system robustness is poor in view of the problems such as unstable control poor robustness lack of anti interference ability and the need for accurate mathematical model the improved reinforcement learning algorithm is adopted as the controller to realize auv control this method can improve the control stability robustness and anti interference ability of auv through training and learning unlike the controller designed by humans the controller obtained through learning can adapt to data and improve accordingly at present some researches have carried out the design of reinforcement learning controller anusha n et al nagabandi et al 2017 used a model based method of deep reinforcement learning with only 17 min of training samples to make a six legged robot follow the required linear trajectory successfully however the range of its training environment is small the navigation path is short and its training results are only applicable to the following of target points runsheng y et al yu et al 2017b used the drl method to train an auv to track a path and compared it with the pid control method however in the process of training they designed the reward value according to the relative position between the robot and the target path consequently the system is only applicable to the currently trained path retraining is extremely time consuming when new paths must be tracked mariano p et al de paula et al 2015 proposed a path following control method for auvs based on adaptive reinforcement learning based on the continuous interaction with nonstationary environments this method realized the adaptive control of auvs and obtained good simulation test results however this work only conducted a preliminary study on the algorithm only a set of simulation tests was performed and results were imperfect el fakdi a et al el fakdi et al 2005 proposed an online control method based on reinforcement learning this method used the direct strategy search method of reinforcement learning to learn the internal state mapping of some behaviors however the control result of the simulation test indicated a large oscillation shi w et al shi et al 2018 proposed an mpq dpg algorithm to investigate trajectory tracking problem for a class of autonomous underwater vehicles auvs the algorithm could achieve high level tracking control accuracy of auvs and stable learning by applying a hybrid actors critics architecture where multiple actors and critics were trained to learn a deterministic policy and action value function respectively the effectiveness and generality of the mpq dpg algorithm were verified by the application on auv with two different reference trajectories however the random experience extraction method in the algorithm made agent fall into the local optimal based on the above research it can be found that ddpg algorithm is applied to continuous motion control which has good robustness and adaptability and does not need to spend a lot of time to adjust parameters however there are still the following problems in the application of underwater vehicles 1 the training experience only applicable to the current environment however dynamic underwater environment is characterized by complex and variable multiple interfering factors and large scope it is difficult to consider all the disturbances in the underwater environment 2 there are errors in the dynamical modeling of auv leading to the fact that the experience obtained from training in the simulation environment may not be able to control the auv movement in practice effectively 3 in the training process of neural network ddpg adopts the method of random sampling resulting in low utilization rate of samples so that the training falls into the local optimal 4 in ddpg the evaluation of motion in the critic network is holistic while the motion control of auv is 6 degrees of freedom dof and some actions have no effect or side effect as a result there is little difference between the state value function of optimal and non optimal actions so that the learning efficiency of the algorithm is low considering the above problems this study proposes a ddpg algorithm based on optimized sample pools and average motion critic network osam ddpg to realize the path following control of an auv to solve the first and second problems this study takes the dynamical model of an auv with fuzzy hydrodynamic parameters as the environment the force and torque acting on the auv are obtained by using the osam ddpg method the velocity and angular velocity of the auv are calculated using the kinematics and dynamics model the auv control is realized by training the mapping of forces and states meanwhile the random interference force model is added in the training process to simulate the dynamic underwater environment to train a ddpg based control system with anti interference ability to solve the third and fourth problems this study improves the conventional ddpg algorithm by optimizing the sampling mode and the evaluation of motion the efficiency and general applicability of the algorithm are improved by the above methods compared with other control algorithms using the improved reinforcement learning algorithm as the controller of auv does not require accurate auv mathematical model and has the advantages of anti interference good stability and high robustness the remainder of this paper is organized as follows in the second chapter the designed auv path following control system is presented the fuzzy dynamic model of auv is established and the path following strategy is discussed in chapter 3 osam ddpg is designed and compared with ddpg a path following controller based on the osam ddpg algorithm is presented and its stability is proven in chapter 4 the path following control simulation tests are discussed and compared with the s plane control chapter 5 concludes the study 2 path following control system the design process of the path following controller is as follows first the desired velocity desired path and current position of the auv are considered as inputs of the system then the target instructions such as the target velocity heading angle pitch angle are solved in accordance with the path following strategy on the basis of the training experience the target commands are mapped to the control force required by auv movement the control force acts as an auv model and outputs the actual motion parameters the difference between them and the target instruction for the control system the control system regulates the difference value near 0 to achieve the path following goal the flow chart is shown in fig 1 on the basis of the above path following process design three tasks namely path following strategy design osam ddpg control algorithm design and training and auv fuzzy model construction must be completed 2 1 fuzzy model of auv the controller design requires an accurate mathematical model which directly affects control quality on the one hand an extremely complex mathematical model will complicate the control system and deteriorate the overall performance and is not conducive to engineering implementation on the other hand an extremely simple mathematical model cannot reflect the motion characteristics of the system and might decrease control precision therefore a suitable mathematical model is crucial in this work an auv controlled by rudders and a propeller is taken as the actual physical model as shown in fig 2 the auv is 1 46 m long and weighs 45 kg cfd is used to calculate the hydrodynamic coefficients of the auv to establish the dynamic model the coordinate system of the auv is divided into the geodetic and auv coordinate systems as shown in fig 3 the hydrodynamic formula of the auv is established as follow sun et al 2016 1 m v c v v d v v g η τ g 0 where m is the inertia coefficient matrix of the system that can satisfy μ m r b m a 0 m r b is the inertia matrix of the carrier that can satisfy m r b m r b t 0 and m r b 0 m a is the added mass coefficient matrix that can satisfy m a m a t 0 c v is the coriolis force coefficient matrix that can satisfy c a v c a t v d v is the viscous hydrodynamic coefficient matrix that can satisfy d v 0 x d v x t x 0 τ is the control input vector g 0 is the static load vector which is set to 0 to facilitate the study and g η is the restoring force torque vector the values of some hydrodynamic coefficients are shown in table 1 given the accuracy of the auv model and the fineness of meshing the hydrodynamic coefficient calculated by the cfd is not very accurate this result makes the learning experience not necessarily applicable to real auvs after using the osam ddpg algorithm to train the model therefore some important hydrodynamic coefficients are added with an error of 10 to blur the auv hydrodynamic parameters during the training process these hydrodynamic coefficients are randomly selected within a range of 10 error thus making the training experience universally applicable remark 1 compared with the training method of a fixed model this method solves the problem of the learning experience being inapplicable to real auvs because of the perturbation of the hydrodynamic coefficient compared with the model free training method it solves the limitation of high sample complexity and reduces the training time 2 2 path following strategy the auv planning system calculates the target instructions such as the target velocity and heading and sends them to the control system the control system controls the auv to navigate according to the target instructions to complete the path following task the planning system completes the calculation of the target instruction through the path following strategy the details are as follows on the horizontal plane the auv planning system uses formulas 2 and 3 to calculate the target heading angle 2 ψ ˆ ψ arctan y 2 y 1 x 2 x 1 x 1 x 2 ψ arctan y 2 y 1 x 2 x 1 π x 1 x 2 π 2 x 1 x 2 and y 1 y 2 π 2 x 1 x 2 and y 1 y 2 0 x 1 x 2 and y 1 y 2 formula 2 calculates the target heading angle in the process of point following ψ ˆ is the target heading angle ψ is the current heading angle x 1 y 1 is the current position of the auv in the geodetic coordinate system and x 2 y 2 is the first node coordinate of the auv in the geodetic coordinate system the calculation formula of the target heading in the straight following process is as follows 3 ψ ˆ ψ l e c 10 π 6 η in the straight path planning process l e c is the distance between the current position of the auv and the connection between the previous node and the current target node η is the angle between the line connecting the previous target point and the current target node and the horizontal axis in the curve path planning process l e c is the distance between the auv s current position and the tangent line of the curve η is the angle between the line connecting the current tangent point to the next step and the horizontal axis other target instructions are lateral vertical velocities and heel angle of auv v ˆ 0 ω ˆ 0 ϕ ˆ 0 during the path following on horizontal plane the target pitch angle is θ ˆ 0 during the path following on the vertical plane formulas 4 and 5 are used to calculate the target pitch angle 4 θ ˆ θ l e c 10 π 12 θ p where θ ˆ is the target pitch angle θ is the current pitch angle θ p is the angle between the target path and its horizontal projection 5 θ p arccos a b a b a δ x δ y δ z is the slope of the target path or the slope of the path tangent b δ x δ y 0 is the projection of vector a onto the horizontal plane where δ x δ y δ z are the error of position in the direction of the three dimensional coordinate 3 auv control strategy with osam ddpg 3 1 osam ddpg algorithm ddpg lillicrap et al 2016 is a deep reinforcement learning algorithm that combines actor critic peters and schaal 2008 and dqn mnih et al 2015 the concept is to apply the memory banks in the dqn structure and the idea of two neural networks with the same structure but different frequencies of parameter update on actor critic meanwhile the deterministic idea is used to change the method of random screening at the continuous motion interval with the original actor critic and only one motion value is produced at the continuous interval this study proposes the osam ddpg to solve the questions 3 and 4 mentioned in section1 3 1 1 average motion critic network the critic network in ddpg algorithm only evaluates the overall actions performance however there are 6 dof outputs which are coupled with each other in the control system of auv the critic network does not evaluate the actions in each dimension so the difference between the state value of the optimal and non optimal actions is small resulting in low learning efficiency of the algorithm this study proposes to establish the average motion critic network to solve this problem osam ddpg algorithm is divided into two parts main net and target net as shown in fig 4 each part includes an actornet and six criticnets the actornet outputs actions of 6 dof and the criticnet evaluates each action considering a standard reinforcement learning rl problem a finite markov decision process mdp which comprises a current state s t an action space a t a reward function r and the next state s t 1 is established take the absolute value of the difference between the actual motion state of auv and the target state as the system reward 6 r δ u δ v δ ω δ ϕ δ θ δ ψ where δ u u u ˆ δ v v v ˆ δ ω ω ω ˆ δ ϕ ϕ ϕ ˆ δ θ θ θ ˆ δ ψ ψ ψ ˆ extract data from the experience pool for learning input the 6 dof actions a t form s t a t r s t 1 into six critic networks of main net and each critic network calculates the value function of each action respectively by bellman equation 7 q π s t i a t i e r t s t 1 e r s t i a t i γ e a t 1 π q π s t 1 i a t 1 i where i is between 1 and 6 if the target policy is deterministic we can describe it as a function μ s a and avoid the inner expectation 8 q μ s t i a t i e r t s t 1 e r s t i a t i γ q μ s t 1 i μ s t 1 i get the average q value q s t a t 9 q μ s t a t 1 6 i 1 6 q μ s t i a t i according to q learning watkins and dayan 1992 considering function approximators parameterized by θ q the loss function is 10 l q r γ max a q s t 1 μ s t 1 θ q q s t a t θ q train the neural network to minimize the loss function so that the actual q value tends to the target q value on basis of policy gradient a parameterized actor function μ s θ μ which specifies the current policy by deterministically mapping states to a specific action is maintained the parameters of the motion estimation network are updated by following function 11 θ μ j 1 n t θ μ q s a θ q s s t a μ s t θ μ 1 n t a q s a θ q s s t a μ s t θ μ μ s θ μ s s t 3 1 2 optimize sample pools in ddpg algorithm the network samples randomly from the buffer for training the buffer is finite in size in which s t a t r s t 1 is stored and sampled randomly according to the exploration strategy however due to the limited of sampling space size and the general learning effect of samples in the early stage the learning rate will slow down in the later stage and the behavior cannot be significantly improved making the control range of the controller unstable therefore in the second stage of learning the sample space should be increased to get better samples so as to obtain more control experience before that the bisimulation is showed as following definition 1 the bisimulation givan et al 2003 if e s s is the relationship of bisimulation then for s 1 s 2 s 1 a a r s 1 a r s 2 a 2 a a c s e t c p t s 1 a t c p t s 2 a where the equivalent set of states s with respect to e is denoted by s e p t s 1 a represents the probability that the system takes an action a and moves to the next state at time t in the process of mdp if the two states satisfy the bisimulation relationship it can be denoted as s 1 s 2 lemma 1 bisimulation metric ferns et al 2004 d is defined as the set of metrics on the state set s and let d d for s 1 s 2 s define g d s 1 s 2 max a a d a s 1 s 2 γ t k d p s 1 a p s 2 a where 0 γ 1 d a s 1 s 2 r s 1 a r s 2 a t k d is the kantorovich metric gibbs and su 2002 which is defined by the following linear program max i 1 s i 1 s p s i q s i u i subject to i j u i u j d s i s j i 0 u i 1 on basis of the above questions this study constructed two sample spaces besides the original sample space d 0 namely high error sample space d 1 and diversity sample space d 2 in the space d 1 the temporal difference td error is used as the heuristic information to sort samples in the sample space so as to improve the probability of selecting samples with large error and the bisimulation measurement method is used to measure the distance between samples in d 2 during the algorithm learning process the training samples will be selected in proportion from the d 1 and the d 2 respectively so as to give consideration to the diversity and value of samples during the process of training the sample s t a t r s t 1 is put into d 0 td error of the action function is calculated as shown in formula 10 when the td error is larger than a threshold value it indicates that the sample has a great influence on the change of the action value function and it can be considered that the modified sample has high value thus the sample is put in d 1 when the samples in d 1 are sufficient the training samples are not only selected from d 0 but from d 0 and d 1 respectively in a certain proportion meanwhile algorithm 1 is used to calculate the distance between samples in d 0 low similarity samples are put into d 2 to ensure the diversity of selected samples after that samples from d 1 and d 2 are selected respectively in a certain proportion for learning the distance between samples is calculated by algorithm 1 the larger the distance the lower the similarity of samples algorithm 1 distance measurement algorithm between states remark 2 compared with the traditional ddpg algorithm osam ddpg selects samples from the diversity sample pool and the high error sample pool respectively in proportion so as to improve the utilization efficiency of samples and the convergence performance of the algorithm in addition osam ddpg algorithm adopts the way of multiple critic networks to improve the difference between actions so as to improve the efficiency of the algorithm 3 2 osam ddpg controller the idea of the osam ddpg controller is that the action in the reinforcement learning barto 1998 algorithm corresponds to the thrust and torque of the auv and the state in the algorithm corresponds to the velocity and angular velocity of the auv the algorithm is learned to realize the mapping relationship between force and state the application of osam ddpg in auv control requires the establishment of a critic q s t a t θ q and an actor μ s t θ μ neural network structure θ q and θ μ are the weight parameters of the network two neural networks namely the target and prediction networks are created in each of the structures then the output of osam ddpg is regarded as the force τ of the control system which regulates the movement of the auv the osam ddpg control system can be regarded as a mapping from the current auv state to the force combined with function a μ s t θ μ the force can be expressed as 12 τ μ s t θ μ the auv s states is mainly reflected in velocity and attitude angles 13 v u v ω ψ ϕ θ ψ where u v ω are the longitudinal lateral and vertical velocities of the auv ϕ θ ψ are the heel pitch and heading angles of auv therefore 14 τ μ s t μ v t ψ t formula 14 indicates the osam ddpg controller whose inputs are velocities and attitude angles of the auv and whose outputs are the control forces in accordance with the parameter update formula of the osam ddpg algorithm the above mapping relationship is completed and the weight coefficients of neural networks are updated remark 3 at present research on ddpg based tracking control is based on path design in physical environment such as article 16 and article 17 making the training strategy only applicable to the current environment in this study the auv dynamics model is regarded as an environmental to design controller it is not limited to a single environment the auv only needs to be trained once and the control strategy obtained is suitable for most underwater environments 3 3 stability analysis this section proves the stability of the osam ddpg control system before analyzing the stability some assumptions are introduced following assumption 1 the computer cpu computation speed is much faster than the environment state transition speed s t t θ μ t assumption 2 according to the movement law of auvs when the auv state velocity or heading is less than the target state positive force action acceleration is required when the auv state velocity or heading is greater than the target state a counteracting force action is required to decelerate when s t s t 0 a t 0 when s t s t 0 a t 0 lemma 2 asymptotic stability chiang and thorp 2010 let d r n be a region containing the origin f x be the system defined on d and f 0 0 for system x f x if there is a continuous differentiable positive definite function v x such that v x is negative then the system is asymptotic stability lim t x t t 0 x 0 x e 0 theorem 1 consider system 1 the controller 14 and the iterative strategy 10 and 11 under the assumption 1 and 2 according to lemma 2 auv dynamic system can be stabilized when it reaches the target state under any initial condition and the tracking error converges to 0 proof from the dynamic formula of auv and the mapping of the osam ddpg algorithm from action to state formulas 1 and 12 the following formula can be obtained 15 m s t c s t s t d s t s t g η τ μ s t θ μ where d s t is not a singular matrix and the matrix is invertible b s t is set to be the d s t 1 so 16 s t b s t μ s t θ μ m s t c s t s t g η generally the auv is in the neutral state that is its own gravity and buoyancy are equal meanwhile the center of gravity of the auv coincides with the center of buoyancy therefore the g term is omitted taking the derivative with respect to t 17 d s t d t b s t s t s t t g 1 b s t g 2 where 18 g 1 μ s t θ μ m s t c s t s t g η 19 g 2 μ s t θ μ s t s t t μ s t θ μ θ μ θ μ t m s t t c s t s t s t t c s t s t t according to assumption 1 s t t θ μ t thus s t t is ignored 20 d s t d t b s t μ s t θ μ θ μ t the stability of the osam ddpg control system is proven by the lyapunov theorem park sanghyuk et al 2007 the positive definite function is established as 21 v s t 1 2 s t s t 2 and differentiated as 22 d v d t s t s t d s t d t s t s t b s t μ s t θ μ θ μ t since actor function q is a cumulative function of time its partial derivative with respect to t is greater than 0 23 q s a θ q t q s a θ q s s t q s a θ q a μ s θ μ θ μ θ μ t q s a θ q a μ s θ μ θ μ θ μ t α 0 substitute formula 23 into formula 22 24 d v d t s t s t b s t α a q s t a θ q according to formula 10 25 ς l q 2 r s t a t γ 1 q s t a t θ q 2 which is differentiated 26 ς a t 2 r s t a t γ 1 q s t a t θ q h where 27 h r s t a t a t γ 1 q s t a t θ q a t given that the loss function has a minimum ς a t can be 0 thus 28 r s t a t a t 1 γ q s t a t θ q a t in combination with formula 24 29 d v d t s t s t b s t α 1 γ r s t a t a t in accordance with the reward value obtained by the auv s action the reward value function is established as follows 30 r s t a t λ s a t s t λ a t 2 t s t where λ is a positive coefficient therefore 31 v t s t s t b s t α 1 γ 2 a t t λ s t s t a t ϒ where ϒ b s t α 1 γ 2 t λ in formula 31 α 0 λ 0 1 γ 0 b s t d s t 1 and d s t is the viscous hydrodynamic coefficient matrix that is d s t 0 x d s t x t x 0 thus ϒ 0 according to assumption 2 when s t s t 0 a t 0 when s t s t 0 a t 0 therefore v s t 0 and it is negative definite by the lyapunov theorem auv dynamic system can be stabilized when it reaches the target state under any initial condition the system is stable since v s t is positive definite and v s t is negative definite according to the lemma 2 the system is asymptotically stable so tracking error of the system converges to 0 3 4 simulation training the osam ddpg algorithm is used as the controller of the auv path following system the states and the differences between the current and target states of the auv are taken as the inputs and the outputs are the thrust and steering moment the system randomly generates the target states the auv s velocities and attitude angles are obtained using the outputs of the algorithm to push the auv dynamic model the errors are obtained by comparing with the target states and the training system makes the navigation error of the auv approach 0 in addition the horizontal interference force is generated randomly during system training and the range of interference force is 500 500 n such that the control system obtained a certain anti interference ability the controller training process is as follows algorithm 2 the controller training process auv control simulation system was built according to algorithm 2 and then ddpg and osam ddpg algorithms were used to train auv control the results are shown in fig 5 the abscissa represents the episodes of training whereas the ordinate represents the total reward of each episode a total of 10 000 episodes are created during simulation training each training episode is updated with 500 steps although the learning curves of both osam ddpg and ddpg algorithm converges to a satisfactory value the learning process of osam ddpg performs more stable and it can be seen form fig 5 that osam ddpg is more effective than conventional ddpg the control range of velocity 0 m s to 1 m s the control range of heading angle 180 180 and the control range of pitch angle 45 45 can be obtained through training fig 5 shows that when the reward value converges to 40 60 the training is successful remark 4 note that the training that rewards excessively or poorly is a failure the auv gains a positive reward when it reaches the target state but is only successful when it maintains the motion state in the target state for 50 steps therefore if the auv fails to reach the target state then the reward value will be very small when the auv reaches the target state intermittently the reward value will be large but is not considered successful 4 simulation experiments the auv dynamics kinematics and visual environment models are established and the osam ddpg controller is trained after the training the optimal control strategy is obtained and the velocity heading and pitch of the auv can be controlled by the controller then the simulation results of the s plane controller are compared the simulation experiments of the linear circular and curve paths are completed by using the path following strategy 4 1 comparison of osam ddpg and s plane control s plane control sun et al 2013 learns from the pid method based on fuzzy control fig 6 is the control surface of the s plane method which expresses the relationship between deviation deviation rate and control force the algorithm is expressed as follows 32 u i 2 0 1 0 exp k i 1 e i k i 2 e i 1 0 δ u i f i k i u i where i is the i degree of freedom e i and e i are the control error and its derivative u i is the object of control k i1 and k i2 are the control parameters f i is the control force k i is the maximum force or torque δ u i corresponds to the magnitude of the interference force the s plane and osam ddpg control methods are used to control auv navigation at a constant velocity of 0 8 m s and a heading angle of π 12 at the horizontal plane with constant instantaneous and periodic interference in different stages simulation test results are shown in fig 7 during the first stage of auv navigation a lateral 3000 n sudden force is applied at 250 s and the duration is 10s table 2 shows the mean absolute error mae and maximum absolute error maxe of auv s velocities and heading angles under the control of two methods results indicate that the velocity and heading of the auv under the control of s plane and osam ddpg are greatly deviated when instantaneous force is applied after the force disappears the auv under both controllers can be restored to target command navigation however the auv s movement errors under osam ddpg controller are smaller than that under s plane controller the osam ddpg controller can control auv stability to the target instruction during interference although the auv cannot directly return to the target state due to the extremely large instantaneous interference force offset can be minimized after disturbance force disappears the auv quickly returns to the target state in the second stage of auv navigation process the force of 300 n in the direction of e η in the geodetic coordinate system is added table 3 shows the mae and maxe of auv s velocities and heading angles under the control of two methods test results show that the s plane and osam ddpg controllers have a certain deviation in velocity following however according to table 3 the max velocity deviation of the osam ddpg controller is obviously smaller than that of the s plane controller in terms of heading following the s plane controller controls the heading of the auv with obvious oscillation the heading errors of the auv approaches 0 in the osam ddpg controller during the third stage of auv navigation a periodic interference of 300 sin 0 01 π t n is applied table 4 shows the mae and maxe of auv s velocities and heading angles under the control of two methods experimental results show that the osam ddpg control effect is obviously better than that of the s plane according to table 4 and fig 7 under the control of the osam ddpg controller the velocity and heading oscillations of the auv are obviously smaller and the auv can navigate well according to the target instructions the above simulation test indicates that under the condition of unchanged parameters the control effect of the osam ddpg controller in the case of various disturbances is obviously better than that of the s plane controller 4 2 the path following in horizontal plane the comb scan circular and curve paths were established in the simulation environment to realize the various path following the comb scan path nodes were 10 50 10 350 150 350 150 50 300 50 300 350 450 350 450 50 the initial point of the auv was 0 0 the initial velocity was 0 m s and the target velocity was 0 8 m s during auv navigation the external force of 150n in the e η direction in the geodetic coordinate system was applied the results are shown in fig 8 table 5 shows the mae and maxe of auv s velocities heading angles and following errors of the comb path following after 500s results show that under the action of additional constant interference force the auv s velocity and heading fluctuate to some extent during navigation but can still track the target path well although the velocity of the auv would fluctuate slightly during turning so that the auv would deviate from the target path the maxe is 12 6116m due to the influence of rudder force the osam ddpg can quickly control the auv recovery to the target path the control errors are within a reasonable range the circular path was established with the center at 300 200 and a diameter of 100m the initial point of the auv was 50 350 the initial velocity was 0 m s and the target velocity was 0 8 m s during auv navigation an instantaneous force of 5000 n was applied at 1100s and the duration was 15s the results are shown in fig 9 table 6 shows the mae and maxe of auv s velocities heading angles and following errors of the circular path following after 750s results show that the auv can track the circular target path well with the osam ddpg controller under the action of large instantaneous disturbance force the auv will deviate from the path the maxe is 3 8928m and the motion parameters will be offset accordingly however after the force disappears the auv can quickly recover to the target command and target path the control errors are within a reasonable range the curve path s function was y 50 sin 0 02 x 200 150 x 450 the initial point of the auv was 50 350 the initial velocity was 0 m s and the target velocity was 0 8 m s the cyclic force of f 300 sin 0 01 π t was applied the results are shown in fig 10 table 7 shows the mae and maxe of auv s velocities heading angles and following errors of the curve path following after 500s results indicate that the auv can track the curve path with the control of the osam ddpg controller the motion states of the auv will oscillate near the target instruction influenced by periodic interference force as shown in table 7 and fig 10 but the amplitude of oscillation is acceptable according to the above simulation test when auv navigates in the horizontal plane osam ddpg can control auv to achieve straight or curve path tracking well and the controller can control the auv to resist different interferences 4 3 3d path following a 3d environment model was established and the 3d path following simulation test was performed a 3d straight target path was established in the simulation environment 33 x 100 5 k y 150 2 k z 200 6 k 0 k 100 the initial point of the auv was 100 100 100 the initial velocity was 0 m s and the target velocity was 0 8 m s the results are shown in fig 11 table 8 shows the mae and maxe of auv s velocities heading angles pitch angles and following errors of the 3d straight path following after 750s results show that when the 2d path is extended to 3d the osam ddpg controller can also control the auv s straight path following well the auv s velocity heading angle and pitch angle can achieve the target command quickly the control errors are within a reasonable range given that the following strategy is toward the target path the auv can track the target straight smoothly the 3d curve path was established in the simulation environment and the path curve function was 34 x 100 cos k y 100 sin k z 100 k 0 k 6 π the initial point of the auv was 0 0 0 the initial velocity was 0 m s and the target velocity was 0 8 m s the results are shown in fig 12 table 9 shows the mae and maxe of auv s velocities heading angles pitch angles and following errors of the 3d curve path following after 1500s results indicate that the osam ddpg control algorithm performs well in the 3d path curve following under the following strategy and the control algorithm the auv can gradually approach the target path and then track the target path the max following error is 0 4m the following error in fig 12e increases initially because the auv must adjust the heading in the initial stage to achieve the effect of approaching the target path simulation test results indicate that the controller designed in this study can control the velocity heading and pitch angle of the auv simultaneously and can control the auv well to achieve the target command the controller can be applied to the underwater 3d motion of auvs 5 conclusion in this study osam ddpg algorithm is proposed to realize the auv path following control simulation training indicates that the osam ddpg is more effective than conventional ddpg the dynamical model of auvs is taken as the environment and the mapping relationship between force and state is trained the algorithm can be applied to all kinds of tasks with the experience gained from only one successful training simulation test results indicate that the anti interference ability of the osam ddpg controller is better than that of the s plane controller compared with other controllers mentioned in this paper the proposed control algorithm does not require an accurate model of auv the control stability and robustness of auv are improved by learning and training at the same time interference is considered in the training process which improves the anti interference ability of the controller credit authorship contribution statement yushan sun data curation funding acquisition resources xiangrui ran formal analysis methodology writing original draft writing review editing guocheng zhang conceptualization data curation software xiangbin wang software hao xu software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the work was supported in part by the china national natural science foundation nos 51779057 51709061 the equipment pre research project project number 41412030201 
21741,the existing stress field evaluation formulas for v shaped and u shaped notches are complicated and limited to certain specific opening angles based on linear elastic fracture mechanics and singular strength theory the traditional calculation formula of notch stress distribution is simplified by introducing singular intensity factors and the notch stress formula suitable for different opening angles is further summarized and fitted by comparing the stress distribution laws from 102 to 150 opening angles after verification the relative error of stress between the simple formula and finite element results is about 5 on this basis the formula of notch stress intensity factor n sif under different opening angles is further derived finally the notch stress and n sif of cruciform welded specimens under different welding angles are separately calculated for fatigue strength evaluation the evaluation process shows that the simplified formula can be used to quickly and accurately evaluate the notch stress field and fatigue strength of welded structures keywords different opening angle notch stress welded joint fatigue strength 1 introduction the stress concentration effect at corners will seriously affect the working performance of welded structures the plasticity and toughness of the welding area will be greatly reduced and fatigue cracks will be initiated at corners for large welded structures such as ships bridges and offshore platforms various t shaped welded joints and cruciform welded joints have been widely used to comprehensively meet the requirements of structural safety stability and economy as shown in fig 1 stress concentration will inevitably occur at the welding corners which will lead to the initiation and propagation of fatigue cracks and eventually make the whole structure failure see fig 2 due to the stress singularity effect at the notch some simple methods such as nominal stress and hot spot stress methods are recommended in relevant codes eurocode 3 1993 hobbacher 2009 for guiding fatigue assessment of welded structures however nominal stress and hot spot stress ignore the influence of geometry size on welded structures which will lead to a larger dispersion result and is not conducive to accurate evaluation of fatigue strength the local stress methods such as notch stress method notch stress intensity factor method k n method strain energy density method w n method and peak stress method psm can obtain more accurate fatigue evaluation results by comprehensively considering the influence of local geometry size and load condition of welded structures livieri and lazzarin 2005 meneghetti and lazzarin 2011 pakandam and varvanifarahani 2011 karakaş et al 2018 however the description and calculation of notch stress distribution is the premise for fatigue evaluation of notch specimens by using local stress methods the theoretical researches on the notch stress distribution at the corner had been continuously carried out based on the linear elastic stress strain field analysis of notch specimens and considering different opening angles williams 1952 obtained the stress distribution formula near the notch expressed by the coefficient a i in order to make the coefficient a i in williams formula have definite physical meaning gross and mendelson 1972 extended the definition of stress intensity factor commonly used to describe stress field at crack tip to different opening angles and obtained the notch stress distribution formula by notch stress intensity factor n sif however due to the severe stress concentration at the v notch arc transition was usually adopted to improve the v notch into a u notch in engineering thus reducing the influence of the change of the opening angle on the stress concentration based on gross s v notch formula considering different opening angles lazzarin and tovo 1996 obtained the stress field distribution formula near the u notch based on the plane stress strain assumption and fitted the n sif value corresponding to 135 by finite element calculation method in the following researches by introducing singular intensity factors xu and barltrop 2006 and shen et al 2015 simplified lazzarin s formula and obtained a more accurate and simpler calculation formula for 135 lee et al 2009 analyzed the influence of different welding geometry sizes on the fatigue performance of the specimens through the experimental data of the cruciform welded specimens with the opening angle of 90 152 the results show that the fatigue life of the specimens increases with the increase of the opening angle and the virtual radius at the weld toe ngoula et al 2017 carried out numerical analysis on cruciform welded specimens with different opening angles by finite element method and got the same conclusion as lee et al 2009 song et al 2018 based on lazzarin s formula and finite element method quantified the stress field near the notch into the total energy value and proposed a new fatigue evaluation method to evaluate the fatigue of cruciform specimens with different opening angles however the above mentioned fitting formulas have certain limitations and cannot describe the stress distribution around the notch with different opening angles accurately therefore for different opening angles based on lazzarin s formula filippi et al 2002 and singular intensity theory shen et al 2016 this paper first carried out a series of finite element analysis on v shaped and u shaped notches with 135 opening angle fitting to obtain a simple calculation formula of stress distribution on the bisection of 135 the calculation results based on the simplified formula were compared with the finite element calculation results and lazzarin s formula results to verify the accuracy on this basis the stress distributions on the bisector of v shaped and u shaped notch with opening angles of 102 150 were compared and quantified systematically thereby the simple calculation formula of notch stress of 135 was extended to the case of different opening angles considering different opening angles the notch stress method and notch stress intensity factor method based on the simplified formula were used to evaluate the fatigue strength of welded specimens under different welding corners respectively after a series of verification the simple stress formula and the derived n sif formula can be conveniently applied to the notch stress assessment and fatigue strength assessment under different opening angles in engineering 2 theoretical analysis of notch stress 2 1 traditional formula williams 1952 concluded that the stress field near the tip of the v notch is singular and the notch stress can be divided into mode i open type and mode ii stress slip type see fig 3 a when the opening angle 2 α is greater than 102 the mode ii stress will no longer show singularity and the mode i stress component opening type will be dominated which can be used as the main parameter for fatigue evaluation of welded specimens lazzarin et al 2003 mode i stress can be express as 1 σ θθ σ rr τ r θ λ 1 r λ 1 1 a 1 f 1 θθ θ f 1 rr θ f 1 θ θ where r is the distance to the corner a 1 is the coefficient related to specimen size f 1 ij θ is the stress function in appendix a 1 gross and mendelson 1972 extended the definition of n sif value used to describe crack stress field to v notch and obtained the stress field formula near v notch mode i 2 σ θθ σ rr τ r θ ρ 0 1 2 π r λ 1 1 k 1 1 λ 1 χ b 1 1 λ 1 1 λ 1 cos 1 λ 1 θ 3 λ 1 cos 1 λ 1 θ 1 λ 1 sin 1 λ 1 θ χ b 1 1 λ 1 cos 1 λ 1 θ cos 1 λ 1 θ sin 1 λ 1 θ where k 1 is the n sif value defined by lazzarin and tovo 1996 k 1 σ 0 k 1 t 1 λ i k 1 is a function of h t l for the u shaped notch shown in fig 3b filippi et al 2002 modified gross and mendelson formulas on the premise of maintaining the original formula form of stress field for the v notch and obtained the following formula for calculating the stress field near the u notch mode i 3 σ θθ σ rr τ r θθ ρ 0 σ θθ σ rr τ r θ ρ 0 1 2 π k 1 r 0 1 λ 1 r r 0 μ 1 1 q 4 1 q 1 λ 1 χ b 1 1 λ 1 χ d 1 1 μ 1 cos 1 μ 1 θ 3 μ 1 cos 1 μ 1 θ 1 μ 1 sin 1 μ 1 θ χ c 1 cos 1 μ 1 θ cos 1 μ 1 θ sin 1 μ 1 θ where r 0 q 1 ρ q λ 1 μ 1 χ b 1 χ c 1 and χ d 1 are parameters related to the opening angle see appendix a 2 2 2 simplified u notch stress formula as shown in fig 4 for any opening angle 2 α on the bisector of the notch angle θ 0 the shear stress component of mode i stress τ r θ is 0 and the normal stress component σ θθ can be expressed as v shaped notch 4 σ θθ ρ 0 1 2 π r λ 1 1 k 1 1 λ 1 χ b 1 1 λ 1 1 λ 1 χ b 1 1 λ 1 and for u shaped notch 5 σ θθ ρ 0 σ θθ ρ 0 1 2 π k 1 r 0 1 λ 1 r r 0 μ 1 1 q 4 1 q 1 λ 1 χ b 1 1 λ 1 χ d 1 1 μ 1 χ c 1 for a given opening angle 2 α the parameters λ 1 q χ b 1 χ c 1 and χ d 1 are constant see appendix a table a1 and eq 4 can be further simplified as 6 σ θθ σ 0 2 π 1 r p 1 f 1 h t l 1 p 1 t p 1 for u shaped notch eq 5 can be expressed as 7 σ θθ σ 0 2 π 1 r p 1 f 1 h t l 1 p 1 t p 1 σ 0 2 π 1 r 0 p 1 n 1 1 r n 1 c 1 α f 1 h t l 1 n 1 t p 1 n 1 n 1 where f 1 h t l k 1 is a dimensionless parameter related to the geometric dimensions h t l p 1 1 λ 1 n 1 1 μ 1 and 8 c 1 α q χ d 1 1 μ 1 χ c 1 4 q 1 1 λ 1 χ b 1 1 λ 1 1 n 1 in order to simplify the parameters f 1 h t l 1 p 1 t and c 1 α f 1 h t l 1 n 1 t p 1 n 1 referring to the analysis of 135 notch stress field by shen et al 2016 the new parameters a s 1 and b s 1 were introduced to describe the stress field on the notch bisector 9 σ θθ σ 0 2 a s 1 r p 1 and for u shaped notch 10 σ θθ σ 0 2 a s 1 r p 1 σ 0 2 1 r 00 p 1 n 1 b s 1 r n 1 where a s 1 1 π 1 p 1 f 1 h t l 1 p 1 t and b s 1 1 π 1 n 1 c 1 α f 1 h t l 1 n 1 t p 1 n 1 a s 1 and b s 1 are equivalent parameters defined by comprehensively considering the influence of structural geometry size on notch stress field which are also length parameters used to characterize singularity at the notch 3 numerical analysis and verification 3 1 cruciform model the above simplified formulas eqs 9 and 10 show that for any opening angle the distribution of stress field near the notch can be obtained by knowing the corresponding values of a s 1 and b s 1 in order to determine the relationship between parameter a s 1 b s 1 and geometric dimensions h t l the notch stress of 135 cruciform models under different geometric sizes were modeled and calculated by software ansys 0 l t 6 0 and 0 2 h t 12 see table 1 on this basis numerical analysis was carried out on the notched specimens with opening angles of 102 110 120 and 150 respectively to determine the relationship between stress distribution and opening angles and the stress distribution formulas suitable for different opening angles were further obtained the elastic modulus is e 2 06 10 5 mpa and poisson s ratio is μ 0 3 as all the models are thick plates with thickness t 5 mm according to iiw hobbacher 2009 specification the virtual radius of u notch is taken as 1 mm uniformly 3 2 fe model considering the symmetry of loading and structure based on plane strain assumption plane 182 element was adopted to establish the fe model see fig 5 a series of v shaped and u shaped notch models with different geometric sizes were respectively considered in fig 6 in order to improve the calculation accuracy quadrilateral elements were adopted and the mesh was refined at the corner the mesh convergence analysis on v shaped notch was carried out in fig 7 when the mesh at the corner is reduced to 0 2 mm the change trend of stress field near the notch will not change further in order to ensure sufficient calculation accuracy the minimum mesh size at the corner is taken as 0 1 mm 3 3 formula fitting 3 3 1 simplified formula for 2 α 135 considering that 135 welded corner is the most widely used welded specimen in engineering the stress distributions at the corner are obtained by establishing a series of finite element models of 135 welded specimens with different geometric sizes combined with the simple formulas 9 10 the values of a s 1 and b s 1 under different geometric models are obtained by fitting the fitting results are shown in appendix b table b1 the calculation formulas of a s 1 and b s 1 for 2 α 135 are further fitted out in fig 8 as can be seen from fig 8a a s 1 is a linear function of the width of attachment plate l and can be expressed by two approximate functions the minimum value of which is closer to the numerical results the fitting formula can be expressed as 11 a s 1 min 0 1 l t h 0 1 0 28 h 0 1 t t h 0 9 0 02 l t h 0 35 h 0 1 t t h 0 9 as to b s 1 it can be seen from appendix b table b1 that when the width of attachment plate l changes the value of singular intensity factor b s 1 hardly changes it can be considered that the singular intensity factor b s 1 is only related to the plate thickness t and the height of the bracket h and the relationship between the singular intensity factor b s 1 and h is plotted as shown in fig 8b 12 b s 1 0 2 h 0 18 t 0 3 the fitting values of the formula are compared with the numerical results in fig 9 as shown in fig 9a the error of the fitting formula can be effectively reduced by taking the minimum value of the characteristic value in eq 11 similarly the results of statistical analysis show that the ratios of the calculated values from formula 12 to the fitting results are mostly around 1 which verifies the validity of the formula 12 after parameters a s 1 and b s 1 are determined the stress field distribution on the bisector of 135 v and u shaped notch angle can be obtained according to equations 9 and 10 respectively however for other opening angles the corresponding model needs to be rebuilt to obtain the notch stress distribution 3 3 2 simplified formula for other opening angles in order to obtain the stress distribution on the notch bisector under different opening angles the models with opening angles of 102 110 120 and 150 were numerically analyzed respectively and the calculated results are compared with the results of 2 α 135 as shown in figs 10 11 according to the stress comparison results it is concluded that 1 compared with the reference angle 135 the stress distributions on the bisector of the v notch and u notch angles have the same change trend and the stress curves are approximately linear in logarithmic coordinates 2 for different opening angles the change rules of stress distribution on the bisector of v notch and u notch are consistent when the distance r is small the stress field results tend to be consistent for 135 and 120 but larger than those of other angles however with the increase of r when r is approximately 1 mm the larger the opening angle is the larger the stress result is based on eqs 2 and 13 it can be seen that the normal stress component σ θθ on the notch bisector is related to the distance r the geometric size of the specimen and the opening angle 2 α for the notched specimens with certain geometric dimensions the notch stress intensity factor k 1 is constant and the stress distribution of σ θθ is determined by distance parameter r and opening angle 2 α as shown in eq 13 if the term containing r in eq 13 is moved to the left it can be found from eq 14 that the product of the stress component σ θθ and r 1 λ 1 is only a function of the opening angle therefore based on the stress field on the 135 opening angle deduced in this paper the relationship between the stress distribution under the other opening angles and 135 opening angle can be expressed by eq 15 13 σ θθ 1 2 π r λ 1 1 k 1 1 λ 1 χ b 1 1 λ 1 1 λ 1 cos 1 λ 1 θ χ b 1 1 λ 1 cos 1 λ 1 θ 14 σ θθ r 1 λ 1 1 2 π k 1 1 λ 1 χ b 1 1 λ 1 1 λ 1 cos 1 λ 1 θ χ b 1 1 λ 1 cos 1 λ 1 θ 15 σ θθ 2 α r 1 λ 1 2 α γ 2 α σ θθ 135 r 1 λ 1 135 where σ θθ 2 α is the stress result when the opening angle is 2α λ 1 2 α is the λ 1 value when the opening angle is 2α for 2 α 135 the stress result is σ θ θ 135 and the eigenvalue is λ 1 135 0 674 γ 2 α is a complex function of incision opening angle when the stress results at different opening angles are converted to 135 according to equation 15 the stress results are reanalyzed in fig 12 in the double logarithmic coordinate system after multiplying by the correction coefficient r λ 1 135 λ 1 2 α the stress curves between different opening angles are parallel to each other which means that the curves can be transformed to each other by translation after comparison it is found that the stress on the bisector of the incision angle has the maximum value with the opening angle 135 when 2 α 135 the stress value decreases with the decrease of the opening angle when 2 α 135 the stress value decreases with the increase of the opening angle the transformation between different stress curves needs to be multiplied by a coefficient related to the opening angle on the basis of 135 16 σ θθ 2 α σ θθ 135 r λ 1 0 674 cos 2 α 135 the angle correction coefficient γ 2 α is cos 2 α 135 which is always less than or equal to 1 and the correction value is consistent with the change trend of stress results shown in fig 11 the stress comparison at different opening angles after considering the distance correction coefficient and the angle correction coefficient is shown in fig 13 it is found that the stress results at different opening angles after correction are very similar combined with the simplified 135 opening angle formula the stress formula on the notch bisector under different opening angles can be expressed as follows v shaped notch 17 σ θθ 2 α σ 0 2 r λ 1 0 674 cos 2 α 135 a s 1 r p 1 and for u shaped notch 18 σ θθ 2 α σ 0 2 r λ 1 0 674 cos 2 α 135 a s 1 r p 1 1 r 0 p 1 n 1 b s 1 r n 1 4 formula verification lazzarin et al 2003 presented an approximate formula for calculating the stress field near the v notch in order to verify the accuracy of the formula a s 1 and b s 1 proposed in this paper the finite element results and lazzarin formula calculation results can be used for comparison when 2 α 135 θ 0 lazzarin formula can be expressed as for v shaped notch 19a σ θθ r λ 1 1 σ 0 t 1 λ 1 k 1 2 π 1 λ 1 χ b 1 1 λ 1 1 λ 1 χ b 1 1 λ 1 and for u shaped notch 19b σ θθ r λ 1 1 σ 0 t 1 λ 1 k 1 2 π 1 λ 1 χ b 1 1 λ 1 1 λ 1 χ b 1 1 λ 1 q 4 q 1 r r 0 μ 1 λ 1 χ d 1 1 μ 1 χ c 1 for cruciform members under tensile loading 20 k 1 1 212 0 495 e 0 985 2 h t l 1 259 e 1 120 2 h t 0 485 l t the parameter definition in the formula above is shown in fig 3 and the applicable scope is 0 l t 3 0 and 0 25 2 h t 2 5 since the above formula is also only applicable to 135 notch stress assessment the above formula should be extended to other angles by combining distance correction r λ 1 0 674 and angle correction cos 2 α 135 the stress field distributions at the corners under different opening angles obtained by the three methods are compared in figs 14 18 for convenience of comparison taking the fine finite element results as reference values the relative error formula is defined as follows 21 δ σ formula σ fe σ fe 100 where δ is the relative error value σ formula and σ fe are the stress results calculated by formula and finite element respectively mpa as shown in figs 14 18 with the increase of distance r the normal stress component σ θθ gradually decreases and the stress curve is approximately linear in logarithmic coordinates it is concluded that when the opening angle is between 102 and 150 the stress results predicted by eqs 17 and 18 are close to the results of finite element results taking the fe results as reference values the relative errors of the stress results of the simple method and lazzarin formula are also analyzed in fig 19 compared with the fe results the relative error of stress results of lazzarin formula is within 10 while the maximum relative error with formula a s 1 and b s 1 will not exceed 8 except for a few stress points the relative error of most stress points with the simple formula is within 5 5 fatigue strength analysis 5 1 nominal stress assessment to validate the proposed methods above the fatigue strength of 14 groups of steel cruciform welded structures under tensile load were collected and reanalyzed as shown in appendix c the experimental data included three different stress ratios r 1 r 0 and r 0 3 in order to obtain more rigorous and reliable results the experimental data under different stress ratios need to be converted to the condition of stress ratio r 0 according to the average stress conversion curve shown in fig 20 first sonsino 2009 coefficient f i is the ratio of nominal stress amplitude under different stress ratios and m i is the mean stress sensitivity parameter 22 f 1 σ a r 1 σ a r 0 f 2 σ a r 0 σ a r 0 5 a n d f 3 σ a r 1 σ a r 0 5 23 m 1 σ a r 1 σ a r 0 1 a n d m 2 σ a r 0 σ a r 0 5 1 as shown in fig 20 σ a is the nominal stress amplitude and σ m is the mean stress the stress correction is realized by multiplying the correction coefficient f i moreover from the experimental data in appendix c table c1 it can be seen that the experimental data have obvious thickness effect with the increase of plate thickness the fatigue strength of the cruciform specimen decreases instead when using s n method to evaluate the fatigue strength of welded specimen the influence of thickness effect should also be considered according to the recommendations of the british department of energy british standards institution 1993 the thickness effect correction formula was given for welded specimens with plate thickness greater than 22 mm 24 s s b t b t eff k where s b and s are the fatigue strengths before and after correction k is the thickness correction exponent t b is the reference maximum thickness and t eff is the effective thickness the nominal stress s n curve of cruciform specimens after considering the conversion of different stress ratios and thickness effects was redrawn as shown in fig 21 the formula of the nominal stress s n curve in survival rate p s 50 is 25 log n 14 14 3 81 log s the inverse slope m of the s n curve is 3 811 which is close to the recommended value of 3 in the specification iiw hobbacher 2009 the fatigue strength corresponding to n ref 5 10 6 cycles is 89 96 mpa and the scatter band index t σ t σ σ ps 2 3 σ ps 97 7 is 2 13 5 2 notch stress assessment in order to consider the influence of welding geometry this paper re evaluated the fatigue strength of cruciform welded specimens above by using notch stress method as the thickness of the welded specimens used in this paper are all greater than 5 mm the virtual radius is uniformly taken as 1 mm when fatigue assessment is carried out by the notch stress method as recommended by iiw hobbacher 2009 according to formula 18 u notch stress can be obtained for the welded joints with virtual radius ρ f 1 mm under different opening angles similarly considering the correction of different stress ratios and thickness effects the notch stress s n curve of the cruciform specimens with different opening angles is plotted in fig 22 26 log n 15 53 3 70 log s as shown in fig 22 the stress range δ σ corresponding to n ref 5 10 6 cycles is 245 4 mpa compared with the evaluation results of nominal stress the scatter band index t σ is reduced from 2 13 to 1 62 5 3 n sif assessment because the notch stress intensity factor takes into account the influence of scale effect when it is defined it is recommended to be used for fatigue strength evaluation of welded specimens under different geometric scales as shown in fig 23 under the same surface stress the stress gradient of the thin plate will be larger which means that the stress of the thick plate will be larger at the same distance from the weld toe under the assumption of linear elasticity considering the same elastic properties the stress fields are similar 27 σ θ b x σ θ a x d where d is the scale ratio taking notch stress intensity factor k 1 as an example k 1 b 2 π lim r 0 σ θ b r r 1 λ 1 2 π lim r 0 σ θ a r d r 1 λ 1 28 2 π lim r 0 σ θ a r d d 1 λ 1 d 1 λ 1 r 1 λ 1 assuming r r d 29 k 1 b 2 π lim r 0 σ θ a r r 1 λ 1 d 1 λ 1 then 30 k 1 b d 1 λ 1 k 1 a the above formula shows that the solution of notch stress intensity factor for large scale specimens can be based on the solution of small scale thus effectively solving the influence of scale effect on fatigue assessment of thin plate structures since the formula 30 already includes the geometric parameter d reflecting scale effect the thickness effect correction need not be considered for n sif assessment for u notch specimens considering the virtual radius at the notch the relationship between notch stress intensity factor n sif and the maximum circumferential stress σ θθ on the bisector of u notch angle is obtained as follows lazzarin et al 2003 31 k 1 σ max 2 π r 0 1 λ 1 1 1 μ 1 χ d 1 χ c 1 1 λ 1 χ b 1 1 λ 1 q 4 q 1 where σ max is the maximum circumferential stress on the bisector of the u shaped notch λ 1 q χ b 1 χ c 1 and χ d 1 are parameters related to opening angle 2 α eq 31 can be further simplified as 32 k 1 c σ max where c is the comprehensive influence coefficient related to the opening angle 2 α and the corresponding values under different opening angles can be found in appendix a table a1 after comparison for the same opening angle there is a linear relationship between the maximum notch stress and notch stress intensity factor for welded specimens with plate thickness less than 22 mm therefore the same evaluation results will be obtained when fatigue evaluation is conducted by the maximum notch stress and notch stress intensity factor the notch stress and n sif evaluation results of welded specimens with plate thickness less than 22 mm are presented in fig 24 a it is found that the slope of the curve inverse slope m o is 3 69 and the scatter band index t σ 1 62 obtained by the two methods are the same for cruciform specimens with different opening angles the value of coefficient c is different and the thickness effect correction need not be considered for n sif assessment so different evaluation results will be obtained when fatigue evaluation is carried out by n sif and notch stress method the k n curve of the cruciform specimens with different opening angles is re plotted in fig 24b 33 log n 15 399 3 616 log k the n sif range δ k corresponding to n ref 5 10 6 cycles is 254 49 mpa mm1 λ1 compared with the evaluation results of notch stress in fig 22 the scatter band index t σ is slightly increased to 1 71 6 conclusions based on linear elastic fracture mechanics and singular strength theory the traditional calculation formula of notch stress field was simplified and the calculation formula of notch stress field under different opening angles was obtained by fitting 1 on the basis of the traditional notch stress formula the simplified formulas for stress field distribution on the bisector of v shaped and u shaped notch based on singular intensity factors a s 1 and b s 1 are derived and fitted the singular intensity factors a s 1 and b s 1 are equivalent parameters which can only be related to the geometric sizes and can characterize the singularity of notch stress the simple formula is more convenient for stress assessment and engineering application meanwhile due to fewer fitting parameters higher precision fitting results can be obtained for notch stress distribution 2 based on the notch stress formula of 135 the stress distributions for different opening angles 102 150 v shaped and u shaped notch angles are compared and analyzed systematically and the stress distribution formula applicable to different opening angles is further deduced after verification the error between the simplified formula and the finite element results is less than 10 and most of them are less than 5 3 the relationship between notch stress and notch stress intensity factor is established based on singular intensity factors a s 1 and b s 1 on this basis the notch stress and notch stress intensity factor of welded specimens under different welding angles are calculated for fatigue strength evaluation conveniently it is concluded that for the same opening angle the assessment results of notch stress and n sif have the same scatter index as to different opening angles the assessment results based on notch stress and n sif are also consistent with a smaller scatter index which verifies the effectiveness and convenience of the simple formula credit authorship contribution statement wei shen conceptualization methodology investigation validation formal analysis visualization yu qiu writing original draft software yaoyu hu writing review editing enqian liu resources jin pan supervision writing review editing acknowledgements the research project is supported by the fundamental research funds for the central universities no 2020 the authors also wish to extend their thanks to professor nigel barltrop and dr enqian liu university of strathclyde for their helpful discussions about this work appendix a 1 formula of notch stress function gross and mendelson 1972 a 1 f 1 θθ θ f 1 rr θ f 1 r θ θ 1 λ 1 cos 1 λ 1 θ 3 λ 1 cos 1 λ 1 θ 1 λ 1 sin 1 λ 1 θ χ b 1 1 λ 1 cos 1 λ 1 θ cos 1 λ 1 θ sin 1 λ 1 θ 2 characteristic parameters lazzarin et al 2003 table a1 characteristic parameters for mode i loading table a1 2α λ 1 μ 1 χ b1 χ c1 χ d1 c 102 0 5670 0 3164 2 1958 2 1244 0 1001 0 7259 110 0 5859 0 2952 2 5098 1 8409 0 0914 0 7811 111 0 5890 0 2933 2 5441 1 8304 0 0962 0 7840 120 0 6157 0 2678 3 0027 1 5150 0 0871 0 8607 122 0 6225 0 2620 3 1208 1 4499 0 0861 0 8784 126 0 6368 0 2498 3 3867 1 3111 0 0816 0 9200 127 0 6405 0 2464 3 4620 1 2707 0 0789 0 9328 129 1 0 6487 0 2398 3 6217 1 2006 0 0769 0 9565 135 0 6736 0 2198 4 1530 0 9953 0 0673 1 0347 137 0 6828 0 2132 4 3582 0 9339 0 0663 1 0616 140 8 0 7012 0 1993 4 8143 0 8052 0 0593 1 1232 142 6 0 7104 0 19223 5 0626 0 7428 0 0552 1 1563 145 0 7233 0 1838 5 4174 0 6793 0 0543 1 1940 146 0 7288 0 1795 5 5863 0 6438 0 0513 1 2156 150 0 7520 0 1624 6 3617 0 5137 0 0413 1 3014 appendix b table b1 fitting results of parameter a s 1 and b s 1 table b1 h mm l mm t 13 mm t 25 mm t 35 mm a s 1 mm b s 1 mm a s 1 mm b s 1 mm a s 1 mm b s 1 mm 5 5 3 07 0 6655 3 229 0 6673 3 209 0 6712 10 3 602 0 7085 4 025 0 7298 4 125 0 7288 13 3 835 0 7167 4 606 0 7591 4 674 0 7573 20 4 205 0 7454 5 627 0 8177 5 907 0 8201 26 4 391 0 7579 6 325 0 8469 6 872 0 8665 29 4 45 0 7574 6 621 0 8581 7 313 0 8832 9 5 3 841 0 7243 4 612 0 7607 4 676 0 7606 10 4 12 0 7404 5 364 0 7948 5 575 0 8098 13 4 24 0 7413 5 763 0 8136 6 086 0 8372 20 4 429 0 7549 6 526 0 8601 7 186 0 8761 26 4 516 0 7658 7 038 0 8742 7 999 0 9055 29 4 552 0 7662 7 244 0 8776 8 363 0 9225 15 5 4 36 0 7528 6 233 0 8417 6 735 0 8605 10 4 465 0 7574 6 720 0 8628 7 477 0 8817 13 4 502 0 7588 6 968 0 8698 7 881 0 9026 20 4 585 0 7608 7 435 0 8862 8 692 0 9339 26 4 614 0 7624 7 725 0 8943 9 288 0 9379 29 4 637 0 7636 7 845 0 9038 9 544 0 9538 20 5 4 537 0 7503 7 119 0 8751 8 131 0 9106 10 4 585 0 7607 7 422 0 892 8 707 0 9284 13 4 605 0 7532 7 592 0 8908 9 014 0 9397 20 4 642 0 7571 7 872 0 9062 9 622 0 9538 26 4 654 0 7628 8 077 0 9039 10 05 0 9703 29 4 669 0 7582 8 152 0 9081 10 22 0 9600 30 5 4 658 0 7624 8 049 0 9045 9 986 0 9696 10 4 671 0 7629 8 176 0 9076 10 30 0 9752 13 4 676 0 7573 8 240 0 9087 10 46 0 9681 20 4 678 0 7633 8 363 0 9141 10 77 0 9855 26 4 692 0 7619 8 428 0 9049 11 00 0 9782 29 4 693 0 7620 8 474 0 9073 11 08 0 9987 appendix c table c1 geometric dimensions and fatigue test data of cruciform welded joints table c1 series refs stress ratio r plate thickness t mm opening angle 2α attachment length l mm weld size h mm numbers 1 lazzarin et al 2003 0 3 25 122 25 9 5 3 2 lazzarin et al 2003 0 3 25 146 25 12 5 3 3 lazzarin et al 2003 0 3 25 126 25 12 4 3 4 lazzarin et al 2003 0 3 25 127 25 12 5 3 5 lazzarin et al 2003 0 3 25 111 25 12 3 3 6 nykänen et al 2007 0 9 140 8 9 7 3 17 7 nykänen et al 2007 0 20 129 1 20 9 5 7 8 nykänen et al 2007 0 40 142 6 40 13 9 6 9 nykänen et al 2007 0 20 145 20 12 1 5 10 nykänen et al 2007 0 20 137 20 11 7 5 11 nykänen et al 2007 0 12 135 12 9 2 15 12 kihl et al 1997 1 11 135 11 4 1 36 13 kihl et al 1997 1 19 135 19 7 1 12 14 kihl et al 1997 1 25 135 25 9 4 12 
21741,the existing stress field evaluation formulas for v shaped and u shaped notches are complicated and limited to certain specific opening angles based on linear elastic fracture mechanics and singular strength theory the traditional calculation formula of notch stress distribution is simplified by introducing singular intensity factors and the notch stress formula suitable for different opening angles is further summarized and fitted by comparing the stress distribution laws from 102 to 150 opening angles after verification the relative error of stress between the simple formula and finite element results is about 5 on this basis the formula of notch stress intensity factor n sif under different opening angles is further derived finally the notch stress and n sif of cruciform welded specimens under different welding angles are separately calculated for fatigue strength evaluation the evaluation process shows that the simplified formula can be used to quickly and accurately evaluate the notch stress field and fatigue strength of welded structures keywords different opening angle notch stress welded joint fatigue strength 1 introduction the stress concentration effect at corners will seriously affect the working performance of welded structures the plasticity and toughness of the welding area will be greatly reduced and fatigue cracks will be initiated at corners for large welded structures such as ships bridges and offshore platforms various t shaped welded joints and cruciform welded joints have been widely used to comprehensively meet the requirements of structural safety stability and economy as shown in fig 1 stress concentration will inevitably occur at the welding corners which will lead to the initiation and propagation of fatigue cracks and eventually make the whole structure failure see fig 2 due to the stress singularity effect at the notch some simple methods such as nominal stress and hot spot stress methods are recommended in relevant codes eurocode 3 1993 hobbacher 2009 for guiding fatigue assessment of welded structures however nominal stress and hot spot stress ignore the influence of geometry size on welded structures which will lead to a larger dispersion result and is not conducive to accurate evaluation of fatigue strength the local stress methods such as notch stress method notch stress intensity factor method k n method strain energy density method w n method and peak stress method psm can obtain more accurate fatigue evaluation results by comprehensively considering the influence of local geometry size and load condition of welded structures livieri and lazzarin 2005 meneghetti and lazzarin 2011 pakandam and varvanifarahani 2011 karakaş et al 2018 however the description and calculation of notch stress distribution is the premise for fatigue evaluation of notch specimens by using local stress methods the theoretical researches on the notch stress distribution at the corner had been continuously carried out based on the linear elastic stress strain field analysis of notch specimens and considering different opening angles williams 1952 obtained the stress distribution formula near the notch expressed by the coefficient a i in order to make the coefficient a i in williams formula have definite physical meaning gross and mendelson 1972 extended the definition of stress intensity factor commonly used to describe stress field at crack tip to different opening angles and obtained the notch stress distribution formula by notch stress intensity factor n sif however due to the severe stress concentration at the v notch arc transition was usually adopted to improve the v notch into a u notch in engineering thus reducing the influence of the change of the opening angle on the stress concentration based on gross s v notch formula considering different opening angles lazzarin and tovo 1996 obtained the stress field distribution formula near the u notch based on the plane stress strain assumption and fitted the n sif value corresponding to 135 by finite element calculation method in the following researches by introducing singular intensity factors xu and barltrop 2006 and shen et al 2015 simplified lazzarin s formula and obtained a more accurate and simpler calculation formula for 135 lee et al 2009 analyzed the influence of different welding geometry sizes on the fatigue performance of the specimens through the experimental data of the cruciform welded specimens with the opening angle of 90 152 the results show that the fatigue life of the specimens increases with the increase of the opening angle and the virtual radius at the weld toe ngoula et al 2017 carried out numerical analysis on cruciform welded specimens with different opening angles by finite element method and got the same conclusion as lee et al 2009 song et al 2018 based on lazzarin s formula and finite element method quantified the stress field near the notch into the total energy value and proposed a new fatigue evaluation method to evaluate the fatigue of cruciform specimens with different opening angles however the above mentioned fitting formulas have certain limitations and cannot describe the stress distribution around the notch with different opening angles accurately therefore for different opening angles based on lazzarin s formula filippi et al 2002 and singular intensity theory shen et al 2016 this paper first carried out a series of finite element analysis on v shaped and u shaped notches with 135 opening angle fitting to obtain a simple calculation formula of stress distribution on the bisection of 135 the calculation results based on the simplified formula were compared with the finite element calculation results and lazzarin s formula results to verify the accuracy on this basis the stress distributions on the bisector of v shaped and u shaped notch with opening angles of 102 150 were compared and quantified systematically thereby the simple calculation formula of notch stress of 135 was extended to the case of different opening angles considering different opening angles the notch stress method and notch stress intensity factor method based on the simplified formula were used to evaluate the fatigue strength of welded specimens under different welding corners respectively after a series of verification the simple stress formula and the derived n sif formula can be conveniently applied to the notch stress assessment and fatigue strength assessment under different opening angles in engineering 2 theoretical analysis of notch stress 2 1 traditional formula williams 1952 concluded that the stress field near the tip of the v notch is singular and the notch stress can be divided into mode i open type and mode ii stress slip type see fig 3 a when the opening angle 2 α is greater than 102 the mode ii stress will no longer show singularity and the mode i stress component opening type will be dominated which can be used as the main parameter for fatigue evaluation of welded specimens lazzarin et al 2003 mode i stress can be express as 1 σ θθ σ rr τ r θ λ 1 r λ 1 1 a 1 f 1 θθ θ f 1 rr θ f 1 θ θ where r is the distance to the corner a 1 is the coefficient related to specimen size f 1 ij θ is the stress function in appendix a 1 gross and mendelson 1972 extended the definition of n sif value used to describe crack stress field to v notch and obtained the stress field formula near v notch mode i 2 σ θθ σ rr τ r θ ρ 0 1 2 π r λ 1 1 k 1 1 λ 1 χ b 1 1 λ 1 1 λ 1 cos 1 λ 1 θ 3 λ 1 cos 1 λ 1 θ 1 λ 1 sin 1 λ 1 θ χ b 1 1 λ 1 cos 1 λ 1 θ cos 1 λ 1 θ sin 1 λ 1 θ where k 1 is the n sif value defined by lazzarin and tovo 1996 k 1 σ 0 k 1 t 1 λ i k 1 is a function of h t l for the u shaped notch shown in fig 3b filippi et al 2002 modified gross and mendelson formulas on the premise of maintaining the original formula form of stress field for the v notch and obtained the following formula for calculating the stress field near the u notch mode i 3 σ θθ σ rr τ r θθ ρ 0 σ θθ σ rr τ r θ ρ 0 1 2 π k 1 r 0 1 λ 1 r r 0 μ 1 1 q 4 1 q 1 λ 1 χ b 1 1 λ 1 χ d 1 1 μ 1 cos 1 μ 1 θ 3 μ 1 cos 1 μ 1 θ 1 μ 1 sin 1 μ 1 θ χ c 1 cos 1 μ 1 θ cos 1 μ 1 θ sin 1 μ 1 θ where r 0 q 1 ρ q λ 1 μ 1 χ b 1 χ c 1 and χ d 1 are parameters related to the opening angle see appendix a 2 2 2 simplified u notch stress formula as shown in fig 4 for any opening angle 2 α on the bisector of the notch angle θ 0 the shear stress component of mode i stress τ r θ is 0 and the normal stress component σ θθ can be expressed as v shaped notch 4 σ θθ ρ 0 1 2 π r λ 1 1 k 1 1 λ 1 χ b 1 1 λ 1 1 λ 1 χ b 1 1 λ 1 and for u shaped notch 5 σ θθ ρ 0 σ θθ ρ 0 1 2 π k 1 r 0 1 λ 1 r r 0 μ 1 1 q 4 1 q 1 λ 1 χ b 1 1 λ 1 χ d 1 1 μ 1 χ c 1 for a given opening angle 2 α the parameters λ 1 q χ b 1 χ c 1 and χ d 1 are constant see appendix a table a1 and eq 4 can be further simplified as 6 σ θθ σ 0 2 π 1 r p 1 f 1 h t l 1 p 1 t p 1 for u shaped notch eq 5 can be expressed as 7 σ θθ σ 0 2 π 1 r p 1 f 1 h t l 1 p 1 t p 1 σ 0 2 π 1 r 0 p 1 n 1 1 r n 1 c 1 α f 1 h t l 1 n 1 t p 1 n 1 n 1 where f 1 h t l k 1 is a dimensionless parameter related to the geometric dimensions h t l p 1 1 λ 1 n 1 1 μ 1 and 8 c 1 α q χ d 1 1 μ 1 χ c 1 4 q 1 1 λ 1 χ b 1 1 λ 1 1 n 1 in order to simplify the parameters f 1 h t l 1 p 1 t and c 1 α f 1 h t l 1 n 1 t p 1 n 1 referring to the analysis of 135 notch stress field by shen et al 2016 the new parameters a s 1 and b s 1 were introduced to describe the stress field on the notch bisector 9 σ θθ σ 0 2 a s 1 r p 1 and for u shaped notch 10 σ θθ σ 0 2 a s 1 r p 1 σ 0 2 1 r 00 p 1 n 1 b s 1 r n 1 where a s 1 1 π 1 p 1 f 1 h t l 1 p 1 t and b s 1 1 π 1 n 1 c 1 α f 1 h t l 1 n 1 t p 1 n 1 a s 1 and b s 1 are equivalent parameters defined by comprehensively considering the influence of structural geometry size on notch stress field which are also length parameters used to characterize singularity at the notch 3 numerical analysis and verification 3 1 cruciform model the above simplified formulas eqs 9 and 10 show that for any opening angle the distribution of stress field near the notch can be obtained by knowing the corresponding values of a s 1 and b s 1 in order to determine the relationship between parameter a s 1 b s 1 and geometric dimensions h t l the notch stress of 135 cruciform models under different geometric sizes were modeled and calculated by software ansys 0 l t 6 0 and 0 2 h t 12 see table 1 on this basis numerical analysis was carried out on the notched specimens with opening angles of 102 110 120 and 150 respectively to determine the relationship between stress distribution and opening angles and the stress distribution formulas suitable for different opening angles were further obtained the elastic modulus is e 2 06 10 5 mpa and poisson s ratio is μ 0 3 as all the models are thick plates with thickness t 5 mm according to iiw hobbacher 2009 specification the virtual radius of u notch is taken as 1 mm uniformly 3 2 fe model considering the symmetry of loading and structure based on plane strain assumption plane 182 element was adopted to establish the fe model see fig 5 a series of v shaped and u shaped notch models with different geometric sizes were respectively considered in fig 6 in order to improve the calculation accuracy quadrilateral elements were adopted and the mesh was refined at the corner the mesh convergence analysis on v shaped notch was carried out in fig 7 when the mesh at the corner is reduced to 0 2 mm the change trend of stress field near the notch will not change further in order to ensure sufficient calculation accuracy the minimum mesh size at the corner is taken as 0 1 mm 3 3 formula fitting 3 3 1 simplified formula for 2 α 135 considering that 135 welded corner is the most widely used welded specimen in engineering the stress distributions at the corner are obtained by establishing a series of finite element models of 135 welded specimens with different geometric sizes combined with the simple formulas 9 10 the values of a s 1 and b s 1 under different geometric models are obtained by fitting the fitting results are shown in appendix b table b1 the calculation formulas of a s 1 and b s 1 for 2 α 135 are further fitted out in fig 8 as can be seen from fig 8a a s 1 is a linear function of the width of attachment plate l and can be expressed by two approximate functions the minimum value of which is closer to the numerical results the fitting formula can be expressed as 11 a s 1 min 0 1 l t h 0 1 0 28 h 0 1 t t h 0 9 0 02 l t h 0 35 h 0 1 t t h 0 9 as to b s 1 it can be seen from appendix b table b1 that when the width of attachment plate l changes the value of singular intensity factor b s 1 hardly changes it can be considered that the singular intensity factor b s 1 is only related to the plate thickness t and the height of the bracket h and the relationship between the singular intensity factor b s 1 and h is plotted as shown in fig 8b 12 b s 1 0 2 h 0 18 t 0 3 the fitting values of the formula are compared with the numerical results in fig 9 as shown in fig 9a the error of the fitting formula can be effectively reduced by taking the minimum value of the characteristic value in eq 11 similarly the results of statistical analysis show that the ratios of the calculated values from formula 12 to the fitting results are mostly around 1 which verifies the validity of the formula 12 after parameters a s 1 and b s 1 are determined the stress field distribution on the bisector of 135 v and u shaped notch angle can be obtained according to equations 9 and 10 respectively however for other opening angles the corresponding model needs to be rebuilt to obtain the notch stress distribution 3 3 2 simplified formula for other opening angles in order to obtain the stress distribution on the notch bisector under different opening angles the models with opening angles of 102 110 120 and 150 were numerically analyzed respectively and the calculated results are compared with the results of 2 α 135 as shown in figs 10 11 according to the stress comparison results it is concluded that 1 compared with the reference angle 135 the stress distributions on the bisector of the v notch and u notch angles have the same change trend and the stress curves are approximately linear in logarithmic coordinates 2 for different opening angles the change rules of stress distribution on the bisector of v notch and u notch are consistent when the distance r is small the stress field results tend to be consistent for 135 and 120 but larger than those of other angles however with the increase of r when r is approximately 1 mm the larger the opening angle is the larger the stress result is based on eqs 2 and 13 it can be seen that the normal stress component σ θθ on the notch bisector is related to the distance r the geometric size of the specimen and the opening angle 2 α for the notched specimens with certain geometric dimensions the notch stress intensity factor k 1 is constant and the stress distribution of σ θθ is determined by distance parameter r and opening angle 2 α as shown in eq 13 if the term containing r in eq 13 is moved to the left it can be found from eq 14 that the product of the stress component σ θθ and r 1 λ 1 is only a function of the opening angle therefore based on the stress field on the 135 opening angle deduced in this paper the relationship between the stress distribution under the other opening angles and 135 opening angle can be expressed by eq 15 13 σ θθ 1 2 π r λ 1 1 k 1 1 λ 1 χ b 1 1 λ 1 1 λ 1 cos 1 λ 1 θ χ b 1 1 λ 1 cos 1 λ 1 θ 14 σ θθ r 1 λ 1 1 2 π k 1 1 λ 1 χ b 1 1 λ 1 1 λ 1 cos 1 λ 1 θ χ b 1 1 λ 1 cos 1 λ 1 θ 15 σ θθ 2 α r 1 λ 1 2 α γ 2 α σ θθ 135 r 1 λ 1 135 where σ θθ 2 α is the stress result when the opening angle is 2α λ 1 2 α is the λ 1 value when the opening angle is 2α for 2 α 135 the stress result is σ θ θ 135 and the eigenvalue is λ 1 135 0 674 γ 2 α is a complex function of incision opening angle when the stress results at different opening angles are converted to 135 according to equation 15 the stress results are reanalyzed in fig 12 in the double logarithmic coordinate system after multiplying by the correction coefficient r λ 1 135 λ 1 2 α the stress curves between different opening angles are parallel to each other which means that the curves can be transformed to each other by translation after comparison it is found that the stress on the bisector of the incision angle has the maximum value with the opening angle 135 when 2 α 135 the stress value decreases with the decrease of the opening angle when 2 α 135 the stress value decreases with the increase of the opening angle the transformation between different stress curves needs to be multiplied by a coefficient related to the opening angle on the basis of 135 16 σ θθ 2 α σ θθ 135 r λ 1 0 674 cos 2 α 135 the angle correction coefficient γ 2 α is cos 2 α 135 which is always less than or equal to 1 and the correction value is consistent with the change trend of stress results shown in fig 11 the stress comparison at different opening angles after considering the distance correction coefficient and the angle correction coefficient is shown in fig 13 it is found that the stress results at different opening angles after correction are very similar combined with the simplified 135 opening angle formula the stress formula on the notch bisector under different opening angles can be expressed as follows v shaped notch 17 σ θθ 2 α σ 0 2 r λ 1 0 674 cos 2 α 135 a s 1 r p 1 and for u shaped notch 18 σ θθ 2 α σ 0 2 r λ 1 0 674 cos 2 α 135 a s 1 r p 1 1 r 0 p 1 n 1 b s 1 r n 1 4 formula verification lazzarin et al 2003 presented an approximate formula for calculating the stress field near the v notch in order to verify the accuracy of the formula a s 1 and b s 1 proposed in this paper the finite element results and lazzarin formula calculation results can be used for comparison when 2 α 135 θ 0 lazzarin formula can be expressed as for v shaped notch 19a σ θθ r λ 1 1 σ 0 t 1 λ 1 k 1 2 π 1 λ 1 χ b 1 1 λ 1 1 λ 1 χ b 1 1 λ 1 and for u shaped notch 19b σ θθ r λ 1 1 σ 0 t 1 λ 1 k 1 2 π 1 λ 1 χ b 1 1 λ 1 1 λ 1 χ b 1 1 λ 1 q 4 q 1 r r 0 μ 1 λ 1 χ d 1 1 μ 1 χ c 1 for cruciform members under tensile loading 20 k 1 1 212 0 495 e 0 985 2 h t l 1 259 e 1 120 2 h t 0 485 l t the parameter definition in the formula above is shown in fig 3 and the applicable scope is 0 l t 3 0 and 0 25 2 h t 2 5 since the above formula is also only applicable to 135 notch stress assessment the above formula should be extended to other angles by combining distance correction r λ 1 0 674 and angle correction cos 2 α 135 the stress field distributions at the corners under different opening angles obtained by the three methods are compared in figs 14 18 for convenience of comparison taking the fine finite element results as reference values the relative error formula is defined as follows 21 δ σ formula σ fe σ fe 100 where δ is the relative error value σ formula and σ fe are the stress results calculated by formula and finite element respectively mpa as shown in figs 14 18 with the increase of distance r the normal stress component σ θθ gradually decreases and the stress curve is approximately linear in logarithmic coordinates it is concluded that when the opening angle is between 102 and 150 the stress results predicted by eqs 17 and 18 are close to the results of finite element results taking the fe results as reference values the relative errors of the stress results of the simple method and lazzarin formula are also analyzed in fig 19 compared with the fe results the relative error of stress results of lazzarin formula is within 10 while the maximum relative error with formula a s 1 and b s 1 will not exceed 8 except for a few stress points the relative error of most stress points with the simple formula is within 5 5 fatigue strength analysis 5 1 nominal stress assessment to validate the proposed methods above the fatigue strength of 14 groups of steel cruciform welded structures under tensile load were collected and reanalyzed as shown in appendix c the experimental data included three different stress ratios r 1 r 0 and r 0 3 in order to obtain more rigorous and reliable results the experimental data under different stress ratios need to be converted to the condition of stress ratio r 0 according to the average stress conversion curve shown in fig 20 first sonsino 2009 coefficient f i is the ratio of nominal stress amplitude under different stress ratios and m i is the mean stress sensitivity parameter 22 f 1 σ a r 1 σ a r 0 f 2 σ a r 0 σ a r 0 5 a n d f 3 σ a r 1 σ a r 0 5 23 m 1 σ a r 1 σ a r 0 1 a n d m 2 σ a r 0 σ a r 0 5 1 as shown in fig 20 σ a is the nominal stress amplitude and σ m is the mean stress the stress correction is realized by multiplying the correction coefficient f i moreover from the experimental data in appendix c table c1 it can be seen that the experimental data have obvious thickness effect with the increase of plate thickness the fatigue strength of the cruciform specimen decreases instead when using s n method to evaluate the fatigue strength of welded specimen the influence of thickness effect should also be considered according to the recommendations of the british department of energy british standards institution 1993 the thickness effect correction formula was given for welded specimens with plate thickness greater than 22 mm 24 s s b t b t eff k where s b and s are the fatigue strengths before and after correction k is the thickness correction exponent t b is the reference maximum thickness and t eff is the effective thickness the nominal stress s n curve of cruciform specimens after considering the conversion of different stress ratios and thickness effects was redrawn as shown in fig 21 the formula of the nominal stress s n curve in survival rate p s 50 is 25 log n 14 14 3 81 log s the inverse slope m of the s n curve is 3 811 which is close to the recommended value of 3 in the specification iiw hobbacher 2009 the fatigue strength corresponding to n ref 5 10 6 cycles is 89 96 mpa and the scatter band index t σ t σ σ ps 2 3 σ ps 97 7 is 2 13 5 2 notch stress assessment in order to consider the influence of welding geometry this paper re evaluated the fatigue strength of cruciform welded specimens above by using notch stress method as the thickness of the welded specimens used in this paper are all greater than 5 mm the virtual radius is uniformly taken as 1 mm when fatigue assessment is carried out by the notch stress method as recommended by iiw hobbacher 2009 according to formula 18 u notch stress can be obtained for the welded joints with virtual radius ρ f 1 mm under different opening angles similarly considering the correction of different stress ratios and thickness effects the notch stress s n curve of the cruciform specimens with different opening angles is plotted in fig 22 26 log n 15 53 3 70 log s as shown in fig 22 the stress range δ σ corresponding to n ref 5 10 6 cycles is 245 4 mpa compared with the evaluation results of nominal stress the scatter band index t σ is reduced from 2 13 to 1 62 5 3 n sif assessment because the notch stress intensity factor takes into account the influence of scale effect when it is defined it is recommended to be used for fatigue strength evaluation of welded specimens under different geometric scales as shown in fig 23 under the same surface stress the stress gradient of the thin plate will be larger which means that the stress of the thick plate will be larger at the same distance from the weld toe under the assumption of linear elasticity considering the same elastic properties the stress fields are similar 27 σ θ b x σ θ a x d where d is the scale ratio taking notch stress intensity factor k 1 as an example k 1 b 2 π lim r 0 σ θ b r r 1 λ 1 2 π lim r 0 σ θ a r d r 1 λ 1 28 2 π lim r 0 σ θ a r d d 1 λ 1 d 1 λ 1 r 1 λ 1 assuming r r d 29 k 1 b 2 π lim r 0 σ θ a r r 1 λ 1 d 1 λ 1 then 30 k 1 b d 1 λ 1 k 1 a the above formula shows that the solution of notch stress intensity factor for large scale specimens can be based on the solution of small scale thus effectively solving the influence of scale effect on fatigue assessment of thin plate structures since the formula 30 already includes the geometric parameter d reflecting scale effect the thickness effect correction need not be considered for n sif assessment for u notch specimens considering the virtual radius at the notch the relationship between notch stress intensity factor n sif and the maximum circumferential stress σ θθ on the bisector of u notch angle is obtained as follows lazzarin et al 2003 31 k 1 σ max 2 π r 0 1 λ 1 1 1 μ 1 χ d 1 χ c 1 1 λ 1 χ b 1 1 λ 1 q 4 q 1 where σ max is the maximum circumferential stress on the bisector of the u shaped notch λ 1 q χ b 1 χ c 1 and χ d 1 are parameters related to opening angle 2 α eq 31 can be further simplified as 32 k 1 c σ max where c is the comprehensive influence coefficient related to the opening angle 2 α and the corresponding values under different opening angles can be found in appendix a table a1 after comparison for the same opening angle there is a linear relationship between the maximum notch stress and notch stress intensity factor for welded specimens with plate thickness less than 22 mm therefore the same evaluation results will be obtained when fatigue evaluation is conducted by the maximum notch stress and notch stress intensity factor the notch stress and n sif evaluation results of welded specimens with plate thickness less than 22 mm are presented in fig 24 a it is found that the slope of the curve inverse slope m o is 3 69 and the scatter band index t σ 1 62 obtained by the two methods are the same for cruciform specimens with different opening angles the value of coefficient c is different and the thickness effect correction need not be considered for n sif assessment so different evaluation results will be obtained when fatigue evaluation is carried out by n sif and notch stress method the k n curve of the cruciform specimens with different opening angles is re plotted in fig 24b 33 log n 15 399 3 616 log k the n sif range δ k corresponding to n ref 5 10 6 cycles is 254 49 mpa mm1 λ1 compared with the evaluation results of notch stress in fig 22 the scatter band index t σ is slightly increased to 1 71 6 conclusions based on linear elastic fracture mechanics and singular strength theory the traditional calculation formula of notch stress field was simplified and the calculation formula of notch stress field under different opening angles was obtained by fitting 1 on the basis of the traditional notch stress formula the simplified formulas for stress field distribution on the bisector of v shaped and u shaped notch based on singular intensity factors a s 1 and b s 1 are derived and fitted the singular intensity factors a s 1 and b s 1 are equivalent parameters which can only be related to the geometric sizes and can characterize the singularity of notch stress the simple formula is more convenient for stress assessment and engineering application meanwhile due to fewer fitting parameters higher precision fitting results can be obtained for notch stress distribution 2 based on the notch stress formula of 135 the stress distributions for different opening angles 102 150 v shaped and u shaped notch angles are compared and analyzed systematically and the stress distribution formula applicable to different opening angles is further deduced after verification the error between the simplified formula and the finite element results is less than 10 and most of them are less than 5 3 the relationship between notch stress and notch stress intensity factor is established based on singular intensity factors a s 1 and b s 1 on this basis the notch stress and notch stress intensity factor of welded specimens under different welding angles are calculated for fatigue strength evaluation conveniently it is concluded that for the same opening angle the assessment results of notch stress and n sif have the same scatter index as to different opening angles the assessment results based on notch stress and n sif are also consistent with a smaller scatter index which verifies the effectiveness and convenience of the simple formula credit authorship contribution statement wei shen conceptualization methodology investigation validation formal analysis visualization yu qiu writing original draft software yaoyu hu writing review editing enqian liu resources jin pan supervision writing review editing acknowledgements the research project is supported by the fundamental research funds for the central universities no 2020 the authors also wish to extend their thanks to professor nigel barltrop and dr enqian liu university of strathclyde for their helpful discussions about this work appendix a 1 formula of notch stress function gross and mendelson 1972 a 1 f 1 θθ θ f 1 rr θ f 1 r θ θ 1 λ 1 cos 1 λ 1 θ 3 λ 1 cos 1 λ 1 θ 1 λ 1 sin 1 λ 1 θ χ b 1 1 λ 1 cos 1 λ 1 θ cos 1 λ 1 θ sin 1 λ 1 θ 2 characteristic parameters lazzarin et al 2003 table a1 characteristic parameters for mode i loading table a1 2α λ 1 μ 1 χ b1 χ c1 χ d1 c 102 0 5670 0 3164 2 1958 2 1244 0 1001 0 7259 110 0 5859 0 2952 2 5098 1 8409 0 0914 0 7811 111 0 5890 0 2933 2 5441 1 8304 0 0962 0 7840 120 0 6157 0 2678 3 0027 1 5150 0 0871 0 8607 122 0 6225 0 2620 3 1208 1 4499 0 0861 0 8784 126 0 6368 0 2498 3 3867 1 3111 0 0816 0 9200 127 0 6405 0 2464 3 4620 1 2707 0 0789 0 9328 129 1 0 6487 0 2398 3 6217 1 2006 0 0769 0 9565 135 0 6736 0 2198 4 1530 0 9953 0 0673 1 0347 137 0 6828 0 2132 4 3582 0 9339 0 0663 1 0616 140 8 0 7012 0 1993 4 8143 0 8052 0 0593 1 1232 142 6 0 7104 0 19223 5 0626 0 7428 0 0552 1 1563 145 0 7233 0 1838 5 4174 0 6793 0 0543 1 1940 146 0 7288 0 1795 5 5863 0 6438 0 0513 1 2156 150 0 7520 0 1624 6 3617 0 5137 0 0413 1 3014 appendix b table b1 fitting results of parameter a s 1 and b s 1 table b1 h mm l mm t 13 mm t 25 mm t 35 mm a s 1 mm b s 1 mm a s 1 mm b s 1 mm a s 1 mm b s 1 mm 5 5 3 07 0 6655 3 229 0 6673 3 209 0 6712 10 3 602 0 7085 4 025 0 7298 4 125 0 7288 13 3 835 0 7167 4 606 0 7591 4 674 0 7573 20 4 205 0 7454 5 627 0 8177 5 907 0 8201 26 4 391 0 7579 6 325 0 8469 6 872 0 8665 29 4 45 0 7574 6 621 0 8581 7 313 0 8832 9 5 3 841 0 7243 4 612 0 7607 4 676 0 7606 10 4 12 0 7404 5 364 0 7948 5 575 0 8098 13 4 24 0 7413 5 763 0 8136 6 086 0 8372 20 4 429 0 7549 6 526 0 8601 7 186 0 8761 26 4 516 0 7658 7 038 0 8742 7 999 0 9055 29 4 552 0 7662 7 244 0 8776 8 363 0 9225 15 5 4 36 0 7528 6 233 0 8417 6 735 0 8605 10 4 465 0 7574 6 720 0 8628 7 477 0 8817 13 4 502 0 7588 6 968 0 8698 7 881 0 9026 20 4 585 0 7608 7 435 0 8862 8 692 0 9339 26 4 614 0 7624 7 725 0 8943 9 288 0 9379 29 4 637 0 7636 7 845 0 9038 9 544 0 9538 20 5 4 537 0 7503 7 119 0 8751 8 131 0 9106 10 4 585 0 7607 7 422 0 892 8 707 0 9284 13 4 605 0 7532 7 592 0 8908 9 014 0 9397 20 4 642 0 7571 7 872 0 9062 9 622 0 9538 26 4 654 0 7628 8 077 0 9039 10 05 0 9703 29 4 669 0 7582 8 152 0 9081 10 22 0 9600 30 5 4 658 0 7624 8 049 0 9045 9 986 0 9696 10 4 671 0 7629 8 176 0 9076 10 30 0 9752 13 4 676 0 7573 8 240 0 9087 10 46 0 9681 20 4 678 0 7633 8 363 0 9141 10 77 0 9855 26 4 692 0 7619 8 428 0 9049 11 00 0 9782 29 4 693 0 7620 8 474 0 9073 11 08 0 9987 appendix c table c1 geometric dimensions and fatigue test data of cruciform welded joints table c1 series refs stress ratio r plate thickness t mm opening angle 2α attachment length l mm weld size h mm numbers 1 lazzarin et al 2003 0 3 25 122 25 9 5 3 2 lazzarin et al 2003 0 3 25 146 25 12 5 3 3 lazzarin et al 2003 0 3 25 126 25 12 4 3 4 lazzarin et al 2003 0 3 25 127 25 12 5 3 5 lazzarin et al 2003 0 3 25 111 25 12 3 3 6 nykänen et al 2007 0 9 140 8 9 7 3 17 7 nykänen et al 2007 0 20 129 1 20 9 5 7 8 nykänen et al 2007 0 40 142 6 40 13 9 6 9 nykänen et al 2007 0 20 145 20 12 1 5 10 nykänen et al 2007 0 20 137 20 11 7 5 11 nykänen et al 2007 0 12 135 12 9 2 15 12 kihl et al 1997 1 11 135 11 4 1 36 13 kihl et al 1997 1 19 135 19 7 1 12 14 kihl et al 1997 1 25 135 25 9 4 12 
21742,installation of the channeling device around a tidal turbine can stabilize flow field increase flow velocity and improve energy utilization efficiency significantly the application of channeling devices on improving the efficiency of vertical axis tidal turbines in restricted water has hardly been investigated in the present study two ducts with different inside wall shapes have been taken as examples to investigate the bank and free surface effects on energy converging efficiency of the ducts around a vertical axis tidal current turbine in shallow and narrow water the three dimensional viscous flow field around the ducts is simulated by using cfd technology rans equations are employed as viscous flow solvers and the realizable two layer k ε turbulence model is applied to predict the energy converging efficiency of the ducts investigation of grid dependence is conducted and grid independent solution is obtained by analyzing the numerical results of several sets of computational grids for the duct around the vertical axis tidal current turbine near or piercing the free surface of the water in some cases volume of fluid vof method is employed to capture the free surface based on the numerical results it is known that the average energy flux density in w02 model is much larger than that in w01 model so it can be concluded that the inside wall shape of the ducts dominates the energy converging efficiency of the ducts in great extent and bank effect on energy converging efficiency of the duct varies with inside wall shapes of the duct what s more the free surface plays an important role in the energy converging efficiency of the ducts and smaller clearance between free surface and the top of duct will induce higher energy converging efficiency keywords energy converging efficiency duct of vertical axis turbine restricted water numerical simulation effect of free surface bank effect nomenclature a cross sectional area of the ducts m2 a c cross sectional area of the channel m2 b blockage ratio c 2 constant c 1ε constant c fs clearance coefficient c bd clearance between bank and outside wall of duct e energy flux density kg s3 e x relative error for f x e y relative error for f y f x longitudinal force n f y lateral force n g b turbulent kinetic energy production caused by buoyancy kg m3 g k turbulent kinetic energy production caused by an average velocity gradient kg m3 h height of the ducts m h fs clearance between free surface and the top of ducts m k turbulent kinetic energy m2 s2 l length of the ducts m p relative pressure pa q source term kg m2 s2 re reynolds number r v increasing rate of flow velocity s modulus of the mean strain rate tensor s k user specified source term kg m3 s ε user specified source term kg m3 s t thickness of the ducts m u velocity component of x direction m s u time averaged velocity m s v velocity component of y direction m s v flow velocity m s v b d average flow velocity from monitoring point b to d m s w velocity component of z direction m s w width of the ducts m y m the effect of fluctuating expansion of turbulent on dilatation dissipation in compressible turbulent kg m3 y dimensionless wall distance greek symbols α volume fraction σ k turbulent prandtl number of turbulent kinetic energy k σ ε turbulent prandtl number of turbulent dissipation rate ε ε turbulent dissipation rate m2 s3 μ kinematic viscosity of liquid pa s ρ liquid density kg m3 τ reynolds stress tensor kg m s2 subscripts avg average acronyms 2d two dimensional 3d three dimensional cfd computational fluid dynamic fs free surface rans reynolds averaged navier stokes simple semi implicit method for pressure linked equations bd bank and outside wall of duct vof volume of fluid 1 introduction with the continued consumption of fossil energy development and utilization of renewable energy have been the focus of research in the field of energy tidal current energy as a very promising renewable energy resource is predictable with high energy flux density and has been widely studied the earth is abundant in tidal current energy resources especially in the channel as a country with long coastal line and wide sea area china has rich tidal current resources however the distribution of the potential resources is not homogenous according to the data collected the average tidal current energy in china is estimated to be about 8 2 gw among which 78 6 is distributed in east china sea gao et al 2015 zheng et al 2015 as tidal current energy captured by a turbine is proportional to the flow velocity cubed the increase of flow velocity will significantly lead to the improvement on energy generating efficiency besides the flow velocity is also closely associated with start up behavior of a turbine as the turbine can hardly start at low flow velocity han et al 2013 bachant and wosnik 2015 day et al 2015 in order to lower turbine s demand on tidal current velocity the channeling devices with the ability of increasing flow velocity have attracted extensive concerns throughout research institutions all over the world although the application of ducted devices on vertical axis turbines is not as wide as those applied on horizontal axis turbines some significant progresses have been achieved recently ponta and dutt 2000 proposed a novel floating tidal current power generating system with a ducted device installed around a vertical axis turbine in their research the application of duct is recommended to improve flow field environment reduce equipment costs and prolong service life of device in order to study the effects of brim height and outside body shape on performance of ducts setoguchi et al 2004 conducted experiments in a low speed wind tunnel to investigate the effects of brim height and outside body shape on the performance of a two way diffuser experiments show that the outside body shape plays an important role in increasing diffuser performance liu 2007 summarized the progress of ducts and analyzed the effects of distance between duct and turbine length and width of duct on energy converging efficiency of duct via numerical simulation with respect to two types of molded lines finally a duct with relatively high efficiency was proposed in his research considering the flood and ebb of current sun 2008 presented six different bi directional ducts which can adapt to the reciprocating characteristics of tides through experimental measurements and numerical simulations load rules of six ducts and their effects on energy generating performance of turbine were illustrated and hydrodynamic interference laws between turbine and different types of ducts were concluded ponta and jacovkis 2008 proposed a new floating energy generating system with high utilization rate of tides duct was employed in that system to increase tidal current velocity and the gearbox was eliminated under low velocity condition khan et al 2009 summarized the state of the art of tidal current power generating system including the types of turbine and duct according to their analysis the application of duct would be highlighted in the future development of tidal current power generating system as is known the duct does have notable effects on converging fluids and stabilizing flow field currently most of the researchers focus on the performance of various vertical and horizontal axis turbines fernandes and rostami 2015 marsh et al 2015 yang et al 2016 akimoto et al 2013 li et al 2015 lust et al 2013 churchfield et al 1985 while only a few work discussed the effect of the duct on vertical axis turbines kirke 2011 besides most of the existing studies were based on two dimensional 2d numerical simulations maître et al 2013 zanette et al 2010 in which the tidal current power generating devices were assumed to be fixed in deep and wide water and the effects of environmental factors on energy converging efficiency of ducts have seldom been investigated in fact there are abundant tidal energy resources in some restricted waters in which both the duct and the vertical axis tidal current turbine would be near the bank and free surface i̇n this case the viscous flow around the duct near the bank and free surface in restricted water is essentially a three dimensional problem and it is necessary to use a 3d numerical approach to investigate the effects of bank and free surface on energy converging efficiency of the duct 2 description of ducts for vertical axis tidal current turbine the cross sectional area of duct reduces from inlet of the duct to front of the turbine and gradually expands from aft end of the turbine to outlet flow velocity increases progressively with the cross sectional area of the fore body of duct decreases thus the energy of tidal current can be converged meanwhile the gradually increase of cross sectional area of the after body of duct can reduce flow velocity in the wake which is beneficial to stabilize the wake flow field and avoid boundary layer separation existing diverse molded lines of ducts have unique energy converging efficiency sun 2008 modified the hyperbolic curves and vickers curves and proposed six different molded lines see fig 1 based on parameters including contraction ratio flow ratio flow velocity ratio impact force coefficient etc the performance of different ducts on increasing flow velocity and stabilizing flow field are analyzed in detail by 2d numerical simulations however effects of bank and free surface on energy converging efficiency of duct were not considered in his work in the present study the 3d viscous flow field around the duct of a vertical axis current turbine is simulated numerically the flow velocity in the duct is monitored during numerical calculations and variations of flow velocity are considered the effects of bank and free surface on energy converging efficiency of duct are summarized based on the numerical results to study the energy converging performance of different types of duct two typical models namely w01 and w02 are studied in detail the top and side views are shown in fig 2 in the computational domain the longitudinal direction of the duct is parallel to x axis the transverse direction of the duct is parallel to y axis and the origin of the coordinate coincides with the center of the duct tidal current in the numerical simulations flows towards positive x axis the principal dimensions of the ducts are length l 6 00 m width w 3 50 m height h 6 00 m thickness of w01 model t 1 0 39 m thickness of w02 model t 2 0 54 m and t 3 0 39 m respectively 3 numerical methods on viscous flow around the duct some researchers alidadi and calisal 2014 fleming and willden 2016 have investigated the performance of the ducted tidal current turbine but failed to analysis the specific role that duct plays the effects of bank and fee surface on duct were also neglected in the present work the viscous flow field around the duct is simulated by cfd code star ccm by solving the continuity equation and reynolds averaged navier stokes rans equations the effects of bank of a narrow channel as well as the free surface effect on energy converging efficiency of two ducts are analyzed 3 1 governing equations of incompressible viscous flow continuity equation of incompressible fluid can be written as 1 u x v y w z 0 where u v and w represent the velocity component in x y and z direction respectively reynolds averaged navier stokes rans equations for momentum transport is 2 ρ u i t ρ u j u i x j p x i x j μ u i x j ρ u i u j where u i and u j are time averaged velocity p is time averaged relative pressure ρ is liquid density μ is the dynamic viscosity of liquid ρ u i u j is the reynolds stress tensor in the present study ambient temperature is set at 20 c correspondingly during numerical calculations the water density is 1030 kg m3 and kinematic viscosity of water is 1 010 10 3 pa s considering the velocity of the tidal current v 1 0 m s and the characteristic size of ducts l 6 00 m reynolds number can be calculated by 3 r e v l μ ρ 1 00 m s 6 00 m 1 010 10 3 p a s 1030 k g m 3 6 119 10 6 reynolds averaged navier srokes method is one of the most popular approaches among viscous flow solvers day et al 2015 several turbulence models such as spalart allmaras turbulence model k epsilon turbulence model k omega turbulence model are usually employed to satisfy the governing equations according to sun 2008 gretton 2009 the widely used k epsilon turbulence model with good converging property is applied to simulate the viscous flow around the duct besides considering the condition of simulation and the characteristics of turbulence models realizable k epsilon two layer model is selected in the present numerical calculation two layer approach is used to divide the computation into two layers the layer next to the wall and the near wall layer that contribute to resolve the viscous sublayer it is demonstrated that this approach is more empirical than the damping function approach and the results are often equally satisfactory or better meanwhile the realizable k epsilon turbulence model can satisfy certain mathematical constraints on the normal stresses consistent with the physics of turbulence transport equations of k and ε in realizable k epsilon model 4 ρ k t ρ k u i x i x j μ μ t σ k k x j g k g b ρ ε υ m s k 5 ρ ε t ρ ε u i x i x j μ μ t σ ε ε x j ρ c 1 s ε ρ c 2 ε 2 k v ε c 1 ε ε k c 3 ε g b s ε 6 c 1 max 0 43 η η 5 7 η s k ε g k is the turbulent kinetic energy production caused by an average velocity gradient g b is the turbulent kinetic energy production caused by buoyancy y m represents the effect of fluctuating expansion of turbulent on dilatation dissipation in compressible turbulent c 2 and c 1ε are constant σ k and σ ε are turbulent prandtl number of turbulent kinetic energy k and turbulent dissipation rate ε s k and s ε are the user specified source terms as mentioned above the realizable k epsilon two layer model is applied in all simulation cases and all y wall treatment is used with this turbulent model to optimize the simulations all y wall treatment can not only simulates the way high y wall treatment does in dealing with coarse grid but simulates the way low y wall treatment does in dealing with fine grid since cases have either fine grid around boundary layer of duct or coarse grid on peripheral flow field all y wall treatment is an optimum choice for getting ideal numerical results besides not like high y wall treatment and low y wall treatment the requirements of wall y value are less stringent on all y wall treatment in all cases involved y value is about 40 which has met the requirement of all y wall treatment in order to investigate free surface effect on efficiency volume of fluid vof method is employed to capture the motion of free surface in addition eulerian multiphase model is applied to control the physical setup of air and water between free surface basic vof model equations 8 ρ i ρ i α i 9 μ i μ i α i where the subscript i denotes different phases α i is the volume fraction of each phase i for single phase flows α i is automatically set to 1 while ρ i and μ i are the density and molecular viscosity corresponding to phase i 10 α i v i v numerical simulations are performed by an implicit unsteady and separated flow solver so as to achieve stable and better converging results yang and lawn 2011 the segregated flow solver controls the update of solution according to simple algorithm and also controls velocity and pressure solver besides the convection term is discretized by a second order upwind scheme and diffusive terms are discretized by the central differencing scheme under relaxation factors in all equations are set to 0 8 except for the pressure term and under relaxation factor of the pressure term is 0 2 in the present numerical simulations the time step is 0 001 s with a second order scheme for time integration which is small enough to obtain convergent results 3 2 computational domain and boundary conditions setting fig 3 illustrates the setting of boundary of the computational domain the length of computational domain is 5 0l l in the upstream side and 3 0l downstream in cases investigating the effect of bank the width of computational domain is 2 0w 4 0w 8 0w 10 0w and 20 0w respectively the height is h and the bottom of duct is level with bottom boundary while in cases investigating the effect of free surface the width of computational domain is 6 0w the height is 3 0h the distance between free surface and the top of duct ranges from 0 m to 4 8 m and the bottom of duct is 6 0 m higher than bottom boundary in all cases the boundary condition for the inlet is set to be velocity inlet and the outlet is set to be pressure outlet in the case studies of bank effect the side wall boundary condition are set to be no slip wall and the top and bottom boundaries are set to be symmetrical in the case studies of the free surface effect the side top and bottom boundary conditions are set to be velocity inlet 3 3 grid dependence study grid distribution for w01 model is given in fig 4 zones with local grid refinement are used around the duct five prism layers are attached to the surface of the duct to capture the detailed fluid flow features around the duct as shown in fig 4 b systematic search for grid independent results forms an essential part of a high quality numerical study malipeddi and chatterjee 2012 the only way to eliminate errors due to the coarseness of a grid is to perform a grid dependence study a procedure of successive refinement of an initially coarse grid is performed until some key results change within acceptable errors and then the simulation can be regarded as grid independent in the present study of grid dependence longitudinal force f x and lateral force f y acting on the duct are calculated by using several sets of grids furthermore since the duct studied is symmetrical and the resultant lateral force on the duct is zero f y mentioned above is taken as the lateral force acting on one side of the duct for comparative purpose and relative errors e x and e y can be evaluated by 11 e x f x i f x i 1 f x i 1 100 12 e y f y i f y i 1 f y i 1 100 where i is the case number different grid densities are shown in table 1 table 2 presents the results obtained by using different grid densities by comparing the numerical results in case 1 case 2 and case 3 it can be found that e x and e y are large in case 3 and case 4 the change of grid number does not cause significant variations of the numerical results therefore it is found that numerical results are convergent when the grid number reaches approximately 1 75 million in order to save computation time and storage space the grid size used in case 3 is adopted and it is fine enough to guarantee independent convergent result 4 influence factors on energy converging efficiency of duct 4 1 bank effect the width of the fluid domain can affect the fluids between bank and outside wall of duct the decrease of the width will lead to reducing of clearance c bd see fig 5 which would result in blockage effect and thereafter influences the energy converging efficiency of the duct based on the numerical results the bank effect on energy converging efficiency of the duct is analyzed a non dimensional blockage ratio b is employed and it is defined as 13 b a a c where a w h and a c represents the cross section area of the channel in order to carry out extensive studies on the flow velocity of w01 and w02 models five monitoring points are selected in the central plane of ducts see fig 6 considering that the rotor region is of most interests three points namely point b c and d are selected to monitor the flow velocity at rotor region besides point a and e are set to monitor the inlet and outlet flow velocity of duct for five different blockage ratios the flow velocity at all the monitoring points is presented in tables 3 and 4 note that v b d represents the average flow velocity from point b to d which is defined as 14 v b d v b v c v d 3 to study the bank effect on energy converging efficiency of the duct figs 7 and 8 shows the changing tendency of flow velocity with blockage ratio at all monitoring points in w01 and w02 models it is obvious that v a and v e v b and v d in the same model present similar varying tendencies while the tendency of velocity is not exactly the same at the same monitoring point with different range of b it can be seen that when b increases from 0 050 to 0 500 the flow velocity at five monitoring points in w01 and w02 models increases gradually with the increase of b which indicates that the effect of the bank wall is beneficial for energy converging efficiency of the ducts at five monitoring points when b increases from 0 050 to 0 125 the flow velocity in w01 and w02 models varies very slowly as b increases to 0 500 the flow velocity varies more rapidly compared with the flow velocity in different model the increase of the flow velocity in w02 model is more significant than w01 model which is result from the different inside wall shapes of the duct in addition for the same b it is observed that the velocity relationship of five monitoring points can be described as v c v d v b v a v e in w01 while it is described as v d v b v c v e v a in w02 by comparing variation of the average flow velocity in w01 and w02 models see fig 8 it is observed that the increasing rate of the average flow velocity for w02 is larger than w01 by comparing all curves of flow velocity of w02 it can be seen that the flow velocities begin to increase rapidly when b reaches 0 25 though the increment of the flow velocity is still relatively small accordingly the effects of bank is notable on the energy converging efficiency of the ducts besides it is found that the bank effect on the energy converging efficiency of the ducts with different inner wall shape is obviously different by comparing the velocity curves of w01 and w02 to study the effect of bank on energy converging efficiency of the duct more directly the energy flux density e is given 17 e 1 2 ρ v 3 for the initial flow velocity v 0 1 0 m s the energy flux density of initial tidal current is 18 e 0 1 2 ρ v 0 3 1 2 1030 1 0 3 515 0 k g s 3 average energy flux density from point b to d is defined as 19 e a v g 1 3 e b e c e d where e b e c and e d is the energy flux density at point b c and d respectively it is presented in fig 9 that as blockage ratio increases the average energy flux density from point b to d increases in w02 model but is almost constant in w01 model from the flow velocities in tables 3 and 4 we can get fig 9 e avg is 1104 44 kg s3 and 1117 86 kg s3 respectively for blockage ratio b 0 05 0 5 in w01 and it is 1259 94 kg s3 and 1329 25 kg s3 respectively for blockage ratio b 0 05 0 5 in w02 compared with the initial energy flux density e 0 515 0 kg s3 the average energy flux density is increased from 114 47 to 117 06 in w01 model and from 144 66 to 158 10 in w02 model it can be concluded that the average energy flux density in w02 model is much larger than that in w01 model the bank effect on energy converging efficiency of the duct varies with inside wall shapes of the duct velocity contours of w01 and w02 models corresponding to various blockage ratios are shown in fig 10 an evident acceleration zone can be observed from the fore end to the transverse plane of duct because of duct s energy converging effect for both ducts two peaks of flow velocity appear at 1 4 and 3 4 length of duct respectively at the same time the velocity of the two peaks increases obviously with the increase of the blockage ratio especially in w02 in spite of similar distribution of flow velocity for two ducts with different blockage ratios the gradients are different it means that the effect of bank on velocity distribution will vary obviously with the change of blockage ratio for different inside shape of the duct furthermore it can be seen clearly that the flow velocity at the rotor region in w01 model is almost the same but in w02 model it increases obviously as the blockage ratio increases therefore with different inside wall shapes the bank could play different roles in duct s energy converging efficiency fig 11 and fig 12 show the pressure distribution on the inside and outside walls of w01 and w02 models with different blockage ratios respectively from fig 11 it is found that the distribution of the pressure on the inside wall of each duct is similar regardless of blockage ratio however the differences between w01 and w02 models are evident the pressure on inside wall near the fore end of w02 model is much higher than that on w01 model while it can also be seen that the pressure on the inside wall near aft end of w02 the is lower than that on w0l and the pressure on the inside wall of w02 is much lower than that on w01 especially near 1 4 and 3 4 length of duct furthermore as shown in fig 11 b the pressure distributed on the inner wall of entrance of w02 model increases slightly with the increase of the blockage ratio but decreases obviously at 1 4 and 3 4 length of duct comparing fig 11 with fig 12 it is revealed that the pressure distribution on duct s outside wall is more uniform than that on inside wall it is also illustrated in fig 12 that the pressure distributed on the outside wall of w02 model is significantly lower than that on w01 model at different blockage ratios which indicates that the flow velocity between the bank and outside wall in w02 model is higher than that in w01 model this is caused by the differences on the thickness of two types of ducts namely t 1 and t 2 specifically as t 2 is greater than t 1 more fluid is passing through the clearance between the bank and outside walls in w02 model furthermore as shown in fig 12 the pressure distributed on the outside wall of w01 and w02 models increases with the blockage ratio the pressure distributed over the most part of the outside wall of w01 model is almost identical as illustrated in fig 12 a whereas in fig 12 b the pressure distributed on the outside wall at the both ends of w02 is lower than that distributed on the rest parts this might be caused by the steeper slope at the fore end in w02 model which also leads to the relatively high flow velocity around the fore end of the outside wall in w02 model to investigate the detailed feature of flow field around the aft end of the duct the distribution of the velocity vector around the aft end of w01 and w02 models with different blockage ratios is compared and shown in fig 13 from the left column of fig 13 it is observed that the flow passes through the duct smoothly no flow separation has been observed from the inside wall near the aft end of w01 model therefore in w01 model the pressure distributed over the inside wall of the aft end will not decrease obviously which is consistent with the pressure distribution shown in fig 11 a whereas from the right column of fig 13 it is clearly shown that the flow separates from the inside wall near the aft end of w02 model and eddies are formed in the wake due to sharp changes of curvature in w02 model this phenomenon illuminates the reason why pressure on the inside wall near the aft end of w02 model is apparently lower than that on the inside wall near the fore end as displayed in fig 11 b meanwhile it is illustrated in fig 13 that for the same model with different blockage ratios the region with flow separations is almost identical it indicates that the effect of bank is limited on flow separations around the aft end of inside wall and flow separations are mainly dominated by the shape of duct s inside wall 4 2 effect of free surface the energy converging efficiency of the duct might be affected by the existence of the free surface especially when the clearance between the top of duct and free surface is small to investigate the effect of free surface a non dimensional coefficient of clearance c fs is defined as 20 c f s h f s h where h fs is the clearance between free surface and the top of duct h is the height of the duct the effect of free surface on energy converging efficiency of duct is analyzed by a series numerical simulation for different clearances in cases investigating the effect of free surface five monitoring points for flow velocity are also selected in the central plane of the ducts see fig 6 fig 14 shows the comparison of flow velocity at five monitoring points in w01 and w02 models it can be seen that the varying tendencies of v a and v e v b and v d in each duct are similar due to longitudinal symmetry of the ducts while the tendency of velocity is not exactly the same at the same monitoring point with different range of c fs it is observed that when c fs increases from 0 00 to 0 60 the velocity at all five monitoring points in w01 and w02 models shows a downward trend with the increase of c fs while the flow velocity become stable when c fs increases to 0 60 and the flow velocity for both ducts is almost invariable as c fs keeps increasing which demonstrates that the installation of ducts near free surface can improve duct s energy converging efficiency from the magnitudes of flow velocity it is also observed that v a in w01 model is slightly greater than that in w02 model while the flow velocity at the rest four monitoring points in w01 model is obviously lower than that in w02 model which indicates that the flow velocity at the rotor region is not determined by the flow velocity at inlet of the duct and the inside wall shape plays an important role in the energy converging efficiency of duct in addition for the same c fs it is observed that the velocity relationship of five monitoring points can be described as v c v d v b v e v a in w01 while it is described as v d v b v c v e v a in w02 by comparing variation of the average flow velocity in w01 and w02 models see fig 15 it is observed that the average flow velocity for w02 is larger than w01 while the tendencies of the average flow velocity varying with clearance are approximately the same in both ducts and by comparing all flow curves it can be clearly seen that the slope of the velocity curves are significantly increased as c fs increases accordingly the effects of free surface is notable on the energy converging efficiency of the ducts average energy flux density from point b to c in w01 and w02 models is defined by eq 18 fig 16 shows the curves of average energy flux density of two ducts with various c fs average energy flux density of two types of ducts drops quickly when c fs increases from 0 00 to 0 60 then become nearly invariable as c fs keeps increasing since the energy flux density of two models follows a similar trend with different magnitudes it is found that the effect of free surface on ducts is almost identical meanwhile the inside wall shape of the ducts is important for energy converging efficiency of duct as the energy flux density in w02 model is obviously higher than that in w01 model comparing with the initial energy flux density the increasing rate of the average energy flux density ranges from 44 47 to 63 45 in w01 model and from 68 99 to 92 81 in w02 model correspondingly a conclusion can be drawn that the closer to the free surface the higher energy converging efficiency of duct will be obtained fig 17 presents the streamlines around the top of w01 and w02 models with different c fs since the streamlines captured in the numerical simulations show similar characteristics at c fs 0 40 0 60 and 0 80 the flow field at c fs 0 40 and 0 60 are not shown it can be found in fig 16 that as c fs increases more water will pass over the top of two ducts it also illuminates the energy converging efficiency of the ducts becomes lower as c fs increases which is in consistent with the results shown in fig 16 fig 18 shows velocity contours of w01 and w02 models corresponding to various c fs for w01 model with different c fs the velocity distribution is similar but with different gradients as for w02 model the velocity distribution with different c fs is not fore and aft symmetric it means that the effect of free surface on distribution of flow velocity varies as the inside wall shape changes in both models two peaks of flow velocity appear at 1 4 and 3 4 length of the duct respectively the minimum velocity appears at the aft end of the ducts as c fs increases it is shown that flow velocity decreases fig 19 displays the pressure distribution over the inside wall of the ducts it can be found that the pressure distributed over the inside wall of each duct increases with the increasing of c fs the differences between the pressure distributed over the inside wall of w01 and w02 models are obvious it is illustrated in fig 19 that the pressure distributed over w02 model is slightly higher than that on w01 model the pressure distributed over the inside wall of ducts differs significantly with the shape of the inside wall it is also found that the pressure distributed over the aft end of duct is smaller than that over the fore end of duct for both ducts the difference is more evident in w02 model as shown in fig 19 the flow velocity around the aft end of w02 model in fig 18 is lower than that around the fore end which indicates that the flow separates from the inside wall near aft end of the duct and eddies are formed due to sharp changes of curvature on the inside wall of w02 model as can be seen from fig 20 pressure distributed over the inside wall of w01 and w02 models is more complicated than that over the outside wall due to inside wall s complex shape with the increase of c fs the pressure distributed over the outside wall of ducts shows an upward trend for both ducts at c fs 0 the pressure distributed over the outside wall of ducts is relatively lower and the upper part of ducts suffers higher pressure than the lower part at the same c fs the pressure distributed over the outside wall of w01 model is slightly higher than that over w02 model the pressure distributed over the fore end of outside wall in w02 model is obviously lower than that in w01 model and low pressure areas at the fore end of w02 model are larger compared with w01 model it is because w02 model is thicker and the slope of w02 model is steeper fig 21 shows the wave elevation contours on free surface corresponding to different c fs wave elevation is influenced by ducts much more significantly at c fs 0 00 than at c fs 0 05 to 0 80 and the impact decreases gradually with the increase of c fs as c fs increases to 0 80 the wave elevation becomes invisible and the free surface effect can be neglected besides it should be noted that the height of wave generated by w02 model is higher than that by w01 model at the same c fs 5 conclusion a series of 3d numerical simulations of viscous flow fields around ducts are conducted to study the effects of bank and free surface on energy converging efficiency of ducts flow velocity and energy flux density are fully captured and the distribution of the velocity pressure and streamlines around ducts are also presented based on the numerical results some conclusions are drawn as follows 1 the inside wall shape of the duct is essential for energy converging efficiency of the duct 2 the bank effect on energy converging efficiency of a duct is significant it varies with the inside wall shape the energy converging efficiency of the duct can be improved by increasing the blockage ratio therefore higher energy converging efficiency could be obtained by arranging arrays of ducts side by side in a certain channel 3 the effect of free surface on energy converging efficiency of a duct is very important smaller c fs will induce higher energy converging efficiency therefore it is suggested to install the ducts close to free surface in order to improve the energy converging efficiency in practice in order to improve ducts performance the factors like bank free surface and shape of ducts inside wall need to be taken into consideration credit authorship contribution statement wang hua ming conceptualization methodology resources qu xiao kun validation visualization chen lin formal analysis writing review editing investigation tu lu qiong software writing original draft wu qiao rui data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was sponsored by the national natural science foundation of china no 51809236 zhejiang provincial natural science foundation grant nos ly17e090002 lq17e090003 and the doctoral scientific research foundation of zhejiang ocean university project and the open foundation from key laboratory of offshore engineering technology of zhejiang 
21742,installation of the channeling device around a tidal turbine can stabilize flow field increase flow velocity and improve energy utilization efficiency significantly the application of channeling devices on improving the efficiency of vertical axis tidal turbines in restricted water has hardly been investigated in the present study two ducts with different inside wall shapes have been taken as examples to investigate the bank and free surface effects on energy converging efficiency of the ducts around a vertical axis tidal current turbine in shallow and narrow water the three dimensional viscous flow field around the ducts is simulated by using cfd technology rans equations are employed as viscous flow solvers and the realizable two layer k ε turbulence model is applied to predict the energy converging efficiency of the ducts investigation of grid dependence is conducted and grid independent solution is obtained by analyzing the numerical results of several sets of computational grids for the duct around the vertical axis tidal current turbine near or piercing the free surface of the water in some cases volume of fluid vof method is employed to capture the free surface based on the numerical results it is known that the average energy flux density in w02 model is much larger than that in w01 model so it can be concluded that the inside wall shape of the ducts dominates the energy converging efficiency of the ducts in great extent and bank effect on energy converging efficiency of the duct varies with inside wall shapes of the duct what s more the free surface plays an important role in the energy converging efficiency of the ducts and smaller clearance between free surface and the top of duct will induce higher energy converging efficiency keywords energy converging efficiency duct of vertical axis turbine restricted water numerical simulation effect of free surface bank effect nomenclature a cross sectional area of the ducts m2 a c cross sectional area of the channel m2 b blockage ratio c 2 constant c 1ε constant c fs clearance coefficient c bd clearance between bank and outside wall of duct e energy flux density kg s3 e x relative error for f x e y relative error for f y f x longitudinal force n f y lateral force n g b turbulent kinetic energy production caused by buoyancy kg m3 g k turbulent kinetic energy production caused by an average velocity gradient kg m3 h height of the ducts m h fs clearance between free surface and the top of ducts m k turbulent kinetic energy m2 s2 l length of the ducts m p relative pressure pa q source term kg m2 s2 re reynolds number r v increasing rate of flow velocity s modulus of the mean strain rate tensor s k user specified source term kg m3 s ε user specified source term kg m3 s t thickness of the ducts m u velocity component of x direction m s u time averaged velocity m s v velocity component of y direction m s v flow velocity m s v b d average flow velocity from monitoring point b to d m s w velocity component of z direction m s w width of the ducts m y m the effect of fluctuating expansion of turbulent on dilatation dissipation in compressible turbulent kg m3 y dimensionless wall distance greek symbols α volume fraction σ k turbulent prandtl number of turbulent kinetic energy k σ ε turbulent prandtl number of turbulent dissipation rate ε ε turbulent dissipation rate m2 s3 μ kinematic viscosity of liquid pa s ρ liquid density kg m3 τ reynolds stress tensor kg m s2 subscripts avg average acronyms 2d two dimensional 3d three dimensional cfd computational fluid dynamic fs free surface rans reynolds averaged navier stokes simple semi implicit method for pressure linked equations bd bank and outside wall of duct vof volume of fluid 1 introduction with the continued consumption of fossil energy development and utilization of renewable energy have been the focus of research in the field of energy tidal current energy as a very promising renewable energy resource is predictable with high energy flux density and has been widely studied the earth is abundant in tidal current energy resources especially in the channel as a country with long coastal line and wide sea area china has rich tidal current resources however the distribution of the potential resources is not homogenous according to the data collected the average tidal current energy in china is estimated to be about 8 2 gw among which 78 6 is distributed in east china sea gao et al 2015 zheng et al 2015 as tidal current energy captured by a turbine is proportional to the flow velocity cubed the increase of flow velocity will significantly lead to the improvement on energy generating efficiency besides the flow velocity is also closely associated with start up behavior of a turbine as the turbine can hardly start at low flow velocity han et al 2013 bachant and wosnik 2015 day et al 2015 in order to lower turbine s demand on tidal current velocity the channeling devices with the ability of increasing flow velocity have attracted extensive concerns throughout research institutions all over the world although the application of ducted devices on vertical axis turbines is not as wide as those applied on horizontal axis turbines some significant progresses have been achieved recently ponta and dutt 2000 proposed a novel floating tidal current power generating system with a ducted device installed around a vertical axis turbine in their research the application of duct is recommended to improve flow field environment reduce equipment costs and prolong service life of device in order to study the effects of brim height and outside body shape on performance of ducts setoguchi et al 2004 conducted experiments in a low speed wind tunnel to investigate the effects of brim height and outside body shape on the performance of a two way diffuser experiments show that the outside body shape plays an important role in increasing diffuser performance liu 2007 summarized the progress of ducts and analyzed the effects of distance between duct and turbine length and width of duct on energy converging efficiency of duct via numerical simulation with respect to two types of molded lines finally a duct with relatively high efficiency was proposed in his research considering the flood and ebb of current sun 2008 presented six different bi directional ducts which can adapt to the reciprocating characteristics of tides through experimental measurements and numerical simulations load rules of six ducts and their effects on energy generating performance of turbine were illustrated and hydrodynamic interference laws between turbine and different types of ducts were concluded ponta and jacovkis 2008 proposed a new floating energy generating system with high utilization rate of tides duct was employed in that system to increase tidal current velocity and the gearbox was eliminated under low velocity condition khan et al 2009 summarized the state of the art of tidal current power generating system including the types of turbine and duct according to their analysis the application of duct would be highlighted in the future development of tidal current power generating system as is known the duct does have notable effects on converging fluids and stabilizing flow field currently most of the researchers focus on the performance of various vertical and horizontal axis turbines fernandes and rostami 2015 marsh et al 2015 yang et al 2016 akimoto et al 2013 li et al 2015 lust et al 2013 churchfield et al 1985 while only a few work discussed the effect of the duct on vertical axis turbines kirke 2011 besides most of the existing studies were based on two dimensional 2d numerical simulations maître et al 2013 zanette et al 2010 in which the tidal current power generating devices were assumed to be fixed in deep and wide water and the effects of environmental factors on energy converging efficiency of ducts have seldom been investigated in fact there are abundant tidal energy resources in some restricted waters in which both the duct and the vertical axis tidal current turbine would be near the bank and free surface i̇n this case the viscous flow around the duct near the bank and free surface in restricted water is essentially a three dimensional problem and it is necessary to use a 3d numerical approach to investigate the effects of bank and free surface on energy converging efficiency of the duct 2 description of ducts for vertical axis tidal current turbine the cross sectional area of duct reduces from inlet of the duct to front of the turbine and gradually expands from aft end of the turbine to outlet flow velocity increases progressively with the cross sectional area of the fore body of duct decreases thus the energy of tidal current can be converged meanwhile the gradually increase of cross sectional area of the after body of duct can reduce flow velocity in the wake which is beneficial to stabilize the wake flow field and avoid boundary layer separation existing diverse molded lines of ducts have unique energy converging efficiency sun 2008 modified the hyperbolic curves and vickers curves and proposed six different molded lines see fig 1 based on parameters including contraction ratio flow ratio flow velocity ratio impact force coefficient etc the performance of different ducts on increasing flow velocity and stabilizing flow field are analyzed in detail by 2d numerical simulations however effects of bank and free surface on energy converging efficiency of duct were not considered in his work in the present study the 3d viscous flow field around the duct of a vertical axis current turbine is simulated numerically the flow velocity in the duct is monitored during numerical calculations and variations of flow velocity are considered the effects of bank and free surface on energy converging efficiency of duct are summarized based on the numerical results to study the energy converging performance of different types of duct two typical models namely w01 and w02 are studied in detail the top and side views are shown in fig 2 in the computational domain the longitudinal direction of the duct is parallel to x axis the transverse direction of the duct is parallel to y axis and the origin of the coordinate coincides with the center of the duct tidal current in the numerical simulations flows towards positive x axis the principal dimensions of the ducts are length l 6 00 m width w 3 50 m height h 6 00 m thickness of w01 model t 1 0 39 m thickness of w02 model t 2 0 54 m and t 3 0 39 m respectively 3 numerical methods on viscous flow around the duct some researchers alidadi and calisal 2014 fleming and willden 2016 have investigated the performance of the ducted tidal current turbine but failed to analysis the specific role that duct plays the effects of bank and fee surface on duct were also neglected in the present work the viscous flow field around the duct is simulated by cfd code star ccm by solving the continuity equation and reynolds averaged navier stokes rans equations the effects of bank of a narrow channel as well as the free surface effect on energy converging efficiency of two ducts are analyzed 3 1 governing equations of incompressible viscous flow continuity equation of incompressible fluid can be written as 1 u x v y w z 0 where u v and w represent the velocity component in x y and z direction respectively reynolds averaged navier stokes rans equations for momentum transport is 2 ρ u i t ρ u j u i x j p x i x j μ u i x j ρ u i u j where u i and u j are time averaged velocity p is time averaged relative pressure ρ is liquid density μ is the dynamic viscosity of liquid ρ u i u j is the reynolds stress tensor in the present study ambient temperature is set at 20 c correspondingly during numerical calculations the water density is 1030 kg m3 and kinematic viscosity of water is 1 010 10 3 pa s considering the velocity of the tidal current v 1 0 m s and the characteristic size of ducts l 6 00 m reynolds number can be calculated by 3 r e v l μ ρ 1 00 m s 6 00 m 1 010 10 3 p a s 1030 k g m 3 6 119 10 6 reynolds averaged navier srokes method is one of the most popular approaches among viscous flow solvers day et al 2015 several turbulence models such as spalart allmaras turbulence model k epsilon turbulence model k omega turbulence model are usually employed to satisfy the governing equations according to sun 2008 gretton 2009 the widely used k epsilon turbulence model with good converging property is applied to simulate the viscous flow around the duct besides considering the condition of simulation and the characteristics of turbulence models realizable k epsilon two layer model is selected in the present numerical calculation two layer approach is used to divide the computation into two layers the layer next to the wall and the near wall layer that contribute to resolve the viscous sublayer it is demonstrated that this approach is more empirical than the damping function approach and the results are often equally satisfactory or better meanwhile the realizable k epsilon turbulence model can satisfy certain mathematical constraints on the normal stresses consistent with the physics of turbulence transport equations of k and ε in realizable k epsilon model 4 ρ k t ρ k u i x i x j μ μ t σ k k x j g k g b ρ ε υ m s k 5 ρ ε t ρ ε u i x i x j μ μ t σ ε ε x j ρ c 1 s ε ρ c 2 ε 2 k v ε c 1 ε ε k c 3 ε g b s ε 6 c 1 max 0 43 η η 5 7 η s k ε g k is the turbulent kinetic energy production caused by an average velocity gradient g b is the turbulent kinetic energy production caused by buoyancy y m represents the effect of fluctuating expansion of turbulent on dilatation dissipation in compressible turbulent c 2 and c 1ε are constant σ k and σ ε are turbulent prandtl number of turbulent kinetic energy k and turbulent dissipation rate ε s k and s ε are the user specified source terms as mentioned above the realizable k epsilon two layer model is applied in all simulation cases and all y wall treatment is used with this turbulent model to optimize the simulations all y wall treatment can not only simulates the way high y wall treatment does in dealing with coarse grid but simulates the way low y wall treatment does in dealing with fine grid since cases have either fine grid around boundary layer of duct or coarse grid on peripheral flow field all y wall treatment is an optimum choice for getting ideal numerical results besides not like high y wall treatment and low y wall treatment the requirements of wall y value are less stringent on all y wall treatment in all cases involved y value is about 40 which has met the requirement of all y wall treatment in order to investigate free surface effect on efficiency volume of fluid vof method is employed to capture the motion of free surface in addition eulerian multiphase model is applied to control the physical setup of air and water between free surface basic vof model equations 8 ρ i ρ i α i 9 μ i μ i α i where the subscript i denotes different phases α i is the volume fraction of each phase i for single phase flows α i is automatically set to 1 while ρ i and μ i are the density and molecular viscosity corresponding to phase i 10 α i v i v numerical simulations are performed by an implicit unsteady and separated flow solver so as to achieve stable and better converging results yang and lawn 2011 the segregated flow solver controls the update of solution according to simple algorithm and also controls velocity and pressure solver besides the convection term is discretized by a second order upwind scheme and diffusive terms are discretized by the central differencing scheme under relaxation factors in all equations are set to 0 8 except for the pressure term and under relaxation factor of the pressure term is 0 2 in the present numerical simulations the time step is 0 001 s with a second order scheme for time integration which is small enough to obtain convergent results 3 2 computational domain and boundary conditions setting fig 3 illustrates the setting of boundary of the computational domain the length of computational domain is 5 0l l in the upstream side and 3 0l downstream in cases investigating the effect of bank the width of computational domain is 2 0w 4 0w 8 0w 10 0w and 20 0w respectively the height is h and the bottom of duct is level with bottom boundary while in cases investigating the effect of free surface the width of computational domain is 6 0w the height is 3 0h the distance between free surface and the top of duct ranges from 0 m to 4 8 m and the bottom of duct is 6 0 m higher than bottom boundary in all cases the boundary condition for the inlet is set to be velocity inlet and the outlet is set to be pressure outlet in the case studies of bank effect the side wall boundary condition are set to be no slip wall and the top and bottom boundaries are set to be symmetrical in the case studies of the free surface effect the side top and bottom boundary conditions are set to be velocity inlet 3 3 grid dependence study grid distribution for w01 model is given in fig 4 zones with local grid refinement are used around the duct five prism layers are attached to the surface of the duct to capture the detailed fluid flow features around the duct as shown in fig 4 b systematic search for grid independent results forms an essential part of a high quality numerical study malipeddi and chatterjee 2012 the only way to eliminate errors due to the coarseness of a grid is to perform a grid dependence study a procedure of successive refinement of an initially coarse grid is performed until some key results change within acceptable errors and then the simulation can be regarded as grid independent in the present study of grid dependence longitudinal force f x and lateral force f y acting on the duct are calculated by using several sets of grids furthermore since the duct studied is symmetrical and the resultant lateral force on the duct is zero f y mentioned above is taken as the lateral force acting on one side of the duct for comparative purpose and relative errors e x and e y can be evaluated by 11 e x f x i f x i 1 f x i 1 100 12 e y f y i f y i 1 f y i 1 100 where i is the case number different grid densities are shown in table 1 table 2 presents the results obtained by using different grid densities by comparing the numerical results in case 1 case 2 and case 3 it can be found that e x and e y are large in case 3 and case 4 the change of grid number does not cause significant variations of the numerical results therefore it is found that numerical results are convergent when the grid number reaches approximately 1 75 million in order to save computation time and storage space the grid size used in case 3 is adopted and it is fine enough to guarantee independent convergent result 4 influence factors on energy converging efficiency of duct 4 1 bank effect the width of the fluid domain can affect the fluids between bank and outside wall of duct the decrease of the width will lead to reducing of clearance c bd see fig 5 which would result in blockage effect and thereafter influences the energy converging efficiency of the duct based on the numerical results the bank effect on energy converging efficiency of the duct is analyzed a non dimensional blockage ratio b is employed and it is defined as 13 b a a c where a w h and a c represents the cross section area of the channel in order to carry out extensive studies on the flow velocity of w01 and w02 models five monitoring points are selected in the central plane of ducts see fig 6 considering that the rotor region is of most interests three points namely point b c and d are selected to monitor the flow velocity at rotor region besides point a and e are set to monitor the inlet and outlet flow velocity of duct for five different blockage ratios the flow velocity at all the monitoring points is presented in tables 3 and 4 note that v b d represents the average flow velocity from point b to d which is defined as 14 v b d v b v c v d 3 to study the bank effect on energy converging efficiency of the duct figs 7 and 8 shows the changing tendency of flow velocity with blockage ratio at all monitoring points in w01 and w02 models it is obvious that v a and v e v b and v d in the same model present similar varying tendencies while the tendency of velocity is not exactly the same at the same monitoring point with different range of b it can be seen that when b increases from 0 050 to 0 500 the flow velocity at five monitoring points in w01 and w02 models increases gradually with the increase of b which indicates that the effect of the bank wall is beneficial for energy converging efficiency of the ducts at five monitoring points when b increases from 0 050 to 0 125 the flow velocity in w01 and w02 models varies very slowly as b increases to 0 500 the flow velocity varies more rapidly compared with the flow velocity in different model the increase of the flow velocity in w02 model is more significant than w01 model which is result from the different inside wall shapes of the duct in addition for the same b it is observed that the velocity relationship of five monitoring points can be described as v c v d v b v a v e in w01 while it is described as v d v b v c v e v a in w02 by comparing variation of the average flow velocity in w01 and w02 models see fig 8 it is observed that the increasing rate of the average flow velocity for w02 is larger than w01 by comparing all curves of flow velocity of w02 it can be seen that the flow velocities begin to increase rapidly when b reaches 0 25 though the increment of the flow velocity is still relatively small accordingly the effects of bank is notable on the energy converging efficiency of the ducts besides it is found that the bank effect on the energy converging efficiency of the ducts with different inner wall shape is obviously different by comparing the velocity curves of w01 and w02 to study the effect of bank on energy converging efficiency of the duct more directly the energy flux density e is given 17 e 1 2 ρ v 3 for the initial flow velocity v 0 1 0 m s the energy flux density of initial tidal current is 18 e 0 1 2 ρ v 0 3 1 2 1030 1 0 3 515 0 k g s 3 average energy flux density from point b to d is defined as 19 e a v g 1 3 e b e c e d where e b e c and e d is the energy flux density at point b c and d respectively it is presented in fig 9 that as blockage ratio increases the average energy flux density from point b to d increases in w02 model but is almost constant in w01 model from the flow velocities in tables 3 and 4 we can get fig 9 e avg is 1104 44 kg s3 and 1117 86 kg s3 respectively for blockage ratio b 0 05 0 5 in w01 and it is 1259 94 kg s3 and 1329 25 kg s3 respectively for blockage ratio b 0 05 0 5 in w02 compared with the initial energy flux density e 0 515 0 kg s3 the average energy flux density is increased from 114 47 to 117 06 in w01 model and from 144 66 to 158 10 in w02 model it can be concluded that the average energy flux density in w02 model is much larger than that in w01 model the bank effect on energy converging efficiency of the duct varies with inside wall shapes of the duct velocity contours of w01 and w02 models corresponding to various blockage ratios are shown in fig 10 an evident acceleration zone can be observed from the fore end to the transverse plane of duct because of duct s energy converging effect for both ducts two peaks of flow velocity appear at 1 4 and 3 4 length of duct respectively at the same time the velocity of the two peaks increases obviously with the increase of the blockage ratio especially in w02 in spite of similar distribution of flow velocity for two ducts with different blockage ratios the gradients are different it means that the effect of bank on velocity distribution will vary obviously with the change of blockage ratio for different inside shape of the duct furthermore it can be seen clearly that the flow velocity at the rotor region in w01 model is almost the same but in w02 model it increases obviously as the blockage ratio increases therefore with different inside wall shapes the bank could play different roles in duct s energy converging efficiency fig 11 and fig 12 show the pressure distribution on the inside and outside walls of w01 and w02 models with different blockage ratios respectively from fig 11 it is found that the distribution of the pressure on the inside wall of each duct is similar regardless of blockage ratio however the differences between w01 and w02 models are evident the pressure on inside wall near the fore end of w02 model is much higher than that on w01 model while it can also be seen that the pressure on the inside wall near aft end of w02 the is lower than that on w0l and the pressure on the inside wall of w02 is much lower than that on w01 especially near 1 4 and 3 4 length of duct furthermore as shown in fig 11 b the pressure distributed on the inner wall of entrance of w02 model increases slightly with the increase of the blockage ratio but decreases obviously at 1 4 and 3 4 length of duct comparing fig 11 with fig 12 it is revealed that the pressure distribution on duct s outside wall is more uniform than that on inside wall it is also illustrated in fig 12 that the pressure distributed on the outside wall of w02 model is significantly lower than that on w01 model at different blockage ratios which indicates that the flow velocity between the bank and outside wall in w02 model is higher than that in w01 model this is caused by the differences on the thickness of two types of ducts namely t 1 and t 2 specifically as t 2 is greater than t 1 more fluid is passing through the clearance between the bank and outside walls in w02 model furthermore as shown in fig 12 the pressure distributed on the outside wall of w01 and w02 models increases with the blockage ratio the pressure distributed over the most part of the outside wall of w01 model is almost identical as illustrated in fig 12 a whereas in fig 12 b the pressure distributed on the outside wall at the both ends of w02 is lower than that distributed on the rest parts this might be caused by the steeper slope at the fore end in w02 model which also leads to the relatively high flow velocity around the fore end of the outside wall in w02 model to investigate the detailed feature of flow field around the aft end of the duct the distribution of the velocity vector around the aft end of w01 and w02 models with different blockage ratios is compared and shown in fig 13 from the left column of fig 13 it is observed that the flow passes through the duct smoothly no flow separation has been observed from the inside wall near the aft end of w01 model therefore in w01 model the pressure distributed over the inside wall of the aft end will not decrease obviously which is consistent with the pressure distribution shown in fig 11 a whereas from the right column of fig 13 it is clearly shown that the flow separates from the inside wall near the aft end of w02 model and eddies are formed in the wake due to sharp changes of curvature in w02 model this phenomenon illuminates the reason why pressure on the inside wall near the aft end of w02 model is apparently lower than that on the inside wall near the fore end as displayed in fig 11 b meanwhile it is illustrated in fig 13 that for the same model with different blockage ratios the region with flow separations is almost identical it indicates that the effect of bank is limited on flow separations around the aft end of inside wall and flow separations are mainly dominated by the shape of duct s inside wall 4 2 effect of free surface the energy converging efficiency of the duct might be affected by the existence of the free surface especially when the clearance between the top of duct and free surface is small to investigate the effect of free surface a non dimensional coefficient of clearance c fs is defined as 20 c f s h f s h where h fs is the clearance between free surface and the top of duct h is the height of the duct the effect of free surface on energy converging efficiency of duct is analyzed by a series numerical simulation for different clearances in cases investigating the effect of free surface five monitoring points for flow velocity are also selected in the central plane of the ducts see fig 6 fig 14 shows the comparison of flow velocity at five monitoring points in w01 and w02 models it can be seen that the varying tendencies of v a and v e v b and v d in each duct are similar due to longitudinal symmetry of the ducts while the tendency of velocity is not exactly the same at the same monitoring point with different range of c fs it is observed that when c fs increases from 0 00 to 0 60 the velocity at all five monitoring points in w01 and w02 models shows a downward trend with the increase of c fs while the flow velocity become stable when c fs increases to 0 60 and the flow velocity for both ducts is almost invariable as c fs keeps increasing which demonstrates that the installation of ducts near free surface can improve duct s energy converging efficiency from the magnitudes of flow velocity it is also observed that v a in w01 model is slightly greater than that in w02 model while the flow velocity at the rest four monitoring points in w01 model is obviously lower than that in w02 model which indicates that the flow velocity at the rotor region is not determined by the flow velocity at inlet of the duct and the inside wall shape plays an important role in the energy converging efficiency of duct in addition for the same c fs it is observed that the velocity relationship of five monitoring points can be described as v c v d v b v e v a in w01 while it is described as v d v b v c v e v a in w02 by comparing variation of the average flow velocity in w01 and w02 models see fig 15 it is observed that the average flow velocity for w02 is larger than w01 while the tendencies of the average flow velocity varying with clearance are approximately the same in both ducts and by comparing all flow curves it can be clearly seen that the slope of the velocity curves are significantly increased as c fs increases accordingly the effects of free surface is notable on the energy converging efficiency of the ducts average energy flux density from point b to c in w01 and w02 models is defined by eq 18 fig 16 shows the curves of average energy flux density of two ducts with various c fs average energy flux density of two types of ducts drops quickly when c fs increases from 0 00 to 0 60 then become nearly invariable as c fs keeps increasing since the energy flux density of two models follows a similar trend with different magnitudes it is found that the effect of free surface on ducts is almost identical meanwhile the inside wall shape of the ducts is important for energy converging efficiency of duct as the energy flux density in w02 model is obviously higher than that in w01 model comparing with the initial energy flux density the increasing rate of the average energy flux density ranges from 44 47 to 63 45 in w01 model and from 68 99 to 92 81 in w02 model correspondingly a conclusion can be drawn that the closer to the free surface the higher energy converging efficiency of duct will be obtained fig 17 presents the streamlines around the top of w01 and w02 models with different c fs since the streamlines captured in the numerical simulations show similar characteristics at c fs 0 40 0 60 and 0 80 the flow field at c fs 0 40 and 0 60 are not shown it can be found in fig 16 that as c fs increases more water will pass over the top of two ducts it also illuminates the energy converging efficiency of the ducts becomes lower as c fs increases which is in consistent with the results shown in fig 16 fig 18 shows velocity contours of w01 and w02 models corresponding to various c fs for w01 model with different c fs the velocity distribution is similar but with different gradients as for w02 model the velocity distribution with different c fs is not fore and aft symmetric it means that the effect of free surface on distribution of flow velocity varies as the inside wall shape changes in both models two peaks of flow velocity appear at 1 4 and 3 4 length of the duct respectively the minimum velocity appears at the aft end of the ducts as c fs increases it is shown that flow velocity decreases fig 19 displays the pressure distribution over the inside wall of the ducts it can be found that the pressure distributed over the inside wall of each duct increases with the increasing of c fs the differences between the pressure distributed over the inside wall of w01 and w02 models are obvious it is illustrated in fig 19 that the pressure distributed over w02 model is slightly higher than that on w01 model the pressure distributed over the inside wall of ducts differs significantly with the shape of the inside wall it is also found that the pressure distributed over the aft end of duct is smaller than that over the fore end of duct for both ducts the difference is more evident in w02 model as shown in fig 19 the flow velocity around the aft end of w02 model in fig 18 is lower than that around the fore end which indicates that the flow separates from the inside wall near aft end of the duct and eddies are formed due to sharp changes of curvature on the inside wall of w02 model as can be seen from fig 20 pressure distributed over the inside wall of w01 and w02 models is more complicated than that over the outside wall due to inside wall s complex shape with the increase of c fs the pressure distributed over the outside wall of ducts shows an upward trend for both ducts at c fs 0 the pressure distributed over the outside wall of ducts is relatively lower and the upper part of ducts suffers higher pressure than the lower part at the same c fs the pressure distributed over the outside wall of w01 model is slightly higher than that over w02 model the pressure distributed over the fore end of outside wall in w02 model is obviously lower than that in w01 model and low pressure areas at the fore end of w02 model are larger compared with w01 model it is because w02 model is thicker and the slope of w02 model is steeper fig 21 shows the wave elevation contours on free surface corresponding to different c fs wave elevation is influenced by ducts much more significantly at c fs 0 00 than at c fs 0 05 to 0 80 and the impact decreases gradually with the increase of c fs as c fs increases to 0 80 the wave elevation becomes invisible and the free surface effect can be neglected besides it should be noted that the height of wave generated by w02 model is higher than that by w01 model at the same c fs 5 conclusion a series of 3d numerical simulations of viscous flow fields around ducts are conducted to study the effects of bank and free surface on energy converging efficiency of ducts flow velocity and energy flux density are fully captured and the distribution of the velocity pressure and streamlines around ducts are also presented based on the numerical results some conclusions are drawn as follows 1 the inside wall shape of the duct is essential for energy converging efficiency of the duct 2 the bank effect on energy converging efficiency of a duct is significant it varies with the inside wall shape the energy converging efficiency of the duct can be improved by increasing the blockage ratio therefore higher energy converging efficiency could be obtained by arranging arrays of ducts side by side in a certain channel 3 the effect of free surface on energy converging efficiency of a duct is very important smaller c fs will induce higher energy converging efficiency therefore it is suggested to install the ducts close to free surface in order to improve the energy converging efficiency in practice in order to improve ducts performance the factors like bank free surface and shape of ducts inside wall need to be taken into consideration credit authorship contribution statement wang hua ming conceptualization methodology resources qu xiao kun validation visualization chen lin formal analysis writing review editing investigation tu lu qiong software writing original draft wu qiao rui data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was sponsored by the national natural science foundation of china no 51809236 zhejiang provincial natural science foundation grant nos ly17e090002 lq17e090003 and the doctoral scientific research foundation of zhejiang ocean university project and the open foundation from key laboratory of offshore engineering technology of zhejiang 
21743,the purpose of this study is to evaluate the ability of the coupled level set and volume of fluid clsvof method to reproduce violent three dimensional 3d free surface deformation induced by different types of dambreak problems a 3d clsvof based numerical solver is developed and the finite difference method is adopted to discretize the fluid domain by applying these methods the vof advection equation is solved under the tangent of hyperbola framework to capture the interactions with the weighted linear interface calculation scheme thinc wlic the ocrweno scheme is employed to accurately handle the ls advection equation and the navier stokes equations are discretized by a projection method for dealing with fluid structure interactions the direct forcing immersed boundary method is employed the developed numerical solver is applied to model free surface evolution in a variety of dambreak experiments good agreement is obtained between the numerical simulation and experimental results for each case thus proving the suitability of the proposed numerical approach for the simulation of violent free surface deformation the numerical solver developed in this paper has potential for reproducing strongly nonlinear free surface phenomena in other ocean engineering applications keywords coupled level set and volume of fluid method immersed boundary method dambreak flow violent free surface deformation 1 introduction simulation of the behavior of free surfaces in two phase flows is an important task in a wide range of fields including the study of ocean surface waves ocean engineering coastal engineering hydrological engineering and the study of channel flows in particular accurate simulation of strong free surface deformations is greatly desirable from both basic scientific and engineering perspectives based on the commonly used euler description the volume of fluid vof hirt and nichols 1981 and level set ls osher and fedkiw 2001 2003 techniques are the two main mathematical models currently used to handle free surface deformation the vof technique has attracted much attention for the numerical modeling of free surfaces in two phase flow because of its advantage with regard to mass conservation marsooli and wu 2014 vof methods can be categorized as either geometrical or algebraic interface simulations since they involve geometrical reconstruction geometrical vof models often require the use of piecewise linear interface calculation plic parker and youngs 1992 various algebraic vof methods have been developed for example the tangent of hyperbola for interface capturing thinc scheme proposed by xiao et al xiao et al 2005 which implements a hyperbolic tangent function to compute the numerical flux of a fluid fraction function and provides a conservative solution for this function even in the presence of extremely distorted interfaces of arbitrary complexity using the simple line interface calculation slic reconstruction method yokoi 2007 developed a scheme to approximate multidimensional fluxes while taking account of interface orientation schemes of this type are called vof wlic schemes yokoi 2007 proposed the use of an interface orientation dependent weight between the original thinc scheme xiao et al 2011 and the first order donor cell scheme and was thereby able to significantly improve the geometric accuracy of the original thinc scheme ls based models are increasingly being used to simulate interfaces between two phase flows yang et al 2014 zhu et al 2016 owing to a number of advantages such as their ability to define an interface between water simply by the zero value of a continuous signed distance function in addition topology changes are conveniently addressed by implementing a high order advection scheme kim and liou 2011 however typical ls based methods are limited by two important issues the first of these is numerical dissipation and dispersion which cause the predicted ls solutions to deteriorate in some cases one solution that has been suggested to deal with this problem is the use of high order schemes such as essentially non oscillatory eno based or weighted eno weno based schemes to improve the accuracy of the advection process and thus preserve the interface shape hermann 2014 salih and moulic 2009 the second issue is a violation of mass property conservation with a small amount of mass being gained or lost when the zero ls changes during the initialization procedure luo et al 2015 one feasible albeit advanced technique to overcome the disadvantages mentioned above is the use of a hybrid approach such as a coupled ls and vof clsvof method wang and tong 2010 wang et al 2012 balczar et al 2016 yokoi 2013 clsvof methods that combine the individual advantages of the vof and ls methods result in an improvement of mass conservation and are able to accurately calculate the curvature of the interface these hybrid approaches use a vof function to deal with the free surface and a smoothed ls function to determine its geometrical deformation an improved reinitialization procedure for the ls function is also usually adopted chakraborty et al 2013 ningegowda and premachandran 2014 such methods have been widely implemented in high precision simulations of a droplet impacting on a dry surface yokoi et al 2009 bubble growth and detachment albadawi et al 2013 plunging breaking waves koo et al 2012 and dambreak problems li and yu 2019 peskin 1972 presented an immersed boundary method to make it easier to deal with complex interfaces and moving boundaries on account of its advantages in dealing with complex surface boundaries moving boundaries and fluid structure interaction fsi in particular this method has proved in recent years to be of great value in dealing with problems involving fsi the continuous force method and the discrete force method mittal and iaccarino 2005 are two classic types of immersed boundary method in the continuous force method a feedback force term usually in analytic form is added to the continuity equation before discretization of the navier stokes n s equations which makes the method useful for simulating elastic boundary problems such as the deformation and motion of a biofilm under the action of a flow field the discrete force method on the other hand obtains the feedback force through the discretized n s equations usually without an analytical expression and is applicable to simulation of the interaction between a rigid body and a fluid ghias et al 2007 in this paper we develop a high accuracy finite difference based three dimensional 3d numerical model that combines the clsvof and immersed boundary methods in fortran and c programs to simulate violent free surface deformation associated with the physical phenomena that occur in different kinds of dambreak problems in the original clsvof method surface normals were computed with a volume fraction function yokoi 2007 since accurate calculation of the normal vector is the key issue we develop a clsvof method that adopts an ls function i e a distance function instead of a vof function to calculate the normal vector and we then combine this approach with an immersed boundary method to analyze the fsi and simulate the violent free surface deformation that it induces four different types of dambreak experiments are performed to test the ability combined method to capture the violent free surface deformation the paper is organized as follows in section 2 the numerical algorithm is presented and the ls and vof methods and the corresponding combined technique are discussed the treatment of the interface in the splitting algorithm with the clsvof equations is described in section 3 the immersed boundary method is implemented to simulate the solid geometric boundaries and relevant boundary conditions in section 4 numerical verification is performed according to an experiment to validate the accuracy of the developed numerical solver based on a mesh convergence study and mass conservation analysis in section 5 a partial dambreak flow problem is investigated this problem is used to test the ability of the clsvof method to handle relatively slow and weakly nonlinear flow behavior in section 6 a strongly nonlinear dambreak flow problem is investigated to test the ability of the clsvof method to address extremely nonlinear phenomena in section 7 the problem of dambreak flow over a tall obstacle is investigated to assess the changes in the free surface and the interactions between waves and onshore buildings finally conclusions are presented in section 8 2 governing equations 2 1 ls method the ls evolution equation is 1 φ t u φ 0 where φ is the ls function we adopt a signed distance function d that is positive in water and negative in air and has the following form 2 φ x y z t d for x y z in water 0 for x y z on the free surface d for x y z in air the reinitialization process necessary for φ to remain a signed distance function involves solving the following reinitialization equation 3 φ τ s φ 0 1 φ λ δ φ φ where τ is the pseudotime of the iteration and φ 0 is the ls function before reinitialization λ and the delta function δ φ are given by 4 λ ω δ φ s φ 0 1 φ d ω ω δ 2 φ φ d ω 5 δ φ 1 2 ε 1 cos π φ ε if φ ε 0 otherwise where s φ 0 is the smoothed signed function 2 2 vof method a characteristic function χ of the following form is adopted yokoi 2007 6 χ t u χ χ u 0 with 7 χ x y z t 1 for x y z in water 0 for x y z in air as an integral of the characteristic phase function χ the following fraction function c is adopted 8 c i j k 1 δ x δ y δ z 0 δ x 0 δ y 0 δ z χ x y z t d x d y d z 2 3 clsvof method in spite of conserving mass well the vof method still has difficulties in capturing the geometric properties of the interface while the ls method gives a good description of these geometric properties through a continuous ls function φ but does not guarantee mass conservation hence a clsvof method that incorporates both the vof method and the ls method is proposed here to implement both mass conservation and an accurate geometric description in the clsvof algorithm first of all the governing equations of the ls function φ and the volume fraction c are solved in the time interval from t n to t n 1 to give φ n 1 and c n 1 interface reconstruction is then performed to confirm that the interfaces predicted from φ and c respectively are similar to each other the reconstruction procedure uses an intermediate function 9 ψ 2 c n 1 1 such that the isoline ψ 0 represents the position of the interface corresponding to the position represented by c n 1 1 2 after this 10 ψ τ s ψ 0 1 ψ is solved until ψ reaches a steady state solution at the interface and this solution is the exact value of ψ at the interface next another intermediate ls function 11 φ n 1 ψ n 1 if φ n 1 ε φ n 1 otherwise is constructed to confirm that φ n 1 and c n 1 represent the same interface position finally 12 φ n 1 τ s φ 0 n 1 1 φ n 1 λ δ φ n 1 φ n 1 is solved until a steady state solution φ n 1 is reached with the discontinuity at φ n 1 ε vanishing 2 4 n s equations the two phase incompressible viscous flows are governed by the n s equations 13 u 0 14 u t u u 1 ρ p 1 ρ 2 μ d g where u is the velocity vector t is the time p is the pressure d is the deformation tensor and g is the acceleration due to gravity in air water two phase flow each phase of density and viscosity in eq 14 can be defined in terms of c in the vof method 15 ρ ρ a ρ w ρ a c μ μ a μ w μ a c where the subscripts a and w respectively represent air and water 3 numerical scheme 3 1 ls solver because the fluids are assumed to be incompressible in this study the conservative form of the ls evolution equation 1 can be adopted 16 φ t u φ 0 this equation can be written in the following semidiscrete conservative finite difference form 17 d φ i d t l u i 1 δ x f ˆ i 1 2 f ˆ i 1 2 1 δ y g ˆ j 1 2 g ˆ j 1 2 1 δ z h ˆ k 1 2 f ˆ k 1 2 where f ˆ i 1 2 g ˆ j 1 2 and h ˆ k 1 2 are the approximations of the numerical flux at the points x i 1 2 y j 1 2 and z k 1 2 respectively and can be reconstructed from the discrete values of f u φ g v φ and h w φ similarly the reinitialization equation 3 can be written in the following semidiscrete form 18 d φ d t h g φ x φ x φ y φ y φ z φ z 0 where h g is the godunov hamiltonian the spatial discretizations φ x and φ x in eq 3 can be obtained in a way similar to that for the evolution equation based on the ocrweno scheme gu et al 2018 the tvd rk3 method is adopted for time advancement shu 1988 3 2 vof solver 3 2 1 weighted linear interface calculation the weighted linear interface calculation wlic technique was proposed by yokoi 2007 and independently modified by marek et al 2008 passive advection has been used in the literature to model droplet splashes via the clsvof approach yokoi 2013 the horizontal interface with x and y and vertical interfaces with x and z or with y and z are defined and the related weights are computed from the surface normal vector n 19 χ i j k x y z ω x i j k n i j k χ x i j k x y z ω y i j k n i j k χ y i j k x y z ω z i j k n i j k χ z i j k x y z where n i j k is the local normal vector χ x i j k χ y i j k and χ z i j k are the characteristic functions of the vertical and horizontal interfaces respectively and ω x i j k ω y i j k and ω z i j k are the corresponding weighting functions the choice of weighting functions follows aniszewski et al 2014 because spatial derivatives of the vof function may be discontinuous around the free surface inaccurate geometric properties can result in some cases in this study we use φ in the ls method to calculate ω x i j k in the following form 20 ω x i j k n x i j k n x i j k n y i j k n z i j k where n x i j k φ x φ x 2 φ y 2 φ z 2 and φ x φ y and φ z are approximated by a second order centered difference scheme 3 2 2 thinc scheme the numerical flux f x x in eq 8 is solved based on a thinc scheme in which the following piecewise modified hyperbolic tangent function is adopted 21 χ x i 1 2 1 α x tanh β x x i 1 2 δ x x i where α x is the interface direction function and β 3 5 is a smoothing parameter α x is determined as follows 22 α x 1 if n x i 0 1 if n x i 0 for given c i the jump center x i is determined by solving 23 c i 1 δ x i x i 1 2 x i 1 2 1 2 1 γ tanh β x x i 1 2 δ x i x i d x 3 3 n s equation solver we employ a finite difference technique to discretize the n s equations on a uniform staggered cartesian grid in which the velocities are defined at the centers of the cell faces and the pressure p density ρ and clsvof variables φ and c are defined at the cell centers 3 3 1 immersed boundary method the immersed boundary method is adopted for fluid structure interface simulation in dambreak problems li et al 2019 the virtual force caused by a complex surface is introduced into the n s equations in the cell of an immersed boundary ω we can write the momentum equation as 24 u t u u p ρ 1 r e 2 u f applying the discrete time momentum forcing method to this equation we obtain 25 u n 1 u n δ t u u p ρ 1 r e 2 u f the virtual force acts only on the points closest to the immersed boundary ω hence the virtual force term must be interpolated at ω by 26 f r h s v ω u n δ t where δ t is the time interval v ω is the velocity vector of the immersed boundary and r h s includes the pressure gradient as well as the convection and diffusion terms 3 3 2 momentum equation for the convective terms in the n s equation a second order upwind scheme is adopted taking u u x as an example we can express its discretization by the second order upwind scheme as 27 u u x 1 2 u 3 u i j k 4 u i 1 j k u i 2 j k u u i 2 j k 4 u i 1 j k 3 u i j k where u 1 2 u i j k u i j k and u 1 2 u i j k u i j k a second order central difference scheme is adopted to handle the diffusion terms in the n s equation 3 3 3 projection method the second order adams bashforth scheme given u n and f n is used for time advancement as follows 28 u n 1 u n δ t 3 2 a n 1 2 a n 1 1 ρ p n 1 2 0 where 29 a u u 1 ρ μ u u t g using the continuity equation we can write the pressure poisson equation for p n 1 2 as 30 1 ρ p n 1 2 u n δ t 3 2 a n 1 2 a n 1 note that p n 1 2 must satisfy the following neumann boundary condition at every rigid wall 31 p n 1 2 n f n u n 1 u n δ t we then discretize eq 30 as 32 a p i 1 j k b p i 1 j k c p i j k d p i j 1 k e p i j 1 k f p i j k 1 g p i j k 1 r h s i j k a point based successive over relaxation method is adopted to handle this tridiagonal and sparse pressure matrix a convergence tolerance ε 10 4 is adopted for the solutions calculated from two consecutive iterations p m 1 p m where m is the iteration counter to ensure second order accuracy in both time and space o δ t 2 δ x 2 the projection method is adopted to solve the n s equations along with the projected successive over relaxation psor method for the pressure poisson equation which may be crucial for achieving accuracy in capturing free interfaces the numerical simulations are executed on a dell pc workstation based on a 6 core 12 thread intel core i7 8700k processor at 3 7 ghz and with 32 0 gb ram the numerical solver adopts openmp software for parallel computing 4 numerical verification 4 1 clsvof verification by a 3d zalesak sphere problem we first have to verify the accuracy of the clsvof method before moving on to a realistic dambreak type nonlinear free surface numerical simulation the adopted zalesak sphere problem is a classical and well known 3d benchmark case used to verify various interface capturing schemes the initial sphere which has a slot 5 grid cells wide and 12 5 grid cells deep is initially located at 0 5 0 75 0 5 as shown in fig 1 with grid spacing of δ x δ y δ z 0 01 the sphere rotates in the z 0 5 plane at the point 0 5 0 5 0 5 and the prescribed velocity fields are given by 33 u x y z t π 314 0 5 y v x y z t π 314 x 0 5 w x y z t 0 we apply ls vof and clsvof to this test case to show the accuracy of each interface capture method the numerical results from each method are shown in fig 2 fig 2 shows the predicted results using the clsvof scheme compared with the results using the ls and vof methods with δ x δ y δ z 0 01 after one rotation good agreement can be seen between the clsvof result and the exact solution however both the ls and vof methods demonstrate some numerical damping in convex and concave regions owing to the inward and outward dissipation errors respectively after one rotation only slight numerical dissipation is created by the clsvof method moreover although the sphere shape obtained by the vof method is slightly distorted after one rotation when the ls method is added to give the clsvof method this distortion disappears figs 3 4 and 5 show the results for the middle longitudinal section of the zalesak sphere obtained by the three methods after one rotation with three different grid spacings it can be seen that as the grid spacing decreases the results obtained by the three methods gradually converge the results given by the clsvof method are the best followed by the ls while the results of the vof method are relatively poor table 1 compares the cpu times consumed by the different methods it can be seen that the clsvof method needs the most computing time followed by the ls method with the vof method taking the least time the reason for the large time consumption of the clsvof method is the lengthy time required by the re initialization process during the simulation fig 6 shows the mass error m error ω h φ d ω 1 of the 3d zalesak sphere problem when the clsvof ls and vof methods are used it is clear that the vof and clsvof methods yield good results in terms of mass conservation with the mass errors from both methods being similar and very small in contrast the mass error from the ls method increases by time which is related to the numerical dissipation generated by this method 4 2 numerical verification for 3d dambreak flow over a small rectangular obstacle 4 2 1 parameters and establishment of numerical simulations in this subsection a numerical simulation of 3d dambreak flow over a small rectangular obstacle is performed and the results are used for mesh convergence analysis mass conservation analysis and numerical verification a reference experiment was conducted at the maritime research institute of the netherlands marin kleefsman et al 2004 the results of this experiment are used to validate the developed numerical solver with the clsvof scheme and the immersed boundary method the computational domain is the same as in the experimental setting with a length of 3 2 m width 1 m and height 1 m as shown in fig 7 the initial height of the water column inside the domain is 0 55 m owing to gravity the water column collapses and subsequently impacts on a small stationary rectangular obstacle of length 0 4 m width 0 16 m and height 0 16 m located downstream of the reservoir the gate is rapidly opened in a tiny time range t 0 06 0 08 s the upstream downstream and sidewall boundary conditions of the water channel are all set as rigid walls u v w 0 the entire numerical domain is divided into a set of fixed rectangular cells with δ x δ y δ z by means of the finite difference method four water level probes h1 h4 and four pressure probes p1 p4 are used in the numerical simulation 4 2 2 mesh convergence study in the mesh convergence study three sets of mesh configurations are adopted with the parameters listed in table 2 the time histories of the water elevations measured by the probes are shown in fig 8 as can be seen the results for cases a b and c are very similar the solver can predict changes in wave surface elevation with time with enough accuracy it can also be seen that the numerical results converge gradually to the experimental results as the mesh is refined moreover the good agreement between the water heights from simulation and experiment demonstrate that the numerical solver can accurately predict the free surface when the clsvof and immersed boundary method are combined fig 9 shows the numerical results for the pressure variation with time at different pressure measuring points and it can again be seen that these results converge gradually to the experimental data as the mesh is refined thus the numerical solver proposed in this paper is able not only to predict the wave surface elevation but also to accurately predict the pressure variation in the flow field 4 2 3 mass conservation analysis fig 10 shows the mass error m error ω h φ d ω 1 of dambreak wave impact on a small obstacle when the clsvof and immersed boundary methods are used in the simulation the clsvof method yields a good mass conservation result because the transport in this method is based on conservative equations mass conservation errors are thereby reduced and the accuracy of the interface normal vector is retained with this approach even in the presence of breakup phenomena 4 2 4 numerical verification of free surface evolution to better assess and observe the real situation investigated in this problem the isosurface of the dambreak induced free surface is captured during the simulation the full set of numerical isosurface results for the free surface are given in figs 11 and 12 we can see that at 0 40 s the wave front has just arrived at the right end of the obstacle the water volume seems relatively stable and there is no obvious nonlinear phenomenon subsequently at 0 56 s the wave front breaks owing to the presence of the obstacle the water volumes on both sides of the obstacle quickly break around it and the total water volume is forced upward resulting in a nonlinear phenomenon at 0 80 s the nonlinear phenomenon becomes stronger and the wave front begins to cross the obstacle from above at 1 20 s the water volumes on both sides of the obstacle and the water volume on top of the obstacle begin to mix behind it resulting in intense turbulence from fig 12 at 1 60 s intense turbulent mixing still persists and according to fluid mechanical considerations the kinetic energy of the water volume is dissipated in this region at 2 40 s the water splashes in most areas of the domain and the nonlinear phenomenon is still intense at this time owing to the presence of the left endwall the water volume begins to be reflected at 3 40 s and 4 00 s the water volume hits the lift endwall and experiences a second reflection we can see that owing to the energy dissipation resulting from the small obstacle and the endwalls the nonlinear phenomenon gradually weakens with time thus the clsvof method can reproduce such strongly nonlinear physical phenomena very well for interactions between dambreak waves and a stationary structure figs 13 14 show experimental snapshots of the evolution of the free surface compared with the results of numerical simulations a mesh configuration of δ x δ y δ z 10 mm is adopted for this comparison it can been seen that the numerical results are in very good agreement with the experimental results even for highly nonlinear phenomena such as wave breaking and water splashing to a certain degree however from fig 13 it can be seen that the air entrapment that appears in the upstream region in the experiment is completely missing in the results of the current clsvof model to improve the model in this respect we will try adding some air bubble models in future research the numerical simulations indicate that the numerical scheme not only provides sufficient accuracy for simulating the free surface deformation of the flow field but also is able to reproduce strongly nonlinear phenomena with satisfactory accuracy and fine detail 5 dambreak flow caused by partial failure to test the ability of the clsvof method to handle nonlinear phenomena such as violent deformation of a free surface an experiment at model size involving a dambreak flow caused by partial failure was devised it was conducted at the parma university hydraulics laboratory francesca et al 2015 a schematic is shown in fig 15 the numerical domain is the same as the experimental domain and as in the experiment the bottom of the numerical domain is horizontal a small rectangular obstacle as shown in fig 15 was located in the downstream flood plain in front of the gate to represent an isolated structure using cartesian coordinates the computational domain is subdivided into a structured mesh of fixed rectangular cells in the numerical simulations the cell sizes are taken as δ x δ y δ z 10 mm the effect of the obstacle is simulated by the immersed boundary method at the start of the experiment the gate quickly moved upward and the water in the reservoir flowed forward owing to gravity and subsequently impacted on the obstacle figs 16 20 show some important frames from a video taken during the whole impact process between the dambreak induced free surface and the small obstacle in the experiment methylene blue dye was dissolved in the water to improve the clarity of the image the corresponding numerical isosurface results at the same recorded times are also shown in figs 16 20 for comparison it can be seen that after the gate opens the dambreak induced wave quickly spreads all over the dry area fig 16 a and b and reaches the obstacle fig 16 c and d one of the very early stages of the impact between the free surface and the obstacle is captured in fig 16 c and d from fig 16 a d it can be seen that the numerical results are generally in good agreement with the model results in terms of the shape of the free surface and the wave front location however the shape of the wave front reveals a certain difference between the numerical and experimental results notably the shape of the contact between the wave front and the obstacle differs in fig 16 c and d fig 17 a and c show the details of the wave front collision process associated with the interaction between the free surface and the downstream obstacle we can see that an upward moving jet is created at the wall and flips upward in front of the approaching dambreak induced wave as shown in fig 17 b and d the numerical solver is able to reproduce this phenomenon extremely well cooker and peregrine cooker and peregrine call this phenomenon in which the wave climbs the wall a flip through type wave in this process no air is trapped between the wall and the jet according to cooker and peregrine cooker and peregrine and hattori et al hattori et al 1994 collision mechanisms such as that due to an incoming wave are typically dominated mainly by inertia additionally the sudden upward deviation in flow is associated with a strong acceleration that produces high velocity gradients especially at the toe of the obstacle figs 17 c and 18 a illustrate how the wave front reaches its maximum elevation when the run up jet at the wall of the obstacle is decelerated by gravity this phenomenon can also be seen in the numerical isosurface results in figs 17 d and 18 b in fig 18 c the falling jet wave collapses onto the free surface of the incoming dambreak induced wave according to the results of the experiment francesca et al 2015 in fig 19 a and c the water from the plunging jet wave that splashes upward and forms a backflow creates new surges that rebound at the water surface and produce strong surface mixing along with air entrapment a stable shock wave then develops in front of the obstacle as can be seen in fig 19 c the front of this shock wave is disturbed and the rise in water depth is associated with turbulence and the entrainment of air pockets as shown in fig 19 b d and 20 b the numerical isosurface results show good agreement with the experimental results and the nonlinear deformation of the free surface is simulated well however the results for the thin water film at the edge of the fluid field differ between the numerical and experimental investigations at various times in the case of such thin films the current clsvof approach is not appropriate fig 21 shows a comparison between the experimental and numerical results for the force exerted on the obstacle it can be seen that both in terms of trend and numerical values the results of the numerical simulation agree well with the experimental results some 2d views of the jet wave climbing the wall of the obstacle are shown in fig 22 and the entire flip through process can be clearly seen 6 numerical simulation of a dambreak in a small reservoir with an obstacle the third experiment on a dambreak investigated in this study was originally proposed by koshizuka 1995 the scenario involved a small reservoir with an obstacle to test the large deformation of the free surface in a very short time as shown in fig 23 the domain in the experiment was square with side length 0 584 m the obstacle of height 0 048 m and width 0 024 m was located 0 292 m from the left wall the reservoir of length 0 1461 m width 0 30 m and height 0 292 m was located in the upstream portion of the domain at the initial time the partition was quickly removed and the fluid began to move under gravity in the numerical simulations the cell sizes are δ x δ y δ z 10 mm the effect of the obstacle is simulated by the immersed boundary method fig 24 compares the numerical and experimental results for the water height on the left wall x 0 0 m and z 0 15 m and pressure x 0 292 m y 0 024 m and z 0 15 m on the obstacle for the simulation process it can be seen that the numerical results are in good agreement with the experimental results except for a slight deviation in the water level due to the initial configuration of the experimental test device at the beginning figs 25 and 26 present experimental snapshots of the free surface together with the results of the numerical simulations during the process from a comparison of the numerical and experimental results at time t 0 1 s it can be seen that the water has not yet reached the right wall as illustrated in fig 25 a however in the experimental snapshot in fig 25 a a thin water layer can be observed flowing along the bottom of the wall and touching the obstacle this phenomenon is due to the small difference in the initial time required to open the gate in the experiment at t 0 2 s as shown in fig 25 b the wave front reaches the obstacle in both the numerical and experimental results and a water jet is then formed as a result of the interaction between the wave front and the obstacle after t 0 3 s as can be seen from fig 25 c the water volume is elongated by a vortex that has formed in the center of the domain in both the experiment and the numerical simulation a strong wave can be seen to splash from the top of the water column from fig 26 it can be seen after t 0 4 s the water volume reaches the right wall of the reservoir then under the force of gravity the wave front starts to fall experimentally it is found that an air cushion forms at the lower right corner koshizuka 1995 all these physical phenomena can be observed in fig 26 a c it can also be seen in fig 25 b and c that the wave tongue in the experiment appears to be pointing forward whereas in the numerical simulation it curves backward the reason for this is that the viewing angles in the experiment and simulation are different and the experimental device obstructs part of the view of the tongue similar results can be found in issakhov et al 2018 however it also can be seen from fig 25 b and c that in the experiment there exists a very strong water splash phenomena above the water tongue which was not successfully captured by our current model a possible reason for this is that the current grid configuration is not fine enough to capture such a strongly nonlinear phenomenon which can be attributed to the direct numerical simulation dns model that we have adopted therefore in future work we need to develop a large eddy simulation les model to extend the range of application of the numerical solver 7 numerical simulation of a dambreak flow over a tall rectangular obstacle in this section the case of a dambreak induced free surface interacting with a tall vertical rectangular obstacle is investigated the width of the obstacle in the simulation is much smaller than that of the tank since this case was originally designed to investigate interactions between tsunami waves and onshore structures accurate prediction results have real application value in this case the free surface evolution is expected to exhibit strong 3d effects a schematic of the scenario is presented in fig 27 the corresponding experiment was performed at the university of washington raad in the experiment a very thin 1 cm layer of water was initially present at the bottom of the water tank to reflect the real physical scenario of an ocean and coast the boundary conditions and mesh division method are the same as in previous sections since no flow enters the reservoir in the numerical simulations the cell sizes are taken as δ x δ y δ z 10 mm the effect of the obstacle is simulated by the immersed boundary method the simulated and experimental force exerted on the obstacle are shown in fig 28 it can be seen that the numerical result obtained using the clsvof method agrees well with the experimental result since the ability of the proposed numerical solver to capture the free surface deformation is an important aspect of this study the free surface deformation of a dambreak induced wave impacting on a tall obstacle as simulated by the clsvof method is shown in fig 29 the whole of the impact process is captured very well by the clsvof method furthermore fig 30 shows a comparison of the free surface at t 1 15 s obtained by a the δ sph method marrone et al 2011 and b the clsvof method as can be seen the two methods give similar results and both capture the highly nonlinear free surface well however the clsvof method gives a more realistic result and it can be seen that there is no distortion on the left side of the free surface in fig 30 b in contrast to that in a figs 31 33 show the interaction process between a dambreak induced free surface and a tall obstacle the interactions between the free surface and obstacle occur over a very short time after the gate opens the dambreak induced wave spreads freely over the initially dry downstream area and a cavity forms below the wave front as can be observed in fig 31 a thus the flow characteristics at this moment are mainly 2d in nature in fig 31 b the free surface reaches the obstacle the first cavity is disrupted by the obstacle and a second cavity forms behind the first cavity additionally the wave front begins to climb the wall of the obstacle in fig 32 a a third cavity forms behind the second cavity and all three cavities are disrupted by the obstacle a wave jet forms at the wall and flip ups in front of the approaching dambreak induced free surface the 3d and nonlinear effects of the flow field behind the obstacle begin to increase in strength in fig 32 b more cavities form and the 3d effect of the flow field increases with increasing distance from the obstacle in addition the jet formed by the wave front begins to splash upstream in fig 33 a and b when the wave front jet at the wall of the obstacle is decelerated by gravity the jet reaches its maximum elevation the front then breaks up and starts to detach from the vertical wall of the obstacle before overturning backward and rolling and plunging into the upstream water volume the nonlinearity of the flow field is very strong and the turbulence behind the obstacle is severe as indicated by the numerical results the clsvof method can effectively reproduce the 3d effects and nonlinear phenomena of the flow field and can provide a realistic simulation however it can also be seen from fig 33 a and b that the small water splashes in the air disappear after a period of time owing to numerical dissipation thus it would be difficult to precisely capture the long time movement of water splashes in the air even if a high precision scheme for interface capture were to be incorporated into the present approach of course increasing the grid number could partly solve this problem but further work is still necessary to improve a number of aspects of the liquid capture method 8 concluding remarks in this study the interactions between dambreak induced free surface deformation and different types of obstacle have been numerically investigated using 3d clsvof and immersed boundary methods by tracing the free surface moving over the obstacles we have compared the numerical simulation results with experimental data the results of the comparisons show that the numerical model developed in this study not only effectively simulates the entire process of dambreak induced nonlinear free surface movement but also reproduces the range of important 3d phenomena that occur around obstacles strongly nonlinear phenomena such as wave breaking and splashing and highly nonlinear free surface deformation remain obstacles to the success of two phase numerical flow simulations of the interaction between free surfaces and obstacles to a certain extent the use of the clsvof method can improve the results of simulation of these strongly nonlinear phenomena the numerical model demonstrated in this study provides a reliable approach for investigating the interactions between free surfaces and obstacles however it still lacks any means of treating the air entrapment and violent splashing that occur in experiments to improve the current model in future work we shall attempt to incorporate les and air bubble models with the aim of enhancing numerical accuracy and reducing the computational cost the solver developed here has potential for future applications in ocean and coastal engineering author contributions section we explain the contribution of each author of the paper paper oe d 19 01516 y l li wrote the code of the programs and the manuscript of this paper c p ma found the reference literature and proofread the paper the main work of x h zhang and k p wang was data and figure processing at last d p jiang conceived the structure as well as content of the whole paper and provided financial support declaration of competing interest we declare that we do not have any commercial or associative interest that represents a conflict of interestin connection with the work submitted acknowledgments this work was supported by the national natural science foundation of china grant no 51979129 the opening foundation of sichuan 481 univ state key lab hydraul mt river engn no skhl1820 and the financial support by the equipment development foundation of china grant no jzx7y20190252032901 
21743,the purpose of this study is to evaluate the ability of the coupled level set and volume of fluid clsvof method to reproduce violent three dimensional 3d free surface deformation induced by different types of dambreak problems a 3d clsvof based numerical solver is developed and the finite difference method is adopted to discretize the fluid domain by applying these methods the vof advection equation is solved under the tangent of hyperbola framework to capture the interactions with the weighted linear interface calculation scheme thinc wlic the ocrweno scheme is employed to accurately handle the ls advection equation and the navier stokes equations are discretized by a projection method for dealing with fluid structure interactions the direct forcing immersed boundary method is employed the developed numerical solver is applied to model free surface evolution in a variety of dambreak experiments good agreement is obtained between the numerical simulation and experimental results for each case thus proving the suitability of the proposed numerical approach for the simulation of violent free surface deformation the numerical solver developed in this paper has potential for reproducing strongly nonlinear free surface phenomena in other ocean engineering applications keywords coupled level set and volume of fluid method immersed boundary method dambreak flow violent free surface deformation 1 introduction simulation of the behavior of free surfaces in two phase flows is an important task in a wide range of fields including the study of ocean surface waves ocean engineering coastal engineering hydrological engineering and the study of channel flows in particular accurate simulation of strong free surface deformations is greatly desirable from both basic scientific and engineering perspectives based on the commonly used euler description the volume of fluid vof hirt and nichols 1981 and level set ls osher and fedkiw 2001 2003 techniques are the two main mathematical models currently used to handle free surface deformation the vof technique has attracted much attention for the numerical modeling of free surfaces in two phase flow because of its advantage with regard to mass conservation marsooli and wu 2014 vof methods can be categorized as either geometrical or algebraic interface simulations since they involve geometrical reconstruction geometrical vof models often require the use of piecewise linear interface calculation plic parker and youngs 1992 various algebraic vof methods have been developed for example the tangent of hyperbola for interface capturing thinc scheme proposed by xiao et al xiao et al 2005 which implements a hyperbolic tangent function to compute the numerical flux of a fluid fraction function and provides a conservative solution for this function even in the presence of extremely distorted interfaces of arbitrary complexity using the simple line interface calculation slic reconstruction method yokoi 2007 developed a scheme to approximate multidimensional fluxes while taking account of interface orientation schemes of this type are called vof wlic schemes yokoi 2007 proposed the use of an interface orientation dependent weight between the original thinc scheme xiao et al 2011 and the first order donor cell scheme and was thereby able to significantly improve the geometric accuracy of the original thinc scheme ls based models are increasingly being used to simulate interfaces between two phase flows yang et al 2014 zhu et al 2016 owing to a number of advantages such as their ability to define an interface between water simply by the zero value of a continuous signed distance function in addition topology changes are conveniently addressed by implementing a high order advection scheme kim and liou 2011 however typical ls based methods are limited by two important issues the first of these is numerical dissipation and dispersion which cause the predicted ls solutions to deteriorate in some cases one solution that has been suggested to deal with this problem is the use of high order schemes such as essentially non oscillatory eno based or weighted eno weno based schemes to improve the accuracy of the advection process and thus preserve the interface shape hermann 2014 salih and moulic 2009 the second issue is a violation of mass property conservation with a small amount of mass being gained or lost when the zero ls changes during the initialization procedure luo et al 2015 one feasible albeit advanced technique to overcome the disadvantages mentioned above is the use of a hybrid approach such as a coupled ls and vof clsvof method wang and tong 2010 wang et al 2012 balczar et al 2016 yokoi 2013 clsvof methods that combine the individual advantages of the vof and ls methods result in an improvement of mass conservation and are able to accurately calculate the curvature of the interface these hybrid approaches use a vof function to deal with the free surface and a smoothed ls function to determine its geometrical deformation an improved reinitialization procedure for the ls function is also usually adopted chakraborty et al 2013 ningegowda and premachandran 2014 such methods have been widely implemented in high precision simulations of a droplet impacting on a dry surface yokoi et al 2009 bubble growth and detachment albadawi et al 2013 plunging breaking waves koo et al 2012 and dambreak problems li and yu 2019 peskin 1972 presented an immersed boundary method to make it easier to deal with complex interfaces and moving boundaries on account of its advantages in dealing with complex surface boundaries moving boundaries and fluid structure interaction fsi in particular this method has proved in recent years to be of great value in dealing with problems involving fsi the continuous force method and the discrete force method mittal and iaccarino 2005 are two classic types of immersed boundary method in the continuous force method a feedback force term usually in analytic form is added to the continuity equation before discretization of the navier stokes n s equations which makes the method useful for simulating elastic boundary problems such as the deformation and motion of a biofilm under the action of a flow field the discrete force method on the other hand obtains the feedback force through the discretized n s equations usually without an analytical expression and is applicable to simulation of the interaction between a rigid body and a fluid ghias et al 2007 in this paper we develop a high accuracy finite difference based three dimensional 3d numerical model that combines the clsvof and immersed boundary methods in fortran and c programs to simulate violent free surface deformation associated with the physical phenomena that occur in different kinds of dambreak problems in the original clsvof method surface normals were computed with a volume fraction function yokoi 2007 since accurate calculation of the normal vector is the key issue we develop a clsvof method that adopts an ls function i e a distance function instead of a vof function to calculate the normal vector and we then combine this approach with an immersed boundary method to analyze the fsi and simulate the violent free surface deformation that it induces four different types of dambreak experiments are performed to test the ability combined method to capture the violent free surface deformation the paper is organized as follows in section 2 the numerical algorithm is presented and the ls and vof methods and the corresponding combined technique are discussed the treatment of the interface in the splitting algorithm with the clsvof equations is described in section 3 the immersed boundary method is implemented to simulate the solid geometric boundaries and relevant boundary conditions in section 4 numerical verification is performed according to an experiment to validate the accuracy of the developed numerical solver based on a mesh convergence study and mass conservation analysis in section 5 a partial dambreak flow problem is investigated this problem is used to test the ability of the clsvof method to handle relatively slow and weakly nonlinear flow behavior in section 6 a strongly nonlinear dambreak flow problem is investigated to test the ability of the clsvof method to address extremely nonlinear phenomena in section 7 the problem of dambreak flow over a tall obstacle is investigated to assess the changes in the free surface and the interactions between waves and onshore buildings finally conclusions are presented in section 8 2 governing equations 2 1 ls method the ls evolution equation is 1 φ t u φ 0 where φ is the ls function we adopt a signed distance function d that is positive in water and negative in air and has the following form 2 φ x y z t d for x y z in water 0 for x y z on the free surface d for x y z in air the reinitialization process necessary for φ to remain a signed distance function involves solving the following reinitialization equation 3 φ τ s φ 0 1 φ λ δ φ φ where τ is the pseudotime of the iteration and φ 0 is the ls function before reinitialization λ and the delta function δ φ are given by 4 λ ω δ φ s φ 0 1 φ d ω ω δ 2 φ φ d ω 5 δ φ 1 2 ε 1 cos π φ ε if φ ε 0 otherwise where s φ 0 is the smoothed signed function 2 2 vof method a characteristic function χ of the following form is adopted yokoi 2007 6 χ t u χ χ u 0 with 7 χ x y z t 1 for x y z in water 0 for x y z in air as an integral of the characteristic phase function χ the following fraction function c is adopted 8 c i j k 1 δ x δ y δ z 0 δ x 0 δ y 0 δ z χ x y z t d x d y d z 2 3 clsvof method in spite of conserving mass well the vof method still has difficulties in capturing the geometric properties of the interface while the ls method gives a good description of these geometric properties through a continuous ls function φ but does not guarantee mass conservation hence a clsvof method that incorporates both the vof method and the ls method is proposed here to implement both mass conservation and an accurate geometric description in the clsvof algorithm first of all the governing equations of the ls function φ and the volume fraction c are solved in the time interval from t n to t n 1 to give φ n 1 and c n 1 interface reconstruction is then performed to confirm that the interfaces predicted from φ and c respectively are similar to each other the reconstruction procedure uses an intermediate function 9 ψ 2 c n 1 1 such that the isoline ψ 0 represents the position of the interface corresponding to the position represented by c n 1 1 2 after this 10 ψ τ s ψ 0 1 ψ is solved until ψ reaches a steady state solution at the interface and this solution is the exact value of ψ at the interface next another intermediate ls function 11 φ n 1 ψ n 1 if φ n 1 ε φ n 1 otherwise is constructed to confirm that φ n 1 and c n 1 represent the same interface position finally 12 φ n 1 τ s φ 0 n 1 1 φ n 1 λ δ φ n 1 φ n 1 is solved until a steady state solution φ n 1 is reached with the discontinuity at φ n 1 ε vanishing 2 4 n s equations the two phase incompressible viscous flows are governed by the n s equations 13 u 0 14 u t u u 1 ρ p 1 ρ 2 μ d g where u is the velocity vector t is the time p is the pressure d is the deformation tensor and g is the acceleration due to gravity in air water two phase flow each phase of density and viscosity in eq 14 can be defined in terms of c in the vof method 15 ρ ρ a ρ w ρ a c μ μ a μ w μ a c where the subscripts a and w respectively represent air and water 3 numerical scheme 3 1 ls solver because the fluids are assumed to be incompressible in this study the conservative form of the ls evolution equation 1 can be adopted 16 φ t u φ 0 this equation can be written in the following semidiscrete conservative finite difference form 17 d φ i d t l u i 1 δ x f ˆ i 1 2 f ˆ i 1 2 1 δ y g ˆ j 1 2 g ˆ j 1 2 1 δ z h ˆ k 1 2 f ˆ k 1 2 where f ˆ i 1 2 g ˆ j 1 2 and h ˆ k 1 2 are the approximations of the numerical flux at the points x i 1 2 y j 1 2 and z k 1 2 respectively and can be reconstructed from the discrete values of f u φ g v φ and h w φ similarly the reinitialization equation 3 can be written in the following semidiscrete form 18 d φ d t h g φ x φ x φ y φ y φ z φ z 0 where h g is the godunov hamiltonian the spatial discretizations φ x and φ x in eq 3 can be obtained in a way similar to that for the evolution equation based on the ocrweno scheme gu et al 2018 the tvd rk3 method is adopted for time advancement shu 1988 3 2 vof solver 3 2 1 weighted linear interface calculation the weighted linear interface calculation wlic technique was proposed by yokoi 2007 and independently modified by marek et al 2008 passive advection has been used in the literature to model droplet splashes via the clsvof approach yokoi 2013 the horizontal interface with x and y and vertical interfaces with x and z or with y and z are defined and the related weights are computed from the surface normal vector n 19 χ i j k x y z ω x i j k n i j k χ x i j k x y z ω y i j k n i j k χ y i j k x y z ω z i j k n i j k χ z i j k x y z where n i j k is the local normal vector χ x i j k χ y i j k and χ z i j k are the characteristic functions of the vertical and horizontal interfaces respectively and ω x i j k ω y i j k and ω z i j k are the corresponding weighting functions the choice of weighting functions follows aniszewski et al 2014 because spatial derivatives of the vof function may be discontinuous around the free surface inaccurate geometric properties can result in some cases in this study we use φ in the ls method to calculate ω x i j k in the following form 20 ω x i j k n x i j k n x i j k n y i j k n z i j k where n x i j k φ x φ x 2 φ y 2 φ z 2 and φ x φ y and φ z are approximated by a second order centered difference scheme 3 2 2 thinc scheme the numerical flux f x x in eq 8 is solved based on a thinc scheme in which the following piecewise modified hyperbolic tangent function is adopted 21 χ x i 1 2 1 α x tanh β x x i 1 2 δ x x i where α x is the interface direction function and β 3 5 is a smoothing parameter α x is determined as follows 22 α x 1 if n x i 0 1 if n x i 0 for given c i the jump center x i is determined by solving 23 c i 1 δ x i x i 1 2 x i 1 2 1 2 1 γ tanh β x x i 1 2 δ x i x i d x 3 3 n s equation solver we employ a finite difference technique to discretize the n s equations on a uniform staggered cartesian grid in which the velocities are defined at the centers of the cell faces and the pressure p density ρ and clsvof variables φ and c are defined at the cell centers 3 3 1 immersed boundary method the immersed boundary method is adopted for fluid structure interface simulation in dambreak problems li et al 2019 the virtual force caused by a complex surface is introduced into the n s equations in the cell of an immersed boundary ω we can write the momentum equation as 24 u t u u p ρ 1 r e 2 u f applying the discrete time momentum forcing method to this equation we obtain 25 u n 1 u n δ t u u p ρ 1 r e 2 u f the virtual force acts only on the points closest to the immersed boundary ω hence the virtual force term must be interpolated at ω by 26 f r h s v ω u n δ t where δ t is the time interval v ω is the velocity vector of the immersed boundary and r h s includes the pressure gradient as well as the convection and diffusion terms 3 3 2 momentum equation for the convective terms in the n s equation a second order upwind scheme is adopted taking u u x as an example we can express its discretization by the second order upwind scheme as 27 u u x 1 2 u 3 u i j k 4 u i 1 j k u i 2 j k u u i 2 j k 4 u i 1 j k 3 u i j k where u 1 2 u i j k u i j k and u 1 2 u i j k u i j k a second order central difference scheme is adopted to handle the diffusion terms in the n s equation 3 3 3 projection method the second order adams bashforth scheme given u n and f n is used for time advancement as follows 28 u n 1 u n δ t 3 2 a n 1 2 a n 1 1 ρ p n 1 2 0 where 29 a u u 1 ρ μ u u t g using the continuity equation we can write the pressure poisson equation for p n 1 2 as 30 1 ρ p n 1 2 u n δ t 3 2 a n 1 2 a n 1 note that p n 1 2 must satisfy the following neumann boundary condition at every rigid wall 31 p n 1 2 n f n u n 1 u n δ t we then discretize eq 30 as 32 a p i 1 j k b p i 1 j k c p i j k d p i j 1 k e p i j 1 k f p i j k 1 g p i j k 1 r h s i j k a point based successive over relaxation method is adopted to handle this tridiagonal and sparse pressure matrix a convergence tolerance ε 10 4 is adopted for the solutions calculated from two consecutive iterations p m 1 p m where m is the iteration counter to ensure second order accuracy in both time and space o δ t 2 δ x 2 the projection method is adopted to solve the n s equations along with the projected successive over relaxation psor method for the pressure poisson equation which may be crucial for achieving accuracy in capturing free interfaces the numerical simulations are executed on a dell pc workstation based on a 6 core 12 thread intel core i7 8700k processor at 3 7 ghz and with 32 0 gb ram the numerical solver adopts openmp software for parallel computing 4 numerical verification 4 1 clsvof verification by a 3d zalesak sphere problem we first have to verify the accuracy of the clsvof method before moving on to a realistic dambreak type nonlinear free surface numerical simulation the adopted zalesak sphere problem is a classical and well known 3d benchmark case used to verify various interface capturing schemes the initial sphere which has a slot 5 grid cells wide and 12 5 grid cells deep is initially located at 0 5 0 75 0 5 as shown in fig 1 with grid spacing of δ x δ y δ z 0 01 the sphere rotates in the z 0 5 plane at the point 0 5 0 5 0 5 and the prescribed velocity fields are given by 33 u x y z t π 314 0 5 y v x y z t π 314 x 0 5 w x y z t 0 we apply ls vof and clsvof to this test case to show the accuracy of each interface capture method the numerical results from each method are shown in fig 2 fig 2 shows the predicted results using the clsvof scheme compared with the results using the ls and vof methods with δ x δ y δ z 0 01 after one rotation good agreement can be seen between the clsvof result and the exact solution however both the ls and vof methods demonstrate some numerical damping in convex and concave regions owing to the inward and outward dissipation errors respectively after one rotation only slight numerical dissipation is created by the clsvof method moreover although the sphere shape obtained by the vof method is slightly distorted after one rotation when the ls method is added to give the clsvof method this distortion disappears figs 3 4 and 5 show the results for the middle longitudinal section of the zalesak sphere obtained by the three methods after one rotation with three different grid spacings it can be seen that as the grid spacing decreases the results obtained by the three methods gradually converge the results given by the clsvof method are the best followed by the ls while the results of the vof method are relatively poor table 1 compares the cpu times consumed by the different methods it can be seen that the clsvof method needs the most computing time followed by the ls method with the vof method taking the least time the reason for the large time consumption of the clsvof method is the lengthy time required by the re initialization process during the simulation fig 6 shows the mass error m error ω h φ d ω 1 of the 3d zalesak sphere problem when the clsvof ls and vof methods are used it is clear that the vof and clsvof methods yield good results in terms of mass conservation with the mass errors from both methods being similar and very small in contrast the mass error from the ls method increases by time which is related to the numerical dissipation generated by this method 4 2 numerical verification for 3d dambreak flow over a small rectangular obstacle 4 2 1 parameters and establishment of numerical simulations in this subsection a numerical simulation of 3d dambreak flow over a small rectangular obstacle is performed and the results are used for mesh convergence analysis mass conservation analysis and numerical verification a reference experiment was conducted at the maritime research institute of the netherlands marin kleefsman et al 2004 the results of this experiment are used to validate the developed numerical solver with the clsvof scheme and the immersed boundary method the computational domain is the same as in the experimental setting with a length of 3 2 m width 1 m and height 1 m as shown in fig 7 the initial height of the water column inside the domain is 0 55 m owing to gravity the water column collapses and subsequently impacts on a small stationary rectangular obstacle of length 0 4 m width 0 16 m and height 0 16 m located downstream of the reservoir the gate is rapidly opened in a tiny time range t 0 06 0 08 s the upstream downstream and sidewall boundary conditions of the water channel are all set as rigid walls u v w 0 the entire numerical domain is divided into a set of fixed rectangular cells with δ x δ y δ z by means of the finite difference method four water level probes h1 h4 and four pressure probes p1 p4 are used in the numerical simulation 4 2 2 mesh convergence study in the mesh convergence study three sets of mesh configurations are adopted with the parameters listed in table 2 the time histories of the water elevations measured by the probes are shown in fig 8 as can be seen the results for cases a b and c are very similar the solver can predict changes in wave surface elevation with time with enough accuracy it can also be seen that the numerical results converge gradually to the experimental results as the mesh is refined moreover the good agreement between the water heights from simulation and experiment demonstrate that the numerical solver can accurately predict the free surface when the clsvof and immersed boundary method are combined fig 9 shows the numerical results for the pressure variation with time at different pressure measuring points and it can again be seen that these results converge gradually to the experimental data as the mesh is refined thus the numerical solver proposed in this paper is able not only to predict the wave surface elevation but also to accurately predict the pressure variation in the flow field 4 2 3 mass conservation analysis fig 10 shows the mass error m error ω h φ d ω 1 of dambreak wave impact on a small obstacle when the clsvof and immersed boundary methods are used in the simulation the clsvof method yields a good mass conservation result because the transport in this method is based on conservative equations mass conservation errors are thereby reduced and the accuracy of the interface normal vector is retained with this approach even in the presence of breakup phenomena 4 2 4 numerical verification of free surface evolution to better assess and observe the real situation investigated in this problem the isosurface of the dambreak induced free surface is captured during the simulation the full set of numerical isosurface results for the free surface are given in figs 11 and 12 we can see that at 0 40 s the wave front has just arrived at the right end of the obstacle the water volume seems relatively stable and there is no obvious nonlinear phenomenon subsequently at 0 56 s the wave front breaks owing to the presence of the obstacle the water volumes on both sides of the obstacle quickly break around it and the total water volume is forced upward resulting in a nonlinear phenomenon at 0 80 s the nonlinear phenomenon becomes stronger and the wave front begins to cross the obstacle from above at 1 20 s the water volumes on both sides of the obstacle and the water volume on top of the obstacle begin to mix behind it resulting in intense turbulence from fig 12 at 1 60 s intense turbulent mixing still persists and according to fluid mechanical considerations the kinetic energy of the water volume is dissipated in this region at 2 40 s the water splashes in most areas of the domain and the nonlinear phenomenon is still intense at this time owing to the presence of the left endwall the water volume begins to be reflected at 3 40 s and 4 00 s the water volume hits the lift endwall and experiences a second reflection we can see that owing to the energy dissipation resulting from the small obstacle and the endwalls the nonlinear phenomenon gradually weakens with time thus the clsvof method can reproduce such strongly nonlinear physical phenomena very well for interactions between dambreak waves and a stationary structure figs 13 14 show experimental snapshots of the evolution of the free surface compared with the results of numerical simulations a mesh configuration of δ x δ y δ z 10 mm is adopted for this comparison it can been seen that the numerical results are in very good agreement with the experimental results even for highly nonlinear phenomena such as wave breaking and water splashing to a certain degree however from fig 13 it can be seen that the air entrapment that appears in the upstream region in the experiment is completely missing in the results of the current clsvof model to improve the model in this respect we will try adding some air bubble models in future research the numerical simulations indicate that the numerical scheme not only provides sufficient accuracy for simulating the free surface deformation of the flow field but also is able to reproduce strongly nonlinear phenomena with satisfactory accuracy and fine detail 5 dambreak flow caused by partial failure to test the ability of the clsvof method to handle nonlinear phenomena such as violent deformation of a free surface an experiment at model size involving a dambreak flow caused by partial failure was devised it was conducted at the parma university hydraulics laboratory francesca et al 2015 a schematic is shown in fig 15 the numerical domain is the same as the experimental domain and as in the experiment the bottom of the numerical domain is horizontal a small rectangular obstacle as shown in fig 15 was located in the downstream flood plain in front of the gate to represent an isolated structure using cartesian coordinates the computational domain is subdivided into a structured mesh of fixed rectangular cells in the numerical simulations the cell sizes are taken as δ x δ y δ z 10 mm the effect of the obstacle is simulated by the immersed boundary method at the start of the experiment the gate quickly moved upward and the water in the reservoir flowed forward owing to gravity and subsequently impacted on the obstacle figs 16 20 show some important frames from a video taken during the whole impact process between the dambreak induced free surface and the small obstacle in the experiment methylene blue dye was dissolved in the water to improve the clarity of the image the corresponding numerical isosurface results at the same recorded times are also shown in figs 16 20 for comparison it can be seen that after the gate opens the dambreak induced wave quickly spreads all over the dry area fig 16 a and b and reaches the obstacle fig 16 c and d one of the very early stages of the impact between the free surface and the obstacle is captured in fig 16 c and d from fig 16 a d it can be seen that the numerical results are generally in good agreement with the model results in terms of the shape of the free surface and the wave front location however the shape of the wave front reveals a certain difference between the numerical and experimental results notably the shape of the contact between the wave front and the obstacle differs in fig 16 c and d fig 17 a and c show the details of the wave front collision process associated with the interaction between the free surface and the downstream obstacle we can see that an upward moving jet is created at the wall and flips upward in front of the approaching dambreak induced wave as shown in fig 17 b and d the numerical solver is able to reproduce this phenomenon extremely well cooker and peregrine cooker and peregrine call this phenomenon in which the wave climbs the wall a flip through type wave in this process no air is trapped between the wall and the jet according to cooker and peregrine cooker and peregrine and hattori et al hattori et al 1994 collision mechanisms such as that due to an incoming wave are typically dominated mainly by inertia additionally the sudden upward deviation in flow is associated with a strong acceleration that produces high velocity gradients especially at the toe of the obstacle figs 17 c and 18 a illustrate how the wave front reaches its maximum elevation when the run up jet at the wall of the obstacle is decelerated by gravity this phenomenon can also be seen in the numerical isosurface results in figs 17 d and 18 b in fig 18 c the falling jet wave collapses onto the free surface of the incoming dambreak induced wave according to the results of the experiment francesca et al 2015 in fig 19 a and c the water from the plunging jet wave that splashes upward and forms a backflow creates new surges that rebound at the water surface and produce strong surface mixing along with air entrapment a stable shock wave then develops in front of the obstacle as can be seen in fig 19 c the front of this shock wave is disturbed and the rise in water depth is associated with turbulence and the entrainment of air pockets as shown in fig 19 b d and 20 b the numerical isosurface results show good agreement with the experimental results and the nonlinear deformation of the free surface is simulated well however the results for the thin water film at the edge of the fluid field differ between the numerical and experimental investigations at various times in the case of such thin films the current clsvof approach is not appropriate fig 21 shows a comparison between the experimental and numerical results for the force exerted on the obstacle it can be seen that both in terms of trend and numerical values the results of the numerical simulation agree well with the experimental results some 2d views of the jet wave climbing the wall of the obstacle are shown in fig 22 and the entire flip through process can be clearly seen 6 numerical simulation of a dambreak in a small reservoir with an obstacle the third experiment on a dambreak investigated in this study was originally proposed by koshizuka 1995 the scenario involved a small reservoir with an obstacle to test the large deformation of the free surface in a very short time as shown in fig 23 the domain in the experiment was square with side length 0 584 m the obstacle of height 0 048 m and width 0 024 m was located 0 292 m from the left wall the reservoir of length 0 1461 m width 0 30 m and height 0 292 m was located in the upstream portion of the domain at the initial time the partition was quickly removed and the fluid began to move under gravity in the numerical simulations the cell sizes are δ x δ y δ z 10 mm the effect of the obstacle is simulated by the immersed boundary method fig 24 compares the numerical and experimental results for the water height on the left wall x 0 0 m and z 0 15 m and pressure x 0 292 m y 0 024 m and z 0 15 m on the obstacle for the simulation process it can be seen that the numerical results are in good agreement with the experimental results except for a slight deviation in the water level due to the initial configuration of the experimental test device at the beginning figs 25 and 26 present experimental snapshots of the free surface together with the results of the numerical simulations during the process from a comparison of the numerical and experimental results at time t 0 1 s it can be seen that the water has not yet reached the right wall as illustrated in fig 25 a however in the experimental snapshot in fig 25 a a thin water layer can be observed flowing along the bottom of the wall and touching the obstacle this phenomenon is due to the small difference in the initial time required to open the gate in the experiment at t 0 2 s as shown in fig 25 b the wave front reaches the obstacle in both the numerical and experimental results and a water jet is then formed as a result of the interaction between the wave front and the obstacle after t 0 3 s as can be seen from fig 25 c the water volume is elongated by a vortex that has formed in the center of the domain in both the experiment and the numerical simulation a strong wave can be seen to splash from the top of the water column from fig 26 it can be seen after t 0 4 s the water volume reaches the right wall of the reservoir then under the force of gravity the wave front starts to fall experimentally it is found that an air cushion forms at the lower right corner koshizuka 1995 all these physical phenomena can be observed in fig 26 a c it can also be seen in fig 25 b and c that the wave tongue in the experiment appears to be pointing forward whereas in the numerical simulation it curves backward the reason for this is that the viewing angles in the experiment and simulation are different and the experimental device obstructs part of the view of the tongue similar results can be found in issakhov et al 2018 however it also can be seen from fig 25 b and c that in the experiment there exists a very strong water splash phenomena above the water tongue which was not successfully captured by our current model a possible reason for this is that the current grid configuration is not fine enough to capture such a strongly nonlinear phenomenon which can be attributed to the direct numerical simulation dns model that we have adopted therefore in future work we need to develop a large eddy simulation les model to extend the range of application of the numerical solver 7 numerical simulation of a dambreak flow over a tall rectangular obstacle in this section the case of a dambreak induced free surface interacting with a tall vertical rectangular obstacle is investigated the width of the obstacle in the simulation is much smaller than that of the tank since this case was originally designed to investigate interactions between tsunami waves and onshore structures accurate prediction results have real application value in this case the free surface evolution is expected to exhibit strong 3d effects a schematic of the scenario is presented in fig 27 the corresponding experiment was performed at the university of washington raad in the experiment a very thin 1 cm layer of water was initially present at the bottom of the water tank to reflect the real physical scenario of an ocean and coast the boundary conditions and mesh division method are the same as in previous sections since no flow enters the reservoir in the numerical simulations the cell sizes are taken as δ x δ y δ z 10 mm the effect of the obstacle is simulated by the immersed boundary method the simulated and experimental force exerted on the obstacle are shown in fig 28 it can be seen that the numerical result obtained using the clsvof method agrees well with the experimental result since the ability of the proposed numerical solver to capture the free surface deformation is an important aspect of this study the free surface deformation of a dambreak induced wave impacting on a tall obstacle as simulated by the clsvof method is shown in fig 29 the whole of the impact process is captured very well by the clsvof method furthermore fig 30 shows a comparison of the free surface at t 1 15 s obtained by a the δ sph method marrone et al 2011 and b the clsvof method as can be seen the two methods give similar results and both capture the highly nonlinear free surface well however the clsvof method gives a more realistic result and it can be seen that there is no distortion on the left side of the free surface in fig 30 b in contrast to that in a figs 31 33 show the interaction process between a dambreak induced free surface and a tall obstacle the interactions between the free surface and obstacle occur over a very short time after the gate opens the dambreak induced wave spreads freely over the initially dry downstream area and a cavity forms below the wave front as can be observed in fig 31 a thus the flow characteristics at this moment are mainly 2d in nature in fig 31 b the free surface reaches the obstacle the first cavity is disrupted by the obstacle and a second cavity forms behind the first cavity additionally the wave front begins to climb the wall of the obstacle in fig 32 a a third cavity forms behind the second cavity and all three cavities are disrupted by the obstacle a wave jet forms at the wall and flip ups in front of the approaching dambreak induced free surface the 3d and nonlinear effects of the flow field behind the obstacle begin to increase in strength in fig 32 b more cavities form and the 3d effect of the flow field increases with increasing distance from the obstacle in addition the jet formed by the wave front begins to splash upstream in fig 33 a and b when the wave front jet at the wall of the obstacle is decelerated by gravity the jet reaches its maximum elevation the front then breaks up and starts to detach from the vertical wall of the obstacle before overturning backward and rolling and plunging into the upstream water volume the nonlinearity of the flow field is very strong and the turbulence behind the obstacle is severe as indicated by the numerical results the clsvof method can effectively reproduce the 3d effects and nonlinear phenomena of the flow field and can provide a realistic simulation however it can also be seen from fig 33 a and b that the small water splashes in the air disappear after a period of time owing to numerical dissipation thus it would be difficult to precisely capture the long time movement of water splashes in the air even if a high precision scheme for interface capture were to be incorporated into the present approach of course increasing the grid number could partly solve this problem but further work is still necessary to improve a number of aspects of the liquid capture method 8 concluding remarks in this study the interactions between dambreak induced free surface deformation and different types of obstacle have been numerically investigated using 3d clsvof and immersed boundary methods by tracing the free surface moving over the obstacles we have compared the numerical simulation results with experimental data the results of the comparisons show that the numerical model developed in this study not only effectively simulates the entire process of dambreak induced nonlinear free surface movement but also reproduces the range of important 3d phenomena that occur around obstacles strongly nonlinear phenomena such as wave breaking and splashing and highly nonlinear free surface deformation remain obstacles to the success of two phase numerical flow simulations of the interaction between free surfaces and obstacles to a certain extent the use of the clsvof method can improve the results of simulation of these strongly nonlinear phenomena the numerical model demonstrated in this study provides a reliable approach for investigating the interactions between free surfaces and obstacles however it still lacks any means of treating the air entrapment and violent splashing that occur in experiments to improve the current model in future work we shall attempt to incorporate les and air bubble models with the aim of enhancing numerical accuracy and reducing the computational cost the solver developed here has potential for future applications in ocean and coastal engineering author contributions section we explain the contribution of each author of the paper paper oe d 19 01516 y l li wrote the code of the programs and the manuscript of this paper c p ma found the reference literature and proofread the paper the main work of x h zhang and k p wang was data and figure processing at last d p jiang conceived the structure as well as content of the whole paper and provided financial support declaration of competing interest we declare that we do not have any commercial or associative interest that represents a conflict of interestin connection with the work submitted acknowledgments this work was supported by the national natural science foundation of china grant no 51979129 the opening foundation of sichuan 481 univ state key lab hydraul mt river engn no skhl1820 and the financial support by the equipment development foundation of china grant no jzx7y20190252032901 
21744,the purpose of this paper is to investigate the speed loss based on the real life voyage data and weather reanalysis a methodology for coupling weather and voyage data is presented speed loss is investigated for a series of container ships of diﬀerent dimensions which are then compared with the existing methods for speed loss another approach in estimating voluntary speed reductions in high seas is having ﬁrst hand experience of the captains for this purpose we have designed and handed a questionnaire to ship masters this has provided additional insight to the decision making process during the voyages in rough weather conditions this analysis sets the ground for a more comprehensive study including various ship types sizes and weather conditions leading to more accurate prediction of wave loads fuel consumption or emissions from ships keywords voluntary speed loss vos database era interim shipmaster experience seakeeping 1 introduction ship s attainable speed calculations include voluntary and involuntary speed loss in waves the accuracy of this prediction has signiﬁcant eﬀect on the estimation of fuel consumption and even aspects of ship design such as the calculation of ship sea margin energy eﬃcient maritime transport is one of the most important topics in shipping the impact of emissions from marine transport have led to stricter regulations limiting the emissions from sea going vessels imo 2011 new technologies are being implemented to both the existing ﬂeet and the newbuildings in order to satisfy the regulations and endure in the competitive market inﬂuenced by fuel prices and crisis the technological measures for a more eﬃcient ship include improved engine ship hull and propeller design use of cleaner fuels low carbon content renewable energy sources lng logistic measures include weather routing vettor and guedes soares 2016a and ﬂeet management psaraftis 2012 within both issues predicting attainable speed is an important topic ship speed assessment inﬂuences ship route planning expected time of arrival fuel consumption and emissions estimations prpić oršić et al 2016 even more signiﬁcant problem arise from the estimation of speed in rough weather conditions speed loss in wind and waves is hard to assess accurately especially when considering voluntary speed reduction this is a matter of ship master s subjective decision based on his assessment of risk for crew and ship its omission from the speed considerations could result in overestimation of attainable speed prpić oršić and faltinsen 2012 the methods for estimation of ship performance in waves have been introduced in 60 s by aertssen 1966 1969 who did extensive measurements on board diﬀerent ships later on other authors presented their results based on new measurements lloyd and andrew 1977 andrew and lloyd 1981 or expert opinion lloyd 1989 seakeeping criteria and assessment of operational performance of ships was synthesized in the nordic cooperative project nordforsk 1987 where criteria related to the motion parameters or individual ship types have been established the estimation of vessels seakeeping performance including ship responses and their inﬂuence on the decisions made in exploitation is an important aspect of ship design this is related to the evaluation of alternative designs as well as the economic factors connected to speed loss fuel economy route planning and weather routing within this paper speed loss is described for the case of container ships in sections 2 and 3 ship voyage and weather data are described section 4 covers analysis of speed loss of 30 diﬀerent container ships in various weather conditions analysis of ship responses and comparison of speed loss with existing methods is made ship masters experience is obtained through a questionnaire and interviews which are focused on their estimation of ship speed in head beam and following waves in diﬀerent sea states 2 ship and weather data sources 2 1 voluntary observing ship program vos world meteorological organization wmo voluntary observing ships vos scheme is an international structure in which ships are recruited for reporting meteorological and oceanographic observations the scheme dates to 1853 when on an initiative of matthew f maury a standard form of ship logs and instructions were established apart for climatological purposes the ships meteorological observations are recognized as essential from the point of safety for ships at sea in the ﬁrst years of service the wmo vos fleet list had over 7700 ships worldwide and today that number is closer to 4000 ships most of the reports are concentrated around major shipping routes in the north atlantic and north paciﬁc oceans vos ship resource page 2017 presently the contribution of vos program remains signiﬁcant the marine observing systems contribute the global climate analysis and research ship reports complement satellite observations and contribute to the data input for the numerical weather prediction models they are also used in forecast and warning programs such as is global maritime distress and safety system gmdss the beneﬁts of the vos are visible ﬁrstly in the quantity of observations and the coverage of open oceans the estimation of wave height from the observations should be taken with caution as directly measured heights prove to be more accurate however there are several correlation studies available as reviewed in guedes soares 1986 vettor and guedes soares 2015 for example another issue with this data is the fact that ships tend to avoid bad weather and that there are some areas in the ocean that are not covered in shipping routes leading to data gaps however the data along ship routes is more important than in area with significant shipping activity and in fact the vos data can even be used to determine the main ship routes as well as the wave climate along these routes vettor and guedes soares 2015 which can then be translated in fuel consumption prpić oršić and faltinsen 2012 comparing these route wave climate with the general ones in wave hindcast datasets it is possible to estimate the effect of storm avoidance vettor and guedes soares 2016b which can even be extended to outside the main ship routes vettor and guedes soares 2016c the ships included in the vos scheme are requested to take and transmit observations every 6 h at 00z 06z 12z and 18z which coincides with most forecast synoptic times the main global numerical weather models runs correspond to 00z and 12z kalnay 2003 intermediate observations are used for regional scale models or initialization for the main global runs intermediate observations are also requested if a ship is located within 300 nm of a named tropical system experiencing strong winds 48 63 knots or seas greater that 12 ft observations can also be transmitted in any case the operator wants to alert the forecaster or the ships in the vicinity of some speciﬁc condition vos ships observe the following atmospheric pressure tendency and characteristics wind speed and direction air and wet bulb temperature and dew pint visibility cloud heights amount and type past and present weather ship course and speed sea surface temperature sea waves and swell period direction and height and ice conditions including icing on board ship vos scheme 2017 2 2 marinecadastre ais data marinecadastre was developed through a partnership between the u s department of commerce s national oceanic and atmospheric administration noaa oﬃce for coastal management and the u s department of the interior s bureau of ocean energy management boem marinecadastre is a system that provides data tools and support for ocean and great lakes planning and its original intent was to support renewable energy siting on the u s outer continental shelf marinecadastre website 2017 marinecadastre data registry provides direct access to all data gathered from their collaborators and providers vessel traﬃc data contains information for u s coastal water for the year 2009 to 2014 the automatic identiﬁcation system ais data collected by the u s coast guard through an onboard device the bureau of ocean energy management boem and the national oceanic and atmospheric administration noaa made parts of coast guard data available and the data extracted contains location time ship type speed length beam and draught this data is intended to help analyse marine transportation patterns and improve oﬀshore site analysis this type of data was previously not easily accessible a formal request to a coast guard had to be submitted and the data was limited marinecadastre oﬀers data from 2009 to 2014 for download organized in utm zones and months that cover entire united states each ﬁle contains broadcast points in 1 min time steps voyage data vessel data and base station data at the moment marinecadastre data was used as a supplement to the vos database providing the ship draught and missing ship data for the period it covers for the future research of the ais data will be focused on extracting high ﬁdelity ship voyage data that can be used in estimation of ship speed loss in the ocean going conditions automatic identiﬁcation system ais tracks vessel movements by exchanging the navigation data between vessel and base station terrestrial or satellite real time and historical ais data is often used in risk assessment route estimation and prediction and collision prevention silveira et al 2013 it can also be valuable tool in predicting ship master s decision in rough weather when coupled with weather conditions an overview of the ais data sources and data quality comparison is given in tu et al 2018 2 3 era interim data the most common sources of the data for global reanalysis datasets are voluntary observing ships buoys altimeters and synthetic aperture radars sar buoys oﬀer a wide amount of measurements but are ﬁxed to their locations the ship data has a high frequency of the reports but they are often lower in quality and limited to the shipping routes and the tendency of the ships to avoid the extreme conditions the sar data is considered useful when assessing frequency direction spectrum of the sea states climate reanalysis incorporates the observations and the numerical models and generate a synthesized estimate of the global state some of the most important datasets include the national centers for environmental prediction ncep global reanalysis i and ii r1 and r2 european centre for medium range weather forecasts ecmwf era and japan meteorological agency jma reanalysis era interim is a global atmospheric reanalysis it covers period from 1979 and is continued in real time the era interim project was introduced in 2006 and was to provide connection between era 40 1957 2002 and the next generation reanalysis the primary goal of era interim was to improve data assimilation problems and aspects such as data selection quality control bias correction and performance monitoring the next project of ecmwf was planned to cover the entire twentieth century reanalysis was ﬁrst introduced through exploitation of meteorological data which was used to expand the observation data for initialization of numerical weather forecasts it was soon noticed that the reanalysed data can be of value when it comes to atmospheric research it provided a comprehensive record of global atmospheric circulation spatially complete and continuous this gives way to explore variabilities on diﬀerent time scales explore trends climate change indicators etc there are two main requirements of the reanalysis first it must represent the available observations and second it has to be physically coherent such realistic models are then able to extrapolate information from the observed parameters to the unobserved parameters at the nearby locations the era interim reanalysis is using sequential data assimilation with advance cycle of 12 h each cycle combines observations and data from the forecast model in order to estimate the state of the global atmosphere temperature winds surface pressure or soil temperature ocean waves etc the analyses are used to initialize short range model forecast that serves the next analysis cycle physical parameters such as cloud properties soil moisture or precipitation are not observed but are assessed from the constraints of the observed parameters dee et al 2011 the era interim reanalysis contains three fully coupled components for the atmosphere land surface and ocean waves this is called incorporated forecast system ifs the wave model in the ifs is based on the wam model komen et al 1994 the impact of waves on airﬂow is represented as the transfer of energy and momentum two way coupling is made with atmospheric parameters that inﬂuence wave growth and the impact of the sea state on surface roughness the horizontal resolution of the wave model in era interim is 110 km wave spectra are discretized using 24 directions and 30 frequencies dee et al 2011 a comparison between the era interim data set and others can be found in campos and guedes soares 2016a 2016b 3 establishing a joint database 3 1 ship data the ship voyage information was obtained over the international comprehensive ocean atmosphere data set icoads freeman et al 2017 the database contains observations combined from various sources automated gauges c man stations and coastal stations drifting buoys ﬁxed ocean platforms ice stations moored buoys ocean stations or ships each contributing with the information speciﬁc to their environments the frequency of the reports from the sources varies from several observations per hour as may be expected from buoys or platforms to several observations per day as is the case with ships although this database is designed as a source of meteorological reports only conjoined positional data is being used here only the ships are observed and the rest is ﬁltered out the database contains various ship related information ship s name country of registration call sign imo number vessel type and data related to the ship dimensions the latter include overall length of the ship moulded breadth freeboard draught cargo height the distance from the bridge to the bow and service speed the database also includes the information for the routes that the ship sails and general data related to the weather observations such as the position and type of the anemometers barometers hygrometers etc wmo 1957 fig 1 shows the example of the routes extracted for the case of containerships from the reported geographical positions it is possible to reconstruct ship speed and heading the ellipsoidal distance and azimuth between reported points are calculated using vincenty s formulae equations 1 and 2 vincenty 1975 the calculations are made for the ellipsoidal earth model and a pair of longitude latitude points ϕ 1 l 1 and ϕ 2 l 2 as following the average speed is then obtained by introducing the time elapsed between observations u 1 and u 2 reduced latitude on the auxiliary sphere are calculated and initial value of λ difference in longitude of the points on the auxiliary sphere is set to l l 2 l 1 parameters σ represents angular separation between points σ m angular separation between the midpoint of the line and the equator α forward azimuth of the geodesic at the equator f flattening of the ellipsoid 1 sin σ cos u 2 sin λ 2 cos u 1 sin u 2 sin u 1 cos u 2 cos λ 2 cos σ sin u 1 sin u 2 cos u 1 cos u 2 cos λ σ arctan 2 sin σ cos σ sin α cos u 1 cos u 2 sin λ sin σ cos 2 σ m cos σ 2 sin u 1 sin u 2 cos 2 α c f 16 cos 2 α 4 f 4 3 cos 2 α λ l 1 c f sin α σ c sin σ cos 2 σ m c cos σ 1 2 cos 2 2 σ m after λ has converged to the desired degree of accuracy we can evaluate following with s being ellipsoidal distance between the two points and α 1 α 2 forward azimuths at the points 2 u 2 cos 2 α a 2 b 2 b 2 a 1 u 2 16384 4096 u 2 768 u 2 320 175 u 2 b u 2 1024 256 u 2 128 u 2 74 47 u 2 δ σ b sin σ cos 2 σ m 1 4 b cos σ 1 2 cos 2 2 σ m b 6 cos 2 σ m 3 4 sin 2 σ 3 4 cos 2 2 σ m s b a σ δ σ α 1 arctan 2 cos u 2 sin λ cos u 1 sin u 2 sin u 1 cos u 2 cos λ α 2 arctan 2 cos u 1 sin λ sin u 1 cos u 2 cos u 1 sin u 2 cos λ weather reported from the ships is not used due to the inconsistencies in the observations but the ship reports provide a valuable tool for ﬁltering the data to the present speciﬁc needs ships can be observed in groups divided for example by ship length or by ship type when considering the speed loss of merchant ships there are several types of ships that are of special interest bulk carriers containerships general cargo passenger ships and liquid tankers will be observed with more attention when considering speed loss in higher sea states ships like dredgers icebreakers pipe layers tugs and similar are not practical for observation due to their speciﬁc service demands 3 2 weather data weather data was acquired by accessing ecmwf public datasets ecmwf 2017 the information is archived in a 0 75 0 75 latitude longitude grid and covers a time period from 1979 to the present time step is 6 h increment starting at 00 00 h in terms of weather we are interested in mean wave period signiﬁcant wave height of combined waves and swell 10 m wind components and wind gusts significant wave height represents the average height of the highest third of surface ocean sea waves generated by wind and swell it represents the vertical distance between the wave crest and the wave trough mean wave period is the average time it takes for two consecutive wave crests on the surface of the ocean sea to pass through a fixed point it takes into account both wind sea waves and swell the report is obtained in grib format ecmwf provides a wide amount of tools and recommendations for easier accessing and decoding the data and in this case eccodes ecmwf software 2017 by emcwf and panoply 2017 by nasa are used for decoding and visualizing the weather parameters the example of the global view of signiﬁcant wave height is shown in fig 2 in terms of combining weather information with the locations reported by the ships a script available at the ecmwf site is used panoply 2017 since the time stamps of the ship reports often do not coincide with the times in the weather reanalysis the script was modiﬁed to report the data from the times before and after the observation the intermediate result corresponding to the exact time was linearly interpolated from the bordering reports example when ship mark a geographical position at 03 00 h the weather at that point is considered as the mean value of the readings at 00 00 h and 06 00 h of the era interim data 3 3 data accuracy after ﬁltering the superﬂuous data from the voyage database a merger with the weather input is made the remaining information include ship location speed and bearing all available ship data and joined weather weather encounter angle is derived from the ship bearing and wind and wave directions an analysis of the attainable speed in relation to the weather conditions can now be made in order to have an estimation as accurate as possible special attention should be given to the cases that would in some way diverge from the assessment of speed in unbounded ocean going conditions the observations that were excluded from the point of ship voyage are from the ships closing in to ports their speed might be inﬂuenced by the traﬃc or scheduling from the ports or the charterers another type of reports not used in this analysis is the positional data for the time steps longer than 6 h voyage data with large weather diﬀerences have been avoided this is also considered to reduce accuracy of the present assessment if from one observation to another signiﬁcant wave height varies more than 1 m the data is ﬁltered out in this manner consistent weather circumstances are ensured when evaluating the average speed the vos data are extensive around 4000 ships worldwide kent et al 2010 and they provide information over the open oceans some gaps can be noticed in the areas that do not belong to the common sailing routes that alone is not as signiﬁcant for this analysis as a tendency of ships for avoiding bad weather conditions leaving a database limited with voyage data in the high seas then again when a ship experiences strong winds or seas higher than 3 6 m or is in proximity of a named tropical system intermediate observations are commonly requested as a result additional data in the conditions of interest is provided the direct use of the weather reports from ships is unreliable and the coverage would not be suﬃcient for all the cases of interest the era interim is a valuable set of global climate data that incorporates information from voluntary observing ships and other sources of weather observations the quality of era interim data is discussed in stopa and cheung 2014 campos and guedes soares 2016a 2016b and compared with ncep climate forecast system reanalysis wind and wave heights were compared with buoy observations and error metrics are reported era interim is described as better compared to cfrs in estimating wind speed having lower rms lager correlation coeﬃcients and smaller scatter indices as for the signiﬁcant wave height both datasets are described to have small rmses 0 5 m high correlation coeﬃcients and scatter indices with era dataset maintaining somewhat better error metrics more general conclusion states that era interim proves to be homogeneous in time but underestimates wind speed and wave height especially in the cases of extreme events not having any observations in phenomenal weather this dataset was chosen for the present study 4 speed loss of containerships 4 1 analysis of speed loss using voyage and weather data the vos database covering the dates from 1 1 2009 to 1 1 2015 was analysed in order to obtain a clear comparison this analysis was focused on containerships only the structure of the database considering ship dimensions is presented in fig 3 the most represented ships are larger than 280 m followed by ships from 260 to 280 m smaller size ships appear less frequently as the study has focused on the routes in higher sea states this under representation of smaller size containerships is understandable the lower amount of cargo that they carry can make them less suited for the ocean transport signiﬁcantly smaller ships may experience more intensive adverse eﬀects and be prone to reducing the speed much earlier than larger ships in the present case the majority of observations are from ships with lengths 280 300 m fig 3 a which will be the focus of the study as for the beams as seen in fig 3 b the most common are panamax ships while draughts vary between 10 and 14 5 m fig 3 c this database describes the behaviour of ships in realistic unbounded ocean going conditions the ships with only one reported position have been ﬁltered out neither the speed nor course could be assessed from an isolated report within the topic being studied these points are not useful although they hold useful values when it comes to meteorological predictions for which this database is originally designed having ﬁltered the database and extracting only routes of interest a ﬁnal number of around 250 observations from 30 diﬀerent container ships is established ship speed is expressed as a percentage of the design speed design speeds for the whole database are taken from the ihs markit maritime database weather conditions encountered were seas of significant wave height higher than 1 m which covers moderate to rough and very rough seas corresponding to wmo sea states 4 and higher no observations of very high and phenomenal seas were found in this sample which can be explained by the fact that ships tend to avoid these conditions vettor and guedes soares 2016b 2016c attained speed in correlation with the speciﬁc wave height of the observed database is shown in fig 4 a trend in the data is visible observing ﬁrst the speed in the lowest sea states almost no ships were sailing at their design speed the reasons for lower speeds in what could be considered mild weather conditions are various deterioration of the conditions of the hull and propeller wear and deterioration of the main and auxiliary engines performance wear of bearings and seals are all possible reasons for increase of power and fuel consumption or lowering speeds bialystocki and konovessis 2016 another reason for this behaviour can be seen in the fact that the period being observed 2009 2016 belongs to the crisis caused by the increase in the available capacities parallel with lower shipping requirements and increase of fuel costs cariou 2011 it can be observed that the data presented in fig 4 is scattered at this point it is important to emphasize that the analysis is for container ships of various dimensions and wind and wave encounter angles also the exact draught and ship loading condition are not always known this may be inﬂuential as well since ship behaviour in rough weather can vary depending on the loading condition ichinose et al 2012 the service data of operation of a reasonable number of containerships guedes soares and dias 1996 can provide some idea about the expected variability of loading conditions in this type of ships looking at the general trend in the data the average attained speed drops to 70 75 with lowest values of around 60 of the design speed in fig 5 the speed loss was observed as a function of wave encounter angle following waves are taken to be waves coming to the stern quartering waves at 60 beam waves are described as the waves coming parallel to the ship and 30 to the stern and to the bow head waves include directions straight to the bow and up to 60 bow quartering waves the trends clearly indicate diﬀerent behaviour of ships in relation to the wave encounter angle the lowest reduction of speed is observed in following waves and the highest in head seas as this speed reduction includes both voluntary and involuntary loss it should be noted that the largest added resistance can be expected in head wave conditions vitali et al 2016 head waves are defined with an angle of 1800 while following waves correspond to the angle of 00 the rate at which the ship encounters each of the mentioned wave directions is shown in fig 6 a the distribution of the wave encounter angles generally indicate that when sailing in rough weather ships tend to avoid beam waves a feature that was already noted in guedes soares 1990 naturally more favourable conditions are following waves and bow quartering waves distribution of wind encounter angles fig 6 b seems more even with no apparent preferable wind encounter angle fig 7 shows speed loss decomposed by the encounter angles with the increment of 300 in following waves the ship manages to maintain the speed even in higher sea states see fig 7 a and b the attained speed remained around 80 and with a mild downward trend the situation is more pronounced in the beam waves see fig 7 c and d where speed loss is larger and for the highest states goes up to 75 of the design speed the speed loss is the most noticeable in head waves see fig 7 e and f with mean values of attained speed around 70 and isolated cases going as low as the 60 of the maximum speed for a ship with design speed of 20 knots this would mean reducing the speed down to 14 knots due to weather the trend in the data has been estimated using linear regression for demonstrative purposes an estimate of error is made using correlation coefficients and standard error estimate it is visible that for all the cases the standard error of the regression is between 5 6 and 7 of the design speed 4 2 comparison with theoretical methods for speed loss the ships focused in this study have lengths between 280 300 m to be able to examine the behaviour of the observed ships a representative of the sample is chosen for analysis the selected ship is a panamax containership with dimensions as described in table 1 the empirical or semi empirical formulations were an important tool when hydrodynamic calculations and computational power were not as advanced as they are today they have however remained valuable from the point of quick estimation of ship behaviour in ocean going conditions one of the earliest attempts in describing speed loss in waves was done by aertssen 1966 the estimation was based on ship length and values associated with beaufort number and the direction of incoming waves head bow beam or following as shown in as seen in equation 3 this formulation does not consider ship type nor loading condition 3 μ δ v v 100 m l p p n table 2 summarizes the coeﬃcients for the estimation of speed loss in various weather conditions townsin and kwon 1982 later updated by kwon 2008 have developed an approximate formulae for the percentage of speed loss due to added resistance in wind and waves formulation for containerships in head waves loaded condition and block coeﬃcients cb 0 5 0 6 0 65 0 7 the signiﬁcant wave height corresponding to the beaufort number is derived as originally published in townsin and kwon 1982 by using the wind speed at 10 m above the sea surface 4 μ δ v v 100 0 7 b n b n 6 5 22 2 3 n the formula is corrected for weather direction factor μ allowing to express speed loss in bow beam and following waves as well as shown in table 3 the two mentioned formulations agree well among each other but not to the voyage data the results are presented in fig 8 for head beam and following waves in head waves the results agree reasonably well except in the highest sea states 5 m and up but the speed loss of the observed sample is more gradual than the sharp drop of the empirical methods speed in beam and following waves is found to be overestimated the empirical methods assume that the ship initially sails at the design speed so observed diﬀerences are understandable the development of the new formulations based on real life data would signiﬁcantly improve the estimation of realistic speed in the rough weather further on it can be introduced to a voyage routing or emission estimation calculations widening their applicability and accuracy in rough weather conditions 4 3 estimation of speed loss using expert experience a speed loss in a seaway can be distributed on two main eﬀects voluntary and involuntary the reasons for reducing the speed in rough weather are various involuntary reasons include the external eﬀects the wind waves or motions of the ship additional resistance in waves wind variation of underwater form due to the motions decrease of the propulsion characteristics because of the ship motions increase of resistance aeration or change in wake and thrust deduction all inﬂuence the ship speed voluntary reasons include captain s reaction to the events that can be threatening to ship cargo or the crew high amplitudes of motion velocities bow impacts deck wetness overload of the main engine changes in propeller rate can all result in a decision to lower the speed or adjust the heading in high sea states the decisions are also inﬂuenced by the type of ship draft trim ships state main engine etc ship master may decide to lower the speed due to concerns for crew and cargo safety caused by severe motions slamming shipping green water propeller emergence prpić oršić and faltinsen 2012 expert opinion was gathered using a questionnaire speciﬁcally designed for this purpose see fig 9 the ship masters and higher ranking oﬃcers everyone that can understand and make decisions related to reduction of ship speed were included in this survey the survey was conducted from spring to winter 2016 mostly with ship crew that attended a training at faculty of maritime studies in rijeka the remaining questionnaires were obtained through electronic communication with assistance of cma ships rijeka that facilitated the distribution of questionnaire to their team overall around 50 responses were received of which 13 representing experience from containerships ship masters were asked to estimate at what speed they would sail through an area under the inﬂuence of the weather described by diﬀerent sea states and weather encounter angles the second part of the questionnaire not used in this paper asks for the opinion on reduction of speed because of excessive motions accelerations or events such as slamming and propeller emergence they are requested to describe how many slams or green water occurrences they would tolerate in a unit of time of their own choosing before they decide to reduce the speed these results are directly connected to the limiting seakeeping criteria but in order to unambiguously redeﬁne them larger response sample is needed in order to do this we are continuing to conduct this survey only containerships are observed in order to be able to compare these results with previous methods of assessing speed loss the sample of 13 containerships is presented not all the questionnaires had the results in beam or following waves which can be accounted to the fact that those assessments were more diﬃcult to make for beam and following waves 8 answers were delivered the range of lengths of the ships is 260 300 m and all of them are taken under consideration due to the small sample size this is still in the close range of the observed ships dimensions results are presented in fig 10 where we can see very good correlation between ship master s estimations and voyage data the trends and the slope correspond well in all directions in the lowest sea states we can see that the captains tend to indicate that they would maintain maximum speed in realistic situations the ship would have already had lost some speed which would explain the discrepancies of the questionnaire results with the voyage data 5 conclusions in this paper the speed loss of container ships in a seaway is analysed a series of voyages was observed and integrated with weather data the ship speed showed clear trends in relation to the wave encounter angles some insight is made on the frequency of encounter angles and how the beam waves are most commonly avoided when it comes to comparing the real life voyage data with the existing methods for estimation of speed some discrepancies are found this indicates that the formulations for the estimation of speed loss in a seaway need updating the same can be concluded for the seakeeping criteria which could be uniﬁed and or restated for each ship type on an individual basis considering speciﬁcities of their design and service demands signiﬁcantly better agreement is found using captain s subjective estimation of speed which means that human experience can be a valuable tool for this research acknowledgements we would like to thank cma ships croatia and captains dragan milatović and peter dolinsek for their support as well as their help in distributing the questionnaires special thanks to srdan žuškin from faculty of maritime studies university of rijeka who had greatly contributed to this research by introducing it to the ship captains participating in their trainings this work has been fully supported by the croatian science foundation under the project project ip 2018 01 3739 this work was alsosupported by the university of rijeka project no uniri tehnic 18 18 1146 and uniri tehnic 18 2666469 
21744,the purpose of this paper is to investigate the speed loss based on the real life voyage data and weather reanalysis a methodology for coupling weather and voyage data is presented speed loss is investigated for a series of container ships of diﬀerent dimensions which are then compared with the existing methods for speed loss another approach in estimating voluntary speed reductions in high seas is having ﬁrst hand experience of the captains for this purpose we have designed and handed a questionnaire to ship masters this has provided additional insight to the decision making process during the voyages in rough weather conditions this analysis sets the ground for a more comprehensive study including various ship types sizes and weather conditions leading to more accurate prediction of wave loads fuel consumption or emissions from ships keywords voluntary speed loss vos database era interim shipmaster experience seakeeping 1 introduction ship s attainable speed calculations include voluntary and involuntary speed loss in waves the accuracy of this prediction has signiﬁcant eﬀect on the estimation of fuel consumption and even aspects of ship design such as the calculation of ship sea margin energy eﬃcient maritime transport is one of the most important topics in shipping the impact of emissions from marine transport have led to stricter regulations limiting the emissions from sea going vessels imo 2011 new technologies are being implemented to both the existing ﬂeet and the newbuildings in order to satisfy the regulations and endure in the competitive market inﬂuenced by fuel prices and crisis the technological measures for a more eﬃcient ship include improved engine ship hull and propeller design use of cleaner fuels low carbon content renewable energy sources lng logistic measures include weather routing vettor and guedes soares 2016a and ﬂeet management psaraftis 2012 within both issues predicting attainable speed is an important topic ship speed assessment inﬂuences ship route planning expected time of arrival fuel consumption and emissions estimations prpić oršić et al 2016 even more signiﬁcant problem arise from the estimation of speed in rough weather conditions speed loss in wind and waves is hard to assess accurately especially when considering voluntary speed reduction this is a matter of ship master s subjective decision based on his assessment of risk for crew and ship its omission from the speed considerations could result in overestimation of attainable speed prpić oršić and faltinsen 2012 the methods for estimation of ship performance in waves have been introduced in 60 s by aertssen 1966 1969 who did extensive measurements on board diﬀerent ships later on other authors presented their results based on new measurements lloyd and andrew 1977 andrew and lloyd 1981 or expert opinion lloyd 1989 seakeeping criteria and assessment of operational performance of ships was synthesized in the nordic cooperative project nordforsk 1987 where criteria related to the motion parameters or individual ship types have been established the estimation of vessels seakeeping performance including ship responses and their inﬂuence on the decisions made in exploitation is an important aspect of ship design this is related to the evaluation of alternative designs as well as the economic factors connected to speed loss fuel economy route planning and weather routing within this paper speed loss is described for the case of container ships in sections 2 and 3 ship voyage and weather data are described section 4 covers analysis of speed loss of 30 diﬀerent container ships in various weather conditions analysis of ship responses and comparison of speed loss with existing methods is made ship masters experience is obtained through a questionnaire and interviews which are focused on their estimation of ship speed in head beam and following waves in diﬀerent sea states 2 ship and weather data sources 2 1 voluntary observing ship program vos world meteorological organization wmo voluntary observing ships vos scheme is an international structure in which ships are recruited for reporting meteorological and oceanographic observations the scheme dates to 1853 when on an initiative of matthew f maury a standard form of ship logs and instructions were established apart for climatological purposes the ships meteorological observations are recognized as essential from the point of safety for ships at sea in the ﬁrst years of service the wmo vos fleet list had over 7700 ships worldwide and today that number is closer to 4000 ships most of the reports are concentrated around major shipping routes in the north atlantic and north paciﬁc oceans vos ship resource page 2017 presently the contribution of vos program remains signiﬁcant the marine observing systems contribute the global climate analysis and research ship reports complement satellite observations and contribute to the data input for the numerical weather prediction models they are also used in forecast and warning programs such as is global maritime distress and safety system gmdss the beneﬁts of the vos are visible ﬁrstly in the quantity of observations and the coverage of open oceans the estimation of wave height from the observations should be taken with caution as directly measured heights prove to be more accurate however there are several correlation studies available as reviewed in guedes soares 1986 vettor and guedes soares 2015 for example another issue with this data is the fact that ships tend to avoid bad weather and that there are some areas in the ocean that are not covered in shipping routes leading to data gaps however the data along ship routes is more important than in area with significant shipping activity and in fact the vos data can even be used to determine the main ship routes as well as the wave climate along these routes vettor and guedes soares 2015 which can then be translated in fuel consumption prpić oršić and faltinsen 2012 comparing these route wave climate with the general ones in wave hindcast datasets it is possible to estimate the effect of storm avoidance vettor and guedes soares 2016b which can even be extended to outside the main ship routes vettor and guedes soares 2016c the ships included in the vos scheme are requested to take and transmit observations every 6 h at 00z 06z 12z and 18z which coincides with most forecast synoptic times the main global numerical weather models runs correspond to 00z and 12z kalnay 2003 intermediate observations are used for regional scale models or initialization for the main global runs intermediate observations are also requested if a ship is located within 300 nm of a named tropical system experiencing strong winds 48 63 knots or seas greater that 12 ft observations can also be transmitted in any case the operator wants to alert the forecaster or the ships in the vicinity of some speciﬁc condition vos ships observe the following atmospheric pressure tendency and characteristics wind speed and direction air and wet bulb temperature and dew pint visibility cloud heights amount and type past and present weather ship course and speed sea surface temperature sea waves and swell period direction and height and ice conditions including icing on board ship vos scheme 2017 2 2 marinecadastre ais data marinecadastre was developed through a partnership between the u s department of commerce s national oceanic and atmospheric administration noaa oﬃce for coastal management and the u s department of the interior s bureau of ocean energy management boem marinecadastre is a system that provides data tools and support for ocean and great lakes planning and its original intent was to support renewable energy siting on the u s outer continental shelf marinecadastre website 2017 marinecadastre data registry provides direct access to all data gathered from their collaborators and providers vessel traﬃc data contains information for u s coastal water for the year 2009 to 2014 the automatic identiﬁcation system ais data collected by the u s coast guard through an onboard device the bureau of ocean energy management boem and the national oceanic and atmospheric administration noaa made parts of coast guard data available and the data extracted contains location time ship type speed length beam and draught this data is intended to help analyse marine transportation patterns and improve oﬀshore site analysis this type of data was previously not easily accessible a formal request to a coast guard had to be submitted and the data was limited marinecadastre oﬀers data from 2009 to 2014 for download organized in utm zones and months that cover entire united states each ﬁle contains broadcast points in 1 min time steps voyage data vessel data and base station data at the moment marinecadastre data was used as a supplement to the vos database providing the ship draught and missing ship data for the period it covers for the future research of the ais data will be focused on extracting high ﬁdelity ship voyage data that can be used in estimation of ship speed loss in the ocean going conditions automatic identiﬁcation system ais tracks vessel movements by exchanging the navigation data between vessel and base station terrestrial or satellite real time and historical ais data is often used in risk assessment route estimation and prediction and collision prevention silveira et al 2013 it can also be valuable tool in predicting ship master s decision in rough weather when coupled with weather conditions an overview of the ais data sources and data quality comparison is given in tu et al 2018 2 3 era interim data the most common sources of the data for global reanalysis datasets are voluntary observing ships buoys altimeters and synthetic aperture radars sar buoys oﬀer a wide amount of measurements but are ﬁxed to their locations the ship data has a high frequency of the reports but they are often lower in quality and limited to the shipping routes and the tendency of the ships to avoid the extreme conditions the sar data is considered useful when assessing frequency direction spectrum of the sea states climate reanalysis incorporates the observations and the numerical models and generate a synthesized estimate of the global state some of the most important datasets include the national centers for environmental prediction ncep global reanalysis i and ii r1 and r2 european centre for medium range weather forecasts ecmwf era and japan meteorological agency jma reanalysis era interim is a global atmospheric reanalysis it covers period from 1979 and is continued in real time the era interim project was introduced in 2006 and was to provide connection between era 40 1957 2002 and the next generation reanalysis the primary goal of era interim was to improve data assimilation problems and aspects such as data selection quality control bias correction and performance monitoring the next project of ecmwf was planned to cover the entire twentieth century reanalysis was ﬁrst introduced through exploitation of meteorological data which was used to expand the observation data for initialization of numerical weather forecasts it was soon noticed that the reanalysed data can be of value when it comes to atmospheric research it provided a comprehensive record of global atmospheric circulation spatially complete and continuous this gives way to explore variabilities on diﬀerent time scales explore trends climate change indicators etc there are two main requirements of the reanalysis first it must represent the available observations and second it has to be physically coherent such realistic models are then able to extrapolate information from the observed parameters to the unobserved parameters at the nearby locations the era interim reanalysis is using sequential data assimilation with advance cycle of 12 h each cycle combines observations and data from the forecast model in order to estimate the state of the global atmosphere temperature winds surface pressure or soil temperature ocean waves etc the analyses are used to initialize short range model forecast that serves the next analysis cycle physical parameters such as cloud properties soil moisture or precipitation are not observed but are assessed from the constraints of the observed parameters dee et al 2011 the era interim reanalysis contains three fully coupled components for the atmosphere land surface and ocean waves this is called incorporated forecast system ifs the wave model in the ifs is based on the wam model komen et al 1994 the impact of waves on airﬂow is represented as the transfer of energy and momentum two way coupling is made with atmospheric parameters that inﬂuence wave growth and the impact of the sea state on surface roughness the horizontal resolution of the wave model in era interim is 110 km wave spectra are discretized using 24 directions and 30 frequencies dee et al 2011 a comparison between the era interim data set and others can be found in campos and guedes soares 2016a 2016b 3 establishing a joint database 3 1 ship data the ship voyage information was obtained over the international comprehensive ocean atmosphere data set icoads freeman et al 2017 the database contains observations combined from various sources automated gauges c man stations and coastal stations drifting buoys ﬁxed ocean platforms ice stations moored buoys ocean stations or ships each contributing with the information speciﬁc to their environments the frequency of the reports from the sources varies from several observations per hour as may be expected from buoys or platforms to several observations per day as is the case with ships although this database is designed as a source of meteorological reports only conjoined positional data is being used here only the ships are observed and the rest is ﬁltered out the database contains various ship related information ship s name country of registration call sign imo number vessel type and data related to the ship dimensions the latter include overall length of the ship moulded breadth freeboard draught cargo height the distance from the bridge to the bow and service speed the database also includes the information for the routes that the ship sails and general data related to the weather observations such as the position and type of the anemometers barometers hygrometers etc wmo 1957 fig 1 shows the example of the routes extracted for the case of containerships from the reported geographical positions it is possible to reconstruct ship speed and heading the ellipsoidal distance and azimuth between reported points are calculated using vincenty s formulae equations 1 and 2 vincenty 1975 the calculations are made for the ellipsoidal earth model and a pair of longitude latitude points ϕ 1 l 1 and ϕ 2 l 2 as following the average speed is then obtained by introducing the time elapsed between observations u 1 and u 2 reduced latitude on the auxiliary sphere are calculated and initial value of λ difference in longitude of the points on the auxiliary sphere is set to l l 2 l 1 parameters σ represents angular separation between points σ m angular separation between the midpoint of the line and the equator α forward azimuth of the geodesic at the equator f flattening of the ellipsoid 1 sin σ cos u 2 sin λ 2 cos u 1 sin u 2 sin u 1 cos u 2 cos λ 2 cos σ sin u 1 sin u 2 cos u 1 cos u 2 cos λ σ arctan 2 sin σ cos σ sin α cos u 1 cos u 2 sin λ sin σ cos 2 σ m cos σ 2 sin u 1 sin u 2 cos 2 α c f 16 cos 2 α 4 f 4 3 cos 2 α λ l 1 c f sin α σ c sin σ cos 2 σ m c cos σ 1 2 cos 2 2 σ m after λ has converged to the desired degree of accuracy we can evaluate following with s being ellipsoidal distance between the two points and α 1 α 2 forward azimuths at the points 2 u 2 cos 2 α a 2 b 2 b 2 a 1 u 2 16384 4096 u 2 768 u 2 320 175 u 2 b u 2 1024 256 u 2 128 u 2 74 47 u 2 δ σ b sin σ cos 2 σ m 1 4 b cos σ 1 2 cos 2 2 σ m b 6 cos 2 σ m 3 4 sin 2 σ 3 4 cos 2 2 σ m s b a σ δ σ α 1 arctan 2 cos u 2 sin λ cos u 1 sin u 2 sin u 1 cos u 2 cos λ α 2 arctan 2 cos u 1 sin λ sin u 1 cos u 2 cos u 1 sin u 2 cos λ weather reported from the ships is not used due to the inconsistencies in the observations but the ship reports provide a valuable tool for ﬁltering the data to the present speciﬁc needs ships can be observed in groups divided for example by ship length or by ship type when considering the speed loss of merchant ships there are several types of ships that are of special interest bulk carriers containerships general cargo passenger ships and liquid tankers will be observed with more attention when considering speed loss in higher sea states ships like dredgers icebreakers pipe layers tugs and similar are not practical for observation due to their speciﬁc service demands 3 2 weather data weather data was acquired by accessing ecmwf public datasets ecmwf 2017 the information is archived in a 0 75 0 75 latitude longitude grid and covers a time period from 1979 to the present time step is 6 h increment starting at 00 00 h in terms of weather we are interested in mean wave period signiﬁcant wave height of combined waves and swell 10 m wind components and wind gusts significant wave height represents the average height of the highest third of surface ocean sea waves generated by wind and swell it represents the vertical distance between the wave crest and the wave trough mean wave period is the average time it takes for two consecutive wave crests on the surface of the ocean sea to pass through a fixed point it takes into account both wind sea waves and swell the report is obtained in grib format ecmwf provides a wide amount of tools and recommendations for easier accessing and decoding the data and in this case eccodes ecmwf software 2017 by emcwf and panoply 2017 by nasa are used for decoding and visualizing the weather parameters the example of the global view of signiﬁcant wave height is shown in fig 2 in terms of combining weather information with the locations reported by the ships a script available at the ecmwf site is used panoply 2017 since the time stamps of the ship reports often do not coincide with the times in the weather reanalysis the script was modiﬁed to report the data from the times before and after the observation the intermediate result corresponding to the exact time was linearly interpolated from the bordering reports example when ship mark a geographical position at 03 00 h the weather at that point is considered as the mean value of the readings at 00 00 h and 06 00 h of the era interim data 3 3 data accuracy after ﬁltering the superﬂuous data from the voyage database a merger with the weather input is made the remaining information include ship location speed and bearing all available ship data and joined weather weather encounter angle is derived from the ship bearing and wind and wave directions an analysis of the attainable speed in relation to the weather conditions can now be made in order to have an estimation as accurate as possible special attention should be given to the cases that would in some way diverge from the assessment of speed in unbounded ocean going conditions the observations that were excluded from the point of ship voyage are from the ships closing in to ports their speed might be inﬂuenced by the traﬃc or scheduling from the ports or the charterers another type of reports not used in this analysis is the positional data for the time steps longer than 6 h voyage data with large weather diﬀerences have been avoided this is also considered to reduce accuracy of the present assessment if from one observation to another signiﬁcant wave height varies more than 1 m the data is ﬁltered out in this manner consistent weather circumstances are ensured when evaluating the average speed the vos data are extensive around 4000 ships worldwide kent et al 2010 and they provide information over the open oceans some gaps can be noticed in the areas that do not belong to the common sailing routes that alone is not as signiﬁcant for this analysis as a tendency of ships for avoiding bad weather conditions leaving a database limited with voyage data in the high seas then again when a ship experiences strong winds or seas higher than 3 6 m or is in proximity of a named tropical system intermediate observations are commonly requested as a result additional data in the conditions of interest is provided the direct use of the weather reports from ships is unreliable and the coverage would not be suﬃcient for all the cases of interest the era interim is a valuable set of global climate data that incorporates information from voluntary observing ships and other sources of weather observations the quality of era interim data is discussed in stopa and cheung 2014 campos and guedes soares 2016a 2016b and compared with ncep climate forecast system reanalysis wind and wave heights were compared with buoy observations and error metrics are reported era interim is described as better compared to cfrs in estimating wind speed having lower rms lager correlation coeﬃcients and smaller scatter indices as for the signiﬁcant wave height both datasets are described to have small rmses 0 5 m high correlation coeﬃcients and scatter indices with era dataset maintaining somewhat better error metrics more general conclusion states that era interim proves to be homogeneous in time but underestimates wind speed and wave height especially in the cases of extreme events not having any observations in phenomenal weather this dataset was chosen for the present study 4 speed loss of containerships 4 1 analysis of speed loss using voyage and weather data the vos database covering the dates from 1 1 2009 to 1 1 2015 was analysed in order to obtain a clear comparison this analysis was focused on containerships only the structure of the database considering ship dimensions is presented in fig 3 the most represented ships are larger than 280 m followed by ships from 260 to 280 m smaller size ships appear less frequently as the study has focused on the routes in higher sea states this under representation of smaller size containerships is understandable the lower amount of cargo that they carry can make them less suited for the ocean transport signiﬁcantly smaller ships may experience more intensive adverse eﬀects and be prone to reducing the speed much earlier than larger ships in the present case the majority of observations are from ships with lengths 280 300 m fig 3 a which will be the focus of the study as for the beams as seen in fig 3 b the most common are panamax ships while draughts vary between 10 and 14 5 m fig 3 c this database describes the behaviour of ships in realistic unbounded ocean going conditions the ships with only one reported position have been ﬁltered out neither the speed nor course could be assessed from an isolated report within the topic being studied these points are not useful although they hold useful values when it comes to meteorological predictions for which this database is originally designed having ﬁltered the database and extracting only routes of interest a ﬁnal number of around 250 observations from 30 diﬀerent container ships is established ship speed is expressed as a percentage of the design speed design speeds for the whole database are taken from the ihs markit maritime database weather conditions encountered were seas of significant wave height higher than 1 m which covers moderate to rough and very rough seas corresponding to wmo sea states 4 and higher no observations of very high and phenomenal seas were found in this sample which can be explained by the fact that ships tend to avoid these conditions vettor and guedes soares 2016b 2016c attained speed in correlation with the speciﬁc wave height of the observed database is shown in fig 4 a trend in the data is visible observing ﬁrst the speed in the lowest sea states almost no ships were sailing at their design speed the reasons for lower speeds in what could be considered mild weather conditions are various deterioration of the conditions of the hull and propeller wear and deterioration of the main and auxiliary engines performance wear of bearings and seals are all possible reasons for increase of power and fuel consumption or lowering speeds bialystocki and konovessis 2016 another reason for this behaviour can be seen in the fact that the period being observed 2009 2016 belongs to the crisis caused by the increase in the available capacities parallel with lower shipping requirements and increase of fuel costs cariou 2011 it can be observed that the data presented in fig 4 is scattered at this point it is important to emphasize that the analysis is for container ships of various dimensions and wind and wave encounter angles also the exact draught and ship loading condition are not always known this may be inﬂuential as well since ship behaviour in rough weather can vary depending on the loading condition ichinose et al 2012 the service data of operation of a reasonable number of containerships guedes soares and dias 1996 can provide some idea about the expected variability of loading conditions in this type of ships looking at the general trend in the data the average attained speed drops to 70 75 with lowest values of around 60 of the design speed in fig 5 the speed loss was observed as a function of wave encounter angle following waves are taken to be waves coming to the stern quartering waves at 60 beam waves are described as the waves coming parallel to the ship and 30 to the stern and to the bow head waves include directions straight to the bow and up to 60 bow quartering waves the trends clearly indicate diﬀerent behaviour of ships in relation to the wave encounter angle the lowest reduction of speed is observed in following waves and the highest in head seas as this speed reduction includes both voluntary and involuntary loss it should be noted that the largest added resistance can be expected in head wave conditions vitali et al 2016 head waves are defined with an angle of 1800 while following waves correspond to the angle of 00 the rate at which the ship encounters each of the mentioned wave directions is shown in fig 6 a the distribution of the wave encounter angles generally indicate that when sailing in rough weather ships tend to avoid beam waves a feature that was already noted in guedes soares 1990 naturally more favourable conditions are following waves and bow quartering waves distribution of wind encounter angles fig 6 b seems more even with no apparent preferable wind encounter angle fig 7 shows speed loss decomposed by the encounter angles with the increment of 300 in following waves the ship manages to maintain the speed even in higher sea states see fig 7 a and b the attained speed remained around 80 and with a mild downward trend the situation is more pronounced in the beam waves see fig 7 c and d where speed loss is larger and for the highest states goes up to 75 of the design speed the speed loss is the most noticeable in head waves see fig 7 e and f with mean values of attained speed around 70 and isolated cases going as low as the 60 of the maximum speed for a ship with design speed of 20 knots this would mean reducing the speed down to 14 knots due to weather the trend in the data has been estimated using linear regression for demonstrative purposes an estimate of error is made using correlation coefficients and standard error estimate it is visible that for all the cases the standard error of the regression is between 5 6 and 7 of the design speed 4 2 comparison with theoretical methods for speed loss the ships focused in this study have lengths between 280 300 m to be able to examine the behaviour of the observed ships a representative of the sample is chosen for analysis the selected ship is a panamax containership with dimensions as described in table 1 the empirical or semi empirical formulations were an important tool when hydrodynamic calculations and computational power were not as advanced as they are today they have however remained valuable from the point of quick estimation of ship behaviour in ocean going conditions one of the earliest attempts in describing speed loss in waves was done by aertssen 1966 the estimation was based on ship length and values associated with beaufort number and the direction of incoming waves head bow beam or following as shown in as seen in equation 3 this formulation does not consider ship type nor loading condition 3 μ δ v v 100 m l p p n table 2 summarizes the coeﬃcients for the estimation of speed loss in various weather conditions townsin and kwon 1982 later updated by kwon 2008 have developed an approximate formulae for the percentage of speed loss due to added resistance in wind and waves formulation for containerships in head waves loaded condition and block coeﬃcients cb 0 5 0 6 0 65 0 7 the signiﬁcant wave height corresponding to the beaufort number is derived as originally published in townsin and kwon 1982 by using the wind speed at 10 m above the sea surface 4 μ δ v v 100 0 7 b n b n 6 5 22 2 3 n the formula is corrected for weather direction factor μ allowing to express speed loss in bow beam and following waves as well as shown in table 3 the two mentioned formulations agree well among each other but not to the voyage data the results are presented in fig 8 for head beam and following waves in head waves the results agree reasonably well except in the highest sea states 5 m and up but the speed loss of the observed sample is more gradual than the sharp drop of the empirical methods speed in beam and following waves is found to be overestimated the empirical methods assume that the ship initially sails at the design speed so observed diﬀerences are understandable the development of the new formulations based on real life data would signiﬁcantly improve the estimation of realistic speed in the rough weather further on it can be introduced to a voyage routing or emission estimation calculations widening their applicability and accuracy in rough weather conditions 4 3 estimation of speed loss using expert experience a speed loss in a seaway can be distributed on two main eﬀects voluntary and involuntary the reasons for reducing the speed in rough weather are various involuntary reasons include the external eﬀects the wind waves or motions of the ship additional resistance in waves wind variation of underwater form due to the motions decrease of the propulsion characteristics because of the ship motions increase of resistance aeration or change in wake and thrust deduction all inﬂuence the ship speed voluntary reasons include captain s reaction to the events that can be threatening to ship cargo or the crew high amplitudes of motion velocities bow impacts deck wetness overload of the main engine changes in propeller rate can all result in a decision to lower the speed or adjust the heading in high sea states the decisions are also inﬂuenced by the type of ship draft trim ships state main engine etc ship master may decide to lower the speed due to concerns for crew and cargo safety caused by severe motions slamming shipping green water propeller emergence prpić oršić and faltinsen 2012 expert opinion was gathered using a questionnaire speciﬁcally designed for this purpose see fig 9 the ship masters and higher ranking oﬃcers everyone that can understand and make decisions related to reduction of ship speed were included in this survey the survey was conducted from spring to winter 2016 mostly with ship crew that attended a training at faculty of maritime studies in rijeka the remaining questionnaires were obtained through electronic communication with assistance of cma ships rijeka that facilitated the distribution of questionnaire to their team overall around 50 responses were received of which 13 representing experience from containerships ship masters were asked to estimate at what speed they would sail through an area under the inﬂuence of the weather described by diﬀerent sea states and weather encounter angles the second part of the questionnaire not used in this paper asks for the opinion on reduction of speed because of excessive motions accelerations or events such as slamming and propeller emergence they are requested to describe how many slams or green water occurrences they would tolerate in a unit of time of their own choosing before they decide to reduce the speed these results are directly connected to the limiting seakeeping criteria but in order to unambiguously redeﬁne them larger response sample is needed in order to do this we are continuing to conduct this survey only containerships are observed in order to be able to compare these results with previous methods of assessing speed loss the sample of 13 containerships is presented not all the questionnaires had the results in beam or following waves which can be accounted to the fact that those assessments were more diﬃcult to make for beam and following waves 8 answers were delivered the range of lengths of the ships is 260 300 m and all of them are taken under consideration due to the small sample size this is still in the close range of the observed ships dimensions results are presented in fig 10 where we can see very good correlation between ship master s estimations and voyage data the trends and the slope correspond well in all directions in the lowest sea states we can see that the captains tend to indicate that they would maintain maximum speed in realistic situations the ship would have already had lost some speed which would explain the discrepancies of the questionnaire results with the voyage data 5 conclusions in this paper the speed loss of container ships in a seaway is analysed a series of voyages was observed and integrated with weather data the ship speed showed clear trends in relation to the wave encounter angles some insight is made on the frequency of encounter angles and how the beam waves are most commonly avoided when it comes to comparing the real life voyage data with the existing methods for estimation of speed some discrepancies are found this indicates that the formulations for the estimation of speed loss in a seaway need updating the same can be concluded for the seakeeping criteria which could be uniﬁed and or restated for each ship type on an individual basis considering speciﬁcities of their design and service demands signiﬁcantly better agreement is found using captain s subjective estimation of speed which means that human experience can be a valuable tool for this research acknowledgements we would like to thank cma ships croatia and captains dragan milatović and peter dolinsek for their support as well as their help in distributing the questionnaires special thanks to srdan žuškin from faculty of maritime studies university of rijeka who had greatly contributed to this research by introducing it to the ship captains participating in their trainings this work has been fully supported by the croatian science foundation under the project project ip 2018 01 3739 this work was alsosupported by the university of rijeka project no uniri tehnic 18 18 1146 and uniri tehnic 18 2666469 
