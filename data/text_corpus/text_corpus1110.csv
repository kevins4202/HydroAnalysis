index,text
5550,the stable isotope ratios of oxygen and hydrogen in shallow groundwater reflect the long term amount weighted mean isotopic composition of precipitation here we report the isotopic composition of more than 1000 shallow groundwater samples age 5 000 yr across continental brazil recent studies of global precipitation have shown a strong negative correlation between the isotopic compositions e g δ18o values and stratiform fractions of brazilian precipitation with geospatial correspondence to the south atlantic convergence zone pattern this isotope precipitation type geospatial correlation is also reflected in the isotopic compositions of shallow groundwaters and speleothem records from the region show small variations in δ18o values implying general climatic stability in this region during the past few millennia we propose that shallow groundwater isotopic compositions reflect bulk proportions of convective and stratiform fractions in precipitation and could thus be useful in conjunction with groundwater dating as proxy archives to characterize past changes in the proportions of convective and stratiform precipitation in tropical and subtropical latitudes this groundwater isotope precipitation type relationship could also have broader implications when considered for paleoclimatic interpretation of oxygen isotope records in dated speleothems from other locations keywords stable isotopes groundwater isoscape south atlantic convergence zone convective and stratiform precipitation speleothems 1 introduction isotopic compositions of h and o δ18o δ2h δ r sample r standard 1 1000 where r is the isotopic ratio of 18o 16o or 2h 1h are important tracers in hydrogeological studies as indicators of the sources and mixing relationships of groundwaters as well as the paleoclimate at the time of recharge aggarwal et al 2004 bowen good 2015 darling 2004 raidla et al 2016 sánchez murillo birkel 2016 west et al 2014 typically depletion of 18o in groundwater is considered to result from recharge at lower temperatures higher elevations or during wetter climates craig 1961 dansgaard 1964 gat 1996 the isotopic composition of shallow groundwater beneath the landscape i e a groundwater isoscape reflects the long term mean isotopic composition of precipitation ingraham taylor 1991 raidla et al 2016 rozanski 1985 wassenaar et al 2009 depending upon the extent to which a seasonal bias occurs in recharge jasechko et al 2014 the groundwater isotopic composition at a given location is the same as or are close to the weighted mean annual isotopic composition of precipitation recharging the aquifer clark fritz 1997 darling 2004 thus the isotopic composition of precipitation during the past can be ascertained from that of groundwater provided that the mean residence time of the groundwater is also known plummer 1993 stute et al 1992 similarly the isotopic composition of speleothems also is considered to reflect the mean isotopic composition of precipitation infiltrating below the ground surface in south america speleothems have been extensively studied as a paleoclimate proxy e g cruz et al 2005b cruz et al 2009a stríkis et al 2015 the long term climate variability over the continent has been interpreted based on δ18o variations in dated speleothems generally considering the precipitation amount amount effect and degree of upstream rainfall transpiration as the two primary controlling factors cheng et al 2013 the δ18o value of precipitation is commonly found to be inversely correlated with the amount of rainfall 0 4 to 0 8 per 100 mm rainfall increase vuille 2003 although this relationship does not hold with eastern amazonia and northeastern brazil precipitation records cheng et al 2013 speleothem δ18o records have been compared with the february solar insolation cruz et al 2005a and austral summer insolation asi wang et al 2007 in south america the apparent correlations between summer insolation and speleothem δ18o values in south america have been interpreted to reflect south american summer monsoon sasm intensity that resulted in wetter or drier conditions during higher or lower solar insolation through an amount effect cruz et al 2009b cruz et al 2005a recent high resolution studies of speleothems from within the sacz zone in brazil however show relatively small deviations from their mean δ18o value over the past 2 000 5 000 years novello et al 2016 2018 strikis et al 2011 vuille et al 2012 wortham et al 2017 the conventional interpretation of the isotopic compositions of precipitation in terms of the amount effect has been studied specially in the tropics cai tian 2016 dee et al 2018 risi et al 2008 and recently challenged by aggarwal et al 2016 using mean monthly isotopic compositions of precipitation from the gnip database iaea wmo global network of isotopes in precipitation aggarwal et al 2007 across the tropics and mid latitudes monthly stratiform fractions from the tropical rainfall measuring mission trmm satellite s precipitation radar pr and synoptic cloud observations awaka et al 1997 berg et al 2013 funk et al 2013 liu et al 2008 schumacher houze 2003 aggarwal et al 2016 demonstrated that the character of precipitation i e whether it is produced by stratiform or convective storms is the fundamental control that governs its isotope variability convective storms such as thunder showers produce isotopically heavier precipitation whereas larger scale storm systems with a combination of convective and stratiform characteristics produce more stratiform rain that is isotopically lighter kurita 2013 aggarwal et al 2016 accordingly precipitation isotope ratios in the tropics or mid latitudes are inversely correlated with the proportion of stratiform rain the trmm pr has measured the three dimensional structure of precipitating systems over tropical and subtropical latitudes between 1997 and 2015 houze et al 2015 kummerow et al 1998 2000 trmm pr has collected nearly uninterrupted precipitation data producing a long term global tropical precipitation dataset the trmm pr s vertical resolution and its capability to distinguish convective and stratiform precipitation awaka et al 1997 funk et al 2013 has been used to characterize extreme convective cloud systems zipser et al 2006 in south america romatschke and houze 2010 and south asia houze et al 2007 romatschke et al 2010 schumacher and houze 2003 suggest that the stratiform rain fractions over land are higher during higher solar insolation this is because higher solar insolation results in a larger number of mesoscale convective complexes as observed in south america by velasco and fritsch 1987 which in turn produce more stratiform rain schumacher and houze 2003 romatschke and houze 2010 2013 explored the synoptic scenarios that lead to the occurrence of different types of storms and the associated precipitation types and amounts in south america they found that the most prominent precipitation region stretches from the amazonia region to the southeast over the brazilian highlands within the south atlantic convergence zone sacz where the precipitation has a larger proportion of stratiform rain here we report on the observed relationship between the isotopic composition of modern groundwater and the stratiform fraction in precipitation across continental brazil despite of limited number of meteorological stations with rainwater isotopic analyses are available we propose the use of the δ18o groundwater isoscape as a proxy for the long term decadal to millennial scale isotopic composition of precipitation we collected more than 1000 shallow groundwater samples fig 1 table s1 covering three major sedimentary basins and water table aquifers overlying the precambrian basement complex to test the applicability of groundwater isoscape as a proxy for the long term composition of precipitation in brazil we also compared the observed geospatial correlation of groundwater δ18o values and stratiform precipitation with data on δ18o values of dated speleothems in the study area to investigate the possible significance of the isotope precipitation type correlation in the paleoclimatic interpretation of speleothems 2 materials and methods 2 1 study location regional isotopic assessment of shallow and unconfined portions of aquifers in 16 brazilian states was performed fig 1 table s1 the sampling program for δ18o and δ2h analysis covered some of the major brazilian aquifers such as bauru aquifer system stradioto 2016 and guarani aquifer system gastmans et al 2010 of the paraná basin along with the parecis aquifer system ana 2013 of the parecis basin and the urucuia aquifer system uas chang et al 2015 of the sanfranciscana basin well depths were less than 150 m with groundwater 14c model ages ranging from modern to 5 000 years bp as determined in 47 selected wells from the paraná and sanfrancicana basins stradioto 2016 ana 2017 most of the study area extends over the brazilian highlands also called brazilian plateau of the central southeast region of brazil where elevations are generally below 1000 m with the exception of several isolated peaks above 2500 m the location of the south atlantic convergence zone sacz is strongly controlled by this elevated topography grimm et al 2007 kodama et al 2012 the sacz is oriented northwest southeast and shifts seasonally in a northeast southwest direction kodama et al 2012 zhou lau 2001 the sacz is a meteorological system extending from the amazon basin into the southwest atlantic ocean and it is a significant component of the south american summer monsoon sasm carvalho et al 2004 vera et al 2006 austral summer december january february forms the principal rainy season in southern brazil resulting in more than 10 times greater precipitation than during the winter to the north the austral autumn is the rainy season of northeast brazil which may be explained with a southward displacement of the intertropical convergence zone itcz and correlated with el niño southern oscillation enso dos santos et al 2019 wang et al 2004 zhou lau 2001 2 2 stable isotope archives 2 2 1 groundwater the stable isotope dataset includes a total of 1190 shallow and unconfined groundwater samples these samples were collected in polyethylene bottles following the protocol of the international atomic energy agency iaea samples from urucuia aquifer system sanfranciscana basin were collected in 2013 and those from bauru and guarani aquifer systems paraná basin were collected in 2014 recent sampling campaigns 2015 2018 were carried out across 16 states to cover an area of approximately 4 3 million km2 the spatial coverage of these campaigns was limited by the availability of road access and by well accessibility the geological survey of brazil well databases called siagas and rimas were the primary sources of data for well selection shallow and unconfined groundwater wells available for sampling were also identified through water supply companies and contacts with residents in towns and countryside communities for the most part well completion records were nonexistent or not available and we relied primarily on information gleaned in conversations with local people well information gps coordinates with elevation and local metadata were recorded at each sampling well location stable isotope analyses δ18o and δ2h were conducted at unesp rio claro using standard preparation techniques lis et al 2008 followed by isotope ratio measurement by laser absorption spectroscopy models lwia 24 ep and tlwia 45 ep by los gatos research inc isotope ratios are expressed in delta notation with respect to the vienna standard mean ocean water vsmow isotopic standard analytical precisions are better than 0 17 1σ for δ18o and 0 32 1σ for δ2h stable isotope data for the groundwater samples that plotted far off the meteoric water line were not included due to evidence of evaporative effects during or after recharge e g riverbank infiltration or open tank storage isotopic compositions of fifty groundwater samples from locations in the ne region were obtained from the archives of cena center nuclear energy in agriculture of university of são paulo these samples were collected and analyzed in the 1970 s all of the 1190 groundwater sample analyses are provided in the supplemental materials table s1 interpolations and spatial analysis were performed in arcgis v10 esri usa using a thin plate spline algorithm franke 1982 2 2 2 precipitation monthly stable isotope δ18o and precipitation amounts were obtained from the iaea wmo global network of isotopes in precipitation gnip database aggarwal et al 2007 the relevant gnip data set for our study area is composed of eleven station records for which the average δ18o values are weighted by the monthly precipitation amounts at each station table s2 because of limited recent rain isotopic data in brazil currently there are only 3 active stations with records we used isotopic data from gnip stations collected mainly during 1960 s to 1980 s active period of the brazilian gnip network franzini et al 2019 2 2 3 speleothems the isotopic data for speleothems were extracted from the literature including santana cave 24 32 s 48 44 w cruz et al 2006 botuverá cave 27 13 s 49 9 w cruz et al 2005a rio grande do norte 5 36 s 37 44 w cruz et al 2009b paixão 12 37 s 41 01 w barreto 2010 diva de maura 12 21 s 41 34 w novello et al 2012 jaraguá 21 05 s 56 35 w paula 2012 pau d alho 15 12 s 56 48 w novello et al 2016 cristal cave 24 34 s 48 35 w taylor 2010 tamboril 16 20 s 47 00 w wortham et al 2017 and goiás caves 13 49 s 46 22 w novello et al 2018 the speleothems considered here are all of late holocene age 2 000 years bp 2 2 4 trmm data trmm pr spaceborne radar rainfall 3a25 product version 7 nasa goddard space flight center 2019 is used to calculate stratiform precipitation fractions it provides total and stratiform precipitation rates as well as the convective stratiform classification the data are available on a monthly basis from december 1997 to march 2015 with november december 2014 and january 2015 missing on a 0 5 longitude latitude grid 3 results and discussion 3 1 precipitation composition to test the strength of the relationship of precipitation δ18o with stratiform fractions on a continental scale in brazil we compiled isotopic data from 11 gnip stations fig 2 table s2 and compared these with the trmm derived stratiform fractions we used the data from the dominant rainy months of december january and february in order to minimize the uncertainties in trmm romatschke and houze 2010 2013 a simple linear relationship is observed between stratiform fractions and δ18o for the region with a similar slope as that obtained by aggarwal et al 2016 for global precipitation but with an even better correlation r2 0 81 p 0 0001 fig 3 d it is important to notice that the datasets are from different periods gnip data were collected mainly during the period of 1960 s to 1980 s and that of the trmm from 1997 to 2015 and this is a source of uncertainties despite of the non synchronicity the resulted high correlation indicates that the stratiform fractions and gnip δ18o are regionally comparable when using long term average values this inference is particularly useful for groundwater studies since groundwater δ18o distribution reflects the long term amount weighted mean isotopic composition of precipitation clark fritz 1997 darling 2004 wassenaar et al 2009 raidla et al 2016 the results suggest the mean values did not greatly change during these decades to reduce the uncertainties and consequently improve the δ18o and stratiform fraction correlation will be only possible in the near future for a new network of gnip stations in brazil is being implemented franzini et al 2019 3 2 groundwater isotope results the δ18o values of groundwater samples range from 9 0 to 0 8 whereas the δ2h values range from 63 8 to 6 2 the δ2h δ 18o biplot shows clearly the meteoric origin of the sampled waters as they cluster along the global meteoric water line craig 1961 as well as with the gnip stations fig 2a 2b while the isotopic compositions of different aquifer systems overlap the geospatial distribution of δ18o values shows a clear structure fig 2a most prominently the lowest δ18o values 5 5 are found in a zone running nw se across the central portion of the study area this low δ18o zone is coincident with the occurrence of the samples belonging to central brazil aquifers average δ18o 6 6 0 7 in contrast higher δ18o values 5 5 are observed both in the northern and southern portions of the study area higher δ18o samples southward are from the southern paraná basin average δ18o 5 4 0 6 and the highest δ18o waters in the northern study area are from the sanfranciscana basin and precambrian shield average δ18o 4 1 1 0 fig 2c the isotopic composition of groundwater shows no correlation either with the elevation fig s1 or with the mean local temperature fig s2 3 3 comparing groundwater isotopic composition to precipitation type a striking correspondence can be observed between the areas of lower δ18o groundwater fig 2a and the sacz fig 3a the conventional interpretation would associate the lower more negative δ18o values to the isotopic amount effect since the sacz region is characterized by larger amounts of precipitation in the study area however as noted earlier isotopes in eastern amazonia and northeastern brazil precipitation are not consistent with an amount effect cheng et al 2013 the opposite of an amount effect is most strikingly displayed in precipitation from the porto alegre gnip station where δ18o is positively correlated with amount fig s3 however isotope ratios in some of the brazilian precipitation have been shown to reflect rain type proportions where lower δ18o values correlate with increasing stratiform fractions aggarwal et al 2016 using the statistical relationship for the brazilian precipitation fig 3d we created a predicted stratiform fraction map from groundwater δ18o values across the brazilian plateau fig 4 these predicted stratiform fractions from groundwater isotope data are in agreement with those based on trmm data fig 5 it is important to mention that a predicted stratiform fraction map may be influenced by the groundwater flow direction where the water is sampled far from the recharge areas especially for old and confined aquifers possibly causing a spatial isotopic shift considering that trmm spatial resolution is about 50 km in our study area and the sampled aquifers are mostly shallow and unconfined containing young groundwaters a comparison between the stratiform precipitation fraction and groundwater δ18o maps is unlikely to show much age related displacement due to groundwater flow at the scale of the trmm data the mean absolute difference between the trmm and groundwater predicted stratiform fractions was 7 2 with 73 of the area characterized by less than 10 difference the larger observed differences occurred in the northern portion of the study area where the groundwater samples are sparse and more likely to be influenced by the itcz in addition to the sacz the rain pattern in that area has more variability because these convergence zones are not steady over this region varying intra and interannually and are also subject to enso influence the generally good correspondence observed in the study area however is consistent with the present convective and stratiform precipitation patterns described in romatschke and houze 2010 2013 differences between trmm and isotope derived stratiform fractions are likely to occur seasonally over parts of this region even when comparing precipitation instead of groundwater isotopic composition to achieve a better correspondence and diminish the errors a denser sampling campaign should be done then the local variances may be identified and correlated precipitation over the brazilian plateau is dominated by convective systems with large stratiform components fig 3b the geographical distribution of convective systems in tropical and subtropical south america presents a highly convective nature over the southeastern andes and la plata basin romatschke houze 2010 2013 salio et al 2007 zipser et al 2006 therefore more 18o enriched precipitation is observed southwards of the sacz there is a clearly observable correlation of stratiform fraction and rain rate fig s4 as expected because large scale storm system such as sacz produce more stratiform rain however comparing the relationship of gnip δ18o and stratiform fractions yields a stronger correlation r2 0 81 p 0 0001 than that between gnip δ18o values and rain rate r2 0 45 p 0 0001 fig 3c additionally there is no relationship between deuterium excess and stratiform fractions r2 0 05 p 0 0001 fig s5 3 4 comparing groundwater to speleothem records considering that groundwater isotopic composition reflects the mean isotopic composition of recharge water it is expected to see a similar signature in speleothems having the same age by observing their mean δ18o values in order to check this relationship we compiled data from ten well studied dated speleothems and compared the last two thousand years δ18o variation and mean value for each table s3 the spatial pattern of isotope variation observed in our study where lower δ18o values occur mostly in a nw se zone in the middle is essentially the same as that observed in speleothem δ18o values fig 2a lowest speleothem δ18o values e g pau d alho cave are coincident with the lower δ18o groundwater in the central part of the sacz higher δ18o values of speleothems are found in botuverá cave to the south and rio grande do norte paixão and diva de maura caves to the north of the sacz area these speleothem records have been interpreted to reflect periods of higher summer insolation resulting in wetter conditions and therefore lower δ18o values increased summer insolation however is reflected in the greater frequency of large precipitation systems with higher stratiform rain fractions schumacher houze 2003 therefore periods of increased summer insolation would normally be associated with decreased δ18o values of precipitation because of a greater frequency of mesoscale convective complexes and higher stratiform fractions schumacher and houze 2003 the δ18o of speleothems in santana cave are lower by 2 3 compared to botuverá cave cruz et al 2005a while both locations are in phase with periods of high summer insolation cruz et al 2006 differing only in terms of intensity higher at santana near the northern sacz border in central brazil near brasília tamboril cave wortham et al 2017 shows a very interesting speleothem which has a relatively large δ18o range 3 9 to 8 4 however the mean value for the analyzed period 5 4 is similar to that of the other caves within the sacz this δ18o variability seen in speleothems in brazil over the past two millennia although small is currently interpreted as changes in summer monsoon that occurred during three key periods medieval climate anomaly and current warm period weakened monsoon and the little ice age strengthened monsoon as reviewed by vuille et al 2012 in the northeastern brazil speleothem records at paixão cave novello et al 2017 and northernmost in rio grande do norte have higher δ18o values cruz et al 2009b according to these authors precipitation in this area is not exclusively due to sacz activity in the summer but is also associated with the southernmost position of the itcz in march may precipitation in march may does not coincide with the higher insolation period antiphase as described by cruz et al 2009b and is thus more convective higher δ18o values consistent with speleothem data groundwater in this northern portion also has higher δ18o values fig 2 which reflect lower stratiform fractions in precipitation fig 4 we interpret the higher δ18o groundwater as an indication that the march may precipitation is recharging in this northern area higher δ18o values are recorded at the gnip stations located in the drought stricken northeast region betania and ceará mirim and at the coastal gnip stations of rio de janeiro and salvador that record tropical convection or itcz dominated precipitation in summary the speleothem records within our study area are consistent with the groundwater records which show a better response to rain type as opposed to commonly invoked wet and dry conditions 4 conclusions a groundwater isoscape map was produced from 1190 isotopic analyses of shallow and unconfined groundwater samples collected across the brazilian highlands in central southeast brazil a strong correlation was observed between spatial distribution of δ18o ratios of groundwater and the prevailing air circulation regimes in south america with apparent influence of the south atlantic convergence zone the δ18o values of shallow and unconfined groundwater reflect the bulk proportions of convective and stratiform precipitation which may or may not coincide with rainfall amount variations aggarwal et al 2016 because these groundwaters come from shallow unconfined aquifers and because 14c model ages indicate waters younger than 5000 years bp stradioto 2016 ana 2017 it is likely that the present atmospheric circulation pattern over the brazilian highlands has been fairly constant for at least several thousand years throughout the late holocene the results obtained in the present study suggest that regional shallow groundwater isotopic studies can be useful as proxy archives of palaeo precipitation to characterize changes in the proportions of convective and stratiform precipitation in tropical and subtropical latitudes this approach may also have broader implications when considered in paleoclimate interpretations derived from speleothem oxygen isotope records as the isotopic variations resulting from changes in precipitation type are of the same magnitude as those resulting from climate driven changes in moisture source and mean annual temperature credit authorship contribution statement hung k chang conceptualization formal analysis project administration methodology investigation roger d gonçalves formal analysis methodology writing original draft writing review editing investigation pradeep k aggarwal formal analysis methodology writing original draft marcia r stradioto investigation validation data curation emilio c b hespanhol investigation resources validation neil c sturchio writing original draft writing review editing ulrike romatschke methodology writing original draft luis j a araguas resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we acknowledge support from fundunesp unesp the national counsel for technological and scientific development cnpq and the international atomic energy agency the national center for atmospheric research is sponsored by the national science foundation this study was also made possible using freely available data from the iaea wmo global network of isotopes in precipitation gnip database the groundwater data presented in this paper can be found in the supporting information appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 124801 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
5550,the stable isotope ratios of oxygen and hydrogen in shallow groundwater reflect the long term amount weighted mean isotopic composition of precipitation here we report the isotopic composition of more than 1000 shallow groundwater samples age 5 000 yr across continental brazil recent studies of global precipitation have shown a strong negative correlation between the isotopic compositions e g δ18o values and stratiform fractions of brazilian precipitation with geospatial correspondence to the south atlantic convergence zone pattern this isotope precipitation type geospatial correlation is also reflected in the isotopic compositions of shallow groundwaters and speleothem records from the region show small variations in δ18o values implying general climatic stability in this region during the past few millennia we propose that shallow groundwater isotopic compositions reflect bulk proportions of convective and stratiform fractions in precipitation and could thus be useful in conjunction with groundwater dating as proxy archives to characterize past changes in the proportions of convective and stratiform precipitation in tropical and subtropical latitudes this groundwater isotope precipitation type relationship could also have broader implications when considered for paleoclimatic interpretation of oxygen isotope records in dated speleothems from other locations keywords stable isotopes groundwater isoscape south atlantic convergence zone convective and stratiform precipitation speleothems 1 introduction isotopic compositions of h and o δ18o δ2h δ r sample r standard 1 1000 where r is the isotopic ratio of 18o 16o or 2h 1h are important tracers in hydrogeological studies as indicators of the sources and mixing relationships of groundwaters as well as the paleoclimate at the time of recharge aggarwal et al 2004 bowen good 2015 darling 2004 raidla et al 2016 sánchez murillo birkel 2016 west et al 2014 typically depletion of 18o in groundwater is considered to result from recharge at lower temperatures higher elevations or during wetter climates craig 1961 dansgaard 1964 gat 1996 the isotopic composition of shallow groundwater beneath the landscape i e a groundwater isoscape reflects the long term mean isotopic composition of precipitation ingraham taylor 1991 raidla et al 2016 rozanski 1985 wassenaar et al 2009 depending upon the extent to which a seasonal bias occurs in recharge jasechko et al 2014 the groundwater isotopic composition at a given location is the same as or are close to the weighted mean annual isotopic composition of precipitation recharging the aquifer clark fritz 1997 darling 2004 thus the isotopic composition of precipitation during the past can be ascertained from that of groundwater provided that the mean residence time of the groundwater is also known plummer 1993 stute et al 1992 similarly the isotopic composition of speleothems also is considered to reflect the mean isotopic composition of precipitation infiltrating below the ground surface in south america speleothems have been extensively studied as a paleoclimate proxy e g cruz et al 2005b cruz et al 2009a stríkis et al 2015 the long term climate variability over the continent has been interpreted based on δ18o variations in dated speleothems generally considering the precipitation amount amount effect and degree of upstream rainfall transpiration as the two primary controlling factors cheng et al 2013 the δ18o value of precipitation is commonly found to be inversely correlated with the amount of rainfall 0 4 to 0 8 per 100 mm rainfall increase vuille 2003 although this relationship does not hold with eastern amazonia and northeastern brazil precipitation records cheng et al 2013 speleothem δ18o records have been compared with the february solar insolation cruz et al 2005a and austral summer insolation asi wang et al 2007 in south america the apparent correlations between summer insolation and speleothem δ18o values in south america have been interpreted to reflect south american summer monsoon sasm intensity that resulted in wetter or drier conditions during higher or lower solar insolation through an amount effect cruz et al 2009b cruz et al 2005a recent high resolution studies of speleothems from within the sacz zone in brazil however show relatively small deviations from their mean δ18o value over the past 2 000 5 000 years novello et al 2016 2018 strikis et al 2011 vuille et al 2012 wortham et al 2017 the conventional interpretation of the isotopic compositions of precipitation in terms of the amount effect has been studied specially in the tropics cai tian 2016 dee et al 2018 risi et al 2008 and recently challenged by aggarwal et al 2016 using mean monthly isotopic compositions of precipitation from the gnip database iaea wmo global network of isotopes in precipitation aggarwal et al 2007 across the tropics and mid latitudes monthly stratiform fractions from the tropical rainfall measuring mission trmm satellite s precipitation radar pr and synoptic cloud observations awaka et al 1997 berg et al 2013 funk et al 2013 liu et al 2008 schumacher houze 2003 aggarwal et al 2016 demonstrated that the character of precipitation i e whether it is produced by stratiform or convective storms is the fundamental control that governs its isotope variability convective storms such as thunder showers produce isotopically heavier precipitation whereas larger scale storm systems with a combination of convective and stratiform characteristics produce more stratiform rain that is isotopically lighter kurita 2013 aggarwal et al 2016 accordingly precipitation isotope ratios in the tropics or mid latitudes are inversely correlated with the proportion of stratiform rain the trmm pr has measured the three dimensional structure of precipitating systems over tropical and subtropical latitudes between 1997 and 2015 houze et al 2015 kummerow et al 1998 2000 trmm pr has collected nearly uninterrupted precipitation data producing a long term global tropical precipitation dataset the trmm pr s vertical resolution and its capability to distinguish convective and stratiform precipitation awaka et al 1997 funk et al 2013 has been used to characterize extreme convective cloud systems zipser et al 2006 in south america romatschke and houze 2010 and south asia houze et al 2007 romatschke et al 2010 schumacher and houze 2003 suggest that the stratiform rain fractions over land are higher during higher solar insolation this is because higher solar insolation results in a larger number of mesoscale convective complexes as observed in south america by velasco and fritsch 1987 which in turn produce more stratiform rain schumacher and houze 2003 romatschke and houze 2010 2013 explored the synoptic scenarios that lead to the occurrence of different types of storms and the associated precipitation types and amounts in south america they found that the most prominent precipitation region stretches from the amazonia region to the southeast over the brazilian highlands within the south atlantic convergence zone sacz where the precipitation has a larger proportion of stratiform rain here we report on the observed relationship between the isotopic composition of modern groundwater and the stratiform fraction in precipitation across continental brazil despite of limited number of meteorological stations with rainwater isotopic analyses are available we propose the use of the δ18o groundwater isoscape as a proxy for the long term decadal to millennial scale isotopic composition of precipitation we collected more than 1000 shallow groundwater samples fig 1 table s1 covering three major sedimentary basins and water table aquifers overlying the precambrian basement complex to test the applicability of groundwater isoscape as a proxy for the long term composition of precipitation in brazil we also compared the observed geospatial correlation of groundwater δ18o values and stratiform precipitation with data on δ18o values of dated speleothems in the study area to investigate the possible significance of the isotope precipitation type correlation in the paleoclimatic interpretation of speleothems 2 materials and methods 2 1 study location regional isotopic assessment of shallow and unconfined portions of aquifers in 16 brazilian states was performed fig 1 table s1 the sampling program for δ18o and δ2h analysis covered some of the major brazilian aquifers such as bauru aquifer system stradioto 2016 and guarani aquifer system gastmans et al 2010 of the paraná basin along with the parecis aquifer system ana 2013 of the parecis basin and the urucuia aquifer system uas chang et al 2015 of the sanfranciscana basin well depths were less than 150 m with groundwater 14c model ages ranging from modern to 5 000 years bp as determined in 47 selected wells from the paraná and sanfrancicana basins stradioto 2016 ana 2017 most of the study area extends over the brazilian highlands also called brazilian plateau of the central southeast region of brazil where elevations are generally below 1000 m with the exception of several isolated peaks above 2500 m the location of the south atlantic convergence zone sacz is strongly controlled by this elevated topography grimm et al 2007 kodama et al 2012 the sacz is oriented northwest southeast and shifts seasonally in a northeast southwest direction kodama et al 2012 zhou lau 2001 the sacz is a meteorological system extending from the amazon basin into the southwest atlantic ocean and it is a significant component of the south american summer monsoon sasm carvalho et al 2004 vera et al 2006 austral summer december january february forms the principal rainy season in southern brazil resulting in more than 10 times greater precipitation than during the winter to the north the austral autumn is the rainy season of northeast brazil which may be explained with a southward displacement of the intertropical convergence zone itcz and correlated with el niño southern oscillation enso dos santos et al 2019 wang et al 2004 zhou lau 2001 2 2 stable isotope archives 2 2 1 groundwater the stable isotope dataset includes a total of 1190 shallow and unconfined groundwater samples these samples were collected in polyethylene bottles following the protocol of the international atomic energy agency iaea samples from urucuia aquifer system sanfranciscana basin were collected in 2013 and those from bauru and guarani aquifer systems paraná basin were collected in 2014 recent sampling campaigns 2015 2018 were carried out across 16 states to cover an area of approximately 4 3 million km2 the spatial coverage of these campaigns was limited by the availability of road access and by well accessibility the geological survey of brazil well databases called siagas and rimas were the primary sources of data for well selection shallow and unconfined groundwater wells available for sampling were also identified through water supply companies and contacts with residents in towns and countryside communities for the most part well completion records were nonexistent or not available and we relied primarily on information gleaned in conversations with local people well information gps coordinates with elevation and local metadata were recorded at each sampling well location stable isotope analyses δ18o and δ2h were conducted at unesp rio claro using standard preparation techniques lis et al 2008 followed by isotope ratio measurement by laser absorption spectroscopy models lwia 24 ep and tlwia 45 ep by los gatos research inc isotope ratios are expressed in delta notation with respect to the vienna standard mean ocean water vsmow isotopic standard analytical precisions are better than 0 17 1σ for δ18o and 0 32 1σ for δ2h stable isotope data for the groundwater samples that plotted far off the meteoric water line were not included due to evidence of evaporative effects during or after recharge e g riverbank infiltration or open tank storage isotopic compositions of fifty groundwater samples from locations in the ne region were obtained from the archives of cena center nuclear energy in agriculture of university of são paulo these samples were collected and analyzed in the 1970 s all of the 1190 groundwater sample analyses are provided in the supplemental materials table s1 interpolations and spatial analysis were performed in arcgis v10 esri usa using a thin plate spline algorithm franke 1982 2 2 2 precipitation monthly stable isotope δ18o and precipitation amounts were obtained from the iaea wmo global network of isotopes in precipitation gnip database aggarwal et al 2007 the relevant gnip data set for our study area is composed of eleven station records for which the average δ18o values are weighted by the monthly precipitation amounts at each station table s2 because of limited recent rain isotopic data in brazil currently there are only 3 active stations with records we used isotopic data from gnip stations collected mainly during 1960 s to 1980 s active period of the brazilian gnip network franzini et al 2019 2 2 3 speleothems the isotopic data for speleothems were extracted from the literature including santana cave 24 32 s 48 44 w cruz et al 2006 botuverá cave 27 13 s 49 9 w cruz et al 2005a rio grande do norte 5 36 s 37 44 w cruz et al 2009b paixão 12 37 s 41 01 w barreto 2010 diva de maura 12 21 s 41 34 w novello et al 2012 jaraguá 21 05 s 56 35 w paula 2012 pau d alho 15 12 s 56 48 w novello et al 2016 cristal cave 24 34 s 48 35 w taylor 2010 tamboril 16 20 s 47 00 w wortham et al 2017 and goiás caves 13 49 s 46 22 w novello et al 2018 the speleothems considered here are all of late holocene age 2 000 years bp 2 2 4 trmm data trmm pr spaceborne radar rainfall 3a25 product version 7 nasa goddard space flight center 2019 is used to calculate stratiform precipitation fractions it provides total and stratiform precipitation rates as well as the convective stratiform classification the data are available on a monthly basis from december 1997 to march 2015 with november december 2014 and january 2015 missing on a 0 5 longitude latitude grid 3 results and discussion 3 1 precipitation composition to test the strength of the relationship of precipitation δ18o with stratiform fractions on a continental scale in brazil we compiled isotopic data from 11 gnip stations fig 2 table s2 and compared these with the trmm derived stratiform fractions we used the data from the dominant rainy months of december january and february in order to minimize the uncertainties in trmm romatschke and houze 2010 2013 a simple linear relationship is observed between stratiform fractions and δ18o for the region with a similar slope as that obtained by aggarwal et al 2016 for global precipitation but with an even better correlation r2 0 81 p 0 0001 fig 3 d it is important to notice that the datasets are from different periods gnip data were collected mainly during the period of 1960 s to 1980 s and that of the trmm from 1997 to 2015 and this is a source of uncertainties despite of the non synchronicity the resulted high correlation indicates that the stratiform fractions and gnip δ18o are regionally comparable when using long term average values this inference is particularly useful for groundwater studies since groundwater δ18o distribution reflects the long term amount weighted mean isotopic composition of precipitation clark fritz 1997 darling 2004 wassenaar et al 2009 raidla et al 2016 the results suggest the mean values did not greatly change during these decades to reduce the uncertainties and consequently improve the δ18o and stratiform fraction correlation will be only possible in the near future for a new network of gnip stations in brazil is being implemented franzini et al 2019 3 2 groundwater isotope results the δ18o values of groundwater samples range from 9 0 to 0 8 whereas the δ2h values range from 63 8 to 6 2 the δ2h δ 18o biplot shows clearly the meteoric origin of the sampled waters as they cluster along the global meteoric water line craig 1961 as well as with the gnip stations fig 2a 2b while the isotopic compositions of different aquifer systems overlap the geospatial distribution of δ18o values shows a clear structure fig 2a most prominently the lowest δ18o values 5 5 are found in a zone running nw se across the central portion of the study area this low δ18o zone is coincident with the occurrence of the samples belonging to central brazil aquifers average δ18o 6 6 0 7 in contrast higher δ18o values 5 5 are observed both in the northern and southern portions of the study area higher δ18o samples southward are from the southern paraná basin average δ18o 5 4 0 6 and the highest δ18o waters in the northern study area are from the sanfranciscana basin and precambrian shield average δ18o 4 1 1 0 fig 2c the isotopic composition of groundwater shows no correlation either with the elevation fig s1 or with the mean local temperature fig s2 3 3 comparing groundwater isotopic composition to precipitation type a striking correspondence can be observed between the areas of lower δ18o groundwater fig 2a and the sacz fig 3a the conventional interpretation would associate the lower more negative δ18o values to the isotopic amount effect since the sacz region is characterized by larger amounts of precipitation in the study area however as noted earlier isotopes in eastern amazonia and northeastern brazil precipitation are not consistent with an amount effect cheng et al 2013 the opposite of an amount effect is most strikingly displayed in precipitation from the porto alegre gnip station where δ18o is positively correlated with amount fig s3 however isotope ratios in some of the brazilian precipitation have been shown to reflect rain type proportions where lower δ18o values correlate with increasing stratiform fractions aggarwal et al 2016 using the statistical relationship for the brazilian precipitation fig 3d we created a predicted stratiform fraction map from groundwater δ18o values across the brazilian plateau fig 4 these predicted stratiform fractions from groundwater isotope data are in agreement with those based on trmm data fig 5 it is important to mention that a predicted stratiform fraction map may be influenced by the groundwater flow direction where the water is sampled far from the recharge areas especially for old and confined aquifers possibly causing a spatial isotopic shift considering that trmm spatial resolution is about 50 km in our study area and the sampled aquifers are mostly shallow and unconfined containing young groundwaters a comparison between the stratiform precipitation fraction and groundwater δ18o maps is unlikely to show much age related displacement due to groundwater flow at the scale of the trmm data the mean absolute difference between the trmm and groundwater predicted stratiform fractions was 7 2 with 73 of the area characterized by less than 10 difference the larger observed differences occurred in the northern portion of the study area where the groundwater samples are sparse and more likely to be influenced by the itcz in addition to the sacz the rain pattern in that area has more variability because these convergence zones are not steady over this region varying intra and interannually and are also subject to enso influence the generally good correspondence observed in the study area however is consistent with the present convective and stratiform precipitation patterns described in romatschke and houze 2010 2013 differences between trmm and isotope derived stratiform fractions are likely to occur seasonally over parts of this region even when comparing precipitation instead of groundwater isotopic composition to achieve a better correspondence and diminish the errors a denser sampling campaign should be done then the local variances may be identified and correlated precipitation over the brazilian plateau is dominated by convective systems with large stratiform components fig 3b the geographical distribution of convective systems in tropical and subtropical south america presents a highly convective nature over the southeastern andes and la plata basin romatschke houze 2010 2013 salio et al 2007 zipser et al 2006 therefore more 18o enriched precipitation is observed southwards of the sacz there is a clearly observable correlation of stratiform fraction and rain rate fig s4 as expected because large scale storm system such as sacz produce more stratiform rain however comparing the relationship of gnip δ18o and stratiform fractions yields a stronger correlation r2 0 81 p 0 0001 than that between gnip δ18o values and rain rate r2 0 45 p 0 0001 fig 3c additionally there is no relationship between deuterium excess and stratiform fractions r2 0 05 p 0 0001 fig s5 3 4 comparing groundwater to speleothem records considering that groundwater isotopic composition reflects the mean isotopic composition of recharge water it is expected to see a similar signature in speleothems having the same age by observing their mean δ18o values in order to check this relationship we compiled data from ten well studied dated speleothems and compared the last two thousand years δ18o variation and mean value for each table s3 the spatial pattern of isotope variation observed in our study where lower δ18o values occur mostly in a nw se zone in the middle is essentially the same as that observed in speleothem δ18o values fig 2a lowest speleothem δ18o values e g pau d alho cave are coincident with the lower δ18o groundwater in the central part of the sacz higher δ18o values of speleothems are found in botuverá cave to the south and rio grande do norte paixão and diva de maura caves to the north of the sacz area these speleothem records have been interpreted to reflect periods of higher summer insolation resulting in wetter conditions and therefore lower δ18o values increased summer insolation however is reflected in the greater frequency of large precipitation systems with higher stratiform rain fractions schumacher houze 2003 therefore periods of increased summer insolation would normally be associated with decreased δ18o values of precipitation because of a greater frequency of mesoscale convective complexes and higher stratiform fractions schumacher and houze 2003 the δ18o of speleothems in santana cave are lower by 2 3 compared to botuverá cave cruz et al 2005a while both locations are in phase with periods of high summer insolation cruz et al 2006 differing only in terms of intensity higher at santana near the northern sacz border in central brazil near brasília tamboril cave wortham et al 2017 shows a very interesting speleothem which has a relatively large δ18o range 3 9 to 8 4 however the mean value for the analyzed period 5 4 is similar to that of the other caves within the sacz this δ18o variability seen in speleothems in brazil over the past two millennia although small is currently interpreted as changes in summer monsoon that occurred during three key periods medieval climate anomaly and current warm period weakened monsoon and the little ice age strengthened monsoon as reviewed by vuille et al 2012 in the northeastern brazil speleothem records at paixão cave novello et al 2017 and northernmost in rio grande do norte have higher δ18o values cruz et al 2009b according to these authors precipitation in this area is not exclusively due to sacz activity in the summer but is also associated with the southernmost position of the itcz in march may precipitation in march may does not coincide with the higher insolation period antiphase as described by cruz et al 2009b and is thus more convective higher δ18o values consistent with speleothem data groundwater in this northern portion also has higher δ18o values fig 2 which reflect lower stratiform fractions in precipitation fig 4 we interpret the higher δ18o groundwater as an indication that the march may precipitation is recharging in this northern area higher δ18o values are recorded at the gnip stations located in the drought stricken northeast region betania and ceará mirim and at the coastal gnip stations of rio de janeiro and salvador that record tropical convection or itcz dominated precipitation in summary the speleothem records within our study area are consistent with the groundwater records which show a better response to rain type as opposed to commonly invoked wet and dry conditions 4 conclusions a groundwater isoscape map was produced from 1190 isotopic analyses of shallow and unconfined groundwater samples collected across the brazilian highlands in central southeast brazil a strong correlation was observed between spatial distribution of δ18o ratios of groundwater and the prevailing air circulation regimes in south america with apparent influence of the south atlantic convergence zone the δ18o values of shallow and unconfined groundwater reflect the bulk proportions of convective and stratiform precipitation which may or may not coincide with rainfall amount variations aggarwal et al 2016 because these groundwaters come from shallow unconfined aquifers and because 14c model ages indicate waters younger than 5000 years bp stradioto 2016 ana 2017 it is likely that the present atmospheric circulation pattern over the brazilian highlands has been fairly constant for at least several thousand years throughout the late holocene the results obtained in the present study suggest that regional shallow groundwater isotopic studies can be useful as proxy archives of palaeo precipitation to characterize changes in the proportions of convective and stratiform precipitation in tropical and subtropical latitudes this approach may also have broader implications when considered in paleoclimate interpretations derived from speleothem oxygen isotope records as the isotopic variations resulting from changes in precipitation type are of the same magnitude as those resulting from climate driven changes in moisture source and mean annual temperature credit authorship contribution statement hung k chang conceptualization formal analysis project administration methodology investigation roger d gonçalves formal analysis methodology writing original draft writing review editing investigation pradeep k aggarwal formal analysis methodology writing original draft marcia r stradioto investigation validation data curation emilio c b hespanhol investigation resources validation neil c sturchio writing original draft writing review editing ulrike romatschke methodology writing original draft luis j a araguas resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we acknowledge support from fundunesp unesp the national counsel for technological and scientific development cnpq and the international atomic energy agency the national center for atmospheric research is sponsored by the national science foundation this study was also made possible using freely available data from the iaea wmo global network of isotopes in precipitation gnip database the groundwater data presented in this paper can be found in the supporting information appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 124801 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
5551,dynamically coupled socioeconomic system dynamics models integrated with physically based environmental models dcsem can capture relationships between complex environmental and socioeconomic systems and are promising tools for participatory environmental management involving the integration of various viewpoints disciplines and processes for sustainable water resources management however the application of dcsems has been limited for many reasons including the complexity of the model coupling process i e the lack of a flexible model coupling approach issues of over parameterization high parameter uncertainty intensive computational requirements due to many interacting parameters and the possibility of eliciting behaviour pattern oriented model outputs as such most conventional numerical procedures for model evaluation i e analysis of point values of modelled results that have been implemented for physically based models are not applicable to dcsems in order to address these challenges this study developed a novel automatic behaviour pattern global sensitivity analysis gsa procedure to determine the influence of input parameters on the general behaviour trends rather than numerical point values of coupled model outputs the developed behaviour pattern gsa procedure was implemented in an existing software tinamït developed previously by the authors to ensure ease of use this study investigates the suitability of the proposed behaviour pattern gsa procedure for the analysis of dcsems by comparing the proposed procedure with the conventional numerical procedure the numerical and proposed behaviour pattern procedures coupled with the morris qualitative and efast quantitative gsa methods were applied to a dcsem to rank and screen parameters in a water table depth simulation in pakistan the determination of important parameters facilitates subsequent model calibration and groundwater management it was found that the morris and efast methods achieved similar parameter ranking results in the numerical and behavioural procedures respectively the results also indicated that the behaviour pattern gsa procedure offers more information about several important parameters and a variety of parameter ranking orders compared to the numerical gsa procedure regardless of which gsa method morris or efast was used the increased information obtained through the application of the developed behaviour pattern procedure confirms that the dcsem model outputs are behaviour oriented it is recommended that the proposed behaviour pattern gsa procedure be used with the morris method which has a higher computational efficiency 150 times than the efast method to detect important parameters in dcsems keywords coupled socioeconomic and environmental modelling socio hydrology morris efast sensitivity analysis groundwater 1 introduction 1 1 overview an integrated framework that incorporates the dynamic interactions between human actions and environmental e g hydrological systems is an important tool to support sustainable water and environmental resources management however traditional hydrological modelling frameworks often do not capture the dynamics emerging from feedbacks between the physical and socioeconomic processes of complex systems making them unrealistic in some cases elshafei et al 2014 increasingly the development of holistic environmental and hydrological models that appropriately capture nonlinear relationships between complex environmental and socioeconomic systems is gaining attention for example system dynamics sd forrester 1961 modelling is a useful tool to express nonlinear relationships between complex socioeconomic and environmental systems dyson and chang 2005 herrero et al 2014 prodanovic and simonovic 2007 it is a useful tool for modelling socioeconomic processes as it allows for holistic assessments this is due in part to its intuitiveness and capacity for integrating various viewpoints disciplines and processes kelly et al 2013 winz et al 2009 the utility of sd has been shown in water resources modelling and management ahmad and simonovic 2004 butler and adamowski 2015 hassanzadeh et al 2012 madani and mariño 2009 sahin et al 2015 and in policy analysis sustainable development and natural resource management dai et al 2013 hare et al 2003 prodanovic and simonovic 2007 sendzimir et al 2007 in particular sd has been used to link socioeconomic and hydrological models into one platform cockerill et al 2006 langsdale et al 2009 sušnik et al 2012 tight coupling of socioeconomic sd models and physically based environmental models dcsem into one platform e g tinamït malard et al 2017 allows for the simulation of interdependent factors through dynamic feedbacks between socioeconomic and physical processes offering a more holistic approach to environmental management butler and adamowski 2015 inam et al 2015 2017a however the dcsem modelling process relies on hypotheses associated with assumptions of model structures model inputs model parameter values and varied dynamic behaviour patterns elicited from the sd segment of the simulation results sd modelling is behaviour pattern oriented barlas 1989 drogoul et al 2016 hekimoğlu and barlas 2016 these hypotheses contribute to issues such as over parameterization interactions between a large number of parameters due to the high nonlinearity of model equations and moreover the fact that the model parameters are not uniquely identifiable due to the interactions nonlinearity between parameters gan et al 2014 thus dcsem parameters suffer from high levels of uncertainty which may yield unreliable simulation results sensitivity analysis sa is an approach used to investigate how uncertainty in model outputs can be apportioned to different sources of uncertainty in model parameters saltelli et al 2004 sa helps reduce the number of parameters while maintaining the reliability of model simulations working with fewer parameters reduces resource expenditure on parameter calibration a process that can be challenging in the context of limited data gan et al 2014 but is required for the successful application of coupled models e g dcsems 1 2 global sensitivity analysis features sa approaches can be categorized as either local sensitivity analysis lsa or global sensitivity analysis gsa methods lsa is a deterministic approach that considers how a small perturbation of a given input value influences the value of the output iooss and saltelli 2017 morio 2011 it does not identify interacting factors however a gsa provides information about how the model outputs are influenced by input variation over a full parameter space within a defined range homma and saltelli 1996 saltelli et al 2004 as gsas focus on the integrated model system as a whole they are particularly suited for dcsems gsas can be further classified into two groups the first being screening based methods qualitative methods that aim to screen out a subset of non influential parameters using a small number of simulations intuitively representing the relative sensitivity of parameters the second group is variance based gsa methods quantitative methods that measure the impact of each parameter on the total variance of model output and usually require a large number of model simulations campolongo et al 2011 gan et al 2014 screening based qualitative gsa methods include morris campolongo and cariboni 2007 morris 1991 latin hypercube one factor at a time lh oat van griensven et al 2006 supersaturated design lin 1993 screening by groups dean and lewis 2006 sequential bifurcation bettonvil and kleijnen 1997 and factorial fractional design montgomery 2017 the morris method allows for the processing of a large number of model inputs 20 inputs iooss and lemaître 2015 and nonlinear input output relationships which are characteristic of dcsems morris is the preferred method for input space exploration as random sampling occurs over a grid rather than at the starting points of trajectories as in lh oat variance based quantitative methods include monte carlo mc sampling based on sobol as well as an extended version based on quasi mc sampling saltelli et al 2010 sobol 1993 and the fourier amplitude sensitivity test fast and its extended version efast cukier et al 1978 saltelli et al 1999 efast has multiple uses and is widely applied in the field of environmental and water dynamics modelling e g mannina and cosenza 2015 mannina et al 2018 cosenza et al 2014 efast outperforms fast when used with spatially distributed models such as dcsems because parameter interactions cannot be detected by fast but are noted by efast saltelli et al 2010 1 3 behaviour pattern lsa and gsa procedures on sd and coupled models sd models are behaviour pattern oriented and are characterized as insensitive to most inputs due to the nature of feedback loops barlas 1989 barlas 1996 forrester 1961 thus a conventional numerical procedure wherein the sensitivity of point values in time is analyzed for output variables is not really suitable for sd models even so the majority of previous sd studies applied lsa methods using a conventional numerical lsa procedure e g forrester 1983 gonçalves 2009 güneralp 2006 kampmann and oliva 2008 saleh et al 2010 wang et al 2012 wei et al 2012 these quantitative lsa practices for sd models are only suitable for linear models or models wherein the uncertainty ranges of input parameters are small cariboni et al 2007 other attempts have been made to apply a numerical gsa procedure to sd models for example yehiaa et al 2014 applied a computationally intensive quantitative gsa method to a simple hypothetical sd model while inam et al 2017b c developed an integrated model that coupled a group built sd model gbsdm and a physically based environmental model sahysmod in the latter study the gsa was conducted only for the physical portion of the coupled model using the winglue application through the kolmogorov smirnov two sample test spear and hornberger 1980 and was not applied to the sd component of the coupled model although the behaviour pattern based procedure is more difficult to implement than the numerical procedure many efforts have been made to analyze the sensitivity of output behaviour patterns to input parameters in sd models the application of behaviour pattern based procedures has rarely been explicitly examined with physically based models sd studies by barlas and kanar 1999 yücel and barlas 2011 and sücüllü and yücel 2014 defined and used behaviour patterns for calibrating and testing sd models such sd studies quantified changes in output behaviour patterns behaviour pattern based procedure instead of point to point output values numerical based procedure however most of the sd studies applied behaviour pattern based procedures with lsa methods under the assumption of a fixed or single behaviour pattern of model outputs ford and flynn 2005 moizer et al 2001 ozbas et al 2008 given the dynamic nature of sd models especially when simulating a complex dynamic system the assumption of a single behaviour pattern of model outputs may not be appropriate the output behaviour pattern may change from one model simulation to another e g the behaviour pattern changes from linear growth to exponential growth between two model simulations hekimoğlu 2010 and hekimoğlu and barlas 2010 2016 were the first to develop a gsa procedure for sd models which considered multiple behaviour patterns in simulations these studies advanced the application of gsa to sd models by considering multiple behaviour patterns in simulation results however manual or visual procedures for checking simulation behaviours in the gsa process are unfeasible for a single physical sd model with many parameters especially for a dcsem which simulates a complex dynamic system some attempts have been made in previous studies to facilitate dynamic pattern behaviour mode recognition with software barlas et al 1997 boğ and barlas 2005 sücüllü and yücel 2014 in behaviour pattern based procedures however to the best of the authors knowledge no studies have yet implemented the behaviour pattern gsa procedure using automated software or tools with a dcsem automated tools combining quantitative qualitative gsa methods with a behaviour pattern based procedure are needed for this type of behaviour pattern recognition especially for use in coupled models simulating integrated dynamic systems of interactions between socioeconomic and physical processes as well as input parameters building on the studies discussed above the current study addresses issues related to lsa application non automated gsa procedures and the biased assumption of behaviour pattern s of model outputs for behaviour oriented models with many interacting parameters the proposed behaviour pattern gsa procedure using two gsa methods i e morris and efast allows for automated selection of the most appropriate behaviour pattern for each model simulation output without empirical biases this study is the first of its kind to develop an automated behaviour pattern gsa procedure for dcsems the current study explores the behaviour of both morris and efast as screening based qualitative and variance based quantitative methods respectively coupled with the gsa procedures mentioned above there is not much research on the application of gsa methods to a model that simulates integrated dynamic systems the current study aims to address this by developing an automated behaviour pattern gsa procedure a numerical gsa procedure as well as the developed behaviour pattern gsa procedure are applied to a dcsem and their performances are compared the behaviour pattern gsa procedure includes 1 automatic behaviour pattern recognition of model simulation results in conjunction with software developed by the authors i e tinamït malard et al 2017 through the addition of automatic pattern detection functions 2 goodness of fit gof calculations between the detected behaviour patterns and the simulation results and 3 application of gsa methods to the gof values and behaviour pattern parameters of the detected behaviour patterns for the dcsem to the best of the authors knowledge this is the first time that the gsa method has been used to determine the influence of model input parameters on the gof values of the detected behaviour patterns this represents how well detected behaviour patterns fit the model simulation results i e whether or not a pattern is sensitive to a parameter in addition the unique features of the automatic behaviour pattern recognition process allow for the application of the proposed gsa procedure to dcsems with multiple output behaviour patterns two gsa methods qualitative screening based morris and quantitative variance based efast using two gsa procedures a behaviour pattern and a numerical gsa procedure are investigated to determine 1 which gsa method morris or efast is more suitable for each gsa procedure and 2 which gsa procedure the behaviour pattern or numerical procedure coupled with its best suited gsa method is the most appropriate combination for a dcsem the proposed behaviour pattern gsa procedure is tested in the rechna doab basin in pakistan via the tinamït model coupling tool previously developed by the authors malard et al 2017 the results of the proposed behaviour pattern gsa method provide insights into different characteristics of output behaviour patterns readers should note that the terms gsa methods and gsa procedures are not synonymous gsa methods refer to the global sensitivity analysis methods or algorithms e g morris and efast used for parameter sampling and calculating parameter sensitivity indices a measure of parameter importance gsa methods are implemented using gsa procedures either numerical or behaviour pattern procedures a description of the proposed stepwise behaviour pattern gsa procedure is provided in the following sections 2 case study this section describes the application of the conventional numerical gsa and the developed behaviour pattern gsa procedures on a dcsem in this case the coupled p gbsdm previously developed by the authors in inam et al 2017b c which links a physically based p spatial agro hydro salinity model sahysmod oosterbaan 1995 with a group built system dynamics model gbsdm sahysmod simulates the physical processes whereas gbsdm simulates the socioeconomic processes the coupled p gbsdm simulates socioeconomic and environmental interactions through feedback loops sahysmod considers internal boundary conditions at a polygonal scale using a nodal network of rectangular polygonal configurations to define spatial variation in cropping irrigation drainage and groundwater in the study area the study area was divided into 215 polygons each polygon is 2 1 2 1 km in size the year 1989 was used as the base year for a 10 year 20 season simulation of water table depth from the winter of 1989 to the summer of 1999 a year was divided into two seasons with equal six month durations i e winter from november to april and summer from may to october for further details on the p gbsdm please refer to inam et al 2017b c the code used to run the two procedures on the p gbsdm through the tinamït malard et al 2017 tool can be found in appendix a the morris and efast methods were implemented through the salib 1 1 0 python package herman and usher 2017 2 1 study area data and parameters the study area is located in a semi arid region of rechna doab pakistan for more information about the study area data sources and data collection see inam et al 2017a an accurate simulation of water table depth fluctuations required knowledge of some physical hydrological factors e g hydraulic conductivity kaq for recharging and socioeconomic factors e g capacity per tubewell ctw for discharging to simulate a dynamic equilibrium in the area jehangir et al 2002 physical parameters affect the recharge rate in groundwater modelling and are often estimated based on soil characteristics corresponding to different land uses or soil types lin et al 2009 four different textural soil groups identified by their local names and characteristics are listed in table 1 inam et al 2017a khan et al 2003 due to the spatial variability of soil type within the study area for the polygon wherever more than one soil type was present the dominant soil type with the highest composition within the polygon was assumed to be homogeneously distributed across the polygon the special nodal network relationship between polygons which specifies neighbourhood effects in the study area represented the interchangeable hydrological processes across boundaries and between polygons see fig 1 the hydrological parameter kaq was computed for each polygon s node based on the average kaq for that node and that of its neighbour for each polygon four unique kaq values representing the four nodes were generated to account for the neighbourhood effect in contrast to a variable that shows actual measurements or attributes changing over time a parameter is an element of a system that can be altered to identify and evaluate a system s performance for example the performance of an aquifer system e g fluctuation of groundwater table depth as a variable depends on aspects such as the sensitivity of soil characteristics e g hydraulic conductivity if the system s performance is assessed by changing the characteristics and influential factors of the system then these factors e g hydraulic conductivity are considered as parameters rather than using the observed values in this study twenty three input parameters table 2 consisting of physical and socioeconomic parameters were selected for the p gbsdm based on the experience of the authors with the previous development of the p gbsdm to investigate the changes in water table depth in the study area physically based hydrological parameters denoted as p in table 2 included saturated hydraulic conductivity kaq total porosity of the aquifer zone ptq total porosity of the root zone ptr effective porosity of the aquifer zone peq and effective porosity of the transition zone pex the ranges for these specific parameters were taken from inam et al 2017a combining these five physical parameters with the four soil types led to a total of 20 soil hydrological parameters the three sd based socioeconomic parameters used denoted as sd in table 2 included yearly capacity per tubewell ctw and two tubewell potential operating hours poh poh winter november april and poh summer may october inam et al 2017a found groundwater extraction gw as a storage efficiency parameter to be highly sensitive in the sahysmod model in the current study gw was not considered directly as an input parameter but was instead indirectly addressed through its dependent socioeconomic parameters i e ctw poh summer poh winter which addressed the issue of gw sensitivity in this study a dummy parameter ranging from 0 to 1 was added to the parameters a total of 24 parameters consisting of 23 selected model input parameters plus one dummy parameter and applied to the sampling and analysis methods for morris and efast to validate the effectiveness of the selected screening threshold all the parameter ranges and values including the dummy parameter are shown in table 2 morris and efast were applied to the 24 parameters for the 10 year 20 season time period for the morris method 625 model simulations were adopted and for efast 120 000 model simulations were applied refer to section 3 1 for details about sample size water table depth was used as an output variable to calculate sensitivity indices of the 24 model input parameters a detailed analysis of the results of the application of the morris and efast methods with the two procedures behaviour pattern and numerical as well as their comparison and graphical representations are provided in section 4 3 methods for each distributed subarea the conventional numerical gsa procedure analyzes the model output of numerical points and the behaviour pattern gsa procedure automatically analyzes the behaviour patterns of the model outputs this study used polygons to represent distributed subareas of the dcsem at different points in time seasonal based on a pre defined time series defined by the users thus in order to compare the suitability of a numerical gsa procedure and the developed behaviour pattern gsa procedure the numerical and behaviour pattern gsa procedures were performed on a polygonal basis and summarized in the five sections steps shown in fig 2 section 3 1 includes the set up of model parameters and definition of their allowable ranges as well as details of the determination of the number of simulations needed for the application of the morris and efast methods section 3 2 describes the model sensitivity simulation sections 3 3 and 3 4 describe the two output processes of the sensitivity simulation results conducted separately using the morris and efast methods specifically section 3 3 defines the numerical point based output process involving the selection of six output measures which included five points in time and the calculated mean value of the time series for each of the simulation results section 3 4 outlines the behaviour pattern based output process which detected output behaviour patterns e g linear exponential oscillation followed by the gof calculation and behaviour pattern parameter e g slope intercept values collection for each of the detected behaviour patterns section 3 5 describes the calculation of sensitivity indices for each input parameter for each of the six point based output measures section 3 3 as well as behaviour pattern based output measures section 3 4 lastly the parameters were ranked based on the chosen maximum sensitivity index of all polygons for each parameter for each of the output measures 3 1 sampling strategy and sample size the number of simulations for the gsa application is directly dependent on the number of parameters both socioeconomic and physical hydrological parameters are required as these represent the system dynamics and physical components respectively in the dcsem sensitivity analysis see section 2 1 for details sections 3 1 1 and 3 1 2 establish the number of simulations needed for the application of the morris and efast methods 3 1 1 morris morris 1991 is a qualitative screening gsa method in which the final sensitivity measures are calculated by averaging the elementary effects e e of each input factor parameter on model outputs e e is calculated by changing one parameter at a time oat by the amount δ between subsequent model simulations where the δ value is between 1 p 1 1 1 p 1 and p is the number of predetermined levels the range of each parameter is portioned into p levels where each parameter samples from these p levels thus the vector of k parameters x 1 x k is sampled from a hyperspace of a k dimensional p level grid for each parameter the ee calculation is repeated n times at different points in the parameter space and a mean of the absolute values for the n e e s are calculated campolongo and cariboni 2007 and taken as the measure of sensitivity i e sensitivity indices sensitivity indices measure parameter sensitivity as the variability induced in parameter sets the greater the value of a sensitivity index the larger the influence of that parameter on the dependent variable a screening threshold morris sensitivity index is 0 1 cosenza et al 2013 vanrolleghem et al 2015 was applied here to separate the influential and non influential parameters the morris method was applied to all 24 parameters used in this study 23 selected model input parameters as well as one dummy parameter previous studies campolongo and cariboni 2007 morris 1991 saltelli et al 2000 calculated the sample size n for morris based on the number of k parameters as shown in eq 3 1 3 1 n n k 1 where n is usually between 5 and 15 morris 1991 vanuytrecht et al 2014 selected 47 and 43 parameters in their sensitivity study and indicated that n 25 was sufficient to distinguish between important and non influential parameters the p level does not affect the sample sizes but determines the sample ranges gan et al 2014 tested different combinations of p levels p 4 8 16 and 32 and n base sample sizes n 5 10 20 30 they found that results are not stable under different combinations and therefore recommended using p 16 or 32 and n 20 for the morris method to reach screening convergence i e the sample size for which no significant change in identification of the non influential input factors occurred thus for the purpose of identifying important for ranking and non influential for screening parameters due to the concern for computational feasibility of a large and complex dcsem a combination of p 16 levels and n 25 for the 24 parameters was applied resulting in a total sample size of 625 this was calculated via eq 3 1 and applied in the present study 3 1 2 efast efast is a quantitative gsa method that decomposes the total variance of the simulation results into fractions which can be attributed to individual inputs or sets of input values cukier et al 1978 saltelli et al 1999 the most widely used sensitivity measure of efast is the first order effect called the efast sensitivity index in the current study of the individual parameters it measures how individual parameters contribute to the total output variance the parameters are ranked based on their first order effect values with higher ranked parameters having a greater influence on the model output a screening threshold efast sensitivity index 0 01 cosenza et al 2014 sin et al 2011 vanrolleghem et al 2015 was applied in this study variance based gsa methods tend to be computationally expensive i e the simulation time required for the morris and efast methods is substantial when using a large number of parameters k zhang et al 2015 similar to the approach used with the morris method the total sample size for efast was determined by a base sample size n typically between 500 and 1000 and the number of parameters k pianosi et al 2016 saltelli et al 2010 saltelli et al 2005 for a complex model with a large number of input parameters e g 20 parameters a minimum of 10 000 model simulations are required for variance based methods however different studies recommend different sample sizes saltelli et al 2000 indicated that the smallest sample size for efast indices should be 65 k whereas vanrolleghem et al 2015 applied efast with n 5000 and 17 parameters leading to n k 85 000 simulations in studying the fast efast method pianosi et al 2016 observed that when the number of parameters nears 50 approximately 100 000 model simulations are required to reach sensitivity index convergence thus in the case of the 24 model parameters used in the current study sample size sets of more than 100 000 were considered to achieve an adequate estimation of sensitivity indices in the current study the sample size for efast was based on the results of eq 3 2 vanrolleghem et al 2015 thus given a base sample size of n 5000 and k 24 a total sample size of 120 000 was applied 3 2 n n k morris and efast were applied under the assumption of uniform distribution for all 24 input parameters the distributions of all input parameters were independent of each other the ranges of values of the 24 parameters are presented in table 2 it should be noted that the parameter sample size greatly affects the convergence of parameter sensitivity indices for sa wang et al 2013 in other words there is an increased tendency for sa indices to converge with increasing sample size which in turn is directly dependent on the number of parameters although a larger sample size might yield more reliable parameter sensitivity indices gsa users should still consider an appropriate compromise between the method s computational feasibility and accuracy 3 2 model simulation the following model simulation procedure was performed once for each of the morris 625 samples and efast 120 000 samples methods with the time unit of simulation being a season 6 months and the time frame of simulation moving from the winter of 1989 to the summer of 1999 10 years or 20 seasons the model simulation results from morris and efast were subsequently passed through the point based and behaviour pattern based output processes separately due to differences in the numerical and behaviour gsa procedures two output processes one for output point values section 3 3 and another for output behaviour patterns section 3 4 were applied to the morris and efast simulation results for each gsa procedure 3 3 conventional numerical point based output process this study used a 20 season time series for the dcsem inam et al 2017b c of the 20 season time series five seasons 1 5 10 15 and 20 were selected to be used in the numerical gsa procedure these five seasons including their starting and ending points displayed a regular distribution within the pre defined time frame this represents the time varying characteristics of the output variable the selection of five seasons also offered improved computational feasibility for the subsequent calculation of sensitivity indices this reduced the computation of a sensitivity index for each model parameter from 20 points to 5 points and simplified subsequent calculations in addition the mean value of the time series was calculated as a representative estimation of one set of simulation results thus the six output measures consisted of the five selected seasons and the mean value of the time series in the numerical point based output process these were collected in preparation for computing sensitivity indices for the morris and efast methods in section 3 5 3 4 behaviour pattern based output process 3 4 1 fitting linear functions each simulation result 20 seasons per result set was fitted into a linear behaviour pattern the slope of the linear function offers general information on trends in growth and decline for that set of simulation results even if the behaviour pattern of that set does not completely manifest as a linear trend thus slope and intercept as two output measures from the simulation results of all polygons were collected for the calculation of parameter sensitivity indices shown in mathematical description of step 1 3 4 2 fitting behaviour pattern functions this section describes the behaviour pattern based output process which consisted of three steps in step 1 each set of simulation results was fit to 21 possible behaviour pattern functions consisting of seven basic regression functions linear exponential inverse logistic logarithmic oscillation basic sine wave function and dynamic oscillation damped and divergent oscillations listed in table 3 and 14 advanced superposition functions these 21 functions were fit to each set of the simulation results described in processes 1 and 2 of step 1 in step 2 the corresponding g o f j j 1 2 20 was calculated for the 21 previously fitted functions and the one with the optimal gof value was selected as the best fit behaviour pattern for that set of simulation results in step 3 the best fit behaviour patterns were collected for all simulation results for one polygon these three steps were repeated for each of the polygons i e iterated 215 times for the 215 polygons in this study finally the best fit behaviour patterns for each polygon after all simulation runs n were collected in preparation for the morris and efast sensitivity analyses described in section 3 5 these steps are explained in further detail below step 1 process 1 each set of simulation results was fit to the seven basic regression functions listed in table 3 to detect the corresponding behaviour pattern parameters marked as behaviour pattern parameters in table 3 the dependent variable t in the function equations in table 3 corresponds to the points in time along the horizontal axis and f t is one set of fitted data obtained by using standardized model simulation results to fit each of the seven basic functions standardization eq 3 3 of simulation results facilitated the behaviour pattern recognition process even if simulation results were presented at different scales by avoiding inaccurate behaviour pattern recognition due to outlying points in the simulation results in this study all simulation results were standardized using their means and standard deviations as shown in eq 3 3 before being fit to behaviour patterns the same means and standard deviations from the non standardized simulation results were used to properly de standardize the standardized results after fitting 3 3 f standardize t y y σ y where y is the non standardized model simulation result which ranges from 1 to the pre defined time series and y is the average value of y the 14 additional superposition functions were generated by combining the last two oscillation functions oscillation and dynamic oscillation in table 3 with each of the seven basic behaviour patterns this was done because nonlinear dynamic systems usually elicit output behaviours with complex versions of oscillations sterman 2000 process 2 the 14 additional superposition functions were computed by first calculating seven sets of residuals by subtracting the seven previously generated basic behaviour pattern functions from process 1 from each set of model simulation results the seven subtracted residuals were fit to both the oscillation and dynamic oscillation functions to generate two residual functions an oscillation residual function and a dynamic oscillation residual function finally two new superposition functions were generated by taking the sum of each of the seven basic pattern functions and their two respective residual functions thus for each of the seven basic behaviour pattern functions three functions the basic function itself plus two superposition functions were returned a total of 21 behaviour pattern functions were generated for one set of model simulation results from processes 1 and 2 mathematical description of step 1 process 1 1 over a 20 season time series t t i i 1 2 20 one set of model simulation results y was obtained from the total number of model simulations n standardization of y generated s using eq 3 3 3 4 s y y σ y 2 s and t were then fit to each of the seven basic functions f t table 3 in order to detect the behaviour pattern parameters of the seven functions of the s a new set of values u was calculated using the detected behaviour pattern parameters and t of f t process 2 3 the differences between the sets of simulation results y and u were calculated to generate a set of residuals r via subtraction 3 5 r s u 4 standardization of r generated w 3 6 w r r σ r 5 w and t were fit to the oscillation and dynamic oscillation functions presented in table 3 to detect their corresponding behaviour pattern parameters to generate two residual functions the oscillation residual function f 2 t with a 2 b 2 c 2 and c o n s t a n t 2 parameters fit f 2 w t and the dynamic oscillation residual function f 3 t with a 3 b 3 c 3 d 3 and c o n s t a n t 3 parameters fit f 3 w t 3 7 f 2 t a 2 s i n b 2 t c 2 c o n s t a n t 2 3 8 f 3 t e a 3 t b 3 s i n c 3 t d 3 c o n s t a n t 3 6 two new superposition functions of the seven basic patterns were calculated by taking the sum of f t and the two de standardized residual functions thus three functions were generated from a single basic function f t f t f 2 t and f t f 3 t 3 9 f t f 2 t f t a 2 s i n b 2 t c 2 c o n s t a n t 3 10 f t f 3 t f t e a 3 t b 3 s i n c 3 t d 3 c o n s t a n t step 2 the second step aimed to identify the best fit behaviour pattern for each set of model simulation results from the 21 functions generated in the previous processes by investigating the regression relationship between each set of simulation values and the 21 generated functions most commonly used gof regression analysis criteria e g r squared root mean squared error rmse residual standard error rse and mean absolute error mae are sensitive to the inclusion of additional parameters behaviour pattern parameters in a model fitted output behaviour patterns in addition a more complex output behaviour pattern often has a higher number of behaviour pattern parameters that is including additional model parameters might change the values of those criteria e g increase the r squared and reduce the rmse kassambara 2018 appropriate model selection criteria for the identification of the best fit behaviour pattern for a model must balance fitted error and model complexity the definition of a suitable selection method is based on the number of behaviour pattern parameters in a function the higher the number of behaviour pattern parameters the higher the complexity of the function the appropriate choice of a fitness function reduces the chance of model overfitting akhil and kang 2013 thus appropriate model selection criteria contain a mechanism to adjust the classical regression analysis gof criteria in terms of the number of variables in the model to account for overfitting some popular fitness functions that meet these requirements include akaike information criteria regression aicr akaike 1973 schwarz 2011 bayesian information criterion bic schwarz 1978 structural risk minimization srm vapnik 1998 predicted residual error sum of squares press barron 1984 and final prediction error fpe model residuals are also important in regression analysis and model selection cucker and zhou 2007 prins 2013 if a model correctly fits the data the residuals which represent the statistical relationship between the explanatory variables and the response variable appear to behave randomly tan et al 2014 the maximal information coefficient mic reshef et al 2011 is a measure of dependency between the residuals and the explanatory variables in the current study six fitness functions aicr bic srm press fpe and mic were employed to identify the simplest model that adequately explained the hydrologic prediction schoups et al 2018 the fitness functions assess the quality of each fit between each set of model simulated results and the 21 generated behaviour pattern functions after the first two steps the behaviour pattern based output process was completed for one set of sensitivity simulation results the same process was replicated for all sets of simulation results the performance of each fitness function was evaluated by 1 statistical analysis comparison results presented in table b3 and 2 visualized presentation of the best fit behaviour selected by each fitness function and the model simulations as shown in fig 6 these fitness functions were applied on the morris simulation results their equations are shown in eq b 1 to eq b 4 all six model selection criteria provided similar outputs for the morris simulation results given the high computational cost associated with efast implementation only aicr shown in eq 3 11 was used in efast simulation akaike 1973 schwarz 2011 3 11 aicr n l o g sse n 2 k where k is the number of behaviour pattern parameters in the function sse is the sum of squared errors between the model simulation and each of the 21 fitted functions and n is the length of the predetermined time series i e the 20 season time series used in this study the pattern with the lowest value of aicr bic srm press and fpe or the highest value of mic was considered the best candidate for describing the behaviour pattern of this set of simulation results and was carried forward to step 3 for further analysis to limit the length of the remaining subsections of section 3 only aicr subsections only aicr analysis results are discussed the morris simulation results as assessed by the other fitness functions are available upon request step 3 each polygon was simulated n times in the first two steps each simulation result was iterated through until n instances of behaviour pattern recognition were completed for one polygon one polygon through n instances of behaviour pattern recognition may generate 1 to 21 different best fit behaviour patterns denoted as b b 1 21 all detected best fit patterns from all n runs were recorded for each polygon to prepare for the morris and efast sensitivity analysis in other words once a pattern had been detected as the best fit behaviour pattern in one instance of behaviour pattern recognition this pattern was passed to morris and efast where the parameter sensitivity of corresponding behaviour pattern parameters and aicr values were calculated after repeating the above three steps for p polygons the total number of best fit behaviour patterns for p polygons was found to be p n b a total of p n 9 b 9 were detected in this study for both the morris and efast simulation results in the next step the output measures of b best fit behaviour patterns were collected namely the behaviour pattern parameters and aicr values which yielded a total of 47 behaviour pattern p n b based output measures including linear output measures such as slope and intercept a total of 53 output measures were collected from both the numerical point based and behaviour pattern based output processes with six from the numerical procedure and 47 from the behaviour pattern procedure all 53 output measures were used in computing the sensitivity indices for the morris and efast methods in section 3 1 3 5 calculation of sensitivity indices of parameters in relation to the output measures in this part of the study the morris and efast methods were implemented to compute the sensitivity indices of input parameters in relation to each output measure for all polygons the results of the parameter sensitivity rankings and subsequent identification of important and non influential parameters for different output measures were assessed based on the sensitivity indices the important parameters were identified using the morris and efast screening thresholds greater than 0 1 for morris and greater than 0 01 for efast the maximum sensitivity index of each parameter to each of the output measures from all polygons was chosen to create parameter sensitivity rankings and screening maps specifically for each input parameter sensitivity indices for all output measures 53 in p polygons were generated a given parameter and output measure would then have p different sensitivity indices then the maximum sensitivity index of those p different sensitivity indices was selected to represent that parameter for each specific output measure when plotting the final ranking map the two output processes in the two gsa procedures described above can automatically calculate parameter sensitivity in relation to the output measures of all polygons through tinamït the proposed methodology in the current manuscript supports the investigation of how the behaviour pattern of the model output is affected by input parameters in order to compare the large number of output measures from the two gsa procedures and analyze the parameter sensitivity rankings an agglomerative hierarchical clustering algorithm müllner 2011 was applied to the parameter rankings for all 53 output measures hierarchical clustering was chosen as it does not require a specific number of clusters the agglomerative hierarchical clustering algorithm creates dendrogram plots for all output measures 53 identifying each cluster and the distance between the centroids of the clusters the results of parameter rankings of all output measures were analyzed to support the selection of a suitable number of clusters for the morris and efast methods and the appropriate output measures for the two gsa procedures the clustering algorithm categorized similar ranked output measures into one group the criteria for selecting the most suitable output measure s from each group was based on the complexity of applying output measures to the dcsem thus the implementation complexity was ranked from the least to most complex as follows implementing output measures from the numerical point based output process aicr for basic behaviour patterns aicr for superposition behaviour patterns behaviour pattern parameters for basic behaviour patterns and behaviour pattern parameters for superposition basic behaviour patterns 4 results and discussion computational cost is associated with the number of model simulations required for the 24 parameters in the p gbsdm morris with 625 simulations completed its simulation within two hours whereas efast with 120 000 simulations took 15 days of parallel multi processing seven threads windows 10 os 32 gb ram i7 series intel processor via tinamït this suggests that when the number of parameters is large 20 parameters the variance based quantitative method efast is not feasible for calculating sensitivity indices for complex models due to computational limitations in these cases morris the screening based qualitative method is recommended results from both morris and efast and the two gsa procedures are presented in fig 3 the value of the dummy parameter for all output measures was 0 non influential in both the morris and efast results which added to the confidence of the gsa methods used the results of the numerical gsa procedure the behaviour pattern gsa procedure as well as a comparison of the two are described in the following sections 4 1 conventional numerical gsa procedure results the numerical output measures from the numerical point based output process for the five selected seasons n1 to n5 and at the mean n6 of the time series for both the morris and efast methods are summarized in the n part of fig 3 see also group 4 in fig 4 table b1 for morris and see group 1 in fig 5 table b2 for efast clustering results the parameter ranking results using morris and efast showed that the same parameters ptq ptr and the dummy parameters were detected as non influential for all six output measures fig 3 the top ranking parameters were a discharging factor from the gbdsm model ctw with the exception of season five n2 for morris and a hydrological recharging factor kaq for efast for numerical output measures generally both methods achieved similar ranking results these results suggest that when simulating groundwater using the coupled model the five points in time and the mean value of water table depth are highly sensitive to changes in kaq and ctw 4 2 behaviour pattern gsa procedure results fig 6 presents the comparison of the six best fit behaviours recognized by the six different model selection criteria and the corresponding model simulation results for six different polygons note that the 90th run of the morris simulation was randomly selected to serve as an example due to limits on the paper length as shown in fig 6 and in the statistical analysis results presented in table b3 the six model selection criteria produced similar outcomes when detecting the best fit behaviours of the model simulations in terms of trend consistency and trend accuracy see table b3 for details given these similarities and constraints on paper length only the results of the aicr criterion are presented in the following sections to demonstrate the analysis process and conclusions the results of the behaviour pattern based gsa procedure assessed using aicr see section 3 4 showed that the same nine behaviour patterns were detected among the 21 behaviour pattern functions for all simulation results using both the morris and efast methods a behaviour pattern function was recorded even if it was only detected once among all simulations these nine distinct behaviour patterns can be linked to the feedback loops and model structures that are characteristic of system dynamics models one component of the dcsem and create distinct behaviour modes for different model runs hekimoğlu and barlas 2010 thus the nine behaviours were separated before calculating the parameter sensitivity rankings to more fully present the different characteristics of the model the nine behaviours included seven basic behaviour pattern functions including the linear function as well as two superposition functions the superposition function of oscillation with the inverse function eq b 5 and the superposition function of dynamic oscillation with the logarithmic function eq b 6 in order to find the most suitable output measures for the p gbsdm the agglomerative hierarchical clustering method was applied to the parameter rankings for all 53 output measures refer to section 3 4 for the hierarchical clustering method applied in this study season one n1 was excluded from the clustering as it was used to initialize the model simulation and no influential parameters had been detected using either the morris or efast methods visual representations of the sa ranking results are presented in the following sections 4 2 1 and 4 2 2 4 2 1 morris results the upper part of fig 3 shows the ranking scheme of the morris method for parameters in terms of their sensitivity to output measures based on the morris clustering results all 53 output measures were categorized into four groups as shown in fig 4 group 1 had only one output measure the behaviour pattern parameter for the superposed dynamic oscillation and the inverse function c1 this pattern was considered an outlier as it is the only pattern in this group group 2 and 3 included aicr output measures for the basic and superposition behaviour patterns the examination of all aicr output measures denoted as a in table 4 for the developed behaviour pattern gsa procedure is recommended as these are more easily applied and simpler compared to the behaviour pattern parameters of the detected behaviours b notations in table 4 group 4 included all the numerical sa results as they achieved a similar ranking see section 4 1 for details the behaviour pattern gsa procedure was found to be more suitable compared to the numerical procedure for dcsem when using morris this is because the behaviour pattern gsa procedure detected more parameters with different ranking orders compared to the numerical gsa procedure ptq ptr and pex were deemed non influential in the numerical gsa procedure but not in the behaviour pattern gsa procedure these results are expected given the nature of the system dynamics sd component of dcsems specifically the behaviour pattern of sd variables here representing different behaviour pattern output measures of simulated water table depth has more impact on the results than the numerical points so the uncertainty of model parameters must be characterized through the analysis of the pattern characteristics of the output variables hekimoğlu and barlas 2016 therefore some characteristics of the output behaviour patterns can only be captured by the behaviour pattern gsa procedure leading to a more diverse parameter ranking order compared to the numerical procedure aicr output measures group 2 and 3 of fig 4 of detected behaviour patterns in the behaviour pattern gsa procedure were especially important as they offered similar screening and ranking results when compared to the remaining behaviour output measures b and c areas in fig 3 with the least implementation complexity in terms of behaviour pattern output measures 4 2 2 efast results the lower section of fig 3 shows the efast results of the ranking parameters in terms of their sensitivity to output measures the rankings were clustered into three groups fig 5 table b2 group 1 included almost all numerical sa results season five n2 t 5 is excluded all screening results were found to be similar see fig 5 for details group 2 included behaviour pattern parameters for the basic and superposition behaviour patterns the simpler output measures meaning the behaviour pattern parameters for the basic behaviour patterns b11 b12 b21 were the most suitable output measures in this group group 3 included aicr for the basic and superposition behaviour patterns as well as the behaviour pattern parameters for the basic and superposition behaviour patterns the simplest numerical point based output measure t 5 n2 was also placed in this group however the aicr for the basic behaviour patterns a1 a2 a3 a4 a5 a6 a7 was more representative of most of the output measures in this group the efast results also indicated that the behaviour pattern gsa procedure is more suitable than the numerical gsa procedure for example using the behaviour pattern gsa procedure the parameter pex was deemed to be significant with medium sensitivity fourth to sixth in rank among the behaviour pattern output measures whereas pex was non influential under the numerical gsa procedure this suggests that the behaviour pattern gsa procedure is more informative compared to the numerical gsa procedure when using efast therefore it is recommended that both aicr and the behaviour pattern parameters of the detected behaviour patterns be used with the efast method to obtain complete ranking and screening information 4 3 comparison of morris and efast despite differences in the top ranking parameter for the aicr output measures area a in fig 3 in the morris ctw and efast kaq methods except a6 a7 both morris and efast achieved similar rankings in general though the bottom ranks of the important parameters differed between the two methods ptq and ptr were deemed important in morris but not in efast the significant influence of ctw and kaq was detected by both methods this is in agreement with the findings of qureshi et al 2003 in their study of the rechna doab basin in pakistan the results of qureshi et al 2003 highlighted the impact of over pumping via tubewells on the falling water table in the region which has been identified as a major concern of private tubewell owners in the area in addition the high sensitivity of kaq to water table depth helped highlight the hydrological characteristics that most affect water table fluctuations in the study area similar findings were found in previous studies e g alizadeh et al 2017 lu and vesselinov 2015 the detected behaviour pattern output measures b c areas in fig 3 consist of three types of output measures first is the linear output measures which are slope and intercept b7 b8 in fig 3 although the parameter sensitivity rankings and screenings for slope and intercept output measures were not completely consistent between morris and efast the top two ranking parameters kaq and ctw were the same additionally the parameter pex was defined as non influential by both the morris and efast methods the second type of output measures are behaviour pattern parameters from seven basic behaviour patterns area b in fig 3 refer to table 3 for the seven basic behaviour patterns the third type of output measures are the behaviour pattern parameters of the superposition functions area c in fig 3 according to areas b c in fig 3 morris exhibited a more scattered top rank compared with efast in other words parameters poh winter poh summer peq ctw and kaq were found to be the top rank with morris whereas kaq peq and ctw were found to be the top rank with efast in the behaviour pattern gsa procedure the efast method achieved more stable rankings not only within but across different groups compared to morris however the screening results differed between the two gsa methods despite their position at the bottom of the ranking scheme most of the output measures of the morris method identified additional important parameters ptq and ptr which were eliminated in all output measures of the efast method although most of the top ranking parameters for both output measures were slightly different kaq or ctw in efast and ctw in morris the top two important parameters kaq and ctw were identified in both gsas this indicated that the balance of water table depth was significantly controlled by recharging kaq and discharging ctw parameters and that groundwater pumping and recharge are the two main forces in the groundwater basin tolley et al 2019 according to inam et al 2017c the important feedback loops of the model evaluated the effect between aquifer recharge and tubewell installation capacity the two gsas i e morris and efast were able to capture the key uncertainty parameters for different output behaviours of the dcsem this resulted in a reduced number of dominant parameters facilitating subsequent model calibration and assisting in hydrological modelling to understand the changes in groundwater hydrology and management in terms of screening results although morris detected two other important parameters i e ptq ptr at the lower end of the ranking positions this may have been due to overestimation it is still worthwhile to include these parameters as they offer further information for identifying important parameters in future model calibrations note that although the ranking and screening results of the two gsa methods for both procedures were similar the computational resources required to complete each procedure differed significantly the strength of the morris method is its computational efficiency as 625 model runs were completed within only two hours the efast method is more complex and computationally expensive the 120 000 model runs took 15 days when comparing the results of the two gsa methods used with the two gsa procedures it can be argued that the morris method coupled with the behaviour pattern gsa procedure is the most suitable combination for dcsems due to its computational feasibility and thorough screening abilities 5 conclusion dcsems e g the p gbsdm used in this study are potentially useful tools to help develop a more holistic understanding of socioeconomic and hydrological interactions to help facilitate more sustainable water resources management dcsems are typically developed to represent behaviour patterns of simulated systems and have a high level of complexity due to model coupling high parameter uncertainty intensive computational requirements and numerous interacting parameters given these challenges the assessment of different procedures to simplify modelling while maintaining model accuracy is important the current study compares the application of a behaviour pattern gsa procedure suitable for use with an sd model with a conventional numerical gsa procedure often used with physically based environmental models to investigate which model components dominate the coupled model output behaviour gsa plays an important role in identifying non influential parameters that have little influence on the outputs of a dcsem either numerical point based or behaviour pattern based and which can thus be excluded from subsequent calibration procedures without compromising the quality of model predictions the automatic gsa procedure presented in this study allows for sampling sensitivity simulation output processing of point based and behaviour pattern based outputs goodness of fit gof calculations and calculation of sensitivity indices for output measures generated from the two output processes the study found that the high sensitivity parameters are those that control pumping ctw and recharge kaq with numerical and behaviour pattern gsa procedures it is suggested that performing sensitivity analysis is important for dcsems with spatially distributed recharge and pumping conditions over a watershed the proposed gsa procedures can help facilitate a better understanding of the drivers of groundwater fluctuations allowing for more sustainable management for example the discharging factor of tubewell installation capacity ctw was shown to significantly affect the contributions of groundwater supplies kaq in the model s groundwater hydrology balance the results of the current study support better water management decisions in the context of heterogeneous soil texture and ambient and pumping conditions in different polygons in this regard the automatic behaviour pattern gsa procedure is well suited to determining the impacts and uncertainties ofdynamic feedbacks between human and natural systems when coupled with holistic modelling frameworks such asdcsems this study is the first of its kind to perform a behaviour pattern gsa procedure with two gsa methods to determine the influence of model input parameters on the gof values e g aicr of the detected behaviours in the absence of prior assumptions of either input parameter distribution or model input output relationships two gsa methods morris or efast were compared to determine which was the most suitable for a dcsem by investigating whether the sensitivity indices for behaviour pattern output measures were different from the numerical point based output measures additionally the study proposed an automatic behaviour pattern recognition method that improves the feasibility of dcsem application with multiple output behaviour patterns a limitation of the current study is that the python package used to detect the shape and perform the automatic behaviour pattern recognition resulted in unconverged behaviour pattern parameter values for some of the behaviour pattern functions e g the logarithmic function it is recommended that future research explore the improvement of these behaviour pattern parameters through the use of alternative optimization algorithms or through optimization parameter adjustment the results of this study showed that compared to the efast method the morris method identified more important parameters parameters that could be important for future model calibrations with higher computational efficiency it is suggested that for greater accuracy the lowest ranked parameter from the morris method could be excluded from future model calibrations under conditions of limited computational resources the current study suggests that the advantage of using the behaviour pattern gsa procedure with a dcsem is that it offers more information on the number of important parameters as well as a variety of ranking orders compared to the numerical gsa procedure the behaviour pattern gsa offers more insights on parameter sensitivity to different characteristics of the output behaviour patterns in addition the output behaviour pattern is more important than numerical points when investigating parameter uncertainty in dcsems the proposed procedure was tested on data from the rechna doab basin in pakistan via the tinamït model coupling tool previously developed by the authors malard et al 2017 it is recommended that researchers and practitioners with limited computational resources who are interested in the behaviour pattern gsa procedure explore the application of aicr alone to each of the best fit behaviour pattern simulation results in addition if one is using the conventional numerical gsa procedure on a dcsem it is suggested that the procedure be applied to all points in the time series as well as to their mean values as the numerical procedure provides different information at each point i e the procedure detects a different number of important parameters and ranking orders at different points in time credit authorship contribution statement xingyu peng writing original draft methodology writing review editing jan adamowski writing review editing supervision azhar inam software data curation mohammad reza alizadeh writing review editing raffaele albano writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by an sshrc insight grant grant number 435 20 17 14 82 held by jan adamowski appendix a software and data availability python the tool is written in the python language and is available under an open source license at https github com gabriellapeng tinamit tree gaby histogram tinamït the tinamït code requires approximately 2 5 mb of disk space and includes multilingual graphical user interface gui support that allows users to translate the gui into the most appropriate language for their stakeholder community full documentation is available at http tinamit readthedocs io appendix b equation and tables b 1 bic s s e n k n s s e n k l o g n b 2 srm s s e n 1 k n k n l o g k n l o g k n 2 n 1 2 1 b 3 press s s e n 1 2 k n b 4 fpe s s e n n k n k b 5 f t superposed ocill i n v e r s e a s i n b t c a 2 t b 2 c o n s t a n t b 6 f t superposed dynamic o c i l l l o g a r i t h m i c e at b s i n c t d a 2 log e t b 2 c o n s t a n t 
5551,dynamically coupled socioeconomic system dynamics models integrated with physically based environmental models dcsem can capture relationships between complex environmental and socioeconomic systems and are promising tools for participatory environmental management involving the integration of various viewpoints disciplines and processes for sustainable water resources management however the application of dcsems has been limited for many reasons including the complexity of the model coupling process i e the lack of a flexible model coupling approach issues of over parameterization high parameter uncertainty intensive computational requirements due to many interacting parameters and the possibility of eliciting behaviour pattern oriented model outputs as such most conventional numerical procedures for model evaluation i e analysis of point values of modelled results that have been implemented for physically based models are not applicable to dcsems in order to address these challenges this study developed a novel automatic behaviour pattern global sensitivity analysis gsa procedure to determine the influence of input parameters on the general behaviour trends rather than numerical point values of coupled model outputs the developed behaviour pattern gsa procedure was implemented in an existing software tinamït developed previously by the authors to ensure ease of use this study investigates the suitability of the proposed behaviour pattern gsa procedure for the analysis of dcsems by comparing the proposed procedure with the conventional numerical procedure the numerical and proposed behaviour pattern procedures coupled with the morris qualitative and efast quantitative gsa methods were applied to a dcsem to rank and screen parameters in a water table depth simulation in pakistan the determination of important parameters facilitates subsequent model calibration and groundwater management it was found that the morris and efast methods achieved similar parameter ranking results in the numerical and behavioural procedures respectively the results also indicated that the behaviour pattern gsa procedure offers more information about several important parameters and a variety of parameter ranking orders compared to the numerical gsa procedure regardless of which gsa method morris or efast was used the increased information obtained through the application of the developed behaviour pattern procedure confirms that the dcsem model outputs are behaviour oriented it is recommended that the proposed behaviour pattern gsa procedure be used with the morris method which has a higher computational efficiency 150 times than the efast method to detect important parameters in dcsems keywords coupled socioeconomic and environmental modelling socio hydrology morris efast sensitivity analysis groundwater 1 introduction 1 1 overview an integrated framework that incorporates the dynamic interactions between human actions and environmental e g hydrological systems is an important tool to support sustainable water and environmental resources management however traditional hydrological modelling frameworks often do not capture the dynamics emerging from feedbacks between the physical and socioeconomic processes of complex systems making them unrealistic in some cases elshafei et al 2014 increasingly the development of holistic environmental and hydrological models that appropriately capture nonlinear relationships between complex environmental and socioeconomic systems is gaining attention for example system dynamics sd forrester 1961 modelling is a useful tool to express nonlinear relationships between complex socioeconomic and environmental systems dyson and chang 2005 herrero et al 2014 prodanovic and simonovic 2007 it is a useful tool for modelling socioeconomic processes as it allows for holistic assessments this is due in part to its intuitiveness and capacity for integrating various viewpoints disciplines and processes kelly et al 2013 winz et al 2009 the utility of sd has been shown in water resources modelling and management ahmad and simonovic 2004 butler and adamowski 2015 hassanzadeh et al 2012 madani and mariño 2009 sahin et al 2015 and in policy analysis sustainable development and natural resource management dai et al 2013 hare et al 2003 prodanovic and simonovic 2007 sendzimir et al 2007 in particular sd has been used to link socioeconomic and hydrological models into one platform cockerill et al 2006 langsdale et al 2009 sušnik et al 2012 tight coupling of socioeconomic sd models and physically based environmental models dcsem into one platform e g tinamït malard et al 2017 allows for the simulation of interdependent factors through dynamic feedbacks between socioeconomic and physical processes offering a more holistic approach to environmental management butler and adamowski 2015 inam et al 2015 2017a however the dcsem modelling process relies on hypotheses associated with assumptions of model structures model inputs model parameter values and varied dynamic behaviour patterns elicited from the sd segment of the simulation results sd modelling is behaviour pattern oriented barlas 1989 drogoul et al 2016 hekimoğlu and barlas 2016 these hypotheses contribute to issues such as over parameterization interactions between a large number of parameters due to the high nonlinearity of model equations and moreover the fact that the model parameters are not uniquely identifiable due to the interactions nonlinearity between parameters gan et al 2014 thus dcsem parameters suffer from high levels of uncertainty which may yield unreliable simulation results sensitivity analysis sa is an approach used to investigate how uncertainty in model outputs can be apportioned to different sources of uncertainty in model parameters saltelli et al 2004 sa helps reduce the number of parameters while maintaining the reliability of model simulations working with fewer parameters reduces resource expenditure on parameter calibration a process that can be challenging in the context of limited data gan et al 2014 but is required for the successful application of coupled models e g dcsems 1 2 global sensitivity analysis features sa approaches can be categorized as either local sensitivity analysis lsa or global sensitivity analysis gsa methods lsa is a deterministic approach that considers how a small perturbation of a given input value influences the value of the output iooss and saltelli 2017 morio 2011 it does not identify interacting factors however a gsa provides information about how the model outputs are influenced by input variation over a full parameter space within a defined range homma and saltelli 1996 saltelli et al 2004 as gsas focus on the integrated model system as a whole they are particularly suited for dcsems gsas can be further classified into two groups the first being screening based methods qualitative methods that aim to screen out a subset of non influential parameters using a small number of simulations intuitively representing the relative sensitivity of parameters the second group is variance based gsa methods quantitative methods that measure the impact of each parameter on the total variance of model output and usually require a large number of model simulations campolongo et al 2011 gan et al 2014 screening based qualitative gsa methods include morris campolongo and cariboni 2007 morris 1991 latin hypercube one factor at a time lh oat van griensven et al 2006 supersaturated design lin 1993 screening by groups dean and lewis 2006 sequential bifurcation bettonvil and kleijnen 1997 and factorial fractional design montgomery 2017 the morris method allows for the processing of a large number of model inputs 20 inputs iooss and lemaître 2015 and nonlinear input output relationships which are characteristic of dcsems morris is the preferred method for input space exploration as random sampling occurs over a grid rather than at the starting points of trajectories as in lh oat variance based quantitative methods include monte carlo mc sampling based on sobol as well as an extended version based on quasi mc sampling saltelli et al 2010 sobol 1993 and the fourier amplitude sensitivity test fast and its extended version efast cukier et al 1978 saltelli et al 1999 efast has multiple uses and is widely applied in the field of environmental and water dynamics modelling e g mannina and cosenza 2015 mannina et al 2018 cosenza et al 2014 efast outperforms fast when used with spatially distributed models such as dcsems because parameter interactions cannot be detected by fast but are noted by efast saltelli et al 2010 1 3 behaviour pattern lsa and gsa procedures on sd and coupled models sd models are behaviour pattern oriented and are characterized as insensitive to most inputs due to the nature of feedback loops barlas 1989 barlas 1996 forrester 1961 thus a conventional numerical procedure wherein the sensitivity of point values in time is analyzed for output variables is not really suitable for sd models even so the majority of previous sd studies applied lsa methods using a conventional numerical lsa procedure e g forrester 1983 gonçalves 2009 güneralp 2006 kampmann and oliva 2008 saleh et al 2010 wang et al 2012 wei et al 2012 these quantitative lsa practices for sd models are only suitable for linear models or models wherein the uncertainty ranges of input parameters are small cariboni et al 2007 other attempts have been made to apply a numerical gsa procedure to sd models for example yehiaa et al 2014 applied a computationally intensive quantitative gsa method to a simple hypothetical sd model while inam et al 2017b c developed an integrated model that coupled a group built sd model gbsdm and a physically based environmental model sahysmod in the latter study the gsa was conducted only for the physical portion of the coupled model using the winglue application through the kolmogorov smirnov two sample test spear and hornberger 1980 and was not applied to the sd component of the coupled model although the behaviour pattern based procedure is more difficult to implement than the numerical procedure many efforts have been made to analyze the sensitivity of output behaviour patterns to input parameters in sd models the application of behaviour pattern based procedures has rarely been explicitly examined with physically based models sd studies by barlas and kanar 1999 yücel and barlas 2011 and sücüllü and yücel 2014 defined and used behaviour patterns for calibrating and testing sd models such sd studies quantified changes in output behaviour patterns behaviour pattern based procedure instead of point to point output values numerical based procedure however most of the sd studies applied behaviour pattern based procedures with lsa methods under the assumption of a fixed or single behaviour pattern of model outputs ford and flynn 2005 moizer et al 2001 ozbas et al 2008 given the dynamic nature of sd models especially when simulating a complex dynamic system the assumption of a single behaviour pattern of model outputs may not be appropriate the output behaviour pattern may change from one model simulation to another e g the behaviour pattern changes from linear growth to exponential growth between two model simulations hekimoğlu 2010 and hekimoğlu and barlas 2010 2016 were the first to develop a gsa procedure for sd models which considered multiple behaviour patterns in simulations these studies advanced the application of gsa to sd models by considering multiple behaviour patterns in simulation results however manual or visual procedures for checking simulation behaviours in the gsa process are unfeasible for a single physical sd model with many parameters especially for a dcsem which simulates a complex dynamic system some attempts have been made in previous studies to facilitate dynamic pattern behaviour mode recognition with software barlas et al 1997 boğ and barlas 2005 sücüllü and yücel 2014 in behaviour pattern based procedures however to the best of the authors knowledge no studies have yet implemented the behaviour pattern gsa procedure using automated software or tools with a dcsem automated tools combining quantitative qualitative gsa methods with a behaviour pattern based procedure are needed for this type of behaviour pattern recognition especially for use in coupled models simulating integrated dynamic systems of interactions between socioeconomic and physical processes as well as input parameters building on the studies discussed above the current study addresses issues related to lsa application non automated gsa procedures and the biased assumption of behaviour pattern s of model outputs for behaviour oriented models with many interacting parameters the proposed behaviour pattern gsa procedure using two gsa methods i e morris and efast allows for automated selection of the most appropriate behaviour pattern for each model simulation output without empirical biases this study is the first of its kind to develop an automated behaviour pattern gsa procedure for dcsems the current study explores the behaviour of both morris and efast as screening based qualitative and variance based quantitative methods respectively coupled with the gsa procedures mentioned above there is not much research on the application of gsa methods to a model that simulates integrated dynamic systems the current study aims to address this by developing an automated behaviour pattern gsa procedure a numerical gsa procedure as well as the developed behaviour pattern gsa procedure are applied to a dcsem and their performances are compared the behaviour pattern gsa procedure includes 1 automatic behaviour pattern recognition of model simulation results in conjunction with software developed by the authors i e tinamït malard et al 2017 through the addition of automatic pattern detection functions 2 goodness of fit gof calculations between the detected behaviour patterns and the simulation results and 3 application of gsa methods to the gof values and behaviour pattern parameters of the detected behaviour patterns for the dcsem to the best of the authors knowledge this is the first time that the gsa method has been used to determine the influence of model input parameters on the gof values of the detected behaviour patterns this represents how well detected behaviour patterns fit the model simulation results i e whether or not a pattern is sensitive to a parameter in addition the unique features of the automatic behaviour pattern recognition process allow for the application of the proposed gsa procedure to dcsems with multiple output behaviour patterns two gsa methods qualitative screening based morris and quantitative variance based efast using two gsa procedures a behaviour pattern and a numerical gsa procedure are investigated to determine 1 which gsa method morris or efast is more suitable for each gsa procedure and 2 which gsa procedure the behaviour pattern or numerical procedure coupled with its best suited gsa method is the most appropriate combination for a dcsem the proposed behaviour pattern gsa procedure is tested in the rechna doab basin in pakistan via the tinamït model coupling tool previously developed by the authors malard et al 2017 the results of the proposed behaviour pattern gsa method provide insights into different characteristics of output behaviour patterns readers should note that the terms gsa methods and gsa procedures are not synonymous gsa methods refer to the global sensitivity analysis methods or algorithms e g morris and efast used for parameter sampling and calculating parameter sensitivity indices a measure of parameter importance gsa methods are implemented using gsa procedures either numerical or behaviour pattern procedures a description of the proposed stepwise behaviour pattern gsa procedure is provided in the following sections 2 case study this section describes the application of the conventional numerical gsa and the developed behaviour pattern gsa procedures on a dcsem in this case the coupled p gbsdm previously developed by the authors in inam et al 2017b c which links a physically based p spatial agro hydro salinity model sahysmod oosterbaan 1995 with a group built system dynamics model gbsdm sahysmod simulates the physical processes whereas gbsdm simulates the socioeconomic processes the coupled p gbsdm simulates socioeconomic and environmental interactions through feedback loops sahysmod considers internal boundary conditions at a polygonal scale using a nodal network of rectangular polygonal configurations to define spatial variation in cropping irrigation drainage and groundwater in the study area the study area was divided into 215 polygons each polygon is 2 1 2 1 km in size the year 1989 was used as the base year for a 10 year 20 season simulation of water table depth from the winter of 1989 to the summer of 1999 a year was divided into two seasons with equal six month durations i e winter from november to april and summer from may to october for further details on the p gbsdm please refer to inam et al 2017b c the code used to run the two procedures on the p gbsdm through the tinamït malard et al 2017 tool can be found in appendix a the morris and efast methods were implemented through the salib 1 1 0 python package herman and usher 2017 2 1 study area data and parameters the study area is located in a semi arid region of rechna doab pakistan for more information about the study area data sources and data collection see inam et al 2017a an accurate simulation of water table depth fluctuations required knowledge of some physical hydrological factors e g hydraulic conductivity kaq for recharging and socioeconomic factors e g capacity per tubewell ctw for discharging to simulate a dynamic equilibrium in the area jehangir et al 2002 physical parameters affect the recharge rate in groundwater modelling and are often estimated based on soil characteristics corresponding to different land uses or soil types lin et al 2009 four different textural soil groups identified by their local names and characteristics are listed in table 1 inam et al 2017a khan et al 2003 due to the spatial variability of soil type within the study area for the polygon wherever more than one soil type was present the dominant soil type with the highest composition within the polygon was assumed to be homogeneously distributed across the polygon the special nodal network relationship between polygons which specifies neighbourhood effects in the study area represented the interchangeable hydrological processes across boundaries and between polygons see fig 1 the hydrological parameter kaq was computed for each polygon s node based on the average kaq for that node and that of its neighbour for each polygon four unique kaq values representing the four nodes were generated to account for the neighbourhood effect in contrast to a variable that shows actual measurements or attributes changing over time a parameter is an element of a system that can be altered to identify and evaluate a system s performance for example the performance of an aquifer system e g fluctuation of groundwater table depth as a variable depends on aspects such as the sensitivity of soil characteristics e g hydraulic conductivity if the system s performance is assessed by changing the characteristics and influential factors of the system then these factors e g hydraulic conductivity are considered as parameters rather than using the observed values in this study twenty three input parameters table 2 consisting of physical and socioeconomic parameters were selected for the p gbsdm based on the experience of the authors with the previous development of the p gbsdm to investigate the changes in water table depth in the study area physically based hydrological parameters denoted as p in table 2 included saturated hydraulic conductivity kaq total porosity of the aquifer zone ptq total porosity of the root zone ptr effective porosity of the aquifer zone peq and effective porosity of the transition zone pex the ranges for these specific parameters were taken from inam et al 2017a combining these five physical parameters with the four soil types led to a total of 20 soil hydrological parameters the three sd based socioeconomic parameters used denoted as sd in table 2 included yearly capacity per tubewell ctw and two tubewell potential operating hours poh poh winter november april and poh summer may october inam et al 2017a found groundwater extraction gw as a storage efficiency parameter to be highly sensitive in the sahysmod model in the current study gw was not considered directly as an input parameter but was instead indirectly addressed through its dependent socioeconomic parameters i e ctw poh summer poh winter which addressed the issue of gw sensitivity in this study a dummy parameter ranging from 0 to 1 was added to the parameters a total of 24 parameters consisting of 23 selected model input parameters plus one dummy parameter and applied to the sampling and analysis methods for morris and efast to validate the effectiveness of the selected screening threshold all the parameter ranges and values including the dummy parameter are shown in table 2 morris and efast were applied to the 24 parameters for the 10 year 20 season time period for the morris method 625 model simulations were adopted and for efast 120 000 model simulations were applied refer to section 3 1 for details about sample size water table depth was used as an output variable to calculate sensitivity indices of the 24 model input parameters a detailed analysis of the results of the application of the morris and efast methods with the two procedures behaviour pattern and numerical as well as their comparison and graphical representations are provided in section 4 3 methods for each distributed subarea the conventional numerical gsa procedure analyzes the model output of numerical points and the behaviour pattern gsa procedure automatically analyzes the behaviour patterns of the model outputs this study used polygons to represent distributed subareas of the dcsem at different points in time seasonal based on a pre defined time series defined by the users thus in order to compare the suitability of a numerical gsa procedure and the developed behaviour pattern gsa procedure the numerical and behaviour pattern gsa procedures were performed on a polygonal basis and summarized in the five sections steps shown in fig 2 section 3 1 includes the set up of model parameters and definition of their allowable ranges as well as details of the determination of the number of simulations needed for the application of the morris and efast methods section 3 2 describes the model sensitivity simulation sections 3 3 and 3 4 describe the two output processes of the sensitivity simulation results conducted separately using the morris and efast methods specifically section 3 3 defines the numerical point based output process involving the selection of six output measures which included five points in time and the calculated mean value of the time series for each of the simulation results section 3 4 outlines the behaviour pattern based output process which detected output behaviour patterns e g linear exponential oscillation followed by the gof calculation and behaviour pattern parameter e g slope intercept values collection for each of the detected behaviour patterns section 3 5 describes the calculation of sensitivity indices for each input parameter for each of the six point based output measures section 3 3 as well as behaviour pattern based output measures section 3 4 lastly the parameters were ranked based on the chosen maximum sensitivity index of all polygons for each parameter for each of the output measures 3 1 sampling strategy and sample size the number of simulations for the gsa application is directly dependent on the number of parameters both socioeconomic and physical hydrological parameters are required as these represent the system dynamics and physical components respectively in the dcsem sensitivity analysis see section 2 1 for details sections 3 1 1 and 3 1 2 establish the number of simulations needed for the application of the morris and efast methods 3 1 1 morris morris 1991 is a qualitative screening gsa method in which the final sensitivity measures are calculated by averaging the elementary effects e e of each input factor parameter on model outputs e e is calculated by changing one parameter at a time oat by the amount δ between subsequent model simulations where the δ value is between 1 p 1 1 1 p 1 and p is the number of predetermined levels the range of each parameter is portioned into p levels where each parameter samples from these p levels thus the vector of k parameters x 1 x k is sampled from a hyperspace of a k dimensional p level grid for each parameter the ee calculation is repeated n times at different points in the parameter space and a mean of the absolute values for the n e e s are calculated campolongo and cariboni 2007 and taken as the measure of sensitivity i e sensitivity indices sensitivity indices measure parameter sensitivity as the variability induced in parameter sets the greater the value of a sensitivity index the larger the influence of that parameter on the dependent variable a screening threshold morris sensitivity index is 0 1 cosenza et al 2013 vanrolleghem et al 2015 was applied here to separate the influential and non influential parameters the morris method was applied to all 24 parameters used in this study 23 selected model input parameters as well as one dummy parameter previous studies campolongo and cariboni 2007 morris 1991 saltelli et al 2000 calculated the sample size n for morris based on the number of k parameters as shown in eq 3 1 3 1 n n k 1 where n is usually between 5 and 15 morris 1991 vanuytrecht et al 2014 selected 47 and 43 parameters in their sensitivity study and indicated that n 25 was sufficient to distinguish between important and non influential parameters the p level does not affect the sample sizes but determines the sample ranges gan et al 2014 tested different combinations of p levels p 4 8 16 and 32 and n base sample sizes n 5 10 20 30 they found that results are not stable under different combinations and therefore recommended using p 16 or 32 and n 20 for the morris method to reach screening convergence i e the sample size for which no significant change in identification of the non influential input factors occurred thus for the purpose of identifying important for ranking and non influential for screening parameters due to the concern for computational feasibility of a large and complex dcsem a combination of p 16 levels and n 25 for the 24 parameters was applied resulting in a total sample size of 625 this was calculated via eq 3 1 and applied in the present study 3 1 2 efast efast is a quantitative gsa method that decomposes the total variance of the simulation results into fractions which can be attributed to individual inputs or sets of input values cukier et al 1978 saltelli et al 1999 the most widely used sensitivity measure of efast is the first order effect called the efast sensitivity index in the current study of the individual parameters it measures how individual parameters contribute to the total output variance the parameters are ranked based on their first order effect values with higher ranked parameters having a greater influence on the model output a screening threshold efast sensitivity index 0 01 cosenza et al 2014 sin et al 2011 vanrolleghem et al 2015 was applied in this study variance based gsa methods tend to be computationally expensive i e the simulation time required for the morris and efast methods is substantial when using a large number of parameters k zhang et al 2015 similar to the approach used with the morris method the total sample size for efast was determined by a base sample size n typically between 500 and 1000 and the number of parameters k pianosi et al 2016 saltelli et al 2010 saltelli et al 2005 for a complex model with a large number of input parameters e g 20 parameters a minimum of 10 000 model simulations are required for variance based methods however different studies recommend different sample sizes saltelli et al 2000 indicated that the smallest sample size for efast indices should be 65 k whereas vanrolleghem et al 2015 applied efast with n 5000 and 17 parameters leading to n k 85 000 simulations in studying the fast efast method pianosi et al 2016 observed that when the number of parameters nears 50 approximately 100 000 model simulations are required to reach sensitivity index convergence thus in the case of the 24 model parameters used in the current study sample size sets of more than 100 000 were considered to achieve an adequate estimation of sensitivity indices in the current study the sample size for efast was based on the results of eq 3 2 vanrolleghem et al 2015 thus given a base sample size of n 5000 and k 24 a total sample size of 120 000 was applied 3 2 n n k morris and efast were applied under the assumption of uniform distribution for all 24 input parameters the distributions of all input parameters were independent of each other the ranges of values of the 24 parameters are presented in table 2 it should be noted that the parameter sample size greatly affects the convergence of parameter sensitivity indices for sa wang et al 2013 in other words there is an increased tendency for sa indices to converge with increasing sample size which in turn is directly dependent on the number of parameters although a larger sample size might yield more reliable parameter sensitivity indices gsa users should still consider an appropriate compromise between the method s computational feasibility and accuracy 3 2 model simulation the following model simulation procedure was performed once for each of the morris 625 samples and efast 120 000 samples methods with the time unit of simulation being a season 6 months and the time frame of simulation moving from the winter of 1989 to the summer of 1999 10 years or 20 seasons the model simulation results from morris and efast were subsequently passed through the point based and behaviour pattern based output processes separately due to differences in the numerical and behaviour gsa procedures two output processes one for output point values section 3 3 and another for output behaviour patterns section 3 4 were applied to the morris and efast simulation results for each gsa procedure 3 3 conventional numerical point based output process this study used a 20 season time series for the dcsem inam et al 2017b c of the 20 season time series five seasons 1 5 10 15 and 20 were selected to be used in the numerical gsa procedure these five seasons including their starting and ending points displayed a regular distribution within the pre defined time frame this represents the time varying characteristics of the output variable the selection of five seasons also offered improved computational feasibility for the subsequent calculation of sensitivity indices this reduced the computation of a sensitivity index for each model parameter from 20 points to 5 points and simplified subsequent calculations in addition the mean value of the time series was calculated as a representative estimation of one set of simulation results thus the six output measures consisted of the five selected seasons and the mean value of the time series in the numerical point based output process these were collected in preparation for computing sensitivity indices for the morris and efast methods in section 3 5 3 4 behaviour pattern based output process 3 4 1 fitting linear functions each simulation result 20 seasons per result set was fitted into a linear behaviour pattern the slope of the linear function offers general information on trends in growth and decline for that set of simulation results even if the behaviour pattern of that set does not completely manifest as a linear trend thus slope and intercept as two output measures from the simulation results of all polygons were collected for the calculation of parameter sensitivity indices shown in mathematical description of step 1 3 4 2 fitting behaviour pattern functions this section describes the behaviour pattern based output process which consisted of three steps in step 1 each set of simulation results was fit to 21 possible behaviour pattern functions consisting of seven basic regression functions linear exponential inverse logistic logarithmic oscillation basic sine wave function and dynamic oscillation damped and divergent oscillations listed in table 3 and 14 advanced superposition functions these 21 functions were fit to each set of the simulation results described in processes 1 and 2 of step 1 in step 2 the corresponding g o f j j 1 2 20 was calculated for the 21 previously fitted functions and the one with the optimal gof value was selected as the best fit behaviour pattern for that set of simulation results in step 3 the best fit behaviour patterns were collected for all simulation results for one polygon these three steps were repeated for each of the polygons i e iterated 215 times for the 215 polygons in this study finally the best fit behaviour patterns for each polygon after all simulation runs n were collected in preparation for the morris and efast sensitivity analyses described in section 3 5 these steps are explained in further detail below step 1 process 1 each set of simulation results was fit to the seven basic regression functions listed in table 3 to detect the corresponding behaviour pattern parameters marked as behaviour pattern parameters in table 3 the dependent variable t in the function equations in table 3 corresponds to the points in time along the horizontal axis and f t is one set of fitted data obtained by using standardized model simulation results to fit each of the seven basic functions standardization eq 3 3 of simulation results facilitated the behaviour pattern recognition process even if simulation results were presented at different scales by avoiding inaccurate behaviour pattern recognition due to outlying points in the simulation results in this study all simulation results were standardized using their means and standard deviations as shown in eq 3 3 before being fit to behaviour patterns the same means and standard deviations from the non standardized simulation results were used to properly de standardize the standardized results after fitting 3 3 f standardize t y y σ y where y is the non standardized model simulation result which ranges from 1 to the pre defined time series and y is the average value of y the 14 additional superposition functions were generated by combining the last two oscillation functions oscillation and dynamic oscillation in table 3 with each of the seven basic behaviour patterns this was done because nonlinear dynamic systems usually elicit output behaviours with complex versions of oscillations sterman 2000 process 2 the 14 additional superposition functions were computed by first calculating seven sets of residuals by subtracting the seven previously generated basic behaviour pattern functions from process 1 from each set of model simulation results the seven subtracted residuals were fit to both the oscillation and dynamic oscillation functions to generate two residual functions an oscillation residual function and a dynamic oscillation residual function finally two new superposition functions were generated by taking the sum of each of the seven basic pattern functions and their two respective residual functions thus for each of the seven basic behaviour pattern functions three functions the basic function itself plus two superposition functions were returned a total of 21 behaviour pattern functions were generated for one set of model simulation results from processes 1 and 2 mathematical description of step 1 process 1 1 over a 20 season time series t t i i 1 2 20 one set of model simulation results y was obtained from the total number of model simulations n standardization of y generated s using eq 3 3 3 4 s y y σ y 2 s and t were then fit to each of the seven basic functions f t table 3 in order to detect the behaviour pattern parameters of the seven functions of the s a new set of values u was calculated using the detected behaviour pattern parameters and t of f t process 2 3 the differences between the sets of simulation results y and u were calculated to generate a set of residuals r via subtraction 3 5 r s u 4 standardization of r generated w 3 6 w r r σ r 5 w and t were fit to the oscillation and dynamic oscillation functions presented in table 3 to detect their corresponding behaviour pattern parameters to generate two residual functions the oscillation residual function f 2 t with a 2 b 2 c 2 and c o n s t a n t 2 parameters fit f 2 w t and the dynamic oscillation residual function f 3 t with a 3 b 3 c 3 d 3 and c o n s t a n t 3 parameters fit f 3 w t 3 7 f 2 t a 2 s i n b 2 t c 2 c o n s t a n t 2 3 8 f 3 t e a 3 t b 3 s i n c 3 t d 3 c o n s t a n t 3 6 two new superposition functions of the seven basic patterns were calculated by taking the sum of f t and the two de standardized residual functions thus three functions were generated from a single basic function f t f t f 2 t and f t f 3 t 3 9 f t f 2 t f t a 2 s i n b 2 t c 2 c o n s t a n t 3 10 f t f 3 t f t e a 3 t b 3 s i n c 3 t d 3 c o n s t a n t step 2 the second step aimed to identify the best fit behaviour pattern for each set of model simulation results from the 21 functions generated in the previous processes by investigating the regression relationship between each set of simulation values and the 21 generated functions most commonly used gof regression analysis criteria e g r squared root mean squared error rmse residual standard error rse and mean absolute error mae are sensitive to the inclusion of additional parameters behaviour pattern parameters in a model fitted output behaviour patterns in addition a more complex output behaviour pattern often has a higher number of behaviour pattern parameters that is including additional model parameters might change the values of those criteria e g increase the r squared and reduce the rmse kassambara 2018 appropriate model selection criteria for the identification of the best fit behaviour pattern for a model must balance fitted error and model complexity the definition of a suitable selection method is based on the number of behaviour pattern parameters in a function the higher the number of behaviour pattern parameters the higher the complexity of the function the appropriate choice of a fitness function reduces the chance of model overfitting akhil and kang 2013 thus appropriate model selection criteria contain a mechanism to adjust the classical regression analysis gof criteria in terms of the number of variables in the model to account for overfitting some popular fitness functions that meet these requirements include akaike information criteria regression aicr akaike 1973 schwarz 2011 bayesian information criterion bic schwarz 1978 structural risk minimization srm vapnik 1998 predicted residual error sum of squares press barron 1984 and final prediction error fpe model residuals are also important in regression analysis and model selection cucker and zhou 2007 prins 2013 if a model correctly fits the data the residuals which represent the statistical relationship between the explanatory variables and the response variable appear to behave randomly tan et al 2014 the maximal information coefficient mic reshef et al 2011 is a measure of dependency between the residuals and the explanatory variables in the current study six fitness functions aicr bic srm press fpe and mic were employed to identify the simplest model that adequately explained the hydrologic prediction schoups et al 2018 the fitness functions assess the quality of each fit between each set of model simulated results and the 21 generated behaviour pattern functions after the first two steps the behaviour pattern based output process was completed for one set of sensitivity simulation results the same process was replicated for all sets of simulation results the performance of each fitness function was evaluated by 1 statistical analysis comparison results presented in table b3 and 2 visualized presentation of the best fit behaviour selected by each fitness function and the model simulations as shown in fig 6 these fitness functions were applied on the morris simulation results their equations are shown in eq b 1 to eq b 4 all six model selection criteria provided similar outputs for the morris simulation results given the high computational cost associated with efast implementation only aicr shown in eq 3 11 was used in efast simulation akaike 1973 schwarz 2011 3 11 aicr n l o g sse n 2 k where k is the number of behaviour pattern parameters in the function sse is the sum of squared errors between the model simulation and each of the 21 fitted functions and n is the length of the predetermined time series i e the 20 season time series used in this study the pattern with the lowest value of aicr bic srm press and fpe or the highest value of mic was considered the best candidate for describing the behaviour pattern of this set of simulation results and was carried forward to step 3 for further analysis to limit the length of the remaining subsections of section 3 only aicr subsections only aicr analysis results are discussed the morris simulation results as assessed by the other fitness functions are available upon request step 3 each polygon was simulated n times in the first two steps each simulation result was iterated through until n instances of behaviour pattern recognition were completed for one polygon one polygon through n instances of behaviour pattern recognition may generate 1 to 21 different best fit behaviour patterns denoted as b b 1 21 all detected best fit patterns from all n runs were recorded for each polygon to prepare for the morris and efast sensitivity analysis in other words once a pattern had been detected as the best fit behaviour pattern in one instance of behaviour pattern recognition this pattern was passed to morris and efast where the parameter sensitivity of corresponding behaviour pattern parameters and aicr values were calculated after repeating the above three steps for p polygons the total number of best fit behaviour patterns for p polygons was found to be p n b a total of p n 9 b 9 were detected in this study for both the morris and efast simulation results in the next step the output measures of b best fit behaviour patterns were collected namely the behaviour pattern parameters and aicr values which yielded a total of 47 behaviour pattern p n b based output measures including linear output measures such as slope and intercept a total of 53 output measures were collected from both the numerical point based and behaviour pattern based output processes with six from the numerical procedure and 47 from the behaviour pattern procedure all 53 output measures were used in computing the sensitivity indices for the morris and efast methods in section 3 1 3 5 calculation of sensitivity indices of parameters in relation to the output measures in this part of the study the morris and efast methods were implemented to compute the sensitivity indices of input parameters in relation to each output measure for all polygons the results of the parameter sensitivity rankings and subsequent identification of important and non influential parameters for different output measures were assessed based on the sensitivity indices the important parameters were identified using the morris and efast screening thresholds greater than 0 1 for morris and greater than 0 01 for efast the maximum sensitivity index of each parameter to each of the output measures from all polygons was chosen to create parameter sensitivity rankings and screening maps specifically for each input parameter sensitivity indices for all output measures 53 in p polygons were generated a given parameter and output measure would then have p different sensitivity indices then the maximum sensitivity index of those p different sensitivity indices was selected to represent that parameter for each specific output measure when plotting the final ranking map the two output processes in the two gsa procedures described above can automatically calculate parameter sensitivity in relation to the output measures of all polygons through tinamït the proposed methodology in the current manuscript supports the investigation of how the behaviour pattern of the model output is affected by input parameters in order to compare the large number of output measures from the two gsa procedures and analyze the parameter sensitivity rankings an agglomerative hierarchical clustering algorithm müllner 2011 was applied to the parameter rankings for all 53 output measures hierarchical clustering was chosen as it does not require a specific number of clusters the agglomerative hierarchical clustering algorithm creates dendrogram plots for all output measures 53 identifying each cluster and the distance between the centroids of the clusters the results of parameter rankings of all output measures were analyzed to support the selection of a suitable number of clusters for the morris and efast methods and the appropriate output measures for the two gsa procedures the clustering algorithm categorized similar ranked output measures into one group the criteria for selecting the most suitable output measure s from each group was based on the complexity of applying output measures to the dcsem thus the implementation complexity was ranked from the least to most complex as follows implementing output measures from the numerical point based output process aicr for basic behaviour patterns aicr for superposition behaviour patterns behaviour pattern parameters for basic behaviour patterns and behaviour pattern parameters for superposition basic behaviour patterns 4 results and discussion computational cost is associated with the number of model simulations required for the 24 parameters in the p gbsdm morris with 625 simulations completed its simulation within two hours whereas efast with 120 000 simulations took 15 days of parallel multi processing seven threads windows 10 os 32 gb ram i7 series intel processor via tinamït this suggests that when the number of parameters is large 20 parameters the variance based quantitative method efast is not feasible for calculating sensitivity indices for complex models due to computational limitations in these cases morris the screening based qualitative method is recommended results from both morris and efast and the two gsa procedures are presented in fig 3 the value of the dummy parameter for all output measures was 0 non influential in both the morris and efast results which added to the confidence of the gsa methods used the results of the numerical gsa procedure the behaviour pattern gsa procedure as well as a comparison of the two are described in the following sections 4 1 conventional numerical gsa procedure results the numerical output measures from the numerical point based output process for the five selected seasons n1 to n5 and at the mean n6 of the time series for both the morris and efast methods are summarized in the n part of fig 3 see also group 4 in fig 4 table b1 for morris and see group 1 in fig 5 table b2 for efast clustering results the parameter ranking results using morris and efast showed that the same parameters ptq ptr and the dummy parameters were detected as non influential for all six output measures fig 3 the top ranking parameters were a discharging factor from the gbdsm model ctw with the exception of season five n2 for morris and a hydrological recharging factor kaq for efast for numerical output measures generally both methods achieved similar ranking results these results suggest that when simulating groundwater using the coupled model the five points in time and the mean value of water table depth are highly sensitive to changes in kaq and ctw 4 2 behaviour pattern gsa procedure results fig 6 presents the comparison of the six best fit behaviours recognized by the six different model selection criteria and the corresponding model simulation results for six different polygons note that the 90th run of the morris simulation was randomly selected to serve as an example due to limits on the paper length as shown in fig 6 and in the statistical analysis results presented in table b3 the six model selection criteria produced similar outcomes when detecting the best fit behaviours of the model simulations in terms of trend consistency and trend accuracy see table b3 for details given these similarities and constraints on paper length only the results of the aicr criterion are presented in the following sections to demonstrate the analysis process and conclusions the results of the behaviour pattern based gsa procedure assessed using aicr see section 3 4 showed that the same nine behaviour patterns were detected among the 21 behaviour pattern functions for all simulation results using both the morris and efast methods a behaviour pattern function was recorded even if it was only detected once among all simulations these nine distinct behaviour patterns can be linked to the feedback loops and model structures that are characteristic of system dynamics models one component of the dcsem and create distinct behaviour modes for different model runs hekimoğlu and barlas 2010 thus the nine behaviours were separated before calculating the parameter sensitivity rankings to more fully present the different characteristics of the model the nine behaviours included seven basic behaviour pattern functions including the linear function as well as two superposition functions the superposition function of oscillation with the inverse function eq b 5 and the superposition function of dynamic oscillation with the logarithmic function eq b 6 in order to find the most suitable output measures for the p gbsdm the agglomerative hierarchical clustering method was applied to the parameter rankings for all 53 output measures refer to section 3 4 for the hierarchical clustering method applied in this study season one n1 was excluded from the clustering as it was used to initialize the model simulation and no influential parameters had been detected using either the morris or efast methods visual representations of the sa ranking results are presented in the following sections 4 2 1 and 4 2 2 4 2 1 morris results the upper part of fig 3 shows the ranking scheme of the morris method for parameters in terms of their sensitivity to output measures based on the morris clustering results all 53 output measures were categorized into four groups as shown in fig 4 group 1 had only one output measure the behaviour pattern parameter for the superposed dynamic oscillation and the inverse function c1 this pattern was considered an outlier as it is the only pattern in this group group 2 and 3 included aicr output measures for the basic and superposition behaviour patterns the examination of all aicr output measures denoted as a in table 4 for the developed behaviour pattern gsa procedure is recommended as these are more easily applied and simpler compared to the behaviour pattern parameters of the detected behaviours b notations in table 4 group 4 included all the numerical sa results as they achieved a similar ranking see section 4 1 for details the behaviour pattern gsa procedure was found to be more suitable compared to the numerical procedure for dcsem when using morris this is because the behaviour pattern gsa procedure detected more parameters with different ranking orders compared to the numerical gsa procedure ptq ptr and pex were deemed non influential in the numerical gsa procedure but not in the behaviour pattern gsa procedure these results are expected given the nature of the system dynamics sd component of dcsems specifically the behaviour pattern of sd variables here representing different behaviour pattern output measures of simulated water table depth has more impact on the results than the numerical points so the uncertainty of model parameters must be characterized through the analysis of the pattern characteristics of the output variables hekimoğlu and barlas 2016 therefore some characteristics of the output behaviour patterns can only be captured by the behaviour pattern gsa procedure leading to a more diverse parameter ranking order compared to the numerical procedure aicr output measures group 2 and 3 of fig 4 of detected behaviour patterns in the behaviour pattern gsa procedure were especially important as they offered similar screening and ranking results when compared to the remaining behaviour output measures b and c areas in fig 3 with the least implementation complexity in terms of behaviour pattern output measures 4 2 2 efast results the lower section of fig 3 shows the efast results of the ranking parameters in terms of their sensitivity to output measures the rankings were clustered into three groups fig 5 table b2 group 1 included almost all numerical sa results season five n2 t 5 is excluded all screening results were found to be similar see fig 5 for details group 2 included behaviour pattern parameters for the basic and superposition behaviour patterns the simpler output measures meaning the behaviour pattern parameters for the basic behaviour patterns b11 b12 b21 were the most suitable output measures in this group group 3 included aicr for the basic and superposition behaviour patterns as well as the behaviour pattern parameters for the basic and superposition behaviour patterns the simplest numerical point based output measure t 5 n2 was also placed in this group however the aicr for the basic behaviour patterns a1 a2 a3 a4 a5 a6 a7 was more representative of most of the output measures in this group the efast results also indicated that the behaviour pattern gsa procedure is more suitable than the numerical gsa procedure for example using the behaviour pattern gsa procedure the parameter pex was deemed to be significant with medium sensitivity fourth to sixth in rank among the behaviour pattern output measures whereas pex was non influential under the numerical gsa procedure this suggests that the behaviour pattern gsa procedure is more informative compared to the numerical gsa procedure when using efast therefore it is recommended that both aicr and the behaviour pattern parameters of the detected behaviour patterns be used with the efast method to obtain complete ranking and screening information 4 3 comparison of morris and efast despite differences in the top ranking parameter for the aicr output measures area a in fig 3 in the morris ctw and efast kaq methods except a6 a7 both morris and efast achieved similar rankings in general though the bottom ranks of the important parameters differed between the two methods ptq and ptr were deemed important in morris but not in efast the significant influence of ctw and kaq was detected by both methods this is in agreement with the findings of qureshi et al 2003 in their study of the rechna doab basin in pakistan the results of qureshi et al 2003 highlighted the impact of over pumping via tubewells on the falling water table in the region which has been identified as a major concern of private tubewell owners in the area in addition the high sensitivity of kaq to water table depth helped highlight the hydrological characteristics that most affect water table fluctuations in the study area similar findings were found in previous studies e g alizadeh et al 2017 lu and vesselinov 2015 the detected behaviour pattern output measures b c areas in fig 3 consist of three types of output measures first is the linear output measures which are slope and intercept b7 b8 in fig 3 although the parameter sensitivity rankings and screenings for slope and intercept output measures were not completely consistent between morris and efast the top two ranking parameters kaq and ctw were the same additionally the parameter pex was defined as non influential by both the morris and efast methods the second type of output measures are behaviour pattern parameters from seven basic behaviour patterns area b in fig 3 refer to table 3 for the seven basic behaviour patterns the third type of output measures are the behaviour pattern parameters of the superposition functions area c in fig 3 according to areas b c in fig 3 morris exhibited a more scattered top rank compared with efast in other words parameters poh winter poh summer peq ctw and kaq were found to be the top rank with morris whereas kaq peq and ctw were found to be the top rank with efast in the behaviour pattern gsa procedure the efast method achieved more stable rankings not only within but across different groups compared to morris however the screening results differed between the two gsa methods despite their position at the bottom of the ranking scheme most of the output measures of the morris method identified additional important parameters ptq and ptr which were eliminated in all output measures of the efast method although most of the top ranking parameters for both output measures were slightly different kaq or ctw in efast and ctw in morris the top two important parameters kaq and ctw were identified in both gsas this indicated that the balance of water table depth was significantly controlled by recharging kaq and discharging ctw parameters and that groundwater pumping and recharge are the two main forces in the groundwater basin tolley et al 2019 according to inam et al 2017c the important feedback loops of the model evaluated the effect between aquifer recharge and tubewell installation capacity the two gsas i e morris and efast were able to capture the key uncertainty parameters for different output behaviours of the dcsem this resulted in a reduced number of dominant parameters facilitating subsequent model calibration and assisting in hydrological modelling to understand the changes in groundwater hydrology and management in terms of screening results although morris detected two other important parameters i e ptq ptr at the lower end of the ranking positions this may have been due to overestimation it is still worthwhile to include these parameters as they offer further information for identifying important parameters in future model calibrations note that although the ranking and screening results of the two gsa methods for both procedures were similar the computational resources required to complete each procedure differed significantly the strength of the morris method is its computational efficiency as 625 model runs were completed within only two hours the efast method is more complex and computationally expensive the 120 000 model runs took 15 days when comparing the results of the two gsa methods used with the two gsa procedures it can be argued that the morris method coupled with the behaviour pattern gsa procedure is the most suitable combination for dcsems due to its computational feasibility and thorough screening abilities 5 conclusion dcsems e g the p gbsdm used in this study are potentially useful tools to help develop a more holistic understanding of socioeconomic and hydrological interactions to help facilitate more sustainable water resources management dcsems are typically developed to represent behaviour patterns of simulated systems and have a high level of complexity due to model coupling high parameter uncertainty intensive computational requirements and numerous interacting parameters given these challenges the assessment of different procedures to simplify modelling while maintaining model accuracy is important the current study compares the application of a behaviour pattern gsa procedure suitable for use with an sd model with a conventional numerical gsa procedure often used with physically based environmental models to investigate which model components dominate the coupled model output behaviour gsa plays an important role in identifying non influential parameters that have little influence on the outputs of a dcsem either numerical point based or behaviour pattern based and which can thus be excluded from subsequent calibration procedures without compromising the quality of model predictions the automatic gsa procedure presented in this study allows for sampling sensitivity simulation output processing of point based and behaviour pattern based outputs goodness of fit gof calculations and calculation of sensitivity indices for output measures generated from the two output processes the study found that the high sensitivity parameters are those that control pumping ctw and recharge kaq with numerical and behaviour pattern gsa procedures it is suggested that performing sensitivity analysis is important for dcsems with spatially distributed recharge and pumping conditions over a watershed the proposed gsa procedures can help facilitate a better understanding of the drivers of groundwater fluctuations allowing for more sustainable management for example the discharging factor of tubewell installation capacity ctw was shown to significantly affect the contributions of groundwater supplies kaq in the model s groundwater hydrology balance the results of the current study support better water management decisions in the context of heterogeneous soil texture and ambient and pumping conditions in different polygons in this regard the automatic behaviour pattern gsa procedure is well suited to determining the impacts and uncertainties ofdynamic feedbacks between human and natural systems when coupled with holistic modelling frameworks such asdcsems this study is the first of its kind to perform a behaviour pattern gsa procedure with two gsa methods to determine the influence of model input parameters on the gof values e g aicr of the detected behaviours in the absence of prior assumptions of either input parameter distribution or model input output relationships two gsa methods morris or efast were compared to determine which was the most suitable for a dcsem by investigating whether the sensitivity indices for behaviour pattern output measures were different from the numerical point based output measures additionally the study proposed an automatic behaviour pattern recognition method that improves the feasibility of dcsem application with multiple output behaviour patterns a limitation of the current study is that the python package used to detect the shape and perform the automatic behaviour pattern recognition resulted in unconverged behaviour pattern parameter values for some of the behaviour pattern functions e g the logarithmic function it is recommended that future research explore the improvement of these behaviour pattern parameters through the use of alternative optimization algorithms or through optimization parameter adjustment the results of this study showed that compared to the efast method the morris method identified more important parameters parameters that could be important for future model calibrations with higher computational efficiency it is suggested that for greater accuracy the lowest ranked parameter from the morris method could be excluded from future model calibrations under conditions of limited computational resources the current study suggests that the advantage of using the behaviour pattern gsa procedure with a dcsem is that it offers more information on the number of important parameters as well as a variety of ranking orders compared to the numerical gsa procedure the behaviour pattern gsa offers more insights on parameter sensitivity to different characteristics of the output behaviour patterns in addition the output behaviour pattern is more important than numerical points when investigating parameter uncertainty in dcsems the proposed procedure was tested on data from the rechna doab basin in pakistan via the tinamït model coupling tool previously developed by the authors malard et al 2017 it is recommended that researchers and practitioners with limited computational resources who are interested in the behaviour pattern gsa procedure explore the application of aicr alone to each of the best fit behaviour pattern simulation results in addition if one is using the conventional numerical gsa procedure on a dcsem it is suggested that the procedure be applied to all points in the time series as well as to their mean values as the numerical procedure provides different information at each point i e the procedure detects a different number of important parameters and ranking orders at different points in time credit authorship contribution statement xingyu peng writing original draft methodology writing review editing jan adamowski writing review editing supervision azhar inam software data curation mohammad reza alizadeh writing review editing raffaele albano writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by an sshrc insight grant grant number 435 20 17 14 82 held by jan adamowski appendix a software and data availability python the tool is written in the python language and is available under an open source license at https github com gabriellapeng tinamit tree gaby histogram tinamït the tinamït code requires approximately 2 5 mb of disk space and includes multilingual graphical user interface gui support that allows users to translate the gui into the most appropriate language for their stakeholder community full documentation is available at http tinamit readthedocs io appendix b equation and tables b 1 bic s s e n k n s s e n k l o g n b 2 srm s s e n 1 k n k n l o g k n l o g k n 2 n 1 2 1 b 3 press s s e n 1 2 k n b 4 fpe s s e n n k n k b 5 f t superposed ocill i n v e r s e a s i n b t c a 2 t b 2 c o n s t a n t b 6 f t superposed dynamic o c i l l l o g a r i t h m i c e at b s i n c t d a 2 log e t b 2 c o n s t a n t 
5552,although economic and environmental considerations have been well integrated into water resources management the social aspects have been usually neglected quantifying and embedding social attachments in the water resource management models are so challenging in this paper a novel approach is proposed to quantify and consider social attachments for water and wastewater allocation in urban areas in the management of shared resources one of the main issues is the level of cooperation among agents in a multi agent environment stakeholders can decide non aligned or depending on their interests and social attachment have some cooperation and coordination in the decision making process in the proposed approach an effort has been made to take into account the effects of social attachments on agents decisions in this paper social network analysis is applied to evaluate the coordination level between agents in the use of shared water resources a paired physical and behavioral simulation model is developed to assess water and wastewater allocation scenarios a reinforcement learning approach namely q learning is used to develop the behavioral model which is linked with social attachments to evaluate the applicability of the proposed approach the kan river basin in the western part of the tehran metropolitan area is studied by using the proposed approach for a 25 year simulation horizon and 63 water and treated wastewater allocation scenarios it is shown that it has merits to find the best scenarios in different conditions and can enhance the sustainability of the water resources in the study area according to the results improving the social attachments in the study area can reduce the over exploitation of groundwater and improve the groundwater quality keywords reinforcement learning q learning social attachments kan river basin social network analysis 1 introduction since the middle of the 20th century in conjunction with the structural methods nonstructural approaches have been considered to solve water resource management problems mckinney et al 1999 despite the development of engineering technologies and management methods water resources management problems in some areas have not been effectively solved one of the main reasons is the lack of social considerations in the process of management the coevolving relationships of hydrological and social systems are capable of making unforeseen patterns which can induce critical environmental and social issues pouladi et al 2019 in this case facing conflict in water resource management may be unavoidable emami skardi et al 2013 mahjouri and pourmand 2017 the economic objectives can be better addressed than the environmental or social criteria which often are difficult to be defined in quantitative terms mckinney et al 1999 the concept of integrated water resource management iwrm has been proposed to deal with water resource management difficulties considering structural and nonstructural approaches by 2012 more than 80 of the countries had made good progress towards meeting iwrm and yet iwrm as the interesting mission for water resources management issues is under studied smith clausen 2015 to have integrated management developing a behavioral simulation model especially in large scale water resources systems is necessary agent based methods can be utilized to simulate the agents behaviors and evaluation of different water management policies within a system darbandsari et al 2020 to have an integrated model the behavioral simulation model must be combined with the physical simulation model social considerations must also be taken into account to reach a comprehensive integrated model in order to consider social aspects social relations should be quantified the interactions of agents in a social network effect the level of cooperation between them the agents interactions can be entirely cooperative fully competitive or indirectly through the environment of the problem neither cooperative nor competitive besides considering the learning ability of the human agents apt agent based modeling must consider the learning ability of the agents reinforcement learning rl has been accepted as an agent based approach that is developed based on the agents interactions with the environment hence it can be used in a large scale water resource system and inherently can consider the involved uncertainty of the system q learning is a prominent learning technique first proposed by watkins 1989 as a subset of rl q learning is an acceptable agent based approach that can tackle some main difficulties of water resource system modeling rl is developed based on the concept of interaction of learning agents with the environment in the form of states actions and rewards sutton and barto 2018 in the q learning approach the agents can learn from past processes and outcomes thus it is so applicable in repetitive events besides in most large scale systems indirect agents communications bounded rationalities and inability to monitor the total area of the system the relations of the agents can be only defined through the environment in this case q learning which is mainly based on the agents interactions with the environment of the problem is so helpful wilson 1996 firstly used q learning in the design of an urban drainage system castelletti et al 2002 proposed rl based algorithm to design a policy to operate a multi goals reservoir the presented method is used for a part of the water system model catchment area and the rest of the model reservoir is described by mathematical equations based on physical characteristics bhattacharya et al 2003 applied artificial neural networks and rl examined the process of controlling water systems abolpour et al 2007 presented adaptive neural fuzzy reinforcement learning anfrl and studied a water allocation problem in kor and sivand river basin in iran based on the proposed approach in this model a simulation model is considered using the adaptive neuro fuzzy inference system to reduce the errors between outputs and actual data mahootchi et al 2007 proposed a new algorithm called opposition based reinforcement learning obrl as an adapted version of the q learning for reservoir operation castelletti et al 2010 tried to solve the dimension curse in large scale water systems with an approach named fitted q learning although a minority of the water resource problems especially in the large scale systems are mono agent majority studies in the field of water resource management using the rl based approach in single agent form portraying modeling and analyzing a community of agents using a network structure with nodes and links that representing participated agents and their interactions respectively is social network analysis sna therefore graph theory and related evaluations are applied for social modeling with sna in sna the interactions are as important as the role of the agents sna is one of the most important efforts to investigate and quantify some of the main social parameters namely social interactions as water resources are usually involved more than one stakeholder then water resource systems are fertile ground for the application of sna using sna the level of cooperation between the agents can be quantified and considered in the water resource model agents who are participated in formal institutions may not play main roles thus sna could be beneficial for analyzing the role of social interactions that are not understood just by looking at formal institutions that constitute a system yamaki 2017 in this point of view sna can enlighten a water resource system and determine the main agents besides the formal and traditional survey sna can clarify the dark side of a water resource system especially referred to the agents relations a well investigated sna can be used to understand the key agents and the information flow in a system several research applied sna to analyze natural and water resource management sna can be used to study the governance characteristics bodin and crona 2009 ernstson et al 2010 newig et al 2010 stein et al 2011 horning et al 2016 ferrer et al 2018 sna has been applied in several natural resource governance studies schneider et al 2003 dougill et al 2006 bodin et al 2006 lauber et al 2008 bodin and crona 2008 mandarano 2009 haak et al 2017 yamaki 2017 has used sna to better quantify the relations between agents in natural resource management in japan the author declared sna can be applied because of its ability to systematically and quantitatively investigate relationships between agents investigating central stakeholders using sna make it possible to find main involved stakeholders in the governance in this paper a novel approach is proposed to quantify social attachments sa based on sna and incorporate them into water resource management in urban areas sna is applied to quantify the level of coordination among decisions and cooperation level between agents in the use of shared water resources briefly speaking the objectives of the present study are to simulate the behaviors of agents in large scale hydrologic environments and provide an approach to consider social parameters in the decision making process the rest of the paper is prepared as follows in the next section the proposed methodology is described then a brief description of the study area and its main issues are presented in the end the main results of the application of the proposed methodology to the study area and the concluding remarks are presented 2 methodology the proposed methodology is based on studying the main institutions in urban water and wastewater management with an emphasis on considering the social parameters into the modeling process a flowchart of the proposed methodology is presented in fig 1 2 1 system identification the first step in managing water resources is the physical and behavioral recognition of the problem in the following parts the process of system recognition is addressed 2 1 1 physical system identification physical identification of water resources in hydrological environments is mainly based on the identification and modeling of surface and groundwater resources this section presents the modeling process of ground and surface water resources balance based models have been used for physical modeling of the resources and their interactions 2 1 1 1 surface and ground water quantity simulation model the resolution of the physical system identification depends on the needed information for developing the physical simulation model in this paper a water balance method is used for the surface and groundwater simulation the schematic picture of the water balance model is presented in fig 2 the physical model equations are presented in section 8 considering the main characteristics of the study area to evaluate the groundwater level more precisely and regionally the aquifer can be divided into several connected regions where the hydraulic conductivity and specific yield coefficients can be considered locally fig 3 in the groundwater balance model the discharge and recharge in each region and the transfer of water between the regions are the inputs of the model and the status of the aquifer is the output underground water transfer between the local aquifers follows darcy s law 1 q k i a 2 i dh dl where a k i and q are the flow cross section area hydraulic conductivity hydraulic gradient and quantity of water flow respectively dh dl denotes the derivative of water level to length the surface water balance model can be formulated as follows 3 v r o u t i v r i n i rws i di ba i di fa i pe i 4 b i 1 s n a n b i s n a n di mu i di tp i di fa i di wo i re mu i re tp i re fa i re wo i re ba i rwg i pe i where v r o u t i and v r i n i are the volume of water at the downstream and upstream of the river in time step i respectively the volume of the water in the river must be more than the ecological need and then the ecological constraint must be considered in water extracting from the river di ba i di fa i pe i and rws i are the volume of water is provided by the river for gardeners and farmers infiltration of water from the river to groundwater and wastewater inflow to the river in time step i respectively di mu i di tp i di fa i and di wo i respectively denote the demands of green spaces and potable agriculture and industrial water uses in time step i also re mu i re tp i re fa i re wo i and re ba i represent the return flows from municipal potable agricultural industrial and gardens demand nodes in time step i rwg i denotes wastewater recharge to wells in time step i s n is the aquifer s specific yield coefficient a n is the area of the region n and b shows the water table level in the study area which can be evaluated using eq 5 5 b n i 1 s n a n b n i s n a n di t n i re t n i tr n i where b n i 1 is the water table of the region n at the end of the time step i b n i is the water level of the region n at the beginning of the time step i s n is the aquifer s specific yield coefficient a n is the area of the region n di t n i is the total water withdrawal from the aquifer in region n during time step i and re t n i is the total recharge in region n during time step i tr n i is the flow from the region n in time step i due to the transfer of water between different regions which is obtained using eq 1 2 1 1 2 groundwater quality simulation where there is not a wastewater collection network wastewater is usually discharged into the groundwater using absorption wells in this case wastewater would be the main source of groundwater contamination in urban areas the condition is so problematic when the groundwater is simultaneously used as the source of potable water therefore the simulation model should consider both the quantitative and qualitative aspects of surface and groundwater 2 1 1 3 uncertainties of the inputs of the physical model the existence of uncertainties in the structure inputs and parameters of a simulation model can affect the accuracy of the results in this paper the inherent uncertainties of the main hydrologic variables are taken into account by using the historical time series and the correlation coefficients among hydrological variables more details about the uncertainty analysis process are presented in the results section 2 1 2 behavioral identification and simulation model a proper behavioral model should simulate the agents decision making process in large scale systems agents are defined as a part of the system who can affect the environment and consequently be affected by the environment in this paper the agent based model is defined in the form of the overview design and details odd protocol concept grimm et al 2010 darbandsari et al 2020 a human can be considered the learning agent in repetitive problems learning from previous experiences may be the most part of the decision making process many water resources management problems can be considered as repetitive issues hence in this paper the q learning technique as a subset of the rl approach is considered to model the agents behavior in water and treated wastewater allocation in urban areas large scale water resource problems are not fully cooperative or competitive in these systems agents have mainly interactions with the environment and based on the feedbacks of the environment in response to their previous decisions or actions they decide what to do a collection of the learning processes that can be improved over time by getting more information is called rl sutton and barto 2018 rl based approaches are computational methods based on learning by interacting with the environment unlike the observer learning methods i e learning by an external observer the rl based approaches learn by receiving and analyzing the environmental feedbacks sutton and barto 2018 the rl consists of a set of states s a set of feasible actions a and a set of consequences r examination and error based quests and consideration of the rewards of the next steps are two distinctive features of rl sutton and barto 2018 a schematic picture of the rl is demonstrated in figs 4 and 5 in addition to the environment and agents that are the main components of rl the following sub elements are also imperative sutton and barto 2018 policy a map to select an action between a set of possible actions in a particular state reward the immediate feedback from the environment which shows the desirability of the consequence of action for the agent in a state value action function q function this function shows the cumulative reward value for each action in each particular state model used to determine the next step and the reward received the formulation of the q learning method which is used in this paper is as follows ni et al 2014 madani and hooshyar 2014 6 q new s t a t 1 α q old s t a t α r t γ max q s t 1 a where t stands for the time step q old s t a t is the q factor in the previous episode for action a t and state s t of the environment q new s t a t is the q factor in the new episode for action a t and state s t of the environment s t is the state of the environment in time step t and a t is the action in the time step t s t 1 is the state for the next time step due based on choosing action a t α is the learning rate which is between 0 and 1 indicates the importance of the reward function or r t for impact on the value function or q γ is the discount rate which is between 0 and 1 indicates the effect of the decision on the options ahead and the effect of the decision value function on the decision max q s t 1 a is the maximum q factor in the s t 1 mode for all possible actions r t is the value of the instantaneous reward received by the agent for the operation of a t in s t mode in multi agent situations agents decide individually and effect on the environment simultaneously in this case four approaches can be used to simulate the behaviors of the agents using the q learning algorithm in the first approach a q function is defined for all agents in this case the q function is equal to the set of consequences or rewards of all involved agents this system is considered fully collaborative in the second approach each agent can have its own q function besides in the reward function the strategic decisions of other agents are considered in this case the system is fully competitive in the third approach for each agent a separate q function is defined and the agent decides based on the feedback received from the environment this condition is very close to the non cooperative form but as the agents do not consider the decisions of the other agents in their reward functions the process of decision making is not strategic this case is not fully cooperative nor quite competitive in the fourth and more realistic form the third approach is combined with sa to simulate the system in the fourth approach for each agent a q function is defined and the agent decides based on both the received feedback from the environment and his interactions with the other agents in the q learning algorithm the decisions are chosen among decisions actions set 7 a t a t 1 a t 2 a t n where a t is the set of actions in time step t and includes the decision of agents 1 t o n at time t a t i is action of the agent i in time step t the agents decide simultaneously and this can make the simulation process more realistic fig 6 after making a decision and receiving the feedbacks from the environment the agents evaluate their reward functions 8 r t r t 1 r t 2 r t n w h e r e r t is the reward function set at time t and r t i is the reward function for agent number i at time t i f r o m 1 t o n in the proposed multi agent q learning algorithm because of the involved uncertainties and the simultaneous decision making of the agents two similar decisions may not give the same reward values in two different episodes in the traditional q learning approach the action that has the highest value is mostly selected this method is usually used to achieve the best answer as soon as possible but can increase the risk of trapping in locally optimal solutions the proposed approach can be used to give a chance of selection to all decisions the q function in each episode not only represents the reward function in that episode but also includes the information and experiences of the earlier episodes therefore the q function can be considered as the history of the previous rewards considering this fact because of the existing uncertainties in the environment reward of a specific decision in two episodes may be different as the q function is the average of all previous rewards for a specific series of actions it is possible to say that the maximum q function in the last episode incorporates the existing uncertainties in the environment 2 1 2 1 social network analysis sna the sna can be applied to study the level of cooperation in water resource systems luzi et al 2008 showed that sna is a useful tool for defining the cooperation patterns in the nile river basin in this paper sna is applied to investigate the coordination of the decisions among the agents in the use of shared water resources 2 1 2 2 social attachments sa and q learning the majority of the previous studies in the field of water resource management have emphasized on the individual characteristics of agents and the sa and the relations among stakeholders have been usually ignored in the lack of considering social links and interactions amongst agents the simulation of the environment and the agents behaviors is incomplete bazzan et al 2011 tried to incorporate the sa in the q learning method they tried to consider the agents sa using a parameter named τ the q function obtained from the personal activity of the agent named qind was compared with the q function refer to social optimality where the agents choose actions aligned with the total profit of the system parameter τ shows the degree of responsibility sense of participation and even guilty feeling of violation of the agreements however bazzan et al 2011 did not clarify how the sa parameter τ should be evaluated the applied approach to consider sa in the q learning is based on the methodology proposed by bazzan et al 2011 where a parameter denoted by τ represents the level collaboration in the system for achieving social optimality in this paper using the outputs of sna and following the algorithm proposed by bazzan et al 2011 a novel approach is presented to consider sa in the q learning algorithm in this method the value of an individual reward function reward indi is estimated by maximizing the respective agent gain then another reward function based on cooperation in the system and the sa reward socio is estimated the individual or social behavior of each agent is estimated as follows 9 i f 1 τ reward socio reward indi social b e h a v i o r i s s e l e c t e d e l s e individual b e h a v i o r i s s e l e c t e d as previously mentioned sna can be used to study the level of cooperation among agents in a water resource system the estimated level of cooperation can be a basis for determining parameter τ in the q learning algorithm more details are presented in section 7 2 1 3 social choice sc method the borda count social choice method is used to select the best scenario for improving the status of the system bizhani manzar and mahjouri 2013 ghodsi et al 2016 mahjouri and abbasi 2015 available scenarios can be divided into two categories of water allocation and water management scenarios 3 case study the kan river basin is located in the western part of the tehran metropolitan area 7 the main water resources in this area are surface water treated wastewater and groundwater several land uses can be identified in the kan river basin such as residential agricultural recreational and industrial zones and green spaces darbandsari et al 2017 the kan river basin begins from the northern part of the tehran metropolitan and ends to tehran qom old road at the south the eastern and western boundaries are defined perpendicular to equipotential lines of groundwater thus it can be assumed there is no water flow from the western and eastern boundary of the study area fig 7 the kan river basin is a developing urban region with serious water related issues also the kan river basin suffers from policy related concerns about the allocation of treated wastewater ahmadi et al 2019 covering different types of land covers and uses including growing populated districts industrial regions gardens agricultural zones recreational areas as well as the existence of several involved agents and many environmental issues make the kan river basin an interesting case study for the proposed methodology 3 1 kan river basin main agents and state variables system identification is a pre requisite for developing the physical and behavioral simulation models besides water management scenarios must be are determined based on the proposed scenarios and results of the behavioral and physical simulation models the best scenarios are determined using the sc approach the apt scenarios depend on four main factors 1 improving the groundwater quality and quantity conditions 2 supplying all water all demands and 3 increasing the financial income from water allocations 4 causing fewer social problems or considering social security three conceptually different agents are considered in this case study water supply and distribution organizations tehran regional water company trw tehran province water and wastewater company tpww water consumers ministry of industry mine and trade mimt tehran municipality tm ministry of agriculture jahad maj and tehran province water and wastewater company tpww and high level organizations tehran provincial government tpg department of environment doe ministry of health and medical education mhme islamic city council of tehran icct the higher organization are the governing institutions that make some key decisions such as pricing or setting environmental constraints and developing management scenarios the agents and their desires are demonstrated in table 1 the environment includes various entities being classified into two main groups physical and behavioral the state of water resources in the study area during the simulation horizon is defined by the physical environment component including groundwater surface water and wastewater the main water resources and consumptions at the current situation are presented in table 2 3 2 water and wastewater management scenarios to determine the proper water and wastewater management strategies the developed scenarios are considered as the inputs of the simulation model and based on the results the scenarios are ranked using the borda count method the appropriate scenarios can facilitate reaching social optimality and alleviate disputes in the system trw determines the water and wastewater allocation scenarios and the other higher upper organizations regulate the management policies such as the price of the water in the development of the scenarios some fixed constraints must be considered such as providing water for the potable needs trw and tpww are representatively responsible for supplying and distributing drinking water in the study area in the following parts the main water resources and possible management scenarios for each of them are studied 3 2 1 water transfer predominantly the potable water demand of the western part of tehran depends on the water transfer form karaj and taleghan reservoirs as the treatment and transfer cost of transferred water from karaj and taleghan dam is considerable using this water for any other use water is not cost effective 3 2 2 kan river kan river is the longest river in tehran one of the most populated and largest cities in the middle east various consumptions from upstream to downstream of the kan river can be identified the first water users are the gardens near to the upstream of the river then a part of the water is transferred to a manmade recreational lake called chitgar lake farmers are the other users who are directly using the kan river water for their needs in the second and third regions 3 2 3 groundwater resource due to the sizable surface area of the aquifer the unlawful groundwater water use is more feasible than the surface water thus groundwater can be considered as the main source of disputes groundwater can be used for drinking needs irrigation of green spaces industries and agriculture for some needs surface water extraction may be more advantageous i e for agriculture but the inadequate surface water makes the use of the groundwater inevitable groundwater is even an important source of water for urban potable water needs during droughts 3 2 4 wastewater the sewage system has not covered the whole of the study area but the implementation of the sewage system is under study the schedule of the sewage collection system is presented in table 3 by now the wastewater is discharged into the absorption wells after the implementation of the wastewater collection system waste water can be managed like the other water resources and it can be considered as a source for recharging the aquifer two ways to feed the aquifer by the wastewater can be considered firstly discharging the treated wastewater into wells with a high penetration rate and secondly discharging through the river also treated wastewater can be directly used for supplying demands of green spaces agricultural lands and industries 4 uncertainties in available water hydrological data including transferred water from the karaj and taleghan dams available water volume of water stored in the karaj dam at the beginning of the water year plus volume of water entering the dam during the year the kan river flow measured in the solqan hydrometric station flood diversion flow infiltration of the kan river air temperature and precipitation are considered in two conditions in the first case the uncertainties of the hydrological data are not taken into account it is assumed that the hydrological data for the years 1992 to 2016 will be repeated in the years 2017 to 2041 respectively in the latter case annual hydrological data are randomly generated considering the correlations among them therefore a matrix consisting of the variance of each dataset and the covariance between the various data sets is used the generated matrix is a seven by seven matrix because there are seven input hydrological datasets the matrix diameter includes the variance of each data set and other elements includes covariance between different datasets then using the mvnrand command in matlab random hydrological data are generated 5 behavioral simulation model to identify the actions of the players firstly their desires must be determined in this section the main desires and the feasible actions for the agents are studied where the behavioral model is developed based on 5 1 trw trw is responsible for water allocation in this study area three main factors are considered in allocating water as a result the following three criteria are used to rank management scenarios in the borda count method 5 1 1 managing groundwater table fluctuations and supplying water demands the dynamic groundwater volume can be considered as a renewable source for each year in this case a specific water table for each region is determined as the constraint if the water table in the aquifer is higher than the determined water table it is considered suitable to compare various scenarios and rate the quantitative condition of the groundwater the violation from the limitation is considered as a criterion 10 u tw 1 i n 1 3 gw limit n b n i 11 if b n i gw limit n t h e n gw limit n b n i 0 where the u tw 1 i gw limit n and b n i represent the first utility function of the trw in time step i the maximum allowable depth of the groundwater table in region n in m and the aquifer level in region n in m in time step i respectively the utility function of trw for supplying demand is presented as follows 12 u tw 2 i 1 1 6 1 r a t e loss dh t i ah t i 1 r a t e loss dh t i df t i af t i df t i db i ab i db i dw t i aw t i dw t n dg t i ag t i dg t i dl i al i dl i where u tw 2 i represents the second utility of the trw in time step i rate loss denotes the urban water distribution loss rate dh t i is potable water demand and ah t i denotes the total water allocation to the potable demand in time step i df t i db i dw t i dg t i and dl i indicate the total water demands of farmers gardeners industries green spaces and chitgar lake in annual time step i respectively besides af t i ab i aw t i ag t i and al i indicate the allocated water to the demands of farmers gardeners industries green spaces and chitgar lake in time step i respectively 5 1 2 economic desirability of water allocation scenarios trw sells water to different consumers at different prices which has been previously defined by some higher organizations hence financial interest must be defined as one of the main utilities of trw this utility function is defined as 13 u tw 3 i ah d t i p s t p i ah g t i p g t p i ab i p ot i af t i p ot i al i p l i aw g t i p in i aw r t i p rw i ag g t i p otg i ag r t i p rr i this equation calculates the income from the sale of water and wastewater ah d t i and ah g t i indicate the allocation of water from the reservoirs and aquifers for drinking demand in time step i respectively also aw g t i aw r t i ag g t i and ag r t i are the amount all allocation from the aquifer to industry from wastewater to industry from the aquifer to green spaces and from wastewater to green spaces in time step i respectively p s t p p g t p p ot p l i p in i p rw i p otg i and p rr i indicate the selling prices of one cubic meter of surface water to drinking demands sales to the tpww groundwater for drinking water water for agriculture and gardens surface water for chitgar lake groundwater for the industry wastewater for industries groundwater to the green spaces and wastewater for the green spaces in time step i because of the use of the sc approach and its characteristics there is no need to standardize the decision makers utility functions also if the water sales function is standardized the effect of the increase in income is not taken into account and only the approaching of the sales price to the real price is considered the limitation level is evaluated for each aquifer zone regarding the annual aquifer recharge and discharge in the past 25 years the groundwater table depth limitations for regions 1 2 and 3 are considered to be 86 89 and 38 m respectively 5 2 pricing management policies in addition to the water and wastewater allocation scenarios there are some management strategies developed by the higher upper institutions pricing policies for water and electricity can be used to improve the water use efficiency of the agents to evaluate the pricing policies different annual growth rates are considered given the price in the base year for each of the pricing strategies an upper bound is considered in a way that the prices of each year should not exceed this limitation the upper bound limitations for the prices are defined based on the real prices and the inflation rate of the country the benefit of selling wastewater water and electricity are calculated as follows 14 p m i p m 1 1 rate p i p max m i 15 p max m i rate in j p real m 1 1 i n f i where p m i denotes the price of water or electricity for a specific demand from source m in time step i m is to the price of water or electricity for the same need and the same source in the base year p max m i indicates the maximum price of water or electricity to supply the same need from the same source rate p stands for the growth rate of water or electricity price that can vary in different scenarios and rate in j is the profit increase rate of the producer of water or electricity companies p real m 1 represents the real price of the water for the specified consumption from a specific source in the base year and inf indicates the inflation rate in this paper three pricing policies 30 40 and 50 growth rates are considered 5 3 tpww tpww is responsible for treating and distributing water for the population in the region the domestic water demand is mainly dependent on the population of the study area after predicting the population of the study area for the water distribution system tpww tries to minimize the cost of the water supply using the available water resources based on the data provided by the iranian statistical center the population for the simulation period is evaluated using regression analysis besides using an artificial neural network ann the water demand is predicted for the simulation period where the main inputs are the inflation rate average household size average annual household income price of the water and annual hydrological status i e annual available water 5 4 ministry of industry mine and trade mimt kan river basin is one of the most imperative industrial parts of tehran metropolitan the industries are divide into three main agents distributed across the area each on one region of the aquifer the annual water demands for the industries located in different regions of the aquifer are presented in table 5 the main source of water for the industries is groundwater about 40 of the demands of the industries are provided using illegal wells then the main decisions of the industries are to withdraw from illegal wells or not the benefits of producing goods are greatly more than the cost of water purchasing therefore the utility function of the industries mainly depends on the deficit for providing water the reward function of an industrial agent is defined as 16 reward wo n i 1 dw n i aw n i dw n i where dw n i is the need for the industry agent number n n i s 1 2 3 in time step i and aw n i indicates the sum of the water and the wastewater allocated to industry agent number n and the illegal withdrawal from groundwater in time step i 5 4 1 tehran municipality tm chitgar lake and the irrigation of green spaces are two main water demands related to the tehran municipality the required water for chitgar lake is 2 million m3 per year and is provided by the kan river estalaki et al 2016 based on an existing agreement between tm and trw the chitgar lake water demand is guaranteed five districts of tehran metropolitan are located in this study area district no 5 9 18 21 and 22 tm can use illegal wells for the irrigation of green spaces which is estimated to be 40 of its total water demand a potential area green spaces can be estimated based on the population of an urban area the acceptable per capita area of green spaces in the region is 20 m2 then tm s main desire is to reach this potential area in all districts a reward function is defined for tm as follows 17 δ g m a x n i area g p o n area g n i 1 25 where δ g m a x n i indicates the maximum increase in green spaces area in time step i area g p o n is the potential area in the final time step and area g n i 1 is the area of green spaces at the beginning of time step i 18 area g n i area g n i 1 x n i δ g m a x n i 19 dg n i area g n i de g the percentage of green spaces development in the time step i and in the district number n is equal to x n i de g is the annual water demand of each one m2 of green space and it is considered to be equal to 1 5 m3 m2 dg n i is the annual water demand of the entire green spaces area of district n at the first step tm must decide about the green spaces expansion and the amount of groundwater extraction in each time step the groundwater consumption includes the allocated water and the illegal extraction of water therefore the reward function of mu is defined as follows 20 reward mu n i 1 dg n i ag n i dg n i area g n i area g m i n n i area g p o n area g m i n n i where ag n i is the consumption of groundwater and wastewater by the municipalities in district n and time space i including illegal groundwater withdrawal area g m i n n i denotes the lowest possible area of green spaces are for region n in time step i the minimum green spaces area is considered based on the area where trees are planted it should be noted that the price of water even the real value may not be the main consideration of tm for the green spaces expansion 5 4 2 ministry of agriculture jahad maj the agricultural activity is mainly located in regions 2 and 3 i e 62 in region 2 and 38 in region 3 based on this classification two agents are considered to represent the farmers in this study area the process of decision making for the agents is the same and just they are located in different locations the crop yields water consumptions and crop prices are presented in table 6 the agents decide on the type of agricultural crops that should be cultivated the percentage of the potential area that can be cultivated and consequently the amount of water needed for the mentioned decisions regarding the reports by trw it is considered that agricultural agents illegal extracted water from the aquifer is annually about 50 million m3 the irrigation costs are about 25 of the total planting and harvesting costs in this area ministry of agriculture jahad 2014 21 reward fa n i 1 df n i af n i df n i y wh n i ppc wh n i cpd wh 4 p ot i pe 1 i z n i y ba n i ppc ba n i cpd ba 4 p ot i pe 1 i z n i y al n i ppc al n i cpd al 4 p ot i pe 1 i z n i ppc wh n i ppc ba n i and ppc al n i are the guaranteed purchase price of one kilogram of wheat barley and alfalfa respectively cpd wh cpd ba and cpd al represent the amount of wheat barley and alfalfa produced kilograms using one m3 of water y wh n i y ba n i and y al n i denote the percentage of the area of wheat barley and alfalfa planted in region n in time step i p ot i and pe 1 i represent the price of one m3 of water for agricultural consumption and the price of one kilowatt hour of electrical energy for pumping one m3 of water from a depth of one m rial z n i is equal to the depth of groundwater table from the land surface in region n in time step i m af n i is equal to the total surface and groundwater allocated to the farmers and including illegal use from groundwater as mentioned above there is two similar types of farmers which by getting feedback from the environment identify their cultivars and water demands are as follows 22 df n i y wh n i area f n eff wh cpd wh y ba n i area f n eff ba cpd ba y al n i area f n eff al cpd al where area f n denotes the area of agricultural land in region n eff represents the water efficiency of each crop wh b a and al stands for wheat barley and alfalfa respectively in this paper an agricultural agent tries to earn more from agricultural production by providing adequate water for this purpose also he considers the feedback from the environment and decides what to plant and how much illegal water be extracted from the aquifer 5 4 3 tehran province water and wastewater company tpww tpww is responsible for water distribution in urban areas mainly for domestic demand the sources of municipal water supply are surface and groundwater groundwater which has a lower quality is used when the surface water is not adequate the total water transferred from the karaj and taleghan dams are allocated to domestic demands and the rest of the domestic demands are provided using groundwater in this case the main challenge for tpww is to decide the share of each groundwater region for domestic water needs with minimum cost domestic demand has priority to use the groundwater the reward function of tpww is as follows 23 reward tp i cost tp i cost tp m a x i 24 cost tp i n 1 3 m 1 3 pe 2 i z n i re tp n i p t i δ h n m x n m i 25 cost tp m a x i n 1 3 m 1 3 i el p r i c e real e i 1 i n f i re tp n i z max n δ h n m x n m i eq 23 indicates the tpww s reward function the cost of pumping and transferring water from the aquifer eq 24 represents the maximum possible cost for tpww to supply water and eq 25 indicates the maximum possible cost to transport water x n m i is the volume of water transferred from aquifer n to supply domestic water need of region m in this case the water is only transferred from the region with lower altitude to the higher one if n m then x n m 0 pe 2 i is the price of one kilowatt hour of electricity for pumping one m3 for one m in time step i for tpww in iran s currency rial also z n i and re tp n i indicate the depth of the groundwater table from the surface of the ground in the beginning of time step i in region n m and the total water extraction from the aquifer n in time step i z max n is the maximum depth of the groundwater level to the surface of the ground at region n p t i is the price transfer of one m3 of water to a zone with an elevation of one m higher elevation δ h n m also denotes the difference between the groundwater table of regions n and m inf is the inflation which is assumed to be equal to the fixed value of 17 5 also i el and price real e i indicate the amount of profit required for water and wastewater and the actual electricity price in the base year respectively 6 sa modeling using sna in this paper sas have been embedded into water resources management models to illustrate the position of the methodology presented in this paper a classification of various considerations in water resources management models is presented in fig 8 as can be seen in this figure the direct or indirect costs and benefits can be considered in the form of optimization problems with economic objective functions or constrained also environmental issues have been widely addressed in water resources management models on the other hand the social considerations are usually neglected or addressed in a descriptive form in water resource management sna can be used to quantify social relations between agents in a community the required data for sna can be collected by conducting interviews with predetermined agents a structured interview is conducted with every stakeholder to gather the required data for sna for the kan river basin and the main agents sna is defined by ahmadi et al 2019 in this study the results of the paper are applied to define the rate of cooperation between the agents and mainly between the agents and trw as the responsible for water allocation as the groundwater is the main challenging water resource where it is possible for the agents to extract illegal water the main question would be about the level the coordination among the agents in the use of the shared aquifer the relations between the agents in the aquifer consumption between different agents are presented in table 7 and fig 9 in eq 9 reward socio is considered as the benefits which are gained considering the suggestions of trw for water allocation and reward indi is considered as the benefits gained by considering the individual desires and interests if the reward socio be higher than reward indi reward socio is considered on the other hand if reward indi be higher than reward socio the agent evaluate to choose his action based on individual benefit and his relation with trw estimated from the sna in the proposed formulation parameter τ is considered as the ratio of current cooperation level to the maximum possible cooperation level 7 physical simulation model for the kan river basin 7 1 surface water simulation model a physical simulation model is developed for the kan river basin to evaluate the results of the management scenarios considering the agents water demands a schematic picture of the study area is presented in fig 10 a water balance model is developed as the simulation model the west flood diversion is a manmade canal for collecting surface water and into the kan river considering the hydrological data the water balance model can be a formula as follows 26 v r o u t i v r i n i a b i a l i pe 1 i v se i r w 1 i pe 2 i r w 2 i pe 3 i a f i where v r o u t i is the volume of the out from the river at downstream in time step i m3 v r i n i is the kan river discharge measured in solughan station in time step i m3 v se i is the inflow volume from the west flood diversion system into the kan river in time step i m3 r w 1 i is the volume of the wastewater of the water treatment plant entering the kan river in time step i r w 2 i is the volume of the waste water out of the town entering the kan river in time step i a b i is the allocated water to the gardens in time step i a l i is the allocated water to the chitgar lake in time step i a f i is the volume of water allocated to agricultural lands in time step i pe 1 i pe 2 i and pe 3 i is the infiltration from the river into the aquifer in the region 1 2 and 3 in time step i respectively during the 25 year planning horizon i e 2017 to 2041 the water allocation policies are developed and evaluated by taking into account the behaviors of different agents at each time step the proposed model is run for the two deterministic and stochastic conditions in the stochastic models input data are generated using historical data in the deterministic condition the long term river discharge measured at the solughan station for the years 1992 2016 are repeated for the years 2017 2041 hydrological data is used after trend removal the amount of water entering the kan river through the west flood diversion system is determined by repeating the data from the years 1992 to 2016 regarding the field observations and groundwater data kan river does not seem to be fed by groundwater a daily water balance model for studying the interaction between the river and groundwater was developed by khorasani et al 2018 using this model the annual infiltrated water to the groundwater is calculated on average the infiltration of regions 3 2 and 1 is 16 24 and 4 million m3 per year respectively a part of the kan river water is transferred by navab safavi flood diversion system and kashanak canal for agricultural uses according to yekom consulting engineers 2009 10 about 4 million m3 per year of the flow in kashanak channel penetrates the groundwater the average recharge of the aquifer annual penetration by the kan river about 40 million m3 khorasani et al 2018 7 2 groundwater simulation model 7 2 1 aquifer s boundary the eastern and western boundaries of the groundwater are determined to be approximately perpendicular to the groundwater flow lines of the study area alborz mountains in the north of the case study can be considered as the northern boundary and the southern border of the aquifer is in line with the eastern valley of the arad koh mountains the aquifer covers most of the 5 9 18 21 and 22 districts of the tehran municipality the groundwater simulation model is developed based on a water balance equation to improve the accuracy of the model the aquifer in the study area is divided into three regions the districts no 5 22 and 70 of district 21 of the tehran municipality area located in region 1 of the aquifer district 9 18 and 30 of district 21 are located in region 2 moreover a part of the eslamshahr urban area is located in the 3rd region of the aquifer also 19 of the industries are located in region 1 69 in region 2 and the rest are located in region 3 62 of the agricultural lands are located in region 2 and the rest are located in region 3 the boundaries of the aquifer regarding the urban districts are presented in fig 11 7 2 2 aquifer water balance model the water balance equation is written for each region of the aquifer as follows 27 b n i 1 s a n b n i s a n di t n i re t n i tr n i 28 di t n i di mu n i di tp n i di fa n i di wo n i di ba n i 29 re t n i r ra rain n i a n r sw n inf sw t r fa a f n i r wo a w n i r gr a g n i r ba a b n i r rw n i r hh 1 a i 1 1 r loss a h n i r hh 1 a i 0 5 r loss 1 r loss a h n i r il 0 5 r loss 1 r loss a h n i 30 tr n n 1 i 365 wh n i wh n 1 i l n l n 1 2 l n l n 1 l n k n l n 1 k n 1 b n n 1 b n i b n 1 i 2 where b n i is the thickness of the aquifer saturation layer of region n in time step i m a n is the area of the region n m2 s denotes the specific yield coefficient of the aquifer di t n i is the total discharge from the aquifer in region n in time step i m3 di mu n i is total discharge by tm from the aquifer in region n in time step i m3 di tp n i is total discharge by the tpww from the aquifer the region n in time step i m3 di fa n i is total discharge by the maj from the aquifer in region n in time step i m3 di wo n i is the total discharge by the mimt from the aquifer in region n in time step i m3 di ba n i is total discharge by the gardeners from the aquifer in region n in time step i m3 re t n i is the total recharge of water to the aquifer in region n and in time step i m3 r rw n i is total amount recharge of wastewater to the aquifer in region n and time step i m3 r ra is the percentage of rainfalls which infiltrates to groundwater rain n i is the annual precipitation in region n and time step i mm r sw n is the volume of percentage of river discharge which infiltrates to the aquifer of in region n m3 inf sw t is the water infiltrated to the aquifer from the kan river m3 r fa is the percentage of water infiltrated to the groundwater after agricultural consumptions a f n i is the total amount of water allocated to the agricultural needs in region n and in time step i m3 r wo is percentage of industrial return flow to the groundwater a w n i is total amount of water allocated to the industrial needs in region n and time step i m3 r gr is the infiltrated water to the groundwater from the irrigation of green spaces m3 a g n i is the total amount of allocated water to the green spaces in region n and time step i m3 r ba is the percentage of allocated water to gardens which is infiltrated to groundwater a b n i is the total amount of water allocated to the gardens in region n and time step i m3 r hh is the percentage of filtered water to the groundwater from domestic return flow a i is the percentage of the population that is covered by municipal sewage collection system in time step i r loss is urban water distribution loss rate 50 unauthorized use of network and 50 network leakage a h n i is the total amount of water allocated to households domestic uses in region n and in time step i m3 r il is the percentage of water infiltrated to groundwater from urban water distribution losses tr n n 1 i is the amount of water transfer between region n and region n 1 in time step i m3 b n n 1 is the average width between the regions n and n 1 m l n is the length of the aquifer in region n the average length from the north to the south of the aquifer m k n is the hydraulic conductivity of the region n in m per day wh n i is the water level in region n and in time step i m eq 27 is the mass balance relation which is applied to each of the regions this model provides the volume of water in each of the regions at each time step during the simulation horizon eqs 28 and 29 give the total groundwater recharge and discharge for each year eq 30 shows the transfer of water between two adjustment aquifer regions over one year the base year of the simulation model is 2016 then the groundwater level at the end of this year is considered as the initial condition of the model the initial conditions of the model and the input parameters are presented in table 8 the main parameters of the aquifer such as the specific yield coefficients and the hydraulic conductivities have been calibrated using a genetic algorithm ga by abdolhay 2018 7 2 3 groundwater quality model the main sources of the pollution of the groundwater in the study area are the agricultural return flows and sewage absorption wells baghvand et al 2016 nitrate which frequently violates the groundwater statements can be considered as a water quality indicator in the study area the main sources of nitrate pollution are wastewater absorption wells besides in the process of nitrification the organic nitrogen and ammonia are synthesized nitrate to simulate the nitrate concentration in the aquifer the model which has been developed and calibrated by khorasani et al 2020 is utilized 8 multi criteria decision making model the borda count social choice method is used to select the best scenario for improving the status of the system the available scenarios for reducing conflict can be divided into two categories of water treated wastewater allocation and management scenarios allocation priorities by the trw are proposed and the higher level upper organizations are responsible for pricing and approval of the implementation of infrastructural projects extension of the municipal wastewater collection system and construction of treatment plans in the decision making model the higher and water supplying institutions rank different scenarios based on their utilities then the borda count method is used to select the best scenario one of the decision makers that chooses the best scenario is trw the trw utility includes improving the status of the aquifer providing water for all consumers and increasing the profit of the water allocation other decision makers are the tehran provincial government tpg and islamic city council of tehran icct the department of environment doe and the ministry of health and medical education mhme mhme and doe can be considered as one decision maker as their main utilities are similar i e improving the quality of the groundwater the groundwater quality indicator in this paper is the average concentration of nitrate as stated in the recognition of the agents the main utility of the tpg in the study area is to provide social security therefore tpg considers the extreme conditions of the system for example if the price of water be so high that one of the agents consumers cannot get enough water and this situation causes social disputes this would have a negative impact on the utility of the tpg 9 results and discussion in this paper 63 main scenarios are considered in this paper table 4 besides the main scenarios each of the scenarios is run for three rising price conditions and five policies for wastewater use in other words each row in table 4 contains 15 different scenarios the study area is modeled for four different modes and the best scenario for each mode is presented deterministic model without sa deterministic model with sa stochastic model without sa stochastic model with sa as the key question is the allocation of water and treated wastewater to the agents which is mostly decided annually a yearly time step is considered for the decision making policies however physical simulation models have shorter time steps for example the simulation of nitrate concentration is evaluated weekly and finally the annual concentration of nitrate is considered for the assessment of aquifer water quality corresponding to a scenario 9 1 first mode deterministic model without sa to choose the best scenario using the borda count method each decision maker ranks the scenarios according to his utilities in table 9 the code of each scenario is defined as follows the first number is referred to the allocation scenario the second number shows to the price conditions and the third number denotes the decision about the use of wastewater for the groundwater recharge after ranking the scenarios by decision makers the best scenario is selected using the borda count method in the first mode scenario 311 is selected as the best one in this scenario the treated wastewater should be allocated is the industries and then urban green spaces the rest of the treated wastewater is discharged into wells to recharge the groundwater in this scenario groundwater after providing the drinking water is allocated to the green spaces industries and agricultural demands respectively more details about the best scenario such as the water allocation to each of the agents groundwater table fluctuations and nitrate concentrations in three regions the water demands the allocated water by the trw and total water consumption including allocated water and illegal water extraction for agricultural sector in region 2 and 3 are presented in table 10 and figs 12 15 9 2 second mode deterministic mod with sa in this case after ranking the scenarios using the borda count method scenario 111 is the best one in the best scenario the priority is to allocate wastewater to the green spaces and industries and then feeding the aquifer through the absorption wells groundwater is also allocated in descending order to drinking demands industries agricultural needs and green spaces demands scenarios 311 and 312 also have also good results comparison of the best scenarios in the first and second modes illustrates that the scenarios which are corresponding to 30 increase in water and electricity prices per year and discharge of 50 100 of wastewater into the wells are suitable by comparing the results of the best scenario with and without sa it can be concluded that the water level in the case of sa considerations is in a better condition the improvement of the aquifer condition in the second case is due to the coordination of the agents with the trw and their less illegal water extraction this means that considering sa and improving sa conditions can lead to a better solution in common pool resources the selected scenarios and their characteristics are presented in tables a 1 11 and figs 16 17 a 1 and a 2 9 3 third mode stochastic model without sa given that in two previous modes the scenarios with a discharge of 100 or 75 of wastewater into the kan river had not good rankings these scenarios are not considered in the stochastic model where uncertainties are taken into account thus 24 scenarios are eliminated and decision options are limited to 39 scenarios the borda count method is used to rank the solution of the stochastic model tables a 2 12 and figs 18 19 a 3 and a 4 the results show the scenario 312 is the best one in this scenario wastewater is allocated to the industries and green spaces 75 and 25 of the remaining treated wastewater is used to feed the aquifer through adsorption wells and discharged into the kan river to recharge the aquifer indirectly respectively the water allocation priorities from the groundwater are drinking green spaces industries and agricultural lands respectively scenario 321 and scenario 331 have also acceptable results scenario 321 and scenario331 with 40 and 50 annual increase in prices can lead to drastic decrease in the area of agricultural lands in the study area and cause some issues related to the social security therefore the high level institutions should consider alternative livelihoods for the farmers if they choose scenario 321 or scenario 331 be chosen 9 4 the fourth mode stochastic model without sa in this case after calculating the rank of all scenarios it becomes clear that scenario 312 is the best one scenarios132 and 311 have also provided acceptable results the good rankings of the scenario 311 and scenario 132 with 50 annual increase in prices show that the social security would be at risk due to significant decrease in cultivated area but the rest of criteria have high values in these scenarios the high level institutions should consider alternative livelihoods for the farmers the scenarios and their respective results are presented in tables a 3 13 and figs 20 21 a 5 and a 6 10 summary and conclusion in this paper by getting some the insights from the rl approach a more realistic methodology was presented for incorporating social and behavioral aspects in developing water and treated wastewater allocation policies in urban areas one of the most important findings of this paper is showing the possibility of incorporating sa in water resource management models it was also shown that the sna can be used to transform the social relationships among agents into some objective social parameters in this paper the western part of the tehran metropolitan area which includes several environmental issues and different stakeholders with conflicting utilities was considered as the case study a combined physical behavioral model was developed which can quantify and incorporate the social parameters in the decision making process in this study four modes were considered to investigate the water resource management problem in the study area in the first mode the utilities of the agents were identified and then using the q learning algorithm and a water balance based model water quality and quantity conditions were simulated based on the agents decisions and actions in the second mode the sa was considered in the behavioral model using the outputs of the sna in the q learning algorithm the third and fourth modes were studied by extending the first and second modes to incorporate hydrological uncertainties in the case study 63 management scenarios were developed and the four proposed approaches were evaluated and compared the developed management scenarios consider almost all possible scenarios for managing urban water resource allocation for each mode the best scenario is chosen using the borda count sc method in all studied modes drinking water demands are almost fully supplied in other sectors by considering the sa the allocated water to demands is slightly decreased and this leads to a better condition for the groundwater especially in region 3 where 9 m rise in groundwater table level is obtained during the planning horizon comparing the best scenarios of the first and second modes illustrates that the scenarios which are corresponding to 30 increase in water and electricity prices per year and use of 50 100 of treated wastewater for recharge of aquifer using absorption wells are more acceptable by comparing the results of the best scenarios with and without sa it can be concluded that the groundwater tables in all regions have been almost increased where sa is included in the best scenario of the first mode the depth of groundwater tables the first second and third regions have respectively changed from 95 to 66 m 98 to 85 m and 42 to 27 m during the planning horizon in the best scenario of the second mode the depth of groundwater tables the first second and third regions have respectively changed from 95 to 70 m 98 to 82 m and 42 to 38 m during the planning horizon besides the nitrate concentration in the first mode has changed from 42 to 14 mg l 18 to 26 mg l and 18 to 5 mg l in the first second and third regions respectively a similar improvement in the nitrate concentration of the aquifer can been seen in the results of the second mode it was also shown that incorporating sa for tackling water and environmental issues in common pool system is very important as the social relations in this case study are not complete and ideal the obtained results can be improved by strengthening social relations and the level of cooperation among the agents the first two modes were also extended by considering hydrological uncertainties under these circumstances the water extraction rates for some of the agents are higher than the deterministic conditions the main reason is the conservative behaviors of the agents in uncertain situations this study is one of the first steps to quantify and incorporate social parameters in water and treated wastewater allocation in urban areas in future works the proposed methodology can be extended to evaluate and improve the level of cooperation diffusion in water and environmental systems credit authorship contribution statement mohammad javad emami skardi conceptualization methodology writing review editing reza kerachian methodology supervision writing review editing ali abdolhay conceptualization software validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper annex 
5552,although economic and environmental considerations have been well integrated into water resources management the social aspects have been usually neglected quantifying and embedding social attachments in the water resource management models are so challenging in this paper a novel approach is proposed to quantify and consider social attachments for water and wastewater allocation in urban areas in the management of shared resources one of the main issues is the level of cooperation among agents in a multi agent environment stakeholders can decide non aligned or depending on their interests and social attachment have some cooperation and coordination in the decision making process in the proposed approach an effort has been made to take into account the effects of social attachments on agents decisions in this paper social network analysis is applied to evaluate the coordination level between agents in the use of shared water resources a paired physical and behavioral simulation model is developed to assess water and wastewater allocation scenarios a reinforcement learning approach namely q learning is used to develop the behavioral model which is linked with social attachments to evaluate the applicability of the proposed approach the kan river basin in the western part of the tehran metropolitan area is studied by using the proposed approach for a 25 year simulation horizon and 63 water and treated wastewater allocation scenarios it is shown that it has merits to find the best scenarios in different conditions and can enhance the sustainability of the water resources in the study area according to the results improving the social attachments in the study area can reduce the over exploitation of groundwater and improve the groundwater quality keywords reinforcement learning q learning social attachments kan river basin social network analysis 1 introduction since the middle of the 20th century in conjunction with the structural methods nonstructural approaches have been considered to solve water resource management problems mckinney et al 1999 despite the development of engineering technologies and management methods water resources management problems in some areas have not been effectively solved one of the main reasons is the lack of social considerations in the process of management the coevolving relationships of hydrological and social systems are capable of making unforeseen patterns which can induce critical environmental and social issues pouladi et al 2019 in this case facing conflict in water resource management may be unavoidable emami skardi et al 2013 mahjouri and pourmand 2017 the economic objectives can be better addressed than the environmental or social criteria which often are difficult to be defined in quantitative terms mckinney et al 1999 the concept of integrated water resource management iwrm has been proposed to deal with water resource management difficulties considering structural and nonstructural approaches by 2012 more than 80 of the countries had made good progress towards meeting iwrm and yet iwrm as the interesting mission for water resources management issues is under studied smith clausen 2015 to have integrated management developing a behavioral simulation model especially in large scale water resources systems is necessary agent based methods can be utilized to simulate the agents behaviors and evaluation of different water management policies within a system darbandsari et al 2020 to have an integrated model the behavioral simulation model must be combined with the physical simulation model social considerations must also be taken into account to reach a comprehensive integrated model in order to consider social aspects social relations should be quantified the interactions of agents in a social network effect the level of cooperation between them the agents interactions can be entirely cooperative fully competitive or indirectly through the environment of the problem neither cooperative nor competitive besides considering the learning ability of the human agents apt agent based modeling must consider the learning ability of the agents reinforcement learning rl has been accepted as an agent based approach that is developed based on the agents interactions with the environment hence it can be used in a large scale water resource system and inherently can consider the involved uncertainty of the system q learning is a prominent learning technique first proposed by watkins 1989 as a subset of rl q learning is an acceptable agent based approach that can tackle some main difficulties of water resource system modeling rl is developed based on the concept of interaction of learning agents with the environment in the form of states actions and rewards sutton and barto 2018 in the q learning approach the agents can learn from past processes and outcomes thus it is so applicable in repetitive events besides in most large scale systems indirect agents communications bounded rationalities and inability to monitor the total area of the system the relations of the agents can be only defined through the environment in this case q learning which is mainly based on the agents interactions with the environment of the problem is so helpful wilson 1996 firstly used q learning in the design of an urban drainage system castelletti et al 2002 proposed rl based algorithm to design a policy to operate a multi goals reservoir the presented method is used for a part of the water system model catchment area and the rest of the model reservoir is described by mathematical equations based on physical characteristics bhattacharya et al 2003 applied artificial neural networks and rl examined the process of controlling water systems abolpour et al 2007 presented adaptive neural fuzzy reinforcement learning anfrl and studied a water allocation problem in kor and sivand river basin in iran based on the proposed approach in this model a simulation model is considered using the adaptive neuro fuzzy inference system to reduce the errors between outputs and actual data mahootchi et al 2007 proposed a new algorithm called opposition based reinforcement learning obrl as an adapted version of the q learning for reservoir operation castelletti et al 2010 tried to solve the dimension curse in large scale water systems with an approach named fitted q learning although a minority of the water resource problems especially in the large scale systems are mono agent majority studies in the field of water resource management using the rl based approach in single agent form portraying modeling and analyzing a community of agents using a network structure with nodes and links that representing participated agents and their interactions respectively is social network analysis sna therefore graph theory and related evaluations are applied for social modeling with sna in sna the interactions are as important as the role of the agents sna is one of the most important efforts to investigate and quantify some of the main social parameters namely social interactions as water resources are usually involved more than one stakeholder then water resource systems are fertile ground for the application of sna using sna the level of cooperation between the agents can be quantified and considered in the water resource model agents who are participated in formal institutions may not play main roles thus sna could be beneficial for analyzing the role of social interactions that are not understood just by looking at formal institutions that constitute a system yamaki 2017 in this point of view sna can enlighten a water resource system and determine the main agents besides the formal and traditional survey sna can clarify the dark side of a water resource system especially referred to the agents relations a well investigated sna can be used to understand the key agents and the information flow in a system several research applied sna to analyze natural and water resource management sna can be used to study the governance characteristics bodin and crona 2009 ernstson et al 2010 newig et al 2010 stein et al 2011 horning et al 2016 ferrer et al 2018 sna has been applied in several natural resource governance studies schneider et al 2003 dougill et al 2006 bodin et al 2006 lauber et al 2008 bodin and crona 2008 mandarano 2009 haak et al 2017 yamaki 2017 has used sna to better quantify the relations between agents in natural resource management in japan the author declared sna can be applied because of its ability to systematically and quantitatively investigate relationships between agents investigating central stakeholders using sna make it possible to find main involved stakeholders in the governance in this paper a novel approach is proposed to quantify social attachments sa based on sna and incorporate them into water resource management in urban areas sna is applied to quantify the level of coordination among decisions and cooperation level between agents in the use of shared water resources briefly speaking the objectives of the present study are to simulate the behaviors of agents in large scale hydrologic environments and provide an approach to consider social parameters in the decision making process the rest of the paper is prepared as follows in the next section the proposed methodology is described then a brief description of the study area and its main issues are presented in the end the main results of the application of the proposed methodology to the study area and the concluding remarks are presented 2 methodology the proposed methodology is based on studying the main institutions in urban water and wastewater management with an emphasis on considering the social parameters into the modeling process a flowchart of the proposed methodology is presented in fig 1 2 1 system identification the first step in managing water resources is the physical and behavioral recognition of the problem in the following parts the process of system recognition is addressed 2 1 1 physical system identification physical identification of water resources in hydrological environments is mainly based on the identification and modeling of surface and groundwater resources this section presents the modeling process of ground and surface water resources balance based models have been used for physical modeling of the resources and their interactions 2 1 1 1 surface and ground water quantity simulation model the resolution of the physical system identification depends on the needed information for developing the physical simulation model in this paper a water balance method is used for the surface and groundwater simulation the schematic picture of the water balance model is presented in fig 2 the physical model equations are presented in section 8 considering the main characteristics of the study area to evaluate the groundwater level more precisely and regionally the aquifer can be divided into several connected regions where the hydraulic conductivity and specific yield coefficients can be considered locally fig 3 in the groundwater balance model the discharge and recharge in each region and the transfer of water between the regions are the inputs of the model and the status of the aquifer is the output underground water transfer between the local aquifers follows darcy s law 1 q k i a 2 i dh dl where a k i and q are the flow cross section area hydraulic conductivity hydraulic gradient and quantity of water flow respectively dh dl denotes the derivative of water level to length the surface water balance model can be formulated as follows 3 v r o u t i v r i n i rws i di ba i di fa i pe i 4 b i 1 s n a n b i s n a n di mu i di tp i di fa i di wo i re mu i re tp i re fa i re wo i re ba i rwg i pe i where v r o u t i and v r i n i are the volume of water at the downstream and upstream of the river in time step i respectively the volume of the water in the river must be more than the ecological need and then the ecological constraint must be considered in water extracting from the river di ba i di fa i pe i and rws i are the volume of water is provided by the river for gardeners and farmers infiltration of water from the river to groundwater and wastewater inflow to the river in time step i respectively di mu i di tp i di fa i and di wo i respectively denote the demands of green spaces and potable agriculture and industrial water uses in time step i also re mu i re tp i re fa i re wo i and re ba i represent the return flows from municipal potable agricultural industrial and gardens demand nodes in time step i rwg i denotes wastewater recharge to wells in time step i s n is the aquifer s specific yield coefficient a n is the area of the region n and b shows the water table level in the study area which can be evaluated using eq 5 5 b n i 1 s n a n b n i s n a n di t n i re t n i tr n i where b n i 1 is the water table of the region n at the end of the time step i b n i is the water level of the region n at the beginning of the time step i s n is the aquifer s specific yield coefficient a n is the area of the region n di t n i is the total water withdrawal from the aquifer in region n during time step i and re t n i is the total recharge in region n during time step i tr n i is the flow from the region n in time step i due to the transfer of water between different regions which is obtained using eq 1 2 1 1 2 groundwater quality simulation where there is not a wastewater collection network wastewater is usually discharged into the groundwater using absorption wells in this case wastewater would be the main source of groundwater contamination in urban areas the condition is so problematic when the groundwater is simultaneously used as the source of potable water therefore the simulation model should consider both the quantitative and qualitative aspects of surface and groundwater 2 1 1 3 uncertainties of the inputs of the physical model the existence of uncertainties in the structure inputs and parameters of a simulation model can affect the accuracy of the results in this paper the inherent uncertainties of the main hydrologic variables are taken into account by using the historical time series and the correlation coefficients among hydrological variables more details about the uncertainty analysis process are presented in the results section 2 1 2 behavioral identification and simulation model a proper behavioral model should simulate the agents decision making process in large scale systems agents are defined as a part of the system who can affect the environment and consequently be affected by the environment in this paper the agent based model is defined in the form of the overview design and details odd protocol concept grimm et al 2010 darbandsari et al 2020 a human can be considered the learning agent in repetitive problems learning from previous experiences may be the most part of the decision making process many water resources management problems can be considered as repetitive issues hence in this paper the q learning technique as a subset of the rl approach is considered to model the agents behavior in water and treated wastewater allocation in urban areas large scale water resource problems are not fully cooperative or competitive in these systems agents have mainly interactions with the environment and based on the feedbacks of the environment in response to their previous decisions or actions they decide what to do a collection of the learning processes that can be improved over time by getting more information is called rl sutton and barto 2018 rl based approaches are computational methods based on learning by interacting with the environment unlike the observer learning methods i e learning by an external observer the rl based approaches learn by receiving and analyzing the environmental feedbacks sutton and barto 2018 the rl consists of a set of states s a set of feasible actions a and a set of consequences r examination and error based quests and consideration of the rewards of the next steps are two distinctive features of rl sutton and barto 2018 a schematic picture of the rl is demonstrated in figs 4 and 5 in addition to the environment and agents that are the main components of rl the following sub elements are also imperative sutton and barto 2018 policy a map to select an action between a set of possible actions in a particular state reward the immediate feedback from the environment which shows the desirability of the consequence of action for the agent in a state value action function q function this function shows the cumulative reward value for each action in each particular state model used to determine the next step and the reward received the formulation of the q learning method which is used in this paper is as follows ni et al 2014 madani and hooshyar 2014 6 q new s t a t 1 α q old s t a t α r t γ max q s t 1 a where t stands for the time step q old s t a t is the q factor in the previous episode for action a t and state s t of the environment q new s t a t is the q factor in the new episode for action a t and state s t of the environment s t is the state of the environment in time step t and a t is the action in the time step t s t 1 is the state for the next time step due based on choosing action a t α is the learning rate which is between 0 and 1 indicates the importance of the reward function or r t for impact on the value function or q γ is the discount rate which is between 0 and 1 indicates the effect of the decision on the options ahead and the effect of the decision value function on the decision max q s t 1 a is the maximum q factor in the s t 1 mode for all possible actions r t is the value of the instantaneous reward received by the agent for the operation of a t in s t mode in multi agent situations agents decide individually and effect on the environment simultaneously in this case four approaches can be used to simulate the behaviors of the agents using the q learning algorithm in the first approach a q function is defined for all agents in this case the q function is equal to the set of consequences or rewards of all involved agents this system is considered fully collaborative in the second approach each agent can have its own q function besides in the reward function the strategic decisions of other agents are considered in this case the system is fully competitive in the third approach for each agent a separate q function is defined and the agent decides based on the feedback received from the environment this condition is very close to the non cooperative form but as the agents do not consider the decisions of the other agents in their reward functions the process of decision making is not strategic this case is not fully cooperative nor quite competitive in the fourth and more realistic form the third approach is combined with sa to simulate the system in the fourth approach for each agent a q function is defined and the agent decides based on both the received feedback from the environment and his interactions with the other agents in the q learning algorithm the decisions are chosen among decisions actions set 7 a t a t 1 a t 2 a t n where a t is the set of actions in time step t and includes the decision of agents 1 t o n at time t a t i is action of the agent i in time step t the agents decide simultaneously and this can make the simulation process more realistic fig 6 after making a decision and receiving the feedbacks from the environment the agents evaluate their reward functions 8 r t r t 1 r t 2 r t n w h e r e r t is the reward function set at time t and r t i is the reward function for agent number i at time t i f r o m 1 t o n in the proposed multi agent q learning algorithm because of the involved uncertainties and the simultaneous decision making of the agents two similar decisions may not give the same reward values in two different episodes in the traditional q learning approach the action that has the highest value is mostly selected this method is usually used to achieve the best answer as soon as possible but can increase the risk of trapping in locally optimal solutions the proposed approach can be used to give a chance of selection to all decisions the q function in each episode not only represents the reward function in that episode but also includes the information and experiences of the earlier episodes therefore the q function can be considered as the history of the previous rewards considering this fact because of the existing uncertainties in the environment reward of a specific decision in two episodes may be different as the q function is the average of all previous rewards for a specific series of actions it is possible to say that the maximum q function in the last episode incorporates the existing uncertainties in the environment 2 1 2 1 social network analysis sna the sna can be applied to study the level of cooperation in water resource systems luzi et al 2008 showed that sna is a useful tool for defining the cooperation patterns in the nile river basin in this paper sna is applied to investigate the coordination of the decisions among the agents in the use of shared water resources 2 1 2 2 social attachments sa and q learning the majority of the previous studies in the field of water resource management have emphasized on the individual characteristics of agents and the sa and the relations among stakeholders have been usually ignored in the lack of considering social links and interactions amongst agents the simulation of the environment and the agents behaviors is incomplete bazzan et al 2011 tried to incorporate the sa in the q learning method they tried to consider the agents sa using a parameter named τ the q function obtained from the personal activity of the agent named qind was compared with the q function refer to social optimality where the agents choose actions aligned with the total profit of the system parameter τ shows the degree of responsibility sense of participation and even guilty feeling of violation of the agreements however bazzan et al 2011 did not clarify how the sa parameter τ should be evaluated the applied approach to consider sa in the q learning is based on the methodology proposed by bazzan et al 2011 where a parameter denoted by τ represents the level collaboration in the system for achieving social optimality in this paper using the outputs of sna and following the algorithm proposed by bazzan et al 2011 a novel approach is presented to consider sa in the q learning algorithm in this method the value of an individual reward function reward indi is estimated by maximizing the respective agent gain then another reward function based on cooperation in the system and the sa reward socio is estimated the individual or social behavior of each agent is estimated as follows 9 i f 1 τ reward socio reward indi social b e h a v i o r i s s e l e c t e d e l s e individual b e h a v i o r i s s e l e c t e d as previously mentioned sna can be used to study the level of cooperation among agents in a water resource system the estimated level of cooperation can be a basis for determining parameter τ in the q learning algorithm more details are presented in section 7 2 1 3 social choice sc method the borda count social choice method is used to select the best scenario for improving the status of the system bizhani manzar and mahjouri 2013 ghodsi et al 2016 mahjouri and abbasi 2015 available scenarios can be divided into two categories of water allocation and water management scenarios 3 case study the kan river basin is located in the western part of the tehran metropolitan area 7 the main water resources in this area are surface water treated wastewater and groundwater several land uses can be identified in the kan river basin such as residential agricultural recreational and industrial zones and green spaces darbandsari et al 2017 the kan river basin begins from the northern part of the tehran metropolitan and ends to tehran qom old road at the south the eastern and western boundaries are defined perpendicular to equipotential lines of groundwater thus it can be assumed there is no water flow from the western and eastern boundary of the study area fig 7 the kan river basin is a developing urban region with serious water related issues also the kan river basin suffers from policy related concerns about the allocation of treated wastewater ahmadi et al 2019 covering different types of land covers and uses including growing populated districts industrial regions gardens agricultural zones recreational areas as well as the existence of several involved agents and many environmental issues make the kan river basin an interesting case study for the proposed methodology 3 1 kan river basin main agents and state variables system identification is a pre requisite for developing the physical and behavioral simulation models besides water management scenarios must be are determined based on the proposed scenarios and results of the behavioral and physical simulation models the best scenarios are determined using the sc approach the apt scenarios depend on four main factors 1 improving the groundwater quality and quantity conditions 2 supplying all water all demands and 3 increasing the financial income from water allocations 4 causing fewer social problems or considering social security three conceptually different agents are considered in this case study water supply and distribution organizations tehran regional water company trw tehran province water and wastewater company tpww water consumers ministry of industry mine and trade mimt tehran municipality tm ministry of agriculture jahad maj and tehran province water and wastewater company tpww and high level organizations tehran provincial government tpg department of environment doe ministry of health and medical education mhme islamic city council of tehran icct the higher organization are the governing institutions that make some key decisions such as pricing or setting environmental constraints and developing management scenarios the agents and their desires are demonstrated in table 1 the environment includes various entities being classified into two main groups physical and behavioral the state of water resources in the study area during the simulation horizon is defined by the physical environment component including groundwater surface water and wastewater the main water resources and consumptions at the current situation are presented in table 2 3 2 water and wastewater management scenarios to determine the proper water and wastewater management strategies the developed scenarios are considered as the inputs of the simulation model and based on the results the scenarios are ranked using the borda count method the appropriate scenarios can facilitate reaching social optimality and alleviate disputes in the system trw determines the water and wastewater allocation scenarios and the other higher upper organizations regulate the management policies such as the price of the water in the development of the scenarios some fixed constraints must be considered such as providing water for the potable needs trw and tpww are representatively responsible for supplying and distributing drinking water in the study area in the following parts the main water resources and possible management scenarios for each of them are studied 3 2 1 water transfer predominantly the potable water demand of the western part of tehran depends on the water transfer form karaj and taleghan reservoirs as the treatment and transfer cost of transferred water from karaj and taleghan dam is considerable using this water for any other use water is not cost effective 3 2 2 kan river kan river is the longest river in tehran one of the most populated and largest cities in the middle east various consumptions from upstream to downstream of the kan river can be identified the first water users are the gardens near to the upstream of the river then a part of the water is transferred to a manmade recreational lake called chitgar lake farmers are the other users who are directly using the kan river water for their needs in the second and third regions 3 2 3 groundwater resource due to the sizable surface area of the aquifer the unlawful groundwater water use is more feasible than the surface water thus groundwater can be considered as the main source of disputes groundwater can be used for drinking needs irrigation of green spaces industries and agriculture for some needs surface water extraction may be more advantageous i e for agriculture but the inadequate surface water makes the use of the groundwater inevitable groundwater is even an important source of water for urban potable water needs during droughts 3 2 4 wastewater the sewage system has not covered the whole of the study area but the implementation of the sewage system is under study the schedule of the sewage collection system is presented in table 3 by now the wastewater is discharged into the absorption wells after the implementation of the wastewater collection system waste water can be managed like the other water resources and it can be considered as a source for recharging the aquifer two ways to feed the aquifer by the wastewater can be considered firstly discharging the treated wastewater into wells with a high penetration rate and secondly discharging through the river also treated wastewater can be directly used for supplying demands of green spaces agricultural lands and industries 4 uncertainties in available water hydrological data including transferred water from the karaj and taleghan dams available water volume of water stored in the karaj dam at the beginning of the water year plus volume of water entering the dam during the year the kan river flow measured in the solqan hydrometric station flood diversion flow infiltration of the kan river air temperature and precipitation are considered in two conditions in the first case the uncertainties of the hydrological data are not taken into account it is assumed that the hydrological data for the years 1992 to 2016 will be repeated in the years 2017 to 2041 respectively in the latter case annual hydrological data are randomly generated considering the correlations among them therefore a matrix consisting of the variance of each dataset and the covariance between the various data sets is used the generated matrix is a seven by seven matrix because there are seven input hydrological datasets the matrix diameter includes the variance of each data set and other elements includes covariance between different datasets then using the mvnrand command in matlab random hydrological data are generated 5 behavioral simulation model to identify the actions of the players firstly their desires must be determined in this section the main desires and the feasible actions for the agents are studied where the behavioral model is developed based on 5 1 trw trw is responsible for water allocation in this study area three main factors are considered in allocating water as a result the following three criteria are used to rank management scenarios in the borda count method 5 1 1 managing groundwater table fluctuations and supplying water demands the dynamic groundwater volume can be considered as a renewable source for each year in this case a specific water table for each region is determined as the constraint if the water table in the aquifer is higher than the determined water table it is considered suitable to compare various scenarios and rate the quantitative condition of the groundwater the violation from the limitation is considered as a criterion 10 u tw 1 i n 1 3 gw limit n b n i 11 if b n i gw limit n t h e n gw limit n b n i 0 where the u tw 1 i gw limit n and b n i represent the first utility function of the trw in time step i the maximum allowable depth of the groundwater table in region n in m and the aquifer level in region n in m in time step i respectively the utility function of trw for supplying demand is presented as follows 12 u tw 2 i 1 1 6 1 r a t e loss dh t i ah t i 1 r a t e loss dh t i df t i af t i df t i db i ab i db i dw t i aw t i dw t n dg t i ag t i dg t i dl i al i dl i where u tw 2 i represents the second utility of the trw in time step i rate loss denotes the urban water distribution loss rate dh t i is potable water demand and ah t i denotes the total water allocation to the potable demand in time step i df t i db i dw t i dg t i and dl i indicate the total water demands of farmers gardeners industries green spaces and chitgar lake in annual time step i respectively besides af t i ab i aw t i ag t i and al i indicate the allocated water to the demands of farmers gardeners industries green spaces and chitgar lake in time step i respectively 5 1 2 economic desirability of water allocation scenarios trw sells water to different consumers at different prices which has been previously defined by some higher organizations hence financial interest must be defined as one of the main utilities of trw this utility function is defined as 13 u tw 3 i ah d t i p s t p i ah g t i p g t p i ab i p ot i af t i p ot i al i p l i aw g t i p in i aw r t i p rw i ag g t i p otg i ag r t i p rr i this equation calculates the income from the sale of water and wastewater ah d t i and ah g t i indicate the allocation of water from the reservoirs and aquifers for drinking demand in time step i respectively also aw g t i aw r t i ag g t i and ag r t i are the amount all allocation from the aquifer to industry from wastewater to industry from the aquifer to green spaces and from wastewater to green spaces in time step i respectively p s t p p g t p p ot p l i p in i p rw i p otg i and p rr i indicate the selling prices of one cubic meter of surface water to drinking demands sales to the tpww groundwater for drinking water water for agriculture and gardens surface water for chitgar lake groundwater for the industry wastewater for industries groundwater to the green spaces and wastewater for the green spaces in time step i because of the use of the sc approach and its characteristics there is no need to standardize the decision makers utility functions also if the water sales function is standardized the effect of the increase in income is not taken into account and only the approaching of the sales price to the real price is considered the limitation level is evaluated for each aquifer zone regarding the annual aquifer recharge and discharge in the past 25 years the groundwater table depth limitations for regions 1 2 and 3 are considered to be 86 89 and 38 m respectively 5 2 pricing management policies in addition to the water and wastewater allocation scenarios there are some management strategies developed by the higher upper institutions pricing policies for water and electricity can be used to improve the water use efficiency of the agents to evaluate the pricing policies different annual growth rates are considered given the price in the base year for each of the pricing strategies an upper bound is considered in a way that the prices of each year should not exceed this limitation the upper bound limitations for the prices are defined based on the real prices and the inflation rate of the country the benefit of selling wastewater water and electricity are calculated as follows 14 p m i p m 1 1 rate p i p max m i 15 p max m i rate in j p real m 1 1 i n f i where p m i denotes the price of water or electricity for a specific demand from source m in time step i m is to the price of water or electricity for the same need and the same source in the base year p max m i indicates the maximum price of water or electricity to supply the same need from the same source rate p stands for the growth rate of water or electricity price that can vary in different scenarios and rate in j is the profit increase rate of the producer of water or electricity companies p real m 1 represents the real price of the water for the specified consumption from a specific source in the base year and inf indicates the inflation rate in this paper three pricing policies 30 40 and 50 growth rates are considered 5 3 tpww tpww is responsible for treating and distributing water for the population in the region the domestic water demand is mainly dependent on the population of the study area after predicting the population of the study area for the water distribution system tpww tries to minimize the cost of the water supply using the available water resources based on the data provided by the iranian statistical center the population for the simulation period is evaluated using regression analysis besides using an artificial neural network ann the water demand is predicted for the simulation period where the main inputs are the inflation rate average household size average annual household income price of the water and annual hydrological status i e annual available water 5 4 ministry of industry mine and trade mimt kan river basin is one of the most imperative industrial parts of tehran metropolitan the industries are divide into three main agents distributed across the area each on one region of the aquifer the annual water demands for the industries located in different regions of the aquifer are presented in table 5 the main source of water for the industries is groundwater about 40 of the demands of the industries are provided using illegal wells then the main decisions of the industries are to withdraw from illegal wells or not the benefits of producing goods are greatly more than the cost of water purchasing therefore the utility function of the industries mainly depends on the deficit for providing water the reward function of an industrial agent is defined as 16 reward wo n i 1 dw n i aw n i dw n i where dw n i is the need for the industry agent number n n i s 1 2 3 in time step i and aw n i indicates the sum of the water and the wastewater allocated to industry agent number n and the illegal withdrawal from groundwater in time step i 5 4 1 tehran municipality tm chitgar lake and the irrigation of green spaces are two main water demands related to the tehran municipality the required water for chitgar lake is 2 million m3 per year and is provided by the kan river estalaki et al 2016 based on an existing agreement between tm and trw the chitgar lake water demand is guaranteed five districts of tehran metropolitan are located in this study area district no 5 9 18 21 and 22 tm can use illegal wells for the irrigation of green spaces which is estimated to be 40 of its total water demand a potential area green spaces can be estimated based on the population of an urban area the acceptable per capita area of green spaces in the region is 20 m2 then tm s main desire is to reach this potential area in all districts a reward function is defined for tm as follows 17 δ g m a x n i area g p o n area g n i 1 25 where δ g m a x n i indicates the maximum increase in green spaces area in time step i area g p o n is the potential area in the final time step and area g n i 1 is the area of green spaces at the beginning of time step i 18 area g n i area g n i 1 x n i δ g m a x n i 19 dg n i area g n i de g the percentage of green spaces development in the time step i and in the district number n is equal to x n i de g is the annual water demand of each one m2 of green space and it is considered to be equal to 1 5 m3 m2 dg n i is the annual water demand of the entire green spaces area of district n at the first step tm must decide about the green spaces expansion and the amount of groundwater extraction in each time step the groundwater consumption includes the allocated water and the illegal extraction of water therefore the reward function of mu is defined as follows 20 reward mu n i 1 dg n i ag n i dg n i area g n i area g m i n n i area g p o n area g m i n n i where ag n i is the consumption of groundwater and wastewater by the municipalities in district n and time space i including illegal groundwater withdrawal area g m i n n i denotes the lowest possible area of green spaces are for region n in time step i the minimum green spaces area is considered based on the area where trees are planted it should be noted that the price of water even the real value may not be the main consideration of tm for the green spaces expansion 5 4 2 ministry of agriculture jahad maj the agricultural activity is mainly located in regions 2 and 3 i e 62 in region 2 and 38 in region 3 based on this classification two agents are considered to represent the farmers in this study area the process of decision making for the agents is the same and just they are located in different locations the crop yields water consumptions and crop prices are presented in table 6 the agents decide on the type of agricultural crops that should be cultivated the percentage of the potential area that can be cultivated and consequently the amount of water needed for the mentioned decisions regarding the reports by trw it is considered that agricultural agents illegal extracted water from the aquifer is annually about 50 million m3 the irrigation costs are about 25 of the total planting and harvesting costs in this area ministry of agriculture jahad 2014 21 reward fa n i 1 df n i af n i df n i y wh n i ppc wh n i cpd wh 4 p ot i pe 1 i z n i y ba n i ppc ba n i cpd ba 4 p ot i pe 1 i z n i y al n i ppc al n i cpd al 4 p ot i pe 1 i z n i ppc wh n i ppc ba n i and ppc al n i are the guaranteed purchase price of one kilogram of wheat barley and alfalfa respectively cpd wh cpd ba and cpd al represent the amount of wheat barley and alfalfa produced kilograms using one m3 of water y wh n i y ba n i and y al n i denote the percentage of the area of wheat barley and alfalfa planted in region n in time step i p ot i and pe 1 i represent the price of one m3 of water for agricultural consumption and the price of one kilowatt hour of electrical energy for pumping one m3 of water from a depth of one m rial z n i is equal to the depth of groundwater table from the land surface in region n in time step i m af n i is equal to the total surface and groundwater allocated to the farmers and including illegal use from groundwater as mentioned above there is two similar types of farmers which by getting feedback from the environment identify their cultivars and water demands are as follows 22 df n i y wh n i area f n eff wh cpd wh y ba n i area f n eff ba cpd ba y al n i area f n eff al cpd al where area f n denotes the area of agricultural land in region n eff represents the water efficiency of each crop wh b a and al stands for wheat barley and alfalfa respectively in this paper an agricultural agent tries to earn more from agricultural production by providing adequate water for this purpose also he considers the feedback from the environment and decides what to plant and how much illegal water be extracted from the aquifer 5 4 3 tehran province water and wastewater company tpww tpww is responsible for water distribution in urban areas mainly for domestic demand the sources of municipal water supply are surface and groundwater groundwater which has a lower quality is used when the surface water is not adequate the total water transferred from the karaj and taleghan dams are allocated to domestic demands and the rest of the domestic demands are provided using groundwater in this case the main challenge for tpww is to decide the share of each groundwater region for domestic water needs with minimum cost domestic demand has priority to use the groundwater the reward function of tpww is as follows 23 reward tp i cost tp i cost tp m a x i 24 cost tp i n 1 3 m 1 3 pe 2 i z n i re tp n i p t i δ h n m x n m i 25 cost tp m a x i n 1 3 m 1 3 i el p r i c e real e i 1 i n f i re tp n i z max n δ h n m x n m i eq 23 indicates the tpww s reward function the cost of pumping and transferring water from the aquifer eq 24 represents the maximum possible cost for tpww to supply water and eq 25 indicates the maximum possible cost to transport water x n m i is the volume of water transferred from aquifer n to supply domestic water need of region m in this case the water is only transferred from the region with lower altitude to the higher one if n m then x n m 0 pe 2 i is the price of one kilowatt hour of electricity for pumping one m3 for one m in time step i for tpww in iran s currency rial also z n i and re tp n i indicate the depth of the groundwater table from the surface of the ground in the beginning of time step i in region n m and the total water extraction from the aquifer n in time step i z max n is the maximum depth of the groundwater level to the surface of the ground at region n p t i is the price transfer of one m3 of water to a zone with an elevation of one m higher elevation δ h n m also denotes the difference between the groundwater table of regions n and m inf is the inflation which is assumed to be equal to the fixed value of 17 5 also i el and price real e i indicate the amount of profit required for water and wastewater and the actual electricity price in the base year respectively 6 sa modeling using sna in this paper sas have been embedded into water resources management models to illustrate the position of the methodology presented in this paper a classification of various considerations in water resources management models is presented in fig 8 as can be seen in this figure the direct or indirect costs and benefits can be considered in the form of optimization problems with economic objective functions or constrained also environmental issues have been widely addressed in water resources management models on the other hand the social considerations are usually neglected or addressed in a descriptive form in water resource management sna can be used to quantify social relations between agents in a community the required data for sna can be collected by conducting interviews with predetermined agents a structured interview is conducted with every stakeholder to gather the required data for sna for the kan river basin and the main agents sna is defined by ahmadi et al 2019 in this study the results of the paper are applied to define the rate of cooperation between the agents and mainly between the agents and trw as the responsible for water allocation as the groundwater is the main challenging water resource where it is possible for the agents to extract illegal water the main question would be about the level the coordination among the agents in the use of the shared aquifer the relations between the agents in the aquifer consumption between different agents are presented in table 7 and fig 9 in eq 9 reward socio is considered as the benefits which are gained considering the suggestions of trw for water allocation and reward indi is considered as the benefits gained by considering the individual desires and interests if the reward socio be higher than reward indi reward socio is considered on the other hand if reward indi be higher than reward socio the agent evaluate to choose his action based on individual benefit and his relation with trw estimated from the sna in the proposed formulation parameter τ is considered as the ratio of current cooperation level to the maximum possible cooperation level 7 physical simulation model for the kan river basin 7 1 surface water simulation model a physical simulation model is developed for the kan river basin to evaluate the results of the management scenarios considering the agents water demands a schematic picture of the study area is presented in fig 10 a water balance model is developed as the simulation model the west flood diversion is a manmade canal for collecting surface water and into the kan river considering the hydrological data the water balance model can be a formula as follows 26 v r o u t i v r i n i a b i a l i pe 1 i v se i r w 1 i pe 2 i r w 2 i pe 3 i a f i where v r o u t i is the volume of the out from the river at downstream in time step i m3 v r i n i is the kan river discharge measured in solughan station in time step i m3 v se i is the inflow volume from the west flood diversion system into the kan river in time step i m3 r w 1 i is the volume of the wastewater of the water treatment plant entering the kan river in time step i r w 2 i is the volume of the waste water out of the town entering the kan river in time step i a b i is the allocated water to the gardens in time step i a l i is the allocated water to the chitgar lake in time step i a f i is the volume of water allocated to agricultural lands in time step i pe 1 i pe 2 i and pe 3 i is the infiltration from the river into the aquifer in the region 1 2 and 3 in time step i respectively during the 25 year planning horizon i e 2017 to 2041 the water allocation policies are developed and evaluated by taking into account the behaviors of different agents at each time step the proposed model is run for the two deterministic and stochastic conditions in the stochastic models input data are generated using historical data in the deterministic condition the long term river discharge measured at the solughan station for the years 1992 2016 are repeated for the years 2017 2041 hydrological data is used after trend removal the amount of water entering the kan river through the west flood diversion system is determined by repeating the data from the years 1992 to 2016 regarding the field observations and groundwater data kan river does not seem to be fed by groundwater a daily water balance model for studying the interaction between the river and groundwater was developed by khorasani et al 2018 using this model the annual infiltrated water to the groundwater is calculated on average the infiltration of regions 3 2 and 1 is 16 24 and 4 million m3 per year respectively a part of the kan river water is transferred by navab safavi flood diversion system and kashanak canal for agricultural uses according to yekom consulting engineers 2009 10 about 4 million m3 per year of the flow in kashanak channel penetrates the groundwater the average recharge of the aquifer annual penetration by the kan river about 40 million m3 khorasani et al 2018 7 2 groundwater simulation model 7 2 1 aquifer s boundary the eastern and western boundaries of the groundwater are determined to be approximately perpendicular to the groundwater flow lines of the study area alborz mountains in the north of the case study can be considered as the northern boundary and the southern border of the aquifer is in line with the eastern valley of the arad koh mountains the aquifer covers most of the 5 9 18 21 and 22 districts of the tehran municipality the groundwater simulation model is developed based on a water balance equation to improve the accuracy of the model the aquifer in the study area is divided into three regions the districts no 5 22 and 70 of district 21 of the tehran municipality area located in region 1 of the aquifer district 9 18 and 30 of district 21 are located in region 2 moreover a part of the eslamshahr urban area is located in the 3rd region of the aquifer also 19 of the industries are located in region 1 69 in region 2 and the rest are located in region 3 62 of the agricultural lands are located in region 2 and the rest are located in region 3 the boundaries of the aquifer regarding the urban districts are presented in fig 11 7 2 2 aquifer water balance model the water balance equation is written for each region of the aquifer as follows 27 b n i 1 s a n b n i s a n di t n i re t n i tr n i 28 di t n i di mu n i di tp n i di fa n i di wo n i di ba n i 29 re t n i r ra rain n i a n r sw n inf sw t r fa a f n i r wo a w n i r gr a g n i r ba a b n i r rw n i r hh 1 a i 1 1 r loss a h n i r hh 1 a i 0 5 r loss 1 r loss a h n i r il 0 5 r loss 1 r loss a h n i 30 tr n n 1 i 365 wh n i wh n 1 i l n l n 1 2 l n l n 1 l n k n l n 1 k n 1 b n n 1 b n i b n 1 i 2 where b n i is the thickness of the aquifer saturation layer of region n in time step i m a n is the area of the region n m2 s denotes the specific yield coefficient of the aquifer di t n i is the total discharge from the aquifer in region n in time step i m3 di mu n i is total discharge by tm from the aquifer in region n in time step i m3 di tp n i is total discharge by the tpww from the aquifer the region n in time step i m3 di fa n i is total discharge by the maj from the aquifer in region n in time step i m3 di wo n i is the total discharge by the mimt from the aquifer in region n in time step i m3 di ba n i is total discharge by the gardeners from the aquifer in region n in time step i m3 re t n i is the total recharge of water to the aquifer in region n and in time step i m3 r rw n i is total amount recharge of wastewater to the aquifer in region n and time step i m3 r ra is the percentage of rainfalls which infiltrates to groundwater rain n i is the annual precipitation in region n and time step i mm r sw n is the volume of percentage of river discharge which infiltrates to the aquifer of in region n m3 inf sw t is the water infiltrated to the aquifer from the kan river m3 r fa is the percentage of water infiltrated to the groundwater after agricultural consumptions a f n i is the total amount of water allocated to the agricultural needs in region n and in time step i m3 r wo is percentage of industrial return flow to the groundwater a w n i is total amount of water allocated to the industrial needs in region n and time step i m3 r gr is the infiltrated water to the groundwater from the irrigation of green spaces m3 a g n i is the total amount of allocated water to the green spaces in region n and time step i m3 r ba is the percentage of allocated water to gardens which is infiltrated to groundwater a b n i is the total amount of water allocated to the gardens in region n and time step i m3 r hh is the percentage of filtered water to the groundwater from domestic return flow a i is the percentage of the population that is covered by municipal sewage collection system in time step i r loss is urban water distribution loss rate 50 unauthorized use of network and 50 network leakage a h n i is the total amount of water allocated to households domestic uses in region n and in time step i m3 r il is the percentage of water infiltrated to groundwater from urban water distribution losses tr n n 1 i is the amount of water transfer between region n and region n 1 in time step i m3 b n n 1 is the average width between the regions n and n 1 m l n is the length of the aquifer in region n the average length from the north to the south of the aquifer m k n is the hydraulic conductivity of the region n in m per day wh n i is the water level in region n and in time step i m eq 27 is the mass balance relation which is applied to each of the regions this model provides the volume of water in each of the regions at each time step during the simulation horizon eqs 28 and 29 give the total groundwater recharge and discharge for each year eq 30 shows the transfer of water between two adjustment aquifer regions over one year the base year of the simulation model is 2016 then the groundwater level at the end of this year is considered as the initial condition of the model the initial conditions of the model and the input parameters are presented in table 8 the main parameters of the aquifer such as the specific yield coefficients and the hydraulic conductivities have been calibrated using a genetic algorithm ga by abdolhay 2018 7 2 3 groundwater quality model the main sources of the pollution of the groundwater in the study area are the agricultural return flows and sewage absorption wells baghvand et al 2016 nitrate which frequently violates the groundwater statements can be considered as a water quality indicator in the study area the main sources of nitrate pollution are wastewater absorption wells besides in the process of nitrification the organic nitrogen and ammonia are synthesized nitrate to simulate the nitrate concentration in the aquifer the model which has been developed and calibrated by khorasani et al 2020 is utilized 8 multi criteria decision making model the borda count social choice method is used to select the best scenario for improving the status of the system the available scenarios for reducing conflict can be divided into two categories of water treated wastewater allocation and management scenarios allocation priorities by the trw are proposed and the higher level upper organizations are responsible for pricing and approval of the implementation of infrastructural projects extension of the municipal wastewater collection system and construction of treatment plans in the decision making model the higher and water supplying institutions rank different scenarios based on their utilities then the borda count method is used to select the best scenario one of the decision makers that chooses the best scenario is trw the trw utility includes improving the status of the aquifer providing water for all consumers and increasing the profit of the water allocation other decision makers are the tehran provincial government tpg and islamic city council of tehran icct the department of environment doe and the ministry of health and medical education mhme mhme and doe can be considered as one decision maker as their main utilities are similar i e improving the quality of the groundwater the groundwater quality indicator in this paper is the average concentration of nitrate as stated in the recognition of the agents the main utility of the tpg in the study area is to provide social security therefore tpg considers the extreme conditions of the system for example if the price of water be so high that one of the agents consumers cannot get enough water and this situation causes social disputes this would have a negative impact on the utility of the tpg 9 results and discussion in this paper 63 main scenarios are considered in this paper table 4 besides the main scenarios each of the scenarios is run for three rising price conditions and five policies for wastewater use in other words each row in table 4 contains 15 different scenarios the study area is modeled for four different modes and the best scenario for each mode is presented deterministic model without sa deterministic model with sa stochastic model without sa stochastic model with sa as the key question is the allocation of water and treated wastewater to the agents which is mostly decided annually a yearly time step is considered for the decision making policies however physical simulation models have shorter time steps for example the simulation of nitrate concentration is evaluated weekly and finally the annual concentration of nitrate is considered for the assessment of aquifer water quality corresponding to a scenario 9 1 first mode deterministic model without sa to choose the best scenario using the borda count method each decision maker ranks the scenarios according to his utilities in table 9 the code of each scenario is defined as follows the first number is referred to the allocation scenario the second number shows to the price conditions and the third number denotes the decision about the use of wastewater for the groundwater recharge after ranking the scenarios by decision makers the best scenario is selected using the borda count method in the first mode scenario 311 is selected as the best one in this scenario the treated wastewater should be allocated is the industries and then urban green spaces the rest of the treated wastewater is discharged into wells to recharge the groundwater in this scenario groundwater after providing the drinking water is allocated to the green spaces industries and agricultural demands respectively more details about the best scenario such as the water allocation to each of the agents groundwater table fluctuations and nitrate concentrations in three regions the water demands the allocated water by the trw and total water consumption including allocated water and illegal water extraction for agricultural sector in region 2 and 3 are presented in table 10 and figs 12 15 9 2 second mode deterministic mod with sa in this case after ranking the scenarios using the borda count method scenario 111 is the best one in the best scenario the priority is to allocate wastewater to the green spaces and industries and then feeding the aquifer through the absorption wells groundwater is also allocated in descending order to drinking demands industries agricultural needs and green spaces demands scenarios 311 and 312 also have also good results comparison of the best scenarios in the first and second modes illustrates that the scenarios which are corresponding to 30 increase in water and electricity prices per year and discharge of 50 100 of wastewater into the wells are suitable by comparing the results of the best scenario with and without sa it can be concluded that the water level in the case of sa considerations is in a better condition the improvement of the aquifer condition in the second case is due to the coordination of the agents with the trw and their less illegal water extraction this means that considering sa and improving sa conditions can lead to a better solution in common pool resources the selected scenarios and their characteristics are presented in tables a 1 11 and figs 16 17 a 1 and a 2 9 3 third mode stochastic model without sa given that in two previous modes the scenarios with a discharge of 100 or 75 of wastewater into the kan river had not good rankings these scenarios are not considered in the stochastic model where uncertainties are taken into account thus 24 scenarios are eliminated and decision options are limited to 39 scenarios the borda count method is used to rank the solution of the stochastic model tables a 2 12 and figs 18 19 a 3 and a 4 the results show the scenario 312 is the best one in this scenario wastewater is allocated to the industries and green spaces 75 and 25 of the remaining treated wastewater is used to feed the aquifer through adsorption wells and discharged into the kan river to recharge the aquifer indirectly respectively the water allocation priorities from the groundwater are drinking green spaces industries and agricultural lands respectively scenario 321 and scenario 331 have also acceptable results scenario 321 and scenario331 with 40 and 50 annual increase in prices can lead to drastic decrease in the area of agricultural lands in the study area and cause some issues related to the social security therefore the high level institutions should consider alternative livelihoods for the farmers if they choose scenario 321 or scenario 331 be chosen 9 4 the fourth mode stochastic model without sa in this case after calculating the rank of all scenarios it becomes clear that scenario 312 is the best one scenarios132 and 311 have also provided acceptable results the good rankings of the scenario 311 and scenario 132 with 50 annual increase in prices show that the social security would be at risk due to significant decrease in cultivated area but the rest of criteria have high values in these scenarios the high level institutions should consider alternative livelihoods for the farmers the scenarios and their respective results are presented in tables a 3 13 and figs 20 21 a 5 and a 6 10 summary and conclusion in this paper by getting some the insights from the rl approach a more realistic methodology was presented for incorporating social and behavioral aspects in developing water and treated wastewater allocation policies in urban areas one of the most important findings of this paper is showing the possibility of incorporating sa in water resource management models it was also shown that the sna can be used to transform the social relationships among agents into some objective social parameters in this paper the western part of the tehran metropolitan area which includes several environmental issues and different stakeholders with conflicting utilities was considered as the case study a combined physical behavioral model was developed which can quantify and incorporate the social parameters in the decision making process in this study four modes were considered to investigate the water resource management problem in the study area in the first mode the utilities of the agents were identified and then using the q learning algorithm and a water balance based model water quality and quantity conditions were simulated based on the agents decisions and actions in the second mode the sa was considered in the behavioral model using the outputs of the sna in the q learning algorithm the third and fourth modes were studied by extending the first and second modes to incorporate hydrological uncertainties in the case study 63 management scenarios were developed and the four proposed approaches were evaluated and compared the developed management scenarios consider almost all possible scenarios for managing urban water resource allocation for each mode the best scenario is chosen using the borda count sc method in all studied modes drinking water demands are almost fully supplied in other sectors by considering the sa the allocated water to demands is slightly decreased and this leads to a better condition for the groundwater especially in region 3 where 9 m rise in groundwater table level is obtained during the planning horizon comparing the best scenarios of the first and second modes illustrates that the scenarios which are corresponding to 30 increase in water and electricity prices per year and use of 50 100 of treated wastewater for recharge of aquifer using absorption wells are more acceptable by comparing the results of the best scenarios with and without sa it can be concluded that the groundwater tables in all regions have been almost increased where sa is included in the best scenario of the first mode the depth of groundwater tables the first second and third regions have respectively changed from 95 to 66 m 98 to 85 m and 42 to 27 m during the planning horizon in the best scenario of the second mode the depth of groundwater tables the first second and third regions have respectively changed from 95 to 70 m 98 to 82 m and 42 to 38 m during the planning horizon besides the nitrate concentration in the first mode has changed from 42 to 14 mg l 18 to 26 mg l and 18 to 5 mg l in the first second and third regions respectively a similar improvement in the nitrate concentration of the aquifer can been seen in the results of the second mode it was also shown that incorporating sa for tackling water and environmental issues in common pool system is very important as the social relations in this case study are not complete and ideal the obtained results can be improved by strengthening social relations and the level of cooperation among the agents the first two modes were also extended by considering hydrological uncertainties under these circumstances the water extraction rates for some of the agents are higher than the deterministic conditions the main reason is the conservative behaviors of the agents in uncertain situations this study is one of the first steps to quantify and incorporate social parameters in water and treated wastewater allocation in urban areas in future works the proposed methodology can be extended to evaluate and improve the level of cooperation diffusion in water and environmental systems credit authorship contribution statement mohammad javad emami skardi conceptualization methodology writing review editing reza kerachian methodology supervision writing review editing ali abdolhay conceptualization software validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper annex 
5553,the accurate prediction of bedload transport in gravel bed rivers remains a significant challenge in river science however the potential for data mining algorithms to provide models of bedload transport have yet to be explored this study provides the first quantification of the predictive power of a range of standalone and hybrid data mining models using bedload transport data collected in laboratory flume experiments the performance of four types of recently developed standalone data mining techniques the m5p random tree rt random forest rf and the reduced error pruning tree rept are assessed along with four types of hybrid algorithms trained with a bagging ba data mining algorithm ba m5p ba rf ba rt and ba rept the main findings are four fold first the ba m5p model had the highest prediction power r 2 0 943 rmse 0 061 kg m 1 s 1 mae 0 040 kg m 1 s 1 nse 0 945 pbias 1 60 followed by m5p ba rt rt ba rf rf ba rept and rept all models displayed very good performance except the ba rept and rept model which were satisfactory second the m5p ba rt and rt models underestimated and the ba m5p ba rf rf ba rept and rept models overestimated bedload transport rates third flow velocity had the most significant impact on bedload transport rate pcc 0 760 followed by shear stress pcc 0 709 discharge pcc 0 668 bed shear velocity pcc 0 663 bed slope pcc 0 490 flow depth pcc 0 303 median sediment diameter pcc 0 247 and relative roughness pcc 0 003 fourth the maximum depth of tree was the most sensitive operator in decision tree based algorithms and batch size number of execution slots and number of decimal places did not have any impact on model prediction power overall the results revealed that hybrid data mining techniques provide more accurate predictions of bedload transport rate than standalone data mining models in particular m5p models trained with a bagging data mining algorithm have great potential to produce robust predictions of bedload transport in gravel bed rivers keywords bedload flume experiment data mining river artificial intelligence abbreviation and symbols rt random tree m5p m5 prime rf random forest rept reduced error pruning tree ba bagging pcc pearson correlation coefficient ann artificial neural network anfis adaptive neural fuzzy inference system svm support vector machines gp genetic programming fl fuzzy logic ffnn elm feed forward neural network extreme learning machine lmt logistic model tree nbt naïve bayes trees ibk instance based k nearest neighbours hec ras hydrologic engineering center s river analysis system d 50 median sediment grain diameter d sediment diameter q flow discharge v flow velocity y flow depth s bed slope rr relative roughness τ shear stress v shear velocity ρ water density g gravitational acceleration r hydraulic radius q bedload sediment transport rate g mass of collected sediment in trap b flume width t sampling duration rmse root mean square error r 2 coefficient of determination mse mean absolute error nse nash sutcliffe efficiency pbias percent bias xo observed values xe predicted values x 0 mean observed values x e mean predicted values sd standard deviation mars multivariate adaptive regression splines sdr standard deviation reduction t plane rooted decision tree with m nodes c class of a plane rooted tree cm random tree sets ω t weight function k out degree ϕ nonnegative numbers a t generating function 1 introduction bedload transport particularly of coarser sediments is one of the main drivers for the morphological change of gravel bed rivers thus the quantification of bedload transport rate is of paramount importance for river engineers and fluvial geomorphologists interested in river management wilcock 1998 and landscape evolution howard 2008 in the field the measurement of bedload transport is challenging and often expensive especially during flooding and is associated with estimates of rate with a high uncertainty mao 2012 graf 1971 laboratory flume experiments are more commonly used because of the ability to carefully control boundary conditions and to perform more precise measurements allowing bedload transport formulas to be developed over a range of flow and bed conditions e g einstein 1950 engelund and hansen 1967 meyer peter and müller 1948 wilcock and crowe 2003 however these experimental investigations have their disadvantages 1 they can be costly and time consuming 2 they are a simplification of a natural gravel bed river e g use of equilibrium sediment transport conditions and steady and uniform flows 3 are scaled versions of a natural system and thus problems exist in trying to correctly scale flow and sediment properties and 4 the magnitude of transport that can be reproduced is limited one consequence is that bedload transport formulas that are developed from flume experiments can be associated with a high degree of predictive uncertainty mao 2012 a suite of empirical mathematical and numerical approaches have been developed for bedload transport prediction and these approaches have their weaknesses extensive data is required to build calibrate and validate these models particularly if the model is process based furthermore there is much complexity and difficulty in performing model parameterization and calibration if the physics is not well understood which is often the case because of the non linear dynamics of bedload transport hamel et al 2017 kisi et al 2012 one example is in the use of the most popular and widely used model in river science the hydrologic engineering center s river analysis system hec ras model although this model has been used successfully implemented in numerous studies it suffers from the need for approximations and simplifications that can introduce errors in the prediction of bedload transport 1 the flow is often modeled using a depth averaged approach 2 the law of the wall formula is fed with an average shear stress value 3 transport capacity equations are used to predict sediment transport under the assumption of unlimited sediment supply conditions and 4 the determination of the correct value of some of the model parameters such as the active layer depth and the manning roughness coefficient is problematic without detailed observations of the river being modeled ghafouri azar et al 2012 mustafa et al 2017 shahiri et al 2016 considering these challenges alternative approaches to the use of empirical mathematical and numerical methods should be explored recently the advent of artificial intelligence algorithms based on machine learning and data mining techniques are providing new insights in multiple areas of science including water resources and geoscience these algorithms attempt to deduce the optimal relationship between the inputs i e significant conditioning factors and the target i e output parameters mainly operating as a black box type non linear statistical model yaseen et al 2017 most phenomena within a watershed including sediment transport are relatively complex and they cannot be predicted easily khosravi et al 2018a thus in most situations the applied model must be versatile flexible and possess a non linear modeling structure artificial intelligence algorithms meet these requirements ebtehaj and bonakdari 2013 applied artificial neural network ann algorithms for predicting sediment transport in sewers revealing that ann had a higher prediction power than existing empirical transport formulas similar results have also been found within other areas of hydrology and hydraulics melesse et al 2011 kisi et al 2016 however ann algorithms have poor prediction power when the range of the testing dataset is outside of the range of the training data melesse et al 2011 kisi et al 2012 and they require a long term dataset to achieve a reasonable result thus to solve this weakness ann algorithms have been ensembled with fuzzy logic fl algorithms to create adaptive neural fuzzy inference system anfis models ebtehaj and bonakdari 2014 used such a model for predicting sediment transport in sewers showing that anfis models had greater accuracy than empirical sediment transport rate equations however similar to ann anfis algorithms suffer from one important disadvantage the lack of a systematic approach in the design of fuzzy rules and in the choice of membership functions variables tien bui et al 2016 khosravi et al 2018b kisi et al 2012 compared the predictions of daily suspended sediment load made by anfis ann support vector machines svm models and a genetic programming gp model in cumberland river in the u s they revealed that gp provided more accurate predictions than the anfis ann and svm models thus meta heuristic or evolutionary algorithms e g particle swarm optimization whale optimization algorithm have been hybridized with anfis algorithms to overcome this weakness and improve the performance of anfis models for example anfis meta heuristic hybrid models have been applied to the prediction of groundwater potential mapping khosravi et al 2018b termeh et al 2019 chen et al 2019 flood susceptibility mapping tien bui et al 2018a b and sediment transport rate prediction qasem et al 2017 revealing that this hybrid algorithm has a higher prediction power than anfis the use of other standalone and hybrid algorithms has also been explored in the field of sediment transport for example ebtehaj et al 2016a applied a hybrid model of feed forward neural network extreme learning machine ffnn elm for open channel sediment transport revealing that this model outperformed gp and empirical sediment transport models similarly they found wavelet support vector machine svm wavelet algorithms had a better prediction performance than svm and existing empirical equations ebtehaj et al 2016b in the modeling of daily dissolved oxygen concentration in three us rivers heddam and kisi 2018 applied least square svm multivariate adaptive regression splines mars and m5 model tree m5t algorithms their study showed the dissolved oxygen concentrations were successfully predicted using all three models and that the best performing model differed from one measurement station to another recently new artificial intelligence algorithms notably data mining algorithms have been developed and applied in the fields of hydrology and hydraulics these techniques do not seek to explain the physical processes and mathematical reasoning for changes in environmental behavior but to recognize statistical patterns both expected and unexpected within data these patterns can highlight environmental relationships in space and time that may unveil critical details about behavior reveal previously unsuspected relationships or mitigate uncertainty in estimates thus these types of techniques are at their most beneficial in situations when process based models cannot be applied e g lack of understanding of underlying physics of the process or that suffer from inadequacies due to the limitation of data therefore artificial intelligence methods mean that some parameters which are difficult or expensive to measurement such as bedload transport could be easily predicted using other factors that are more readily available such as discharge and bed slope such methods could be particularly attractive to developing nations where extensive measurement networks do not exist and there can be a lack of highly skilled end users to build and run more complex process based models recently some data mining algorithms including random forest rf logistic model tree lmt and naïve bayes trees nbt algorithms have been applied for flood susceptibility mapping khosravi et al 2018c groundwater vulnerability assessments khosravi et al 2018d and landslide susceptibility mapping pham et al 2018 the performance accuracy and reliability of these methods for spatial mapping have been proven in these fields however these algorithms are rarely used for prediction and forecasting not only for bedload transport rate prediction but more generally in the field of geosciences only a few examples of their use exist including the application of rf and random tree rt for solar radiation prediction sherafati et al 2019 the reduced error pruning tree rept instance based k nearest neighbours ibk and m5p model tree techniques for suspended sediment load prediction khosravi et al 2018a and modeling dissolved oxygen concentration in rivers heddam and kisi 2018 thus a significant gap exists in the application of novel data mining algorithms for bedload transport prediction and in the identification of the most flexible and accurate algorithm the present paper therefore aims to fill this gap in understanding by achieving the following objectives 1 to experimental measure the bedload transport rate under uniform flow conditions 2 produce predictions of bedload transport rate using novel data mining techniques namely the m5p model tree random tree rt random forest rf and the reduced error pruning tree rept along with four types of hybrid algorithms trained with a bagging ba data mining algorithm ba m5p ba rf ba rt and ba rept 3 compare the predictive power of these data driven models and 4 perform a sensitivity analysis of the driving variables used in each model this study is the first to apply a diverse range of data mining models to the prediction of bedload transport the research offers new insight into which data mining algorithms offer the potential to provide relatively cheap and fast predictions of bedload transport in poorly monitored rivers where understanding of the physical processes at play may not be well understood 2 materials and methods 2 1 flume setup and experimental procedure a total of 72 bedload transport experiments have been carried out in a 12 m long and a 0 5 m wide and deep tilting flume fig 1 a tailgate at the downstream end was adjusted to create uniform flow conditions over the mobile section of the flume informed by water depth measurements made using two mechanical point gauges and three ultrasonic sensors a 4 m upstream and 2 8 m downstream section of the flume was artificially roughened with the same sized gravel as the mobile section to prevent upstream scour promote the development of fully developed flow within the mobile section of the flume and to reduce the backwater effect of the tailgate the central 5 m section of the flume contained screeded loose sediment with a thickness equal to 5 6 d 50 d 50 is the median grain diameter of the sediment a bedload trap 0 5 m wide and 0 2 m long was installed at the downstream end of the flume to sample the transported sediment through time four types of rounded and naturally shaped uniform sized sediment were investigated d 50 of 5 17 10 35 14 and 20 7 mm with a specific gravity of 2 39 2 38 2 90 and 2 55 respectively before each experiment the slope was set tailgate raised the pump turned on and the flow slowly allowed to fill the flume without any disturbance to the bed the tailgate was then opened the flow discharge set and after the establishment of uniform flow sediment transport sampling commenced the time of each experiment varied from 1 to 30 min and the frequency of bedload sampling varied from several seconds to several minutes both were dependent upon the bedload transport rate the higher the rate the higher the sampling frequency and the lower the sampling duration the flow discharge q velocity v depth y bed slope s and sediment diameter d were measured for each experiment and these parameters were used to calculate relative roughness rr d y shear stress τ ρgrs and shear velocity v τ ρ where ρ is the water density g is the gravitational acceleration and r is the hydraulic radius the collected bed sediment was dried and weighed for calculation of the bedload sediment transport rate q in kg m 1 s 1 as follows 1 q g b t where g is the mass of collected sediment kg b is the flume width 0 5 m and t is the sampling duration s more information about the flume set up and sediment sampling can be found in khosravi et al 2020 2 2 development and application of data mining techniques 2 2 1 sample size 72 experiments were undertaken 50 experiments were used for model building and 22 were used for model validation there is no universal guideline for the training testing ratio but a ratio of 70 30 is most commonly used in spatial and time series modeling khosravi et al 2018a d pham et al 2017 given the experimental dataset is relatively small this approach was combined with a 10 fold cross validation technique this technique is summarized in fig 2 each experimental dataset was used 10 times to provide 720 sets of data in each iteration a different section of the dataset was considered as training and testing dataset 2 2 2 preparation of dataset eight factors known to have a strong correlation with bedload transport rate were used to perform the data driven modeling d 50 s y v q rr v and τ the correlation of these variables with bedload transport was investigated using the pearson correlation coefficient pcc a total of 10 input variable combinations were constructed and investigated these were assessed to determine the input combination that produced the most accurate prediction of bedload transport rate 2 2 3 model description 2 2 3 1 random forest rf the rf is a flexible nonparametric ensemble learning technique first developed by breiman 1996 and is a hybrid procedure between a decision tree and a regression breiman et al 1984 the model is commonly used for both classification and regression problems for example in drought forecasting deo et al 2017 vegetation mapping prediction for changes in climate iverson et al 2004 and soil moisture prediction prasad et al 2018a b in rf each decision tree is constructed by selecting randomly a subset of a sample selecting variables from a training dataset by using a deterministic algorithm mutanga et al 2012 deo et al 2017 and using a random bootstrap sample for the training dataset to build multiple trees breiman et al 1984 the rf algorithm is trained by means of several steps 1 a bootstrap sample is drawn from the training data 2 a decision tree is grown for each bootstrap sample by selecting the best split among the subset selected randomly from all the features and the tree is then grown to the maximum size with no pruning back 3 these aforementioned steps are repeated until a sufficiently large number of trees are created mutanga et al 2012 the general structure of a rf model is shown in fig 3 2 2 3 2 m5p the m5p also known as m5 tree model is a well known piecewise linear tree based model used to predict continuous variables and was first introduced by quinlan 1992 recent applications of m5p models can be found in several studies such as in the prediction of dissolved oxygen heddam and kisi 2018 and suspended sediment load khosravi et al 2018a m5p is a flexible algorithm because the decision tree constructed by m5p can have multivariate linear models zhan et al 2011 the m5p tree is developed through three main steps 1 constructing the tree 2 pruning the tree and 3 smoothing the tree in the process of growing the tree using the m5p the standard deviation reduction sdr is maximized to achieve the best model performance the sdr is expressed as follows zhan et al 2011 2 sdr s d e i e i e x s d e i where e is defined as the set of cases ei is defined as the ith subset of cases which result from splitting the tree sd e is defined as the standard deviation of e and sd ei is defined as the standard deviation of ei the tree pruning step is started after the tree is constructed to eliminate undesired sub trees the purpose is to avoid data over fitting problems that occur during the construction of the tree over fitting problems arise when the model is very accurate with the training dataset but fails with the testing dataset in this pruning step the attributes are reduced one by one to minimize the estimated error the smoothing step is started after the tree pruning step and is performed to compensate for the sharp discontinuities between adjacent linear models at the leaves of the pruned tree wang and witten 1997 this step is achieved by using the leaf model to compute the predicted value which is then filtered along the path back to the root node wang and witten 1997 2 2 3 3 reduced error pruning tree rept the rept model is well known as a fast decision tree method that constructs a decision tree to reduce the error in the prediction mohamed et al 2012 first the model utilizes the regression tree logic to create multiple trees in various iterations jayanthi and sasikala 2013 second the model chooses the best tree the one with the least error from multiple trees third the reduced error pruning rep technique is used to prevent over fitting problems finally the algorithm handles missing values using a c4 5 algorithm and sorts the values of numerical attributes using the embedded method the rept algorithm uses a stopping criterion the sum of squared errors to build a tree with maximum information gain the stopping criterion is expressed as follows quinlan 1987 3 s eeleaves r t q c u c where qc is defined as the class prediction and uc is the leaf within variance 2 2 3 4 random trees rt the rt model is formed by a stochastic process and builds the decision trees on a random subset of columns the rt works in a similar manner to traditional decision trees but has one key exception only a random subset of attributes is available for each split of the training dataset the algorithm is a fast and flexible tree learner and has been applied to solve a broad range of problems such as in philology najock and heyde 1982 and medicine busch et al 2009 let t be a plane rooted decision tree with m nodes referred to as a family tree in which the profile of the tree might be described by the number of the nodes or the number of the leaves suppose that c is a class of a plane rooted tree and each t c the size t by the number of nodes t includes a weight function ω t expressed as follows drmota and gittenberger 1997 4 ω t k 0 α k m k t where α k k 0 is defined as the non negative numbers and mk t is defined as the number of the nodes υ t with out degree k thereafter set a m t t m ω t then the corresponding generating function a t m 0 a m t m must satisfy the functional equation as follows drmota and gittenberger 1997 5 a t t φ a t where φ x k 0 φ k x k in the final step sets c m t c t m are equipped with the probability distribution caused by the weight function ω t drmota and gittenberger 1997 2 2 3 5 bagging ba ba is one of the most effective ensemble methods to solve classification and regression problems the method is able to weaken the defects of component learners and raise the recognition rate of unstable classifiers thus it can enhance the predictive capability of the weak learners breiman 1996 in the ba algorithm the training process is carried out through three main steps 1 selecting randomly and independently the data from the primary training dataset this step is repeated several times to create a certain number of sub datasets 2 designating the base learning algorithm to train the various sub datasets and gain the sequence of predictive function and 3 vote for the outcomes and select the final outcome with the most votes bauer and kohavi 1999 the ba method has been applied to improve many base learners such as trees mert et al 2014 support vector machines pham et al 2018 and naïve bayes trees pham and prakash 2018 in this study the ba has been used to train the m5p rf rt and rept base learners for bedload transport rate prediction the general structure of a bagging model is shown in fig 4 2 3 sensitivity analysis there are two main steps in prediction using ai algorithms i determination of the best input variable combination and ii identifying the operator s optimum values each combination of input variables has a different impact on the modeled result and thus the most effective input combination should be determined there are no optimum operator values which work globally for model calibration hence to enhance the prediction power of each algorithm these values need to be set after the determination of the best input combination at first default values of each operator were considered and then based on this result lower and higher values were selected to find the optimum value the best input variable combination and optimum operator values were achieved by minimizing the root mean square error rmse using trial and error during the testing phase also a sensitivity analysis was carried out to identify which input variables and model operators had the greatest effect on the predicted transport rate 2 4 model evaluation the five most commonly used metrics for assessing the performance of models were used coefficient of determination r 2 rmse mean absolute error mae nash sutcliffe efficiency nse and percent bias pbias these metrics were calculated as follows moriasi et al 2007 dawson et al 2006 legates and mccabe 1999 6 r 2 i 1 n x o x o x e x e i 1 n x o x o 2 i 1 n x e x e 2 2 7 rmse 1 n i 1 n x e x o 2 8 mae 1 n i 1 n x e x o 9 nse 1 i 1 n x e x o 2 i 1 n x o x o 2 10 pbias i 1 n x o x e i 1 n x e 100 where xo and xe are observed and predicted values x 0 and x e are mean observed and predicted values respectively and n is the number of data points the performance classification of the model evaluation metrics is shown in table 1 for a visual analysis and assessment of the applied models taylor diagrams and box plots were used one distinct advantage of the taylor diagram is that it benefits from the use of the two most common correlation statistics correlation coefficient cc and standard deviation sd taylor 2001 the closer the predicted value to the observed value in terms of the cc and sd the higher the prediction capability sigaroodi et al 2014 the advantage of a box plot is that it can show how well a model predicts extreme median and quartile values 3 results 3 1 determination of the best input variable combination the pcc values in table 2 show that flow velocity had the highest impact on bedload transport rate pcc 0 760 followed by shear stress pcc 0 709 flow discharge pcc 0 668 shear velocity pcc 0 663 bed slope pcc 0 490 flow depth pcc 0 303 d 50 pcc 0 247 and relative roughness pcc 0 0033 based on these pcc values ten different input combinations were constructed and investigated 1 bl f q 2 bl f v 3 bl f v τ 4 bl f v τ q 5 bl f v τ q v 6 bl f v τ q v s 7 bl f v τ q v s y 8 bl f v τ q v s y d50 9 bl f v τ q v s y d50 rr 10 bl f v τ v s y d50 rr this approach starts with the variable with the highest pcc q and then variables with lower pcc s are added into the combination until the variable with the lowest pcc rr is finally added in each model all 10 combinations were used in the training and testing phases in the testing phase rmse and pcc values were calculated to determine the optimal combination for building the final version of the model table 3 shows that due to the different structures of each model the optimal input variable combination differs between the models input combination 10 in which all variables except q were considered was the best input combination for rf rt and ba models but input combination 8 in which all variables except rr were considered was the best for m5p and rept models adding rr to the input combination caused an increase the error in most of the cases m5p rept rt models but with the rf and ba models it produced a better performance compare the input combinations of 8 and 9 including q in the input combination caused an increase in model error compare the input combinations of 3 and 4 this results explains why input combination 10 was created with all input variables except q the input combinations constructed with variables with high pcc values 3 4 5 and 6 did not produce a good agreement between observed and predicted values indeed by adding d50 into a combination which had a low pcc the prediction power of the models increased significantly compare the input combinations of 7 and 8 a comparison of input combinations 8 10 with 2 6 shows overall that including variables with low pcc such as rr and removing variables with high pcc improved prediction performance thus these results confirm that input variable selection must be carried out on a trial and error basis 3 2 model performance and sensitivity analysis 3 2 1 rf model twelve operators were considered for the rf model and their optimum values were obtained using a trial and error approach these operators were bag size percent percentage of the training set used batch size preferred number of instances to process if batch prediction is being performed maximum depth of tree number of decimal places used in the output of numbers in the model number of execution slots used for constructing the ensemble number of features randomly chosen attributes number of iterations to be performed seed number break ties randomly when several attributes look equally good calculation of out of bag error de bug and do not check capabilities classifier may output additional information to the console if set the optimum values for these operators were 100 100 8 2 2 0 100 1 no no no and no respectively the sensitivity analysis shows that the maximum depth of tree had the biggest impact on the rmse of the rf model fig 5 followed by bag size percent number of features number of seeds number of iterations batch size and number of execution slots respectively 3 2 2 m5p model six main operators were established in the structure of the m5p model these parameters were batch size minimum number of instances to allow at a leaf node number of decimal places used in the output of numbers in the model build regression tree whether to generate a regression tree rule instead of a model tree rule do not check capabilities and unpruned whether unpruned tree rule is to be generated the optimum values for these operators were 100 4 2 no no and no respectively the sensitivity analysis shows that none of these operators had an impact on the predictive capability of the m5p model and thus the default values were used fig 6 3 2 3 rept model eight main operators were considered in the rept model batch size initial count initial class value count maximum depth minimum number the minimum total weight of the instance in a leaf minimum variance probability the minimum proportion of variance on all the data that need to be presented at a node in order for splitting to be performed in a regression tree number of decimal places number of folds the amount of data used for back fitting and number of seeds the optimum values for these operators were 100 1 1 2 0 001 2 3 and 1 respectively all of the operators except the initial count and batch size had a noticeable impact on the predictive power of the rept model fig 7 the most sensitive operator was the maximum depth of tree same as observed with the rf model 3 2 4 rt model eight operators were used in the rt model k value sets the number of randomly chosen attributes batch size maximum depth minimum number the minimum total weight of the instance in a leaf minimum variance probability number of decimal places number of folds and number of seeds the optimum values for these operators were 2 100 1 1 0 001 1 0 and 3 respectively fig 8 all the operators except the batch size and number of decimal places had a noticeable effect on model performance fig 8a the maximum depth of tree and minimum variance probability had the most significant impact fig 8b and c 3 2 5 ba model six operators were used in the ba model bag size percent batch size number of decimal places number of execution slots number of iterations number of seeds the optimum values for these operators were 20 100 2 0 12 and 0 respectively fig 9 of these six operators only the number of iterations most sensitive operator and the number of seeds had a significant effect on the rmse of the ba model 3 3 model performance assessment after the determination of the most effective input variable combination and the optimum operator values each algorithm was trained by a training dataset and evaluated by a testing dataset since the models were built by a training dataset this evaluation can only show how well the constructed model fits the testing dataset and cannot be used for model validation khosravi et al 2016 chen et al 2019 an assessment of the predictive capability of the eight developed models o is shown in table 4 the r 2 values show that the ba m5p model had the highest prediction power 0 943 followed by the m5p 0 932 ba rt 0 910 rt 0 890 ba rf 0 833 rf 0 784 ba rept 0 596 and rept 0 570 according to the classification of performance for this metric legates and mccabe 1999 moriasi et al 2007 ayele et al 2017 all models had a very good performance except the ba rept and rept models which had satisfactory performance since r 2 is standardized for differences between the mean and variance of observed and predicted values it is sensitive to outliers and should not be used for model evaluation alone legates and mccabe 1999 shiri and kişi 2012 thus other evaluation metrics were considered in terms of rmse mae and nse the ba m5p was superior to the other models using the nse values all of the applied models had a very good performance except the ba rept and rept which were satisfactory and acceptable respectively according to the pbias values all the models had a very good performance except ba rt rt and rept the m5p and ba rt and rt models underestimated shown by positive pbias values and the ba m5p ba rf rf ba rept and rept models overestimated the bedload transport rate a taylor plot of model performance shows that the ba m5p model had the highest performance because the predicted standard deviation of bedload transport rate is the closest to the standard deviation of the observed data and the correlation is also the highest fig 10 considering all the evaluation metrics together the ba m5p and rept moidels had the highest and the lowest prediction capability a further comparison between observed and predicted bedload transport rate is shown in figs 11 and 12 both figures confirm that the ba m5p model predicts the bedload rate more accurately than the other models generally the results show that the prediction power of the hybrid algorithms mostly depends on the base algorithm i e m5p rf and so on for example the incorporation of the bagging algorithm increased the prediction power of rept but the ba rept algorithm still had a lower prediction power than m5p rf and rt as standalone algorithms the box plots of bedload transport rates fig 13 show that the ba rt and rt models produced a perfect match for the maximum observed maximum transport rate 1 06 kg m 1 s 1 and ba rept and rept 1 05 kg m 1 s 1 and ba m5p 1 03 kg m 1 s 1 produced a close match the other algorithms could not predict the rate accurately the same result was observed for predicting the minimum observed transport rate these two results reveal that although m5p is overall the most accurate for the testing dataset it cannot predict extreme values well however when trained with a bagging data mining algorithm its performance in predicting extreme values is much improved the ba rf and rf models predict the observed values in the third quartile better than the other models the ba rt and rt better predict the median values and the ba rept and rept models better predict values in the first quartile 4 discussion the determination of the best input variable combination and optimum operator values is one of the most significant steps in producing an accurate data mining model some researchers have determined the best input combination using a principal component analysis approach or according to the strongest pcc barzegar et al 2016a b however the current paper show these approaches might not be the best to take due to nonlinearity between variables the variables with low pcc enhanced the prediction power of the models and the most effective combination varied from only model to another thus a range of different input variable combinations must be considered in the optimization of data mining models the m5p rf rt and rept standalone models had contrasting prediction performance given the same bedload dataset was used to test performance this contrast results from a difference in each model s structure loh 2011 particularly their flexibility computing capability complexity and ability to reduce over fitting kisi et al 2019 the hybrid models built using a bagging algorithm in most of the cases had a higher prediction power than standalone models because hybrid models are more flexible than standalone models and have a nonlinear structure de ath and fabricius 2000 these two model properties are particularly important in the prediction of bedload transport because of the nonlinearity between variables in particular the bagging algorithm benefits from ensemble learning in its structure multiple weak learners which outperforms a single strong learner this learning helps to reduce variance and avoid the over fitting problem caused by the use of a bootstrap procedure given this is the first study to examine the prediction performance of these data mining algorithms for the prediction of bedload transport rate no direct comparisons exist however the improved performance of hybrid bagging models conforms with previous tests of data mining algorithms in other fields khosravi et al 2018a khozani et al 2019 sharafati et al 2019 ghorbani et al 2017 yaseen et al 2017 furthermore other studies in the prediction of water quality nitrate ammonia and phosphate shkurin 2015 suspended sediment load and francke et al 2008 and solar radiation sun et al 2016 sharafati et al 2019 have also found rf and rt algorithms have very good prediction power the m5p model was the best performing standalone and hybrid model because it is a decision tree based algorithm that does not have a hidden layer in its structure kisi et al 2012 and thus can learn efficiently and does not require any assumptions about the type of data distribution the main advantage of the m5p algorithm over other decision tree algorithms is that m5p has an ability to handle data without any vagueness as well as handle very large datasets with a large number of dimensions and attributes quinlan 1992 also the m5p model benefits from model trees that are much smaller than regression trees and have proven to be more accurate quinlan 1992 although rf and rt models have some advantages such as being simple flexible and easy to use they have one severe limitation the construction of a large number of trees can make the algorithm slow and ineffective for real time predictions and a more accurate prediction requires more trees in addition the rf modle suffers from poor performance for regression subjects especially when the range of testing data is out of the range of the training dataset overall the results show that m5p models especially those trained with a bagging data mining algorithm have great potential to produce robust predictions of bedload transport in gravel bed rivers such models could be particularly useful in data poor watersheds especially in developing nations where technical skills and understanding of the processes occurring in the watershed may be lacking the m5p models could potentially be used alone or replace process based models because they represent well the highly stochastic behavior of sediment transport and are inexpensive to build and run this type of data driven model could also complement existing process based models in well gaged watersheds to recognize patterns within collected data that could unveil critical details about behavior reveal previously unsuspected environmental relationships or mitigate uncertainty in model estimates future studies should consider the performance of these algorithms in the prediction of bedload transport in more complex conditions than those studied here such as with poorly sorted sediments water worked beds that mimic better the surface topographies of natural coarse grained rivers cooper and tait 2010 unsteady flows and in non equilibrium transport conditions in the case of an upstream sediment supply mao et al 2012 5 conclusions the accurate prediction of bedload transport rate is vital for understanding gravel bed river morphodynamics due to the non linear and chaotic behavior of bedload transport in a river data mining and machine learning algorithms have great potential to produce accurate predictions of bedload transport rate using bedload transport data collected in laboratory flume experiments this p study tested this potential for the first time by examining the prediction power of standalone m5p random tree rt random forest rf and reduced error pruning tree rept models as well as these models trained with a bagging ba algorithm ba m5p ba rf ba rt and ba rept the main findings were as follows 1 a test of model performance showed that the ba m5p model had the highest prediction power followed by m5p ba rt rt ba rf rf ba rept and rept all models displayed very good performance except the ba rept and rept model which were satisfactory 2 the m5p ba rt and rt models underestimated and the ba m5p ba rf rf ba rept and rept models overestimated bedload transport rates prediction 3 a sensitivity analysis revealed that flow velocity had the biggest impact on the bedload transport rate followed by shear stress flow discharge bed shear velocity bed slope flow depth median sediment diameter and relative roughness 4 the input combination that included all variables except relative roughness was found to be provide the best predictive capability for the m5p and rept models while the input combination without flow discharge provided the best accuracy for the rf rt and ba models 5 the maximum depth of tree was the most sensitive operator in decision tree based algorithms and batch size number of execution slots and number of decimal places did not have any impact on the model prediction power overall the results revealed that hybrid data mining techniques provide more accurate predictions of bedload transport rate than standalone data mining models these models could be especially important in data poor catchments particularly in developing nations where technical skills and understanding of the processes occurring in the catchment may be lacking in this case understanding more about the potential for data mining algorithms to provide relatively cheap and fast predictions of non linear processes represents a vital research frontier for river scientists credit authorship contribution statement khabat khosravi conceptualization data curation methodology writing original draft james r cooper conceptualization methodology writing review editing prasad daggupati conceptualization data curation methodology writing original draft binh thai pham methodology writing original draft dieu tien bui methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we would like to thank the editor prof andrás bárdossy associate editor and three anonymous reviewers for their invaluable comments and suggestions which improved the quality of the paper the authors are grateful to the iranian ministry of science research and technology for the grant to carry out this research also the authors wish to thank the university of guilan faculty of engineering dr amir h n chegini and mr nader izadpanah for their cooperation 
5553,the accurate prediction of bedload transport in gravel bed rivers remains a significant challenge in river science however the potential for data mining algorithms to provide models of bedload transport have yet to be explored this study provides the first quantification of the predictive power of a range of standalone and hybrid data mining models using bedload transport data collected in laboratory flume experiments the performance of four types of recently developed standalone data mining techniques the m5p random tree rt random forest rf and the reduced error pruning tree rept are assessed along with four types of hybrid algorithms trained with a bagging ba data mining algorithm ba m5p ba rf ba rt and ba rept the main findings are four fold first the ba m5p model had the highest prediction power r 2 0 943 rmse 0 061 kg m 1 s 1 mae 0 040 kg m 1 s 1 nse 0 945 pbias 1 60 followed by m5p ba rt rt ba rf rf ba rept and rept all models displayed very good performance except the ba rept and rept model which were satisfactory second the m5p ba rt and rt models underestimated and the ba m5p ba rf rf ba rept and rept models overestimated bedload transport rates third flow velocity had the most significant impact on bedload transport rate pcc 0 760 followed by shear stress pcc 0 709 discharge pcc 0 668 bed shear velocity pcc 0 663 bed slope pcc 0 490 flow depth pcc 0 303 median sediment diameter pcc 0 247 and relative roughness pcc 0 003 fourth the maximum depth of tree was the most sensitive operator in decision tree based algorithms and batch size number of execution slots and number of decimal places did not have any impact on model prediction power overall the results revealed that hybrid data mining techniques provide more accurate predictions of bedload transport rate than standalone data mining models in particular m5p models trained with a bagging data mining algorithm have great potential to produce robust predictions of bedload transport in gravel bed rivers keywords bedload flume experiment data mining river artificial intelligence abbreviation and symbols rt random tree m5p m5 prime rf random forest rept reduced error pruning tree ba bagging pcc pearson correlation coefficient ann artificial neural network anfis adaptive neural fuzzy inference system svm support vector machines gp genetic programming fl fuzzy logic ffnn elm feed forward neural network extreme learning machine lmt logistic model tree nbt naïve bayes trees ibk instance based k nearest neighbours hec ras hydrologic engineering center s river analysis system d 50 median sediment grain diameter d sediment diameter q flow discharge v flow velocity y flow depth s bed slope rr relative roughness τ shear stress v shear velocity ρ water density g gravitational acceleration r hydraulic radius q bedload sediment transport rate g mass of collected sediment in trap b flume width t sampling duration rmse root mean square error r 2 coefficient of determination mse mean absolute error nse nash sutcliffe efficiency pbias percent bias xo observed values xe predicted values x 0 mean observed values x e mean predicted values sd standard deviation mars multivariate adaptive regression splines sdr standard deviation reduction t plane rooted decision tree with m nodes c class of a plane rooted tree cm random tree sets ω t weight function k out degree ϕ nonnegative numbers a t generating function 1 introduction bedload transport particularly of coarser sediments is one of the main drivers for the morphological change of gravel bed rivers thus the quantification of bedload transport rate is of paramount importance for river engineers and fluvial geomorphologists interested in river management wilcock 1998 and landscape evolution howard 2008 in the field the measurement of bedload transport is challenging and often expensive especially during flooding and is associated with estimates of rate with a high uncertainty mao 2012 graf 1971 laboratory flume experiments are more commonly used because of the ability to carefully control boundary conditions and to perform more precise measurements allowing bedload transport formulas to be developed over a range of flow and bed conditions e g einstein 1950 engelund and hansen 1967 meyer peter and müller 1948 wilcock and crowe 2003 however these experimental investigations have their disadvantages 1 they can be costly and time consuming 2 they are a simplification of a natural gravel bed river e g use of equilibrium sediment transport conditions and steady and uniform flows 3 are scaled versions of a natural system and thus problems exist in trying to correctly scale flow and sediment properties and 4 the magnitude of transport that can be reproduced is limited one consequence is that bedload transport formulas that are developed from flume experiments can be associated with a high degree of predictive uncertainty mao 2012 a suite of empirical mathematical and numerical approaches have been developed for bedload transport prediction and these approaches have their weaknesses extensive data is required to build calibrate and validate these models particularly if the model is process based furthermore there is much complexity and difficulty in performing model parameterization and calibration if the physics is not well understood which is often the case because of the non linear dynamics of bedload transport hamel et al 2017 kisi et al 2012 one example is in the use of the most popular and widely used model in river science the hydrologic engineering center s river analysis system hec ras model although this model has been used successfully implemented in numerous studies it suffers from the need for approximations and simplifications that can introduce errors in the prediction of bedload transport 1 the flow is often modeled using a depth averaged approach 2 the law of the wall formula is fed with an average shear stress value 3 transport capacity equations are used to predict sediment transport under the assumption of unlimited sediment supply conditions and 4 the determination of the correct value of some of the model parameters such as the active layer depth and the manning roughness coefficient is problematic without detailed observations of the river being modeled ghafouri azar et al 2012 mustafa et al 2017 shahiri et al 2016 considering these challenges alternative approaches to the use of empirical mathematical and numerical methods should be explored recently the advent of artificial intelligence algorithms based on machine learning and data mining techniques are providing new insights in multiple areas of science including water resources and geoscience these algorithms attempt to deduce the optimal relationship between the inputs i e significant conditioning factors and the target i e output parameters mainly operating as a black box type non linear statistical model yaseen et al 2017 most phenomena within a watershed including sediment transport are relatively complex and they cannot be predicted easily khosravi et al 2018a thus in most situations the applied model must be versatile flexible and possess a non linear modeling structure artificial intelligence algorithms meet these requirements ebtehaj and bonakdari 2013 applied artificial neural network ann algorithms for predicting sediment transport in sewers revealing that ann had a higher prediction power than existing empirical transport formulas similar results have also been found within other areas of hydrology and hydraulics melesse et al 2011 kisi et al 2016 however ann algorithms have poor prediction power when the range of the testing dataset is outside of the range of the training data melesse et al 2011 kisi et al 2012 and they require a long term dataset to achieve a reasonable result thus to solve this weakness ann algorithms have been ensembled with fuzzy logic fl algorithms to create adaptive neural fuzzy inference system anfis models ebtehaj and bonakdari 2014 used such a model for predicting sediment transport in sewers showing that anfis models had greater accuracy than empirical sediment transport rate equations however similar to ann anfis algorithms suffer from one important disadvantage the lack of a systematic approach in the design of fuzzy rules and in the choice of membership functions variables tien bui et al 2016 khosravi et al 2018b kisi et al 2012 compared the predictions of daily suspended sediment load made by anfis ann support vector machines svm models and a genetic programming gp model in cumberland river in the u s they revealed that gp provided more accurate predictions than the anfis ann and svm models thus meta heuristic or evolutionary algorithms e g particle swarm optimization whale optimization algorithm have been hybridized with anfis algorithms to overcome this weakness and improve the performance of anfis models for example anfis meta heuristic hybrid models have been applied to the prediction of groundwater potential mapping khosravi et al 2018b termeh et al 2019 chen et al 2019 flood susceptibility mapping tien bui et al 2018a b and sediment transport rate prediction qasem et al 2017 revealing that this hybrid algorithm has a higher prediction power than anfis the use of other standalone and hybrid algorithms has also been explored in the field of sediment transport for example ebtehaj et al 2016a applied a hybrid model of feed forward neural network extreme learning machine ffnn elm for open channel sediment transport revealing that this model outperformed gp and empirical sediment transport models similarly they found wavelet support vector machine svm wavelet algorithms had a better prediction performance than svm and existing empirical equations ebtehaj et al 2016b in the modeling of daily dissolved oxygen concentration in three us rivers heddam and kisi 2018 applied least square svm multivariate adaptive regression splines mars and m5 model tree m5t algorithms their study showed the dissolved oxygen concentrations were successfully predicted using all three models and that the best performing model differed from one measurement station to another recently new artificial intelligence algorithms notably data mining algorithms have been developed and applied in the fields of hydrology and hydraulics these techniques do not seek to explain the physical processes and mathematical reasoning for changes in environmental behavior but to recognize statistical patterns both expected and unexpected within data these patterns can highlight environmental relationships in space and time that may unveil critical details about behavior reveal previously unsuspected relationships or mitigate uncertainty in estimates thus these types of techniques are at their most beneficial in situations when process based models cannot be applied e g lack of understanding of underlying physics of the process or that suffer from inadequacies due to the limitation of data therefore artificial intelligence methods mean that some parameters which are difficult or expensive to measurement such as bedload transport could be easily predicted using other factors that are more readily available such as discharge and bed slope such methods could be particularly attractive to developing nations where extensive measurement networks do not exist and there can be a lack of highly skilled end users to build and run more complex process based models recently some data mining algorithms including random forest rf logistic model tree lmt and naïve bayes trees nbt algorithms have been applied for flood susceptibility mapping khosravi et al 2018c groundwater vulnerability assessments khosravi et al 2018d and landslide susceptibility mapping pham et al 2018 the performance accuracy and reliability of these methods for spatial mapping have been proven in these fields however these algorithms are rarely used for prediction and forecasting not only for bedload transport rate prediction but more generally in the field of geosciences only a few examples of their use exist including the application of rf and random tree rt for solar radiation prediction sherafati et al 2019 the reduced error pruning tree rept instance based k nearest neighbours ibk and m5p model tree techniques for suspended sediment load prediction khosravi et al 2018a and modeling dissolved oxygen concentration in rivers heddam and kisi 2018 thus a significant gap exists in the application of novel data mining algorithms for bedload transport prediction and in the identification of the most flexible and accurate algorithm the present paper therefore aims to fill this gap in understanding by achieving the following objectives 1 to experimental measure the bedload transport rate under uniform flow conditions 2 produce predictions of bedload transport rate using novel data mining techniques namely the m5p model tree random tree rt random forest rf and the reduced error pruning tree rept along with four types of hybrid algorithms trained with a bagging ba data mining algorithm ba m5p ba rf ba rt and ba rept 3 compare the predictive power of these data driven models and 4 perform a sensitivity analysis of the driving variables used in each model this study is the first to apply a diverse range of data mining models to the prediction of bedload transport the research offers new insight into which data mining algorithms offer the potential to provide relatively cheap and fast predictions of bedload transport in poorly monitored rivers where understanding of the physical processes at play may not be well understood 2 materials and methods 2 1 flume setup and experimental procedure a total of 72 bedload transport experiments have been carried out in a 12 m long and a 0 5 m wide and deep tilting flume fig 1 a tailgate at the downstream end was adjusted to create uniform flow conditions over the mobile section of the flume informed by water depth measurements made using two mechanical point gauges and three ultrasonic sensors a 4 m upstream and 2 8 m downstream section of the flume was artificially roughened with the same sized gravel as the mobile section to prevent upstream scour promote the development of fully developed flow within the mobile section of the flume and to reduce the backwater effect of the tailgate the central 5 m section of the flume contained screeded loose sediment with a thickness equal to 5 6 d 50 d 50 is the median grain diameter of the sediment a bedload trap 0 5 m wide and 0 2 m long was installed at the downstream end of the flume to sample the transported sediment through time four types of rounded and naturally shaped uniform sized sediment were investigated d 50 of 5 17 10 35 14 and 20 7 mm with a specific gravity of 2 39 2 38 2 90 and 2 55 respectively before each experiment the slope was set tailgate raised the pump turned on and the flow slowly allowed to fill the flume without any disturbance to the bed the tailgate was then opened the flow discharge set and after the establishment of uniform flow sediment transport sampling commenced the time of each experiment varied from 1 to 30 min and the frequency of bedload sampling varied from several seconds to several minutes both were dependent upon the bedload transport rate the higher the rate the higher the sampling frequency and the lower the sampling duration the flow discharge q velocity v depth y bed slope s and sediment diameter d were measured for each experiment and these parameters were used to calculate relative roughness rr d y shear stress τ ρgrs and shear velocity v τ ρ where ρ is the water density g is the gravitational acceleration and r is the hydraulic radius the collected bed sediment was dried and weighed for calculation of the bedload sediment transport rate q in kg m 1 s 1 as follows 1 q g b t where g is the mass of collected sediment kg b is the flume width 0 5 m and t is the sampling duration s more information about the flume set up and sediment sampling can be found in khosravi et al 2020 2 2 development and application of data mining techniques 2 2 1 sample size 72 experiments were undertaken 50 experiments were used for model building and 22 were used for model validation there is no universal guideline for the training testing ratio but a ratio of 70 30 is most commonly used in spatial and time series modeling khosravi et al 2018a d pham et al 2017 given the experimental dataset is relatively small this approach was combined with a 10 fold cross validation technique this technique is summarized in fig 2 each experimental dataset was used 10 times to provide 720 sets of data in each iteration a different section of the dataset was considered as training and testing dataset 2 2 2 preparation of dataset eight factors known to have a strong correlation with bedload transport rate were used to perform the data driven modeling d 50 s y v q rr v and τ the correlation of these variables with bedload transport was investigated using the pearson correlation coefficient pcc a total of 10 input variable combinations were constructed and investigated these were assessed to determine the input combination that produced the most accurate prediction of bedload transport rate 2 2 3 model description 2 2 3 1 random forest rf the rf is a flexible nonparametric ensemble learning technique first developed by breiman 1996 and is a hybrid procedure between a decision tree and a regression breiman et al 1984 the model is commonly used for both classification and regression problems for example in drought forecasting deo et al 2017 vegetation mapping prediction for changes in climate iverson et al 2004 and soil moisture prediction prasad et al 2018a b in rf each decision tree is constructed by selecting randomly a subset of a sample selecting variables from a training dataset by using a deterministic algorithm mutanga et al 2012 deo et al 2017 and using a random bootstrap sample for the training dataset to build multiple trees breiman et al 1984 the rf algorithm is trained by means of several steps 1 a bootstrap sample is drawn from the training data 2 a decision tree is grown for each bootstrap sample by selecting the best split among the subset selected randomly from all the features and the tree is then grown to the maximum size with no pruning back 3 these aforementioned steps are repeated until a sufficiently large number of trees are created mutanga et al 2012 the general structure of a rf model is shown in fig 3 2 2 3 2 m5p the m5p also known as m5 tree model is a well known piecewise linear tree based model used to predict continuous variables and was first introduced by quinlan 1992 recent applications of m5p models can be found in several studies such as in the prediction of dissolved oxygen heddam and kisi 2018 and suspended sediment load khosravi et al 2018a m5p is a flexible algorithm because the decision tree constructed by m5p can have multivariate linear models zhan et al 2011 the m5p tree is developed through three main steps 1 constructing the tree 2 pruning the tree and 3 smoothing the tree in the process of growing the tree using the m5p the standard deviation reduction sdr is maximized to achieve the best model performance the sdr is expressed as follows zhan et al 2011 2 sdr s d e i e i e x s d e i where e is defined as the set of cases ei is defined as the ith subset of cases which result from splitting the tree sd e is defined as the standard deviation of e and sd ei is defined as the standard deviation of ei the tree pruning step is started after the tree is constructed to eliminate undesired sub trees the purpose is to avoid data over fitting problems that occur during the construction of the tree over fitting problems arise when the model is very accurate with the training dataset but fails with the testing dataset in this pruning step the attributes are reduced one by one to minimize the estimated error the smoothing step is started after the tree pruning step and is performed to compensate for the sharp discontinuities between adjacent linear models at the leaves of the pruned tree wang and witten 1997 this step is achieved by using the leaf model to compute the predicted value which is then filtered along the path back to the root node wang and witten 1997 2 2 3 3 reduced error pruning tree rept the rept model is well known as a fast decision tree method that constructs a decision tree to reduce the error in the prediction mohamed et al 2012 first the model utilizes the regression tree logic to create multiple trees in various iterations jayanthi and sasikala 2013 second the model chooses the best tree the one with the least error from multiple trees third the reduced error pruning rep technique is used to prevent over fitting problems finally the algorithm handles missing values using a c4 5 algorithm and sorts the values of numerical attributes using the embedded method the rept algorithm uses a stopping criterion the sum of squared errors to build a tree with maximum information gain the stopping criterion is expressed as follows quinlan 1987 3 s eeleaves r t q c u c where qc is defined as the class prediction and uc is the leaf within variance 2 2 3 4 random trees rt the rt model is formed by a stochastic process and builds the decision trees on a random subset of columns the rt works in a similar manner to traditional decision trees but has one key exception only a random subset of attributes is available for each split of the training dataset the algorithm is a fast and flexible tree learner and has been applied to solve a broad range of problems such as in philology najock and heyde 1982 and medicine busch et al 2009 let t be a plane rooted decision tree with m nodes referred to as a family tree in which the profile of the tree might be described by the number of the nodes or the number of the leaves suppose that c is a class of a plane rooted tree and each t c the size t by the number of nodes t includes a weight function ω t expressed as follows drmota and gittenberger 1997 4 ω t k 0 α k m k t where α k k 0 is defined as the non negative numbers and mk t is defined as the number of the nodes υ t with out degree k thereafter set a m t t m ω t then the corresponding generating function a t m 0 a m t m must satisfy the functional equation as follows drmota and gittenberger 1997 5 a t t φ a t where φ x k 0 φ k x k in the final step sets c m t c t m are equipped with the probability distribution caused by the weight function ω t drmota and gittenberger 1997 2 2 3 5 bagging ba ba is one of the most effective ensemble methods to solve classification and regression problems the method is able to weaken the defects of component learners and raise the recognition rate of unstable classifiers thus it can enhance the predictive capability of the weak learners breiman 1996 in the ba algorithm the training process is carried out through three main steps 1 selecting randomly and independently the data from the primary training dataset this step is repeated several times to create a certain number of sub datasets 2 designating the base learning algorithm to train the various sub datasets and gain the sequence of predictive function and 3 vote for the outcomes and select the final outcome with the most votes bauer and kohavi 1999 the ba method has been applied to improve many base learners such as trees mert et al 2014 support vector machines pham et al 2018 and naïve bayes trees pham and prakash 2018 in this study the ba has been used to train the m5p rf rt and rept base learners for bedload transport rate prediction the general structure of a bagging model is shown in fig 4 2 3 sensitivity analysis there are two main steps in prediction using ai algorithms i determination of the best input variable combination and ii identifying the operator s optimum values each combination of input variables has a different impact on the modeled result and thus the most effective input combination should be determined there are no optimum operator values which work globally for model calibration hence to enhance the prediction power of each algorithm these values need to be set after the determination of the best input combination at first default values of each operator were considered and then based on this result lower and higher values were selected to find the optimum value the best input variable combination and optimum operator values were achieved by minimizing the root mean square error rmse using trial and error during the testing phase also a sensitivity analysis was carried out to identify which input variables and model operators had the greatest effect on the predicted transport rate 2 4 model evaluation the five most commonly used metrics for assessing the performance of models were used coefficient of determination r 2 rmse mean absolute error mae nash sutcliffe efficiency nse and percent bias pbias these metrics were calculated as follows moriasi et al 2007 dawson et al 2006 legates and mccabe 1999 6 r 2 i 1 n x o x o x e x e i 1 n x o x o 2 i 1 n x e x e 2 2 7 rmse 1 n i 1 n x e x o 2 8 mae 1 n i 1 n x e x o 9 nse 1 i 1 n x e x o 2 i 1 n x o x o 2 10 pbias i 1 n x o x e i 1 n x e 100 where xo and xe are observed and predicted values x 0 and x e are mean observed and predicted values respectively and n is the number of data points the performance classification of the model evaluation metrics is shown in table 1 for a visual analysis and assessment of the applied models taylor diagrams and box plots were used one distinct advantage of the taylor diagram is that it benefits from the use of the two most common correlation statistics correlation coefficient cc and standard deviation sd taylor 2001 the closer the predicted value to the observed value in terms of the cc and sd the higher the prediction capability sigaroodi et al 2014 the advantage of a box plot is that it can show how well a model predicts extreme median and quartile values 3 results 3 1 determination of the best input variable combination the pcc values in table 2 show that flow velocity had the highest impact on bedload transport rate pcc 0 760 followed by shear stress pcc 0 709 flow discharge pcc 0 668 shear velocity pcc 0 663 bed slope pcc 0 490 flow depth pcc 0 303 d 50 pcc 0 247 and relative roughness pcc 0 0033 based on these pcc values ten different input combinations were constructed and investigated 1 bl f q 2 bl f v 3 bl f v τ 4 bl f v τ q 5 bl f v τ q v 6 bl f v τ q v s 7 bl f v τ q v s y 8 bl f v τ q v s y d50 9 bl f v τ q v s y d50 rr 10 bl f v τ v s y d50 rr this approach starts with the variable with the highest pcc q and then variables with lower pcc s are added into the combination until the variable with the lowest pcc rr is finally added in each model all 10 combinations were used in the training and testing phases in the testing phase rmse and pcc values were calculated to determine the optimal combination for building the final version of the model table 3 shows that due to the different structures of each model the optimal input variable combination differs between the models input combination 10 in which all variables except q were considered was the best input combination for rf rt and ba models but input combination 8 in which all variables except rr were considered was the best for m5p and rept models adding rr to the input combination caused an increase the error in most of the cases m5p rept rt models but with the rf and ba models it produced a better performance compare the input combinations of 8 and 9 including q in the input combination caused an increase in model error compare the input combinations of 3 and 4 this results explains why input combination 10 was created with all input variables except q the input combinations constructed with variables with high pcc values 3 4 5 and 6 did not produce a good agreement between observed and predicted values indeed by adding d50 into a combination which had a low pcc the prediction power of the models increased significantly compare the input combinations of 7 and 8 a comparison of input combinations 8 10 with 2 6 shows overall that including variables with low pcc such as rr and removing variables with high pcc improved prediction performance thus these results confirm that input variable selection must be carried out on a trial and error basis 3 2 model performance and sensitivity analysis 3 2 1 rf model twelve operators were considered for the rf model and their optimum values were obtained using a trial and error approach these operators were bag size percent percentage of the training set used batch size preferred number of instances to process if batch prediction is being performed maximum depth of tree number of decimal places used in the output of numbers in the model number of execution slots used for constructing the ensemble number of features randomly chosen attributes number of iterations to be performed seed number break ties randomly when several attributes look equally good calculation of out of bag error de bug and do not check capabilities classifier may output additional information to the console if set the optimum values for these operators were 100 100 8 2 2 0 100 1 no no no and no respectively the sensitivity analysis shows that the maximum depth of tree had the biggest impact on the rmse of the rf model fig 5 followed by bag size percent number of features number of seeds number of iterations batch size and number of execution slots respectively 3 2 2 m5p model six main operators were established in the structure of the m5p model these parameters were batch size minimum number of instances to allow at a leaf node number of decimal places used in the output of numbers in the model build regression tree whether to generate a regression tree rule instead of a model tree rule do not check capabilities and unpruned whether unpruned tree rule is to be generated the optimum values for these operators were 100 4 2 no no and no respectively the sensitivity analysis shows that none of these operators had an impact on the predictive capability of the m5p model and thus the default values were used fig 6 3 2 3 rept model eight main operators were considered in the rept model batch size initial count initial class value count maximum depth minimum number the minimum total weight of the instance in a leaf minimum variance probability the minimum proportion of variance on all the data that need to be presented at a node in order for splitting to be performed in a regression tree number of decimal places number of folds the amount of data used for back fitting and number of seeds the optimum values for these operators were 100 1 1 2 0 001 2 3 and 1 respectively all of the operators except the initial count and batch size had a noticeable impact on the predictive power of the rept model fig 7 the most sensitive operator was the maximum depth of tree same as observed with the rf model 3 2 4 rt model eight operators were used in the rt model k value sets the number of randomly chosen attributes batch size maximum depth minimum number the minimum total weight of the instance in a leaf minimum variance probability number of decimal places number of folds and number of seeds the optimum values for these operators were 2 100 1 1 0 001 1 0 and 3 respectively fig 8 all the operators except the batch size and number of decimal places had a noticeable effect on model performance fig 8a the maximum depth of tree and minimum variance probability had the most significant impact fig 8b and c 3 2 5 ba model six operators were used in the ba model bag size percent batch size number of decimal places number of execution slots number of iterations number of seeds the optimum values for these operators were 20 100 2 0 12 and 0 respectively fig 9 of these six operators only the number of iterations most sensitive operator and the number of seeds had a significant effect on the rmse of the ba model 3 3 model performance assessment after the determination of the most effective input variable combination and the optimum operator values each algorithm was trained by a training dataset and evaluated by a testing dataset since the models were built by a training dataset this evaluation can only show how well the constructed model fits the testing dataset and cannot be used for model validation khosravi et al 2016 chen et al 2019 an assessment of the predictive capability of the eight developed models o is shown in table 4 the r 2 values show that the ba m5p model had the highest prediction power 0 943 followed by the m5p 0 932 ba rt 0 910 rt 0 890 ba rf 0 833 rf 0 784 ba rept 0 596 and rept 0 570 according to the classification of performance for this metric legates and mccabe 1999 moriasi et al 2007 ayele et al 2017 all models had a very good performance except the ba rept and rept models which had satisfactory performance since r 2 is standardized for differences between the mean and variance of observed and predicted values it is sensitive to outliers and should not be used for model evaluation alone legates and mccabe 1999 shiri and kişi 2012 thus other evaluation metrics were considered in terms of rmse mae and nse the ba m5p was superior to the other models using the nse values all of the applied models had a very good performance except the ba rept and rept which were satisfactory and acceptable respectively according to the pbias values all the models had a very good performance except ba rt rt and rept the m5p and ba rt and rt models underestimated shown by positive pbias values and the ba m5p ba rf rf ba rept and rept models overestimated the bedload transport rate a taylor plot of model performance shows that the ba m5p model had the highest performance because the predicted standard deviation of bedload transport rate is the closest to the standard deviation of the observed data and the correlation is also the highest fig 10 considering all the evaluation metrics together the ba m5p and rept moidels had the highest and the lowest prediction capability a further comparison between observed and predicted bedload transport rate is shown in figs 11 and 12 both figures confirm that the ba m5p model predicts the bedload rate more accurately than the other models generally the results show that the prediction power of the hybrid algorithms mostly depends on the base algorithm i e m5p rf and so on for example the incorporation of the bagging algorithm increased the prediction power of rept but the ba rept algorithm still had a lower prediction power than m5p rf and rt as standalone algorithms the box plots of bedload transport rates fig 13 show that the ba rt and rt models produced a perfect match for the maximum observed maximum transport rate 1 06 kg m 1 s 1 and ba rept and rept 1 05 kg m 1 s 1 and ba m5p 1 03 kg m 1 s 1 produced a close match the other algorithms could not predict the rate accurately the same result was observed for predicting the minimum observed transport rate these two results reveal that although m5p is overall the most accurate for the testing dataset it cannot predict extreme values well however when trained with a bagging data mining algorithm its performance in predicting extreme values is much improved the ba rf and rf models predict the observed values in the third quartile better than the other models the ba rt and rt better predict the median values and the ba rept and rept models better predict values in the first quartile 4 discussion the determination of the best input variable combination and optimum operator values is one of the most significant steps in producing an accurate data mining model some researchers have determined the best input combination using a principal component analysis approach or according to the strongest pcc barzegar et al 2016a b however the current paper show these approaches might not be the best to take due to nonlinearity between variables the variables with low pcc enhanced the prediction power of the models and the most effective combination varied from only model to another thus a range of different input variable combinations must be considered in the optimization of data mining models the m5p rf rt and rept standalone models had contrasting prediction performance given the same bedload dataset was used to test performance this contrast results from a difference in each model s structure loh 2011 particularly their flexibility computing capability complexity and ability to reduce over fitting kisi et al 2019 the hybrid models built using a bagging algorithm in most of the cases had a higher prediction power than standalone models because hybrid models are more flexible than standalone models and have a nonlinear structure de ath and fabricius 2000 these two model properties are particularly important in the prediction of bedload transport because of the nonlinearity between variables in particular the bagging algorithm benefits from ensemble learning in its structure multiple weak learners which outperforms a single strong learner this learning helps to reduce variance and avoid the over fitting problem caused by the use of a bootstrap procedure given this is the first study to examine the prediction performance of these data mining algorithms for the prediction of bedload transport rate no direct comparisons exist however the improved performance of hybrid bagging models conforms with previous tests of data mining algorithms in other fields khosravi et al 2018a khozani et al 2019 sharafati et al 2019 ghorbani et al 2017 yaseen et al 2017 furthermore other studies in the prediction of water quality nitrate ammonia and phosphate shkurin 2015 suspended sediment load and francke et al 2008 and solar radiation sun et al 2016 sharafati et al 2019 have also found rf and rt algorithms have very good prediction power the m5p model was the best performing standalone and hybrid model because it is a decision tree based algorithm that does not have a hidden layer in its structure kisi et al 2012 and thus can learn efficiently and does not require any assumptions about the type of data distribution the main advantage of the m5p algorithm over other decision tree algorithms is that m5p has an ability to handle data without any vagueness as well as handle very large datasets with a large number of dimensions and attributes quinlan 1992 also the m5p model benefits from model trees that are much smaller than regression trees and have proven to be more accurate quinlan 1992 although rf and rt models have some advantages such as being simple flexible and easy to use they have one severe limitation the construction of a large number of trees can make the algorithm slow and ineffective for real time predictions and a more accurate prediction requires more trees in addition the rf modle suffers from poor performance for regression subjects especially when the range of testing data is out of the range of the training dataset overall the results show that m5p models especially those trained with a bagging data mining algorithm have great potential to produce robust predictions of bedload transport in gravel bed rivers such models could be particularly useful in data poor watersheds especially in developing nations where technical skills and understanding of the processes occurring in the watershed may be lacking the m5p models could potentially be used alone or replace process based models because they represent well the highly stochastic behavior of sediment transport and are inexpensive to build and run this type of data driven model could also complement existing process based models in well gaged watersheds to recognize patterns within collected data that could unveil critical details about behavior reveal previously unsuspected environmental relationships or mitigate uncertainty in model estimates future studies should consider the performance of these algorithms in the prediction of bedload transport in more complex conditions than those studied here such as with poorly sorted sediments water worked beds that mimic better the surface topographies of natural coarse grained rivers cooper and tait 2010 unsteady flows and in non equilibrium transport conditions in the case of an upstream sediment supply mao et al 2012 5 conclusions the accurate prediction of bedload transport rate is vital for understanding gravel bed river morphodynamics due to the non linear and chaotic behavior of bedload transport in a river data mining and machine learning algorithms have great potential to produce accurate predictions of bedload transport rate using bedload transport data collected in laboratory flume experiments this p study tested this potential for the first time by examining the prediction power of standalone m5p random tree rt random forest rf and reduced error pruning tree rept models as well as these models trained with a bagging ba algorithm ba m5p ba rf ba rt and ba rept the main findings were as follows 1 a test of model performance showed that the ba m5p model had the highest prediction power followed by m5p ba rt rt ba rf rf ba rept and rept all models displayed very good performance except the ba rept and rept model which were satisfactory 2 the m5p ba rt and rt models underestimated and the ba m5p ba rf rf ba rept and rept models overestimated bedload transport rates prediction 3 a sensitivity analysis revealed that flow velocity had the biggest impact on the bedload transport rate followed by shear stress flow discharge bed shear velocity bed slope flow depth median sediment diameter and relative roughness 4 the input combination that included all variables except relative roughness was found to be provide the best predictive capability for the m5p and rept models while the input combination without flow discharge provided the best accuracy for the rf rt and ba models 5 the maximum depth of tree was the most sensitive operator in decision tree based algorithms and batch size number of execution slots and number of decimal places did not have any impact on the model prediction power overall the results revealed that hybrid data mining techniques provide more accurate predictions of bedload transport rate than standalone data mining models these models could be especially important in data poor catchments particularly in developing nations where technical skills and understanding of the processes occurring in the catchment may be lacking in this case understanding more about the potential for data mining algorithms to provide relatively cheap and fast predictions of non linear processes represents a vital research frontier for river scientists credit authorship contribution statement khabat khosravi conceptualization data curation methodology writing original draft james r cooper conceptualization methodology writing review editing prasad daggupati conceptualization data curation methodology writing original draft binh thai pham methodology writing original draft dieu tien bui methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we would like to thank the editor prof andrás bárdossy associate editor and three anonymous reviewers for their invaluable comments and suggestions which improved the quality of the paper the authors are grateful to the iranian ministry of science research and technology for the grant to carry out this research also the authors wish to thank the university of guilan faculty of engineering dr amir h n chegini and mr nader izadpanah for their cooperation 
5554,agricultural production in arid and semi arid area faces a global problem of water resources shortage and land salinization irrigation and drainage are the important measure to enhance crop yield and control soil salinity generally at field scale only irrigation is optimized to pursue the higher water use efficiency and crop yield while drainage is difficult to optimize owing to controlled by dynamic groundwater levels here we develop a new collaborative optimization model of irrigation and drainage to improve irrigation water use efficiency and to control soil salinity the model is formulated by integrating simulation of physical processes of field water salt balance and a genetic algorithm based optimization model the new model is to search optimized irrigation and drainage strategic decision for enhancing field economic benefit with the condition controlling salinity with limited water resources then a case study on optimally allocating irrigation and drainage water to different growth stages of maize field in the hetao irrigation district arid area of northwest china shows enhanced applicability of the developed model five groundwater depth levels 1 m 1 5 m 2 m 2 5 m and 3 m and five groundwater salinity levels 2 g l 2 25 g l 2 5 g l 2 75 g l and 3 g l are provided to show and compare the solutions of the optimal irrigation and drainage water allocation results indicate the developed model can supply reasonable field monthly irrigation and drainage decision with considering field hydrology especially contribution of groundwater to crop water demand and groundwater role to soil salt accumulation the contrary relationship between system benefit and irrigation water use efficiency was described successfully by the developed model and compared with traditional single irrigation optimization model the developed irrigation drainage collaborative optimization model can enhance drainage function to keep the optimal groundwater levels and improve the system benefit by 0 8 overall the developed model can provide more applicable irrigation water and drainage strategies to the sustainable development of irrigation agriculture keywords irrigation water allocation optimization agricultural drainage water shallow groundwater soil salinity 1 introduction increasing the crop yield is essential to meet the challenges of population growth and increased food demand boyer et al 2012 while farmers in arid areas are facing increasing irrigation water resources shortage as the limited precipitation improving irrigation water productivity is a vital step for increasing more agricultural products with limited irrigation water resources surendran et al 2016 it is noteworthy that soil salinity is another serious problem beside limit irrigation resources faced by irrigation agriculture in arid and semi arid irrigated areas asgari et al 2012 mosaffa and sepaskhah 2019 wichelns and qadir 2015 lots practices have showed effective drainage management can improve field salinity ritzema et al 2006 in these cases there is a limitation for increasing total irrigation water amount the most contribution of the increase in agricultural production will come from improvement and expansion of irrigation and drainage systems schultz et al 2005 therefore it is significant and practical to make effective irrigation and drainage water management strategies for improving agricultural water use efficiency and ensuring sustainable agro economy development it is reported that a large number of optimization models for agriculture water management including traditional methods like linear programming nonlinear programming dynamic programming anwar and clarke 2001 ghahraman and sepaskhah 2004 srinivasa prasad et al 2011 uncertain programming methods li et al 2019 li et al 2017a b zhang et al 2019 like interval mathematical programming imp stochastic mathematical programming smp fuzzy mathematical programming fmp and artificial intelligence search methods like genetic algorithms ga artificial neural network ann ant colony optimization aco particle swarm optimization pao simulated annealing algorithm sa brown et al 2010 hamed ketabchi 2015 safavi and enteshari 2016 safavi and esmikhani 2013 these models could obtain the irrigation optimal allocation solutions in irrigation water management furthermore genetic algorithm ga is one of the frequently used algorithms to solve optimization problems for water resource management and has been widely used in irrigation water allocation moghaddasi et al 2010 wen et al 2017 it is noted that previous studies about the optimizing agriculture water allocation were limited to conjunctive use of surface water and groundwater for irrigation li et al 2017a b li et al 2018a b mandare et al 2008 the impact of shallow saline groundwater on agricultural production and irrigation induced environmental problems occurred concurrently with agricultural irrigation water allocation have less attention in recent years more attention has been paid to the contribution of shallow groundwater evapotranspiration to crop evapotranspiration ayars et al 2006 gao et al 2015 huo et al 2012 xue et al 2017 however the shallow saline groundwater may lead to accelerated salt accumulation in crop root zone karimov et al 2014 shah et al 2011 much modeling research on the relationship between soil salinization and groundwater depth has been undertaken gonçalves et al 2006 hammecker et al 2012 mirlas 2012 given groundwater depth was the main influencing factor of soil salinity yu et al 2010 moreover guang et al 2012 and hossain et al 2011 concluded that land salinization and shallow groundwater level caused the crop yield reduction controlled drainage also known as drainage water management is a best management practice to control groundwater level in the crop growth season for increasing crop production fisher et al 1999 li et al 2018a b a well planned drainage system can play a buffer role to much shallower groundwater levels this is consistent with ritzema 2016 conclusion that drainage is an effective tool to prevent soil salinity in arid and semi arid regions riley et al 2009 showed that crop yield differences between traditional drainage and drainage management some studies have shown that controlled drainage may lead to a 10 20 even 64 increase in maize production fisher et al 1999 hunt 1993 ng et al 2002 some simulation models are used to quantitatively describe controlled drainage management in the complex agro hydrological process du et al 2017 jouni et al 2018 wahba 2017 since numerous computer based model and field experiment may vary depending on scenario analysis optimization model is needed to obtain the best one strategy in different environments and under different weather conditions singh 2014 prathapar et al 1997 developed a hierarchical multi criterion salt water and groundwater management framework for optimal land uses by minimizing the water table rise and maintaining soil salinity singh 2018 applied saltmod model to evaluate the optimal management strategies for preventing from salinization to reflect conflicting between agriculture production and ecosystem irrigation and drainage management should be done simultaneously however there are few attempts to develop methods aiming at water allocation in irrigation drainage collaborative systems for arid and semi arid area there are two types of decision variables including irrigation water amount and drainage water amount in a subarea of an irrigation dominated where salinity is one of the major restrictions to the irrigation sustainable development therefore an irrigation drainage collaborative optimization model is developed for supporting irrigation drainage water management the model is coupled an agro hydrological process in order to better describe complex interactions among crop soil water climate and groundwater within a general optimization model this model is similar to controlled drainage strategy with effective hydrology based optimal model controlled drainage management focus on simulation models or single drainage while the specific goal of this research is to allocate limited irrigation water resource and drainage to different growth stages in order to obtain benefit of crop increase to demonstrate its applicability the developed model is then applied to a real world case study in the hetao irrigation district northeast china results of optimal irrigation water and drainage allocation under different groundwater levels and groundwater salinity concentrations are generated which can be used for providing strategies for decision makers to make irrigation drainage water allocation 2 methodology 2 1 site description the hetao irrigation district hid is one of three largest irrigation districts in china located in upper yellow river basin fig 1 the hid covers a total area of 10 68 103 km2 and more than 60 are the irrigated land chen et al 2020 about 4 7 billion m3 water is irrigated from the yellow river every year with salinity of approximately 0 5 g l it is a typical arid or semi arid agricultural area average annual precipitation is 170 mm mainly happens between june and september and annual pan evaporation is 2300 mm average annual temperature is 8 8 c while the minimum and maximum are 12 3 c in january and 23 8 c in july respectively chen et al 2018 the topography is relative flat with only 0 2 slope the groundwater is very shallow and the water table depth varies between 0 5 m and 3 0 m within one year period liu et al 2017 ren et al 2016 the three major crops in the hid are wheat maize and sunflower sun et al 2016 irrigation water and farmland drainage naturally flow into the drainage canal because of gravity poor drainage and soil salinization are a threat to irrigated agriculture in the region such irrigation drainage collaborative management is necessary on irrigated areas 2 2 optimization model development an irrigation drainage water collaborative allocation system is considered in a maize land which is the largest proration of farmland in the study area the decision maker is responsible for allocating irrigation water resources and drainage amount in growth stages april may june july august and september for sustainable agricultural irrigation development different from other field irrigation decision optimization models sepahvand et al 2019 soundharajan and sudheer 2009 zhai et al 2019 irrigation and drainage amount are considered as the decision factors in the developed optimization model the interactive irrigation water and drainage should be allocated efficiently especially in arid and semi arid areas with shallow saline groundwater given shallow groundwater can contribute to crop water requirement and resulted in salt accumulation in root zone irrigation and drainage can result in various groundwater levels which finally produce different crop yields in fact the developed optimization model is to identify the critical groundwater levels by drainage optimization during the process of irrigation drainage collaborative allocation considering the physical soil water and salt process in the study area with shallow groundwater there are two modules namely the agro hydrological module and the optimal module in a certain land farmers pay close attention to the economic benefits of crop yield the massive response of crop yield to water and salt stress cannot be glossed over in water shortage and soil salinization area and the crop growth process is a simplified version by considering the stress of temperature water and salt we use the soil water and salt balance process to represent water and salt movement in soil in addition groundwater water and salt balance are developed for shallow aquifer movement with various inputs and outputs involving in deep percolation groundwater evaporation and drainage the agro hydrological module can be calculated at a month time step finally crop yield can be generated by the field hydrological model maximizing net economic benefit determined by crop yield is the objective of optimal module the objective should be subject to constraints of water demand available water supply of yellow river irrigation water resource and groundwater and soil salt content threshold the decision making framework is depicted in fig 2 2 2 1 objective function based on the subjectivity of farmers whose aim is to maximize the economic benefits per unit the objective is to pursue maximized economic benefits which is the difference between the profit from crop yield and water costs eq 1a represents this concept as an objective function 1a maxy c y m 1 k y 1 tet te t m c w t t i w t η where t is index of the monthly stages t 1 2 6 representing april may june july august and september respectively y is the system net economic benefit per ha for the farmers yuan ha 1 c is the crop net price with consideration of crop market price and the planting costs yuan kg 1 in this study c is average 1 9 yuan kg 1 for maize from local statistical data ym is the maximum crop yield kg ha 1 ym is 10000 kg ha 1 for maize from the local survey y m 1 k y 1 tet te t m is actual crop yield estimated by the fao expression ren et al 2016 ky is yield responses factory indicating the effect of evapotranspiration reduction on production loss adopting the recommended value in fao56 1 25 for maize tet and tetm are the actual and maximum cumulative evapotranspiration of the total growth stage mm cw is irrigation water price yuan m 3 iw is the amount of irrigation per month mm month 1 η is the utilization coefficient of irrigation water t t i w t η is the gross amount of irrigation during crop growth period m3 ha 1 2 2 2 constraints the above objective is subject to the following constraints 1 crop evapotranspiration constraint total actual crop evapotranspiration during growth stage is limited to the maximum total crop evapotranspiration the actual crop evapotranspiration of a certain time period t is also limited to the maximum crop evapotranspiration at time period t 2a tet t e t m 2b e t t e t m t moreover the actual crop evapotranspiration is used to estimate the crop yield depending on the water stress and salinity stress in arid saline region it is calculated with eqs 2c 2g from fao 56 allen et al 1998 domínguez et al 2011 2c tet t t e t t 2d e t t k cbt k w t k s t e t 0 t 2e k wt 0 θ t θ wpsalt t θ t θ wpsalt t θ c θ wpsalt t θ wpsalt t θ t θ c 1 θ t θ c 2f k st 1 b 100 k y e c et e c m e c et e c m 1 e c et e c m 2g θ wpsalt t θ wp b e c e t e c m 100 θ fc θ wp where et and etm is the monthly actual evapotranspiration and monthly maximum evapotranspiration mm month 1 et0 is reference crop evapotranspiration mm month 1 kcb is the basal crop coefficients et0 and kc are calculated according to the fao 56 penman monteith approach and meteorological data were collected from the linhe meteorological station ks is soil salinity stress coefficient kw is water stress θ is the average soil water content of the root zone m3 m 3 θfc is the soil water content at saturation of the root zone m3 m 3 θwp is the soil water content at wilting point m3 m 3 θwpsalt is the soil water content at wilting point under saline conditions m3 m 3 θc is the soil water content at the critical point of water stress m3 m 3 ece is the electrical conductivity of the saturation extract of the soil ds m 1 and 1 ds m 1 0 64 g l 1 abrol et al 1988 asce 1996 ecm is the threshold of the electrical conductivity of the saturation extract of the soil ds m 1 b is the reduction factor ds 1 m 2 total water availability constraints the gross amount of irrigation water allocation should not be larger than irrigation water availability during growth period 2h t t i w t η q yw where qyw is the maximum available irrigation water amount m3 3 soil water and salt balance of the root zone constraints the soil water and salt balance model with monthly temporal step describes the change of soil water and salt storage of root zone the soil water storage of the root zone during a certain time period equals to the soil water storage of the last time period and inflow to root zone minus the outflow in the hid the surface runoff can be neglected because of low rainfall and relatively flat topography groundwater evaporation must be considered due to an intense exchange between the shallow groundwater and soil water inflow to root zone includes irrigation iw precipitation p groundwater evaporation etg the outflow includes deep percolation re and crop actual evapotranspiration et there is deep percolation only when the soil water content is greater than the water content at saturation of the root zone the root zone s water balance is calculated as 2i w t 1 w t p t i w t e t g t r e t e t t 2j w t z θ t where w is the soil water storage mm month 1 p is the precipitation mm month 1 iw is the amount of irrigation mm month 1 etg is the groundwater evaporation mm month 1 re is the deep percolation mm month 1 et is the evapotranspiration mm month 1 and z is the depth of root zone here z 1 m groundwater water balance eq 2k is used to get monthly groundwater table depth groundwater may flow along several different pathways including vertical groundwater evaporation horizontal drainage and deep seepage from the root zone groundwater evaporation is estimated as an empirical function of groundwater table depth and the water evaporation xu et al 2010 as follows 2k 1000 μ g h t 1 g h t e t gt r e t d e t 2l e t g a e b g h t e 0 t where μ is the specific saturated soil water content hao et al 2013 indicating the volumetric fraction of water yielded by a given aquifer under gravity μ 0 07 gh is the groundwater table depth m de is the drainage a and b are dimensionless empirical parameters related to soil type land use and vegetation obtained from experimental data of the shahaoqu experimental station a 1 81 b 1 42 xu et al 2010 e0 is the open water evaporation mm month 1 salt transports with soil water flow in vertical soil profile of root zone the downward movement of salt is caused by deep percolation while the upward movement is caused by capillary rise from groundwater when we calculated the salinity of groundwater it is assumed that groundwater salinity concentration changes in the major fluctuation range of groundwater table for the groundwater the salt input is due to the percolation from root zone while the output is due to the drainage the salt balance in the soil and the groundwater is calculated as follows 2m r s t 1 r s t i w t s y e t g t s g t r e t s c t 2n g s t 1 g s t e t g t d e t s g t r e t s c t 2o g s t 1 z g g h t g h t 1 s g t 1 where rs is the soil salt storage mg m 2 sy is the salt concentration of the irrigation water mg l 1 sg is the salinity concentration in the groundwater mg l 1 sc is the salt concentration of the soil mg l 1 gs is the salt storage of groundwater mg m 2 zg is the difference between the groundwater table depth and the depth that groundwater fluctuations cannot reach mm 4 salt accumulation at the end of growth period constraint we assume that salt accumulation should not exceed 640 mg l 1 during the growth stage for the agriculture sustainable development li 2017 2p s c end s c ini 640 5 nonnegativity constraint all the decision variables of the model should not be negative the constraint can be expressed as 2q i w t d e t 0 t irrigation decision could be restricted by multiple factors such as constraints on water resources and groundwater depth different available water resources and groundwater depth scenarios have different effects on irrigation drainage decisions 6 different maximum available irrigation water amount 3000 m3 ha 3300 m3 ha 3600 m3 ha 3900 m3 ha 4200 m3 ha 4500 m3 ha scenarios 5 different groundwater depth scenarios 1 m 1 5 m 2 m 2 5 m 3 m and 5 different groundwater salinity scenarios 2 g l 2 25 g l 2 5 g l 2 75 g l 3 g l were set 2 3 model solution genetic algorithm genetic algorithm ga is a heuristic search method based on the evolutionary mechanisms of natural selection and genetics holland 1975 ga has recently received enough attention and successfully been used to many complex optimization problems liu 1998 2 4 data collection table 1 shows the maximum maize evapotranspiration in different month the maximum maize evapotranspiration considered to potential crop evapotranspiration is calculated as e t m k c e t 0 kc is the crop coefficient with different values at different growing stages which can be calculated according to the fao 56 et0 is the reference crop evapotranspiration mm calculated by the fao penman monteith methods the required meteorological data were from the linhe meteorological station fig 1 table 2 presents the basic input parameters of the model including all parameters of optimal module and agro hydrological module these parameters in optimal module are acquired from government reports and statistical data and the used parameters in agro hydrological module were obtained from xue et al 2018 3 results 3 1 optimal results of total irrigation and drainage with various groundwater levels and salinity fig 3 shows the optimal irrigation allocation drainage and system benefit objective function values under different maximum available irrigation water amount levels and groundwater depths generally irrigation and drainage allocation are closely linked with the maximum available irrigation water amount and groundwater depth in a certain groundwater depth with an increased available irrigation water amount the value of irrigation and drainage water allocation shows an increasing trend and system benefit experienced a rapid increasing trend first and then kept a slow increasing trend it is obvious that the optimal irrigation water allocation reached the maximum available irrigation water amount level taking 1 5 m of groundwater depth scenario as an example the optimal irrigation water allocation increases from 300 mm to 450 mm drainage allocation increases from 0 mm to 218 mm and system benefit increases from 13 212 yuan ha to 15 623 yuan ha when the maximum available irrigation water amount 3000 m3 ha to 4500 m3 ha respectively as we expect no drainage present when the available irrigation water is relative deficit and groundwater depth gh is deeper specifically we noticed that there is no drainage under scenarios of gh 1 m irrigation water 300 mm and gh 1 5 2 2 5 3 m irrigation water 300 330 mm field irrigation benefit have significant change with various irrigation amount as groundwater levels are controlled by drainage initial groundwater depth has almost no impact to final field irrigation benefit system benefit grows rapidly from 13190 4 yuan ha 15 213 yuan ha to averagely with irrigation water from 300 mm to 390 mm while weak benefit growth experiences when irrigation amount is more than 390 mm correspondingly the drainage decreases with increasing of groundwater depth under smaller irrigation water 390 mm and the maximum drainage is obtained with gh 1 5 m under larger irrigation water 390 mm the system benefit has the same trend as drainage at a smaller water supply level 390 mm the system benefit decreased as increasing of groundwater depth while at a larger water supply level 390 mm the maximum system benefit is obtained with 1 5 m of groundwater depth for example the drainage decreases from 100 mm to 2 mm the benefit decreases from 14 950 yuan ha to 14 677 yuan ha with irrigation water supply 3600 m3 ha under different groundwater level scenarios while the maximum drainage is 198 mm and the greatest benefit is 15 612 yuan ha with irrigation water 4200 m3 ha under gh 1 5 m the irrigation allocation and drainage are also greatly affected by the salinity of groundwater fig 4 the drainage increases with the increase of groundwater salinity and irrigation water supply level and the increasing magnitude is more obvious with high salinity the salinity of groundwater has no effect on the drainage when the irrigation amount is deficit but the drainage is most sensitive to the increase of irrigation when the groundwater salinity is higher 3 g l especially there is no the drainage with irrigation water of 300 mm and 330 mm when some groundwater salinity is less than 3 g l while the drainage is 25 mm 50 mm under the same irrigation amount with groundwater salinity 3 g l furthermore the results also demonstrate that the irrigation system benefit increases with the increase of irrigation water amount but benefit change scope is obvious difference for various groundwater salinity when groundwater salinity is less than 2 75 g l full irrigation can enhance averagely the irrigation system benefit from 15 453 yuan ha to 15 651 yuan ha while when groundwater salinity is higher than 2 75 g l it is from 15 149 yuan ha to 15 663 yuan ha 3 2 optimal monthly irrigation and drainage water allocation the monthly irrigation drainage schemes are optimized based on the optimization model take the optimal irrigation allocation drainage and groundwater depth changes under groundwater depth of 1 5 m and groundwater salinity of 2 5 g l as an example fig 5 the results indicated that the more allocating irrigation water amount promoted the more drainage influencing the deeper groundwater depth a large amount of drainage makes the groundwater depth drop sharply while the irrigation increases resulting in deep leakage to raise groundwater level and the groundwater depth does not change obviously without drainage there existed fluctuations of monthly irrigation amount and drainage among different total irrigation quota from the figure there is no drainage with less total irrigation quota 300 mm and 330 mm the optimal irrigation water amount is mainly affected by soil water and salinity stress when total irrigation quota increases drainage occurs in the early stage of crop growth which is mainly related to the model salt threshold constraint 4 discussion 4 1 field net water consumption under different irrigation and drainage management in our study drainage is managed with irrigation decision usually drainage have higher salinity and can t be used directly such drainage is also considered the water consumption to keep crop within a suitable growth environment unlike traditional field water consumption which generally is only field evapotranspiration cui et al 2019 jiang et al 2012 tripler et al 2011 here the sum of actual evapotranspiration and drainage was defined as the field net water consumption as can be seen from table 3 the averagely field net water consumption increases from 461 mm to 719 mm with irrigation water allocation 300 mm to 450 mm it is obvious that the field net water consumption under the maximum irrigation water allocation are higher than that under the minimum irrigation water allocation when irrigation water allocation is smaller 300 mm 390 mm every 10 increment of irrigation water allocation results in averagely 39 improvement of system net water consumption and further 15 improvement of system benefit increased irrigation water allocation will bring a higher increase rate of system net water consumption and benefit however when irrigation water allocation is larger 390 mm 450 mm every 10 increment of irrigation water allocation results in averagely 13 improvement of system net water consumption and only 2 improvement of system benefit this indicates that full irrigation results in a lot of water consumption but little increment of system benefit costa et al 2007 karimi and gomrokchi 2011 and martínez romero et al 2019 also found that limited irrigation can potentially save agricultural water with no or only slight decline of yield thus in semi arid regions with shallow groundwater appropriate deficit irrigation could reduce net water consumption and save water resources without affecting crop growth and income moreover based on the optimized irrigation and drainage management the net water consumption of maize field shows a slow downward trend with the increase of groundwater depth under smaller irrigation water allocation 390 mm the result is also one of the reasons which the system benefit decreased as increasing of groundwater depth at a smaller water supply level 390 mm fig 3 4 2 response of irrigation water productivity to different irrigation and drainage management the irrigation water productivity defined as the value of the output produced per unit amount of irrigation water consumed shows a decreasing trend with the drawdown of groundwater depth when less irrigation is applied ranging from averagely 4 34 to 4 20 yuan m3 the irrigation water productivity experiences an increasing trend and then decreasing trend when larger irrigation is applied ranging from averagely 3 69 to 3 72 yuan m3 and 3 72 to 3 64 yuan m3 respectively table 4 obviously this range of change is narrow groundwater depth of 1 5 m will bring greatest irrigation water productivity is larger when irrigation water allocation is larger 390 mm 450 mm the response of irrigation water productivity to salinity of groundwater is different to the response under the condition of groundwater depth at 300 mm to 450 mm irrigation water allocation with the increase of groundwater salinity although the irrigation water productivity shows different trend it is generally slow downward trend on the other hand under 1 m 1 5 m 2 m 2 5 m and 3 m groundwater depth or 2 g l 2 25 g l 2 5 g l 2 75 g l 3 g l groundwater salinity condition with the increase of irrigation water allocation the irrigation water productivity shows a averagely 27 decreasing trend the results are similar to researches of pereira et al 2012 and howell 2006 who stated that water productivity tended to increase with declining of irrigation totally the responses of irrigation water productivity to irrigation water allocation amount were significant than those to groundwater depth and groundwater salinity the main reason is that could be climate conditions response of crop yield was highly dependent on irrigation water amount applied because of less precipitation in arid areas we found that the irrigation water productivity has a negative correlation with the system benefit the normalization method is used to transform variables to standard scores bounded by 0 0 and 1 0 schenatto et al 2017 the rate of irrigation water productivity decline and system benefit increase expressed by slope was obtained from their own simple curve respectively fig 6 as a result piecewise function with two slopes is used to describe curve characteristic of the system benefit the slope of the irrigation water productivity curve ranges from 0 0065 to 0 0054 under different groundwater depth and 0 0064 to 0 005 under different groundwater salinity the slope of the system benefit has a bigger magnitude than that of irrigation water productivity when irrigation water allocation is less and then this showed no further big magnitude and actually smaller overall these results mean that the growth rate of system benefit is greater than the decrease rate of irrigation water productivity with a certain proportion of irrigation water allocation 4 3 effectiveness and superiority of the model the soil root zone showed desalination with the increase of irrigation water allocation under different groundwater depths fig 7 a and groundwater salinity scenarios fig 7b from the figure it is remarkable that the salt will be accumulated in the root zone when irrigation water allocation is less and the root zone will be desalinated when irrigation water allocation is larger in any case the accumulated salt content in the root zone during the growing period was mostly in the range of 0 4 0 05 g kg this means the highest desalinization achieved is 0 4 g kg by the irrigation drainage collaborative optimization model ji 2017 got conclusion by simulation model that the total salt content of soil increased by 0 29 g kg with the irrigation allocation 338 mm thus the developed model could effectively alleviate the aggravation of soil salinization to further demonstrate the advantages of optimizing the irrigation drainage collaborative allocation in agriculture water management a conventional optimal irrigation allocation model only irrigation water amount is optimized was also developed to compare the performances between these two models the objective and constraints of the conventional model are the same as the new developed model the decision variables are only the irrigation targets in the conventional model drainage as a pathway of in which the groundwater may move along can be obtained through the following formula tang et al 2007 de γ d h d g h h d g h 0 h d g h where γd is drainage coefficient describing groundwater table decrease ratio due to the difference between groundwater table and drainage level γ d 0 04 based on experimental data at the shahaoqu experimental station in the hetao irrigation district xue et al 2017 hd is the bottom level of drainage m gh is groundwater depth m optimized irrigation solutions of conventional irrigation decision model were obtained with 1 5 m and 2 m of the bottom level of drainage under the same groundwater depth and groundwater salinity levels it can be observed that this change of model structure lead to significant variations of objective values the system benefits of conventional model would be 12936 15329 yuan ha with 1 5 m of the bottom level of drainage under groundwater depth scenarios and 12936 15401 yuan ha with 2 m of the bottom level besides the system benefits of conventional model would be 12751 15537 yuan ha with 1 5 m of the bottom level of drainage under groundwater salinity scenarios and 12834 15572 yuan ha with 2 m of the bottom level fig 8 shows the variations in the system benefit under different groundwater depth and groundwater salinity when comparing the conventional model results against the new developed model solutions the conventional model could achieve lower system benefit under all the scenarios than that of the new developed model the results show that irrigation allocation schemes without collaborative drainage allocation would lead to 0 4 2 less system benefits under different groundwater depth while 0 8 less system benefits under different groundwater salinity from fig 8a the system benefits under 1 5 m of the bottom level of drainage are higher than that under 2 m of the bottom level of drainage when irrigation water allocation is 300 mm and 330 mm and groundwater depth is 1 m and 1 5 m respectively conversely the system benefits under 1 5 m of the bottom level of drainage are less than that under 2 m of the bottom level of drainage when irrigation water allocation is more than 330 mm and groundwater depth is 1 m and 1 5 m respectively the results demonstrate a higher bottom level of drainage 1 5 m with larger drainage would not always lead to a lower system benefits than a lower bottom level of drainage 2m additionally the system benefits have little difference between 1 5 m and 2 m of the bottom level of drainage under deeper groundwater depth conditions however the system benefits for shallower groundwater depth are different which means gave different irrigation strategies with different drainage schemes this is the same results under different groundwater salinity singh 2016 believed that appropriate drainage systems are essential to control salinization problems in irrigated areas the results from the study also indicate that an acceptable and suitable drainage amount should be decided based on irrigation water allocation and actual situation associated with groundwater depth groundwater salinity and so on therefore compared with the conventional optimal irrigation allocation model the established i d collaborative model has following advantages 1 it could provide the suitable water allocation schemes to reduce the accumulation of soil salt and the aggravation of soil salinization for enhancing the capacity of agriculture sustainable development 2 the optimal water allocation schemes obtained by the proposed with higher economic benefit 5 conclusion an innovative model framework of irrigation drainage collaborative optimal allocation is developed to enhance field irrigation efficiency and control land salinization in arid and semi arid area the framework integrating the agro hydrological process with optimization model could generate the solutions of irrigation drainage water allocation associated with various groundwater depth and groundwater salinity scenarios compared with previous studies the new model provides the collaborative irrigation and drainage water allocation alternatives for decision makers who can enhance field irrigation benefit the results also demonstrate that the proposed model framework is applicable especially for arid area with shallow groundwater in which agriculture development is closely constrained by water shortage and soil salinization for the irrigated agricultural area it is also an important problem to improve irrigation water productivity and other specific objectives for the irrigated agricultural area the performance of the developed model depends on field hydrological process which is difficult to apply in the future study the innovative model framework should be improved for irrigation area scale also multiple objectives of economic productivity and ecology will be considered in our studies credit authorship contribution statement xuemin li methodology formal analysis writing original draft chenglong zhang writing review editing zailin huo conceptualization resources writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the national key research and development program of china china 2017yfc0403301 and the national natural science foundation of china china 51639009 
5554,agricultural production in arid and semi arid area faces a global problem of water resources shortage and land salinization irrigation and drainage are the important measure to enhance crop yield and control soil salinity generally at field scale only irrigation is optimized to pursue the higher water use efficiency and crop yield while drainage is difficult to optimize owing to controlled by dynamic groundwater levels here we develop a new collaborative optimization model of irrigation and drainage to improve irrigation water use efficiency and to control soil salinity the model is formulated by integrating simulation of physical processes of field water salt balance and a genetic algorithm based optimization model the new model is to search optimized irrigation and drainage strategic decision for enhancing field economic benefit with the condition controlling salinity with limited water resources then a case study on optimally allocating irrigation and drainage water to different growth stages of maize field in the hetao irrigation district arid area of northwest china shows enhanced applicability of the developed model five groundwater depth levels 1 m 1 5 m 2 m 2 5 m and 3 m and five groundwater salinity levels 2 g l 2 25 g l 2 5 g l 2 75 g l and 3 g l are provided to show and compare the solutions of the optimal irrigation and drainage water allocation results indicate the developed model can supply reasonable field monthly irrigation and drainage decision with considering field hydrology especially contribution of groundwater to crop water demand and groundwater role to soil salt accumulation the contrary relationship between system benefit and irrigation water use efficiency was described successfully by the developed model and compared with traditional single irrigation optimization model the developed irrigation drainage collaborative optimization model can enhance drainage function to keep the optimal groundwater levels and improve the system benefit by 0 8 overall the developed model can provide more applicable irrigation water and drainage strategies to the sustainable development of irrigation agriculture keywords irrigation water allocation optimization agricultural drainage water shallow groundwater soil salinity 1 introduction increasing the crop yield is essential to meet the challenges of population growth and increased food demand boyer et al 2012 while farmers in arid areas are facing increasing irrigation water resources shortage as the limited precipitation improving irrigation water productivity is a vital step for increasing more agricultural products with limited irrigation water resources surendran et al 2016 it is noteworthy that soil salinity is another serious problem beside limit irrigation resources faced by irrigation agriculture in arid and semi arid irrigated areas asgari et al 2012 mosaffa and sepaskhah 2019 wichelns and qadir 2015 lots practices have showed effective drainage management can improve field salinity ritzema et al 2006 in these cases there is a limitation for increasing total irrigation water amount the most contribution of the increase in agricultural production will come from improvement and expansion of irrigation and drainage systems schultz et al 2005 therefore it is significant and practical to make effective irrigation and drainage water management strategies for improving agricultural water use efficiency and ensuring sustainable agro economy development it is reported that a large number of optimization models for agriculture water management including traditional methods like linear programming nonlinear programming dynamic programming anwar and clarke 2001 ghahraman and sepaskhah 2004 srinivasa prasad et al 2011 uncertain programming methods li et al 2019 li et al 2017a b zhang et al 2019 like interval mathematical programming imp stochastic mathematical programming smp fuzzy mathematical programming fmp and artificial intelligence search methods like genetic algorithms ga artificial neural network ann ant colony optimization aco particle swarm optimization pao simulated annealing algorithm sa brown et al 2010 hamed ketabchi 2015 safavi and enteshari 2016 safavi and esmikhani 2013 these models could obtain the irrigation optimal allocation solutions in irrigation water management furthermore genetic algorithm ga is one of the frequently used algorithms to solve optimization problems for water resource management and has been widely used in irrigation water allocation moghaddasi et al 2010 wen et al 2017 it is noted that previous studies about the optimizing agriculture water allocation were limited to conjunctive use of surface water and groundwater for irrigation li et al 2017a b li et al 2018a b mandare et al 2008 the impact of shallow saline groundwater on agricultural production and irrigation induced environmental problems occurred concurrently with agricultural irrigation water allocation have less attention in recent years more attention has been paid to the contribution of shallow groundwater evapotranspiration to crop evapotranspiration ayars et al 2006 gao et al 2015 huo et al 2012 xue et al 2017 however the shallow saline groundwater may lead to accelerated salt accumulation in crop root zone karimov et al 2014 shah et al 2011 much modeling research on the relationship between soil salinization and groundwater depth has been undertaken gonçalves et al 2006 hammecker et al 2012 mirlas 2012 given groundwater depth was the main influencing factor of soil salinity yu et al 2010 moreover guang et al 2012 and hossain et al 2011 concluded that land salinization and shallow groundwater level caused the crop yield reduction controlled drainage also known as drainage water management is a best management practice to control groundwater level in the crop growth season for increasing crop production fisher et al 1999 li et al 2018a b a well planned drainage system can play a buffer role to much shallower groundwater levels this is consistent with ritzema 2016 conclusion that drainage is an effective tool to prevent soil salinity in arid and semi arid regions riley et al 2009 showed that crop yield differences between traditional drainage and drainage management some studies have shown that controlled drainage may lead to a 10 20 even 64 increase in maize production fisher et al 1999 hunt 1993 ng et al 2002 some simulation models are used to quantitatively describe controlled drainage management in the complex agro hydrological process du et al 2017 jouni et al 2018 wahba 2017 since numerous computer based model and field experiment may vary depending on scenario analysis optimization model is needed to obtain the best one strategy in different environments and under different weather conditions singh 2014 prathapar et al 1997 developed a hierarchical multi criterion salt water and groundwater management framework for optimal land uses by minimizing the water table rise and maintaining soil salinity singh 2018 applied saltmod model to evaluate the optimal management strategies for preventing from salinization to reflect conflicting between agriculture production and ecosystem irrigation and drainage management should be done simultaneously however there are few attempts to develop methods aiming at water allocation in irrigation drainage collaborative systems for arid and semi arid area there are two types of decision variables including irrigation water amount and drainage water amount in a subarea of an irrigation dominated where salinity is one of the major restrictions to the irrigation sustainable development therefore an irrigation drainage collaborative optimization model is developed for supporting irrigation drainage water management the model is coupled an agro hydrological process in order to better describe complex interactions among crop soil water climate and groundwater within a general optimization model this model is similar to controlled drainage strategy with effective hydrology based optimal model controlled drainage management focus on simulation models or single drainage while the specific goal of this research is to allocate limited irrigation water resource and drainage to different growth stages in order to obtain benefit of crop increase to demonstrate its applicability the developed model is then applied to a real world case study in the hetao irrigation district northeast china results of optimal irrigation water and drainage allocation under different groundwater levels and groundwater salinity concentrations are generated which can be used for providing strategies for decision makers to make irrigation drainage water allocation 2 methodology 2 1 site description the hetao irrigation district hid is one of three largest irrigation districts in china located in upper yellow river basin fig 1 the hid covers a total area of 10 68 103 km2 and more than 60 are the irrigated land chen et al 2020 about 4 7 billion m3 water is irrigated from the yellow river every year with salinity of approximately 0 5 g l it is a typical arid or semi arid agricultural area average annual precipitation is 170 mm mainly happens between june and september and annual pan evaporation is 2300 mm average annual temperature is 8 8 c while the minimum and maximum are 12 3 c in january and 23 8 c in july respectively chen et al 2018 the topography is relative flat with only 0 2 slope the groundwater is very shallow and the water table depth varies between 0 5 m and 3 0 m within one year period liu et al 2017 ren et al 2016 the three major crops in the hid are wheat maize and sunflower sun et al 2016 irrigation water and farmland drainage naturally flow into the drainage canal because of gravity poor drainage and soil salinization are a threat to irrigated agriculture in the region such irrigation drainage collaborative management is necessary on irrigated areas 2 2 optimization model development an irrigation drainage water collaborative allocation system is considered in a maize land which is the largest proration of farmland in the study area the decision maker is responsible for allocating irrigation water resources and drainage amount in growth stages april may june july august and september for sustainable agricultural irrigation development different from other field irrigation decision optimization models sepahvand et al 2019 soundharajan and sudheer 2009 zhai et al 2019 irrigation and drainage amount are considered as the decision factors in the developed optimization model the interactive irrigation water and drainage should be allocated efficiently especially in arid and semi arid areas with shallow saline groundwater given shallow groundwater can contribute to crop water requirement and resulted in salt accumulation in root zone irrigation and drainage can result in various groundwater levels which finally produce different crop yields in fact the developed optimization model is to identify the critical groundwater levels by drainage optimization during the process of irrigation drainage collaborative allocation considering the physical soil water and salt process in the study area with shallow groundwater there are two modules namely the agro hydrological module and the optimal module in a certain land farmers pay close attention to the economic benefits of crop yield the massive response of crop yield to water and salt stress cannot be glossed over in water shortage and soil salinization area and the crop growth process is a simplified version by considering the stress of temperature water and salt we use the soil water and salt balance process to represent water and salt movement in soil in addition groundwater water and salt balance are developed for shallow aquifer movement with various inputs and outputs involving in deep percolation groundwater evaporation and drainage the agro hydrological module can be calculated at a month time step finally crop yield can be generated by the field hydrological model maximizing net economic benefit determined by crop yield is the objective of optimal module the objective should be subject to constraints of water demand available water supply of yellow river irrigation water resource and groundwater and soil salt content threshold the decision making framework is depicted in fig 2 2 2 1 objective function based on the subjectivity of farmers whose aim is to maximize the economic benefits per unit the objective is to pursue maximized economic benefits which is the difference between the profit from crop yield and water costs eq 1a represents this concept as an objective function 1a maxy c y m 1 k y 1 tet te t m c w t t i w t η where t is index of the monthly stages t 1 2 6 representing april may june july august and september respectively y is the system net economic benefit per ha for the farmers yuan ha 1 c is the crop net price with consideration of crop market price and the planting costs yuan kg 1 in this study c is average 1 9 yuan kg 1 for maize from local statistical data ym is the maximum crop yield kg ha 1 ym is 10000 kg ha 1 for maize from the local survey y m 1 k y 1 tet te t m is actual crop yield estimated by the fao expression ren et al 2016 ky is yield responses factory indicating the effect of evapotranspiration reduction on production loss adopting the recommended value in fao56 1 25 for maize tet and tetm are the actual and maximum cumulative evapotranspiration of the total growth stage mm cw is irrigation water price yuan m 3 iw is the amount of irrigation per month mm month 1 η is the utilization coefficient of irrigation water t t i w t η is the gross amount of irrigation during crop growth period m3 ha 1 2 2 2 constraints the above objective is subject to the following constraints 1 crop evapotranspiration constraint total actual crop evapotranspiration during growth stage is limited to the maximum total crop evapotranspiration the actual crop evapotranspiration of a certain time period t is also limited to the maximum crop evapotranspiration at time period t 2a tet t e t m 2b e t t e t m t moreover the actual crop evapotranspiration is used to estimate the crop yield depending on the water stress and salinity stress in arid saline region it is calculated with eqs 2c 2g from fao 56 allen et al 1998 domínguez et al 2011 2c tet t t e t t 2d e t t k cbt k w t k s t e t 0 t 2e k wt 0 θ t θ wpsalt t θ t θ wpsalt t θ c θ wpsalt t θ wpsalt t θ t θ c 1 θ t θ c 2f k st 1 b 100 k y e c et e c m e c et e c m 1 e c et e c m 2g θ wpsalt t θ wp b e c e t e c m 100 θ fc θ wp where et and etm is the monthly actual evapotranspiration and monthly maximum evapotranspiration mm month 1 et0 is reference crop evapotranspiration mm month 1 kcb is the basal crop coefficients et0 and kc are calculated according to the fao 56 penman monteith approach and meteorological data were collected from the linhe meteorological station ks is soil salinity stress coefficient kw is water stress θ is the average soil water content of the root zone m3 m 3 θfc is the soil water content at saturation of the root zone m3 m 3 θwp is the soil water content at wilting point m3 m 3 θwpsalt is the soil water content at wilting point under saline conditions m3 m 3 θc is the soil water content at the critical point of water stress m3 m 3 ece is the electrical conductivity of the saturation extract of the soil ds m 1 and 1 ds m 1 0 64 g l 1 abrol et al 1988 asce 1996 ecm is the threshold of the electrical conductivity of the saturation extract of the soil ds m 1 b is the reduction factor ds 1 m 2 total water availability constraints the gross amount of irrigation water allocation should not be larger than irrigation water availability during growth period 2h t t i w t η q yw where qyw is the maximum available irrigation water amount m3 3 soil water and salt balance of the root zone constraints the soil water and salt balance model with monthly temporal step describes the change of soil water and salt storage of root zone the soil water storage of the root zone during a certain time period equals to the soil water storage of the last time period and inflow to root zone minus the outflow in the hid the surface runoff can be neglected because of low rainfall and relatively flat topography groundwater evaporation must be considered due to an intense exchange between the shallow groundwater and soil water inflow to root zone includes irrigation iw precipitation p groundwater evaporation etg the outflow includes deep percolation re and crop actual evapotranspiration et there is deep percolation only when the soil water content is greater than the water content at saturation of the root zone the root zone s water balance is calculated as 2i w t 1 w t p t i w t e t g t r e t e t t 2j w t z θ t where w is the soil water storage mm month 1 p is the precipitation mm month 1 iw is the amount of irrigation mm month 1 etg is the groundwater evaporation mm month 1 re is the deep percolation mm month 1 et is the evapotranspiration mm month 1 and z is the depth of root zone here z 1 m groundwater water balance eq 2k is used to get monthly groundwater table depth groundwater may flow along several different pathways including vertical groundwater evaporation horizontal drainage and deep seepage from the root zone groundwater evaporation is estimated as an empirical function of groundwater table depth and the water evaporation xu et al 2010 as follows 2k 1000 μ g h t 1 g h t e t gt r e t d e t 2l e t g a e b g h t e 0 t where μ is the specific saturated soil water content hao et al 2013 indicating the volumetric fraction of water yielded by a given aquifer under gravity μ 0 07 gh is the groundwater table depth m de is the drainage a and b are dimensionless empirical parameters related to soil type land use and vegetation obtained from experimental data of the shahaoqu experimental station a 1 81 b 1 42 xu et al 2010 e0 is the open water evaporation mm month 1 salt transports with soil water flow in vertical soil profile of root zone the downward movement of salt is caused by deep percolation while the upward movement is caused by capillary rise from groundwater when we calculated the salinity of groundwater it is assumed that groundwater salinity concentration changes in the major fluctuation range of groundwater table for the groundwater the salt input is due to the percolation from root zone while the output is due to the drainage the salt balance in the soil and the groundwater is calculated as follows 2m r s t 1 r s t i w t s y e t g t s g t r e t s c t 2n g s t 1 g s t e t g t d e t s g t r e t s c t 2o g s t 1 z g g h t g h t 1 s g t 1 where rs is the soil salt storage mg m 2 sy is the salt concentration of the irrigation water mg l 1 sg is the salinity concentration in the groundwater mg l 1 sc is the salt concentration of the soil mg l 1 gs is the salt storage of groundwater mg m 2 zg is the difference between the groundwater table depth and the depth that groundwater fluctuations cannot reach mm 4 salt accumulation at the end of growth period constraint we assume that salt accumulation should not exceed 640 mg l 1 during the growth stage for the agriculture sustainable development li 2017 2p s c end s c ini 640 5 nonnegativity constraint all the decision variables of the model should not be negative the constraint can be expressed as 2q i w t d e t 0 t irrigation decision could be restricted by multiple factors such as constraints on water resources and groundwater depth different available water resources and groundwater depth scenarios have different effects on irrigation drainage decisions 6 different maximum available irrigation water amount 3000 m3 ha 3300 m3 ha 3600 m3 ha 3900 m3 ha 4200 m3 ha 4500 m3 ha scenarios 5 different groundwater depth scenarios 1 m 1 5 m 2 m 2 5 m 3 m and 5 different groundwater salinity scenarios 2 g l 2 25 g l 2 5 g l 2 75 g l 3 g l were set 2 3 model solution genetic algorithm genetic algorithm ga is a heuristic search method based on the evolutionary mechanisms of natural selection and genetics holland 1975 ga has recently received enough attention and successfully been used to many complex optimization problems liu 1998 2 4 data collection table 1 shows the maximum maize evapotranspiration in different month the maximum maize evapotranspiration considered to potential crop evapotranspiration is calculated as e t m k c e t 0 kc is the crop coefficient with different values at different growing stages which can be calculated according to the fao 56 et0 is the reference crop evapotranspiration mm calculated by the fao penman monteith methods the required meteorological data were from the linhe meteorological station fig 1 table 2 presents the basic input parameters of the model including all parameters of optimal module and agro hydrological module these parameters in optimal module are acquired from government reports and statistical data and the used parameters in agro hydrological module were obtained from xue et al 2018 3 results 3 1 optimal results of total irrigation and drainage with various groundwater levels and salinity fig 3 shows the optimal irrigation allocation drainage and system benefit objective function values under different maximum available irrigation water amount levels and groundwater depths generally irrigation and drainage allocation are closely linked with the maximum available irrigation water amount and groundwater depth in a certain groundwater depth with an increased available irrigation water amount the value of irrigation and drainage water allocation shows an increasing trend and system benefit experienced a rapid increasing trend first and then kept a slow increasing trend it is obvious that the optimal irrigation water allocation reached the maximum available irrigation water amount level taking 1 5 m of groundwater depth scenario as an example the optimal irrigation water allocation increases from 300 mm to 450 mm drainage allocation increases from 0 mm to 218 mm and system benefit increases from 13 212 yuan ha to 15 623 yuan ha when the maximum available irrigation water amount 3000 m3 ha to 4500 m3 ha respectively as we expect no drainage present when the available irrigation water is relative deficit and groundwater depth gh is deeper specifically we noticed that there is no drainage under scenarios of gh 1 m irrigation water 300 mm and gh 1 5 2 2 5 3 m irrigation water 300 330 mm field irrigation benefit have significant change with various irrigation amount as groundwater levels are controlled by drainage initial groundwater depth has almost no impact to final field irrigation benefit system benefit grows rapidly from 13190 4 yuan ha 15 213 yuan ha to averagely with irrigation water from 300 mm to 390 mm while weak benefit growth experiences when irrigation amount is more than 390 mm correspondingly the drainage decreases with increasing of groundwater depth under smaller irrigation water 390 mm and the maximum drainage is obtained with gh 1 5 m under larger irrigation water 390 mm the system benefit has the same trend as drainage at a smaller water supply level 390 mm the system benefit decreased as increasing of groundwater depth while at a larger water supply level 390 mm the maximum system benefit is obtained with 1 5 m of groundwater depth for example the drainage decreases from 100 mm to 2 mm the benefit decreases from 14 950 yuan ha to 14 677 yuan ha with irrigation water supply 3600 m3 ha under different groundwater level scenarios while the maximum drainage is 198 mm and the greatest benefit is 15 612 yuan ha with irrigation water 4200 m3 ha under gh 1 5 m the irrigation allocation and drainage are also greatly affected by the salinity of groundwater fig 4 the drainage increases with the increase of groundwater salinity and irrigation water supply level and the increasing magnitude is more obvious with high salinity the salinity of groundwater has no effect on the drainage when the irrigation amount is deficit but the drainage is most sensitive to the increase of irrigation when the groundwater salinity is higher 3 g l especially there is no the drainage with irrigation water of 300 mm and 330 mm when some groundwater salinity is less than 3 g l while the drainage is 25 mm 50 mm under the same irrigation amount with groundwater salinity 3 g l furthermore the results also demonstrate that the irrigation system benefit increases with the increase of irrigation water amount but benefit change scope is obvious difference for various groundwater salinity when groundwater salinity is less than 2 75 g l full irrigation can enhance averagely the irrigation system benefit from 15 453 yuan ha to 15 651 yuan ha while when groundwater salinity is higher than 2 75 g l it is from 15 149 yuan ha to 15 663 yuan ha 3 2 optimal monthly irrigation and drainage water allocation the monthly irrigation drainage schemes are optimized based on the optimization model take the optimal irrigation allocation drainage and groundwater depth changes under groundwater depth of 1 5 m and groundwater salinity of 2 5 g l as an example fig 5 the results indicated that the more allocating irrigation water amount promoted the more drainage influencing the deeper groundwater depth a large amount of drainage makes the groundwater depth drop sharply while the irrigation increases resulting in deep leakage to raise groundwater level and the groundwater depth does not change obviously without drainage there existed fluctuations of monthly irrigation amount and drainage among different total irrigation quota from the figure there is no drainage with less total irrigation quota 300 mm and 330 mm the optimal irrigation water amount is mainly affected by soil water and salinity stress when total irrigation quota increases drainage occurs in the early stage of crop growth which is mainly related to the model salt threshold constraint 4 discussion 4 1 field net water consumption under different irrigation and drainage management in our study drainage is managed with irrigation decision usually drainage have higher salinity and can t be used directly such drainage is also considered the water consumption to keep crop within a suitable growth environment unlike traditional field water consumption which generally is only field evapotranspiration cui et al 2019 jiang et al 2012 tripler et al 2011 here the sum of actual evapotranspiration and drainage was defined as the field net water consumption as can be seen from table 3 the averagely field net water consumption increases from 461 mm to 719 mm with irrigation water allocation 300 mm to 450 mm it is obvious that the field net water consumption under the maximum irrigation water allocation are higher than that under the minimum irrigation water allocation when irrigation water allocation is smaller 300 mm 390 mm every 10 increment of irrigation water allocation results in averagely 39 improvement of system net water consumption and further 15 improvement of system benefit increased irrigation water allocation will bring a higher increase rate of system net water consumption and benefit however when irrigation water allocation is larger 390 mm 450 mm every 10 increment of irrigation water allocation results in averagely 13 improvement of system net water consumption and only 2 improvement of system benefit this indicates that full irrigation results in a lot of water consumption but little increment of system benefit costa et al 2007 karimi and gomrokchi 2011 and martínez romero et al 2019 also found that limited irrigation can potentially save agricultural water with no or only slight decline of yield thus in semi arid regions with shallow groundwater appropriate deficit irrigation could reduce net water consumption and save water resources without affecting crop growth and income moreover based on the optimized irrigation and drainage management the net water consumption of maize field shows a slow downward trend with the increase of groundwater depth under smaller irrigation water allocation 390 mm the result is also one of the reasons which the system benefit decreased as increasing of groundwater depth at a smaller water supply level 390 mm fig 3 4 2 response of irrigation water productivity to different irrigation and drainage management the irrigation water productivity defined as the value of the output produced per unit amount of irrigation water consumed shows a decreasing trend with the drawdown of groundwater depth when less irrigation is applied ranging from averagely 4 34 to 4 20 yuan m3 the irrigation water productivity experiences an increasing trend and then decreasing trend when larger irrigation is applied ranging from averagely 3 69 to 3 72 yuan m3 and 3 72 to 3 64 yuan m3 respectively table 4 obviously this range of change is narrow groundwater depth of 1 5 m will bring greatest irrigation water productivity is larger when irrigation water allocation is larger 390 mm 450 mm the response of irrigation water productivity to salinity of groundwater is different to the response under the condition of groundwater depth at 300 mm to 450 mm irrigation water allocation with the increase of groundwater salinity although the irrigation water productivity shows different trend it is generally slow downward trend on the other hand under 1 m 1 5 m 2 m 2 5 m and 3 m groundwater depth or 2 g l 2 25 g l 2 5 g l 2 75 g l 3 g l groundwater salinity condition with the increase of irrigation water allocation the irrigation water productivity shows a averagely 27 decreasing trend the results are similar to researches of pereira et al 2012 and howell 2006 who stated that water productivity tended to increase with declining of irrigation totally the responses of irrigation water productivity to irrigation water allocation amount were significant than those to groundwater depth and groundwater salinity the main reason is that could be climate conditions response of crop yield was highly dependent on irrigation water amount applied because of less precipitation in arid areas we found that the irrigation water productivity has a negative correlation with the system benefit the normalization method is used to transform variables to standard scores bounded by 0 0 and 1 0 schenatto et al 2017 the rate of irrigation water productivity decline and system benefit increase expressed by slope was obtained from their own simple curve respectively fig 6 as a result piecewise function with two slopes is used to describe curve characteristic of the system benefit the slope of the irrigation water productivity curve ranges from 0 0065 to 0 0054 under different groundwater depth and 0 0064 to 0 005 under different groundwater salinity the slope of the system benefit has a bigger magnitude than that of irrigation water productivity when irrigation water allocation is less and then this showed no further big magnitude and actually smaller overall these results mean that the growth rate of system benefit is greater than the decrease rate of irrigation water productivity with a certain proportion of irrigation water allocation 4 3 effectiveness and superiority of the model the soil root zone showed desalination with the increase of irrigation water allocation under different groundwater depths fig 7 a and groundwater salinity scenarios fig 7b from the figure it is remarkable that the salt will be accumulated in the root zone when irrigation water allocation is less and the root zone will be desalinated when irrigation water allocation is larger in any case the accumulated salt content in the root zone during the growing period was mostly in the range of 0 4 0 05 g kg this means the highest desalinization achieved is 0 4 g kg by the irrigation drainage collaborative optimization model ji 2017 got conclusion by simulation model that the total salt content of soil increased by 0 29 g kg with the irrigation allocation 338 mm thus the developed model could effectively alleviate the aggravation of soil salinization to further demonstrate the advantages of optimizing the irrigation drainage collaborative allocation in agriculture water management a conventional optimal irrigation allocation model only irrigation water amount is optimized was also developed to compare the performances between these two models the objective and constraints of the conventional model are the same as the new developed model the decision variables are only the irrigation targets in the conventional model drainage as a pathway of in which the groundwater may move along can be obtained through the following formula tang et al 2007 de γ d h d g h h d g h 0 h d g h where γd is drainage coefficient describing groundwater table decrease ratio due to the difference between groundwater table and drainage level γ d 0 04 based on experimental data at the shahaoqu experimental station in the hetao irrigation district xue et al 2017 hd is the bottom level of drainage m gh is groundwater depth m optimized irrigation solutions of conventional irrigation decision model were obtained with 1 5 m and 2 m of the bottom level of drainage under the same groundwater depth and groundwater salinity levels it can be observed that this change of model structure lead to significant variations of objective values the system benefits of conventional model would be 12936 15329 yuan ha with 1 5 m of the bottom level of drainage under groundwater depth scenarios and 12936 15401 yuan ha with 2 m of the bottom level besides the system benefits of conventional model would be 12751 15537 yuan ha with 1 5 m of the bottom level of drainage under groundwater salinity scenarios and 12834 15572 yuan ha with 2 m of the bottom level fig 8 shows the variations in the system benefit under different groundwater depth and groundwater salinity when comparing the conventional model results against the new developed model solutions the conventional model could achieve lower system benefit under all the scenarios than that of the new developed model the results show that irrigation allocation schemes without collaborative drainage allocation would lead to 0 4 2 less system benefits under different groundwater depth while 0 8 less system benefits under different groundwater salinity from fig 8a the system benefits under 1 5 m of the bottom level of drainage are higher than that under 2 m of the bottom level of drainage when irrigation water allocation is 300 mm and 330 mm and groundwater depth is 1 m and 1 5 m respectively conversely the system benefits under 1 5 m of the bottom level of drainage are less than that under 2 m of the bottom level of drainage when irrigation water allocation is more than 330 mm and groundwater depth is 1 m and 1 5 m respectively the results demonstrate a higher bottom level of drainage 1 5 m with larger drainage would not always lead to a lower system benefits than a lower bottom level of drainage 2m additionally the system benefits have little difference between 1 5 m and 2 m of the bottom level of drainage under deeper groundwater depth conditions however the system benefits for shallower groundwater depth are different which means gave different irrigation strategies with different drainage schemes this is the same results under different groundwater salinity singh 2016 believed that appropriate drainage systems are essential to control salinization problems in irrigated areas the results from the study also indicate that an acceptable and suitable drainage amount should be decided based on irrigation water allocation and actual situation associated with groundwater depth groundwater salinity and so on therefore compared with the conventional optimal irrigation allocation model the established i d collaborative model has following advantages 1 it could provide the suitable water allocation schemes to reduce the accumulation of soil salt and the aggravation of soil salinization for enhancing the capacity of agriculture sustainable development 2 the optimal water allocation schemes obtained by the proposed with higher economic benefit 5 conclusion an innovative model framework of irrigation drainage collaborative optimal allocation is developed to enhance field irrigation efficiency and control land salinization in arid and semi arid area the framework integrating the agro hydrological process with optimization model could generate the solutions of irrigation drainage water allocation associated with various groundwater depth and groundwater salinity scenarios compared with previous studies the new model provides the collaborative irrigation and drainage water allocation alternatives for decision makers who can enhance field irrigation benefit the results also demonstrate that the proposed model framework is applicable especially for arid area with shallow groundwater in which agriculture development is closely constrained by water shortage and soil salinization for the irrigated agricultural area it is also an important problem to improve irrigation water productivity and other specific objectives for the irrigated agricultural area the performance of the developed model depends on field hydrological process which is difficult to apply in the future study the innovative model framework should be improved for irrigation area scale also multiple objectives of economic productivity and ecology will be considered in our studies credit authorship contribution statement xuemin li methodology formal analysis writing original draft chenglong zhang writing review editing zailin huo conceptualization resources writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the national key research and development program of china china 2017yfc0403301 and the national natural science foundation of china china 51639009 
