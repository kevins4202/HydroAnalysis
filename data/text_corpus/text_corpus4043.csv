index,text
20215,a coupled experimental and computational study is performed to discuss the overall trend in surface combatant 5512 forces and moment and flow pattern with the change in hull drift angle β from straight ahead β 0 to static drift β 10 20 conditions the local flow measurements were performed using tomographic particle image velocimetry tpiv which involved uncertainties ranging from 1 to 17 and the uncertainties decreased with the vortex progression the surge force increased quadratically with the drift angle whereas the sway force and yaw moment increased cubically the wave elevation showed diverging wave pattern from both starboard and port sides the wave angle increased and decreased on the port and starboard sides respectively with the increase in β but the total wave envelop angle remained almost constant both experiments and computational fluid dynamics cfd predictions showed very similar vortical structures the β 0 flow showed structures emanating from the sonar dome forebody keel and bilge keel aligned which progressed along the hull the static drift flows showed structures emanating from the sonar dome tip bilge keel tip and aft body keel which advected away from the hull the primary vortices for the static drift case were circular and showed gaussian or bell shaped planar distribution the vortex strength increased with β and decreased with progression as vortices diffused the momentum deficit in vortex core was sustained for β 0 due to interaction with boundary layer whereas for β 10 and 20 the deficit increased due to turbulence generation in the core because of helical instability the tpiv measurements for the first time provided detailed measurements for the progression of the vortical structures and associated mean and turbulent flow characteristics for ship flows however they have larger uncertainties near the hull which limits analysis of the vortex onset characteristics future work should focus on time resolved particle tracking velocimetry ptv to address these issues 1 introduction ship flows involve complex flow features that continuously change during maneuvering and their physical understanding is essential for design purposes advances in measurement techniques from pitot tube to particle image velocimetry piv to stereo piv spiv to tomographic piv tpiv westerweel and scarano 2005 is opening new opportunities to understand the complex flow features and associated physics tpiv measurements of mean and turbulent flow field around ship hulls during complex maneuvering conditions can be challenging as they require large scale towing tank rotating arm or wave basin facilities in addition the experimental dataset can be sparse thus they do not allow detailed analysis of the onset separation and progression of the vortical structures computational fluid dynamics cfd can provide detailed description of the flow field and the advances in high performance computing are allowing larger grids and high fidelity models to improve their accuracy nonetheless they still involve numerical and modeling challenges stern et al 2015 several experiments have been performed to assess surface combatant 5415 geometry of interest flow characteristics and the dataset has been extensively used in collaborative ship hydrodynamics workshops to assess the predictive capability of computational methods and models as discussed below olivieri et al 2001 and longo et al 2007 performed mean and turbulent flow field measurements for barehull 5415 at straight ahead β 0 condition olivieri et al 2001 performed measurements for an l pp 5 72 m model where l pp is the model length between parallel perpendiculars using a 5 hole pitot tube at several cross section along the hull x l pp 0 06 to 1 0 longo et al 2007 performed measurements using piv at the nominal wake plane x l pp 0 935 for an l pp 3 048 m model both the measurements compared reasonably well with each other at the nominal wake plane and showed presence of two co rotating vortices however the origins of the vortices could not be confirmed as the data were too coarse these measurements were used in the gothenburg 2010 workshop g2010 for the validation of the cfd predictions bhushan et al 2014 the study concluded that anisotropic turbulence models perform better than the isotropic models for the prediction of turbulence structures and detached eddy simulation des is more accurate than unsteady reynolds averaged navier stokes urans for the prediction of vortical structures as the latter was overly dissipative further for the first time des on large grid with 300 million m points provided detailed flow topology and helped identify that the closed streamlines at the mid girth observed in the experiments were due to the sonar dome sdv and forebody keel fbkv vortices post g2010 analysis focused on detailed investigation of onset and progression of vortical structures generated from the sonar dome the analysis revealed an addition vortex from the sonar dome trailing edge sdtev and the onset of all the three primary vortices were identified to be due to open type crossflow separation however des showed significantly under resolved turbulence since the study did not include simulations on systematically refined grids the relative contributions of the grid and turbulence modeling errors could not be ascertained it was concluded that the under resolved turbulence was possibly due to modeled stress depletion in addition the available experimental data were too sparse and lacked turbulence measurements for comprehensive analysis g2010 workshop also included 5415 roll decay and forward speed diffraction test cases using piv datasets procured by irvine et al 2013 and longo et al 2007 respectively irvine et al 2013 measured free surface and velocities at x l pp 0 675 during different phases of the roll decay motion for 5415 with bilge keel with initial roll angle of ϕ 10 longo et al 2007 procured velocities at different phases of the head waves using piv at nominal wake plane for barehull 5415 the datasets were primarily for the validation of the cfd models and detailed assessment of cfd methods and models were not performed yoon 2009 measured forces and moment for barehull and appended 5415 under static drift fixed sway and yaw and dynamic zig zag and turning circle manoeuvres these datasets were used in the simman 2008 workshop stern et al 2011 to assess the cfd predictions under manoeuvring conditions the dataset for static drift β 20 was also used by bhushan et al 2011 for validation of isotropic and anisotropic urans and des predictions the study reported that the prediction errors for forces and moment reduce significantly from 15 to 5 as the grid is refined from 2m to 10m cells the study provided an initial assessment of the primary vortical structures and signatures of the vortices on the free surface yoon et al 2015a 2015b performed detailed flow measurements of mean and turbulent flow field around 5415 appended with bilge keels during dynamic planar motion mechanism pmm manoeuvres using 3d stereoscopic piv spiv atsavapranee et al 2010 measured flow field around 5415 during steady turn using spiv spiv measurements have been also performed for other ship hulls such as flow field around high speed delft catamaran dc at β 6 and 9 falchi et al 2014 and around container ship kvlcc2 at β 30 these datasets were used for validation of cfd predictions for nato avt 183 collaborative research yoon et al 2014 and egeberg et al 2014 procured towed tomographic piv tpiv measurements for 5415 with bilge keels using an l pp 3 048 m model for β 0 and static drift β 10 and 20 conditions the experiments were guided by preliminary blind simulations by bhushan et al 2011 which helped in identifying regions of interest and key validation variables tpiv extends spiv for volume measurements enabling more detailed analysis of flow structures including axial derivatives of the velocity vector required for transverse vorticity components q criteria second invariant of rate of strain tensor and other variables of interest scarano 2013 the data for β 0 and static drift β 20 were used for nato avt 183 sea facet research reliable prediction of separated flow and onset and progression for air and sea vehicles the collaborative research included eight 8 submissions mostly using urans and only one des and several simulations used 40 80m grid cells bhushan et al 2015 the study identified that adapted grid with 10m grid points with appropriate near wall grid resolution i e y 1 for near wall model and y 30 for wall functions are sufficient for accurate forces moment and wave elevation predictions but finer grid resolutions are required for an accurate prediction of the vortical structures computations using 20m grid points predicted onset and overall vortex structures well but showed large 30 40 errors for vortex progression similar to g2010 des performed better than urans for the prediction of vortical structures and latter was overly dissipative systematic grid refinement study confirmed that the failure to predict resolved turbulence for the β 0 flow was due to modeled stress depletion for β 20 des predicted 95 resolved turbulence and performed better than urans for the vortex progression however des significantly underpredicted vortex strength and tke in the vortex core when compared with the experiments the underpredictions were attributed to inadequate grid resolution in the vortex core region the study also provided detailed diagnostics of the vortex onset separation and progression associated instabilities and turbulent structures the primary vortices in the flow namely sonar dome tip sdtv and windward bilge keel tip bktv vortices showed helical type breakdown and for both the peak tke occurred at the breakdown the data for β 10 was recently used for nato avt 253 collaborative research compared to the nato avt 183 effort the effort included more submissions 14 larger grids grids with 50m 160m cells and wide range of mix of urans and des or delayed des ddes turbulence models i e around one third of the submissions used d des the study helped in better understanding the limitations of the d des prediction identified in nato avt 183 and the key conclusions of the study are summarized in section 3 2 this objective of this research is to document the tpiv experimental methods and datasets for 5415 with bilge keels at β 0 10 and 20 conditions and perform a coupled experimental and computational study to discuss overall trend in surface combatant 5415 forces moment and flow pattern evolution with the increase in the hull drift angle the details of the initial tpiv experimental methods were presented in conference papers yoon et al 2014 egeberg et al 2014 herein the details of the final experimental set up including data reduction uncertainty and statistical converge of the datasets are reported tpiv measurements have not been used for ship flows before which is a novelty of this research the experimental datasets have been used in previous nato avt 183 and avt 253 collaborative research as discussed above to validate the predictive capability of state of the art ship hydrodynamics solvers however herein the dataset is used to understand how the mean and turbulent structures of the flow changes with drift angle the study leverages complimentary cfd simulations to fill in the sparse experimental datasets to develop a complete understanding of the vortex onset separation and progression characteristics the datasets and cfd results for β 0 and 20 have been published in bhushan et al 2019 thus this study primarily focuses on datasets and cfd results for β 10 this study also performs detailed assessment of the effect of grid resolution and urans and des turbulence models on the cfd predictions including a canonical test case flow over a hydrofoil trailing edge to document the strengths and weakness of the commonly available cfd methods and models for ship flow applications the following section provides details of the experimental measurements section 3 provides summary of the cfd simulation set up including a summary of the limitation of the d des predictions as identified in nato avt 183 and avt 253 studies sections 4 5 6 and 7 provide a discussion of the effect of drift angle on the forces and moment wave elevation vortical structures and flow pattern respectively finally in section 8 key conclusions and future research directions are provided 2 experimental methods 2 1 facility model and conditions the experiments were performed in iihr towing tank which is 100 m long 3 m wide and 3 m deep and equipped with a drive carriage a pmm carriage and wall side wave dampeners and wave dampening end beach fig 1 a the drive carriage was instrumented with data acquisition computers a speed circuit and signal conditioners the drive carriage pulls the pmm carriage which was used as a contact point of attachment for the model the wave dampeners and the end beach enabled 12 min intervals between carriage runs which was determined to be sufficient based on visual inspections of the free surface experiments were performed using a dtmb 5512 model which is a geosim of dtmb model 5415 latter is a 1 24 8 scale model with l p p 5 72 m of the u s navy s pre contract design for a surface combatant ddg 51 ca 1980 with a sonar dome bow and transom stern the dtmb 5512 is a 1 46 6 scale model made with fibre reinforced plexiglas hull model and has l p p 3 048 m and block coefficient c b 0 506 the model was un appended except for port and starboard bilge keels i e not equipped with shafts struts propellers or rudders the measurements for forces and moment were conducted at various drift angle β 0 to 20 and flow field measurements were conducted at β 0 10 and 20 all of the measurements were conducted using towing speed u c 1 531 m s corresponding to fr 0 28 the model was ballasted to the dynamic sinkage σ 1 92 10 3 l p p and trim τ 0 136 positive bow up corresponding to the dynamic σ and τ expected for straight ahead case at fr 0 280 longo et al 2007 the model was mounted rigidly to the pmm using a fix mount the flow reynolds number re 4 65 106 based on a water temperature of 20 c and l p p to initiate turbulent inflow conditions a mesh consisting of a 1 6 mm high and 3 2 mm diameter cylindrical studs spaced 9 5 mm apart was placed 0 05 l p p upstream of the forward perpendicular fp the stud dimensions and placement on the model are in accordance with recommendations by the 23rd ittc the experimental conditions for all β have water depth froude number fr h 0 7 water depth to model draft ratio h t 4 tank width to model length ratio w l 0 35 and the tank area to model cross sectional area a t a m 15 which satisfy the ittc 2002 criteria however for β 20 the tank width w to the model width b ratio is 2 9 where w b 4 signifies the flow surrounding the model could be affected by blockage metcalf et al 2006 2 2 validation variables the data are presented in cartesian ship fixed coordinate system where x is along the model centreline pointing to downstream y to starboard z upward and the origin is at the intersection of the water plane and the forward perpendicular note that the coordinates are normalized by l p p as summarized in table 1 the measurements included a carriage speed u c b surge force x sway force y and yaw moment n c wave elevation ζ d planar y z planes flow velocity u v w axial vorticity ω x tke and reynolds stresses at ten 10 x l p p planes shown in fig 1 d and e 3d volume solutions at selected locations along the primary vortex core between x l p p 0 06 to 0 6 for β 0 and between x l p p 0 06 to 1 0 for β 10 and 20 the measurement volumes for β 10 are shown in fig 1 e the volume measurements included flow velocity u v w and their derivates and tke the velocity derivatives allowed calculation of vorticity vector ω x ω y ω z second invariant of rate of strain tensor q and 2nd largest eigen value of rate of strain tensor λ2 the time history of u c are analysed using fast fourier transform fft to evaluate the dominant vibration frequencies in the measurements the dominant frequencies in the forces and moments are compared against those of u c to determine instabilities due to hydrodynamics and the cfd results provide an insight into the source of instabilities the wave elevation pattern on the windward and leeward sides and at selected wave cuts are used for validation and the variation of the diverging and transverse wave pattern with drift angle are discussed the isosurfaces of q are used to identify the primary vortices in the flow their separation location and progression wherein cfd fills in the sparse experimental data and provides finer details of the flow the variation of flow variables in the vortex core identified by the peak q value q peak are used for the validation of cfd results the vortex core flow variables used for the analysis are q peak locations y core and z core axial velocity u core axial vorticity ω core and tke k core the cross plane variations of q u ω x and tke along y y and z z line passing through the vortex core is analysed to evaluate the vortex structures the axial and cross plane vortex core analysis provides quantitative validation of the cfd flow predictions the planar distribution of u and tke are used evaluate the flow pattern i e wake deficit and tke generated by the vortical structures the results on all three β are analysed to study the effect of drift angle on flow predictions 2 3 data acquisition and measurement uncertainties the key details of the measurement locations systems and associated uncertainties are provided in table 1 carriage speed u c was measured using an integer pulse counting encoder mounted on a wheel with a linear resolution of 0 15 m pulse longo and stern 2005 forces and moment were measured using an izumi six component strain gage type loadcell six izumi amplifiers 16 channel ad converter and pc the loadcell was statically calibrated on a test stand using standard weights the measurement rates and duration were 100 u c l p p and 40 l p p u c respectively the uncertainty in the forces and moment measurements were assessed following the aiaa standard 1999 ansi asme 1998 and agard 1994 standards and guidelines the procedure is based on the estimates of systematic bias b φ and random precision s φ limits and their root sum square rss combination provides total uncertainty u d b φ 2 s φ 2 bias limits were estimated considering elemental error sources from individual variables whereas precision limits are estimated by repeating the tests 12 times a 95 confidence level was achieved through careful estimations of the bias errors and usage of a multiple test approach for the precision errors the details of the procedure are provided in yoon et al 2015a in general b φ 2 u d 2 90 and s φ 2 u d 2 10 for all variables indicating the variables results are highly repeatable for x measurements the primary bias error source was identified due to error in the carriage speed measurement which was around 0 72 u c for y and n measurements the primary bias error source was identified due to drift angle setting which was around 2 2 β the total uncertainty is estimated as 3 6 5 4 and 2 6 for x y and n respectively wave elevations were measured using a longitudinal wave cut method using two kenek servo type wave probes mounted on a motorized traversing system longo and stern 2005 the probes and traversing system were cantilevered from the tank side wall the data were collected at 31 53 and 37 cuts for β 0 10 and 20 respectively with a fixed spanwise spacing of δ y 0 01 l p p between each cut the uncertainties for the wave elevation measurements were estimated for β 20 case the random uncertainty s ζ 2 u ζ 95 2 94 was found to be the major contributor whereas the systematic uncertainty contribution was minor b ζ 2 u ζ 95 2 6 the averaged uncertainty was estimated to be around 5 of the bow wave height the flow velocities u v w were measured using a towed underwater tpiv system by lavision the details of the tpiv system is provided in appendix i the assembly of the tpiv system is shown in fig 1 a c the system was assembled such that the laser and light sheet optics delivered a vertical light sheet in the y z cross plane the camera enclosures were placed downstream of the light sheet to minimize wave and flow disturbance by the enclosures the enclosures were arranged asymmetrically in the horizontal plane with one pair at about 20 from the model centerline and another pair about 35 from the measurement plane the camera enclosure pairs consisting of one shorter and one longer length enclosure were arranged back to back in the vertical plane with former placed behind the latter the shorter and longer enclosures were tied together using a clamp above water surface and the two longer enclosures from each pair were braced rigidly using an underwater bracing to prevent relative motions among cameras due to the vibrations from carriage runs the top cameras inside the shorter enclosures had a normal viewing angle to the measurement plane whereas the bottom cameras in the longer enclosures have a low view angle that looked up the measurement plane at an angle of 30 the longer enclosure mirror section was filled with water to avoid optical aberrations due to the oblique view angle data acquisition was completed at multiple overlapping zones at each x l p p station to map the entire region of interest the total number of zones were 61 139 and 134 for β 0 10 and 20 respectively tpiv recordings were performed at 13 hz for 20 s thus n img 260 images were captured by each camera from each carriage run laser power was set at 70 and the time interval between the double frames was set at 700 μs the vector spatial resolution of tpiv field of view fov was about 1 mm in all directions the uncertainties in tpiv measurements were obtained following asme ptc 19 1 2005 2005 standard first the standard uncertainty u φ b φ 2 s φ 2 were estimated from the systematic b φ and random s φ standard uncertainties then the combined standard uncertainty was expanded to a 95 level of confidence by multiplying an expansion factor to obtain u d φ t 95 u φ where t 95 2 was used considering large degrees of freedom the systematic uncertainties were not computed directly from data reduction equations associated with the tpiv measurement system instead they were obtained using a reference measurement of simple flows that provided a good representation of measurement errors for this purpose uniform flow was measured by towing the tpiv without the model attached which included towing along the tank centreline at 6 different speeds 0 23 0 45 0 67 0 88 1 0 and 1 09 u c and oblique towing at 1 0 u c at 9 different angles β 20 20 at 5 increments the measurements were done by using the same data acquisition and reduction procedures used for the case with the model attached the validation used a standard error of estimate 1 s e e φ φ ref 2 m 2 where φ is the measurement variable φ ref is the expected value of φ and m is the number of observations the study used m 6 for the straight towing case and m 9 for the oblique towing case the systematic uncertainty is defined as the rss of the validation error b s e e and the accuracy associated with the expected values used for the validation b φ ref such that 2 b φ b s e e 2 b φ ref 2 where b s e e s e e and b φ ref is the error propagation of elemental uncertainties the validation error b s e e is usually less than 1 of u c whereas the accuracy in the expected values b φ ref 0 4 of u c similarly for both the straight and oblique towing cases the resulting b φ 1 of u c for all variables by selecting the larger estimation values between the straight and oblique towing cases table 1 summarizes the measurement uncertainties for the vortex core variables the systematic uncertainties of y core and z core are b φ 1 and 2 mm for the β 0 and 20 case respectively the b φ s of u core and k core were estimated based on those estimated for u c the b φ s of ω c o r e and q peak were assumed to be zero as they are differential variables the random uncertainty s φ was estimated using 10 repeat measurements analysis shiows that the uncertainty in the core location measurement is dominated by systemic uncertainty both systemic and precision uncertainties are comparable for u core and k core measurements and uncertainties for ω c o r e and q peak are due to precision uncertainty u d is less than 4 for all variables except for q peak for which u d is up to 17 the uncertainties are larger for the early progression of the vortex i e x l p p 0 12 due to measurement issues near the hull where u d is about 2 times higher than those in late progression 3 cfdship iowa simulation setup 3 1 numerical methods and models the general purpose cfdship iowa v4 5 solves the urans des equations for semi coupled two phase flow in either absolute inertial earth fixed or relative inertial coordinates for an arbitrary non deforming control volume stern et al 2015 the solver provides several turbulence modeling options including blended k ε k ω sst bkw menter 1994 and anisotropic reynolds stress ars wallin and johansson 2000 urans models and their des spalart and allmaras 1994 xing et al 2007 and wall function wf bhushan et al 2009 options the interface modeling is performed using level set method a multi block dynamic overset grid approach is used to allow relative motion between the grids for six degrees of freedom 6 dof ship motions noack 2005 carrica et al 2007 the code provides propeller modeling and a proportional integral differential controller for self propulsion simulations carrica et al 2013 the solver is parallelized using mpi based domain decomposition and shows good strong scalability up to 2048 processors for static simulations bhushan et al 2011 3 2 previous verification and validation and des assessment bhushan et al 2019 reported numerical uncertainty levels expected in cfdship iowa simulations using factor of safety method xing and stern 2010 the estimates were performed for 5415 with bilge keels at static drifts β 0 and 20 using three systematically refined grids consisting of 10m 48m and 84m cells with refinement ratio r g 2 for both β forces and moment predictions showed grid uncertainty u g 2 2 and 1 2 for urans and des respectively the free surface predictions showed grid uncertainties of u g 3 5 and 6 for β 0 and 20 respectively for both urans and des for the des vortex core predictions the grid uncertainties were large u g 13 5 and 18 for β 0 and 20 respectively as discussed in the introduction previous collaborative research has demonstrated that des performs better than urans for the progression of the vortical structures and has the ability to predict turbulence anisotropy however they do not show consistent improvement in the results with grid refinement for example for 5415 at β 0 the des prediction errors reduce when the grid is refined from 10m to 48m cell but the errors increase on further grid refinement as shown in fig 2 whereas for 5415 at β 20 the results continue to improve with grid refinement from 10m to 84m cells also note that results on the 84m grid are better compared to those on 250m grid as the former included refinement only along the vortex core and the grid resolution in the core were finer a similar deterioration of des predictions with grid refinement has been reported in other studies for example for flow predictions around a container ship kvlcc2 at β 30 xing et al 2012 des on a 13m grid showed lower errors that those on a finer 305m grid for turbulence quantities for flow around 5415 with bilge keels at β 10 des using fine 163m grid wherein the grid resolution was sufficiently fine to resolve the entire inertial subrange overpredicted forces and moment by 17 and overpredicted tke close to the vortex separation by 100 200 on the other hand urans on the same grid predicted the above quantities reasonably well ideally des should predict boundary layer similar to those of urans except for some unsteadiness because of the resolved turbulent pressure fluctuations outside the boundary layer the above large difference between des and urans predictions could be attributed to either grid induced separation or modeled stress depletion issues the grid induced separation occurs due to the activation of les in the boundary layer with insufficient grid resolution this results in an underestimation of turbulent stresses and eventually boundary layer flow momentum rendering it more susceptible to separation this aspect is clearly demonstrated for flow over hydrofoil trailing edge as discussed in appendix iii the enhanced separation may deteriorate the forces and moment predictions and result in an excessive turbulence at the vortex separation compared to urans as observed by visonneau et al 2018 they can also result in high turbulence in the wake as observed by xing et al 2012 thus the poor predictions by des on finer grids can be attributed to grid induced separation as demonstrated in appendix iii for flow over hydrofoil the delayed des ddes or improved ddes iddes addresses this limitation by delaying activation of les in the boundary layer region xing et al 2012 also reported that ddes addresses the grid induced separation issue but then results in an underprediction of the turbulence visonneau et al 2018 reported that ddes significantly improves the forces and movement compared to des i e the errors reduced from 20 to 7 but the tke prediction error at the vortex separation increased even more these limitations of ddes can be attributed to modeled stress depletion the modeled stress depletion occurs when les is activated in the region which does not have sufficient resolved turbulence to maintain continuity of turbulent stresses across the urans les interface for flows over slender bodies wherein geometry induced flow instabilities are limited the stress depletion results in under resolved turbulence and overprediction of vortex strength due to lower turbulent dissipation in such cases further grid refinement results in further reduction in the modeled stresses resulting in low turbulence production this explains the extremely low tke predictions reported by bhushan et al 2019 for 5415 at β 0 or underprediction of tke by xing et al 2012 on 305m grid this limitation of des cannot be addressed by the ddes or iddes modifications as demonstrated for the hydrofoil simulations in appendix i however on an adhoc basis it can be addressed by imposing turbulence trigger upstream of the flow region of induce resolved stresses in the flow flows over bluff bodies may involve geometry induces instabilities or turbulence triggers and can naturally overcome the modeled stress depletion issue as reported by bhushan et al 2014 for 5415 at β 20 however for extremely fine grids insufficient turbulent stresses may impede the energy transfer from large scale to turbulent scales resulting in energy accumulation in the large scales the overprediction of large scale oscillations could be interpreted as turbulence and perhaps is the cause of high tke predictions by ddes close to vortex separation in visonneau et al 2018 this limitation could be due to lack of explicit les modeling in d des appendix iii 3 3 simulation domain and grids in this study simulations are performed for 5415 with bilge keels at static drifts β 10 using anisotropic urans and des on grids with 10m and 48m cells the grids used in the study are same as those used for β 20 bhushan et al 2019 except that the vortex core refinement grid was rotated to be aligned with the primary vortex progression direction as shown in fig 3 a the grid design includes a body fitted boundary layer grid for the hull and the bilge keel and nested cartesian overset grids away from the hull as shown in fig 3 b the averaged near wall grid resolution is estimated to be y a v g 0 94 and 0 55 for 10m and 48m grids respectively and the maximum wall spacing on the leeward sonar dome surface is estimated to be y m a x 3 2 and 1 85 respectively based on the previous 5415 β 0 and 20 studies the middle grid consisting of 48m grid is sufficient for accurate forces moment and wave elevation predictions but may have a penalty for the vortex core predictions however for the purposes of aiding in the presentation of the sparse experimental results the 48m grid results are deemed reasonable urans predicted a steady flow while des predicted an unsteady flow pattern as shown in fig 3 c and d for des les is active in the separated flow region whereas urans is active in the boundary layer and outside the separated flow region des predicted resolved turbulence level of around 20 and 40 of the total tke on 10m and 48m grids respectively an fft analysis of the velocity fluctuations in fig 3 f shows that the square of the amplitudes measure of energy content decreases with a f 5 3 slope consistent with those expected for inertial subrange thus unsteadiness is identified to be due to turbulence for the 48m grid the grid resolution in the vortex core has a length scale δc 0 0015l pp as shown in fig 3 e the sdtv vortex radius is l 0 01 l p p and k 0 024 u c 2 this provides an estimation of dissipation ε 0 1643 k 3 2 l 0 061 u c 3 l p p using the above values the taylor s microscale is estimated as λ t 10 ν k ε 9 3 10 4 l p p 2 83 mm the ratio of largest energy containing length scale and taylor s microscale is thus l λ t 11 pope 2000 reported l λ t r e l 10 where r e l k l ν for the present case r e l 1 55 10 3 r e l 7200 this results in l λ t 27 which is about 2 5 time higher than the above estimates the smallest λ t based on above two estimates is 3 7 10 4 l p p 1 14 mm as shown in fig 3 f the grid resolution lies within the inertial subrange which is required for les models the grid resolution is larger than the taylor s microscale and is somewhere in the range δc 1 6 to 4 λ t thus the predictions on the 48m grid is expected to depend strongly on turbulence models the simulations are performed using a time step size δt 0 0015 l p p u c using 96 processors for 8 flowtimes l p p u c and solutions over the last 4 l p p u c were averaged to obtain averaged values for validation 4 forces and moment fig 4 shows x y and n vs β obtained in the experimental and cfd and curve fits using analytic functions table 2 compares the experimental and simulation values and dominant frequencies and associated amplitudes of their unsteadiness the curve fits show a quadratic function a b β 2 for x and cubic function a β b β 3 for y and n where a and b are constants the ratio of the non linear to linear terms of the curve fit equation γ b β 2 a provides a measure of the non linear characteristics of the variable with β the ratio is negligibly small for small β for example γ 0 04 0 03 0 00 at β 5 for x y n thus x is nearly constant and less sensitive to β while y and n vary approximately linearly with β however for β 10 the ratio becomes considerably large for example at β 20 γ 0 72 0 47 0 06 for x y n thus all the variables exhibit more or less non linear trends with β the derivations and evaluations of the hydrodynamic derivatives abkowitz 1964 from the present data are discussed in yoon et al 2015a b the cfd predictions compare within 5 of the experiments for all β x is both due to frictional resistance and pressure distribution the frictional component dominates for β 0 where they account for 70 x and their contribution decreases with increase in β i e to 63 x for β 10 and 47 x for β 20 both y and n are mostly 99 due to hull pressure distribution for both drift angles the fft of the unsteady forces and moment for all β as shown in fig 5 and summarized in table 2 the experiments show dominant frequencies f f l p p u c of 10 15 and 20 the fft amplitudes are smaller for the straight ahead condition than those for the drift conditions experiments conducted at forward speed without the model showed that the carriage and pmm mount have natural frequency of around f 10 and 14 and mechanical noise around f 20 thus based on the experiments alone none of the dominant frequency can be considered to be of hydrodynamic origin cfd prediction for β 0 showed steady force whereas both β 10 and 20 showed unsteady forces and moment the dominant frequency for the unsteadiness was analysed from the x y and n time history over 1 28 flow time l pp u c or 512 time steps both β shows that unsteadiness amplitude for y is almost twice of that for x and n and unsteadiness for β 20 shows almost 2 larger amplitude than those for β 10 flow for β 10 shows two dominant frequencies around f 8 6 and 15 and β 20 flow shows somewhat higher frequencies f 10 and 20 bhushan et al 2019 reported that dominant frequencies of f 10 and 20 for β 10 are due to karman like vortex shedding from the sonar dome surface and the plunging breaking waves from the windward bow respectively a similar correlation between the flow instabilities and forces and moment dominant frequencies are expected for β 10 further results indicate that the flow instability frequencies and associated amplitudes increase with β 5 wave elevations fig 6 a c compares the wave contours and profiles predicted by cfd simulations for β 0 10 and 20 with experimental data the cfd predictions compare very well with the experimental data both for the wave amplitude and pattern the wave elevation shows diverging waves emanating from both the starboard and port sides for β 0 the diverging waves are symmetrical around the hull and the wave envelop angle on each side is approximately 16 5 the wave elevation angle is somewhat lower than 19 5 expected for the kelvin waves the wave symmetry is disrupted for β 10 due to the rotated hull the wave envelop angle is around αp 27 3 on the port side and αs 7 on the starboard side for β 20 the starboard waves exhibit an even larger asymmetry and αp 32 5 and αs 3 the wave profiles along the closest wave cuts shows that cfd predictions compare quite well with the experimental data where the averaged errors are estimated to be 4 3 5 6 and 6 9 for β 0 10 and 20 respectively the errors are somewhat higher on the starboard side than on the port side results show that wave angle on the port and starboard sides increase and decrease respectively with the increase in β however the total wave envelop angle is almost constant for all β and varies between 33 and 35 5 the bow wave crest on the starboard side and transom wave crest increases and bow wave trough on the port side decreases with the increase in β 6 vortex structures onset and progression 6 1 overall vortical structures and onset fig 7 shows the vortical structures for the β 0 10 and 20 obtained from the experiments and cfd predictions using q iso surfaces colored by helicity h the λ 2 criterion showed almost identical structures as the q criterion levy et al 1990 hunt et al 1988 the axial vorticity provided structures similar to those of q or the λ 2 criterion suggesting that vortices are more or less aligned with axial direction fig 8 shows a close up view of the vortices for β 10 the experimental data provides a limited view of the vortex progression and is not very reliable in the immediate vicinity of solid surfaces where the tpiv measurements are difficult this makes vortex identification and tracking of vortex onset and progression difficult thus cfd results are used in conjunction with experimental data to fill in the information the vortices identified for different β are summarized in table 3 the β 0 flow shows counter rotating symmetric structures with respect to the centerplane the primary structures are identified to be fbkv sdv and bilge keel vortex bkv all of these vortices show open type 1 1 open type separation occurs as the cross flow pressure gradients induce streamline convergence which along with the adverse axial pressure gradient induces high normal velocity lifting the vortex off the hull surface refer to simpson et al 1996 and bhushan et al 2019 for more discussions separation both fbkv and sdv exhibit clockwise rotation on the starboard side and counter clockwise rotation on the port side fbkv separates from the fore body keel at x l p p 0 107 advects parallel to the hull bottom and retains high q 50 up to x l p p 1 sdv separates from sonar dome surface at x l p p 0 065 and decays rapidly by x l p p 0 6 bkv separates from the sharp leading edge of the bilge keels and results in two counter rotating vortex sheets with nearly equal strength on the starboard side bkv pair includes a counter clockwise rotating vortex outward of the bilge keel and a clockwise rotating vortex inwards of the bilge keel cfd shows that the bkv pair decays significantly by x l p p 0 8 but in the experiments bkv is very much evident at x l p p 0 8 and interacts with fbkv cfd predictions show presence of additional vortices such as counter rotating after body keel vortex abkv pair emerging from the after body keel at x l p p 0 83 where the vortex on the starboard side is clockwise rotating and shows open type separation cfd also shows clockwise rotating mid hull vortex mhv on the starboard side which originates as an open type separation from the hull at x l p p 0 5 in between the keel and the bilge keels mhv was not observed in the simulations without the bilge keel bhushan et al 2014 thus it is identified that it is induced as the outward momentum flux caused by fbkv is constrained by the bilge keel simulations also show karman type transom vortices similar to those reported in bhushan et al 2012 for flow over athena hull both β 10 and 20 flows show similar axisymmetric vortical structures with respect to the centerplane and the effects of the static drift angle dominates the flow the strongest vortices are sdtv from the starboard leeward side and bktv from the port windward side both advect towards the starboard side and rotate counter clockwise and show open type separation followed by helical mode instability soon after onset sdtv originates due to the merger of leeward and windward sdv and separates from the sonar dome edge at x l p p 0 11 whereas bktv is generated due to the merger of multiple separations from the port side bilge keel leading edge around x l p p 0 4 the flow also shows fbkv from the port side ww fbkv with counter clockwise rotation and from the starboard side lw fbkv with clockwise rotation these vortices have same rotation as β 0 but they advect towards the starboard side similar to sdtv and bktv compared to β 0 the fbkvs are significantly weaker for the static drift cases and decay by x l p p 0 5 and 0 6 for β 10 and 20 respectively the bkv from starboard side ww bkv shows two counter rotating vortex sheets from the leading edge of the bilge keel at x l p p 0 4 similar to β 0 for β 10 the rotation of the vortex pair is similar to β 0 but the vortex strengths are different in particular the counter clockwise rotating vortex outward of the bilge keel is significantly weaker than the clockwise rotating vortex inwards of the bilge keels for β 20 the rotation of the vortex pair is opposite to that of β 0 as counterclockwise and clockwise rotating vortices are observed inward and outward of the bilge keel respectively the vortex pair shows similar strength and advects on starboard side at a shallow angle of θ 3 both β 10 and 20 show counter rotating abkv pair from the after body keel at x l p p 0 83 similar to β 0 however they also show an additional stronger counter clockwise rotating vortex from the after body keel which advects towards the starboard side similar to sdtv for β 10 the vortex retains its structure but for β 20 it merges with bktv cfd predictions also show free surface vortices due to wave breaking with clockwise and counter clockwise rotation on the starboard lw fsv and port ww fsv sides these vortices are much stronger for β 20 where ww fsv shows well defined multiple rollers due to spilling breaking pattern and lw fsv shows plunging breaking cfd simulations for both β 10 and 20 also show separation bubble on the starboard sonar dome surface which shows shear layer instabilities at separation and periodic enlargement and growth due to flapping like instability predictions also show counter clockwise rotating mhv on starboard side and transom vortices similar to β 0 6 2 progression of primary vortices the progression of primary vortices sdv and fbkv for β 0 and sdtv and bktv for β 10 and 20 are analysed using the variation of the primary vortex core variables as shown in fig 9 the variation of y core shows that β 0 vortices progress parallel to the keel the β 10 and 20 vortices progress at an angle θ 6 5 and 12 with respect to the keel respectively up to x l pp 0 8 and straightens further downstream the vortices for all β show similar z core variation where the vortices progress below the hull up to x l pp 0 6 and starts to move towards the free surface further downstream for all β cfd predictions of the vortex core location compare within 5 of the experiment both β 0 vortices and bktv shows largest q at the onset sdtv shows an increase in vortex strength early on peaks around x l pp 0 12 followed by helical breakdown the vortex strength q and ω core increases with the drift angle and their strength decays with progression the decay of vortex strength with progression is expected as the vortices diffuse the q values show an exponential decay where the decay exponent is much larger for β 0 compared to those of β 10 and 20 ω core shows a much slower decay than q cfd predicts the qualitative behavior of the variation of vortex strength with β and during progression very well but mostly under predicts q and ω core magnitudes the predictions errors for q are 140 for β 0 and 20 and 80 for β 20 and errors for ω core are 81 60 and 45 for β 0 10 and 20 respectively a momentum deficit is predicted in the vortex core except at the onset for β 20 for β 0 the deficit remains almost constant for x l pp 0 2 to 0 8 but increases for x l pp 0 8 the analysis reveales that sustained deficit up to x l pp 0 8 is because of the advection of the vortex in the vicinity of the hull particularly the momentum recovery due to vortex diffusion shear layer at the vortex edge draws ambient high momentum fluid into the core is balanced by the deficit induced by the boundary layer wherein the mean momentum is transferred to tke resulting in a sustained k core during progression the momentum deficit increases for x l pp 0 8 as the flow encounters adverse pressure gradient in the after body region the momentum deficit in sdtv and bktv cores show an increase during progression except that the increase for β 10 sdtv is very gradual an increase in the momentum deficit suggests transfer of mean momentum to turbulence or generation of tke in the core is higher than the momentum recovery due to vortex diffusion this also explains the sustained high k core throughout progression the tke generation could be due to helical instability of the vortex and since helical instability is more prominent for β 20 than those for β 10 this explains an aggressive increase in k core with β cfd predictions for the momentum deficit compare very well with the experiments and the prediction errors decrease with increase in β which are 8 3 5 and 2 4 for β 0 10 and 20 respectively however they significantly under predict tke levels for all β and the prediction errors are 60 this suggest that cfd underpredicts the tke generation in the core and momentum recovery due to vortex diffusion by similar magnitude the diffusion of the turbulence from the vortex core is discussed further in section 7 using the reynolds stress predictions 6 3 structure of primary vortices both sdv and fbkv are elliptic shaped sdv has major to minor axis diameter ratio of around 2 1 and the major axis is aligned at an angle of 40 with respect to the centerplate at x l pp 0 12 and slowly aligns with the centerplane such that the angle decreases to 25 at x l pp 0 3 fbkv has major to minor axis diameter ratio of around 3 2 and the vortex major axis is aligned with the hull throughout progression in both the vortices peak ω x momentum deficit and tke are coincident with the peak q their profiles mostly show bell shaped pattern along major axis and a semi bell shape along minor axis away from the hull sdtv and bktv for both β are circular shaped sample figure for β 10 are shown in figs 10 and 11 the peak ω x momentum deficit and tke are coincident with the peak q expect for sdtv for β 20 the latter shows a crescent shaped region within the vortex which results in a dual peak pattern for q ω x and tke the momentum deficit profile shows a peak above the core and a trough below the core aligned with the vertical z direction suggesting that momentum recovery is faster towards the free surface cfd results show that among all the primary vortices sdtv for β 20 is closest to the air water interface and leaves a scar on the free surface thus the crescent shape pattern could be because of the interaction between the vortex and the free surface as shown in fig 12 sdtv and bktv for β 10 show gaussian distribution for q along the radius and bell shaped distribution for ω x as shown in fig 13 the sdtv radius grows linearly with progression the measurements show that the bktv radius grows exponentially whereas in cfd it remains constant 7 mean and turbulent flow pattern the qualitative flow pattern is discussed using 2d planar plots of axial velocity u turbulent kinetic energy k and axial vorticity ωx sample plots at nominal wake plane x l pp 0 935 are shown in figs 14 16 fig 14 shows the contour of u overlaid by cross plane v w vectors obtained in the experiments experimental data and cfd prediction of ω x and k are compared in figs 15 and 16 respectively note that the values of the variables in the figures are set to best show the flow structures and do not represent the actual limit values of the variables the positive ω x red colored indicate contour clockwise and the negative blue colored clockwise rotations when looking upstream flow pattern for β 0 shows that flow deficit starts to appear on the sonar dome surface at x l pp 0 1 due to the generation of sdv a large deficit region is observed behind the sonar done at x l pp 0 12 due to the generation of fbkv the primary vortices are pushed towards the hull further downstream and they interact with the boundary layer to create a hook shaped deficit profile by x l pp 0 4 the latter is primarily generated by the counter clockwise rotating fbkv which transports low momentum boundary layer fluid outboard of the vortex centre around x l pp 0 8 the vortices encounter adverse pressure gradient due to afterbody curvature which causes the vortices to diffuse and the deficit region to enlarge at the nominal wake plane x l pp 0 935 the hook shape is significantly enlarged such that higher than 20 deficit region i e region where u 80 u c extends throughout the hull width both β 10 and 20 cases show most prominent momentum deficit on the leeward sonar dome surface in the sdtv and bktv cores hook shaped deficit near the centerplane due to lw and ww fbkvs and abkv the deficit on the leeward sonar dome surface due to the presence of separation bubble the deficit region enlarges with increase in β such that the diameter of higher than 20 deficit region for β 10 is 3 times larger than those for β 0 and those for β 20 is 50 larger than those for β 10 the sdtv vortex shows circular deficit region which moves away from the hull and enlarges such that for both β 10 the diameter of higher than 20 deficit region at x l pp 0 8 is two times larger than those at x l pp 0 4 the deficit recovers further downstream due to the interaction with free surface the lw and ww fbkvs result in hook shaped deficit region at the centerplane inclined at 45 towards the leeward side around x l pp 0 4 this deficit region is generated as lw and ww fbkv transport low momentum fluid outboard and inboard of the respective vortex cores respectively the hook shaped deficit region generated by fbkvs enlarges further downstream and it moves outward from the centre plane around x l pp 0 8 the deficit is enhanced due to low momentum transported by bkw or lw bkv around x l pp 0 6 an additional deficit region appears on the windward side due to bktv further downstream this deficit region moves towards the leeward side and results in a hook shaped profile due to interaction with boundary layer bktv deficit region for β 20 is 50 larger than those for β 10 abkv also shows hook shaped deficit region at the centerplane and the deficit region is enhanced with the increase in β for all drift angles tke is generated in the boundary layer both during vortex onset and when vortices interact with the boundary layer for β 10 and 20 high tke is observed in the sdtv core partly because of turbulence generation because of helical instability as discussed in section 6 2 and partly due to low frequency oscillation of vortex core in addition high tke is observed below the wind ward free surface due to wave breaking reynolds stress components along the sdtv core obtained in the experiments for β 10 and predicted by des at selected x l p p 0 12 0 2 0 4 and 0 6 are shown in fig 17 experiments shows that axial stress u u are more dominant at the vortex onset but further downstream both spanwise stress v v and vertical stress w w start to dominate among the shear stresses planar stress v w are most prominent and show clover shaped pattern in the vortex core with positive correlations along positive 45 slope and vice versa for negative 45 slope the shear stress distributions obtained in the experiment for β 20 in fig 18 also shows a similar behavior especially the prominent clover shaped pattern for v w in the vortex core cfd predictions capture the qualitative distribution of the stresses well but the magnitudes are underpredicted and the structures are more diffused results suggest that the tke generation during vortex onset results in primarily u u component along vortex progression v v and w w are dominant over u u further since v v w w and v w are aligned along y z and diagonally respectively this suggests that k core diffuses due to turbulence fluctuations symmetrically in the y z plane tke budget for β 20 predicted by cfd showed that turbulence transported away from the core by the turbulent and pressure transport terms consistent with above observations 8 conclusion and future research towing tank experiments were performed for a surface combatant dtmb model 5512 with bilge keels as it undergoes static drift manoeuvres the measurements included forces and moment using 6 component load cell wave elevations using servo type wave gauges and 3d volume mean and turbulent flow measurements using tpiv data quality was assessed by monitoring statistical convergence and following standard uncertainty procedures the uncertainty in the forces and moment measurements were about 3 5 where the bias error was dominant indicating the data were highly repeatable the wave elevation measurements involved 5 uncertainty mostly due to random uncertainty the tpiv measurements involved uncertainties ranging from 1 to 17 the uncertainties were largest close to the vortex separation region and decreased with the vortex progression on an average the vortex core location measurements showed lowest uncertainty and q measurement showed the largest uncertainty the cfd simulations were performed using grids with 48m 84m cells the grid scale in the vortex core was found to be in the inertial subrange 2 to 4 times larger than the taylor s microscale and 40 95 of the total tke was resolved the predictions of forces and moment wave elevation vortex core location and momentum deficit in the vortex core compared within 6 of the experimental data but the vortex strength was overpredicted by 90 and core tke were underpredicted by 60 cfd predictions were used to fill in the sparse experimental data to understand the effect of drift angle on the mean and turbulent flow features the forces and moment increased with the drift angle the surge force showed a quadratic increase whereas both the sway force and yaw moment showed a cubic increase the wave elevation showed diverging waves on both starboard and port sides the wave envelop angle increased on the port side and decreased on the starboard side with the increase in β however the total wave envelop angle remained almost constant the primary vortical structures were identified to be sonar dome and forebody keel vortices for the straight ahead condition and sonar dome tip and bilge keel tip vortices for the drift conditions the primary vortices for β 0 advected in the hull boundary layer and were elliptic in shape the primary vortices for β 10 and 20 showed helical breakdown after onset and advected away from the hull on leeward side they were circular in shape and planar distribution of their strength showed either gaussian or bell shaped profile the vortex strength increased with β and decreased with progression as vortices diffused however vortex diffusion was not accompanied by momentum recovery in vortex core the momentum deficit was sustained for β 0 due to interaction with boundary layer whereas for β 10 and 20 the deficit increased due to turbulence generation because of helical instability the turbulence generated in the vortex core was transported away from the core symmetrically in the plane normal to the vortex axis the data sets reported herein provide detail description of the mean and turbulent flow pattern for a range of drift angle however the experimental datasets can be further improved future investigations should focus on 1 unsteady analysis to better understand the helical instabilities of the vortices for large drift angles 2 the interaction of the primary vortices with the boundary layer in the afterbody including nominal wake for β 0 is an important aspect of propeller design which is still not fully understood and needs to be further investigated and 3 the tpiv measurements have narrow volume width and low data rate which inhibits accurate measurements near the hull and full understanding of the vortex onset characteristics e g the onset of sdtv is still debatable a time resolved particle tracking velocimetry ptv or 4d ptv measurements allows larger measurement volume and reduces laser specular reflection from the hull allowing measurements near the hull future measurements will be performed using 4d tpv system lastly further analysis is required to understand the vortex decay mechanism for this purpose tke and vorticity budgets will be performed using cfd results for sdv and fbkv vortices for β 0 case also the different variant of des models and turbulence triggers need to be investigated to improve cfd predictions finally the changes in the flow characteristics with drift angle at full scale is important from the applications perspective cfd simulations can provide full scale solutions using wall functions bhushan et al 2009 however the grid resolution requirements in the vortex core is expected to increase significantly future research should investigate extension of the cfd simulations for full scale credit authorship contribution statement shanti bhushan validation software formal analysis visualization writing review editing hyunse yoon validation data curation software formal analysis visualization writing original draft frederick stern conceptualization writing review editing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements office of naval research grants n00014 17 1 2083 and n00014 17 1 2084 under administration of drs thomas fu woei min lin and ki han kim sponsored the iihr research the simulations were performed using dod navy dsrc hpcmp resources appendix i tpiv system and data reduction the tpiv system consists of a dual head nd yag laser a submerged light sheet generator four imager pro sx 5m 2456 2058 pixel ccd cameras and a davis8 software the laser is a cfr400 model by quantel with a 190 mj pulse power with adjustable pulse repetition rate up to 15 hz the highest frame rate of the cameras is 14 2 frames per second fps at the maximum pixel resolution for the present study a 2 2 hardware pixel binning was used to achieve a faster frame rate of 26 fps the optical lenses for cameras are nikkor 50 mm f 1 8d equipped with motors for remote focusing and aperture adjustments the camera bodies are equipped with motors for remote scheimpflug angle adjustments all cameras are arranged in submerged cylindrical enclosures of 90 mm diameter the enclosures are modular type that consists of a mirror section at the bottom end with a glass window a camera section on top of the mirror section and hollow tube sections on top for the clamping to the traverse system silver coated hollow glass sphere particles sh400s33 by potters beads were used as seed material the particles have a mean diameter of 14 μm and an average density of 1 7 g cm3 about 25 g 4 scoops of particles were mixed well with about 25 gallons of water by using a motorized stirrer the mixture was discharged using a water pump and through a perforated horizontal tube of 1 cm diameter and 50 cm length seeding was made along the towing tank centerline at a speed about 0 2 m s about 5 gallons of the mixture was discharged for each seeding run typical average seeding density was about 1000 2000 particles cm3 calibration of the tpiv system was done by using a two tier calibration plate type 204 15 by lavision the plate had a regular pattern of circular marks of 3 2 mm diameter with a 15 mm spacing the depth difference between two tiers was 3 mm the calibration mapping was done first by using the pinhole fit within davis8 the average deviation to marks after fitting was less than one pixel for all cameras a volume self calibration westerweel and scarano 2005 was followed to correct the calibration mapping function for any misalignments by slight movements of the camera while towed underwater the number of sub volumes of 7 7 5 in each axis direction was used for disparity vector computations a typical average size of the disparity vector was about 2 5 pixels from the calibration procedures the size of the fov of the present tpiv setup was determined as 100 mm 100 mm 15 mm in width y height z and depth x the width and the depth of the fov varied case by case and were as large as 114 mm and as small as 12 mm respectively for β 0 measurement although model drift angle setup was done carefully the flow structure on the port and starboard sides were found to be asymmetric due to either minor misalignment of the model with respect to the actual towing direction or the unevenness in the hull geometry during manufacturing a neutral angle test was performed by testing various drift angle around 0 with a small incremental step and the best angle was chosen which showed the most symmetric flow pattern streamlines and vortex core locations near the model centreplane the appropriate neutral angles were found to be β 1 0 5 and 0 for x l p p 0 06 0 2 0 3 0 4 and 0 6 1 0 respectively the tpiv recordings were processed using lavision davis v8 2 software in batch processes using two pc s each with two intel xeon cpu e5 2665 processors running on a 64 bit windows7 operating system the data processing time was approximately 1 1 5 h for a 260 image set the data in the raw images went through the following pre processing steps 1 the local minimum obtained over a 5 5 pixel region was subtracted 2 normalized by local average obtained by smoothing data over 300 pixels local averaging was performed for each image separately and all frames were normalized to the first frame and 3 each pixel value were subtracted by a constant value of 50 and multiplied by a factor of 10 volume reconstructions were done using the multiplicative line of sight mlos algorithm in general more precise volume reconstruction algorithms are recommended such as the multiplicative algebraic reconstruction technique mart or the fast mart algorithm however the mlos algorithm was chosen because the seeding quality in the present study was lower than the optimal seeding density required for higher accuracy algorithms the volume correlations were done using a direct correlation scheme with three steps using a 64 64 64 pixel interrogation window size followed by one step using a 32 32 32 pixel interrogation window size and using two passes for all steps all correlation steps used a 75 percent overlap and a peak search radius of 8 4 2 and 1 voxel from the first to the last step in a sequence the first three steps used volume binning with 8 8 8 4 4 4 then 2 2 2 sizes in sequence whereas no volume binning was used for the last step afterward the vectors were filtered by using a universal outlier detection removal insertion process westerweel and scarano 2005 of davis8 software spurious vectors were not replaced with interpolated values and the blank spots in the measurement area were not filled up typically the percentage of first choice vectors through this process routine was about 95 a custom fortran program was used for an additional vector filtering and data reduction the filtering was done by accepting vectors of which components values were within a predefined range determined based on statistics i 1 μ u v w c σ u v w u v w μ u v w c σ u v w where μ u v w and σ u v w are the mean and standard deviation of u v w within a certain measurement volume and through the measurement time and c is a coverage factor a coverage factor c 3 2 or 4 5 was used for the measurement volumes located close to the hull surface or around the vortex core respectively otherwise c 10 was used these c values correspond to a probability of p u v w μ u v w c σ u v w 90 95 and 99 respectively from tchebycheff s inequality for stationary random data of any type distribution if data are distributed normally a coverage factor c 3 29 corresponds to a 99 9 probability next a threshold number n thld was defined if the number of vectors n at a certain location was less than n thld after this range filtering then n was considered as not large enough for a statistical convergence and the vector set was discarded with the location left as a blank spot for the present study n thld 0 5 n max was used where n max n img n run n img is number of images and n run is number of runs lastly the vector data from each carriage run were first time averaged for each carriage run and then further averaged for the repeat carriage runs all flow variables were non dimensionalized using u c and l p p appendix ii statistical convergence forces and moment were first tested for randomness stationarity and normality testing for randomness was performed by observing the time history of the dataset and inspecting the frequency spectrum via fft for an obvious non stationary or non random data stationarity test was performed by using a non parametric statistical procedure a run test or a trend test data normality is examined by performing a chi square χ 2 goodness of fit test all the tests were performed at a 5 level of significance the details of the methodology are provided in yoon et al 2015a statistical convergence was achieved by repeated carriage runs and convergence error e sc for a variable φ was examined by ii 1 e sc c s φ n φ ref 100 where s φ is the sample standard deviation of φ and n is the sample size for a 95 confidence level c 2 was used when the data follow a normal distribution whereas c 4 5 was used when the type of data distribution was unknown the reference φ ref can be any meaningful value and herein the sample mean φ was used for f x f y and m z c 4 5 was used as the data failed the normality tests and e sc 3 0 5 and 0 2 respectively except for f y and m z for β 0 where the φ values were very small the tpiv velocity variables were assumed stationary random data i e it was assumed that the mean and variance values do not vary with time in addition the data were assumed to follow a normal distribution the statistical convergence error of the time mean velocities was defined by eq ii 1 with c 2 for a 95 confidence level and using the towing speed u c as φ ref if velocities follow a normal distribution then its variance i e reynolds normal stress should is expected to follow a chi square distribution thus the statistical convergence error lower value e sc l and upper value e sc u in a reynolds stresses was defined as ii 2 e sc l 1 n χ n α 2 2 s φ 2 φ ref 2 100 ii 3 e sc u n χ n 1 α 2 2 1 s φ 2 φ ref 2 100 where χ n α 2 2 and χ n 1 α 2 2 are the chi square variable with n n 1 degrees of freedom and α 0 05 for a 95 level of confidence the derivation of eqs ii 2 and ii 3 is provided in yoon et al 2015a the peak turbulent kinetic energy k peak is used as φ ref 2 the statistical convergence analysis for the flow measurements were performed at two points designated as a and b at the nominal wake plane x l pp 0 935 for β 20 case point a was selected at the core of sdtv where the velocity magnitude v u 2 v 2 w 2 0 497 and turbulence k k peak 0 0838 point b was selected away from the vortex core where v 0 987 and k 0 07 k peak the analysis was done for data sets of 250 260 samples collected from single carriage runs for point a the velocity measurements showed e sc 3 u c and reynolds stress measurements showed e sc l 8 12 k peak and e sc u 10 16 k peak the convergence at point b was relatively faster than at point a and showed smaller e s c 0 8 u c for the velocities and an order of magnitude smaller e sc l 0 7 k peak and e sc u 1 0 k peak for the reynolds stresses the stationarity and normality of the datasets were assessed using a non parametric statistical procedure reverse arrangement test and a chi square goodness of fit test respectively for point a the stationarity and normality hypothesis were rejected at the rate of 40 and 60 respectively thus the true errors can be larger than the present estimations appendix iii validation of des and variants for hydrofoil flow separation the predictive capability of blended k ω bkw and spalart allmaras sa spalart and allmaras 1994 based urans ddes and improved ddes iddes models were investigated for flow separation over hydrofoil trailing edge as originally used by shur et al 2008 for the validation of sa based ddes and iddes models the flow domain and boundary condition are shown in fig iii1 a the study used two systematically refined grids consisting of 4 5m and 12 72m cells note that the grid size used herein is significantly larger than the grid with 1 5m cells used by shur et al 2008 this is because the entire hydrofoil is simulated herein whereas shur et al 2008 simulated only the trailing edge section the experimental data for this case blake 1975 includes mean streamwise velocity and streamwise velocity fluctuation profiles at several cross sections in the trailing edge section i e at x h 18 through 20 5 where h is the hydrofoil thickness as shown in fig iii1 b both cfdship iowa urans and des predictions improve significantly with grid refinement and results obtained on the fine grid are presented in fig iii1 through iii3 as shown in fig iii1 c slightly upstream of the hydrofoil trailing edge at x h 18 des underpredicts the streamwise velocity near the wall and overpredicts them away from the wall which results in large flow separation region as shown in fig iii1 d fig iii1 e f demonstrates that lower momentum in the boundary layer was due to early activation of les in the boundary layer which results in underprediction of the turbulent eddy viscosity ddes and iddes both resolve this issue by delaying the les transition this improves the predictions at x h 18 and the separation region was somewhat reduced at x h 20 however the separation region is still large compared to the experiments also note that urans predicts that the flow remains attached even at x h 20 suggesting that urans overpredicts the turbulent stresses resulting in underprediction of the flow separation the instantaneous flow pattern in fig iii3 b shows that ddes predicts mostly organized large scale vortex structures and the flow is devoid of any resolved turbulence even though les is active in the entire hydrofoil region thus the ddes prediction errors are due to modeled stress depletion iddes shows the same limitation an artificial turbulence trigger was applied upstream of the trailing edge to trigger the resolved turbulence which resulted in the generation of 3d coherent structures in the trailing edge as shown in fig iii2 c simulations using bkw based ddes and iddes model showed very similar trends the mean streamwise and tke predictions on the hydrofoil trailing edge cross sections obtained using sa and bkw based urans and iddes results on fine grid are compared against experimental data blake 1975 and shur et al 2008 sa based iddes predictions in fig iii3 results show that both bkw and sa urans underestimate the flow separation region sa predictions show attached flow even up to x h 20 5 and bkw predictions shows onset of separation at this location bkw performs very well for the turbulence predictions except at x h 20 5 sa model does not provide turbulence predictions thus are not shown both bkw and sa based iddes show very similar predictions as in both cases turbulence is 95 resolved the mean velocity profiles compare very well with the experiment and are somewhat over predictive at x h 20 and 20 5 in the same region shur et al 2008 results are somewhat under predictive the turbulence is overpredicted in this region both herein and in shur et al 2008 iddes with turbulence trigger models was also applied for flow over 5415 with bilge keels at β 0 the results showed resolved turbulent structures addressing the low resolved turbulence issue reported by bhushan et al 2014 2019 overall the results demonstrate that artificial turbulence trigger can help alleviate the modeled stress depletion issue in des fig iii 1 a hydrofoil simulations domain and boundary condition b streamwise velocity contour and experimental measurement cross section locations for the hydrofoil case streamwise velocity profile at c section c x h 18 and d section f x h 20 predicted by sa urans des and ddes are compared with experimental data e turbulent eddy viscosity profile and f urans and les length scale ratio at section c ratio of 1 represent rans region ratio close to 0 is pure les region the results are shown for fine 12 72m grids fig iii 1 fig iii 2 instantaneous flow at the trailing edge obtained using sa based urans top b ddes middle and ddes with turbulence trigger bottom vortical structures are shown using isosurface of q 20 and are colored using piezometric pressure the inset figure in b shows the rans and les region in the trailing edge section the red zones are the rans regions and the blue contours are the les region fig iii 2 fig iii 3 comparison of mean streamwise velocity left panel and root mean square rms streamwise turbulent fluctuation right panel predicted by blended k ω and sa urans and iddes models at x h 18 19 19 5 20 and 20 5 on fine 12 72 m grid is compared with experimental data blake 1975 and shur et al 2008 sa iddes results the x h locations have been marked in fig iii1 b fig iii 3 
20215,a coupled experimental and computational study is performed to discuss the overall trend in surface combatant 5512 forces and moment and flow pattern with the change in hull drift angle β from straight ahead β 0 to static drift β 10 20 conditions the local flow measurements were performed using tomographic particle image velocimetry tpiv which involved uncertainties ranging from 1 to 17 and the uncertainties decreased with the vortex progression the surge force increased quadratically with the drift angle whereas the sway force and yaw moment increased cubically the wave elevation showed diverging wave pattern from both starboard and port sides the wave angle increased and decreased on the port and starboard sides respectively with the increase in β but the total wave envelop angle remained almost constant both experiments and computational fluid dynamics cfd predictions showed very similar vortical structures the β 0 flow showed structures emanating from the sonar dome forebody keel and bilge keel aligned which progressed along the hull the static drift flows showed structures emanating from the sonar dome tip bilge keel tip and aft body keel which advected away from the hull the primary vortices for the static drift case were circular and showed gaussian or bell shaped planar distribution the vortex strength increased with β and decreased with progression as vortices diffused the momentum deficit in vortex core was sustained for β 0 due to interaction with boundary layer whereas for β 10 and 20 the deficit increased due to turbulence generation in the core because of helical instability the tpiv measurements for the first time provided detailed measurements for the progression of the vortical structures and associated mean and turbulent flow characteristics for ship flows however they have larger uncertainties near the hull which limits analysis of the vortex onset characteristics future work should focus on time resolved particle tracking velocimetry ptv to address these issues 1 introduction ship flows involve complex flow features that continuously change during maneuvering and their physical understanding is essential for design purposes advances in measurement techniques from pitot tube to particle image velocimetry piv to stereo piv spiv to tomographic piv tpiv westerweel and scarano 2005 is opening new opportunities to understand the complex flow features and associated physics tpiv measurements of mean and turbulent flow field around ship hulls during complex maneuvering conditions can be challenging as they require large scale towing tank rotating arm or wave basin facilities in addition the experimental dataset can be sparse thus they do not allow detailed analysis of the onset separation and progression of the vortical structures computational fluid dynamics cfd can provide detailed description of the flow field and the advances in high performance computing are allowing larger grids and high fidelity models to improve their accuracy nonetheless they still involve numerical and modeling challenges stern et al 2015 several experiments have been performed to assess surface combatant 5415 geometry of interest flow characteristics and the dataset has been extensively used in collaborative ship hydrodynamics workshops to assess the predictive capability of computational methods and models as discussed below olivieri et al 2001 and longo et al 2007 performed mean and turbulent flow field measurements for barehull 5415 at straight ahead β 0 condition olivieri et al 2001 performed measurements for an l pp 5 72 m model where l pp is the model length between parallel perpendiculars using a 5 hole pitot tube at several cross section along the hull x l pp 0 06 to 1 0 longo et al 2007 performed measurements using piv at the nominal wake plane x l pp 0 935 for an l pp 3 048 m model both the measurements compared reasonably well with each other at the nominal wake plane and showed presence of two co rotating vortices however the origins of the vortices could not be confirmed as the data were too coarse these measurements were used in the gothenburg 2010 workshop g2010 for the validation of the cfd predictions bhushan et al 2014 the study concluded that anisotropic turbulence models perform better than the isotropic models for the prediction of turbulence structures and detached eddy simulation des is more accurate than unsteady reynolds averaged navier stokes urans for the prediction of vortical structures as the latter was overly dissipative further for the first time des on large grid with 300 million m points provided detailed flow topology and helped identify that the closed streamlines at the mid girth observed in the experiments were due to the sonar dome sdv and forebody keel fbkv vortices post g2010 analysis focused on detailed investigation of onset and progression of vortical structures generated from the sonar dome the analysis revealed an addition vortex from the sonar dome trailing edge sdtev and the onset of all the three primary vortices were identified to be due to open type crossflow separation however des showed significantly under resolved turbulence since the study did not include simulations on systematically refined grids the relative contributions of the grid and turbulence modeling errors could not be ascertained it was concluded that the under resolved turbulence was possibly due to modeled stress depletion in addition the available experimental data were too sparse and lacked turbulence measurements for comprehensive analysis g2010 workshop also included 5415 roll decay and forward speed diffraction test cases using piv datasets procured by irvine et al 2013 and longo et al 2007 respectively irvine et al 2013 measured free surface and velocities at x l pp 0 675 during different phases of the roll decay motion for 5415 with bilge keel with initial roll angle of ϕ 10 longo et al 2007 procured velocities at different phases of the head waves using piv at nominal wake plane for barehull 5415 the datasets were primarily for the validation of the cfd models and detailed assessment of cfd methods and models were not performed yoon 2009 measured forces and moment for barehull and appended 5415 under static drift fixed sway and yaw and dynamic zig zag and turning circle manoeuvres these datasets were used in the simman 2008 workshop stern et al 2011 to assess the cfd predictions under manoeuvring conditions the dataset for static drift β 20 was also used by bhushan et al 2011 for validation of isotropic and anisotropic urans and des predictions the study reported that the prediction errors for forces and moment reduce significantly from 15 to 5 as the grid is refined from 2m to 10m cells the study provided an initial assessment of the primary vortical structures and signatures of the vortices on the free surface yoon et al 2015a 2015b performed detailed flow measurements of mean and turbulent flow field around 5415 appended with bilge keels during dynamic planar motion mechanism pmm manoeuvres using 3d stereoscopic piv spiv atsavapranee et al 2010 measured flow field around 5415 during steady turn using spiv spiv measurements have been also performed for other ship hulls such as flow field around high speed delft catamaran dc at β 6 and 9 falchi et al 2014 and around container ship kvlcc2 at β 30 these datasets were used for validation of cfd predictions for nato avt 183 collaborative research yoon et al 2014 and egeberg et al 2014 procured towed tomographic piv tpiv measurements for 5415 with bilge keels using an l pp 3 048 m model for β 0 and static drift β 10 and 20 conditions the experiments were guided by preliminary blind simulations by bhushan et al 2011 which helped in identifying regions of interest and key validation variables tpiv extends spiv for volume measurements enabling more detailed analysis of flow structures including axial derivatives of the velocity vector required for transverse vorticity components q criteria second invariant of rate of strain tensor and other variables of interest scarano 2013 the data for β 0 and static drift β 20 were used for nato avt 183 sea facet research reliable prediction of separated flow and onset and progression for air and sea vehicles the collaborative research included eight 8 submissions mostly using urans and only one des and several simulations used 40 80m grid cells bhushan et al 2015 the study identified that adapted grid with 10m grid points with appropriate near wall grid resolution i e y 1 for near wall model and y 30 for wall functions are sufficient for accurate forces moment and wave elevation predictions but finer grid resolutions are required for an accurate prediction of the vortical structures computations using 20m grid points predicted onset and overall vortex structures well but showed large 30 40 errors for vortex progression similar to g2010 des performed better than urans for the prediction of vortical structures and latter was overly dissipative systematic grid refinement study confirmed that the failure to predict resolved turbulence for the β 0 flow was due to modeled stress depletion for β 20 des predicted 95 resolved turbulence and performed better than urans for the vortex progression however des significantly underpredicted vortex strength and tke in the vortex core when compared with the experiments the underpredictions were attributed to inadequate grid resolution in the vortex core region the study also provided detailed diagnostics of the vortex onset separation and progression associated instabilities and turbulent structures the primary vortices in the flow namely sonar dome tip sdtv and windward bilge keel tip bktv vortices showed helical type breakdown and for both the peak tke occurred at the breakdown the data for β 10 was recently used for nato avt 253 collaborative research compared to the nato avt 183 effort the effort included more submissions 14 larger grids grids with 50m 160m cells and wide range of mix of urans and des or delayed des ddes turbulence models i e around one third of the submissions used d des the study helped in better understanding the limitations of the d des prediction identified in nato avt 183 and the key conclusions of the study are summarized in section 3 2 this objective of this research is to document the tpiv experimental methods and datasets for 5415 with bilge keels at β 0 10 and 20 conditions and perform a coupled experimental and computational study to discuss overall trend in surface combatant 5415 forces moment and flow pattern evolution with the increase in the hull drift angle the details of the initial tpiv experimental methods were presented in conference papers yoon et al 2014 egeberg et al 2014 herein the details of the final experimental set up including data reduction uncertainty and statistical converge of the datasets are reported tpiv measurements have not been used for ship flows before which is a novelty of this research the experimental datasets have been used in previous nato avt 183 and avt 253 collaborative research as discussed above to validate the predictive capability of state of the art ship hydrodynamics solvers however herein the dataset is used to understand how the mean and turbulent structures of the flow changes with drift angle the study leverages complimentary cfd simulations to fill in the sparse experimental datasets to develop a complete understanding of the vortex onset separation and progression characteristics the datasets and cfd results for β 0 and 20 have been published in bhushan et al 2019 thus this study primarily focuses on datasets and cfd results for β 10 this study also performs detailed assessment of the effect of grid resolution and urans and des turbulence models on the cfd predictions including a canonical test case flow over a hydrofoil trailing edge to document the strengths and weakness of the commonly available cfd methods and models for ship flow applications the following section provides details of the experimental measurements section 3 provides summary of the cfd simulation set up including a summary of the limitation of the d des predictions as identified in nato avt 183 and avt 253 studies sections 4 5 6 and 7 provide a discussion of the effect of drift angle on the forces and moment wave elevation vortical structures and flow pattern respectively finally in section 8 key conclusions and future research directions are provided 2 experimental methods 2 1 facility model and conditions the experiments were performed in iihr towing tank which is 100 m long 3 m wide and 3 m deep and equipped with a drive carriage a pmm carriage and wall side wave dampeners and wave dampening end beach fig 1 a the drive carriage was instrumented with data acquisition computers a speed circuit and signal conditioners the drive carriage pulls the pmm carriage which was used as a contact point of attachment for the model the wave dampeners and the end beach enabled 12 min intervals between carriage runs which was determined to be sufficient based on visual inspections of the free surface experiments were performed using a dtmb 5512 model which is a geosim of dtmb model 5415 latter is a 1 24 8 scale model with l p p 5 72 m of the u s navy s pre contract design for a surface combatant ddg 51 ca 1980 with a sonar dome bow and transom stern the dtmb 5512 is a 1 46 6 scale model made with fibre reinforced plexiglas hull model and has l p p 3 048 m and block coefficient c b 0 506 the model was un appended except for port and starboard bilge keels i e not equipped with shafts struts propellers or rudders the measurements for forces and moment were conducted at various drift angle β 0 to 20 and flow field measurements were conducted at β 0 10 and 20 all of the measurements were conducted using towing speed u c 1 531 m s corresponding to fr 0 28 the model was ballasted to the dynamic sinkage σ 1 92 10 3 l p p and trim τ 0 136 positive bow up corresponding to the dynamic σ and τ expected for straight ahead case at fr 0 280 longo et al 2007 the model was mounted rigidly to the pmm using a fix mount the flow reynolds number re 4 65 106 based on a water temperature of 20 c and l p p to initiate turbulent inflow conditions a mesh consisting of a 1 6 mm high and 3 2 mm diameter cylindrical studs spaced 9 5 mm apart was placed 0 05 l p p upstream of the forward perpendicular fp the stud dimensions and placement on the model are in accordance with recommendations by the 23rd ittc the experimental conditions for all β have water depth froude number fr h 0 7 water depth to model draft ratio h t 4 tank width to model length ratio w l 0 35 and the tank area to model cross sectional area a t a m 15 which satisfy the ittc 2002 criteria however for β 20 the tank width w to the model width b ratio is 2 9 where w b 4 signifies the flow surrounding the model could be affected by blockage metcalf et al 2006 2 2 validation variables the data are presented in cartesian ship fixed coordinate system where x is along the model centreline pointing to downstream y to starboard z upward and the origin is at the intersection of the water plane and the forward perpendicular note that the coordinates are normalized by l p p as summarized in table 1 the measurements included a carriage speed u c b surge force x sway force y and yaw moment n c wave elevation ζ d planar y z planes flow velocity u v w axial vorticity ω x tke and reynolds stresses at ten 10 x l p p planes shown in fig 1 d and e 3d volume solutions at selected locations along the primary vortex core between x l p p 0 06 to 0 6 for β 0 and between x l p p 0 06 to 1 0 for β 10 and 20 the measurement volumes for β 10 are shown in fig 1 e the volume measurements included flow velocity u v w and their derivates and tke the velocity derivatives allowed calculation of vorticity vector ω x ω y ω z second invariant of rate of strain tensor q and 2nd largest eigen value of rate of strain tensor λ2 the time history of u c are analysed using fast fourier transform fft to evaluate the dominant vibration frequencies in the measurements the dominant frequencies in the forces and moments are compared against those of u c to determine instabilities due to hydrodynamics and the cfd results provide an insight into the source of instabilities the wave elevation pattern on the windward and leeward sides and at selected wave cuts are used for validation and the variation of the diverging and transverse wave pattern with drift angle are discussed the isosurfaces of q are used to identify the primary vortices in the flow their separation location and progression wherein cfd fills in the sparse experimental data and provides finer details of the flow the variation of flow variables in the vortex core identified by the peak q value q peak are used for the validation of cfd results the vortex core flow variables used for the analysis are q peak locations y core and z core axial velocity u core axial vorticity ω core and tke k core the cross plane variations of q u ω x and tke along y y and z z line passing through the vortex core is analysed to evaluate the vortex structures the axial and cross plane vortex core analysis provides quantitative validation of the cfd flow predictions the planar distribution of u and tke are used evaluate the flow pattern i e wake deficit and tke generated by the vortical structures the results on all three β are analysed to study the effect of drift angle on flow predictions 2 3 data acquisition and measurement uncertainties the key details of the measurement locations systems and associated uncertainties are provided in table 1 carriage speed u c was measured using an integer pulse counting encoder mounted on a wheel with a linear resolution of 0 15 m pulse longo and stern 2005 forces and moment were measured using an izumi six component strain gage type loadcell six izumi amplifiers 16 channel ad converter and pc the loadcell was statically calibrated on a test stand using standard weights the measurement rates and duration were 100 u c l p p and 40 l p p u c respectively the uncertainty in the forces and moment measurements were assessed following the aiaa standard 1999 ansi asme 1998 and agard 1994 standards and guidelines the procedure is based on the estimates of systematic bias b φ and random precision s φ limits and their root sum square rss combination provides total uncertainty u d b φ 2 s φ 2 bias limits were estimated considering elemental error sources from individual variables whereas precision limits are estimated by repeating the tests 12 times a 95 confidence level was achieved through careful estimations of the bias errors and usage of a multiple test approach for the precision errors the details of the procedure are provided in yoon et al 2015a in general b φ 2 u d 2 90 and s φ 2 u d 2 10 for all variables indicating the variables results are highly repeatable for x measurements the primary bias error source was identified due to error in the carriage speed measurement which was around 0 72 u c for y and n measurements the primary bias error source was identified due to drift angle setting which was around 2 2 β the total uncertainty is estimated as 3 6 5 4 and 2 6 for x y and n respectively wave elevations were measured using a longitudinal wave cut method using two kenek servo type wave probes mounted on a motorized traversing system longo and stern 2005 the probes and traversing system were cantilevered from the tank side wall the data were collected at 31 53 and 37 cuts for β 0 10 and 20 respectively with a fixed spanwise spacing of δ y 0 01 l p p between each cut the uncertainties for the wave elevation measurements were estimated for β 20 case the random uncertainty s ζ 2 u ζ 95 2 94 was found to be the major contributor whereas the systematic uncertainty contribution was minor b ζ 2 u ζ 95 2 6 the averaged uncertainty was estimated to be around 5 of the bow wave height the flow velocities u v w were measured using a towed underwater tpiv system by lavision the details of the tpiv system is provided in appendix i the assembly of the tpiv system is shown in fig 1 a c the system was assembled such that the laser and light sheet optics delivered a vertical light sheet in the y z cross plane the camera enclosures were placed downstream of the light sheet to minimize wave and flow disturbance by the enclosures the enclosures were arranged asymmetrically in the horizontal plane with one pair at about 20 from the model centerline and another pair about 35 from the measurement plane the camera enclosure pairs consisting of one shorter and one longer length enclosure were arranged back to back in the vertical plane with former placed behind the latter the shorter and longer enclosures were tied together using a clamp above water surface and the two longer enclosures from each pair were braced rigidly using an underwater bracing to prevent relative motions among cameras due to the vibrations from carriage runs the top cameras inside the shorter enclosures had a normal viewing angle to the measurement plane whereas the bottom cameras in the longer enclosures have a low view angle that looked up the measurement plane at an angle of 30 the longer enclosure mirror section was filled with water to avoid optical aberrations due to the oblique view angle data acquisition was completed at multiple overlapping zones at each x l p p station to map the entire region of interest the total number of zones were 61 139 and 134 for β 0 10 and 20 respectively tpiv recordings were performed at 13 hz for 20 s thus n img 260 images were captured by each camera from each carriage run laser power was set at 70 and the time interval between the double frames was set at 700 μs the vector spatial resolution of tpiv field of view fov was about 1 mm in all directions the uncertainties in tpiv measurements were obtained following asme ptc 19 1 2005 2005 standard first the standard uncertainty u φ b φ 2 s φ 2 were estimated from the systematic b φ and random s φ standard uncertainties then the combined standard uncertainty was expanded to a 95 level of confidence by multiplying an expansion factor to obtain u d φ t 95 u φ where t 95 2 was used considering large degrees of freedom the systematic uncertainties were not computed directly from data reduction equations associated with the tpiv measurement system instead they were obtained using a reference measurement of simple flows that provided a good representation of measurement errors for this purpose uniform flow was measured by towing the tpiv without the model attached which included towing along the tank centreline at 6 different speeds 0 23 0 45 0 67 0 88 1 0 and 1 09 u c and oblique towing at 1 0 u c at 9 different angles β 20 20 at 5 increments the measurements were done by using the same data acquisition and reduction procedures used for the case with the model attached the validation used a standard error of estimate 1 s e e φ φ ref 2 m 2 where φ is the measurement variable φ ref is the expected value of φ and m is the number of observations the study used m 6 for the straight towing case and m 9 for the oblique towing case the systematic uncertainty is defined as the rss of the validation error b s e e and the accuracy associated with the expected values used for the validation b φ ref such that 2 b φ b s e e 2 b φ ref 2 where b s e e s e e and b φ ref is the error propagation of elemental uncertainties the validation error b s e e is usually less than 1 of u c whereas the accuracy in the expected values b φ ref 0 4 of u c similarly for both the straight and oblique towing cases the resulting b φ 1 of u c for all variables by selecting the larger estimation values between the straight and oblique towing cases table 1 summarizes the measurement uncertainties for the vortex core variables the systematic uncertainties of y core and z core are b φ 1 and 2 mm for the β 0 and 20 case respectively the b φ s of u core and k core were estimated based on those estimated for u c the b φ s of ω c o r e and q peak were assumed to be zero as they are differential variables the random uncertainty s φ was estimated using 10 repeat measurements analysis shiows that the uncertainty in the core location measurement is dominated by systemic uncertainty both systemic and precision uncertainties are comparable for u core and k core measurements and uncertainties for ω c o r e and q peak are due to precision uncertainty u d is less than 4 for all variables except for q peak for which u d is up to 17 the uncertainties are larger for the early progression of the vortex i e x l p p 0 12 due to measurement issues near the hull where u d is about 2 times higher than those in late progression 3 cfdship iowa simulation setup 3 1 numerical methods and models the general purpose cfdship iowa v4 5 solves the urans des equations for semi coupled two phase flow in either absolute inertial earth fixed or relative inertial coordinates for an arbitrary non deforming control volume stern et al 2015 the solver provides several turbulence modeling options including blended k ε k ω sst bkw menter 1994 and anisotropic reynolds stress ars wallin and johansson 2000 urans models and their des spalart and allmaras 1994 xing et al 2007 and wall function wf bhushan et al 2009 options the interface modeling is performed using level set method a multi block dynamic overset grid approach is used to allow relative motion between the grids for six degrees of freedom 6 dof ship motions noack 2005 carrica et al 2007 the code provides propeller modeling and a proportional integral differential controller for self propulsion simulations carrica et al 2013 the solver is parallelized using mpi based domain decomposition and shows good strong scalability up to 2048 processors for static simulations bhushan et al 2011 3 2 previous verification and validation and des assessment bhushan et al 2019 reported numerical uncertainty levels expected in cfdship iowa simulations using factor of safety method xing and stern 2010 the estimates were performed for 5415 with bilge keels at static drifts β 0 and 20 using three systematically refined grids consisting of 10m 48m and 84m cells with refinement ratio r g 2 for both β forces and moment predictions showed grid uncertainty u g 2 2 and 1 2 for urans and des respectively the free surface predictions showed grid uncertainties of u g 3 5 and 6 for β 0 and 20 respectively for both urans and des for the des vortex core predictions the grid uncertainties were large u g 13 5 and 18 for β 0 and 20 respectively as discussed in the introduction previous collaborative research has demonstrated that des performs better than urans for the progression of the vortical structures and has the ability to predict turbulence anisotropy however they do not show consistent improvement in the results with grid refinement for example for 5415 at β 0 the des prediction errors reduce when the grid is refined from 10m to 48m cell but the errors increase on further grid refinement as shown in fig 2 whereas for 5415 at β 20 the results continue to improve with grid refinement from 10m to 84m cells also note that results on the 84m grid are better compared to those on 250m grid as the former included refinement only along the vortex core and the grid resolution in the core were finer a similar deterioration of des predictions with grid refinement has been reported in other studies for example for flow predictions around a container ship kvlcc2 at β 30 xing et al 2012 des on a 13m grid showed lower errors that those on a finer 305m grid for turbulence quantities for flow around 5415 with bilge keels at β 10 des using fine 163m grid wherein the grid resolution was sufficiently fine to resolve the entire inertial subrange overpredicted forces and moment by 17 and overpredicted tke close to the vortex separation by 100 200 on the other hand urans on the same grid predicted the above quantities reasonably well ideally des should predict boundary layer similar to those of urans except for some unsteadiness because of the resolved turbulent pressure fluctuations outside the boundary layer the above large difference between des and urans predictions could be attributed to either grid induced separation or modeled stress depletion issues the grid induced separation occurs due to the activation of les in the boundary layer with insufficient grid resolution this results in an underestimation of turbulent stresses and eventually boundary layer flow momentum rendering it more susceptible to separation this aspect is clearly demonstrated for flow over hydrofoil trailing edge as discussed in appendix iii the enhanced separation may deteriorate the forces and moment predictions and result in an excessive turbulence at the vortex separation compared to urans as observed by visonneau et al 2018 they can also result in high turbulence in the wake as observed by xing et al 2012 thus the poor predictions by des on finer grids can be attributed to grid induced separation as demonstrated in appendix iii for flow over hydrofoil the delayed des ddes or improved ddes iddes addresses this limitation by delaying activation of les in the boundary layer region xing et al 2012 also reported that ddes addresses the grid induced separation issue but then results in an underprediction of the turbulence visonneau et al 2018 reported that ddes significantly improves the forces and movement compared to des i e the errors reduced from 20 to 7 but the tke prediction error at the vortex separation increased even more these limitations of ddes can be attributed to modeled stress depletion the modeled stress depletion occurs when les is activated in the region which does not have sufficient resolved turbulence to maintain continuity of turbulent stresses across the urans les interface for flows over slender bodies wherein geometry induced flow instabilities are limited the stress depletion results in under resolved turbulence and overprediction of vortex strength due to lower turbulent dissipation in such cases further grid refinement results in further reduction in the modeled stresses resulting in low turbulence production this explains the extremely low tke predictions reported by bhushan et al 2019 for 5415 at β 0 or underprediction of tke by xing et al 2012 on 305m grid this limitation of des cannot be addressed by the ddes or iddes modifications as demonstrated for the hydrofoil simulations in appendix i however on an adhoc basis it can be addressed by imposing turbulence trigger upstream of the flow region of induce resolved stresses in the flow flows over bluff bodies may involve geometry induces instabilities or turbulence triggers and can naturally overcome the modeled stress depletion issue as reported by bhushan et al 2014 for 5415 at β 20 however for extremely fine grids insufficient turbulent stresses may impede the energy transfer from large scale to turbulent scales resulting in energy accumulation in the large scales the overprediction of large scale oscillations could be interpreted as turbulence and perhaps is the cause of high tke predictions by ddes close to vortex separation in visonneau et al 2018 this limitation could be due to lack of explicit les modeling in d des appendix iii 3 3 simulation domain and grids in this study simulations are performed for 5415 with bilge keels at static drifts β 10 using anisotropic urans and des on grids with 10m and 48m cells the grids used in the study are same as those used for β 20 bhushan et al 2019 except that the vortex core refinement grid was rotated to be aligned with the primary vortex progression direction as shown in fig 3 a the grid design includes a body fitted boundary layer grid for the hull and the bilge keel and nested cartesian overset grids away from the hull as shown in fig 3 b the averaged near wall grid resolution is estimated to be y a v g 0 94 and 0 55 for 10m and 48m grids respectively and the maximum wall spacing on the leeward sonar dome surface is estimated to be y m a x 3 2 and 1 85 respectively based on the previous 5415 β 0 and 20 studies the middle grid consisting of 48m grid is sufficient for accurate forces moment and wave elevation predictions but may have a penalty for the vortex core predictions however for the purposes of aiding in the presentation of the sparse experimental results the 48m grid results are deemed reasonable urans predicted a steady flow while des predicted an unsteady flow pattern as shown in fig 3 c and d for des les is active in the separated flow region whereas urans is active in the boundary layer and outside the separated flow region des predicted resolved turbulence level of around 20 and 40 of the total tke on 10m and 48m grids respectively an fft analysis of the velocity fluctuations in fig 3 f shows that the square of the amplitudes measure of energy content decreases with a f 5 3 slope consistent with those expected for inertial subrange thus unsteadiness is identified to be due to turbulence for the 48m grid the grid resolution in the vortex core has a length scale δc 0 0015l pp as shown in fig 3 e the sdtv vortex radius is l 0 01 l p p and k 0 024 u c 2 this provides an estimation of dissipation ε 0 1643 k 3 2 l 0 061 u c 3 l p p using the above values the taylor s microscale is estimated as λ t 10 ν k ε 9 3 10 4 l p p 2 83 mm the ratio of largest energy containing length scale and taylor s microscale is thus l λ t 11 pope 2000 reported l λ t r e l 10 where r e l k l ν for the present case r e l 1 55 10 3 r e l 7200 this results in l λ t 27 which is about 2 5 time higher than the above estimates the smallest λ t based on above two estimates is 3 7 10 4 l p p 1 14 mm as shown in fig 3 f the grid resolution lies within the inertial subrange which is required for les models the grid resolution is larger than the taylor s microscale and is somewhere in the range δc 1 6 to 4 λ t thus the predictions on the 48m grid is expected to depend strongly on turbulence models the simulations are performed using a time step size δt 0 0015 l p p u c using 96 processors for 8 flowtimes l p p u c and solutions over the last 4 l p p u c were averaged to obtain averaged values for validation 4 forces and moment fig 4 shows x y and n vs β obtained in the experimental and cfd and curve fits using analytic functions table 2 compares the experimental and simulation values and dominant frequencies and associated amplitudes of their unsteadiness the curve fits show a quadratic function a b β 2 for x and cubic function a β b β 3 for y and n where a and b are constants the ratio of the non linear to linear terms of the curve fit equation γ b β 2 a provides a measure of the non linear characteristics of the variable with β the ratio is negligibly small for small β for example γ 0 04 0 03 0 00 at β 5 for x y n thus x is nearly constant and less sensitive to β while y and n vary approximately linearly with β however for β 10 the ratio becomes considerably large for example at β 20 γ 0 72 0 47 0 06 for x y n thus all the variables exhibit more or less non linear trends with β the derivations and evaluations of the hydrodynamic derivatives abkowitz 1964 from the present data are discussed in yoon et al 2015a b the cfd predictions compare within 5 of the experiments for all β x is both due to frictional resistance and pressure distribution the frictional component dominates for β 0 where they account for 70 x and their contribution decreases with increase in β i e to 63 x for β 10 and 47 x for β 20 both y and n are mostly 99 due to hull pressure distribution for both drift angles the fft of the unsteady forces and moment for all β as shown in fig 5 and summarized in table 2 the experiments show dominant frequencies f f l p p u c of 10 15 and 20 the fft amplitudes are smaller for the straight ahead condition than those for the drift conditions experiments conducted at forward speed without the model showed that the carriage and pmm mount have natural frequency of around f 10 and 14 and mechanical noise around f 20 thus based on the experiments alone none of the dominant frequency can be considered to be of hydrodynamic origin cfd prediction for β 0 showed steady force whereas both β 10 and 20 showed unsteady forces and moment the dominant frequency for the unsteadiness was analysed from the x y and n time history over 1 28 flow time l pp u c or 512 time steps both β shows that unsteadiness amplitude for y is almost twice of that for x and n and unsteadiness for β 20 shows almost 2 larger amplitude than those for β 10 flow for β 10 shows two dominant frequencies around f 8 6 and 15 and β 20 flow shows somewhat higher frequencies f 10 and 20 bhushan et al 2019 reported that dominant frequencies of f 10 and 20 for β 10 are due to karman like vortex shedding from the sonar dome surface and the plunging breaking waves from the windward bow respectively a similar correlation between the flow instabilities and forces and moment dominant frequencies are expected for β 10 further results indicate that the flow instability frequencies and associated amplitudes increase with β 5 wave elevations fig 6 a c compares the wave contours and profiles predicted by cfd simulations for β 0 10 and 20 with experimental data the cfd predictions compare very well with the experimental data both for the wave amplitude and pattern the wave elevation shows diverging waves emanating from both the starboard and port sides for β 0 the diverging waves are symmetrical around the hull and the wave envelop angle on each side is approximately 16 5 the wave elevation angle is somewhat lower than 19 5 expected for the kelvin waves the wave symmetry is disrupted for β 10 due to the rotated hull the wave envelop angle is around αp 27 3 on the port side and αs 7 on the starboard side for β 20 the starboard waves exhibit an even larger asymmetry and αp 32 5 and αs 3 the wave profiles along the closest wave cuts shows that cfd predictions compare quite well with the experimental data where the averaged errors are estimated to be 4 3 5 6 and 6 9 for β 0 10 and 20 respectively the errors are somewhat higher on the starboard side than on the port side results show that wave angle on the port and starboard sides increase and decrease respectively with the increase in β however the total wave envelop angle is almost constant for all β and varies between 33 and 35 5 the bow wave crest on the starboard side and transom wave crest increases and bow wave trough on the port side decreases with the increase in β 6 vortex structures onset and progression 6 1 overall vortical structures and onset fig 7 shows the vortical structures for the β 0 10 and 20 obtained from the experiments and cfd predictions using q iso surfaces colored by helicity h the λ 2 criterion showed almost identical structures as the q criterion levy et al 1990 hunt et al 1988 the axial vorticity provided structures similar to those of q or the λ 2 criterion suggesting that vortices are more or less aligned with axial direction fig 8 shows a close up view of the vortices for β 10 the experimental data provides a limited view of the vortex progression and is not very reliable in the immediate vicinity of solid surfaces where the tpiv measurements are difficult this makes vortex identification and tracking of vortex onset and progression difficult thus cfd results are used in conjunction with experimental data to fill in the information the vortices identified for different β are summarized in table 3 the β 0 flow shows counter rotating symmetric structures with respect to the centerplane the primary structures are identified to be fbkv sdv and bilge keel vortex bkv all of these vortices show open type 1 1 open type separation occurs as the cross flow pressure gradients induce streamline convergence which along with the adverse axial pressure gradient induces high normal velocity lifting the vortex off the hull surface refer to simpson et al 1996 and bhushan et al 2019 for more discussions separation both fbkv and sdv exhibit clockwise rotation on the starboard side and counter clockwise rotation on the port side fbkv separates from the fore body keel at x l p p 0 107 advects parallel to the hull bottom and retains high q 50 up to x l p p 1 sdv separates from sonar dome surface at x l p p 0 065 and decays rapidly by x l p p 0 6 bkv separates from the sharp leading edge of the bilge keels and results in two counter rotating vortex sheets with nearly equal strength on the starboard side bkv pair includes a counter clockwise rotating vortex outward of the bilge keel and a clockwise rotating vortex inwards of the bilge keel cfd shows that the bkv pair decays significantly by x l p p 0 8 but in the experiments bkv is very much evident at x l p p 0 8 and interacts with fbkv cfd predictions show presence of additional vortices such as counter rotating after body keel vortex abkv pair emerging from the after body keel at x l p p 0 83 where the vortex on the starboard side is clockwise rotating and shows open type separation cfd also shows clockwise rotating mid hull vortex mhv on the starboard side which originates as an open type separation from the hull at x l p p 0 5 in between the keel and the bilge keels mhv was not observed in the simulations without the bilge keel bhushan et al 2014 thus it is identified that it is induced as the outward momentum flux caused by fbkv is constrained by the bilge keel simulations also show karman type transom vortices similar to those reported in bhushan et al 2012 for flow over athena hull both β 10 and 20 flows show similar axisymmetric vortical structures with respect to the centerplane and the effects of the static drift angle dominates the flow the strongest vortices are sdtv from the starboard leeward side and bktv from the port windward side both advect towards the starboard side and rotate counter clockwise and show open type separation followed by helical mode instability soon after onset sdtv originates due to the merger of leeward and windward sdv and separates from the sonar dome edge at x l p p 0 11 whereas bktv is generated due to the merger of multiple separations from the port side bilge keel leading edge around x l p p 0 4 the flow also shows fbkv from the port side ww fbkv with counter clockwise rotation and from the starboard side lw fbkv with clockwise rotation these vortices have same rotation as β 0 but they advect towards the starboard side similar to sdtv and bktv compared to β 0 the fbkvs are significantly weaker for the static drift cases and decay by x l p p 0 5 and 0 6 for β 10 and 20 respectively the bkv from starboard side ww bkv shows two counter rotating vortex sheets from the leading edge of the bilge keel at x l p p 0 4 similar to β 0 for β 10 the rotation of the vortex pair is similar to β 0 but the vortex strengths are different in particular the counter clockwise rotating vortex outward of the bilge keel is significantly weaker than the clockwise rotating vortex inwards of the bilge keels for β 20 the rotation of the vortex pair is opposite to that of β 0 as counterclockwise and clockwise rotating vortices are observed inward and outward of the bilge keel respectively the vortex pair shows similar strength and advects on starboard side at a shallow angle of θ 3 both β 10 and 20 show counter rotating abkv pair from the after body keel at x l p p 0 83 similar to β 0 however they also show an additional stronger counter clockwise rotating vortex from the after body keel which advects towards the starboard side similar to sdtv for β 10 the vortex retains its structure but for β 20 it merges with bktv cfd predictions also show free surface vortices due to wave breaking with clockwise and counter clockwise rotation on the starboard lw fsv and port ww fsv sides these vortices are much stronger for β 20 where ww fsv shows well defined multiple rollers due to spilling breaking pattern and lw fsv shows plunging breaking cfd simulations for both β 10 and 20 also show separation bubble on the starboard sonar dome surface which shows shear layer instabilities at separation and periodic enlargement and growth due to flapping like instability predictions also show counter clockwise rotating mhv on starboard side and transom vortices similar to β 0 6 2 progression of primary vortices the progression of primary vortices sdv and fbkv for β 0 and sdtv and bktv for β 10 and 20 are analysed using the variation of the primary vortex core variables as shown in fig 9 the variation of y core shows that β 0 vortices progress parallel to the keel the β 10 and 20 vortices progress at an angle θ 6 5 and 12 with respect to the keel respectively up to x l pp 0 8 and straightens further downstream the vortices for all β show similar z core variation where the vortices progress below the hull up to x l pp 0 6 and starts to move towards the free surface further downstream for all β cfd predictions of the vortex core location compare within 5 of the experiment both β 0 vortices and bktv shows largest q at the onset sdtv shows an increase in vortex strength early on peaks around x l pp 0 12 followed by helical breakdown the vortex strength q and ω core increases with the drift angle and their strength decays with progression the decay of vortex strength with progression is expected as the vortices diffuse the q values show an exponential decay where the decay exponent is much larger for β 0 compared to those of β 10 and 20 ω core shows a much slower decay than q cfd predicts the qualitative behavior of the variation of vortex strength with β and during progression very well but mostly under predicts q and ω core magnitudes the predictions errors for q are 140 for β 0 and 20 and 80 for β 20 and errors for ω core are 81 60 and 45 for β 0 10 and 20 respectively a momentum deficit is predicted in the vortex core except at the onset for β 20 for β 0 the deficit remains almost constant for x l pp 0 2 to 0 8 but increases for x l pp 0 8 the analysis reveales that sustained deficit up to x l pp 0 8 is because of the advection of the vortex in the vicinity of the hull particularly the momentum recovery due to vortex diffusion shear layer at the vortex edge draws ambient high momentum fluid into the core is balanced by the deficit induced by the boundary layer wherein the mean momentum is transferred to tke resulting in a sustained k core during progression the momentum deficit increases for x l pp 0 8 as the flow encounters adverse pressure gradient in the after body region the momentum deficit in sdtv and bktv cores show an increase during progression except that the increase for β 10 sdtv is very gradual an increase in the momentum deficit suggests transfer of mean momentum to turbulence or generation of tke in the core is higher than the momentum recovery due to vortex diffusion this also explains the sustained high k core throughout progression the tke generation could be due to helical instability of the vortex and since helical instability is more prominent for β 20 than those for β 10 this explains an aggressive increase in k core with β cfd predictions for the momentum deficit compare very well with the experiments and the prediction errors decrease with increase in β which are 8 3 5 and 2 4 for β 0 10 and 20 respectively however they significantly under predict tke levels for all β and the prediction errors are 60 this suggest that cfd underpredicts the tke generation in the core and momentum recovery due to vortex diffusion by similar magnitude the diffusion of the turbulence from the vortex core is discussed further in section 7 using the reynolds stress predictions 6 3 structure of primary vortices both sdv and fbkv are elliptic shaped sdv has major to minor axis diameter ratio of around 2 1 and the major axis is aligned at an angle of 40 with respect to the centerplate at x l pp 0 12 and slowly aligns with the centerplane such that the angle decreases to 25 at x l pp 0 3 fbkv has major to minor axis diameter ratio of around 3 2 and the vortex major axis is aligned with the hull throughout progression in both the vortices peak ω x momentum deficit and tke are coincident with the peak q their profiles mostly show bell shaped pattern along major axis and a semi bell shape along minor axis away from the hull sdtv and bktv for both β are circular shaped sample figure for β 10 are shown in figs 10 and 11 the peak ω x momentum deficit and tke are coincident with the peak q expect for sdtv for β 20 the latter shows a crescent shaped region within the vortex which results in a dual peak pattern for q ω x and tke the momentum deficit profile shows a peak above the core and a trough below the core aligned with the vertical z direction suggesting that momentum recovery is faster towards the free surface cfd results show that among all the primary vortices sdtv for β 20 is closest to the air water interface and leaves a scar on the free surface thus the crescent shape pattern could be because of the interaction between the vortex and the free surface as shown in fig 12 sdtv and bktv for β 10 show gaussian distribution for q along the radius and bell shaped distribution for ω x as shown in fig 13 the sdtv radius grows linearly with progression the measurements show that the bktv radius grows exponentially whereas in cfd it remains constant 7 mean and turbulent flow pattern the qualitative flow pattern is discussed using 2d planar plots of axial velocity u turbulent kinetic energy k and axial vorticity ωx sample plots at nominal wake plane x l pp 0 935 are shown in figs 14 16 fig 14 shows the contour of u overlaid by cross plane v w vectors obtained in the experiments experimental data and cfd prediction of ω x and k are compared in figs 15 and 16 respectively note that the values of the variables in the figures are set to best show the flow structures and do not represent the actual limit values of the variables the positive ω x red colored indicate contour clockwise and the negative blue colored clockwise rotations when looking upstream flow pattern for β 0 shows that flow deficit starts to appear on the sonar dome surface at x l pp 0 1 due to the generation of sdv a large deficit region is observed behind the sonar done at x l pp 0 12 due to the generation of fbkv the primary vortices are pushed towards the hull further downstream and they interact with the boundary layer to create a hook shaped deficit profile by x l pp 0 4 the latter is primarily generated by the counter clockwise rotating fbkv which transports low momentum boundary layer fluid outboard of the vortex centre around x l pp 0 8 the vortices encounter adverse pressure gradient due to afterbody curvature which causes the vortices to diffuse and the deficit region to enlarge at the nominal wake plane x l pp 0 935 the hook shape is significantly enlarged such that higher than 20 deficit region i e region where u 80 u c extends throughout the hull width both β 10 and 20 cases show most prominent momentum deficit on the leeward sonar dome surface in the sdtv and bktv cores hook shaped deficit near the centerplane due to lw and ww fbkvs and abkv the deficit on the leeward sonar dome surface due to the presence of separation bubble the deficit region enlarges with increase in β such that the diameter of higher than 20 deficit region for β 10 is 3 times larger than those for β 0 and those for β 20 is 50 larger than those for β 10 the sdtv vortex shows circular deficit region which moves away from the hull and enlarges such that for both β 10 the diameter of higher than 20 deficit region at x l pp 0 8 is two times larger than those at x l pp 0 4 the deficit recovers further downstream due to the interaction with free surface the lw and ww fbkvs result in hook shaped deficit region at the centerplane inclined at 45 towards the leeward side around x l pp 0 4 this deficit region is generated as lw and ww fbkv transport low momentum fluid outboard and inboard of the respective vortex cores respectively the hook shaped deficit region generated by fbkvs enlarges further downstream and it moves outward from the centre plane around x l pp 0 8 the deficit is enhanced due to low momentum transported by bkw or lw bkv around x l pp 0 6 an additional deficit region appears on the windward side due to bktv further downstream this deficit region moves towards the leeward side and results in a hook shaped profile due to interaction with boundary layer bktv deficit region for β 20 is 50 larger than those for β 10 abkv also shows hook shaped deficit region at the centerplane and the deficit region is enhanced with the increase in β for all drift angles tke is generated in the boundary layer both during vortex onset and when vortices interact with the boundary layer for β 10 and 20 high tke is observed in the sdtv core partly because of turbulence generation because of helical instability as discussed in section 6 2 and partly due to low frequency oscillation of vortex core in addition high tke is observed below the wind ward free surface due to wave breaking reynolds stress components along the sdtv core obtained in the experiments for β 10 and predicted by des at selected x l p p 0 12 0 2 0 4 and 0 6 are shown in fig 17 experiments shows that axial stress u u are more dominant at the vortex onset but further downstream both spanwise stress v v and vertical stress w w start to dominate among the shear stresses planar stress v w are most prominent and show clover shaped pattern in the vortex core with positive correlations along positive 45 slope and vice versa for negative 45 slope the shear stress distributions obtained in the experiment for β 20 in fig 18 also shows a similar behavior especially the prominent clover shaped pattern for v w in the vortex core cfd predictions capture the qualitative distribution of the stresses well but the magnitudes are underpredicted and the structures are more diffused results suggest that the tke generation during vortex onset results in primarily u u component along vortex progression v v and w w are dominant over u u further since v v w w and v w are aligned along y z and diagonally respectively this suggests that k core diffuses due to turbulence fluctuations symmetrically in the y z plane tke budget for β 20 predicted by cfd showed that turbulence transported away from the core by the turbulent and pressure transport terms consistent with above observations 8 conclusion and future research towing tank experiments were performed for a surface combatant dtmb model 5512 with bilge keels as it undergoes static drift manoeuvres the measurements included forces and moment using 6 component load cell wave elevations using servo type wave gauges and 3d volume mean and turbulent flow measurements using tpiv data quality was assessed by monitoring statistical convergence and following standard uncertainty procedures the uncertainty in the forces and moment measurements were about 3 5 where the bias error was dominant indicating the data were highly repeatable the wave elevation measurements involved 5 uncertainty mostly due to random uncertainty the tpiv measurements involved uncertainties ranging from 1 to 17 the uncertainties were largest close to the vortex separation region and decreased with the vortex progression on an average the vortex core location measurements showed lowest uncertainty and q measurement showed the largest uncertainty the cfd simulations were performed using grids with 48m 84m cells the grid scale in the vortex core was found to be in the inertial subrange 2 to 4 times larger than the taylor s microscale and 40 95 of the total tke was resolved the predictions of forces and moment wave elevation vortex core location and momentum deficit in the vortex core compared within 6 of the experimental data but the vortex strength was overpredicted by 90 and core tke were underpredicted by 60 cfd predictions were used to fill in the sparse experimental data to understand the effect of drift angle on the mean and turbulent flow features the forces and moment increased with the drift angle the surge force showed a quadratic increase whereas both the sway force and yaw moment showed a cubic increase the wave elevation showed diverging waves on both starboard and port sides the wave envelop angle increased on the port side and decreased on the starboard side with the increase in β however the total wave envelop angle remained almost constant the primary vortical structures were identified to be sonar dome and forebody keel vortices for the straight ahead condition and sonar dome tip and bilge keel tip vortices for the drift conditions the primary vortices for β 0 advected in the hull boundary layer and were elliptic in shape the primary vortices for β 10 and 20 showed helical breakdown after onset and advected away from the hull on leeward side they were circular in shape and planar distribution of their strength showed either gaussian or bell shaped profile the vortex strength increased with β and decreased with progression as vortices diffused however vortex diffusion was not accompanied by momentum recovery in vortex core the momentum deficit was sustained for β 0 due to interaction with boundary layer whereas for β 10 and 20 the deficit increased due to turbulence generation because of helical instability the turbulence generated in the vortex core was transported away from the core symmetrically in the plane normal to the vortex axis the data sets reported herein provide detail description of the mean and turbulent flow pattern for a range of drift angle however the experimental datasets can be further improved future investigations should focus on 1 unsteady analysis to better understand the helical instabilities of the vortices for large drift angles 2 the interaction of the primary vortices with the boundary layer in the afterbody including nominal wake for β 0 is an important aspect of propeller design which is still not fully understood and needs to be further investigated and 3 the tpiv measurements have narrow volume width and low data rate which inhibits accurate measurements near the hull and full understanding of the vortex onset characteristics e g the onset of sdtv is still debatable a time resolved particle tracking velocimetry ptv or 4d ptv measurements allows larger measurement volume and reduces laser specular reflection from the hull allowing measurements near the hull future measurements will be performed using 4d tpv system lastly further analysis is required to understand the vortex decay mechanism for this purpose tke and vorticity budgets will be performed using cfd results for sdv and fbkv vortices for β 0 case also the different variant of des models and turbulence triggers need to be investigated to improve cfd predictions finally the changes in the flow characteristics with drift angle at full scale is important from the applications perspective cfd simulations can provide full scale solutions using wall functions bhushan et al 2009 however the grid resolution requirements in the vortex core is expected to increase significantly future research should investigate extension of the cfd simulations for full scale credit authorship contribution statement shanti bhushan validation software formal analysis visualization writing review editing hyunse yoon validation data curation software formal analysis visualization writing original draft frederick stern conceptualization writing review editing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements office of naval research grants n00014 17 1 2083 and n00014 17 1 2084 under administration of drs thomas fu woei min lin and ki han kim sponsored the iihr research the simulations were performed using dod navy dsrc hpcmp resources appendix i tpiv system and data reduction the tpiv system consists of a dual head nd yag laser a submerged light sheet generator four imager pro sx 5m 2456 2058 pixel ccd cameras and a davis8 software the laser is a cfr400 model by quantel with a 190 mj pulse power with adjustable pulse repetition rate up to 15 hz the highest frame rate of the cameras is 14 2 frames per second fps at the maximum pixel resolution for the present study a 2 2 hardware pixel binning was used to achieve a faster frame rate of 26 fps the optical lenses for cameras are nikkor 50 mm f 1 8d equipped with motors for remote focusing and aperture adjustments the camera bodies are equipped with motors for remote scheimpflug angle adjustments all cameras are arranged in submerged cylindrical enclosures of 90 mm diameter the enclosures are modular type that consists of a mirror section at the bottom end with a glass window a camera section on top of the mirror section and hollow tube sections on top for the clamping to the traverse system silver coated hollow glass sphere particles sh400s33 by potters beads were used as seed material the particles have a mean diameter of 14 μm and an average density of 1 7 g cm3 about 25 g 4 scoops of particles were mixed well with about 25 gallons of water by using a motorized stirrer the mixture was discharged using a water pump and through a perforated horizontal tube of 1 cm diameter and 50 cm length seeding was made along the towing tank centerline at a speed about 0 2 m s about 5 gallons of the mixture was discharged for each seeding run typical average seeding density was about 1000 2000 particles cm3 calibration of the tpiv system was done by using a two tier calibration plate type 204 15 by lavision the plate had a regular pattern of circular marks of 3 2 mm diameter with a 15 mm spacing the depth difference between two tiers was 3 mm the calibration mapping was done first by using the pinhole fit within davis8 the average deviation to marks after fitting was less than one pixel for all cameras a volume self calibration westerweel and scarano 2005 was followed to correct the calibration mapping function for any misalignments by slight movements of the camera while towed underwater the number of sub volumes of 7 7 5 in each axis direction was used for disparity vector computations a typical average size of the disparity vector was about 2 5 pixels from the calibration procedures the size of the fov of the present tpiv setup was determined as 100 mm 100 mm 15 mm in width y height z and depth x the width and the depth of the fov varied case by case and were as large as 114 mm and as small as 12 mm respectively for β 0 measurement although model drift angle setup was done carefully the flow structure on the port and starboard sides were found to be asymmetric due to either minor misalignment of the model with respect to the actual towing direction or the unevenness in the hull geometry during manufacturing a neutral angle test was performed by testing various drift angle around 0 with a small incremental step and the best angle was chosen which showed the most symmetric flow pattern streamlines and vortex core locations near the model centreplane the appropriate neutral angles were found to be β 1 0 5 and 0 for x l p p 0 06 0 2 0 3 0 4 and 0 6 1 0 respectively the tpiv recordings were processed using lavision davis v8 2 software in batch processes using two pc s each with two intel xeon cpu e5 2665 processors running on a 64 bit windows7 operating system the data processing time was approximately 1 1 5 h for a 260 image set the data in the raw images went through the following pre processing steps 1 the local minimum obtained over a 5 5 pixel region was subtracted 2 normalized by local average obtained by smoothing data over 300 pixels local averaging was performed for each image separately and all frames were normalized to the first frame and 3 each pixel value were subtracted by a constant value of 50 and multiplied by a factor of 10 volume reconstructions were done using the multiplicative line of sight mlos algorithm in general more precise volume reconstruction algorithms are recommended such as the multiplicative algebraic reconstruction technique mart or the fast mart algorithm however the mlos algorithm was chosen because the seeding quality in the present study was lower than the optimal seeding density required for higher accuracy algorithms the volume correlations were done using a direct correlation scheme with three steps using a 64 64 64 pixel interrogation window size followed by one step using a 32 32 32 pixel interrogation window size and using two passes for all steps all correlation steps used a 75 percent overlap and a peak search radius of 8 4 2 and 1 voxel from the first to the last step in a sequence the first three steps used volume binning with 8 8 8 4 4 4 then 2 2 2 sizes in sequence whereas no volume binning was used for the last step afterward the vectors were filtered by using a universal outlier detection removal insertion process westerweel and scarano 2005 of davis8 software spurious vectors were not replaced with interpolated values and the blank spots in the measurement area were not filled up typically the percentage of first choice vectors through this process routine was about 95 a custom fortran program was used for an additional vector filtering and data reduction the filtering was done by accepting vectors of which components values were within a predefined range determined based on statistics i 1 μ u v w c σ u v w u v w μ u v w c σ u v w where μ u v w and σ u v w are the mean and standard deviation of u v w within a certain measurement volume and through the measurement time and c is a coverage factor a coverage factor c 3 2 or 4 5 was used for the measurement volumes located close to the hull surface or around the vortex core respectively otherwise c 10 was used these c values correspond to a probability of p u v w μ u v w c σ u v w 90 95 and 99 respectively from tchebycheff s inequality for stationary random data of any type distribution if data are distributed normally a coverage factor c 3 29 corresponds to a 99 9 probability next a threshold number n thld was defined if the number of vectors n at a certain location was less than n thld after this range filtering then n was considered as not large enough for a statistical convergence and the vector set was discarded with the location left as a blank spot for the present study n thld 0 5 n max was used where n max n img n run n img is number of images and n run is number of runs lastly the vector data from each carriage run were first time averaged for each carriage run and then further averaged for the repeat carriage runs all flow variables were non dimensionalized using u c and l p p appendix ii statistical convergence forces and moment were first tested for randomness stationarity and normality testing for randomness was performed by observing the time history of the dataset and inspecting the frequency spectrum via fft for an obvious non stationary or non random data stationarity test was performed by using a non parametric statistical procedure a run test or a trend test data normality is examined by performing a chi square χ 2 goodness of fit test all the tests were performed at a 5 level of significance the details of the methodology are provided in yoon et al 2015a statistical convergence was achieved by repeated carriage runs and convergence error e sc for a variable φ was examined by ii 1 e sc c s φ n φ ref 100 where s φ is the sample standard deviation of φ and n is the sample size for a 95 confidence level c 2 was used when the data follow a normal distribution whereas c 4 5 was used when the type of data distribution was unknown the reference φ ref can be any meaningful value and herein the sample mean φ was used for f x f y and m z c 4 5 was used as the data failed the normality tests and e sc 3 0 5 and 0 2 respectively except for f y and m z for β 0 where the φ values were very small the tpiv velocity variables were assumed stationary random data i e it was assumed that the mean and variance values do not vary with time in addition the data were assumed to follow a normal distribution the statistical convergence error of the time mean velocities was defined by eq ii 1 with c 2 for a 95 confidence level and using the towing speed u c as φ ref if velocities follow a normal distribution then its variance i e reynolds normal stress should is expected to follow a chi square distribution thus the statistical convergence error lower value e sc l and upper value e sc u in a reynolds stresses was defined as ii 2 e sc l 1 n χ n α 2 2 s φ 2 φ ref 2 100 ii 3 e sc u n χ n 1 α 2 2 1 s φ 2 φ ref 2 100 where χ n α 2 2 and χ n 1 α 2 2 are the chi square variable with n n 1 degrees of freedom and α 0 05 for a 95 level of confidence the derivation of eqs ii 2 and ii 3 is provided in yoon et al 2015a the peak turbulent kinetic energy k peak is used as φ ref 2 the statistical convergence analysis for the flow measurements were performed at two points designated as a and b at the nominal wake plane x l pp 0 935 for β 20 case point a was selected at the core of sdtv where the velocity magnitude v u 2 v 2 w 2 0 497 and turbulence k k peak 0 0838 point b was selected away from the vortex core where v 0 987 and k 0 07 k peak the analysis was done for data sets of 250 260 samples collected from single carriage runs for point a the velocity measurements showed e sc 3 u c and reynolds stress measurements showed e sc l 8 12 k peak and e sc u 10 16 k peak the convergence at point b was relatively faster than at point a and showed smaller e s c 0 8 u c for the velocities and an order of magnitude smaller e sc l 0 7 k peak and e sc u 1 0 k peak for the reynolds stresses the stationarity and normality of the datasets were assessed using a non parametric statistical procedure reverse arrangement test and a chi square goodness of fit test respectively for point a the stationarity and normality hypothesis were rejected at the rate of 40 and 60 respectively thus the true errors can be larger than the present estimations appendix iii validation of des and variants for hydrofoil flow separation the predictive capability of blended k ω bkw and spalart allmaras sa spalart and allmaras 1994 based urans ddes and improved ddes iddes models were investigated for flow separation over hydrofoil trailing edge as originally used by shur et al 2008 for the validation of sa based ddes and iddes models the flow domain and boundary condition are shown in fig iii1 a the study used two systematically refined grids consisting of 4 5m and 12 72m cells note that the grid size used herein is significantly larger than the grid with 1 5m cells used by shur et al 2008 this is because the entire hydrofoil is simulated herein whereas shur et al 2008 simulated only the trailing edge section the experimental data for this case blake 1975 includes mean streamwise velocity and streamwise velocity fluctuation profiles at several cross sections in the trailing edge section i e at x h 18 through 20 5 where h is the hydrofoil thickness as shown in fig iii1 b both cfdship iowa urans and des predictions improve significantly with grid refinement and results obtained on the fine grid are presented in fig iii1 through iii3 as shown in fig iii1 c slightly upstream of the hydrofoil trailing edge at x h 18 des underpredicts the streamwise velocity near the wall and overpredicts them away from the wall which results in large flow separation region as shown in fig iii1 d fig iii1 e f demonstrates that lower momentum in the boundary layer was due to early activation of les in the boundary layer which results in underprediction of the turbulent eddy viscosity ddes and iddes both resolve this issue by delaying the les transition this improves the predictions at x h 18 and the separation region was somewhat reduced at x h 20 however the separation region is still large compared to the experiments also note that urans predicts that the flow remains attached even at x h 20 suggesting that urans overpredicts the turbulent stresses resulting in underprediction of the flow separation the instantaneous flow pattern in fig iii3 b shows that ddes predicts mostly organized large scale vortex structures and the flow is devoid of any resolved turbulence even though les is active in the entire hydrofoil region thus the ddes prediction errors are due to modeled stress depletion iddes shows the same limitation an artificial turbulence trigger was applied upstream of the trailing edge to trigger the resolved turbulence which resulted in the generation of 3d coherent structures in the trailing edge as shown in fig iii2 c simulations using bkw based ddes and iddes model showed very similar trends the mean streamwise and tke predictions on the hydrofoil trailing edge cross sections obtained using sa and bkw based urans and iddes results on fine grid are compared against experimental data blake 1975 and shur et al 2008 sa based iddes predictions in fig iii3 results show that both bkw and sa urans underestimate the flow separation region sa predictions show attached flow even up to x h 20 5 and bkw predictions shows onset of separation at this location bkw performs very well for the turbulence predictions except at x h 20 5 sa model does not provide turbulence predictions thus are not shown both bkw and sa based iddes show very similar predictions as in both cases turbulence is 95 resolved the mean velocity profiles compare very well with the experiment and are somewhat over predictive at x h 20 and 20 5 in the same region shur et al 2008 results are somewhat under predictive the turbulence is overpredicted in this region both herein and in shur et al 2008 iddes with turbulence trigger models was also applied for flow over 5415 with bilge keels at β 0 the results showed resolved turbulent structures addressing the low resolved turbulence issue reported by bhushan et al 2014 2019 overall the results demonstrate that artificial turbulence trigger can help alleviate the modeled stress depletion issue in des fig iii 1 a hydrofoil simulations domain and boundary condition b streamwise velocity contour and experimental measurement cross section locations for the hydrofoil case streamwise velocity profile at c section c x h 18 and d section f x h 20 predicted by sa urans des and ddes are compared with experimental data e turbulent eddy viscosity profile and f urans and les length scale ratio at section c ratio of 1 represent rans region ratio close to 0 is pure les region the results are shown for fine 12 72m grids fig iii 1 fig iii 2 instantaneous flow at the trailing edge obtained using sa based urans top b ddes middle and ddes with turbulence trigger bottom vortical structures are shown using isosurface of q 20 and are colored using piezometric pressure the inset figure in b shows the rans and les region in the trailing edge section the red zones are the rans regions and the blue contours are the les region fig iii 2 fig iii 3 comparison of mean streamwise velocity left panel and root mean square rms streamwise turbulent fluctuation right panel predicted by blended k ω and sa urans and iddes models at x h 18 19 19 5 20 and 20 5 on fine 12 72 m grid is compared with experimental data blake 1975 and shur et al 2008 sa iddes results the x h locations have been marked in fig iii1 b fig iii 3 
20216,the present study aims to reveal startup characteristics of a two stage drag type hydrokinetic rotor numerical simulation was performed to capture instantaneous flow characteristics and to develop a relationship between flow and rotor performance the dependence of the rotational speed on hydraulic loads was modeled and solved using the six degree of freedom sdof solver the effect of the load coefficient on startup performance was investigated a comparison between the two stage rotor and a single stage rotor was implemented the results show that the two stage rotor is superior to the single stage rotor in terms of the startup performance during the startup process fluctuations of the angular velocity and the torque coefficient are mitigated with the introduction of the two stage configuration relative to the single stage rotor the two stage rotor starts up with high power coefficient but short startup time at certain azimuthal position the effect of the load coefficient on near rotor flow patterns is insignificant in the wake of the two stage rotor considerably different flow patterns are evidenced adjacent to the upper and the lower sub rotors the wake vortex structures are smooth but underdeveloped keywords drag type hydrokinetic rotor startup performance two stage scheme numerical simulation sdof solver load coefficient nomenclature b g load coefficient c p power coefficient c p ave average power coefficient c t instantaneous torque coefficient c ts static torque coefficient d rotor diameter d e diameter of the end plate e g gap ratio e o overlap ratio h rotor height j moment of inertia re reynolds number r radius of the circular blade segment t dynamic torque t l loading moment t r frictional resistance moment tsr tip speed ratio tsr ave average tip speed ratio t s static torque t w hydraulic moment t time t s startup time u upstream flow velocity y non dimensional wall distance θ azimuthal angle ρ density of water ω angular velocity specific turbulence dissipation rate ω ave average angular velocity 1 introduction the first drag type rotor was invented in 1925 and the motivation was to harness wind energy savonius 1931 in flowing water the kinetic energy can also be extracted and hence converted into useable energy forms through the drag type rotor under this circumstance the rotor is termed the hydrokinetic rotor furthermore the density of water is about 1000 kg m3 which is about 830 times that of air i e wind according to the relationship between the kinetic energy fluid density and flow velocity available kinetic energy in the water flowing with a velocity of 3 0 m s is about 13500 w m2 for wind even it flows at a velocity of 13 0 m s the kinetic energy is only 1324 w m2 kerikous and thévenin 2019 the drag type rotor is featured by simple rotor structure low cost of infrastructure and high torque output which facilitate its application in offshore regions and rivers zhang et al 2019a b drag type turbines are generally less efficient than properly designed lift type turbines because of the principle on which they operate hau 2013 goh et al 2016 with the rotation of the drag type rotor the hydraulic torque on the rotor varies periodically kumar and saini 2016 at some azimuthal angles the torque coefficient is low and even negative which was proved by saha et al 2008 at reynolds number re of about 5 0 105 to compensate for such a shortage deploying assistant device such as the guide deflector the barrier or the curtain plate near the rotor has been exercised wong et al 2017 based on the results obtained by mosbahi et al 2019 the comparisons of the torque and power coefficients between the rotor schemes with and without the guide deflector are illustrated in fig 1 the participation of the deflector is responsible for a remarkable improvement of the rotor performance in a quantitative manner the power coefficient can be improved by as much as 50 compared with that of a solo rotor at re of about 1 3 105 golecha et al 2011 kerikous and thévenin 2019 from the perspective of fluid dynamics the introduction of assistant device alters the flow patterns near the rotor which encourages an investigation of the relationship between flow characteristics and rotor performance alizadeh et al 2020 some early work proposed a two stage scheme in which two savonius wind rotors were offset by an azimuthal angle of 90 modi et al 1983 since the upper and the lower sub rotors are staggered in circumferential direction the fluctuations of torque incurred by one sub rotor are anticipated to be partially counteracted by those related to the other kamoji et al 2008 regarding the wind rotor the multistage structure has attracted great academic attention ahmed et al 2021 menet 2004 as re increased from 1 4 105 to 2 8 105 hayashi et al 2005 studied a single stage and a triple stage wind rotor using a wind tunnel and proved that the triple stage rotor operated without negative torque coefficient saha et al 2008 investigated the multistage rotors equipped separately with helical blades and semi circular blades they concluded that the two stage rotor had the best operation performance irrespective of the blade shape similar results were obtained by mahmoud et al 2012 as re attained as high as 1 8 106 thus far there is no unified opinion about the optimum number of stages frikha et al 2016 theoretically the performance of a multistage rotor can be obtained through superimposing the performance of each sub rotor obtained at respective setting angles the startup performance is critical for the drag type rotor at some setting angles the drag type rotor cannot start up on its own because the frictional moment has surpassed the hydraulic moment zhang et al 2019a b akwa et al 2012 in this case it is impractical to stimulate the rotation of the rotor through an artificial impetus under real circumstances for the h darrieus wind rotor the startup performance depends greatly on geometric attributes of the rotor asr et al 2016 investigations in this aspect are expected to be extended to cover the drag type rotor the startup process is a typical dynamic process which differs significantly from general condition under which the rotor is fixed for evaluating the static performance zhao et al 2020 at re 2 1 105 and 2 7 105 even the incident flow is uniform and steady the starting torque of the rotor varies remarkably with the azimuthal angle modi and fernando 1989 therefore to measure instantaneous torque coefficient or flow patterns the instrument is required to be highly sensitive and accurate another useful tool is the computational fluid dynamics cfd technique which has been used to simulate flows near rotors cfd gives nice pictures of flow patterns but is only an imitation of reality and performance predictions should always be checked with experiment it is noteworthy that a common practice in numerical studies is to specify the rotational speed of the rotor fertahi et al 2018 hence the rotor will rotate at a constant speed such a methodology furnishes a chance to understand the most fundamental characteristics of the rotor regarding the startup process it is featured by constantly varying rotational speed of the rotor which cannot be handled with general methods of imposing an invariant rotational speed on the rotor the present study aims to reveal the startup characteristics of the two stage drag type hydrokinetic rotor numerical simulation was performed to describe transient flow phenomena and to quantify time dependent rotor performance the numerical scheme was validated through experimental results the variation of the rotational speed of the rotor due to external loads was modeled and solved using the six degree of freedom sdof solver embedded in the commercial cfd code ansys fluent effects of the load coefficient on startup performance were investigated a comprehensive comparison between the two stage rotor and a single stage rotor was performed instantaneous flow patterns near the rotors were described and compared as well the conclusions obtained are expected to shed new light on the startup performance of the drag type hydrokinetic rotor 2 methodology 2 1 models of the single stage and the two stage rotors the rotor geometry adopted here was devised based on the comparison between rotors of different geometries documented in kamoji et al 2009 furthermore roy and saha 2015 proved that the rotor blade with a straight middle segment has high power coefficient at re 6 0 104 the maximum power coefficient of the rotor with straight middle segments is 0 27 and the conventional rotor has a power coefficient of 0 21 furthermore at re 1 2 105 the conventional rotor has a maximum power efficient of 0 23 while the rotor with middle straight segment has a maximum power coefficient of 0 31 the single and the two stage rotors designed here have identical cross section which is sketched in fig 2 a the two rotors have the same rotor height h and the same rotor diameter d as schematically shown in fig 2 b and c the end plates help to strengthen the rotor structure major geometric parameters are listed in table 1 the two stage rotor displayed in fig 2 c is composed of two smaller rotors namely upper and lower sub rotors which are offset by an azimuthal angle of 90 there is no shaft intrusion into the gap between the two blades and the two sub rotors rotate synchronously with the three end plates from the flow aspect the gap enables the connection of water flow between upstream and downstream sides of the rotor the gap flow in turn influences the pressure distributions over the blades sheldahl et al 1978 meanwhile the two blades overlap with each other near the inner blade ends mabrouki et al 2014 argued that the maximum power coefficient was attained at an overlap ratio of about 0 3 to quantify the rotor performance several parameters were defined the tip speed ratio tsr denotes the ratio of the maximum linear velocity of the rotor which arises at blade tip to the velocity of upstream flow 1 t s r ω d 2 u where ω denotes the angular velocity of the rotor and u the upstream water velocity the coefficients of static torque c ts dynamic torque c t and power coefficient c p are given separately by 2 c t s 4 t s ρ u 2 h d 2 3 c t 4 t ρ u 2 h d 2 4 c p 2 ω t ρ h d u 3 t s r c t where t s and t represent the static torque and the dynamic torque respectively 2 2 numerical setup 2 2 1 governing equations and turbulence model the commercial cfd code ansys fluent served as a basic platform for the numerical work pure water of 20 c with the density of 998 2 kg m3 and the dynamic viscosity of 1 0 10 3 m2 s was selected as the working medium in consideration of the magnitude of the flow velocity the flows considered here were assumed incompressible and dominated by the reynolds averaged navier stokes rans equations the piso pressure implicit with splitting of operators algorithm was adopted to address the coupling between static pressure and velocity the algorithm can effectively reduce the difficulty of convergence caused by computational grids meanwhile the second order upwind scheme was selected to discretize the convective terms in the governing equations the shear stress transport sst k ω turbulence model was employed to accomplish the closure of the governing equations here k represents the turbulence kinetic energy and ω the specific turbulence dissipation rate the sst k ω turbulence model proves suitable for treating flows around curved and rotating blades zhang et al 2019a b placide et al 2013 all simulations were performed through parallel processing and the convergence criterion was set to 1 10 6 for all monitored variables namely velocity components k ω and the mass balance between the inlet and outlet of the whole computational domain 2 2 2 computational domain and boundary conditions the computational domain for the two stage rotor is schematically shown in fig 3 the domain consists of a rotational subdomain an outer domain and the remaining domain that encloses the other two domains the inlet and the outlet of the whole domain are respectively extended 5d and 10d from the rotor axis the front and back surfaces are 5d away from the rotor axis the top and bottom surfaces are 5d away from the middle end plate the computational domain was sufficiently spacious to avoid the disturbance of boundaries to the flows near the rotor meanwhile the inflow faced by the rotor was fully developed and the wake phenomena could be captured for adjacent subdomains interfaces were defined to ensure reliable data exchange and the conservation of mass and momentum uniform and steady inflow was set at the inlet of the whole computational domain the velocity was set to 2 0 m s and the turbulence intensity 5 the corresponding reynolds number was 4 8 105 the pressure outlet boundary condition was set at the outlet of the computational domain the backflow pressure was set as the total pressure to promote the discharge of flow from the domain instead of inflow at the four lateral surfaces of the computational domain symmetry boundary conditions were set and thereby the computational domain can be deemed as infinitely large in lateral directions no slip boundary conditions were specified on the surface of the rotor blades and the surface roughness was set to 0 05 mm 2 2 3 grid generation and grid independence examination a combination of structured and unstructured grids was adopted here in consideration of small truncation errors and easy convergence unstructured grids were applied in the rotational and the outer domains and structured grids in the remaining subdomain the commercial grid generation code icem cfd was used to discretize the computational domain the maximum skewness angle was less than 40 the thickness of the first layer adjacent to blade surface was set to 0 035 mm totally 10 layers of near wall grids were set with a growth ratio of 1 2 grids were refined near the rotor with the sst k ω turbulence model grid refinement is more appropriate than employing near wall functions to treat near wall flows meanwhile the sst k ω turbulence model is an improved model and allows the solving of near wall viscous flows through grid refinement zhang et al 2019a b placide et al 2013 therefore the grids near the blade surface were refined to obtain proper values of y sharma and sharma 2016 the maximum y attainable is less than 5 0 satisfying the requirement of the sst k ω turbulence model the rotation of the rotor was enabled using the sliding mesh technique which has been successfully used in impeller machinery roy and saha 2013 kang et al 2014 for the two stage rotor unsteady simulations were performed based on five grid schemes the total grid numbers range from about 2 5 million to 8 9 million as listed in table 2 during the simulation the effect of time step was inspected as well the time step decreased from 0 004 s to 0 001 s the average power coefficient c p ave was obtained over a whole rotation cycle as a stable operational state was reached the results are listed in table 2 it indicates that for cases 3 4 and 5 the relative difference of c p ave between any pair is less than 3 therefore the grid scheme associated with case 3 was selected for subsequent simulations for this grid scheme a cross sectional view of the grids near the upper sub rotor is displayed in fig 4 for the grid scheme finally adopted for the single stage rotor the total grid number is 4 072 816 2 2 4 calculation of the angular velocity during the startup process literally the hydraulic force imposed on the rotor varies with the orientation of the rotor and the rotational speed of the rotor alters accordingly during the startup process the rotational speed may vary without periodicity according to newton s second law of motion the rotational speed of the rotor depends on the moment of inertia j the hydraulic moment t w the frictional resistance moment t r and the moment of external load t l liu et al 2019 here the drag type hydrokinetic rotor is assumed to be a rigid body and rotates only with respect to its central axis the governing equation for the rotation of the rotor takes the following form 5 j d ω d t t w t r t l the integral of eq 5 yields 6 ω t w t r t l j d t the moment of inertia depends on rotor structure and material as well as the connection between the rotor and the adjacent module here the moment of inertia was set to 0 143 kg m2 which was determined based on the geometry and the material density of the rotor during each time step the integral of the static pressure over the rotor blade surface yields the hydraulic moment t w since the frictional resistance moment influences insignificantly the rotation of the rotor it was neglected in the present study based on the relationship between the loading moment and the angular velocity t l is given by wang and yeung 2016 7 t l b g ω where b g denotes the load coefficient then the output power of the rotor p is given by 8 p t l ω b g ω 2 a solver of six degree of freedom sdof is embedded in ansys fluent and can be used to calculate external forces such as hydraulic and gravitational forces and the moments on a rigid body le et al 2014 such a technique has been practiced in addressing the flow driven rotation of the darrieus wind rotor liu et al 2019 the fluid structure interaction was handled via solving eqs 5 and 6 the hydraulic moment was calculated through integrating the static pressure and the shear stress over the surface of rotor blades then the angular velocity ω can be calculated furthermore the variation of the angular displacement yields new boundary conditions which will be implemented through the sliding mesh technique and used to update the hydraulic moment 3 validation of the numerical scheme 3 1 experimental setup to validate the numerical scheme devised an experimental work was performed since no experimental model parallel with the drag type rotors shown in fig 2 was available another rotor was selected in the experiment as shown in fig 5 a corresponding numerical work was performed using the numerical scheme detailed in sec 2 2 a closed loop in which pure water was circulated served as the basic platform for the experimental work the horizontally installed test section measuring 1200 mm 390 mm 390 mm was equipped with four plexiglass sidewalls the experimental results indicated that at an upstream flow velocity of 1 34 m s corresponding to re 3 2 105 the turbulent intensity in the test section varied between 1 74 and 2 65 instantaneous flows near the rotor were measured using a lavision tr piv time resolved particle image velocimetry system the experimental system is schematically shown in fig 5 a the rotor was made of plexiglass so that laser could penetrate through the rotor and the whole flow surrounding the rotor was thereby detectable the deflector plate was deployed upstream of the rotor to improve the performance of the rotor more specifically the deflector plate prevents the upstream flow from impacting the returning blade meanwhile it can guide the upstream flow towards the concave side of the advancing blade the combination of the rotor the deflector and the lateral walls mimics the practical operation of a hydrokinetic rotor in a duct therefore the blockage effect was not considered here since the deflector is not transparent mirrors were used to reflect light and the flows at both sides of the deflector were illuminated an image of the experimental rig is displayed in fig 5 b the rotor shaft was supported by a pair of angular contact ball bearings the horizontal distance between the shaft axis and the inlet of the test section is 500 mm an integrated measurement module was mounted at the upper end of the rotor shaft to measure both the torque and the rotational speed of the shaft the uncertainty of the measurement module relative to the acquired value is 1 which was obtained through a calibration experiment the sampling frequency is 100 hz based on the data acquired the operational performance of the rotor could be calculated as the rotation of the rotor arrived at a stable stage the external load on the rotor was adjusted through an electromagnetic brake the sampling frequency of the tr piv system was set to 1000 hz and 1000 sets of images were captured for each operational condition hollow glass beads with a mean diameter of 20 μm were used as seeding particles to trace the motion of the water flow a photron fastcam ux100 high speed cmos camera was used to record tracing particles in the flow with the maximum resolution of 1280 1024 pixels the image acquisition was assisted by a nikon af nikkor 50 mm f 1 4d lens a dm30 high frequency pulsed laser with the maximum energy of 70 mj was employed to generate a thin light sheet the emitting of the laser sheet was synchronized with the exposure of the cmos camera through davis control software which was embedded in the control module of the tr piv system the laser sheet is perpendicular to the rotor shaft and overlaps with a symmetry plane of the test section several mirrors were deployed at the side oppose to the laser emitter to illuminate the regions where the laser could not reach directly due to the limitation of the space beneath the test section another mirror was used to reflect the image of the laser illuminated zone to the camera as seen in fig 5 b the cross correlation algorithm was adopted to process the data obtained in interrogation windows measuring 32 32 pixels and with an overlap of 75 the maximum vector resolution was approximately 1 9 mm the time interval between two consecutive laser pulses was geared to ensure that the particle displacement exceeded the particle diameter but was less than 1 4 of the width of the interrogation window the uncertainty of the velocity measurement was largely related to the velocity magnitudes selected in consideration of the velocity magnitudes adopted in the present experiment the uncertainty of the tr piv system was approximately 0 1 which was determined according to the specifications of the tr piv system other uncertainties were caused primarily by properties of seeding particles the circulation loop and the rotor these uncertainties were controlled in the experiment the overall uncertainty of the velocity measurement was less than 2 0 3 2 comparison of numerical and experimental results under the operating condition without external load velocity distributions at θ 0 and an upstream water velocity of 1 34 m s obtained numerically and experimentally are shown in fig 6 with such a configuration of the rotor and the deflector enough space is left between the rotor and the deflector for water to pass through therefore immediately downstream of the deflector a large vortex is formed which is shared by the numerical and experimental results meanwhile due to the relative position between the rotor and upstream water flow a vortex is confined near the concave side of the returning blade similarity of overall flow pattern between the numerical and experimental results is clearly manifested certainly some practical factors that disturb the flow could not be modeled in numerical setup during the experiment the external load t l was adjusted through the electromagnetic brake and the rotational speed was measured by the tachometer then the output power could be calculated via eq 8 the external loads obtained in the experiment were used as initial conditions for the numerical simulation consequently the angular velocity was calculated using the sdof solver which operated in combination with the implementation of the sliding mesh technique and user defined functions meanwhile the output power was obtained numerically a comparison of the angular velocity of the rotor and the power coefficient between numerical and experimental results is illustrated in fig 7 it is noteworthy that the numerical results c p ave and ω ave are averaged values in a whole rotation cycle as the operation of the rotor attains a stable state meanwhile the experimental results are also time averaged values which were calculated based on the data acquired using the measurement module shown in fig 5 regarding the variation of the angular velocity with the external loads both the two curves plotted in fig 7 drop continuously as t l increases the tendency is explicit and high external loads retard the rotation of the rotor the numerically obtained results are consistently higher than the experimental counterparts furthermore the maximum relative deviation between the two curves is 5 1 which arises at t l 0 381 this is reasonable since practical factors that influence the rotation of the rotor could not be completely considered in numerical setup a direct comparison of the rotational speed between experimental and numerical results is accomplishable only as the angular velocity has been accurately measured in asr et al 2016 the tip speed ratio was compared between the experimental and numerical results and the maximum relative deviation exceeded 10 for the power coefficient the two curves shown in fig 7 are analogous as well they follow the same variation tendency which manifests a single peak at t l 0 414 the numerical results are relatively high as is similar with the comparison of ω avg the relative deviation between the two curves attains 9 2 the power coefficient depends on several quantities a relative difference of 10 between the numerically and experimentally obtained torque coefficients is reasonable kothe et al 2020 placide et al 2013 based on the comparisons illustrated in figs 6 and 7 high validity of the devised numerical scheme is proved subsequently the numerical scheme is applied to investigate the performance of the two rotors considered 4 results and discussion 4 1 general performance of the single stage rotor for the single stage rotor the average power coefficient is plotted in fig 8 as a function of tsr it is seen that the highest power coefficient emerges at tsr 0 54 and the corresponding power coefficient is 0 28 furthermore the curve is characterized by a protruding peak indicating a significant effect of tsr on the power output of the rotor in khan et al 2009 a two stage rotor with a height of 0 40 m and diameter of 0 22 m was tested at re 2 2 105 similar variation trend of c p was obtained but the optimum tsr is approximately 0 8 such a difference is related to both re and rotor geometry at tsr 0 54 instantaneous torque coefficients are plotted in a polar coordinate system as shown in fig 9 due to the symmetrical arrangement of the two blades instantaneous torques are symmetrical with respect to the rotation center alom et al 2018 were concerned with the forces imposed on the rotor blades they pointed out that at some azimuthal angles the hydraulic torques over the two blades counteract with each other in consideration of the physical properties of the drag type rotor the drag force contributes more significantly to the rotation of the rotor however at some ranges of azimuthal angles the force perpendicular to the drag force which is sometimes deemed as a lift force kumar et al 2016 exceeds the drag force in driving the rotation of the rotor which was proved in modi and fernando 1988 the distribution of instantaneous torque coefficient over the whole rotation cycle is evidently non uniform as indicated in fig 9 it is noteworthy that negative torque coefficient arises at some azimuthal angles which is ascribed to the competition between the drive and the resistance for the rotation of the rotor however these negative torque coefficients have not led to halt or counter rotation of the rotor during the startup process it is conjectured that negative torque coefficient may also be encountered whether the startup will thereby fail remains to be investigated the flow patterns near the rotor depend closely on the relative orientation of the rotor and upstream flow for the single stage rotor at tsr 0 54 the mid span section was selected to illustrate instantaneous cross sectional distributions of static pressure and streamlines three typical azimuthal angles are selected and the results are shown in fig 10 at θ 0 two vortices with high intensity are salient in the wake of the rotor as shown in fig 10 a meanwhile high pressure is predominant near the concave side of the advancing blade at this position the torque coefficient is relatively high as shown in fig 9 in fig 10 b the upstream flow directly impacts the convex side of the returning blade leading to high stagnation pressure over the rotor blade this undermines the counterclockwise rotation of the rotor two large scale vortices are seen in the wake of the rotor it indicates that the positions of the vortex cores vary with the azimuthal angle at θ 120 the flow pattern is featured by multiple vortices as shown in fig 10 c the vortex scales are small relative to those indicated in fig 10 a and b meanwhile the vortices approach the rotor blades the gap between the two blades is filled with a clear vortex which is common at θ 0 and 120 it is appreciable that water is trapped in the gap which imposes a significant effect on pressure distributions over the blades at θ 60 the vortex in the gap cannot take shape in this case the relative orientation between the rotor and upstream water flow leads to high pressure gradients in the gap as indicated in fig 10 b 4 2 static torque coefficient of the single stage and the two stage rotors as a rotor starts to rotate from an initially stationary state whether the startup succeeds or fails depends largely on the static torque which is used to overcome the friction resistance and the inertia of the system jing et al 2019 at the initial positions with low static torque failed startup of the rotor is possible nasef et al 2013 as the initial static torque is negative the rotor will rotate reversely and eventually halt at some position zhao et al 2020 the static torque coefficient has been extensively studied as an important indicator of the static performance of the rotor salleh et al 2019 fertahi et al 2018 joe and dhiman 2019 here the static torque performance of the two rotors was obtained prior to the discussion of the startup performance variations of the static torque coefficient c ts are plotted in fig 11 as a function of the azimuthal angle the azimuthal angle of the upper sub rotor is selected to denote the orientation of the two stage rotor it is evidenced that the two curves are not smooth which is related to the geometry of the rotor blades regarding the two stage rotor the torque coefficient varies with low amplitudes as θ varies and the average static torque coefficient is lower than that of the single stage rotor meanwhile the variation period of c ts of the two stage rotor is 90 which is half that of the single stage rotor as indicated in fig 11 the minimum torque coefficient of the single stage rotor is approximately 0 15 which is higher than that recorded in sengupta et al 2016 but is lower than the two stage rotor as shown in fig 11 subsequently the position of θ 0 which corresponds to the minimum static torque coefficient and is associated with the highest risk of startup failure was selected as the initial position for startup of the two rotors 4 3 startup of the single stage and the two stage rotors 4 3 1 time dependent angular velocity and torque coefficient of the single stage rotor the startup processes of the single stage rotor were simulated at different load coefficients and an initial position of θ 0 based on the numerical results obtained two critical operational parameters the angular velocity and the torque coefficient of the rotor were extracted the angular velocity is plotted as a function of time t in fig 12 six characteristic points namely ω p 1 ω v 1 ω p 2 ω v 2 ω p 3 and ω v 3 which represent respectively the first peak and the first valley of the angular velocity at b g 0 0 0 5 and 1 0 are marked in the amplified plot major information of these characteristic points is listed in table 3 as external loads are absent namely b g 0 0 the rotor is accelerated first and then approaches the state featured by the runaway speed during such a period several rounds of fluctuations of the angular velocity are experienced subsequently ω varies orderly around the average value under this operational condition the kinetic energy of water supports exclusively the rotation of the rotor and no torque can be extracted it is indicated that ω reaches equilibrium fast as b g increases essentially the variation of ω in such a state conforms to the practical situation while assuming a constant angular velocity for the rotor is apparently improper furthermore it is observed that the fluctuation amplitude of ω increases with the load coefficient however the average angular velocity decreases with increasing load coefficient it is thereby demonstrated that high loads hinder the rotation of the rotor variations of the torque coefficient during the startup process of the single stage rotor are plotted in fig 13 the cases associated with the four load coefficients are presented similarly six characteristic points namely c t p 1 c t v 1 c t p 2 c t v 2 c t p 3 and c t v 3 which represent the first peak and the first valley of the torque coefficient at b g 0 0 0 5 and 1 0 respectively are indicated the information of these points is shown in table 4 at b g 0 0 the torque varies drastically but the average torque coefficient is zero as b g increases the fluctuations of the torque coefficient are alleviated but the average torque coefficient increases continuously the evolution of the torque coefficient experiences an irregularly and then a periodically varying stage as is shared by the four cases shown in fig 13 this signifies the dynamic essence of the startup process and is compatible with the variation of the angular velocity 4 3 2 startup performance of the two stage rotor for the two stage rotor instantaneous angular velocity and torque coefficient of the two stage rotor during the startup process are plotted in fig 14 it is seen that the fluctuations of ω are considerably inhibited relative to those shown in fig 12 for each case the rotor is smoothly accelerated to a stable stage and then the variation of ω manifests slightly wavy patterns moreover as b g increases the angular velocity involved in the stage of stable operation decreases continuously as shown in fig 14 a which is analogous with the situation associated with the single stage rotor a comparison of figs 14 b and 13 demonstrates that the fluctuations of the torque coefficient are mitigated with the introduction of the two stage configuration the conclusion is in accordance with the results related to wind rotors of different stages obtained by kamoji et al 2008 here at each load coefficient as the rotation of the two stage rotor arrives at a stable stage the torque coefficient varies periodically and the average torque coefficient is close to that of the single stage rotor shown in fig 13 furthermore since the fluctuation of c t incurs energy loss the two stage rotor is better than the single stage one in terms of the energy conversion efficiency 4 3 3 startup time and average power coefficient the startup time t s is defined as the time required by the rotor to rotate for a whole revolution from the initial position a comparison of the startup time between the single stage and the two stage rotors is illustrated in fig 15 it is seen that the two values of startup time are close to each other under the condition without load namely b g 0 0 as b g increases the advantages of the two stage rotor over the single stage rotor are evidenced consistently at b g 1 5 the startup time of the two stage rotor is shorter than that of the single stage rotor by about 12 9 during the startup process both the power coefficient and the tip speed ratio vary with the angular velocity and the torque on the rotor tsr is of practical significance for optimizing the rotor blades to capture more energy from flowing water and properly matching the rotor to a generator the power output capability is a significant indicator of the startup performance comparisons of the average power coefficient c p ave and the tip speed ratio tsr ave which were calculated through averaging instantaneous power coefficients and tip speed ratios within t s are shown in fig 16 it is clearly evident that the power coefficient of the single stage rotor is lower than that of the two stage rotor at each load coefficient the largest deviation arises at b g 1 0 meanwhile at each load coefficient the tip speed ratio of the two stage rotor is higher as well essentially during the startup process the fluctuation of the angular velocity causes not just energy loss but also the decrease of the average angular velocity according to eqs 4 and 8 the power coefficient is proportional to the square of the angular velocity therefore c p ave of the single stage rotor is considerably lower than that of the two stage rotor which is proved in fig 16 as well in kothe et al 2020 it was indicated that the rotor with helical blades had a power coefficient higher than that of the two stage rotor which was attributed to the stabilization effect of helical blades on the rotation of the rotor furthermore provided that the angular velocity of the rotor is assumed constant which has been generally exercised the rotor performance will be overestimated 4 4 flow patterns during the startup process 4 4 1 instantaneous flow structures near the single stage rotor to relate flow characteristics with rotor performance cross sectional distributions of static pressure and streamlines corresponding to the six characteristic points marked in fig 12 are illustrated in fig 17 the rotor rotates in counterclockwise direction in fig 17 a a positive action of water flow on the advancing blade is conceivable however a large high pressure zone is concurrently faced by the returning blade at this moment the angular velocity of the rotor arrives at its maximum in fig 17 b the angular velocity reaches its first valley at such an azimuthal position the returning blade suffers from high resistance from upstream flow the downstream side of the rotor is attached with backflows and counterclockwise rotating vortices although it is difficult to quantify the hydraulic forces imposed on each element of the blade surface it is appreciable that the rotation of the rotor is impeded to a large extent as b g increases the positions where the first peak of angular velocity is reached remain nearly the same as indicated in fig 17 a c and e it is interesting that the rotor orientation at which the first peak of the angular velocity arises is insensitive to the load coefficient similarly as the first valley of the angular velocity appears the azimuthal positions are identical in fig 17 b d and f as well from the perspective of flow structure the rotor is adjacent to large scale vortices in fig 17 as the first peak of angular velocity is reached as shown in fig 17 a c and e the scales of the wake vortex are even larger than the radius of the rotor in comparison corresponding to the first valley of the angular velocity the wake immediately downstream of the rotor is dominated by multiple large scale vortices with diverse profiles meanwhile the vortex in the gap is stretched in fig 17 b d and f which depends on the relative orientation between the rotor and adjacent flows flow patterns corresponding to the six points marked in fig 13 are shown in fig 18 in fig 18 a c and e the torque coefficient of the rotor arrives at its first maximum at each load coefficient the three near rotor flow patterns are similar high pressure near the concave side of the blade provides impetus to the acceleration of the rotor a large portion of the concave side of the advancing blade is covered by high pressure while the other side is neighbored by low pressure consequently high hydraulic torque is produced in fig 18 b d and f the first valley of c t is produced similarly the three flow patterns have no significant difference it is seen that the pressure at the concave side of the advancing blade increases with b g meanwhile in view of the large area of high pressure immediately upstream of the returning blade high resistance to counterclockwise rotation of the rotor is conceivable therefore such an azimuthal position is responsible for low torque coefficient 4 4 2 flow patterns near the two stage rotor during the startup process overall difference between the two and the single stage rotors can be recognized through the comparison between figs 12 14 essentially explicit relationships have been evidenced between ω and t a further interest lies in the flow patterns near the two stage rotor to facilitate the comparison between the two rotors the azimuthal positions at which the orientation of the upper sub rotor is the same with that of the single stage rotor are selected at b g 0 0 and 1 0 the cross sectional flow patterns near the two stage rotor are shown in fig 19 and corresponding startup time is presented as well the two cross sections of the computational domain overlap separately with the mid span cross sections of the two sub rotors the time required by the two stage rotor to arrive at the azimuthal position indicated in fig 19 a is 0 240 s which is shorter than that for the single stage rotor to reach the same position namely point ω p 1 marked in fig 12 for the single stage rotor as shown in fig 17 a the vortices shedding from the rotor deviate remarkably from the rotor relative to that associated with the upper sub rotor particularly the vortex originating from the concave side of the advancing blade has evolved into a distinctly large vortex in fig 17 a while in fig 19 a a small vortex is still confined near the hub end of the returning blade for the two stage rotor the upper and the lower sub rotors are surrounded by considerably different pressure distributions in fig 19 b the upper sub rotor is positioned with the same setting angle as that of the single stage rotor shown in fig 17 b the time required by the former is shorter at such a rotor position θ deviates slightly from 0 and the returning blade resists the upstream flow and high pressure is directly faced by the convex side of the returning blade meanwhile a large scale vortex is observed above the advancing blade compared with that shown in fig 17 b the large vortex above the upper sub rotor approaches the rotor and is apparently unexpanded regarding the lower sub rotor it is surrounded by rather smooth water flows the wake vortex deviates considerably from the sub rotor and thereby its effect on the sub rotor is insignificant based on fig 19 a and b it is perceivable that the upper and the lower sub rotors cannot simultaneously reach the state at which the highest torque coefficient is attained for both the two sub rotors at b g 1 0 the upper sub rotor is positioned according to those indicated in fig 17 e and f as seen in fig 19 c and d the two stage rotor rotates faster than the single stage rotor which is in accordance with the tendency illustrated at b g 0 0 meanwhile in fig 19 as b g increases the flow pattern near the upper sub rotor varies which is ascribed to the slight change in the rotor position for the comparison between figs 19 and 17 since the rotor positions are identical at each load coefficient the difference of flow patterns depends significantly on the instantaneous angular velocity of the rotor a general trend in fig 19 is that the vortices near the upper or the lower sub rotor arise from the blade tip which differs from that shown in fig 17 where the blade is attached consistently by one or multiple vortices near rotor flow patterns as the upper sub rotor arrives at the positions consistent with those indicated in fig 18 are shown in fig 20 similarly a shorter time is required for the two stage rotor to arrive at the same angular position in fig 20 a the torque coefficient of the two stage rotor has not reached its first peak as indicated in fig 14 furthermore there is no wake vortex downstream of the upper sub rotor which differs considerably from that related to the single stage rotor at t 0 273 s corresponding to fig 20 b the valley of the torque coefficient has not been reached as indicated in fig 14 the imparity of wake vortex profiles between figs 20 b and 18 b is apparent for the lower sub rotor shown in fig 20 a and b the wake flow contains large scale vortices but the vortex geometries are different at b g 1 0 similar tendencies are demonstrated the two sub rotors can complement each other in other words as one sub rotor operates in a disadvantageous position the other rotor can provide impetus to the rotation of the whole rotor relative to the single stage rotor the two stage rotor is accompanied with large scale wake vortices and smoothed flow patterns consequently fluctuations of both the angular velocity and torque coefficient are alleviated furthermore as the azimuthal position is certain the near rotor flow pattern varies insignificantly with the load coefficient 5 conclusions the startup performance of the two stage drag type hydrokinetic rotor was investigated numerically the flow driven rotation of the rotor was addressed through the sdof solver which differed significantly from general practice of predefining a constant rotational speed for the rotor a comparison between the two stage rotor and a single stage rotor was performed major conclusions drawn from the study are as follows 1 the wake flow of the two stage and the single stage rotors is featured by large scale vortices which vary in vortex number and profile with the relative orientation between the rotor and upstream flow for the two stage rotor the upper and the lower sub rotors are neighbored by significantly different flow patterns 2 during the startup process the two stage rotor is responsible for smooth variations of the torque coefficient and the angular velocity in comparison the single stage rotor manifests drastic fluctuations of the two quantities the startup time of the two stage rotor is shorter than that of the single stage rotor 3 with increasing load coefficient the angular velocity averaged within the startup process decreases continuously relative to the single stage rotor the two stage rotor has higher average tip speed ratio and average power coefficient irrespective of the variation of the load coefficient 4 instantaneous flow patterns near the two stage rotor are divided into upper and lower parts which correspond separately to the upper and the lower sub rotors at the same azimuthal angle relative to those associated with the single stage rotor the wake vortices downstream of the two stage rotor are underdeveloped credit authorship contribution statement can kang conceptualization methodology project administration hexiang zhao investigation data curation writing original draft bing li resources validation software weifeng gong formal analysis visualization validation yang zhu investigation data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors are grateful for the financial support from the project funded by the priority academic program development of jiangsu higher education institutions papd the authors thank the computation center of jiangsu university for providing the computer clusters 
20216,the present study aims to reveal startup characteristics of a two stage drag type hydrokinetic rotor numerical simulation was performed to capture instantaneous flow characteristics and to develop a relationship between flow and rotor performance the dependence of the rotational speed on hydraulic loads was modeled and solved using the six degree of freedom sdof solver the effect of the load coefficient on startup performance was investigated a comparison between the two stage rotor and a single stage rotor was implemented the results show that the two stage rotor is superior to the single stage rotor in terms of the startup performance during the startup process fluctuations of the angular velocity and the torque coefficient are mitigated with the introduction of the two stage configuration relative to the single stage rotor the two stage rotor starts up with high power coefficient but short startup time at certain azimuthal position the effect of the load coefficient on near rotor flow patterns is insignificant in the wake of the two stage rotor considerably different flow patterns are evidenced adjacent to the upper and the lower sub rotors the wake vortex structures are smooth but underdeveloped keywords drag type hydrokinetic rotor startup performance two stage scheme numerical simulation sdof solver load coefficient nomenclature b g load coefficient c p power coefficient c p ave average power coefficient c t instantaneous torque coefficient c ts static torque coefficient d rotor diameter d e diameter of the end plate e g gap ratio e o overlap ratio h rotor height j moment of inertia re reynolds number r radius of the circular blade segment t dynamic torque t l loading moment t r frictional resistance moment tsr tip speed ratio tsr ave average tip speed ratio t s static torque t w hydraulic moment t time t s startup time u upstream flow velocity y non dimensional wall distance θ azimuthal angle ρ density of water ω angular velocity specific turbulence dissipation rate ω ave average angular velocity 1 introduction the first drag type rotor was invented in 1925 and the motivation was to harness wind energy savonius 1931 in flowing water the kinetic energy can also be extracted and hence converted into useable energy forms through the drag type rotor under this circumstance the rotor is termed the hydrokinetic rotor furthermore the density of water is about 1000 kg m3 which is about 830 times that of air i e wind according to the relationship between the kinetic energy fluid density and flow velocity available kinetic energy in the water flowing with a velocity of 3 0 m s is about 13500 w m2 for wind even it flows at a velocity of 13 0 m s the kinetic energy is only 1324 w m2 kerikous and thévenin 2019 the drag type rotor is featured by simple rotor structure low cost of infrastructure and high torque output which facilitate its application in offshore regions and rivers zhang et al 2019a b drag type turbines are generally less efficient than properly designed lift type turbines because of the principle on which they operate hau 2013 goh et al 2016 with the rotation of the drag type rotor the hydraulic torque on the rotor varies periodically kumar and saini 2016 at some azimuthal angles the torque coefficient is low and even negative which was proved by saha et al 2008 at reynolds number re of about 5 0 105 to compensate for such a shortage deploying assistant device such as the guide deflector the barrier or the curtain plate near the rotor has been exercised wong et al 2017 based on the results obtained by mosbahi et al 2019 the comparisons of the torque and power coefficients between the rotor schemes with and without the guide deflector are illustrated in fig 1 the participation of the deflector is responsible for a remarkable improvement of the rotor performance in a quantitative manner the power coefficient can be improved by as much as 50 compared with that of a solo rotor at re of about 1 3 105 golecha et al 2011 kerikous and thévenin 2019 from the perspective of fluid dynamics the introduction of assistant device alters the flow patterns near the rotor which encourages an investigation of the relationship between flow characteristics and rotor performance alizadeh et al 2020 some early work proposed a two stage scheme in which two savonius wind rotors were offset by an azimuthal angle of 90 modi et al 1983 since the upper and the lower sub rotors are staggered in circumferential direction the fluctuations of torque incurred by one sub rotor are anticipated to be partially counteracted by those related to the other kamoji et al 2008 regarding the wind rotor the multistage structure has attracted great academic attention ahmed et al 2021 menet 2004 as re increased from 1 4 105 to 2 8 105 hayashi et al 2005 studied a single stage and a triple stage wind rotor using a wind tunnel and proved that the triple stage rotor operated without negative torque coefficient saha et al 2008 investigated the multistage rotors equipped separately with helical blades and semi circular blades they concluded that the two stage rotor had the best operation performance irrespective of the blade shape similar results were obtained by mahmoud et al 2012 as re attained as high as 1 8 106 thus far there is no unified opinion about the optimum number of stages frikha et al 2016 theoretically the performance of a multistage rotor can be obtained through superimposing the performance of each sub rotor obtained at respective setting angles the startup performance is critical for the drag type rotor at some setting angles the drag type rotor cannot start up on its own because the frictional moment has surpassed the hydraulic moment zhang et al 2019a b akwa et al 2012 in this case it is impractical to stimulate the rotation of the rotor through an artificial impetus under real circumstances for the h darrieus wind rotor the startup performance depends greatly on geometric attributes of the rotor asr et al 2016 investigations in this aspect are expected to be extended to cover the drag type rotor the startup process is a typical dynamic process which differs significantly from general condition under which the rotor is fixed for evaluating the static performance zhao et al 2020 at re 2 1 105 and 2 7 105 even the incident flow is uniform and steady the starting torque of the rotor varies remarkably with the azimuthal angle modi and fernando 1989 therefore to measure instantaneous torque coefficient or flow patterns the instrument is required to be highly sensitive and accurate another useful tool is the computational fluid dynamics cfd technique which has been used to simulate flows near rotors cfd gives nice pictures of flow patterns but is only an imitation of reality and performance predictions should always be checked with experiment it is noteworthy that a common practice in numerical studies is to specify the rotational speed of the rotor fertahi et al 2018 hence the rotor will rotate at a constant speed such a methodology furnishes a chance to understand the most fundamental characteristics of the rotor regarding the startup process it is featured by constantly varying rotational speed of the rotor which cannot be handled with general methods of imposing an invariant rotational speed on the rotor the present study aims to reveal the startup characteristics of the two stage drag type hydrokinetic rotor numerical simulation was performed to describe transient flow phenomena and to quantify time dependent rotor performance the numerical scheme was validated through experimental results the variation of the rotational speed of the rotor due to external loads was modeled and solved using the six degree of freedom sdof solver embedded in the commercial cfd code ansys fluent effects of the load coefficient on startup performance were investigated a comprehensive comparison between the two stage rotor and a single stage rotor was performed instantaneous flow patterns near the rotors were described and compared as well the conclusions obtained are expected to shed new light on the startup performance of the drag type hydrokinetic rotor 2 methodology 2 1 models of the single stage and the two stage rotors the rotor geometry adopted here was devised based on the comparison between rotors of different geometries documented in kamoji et al 2009 furthermore roy and saha 2015 proved that the rotor blade with a straight middle segment has high power coefficient at re 6 0 104 the maximum power coefficient of the rotor with straight middle segments is 0 27 and the conventional rotor has a power coefficient of 0 21 furthermore at re 1 2 105 the conventional rotor has a maximum power efficient of 0 23 while the rotor with middle straight segment has a maximum power coefficient of 0 31 the single and the two stage rotors designed here have identical cross section which is sketched in fig 2 a the two rotors have the same rotor height h and the same rotor diameter d as schematically shown in fig 2 b and c the end plates help to strengthen the rotor structure major geometric parameters are listed in table 1 the two stage rotor displayed in fig 2 c is composed of two smaller rotors namely upper and lower sub rotors which are offset by an azimuthal angle of 90 there is no shaft intrusion into the gap between the two blades and the two sub rotors rotate synchronously with the three end plates from the flow aspect the gap enables the connection of water flow between upstream and downstream sides of the rotor the gap flow in turn influences the pressure distributions over the blades sheldahl et al 1978 meanwhile the two blades overlap with each other near the inner blade ends mabrouki et al 2014 argued that the maximum power coefficient was attained at an overlap ratio of about 0 3 to quantify the rotor performance several parameters were defined the tip speed ratio tsr denotes the ratio of the maximum linear velocity of the rotor which arises at blade tip to the velocity of upstream flow 1 t s r ω d 2 u where ω denotes the angular velocity of the rotor and u the upstream water velocity the coefficients of static torque c ts dynamic torque c t and power coefficient c p are given separately by 2 c t s 4 t s ρ u 2 h d 2 3 c t 4 t ρ u 2 h d 2 4 c p 2 ω t ρ h d u 3 t s r c t where t s and t represent the static torque and the dynamic torque respectively 2 2 numerical setup 2 2 1 governing equations and turbulence model the commercial cfd code ansys fluent served as a basic platform for the numerical work pure water of 20 c with the density of 998 2 kg m3 and the dynamic viscosity of 1 0 10 3 m2 s was selected as the working medium in consideration of the magnitude of the flow velocity the flows considered here were assumed incompressible and dominated by the reynolds averaged navier stokes rans equations the piso pressure implicit with splitting of operators algorithm was adopted to address the coupling between static pressure and velocity the algorithm can effectively reduce the difficulty of convergence caused by computational grids meanwhile the second order upwind scheme was selected to discretize the convective terms in the governing equations the shear stress transport sst k ω turbulence model was employed to accomplish the closure of the governing equations here k represents the turbulence kinetic energy and ω the specific turbulence dissipation rate the sst k ω turbulence model proves suitable for treating flows around curved and rotating blades zhang et al 2019a b placide et al 2013 all simulations were performed through parallel processing and the convergence criterion was set to 1 10 6 for all monitored variables namely velocity components k ω and the mass balance between the inlet and outlet of the whole computational domain 2 2 2 computational domain and boundary conditions the computational domain for the two stage rotor is schematically shown in fig 3 the domain consists of a rotational subdomain an outer domain and the remaining domain that encloses the other two domains the inlet and the outlet of the whole domain are respectively extended 5d and 10d from the rotor axis the front and back surfaces are 5d away from the rotor axis the top and bottom surfaces are 5d away from the middle end plate the computational domain was sufficiently spacious to avoid the disturbance of boundaries to the flows near the rotor meanwhile the inflow faced by the rotor was fully developed and the wake phenomena could be captured for adjacent subdomains interfaces were defined to ensure reliable data exchange and the conservation of mass and momentum uniform and steady inflow was set at the inlet of the whole computational domain the velocity was set to 2 0 m s and the turbulence intensity 5 the corresponding reynolds number was 4 8 105 the pressure outlet boundary condition was set at the outlet of the computational domain the backflow pressure was set as the total pressure to promote the discharge of flow from the domain instead of inflow at the four lateral surfaces of the computational domain symmetry boundary conditions were set and thereby the computational domain can be deemed as infinitely large in lateral directions no slip boundary conditions were specified on the surface of the rotor blades and the surface roughness was set to 0 05 mm 2 2 3 grid generation and grid independence examination a combination of structured and unstructured grids was adopted here in consideration of small truncation errors and easy convergence unstructured grids were applied in the rotational and the outer domains and structured grids in the remaining subdomain the commercial grid generation code icem cfd was used to discretize the computational domain the maximum skewness angle was less than 40 the thickness of the first layer adjacent to blade surface was set to 0 035 mm totally 10 layers of near wall grids were set with a growth ratio of 1 2 grids were refined near the rotor with the sst k ω turbulence model grid refinement is more appropriate than employing near wall functions to treat near wall flows meanwhile the sst k ω turbulence model is an improved model and allows the solving of near wall viscous flows through grid refinement zhang et al 2019a b placide et al 2013 therefore the grids near the blade surface were refined to obtain proper values of y sharma and sharma 2016 the maximum y attainable is less than 5 0 satisfying the requirement of the sst k ω turbulence model the rotation of the rotor was enabled using the sliding mesh technique which has been successfully used in impeller machinery roy and saha 2013 kang et al 2014 for the two stage rotor unsteady simulations were performed based on five grid schemes the total grid numbers range from about 2 5 million to 8 9 million as listed in table 2 during the simulation the effect of time step was inspected as well the time step decreased from 0 004 s to 0 001 s the average power coefficient c p ave was obtained over a whole rotation cycle as a stable operational state was reached the results are listed in table 2 it indicates that for cases 3 4 and 5 the relative difference of c p ave between any pair is less than 3 therefore the grid scheme associated with case 3 was selected for subsequent simulations for this grid scheme a cross sectional view of the grids near the upper sub rotor is displayed in fig 4 for the grid scheme finally adopted for the single stage rotor the total grid number is 4 072 816 2 2 4 calculation of the angular velocity during the startup process literally the hydraulic force imposed on the rotor varies with the orientation of the rotor and the rotational speed of the rotor alters accordingly during the startup process the rotational speed may vary without periodicity according to newton s second law of motion the rotational speed of the rotor depends on the moment of inertia j the hydraulic moment t w the frictional resistance moment t r and the moment of external load t l liu et al 2019 here the drag type hydrokinetic rotor is assumed to be a rigid body and rotates only with respect to its central axis the governing equation for the rotation of the rotor takes the following form 5 j d ω d t t w t r t l the integral of eq 5 yields 6 ω t w t r t l j d t the moment of inertia depends on rotor structure and material as well as the connection between the rotor and the adjacent module here the moment of inertia was set to 0 143 kg m2 which was determined based on the geometry and the material density of the rotor during each time step the integral of the static pressure over the rotor blade surface yields the hydraulic moment t w since the frictional resistance moment influences insignificantly the rotation of the rotor it was neglected in the present study based on the relationship between the loading moment and the angular velocity t l is given by wang and yeung 2016 7 t l b g ω where b g denotes the load coefficient then the output power of the rotor p is given by 8 p t l ω b g ω 2 a solver of six degree of freedom sdof is embedded in ansys fluent and can be used to calculate external forces such as hydraulic and gravitational forces and the moments on a rigid body le et al 2014 such a technique has been practiced in addressing the flow driven rotation of the darrieus wind rotor liu et al 2019 the fluid structure interaction was handled via solving eqs 5 and 6 the hydraulic moment was calculated through integrating the static pressure and the shear stress over the surface of rotor blades then the angular velocity ω can be calculated furthermore the variation of the angular displacement yields new boundary conditions which will be implemented through the sliding mesh technique and used to update the hydraulic moment 3 validation of the numerical scheme 3 1 experimental setup to validate the numerical scheme devised an experimental work was performed since no experimental model parallel with the drag type rotors shown in fig 2 was available another rotor was selected in the experiment as shown in fig 5 a corresponding numerical work was performed using the numerical scheme detailed in sec 2 2 a closed loop in which pure water was circulated served as the basic platform for the experimental work the horizontally installed test section measuring 1200 mm 390 mm 390 mm was equipped with four plexiglass sidewalls the experimental results indicated that at an upstream flow velocity of 1 34 m s corresponding to re 3 2 105 the turbulent intensity in the test section varied between 1 74 and 2 65 instantaneous flows near the rotor were measured using a lavision tr piv time resolved particle image velocimetry system the experimental system is schematically shown in fig 5 a the rotor was made of plexiglass so that laser could penetrate through the rotor and the whole flow surrounding the rotor was thereby detectable the deflector plate was deployed upstream of the rotor to improve the performance of the rotor more specifically the deflector plate prevents the upstream flow from impacting the returning blade meanwhile it can guide the upstream flow towards the concave side of the advancing blade the combination of the rotor the deflector and the lateral walls mimics the practical operation of a hydrokinetic rotor in a duct therefore the blockage effect was not considered here since the deflector is not transparent mirrors were used to reflect light and the flows at both sides of the deflector were illuminated an image of the experimental rig is displayed in fig 5 b the rotor shaft was supported by a pair of angular contact ball bearings the horizontal distance between the shaft axis and the inlet of the test section is 500 mm an integrated measurement module was mounted at the upper end of the rotor shaft to measure both the torque and the rotational speed of the shaft the uncertainty of the measurement module relative to the acquired value is 1 which was obtained through a calibration experiment the sampling frequency is 100 hz based on the data acquired the operational performance of the rotor could be calculated as the rotation of the rotor arrived at a stable stage the external load on the rotor was adjusted through an electromagnetic brake the sampling frequency of the tr piv system was set to 1000 hz and 1000 sets of images were captured for each operational condition hollow glass beads with a mean diameter of 20 μm were used as seeding particles to trace the motion of the water flow a photron fastcam ux100 high speed cmos camera was used to record tracing particles in the flow with the maximum resolution of 1280 1024 pixels the image acquisition was assisted by a nikon af nikkor 50 mm f 1 4d lens a dm30 high frequency pulsed laser with the maximum energy of 70 mj was employed to generate a thin light sheet the emitting of the laser sheet was synchronized with the exposure of the cmos camera through davis control software which was embedded in the control module of the tr piv system the laser sheet is perpendicular to the rotor shaft and overlaps with a symmetry plane of the test section several mirrors were deployed at the side oppose to the laser emitter to illuminate the regions where the laser could not reach directly due to the limitation of the space beneath the test section another mirror was used to reflect the image of the laser illuminated zone to the camera as seen in fig 5 b the cross correlation algorithm was adopted to process the data obtained in interrogation windows measuring 32 32 pixels and with an overlap of 75 the maximum vector resolution was approximately 1 9 mm the time interval between two consecutive laser pulses was geared to ensure that the particle displacement exceeded the particle diameter but was less than 1 4 of the width of the interrogation window the uncertainty of the velocity measurement was largely related to the velocity magnitudes selected in consideration of the velocity magnitudes adopted in the present experiment the uncertainty of the tr piv system was approximately 0 1 which was determined according to the specifications of the tr piv system other uncertainties were caused primarily by properties of seeding particles the circulation loop and the rotor these uncertainties were controlled in the experiment the overall uncertainty of the velocity measurement was less than 2 0 3 2 comparison of numerical and experimental results under the operating condition without external load velocity distributions at θ 0 and an upstream water velocity of 1 34 m s obtained numerically and experimentally are shown in fig 6 with such a configuration of the rotor and the deflector enough space is left between the rotor and the deflector for water to pass through therefore immediately downstream of the deflector a large vortex is formed which is shared by the numerical and experimental results meanwhile due to the relative position between the rotor and upstream water flow a vortex is confined near the concave side of the returning blade similarity of overall flow pattern between the numerical and experimental results is clearly manifested certainly some practical factors that disturb the flow could not be modeled in numerical setup during the experiment the external load t l was adjusted through the electromagnetic brake and the rotational speed was measured by the tachometer then the output power could be calculated via eq 8 the external loads obtained in the experiment were used as initial conditions for the numerical simulation consequently the angular velocity was calculated using the sdof solver which operated in combination with the implementation of the sliding mesh technique and user defined functions meanwhile the output power was obtained numerically a comparison of the angular velocity of the rotor and the power coefficient between numerical and experimental results is illustrated in fig 7 it is noteworthy that the numerical results c p ave and ω ave are averaged values in a whole rotation cycle as the operation of the rotor attains a stable state meanwhile the experimental results are also time averaged values which were calculated based on the data acquired using the measurement module shown in fig 5 regarding the variation of the angular velocity with the external loads both the two curves plotted in fig 7 drop continuously as t l increases the tendency is explicit and high external loads retard the rotation of the rotor the numerically obtained results are consistently higher than the experimental counterparts furthermore the maximum relative deviation between the two curves is 5 1 which arises at t l 0 381 this is reasonable since practical factors that influence the rotation of the rotor could not be completely considered in numerical setup a direct comparison of the rotational speed between experimental and numerical results is accomplishable only as the angular velocity has been accurately measured in asr et al 2016 the tip speed ratio was compared between the experimental and numerical results and the maximum relative deviation exceeded 10 for the power coefficient the two curves shown in fig 7 are analogous as well they follow the same variation tendency which manifests a single peak at t l 0 414 the numerical results are relatively high as is similar with the comparison of ω avg the relative deviation between the two curves attains 9 2 the power coefficient depends on several quantities a relative difference of 10 between the numerically and experimentally obtained torque coefficients is reasonable kothe et al 2020 placide et al 2013 based on the comparisons illustrated in figs 6 and 7 high validity of the devised numerical scheme is proved subsequently the numerical scheme is applied to investigate the performance of the two rotors considered 4 results and discussion 4 1 general performance of the single stage rotor for the single stage rotor the average power coefficient is plotted in fig 8 as a function of tsr it is seen that the highest power coefficient emerges at tsr 0 54 and the corresponding power coefficient is 0 28 furthermore the curve is characterized by a protruding peak indicating a significant effect of tsr on the power output of the rotor in khan et al 2009 a two stage rotor with a height of 0 40 m and diameter of 0 22 m was tested at re 2 2 105 similar variation trend of c p was obtained but the optimum tsr is approximately 0 8 such a difference is related to both re and rotor geometry at tsr 0 54 instantaneous torque coefficients are plotted in a polar coordinate system as shown in fig 9 due to the symmetrical arrangement of the two blades instantaneous torques are symmetrical with respect to the rotation center alom et al 2018 were concerned with the forces imposed on the rotor blades they pointed out that at some azimuthal angles the hydraulic torques over the two blades counteract with each other in consideration of the physical properties of the drag type rotor the drag force contributes more significantly to the rotation of the rotor however at some ranges of azimuthal angles the force perpendicular to the drag force which is sometimes deemed as a lift force kumar et al 2016 exceeds the drag force in driving the rotation of the rotor which was proved in modi and fernando 1988 the distribution of instantaneous torque coefficient over the whole rotation cycle is evidently non uniform as indicated in fig 9 it is noteworthy that negative torque coefficient arises at some azimuthal angles which is ascribed to the competition between the drive and the resistance for the rotation of the rotor however these negative torque coefficients have not led to halt or counter rotation of the rotor during the startup process it is conjectured that negative torque coefficient may also be encountered whether the startup will thereby fail remains to be investigated the flow patterns near the rotor depend closely on the relative orientation of the rotor and upstream flow for the single stage rotor at tsr 0 54 the mid span section was selected to illustrate instantaneous cross sectional distributions of static pressure and streamlines three typical azimuthal angles are selected and the results are shown in fig 10 at θ 0 two vortices with high intensity are salient in the wake of the rotor as shown in fig 10 a meanwhile high pressure is predominant near the concave side of the advancing blade at this position the torque coefficient is relatively high as shown in fig 9 in fig 10 b the upstream flow directly impacts the convex side of the returning blade leading to high stagnation pressure over the rotor blade this undermines the counterclockwise rotation of the rotor two large scale vortices are seen in the wake of the rotor it indicates that the positions of the vortex cores vary with the azimuthal angle at θ 120 the flow pattern is featured by multiple vortices as shown in fig 10 c the vortex scales are small relative to those indicated in fig 10 a and b meanwhile the vortices approach the rotor blades the gap between the two blades is filled with a clear vortex which is common at θ 0 and 120 it is appreciable that water is trapped in the gap which imposes a significant effect on pressure distributions over the blades at θ 60 the vortex in the gap cannot take shape in this case the relative orientation between the rotor and upstream water flow leads to high pressure gradients in the gap as indicated in fig 10 b 4 2 static torque coefficient of the single stage and the two stage rotors as a rotor starts to rotate from an initially stationary state whether the startup succeeds or fails depends largely on the static torque which is used to overcome the friction resistance and the inertia of the system jing et al 2019 at the initial positions with low static torque failed startup of the rotor is possible nasef et al 2013 as the initial static torque is negative the rotor will rotate reversely and eventually halt at some position zhao et al 2020 the static torque coefficient has been extensively studied as an important indicator of the static performance of the rotor salleh et al 2019 fertahi et al 2018 joe and dhiman 2019 here the static torque performance of the two rotors was obtained prior to the discussion of the startup performance variations of the static torque coefficient c ts are plotted in fig 11 as a function of the azimuthal angle the azimuthal angle of the upper sub rotor is selected to denote the orientation of the two stage rotor it is evidenced that the two curves are not smooth which is related to the geometry of the rotor blades regarding the two stage rotor the torque coefficient varies with low amplitudes as θ varies and the average static torque coefficient is lower than that of the single stage rotor meanwhile the variation period of c ts of the two stage rotor is 90 which is half that of the single stage rotor as indicated in fig 11 the minimum torque coefficient of the single stage rotor is approximately 0 15 which is higher than that recorded in sengupta et al 2016 but is lower than the two stage rotor as shown in fig 11 subsequently the position of θ 0 which corresponds to the minimum static torque coefficient and is associated with the highest risk of startup failure was selected as the initial position for startup of the two rotors 4 3 startup of the single stage and the two stage rotors 4 3 1 time dependent angular velocity and torque coefficient of the single stage rotor the startup processes of the single stage rotor were simulated at different load coefficients and an initial position of θ 0 based on the numerical results obtained two critical operational parameters the angular velocity and the torque coefficient of the rotor were extracted the angular velocity is plotted as a function of time t in fig 12 six characteristic points namely ω p 1 ω v 1 ω p 2 ω v 2 ω p 3 and ω v 3 which represent respectively the first peak and the first valley of the angular velocity at b g 0 0 0 5 and 1 0 are marked in the amplified plot major information of these characteristic points is listed in table 3 as external loads are absent namely b g 0 0 the rotor is accelerated first and then approaches the state featured by the runaway speed during such a period several rounds of fluctuations of the angular velocity are experienced subsequently ω varies orderly around the average value under this operational condition the kinetic energy of water supports exclusively the rotation of the rotor and no torque can be extracted it is indicated that ω reaches equilibrium fast as b g increases essentially the variation of ω in such a state conforms to the practical situation while assuming a constant angular velocity for the rotor is apparently improper furthermore it is observed that the fluctuation amplitude of ω increases with the load coefficient however the average angular velocity decreases with increasing load coefficient it is thereby demonstrated that high loads hinder the rotation of the rotor variations of the torque coefficient during the startup process of the single stage rotor are plotted in fig 13 the cases associated with the four load coefficients are presented similarly six characteristic points namely c t p 1 c t v 1 c t p 2 c t v 2 c t p 3 and c t v 3 which represent the first peak and the first valley of the torque coefficient at b g 0 0 0 5 and 1 0 respectively are indicated the information of these points is shown in table 4 at b g 0 0 the torque varies drastically but the average torque coefficient is zero as b g increases the fluctuations of the torque coefficient are alleviated but the average torque coefficient increases continuously the evolution of the torque coefficient experiences an irregularly and then a periodically varying stage as is shared by the four cases shown in fig 13 this signifies the dynamic essence of the startup process and is compatible with the variation of the angular velocity 4 3 2 startup performance of the two stage rotor for the two stage rotor instantaneous angular velocity and torque coefficient of the two stage rotor during the startup process are plotted in fig 14 it is seen that the fluctuations of ω are considerably inhibited relative to those shown in fig 12 for each case the rotor is smoothly accelerated to a stable stage and then the variation of ω manifests slightly wavy patterns moreover as b g increases the angular velocity involved in the stage of stable operation decreases continuously as shown in fig 14 a which is analogous with the situation associated with the single stage rotor a comparison of figs 14 b and 13 demonstrates that the fluctuations of the torque coefficient are mitigated with the introduction of the two stage configuration the conclusion is in accordance with the results related to wind rotors of different stages obtained by kamoji et al 2008 here at each load coefficient as the rotation of the two stage rotor arrives at a stable stage the torque coefficient varies periodically and the average torque coefficient is close to that of the single stage rotor shown in fig 13 furthermore since the fluctuation of c t incurs energy loss the two stage rotor is better than the single stage one in terms of the energy conversion efficiency 4 3 3 startup time and average power coefficient the startup time t s is defined as the time required by the rotor to rotate for a whole revolution from the initial position a comparison of the startup time between the single stage and the two stage rotors is illustrated in fig 15 it is seen that the two values of startup time are close to each other under the condition without load namely b g 0 0 as b g increases the advantages of the two stage rotor over the single stage rotor are evidenced consistently at b g 1 5 the startup time of the two stage rotor is shorter than that of the single stage rotor by about 12 9 during the startup process both the power coefficient and the tip speed ratio vary with the angular velocity and the torque on the rotor tsr is of practical significance for optimizing the rotor blades to capture more energy from flowing water and properly matching the rotor to a generator the power output capability is a significant indicator of the startup performance comparisons of the average power coefficient c p ave and the tip speed ratio tsr ave which were calculated through averaging instantaneous power coefficients and tip speed ratios within t s are shown in fig 16 it is clearly evident that the power coefficient of the single stage rotor is lower than that of the two stage rotor at each load coefficient the largest deviation arises at b g 1 0 meanwhile at each load coefficient the tip speed ratio of the two stage rotor is higher as well essentially during the startup process the fluctuation of the angular velocity causes not just energy loss but also the decrease of the average angular velocity according to eqs 4 and 8 the power coefficient is proportional to the square of the angular velocity therefore c p ave of the single stage rotor is considerably lower than that of the two stage rotor which is proved in fig 16 as well in kothe et al 2020 it was indicated that the rotor with helical blades had a power coefficient higher than that of the two stage rotor which was attributed to the stabilization effect of helical blades on the rotation of the rotor furthermore provided that the angular velocity of the rotor is assumed constant which has been generally exercised the rotor performance will be overestimated 4 4 flow patterns during the startup process 4 4 1 instantaneous flow structures near the single stage rotor to relate flow characteristics with rotor performance cross sectional distributions of static pressure and streamlines corresponding to the six characteristic points marked in fig 12 are illustrated in fig 17 the rotor rotates in counterclockwise direction in fig 17 a a positive action of water flow on the advancing blade is conceivable however a large high pressure zone is concurrently faced by the returning blade at this moment the angular velocity of the rotor arrives at its maximum in fig 17 b the angular velocity reaches its first valley at such an azimuthal position the returning blade suffers from high resistance from upstream flow the downstream side of the rotor is attached with backflows and counterclockwise rotating vortices although it is difficult to quantify the hydraulic forces imposed on each element of the blade surface it is appreciable that the rotation of the rotor is impeded to a large extent as b g increases the positions where the first peak of angular velocity is reached remain nearly the same as indicated in fig 17 a c and e it is interesting that the rotor orientation at which the first peak of the angular velocity arises is insensitive to the load coefficient similarly as the first valley of the angular velocity appears the azimuthal positions are identical in fig 17 b d and f as well from the perspective of flow structure the rotor is adjacent to large scale vortices in fig 17 as the first peak of angular velocity is reached as shown in fig 17 a c and e the scales of the wake vortex are even larger than the radius of the rotor in comparison corresponding to the first valley of the angular velocity the wake immediately downstream of the rotor is dominated by multiple large scale vortices with diverse profiles meanwhile the vortex in the gap is stretched in fig 17 b d and f which depends on the relative orientation between the rotor and adjacent flows flow patterns corresponding to the six points marked in fig 13 are shown in fig 18 in fig 18 a c and e the torque coefficient of the rotor arrives at its first maximum at each load coefficient the three near rotor flow patterns are similar high pressure near the concave side of the blade provides impetus to the acceleration of the rotor a large portion of the concave side of the advancing blade is covered by high pressure while the other side is neighbored by low pressure consequently high hydraulic torque is produced in fig 18 b d and f the first valley of c t is produced similarly the three flow patterns have no significant difference it is seen that the pressure at the concave side of the advancing blade increases with b g meanwhile in view of the large area of high pressure immediately upstream of the returning blade high resistance to counterclockwise rotation of the rotor is conceivable therefore such an azimuthal position is responsible for low torque coefficient 4 4 2 flow patterns near the two stage rotor during the startup process overall difference between the two and the single stage rotors can be recognized through the comparison between figs 12 14 essentially explicit relationships have been evidenced between ω and t a further interest lies in the flow patterns near the two stage rotor to facilitate the comparison between the two rotors the azimuthal positions at which the orientation of the upper sub rotor is the same with that of the single stage rotor are selected at b g 0 0 and 1 0 the cross sectional flow patterns near the two stage rotor are shown in fig 19 and corresponding startup time is presented as well the two cross sections of the computational domain overlap separately with the mid span cross sections of the two sub rotors the time required by the two stage rotor to arrive at the azimuthal position indicated in fig 19 a is 0 240 s which is shorter than that for the single stage rotor to reach the same position namely point ω p 1 marked in fig 12 for the single stage rotor as shown in fig 17 a the vortices shedding from the rotor deviate remarkably from the rotor relative to that associated with the upper sub rotor particularly the vortex originating from the concave side of the advancing blade has evolved into a distinctly large vortex in fig 17 a while in fig 19 a a small vortex is still confined near the hub end of the returning blade for the two stage rotor the upper and the lower sub rotors are surrounded by considerably different pressure distributions in fig 19 b the upper sub rotor is positioned with the same setting angle as that of the single stage rotor shown in fig 17 b the time required by the former is shorter at such a rotor position θ deviates slightly from 0 and the returning blade resists the upstream flow and high pressure is directly faced by the convex side of the returning blade meanwhile a large scale vortex is observed above the advancing blade compared with that shown in fig 17 b the large vortex above the upper sub rotor approaches the rotor and is apparently unexpanded regarding the lower sub rotor it is surrounded by rather smooth water flows the wake vortex deviates considerably from the sub rotor and thereby its effect on the sub rotor is insignificant based on fig 19 a and b it is perceivable that the upper and the lower sub rotors cannot simultaneously reach the state at which the highest torque coefficient is attained for both the two sub rotors at b g 1 0 the upper sub rotor is positioned according to those indicated in fig 17 e and f as seen in fig 19 c and d the two stage rotor rotates faster than the single stage rotor which is in accordance with the tendency illustrated at b g 0 0 meanwhile in fig 19 as b g increases the flow pattern near the upper sub rotor varies which is ascribed to the slight change in the rotor position for the comparison between figs 19 and 17 since the rotor positions are identical at each load coefficient the difference of flow patterns depends significantly on the instantaneous angular velocity of the rotor a general trend in fig 19 is that the vortices near the upper or the lower sub rotor arise from the blade tip which differs from that shown in fig 17 where the blade is attached consistently by one or multiple vortices near rotor flow patterns as the upper sub rotor arrives at the positions consistent with those indicated in fig 18 are shown in fig 20 similarly a shorter time is required for the two stage rotor to arrive at the same angular position in fig 20 a the torque coefficient of the two stage rotor has not reached its first peak as indicated in fig 14 furthermore there is no wake vortex downstream of the upper sub rotor which differs considerably from that related to the single stage rotor at t 0 273 s corresponding to fig 20 b the valley of the torque coefficient has not been reached as indicated in fig 14 the imparity of wake vortex profiles between figs 20 b and 18 b is apparent for the lower sub rotor shown in fig 20 a and b the wake flow contains large scale vortices but the vortex geometries are different at b g 1 0 similar tendencies are demonstrated the two sub rotors can complement each other in other words as one sub rotor operates in a disadvantageous position the other rotor can provide impetus to the rotation of the whole rotor relative to the single stage rotor the two stage rotor is accompanied with large scale wake vortices and smoothed flow patterns consequently fluctuations of both the angular velocity and torque coefficient are alleviated furthermore as the azimuthal position is certain the near rotor flow pattern varies insignificantly with the load coefficient 5 conclusions the startup performance of the two stage drag type hydrokinetic rotor was investigated numerically the flow driven rotation of the rotor was addressed through the sdof solver which differed significantly from general practice of predefining a constant rotational speed for the rotor a comparison between the two stage rotor and a single stage rotor was performed major conclusions drawn from the study are as follows 1 the wake flow of the two stage and the single stage rotors is featured by large scale vortices which vary in vortex number and profile with the relative orientation between the rotor and upstream flow for the two stage rotor the upper and the lower sub rotors are neighbored by significantly different flow patterns 2 during the startup process the two stage rotor is responsible for smooth variations of the torque coefficient and the angular velocity in comparison the single stage rotor manifests drastic fluctuations of the two quantities the startup time of the two stage rotor is shorter than that of the single stage rotor 3 with increasing load coefficient the angular velocity averaged within the startup process decreases continuously relative to the single stage rotor the two stage rotor has higher average tip speed ratio and average power coefficient irrespective of the variation of the load coefficient 4 instantaneous flow patterns near the two stage rotor are divided into upper and lower parts which correspond separately to the upper and the lower sub rotors at the same azimuthal angle relative to those associated with the single stage rotor the wake vortices downstream of the two stage rotor are underdeveloped credit authorship contribution statement can kang conceptualization methodology project administration hexiang zhao investigation data curation writing original draft bing li resources validation software weifeng gong formal analysis visualization validation yang zhu investigation data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors are grateful for the financial support from the project funded by the priority academic program development of jiangsu higher education institutions papd the authors thank the computation center of jiangsu university for providing the computer clusters 
20217,water entry problem is common in ocean engineering including complex fluid structure interaction fsi phenomena at the interfaces as a lagrangian and mesh free particle method the smoothed particle hydrodynamics sph method owns great advantages in dealing with fsi problems however solid boundary treatment has always been one of the main issues affecting the accuracy of the sph method through combining the dummy particle boundary and the normal flux method an improved solid boundary treatment technology is proposed in this paper after fully validated by a series of 2d and 3d water entry cases the boundary treatment method is applied to simulate the water entry of a lifeboat the results indicate that the sph model in this paper can provide a reliable numerical prediction for water entry problems with 3d complex geometries keywords water entry fluid structure interaction smoothed particle hydrodynamics solid boundary condition 1 introduction as a complex physical phenomenon fluid structure interaction fsi plays a vital role in science and engineering fields such as ocean engineering biofluid mechanics etc the sph method is a lagrangian meshfree particle method first proposed by gingold and monaghan 1977 and lucy 1977 respectively to solve the problem of astrophysics at this stage the sph method has been widely employed in impact explosion hydrodynamics multiphase flow and fluid structure interaction khayyer et al 2018 peng et al 2021a sun et al 2020 reece et al 2020 sun et al 2021 wang et al 2019 it is determined by the meshfree and particle characteristics of the sph method that it is superior in treating large deformation and moving boundary problems no unique tracking of the coupling interface is required when treating fsi problems with the sph method so it is convenient to apply the boundary conditions at the interface however the development of the sph method is far from mature one of the major obstacles to the application of the sph method in fsi issues is the treatment of solid boundaries due to the truncation of the integration domain the calculation accuracy for particles located near the solid boundary will decrease a lot of efforts have been done to improve the solid boundary treatment technology for decades monaghan 1994 proposed a force based method for boundary conditions when simulating the high speed free surface flow to prevent fluid particles from nonphysically penetrating the solid boundary in his model the solid boundary is described by virtual particles and these virtual particles have repulsive force on surrounding fluid particles it is similar to the lennard jones force in molecular dynamics however the momentum of this method is not conserved and the description of particles adjacent to the boundary does not match the actual situation rogers and dalrymple 2008 put forward an improved repulsive force model to simulate tsunami the repulsive force is associated with the normal direction of the boundary the relative positions between fluid particles and structure particles and the fluid particles normal velocities considering the numerical error caused by the truncation of boundary integral term for particles surrounding the solid boundary de leffe et al 2009 introduced the normal flux method in finite volume method fvm into the sph method the boundary force is derived and added to approximate equations directly colagrossi and landrini 2003 used ghost particles to mimic the solid boundary at each step particles in the boundary layer are mirrored into the interior of the structure so that the ghost particles have the same density velocity and pressure as neighbouring fluid particles a modified boundary method is proposed by marrone et al 2011 in which the boundary is discretized into several layers of fixed ghost particles a series of interpolation points are generated by mirroring the fixed ghost particles into the fluid field the physical quantities of the fixed particles can be obtained through these interpolation points in turns adami et al 2012 advanced another virtual particle model called dummy particles to impose solid boundary conditions different from fixed ghost particles the physical quantities of dummy particles are interpolated directly from the surrounding fluid particles chen et al 2017 presented a corrected solid boundary treatment method in order to overcome the unphysical oscillations of pressure distribution and improve numerical stability repulsive force models have strong operability so they can flexibly deal with complicated geometric models however it cannot accurately solve boundary defects since the magnitude of the force is strongly dependent on the empirical parameters on the opposite the virtual particle methods are able to overcome the truncation of the boundary still they are difficult to deal with three dimensional complex geometric models especially complex models with large curvatures in order to avoid the unphysical penetration of fluid particles and improve the calculation accuracy a coupled boundary treatment method was proposed by liu et al 2012 based on the advantages and disadvantages of repulsive force models and virtual particle models however it is still difficult to discrete the solid boundary with complex geometry due to multiple layers of ghost particles required similar to liu et al 2012 an improved solid boundary treatment method is proposed which only arranges one layer of particles on the solid boundary it is obviously that the current method is easy to implement for complex solid boundaries the water entry problem is a typical fsi problem including intricate physical phenomena a lot of research has been done on water entry focusing on the significant parameters and characteristics during the water entry process such as impact force pressure distribution and evolution of the free surface et al cheng et al 2019 shao 2009 zhang et al 2021 a robust sph algorithm is established in sun et al 2015 to solve the water entry problem meng et al 2021 take care of the air effect in typical water entry problems with a riemann sph model the cavity evolution of the water entry of a sphere is studied in zhao et al 2021 based on the increased computational efficiency using adaptive particle refinement apr method as well as cell linked list technology in this paper the improved solid boundary treatment technology is presented and validated by several representative water entry cases given that this paper is dedicated to verifying the reliability of the proposed solid boundary treatment method the structural dynamic response is ignored the content of this paper is arranged as follows the second section introduces the basic theory of the sph method and some numerical techniques adopted in the current sph model besides the improved boundary treatment technique is illustrated at great length then in the third section the newly proposed method is validated by 2d and 3d water entry cases respectively based on sufficient verification the improved boundary treatment technology is extended to practical application to simulate the water entry of a lifeboat the numerical solutions are given and discussed in detail in the fourth section the summary is made in the last section 2 the present numerical model 2 1 governing equations for water entry problems in this paper the viscous force can be ignored cheng et al 2020 unless specially specified so the mass equation and the momentum conservation equation based on the lagrangian view can be written as follows 1 d ρ d t ρ v 2 d v d t 1 ρ p g where ρ represents density p denotes pressure v is velocity and g is the gravitational acceleration for the sake of describing the relationship between pressure and density it is necessary to use the state equation in the weakly compressible smoothed particle hydrodynamics wcsph method monaghan 1994 which reads 3 p c 0 2 ρ 0 7 ρ ρ 0 7 1 where c 0 and ρ 0 denote the artificial sound speed and the reference density of fluid particles the given reference density in this paper is ρ 0 1000 kg m 3 according to sun et al 2015 the artificial sound speed is usually chosen by the formula below 4 v max 2 c 0 2 g h c 0 2 0 01 where v max and h refer to the maximum velocity of the fluid domain and the initial fluid depth respectively it is guaranteed that the mach number is less than 0 1 which satisfies the weakly compressible hypothesis while a massive time step is obtained however to simplify the calculation c 0 can be set as a constant sun et al 2018 in the present work as 5 c 0 10 max g h v e n t r y where v e n t r y is the initial velocity of the structure when reaching the free surface by means of the sph approximation algorithm liu and liu 2010 2003 the basic sph equation can be written as follows 6 f x i j m j ρ j f x j w x i x j h i f x i j m j ρ j f x j f x i i w x i x j h i f x i j m j ρ j f x j f x i i w x i x j h where the subscript j represents surrounding particles within the supported field of the concerned particle i m represents the mass of particles according to the approximation method above the discretized form of continuity and momentum equations can be obtained 7 d ρ i d t ρ i j v i v j i w x i x j h m j ρ j 8 d v i d t j m j p i p j ρ i ρ j i w x i x j h g in this paper the modified gaussian kernel function developed by grenier et al 2009 is adopted 2 2 δ sph scheme and artificial viscosity for purpose of reducing the pressure noise and enhancing the stability as well as the accuracy of the current sph method an artificial density diffusion term molteni and colagrossi 2009 and an artificial viscosity term monaghan and gingold 1983 are added to continuity equation and momentum equation respectively so eqs 7 and 8 are modified as follows 9 d ρ i d t ρ i j v i v j i w x i x j h m j ρ j δ h c 0 j ψ i j i w x i x j h m j ρ j 10 d v i d t j m j p i p j ρ i ρ j i w x i x j h g α h c 0 ρ 0 ρ i j π i j i w x i x j h m j ρ j 11 ψ i j ρ i ρ j x i x j x i x j 2 0 01 h 2 π i j v i v j x i x j x i x j 2 0 01 h 2 where δ and α denote the coefficient of the artificial density term and the artificial viscosity term respectively the values of these two coefficients in this paper are both equal to 0 1 2 3 improved boundary condition an improved boundary condition treatment method is put forward by means of coupling the dummy particle boundary treatment method adami et al 2012 with the normal flux method de leffe et al 2009 to avoid the truncation of the sph method at the fluid solid interface as is shown in fig 1 the boundary of structure is discretized into just one layer of particles for each structure particle j an integration point k and a normal unit vector n k are generated on the inner surface of it with regard to calculating the gradient of the fluid particles surrounding the structure a surface term must be non negligible which is employed to impose the boundary condition in the work of de leffe et al 2009 so the integration of the particles nearby the interface is as follows peng et al 2021b 12 x f x ω f x w x x h n d s ω f x x w x x h d x the integration points k are considered to provide the integral boundary for the surface integral term and the structure particles are treated as dummy particles therefore eq 12 can be converted into 13 f x i j b f m j ρ j f x j i w x i x j h k k f x k w x i x k h n k s k where the subscript b subscript f and subscript k denote boundary particles fluid particles and integration points respectively s k is the area of the integration point k attached to the structure particle similar to the previous sections the continuity and momentum equations for fluid particles near the interface can be obtained 14 d ρ i d t ρ i j b f v i v j i w x i x j h m j ρ j ρ i k k v i v k n k w x i x k h s k 15 d v i d t j b f m j p i p j ρ i ρ j i w x i x j h ρ i 1 k k p i p k n k w x i x k h s k g the pressure of point k is treated as equal to the pressure of the structure particle to which it attached through interpolation of the pressure of surrounding fluid particles adami et al 2012 the pressure of structure particles is calculated 16 p b f f p f w x f x b h f f ρ f g a b x b x w w x f x b h f f w x f x b h where subscript b and f denote boundary particles and fluid particles the density and mass of boundary particles are calculated via the formulas below 17 ρ b ρ 0 7 p b c 0 2 ρ 0 1 7 18 m b ρ b v b the motion of a rigid body includes the translational motion and the rotational motion by the following formula in adami et al 2012 the equations of the momentum as well as the moment momentum of the rigid body can be obtained 19 d u c d t f f s m g 20 d ω c d t t f s i where u c ω c f f s and t f s refer to translational velocity rotational velocity the resultant force and resultant moment acting on the rigid body respectively m and i denote the mass and the moment of inertial of the centroid c f f s and t f s are able to be taken by the following formulas 21 f f s f f b b m b m f p f p b ρ f ρ b i w x f x b h ρ f 1 p f p k n k w x f x k h s k 22 t f s f f b b m b r b r c m f p f p b ρ f ρ b i w x f x b h ρ f 1 p f p k n k w x f x k h s k after updating the translational velocity u c and angular velocity ω c by eqs 19 and 20 it is in a position to gain the velocity of boundary particles following the formula below 23 v b u c ω c r b r c where r b and r c are the position vectors of boundary particles and the centroid of the rigid body respectively 3 numerical validations 3 1 2d wedges with different oblique angles in this section the water entry case of a wedge is selected as a numerical verification benchmark and the sph results are compared with the bem solution and the experimental data zhao et al 1996 the width of the wedge is b 0 5 m and the dead rise angle of it is θ 30 see fig 2 the mass of the wedge is m 72 5 kg there are five pressure measuring points on one side of the wedge which are named as p 1 p 5 in the numerical model of the current sph method the depth and the width of the water domain are d 1 5 m and w 3 m respectively in the experiment the wedge impacts water surface with a measured velocity v 0 6 15 m s to reduce the nonphysical reflection of pressure the non reflecting boundary condition is applied gong et al 2009 the convergence of the present sph model is checked on via three different particle resolutions in this part δ x 0 0048 m δ x 0 0024 m δ x 0 0012 m as the particle spacing minis the resultant force on wedge converges see fig 3 the pressure distribution on the wedge is obtained by 24 p b f f l u i d p f w b f f f l u i d w b f where the subscript f and subscript b respectively represent fluid particles and boundary particles as is shown in fig 3 the vertical force obtained by the three methods mentioned is congruent with each other generally especially in the early stages the distribution of the pressure acting on one side of the wedge obtained by the current sph model is contrasted with the work of gong et al 2009 and zhao et al 1996 and they share the same distribution law see fig 5 0 t v t d t in the figure means the height of immersion while z d and z k denote the vertical coordinates of the upper and lower endpoints however both of the numerical results by the bem and the sph method are gradually larger than the experimental data in the late period which is most likely caused by the three dimensional flow effect at both ends of the wedge in the experiment the pressure of the fluid surrounding the wedge at t 15 ms is shown in fig 4 it is illustrated that the area of high pressure appears at the point of separation between the wedge and the free surface in addition the pressure distribution shows a decreasing trend from the separation region to the bottom of the wedge which can be found more clearly in figs 5 a and 5 b in order to further verify the oblique impact overload and the rotational movement of structure another water entry case of a wedge with an inclination angle is simulated as is shown in fig 6 the geometric and inertial parameters of the wedge have been given at the initial moment the wedge falls freely at an inclination angle of 5 from 0 61 m above the free surface the time history curves of the vertical acceleration and angular acceleration during the water entry process of the wedge are shown in fig 7 the current sph results are highly consistent with the experimental results xu et al 1999 the evolution of the free surface and the pressure distribution during the water entry of the wedge are given in fig 8 it is obviously that the jet flow and pressure distribution generated by the attack are asymmetric in the early stage of the water entry the local high pressure area formed on the left side of the wedge is greater than that on the right side resulting in a clockwise angular acceleration of the wedge with the wedge going deeper the pressure on the right side of the wedge is greater than that on the left which is the opposite of the previous period at the late stage of the water entry the wedge is completely immersed below the free surface the attack pressure on both sides of the wedge approaches the hydrostatic pressure so the wedge no longer rotates significantly 3 2 2d floating body with complex geometry a water entry case of a floating body with complex 2d geometry falling into water was adopted to verify the sph algorithm in bouscasse et al 2013 in this section the same body used is shown in fig 9 a the body surface of which has twelve sharp corners connected by smooth curves the centre of gravity g is located in the upper left corner of the geometry and the coordinate of it is 0 2683 l 0 4352 l the mass of the body is given by m 0 1483 ρ l 2 and the moment of inertia with regard to g is i g 0 01 ρ l 4 ρ denotes the density of water the reynolds number is set to be re 2000 so that the viscosity υ l g l re can be determined for this case the real viscosity of the fluid is considered through the formula equivalent to the artificial viscosity proposed by monaghan and gingold 1983 the specific form of viscosity force f i v is as follows 25 f i v k μ j π i j w i j m j ρ j in the above equation k 2 d 2 where d denotes the number of dimension in this section the real physical viscosity is adopted in the interior of the fluid domain while particles belong to the free surface the artificial viscosity is exerted together with real viscosity in order to avoid numerical instability caused by rolling waves finally the viscosity force for free surface particles is determined by sun et al 2019 26 f i v k μ α c 0 h ρ 0 j π i j w i j m j ρ j according to marrone et al 2011 and yang and kong 2018 the artificial viscosity coefficient here is α 0 02 in bouscasse et al 2013 the only stable equilibrium state is obtained by a semi analytical solution the hydrostatic pressure is integrated along the surface to get the buoyancy force of the floating body then through iterative computations the couple θ g and y g l when buoyancy and gravity are in balance is picked up in term of the reference the values obtained are θ g 97 7 and y g l 0 5098 l snapshots in fig 9 show us the water entry process of the complex floating body it is evident that the body drops and rolls quickly at the beginning under the action of unbalanced gravity and buoyancy causing a disturbance in the fluid domain because of the viscosity the motion of fluid stops gradually then the body reaches a stable equilibrium state in turns as is shown in fig 10 the sph model adopted in this paper is capable of achieving the accurate position of gravity g and the rotation around it while the floating body is stationary 3 3 3d bow specimen for the purpose of fully verifying the numerical model in this paper water entry of the specimen in jalalisendi et al 2015 is simulated the specimen used in the experiment is illustrated in fig 11 a and dimensions of the bow in x y and z directions are l 20 cm b 16 cm and h 5 6 cm respectively as is shown in the figure that a cartesian coordinate system is fixed on the model with the origin of it located at the lowest point of the model the x axis as well as the y axis is placed along the width and height of the model respectively it is evident that the radius of curvature r and the dead rise β of the model change in both x and z directions at the same time to adapt to the shape of the bow a series of the cross section profiles of the model along the z axis at intervals of 1 cm are shown in fig 11 b from z 0 cm to z 10 cm because the model is symmetrical only the outline in the first quadrant is given in the figure in the experiment the specimen dropped straitly due to the constraint of rails the initial velocity of the bow once reaching the water surface is v 0 2 98 m s and the total mass of the specimen is m 0 601 kg as is demonstrated in fig 12 the movement of the specimen over time obtained by the sph method matches the experimental result well the evolution of the free surface during the water entry of the 3d bow is given in fig 13 from which we can find that the water is displaced and some jets are generated under the action of the structure in order to better describe the movement of the water field the velocity vectors of water on xy plane and yz plane are shown in fig 14 it is clear that the water near the structure obtains kinetic energy from the structure and transmits it to the distance it can be seen from the velocity vectors of the flow field that the general motion law of the flow field on the xy plane and the yz plane tends to be the same but the splash caused by structure on the xy plane is obviously more extensive than that on the yz plane the discrepancy may be on account of the different radius of curvature in two directions 4 study on the water entry of lifeboat 4 1 study on the motion of the lifeboat with an impact angle a lifeboat is a vital facility that every ship must be equipped with and is a tool for the crew to escape when an accident occurs the fully enclosed lifeboat is usually placed on the stern sliding gear when released the lifeboat slides down the slope and makes a parabolic motion in the air before it reaches the water surface the horizontal velocity of the lifeboat is constant while the vertical speed is uniformly accelerated under gravity after the lifeboat hits the water surface at a certain angle and velocity it triggers a violent fluid solid interaction phenomenon meanwhile the lifeboat is suffered from a great attack force which has a very important impact on its structural safety and movement posture the water entry of a lifeboat is considered in this section the 3d model of which is shown in fig 15 the sizes of the lifeboat in x y and z directions are 1 5 m 8 5 m and 2 8 m respectively the mass of the lifeboat is m 7900 kg in sph simulation the lengths of the fluid domain in x y and z directions are 16 m 30 m and 10 m respectively the initial particle spacing is set to be δ x 50 mm as is demonstrated in fig 15 the initial angle between the lifeboat and the free surface is θ 35 the numerical simulation starts from the lifeboat contacting the water surface with the initial velocity v x 0 m s v y 7 m s v z 15 m s snapshots of the water entry of the lifeboat at several typical times are shown in fig 16 it can be found from the figure that the lifeboat causes a severe disturbance in the fluid domain with a large number of water droplets splashed the lifeboat rotates around the centre of gravity while maintaining the translational movement under the impact of the force due to the slamming force of the water the lifeboat does not go deep below the water surface but quickly reaches the maximum sinking position meanwhile the hull rotates to a position parallel to the free water surface gradually and then continues to rotate and surfaces during this process the lifeboat keeps on moving forward leaving away from the water entry position with the movement of the lifeboat the surrounding is squeezed by it gaining great kinetic energy and speed as the lifeboat enters the water further the waves provoked by the hull quickly spread to both sides causing a huge cavity along of the lifeboat moved forward the cavity behind the hull begins to collapse and the ambient water gathered towards the centre due to the collision of the surrounding currents a huge wave was eventually raised behind the boat the resultant force received by the lifeboat in the vertical direction is much greater than that in the horizontal direction see fig 18 this is because the lifeboat has a greater attack speed and bigger area of action in the vertical direction since the lifeboat has a symmetrical structure with respect to the yz plane the resultant force of it in the x axis direction is zero this is also reflected in fig 18 that the resultant force in the x direction obtained by numerical calculation has been stable at zero except for the fluctuations in the beginning fig 19 a shows the velocity of gravity centre of the lifeboat in the process of water entry since the movement of the lifeboat in the horizontal direction is mainly affected by the resistance of the water which is relatively small the overall speed in the horizontal direction shows a slow downward trend however the vertical speed changes greatly as the lifeboat sinks and floats in the vertical direction due to the combined action of gravity and buoyancy the evolution of the position of the gravity centre and rotation around it are given in figs 19 b and 19 c respectively also refer to fig 16 the lifeboat enters the water with a huge impact at the first stage after reaching the maximum depth the lifeboat floats up and then hits the water again this whole process is also accompanied by the pitching motion of the lifeboat to ensure the safe release of the lifeboat the impact pressure load on the structure should be taken into account besides studying the movement characteristics of the lifeboat during water entry the pressure contour of the structure surface during the water entry of the lifeboat at t 0 15 s t 0 6 s t 1 5 s and t 1 65 s are shown in fig 17 the front view and side view are given at each moment with the water adjusted to be transparent at t 0 15 s shortly after the lifeboat hits the water the hull drills into the water at a downward inclination and opens a cavity at this moment the head of the lifeboat is subjected to tremendous attack pressure in addition because the middle part of the bottom of the lifeboat is in direct contact with water at the free surface it has also received a massive impact force at t 0 6 s the lifeboat is submerged in the water and begins to drill out of the water at an upward inclination in this process since the lifeboat is floating the water has less impact pressure on the structure and only a small area of high pressure appears on the head and tail of the bottom at t 1 5 s the head of the lifeboat has been thoroughly exposed to the surface of the water and only the middle and tail parts of the bottom of the boat are in contact with the water owing to the buoyancy of the water on the lifeboat is small it begins to sink again under the action of gravity therefore the front area of the bottom of the lifeboat violently attacks the water surface at t 1 65 s once again leading to intense impact pressure on the surface of the area in contact with the water 4 2 influence of the impact angle on the water entry of the lifeboat to search for the influence of attack angles on the movement characteristics of the lifeboat the water entry cases of the lifeboat with several angles are simulated in this section four different angles are compared namely θ 15 θ 25 θ 35 and θ 45 in all conditions the initial velocity of the lifeboat remains the same according to the previous section the horizontal force is relatively small compared to the vertical force so only the vertical forces during the water entry of the lifeboat with different attack angles are presented see fig 20 the force on the lifeboat from the water is mainly determined by two factors the attack pressure acting on the structure and the area of the attack region in contact with the water as is shown in fig 20 the resultant forces on the lifeboat rapidly rise to the peak after the attack takes place in all four conditions this phenomenon is mainly attracted by the great pressure on the structure when the impact occurs snapshots of the water entry processes of the lifeboat are given in fig 22 it is illustrated that the pressure on the part of the lifeboat touching the water is immense at the initial movement and then decreases gradually as the lifeboat sinks the lifeboat keeps rotating at the same time among all the conditions the lifeboat with a small attack angle is much easier to turn to a horizontal position than that with a big attack angle the volume submerged in water as well as the area of the impact region is relatively bigger at the small angle condition which leads to the second peak of the resultant force in a bigger attack angle condition appears faster see fig 20 the movement characteristics of the lifeboat such as velocity trajectory and rotation are shown in fig 21 in the initial moment the lifeboat suffers a greater resultant force from water under small angle conditions so the vertical velocity drops the faster however the opposite is true in the later stage under large angle conditions the vertical velocity of the lifeboat changes faster the lifeboat plunges deeper into the water as the angle of attack increases see the trajectory of the lifeboat in fig 21 b according to fig 21 c the pitching motion of the lifeboat in different conditions generally tends to be the same but the pitching motion at small angle conditions is smoother 5 conclusion fluid structure interaction is a complex physical problem as a lagrangian meshfree method the sph method has great advantages in simulating fluid structure interaction problems due to the kernel truncation caused by the boundary the solid boundary treatment is one of the primary challenges to be solved for the sph method therefore an improved solid wall boundary treatment is proposed in this paper based on the dummy particles method and the normal flux method the solid boundary is discretized into one layer of particles which participate in the approximation calculation of fluid particles near the boundary the physical quantities of the solid boundary particles are interpolated directly from the surrounding fluid particles like in the dummy particle boundary meanwhile the truncation part of the interpolation domain for the fluid particles is compensated by the boundary integral according to the normal flux method as a common problem in ocean engineering water entry is a typical fluid structure interaction phenomenon several 2d and 3d water entry cases are selected as the benchmark to verify the sph model with the improved solid boundary treatment the selected water entry cases focus on different aspects of water entry including the free surface evolution the characteristic of the impact loads the kinematic performance of the structure and so on the numerical results show that the sph model as well as the solid boundary treatment method is able to simulate the water entry of the rigid body accurately even if the structure has a complex shape due to the convenience of discretizing the structure by just one layer of particles the numerical method employed in this paper can be straightforwardly extended for practical engineering applications the water entry of a lifeboat is simulated centred around the impact force and its motion characteristic further the conditions with different angles of attack are considered for the sake of seeking out the influence of attack angle on the impact forces and motions it is obvious that the lifeboat suffers a greater impact in the small angle condition however the pitch motion of the lifeboat is much smoother when it enters the water at a smaller oblique angle so that it can move forward faster in summary the improved solid boundary treatment method and the sph model used in this paper are capable of dealing with the fluid solid interaction issues with complex boundaries and offering a reliable numerical solution for water entry problems the work in this paper will provide support for the design of offshore structures and assist the rescue at sea credit authorship contribution statement cheng chen software investigation writing original draft a man zhang conceptualization resources data curation jian qiang chen investigation formal analysis yan ming shen writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors are very grateful to a p fu ren ming a p peng nan sun and dr han cheng for their guidance the authors also appreciate the great help of dr yu xiang peng and mr qi zhang this work is supported by the national natural science foundation of china 52088102 51925904 and cardc fundamental and frontier technology research fund 20190233 
20217,water entry problem is common in ocean engineering including complex fluid structure interaction fsi phenomena at the interfaces as a lagrangian and mesh free particle method the smoothed particle hydrodynamics sph method owns great advantages in dealing with fsi problems however solid boundary treatment has always been one of the main issues affecting the accuracy of the sph method through combining the dummy particle boundary and the normal flux method an improved solid boundary treatment technology is proposed in this paper after fully validated by a series of 2d and 3d water entry cases the boundary treatment method is applied to simulate the water entry of a lifeboat the results indicate that the sph model in this paper can provide a reliable numerical prediction for water entry problems with 3d complex geometries keywords water entry fluid structure interaction smoothed particle hydrodynamics solid boundary condition 1 introduction as a complex physical phenomenon fluid structure interaction fsi plays a vital role in science and engineering fields such as ocean engineering biofluid mechanics etc the sph method is a lagrangian meshfree particle method first proposed by gingold and monaghan 1977 and lucy 1977 respectively to solve the problem of astrophysics at this stage the sph method has been widely employed in impact explosion hydrodynamics multiphase flow and fluid structure interaction khayyer et al 2018 peng et al 2021a sun et al 2020 reece et al 2020 sun et al 2021 wang et al 2019 it is determined by the meshfree and particle characteristics of the sph method that it is superior in treating large deformation and moving boundary problems no unique tracking of the coupling interface is required when treating fsi problems with the sph method so it is convenient to apply the boundary conditions at the interface however the development of the sph method is far from mature one of the major obstacles to the application of the sph method in fsi issues is the treatment of solid boundaries due to the truncation of the integration domain the calculation accuracy for particles located near the solid boundary will decrease a lot of efforts have been done to improve the solid boundary treatment technology for decades monaghan 1994 proposed a force based method for boundary conditions when simulating the high speed free surface flow to prevent fluid particles from nonphysically penetrating the solid boundary in his model the solid boundary is described by virtual particles and these virtual particles have repulsive force on surrounding fluid particles it is similar to the lennard jones force in molecular dynamics however the momentum of this method is not conserved and the description of particles adjacent to the boundary does not match the actual situation rogers and dalrymple 2008 put forward an improved repulsive force model to simulate tsunami the repulsive force is associated with the normal direction of the boundary the relative positions between fluid particles and structure particles and the fluid particles normal velocities considering the numerical error caused by the truncation of boundary integral term for particles surrounding the solid boundary de leffe et al 2009 introduced the normal flux method in finite volume method fvm into the sph method the boundary force is derived and added to approximate equations directly colagrossi and landrini 2003 used ghost particles to mimic the solid boundary at each step particles in the boundary layer are mirrored into the interior of the structure so that the ghost particles have the same density velocity and pressure as neighbouring fluid particles a modified boundary method is proposed by marrone et al 2011 in which the boundary is discretized into several layers of fixed ghost particles a series of interpolation points are generated by mirroring the fixed ghost particles into the fluid field the physical quantities of the fixed particles can be obtained through these interpolation points in turns adami et al 2012 advanced another virtual particle model called dummy particles to impose solid boundary conditions different from fixed ghost particles the physical quantities of dummy particles are interpolated directly from the surrounding fluid particles chen et al 2017 presented a corrected solid boundary treatment method in order to overcome the unphysical oscillations of pressure distribution and improve numerical stability repulsive force models have strong operability so they can flexibly deal with complicated geometric models however it cannot accurately solve boundary defects since the magnitude of the force is strongly dependent on the empirical parameters on the opposite the virtual particle methods are able to overcome the truncation of the boundary still they are difficult to deal with three dimensional complex geometric models especially complex models with large curvatures in order to avoid the unphysical penetration of fluid particles and improve the calculation accuracy a coupled boundary treatment method was proposed by liu et al 2012 based on the advantages and disadvantages of repulsive force models and virtual particle models however it is still difficult to discrete the solid boundary with complex geometry due to multiple layers of ghost particles required similar to liu et al 2012 an improved solid boundary treatment method is proposed which only arranges one layer of particles on the solid boundary it is obviously that the current method is easy to implement for complex solid boundaries the water entry problem is a typical fsi problem including intricate physical phenomena a lot of research has been done on water entry focusing on the significant parameters and characteristics during the water entry process such as impact force pressure distribution and evolution of the free surface et al cheng et al 2019 shao 2009 zhang et al 2021 a robust sph algorithm is established in sun et al 2015 to solve the water entry problem meng et al 2021 take care of the air effect in typical water entry problems with a riemann sph model the cavity evolution of the water entry of a sphere is studied in zhao et al 2021 based on the increased computational efficiency using adaptive particle refinement apr method as well as cell linked list technology in this paper the improved solid boundary treatment technology is presented and validated by several representative water entry cases given that this paper is dedicated to verifying the reliability of the proposed solid boundary treatment method the structural dynamic response is ignored the content of this paper is arranged as follows the second section introduces the basic theory of the sph method and some numerical techniques adopted in the current sph model besides the improved boundary treatment technique is illustrated at great length then in the third section the newly proposed method is validated by 2d and 3d water entry cases respectively based on sufficient verification the improved boundary treatment technology is extended to practical application to simulate the water entry of a lifeboat the numerical solutions are given and discussed in detail in the fourth section the summary is made in the last section 2 the present numerical model 2 1 governing equations for water entry problems in this paper the viscous force can be ignored cheng et al 2020 unless specially specified so the mass equation and the momentum conservation equation based on the lagrangian view can be written as follows 1 d ρ d t ρ v 2 d v d t 1 ρ p g where ρ represents density p denotes pressure v is velocity and g is the gravitational acceleration for the sake of describing the relationship between pressure and density it is necessary to use the state equation in the weakly compressible smoothed particle hydrodynamics wcsph method monaghan 1994 which reads 3 p c 0 2 ρ 0 7 ρ ρ 0 7 1 where c 0 and ρ 0 denote the artificial sound speed and the reference density of fluid particles the given reference density in this paper is ρ 0 1000 kg m 3 according to sun et al 2015 the artificial sound speed is usually chosen by the formula below 4 v max 2 c 0 2 g h c 0 2 0 01 where v max and h refer to the maximum velocity of the fluid domain and the initial fluid depth respectively it is guaranteed that the mach number is less than 0 1 which satisfies the weakly compressible hypothesis while a massive time step is obtained however to simplify the calculation c 0 can be set as a constant sun et al 2018 in the present work as 5 c 0 10 max g h v e n t r y where v e n t r y is the initial velocity of the structure when reaching the free surface by means of the sph approximation algorithm liu and liu 2010 2003 the basic sph equation can be written as follows 6 f x i j m j ρ j f x j w x i x j h i f x i j m j ρ j f x j f x i i w x i x j h i f x i j m j ρ j f x j f x i i w x i x j h where the subscript j represents surrounding particles within the supported field of the concerned particle i m represents the mass of particles according to the approximation method above the discretized form of continuity and momentum equations can be obtained 7 d ρ i d t ρ i j v i v j i w x i x j h m j ρ j 8 d v i d t j m j p i p j ρ i ρ j i w x i x j h g in this paper the modified gaussian kernel function developed by grenier et al 2009 is adopted 2 2 δ sph scheme and artificial viscosity for purpose of reducing the pressure noise and enhancing the stability as well as the accuracy of the current sph method an artificial density diffusion term molteni and colagrossi 2009 and an artificial viscosity term monaghan and gingold 1983 are added to continuity equation and momentum equation respectively so eqs 7 and 8 are modified as follows 9 d ρ i d t ρ i j v i v j i w x i x j h m j ρ j δ h c 0 j ψ i j i w x i x j h m j ρ j 10 d v i d t j m j p i p j ρ i ρ j i w x i x j h g α h c 0 ρ 0 ρ i j π i j i w x i x j h m j ρ j 11 ψ i j ρ i ρ j x i x j x i x j 2 0 01 h 2 π i j v i v j x i x j x i x j 2 0 01 h 2 where δ and α denote the coefficient of the artificial density term and the artificial viscosity term respectively the values of these two coefficients in this paper are both equal to 0 1 2 3 improved boundary condition an improved boundary condition treatment method is put forward by means of coupling the dummy particle boundary treatment method adami et al 2012 with the normal flux method de leffe et al 2009 to avoid the truncation of the sph method at the fluid solid interface as is shown in fig 1 the boundary of structure is discretized into just one layer of particles for each structure particle j an integration point k and a normal unit vector n k are generated on the inner surface of it with regard to calculating the gradient of the fluid particles surrounding the structure a surface term must be non negligible which is employed to impose the boundary condition in the work of de leffe et al 2009 so the integration of the particles nearby the interface is as follows peng et al 2021b 12 x f x ω f x w x x h n d s ω f x x w x x h d x the integration points k are considered to provide the integral boundary for the surface integral term and the structure particles are treated as dummy particles therefore eq 12 can be converted into 13 f x i j b f m j ρ j f x j i w x i x j h k k f x k w x i x k h n k s k where the subscript b subscript f and subscript k denote boundary particles fluid particles and integration points respectively s k is the area of the integration point k attached to the structure particle similar to the previous sections the continuity and momentum equations for fluid particles near the interface can be obtained 14 d ρ i d t ρ i j b f v i v j i w x i x j h m j ρ j ρ i k k v i v k n k w x i x k h s k 15 d v i d t j b f m j p i p j ρ i ρ j i w x i x j h ρ i 1 k k p i p k n k w x i x k h s k g the pressure of point k is treated as equal to the pressure of the structure particle to which it attached through interpolation of the pressure of surrounding fluid particles adami et al 2012 the pressure of structure particles is calculated 16 p b f f p f w x f x b h f f ρ f g a b x b x w w x f x b h f f w x f x b h where subscript b and f denote boundary particles and fluid particles the density and mass of boundary particles are calculated via the formulas below 17 ρ b ρ 0 7 p b c 0 2 ρ 0 1 7 18 m b ρ b v b the motion of a rigid body includes the translational motion and the rotational motion by the following formula in adami et al 2012 the equations of the momentum as well as the moment momentum of the rigid body can be obtained 19 d u c d t f f s m g 20 d ω c d t t f s i where u c ω c f f s and t f s refer to translational velocity rotational velocity the resultant force and resultant moment acting on the rigid body respectively m and i denote the mass and the moment of inertial of the centroid c f f s and t f s are able to be taken by the following formulas 21 f f s f f b b m b m f p f p b ρ f ρ b i w x f x b h ρ f 1 p f p k n k w x f x k h s k 22 t f s f f b b m b r b r c m f p f p b ρ f ρ b i w x f x b h ρ f 1 p f p k n k w x f x k h s k after updating the translational velocity u c and angular velocity ω c by eqs 19 and 20 it is in a position to gain the velocity of boundary particles following the formula below 23 v b u c ω c r b r c where r b and r c are the position vectors of boundary particles and the centroid of the rigid body respectively 3 numerical validations 3 1 2d wedges with different oblique angles in this section the water entry case of a wedge is selected as a numerical verification benchmark and the sph results are compared with the bem solution and the experimental data zhao et al 1996 the width of the wedge is b 0 5 m and the dead rise angle of it is θ 30 see fig 2 the mass of the wedge is m 72 5 kg there are five pressure measuring points on one side of the wedge which are named as p 1 p 5 in the numerical model of the current sph method the depth and the width of the water domain are d 1 5 m and w 3 m respectively in the experiment the wedge impacts water surface with a measured velocity v 0 6 15 m s to reduce the nonphysical reflection of pressure the non reflecting boundary condition is applied gong et al 2009 the convergence of the present sph model is checked on via three different particle resolutions in this part δ x 0 0048 m δ x 0 0024 m δ x 0 0012 m as the particle spacing minis the resultant force on wedge converges see fig 3 the pressure distribution on the wedge is obtained by 24 p b f f l u i d p f w b f f f l u i d w b f where the subscript f and subscript b respectively represent fluid particles and boundary particles as is shown in fig 3 the vertical force obtained by the three methods mentioned is congruent with each other generally especially in the early stages the distribution of the pressure acting on one side of the wedge obtained by the current sph model is contrasted with the work of gong et al 2009 and zhao et al 1996 and they share the same distribution law see fig 5 0 t v t d t in the figure means the height of immersion while z d and z k denote the vertical coordinates of the upper and lower endpoints however both of the numerical results by the bem and the sph method are gradually larger than the experimental data in the late period which is most likely caused by the three dimensional flow effect at both ends of the wedge in the experiment the pressure of the fluid surrounding the wedge at t 15 ms is shown in fig 4 it is illustrated that the area of high pressure appears at the point of separation between the wedge and the free surface in addition the pressure distribution shows a decreasing trend from the separation region to the bottom of the wedge which can be found more clearly in figs 5 a and 5 b in order to further verify the oblique impact overload and the rotational movement of structure another water entry case of a wedge with an inclination angle is simulated as is shown in fig 6 the geometric and inertial parameters of the wedge have been given at the initial moment the wedge falls freely at an inclination angle of 5 from 0 61 m above the free surface the time history curves of the vertical acceleration and angular acceleration during the water entry process of the wedge are shown in fig 7 the current sph results are highly consistent with the experimental results xu et al 1999 the evolution of the free surface and the pressure distribution during the water entry of the wedge are given in fig 8 it is obviously that the jet flow and pressure distribution generated by the attack are asymmetric in the early stage of the water entry the local high pressure area formed on the left side of the wedge is greater than that on the right side resulting in a clockwise angular acceleration of the wedge with the wedge going deeper the pressure on the right side of the wedge is greater than that on the left which is the opposite of the previous period at the late stage of the water entry the wedge is completely immersed below the free surface the attack pressure on both sides of the wedge approaches the hydrostatic pressure so the wedge no longer rotates significantly 3 2 2d floating body with complex geometry a water entry case of a floating body with complex 2d geometry falling into water was adopted to verify the sph algorithm in bouscasse et al 2013 in this section the same body used is shown in fig 9 a the body surface of which has twelve sharp corners connected by smooth curves the centre of gravity g is located in the upper left corner of the geometry and the coordinate of it is 0 2683 l 0 4352 l the mass of the body is given by m 0 1483 ρ l 2 and the moment of inertia with regard to g is i g 0 01 ρ l 4 ρ denotes the density of water the reynolds number is set to be re 2000 so that the viscosity υ l g l re can be determined for this case the real viscosity of the fluid is considered through the formula equivalent to the artificial viscosity proposed by monaghan and gingold 1983 the specific form of viscosity force f i v is as follows 25 f i v k μ j π i j w i j m j ρ j in the above equation k 2 d 2 where d denotes the number of dimension in this section the real physical viscosity is adopted in the interior of the fluid domain while particles belong to the free surface the artificial viscosity is exerted together with real viscosity in order to avoid numerical instability caused by rolling waves finally the viscosity force for free surface particles is determined by sun et al 2019 26 f i v k μ α c 0 h ρ 0 j π i j w i j m j ρ j according to marrone et al 2011 and yang and kong 2018 the artificial viscosity coefficient here is α 0 02 in bouscasse et al 2013 the only stable equilibrium state is obtained by a semi analytical solution the hydrostatic pressure is integrated along the surface to get the buoyancy force of the floating body then through iterative computations the couple θ g and y g l when buoyancy and gravity are in balance is picked up in term of the reference the values obtained are θ g 97 7 and y g l 0 5098 l snapshots in fig 9 show us the water entry process of the complex floating body it is evident that the body drops and rolls quickly at the beginning under the action of unbalanced gravity and buoyancy causing a disturbance in the fluid domain because of the viscosity the motion of fluid stops gradually then the body reaches a stable equilibrium state in turns as is shown in fig 10 the sph model adopted in this paper is capable of achieving the accurate position of gravity g and the rotation around it while the floating body is stationary 3 3 3d bow specimen for the purpose of fully verifying the numerical model in this paper water entry of the specimen in jalalisendi et al 2015 is simulated the specimen used in the experiment is illustrated in fig 11 a and dimensions of the bow in x y and z directions are l 20 cm b 16 cm and h 5 6 cm respectively as is shown in the figure that a cartesian coordinate system is fixed on the model with the origin of it located at the lowest point of the model the x axis as well as the y axis is placed along the width and height of the model respectively it is evident that the radius of curvature r and the dead rise β of the model change in both x and z directions at the same time to adapt to the shape of the bow a series of the cross section profiles of the model along the z axis at intervals of 1 cm are shown in fig 11 b from z 0 cm to z 10 cm because the model is symmetrical only the outline in the first quadrant is given in the figure in the experiment the specimen dropped straitly due to the constraint of rails the initial velocity of the bow once reaching the water surface is v 0 2 98 m s and the total mass of the specimen is m 0 601 kg as is demonstrated in fig 12 the movement of the specimen over time obtained by the sph method matches the experimental result well the evolution of the free surface during the water entry of the 3d bow is given in fig 13 from which we can find that the water is displaced and some jets are generated under the action of the structure in order to better describe the movement of the water field the velocity vectors of water on xy plane and yz plane are shown in fig 14 it is clear that the water near the structure obtains kinetic energy from the structure and transmits it to the distance it can be seen from the velocity vectors of the flow field that the general motion law of the flow field on the xy plane and the yz plane tends to be the same but the splash caused by structure on the xy plane is obviously more extensive than that on the yz plane the discrepancy may be on account of the different radius of curvature in two directions 4 study on the water entry of lifeboat 4 1 study on the motion of the lifeboat with an impact angle a lifeboat is a vital facility that every ship must be equipped with and is a tool for the crew to escape when an accident occurs the fully enclosed lifeboat is usually placed on the stern sliding gear when released the lifeboat slides down the slope and makes a parabolic motion in the air before it reaches the water surface the horizontal velocity of the lifeboat is constant while the vertical speed is uniformly accelerated under gravity after the lifeboat hits the water surface at a certain angle and velocity it triggers a violent fluid solid interaction phenomenon meanwhile the lifeboat is suffered from a great attack force which has a very important impact on its structural safety and movement posture the water entry of a lifeboat is considered in this section the 3d model of which is shown in fig 15 the sizes of the lifeboat in x y and z directions are 1 5 m 8 5 m and 2 8 m respectively the mass of the lifeboat is m 7900 kg in sph simulation the lengths of the fluid domain in x y and z directions are 16 m 30 m and 10 m respectively the initial particle spacing is set to be δ x 50 mm as is demonstrated in fig 15 the initial angle between the lifeboat and the free surface is θ 35 the numerical simulation starts from the lifeboat contacting the water surface with the initial velocity v x 0 m s v y 7 m s v z 15 m s snapshots of the water entry of the lifeboat at several typical times are shown in fig 16 it can be found from the figure that the lifeboat causes a severe disturbance in the fluid domain with a large number of water droplets splashed the lifeboat rotates around the centre of gravity while maintaining the translational movement under the impact of the force due to the slamming force of the water the lifeboat does not go deep below the water surface but quickly reaches the maximum sinking position meanwhile the hull rotates to a position parallel to the free water surface gradually and then continues to rotate and surfaces during this process the lifeboat keeps on moving forward leaving away from the water entry position with the movement of the lifeboat the surrounding is squeezed by it gaining great kinetic energy and speed as the lifeboat enters the water further the waves provoked by the hull quickly spread to both sides causing a huge cavity along of the lifeboat moved forward the cavity behind the hull begins to collapse and the ambient water gathered towards the centre due to the collision of the surrounding currents a huge wave was eventually raised behind the boat the resultant force received by the lifeboat in the vertical direction is much greater than that in the horizontal direction see fig 18 this is because the lifeboat has a greater attack speed and bigger area of action in the vertical direction since the lifeboat has a symmetrical structure with respect to the yz plane the resultant force of it in the x axis direction is zero this is also reflected in fig 18 that the resultant force in the x direction obtained by numerical calculation has been stable at zero except for the fluctuations in the beginning fig 19 a shows the velocity of gravity centre of the lifeboat in the process of water entry since the movement of the lifeboat in the horizontal direction is mainly affected by the resistance of the water which is relatively small the overall speed in the horizontal direction shows a slow downward trend however the vertical speed changes greatly as the lifeboat sinks and floats in the vertical direction due to the combined action of gravity and buoyancy the evolution of the position of the gravity centre and rotation around it are given in figs 19 b and 19 c respectively also refer to fig 16 the lifeboat enters the water with a huge impact at the first stage after reaching the maximum depth the lifeboat floats up and then hits the water again this whole process is also accompanied by the pitching motion of the lifeboat to ensure the safe release of the lifeboat the impact pressure load on the structure should be taken into account besides studying the movement characteristics of the lifeboat during water entry the pressure contour of the structure surface during the water entry of the lifeboat at t 0 15 s t 0 6 s t 1 5 s and t 1 65 s are shown in fig 17 the front view and side view are given at each moment with the water adjusted to be transparent at t 0 15 s shortly after the lifeboat hits the water the hull drills into the water at a downward inclination and opens a cavity at this moment the head of the lifeboat is subjected to tremendous attack pressure in addition because the middle part of the bottom of the lifeboat is in direct contact with water at the free surface it has also received a massive impact force at t 0 6 s the lifeboat is submerged in the water and begins to drill out of the water at an upward inclination in this process since the lifeboat is floating the water has less impact pressure on the structure and only a small area of high pressure appears on the head and tail of the bottom at t 1 5 s the head of the lifeboat has been thoroughly exposed to the surface of the water and only the middle and tail parts of the bottom of the boat are in contact with the water owing to the buoyancy of the water on the lifeboat is small it begins to sink again under the action of gravity therefore the front area of the bottom of the lifeboat violently attacks the water surface at t 1 65 s once again leading to intense impact pressure on the surface of the area in contact with the water 4 2 influence of the impact angle on the water entry of the lifeboat to search for the influence of attack angles on the movement characteristics of the lifeboat the water entry cases of the lifeboat with several angles are simulated in this section four different angles are compared namely θ 15 θ 25 θ 35 and θ 45 in all conditions the initial velocity of the lifeboat remains the same according to the previous section the horizontal force is relatively small compared to the vertical force so only the vertical forces during the water entry of the lifeboat with different attack angles are presented see fig 20 the force on the lifeboat from the water is mainly determined by two factors the attack pressure acting on the structure and the area of the attack region in contact with the water as is shown in fig 20 the resultant forces on the lifeboat rapidly rise to the peak after the attack takes place in all four conditions this phenomenon is mainly attracted by the great pressure on the structure when the impact occurs snapshots of the water entry processes of the lifeboat are given in fig 22 it is illustrated that the pressure on the part of the lifeboat touching the water is immense at the initial movement and then decreases gradually as the lifeboat sinks the lifeboat keeps rotating at the same time among all the conditions the lifeboat with a small attack angle is much easier to turn to a horizontal position than that with a big attack angle the volume submerged in water as well as the area of the impact region is relatively bigger at the small angle condition which leads to the second peak of the resultant force in a bigger attack angle condition appears faster see fig 20 the movement characteristics of the lifeboat such as velocity trajectory and rotation are shown in fig 21 in the initial moment the lifeboat suffers a greater resultant force from water under small angle conditions so the vertical velocity drops the faster however the opposite is true in the later stage under large angle conditions the vertical velocity of the lifeboat changes faster the lifeboat plunges deeper into the water as the angle of attack increases see the trajectory of the lifeboat in fig 21 b according to fig 21 c the pitching motion of the lifeboat in different conditions generally tends to be the same but the pitching motion at small angle conditions is smoother 5 conclusion fluid structure interaction is a complex physical problem as a lagrangian meshfree method the sph method has great advantages in simulating fluid structure interaction problems due to the kernel truncation caused by the boundary the solid boundary treatment is one of the primary challenges to be solved for the sph method therefore an improved solid wall boundary treatment is proposed in this paper based on the dummy particles method and the normal flux method the solid boundary is discretized into one layer of particles which participate in the approximation calculation of fluid particles near the boundary the physical quantities of the solid boundary particles are interpolated directly from the surrounding fluid particles like in the dummy particle boundary meanwhile the truncation part of the interpolation domain for the fluid particles is compensated by the boundary integral according to the normal flux method as a common problem in ocean engineering water entry is a typical fluid structure interaction phenomenon several 2d and 3d water entry cases are selected as the benchmark to verify the sph model with the improved solid boundary treatment the selected water entry cases focus on different aspects of water entry including the free surface evolution the characteristic of the impact loads the kinematic performance of the structure and so on the numerical results show that the sph model as well as the solid boundary treatment method is able to simulate the water entry of the rigid body accurately even if the structure has a complex shape due to the convenience of discretizing the structure by just one layer of particles the numerical method employed in this paper can be straightforwardly extended for practical engineering applications the water entry of a lifeboat is simulated centred around the impact force and its motion characteristic further the conditions with different angles of attack are considered for the sake of seeking out the influence of attack angle on the impact forces and motions it is obvious that the lifeboat suffers a greater impact in the small angle condition however the pitch motion of the lifeboat is much smoother when it enters the water at a smaller oblique angle so that it can move forward faster in summary the improved solid boundary treatment method and the sph model used in this paper are capable of dealing with the fluid solid interaction issues with complex boundaries and offering a reliable numerical solution for water entry problems the work in this paper will provide support for the design of offshore structures and assist the rescue at sea credit authorship contribution statement cheng chen software investigation writing original draft a man zhang conceptualization resources data curation jian qiang chen investigation formal analysis yan ming shen writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors are very grateful to a p fu ren ming a p peng nan sun and dr han cheng for their guidance the authors also appreciate the great help of dr yu xiang peng and mr qi zhang this work is supported by the national natural science foundation of china 52088102 51925904 and cardc fundamental and frontier technology research fund 20190233 
20218,characteristics of flow around four cylinders of various shapes in the square configuration were numerically investigated using a vortex in cell method the flow patterns drastically depend on the cylinder geometry such as equilateral triangle square regular hexagon and circle in the cases of left right and up down triangles the vortices are synchronously shed from the cylinders the fluctuations of drag c d and lift c l coefficients exerted on these cylinders are also synchronous the magnitudes of these fluctuations of left triangles are small while those of right and up down triangles are greater in the cases of circles and squares rotated 45 degrees the vortices shed from the cylinders are nearly synchronous and the fluctuations of c d and c l are of a higher magnitude in the cases of down up triangles unrotated squares and regular hexagons the flow instability was investigated in a range of reynolds numbers from 65 to 300 and the flow patterns are classified into steady notrolling twostreets rolling twostreets notrolling merging and rolling merging the fluctuations of c d and c l exerted on these cylinders are non synchronous and of a strong magnitude the lowest frequency of the vortex shedding was noticed in cases of down up triangles and unrotated squares in which the fatigue of the cylinder cluster is highly remarkable the two most optimal geometries of the cylinder are circle and square rotated 45 degrees keywords viscous flow flow pattern vortex shedding flow around cylinder cluster vortex in cell method immersed boundary method 1 introduction flow over a cluster of cylinders is observed widely in engineering applications such as offshore oil platforms riser pipes floating structures bridge piers tube heat exchanger devices and electrical power cables nicolle and eames 2011 characteristics of this flow are the separation and reattachment of the boundary layers wake interactions vortex breakdown and merging vortex induced vibration and fluctuating fluid forces acting on solid obstacles they cause problems of structural fatigue corrosion and resonance that lead to system damage therefore a comprehensive understanding of these features is essential to improving design and controlling related structures this aspect has attracted the interest of experimental and numerical researchers in this topic for a few decades flow around two cylinders has been studied extensively because it provides fundamental mechanisms of flow interference thomas and kraus 1964 pioneered in research of the wake interactions in which they clarified the contraction expansion and cancellation of laminar wakes generated from a pair of circular cylinders in the tandem and side by side arrangements at different reynolds numbers r e where r e u d ν u d and ν are the upstream velocity cylinder diameter and kinematic viscosity respectively these cylinders do not generate the turbulence of flow but many periodic phenomena the wake interference effects in the case of the tandem arrangement are more robust than those with the side by side one this research work provides a view on some specific flow phenomena but does not give a detailed analysis of flow bearman and wadcock 1973 conducted an experimental study of the flow around these cylinders at r e 2 5 1 0 4 and observed the flow instability with the cylinder gap in the range from 0 1 to one diameter two streets of the vortex structure are formed with the gap being greater than one diameter while only one street was detected when the cylinders nearly touch each other this study lacks qualitative evidence to confirm the observed such as the drag lift acting on the cylinders and the vortex shedding frequency zdravkovich 1977 reviewed this problem and classified the flow pattern into coupled vortex streets bistable flow single vortex street for the side by side configuration and single slender body alternate reattachment intermittent shedding and two vortex streets for the tandem configuration igarashi 1986 conducted an experimental investigation of the characteristics of flow over four tandem circular cylinders at r e in the range of 1 3 1 6 1 0 4 and found five flow patterns based on the reattachment of shear layers on the second third and fourth cylinders and the rolling up of shear layers before these cylinders such as w w w w r r r r r r r j and r j j where w r and j denotes the without reattachment reattachment and rolling up respectively sewatkar et al 2012 clarified the characteristics of flow around six tandem square cylinders at r e 100 and they showed synchronous s y chaotic c h and a pair of quasi periodic q p 1 q p 2 regimes the q p 2 and c h regimes are caused by the wake interaction effects of the upstream cylinders while the s y regime occurs because of the formation of a single body wake behind all the cylinders when they are placed close together the q p 1 regime is the combination of the q p 2 and s y regimes the shedding frequency is nearly the same for all cylinders particularly for q p 1 and s y regimes these four regimes are also observed in the case of flow over a group of four circular cylinders in the side by side arrangement at r e 100 by awale 2014 wu 2017 numerically studied the flow over two and three cylinders in several configurations such as side by side tandem and triple cylinder arrangement with a spacing ratio s r of 3 utilizing the second order boundary free immersed boundary method the synchronous karman vortex streets were declared in the side by side arrangement while the symmetric feature of vortex shedding was determined in the case of the triple cylinder arrangement flow around a group of cylinders has been a subject of interest to researchers in recent years nicolle and eames 2011 indicated three flow patterns in the case of the flow over a circular cluster of circular cylinders from 7 to 133 cylinders at r e 100 at high spacing each cylinder has an individual wake where each wake is dissolved by other wakes downstream as explained in the work by thomas and kraus 1964 and the forces are determined as those of an isolated cylinder at intermediate spacing shear layers separate at two sides of the array and forces are steady at low spacing the cylinder cluster produces a wake similar to that generated from a solid obstacle zhao et al 2015 simulated the flow around a square array of circular cylinders 36 cylinders in an inline arrangement and 33 cylinders in a staggered arrangement at r e 100 and they also showed three flow patterns as observed in the circular cluster case nicolle and eames 2011 the critical value of s r for the single body wake pattern in the inline arrangement is lower than that in the staggered arrangement besides the flow induced vibration of these cylinders is investigated and the cylinders at the most downstream column have the maximum vibration amplitudes chatterjee and biswas 2015 investigated the flow around two columns of square cylinders 6 cylinders for each column in a staggered arrangement with a change of vertical spacing at r e 100 at large spacing vortex sheddings from these cylinders are antiphase and the vortices exist at large downstream distances at medium spacing the in phase antiphase shedding occurs while a flip flopping regime appears at small gaps the characteristics of these regimes are parallel to those observed in the case of two side by side cylinders zdravkovich 1977 moreover the flow around four cylinders has been greatly concerned because it is found in various engineering applications islam et al 2009 numerically investigated the laminar flow around four rectangular cylinders in the rectangular arrangement at r e 100 and showed single square cylinder stable and wiggling shielding and vortex shedding flow patterns with the spacing change han et al 2013 zhang et al 2013 abbasi et al 2014 and gao et al 2017 investigated the characteristics of laminar flows around four cylinders in various arrangements the flow is characterized by shielding reattachment of laminar shear layers and vortex impinging regimes in the square configuration in the diamond configuration three flow patterns are observed as non synchronous quasi periodic and synchronous ren et al 2019 numerically investigated wavy flow around four circular cylinders in the diamond arrangement for semi underwater pile columns of floating or fixed platforms at r e in the range of 40 230 they also found three flow types such as synchronous quasi periodic and non synchronous using the keulegan carpenter k c number and r e the synchronous flows were declared depending on small values of k c and r e and small s r s while the quasi periodic flow regimes are influenced by length scales of individual and cluster cylinders liu et al 2015 conducted an experimental study on the effect of s r s and angles of incidence from 0 degree to 45 degree on the complex flow over a group of four square and circular cylinders arranged in a diamond configuration at r e 4 58 1 0 4 they pointed out that the upstream cylinder s vortex interaction causes the small mean drag and higher fluctuating forces acting on downstream cylinders tong et al 2014 numerically studied vortex shedding and spanwise vortices of flow around four circular cylinders clustered in a square configuration they identified four wake flow regimes with complex vortex structures in the ranges of r e such as weak spanwise and weak streamwise vortices 100 r e 220 regular wavy spanwise and rib shaped streamwise vortices 240 r e 300 severe vortex dislocations 320 r e 380 and strong streamwise vortices 400 r e 500 although a large amount of work has been dedicated to extending the knowledge of the characteristics of the flow around four cylinders this flow type has not been fully clarified the unknown features of this flow are as follows 1 the effects of body geometry on the flow characteristics such as flow patterns vortex shedding wake interaction and fluid force exerted on the bodies and 2 the most optimal geometry of the cylinder under consideration of the fatigue and corrosion of the structural system therefore this study will shine some light on the problem of the flow over four cylinders of various shapes in the square configuration employing a vortex in cell method the employed cylinder geometry is equilateral triangle square regular hexagon and circle with s r 3 this s r has been utilized in many offshore applications such as anger kizoba magnolia tension based tension leg platforms with s r s ranging from 2 5 to 2 8 wilhoit and supan 2010 nagan 2010 moreover the reason s r 3 adopted in this work is that among three s r s experimentally reported by lam and cheung 1988 the s r 3 corresponds to highly changeable flow interference between the cylinders otherwise the cylinder cluster is considered as a single cylinder s r 1 43 or the flow interference is negligibly small s r 4 65 the vortex in cell method is a well known hybrid approach combining eulerian and lagrangian descriptions of fluid flow known as a remeshed vortex particle method widely used to investigate the viscous incompressible flows around the solid obstacles cottet and koumoutsakos 2000 winckelmens and leonard 1993 cottet and poncet 2002 nguyen et al 2019d in particular it uses the lagrangian reference frame to describe the fluid flow and the grid based formula to solve the velocity and flow momentum in the lagrangian description the fluid is discretized into vortex particles or elements characterized by their positions velocities and flow quantities such as the vorticity circulation and flow momentum using this lagrangian description takes the most advantages of the mesh free methods first the simulation requires no mesh therefore it evades the high cost in mesh generation and mesh distortion issues second the simulation has negligible dissipation errors because of solving the convection term in the linear form it also allows us to choose a more massive time step compared to the traditional grid based methods for simulations with the satisfaction of the method stability because it is not constrained by the courant friedrichs lewy condition after the vortex convection the vortex particles at the lagrangian locations are redistributed onto the regular grid with ensuring the flow momentum conservation this redistribution on the eulerian grid resolves the lagrangian distribution distortion problems of vortex particles overlap issues in the vortex methods the computational cost in calculations of the flow momentum and the velocity field considerably reduces using grid based schemes for example in the vortex method the vortex particle velocities representing the velocity field are gained using the integral biot savart formula with o n p 2 computing operations n body problem where n p is the particle number this computational cost will decrease remarkably as the velocity field is gained by solving the poisson equation using the fourier method implemented by employing the fast fourier transform algorithm with o n p log n p operations furthermore the usage of the grid based formula supports a combination of this method with an immersed boundary method introduced by peskin 1972 to treat the no slip condition of the flow on the solid body surfaces therefore the hybrid eulerian lagrangian approach takes many benefits it can be stated that the vortex in cell method inherits the advantages of both the mesh based and mesh free methods and restricts their drawbacks the vortex in cell method was proposed by birdsall and fuss 1969 to solve two dimensional plasma problems in plasma physics and later it was adapted to simulate two dimensional inviscid incompressible flows by christiansen 1973 subsequently cottet and koumoutsakos 2000 altered it to simulate two and three dimensional viscous incompressible flows coquerelle and cottet 2008 combined it with the penalization method a type of continuous forcing immersed boundary method to model the complex flow around solid obstacles the method capability to capture the characteristics of flows around two tandem cylinders was proved by nguyen et al 2016 this method continued to be developed for simulations of the particle laden two phase flows by walther and koumoutsakos 2001 the bubbly flows by nguyen et al 2019a b c vortex wall interactions by nguyen et al 2019d and turbulent flows by nguyen and duong 2021 nguyen et al 2021 and duong et al 2021 in this study we employed the vortex in cell method to characterize the flow over four cylinders of various shapes the method is validated using simulations of the flow around a single circular cylinder at r e 100 and 200 and the flow around two side by side circular cylinders with their various s r s from 1 5 to 4 at r e 200 the flow around four cylinders in right triangle left triangle up down triangles down up triangles unrotated square square rotated 45 degree regular hexagon and circle as sketched at the beginning of section 4 2 is investigated at r e 200 we clarify the flow pattern using the plots of vorticity contours and analyze time history time average root mean square of drag lift coefficients exerted on the cylinders for each pattern to achieve the most optimal shape an analysis of the energy spectrum of the drag coefficient is given to further clarify the vortex shedding from the cylinders moreover the effects of r e on the flow instability in the cases of the down up triangles squares and hexagons are investigated using simulations at various r e s from 65 to 300 the remainder of this paper is organized as follows the governing equations and vortex in cell method are expressed in section 2 the penalization method and numerical procedure are presented in section 3 the results are discussed in section 4 followed by the conclusions in section 5 2 governing equations and vortex in cell method the continuity and momentum navier stokes equations in velocity pressure form for incompressible viscous fluid flow are respectively expressed as follows 1 u 0 2 u t u u 1 ρ p ν 2 u g where coordinate x velocity field u time t fluid density ρ pressure p kinematics viscosity ν and gravitational acceleration g the velocity vorticity form of the flow momentum equation is obtained by taking the curl on sides of eq 2 as 3 ω t u ω ν 2 ω ω u where the vorticity is expressed as ω u in two dimensional simulation x x y u u v ω ω z k and the second term on the right of eq 3 vortex stretching does not exist therefore eq 3 is rewritten as 4 ω t u ω ν 2 ω in the vortex in cell method the fluid is discretized into the vortex particles that move at the local flow velocity and transport the flow momentum eq 4 is written in the lagrangian reference frame of the vortex particles p transporting the vorticity ω x p as 5 d ω x p d t ν 2 ω x p 6 d x p d t u x p where the particle velocity u x p is the flow velocity field u at their positions x p the velocity field is obtained from the helmholtz decomposition as 7 u ϕ ψ where the first and second terms on the right of eq 7 represent the irrotational and solenoidal vector fields respectively the vector ψ and scalar ϕ potentials of the velocity are gained solving the poisson equation derived taking the curl on sides of eq 7 and laplace equation obtained substituting eq 7 into eq 1 respectively as 8 2 ψ ω 9 2 ϕ 0 the vortex particles are initially positioned on the regular grid and their vorticities ω x p are updated using eq 5 to consider the diffusion of vortices due to the fluid viscosity these vortices convect to the lagrangian locations x p using eq 6 and they are then redistributed onto the eulerian grid their vorticities at the grid x q are obtained by interpolating from those at the lagrangian locations x p as 10 ω x q p n p ω x p w x q x p δ x w y q y p δ y where x q x q y q is the grid location x p x p y p is the lagrangian location δ x and δ y are grid cell sizes n p is particle number and w x is the kernel interpolation function introduced by monaghan 1985 for the smoothed particle hydrodynamics applications and employed by cottet and koumoutsakos 2000 for the lagrangian vortex methods as 11 w x 1 5 2 x 2 3 2 x 3 if x 1 1 2 2 x 2 1 x if 1 x 2 0 if x 2 the redistribution using this interpolation function guarantees the first three flow momentum conservation walther and koumoutsakos 2001 3 penalization method a penalization method combined with the velocity pressure formula to enforce the no slip condition for the viscous fluid flow on the solid body surface was introduced by angot et al 1999 and fadlun et al 2000 this method was integrated into the vorticity velocity formula by kevlahan and ghidaglia 2001 and then the vortex in cell method by coquerelle and cottet 2008 the momentum equation eq 4 can be written with the appearance of the penalization term to express the treatment of the no slip condition as follows nguyen et al 2019d coquerelle and cottet 2008 nguyen et al 2016 12 ω t u ω ν 2 ω λ χ s u s u where u s stands for solid velocity λ stands for the penalization parameter and χ identities the solid and fluid regions in the current study the solid bodies are stationary therefore u s 0 χ is expressed as 13 χ s i 1 n b χ s i where n b is the number of solid bodies immersed in the fluid superscript i indicate the i th solid body denoted by s i each χ s i is calculated using the following heaviside function cottet and koumoutsakos 2000 14 χ s i d i 0 if d i ɛ 1 2 1 d i ɛ 1 π sin π d i ɛ if d i ɛ 1 if d i ɛ where d i is the signed distance d i 0 if x q s i and d i 0 if x q s i from the grid point to the surface of the i th solid body as shown in fig 1 ɛ 2 2 δ x is half of the interface thickness used to treat the fluid as a continuous fluid through the solid regions and to overcome the problem of the numerical instability eq 12 is solved using the viscous splitting method therefore the penalized velocity is calculated separately as 15 u t λ χ s u s u using the forward finite difference approximation and setting λ 1 δ t the penalized velocity u λ is expressed as 16 u λ 1 χ s u χ s u s the penalized vorticity ω λ is computed using the change in the velocity field as 17 ω λ ω u λ u supposing that the flow at time t is known the flow at time t δ t is calculated using the following procedure compute the vortex diffusion to account for the effects of fluid viscosity using eq 5 compute the vortex convection using eq 6 interpolate the vortex particle from the lagrangian to eulerian grid locations employing eq 10 compute the vector potential ψ by solving the poisson equation eq 8 compute the velocity u employing eq 7 compute the penalized velocity u λ and vorticity ω λ to tackle the no slip condition of the viscous fluid flow on the solid surfaces using eqs 16 and 17 respectively compute the flow force acting on the solid body using eqs 18 and 19 update the vorticity and velocity vectors u u λ and ω ω λ for the next time step in the present study we discretize the spatial derivatives by using the fourth order finite difference schemes the temporal derivative in eq 5 is calculated using the second order crank nicolson scheme while that in eq 6 is estimated using the second order runge kutta scheme the poisson equation eq 8 is solved by the fourier method with neumann boundary condition at four sides of the domain in which the fourier transform is calculated by employing the fftw library frigo and johnson 1997 the laplace equation eq 8 is not solved instead of that the irrotational vector field is set to be ϕ u 4 results and discussions 4 1 flow around a single and two side by side cylinders the present numerical method is evaluated using the benchmark simulation cases such as the flows around a single circular cylinder at reynolds numbers r e u d ν 100 and 200 and two circular cylinders in the side by side configuration at r e 200 the drag and lift coefficients denoted by c d and c l respectively exerted on a cylinder are expressed as follows 18 c d 2 f x ρ d u 2 19 c l 2 f y ρ d u 2 where ρ indicates the fluid density and f x and f y are drag and lift respectively calculated using formulas by noca et al 1999 and mimeau et al 2015 as follows 20 f d d t v u d x ω n γ d x where v is the domain containing the solid body s ω denotes the domain boundary and 21 γ 1 2 u 2 i 1 n 1 u x ω 1 n 1 ω x u 1 n 1 x u t i x u t 1 n 1 x τ i x τ τ where n 2 3 corresponds to two and three dimensional problems respectively and τ μ u u t is stress tensor suppose that v is a rectangular domain as shown in fig 2 the fluid force components exerted on the solid body are expressed as f x and f y given in box i the non dimensional time is expressed as t u t d in the whole simulation cases a computational domain 7 5 d 37 5d 7 5 d 7 5d is divided into 4500 1500 square cells and the non dimensional time step is d t 0 0025 in the context of a single cylinder its center is placed at 0 0 while in the case of two cylinders they are positioned at 0 0 5 l and 0 0 5 l where l is the spacing between two cylinders table 1 shows a comparison of the present simulation results of the strouhal number s t drag c d and lift c l coefficients exerted on a circular cylinder at r e 100 and 200 with the existing simulation and experiment results at r e 100 c d calculated using the present simulation has a slight difference with those given by sa and chang 1991 and tritton 1959 however it agrees well with those obtained by braza et al 1986 arkell 1995 liu et al 1998 meneghini and saltara 2001 saltara 1999 choi et al 2007 harichandan and roy 2010 supradeepan and roy 2014 and mimeau et al 2015 c l by the present simulation is in a good agreement with those by liu et al 1998 choi et al 2007 and mimeau et al 2015 the difference of the present values of s t with the literature results using both the simulations and experiment is trivial at r e 200 similarly the current results approach those provided by braza et al 1986 choi et al 2007 supradeepan and roy 2014 and mimeau et al 2015 while a slight difference with those given by sa and chang 1991 meneghini and saltara 2001 and saltara 1999 the current method continues to be validated using simulations of the flows over two side by side cylinders with their distance l 1 5 2 3 4 d at r e 200 table 2 shows the convergence study and a comparison of the present results with those listed in the literature it is observed that the current results c d a 1 c d a 2 s t are convergent with the increment of grid resolutions the time averaged values of c d 1 c d 2 s t 1 and s t 2 of two cylinders in the current simulation are parallel to those given by meneghini and saltara 2001 and chang and song 1990 this comparison proves that the current method reproduces well the characteristics of the laminar flow around multiple bluff bodies fig 3 shows the time variation of the drag and lift coefficients acting on a a single and b two circular cylinders at r e 200 in the case of a single cylinder these coefficients fluctuate periodically and the estimated time averaged drag coefficient c d a and strouhal number s t f d u where f stands for the karman vortex shedding frequency are 1 42 and 0 191 respectively in the case of two cylinders c d 1 and c d 2 oscillate slightly in the same phase around a value c d a 1 c d a 2 1 46 while c l 1 and c l 2 fluctuate strongly in the antiphase fig 4 shows the vorticity distribution of the flow over a a single and b two side by side cylinders at r e 200 at t 400 and 195 respectively in fig 4 a a karman vortex street composed of clockwise and counterclockwise vortices interleaved is observed downstream these vortices are formed due to the rolling up of the laminar shear layers alternately separated from one side to another of the cylinder in fig 4 b in the case of two cylinders two parallel vortex streets are observed and they interact slightly together the shear layers with opposite values of vorticity generated in the cylinders central side seem to attract each other this phenomenon is the cause of fluctuations of c l 1 and c l 2 around the time averaged values c l a 1 0 1 and c l a 2 0 1 respectively it also causes a slight increment in both the time averaged drag coefficients and the vortex shedding oscillation frequency 4 2 flow around four cylinders of various shapes flow over four cylinders of various shapes at r e 200 as sketched in fig 5 is investigated to clarify the effects of the geometry of solid bodies on the wake pattern the vortex shedding the evolution of the vortex flow the fluid forces exerted on the cylinders and the energy spectrum of drag coefficients in the whole simulation cases the domain size grid node number and time step are set as those used in the simulation cases of the flows over a single and two side by side cylinders to consider the effects of the computational domain size inlet and far field on the simulation results we implemented three simulations of the flow around four circular cylinders with the domains of 7 5 d 37 5 d 7 5 d 7 5 d denoted as domain i 8 5 d 37 5 d 7 5 d 7 5 d domain ii and 7 5 d 37 5 d 8 5 d 8 5 d domain iii that are divided into 4500 1500 4600 1500 and 4500 1700 grid nodes respectively the time step and grid cell size in the three simulations remain unchanged as seen in fig 6 the results of drag coefficients exerted on four cylinders using three computational domains almost overlap this proves that the size of the computational domain i is large enough to exclude the effects of the inlet and far field on the simulation results 4 2 1 flow patterns and vortex shedding figs 7 9 show the vorticity distribution at an instantaneous time in the development stage and time history of the vortex shedding of flows around four cylinders of various shapes at r e 200 in fig 7 a b c e h it is observed that the flow patterns are almost symmetric to the horizontal axis and these flows are stable in the whole time history in fig 7 a with the left triangles case i the laminar shear layers synchronously separated from the front cylinders first and second ones do not roll up to form the vortices in the front of the rear cylinders third and fourth ones as further shown in fig 8 a these shear layers combine with the shear layers from the rear cylinders to generate more robust shear layers that synchronously roll up to form two karman vortex streets downstream four vortices as denoted by v 1 v 2 v 3 and v 4 shown in fig 8 a interact together the interaction of v 1 with v 2 leads their motion far away from cylinders while those of v 1 with v 3 v 2 with v 4 induce their backward motion and vertical spread however the intensity of interaction of v 1 with v 2 is greater than those of v 1 with v 3 and v 2 with v 4 due to the distance between v 1 and v 2 being lesser than those between v 1 and v 3 v 2 and v 4 as a consequence these vortices move away from the cylinders and slightly vertically spread downstream see fig 7 a in fig 7 b with the right triangles case ii the vortex shedding occurs behind the front cylinders and three vortex streets are formed downstream as further shown at t 250 in fig 8 b the shear layers synchronously separate from the front cylinders central side and roll up to form vortices subsequently these vortices collide on the rear cylinders they break down into two parts one part interacts with the vortices shed from the outside of the rear cylinders to form two distorted vortex streets along the horizontal axis at t 252 5 the other interact to form a vortex street lying on the horizontal axis as can be seen at t 255 and 257 5 in fig 7 c with the up down triangles case iii there are two vortex streets generated downstream and the vortex shedding phenomena also appear behind the front cylinders as further shown at t 175 in fig 8 c the shed vortices impinge on the rear cylinders edges and they break down into two parts at t 177 5 the predominant part interacts with the vortices shed from the outside of the rear cylinders to form two distorted vortex streets along the horizontal axis the rest combines with the shear layers in the rear cylinders central side and they roll up to form a vortex street lying on the horizontal axis in fig 7 e and h in the cases of squares rotated 45 degrees case v and circles case viii the vortices shed from the central side and outside of the front cylinders combine with the shear layers from those of the rear ones to form more robust shear layers as further shown in fig 8 d and e respectively they are alternately shed from both sides of the rear cylinders to form two karman vortex streets downstream in fig 7 d f and g in the cases of down up triangles case iv unrotated squares case vi and regular hexagons case vii the flow patterns are not symmetric to the horizontal axis the flow is not stable in the fully developed stage as further seen in fig 9 a b and c the shear layers separated from the front cylinders roll up to form vortices before the rear cylinders these vortices collide on the rear cylinders and break down into two parts one part interacts with the shear layer separated from the outside of the rear cylinders another part merges with the shear layers from the central side of the rear ones these shear layers with the same sign merge to form large scale vortices downstream as seen in fig 7 d f and g moreover the phase of the vortex shedding from the first cylinder is close to that of the second cylinder this phenomenon is also observed with the rear cylinders the flow instability develops in three cases of down up square and regular hexagonal cylinders therefore several simulations of the flow around these cylinders are further carried out to clarify the effects of r e on their flow patterns fig 10 indicates the vorticity contour of the flow around four down up cylinders at r e 65 100 150 200 250 and 300 at r e 65 100 and 150 the shear layers from the front cylinders do not roll up to form vortices denoted as n o t r o l l i n g but join with the shear layers from the rear cylinders at r e 65 a steady flow pattern s t e a d y occurs and the shear layers from the rear cylinders are elongated far downstream without rolling up to form vortices as seen in fig 10 a at r e 100 the shear layers from the rear cylinders roll up to form two karman vortex streets t w o s t r e e t s as seen in fig 10 b this flow pattern is similar to that generated by the right triangular cylinders at r e 200 at r e 150 downstream the shear layers with the same sign merge to form large scale vortex structures m e r g i n g as noticed in fig 10 c at r e 200 250 and 300 the shear layers from the front cylinders roll up to form vortices before the rear cylinders r o l l i n g these vortices collide on the edges of the rear cylinders and then merge with the shear layers from the rear ones downstream the behaviors of these shear layers are comparable to those with r e 150 the more r e increases the stronger vortices downstream are developed by merging the shear layers from the rear cylinders figs 11 and 12 show the vorticity contour of the flow over square and regular hexagon cylinders at r e 65 100 150 200 250 and 300 for both square and regular hexagonal cylinders the vortices are not formed in the spacing between the front and rear cylinders at r e 65 100 and 150 but generated at r e 200 250 and 300 this gives a prediction that the fluid forces acting on the front cylinders and their fluctuations at r e 65 100 and 150 are lower than those at r e 200 250 and 300 for the square cylinders at all r e the merging of the shear layers with the same sign to form the large scale vortices occurs downstream as observed with down up triangular cylinders at r e 150 200 250 and 300 the regular hexagon cylinders also produce these phenomena at r e 65 100 150 200 and 300 however at r e 250 two distorted karman vortex streets are generated behind the rear hexagonal cylinders as seen in fig 12 e fig 13 illustrates a regime map of laminar flow around four cylinders in down up triangles case iv squares case vi and regular hexagons case vii based on the rolling up of the shear layers separated from the front cylinders and formation of the wake behind the rear ones we classify the flow pattern into steady notrolling twostreets rolling twostreets rolling merging and notrolling merging four flow patterns are observed in the case of down up triangular cylinders case iv followed by the regular hexagonal cylinders case vii with three patterns and the square cylinders case vi with two patterns it is stated that the formation of the flow pattern significantly depends on the cylinder shape 4 2 2 drag and lift coefficients the flow patterns with r e 200 are more stable than those at r e 200 as proved by simulation results in the cases of the down up square and regular hexagon cylinders see figs 10 11 and 12 the appearance of the flow instability corresponding to an increase in the oscillation amplitude of the drag and lift coefficients is more clear when r e increasing therefore the flow at r e 200 is considered to represent whole the cases of the laminar flow the analysis of the drag and lift coefficients is given at this r e fig 14 depicts the time variation of coefficients of the drag and lift acting on four left case i right case ii and up down case iii triangular cylinders immersed in the flow at r e 200 in general the fluctuation of these coefficients is periodic the drag coefficients c d 1 and c d 3 have oscillations in the same phase with c d 2 and c d 4 while the lift coefficients c l 1 and c l 2 fluctuate in the antiphase with c l 2 and c l 4 respectively in fig 14 a with the right triangles case i the drag and lift coefficients of the front cylinders c d 1 c l 1 c d 2 c l 2 slightly fluctuate while significantly for the rear ones c d 3 c l 3 c d 4 c l 4 this feature is explained as the vortices are not shed from the front cylinders but shed from the rear ones in fig 14 b with the left triangles case ii and c up down triangles case iii the coefficients c d 1 and c d 2 have significant fluctuations due to the appearance of the vortex shedding behind the front cylinders c d 3 and c d 4 fluctuate strongly owing to the effects of interactions of the vortices shed from the front cylinders with the shear layers separated from the rear ones moreover in the case of the up down triangles case iii the coefficients c l 1 and c l 2 fluctuate around the positive and negative values respectively which contrasts with the observations in the case of the right triangles case ii this is explained as the fact that the wakes from the rear cylinders push each other subfigures on the right show the orbits of c d based on c l of the front and rear cylinders they also describe the direction of the fluid force acting on the cylinders during a period the size of these obits indicates the oscillation amplitude of the fluid force for the left triangles case i the size of orbits of c d based on c l of the front cylinders almost degenerates into a point while that of the rear cylinders is remarkable for the right triangles case ii the size of these orbits of the rear cylinders is large and the fluid force of these cylinders has a sudden change of direction drastically this can be a cause of structure fatigue for the up down triangles case iii the fluid forces on the front cylinders have a sudden change in direction of impact however a large size of the obits large oscillation amplitude of force belongs to the rear cylinders fig 15 shows the time history of coefficients of the drag and lift acting on four cylinders in cases of a squares rotated 45 degrees case v and b circles case viii respectively immersed in the flow at r e 200 the fluctuations of the drag and lift coefficients of four cylinders are nearly periodic in the case of squares rotated 45 degrees while they are periodic with the circles as observed in subfigures on the right where the obits of c d based on c l during several periods overlap for the case of circles moreover with the squares rotated 45 degrees the oscillation phases of c l 1 and c l 2 are nearly equal to those of c l 3 and c l 4 respectively meanwhile those are not observed with circles from the subfigures on the right of the figure it is observed that the force acting on the front and rear cylinders for the squares rotated 45 degree case v and circles case viii have a sudden change however the fluid forces acting on the rear cylinders for both cases are the most remarkable and the vertical forces play the most dominant role the time history of the drag and lift coefficients exerted on four down up triangular cylinders immersed in the flow at r e 200 case iv is illustrated in fig 16 in the early stage with 50 t 100 the fluctuation phases of the drag and lift coefficients of the front and rear cylinders are similar to those in the previously mentioned cases the fluctuations of c d 1 c d 2 c l 1 and c l 2 are approximately synchronous while asynchronous for c d 3 c d 4 c l 3 and c l 4 as shown in the fig 16 a the flow fully develops in the stage of 400 t 450 the fluctuations of the drag and lift coefficients exerted on four cylinders are not periodic and not in phase as shown in fig 16 b fig 17 shows the time history of the drag and lift coefficients exerted on four a unrotated square case vi and b regular hexagonal cylinders case vii the fluctuation of drag coefficients for these cylinders is asynchronous while the oscillation phases of the lift coefficients are nearly the same from the subfigures on the right of figs 16 and 17 it is observed that the oscillation amplitude of the fluid forces exerted on the rear cylinders for cases of down up triangular case iv square case vi and hexagon case vii cylinders is extremely high compared to those observed in the above cases moreover the horizontal and vertical force components acting on the cylinders both play a critical role fig 18 depicts the time averaged avg and root mean square rms values of the fluctuating drag and lift coefficients exerted on four cylinders of various shapes in subfigure a the avg values of c d 1 and c d 2 are greater than those of c d 3 and c d 4 in the whole simulation cases the avg values of c d 3 and c d 4 are trivial in case i left triangles because the vortex shedding does not occur behind the front cylinders and the rear ones are immersed in the separated shear layers from the front ones the avg values of c d for four cylinders increase when the vortex shedding appears behind the front cylinders the sum of four avg values of c d is maximum in case vi unrotated squares followed by those in cases iv down up triangles in these cases the flip flopping phenomenon causes the generation of high avg values these values in cases ii right triangles iii up down triangles and vii regular hexagons are nearly equal and greater than those in cases v squares rotated 45 degrees and viii circles in subfigure b the avg values of c l are smaller than those of c d the maximum values are observed in cases iii up down triangles and iv down up triangles for the front cylinders the avg values of other cases are negligibly small the rms values of c d are smaller than those of c l for four cylinders in the whole simulation cases as shown in fig 18 c and d the sum of four rms values of c d is maximum in case vi unrotated squares followed by that in case iv down up triangles those values in cases ii right triangles iii up down triangles and vii hexagons are almost equal and remarkably higher than those in cases v squares rotated 90 degrees and viii circles the sum of four rms values of c l in cases ii iii iv v vi vii and viii are almost parallel the minimum value is observed in case i left triangles the avg and rms values represent the fatigue and corrosion of the cylinder system the values of avg of c d and c l describe the cylinders subjected to bending stresses for a long time static load while the rms values of c d and c l express the fluctuation stresses dynamic load that repeat a large number of times in the cylinders this dynamic load causes fatigue failure antaki and gilada 2015 each material of the cylinder has fatigue strength and fatigue life where the fatigue strength expresses the highest stress that the material can withstand through a number of loading loops while the fatigue life indicates the number of times the material is subjected to impact by the loading before it is destroyed rolfe and barsom 1977 it is clear that the lift forces exerted on the cylinders have a significant effect on the fatigue rather than the drag forces based on the avg and rms values of c d and c l for individual and cluster of cylinders it is observed that the most optimal geometry of the cylinders is square rotated 45 degrees case v and circle case viii although in case i left triangles avg and rms values of c d and c l are small these values can be switched to those in case ii right triangles owing to the highly changeable flow direction in the real environment vice versa therefore the cylinder geometry in cases i left triangles and ii right triangles is not optimal because they drastically depend on the flow direction 4 2 3 energy spectrum of drag coefficients fig 19 presents the energy spectrum of drag coefficients exerted on four cylinders of various shapes and the instantaneous vortex shedding pattern on each cylinder cluster in case i left triangles there are two most significant captured vortex shedding frequencies as denoted by f v k 1 and f v k 2 respectively the lowest frequency f v k 1 indicates the shear layers separated from the front cylinders while f v k 2 represents the primary vortices large scale eddies shed from the outside and central side of the rear cylinders the highest energy mode corresponds to these shear layers while the lower one is produced by the large scale eddies besides according to the vortex shedding pattern these left triangles induce the formation of a favorable pressure gradient boundary layer fpgbl region in which the vortex flow is accelerated downstream in case ii right triangles there are three most significant frequencies with their magnitudes ranging from low to high values as denoted by f v k 1 f v k 2 and f v k 3 respectively the f v k 2 and f v k 3 indicate the vortices shed from the outside and central side of the rear cylinders respectively the f v k 2 vortices interact with the f v k 3 vortices to form two distorted vortex streets along the horizontal axis while the f v k 3 vortices interact together to form the counter rotating vortex pairs a vortex street downstream the frequency f v k 1 corresponds to eddies formed by rolling up of the shear layers from the front cylinders the geometry of these cylinders causes the generation of the adverse pressure gradient boundary layer apgbl region in which the reattachment of the boundary layer progresses favorably furthermore f v k 1 and f v k 2 in this case right triangles are lower than those in case i left triangles in case iii up down triangles two most significant frequencies f v k 1 and f v k 2 are observed the frequency f v k 1 describes the vortex shedding from the outside and central sides of the front cylinders while the frequency f v k 2 illustrates the vortex shedding from those of the rear ones moreover the features demonstrated herein are that each cylinder reproduces the fpgbl and apgbl regions at their frontal and leeward sides respectively it is observed that f v k 1 and f v k 2 are smaller than those in case i left triangles and higher than those in case ii right triangles there are several remarkable features observed in case iv down up triangles the frequencies f v k 2 and f v k 3 correspond to the formation of the shear layers separated from the rear cylinders and these layers merge and roll up to form large scale vortices downstream the frequency f v k 1 indicates the vortex shedding from the front cylinders the f v k 1 and f v k 2 in this case are much smaller than those in case ii right triangles in case v squares rotated 45 degrees and case viii circles there is one most significant frequency f v k 1 showing the vortex shedding from the front and rear cylinders the vortices are synchronously shed from the rear cylinders and form counter rotating vortex pairs moreover for the rotated squares from 15 d the vortex merging appears and forms large scale vortices in case vi unrotated squares and case vii regular hexagons this shape introduces two high shear regions at the outside and central side of the rear cylinders characterized by high frequencies f v k 2 and f v k 3 these shear layers merge and roll up to form large scale vortices downstream as observed in case iv down up triangles the frequency f v k 1 expresses the vortex shedding from the front cylinders 5 conclusions simulation of the flow around four cylinders of various shapes with their gap of 3 d at a reynolds number r e 200 was performed using a vortex in cell method this method was evaluated using simulations of the flow over a single and two circular cylinders in the side by side configuration with their gap l 1 5 2 3 and 4 d at r e 200 the drag lift coefficients and strouhal number s t obtained using the current method agree with those listed in the literature well the characteristics of flow around four cylinders of various shapes are highlighted as follows 1 eight flow patterns drastically depend on the geometry of the cylinders at r e 200 with the left triangles the vortex shedding does not occur behind the front cylinders and two karman vortex streets with their expansion are observed downstream in the cases of right and up down triangles the vortex shedding appears behind the front cylinders and two distorted karman vortex streets along the horizontal axis and vortex pairs laying on this axis are observed 2 in the cases of circles and squares rotated 45 degrees the vortex shedding is also observed behind the front cylinders the vortices shed from the outside and central side of the front ones merge with those from the rear ones respectively to form two karman vortex streets within a range of about 15 d downstream the wake flow in the case of circles is more stable than that with squares rotated 45 degrees 3 in the cases of down up triangles unrotated squares and regular hexagons the flow is unstable and the vortices shed from the rear cylinders combine to form large scale vortices downstream the flow instability in these cases is further investigated using simulations at r e in a range from 65 to 300 based on the rolling of the shear layers separated from the front cylinders and the characteristics of the formation of the vortex wake behind the rear cylinders the flow patterns are classified into steady notrolling twostreets rolling twostreets notrolling merging and rolling merging 4 in the cases of left right and up down triangles the fluctuations of c d and c l for four cylinders are synchronous these fluctuations of left triangles are small while those of right and up down triangles are greater in cases of squares rotated 45 degrees and circles these fluctuations are nearly synchronous and in a higher magnitude in cases of down up triangles unrotated squares and regular hexagons these fluctuations are non synchronous and in a strong magnitude due to the rolling merging phenomena 5 the fatigue of structural system is evaluated using measurements of the time averaged avg and root mean square rms values of the drag and lift coefficients for individual and cluster of cylinders based on these values the most optimal geometry is circle and square rotated 45 degrees 6 the lowest frequency of the vortex shedding is observed in cases of down up triangles and unrotated squares in which the strong shear layers are generated and support the vortex merging to form large scale vortices downstream this represents the high energy large scale vortices in which the fatigue of the cylinder cluster is highly remarkable credit authorship contribution statement v l nguyen conceptualization methodology software validation writing original draft writing review editing t nguyen thoi investigation resources v d duong visualization formal analysis investigation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we are deeply grateful to all the anonymous reviewers for their invaluable detailed and informative suggestions and comments on the drafts of this article 
20218,characteristics of flow around four cylinders of various shapes in the square configuration were numerically investigated using a vortex in cell method the flow patterns drastically depend on the cylinder geometry such as equilateral triangle square regular hexagon and circle in the cases of left right and up down triangles the vortices are synchronously shed from the cylinders the fluctuations of drag c d and lift c l coefficients exerted on these cylinders are also synchronous the magnitudes of these fluctuations of left triangles are small while those of right and up down triangles are greater in the cases of circles and squares rotated 45 degrees the vortices shed from the cylinders are nearly synchronous and the fluctuations of c d and c l are of a higher magnitude in the cases of down up triangles unrotated squares and regular hexagons the flow instability was investigated in a range of reynolds numbers from 65 to 300 and the flow patterns are classified into steady notrolling twostreets rolling twostreets notrolling merging and rolling merging the fluctuations of c d and c l exerted on these cylinders are non synchronous and of a strong magnitude the lowest frequency of the vortex shedding was noticed in cases of down up triangles and unrotated squares in which the fatigue of the cylinder cluster is highly remarkable the two most optimal geometries of the cylinder are circle and square rotated 45 degrees keywords viscous flow flow pattern vortex shedding flow around cylinder cluster vortex in cell method immersed boundary method 1 introduction flow over a cluster of cylinders is observed widely in engineering applications such as offshore oil platforms riser pipes floating structures bridge piers tube heat exchanger devices and electrical power cables nicolle and eames 2011 characteristics of this flow are the separation and reattachment of the boundary layers wake interactions vortex breakdown and merging vortex induced vibration and fluctuating fluid forces acting on solid obstacles they cause problems of structural fatigue corrosion and resonance that lead to system damage therefore a comprehensive understanding of these features is essential to improving design and controlling related structures this aspect has attracted the interest of experimental and numerical researchers in this topic for a few decades flow around two cylinders has been studied extensively because it provides fundamental mechanisms of flow interference thomas and kraus 1964 pioneered in research of the wake interactions in which they clarified the contraction expansion and cancellation of laminar wakes generated from a pair of circular cylinders in the tandem and side by side arrangements at different reynolds numbers r e where r e u d ν u d and ν are the upstream velocity cylinder diameter and kinematic viscosity respectively these cylinders do not generate the turbulence of flow but many periodic phenomena the wake interference effects in the case of the tandem arrangement are more robust than those with the side by side one this research work provides a view on some specific flow phenomena but does not give a detailed analysis of flow bearman and wadcock 1973 conducted an experimental study of the flow around these cylinders at r e 2 5 1 0 4 and observed the flow instability with the cylinder gap in the range from 0 1 to one diameter two streets of the vortex structure are formed with the gap being greater than one diameter while only one street was detected when the cylinders nearly touch each other this study lacks qualitative evidence to confirm the observed such as the drag lift acting on the cylinders and the vortex shedding frequency zdravkovich 1977 reviewed this problem and classified the flow pattern into coupled vortex streets bistable flow single vortex street for the side by side configuration and single slender body alternate reattachment intermittent shedding and two vortex streets for the tandem configuration igarashi 1986 conducted an experimental investigation of the characteristics of flow over four tandem circular cylinders at r e in the range of 1 3 1 6 1 0 4 and found five flow patterns based on the reattachment of shear layers on the second third and fourth cylinders and the rolling up of shear layers before these cylinders such as w w w w r r r r r r r j and r j j where w r and j denotes the without reattachment reattachment and rolling up respectively sewatkar et al 2012 clarified the characteristics of flow around six tandem square cylinders at r e 100 and they showed synchronous s y chaotic c h and a pair of quasi periodic q p 1 q p 2 regimes the q p 2 and c h regimes are caused by the wake interaction effects of the upstream cylinders while the s y regime occurs because of the formation of a single body wake behind all the cylinders when they are placed close together the q p 1 regime is the combination of the q p 2 and s y regimes the shedding frequency is nearly the same for all cylinders particularly for q p 1 and s y regimes these four regimes are also observed in the case of flow over a group of four circular cylinders in the side by side arrangement at r e 100 by awale 2014 wu 2017 numerically studied the flow over two and three cylinders in several configurations such as side by side tandem and triple cylinder arrangement with a spacing ratio s r of 3 utilizing the second order boundary free immersed boundary method the synchronous karman vortex streets were declared in the side by side arrangement while the symmetric feature of vortex shedding was determined in the case of the triple cylinder arrangement flow around a group of cylinders has been a subject of interest to researchers in recent years nicolle and eames 2011 indicated three flow patterns in the case of the flow over a circular cluster of circular cylinders from 7 to 133 cylinders at r e 100 at high spacing each cylinder has an individual wake where each wake is dissolved by other wakes downstream as explained in the work by thomas and kraus 1964 and the forces are determined as those of an isolated cylinder at intermediate spacing shear layers separate at two sides of the array and forces are steady at low spacing the cylinder cluster produces a wake similar to that generated from a solid obstacle zhao et al 2015 simulated the flow around a square array of circular cylinders 36 cylinders in an inline arrangement and 33 cylinders in a staggered arrangement at r e 100 and they also showed three flow patterns as observed in the circular cluster case nicolle and eames 2011 the critical value of s r for the single body wake pattern in the inline arrangement is lower than that in the staggered arrangement besides the flow induced vibration of these cylinders is investigated and the cylinders at the most downstream column have the maximum vibration amplitudes chatterjee and biswas 2015 investigated the flow around two columns of square cylinders 6 cylinders for each column in a staggered arrangement with a change of vertical spacing at r e 100 at large spacing vortex sheddings from these cylinders are antiphase and the vortices exist at large downstream distances at medium spacing the in phase antiphase shedding occurs while a flip flopping regime appears at small gaps the characteristics of these regimes are parallel to those observed in the case of two side by side cylinders zdravkovich 1977 moreover the flow around four cylinders has been greatly concerned because it is found in various engineering applications islam et al 2009 numerically investigated the laminar flow around four rectangular cylinders in the rectangular arrangement at r e 100 and showed single square cylinder stable and wiggling shielding and vortex shedding flow patterns with the spacing change han et al 2013 zhang et al 2013 abbasi et al 2014 and gao et al 2017 investigated the characteristics of laminar flows around four cylinders in various arrangements the flow is characterized by shielding reattachment of laminar shear layers and vortex impinging regimes in the square configuration in the diamond configuration three flow patterns are observed as non synchronous quasi periodic and synchronous ren et al 2019 numerically investigated wavy flow around four circular cylinders in the diamond arrangement for semi underwater pile columns of floating or fixed platforms at r e in the range of 40 230 they also found three flow types such as synchronous quasi periodic and non synchronous using the keulegan carpenter k c number and r e the synchronous flows were declared depending on small values of k c and r e and small s r s while the quasi periodic flow regimes are influenced by length scales of individual and cluster cylinders liu et al 2015 conducted an experimental study on the effect of s r s and angles of incidence from 0 degree to 45 degree on the complex flow over a group of four square and circular cylinders arranged in a diamond configuration at r e 4 58 1 0 4 they pointed out that the upstream cylinder s vortex interaction causes the small mean drag and higher fluctuating forces acting on downstream cylinders tong et al 2014 numerically studied vortex shedding and spanwise vortices of flow around four circular cylinders clustered in a square configuration they identified four wake flow regimes with complex vortex structures in the ranges of r e such as weak spanwise and weak streamwise vortices 100 r e 220 regular wavy spanwise and rib shaped streamwise vortices 240 r e 300 severe vortex dislocations 320 r e 380 and strong streamwise vortices 400 r e 500 although a large amount of work has been dedicated to extending the knowledge of the characteristics of the flow around four cylinders this flow type has not been fully clarified the unknown features of this flow are as follows 1 the effects of body geometry on the flow characteristics such as flow patterns vortex shedding wake interaction and fluid force exerted on the bodies and 2 the most optimal geometry of the cylinder under consideration of the fatigue and corrosion of the structural system therefore this study will shine some light on the problem of the flow over four cylinders of various shapes in the square configuration employing a vortex in cell method the employed cylinder geometry is equilateral triangle square regular hexagon and circle with s r 3 this s r has been utilized in many offshore applications such as anger kizoba magnolia tension based tension leg platforms with s r s ranging from 2 5 to 2 8 wilhoit and supan 2010 nagan 2010 moreover the reason s r 3 adopted in this work is that among three s r s experimentally reported by lam and cheung 1988 the s r 3 corresponds to highly changeable flow interference between the cylinders otherwise the cylinder cluster is considered as a single cylinder s r 1 43 or the flow interference is negligibly small s r 4 65 the vortex in cell method is a well known hybrid approach combining eulerian and lagrangian descriptions of fluid flow known as a remeshed vortex particle method widely used to investigate the viscous incompressible flows around the solid obstacles cottet and koumoutsakos 2000 winckelmens and leonard 1993 cottet and poncet 2002 nguyen et al 2019d in particular it uses the lagrangian reference frame to describe the fluid flow and the grid based formula to solve the velocity and flow momentum in the lagrangian description the fluid is discretized into vortex particles or elements characterized by their positions velocities and flow quantities such as the vorticity circulation and flow momentum using this lagrangian description takes the most advantages of the mesh free methods first the simulation requires no mesh therefore it evades the high cost in mesh generation and mesh distortion issues second the simulation has negligible dissipation errors because of solving the convection term in the linear form it also allows us to choose a more massive time step compared to the traditional grid based methods for simulations with the satisfaction of the method stability because it is not constrained by the courant friedrichs lewy condition after the vortex convection the vortex particles at the lagrangian locations are redistributed onto the regular grid with ensuring the flow momentum conservation this redistribution on the eulerian grid resolves the lagrangian distribution distortion problems of vortex particles overlap issues in the vortex methods the computational cost in calculations of the flow momentum and the velocity field considerably reduces using grid based schemes for example in the vortex method the vortex particle velocities representing the velocity field are gained using the integral biot savart formula with o n p 2 computing operations n body problem where n p is the particle number this computational cost will decrease remarkably as the velocity field is gained by solving the poisson equation using the fourier method implemented by employing the fast fourier transform algorithm with o n p log n p operations furthermore the usage of the grid based formula supports a combination of this method with an immersed boundary method introduced by peskin 1972 to treat the no slip condition of the flow on the solid body surfaces therefore the hybrid eulerian lagrangian approach takes many benefits it can be stated that the vortex in cell method inherits the advantages of both the mesh based and mesh free methods and restricts their drawbacks the vortex in cell method was proposed by birdsall and fuss 1969 to solve two dimensional plasma problems in plasma physics and later it was adapted to simulate two dimensional inviscid incompressible flows by christiansen 1973 subsequently cottet and koumoutsakos 2000 altered it to simulate two and three dimensional viscous incompressible flows coquerelle and cottet 2008 combined it with the penalization method a type of continuous forcing immersed boundary method to model the complex flow around solid obstacles the method capability to capture the characteristics of flows around two tandem cylinders was proved by nguyen et al 2016 this method continued to be developed for simulations of the particle laden two phase flows by walther and koumoutsakos 2001 the bubbly flows by nguyen et al 2019a b c vortex wall interactions by nguyen et al 2019d and turbulent flows by nguyen and duong 2021 nguyen et al 2021 and duong et al 2021 in this study we employed the vortex in cell method to characterize the flow over four cylinders of various shapes the method is validated using simulations of the flow around a single circular cylinder at r e 100 and 200 and the flow around two side by side circular cylinders with their various s r s from 1 5 to 4 at r e 200 the flow around four cylinders in right triangle left triangle up down triangles down up triangles unrotated square square rotated 45 degree regular hexagon and circle as sketched at the beginning of section 4 2 is investigated at r e 200 we clarify the flow pattern using the plots of vorticity contours and analyze time history time average root mean square of drag lift coefficients exerted on the cylinders for each pattern to achieve the most optimal shape an analysis of the energy spectrum of the drag coefficient is given to further clarify the vortex shedding from the cylinders moreover the effects of r e on the flow instability in the cases of the down up triangles squares and hexagons are investigated using simulations at various r e s from 65 to 300 the remainder of this paper is organized as follows the governing equations and vortex in cell method are expressed in section 2 the penalization method and numerical procedure are presented in section 3 the results are discussed in section 4 followed by the conclusions in section 5 2 governing equations and vortex in cell method the continuity and momentum navier stokes equations in velocity pressure form for incompressible viscous fluid flow are respectively expressed as follows 1 u 0 2 u t u u 1 ρ p ν 2 u g where coordinate x velocity field u time t fluid density ρ pressure p kinematics viscosity ν and gravitational acceleration g the velocity vorticity form of the flow momentum equation is obtained by taking the curl on sides of eq 2 as 3 ω t u ω ν 2 ω ω u where the vorticity is expressed as ω u in two dimensional simulation x x y u u v ω ω z k and the second term on the right of eq 3 vortex stretching does not exist therefore eq 3 is rewritten as 4 ω t u ω ν 2 ω in the vortex in cell method the fluid is discretized into the vortex particles that move at the local flow velocity and transport the flow momentum eq 4 is written in the lagrangian reference frame of the vortex particles p transporting the vorticity ω x p as 5 d ω x p d t ν 2 ω x p 6 d x p d t u x p where the particle velocity u x p is the flow velocity field u at their positions x p the velocity field is obtained from the helmholtz decomposition as 7 u ϕ ψ where the first and second terms on the right of eq 7 represent the irrotational and solenoidal vector fields respectively the vector ψ and scalar ϕ potentials of the velocity are gained solving the poisson equation derived taking the curl on sides of eq 7 and laplace equation obtained substituting eq 7 into eq 1 respectively as 8 2 ψ ω 9 2 ϕ 0 the vortex particles are initially positioned on the regular grid and their vorticities ω x p are updated using eq 5 to consider the diffusion of vortices due to the fluid viscosity these vortices convect to the lagrangian locations x p using eq 6 and they are then redistributed onto the eulerian grid their vorticities at the grid x q are obtained by interpolating from those at the lagrangian locations x p as 10 ω x q p n p ω x p w x q x p δ x w y q y p δ y where x q x q y q is the grid location x p x p y p is the lagrangian location δ x and δ y are grid cell sizes n p is particle number and w x is the kernel interpolation function introduced by monaghan 1985 for the smoothed particle hydrodynamics applications and employed by cottet and koumoutsakos 2000 for the lagrangian vortex methods as 11 w x 1 5 2 x 2 3 2 x 3 if x 1 1 2 2 x 2 1 x if 1 x 2 0 if x 2 the redistribution using this interpolation function guarantees the first three flow momentum conservation walther and koumoutsakos 2001 3 penalization method a penalization method combined with the velocity pressure formula to enforce the no slip condition for the viscous fluid flow on the solid body surface was introduced by angot et al 1999 and fadlun et al 2000 this method was integrated into the vorticity velocity formula by kevlahan and ghidaglia 2001 and then the vortex in cell method by coquerelle and cottet 2008 the momentum equation eq 4 can be written with the appearance of the penalization term to express the treatment of the no slip condition as follows nguyen et al 2019d coquerelle and cottet 2008 nguyen et al 2016 12 ω t u ω ν 2 ω λ χ s u s u where u s stands for solid velocity λ stands for the penalization parameter and χ identities the solid and fluid regions in the current study the solid bodies are stationary therefore u s 0 χ is expressed as 13 χ s i 1 n b χ s i where n b is the number of solid bodies immersed in the fluid superscript i indicate the i th solid body denoted by s i each χ s i is calculated using the following heaviside function cottet and koumoutsakos 2000 14 χ s i d i 0 if d i ɛ 1 2 1 d i ɛ 1 π sin π d i ɛ if d i ɛ 1 if d i ɛ where d i is the signed distance d i 0 if x q s i and d i 0 if x q s i from the grid point to the surface of the i th solid body as shown in fig 1 ɛ 2 2 δ x is half of the interface thickness used to treat the fluid as a continuous fluid through the solid regions and to overcome the problem of the numerical instability eq 12 is solved using the viscous splitting method therefore the penalized velocity is calculated separately as 15 u t λ χ s u s u using the forward finite difference approximation and setting λ 1 δ t the penalized velocity u λ is expressed as 16 u λ 1 χ s u χ s u s the penalized vorticity ω λ is computed using the change in the velocity field as 17 ω λ ω u λ u supposing that the flow at time t is known the flow at time t δ t is calculated using the following procedure compute the vortex diffusion to account for the effects of fluid viscosity using eq 5 compute the vortex convection using eq 6 interpolate the vortex particle from the lagrangian to eulerian grid locations employing eq 10 compute the vector potential ψ by solving the poisson equation eq 8 compute the velocity u employing eq 7 compute the penalized velocity u λ and vorticity ω λ to tackle the no slip condition of the viscous fluid flow on the solid surfaces using eqs 16 and 17 respectively compute the flow force acting on the solid body using eqs 18 and 19 update the vorticity and velocity vectors u u λ and ω ω λ for the next time step in the present study we discretize the spatial derivatives by using the fourth order finite difference schemes the temporal derivative in eq 5 is calculated using the second order crank nicolson scheme while that in eq 6 is estimated using the second order runge kutta scheme the poisson equation eq 8 is solved by the fourier method with neumann boundary condition at four sides of the domain in which the fourier transform is calculated by employing the fftw library frigo and johnson 1997 the laplace equation eq 8 is not solved instead of that the irrotational vector field is set to be ϕ u 4 results and discussions 4 1 flow around a single and two side by side cylinders the present numerical method is evaluated using the benchmark simulation cases such as the flows around a single circular cylinder at reynolds numbers r e u d ν 100 and 200 and two circular cylinders in the side by side configuration at r e 200 the drag and lift coefficients denoted by c d and c l respectively exerted on a cylinder are expressed as follows 18 c d 2 f x ρ d u 2 19 c l 2 f y ρ d u 2 where ρ indicates the fluid density and f x and f y are drag and lift respectively calculated using formulas by noca et al 1999 and mimeau et al 2015 as follows 20 f d d t v u d x ω n γ d x where v is the domain containing the solid body s ω denotes the domain boundary and 21 γ 1 2 u 2 i 1 n 1 u x ω 1 n 1 ω x u 1 n 1 x u t i x u t 1 n 1 x τ i x τ τ where n 2 3 corresponds to two and three dimensional problems respectively and τ μ u u t is stress tensor suppose that v is a rectangular domain as shown in fig 2 the fluid force components exerted on the solid body are expressed as f x and f y given in box i the non dimensional time is expressed as t u t d in the whole simulation cases a computational domain 7 5 d 37 5d 7 5 d 7 5d is divided into 4500 1500 square cells and the non dimensional time step is d t 0 0025 in the context of a single cylinder its center is placed at 0 0 while in the case of two cylinders they are positioned at 0 0 5 l and 0 0 5 l where l is the spacing between two cylinders table 1 shows a comparison of the present simulation results of the strouhal number s t drag c d and lift c l coefficients exerted on a circular cylinder at r e 100 and 200 with the existing simulation and experiment results at r e 100 c d calculated using the present simulation has a slight difference with those given by sa and chang 1991 and tritton 1959 however it agrees well with those obtained by braza et al 1986 arkell 1995 liu et al 1998 meneghini and saltara 2001 saltara 1999 choi et al 2007 harichandan and roy 2010 supradeepan and roy 2014 and mimeau et al 2015 c l by the present simulation is in a good agreement with those by liu et al 1998 choi et al 2007 and mimeau et al 2015 the difference of the present values of s t with the literature results using both the simulations and experiment is trivial at r e 200 similarly the current results approach those provided by braza et al 1986 choi et al 2007 supradeepan and roy 2014 and mimeau et al 2015 while a slight difference with those given by sa and chang 1991 meneghini and saltara 2001 and saltara 1999 the current method continues to be validated using simulations of the flows over two side by side cylinders with their distance l 1 5 2 3 4 d at r e 200 table 2 shows the convergence study and a comparison of the present results with those listed in the literature it is observed that the current results c d a 1 c d a 2 s t are convergent with the increment of grid resolutions the time averaged values of c d 1 c d 2 s t 1 and s t 2 of two cylinders in the current simulation are parallel to those given by meneghini and saltara 2001 and chang and song 1990 this comparison proves that the current method reproduces well the characteristics of the laminar flow around multiple bluff bodies fig 3 shows the time variation of the drag and lift coefficients acting on a a single and b two circular cylinders at r e 200 in the case of a single cylinder these coefficients fluctuate periodically and the estimated time averaged drag coefficient c d a and strouhal number s t f d u where f stands for the karman vortex shedding frequency are 1 42 and 0 191 respectively in the case of two cylinders c d 1 and c d 2 oscillate slightly in the same phase around a value c d a 1 c d a 2 1 46 while c l 1 and c l 2 fluctuate strongly in the antiphase fig 4 shows the vorticity distribution of the flow over a a single and b two side by side cylinders at r e 200 at t 400 and 195 respectively in fig 4 a a karman vortex street composed of clockwise and counterclockwise vortices interleaved is observed downstream these vortices are formed due to the rolling up of the laminar shear layers alternately separated from one side to another of the cylinder in fig 4 b in the case of two cylinders two parallel vortex streets are observed and they interact slightly together the shear layers with opposite values of vorticity generated in the cylinders central side seem to attract each other this phenomenon is the cause of fluctuations of c l 1 and c l 2 around the time averaged values c l a 1 0 1 and c l a 2 0 1 respectively it also causes a slight increment in both the time averaged drag coefficients and the vortex shedding oscillation frequency 4 2 flow around four cylinders of various shapes flow over four cylinders of various shapes at r e 200 as sketched in fig 5 is investigated to clarify the effects of the geometry of solid bodies on the wake pattern the vortex shedding the evolution of the vortex flow the fluid forces exerted on the cylinders and the energy spectrum of drag coefficients in the whole simulation cases the domain size grid node number and time step are set as those used in the simulation cases of the flows over a single and two side by side cylinders to consider the effects of the computational domain size inlet and far field on the simulation results we implemented three simulations of the flow around four circular cylinders with the domains of 7 5 d 37 5 d 7 5 d 7 5 d denoted as domain i 8 5 d 37 5 d 7 5 d 7 5 d domain ii and 7 5 d 37 5 d 8 5 d 8 5 d domain iii that are divided into 4500 1500 4600 1500 and 4500 1700 grid nodes respectively the time step and grid cell size in the three simulations remain unchanged as seen in fig 6 the results of drag coefficients exerted on four cylinders using three computational domains almost overlap this proves that the size of the computational domain i is large enough to exclude the effects of the inlet and far field on the simulation results 4 2 1 flow patterns and vortex shedding figs 7 9 show the vorticity distribution at an instantaneous time in the development stage and time history of the vortex shedding of flows around four cylinders of various shapes at r e 200 in fig 7 a b c e h it is observed that the flow patterns are almost symmetric to the horizontal axis and these flows are stable in the whole time history in fig 7 a with the left triangles case i the laminar shear layers synchronously separated from the front cylinders first and second ones do not roll up to form the vortices in the front of the rear cylinders third and fourth ones as further shown in fig 8 a these shear layers combine with the shear layers from the rear cylinders to generate more robust shear layers that synchronously roll up to form two karman vortex streets downstream four vortices as denoted by v 1 v 2 v 3 and v 4 shown in fig 8 a interact together the interaction of v 1 with v 2 leads their motion far away from cylinders while those of v 1 with v 3 v 2 with v 4 induce their backward motion and vertical spread however the intensity of interaction of v 1 with v 2 is greater than those of v 1 with v 3 and v 2 with v 4 due to the distance between v 1 and v 2 being lesser than those between v 1 and v 3 v 2 and v 4 as a consequence these vortices move away from the cylinders and slightly vertically spread downstream see fig 7 a in fig 7 b with the right triangles case ii the vortex shedding occurs behind the front cylinders and three vortex streets are formed downstream as further shown at t 250 in fig 8 b the shear layers synchronously separate from the front cylinders central side and roll up to form vortices subsequently these vortices collide on the rear cylinders they break down into two parts one part interacts with the vortices shed from the outside of the rear cylinders to form two distorted vortex streets along the horizontal axis at t 252 5 the other interact to form a vortex street lying on the horizontal axis as can be seen at t 255 and 257 5 in fig 7 c with the up down triangles case iii there are two vortex streets generated downstream and the vortex shedding phenomena also appear behind the front cylinders as further shown at t 175 in fig 8 c the shed vortices impinge on the rear cylinders edges and they break down into two parts at t 177 5 the predominant part interacts with the vortices shed from the outside of the rear cylinders to form two distorted vortex streets along the horizontal axis the rest combines with the shear layers in the rear cylinders central side and they roll up to form a vortex street lying on the horizontal axis in fig 7 e and h in the cases of squares rotated 45 degrees case v and circles case viii the vortices shed from the central side and outside of the front cylinders combine with the shear layers from those of the rear ones to form more robust shear layers as further shown in fig 8 d and e respectively they are alternately shed from both sides of the rear cylinders to form two karman vortex streets downstream in fig 7 d f and g in the cases of down up triangles case iv unrotated squares case vi and regular hexagons case vii the flow patterns are not symmetric to the horizontal axis the flow is not stable in the fully developed stage as further seen in fig 9 a b and c the shear layers separated from the front cylinders roll up to form vortices before the rear cylinders these vortices collide on the rear cylinders and break down into two parts one part interacts with the shear layer separated from the outside of the rear cylinders another part merges with the shear layers from the central side of the rear ones these shear layers with the same sign merge to form large scale vortices downstream as seen in fig 7 d f and g moreover the phase of the vortex shedding from the first cylinder is close to that of the second cylinder this phenomenon is also observed with the rear cylinders the flow instability develops in three cases of down up square and regular hexagonal cylinders therefore several simulations of the flow around these cylinders are further carried out to clarify the effects of r e on their flow patterns fig 10 indicates the vorticity contour of the flow around four down up cylinders at r e 65 100 150 200 250 and 300 at r e 65 100 and 150 the shear layers from the front cylinders do not roll up to form vortices denoted as n o t r o l l i n g but join with the shear layers from the rear cylinders at r e 65 a steady flow pattern s t e a d y occurs and the shear layers from the rear cylinders are elongated far downstream without rolling up to form vortices as seen in fig 10 a at r e 100 the shear layers from the rear cylinders roll up to form two karman vortex streets t w o s t r e e t s as seen in fig 10 b this flow pattern is similar to that generated by the right triangular cylinders at r e 200 at r e 150 downstream the shear layers with the same sign merge to form large scale vortex structures m e r g i n g as noticed in fig 10 c at r e 200 250 and 300 the shear layers from the front cylinders roll up to form vortices before the rear cylinders r o l l i n g these vortices collide on the edges of the rear cylinders and then merge with the shear layers from the rear ones downstream the behaviors of these shear layers are comparable to those with r e 150 the more r e increases the stronger vortices downstream are developed by merging the shear layers from the rear cylinders figs 11 and 12 show the vorticity contour of the flow over square and regular hexagon cylinders at r e 65 100 150 200 250 and 300 for both square and regular hexagonal cylinders the vortices are not formed in the spacing between the front and rear cylinders at r e 65 100 and 150 but generated at r e 200 250 and 300 this gives a prediction that the fluid forces acting on the front cylinders and their fluctuations at r e 65 100 and 150 are lower than those at r e 200 250 and 300 for the square cylinders at all r e the merging of the shear layers with the same sign to form the large scale vortices occurs downstream as observed with down up triangular cylinders at r e 150 200 250 and 300 the regular hexagon cylinders also produce these phenomena at r e 65 100 150 200 and 300 however at r e 250 two distorted karman vortex streets are generated behind the rear hexagonal cylinders as seen in fig 12 e fig 13 illustrates a regime map of laminar flow around four cylinders in down up triangles case iv squares case vi and regular hexagons case vii based on the rolling up of the shear layers separated from the front cylinders and formation of the wake behind the rear ones we classify the flow pattern into steady notrolling twostreets rolling twostreets rolling merging and notrolling merging four flow patterns are observed in the case of down up triangular cylinders case iv followed by the regular hexagonal cylinders case vii with three patterns and the square cylinders case vi with two patterns it is stated that the formation of the flow pattern significantly depends on the cylinder shape 4 2 2 drag and lift coefficients the flow patterns with r e 200 are more stable than those at r e 200 as proved by simulation results in the cases of the down up square and regular hexagon cylinders see figs 10 11 and 12 the appearance of the flow instability corresponding to an increase in the oscillation amplitude of the drag and lift coefficients is more clear when r e increasing therefore the flow at r e 200 is considered to represent whole the cases of the laminar flow the analysis of the drag and lift coefficients is given at this r e fig 14 depicts the time variation of coefficients of the drag and lift acting on four left case i right case ii and up down case iii triangular cylinders immersed in the flow at r e 200 in general the fluctuation of these coefficients is periodic the drag coefficients c d 1 and c d 3 have oscillations in the same phase with c d 2 and c d 4 while the lift coefficients c l 1 and c l 2 fluctuate in the antiphase with c l 2 and c l 4 respectively in fig 14 a with the right triangles case i the drag and lift coefficients of the front cylinders c d 1 c l 1 c d 2 c l 2 slightly fluctuate while significantly for the rear ones c d 3 c l 3 c d 4 c l 4 this feature is explained as the vortices are not shed from the front cylinders but shed from the rear ones in fig 14 b with the left triangles case ii and c up down triangles case iii the coefficients c d 1 and c d 2 have significant fluctuations due to the appearance of the vortex shedding behind the front cylinders c d 3 and c d 4 fluctuate strongly owing to the effects of interactions of the vortices shed from the front cylinders with the shear layers separated from the rear ones moreover in the case of the up down triangles case iii the coefficients c l 1 and c l 2 fluctuate around the positive and negative values respectively which contrasts with the observations in the case of the right triangles case ii this is explained as the fact that the wakes from the rear cylinders push each other subfigures on the right show the orbits of c d based on c l of the front and rear cylinders they also describe the direction of the fluid force acting on the cylinders during a period the size of these obits indicates the oscillation amplitude of the fluid force for the left triangles case i the size of orbits of c d based on c l of the front cylinders almost degenerates into a point while that of the rear cylinders is remarkable for the right triangles case ii the size of these orbits of the rear cylinders is large and the fluid force of these cylinders has a sudden change of direction drastically this can be a cause of structure fatigue for the up down triangles case iii the fluid forces on the front cylinders have a sudden change in direction of impact however a large size of the obits large oscillation amplitude of force belongs to the rear cylinders fig 15 shows the time history of coefficients of the drag and lift acting on four cylinders in cases of a squares rotated 45 degrees case v and b circles case viii respectively immersed in the flow at r e 200 the fluctuations of the drag and lift coefficients of four cylinders are nearly periodic in the case of squares rotated 45 degrees while they are periodic with the circles as observed in subfigures on the right where the obits of c d based on c l during several periods overlap for the case of circles moreover with the squares rotated 45 degrees the oscillation phases of c l 1 and c l 2 are nearly equal to those of c l 3 and c l 4 respectively meanwhile those are not observed with circles from the subfigures on the right of the figure it is observed that the force acting on the front and rear cylinders for the squares rotated 45 degree case v and circles case viii have a sudden change however the fluid forces acting on the rear cylinders for both cases are the most remarkable and the vertical forces play the most dominant role the time history of the drag and lift coefficients exerted on four down up triangular cylinders immersed in the flow at r e 200 case iv is illustrated in fig 16 in the early stage with 50 t 100 the fluctuation phases of the drag and lift coefficients of the front and rear cylinders are similar to those in the previously mentioned cases the fluctuations of c d 1 c d 2 c l 1 and c l 2 are approximately synchronous while asynchronous for c d 3 c d 4 c l 3 and c l 4 as shown in the fig 16 a the flow fully develops in the stage of 400 t 450 the fluctuations of the drag and lift coefficients exerted on four cylinders are not periodic and not in phase as shown in fig 16 b fig 17 shows the time history of the drag and lift coefficients exerted on four a unrotated square case vi and b regular hexagonal cylinders case vii the fluctuation of drag coefficients for these cylinders is asynchronous while the oscillation phases of the lift coefficients are nearly the same from the subfigures on the right of figs 16 and 17 it is observed that the oscillation amplitude of the fluid forces exerted on the rear cylinders for cases of down up triangular case iv square case vi and hexagon case vii cylinders is extremely high compared to those observed in the above cases moreover the horizontal and vertical force components acting on the cylinders both play a critical role fig 18 depicts the time averaged avg and root mean square rms values of the fluctuating drag and lift coefficients exerted on four cylinders of various shapes in subfigure a the avg values of c d 1 and c d 2 are greater than those of c d 3 and c d 4 in the whole simulation cases the avg values of c d 3 and c d 4 are trivial in case i left triangles because the vortex shedding does not occur behind the front cylinders and the rear ones are immersed in the separated shear layers from the front ones the avg values of c d for four cylinders increase when the vortex shedding appears behind the front cylinders the sum of four avg values of c d is maximum in case vi unrotated squares followed by those in cases iv down up triangles in these cases the flip flopping phenomenon causes the generation of high avg values these values in cases ii right triangles iii up down triangles and vii regular hexagons are nearly equal and greater than those in cases v squares rotated 45 degrees and viii circles in subfigure b the avg values of c l are smaller than those of c d the maximum values are observed in cases iii up down triangles and iv down up triangles for the front cylinders the avg values of other cases are negligibly small the rms values of c d are smaller than those of c l for four cylinders in the whole simulation cases as shown in fig 18 c and d the sum of four rms values of c d is maximum in case vi unrotated squares followed by that in case iv down up triangles those values in cases ii right triangles iii up down triangles and vii hexagons are almost equal and remarkably higher than those in cases v squares rotated 90 degrees and viii circles the sum of four rms values of c l in cases ii iii iv v vi vii and viii are almost parallel the minimum value is observed in case i left triangles the avg and rms values represent the fatigue and corrosion of the cylinder system the values of avg of c d and c l describe the cylinders subjected to bending stresses for a long time static load while the rms values of c d and c l express the fluctuation stresses dynamic load that repeat a large number of times in the cylinders this dynamic load causes fatigue failure antaki and gilada 2015 each material of the cylinder has fatigue strength and fatigue life where the fatigue strength expresses the highest stress that the material can withstand through a number of loading loops while the fatigue life indicates the number of times the material is subjected to impact by the loading before it is destroyed rolfe and barsom 1977 it is clear that the lift forces exerted on the cylinders have a significant effect on the fatigue rather than the drag forces based on the avg and rms values of c d and c l for individual and cluster of cylinders it is observed that the most optimal geometry of the cylinders is square rotated 45 degrees case v and circle case viii although in case i left triangles avg and rms values of c d and c l are small these values can be switched to those in case ii right triangles owing to the highly changeable flow direction in the real environment vice versa therefore the cylinder geometry in cases i left triangles and ii right triangles is not optimal because they drastically depend on the flow direction 4 2 3 energy spectrum of drag coefficients fig 19 presents the energy spectrum of drag coefficients exerted on four cylinders of various shapes and the instantaneous vortex shedding pattern on each cylinder cluster in case i left triangles there are two most significant captured vortex shedding frequencies as denoted by f v k 1 and f v k 2 respectively the lowest frequency f v k 1 indicates the shear layers separated from the front cylinders while f v k 2 represents the primary vortices large scale eddies shed from the outside and central side of the rear cylinders the highest energy mode corresponds to these shear layers while the lower one is produced by the large scale eddies besides according to the vortex shedding pattern these left triangles induce the formation of a favorable pressure gradient boundary layer fpgbl region in which the vortex flow is accelerated downstream in case ii right triangles there are three most significant frequencies with their magnitudes ranging from low to high values as denoted by f v k 1 f v k 2 and f v k 3 respectively the f v k 2 and f v k 3 indicate the vortices shed from the outside and central side of the rear cylinders respectively the f v k 2 vortices interact with the f v k 3 vortices to form two distorted vortex streets along the horizontal axis while the f v k 3 vortices interact together to form the counter rotating vortex pairs a vortex street downstream the frequency f v k 1 corresponds to eddies formed by rolling up of the shear layers from the front cylinders the geometry of these cylinders causes the generation of the adverse pressure gradient boundary layer apgbl region in which the reattachment of the boundary layer progresses favorably furthermore f v k 1 and f v k 2 in this case right triangles are lower than those in case i left triangles in case iii up down triangles two most significant frequencies f v k 1 and f v k 2 are observed the frequency f v k 1 describes the vortex shedding from the outside and central sides of the front cylinders while the frequency f v k 2 illustrates the vortex shedding from those of the rear ones moreover the features demonstrated herein are that each cylinder reproduces the fpgbl and apgbl regions at their frontal and leeward sides respectively it is observed that f v k 1 and f v k 2 are smaller than those in case i left triangles and higher than those in case ii right triangles there are several remarkable features observed in case iv down up triangles the frequencies f v k 2 and f v k 3 correspond to the formation of the shear layers separated from the rear cylinders and these layers merge and roll up to form large scale vortices downstream the frequency f v k 1 indicates the vortex shedding from the front cylinders the f v k 1 and f v k 2 in this case are much smaller than those in case ii right triangles in case v squares rotated 45 degrees and case viii circles there is one most significant frequency f v k 1 showing the vortex shedding from the front and rear cylinders the vortices are synchronously shed from the rear cylinders and form counter rotating vortex pairs moreover for the rotated squares from 15 d the vortex merging appears and forms large scale vortices in case vi unrotated squares and case vii regular hexagons this shape introduces two high shear regions at the outside and central side of the rear cylinders characterized by high frequencies f v k 2 and f v k 3 these shear layers merge and roll up to form large scale vortices downstream as observed in case iv down up triangles the frequency f v k 1 expresses the vortex shedding from the front cylinders 5 conclusions simulation of the flow around four cylinders of various shapes with their gap of 3 d at a reynolds number r e 200 was performed using a vortex in cell method this method was evaluated using simulations of the flow over a single and two circular cylinders in the side by side configuration with their gap l 1 5 2 3 and 4 d at r e 200 the drag lift coefficients and strouhal number s t obtained using the current method agree with those listed in the literature well the characteristics of flow around four cylinders of various shapes are highlighted as follows 1 eight flow patterns drastically depend on the geometry of the cylinders at r e 200 with the left triangles the vortex shedding does not occur behind the front cylinders and two karman vortex streets with their expansion are observed downstream in the cases of right and up down triangles the vortex shedding appears behind the front cylinders and two distorted karman vortex streets along the horizontal axis and vortex pairs laying on this axis are observed 2 in the cases of circles and squares rotated 45 degrees the vortex shedding is also observed behind the front cylinders the vortices shed from the outside and central side of the front ones merge with those from the rear ones respectively to form two karman vortex streets within a range of about 15 d downstream the wake flow in the case of circles is more stable than that with squares rotated 45 degrees 3 in the cases of down up triangles unrotated squares and regular hexagons the flow is unstable and the vortices shed from the rear cylinders combine to form large scale vortices downstream the flow instability in these cases is further investigated using simulations at r e in a range from 65 to 300 based on the rolling of the shear layers separated from the front cylinders and the characteristics of the formation of the vortex wake behind the rear cylinders the flow patterns are classified into steady notrolling twostreets rolling twostreets notrolling merging and rolling merging 4 in the cases of left right and up down triangles the fluctuations of c d and c l for four cylinders are synchronous these fluctuations of left triangles are small while those of right and up down triangles are greater in cases of squares rotated 45 degrees and circles these fluctuations are nearly synchronous and in a higher magnitude in cases of down up triangles unrotated squares and regular hexagons these fluctuations are non synchronous and in a strong magnitude due to the rolling merging phenomena 5 the fatigue of structural system is evaluated using measurements of the time averaged avg and root mean square rms values of the drag and lift coefficients for individual and cluster of cylinders based on these values the most optimal geometry is circle and square rotated 45 degrees 6 the lowest frequency of the vortex shedding is observed in cases of down up triangles and unrotated squares in which the strong shear layers are generated and support the vortex merging to form large scale vortices downstream this represents the high energy large scale vortices in which the fatigue of the cylinder cluster is highly remarkable credit authorship contribution statement v l nguyen conceptualization methodology software validation writing original draft writing review editing t nguyen thoi investigation resources v d duong visualization formal analysis investigation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we are deeply grateful to all the anonymous reviewers for their invaluable detailed and informative suggestions and comments on the drafts of this article 
20219,a novel method gaussian process regression optimized by genetic algorithm ga gpr is proposed for nonparametric modeling of ship maneuvering motion a genetic algorithm with adaptive crossover and mutation operations is introduced for adjustment and optimization of hyperparameters in the kernel function the sliding time window method is adopted to update the training samples to improve the adaptability of the model taking the mariner vessel and the container ship kcs as study objects the simulation data and the real measured data provided by simman 2020 workshop are employed to evaluate the proposed method the prediction results of the proposed method and the traditional gaussian process regression are compared and validated against available experimental data of zigzag and turning circle maneuvers it shows that the proposed method has higher prediction accuracy and better generalization ability indicating that the hyperparameters optimized by genetic algorithm make the model closer to the ship s dynamic characteristics keywords ship maneuvering nonparametric modeling system identification gaussian process regression genetic algorithm sliding time window abbreviations ann artificial neural network cfd computational fluid dynamics ga genetic algorithm gpr gaussian process regression lssvm least squares support vector machine mass maritime autonomous surface ships mle maximum likelihood estimation rbf radial basis function rmse root mean square error se squared exponential svm support vector machine svr support vector regression trd training dataset vad validation dataset nomenclature a d advance m b ship breadth m c b block coefficient d draft m d t tactical diameter m g evolutional generation i z moment of inertia about z axis kg m2 k kernel function k kernel matrix k s e se kernel function l scaling factor on the abscissa l p p ship length m m mass of the ship kg n hydrodynamic yaw moment n m p population size p c crossover probability p m mutation probability r yaw rate rad s r yaw acceleration rad s2 u surge speed m s u surge acceleration m s2 u o initial forward speed m s v sway speed m s v sway acceleration m s2 x longitudinal hydrodynamic force n x g x coordinate of ship s center of gravity m x u etc hydrodynamic derivatives y lateral hydrodynamic force n δ rudder angle deg δ displacement t ζ gaussian white noise θ hyperparameters vector σ f 2 change magnitude on the ordinate σ n 2 variance of gaussian white noise ψ heading angle deg ψ o s 1 1st overshoot angle deg ψ o s 2 2nd overshoot angle deg 1 introduction an accurate and reliable dynamic model of ship maneuvering motion is crucial to the study of ship maneuvering characteristics and autonomous navigation related issues the dynamic model can be utilized to predict ship maneuverability in the process of ship design in addition it can help the design of an automatic control system for ships with engineering practicality sutulo and guedes soares 2014 such as for intelligent navigation of maritime autonomous surface ships mass therefore it is of great importance to develop an efficient modeling method for establishing the ship dynamic model at present model test method computational fluid dynamics cfd method based on potential flow theory or viscous flow theory and system identification method based on motion state data can be used to establish the ship dynamic model however model test method and cfd method have the limitation that the established model is difficult to update according to the varying navigational environments and changing ship s dynamic features wang et al 2020 in contrast system identification is a data driven method with which the ship dynamic model can be identified based on the data collected during free running model tests or full scale trials this method only requires easy to measure motion state variables and control variables which greatly facilitates the modeling of ship dynamic system the existing system identification methods for modeling ship dynamics can be divided into parametric modeling and nonparametric modeling parametric modeling is based on the definite structure of ship dynamic model for ship maneuvering problem the commonly used ship dynamic model includes the whole ship model abkowitz model abkowitz 1964 the modular model mmg model ogawa and kasai 1978 and the response model nomoto model nomoto et al 1957 the unknown parameters in these models i e the hydrodynamic derivatives the hull propeller rudder interaction coefficients and the maneuverability indices can be obtained by system identification technology such as ridge regression method yoon and rhee 2003 yoon 2007 frequency domain spectrum analysis selvam et al 2005 bhattacharyya and haddara 2006 kalman filter perera et al 2011 dong et al 2019 support vector machine svm luo and zou 2009 zhang and zou 2011 2013 wang et al 2014 least squares support vector machine lssvm method zhu et al 2017 gibson and stilwell 2018 xu et al 2020 nonparametric modeling assumes that the ship dynamic system is completely unknown and only relies on the relationship between the input data and output data to model the system in recent years great progress has been made in nonparametric modeling technology the representative methods include svm and artificial neural network ann duan et al 2005 developed an ar emd svr model that combines support vector regression svr and autoregressive ar empirical mode decomposition emd technology and used it for short term prediction of nonlinear and unsteady ship motion wang et al 2019 proposed a nonparametric identification method based on v nu svr to establish robust models of ship maneuvering motion in an easy to operate way liu et al 2019 comprehensively considered the characteristics of deck motion and inertial navigation system proposed an online prediction method based on lssvm the optimization goal of svm is based on structural risk minimization while that of ann is based on empirical risk minimization yin and zou 2011 used a variable structure radial basis function rbf neural network to represent the time varying dynamics of system and proposed a model based on a combined module for the prediction of ship motion in the horizontal plane in order to capture the high order dynamic behavior generated by the coupling of hydrodynamics and driver dynamics woo et al 2018 proposed a deep neural network based dynamic model identification method for unmanned surface vessels compared with other black box modeling algorithms ann requires a larger size of samples and is liable to fall into the local optimum leading to unstable training results schölkopf et al 2002 with the development of artificial intelligence technology and experimental measuring technology other advanced machine learning algorithms have also been proposed for modeling ship hydrodynamic system weymouth and yue 2013 one of the typical methods is the gaussian process regression gpr as an algorithm based on bayesian inference gpr is theoretically a universal approximator of any continuous function in a compact space rasmussen et al 2004 its characteristic is that it can quantify the prediction uncertainty in a principled way and it is a probabilistic model with universality and resolvability these characteristics are beneficial for processing the real measured dataset of ship motion state variables with uncertainty and noise gpr is a typical bayesian learning method and has recently garnered significant attention in the system identification field such as nonlinear setting for volterra series estimation in the frequency domain stoddard et al 2019 typical discrete nonlinear second order dynamic system azman and kocijan 2011 and energy forecasting guan et al 2021 however the application of this method to identification of ship dynamic system has achieved relatively few research results and some research results can be found in ramire et al 2018 and xue et al 2020 the main reason may be attributed to the difficulties in the adjustment and optimization of the hyperparameters in the kernel function therefore it is important to design a suitable algorithm for hyperparameters tuning and optimization to the best knowledge of the authors till now there is no application of gpr with the aid of optimization algorithm for modeling ship dynamic system based on the real measured data of ship motion this paper proposes a method for nonparametric modeling of ship maneuvering motion based on gpr optimized by genetic algorithm ga the selection and optimization of the hyperparameters in the kernel function are completed by ga compared with the traditional optimization algorithm used in gpr that iteratively obtains the optimal solution from a single initial value ga can search multiple solutions in the space for evolution simultaneously thereby reducing the risk of falling into a local optimal solution this is one of the main innovations of this paper based on the real measured data provided by simman 2020 workshop simman 2020 the sliding time window method is used to update the training dataset allowing the algorithm to learn the new information the rest of this paper is organized into four main sections section 2 describes ship kinematics and dynamics in section 3 the mathematical basis of gpr is presented and the hyperparameters tuning method based on ga is proposed in section 4 two case studies are carried out one for the mariner class vessel with the dataset generated from simulation and the other for the container ship kcs with the dataset of model tests from simman 2020 workshop section 5 is devoted to conclusions and perspectives for the further research 2 ship dynamic system in this paper the three degrees of freedom 3 dof maneuvering motion of a ship in the horizontal plane is considered as shown in fig 1 the kinematic mathematical model is given as described by fossen 2011 1 η r ψ v r ψ cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 where ψ is the heading angle η x 0 y 0 ψ t is the vector expressing the position and orientation of the ship with respect to the earth fixed frame o 0 x 0 y 0 z 0 v u v r t is the vector containing the linear and angular velocity components with respect to the body fixed frame o x y z according to the newton s second law of motion the ship dynamic system can be described as 2 m u v r x g r 2 x m v u r x g r y i z r m x g v u r n where m is the mass of the ship i z is the moment of inertia about z axis x g is the longitudinal coordinate of the ship s center of gravity x y n are the components of the hydrodynamic forces and moment acting on the ship referring to abkowitz 1964 eq 2 can be rewritten in the following form 3 m x u u f 1 u v r δ m y v v m x g y r r f 2 u v r δ m x g n v v i z n r r f 3 u v r δ where x u etc are the inertial hydrodynamic derivatives δ is the rudder angle f i u v r δ i 1 2 3 are the nonlinear functions related to the motion state variables and control variable and can be expressed as 4a f 1 x u δ u x u u δ u 2 x u u u δ u 3 x v v v 2 x r r m x g r 2 x δ δ δ 2 x r r u r 2 δ u x v v u v 2 δ u x δ δ u δ 2 δ u x v r m v r x v δ v δ x r δ r δ x v r u v r δ u x v δ u v δ δ u x r δ u r δ δ u 4b f 2 y v v y v v v v 3 y v r r v r 2 y v δ δ v δ 2 y v u v δ u y v u u v δ u 2 y r m u r y r r r r 3 y r v v r v 2 y r δ δ r δ 2 y r u r δ u y r u u r δ u 2 y δ δ y δ δ δ δ 3 y δ v v δ v 2 y δ r r δ r 2 y δ u δ δ u y δ u u δ δ u 2 y v r δ v r δ y δ δ δ u δ 3 δ u 4c f 3 n v v n v v v v 3 n v r r v r 2 n v δ δ v δ 2 n v u v δ u n v u u v δ u 2 n r m x g u r n r r r r 3 n r v v r v 2 n r δ δ r δ 2 n r u r δ u n r u u r δ u 2 n δ δ n δ δ δ δ 3 n δ v v δ v 2 n δ r r δ r 2 n δ u δ δ u n δ u u δ δ u 2 n v r δ v r δ n δ δ δ u δ 3 δ u where x u etc are the hydrodynamic derivatives δ u u u 0 and u 0 is the constant speed of the ship when sailing straight forward according to eqs 3 and 4 u v and r can be expressed as functions of u v r δ in the following form 5 u h 1 u v r δ v h 2 u v r δ r h 3 u v r δ thus three ship motion state variables and one control variable are used to construct the regressor vectors eq 5 is taken as the black box model for nonparametric modeling 3 identification algorithm 3 1 gaussian process regression for nonparametric modeling the gaussian process regression gpr can be described as a supervised learning process in essence the gaussian process is a multivariate gaussian distribution rasmussen et al 2004 for a given finite dataset of n observations d x i y i i 1 n where x i is the input vector of i th sample and y i is the observation value of i th sample f x 1 f x 2 f x n form a set of random variables and have a joint gaussian distribution 6 f x g p m x k x x where m x is the mean function k x x is the kernel function whose mathematical expressions are as follows 7 m x e f x 8 k x x e f x m x f x m x considering the noise in the observations a general model of gpr problem can be established as 9 y f x ζ where ζ is the gaussian white noise uncorrelated with f x with mean 0 and variance σ n 2 since f x obeys gaussian distribution y also obeys gaussian distribution and the set of joint distribution of its finite observations is a gaussian process 10 y g p m x k x x σ n 2 δ i j where δ i j is the kronecker delta function k x x is the kernel matrix and its elements are k i j k x i x j according to bayes theorem gpr first establishes a prior function in d x i y i i 1 n and then transforms it into a posterior distribution under x the joint distribution can be expressed as 11 y f x n 0 k x x σ n 2 i n k x x k x x k x x where x x 1 x 2 x n t y y 1 y 2 y n t i n is a n dimensional identity matrix based on the bayesian regression theory and eq 11 the predicted distribution is calculated as 12 f x x y x n m f x cov f x 13 m f x e f x x y x k x x k x x σ n 2 i n 1 y 14 cov f x k x x k x x k x x σ n 2 i n 1 k x x where m f x is the mean of f x cov f x is the variance of f x according to eqs 13 and 14 the kernel matrix in gpr reflects the relationship between the samples in training dataset a qualified kernel matrix must be a positive semi definite matrix each element in the kernel matrix is calculated by the kernel function and can be seen as a measure of similarity between samples therefore the selection of kernel function has a great impact on the performance of gpr this paper selects squared exponential se kernel function which has been widely adopted in the kernel based nonparametric modeling of ship motion with satisfactory prediction results bai et al 2019 moreno et al 2019 wang et al 2020 the mathematical expression of se kernel function is given as follows 15 k s e σ f 2 exp 1 2 l 2 x i x j t x i x j where the hyperparameters σ f 2 and l characterize the change magnitude of the function on the ordinate and the scaling factor of the function on the abscissa respectively the traditional gpr generally adopts maximum likelihood estimation mle method and conjugate gradient descent algorithm for tuning of the hyperparameters in the kernel function let θ be the vector of all hyperparameters the mle method first constructs a log likelihood function log p y x θ based on bayes principle then utilizes the conjugate gradient method to obtain the maximum value of log p y x θ 16 log p y x θ 1 2 y t k σ n 2 i n 1 y 1 2 log k σ n 2 i n n 2 log 2 π 17 λ k σ n 2 i n 1 y θ j log p y x θ 1 2 t r λ λ t k σ n 2 i n 1 k σ n 2 i n θ j on the other hand the conjugate gradient method has a strong dependence on the initial values and currently the setting of initial values has no theoretical basis fang et al 2018 if the initial values are set improperly the conjugate gradient method will fall into a local optimum or even fail to converge in the search process leading to poor performance of gpr 3 2 genetic algorithm for hyperparameters optimization in order to overcome the shortcomings of conjugate gradient method this paper uses ga with adaptive crossover operation and mutation operation to adjust and optimize the hyperparameters in the kernel function ga can flexibly construct the heuristic process and the corresponding objective function has the ability to randomly and quickly search for the optimal solution as well as to find the global optimal solution in the parameters search process holland 1975 the process is as follows step 1 encoding and population initialization encoding is the process of converting the hyperparameters in gpr into chromosomes that can be manipulated by ga the encoded content is the genotype of individual in biology corresponding to a potentially feasible solution of θ this paper adopts binary encoding method and uses binary symbol set 0 1 to express the parameters such individuals of total number p constitute the initial population step 2 calculation of individual fitness function value the fitness function is a tool to judge the performance of a certain individual genotype it can be regarded as the driving force for individuals to evolve towards outstanding characteristics in this paper the fitness function is designed as 18 f i t n e s s 1 1 n i 1 n y i y i 2 where y i is the predicted value of i th sample y i is the real measured value of i th sample step 3 selection operation the core idea of the selection operation is to calculate the fitness of each individual in the population the individual with a larger fitness value will have a higher probability of being saved to the next generation and the individual with a lower fitness value will have a higher probability of being eliminated the roulette method is adopted for selection operation and the probability of an individual being selected into the next generation is proportional to its fitness value step 4 crossover operation and mutation operation crossover operation and mutation operation are the main ways of ga to generate new genotype individuals in this paper the uniform crossover method is used in the crossover operation for two individuals a and b that are successfully paired each gene on their locus can be exchanged with the same probability p c thereby forming new individuals a and b as for mutation operation the simple mutation method is utilized the random number function is employed to determine the position of individual gene mutation and then the binary code is reversed with mutation probability p m to generate a new individual considering that the genotype of individuals in the population has gradually become stable with high fitness function value in the later stage of optimization in order to improve the performance of ga adaptive crossover operator and adaptive mutation operator are designed 19 p c i p c 1 k 1 p i p m i p m 1 k 2 p i where p c 1 is the initial value of crossover probability p m 1 is the initial value of mutation probability i is the generation of population evolution k 1 and k 2 are the weight values according to eq 19 in the early stage of optimization the crossover probability and mutation probability are relatively large which is conducive to the generation of new individuals along with the increase of iteration times the probability gradually decreases which can protect the outstanding individuals from being eliminated based on the process described above the workflow of nonparametric modeling method for ship dynamics based on gpr optimized by ga ga gpr is shown in fig 2 3 3 sliding time window method this paper adopts the sliding time window method to update the training samples when predicting the ship motion based on ga gpr model new samples will continue to be generated the ship s future motion state has a strong correlation with the motion state of previous adjacent moment so the new samples play a positive role in improving the accuracy of motion prediction xu and zou 2021 according to eqs 13 and 14 however if the new samples are added to x and y continuously the dimension of matrix k x x σ n 2 i n will become larger and larger so the time consumed to solve its inverse matrix will increase the core idea of sliding time window method is that the new samples are added to the training dataset successively while the oldest samples are discarded to keep the total number of training dataset in the time window constant in this paper the length of the time window is equal to the length of x thus the dimension of matrix k x x σ n 2 i n remains unchanged the implementation process is shown in fig 3 4 nonparametric modeling of ship maneuvering motion 4 1 nonparametric modeling for mariner class vessel with simulation data in order to verify the effectiveness of ga gpr firstly the nonparametric modeling of ship maneuvering motion is carried out based on the simulation dataset with eq 5 as the black box model the ship used for simulation test is the mariner class vessel for which the main parameters are listed in table 1 in this paper the hydrodynamic derivatives in chislett and tejsen 1965 are used to establish the abkowitz model according to eq 4 to generate the training dataset by simulating 20 20 zigzag maneuver the training dataset has a total of 600 samples with a sampling time interval of 0 5s during the implementation of ga gpr about 80 of the samples are selected as training dataset trd for gpr modeling while the remaining 20 of the samples are selected as validation dataset vad for hyperparameters optimization by ga the parameters in ga are set as follows p c 1 0 9 p m 1 0 1 p 30 k 1 k 2 0 01 and the evolutional generation g 50 meanwhile the maximum likelihood estimation mle and conjugate gradient method based traditional gpr is implemented for comparison in order to evaluate the generalization ability of the nonparametric model the prediction of maneuvers not involved in the training data are carried out including 10 10 zigzag maneuver 15 5 zigzag maneuver where the specified rudder angle is 15 and the prescribed heading angle at which the reverse steering is executed is 5 and 35 turning circle maneuver figs 4 and 5 show the prediction results of heading angle rudder angle and speed components of 10 10 zigzag maneuver and 15 5 zigzag maneuver respectively fig 6 shows the trajectory and speed components of 35 turning circle maneuver tables 2 and 3 present the comparison of prediction accuracy assessed by root mean square error rmse and validation variables therein rmse is defined as 20 r m s e 1 n i 1 n y i y ˆ i 2 where y i is the original data y ˆ i is the predicted value r u r v r r and r h denote the rmse values of surge speed m s sway speed m s yaw rate rad s and heading angle rad respectively ψ o s 1 deg and ψ o s 2 deg denote the 1st overshoot angle and the 2nd overshoot angle in zigzag maneuvers respectively a d m and d t m denote the advance and the tactical diameter in turning circle maneuver respectively s t denotes the simulation data it can be seen in figs 4 6 that both gpr and ga gpr models can predict accurately the maneuvering motion of mariner class vessel based on the simulation dataset in the prediction of zigzag maneuvers ga gpr shows its advantage over gpr as reflected in the partially enlarged subgraph of fig 4 a and the maneuverability indicators in table 2 the values of ψ o s 1 and ψ o s 2 obtained by ga gpr model show a smaller deviation than those by gpr indicating that ga gpr has higher prediction accuracy from the comparison of prediction and simulation results of motion variables in figs 4 and 5 it can be seen that no overfitting phenomenon occurs with these two algorithms and both have strong generalization ability this may be attributed to the absence of noise interference in the training dataset generated from simulation in the prediction of turning circle maneuver one can find in fig 6 a that the trajectory predicted by gpr model has a certain deviation from the simulation results while that by ga gpr is almost completely consistent with the simulation results the values of a d and d t in table 3 also confirm this observation the deviation of d t predicted by gpr model reaches 12m while the corresponding value of ga gpr is only 4m from the perspective of rmse index ga gpr has higher prediction accuracy in the verification tests indicating that the hyperparameters optimized by ga make gpr model closer to the ship dynamic characteristics in order to explore the influence of noise on the generalization ability of ga gpr model gaussian white noise of different levels is added into the simulated training dataset jiang and zou 2017 the parameters of signal to noise ratio snr set in noise level 1 and 2 are 95 db and 90 db respectively snr is given as 21 s n r d b 10 l o g 10 p s p n where p s is the power of signal p n is the power of noise as can be seen from eq 21 the noise intensity of noise level 2 is larger than that of noise level 1 figs 7 9 show the prediction results of 10 10 zigzag 15 5 zigzag and 35 turning circle maneuvers under different noise levels respectively as can be seen from these figures the influence of noise on the prediction results is noticeable as the noise intensity increases the prediction errors grow more distinctly especially in the prediction of turning circle maneuver nevertheless the prediction results of zigzag maneuvers show that the time histories of heading angle predicted by ga gpr fit the simulation results more closely compared with gpr one can find distinct cumulative prediction errors of gpr in the later stage of prediction which can almost not be observed in the prediction results based on clean training data fig 9 demonstrate that the noise has rather large negative impact on the prediction of turning circle maneuver by the two models as can be seen from fig 9 b the trajectory predicted by gpr shows larger deviation than that by ga gpr under noise level 2 indicating that ga gpr has better anti noise ability 4 2 nonparametric modeling of kcs ship with real measured data in order to further verify the effectiveness of ga gpr in engineering application taking eq 5 as the black box model nonparametric modeling is carried out for the container ship kcs by using ga gpr and gpr based on the real measured data of standard maneuvers provided by the simman 2020 workshop for an international comparative study simman 2020 all the data are presented in full scale the main parameters of the ship are listed in table 4 the datasets of kcs provided by simman 2020 workshop include 20 20 zigzag test starting from portside ps 20 20 zigzag test starting from starboard side sb 10 10 zigzag test ps 10 10 zigzag test sb and 35 turning circle test since the real measured data usually contain noise and may fluctuate for instance due to the instability of sensors the training dataset needs to be carefully selected otherwise problems such as overfitting or poor generalization ability will occur according to wang et al 2020 for the nonparametric modeling of ship maneuvering motion the training dataset needs to contain high quality information of rudder angle excitation so as to obtain more ship dynamic information from the real measured data among the three phases rudder steering phase transitional phase and steady turning phase of a turning circle maneuver only the rudder steering phase contains a large range of rudder angle signal excitations but this phase does not last long thus a small part of the data samples of 20 20 zigzag maneuver ps and 10 10 zigzag maneuver ps are selected to construct the training dataset the duration and sampling time interval of each maneuver are 153 75s and 0 615s respectively the whole training dataset contains a total of 500 samples since gpr has the ability to directly deal with datasets containing noise with the predicted results consisting of mean and variance the training data are not filtered in this paper in order to evaluate the generalization ability and engineering practicability of the nonparametric model the predictions of maneuvers not involved in the training data are carried out based on gpr and ga gpr including 10 10 zigzag maneuver sb 20 20 zigzag maneuver sb and 35 turning circle maneuver the prediction duration and sampling time interval of zigzag maneuvers are 300s and 0 615s respectively while the prediction duration and sampling time interval of turning circle maneuver are 350s and 0 615s respectively the reason for the longer prediction duration of the turning circle maneuver is that the duration of the 10 10 zigzag maneuver sb provided by simman 2020 is less than 330s while the heading angle has not yet reached 360 at the 330th second in the turning circle maneuver figs 10 and 11 show the prediction results of heading angle rudder angle and speed components of 10 10 zigzag sb and 20 20 zigzag sb maneuvers respectively fig 12 shows the trajectory and speed components of 35 turning circle maneuver tables 5 and 6 present the comparison of prediction accuracy assessed by rmse and validation variables where r m denotes the real measured data in the prediction of zigzag maneuvers as can be seen from fig 10 a except for a short period of time around the 200th second the time histories of the heading angle and rudder angle predicted by ga gpr fit the experimental results more closely than those by gpr in fig 10 c d and fig 11 c d the sway speed and yaw rate predicted by gpr and ga gpr both have little deviation from the experimental data while the deviation of surge speed prediction in figs 10 b and fig 11 b is distinct as described in subsection 3 2 the basis for establishing a nonparametric model is that the rmse between the prediction values and the real measured values of vad is minimized thus the reason for the decreases in the prediction accuracy of surge speed may be the large noise in the real measured data of surge speed in the vad the large noise distorts and tampers the dynamic characteristics of ship longitudinal motion leading to the inappropriate hyperparameters tuned by ga and conjugate gradient method in fact the real measured data of surge speed shown in figs 10 b and fig 11 b are not smooth enough compared with the data of sway speed and yaw rate shown in fig 10 c d and fig 11 c d this may be attributed to the characteristics of the sensors used in the model tests nevertheless the rmse values and validation variables of zigzag maneuvers in table 5 reveal that the prediction results of ga gpr are more accurate than those of gpr indicating that ga gpr has a better anti noise ability as for the turning circle maneuver the prediction results of ship trajectory can better demonstrate the performance of identification algorithms xue et al 2020 one can see in fig 12 a that the trajectory predicted by ga gpr is more consistent with the experimental results since the nonparametric model is obtained from the training data of zigzag maneuvers the deviation of predicted velocity components can be attributed to the difference of motion characteristics between zigzag maneuver and turning circle maneuver turning circle maneuver can be regarded as a stable motion excited by a large rudder angle while zigzag maneuver is a changing motion excited by small and moderate rudder angles varying left and right alternatively a possible approach for alleviating the deviation may be the design of a special maneuver which can provide a sufficient excitation to stimulate fully the nonlinear dynamic characteristics of the ship nevertheless from the perspective of turning circle indicators in table 6 the prediction results of ga gpr are closer to the real measured values the deviation of a d predicted by gpr model reaches 33m while the corresponding value of ga gpr is only 16m 5 conclusion in this paper a novel and practical method based on gaussian process regression gpr optimized by genetic algorithm ga ga gpr is proposed for nonparametric modeling of ship maneuvering motion gpr is used to establish the nonparametric model while ga with adaptive crossover operation and mutation operation is utilized to adjust and optimize the hyperparameters in the kernel function to improve the adaptability of the model the sliding time window method is adopted to update the training samples the total number of training samples in the time window keeps constant so that the stability of the algorithm can be maintained two case studies are carried out one for the mariner class vessel with the dataset generated from simulation and the other for the container ship kcs with the dataset of free running model tests provided by the simman 2020 workshop comparative studies between ga gpr and gpr are implemented to evaluate the performance of the proposed method the prediction results of different zigzag and turning circle maneuvers and corresponding rmse values and validation variables reveal that ga gpr can achieve more accurate prediction of maneuvering motion than gpr and has better anti noise ability it shows that ga gpr has potential to be a valuable tool in the nonparametric modeling of ship maneuvering motion however the results of standard maneuvers of the container ship kcs predicted by ga gpr have a certain deviation from the real measured data in addition to the factor of large noise contained in the validation dataset as analyzed in subsection 4 2 the design of the kernel function in gpr is also crucial since the kernel function plays an important role in measuring the similarity between samples therefore in order to further improve the modeling accuracy of gpr based on the real measured data collected during free running model tests or full scale trials design of an effective kernel function will be the focus of the future study meanwhile it will be attempted to extend the proposed method to deal with the cases of ship maneuvering in waves the possibility of the proposed method for modeling the wave effects in the nonparametric model will be explored credit authorship contribution statement zi lu ouyang conceptualization methodology simulation formal analysis writing original draft zao jian zou supervision funding acquisition project administration writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is financially supported by the national natural science foundation of china grant no 51979165 the authors are grateful to kriso korea research institute of ships and ocean engineering south korea for providing the real measured data of kcs free running model tests 
20219,a novel method gaussian process regression optimized by genetic algorithm ga gpr is proposed for nonparametric modeling of ship maneuvering motion a genetic algorithm with adaptive crossover and mutation operations is introduced for adjustment and optimization of hyperparameters in the kernel function the sliding time window method is adopted to update the training samples to improve the adaptability of the model taking the mariner vessel and the container ship kcs as study objects the simulation data and the real measured data provided by simman 2020 workshop are employed to evaluate the proposed method the prediction results of the proposed method and the traditional gaussian process regression are compared and validated against available experimental data of zigzag and turning circle maneuvers it shows that the proposed method has higher prediction accuracy and better generalization ability indicating that the hyperparameters optimized by genetic algorithm make the model closer to the ship s dynamic characteristics keywords ship maneuvering nonparametric modeling system identification gaussian process regression genetic algorithm sliding time window abbreviations ann artificial neural network cfd computational fluid dynamics ga genetic algorithm gpr gaussian process regression lssvm least squares support vector machine mass maritime autonomous surface ships mle maximum likelihood estimation rbf radial basis function rmse root mean square error se squared exponential svm support vector machine svr support vector regression trd training dataset vad validation dataset nomenclature a d advance m b ship breadth m c b block coefficient d draft m d t tactical diameter m g evolutional generation i z moment of inertia about z axis kg m2 k kernel function k kernel matrix k s e se kernel function l scaling factor on the abscissa l p p ship length m m mass of the ship kg n hydrodynamic yaw moment n m p population size p c crossover probability p m mutation probability r yaw rate rad s r yaw acceleration rad s2 u surge speed m s u surge acceleration m s2 u o initial forward speed m s v sway speed m s v sway acceleration m s2 x longitudinal hydrodynamic force n x g x coordinate of ship s center of gravity m x u etc hydrodynamic derivatives y lateral hydrodynamic force n δ rudder angle deg δ displacement t ζ gaussian white noise θ hyperparameters vector σ f 2 change magnitude on the ordinate σ n 2 variance of gaussian white noise ψ heading angle deg ψ o s 1 1st overshoot angle deg ψ o s 2 2nd overshoot angle deg 1 introduction an accurate and reliable dynamic model of ship maneuvering motion is crucial to the study of ship maneuvering characteristics and autonomous navigation related issues the dynamic model can be utilized to predict ship maneuverability in the process of ship design in addition it can help the design of an automatic control system for ships with engineering practicality sutulo and guedes soares 2014 such as for intelligent navigation of maritime autonomous surface ships mass therefore it is of great importance to develop an efficient modeling method for establishing the ship dynamic model at present model test method computational fluid dynamics cfd method based on potential flow theory or viscous flow theory and system identification method based on motion state data can be used to establish the ship dynamic model however model test method and cfd method have the limitation that the established model is difficult to update according to the varying navigational environments and changing ship s dynamic features wang et al 2020 in contrast system identification is a data driven method with which the ship dynamic model can be identified based on the data collected during free running model tests or full scale trials this method only requires easy to measure motion state variables and control variables which greatly facilitates the modeling of ship dynamic system the existing system identification methods for modeling ship dynamics can be divided into parametric modeling and nonparametric modeling parametric modeling is based on the definite structure of ship dynamic model for ship maneuvering problem the commonly used ship dynamic model includes the whole ship model abkowitz model abkowitz 1964 the modular model mmg model ogawa and kasai 1978 and the response model nomoto model nomoto et al 1957 the unknown parameters in these models i e the hydrodynamic derivatives the hull propeller rudder interaction coefficients and the maneuverability indices can be obtained by system identification technology such as ridge regression method yoon and rhee 2003 yoon 2007 frequency domain spectrum analysis selvam et al 2005 bhattacharyya and haddara 2006 kalman filter perera et al 2011 dong et al 2019 support vector machine svm luo and zou 2009 zhang and zou 2011 2013 wang et al 2014 least squares support vector machine lssvm method zhu et al 2017 gibson and stilwell 2018 xu et al 2020 nonparametric modeling assumes that the ship dynamic system is completely unknown and only relies on the relationship between the input data and output data to model the system in recent years great progress has been made in nonparametric modeling technology the representative methods include svm and artificial neural network ann duan et al 2005 developed an ar emd svr model that combines support vector regression svr and autoregressive ar empirical mode decomposition emd technology and used it for short term prediction of nonlinear and unsteady ship motion wang et al 2019 proposed a nonparametric identification method based on v nu svr to establish robust models of ship maneuvering motion in an easy to operate way liu et al 2019 comprehensively considered the characteristics of deck motion and inertial navigation system proposed an online prediction method based on lssvm the optimization goal of svm is based on structural risk minimization while that of ann is based on empirical risk minimization yin and zou 2011 used a variable structure radial basis function rbf neural network to represent the time varying dynamics of system and proposed a model based on a combined module for the prediction of ship motion in the horizontal plane in order to capture the high order dynamic behavior generated by the coupling of hydrodynamics and driver dynamics woo et al 2018 proposed a deep neural network based dynamic model identification method for unmanned surface vessels compared with other black box modeling algorithms ann requires a larger size of samples and is liable to fall into the local optimum leading to unstable training results schölkopf et al 2002 with the development of artificial intelligence technology and experimental measuring technology other advanced machine learning algorithms have also been proposed for modeling ship hydrodynamic system weymouth and yue 2013 one of the typical methods is the gaussian process regression gpr as an algorithm based on bayesian inference gpr is theoretically a universal approximator of any continuous function in a compact space rasmussen et al 2004 its characteristic is that it can quantify the prediction uncertainty in a principled way and it is a probabilistic model with universality and resolvability these characteristics are beneficial for processing the real measured dataset of ship motion state variables with uncertainty and noise gpr is a typical bayesian learning method and has recently garnered significant attention in the system identification field such as nonlinear setting for volterra series estimation in the frequency domain stoddard et al 2019 typical discrete nonlinear second order dynamic system azman and kocijan 2011 and energy forecasting guan et al 2021 however the application of this method to identification of ship dynamic system has achieved relatively few research results and some research results can be found in ramire et al 2018 and xue et al 2020 the main reason may be attributed to the difficulties in the adjustment and optimization of the hyperparameters in the kernel function therefore it is important to design a suitable algorithm for hyperparameters tuning and optimization to the best knowledge of the authors till now there is no application of gpr with the aid of optimization algorithm for modeling ship dynamic system based on the real measured data of ship motion this paper proposes a method for nonparametric modeling of ship maneuvering motion based on gpr optimized by genetic algorithm ga the selection and optimization of the hyperparameters in the kernel function are completed by ga compared with the traditional optimization algorithm used in gpr that iteratively obtains the optimal solution from a single initial value ga can search multiple solutions in the space for evolution simultaneously thereby reducing the risk of falling into a local optimal solution this is one of the main innovations of this paper based on the real measured data provided by simman 2020 workshop simman 2020 the sliding time window method is used to update the training dataset allowing the algorithm to learn the new information the rest of this paper is organized into four main sections section 2 describes ship kinematics and dynamics in section 3 the mathematical basis of gpr is presented and the hyperparameters tuning method based on ga is proposed in section 4 two case studies are carried out one for the mariner class vessel with the dataset generated from simulation and the other for the container ship kcs with the dataset of model tests from simman 2020 workshop section 5 is devoted to conclusions and perspectives for the further research 2 ship dynamic system in this paper the three degrees of freedom 3 dof maneuvering motion of a ship in the horizontal plane is considered as shown in fig 1 the kinematic mathematical model is given as described by fossen 2011 1 η r ψ v r ψ cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 where ψ is the heading angle η x 0 y 0 ψ t is the vector expressing the position and orientation of the ship with respect to the earth fixed frame o 0 x 0 y 0 z 0 v u v r t is the vector containing the linear and angular velocity components with respect to the body fixed frame o x y z according to the newton s second law of motion the ship dynamic system can be described as 2 m u v r x g r 2 x m v u r x g r y i z r m x g v u r n where m is the mass of the ship i z is the moment of inertia about z axis x g is the longitudinal coordinate of the ship s center of gravity x y n are the components of the hydrodynamic forces and moment acting on the ship referring to abkowitz 1964 eq 2 can be rewritten in the following form 3 m x u u f 1 u v r δ m y v v m x g y r r f 2 u v r δ m x g n v v i z n r r f 3 u v r δ where x u etc are the inertial hydrodynamic derivatives δ is the rudder angle f i u v r δ i 1 2 3 are the nonlinear functions related to the motion state variables and control variable and can be expressed as 4a f 1 x u δ u x u u δ u 2 x u u u δ u 3 x v v v 2 x r r m x g r 2 x δ δ δ 2 x r r u r 2 δ u x v v u v 2 δ u x δ δ u δ 2 δ u x v r m v r x v δ v δ x r δ r δ x v r u v r δ u x v δ u v δ δ u x r δ u r δ δ u 4b f 2 y v v y v v v v 3 y v r r v r 2 y v δ δ v δ 2 y v u v δ u y v u u v δ u 2 y r m u r y r r r r 3 y r v v r v 2 y r δ δ r δ 2 y r u r δ u y r u u r δ u 2 y δ δ y δ δ δ δ 3 y δ v v δ v 2 y δ r r δ r 2 y δ u δ δ u y δ u u δ δ u 2 y v r δ v r δ y δ δ δ u δ 3 δ u 4c f 3 n v v n v v v v 3 n v r r v r 2 n v δ δ v δ 2 n v u v δ u n v u u v δ u 2 n r m x g u r n r r r r 3 n r v v r v 2 n r δ δ r δ 2 n r u r δ u n r u u r δ u 2 n δ δ n δ δ δ δ 3 n δ v v δ v 2 n δ r r δ r 2 n δ u δ δ u n δ u u δ δ u 2 n v r δ v r δ n δ δ δ u δ 3 δ u where x u etc are the hydrodynamic derivatives δ u u u 0 and u 0 is the constant speed of the ship when sailing straight forward according to eqs 3 and 4 u v and r can be expressed as functions of u v r δ in the following form 5 u h 1 u v r δ v h 2 u v r δ r h 3 u v r δ thus three ship motion state variables and one control variable are used to construct the regressor vectors eq 5 is taken as the black box model for nonparametric modeling 3 identification algorithm 3 1 gaussian process regression for nonparametric modeling the gaussian process regression gpr can be described as a supervised learning process in essence the gaussian process is a multivariate gaussian distribution rasmussen et al 2004 for a given finite dataset of n observations d x i y i i 1 n where x i is the input vector of i th sample and y i is the observation value of i th sample f x 1 f x 2 f x n form a set of random variables and have a joint gaussian distribution 6 f x g p m x k x x where m x is the mean function k x x is the kernel function whose mathematical expressions are as follows 7 m x e f x 8 k x x e f x m x f x m x considering the noise in the observations a general model of gpr problem can be established as 9 y f x ζ where ζ is the gaussian white noise uncorrelated with f x with mean 0 and variance σ n 2 since f x obeys gaussian distribution y also obeys gaussian distribution and the set of joint distribution of its finite observations is a gaussian process 10 y g p m x k x x σ n 2 δ i j where δ i j is the kronecker delta function k x x is the kernel matrix and its elements are k i j k x i x j according to bayes theorem gpr first establishes a prior function in d x i y i i 1 n and then transforms it into a posterior distribution under x the joint distribution can be expressed as 11 y f x n 0 k x x σ n 2 i n k x x k x x k x x where x x 1 x 2 x n t y y 1 y 2 y n t i n is a n dimensional identity matrix based on the bayesian regression theory and eq 11 the predicted distribution is calculated as 12 f x x y x n m f x cov f x 13 m f x e f x x y x k x x k x x σ n 2 i n 1 y 14 cov f x k x x k x x k x x σ n 2 i n 1 k x x where m f x is the mean of f x cov f x is the variance of f x according to eqs 13 and 14 the kernel matrix in gpr reflects the relationship between the samples in training dataset a qualified kernel matrix must be a positive semi definite matrix each element in the kernel matrix is calculated by the kernel function and can be seen as a measure of similarity between samples therefore the selection of kernel function has a great impact on the performance of gpr this paper selects squared exponential se kernel function which has been widely adopted in the kernel based nonparametric modeling of ship motion with satisfactory prediction results bai et al 2019 moreno et al 2019 wang et al 2020 the mathematical expression of se kernel function is given as follows 15 k s e σ f 2 exp 1 2 l 2 x i x j t x i x j where the hyperparameters σ f 2 and l characterize the change magnitude of the function on the ordinate and the scaling factor of the function on the abscissa respectively the traditional gpr generally adopts maximum likelihood estimation mle method and conjugate gradient descent algorithm for tuning of the hyperparameters in the kernel function let θ be the vector of all hyperparameters the mle method first constructs a log likelihood function log p y x θ based on bayes principle then utilizes the conjugate gradient method to obtain the maximum value of log p y x θ 16 log p y x θ 1 2 y t k σ n 2 i n 1 y 1 2 log k σ n 2 i n n 2 log 2 π 17 λ k σ n 2 i n 1 y θ j log p y x θ 1 2 t r λ λ t k σ n 2 i n 1 k σ n 2 i n θ j on the other hand the conjugate gradient method has a strong dependence on the initial values and currently the setting of initial values has no theoretical basis fang et al 2018 if the initial values are set improperly the conjugate gradient method will fall into a local optimum or even fail to converge in the search process leading to poor performance of gpr 3 2 genetic algorithm for hyperparameters optimization in order to overcome the shortcomings of conjugate gradient method this paper uses ga with adaptive crossover operation and mutation operation to adjust and optimize the hyperparameters in the kernel function ga can flexibly construct the heuristic process and the corresponding objective function has the ability to randomly and quickly search for the optimal solution as well as to find the global optimal solution in the parameters search process holland 1975 the process is as follows step 1 encoding and population initialization encoding is the process of converting the hyperparameters in gpr into chromosomes that can be manipulated by ga the encoded content is the genotype of individual in biology corresponding to a potentially feasible solution of θ this paper adopts binary encoding method and uses binary symbol set 0 1 to express the parameters such individuals of total number p constitute the initial population step 2 calculation of individual fitness function value the fitness function is a tool to judge the performance of a certain individual genotype it can be regarded as the driving force for individuals to evolve towards outstanding characteristics in this paper the fitness function is designed as 18 f i t n e s s 1 1 n i 1 n y i y i 2 where y i is the predicted value of i th sample y i is the real measured value of i th sample step 3 selection operation the core idea of the selection operation is to calculate the fitness of each individual in the population the individual with a larger fitness value will have a higher probability of being saved to the next generation and the individual with a lower fitness value will have a higher probability of being eliminated the roulette method is adopted for selection operation and the probability of an individual being selected into the next generation is proportional to its fitness value step 4 crossover operation and mutation operation crossover operation and mutation operation are the main ways of ga to generate new genotype individuals in this paper the uniform crossover method is used in the crossover operation for two individuals a and b that are successfully paired each gene on their locus can be exchanged with the same probability p c thereby forming new individuals a and b as for mutation operation the simple mutation method is utilized the random number function is employed to determine the position of individual gene mutation and then the binary code is reversed with mutation probability p m to generate a new individual considering that the genotype of individuals in the population has gradually become stable with high fitness function value in the later stage of optimization in order to improve the performance of ga adaptive crossover operator and adaptive mutation operator are designed 19 p c i p c 1 k 1 p i p m i p m 1 k 2 p i where p c 1 is the initial value of crossover probability p m 1 is the initial value of mutation probability i is the generation of population evolution k 1 and k 2 are the weight values according to eq 19 in the early stage of optimization the crossover probability and mutation probability are relatively large which is conducive to the generation of new individuals along with the increase of iteration times the probability gradually decreases which can protect the outstanding individuals from being eliminated based on the process described above the workflow of nonparametric modeling method for ship dynamics based on gpr optimized by ga ga gpr is shown in fig 2 3 3 sliding time window method this paper adopts the sliding time window method to update the training samples when predicting the ship motion based on ga gpr model new samples will continue to be generated the ship s future motion state has a strong correlation with the motion state of previous adjacent moment so the new samples play a positive role in improving the accuracy of motion prediction xu and zou 2021 according to eqs 13 and 14 however if the new samples are added to x and y continuously the dimension of matrix k x x σ n 2 i n will become larger and larger so the time consumed to solve its inverse matrix will increase the core idea of sliding time window method is that the new samples are added to the training dataset successively while the oldest samples are discarded to keep the total number of training dataset in the time window constant in this paper the length of the time window is equal to the length of x thus the dimension of matrix k x x σ n 2 i n remains unchanged the implementation process is shown in fig 3 4 nonparametric modeling of ship maneuvering motion 4 1 nonparametric modeling for mariner class vessel with simulation data in order to verify the effectiveness of ga gpr firstly the nonparametric modeling of ship maneuvering motion is carried out based on the simulation dataset with eq 5 as the black box model the ship used for simulation test is the mariner class vessel for which the main parameters are listed in table 1 in this paper the hydrodynamic derivatives in chislett and tejsen 1965 are used to establish the abkowitz model according to eq 4 to generate the training dataset by simulating 20 20 zigzag maneuver the training dataset has a total of 600 samples with a sampling time interval of 0 5s during the implementation of ga gpr about 80 of the samples are selected as training dataset trd for gpr modeling while the remaining 20 of the samples are selected as validation dataset vad for hyperparameters optimization by ga the parameters in ga are set as follows p c 1 0 9 p m 1 0 1 p 30 k 1 k 2 0 01 and the evolutional generation g 50 meanwhile the maximum likelihood estimation mle and conjugate gradient method based traditional gpr is implemented for comparison in order to evaluate the generalization ability of the nonparametric model the prediction of maneuvers not involved in the training data are carried out including 10 10 zigzag maneuver 15 5 zigzag maneuver where the specified rudder angle is 15 and the prescribed heading angle at which the reverse steering is executed is 5 and 35 turning circle maneuver figs 4 and 5 show the prediction results of heading angle rudder angle and speed components of 10 10 zigzag maneuver and 15 5 zigzag maneuver respectively fig 6 shows the trajectory and speed components of 35 turning circle maneuver tables 2 and 3 present the comparison of prediction accuracy assessed by root mean square error rmse and validation variables therein rmse is defined as 20 r m s e 1 n i 1 n y i y ˆ i 2 where y i is the original data y ˆ i is the predicted value r u r v r r and r h denote the rmse values of surge speed m s sway speed m s yaw rate rad s and heading angle rad respectively ψ o s 1 deg and ψ o s 2 deg denote the 1st overshoot angle and the 2nd overshoot angle in zigzag maneuvers respectively a d m and d t m denote the advance and the tactical diameter in turning circle maneuver respectively s t denotes the simulation data it can be seen in figs 4 6 that both gpr and ga gpr models can predict accurately the maneuvering motion of mariner class vessel based on the simulation dataset in the prediction of zigzag maneuvers ga gpr shows its advantage over gpr as reflected in the partially enlarged subgraph of fig 4 a and the maneuverability indicators in table 2 the values of ψ o s 1 and ψ o s 2 obtained by ga gpr model show a smaller deviation than those by gpr indicating that ga gpr has higher prediction accuracy from the comparison of prediction and simulation results of motion variables in figs 4 and 5 it can be seen that no overfitting phenomenon occurs with these two algorithms and both have strong generalization ability this may be attributed to the absence of noise interference in the training dataset generated from simulation in the prediction of turning circle maneuver one can find in fig 6 a that the trajectory predicted by gpr model has a certain deviation from the simulation results while that by ga gpr is almost completely consistent with the simulation results the values of a d and d t in table 3 also confirm this observation the deviation of d t predicted by gpr model reaches 12m while the corresponding value of ga gpr is only 4m from the perspective of rmse index ga gpr has higher prediction accuracy in the verification tests indicating that the hyperparameters optimized by ga make gpr model closer to the ship dynamic characteristics in order to explore the influence of noise on the generalization ability of ga gpr model gaussian white noise of different levels is added into the simulated training dataset jiang and zou 2017 the parameters of signal to noise ratio snr set in noise level 1 and 2 are 95 db and 90 db respectively snr is given as 21 s n r d b 10 l o g 10 p s p n where p s is the power of signal p n is the power of noise as can be seen from eq 21 the noise intensity of noise level 2 is larger than that of noise level 1 figs 7 9 show the prediction results of 10 10 zigzag 15 5 zigzag and 35 turning circle maneuvers under different noise levels respectively as can be seen from these figures the influence of noise on the prediction results is noticeable as the noise intensity increases the prediction errors grow more distinctly especially in the prediction of turning circle maneuver nevertheless the prediction results of zigzag maneuvers show that the time histories of heading angle predicted by ga gpr fit the simulation results more closely compared with gpr one can find distinct cumulative prediction errors of gpr in the later stage of prediction which can almost not be observed in the prediction results based on clean training data fig 9 demonstrate that the noise has rather large negative impact on the prediction of turning circle maneuver by the two models as can be seen from fig 9 b the trajectory predicted by gpr shows larger deviation than that by ga gpr under noise level 2 indicating that ga gpr has better anti noise ability 4 2 nonparametric modeling of kcs ship with real measured data in order to further verify the effectiveness of ga gpr in engineering application taking eq 5 as the black box model nonparametric modeling is carried out for the container ship kcs by using ga gpr and gpr based on the real measured data of standard maneuvers provided by the simman 2020 workshop for an international comparative study simman 2020 all the data are presented in full scale the main parameters of the ship are listed in table 4 the datasets of kcs provided by simman 2020 workshop include 20 20 zigzag test starting from portside ps 20 20 zigzag test starting from starboard side sb 10 10 zigzag test ps 10 10 zigzag test sb and 35 turning circle test since the real measured data usually contain noise and may fluctuate for instance due to the instability of sensors the training dataset needs to be carefully selected otherwise problems such as overfitting or poor generalization ability will occur according to wang et al 2020 for the nonparametric modeling of ship maneuvering motion the training dataset needs to contain high quality information of rudder angle excitation so as to obtain more ship dynamic information from the real measured data among the three phases rudder steering phase transitional phase and steady turning phase of a turning circle maneuver only the rudder steering phase contains a large range of rudder angle signal excitations but this phase does not last long thus a small part of the data samples of 20 20 zigzag maneuver ps and 10 10 zigzag maneuver ps are selected to construct the training dataset the duration and sampling time interval of each maneuver are 153 75s and 0 615s respectively the whole training dataset contains a total of 500 samples since gpr has the ability to directly deal with datasets containing noise with the predicted results consisting of mean and variance the training data are not filtered in this paper in order to evaluate the generalization ability and engineering practicability of the nonparametric model the predictions of maneuvers not involved in the training data are carried out based on gpr and ga gpr including 10 10 zigzag maneuver sb 20 20 zigzag maneuver sb and 35 turning circle maneuver the prediction duration and sampling time interval of zigzag maneuvers are 300s and 0 615s respectively while the prediction duration and sampling time interval of turning circle maneuver are 350s and 0 615s respectively the reason for the longer prediction duration of the turning circle maneuver is that the duration of the 10 10 zigzag maneuver sb provided by simman 2020 is less than 330s while the heading angle has not yet reached 360 at the 330th second in the turning circle maneuver figs 10 and 11 show the prediction results of heading angle rudder angle and speed components of 10 10 zigzag sb and 20 20 zigzag sb maneuvers respectively fig 12 shows the trajectory and speed components of 35 turning circle maneuver tables 5 and 6 present the comparison of prediction accuracy assessed by rmse and validation variables where r m denotes the real measured data in the prediction of zigzag maneuvers as can be seen from fig 10 a except for a short period of time around the 200th second the time histories of the heading angle and rudder angle predicted by ga gpr fit the experimental results more closely than those by gpr in fig 10 c d and fig 11 c d the sway speed and yaw rate predicted by gpr and ga gpr both have little deviation from the experimental data while the deviation of surge speed prediction in figs 10 b and fig 11 b is distinct as described in subsection 3 2 the basis for establishing a nonparametric model is that the rmse between the prediction values and the real measured values of vad is minimized thus the reason for the decreases in the prediction accuracy of surge speed may be the large noise in the real measured data of surge speed in the vad the large noise distorts and tampers the dynamic characteristics of ship longitudinal motion leading to the inappropriate hyperparameters tuned by ga and conjugate gradient method in fact the real measured data of surge speed shown in figs 10 b and fig 11 b are not smooth enough compared with the data of sway speed and yaw rate shown in fig 10 c d and fig 11 c d this may be attributed to the characteristics of the sensors used in the model tests nevertheless the rmse values and validation variables of zigzag maneuvers in table 5 reveal that the prediction results of ga gpr are more accurate than those of gpr indicating that ga gpr has a better anti noise ability as for the turning circle maneuver the prediction results of ship trajectory can better demonstrate the performance of identification algorithms xue et al 2020 one can see in fig 12 a that the trajectory predicted by ga gpr is more consistent with the experimental results since the nonparametric model is obtained from the training data of zigzag maneuvers the deviation of predicted velocity components can be attributed to the difference of motion characteristics between zigzag maneuver and turning circle maneuver turning circle maneuver can be regarded as a stable motion excited by a large rudder angle while zigzag maneuver is a changing motion excited by small and moderate rudder angles varying left and right alternatively a possible approach for alleviating the deviation may be the design of a special maneuver which can provide a sufficient excitation to stimulate fully the nonlinear dynamic characteristics of the ship nevertheless from the perspective of turning circle indicators in table 6 the prediction results of ga gpr are closer to the real measured values the deviation of a d predicted by gpr model reaches 33m while the corresponding value of ga gpr is only 16m 5 conclusion in this paper a novel and practical method based on gaussian process regression gpr optimized by genetic algorithm ga ga gpr is proposed for nonparametric modeling of ship maneuvering motion gpr is used to establish the nonparametric model while ga with adaptive crossover operation and mutation operation is utilized to adjust and optimize the hyperparameters in the kernel function to improve the adaptability of the model the sliding time window method is adopted to update the training samples the total number of training samples in the time window keeps constant so that the stability of the algorithm can be maintained two case studies are carried out one for the mariner class vessel with the dataset generated from simulation and the other for the container ship kcs with the dataset of free running model tests provided by the simman 2020 workshop comparative studies between ga gpr and gpr are implemented to evaluate the performance of the proposed method the prediction results of different zigzag and turning circle maneuvers and corresponding rmse values and validation variables reveal that ga gpr can achieve more accurate prediction of maneuvering motion than gpr and has better anti noise ability it shows that ga gpr has potential to be a valuable tool in the nonparametric modeling of ship maneuvering motion however the results of standard maneuvers of the container ship kcs predicted by ga gpr have a certain deviation from the real measured data in addition to the factor of large noise contained in the validation dataset as analyzed in subsection 4 2 the design of the kernel function in gpr is also crucial since the kernel function plays an important role in measuring the similarity between samples therefore in order to further improve the modeling accuracy of gpr based on the real measured data collected during free running model tests or full scale trials design of an effective kernel function will be the focus of the future study meanwhile it will be attempted to extend the proposed method to deal with the cases of ship maneuvering in waves the possibility of the proposed method for modeling the wave effects in the nonparametric model will be explored credit authorship contribution statement zi lu ouyang conceptualization methodology simulation formal analysis writing original draft zao jian zou supervision funding acquisition project administration writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is financially supported by the national natural science foundation of china grant no 51979165 the authors are grateful to kriso korea research institute of ships and ocean engineering south korea for providing the real measured data of kcs free running model tests 
